total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearALsideText(
  (layers): ModuleList(
    (0): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.0.weight 90000
layers.0.enc.f.0.bias 300
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 45777392
init_time 15.123374169
Start Training
gc 0
Train Epoch0 Acc 0.2898833333333333 (34786/120000), AUC 0.5193594098091125
ep0_train_time 4.879219150999997
Test Epoch0 layer0 Acc 0.41368421052631577, AUC 0.6843318343162537, avg_entr 1.217528223991394, f1 0.413684219121933
ep0_l0_test_time 0.061853745000000515
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.4139473684210526, AUC 0.6762765645980835, avg_entr 1.223820447921753, f1 0.41394737362861633
ep0_l1_test_time 0.06722164600000013
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.3642105263157895, AUC 0.6214564442634583, avg_entr 1.2219008207321167, f1 0.3642105162143707
ep0_l2_test_time 0.06434218600000108
Test Epoch0 layer3 Acc 0.3223684210526316, AUC 0.5944464802742004, avg_entr 1.2212398052215576, f1 0.32236841320991516
ep0_l3_test_time 0.06076875400000148
Test Epoch0 layer4 Acc 0.3078947368421053, AUC 0.5864813327789307, avg_entr 1.2237720489501953, f1 0.3078947365283966
ep0_l4_test_time 0.061497260999999526
gc 0
Train Epoch1 Acc 0.3502166666666667 (42026/120000), AUC 0.603480339050293
ep1_train_time 4.448028562000001
Test Epoch1 layer0 Acc 0.49078947368421055, AUC 0.7324296832084656, avg_entr 0.8741702437400818, f1 0.4907894730567932
ep1_l0_test_time 0.060205580000001646
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.48473684210526313, AUC 0.7268751263618469, avg_entr 0.8738444447517395, f1 0.484736829996109
ep1_l1_test_time 0.07667817099999752
Test Epoch1 layer2 Acc 0.4392105263157895, AUC 0.6937339901924133, avg_entr 0.8986009359359741, f1 0.43921053409576416
ep1_l2_test_time 0.060428685999998066
Test Epoch1 layer3 Acc 0.3944736842105263, AUC 0.6577445864677429, avg_entr 0.9015832543373108, f1 0.394473671913147
ep1_l3_test_time 0.06181244500000105
Test Epoch1 layer4 Acc 0.3792105263157895, AUC 0.6516620516777039, avg_entr 0.8941062092781067, f1 0.37921053171157837
ep1_l4_test_time 0.06228549799999783
gc 0
Train Epoch2 Acc 0.410075 (49209/120000), AUC 0.6657238006591797
ep2_train_time 4.443226882999998
Test Epoch2 layer0 Acc 0.4963157894736842, AUC 0.7429503202438354, avg_entr 0.6985448002815247, f1 0.49631577730178833
ep2_l0_test_time 0.05985227300000062
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.48210526315789476, AUC 0.739630401134491, avg_entr 0.7049130201339722, f1 0.4821052551269531
ep2_l1_test_time 0.06410562900000372
Test Epoch2 layer2 Acc 0.45552631578947367, AUC 0.7131019234657288, avg_entr 0.708885133266449, f1 0.45552632212638855
ep2_l2_test_time 0.06020720300000448
Test Epoch2 layer3 Acc 0.4292105263157895, AUC 0.6881957054138184, avg_entr 0.7129100561141968, f1 0.42921051383018494
ep2_l3_test_time 0.060484299999998825
Test Epoch2 layer4 Acc 0.425, AUC 0.6851667761802673, avg_entr 0.7173150777816772, f1 0.42500001192092896
ep2_l4_test_time 0.06130465300000054
gc 0
Train Epoch3 Acc 0.4386583333333333 (52639/120000), AUC 0.6907821893692017
ep3_train_time 4.4016519689999996
Test Epoch3 layer0 Acc 0.5044736842105263, AUC 0.7467437386512756, avg_entr 0.6222967505455017, f1 0.5044736862182617
ep3_l0_test_time 0.06039759000000089
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.49973684210526315, AUC 0.7428582310676575, avg_entr 0.6306132078170776, f1 0.49973684549331665
ep3_l1_test_time 0.06694849599999486
Test Epoch3 layer2 Acc 0.4681578947368421, AUC 0.7224036455154419, avg_entr 0.6369251608848572, f1 0.46815788745880127
ep3_l2_test_time 0.06014978299999996
Test Epoch3 layer3 Acc 0.44605263157894737, AUC 0.700846254825592, avg_entr 0.6320033669471741, f1 0.4460526406764984
ep3_l3_test_time 0.06091316100000199
Test Epoch3 layer4 Acc 0.4284210526315789, AUC 0.6977403163909912, avg_entr 0.6158168911933899, f1 0.4284210503101349
ep3_l4_test_time 0.0628764830000037
gc 0
Train Epoch4 Acc 0.4475166666666667 (53702/120000), AUC 0.7000226974487305
ep4_train_time 4.424482248000004
Test Epoch4 layer0 Acc 0.4992105263157895, AUC 0.748843789100647, avg_entr 0.5701819062232971, f1 0.49921053647994995
ep4_l0_test_time 0.06052071499999556
Test Epoch4 layer1 Acc 0.5047368421052632, AUC 0.7427978515625, avg_entr 0.5797802805900574, f1 0.5047368407249451
ep4_l1_test_time 0.05899831799999333
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.4805263157894737, AUC 0.7275214195251465, avg_entr 0.5669665336608887, f1 0.480526328086853
ep4_l2_test_time 0.06917255999999838
Test Epoch4 layer3 Acc 0.4560526315789474, AUC 0.7025648355484009, avg_entr 0.5638502836227417, f1 0.45605263113975525
ep4_l3_test_time 0.06125501500000041
Test Epoch4 layer4 Acc 0.44157894736842107, AUC 0.7009429931640625, avg_entr 0.5517278909683228, f1 0.4415789544582367
ep4_l4_test_time 0.061760130000003244
gc 0
Train Epoch5 Acc 0.4564916666666667 (54779/120000), AUC 0.7086963653564453
ep5_train_time 4.436247905999998
Test Epoch5 layer0 Acc 0.5039473684210526, AUC 0.7501383423805237, avg_entr 0.518048107624054, f1 0.503947377204895
ep5_l0_test_time 0.06040971899999903
Test Epoch5 layer1 Acc 0.5036842105263157, AUC 0.7446773052215576, avg_entr 0.5250805616378784, f1 0.5036842226982117
ep5_l1_test_time 0.05904593700000049
Test Epoch5 layer2 Acc 0.46842105263157896, AUC 0.7300946712493896, avg_entr 0.5129854679107666, f1 0.4684210419654846
ep5_l2_test_time 0.059595986999994466
Test Epoch5 layer3 Acc 0.4518421052631579, AUC 0.7091362476348877, avg_entr 0.5232654213905334, f1 0.4518420994281769
ep5_l3_test_time 0.06068727399999574
Test Epoch5 layer4 Acc 0.4473684210526316, AUC 0.7082692384719849, avg_entr 0.5113547444343567, f1 0.44736841320991516
ep5_l4_test_time 0.06153361300000171
gc 0
Train Epoch6 Acc 0.46055833333333335 (55267/120000), AUC 0.7140376567840576
ep6_train_time 4.405476292000003
Test Epoch6 layer0 Acc 0.5028947368421053, AUC 0.75105881690979, avg_entr 0.48459580540657043, f1 0.5028947591781616
ep6_l0_test_time 0.06076669299999793
Test Epoch6 layer1 Acc 0.5026315789473684, AUC 0.745818018913269, avg_entr 0.49230247735977173, f1 0.5026316046714783
ep6_l1_test_time 0.05883915800000494
Test Epoch6 layer2 Acc 0.4747368421052632, AUC 0.7338019609451294, avg_entr 0.4949871599674225, f1 0.4747368395328522
ep6_l2_test_time 0.059446428000001106
Test Epoch6 layer3 Acc 0.4660526315789474, AUC 0.7126002311706543, avg_entr 0.4898476004600525, f1 0.4660526216030121
ep6_l3_test_time 0.06130922000000538
Test Epoch6 layer4 Acc 0.4568421052631579, AUC 0.7124758958816528, avg_entr 0.4722144305706024, f1 0.4568420946598053
ep6_l4_test_time 0.0619248309999989
gc 0
Train Epoch7 Acc 0.4643333333333333 (55720/120000), AUC 0.7178802490234375
ep7_train_time 4.414556733000005
Test Epoch7 layer0 Acc 0.5044736842105263, AUC 0.7519943714141846, avg_entr 0.4512912333011627, f1 0.5044736862182617
ep7_l0_test_time 0.06030643900000143
Test Epoch7 layer1 Acc 0.5031578947368421, AUC 0.7473146915435791, avg_entr 0.46458643674850464, f1 0.503157913684845
ep7_l1_test_time 0.059041231999998445
Test Epoch7 layer2 Acc 0.46473684210526317, AUC 0.734410285949707, avg_entr 0.45809438824653625, f1 0.46473684906959534
ep7_l2_test_time 0.05958732300000236
Test Epoch7 layer3 Acc 0.4463157894736842, AUC 0.7130211591720581, avg_entr 0.44662877917289734, f1 0.44631579518318176
ep7_l3_test_time 0.06088700299999772
Test Epoch7 layer4 Acc 0.4378947368421053, AUC 0.7138427495956421, avg_entr 0.4416399300098419, f1 0.437894731760025
ep7_l4_test_time 0.06169660099999419
gc 0
Train Epoch8 Acc 0.4641 (55692/120000), AUC 0.719116747379303
ep8_train_time 4.432863463000004
Test Epoch8 layer0 Acc 0.5036842105263157, AUC 0.7528277635574341, avg_entr 0.42910322546958923, f1 0.5036842226982117
ep8_l0_test_time 0.06040450100000072
Test Epoch8 layer1 Acc 0.5086842105263157, AUC 0.7467334866523743, avg_entr 0.4370221197605133, f1 0.5086842179298401
ep8_l1_test_time 0.05920564699999886
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 8
Test Epoch8 layer2 Acc 0.47789473684210526, AUC 0.7338626384735107, avg_entr 0.4320390820503235, f1 0.47789472341537476
ep8_l2_test_time 0.06181953200000123
Test Epoch8 layer3 Acc 0.44894736842105265, AUC 0.7065903544425964, avg_entr 0.42374783754348755, f1 0.44894737005233765
ep8_l3_test_time 0.061193379999998854
Test Epoch8 layer4 Acc 0.44526315789473686, AUC 0.7081131935119629, avg_entr 0.4075292944908142, f1 0.445263147354126
ep8_l4_test_time 0.06190305999999879
gc 0
Train Epoch9 Acc 0.46403333333333335 (55684/120000), AUC 0.7181477546691895
ep9_train_time 4.471155690000003
Test Epoch9 layer0 Acc 0.5018421052631579, AUC 0.7539134621620178, avg_entr 0.40393343567848206, f1 0.5018420815467834
ep9_l0_test_time 0.05995621299999243
Test Epoch9 layer1 Acc 0.5044736842105263, AUC 0.74729984998703, avg_entr 0.41468125581741333, f1 0.5044736862182617
ep9_l1_test_time 0.059011304999998515
Test Epoch9 layer2 Acc 0.4826315789473684, AUC 0.7381756901741028, avg_entr 0.409946471452713, f1 0.4826315641403198
ep9_l2_test_time 0.05992684299999951
Test Epoch9 layer3 Acc 0.4618421052631579, AUC 0.7098664045333862, avg_entr 0.41340819001197815, f1 0.4618421196937561
ep9_l3_test_time 0.060548167000007425
Test Epoch9 layer4 Acc 0.45052631578947366, AUC 0.7102116942405701, avg_entr 0.40019524097442627, f1 0.45052632689476013
ep9_l4_test_time 0.06145268199999521
gc 0
Train Epoch10 Acc 0.46489166666666665 (55787/120000), AUC 0.7204650640487671
ep10_train_time 4.570237927999997
Test Epoch10 layer0 Acc 0.5044736842105263, AUC 0.7552565336227417, avg_entr 0.38457784056663513, f1 0.5044736862182617
ep10_l0_test_time 0.06000304199999107
Test Epoch10 layer1 Acc 0.508421052631579, AUC 0.7461328506469727, avg_entr 0.40287163853645325, f1 0.5084210634231567
ep10_l1_test_time 0.05921396499999787
Test Epoch10 layer2 Acc 0.47736842105263155, AUC 0.7362172603607178, avg_entr 0.39447787404060364, f1 0.47736841440200806
ep10_l2_test_time 0.05951846199999977
Test Epoch10 layer3 Acc 0.45052631578947366, AUC 0.7102696299552917, avg_entr 0.3981117606163025, f1 0.45052632689476013
ep10_l3_test_time 0.06093129899998928
Test Epoch10 layer4 Acc 0.43973684210526315, AUC 0.7061112523078918, avg_entr 0.37731561064720154, f1 0.43973684310913086
ep10_l4_test_time 0.06155254899999818
gc 0
Train Epoch11 Acc 0.46353333333333335 (55624/120000), AUC 0.7190653085708618
ep11_train_time 4.442961225000005
Test Epoch11 layer0 Acc 0.508421052631579, AUC 0.7558872699737549, avg_entr 0.36854296922683716, f1 0.5084210634231567
ep11_l0_test_time 0.06022984300000189
Test Epoch11 layer1 Acc 0.5044736842105263, AUC 0.7455143332481384, avg_entr 0.3982948362827301, f1 0.5044736862182617
ep11_l1_test_time 0.05895964799999831
Test Epoch11 layer2 Acc 0.475, AUC 0.7344503402709961, avg_entr 0.39350563287734985, f1 0.4749999940395355
ep11_l2_test_time 0.05953507499999944
Test Epoch11 layer3 Acc 0.4523684210526316, AUC 0.709713339805603, avg_entr 0.3709713816642761, f1 0.4523683786392212
ep11_l3_test_time 0.060328333000001066
Test Epoch11 layer4 Acc 0.4423684210526316, AUC 0.7056453227996826, avg_entr 0.3622719347476959, f1 0.44236841797828674
ep11_l4_test_time 0.061037100999996596
gc 0
Train Epoch12 Acc 0.4686666666666667 (56240/120000), AUC 0.7246473431587219
ep12_train_time 4.444986561000007
Test Epoch12 layer0 Acc 0.5081578947368421, AUC 0.7571312189102173, avg_entr 0.35218966007232666, f1 0.5081579089164734
ep12_l0_test_time 0.05989784799999143
Test Epoch12 layer1 Acc 0.5089473684210526, AUC 0.745520293712616, avg_entr 0.37090611457824707, f1 0.5089473724365234
ep12_l1_test_time 0.05903390000000286
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 12
Test Epoch12 layer2 Acc 0.48236842105263156, AUC 0.7363094091415405, avg_entr 0.3721176087856293, f1 0.4823684096336365
ep12_l2_test_time 0.06883140600000104
Test Epoch12 layer3 Acc 0.45710526315789474, AUC 0.7104020118713379, avg_entr 0.35101330280303955, f1 0.45710524916648865
ep12_l3_test_time 0.061088885000003756
Test Epoch12 layer4 Acc 0.4478947368421053, AUC 0.707085132598877, avg_entr 0.3381328582763672, f1 0.44789472222328186
ep12_l4_test_time 0.061534201999990046
gc 0
Train Epoch13 Acc 0.46936666666666665 (56324/120000), AUC 0.7248179912567139
ep13_train_time 4.428520745
Test Epoch13 layer0 Acc 0.5042105263157894, AUC 0.7580785751342773, avg_entr 0.33211439847946167, f1 0.5042105317115784
ep13_l0_test_time 0.06014408400000093
Test Epoch13 layer1 Acc 0.49973684210526315, AUC 0.7456903457641602, avg_entr 0.34876930713653564, f1 0.49973684549331665
ep13_l1_test_time 0.05990710900000806
Test Epoch13 layer2 Acc 0.4789473684210526, AUC 0.7391108274459839, avg_entr 0.34899526834487915, f1 0.47894737124443054
ep13_l2_test_time 0.0599837999999977
Test Epoch13 layer3 Acc 0.4531578947368421, AUC 0.7115340828895569, avg_entr 0.33026841282844543, f1 0.453157901763916
ep13_l3_test_time 0.06102123600000198
Test Epoch13 layer4 Acc 0.44894736842105265, AUC 0.7103938460350037, avg_entr 0.3246792256832123, f1 0.44894737005233765
ep13_l4_test_time 0.06146021200000007
gc 0
Train Epoch14 Acc 0.46884166666666666 (56261/120000), AUC 0.7246771454811096
ep14_train_time 4.419619655000005
Test Epoch14 layer0 Acc 0.5128947368421053, AUC 0.759714663028717, avg_entr 0.3192012310028076, f1 0.5128947496414185
ep14_l0_test_time 0.06049857899999722
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 14
Test Epoch14 layer1 Acc 0.5052631578947369, AUC 0.7456855773925781, avg_entr 0.3329196274280548, f1 0.5052631497383118
ep14_l1_test_time 0.06718560699999898
Test Epoch14 layer2 Acc 0.4868421052631579, AUC 0.7395240068435669, avg_entr 0.33497482538223267, f1 0.4868420958518982
ep14_l2_test_time 0.0597722669999996
Test Epoch14 layer3 Acc 0.45026315789473687, AUC 0.7111034393310547, avg_entr 0.31545597314834595, f1 0.4502631723880768
ep14_l3_test_time 0.060402306000000294
Test Epoch14 layer4 Acc 0.4481578947368421, AUC 0.7099182605743408, avg_entr 0.2953408360481262, f1 0.4481579065322876
ep14_l4_test_time 0.06214866799999186
gc 0
Train Epoch15 Acc 0.46691666666666665 (56030/120000), AUC 0.7244080305099487
ep15_train_time 4.463978413000007
Test Epoch15 layer0 Acc 0.5186842105263157, AUC 0.7610254287719727, avg_entr 0.31479018926620483, f1 0.5186842083930969
ep15_l0_test_time 0.06003392399999541
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 15
Test Epoch15 layer1 Acc 0.5086842105263157, AUC 0.746113121509552, avg_entr 0.33288174867630005, f1 0.5086842179298401
ep15_l1_test_time 0.06119747699999323
Test Epoch15 layer2 Acc 0.48894736842105263, AUC 0.7383513450622559, avg_entr 0.3290930688381195, f1 0.4889473617076874
ep15_l2_test_time 0.05981542899999681
Test Epoch15 layer3 Acc 0.4560526315789474, AUC 0.7109107971191406, avg_entr 0.312311053276062, f1 0.45605263113975525
ep15_l3_test_time 0.06061341600000958
Test Epoch15 layer4 Acc 0.4523684210526316, AUC 0.709501326084137, avg_entr 0.29545751214027405, f1 0.4523683786392212
ep15_l4_test_time 0.06194027200000107
gc 0
Train Epoch16 Acc 0.4709083333333333 (56509/120000), AUC 0.7267217636108398
ep16_train_time 4.494955562999991
Test Epoch16 layer0 Acc 0.5160526315789473, AUC 0.7621128559112549, avg_entr 0.30505508184432983, f1 0.5160526037216187
ep16_l0_test_time 0.0601861920000033
Test Epoch16 layer1 Acc 0.49657894736842106, AUC 0.7457890510559082, avg_entr 0.32303479313850403, f1 0.49657896161079407
ep16_l1_test_time 0.059015084999998635
Test Epoch16 layer2 Acc 0.47789473684210526, AUC 0.7382373213768005, avg_entr 0.32178133726119995, f1 0.47789472341537476
ep16_l2_test_time 0.05970702400000505
Test Epoch16 layer3 Acc 0.4531578947368421, AUC 0.710745632648468, avg_entr 0.29824990034103394, f1 0.453157901763916
ep16_l3_test_time 0.06086056700000597
Test Epoch16 layer4 Acc 0.4407894736842105, AUC 0.7090573906898499, avg_entr 0.2913469672203064, f1 0.44078946113586426
ep16_l4_test_time 0.06178732799999409
gc 0
Train Epoch17 Acc 0.4701 (56412/120000), AUC 0.7257899045944214
ep17_train_time 4.488244281999997
Test Epoch17 layer0 Acc 0.5107894736842106, AUC 0.7636263370513916, avg_entr 0.2890017628669739, f1 0.5107894539833069
ep17_l0_test_time 0.0604405959999923
Test Epoch17 layer1 Acc 0.5031578947368421, AUC 0.7459344863891602, avg_entr 0.3063577711582184, f1 0.503157913684845
ep17_l1_test_time 0.05900373400000092
Test Epoch17 layer2 Acc 0.4886842105263158, AUC 0.739891767501831, avg_entr 0.3053038716316223, f1 0.48868420720100403
ep17_l2_test_time 0.05958322700000451
Test Epoch17 layer3 Acc 0.4544736842105263, AUC 0.7110422849655151, avg_entr 0.2858298718929291, f1 0.45447367429733276
ep17_l3_test_time 0.06087759700000106
Test Epoch17 layer4 Acc 0.4523684210526316, AUC 0.7090287208557129, avg_entr 0.27726852893829346, f1 0.4523683786392212
ep17_l4_test_time 0.06152211200000579
gc 0
Train Epoch18 Acc 0.46928333333333333 (56314/120000), AUC 0.7255555391311646
ep18_train_time 4.527073377000008
Test Epoch18 layer0 Acc 0.5118421052631579, AUC 0.7652264833450317, avg_entr 0.2756447494029999, f1 0.5118421316146851
ep18_l0_test_time 0.06001545600000213
Test Epoch18 layer1 Acc 0.501578947368421, AUC 0.7466292977333069, avg_entr 0.29255297780036926, f1 0.5015789270401001
ep18_l1_test_time 0.05888443800000687
Test Epoch18 layer2 Acc 0.4831578947368421, AUC 0.7427350878715515, avg_entr 0.29251629114151, f1 0.4831579029560089
ep18_l2_test_time 0.05958953199998973
Test Epoch18 layer3 Acc 0.45342105263157895, AUC 0.7088541984558105, avg_entr 0.27146339416503906, f1 0.45342105627059937
ep18_l3_test_time 0.0610218760000123
Test Epoch18 layer4 Acc 0.44394736842105265, AUC 0.7068326473236084, avg_entr 0.26315200328826904, f1 0.44394737482070923
ep18_l4_test_time 0.061635627000001136
gc 0
Train Epoch19 Acc 0.469575 (56349/120000), AUC 0.7257640361785889
ep19_train_time 4.423583836000006
Test Epoch19 layer0 Acc 0.5247368421052632, AUC 0.7665404081344604, avg_entr 0.2709861397743225, f1 0.5247368216514587
ep19_l0_test_time 0.06009766299999342
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 19
Test Epoch19 layer1 Acc 0.5078947368421053, AUC 0.7462784051895142, avg_entr 0.2863883972167969, f1 0.50789475440979
ep19_l1_test_time 0.06750742600000592
Test Epoch19 layer2 Acc 0.4963157894736842, AUC 0.7398675680160522, avg_entr 0.2801584303379059, f1 0.49631577730178833
ep19_l2_test_time 0.059725446000001625
Test Epoch19 layer3 Acc 0.45421052631578945, AUC 0.7088829278945923, avg_entr 0.25980716943740845, f1 0.4542105197906494
ep19_l3_test_time 0.06068588899999838
Test Epoch19 layer4 Acc 0.44894736842105265, AUC 0.7071202397346497, avg_entr 0.24966996908187866, f1 0.44894737005233765
ep19_l4_test_time 0.061610858999998186
Best AUC tensor(0.5247) 19 0
train_as_loss [[4.58793612e+02 3.56933798e+02 3.51173428e+02 3.49885387e+02
  3.49395449e+02 3.49159191e+02 3.49028733e+02 3.48950142e+02
  3.48899885e+02 3.48866324e+02 3.48843185e+02 3.48826841e+02
  3.48815083e+02 3.48806501e+02 3.48800162e+02 3.48795435e+02
  3.48791898e+02 3.48789205e+02 3.48787180e+02 3.48785656e+02]
 [1.57601018e+00 1.33079763e-05 9.68309953e-07 1.91506274e-07
  5.64712147e-08 2.11101087e-08 1.25395345e-06 1.84299579e-05
  8.24808567e-05 2.03160641e-04 2.56840922e-04 2.79976071e-04
  2.55187086e-06 1.19329789e-09 1.53697070e-07 1.56495850e-04
  5.43958253e-08 9.01230596e-10 1.16099773e-09 3.78099782e-05]
 [1.64087942e+00 1.20374357e-05 9.67887997e-07 2.05447266e-07
  6.74905853e-08 2.90449575e-08 1.74059622e-06 3.55687112e-05
  1.88298081e-04 3.95912330e-04 4.70422483e-04 5.75341468e-04
  3.11560644e-05 4.53670177e-04 3.58039257e-04 1.22887464e-03
  1.88388347e-06 5.77473040e-04 4.52028966e-04 7.97529416e-04]
 [1.50070842e+00 1.01656374e-05 9.76819902e-07 2.51464781e-07
  1.07469312e-07 6.16083920e-08 1.89705081e-06 5.91911020e-05
  3.75186735e-04 8.56861105e-04 8.55484009e-04 1.12420727e-03
  2.58703236e-05 2.52662649e-04 2.22011448e-04 9.11530865e-04
  8.81808729e-07 2.29284014e-04 1.87671722e-04 3.58807932e-04]
 [1.65325633e+00 1.24571606e-05 1.38562673e-06 4.50281214e-07
  2.59728104e-07 1.89642360e-07 1.97208687e-06 8.27347845e-05
  6.03558302e-04 1.27385173e-03 1.15436114e-03 1.66021027e-03
  2.51154410e-05 2.26979546e-04 2.28687583e-04 9.30015864e-04
  9.65351686e-07 2.04696229e-04 1.75447486e-04 3.34643966e-04]]
train_ae_loss [[17.02211143 23.98300158 28.34767094 31.32955955 33.81106669 35.8422332
  37.56415791 38.98652127 40.54061807 41.80100335 43.1002491  44.33384757
  45.40269969 46.33587348 47.5033775  48.35916125 49.4376888  50.28388286
  51.02863326 51.9905212 ]
 [17.36552159 23.37779678 27.22769852 29.82440337 32.00351395 33.62181304
  35.01923084 36.1231759  37.46698241 38.53572769 39.47164942 40.49939254
  40.96376473 41.77709875 42.60557808 43.35527936 43.93112474 44.68687827
  45.36750478 46.00437005]
 [16.60396445 23.33957735 26.69331772 28.69972817 30.36331539 31.51145489
  32.55418634 33.34725035 34.34251448 35.14380295 35.84228388 36.59156156
  37.12689473 37.57645885 38.13461037 38.45950852 38.75715201 39.19497903
  39.46996273 39.79603186]
 [14.14130239 21.62448888 24.54718717 26.11931676 27.42786627 28.38119579
  29.21109476 29.91599453 30.64128241 31.25019407 31.75328779 32.26067449
  32.42114867 32.84007517 33.27270953 33.57348588 33.78405706 34.19714924
  34.50949559 34.7508348 ]
 [11.81215366 20.32469968 22.89528778 24.12383591 25.1371045  25.81694322
  26.427057   26.95006623 27.48633638 27.94275837 28.24261686 28.57702349
  28.62313285 28.96907204 29.32220282 29.56533761 29.70777047 30.03014748
  30.28524768 30.47774607]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 98.97620641399999
Start Testing
Load ckpt at ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt
gc 10
Test layer0 Acc 0.5234210526315789, AUC 0.7635568976402283, avg_entr 0.2645331621170044, f1 0.523421049118042
l0_test_time 0.058940743000007956
gc 0
Test layer1 Acc 0.49605263157894736, AUC 0.7375910878181458, avg_entr 0.2826567590236664, f1 0.496052622795105
l1_test_time 0.060021147000000497
gc 0
Test layer2 Acc 0.4934210526315789, AUC 0.7424623966217041, avg_entr 0.28295445442199707, f1 0.4934210479259491
l2_test_time 0.061313948999995205
gc 0
Test layer3 Acc 0.4668421052631579, AUC 0.7230415344238281, avg_entr 0.2548661231994629, f1 0.4668421447277069
l3_test_time 0.062167602000002375
gc 0
Test layer4 Acc 0.455, AUC 0.7215383052825928, avg_entr 0.24463069438934326, f1 0.45500001311302185
l4_test_time 0.063182402999999
gc 0
Test threshold 0.1 Acc 0.5252631578947369, AUC 0.7713272571563721, avg_entr 0.121816486120224, f1 0.5252631306648254
t0.1_test_time 0.11149082800000087
gc 0
Test threshold 0.2 Acc 0.5226315789473684, AUC 0.7636112570762634, avg_entr 0.11948896944522858, f1 0.5226315855979919
t0.2_test_time 0.09718126799999993
gc 0
Test threshold 0.3 Acc 0.5252631578947369, AUC 0.7618857622146606, avg_entr 0.1580054610967636, f1 0.5252631306648254
t0.3_test_time 0.08659110499999656
gc 0
Test threshold 0.4 Acc 0.5239473684210526, AUC 0.7629517316818237, avg_entr 0.17862054705619812, f1 0.5239473581314087
t0.4_test_time 0.07832049499999982
gc 0
Test threshold 0.5 Acc 0.5234210526315789, AUC 0.7629055976867676, avg_entr 0.18886595964431763, f1 0.523421049118042
t0.5_test_time 0.07509786800000029
gc 0
Test threshold 0.6 Acc 0.5234210526315789, AUC 0.7635824084281921, avg_entr 0.19071756303310394, f1 0.523421049118042
t0.6_test_time 0.07193487399999299
gc 0
Test threshold 0.7 Acc 0.5234210526315789, AUC 0.7635568976402283, avg_entr 0.19082032144069672, f1 0.523421049118042
t0.7_test_time 0.0714989829999979
gc 0
Test threshold 0.8 Acc 0.5234210526315789, AUC 0.7635568976402283, avg_entr 0.19082032144069672, f1 0.523421049118042
t0.8_test_time 0.07180007799999544
gc 0
Test threshold 0.9 Acc 0.5234210526315789, AUC 0.7635568976402283, avg_entr 0.19082032144069672, f1 0.523421049118042
t0.9_test_time 0.07124638900000946
