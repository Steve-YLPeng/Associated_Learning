total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearALsideText(
  (layers): ModuleList(
    (0): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.0.weight 90000
layers.0.enc.f.0.bias 300
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 45777392
init_time 15.506979831999999
Start Training
gc 0
Train Epoch0 Acc 0.28625833333333334 (34351/120000), AUC 0.517341136932373
ep0_train_time 4.824749574000002
Test Epoch0 layer0 Acc 0.36447368421052634, AUC 0.684821605682373, avg_entr 1.1858923435211182, f1 0.3644736409187317
ep0_l0_test_time 0.06167122900000166
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.3489473684210526, AUC 0.6493387222290039, avg_entr 1.2000137567520142, f1 0.3489473760128021
ep0_l1_test_time 0.06721650200000084
Test Epoch0 layer2 Acc 0.33342105263157895, AUC 0.6118640899658203, avg_entr 1.1973305940628052, f1 0.3334210515022278
ep0_l2_test_time 0.06010548699999774
Test Epoch0 layer3 Acc 0.3118421052631579, AUC 0.5846892595291138, avg_entr 1.2106573581695557, f1 0.3118421137332916
ep0_l3_test_time 0.060319155999998486
Test Epoch0 layer4 Acc 0.2844736842105263, AUC 0.5755806565284729, avg_entr 1.2256540060043335, f1 0.2844736874103546
ep0_l4_test_time 0.061321792999997626
gc 0
Train Epoch1 Acc 0.3428333333333333 (41140/120000), AUC 0.5983089208602905
ep1_train_time 4.420556731000001
Test Epoch1 layer0 Acc 0.4676315789473684, AUC 0.7313268184661865, avg_entr 0.8658331632614136, f1 0.46763157844543457
ep1_l0_test_time 0.059876632000001706
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.4357894736842105, AUC 0.7197776436805725, avg_entr 0.8712336421012878, f1 0.43578946590423584
ep1_l1_test_time 0.06700102799999996
Test Epoch1 layer2 Acc 0.37605263157894736, AUC 0.6759387254714966, avg_entr 0.8805409073829651, f1 0.3760526180267334
ep1_l2_test_time 0.0601497949999974
Test Epoch1 layer3 Acc 0.3618421052631579, AUC 0.6429135203361511, avg_entr 0.8865644335746765, f1 0.3618421256542206
ep1_l3_test_time 0.060404748999999924
Test Epoch1 layer4 Acc 0.3531578947368421, AUC 0.6353031396865845, avg_entr 0.8976977467536926, f1 0.3531579077243805
ep1_l4_test_time 0.06127324100000209
gc 0
Train Epoch2 Acc 0.406575 (48789/120000), AUC 0.6668586730957031
ep2_train_time 4.391265147999999
Test Epoch2 layer0 Acc 0.4886842105263158, AUC 0.7416735291481018, avg_entr 0.7011668086051941, f1 0.48868420720100403
ep2_l0_test_time 0.06026311600000156
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.4855263157894737, AUC 0.7385355830192566, avg_entr 0.713403582572937, f1 0.48552632331848145
ep2_l1_test_time 0.06808985400000012
Test Epoch2 layer2 Acc 0.4531578947368421, AUC 0.7119419574737549, avg_entr 0.7301347255706787, f1 0.453157901763916
ep2_l2_test_time 0.059942757999998264
Test Epoch2 layer3 Acc 0.4268421052631579, AUC 0.6874732375144958, avg_entr 0.7137344479560852, f1 0.4268420934677124
ep2_l3_test_time 0.0612375620000023
Test Epoch2 layer4 Acc 0.4181578947368421, AUC 0.6836649775505066, avg_entr 0.7237723469734192, f1 0.4181579053401947
ep2_l4_test_time 0.061491699000001177
gc 0
Train Epoch3 Acc 0.44879166666666664 (53855/120000), AUC 0.7002091407775879
ep3_train_time 4.3973282010000005
Test Epoch3 layer0 Acc 0.49605263157894736, AUC 0.7447681427001953, avg_entr 0.6240679025650024, f1 0.496052622795105
ep3_l0_test_time 0.05970802200000236
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.5047368421052632, AUC 0.742285430431366, avg_entr 0.6315414309501648, f1 0.5047368407249451
ep3_l1_test_time 0.06469176999999604
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.4689473684210526, AUC 0.7248938679695129, avg_entr 0.6267373561859131, f1 0.4689473807811737
ep3_l2_test_time 0.06392596100000247
Test Epoch3 layer3 Acc 0.4618421052631579, AUC 0.7062264680862427, avg_entr 0.6321402192115784, f1 0.4618421196937561
ep3_l3_test_time 0.060310096999998564
Test Epoch3 layer4 Acc 0.45789473684210524, AUC 0.7030616998672485, avg_entr 0.6244149804115295, f1 0.4578947424888611
ep3_l4_test_time 0.06115228299999842
gc 0
Train Epoch4 Acc 0.46005 (55206/120000), AUC 0.7123204469680786
ep4_train_time 4.444167542000002
Test Epoch4 layer0 Acc 0.5021052631578947, AUC 0.7468934655189514, avg_entr 0.568422794342041, f1 0.5021052360534668
ep4_l0_test_time 0.06003293999999926
Test Epoch4 layer1 Acc 0.5044736842105263, AUC 0.7442177534103394, avg_entr 0.569221019744873, f1 0.5044736862182617
ep4_l1_test_time 0.059041258000000596
Test Epoch4 layer2 Acc 0.4789473684210526, AUC 0.7289140224456787, avg_entr 0.5721600651741028, f1 0.47894737124443054
ep4_l2_test_time 0.061299162000004515
Test Epoch4 layer3 Acc 0.4631578947368421, AUC 0.7116468548774719, avg_entr 0.562720775604248, f1 0.46315789222717285
ep4_l3_test_time 0.061015173000001255
Test Epoch4 layer4 Acc 0.46, AUC 0.7111051678657532, avg_entr 0.5588080286979675, f1 0.46000000834465027
ep4_l4_test_time 0.061287732000003814
gc 0
Train Epoch5 Acc 0.4683333333333333 (56200/120000), AUC 0.7189110517501831
ep5_train_time 4.486611625000002
Test Epoch5 layer0 Acc 0.4971052631578947, AUC 0.7476686835289001, avg_entr 0.5202934145927429, f1 0.49710527062416077
ep5_l0_test_time 0.06013885899999849
Test Epoch5 layer1 Acc 0.48789473684210527, AUC 0.745538592338562, avg_entr 0.5216294527053833, f1 0.487894743680954
ep5_l1_test_time 0.05882739500000156
Test Epoch5 layer2 Acc 0.4768421052631579, AUC 0.732854962348938, avg_entr 0.5251823663711548, f1 0.47684210538864136
ep5_l2_test_time 0.059292467999995324
Test Epoch5 layer3 Acc 0.4513157894736842, AUC 0.7092839479446411, avg_entr 0.517087459564209, f1 0.4513157904148102
ep5_l3_test_time 0.060574423000005595
Test Epoch5 layer4 Acc 0.45973684210526317, AUC 0.7112177014350891, avg_entr 0.49532487988471985, f1 0.4597368538379669
ep5_l4_test_time 0.06123352099999835
gc 0
Train Epoch6 Acc 0.470075 (56409/120000), AUC 0.7215436697006226
ep6_train_time 4.446470480999999
Test Epoch6 layer0 Acc 0.47868421052631577, AUC 0.7485183477401733, avg_entr 0.4783874452114105, f1 0.4786842167377472
ep6_l0_test_time 0.06033343200000019
Test Epoch6 layer1 Acc 0.48078947368421054, AUC 0.7451891899108887, avg_entr 0.48365530371665955, f1 0.4807894825935364
ep6_l1_test_time 0.05925140400000117
Test Epoch6 layer2 Acc 0.4626315789473684, AUC 0.7337291240692139, avg_entr 0.4810642898082733, f1 0.46263158321380615
ep6_l2_test_time 0.05955357100000214
Test Epoch6 layer3 Acc 0.4544736842105263, AUC 0.7132536768913269, avg_entr 0.47437170147895813, f1 0.45447367429733276
ep6_l3_test_time 0.06053437900000347
Test Epoch6 layer4 Acc 0.45, AUC 0.7188385725021362, avg_entr 0.462902307510376, f1 0.44999998807907104
ep6_l4_test_time 0.06109005999999795
gc 0
Train Epoch7 Acc 0.47386666666666666 (56864/120000), AUC 0.7251964211463928
ep7_train_time 4.485985687000003
Test Epoch7 layer0 Acc 0.5031578947368421, AUC 0.7496335506439209, avg_entr 0.44975364208221436, f1 0.503157913684845
ep7_l0_test_time 0.05964977699999707
Test Epoch7 layer1 Acc 0.5042105263157894, AUC 0.745151162147522, avg_entr 0.4675647020339966, f1 0.5042105317115784
ep7_l1_test_time 0.059090388000001326
Test Epoch7 layer2 Acc 0.4842105263157895, AUC 0.7361122369766235, avg_entr 0.4658960998058319, f1 0.4842105209827423
ep7_l2_test_time 0.05951401600000139
Test Epoch7 layer3 Acc 0.4718421052631579, AUC 0.7147538661956787, avg_entr 0.4435533285140991, f1 0.47184211015701294
ep7_l3_test_time 0.060625045999998406
Test Epoch7 layer4 Acc 0.4639473684210526, AUC 0.7195460796356201, avg_entr 0.42754510045051575, f1 0.4639473557472229
ep7_l4_test_time 0.06134024199999999
gc 0
Train Epoch8 Acc 0.4752 (57024/120000), AUC 0.7264809608459473
ep8_train_time 4.449024100000003
Test Epoch8 layer0 Acc 0.4957894736842105, AUC 0.7508717775344849, avg_entr 0.42592358589172363, f1 0.49578946828842163
ep8_l0_test_time 0.0601280169999967
Test Epoch8 layer1 Acc 0.4968421052631579, AUC 0.7449822425842285, avg_entr 0.4355138838291168, f1 0.4968421161174774
ep8_l1_test_time 0.05862523199999714
Test Epoch8 layer2 Acc 0.47157894736842104, AUC 0.7299513220787048, avg_entr 0.4271264672279358, f1 0.4715789556503296
ep8_l2_test_time 0.05974782999999917
Test Epoch8 layer3 Acc 0.4607894736842105, AUC 0.7152311205863953, avg_entr 0.4190022051334381, f1 0.4607894718647003
ep8_l3_test_time 0.06039818899999716
Test Epoch8 layer4 Acc 0.45842105263157895, AUC 0.7178707122802734, avg_entr 0.4064653217792511, f1 0.4584210515022278
ep8_l4_test_time 0.061249551999999596
gc 0
Train Epoch9 Acc 0.4769833333333333 (57238/120000), AUC 0.7287019491195679
ep9_train_time 4.381863183999997
Test Epoch9 layer0 Acc 0.49394736842105263, AUC 0.7513865828514099, avg_entr 0.41209718585014343, f1 0.4939473271369934
ep9_l0_test_time 0.059401115000000004
Test Epoch9 layer1 Acc 0.49657894736842106, AUC 0.7442173957824707, avg_entr 0.43420714139938354, f1 0.49657896161079407
ep9_l1_test_time 0.05880916699999261
Test Epoch9 layer2 Acc 0.45342105263157895, AUC 0.7325015068054199, avg_entr 0.44268354773521423, f1 0.45342105627059937
ep9_l2_test_time 0.05920016299999986
Test Epoch9 layer3 Acc 0.4602631578947368, AUC 0.7128521800041199, avg_entr 0.41517373919487, f1 0.4602631628513336
ep9_l3_test_time 0.06039429599999835
Test Epoch9 layer4 Acc 0.45263157894736844, AUC 0.7158401608467102, avg_entr 0.3991381525993347, f1 0.4526315927505493
ep9_l4_test_time 0.06134700799999848
gc 0
Train Epoch10 Acc 0.47526666666666667 (57032/120000), AUC 0.7281975746154785
ep10_train_time 4.390494610999994
Test Epoch10 layer0 Acc 0.4968421052631579, AUC 0.7520439624786377, avg_entr 0.4033319056034088, f1 0.4968421161174774
ep10_l0_test_time 0.060046819999996615
Test Epoch10 layer1 Acc 0.5047368421052632, AUC 0.7440881133079529, avg_entr 0.39527398347854614, f1 0.5047368407249451
ep10_l1_test_time 0.05897794099999487
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 10
Test Epoch10 layer2 Acc 0.47, AUC 0.7356830835342407, avg_entr 0.3989316523075104, f1 0.4699999988079071
ep10_l2_test_time 0.06446277100000941
Test Epoch10 layer3 Acc 0.4660526315789474, AUC 0.7119211554527283, avg_entr 0.3889896869659424, f1 0.4660526216030121
ep10_l3_test_time 0.06073137500000314
Test Epoch10 layer4 Acc 0.46421052631578946, AUC 0.7177919149398804, avg_entr 0.3673652708530426, f1 0.46421054005622864
ep10_l4_test_time 0.061376146999990056
gc 0
Train Epoch11 Acc 0.475625 (57075/120000), AUC 0.7285175323486328
ep11_train_time 4.482370051000004
Test Epoch11 layer0 Acc 0.4934210526315789, AUC 0.7535930871963501, avg_entr 0.3715749979019165, f1 0.4934210479259491
ep11_l0_test_time 0.0601119720000014
Test Epoch11 layer1 Acc 0.5005263157894737, AUC 0.7409065961837769, avg_entr 0.38365304470062256, f1 0.5005263090133667
ep11_l1_test_time 0.05885915500000749
Test Epoch11 layer2 Acc 0.47842105263157897, AUC 0.7329433560371399, avg_entr 0.38271453976631165, f1 0.47842106223106384
ep11_l2_test_time 0.059059695000001966
Test Epoch11 layer3 Acc 0.46789473684210525, AUC 0.715988039970398, avg_entr 0.35573965311050415, f1 0.4678947329521179
ep11_l3_test_time 0.060264579999994794
Test Epoch11 layer4 Acc 0.47, AUC 0.7195594906806946, avg_entr 0.33979228138923645, f1 0.4699999988079071
ep11_l4_test_time 0.061263992999997186
gc 0
Train Epoch12 Acc 0.4755083333333333 (57061/120000), AUC 0.7286457419395447
ep12_train_time 4.391194235
Test Epoch12 layer0 Acc 0.5047368421052632, AUC 0.7543444633483887, avg_entr 0.35125359892845154, f1 0.5047368407249451
ep12_l0_test_time 0.06039556999999718
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 12
Test Epoch12 layer1 Acc 0.5002631578947369, AUC 0.7414904832839966, avg_entr 0.36299315094947815, f1 0.5002631545066833
ep12_l1_test_time 0.06671746399999279
Test Epoch12 layer2 Acc 0.4868421052631579, AUC 0.7353415489196777, avg_entr 0.36585623025894165, f1 0.4868420958518982
ep12_l2_test_time 0.06002035299999875
Test Epoch12 layer3 Acc 0.4818421052631579, AUC 0.718350887298584, avg_entr 0.34082019329071045, f1 0.4818421006202698
ep12_l3_test_time 0.06056817800001113
Test Epoch12 layer4 Acc 0.4747368421052632, AUC 0.721744954586029, avg_entr 0.3185920715332031, f1 0.4747368395328522
ep12_l4_test_time 0.061666649999992273
gc 0
Train Epoch13 Acc 0.47768333333333335 (57322/120000), AUC 0.7309774160385132
ep13_train_time 4.416442242000002
Test Epoch13 layer0 Acc 0.5113157894736842, AUC 0.7558929920196533, avg_entr 0.3337257206439972, f1 0.5113157629966736
ep13_l0_test_time 0.0597693810000095
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 13
Test Epoch13 layer1 Acc 0.501578947368421, AUC 0.7424638271331787, avg_entr 0.35531625151634216, f1 0.5015789270401001
ep13_l1_test_time 0.06643119000000297
Test Epoch13 layer2 Acc 0.49236842105263157, AUC 0.7356481552124023, avg_entr 0.36119168996810913, f1 0.4923684298992157
ep13_l2_test_time 0.05968958900000132
Test Epoch13 layer3 Acc 0.47289473684210526, AUC 0.721644937992096, avg_entr 0.33833083510398865, f1 0.47289472818374634
ep13_l3_test_time 0.06036841499999923
Test Epoch13 layer4 Acc 0.4792105263157895, AUC 0.7229927778244019, avg_entr 0.31380119919776917, f1 0.4792105257511139
ep13_l4_test_time 0.06583011799999383
gc 0
Train Epoch14 Acc 0.4797416666666667 (57569/120000), AUC 0.7324497699737549
ep14_train_time 4.40448851699999
Test Epoch14 layer0 Acc 0.5039473684210526, AUC 0.7568036317825317, avg_entr 0.3317795991897583, f1 0.503947377204895
ep14_l0_test_time 0.06081325600000298
Test Epoch14 layer1 Acc 0.501578947368421, AUC 0.7422336935997009, avg_entr 0.3352542221546173, f1 0.5015789270401001
ep14_l1_test_time 0.060108330000005594
Test Epoch14 layer2 Acc 0.483421052631579, AUC 0.7364033460617065, avg_entr 0.3396768867969513, f1 0.48342105746269226
ep14_l2_test_time 0.059626385999990816
Test Epoch14 layer3 Acc 0.4763157894736842, AUC 0.7205057144165039, avg_entr 0.3232322931289673, f1 0.47631579637527466
ep14_l3_test_time 0.06023494599999424
Test Epoch14 layer4 Acc 0.475, AUC 0.7233304977416992, avg_entr 0.30003821849823, f1 0.4749999940395355
ep14_l4_test_time 0.06134375100000966
gc 0
Train Epoch15 Acc 0.48035833333333333 (57643/120000), AUC 0.7333645820617676
ep15_train_time 4.451179353000001
Test Epoch15 layer0 Acc 0.5081578947368421, AUC 0.7587586641311646, avg_entr 0.30563172698020935, f1 0.5081579089164734
ep15_l0_test_time 0.05992093999999781
Test Epoch15 layer1 Acc 0.48947368421052634, AUC 0.7420754432678223, avg_entr 0.32039743661880493, f1 0.4894736707210541
ep15_l1_test_time 0.058710930000003714
Test Epoch15 layer2 Acc 0.4760526315789474, AUC 0.7366745471954346, avg_entr 0.32320061326026917, f1 0.4760526418685913
ep15_l2_test_time 0.05951873799999419
Test Epoch15 layer3 Acc 0.4631578947368421, AUC 0.7201334238052368, avg_entr 0.29643335938453674, f1 0.46315789222717285
ep15_l3_test_time 0.06115656000000058
Test Epoch15 layer4 Acc 0.4689473684210526, AUC 0.7222729325294495, avg_entr 0.2747851312160492, f1 0.4689473807811737
ep15_l4_test_time 0.06224503300001061
gc 0
Train Epoch16 Acc 0.4808 (57696/120000), AUC 0.733411967754364
ep16_train_time 4.416247240000004
Test Epoch16 layer0 Acc 0.5057894736842106, AUC 0.7603696584701538, avg_entr 0.2902618646621704, f1 0.5057894587516785
ep16_l0_test_time 0.05996074399999429
Test Epoch16 layer1 Acc 0.5007894736842106, AUC 0.7425544261932373, avg_entr 0.3093862533569336, f1 0.50078946352005
ep16_l1_test_time 0.05884606899999767
Test Epoch16 layer2 Acc 0.4797368421052632, AUC 0.736115574836731, avg_entr 0.3144334852695465, f1 0.4797368347644806
ep16_l2_test_time 0.059494783000005214
Test Epoch16 layer3 Acc 0.46, AUC 0.7186021208763123, avg_entr 0.2927238643169403, f1 0.46000000834465027
ep16_l3_test_time 0.06029906499999527
Test Epoch16 layer4 Acc 0.4623684210526316, AUC 0.7204358577728271, avg_entr 0.27113768458366394, f1 0.4623684287071228
ep16_l4_test_time 0.061512342999989755
gc 0
Train Epoch17 Acc 0.48065833333333335 (57679/120000), AUC 0.733029305934906
ep17_train_time 4.454018134999998
Test Epoch17 layer0 Acc 0.5052631578947369, AUC 0.7620788812637329, avg_entr 0.29574716091156006, f1 0.5052631497383118
ep17_l0_test_time 0.06140992600001027
Test Epoch17 layer1 Acc 0.4976315789473684, AUC 0.7426035404205322, avg_entr 0.30512914061546326, f1 0.49763157963752747
ep17_l1_test_time 0.06048817599999268
Test Epoch17 layer2 Acc 0.48605263157894735, AUC 0.7367632389068604, avg_entr 0.2984364330768585, f1 0.48605263233184814
ep17_l2_test_time 0.06421735800000761
Test Epoch17 layer3 Acc 0.4755263157894737, AUC 0.7228896617889404, avg_entr 0.27841871976852417, f1 0.4755263030529022
ep17_l3_test_time 0.06372000999999727
Test Epoch17 layer4 Acc 0.46842105263157896, AUC 0.7238664627075195, avg_entr 0.2535102665424347, f1 0.4684210419654846
ep17_l4_test_time 0.06334168199998658
gc 0
Train Epoch18 Acc 0.480325 (57639/120000), AUC 0.7340620756149292
ep18_train_time 4.479925121999997
Test Epoch18 layer0 Acc 0.5052631578947369, AUC 0.7630079984664917, avg_entr 0.2711632549762726, f1 0.5052631497383118
ep18_l0_test_time 0.06020977900000446
Test Epoch18 layer1 Acc 0.4986842105263158, AUC 0.7426629066467285, avg_entr 0.2890387177467346, f1 0.49868419766426086
ep18_l1_test_time 0.05901235299999996
Test Epoch18 layer2 Acc 0.48947368421052634, AUC 0.7376371622085571, avg_entr 0.2902028262615204, f1 0.4894736707210541
ep18_l2_test_time 0.059442309999994336
Test Epoch18 layer3 Acc 0.48026315789473684, AUC 0.7220665216445923, avg_entr 0.2683700919151306, f1 0.4802631437778473
ep18_l3_test_time 0.060632945999998356
Test Epoch18 layer4 Acc 0.47289473684210526, AUC 0.7241097092628479, avg_entr 0.24658319354057312, f1 0.47289472818374634
ep18_l4_test_time 0.06147911200000067
gc 0
Train Epoch19 Acc 0.4820333333333333 (57844/120000), AUC 0.7339620590209961
ep19_train_time 4.452625589999997
Test Epoch19 layer0 Acc 0.5176315789473684, AUC 0.764923632144928, avg_entr 0.2633935213088989, f1 0.5176315903663635
ep19_l0_test_time 0.06011121499999206
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 19
Test Epoch19 layer1 Acc 0.4986842105263158, AUC 0.7431358098983765, avg_entr 0.2817448377609253, f1 0.49868419766426086
ep19_l1_test_time 0.06661164999999869
Test Epoch19 layer2 Acc 0.4813157894736842, AUC 0.7382559776306152, avg_entr 0.28354373574256897, f1 0.4813157916069031
ep19_l2_test_time 0.05993649900000264
Test Epoch19 layer3 Acc 0.4705263157894737, AUC 0.7196157574653625, avg_entr 0.2601613998413086, f1 0.4705263078212738
ep19_l3_test_time 0.060623089999992885
Test Epoch19 layer4 Acc 0.4747368421052632, AUC 0.72212815284729, avg_entr 0.2402755469083786, f1 0.4747368395328522
ep19_l4_test_time 0.06154187799999988
Best AUC tensor(0.5176) 19 0
train_as_loss [[4.52100224e+02 3.56384232e+02 3.51021988e+02 3.49816597e+02
  3.49357243e+02 3.49135531e+02 3.49013067e+02 3.48939291e+02
  3.48892134e+02 3.48860662e+02 3.48838979e+02 3.48823686e+02
  3.48812691e+02 3.48804673e+02 3.48798762e+02 3.48794360e+02
  3.48791065e+02 3.48788572e+02 3.48786693e+02 3.48785232e+02]
 [1.82949682e+00 1.82965382e-05 1.36168078e-06 2.87024377e-07
  9.03530530e-08 3.76376542e-07 9.11160560e-07 1.08335561e-05
  5.70830346e-05 1.20984106e-04 4.72707262e-06 2.91264473e-09
  8.31739649e-07 8.14386023e-05 2.97030529e-09 1.60854224e-09
  2.35648078e-08 2.49430887e-05 5.17846829e-07 1.07019523e-09]
 [2.05043288e+00 1.31837882e-05 1.10615079e-06 2.54262863e-07
  8.80769567e-08 6.32417816e-08 2.78892525e-07 1.58839131e-05
  1.31074946e-04 2.73406699e-04 5.49787847e-05 2.27454646e-04
  1.28184935e-05 1.03333822e-04 5.86331065e-09 1.15050282e-04
  4.77822817e-05 2.41675934e-04 1.21028176e-04 1.03485794e-04]
 [1.95256502e+00 1.72521548e-05 1.60942397e-06 4.05262811e-07
  1.58526919e-07 1.06611718e-07 3.84241863e-07 3.12714835e-05
  3.01488968e-04 6.20497084e-04 3.93953616e-04 4.82938505e-04
  1.86316781e-04 1.09684131e-03 9.41071689e-08 1.27639511e-03
  2.34607064e-04 1.31358432e-03 6.91086092e-04 7.27672657e-04]
 [1.89622017e+00 1.88420799e-05 1.98181292e-06 6.17056913e-07
  3.02377594e-07 2.30450052e-07 6.28485204e-07 4.81695437e-05
  5.08823877e-04 1.02210587e-03 1.43373729e-03 6.21188355e-04
  1.52235159e-04 6.76992053e-04 1.46940318e-07 9.43442281e-04
  1.74360867e-04 9.06646420e-04 6.12753566e-04 6.33571372e-04]]
train_ae_loss [[17.83659323 24.7169838  28.98815994 32.1478783  34.55316206 36.57297763
  38.51097327 40.01675028 41.49025188 42.7436915  44.16642568 45.28589814
  46.57643059 47.58466896 48.59264369 49.60985627 50.65486181 51.64392554
  52.5087366  53.2752706 ]
 [17.85824526 24.54032928 27.93939    30.38804705 32.35382108 33.87876564
  35.40922169 36.55776992 37.76258209 38.70344026 39.53216169 40.51766314
  41.49583201 42.24203149 42.85204334 43.58051713 44.32061189 45.03041295
  45.58031446 46.26009405]
 [17.52710522 23.26498105 26.04536497 27.57660453 28.88247591 29.87537705
  30.87561439 31.67011634 32.49916083 33.0997053  33.8209091  34.45004003
  34.72058161 35.24308791 35.7450479  36.1620072  36.58274993 37.05044913
  37.32843778 37.70830037]
 [14.08927642 21.50833178 24.05249699 25.34306658 26.41812679 27.26039478
  28.05667028 28.6808262  29.30654582 29.8204846  30.35634064 30.84221924
  31.35121033 31.64939812 31.93813652 32.22422279 32.42013169 32.71755034
  32.88766555 33.09061995]
 [11.26809773 19.1549929  21.41245308 22.36131806 23.12912176 23.74983429
  24.34752131 24.78105375 25.24222041 25.59394911 25.89876254 26.24021653
  26.49821981 26.69974111 26.91525941 27.12306205 27.29905731 27.53390159
  27.67788616 27.84129824]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 98.11716879
Start Testing
Load ckpt at ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt
gc 10
Test layer0 Acc 0.5139473684210526, AUC 0.7594093084335327, avg_entr 0.26224198937416077, f1 0.5139473676681519
l0_test_time 0.05890111499999762
gc 0
Test layer1 Acc 0.49026315789473685, AUC 0.7296066284179688, avg_entr 0.2798177897930145, f1 0.4902631640434265
l1_test_time 0.060081386999996766
gc 0
Test layer2 Acc 0.4968421052631579, AUC 0.741442859172821, avg_entr 0.28456923365592957, f1 0.4968421161174774
l2_test_time 0.060820135000000164
gc 0
Test layer3 Acc 0.4694736842105263, AUC 0.7234271764755249, avg_entr 0.25904154777526855, f1 0.4694736897945404
l3_test_time 0.061372210000001814
gc 0
Test layer4 Acc 0.4676315789473684, AUC 0.7239845395088196, avg_entr 0.23714561760425568, f1 0.46763157844543457
l4_test_time 0.06262353500000017
gc 0
Test threshold 0.1 Acc 0.5205263157894737, AUC 0.7619468569755554, avg_entr 0.12372889369726181, f1 0.5205262899398804
t0.1_test_time 0.1125718680000034
gc 0
Test threshold 0.2 Acc 0.5155263157894737, AUC 0.7516682744026184, avg_entr 0.12268759310245514, f1 0.515526294708252
t0.2_test_time 0.09680964599999697
gc 0
Test threshold 0.3 Acc 0.5284210526315789, AUC 0.7578034996986389, avg_entr 0.15897980332374573, f1 0.5284210443496704
t0.3_test_time 0.08722588699998823
gc 0
Test threshold 0.4 Acc 0.5205263157894737, AUC 0.7591602802276611, avg_entr 0.1776256561279297, f1 0.5205262899398804
t0.4_test_time 0.07705108900000823
gc 0
Test threshold 0.5 Acc 0.515, AUC 0.7591424584388733, avg_entr 0.18683746457099915, f1 0.5149999856948853
t0.5_test_time 0.07465237800001034
gc 0
Test threshold 0.6 Acc 0.5139473684210526, AUC 0.7594093084335327, avg_entr 0.1891675889492035, f1 0.5139473676681519
t0.6_test_time 0.07140125800000874
gc 0
Test threshold 0.7 Acc 0.5139473684210526, AUC 0.7594093084335327, avg_entr 0.1891675889492035, f1 0.5139473676681519
t0.7_test_time 0.07171324700000525
gc 0
Test threshold 0.8 Acc 0.5139473684210526, AUC 0.7594093084335327, avg_entr 0.1891675889492035, f1 0.5139473676681519
t0.8_test_time 0.07133664999999212
gc 0
Test threshold 0.9 Acc 0.5139473684210526, AUC 0.7594093084335327, avg_entr 0.1891675889492035, f1 0.5139473676681519
t0.9_test_time 0.07164659199999335
