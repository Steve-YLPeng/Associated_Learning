total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.2_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.91835 (110202/120000), AUC 0.9853003025054932
ep0_train_time 6.313270092010498
Test Epoch0 threshold 0.2 Acc 0.9138157894736842, AUC 0.9804302453994751, avg_entr 0.020918726921081543
ep0_t0.2_test_time 0.10253477096557617
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.2_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9491666666666667 (113900/120000), AUC 0.9928935766220093
ep1_train_time 5.8388426303863525
Test Epoch1 threshold 0.2 Acc 0.9110197368421052, AUC 0.9797611832618713, avg_entr 0.0193451177328825
ep1_t0.2_test_time 0.09948396682739258
gc 0
Train Epoch2 Acc 0.9507583333333334 (114091/120000), AUC 0.9930534958839417
ep2_train_time 5.852254629135132
Test Epoch2 threshold 0.2 Acc 0.9121710526315789, AUC 0.9796353578567505, avg_entr 0.01793137565255165
ep2_t0.2_test_time 0.09983992576599121
gc 0
Train Epoch3 Acc 0.952775 (114333/120000), AUC 0.9933450222015381
ep3_train_time 5.853339910507202
Test Epoch3 threshold 0.2 Acc 0.9115131578947369, AUC 0.9796048402786255, avg_entr 0.018367934972047806
ep3_t0.2_test_time 0.09769034385681152
gc 0
Train Epoch4 Acc 0.9533416666666666 (114401/120000), AUC 0.993748664855957
ep4_train_time 5.891032457351685
Test Epoch4 threshold 0.2 Acc 0.9092105263157895, AUC 0.9790827035903931, avg_entr 0.017266539856791496
ep4_t0.2_test_time 0.09804224967956543
gc 0
Train Epoch5 Acc 0.9559916666666667 (114719/120000), AUC 0.9945197105407715
ep5_train_time 5.886190891265869
Test Epoch5 threshold 0.2 Acc 0.9105263157894737, AUC 0.9790133833885193, avg_entr 0.017493151128292084
ep5_t0.2_test_time 0.09773612022399902
gc 0
Train Epoch6 Acc 0.9566333333333333 (114796/120000), AUC 0.994825005531311
ep6_train_time 5.83153772354126
Test Epoch6 threshold 0.2 Acc 0.9085526315789474, AUC 0.9787355065345764, avg_entr 0.0170033797621727
ep6_t0.2_test_time 0.09840130805969238
gc 0
Train Epoch7 Acc 0.9570416666666667 (114845/120000), AUC 0.9948887825012207
ep7_train_time 5.903862714767456
Test Epoch7 threshold 0.2 Acc 0.909375, AUC 0.9785140156745911, avg_entr 0.016677331179380417
ep7_t0.2_test_time 0.0968618392944336
gc 0
Train Epoch8 Acc 0.95735 (114882/120000), AUC 0.9950390458106995
ep8_train_time 6.074390888214111
Test Epoch8 threshold 0.2 Acc 0.9082236842105263, AUC 0.9785800576210022, avg_entr 0.01670726202428341
ep8_t0.2_test_time 0.10058331489562988
gc 0
Train Epoch9 Acc 0.959025 (115083/120000), AUC 0.9954672455787659
ep9_train_time 6.299452543258667
Test Epoch9 threshold 0.2 Acc 0.9090460526315789, AUC 0.97823166847229, avg_entr 0.016455601900815964
ep9_t0.2_test_time 0.09972500801086426
Best AUC 0.9804302453994751
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.2_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9184210526315789, AUC 0.9855813980102539, avg_entr 0.022400401532649994
t0.2_test_time 0.0271146297454834
