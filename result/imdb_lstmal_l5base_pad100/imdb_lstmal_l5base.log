total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 24.428828954696655
Start Training
gc 0
Train Epoch0 Acc 0.5077 (20308/40000), AUC 0.5154870748519897
ep0_train_time 36.84142231941223
Test Epoch0 layer4 Acc 0.6582, AUC 0.756009042263031, avg_entr 0.6954835653305054
ep0_l4_test_time 1.2269930839538574
Save ckpt to ckpt/imdb_lstmal_l5base_pad100//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.8231 (32924/40000), AUC 0.8827284574508667
ep1_train_time 36.511354207992554
Test Epoch1 layer4 Acc 0.8198, AUC 0.9002471566200256, avg_entr 0.13905517756938934
ep1_l4_test_time 1.2329661846160889
Save ckpt to ckpt/imdb_lstmal_l5base_pad100//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.884275 (35371/40000), AUC 0.9469228982925415
ep2_train_time 36.567362546920776
Test Epoch2 layer4 Acc 0.8322, AUC 0.9074828624725342, avg_entr 0.11189032346010208
ep2_l4_test_time 1.232128620147705
Save ckpt to ckpt/imdb_lstmal_l5base_pad100//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.910075 (36403/40000), AUC 0.965984582901001
ep3_train_time 36.618279695510864
Test Epoch3 layer4 Acc 0.8226, AUC 0.9051276445388794, avg_entr 0.0852382704615593
ep3_l4_test_time 1.2405965328216553
gc 0
Train Epoch4 Acc 0.928475 (37139/40000), AUC 0.9760020971298218
ep4_train_time 36.62202715873718
Test Epoch4 layer4 Acc 0.8254, AUC 0.899120569229126, avg_entr 0.06955422461032867
ep4_l4_test_time 1.2371675968170166
gc 0
Train Epoch5 Acc 0.938725 (37549/40000), AUC 0.9812614917755127
ep5_train_time 36.48674726486206
Test Epoch5 layer4 Acc 0.8186, AUC 0.8940560817718506, avg_entr 0.08456482738256454
ep5_l4_test_time 1.249678134918213
gc 0
Train Epoch6 Acc 0.94795 (37918/40000), AUC 0.9848889112472534
ep6_train_time 36.33451867103577
Test Epoch6 layer4 Acc 0.8076, AUC 0.8870836496353149, avg_entr 0.053987354040145874
ep6_l4_test_time 1.1703710556030273
gc 0
Train Epoch7 Acc 0.956225 (38249/40000), AUC 0.9895913600921631
ep7_train_time 35.723915100097656
Test Epoch7 layer4 Acc 0.7994, AUC 0.8816194534301758, avg_entr 0.04265843704342842
ep7_l4_test_time 1.213853120803833
gc 0
Train Epoch8 Acc 0.9632 (38528/40000), AUC 0.9921298027038574
ep8_train_time 35.73066473007202
Test Epoch8 layer4 Acc 0.8006, AUC 0.8749730587005615, avg_entr 0.03741199150681496
ep8_l4_test_time 1.1911425590515137
gc 0
Train Epoch9 Acc 0.965275 (38611/40000), AUC 0.9927324056625366
ep9_train_time 35.73499274253845
Test Epoch9 layer4 Acc 0.8008, AUC 0.8721444010734558, avg_entr 0.034449636936187744
ep9_l4_test_time 1.2120966911315918
gc 0
Train Epoch10 Acc 0.967775 (38711/40000), AUC 0.9940358996391296
ep10_train_time 35.82666087150574
Test Epoch10 layer4 Acc 0.7998, AUC 0.8703593015670776, avg_entr 0.04274555295705795
ep10_l4_test_time 1.217350721359253
gc 0
Train Epoch11 Acc 0.972025 (38881/40000), AUC 0.9953309297561646
ep11_train_time 35.74893593788147
Test Epoch11 layer4 Acc 0.7902, AUC 0.8657782077789307, avg_entr 0.035388439893722534
ep11_l4_test_time 1.171715259552002
gc 0
Train Epoch12 Acc 0.974275 (38971/40000), AUC 0.9955919981002808
ep12_train_time 35.80895209312439
Test Epoch12 layer4 Acc 0.7882, AUC 0.8625870943069458, avg_entr 0.038007643073797226
ep12_l4_test_time 1.220754623413086
gc 0
Train Epoch13 Acc 0.975975 (39039/40000), AUC 0.9960727095603943
ep13_train_time 20.647363662719727
Test Epoch13 layer4 Acc 0.7846, AUC 0.8581728935241699, avg_entr 0.02997143566608429
ep13_l4_test_time 0.6188788414001465
gc 0
Train Epoch14 Acc 0.978325 (39133/40000), AUC 0.9965571165084839
ep14_train_time 32.401167154312134
Test Epoch14 layer4 Acc 0.7852, AUC 0.8562569618225098, avg_entr 0.03028460405766964
ep14_l4_test_time 1.1906142234802246
gc 0
Train Epoch15 Acc 0.979125 (39165/40000), AUC 0.9967044591903687
ep15_train_time 35.50081014633179
Test Epoch15 layer4 Acc 0.7832, AUC 0.8549943566322327, avg_entr 0.03128068894147873
ep15_l4_test_time 1.181506633758545
gc 0
Train Epoch16 Acc 0.9808 (39232/40000), AUC 0.997296929359436
ep16_train_time 35.62388467788696
Test Epoch16 layer4 Acc 0.776, AUC 0.8492956757545471, avg_entr 0.02980889193713665
ep16_l4_test_time 1.2166178226470947
gc 0
Train Epoch17 Acc 0.982225 (39289/40000), AUC 0.9975743293762207
ep17_train_time 35.63666224479675
Test Epoch17 layer4 Acc 0.7778, AUC 0.8474889993667603, avg_entr 0.027766063809394836
ep17_l4_test_time 1.2072384357452393
gc 0
Train Epoch18 Acc 0.983125 (39325/40000), AUC 0.9978533387184143
ep18_train_time 35.692381143569946
Test Epoch18 layer4 Acc 0.7578, AUC 0.8325080275535583, avg_entr 0.02391791343688965
ep18_l4_test_time 1.2165825366973877
gc 0
Train Epoch19 Acc 0.98465 (39386/40000), AUC 0.9980112910270691
ep19_train_time 35.83655261993408
Test Epoch19 layer4 Acc 0.7776, AUC 0.8435684442520142, avg_entr 0.020143404603004456
ep19_l4_test_time 1.1991095542907715
gc 0
Train Epoch20 Acc 0.9855 (39420/40000), AUC 0.9980660676956177
ep20_train_time 35.75394630432129
Test Epoch20 layer4 Acc 0.776, AUC 0.8393145799636841, avg_entr 0.018741976469755173
ep20_l4_test_time 1.198214054107666
gc 0
Train Epoch21 Acc 0.9862 (39448/40000), AUC 0.9983684420585632
ep21_train_time 35.666261434555054
Test Epoch21 layer4 Acc 0.772, AUC 0.8394845724105835, avg_entr 0.020213842391967773
ep21_l4_test_time 1.2164485454559326
gc 0
Train Epoch22 Acc 0.98785 (39514/40000), AUC 0.9985187649726868
ep22_train_time 35.639952659606934
Test Epoch22 layer4 Acc 0.7706, AUC 0.8322354555130005, avg_entr 0.01723770797252655
ep22_l4_test_time 1.2058296203613281
gc 0
Train Epoch23 Acc 0.988625 (39545/40000), AUC 0.9987033009529114
ep23_train_time 35.61026406288147
Test Epoch23 layer4 Acc 0.7618, AUC 0.8164137601852417, avg_entr 0.015375625342130661
ep23_l4_test_time 1.1902053356170654
gc 0
Train Epoch24 Acc 0.98935 (39574/40000), AUC 0.9987214803695679
ep24_train_time 35.573832511901855
Test Epoch24 layer4 Acc 0.7662, AUC 0.822503387928009, avg_entr 0.017581205815076828
ep24_l4_test_time 1.2164361476898193
gc 0
Train Epoch25 Acc 0.989675 (39587/40000), AUC 0.9988598823547363
ep25_train_time 35.833807945251465
Test Epoch25 layer4 Acc 0.767, AUC 0.8240705132484436, avg_entr 0.015120909549295902
ep25_l4_test_time 1.2009313106536865
gc 0
Train Epoch26 Acc 0.99045 (39618/40000), AUC 0.9988448619842529
ep26_train_time 35.782931089401245
Test Epoch26 layer4 Acc 0.762, AUC 0.8144141435623169, avg_entr 0.011660522781312466
ep26_l4_test_time 1.178009033203125
gc 0
Train Epoch27 Acc 0.991425 (39657/40000), AUC 0.9989867210388184
ep27_train_time 35.65468168258667
Test Epoch27 layer4 Acc 0.7636, AUC 0.8251014947891235, avg_entr 0.01323306281119585
ep27_l4_test_time 1.2004294395446777
gc 0
Train Epoch28 Acc 0.99155 (39662/40000), AUC 0.998957633972168
ep28_train_time 35.60702443122864
Test Epoch28 layer4 Acc 0.7604, AUC 0.8165314197540283, avg_entr 0.012520581483840942
ep28_l4_test_time 1.216794490814209
gc 0
Train Epoch29 Acc 0.992875 (39715/40000), AUC 0.9990696907043457
ep29_train_time 35.67846202850342
Test Epoch29 layer4 Acc 0.7582, AUC 0.8159837126731873, avg_entr 0.013531912118196487
ep29_l4_test_time 1.2155561447143555
gc 0
Train Epoch30 Acc 0.992925 (39717/40000), AUC 0.999005913734436
ep30_train_time 35.7144980430603
Test Epoch30 layer4 Acc 0.755, AUC 0.8129109144210815, avg_entr 0.013575413264334202
ep30_l4_test_time 1.194711685180664
gc 0
Train Epoch31 Acc 0.993625 (39745/40000), AUC 0.9992770552635193
ep31_train_time 35.60330867767334
Test Epoch31 layer4 Acc 0.758, AUC 0.8138952851295471, avg_entr 0.010046071372926235
ep31_l4_test_time 1.2052946090698242
gc 0
Train Epoch32 Acc 0.994125 (39765/40000), AUC 0.9993200302124023
ep32_train_time 35.57985472679138
Test Epoch32 layer4 Acc 0.7574, AUC 0.8108819723129272, avg_entr 0.01078886166214943
ep32_l4_test_time 1.2207562923431396
gc 0
Train Epoch33 Acc 0.99445 (39778/40000), AUC 0.999279260635376
ep33_train_time 35.6156063079834
Test Epoch33 layer4 Acc 0.756, AUC 0.8109585046768188, avg_entr 0.01111460942775011
ep33_l4_test_time 1.1903564929962158
gc 0
Train Epoch34 Acc 0.99505 (39802/40000), AUC 0.9994131326675415
ep34_train_time 35.59314942359924
Test Epoch34 layer4 Acc 0.757, AUC 0.8105936646461487, avg_entr 0.011437692679464817
ep34_l4_test_time 1.2064650058746338
gc 0
Train Epoch35 Acc 0.995525 (39821/40000), AUC 0.9994439482688904
ep35_train_time 35.6317195892334
Test Epoch35 layer4 Acc 0.7508, AUC 0.8034783601760864, avg_entr 0.009081813506782055
ep35_l4_test_time 1.2130930423736572
gc 0
Train Epoch36 Acc 0.996375 (39855/40000), AUC 0.9995368719100952
ep36_train_time 35.584229946136475
Test Epoch36 layer4 Acc 0.7512, AUC 0.7923548221588135, avg_entr 0.0057388655841350555
ep36_l4_test_time 1.2048683166503906
gc 0
Train Epoch37 Acc 0.995925 (39837/40000), AUC 0.9994943141937256
ep37_train_time 35.60664892196655
Test Epoch37 layer4 Acc 0.754, AUC 0.8082402944564819, avg_entr 0.007706042379140854
ep37_l4_test_time 1.209301471710205
gc 0
Train Epoch38 Acc 0.996725 (39869/40000), AUC 0.9995054006576538
ep38_train_time 35.60531997680664
Test Epoch38 layer4 Acc 0.7528, AUC 0.7978653907775879, avg_entr 0.006788980215787888
ep38_l4_test_time 1.2038109302520752
gc 0
Train Epoch39 Acc 0.9966 (39864/40000), AUC 0.9995685815811157
ep39_train_time 35.64405608177185
Test Epoch39 layer4 Acc 0.7496, AUC 0.7971402406692505, avg_entr 0.007787887006998062
ep39_l4_test_time 1.1907827854156494
gc 0
Train Epoch40 Acc 0.996925 (39877/40000), AUC 0.9996280670166016
ep40_train_time 35.540409564971924
Test Epoch40 layer4 Acc 0.7464, AUC 0.8003968596458435, avg_entr 0.008550068363547325
ep40_l4_test_time 1.1970043182373047
gc 0
Train Epoch41 Acc 0.997425 (39897/40000), AUC 0.9995888471603394
ep41_train_time 35.57946801185608
Test Epoch41 layer4 Acc 0.748, AUC 0.7895635366439819, avg_entr 0.006034268997609615
ep41_l4_test_time 1.1922996044158936
gc 0
Train Epoch42 Acc 0.997425 (39897/40000), AUC 0.9995408058166504
ep42_train_time 35.669047594070435
Test Epoch42 layer4 Acc 0.748, AUC 0.784771203994751, avg_entr 0.005860225297510624
ep42_l4_test_time 1.1777598857879639
gc 0
Train Epoch43 Acc 0.997875 (39915/40000), AUC 0.9996622800827026
ep43_train_time 35.625141620635986
Test Epoch43 layer4 Acc 0.7464, AUC 0.7823033928871155, avg_entr 0.005522097926586866
ep43_l4_test_time 1.203094244003296
gc 0
Train Epoch44 Acc 0.997475 (39899/40000), AUC 0.9996381998062134
ep44_train_time 35.63452959060669
Test Epoch44 layer4 Acc 0.7498, AUC 0.7894349098205566, avg_entr 0.006403104402124882
ep44_l4_test_time 1.222285509109497
gc 0
Train Epoch45 Acc 0.997775 (39911/40000), AUC 0.99967360496521
ep45_train_time 35.532776832580566
Test Epoch45 layer4 Acc 0.7466, AUC 0.7857744097709656, avg_entr 0.00684664212167263
ep45_l4_test_time 1.1952660083770752
gc 0
Train Epoch46 Acc 0.998325 (39933/40000), AUC 0.9997274279594421
ep46_train_time 35.47761678695679
Test Epoch46 layer4 Acc 0.7482, AUC 0.795150876045227, avg_entr 0.006556678097695112
ep46_l4_test_time 1.197436809539795
gc 0
Train Epoch47 Acc 0.9983 (39932/40000), AUC 0.9997212886810303
ep47_train_time 35.49920916557312
Test Epoch47 layer4 Acc 0.7452, AUC 0.7814065217971802, avg_entr 0.005975576117634773
ep47_l4_test_time 1.2069430351257324
gc 0
Train Epoch48 Acc 0.998525 (39941/40000), AUC 0.9996927976608276
ep48_train_time 35.528467416763306
Test Epoch48 layer4 Acc 0.746, AUC 0.778512179851532, avg_entr 0.006161448545753956
ep48_l4_test_time 1.1720671653747559
gc 0
Train Epoch49 Acc 0.99825 (39930/40000), AUC 0.9996097087860107
ep49_train_time 35.461669921875
Test Epoch49 layer4 Acc 0.7454, AUC 0.7825571298599243, avg_entr 0.0050735995173454285
ep49_l4_test_time 1.2150702476501465
Best AUC 0.9074828624725342
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 1832.7951271533966
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad100//imdb_lstmal_l5.pt
Test layer4 Acc 0.8356, AUC 0.9124742746353149, avg_entr 0.11516182869672775
l4_test_time 1.2091028690338135
