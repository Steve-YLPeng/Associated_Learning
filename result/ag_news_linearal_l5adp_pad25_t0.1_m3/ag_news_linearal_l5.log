total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.1_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.15380833333333332 (18457/120000), AUC 0.37285172939300537
ep0_train_time 5.656192302703857
Test Epoch0 threshold 0.1 Acc 0.9113486842105263, AUC 0.9811921715736389, avg_entr 0.0250509362667799
ep0_t0.1_test_time 0.08978533744812012
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.1_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.16250833333333334 (19501/120000), AUC 0.3734647333621979
ep1_train_time 4.931768894195557
Test Epoch1 threshold 0.1 Acc 0.9131578947368421, AUC 0.9809473752975464, avg_entr 0.023110318928956985
ep1_t0.1_test_time 0.08570575714111328
gc 0
Train Epoch2 Acc 0.157025 (18843/120000), AUC 0.3852315843105316
ep2_train_time 4.965131044387817
Test Epoch2 threshold 0.1 Acc 0.912828947368421, AUC 0.9810147881507874, avg_entr 0.022718725726008415
ep2_t0.1_test_time 0.08600711822509766
gc 0
Train Epoch3 Acc 0.14786666666666667 (17744/120000), AUC 0.38768526911735535
ep3_train_time 4.886718511581421
Test Epoch3 threshold 0.1 Acc 0.912828947368421, AUC 0.9803442358970642, avg_entr 0.021475382149219513
ep3_t0.1_test_time 0.08589696884155273
gc 0
Train Epoch4 Acc 0.10596666666666667 (12716/120000), AUC 0.3744624853134155
ep4_train_time 4.850931167602539
Test Epoch4 threshold 0.1 Acc 0.9095394736842105, AUC 0.9800316691398621, avg_entr 0.019502898678183556
ep4_t0.1_test_time 0.08635902404785156
gc 0
Train Epoch5 Acc 0.09129166666666666 (10955/120000), AUC 0.36923930048942566
ep5_train_time 4.8998401165008545
Test Epoch5 threshold 0.1 Acc 0.9113486842105263, AUC 0.9798424243927002, avg_entr 0.018690701574087143
ep5_t0.1_test_time 0.0865182876586914
gc 0
Train Epoch6 Acc 0.0957 (11484/120000), AUC 0.3687419295310974
ep6_train_time 4.863749027252197
Test Epoch6 threshold 0.1 Acc 0.9123355263157895, AUC 0.9794384241104126, avg_entr 0.018366007134318352
ep6_t0.1_test_time 0.08504247665405273
gc 0
Train Epoch7 Acc 0.10605 (12726/120000), AUC 0.36923277378082275
ep7_train_time 4.9165356159210205
Test Epoch7 threshold 0.1 Acc 0.9111842105263158, AUC 0.9793553948402405, avg_entr 0.01764056831598282
ep7_t0.1_test_time 0.08600163459777832
gc 0
Train Epoch8 Acc 0.125225 (15027/120000), AUC 0.3699575662612915
ep8_train_time 4.8720104694366455
Test Epoch8 threshold 0.1 Acc 0.9101973684210526, AUC 0.9794532060623169, avg_entr 0.017585065215826035
ep8_t0.1_test_time 0.08584880828857422
gc 0
Train Epoch9 Acc 0.14259166666666667 (17111/120000), AUC 0.37039679288864136
ep9_train_time 4.876495838165283
Test Epoch9 threshold 0.1 Acc 0.9100328947368421, AUC 0.9791667461395264, avg_entr 0.017228832468390465
ep9_t0.1_test_time 0.08579850196838379
Best AUC 0.9811921715736389
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.1_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9223684210526316, AUC 0.9858046770095825, avg_entr 0.024997876957058907
t0.1_test_time 0.022447824478149414
