total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 58.647676944732666
Start Training
gc 0
Train Epoch0 Acc 0.8990785714285714 (503484/560000), AUC 0.9896721839904785
ep0_train_time 412.54960227012634
Test Epoch0 layer4 Acc 0.9816857142857143, AUC 0.9977967143058777, avg_entr 0.02441811002790928, f1 0.9816856980323792
ep0_l4_test_time 7.018982172012329
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9849339285714286 (551563/560000), AUC 0.9975098371505737
ep1_train_time 410.5993049144745
Test Epoch1 layer4 Acc 0.9834857142857143, AUC 0.9980016946792603, avg_entr 0.004941913299262524, f1 0.9834856986999512
ep1_l4_test_time 6.948215484619141
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9869767857142857 (552707/560000), AUC 0.9980213046073914
ep2_train_time 393.62416648864746
Test Epoch2 layer4 Acc 0.9841714285714286, AUC 0.9980162978172302, avg_entr 0.002627437934279442, f1 0.984171450138092
ep2_l4_test_time 7.016676902770996
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9883857142857143 (553496/560000), AUC 0.9983490109443665
ep3_train_time 411.1474530696869
Test Epoch3 layer4 Acc 0.9846857142857143, AUC 0.998156726360321, avg_entr 0.0017430842854082584, f1 0.9846857190132141
ep3_l4_test_time 7.032742977142334
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9895839285714285 (554167/560000), AUC 0.9985361695289612
ep4_train_time 410.89724135398865
Test Epoch4 layer4 Acc 0.9851428571428571, AUC 0.9979974031448364, avg_entr 0.0012677991762757301, f1 0.9851428866386414
ep4_l4_test_time 6.927661418914795
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9904410714285714 (554647/560000), AUC 0.9987608790397644
ep5_train_time 410.5313229560852
Test Epoch5 layer4 Acc 0.9854857142857143, AUC 0.9979982376098633, avg_entr 0.0015105329221114516, f1 0.9854857325553894
ep5_l4_test_time 7.00006628036499
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9912857142857143 (555120/560000), AUC 0.9988630414009094
ep6_train_time 353.9075529575348
Test Epoch6 layer4 Acc 0.9853428571428572, AUC 0.997717022895813, avg_entr 0.001282253535464406, f1 0.9853428602218628
ep6_l4_test_time 6.096389055252075
gc 0
Train Epoch7 Acc 0.9919178571428572 (555474/560000), AUC 0.9989133477210999
ep7_train_time 346.65193223953247
Test Epoch7 layer4 Acc 0.9853428571428572, AUC 0.9977010488510132, avg_entr 0.0013408238301053643, f1 0.9853428602218628
ep7_l4_test_time 6.057613372802734
gc 0
Train Epoch8 Acc 0.992575 (555842/560000), AUC 0.9989274144172668
ep8_train_time 347.0072762966156
Test Epoch8 layer4 Acc 0.9851428571428571, AUC 0.9977248311042786, avg_entr 0.0011509549804031849, f1 0.9851428866386414
ep8_l4_test_time 6.159194707870483
gc 0
Train Epoch9 Acc 0.9931696428571428 (556175/560000), AUC 0.9989242553710938
ep9_train_time 347.3069381713867
Test Epoch9 layer4 Acc 0.9859142857142857, AUC 0.9974884986877441, avg_entr 0.0012244691606611013, f1 0.9859142899513245
ep9_l4_test_time 6.163199424743652
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9937339285714286 (556491/560000), AUC 0.9989344477653503
ep10_train_time 347.20427894592285
Test Epoch10 layer4 Acc 0.9857428571428571, AUC 0.9974862337112427, avg_entr 0.0010978884529322386, f1 0.9857428669929504
ep10_l4_test_time 6.109370231628418
gc 0
Train Epoch11 Acc 0.9942089285714286 (556757/560000), AUC 0.99903404712677
ep11_train_time 365.70204615592957
Test Epoch11 layer4 Acc 0.9855142857142857, AUC 0.9971373677253723, avg_entr 0.0009200372151099145, f1 0.9855142831802368
ep11_l4_test_time 7.266684293746948
gc 0
Train Epoch12 Acc 0.9947196428571429 (557043/560000), AUC 0.999017059803009
ep12_train_time 425.48064517974854
Test Epoch12 layer4 Acc 0.9851428571428571, AUC 0.9967970848083496, avg_entr 0.0009695873595774174, f1 0.9851428866386414
ep12_l4_test_time 6.881467580795288
gc 0
Train Epoch13 Acc 0.9951982142857143 (557311/560000), AUC 0.9989925622940063
ep13_train_time 425.68583273887634
Test Epoch13 layer4 Acc 0.9854857142857143, AUC 0.9968775510787964, avg_entr 0.0009062918252311647, f1 0.9854857325553894
ep13_l4_test_time 7.303066968917847
gc 0
Train Epoch14 Acc 0.9956410714285714 (557559/560000), AUC 0.9990043640136719
ep14_train_time 425.67171359062195
Test Epoch14 layer4 Acc 0.9855714285714285, AUC 0.9964224696159363, avg_entr 0.0008720971527509391, f1 0.9855714440345764
ep14_l4_test_time 7.15384578704834
gc 0
Train Epoch15 Acc 0.9960125 (557767/560000), AUC 0.9990006685256958
ep15_train_time 425.24631929397583
Test Epoch15 layer4 Acc 0.9855714285714285, AUC 0.9962624311447144, avg_entr 0.0007686231983825564, f1 0.9855714440345764
ep15_l4_test_time 7.297001361846924
gc 0
Train Epoch16 Acc 0.9962982142857143 (557927/560000), AUC 0.9989965558052063
ep16_train_time 425.239541053772
Test Epoch16 layer4 Acc 0.9856285714285714, AUC 0.9957312345504761, avg_entr 0.0007997402572073042, f1 0.9856285452842712
ep16_l4_test_time 7.309760093688965
gc 0
Train Epoch17 Acc 0.9965928571428572 (558092/560000), AUC 0.9990110993385315
ep17_train_time 425.1716208457947
Test Epoch17 layer4 Acc 0.9848285714285714, AUC 0.9956512451171875, avg_entr 0.0007779443985782564, f1 0.9848285913467407
ep17_l4_test_time 7.263901948928833
gc 0
Train Epoch18 Acc 0.9967339285714286 (558171/560000), AUC 0.9990459680557251
ep18_train_time 425.4045796394348
Test Epoch18 layer4 Acc 0.9856857142857143, AUC 0.9954742193222046, avg_entr 0.0007987826247699559, f1 0.9856857061386108
ep18_l4_test_time 7.291478872299194
gc 0
Train Epoch19 Acc 0.9969214285714286 (558276/560000), AUC 0.999062180519104
ep19_train_time 405.22442722320557
Test Epoch19 layer4 Acc 0.9849428571428571, AUC 0.9951799511909485, avg_entr 0.0008103090221993625, f1 0.9849428534507751
ep19_l4_test_time 7.25126314163208
gc 0
Train Epoch20 Acc 0.9971285714285715 (558392/560000), AUC 0.9990906715393066
ep20_train_time 424.18804478645325
Test Epoch20 layer4 Acc 0.9848, AUC 0.9947853088378906, avg_entr 0.00074700330151245, f1 0.9847999811172485
ep20_l4_test_time 7.259353399276733
gc 0
Train Epoch21 Acc 0.9972642857142857 (558468/560000), AUC 0.9990877509117126
ep21_train_time 424.9676032066345
Test Epoch21 layer4 Acc 0.9850857142857142, AUC 0.9947989583015442, avg_entr 0.0007408747915178537, f1 0.9850857257843018
ep21_l4_test_time 7.2788755893707275
gc 0
Train Epoch22 Acc 0.9973875 (558537/560000), AUC 0.9991324543952942
ep22_train_time 424.9326260089874
Test Epoch22 layer4 Acc 0.9848285714285714, AUC 0.9947299957275391, avg_entr 0.0005874052294529974, f1 0.9848285913467407
ep22_l4_test_time 6.903368949890137
gc 0
Train Epoch23 Acc 0.9975142857142857 (558608/560000), AUC 0.9991618990898132
ep23_train_time 424.75237703323364
Test Epoch23 layer4 Acc 0.9847714285714285, AUC 0.9947294592857361, avg_entr 0.0006831985665485263, f1 0.9847714304924011
ep23_l4_test_time 7.2739949226379395
gc 0
Train Epoch24 Acc 0.9975892857142857 (558650/560000), AUC 0.9991990923881531
ep24_train_time 424.96846055984497
Test Epoch24 layer4 Acc 0.9851428571428571, AUC 0.9944462180137634, avg_entr 0.000650949717964977, f1 0.9851428866386414
ep24_l4_test_time 7.2805540561676025
gc 0
Train Epoch25 Acc 0.9976857142857143 (558704/560000), AUC 0.99920654296875
ep25_train_time 424.4850363731384
Test Epoch25 layer4 Acc 0.9853428571428572, AUC 0.9946276545524597, avg_entr 0.0007291361689567566, f1 0.9853428602218628
ep25_l4_test_time 7.273146629333496
gc 0
Train Epoch26 Acc 0.9978071428571429 (558772/560000), AUC 0.9992526769638062
ep26_train_time 424.91212940216064
Test Epoch26 layer4 Acc 0.9852571428571428, AUC 0.9945823550224304, avg_entr 0.0006395145319402218, f1 0.9852571487426758
ep26_l4_test_time 7.268932580947876
gc 0
Train Epoch27 Acc 0.9978803571428572 (558813/560000), AUC 0.9992642402648926
ep27_train_time 405.39836835861206
Test Epoch27 layer4 Acc 0.9845714285714285, AUC 0.9944871068000793, avg_entr 0.0006564132636412978, f1 0.9845714569091797
ep27_l4_test_time 7.290294170379639
gc 0
Train Epoch28 Acc 0.9979214285714286 (558836/560000), AUC 0.9992504119873047
ep28_train_time 424.76063990592957
Test Epoch28 layer4 Acc 0.9850857142857142, AUC 0.9941802620887756, avg_entr 0.0006002828595228493, f1 0.9850857257843018
ep28_l4_test_time 7.039522647857666
gc 0
Train Epoch29 Acc 0.9980089285714285 (558885/560000), AUC 0.9992644190788269
ep29_train_time 425.1634204387665
Test Epoch29 layer4 Acc 0.9852857142857143, AUC 0.9942057728767395, avg_entr 0.00047881819773465395, f1 0.9852856993675232
ep29_l4_test_time 7.278323173522949
Best AUC tensor(0.9859) 9
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 12380.935410499573
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt
Test layer0 Acc 0.9742857142857143, AUC 0.9982806444168091, avg_entr 0.02333024889230728, f1 0.9742856621742249
l0_test_time 2.2378010749816895
Test layer1 Acc 0.9866857142857143, AUC 0.9987343549728394, avg_entr 0.0018236174946650863, f1 0.9866856932640076
l1_test_time 3.3947463035583496
Test layer2 Acc 0.9863714285714286, AUC 0.9987733960151672, avg_entr 0.001503831590525806, f1 0.9863714575767517
l2_test_time 4.673421382904053
Test layer3 Acc 0.9864285714285714, AUC 0.9980977177619934, avg_entr 0.0013727585319429636, f1 0.9864285588264465
l3_test_time 6.016901731491089
Test layer4 Acc 0.9863714285714286, AUC 0.997822642326355, avg_entr 0.001263597747310996, f1 0.9863714575767517
l4_test_time 7.111111879348755
