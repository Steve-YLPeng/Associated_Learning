total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 57.87376165390015
Start Training
gc 0
Train Epoch0 Acc 0.9055053571428572 (507083/560000), AUC 0.9898781180381775
ep0_train_time 433.7117745876312
Test Epoch0 layer4 Acc 0.9821142857142857, AUC 0.9973770380020142, avg_entr 0.02172270230948925, f1 0.982114315032959
ep0_l4_test_time 7.45647668838501
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.98495 (551572/560000), AUC 0.9974747896194458
ep1_train_time 432.03891348838806
Test Epoch1 layer4 Acc 0.9834571428571428, AUC 0.997504711151123, avg_entr 0.004624932073056698, f1 0.9834571480751038
ep1_l4_test_time 7.365116357803345
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9869892857142857 (552714/560000), AUC 0.9978763461112976
ep2_train_time 431.5053355693817
Test Epoch2 layer4 Acc 0.9841714285714286, AUC 0.9975859522819519, avg_entr 0.002724031452089548, f1 0.984171450138092
ep2_l4_test_time 7.431816816329956
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9885142857142857 (553568/560000), AUC 0.9981293082237244
ep3_train_time 432.15981125831604
Test Epoch3 layer4 Acc 0.9850857142857142, AUC 0.9976797103881836, avg_entr 0.0019510624697431922, f1 0.9850857257843018
ep3_l4_test_time 7.392065048217773
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9894410714285714 (554087/560000), AUC 0.9982947707176208
ep4_train_time 431.93939661979675
Test Epoch4 layer4 Acc 0.9856857142857143, AUC 0.9976118206977844, avg_entr 0.0016268546460196376, f1 0.9856857061386108
ep4_l4_test_time 7.444521903991699
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9903660714285715 (554605/560000), AUC 0.9984780550003052
ep5_train_time 423.2182171344757
Test Epoch5 layer4 Acc 0.9859142857142857, AUC 0.9977515339851379, avg_entr 0.0014666630886495113, f1 0.9859142899513245
ep5_l4_test_time 3.6276652812957764
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9911053571428572 (555019/560000), AUC 0.9986565709114075
ep6_train_time 420.2398760318756
Test Epoch6 layer4 Acc 0.9860285714285715, AUC 0.997614860534668, avg_entr 0.0012846465688198805, f1 0.9860285520553589
ep6_l4_test_time 7.34130859375
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9918482142857142 (555435/560000), AUC 0.9987133145332336
ep7_train_time 430.28902196884155
Test Epoch7 layer4 Acc 0.9862571428571428, AUC 0.9977192282676697, avg_entr 0.0013242815621197224, f1 0.9862571358680725
ep7_l4_test_time 7.333401203155518
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9924857142857143 (555792/560000), AUC 0.9987220168113708
ep8_train_time 430.117388010025
Test Epoch8 layer4 Acc 0.9861428571428571, AUC 0.997687816619873, avg_entr 0.0013198130764067173, f1 0.9861428737640381
ep8_l4_test_time 7.403254985809326
gc 0
Train Epoch9 Acc 0.9930464285714286 (556106/560000), AUC 0.9987772703170776
ep9_train_time 431.8677749633789
Test Epoch9 layer4 Acc 0.9857714285714285, AUC 0.9973019361495972, avg_entr 0.001169518567621708, f1 0.9857714176177979
ep9_l4_test_time 7.435449838638306
gc 0
Train Epoch10 Acc 0.9936696428571429 (556455/560000), AUC 0.9988393783569336
ep10_train_time 433.54527711868286
Test Epoch10 layer4 Acc 0.9862285714285715, AUC 0.9969778656959534, avg_entr 0.0010782580357044935, f1 0.9862285852432251
ep10_l4_test_time 7.416826963424683
gc 0
Train Epoch11 Acc 0.9940875 (556689/560000), AUC 0.9988738894462585
ep11_train_time 433.55867433547974
Test Epoch11 layer4 Acc 0.9863428571428572, AUC 0.9972320795059204, avg_entr 0.0010261631105095148, f1 0.9863428473472595
ep11_l4_test_time 7.431418418884277
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9946303571428572 (556993/560000), AUC 0.9988920092582703
ep12_train_time 432.5829985141754
Test Epoch12 layer4 Acc 0.986, AUC 0.9969030022621155, avg_entr 0.0010361757595092058, f1 0.9860000014305115
ep12_l4_test_time 7.428737163543701
gc 0
Train Epoch13 Acc 0.9951196428571428 (557267/560000), AUC 0.9989344477653503
ep13_train_time 432.04955863952637
Test Epoch13 layer4 Acc 0.9856, AUC 0.9970743060112, avg_entr 0.0010058964835479856, f1 0.9855999946594238
ep13_l4_test_time 7.4465882778167725
gc 0
Train Epoch14 Acc 0.9954982142857143 (557479/560000), AUC 0.9989811182022095
ep14_train_time 432.5945210456848
Test Epoch14 layer4 Acc 0.9854857142857143, AUC 0.9963589310646057, avg_entr 0.000972355657722801, f1 0.9854857325553894
ep14_l4_test_time 7.425812482833862
gc 0
Train Epoch15 Acc 0.995925 (557718/560000), AUC 0.9989753365516663
ep15_train_time 432.12135434150696
Test Epoch15 layer4 Acc 0.9858285714285714, AUC 0.996183454990387, avg_entr 0.0008761659264564514, f1 0.9858285784721375
ep15_l4_test_time 7.438783884048462
gc 0
Train Epoch16 Acc 0.9960946428571429 (557813/560000), AUC 0.998992383480072
ep16_train_time 432.22011709213257
Test Epoch16 layer4 Acc 0.9857428571428571, AUC 0.9960542321205139, avg_entr 0.0007496625767089427, f1 0.9857428669929504
ep16_l4_test_time 7.433168411254883
gc 0
Train Epoch17 Acc 0.9963964285714285 (557982/560000), AUC 0.9990461468696594
ep17_train_time 411.86391496658325
Test Epoch17 layer4 Acc 0.9851714285714286, AUC 0.9960979223251343, avg_entr 0.000790888094343245, f1 0.9851714372634888
ep17_l4_test_time 7.4014575481414795
gc 0
Train Epoch18 Acc 0.9966839285714286 (558143/560000), AUC 0.9990721940994263
ep18_train_time 433.04340958595276
Test Epoch18 layer4 Acc 0.9854857142857143, AUC 0.995885968208313, avg_entr 0.000714550435077399, f1 0.9854857325553894
ep18_l4_test_time 7.415179967880249
gc 0
Train Epoch19 Acc 0.9968553571428571 (558239/560000), AUC 0.9990991950035095
ep19_train_time 433.5572805404663
Test Epoch19 layer4 Acc 0.9851714285714286, AUC 0.9956132769584656, avg_entr 0.0006711753667332232, f1 0.9851714372634888
ep19_l4_test_time 7.434722900390625
gc 0
Train Epoch20 Acc 0.9969535714285714 (558294/560000), AUC 0.999144434928894
ep20_train_time 432.9981348514557
Test Epoch20 layer4 Acc 0.9855714285714285, AUC 0.9957261681556702, avg_entr 0.0006009166245348752, f1 0.9855714440345764
ep20_l4_test_time 7.397566795349121
gc 0
Train Epoch21 Acc 0.9971267857142857 (558391/560000), AUC 0.9991570115089417
ep21_train_time 433.0128536224365
Test Epoch21 layer4 Acc 0.9854571428571428, AUC 0.995606541633606, avg_entr 0.0006164166261442006, f1 0.9854571223258972
ep21_l4_test_time 7.4191577434539795
gc 0
Train Epoch22 Acc 0.9972785714285715 (558476/560000), AUC 0.9992004632949829
ep22_train_time 432.66243410110474
Test Epoch22 layer4 Acc 0.9849142857142857, AUC 0.9955530166625977, avg_entr 0.0005672703846357763, f1 0.9849143028259277
ep22_l4_test_time 7.4541990756988525
gc 0
Train Epoch23 Acc 0.9973946428571429 (558541/560000), AUC 0.9991862177848816
ep23_train_time 432.3090386390686
Test Epoch23 layer4 Acc 0.9847714285714285, AUC 0.995208740234375, avg_entr 0.0006510788225568831, f1 0.9847714304924011
ep23_l4_test_time 7.4189536571502686
gc 0
Train Epoch24 Acc 0.9974607142857143 (558578/560000), AUC 0.9992109537124634
ep24_train_time 433.49228262901306
Test Epoch24 layer4 Acc 0.9847714285714285, AUC 0.9954043626785278, avg_entr 0.0005626061465591192, f1 0.9847714304924011
ep24_l4_test_time 7.414667367935181
gc 0
Train Epoch25 Acc 0.9975660714285715 (558637/560000), AUC 0.9992344975471497
ep25_train_time 433.3705518245697
Test Epoch25 layer4 Acc 0.9849142857142857, AUC 0.9951270222663879, avg_entr 0.0005992702790535986, f1 0.9849143028259277
ep25_l4_test_time 7.420671701431274
gc 0
Train Epoch26 Acc 0.9976964285714286 (558710/560000), AUC 0.9992486834526062
ep26_train_time 432.76093769073486
Test Epoch26 layer4 Acc 0.9852571428571428, AUC 0.9950026869773865, avg_entr 0.0004865587397944182, f1 0.9852571487426758
ep26_l4_test_time 7.432988166809082
gc 0
Train Epoch27 Acc 0.9977535714285715 (558742/560000), AUC 0.9992698431015015
ep27_train_time 432.48800110816956
Test Epoch27 layer4 Acc 0.9843428571428572, AUC 0.9948661923408508, avg_entr 0.0005130487843416631, f1 0.9843428730964661
ep27_l4_test_time 7.41993522644043
gc 0
Train Epoch28 Acc 0.9978410714285715 (558791/560000), AUC 0.9992794990539551
ep28_train_time 432.5456473827362
Test Epoch28 layer4 Acc 0.9849714285714286, AUC 0.9949332475662231, avg_entr 0.0006059403531253338, f1 0.9849714040756226
ep28_l4_test_time 7.369630813598633
gc 0
Train Epoch29 Acc 0.9979 (558824/560000), AUC 0.9993143677711487
ep29_train_time 411.9349343776703
Test Epoch29 layer4 Acc 0.9845714285714285, AUC 0.9948858022689819, avg_entr 0.0005166975315660238, f1 0.9845714569091797
ep29_l4_test_time 7.396494626998901
Best AUC tensor(0.9863) 11
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 13133.033775806427
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt
Test layer0 Acc 0.9746571428571429, AUC 0.9983282089233398, avg_entr 0.023502042517066002, f1 0.9746571183204651
l0_test_time 2.299536943435669
Test layer1 Acc 0.9859714285714286, AUC 0.9985994696617126, avg_entr 0.0016167209250852466, f1 0.9859714508056641
l1_test_time 3.495954990386963
Test layer2 Acc 0.986, AUC 0.9982711672782898, avg_entr 0.0012234614696353674, f1 0.9860000014305115
l2_test_time 4.823264122009277
Test layer3 Acc 0.9860285714285715, AUC 0.9982753396034241, avg_entr 0.001066970406100154, f1 0.9860285520553589
l3_test_time 6.112352609634399
Test layer4 Acc 0.9861142857142857, AUC 0.9978784322738647, avg_entr 0.0010365252383053303, f1 0.9861142635345459
l4_test_time 7.064622640609741
