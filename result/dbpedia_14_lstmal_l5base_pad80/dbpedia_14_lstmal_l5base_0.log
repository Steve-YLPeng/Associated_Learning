total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 58.36496019363403
Start Training
gc 0
Train Epoch0 Acc 0.9018178571428571 (505018/560000), AUC 0.9901293516159058
ep0_train_time 417.793514251709
Test Epoch0 layer4 Acc 0.9816, AUC 0.9979472160339355, avg_entr 0.0230281800031662, f1 0.9815999865531921
ep0_l4_test_time 7.147305250167847
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9849910714285715 (551595/560000), AUC 0.9976280331611633
ep1_train_time 415.87478494644165
Test Epoch1 layer4 Acc 0.9836857142857143, AUC 0.9978440999984741, avg_entr 0.004703177139163017, f1 0.9836857318878174
ep1_l4_test_time 7.057280540466309
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9871035714285714 (552778/560000), AUC 0.9981406331062317
ep2_train_time 415.4086902141571
Test Epoch2 layer4 Acc 0.9844857142857143, AUC 0.998107373714447, avg_entr 0.002505381591618061, f1 0.9844856858253479
ep2_l4_test_time 7.103424310684204
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9884571428571428 (553536/560000), AUC 0.998372495174408
ep3_train_time 415.67587876319885
Test Epoch3 layer4 Acc 0.9849428571428571, AUC 0.9979982376098633, avg_entr 0.0017208321951329708, f1 0.9849428534507751
ep3_l4_test_time 7.078719139099121
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9895803571428572 (554165/560000), AUC 0.9985359311103821
ep4_train_time 415.6307339668274
Test Epoch4 layer4 Acc 0.9855714285714285, AUC 0.9981536865234375, avg_entr 0.0016335383988916874, f1 0.9855714440345764
ep4_l4_test_time 7.07410454750061
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9905089285714286 (554685/560000), AUC 0.9987834095954895
ep5_train_time 415.47085213661194
Test Epoch5 layer4 Acc 0.9864, AUC 0.9982356429100037, avg_entr 0.0014323894865810871, f1 0.9864000082015991
ep5_l4_test_time 7.11161732673645
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9912767857142857 (555115/560000), AUC 0.9989727139472961
ep6_train_time 415.21510219573975
Test Epoch6 layer4 Acc 0.9860285714285715, AUC 0.9981545805931091, avg_entr 0.001339687965810299, f1 0.9860285520553589
ep6_l4_test_time 7.095431804656982
gc 0
Train Epoch7 Acc 0.9919285714285714 (555480/560000), AUC 0.9990304708480835
ep7_train_time 415.2645571231842
Test Epoch7 layer4 Acc 0.9856857142857143, AUC 0.9980412125587463, avg_entr 0.0012761697871610522, f1 0.9856857061386108
ep7_l4_test_time 7.125694990158081
gc 0
Train Epoch8 Acc 0.9926 (555856/560000), AUC 0.9990652203559875
ep8_train_time 359.4242651462555
Test Epoch8 layer4 Acc 0.9856857142857143, AUC 0.9980054497718811, avg_entr 0.0012594382278621197, f1 0.9856857061386108
ep8_l4_test_time 7.101205825805664
gc 0
Train Epoch9 Acc 0.9931928571428571 (556188/560000), AUC 0.9991070032119751
ep9_train_time 415.37194085121155
Test Epoch9 layer4 Acc 0.9857714285714285, AUC 0.9978383183479309, avg_entr 0.00117051403503865, f1 0.9857714176177979
ep9_l4_test_time 7.076320171356201
gc 0
Train Epoch10 Acc 0.9937875 (556521/560000), AUC 0.9991034269332886
ep10_train_time 415.527556180954
Test Epoch10 layer4 Acc 0.9854857142857143, AUC 0.9977208375930786, avg_entr 0.0010099639184772968, f1 0.9854857325553894
ep10_l4_test_time 6.950279712677002
gc 0
Train Epoch11 Acc 0.9942410714285714 (556775/560000), AUC 0.9991177916526794
ep11_train_time 415.1444516181946
Test Epoch11 layer4 Acc 0.9853142857142857, AUC 0.9975296258926392, avg_entr 0.001041758107021451, f1 0.9853143095970154
ep11_l4_test_time 7.0824244022369385
gc 0
Train Epoch12 Acc 0.9947571428571429 (557064/560000), AUC 0.9991508722305298
ep12_train_time 415.52728939056396
Test Epoch12 layer4 Acc 0.9854, AUC 0.9973512887954712, avg_entr 0.0011000451631844044, f1 0.9854000210762024
ep12_l4_test_time 7.107945919036865
gc 0
Train Epoch13 Acc 0.9951303571428571 (557273/560000), AUC 0.9991551041603088
ep13_train_time 415.5310776233673
Test Epoch13 layer4 Acc 0.9850571428571429, AUC 0.9970958828926086, avg_entr 0.0009917968418449163, f1 0.9850571155548096
ep13_l4_test_time 7.086564779281616
gc 0
Train Epoch14 Acc 0.9954642857142857 (557460/560000), AUC 0.9991483688354492
ep14_train_time 415.41372299194336
Test Epoch14 layer4 Acc 0.9850285714285715, AUC 0.9969542622566223, avg_entr 0.0009231345029547811, f1 0.9850285649299622
ep14_l4_test_time 7.085288763046265
gc 0
Train Epoch15 Acc 0.9958857142857143 (557696/560000), AUC 0.9991669058799744
ep15_train_time 415.7144606113434
Test Epoch15 layer4 Acc 0.9848, AUC 0.9968820214271545, avg_entr 0.0008071977063082159, f1 0.9847999811172485
ep15_l4_test_time 7.116372346878052
gc 0
Train Epoch16 Acc 0.9961464285714285 (557842/560000), AUC 0.9991655349731445
ep16_train_time 415.4567518234253
Test Epoch16 layer4 Acc 0.9850857142857142, AUC 0.9965516328811646, avg_entr 0.0007872974965721369, f1 0.9850857257843018
ep16_l4_test_time 7.027060031890869
gc 0
Train Epoch17 Acc 0.9964714285714286 (558024/560000), AUC 0.9991782903671265
ep17_train_time 415.6440725326538
Test Epoch17 layer4 Acc 0.9847142857142858, AUC 0.9964941143989563, avg_entr 0.0007473972509615123, f1 0.9847142696380615
ep17_l4_test_time 7.106771945953369
gc 0
Train Epoch18 Acc 0.9966196428571429 (558107/560000), AUC 0.9991857409477234
ep18_train_time 415.63910388946533
Test Epoch18 layer4 Acc 0.9849142857142857, AUC 0.9962999224662781, avg_entr 0.0007533251191489398, f1 0.9849143028259277
ep18_l4_test_time 7.077221393585205
gc 0
Train Epoch19 Acc 0.9968857142857143 (558256/560000), AUC 0.9991880059242249
ep19_train_time 415.1338472366333
Test Epoch19 layer4 Acc 0.9846, AUC 0.9961513876914978, avg_entr 0.0007310066721402109, f1 0.9846000075340271
ep19_l4_test_time 7.088958501815796
gc 0
Train Epoch20 Acc 0.9970017857142857 (558321/560000), AUC 0.9992040395736694
ep20_train_time 415.9850151538849
Test Epoch20 layer4 Acc 0.9851142857142857, AUC 0.9957505464553833, avg_entr 0.0006956092547625303, f1 0.9851142764091492
ep20_l4_test_time 7.097345590591431
gc 0
Train Epoch21 Acc 0.9971678571428572 (558414/560000), AUC 0.9991917610168457
ep21_train_time 415.5406563282013
Test Epoch21 layer4 Acc 0.9841142857142857, AUC 0.9959612488746643, avg_entr 0.0006796152447350323, f1 0.9841142892837524
ep21_l4_test_time 7.084742069244385
gc 0
Train Epoch22 Acc 0.9971732142857143 (558417/560000), AUC 0.9991378784179688
ep22_train_time 415.7743318080902
Test Epoch22 layer4 Acc 0.9848571428571429, AUC 0.9957606196403503, avg_entr 0.000615597004070878, f1 0.9848571419715881
ep22_l4_test_time 7.101747035980225
gc 0
Train Epoch23 Acc 0.9974553571428572 (558575/560000), AUC 0.9992322325706482
ep23_train_time 415.6854486465454
Test Epoch23 layer4 Acc 0.9845142857142857, AUC 0.9954085350036621, avg_entr 0.0006098498706705868, f1 0.9845142960548401
ep23_l4_test_time 7.126082897186279
gc 0
Train Epoch24 Acc 0.9973589285714286 (558521/560000), AUC 0.9992298483848572
ep24_train_time 415.59229922294617
Test Epoch24 layer4 Acc 0.9845714285714285, AUC 0.995456874370575, avg_entr 0.0007130929152481258, f1 0.9845714569091797
ep24_l4_test_time 7.1233813762664795
gc 0
Train Epoch25 Acc 0.9976089285714286 (558661/560000), AUC 0.9992346167564392
ep25_train_time 415.6625061035156
Test Epoch25 layer4 Acc 0.9839714285714286, AUC 0.9953393936157227, avg_entr 0.0006029615760780871, f1 0.9839714169502258
ep25_l4_test_time 7.167600870132446
gc 0
Train Epoch26 Acc 0.9977125 (558719/560000), AUC 0.9992423057556152
ep26_train_time 415.8038640022278
Test Epoch26 layer4 Acc 0.9848857142857143, AUC 0.9950571060180664, avg_entr 0.0006541593465954065, f1 0.9848856925964355
ep26_l4_test_time 7.1132121086120605
gc 0
Train Epoch27 Acc 0.9977607142857143 (558746/560000), AUC 0.9992305636405945
ep27_train_time 415.22214674949646
Test Epoch27 layer4 Acc 0.9844857142857143, AUC 0.9949614405632019, avg_entr 0.0006185959209688008, f1 0.9844856858253479
ep27_l4_test_time 7.1190783977508545
gc 0
Train Epoch28 Acc 0.9978821428571428 (558814/560000), AUC 0.9992271661758423
ep28_train_time 415.9023189544678
Test Epoch28 layer4 Acc 0.9844571428571428, AUC 0.9947848916053772, avg_entr 0.0006949649541638792, f1 0.9844571352005005
ep28_l4_test_time 7.058550119400024
gc 0
Train Epoch29 Acc 0.9979178571428572 (558834/560000), AUC 0.9992541670799255
ep29_train_time 415.90835309028625
Test Epoch29 layer4 Acc 0.9840571428571429, AUC 0.9948467016220093, avg_entr 0.0005688179517164826, f1 0.9840571284294128
ep29_l4_test_time 7.091130971908569
Best AUC tensor(0.9864) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 12628.011760473251
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt
Test layer0 Acc 0.9748857142857142, AUC 0.9983168840408325, avg_entr 0.024661332368850708, f1 0.9748857021331787
l0_test_time 2.0628156661987305
Test layer1 Acc 0.9859428571428571, AUC 0.9988276362419128, avg_entr 0.002082511316984892, f1 0.9859428405761719
l1_test_time 3.2217705249786377
Test layer2 Acc 0.9862857142857143, AUC 0.9985746741294861, avg_entr 0.001729342620819807, f1 0.9862856268882751
l2_test_time 4.495075464248657
Test layer3 Acc 0.9861714285714286, AUC 0.9982757568359375, avg_entr 0.0015501227462664247, f1 0.9861714243888855
l3_test_time 5.850155830383301
Test layer4 Acc 0.9862, AUC 0.9981715083122253, avg_entr 0.0014407811686396599, f1 0.9861999750137329
l4_test_time 7.086160182952881
