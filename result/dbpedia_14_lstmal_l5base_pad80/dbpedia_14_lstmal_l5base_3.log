total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 59.23121213912964
Start Training
gc 0
Train Epoch0 Acc 0.8993375 (503629/560000), AUC 0.9894922375679016
ep0_train_time 418.7851994037628
Test Epoch0 layer4 Acc 0.9810285714285715, AUC 0.9974312782287598, avg_entr 0.020095674321055412, f1 0.9810285568237305
ep0_l4_test_time 7.071534872055054
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9848857142857143 (551536/560000), AUC 0.997260570526123
ep1_train_time 417.83393907546997
Test Epoch1 layer4 Acc 0.9832285714285715, AUC 0.9974981546401978, avg_entr 0.004532967694103718, f1 0.9832285642623901
ep1_l4_test_time 7.098217725753784
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9869160714285714 (552673/560000), AUC 0.9977957606315613
ep2_train_time 417.8152530193329
Test Epoch2 layer4 Acc 0.9843714285714286, AUC 0.997778594493866, avg_entr 0.0022262355778366327, f1 0.9843714237213135
ep2_l4_test_time 7.071141719818115
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9883625 (553483/560000), AUC 0.998170793056488
ep3_train_time 417.8804955482483
Test Epoch3 layer4 Acc 0.9850857142857142, AUC 0.9978823661804199, avg_entr 0.0017887644935399294, f1 0.9850857257843018
ep3_l4_test_time 7.065647602081299
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.989425 (554078/560000), AUC 0.998380184173584
ep4_train_time 360.8101477622986
Test Epoch4 layer4 Acc 0.9853714285714286, AUC 0.9981166124343872, avg_entr 0.001479047117754817, f1 0.9853714108467102
ep4_l4_test_time 7.131298065185547
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9904571428571428 (554656/560000), AUC 0.9986640810966492
ep5_train_time 417.4921932220459
Test Epoch5 layer4 Acc 0.9854571428571428, AUC 0.9980196356773376, avg_entr 0.0016271935310214758, f1 0.9854571223258972
ep5_l4_test_time 7.0744946002960205
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9912357142857143 (555092/560000), AUC 0.998842716217041
ep6_train_time 417.60770201683044
Test Epoch6 layer4 Acc 0.9856857142857143, AUC 0.9980951547622681, avg_entr 0.001484088832512498, f1 0.9856857061386108
ep6_l4_test_time 7.111943960189819
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9919285714285714 (555480/560000), AUC 0.9989386200904846
ep7_train_time 417.7682638168335
Test Epoch7 layer4 Acc 0.9862857142857143, AUC 0.9982174634933472, avg_entr 0.0013998273061588407, f1 0.9862856268882751
ep7_l4_test_time 7.058498859405518
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9926392857142857 (555878/560000), AUC 0.9990254640579224
ep8_train_time 417.88006806373596
Test Epoch8 layer4 Acc 0.9852, AUC 0.997719943523407, avg_entr 0.001167546259239316, f1 0.9851999878883362
ep8_l4_test_time 7.115178108215332
gc 0
Train Epoch9 Acc 0.9931928571428571 (556188/560000), AUC 0.9990807175636292
ep9_train_time 417.29928493499756
Test Epoch9 layer4 Acc 0.9859142857142857, AUC 0.9978879690170288, avg_entr 0.001066632685251534, f1 0.9859142899513245
ep9_l4_test_time 7.1619484424591064
gc 0
Train Epoch10 Acc 0.9937660714285714 (556509/560000), AUC 0.9991194605827332
ep10_train_time 416.92762303352356
Test Epoch10 layer4 Acc 0.9860857142857142, AUC 0.9976416230201721, avg_entr 0.0009376342641189694, f1 0.9860857129096985
ep10_l4_test_time 6.76764988899231
gc 0
Train Epoch11 Acc 0.9942178571428572 (556762/560000), AUC 0.9990536570549011
ep11_train_time 417.094619512558
Test Epoch11 layer4 Acc 0.9856285714285714, AUC 0.9976663589477539, avg_entr 0.0009648630511946976, f1 0.9856285452842712
ep11_l4_test_time 7.114731073379517
gc 0
Train Epoch12 Acc 0.9935196428571429 (556371/560000), AUC 0.9979364275932312
ep12_train_time 417.334025144577
Test Epoch12 layer4 Acc 0.9854857142857143, AUC 0.9974997639656067, avg_entr 0.0008615870610810816, f1 0.9854857325553894
ep12_l4_test_time 7.0720672607421875
gc 0
Train Epoch13 Acc 0.9908375 (554869/560000), AUC 0.9949060678482056
ep13_train_time 417.3671169281006
Test Epoch13 layer4 Acc 0.9302571428571429, AUC 0.9439030885696411, avg_entr 0.0008731451816856861, f1 0.9302570819854736
ep13_l4_test_time 7.052894592285156
gc 0
Train Epoch14 Acc 0.9843017857142857 (551209/560000), AUC 0.9882049560546875
ep14_train_time 417.0507462024689
Test Epoch14 layer4 Acc 0.9853142857142857, AUC 0.9972163438796997, avg_entr 0.000990304397419095, f1 0.9853143095970154
ep14_l4_test_time 7.116876602172852
gc 0
Train Epoch15 Acc 0.9959696428571428 (557743/560000), AUC 0.999117374420166
ep15_train_time 417.4086289405823
Test Epoch15 layer4 Acc 0.9852571428571428, AUC 0.9967058300971985, avg_entr 0.00081855762982741, f1 0.9852571487426758
ep15_l4_test_time 7.13090443611145
gc 0
Train Epoch16 Acc 0.9962946428571429 (557925/560000), AUC 0.9991095662117004
ep16_train_time 417.2426266670227
Test Epoch16 layer4 Acc 0.9849714285714286, AUC 0.996697723865509, avg_entr 0.0007974342443048954, f1 0.9849714040756226
ep16_l4_test_time 7.102936506271362
gc 0
Train Epoch17 Acc 0.9965267857142858 (558055/560000), AUC 0.9991355538368225
ep17_train_time 417.3928475379944
Test Epoch17 layer4 Acc 0.9854285714285714, AUC 0.9964390993118286, avg_entr 0.0007519739447161555, f1 0.9854285717010498
ep17_l4_test_time 7.123911142349243
gc 0
Train Epoch18 Acc 0.996675 (558138/560000), AUC 0.9991728663444519
ep18_train_time 416.80539441108704
Test Epoch18 layer4 Acc 0.9849714285714286, AUC 0.9963342547416687, avg_entr 0.0006788033642806113, f1 0.9849714040756226
ep18_l4_test_time 7.161323070526123
gc 0
Train Epoch19 Acc 0.9969321428571428 (558282/560000), AUC 0.999184787273407
ep19_train_time 417.4426188468933
Test Epoch19 layer4 Acc 0.9851428571428571, AUC 0.9962339997291565, avg_entr 0.0006997403688728809, f1 0.9851428866386414
ep19_l4_test_time 7.085744142532349
gc 0
Train Epoch20 Acc 0.997075 (558362/560000), AUC 0.9991945624351501
ep20_train_time 417.2032382488251
Test Epoch20 layer4 Acc 0.9852285714285715, AUC 0.9959875345230103, avg_entr 0.0006799381808377802, f1 0.9852285981178284
ep20_l4_test_time 7.092756032943726
gc 0
Train Epoch21 Acc 0.9972267857142857 (558447/560000), AUC 0.9991927742958069
ep21_train_time 417.28653597831726
Test Epoch21 layer4 Acc 0.9849714285714286, AUC 0.9959415197372437, avg_entr 0.0007449619588442147, f1 0.9849714040756226
ep21_l4_test_time 7.132113218307495
gc 0
Train Epoch22 Acc 0.9973821428571429 (558534/560000), AUC 0.9992329478263855
ep22_train_time 417.3142943382263
Test Epoch22 layer4 Acc 0.985, AUC 0.9957648515701294, avg_entr 0.0006934936391189694, f1 0.9850000143051147
ep22_l4_test_time 7.194364786148071
gc 0
Train Epoch23 Acc 0.9974785714285714 (558588/560000), AUC 0.9992298483848572
ep23_train_time 417.5257091522217
Test Epoch23 layer4 Acc 0.9844857142857143, AUC 0.995849609375, avg_entr 0.0006620545755140483, f1 0.9844856858253479
ep23_l4_test_time 7.094381093978882
gc 0
Train Epoch24 Acc 0.9976 (558656/560000), AUC 0.9992411732673645
ep24_train_time 417.1603982448578
Test Epoch24 layer4 Acc 0.9841142857142857, AUC 0.9956267476081848, avg_entr 0.0008137871045619249, f1 0.9841142892837524
ep24_l4_test_time 7.054863452911377
gc 0
Train Epoch25 Acc 0.9976892857142857 (558706/560000), AUC 0.999267578125
ep25_train_time 417.3585374355316
Test Epoch25 layer4 Acc 0.9845142857142857, AUC 0.9956275224685669, avg_entr 0.000625122687779367, f1 0.9845142960548401
ep25_l4_test_time 6.6295976638793945
gc 0
Train Epoch26 Acc 0.9977535714285715 (558742/560000), AUC 0.9992858171463013
ep26_train_time 417.4767196178436
Test Epoch26 layer4 Acc 0.9849714285714286, AUC 0.9956427812576294, avg_entr 0.0005954256048426032, f1 0.9849714040756226
ep26_l4_test_time 7.129005432128906
gc 0
Train Epoch27 Acc 0.9978571428571429 (558800/560000), AUC 0.9992781281471252
ep27_train_time 397.0202021598816
Test Epoch27 layer4 Acc 0.9842, AUC 0.9952602386474609, avg_entr 0.0006359510589390993, f1 0.9842000007629395
ep27_l4_test_time 5.540656805038452
gc 0
Train Epoch28 Acc 0.9979178571428572 (558834/560000), AUC 0.9992677569389343
ep28_train_time 412.00207781791687
Test Epoch28 layer4 Acc 0.9847714285714285, AUC 0.9955076575279236, avg_entr 0.0005072130588814616, f1 0.9847714304924011
ep28_l4_test_time 6.974798917770386
gc 0
Train Epoch29 Acc 0.9979660714285714 (558861/560000), AUC 0.9992944002151489
ep29_train_time 411.8045732975006
Test Epoch29 layer4 Acc 0.9850571428571429, AUC 0.9954038262367249, avg_entr 0.000618477410171181, f1 0.9850571155548096
ep29_l4_test_time 6.900024890899658
Best AUC tensor(0.9863) 7
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 12648.282292366028
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt
Test layer0 Acc 0.9742285714285714, AUC 0.9983512163162231, avg_entr 0.023903274908661842, f1 0.97422856092453
l0_test_time 2.1418209075927734
Test layer1 Acc 0.9869714285714286, AUC 0.9988955855369568, avg_entr 0.0018155085854232311, f1 0.9869714379310608
l1_test_time 2.7869555950164795
Test layer2 Acc 0.9868571428571429, AUC 0.9988559484481812, avg_entr 0.0015546330250799656, f1 0.9868571162223816
l2_test_time 4.5241758823394775
Test layer3 Acc 0.9867714285714285, AUC 0.9985464215278625, avg_entr 0.0014618993736803532, f1 0.9867714047431946
l3_test_time 5.722402095794678
Test layer4 Acc 0.9868571428571429, AUC 0.9984358549118042, avg_entr 0.0013799710432067513, f1 0.9868571162223816
l4_test_time 7.003351926803589
