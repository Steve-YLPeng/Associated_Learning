total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 57.00349762
Start Training
gc 0
Train Epoch0 Acc 0.7080464285714285 (396506/560000), AUC 0.9330092668533325
ep0_train_time 346.246311631
Test Epoch0 layer4 Acc 0.9755428571428572, AUC 0.9970351457595825, avg_entr 0.24767327308654785, f1 0.9755428433418274
ep0_l4_test_time 6.074848398000029
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9809160714285714 (549313/560000), AUC 0.9968887567520142
ep1_train_time 366.405097622
Test Epoch1 layer4 Acc 0.9810857142857143, AUC 0.9972390532493591, avg_entr 0.07107779383659363, f1 0.9810857176780701
ep1_l4_test_time 5.850349756000014
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9841482142857143 (551123/560000), AUC 0.997371256351471
ep2_train_time 341.483707157
Test Epoch2 layer4 Acc 0.9826285714285714, AUC 0.9973812103271484, avg_entr 0.032398633658885956, f1 0.982628583908081
ep2_l4_test_time 7.076519714999904
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9856232142857143 (551949/560000), AUC 0.9976927638053894
ep3_train_time 357.75626162799995
Test Epoch3 layer4 Acc 0.9836285714285714, AUC 0.9974340200424194, avg_entr 0.018333828076720238, f1 0.9836285710334778
ep3_l4_test_time 6.705292439000004
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9868160714285714 (552617/560000), AUC 0.9978280663490295
ep4_train_time 394.7251203100002
Test Epoch4 layer4 Acc 0.9839142857142857, AUC 0.9974490404129028, avg_entr 0.010845056734979153, f1 0.9839142560958862
ep4_l4_test_time 6.652901936000035
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9875839285714286 (553047/560000), AUC 0.9980180859565735
ep5_train_time 406.10007394399986
Test Epoch5 layer4 Acc 0.9844857142857143, AUC 0.9975985288619995, avg_entr 0.007019247859716415, f1 0.9844856858253479
ep5_l4_test_time 6.955586729000061
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9883607142857143 (553482/560000), AUC 0.9981904029846191
ep6_train_time 387.9087793630001
Test Epoch6 layer4 Acc 0.9847714285714285, AUC 0.9974871873855591, avg_entr 0.005014814902096987, f1 0.9847714304924011
ep6_l4_test_time 6.919838852999874
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9890017857142858 (553841/560000), AUC 0.9983116984367371
ep7_train_time 398.5485236190002
Test Epoch7 layer4 Acc 0.9847714285714285, AUC 0.9974206686019897, avg_entr 0.0038521161768585443, f1 0.9847714304924011
ep7_l4_test_time 6.052630860000136
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9895 (554120/560000), AUC 0.9984091520309448
ep8_train_time 400.75565006700026
Test Epoch8 layer4 Acc 0.9853428571428572, AUC 0.9976711273193359, avg_entr 0.0032444323878735304, f1 0.9853428602218628
ep8_l4_test_time 7.007313848000194
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9900303571428571 (554417/560000), AUC 0.9984850287437439
ep9_train_time 388.74178241799973
Test Epoch9 layer4 Acc 0.9854, AUC 0.997765839099884, avg_entr 0.002684332663193345, f1 0.9854000210762024
ep9_l4_test_time 6.774727044999963
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9905625 (554715/560000), AUC 0.9985886812210083
ep10_train_time 402.9324698769997
Test Epoch10 layer4 Acc 0.9855142857142857, AUC 0.9976933598518372, avg_entr 0.0021601184271275997, f1 0.9855142831802368
ep10_l4_test_time 6.374944707000395
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9910660714285714 (554997/560000), AUC 0.9986341595649719
ep11_train_time 396.1739261869998
Test Epoch11 layer4 Acc 0.9854857142857143, AUC 0.9977870583534241, avg_entr 0.0019461562624201179, f1 0.9854857325553894
ep11_l4_test_time 7.002406786999927
gc 0
Train Epoch12 Acc 0.9914928571428572 (555236/560000), AUC 0.9986997246742249
ep12_train_time 390.2337342519995
Test Epoch12 layer4 Acc 0.9852285714285715, AUC 0.9977693557739258, avg_entr 0.0019936207681894302, f1 0.9852285981178284
ep12_l4_test_time 6.943756161999772
gc 0
Train Epoch13 Acc 0.991925 (555478/560000), AUC 0.9987722039222717
ep13_train_time 402.6883501700004
Test Epoch13 layer4 Acc 0.985, AUC 0.9979051947593689, avg_entr 0.0016905992524698377, f1 0.9850000143051147
ep13_l4_test_time 7.294187129999955
gc 0
Train Epoch14 Acc 0.9923892857142858 (555738/560000), AUC 0.9988322257995605
ep14_train_time 385.7147676229997
Test Epoch14 layer4 Acc 0.9856285714285714, AUC 0.9977825284004211, avg_entr 0.001584141980856657, f1 0.9856285452842712
ep14_l4_test_time 7.2930715070006045
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.9926642857142857 (555892/560000), AUC 0.9988844990730286
ep15_train_time 397.02515427399976
Test Epoch15 layer4 Acc 0.9854857142857143, AUC 0.997614324092865, avg_entr 0.0013287483016029, f1 0.9854857325553894
ep15_l4_test_time 5.96509339000022
gc 0
Train Epoch16 Acc 0.9931303571428571 (556153/560000), AUC 0.9989072680473328
ep16_train_time 335.36322513199957
Test Epoch16 layer4 Acc 0.9853428571428572, AUC 0.9977889657020569, avg_entr 0.0013225795701146126, f1 0.9853428602218628
ep16_l4_test_time 5.453910274000009
gc 0
Train Epoch17 Acc 0.9934875 (556353/560000), AUC 0.9989765882492065
ep17_train_time 327.00702204499976
Test Epoch17 layer4 Acc 0.9852857142857143, AUC 0.9976277351379395, avg_entr 0.00146975286770612, f1 0.9852856993675232
ep17_l4_test_time 5.856682910000018
gc 0
Train Epoch18 Acc 0.9938517857142857 (556557/560000), AUC 0.9989737868309021
ep18_train_time 337.71850524
Test Epoch18 layer4 Acc 0.9854, AUC 0.9976078271865845, avg_entr 0.0013939549680799246, f1 0.9854000210762024
ep18_l4_test_time 5.739481064000756
gc 0
Train Epoch19 Acc 0.9941339285714286 (556715/560000), AUC 0.9990073442459106
ep19_train_time 335.5999640909995
Test Epoch19 layer4 Acc 0.9846285714285714, AUC 0.9974780678749084, avg_entr 0.0013547269627451897, f1 0.9846285581588745
ep19_l4_test_time 5.675284654000279
Best AUC tensor(0.9856) 14
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 7631.089490065
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9742571428571428, AUC 0.9982350468635559, avg_entr 0.027798457071185112, f1 0.9742571711540222
l0_test_time 1.2094243409992487
gc 0
Test layer1 Acc 0.9852285714285715, AUC 0.9987112283706665, avg_entr 0.002465044381096959, f1 0.9852285981178284
l1_test_time 2.1247595719996752
gc 0
Test layer2 Acc 0.9856857142857143, AUC 0.998380720615387, avg_entr 0.002127417828887701, f1 0.9856857061386108
l2_test_time 3.344328229999519
gc 0
Test layer3 Acc 0.9856285714285714, AUC 0.997873842716217, avg_entr 0.0020681072492152452, f1 0.9856285452842712
l3_test_time 4.4216245670004355
gc 0
Test layer4 Acc 0.9856571428571429, AUC 0.997908890247345, avg_entr 0.0019308262271806598, f1 0.9856571555137634
l4_test_time 5.621181985000476
gc 0
Test threshold 0.1 Acc 0.9789142857142857, AUC 0.9982480406761169, avg_entr 0.004528544843196869, f1 0.9789142608642578
t0.1_test_time 2.6926240149996374
gc 0
Test threshold 0.2 Acc 0.9752285714285714, AUC 0.9982050657272339, avg_entr 0.009769456461071968, f1 0.9752285480499268
t0.2_test_time 2.282650817999638
gc 0
Test threshold 0.3 Acc 0.9743142857142857, AUC 0.9982361197471619, avg_entr 0.01049801241606474, f1 0.974314272403717
t0.3_test_time 1.8631877289999466
gc 0
Test threshold 0.4 Acc 0.9742571428571428, AUC 0.9982350468635559, avg_entr 0.01053347997367382, f1 0.9742571711540222
t0.4_test_time 1.7361425080007393
gc 0
Test threshold 0.5 Acc 0.9742571428571428, AUC 0.9982350468635559, avg_entr 0.01053347997367382, f1 0.9742571711540222
t0.5_test_time 1.8821604709992243
gc 0
Test threshold 0.6 Acc 0.9742571428571428, AUC 0.9982350468635559, avg_entr 0.01053347997367382, f1 0.9742571711540222
t0.6_test_time 1.794190812999659
gc 0
Test threshold 0.7 Acc 0.9742571428571428, AUC 0.9982350468635559, avg_entr 0.01053347997367382, f1 0.9742571711540222
t0.7_test_time 1.8095463750005365
gc 0
Test threshold 0.8 Acc 0.9742571428571428, AUC 0.9982350468635559, avg_entr 0.01053347997367382, f1 0.9742571711540222
t0.8_test_time 1.7802829060001386
gc 0
Test threshold 0.9 Acc 0.9742571428571428, AUC 0.9982350468635559, avg_entr 0.01053347997367382, f1 0.9742571711540222
t0.9_test_time 1.7010664540002836
