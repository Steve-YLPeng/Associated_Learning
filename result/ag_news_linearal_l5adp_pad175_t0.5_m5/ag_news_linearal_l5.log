total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.5_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9330833333333334 (111970/120000), AUC 0.9871829152107239
ep0_train_time 10.50803804397583
Test Epoch0 threshold 0.5 Acc 0.9154605263157894, AUC 0.9806855916976929, avg_entr 0.024944739416241646
ep0_t0.5_test_time 0.2549476623535156
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9495916666666666 (113951/120000), AUC 0.9929460287094116
ep1_train_time 9.906739234924316
Test Epoch1 threshold 0.5 Acc 0.9131578947368421, AUC 0.9805865287780762, avg_entr 0.025511931627988815
ep1_t0.5_test_time 0.25377345085144043
gc 0
Train Epoch2 Acc 0.9509833333333333 (114118/120000), AUC 0.9930326342582703
ep2_train_time 10.131505727767944
Test Epoch2 threshold 0.5 Acc 0.9148026315789474, AUC 0.9807064533233643, avg_entr 0.026076488196849823
ep2_t0.5_test_time 0.2521324157714844
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m5//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.952225 (114267/120000), AUC 0.9932795166969299
ep3_train_time 10.027363061904907
Test Epoch3 threshold 0.5 Acc 0.9133223684210526, AUC 0.9801784157752991, avg_entr 0.0255997683852911
ep3_t0.5_test_time 0.25533390045166016
gc 0
Train Epoch4 Acc 0.9530833333333333 (114370/120000), AUC 0.9936317205429077
ep4_train_time 10.013230800628662
Test Epoch4 threshold 0.5 Acc 0.9146381578947368, AUC 0.9802955389022827, avg_entr 0.0252706129103899
ep4_t0.5_test_time 0.2553670406341553
gc 0
Train Epoch5 Acc 0.9547583333333334 (114571/120000), AUC 0.9943569302558899
ep5_train_time 10.054943561553955
Test Epoch5 threshold 0.5 Acc 0.9131578947368421, AUC 0.9801158905029297, avg_entr 0.025670476257801056
ep5_t0.5_test_time 0.2541506290435791
gc 0
Train Epoch6 Acc 0.9554916666666666 (114659/120000), AUC 0.9945996999740601
ep6_train_time 10.249875545501709
Test Epoch6 threshold 0.5 Acc 0.9146381578947368, AUC 0.9800010919570923, avg_entr 0.02542303502559662
ep6_t0.5_test_time 0.25471019744873047
gc 0
Train Epoch7 Acc 0.9558916666666667 (114707/120000), AUC 0.9945932626724243
ep7_train_time 9.873038291931152
Test Epoch7 threshold 0.5 Acc 0.9111842105263158, AUC 0.9797797203063965, avg_entr 0.025911951437592506
ep7_t0.5_test_time 0.2546854019165039
gc 0
Train Epoch8 Acc 0.9564 (114768/120000), AUC 0.9948325157165527
ep8_train_time 10.295411586761475
Test Epoch8 threshold 0.5 Acc 0.9131578947368421, AUC 0.9797222018241882, avg_entr 0.026828201487660408
ep8_t0.5_test_time 0.2554786205291748
gc 0
Train Epoch9 Acc 0.9574583333333333 (114895/120000), AUC 0.9950916767120361
ep9_train_time 10.06685757637024
Test Epoch9 threshold 0.5 Acc 0.9123355263157895, AUC 0.9796500205993652, avg_entr 0.025303712114691734
ep9_t0.5_test_time 0.2542686462402344
Best AUC 0.9807064533233643
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.5_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.925, AUC 0.9860299825668335, avg_entr 0.02498909831047058
t0.5_test_time 0.06370759010314941
