total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 48937378
init_time 25.621280211
Start Training
gc 0
Train Epoch0 Acc 0.5035 (20140/40000), AUC 0.5014364123344421
ep0_train_time 38.99771993099999
Test Epoch0 layer4 Acc 0.5032, AUC 0.49976813793182373, avg_entr 0.6860652565956116, f1 0.5031999945640564
ep0_l4_test_time 1.3949338439999934
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.50485 (20194/40000), AUC 0.507606029510498
ep1_train_time 35.247237844
Test Epoch1 layer4 Acc 0.5078, AUC 0.5041122436523438, avg_entr 0.687912106513977, f1 0.5077999830245972
ep1_l4_test_time 1.492436963000003
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.507 (20280/40000), AUC 0.5117812156677246
ep2_train_time 42.461155178
Test Epoch2 layer4 Acc 0.5048, AUC 0.500503420829773, avg_entr 0.6843968033790588, f1 0.504800021648407
ep2_l4_test_time 1.5867191799999887
gc 0
Train Epoch3 Acc 0.508125 (20325/40000), AUC 0.5137515664100647
ep3_train_time 41.690196310999994
Test Epoch3 layer4 Acc 0.51, AUC 0.5091801881790161, avg_entr 0.6845776438713074, f1 0.5099999904632568
ep3_l4_test_time 1.6270034789999954
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.5099 (20396/40000), AUC 0.5175909996032715
ep4_train_time 43.10000706399998
Test Epoch4 layer4 Acc 0.5062, AUC 0.5013254880905151, avg_entr 0.6799817681312561, f1 0.5062000155448914
ep4_l4_test_time 1.6267390410000075
gc 0
Train Epoch5 Acc 0.514725 (20589/40000), AUC 0.5265126824378967
ep5_train_time 38.502487547999976
Test Epoch5 layer4 Acc 0.5074, AUC 0.5049526691436768, avg_entr 0.6703207492828369, f1 0.5073999762535095
ep5_l4_test_time 1.3048461640000255
gc 0
Train Epoch6 Acc 0.51765 (20706/40000), AUC 0.5284422636032104
ep6_train_time 36.634158216
Test Epoch6 layer4 Acc 0.5066, AUC 0.5031882524490356, avg_entr 0.6747871041297913, f1 0.506600022315979
ep6_l4_test_time 1.611464548000015
gc 0
Train Epoch7 Acc 0.51565 (20626/40000), AUC 0.5305204391479492
ep7_train_time 41.952743792000035
Test Epoch7 layer4 Acc 0.5058, AUC 0.5009099245071411, avg_entr 0.6727536916732788, f1 0.5058000087738037
ep7_l4_test_time 1.5998284329999706
gc 0
Train Epoch8 Acc 0.519225 (20769/40000), AUC 0.5335564613342285
ep8_train_time 42.12781399200003
Test Epoch8 layer4 Acc 0.4956, AUC 0.5018759965896606, avg_entr 0.6642976403236389, f1 0.49559998512268066
ep8_l4_test_time 1.5970024139999737
gc 0
Train Epoch9 Acc 0.52155 (20862/40000), AUC 0.539107620716095
ep9_train_time 42.187576964000016
Test Epoch9 layer4 Acc 0.5058, AUC 0.5020944476127625, avg_entr 0.6685041785240173, f1 0.5058000087738037
ep9_l4_test_time 1.5626459060000002
gc 0
Train Epoch10 Acc 0.524275 (20971/40000), AUC 0.5413297414779663
ep10_train_time 38.857187324999984
Test Epoch10 layer4 Acc 0.506, AUC 0.5006878972053528, avg_entr 0.659540593624115, f1 0.5059999823570251
ep10_l4_test_time 1.3357037540000078
gc 0
Train Epoch11 Acc 0.5208 (20832/40000), AUC 0.5422166585922241
ep11_train_time 35.56224511600004
Test Epoch11 layer4 Acc 0.4952, AUC 0.4965999126434326, avg_entr 0.6587189435958862, f1 0.4952000081539154
ep11_l4_test_time 1.4597538080000731
gc 0
Train Epoch12 Acc 0.52465 (20986/40000), AUC 0.5469210147857666
ep12_train_time 42.57922239699997
Test Epoch12 layer4 Acc 0.5062, AUC 0.5050634145736694, avg_entr 0.659572184085846, f1 0.5062000155448914
ep12_l4_test_time 1.659612215999914
gc 0
Train Epoch13 Acc 0.524175 (20967/40000), AUC 0.5470794439315796
ep13_train_time 42.964946331999954
Test Epoch13 layer4 Acc 0.507, AUC 0.5036084651947021, avg_entr 0.6547375321388245, f1 0.5070000290870667
ep13_l4_test_time 1.5847555210000337
gc 0
Train Epoch14 Acc 0.5265 (21060/40000), AUC 0.5514314770698547
ep14_train_time 43.03884352099999
Test Epoch14 layer4 Acc 0.4956, AUC 0.5007568597793579, avg_entr 0.6599425673484802, f1 0.49559998512268066
ep14_l4_test_time 1.6054855179999095
gc 0
Train Epoch15 Acc 0.53215 (21286/40000), AUC 0.5604509115219116
ep15_train_time 37.130510269999945
Test Epoch15 layer4 Acc 0.5064, AUC 0.27113842964172363, avg_entr 0.6531487107276917, f1 0.5063999891281128
ep15_l4_test_time 1.2983447919999662
gc 0
Train Epoch16 Acc 0.533 (21320/40000), AUC 0.5629667043685913
ep16_train_time 37.59796967600005
Test Epoch16 layer4 Acc 0.495, AUC 0.49820664525032043, avg_entr 0.6551007628440857, f1 0.4950000047683716
ep16_l4_test_time 1.5855491040000516
gc 0
Train Epoch17 Acc 0.534725 (21389/40000), AUC 0.5646659135818481
ep17_train_time 41.99205067899993
Test Epoch17 layer4 Acc 0.5066, AUC 0.6088963150978088, avg_entr 0.6555289030075073, f1 0.506600022315979
ep17_l4_test_time 1.5791307979999374
gc 0
Train Epoch18 Acc 0.534575 (21383/40000), AUC 0.5623395442962646
ep18_train_time 41.953232605999915
Test Epoch18 layer4 Acc 0.4946, AUC 0.4981573820114136, avg_entr 0.6550083756446838, f1 0.49459999799728394
ep18_l4_test_time 1.615970238999921
gc 0
Train Epoch19 Acc 0.5383 (21532/40000), AUC 0.5701367855072021
ep19_train_time 40.770200812999974
Test Epoch19 layer4 Acc 0.495, AUC 0.5007852911949158, avg_entr 0.6393527388572693, f1 0.4950000047683716
ep19_l4_test_time 1.5929831490000197
gc 0
Train Epoch20 Acc 0.532575 (21303/40000), AUC 0.5640844106674194
ep20_train_time 38.76104128700001
Test Epoch20 layer4 Acc 0.5048, AUC 0.4976365566253662, avg_entr 0.6531690359115601, f1 0.504800021648407
ep20_l4_test_time 1.370743876000006
gc 0
Train Epoch21 Acc 0.5333 (21332/40000), AUC 0.5636537671089172
ep21_train_time 35.64084267700002
Test Epoch21 layer4 Acc 0.495, AUC 0.49892687797546387, avg_entr 0.6528521776199341, f1 0.4950000047683716
ep21_l4_test_time 1.4637124350000477
gc 0
Train Epoch22 Acc 0.536575 (21463/40000), AUC 0.5664892196655273
ep22_train_time 42.504716780999956
Test Epoch22 layer4 Acc 0.4946, AUC 0.5003742575645447, avg_entr 0.653864860534668, f1 0.49459999799728394
ep22_l4_test_time 1.592829896000012
gc 0
Train Epoch23 Acc 0.533075 (21323/40000), AUC 0.5670047402381897
ep23_train_time 42.94700085799991
Test Epoch23 layer4 Acc 0.4944, AUC 0.499835729598999, avg_entr 0.6542450189590454, f1 0.4943999946117401
ep23_l4_test_time 1.6342994910000925
gc 0
Train Epoch24 Acc 0.538225 (21529/40000), AUC 0.5714296102523804
ep24_train_time 42.93106888500006
Test Epoch24 layer4 Acc 0.5052, AUC 0.49666187167167664, avg_entr 0.6477816700935364, f1 0.5052000284194946
ep24_l4_test_time 1.5904203610000422
gc 0
Train Epoch25 Acc 0.53785 (21514/40000), AUC 0.5694464445114136
ep25_train_time 37.348885836000136
Test Epoch25 layer4 Acc 0.5056, AUC 0.7273335456848145, avg_entr 0.6492656469345093, f1 0.5055999755859375
ep25_l4_test_time 1.3001262299999325
gc 0
Train Epoch26 Acc 0.535475 (21419/40000), AUC 0.5659748315811157
ep26_train_time 37.3523827250001
Test Epoch26 layer4 Acc 0.5058, AUC 0.496072918176651, avg_entr 0.6518008708953857, f1 0.5058000087738037
ep26_l4_test_time 1.56832972899997
gc 0
Train Epoch27 Acc 0.538675 (21547/40000), AUC 0.5704193115234375
ep27_train_time 41.92318467699988
Test Epoch27 layer4 Acc 0.5062, AUC 0.3926037549972534, avg_entr 0.6525000929832458, f1 0.5062000155448914
ep27_l4_test_time 1.5797750249998899
gc 0
Train Epoch28 Acc 0.5344 (21376/40000), AUC 0.5670526027679443
ep28_train_time 41.89055152300011
Test Epoch28 layer4 Acc 0.5054, AUC 0.25686201453208923, avg_entr 0.6511147618293762, f1 0.5054000020027161
ep28_l4_test_time 1.6009571099998539
gc 0
Train Epoch29 Acc 0.53895 (21558/40000), AUC 0.5741907358169556
ep29_train_time 42.10287697900003
Test Epoch29 layer4 Acc 0.5048, AUC 0.5049200654029846, avg_entr 0.6413208842277527, f1 0.504800021648407
ep29_l4_test_time 1.591314728000043
gc 0
Train Epoch30 Acc 0.537575 (21503/40000), AUC 0.5702096819877625
ep30_train_time 37.970802493000065
Test Epoch30 layer4 Acc 0.5056, AUC 0.6065833568572998, avg_entr 0.6521358489990234, f1 0.5055999755859375
ep30_l4_test_time 1.2952588910000031
gc 0
Train Epoch31 Acc 0.5394 (21576/40000), AUC 0.5727166533470154
ep31_train_time 35.699287167999955
Test Epoch31 layer4 Acc 0.494, AUC 0.38641178607940674, avg_entr 0.6515402793884277, f1 0.49399998784065247
ep31_l4_test_time 1.4564842649999719
gc 0
Train Epoch32 Acc 0.53835 (21534/40000), AUC 0.5726025700569153
ep32_train_time 42.879545921000044
Test Epoch32 layer4 Acc 0.5058, AUC 0.49751436710357666, avg_entr 0.6480033993721008, f1 0.5058000087738037
ep32_l4_test_time 1.6526016180000624
gc 0
Train Epoch33 Acc 0.53515 (21406/40000), AUC 0.5688445568084717
ep33_train_time 42.912409024
Test Epoch33 layer4 Acc 0.4942, AUC 0.5050580501556396, avg_entr 0.6510961055755615, f1 0.4941999912261963
ep33_l4_test_time 1.6149425620001239
gc 0
Train Epoch34 Acc 0.536575 (21463/40000), AUC 0.5689562559127808
ep34_train_time 42.94482947999995
Test Epoch34 layer4 Acc 0.4928, AUC 0.4938676059246063, avg_entr 0.6514815092086792, f1 0.4927999973297119
ep34_l4_test_time 1.6131452219999574
gc 0
Train Epoch35 Acc 0.537975 (21519/40000), AUC 0.571219265460968
ep35_train_time 36.358013174999996
Test Epoch35 layer4 Acc 0.5052, AUC 0.4979047179222107, avg_entr 0.6508328318595886, f1 0.5052000284194946
ep35_l4_test_time 1.2963051940000696
gc 0
Train Epoch36 Acc 0.537075 (21483/40000), AUC 0.5700492858886719
ep36_train_time 36.08309106399997
Test Epoch36 layer4 Acc 0.504, AUC 0.7209047079086304, avg_entr 0.6497028470039368, f1 0.5040000081062317
ep36_l4_test_time 1.3241186879999987
gc 0
Train Epoch37 Acc 0.5388 (21552/40000), AUC 0.5689984560012817
ep37_train_time 31.965510685000027
Test Epoch37 layer4 Acc 0.493, AUC 0.4976762533187866, avg_entr 0.651207447052002, f1 0.49300000071525574
ep37_l4_test_time 1.3050999390000015
gc 0
Train Epoch38 Acc 0.5372 (21488/40000), AUC 0.5672632455825806
ep38_train_time 32.039564046999885
Test Epoch38 layer4 Acc 0.5042, AUC 0.26489317417144775, avg_entr 0.6513487696647644, f1 0.5041999816894531
ep38_l4_test_time 1.3183498190001046
gc 0
Train Epoch39 Acc 0.539425 (21577/40000), AUC 0.5699646472930908
ep39_train_time 32.019118685999956
Test Epoch39 layer4 Acc 0.5048, AUC 0.49547773599624634, avg_entr 0.6512950658798218, f1 0.504800021648407
ep39_l4_test_time 1.302407427000162
gc 0
Train Epoch40 Acc 0.538375 (21535/40000), AUC 0.5663723945617676
ep40_train_time 31.97413407399995
Test Epoch40 layer4 Acc 0.4938, AUC 0.27702796459198, avg_entr 0.6500197052955627, f1 0.49380001425743103
ep40_l4_test_time 1.31058116600002
gc 0
Train Epoch41 Acc 0.54005 (21602/40000), AUC 0.5724401473999023
ep41_train_time 34.96206443599999
Test Epoch41 layer4 Acc 0.5048, AUC 0.49541956186294556, avg_entr 0.6487123966217041, f1 0.504800021648407
ep41_l4_test_time 1.581147761000011
gc 0
Train Epoch42 Acc 0.539725 (21589/40000), AUC 0.5725077390670776
ep42_train_time 38.02023667699996
Test Epoch42 layer4 Acc 0.4928, AUC 0.6139082312583923, avg_entr 0.6474955677986145, f1 0.4927999973297119
ep42_l4_test_time 1.4595773879998433
gc 0
Train Epoch43 Acc 0.533775 (21351/40000), AUC 0.569835901260376
ep43_train_time 35.372923477000086
Test Epoch43 layer4 Acc 0.4928, AUC 0.3754343092441559, avg_entr 0.6507405042648315, f1 0.4927999973297119
ep43_l4_test_time 1.6047335299999759
gc 0
Train Epoch44 Acc 0.538975 (21559/40000), AUC 0.5658185482025146
ep44_train_time 41.54232352100007
Test Epoch44 layer4 Acc 0.504, AUC 0.49932438135147095, avg_entr 0.6503673791885376, f1 0.5040000081062317
ep44_l4_test_time 1.5914462179998736
gc 0
Train Epoch45 Acc 0.51755 (20702/40000), AUC 0.5081624984741211
ep45_train_time 42.11241820400005
Test Epoch45 layer4 Acc 0.5, AUC 0.5, avg_entr nan, f1 0.5
ep45_l4_test_time 1.5981318639999245
gc 0
Train Epoch46 Acc 0.50125 (20050/40000), AUC 0.5
ep46_train_time 41.40117856799998
Test Epoch46 layer4 Acc 0.5, AUC 0.5, avg_entr nan, f1 0.5
ep46_l4_test_time 1.4325546150000719
gc 0
Train Epoch47 Acc 0.50125 (20050/40000), AUC 0.5
ep47_train_time 34.76493427799983
Test Epoch47 layer4 Acc 0.5, AUC 0.5, avg_entr nan, f1 0.5
ep47_l4_test_time 1.4930544549999922
gc 0
Train Epoch48 Acc 0.50125 (20050/40000), AUC 0.5
ep48_train_time 39.458257900000035
Test Epoch48 layer4 Acc 0.5, AUC 0.5, avg_entr nan, f1 0.5
ep48_l4_test_time 1.5807600560001447
gc 0
Train Epoch49 Acc 0.50125 (20050/40000), AUC 0.4999999701976776
ep49_train_time 42.820449587999974
Test Epoch49 layer4 Acc 0.5, AUC 0.5, avg_entr nan, f1 0.5
ep49_l4_test_time 1.5923655569999937
gc 0
Train Epoch50 Acc 0.50125 (20050/40000), AUC 0.5
ep50_train_time 42.77553190399976
Test Epoch50 layer4 Acc 0.5, AUC 0.5, avg_entr nan, f1 0.5
ep50_l4_test_time 1.5956510840001101
gc 0
Train Epoch51 Acc 0.50125 (20050/40000), AUC 0.5
ep51_train_time 41.11219271900018
Test Epoch51 layer4 Acc 0.5, AUC 0.5, avg_entr nan, f1 0.5
ep51_l4_test_time 1.3982004690001304
gc 0
Train Epoch52 Acc 0.50125 (20050/40000), AUC 0.4999999701976776
ep52_train_time 35.139006638999945
Test Epoch52 layer4 Acc 0.5, AUC 0.5, avg_entr nan, f1 0.5
ep52_l4_test_time 1.573481830000219
gc 0
Train Epoch53 Acc 0.50125 (20050/40000), AUC 0.5
ep53_train_time 40.18551180500026
Test Epoch53 layer4 Acc 0.5, AUC 0.5, avg_entr nan, f1 0.5
ep53_l4_test_time 1.5703780509998069
gc 0
Train Epoch54 Acc 0.50125 (20050/40000), AUC 0.5
ep54_train_time 41.932154096999966
Test Epoch54 layer4 Acc 0.5, AUC 0.5, avg_entr nan, f1 0.5
ep54_l4_test_time 1.5889846169998236
gc 0
Train Epoch55 Acc 0.50125 (20050/40000), AUC 0.5
ep55_train_time 41.91932494899993
Test Epoch55 layer4 Acc 0.5, AUC 0.5, avg_entr nan, f1 0.5
ep55_l4_test_time 1.6131805569998505
gc 0
