total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 22.08310031890869
Start Training
gc 0
Train Epoch0 Acc 0.732425 (87891/120000), AUC 0.9181309342384338
ep0_train_time 100.57122778892517
Test Epoch0 layer4 Acc 0.9092105263157895, AUC 0.9777670502662659, avg_entr 0.11923076957464218
ep0_l4_test_time 0.8517959117889404
Save ckpt to ckpt/ag_news_lstmal_l5base_pad100//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.92285 (110742/120000), AUC 0.9797743558883667
ep1_train_time 100.74608516693115
Test Epoch1 layer4 Acc 0.9176315789473685, AUC 0.982132077217102, avg_entr 0.056031905114650726
ep1_l4_test_time 0.8341634273529053
Save ckpt to ckpt/ag_news_lstmal_l5base_pad100//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9342 (112104/120000), AUC 0.984856367111206
ep2_train_time 100.24561929702759
Test Epoch2 layer4 Acc 0.9226315789473685, AUC 0.9825189709663391, avg_entr 0.03607843443751335
ep2_l4_test_time 0.8532330989837646
Save ckpt to ckpt/ag_news_lstmal_l5base_pad100//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9411916666666666 (112943/120000), AUC 0.9878966808319092
ep3_train_time 100.90799736976624
Test Epoch3 layer4 Acc 0.9213157894736842, AUC 0.9812449812889099, avg_entr 0.02539931610226631
ep3_l4_test_time 0.8487892150878906
gc 0
Train Epoch4 Acc 0.9459916666666667 (113519/120000), AUC 0.9892300367355347
ep4_train_time 100.51018810272217
Test Epoch4 layer4 Acc 0.9181578947368421, AUC 0.9820611476898193, avg_entr 0.02217702940106392
ep4_l4_test_time 0.761652946472168
gc 0
Train Epoch5 Acc 0.9497416666666667 (113969/120000), AUC 0.9902687072753906
ep5_train_time 100.85515427589417
Test Epoch5 layer4 Acc 0.9218421052631579, AUC 0.9804713726043701, avg_entr 0.02293633297085762
ep5_l4_test_time 0.8497254848480225
gc 0
Train Epoch6 Acc 0.9525083333333333 (114301/120000), AUC 0.9908907413482666
ep6_train_time 100.78272747993469
Test Epoch6 layer4 Acc 0.9213157894736842, AUC 0.9800428152084351, avg_entr 0.020410630851984024
ep6_l4_test_time 0.8412039279937744
gc 0
Train Epoch7 Acc 0.9550083333333333 (114601/120000), AUC 0.9917511940002441
ep7_train_time 100.10102558135986
Test Epoch7 layer4 Acc 0.916578947368421, AUC 0.9791151285171509, avg_entr 0.01715335063636303
ep7_l4_test_time 0.8437798023223877
gc 0
Train Epoch8 Acc 0.9576583333333333 (114919/120000), AUC 0.991936981678009
ep8_train_time 100.62709450721741
Test Epoch8 layer4 Acc 0.9171052631578948, AUC 0.978194534778595, avg_entr 0.017573226243257523
ep8_l4_test_time 0.8451535701751709
gc 0
Train Epoch9 Acc 0.959675 (115161/120000), AUC 0.9924336075782776
ep9_train_time 100.29594707489014
Test Epoch9 layer4 Acc 0.9176315789473685, AUC 0.978844404220581, avg_entr 0.016435561701655388
ep9_l4_test_time 0.8447418212890625
gc 0
Train Epoch10 Acc 0.9612916666666667 (115355/120000), AUC 0.9927207231521606
ep10_train_time 100.9578685760498
Test Epoch10 layer4 Acc 0.9147368421052632, AUC 0.9773221015930176, avg_entr 0.013293985277414322
ep10_l4_test_time 0.8447678089141846
gc 0
Train Epoch11 Acc 0.9630666666666666 (115568/120000), AUC 0.9928792715072632
ep11_train_time 100.84823393821716
Test Epoch11 layer4 Acc 0.915, AUC 0.9769903421401978, avg_entr 0.013576249592006207
ep11_l4_test_time 0.8529300689697266
gc 0
Train Epoch12 Acc 0.9654 (115848/120000), AUC 0.9932457804679871
ep12_train_time 100.36054372787476
Test Epoch12 layer4 Acc 0.9107894736842105, AUC 0.9751442074775696, avg_entr 0.013612628914415836
ep12_l4_test_time 0.8532454967498779
gc 0
Train Epoch13 Acc 0.9669833333333333 (116038/120000), AUC 0.9933251142501831
ep13_train_time 101.05817294120789
Test Epoch13 layer4 Acc 0.9136842105263158, AUC 0.9740073680877686, avg_entr 0.013441096991300583
ep13_l4_test_time 0.8369848728179932
gc 0
Train Epoch14 Acc 0.9686333333333333 (116236/120000), AUC 0.9934694766998291
ep14_train_time 100.57663893699646
Test Epoch14 layer4 Acc 0.9068421052631579, AUC 0.9735734462738037, avg_entr 0.010285102762281895
ep14_l4_test_time 0.8517391681671143
gc 0
Train Epoch15 Acc 0.9699416666666667 (116393/120000), AUC 0.9935562014579773
ep15_train_time 101.01904797554016
Test Epoch15 layer4 Acc 0.906578947368421, AUC 0.9731259942054749, avg_entr 0.01082495879381895
ep15_l4_test_time 0.8381271362304688
gc 0
Train Epoch16 Acc 0.9715583333333333 (116587/120000), AUC 0.9936761856079102
ep16_train_time 99.78258991241455
Test Epoch16 layer4 Acc 0.9060526315789473, AUC 0.9717121124267578, avg_entr 0.009740800596773624
ep16_l4_test_time 0.8685622215270996
gc 0
Train Epoch17 Acc 0.9731416666666667 (116777/120000), AUC 0.9938338994979858
ep17_train_time 100.1600444316864
Test Epoch17 layer4 Acc 0.9071052631578947, AUC 0.9690728187561035, avg_entr 0.00910964421927929
ep17_l4_test_time 0.8352642059326172
gc 0
Train Epoch18 Acc 0.9746583333333333 (116959/120000), AUC 0.9939579367637634
ep18_train_time 100.63744378089905
Test Epoch18 layer4 Acc 0.9028947368421053, AUC 0.9697802066802979, avg_entr 0.010536949150264263
ep18_l4_test_time 0.8459572792053223
gc 0
Train Epoch19 Acc 0.9762333333333333 (117148/120000), AUC 0.9940763711929321
ep19_train_time 99.69354820251465
Test Epoch19 layer4 Acc 0.9036842105263158, AUC 0.9650436639785767, avg_entr 0.00880434736609459
ep19_l4_test_time 0.845517635345459
gc 0
Train Epoch20 Acc 0.977625 (117315/120000), AUC 0.9943021535873413
ep20_train_time 100.21791696548462
Test Epoch20 layer4 Acc 0.9005263157894737, AUC 0.9666553735733032, avg_entr 0.008265532553195953
ep20_l4_test_time 0.8533494472503662
gc 0
Train Epoch21 Acc 0.9791333333333333 (117496/120000), AUC 0.9943246245384216
ep21_train_time 99.66006112098694
Test Epoch21 layer4 Acc 0.9071052631578947, AUC 0.9646105170249939, avg_entr 0.006507590413093567
ep21_l4_test_time 0.8271129131317139
gc 0
Train Epoch22 Acc 0.9806666666666667 (117680/120000), AUC 0.9945043325424194
ep22_train_time 100.06176519393921
Test Epoch22 layer4 Acc 0.901578947368421, AUC 0.9647163152694702, avg_entr 0.0073748319409787655
ep22_l4_test_time 0.8387575149536133
gc 0
Train Epoch23 Acc 0.9811833333333333 (117742/120000), AUC 0.9947411417961121
ep23_train_time 100.04694700241089
Test Epoch23 layer4 Acc 0.9021052631578947, AUC 0.9640711545944214, avg_entr 0.0059622498229146
ep23_l4_test_time 0.8590309619903564
gc 0
Train Epoch24 Acc 0.982775 (117933/120000), AUC 0.9947724938392639
ep24_train_time 99.7584936618805
Test Epoch24 layer4 Acc 0.9007894736842105, AUC 0.9597870111465454, avg_entr 0.005717942025512457
ep24_l4_test_time 0.8517863750457764
gc 0
Train Epoch25 Acc 0.9836583333333333 (118039/120000), AUC 0.9950383901596069
ep25_train_time 100.20137548446655
Test Epoch25 layer4 Acc 0.896578947368421, AUC 0.9598895907402039, avg_entr 0.005546183325350285
ep25_l4_test_time 0.8426687717437744
gc 0
Train Epoch26 Acc 0.984525 (118143/120000), AUC 0.9951449036598206
ep26_train_time 99.55669379234314
Test Epoch26 layer4 Acc 0.9002631578947369, AUC 0.9595720767974854, avg_entr 0.005904264748096466
ep26_l4_test_time 0.831104040145874
gc 0
Train Epoch27 Acc 0.9851166666666666 (118214/120000), AUC 0.9952259063720703
ep27_train_time 100.0728325843811
Test Epoch27 layer4 Acc 0.901578947368421, AUC 0.9616225957870483, avg_entr 0.007444774266332388
ep27_l4_test_time 0.8447110652923584
gc 0
Train Epoch28 Acc 0.9862583333333333 (118351/120000), AUC 0.9953887462615967
ep28_train_time 99.56156516075134
Test Epoch28 layer4 Acc 0.8984210526315789, AUC 0.9596802592277527, avg_entr 0.005430324003100395
ep28_l4_test_time 0.843254566192627
gc 0
Train Epoch29 Acc 0.9866583333333333 (118399/120000), AUC 0.9954656362533569
ep29_train_time 100.00166296958923
Test Epoch29 layer4 Acc 0.8968421052631579, AUC 0.9596924781799316, avg_entr 0.006273926235735416
ep29_l4_test_time 0.8478703498840332
gc 0
Train Epoch30 Acc 0.9869416666666667 (118433/120000), AUC 0.9955764412879944
ep30_train_time 100.0662624835968
Test Epoch30 layer4 Acc 0.8952631578947369, AUC 0.9572681188583374, avg_entr 0.006427375599741936
ep30_l4_test_time 0.8509306907653809
gc 0
Train Epoch31 Acc 0.9878666666666667 (118544/120000), AUC 0.9957065582275391
ep31_train_time 99.5634229183197
Test Epoch31 layer4 Acc 0.8981578947368422, AUC 0.9567354917526245, avg_entr 0.004911778960376978
ep31_l4_test_time 0.8444399833679199
gc 0
Train Epoch32 Acc 0.98815 (118578/120000), AUC 0.9957612156867981
ep32_train_time 100.21808528900146
Test Epoch32 layer4 Acc 0.8939473684210526, AUC 0.9558708071708679, avg_entr 0.006205311976373196
ep32_l4_test_time 0.83113694190979
gc 0
Train Epoch33 Acc 0.9886833333333334 (118642/120000), AUC 0.9958581924438477
ep33_train_time 99.6881697177887
Test Epoch33 layer4 Acc 0.8939473684210526, AUC 0.9548362493515015, avg_entr 0.005340948235243559
ep33_l4_test_time 0.854701042175293
gc 0
Train Epoch34 Acc 0.9891833333333333 (118702/120000), AUC 0.9959079027175903
ep34_train_time 100.81586337089539
Test Epoch34 layer4 Acc 0.8997368421052632, AUC 0.9578729271888733, avg_entr 0.004327243193984032
ep34_l4_test_time 0.8631789684295654
gc 0
Train Epoch35 Acc 0.9894333333333334 (118732/120000), AUC 0.9961064457893372
ep35_train_time 101.06423902511597
Test Epoch35 layer4 Acc 0.8997368421052632, AUC 0.9535520672798157, avg_entr 0.003491298295557499
ep35_l4_test_time 0.8535254001617432
gc 0
Train Epoch36 Acc 0.9897583333333333 (118771/120000), AUC 0.9961507320404053
ep36_train_time 100.28131651878357
Test Epoch36 layer4 Acc 0.8989473684210526, AUC 0.9543381929397583, avg_entr 0.0047505381517112255
ep36_l4_test_time 0.8482050895690918
gc 0
Train Epoch37 Acc 0.9899166666666667 (118790/120000), AUC 0.9963980913162231
ep37_train_time 100.3210802078247
Test Epoch37 layer4 Acc 0.8968421052631579, AUC 0.9551849365234375, avg_entr 0.004562310874462128
ep37_l4_test_time 0.843515157699585
gc 0
Train Epoch38 Acc 0.9905416666666667 (118865/120000), AUC 0.9964147806167603
ep38_train_time 100.58603835105896
Test Epoch38 layer4 Acc 0.8971052631578947, AUC 0.9548590779304504, avg_entr 0.004207322373986244
ep38_l4_test_time 0.8291294574737549
gc 0
Train Epoch39 Acc 0.99075 (118890/120000), AUC 0.9963988065719604
ep39_train_time 100.86734914779663
Test Epoch39 layer4 Acc 0.8984210526315789, AUC 0.9546874761581421, avg_entr 0.005262995138764381
ep39_l4_test_time 0.8473401069641113
gc 0
Train Epoch40 Acc 0.9911583333333334 (118939/120000), AUC 0.9966402053833008
ep40_train_time 100.29241132736206
Test Epoch40 layer4 Acc 0.8963157894736842, AUC 0.9509009718894958, avg_entr 0.004659145604819059
ep40_l4_test_time 0.8520841598510742
gc 0
Train Epoch41 Acc 0.99135 (118962/120000), AUC 0.996730387210846
ep41_train_time 101.12867999076843
Test Epoch41 layer4 Acc 0.8960526315789473, AUC 0.9514127373695374, avg_entr 0.004377827513962984
ep41_l4_test_time 0.8367483615875244
gc 0
Train Epoch42 Acc 0.9914416666666667 (118973/120000), AUC 0.9966725707054138
ep42_train_time 100.88160800933838
Test Epoch42 layer4 Acc 0.8957894736842106, AUC 0.953402042388916, avg_entr 0.004332579206675291
ep42_l4_test_time 0.845036506652832
gc 0
Train Epoch43 Acc 0.9917416666666666 (119009/120000), AUC 0.9967374801635742
ep43_train_time 100.55454134941101
Test Epoch43 layer4 Acc 0.8976315789473684, AUC 0.9514721632003784, avg_entr 0.003498037811368704
ep43_l4_test_time 0.8320581912994385
gc 0
Train Epoch44 Acc 0.9916083333333333 (118993/120000), AUC 0.9968066811561584
ep44_train_time 100.98554992675781
Test Epoch44 layer4 Acc 0.8981578947368422, AUC 0.9549407958984375, avg_entr 0.003844099584966898
ep44_l4_test_time 0.8600118160247803
gc 0
Train Epoch45 Acc 0.992075 (119049/120000), AUC 0.9969140887260437
ep45_train_time 100.35178637504578
Test Epoch45 layer4 Acc 0.8944736842105263, AUC 0.9483343958854675, avg_entr 0.003230323316529393
ep45_l4_test_time 0.8539397716522217
gc 0
Train Epoch46 Acc 0.9921416666666667 (119057/120000), AUC 0.9968363642692566
ep46_train_time 100.96288657188416
Test Epoch46 layer4 Acc 0.9, AUC 0.9515517950057983, avg_entr 0.00359781039878726
ep46_l4_test_time 0.8462321758270264
gc 0
Train Epoch47 Acc 0.9924166666666666 (119090/120000), AUC 0.9970070123672485
ep47_train_time 101.14906334877014
Test Epoch47 layer4 Acc 0.8963157894736842, AUC 0.9493231177330017, avg_entr 0.004921983927488327
ep47_l4_test_time 0.8612504005432129
gc 0
Train Epoch48 Acc 0.9926416666666666 (119117/120000), AUC 0.9970905184745789
ep48_train_time 100.36583662033081
Test Epoch48 layer4 Acc 0.896578947368421, AUC 0.9513118863105774, avg_entr 0.004249828401952982
ep48_l4_test_time 0.8579771518707275
gc 0
Train Epoch49 Acc 0.9926916666666666 (119123/120000), AUC 0.9971712231636047
ep49_train_time 100.46657156944275
Test Epoch49 layer4 Acc 0.8926315789473684, AUC 0.9513248801231384, avg_entr 0.004379549063742161
ep49_l4_test_time 0.8525190353393555
Best AUC 0.9825189709663391
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 5065.798345088959
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad100//ag_news_lstmal_l5.pt
Test layer4 Acc 0.9163157894736842, AUC 0.9809584021568298, avg_entr 0.041603971272706985
l4_test_time 0.8408894538879395
