total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 58.59278583526611
Start Training
gc 0
Train Epoch0 Acc 0.9051339285714286 (506875/560000), AUC 0.9900884628295898
ep0_train_time 335.71445322036743
Test Epoch0 layer4 Acc 0.9812857142857143, AUC 0.9971207976341248, avg_entr 0.020636793226003647
ep0_l4_test_time 6.068808078765869
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad60//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9849642857142857 (551580/560000), AUC 0.9973368048667908
ep1_train_time 314.1943018436432
Test Epoch1 layer4 Acc 0.9833142857142857, AUC 0.9971785545349121, avg_entr 0.004596794489771128
ep1_l4_test_time 6.037052392959595
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad60//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9869678571428572 (552702/560000), AUC 0.9978713393211365
ep2_train_time 333.0613670349121
Test Epoch2 layer4 Acc 0.9850285714285715, AUC 0.9976465106010437, avg_entr 0.002728097140789032
ep2_l4_test_time 6.030631065368652
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad60//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9884017857142857 (553505/560000), AUC 0.9981194734573364
ep3_train_time 333.17955589294434
Test Epoch3 layer4 Acc 0.9849714285714286, AUC 0.9976806640625, avg_entr 0.002047975081950426
ep3_l4_test_time 6.014416933059692
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad60//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9893928571428572 (554060/560000), AUC 0.9984151124954224
ep4_train_time 333.18351340293884
Test Epoch4 layer4 Acc 0.9852, AUC 0.9979994893074036, avg_entr 0.0015525310300290585
ep4_l4_test_time 6.0459885597229
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad60//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9903375 (554589/560000), AUC 0.9986974000930786
ep5_train_time 315.6797652244568
Test Epoch5 layer4 Acc 0.9858571428571429, AUC 0.9980286955833435, avg_entr 0.0015815425431355834
ep5_l4_test_time 6.001527547836304
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad60//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9909928571428571 (554956/560000), AUC 0.9988983869552612
ep6_train_time 333.08520555496216
Test Epoch6 layer4 Acc 0.9857428571428571, AUC 0.9980586767196655, avg_entr 0.0013705069432035089
ep6_l4_test_time 6.012017726898193
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad60//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9918053571428571 (555411/560000), AUC 0.9989814758300781
ep7_train_time 332.838990688324
Test Epoch7 layer4 Acc 0.9859142857142857, AUC 0.9979416728019714, avg_entr 0.0014034033520147204
ep7_l4_test_time 5.9664976596832275
gc 0
Train Epoch8 Acc 0.9924375 (555765/560000), AUC 0.9990487694740295
ep8_train_time 332.74692487716675
Test Epoch8 layer4 Acc 0.9861714285714286, AUC 0.9977841973304749, avg_entr 0.0011920435354113579
ep8_l4_test_time 5.996129989624023
gc 0
Train Epoch9 Acc 0.9930625 (556115/560000), AUC 0.99906986951828
ep9_train_time 332.7369146347046
Test Epoch9 layer4 Acc 0.9857714285714285, AUC 0.9978241920471191, avg_entr 0.0012184869265183806
ep9_l4_test_time 6.004443883895874
gc 0
Train Epoch10 Acc 0.9936035714285715 (556418/560000), AUC 0.9990976452827454
ep10_train_time 312.05472922325134
Test Epoch10 layer4 Acc 0.9859428571428571, AUC 0.9976993799209595, avg_entr 0.0010908524272963405
ep10_l4_test_time 6.057744026184082
gc 0
Train Epoch11 Acc 0.9941482142857143 (556723/560000), AUC 0.9991114735603333
ep11_train_time 279.7221612930298
Test Epoch11 layer4 Acc 0.9853714285714286, AUC 0.9975191950798035, avg_entr 0.0009521839674562216
ep11_l4_test_time 5.864957809448242
gc 0
Train Epoch12 Acc 0.9946232142857143 (556989/560000), AUC 0.9991427659988403
ep12_train_time 322.46343636512756
Test Epoch12 layer4 Acc 0.9854571428571428, AUC 0.997377872467041, avg_entr 0.0008871503523550928
ep12_l4_test_time 5.93993878364563
gc 0
Train Epoch13 Acc 0.9951339285714286 (557275/560000), AUC 0.9991246461868286
ep13_train_time 323.05919432640076
Test Epoch13 layer4 Acc 0.9851428571428571, AUC 0.9970239996910095, avg_entr 0.0009695187327452004
ep13_l4_test_time 5.842321872711182
gc 0
Train Epoch14 Acc 0.9954660714285715 (557461/560000), AUC 0.9991501569747925
ep14_train_time 322.405202627182
Test Epoch14 layer4 Acc 0.9858, AUC 0.9973099827766418, avg_entr 0.0008931493503041565
ep14_l4_test_time 5.878419399261475
gc 0
Train Epoch15 Acc 0.9958357142857143 (557668/560000), AUC 0.9991676211357117
ep15_train_time 322.8810670375824
Test Epoch15 layer4 Acc 0.9855714285714285, AUC 0.997197687625885, avg_entr 0.0008098757243715227
ep15_l4_test_time 5.857707500457764
gc 0
Train Epoch16 Acc 0.9961285714285715 (557832/560000), AUC 0.9991666674613953
ep16_train_time 305.7238464355469
Test Epoch16 layer4 Acc 0.9857142857142858, AUC 0.9971217513084412, avg_entr 0.0008887663716450334
ep16_l4_test_time 5.827885150909424
gc 0
Train Epoch17 Acc 0.9963642857142857 (557964/560000), AUC 0.9991610646247864
ep17_train_time 322.80982851982117
Test Epoch17 layer4 Acc 0.9851428571428571, AUC 0.9965775609016418, avg_entr 0.0007692453800700605
ep17_l4_test_time 5.907030820846558
gc 0
Train Epoch18 Acc 0.9966517857142857 (558125/560000), AUC 0.9991809725761414
ep18_train_time 322.7430372238159
Test Epoch18 layer4 Acc 0.9847714285714285, AUC 0.9966030716896057, avg_entr 0.0007213400094769895
ep18_l4_test_time 5.873000144958496
gc 0
Train Epoch19 Acc 0.99685 (558236/560000), AUC 0.9991869926452637
ep19_train_time 322.9605185985565
Test Epoch19 layer4 Acc 0.9853428571428572, AUC 0.9965899586677551, avg_entr 0.0007561981328763068
ep19_l4_test_time 5.883619785308838
gc 0
Train Epoch20 Acc 0.9970571428571429 (558352/560000), AUC 0.9992074966430664
ep20_train_time 323.286260843277
Test Epoch20 layer4 Acc 0.9846, AUC 0.9962525367736816, avg_entr 0.0008097525569610298
ep20_l4_test_time 5.939008474349976
gc 0
Train Epoch21 Acc 0.9971875 (558425/560000), AUC 0.9992088675498962
ep21_train_time 306.6262972354889
Test Epoch21 layer4 Acc 0.9849428571428571, AUC 0.9959030151367188, avg_entr 0.0006733090849593282
ep21_l4_test_time 5.838348388671875
gc 0
Train Epoch22 Acc 0.9972892857142858 (558482/560000), AUC 0.9992170929908752
ep22_train_time 323.0948724746704
Test Epoch22 layer4 Acc 0.9848571428571429, AUC 0.9957460761070251, avg_entr 0.0006185675738379359
ep22_l4_test_time 5.927732467651367
gc 0
Train Epoch23 Acc 0.9974446428571428 (558569/560000), AUC 0.9992279410362244
ep23_train_time 322.74115109443665
Test Epoch23 layer4 Acc 0.985, AUC 0.9956621527671814, avg_entr 0.0006112587288953364
ep23_l4_test_time 5.851126432418823
gc 0
Train Epoch24 Acc 0.9975267857142858 (558615/560000), AUC 0.9992531538009644
ep24_train_time 323.225261926651
Test Epoch24 layer4 Acc 0.9847714285714285, AUC 0.9957171082496643, avg_entr 0.0005979063571430743
ep24_l4_test_time 5.861685752868652
gc 0
Train Epoch25 Acc 0.9976285714285714 (558672/560000), AUC 0.9992599487304688
ep25_train_time 322.7367088794708
Test Epoch25 layer4 Acc 0.9846285714285714, AUC 0.9952682852745056, avg_entr 0.0006531511899083853
ep25_l4_test_time 5.880716800689697
gc 0
Train Epoch26 Acc 0.9977285714285714 (558728/560000), AUC 0.9992757439613342
ep26_train_time 306.7395906448364
Test Epoch26 layer4 Acc 0.9850857142857142, AUC 0.9956574440002441, avg_entr 0.0005598608404397964
ep26_l4_test_time 5.830044746398926
gc 0
Train Epoch27 Acc 0.9978089285714286 (558773/560000), AUC 0.9992985129356384
ep27_train_time 323.1277756690979
Test Epoch27 layer4 Acc 0.9848285714285714, AUC 0.9956594109535217, avg_entr 0.0005364490789361298
ep27_l4_test_time 5.8677709102630615
gc 0
Train Epoch28 Acc 0.9978714285714285 (558808/560000), AUC 0.9993075132369995
ep28_train_time 323.35948967933655
Test Epoch28 layer4 Acc 0.9849714285714286, AUC 0.9955237507820129, avg_entr 0.0005791510920971632
ep28_l4_test_time 5.888148069381714
gc 0
Train Epoch29 Acc 0.997925 (558838/560000), AUC 0.9993308782577515
ep29_train_time 323.417204618454
Test Epoch29 layer4 Acc 0.9849714285714286, AUC 0.9955798387527466, avg_entr 0.0005211860407143831
ep29_l4_test_time 5.851865768432617
gc 0
Train Epoch30 Acc 0.9979589285714285 (558857/560000), AUC 0.9993430972099304
ep30_train_time 323.20470213890076
Test Epoch30 layer4 Acc 0.9847714285714285, AUC 0.9953330159187317, avg_entr 0.0005666713113896549
ep30_l4_test_time 5.845464468002319
gc 0
Train Epoch31 Acc 0.9980267857142857 (558895/560000), AUC 0.9993220567703247
ep31_train_time 306.6693522930145
Test Epoch31 layer4 Acc 0.9849428571428571, AUC 0.9953947067260742, avg_entr 0.0005917594535276294
ep31_l4_test_time 5.902521133422852
gc 0
Train Epoch32 Acc 0.9980803571428571 (558925/560000), AUC 0.9993560910224915
ep32_train_time 323.3039541244507
Test Epoch32 layer4 Acc 0.9851428571428571, AUC 0.9955776929855347, avg_entr 0.00040624738903716207
ep32_l4_test_time 5.8703131675720215
gc 0
Train Epoch33 Acc 0.9981535714285714 (558966/560000), AUC 0.9993520379066467
ep33_train_time 323.0925917625427
Test Epoch33 layer4 Acc 0.985, AUC 0.9954010844230652, avg_entr 0.0004677952383644879
ep33_l4_test_time 5.9036171436309814
gc 0
Train Epoch34 Acc 0.9981607142857143 (558970/560000), AUC 0.9993640184402466
ep34_train_time 323.40497612953186
Test Epoch34 layer4 Acc 0.9845714285714285, AUC 0.9950605034828186, avg_entr 0.0005532942595891654
ep34_l4_test_time 5.872109889984131
gc 0
Train Epoch35 Acc 0.9982107142857143 (558998/560000), AUC 0.9993821382522583
ep35_train_time 323.3330018520355
Test Epoch35 layer4 Acc 0.9847142857142858, AUC 0.9950699210166931, avg_entr 0.0006614651065319777
ep35_l4_test_time 5.880913734436035
gc 0
Train Epoch36 Acc 0.9983 (559048/560000), AUC 0.9993845820426941
ep36_train_time 278.9255533218384
Test Epoch36 layer4 Acc 0.9850285714285715, AUC 0.9952016472816467, avg_entr 0.0004261623544152826
ep36_l4_test_time 5.753716230392456
gc 0
Train Epoch37 Acc 0.9983178571428571 (559058/560000), AUC 0.9994046092033386
ep37_train_time 319.8560485839844
Test Epoch37 layer4 Acc 0.9845428571428572, AUC 0.9947603940963745, avg_entr 0.00043979426845908165
ep37_l4_test_time 5.827032566070557
gc 0
Train Epoch38 Acc 0.9983410714285714 (559071/560000), AUC 0.9993933439254761
ep38_train_time 319.782723903656
Test Epoch38 layer4 Acc 0.9849142857142857, AUC 0.9951184988021851, avg_entr 0.00043803357402794063
ep38_l4_test_time 5.781832695007324
gc 0
Train Epoch39 Acc 0.9984 (559104/560000), AUC 0.9994171857833862
ep39_train_time 320.2749834060669
Test Epoch39 layer4 Acc 0.9846571428571429, AUC 0.9949130415916443, avg_entr 0.00047567090950906277
ep39_l4_test_time 5.8483545780181885
gc 0
Train Epoch40 Acc 0.9984375 (559125/560000), AUC 0.9994346499443054
ep40_train_time 319.70433354377747
Test Epoch40 layer4 Acc 0.9846, AUC 0.9948010444641113, avg_entr 0.0005032630870118737
ep40_l4_test_time 5.821285963058472
gc 0
Train Epoch41 Acc 0.9984375 (559125/560000), AUC 0.9994252920150757
ep41_train_time 308.17231130599976
Test Epoch41 layer4 Acc 0.9848, AUC 0.9950180649757385, avg_entr 0.0005535829695872962
ep41_l4_test_time 2.7317681312561035
gc 0
Train Epoch42 Acc 0.9984839285714285 (559151/560000), AUC 0.9994320273399353
ep42_train_time 317.56644654273987
Test Epoch42 layer4 Acc 0.9846571428571429, AUC 0.9945125579833984, avg_entr 0.0005166362388990819
ep42_l4_test_time 5.887996435165405
gc 0
Train Epoch43 Acc 0.9985375 (559181/560000), AUC 0.9994438290596008
ep43_train_time 319.6948273181915
Test Epoch43 layer4 Acc 0.9843142857142857, AUC 0.9944744110107422, avg_entr 0.0005467552691698074
ep43_l4_test_time 5.867068529129028
gc 0
Train Epoch44 Acc 0.9985321428571429 (559178/560000), AUC 0.9994300603866577
ep44_train_time 319.51577138900757
Test Epoch44 layer4 Acc 0.9844285714285714, AUC 0.9947239756584167, avg_entr 0.0004891832359135151
ep44_l4_test_time 5.78514289855957
gc 0
Train Epoch45 Acc 0.9985642857142857 (559196/560000), AUC 0.9994555115699768
ep45_train_time 319.46472573280334
Test Epoch45 layer4 Acc 0.9845428571428572, AUC 0.9947179555892944, avg_entr 0.00047695377725176513
ep45_l4_test_time 5.749318599700928
gc 0
Train Epoch46 Acc 0.9985964285714286 (559214/560000), AUC 0.9994575381278992
ep46_train_time 319.76308250427246
Test Epoch46 layer4 Acc 0.9852285714285715, AUC 0.9948047399520874, avg_entr 0.0004316345730330795
ep46_l4_test_time 5.7778918743133545
gc 0
Train Epoch47 Acc 0.9986410714285714 (559239/560000), AUC 0.9994733929634094
ep47_train_time 302.7997763156891
Test Epoch47 layer4 Acc 0.9845142857142857, AUC 0.9946156740188599, avg_entr 0.0005360965151339769
ep47_l4_test_time 5.859353065490723
gc 0
Train Epoch48 Acc 0.9986446428571428 (559241/560000), AUC 0.9994754195213318
ep48_train_time 319.81987047195435
Test Epoch48 layer4 Acc 0.9848285714285714, AUC 0.9946843981742859, avg_entr 0.0005414515035226941
ep48_l4_test_time 5.808948516845703
gc 0
Train Epoch49 Acc 0.9986785714285714 (559260/560000), AUC 0.9994844794273376
ep49_train_time 319.5756678581238
Test Epoch49 layer4 Acc 0.9840285714285715, AUC 0.9946017861366272, avg_entr 0.0005129973287694156
ep49_l4_test_time 5.738997220993042
Best AUC 0.9980586767196655
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 16274.54752111435
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base_pad60//dbpedia_14_lstmal_l5.pt
Test layer4 Acc 0.9852, AUC 0.9979944229125977, avg_entr 0.0015207229880616069
l4_test_time 5.823586702346802
