total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 20.301987886428833
Start Training
gc 0
Train Epoch0 Acc 0.7281083333333334 (87373/120000), AUC 0.9145727157592773
ep0_train_time 79.9558162689209
Test Epoch0 layer4 Acc 0.9121052631578948, AUC 0.9818815588951111, avg_entr 0.11384404450654984
ep0_l4_test_time 0.6940174102783203
Save ckpt to ckpt/ag_news_lstmal_l5base_pad75//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9253166666666667 (111038/120000), AUC 0.9836366176605225
ep1_train_time 79.549973487854
Test Epoch1 layer4 Acc 0.9207894736842105, AUC 0.9837459325790405, avg_entr 0.05248230695724487
ep1_l4_test_time 0.6986384391784668
Save ckpt to ckpt/ag_news_lstmal_l5base_pad75//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9358 (112296/120000), AUC 0.9877463579177856
ep2_train_time 79.26571297645569
Test Epoch2 layer4 Acc 0.9218421052631579, AUC 0.9839380979537964, avg_entr 0.03863333910703659
ep2_l4_test_time 0.6899669170379639
Save ckpt to ckpt/ag_news_lstmal_l5base_pad75//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9425333333333333 (113104/120000), AUC 0.9900394678115845
ep3_train_time 79.89613556861877
Test Epoch3 layer4 Acc 0.921578947368421, AUC 0.9842268824577332, avg_entr 0.027705971151590347
ep3_l4_test_time 0.6840736865997314
Save ckpt to ckpt/ag_news_lstmal_l5base_pad75//ag_news_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.947275 (113673/120000), AUC 0.9913262128829956
ep4_train_time 79.72764444351196
Test Epoch4 layer4 Acc 0.9202631578947369, AUC 0.9843313097953796, avg_entr 0.024336637929081917
ep4_l4_test_time 0.7060856819152832
Save ckpt to ckpt/ag_news_lstmal_l5base_pad75//ag_news_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9507666666666666 (114092/120000), AUC 0.9923520088195801
ep5_train_time 79.45426654815674
Test Epoch5 layer4 Acc 0.9210526315789473, AUC 0.9835783839225769, avg_entr 0.021092914044857025
ep5_l4_test_time 0.6858818531036377
gc 0
Train Epoch6 Acc 0.9534916666666666 (114419/120000), AUC 0.9928615689277649
ep6_train_time 79.73456692695618
Test Epoch6 layer4 Acc 0.9181578947368421, AUC 0.9833573698997498, avg_entr 0.016365161165595055
ep6_l4_test_time 0.6875827312469482
gc 0
Train Epoch7 Acc 0.9562666666666667 (114752/120000), AUC 0.9934404492378235
ep7_train_time 79.14369201660156
Test Epoch7 layer4 Acc 0.9184210526315789, AUC 0.9818808436393738, avg_entr 0.016690103337168694
ep7_l4_test_time 0.6932711601257324
gc 0
Train Epoch8 Acc 0.9582583333333333 (114991/120000), AUC 0.9939091205596924
ep8_train_time 79.64257764816284
Test Epoch8 layer4 Acc 0.916578947368421, AUC 0.9820781946182251, avg_entr 0.015756972134113312
ep8_l4_test_time 0.6922476291656494
gc 0
Train Epoch9 Acc 0.960325 (115239/120000), AUC 0.9943426847457886
ep9_train_time 79.7891263961792
Test Epoch9 layer4 Acc 0.915, AUC 0.981144905090332, avg_entr 0.01598639413714409
ep9_l4_test_time 0.6909043788909912
gc 0
Train Epoch10 Acc 0.9620583333333333 (115447/120000), AUC 0.9947336912155151
ep10_train_time 79.1920235157013
Test Epoch10 layer4 Acc 0.9110526315789473, AUC 0.9810909628868103, avg_entr 0.01642625592648983
ep10_l4_test_time 0.6916348934173584
gc 0
Train Epoch11 Acc 0.9636416666666666 (115637/120000), AUC 0.994970440864563
ep11_train_time 79.88442325592041
Test Epoch11 layer4 Acc 0.9107894736842105, AUC 0.9807112216949463, avg_entr 0.01512552797794342
ep11_l4_test_time 0.6886875629425049
gc 0
Train Epoch12 Acc 0.9656 (115872/120000), AUC 0.9951932430267334
ep12_train_time 79.83432841300964
Test Epoch12 layer4 Acc 0.9084210526315789, AUC 0.9796079397201538, avg_entr 0.012651781551539898
ep12_l4_test_time 0.6943371295928955
gc 0
Train Epoch13 Acc 0.9671833333333333 (116062/120000), AUC 0.9954572916030884
ep13_train_time 79.30442118644714
Test Epoch13 layer4 Acc 0.9089473684210526, AUC 0.9793027639389038, avg_entr 0.01068677194416523
ep13_l4_test_time 0.6869187355041504
gc 0
Train Epoch14 Acc 0.9688666666666667 (116264/120000), AUC 0.9955786466598511
ep14_train_time 79.87475037574768
Test Epoch14 layer4 Acc 0.9071052631578947, AUC 0.979280948638916, avg_entr 0.010421577841043472
ep14_l4_test_time 0.695892333984375
gc 0
Train Epoch15 Acc 0.97035 (116442/120000), AUC 0.99576735496521
ep15_train_time 79.8076102733612
Test Epoch15 layer4 Acc 0.9068421052631579, AUC 0.9791611433029175, avg_entr 0.00896526500582695
ep15_l4_test_time 0.6810228824615479
gc 0
Train Epoch16 Acc 0.9720333333333333 (116644/120000), AUC 0.9957633018493652
ep16_train_time 79.3736400604248
Test Epoch16 layer4 Acc 0.9068421052631579, AUC 0.9778661727905273, avg_entr 0.00982604268938303
ep16_l4_test_time 0.6858375072479248
gc 0
Train Epoch17 Acc 0.9736666666666667 (116840/120000), AUC 0.9959501028060913
ep17_train_time 79.72708129882812
Test Epoch17 layer4 Acc 0.9047368421052632, AUC 0.9774355292320251, avg_entr 0.008173679001629353
ep17_l4_test_time 0.6792347431182861
gc 0
Train Epoch18 Acc 0.9747583333333333 (116971/120000), AUC 0.9961092472076416
ep18_train_time 79.7556312084198
Test Epoch18 layer4 Acc 0.9031578947368422, AUC 0.9765178561210632, avg_entr 0.0077354200184345245
ep18_l4_test_time 0.6885862350463867
gc 0
Train Epoch19 Acc 0.9761166666666666 (117134/120000), AUC 0.9962269067764282
ep19_train_time 79.3113534450531
Test Epoch19 layer4 Acc 0.9055263157894737, AUC 0.9758745431900024, avg_entr 0.007055632770061493
ep19_l4_test_time 0.6963269710540771
gc 0
Train Epoch20 Acc 0.9775916666666666 (117311/120000), AUC 0.9963756203651428
ep20_train_time 79.83964800834656
Test Epoch20 layer4 Acc 0.9018421052631579, AUC 0.9746622443199158, avg_entr 0.006828238256275654
ep20_l4_test_time 0.7008905410766602
gc 0
Train Epoch21 Acc 0.97885 (117462/120000), AUC 0.9964574575424194
ep21_train_time 79.81457567214966
Test Epoch21 layer4 Acc 0.9010526315789473, AUC 0.9752252101898193, avg_entr 0.007808312773704529
ep21_l4_test_time 0.6962332725524902
gc 0
Train Epoch22 Acc 0.9798416666666667 (117581/120000), AUC 0.9965742826461792
ep22_train_time 79.13377022743225
Test Epoch22 layer4 Acc 0.9018421052631579, AUC 0.9742398262023926, avg_entr 0.00651761656627059
ep22_l4_test_time 0.7096257209777832
gc 0
Train Epoch23 Acc 0.9812416666666667 (117749/120000), AUC 0.9966639280319214
ep23_train_time 79.77853393554688
Test Epoch23 layer4 Acc 0.9007894736842105, AUC 0.9735381007194519, avg_entr 0.006174094043672085
ep23_l4_test_time 0.6760833263397217
gc 0
Train Epoch24 Acc 0.9818333333333333 (117820/120000), AUC 0.996743381023407
ep24_train_time 79.63987183570862
Test Epoch24 layer4 Acc 0.9002631578947369, AUC 0.9716328978538513, avg_entr 0.006919692270457745
ep24_l4_test_time 0.6875913143157959
gc 0
Train Epoch25 Acc 0.9830083333333334 (117961/120000), AUC 0.9967907667160034
ep25_train_time 79.19414329528809
Test Epoch25 layer4 Acc 0.9013157894736842, AUC 0.9735262393951416, avg_entr 0.005580852273851633
ep25_l4_test_time 0.687328577041626
gc 0
Train Epoch26 Acc 0.98395 (118074/120000), AUC 0.9969236254692078
ep26_train_time 79.90677952766418
Test Epoch26 layer4 Acc 0.9, AUC 0.9721928834915161, avg_entr 0.005196862854063511
ep26_l4_test_time 0.6844124794006348
gc 0
Train Epoch27 Acc 0.9848083333333333 (118177/120000), AUC 0.9969707727432251
ep27_train_time 79.83275866508484
Test Epoch27 layer4 Acc 0.8986842105263158, AUC 0.9710299968719482, avg_entr 0.004130475223064423
ep27_l4_test_time 0.684506893157959
gc 0
Train Epoch28 Acc 0.9854583333333333 (118255/120000), AUC 0.9969788789749146
ep28_train_time 79.05002975463867
Test Epoch28 layer4 Acc 0.9023684210526316, AUC 0.9710026383399963, avg_entr 0.005330657120794058
ep28_l4_test_time 0.6866626739501953
gc 0
Train Epoch29 Acc 0.986175 (118341/120000), AUC 0.9970818161964417
ep29_train_time 79.69756174087524
Test Epoch29 layer4 Acc 0.9007894736842105, AUC 0.9692444801330566, avg_entr 0.004459587391465902
ep29_l4_test_time 0.694279670715332
gc 0
Train Epoch30 Acc 0.9868916666666666 (118427/120000), AUC 0.9970782399177551
ep30_train_time 79.66655588150024
Test Epoch30 layer4 Acc 0.8960526315789473, AUC 0.9677205085754395, avg_entr 0.0050232601352036
ep30_l4_test_time 0.6997954845428467
gc 0
Train Epoch31 Acc 0.9872166666666666 (118466/120000), AUC 0.9972572326660156
ep31_train_time 79.23067235946655
Test Epoch31 layer4 Acc 0.8992105263157895, AUC 0.9664187431335449, avg_entr 0.004740417469292879
ep31_l4_test_time 0.6949846744537354
gc 0
Train Epoch32 Acc 0.9877666666666667 (118532/120000), AUC 0.9971951246261597
ep32_train_time 79.54350900650024
Test Epoch32 layer4 Acc 0.896578947368421, AUC 0.9674845933914185, avg_entr 0.0044798715971410275
ep32_l4_test_time 0.6821401119232178
gc 0
Train Epoch33 Acc 0.9882666666666666 (118592/120000), AUC 0.9972309470176697
ep33_train_time 79.71908497810364
Test Epoch33 layer4 Acc 0.9010526315789473, AUC 0.9678686857223511, avg_entr 0.005187980365008116
ep33_l4_test_time 0.698662281036377
gc 0
Train Epoch34 Acc 0.9888 (118656/120000), AUC 0.9972245693206787
ep34_train_time 79.22697162628174
Test Epoch34 layer4 Acc 0.8984210526315789, AUC 0.9654280543327332, avg_entr 0.0036153183318674564
ep34_l4_test_time 0.69584059715271
gc 0
Train Epoch35 Acc 0.9888583333333333 (118663/120000), AUC 0.9972178936004639
ep35_train_time 79.76022911071777
Test Epoch35 layer4 Acc 0.8968421052631579, AUC 0.9630900025367737, avg_entr 0.004204804077744484
ep35_l4_test_time 0.694190263748169
gc 0
Train Epoch36 Acc 0.98925 (118710/120000), AUC 0.9972397685050964
ep36_train_time 79.36178612709045
Test Epoch36 layer4 Acc 0.9005263157894737, AUC 0.9661745429039001, avg_entr 0.0036994696129113436
ep36_l4_test_time 0.6430771350860596
gc 0
Train Epoch37 Acc 0.9895916666666666 (118751/120000), AUC 0.9973701238632202
ep37_train_time 79.64479041099548
Test Epoch37 layer4 Acc 0.8976315789473684, AUC 0.9630470871925354, avg_entr 0.004262683447450399
ep37_l4_test_time 0.6838014125823975
gc 0
Train Epoch38 Acc 0.98985 (118782/120000), AUC 0.997433066368103
ep38_train_time 79.80464029312134
Test Epoch38 layer4 Acc 0.8994736842105263, AUC 0.9650681614875793, avg_entr 0.004736197181046009
ep38_l4_test_time 0.7161135673522949
gc 0
Train Epoch39 Acc 0.9900916666666667 (118811/120000), AUC 0.9974299669265747
ep39_train_time 76.5757577419281
Test Epoch39 layer4 Acc 0.8992105263157895, AUC 0.9626749753952026, avg_entr 0.004037056118249893
ep39_l4_test_time 0.3621513843536377
gc 0
Train Epoch40 Acc 0.9903416666666667 (118841/120000), AUC 0.997464656829834
ep40_train_time 42.46654558181763
Test Epoch40 layer4 Acc 0.8963157894736842, AUC 0.9611855745315552, avg_entr 0.004492080304771662
ep40_l4_test_time 0.3521080017089844
gc 0
Train Epoch41 Acc 0.99075 (118890/120000), AUC 0.997462272644043
ep41_train_time 60.44622445106506
Test Epoch41 layer4 Acc 0.8976315789473684, AUC 0.9638594388961792, avg_entr 0.004527136217802763
ep41_l4_test_time 0.6833314895629883
gc 0
Train Epoch42 Acc 0.9909083333333333 (118909/120000), AUC 0.9975804090499878
ep42_train_time 79.76142907142639
Test Epoch42 layer4 Acc 0.9007894736842105, AUC 0.9612882137298584, avg_entr 0.003691852791234851
ep42_l4_test_time 0.685295820236206
gc 0
Train Epoch43 Acc 0.9909083333333333 (118909/120000), AUC 0.9975759983062744
ep43_train_time 79.780592918396
Test Epoch43 layer4 Acc 0.8997368421052632, AUC 0.959195077419281, avg_entr 0.0038923821412026882
ep43_l4_test_time 0.7042102813720703
gc 0
Train Epoch44 Acc 0.991125 (118935/120000), AUC 0.9975579977035522
ep44_train_time 79.3064866065979
Test Epoch44 layer4 Acc 0.8926315789473684, AUC 0.9626710414886475, avg_entr 0.003986875526607037
ep44_l4_test_time 0.7001144886016846
gc 0
Train Epoch45 Acc 0.991475 (118977/120000), AUC 0.9976723790168762
ep45_train_time 79.75342750549316
Test Epoch45 layer4 Acc 0.8978947368421053, AUC 0.9623010158538818, avg_entr 0.0033761959057301283
ep45_l4_test_time 0.6875874996185303
gc 0
Train Epoch46 Acc 0.9916583333333333 (118999/120000), AUC 0.997795820236206
ep46_train_time 79.69586157798767
Test Epoch46 layer4 Acc 0.8992105263157895, AUC 0.9622955918312073, avg_entr 0.0033384268172085285
ep46_l4_test_time 0.7072200775146484
gc 0
Train Epoch47 Acc 0.991625 (118995/120000), AUC 0.9979013204574585
ep47_train_time 79.36710548400879
Test Epoch47 layer4 Acc 0.8994736842105263, AUC 0.9617026448249817, avg_entr 0.002877704333513975
ep47_l4_test_time 0.6914114952087402
gc 0
Train Epoch48 Acc 0.9919166666666667 (119030/120000), AUC 0.9979152679443359
ep48_train_time 79.882892370224
Test Epoch48 layer4 Acc 0.8994736842105263, AUC 0.9628478288650513, avg_entr 0.0036035976372659206
ep48_l4_test_time 0.6730470657348633
gc 0
Train Epoch49 Acc 0.99225 (119070/120000), AUC 0.9978924989700317
ep49_train_time 79.80692887306213
Test Epoch49 layer4 Acc 0.8947368421052632, AUC 0.9625046253204346, avg_entr 0.003008357249200344
ep49_l4_test_time 0.6878855228424072
Best AUC 0.9843313097953796
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 3958.038379907608
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad75//ag_news_lstmal_l5.pt
Test layer4 Acc 0.91, AUC 0.981155276298523, avg_entr 0.025780538097023964
l4_test_time 0.7049944400787354
