total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.34314274787903
Start Training
gc 0
Train Epoch0 Acc 0.6400916666666666 (76811/120000), AUC 0.8581336736679077
ep0_train_time 21.628570318222046
Test Epoch0 layer4 Acc 0.908157894736842, AUC 0.9783875942230225, avg_entr 0.22861894965171814
ep0_l4_test_time 0.27741551399230957
Save ckpt to ckpt/ag_news_linearal_l5base_pad150//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9189333333333334 (110272/120000), AUC 0.9821474552154541
ep1_train_time 21.231813430786133
Test Epoch1 layer4 Acc 0.9194736842105263, AUC 0.9816206693649292, avg_entr 0.12630249559879303
ep1_l4_test_time 0.26665568351745605
Save ckpt to ckpt/ag_news_linearal_l5base_pad150//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9288083333333333 (111457/120000), AUC 0.9863849878311157
ep2_train_time 21.090012311935425
Test Epoch2 layer4 Acc 0.9226315789473685, AUC 0.9829068183898926, avg_entr 0.0840156078338623
ep2_l4_test_time 0.25805068016052246
Save ckpt to ckpt/ag_news_linearal_l5base_pad150//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.934975 (112197/120000), AUC 0.9886959195137024
ep3_train_time 21.19043469429016
Test Epoch3 layer4 Acc 0.9244736842105263, AUC 0.9826770424842834, avg_entr 0.054265595972537994
ep3_l4_test_time 0.2767930030822754
gc 0
Train Epoch4 Acc 0.9391166666666667 (112694/120000), AUC 0.9900047779083252
ep4_train_time 21.258644342422485
Test Epoch4 layer4 Acc 0.9234210526315789, AUC 0.9838089346885681, avg_entr 0.03857932239770889
ep4_l4_test_time 0.2691528797149658
Save ckpt to ckpt/ag_news_linearal_l5base_pad150//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9417333333333333 (113008/120000), AUC 0.9906113147735596
ep5_train_time 21.19252848625183
Test Epoch5 layer4 Acc 0.9221052631578948, AUC 0.982104480266571, avg_entr 0.029464561492204666
ep5_l4_test_time 0.2551140785217285
gc 0
Train Epoch6 Acc 0.9441333333333334 (113296/120000), AUC 0.991257905960083
ep6_train_time 21.15801501274109
Test Epoch6 layer4 Acc 0.9242105263157895, AUC 0.9808785915374756, avg_entr 0.026650000363588333
ep6_l4_test_time 0.2486705780029297
gc 0
Train Epoch7 Acc 0.9458666666666666 (113504/120000), AUC 0.992019534111023
ep7_train_time 20.652217626571655
Test Epoch7 layer4 Acc 0.9236842105263158, AUC 0.9811206459999084, avg_entr 0.02394779399037361
ep7_l4_test_time 0.2557549476623535
gc 0
Train Epoch8 Acc 0.9481916666666667 (113783/120000), AUC 0.992784857749939
ep8_train_time 21.294857263565063
Test Epoch8 layer4 Acc 0.9205263157894736, AUC 0.9826312065124512, avg_entr 0.023481830954551697
ep8_l4_test_time 0.25292515754699707
gc 0
Train Epoch9 Acc 0.9492666666666667 (113912/120000), AUC 0.9931977987289429
ep9_train_time 21.31227135658264
Test Epoch9 layer4 Acc 0.9231578947368421, AUC 0.9822307825088501, avg_entr 0.019633162766695023
ep9_l4_test_time 0.26932191848754883
gc 0
Train Epoch10 Acc 0.9504666666666667 (114056/120000), AUC 0.9934484958648682
ep10_train_time 21.232187747955322
Test Epoch10 layer4 Acc 0.9236842105263158, AUC 0.9821898341178894, avg_entr 0.020312754437327385
ep10_l4_test_time 0.26377224922180176
gc 0
Train Epoch11 Acc 0.9515 (114180/120000), AUC 0.9937381148338318
ep11_train_time 21.304792404174805
Test Epoch11 layer4 Acc 0.9218421052631579, AUC 0.9822357892990112, avg_entr 0.01662086509168148
ep11_l4_test_time 0.24925565719604492
gc 0
Train Epoch12 Acc 0.951925 (114231/120000), AUC 0.993882417678833
ep12_train_time 21.12929058074951
Test Epoch12 layer4 Acc 0.9197368421052632, AUC 0.9812543392181396, avg_entr 0.01556764729321003
ep12_l4_test_time 0.28311967849731445
gc 0
Train Epoch13 Acc 0.9532916666666666 (114395/120000), AUC 0.994227409362793
ep13_train_time 20.808979988098145
Test Epoch13 layer4 Acc 0.9202631578947369, AUC 0.9810172319412231, avg_entr 0.01633508689701557
ep13_l4_test_time 0.2123427391052246
gc 0
Train Epoch14 Acc 0.9537166666666667 (114446/120000), AUC 0.9943242073059082
ep14_train_time 20.566052198410034
Test Epoch14 layer4 Acc 0.9226315789473685, AUC 0.9799933433532715, avg_entr 0.017004063352942467
ep14_l4_test_time 0.26276063919067383
gc 0
Train Epoch15 Acc 0.9544166666666667 (114530/120000), AUC 0.9943755865097046
ep15_train_time 21.317718267440796
Test Epoch15 layer4 Acc 0.9221052631578948, AUC 0.9811764359474182, avg_entr 0.01431749202311039
ep15_l4_test_time 0.26533007621765137
gc 0
Train Epoch16 Acc 0.9551 (114612/120000), AUC 0.9944802522659302
ep16_train_time 21.265244245529175
Test Epoch16 layer4 Acc 0.9184210526315789, AUC 0.9811776876449585, avg_entr 0.015141064301133156
ep16_l4_test_time 0.25881433486938477
gc 0
Train Epoch17 Acc 0.9555166666666667 (114662/120000), AUC 0.9946193099021912
ep17_train_time 21.359905242919922
Test Epoch17 layer4 Acc 0.9194736842105263, AUC 0.9799978733062744, avg_entr 0.015730954706668854
ep17_l4_test_time 0.2600381374359131
gc 0
Train Epoch18 Acc 0.9561583333333333 (114739/120000), AUC 0.9947364926338196
ep18_train_time 21.18119740486145
Test Epoch18 layer4 Acc 0.9181578947368421, AUC 0.9805439710617065, avg_entr 0.012737045995891094
ep18_l4_test_time 0.2582864761352539
gc 0
Train Epoch19 Acc 0.956425 (114771/120000), AUC 0.9948645234107971
ep19_train_time 21.179043531417847
Test Epoch19 layer4 Acc 0.9181578947368421, AUC 0.9797592759132385, avg_entr 0.012933206744492054
ep19_l4_test_time 0.26235222816467285
gc 0
Train Epoch20 Acc 0.9569083333333334 (114829/120000), AUC 0.9949373006820679
ep20_train_time 20.737744569778442
Test Epoch20 layer4 Acc 0.9202631578947369, AUC 0.9804974794387817, avg_entr 0.012877062894403934
ep20_l4_test_time 0.26355624198913574
gc 0
Train Epoch21 Acc 0.9570083333333333 (114841/120000), AUC 0.9950886964797974
ep21_train_time 21.233632802963257
Test Epoch21 layer4 Acc 0.9189473684210526, AUC 0.9803781509399414, avg_entr 0.012724748812615871
ep21_l4_test_time 0.2495415210723877
gc 0
Train Epoch22 Acc 0.9575666666666667 (114908/120000), AUC 0.995119571685791
ep22_train_time 21.195706605911255
Test Epoch22 layer4 Acc 0.9173684210526316, AUC 0.9796065092086792, avg_entr 0.012083875946700573
ep22_l4_test_time 0.25503087043762207
gc 0
Train Epoch23 Acc 0.9581083333333333 (114973/120000), AUC 0.9952731132507324
ep23_train_time 21.383837461471558
Test Epoch23 layer4 Acc 0.9194736842105263, AUC 0.9798331260681152, avg_entr 0.011880757287144661
ep23_l4_test_time 0.26920580863952637
gc 0
Train Epoch24 Acc 0.9584333333333334 (115012/120000), AUC 0.9952648878097534
ep24_train_time 21.220319271087646
Test Epoch24 layer4 Acc 0.916578947368421, AUC 0.9796639084815979, avg_entr 0.011952830478549004
ep24_l4_test_time 0.2629683017730713
gc 0
Train Epoch25 Acc 0.9586833333333333 (115042/120000), AUC 0.9953676462173462
ep25_train_time 21.22669506072998
Test Epoch25 layer4 Acc 0.9181578947368421, AUC 0.9794279336929321, avg_entr 0.011808992363512516
ep25_l4_test_time 0.265291690826416
gc 0
Train Epoch26 Acc 0.9591583333333333 (115099/120000), AUC 0.995432436466217
ep26_train_time 21.35316491127014
Test Epoch26 layer4 Acc 0.9168421052631579, AUC 0.9791927337646484, avg_entr 0.01152764167636633
ep26_l4_test_time 0.2573564052581787
gc 0
Train Epoch27 Acc 0.9593333333333334 (115120/120000), AUC 0.9954553842544556
ep27_train_time 20.47513198852539
Test Epoch27 layer4 Acc 0.9171052631578948, AUC 0.9798827171325684, avg_entr 0.011398938484489918
ep27_l4_test_time 0.2693519592285156
gc 0
Train Epoch28 Acc 0.9597416666666667 (115169/120000), AUC 0.9955028295516968
ep28_train_time 21.16086196899414
Test Epoch28 layer4 Acc 0.9176315789473685, AUC 0.9784810543060303, avg_entr 0.011954900808632374
ep28_l4_test_time 0.26265430450439453
gc 0
Train Epoch29 Acc 0.9601416666666667 (115217/120000), AUC 0.9955762028694153
ep29_train_time 21.438034772872925
Test Epoch29 layer4 Acc 0.9152631578947369, AUC 0.9777252674102783, avg_entr 0.01066676713526249
ep29_l4_test_time 0.25383973121643066
gc 0
Train Epoch30 Acc 0.9600166666666666 (115202/120000), AUC 0.9956374168395996
ep30_train_time 21.149438858032227
Test Epoch30 layer4 Acc 0.9163157894736842, AUC 0.9789119362831116, avg_entr 0.011095598340034485
ep30_l4_test_time 0.2549889087677002
gc 0
Train Epoch31 Acc 0.9607166666666667 (115286/120000), AUC 0.9956068992614746
ep31_train_time 21.25259757041931
Test Epoch31 layer4 Acc 0.9160526315789473, AUC 0.9785624742507935, avg_entr 0.011153437197208405
ep31_l4_test_time 0.2653474807739258
gc 0
Train Epoch32 Acc 0.9603583333333333 (115243/120000), AUC 0.9956856369972229
ep32_train_time 21.240293264389038
Test Epoch32 layer4 Acc 0.916578947368421, AUC 0.977836012840271, avg_entr 0.011275318451225758
ep32_l4_test_time 0.2607595920562744
gc 0
Train Epoch33 Acc 0.9609833333333333 (115318/120000), AUC 0.9956823587417603
ep33_train_time 20.589949369430542
Test Epoch33 layer4 Acc 0.9157894736842105, AUC 0.9781003594398499, avg_entr 0.011383222416043282
ep33_l4_test_time 0.25393080711364746
gc 0
Train Epoch34 Acc 0.9613416666666666 (115361/120000), AUC 0.9956727623939514
ep34_train_time 21.22664189338684
Test Epoch34 layer4 Acc 0.9171052631578948, AUC 0.9774777889251709, avg_entr 0.01133683230727911
ep34_l4_test_time 0.2605712413787842
gc 0
Train Epoch35 Acc 0.9616583333333333 (115399/120000), AUC 0.9957749247550964
ep35_train_time 21.230138063430786
Test Epoch35 layer4 Acc 0.9160526315789473, AUC 0.9774543046951294, avg_entr 0.011282427236437798
ep35_l4_test_time 0.2518467903137207
gc 0
Train Epoch36 Acc 0.9617916666666667 (115415/120000), AUC 0.9957887530326843
ep36_train_time 21.21047854423523
Test Epoch36 layer4 Acc 0.9147368421052632, AUC 0.9767171144485474, avg_entr 0.010869542136788368
ep36_l4_test_time 0.26360559463500977
gc 0
Train Epoch37 Acc 0.9617333333333333 (115408/120000), AUC 0.9957751631736755
ep37_train_time 21.360256671905518
Test Epoch37 layer4 Acc 0.9186842105263158, AUC 0.9774158596992493, avg_entr 0.011186794377863407
ep37_l4_test_time 0.2660520076751709
gc 0
Train Epoch38 Acc 0.9620916666666667 (115451/120000), AUC 0.9957336187362671
ep38_train_time 21.333756923675537
Test Epoch38 layer4 Acc 0.9171052631578948, AUC 0.9773365259170532, avg_entr 0.01100432500243187
ep38_l4_test_time 0.25746750831604004
gc 0
Train Epoch39 Acc 0.96255 (115506/120000), AUC 0.9957523345947266
ep39_train_time 21.312892198562622
Test Epoch39 layer4 Acc 0.9163157894736842, AUC 0.9775206446647644, avg_entr 0.011396359652280807
ep39_l4_test_time 0.25828981399536133
gc 0
Train Epoch40 Acc 0.9628166666666667 (115538/120000), AUC 0.9958013892173767
ep40_train_time 20.418100357055664
Test Epoch40 layer4 Acc 0.9139473684210526, AUC 0.9767995476722717, avg_entr 0.010988743044435978
ep40_l4_test_time 0.2696237564086914
gc 0
Train Epoch41 Acc 0.9631083333333333 (115573/120000), AUC 0.9957997798919678
ep41_train_time 21.315588235855103
Test Epoch41 layer4 Acc 0.9155263157894736, AUC 0.9767804145812988, avg_entr 0.011646246537566185
ep41_l4_test_time 0.2645280361175537
gc 0
Train Epoch42 Acc 0.9631833333333333 (115582/120000), AUC 0.9957455396652222
ep42_train_time 21.337199211120605
Test Epoch42 layer4 Acc 0.916578947368421, AUC 0.9753453731536865, avg_entr 0.011559026315808296
ep42_l4_test_time 0.2638416290283203
gc 0
Train Epoch43 Acc 0.9631583333333333 (115579/120000), AUC 0.9957369565963745
ep43_train_time 21.181781768798828
Test Epoch43 layer4 Acc 0.9136842105263158, AUC 0.9762759804725647, avg_entr 0.012142649851739407
ep43_l4_test_time 0.26349520683288574
gc 0
Train Epoch44 Acc 0.9634916666666666 (115619/120000), AUC 0.9957951307296753
ep44_train_time 21.30123519897461
Test Epoch44 layer4 Acc 0.916578947368421, AUC 0.9758499264717102, avg_entr 0.01173526979982853
ep44_l4_test_time 0.24152493476867676
gc 0
Train Epoch45 Acc 0.9637583333333334 (115651/120000), AUC 0.9958025217056274
ep45_train_time 21.173274040222168
Test Epoch45 layer4 Acc 0.9128947368421053, AUC 0.97651207447052, avg_entr 0.011526144109666348
ep45_l4_test_time 0.25630998611450195
gc 0
Train Epoch46 Acc 0.963975 (115677/120000), AUC 0.9957529902458191
ep46_train_time 21.30234146118164
Test Epoch46 layer4 Acc 0.9157894736842105, AUC 0.9764545559883118, avg_entr 0.011899007484316826
ep46_l4_test_time 0.2118360996246338
gc 0
Train Epoch47 Acc 0.9643 (115716/120000), AUC 0.9958422780036926
ep47_train_time 20.55783772468567
Test Epoch47 layer4 Acc 0.9147368421052632, AUC 0.9754201173782349, avg_entr 0.011810271069407463
ep47_l4_test_time 0.2847869396209717
gc 0
Train Epoch48 Acc 0.964475 (115737/120000), AUC 0.9957630634307861
ep48_train_time 21.292786598205566
Test Epoch48 layer4 Acc 0.9118421052631579, AUC 0.9758714437484741, avg_entr 0.011690651066601276
ep48_l4_test_time 0.2680354118347168
gc 0
Train Epoch49 Acc 0.9648416666666667 (115781/120000), AUC 0.9957610368728638
ep49_train_time 21.198694705963135
Test Epoch49 layer4 Acc 0.9147368421052632, AUC 0.975327730178833, avg_entr 0.0128013975918293
ep49_l4_test_time 0.2705216407775879
Best AUC 0.9838089346885681
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 1073.7984204292297
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad150//ag_news_linearal_l5.pt
Test layer4 Acc 0.9134210526315789, AUC 0.9809219837188721, avg_entr 0.04246779531240463
l4_test_time 0.2589595317840576
