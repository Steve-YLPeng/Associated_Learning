total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 59.0717077255249
Start Training
gc 0
Train Epoch0 Acc 0.9005839285714285 (504327/560000), AUC 0.9898409843444824
ep0_train_time 342.01023387908936
Test Epoch0 layer4 Acc 0.9814, AUC 0.9984368681907654, avg_entr 0.018400292843580246
ep0_l4_test_time 6.106744050979614
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad40//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9847821428571428 (551478/560000), AUC 0.9978308081626892
ep1_train_time 339.17742228507996
Test Epoch1 layer4 Acc 0.9824857142857143, AUC 0.9984080195426941, avg_entr 0.004524302668869495
ep1_l4_test_time 6.171168327331543
gc 0
Train Epoch2 Acc 0.9868375 (552629/560000), AUC 0.9982544183731079
ep2_train_time 339.5720090866089
Test Epoch2 layer4 Acc 0.9836285714285714, AUC 0.9985747933387756, avg_entr 0.0025230012834072113
ep2_l4_test_time 5.910546541213989
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad40//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9882375 (553413/560000), AUC 0.9985142946243286
ep3_train_time 339.47858333587646
Test Epoch3 layer4 Acc 0.9847714285714285, AUC 0.9987301230430603, avg_entr 0.0019126046681776643
ep3_l4_test_time 6.059595346450806
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad40//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9892857142857143 (554000/560000), AUC 0.9987372159957886
ep4_train_time 334.0648126602173
Test Epoch4 layer4 Acc 0.9852857142857143, AUC 0.9985201954841614, avg_entr 0.0015110584208741784
ep4_l4_test_time 6.394837379455566
gc 0
Train Epoch5 Acc 0.9902767857142857 (554555/560000), AUC 0.9990338683128357
ep5_train_time 353.1015281677246
Test Epoch5 layer4 Acc 0.9856, AUC 0.9987340569496155, avg_entr 0.0014235744019970298
ep5_l4_test_time 6.354406833648682
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad40//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9910839285714286 (555007/560000), AUC 0.9992355704307556
ep6_train_time 353.3012788295746
Test Epoch6 layer4 Acc 0.9858, AUC 0.9987430572509766, avg_entr 0.0014234479749575257
ep6_l4_test_time 6.367198705673218
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad40//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9916892857142857 (555346/560000), AUC 0.9993271231651306
ep7_train_time 353.52556109428406
Test Epoch7 layer4 Acc 0.9857714285714285, AUC 0.9985562562942505, avg_entr 0.0012955653946846724
ep7_l4_test_time 6.341382741928101
gc 0
Train Epoch8 Acc 0.9923125 (555695/560000), AUC 0.9993870854377747
ep8_train_time 344.63467288017273
Test Epoch8 layer4 Acc 0.9862571428571428, AUC 0.998526930809021, avg_entr 0.0010677629616111517
ep8_l4_test_time 6.335149526596069
gc 0
Train Epoch9 Acc 0.9929785714285714 (556068/560000), AUC 0.9994032979011536
ep9_train_time 354.0029511451721
Test Epoch9 layer4 Acc 0.9856, AUC 0.9983000755310059, avg_entr 0.0013072163565084338
ep9_l4_test_time 6.411253452301025
gc 0
Train Epoch10 Acc 0.9935267857142858 (556375/560000), AUC 0.9994341135025024
ep10_train_time 354.1851053237915
Test Epoch10 layer4 Acc 0.9858285714285714, AUC 0.9983129501342773, avg_entr 0.0011498131789267063
ep10_l4_test_time 6.4065093994140625
gc 0
Train Epoch11 Acc 0.9940446428571429 (556665/560000), AUC 0.9994591474533081
ep11_train_time 343.0109007358551
Test Epoch11 layer4 Acc 0.9856857142857143, AUC 0.9982078671455383, avg_entr 0.0009288290748372674
ep11_l4_test_time 6.3527326583862305
gc 0
Train Epoch12 Acc 0.9945357142857143 (556940/560000), AUC 0.9994328618049622
ep12_train_time 354.7364983558655
Test Epoch12 layer4 Acc 0.9854857142857143, AUC 0.9978951215744019, avg_entr 0.0009913956746459007
ep12_l4_test_time 6.39936900138855
gc 0
Train Epoch13 Acc 0.9949946428571429 (557197/560000), AUC 0.999439537525177
ep13_train_time 354.45099902153015
Test Epoch13 layer4 Acc 0.9853428571428572, AUC 0.9980109930038452, avg_entr 0.0009037517011165619
ep13_l4_test_time 6.3276526927948
gc 0
Train Epoch14 Acc 0.9953892857142858 (557418/560000), AUC 0.999453604221344
ep14_train_time 353.93630290031433
Test Epoch14 layer4 Acc 0.9854, AUC 0.9980344176292419, avg_entr 0.0009492413955740631
ep14_l4_test_time 6.311289310455322
gc 0
Train Epoch15 Acc 0.9957696428571429 (557631/560000), AUC 0.9994901418685913
ep15_train_time 353.1185266971588
Test Epoch15 layer4 Acc 0.9848, AUC 0.9976965188980103, avg_entr 0.0010329005308449268
ep15_l4_test_time 6.348490953445435
gc 0
Train Epoch16 Acc 0.9961285714285715 (557832/560000), AUC 0.9994868040084839
ep16_train_time 354.3534562587738
Test Epoch16 layer4 Acc 0.9855428571428572, AUC 0.9979382753372192, avg_entr 0.0007870674016885459
ep16_l4_test_time 6.4105236530303955
gc 0
Train Epoch17 Acc 0.9964232142857142 (557997/560000), AUC 0.9995014071464539
ep17_train_time 357.3839282989502
Test Epoch17 layer4 Acc 0.9850285714285715, AUC 0.9977137446403503, avg_entr 0.000737696944270283
ep17_l4_test_time 6.681238174438477
gc 0
Train Epoch18 Acc 0.9965964285714286 (558094/560000), AUC 0.99950110912323
ep18_train_time 362.7498140335083
Test Epoch18 layer4 Acc 0.9853714285714286, AUC 0.9975988268852234, avg_entr 0.0007825667271390557
ep18_l4_test_time 6.679599285125732
gc 0
Train Epoch19 Acc 0.9968 (558208/560000), AUC 0.9995241165161133
ep19_train_time 373.22310733795166
Test Epoch19 layer4 Acc 0.985, AUC 0.9974852800369263, avg_entr 0.0006449135835282505
ep19_l4_test_time 6.686383008956909
gc 0
Train Epoch20 Acc 0.996975 (558306/560000), AUC 0.9995294809341431
ep20_train_time 374.09824109077454
Test Epoch20 layer4 Acc 0.985, AUC 0.9973114132881165, avg_entr 0.0007866985979489982
ep20_l4_test_time 6.647085905075073
gc 0
Train Epoch21 Acc 0.9971089285714285 (558381/560000), AUC 0.9995349645614624
ep21_train_time 373.9726369380951
Test Epoch21 layer4 Acc 0.9847714285714285, AUC 0.9976164698600769, avg_entr 0.0006902593304403126
ep21_l4_test_time 6.6828813552856445
gc 0
Train Epoch22 Acc 0.997275 (558474/560000), AUC 0.9995631575584412
ep22_train_time 374.9995746612549
Test Epoch22 layer4 Acc 0.9842285714285715, AUC 0.9972881078720093, avg_entr 0.0005903969868086278
ep22_l4_test_time 6.6749184131622314
gc 0
Train Epoch23 Acc 0.9974107142857143 (558550/560000), AUC 0.9995692372322083
ep23_train_time 363.3371524810791
Test Epoch23 layer4 Acc 0.9846571428571429, AUC 0.9973374009132385, avg_entr 0.0007297837291844189
ep23_l4_test_time 6.765076398849487
gc 0
Train Epoch24 Acc 0.9975446428571428 (558625/560000), AUC 0.9995700120925903
ep24_train_time 374.83466625213623
Test Epoch24 layer4 Acc 0.9846571428571429, AUC 0.9970908164978027, avg_entr 0.000762862735427916
ep24_l4_test_time 6.731041193008423
gc 0
Train Epoch25 Acc 0.9975839285714285 (558647/560000), AUC 0.9995750188827515
ep25_train_time 374.5072569847107
Test Epoch25 layer4 Acc 0.9845714285714285, AUC 0.9968775510787964, avg_entr 0.0005414268234744668
ep25_l4_test_time 6.665617942810059
gc 0
Train Epoch26 Acc 0.9977142857142857 (558720/560000), AUC 0.9995886087417603
ep26_train_time 362.60976672172546
Test Epoch26 layer4 Acc 0.9845714285714285, AUC 0.996781051158905, avg_entr 0.0005967222969047725
ep26_l4_test_time 6.695672035217285
gc 0
Train Epoch27 Acc 0.99775 (558740/560000), AUC 0.999567449092865
ep27_train_time 374.5347247123718
Test Epoch27 layer4 Acc 0.9845714285714285, AUC 0.996846616268158, avg_entr 0.0005884431884624064
ep27_l4_test_time 6.714816570281982
gc 0
Train Epoch28 Acc 0.9978267857142857 (558783/560000), AUC 0.9995816349983215
ep28_train_time 374.95246148109436
Test Epoch28 layer4 Acc 0.9841428571428571, AUC 0.9968582391738892, avg_entr 0.0005877448129467666
ep28_l4_test_time 6.73499059677124
gc 0
Train Epoch29 Acc 0.9978732142857143 (558809/560000), AUC 0.9995766878128052
ep29_train_time 375.2790606021881
Test Epoch29 layer4 Acc 0.9838857142857143, AUC 0.996512770652771, avg_entr 0.0006308220326900482
ep29_l4_test_time 6.588292837142944
gc 0
Train Epoch30 Acc 0.9979517857142857 (558853/560000), AUC 0.9995859265327454
ep30_train_time 364.40937781333923
Test Epoch30 layer4 Acc 0.9842857142857143, AUC 0.9966748952865601, avg_entr 0.0005221415776759386
ep30_l4_test_time 6.599802732467651
gc 0
Train Epoch31 Acc 0.9979803571428572 (558869/560000), AUC 0.9995866417884827
ep31_train_time 374.4976284503937
Test Epoch31 layer4 Acc 0.9846857142857143, AUC 0.996369481086731, avg_entr 0.00047678532428108156
ep31_l4_test_time 6.683837413787842
gc 0
Train Epoch32 Acc 0.9980321428571428 (558898/560000), AUC 0.9995681047439575
ep32_train_time 374.5412199497223
Test Epoch32 layer4 Acc 0.9842857142857143, AUC 0.9960764646530151, avg_entr 0.0004165676364209503
ep32_l4_test_time 6.721512317657471
gc 0
Train Epoch33 Acc 0.9980571428571429 (558912/560000), AUC 0.9995540976524353
ep33_train_time 363.69106817245483
Test Epoch33 layer4 Acc 0.9846, AUC 0.9961565732955933, avg_entr 0.0004507149278651923
ep33_l4_test_time 6.723431587219238
gc 0
Train Epoch34 Acc 0.9980714285714286 (558920/560000), AUC 0.9995549321174622
ep34_train_time 375.39907789230347
Test Epoch34 layer4 Acc 0.9846285714285714, AUC 0.9962095618247986, avg_entr 0.0004876996099483222
ep34_l4_test_time 6.637307167053223
gc 0
Train Epoch35 Acc 0.9981321428571429 (558954/560000), AUC 0.9995689988136292
ep35_train_time 373.8334012031555
Test Epoch35 layer4 Acc 0.9844571428571428, AUC 0.9959608316421509, avg_entr 0.0004603757115546614
ep35_l4_test_time 6.632902145385742
gc 0
Train Epoch36 Acc 0.9981553571428572 (558967/560000), AUC 0.9995463490486145
ep36_train_time 374.05814003944397
Test Epoch36 layer4 Acc 0.9847714285714285, AUC 0.9960660338401794, avg_entr 0.0004889143747277558
ep36_l4_test_time 6.767639875411987
gc 0
Train Epoch37 Acc 0.9981571428571429 (558968/560000), AUC 0.9995551705360413
ep37_train_time 363.06013536453247
Test Epoch37 layer4 Acc 0.9844285714285714, AUC 0.9958872199058533, avg_entr 0.00043221574742347
ep37_l4_test_time 6.707216262817383
gc 0
Train Epoch38 Acc 0.9981946428571429 (558989/560000), AUC 0.9995388388633728
ep38_train_time 373.2365918159485
Test Epoch38 layer4 Acc 0.9842571428571428, AUC 0.9959553480148315, avg_entr 0.000580080843064934
ep38_l4_test_time 6.677172422409058
gc 0
Train Epoch39 Acc 0.9982357142857143 (559012/560000), AUC 0.9995586276054382
ep39_train_time 372.70660424232483
Test Epoch39 layer4 Acc 0.9845428571428572, AUC 0.9961159825325012, avg_entr 0.0006521579343825579
ep39_l4_test_time 6.667171239852905
gc 0
Train Epoch40 Acc 0.9982482142857143 (559019/560000), AUC 0.9995697140693665
ep40_train_time 361.5229468345642
Test Epoch40 layer4 Acc 0.9843428571428572, AUC 0.9957590699195862, avg_entr 0.0005285613005980849
ep40_l4_test_time 6.830786943435669
gc 0
Train Epoch41 Acc 0.9982660714285714 (559029/560000), AUC 0.999580442905426
ep41_train_time 251.88644194602966
Test Epoch41 layer4 Acc 0.9839714285714286, AUC 0.9957776665687561, avg_entr 0.0005545648746192455
ep41_l4_test_time 4.042667865753174
gc 0
Train Epoch42 Acc 0.9982910714285714 (559043/560000), AUC 0.999577522277832
ep42_train_time 241.0818853378296
Test Epoch42 layer4 Acc 0.9840571428571429, AUC 0.9956411123275757, avg_entr 0.0003503977204672992
ep42_l4_test_time 4.108001470565796
gc 0
Train Epoch43 Acc 0.9983053571428572 (559051/560000), AUC 0.9995880126953125
ep43_train_time 225.73227500915527
Test Epoch43 layer4 Acc 0.9842857142857143, AUC 0.9959047436714172, avg_entr 0.0004196805239189416
ep43_l4_test_time 4.1475443840026855
gc 0
Train Epoch44 Acc 0.9983446428571429 (559073/560000), AUC 0.9995768666267395
ep44_train_time 241.05324840545654
Test Epoch44 layer4 Acc 0.9836571428571429, AUC 0.9956328272819519, avg_entr 0.0005406106938607991
ep44_l4_test_time 4.091663360595703
gc 0
Train Epoch45 Acc 0.9983375 (559069/560000), AUC 0.999587893486023
ep45_train_time 241.57342147827148
Test Epoch45 layer4 Acc 0.9844857142857143, AUC 0.996273398399353, avg_entr 0.0004963690880686045
ep45_l4_test_time 4.095468521118164
gc 0
Train Epoch46 Acc 0.9983732142857142 (559089/560000), AUC 0.9995875358581543
ep46_train_time 241.494553565979
Test Epoch46 layer4 Acc 0.984, AUC 0.9958887100219727, avg_entr 0.00039799330988898873
ep46_l4_test_time 4.051790475845337
gc 0
Train Epoch47 Acc 0.9983732142857142 (559089/560000), AUC 0.9996028542518616
ep47_train_time 241.42087173461914
Test Epoch47 layer4 Acc 0.9843714285714286, AUC 0.9957596659660339, avg_entr 0.0004891359712928534
ep47_l4_test_time 4.1197803020477295
gc 0
Train Epoch48 Acc 0.9983928571428572 (559100/560000), AUC 0.9995908737182617
ep48_train_time 240.92858147621155
Test Epoch48 layer4 Acc 0.9847142857142858, AUC 0.9960165619850159, avg_entr 0.00045714990119449794
ep48_l4_test_time 4.098636627197266
gc 0
Train Epoch49 Acc 0.9983946428571429 (559101/560000), AUC 0.9996147751808167
ep49_train_time 241.31612014770508
Test Epoch49 layer4 Acc 0.9844285714285714, AUC 0.9958470463752747, avg_entr 0.0005164355970919132
ep49_l4_test_time 4.12925124168396
Best AUC 0.9987430572509766
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 17282.555834293365
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base_pad40//dbpedia_14_lstmal_l5.pt
Test layer4 Acc 0.9862, AUC 0.9987998008728027, avg_entr 0.0015982815530151129
l4_test_time 4.078465700149536
