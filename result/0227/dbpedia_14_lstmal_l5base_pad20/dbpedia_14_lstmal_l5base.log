total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 59.68329930305481
Start Training
gc 0
Train Epoch0 Acc 0.897 (502320/560000), AUC 0.9889262914657593
ep0_train_time 211.36441469192505
Test Epoch0 layer4 Acc 0.9788857142857142, AUC 0.9973124861717224, avg_entr 0.019054118543863297
ep0_l4_test_time 3.8755953311920166
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad20//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9826357142857143 (550276/560000), AUC 0.9972900748252869
ep1_train_time 208.61304330825806
Test Epoch1 layer4 Acc 0.9809714285714286, AUC 0.997308611869812, avg_entr 0.004834397230297327
ep1_l4_test_time 3.813145637512207
gc 0
Train Epoch2 Acc 0.9849571428571429 (551576/560000), AUC 0.9976723790168762
ep2_train_time 208.9315733909607
Test Epoch2 layer4 Acc 0.9824, AUC 0.9978131651878357, avg_entr 0.003066033124923706
ep2_l4_test_time 3.5808520317077637
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad20//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9865160714285715 (552449/560000), AUC 0.9980177283287048
ep3_train_time 209.00762224197388
Test Epoch3 layer4 Acc 0.9827714285714285, AUC 0.9975367784500122, avg_entr 0.0023850626312196255
ep3_l4_test_time 3.8058576583862305
gc 0
Train Epoch4 Acc 0.9877089285714286 (553117/560000), AUC 0.9983083605766296
ep4_train_time 208.56132531166077
Test Epoch4 layer4 Acc 0.9830285714285715, AUC 0.9980652928352356, avg_entr 0.001968465279787779
ep4_l4_test_time 3.852550506591797
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad20//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9886625 (553651/560000), AUC 0.9985944032669067
ep5_train_time 208.9843831062317
Test Epoch5 layer4 Acc 0.9841714285714286, AUC 0.9978498816490173, avg_entr 0.0018094887491315603
ep5_l4_test_time 3.853651762008667
gc 0
Train Epoch6 Acc 0.9896535714285715 (554206/560000), AUC 0.9987474083900452
ep6_train_time 208.9562919139862
Test Epoch6 layer4 Acc 0.9836857142857143, AUC 0.9978724718093872, avg_entr 0.0015272038290277123
ep6_l4_test_time 3.855491876602173
gc 0
Train Epoch7 Acc 0.9903625 (554603/560000), AUC 0.9988689422607422
ep7_train_time 208.56534028053284
Test Epoch7 layer4 Acc 0.9836, AUC 0.9980461001396179, avg_entr 0.0015496460255235434
ep7_l4_test_time 3.7979373931884766
gc 0
Train Epoch8 Acc 0.9911089285714286 (555021/560000), AUC 0.9989150166511536
ep8_train_time 208.28774571418762
Test Epoch8 layer4 Acc 0.9842, AUC 0.9977011680603027, avg_entr 0.0016377586871385574
ep8_l4_test_time 2.2422876358032227
gc 0
Train Epoch9 Acc 0.9918375 (555429/560000), AUC 0.9989002346992493
ep9_train_time 202.151123046875
Test Epoch9 layer4 Acc 0.9839142857142857, AUC 0.9973023533821106, avg_entr 0.0013937598560005426
ep9_l4_test_time 3.829054355621338
gc 0
Train Epoch10 Acc 0.9925607142857142 (555834/560000), AUC 0.9988975524902344
ep10_train_time 208.82674431800842
Test Epoch10 layer4 Acc 0.9840571428571429, AUC 0.9973677396774292, avg_entr 0.0014843344688415527
ep10_l4_test_time 3.7902796268463135
gc 0
Train Epoch11 Acc 0.9931607142857143 (556170/560000), AUC 0.9989351630210876
ep11_train_time 199.48432970046997
Test Epoch11 layer4 Acc 0.9837142857142858, AUC 0.9972695708274841, avg_entr 0.0011563586303964257
ep11_l4_test_time 3.7649688720703125
gc 0
Train Epoch12 Acc 0.9937446428571428 (556497/560000), AUC 0.9989250302314758
ep12_train_time 209.01559329032898
Test Epoch12 layer4 Acc 0.9835142857142857, AUC 0.9968643188476562, avg_entr 0.0011089324252679944
ep12_l4_test_time 3.841111183166504
gc 0
Train Epoch13 Acc 0.9942964285714285 (556806/560000), AUC 0.9989250898361206
ep13_train_time 209.01479864120483
Test Epoch13 layer4 Acc 0.9834857142857143, AUC 0.9968427419662476, avg_entr 0.0010726482141762972
ep13_l4_test_time 3.8220901489257812
gc 0
Train Epoch14 Acc 0.9947107142857143 (557038/560000), AUC 0.9989559054374695
ep14_train_time 208.89236283302307
Test Epoch14 layer4 Acc 0.9832, AUC 0.996744692325592, avg_entr 0.0009038546704687178
ep14_l4_test_time 3.774301767349243
gc 0
Train Epoch15 Acc 0.9951142857142857 (557264/560000), AUC 0.9989765882492065
ep15_train_time 209.4735951423645
Test Epoch15 layer4 Acc 0.9830285714285715, AUC 0.9962657690048218, avg_entr 0.0010328554781153798
ep15_l4_test_time 3.7492904663085938
gc 0
Train Epoch16 Acc 0.9954553571428572 (557455/560000), AUC 0.998988687992096
ep16_train_time 209.29843401908875
Test Epoch16 layer4 Acc 0.9831714285714286, AUC 0.9961312413215637, avg_entr 0.0007832408300600946
ep16_l4_test_time 3.8047211170196533
gc 0
Train Epoch17 Acc 0.9956714285714285 (557576/560000), AUC 0.9990168213844299
ep17_train_time 209.46276235580444
Test Epoch17 layer4 Acc 0.9825714285714285, AUC 0.9964251518249512, avg_entr 0.0010415406432002783
ep17_l4_test_time 3.7724013328552246
gc 0
Train Epoch18 Acc 0.9959696428571428 (557743/560000), AUC 0.9990650415420532
ep18_train_time 209.6584210395813
Test Epoch18 layer4 Acc 0.9825428571428572, AUC 0.996478259563446, avg_entr 0.0008802734664641321
ep18_l4_test_time 3.6252260208129883
gc 0
Train Epoch19 Acc 0.9962053571428572 (557875/560000), AUC 0.9991081953048706
ep19_train_time 209.4410421848297
Test Epoch19 layer4 Acc 0.9815142857142857, AUC 0.9957956671714783, avg_entr 0.0008259435999207199
ep19_l4_test_time 3.772326946258545
gc 0
Train Epoch20 Acc 0.9964214285714286 (557996/560000), AUC 0.9991431832313538
ep20_train_time 209.26814889907837
Test Epoch20 layer4 Acc 0.9821142857142857, AUC 0.9957934617996216, avg_entr 0.0008249817183241248
ep20_l4_test_time 3.7641794681549072
gc 0
Train Epoch21 Acc 0.9965571428571428 (558072/560000), AUC 0.9991474151611328
ep21_train_time 209.67137718200684
Test Epoch21 layer4 Acc 0.9822285714285715, AUC 0.9956520199775696, avg_entr 0.0008485275902785361
ep21_l4_test_time 3.841331720352173
gc 0
Train Epoch22 Acc 0.9967 (558152/560000), AUC 0.9991474151611328
ep22_train_time 209.6207959651947
Test Epoch22 layer4 Acc 0.9822, AUC 0.995154082775116, avg_entr 0.0007076968904584646
ep22_l4_test_time 3.7424750328063965
gc 0
Train Epoch23 Acc 0.9968535714285714 (558238/560000), AUC 0.9991735219955444
ep23_train_time 209.28515887260437
Test Epoch23 layer4 Acc 0.982, AUC 0.9950080513954163, avg_entr 0.0007650236948393285
ep23_l4_test_time 3.81976056098938
gc 0
Train Epoch24 Acc 0.9969857142857143 (558312/560000), AUC 0.9991762042045593
ep24_train_time 209.79589414596558
Test Epoch24 layer4 Acc 0.9816857142857143, AUC 0.9948214888572693, avg_entr 0.0006839287816546857
ep24_l4_test_time 3.7990520000457764
gc 0
Train Epoch25 Acc 0.9970410714285715 (558343/560000), AUC 0.9991921186447144
ep25_train_time 209.36079835891724
Test Epoch25 layer4 Acc 0.9821142857142857, AUC 0.9948206543922424, avg_entr 0.0005323146469891071
ep25_l4_test_time 3.772651195526123
gc 0
Train Epoch26 Acc 0.9971607142857143 (558410/560000), AUC 0.9991942048072815
ep26_train_time 209.258127450943
Test Epoch26 layer4 Acc 0.9814571428571428, AUC 0.9944151043891907, avg_entr 0.0008184868493117392
ep26_l4_test_time 3.7839584350585938
gc 0
Train Epoch27 Acc 0.9972339285714286 (558451/560000), AUC 0.9992356896400452
ep27_train_time 209.9644739627838
Test Epoch27 layer4 Acc 0.9814571428571428, AUC 0.994868278503418, avg_entr 0.0007440090994350612
ep27_l4_test_time 3.6291465759277344
gc 0
Train Epoch28 Acc 0.9972910714285714 (558483/560000), AUC 0.9992566108703613
ep28_train_time 209.44300246238708
Test Epoch28 layer4 Acc 0.9816, AUC 0.9947068095207214, avg_entr 0.0005944651202298701
ep28_l4_test_time 3.844745635986328
gc 0
Train Epoch29 Acc 0.9973625 (558523/560000), AUC 0.999273419380188
ep29_train_time 209.42848777770996
Test Epoch29 layer4 Acc 0.9820857142857143, AUC 0.9945648908615112, avg_entr 0.0006798636168241501
ep29_l4_test_time 3.821991205215454
gc 0
Train Epoch30 Acc 0.9974285714285714 (558560/560000), AUC 0.9993129372596741
ep30_train_time 199.57020211219788
Test Epoch30 layer4 Acc 0.9817142857142858, AUC 0.994844377040863, avg_entr 0.0007428376702591777
ep30_l4_test_time 3.789384126663208
gc 0
Train Epoch31 Acc 0.9974910714285714 (558595/560000), AUC 0.9993240237236023
ep31_train_time 200.79090785980225
Test Epoch31 layer4 Acc 0.9809142857142857, AUC 0.9945036768913269, avg_entr 0.0008043040870688856
ep31_l4_test_time 3.9875125885009766
gc 0
Train Epoch32 Acc 0.9975732142857143 (558641/560000), AUC 0.9993385672569275
ep32_train_time 216.8172299861908
Test Epoch32 layer4 Acc 0.9816571428571429, AUC 0.9945216178894043, avg_entr 0.0006330915493890643
ep32_l4_test_time 4.026794672012329
gc 0
Train Epoch33 Acc 0.9976375 (558677/560000), AUC 0.9993739724159241
ep33_train_time 216.5071029663086
Test Epoch33 layer4 Acc 0.9810571428571428, AUC 0.9942794442176819, avg_entr 0.0007052788278087974
ep33_l4_test_time 4.038531064987183
gc 0
Train Epoch34 Acc 0.9976678571428571 (558694/560000), AUC 0.9993879199028015
ep34_train_time 216.5801396369934
Test Epoch34 layer4 Acc 0.982, AUC 0.9946590662002563, avg_entr 0.000590386101976037
ep34_l4_test_time 3.9909090995788574
gc 0
Train Epoch35 Acc 0.997775 (558754/560000), AUC 0.9994009733200073
ep35_train_time 216.7420313358307
Test Epoch35 layer4 Acc 0.9817714285714285, AUC 0.9944310784339905, avg_entr 0.0005659738671965897
ep35_l4_test_time 3.868906021118164
gc 0
Train Epoch36 Acc 0.9978214285714285 (558780/560000), AUC 0.9994128942489624
ep36_train_time 216.7923014163971
Test Epoch36 layer4 Acc 0.9821142857142857, AUC 0.9945629239082336, avg_entr 0.000555515056475997
ep36_l4_test_time 3.9461073875427246
gc 0
Train Epoch37 Acc 0.9978589285714285 (558801/560000), AUC 0.9994304776191711
ep37_train_time 216.78201746940613
Test Epoch37 layer4 Acc 0.9815428571428572, AUC 0.9945183396339417, avg_entr 0.0005563395679928362
ep37_l4_test_time 3.9836223125457764
gc 0
Train Epoch38 Acc 0.9979321428571428 (558842/560000), AUC 0.9994511604309082
ep38_train_time 216.55674767494202
Test Epoch38 layer4 Acc 0.9824, AUC 0.99432373046875, avg_entr 0.0007353685796260834
ep38_l4_test_time 3.974743604660034
gc 0
Train Epoch39 Acc 0.9979321428571428 (558842/560000), AUC 0.9994443655014038
ep39_train_time 216.94739413261414
Test Epoch39 layer4 Acc 0.9816, AUC 0.9943934679031372, avg_entr 0.0006235747714526951
ep39_l4_test_time 3.9623029232025146
gc 0
Train Epoch40 Acc 0.9979517857142857 (558853/560000), AUC 0.999457836151123
ep40_train_time 216.5585060119629
Test Epoch40 layer4 Acc 0.9818, AUC 0.9945559501647949, avg_entr 0.000658070610370487
ep40_l4_test_time 4.017141580581665
gc 0
Train Epoch41 Acc 0.9980160714285714 (558889/560000), AUC 0.9994646310806274
ep41_train_time 216.57607865333557
Test Epoch41 layer4 Acc 0.9820285714285715, AUC 0.9946089386940002, avg_entr 0.0006348208989948034
ep41_l4_test_time 4.007302522659302
gc 0
Train Epoch42 Acc 0.9980375 (558901/560000), AUC 0.9994684457778931
ep42_train_time 216.5292375087738
Test Epoch42 layer4 Acc 0.9818857142857143, AUC 0.9944291710853577, avg_entr 0.000572801218368113
ep42_l4_test_time 3.9900996685028076
gc 0
Train Epoch43 Acc 0.9980160714285714 (558889/560000), AUC 0.9994630217552185
ep43_train_time 216.91416311264038
Test Epoch43 layer4 Acc 0.9819714285714286, AUC 0.9945006966590881, avg_entr 0.0006394341471605003
ep43_l4_test_time 4.0123984813690186
gc 0
Train Epoch44 Acc 0.9980732142857143 (558921/560000), AUC 0.9994706511497498
ep44_train_time 216.70228934288025
Test Epoch44 layer4 Acc 0.9824857142857143, AUC 0.9944180846214294, avg_entr 0.0006067529902793467
ep44_l4_test_time 4.000226974487305
gc 0
Train Epoch45 Acc 0.9981410714285714 (558959/560000), AUC 0.9994737505912781
ep45_train_time 216.3245952129364
Test Epoch45 layer4 Acc 0.9815428571428572, AUC 0.9944220185279846, avg_entr 0.0007009338587522507
ep45_l4_test_time 3.9802682399749756
gc 0
Train Epoch46 Acc 0.9981464285714285 (558962/560000), AUC 0.9994679689407349
ep46_train_time 207.49375867843628
Test Epoch46 layer4 Acc 0.9818857142857143, AUC 0.9944669008255005, avg_entr 0.0005076302913948894
ep46_l4_test_time 3.937218427658081
gc 0
Train Epoch47 Acc 0.9981482142857143 (558963/560000), AUC 0.9994741082191467
ep47_train_time 216.37131786346436
Test Epoch47 layer4 Acc 0.9816, AUC 0.9946144819259644, avg_entr 0.0005854488117620349
ep47_l4_test_time 4.037137031555176
gc 0
Train Epoch48 Acc 0.9981767857142857 (558979/560000), AUC 0.9994898438453674
ep48_train_time 216.26236534118652
Test Epoch48 layer4 Acc 0.9819714285714286, AUC 0.9942522644996643, avg_entr 0.00045915183727629483
ep48_l4_test_time 3.9909987449645996
gc 0
Train Epoch49 Acc 0.9982125 (558999/560000), AUC 0.9995048642158508
ep49_train_time 207.02624034881592
Test Epoch49 layer4 Acc 0.9818285714285714, AUC 0.9942982792854309, avg_entr 0.0006156646413728595
ep49_l4_test_time 4.047772169113159
Best AUC 0.9980652928352356
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 10736.856741905212
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base_pad20//dbpedia_14_lstmal_l5.pt
Test layer4 Acc 0.9827142857142858, AUC 0.9980591535568237, avg_entr 0.0020288669038563967
l4_test_time 4.011906147003174
