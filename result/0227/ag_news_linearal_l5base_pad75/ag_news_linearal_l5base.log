total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.330817461013794
Start Training
gc 0
Train Epoch0 Acc 0.6820416666666667 (81845/120000), AUC 0.8894248604774475
ep0_train_time 19.84835124015808
Test Epoch0 layer4 Acc 0.9118421052631579, AUC 0.9801144003868103, avg_entr 0.20328958332538605
ep0_l4_test_time 0.20018553733825684
Save ckpt to ckpt/ag_news_linearal_l5base_pad75//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9246583333333334 (110959/120000), AUC 0.9845300316810608
ep1_train_time 18.79830765724182
Test Epoch1 layer4 Acc 0.9184210526315789, AUC 0.9829702377319336, avg_entr 0.11291535198688507
ep1_l4_test_time 0.19977259635925293
Save ckpt to ckpt/ag_news_linearal_l5base_pad75//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9335666666666667 (112028/120000), AUC 0.9882825613021851
ep2_train_time 18.801347970962524
Test Epoch2 layer4 Acc 0.9207894736842105, AUC 0.9834195375442505, avg_entr 0.07329225540161133
ep2_l4_test_time 0.19424104690551758
Save ckpt to ckpt/ag_news_linearal_l5base_pad75//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9396833333333333 (112762/120000), AUC 0.9903720617294312
ep3_train_time 18.786974668502808
Test Epoch3 layer4 Acc 0.9210526315789473, AUC 0.983364999294281, avg_entr 0.04856971651315689
ep3_l4_test_time 0.19852781295776367
gc 0
Train Epoch4 Acc 0.9428166666666666 (113138/120000), AUC 0.9912732243537903
ep4_train_time 18.18520426750183
Test Epoch4 layer4 Acc 0.9234210526315789, AUC 0.980837345123291, avg_entr 0.03470836579799652
ep4_l4_test_time 0.2037365436553955
gc 0
Train Epoch5 Acc 0.9453583333333333 (113443/120000), AUC 0.991762638092041
ep5_train_time 18.541948556900024
Test Epoch5 layer4 Acc 0.9221052631578948, AUC 0.9804180860519409, avg_entr 0.0301191546022892
ep5_l4_test_time 0.20064163208007812
gc 0
Train Epoch6 Acc 0.947175 (113661/120000), AUC 0.9923379421234131
ep6_train_time 18.765604734420776
Test Epoch6 layer4 Acc 0.9213157894736842, AUC 0.9804809093475342, avg_entr 0.026039401069283485
ep6_l4_test_time 0.19626808166503906
gc 0
Train Epoch7 Acc 0.9493583333333333 (113923/120000), AUC 0.9928989410400391
ep7_train_time 18.733302354812622
Test Epoch7 layer4 Acc 0.9223684210526316, AUC 0.9808210134506226, avg_entr 0.02263529784977436
ep7_l4_test_time 0.1945652961730957
gc 0
Train Epoch8 Acc 0.950525 (114063/120000), AUC 0.9934136867523193
ep8_train_time 18.787018060684204
Test Epoch8 layer4 Acc 0.9202631578947369, AUC 0.9816200733184814, avg_entr 0.020256197080016136
ep8_l4_test_time 0.20415306091308594
gc 0
Train Epoch9 Acc 0.9518583333333334 (114223/120000), AUC 0.9938064813613892
ep9_train_time 18.962069511413574
Test Epoch9 layer4 Acc 0.9218421052631579, AUC 0.9814611077308655, avg_entr 0.01969728246331215
ep9_l4_test_time 0.20313501358032227
gc 0
Train Epoch10 Acc 0.952425 (114291/120000), AUC 0.9940775036811829
ep10_train_time 18.7454354763031
Test Epoch10 layer4 Acc 0.9184210526315789, AUC 0.9806199073791504, avg_entr 0.017119530588388443
ep10_l4_test_time 0.20331621170043945
gc 0
Train Epoch11 Acc 0.953725 (114447/120000), AUC 0.9943952560424805
ep11_train_time 18.816067457199097
Test Epoch11 layer4 Acc 0.9186842105263158, AUC 0.980822741985321, avg_entr 0.016876505687832832
ep11_l4_test_time 0.2043442726135254
gc 0
Train Epoch12 Acc 0.9543166666666667 (114518/120000), AUC 0.9945670366287231
ep12_train_time 17.802979946136475
Test Epoch12 layer4 Acc 0.9189473684210526, AUC 0.9808527231216431, avg_entr 0.0166026558727026
ep12_l4_test_time 0.20425152778625488
gc 0
Train Epoch13 Acc 0.9553416666666666 (114641/120000), AUC 0.9947260618209839
ep13_train_time 18.76802682876587
Test Epoch13 layer4 Acc 0.9168421052631579, AUC 0.9809073805809021, avg_entr 0.016887178644537926
ep13_l4_test_time 0.20180726051330566
gc 0
Train Epoch14 Acc 0.955525 (114663/120000), AUC 0.9948751926422119
ep14_train_time 18.84339451789856
Test Epoch14 layer4 Acc 0.9189473684210526, AUC 0.9815089702606201, avg_entr 0.01620660349726677
ep14_l4_test_time 0.19553852081298828
gc 0
Train Epoch15 Acc 0.9563166666666667 (114758/120000), AUC 0.9950134754180908
ep15_train_time 18.78242325782776
Test Epoch15 layer4 Acc 0.9197368421052632, AUC 0.9816309809684753, avg_entr 0.014775742776691914
ep15_l4_test_time 0.20065903663635254
gc 0
Train Epoch16 Acc 0.9565833333333333 (114790/120000), AUC 0.9950037598609924
ep16_train_time 18.869581699371338
Test Epoch16 layer4 Acc 0.9178947368421052, AUC 0.9814481735229492, avg_entr 0.014752307906746864
ep16_l4_test_time 0.2057783603668213
gc 0
Train Epoch17 Acc 0.9569833333333333 (114838/120000), AUC 0.995053231716156
ep17_train_time 18.82575249671936
Test Epoch17 layer4 Acc 0.9181578947368421, AUC 0.9804520606994629, avg_entr 0.014363852329552174
ep17_l4_test_time 0.20655083656311035
gc 0
Train Epoch18 Acc 0.9580916666666667 (114971/120000), AUC 0.9952077865600586
ep18_train_time 18.80979871749878
Test Epoch18 layer4 Acc 0.9192105263157895, AUC 0.9811917543411255, avg_entr 0.01301630400121212
ep18_l4_test_time 0.2117624282836914
gc 0
Train Epoch19 Acc 0.9583416666666666 (115001/120000), AUC 0.995319664478302
ep19_train_time 17.855082035064697
Test Epoch19 layer4 Acc 0.9147368421052632, AUC 0.9808768033981323, avg_entr 0.012716191820800304
ep19_l4_test_time 0.20126938819885254
gc 0
Train Epoch20 Acc 0.9587083333333334 (115045/120000), AUC 0.9954031705856323
ep20_train_time 18.8574378490448
Test Epoch20 layer4 Acc 0.916578947368421, AUC 0.9803917407989502, avg_entr 0.01269115973263979
ep20_l4_test_time 0.2009263038635254
gc 0
Train Epoch21 Acc 0.9593166666666667 (115118/120000), AUC 0.9954906702041626
ep21_train_time 18.77834963798523
Test Epoch21 layer4 Acc 0.9181578947368421, AUC 0.9806916117668152, avg_entr 0.014357583597302437
ep21_l4_test_time 0.2047441005706787
gc 0
Train Epoch22 Acc 0.9596333333333333 (115156/120000), AUC 0.9955140948295593
ep22_train_time 18.963965892791748
Test Epoch22 layer4 Acc 0.9168421052631579, AUC 0.9808307886123657, avg_entr 0.013878980651497841
ep22_l4_test_time 0.197556734085083
gc 0
Train Epoch23 Acc 0.959875 (115185/120000), AUC 0.9956364631652832
ep23_train_time 18.72764778137207
Test Epoch23 layer4 Acc 0.9152631578947369, AUC 0.9803196787834167, avg_entr 0.013520280830562115
ep23_l4_test_time 0.20838451385498047
gc 0
Train Epoch24 Acc 0.9604083333333333 (115249/120000), AUC 0.995722770690918
ep24_train_time 18.887267112731934
Test Epoch24 layer4 Acc 0.9139473684210526, AUC 0.9805788993835449, avg_entr 0.01219258178025484
ep24_l4_test_time 0.21019959449768066
gc 0
Train Epoch25 Acc 0.9608583333333334 (115303/120000), AUC 0.9957144260406494
ep25_train_time 18.82313847541809
Test Epoch25 layer4 Acc 0.9173684210526316, AUC 0.9810492992401123, avg_entr 0.012843630276620388
ep25_l4_test_time 0.20859003067016602
gc 0
Train Epoch26 Acc 0.9615583333333333 (115387/120000), AUC 0.9957418441772461
ep26_train_time 18.755443811416626
Test Epoch26 layer4 Acc 0.9157894736842105, AUC 0.9804671406745911, avg_entr 0.01284207683056593
ep26_l4_test_time 0.20948553085327148
gc 0
Train Epoch27 Acc 0.9617 (115404/120000), AUC 0.9958394169807434
ep27_train_time 17.883630752563477
Test Epoch27 layer4 Acc 0.9163157894736842, AUC 0.9797539114952087, avg_entr 0.012872121296823025
ep27_l4_test_time 0.20951628684997559
gc 0
Train Epoch28 Acc 0.96215 (115458/120000), AUC 0.9958497285842896
ep28_train_time 18.944846868515015
Test Epoch28 layer4 Acc 0.9163157894736842, AUC 0.9796421527862549, avg_entr 0.012133401818573475
ep28_l4_test_time 0.2054586410522461
gc 0
Train Epoch29 Acc 0.9627833333333333 (115534/120000), AUC 0.9959208965301514
ep29_train_time 18.896584272384644
Test Epoch29 layer4 Acc 0.915, AUC 0.9791384935379028, avg_entr 0.01251853909343481
ep29_l4_test_time 0.1908104419708252
gc 0
Train Epoch30 Acc 0.9632583333333333 (115591/120000), AUC 0.995975911617279
ep30_train_time 18.815951347351074
Test Epoch30 layer4 Acc 0.9176315789473685, AUC 0.9794809818267822, avg_entr 0.01272381842136383
ep30_l4_test_time 0.21904587745666504
gc 0
Train Epoch31 Acc 0.9635916666666666 (115631/120000), AUC 0.9959893822669983
ep31_train_time 18.80467963218689
Test Epoch31 layer4 Acc 0.9136842105263158, AUC 0.9788448810577393, avg_entr 0.013454386964440346
ep31_l4_test_time 0.21719050407409668
gc 0
Train Epoch32 Acc 0.9638416666666667 (115661/120000), AUC 0.9960386753082275
ep32_train_time 18.898074626922607
Test Epoch32 layer4 Acc 0.9136842105263158, AUC 0.978099524974823, avg_entr 0.012641509994864464
ep32_l4_test_time 0.20202279090881348
gc 0
Train Epoch33 Acc 0.9645916666666666 (115751/120000), AUC 0.9960812330245972
ep33_train_time 18.795186281204224
Test Epoch33 layer4 Acc 0.9144736842105263, AUC 0.9784234762191772, avg_entr 0.012392750941216946
ep33_l4_test_time 0.2053999900817871
gc 0
Train Epoch34 Acc 0.964825 (115779/120000), AUC 0.9961409568786621
ep34_train_time 17.6677303314209
Test Epoch34 layer4 Acc 0.9144736842105263, AUC 0.9770963191986084, avg_entr 0.013340361416339874
ep34_l4_test_time 0.19652581214904785
gc 0
Train Epoch35 Acc 0.9650666666666666 (115808/120000), AUC 0.9961280226707458
ep35_train_time 18.746165990829468
Test Epoch35 layer4 Acc 0.9134210526315789, AUC 0.9779208898544312, avg_entr 0.013850278221070766
ep35_l4_test_time 0.19379544258117676
gc 0
Train Epoch36 Acc 0.9659083333333334 (115909/120000), AUC 0.9961581826210022
ep36_train_time 18.936384439468384
Test Epoch36 layer4 Acc 0.9144736842105263, AUC 0.9779790639877319, avg_entr 0.013633161783218384
ep36_l4_test_time 0.2049424648284912
gc 0
Train Epoch37 Acc 0.965725 (115887/120000), AUC 0.9962316751480103
ep37_train_time 18.945786237716675
Test Epoch37 layer4 Acc 0.9152631578947369, AUC 0.9771603345870972, avg_entr 0.013207233510911465
ep37_l4_test_time 0.21332812309265137
gc 0
Train Epoch38 Acc 0.9663833333333334 (115966/120000), AUC 0.9963176250457764
ep38_train_time 18.749698638916016
Test Epoch38 layer4 Acc 0.9139473684210526, AUC 0.9770064353942871, avg_entr 0.012078448198735714
ep38_l4_test_time 0.21453547477722168
gc 0
Train Epoch39 Acc 0.9667416666666667 (116009/120000), AUC 0.9962911009788513
ep39_train_time 18.982861280441284
Test Epoch39 layer4 Acc 0.9139473684210526, AUC 0.9771785736083984, avg_entr 0.014254109933972359
ep39_l4_test_time 0.1911602020263672
gc 0
Train Epoch40 Acc 0.9671416666666667 (116057/120000), AUC 0.9963546991348267
ep40_train_time 18.727144241333008
Test Epoch40 layer4 Acc 0.911578947368421, AUC 0.976506233215332, avg_entr 0.012697450816631317
ep40_l4_test_time 0.20260953903198242
gc 0
Train Epoch41 Acc 0.967525 (116103/120000), AUC 0.9963284730911255
ep41_train_time 18.841325044631958
Test Epoch41 layer4 Acc 0.9128947368421053, AUC 0.9765497446060181, avg_entr 0.013274118304252625
ep41_l4_test_time 0.20560145378112793
gc 0
Train Epoch42 Acc 0.967775 (116133/120000), AUC 0.9963799715042114
ep42_train_time 18.07227849960327
Test Epoch42 layer4 Acc 0.9113157894736842, AUC 0.9759148955345154, avg_entr 0.014214182272553444
ep42_l4_test_time 0.20599842071533203
gc 0
Train Epoch43 Acc 0.9684583333333333 (116215/120000), AUC 0.9964533448219299
ep43_train_time 18.8534939289093
Test Epoch43 layer4 Acc 0.9078947368421053, AUC 0.9758548736572266, avg_entr 0.013652407564222813
ep43_l4_test_time 0.21134495735168457
gc 0
Train Epoch44 Acc 0.9689083333333334 (116269/120000), AUC 0.9963699579238892
ep44_train_time 18.730199337005615
Test Epoch44 layer4 Acc 0.9107894736842105, AUC 0.9754810333251953, avg_entr 0.013314301148056984
ep44_l4_test_time 0.19911932945251465
gc 0
Train Epoch45 Acc 0.9691166666666666 (116294/120000), AUC 0.9963976144790649
ep45_train_time 18.989073038101196
Test Epoch45 layer4 Acc 0.9097368421052632, AUC 0.9750601649284363, avg_entr 0.013472341932356358
ep45_l4_test_time 0.19241809844970703
gc 0
Train Epoch46 Acc 0.9694833333333334 (116338/120000), AUC 0.9964920282363892
ep46_train_time 18.84923553466797
Test Epoch46 layer4 Acc 0.9078947368421053, AUC 0.9742358326911926, avg_entr 0.012772106565535069
ep46_l4_test_time 0.2164783477783203
gc 0
Train Epoch47 Acc 0.9699 (116388/120000), AUC 0.9965006113052368
ep47_train_time 18.8121440410614
Test Epoch47 layer4 Acc 0.9078947368421053, AUC 0.9740904569625854, avg_entr 0.014010801911354065
ep47_l4_test_time 0.21154141426086426
gc 0
Train Epoch48 Acc 0.9701916666666667 (116423/120000), AUC 0.9965395927429199
ep48_train_time 18.79266381263733
Test Epoch48 layer4 Acc 0.9060526315789473, AUC 0.973747968673706, avg_entr 0.013971292413771152
ep48_l4_test_time 0.20155572891235352
gc 0
Train Epoch49 Acc 0.9706583333333333 (116479/120000), AUC 0.9966045618057251
ep49_train_time 17.878942012786865
Test Epoch49 layer4 Acc 0.905, AUC 0.9733842015266418, avg_entr 0.012858069501817226
ep49_l4_test_time 0.19562005996704102
Best AUC 0.9834195375442505
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 948.8633642196655
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad75//ag_news_linearal_l5.pt
Test layer4 Acc 0.9118421052631579, AUC 0.9813621044158936, avg_entr 0.07879777252674103
l4_test_time 0.20807552337646484
