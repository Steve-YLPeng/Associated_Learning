total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.432785987854004
Start Training
gc 0
Train Epoch0 Acc 0.6068416666666666 (72821/120000), AUC 0.84260094165802
ep0_train_time 22.93446683883667
Test Epoch0 layer4 Acc 0.9039473684210526, AUC 0.9772014021873474, avg_entr 0.22616522014141083
ep0_l4_test_time 0.25512242317199707
Save ckpt to ckpt/ag_news_linearal_l5base_pad175//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.916775 (110013/120000), AUC 0.9812488555908203
ep1_train_time 21.862159729003906
Test Epoch1 layer4 Acc 0.9173684210526316, AUC 0.9806712865829468, avg_entr 0.1201179251074791
ep1_l4_test_time 0.26176953315734863
Save ckpt to ckpt/ag_news_linearal_l5base_pad175//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9268416666666667 (111221/120000), AUC 0.9855366945266724
ep2_train_time 21.99158215522766
Test Epoch2 layer4 Acc 0.9178947368421052, AUC 0.9819834232330322, avg_entr 0.0842517837882042
ep2_l4_test_time 0.2509331703186035
Save ckpt to ckpt/ag_news_linearal_l5base_pad175//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9326833333333333 (111922/120000), AUC 0.987880289554596
ep3_train_time 21.91183090209961
Test Epoch3 layer4 Acc 0.9244736842105263, AUC 0.981694221496582, avg_entr 0.05140222609043121
ep3_l4_test_time 0.2723352909088135
gc 0
Train Epoch4 Acc 0.9375583333333334 (112507/120000), AUC 0.9891033172607422
ep4_train_time 21.51540780067444
Test Epoch4 layer4 Acc 0.9192105263157895, AUC 0.9826385378837585, avg_entr 0.0378386527299881
ep4_l4_test_time 0.19548845291137695
Save ckpt to ckpt/ag_news_linearal_l5base_pad175//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9402833333333334 (112834/120000), AUC 0.989924430847168
ep5_train_time 21.772191286087036
Test Epoch5 layer4 Acc 0.9218421052631579, AUC 0.9831497073173523, avg_entr 0.029818493872880936
ep5_l4_test_time 0.27599143981933594
Save ckpt to ckpt/ag_news_linearal_l5base_pad175//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9430166666666666 (113162/120000), AUC 0.9909858703613281
ep6_train_time 22.120166301727295
Test Epoch6 layer4 Acc 0.9234210526315789, AUC 0.9826815128326416, avg_entr 0.025089384987950325
ep6_l4_test_time 0.259321928024292
gc 0
Train Epoch7 Acc 0.9448583333333334 (113383/120000), AUC 0.9917831420898438
ep7_train_time 21.953221559524536
Test Epoch7 layer4 Acc 0.9260526315789473, AUC 0.9826358556747437, avg_entr 0.02381628192961216
ep7_l4_test_time 0.2790708541870117
gc 0
Train Epoch8 Acc 0.9468083333333334 (113617/120000), AUC 0.9924262762069702
ep8_train_time 22.014533758163452
Test Epoch8 layer4 Acc 0.9223684210526316, AUC 0.9801263213157654, avg_entr 0.02144058421254158
ep8_l4_test_time 0.26564550399780273
gc 0
Train Epoch9 Acc 0.948125 (113775/120000), AUC 0.992985188961029
ep9_train_time 22.149075031280518
Test Epoch9 layer4 Acc 0.9242105263157895, AUC 0.9822791814804077, avg_entr 0.019655141979455948
ep9_l4_test_time 0.26300930976867676
gc 0
Train Epoch10 Acc 0.9494333333333334 (113932/120000), AUC 0.9933862686157227
ep10_train_time 21.848932027816772
Test Epoch10 layer4 Acc 0.9218421052631579, AUC 0.9825348854064941, avg_entr 0.019216040149331093
ep10_l4_test_time 0.2519564628601074
gc 0
Train Epoch11 Acc 0.9509666666666666 (114116/120000), AUC 0.9937231540679932
ep11_train_time 21.298295974731445
Test Epoch11 layer4 Acc 0.9205263157894736, AUC 0.9812334179878235, avg_entr 0.017878403887152672
ep11_l4_test_time 0.2902810573577881
gc 0
Train Epoch12 Acc 0.951625 (114195/120000), AUC 0.9939424991607666
ep12_train_time 22.03948736190796
Test Epoch12 layer4 Acc 0.9207894736842105, AUC 0.9794756174087524, avg_entr 0.016003279015421867
ep12_l4_test_time 0.2550375461578369
gc 0
Train Epoch13 Acc 0.9526833333333333 (114322/120000), AUC 0.9940218925476074
ep13_train_time 21.896971702575684
Test Epoch13 layer4 Acc 0.9207894736842105, AUC 0.981224536895752, avg_entr 0.01609383523464203
ep13_l4_test_time 0.28038954734802246
gc 0
Train Epoch14 Acc 0.9531083333333333 (114373/120000), AUC 0.9943215847015381
ep14_train_time 22.007994174957275
Test Epoch14 layer4 Acc 0.9192105263157895, AUC 0.9813485741615295, avg_entr 0.015845615416765213
ep14_l4_test_time 0.26830148696899414
gc 0
Train Epoch15 Acc 0.9541666666666667 (114500/120000), AUC 0.9944496154785156
ep15_train_time 21.920409679412842
Test Epoch15 layer4 Acc 0.921578947368421, AUC 0.9802621603012085, avg_entr 0.013697663322091103
ep15_l4_test_time 0.2751185894012451
gc 0
Train Epoch16 Acc 0.9549666666666666 (114596/120000), AUC 0.9945234656333923
ep16_train_time 21.925796031951904
Test Epoch16 layer4 Acc 0.9207894736842105, AUC 0.9805414080619812, avg_entr 0.013607291504740715
ep16_l4_test_time 0.26244258880615234
gc 0
Train Epoch17 Acc 0.9553166666666667 (114638/120000), AUC 0.9946557283401489
ep17_train_time 21.191675901412964
Test Epoch17 layer4 Acc 0.9207894736842105, AUC 0.9815990328788757, avg_entr 0.012469984591007233
ep17_l4_test_time 0.2654709815979004
gc 0
Train Epoch18 Acc 0.9558583333333334 (114703/120000), AUC 0.9948099255561829
ep18_train_time 22.057149171829224
Test Epoch18 layer4 Acc 0.92, AUC 0.9804234504699707, avg_entr 0.013166865333914757
ep18_l4_test_time 0.2587547302246094
gc 0
Train Epoch19 Acc 0.9567 (114804/120000), AUC 0.9950039386749268
ep19_train_time 21.98939609527588
Test Epoch19 layer4 Acc 0.9197368421052632, AUC 0.9801404476165771, avg_entr 0.012136470526456833
ep19_l4_test_time 0.2608962059020996
gc 0
Train Epoch20 Acc 0.9570583333333333 (114847/120000), AUC 0.9949405193328857
ep20_train_time 22.031143188476562
Test Epoch20 layer4 Acc 0.9184210526315789, AUC 0.9796697497367859, avg_entr 0.012349364347755909
ep20_l4_test_time 0.27938079833984375
gc 0
Train Epoch21 Acc 0.9575166666666667 (114902/120000), AUC 0.9951469302177429
ep21_train_time 22.014761447906494
Test Epoch21 layer4 Acc 0.9181578947368421, AUC 0.9794346690177917, avg_entr 0.012447121553122997
ep21_l4_test_time 0.2717723846435547
gc 0
Train Epoch22 Acc 0.9580166666666666 (114962/120000), AUC 0.9951655864715576
ep22_train_time 22.03415536880493
Test Epoch22 layer4 Acc 0.9176315789473685, AUC 0.9807854890823364, avg_entr 0.012300676666200161
ep22_l4_test_time 0.2666890621185303
gc 0
Train Epoch23 Acc 0.95835 (115002/120000), AUC 0.995241641998291
ep23_train_time 21.86522150039673
Test Epoch23 layer4 Acc 0.9173684210526316, AUC 0.9800488352775574, avg_entr 0.011690376326441765
ep23_l4_test_time 0.27472734451293945
gc 0
Train Epoch24 Acc 0.9588333333333333 (115060/120000), AUC 0.9952912330627441
ep24_train_time 21.18114447593689
Test Epoch24 layer4 Acc 0.9176315789473685, AUC 0.9794092774391174, avg_entr 0.013259412720799446
ep24_l4_test_time 0.28029704093933105
gc 0
Train Epoch25 Acc 0.959125 (115095/120000), AUC 0.9954344034194946
ep25_train_time 21.940363883972168
Test Epoch25 layer4 Acc 0.9171052631578948, AUC 0.9803410768508911, avg_entr 0.013157731853425503
ep25_l4_test_time 0.25991201400756836
gc 0
Train Epoch26 Acc 0.959625 (115155/120000), AUC 0.9954828023910522
ep26_train_time 21.957817554473877
Test Epoch26 layer4 Acc 0.9181578947368421, AUC 0.9794052839279175, avg_entr 0.012231720611453056
ep26_l4_test_time 0.277604341506958
gc 0
Train Epoch27 Acc 0.95995 (115194/120000), AUC 0.9955210089683533
ep27_train_time 21.968207120895386
Test Epoch27 layer4 Acc 0.9173684210526316, AUC 0.9794299006462097, avg_entr 0.012137784622609615
ep27_l4_test_time 0.2777421474456787
gc 0
Train Epoch28 Acc 0.96015 (115218/120000), AUC 0.9956344962120056
ep28_train_time 22.007395029067993
Test Epoch28 layer4 Acc 0.9184210526315789, AUC 0.9790743589401245, avg_entr 0.011468179523944855
ep28_l4_test_time 0.2580864429473877
gc 0
Train Epoch29 Acc 0.9603166666666667 (115238/120000), AUC 0.9956920146942139
ep29_train_time 22.05128240585327
Test Epoch29 layer4 Acc 0.9184210526315789, AUC 0.9795664548873901, avg_entr 0.012759940698742867
ep29_l4_test_time 0.25807738304138184
gc 0
Train Epoch30 Acc 0.9609916666666667 (115319/120000), AUC 0.9956920146942139
ep30_train_time 21.378254652023315
Test Epoch30 layer4 Acc 0.9163157894736842, AUC 0.9787105917930603, avg_entr 0.01133691892027855
ep30_l4_test_time 0.28224921226501465
gc 0
Train Epoch31 Acc 0.96115 (115338/120000), AUC 0.9957775473594666
ep31_train_time 21.931538343429565
Test Epoch31 layer4 Acc 0.9155263157894736, AUC 0.9784576296806335, avg_entr 0.01261956337839365
ep31_l4_test_time 0.2602107524871826
gc 0
Train Epoch32 Acc 0.9615833333333333 (115390/120000), AUC 0.9957514405250549
ep32_train_time 22.015547275543213
Test Epoch32 layer4 Acc 0.9160526315789473, AUC 0.9794699549674988, avg_entr 0.011821498163044453
ep32_l4_test_time 0.2699718475341797
gc 0
Train Epoch33 Acc 0.9618083333333334 (115417/120000), AUC 0.9958399534225464
ep33_train_time 22.061863660812378
Test Epoch33 layer4 Acc 0.916578947368421, AUC 0.9772341251373291, avg_entr 0.012200984172523022
ep33_l4_test_time 0.27889418601989746
gc 0
Train Epoch34 Acc 0.9622416666666667 (115469/120000), AUC 0.995855450630188
ep34_train_time 22.016133308410645
Test Epoch34 layer4 Acc 0.915, AUC 0.9787253737449646, avg_entr 0.010820223018527031
ep34_l4_test_time 0.2638366222381592
gc 0
Train Epoch35 Acc 0.9622666666666667 (115472/120000), AUC 0.9959143400192261
ep35_train_time 21.91879367828369
Test Epoch35 layer4 Acc 0.9171052631578948, AUC 0.9780956506729126, avg_entr 0.012737367302179337
ep35_l4_test_time 0.27466654777526855
gc 0
Train Epoch36 Acc 0.96235 (115482/120000), AUC 0.9959530234336853
ep36_train_time 21.591188430786133
Test Epoch36 layer4 Acc 0.9157894736842105, AUC 0.9779112935066223, avg_entr 0.012141070328652859
ep36_l4_test_time 0.1981821060180664
gc 0
Train Epoch37 Acc 0.9630833333333333 (115570/120000), AUC 0.9959836602210999
ep37_train_time 21.899569511413574
Test Epoch37 layer4 Acc 0.9155263157894736, AUC 0.9788821935653687, avg_entr 0.011599884368479252
ep37_l4_test_time 0.26366662979125977
gc 0
Train Epoch38 Acc 0.9631166666666666 (115574/120000), AUC 0.9959903955459595
ep38_train_time 22.131351470947266
Test Epoch38 layer4 Acc 0.9139473684210526, AUC 0.9783346056938171, avg_entr 0.012118050828576088
ep38_l4_test_time 0.26863574981689453
gc 0
Train Epoch39 Acc 0.963775 (115653/120000), AUC 0.9960418343544006
ep39_train_time 22.114580392837524
Test Epoch39 layer4 Acc 0.9142105263157895, AUC 0.9783707857131958, avg_entr 0.012125097215175629
ep39_l4_test_time 0.2677476406097412
gc 0
Train Epoch40 Acc 0.9636583333333333 (115639/120000), AUC 0.9960461854934692
ep40_train_time 21.911532640457153
Test Epoch40 layer4 Acc 0.9168421052631579, AUC 0.9782516360282898, avg_entr 0.012296967208385468
ep40_l4_test_time 0.279918909072876
gc 0
Train Epoch41 Acc 0.9641416666666667 (115697/120000), AUC 0.9960799813270569
ep41_train_time 22.06377935409546
Test Epoch41 layer4 Acc 0.9147368421052632, AUC 0.9779490232467651, avg_entr 0.011807038448750973
ep41_l4_test_time 0.27057909965515137
gc 0
Train Epoch42 Acc 0.9643 (115716/120000), AUC 0.9961315393447876
ep42_train_time 22.044872522354126
Test Epoch42 layer4 Acc 0.9147368421052632, AUC 0.9781484603881836, avg_entr 0.011837842874228954
ep42_l4_test_time 0.25699377059936523
gc 0
Train Epoch43 Acc 0.9645083333333333 (115741/120000), AUC 0.9961579442024231
ep43_train_time 21.246641874313354
Test Epoch43 layer4 Acc 0.915, AUC 0.97722327709198, avg_entr 0.011435486376285553
ep43_l4_test_time 0.2561159133911133
gc 0
Train Epoch44 Acc 0.9649666666666666 (115796/120000), AUC 0.9961366653442383
ep44_train_time 21.815974950790405
Test Epoch44 layer4 Acc 0.9131578947368421, AUC 0.9772452116012573, avg_entr 0.011856979690492153
ep44_l4_test_time 0.26343870162963867
gc 0
Train Epoch45 Acc 0.9654 (115848/120000), AUC 0.9961345791816711
ep45_train_time 21.928073406219482
Test Epoch45 layer4 Acc 0.9128947368421053, AUC 0.9769384860992432, avg_entr 0.012602581642568111
ep45_l4_test_time 0.2597355842590332
gc 0
Train Epoch46 Acc 0.9652083333333333 (115825/120000), AUC 0.9961027503013611
ep46_train_time 22.171991109848022
Test Epoch46 layer4 Acc 0.9134210526315789, AUC 0.977771520614624, avg_entr 0.012775834649801254
ep46_l4_test_time 0.2691993713378906
gc 0
Train Epoch47 Acc 0.965775 (115893/120000), AUC 0.9961772561073303
ep47_train_time 22.147124767303467
Test Epoch47 layer4 Acc 0.9128947368421053, AUC 0.976457953453064, avg_entr 0.012844271957874298
ep47_l4_test_time 0.27114081382751465
gc 0
Train Epoch48 Acc 0.9659166666666666 (115910/120000), AUC 0.9961140751838684
ep48_train_time 22.046526432037354
Test Epoch48 layer4 Acc 0.9126315789473685, AUC 0.9769425988197327, avg_entr 0.012483054772019386
ep48_l4_test_time 0.2664022445678711
gc 0
Train Epoch49 Acc 0.9665166666666667 (115982/120000), AUC 0.9961559772491455
ep49_train_time 21.341232538223267
Test Epoch49 layer4 Acc 0.9113157894736842, AUC 0.9763078689575195, avg_entr 0.011625629849731922
ep49_l4_test_time 0.2537219524383545
Best AUC 0.9831497073173523
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 1111.5459237098694
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad175//ag_news_linearal_l5.pt
Test layer4 Acc 0.9136842105263158, AUC 0.9807941913604736, avg_entr 0.03366131708025932
l4_test_time 0.24511313438415527
