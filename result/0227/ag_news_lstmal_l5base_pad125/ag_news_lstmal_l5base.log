total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 24.08521604537964
Start Training
gc 0
Train Epoch0 Acc 0.7086166666666667 (85034/120000), AUC 0.9026718735694885
ep0_train_time 165.05704021453857
Test Epoch0 layer4 Acc 0.9044736842105263, AUC 0.9783614873886108, avg_entr 0.10645140707492828
ep0_l4_test_time 1.459235429763794
Save ckpt to ckpt/ag_news_lstmal_l5base_pad125//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.92205 (110646/120000), AUC 0.9809564352035522
ep1_train_time 164.24983882904053
Test Epoch1 layer4 Acc 0.9197368421052632, AUC 0.9808946847915649, avg_entr 0.053757887333631516
ep1_l4_test_time 1.4707438945770264
Save ckpt to ckpt/ag_news_lstmal_l5base_pad125//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.93355 (112026/120000), AUC 0.9857504963874817
ep2_train_time 165.00713396072388
Test Epoch2 layer4 Acc 0.9223684210526316, AUC 0.9830079078674316, avg_entr 0.03381757065653801
ep2_l4_test_time 1.4673664569854736
Save ckpt to ckpt/ag_news_lstmal_l5base_pad125//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9404083333333333 (112849/120000), AUC 0.98835688829422
ep3_train_time 164.23173236846924
Test Epoch3 layer4 Acc 0.92, AUC 0.9803383350372314, avg_entr 0.026145603507757187
ep3_l4_test_time 1.4651925563812256
gc 0
Train Epoch4 Acc 0.9453416666666666 (113441/120000), AUC 0.9899818897247314
ep4_train_time 164.829740524292
Test Epoch4 layer4 Acc 0.9221052631578948, AUC 0.981873095035553, avg_entr 0.023643482476472855
ep4_l4_test_time 1.4549851417541504
gc 0
Train Epoch5 Acc 0.94895 (113874/120000), AUC 0.9910786151885986
ep5_train_time 156.29124212265015
Test Epoch5 layer4 Acc 0.9192105263157895, AUC 0.9814505577087402, avg_entr 0.019386932253837585
ep5_l4_test_time 1.064206600189209
gc 0
Train Epoch6 Acc 0.9517833333333333 (114214/120000), AUC 0.991750955581665
ep6_train_time 120.87174034118652
Test Epoch6 layer4 Acc 0.9186842105263158, AUC 0.9820566177368164, avg_entr 0.01985201984643936
ep6_l4_test_time 1.0714225769042969
gc 0
Train Epoch7 Acc 0.954425 (114531/120000), AUC 0.9926015138626099
ep7_train_time 120.3576283454895
Test Epoch7 layer4 Acc 0.9157894736842105, AUC 0.9802868366241455, avg_entr 0.01726013980805874
ep7_l4_test_time 1.0701162815093994
gc 0
Train Epoch8 Acc 0.9564666666666667 (114776/120000), AUC 0.993093729019165
ep8_train_time 120.84381937980652
Test Epoch8 layer4 Acc 0.9192105263157895, AUC 0.9792011976242065, avg_entr 0.016532428562641144
ep8_l4_test_time 1.071951150894165
gc 0
Train Epoch9 Acc 0.9583666666666667 (115004/120000), AUC 0.9933676719665527
ep9_train_time 120.29958629608154
Test Epoch9 layer4 Acc 0.9176315789473685, AUC 0.9795598983764648, avg_entr 0.014202207326889038
ep9_l4_test_time 1.0574836730957031
gc 0
Train Epoch10 Acc 0.960375 (115245/120000), AUC 0.993537962436676
ep10_train_time 120.84881711006165
Test Epoch10 layer4 Acc 0.9139473684210526, AUC 0.9781254529953003, avg_entr 0.013671294786036015
ep10_l4_test_time 1.0794849395751953
gc 0
Train Epoch11 Acc 0.9621833333333333 (115462/120000), AUC 0.9937167763710022
ep11_train_time 120.25645327568054
Test Epoch11 layer4 Acc 0.9152631578947369, AUC 0.9782079458236694, avg_entr 0.012607831507921219
ep11_l4_test_time 1.0975019931793213
gc 0
Train Epoch12 Acc 0.9642583333333333 (115711/120000), AUC 0.9938333630561829
ep12_train_time 120.9156243801117
Test Epoch12 layer4 Acc 0.9144736842105263, AUC 0.9769637584686279, avg_entr 0.013798528350889683
ep12_l4_test_time 1.0478992462158203
gc 0
Train Epoch13 Acc 0.96545 (115854/120000), AUC 0.9940075874328613
ep13_train_time 120.41545510292053
Test Epoch13 layer4 Acc 0.9121052631578948, AUC 0.9754641056060791, avg_entr 0.013673313893377781
ep13_l4_test_time 1.0745084285736084
gc 0
Train Epoch14 Acc 0.967475 (116097/120000), AUC 0.9939383864402771
ep14_train_time 120.92877960205078
Test Epoch14 layer4 Acc 0.9113157894736842, AUC 0.9747205972671509, avg_entr 0.010098574683070183
ep14_l4_test_time 1.0668761730194092
gc 0
Train Epoch15 Acc 0.9689083333333334 (116269/120000), AUC 0.993969738483429
ep15_train_time 120.35403656959534
Test Epoch15 layer4 Acc 0.9071052631578947, AUC 0.9742459654808044, avg_entr 0.009124673902988434
ep15_l4_test_time 1.058434247970581
gc 0
Train Epoch16 Acc 0.9704416666666666 (116453/120000), AUC 0.9939954280853271
ep16_train_time 120.85081958770752
Test Epoch16 layer4 Acc 0.9102631578947369, AUC 0.9736065864562988, avg_entr 0.009546446613967419
ep16_l4_test_time 1.0725460052490234
gc 0
Train Epoch17 Acc 0.972 (116640/120000), AUC 0.9942659139633179
ep17_train_time 120.1486463546753
Test Epoch17 layer4 Acc 0.9076315789473685, AUC 0.9720667004585266, avg_entr 0.010013589635491371
ep17_l4_test_time 1.055584192276001
gc 0
Train Epoch18 Acc 0.9734166666666667 (116810/120000), AUC 0.9942981004714966
ep18_train_time 120.88056468963623
Test Epoch18 layer4 Acc 0.9055263157894737, AUC 0.971217155456543, avg_entr 0.008368784561753273
ep18_l4_test_time 1.0539917945861816
gc 0
Train Epoch19 Acc 0.9753083333333333 (117037/120000), AUC 0.9946896433830261
ep19_train_time 120.42490458488464
Test Epoch19 layer4 Acc 0.9055263157894737, AUC 0.9711658954620361, avg_entr 0.009027816355228424
ep19_l4_test_time 1.0631585121154785
gc 0
Train Epoch20 Acc 0.9765583333333333 (117187/120000), AUC 0.99479740858078
ep20_train_time 120.67771434783936
Test Epoch20 layer4 Acc 0.9047368421052632, AUC 0.9705236554145813, avg_entr 0.007309397682547569
ep20_l4_test_time 1.0280675888061523
gc 0
Train Epoch21 Acc 0.978175 (117381/120000), AUC 0.9949238896369934
ep21_train_time 120.26961994171143
Test Epoch21 layer4 Acc 0.9034210526315789, AUC 0.970649778842926, avg_entr 0.007523471489548683
ep21_l4_test_time 1.0454034805297852
gc 0
Train Epoch22 Acc 0.9794 (117528/120000), AUC 0.9951572418212891
ep22_train_time 120.84812879562378
Test Epoch22 layer4 Acc 0.9026315789473685, AUC 0.9677572250366211, avg_entr 0.006505812983959913
ep22_l4_test_time 1.081360101699829
gc 0
Train Epoch23 Acc 0.9807666666666667 (117692/120000), AUC 0.9951809048652649
ep23_train_time 120.22490501403809
Test Epoch23 layer4 Acc 0.9047368421052632, AUC 0.9685500860214233, avg_entr 0.00598723441362381
ep23_l4_test_time 1.0890233516693115
gc 0
Train Epoch24 Acc 0.9818333333333333 (117820/120000), AUC 0.995416522026062
ep24_train_time 120.93316268920898
Test Epoch24 layer4 Acc 0.9028947368421053, AUC 0.9678109884262085, avg_entr 0.006517763715237379
ep24_l4_test_time 1.07590651512146
gc 0
Train Epoch25 Acc 0.983125 (117975/120000), AUC 0.99549400806427
ep25_train_time 120.09529209136963
Test Epoch25 layer4 Acc 0.9013157894736842, AUC 0.9660773277282715, avg_entr 0.0063196332193911076
ep25_l4_test_time 1.0634393692016602
gc 0
Train Epoch26 Acc 0.9841916666666667 (118103/120000), AUC 0.9956616163253784
ep26_train_time 120.68933010101318
Test Epoch26 layer4 Acc 0.9026315789473685, AUC 0.9641842842102051, avg_entr 0.005052823107689619
ep26_l4_test_time 1.06813383102417
gc 0
Train Epoch27 Acc 0.9850083333333334 (118201/120000), AUC 0.9957300424575806
ep27_train_time 120.29580760002136
Test Epoch27 layer4 Acc 0.9047368421052632, AUC 0.9642108678817749, avg_entr 0.005143227521330118
ep27_l4_test_time 1.0574543476104736
gc 0
Train Epoch28 Acc 0.985775 (118293/120000), AUC 0.9958071708679199
ep28_train_time 121.04592514038086
Test Epoch28 layer4 Acc 0.901578947368421, AUC 0.9620144963264465, avg_entr 0.005568573251366615
ep28_l4_test_time 1.0560765266418457
gc 0
Train Epoch29 Acc 0.9865583333333333 (118387/120000), AUC 0.9958263635635376
ep29_train_time 120.25557446479797
Test Epoch29 layer4 Acc 0.9034210526315789, AUC 0.9615700244903564, avg_entr 0.005724869202822447
ep29_l4_test_time 1.0657005310058594
gc 0
Train Epoch30 Acc 0.9872166666666666 (118466/120000), AUC 0.9958588480949402
ep30_train_time 120.88267421722412
Test Epoch30 layer4 Acc 0.9034210526315789, AUC 0.9651209115982056, avg_entr 0.005242991726845503
ep30_l4_test_time 1.0685558319091797
gc 0
Train Epoch31 Acc 0.98785 (118542/120000), AUC 0.9961795210838318
ep31_train_time 120.35372114181519
Test Epoch31 layer4 Acc 0.9023684210526316, AUC 0.9617752432823181, avg_entr 0.0048076920211315155
ep31_l4_test_time 1.0638408660888672
gc 0
Train Epoch32 Acc 0.9882333333333333 (118588/120000), AUC 0.9961780309677124
ep32_train_time 120.66384387016296
Test Epoch32 layer4 Acc 0.9028947368421053, AUC 0.9586255550384521, avg_entr 0.00433571171015501
ep32_l4_test_time 1.0645034313201904
gc 0
Train Epoch33 Acc 0.98875 (118650/120000), AUC 0.996315598487854
ep33_train_time 120.169842004776
Test Epoch33 layer4 Acc 0.9002631578947369, AUC 0.9563310146331787, avg_entr 0.004178155679255724
ep33_l4_test_time 1.0560448169708252
gc 0
Train Epoch34 Acc 0.9893416666666667 (118721/120000), AUC 0.9963572025299072
ep34_train_time 120.82691073417664
Test Epoch34 layer4 Acc 0.8944736842105263, AUC 0.9593203067779541, avg_entr 0.0055610728450119495
ep34_l4_test_time 1.082564353942871
gc 0
Train Epoch35 Acc 0.9896166666666667 (118754/120000), AUC 0.9965184330940247
ep35_train_time 120.27640986442566
Test Epoch35 layer4 Acc 0.8986842105263158, AUC 0.9593673944473267, avg_entr 0.0037798506673425436
ep35_l4_test_time 0.9693677425384521
gc 0
Train Epoch36 Acc 0.9901916666666667 (118823/120000), AUC 0.9964679479598999
ep36_train_time 120.77201652526855
Test Epoch36 layer4 Acc 0.8981578947368422, AUC 0.9576364755630493, avg_entr 0.004101486876606941
ep36_l4_test_time 1.0580482482910156
gc 0
Train Epoch37 Acc 0.99045 (118854/120000), AUC 0.9965657591819763
ep37_train_time 120.70626735687256
Test Epoch37 layer4 Acc 0.9031578947368422, AUC 0.9578930735588074, avg_entr 0.0036508883349597454
ep37_l4_test_time 0.9853286743164062
gc 0
Train Epoch38 Acc 0.9905416666666667 (118865/120000), AUC 0.9965962171554565
ep38_train_time 120.36296558380127
Test Epoch38 layer4 Acc 0.8973684210526316, AUC 0.9588918685913086, avg_entr 0.005078361369669437
ep38_l4_test_time 1.0745983123779297
gc 0
Train Epoch39 Acc 0.9909333333333333 (118912/120000), AUC 0.9966605305671692
ep39_train_time 120.93150329589844
Test Epoch39 layer4 Acc 0.8984210526315789, AUC 0.9598883390426636, avg_entr 0.004497567657381296
ep39_l4_test_time 1.0378813743591309
gc 0
Train Epoch40 Acc 0.991425 (118971/120000), AUC 0.996731162071228
ep40_train_time 120.2719419002533
Test Epoch40 layer4 Acc 0.8992105263157895, AUC 0.9555371403694153, avg_entr 0.004914130084216595
ep40_l4_test_time 1.052922248840332
gc 0
Train Epoch41 Acc 0.9917166666666667 (119006/120000), AUC 0.996789813041687
ep41_train_time 120.7604296207428
Test Epoch41 layer4 Acc 0.8989473684210526, AUC 0.9582539200782776, avg_entr 0.004129201639443636
ep41_l4_test_time 1.0462498664855957
gc 0
Train Epoch42 Acc 0.9917333333333334 (119008/120000), AUC 0.996898889541626
ep42_train_time 120.23198580741882
Test Epoch42 layer4 Acc 0.8981578947368422, AUC 0.9564286470413208, avg_entr 0.004394098650664091
ep42_l4_test_time 1.0654323101043701
gc 0
Train Epoch43 Acc 0.9920666666666667 (119048/120000), AUC 0.9970879554748535
ep43_train_time 120.70870685577393
Test Epoch43 layer4 Acc 0.8952631578947369, AUC 0.9587228894233704, avg_entr 0.0043604206293821335
ep43_l4_test_time 1.0846405029296875
gc 0
Train Epoch44 Acc 0.9923 (119076/120000), AUC 0.9971535205841064
ep44_train_time 120.29836678504944
Test Epoch44 layer4 Acc 0.8997368421052632, AUC 0.9562845230102539, avg_entr 0.0034844097681343555
ep44_l4_test_time 1.061427116394043
gc 0
Train Epoch45 Acc 0.9926666666666667 (119120/120000), AUC 0.9971950054168701
ep45_train_time 120.66294693946838
Test Epoch45 layer4 Acc 0.8947368421052632, AUC 0.9542102813720703, avg_entr 0.004579652100801468
ep45_l4_test_time 1.049868106842041
gc 0
Train Epoch46 Acc 0.9926666666666667 (119120/120000), AUC 0.9972569346427917
ep46_train_time 120.0845103263855
Test Epoch46 layer4 Acc 0.8994736842105263, AUC 0.955169677734375, avg_entr 0.0036624930799007416
ep46_l4_test_time 1.0695924758911133
gc 0
Train Epoch47 Acc 0.993 (119160/120000), AUC 0.9973465204238892
ep47_train_time 120.80024933815002
Test Epoch47 layer4 Acc 0.8992105263157895, AUC 0.95482337474823, avg_entr 0.0033298716880381107
ep47_l4_test_time 1.062246322631836
gc 0
Train Epoch48 Acc 0.9928916666666666 (119147/120000), AUC 0.9973587989807129
ep48_train_time 120.12474370002747
Test Epoch48 layer4 Acc 0.8989473684210526, AUC 0.9568337202072144, avg_entr 0.004404773004353046
ep48_l4_test_time 1.0537426471710205
gc 0
Train Epoch49 Acc 0.993225 (119187/120000), AUC 0.9974524974822998
ep49_train_time 120.58304953575134
Test Epoch49 layer4 Acc 0.8994736842105263, AUC 0.9570435285568237, avg_entr 0.003773904638364911
ep49_l4_test_time 1.0615003108978271
Best AUC 0.9830079078674316
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 6341.945922613144
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad125//ag_news_lstmal_l5.pt
Test layer4 Acc 0.9134210526315789, AUC 0.9814708232879639, avg_entr 0.039414484053850174
l4_test_time 1.054842472076416
