total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 58.035417556762695
Start Training
gc 0
Train Epoch0 Acc 0.8839053571428571 (494987/560000), AUC 0.9877052903175354
ep0_train_time 103.10637879371643
Test Epoch0 layer4 Acc 0.9746571428571429, AUC 0.9986008405685425, avg_entr 0.05224130302667618
ep0_l4_test_time 2.2826461791992188
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad20//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9786017857142857 (548017/560000), AUC 0.9986327886581421
ep1_train_time 99.2541115283966
Test Epoch1 layer4 Acc 0.9756, AUC 0.9983938336372375, avg_entr 0.017543522641062737
ep1_l4_test_time 2.253516674041748
gc 0
Train Epoch2 Acc 0.9799839285714286 (548791/560000), AUC 0.9984521269798279
ep2_train_time 98.98841643333435
Test Epoch2 layer4 Acc 0.9750857142857143, AUC 0.997911810874939, avg_entr 0.009581046178936958
ep2_l4_test_time 2.2812561988830566
gc 0
Train Epoch3 Acc 0.980825 (549262/560000), AUC 0.9984278082847595
ep3_train_time 99.18093776702881
Test Epoch3 layer4 Acc 0.9760857142857143, AUC 0.9979900121688843, avg_entr 0.006719529628753662
ep3_l4_test_time 2.217060089111328
gc 0
Train Epoch4 Acc 0.9813 (549528/560000), AUC 0.9985253214836121
ep4_train_time 99.59385251998901
Test Epoch4 layer4 Acc 0.9763428571428572, AUC 0.9979673027992249, avg_entr 0.005569960456341505
ep4_l4_test_time 2.259749412536621
gc 0
Train Epoch5 Acc 0.9818696428571428 (549847/560000), AUC 0.9986681938171387
ep5_train_time 99.73338389396667
Test Epoch5 layer4 Acc 0.9763714285714286, AUC 0.9979432821273804, avg_entr 0.004890588577836752
ep5_l4_test_time 2.2310497760772705
gc 0
Train Epoch6 Acc 0.9822660714285715 (550069/560000), AUC 0.9988139867782593
ep6_train_time 99.00001525878906
Test Epoch6 layer4 Acc 0.9767428571428571, AUC 0.9979114532470703, avg_entr 0.004780578427016735
ep6_l4_test_time 2.2188351154327393
gc 0
Train Epoch7 Acc 0.9825446428571428 (550225/560000), AUC 0.9988950490951538
ep7_train_time 99.33443665504456
Test Epoch7 layer4 Acc 0.9769714285714286, AUC 0.99788898229599, avg_entr 0.00445165578275919
ep7_l4_test_time 2.261903762817383
gc 0
Train Epoch8 Acc 0.9828446428571429 (550393/560000), AUC 0.9989362955093384
ep8_train_time 99.23689389228821
Test Epoch8 layer4 Acc 0.9767428571428571, AUC 0.9980000853538513, avg_entr 0.004161810968071222
ep8_l4_test_time 2.2081730365753174
gc 0
Train Epoch9 Acc 0.9829678571428572 (550462/560000), AUC 0.9989022612571716
ep9_train_time 99.2374255657196
Test Epoch9 layer4 Acc 0.9768, AUC 0.9981080293655396, avg_entr 0.004178808536380529
ep9_l4_test_time 2.1803817749023438
gc 0
Train Epoch10 Acc 0.9832553571428572 (550623/560000), AUC 0.9989676475524902
ep10_train_time 99.2952823638916
Test Epoch10 layer4 Acc 0.9772571428571428, AUC 0.998097836971283, avg_entr 0.004101071041077375
ep10_l4_test_time 2.273785352706909
gc 0
Train Epoch11 Acc 0.9834732142857143 (550745/560000), AUC 0.9989739060401917
ep11_train_time 99.26477479934692
Test Epoch11 layer4 Acc 0.9768857142857142, AUC 0.997990071773529, avg_entr 0.003773854812607169
ep11_l4_test_time 2.271685838699341
gc 0
Train Epoch12 Acc 0.9837196428571429 (550883/560000), AUC 0.9990096688270569
ep12_train_time 99.6048595905304
Test Epoch12 layer4 Acc 0.9772285714285714, AUC 0.9981087446212769, avg_entr 0.0038387703243643045
ep12_l4_test_time 2.2254114151000977
gc 0
Train Epoch13 Acc 0.9837464285714286 (550898/560000), AUC 0.9990071654319763
ep13_train_time 99.54557085037231
Test Epoch13 layer4 Acc 0.9772, AUC 0.998018205165863, avg_entr 0.00374279054813087
ep13_l4_test_time 2.250765562057495
gc 0
Train Epoch14 Acc 0.9839321428571428 (551002/560000), AUC 0.999003529548645
ep14_train_time 99.61980724334717
Test Epoch14 layer4 Acc 0.9774, AUC 0.9981691241264343, avg_entr 0.0036925049498677254
ep14_l4_test_time 2.2582740783691406
gc 0
Train Epoch15 Acc 0.983975 (551026/560000), AUC 0.9990136027336121
ep15_train_time 99.43498396873474
Test Epoch15 layer4 Acc 0.9774, AUC 0.9979577660560608, avg_entr 0.0036803095135837793
ep15_l4_test_time 2.224827289581299
gc 0
Train Epoch16 Acc 0.9841982142857143 (551151/560000), AUC 0.999005913734436
ep16_train_time 99.22828316688538
Test Epoch16 layer4 Acc 0.9776, AUC 0.9979578852653503, avg_entr 0.0035799876786768436
ep16_l4_test_time 2.222198247909546
gc 0
Train Epoch17 Acc 0.984325 (551222/560000), AUC 0.9990501403808594
ep17_train_time 99.7071623802185
Test Epoch17 layer4 Acc 0.9774, AUC 0.9980652928352356, avg_entr 0.0036624122876673937
ep17_l4_test_time 2.2491776943206787
gc 0
Train Epoch18 Acc 0.9843875 (551257/560000), AUC 0.9990507960319519
ep18_train_time 98.9665515422821
Test Epoch18 layer4 Acc 0.9776, AUC 0.9979734420776367, avg_entr 0.0033920533023774624
ep18_l4_test_time 2.246670722961426
gc 0
Train Epoch19 Acc 0.9846196428571429 (551387/560000), AUC 0.9990458488464355
ep19_train_time 99.33787775039673
Test Epoch19 layer4 Acc 0.9775142857142857, AUC 0.9979966878890991, avg_entr 0.0033564993645995855
ep19_l4_test_time 2.1464834213256836
gc 0
Train Epoch20 Acc 0.9847482142857142 (551459/560000), AUC 0.9990605711936951
ep20_train_time 99.3344235420227
Test Epoch20 layer4 Acc 0.9776571428571429, AUC 0.9979948997497559, avg_entr 0.003445967333391309
ep20_l4_test_time 2.2395148277282715
gc 0
Train Epoch21 Acc 0.9847642857142858 (551468/560000), AUC 0.9990637898445129
ep21_train_time 99.67578411102295
Test Epoch21 layer4 Acc 0.9776857142857143, AUC 0.9981337189674377, avg_entr 0.003603588556870818
ep21_l4_test_time 2.2237355709075928
gc 0
Train Epoch22 Acc 0.9848410714285715 (551511/560000), AUC 0.9990803003311157
ep22_train_time 99.17037868499756
Test Epoch22 layer4 Acc 0.9777428571428571, AUC 0.9981085658073425, avg_entr 0.003591557964682579
ep22_l4_test_time 2.1930251121520996
gc 0
Train Epoch23 Acc 0.9849696428571428 (551583/560000), AUC 0.9990965127944946
ep23_train_time 99.30581307411194
Test Epoch23 layer4 Acc 0.9777142857142858, AUC 0.9980626702308655, avg_entr 0.003456864506006241
ep23_l4_test_time 2.2185099124908447
gc 0
Train Epoch24 Acc 0.9851053571428572 (551659/560000), AUC 0.9990925192832947
ep24_train_time 99.15296149253845
Test Epoch24 layer4 Acc 0.9777142857142858, AUC 0.9979801177978516, avg_entr 0.0034417249262332916
ep24_l4_test_time 2.2767183780670166
gc 0
Train Epoch25 Acc 0.9851892857142858 (551706/560000), AUC 0.9991012215614319
ep25_train_time 99.30286383628845
Test Epoch25 layer4 Acc 0.9778285714285714, AUC 0.9979872107505798, avg_entr 0.003693608334288001
ep25_l4_test_time 2.2777535915374756
gc 0
Train Epoch26 Acc 0.9852321428571429 (551730/560000), AUC 0.9991000294685364
ep26_train_time 99.57628083229065
Test Epoch26 layer4 Acc 0.9777428571428571, AUC 0.9979265928268433, avg_entr 0.003473230404779315
ep26_l4_test_time 2.262521505355835
gc 0
Train Epoch27 Acc 0.9854125 (551831/560000), AUC 0.9991441369056702
ep27_train_time 99.35049438476562
Test Epoch27 layer4 Acc 0.9778571428571429, AUC 0.9979642629623413, avg_entr 0.00334637681953609
ep27_l4_test_time 2.141399621963501
gc 0
Train Epoch28 Acc 0.9854464285714286 (551850/560000), AUC 0.9991443753242493
ep28_train_time 92.66614055633545
Test Epoch28 layer4 Acc 0.9780857142857143, AUC 0.9980173110961914, avg_entr 0.0033715213648974895
ep28_l4_test_time 0.8911967277526855
gc 0
Train Epoch29 Acc 0.9855589285714286 (551913/560000), AUC 0.9991332292556763
ep29_train_time 94.64730548858643
Test Epoch29 layer4 Acc 0.9776571428571429, AUC 0.9980263113975525, avg_entr 0.00335324346087873
ep29_l4_test_time 2.2114620208740234
gc 0
Train Epoch30 Acc 0.9856642857142857 (551972/560000), AUC 0.9991497993469238
ep30_train_time 99.37092113494873
Test Epoch30 layer4 Acc 0.9782571428571428, AUC 0.9980134963989258, avg_entr 0.003420389723032713
ep30_l4_test_time 2.2144057750701904
gc 0
Train Epoch31 Acc 0.9857857142857143 (552040/560000), AUC 0.9991632103919983
ep31_train_time 99.23906993865967
Test Epoch31 layer4 Acc 0.9778571428571429, AUC 0.9980791807174683, avg_entr 0.003446412505581975
ep31_l4_test_time 2.2620201110839844
gc 0
Train Epoch32 Acc 0.9859517857142858 (552133/560000), AUC 0.9991565346717834
ep32_train_time 98.85085034370422
Test Epoch32 layer4 Acc 0.978, AUC 0.998058021068573, avg_entr 0.0033844655845314264
ep32_l4_test_time 2.232459545135498
gc 0
Train Epoch33 Acc 0.9858678571428572 (552086/560000), AUC 0.9991756677627563
ep33_train_time 99.04746341705322
Test Epoch33 layer4 Acc 0.978, AUC 0.9978848099708557, avg_entr 0.003379829227924347
ep33_l4_test_time 2.2353579998016357
gc 0
Train Epoch34 Acc 0.9860178571428572 (552170/560000), AUC 0.9991858601570129
ep34_train_time 98.99522066116333
Test Epoch34 layer4 Acc 0.9775714285714285, AUC 0.9977172613143921, avg_entr 0.003361946437507868
ep34_l4_test_time 2.249887704849243
gc 0
Train Epoch35 Acc 0.9861625 (552251/560000), AUC 0.9991799592971802
ep35_train_time 99.17121624946594
Test Epoch35 layer4 Acc 0.9780285714285715, AUC 0.9979510307312012, avg_entr 0.0034975188318639994
ep35_l4_test_time 2.2791318893432617
gc 0
Train Epoch36 Acc 0.9862142857142857 (552280/560000), AUC 0.999171793460846
ep36_train_time 99.0050630569458
Test Epoch36 layer4 Acc 0.9782857142857143, AUC 0.9978376030921936, avg_entr 0.003400704124942422
ep36_l4_test_time 2.2068004608154297
gc 0
Train Epoch37 Acc 0.9863696428571429 (552367/560000), AUC 0.9991955161094666
ep37_train_time 99.04523944854736
Test Epoch37 layer4 Acc 0.9780571428571428, AUC 0.9978588819503784, avg_entr 0.0035085082054138184
ep37_l4_test_time 2.241633892059326
gc 0
Train Epoch38 Acc 0.9863857142857143 (552376/560000), AUC 0.9991899728775024
ep38_train_time 94.79587030410767
Test Epoch38 layer4 Acc 0.9779142857142857, AUC 0.997617781162262, avg_entr 0.003596571506932378
ep38_l4_test_time 1.0477712154388428
gc 0
Train Epoch39 Acc 0.9865875 (552489/560000), AUC 0.9991957545280457
ep39_train_time 92.70488953590393
Test Epoch39 layer4 Acc 0.978, AUC 0.9979837536811829, avg_entr 0.0035789147950708866
ep39_l4_test_time 2.3423585891723633
gc 0
Train Epoch40 Acc 0.9865857142857143 (552488/560000), AUC 0.9992190599441528
ep40_train_time 106.72019529342651
Test Epoch40 layer4 Acc 0.9781714285714286, AUC 0.9976601600646973, avg_entr 0.0033961900044232607
ep40_l4_test_time 2.384732723236084
gc 0
Train Epoch41 Acc 0.9866857142857143 (552544/560000), AUC 0.9992121458053589
ep41_train_time 106.38938069343567
Test Epoch41 layer4 Acc 0.9784571428571428, AUC 0.9976766705513, avg_entr 0.003387636039406061
ep41_l4_test_time 2.3785102367401123
gc 0
Train Epoch42 Acc 0.9867875 (552601/560000), AUC 0.9991880059242249
ep42_train_time 106.48124837875366
Test Epoch42 layer4 Acc 0.9781142857142857, AUC 0.9976116418838501, avg_entr 0.003485844237729907
ep42_l4_test_time 2.342790126800537
gc 0
Train Epoch43 Acc 0.9869178571428572 (552674/560000), AUC 0.9992157816886902
ep43_train_time 106.53690600395203
Test Epoch43 layer4 Acc 0.9779142857142857, AUC 0.9977144002914429, avg_entr 0.003371885512024164
ep43_l4_test_time 2.3764536380767822
gc 0
Train Epoch44 Acc 0.9868571428571429 (552640/560000), AUC 0.9992371201515198
ep44_train_time 106.59362030029297
Test Epoch44 layer4 Acc 0.9782857142857143, AUC 0.9976622462272644, avg_entr 0.0033969723153859377
ep44_l4_test_time 2.3615636825561523
gc 0
Train Epoch45 Acc 0.9869767857142857 (552707/560000), AUC 0.9992237091064453
ep45_train_time 106.29188227653503
Test Epoch45 layer4 Acc 0.9786857142857143, AUC 0.9975804090499878, avg_entr 0.0035245269536972046
ep45_l4_test_time 2.367979049682617
gc 0
Train Epoch46 Acc 0.9871375 (552797/560000), AUC 0.9992385506629944
ep46_train_time 106.65110492706299
Test Epoch46 layer4 Acc 0.9782571428571428, AUC 0.9975927472114563, avg_entr 0.0034698727540671825
ep46_l4_test_time 2.376164674758911
gc 0
Train Epoch47 Acc 0.9871892857142858 (552826/560000), AUC 0.9992547035217285
ep47_train_time 106.628098487854
Test Epoch47 layer4 Acc 0.9784285714285714, AUC 0.9974392652511597, avg_entr 0.0033444794826209545
ep47_l4_test_time 2.377323865890503
gc 0
Train Epoch48 Acc 0.9873517857142857 (552917/560000), AUC 0.9992356300354004
ep48_train_time 106.53254699707031
Test Epoch48 layer4 Acc 0.9782571428571428, AUC 0.9975213408470154, avg_entr 0.0033673883881419897
ep48_l4_test_time 2.369879961013794
gc 0
Train Epoch49 Acc 0.9873857142857143 (552936/560000), AUC 0.9992402195930481
ep49_train_time 106.79072618484497
Test Epoch49 layer4 Acc 0.9785714285714285, AUC 0.9975541830062866, avg_entr 0.0034581178333610296
ep49_l4_test_time 2.196035861968994
Best AUC 0.9986008405685425
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 5132.303535938263
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base_pad20//dbpedia_14_linearal_l5.pt
Test layer4 Acc 0.9741142857142857, AUC 0.9985908269882202, avg_entr 0.052518073469400406
l4_test_time 2.304229974746704
