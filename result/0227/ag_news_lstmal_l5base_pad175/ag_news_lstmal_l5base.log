total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 20.871567010879517
Start Training
gc 0
Train Epoch0 Acc 0.7312833333333333 (87754/120000), AUC 0.9150123000144958
ep0_train_time 163.35536742210388
Test Epoch0 layer4 Acc 0.9013157894736842, AUC 0.9802256226539612, avg_entr 0.11869729310274124
ep0_l4_test_time 1.4547901153564453
Save ckpt to ckpt/ag_news_lstmal_l5base_pad175//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.920275 (110433/120000), AUC 0.9824008941650391
ep1_train_time 162.59774255752563
Test Epoch1 layer4 Acc 0.9173684210526316, AUC 0.9837254285812378, avg_entr 0.05440441146492958
ep1_l4_test_time 1.420799732208252
Save ckpt to ckpt/ag_news_lstmal_l5base_pad175//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9317916666666667 (111815/120000), AUC 0.986605703830719
ep2_train_time 162.5258014202118
Test Epoch2 layer4 Acc 0.921578947368421, AUC 0.984557569026947, avg_entr 0.03874659910798073
ep2_l4_test_time 1.4327285289764404
Save ckpt to ckpt/ag_news_lstmal_l5base_pad175//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9388166666666666 (112658/120000), AUC 0.9889477491378784
ep3_train_time 163.02671909332275
Test Epoch3 layer4 Acc 0.9226315789473685, AUC 0.9839062690734863, avg_entr 0.028310680761933327
ep3_l4_test_time 1.4386065006256104
gc 0
Train Epoch4 Acc 0.9441 (113292/120000), AUC 0.9904327392578125
ep4_train_time 162.31616497039795
Test Epoch4 layer4 Acc 0.9186842105263158, AUC 0.9838351011276245, avg_entr 0.024179324507713318
ep4_l4_test_time 1.4217522144317627
gc 0
Train Epoch5 Acc 0.94805 (113766/120000), AUC 0.9914984703063965
ep5_train_time 162.59402990341187
Test Epoch5 layer4 Acc 0.9210526315789473, AUC 0.9828773140907288, avg_entr 0.02017785608768463
ep5_l4_test_time 1.4458284378051758
gc 0
Train Epoch6 Acc 0.9516083333333333 (114193/120000), AUC 0.9923145771026611
ep6_train_time 162.99352645874023
Test Epoch6 layer4 Acc 0.9194736842105263, AUC 0.9822896718978882, avg_entr 0.020271165296435356
ep6_l4_test_time 1.3994176387786865
gc 0
Train Epoch7 Acc 0.9540916666666667 (114491/120000), AUC 0.9930174350738525
ep7_train_time 162.46680188179016
Test Epoch7 layer4 Acc 0.9176315789473685, AUC 0.9816686511039734, avg_entr 0.01962113007903099
ep7_l4_test_time 1.445641279220581
gc 0
Train Epoch8 Acc 0.9565166666666667 (114782/120000), AUC 0.993528425693512
ep8_train_time 162.4908812046051
Test Epoch8 layer4 Acc 0.9144736842105263, AUC 0.9824252128601074, avg_entr 0.01753430999815464
ep8_l4_test_time 1.4235751628875732
gc 0
Train Epoch9 Acc 0.9590666666666666 (115088/120000), AUC 0.9937132596969604
ep9_train_time 162.9556109905243
Test Epoch9 layer4 Acc 0.9136842105263158, AUC 0.9805878400802612, avg_entr 0.014797241427004337
ep9_l4_test_time 1.4092180728912354
gc 0
Train Epoch10 Acc 0.96105 (115326/120000), AUC 0.9940890669822693
ep10_train_time 162.43712854385376
Test Epoch10 layer4 Acc 0.9128947368421053, AUC 0.979530394077301, avg_entr 0.01496894657611847
ep10_l4_test_time 1.4567012786865234
gc 0
Train Epoch11 Acc 0.9628416666666667 (115541/120000), AUC 0.9943782687187195
ep11_train_time 162.38259172439575
Test Epoch11 layer4 Acc 0.9128947368421053, AUC 0.9795830845832825, avg_entr 0.013667727820575237
ep11_l4_test_time 1.4143280982971191
gc 0
Train Epoch12 Acc 0.9646583333333333 (115759/120000), AUC 0.9946863651275635
ep12_train_time 163.08350133895874
Test Epoch12 layer4 Acc 0.9131578947368421, AUC 0.979104220867157, avg_entr 0.01220644824206829
ep12_l4_test_time 1.4494998455047607
gc 0
Train Epoch13 Acc 0.9668 (116016/120000), AUC 0.9947084784507751
ep13_train_time 120.1532666683197
Test Epoch13 layer4 Acc 0.9131578947368421, AUC 0.9774576425552368, avg_entr 0.011472617276012897
ep13_l4_test_time 0.7830967903137207
gc 0
Train Epoch14 Acc 0.9684583333333333 (116215/120000), AUC 0.9948464035987854
ep14_train_time 149.23421216011047
Test Epoch14 layer4 Acc 0.9084210526315789, AUC 0.9757075309753418, avg_entr 0.010412907227873802
ep14_l4_test_time 1.4117395877838135
gc 0
Train Epoch15 Acc 0.969975 (116397/120000), AUC 0.9948288202285767
ep15_train_time 162.60683178901672
Test Epoch15 layer4 Acc 0.9092105263157895, AUC 0.9747215509414673, avg_entr 0.01036363560706377
ep15_l4_test_time 1.4565799236297607
gc 0
Train Epoch16 Acc 0.971775 (116613/120000), AUC 0.9948670864105225
ep16_train_time 163.09070086479187
Test Epoch16 layer4 Acc 0.91, AUC 0.9738613963127136, avg_entr 0.009625808335840702
ep16_l4_test_time 1.4300153255462646
gc 0
Train Epoch17 Acc 0.973725 (116847/120000), AUC 0.9950065612792969
ep17_train_time 162.39491939544678
Test Epoch17 layer4 Acc 0.9063157894736842, AUC 0.9698593020439148, avg_entr 0.009175960905849934
ep17_l4_test_time 1.4171607494354248
gc 0
Train Epoch18 Acc 0.9749583333333334 (116995/120000), AUC 0.9950783252716064
ep18_train_time 162.50967073440552
Test Epoch18 layer4 Acc 0.9071052631578947, AUC 0.971534013748169, avg_entr 0.008868851698935032
ep18_l4_test_time 1.435340404510498
gc 0
Train Epoch19 Acc 0.976075 (117129/120000), AUC 0.9950640201568604
ep19_train_time 163.27555322647095
Test Epoch19 layer4 Acc 0.9039473684210526, AUC 0.9683201313018799, avg_entr 0.007983827032148838
ep19_l4_test_time 1.423400640487671
gc 0
Train Epoch20 Acc 0.97815 (117378/120000), AUC 0.9953235387802124
ep20_train_time 162.51190972328186
Test Epoch20 layer4 Acc 0.9052631578947369, AUC 0.9677958488464355, avg_entr 0.007915692403912544
ep20_l4_test_time 1.4215896129608154
gc 0
Train Epoch21 Acc 0.9794166666666667 (117530/120000), AUC 0.9954134225845337
ep21_train_time 162.65900230407715
Test Epoch21 layer4 Acc 0.9068421052631579, AUC 0.9675933718681335, avg_entr 0.007388737052679062
ep21_l4_test_time 1.4415793418884277
gc 0
Train Epoch22 Acc 0.9808416666666666 (117701/120000), AUC 0.9954770803451538
ep22_train_time 163.05630683898926
Test Epoch22 layer4 Acc 0.9028947368421053, AUC 0.965620756149292, avg_entr 0.006058647762984037
ep22_l4_test_time 1.4223525524139404
gc 0
Train Epoch23 Acc 0.9818666666666667 (117824/120000), AUC 0.9954949617385864
ep23_train_time 162.3603401184082
Test Epoch23 layer4 Acc 0.901578947368421, AUC 0.96565842628479, avg_entr 0.007300259079784155
ep23_l4_test_time 1.423257827758789
gc 0
Train Epoch24 Acc 0.9832666666666666 (117992/120000), AUC 0.9955129623413086
ep24_train_time 162.65926957130432
Test Epoch24 layer4 Acc 0.9023684210526316, AUC 0.9630905985832214, avg_entr 0.006318660918623209
ep24_l4_test_time 1.4185128211975098
gc 0
Train Epoch25 Acc 0.9838666666666667 (118064/120000), AUC 0.9956229329109192
ep25_train_time 163.10680413246155
Test Epoch25 layer4 Acc 0.8986842105263158, AUC 0.961435854434967, avg_entr 0.0059378803707659245
ep25_l4_test_time 1.439012050628662
gc 0
Train Epoch26 Acc 0.9848833333333333 (118186/120000), AUC 0.9957695007324219
ep26_train_time 162.7233762741089
Test Epoch26 layer4 Acc 0.9013157894736842, AUC 0.9609615802764893, avg_entr 0.00623307703062892
ep26_l4_test_time 1.4241490364074707
gc 0
Train Epoch27 Acc 0.9858666666666667 (118304/120000), AUC 0.995909571647644
ep27_train_time 162.8949179649353
Test Epoch27 layer4 Acc 0.8981578947368422, AUC 0.958475649356842, avg_entr 0.005188908893615007
ep27_l4_test_time 1.3157105445861816
gc 0
Train Epoch28 Acc 0.9863416666666667 (118361/120000), AUC 0.9959882497787476
ep28_train_time 162.59119653701782
Test Epoch28 layer4 Acc 0.8984210526315789, AUC 0.9577212333679199, avg_entr 0.005490518640726805
ep28_l4_test_time 1.419785976409912
gc 0
Train Epoch29 Acc 0.986775 (118413/120000), AUC 0.9961267709732056
ep29_train_time 162.4236409664154
Test Epoch29 layer4 Acc 0.9018421052631579, AUC 0.9607070684432983, avg_entr 0.005505291745066643
ep29_l4_test_time 1.419076919555664
gc 0
Train Epoch30 Acc 0.9875083333333333 (118501/120000), AUC 0.9961986541748047
ep30_train_time 163.26209235191345
Test Epoch30 layer4 Acc 0.9, AUC 0.9596154093742371, avg_entr 0.004918123595416546
ep30_l4_test_time 1.447296380996704
gc 0
Train Epoch31 Acc 0.9879416666666667 (118553/120000), AUC 0.9963440299034119
ep31_train_time 162.43576216697693
Test Epoch31 layer4 Acc 0.9039473684210526, AUC 0.9607826471328735, avg_entr 0.004879511892795563
ep31_l4_test_time 1.4192326068878174
gc 0
Train Epoch32 Acc 0.9885916666666666 (118631/120000), AUC 0.9964157938957214
ep32_train_time 162.84034633636475
Test Epoch32 layer4 Acc 0.9031578947368422, AUC 0.9585059881210327, avg_entr 0.003605587175115943
ep32_l4_test_time 1.4362077713012695
gc 0
Train Epoch33 Acc 0.9888083333333333 (118657/120000), AUC 0.9964929819107056
ep33_train_time 163.0797712802887
Test Epoch33 layer4 Acc 0.9010526315789473, AUC 0.9577786922454834, avg_entr 0.004741630982607603
ep33_l4_test_time 1.4285569190979004
gc 0
Train Epoch34 Acc 0.9892916666666667 (118715/120000), AUC 0.9966398477554321
ep34_train_time 162.57927942276
Test Epoch34 layer4 Acc 0.9, AUC 0.9598755836486816, avg_entr 0.004578108433634043
ep34_l4_test_time 1.4247233867645264
gc 0
Train Epoch35 Acc 0.9897833333333333 (118774/120000), AUC 0.9967536926269531
ep35_train_time 162.5535523891449
Test Epoch35 layer4 Acc 0.9005263157894737, AUC 0.9598706960678101, avg_entr 0.004499695263803005
ep35_l4_test_time 1.457059383392334
gc 0
Train Epoch36 Acc 0.9900166666666667 (118802/120000), AUC 0.996886670589447
ep36_train_time 163.37070202827454
Test Epoch36 layer4 Acc 0.8939473684210526, AUC 0.954002320766449, avg_entr 0.004584594164043665
ep36_l4_test_time 1.4509880542755127
gc 0
Train Epoch37 Acc 0.990525 (118863/120000), AUC 0.9969887733459473
ep37_train_time 162.5407431125641
Test Epoch37 layer4 Acc 0.9028947368421053, AUC 0.9585018754005432, avg_entr 0.004719546530395746
ep37_l4_test_time 1.4368975162506104
gc 0
Train Epoch38 Acc 0.9904916666666667 (118859/120000), AUC 0.9970226287841797
ep38_train_time 162.76525855064392
Test Epoch38 layer4 Acc 0.9026315789473685, AUC 0.9565688967704773, avg_entr 0.004607896786183119
ep38_l4_test_time 1.409822940826416
gc 0
Train Epoch39 Acc 0.9910833333333333 (118930/120000), AUC 0.9971824884414673
ep39_train_time 162.8134229183197
Test Epoch39 layer4 Acc 0.9005263157894737, AUC 0.9585574269294739, avg_entr 0.0037325434386730194
ep39_l4_test_time 1.47141432762146
gc 0
Train Epoch40 Acc 0.991225 (118947/120000), AUC 0.9971781969070435
ep40_train_time 162.35275626182556
Test Epoch40 layer4 Acc 0.8989473684210526, AUC 0.9563663601875305, avg_entr 0.004237722139805555
ep40_l4_test_time 1.4341330528259277
gc 0
Train Epoch41 Acc 0.9914416666666667 (118973/120000), AUC 0.997305154800415
ep41_train_time 162.6406102180481
Test Epoch41 layer4 Acc 0.9031578947368422, AUC 0.9587897062301636, avg_entr 0.00484665110707283
ep41_l4_test_time 1.420853853225708
gc 0
Train Epoch42 Acc 0.9915833333333334 (118990/120000), AUC 0.9973152875900269
ep42_train_time 163.06175923347473
Test Epoch42 layer4 Acc 0.9005263157894737, AUC 0.9567797183990479, avg_entr 0.0048738690093159676
ep42_l4_test_time 1.405820608139038
gc 0
Train Epoch43 Acc 0.991775 (119013/120000), AUC 0.9973822236061096
ep43_train_time 162.43435835838318
Test Epoch43 layer4 Acc 0.8963157894736842, AUC 0.9556909203529358, avg_entr 0.004387068096548319
ep43_l4_test_time 1.4224083423614502
gc 0
Train Epoch44 Acc 0.992025 (119043/120000), AUC 0.9974570274353027
ep44_train_time 162.66047382354736
Test Epoch44 layer4 Acc 0.8994736842105263, AUC 0.9567345380783081, avg_entr 0.0047085899859666824
ep44_l4_test_time 1.4485089778900146
gc 0
Train Epoch45 Acc 0.9922333333333333 (119068/120000), AUC 0.9974985122680664
ep45_train_time 162.88202500343323
Test Epoch45 layer4 Acc 0.9018421052631579, AUC 0.956450879573822, avg_entr 0.0031654953490942717
ep45_l4_test_time 1.4285380840301514
gc 0
Train Epoch46 Acc 0.9924 (119088/120000), AUC 0.997532844543457
ep46_train_time 162.62357687950134
Test Epoch46 layer4 Acc 0.9, AUC 0.9572535157203674, avg_entr 0.004950745962560177
ep46_l4_test_time 1.4458041191101074
gc 0
Train Epoch47 Acc 0.99275 (119130/120000), AUC 0.997698187828064
ep47_train_time 163.30147886276245
Test Epoch47 layer4 Acc 0.8994736842105263, AUC 0.9546655416488647, avg_entr 0.004376473370939493
ep47_l4_test_time 1.416456937789917
gc 0
Train Epoch48 Acc 0.9929083333333333 (119149/120000), AUC 0.99771648645401
ep48_train_time 162.42476987838745
Test Epoch48 layer4 Acc 0.9, AUC 0.9563438296318054, avg_entr 0.004148798994719982
ep48_l4_test_time 1.4120733737945557
gc 0
Train Epoch49 Acc 0.9929583333333334 (119155/120000), AUC 0.9977771639823914
ep49_train_time 162.6296329498291
Test Epoch49 layer4 Acc 0.8994736842105263, AUC 0.9556294083595276, avg_entr 0.0031338436529040337
ep49_l4_test_time 1.4420335292816162
Best AUC 0.984557569026947
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 8154.568613529205
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad175//ag_news_lstmal_l5.pt
Test layer4 Acc 0.911578947368421, AUC 0.9829695820808411, avg_entr 0.04330858588218689
l4_test_time 1.4462683200836182
