total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.83454155921936
Start Training
gc 0
Train Epoch0 Acc 0.7235 (86820/120000), AUC 0.9129596948623657
ep0_train_time 19.87278699874878
Test Epoch0 layer4 Acc 0.9197368421052632, AUC 0.9816102981567383, avg_entr 0.19068992137908936
ep0_l4_test_time 0.17512893676757812
Save ckpt to ckpt/ag_news_linearal_l5base_pad25//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9288 (111456/120000), AUC 0.9866567254066467
ep1_train_time 18.752541303634644
Test Epoch1 layer4 Acc 0.9205263157894736, AUC 0.983819305896759, avg_entr 0.09924976527690887
ep1_l4_test_time 0.17687177658081055
Save ckpt to ckpt/ag_news_linearal_l5base_pad25//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9376583333333334 (112519/120000), AUC 0.9897727966308594
ep2_train_time 18.799258708953857
Test Epoch2 layer4 Acc 0.9176315789473685, AUC 0.9834510087966919, avg_entr 0.06134766712784767
ep2_l4_test_time 0.1751270294189453
gc 0
Train Epoch3 Acc 0.94185 (113022/120000), AUC 0.9912165999412537
ep3_train_time 18.80564785003662
Test Epoch3 layer4 Acc 0.9205263157894736, AUC 0.9833301305770874, avg_entr 0.04279761761426926
ep3_l4_test_time 0.18540453910827637
gc 0
Train Epoch4 Acc 0.94485 (113382/120000), AUC 0.9917198419570923
ep4_train_time 18.727779865264893
Test Epoch4 layer4 Acc 0.9197368421052632, AUC 0.9831345081329346, avg_entr 0.031450577080249786
ep4_l4_test_time 0.186845064163208
gc 0
Train Epoch5 Acc 0.94705 (113646/120000), AUC 0.9919429421424866
ep5_train_time 18.460346221923828
Test Epoch5 layer4 Acc 0.9186842105263158, AUC 0.9819691777229309, avg_entr 0.02658815309405327
ep5_l4_test_time 0.15027666091918945
gc 0
Train Epoch6 Acc 0.948675 (113841/120000), AUC 0.992399275302887
ep6_train_time 18.171967029571533
Test Epoch6 layer4 Acc 0.9163157894736842, AUC 0.9818537831306458, avg_entr 0.02302529104053974
ep6_l4_test_time 0.17437195777893066
gc 0
Train Epoch7 Acc 0.9501416666666667 (114017/120000), AUC 0.9927387833595276
ep7_train_time 18.777636289596558
Test Epoch7 layer4 Acc 0.916578947368421, AUC 0.9810320138931274, avg_entr 0.02200096659362316
ep7_l4_test_time 0.18092823028564453
gc 0
Train Epoch8 Acc 0.9510083333333333 (114121/120000), AUC 0.9932410717010498
ep8_train_time 18.643439769744873
Test Epoch8 layer4 Acc 0.9171052631578948, AUC 0.9825552105903625, avg_entr 0.019478129222989082
ep8_l4_test_time 0.1731858253479004
gc 0
Train Epoch9 Acc 0.9520666666666666 (114248/120000), AUC 0.9935864806175232
ep9_train_time 18.845235109329224
Test Epoch9 layer4 Acc 0.9163157894736842, AUC 0.9814640283584595, avg_entr 0.01888045109808445
ep9_l4_test_time 0.1818854808807373
gc 0
Train Epoch10 Acc 0.95295 (114354/120000), AUC 0.9938126802444458
ep10_train_time 18.794589281082153
Test Epoch10 layer4 Acc 0.9155263157894736, AUC 0.9808209538459778, avg_entr 0.018245000392198563
ep10_l4_test_time 0.185746431350708
gc 0
Train Epoch11 Acc 0.9533166666666667 (114398/120000), AUC 0.9941262006759644
ep11_train_time 18.82109260559082
Test Epoch11 layer4 Acc 0.9163157894736842, AUC 0.9809987545013428, avg_entr 0.016089150682091713
ep11_l4_test_time 0.17539763450622559
gc 0
Train Epoch12 Acc 0.95425 (114510/120000), AUC 0.9942567944526672
ep12_train_time 18.64390206336975
Test Epoch12 layer4 Acc 0.9134210526315789, AUC 0.9817656874656677, avg_entr 0.01444036141037941
ep12_l4_test_time 0.1738135814666748
gc 0
Train Epoch13 Acc 0.9549583333333334 (114595/120000), AUC 0.9944268465042114
ep13_train_time 17.600959300994873
Test Epoch13 layer4 Acc 0.9160526315789473, AUC 0.9812547564506531, avg_entr 0.013793344609439373
ep13_l4_test_time 0.17696499824523926
gc 0
Train Epoch14 Acc 0.955325 (114639/120000), AUC 0.9944908618927002
ep14_train_time 18.841414213180542
Test Epoch14 layer4 Acc 0.9152631578947369, AUC 0.9805439114570618, avg_entr 0.013699619099497795
ep14_l4_test_time 0.17679667472839355
gc 0
Train Epoch15 Acc 0.9561583333333333 (114739/120000), AUC 0.9946568012237549
ep15_train_time 18.69820261001587
Test Epoch15 layer4 Acc 0.9157894736842105, AUC 0.9808420538902283, avg_entr 0.012684842571616173
ep15_l4_test_time 0.180649995803833
gc 0
Train Epoch16 Acc 0.95635 (114762/120000), AUC 0.9947346448898315
ep16_train_time 18.708841562271118
Test Epoch16 layer4 Acc 0.915, AUC 0.9804297685623169, avg_entr 0.012973758392035961
ep16_l4_test_time 0.18540716171264648
gc 0
Train Epoch17 Acc 0.956675 (114801/120000), AUC 0.99485844373703
ep17_train_time 18.739585399627686
Test Epoch17 layer4 Acc 0.9134210526315789, AUC 0.9798332452774048, avg_entr 0.011755453422665596
ep17_l4_test_time 0.1831800937652588
gc 0
Train Epoch18 Acc 0.9574916666666666 (114899/120000), AUC 0.9949299097061157
ep18_train_time 18.808727979660034
Test Epoch18 layer4 Acc 0.9152631578947369, AUC 0.979988157749176, avg_entr 0.012493197806179523
ep18_l4_test_time 0.17714977264404297
gc 0
Train Epoch19 Acc 0.9581916666666667 (114983/120000), AUC 0.9950861930847168
ep19_train_time 18.862064123153687
Test Epoch19 layer4 Acc 0.9118421052631579, AUC 0.9799070358276367, avg_entr 0.012268273159861565
ep19_l4_test_time 0.17652559280395508
gc 0
Train Epoch20 Acc 0.9583583333333333 (115003/120000), AUC 0.9952051043510437
ep20_train_time 18.041383028030396
Test Epoch20 layer4 Acc 0.9131578947368421, AUC 0.9798274040222168, avg_entr 0.011729189194738865
ep20_l4_test_time 0.1958937644958496
gc 0
Train Epoch21 Acc 0.9593583333333333 (115123/120000), AUC 0.9952589273452759
ep21_train_time 18.605679988861084
Test Epoch21 layer4 Acc 0.9126315789473685, AUC 0.9798327088356018, avg_entr 0.012235728092491627
ep21_l4_test_time 0.1858196258544922
gc 0
Train Epoch22 Acc 0.9593166666666667 (115118/120000), AUC 0.9954121708869934
ep22_train_time 18.84253692626953
Test Epoch22 layer4 Acc 0.9123684210526316, AUC 0.9796154499053955, avg_entr 0.010345911607146263
ep22_l4_test_time 0.17583036422729492
gc 0
Train Epoch23 Acc 0.9598833333333333 (115186/120000), AUC 0.9954599738121033
ep23_train_time 18.81871771812439
Test Epoch23 layer4 Acc 0.9113157894736842, AUC 0.9792166352272034, avg_entr 0.010790597647428513
ep23_l4_test_time 0.1781597137451172
gc 0
Train Epoch24 Acc 0.9604416666666666 (115253/120000), AUC 0.995622456073761
ep24_train_time 18.932273626327515
Test Epoch24 layer4 Acc 0.9118421052631579, AUC 0.9790721535682678, avg_entr 0.01081004273146391
ep24_l4_test_time 0.18490886688232422
gc 0
Train Epoch25 Acc 0.9606583333333333 (115279/120000), AUC 0.9957171082496643
ep25_train_time 18.876174926757812
Test Epoch25 layer4 Acc 0.911578947368421, AUC 0.9791218638420105, avg_entr 0.010548733174800873
ep25_l4_test_time 0.18883442878723145
gc 0
Train Epoch26 Acc 0.9609166666666666 (115310/120000), AUC 0.995765745639801
ep26_train_time 18.75165319442749
Test Epoch26 layer4 Acc 0.9121052631578948, AUC 0.9787693619728088, avg_entr 0.010405229404568672
ep26_l4_test_time 0.17527413368225098
gc 0
Train Epoch27 Acc 0.96145 (115374/120000), AUC 0.9958722591400146
ep27_train_time 18.889922380447388
Test Epoch27 layer4 Acc 0.9102631578947369, AUC 0.9782541394233704, avg_entr 0.01140751875936985
ep27_l4_test_time 0.18643736839294434
gc 0
Train Epoch28 Acc 0.96205 (115446/120000), AUC 0.9958893060684204
ep28_train_time 17.602068662643433
Test Epoch28 layer4 Acc 0.9110526315789473, AUC 0.9774868488311768, avg_entr 0.01099930889904499
ep28_l4_test_time 0.18691086769104004
gc 0
Train Epoch29 Acc 0.9626416666666666 (115517/120000), AUC 0.9960008859634399
ep29_train_time 18.823721170425415
Test Epoch29 layer4 Acc 0.9105263157894737, AUC 0.9773364067077637, avg_entr 0.010969089344143867
ep29_l4_test_time 0.1730823516845703
gc 0
Train Epoch30 Acc 0.9631 (115572/120000), AUC 0.9960885047912598
ep30_train_time 18.739583253860474
Test Epoch30 layer4 Acc 0.91, AUC 0.978080153465271, avg_entr 0.01115153357386589
ep30_l4_test_time 0.17987656593322754
gc 0
Train Epoch31 Acc 0.9634166666666667 (115610/120000), AUC 0.9961351156234741
ep31_train_time 18.82474684715271
Test Epoch31 layer4 Acc 0.908157894736842, AUC 0.9772626757621765, avg_entr 0.011141078546643257
ep31_l4_test_time 0.17998147010803223
gc 0
Train Epoch32 Acc 0.96375 (115650/120000), AUC 0.996207058429718
ep32_train_time 18.77856731414795
Test Epoch32 layer4 Acc 0.9073684210526316, AUC 0.9771935343742371, avg_entr 0.012456868775188923
ep32_l4_test_time 0.18530058860778809
gc 0
Train Epoch33 Acc 0.9640916666666667 (115691/120000), AUC 0.9962882995605469
ep33_train_time 18.736525297164917
Test Epoch33 layer4 Acc 0.9084210526315789, AUC 0.9777331352233887, avg_entr 0.012776891700923443
ep33_l4_test_time 0.18102121353149414
gc 0
Train Epoch34 Acc 0.964725 (115767/120000), AUC 0.9963449239730835
ep34_train_time 18.82802963256836
Test Epoch34 layer4 Acc 0.9086842105263158, AUC 0.9768536686897278, avg_entr 0.01137551013380289
ep34_l4_test_time 0.17707610130310059
gc 0
Train Epoch35 Acc 0.9651 (115812/120000), AUC 0.9963862895965576
ep35_train_time 17.69378900527954
Test Epoch35 layer4 Acc 0.9057894736842105, AUC 0.9766895174980164, avg_entr 0.011682847514748573
ep35_l4_test_time 0.18275117874145508
gc 0
Train Epoch36 Acc 0.9651583333333333 (115819/120000), AUC 0.996418297290802
ep36_train_time 18.755726099014282
Test Epoch36 layer4 Acc 0.9057894736842105, AUC 0.9757962226867676, avg_entr 0.011500566266477108
ep36_l4_test_time 0.18275713920593262
gc 0
Train Epoch37 Acc 0.9657166666666667 (115886/120000), AUC 0.9965507388114929
ep37_train_time 18.73160672187805
Test Epoch37 layer4 Acc 0.906578947368421, AUC 0.9757223129272461, avg_entr 0.011310724541544914
ep37_l4_test_time 0.1847076416015625
gc 0
Train Epoch38 Acc 0.9660416666666667 (115925/120000), AUC 0.9965276122093201
ep38_train_time 18.868041038513184
Test Epoch38 layer4 Acc 0.9068421052631579, AUC 0.9766895174980164, avg_entr 0.011279262602329254
ep38_l4_test_time 0.18868446350097656
gc 0
Train Epoch39 Acc 0.9665083333333333 (115981/120000), AUC 0.9966352581977844
ep39_train_time 18.782644271850586
Test Epoch39 layer4 Acc 0.9060526315789473, AUC 0.9770644903182983, avg_entr 0.011668889783322811
ep39_l4_test_time 0.1791064739227295
gc 0
Train Epoch40 Acc 0.9664583333333333 (115975/120000), AUC 0.996606171131134
ep40_train_time 18.778620958328247
Test Epoch40 layer4 Acc 0.9055263157894737, AUC 0.9758260846138, avg_entr 0.011719209142029285
ep40_l4_test_time 0.176499605178833
gc 0
Train Epoch41 Acc 0.9672666666666667 (116072/120000), AUC 0.9966354370117188
ep41_train_time 18.886922359466553
Test Epoch41 layer4 Acc 0.9031578947368422, AUC 0.9754900932312012, avg_entr 0.012201186269521713
ep41_l4_test_time 0.18053412437438965
gc 0
Train Epoch42 Acc 0.96695 (116034/120000), AUC 0.9966752529144287
ep42_train_time 18.789385318756104
Test Epoch42 layer4 Acc 0.9036842105263158, AUC 0.9751408100128174, avg_entr 0.011418655514717102
ep42_l4_test_time 0.17739629745483398
gc 0
Train Epoch43 Acc 0.9673833333333334 (116086/120000), AUC 0.9966981410980225
ep43_train_time 17.645912647247314
Test Epoch43 layer4 Acc 0.9031578947368422, AUC 0.9751030802726746, avg_entr 0.012813055887818336
ep43_l4_test_time 0.17848467826843262
gc 0
Train Epoch44 Acc 0.96785 (116142/120000), AUC 0.9966953992843628
ep44_train_time 18.8520827293396
Test Epoch44 layer4 Acc 0.9021052631578947, AUC 0.9757869243621826, avg_entr 0.011609304696321487
ep44_l4_test_time 0.1749260425567627
gc 0
Train Epoch45 Acc 0.968225 (116187/120000), AUC 0.9966866374015808
ep45_train_time 18.7630877494812
Test Epoch45 layer4 Acc 0.9044736842105263, AUC 0.9747482538223267, avg_entr 0.011480974964797497
ep45_l4_test_time 0.18074560165405273
gc 0
Train Epoch46 Acc 0.9687833333333333 (116254/120000), AUC 0.996720552444458
ep46_train_time 18.771158695220947
Test Epoch46 layer4 Acc 0.9042105263157895, AUC 0.9746620655059814, avg_entr 0.012744132429361343
ep46_l4_test_time 0.17449402809143066
gc 0
Train Epoch47 Acc 0.9687916666666667 (116255/120000), AUC 0.9967514276504517
ep47_train_time 18.76046657562256
Test Epoch47 layer4 Acc 0.9010526315789473, AUC 0.9741087555885315, avg_entr 0.011481264606118202
ep47_l4_test_time 0.18508195877075195
gc 0
Train Epoch48 Acc 0.9685166666666667 (116222/120000), AUC 0.9967781901359558
ep48_train_time 18.84450912475586
Test Epoch48 layer4 Acc 0.9, AUC 0.9746106266975403, avg_entr 0.012095916084945202
ep48_l4_test_time 0.18825626373291016
gc 0
Train Epoch49 Acc 0.9691 (116292/120000), AUC 0.9967771172523499
ep49_train_time 18.786851406097412
Test Epoch49 layer4 Acc 0.9, AUC 0.9746508002281189, avg_entr 0.012070389464497566
ep49_l4_test_time 0.19261384010314941
Best AUC 0.983819305896759
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 946.0002682209015
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad25//ag_news_linearal_l5.pt
Test layer4 Acc 0.9068421052631579, AUC 0.9807352423667908, avg_entr 0.10747922956943512
l4_test_time 0.18811440467834473
