total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 16.64442399
Start Training
gc 0
Train Epoch0 Acc 0.6506833333333333 (78082/120000), AUC 0.8610798120498657
ep0_train_time 23.901997752999996
Test Epoch0 layer4 Acc 0.9034210526315789, AUC 0.9771971106529236, avg_entr 0.2198564112186432, f1 0.9034210443496704
ep0_l4_test_time 0.3188293429999973
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9165 (109980/120000), AUC 0.9815055131912231
ep1_train_time 22.877728360999996
Test Epoch1 layer4 Acc 0.9152631578947369, AUC 0.980916440486908, avg_entr 0.11989396065473557, f1 0.9152631759643555
ep1_l4_test_time 0.3126631049999986
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.92685 (111222/120000), AUC 0.9858869314193726
ep2_train_time 22.891918555999993
Test Epoch2 layer4 Acc 0.9223684210526316, AUC 0.9818609952926636, avg_entr 0.08047516644001007, f1 0.9223684072494507
ep2_l4_test_time 0.29371254000000135
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9328166666666666 (111938/120000), AUC 0.9882571697235107
ep3_train_time 22.83634039200001
Test Epoch3 layer4 Acc 0.9221052631578948, AUC 0.9829933047294617, avg_entr 0.05618149787187576, f1 0.9221052527427673
ep3_l4_test_time 0.29655229899999824
gc 0
Train Epoch4 Acc 0.9369416666666667 (112433/120000), AUC 0.9894692301750183
ep4_train_time 22.843377012999994
Test Epoch4 layer4 Acc 0.9213157894736842, AUC 0.9832756519317627, avg_entr 0.03896946460008621, f1 0.9213157892227173
ep4_l4_test_time 0.30955082600002015
gc 0
Train Epoch5 Acc 0.9400833333333334 (112810/120000), AUC 0.9903035759925842
ep5_train_time 22.726902577000004
Test Epoch5 layer4 Acc 0.921578947368421, AUC 0.9832192659378052, avg_entr 0.0315474234521389, f1 0.9215789437294006
ep5_l4_test_time 0.3102957279999998
gc 0
Train Epoch6 Acc 0.9421916666666666 (113063/120000), AUC 0.9910587668418884
ep6_train_time 22.937431769
Test Epoch6 layer4 Acc 0.9192105263157895, AUC 0.9795121550559998, avg_entr 0.02683209255337715, f1 0.9192105531692505
ep6_l4_test_time 0.3166848059999836
gc 0
Train Epoch7 Acc 0.9444416666666666 (113333/120000), AUC 0.9916671514511108
ep7_train_time 22.838880181999997
Test Epoch7 layer4 Acc 0.9226315789473685, AUC 0.9823915958404541, avg_entr 0.024174615740776062, f1 0.922631561756134
ep7_l4_test_time 0.31047880200000577
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9465333333333333 (113584/120000), AUC 0.9924136400222778
ep8_train_time 22.82233099299998
Test Epoch8 layer4 Acc 0.9236842105263158, AUC 0.9800068140029907, avg_entr 0.021222297102212906, f1 0.9236842393875122
ep8_l4_test_time 0.29766591800000697
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.948225 (113787/120000), AUC 0.9928328990936279
ep9_train_time 22.705272729
Test Epoch9 layer4 Acc 0.921578947368421, AUC 0.9824347496032715, avg_entr 0.01990819349884987, f1 0.9215789437294006
ep9_l4_test_time 0.2991197999999997
gc 0
Train Epoch10 Acc 0.9495833333333333 (113950/120000), AUC 0.9930890202522278
ep10_train_time 22.92134505499999
Test Epoch10 layer4 Acc 0.9218421052631579, AUC 0.9815658330917358, avg_entr 0.018961036577820778, f1 0.921842098236084
ep10_l4_test_time 0.3129739739999877
gc 0
Train Epoch11 Acc 0.9504083333333333 (114049/120000), AUC 0.9934066534042358
ep11_train_time 22.938939920000053
Test Epoch11 layer4 Acc 0.9236842105263158, AUC 0.9800070524215698, avg_entr 0.01810363680124283, f1 0.9236842393875122
ep11_l4_test_time 0.30847121900001184
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.951175 (114141/120000), AUC 0.9936578273773193
ep12_train_time 22.721651562000034
Test Epoch12 layer4 Acc 0.9221052631578948, AUC 0.9805662631988525, avg_entr 0.017217310145497322, f1 0.9221052527427673
ep12_l4_test_time 0.3127718540000046
gc 0
Train Epoch13 Acc 0.9522083333333333 (114265/120000), AUC 0.9940189719200134
ep13_train_time 22.87147436400005
Test Epoch13 layer4 Acc 0.9218421052631579, AUC 0.9806057214736938, avg_entr 0.016602111980319023, f1 0.921842098236084
ep13_l4_test_time 0.2856411729999877
gc 0
Train Epoch14 Acc 0.9531416666666667 (114377/120000), AUC 0.9940633773803711
ep14_train_time 22.727409827999963
Test Epoch14 layer4 Acc 0.9205263157894736, AUC 0.9796568155288696, avg_entr 0.016006557270884514, f1 0.9205263257026672
ep14_l4_test_time 0.2912791059999904
gc 0
Train Epoch15 Acc 0.9541416666666667 (114497/120000), AUC 0.9943171143531799
ep15_train_time 22.921771644000046
Test Epoch15 layer4 Acc 0.9202631578947369, AUC 0.9805638790130615, avg_entr 0.01610420271754265, f1 0.9202631711959839
ep15_l4_test_time 0.31647860299995045
gc 0
Train Epoch16 Acc 0.9543416666666666 (114521/120000), AUC 0.9943285584449768
ep16_train_time 22.890416241999958
Test Epoch16 layer4 Acc 0.9218421052631579, AUC 0.9794570803642273, avg_entr 0.014143622480332851, f1 0.921842098236084
ep16_l4_test_time 0.31093665299999884
gc 0
Train Epoch17 Acc 0.9550083333333333 (114601/120000), AUC 0.994566798210144
ep17_train_time 22.913964944999975
Test Epoch17 layer4 Acc 0.9173684210526316, AUC 0.9797914028167725, avg_entr 0.013685873709619045, f1 0.9173683524131775
ep17_l4_test_time 0.3093911279999588
gc 0
Train Epoch18 Acc 0.955725 (114687/120000), AUC 0.9947373867034912
ep18_train_time 22.716894486
Test Epoch18 layer4 Acc 0.9192105263157895, AUC 0.9801090955734253, avg_entr 0.0141642140224576, f1 0.9192105531692505
ep18_l4_test_time 0.30629333199999564
gc 0
Train Epoch19 Acc 0.9559583333333334 (114715/120000), AUC 0.9948364496231079
ep19_train_time 22.83760615
Test Epoch19 layer4 Acc 0.9194736842105263, AUC 0.9809081554412842, avg_entr 0.014119169674813747, f1 0.9194737076759338
ep19_l4_test_time 0.2964845640000249
gc 0
Train Epoch20 Acc 0.9565166666666667 (114782/120000), AUC 0.9948877096176147
ep20_train_time 22.913107708999974
Test Epoch20 layer4 Acc 0.9155263157894736, AUC 0.9792910814285278, avg_entr 0.01386660523712635, f1 0.9155263304710388
ep20_l4_test_time 0.3128028379999819
gc 0
Train Epoch21 Acc 0.9567333333333333 (114808/120000), AUC 0.9950816035270691
ep21_train_time 22.85460572400001
Test Epoch21 layer4 Acc 0.92, AUC 0.9797401428222656, avg_entr 0.013619862496852875, f1 0.9200000166893005
ep21_l4_test_time 0.3144969909999418
gc 0
Train Epoch22 Acc 0.9570083333333333 (114841/120000), AUC 0.9950480461120605
ep22_train_time 22.95623815600004
Test Epoch22 layer4 Acc 0.9194736842105263, AUC 0.9797946810722351, avg_entr 0.01404429879039526, f1 0.9194737076759338
ep22_l4_test_time 0.3090000700000246
gc 0
Train Epoch23 Acc 0.9577083333333334 (114925/120000), AUC 0.9951608777046204
ep23_train_time 22.805633059
Test Epoch23 layer4 Acc 0.9168421052631579, AUC 0.9800874590873718, avg_entr 0.013520083390176296, f1 0.9168421030044556
ep23_l4_test_time 0.3048673939999844
gc 0
Train Epoch24 Acc 0.9582916666666667 (114995/120000), AUC 0.9952754974365234
ep24_train_time 22.88274754200006
Test Epoch24 layer4 Acc 0.9171052631578948, AUC 0.9796849489212036, avg_entr 0.013115596026182175, f1 0.9171052575111389
ep24_l4_test_time 0.2883103750000373
gc 0
Train Epoch25 Acc 0.9584666666666667 (115016/120000), AUC 0.9953407645225525
ep25_train_time 22.943042644000002
Test Epoch25 layer4 Acc 0.9147368421052632, AUC 0.979856550693512, avg_entr 0.012417985126376152, f1 0.9147368669509888
ep25_l4_test_time 0.31747946400003
gc 0
Train Epoch26 Acc 0.9587583333333334 (115051/120000), AUC 0.9954042434692383
ep26_train_time 23.032909983999957
Test Epoch26 layer4 Acc 0.9171052631578948, AUC 0.9796253442764282, avg_entr 0.012947491370141506, f1 0.9171052575111389
ep26_l4_test_time 0.29934820100004345
gc 0
Train Epoch27 Acc 0.95885 (115062/120000), AUC 0.9954118132591248
ep27_train_time 22.82105945300009
Test Epoch27 layer4 Acc 0.9186842105263158, AUC 0.9792508482933044, avg_entr 0.013192401267588139, f1 0.918684184551239
ep27_l4_test_time 0.31014984999990247
gc 0
Train Epoch28 Acc 0.9591666666666666 (115100/120000), AUC 0.9954694509506226
ep28_train_time 22.804168725000068
Test Epoch28 layer4 Acc 0.9184210526315789, AUC 0.9795153737068176, avg_entr 0.01242530345916748, f1 0.9184210896492004
ep28_l4_test_time 0.2926718429999937
gc 0
Train Epoch29 Acc 0.95945 (115134/120000), AUC 0.9955567121505737
ep29_train_time 22.721356963000062
Test Epoch29 layer4 Acc 0.9157894736842105, AUC 0.9793684482574463, avg_entr 0.01226042304188013, f1 0.9157894849777222
ep29_l4_test_time 0.3125168650000205
Best AUC tensor(0.9237) 11
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 697.5602105930001
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9123684210526316, AUC 0.9802131056785583, avg_entr 0.05264141410589218, f1 0.9123684167861938
l0_test_time 0.31084972700000435
gc 0
Test layer1 Acc 0.9118421052631579, AUC 0.9798690676689148, avg_entr 0.0516037791967392, f1 0.9118421077728271
l1_test_time 0.25808297600008245
gc 0
Test layer2 Acc 0.911578947368421, AUC 0.9811041355133057, avg_entr 0.03412517532706261, f1 0.9115789532661438
l2_test_time 0.31752216399991084
gc 0
Test layer3 Acc 0.9128947368421053, AUC 0.9787308573722839, avg_entr 0.022400595247745514, f1 0.9128947257995605
l3_test_time 0.317528310000057
gc 0
Test layer4 Acc 0.9121052631578948, AUC 0.9782280325889587, avg_entr 0.019815530627965927, f1 0.9121052622795105
l4_test_time 0.3169021270000485
gc 0
Test threshold 0.1 Acc 0.9128947368421053, AUC 0.9792418479919434, avg_entr 0.021126149222254753, f1 0.9128947257995605
t0.1_test_time 0.9939449700000296
gc 0
Test threshold 0.2 Acc 0.9128947368421053, AUC 0.9796106219291687, avg_entr 0.026766100898385048, f1 0.9128947257995605
t0.2_test_time 0.9205523179999773
gc 0
Test threshold 0.3 Acc 0.9126315789473685, AUC 0.9799830913543701, avg_entr 0.034391190856695175, f1 0.9126315712928772
t0.3_test_time 0.7949947559999373
gc 0
Test threshold 0.4 Acc 0.9118421052631579, AUC 0.9801428318023682, avg_entr 0.03668567165732384, f1 0.9118421077728271
t0.4_test_time 0.7750033679999433
gc 0
Test threshold 0.5 Acc 0.9126315789473685, AUC 0.9802238941192627, avg_entr 0.03782683238387108, f1 0.9126315712928772
t0.5_test_time 0.6406851209999331
gc 0
Test threshold 0.6 Acc 0.9123684210526316, AUC 0.9802131056785583, avg_entr 0.03797275200486183, f1 0.9123684167861938
t0.6_test_time 0.5451841130000048
gc 0
Test threshold 0.7 Acc 0.9123684210526316, AUC 0.9802131056785583, avg_entr 0.03797275200486183, f1 0.9123684167861938
t0.7_test_time 0.5862209699999994
gc 0
Test threshold 0.8 Acc 0.9123684210526316, AUC 0.9802131056785583, avg_entr 0.03797275200486183, f1 0.9123684167861938
t0.8_test_time 0.5413114180000775
gc 0
Test threshold 0.9 Acc 0.9123684210526316, AUC 0.9802131056785583, avg_entr 0.03797275200486183, f1 0.9123684167861938
t0.9_test_time 0.5511121380000077
