total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 16.492610215
Start Training
gc 0
Train Epoch0 Acc 0.6229166666666667 (74750/120000), AUC 0.8417273759841919
ep0_train_time 24.139805395999996
Test Epoch0 layer4 Acc 0.9, AUC 0.9773591756820679, avg_entr 0.23441188037395477, f1 0.8999999761581421
ep0_l4_test_time 0.30300516799999855
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.91685 (110022/120000), AUC 0.9812297821044922
ep1_train_time 22.285359962999998
Test Epoch1 layer4 Acc 0.9152631578947369, AUC 0.9806841611862183, avg_entr 0.12109324336051941, f1 0.9152631759643555
ep1_l4_test_time 0.17184744099999705
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.92735 (111282/120000), AUC 0.9856784343719482
ep2_train_time 10.584195391000009
Test Epoch2 layer4 Acc 0.9194736842105263, AUC 0.9820849299430847, avg_entr 0.08080697059631348, f1 0.9194737076759338
ep2_l4_test_time 0.1717236160000084
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9330166666666667 (111962/120000), AUC 0.9880877137184143
ep3_train_time 14.544505296000011
Test Epoch3 layer4 Acc 0.921578947368421, AUC 0.9826993942260742, avg_entr 0.05660698562860489, f1 0.9215789437294006
ep3_l4_test_time 0.3081894219999981
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9375416666666667 (112505/120000), AUC 0.9895720481872559
ep4_train_time 23.161009980000003
Test Epoch4 layer4 Acc 0.9226315789473685, AUC 0.9829907417297363, avg_entr 0.04041628912091255, f1 0.922631561756134
ep4_l4_test_time 0.3067870880000072
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9403333333333334 (112840/120000), AUC 0.9903305172920227
ep5_train_time 23.179339739
Test Epoch5 layer4 Acc 0.9223684210526316, AUC 0.9829814434051514, avg_entr 0.02989465743303299, f1 0.9223684072494507
ep5_l4_test_time 0.3025659780000183
gc 0
Train Epoch6 Acc 0.9429 (113148/120000), AUC 0.9911519885063171
ep6_train_time 23.193744932999977
Test Epoch6 layer4 Acc 0.9239473684210526, AUC 0.9802471399307251, avg_entr 0.026081053540110588, f1 0.9239473938941956
ep6_l4_test_time 0.30392516199998454
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.945075 (113409/120000), AUC 0.9918427467346191
ep7_train_time 23.078209861000005
Test Epoch7 layer4 Acc 0.9234210526315789, AUC 0.9821980595588684, avg_entr 0.022695008665323257, f1 0.9234210252761841
ep7_l4_test_time 0.29827407099998027
gc 0
Train Epoch8 Acc 0.9468 (113616/120000), AUC 0.9926142692565918
ep8_train_time 23.252271554000004
Test Epoch8 layer4 Acc 0.9228947368421052, AUC 0.980208158493042, avg_entr 0.021372877061367035, f1 0.9228947162628174
ep8_l4_test_time 0.2999828309999941
gc 0
Train Epoch9 Acc 0.9481666666666667 (113780/120000), AUC 0.9929379224777222
ep9_train_time 23.189277617000016
Test Epoch9 layer4 Acc 0.9218421052631579, AUC 0.9816005229949951, avg_entr 0.021288828924298286, f1 0.921842098236084
ep9_l4_test_time 0.3128180719999989
gc 0
Train Epoch10 Acc 0.9495166666666667 (113942/120000), AUC 0.9932655692100525
ep10_train_time 23.30784895000002
Test Epoch10 layer4 Acc 0.9231578947368421, AUC 0.9821926355361938, avg_entr 0.018168039619922638, f1 0.9231578707695007
ep10_l4_test_time 0.3138164510000081
gc 0
Train Epoch11 Acc 0.950375 (114045/120000), AUC 0.9935495257377625
ep11_train_time 23.117753241999992
Test Epoch11 layer4 Acc 0.9228947368421052, AUC 0.9798761606216431, avg_entr 0.016572611406445503, f1 0.9228947162628174
ep11_l4_test_time 0.3155368870000075
gc 0
Train Epoch12 Acc 0.951375 (114165/120000), AUC 0.9937165975570679
ep12_train_time 23.205620924000016
Test Epoch12 layer4 Acc 0.92, AUC 0.9809300303459167, avg_entr 0.016972878947854042, f1 0.9200000166893005
ep12_l4_test_time 0.3108424600000035
gc 0
Train Epoch13 Acc 0.9524666666666667 (114296/120000), AUC 0.993924081325531
ep13_train_time 22.972998890999975
Test Epoch13 layer4 Acc 0.9184210526315789, AUC 0.9807847738265991, avg_entr 0.016283240169286728, f1 0.9184210896492004
ep13_l4_test_time 0.30006364700000177
gc 0
Train Epoch14 Acc 0.953025 (114363/120000), AUC 0.994117259979248
ep14_train_time 22.951831208999977
Test Epoch14 layer4 Acc 0.9192105263157895, AUC 0.9803507328033447, avg_entr 0.014999392442405224, f1 0.9192105531692505
ep14_l4_test_time 0.3072334099999807
gc 0
Train Epoch15 Acc 0.9542666666666667 (114512/120000), AUC 0.9942879676818848
ep15_train_time 22.970872111999995
Test Epoch15 layer4 Acc 0.9197368421052632, AUC 0.9794505834579468, avg_entr 0.013397431001067162, f1 0.9197368621826172
ep15_l4_test_time 0.30455006099998627
gc 0
Train Epoch16 Acc 0.95495 (114594/120000), AUC 0.9944266080856323
ep16_train_time 22.92337355699999
Test Epoch16 layer4 Acc 0.9184210526315789, AUC 0.9789537787437439, avg_entr 0.01557241752743721, f1 0.9184210896492004
ep16_l4_test_time 0.30945336700000325
gc 0
Train Epoch17 Acc 0.95525 (114630/120000), AUC 0.9944571852684021
ep17_train_time 22.976830108
Test Epoch17 layer4 Acc 0.9207894736842105, AUC 0.9800546765327454, avg_entr 0.014279310591518879, f1 0.9207894802093506
ep17_l4_test_time 0.31579329700002745
gc 0
Train Epoch18 Acc 0.9556583333333334 (114679/120000), AUC 0.9946959614753723
ep18_train_time 23.016421164000008
Test Epoch18 layer4 Acc 0.9181578947368421, AUC 0.9795249700546265, avg_entr 0.01265223789960146, f1 0.9181578755378723
ep18_l4_test_time 0.31390742400003546
gc 0
Train Epoch19 Acc 0.9567416666666667 (114809/120000), AUC 0.9947420358657837
ep19_train_time 23.030232280000007
Test Epoch19 layer4 Acc 0.9160526315789473, AUC 0.9782670140266418, avg_entr 0.013522058725357056, f1 0.9160526394844055
ep19_l4_test_time 0.30976479800000334
gc 0
Train Epoch20 Acc 0.9567833333333333 (114814/120000), AUC 0.9948489665985107
ep20_train_time 22.976860002000024
Test Epoch20 layer4 Acc 0.9168421052631579, AUC 0.9792524576187134, avg_entr 0.012727436609566212, f1 0.9168421030044556
ep20_l4_test_time 0.24497685699998328
gc 0
Train Epoch21 Acc 0.957575 (114909/120000), AUC 0.9949977397918701
ep21_train_time 23.012653038000053
Test Epoch21 layer4 Acc 0.9160526315789473, AUC 0.9797183275222778, avg_entr 0.012824594974517822, f1 0.9160526394844055
ep21_l4_test_time 0.3009860800000297
gc 0
Train Epoch22 Acc 0.95785 (114942/120000), AUC 0.9950238466262817
ep22_train_time 23.063896320000026
Test Epoch22 layer4 Acc 0.916578947368421, AUC 0.9794257879257202, avg_entr 0.012112676165997982, f1 0.9165789484977722
ep22_l4_test_time 0.30543259799992484
gc 0
Train Epoch23 Acc 0.958325 (114999/120000), AUC 0.9951773285865784
ep23_train_time 22.991968084000064
Test Epoch23 layer4 Acc 0.9155263157894736, AUC 0.9795560240745544, avg_entr 0.011834884062409401, f1 0.9155263304710388
ep23_l4_test_time 0.3044189510000024
gc 0
Train Epoch24 Acc 0.9585083333333333 (115021/120000), AUC 0.9952091574668884
ep24_train_time 23.18020736099993
Test Epoch24 layer4 Acc 0.9163157894736842, AUC 0.9789827466011047, avg_entr 0.012959734536707401, f1 0.9163157939910889
ep24_l4_test_time 0.3047174370000221
gc 0
Train Epoch25 Acc 0.9591166666666666 (115094/120000), AUC 0.9952471256256104
ep25_train_time 23.144301831000007
Test Epoch25 layer4 Acc 0.9155263157894736, AUC 0.9787936210632324, avg_entr 0.011884328909218311, f1 0.9155263304710388
ep25_l4_test_time 0.2681497290000152
gc 0
Train Epoch26 Acc 0.9592416666666667 (115109/120000), AUC 0.9953542947769165
ep26_train_time 23.2465979320001
Test Epoch26 layer4 Acc 0.9171052631578948, AUC 0.9790903329849243, avg_entr 0.012757592834532261, f1 0.9171052575111389
ep26_l4_test_time 0.31366898400005994
gc 0
Train Epoch27 Acc 0.9595 (115140/120000), AUC 0.9954157471656799
ep27_train_time 23.253160763999972
Test Epoch27 layer4 Acc 0.9147368421052632, AUC 0.9786770939826965, avg_entr 0.011877832002937794, f1 0.9147368669509888
ep27_l4_test_time 0.3095235570000341
gc 0
Train Epoch28 Acc 0.9598416666666667 (115181/120000), AUC 0.9954890012741089
ep28_train_time 23.232593805999954
Test Epoch28 layer4 Acc 0.9171052631578948, AUC 0.9770535826683044, avg_entr 0.01192756649106741, f1 0.9171052575111389
ep28_l4_test_time 0.30046677400002864
gc 0
Train Epoch29 Acc 0.9602666666666667 (115232/120000), AUC 0.9955183267593384
ep29_train_time 23.21416435399999
Test Epoch29 layer4 Acc 0.915, AUC 0.9770033359527588, avg_entr 0.012013638392090797, f1 0.9150000214576721
ep29_l4_test_time 0.3081220559998883
Best AUC tensor(0.9239) 6
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 682.966332888
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9121052631578948, AUC 0.9807285070419312, avg_entr 0.07205754518508911, f1 0.9121052622795105
l0_test_time 0.30147596599999815
gc 0
Test layer1 Acc 0.9134210526315789, AUC 0.9804345965385437, avg_entr 0.067280113697052, f1 0.9134210348129272
l1_test_time 0.30893313699993996
gc 0
Test layer2 Acc 0.9142105263157895, AUC 0.9810250997543335, avg_entr 0.05800376459956169, f1 0.9142104983329773
l2_test_time 0.31002380799998264
gc 0
Test layer3 Acc 0.9126315789473685, AUC 0.9803068041801453, avg_entr 0.03662412613630295, f1 0.9126315712928772
l3_test_time 0.26643191200003
gc 0
Test layer4 Acc 0.915, AUC 0.9787991642951965, avg_entr 0.029669256880879402, f1 0.9150000214576721
l4_test_time 0.3051101869999684
gc 0
Test threshold 0.1 Acc 0.9155263157894736, AUC 0.9796245098114014, avg_entr 0.03243578225374222, f1 0.9155263304710388
t0.1_test_time 0.8478916089999302
gc 0
Test threshold 0.2 Acc 0.9147368421052632, AUC 0.9798822402954102, avg_entr 0.03977740556001663, f1 0.9147368669509888
t0.2_test_time 0.8108964929999729
gc 0
Test threshold 0.3 Acc 0.9142105263157895, AUC 0.980625569820404, avg_entr 0.04705493152141571, f1 0.9142104983329773
t0.3_test_time 0.8837447000000793
gc 0
Test threshold 0.4 Acc 0.9136842105263158, AUC 0.980664849281311, avg_entr 0.05055868998169899, f1 0.9136841893196106
t0.4_test_time 0.8715443549999691
gc 0
Test threshold 0.5 Acc 0.9118421052631579, AUC 0.9807196259498596, avg_entr 0.051857009530067444, f1 0.9118421077728271
t0.5_test_time 0.6389236449999771
gc 0
Test threshold 0.6 Acc 0.9121052631578948, AUC 0.9807285070419312, avg_entr 0.05197853222489357, f1 0.9121052622795105
t0.6_test_time 0.5772498360000782
gc 0
Test threshold 0.7 Acc 0.9121052631578948, AUC 0.9807285070419312, avg_entr 0.05197853222489357, f1 0.9121052622795105
t0.7_test_time 0.592743050000081
gc 0
Test threshold 0.8 Acc 0.9121052631578948, AUC 0.9807285070419312, avg_entr 0.05197853222489357, f1 0.9121052622795105
t0.8_test_time 0.5996942949999493
gc 0
Test threshold 0.9 Acc 0.9121052631578948, AUC 0.9807285070419312, avg_entr 0.05197853222489357, f1 0.9121052622795105
t0.9_test_time 0.5810986980000052
