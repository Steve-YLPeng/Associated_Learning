total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 58.507357358932495
Start Training
gc 0
Train Epoch0 Acc 0.9095535714285714 (509350/560000), AUC 0.9908283948898315
ep0_train_time 420.57145500183105
Test Epoch0 layer4 Acc 0.9819428571428571, AUC 0.9978944063186646, avg_entr 0.018817633390426636, f1 0.9819428324699402
ep0_l4_test_time 7.0865724086761475
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9849821428571428 (551590/560000), AUC 0.9976447224617004
ep1_train_time 418.9102141857147
Test Epoch1 layer4 Acc 0.9840571428571429, AUC 0.9981359839439392, avg_entr 0.004539257846772671, f1 0.9840571284294128
ep1_l4_test_time 7.155056476593018
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9869607142857143 (552698/560000), AUC 0.9980617761611938
ep2_train_time 418.56175923347473
Test Epoch2 layer4 Acc 0.9847428571428571, AUC 0.9981746077537537, avg_entr 0.002423439873382449, f1 0.9847428798675537
ep2_l4_test_time 7.131850004196167
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9884053571428572 (553507/560000), AUC 0.9983451962471008
ep3_train_time 404.6648893356323
Test Epoch3 layer4 Acc 0.9851714285714286, AUC 0.9980477094650269, avg_entr 0.0019131478620693088, f1 0.9851714372634888
ep3_l4_test_time 3.5788614749908447
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9895089285714286 (554125/560000), AUC 0.9985510110855103
ep4_train_time 379.0903272628784
Test Epoch4 layer4 Acc 0.9857428571428571, AUC 0.9980992674827576, avg_entr 0.0016599888913333416, f1 0.9857428669929504
ep4_l4_test_time 7.169180154800415
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9903964285714286 (554622/560000), AUC 0.9988099336624146
ep5_train_time 418.5616662502289
Test Epoch5 layer4 Acc 0.9854857142857143, AUC 0.9979389905929565, avg_entr 0.0018442812142893672, f1 0.9854857325553894
ep5_l4_test_time 7.087364435195923
gc 0
Train Epoch6 Acc 0.9912625 (555107/560000), AUC 0.9989019632339478
ep6_train_time 418.9754855632782
Test Epoch6 layer4 Acc 0.9864, AUC 0.9981235861778259, avg_entr 0.001217600773088634, f1 0.9864000082015991
ep6_l4_test_time 6.581145524978638
Save ckpt to ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9919660714285714 (555501/560000), AUC 0.9989985227584839
ep7_train_time 418.5344157218933
Test Epoch7 layer4 Acc 0.9858857142857143, AUC 0.9979067444801331, avg_entr 0.0013777422718703747, f1 0.985885739326477
ep7_l4_test_time 7.096368074417114
gc 0
Train Epoch8 Acc 0.992675 (555898/560000), AUC 0.9990429878234863
ep8_train_time 418.62919187545776
Test Epoch8 layer4 Acc 0.9859714285714286, AUC 0.9980025291442871, avg_entr 0.001215740805491805, f1 0.9859714508056641
ep8_l4_test_time 7.167218446731567
gc 0
Train Epoch9 Acc 0.9932160714285714 (556201/560000), AUC 0.9990552663803101
ep9_train_time 418.85470247268677
Test Epoch9 layer4 Acc 0.9862857142857143, AUC 0.9979249835014343, avg_entr 0.0011970165651291609, f1 0.9862856268882751
ep9_l4_test_time 7.100377321243286
gc 0
Train Epoch10 Acc 0.9937375 (556493/560000), AUC 0.9990825653076172
ep10_train_time 418.5072169303894
Test Epoch10 layer4 Acc 0.9861714285714286, AUC 0.9976755976676941, avg_entr 0.0011599832214415073, f1 0.9861714243888855
ep10_l4_test_time 7.125809192657471
gc 0
Train Epoch11 Acc 0.99425 (556780/560000), AUC 0.9991071820259094
ep11_train_time 418.74265146255493
Test Epoch11 layer4 Acc 0.9853714285714286, AUC 0.9976282715797424, avg_entr 0.001133413752540946, f1 0.9853714108467102
ep11_l4_test_time 7.102972507476807
gc 0
Train Epoch12 Acc 0.9947625 (557067/560000), AUC 0.9991436004638672
ep12_train_time 418.95118737220764
Test Epoch12 layer4 Acc 0.9859142857142857, AUC 0.9975010752677917, avg_entr 0.001001589698716998, f1 0.9859142899513245
ep12_l4_test_time 7.104541540145874
gc 0
Train Epoch13 Acc 0.9951767857142857 (557299/560000), AUC 0.9991654753684998
ep13_train_time 418.668160200119
Test Epoch13 layer4 Acc 0.9862571428571428, AUC 0.9973553419113159, avg_entr 0.001000410644337535, f1 0.9862571358680725
ep13_l4_test_time 6.6794116497039795
gc 0
Train Epoch14 Acc 0.9956053571428571 (557539/560000), AUC 0.9991720914840698
ep14_train_time 418.72624588012695
Test Epoch14 layer4 Acc 0.9858857142857143, AUC 0.9970148801803589, avg_entr 0.001035470748320222, f1 0.985885739326477
ep14_l4_test_time 7.080173969268799
gc 0
Train Epoch15 Acc 0.9959535714285714 (557734/560000), AUC 0.9991854429244995
ep15_train_time 418.7827489376068
Test Epoch15 layer4 Acc 0.9860571428571429, AUC 0.9971893429756165, avg_entr 0.0009663529344834387, f1 0.9860571622848511
ep15_l4_test_time 7.145050764083862
gc 0
Train Epoch16 Acc 0.9962732142857142 (557913/560000), AUC 0.999189555644989
ep16_train_time 418.8060233592987
Test Epoch16 layer4 Acc 0.9855142857142857, AUC 0.996688187122345, avg_entr 0.0006868571508675814, f1 0.9855142831802368
ep16_l4_test_time 7.1239988803863525
gc 0
Train Epoch17 Acc 0.9965035714285714 (558042/560000), AUC 0.9991888999938965
ep17_train_time 418.2140393257141
Test Epoch17 layer4 Acc 0.9859428571428571, AUC 0.9968757033348083, avg_entr 0.0008540122653357685, f1 0.9859428405761719
ep17_l4_test_time 7.134647846221924
gc 0
Train Epoch18 Acc 0.9967071428571429 (558156/560000), AUC 0.9992156028747559
ep18_train_time 418.2442753314972
Test Epoch18 layer4 Acc 0.9859142857142857, AUC 0.9967120289802551, avg_entr 0.0007157713989727199, f1 0.9859142899513245
ep18_l4_test_time 7.154007434844971
gc 0
Train Epoch19 Acc 0.9969107142857143 (558270/560000), AUC 0.9992407560348511
ep19_train_time 417.9336702823639
Test Epoch19 layer4 Acc 0.9859714285714286, AUC 0.996360719203949, avg_entr 0.0008427419234067202, f1 0.9859714508056641
ep19_l4_test_time 7.080511569976807
gc 0
Train Epoch20 Acc 0.9971464285714285 (558402/560000), AUC 0.9992451071739197
ep20_train_time 418.0891168117523
Test Epoch20 layer4 Acc 0.9856571428571429, AUC 0.9963226914405823, avg_entr 0.0006543984636664391, f1 0.9856571555137634
ep20_l4_test_time 6.91753625869751
gc 0
Train Epoch21 Acc 0.9972464285714285 (558458/560000), AUC 0.9992863535881042
ep21_train_time 417.82418274879456
Test Epoch21 layer4 Acc 0.9859428571428571, AUC 0.9961474537849426, avg_entr 0.0006493832333944738, f1 0.9859428405761719
ep21_l4_test_time 7.1319005489349365
gc 0
Train Epoch22 Acc 0.9973910714285714 (558539/560000), AUC 0.9992946982383728
ep22_train_time 418.555855512619
Test Epoch22 layer4 Acc 0.9854285714285714, AUC 0.996022641658783, avg_entr 0.0006820535054430366, f1 0.9854285717010498
ep22_l4_test_time 7.138852596282959
gc 0
Train Epoch23 Acc 0.9975160714285715 (558609/560000), AUC 0.9993196129798889
ep23_train_time 418.1863100528717
Test Epoch23 layer4 Acc 0.9847428571428571, AUC 0.9958676695823669, avg_entr 0.0006984819774515927, f1 0.9847428798675537
ep23_l4_test_time 7.136097192764282
gc 0
Train Epoch24 Acc 0.9975839285714285 (558647/560000), AUC 0.9993378520011902
ep24_train_time 418.0808081626892
Test Epoch24 layer4 Acc 0.9852, AUC 0.9961215853691101, avg_entr 0.0005464516580104828, f1 0.9851999878883362
ep24_l4_test_time 7.165067672729492
gc 0
Train Epoch25 Acc 0.9977482142857143 (558739/560000), AUC 0.9993532299995422
ep25_train_time 418.0513665676117
Test Epoch25 layer4 Acc 0.9853428571428572, AUC 0.9959800839424133, avg_entr 0.0007098057540133595, f1 0.9853428602218628
ep25_l4_test_time 7.099459171295166
gc 0
Train Epoch26 Acc 0.9977464285714286 (558738/560000), AUC 0.9993389844894409
ep26_train_time 418.9507431983948
Test Epoch26 layer4 Acc 0.9852857142857143, AUC 0.9959895014762878, avg_entr 0.0006167308893054724, f1 0.9852856993675232
ep26_l4_test_time 7.170752286911011
gc 0
Train Epoch27 Acc 0.9978982142857142 (558823/560000), AUC 0.9993484616279602
ep27_train_time 362.9807608127594
Test Epoch27 layer4 Acc 0.9855428571428572, AUC 0.9956039786338806, avg_entr 0.0005771624855697155, f1 0.9855428338050842
ep27_l4_test_time 7.119369029998779
gc 0
Train Epoch28 Acc 0.9979660714285714 (558861/560000), AUC 0.9993538856506348
ep28_train_time 418.7050347328186
Test Epoch28 layer4 Acc 0.9844, AUC 0.995585560798645, avg_entr 0.0005995075916871428, f1 0.9843999743461609
ep28_l4_test_time 7.177406311035156
gc 0
Train Epoch29 Acc 0.9979892857142857 (558874/560000), AUC 0.9993923306465149
ep29_train_time 418.78114438056946
Test Epoch29 layer4 Acc 0.9852285714285715, AUC 0.9957398176193237, avg_entr 0.0005800427170470357, f1 0.9852285981178284
ep29_l4_test_time 7.161750555038452
Best AUC tensor(0.9864) 6
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 12660.572236299515
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base_pad80//dbpedia_14_lstmal_l5.pt
Test layer0 Acc 0.9748857142857142, AUC 0.9982832074165344, avg_entr 0.023525087162852287, f1 0.9748857021331787
l0_test_time 2.1290650367736816
Test layer1 Acc 0.9860571428571429, AUC 0.9988226890563965, avg_entr 0.00223714136518538, f1 0.9860571622848511
l1_test_time 3.215754508972168
Test layer2 Acc 0.9864571428571428, AUC 0.9987871050834656, avg_entr 0.0016847570659592748, f1 0.9864571690559387
l2_test_time 4.5808820724487305
Test layer3 Acc 0.9864857142857143, AUC 0.9986953735351562, avg_entr 0.0014750963309779763, f1 0.9864857196807861
l3_test_time 5.896780014038086
Test layer4 Acc 0.9864, AUC 0.998323917388916, avg_entr 0.001430580043233931, f1 0.9864000082015991
l4_test_time 7.127879858016968
