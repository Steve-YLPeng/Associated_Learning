total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 18.057863816
Start Training
gc 0
Train Epoch0 Acc 0.719875 (86385/120000), AUC 0.9132185578346252
ep0_train_time 160.294804025
Test Epoch0 layer4 Acc 0.9052631578947369, AUC 0.9799057245254517, avg_entr 0.12938740849494934, f1 0.9052631855010986
ep0_l4_test_time 1.5886758860000043
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.920075 (110409/120000), AUC 0.9813803434371948
ep1_train_time 178.13770449900002
Test Epoch1 layer4 Acc 0.9218421052631579, AUC 0.9825716018676758, avg_entr 0.05913226306438446, f1 0.921842098236084
ep1_l4_test_time 1.5813508830000274
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9316916666666667 (111803/120000), AUC 0.9859460592269897
ep2_train_time 178.18463295700002
Test Epoch2 layer4 Acc 0.9223684210526316, AUC 0.9838756322860718, avg_entr 0.038274966180324554, f1 0.9223684072494507
ep2_l4_test_time 1.5865878860000748
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9391083333333333 (112693/120000), AUC 0.9884093999862671
ep3_train_time 178.09979342499992
Test Epoch3 layer4 Acc 0.92, AUC 0.9836781024932861, avg_entr 0.030121739953756332, f1 0.9200000166893005
ep3_l4_test_time 1.5747898590000204
gc 0
Train Epoch4 Acc 0.943625 (113235/120000), AUC 0.990077793598175
ep4_train_time 159.92737847599994
Test Epoch4 layer4 Acc 0.9192105263157895, AUC 0.9820929169654846, avg_entr 0.022647760808467865, f1 0.9192105531692505
ep4_l4_test_time 1.5330728220000083
gc 0
Train Epoch5 Acc 0.9477666666666666 (113732/120000), AUC 0.9910289645195007
ep5_train_time 178.22123130399996
Test Epoch5 layer4 Acc 0.9189473684210526, AUC 0.9817723631858826, avg_entr 0.02063586190342903, f1 0.9189472794532776
ep5_l4_test_time 1.5391559419999794
gc 0
Train Epoch6 Acc 0.9512333333333334 (114148/120000), AUC 0.991584062576294
ep6_train_time 178.25151631900007
Test Epoch6 layer4 Acc 0.9168421052631579, AUC 0.982255756855011, avg_entr 0.020960155874490738, f1 0.9168421030044556
ep6_l4_test_time 1.5317569730000287
gc 0
Train Epoch7 Acc 0.954125 (114495/120000), AUC 0.9923733472824097
ep7_train_time 165.26268138399996
Test Epoch7 layer4 Acc 0.9160526315789473, AUC 0.9807296991348267, avg_entr 0.01857227087020874, f1 0.9160526394844055
ep7_l4_test_time 0.804379094000069
gc 0
Train Epoch8 Acc 0.9562833333333334 (114754/120000), AUC 0.9930188059806824
ep8_train_time 126.81932087399991
Test Epoch8 layer4 Acc 0.9134210526315789, AUC 0.9805291295051575, avg_entr 0.016822630539536476, f1 0.9134210348129272
ep8_l4_test_time 1.4947023580000405
gc 0
Train Epoch9 Acc 0.9584 (115008/120000), AUC 0.9934097528457642
ep9_train_time 112.46013224299986
Test Epoch9 layer4 Acc 0.9155263157894736, AUC 0.9796434640884399, avg_entr 0.01518449280411005, f1 0.9155263304710388
ep9_l4_test_time 0.7923556509999798
gc 0
Train Epoch10 Acc 0.96025 (115230/120000), AUC 0.9937678575515747
ep10_train_time 89.66296627399993
Test Epoch10 layer4 Acc 0.9139473684210526, AUC 0.9793355464935303, avg_entr 0.013182352297008038, f1 0.913947343826294
ep10_l4_test_time 0.7995082619997902
gc 0
Train Epoch11 Acc 0.9625666666666667 (115508/120000), AUC 0.9941327571868896
ep11_train_time 111.01287558400008
Test Epoch11 layer4 Acc 0.9157894736842105, AUC 0.9787510633468628, avg_entr 0.014083225280046463, f1 0.9157894849777222
ep11_l4_test_time 0.7973614579998412
gc 0
Train Epoch12 Acc 0.9639833333333333 (115678/120000), AUC 0.9944038987159729
ep12_train_time 132.573312622
Test Epoch12 layer4 Acc 0.9142105263157895, AUC 0.9784488081932068, avg_entr 0.012537752278149128, f1 0.9142104983329773
ep12_l4_test_time 1.1266448530000162
gc 0
Train Epoch13 Acc 0.966 (115920/120000), AUC 0.9946679472923279
ep13_train_time 128.08666349400005
Test Epoch13 layer4 Acc 0.9147368421052632, AUC 0.9779310822486877, avg_entr 0.01031432580202818, f1 0.9147368669509888
ep13_l4_test_time 1.5675773919997482
gc 0
Train Epoch14 Acc 0.96745 (116094/120000), AUC 0.9949389696121216
ep14_train_time 180.14579652200018
Test Epoch14 layer4 Acc 0.9126315789473685, AUC 0.976128876209259, avg_entr 0.00947092566639185, f1 0.9126315712928772
ep14_l4_test_time 1.598987305999799
gc 0
Train Epoch15 Acc 0.969325 (116319/120000), AUC 0.9950606226921082
ep15_train_time 179.70972016800033
Test Epoch15 layer4 Acc 0.9118421052631579, AUC 0.9774132370948792, avg_entr 0.008962479420006275, f1 0.9118421077728271
ep15_l4_test_time 1.5616151939998417
gc 0
Train Epoch16 Acc 0.9711666666666666 (116540/120000), AUC 0.9953916072845459
ep16_train_time 179.55551265600025
Test Epoch16 layer4 Acc 0.911578947368421, AUC 0.9746477603912354, avg_entr 0.008687593974173069, f1 0.9115789532661438
ep16_l4_test_time 1.6212463809997644
gc 0
Train Epoch17 Acc 0.9725083333333333 (116701/120000), AUC 0.9955548048019409
ep17_train_time 179.49696355700007
Test Epoch17 layer4 Acc 0.9102631578947369, AUC 0.9740350246429443, avg_entr 0.007038207724690437, f1 0.910263180732727
ep17_l4_test_time 1.5805388300000232
gc 0
Train Epoch18 Acc 0.9744583333333333 (116935/120000), AUC 0.9957011342048645
ep18_train_time 179.48083942200037
Test Epoch18 layer4 Acc 0.9102631578947369, AUC 0.9728277325630188, avg_entr 0.006067357957363129, f1 0.910263180732727
ep18_l4_test_time 1.5756605299998228
gc 0
Train Epoch19 Acc 0.9756 (117072/120000), AUC 0.9958426356315613
ep19_train_time 179.4493047840001
Test Epoch19 layer4 Acc 0.9089473684210526, AUC 0.9741775989532471, avg_entr 0.007861780002713203, f1 0.9089473485946655
ep19_l4_test_time 1.5042479899998398
gc 0
Train Epoch20 Acc 0.9771583333333334 (117259/120000), AUC 0.9960818290710449
ep20_train_time 179.67658025799983
Test Epoch20 layer4 Acc 0.9071052631578947, AUC 0.9731858372688293, avg_entr 0.008218355476856232, f1 0.9071052670478821
ep20_l4_test_time 1.6074015179997332
gc 0
Train Epoch21 Acc 0.9781583333333334 (117379/120000), AUC 0.9961925745010376
ep21_train_time 175.8054710069996
Test Epoch21 layer4 Acc 0.9086842105263158, AUC 0.9731321334838867, avg_entr 0.006086158566176891, f1 0.9086841940879822
ep21_l4_test_time 0.7841135660000873
gc 0
Train Epoch22 Acc 0.9795 (117540/120000), AUC 0.9962508678436279
ep22_train_time 164.3788989239997
Test Epoch22 layer4 Acc 0.9039473684210526, AUC 0.9706212878227234, avg_entr 0.006018665619194508, f1 0.9039472937583923
ep22_l4_test_time 1.477784832999987
gc 0
Train Epoch23 Acc 0.9809083333333334 (117709/120000), AUC 0.9963939785957336
ep23_train_time 179.35172662700006
Test Epoch23 layer4 Acc 0.9078947368421053, AUC 0.9718515872955322, avg_entr 0.007992878556251526, f1 0.9078947901725769
ep23_l4_test_time 1.48666054899968
gc 0
Train Epoch24 Acc 0.9820166666666666 (117842/120000), AUC 0.9964815378189087
ep24_train_time 179.46546449699963
Test Epoch24 layer4 Acc 0.9097368421052632, AUC 0.9687727093696594, avg_entr 0.006502129603177309, f1 0.9097368717193604
ep24_l4_test_time 1.5323897670000406
gc 0
Train Epoch25 Acc 0.9831333333333333 (117976/120000), AUC 0.9964730143547058
ep25_train_time 179.303624055
Test Epoch25 layer4 Acc 0.9084210526315789, AUC 0.9688537120819092, avg_entr 0.006876499857753515, f1 0.9084210395812988
ep25_l4_test_time 1.4733537459997024
gc 0
Train Epoch26 Acc 0.984125 (118095/120000), AUC 0.9967032670974731
ep26_train_time 179.32782850200056
Test Epoch26 layer4 Acc 0.905, AUC 0.968615710735321, avg_entr 0.006883171387016773, f1 0.9049999117851257
ep26_l4_test_time 1.5306969059993207
gc 0
Train Epoch27 Acc 0.9847166666666667 (118166/120000), AUC 0.996772050857544
ep27_train_time 179.46027314099956
Test Epoch27 layer4 Acc 0.9047368421052632, AUC 0.9677672386169434, avg_entr 0.005691497586667538, f1 0.9047367572784424
ep27_l4_test_time 1.583284256999832
gc 0
Train Epoch28 Acc 0.9857083333333333 (118285/120000), AUC 0.9968701601028442
ep28_train_time 179.26069666200056
Test Epoch28 layer4 Acc 0.9039473684210526, AUC 0.96728515625, avg_entr 0.00575236277654767, f1 0.9039472937583923
ep28_l4_test_time 1.53205513300054
gc 0
Train Epoch29 Acc 0.9864333333333334 (118372/120000), AUC 0.9970341920852661
ep29_train_time 111.90138736099925
Test Epoch29 layer4 Acc 0.906578947368421, AUC 0.96739661693573, avg_entr 0.005314220674335957, f1 0.9065789580345154
ep29_l4_test_time 0.7853691629998139
Best AUC tensor(0.9224) 2
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 4906.0417417749995
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt
gc 10
Test layer0 Acc 0.911578947368421, AUC 0.9794198870658875, avg_entr 0.11334957182407379, f1 0.9115789532661438
l0_test_time 0.15992550800001482
gc 0
Test layer1 Acc 0.9139473684210526, AUC 0.98316490650177, avg_entr 0.04315450042486191, f1 0.913947343826294
l1_test_time 0.2913625609999144
gc 0
Test layer2 Acc 0.9147368421052632, AUC 0.9835560917854309, avg_entr 0.04036220908164978, f1 0.9147368669509888
l2_test_time 0.4565893300004973
gc 0
Test layer3 Acc 0.9155263157894736, AUC 0.9812518358230591, avg_entr 0.040817927569150925, f1 0.9155263304710388
l3_test_time 0.6207611950003411
gc 0
Test layer4 Acc 0.9144736842105263, AUC 0.9818150401115417, avg_entr 0.042617443948984146, f1 0.9144737124443054
l4_test_time 0.7832959220004341
gc 0
Test threshold 0.1 Acc 0.9139473684210526, AUC 0.9781017303466797, avg_entr 0.03900682181119919, f1 0.913947343826294
t0.1_test_time 0.5001272210001844
gc 0
Test threshold 0.2 Acc 0.9131578947368421, AUC 0.9779135584831238, avg_entr 0.047081463038921356, f1 0.9131578803062439
t0.2_test_time 0.48792343300010543
gc 0
Test threshold 0.3 Acc 0.9113157894736842, AUC 0.9782147407531738, avg_entr 0.0578276552259922, f1 0.9113157987594604
t0.3_test_time 0.46769565800059354
gc 0
Test threshold 0.4 Acc 0.9134210526315789, AUC 0.9791845083236694, avg_entr 0.07114750146865845, f1 0.9134210348129272
t0.4_test_time 0.334859186000358
gc 0
Test threshold 0.5 Acc 0.9121052631578948, AUC 0.9792848825454712, avg_entr 0.07983143627643585, f1 0.9121052622795105
t0.5_test_time 0.21023829500063584
gc 0
Test threshold 0.6 Acc 0.911578947368421, AUC 0.9794198870658875, avg_entr 0.08176442980766296, f1 0.9115789532661438
t0.6_test_time 0.16287122900030226
gc 0
Test threshold 0.7 Acc 0.911578947368421, AUC 0.9794198870658875, avg_entr 0.08176442980766296, f1 0.9115789532661438
t0.7_test_time 0.1639382729999852
gc 0
Test threshold 0.8 Acc 0.911578947368421, AUC 0.9794198870658875, avg_entr 0.08176442980766296, f1 0.9115789532661438
t0.8_test_time 0.16337919199941098
gc 0
Test threshold 0.9 Acc 0.911578947368421, AUC 0.9794198870658875, avg_entr 0.08176442980766296, f1 0.9115789532661438
t0.9_test_time 0.16179612600080873
