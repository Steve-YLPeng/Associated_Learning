total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 20.981226003
Start Training
gc 0
Train Epoch0 Acc 0.725775 (87093/120000), AUC 0.9170021414756775
ep0_train_time 201.358218555
Test Epoch0 layer4 Acc 0.9071052631578947, AUC 0.9809346199035645, avg_entr 0.11578001827001572, f1 0.9071052670478821
ep0_l4_test_time 1.9913337380000087
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9201333333333334 (110416/120000), AUC 0.9821561574935913
ep1_train_time 214.69830745
Test Epoch1 layer4 Acc 0.9181578947368421, AUC 0.9838983416557312, avg_entr 0.05524520203471184, f1 0.9181578755378723
ep1_l4_test_time 1.9904512809999915
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9320916666666667 (111851/120000), AUC 0.986640453338623
ep2_train_time 216.04678234899995
Test Epoch2 layer4 Acc 0.9226315789473685, AUC 0.9842730164527893, avg_entr 0.036234136670827866, f1 0.922631561756134
ep2_l4_test_time 1.7513349960000824
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.939325 (112719/120000), AUC 0.9890693426132202
ep3_train_time 215.250856463
Test Epoch3 layer4 Acc 0.9210526315789473, AUC 0.985207200050354, avg_entr 0.02776591293513775, f1 0.9210526347160339
ep3_l4_test_time 1.7738666110000167
gc 0
Train Epoch4 Acc 0.9442 (113304/120000), AUC 0.9903020858764648
ep4_train_time 215.56937384799994
Test Epoch4 layer4 Acc 0.9197368421052632, AUC 0.9837703704833984, avg_entr 0.022140923887491226, f1 0.9197368621826172
ep4_l4_test_time 1.7756841039999927
gc 0
Train Epoch5 Acc 0.9477416666666667 (113729/120000), AUC 0.9915374517440796
ep5_train_time 214.8197445379999
Test Epoch5 layer4 Acc 0.9202631578947369, AUC 0.9823331832885742, avg_entr 0.020882882177829742, f1 0.9202631711959839
ep5_l4_test_time 1.7907715200001348
gc 0
Train Epoch6 Acc 0.9512416666666667 (114149/120000), AUC 0.9920895099639893
ep6_train_time 181.08787865399995
Test Epoch6 layer4 Acc 0.9192105263157895, AUC 0.9823693037033081, avg_entr 0.016841426491737366, f1 0.9192105531692505
ep6_l4_test_time 1.57891878800001
gc 0
Train Epoch7 Acc 0.9536916666666667 (114443/120000), AUC 0.9926714301109314
ep7_train_time 179.62302534700007
Test Epoch7 layer4 Acc 0.9173684210526316, AUC 0.9811873435974121, avg_entr 0.017734764143824577, f1 0.9173683524131775
ep7_l4_test_time 1.56631341100001
gc 0
Train Epoch8 Acc 0.9560416666666667 (114725/120000), AUC 0.9931986331939697
ep8_train_time 179.81520583199995
Test Epoch8 layer4 Acc 0.916578947368421, AUC 0.9813302755355835, avg_entr 0.016291646286845207, f1 0.9165789484977722
ep8_l4_test_time 1.5331458590001148
gc 0
Train Epoch9 Acc 0.9584166666666667 (115010/120000), AUC 0.9934378266334534
ep9_train_time 179.81786982099993
Test Epoch9 layer4 Acc 0.92, AUC 0.9786186218261719, avg_entr 0.014491913840174675, f1 0.9200000166893005
ep9_l4_test_time 1.550183681000135
gc 0
Train Epoch10 Acc 0.9602916666666667 (115235/120000), AUC 0.9935723543167114
ep10_train_time 160.985956471
Test Epoch10 layer4 Acc 0.9176315789473685, AUC 0.9799091219902039, avg_entr 0.014312278479337692, f1 0.9176315665245056
ep10_l4_test_time 1.5908648509998784
gc 0
Train Epoch11 Acc 0.9623166666666667 (115478/120000), AUC 0.993672788143158
ep11_train_time 179.97909792500013
Test Epoch11 layer4 Acc 0.9134210526315789, AUC 0.9800162315368652, avg_entr 0.01375302579253912, f1 0.9134210348129272
ep11_l4_test_time 1.5505698729998585
gc 0
Train Epoch12 Acc 0.9643333333333334 (115720/120000), AUC 0.9938571453094482
ep12_train_time 179.48904260100016
Test Epoch12 layer4 Acc 0.9160526315789473, AUC 0.9777665138244629, avg_entr 0.013201226480305195, f1 0.9160526394844055
ep12_l4_test_time 1.5375216769998588
gc 0
Train Epoch13 Acc 0.9662083333333333 (115945/120000), AUC 0.993995189666748
ep13_train_time 179.4767736570002
Test Epoch13 layer4 Acc 0.9134210526315789, AUC 0.9765303730964661, avg_entr 0.011046363972127438, f1 0.9134210348129272
ep13_l4_test_time 1.5832146339998872
gc 0
Train Epoch14 Acc 0.967825 (116139/120000), AUC 0.9942243099212646
ep14_train_time 179.47495460000027
Test Epoch14 layer4 Acc 0.9131578947368421, AUC 0.9772480726242065, avg_entr 0.010321824811398983, f1 0.9131578803062439
ep14_l4_test_time 1.5661863949999315
gc 0
Train Epoch15 Acc 0.969875 (116385/120000), AUC 0.9941499829292297
ep15_train_time 179.5179223109999
Test Epoch15 layer4 Acc 0.9110526315789473, AUC 0.9748210906982422, avg_entr 0.008492963388562202, f1 0.9110526442527771
ep15_l4_test_time 1.548182178999923
gc 0
Train Epoch16 Acc 0.9709583333333334 (116515/120000), AUC 0.994282603263855
ep16_train_time 179.78459500000008
Test Epoch16 layer4 Acc 0.9136842105263158, AUC 0.9755714535713196, avg_entr 0.008888449519872665, f1 0.9136841893196106
ep16_l4_test_time 1.566645446000166
gc 0
Train Epoch17 Acc 0.9731833333333333 (116782/120000), AUC 0.9944645166397095
ep17_train_time 180.01991925599987
Test Epoch17 layer4 Acc 0.9097368421052632, AUC 0.9744047522544861, avg_entr 0.007826629094779491, f1 0.9097368717193604
ep17_l4_test_time 1.5617199770003936
gc 0
Train Epoch18 Acc 0.9743916666666667 (116927/120000), AUC 0.9946610927581787
ep18_train_time 179.7793287669997
Test Epoch18 layer4 Acc 0.9089473684210526, AUC 0.9725608825683594, avg_entr 0.006835727486759424, f1 0.9089473485946655
ep18_l4_test_time 1.5917057520000526
gc 0
Train Epoch19 Acc 0.9765333333333334 (117184/120000), AUC 0.9948080778121948
ep19_train_time 161.2754226689999
Test Epoch19 layer4 Acc 0.908157894736842, AUC 0.9700677394866943, avg_entr 0.006014913320541382, f1 0.9081578850746155
ep19_l4_test_time 1.5703355020000345
gc 0
Train Epoch20 Acc 0.9774833333333334 (117298/120000), AUC 0.9949043989181519
ep20_train_time 179.71925281099993
Test Epoch20 layer4 Acc 0.9073684210526316, AUC 0.9700648188591003, avg_entr 0.006763525307178497, f1 0.9073684215545654
ep20_l4_test_time 1.5589778020002996
gc 0
Train Epoch21 Acc 0.979225 (117507/120000), AUC 0.9950647354125977
ep21_train_time 179.69073626099998
Test Epoch21 layer4 Acc 0.9071052631578947, AUC 0.9716454148292542, avg_entr 0.005925087723881006, f1 0.9071052670478821
ep21_l4_test_time 1.5655009689999133
gc 0
Train Epoch22 Acc 0.980275 (117633/120000), AUC 0.995159924030304
ep22_train_time 179.5771075900002
Test Epoch22 layer4 Acc 0.9047368421052632, AUC 0.9682440757751465, avg_entr 0.005204510875046253, f1 0.9047367572784424
ep22_l4_test_time 1.5740600179997273
gc 0
Train Epoch23 Acc 0.9811833333333333 (117742/120000), AUC 0.9953190088272095
ep23_train_time 180.03720433700073
Test Epoch23 layer4 Acc 0.9042105263157895, AUC 0.9677746295928955, avg_entr 0.004756148438900709, f1 0.9042104482650757
ep23_l4_test_time 1.50424895299966
gc 0
Train Epoch24 Acc 0.9823583333333333 (117883/120000), AUC 0.9953399896621704
ep24_train_time 179.92547681400083
Test Epoch24 layer4 Acc 0.908157894736842, AUC 0.9690896272659302, avg_entr 0.005467159673571587, f1 0.9081578850746155
ep24_l4_test_time 1.5940578260006077
gc 0
Train Epoch25 Acc 0.9836916666666666 (118043/120000), AUC 0.995638906955719
ep25_train_time 179.59969175199967
Test Epoch25 layer4 Acc 0.9044736842105263, AUC 0.9666584134101868, avg_entr 0.006353992968797684, f1 0.9044736623764038
ep25_l4_test_time 1.5801390850001553
gc 0
Train Epoch26 Acc 0.9844583333333333 (118135/120000), AUC 0.9957888126373291
ep26_train_time 179.71251837700038
Test Epoch26 layer4 Acc 0.9042105263157895, AUC 0.9671717882156372, avg_entr 0.0052254595793783665, f1 0.9042104482650757
ep26_l4_test_time 1.5412555019993306
gc 0
Train Epoch27 Acc 0.9853833333333334 (118246/120000), AUC 0.9959731101989746
ep27_train_time 179.74735088200032
Test Epoch27 layer4 Acc 0.9060526315789473, AUC 0.9678661227226257, avg_entr 0.0053521511144936085, f1 0.9060525894165039
ep27_l4_test_time 1.5768334060003326
gc 0
Train Epoch28 Acc 0.9859833333333333 (118318/120000), AUC 0.996113657951355
ep28_train_time 179.78428234700004
Test Epoch28 layer4 Acc 0.9057894736842105, AUC 0.9665887951850891, avg_entr 0.005876421462744474, f1 0.9057894945144653
ep28_l4_test_time 1.5372162100002242
gc 0
Train Epoch29 Acc 0.9866 (118392/120000), AUC 0.9963318109512329
ep29_train_time 153.99978649199966
Test Epoch29 layer4 Acc 0.9034210526315789, AUC 0.967721164226532, avg_entr 0.0053972359746694565, f1 0.9034210443496704
ep29_l4_test_time 1.574423516999559
Best AUC tensor(0.9226) 2
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 5579.86918474
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9121052631578948, AUC 0.9790406227111816, avg_entr 0.11369918286800385, f1 0.9121052622795105
l0_test_time 0.3024656480001795
gc 0
Test layer1 Acc 0.9121052631578948, AUC 0.9828243851661682, avg_entr 0.04388822987675667, f1 0.9121052622795105
l1_test_time 0.5568665309992866
gc 0
Test layer2 Acc 0.9110526315789473, AUC 0.9834246635437012, avg_entr 0.040262434631586075, f1 0.9110526442527771
l2_test_time 0.9124514380000619
gc 0
Test layer3 Acc 0.911578947368421, AUC 0.9831938147544861, avg_entr 0.03873730078339577, f1 0.9115789532661438
l3_test_time 1.225885016000575
gc 0
Test layer4 Acc 0.9107894736842105, AUC 0.9831117391586304, avg_entr 0.04046960920095444, f1 0.9107894897460938
l4_test_time 1.5562796209997032
gc 0
Test threshold 0.1 Acc 0.9107894736842105, AUC 0.9782896041870117, avg_entr 0.03837110474705696, f1 0.9107894897460938
t0.1_test_time 2.009366979999868
gc 0
Test threshold 0.2 Acc 0.9105263157894737, AUC 0.9778153896331787, avg_entr 0.04631142318248749, f1 0.9105263352394104
t0.2_test_time 1.8731292880002002
gc 0
Test threshold 0.3 Acc 0.91, AUC 0.9780516624450684, avg_entr 0.05807730555534363, f1 0.9100000262260437
t0.3_test_time 1.7734014140005456
gc 0
Test threshold 0.4 Acc 0.9107894736842105, AUC 0.9791355133056641, avg_entr 0.07297590374946594, f1 0.9107894897460938
t0.4_test_time 1.3036489449996225
gc 0
Test threshold 0.5 Acc 0.9118421052631579, AUC 0.9789776802062988, avg_entr 0.08036327362060547, f1 0.9118421077728271
t0.5_test_time 0.6794466999999713
gc 0
Test threshold 0.6 Acc 0.9121052631578948, AUC 0.9790406227111816, avg_entr 0.08201661705970764, f1 0.9121052622795105
t0.6_test_time 0.574550160000399
gc 0
Test threshold 0.7 Acc 0.9121052631578948, AUC 0.9790406227111816, avg_entr 0.08201661705970764, f1 0.9121052622795105
t0.7_test_time 0.45619585599979473
gc 0
Test threshold 0.8 Acc 0.9121052631578948, AUC 0.9790406227111816, avg_entr 0.08201661705970764, f1 0.9121052622795105
t0.8_test_time 0.3947485680000682
gc 0
Test threshold 0.9 Acc 0.9121052631578948, AUC 0.9790406227111816, avg_entr 0.08201661705970764, f1 0.9121052622795105
t0.9_test_time 0.5967149469997821
