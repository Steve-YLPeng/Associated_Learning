total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 25.246663191
Start Training
gc 0
Train Epoch0 Acc 0.4936 (19744/40000), AUC 0.4912658631801605
ep0_train_time 14.681108032000001
Test Epoch0 layer4 Acc 0.4896, AUC 0.44128483533859253, avg_entr 0.697856605052948, f1 0.48959997296333313
ep0_l4_test_time 0.8418080570000015
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.547875 (21915/40000), AUC 0.5820894241333008
ep1_train_time 12.232987562999995
Test Epoch1 layer4 Acc 0.7102, AUC 0.8916440010070801, avg_entr 0.6848191022872925, f1 0.7102000117301941
ep1_l4_test_time 0.8277198740000031
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.84535 (33814/40000), AUC 0.9061341285705566
ep2_train_time 12.184708505000003
Test Epoch2 layer4 Acc 0.869, AUC 0.9405776262283325, avg_entr 0.2656313180923462, f1 0.8690000176429749
ep2_l4_test_time 0.8589942300000075
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.893775 (35751/40000), AUC 0.9571477174758911
ep3_train_time 12.11863094799999
Test Epoch3 layer4 Acc 0.8878, AUC 0.9512908458709717, avg_entr 0.20968064665794373, f1 0.8877999782562256
ep3_l4_test_time 0.8412453950000014
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.913825 (36553/40000), AUC 0.9705390930175781
ep4_train_time 12.142122999000009
Test Epoch4 layer4 Acc 0.8846, AUC 0.955938458442688, avg_entr 0.1764371544122696, f1 0.8845999836921692
ep4_l4_test_time 0.8213533659999968
gc 0
Train Epoch5 Acc 0.924 (36960/40000), AUC 0.9763208627700806
ep5_train_time 12.032347068999997
Test Epoch5 layer4 Acc 0.896, AUC 0.958824634552002, avg_entr 0.1608225554227829, f1 0.8960000276565552
ep5_l4_test_time 0.8227985989999951
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.933725 (37349/40000), AUC 0.9812084436416626
ep6_train_time 11.98810447400001
Test Epoch6 layer4 Acc 0.8954, AUC 0.9595637917518616, avg_entr 0.13371965289115906, f1 0.8953999876976013
ep6_l4_test_time 0.8093257799999947
gc 0
Train Epoch7 Acc 0.938225 (37529/40000), AUC 0.9834313988685608
ep7_train_time 11.826822873999987
Test Epoch7 layer4 Acc 0.8998, AUC 0.9598982334136963, avg_entr 0.11204134672880173, f1 0.8998000025749207
ep7_l4_test_time 0.8374728750000031
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9455 (37820/40000), AUC 0.9863165020942688
ep8_train_time 11.68632696200001
Test Epoch8 layer4 Acc 0.8974, AUC 0.9603592753410339, avg_entr 0.09209626168012619, f1 0.8974000215530396
ep8_l4_test_time 0.7964541759999975
gc 0
Train Epoch9 Acc 0.9495 (37980/40000), AUC 0.9880415201187134
ep9_train_time 11.938870275
Test Epoch9 layer4 Acc 0.899, AUC 0.9598316550254822, avg_entr 0.07445849478244781, f1 0.8989999890327454
ep9_l4_test_time 0.8021204119999936
gc 0
Train Epoch10 Acc 0.9536 (38144/40000), AUC 0.9894116520881653
ep10_train_time 11.817772453999993
Test Epoch10 layer4 Acc 0.8966, AUC 0.9589475393295288, avg_entr 0.058638475835323334, f1 0.8966000080108643
ep10_l4_test_time 0.8044201549999741
gc 0
Train Epoch11 Acc 0.95665 (38266/40000), AUC 0.9903890490531921
ep11_train_time 11.942080898
Test Epoch11 layer4 Acc 0.8958, AUC 0.9564460515975952, avg_entr 0.05081756412982941, f1 0.895799994468689
ep11_l4_test_time 0.8092259830000046
gc 0
Train Epoch12 Acc 0.959725 (38389/40000), AUC 0.9913797378540039
ep12_train_time 11.705770515000012
Test Epoch12 layer4 Acc 0.8952, AUC 0.9530908465385437, avg_entr 0.04533777013421059, f1 0.8952000141143799
ep12_l4_test_time 0.8336236240000119
gc 0
Train Epoch13 Acc 0.961175 (38447/40000), AUC 0.9918785691261292
ep13_train_time 11.686908963999997
Test Epoch13 layer4 Acc 0.8942, AUC 0.9492677450180054, avg_entr 0.041286401450634, f1 0.8942000269889832
ep13_l4_test_time 0.8177473469999939
gc 0
Train Epoch14 Acc 0.963725 (38549/40000), AUC 0.9925550222396851
ep14_train_time 11.754414685
Test Epoch14 layer4 Acc 0.8868, AUC 0.9467812180519104, avg_entr 0.03890806436538696, f1 0.8867999911308289
ep14_l4_test_time 0.8064840229999959
gc 0
Train Epoch15 Acc 0.966325 (38653/40000), AUC 0.9934048056602478
ep15_train_time 11.650671023000001
Test Epoch15 layer4 Acc 0.887, AUC 0.9459072351455688, avg_entr 0.03454665467143059, f1 0.8870000243186951
ep15_l4_test_time 0.820912715999981
gc 0
Train Epoch16 Acc 0.967875 (38715/40000), AUC 0.994198203086853
ep16_train_time 11.598927629999991
Test Epoch16 layer4 Acc 0.8864, AUC 0.9452778100967407, avg_entr 0.033641185611486435, f1 0.8863999843597412
ep16_l4_test_time 0.8145721390000062
gc 0
Train Epoch17 Acc 0.969225 (38769/40000), AUC 0.9945884943008423
ep17_train_time 11.464503186999991
Test Epoch17 layer4 Acc 0.8826, AUC 0.9450404047966003, avg_entr 0.03199353814125061, f1 0.8826000094413757
ep17_l4_test_time 0.8250148360000367
gc 0
Train Epoch18 Acc 0.9707 (38828/40000), AUC 0.9951179027557373
ep18_train_time 11.341422817000023
Test Epoch18 layer4 Acc 0.8812, AUC 0.9433159232139587, avg_entr 0.029154369607567787, f1 0.8812000155448914
ep18_l4_test_time 0.864641124000002
gc 0
Train Epoch19 Acc 0.972875 (38915/40000), AUC 0.9957231879234314
ep19_train_time 11.640314975999956
Test Epoch19 layer4 Acc 0.8788, AUC 0.9413852691650391, avg_entr 0.026563921943306923, f1 0.8787999749183655
ep19_l4_test_time 0.8543694319999986
Best AUC tensor(0.8998) 7
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 257.285656851
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.888, AUC 0.9555680751800537, avg_entr 0.1847354769706726, f1 0.8880000114440918
l0_test_time 0.824208026000008
gc 0
Test layer1 Acc 0.8884, AUC 0.9557957649230957, avg_entr 0.16627894341945648, f1 0.8884000182151794
l1_test_time 0.8491499520000048
gc 0
Test layer2 Acc 0.8884, AUC 0.9561328887939453, avg_entr 0.15251170098781586, f1 0.8884000182151794
l2_test_time 0.8681464129999767
gc 0
Test layer3 Acc 0.8898, AUC 0.9562574625015259, avg_entr 0.13649407029151917, f1 0.8898000121116638
l3_test_time 0.8233836389999851
gc 0
Test layer4 Acc 0.8908, AUC 0.9565774202346802, avg_entr 0.1140855923295021, f1 0.8907999992370605
l4_test_time 0.8068395999999893
gc 0
Test threshold 0.1 Acc 0.8908, AUC 0.9551775455474854, avg_entr 0.17835639417171478, f1 0.8907999992370605
t0.1_test_time 1.9821410209999613
gc 0
Test threshold 0.2 Acc 0.8908, AUC 0.9555678367614746, avg_entr 0.19313372671604156, f1 0.8907999992370605
t0.2_test_time 2.247952822000002
gc 0
Test threshold 0.3 Acc 0.8908, AUC 0.955161988735199, avg_entr 0.20689131319522858, f1 0.8907999992370605
t0.3_test_time 2.2744921450000106
gc 0
Test threshold 0.4 Acc 0.8908, AUC 0.9550459384918213, avg_entr 0.21902883052825928, f1 0.8907999992370605
t0.4_test_time 2.3209467270000346
gc 0
Test threshold 0.5 Acc 0.8908, AUC 0.955047607421875, avg_entr 0.23052263259887695, f1 0.8907999992370605
t0.5_test_time 2.3392848820000154
gc 0
Test threshold 0.6 Acc 0.8908, AUC 0.954720675945282, avg_entr 0.2412564754486084, f1 0.8907999992370605
t0.6_test_time 2.4764758540000003
gc 0
Test threshold 0.7 Acc 0.8908, AUC 0.9551652073860168, avg_entr 0.2496880441904068, f1 0.8907999992370605
t0.7_test_time 2.4420040539999945
gc 0
Test threshold 0.8 Acc 0.8908, AUC 0.9553981423377991, avg_entr 0.25712859630584717, f1 0.8907999992370605
t0.8_test_time 2.3759775390000186
gc 0
Test threshold 0.9 Acc 0.8908, AUC 0.9551973342895508, avg_entr 0.2629261314868927, f1 0.8907999992370605
t0.9_test_time 2.3622313089999807
