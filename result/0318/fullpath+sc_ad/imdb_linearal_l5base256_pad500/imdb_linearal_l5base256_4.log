total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 24.851336964
Start Training
gc 0
Train Epoch0 Acc 0.5044 (20176/40000), AUC 0.5103588104248047
ep0_train_time 13.189353012999998
Test Epoch0 layer4 Acc 0.5, AUC 0.5705245137214661, avg_entr 0.6882458925247192, f1 0.5
ep0_l4_test_time 0.7935927239999998
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.5582 (22328/40000), AUC 0.6146621704101562
ep1_train_time 11.029463821999997
Test Epoch1 layer4 Acc 0.7514, AUC 0.860599160194397, avg_entr 0.6940387487411499, f1 0.7513999938964844
ep1_l4_test_time 0.7589710999999966
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.8138 (32552/40000), AUC 0.8882312178611755
ep2_train_time 11.258865798000002
Test Epoch2 layer4 Acc 0.8038, AUC 0.9403775930404663, avg_entr 0.2416372001171112, f1 0.8037999868392944
ep2_l4_test_time 0.812085960999994
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.893675 (35747/40000), AUC 0.9573351144790649
ep3_train_time 11.21564715800001
Test Epoch3 layer4 Acc 0.8908, AUC 0.9514946937561035, avg_entr 0.22707046568393707, f1 0.8907999992370605
ep3_l4_test_time 0.7915570930000086
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.912175 (36487/40000), AUC 0.969834566116333
ep4_train_time 10.975445639
Test Epoch4 layer4 Acc 0.8724, AUC 0.9566038846969604, avg_entr 0.18587414920330048, f1 0.8723999857902527
ep4_l4_test_time 0.8007316209999971
gc 0
Train Epoch5 Acc 0.922775 (36911/40000), AUC 0.9757952690124512
ep5_train_time 10.872728249999994
Test Epoch5 layer4 Acc 0.8924, AUC 0.958869457244873, avg_entr 0.16981172561645508, f1 0.8923999667167664
ep5_l4_test_time 0.7937158000000011
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.932225 (37289/40000), AUC 0.9803143739700317
ep6_train_time 11.152684219000008
Test Epoch6 layer4 Acc 0.9, AUC 0.9598295092582703, avg_entr 0.13637152314186096, f1 0.8999999761581421
ep6_l4_test_time 0.8098917040000089
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.93835 (37534/40000), AUC 0.9838768243789673
ep7_train_time 11.100786829
Test Epoch7 layer4 Acc 0.8888, AUC 0.959693431854248, avg_entr 0.11700636148452759, f1 0.8888000249862671
ep7_l4_test_time 0.8061360680000007
gc 0
Train Epoch8 Acc 0.94395 (37758/40000), AUC 0.9858739972114563
ep8_train_time 11.298598968999997
Test Epoch8 layer4 Acc 0.8988, AUC 0.9596307277679443, avg_entr 0.09627000987529755, f1 0.8988000154495239
ep8_l4_test_time 0.8015576610000039
gc 0
Train Epoch9 Acc 0.948675 (37947/40000), AUC 0.9878833889961243
ep9_train_time 11.646360909999999
Test Epoch9 layer4 Acc 0.8918, AUC 0.9592593908309937, avg_entr 0.08008310198783875, f1 0.8917999863624573
ep9_l4_test_time 0.8033842410000034
gc 0
Train Epoch10 Acc 0.9518 (38072/40000), AUC 0.9890543222427368
ep10_train_time 11.897498108000008
Test Epoch10 layer4 Acc 0.8938, AUC 0.9588257074356079, avg_entr 0.06684504449367523, f1 0.8938000202178955
ep10_l4_test_time 0.8132386420000159
gc 0
Train Epoch11 Acc 0.95655 (38262/40000), AUC 0.9905739426612854
ep11_train_time 11.86605301100002
Test Epoch11 layer4 Acc 0.8904, AUC 0.9579378366470337, avg_entr 0.06515365839004517, f1 0.8903999924659729
ep11_l4_test_time 0.8168532200000129
gc 0
Train Epoch12 Acc 0.958775 (38351/40000), AUC 0.9914941787719727
ep12_train_time 11.634638492000022
Test Epoch12 layer4 Acc 0.8948, AUC 0.955827534198761, avg_entr 0.05389804020524025, f1 0.8948000073432922
ep12_l4_test_time 0.8081665630000145
gc 0
Train Epoch13 Acc 0.961475 (38459/40000), AUC 0.992163896560669
ep13_train_time 11.43116485600001
Test Epoch13 layer4 Acc 0.8912, AUC 0.953238844871521, avg_entr 0.048208948224782944, f1 0.8912000060081482
ep13_l4_test_time 0.7935643330000062
gc 0
Train Epoch14 Acc 0.96355 (38542/40000), AUC 0.9929804801940918
ep14_train_time 11.51105928199999
Test Epoch14 layer4 Acc 0.8896, AUC 0.9493774175643921, avg_entr 0.04433884099125862, f1 0.8895999193191528
ep14_l4_test_time 0.8114101540000149
gc 0
Train Epoch15 Acc 0.96585 (38634/40000), AUC 0.9934293031692505
ep15_train_time 11.563817268999998
Test Epoch15 layer4 Acc 0.8888, AUC 0.947421669960022, avg_entr 0.042280662804841995, f1 0.8888000249862671
ep15_l4_test_time 0.8101719470000148
gc 0
Train Epoch16 Acc 0.9677 (38708/40000), AUC 0.9939322471618652
ep16_train_time 11.264918383000008
Test Epoch16 layer4 Acc 0.8864, AUC 0.9450321197509766, avg_entr 0.03885456174612045, f1 0.8863999843597412
ep16_l4_test_time 0.7967812690000073
gc 0
Train Epoch17 Acc 0.9691 (38764/40000), AUC 0.9943532943725586
ep17_train_time 11.153607671999993
Test Epoch17 layer4 Acc 0.8822, AUC 0.940409243106842, avg_entr 0.03653430938720703, f1 0.8822000026702881
ep17_l4_test_time 0.7807433989999879
gc 0
Train Epoch18 Acc 0.9709 (38836/40000), AUC 0.99491947889328
ep18_train_time 11.286518349000033
Test Epoch18 layer4 Acc 0.8784, AUC 0.9423320293426514, avg_entr 0.035204581916332245, f1 0.8784000277519226
ep18_l4_test_time 0.8322398839999892
gc 0
Train Epoch19 Acc 0.97235 (38894/40000), AUC 0.9954713582992554
ep19_train_time 11.525011566999979
Test Epoch19 layer4 Acc 0.879, AUC 0.9408711194992065, avg_entr 0.032450586557388306, f1 0.8790000081062317
ep19_l4_test_time 0.8082226629999809
Best AUC tensor(0.9000) 6
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 246.227170901
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8984, AUC 0.9559851884841919, avg_entr 0.20132270455360413, f1 0.8984000086784363
l0_test_time 0.7865840540000022
gc 0
Test layer1 Acc 0.8972, AUC 0.9562418460845947, avg_entr 0.19029153883457184, f1 0.8971999883651733
l1_test_time 0.8060771159999831
gc 0
Test layer2 Acc 0.8968, AUC 0.9566622972488403, avg_entr 0.17196433246135712, f1 0.8967999815940857
l2_test_time 0.796475796999971
gc 0
Test layer3 Acc 0.8964, AUC 0.9569295644760132, avg_entr 0.16148900985717773, f1 0.896399974822998
l3_test_time 0.8190824950000319
gc 0
Test layer4 Acc 0.898, AUC 0.9569839239120483, avg_entr 0.13878105580806732, f1 0.8980000019073486
l4_test_time 0.7993017929999837
gc 0
Test threshold 0.1 Acc 0.898, AUC 0.9567822813987732, avg_entr 0.21229435503482819, f1 0.8980000019073486
t0.1_test_time 1.972127482000019
gc 0
Test threshold 0.2 Acc 0.898, AUC 0.9558242559432983, avg_entr 0.22537702322006226, f1 0.8980000019073486
t0.2_test_time 1.7774393870000154
gc 0
Test threshold 0.3 Acc 0.898, AUC 0.9561827182769775, avg_entr 0.2373022884130478, f1 0.8980000019073486
t0.3_test_time 1.8891903900000102
gc 0
Test threshold 0.4 Acc 0.898, AUC 0.95622718334198, avg_entr 0.2486719787120819, f1 0.8980000019073486
t0.4_test_time 1.870259764000025
gc 0
Test threshold 0.5 Acc 0.898, AUC 0.956146240234375, avg_entr 0.25818580389022827, f1 0.8980000019073486
t0.5_test_time 1.9253859909999846
gc 0
Test threshold 0.6 Acc 0.898, AUC 0.9557750225067139, avg_entr 0.2672065198421478, f1 0.8980000019073486
t0.6_test_time 1.8415616429999773
gc 0
Test threshold 0.7 Acc 0.898, AUC 0.955795168876648, avg_entr 0.27583131194114685, f1 0.8980000019073486
t0.7_test_time 1.7905032140000117
gc 0
Test threshold 0.8 Acc 0.898, AUC 0.9558162689208984, avg_entr 0.28227606415748596, f1 0.8980000019073486
t0.8_test_time 1.839466085999959
gc 0
Test threshold 0.9 Acc 0.898, AUC 0.9559680223464966, avg_entr 0.2874261438846588, f1 0.8980000019073486
t0.9_test_time 1.7315775499999972
