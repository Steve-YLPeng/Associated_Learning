total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 24.949669634
Start Training
gc 0
Train Epoch0 Acc 0.49835 (19934/40000), AUC 0.49305737018585205
ep0_train_time 13.434194481000002
Test Epoch0 layer4 Acc 0.4996, AUC 0.4548322558403015, avg_entr 0.6853352785110474, f1 0.49959999322891235
ep0_l4_test_time 0.8067560590000014
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.51625 (20650/40000), AUC 0.5311680436134338
ep1_train_time 11.291476195999998
Test Epoch1 layer4 Acc 0.7438, AUC 0.850156843662262, avg_entr 0.6935514807701111, f1 0.7437999248504639
ep1_l4_test_time 0.8020833360000026
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.81275 (32510/40000), AUC 0.8682868480682373
ep2_train_time 11.088163656000006
Test Epoch2 layer4 Acc 0.755, AUC 0.9385725259780884, avg_entr 0.25431546568870544, f1 0.7549999356269836
ep2_l4_test_time 0.7928641159999898
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.893175 (35727/40000), AUC 0.9564253091812134
ep3_train_time 10.891848959
Test Epoch3 layer4 Acc 0.8792, AUC 0.9512128829956055, avg_entr 0.22239069640636444, f1 0.8791999816894531
ep3_l4_test_time 0.770869102000006
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.912775 (36511/40000), AUC 0.9696211814880371
ep4_train_time 11.138501337000008
Test Epoch4 layer4 Acc 0.895, AUC 0.9561885595321655, avg_entr 0.19177111983299255, f1 0.8949999809265137
ep4_l4_test_time 0.7767329780000125
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9242 (36968/40000), AUC 0.976542592048645
ep5_train_time 11.085844877
Test Epoch5 layer4 Acc 0.896, AUC 0.9584418535232544, avg_entr 0.16038872301578522, f1 0.8960000276565552
ep5_l4_test_time 0.7812933339999972
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9333 (37332/40000), AUC 0.9806578159332275
ep6_train_time 10.911969877000004
Test Epoch6 layer4 Acc 0.8988, AUC 0.9594933986663818, avg_entr 0.13967743515968323, f1 0.8988000154495239
ep6_l4_test_time 0.782150786999992
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.938825 (37553/40000), AUC 0.9838482737541199
ep7_train_time 10.69176315499999
Test Epoch7 layer4 Acc 0.902, AUC 0.9597011208534241, avg_entr 0.11962349712848663, f1 0.9020000100135803
ep7_l4_test_time 0.7859436159999973
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.94285 (37714/40000), AUC 0.9857845306396484
ep8_train_time 11.107989270999994
Test Epoch8 layer4 Acc 0.8994, AUC 0.959145724773407, avg_entr 0.09934741258621216, f1 0.8993999361991882
ep8_l4_test_time 0.830045599000016
gc 0
Train Epoch9 Acc 0.948625 (37945/40000), AUC 0.9881239533424377
ep9_train_time 11.046013817000016
Test Epoch9 layer4 Acc 0.8982, AUC 0.9591329097747803, avg_entr 0.08222948014736176, f1 0.8981999754905701
ep9_l4_test_time 0.7996748070000024
gc 0
Train Epoch10 Acc 0.9524 (38096/40000), AUC 0.9894429445266724
ep10_train_time 10.828423332
Test Epoch10 layer4 Acc 0.8984, AUC 0.9591355323791504, avg_entr 0.0687643438577652, f1 0.8984000086784363
ep10_l4_test_time 0.8154064729999959
gc 0
Train Epoch11 Acc 0.9557 (38228/40000), AUC 0.990471601486206
ep11_train_time 10.746191414999998
Test Epoch11 layer4 Acc 0.8962, AUC 0.9572114944458008, avg_entr 0.05698201432824135, f1 0.8962000012397766
ep11_l4_test_time 0.7684634059999951
gc 0
Train Epoch12 Acc 0.9588 (38352/40000), AUC 0.9913069009780884
ep12_train_time 10.929230939000007
Test Epoch12 layer4 Acc 0.8942, AUC 0.9552314281463623, avg_entr 0.049317777156829834, f1 0.8942000269889832
ep12_l4_test_time 0.7915262559999974
gc 0
Train Epoch13 Acc 0.9609 (38436/40000), AUC 0.9918758869171143
ep13_train_time 10.99230661300001
Test Epoch13 layer4 Acc 0.8924, AUC 0.9528039693832397, avg_entr 0.04414118453860283, f1 0.8923999667167664
ep13_l4_test_time 0.7800244199999895
gc 0
Train Epoch14 Acc 0.9634 (38536/40000), AUC 0.9926352500915527
ep14_train_time 11.140078044000006
Test Epoch14 layer4 Acc 0.89, AUC 0.9503492116928101, avg_entr 0.041865624487400055, f1 0.8899999856948853
ep14_l4_test_time 0.7802676390000158
gc 0
Train Epoch15 Acc 0.96595 (38638/40000), AUC 0.9934903383255005
ep15_train_time 11.384625416999995
Test Epoch15 layer4 Acc 0.886, AUC 0.9469689130783081, avg_entr 0.03867678344249725, f1 0.8859999775886536
ep15_l4_test_time 0.8019132409999941
gc 0
Train Epoch16 Acc 0.96705 (38682/40000), AUC 0.9939793944358826
ep16_train_time 11.40897035499998
Test Epoch16 layer4 Acc 0.8874, AUC 0.9453955292701721, avg_entr 0.03669340908527374, f1 0.8873999714851379
ep16_l4_test_time 0.8036570040000015
gc 0
Train Epoch17 Acc 0.9695 (38780/40000), AUC 0.9945003986358643
ep17_train_time 11.631186716999991
Test Epoch17 layer4 Acc 0.8848, AUC 0.9435461759567261, avg_entr 0.03482542932033539, f1 0.8848000168800354
ep17_l4_test_time 0.8052230269999825
gc 0
Train Epoch18 Acc 0.971275 (38851/40000), AUC 0.9949446320533752
ep18_train_time 11.520833014000004
Test Epoch18 layer4 Acc 0.8794, AUC 0.9408718347549438, avg_entr 0.03066035732626915, f1 0.8794000148773193
ep18_l4_test_time 0.8028714210000203
gc 0
Train Epoch19 Acc 0.972125 (38885/40000), AUC 0.995383083820343
ep19_train_time 11.342853544999969
Test Epoch19 layer4 Acc 0.8818, AUC 0.9416995644569397, avg_entr 0.031471945345401764, f1 0.8818000555038452
ep19_l4_test_time 0.7703286330000196
Best AUC tensor(0.9020) 7
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 241.92588478699997
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8948, AUC 0.9558454751968384, avg_entr 0.19082529842853546, f1 0.8948000073432922
l0_test_time 0.7923779299999865
gc 0
Test layer1 Acc 0.895, AUC 0.9563707113265991, avg_entr 0.1683683693408966, f1 0.8949999809265137
l1_test_time 0.7990887540000244
gc 0
Test layer2 Acc 0.8948, AUC 0.9566363096237183, avg_entr 0.16166538000106812, f1 0.8948000073432922
l2_test_time 0.7832406329999912
gc 0
Test layer3 Acc 0.8946, AUC 0.9568473100662231, avg_entr 0.1470068395137787, f1 0.894599974155426
l3_test_time 0.7999205099999926
gc 0
Test layer4 Acc 0.895, AUC 0.9568593502044678, avg_entr 0.122794508934021, f1 0.8949999809265137
l4_test_time 0.7963170620000142
gc 0
Test threshold 0.1 Acc 0.895, AUC 0.9563205242156982, avg_entr 0.19054020941257477, f1 0.8949999809265137
t0.1_test_time 2.071835759999999
gc 0
Test threshold 0.2 Acc 0.895, AUC 0.9557939171791077, avg_entr 0.2037133276462555, f1 0.8949999809265137
t0.2_test_time 1.9868726830000014
gc 0
Test threshold 0.3 Acc 0.895, AUC 0.9557199478149414, avg_entr 0.21670575439929962, f1 0.8949999809265137
t0.3_test_time 2.0430775240000116
gc 0
Test threshold 0.4 Acc 0.895, AUC 0.9557355046272278, avg_entr 0.22903361916542053, f1 0.8949999809265137
t0.4_test_time 1.9275428589999706
gc 0
Test threshold 0.5 Acc 0.895, AUC 0.9554866552352905, avg_entr 0.24063564836978912, f1 0.8949999809265137
t0.5_test_time 2.006911774999992
gc 0
Test threshold 0.6 Acc 0.895, AUC 0.9554480314254761, avg_entr 0.25024616718292236, f1 0.8949999809265137
t0.6_test_time 2.002717998000037
gc 0
Test threshold 0.7 Acc 0.895, AUC 0.9558458924293518, avg_entr 0.25841426849365234, f1 0.8949999809265137
t0.7_test_time 1.9031060529999877
gc 0
Test threshold 0.8 Acc 0.895, AUC 0.9559438228607178, avg_entr 0.2653196454048157, f1 0.8949999809265137
t0.8_test_time 1.957414205999953
gc 0
Test threshold 0.9 Acc 0.895, AUC 0.955829381942749, avg_entr 0.27116650342941284, f1 0.8949999809265137
t0.9_test_time 1.968014021999977
