total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 25.436015976
Start Training
gc 0
Train Epoch0 Acc 0.5013 (20052/40000), AUC 0.49700379371643066
ep0_train_time 14.406394798000001
Test Epoch0 layer4 Acc 0.5, AUC 0.4718416929244995, avg_entr 0.6848276257514954, f1 0.5
ep0_l4_test_time 0.8348068300000051
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.500425 (20017/40000), AUC 0.4877975583076477
ep1_train_time 11.740884487999999
Test Epoch1 layer4 Acc 0.5344, AUC 0.679088830947876, avg_entr 0.6896849870681763, f1 0.5343999862670898
ep1_l4_test_time 0.8232607429999987
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.77295 (30918/40000), AUC 0.8619599938392639
ep2_train_time 12.131143269999995
Test Epoch2 layer4 Acc 0.8514, AUC 0.9411338567733765, avg_entr 0.2646912932395935, f1 0.8514000177383423
ep2_l4_test_time 0.7962941339999929
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.8973 (35892/40000), AUC 0.9596209526062012
ep3_train_time 11.820601738999997
Test Epoch3 layer4 Acc 0.889, AUC 0.9520156383514404, avg_entr 0.21010515093803406, f1 0.8889999985694885
ep3_l4_test_time 0.796464365999995
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.914675 (36587/40000), AUC 0.9715158939361572
ep4_train_time 11.813878160000002
Test Epoch4 layer4 Acc 0.894, AUC 0.9565231800079346, avg_entr 0.17553985118865967, f1 0.8939999938011169
ep4_l4_test_time 0.7932194019999912
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.925975 (37039/40000), AUC 0.9776034355163574
ep5_train_time 11.697794712000004
Test Epoch5 layer4 Acc 0.8972, AUC 0.958072304725647, avg_entr 0.14388039708137512, f1 0.8971999883651733
ep5_l4_test_time 0.8219843250000025
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9345 (37380/40000), AUC 0.9817847013473511
ep6_train_time 11.572109048000002
Test Epoch6 layer4 Acc 0.8996, AUC 0.9596391916275024, avg_entr 0.1246984526515007, f1 0.8996000289916992
ep6_l4_test_time 0.8088746399999991
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.940925 (37637/40000), AUC 0.9848288297653198
ep7_train_time 11.566186197999997
Test Epoch7 layer4 Acc 0.8978, AUC 0.9599320888519287, avg_entr 0.1040906012058258, f1 0.8978000283241272
ep7_l4_test_time 0.7932896809999761
gc 0
Train Epoch8 Acc 0.946425 (37857/40000), AUC 0.9869788289070129
ep8_train_time 11.329641111
Test Epoch8 layer4 Acc 0.898, AUC 0.9599164724349976, avg_entr 0.08608633279800415, f1 0.8980000019073486
ep8_l4_test_time 0.8322786020000024
gc 0
Train Epoch9 Acc 0.94985 (37994/40000), AUC 0.9885951280593872
ep9_train_time 11.509991420000006
Test Epoch9 layer4 Acc 0.8968, AUC 0.9596740007400513, avg_entr 0.07076340913772583, f1 0.8967999815940857
ep9_l4_test_time 0.7944008049999809
gc 0
Train Epoch10 Acc 0.954025 (38161/40000), AUC 0.9897664189338684
ep10_train_time 11.21278436
Test Epoch10 layer4 Acc 0.896, AUC 0.9585961103439331, avg_entr 0.0590314082801342, f1 0.8960000276565552
ep10_l4_test_time 0.8014304569999808
gc 0
Train Epoch11 Acc 0.95735 (38294/40000), AUC 0.9908899068832397
ep11_train_time 11.483961047999998
Test Epoch11 layer4 Acc 0.896, AUC 0.9557853937149048, avg_entr 0.05251031368970871, f1 0.8960000276565552
ep11_l4_test_time 0.8168819460000236
gc 0
Train Epoch12 Acc 0.959975 (38399/40000), AUC 0.9914553761482239
ep12_train_time 11.282513346000002
Test Epoch12 layer4 Acc 0.893, AUC 0.9531407356262207, avg_entr 0.04744468256831169, f1 0.8930000066757202
ep12_l4_test_time 0.7894232779999868
gc 0
Train Epoch13 Acc 0.962425 (38497/40000), AUC 0.9923126101493835
ep13_train_time 11.34288224399998
Test Epoch13 layer4 Acc 0.8902, AUC 0.9500746726989746, avg_entr 0.04236183315515518, f1 0.8902000188827515
ep13_l4_test_time 0.8100363300000026
gc 0
Train Epoch14 Acc 0.964625 (38585/40000), AUC 0.9928545951843262
ep14_train_time 11.339677438999985
Test Epoch14 layer4 Acc 0.881, AUC 0.9469949007034302, avg_entr 0.04358404502272606, f1 0.8809999823570251
ep14_l4_test_time 0.7551035220000131
gc 0
Train Epoch15 Acc 0.966675 (38667/40000), AUC 0.9934804439544678
ep15_train_time 11.161363290999986
Test Epoch15 layer4 Acc 0.8876, AUC 0.946325421333313, avg_entr 0.03827909007668495, f1 0.8876000046730042
ep15_l4_test_time 0.7964269990000048
gc 0
Train Epoch16 Acc 0.96795 (38718/40000), AUC 0.9943053126335144
ep16_train_time 11.235689682000014
Test Epoch16 layer4 Acc 0.8836, AUC 0.9421957731246948, avg_entr 0.035176150500774384, f1 0.8835999965667725
ep16_l4_test_time 0.8263741519999996
gc 0
Train Epoch17 Acc 0.96995 (38798/40000), AUC 0.9947919845581055
ep17_train_time 10.942951547999996
Test Epoch17 layer4 Acc 0.8834, AUC 0.9416007399559021, avg_entr 0.03275423124432564, f1 0.8834000825881958
ep17_l4_test_time 0.8306892760000153
gc 0
Train Epoch18 Acc 0.97095 (38838/40000), AUC 0.9950768351554871
ep18_train_time 11.229647823999983
Test Epoch18 layer4 Acc 0.8792, AUC 0.9399594068527222, avg_entr 0.03310050815343857, f1 0.8791999816894531
ep18_l4_test_time 0.8228787609999699
gc 0
Train Epoch19 Acc 0.9729 (38916/40000), AUC 0.9956258535385132
ep19_train_time 10.99421064400002
Test Epoch19 layer4 Acc 0.878, AUC 0.9362052083015442, avg_entr 0.029355768114328384, f1 0.878000020980835
ep19_l4_test_time 0.7958943819999718
Best AUC tensor(0.8996) 6
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 249.333827578
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8962, AUC 0.9555644989013672, avg_entr 0.20157593488693237, f1 0.8962000012397766
l0_test_time 0.8033227779999947
gc 0
Test layer1 Acc 0.8964, AUC 0.9560072422027588, avg_entr 0.18621781468391418, f1 0.896399974822998
l1_test_time 0.8153810839999664
gc 0
Test layer2 Acc 0.896, AUC 0.9562207460403442, avg_entr 0.17205922305583954, f1 0.8960000276565552
l2_test_time 0.8053149670000153
gc 0
Test layer3 Acc 0.8948, AUC 0.9563541412353516, avg_entr 0.15153905749320984, f1 0.8948000073432922
l3_test_time 0.8244288939999933
gc 0
Test layer4 Acc 0.8954, AUC 0.9565034508705139, avg_entr 0.1285126656293869, f1 0.8953999876976013
l4_test_time 0.8459075130000429
gc 0
Test threshold 0.1 Acc 0.8954, AUC 0.9555897116661072, avg_entr 0.1994207203388214, f1 0.8953999876976013
t0.1_test_time 2.0888051619999715
gc 0
Test threshold 0.2 Acc 0.8954, AUC 0.9554009437561035, avg_entr 0.21455883979797363, f1 0.8953999876976013
t0.2_test_time 1.90940944700003
gc 0
Test threshold 0.3 Acc 0.8954, AUC 0.9550749659538269, avg_entr 0.2282494157552719, f1 0.8953999876976013
t0.3_test_time 2.027116368999998
gc 0
Test threshold 0.4 Acc 0.8954, AUC 0.9545575380325317, avg_entr 0.24139828979969025, f1 0.8953999876976013
t0.4_test_time 1.8442913009999984
gc 0
Test threshold 0.5 Acc 0.8954, AUC 0.954621434211731, avg_entr 0.2535117566585541, f1 0.8953999876976013
t0.5_test_time 1.9021874069999853
gc 0
Test threshold 0.6 Acc 0.8954, AUC 0.9554283022880554, avg_entr 0.2636411488056183, f1 0.8953999876976013
t0.6_test_time 1.7656685150000158
gc 0
Test threshold 0.7 Acc 0.8954, AUC 0.9554229974746704, avg_entr 0.27317380905151367, f1 0.8953999876976013
t0.7_test_time 1.9081503019999673
gc 0
Test threshold 0.8 Acc 0.8954, AUC 0.9553731679916382, avg_entr 0.28046923875808716, f1 0.8953999876976013
t0.8_test_time 2.032147022999993
gc 0
Test threshold 0.9 Acc 0.8956, AUC 0.9555622935295105, avg_entr 0.2865538001060486, f1 0.8956000208854675
t0.9_test_time 2.0750154520000024
