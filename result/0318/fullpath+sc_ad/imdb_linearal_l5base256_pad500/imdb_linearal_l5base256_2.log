total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 24.987015255
Start Training
gc 0
Train Epoch0 Acc 0.4956 (19824/40000), AUC 0.4969685673713684
ep0_train_time 13.235930661000001
Test Epoch0 layer4 Acc 0.4518, AUC 0.4304773211479187, avg_entr 0.6996196508407593, f1 0.45179998874664307
ep0_l4_test_time 0.7791403330000009
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.47805 (19122/40000), AUC 0.47640180587768555
ep1_train_time 11.179908040999997
Test Epoch1 layer4 Acc 0.6778, AUC 0.8453410267829895, avg_entr 0.691944420337677, f1 0.6777999997138977
ep1_l4_test_time 0.7826094070000025
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.832825 (33313/40000), AUC 0.9054113626480103
ep2_train_time 11.193045521999998
Test Epoch2 layer4 Acc 0.8546, AUC 0.9398336410522461, avg_entr 0.2553347647190094, f1 0.8546000123023987
ep2_l4_test_time 0.8196770269999973
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.89395 (35758/40000), AUC 0.9575514197349548
ep3_train_time 10.958177966999997
Test Epoch3 layer4 Acc 0.8886, AUC 0.9514521360397339, avg_entr 0.21259574592113495, f1 0.8885999917984009
ep3_l4_test_time 0.7837670960000054
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.913175 (36527/40000), AUC 0.9702872633934021
ep4_train_time 11.064136398999992
Test Epoch4 layer4 Acc 0.8938, AUC 0.956262469291687, avg_entr 0.18405237793922424, f1 0.8938000202178955
ep4_l4_test_time 0.8246507740000055
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9251 (37004/40000), AUC 0.9770224690437317
ep5_train_time 11.083469947999987
Test Epoch5 layer4 Acc 0.898, AUC 0.958407998085022, avg_entr 0.15448252856731415, f1 0.8980000019073486
ep5_l4_test_time 0.7702213679999943
Save ckpt to ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.932675 (37307/40000), AUC 0.980919361114502
ep6_train_time 11.176388963999997
Test Epoch6 layer4 Acc 0.894, AUC 0.9594463109970093, avg_entr 0.13633152842521667, f1 0.8939999938011169
ep6_l4_test_time 0.8243889909999922
gc 0
Train Epoch7 Acc 0.93875 (37550/40000), AUC 0.9839887619018555
ep7_train_time 11.99246782600001
Test Epoch7 layer4 Acc 0.8952, AUC 0.9598044157028198, avg_entr 0.1111544817686081, f1 0.8952000141143799
ep7_l4_test_time 0.8112713419999977
gc 0
Train Epoch8 Acc 0.944125 (37765/40000), AUC 0.9860213994979858
ep8_train_time 11.860244347999995
Test Epoch8 layer4 Acc 0.8958, AUC 0.959741473197937, avg_entr 0.089141845703125, f1 0.895799994468689
ep8_l4_test_time 0.8199862360000054
gc 0
Train Epoch9 Acc 0.9494 (37976/40000), AUC 0.9881328344345093
ep9_train_time 12.082244838999998
Test Epoch9 layer4 Acc 0.894, AUC 0.9596896171569824, avg_entr 0.07301747798919678, f1 0.8939999938011169
ep9_l4_test_time 0.8251176570000212
gc 0
Train Epoch10 Acc 0.9526 (38104/40000), AUC 0.9894076585769653
ep10_train_time 11.716065691000011
Test Epoch10 layer4 Acc 0.8974, AUC 0.9583459496498108, avg_entr 0.06149693578481674, f1 0.8974000215530396
ep10_l4_test_time 0.8174170690000153
gc 0
Train Epoch11 Acc 0.9566 (38264/40000), AUC 0.9902704954147339
ep11_train_time 11.86772421400002
Test Epoch11 layer4 Acc 0.8974, AUC 0.956352710723877, avg_entr 0.054351262748241425, f1 0.8974000215530396
ep11_l4_test_time 0.8055556739999759
gc 0
Train Epoch12 Acc 0.959575 (38383/40000), AUC 0.9913915395736694
ep12_train_time 11.651431978999994
Test Epoch12 layer4 Acc 0.8936, AUC 0.9536539316177368, avg_entr 0.04891027882695198, f1 0.8935999870300293
ep12_l4_test_time 0.818953405000002
gc 0
Train Epoch13 Acc 0.96145 (38458/40000), AUC 0.9922671318054199
ep13_train_time 11.39975996199999
Test Epoch13 layer4 Acc 0.8886, AUC 0.9516409635543823, avg_entr 0.04637623578310013, f1 0.8885999917984009
ep13_l4_test_time 0.8383019349999756
gc 0
Train Epoch14 Acc 0.96295 (38518/40000), AUC 0.9929364919662476
ep14_train_time 11.691607129999994
Test Epoch14 layer4 Acc 0.8884, AUC 0.9490795135498047, avg_entr 0.04144161939620972, f1 0.8884000182151794
ep14_l4_test_time 0.8117960639999922
gc 0
Train Epoch15 Acc 0.96635 (38654/40000), AUC 0.9937304258346558
ep15_train_time 11.406392247000014
Test Epoch15 layer4 Acc 0.8836, AUC 0.94855797290802, avg_entr 0.04041599482297897, f1 0.8835999965667725
ep15_l4_test_time 0.7806137690000128
gc 0
Train Epoch16 Acc 0.967375 (38695/40000), AUC 0.9941022992134094
ep16_train_time 11.58919229
Test Epoch16 layer4 Acc 0.8832, AUC 0.9468916654586792, avg_entr 0.036146704107522964, f1 0.8831999897956848
ep16_l4_test_time 0.8086875780000184
gc 0
Train Epoch17 Acc 0.96915 (38766/40000), AUC 0.9946349859237671
ep17_train_time 11.387460214000015
Test Epoch17 layer4 Acc 0.883, AUC 0.9411071538925171, avg_entr 0.03439163416624069, f1 0.8830000162124634
ep17_l4_test_time 0.7986861579999811
gc 0
Train Epoch18 Acc 0.9708 (38832/40000), AUC 0.9952580332756042
ep18_train_time 11.285799468999983
Test Epoch18 layer4 Acc 0.8794, AUC 0.9445563554763794, avg_entr 0.032536979764699936, f1 0.8794000148773193
ep18_l4_test_time 0.8160707740000248
gc 0
Train Epoch19 Acc 0.973025 (38921/40000), AUC 0.995682954788208
ep19_train_time 11.495554119000019
Test Epoch19 layer4 Acc 0.8746, AUC 0.9442012310028076, avg_entr 0.030471863225102425, f1 0.8745999932289124
ep19_l4_test_time 0.7783890840000254
Best AUC tensor(0.8980) 5
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 248.8037206
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base256_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8972, AUC 0.9560498595237732, avg_entr 0.21617402136325836, f1 0.8971999883651733
l0_test_time 0.7813925949999998
gc 0
Test layer1 Acc 0.8972, AUC 0.9563088417053223, avg_entr 0.20520398020744324, f1 0.8971999883651733
l1_test_time 0.7876442289999659
gc 0
Test layer2 Acc 0.898, AUC 0.9564641714096069, avg_entr 0.18755663931369781, f1 0.8980000019073486
l2_test_time 0.7911328889999822
gc 0
Test layer3 Acc 0.8976, AUC 0.9566243290901184, avg_entr 0.17256991565227509, f1 0.897599995136261
l3_test_time 0.8140413009999747
gc 0
Test layer4 Acc 0.897, AUC 0.9566324949264526, avg_entr 0.15627308189868927, f1 0.8970000147819519
l4_test_time 0.8041824360000192
gc 0
Test threshold 0.1 Acc 0.897, AUC 0.9565264582633972, avg_entr 0.23620854318141937, f1 0.8970000147819519
t0.1_test_time 1.6815441400000282
gc 0
Test threshold 0.2 Acc 0.897, AUC 0.9563690423965454, avg_entr 0.2488727569580078, f1 0.8970000147819519
t0.2_test_time 1.705922686000008
gc 0
Test threshold 0.3 Acc 0.897, AUC 0.9561302661895752, avg_entr 0.26029443740844727, f1 0.8970000147819519
t0.3_test_time 1.7224875040000143
gc 0
Test threshold 0.4 Acc 0.897, AUC 0.9557414054870605, avg_entr 0.2705036997795105, f1 0.8970000147819519
t0.4_test_time 1.6634282640000038
gc 0
Test threshold 0.5 Acc 0.897, AUC 0.9555951356887817, avg_entr 0.28032365441322327, f1 0.8970000147819519
t0.5_test_time 1.8850385759999995
gc 0
Test threshold 0.6 Acc 0.897, AUC 0.9555454850196838, avg_entr 0.289164274930954, f1 0.8970000147819519
t0.6_test_time 1.845246550000013
gc 0
Test threshold 0.7 Acc 0.897, AUC 0.9558157920837402, avg_entr 0.2969817519187927, f1 0.8970000147819519
t0.7_test_time 1.6006269599999996
gc 0
Test threshold 0.8 Acc 0.897, AUC 0.955655038356781, avg_entr 0.3030374050140381, f1 0.8970000147819519
t0.8_test_time 1.8651492349999899
gc 0
Test threshold 0.9 Acc 0.897, AUC 0.9559882283210754, avg_entr 0.3079129755496979, f1 0.8970000147819519
t0.9_test_time 1.7237942490000364
