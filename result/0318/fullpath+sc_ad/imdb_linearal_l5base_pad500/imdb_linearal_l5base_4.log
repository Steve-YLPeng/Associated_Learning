total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.089346679000002
Start Training
gc 0
Train Epoch0 Acc 0.510975 (20439/40000), AUC 0.5105279684066772
ep0_train_time 10.600353614
Test Epoch0 layer4 Acc 0.5008, AUC 0.8635353446006775, avg_entr 0.6802553534507751, f1 0.5008000135421753
ep0_l4_test_time 0.7043187730000042
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.823875 (32955/40000), AUC 0.9008041620254517
ep1_train_time 7.652443726999998
Test Epoch1 layer4 Acc 0.8818, AUC 0.9466296434402466, avg_entr 0.2410450130701065, f1 0.8818000555038452
ep1_l4_test_time 0.5473743569999954
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9056 (36224/40000), AUC 0.9647438526153564
ep2_train_time 6.297064311999996
Test Epoch2 layer4 Acc 0.891, AUC 0.9549941420555115, avg_entr 0.1761334091424942, f1 0.890999972820282
ep2_l4_test_time 0.5435858429999954
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.923125 (36925/40000), AUC 0.9761470556259155
ep3_train_time 6.286341361999995
Test Epoch3 layer4 Acc 0.8978, AUC 0.9590111374855042, avg_entr 0.13436740636825562, f1 0.8978000283241272
ep3_l4_test_time 0.5450125610000001
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.934325 (37373/40000), AUC 0.9815331697463989
ep4_train_time 6.352822031000002
Test Epoch4 layer4 Acc 0.896, AUC 0.9600699543952942, avg_entr 0.09419290721416473, f1 0.8960000276565552
ep4_l4_test_time 0.5460897900000035
gc 0
Train Epoch5 Acc 0.94345 (37738/40000), AUC 0.9854214191436768
ep5_train_time 6.368719701000003
Test Epoch5 layer4 Acc 0.8976, AUC 0.9602245092391968, avg_entr 0.0647859275341034, f1 0.897599995136261
ep5_l4_test_time 0.5441640250000006
gc 0
Train Epoch6 Acc 0.9489 (37956/40000), AUC 0.987339198589325
ep6_train_time 6.2911087399999985
Test Epoch6 layer4 Acc 0.89, AUC 0.95633864402771, avg_entr 0.0514068678021431, f1 0.8899999856948853
ep6_l4_test_time 0.5462246539999995
gc 0
Train Epoch7 Acc 0.9551 (38204/40000), AUC 0.9892545938491821
ep7_train_time 6.477710923999993
Test Epoch7 layer4 Acc 0.8952, AUC 0.9546529054641724, avg_entr 0.041825901716947556, f1 0.8952000141143799
ep7_l4_test_time 0.545507551
gc 0
Train Epoch8 Acc 0.957725 (38309/40000), AUC 0.9905228018760681
ep8_train_time 6.335345055000005
Test Epoch8 layer4 Acc 0.888, AUC 0.9501745700836182, avg_entr 0.03731132298707962, f1 0.8880000114440918
ep8_l4_test_time 0.5464906770000084
gc 0
Train Epoch9 Acc 0.9626 (38504/40000), AUC 0.9924653768539429
ep9_train_time 6.324045622
Test Epoch9 layer4 Acc 0.8864, AUC 0.9486034512519836, avg_entr 0.031902067363262177, f1 0.8863999843597412
ep9_l4_test_time 0.544952570999996
gc 0
Train Epoch10 Acc 0.96555 (38622/40000), AUC 0.9934382438659668
ep10_train_time 6.368260898000003
Test Epoch10 layer4 Acc 0.8846, AUC 0.9489374160766602, avg_entr 0.02991570718586445, f1 0.8845999836921692
ep10_l4_test_time 0.5458550430000031
gc 0
Train Epoch11 Acc 0.968675 (38747/40000), AUC 0.9943183660507202
ep11_train_time 6.343504679000006
Test Epoch11 layer4 Acc 0.8832, AUC 0.9478263854980469, avg_entr 0.02682022750377655, f1 0.8831999897956848
ep11_l4_test_time 0.5507097899999991
gc 0
Train Epoch12 Acc 0.97015 (38806/40000), AUC 0.9949775338172913
ep12_train_time 6.355760044999997
Test Epoch12 layer4 Acc 0.881, AUC 0.9449321031570435, avg_entr 0.022883912548422813, f1 0.8809999823570251
ep12_l4_test_time 0.5472353490000046
gc 0
Train Epoch13 Acc 0.9722 (38888/40000), AUC 0.9956052899360657
ep13_train_time 6.3466169029999975
Test Epoch13 layer4 Acc 0.8784, AUC 0.9444111585617065, avg_entr 0.022093065083026886, f1 0.8784000277519226
ep13_l4_test_time 0.544966431000006
gc 0
Train Epoch14 Acc 0.974475 (38979/40000), AUC 0.99601811170578
ep14_train_time 6.339127820000002
Test Epoch14 layer4 Acc 0.8744, AUC 0.9419932961463928, avg_entr 0.020635943859815598, f1 0.8744000792503357
ep14_l4_test_time 0.552292274999985
gc 0
Train Epoch15 Acc 0.97635 (39054/40000), AUC 0.9966963529586792
ep15_train_time 6.372446446999987
Test Epoch15 layer4 Acc 0.87, AUC 0.9393649697303772, avg_entr 0.019375290721654892, f1 0.8700000047683716
ep15_l4_test_time 0.5459134820000031
gc 0
Train Epoch16 Acc 0.977275 (39091/40000), AUC 0.9969980120658875
ep16_train_time 6.392023823000017
Test Epoch16 layer4 Acc 0.867, AUC 0.9364022016525269, avg_entr 0.017488086596131325, f1 0.8669999837875366
ep16_l4_test_time 0.5473580900000172
gc 0
Train Epoch17 Acc 0.979225 (39169/40000), AUC 0.9972355365753174
ep17_train_time 6.326064679000012
Test Epoch17 layer4 Acc 0.8642, AUC 0.9350799322128296, avg_entr 0.0166231170296669, f1 0.8641999959945679
ep17_l4_test_time 0.5461309030000052
gc 0
Train Epoch18 Acc 0.980125 (39205/40000), AUC 0.997584342956543
ep18_train_time 6.384650193999988
Test Epoch18 layer4 Acc 0.8622, AUC 0.9321626424789429, avg_entr 0.018323151394724846, f1 0.8622000217437744
ep18_l4_test_time 0.5520547399999884
gc 0
Train Epoch19 Acc 0.980725 (39229/40000), AUC 0.9977885484695435
ep19_train_time 6.507554147000008
Test Epoch19 layer4 Acc 0.8588, AUC 0.9307589530944824, avg_entr 0.01767798699438572, f1 0.8587999939918518
ep19_l4_test_time 0.5460899739999832
gc 0
Train Epoch20 Acc 0.981975 (39279/40000), AUC 0.9979183673858643
ep20_train_time 6.306757051000005
Test Epoch20 layer4 Acc 0.8582, AUC 0.9303738474845886, avg_entr 0.015013574622571468, f1 0.858199954032898
ep20_l4_test_time 0.5494840879999856
gc 0
Train Epoch21 Acc 0.982925 (39317/40000), AUC 0.9980818033218384
ep21_train_time 6.4468968320000215
Test Epoch21 layer4 Acc 0.8522, AUC 0.9270656108856201, avg_entr 0.014953088015317917, f1 0.8521999716758728
ep21_l4_test_time 0.5473035230000107
gc 0
Train Epoch22 Acc 0.983725 (39349/40000), AUC 0.9983289837837219
ep22_train_time 6.361424798000002
Test Epoch22 layer4 Acc 0.8562, AUC 0.9224437475204468, avg_entr 0.01787961833178997, f1 0.8561999797821045
ep22_l4_test_time 0.5551285749999977
gc 0
Train Epoch23 Acc 0.984125 (39365/40000), AUC 0.9983916282653809
ep23_train_time 6.2939664660000005
Test Epoch23 layer4 Acc 0.85, AUC 0.9240349531173706, avg_entr 0.015513830818235874, f1 0.8500000238418579
ep23_l4_test_time 0.5458053429999836
gc 0
Train Epoch24 Acc 0.9854 (39416/40000), AUC 0.9985027313232422
ep24_train_time 6.493006078000008
Test Epoch24 layer4 Acc 0.8502, AUC 0.9221172332763672, avg_entr 0.01410230528563261, f1 0.8501999974250793
ep24_l4_test_time 0.5468791509999846
gc 0
Train Epoch25 Acc 0.98575 (39430/40000), AUC 0.9986844658851624
ep25_train_time 6.346840077000024
Test Epoch25 layer4 Acc 0.8444, AUC 0.9205831289291382, avg_entr 0.014277718029916286, f1 0.8443999886512756
ep25_l4_test_time 0.5514406140000006
gc 0
Train Epoch26 Acc 0.986525 (39461/40000), AUC 0.9987738132476807
ep26_train_time 6.330320392999994
Test Epoch26 layer4 Acc 0.848, AUC 0.9183518290519714, avg_entr 0.013214797712862492, f1 0.8479999899864197
ep26_l4_test_time 0.5453046590000099
gc 0
Train Epoch27 Acc 0.987375 (39495/40000), AUC 0.9989044666290283
ep27_train_time 6.353476198999999
Test Epoch27 layer4 Acc 0.8438, AUC 0.9158497452735901, avg_entr 0.013352508656680584, f1 0.8438000082969666
ep27_l4_test_time 0.544897394000003
gc 0
Train Epoch28 Acc 0.9876 (39504/40000), AUC 0.9989821910858154
ep28_train_time 6.37190639100001
Test Epoch28 layer4 Acc 0.8426, AUC 0.9143567085266113, avg_entr 0.013661251403391361, f1 0.8426000475883484
ep28_l4_test_time 0.5470970119999947
gc 0
Train Epoch29 Acc 0.988325 (39533/40000), AUC 0.9990068674087524
ep29_train_time 6.482571024000009
Test Epoch29 layer4 Acc 0.8404, AUC 0.9120285511016846, avg_entr 0.01289164274930954, f1 0.840399980545044
ep29_l4_test_time 0.5453502629999889
Best AUC tensor(0.8978) 3
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 214.506626741
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8956, AUC 0.9559365510940552, avg_entr 0.1953505426645279, f1 0.8956000208854675
l0_test_time 0.5572869810000043
gc 0
Test layer1 Acc 0.8978, AUC 0.9561781883239746, avg_entr 0.18081256747245789, f1 0.8978000283241272
l1_test_time 0.55085807399999
gc 0
Test layer2 Acc 0.8984, AUC 0.9564388990402222, avg_entr 0.16458775103092194, f1 0.8984000086784363
l2_test_time 0.5509886279999989
gc 0
Test layer3 Acc 0.8984, AUC 0.9566812515258789, avg_entr 0.15416313707828522, f1 0.8984000086784363
l3_test_time 0.5449676480000107
gc 0
Test layer4 Acc 0.8984, AUC 0.9569460153579712, avg_entr 0.1367657631635666, f1 0.8984000086784363
l4_test_time 0.5444140230000016
gc 0
Test threshold 0.1 Acc 0.8984, AUC 0.956527590751648, avg_entr 0.20831726491451263, f1 0.8984000086784363
t0.1_test_time 0.573762615999982
gc 0
Test threshold 0.2 Acc 0.8984, AUC 0.956294059753418, avg_entr 0.22067156434059143, f1 0.8984000086784363
t0.2_test_time 0.571880923000009
gc 0
Test threshold 0.3 Acc 0.8984, AUC 0.9561522603034973, avg_entr 0.23166164755821228, f1 0.8984000086784363
t0.3_test_time 0.5708065050000073
gc 0
Test threshold 0.4 Acc 0.8984, AUC 0.9558979272842407, avg_entr 0.24191533029079437, f1 0.8984000086784363
t0.4_test_time 0.5725746159999971
gc 0
Test threshold 0.5 Acc 0.8984, AUC 0.955784797668457, avg_entr 0.2516440749168396, f1 0.8984000086784363
t0.5_test_time 0.5728391640000154
gc 0
Test threshold 0.6 Acc 0.8984, AUC 0.9556319713592529, avg_entr 0.26024195551872253, f1 0.8984000086784363
t0.6_test_time 0.5719038940000019
gc 0
Test threshold 0.7 Acc 0.8984, AUC 0.9558035135269165, avg_entr 0.26825323700904846, f1 0.8984000086784363
t0.7_test_time 0.5736100340000121
gc 0
Test threshold 0.8 Acc 0.8984, AUC 0.9558092951774597, avg_entr 0.27437061071395874, f1 0.8984000086784363
t0.8_test_time 0.5705563100000006
gc 0
Test threshold 0.9 Acc 0.8984, AUC 0.9559321403503418, avg_entr 0.27897918224334717, f1 0.8984000086784363
t0.9_test_time 0.5700393589999919
