total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.011551118
Start Training
gc 0
Train Epoch0 Acc 0.514125 (20565/40000), AUC 0.5250396728515625
ep0_train_time 7.107198842999999
Test Epoch0 layer4 Acc 0.5996, AUC 0.7766659259796143, avg_entr 0.6889195442199707, f1 0.5996000170707703
ep0_l4_test_time 0.5855600940000016
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.831975 (33279/40000), AUC 0.9044482111930847
ep1_train_time 6.4240630140000015
Test Epoch1 layer4 Acc 0.8826, AUC 0.9466446042060852, avg_entr 0.22557443380355835, f1 0.8826000094413757
ep1_l4_test_time 0.5517108860000022
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.905775 (36231/40000), AUC 0.9648863077163696
ep2_train_time 6.524364892000001
Test Epoch2 layer4 Acc 0.891, AUC 0.9564022421836853, avg_entr 0.16369961202144623, f1 0.890999972820282
ep2_l4_test_time 0.5681000780000005
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.923825 (36953/40000), AUC 0.9760255813598633
ep3_train_time 6.618639461999997
Test Epoch3 layer4 Acc 0.8966, AUC 0.9591095447540283, avg_entr 0.12068817019462585, f1 0.8966000080108643
ep3_l4_test_time 0.6153806800000012
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.934925 (37397/40000), AUC 0.9818005561828613
ep4_train_time 6.759568135999999
Test Epoch4 layer4 Acc 0.8984, AUC 0.9605869054794312, avg_entr 0.08288916945457458, f1 0.8984000086784363
ep4_l4_test_time 0.5587997470000019
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.943875 (37755/40000), AUC 0.9855022430419922
ep5_train_time 6.4253365090000045
Test Epoch5 layer4 Acc 0.8978, AUC 0.9603596925735474, avg_entr 0.06254008412361145, f1 0.8978000283241272
ep5_l4_test_time 0.5581400849999909
gc 0
Train Epoch6 Acc 0.9491 (37964/40000), AUC 0.9877374172210693
ep6_train_time 6.5953384029999995
Test Epoch6 layer4 Acc 0.8976, AUC 0.9582973718643188, avg_entr 0.05033380910754204, f1 0.897599995136261
ep6_l4_test_time 0.5931653060000031
gc 0
Train Epoch7 Acc 0.95495 (38198/40000), AUC 0.9896910190582275
ep7_train_time 6.674297113999998
Test Epoch7 layer4 Acc 0.8944, AUC 0.9558005332946777, avg_entr 0.04002946987748146, f1 0.8944000005722046
ep7_l4_test_time 0.5513595709999919
gc 0
Train Epoch8 Acc 0.9589 (38356/40000), AUC 0.9909005761146545
ep8_train_time 6.44419451200001
Test Epoch8 layer4 Acc 0.8914, AUC 0.952118456363678, avg_entr 0.03653173893690109, f1 0.8913999795913696
ep8_l4_test_time 0.5694251030000004
gc 0
Train Epoch9 Acc 0.962975 (38519/40000), AUC 0.9922153353691101
ep9_train_time 6.613402757000003
Test Epoch9 layer4 Acc 0.8922, AUC 0.9504634737968445, avg_entr 0.03136470168828964, f1 0.8921999931335449
ep9_l4_test_time 0.5544569990000099
gc 0
Train Epoch10 Acc 0.966225 (38649/40000), AUC 0.9935445189476013
ep10_train_time 6.735650061000001
Test Epoch10 layer4 Acc 0.8868, AUC 0.9497723579406738, avg_entr 0.028467560186982155, f1 0.8867999911308289
ep10_l4_test_time 0.544428006000004
gc 0
Train Epoch11 Acc 0.968525 (38741/40000), AUC 0.9942237734794617
ep11_train_time 6.462702773999993
Test Epoch11 layer4 Acc 0.8854, AUC 0.9493069052696228, avg_entr 0.02640177309513092, f1 0.8853999972343445
ep11_l4_test_time 0.5538810489999975
gc 0
Train Epoch12 Acc 0.97095 (38838/40000), AUC 0.9949681758880615
ep12_train_time 6.738224383000002
Test Epoch12 layer4 Acc 0.8802, AUC 0.946984052658081, avg_entr 0.024159234017133713, f1 0.8802000284194946
ep12_l4_test_time 0.5676749560000047
gc 0
Train Epoch13 Acc 0.9725 (38900/40000), AUC 0.9955391883850098
ep13_train_time 6.733312253000008
Test Epoch13 layer4 Acc 0.8782, AUC 0.944968581199646, avg_entr 0.023211242631077766, f1 0.8781999945640564
ep13_l4_test_time 0.5485886449999953
gc 0
Train Epoch14 Acc 0.9746 (38984/40000), AUC 0.9957597255706787
ep14_train_time 6.466653202999993
Test Epoch14 layer4 Acc 0.8752, AUC 0.9402192831039429, avg_entr 0.020411748439073563, f1 0.8751999735832214
ep14_l4_test_time 0.5550138099999913
gc 0
Train Epoch15 Acc 0.97645 (39058/40000), AUC 0.9964684247970581
ep15_train_time 6.726266035999998
Test Epoch15 layer4 Acc 0.8726, AUC 0.9408251047134399, avg_entr 0.020534643903374672, f1 0.8726000189781189
ep15_l4_test_time 0.560657209999988
gc 0
Train Epoch16 Acc 0.977725 (39109/40000), AUC 0.9966941475868225
ep16_train_time 6.7818562369999995
Test Epoch16 layer4 Acc 0.8722, AUC 0.9364606142044067, avg_entr 0.017801672220230103, f1 0.872200071811676
ep16_l4_test_time 0.5887624459999756
gc 0
Train Epoch17 Acc 0.979075 (39163/40000), AUC 0.9970220327377319
ep17_train_time 6.435636193000022
Test Epoch17 layer4 Acc 0.8668, AUC 0.9360535740852356, avg_entr 0.0185092780739069, f1 0.8668000102043152
ep17_l4_test_time 0.5518762370000161
gc 0
Train Epoch18 Acc 0.9807 (39228/40000), AUC 0.9973863363265991
ep18_train_time 6.517495118999989
Test Epoch18 layer4 Acc 0.8604, AUC 0.9345781207084656, avg_entr 0.017873670905828476, f1 0.8604000210762024
ep18_l4_test_time 0.5542951580000022
gc 0
Train Epoch19 Acc 0.9817 (39268/40000), AUC 0.9974384307861328
ep19_train_time 6.41370627400002
Test Epoch19 layer4 Acc 0.8618, AUC 0.9323585033416748, avg_entr 0.01570742204785347, f1 0.8618000149726868
ep19_l4_test_time 0.5512752629999795
gc 0
Train Epoch20 Acc 0.9824 (39296/40000), AUC 0.997747540473938
ep20_train_time 6.457267703000014
Test Epoch20 layer4 Acc 0.858, AUC 0.9305472373962402, avg_entr 0.015358087606728077, f1 0.8579999804496765
ep20_l4_test_time 0.5635103979999769
gc 0
Train Epoch21 Acc 0.982925 (39317/40000), AUC 0.9978848695755005
ep21_train_time 6.547225757999996
Test Epoch21 layer4 Acc 0.8576, AUC 0.9290868639945984, avg_entr 0.01432559359818697, f1 0.8575999140739441
ep21_l4_test_time 0.5564996009999845
gc 0
Train Epoch22 Acc 0.984175 (39367/40000), AUC 0.9981935024261475
ep22_train_time 6.828168416000011
Test Epoch22 layer4 Acc 0.8546, AUC 0.9269062280654907, avg_entr 0.013338519260287285, f1 0.8546000123023987
ep22_l4_test_time 0.5452782779999836
gc 0
Train Epoch23 Acc 0.985075 (39403/40000), AUC 0.9983122944831848
ep23_train_time 6.340863931000001
Test Epoch23 layer4 Acc 0.8538, AUC 0.9248632192611694, avg_entr 0.013531716540455818, f1 0.8537999987602234
ep23_l4_test_time 0.5514747580000119
gc 0
Train Epoch24 Acc 0.9854 (39416/40000), AUC 0.9984114766120911
ep24_train_time 6.5429191660000185
Test Epoch24 layer4 Acc 0.8532, AUC 0.9225627779960632, avg_entr 0.016422126442193985, f1 0.8532000184059143
ep24_l4_test_time 0.5545425520000151
gc 0
Train Epoch25 Acc 0.986025 (39441/40000), AUC 0.9985240697860718
ep25_train_time 6.784947885999998
Test Epoch25 layer4 Acc 0.8452, AUC 0.9225903749465942, avg_entr 0.015256968326866627, f1 0.8452000021934509
ep25_l4_test_time 0.5766840439999896
gc 0
Train Epoch26 Acc 0.986925 (39477/40000), AUC 0.9986185431480408
ep26_train_time 6.323631168999981
Test Epoch26 layer4 Acc 0.8478, AUC 0.919520914554596, avg_entr 0.013152488507330418, f1 0.8477999567985535
ep26_l4_test_time 0.5531142019999891
gc 0
Train Epoch27 Acc 0.986975 (39479/40000), AUC 0.9987541437149048
ep27_train_time 6.540406445000002
Test Epoch27 layer4 Acc 0.8474, AUC 0.9188652038574219, avg_entr 0.012952554039657116, f1 0.8474000096321106
ep27_l4_test_time 0.5679747229999919
gc 0
Train Epoch28 Acc 0.9875 (39500/40000), AUC 0.9988531470298767
ep28_train_time 6.707637939000023
Test Epoch28 layer4 Acc 0.8442, AUC 0.9164261221885681, avg_entr 0.012887421995401382, f1 0.8442000150680542
ep28_l4_test_time 0.6212013239999976
gc 0
Train Epoch29 Acc 0.9881 (39524/40000), AUC 0.9989216327667236
ep29_train_time 6.448779556000005
Test Epoch29 layer4 Acc 0.843, AUC 0.9151220321655273, avg_entr 0.013256699778139591, f1 0.8429999947547913
ep29_l4_test_time 0.5513767269999903
Best AUC tensor(0.8984) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 216.188316746
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8964, AUC 0.956080973148346, avg_entr 0.17581574618816376, f1 0.896399974822998
l0_test_time 0.5510208519999935
gc 0
Test layer1 Acc 0.8952, AUC 0.9565930366516113, avg_entr 0.1540144830942154, f1 0.8952000141143799
l1_test_time 0.5847777820000033
gc 0
Test layer2 Acc 0.896, AUC 0.9570795297622681, avg_entr 0.14691628515720367, f1 0.8960000276565552
l2_test_time 0.5537909920000175
gc 0
Test layer3 Acc 0.8964, AUC 0.957612156867981, avg_entr 0.12476995587348938, f1 0.896399974822998
l3_test_time 0.5543103170000165
gc 0
Test layer4 Acc 0.8954, AUC 0.9577211141586304, avg_entr 0.08748702704906464, f1 0.8953999876976013
l4_test_time 0.5518519569999967
gc 0
Test threshold 0.1 Acc 0.8954, AUC 0.9546430110931396, avg_entr 0.14258237183094025, f1 0.8953999876976013
t0.1_test_time 0.5800847550000015
gc 0
Test threshold 0.2 Acc 0.8954, AUC 0.9540519714355469, avg_entr 0.15985475480556488, f1 0.8953999876976013
t0.2_test_time 0.5864962290000051
gc 0
Test threshold 0.3 Acc 0.8954, AUC 0.9540934562683105, avg_entr 0.17682971060276031, f1 0.8953999876976013
t0.3_test_time 0.6089234769999905
gc 0
Test threshold 0.4 Acc 0.8954, AUC 0.9543051719665527, avg_entr 0.19273947179317474, f1 0.8953999876976013
t0.4_test_time 0.5949737450000043
gc 0
Test threshold 0.5 Acc 0.8954, AUC 0.9549745321273804, avg_entr 0.20677945017814636, f1 0.8953999876976013
t0.5_test_time 0.6272181580000051
gc 0
Test threshold 0.6 Acc 0.8954, AUC 0.9556360244750977, avg_entr 0.2188907265663147, f1 0.8953999876976013
t0.6_test_time 0.642305207000021
gc 0
Test threshold 0.7 Acc 0.8954, AUC 0.9554166793823242, avg_entr 0.22991664707660675, f1 0.8953999876976013
t0.7_test_time 0.6101884489999918
gc 0
Test threshold 0.8 Acc 0.8954, AUC 0.9557010531425476, avg_entr 0.23925434052944183, f1 0.8953999876976013
t0.8_test_time 0.5953874749999954
gc 0
Test threshold 0.9 Acc 0.8954, AUC 0.9558316469192505, avg_entr 0.2471100091934204, f1 0.8953999876976013
t0.9_test_time 0.5929643810000016
