total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.550314493
Start Training
gc 0
Train Epoch0 Acc 0.535725 (21429/40000), AUC 0.5313982367515564
ep0_train_time 11.827303248000003
Test Epoch0 layer4 Acc 0.6832, AUC 0.8393211364746094, avg_entr 0.6888575553894043, f1 0.6832000017166138
ep0_l4_test_time 0.7668122299999993
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.82155 (32862/40000), AUC 0.8980929851531982
ep1_train_time 10.833442016999996
Test Epoch1 layer4 Acc 0.793, AUC 0.9431699514389038, avg_entr 0.21440167725086212, f1 0.7929999828338623
ep1_l4_test_time 0.7633581890000016
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.90365 (36146/40000), AUC 0.9640177488327026
ep2_train_time 10.902596481000003
Test Epoch2 layer4 Acc 0.885, AUC 0.9557243585586548, avg_entr 0.16377486288547516, f1 0.8849999904632568
ep2_l4_test_time 0.7553190419999964
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.92315 (36926/40000), AUC 0.9753075838088989
ep3_train_time 10.886517541000003
Test Epoch3 layer4 Acc 0.8976, AUC 0.9586499929428101, avg_entr 0.11595899611711502, f1 0.897599995136261
ep3_l4_test_time 0.7600871559999973
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.93505 (37402/40000), AUC 0.9814068078994751
ep4_train_time 10.788532430000004
Test Epoch4 layer4 Acc 0.8992, AUC 0.9601123332977295, avg_entr 0.08511251211166382, f1 0.8992000222206116
ep4_l4_test_time 0.7750782469999962
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.942175 (37687/40000), AUC 0.9850824475288391
ep5_train_time 10.906931422
Test Epoch5 layer4 Acc 0.8756, AUC 0.958869457244873, avg_entr 0.06509674340486526, f1 0.8756000399589539
ep5_l4_test_time 0.7570758169999863
gc 0
Train Epoch6 Acc 0.9475 (37900/40000), AUC 0.9871631860733032
ep6_train_time 10.921172017999993
Test Epoch6 layer4 Acc 0.8902, AUC 0.9583280682563782, avg_entr 0.053610894829034805, f1 0.8902000188827515
ep6_l4_test_time 0.7667084580000108
gc 0
Train Epoch7 Acc 0.95435 (38174/40000), AUC 0.9892860054969788
ep7_train_time 10.88897407399999
Test Epoch7 layer4 Acc 0.8936, AUC 0.9542792439460754, avg_entr 0.041104864329099655, f1 0.8935999870300293
ep7_l4_test_time 0.7556249910000048
gc 0
Train Epoch8 Acc 0.95885 (38354/40000), AUC 0.991117537021637
ep8_train_time 10.868078665999988
Test Epoch8 layer4 Acc 0.8926, AUC 0.9524226188659668, avg_entr 0.035795021802186966, f1 0.8925999999046326
ep8_l4_test_time 0.7629153289999806
gc 0
Train Epoch9 Acc 0.9618 (38472/40000), AUC 0.9923383593559265
ep9_train_time 10.850299030000002
Test Epoch9 layer4 Acc 0.8874, AUC 0.9507344365119934, avg_entr 0.032523058354854584, f1 0.8873999714851379
ep9_l4_test_time 0.7750577059999841
gc 0
Train Epoch10 Acc 0.965425 (38617/40000), AUC 0.9934612512588501
ep10_train_time 10.847632412000024
Test Epoch10 layer4 Acc 0.8868, AUC 0.9499986171722412, avg_entr 0.02893802709877491, f1 0.8867999911308289
ep10_l4_test_time 0.758890440000016
gc 0
Train Epoch11 Acc 0.96855 (38742/40000), AUC 0.9943662881851196
ep11_train_time 10.961058382000004
Test Epoch11 layer4 Acc 0.8818, AUC 0.9481786489486694, avg_entr 0.02653990499675274, f1 0.8818000555038452
ep11_l4_test_time 0.7595676550000121
gc 0
Train Epoch12 Acc 0.97005 (38802/40000), AUC 0.9947962760925293
ep12_train_time 10.947029780999998
Test Epoch12 layer4 Acc 0.878, AUC 0.9469149112701416, avg_entr 0.0254239309579134, f1 0.878000020980835
ep12_l4_test_time 0.7656291620000104
gc 0
Train Epoch13 Acc 0.972375 (38895/40000), AUC 0.995561957359314
ep13_train_time 10.866426812000014
Test Epoch13 layer4 Acc 0.8762, AUC 0.9431469440460205, avg_entr 0.021245284005999565, f1 0.8762000203132629
ep13_l4_test_time 0.7687418699999853
gc 0
Train Epoch14 Acc 0.973075 (38923/40000), AUC 0.9961137771606445
ep14_train_time 10.896582879999983
Test Epoch14 layer4 Acc 0.8706, AUC 0.9426736235618591, avg_entr 0.02174447476863861, f1 0.8705999851226807
ep14_l4_test_time 0.7699133870000026
gc 0
Train Epoch15 Acc 0.97575 (39030/40000), AUC 0.9966669082641602
ep15_train_time 10.865891895999994
Test Epoch15 layer4 Acc 0.8694, AUC 0.9400048851966858, avg_entr 0.020423749461770058, f1 0.8694000244140625
ep15_l4_test_time 0.7616204589999995
gc 0
Train Epoch16 Acc 0.976675 (39067/40000), AUC 0.9969114065170288
ep16_train_time 10.843086204999992
Test Epoch16 layer4 Acc 0.8662, AUC 0.9377551674842834, avg_entr 0.018968550488352776, f1 0.8661999702453613
ep16_l4_test_time 0.7557428130000119
gc 0
Train Epoch17 Acc 0.97835 (39134/40000), AUC 0.9972054958343506
ep17_train_time 10.89843791299998
Test Epoch17 layer4 Acc 0.866, AUC 0.9359110593795776, avg_entr 0.01840437576174736, f1 0.8659999966621399
ep17_l4_test_time 0.7699252379999848
gc 0
Train Epoch18 Acc 0.98045 (39218/40000), AUC 0.9975535273551941
ep18_train_time 10.958291943000006
Test Epoch18 layer4 Acc 0.8606, AUC 0.9337339401245117, avg_entr 0.016650773584842682, f1 0.8605999946594238
ep18_l4_test_time 0.758830181999997
gc 0
Train Epoch19 Acc 0.980775 (39231/40000), AUC 0.9978232383728027
ep19_train_time 10.825189894000005
Test Epoch19 layer4 Acc 0.8594, AUC 0.931719183921814, avg_entr 0.01606757566332817, f1 0.8593999743461609
ep19_l4_test_time 0.7640667069999836
gc 0
Train Epoch20 Acc 0.981925 (39277/40000), AUC 0.9979693293571472
ep20_train_time 10.923352357999988
Test Epoch20 layer4 Acc 0.8608, AUC 0.9290249347686768, avg_entr 0.016598476096987724, f1 0.86080002784729
ep20_l4_test_time 0.7726369900000236
gc 0
Train Epoch21 Acc 0.98275 (39310/40000), AUC 0.9981701374053955
ep21_train_time 10.786533283999972
Test Epoch21 layer4 Acc 0.8562, AUC 0.9269958138465881, avg_entr 0.015233198180794716, f1 0.8561999797821045
ep21_l4_test_time 0.7641655669999636
gc 0
Train Epoch22 Acc 0.9831 (39324/40000), AUC 0.9983181357383728
ep22_train_time 10.837219298999969
Test Epoch22 layer4 Acc 0.8508, AUC 0.9250882863998413, avg_entr 0.014864570461213589, f1 0.8507999777793884
ep22_l4_test_time 0.7641288000000372
gc 0
Train Epoch23 Acc 0.98355 (39342/40000), AUC 0.9983627200126648
ep23_train_time 10.809377184000027
Test Epoch23 layer4 Acc 0.8508, AUC 0.9224448204040527, avg_entr 0.013383978046476841, f1 0.8507999777793884
ep23_l4_test_time 0.7762139870000055
gc 0
Train Epoch24 Acc 0.98445 (39378/40000), AUC 0.9985780715942383
ep24_train_time 10.856739548000007
Test Epoch24 layer4 Acc 0.8476, AUC 0.9211775064468384, avg_entr 0.013842766173183918, f1 0.847599983215332
ep24_l4_test_time 0.76064373600002
gc 0
Train Epoch25 Acc 0.985125 (39405/40000), AUC 0.9987097978591919
ep25_train_time 10.832163199000036
Test Epoch25 layer4 Acc 0.8444, AUC 0.9189517498016357, avg_entr 0.013688716106116772, f1 0.8443999886512756
ep25_l4_test_time 0.7582101639999905
gc 0
Train Epoch26 Acc 0.9858 (39432/40000), AUC 0.9988155364990234
ep26_train_time 10.83302113100001
Test Epoch26 layer4 Acc 0.8478, AUC 0.9177578687667847, avg_entr 0.013017730787396431, f1 0.8477999567985535
ep26_l4_test_time 0.7402154469999687
gc 0
Train Epoch27 Acc 0.986375 (39455/40000), AUC 0.9989069700241089
ep27_train_time 10.929450304999989
Test Epoch27 layer4 Acc 0.8438, AUC 0.9156100749969482, avg_entr 0.012118269689381123, f1 0.8438000082969666
ep27_l4_test_time 0.7441954999999894
gc 0
Train Epoch28 Acc 0.986575 (39463/40000), AUC 0.9989039897918701
ep28_train_time 10.950365245
Test Epoch28 layer4 Acc 0.8398, AUC 0.9144765734672546, avg_entr 0.013818609528243542, f1 0.8398000001907349
ep28_l4_test_time 0.7700572749999992
gc 0
Train Epoch29 Acc 0.986875 (39475/40000), AUC 0.9990016222000122
ep29_train_time 10.958044631999996
Test Epoch29 layer4 Acc 0.84, AUC 0.9120556712150574, avg_entr 0.011681911535561085, f1 0.8399999737739563
ep29_l4_test_time 0.7540526530000307
Best AUC tensor(0.8992) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 351.775973181
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8922, AUC 0.9558163285255432, avg_entr 0.17705632746219635, f1 0.8921999931335449
l0_test_time 0.7496967789999758
gc 0
Test layer1 Acc 0.8936, AUC 0.9561987519264221, avg_entr 0.16277821362018585, f1 0.8935999870300293
l1_test_time 0.7498495039999966
gc 0
Test layer2 Acc 0.8942, AUC 0.9564574360847473, avg_entr 0.14245827496051788, f1 0.8942000269889832
l2_test_time 0.7615462039999557
gc 0
Test layer3 Acc 0.895, AUC 0.9566304087638855, avg_entr 0.12437492609024048, f1 0.8949999809265137
l3_test_time 0.7616584279999756
gc 0
Test layer4 Acc 0.8948, AUC 0.9568560719490051, avg_entr 0.088535837829113, f1 0.8948000073432922
l4_test_time 0.7773817480000389
gc 0
Test threshold 0.1 Acc 0.8948, AUC 0.9538972973823547, avg_entr 0.14479507505893707, f1 0.8948000073432922
t0.1_test_time 1.8751873950000117
gc 0
Test threshold 0.2 Acc 0.8948, AUC 0.9530925750732422, avg_entr 0.16285763680934906, f1 0.8948000073432922
t0.2_test_time 1.9106390580000152
gc 0
Test threshold 0.3 Acc 0.8948, AUC 0.9543389081954956, avg_entr 0.17952077090740204, f1 0.8948000073432922
t0.3_test_time 1.7611062520000473
gc 0
Test threshold 0.4 Acc 0.8948, AUC 0.9540663957595825, avg_entr 0.19506751000881195, f1 0.8948000073432922
t0.4_test_time 1.7736417140000071
gc 0
Test threshold 0.5 Acc 0.8948, AUC 0.9548392295837402, avg_entr 0.2099270522594452, f1 0.8948000073432922
t0.5_test_time 1.7551850920000334
gc 0
Test threshold 0.6 Acc 0.8948, AUC 0.9551860094070435, avg_entr 0.22250019013881683, f1 0.8948000073432922
t0.6_test_time 1.6805421440000146
gc 0
Test threshold 0.7 Acc 0.8948, AUC 0.9553580284118652, avg_entr 0.23330029845237732, f1 0.8948000073432922
t0.7_test_time 1.725582051999993
gc 0
Test threshold 0.8 Acc 0.8948, AUC 0.9556485414505005, avg_entr 0.24358022212982178, f1 0.8948000073432922
t0.8_test_time 1.6819936360000156
gc 0
Test threshold 0.9 Acc 0.8948, AUC 0.955777645111084, avg_entr 0.2508156895637512, f1 0.8948000073432922
t0.9_test_time 1.8753957779999837
