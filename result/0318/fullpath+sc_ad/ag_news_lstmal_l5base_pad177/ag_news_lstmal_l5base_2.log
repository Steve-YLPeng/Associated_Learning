total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 17.95452852
Start Training
gc 0
Train Epoch0 Acc 0.73785 (88542/120000), AUC 0.920229971408844
ep0_train_time 176.229733823
Test Epoch0 layer4 Acc 0.9039473684210526, AUC 0.9803751707077026, avg_entr 0.10869108140468597, f1 0.9039472937583923
ep0_l4_test_time 1.5597849849999932
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9202083333333333 (110425/120000), AUC 0.9822699427604675
ep1_train_time 157.617873708
Test Epoch1 layer4 Acc 0.9184210526315789, AUC 0.9839293360710144, avg_entr 0.052152056246995926, f1 0.9184210896492004
ep1_l4_test_time 1.5423477699999921
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9318 (111816/120000), AUC 0.9868351817131042
ep2_train_time 175.68296612399996
Test Epoch2 layer4 Acc 0.921578947368421, AUC 0.982742428779602, avg_entr 0.03450704738497734, f1 0.9215789437294006
ep2_l4_test_time 1.5143622370000003
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9392833333333334 (112714/120000), AUC 0.9892789721488953
ep3_train_time 175.91894714
Test Epoch3 layer4 Acc 0.9210526315789473, AUC 0.984675407409668, avg_entr 0.030175691470503807, f1 0.9210526347160339
ep3_l4_test_time 1.4848270479999428
gc 0
Train Epoch4 Acc 0.943825 (113259/120000), AUC 0.9907293915748596
ep4_train_time 175.86306417000003
Test Epoch4 layer4 Acc 0.9186842105263158, AUC 0.9839467406272888, avg_entr 0.02398466318845749, f1 0.918684184551239
ep4_l4_test_time 1.473804161999965
gc 0
Train Epoch5 Acc 0.9480083333333333 (113761/120000), AUC 0.9916068315505981
ep5_train_time 175.80203391999999
Test Epoch5 layer4 Acc 0.9197368421052632, AUC 0.9834426641464233, avg_entr 0.019977163523435593, f1 0.9197368621826172
ep5_l4_test_time 1.5596824369999922
gc 0
Train Epoch6 Acc 0.9514166666666667 (114170/120000), AUC 0.992414116859436
ep6_train_time 175.74655109900004
Test Epoch6 layer4 Acc 0.9171052631578948, AUC 0.9820533990859985, avg_entr 0.01856296695768833, f1 0.9171052575111389
ep6_l4_test_time 1.5702801800000543
gc 0
Train Epoch7 Acc 0.9537 (114444/120000), AUC 0.9930109977722168
ep7_train_time 175.85663587199997
Test Epoch7 layer4 Acc 0.9152631578947369, AUC 0.9815458059310913, avg_entr 0.018493527546525, f1 0.9152631759643555
ep7_l4_test_time 1.518027562000043
gc 0
Train Epoch8 Acc 0.9562833333333334 (114754/120000), AUC 0.9935894012451172
ep8_train_time 175.81377960100008
Test Epoch8 layer4 Acc 0.9181578947368421, AUC 0.9820395708084106, avg_entr 0.015763122588396072, f1 0.9181578755378723
ep8_l4_test_time 1.5399755619998814
gc 0
Train Epoch9 Acc 0.958425 (115011/120000), AUC 0.9939825534820557
ep9_train_time 175.6781249369999
Test Epoch9 layer4 Acc 0.9173684210526316, AUC 0.9814430475234985, avg_entr 0.01637534238398075, f1 0.9173683524131775
ep9_l4_test_time 1.5667376660001082
gc 0
Train Epoch10 Acc 0.9604833333333334 (115258/120000), AUC 0.9942523241043091
ep10_train_time 157.48081615600017
Test Epoch10 layer4 Acc 0.915, AUC 0.9814538955688477, avg_entr 0.015047475695610046, f1 0.9150000214576721
ep10_l4_test_time 1.4892627700000958
gc 0
Train Epoch11 Acc 0.9623083333333333 (115477/120000), AUC 0.9945538640022278
ep11_train_time 175.56083510899998
Test Epoch11 layer4 Acc 0.9144736842105263, AUC 0.9787266850471497, avg_entr 0.014135794714093208, f1 0.9144737124443054
ep11_l4_test_time 1.557745475000047
gc 0
Train Epoch12 Acc 0.9638916666666667 (115667/120000), AUC 0.9947944283485413
ep12_train_time 175.79812064499993
Test Epoch12 layer4 Acc 0.9113157894736842, AUC 0.9802144765853882, avg_entr 0.01261634286493063, f1 0.9113157987594604
ep12_l4_test_time 1.5713709819997348
gc 0
Train Epoch13 Acc 0.9662583333333333 (115951/120000), AUC 0.995058536529541
ep13_train_time 175.54255889200022
Test Epoch13 layer4 Acc 0.9123684210526316, AUC 0.9793581366539001, avg_entr 0.012072820216417313, f1 0.9123684167861938
ep13_l4_test_time 1.570125828000073
gc 0
Train Epoch14 Acc 0.9679583333333334 (116155/120000), AUC 0.9950989484786987
ep14_train_time 175.69162082699995
Test Epoch14 layer4 Acc 0.9084210526315789, AUC 0.9778198599815369, avg_entr 0.01094621978700161, f1 0.9084210395812988
ep14_l4_test_time 1.5638157650000721
gc 0
Train Epoch15 Acc 0.9695333333333334 (116344/120000), AUC 0.9951096773147583
ep15_train_time 175.7903781619998
Test Epoch15 layer4 Acc 0.9102631578947369, AUC 0.975077748298645, avg_entr 0.01069572288542986, f1 0.910263180732727
ep15_l4_test_time 1.5440186989999347
gc 0
Train Epoch16 Acc 0.9710916666666667 (116531/120000), AUC 0.9952014088630676
ep16_train_time 175.77887366699997
Test Epoch16 layer4 Acc 0.9078947368421053, AUC 0.9747704267501831, avg_entr 0.007456607650965452, f1 0.9078947901725769
ep16_l4_test_time 1.5362504540003101
gc 0
Train Epoch17 Acc 0.97265 (116718/120000), AUC 0.9952476620674133
ep17_train_time 175.7079933140003
Test Epoch17 layer4 Acc 0.908157894736842, AUC 0.9755412936210632, avg_entr 0.009886549785733223, f1 0.9081578850746155
ep17_l4_test_time 1.5687125280001055
gc 0
Train Epoch18 Acc 0.9746083333333333 (116953/120000), AUC 0.995345950126648
ep18_train_time 175.6580865179999
Test Epoch18 layer4 Acc 0.9078947368421053, AUC 0.9736168384552002, avg_entr 0.008388133719563484, f1 0.9078947901725769
ep18_l4_test_time 1.574197975000061
gc 0
Train Epoch19 Acc 0.976075 (117129/120000), AUC 0.9955175518989563
ep19_train_time 157.8136120400004
Test Epoch19 layer4 Acc 0.905, AUC 0.9701520204544067, avg_entr 0.006476934999227524, f1 0.9049999117851257
ep19_l4_test_time 1.551492984000106
gc 0
Train Epoch20 Acc 0.9777666666666667 (117332/120000), AUC 0.9956784844398499
ep20_train_time 175.71964484699993
Test Epoch20 layer4 Acc 0.9052631578947369, AUC 0.9716932773590088, avg_entr 0.006973708979785442, f1 0.9052631855010986
ep20_l4_test_time 1.5376590949999809
gc 0
Train Epoch21 Acc 0.9788583333333334 (117463/120000), AUC 0.9957515001296997
ep21_train_time 175.68606174000024
Test Epoch21 layer4 Acc 0.901578947368421, AUC 0.9705976247787476, avg_entr 0.007407741621136665, f1 0.901578962802887
ep21_l4_test_time 1.5521589889999632
gc 0
Train Epoch22 Acc 0.980275 (117633/120000), AUC 0.9957723617553711
ep22_train_time 175.75512333799998
Test Epoch22 layer4 Acc 0.906578947368421, AUC 0.9683902859687805, avg_entr 0.005038114730268717, f1 0.9065789580345154
ep22_l4_test_time 1.5697946010000123
gc 0
Train Epoch23 Acc 0.981725 (117807/120000), AUC 0.9959241151809692
ep23_train_time 175.83600850899984
Test Epoch23 layer4 Acc 0.905, AUC 0.9678139686584473, avg_entr 0.006564924027770758, f1 0.9049999117851257
ep23_l4_test_time 1.5290938289999758
gc 0
Train Epoch24 Acc 0.9827166666666667 (117926/120000), AUC 0.9959877729415894
ep24_train_time 175.79933925899968
Test Epoch24 layer4 Acc 0.9057894736842105, AUC 0.9681854844093323, avg_entr 0.004197817295789719, f1 0.9057894945144653
ep24_l4_test_time 1.5526901619996352
gc 0
Train Epoch25 Acc 0.98335 (118002/120000), AUC 0.9961131811141968
ep25_train_time 175.67230590799954
Test Epoch25 layer4 Acc 0.9026315789473685, AUC 0.9660537242889404, avg_entr 0.007108123507350683, f1 0.9026315808296204
ep25_l4_test_time 1.549162674999934
gc 0
Train Epoch26 Acc 0.9843083333333333 (118117/120000), AUC 0.9960863590240479
ep26_train_time 175.69643510900005
Test Epoch26 layer4 Acc 0.9005263157894737, AUC 0.9646676778793335, avg_entr 0.00460819061845541, f1 0.9005263447761536
ep26_l4_test_time 1.5602941289998853
gc 0
Train Epoch27 Acc 0.9853666666666666 (118244/120000), AUC 0.996213972568512
ep27_train_time 175.81326568999975
Test Epoch27 layer4 Acc 0.901578947368421, AUC 0.9629005193710327, avg_entr 0.004728488624095917, f1 0.901578962802887
ep27_l4_test_time 1.5502631819999806
gc 0
Train Epoch28 Acc 0.9860333333333333 (118324/120000), AUC 0.9963350892066956
ep28_train_time 157.51836999500028
Test Epoch28 layer4 Acc 0.9026315789473685, AUC 0.9657880663871765, avg_entr 0.0049704816192388535, f1 0.9026315808296204
ep28_l4_test_time 1.558362462000332
gc 0
Train Epoch29 Acc 0.9868916666666666 (118427/120000), AUC 0.9965624809265137
ep29_train_time 175.58178836499974
Test Epoch29 layer4 Acc 0.9044736842105263, AUC 0.9629710912704468, avg_entr 0.005035994574427605, f1 0.9044736623764038
ep29_l4_test_time 1.549243481999838
Best AUC tensor(0.9216) 2
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 5248.201011153
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt
gc 10
Test layer0 Acc 0.911578947368421, AUC 0.9792646169662476, avg_entr 0.11575248837471008, f1 0.9115789532661438
l0_test_time 0.3103309170001012
gc 0
Test layer1 Acc 0.9113157894736842, AUC 0.9818974733352661, avg_entr 0.04369675740599632, f1 0.9113157987594604
l1_test_time 0.5569470170003115
gc 0
Test layer2 Acc 0.9110526315789473, AUC 0.9818719029426575, avg_entr 0.038630612194538116, f1 0.9110526442527771
l2_test_time 0.8611203250002291
gc 0
Test layer3 Acc 0.911578947368421, AUC 0.9816631078720093, avg_entr 0.037499457597732544, f1 0.9115789532661438
l3_test_time 1.2040071780002108
gc 0
Test layer4 Acc 0.911578947368421, AUC 0.9812386631965637, avg_entr 0.038644205778837204, f1 0.9115789532661438
l4_test_time 1.537098417999914
gc 0
Test threshold 0.1 Acc 0.9107894736842105, AUC 0.9781841039657593, avg_entr 0.03729921206831932, f1 0.9107894897460938
t0.1_test_time 1.9597111060002135
gc 0
Test threshold 0.2 Acc 0.9107894736842105, AUC 0.9781773090362549, avg_entr 0.04759099334478378, f1 0.9107894897460938
t0.2_test_time 1.9354141769999842
gc 0
Test threshold 0.3 Acc 0.9102631578947369, AUC 0.9780998229980469, avg_entr 0.058072540909051895, f1 0.910263180732727
t0.3_test_time 1.5384003540002595
gc 0
Test threshold 0.4 Acc 0.911578947368421, AUC 0.9787631630897522, avg_entr 0.0745876133441925, f1 0.9115789532661438
t0.4_test_time 1.4043756790006228
gc 0
Test threshold 0.5 Acc 0.911578947368421, AUC 0.9790678024291992, avg_entr 0.0817691832780838, f1 0.9115789532661438
t0.5_test_time 0.7143906209994384
gc 0
Test threshold 0.6 Acc 0.911578947368421, AUC 0.9792646169662476, avg_entr 0.08349776268005371, f1 0.9115789532661438
t0.6_test_time 0.522505789999741
gc 0
Test threshold 0.7 Acc 0.911578947368421, AUC 0.9792646169662476, avg_entr 0.08349776268005371, f1 0.9115789532661438
t0.7_test_time 0.49104743099996995
gc 0
Test threshold 0.8 Acc 0.911578947368421, AUC 0.9792646169662476, avg_entr 0.08349776268005371, f1 0.9115789532661438
t0.8_test_time 0.4796015419997275
gc 0
Test threshold 0.9 Acc 0.911578947368421, AUC 0.9792646169662476, avg_entr 0.08349776268005371, f1 0.9115789532661438
t0.9_test_time 0.4779223860005004
