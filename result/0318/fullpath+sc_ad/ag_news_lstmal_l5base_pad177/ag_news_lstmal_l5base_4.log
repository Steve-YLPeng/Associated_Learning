total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 18.55524431
Start Training
gc 0
Train Epoch0 Acc 0.7246416666666666 (86957/120000), AUC 0.914885401725769
ep0_train_time 127.742821935
Test Epoch0 layer4 Acc 0.9042105263157895, AUC 0.9808825254440308, avg_entr 0.11211072653532028, f1 0.9042104482650757
ep0_l4_test_time 1.2887928469999963
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9200916666666666 (110411/120000), AUC 0.9822661876678467
ep1_train_time 131.761789467
Test Epoch1 layer4 Acc 0.9181578947368421, AUC 0.9841611981391907, avg_entr 0.05458400398492813, f1 0.9181578755378723
ep1_l4_test_time 1.08769485199997
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9315583333333334 (111787/120000), AUC 0.9866851568222046
ep2_train_time 133.02255219200003
Test Epoch2 layer4 Acc 0.9221052631578948, AUC 0.9847833514213562, avg_entr 0.03784302622079849, f1 0.9221052527427673
ep2_l4_test_time 1.1613806329999647
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9388916666666667 (112667/120000), AUC 0.9892256259918213
ep3_train_time 124.88039892
Test Epoch3 layer4 Acc 0.9210526315789473, AUC 0.9842866063117981, avg_entr 0.02730744704604149, f1 0.9210526347160339
ep3_l4_test_time 1.283396459999949
gc 0
Train Epoch4 Acc 0.9444916666666666 (113339/120000), AUC 0.9907009601593018
ep4_train_time 135.61635013800003
Test Epoch4 layer4 Acc 0.9207894736842105, AUC 0.9837549924850464, avg_entr 0.026085564866662025, f1 0.9207894802093506
ep4_l4_test_time 1.0949136949999456
gc 0
Train Epoch5 Acc 0.9477583333333334 (113731/120000), AUC 0.9917252063751221
ep5_train_time 131.55799964899995
Test Epoch5 layer4 Acc 0.9197368421052632, AUC 0.9830120205879211, avg_entr 0.022211071103811264, f1 0.9197368621826172
ep5_l4_test_time 1.1580953860000136
gc 0
Train Epoch6 Acc 0.95145 (114174/120000), AUC 0.9926103949546814
ep6_train_time 126.64965934599991
Test Epoch6 layer4 Acc 0.9184210526315789, AUC 0.9822831749916077, avg_entr 0.0204725693911314, f1 0.9184210896492004
ep6_l4_test_time 1.0797847389999333
gc 0
Train Epoch7 Acc 0.95395 (114474/120000), AUC 0.9932693839073181
ep7_train_time 135.267369755
Test Epoch7 layer4 Acc 0.9160526315789473, AUC 0.9819502830505371, avg_entr 0.01874716766178608, f1 0.9160526394844055
ep7_l4_test_time 1.1127332270000352
gc 0
Train Epoch8 Acc 0.9562333333333334 (114748/120000), AUC 0.9937244057655334
ep8_train_time 130.23768900100004
Test Epoch8 layer4 Acc 0.9152631578947369, AUC 0.9811218976974487, avg_entr 0.016245011240243912, f1 0.9152631759643555
ep8_l4_test_time 1.2273638350000056
gc 0
Train Epoch9 Acc 0.958025 (114963/120000), AUC 0.9940381050109863
ep9_train_time 128.88230453300002
Test Epoch9 layer4 Acc 0.9160526315789473, AUC 0.9819397330284119, avg_entr 0.01751377433538437, f1 0.9160526394844055
ep9_l4_test_time 1.02257864399985
gc 0
Train Epoch10 Acc 0.9604916666666666 (115259/120000), AUC 0.9944565296173096
ep10_train_time 133.87381467799992
Test Epoch10 layer4 Acc 0.9173684210526316, AUC 0.9803874492645264, avg_entr 0.015556208789348602, f1 0.9173683524131775
ep10_l4_test_time 1.1238513959999636
gc 0
Train Epoch11 Acc 0.962275 (115473/120000), AUC 0.9946908950805664
ep11_train_time 127.08716107700002
Test Epoch11 layer4 Acc 0.9147368421052632, AUC 0.9779561161994934, avg_entr 0.011354382149875164, f1 0.9147368669509888
ep11_l4_test_time 1.3157165490001717
gc 0
Train Epoch12 Acc 0.9639666666666666 (115676/120000), AUC 0.9949235916137695
ep12_train_time 132.55463231199997
Test Epoch12 layer4 Acc 0.9157894736842105, AUC 0.9786530137062073, avg_entr 0.01162857748568058, f1 0.9157894849777222
ep12_l4_test_time 1.0904723339999691
gc 0
Train Epoch13 Acc 0.9656 (115872/120000), AUC 0.9951720237731934
ep13_train_time 132.77299466199997
Test Epoch13 layer4 Acc 0.9147368421052632, AUC 0.9783852696418762, avg_entr 0.011826052330434322, f1 0.9147368669509888
ep13_l4_test_time 1.1821868370000175
gc 0
Train Epoch14 Acc 0.9674416666666666 (116093/120000), AUC 0.9952797889709473
ep14_train_time 124.90610592999997
Test Epoch14 layer4 Acc 0.9139473684210526, AUC 0.9792658090591431, avg_entr 0.011737988330423832, f1 0.913947343826294
ep14_l4_test_time 1.0443635479998647
gc 0
Train Epoch15 Acc 0.9690916666666667 (116291/120000), AUC 0.9953423738479614
ep15_train_time 135.881267214
Test Epoch15 layer4 Acc 0.91, AUC 0.9770834445953369, avg_entr 0.01063193567097187, f1 0.9100000262260437
ep15_l4_test_time 1.1070544569997764
gc 0
Train Epoch16 Acc 0.970875 (116505/120000), AUC 0.9954367876052856
ep16_train_time 131.4093780860003
Test Epoch16 layer4 Acc 0.9094736842105263, AUC 0.9731996059417725, avg_entr 0.007470330689102411, f1 0.9094736576080322
ep16_l4_test_time 1.1964848150000762
gc 0
Train Epoch17 Acc 0.9729166666666667 (116750/120000), AUC 0.9954081177711487
ep17_train_time 127.18245514799992
Test Epoch17 layer4 Acc 0.9094736842105263, AUC 0.9743950366973877, avg_entr 0.009135326370596886, f1 0.9094736576080322
ep17_l4_test_time 1.0711321059998227
gc 0
Train Epoch18 Acc 0.973975 (116877/120000), AUC 0.9955509305000305
ep18_train_time 135.1729967000001
Test Epoch18 layer4 Acc 0.91, AUC 0.9723342657089233, avg_entr 0.007207607384771109, f1 0.9100000262260437
ep18_l4_test_time 1.1229303099999015
gc 0
Train Epoch19 Acc 0.9754083333333333 (117049/120000), AUC 0.9956635236740112
ep19_train_time 129.7604671260001
Test Epoch19 layer4 Acc 0.9063157894736842, AUC 0.974145770072937, avg_entr 0.007763990666717291, f1 0.906315803527832
ep19_l4_test_time 1.2449557119998644
gc 0
Train Epoch20 Acc 0.977025 (117243/120000), AUC 0.995880663394928
ep20_train_time 129.55137576199968
Test Epoch20 layer4 Acc 0.9094736842105263, AUC 0.972137987613678, avg_entr 0.008110721595585346, f1 0.9094736576080322
ep20_l4_test_time 1.08447043499973
gc 0
Train Epoch21 Acc 0.978475 (117417/120000), AUC 0.9959854483604431
ep21_train_time 133.93868520500018
Test Epoch21 layer4 Acc 0.9031578947368422, AUC 0.9723281860351562, avg_entr 0.007626799400895834, f1 0.9031578898429871
ep21_l4_test_time 1.1426547109999774
gc 0
Train Epoch22 Acc 0.9797083333333333 (117565/120000), AUC 0.9961576461791992
ep22_train_time 126.5501216319999
Test Epoch22 layer4 Acc 0.9052631578947369, AUC 0.9722403287887573, avg_entr 0.006914243102073669, f1 0.9052631855010986
ep22_l4_test_time 1.2955532999999377
gc 0
Train Epoch23 Acc 0.980875 (117705/120000), AUC 0.9962643384933472
ep23_train_time 133.3664120399999
Test Epoch23 layer4 Acc 0.9052631578947369, AUC 0.9695939421653748, avg_entr 0.006690865382552147, f1 0.9052631855010986
ep23_l4_test_time 1.0948148669999682
gc 0
Train Epoch24 Acc 0.98215 (117858/120000), AUC 0.9962958097457886
ep24_train_time 154.12279698999964
Test Epoch24 layer4 Acc 0.9057894736842105, AUC 0.9698564410209656, avg_entr 0.004935938399285078, f1 0.9057894945144653
ep24_l4_test_time 1.9746410040002047
gc 0
Train Epoch25 Acc 0.98325 (117990/120000), AUC 0.996554434299469
ep25_train_time 213.16774672999964
Test Epoch25 layer4 Acc 0.9026315789473685, AUC 0.9702239632606506, avg_entr 0.005148069467395544, f1 0.9026315808296204
ep25_l4_test_time 1.9984009330000845
gc 0
Train Epoch26 Acc 0.983775 (118053/120000), AUC 0.9965790510177612
ep26_train_time 304.63727251900036
Test Epoch26 layer4 Acc 0.8981578947368422, AUC 0.9595774412155151, avg_entr 0.005619396455585957, f1 0.8981578946113586
ep26_l4_test_time 2.6339927699996224
gc 0
Train Epoch27 Acc 0.9848583333333333 (118183/120000), AUC 0.9966729879379272
ep27_train_time 306.4099699610001
Test Epoch27 layer4 Acc 0.9036842105263158, AUC 0.9703515768051147, avg_entr 0.005500843282788992, f1 0.9036841988563538
ep27_l4_test_time 2.7219225480002933
gc 0
Train Epoch28 Acc 0.985725 (118287/120000), AUC 0.9967724680900574
ep28_train_time 304.3580354880005
Test Epoch28 layer4 Acc 0.9005263157894737, AUC 0.9653924107551575, avg_entr 0.004303422290831804, f1 0.9005263447761536
ep28_l4_test_time 2.741380203000517
gc 0
Train Epoch29 Acc 0.98655 (118386/120000), AUC 0.9968138337135315
ep29_train_time 308.015978763
Test Epoch29 layer4 Acc 0.8997368421052632, AUC 0.9666633605957031, avg_entr 0.005626898258924484, f1 0.8997368216514587
ep29_l4_test_time 2.7576638459995593
Best AUC tensor(0.9221) 2
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 4774.53437305
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt
gc 10
Test layer0 Acc 0.911578947368421, AUC 0.9795562624931335, avg_entr 0.116180419921875, f1 0.9115789532661438
l0_test_time 0.5439464820001376
gc 0
Test layer1 Acc 0.9128947368421053, AUC 0.9834796190261841, avg_entr 0.04524807259440422, f1 0.9128947257995605
l1_test_time 1.001583872000083
gc 0
Test layer2 Acc 0.9118421052631579, AUC 0.9835656881332397, avg_entr 0.04156167432665825, f1 0.9118421077728271
l2_test_time 1.5125266490003924
gc 0
Test layer3 Acc 0.9118421052631579, AUC 0.9817935228347778, avg_entr 0.03999748453497887, f1 0.9118421077728271
l3_test_time 2.1363420449997648
gc 0
Test layer4 Acc 0.9118421052631579, AUC 0.9832268357276917, avg_entr 0.04291953891515732, f1 0.9118421077728271
l4_test_time 2.298159709999709
gc 0
Test threshold 0.1 Acc 0.9113157894736842, AUC 0.9786137938499451, avg_entr 0.04023335129022598, f1 0.9113157987594604
t0.1_test_time 3.1810519159998876
gc 0
Test threshold 0.2 Acc 0.9092105263157895, AUC 0.9790079593658447, avg_entr 0.04932135343551636, f1 0.9092105031013489
t0.2_test_time 3.2098664160002954
gc 0
Test threshold 0.3 Acc 0.9092105263157895, AUC 0.978287398815155, avg_entr 0.06109114736318588, f1 0.9092105031013489
t0.3_test_time 3.124740092999673
gc 0
Test threshold 0.4 Acc 0.9107894736842105, AUC 0.9792410135269165, avg_entr 0.07479767501354218, f1 0.9107894897460938
t0.4_test_time 2.2582254580001972
gc 0
Test threshold 0.5 Acc 0.9123684210526316, AUC 0.9794865250587463, avg_entr 0.08190374076366425, f1 0.9123684167861938
t0.5_test_time 1.263779195999632
gc 0
Test threshold 0.6 Acc 0.911578947368421, AUC 0.9795562624931335, avg_entr 0.08380645513534546, f1 0.9115789532661438
t0.6_test_time 1.3493661430002248
gc 0
Test threshold 0.7 Acc 0.911578947368421, AUC 0.9795562624931335, avg_entr 0.08380645513534546, f1 0.9115789532661438
t0.7_test_time 1.3990079630002583
gc 0
Test threshold 0.8 Acc 0.911578947368421, AUC 0.9795562624931335, avg_entr 0.08380645513534546, f1 0.9115789532661438
t0.8_test_time 1.4462857859998621
gc 0
Test threshold 0.9 Acc 0.911578947368421, AUC 0.9795562624931335, avg_entr 0.08380645513534546, f1 0.9115789532661438
t0.9_test_time 1.4019894870007192
