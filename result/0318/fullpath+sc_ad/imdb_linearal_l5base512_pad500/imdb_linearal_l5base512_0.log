total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 24.289358926000002
Start Training
gc 0
Train Epoch0 Acc 0.50125 (20050/40000), AUC 0.4902440905570984
ep0_train_time 8.918887041000005
Test Epoch0 layer4 Acc 0.5, AUC 0.5073535442352295, avg_entr 0.6704800128936768, f1 0.5
ep0_l4_test_time 0.6602673760000002
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.50125 (20050/40000), AUC 0.508381724357605
ep1_train_time 7.43330521
Test Epoch1 layer4 Acc 0.5, AUC 0.5553579330444336, avg_entr 0.6704537272453308, f1 0.5
ep1_l4_test_time 0.6649067310000021
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.5021 (20084/40000), AUC 0.5560611486434937
ep2_train_time 7.488884919999997
Test Epoch2 layer4 Acc 0.5302, AUC 0.6930106282234192, avg_entr 0.6920680403709412, f1 0.5302000045776367
ep2_l4_test_time 0.6860565739999984
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.62285 (24914/40000), AUC 0.6937344074249268
ep3_train_time 7.809558869
Test Epoch3 layer4 Acc 0.6772, AUC 0.9106844663619995, avg_entr 0.6857395768165588, f1 0.6772000193595886
ep3_l4_test_time 0.6780239960000003
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.839425 (33577/40000), AUC 0.9045059680938721
ep4_train_time 7.787173638999995
Test Epoch4 layer4 Acc 0.869, AUC 0.9369329810142517, avg_entr 0.3439939320087433, f1 0.8690000176429749
ep4_l4_test_time 0.6735667989999996
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.888775 (35551/40000), AUC 0.9526939988136292
ep5_train_time 7.682328861999991
Test Epoch5 layer4 Acc 0.87, AUC 0.9467779397964478, avg_entr 0.25511401891708374, f1 0.8700000047683716
ep5_l4_test_time 0.674854167999996
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.898275 (35931/40000), AUC 0.9607423543930054
ep6_train_time 7.597251486000005
Test Epoch6 layer4 Acc 0.8816, AUC 0.951985776424408, avg_entr 0.22694629430770874, f1 0.881600022315979
ep6_l4_test_time 0.6607590160000001
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.915925 (36637/40000), AUC 0.9711170196533203
ep7_train_time 7.5615995959999935
Test Epoch7 layer4 Acc 0.892, AUC 0.9554529190063477, avg_entr 0.2081938534975052, f1 0.8920000195503235
ep7_l4_test_time 0.6542452500000024
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.92245 (36898/40000), AUC 0.9752286076545715
ep8_train_time 7.655787856000003
Test Epoch8 layer4 Acc 0.8948, AUC 0.9573328495025635, avg_entr 0.1903272271156311, f1 0.8948000073432922
ep8_l4_test_time 0.6874235849999906
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.92805 (37122/40000), AUC 0.978346586227417
ep9_train_time 7.598075644999994
Test Epoch9 layer4 Acc 0.899, AUC 0.9586374759674072, avg_entr 0.17472538352012634, f1 0.8989999890327454
ep9_l4_test_time 0.6632732869999955
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9329 (37316/40000), AUC 0.9811410903930664
ep10_train_time 7.597987431000007
Test Epoch10 layer4 Acc 0.8992, AUC 0.959296464920044, avg_entr 0.15794047713279724, f1 0.8992000222206116
ep10_l4_test_time 0.6716865650000017
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.938575 (37543/40000), AUC 0.9834388494491577
ep11_train_time 7.517118150000002
Test Epoch11 layer4 Acc 0.895, AUC 0.959434986114502, avg_entr 0.14186596870422363, f1 0.8949999809265137
ep11_l4_test_time 0.6849546040000121
gc 0
Train Epoch12 Acc 0.942275 (37691/40000), AUC 0.985117495059967
ep12_train_time 7.464758979999999
Test Epoch12 layer4 Acc 0.8994, AUC 0.9598495364189148, avg_entr 0.1338898241519928, f1 0.8993999361991882
ep12_l4_test_time 0.6495395410000242
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.946075 (37843/40000), AUC 0.9866454005241394
ep13_train_time 7.478231170999976
Test Epoch13 layer4 Acc 0.902, AUC 0.9599199891090393, avg_entr 0.12196801602840424, f1 0.9020000100135803
ep13_l4_test_time 0.6528370810000013
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.94925 (37970/40000), AUC 0.9880405068397522
ep14_train_time 7.496993873000008
Test Epoch14 layer4 Acc 0.9008, AUC 0.9597620964050293, avg_entr 0.11241327971220016, f1 0.9007999897003174
ep14_l4_test_time 0.6641664429999992
gc 0
Train Epoch15 Acc 0.94965 (37986/40000), AUC 0.9885802268981934
ep15_train_time 7.394749171000001
Test Epoch15 layer4 Acc 0.8974, AUC 0.9594045877456665, avg_entr 0.09720613807439804, f1 0.8974000215530396
ep15_l4_test_time 0.6744454079999969
gc 0
Train Epoch16 Acc 0.954125 (38165/40000), AUC 0.9898998737335205
ep16_train_time 7.4014794379999955
Test Epoch16 layer4 Acc 0.8988, AUC 0.9594613313674927, avg_entr 0.08909903466701508, f1 0.8988000154495239
ep16_l4_test_time 0.6796431939999934
gc 0
Train Epoch17 Acc 0.954875 (38195/40000), AUC 0.9905154705047607
ep17_train_time 7.379308871999996
Test Epoch17 layer4 Acc 0.8982, AUC 0.9588248133659363, avg_entr 0.08071339875459671, f1 0.8981999754905701
ep17_l4_test_time 0.6450053730000036
gc 0
Train Epoch18 Acc 0.9586 (38344/40000), AUC 0.991480827331543
ep18_train_time 7.83151861799999
Test Epoch18 layer4 Acc 0.8956, AUC 0.9582580327987671, avg_entr 0.07478175312280655, f1 0.8956000208854675
ep18_l4_test_time 0.6894770789999995
gc 0
Train Epoch19 Acc 0.96 (38400/40000), AUC 0.9918313026428223
ep19_train_time 7.769252039999998
Test Epoch19 layer4 Acc 0.895, AUC 0.9573575258255005, avg_entr 0.06874990463256836, f1 0.8949999809265137
ep19_l4_test_time 0.6738149000000249
Best AUC tensor(0.9020) 13
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 167.959869994
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.895, AUC 0.9549556970596313, avg_entr 0.19705264270305634, f1 0.8949999809265137
l0_test_time 0.6806463340000164
gc 0
Test layer1 Acc 0.8952, AUC 0.9552344083786011, avg_entr 0.17959149181842804, f1 0.8952000141143799
l1_test_time 0.6754374759999848
gc 0
Test layer2 Acc 0.8952, AUC 0.9554617404937744, avg_entr 0.16617344319820404, f1 0.8952000141143799
l2_test_time 0.6892507660000149
gc 0
Test layer3 Acc 0.8954, AUC 0.955816388130188, avg_entr 0.14942984282970428, f1 0.8953999876976013
l3_test_time 0.6992629679999993
gc 0
Test layer4 Acc 0.8954, AUC 0.9561285972595215, avg_entr 0.12635865807533264, f1 0.8953999876976013
l4_test_time 0.6758783150000056
gc 0
Test threshold 0.1 Acc 0.8954, AUC 0.955061674118042, avg_entr 0.1955869197845459, f1 0.8953999876976013
t0.1_test_time 1.035039936000004
gc 0
Test threshold 0.2 Acc 0.8954, AUC 0.954513669013977, avg_entr 0.20995618402957916, f1 0.8953999876976013
t0.2_test_time 1.0402133300000003
gc 0
Test threshold 0.3 Acc 0.8954, AUC 0.9541462063789368, avg_entr 0.22304673492908478, f1 0.8953999876976013
t0.3_test_time 1.1708994020000034
gc 0
Test threshold 0.4 Acc 0.8954, AUC 0.953894317150116, avg_entr 0.2360290288925171, f1 0.8953999876976013
t0.4_test_time 0.993600889000021
gc 0
Test threshold 0.5 Acc 0.8954, AUC 0.9542810916900635, avg_entr 0.2487189769744873, f1 0.8953999876976013
t0.5_test_time 0.9787349400000096
gc 0
Test threshold 0.6 Acc 0.8954, AUC 0.9546317458152771, avg_entr 0.2590945363044739, f1 0.8953999876976013
t0.6_test_time 0.9636436330000038
gc 0
Test threshold 0.7 Acc 0.8954, AUC 0.9546756744384766, avg_entr 0.26726746559143066, f1 0.8953999876976013
t0.7_test_time 0.9628578669999968
gc 0
Test threshold 0.8 Acc 0.8954, AUC 0.954531192779541, avg_entr 0.27433136105537415, f1 0.8953999876976013
t0.8_test_time 0.9876430269999901
gc 0
Test threshold 0.9 Acc 0.8954, AUC 0.9546917080879211, avg_entr 0.2803865373134613, f1 0.8953999876976013
t0.9_test_time 0.9691265529999953
