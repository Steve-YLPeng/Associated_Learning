total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 56.220405628
Start Training
gc 0
Train Epoch0 Acc 0.2809 (33708/120000), AUC 0.5130440592765808
ep0_train_time 181.645992499
Test Epoch0 layer4 Acc 0.4518421052631579, AUC 0.8222889304161072, avg_entr 1.2186568975448608, f1 0.4518420994281769
ep0_l4_test_time 1.6446635249999986
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.87145 (104574/120000), AUC 0.9588452577590942
ep1_train_time 179.14187514500003
Test Epoch1 layer4 Acc 0.8957894736842106, AUC 0.9760441780090332, avg_entr 0.2607142925262451, f1 0.8957894444465637
ep1_l4_test_time 1.597016176000011
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.910825 (109299/120000), AUC 0.9791498184204102
ep2_train_time 178.65283289399997
Test Epoch2 layer4 Acc 0.9073684210526316, AUC 0.9806103706359863, avg_entr 0.14788818359375, f1 0.9073684215545654
ep2_l4_test_time 1.6040496489999896
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9212 (110544/120000), AUC 0.9830394983291626
ep3_train_time 180.618570868
Test Epoch3 layer4 Acc 0.9157894736842105, AUC 0.9821839332580566, avg_entr 0.11393818259239197, f1 0.9157894849777222
ep3_l4_test_time 1.6336698779999779
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9281583333333333 (111379/120000), AUC 0.9854163527488708
ep4_train_time 178.77837240500003
Test Epoch4 layer4 Acc 0.9181578947368421, AUC 0.9829663634300232, avg_entr 0.09033417701721191, f1 0.9181578755378723
ep4_l4_test_time 1.595607125000015
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9329166666666666 (111950/120000), AUC 0.987108588218689
ep5_train_time 180.39330307600005
Test Epoch5 layer4 Acc 0.9205263157894736, AUC 0.9836102724075317, avg_entr 0.07258636504411697, f1 0.9205263257026672
ep5_l4_test_time 1.574439638000058
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9372833333333334 (112474/120000), AUC 0.9885646104812622
ep6_train_time 182.41767023600005
Test Epoch6 layer4 Acc 0.9228947368421052, AUC 0.9835753440856934, avg_entr 0.05354480445384979, f1 0.9228947162628174
ep6_l4_test_time 1.5835548589998325
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.940475 (112857/120000), AUC 0.9894355535507202
ep7_train_time 180.33252198900004
Test Epoch7 layer4 Acc 0.9205263157894736, AUC 0.9836002588272095, avg_entr 0.04828441143035889, f1 0.9205263257026672
ep7_l4_test_time 1.534384517999797
gc 0
Train Epoch8 Acc 0.9433083333333333 (113197/120000), AUC 0.9902650713920593
ep8_train_time 180.3982627759999
Test Epoch8 layer4 Acc 0.9186842105263158, AUC 0.9832754135131836, avg_entr 0.04419225826859474, f1 0.918684184551239
ep8_l4_test_time 1.588363710000067
gc 0
Train Epoch9 Acc 0.9457916666666667 (113495/120000), AUC 0.9910151958465576
ep9_train_time 177.48088999200013
Test Epoch9 layer4 Acc 0.9207894736842105, AUC 0.9834548234939575, avg_entr 0.03930842876434326, f1 0.9207894802093506
ep9_l4_test_time 1.634733481000012
gc 0
Train Epoch10 Acc 0.947825 (113739/120000), AUC 0.991625964641571
ep10_train_time 179.00317973899996
Test Epoch10 layer4 Acc 0.9210526315789473, AUC 0.9829422235488892, avg_entr 0.03882965072989464, f1 0.9210526347160339
ep10_l4_test_time 1.5748021399999743
gc 0
Train Epoch11 Acc 0.9494666666666667 (113936/120000), AUC 0.9920099973678589
ep11_train_time 166.3115092009998
Test Epoch11 layer4 Acc 0.9192105263157895, AUC 0.9824838638305664, avg_entr 0.033491101115942, f1 0.9192105531692505
ep11_l4_test_time 1.1672950769998351
gc 0
Train Epoch12 Acc 0.9514333333333334 (114172/120000), AUC 0.9924639463424683
ep12_train_time 181.91819370299982
Test Epoch12 layer4 Acc 0.9207894736842105, AUC 0.982787549495697, avg_entr 0.031054049730300903, f1 0.9207894802093506
ep12_l4_test_time 1.6680399030001354
gc 0
Train Epoch13 Acc 0.9529916666666667 (114359/120000), AUC 0.9927893877029419
ep13_train_time 184.63124749999997
Test Epoch13 layer4 Acc 0.9210526315789473, AUC 0.9823120832443237, avg_entr 0.030017701908946037, f1 0.9210526347160339
ep13_l4_test_time 1.6894929479999519
gc 0
Train Epoch14 Acc 0.954075 (114489/120000), AUC 0.9931553602218628
ep14_train_time 184.42423212999984
Test Epoch14 layer4 Acc 0.9189473684210526, AUC 0.9819902181625366, avg_entr 0.028839265927672386, f1 0.9189472794532776
ep14_l4_test_time 1.5974603059999026
gc 0
Train Epoch15 Acc 0.9557666666666667 (114692/120000), AUC 0.993447482585907
ep15_train_time 186.77476650500012
Test Epoch15 layer4 Acc 0.9189473684210526, AUC 0.9818853139877319, avg_entr 0.027446772903203964, f1 0.9189472794532776
ep15_l4_test_time 1.637673495999934
gc 0
Train Epoch16 Acc 0.9569666666666666 (114836/120000), AUC 0.9937177300453186
ep16_train_time 184.76340505100006
Test Epoch16 layer4 Acc 0.916578947368421, AUC 0.9815022349357605, avg_entr 0.026785124093294144, f1 0.9165789484977722
ep16_l4_test_time 1.6461888419999013
gc 0
Train Epoch17 Acc 0.958275 (114993/120000), AUC 0.9939203858375549
ep17_train_time 184.97373316599987
Test Epoch17 layer4 Acc 0.9189473684210526, AUC 0.9816403388977051, avg_entr 0.024724192917346954, f1 0.9189472794532776
ep17_l4_test_time 1.546197256999676
gc 0
Train Epoch18 Acc 0.9592166666666667 (115106/120000), AUC 0.9941130876541138
ep18_train_time 182.599014076
Test Epoch18 layer4 Acc 0.9139473684210526, AUC 0.9810605645179749, avg_entr 0.023521551862359047, f1 0.913947343826294
ep18_l4_test_time 1.584574386999975
gc 0
Train Epoch19 Acc 0.9603 (115236/120000), AUC 0.9943208694458008
ep19_train_time 182.69448017299965
Test Epoch19 layer4 Acc 0.9168421052631579, AUC 0.980750322341919, avg_entr 0.022814959287643433, f1 0.9168421030044556
ep19_l4_test_time 1.6562242279997008
Best AUC tensor(0.9229) 6
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 3652.230942461
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9128947368421053, AUC 0.9797086715698242, avg_entr 0.14836814999580383, f1 0.9128947257995605
l0_test_time 0.31980064199979097
gc 0
Test layer1 Acc 0.9094736842105263, AUC 0.9823329448699951, avg_entr 0.05792964622378349, f1 0.9094736576080322
l1_test_time 0.5845814740000606
gc 0
Test layer2 Acc 0.9107894736842105, AUC 0.982501745223999, avg_entr 0.05303717777132988, f1 0.9107894897460938
l2_test_time 0.954186643000412
gc 0
Test layer3 Acc 0.9152631578947369, AUC 0.9820696115493774, avg_entr 0.055699631571769714, f1 0.9152631759643555
l3_test_time 1.313682494999739
gc 0
Test layer4 Acc 0.9142105263157895, AUC 0.9819483757019043, avg_entr 0.05801234766840935, f1 0.9142104983329773
l4_test_time 1.651753860000099
gc 0
Test threshold 0.1 Acc 0.9136842105263158, AUC 0.9776306748390198, avg_entr 0.050008200109004974, f1 0.9136841893196106
t0.1_test_time 1.219928937000077
gc 0
Test threshold 0.2 Acc 0.9126315789473685, AUC 0.9773560762405396, avg_entr 0.062053464353084564, f1 0.9126315712928772
t0.2_test_time 1.203851413999928
gc 0
Test threshold 0.3 Acc 0.9113157894736842, AUC 0.9775644540786743, avg_entr 0.07461032271385193, f1 0.9113157987594604
t0.3_test_time 1.0900227659999473
gc 0
Test threshold 0.4 Acc 0.9128947368421053, AUC 0.9782270193099976, avg_entr 0.08991101384162903, f1 0.9128947257995605
t0.4_test_time 0.7937595579996923
gc 0
Test threshold 0.5 Acc 0.9152631578947369, AUC 0.9795719385147095, avg_entr 0.10247619450092316, f1 0.9152631759643555
t0.5_test_time 0.6855613660000017
gc 0
Test threshold 0.6 Acc 0.9131578947368421, AUC 0.9797244071960449, avg_entr 0.1069362685084343, f1 0.9131578803062439
t0.6_test_time 0.4712435420001384
gc 0
Test threshold 0.7 Acc 0.9128947368421053, AUC 0.9797086715698242, avg_entr 0.10702498257160187, f1 0.9128947257995605
t0.7_test_time 0.36173418599992146
gc 0
Test threshold 0.8 Acc 0.9128947368421053, AUC 0.9797086715698242, avg_entr 0.10702498257160187, f1 0.9128947257995605
t0.8_test_time 0.4650196640000104
gc 0
Test threshold 0.9 Acc 0.9128947368421053, AUC 0.9797086715698242, avg_entr 0.10702498257160187, f1 0.9128947257995605
t0.9_test_time 0.3941270169998461
