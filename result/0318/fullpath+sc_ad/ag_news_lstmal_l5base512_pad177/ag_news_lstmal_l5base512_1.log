total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 50.742226947999995
Start Training
gc 0
Train Epoch0 Acc 0.2710916666666667 (32531/120000), AUC 0.5113743543624878
ep0_train_time 185.088914777
Test Epoch0 layer4 Acc 0.7118421052631579, AUC 0.8868887424468994, avg_entr 1.2390493154525757, f1 0.7118421792984009
ep0_l4_test_time 1.7125265990000003
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.88145 (105774/120000), AUC 0.9556868076324463
ep1_train_time 192.42094307899998
Test Epoch1 layer4 Acc 0.8976315789473684, AUC 0.9754643440246582, avg_entr 0.25527021288871765, f1 0.8976315855979919
ep1_l4_test_time 1.7413659869999947
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9106166666666666 (109274/120000), AUC 0.9786495566368103
ep2_train_time 193.17294219699994
Test Epoch2 layer4 Acc 0.9068421052631579, AUC 0.9796977043151855, avg_entr 0.15169258415699005, f1 0.9068421125411987
ep2_l4_test_time 1.6528804269999
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9207083333333334 (110485/120000), AUC 0.9826278686523438
ep3_train_time 182.25477070399995
Test Epoch3 layer4 Acc 0.9152631578947369, AUC 0.9804168343544006, avg_entr 0.10159093886613846, f1 0.9152631759643555
ep3_l4_test_time 1.780066654000052
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9276083333333334 (111313/120000), AUC 0.9850634336471558
ep4_train_time 193.855641772
Test Epoch4 layer4 Acc 0.9181578947368421, AUC 0.9815234541893005, avg_entr 0.07954156398773193, f1 0.9181578755378723
ep4_l4_test_time 1.672645469000031
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9330416666666667 (111965/120000), AUC 0.9866967797279358
ep5_train_time 191.19456360000004
Test Epoch5 layer4 Acc 0.9202631578947369, AUC 0.9816978573799133, avg_entr 0.06521430611610413, f1 0.9202631711959839
ep5_l4_test_time 1.6974482729999636
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9372666666666667 (112472/120000), AUC 0.9880515336990356
ep6_train_time 190.81502318499997
Test Epoch6 layer4 Acc 0.9205263157894736, AUC 0.9822927713394165, avg_entr 0.05622774362564087, f1 0.9205263257026672
ep6_l4_test_time 1.6566052719999789
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9405 (112860/120000), AUC 0.9891536235809326
ep7_train_time 185.1493959720001
Test Epoch7 layer4 Acc 0.9213157894736842, AUC 0.9824232459068298, avg_entr 0.045962344855070114, f1 0.9213157892227173
ep7_l4_test_time 1.2406689870001628
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9432666666666667 (113192/120000), AUC 0.9898549318313599
ep8_train_time 180.34176692899996
Test Epoch8 layer4 Acc 0.9210526315789473, AUC 0.9816521406173706, avg_entr 0.04113224148750305, f1 0.9210526347160339
ep8_l4_test_time 1.6989299840001877
gc 0
Train Epoch9 Acc 0.9456833333333333 (113482/120000), AUC 0.9906548261642456
ep9_train_time 193.20333591200006
Test Epoch9 layer4 Acc 0.9189473684210526, AUC 0.981629490852356, avg_entr 0.03615664690732956, f1 0.9189472794532776
ep9_l4_test_time 1.7481217510000988
gc 0
Train Epoch10 Acc 0.9479666666666666 (113756/120000), AUC 0.9910856485366821
ep10_train_time 185.29282522900007
Test Epoch10 layer4 Acc 0.9213157894736842, AUC 0.9811863899230957, avg_entr 0.035834964364767075, f1 0.9213157892227173
ep10_l4_test_time 1.5765638289999515
Save ckpt to ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.94995 (113994/120000), AUC 0.9916403293609619
ep11_train_time 190.85251835099962
Test Epoch11 layer4 Acc 0.9189473684210526, AUC 0.981144905090332, avg_entr 0.033387087285518646, f1 0.9189472794532776
ep11_l4_test_time 1.7174077800000305
gc 0
Train Epoch12 Acc 0.9515416666666666 (114185/120000), AUC 0.9922002553939819
ep12_train_time 192.24788128
Test Epoch12 layer4 Acc 0.9197368421052632, AUC 0.9813463687896729, avg_entr 0.030916953459382057, f1 0.9197368621826172
ep12_l4_test_time 1.6064105000000382
gc 0
Train Epoch13 Acc 0.9531833333333334 (114382/120000), AUC 0.9924188852310181
ep13_train_time 192.52883195999993
Test Epoch13 layer4 Acc 0.9160526315789473, AUC 0.980301022529602, avg_entr 0.028477255254983902, f1 0.9160526394844055
ep13_l4_test_time 1.6641387600002417
gc 0
Train Epoch14 Acc 0.9548416666666667 (114581/120000), AUC 0.9926465749740601
ep14_train_time 184.19343124599982
Test Epoch14 layer4 Acc 0.9171052631578948, AUC 0.980257511138916, avg_entr 0.02682293951511383, f1 0.9171052575111389
ep14_l4_test_time 1.7156455370000003
gc 0
Train Epoch15 Acc 0.9559 (114708/120000), AUC 0.9929871559143066
ep15_train_time 191.4729786400003
Test Epoch15 layer4 Acc 0.9189473684210526, AUC 0.9809986352920532, avg_entr 0.026098228991031647, f1 0.9189472794532776
ep15_l4_test_time 1.7146560520000094
gc 0
Train Epoch16 Acc 0.957425 (114891/120000), AUC 0.9932349324226379
ep16_train_time 193.28319074699994
Test Epoch16 layer4 Acc 0.9157894736842105, AUC 0.9802380204200745, avg_entr 0.024011075496673584, f1 0.9157894849777222
ep16_l4_test_time 1.6571269949999987
gc 0
Train Epoch17 Acc 0.95835 (115002/120000), AUC 0.9933537244796753
ep17_train_time 188.84137411499978
Test Epoch17 layer4 Acc 0.9176315789473685, AUC 0.9797207713127136, avg_entr 0.022310391068458557, f1 0.9176315665245056
ep17_l4_test_time 1.6430600230000891
gc 0
Train Epoch18 Acc 0.9597083333333334 (115165/120000), AUC 0.99370276927948
ep18_train_time 187.47305989300003
Test Epoch18 layer4 Acc 0.9186842105263158, AUC 0.9801889657974243, avg_entr 0.02254662849009037, f1 0.918684184551239
ep18_l4_test_time 1.6743424179999238
gc 0
Train Epoch19 Acc 0.9606666666666667 (115280/120000), AUC 0.9938199520111084
ep19_train_time 192.88918645499962
Test Epoch19 layer4 Acc 0.9157894736842105, AUC 0.979282557964325, avg_entr 0.022551560774445534, f1 0.9157894849777222
ep19_l4_test_time 1.6211372429997937
Best AUC tensor(0.9213) 10
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 3822.4967926510003
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base512_pad177//ag_news_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9118421052631579, AUC 0.9806643724441528, avg_entr 0.11075908690690994, f1 0.9118421077728271
l0_test_time 0.3042184780001662
gc 0
Test layer1 Acc 0.9097368421052632, AUC 0.9821304678916931, avg_entr 0.04335108771920204, f1 0.9097368717193604
l1_test_time 0.5561268530000234
gc 0
Test layer2 Acc 0.9107894736842105, AUC 0.9821525812149048, avg_entr 0.03764178231358528, f1 0.9107894897460938
l2_test_time 0.9784434309999597
gc 0
Test layer3 Acc 0.91, AUC 0.9805326461791992, avg_entr 0.035741060972213745, f1 0.9100000262260437
l3_test_time 1.3444637600000533
gc 0
Test layer4 Acc 0.9094736842105263, AUC 0.9804508686065674, avg_entr 0.03878230229020119, f1 0.9094736576080322
l4_test_time 1.7087575179998566
gc 0
Test threshold 0.1 Acc 0.9089473684210526, AUC 0.9781942367553711, avg_entr 0.036917783319950104, f1 0.9089473485946655
t0.1_test_time 1.1431466510002792
gc 0
Test threshold 0.2 Acc 0.9089473684210526, AUC 0.9774951934814453, avg_entr 0.045697230845689774, f1 0.9089473485946655
t0.2_test_time 1.137830446999942
gc 0
Test threshold 0.3 Acc 0.9084210526315789, AUC 0.9778053760528564, avg_entr 0.05601836368441582, f1 0.9084210395812988
t0.3_test_time 1.13958361899995
gc 0
Test threshold 0.4 Acc 0.9118421052631579, AUC 0.9799445867538452, avg_entr 0.06914110481739044, f1 0.9118421077728271
t0.4_test_time 0.9610963439999978
gc 0
Test threshold 0.5 Acc 0.9123684210526316, AUC 0.9805456399917603, avg_entr 0.07802994549274445, f1 0.9123684167861938
t0.5_test_time 0.6296220600002016
gc 0
Test threshold 0.6 Acc 0.9118421052631579, AUC 0.9806643724441528, avg_entr 0.07989578694105148, f1 0.9118421077728271
t0.6_test_time 0.4645226669999829
gc 0
Test threshold 0.7 Acc 0.9118421052631579, AUC 0.9806643724441528, avg_entr 0.07989578694105148, f1 0.9118421077728271
t0.7_test_time 0.4153989630003707
gc 0
Test threshold 0.8 Acc 0.9118421052631579, AUC 0.9806643724441528, avg_entr 0.07989578694105148, f1 0.9118421077728271
t0.8_test_time 0.43740715900003124
gc 0
Test threshold 0.9 Acc 0.9118421052631579, AUC 0.9806643724441528, avg_entr 0.07989578694105148, f1 0.9118421077728271
t0.9_test_time 0.3986259620000965
