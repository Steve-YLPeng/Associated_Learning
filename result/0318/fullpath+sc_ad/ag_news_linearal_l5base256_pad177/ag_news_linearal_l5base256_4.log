total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 26.366774445
Start Training
gc 0
Train Epoch0 Acc 0.4326083333333333 (51913/120000), AUC 0.6333277225494385
ep0_train_time 22.954737839999996
Test Epoch0 layer4 Acc 0.8728947368421053, AUC 0.9686524868011475, avg_entr 0.5436805486679077, f1 0.8728947639465332
ep0_l4_test_time 0.38293929299999974
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9016666666666666 (108200/120000), AUC 0.9757171273231506
ep1_train_time 20.587832870999996
Test Epoch1 layer4 Acc 0.911578947368421, AUC 0.9787464141845703, avg_entr 0.2064128965139389, f1 0.9115789532661438
ep1_l4_test_time 0.33191730999999436
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9195583333333334 (110347/120000), AUC 0.9827630519866943
ep2_train_time 21.552624538000003
Test Epoch2 layer4 Acc 0.9173684210526316, AUC 0.9803115129470825, avg_entr 0.14325298368930817, f1 0.9173683524131775
ep2_l4_test_time 0.38601869400000055
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9266916666666667 (111203/120000), AUC 0.985549807548523
ep3_train_time 21.710580507000003
Test Epoch3 layer4 Acc 0.92, AUC 0.981544017791748, avg_entr 0.11208458989858627, f1 0.9200000166893005
ep3_l4_test_time 0.3346889919999967
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9313 (111756/120000), AUC 0.9874312281608582
ep4_train_time 20.461910339000013
Test Epoch4 layer4 Acc 0.9210526315789473, AUC 0.9827102422714233, avg_entr 0.08902252465486526, f1 0.9210526347160339
ep4_l4_test_time 0.32765020200000095
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.935275 (112233/120000), AUC 0.9888362884521484
ep5_train_time 20.80901839400002
Test Epoch5 layer4 Acc 0.9231578947368421, AUC 0.9827560782432556, avg_entr 0.06928624212741852, f1 0.9231578707695007
ep5_l4_test_time 0.3540799579999998
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.93835 (112602/120000), AUC 0.9899189472198486
ep6_train_time 21.124777798999986
Test Epoch6 layer4 Acc 0.9242105263157895, AUC 0.9831877946853638, avg_entr 0.05369535833597183, f1 0.9242105484008789
ep6_l4_test_time 0.33739990500001227
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9402333333333334 (112828/120000), AUC 0.9905911684036255
ep7_train_time 20.06083769700001
Test Epoch7 layer4 Acc 0.9231578947368421, AUC 0.9823641777038574, avg_entr 0.043377723544836044, f1 0.9231578707695007
ep7_l4_test_time 0.3461244840000006
gc 0
Train Epoch8 Acc 0.9424833333333333 (113098/120000), AUC 0.9910290241241455
ep8_train_time 21.30273411600001
Test Epoch8 layer4 Acc 0.9236842105263158, AUC 0.9827805757522583, avg_entr 0.03476322069764137, f1 0.9236842393875122
ep8_l4_test_time 0.3527539670000124
gc 0
Train Epoch9 Acc 0.944075 (113289/120000), AUC 0.9912972450256348
ep9_train_time 20.903503941999986
Test Epoch9 layer4 Acc 0.9218421052631579, AUC 0.9812053442001343, avg_entr 0.029806600883603096, f1 0.921842098236084
ep9_l4_test_time 0.3622934599999894
gc 0
Train Epoch10 Acc 0.9458083333333334 (113497/120000), AUC 0.9918203949928284
ep10_train_time 20.854752122999997
Test Epoch10 layer4 Acc 0.9234210526315789, AUC 0.9817502498626709, avg_entr 0.028291825205087662, f1 0.9234210252761841
ep10_l4_test_time 0.37311629499998844
gc 0
Train Epoch11 Acc 0.947075 (113649/120000), AUC 0.9923456907272339
ep11_train_time 21.267877322000004
Test Epoch11 layer4 Acc 0.925, AUC 0.9810011982917786, avg_entr 0.025294562801718712, f1 0.925000011920929
ep11_l4_test_time 0.3460080259999927
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9479916666666667 (113759/120000), AUC 0.992703914642334
ep12_train_time 20.581338297000002
Test Epoch12 layer4 Acc 0.9228947368421052, AUC 0.9800950288772583, avg_entr 0.02466338500380516, f1 0.9228947162628174
ep12_l4_test_time 0.3826912899999684
gc 0
Train Epoch13 Acc 0.9495166666666667 (113942/120000), AUC 0.9931657314300537
ep13_train_time 21.125908715000037
Test Epoch13 layer4 Acc 0.9226315789473685, AUC 0.9819239377975464, avg_entr 0.023712225258350372, f1 0.922631561756134
ep13_l4_test_time 0.3636116370000195
gc 0
Train Epoch14 Acc 0.9503166666666667 (114038/120000), AUC 0.9935870170593262
ep14_train_time 21.469327082000007
Test Epoch14 layer4 Acc 0.921578947368421, AUC 0.9813370704650879, avg_entr 0.021346354857087135, f1 0.9215789437294006
ep14_l4_test_time 0.36524647300001334
gc 0
Train Epoch15 Acc 0.951275 (114153/120000), AUC 0.9939130544662476
ep15_train_time 20.20516221600002
Test Epoch15 layer4 Acc 0.9236842105263158, AUC 0.9809522032737732, avg_entr 0.0207431148737669, f1 0.9236842393875122
ep15_l4_test_time 0.3262257590000104
gc 0
Train Epoch16 Acc 0.9517666666666666 (114212/120000), AUC 0.9941030740737915
ep16_train_time 21.674373816000013
Test Epoch16 layer4 Acc 0.9221052631578948, AUC 0.9813507795333862, avg_entr 0.020377863198518753, f1 0.9221052527427673
ep16_l4_test_time 0.37251322500003425
gc 0
Train Epoch17 Acc 0.9527583333333334 (114331/120000), AUC 0.9942631125450134
ep17_train_time 20.636407690999988
Test Epoch17 layer4 Acc 0.9228947368421052, AUC 0.981372594833374, avg_entr 0.019737735390663147, f1 0.9228947162628174
ep17_l4_test_time 0.3483717309999861
gc 0
Train Epoch18 Acc 0.953075 (114369/120000), AUC 0.9943848848342896
ep18_train_time 20.27258848499997
Test Epoch18 layer4 Acc 0.9210526315789473, AUC 0.9807128310203552, avg_entr 0.01940050907433033, f1 0.9210526347160339
ep18_l4_test_time 0.3733078219999584
gc 0
Train Epoch19 Acc 0.9539 (114468/120000), AUC 0.9946101903915405
ep19_train_time 20.40741253699997
Test Epoch19 layer4 Acc 0.9205263157894736, AUC 0.9806579351425171, avg_entr 0.01802080310881138, f1 0.9205263257026672
ep19_l4_test_time 0.3394617259999677
Best AUC tensor(0.9250) 11
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 429.46569619999997
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9128947368421053, AUC 0.9809229373931885, avg_entr 0.07621500641107559, f1 0.9128947257995605
l0_test_time 0.33081322600003205
gc 0
Test layer1 Acc 0.9126315789473685, AUC 0.9803780317306519, avg_entr 0.07334015518426895, f1 0.9126315712928772
l1_test_time 0.3436452239999994
gc 0
Test layer2 Acc 0.9126315789473685, AUC 0.9810315370559692, avg_entr 0.062407564371824265, f1 0.9126315712928772
l2_test_time 0.34446724299999687
gc 0
Test layer3 Acc 0.9123684210526316, AUC 0.980758547782898, avg_entr 0.037628915160894394, f1 0.9123684167861938
l3_test_time 0.35060487300000887
gc 0
Test layer4 Acc 0.9126315789473685, AUC 0.9793218970298767, avg_entr 0.029401734471321106, f1 0.9126315712928772
l4_test_time 0.32966410000000224
gc 0
Test threshold 0.1 Acc 0.9128947368421053, AUC 0.9796709418296814, avg_entr 0.03262467682361603, f1 0.9128947257995605
t0.1_test_time 0.6868276220000098
gc 0
Test threshold 0.2 Acc 0.9126315789473685, AUC 0.9801533222198486, avg_entr 0.04058727249503136, f1 0.9126315712928772
t0.2_test_time 0.6105355170000166
gc 0
Test threshold 0.3 Acc 0.9134210526315789, AUC 0.9806948304176331, avg_entr 0.048965051770210266, f1 0.9134210348129272
t0.3_test_time 0.7135094829999957
gc 0
Test threshold 0.4 Acc 0.9128947368421053, AUC 0.9808789491653442, avg_entr 0.053164783865213394, f1 0.9128947257995605
t0.4_test_time 0.6116059770000106
gc 0
Test threshold 0.5 Acc 0.9126315789473685, AUC 0.9809163212776184, avg_entr 0.054545290768146515, f1 0.9126315712928772
t0.5_test_time 0.5848941490000357
gc 0
Test threshold 0.6 Acc 0.9126315789473685, AUC 0.9809180498123169, avg_entr 0.05487867817282677, f1 0.9126315712928772
t0.6_test_time 0.4268316400000458
gc 0
Test threshold 0.7 Acc 0.9128947368421053, AUC 0.9809229373931885, avg_entr 0.054977502673864365, f1 0.9128947257995605
t0.7_test_time 0.46779716800000415
gc 0
Test threshold 0.8 Acc 0.9128947368421053, AUC 0.9809229373931885, avg_entr 0.054977502673864365, f1 0.9128947257995605
t0.8_test_time 0.4494832929999575
gc 0
Test threshold 0.9 Acc 0.9128947368421053, AUC 0.9809229373931885, avg_entr 0.054977502673864365, f1 0.9128947257995605
t0.9_test_time 0.4447226359999945
