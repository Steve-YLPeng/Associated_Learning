total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 17.96458842
Start Training
gc 0
Train Epoch0 Acc 0.44245 (53094/120000), AUC 0.6308169960975647
ep0_train_time 22.076229892999997
Test Epoch0 layer4 Acc 0.8326315789473684, AUC 0.9422286748886108, avg_entr 0.5962790250778198, f1 0.832631528377533
ep0_l4_test_time 0.29534996399999613
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9008833333333334 (108106/120000), AUC 0.9754040837287903
ep1_train_time 19.623752857999996
Test Epoch1 layer4 Acc 0.9092105263157895, AUC 0.9788303971290588, avg_entr 0.20474156737327576, f1 0.9092105031013489
ep1_l4_test_time 0.2844498080000051
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9197666666666666 (110372/120000), AUC 0.9829899072647095
ep2_train_time 19.123431195000002
Test Epoch2 layer4 Acc 0.9113157894736842, AUC 0.9807240962982178, avg_entr 0.14918583631515503, f1 0.9113157987594604
ep2_l4_test_time 0.28461792700001354
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9267333333333333 (111208/120000), AUC 0.9857296943664551
ep3_train_time 19.349118138999998
Test Epoch3 layer4 Acc 0.9202631578947369, AUC 0.9818487167358398, avg_entr 0.11673101782798767, f1 0.9202631711959839
ep3_l4_test_time 0.3008074450000038
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9315 (111780/120000), AUC 0.9876634478569031
ep4_train_time 19.764283145999997
Test Epoch4 layer4 Acc 0.9210526315789473, AUC 0.9822946786880493, avg_entr 0.09207349270582199, f1 0.9210526347160339
ep4_l4_test_time 0.2936631450000107
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.935175 (112221/120000), AUC 0.9891519546508789
ep5_train_time 19.135096933
Test Epoch5 layer4 Acc 0.9218421052631579, AUC 0.9827505946159363, avg_entr 0.07447532564401627, f1 0.921842098236084
ep5_l4_test_time 0.2935034909999956
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.937875 (112545/120000), AUC 0.9902626276016235
ep6_train_time 19.142098679000014
Test Epoch6 layer4 Acc 0.9202631578947369, AUC 0.9832466840744019, avg_entr 0.058970559388399124, f1 0.9202631711959839
ep6_l4_test_time 0.2722780799999782
gc 0
Train Epoch7 Acc 0.9403333333333334 (112840/120000), AUC 0.9909985065460205
ep7_train_time 19.68212290300002
Test Epoch7 layer4 Acc 0.9221052631578948, AUC 0.983051061630249, avg_entr 0.04768860712647438, f1 0.9221052527427673
ep7_l4_test_time 0.32345793099997877
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9424166666666667 (113090/120000), AUC 0.9914392828941345
ep8_train_time 20.03395521499999
Test Epoch8 layer4 Acc 0.9221052631578948, AUC 0.9831498265266418, avg_entr 0.03731244057416916, f1 0.9221052527427673
ep8_l4_test_time 0.3063544709999917
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9439416666666667 (113273/120000), AUC 0.9918147325515747
ep9_train_time 19.443752530000012
Test Epoch9 layer4 Acc 0.9234210526315789, AUC 0.9814056158065796, avg_entr 0.033525288105010986, f1 0.9234210252761841
ep9_l4_test_time 0.29594994600000746
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9455666666666667 (113468/120000), AUC 0.9920718669891357
ep10_train_time 18.824303226999973
Test Epoch10 layer4 Acc 0.9202631578947369, AUC 0.9824549555778503, avg_entr 0.02990877442061901, f1 0.9202631711959839
ep10_l4_test_time 0.26898067100000844
gc 0
Train Epoch11 Acc 0.9472333333333334 (113668/120000), AUC 0.9925332069396973
ep11_train_time 19.439846011000014
Test Epoch11 layer4 Acc 0.9194736842105263, AUC 0.9819085001945496, avg_entr 0.026837816461920738, f1 0.9194737076759338
ep11_l4_test_time 0.2953427169999827
gc 0
Train Epoch12 Acc 0.9479416666666667 (113753/120000), AUC 0.9927569627761841
ep12_train_time 20.146444556999995
Test Epoch12 layer4 Acc 0.9210526315789473, AUC 0.9815510511398315, avg_entr 0.024590296670794487, f1 0.9210526347160339
ep12_l4_test_time 0.2853659049999919
gc 0
Train Epoch13 Acc 0.9492583333333333 (113911/120000), AUC 0.9932336211204529
ep13_train_time 19.481331865000016
Test Epoch13 layer4 Acc 0.9192105263157895, AUC 0.9816797971725464, avg_entr 0.023220999166369438, f1 0.9192105531692505
ep13_l4_test_time 0.29374721499999623
gc 0
Train Epoch14 Acc 0.9502833333333334 (114034/120000), AUC 0.9935877919197083
ep14_train_time 18.99481130999999
Test Epoch14 layer4 Acc 0.9210526315789473, AUC 0.9805627465248108, avg_entr 0.023905185982584953, f1 0.9210526347160339
ep14_l4_test_time 0.28567559300000767
gc 0
Train Epoch15 Acc 0.9515 (114180/120000), AUC 0.9938457012176514
ep15_train_time 19.60031234099995
Test Epoch15 layer4 Acc 0.9223684210526316, AUC 0.9808965921401978, avg_entr 0.021003136411309242, f1 0.9223684072494507
ep15_l4_test_time 0.305077013000016
gc 0
Train Epoch16 Acc 0.951925 (114231/120000), AUC 0.9940656423568726
ep16_train_time 19.446662285000002
Test Epoch16 layer4 Acc 0.921578947368421, AUC 0.9817527532577515, avg_entr 0.02008124440908432, f1 0.9215789437294006
ep16_l4_test_time 0.2934277159999965
gc 0
Train Epoch17 Acc 0.952775 (114333/120000), AUC 0.9942349791526794
ep17_train_time 19.431121046999976
Test Epoch17 layer4 Acc 0.9192105263157895, AUC 0.9815317392349243, avg_entr 0.019615260884165764, f1 0.9192105531692505
ep17_l4_test_time 0.2797947660000091
gc 0
Train Epoch18 Acc 0.953425 (114411/120000), AUC 0.9943443536758423
ep18_train_time 19.08485614099999
Test Epoch18 layer4 Acc 0.9202631578947369, AUC 0.9816365838050842, avg_entr 0.019611066207289696, f1 0.9202631711959839
ep18_l4_test_time 0.2767580810000254
gc 0
Train Epoch19 Acc 0.954025 (114483/120000), AUC 0.9944722652435303
ep19_train_time 19.902513177999992
Test Epoch19 layer4 Acc 0.9192105263157895, AUC 0.9815701842308044, avg_entr 0.018719764426350594, f1 0.9192105531692505
ep19_l4_test_time 0.31219348199999786
Best AUC tensor(0.9234) 9
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 399.108448883
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9110526315789473, AUC 0.9810456037521362, avg_entr 0.08388175815343857, f1 0.9110526442527771
l0_test_time 0.31527335399999856
gc 0
Test layer1 Acc 0.9113157894736842, AUC 0.980973482131958, avg_entr 0.08073482662439346, f1 0.9113157987594604
l1_test_time 0.3154116690000137
gc 0
Test layer2 Acc 0.9131578947368421, AUC 0.9812653660774231, avg_entr 0.0741063728928566, f1 0.9131578803062439
l2_test_time 0.29659845399999085
gc 0
Test layer3 Acc 0.9139473684210526, AUC 0.9823908805847168, avg_entr 0.05291244760155678, f1 0.913947343826294
l3_test_time 0.2979095900000175
gc 0
Test layer4 Acc 0.9136842105263158, AUC 0.9793869256973267, avg_entr 0.036148641258478165, f1 0.9136841893196106
l4_test_time 0.31203885999997283
gc 0
Test threshold 0.1 Acc 0.9134210526315789, AUC 0.9802882075309753, avg_entr 0.03838155418634415, f1 0.9134210348129272
t0.1_test_time 0.8882400489999895
gc 0
Test threshold 0.2 Acc 0.9123684210526316, AUC 0.9804847836494446, avg_entr 0.046918660402297974, f1 0.9123684167861938
t0.2_test_time 0.8447169540000345
gc 0
Test threshold 0.3 Acc 0.911578947368421, AUC 0.9808872938156128, avg_entr 0.05493008345365524, f1 0.9115789532661438
t0.3_test_time 0.8043131869999911
gc 0
Test threshold 0.4 Acc 0.9107894736842105, AUC 0.9809346795082092, avg_entr 0.058882229030132294, f1 0.9107894897460938
t0.4_test_time 0.8399373960000389
gc 0
Test threshold 0.5 Acc 0.9110526315789473, AUC 0.9810579419136047, avg_entr 0.06031358242034912, f1 0.9110526442527771
t0.5_test_time 0.6214807399999813
gc 0
Test threshold 0.6 Acc 0.9110526315789473, AUC 0.9810465574264526, avg_entr 0.06049817055463791, f1 0.9110526442527771
t0.6_test_time 0.5045319739999741
gc 0
Test threshold 0.7 Acc 0.9110526315789473, AUC 0.9810456037521362, avg_entr 0.06050790101289749, f1 0.9110526442527771
t0.7_test_time 0.5102123430000347
gc 0
Test threshold 0.8 Acc 0.9110526315789473, AUC 0.9810456037521362, avg_entr 0.06050790101289749, f1 0.9110526442527771
t0.8_test_time 0.5428819300000214
gc 0
Test threshold 0.9 Acc 0.9110526315789473, AUC 0.9810456037521362, avg_entr 0.06050790101289749, f1 0.9110526442527771
t0.9_test_time 0.46975411399995437
