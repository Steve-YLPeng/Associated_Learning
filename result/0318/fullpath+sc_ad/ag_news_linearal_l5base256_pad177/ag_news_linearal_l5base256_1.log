total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 17.552212336
Start Training
gc 0
Train Epoch0 Acc 0.4113 (49356/120000), AUC 0.626630425453186
ep0_train_time 19.867596432999996
Test Epoch0 layer4 Acc 0.8668421052631579, AUC 0.9479522705078125, avg_entr 0.5436921715736389, f1 0.8668420910835266
ep0_l4_test_time 0.2948623069999954
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9001166666666667 (108014/120000), AUC 0.975012481212616
ep1_train_time 19.171924971000003
Test Epoch1 layer4 Acc 0.9086842105263158, AUC 0.9792903661727905, avg_entr 0.20760022103786469, f1 0.9086841940879822
ep1_l4_test_time 0.3095220800000007
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.91935 (110322/120000), AUC 0.9829672574996948
ep2_train_time 19.10702880299999
Test Epoch2 layer4 Acc 0.9189473684210526, AUC 0.9809728860855103, avg_entr 0.1465808004140854, f1 0.9189472794532776
ep2_l4_test_time 0.2875744239999989
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9266916666666667 (111203/120000), AUC 0.9857333898544312
ep3_train_time 18.782288695000005
Test Epoch3 layer4 Acc 0.9192105263157895, AUC 0.9822590351104736, avg_entr 0.1158996969461441, f1 0.9192105531692505
ep3_l4_test_time 0.2766326969999966
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9315416666666667 (111785/120000), AUC 0.9876217246055603
ep4_train_time 18.640081551999998
Test Epoch4 layer4 Acc 0.9205263157894736, AUC 0.9826876521110535, avg_entr 0.0944155752658844, f1 0.9205263257026672
ep4_l4_test_time 0.280776000000003
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.934975 (112197/120000), AUC 0.9890928864479065
ep5_train_time 19.56694225400001
Test Epoch5 layer4 Acc 0.9221052631578948, AUC 0.9830374717712402, avg_entr 0.07355508953332901, f1 0.9221052527427673
ep5_l4_test_time 0.30134846999999354
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9380083333333333 (112561/120000), AUC 0.9902248978614807
ep6_train_time 19.396239817999998
Test Epoch6 layer4 Acc 0.9255263157894736, AUC 0.9834280014038086, avg_entr 0.059423018246889114, f1 0.9255263209342957
ep6_l4_test_time 0.30163221899999826
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.940025 (112803/120000), AUC 0.9910609722137451
ep7_train_time 19.099345691999986
Test Epoch7 layer4 Acc 0.9221052631578948, AUC 0.9834749698638916, avg_entr 0.047540903091430664, f1 0.9221052527427673
ep7_l4_test_time 0.2829623930000196
gc 0
Train Epoch8 Acc 0.9421666666666667 (113060/120000), AUC 0.991584300994873
ep8_train_time 18.278876876999988
Test Epoch8 layer4 Acc 0.925, AUC 0.9836797714233398, avg_entr 0.04013583064079285, f1 0.925000011920929
ep8_l4_test_time 0.2850691989999916
gc 0
Train Epoch9 Acc 0.943925 (113271/120000), AUC 0.9918271899223328
ep9_train_time 19.54356346200001
Test Epoch9 layer4 Acc 0.9223684210526316, AUC 0.982064962387085, avg_entr 0.03501603752374649, f1 0.9223684072494507
ep9_l4_test_time 0.2977429020000102
gc 0
Train Epoch10 Acc 0.9454833333333333 (113458/120000), AUC 0.9921915531158447
ep10_train_time 19.656715101999993
Test Epoch10 layer4 Acc 0.9228947368421052, AUC 0.981741189956665, avg_entr 0.028942467644810677, f1 0.9228947162628174
ep10_l4_test_time 0.2904509280000127
gc 0
Train Epoch11 Acc 0.9472333333333334 (113668/120000), AUC 0.9925695657730103
ep11_train_time 19.245955103
Test Epoch11 layer4 Acc 0.9213157894736842, AUC 0.9813567399978638, avg_entr 0.027037382125854492, f1 0.9213157892227173
ep11_l4_test_time 0.28942564800001946
gc 0
Train Epoch12 Acc 0.9478583333333334 (113743/120000), AUC 0.9929530024528503
ep12_train_time 18.362916686999995
Test Epoch12 layer4 Acc 0.9228947368421052, AUC 0.9819121360778809, avg_entr 0.02506675384938717, f1 0.9228947162628174
ep12_l4_test_time 0.2879269580000141
gc 0
Train Epoch13 Acc 0.9492833333333334 (113914/120000), AUC 0.9932994842529297
ep13_train_time 19.388110280999967
Test Epoch13 layer4 Acc 0.9226315789473685, AUC 0.9807994961738586, avg_entr 0.0229754988104105, f1 0.922631561756134
ep13_l4_test_time 0.2910071700000003
gc 0
Train Epoch14 Acc 0.9502666666666667 (114032/120000), AUC 0.9936497211456299
ep14_train_time 19.02606746699996
Test Epoch14 layer4 Acc 0.9218421052631579, AUC 0.9813705682754517, avg_entr 0.0213470496237278, f1 0.921842098236084
ep14_l4_test_time 0.28966513699998586
gc 0
Train Epoch15 Acc 0.9513916666666666 (114167/120000), AUC 0.9938281178474426
ep15_train_time 18.659040945999948
Test Epoch15 layer4 Acc 0.9231578947368421, AUC 0.9798919558525085, avg_entr 0.020306037738919258, f1 0.9231578707695007
ep15_l4_test_time 0.29046559700003627
gc 0
Train Epoch16 Acc 0.951825 (114219/120000), AUC 0.9940972328186035
ep16_train_time 18.545614089000026
Test Epoch16 layer4 Acc 0.9189473684210526, AUC 0.9804766178131104, avg_entr 0.020891644060611725, f1 0.9189472794532776
ep16_l4_test_time 0.2875330809999923
gc 0
Train Epoch17 Acc 0.9524916666666666 (114299/120000), AUC 0.9943606853485107
ep17_train_time 19.628012913999953
Test Epoch17 layer4 Acc 0.9218421052631579, AUC 0.980922281742096, avg_entr 0.02050890028476715, f1 0.921842098236084
ep17_l4_test_time 0.2894512569999961
gc 0
Train Epoch18 Acc 0.9530916666666667 (114371/120000), AUC 0.9945207834243774
ep18_train_time 19.326036971000008
Test Epoch18 layer4 Acc 0.92, AUC 0.9812251329421997, avg_entr 0.018391204997897148, f1 0.9200000166893005
ep18_l4_test_time 0.2879503139999997
gc 0
Train Epoch19 Acc 0.9539083333333334 (114469/120000), AUC 0.9946092367172241
ep19_train_time 18.913658194999982
Test Epoch19 layer4 Acc 0.9207894736842105, AUC 0.9812242984771729, avg_entr 0.01852194219827652, f1 0.9207894802093506
ep19_l4_test_time 0.28066007399996806
Best AUC tensor(0.9255) 6
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 389.474398995
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9123684210526316, AUC 0.9806597232818604, avg_entr 0.09997174143791199, f1 0.9123684167861938
l0_test_time 0.2752281420000031
gc 0
Test layer1 Acc 0.9118421052631579, AUC 0.9803557395935059, avg_entr 0.09654701501131058, f1 0.9118421077728271
l1_test_time 0.27811566399998355
gc 0
Test layer2 Acc 0.9113157894736842, AUC 0.9805914759635925, avg_entr 0.09297476708889008, f1 0.9113157987594604
l2_test_time 0.27052565200000345
gc 0
Test layer3 Acc 0.9118421052631579, AUC 0.981022834777832, avg_entr 0.08328575640916824, f1 0.9118421077728271
l3_test_time 0.28523374299999205
gc 0
Test layer4 Acc 0.9144736842105263, AUC 0.981458842754364, avg_entr 0.06468958407640457, f1 0.9144737124443054
l4_test_time 0.28732759500002203
gc 0
Test threshold 0.1 Acc 0.9142105263157895, AUC 0.9806313514709473, avg_entr 0.056793272495269775, f1 0.9142104983329773
t0.1_test_time 0.6230379999999514
gc 0
Test threshold 0.2 Acc 0.915, AUC 0.9806840419769287, avg_entr 0.06406999379396439, f1 0.9150000214576721
t0.2_test_time 0.6924358100000063
gc 0
Test threshold 0.3 Acc 0.9131578947368421, AUC 0.9806511402130127, avg_entr 0.06874526292085648, f1 0.9131578803062439
t0.3_test_time 0.6816377589999547
gc 0
Test threshold 0.4 Acc 0.9136842105263158, AUC 0.9805272817611694, avg_entr 0.07118849456310272, f1 0.9136841893196106
t0.4_test_time 0.6392238660000089
gc 0
Test threshold 0.5 Acc 0.9131578947368421, AUC 0.9806407690048218, avg_entr 0.07195030152797699, f1 0.9131578803062439
t0.5_test_time 0.6341271040000152
gc 0
Test threshold 0.6 Acc 0.9123684210526316, AUC 0.9806597232818604, avg_entr 0.07211437076330185, f1 0.9123684167861938
t0.6_test_time 0.3954643509999869
gc 0
Test threshold 0.7 Acc 0.9123684210526316, AUC 0.9806597232818604, avg_entr 0.07211437076330185, f1 0.9123684167861938
t0.7_test_time 0.4714934220000373
gc 0
Test threshold 0.8 Acc 0.9123684210526316, AUC 0.9806597232818604, avg_entr 0.07211437076330185, f1 0.9123684167861938
t0.8_test_time 0.41765435100001014
gc 0
Test threshold 0.9 Acc 0.9123684210526316, AUC 0.9806597232818604, avg_entr 0.07211437076330185, f1 0.9123684167861938
t0.9_test_time 0.4047878879999871
