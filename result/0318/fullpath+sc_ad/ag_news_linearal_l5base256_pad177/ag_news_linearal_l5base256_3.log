total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 26.726862807
Start Training
gc 0
Train Epoch0 Acc 0.45290833333333336 (54349/120000), AUC 0.668384850025177
ep0_train_time 22.208072851
Test Epoch0 layer4 Acc 0.886578947368421, AUC 0.9725559949874878, avg_entr 0.4116271436214447, f1 0.8865789771080017
ep0_l4_test_time 0.35178136399999715
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9045333333333333 (108544/120000), AUC 0.9770153164863586
ep1_train_time 19.869108956999995
Test Epoch1 layer4 Acc 0.9073684210526316, AUC 0.9788112640380859, avg_entr 0.20088937878608704, f1 0.9073684215545654
ep1_l4_test_time 0.32635636300000215
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.91945 (110334/120000), AUC 0.9828482270240784
ep2_train_time 21.206626431000004
Test Epoch2 layer4 Acc 0.9160526315789473, AUC 0.9811326265335083, avg_entr 0.14185532927513123, f1 0.9160526394844055
ep2_l4_test_time 0.33703961300000174
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9268666666666666 (111224/120000), AUC 0.9856964349746704
ep3_train_time 19.85145388699999
Test Epoch3 layer4 Acc 0.92, AUC 0.9819689989089966, avg_entr 0.10779345780611038, f1 0.9200000166893005
ep3_l4_test_time 0.31891184799999905
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9314416666666666 (111773/120000), AUC 0.9875537753105164
ep4_train_time 20.457773025999998
Test Epoch4 layer4 Acc 0.9210526315789473, AUC 0.9826240539550781, avg_entr 0.08603957295417786, f1 0.9210526347160339
ep4_l4_test_time 0.32602255899999477
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.93555 (112266/120000), AUC 0.9890428781509399
ep5_train_time 21.033132392
Test Epoch5 layer4 Acc 0.9221052631578948, AUC 0.9829888939857483, avg_entr 0.06776393204927444, f1 0.9221052527427673
ep5_l4_test_time 0.3511446459999945
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9383583333333333 (112603/120000), AUC 0.9899376630783081
ep6_train_time 20.30500255199999
Test Epoch6 layer4 Acc 0.9231578947368421, AUC 0.98330157995224, avg_entr 0.0508420430123806, f1 0.9231578707695007
ep6_l4_test_time 0.35197817700000655
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.940425 (112851/120000), AUC 0.9906203746795654
ep7_train_time 21.097424603999997
Test Epoch7 layer4 Acc 0.9226315789473685, AUC 0.9830431938171387, avg_entr 0.041428692638874054, f1 0.922631561756134
ep7_l4_test_time 0.3688791739999999
gc 0
Train Epoch8 Acc 0.94275 (113130/120000), AUC 0.9909434914588928
ep8_train_time 20.555577397999997
Test Epoch8 layer4 Acc 0.9223684210526316, AUC 0.9828765988349915, avg_entr 0.03524385020136833, f1 0.9223684072494507
ep8_l4_test_time 0.32238035199998194
gc 0
Train Epoch9 Acc 0.9443083333333333 (113317/120000), AUC 0.9913235306739807
ep9_train_time 19.832868773
Test Epoch9 layer4 Acc 0.9213157894736842, AUC 0.9820666313171387, avg_entr 0.03228043019771576, f1 0.9213157892227173
ep9_l4_test_time 0.36504179199999953
gc 0
Train Epoch10 Acc 0.9455833333333333 (113470/120000), AUC 0.9919171333312988
ep10_train_time 21.677092482000006
Test Epoch10 layer4 Acc 0.9244736842105263, AUC 0.9823336601257324, avg_entr 0.02809738554060459, f1 0.9244737029075623
ep10_l4_test_time 0.35321355600001425
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9471166666666667 (113654/120000), AUC 0.9923804998397827
ep11_train_time 20.675797773
Test Epoch11 layer4 Acc 0.9239473684210526, AUC 0.9802879095077515, avg_entr 0.02689940668642521, f1 0.9239473938941956
ep11_l4_test_time 0.34455304200002956
gc 0
Train Epoch12 Acc 0.9480916666666667 (113771/120000), AUC 0.9927123785018921
ep12_train_time 20.721034945999975
Test Epoch12 layer4 Acc 0.9221052631578948, AUC 0.9819146394729614, avg_entr 0.02494487166404724, f1 0.9221052527427673
ep12_l4_test_time 0.3521455700000047
gc 0
Train Epoch13 Acc 0.9490333333333333 (113884/120000), AUC 0.9931392669677734
ep13_train_time 20.867172558999982
Test Epoch13 layer4 Acc 0.9210526315789473, AUC 0.981475830078125, avg_entr 0.023796459659934044, f1 0.9210526347160339
ep13_l4_test_time 0.3376071780000416
gc 0
Train Epoch14 Acc 0.9503916666666666 (114047/120000), AUC 0.9934490919113159
ep14_train_time 20.083034677
Test Epoch14 layer4 Acc 0.9223684210526316, AUC 0.9808614253997803, avg_entr 0.02127915620803833, f1 0.9223684072494507
ep14_l4_test_time 0.3449128779999455
gc 0
Train Epoch15 Acc 0.9509416666666667 (114113/120000), AUC 0.9937828779220581
ep15_train_time 20.980525115999967
Test Epoch15 layer4 Acc 0.9218421052631579, AUC 0.9799381494522095, avg_entr 0.02232082560658455, f1 0.921842098236084
ep15_l4_test_time 0.3369313809999994
gc 0
Train Epoch16 Acc 0.951775 (114213/120000), AUC 0.9939753413200378
ep16_train_time 20.579223882999997
Test Epoch16 layer4 Acc 0.921578947368421, AUC 0.9816235899925232, avg_entr 0.020863141864538193, f1 0.9215789437294006
ep16_l4_test_time 0.34308138199997984
gc 0
Train Epoch17 Acc 0.9522416666666667 (114269/120000), AUC 0.9941360950469971
ep17_train_time 20.491915748999986
Test Epoch17 layer4 Acc 0.921578947368421, AUC 0.9797958135604858, avg_entr 0.019524933770298958, f1 0.9215789437294006
ep17_l4_test_time 0.3560681039999736
gc 0
Train Epoch18 Acc 0.9532 (114384/120000), AUC 0.9943294525146484
ep18_train_time 21.617201387999955
Test Epoch18 layer4 Acc 0.9194736842105263, AUC 0.9808134436607361, avg_entr 0.020504262298345566, f1 0.9194737076759338
ep18_l4_test_time 0.3504550530000188
gc 0
Train Epoch19 Acc 0.9537583333333334 (114451/120000), AUC 0.9944179058074951
ep19_train_time 20.458845893999978
Test Epoch19 layer4 Acc 0.9202631578947369, AUC 0.980928361415863, avg_entr 0.01888471283018589, f1 0.9202631711959839
ep19_l4_test_time 0.31143467999999075
Best AUC tensor(0.9245) 10
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 423.769389139
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9139473684210526, AUC 0.980893075466156, avg_entr 0.07859525084495544, f1 0.913947343826294
l0_test_time 0.3226869060000013
gc 0
Test layer1 Acc 0.9134210526315789, AUC 0.9805067777633667, avg_entr 0.07609683275222778, f1 0.9134210348129272
l1_test_time 0.3356884479999849
gc 0
Test layer2 Acc 0.9142105263157895, AUC 0.9809616208076477, avg_entr 0.0678882747888565, f1 0.9142104983329773
l2_test_time 0.3464706419999857
gc 0
Test layer3 Acc 0.9144736842105263, AUC 0.9811041355133057, avg_entr 0.04148894175887108, f1 0.9144737124443054
l3_test_time 0.33875910200004
gc 0
Test layer4 Acc 0.9128947368421053, AUC 0.9801121950149536, avg_entr 0.03173384070396423, f1 0.9128947257995605
l4_test_time 0.33338706099999627
gc 0
Test threshold 0.1 Acc 0.9139473684210526, AUC 0.9796191453933716, avg_entr 0.03421318158507347, f1 0.913947343826294
t0.1_test_time 0.6613094399999682
gc 0
Test threshold 0.2 Acc 0.9126315789473685, AUC 0.9802861213684082, avg_entr 0.04221709072589874, f1 0.9126315712928772
t0.2_test_time 0.5930183760000318
gc 0
Test threshold 0.3 Acc 0.9128947368421053, AUC 0.9806618690490723, avg_entr 0.05098087340593338, f1 0.9128947257995605
t0.3_test_time 0.5871872230000008
gc 0
Test threshold 0.4 Acc 0.9128947368421053, AUC 0.9807902574539185, avg_entr 0.055021170526742935, f1 0.9128947257995605
t0.4_test_time 0.5331741280000415
gc 0
Test threshold 0.5 Acc 0.9134210526315789, AUC 0.9808902740478516, avg_entr 0.056469909846782684, f1 0.9134210348129272
t0.5_test_time 0.4723667510000382
gc 0
Test threshold 0.6 Acc 0.9139473684210526, AUC 0.9808923602104187, avg_entr 0.056688398122787476, f1 0.913947343826294
t0.6_test_time 0.5507015530000103
gc 0
Test threshold 0.7 Acc 0.9139473684210526, AUC 0.980893075466156, avg_entr 0.05669449269771576, f1 0.913947343826294
t0.7_test_time 0.43564539800001967
gc 0
Test threshold 0.8 Acc 0.9139473684210526, AUC 0.980893075466156, avg_entr 0.05669449269771576, f1 0.913947343826294
t0.8_test_time 0.46363054799996917
gc 0
Test threshold 0.9 Acc 0.9139473684210526, AUC 0.980893075466156, avg_entr 0.05669449269771576, f1 0.913947343826294
t0.9_test_time 0.3631904679999707
