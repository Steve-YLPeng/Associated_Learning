total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 26.003577528
Start Training
gc 0
Train Epoch0 Acc 0.43151666666666666 (51782/120000), AUC 0.6377694010734558
ep0_train_time 21.612730262
Test Epoch0 layer4 Acc 0.8565789473684211, AUC 0.9598571062088013, avg_entr 0.5194263458251953, f1 0.8565789461135864
ep0_l4_test_time 0.33902785700000493
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9032416666666667 (108389/120000), AUC 0.9762356281280518
ep1_train_time 20.881992441
Test Epoch1 layer4 Acc 0.9105263157894737, AUC 0.9792709350585938, avg_entr 0.20546209812164307, f1 0.9105263352394104
ep1_l4_test_time 0.3616955749999988
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.920025 (110403/120000), AUC 0.9831143617630005
ep2_train_time 21.078720051000005
Test Epoch2 layer4 Acc 0.9157894736842105, AUC 0.980988621711731, avg_entr 0.1420832872390747, f1 0.9157894849777222
ep2_l4_test_time 0.3578725379999952
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9268916666666667 (111227/120000), AUC 0.985876739025116
ep3_train_time 19.853070781
Test Epoch3 layer4 Acc 0.9221052631578948, AUC 0.9820371270179749, avg_entr 0.11142585426568985, f1 0.9221052527427673
ep3_l4_test_time 0.34273438699999303
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9320833333333334 (111850/120000), AUC 0.9877426624298096
ep4_train_time 21.022186966000007
Test Epoch4 layer4 Acc 0.9236842105263158, AUC 0.9826983213424683, avg_entr 0.09028160572052002, f1 0.9236842393875122
ep4_l4_test_time 0.33587675500001524
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9352166666666667 (112226/120000), AUC 0.9891420602798462
ep5_train_time 20.557726625000015
Test Epoch5 layer4 Acc 0.9242105263157895, AUC 0.983357310295105, avg_entr 0.0719173476099968, f1 0.9242105484008789
ep5_l4_test_time 0.3434368769999878
Save ckpt to ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.938175 (112581/120000), AUC 0.9902217984199524
ep6_train_time 19.979955676999992
Test Epoch6 layer4 Acc 0.9218421052631579, AUC 0.9836453199386597, avg_entr 0.058665771037340164, f1 0.921842098236084
ep6_l4_test_time 0.385441362999984
gc 0
Train Epoch7 Acc 0.940375 (112845/120000), AUC 0.9909681677818298
ep7_train_time 21.47642783500001
Test Epoch7 layer4 Acc 0.9231578947368421, AUC 0.9833632707595825, avg_entr 0.0482248030602932, f1 0.9231578707695007
ep7_l4_test_time 0.32911685600001306
gc 0
Train Epoch8 Acc 0.941975 (113037/120000), AUC 0.9914566874504089
ep8_train_time 20.463695720999993
Test Epoch8 layer4 Acc 0.9236842105263158, AUC 0.9820685386657715, avg_entr 0.040034882724285126, f1 0.9236842393875122
ep8_l4_test_time 0.3428758850000122
gc 0
Train Epoch9 Acc 0.9437583333333334 (113251/120000), AUC 0.9919513463973999
ep9_train_time 20.980426152999996
Test Epoch9 layer4 Acc 0.9228947368421052, AUC 0.9813655614852905, avg_entr 0.03316573053598404, f1 0.9228947162628174
ep9_l4_test_time 0.34736777700001653
gc 0
Train Epoch10 Acc 0.9456666666666667 (113480/120000), AUC 0.9919849038124084
ep10_train_time 20.67184716699998
Test Epoch10 layer4 Acc 0.9228947368421052, AUC 0.9808759689331055, avg_entr 0.030397390946745872, f1 0.9228947162628174
ep10_l4_test_time 0.33084100199999966
gc 0
Train Epoch11 Acc 0.9464833333333333 (113578/120000), AUC 0.9924101829528809
ep11_train_time 20.28604900900001
Test Epoch11 layer4 Acc 0.9228947368421052, AUC 0.9811506271362305, avg_entr 0.026771798729896545, f1 0.9228947162628174
ep11_l4_test_time 0.3188938430000121
gc 0
Train Epoch12 Acc 0.9478666666666666 (113744/120000), AUC 0.9926083087921143
ep12_train_time 20.818170543999997
Test Epoch12 layer4 Acc 0.921578947368421, AUC 0.9804873466491699, avg_entr 0.02443750947713852, f1 0.9215789437294006
ep12_l4_test_time 0.32931220099999337
gc 0
Train Epoch13 Acc 0.9494083333333333 (113929/120000), AUC 0.9929878115653992
ep13_train_time 20.336437811999986
Test Epoch13 layer4 Acc 0.9218421052631579, AUC 0.9816830158233643, avg_entr 0.025065965950489044, f1 0.921842098236084
ep13_l4_test_time 0.33999368100000993
gc 0
Train Epoch14 Acc 0.9504583333333333 (114055/120000), AUC 0.9933676719665527
ep14_train_time 20.20597473500004
Test Epoch14 layer4 Acc 0.9231578947368421, AUC 0.9814563989639282, avg_entr 0.0215738657861948, f1 0.9231578707695007
ep14_l4_test_time 0.33462110800002165
gc 0
Train Epoch15 Acc 0.9510083333333333 (114121/120000), AUC 0.9936337471008301
ep15_train_time 21.323216189999982
Test Epoch15 layer4 Acc 0.9205263157894736, AUC 0.9805421829223633, avg_entr 0.022407039999961853, f1 0.9205263257026672
ep15_l4_test_time 0.3524231189999796
gc 0
Train Epoch16 Acc 0.9520583333333333 (114247/120000), AUC 0.993777871131897
ep16_train_time 20.040698150999958
Test Epoch16 layer4 Acc 0.9207894736842105, AUC 0.9812250137329102, avg_entr 0.01961313746869564, f1 0.9207894802093506
ep16_l4_test_time 0.34985444900001994
gc 0
Train Epoch17 Acc 0.9523083333333333 (114277/120000), AUC 0.9939875602722168
ep17_train_time 20.515239020000024
Test Epoch17 layer4 Acc 0.9207894736842105, AUC 0.9808143973350525, avg_entr 0.01894262060523033, f1 0.9207894802093506
ep17_l4_test_time 0.3721222259999877
gc 0
Train Epoch18 Acc 0.95305 (114366/120000), AUC 0.9942352771759033
ep18_train_time 20.441290422999998
Test Epoch18 layer4 Acc 0.921578947368421, AUC 0.9812105894088745, avg_entr 0.020905502140522003, f1 0.9215789437294006
ep18_l4_test_time 0.32927189199995155
gc 0
Train Epoch19 Acc 0.953725 (114447/120000), AUC 0.994320273399353
ep19_train_time 20.360321605000024
Test Epoch19 layer4 Acc 0.9197368421052632, AUC 0.9801181554794312, avg_entr 0.018644843250513077, f1 0.9197368621826172
ep19_l4_test_time 0.3473273569999833
Best AUC tensor(0.9242) 5
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 421.976008339
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base256_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9131578947368421, AUC 0.980431318283081, avg_entr 0.10955894738435745, f1 0.9131578803062439
l0_test_time 0.36594345599996814
gc 0
Test layer1 Acc 0.9128947368421053, AUC 0.9804363250732422, avg_entr 0.1046234592795372, f1 0.9128947257995605
l1_test_time 0.3454997160000062
gc 0
Test layer2 Acc 0.9128947368421053, AUC 0.9805260300636292, avg_entr 0.10107564181089401, f1 0.9128947257995605
l2_test_time 0.3602557490000322
gc 0
Test layer3 Acc 0.9128947368421053, AUC 0.9810343980789185, avg_entr 0.09169638901948929, f1 0.9128947257995605
l3_test_time 0.3681868219999842
gc 0
Test layer4 Acc 0.9126315789473685, AUC 0.9812899231910706, avg_entr 0.07672399282455444, f1 0.9126315712928772
l4_test_time 0.3309487669999953
gc 0
Test threshold 0.1 Acc 0.9126315789473685, AUC 0.9803159832954407, avg_entr 0.06479346752166748, f1 0.9126315712928772
t0.1_test_time 0.6413294730000416
gc 0
Test threshold 0.2 Acc 0.9126315789473685, AUC 0.9803729057312012, avg_entr 0.0707726776599884, f1 0.9126315712928772
t0.2_test_time 0.5828346310000256
gc 0
Test threshold 0.3 Acc 0.9123684210526316, AUC 0.9805101156234741, avg_entr 0.07487553358078003, f1 0.9123684167861938
t0.3_test_time 0.6615090770000052
gc 0
Test threshold 0.4 Acc 0.9126315789473685, AUC 0.9804296493530273, avg_entr 0.07763783633708954, f1 0.9126315712928772
t0.4_test_time 0.7630653780000216
gc 0
Test threshold 0.5 Acc 0.9128947368421053, AUC 0.9804517030715942, avg_entr 0.0787629708647728, f1 0.9128947257995605
t0.5_test_time 0.7751520269999901
gc 0
Test threshold 0.6 Acc 0.9131578947368421, AUC 0.980431318283081, avg_entr 0.07903008162975311, f1 0.9131578803062439
t0.6_test_time 0.504168954000022
gc 0
Test threshold 0.7 Acc 0.9131578947368421, AUC 0.980431318283081, avg_entr 0.07903008162975311, f1 0.9131578803062439
t0.7_test_time 0.506672424000044
gc 0
Test threshold 0.8 Acc 0.9131578947368421, AUC 0.980431318283081, avg_entr 0.07903008162975311, f1 0.9131578803062439
t0.8_test_time 0.506553069000006
gc 0
Test threshold 0.9 Acc 0.9131578947368421, AUC 0.980431318283081, avg_entr 0.07903008162975311, f1 0.9131578803062439
t0.9_test_time 0.5391382239999984
