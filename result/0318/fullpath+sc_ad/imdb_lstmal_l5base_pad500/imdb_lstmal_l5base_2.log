total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 24.0689531
Start Training
gc 0
Train Epoch0 Acc 0.5062 (20248/40000), AUC 0.5090475678443909
ep0_train_time 155.099146724
Test Epoch0 layer4 Acc 0.5024, AUC 0.694137692451477, avg_entr 0.6865986585617065, f1 0.5023999810218811
ep0_l4_test_time 5.612497224000009
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.78925 (31570/40000), AUC 0.8482928276062012
ep1_train_time 155.33562135800003
Test Epoch1 layer4 Acc 0.8524, AUC 0.9159939885139465, avg_entr 0.10848165303468704, f1 0.852400004863739
ep1_l4_test_time 5.559748113000012
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.7828 (31312/40000), AUC 0.8615132570266724
ep2_train_time 155.23283976599998
Test Epoch2 layer4 Acc 0.819, AUC 0.9174817204475403, avg_entr 0.10457882285118103, f1 0.8190000057220459
ep2_l4_test_time 5.549494577000019
gc 0
Train Epoch3 Acc 0.82895 (33158/40000), AUC 0.88713538646698
ep3_train_time 155.50248493200002
Test Epoch3 layer4 Acc 0.8134, AUC 0.9061231017112732, avg_entr 0.04207723215222359, f1 0.8133999109268188
ep3_l4_test_time 5.496915634000061
gc 0
Train Epoch4 Acc 0.900575 (36023/40000), AUC 0.9538172483444214
ep4_train_time 155.39327419899996
Test Epoch4 layer4 Acc 0.8832, AUC 0.9441999197006226, avg_entr 0.04556586965918541, f1 0.8831999897956848
ep4_l4_test_time 5.51305882500003
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.927375 (37095/40000), AUC 0.9735041856765747
ep5_train_time 155.239127156
Test Epoch5 layer4 Acc 0.8822, AUC 0.9451188445091248, avg_entr 0.04641133174300194, f1 0.8822000026702881
ep5_l4_test_time 5.618423951999944
gc 0
Train Epoch6 Acc 0.940725 (37629/40000), AUC 0.9806960821151733
ep6_train_time 137.0200287680001
Test Epoch6 layer4 Acc 0.8828, AUC 0.943901002407074, avg_entr 0.03610272705554962, f1 0.8827999830245972
ep6_l4_test_time 5.477230188000021
gc 0
Train Epoch7 Acc 0.9474 (37896/40000), AUC 0.9844387173652649
ep7_train_time 155.409610231
Test Epoch7 layer4 Acc 0.8828, AUC 0.9427930116653442, avg_entr 0.03589192032814026, f1 0.8827999830245972
ep7_l4_test_time 5.454752878000136
gc 0
Train Epoch8 Acc 0.9531 (38124/40000), AUC 0.9875202775001526
ep8_train_time 155.4845208229999
Test Epoch8 layer4 Acc 0.8794, AUC 0.9434016346931458, avg_entr 0.0316012017428875, f1 0.8794000148773193
ep8_l4_test_time 5.570103473000017
gc 0
Train Epoch9 Acc 0.95875 (38350/40000), AUC 0.9896883964538574
ep9_train_time 155.44470861000013
Test Epoch9 layer4 Acc 0.8756, AUC 0.9428349733352661, avg_entr 0.0323481485247612, f1 0.8756000399589539
ep9_l4_test_time 5.469948024999894
gc 0
Train Epoch10 Acc 0.96155 (38462/40000), AUC 0.9907727837562561
ep10_train_time 155.44703707200006
Test Epoch10 layer4 Acc 0.8812, AUC 0.9393879175186157, avg_entr 0.027058254927396774, f1 0.8812000155448914
ep10_l4_test_time 5.583088731000089
gc 0
Train Epoch11 Acc 0.9658 (38632/40000), AUC 0.9930960536003113
ep11_train_time 155.04624232900005
Test Epoch11 layer4 Acc 0.8786, AUC 0.939028263092041, avg_entr 0.022844498977065086, f1 0.878600001335144
ep11_l4_test_time 5.546856902999934
gc 0
Train Epoch12 Acc 0.96955 (38782/40000), AUC 0.994032084941864
ep12_train_time 155.01812734099985
Test Epoch12 layer4 Acc 0.8762, AUC 0.9353334903717041, avg_entr 0.02232457883656025, f1 0.8762000203132629
ep12_l4_test_time 5.498033777999808
gc 0
Train Epoch13 Acc 0.972325 (38893/40000), AUC 0.9948855638504028
ep13_train_time 155.03707184699988
Test Epoch13 layer4 Acc 0.8698, AUC 0.9362177848815918, avg_entr 0.028615133836865425, f1 0.8697999715805054
ep13_l4_test_time 5.502152138999918
gc 0
Train Epoch14 Acc 0.973875 (38955/40000), AUC 0.9956057071685791
ep14_train_time 154.99145837100014
Test Epoch14 layer4 Acc 0.871, AUC 0.9332630634307861, avg_entr 0.018794476985931396, f1 0.8709999918937683
ep14_l4_test_time 5.54041836200031
gc 0
Train Epoch15 Acc 0.97575 (39030/40000), AUC 0.9958266615867615
ep15_train_time 154.7649924870002
Test Epoch15 layer4 Acc 0.8654, AUC 0.9317858815193176, avg_entr 0.020958764478564262, f1 0.865399956703186
ep15_l4_test_time 5.544049969999833
gc 0
Train Epoch16 Acc 0.977975 (39119/40000), AUC 0.9962016344070435
ep16_train_time 155.108822143
Test Epoch16 layer4 Acc 0.8662, AUC 0.9318214058876038, avg_entr 0.020753024145960808, f1 0.8661999702453613
ep16_l4_test_time 5.5146669020000445
gc 0
Train Epoch17 Acc 0.97955 (39182/40000), AUC 0.9967093467712402
ep17_train_time 137.56504474899975
Test Epoch17 layer4 Acc 0.8664, AUC 0.928186297416687, avg_entr 0.016675949096679688, f1 0.8664000034332275
ep17_l4_test_time 5.595253875999788
gc 0
Train Epoch18 Acc 0.98075 (39230/40000), AUC 0.997100293636322
ep18_train_time 155.04990389099976
Test Epoch18 layer4 Acc 0.863, AUC 0.9269018769264221, avg_entr 0.014462160877883434, f1 0.8629999756813049
ep18_l4_test_time 5.5144747660001485
gc 0
Train Epoch19 Acc 0.98125 (39250/40000), AUC 0.9971965551376343
ep19_train_time 154.98950000000013
Test Epoch19 layer4 Acc 0.8558, AUC 0.9263771772384644, avg_entr 0.017934076488018036, f1 0.8558000326156616
ep19_l4_test_time 5.515332928000134
gc 0
Train Epoch20 Acc 0.982525 (39301/40000), AUC 0.9976476430892944
ep20_train_time 155.1216515440001
Test Epoch20 layer4 Acc 0.8588, AUC 0.925609827041626, avg_entr 0.01779400184750557, f1 0.8587999939918518
ep20_l4_test_time 5.56992940300006
gc 0
Train Epoch21 Acc 0.984375 (39375/40000), AUC 0.9980018138885498
ep21_train_time 155.289057038
Test Epoch21 layer4 Acc 0.8572, AUC 0.923122763633728, avg_entr 0.014943981543183327, f1 0.857200026512146
ep21_l4_test_time 5.586191009000231
gc 0
Train Epoch22 Acc 0.9853 (39412/40000), AUC 0.9982219934463501
ep22_train_time 155.37401870700023
Test Epoch22 layer4 Acc 0.8498, AUC 0.9232901334762573, avg_entr 0.01870708540081978, f1 0.8497999906539917
ep22_l4_test_time 5.472114837999925
gc 0
Train Epoch23 Acc 0.985925 (39437/40000), AUC 0.9983179569244385
ep23_train_time 155.54745035099995
Test Epoch23 layer4 Acc 0.8398, AUC 0.9154738187789917, avg_entr 0.017212525010108948, f1 0.8398000001907349
ep23_l4_test_time 5.4876895780003
gc 0
Train Epoch24 Acc 0.987225 (39489/40000), AUC 0.9984760284423828
ep24_train_time 155.25415074900002
Test Epoch24 layer4 Acc 0.853, AUC 0.9138201475143433, avg_entr 0.013363131321966648, f1 0.8529999852180481
ep24_l4_test_time 5.556639374000042
gc 0
Train Epoch25 Acc 0.98735 (39494/40000), AUC 0.9986263513565063
ep25_train_time 155.26541888199972
Test Epoch25 layer4 Acc 0.8486, AUC 0.9102275371551514, avg_entr 0.012823129072785378, f1 0.8485999703407288
ep25_l4_test_time 5.475105315999826
gc 0
Train Epoch26 Acc 0.988675 (39547/40000), AUC 0.9986798763275146
ep26_train_time 155.1350960489999
Test Epoch26 layer4 Acc 0.8504, AUC 0.9088112115859985, avg_entr 0.013631277717649937, f1 0.8503999710083008
ep26_l4_test_time 5.506632983999225
gc 0
Train Epoch27 Acc 0.989225 (39569/40000), AUC 0.9989813566207886
ep27_train_time 154.95125370799997
Test Epoch27 layer4 Acc 0.848, AUC 0.9135332107543945, avg_entr 0.012504630722105503, f1 0.8479999899864197
ep27_l4_test_time 5.555899244000102
gc 0
Train Epoch28 Acc 0.989375 (39575/40000), AUC 0.9988776445388794
ep28_train_time 137.4829921520004
Test Epoch28 layer4 Acc 0.8436, AUC 0.9052155613899231, avg_entr 0.011111163534224033, f1 0.8435999751091003
ep28_l4_test_time 5.3790843319993655
gc 0
Train Epoch29 Acc 0.9898 (39592/40000), AUC 0.9987716674804688
ep29_train_time 155.17325731800065
Test Epoch29 layer4 Acc 0.8366, AUC 0.9067027568817139, avg_entr 0.009768440388143063, f1 0.8366000056266785
ep29_l4_test_time 5.523930393999763
Best AUC tensor(0.8832) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 4770.082491857001
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
gc 10
Test layer0 Acc 0.888, AUC 0.9554181098937988, avg_entr 0.18067964911460876, f1 0.8880000114440918
l0_test_time 0.7607853720001003
gc 0
Test layer1 Acc 0.8648, AUC 0.9316295385360718, avg_entr 0.08662115782499313, f1 0.8648000359535217
l1_test_time 1.7686639319999813
gc 0
Test layer2 Acc 0.8726, AUC 0.9383057355880737, avg_entr 0.056849513202905655, f1 0.8726000189781189
l2_test_time 3.058564103000208
gc 0
Test layer3 Acc 0.8718, AUC 0.9387133121490479, avg_entr 0.05137365683913231, f1 0.8718000650405884
l3_test_time 4.306910051999694
gc 0
Test layer4 Acc 0.8728, AUC 0.9384216070175171, avg_entr 0.04924792796373367, f1 0.8727999925613403
l4_test_time 5.593384159999914
gc 0
Test threshold 0.1 Acc 0.8754, AUC 0.9333380460739136, avg_entr 0.07391893863677979, f1 0.8754000067710876
t0.1_test_time 4.763577003999671
gc 0
Test threshold 0.2 Acc 0.8782, AUC 0.9300714731216431, avg_entr 0.0850965678691864, f1 0.8781999945640564
t0.2_test_time 4.658793272000366
gc 0
Test threshold 0.3 Acc 0.8802, AUC 0.9288493394851685, avg_entr 0.09836239367723465, f1 0.8802000284194946
t0.3_test_time 4.591326280999965
gc 0
Test threshold 0.4 Acc 0.8808, AUC 0.9290527105331421, avg_entr 0.11174529790878296, f1 0.8808000087738037
t0.4_test_time 4.506115387000136
gc 0
Test threshold 0.5 Acc 0.8816, AUC 0.9307547807693481, avg_entr 0.12504370510578156, f1 0.881600022315979
t0.5_test_time 4.618520127999545
gc 0
Test threshold 0.6 Acc 0.8822, AUC 0.9334865808486938, avg_entr 0.14148671925067902, f1 0.8822000026702881
t0.6_test_time 4.381653691999418
gc 0
Test threshold 0.7 Acc 0.8848, AUC 0.9368661642074585, avg_entr 0.1592593789100647, f1 0.8848000168800354
t0.7_test_time 4.1518558640000265
gc 0
Test threshold 0.8 Acc 0.8852, AUC 0.9393429756164551, avg_entr 0.18157044053077698, f1 0.8852000832557678
t0.8_test_time 3.7939499009999054
gc 0
Test threshold 0.9 Acc 0.8876, AUC 0.9446178078651428, avg_entr 0.2082320749759674, f1 0.8876000046730042
t0.9_test_time 2.991992289999871
