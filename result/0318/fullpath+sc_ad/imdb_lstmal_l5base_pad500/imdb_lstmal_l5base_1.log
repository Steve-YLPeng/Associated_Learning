total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 24.145295318000002
Start Training
gc 0
Train Epoch0 Acc 0.520825 (20833/40000), AUC 0.5248491764068604
ep0_train_time 136.62527035000002
Test Epoch0 layer4 Acc 0.6488, AUC 0.717221200466156, avg_entr 0.6792789697647095, f1 0.6488000154495239
ep0_l4_test_time 5.459534925000014
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.763375 (30535/40000), AUC 0.8362891674041748
ep1_train_time 153.961653388
Test Epoch1 layer4 Acc 0.8642, AUC 0.9292818307876587, avg_entr 0.09184310585260391, f1 0.8641999959945679
ep1_l4_test_time 5.364028784000027
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.889225 (35569/40000), AUC 0.9435853958129883
ep2_train_time 153.82290448100002
Test Epoch2 layer4 Acc 0.8774, AUC 0.9342937469482422, avg_entr 0.061591777950525284, f1 0.8773999810218811
ep2_l4_test_time 5.355416429999991
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9152 (36608/40000), AUC 0.9619870185852051
ep3_train_time 153.918971979
Test Epoch3 layer4 Acc 0.89, AUC 0.9460847973823547, avg_entr 0.05357056111097336, f1 0.8899999856948853
ep3_l4_test_time 5.368708236999964
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9327 (37308/40000), AUC 0.9751688838005066
ep4_train_time 153.89958022200005
Test Epoch4 layer4 Acc 0.8864, AUC 0.946997880935669, avg_entr 0.03989546000957489, f1 0.8863999843597412
ep4_l4_test_time 5.421095522999963
gc 0
Train Epoch5 Acc 0.939075 (37563/40000), AUC 0.9795544743537903
ep5_train_time 153.86878061699997
Test Epoch5 layer4 Acc 0.8856, AUC 0.9475246667861938, avg_entr 0.03335880488157272, f1 0.8855999708175659
ep5_l4_test_time 5.501104299999952
gc 0
Train Epoch6 Acc 0.9499 (37996/40000), AUC 0.9845931529998779
ep6_train_time 153.96688939299997
Test Epoch6 layer4 Acc 0.883, AUC 0.9437094926834106, avg_entr 0.029401125386357307, f1 0.8830000162124634
ep6_l4_test_time 5.4138520389999485
gc 0
Train Epoch7 Acc 0.955975 (38239/40000), AUC 0.9879348278045654
ep7_train_time 153.96718833700015
Test Epoch7 layer4 Acc 0.8836, AUC 0.940974235534668, avg_entr 0.02184903621673584, f1 0.8835999965667725
ep7_l4_test_time 5.388378427999896
gc 0
Train Epoch8 Acc 0.959 (38360/40000), AUC 0.9895806312561035
ep8_train_time 153.896102188
Test Epoch8 layer4 Acc 0.881, AUC 0.9436915516853333, avg_entr 0.02398538962006569, f1 0.8809999823570251
ep8_l4_test_time 5.395194971000137
gc 0
Train Epoch9 Acc 0.9631 (38524/40000), AUC 0.9912776947021484
ep9_train_time 154.03253167000003
Test Epoch9 layer4 Acc 0.877, AUC 0.941949725151062, avg_entr 0.024954233318567276, f1 0.8769999742507935
ep9_l4_test_time 5.346911052999985
gc 0
Train Epoch10 Acc 0.9653 (38612/40000), AUC 0.993087649345398
ep10_train_time 131.29952140199998
Test Epoch10 layer4 Acc 0.8716, AUC 0.9352012276649475, avg_entr 0.01909344457089901, f1 0.8715999722480774
ep10_l4_test_time 5.6177985659999194
gc 0
Train Epoch11 Acc 0.9692 (38768/40000), AUC 0.9940948486328125
ep11_train_time 156.78575240300006
Test Epoch11 layer4 Acc 0.8748, AUC 0.9379876255989075, avg_entr 0.025302331894636154, f1 0.8748000264167786
ep11_l4_test_time 5.578647708000062
gc 0
Train Epoch12 Acc 0.970925 (38837/40000), AUC 0.9939843416213989
ep12_train_time 156.58792156399977
Test Epoch12 layer4 Acc 0.8718, AUC 0.93489009141922, avg_entr 0.020974494516849518, f1 0.8718000650405884
ep12_l4_test_time 5.5411675190002825
gc 0
Train Epoch13 Acc 0.9725 (38900/40000), AUC 0.9946421384811401
ep13_train_time 156.68607972500013
Test Epoch13 layer4 Acc 0.8708, AUC 0.9318105578422546, avg_entr 0.017498329281806946, f1 0.8708000183105469
ep13_l4_test_time 5.555178933999741
gc 0
Train Epoch14 Acc 0.9731 (38924/40000), AUC 0.995759129524231
ep14_train_time 156.56306637999978
Test Epoch14 layer4 Acc 0.8672, AUC 0.9296175241470337, avg_entr 0.015836497768759727, f1 0.8672000169754028
ep14_l4_test_time 5.512934767999923
gc 0
Train Epoch15 Acc 0.975975 (39039/40000), AUC 0.9964113235473633
ep15_train_time 156.53369317099987
Test Epoch15 layer4 Acc 0.864, AUC 0.9308035969734192, avg_entr 0.018001781776547432, f1 0.8640000224113464
ep15_l4_test_time 5.5844643129998985
gc 0
Train Epoch16 Acc 0.978725 (39149/40000), AUC 0.9968820810317993
ep16_train_time 156.5479371829997
Test Epoch16 layer4 Acc 0.861, AUC 0.9276907444000244, avg_entr 0.019312845543026924, f1 0.8610000014305115
ep16_l4_test_time 5.540493695999885
gc 0
Train Epoch17 Acc 0.979575 (39183/40000), AUC 0.9971182346343994
ep17_train_time 156.52163630799987
Test Epoch17 layer4 Acc 0.863, AUC 0.9269242286682129, avg_entr 0.01656169816851616, f1 0.8629999756813049
ep17_l4_test_time 5.503317468000205
gc 0
Train Epoch18 Acc 0.980475 (39219/40000), AUC 0.9974566698074341
ep18_train_time 156.5482089330003
Test Epoch18 layer4 Acc 0.8588, AUC 0.9263054728507996, avg_entr 0.017054973170161247, f1 0.8587999939918518
ep18_l4_test_time 5.513748302000295
gc 0
Train Epoch19 Acc 0.98105 (39242/40000), AUC 0.9974970817565918
ep19_train_time 156.45392874300023
Test Epoch19 layer4 Acc 0.8564, AUC 0.9237502813339233, avg_entr 0.013151374645531178, f1 0.8564000129699707
ep19_l4_test_time 5.600126730000284
gc 0
Train Epoch20 Acc 0.982125 (39285/40000), AUC 0.9979099035263062
ep20_train_time 156.54230821300007
Test Epoch20 layer4 Acc 0.857, AUC 0.9235237240791321, avg_entr 0.017232351005077362, f1 0.8569999933242798
ep20_l4_test_time 5.501396831999955
gc 0
Train Epoch21 Acc 0.98405 (39362/40000), AUC 0.9981730580329895
ep21_train_time 138.3921375509999
Test Epoch21 layer4 Acc 0.857, AUC 0.9223449230194092, avg_entr 0.015270909294486046, f1 0.8569999933242798
ep21_l4_test_time 5.537902617999862
gc 0
Train Epoch22 Acc 0.98485 (39394/40000), AUC 0.9983612298965454
ep22_train_time 156.53307331899987
Test Epoch22 layer4 Acc 0.8516, AUC 0.9179515838623047, avg_entr 0.01460207998752594, f1 0.8515999913215637
ep22_l4_test_time 5.596029344999806
gc 0
Train Epoch23 Acc 0.985525 (39421/40000), AUC 0.9984689950942993
ep23_train_time 156.69396836099986
Test Epoch23 layer4 Acc 0.8448, AUC 0.917935848236084, avg_entr 0.013513668440282345, f1 0.8447999358177185
ep23_l4_test_time 5.501776718999736
gc 0
Train Epoch24 Acc 0.9865 (39460/40000), AUC 0.9984921216964722
ep24_train_time 156.64907018699978
Test Epoch24 layer4 Acc 0.8494, AUC 0.9149570465087891, avg_entr 0.013729176484048367, f1 0.849399983882904
ep24_l4_test_time 5.575991402999989
gc 0
Train Epoch25 Acc 0.98675 (39470/40000), AUC 0.998686671257019
ep25_train_time 156.6270098990003
Test Epoch25 layer4 Acc 0.8498, AUC 0.9159362316131592, avg_entr 0.010295053012669086, f1 0.8497999906539917
ep25_l4_test_time 5.554509499000233
gc 0
Train Epoch26 Acc 0.988125 (39525/40000), AUC 0.9987856149673462
ep26_train_time 156.79415683699972
Test Epoch26 layer4 Acc 0.8496, AUC 0.9141343235969543, avg_entr 0.01040058396756649, f1 0.8496000170707703
ep26_l4_test_time 5.54801389199929
gc 0
Train Epoch27 Acc 0.9873 (39492/40000), AUC 0.9986680746078491
ep27_train_time 156.56826087600075
Test Epoch27 layer4 Acc 0.8372, AUC 0.9087527990341187, avg_entr 0.015062374994158745, f1 0.8371999859809875
ep27_l4_test_time 5.5819567219996316
gc 0
Train Epoch28 Acc 0.987575 (39503/40000), AUC 0.998730480670929
ep28_train_time 156.72404936400017
Test Epoch28 layer4 Acc 0.8316, AUC 0.905676543712616, avg_entr 0.012459463439881802, f1 0.83160001039505
ep28_l4_test_time 5.552255108999816
gc 0
Train Epoch29 Acc 0.988775 (39551/40000), AUC 0.9989805221557617
ep29_train_time 156.73829168700013
Test Epoch29 layer4 Acc 0.8432, AUC 0.9098178744316101, avg_entr 0.012881023809313774, f1 0.8432000875473022
ep29_l4_test_time 5.568155383000885
Best AUC tensor(0.8900) 3
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 4777.42068442
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
gc 10
Test layer0 Acc 0.8934, AUC 0.9561818838119507, avg_entr 0.19387832283973694, f1 0.8934000134468079
l0_test_time 0.7586988330003805
gc 0
Test layer1 Acc 0.8816, AUC 0.9424231648445129, avg_entr 0.07999897748231888, f1 0.881600022315979
l1_test_time 1.7755887960001928
gc 0
Test layer2 Acc 0.8844, AUC 0.942734956741333, avg_entr 0.06605883687734604, f1 0.8844000101089478
l2_test_time 3.0605165610004406
gc 0
Test layer3 Acc 0.8818, AUC 0.9423772096633911, avg_entr 0.07051033526659012, f1 0.8818000555038452
l3_test_time 4.251978092000172
gc 0
Test layer4 Acc 0.8846, AUC 0.9430221319198608, avg_entr 0.05698777362704277, f1 0.8845999836921692
l4_test_time 5.531481925000662
gc 0
Test threshold 0.1 Acc 0.8856, AUC 0.9359562993049622, avg_entr 0.09238053113222122, f1 0.8855999708175659
t0.1_test_time 5.025764826999875
gc 0
Test threshold 0.2 Acc 0.8874, AUC 0.9327527284622192, avg_entr 0.10688118636608124, f1 0.8873999714851379
t0.2_test_time 4.983095367000715
gc 0
Test threshold 0.3 Acc 0.8878, AUC 0.9323049783706665, avg_entr 0.12133289873600006, f1 0.8877999782562256
t0.3_test_time 4.83996377099993
gc 0
Test threshold 0.4 Acc 0.888, AUC 0.9323039054870605, avg_entr 0.13883653283119202, f1 0.8880000114440918
t0.4_test_time 4.512184987999717
gc 0
Test threshold 0.5 Acc 0.8878, AUC 0.9307168126106262, avg_entr 0.1551724523305893, f1 0.8877999782562256
t0.5_test_time 4.596138321999206
gc 0
Test threshold 0.6 Acc 0.8892, AUC 0.9315133094787598, avg_entr 0.17207448184490204, f1 0.88919997215271
t0.6_test_time 4.669804569000007
gc 0
Test threshold 0.7 Acc 0.8908, AUC 0.9354370832443237, avg_entr 0.19130849838256836, f1 0.8907999992370605
t0.7_test_time 4.534065578000082
gc 0
Test threshold 0.8 Acc 0.8928, AUC 0.9379251003265381, avg_entr 0.21184881031513214, f1 0.892799973487854
t0.8_test_time 4.3038770359999035
gc 0
Test threshold 0.9 Acc 0.893, AUC 0.9435195922851562, avg_entr 0.23640920221805573, f1 0.8930000066757202
t0.9_test_time 3.744847517999915
