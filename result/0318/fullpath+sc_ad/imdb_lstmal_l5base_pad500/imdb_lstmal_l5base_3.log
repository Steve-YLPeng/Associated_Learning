total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.798344245000003
Start Training
gc 0
Train Epoch0 Acc 0.506525 (20261/40000), AUC 0.5173192024230957
ep0_train_time 80.495789406
Test Epoch0 layer4 Acc 0.6654, AUC 0.764373779296875, avg_entr 0.6493635773658752, f1 0.6654000282287598
ep0_l4_test_time 4.076705911000005
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.7938 (31752/40000), AUC 0.8512381315231323
ep1_train_time 107.834013883
Test Epoch1 layer4 Acc 0.7878, AUC 0.885428786277771, avg_entr 0.12281273305416107, f1 0.7877999544143677
ep1_l4_test_time 4.120631403999994
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.79415 (31766/40000), AUC 0.8765789866447449
ep2_train_time 118.82817265100002
Test Epoch2 layer4 Acc 0.732, AUC 0.8164917826652527, avg_entr 0.6242530345916748, f1 0.7319999933242798
ep2_l4_test_time 4.276272082999981
gc 0
Train Epoch3 Acc 0.87835 (35134/40000), AUC 0.9344082474708557
ep3_train_time 118.85279494399998
Test Epoch3 layer4 Acc 0.875, AUC 0.9334689974784851, avg_entr 0.04349634051322937, f1 0.875
ep3_l4_test_time 4.247552254000027
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.912525 (36501/40000), AUC 0.9612627029418945
ep4_train_time 118.57808489900003
Test Epoch4 layer4 Acc 0.8836, AUC 0.9414913058280945, avg_entr 0.04281266778707504, f1 0.8835999965667725
ep4_l4_test_time 4.219265754999924
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.92615 (37046/40000), AUC 0.9686998128890991
ep5_train_time 118.83512300099994
Test Epoch5 layer4 Acc 0.8886, AUC 0.9458878636360168, avg_entr 0.04028521105647087, f1 0.8885999917984009
ep5_l4_test_time 4.14455008799996
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.94235 (37694/40000), AUC 0.9798583388328552
ep6_train_time 111.413851798
Test Epoch6 layer4 Acc 0.8768, AUC 0.9408210515975952, avg_entr 0.034189723432064056, f1 0.876800000667572
ep6_l4_test_time 2.8829795639999247
gc 0
Train Epoch7 Acc 0.92895 (37158/40000), AUC 0.9711298942565918
ep7_train_time 97.53463102299997
Test Epoch7 layer4 Acc 0.8812, AUC 0.9412534832954407, avg_entr 0.04019442945718765, f1 0.8812000155448914
ep7_l4_test_time 2.894417647999944
gc 0
Train Epoch8 Acc 0.940825 (37633/40000), AUC 0.981324315071106
ep8_train_time 106.16661350800007
Test Epoch8 layer4 Acc 0.8676, AUC 0.9278247356414795, avg_entr 0.03156914561986923, f1 0.8675999641418457
ep8_l4_test_time 4.174845753999989
gc 0
Train Epoch9 Acc 0.9509 (38036/40000), AUC 0.9868919253349304
ep9_train_time 103.6062164760001
Test Epoch9 layer4 Acc 0.8816, AUC 0.942068338394165, avg_entr 0.03033781796693802, f1 0.881600022315979
ep9_l4_test_time 4.229474636000077
gc 0
Train Epoch10 Acc 0.962075 (38483/40000), AUC 0.9917794466018677
ep10_train_time 95.33249084300019
Test Epoch10 layer4 Acc 0.8772, AUC 0.940393328666687, avg_entr 0.029462454840540886, f1 0.8772000074386597
ep10_l4_test_time 4.312111701000049
gc 0
Train Epoch11 Acc 0.965125 (38605/40000), AUC 0.9925357103347778
ep11_train_time 106.84932350599979
Test Epoch11 layer4 Acc 0.8724, AUC 0.9403111934661865, avg_entr 0.028432577848434448, f1 0.8723999857902527
ep11_l4_test_time 4.194498132000035
gc 0
Train Epoch12 Acc 0.962975 (38519/40000), AUC 0.9918760061264038
ep12_train_time 108.3389490630002
Test Epoch12 layer4 Acc 0.8668, AUC 0.9378757476806641, avg_entr 0.03553678095340729, f1 0.8668000102043152
ep12_l4_test_time 4.852014824999969
gc 0
Train Epoch13 Acc 0.96885 (38754/40000), AUC 0.9940346479415894
ep13_train_time 119.05143742199994
Test Epoch13 layer4 Acc 0.8694, AUC 0.9351078271865845, avg_entr 0.020865097641944885, f1 0.8694000244140625
ep13_l4_test_time 4.753568200000018
gc 0
Train Epoch14 Acc 0.97295 (38918/40000), AUC 0.9946981072425842
ep14_train_time 106.70885690600016
Test Epoch14 layer4 Acc 0.8642, AUC 0.9320006370544434, avg_entr 0.02278899773955345, f1 0.8641999959945679
ep14_l4_test_time 2.8953960659998756
gc 0
Train Epoch15 Acc 0.9739 (38956/40000), AUC 0.9954397082328796
ep15_train_time 121.38270521300001
Test Epoch15 layer4 Acc 0.859, AUC 0.9316835403442383, avg_entr 0.026699524372816086, f1 0.859000027179718
ep15_l4_test_time 5.394941219999964
gc 0
Train Epoch16 Acc 0.97345 (38938/40000), AUC 0.9954190254211426
ep16_train_time 129.234477191
Test Epoch16 layer4 Acc 0.8634, AUC 0.9304101467132568, avg_entr 0.021622441709041595, f1 0.8634000420570374
ep16_l4_test_time 2.8821483340000214
gc 0
Train Epoch17 Acc 0.978175 (39127/40000), AUC 0.9968863129615784
ep17_train_time 113.02367872899981
Test Epoch17 layer4 Acc 0.8568, AUC 0.9296138286590576, avg_entr 0.020660467445850372, f1 0.8568000793457031
ep17_l4_test_time 2.888430150000204
gc 0
Train Epoch18 Acc 0.979775 (39191/40000), AUC 0.9972255229949951
ep18_train_time 79.04949484899998
Test Epoch18 layer4 Acc 0.8556, AUC 0.9248673319816589, avg_entr 0.015275663696229458, f1 0.8555999994277954
ep18_l4_test_time 2.8810314389997984
gc 0
Train Epoch19 Acc 0.9808 (39232/40000), AUC 0.9971911907196045
ep19_train_time 108.66428274999998
Test Epoch19 layer4 Acc 0.8546, AUC 0.9199804067611694, avg_entr 0.016454625874757767, f1 0.8546000123023987
ep19_l4_test_time 2.8902028090001295
gc 0
Train Epoch20 Acc 0.98105 (39242/40000), AUC 0.99726402759552
ep20_train_time 116.76340462200005
Test Epoch20 layer4 Acc 0.8554, AUC 0.9208707809448242, avg_entr 0.01630215533077717, f1 0.855400025844574
ep20_l4_test_time 5.6396654740001395
gc 0
Train Epoch21 Acc 0.968375 (38735/40000), AUC 0.9886425733566284
ep21_train_time 113.69574607599998
Test Epoch21 layer4 Acc 0.8498, AUC 0.9171447157859802, avg_entr 0.019960599020123482, f1 0.8497999906539917
ep21_l4_test_time 2.917993519999982
gc 0
Train Epoch22 Acc 0.983225 (39329/40000), AUC 0.99725341796875
ep22_train_time 128.4891545270002
Test Epoch22 layer4 Acc 0.8506, AUC 0.9095838665962219, avg_entr 0.016964269801974297, f1 0.8505999445915222
ep22_l4_test_time 5.46668875899968
gc 0
Train Epoch23 Acc 0.9835 (39340/40000), AUC 0.9978613257408142
ep23_train_time 122.33262540300029
Test Epoch23 layer4 Acc 0.849, AUC 0.9108767509460449, avg_entr 0.012586534023284912, f1 0.8489999771118164
ep23_l4_test_time 2.9296337109999513
gc 0
Train Epoch24 Acc 0.9853 (39412/40000), AUC 0.9978417754173279
ep24_train_time 126.11896530800004
Test Epoch24 layer4 Acc 0.8434, AUC 0.914685845375061, avg_entr 0.014585504308342934, f1 0.8434000015258789
ep24_l4_test_time 5.5022142890002215
gc 0
Train Epoch25 Acc 0.98565 (39426/40000), AUC 0.998194694519043
ep25_train_time 98.28668099400011
Test Epoch25 layer4 Acc 0.8458, AUC 0.9132900238037109, avg_entr 0.014617872424423695, f1 0.84579998254776
ep25_l4_test_time 2.955121020000206
gc 0
Train Epoch26 Acc 0.98665 (39466/40000), AUC 0.9981834888458252
ep26_train_time 79.25568733499995
Test Epoch26 layer4 Acc 0.8436, AUC 0.9095644950866699, avg_entr 0.012031438760459423, f1 0.8435999751091003
ep26_l4_test_time 2.8749761500002933
gc 0
Train Epoch27 Acc 0.986925 (39477/40000), AUC 0.998100757598877
ep27_train_time 79.0948740419999
Test Epoch27 layer4 Acc 0.8382, AUC 0.9066742658615112, avg_entr 0.014589661732316017, f1 0.8381999731063843
ep27_l4_test_time 2.8856253690000813
gc 0
Train Epoch28 Acc 0.988075 (39523/40000), AUC 0.9982712864875793
ep28_train_time 108.85740729000008
Test Epoch28 layer4 Acc 0.84, AUC 0.8955354690551758, avg_entr 0.01581784337759018, f1 0.8399999737739563
ep28_l4_test_time 2.917045387000144
gc 0
Train Epoch29 Acc 0.987925 (39517/40000), AUC 0.9982595443725586
ep29_train_time 124.01205234200006
Test Epoch29 layer4 Acc 0.8332, AUC 0.8844982385635376, avg_entr 0.014074296690523624, f1 0.8331999778747559
ep29_l4_test_time 5.441299933000209
Best AUC tensor(0.8886) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 3385.097066872
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
gc 10
Test layer0 Acc 0.8942, AUC 0.9547945261001587, avg_entr 0.16379085183143616, f1 0.8942000269889832
l0_test_time 0.7845631680002043
gc 0
Test layer1 Acc 0.8732, AUC 0.9335172176361084, avg_entr 0.06311962753534317, f1 0.873199999332428
l1_test_time 1.7454208969998035
gc 0
Test layer2 Acc 0.8798, AUC 0.9408531188964844, avg_entr 0.046310074627399445, f1 0.879800021648407
l2_test_time 3.013189619000059
gc 0
Test layer3 Acc 0.8802, AUC 0.9408255815505981, avg_entr 0.03975849226117134, f1 0.8802000284194946
l3_test_time 4.235132826000154
gc 0
Test layer4 Acc 0.8804, AUC 0.9407986402511597, avg_entr 0.043345097452402115, f1 0.8804000020027161
l4_test_time 5.455327106000368
gc 0
Test threshold 0.1 Acc 0.8822, AUC 0.9311116933822632, avg_entr 0.06639896333217621, f1 0.8822000026702881
t0.1_test_time 4.515240195999922
gc 0
Test threshold 0.2 Acc 0.8836, AUC 0.9250764846801758, avg_entr 0.07785127311944962, f1 0.8835999965667725
t0.2_test_time 1.8495065000001887
gc 0
Test threshold 0.3 Acc 0.8838, AUC 0.9260587096214294, avg_entr 0.09119487553834915, f1 0.8838000297546387
t0.3_test_time 1.7347923480001555
gc 0
Test threshold 0.4 Acc 0.8842, AUC 0.9258490800857544, avg_entr 0.10535367578268051, f1 0.8842000365257263
t0.4_test_time 1.6245798979998654
gc 0
Test threshold 0.5 Acc 0.8852, AUC 0.9294039011001587, avg_entr 0.1200336441397667, f1 0.8852000832557678
t0.5_test_time 1.6136309879998407
gc 0
Test threshold 0.6 Acc 0.8862, AUC 0.9336068630218506, avg_entr 0.13624508678913116, f1 0.8862000107765198
t0.6_test_time 1.58055838700011
gc 0
Test threshold 0.7 Acc 0.8878, AUC 0.9372172355651855, avg_entr 0.1530470848083496, f1 0.8877999782562256
t0.7_test_time 1.4767106760000388
gc 0
Test threshold 0.8 Acc 0.8892, AUC 0.9390038847923279, avg_entr 0.17083197832107544, f1 0.88919997215271
t0.8_test_time 1.4024375070002861
gc 0
Test threshold 0.9 Acc 0.8912, AUC 0.9438788890838623, avg_entr 0.19270679354667664, f1 0.8912000060081482
t0.9_test_time 1.1962715889999345
