total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 16.876727643000002
Start Training
gc 0
Train Epoch0 Acc 0.63785 (76542/120000), AUC 0.8551480770111084
ep0_train_time 32.165068426000005
Test Epoch0 layer4 Acc 0.901578947368421, AUC 0.9776105880737305, avg_entr 0.2260248064994812, f1 0.901578962802887
ep0_l4_test_time 0.3923902760000004
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.917325 (110079/120000), AUC 0.9815311431884766
ep1_train_time 30.933577051000007
Test Epoch1 layer4 Acc 0.9184210526315789, AUC 0.9805421233177185, avg_entr 0.11985301971435547, f1 0.9184210896492004
ep1_l4_test_time 0.29333674800000153
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.927375 (111285/120000), AUC 0.9857096672058105
ep2_train_time 25.497831104
Test Epoch2 layer4 Acc 0.9189473684210526, AUC 0.9825160503387451, avg_entr 0.07837307453155518, f1 0.9189472794532776
ep2_l4_test_time 0.3188480219999974
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9336083333333334 (112033/120000), AUC 0.9880748391151428
ep3_train_time 29.29487612700001
Test Epoch3 layer4 Acc 0.9226315789473685, AUC 0.9822978973388672, avg_entr 0.04949895665049553, f1 0.922631561756134
ep3_l4_test_time 0.40445337100001666
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9380333333333334 (112564/120000), AUC 0.9894843697547913
ep4_train_time 30.680369641
Test Epoch4 layer4 Acc 0.921578947368421, AUC 0.982874870300293, avg_entr 0.036950208246707916, f1 0.9215789437294006
ep4_l4_test_time 0.37460399000002553
gc 0
Train Epoch5 Acc 0.9411083333333333 (112933/120000), AUC 0.9902129173278809
ep5_train_time 30.84122395099999
Test Epoch5 layer4 Acc 0.9189473684210526, AUC 0.9809305667877197, avg_entr 0.0302848219871521, f1 0.9189472794532776
ep5_l4_test_time 0.37913520000000744
gc 0
Train Epoch6 Acc 0.9436166666666667 (113234/120000), AUC 0.991123616695404
ep6_train_time 29.725434481000008
Test Epoch6 layer4 Acc 0.9218421052631579, AUC 0.9817859530448914, avg_entr 0.026530645787715912, f1 0.921842098236084
ep6_l4_test_time 0.38021638600000074
gc 0
Train Epoch7 Acc 0.9452166666666667 (113426/120000), AUC 0.9919826984405518
ep7_train_time 30.545176787999992
Test Epoch7 layer4 Acc 0.9228947368421052, AUC 0.9825868606567383, avg_entr 0.02321968600153923, f1 0.9228947162628174
ep7_l4_test_time 0.33039823100000376
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9472083333333333 (113665/120000), AUC 0.9926321506500244
ep8_train_time 25.64626295100004
Test Epoch8 layer4 Acc 0.9213157894736842, AUC 0.9811129570007324, avg_entr 0.020858757197856903, f1 0.9213157892227173
ep8_l4_test_time 0.3126648429999932
gc 0
Train Epoch9 Acc 0.9486166666666667 (113834/120000), AUC 0.9930657148361206
ep9_train_time 29.311159670999984
Test Epoch9 layer4 Acc 0.9226315789473685, AUC 0.9817954301834106, avg_entr 0.019462767988443375, f1 0.922631561756134
ep9_l4_test_time 0.41451840000001994
gc 0
Train Epoch10 Acc 0.9499666666666666 (113996/120000), AUC 0.993324339389801
ep10_train_time 30.804806686999996
Test Epoch10 layer4 Acc 0.9223684210526316, AUC 0.9821854829788208, avg_entr 0.0201007891446352, f1 0.9223684072494507
ep10_l4_test_time 0.37876605600001767
gc 0
Train Epoch11 Acc 0.951275 (114153/120000), AUC 0.993522584438324
ep11_train_time 30.79452494100002
Test Epoch11 layer4 Acc 0.9221052631578948, AUC 0.9798634648323059, avg_entr 0.017156902700662613, f1 0.9221052527427673
ep11_l4_test_time 0.400014294000016
gc 0
Train Epoch12 Acc 0.9521083333333333 (114253/120000), AUC 0.9937945604324341
ep12_train_time 30.678875683
Test Epoch12 layer4 Acc 0.9231578947368421, AUC 0.9810548424720764, avg_entr 0.016971061006188393, f1 0.9231578707695007
ep12_l4_test_time 0.3962683000000311
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.953025 (114363/120000), AUC 0.9940388798713684
ep13_train_time 29.85422508099998
Test Epoch13 layer4 Acc 0.9218421052631579, AUC 0.9812512993812561, avg_entr 0.015643654391169548, f1 0.921842098236084
ep13_l4_test_time 0.3412924099999941
gc 0
Train Epoch14 Acc 0.9535583333333333 (114427/120000), AUC 0.9941923022270203
ep14_train_time 26.342644560999986
Test Epoch14 layer4 Acc 0.921578947368421, AUC 0.9809327125549316, avg_entr 0.014932614751160145, f1 0.9215789437294006
ep14_l4_test_time 0.3167251849999957
gc 0
Train Epoch15 Acc 0.9540666666666666 (114488/120000), AUC 0.9942506551742554
ep15_train_time 29.666830730000015
Test Epoch15 layer4 Acc 0.9207894736842105, AUC 0.9799264669418335, avg_entr 0.015303950756788254, f1 0.9207894802093506
ep15_l4_test_time 0.38730644899999334
gc 0
Train Epoch16 Acc 0.9553583333333333 (114643/120000), AUC 0.9943851232528687
ep16_train_time 30.774101948000066
Test Epoch16 layer4 Acc 0.9197368421052632, AUC 0.9803682565689087, avg_entr 0.01302273478358984, f1 0.9197368621826172
ep16_l4_test_time 0.3744547710000461
gc 0
Train Epoch17 Acc 0.9555416666666666 (114665/120000), AUC 0.9945623278617859
ep17_train_time 30.901270213999965
Test Epoch17 layer4 Acc 0.9173684210526316, AUC 0.9798165559768677, avg_entr 0.014559303410351276, f1 0.9173683524131775
ep17_l4_test_time 0.36553876699997545
gc 0
Train Epoch18 Acc 0.9563083333333333 (114757/120000), AUC 0.9945311546325684
ep18_train_time 29.843575357000077
Test Epoch18 layer4 Acc 0.9178947368421052, AUC 0.9797831177711487, avg_entr 0.012858687900006771, f1 0.917894721031189
ep18_l4_test_time 0.37553680400003486
gc 0
Train Epoch19 Acc 0.956975 (114837/120000), AUC 0.9947681427001953
ep19_train_time 29.31543774399995
Test Epoch19 layer4 Acc 0.9205263157894736, AUC 0.979323148727417, avg_entr 0.013310573995113373, f1 0.9205263257026672
ep19_l4_test_time 0.3315029279999635
gc 0
Train Epoch20 Acc 0.9577166666666667 (114926/120000), AUC 0.9948712587356567
ep20_train_time 26.323696699999914
Test Epoch20 layer4 Acc 0.9210526315789473, AUC 0.9798189997673035, avg_entr 0.012613235972821712, f1 0.9210526347160339
ep20_l4_test_time 0.34832598200000575
gc 0
Train Epoch21 Acc 0.9576833333333333 (114922/120000), AUC 0.9948802590370178
ep21_train_time 30.086206098000048
Test Epoch21 layer4 Acc 0.9181578947368421, AUC 0.9789641499519348, avg_entr 0.012531823478639126, f1 0.9181578755378723
ep21_l4_test_time 0.3755863879999879
gc 0
Train Epoch22 Acc 0.9578666666666666 (114944/120000), AUC 0.9950655102729797
ep22_train_time 30.87431400899993
Test Epoch22 layer4 Acc 0.9178947368421052, AUC 0.979468822479248, avg_entr 0.01329266931861639, f1 0.917894721031189
ep22_l4_test_time 0.37662679499999285
gc 0
Train Epoch23 Acc 0.9588833333333333 (115066/120000), AUC 0.9950796365737915
ep23_train_time 30.780893497999955
Test Epoch23 layer4 Acc 0.9152631578947369, AUC 0.9791650772094727, avg_entr 0.01369986217468977, f1 0.9152631759643555
ep23_l4_test_time 0.3760844470000393
gc 0
Train Epoch24 Acc 0.9590916666666667 (115091/120000), AUC 0.9952384233474731
ep24_train_time 30.815166994999913
Test Epoch24 layer4 Acc 0.9192105263157895, AUC 0.9793656468391418, avg_entr 0.013374511152505875, f1 0.9192105531692505
ep24_l4_test_time 0.39108236000004126
gc 0
Train Epoch25 Acc 0.9593583333333333 (115123/120000), AUC 0.9952864646911621
ep25_train_time 28.404799342000047
Test Epoch25 layer4 Acc 0.9178947368421052, AUC 0.9786756038665771, avg_entr 0.013258210383355618, f1 0.917894721031189
ep25_l4_test_time 0.3097434079999175
gc 0
Train Epoch26 Acc 0.959225 (115107/120000), AUC 0.9953924417495728
ep26_train_time 27.415514013999996
Test Epoch26 layer4 Acc 0.9181578947368421, AUC 0.9787774085998535, avg_entr 0.01171821728348732, f1 0.9181578755378723
ep26_l4_test_time 0.4244114929999796
gc 0
Train Epoch27 Acc 0.9599666666666666 (115196/120000), AUC 0.9954602718353271
ep27_train_time 30.23617896600001
Test Epoch27 layer4 Acc 0.915, AUC 0.9779417514801025, avg_entr 0.01289298851042986, f1 0.9150000214576721
ep27_l4_test_time 0.38859607400002005
gc 0
Train Epoch28 Acc 0.9600833333333333 (115210/120000), AUC 0.9955402612686157
ep28_train_time 30.976693317000013
Test Epoch28 layer4 Acc 0.9181578947368421, AUC 0.9785861372947693, avg_entr 0.011909836903214455, f1 0.9181578755378723
ep28_l4_test_time 0.35867201500002466
gc 0
Train Epoch29 Acc 0.9608583333333334 (115303/120000), AUC 0.9955219030380249
ep29_train_time 29.96529715500003
Test Epoch29 layer4 Acc 0.9157894736842105, AUC 0.9782431125640869, avg_entr 0.011293637566268444, f1 0.9157894849777222
ep29_l4_test_time 0.3890870249999807
Best AUC tensor(0.9232) 12
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 902.868749905
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9128947368421053, AUC 0.980461061000824, avg_entr 0.050231534987688065, f1 0.9128947257995605
l0_test_time 0.3749673629999961
gc 0
Test layer1 Acc 0.9139473684210526, AUC 0.9802027940750122, avg_entr 0.049793049693107605, f1 0.913947343826294
l1_test_time 0.4066989719999583
gc 0
Test layer2 Acc 0.9121052631578948, AUC 0.9810199737548828, avg_entr 0.029533319175243378, f1 0.9121052622795105
l2_test_time 0.3949923769999941
gc 0
Test layer3 Acc 0.9131578947368421, AUC 0.9796649217605591, avg_entr 0.020602267235517502, f1 0.9131578803062439
l3_test_time 0.39485934699996506
gc 0
Test layer4 Acc 0.9131578947368421, AUC 0.9796445369720459, avg_entr 0.018297644332051277, f1 0.9131578803062439
l4_test_time 0.39167430499992406
gc 0
Test threshold 0.1 Acc 0.9142105263157895, AUC 0.9797772169113159, avg_entr 0.01932508684694767, f1 0.9142104983329773
t0.1_test_time 1.3022821120000572
gc 0
Test threshold 0.2 Acc 0.9136842105263158, AUC 0.9800336360931396, avg_entr 0.024684280157089233, f1 0.9136841893196106
t0.2_test_time 1.3315970300000117
gc 0
Test threshold 0.3 Acc 0.9139473684210526, AUC 0.980400800704956, avg_entr 0.03280215710401535, f1 0.913947343826294
t0.3_test_time 1.2831209669999453
gc 0
Test threshold 0.4 Acc 0.9134210526315789, AUC 0.9804316759109497, avg_entr 0.035038016736507416, f1 0.9134210348129272
t0.4_test_time 0.9739179079999758
gc 0
Test threshold 0.5 Acc 0.9128947368421053, AUC 0.9804614782333374, avg_entr 0.03595279902219772, f1 0.9128947257995605
t0.5_test_time 0.7862407000000076
gc 0
Test threshold 0.6 Acc 0.9128947368421053, AUC 0.980461061000824, avg_entr 0.03623439371585846, f1 0.9128947257995605
t0.6_test_time 0.7517043760000206
gc 0
Test threshold 0.7 Acc 0.9128947368421053, AUC 0.980461061000824, avg_entr 0.03623439371585846, f1 0.9128947257995605
t0.7_test_time 0.8445137920000434
gc 0
Test threshold 0.8 Acc 0.9128947368421053, AUC 0.980461061000824, avg_entr 0.03623439371585846, f1 0.9128947257995605
t0.8_test_time 0.8320488230000365
gc 0
Test threshold 0.9 Acc 0.9128947368421053, AUC 0.980461061000824, avg_entr 0.03623439371585846, f1 0.9128947257995605
t0.9_test_time 0.7982305809999843
