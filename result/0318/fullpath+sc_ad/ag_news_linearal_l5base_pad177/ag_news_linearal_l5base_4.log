total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 15.930877632000001
Start Training
gc 0
Train Epoch0 Acc 0.6384416666666667 (76613/120000), AUC 0.8540732860565186
ep0_train_time 12.541633735000001
Test Epoch0 layer4 Acc 0.9057894736842105, AUC 0.9777109622955322, avg_entr 0.22805872559547424, f1 0.9057894945144653
ep0_l4_test_time 0.1869656440000007
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.916825 (110019/120000), AUC 0.9814608097076416
ep1_train_time 16.975338362
Test Epoch1 layer4 Acc 0.9173684210526316, AUC 0.9810981750488281, avg_entr 0.12096132338047028, f1 0.9173683524131775
ep1_l4_test_time 0.2548460809999966
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.92745 (111294/120000), AUC 0.9856587648391724
ep2_train_time 17.814574818000004
Test Epoch2 layer4 Acc 0.921578947368421, AUC 0.9825849533081055, avg_entr 0.08170873671770096, f1 0.9215789437294006
ep2_l4_test_time 0.2191703390000015
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9332166666666667 (111986/120000), AUC 0.9879622459411621
ep3_train_time 15.358684847000006
Test Epoch3 layer4 Acc 0.9218421052631579, AUC 0.9835660457611084, avg_entr 0.05315264314413071, f1 0.921842098236084
ep3_l4_test_time 0.21420943999999054
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.93715 (112458/120000), AUC 0.9891535043716431
ep4_train_time 15.948691992999997
Test Epoch4 layer4 Acc 0.9228947368421052, AUC 0.9831631183624268, avg_entr 0.037589456886053085, f1 0.9228947162628174
ep4_l4_test_time 0.22478564599998663
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.940525 (112863/120000), AUC 0.9899434447288513
ep5_train_time 15.132553567999992
Test Epoch5 layer4 Acc 0.9189473684210526, AUC 0.9820458292961121, avg_entr 0.030859021469950676, f1 0.9189472794532776
ep5_l4_test_time 0.19498777999999106
gc 0
Train Epoch6 Acc 0.9431166666666667 (113174/120000), AUC 0.9909000396728516
ep6_train_time 13.934447749
Test Epoch6 layer4 Acc 0.9231578947368421, AUC 0.9825430512428284, avg_entr 0.02564036287367344, f1 0.9231578707695007
ep6_l4_test_time 0.20054172499999368
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9453333333333334 (113440/120000), AUC 0.9916794300079346
ep7_train_time 14.08082391500001
Test Epoch7 layer4 Acc 0.9223684210526316, AUC 0.9820901155471802, avg_entr 0.023516971617937088, f1 0.9223684072494507
ep7_l4_test_time 0.19641644899999733
gc 0
Train Epoch8 Acc 0.9468166666666666 (113618/120000), AUC 0.9924874901771545
ep8_train_time 13.277779968999994
Test Epoch8 layer4 Acc 0.9244736842105263, AUC 0.9814001321792603, avg_entr 0.02144273929297924, f1 0.9244737029075623
ep8_l4_test_time 0.18939443799999367
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.94825 (113790/120000), AUC 0.9929870963096619
ep9_train_time 12.573593805999991
Test Epoch9 layer4 Acc 0.9242105263157895, AUC 0.9814494848251343, avg_entr 0.019528290256857872, f1 0.9242105484008789
ep9_l4_test_time 0.18676474299999768
gc 0
Train Epoch10 Acc 0.9496166666666667 (113954/120000), AUC 0.9932514429092407
ep10_train_time 18.214967106000017
Test Epoch10 layer4 Acc 0.9221052631578948, AUC 0.9816603660583496, avg_entr 0.018502719700336456, f1 0.9221052527427673
ep10_l4_test_time 0.2371920829999965
gc 0
Train Epoch11 Acc 0.950575 (114069/120000), AUC 0.993710458278656
ep11_train_time 16.700994749000017
Test Epoch11 layer4 Acc 0.921578947368421, AUC 0.9819608926773071, avg_entr 0.017701689153909683, f1 0.9215789437294006
ep11_l4_test_time 0.21601523300000736
gc 0
Train Epoch12 Acc 0.9518666666666666 (114224/120000), AUC 0.9938950538635254
ep12_train_time 15.376327087999982
Test Epoch12 layer4 Acc 0.9239473684210526, AUC 0.9815140962600708, avg_entr 0.01600070111453533, f1 0.9239473938941956
ep12_l4_test_time 0.21613574899998866
gc 0
Train Epoch13 Acc 0.9524166666666667 (114290/120000), AUC 0.9940661191940308
ep13_train_time 15.892582699000002
Test Epoch13 layer4 Acc 0.9205263157894736, AUC 0.9816935658454895, avg_entr 0.017302129417657852, f1 0.9205263257026672
ep13_l4_test_time 0.22688386900000523
gc 0
Train Epoch14 Acc 0.9533416666666666 (114401/120000), AUC 0.9943494200706482
ep14_train_time 14.957558740000024
Test Epoch14 layer4 Acc 0.9221052631578948, AUC 0.9809942841529846, avg_entr 0.01555157732218504, f1 0.9221052527427673
ep14_l4_test_time 0.20665747699999315
gc 0
Train Epoch15 Acc 0.9541666666666667 (114500/120000), AUC 0.9944008588790894
ep15_train_time 13.759983231000007
Test Epoch15 layer4 Acc 0.9186842105263158, AUC 0.9805518388748169, avg_entr 0.014759756624698639, f1 0.918684184551239
ep15_l4_test_time 0.1938275559999738
gc 0
Train Epoch16 Acc 0.9545083333333333 (114541/120000), AUC 0.9945943355560303
ep16_train_time 13.959448234000035
Test Epoch16 layer4 Acc 0.9181578947368421, AUC 0.9816442728042603, avg_entr 0.015456766821444035, f1 0.9181578755378723
ep16_l4_test_time 0.19357676900000342
gc 0
Train Epoch17 Acc 0.955425 (114651/120000), AUC 0.9945487380027771
ep17_train_time 13.172229346999984
Test Epoch17 layer4 Acc 0.9210526315789473, AUC 0.9810455441474915, avg_entr 0.014373933896422386, f1 0.9210526347160339
ep17_l4_test_time 0.18777370399999427
gc 0
Train Epoch18 Acc 0.9562666666666667 (114752/120000), AUC 0.9946759343147278
ep18_train_time 12.7894541
Test Epoch18 layer4 Acc 0.9192105263157895, AUC 0.9809799194335938, avg_entr 0.013592165894806385, f1 0.9192105531692505
ep18_l4_test_time 0.18082889799995883
gc 0
Train Epoch19 Acc 0.9565583333333333 (114787/120000), AUC 0.9948838353157043
ep19_train_time 19.00053703499998
Test Epoch19 layer4 Acc 0.9171052631578948, AUC 0.9805412292480469, avg_entr 0.015065891668200493, f1 0.9171052575111389
ep19_l4_test_time 0.22199767000000747
gc 0
Train Epoch20 Acc 0.9567166666666667 (114806/120000), AUC 0.9949785470962524
ep20_train_time 15.705672844999981
Test Epoch20 layer4 Acc 0.9171052631578948, AUC 0.9804491400718689, avg_entr 0.01169466320425272, f1 0.9171052575111389
ep20_l4_test_time 0.21563504699997793
gc 0
Train Epoch21 Acc 0.9575166666666667 (114902/120000), AUC 0.9950811266899109
ep21_train_time 15.81252693099998
Test Epoch21 layer4 Acc 0.9155263157894736, AUC 0.980850338935852, avg_entr 0.01256653293967247, f1 0.9155263304710388
ep21_l4_test_time 0.2011732180000081
gc 0
Train Epoch22 Acc 0.9578166666666666 (114938/120000), AUC 0.9950258731842041
ep22_train_time 15.705264433000025
Test Epoch22 layer4 Acc 0.9192105263157895, AUC 0.9801733493804932, avg_entr 0.012364485301077366, f1 0.9192105531692505
ep22_l4_test_time 0.22504886600000873
gc 0
Train Epoch23 Acc 0.9578416666666667 (114941/120000), AUC 0.9952414035797119
ep23_train_time 15.024121992999994
Test Epoch23 layer4 Acc 0.915, AUC 0.9800739884376526, avg_entr 0.011692803353071213, f1 0.9150000214576721
ep23_l4_test_time 0.20286424099998612
gc 0
Train Epoch24 Acc 0.9587166666666667 (115046/120000), AUC 0.9953583478927612
ep24_train_time 14.040552871999978
Test Epoch24 layer4 Acc 0.9181578947368421, AUC 0.9800535440444946, avg_entr 0.011520725674927235, f1 0.9181578755378723
ep24_l4_test_time 0.20296745600001032
gc 0
Train Epoch25 Acc 0.9587333333333333 (115048/120000), AUC 0.9953633546829224
ep25_train_time 13.952188565999961
Test Epoch25 layer4 Acc 0.9186842105263158, AUC 0.9794068932533264, avg_entr 0.01148273330181837, f1 0.918684184551239
ep25_l4_test_time 0.19559856900002615
gc 0
Train Epoch26 Acc 0.9592166666666667 (115106/120000), AUC 0.9954816102981567
ep26_train_time 12.905814009999972
Test Epoch26 layer4 Acc 0.916578947368421, AUC 0.9802654981613159, avg_entr 0.012650196440517902, f1 0.9165789484977722
ep26_l4_test_time 0.18852380399999902
gc 0
Train Epoch27 Acc 0.9590416666666667 (115085/120000), AUC 0.9954863786697388
ep27_train_time 12.42714623500001
Test Epoch27 layer4 Acc 0.9147368421052632, AUC 0.9798406362533569, avg_entr 0.011576876975595951, f1 0.9147368669509888
ep27_l4_test_time 0.19269931600001655
gc 0
Train Epoch28 Acc 0.9596333333333333 (115156/120000), AUC 0.9954994916915894
ep28_train_time 19.57212279500004
Test Epoch28 layer4 Acc 0.915, AUC 0.9800280928611755, avg_entr 0.011764703318476677, f1 0.9150000214576721
ep28_l4_test_time 0.21766134500001044
gc 0
Train Epoch29 Acc 0.9601416666666667 (115217/120000), AUC 0.9956539273262024
ep29_train_time 15.681320022999955
Test Epoch29 layer4 Acc 0.9181578947368421, AUC 0.9794005155563354, avg_entr 0.012592338025569916, f1 0.9181578755378723
ep29_l4_test_time 0.22646333099999083
Best AUC tensor(0.9245) 8
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 460.348430728
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9134210526315789, AUC 0.9809010624885559, avg_entr 0.06283382326364517, f1 0.9134210348129272
l0_test_time 0.21943745700002637
gc 0
Test layer1 Acc 0.9134210526315789, AUC 0.9806222915649414, avg_entr 0.060772575438022614, f1 0.9134210348129272
l1_test_time 0.21759787700000288
gc 0
Test layer2 Acc 0.9136842105263158, AUC 0.9819774627685547, avg_entr 0.046176373958587646, f1 0.9136841893196106
l2_test_time 0.23244095100000095
gc 0
Test layer3 Acc 0.9155263157894736, AUC 0.9801276326179504, avg_entr 0.02887003682553768, f1 0.9155263304710388
l3_test_time 0.23439524700000902
gc 0
Test layer4 Acc 0.9144736842105263, AUC 0.9797780513763428, avg_entr 0.02510036900639534, f1 0.9144737124443054
l4_test_time 0.22031565800000408
gc 0
Test threshold 0.1 Acc 0.915, AUC 0.9797041416168213, avg_entr 0.026624230667948723, f1 0.9150000214576721
t0.1_test_time 0.22809750899995151
gc 0
Test threshold 0.2 Acc 0.915, AUC 0.9805722236633301, avg_entr 0.032711148262023926, f1 0.9150000214576721
t0.2_test_time 0.23238158800000974
gc 0
Test threshold 0.3 Acc 0.9128947368421053, AUC 0.9806681275367737, avg_entr 0.040872957557439804, f1 0.9128947257995605
t0.3_test_time 0.22766277900001342
gc 0
Test threshold 0.4 Acc 0.9128947368421053, AUC 0.9809269309043884, avg_entr 0.04347468167543411, f1 0.9128947257995605
t0.4_test_time 0.22435816699999123
gc 0
Test threshold 0.5 Acc 0.9134210526315789, AUC 0.9808973670005798, avg_entr 0.04501109942793846, f1 0.9134210348129272
t0.5_test_time 0.2363644370000202
gc 0
Test threshold 0.6 Acc 0.9136842105263158, AUC 0.9809039831161499, avg_entr 0.04523489996790886, f1 0.9136841893196106
t0.6_test_time 0.22700479799999584
gc 0
Test threshold 0.7 Acc 0.9134210526315789, AUC 0.9809022545814514, avg_entr 0.04531066492199898, f1 0.9134210348129272
t0.7_test_time 0.2347805709999875
gc 0
Test threshold 0.8 Acc 0.9134210526315789, AUC 0.9809010624885559, avg_entr 0.04532502591609955, f1 0.9134210348129272
t0.8_test_time 0.22618992899998602
gc 0
Test threshold 0.9 Acc 0.9134210526315789, AUC 0.9809010624885559, avg_entr 0.04532502591609955, f1 0.9134210348129272
t0.9_test_time 0.2206431909999651
