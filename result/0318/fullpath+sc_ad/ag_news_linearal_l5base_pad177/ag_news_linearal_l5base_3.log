total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 16.037523871999998
Start Training
gc 0
Train Epoch0 Acc 0.6699583333333333 (80395/120000), AUC 0.8631277680397034
ep0_train_time 14.145689895
Test Epoch0 layer4 Acc 0.9042105263157895, AUC 0.9773563742637634, avg_entr 0.21494483947753906, f1 0.9042104482650757
ep0_l4_test_time 0.3081959440000013
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9165916666666667 (109991/120000), AUC 0.9815080165863037
ep1_train_time 22.913079368
Test Epoch1 layer4 Acc 0.916578947368421, AUC 0.9810081124305725, avg_entr 0.11910665780305862, f1 0.9165789484977722
ep1_l4_test_time 0.31469173699999686
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.927475 (111297/120000), AUC 0.9858541488647461
ep2_train_time 23.020147441000006
Test Epoch2 layer4 Acc 0.9213157894736842, AUC 0.9823154211044312, avg_entr 0.08115500211715698, f1 0.9213157892227173
ep2_l4_test_time 0.29751625000000104
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.932875 (111945/120000), AUC 0.9883110523223877
ep3_train_time 22.870203266000004
Test Epoch3 layer4 Acc 0.9184210526315789, AUC 0.9826152920722961, avg_entr 0.05490700900554657, f1 0.9184210896492004
ep3_l4_test_time 0.27756852900000695
gc 0
Train Epoch4 Acc 0.9368416666666667 (112421/120000), AUC 0.9896475076675415
ep4_train_time 22.92277958599999
Test Epoch4 layer4 Acc 0.9176315789473685, AUC 0.9821296334266663, avg_entr 0.04112552851438522, f1 0.9176315665245056
ep4_l4_test_time 0.30390147300001047
gc 0
Train Epoch5 Acc 0.9400916666666667 (112811/120000), AUC 0.9903954863548279
ep5_train_time 22.91364515299999
Test Epoch5 layer4 Acc 0.921578947368421, AUC 0.9825329780578613, avg_entr 0.03141755238175392, f1 0.9215789437294006
ep5_l4_test_time 0.3104765470000075
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9432083333333333 (113185/120000), AUC 0.9910519123077393
ep6_train_time 22.855613718
Test Epoch6 layer4 Acc 0.9218421052631579, AUC 0.9820690155029297, avg_entr 0.027340255677700043, f1 0.921842098236084
ep6_l4_test_time 0.30917541499999857
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9453083333333333 (113437/120000), AUC 0.9918936491012573
ep7_train_time 22.878318764
Test Epoch7 layer4 Acc 0.9236842105263158, AUC 0.9817492365837097, avg_entr 0.023399580270051956, f1 0.9236842393875122
ep7_l4_test_time 0.2975027200000113
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9468583333333334 (113623/120000), AUC 0.9924734234809875
ep8_train_time 22.877797558999987
Test Epoch8 layer4 Acc 0.9223684210526316, AUC 0.9810465574264526, avg_entr 0.020578008145093918, f1 0.9223684072494507
ep8_l4_test_time 0.30850052700000674
gc 0
Train Epoch9 Acc 0.948425 (113811/120000), AUC 0.9929153323173523
ep9_train_time 22.875079833
Test Epoch9 layer4 Acc 0.9234210526315789, AUC 0.9820504188537598, avg_entr 0.020128799602389336, f1 0.9234210252761841
ep9_l4_test_time 0.30591185500000506
gc 0
Train Epoch10 Acc 0.9496583333333334 (113959/120000), AUC 0.9933609366416931
ep10_train_time 22.888029878999987
Test Epoch10 layer4 Acc 0.9234210526315789, AUC 0.9813135862350464, avg_entr 0.017676427960395813, f1 0.9234210252761841
ep10_l4_test_time 0.3060734059999959
gc 0
Train Epoch11 Acc 0.9509166666666666 (114110/120000), AUC 0.993682861328125
ep11_train_time 22.905479230000026
Test Epoch11 layer4 Acc 0.9207894736842105, AUC 0.9805536270141602, avg_entr 0.016918137669563293, f1 0.9207894802093506
ep11_l4_test_time 0.30069380599996975
gc 0
Train Epoch12 Acc 0.9515833333333333 (114190/120000), AUC 0.9939194917678833
ep12_train_time 22.75895769599998
Test Epoch12 layer4 Acc 0.9221052631578948, AUC 0.9808120727539062, avg_entr 0.016728485003113747, f1 0.9221052527427673
ep12_l4_test_time 0.30596656000000166
gc 0
Train Epoch13 Acc 0.9528416666666667 (114341/120000), AUC 0.9939520955085754
ep13_train_time 22.84810223100004
Test Epoch13 layer4 Acc 0.921578947368421, AUC 0.9813128709793091, avg_entr 0.014491244219243526, f1 0.9215789437294006
ep13_l4_test_time 0.2981317329999911
gc 0
Train Epoch14 Acc 0.9532416666666667 (114389/120000), AUC 0.9941986203193665
ep14_train_time 22.937102969000023
Test Epoch14 layer4 Acc 0.9207894736842105, AUC 0.9802227020263672, avg_entr 0.01536396611481905, f1 0.9207894802093506
ep14_l4_test_time 0.31025012800000695
gc 0
Train Epoch15 Acc 0.9538583333333334 (114463/120000), AUC 0.9942387938499451
ep15_train_time 22.78598221699997
Test Epoch15 layer4 Acc 0.921578947368421, AUC 0.980758547782898, avg_entr 0.014632376842200756, f1 0.9215789437294006
ep15_l4_test_time 0.30745792599998367
gc 0
Train Epoch16 Acc 0.954925 (114591/120000), AUC 0.9944231510162354
ep16_train_time 22.853746514000022
Test Epoch16 layer4 Acc 0.9207894736842105, AUC 0.9805752038955688, avg_entr 0.013855802826583385, f1 0.9207894802093506
ep16_l4_test_time 0.29995026500000677
gc 0
Train Epoch17 Acc 0.9552666666666667 (114632/120000), AUC 0.9946278929710388
ep17_train_time 11.77815671999997
Test Epoch17 layer4 Acc 0.9176315789473685, AUC 0.9796023964881897, avg_entr 0.013081354089081287, f1 0.9176315665245056
ep17_l4_test_time 0.1635311809999962
gc 0
Train Epoch18 Acc 0.9558083333333334 (114697/120000), AUC 0.9946408867835999
ep18_train_time 11.45021430700001
Test Epoch18 layer4 Acc 0.9160526315789473, AUC 0.9807312488555908, avg_entr 0.014010900631546974, f1 0.9160526394844055
ep18_l4_test_time 0.3083262700000091
gc 0
Train Epoch19 Acc 0.9562416666666667 (114749/120000), AUC 0.9947656393051147
ep19_train_time 22.922671951999973
Test Epoch19 layer4 Acc 0.9221052631578948, AUC 0.9787975549697876, avg_entr 0.01371134165674448, f1 0.9221052527427673
ep19_l4_test_time 0.30594322500002136
gc 0
Train Epoch20 Acc 0.95695 (114834/120000), AUC 0.9949172735214233
ep20_train_time 22.876655787000004
Test Epoch20 layer4 Acc 0.9186842105263158, AUC 0.9798736572265625, avg_entr 0.012559548020362854, f1 0.918684184551239
ep20_l4_test_time 0.3036750879999772
gc 0
Train Epoch21 Acc 0.9571833333333334 (114862/120000), AUC 0.9949550032615662
ep21_train_time 22.881271728
Test Epoch21 layer4 Acc 0.9197368421052632, AUC 0.9803286790847778, avg_entr 0.012993606738746166, f1 0.9197368621826172
ep21_l4_test_time 0.2994845120000491
gc 0
Train Epoch22 Acc 0.9574916666666666 (114899/120000), AUC 0.9950166940689087
ep22_train_time 22.80760195399995
Test Epoch22 layer4 Acc 0.9171052631578948, AUC 0.979547381401062, avg_entr 0.012565994635224342, f1 0.9171052575111389
ep22_l4_test_time 0.297706987999959
gc 0
Train Epoch23 Acc 0.957525 (114903/120000), AUC 0.9950205087661743
ep23_train_time 22.85659252000005
Test Epoch23 layer4 Acc 0.9168421052631579, AUC 0.9796974658966064, avg_entr 0.013006697408854961, f1 0.9168421030044556
ep23_l4_test_time 0.3101441969999996
gc 0
Train Epoch24 Acc 0.9583583333333333 (115003/120000), AUC 0.9952341914176941
ep24_train_time 22.90054662299997
Test Epoch24 layer4 Acc 0.9189473684210526, AUC 0.979462206363678, avg_entr 0.013195373117923737, f1 0.9189472794532776
ep24_l4_test_time 0.3031446040000674
gc 0
Train Epoch25 Acc 0.9584666666666667 (115016/120000), AUC 0.9952496290206909
ep25_train_time 22.787279860000012
Test Epoch25 layer4 Acc 0.9173684210526316, AUC 0.979594349861145, avg_entr 0.013266893103718758, f1 0.9173683524131775
ep25_l4_test_time 0.29951541000002635
gc 0
Train Epoch26 Acc 0.958725 (115047/120000), AUC 0.9953246712684631
ep26_train_time 22.874283855000044
Test Epoch26 layer4 Acc 0.9171052631578948, AUC 0.9788355231285095, avg_entr 0.01135318074375391, f1 0.9171052575111389
ep26_l4_test_time 0.29996524600005614
gc 0
Train Epoch27 Acc 0.9589583333333334 (115075/120000), AUC 0.9953235387802124
ep27_train_time 22.832328280999945
Test Epoch27 layer4 Acc 0.9168421052631579, AUC 0.9797757267951965, avg_entr 0.011719408445060253, f1 0.9168421030044556
ep27_l4_test_time 0.3049065550000023
gc 0
Train Epoch28 Acc 0.9591333333333333 (115096/120000), AUC 0.9954903721809387
ep28_train_time 22.96097501899999
Test Epoch28 layer4 Acc 0.9171052631578948, AUC 0.9794721603393555, avg_entr 0.01222729030996561, f1 0.9171052575111389
ep28_l4_test_time 0.31339509199995064
gc 0
Train Epoch29 Acc 0.9596166666666667 (115154/120000), AUC 0.9954354166984558
ep29_train_time 22.948633588999996
Test Epoch29 layer4 Acc 0.9157894736842105, AUC 0.9794228076934814, avg_entr 0.011686424724757671, f1 0.9157894849777222
ep29_l4_test_time 0.30510215599997537
Best AUC tensor(0.9237) 7
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 665.9016758409999
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9136842105263158, AUC 0.9808807373046875, avg_entr 0.06555056571960449, f1 0.9136841893196106
l0_test_time 0.30103207199999815
gc 0
Test layer1 Acc 0.9136842105263158, AUC 0.9807896614074707, avg_entr 0.06309697777032852, f1 0.9136841893196106
l1_test_time 0.30030077999992955
gc 0
Test layer2 Acc 0.9144736842105263, AUC 0.9814389944076538, avg_entr 0.05348147451877594, f1 0.9144737124443054
l2_test_time 0.3136968369999522
gc 0
Test layer3 Acc 0.9147368421052632, AUC 0.9812679290771484, avg_entr 0.03224792703986168, f1 0.9147368669509888
l3_test_time 0.31340089399998305
gc 0
Test layer4 Acc 0.9144736842105263, AUC 0.9797833561897278, avg_entr 0.026265624910593033, f1 0.9144737124443054
l4_test_time 0.30648566299998947
gc 0
Test threshold 0.1 Acc 0.9142105263157895, AUC 0.9798359870910645, avg_entr 0.02799464575946331, f1 0.9142104983329773
t0.1_test_time 0.8504061469999442
gc 0
Test threshold 0.2 Acc 0.9134210526315789, AUC 0.9803649187088013, avg_entr 0.03474358841776848, f1 0.9134210348129272
t0.2_test_time 0.8396080740000116
gc 0
Test threshold 0.3 Acc 0.9139473684210526, AUC 0.9807256460189819, avg_entr 0.04289742186665535, f1 0.913947343826294
t0.3_test_time 0.8163129289999915
gc 0
Test threshold 0.4 Acc 0.9139473684210526, AUC 0.98089998960495, avg_entr 0.045658715069293976, f1 0.913947343826294
t0.4_test_time 0.759031144000005
gc 0
Test threshold 0.5 Acc 0.9142105263157895, AUC 0.980889081954956, avg_entr 0.0470542348921299, f1 0.9142104983329773
t0.5_test_time 0.5947907269999178
gc 0
Test threshold 0.6 Acc 0.9136842105263158, AUC 0.9808807373046875, avg_entr 0.04728473722934723, f1 0.9136841893196106
t0.6_test_time 0.5100471349999225
gc 0
Test threshold 0.7 Acc 0.9136842105263158, AUC 0.9808807373046875, avg_entr 0.04728473722934723, f1 0.9136841893196106
t0.7_test_time 0.4666278230000671
gc 0
Test threshold 0.8 Acc 0.9136842105263158, AUC 0.9808807373046875, avg_entr 0.04728473722934723, f1 0.9136841893196106
t0.8_test_time 0.49247749200003454
gc 0
Test threshold 0.9 Acc 0.9136842105263158, AUC 0.9808807373046875, avg_entr 0.04728473722934723, f1 0.9136841893196106
t0.9_test_time 0.49672666999993
