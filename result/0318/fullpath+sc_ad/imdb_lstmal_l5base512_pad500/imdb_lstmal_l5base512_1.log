total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 26.439850048999997
Start Training
gc 0
Train Epoch0 Acc 0.499075 (19963/40000), AUC 0.5005598068237305
ep0_train_time 153.812071128
Test Epoch0 layer4 Acc 0.5, AUC 0.5147918462753296, avg_entr 0.6759868264198303, f1 0.5
ep0_l4_test_time 5.222304092999991
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.50135 (20054/40000), AUC 0.49835723638534546
ep1_train_time 153.60841623599998
Test Epoch1 layer4 Acc 0.5048, AUC 0.5097909569740295, avg_entr 0.692558228969574, f1 0.504800021648407
ep1_l4_test_time 4.940378529999975
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.5081 (20324/40000), AUC 0.5152720212936401
ep2_train_time 154.33905779999998
Test Epoch2 layer4 Acc 0.5402, AUC 0.5939562320709229, avg_entr 0.6961877942085266, f1 0.5401999950408936
ep2_l4_test_time 5.2033442200000195
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.676775 (27071/40000), AUC 0.7464513778686523
ep3_train_time 153.80753149400005
Test Epoch3 layer4 Acc 0.7824, AUC 0.8596368432044983, avg_entr 0.30323389172554016, f1 0.7824000120162964
ep3_l4_test_time 5.250412750999999
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.81835 (32734/40000), AUC 0.8709971904754639
ep4_train_time 152.853686435
Test Epoch4 layer4 Acc 0.8192, AUC 0.8966757655143738, avg_entr 0.19446305930614471, f1 0.8191999197006226
ep4_l4_test_time 5.426484749999986
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.84385 (33754/40000), AUC 0.8980728387832642
ep5_train_time 153.39205161300004
Test Epoch5 layer4 Acc 0.828, AUC 0.905620813369751, avg_entr 0.121241495013237, f1 0.828000009059906
ep5_l4_test_time 5.422077594000029
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.862925 (34517/40000), AUC 0.9202340841293335
ep6_train_time 152.75248686499992
Test Epoch6 layer4 Acc 0.8426, AUC 0.9172450304031372, avg_entr 0.1056012436747551, f1 0.8426000475883484
ep6_l4_test_time 5.370663564000097
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.88525 (35410/40000), AUC 0.945792555809021
ep7_train_time 153.4727730259999
Test Epoch7 layer4 Acc 0.836, AUC 0.9184819459915161, avg_entr 0.07110470533370972, f1 0.8360000252723694
ep7_l4_test_time 5.090299339000012
gc 0
Train Epoch8 Acc 0.89465 (35786/40000), AUC 0.9420901536941528
ep8_train_time 154.76098524500003
Test Epoch8 layer4 Acc 0.8642, AUC 0.9293779134750366, avg_entr 0.10193655639886856, f1 0.8641999959945679
ep8_l4_test_time 5.021356125000011
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.910175 (36407/40000), AUC 0.9627275466918945
ep9_train_time 154.5952319999999
Test Epoch9 layer4 Acc 0.8832, AUC 0.9460075497627258, avg_entr 0.06545961648225784, f1 0.8831999897956848
ep9_l4_test_time 5.072230218999948
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.93135 (37254/40000), AUC 0.9763013124465942
ep10_train_time 154.28983523700003
Test Epoch10 layer4 Acc 0.8888, AUC 0.9485042691230774, avg_entr 0.05954428017139435, f1 0.8888000249862671
ep10_l4_test_time 5.179160823999837
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.937525 (37501/40000), AUC 0.9800168871879578
ep11_train_time 153.642501155
Test Epoch11 layer4 Acc 0.89, AUC 0.9487695693969727, avg_entr 0.04950808361172676, f1 0.8899999856948853
ep11_l4_test_time 5.154668812999944
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.941425 (37657/40000), AUC 0.9819365739822388
ep12_train_time 154.3962385279999
Test Epoch12 layer4 Acc 0.888, AUC 0.9497437477111816, avg_entr 0.04779563099145889, f1 0.8880000114440918
ep12_l4_test_time 5.211185792999913
gc 0
Train Epoch13 Acc 0.944975 (37799/40000), AUC 0.9833464622497559
ep13_train_time 154.28675841199993
Test Epoch13 layer4 Acc 0.8892, AUC 0.9488216638565063, avg_entr 0.04628705978393555, f1 0.88919997215271
ep13_l4_test_time 5.263331249000203
gc 0
Train Epoch14 Acc 0.947825 (37913/40000), AUC 0.9860701560974121
ep14_train_time 152.49683624499994
Test Epoch14 layer4 Acc 0.8862, AUC 0.9478788375854492, avg_entr 0.04186258092522621, f1 0.8862000107765198
ep14_l4_test_time 5.376223818000199
gc 0
Train Epoch15 Acc 0.95115 (38046/40000), AUC 0.9874845743179321
ep15_train_time 152.28785512700006
Test Epoch15 layer4 Acc 0.8878, AUC 0.9479091167449951, avg_entr 0.04302362725138664, f1 0.8877999782562256
ep15_l4_test_time 5.290284633999818
gc 0
Train Epoch16 Acc 0.952925 (38117/40000), AUC 0.9879984855651855
ep16_train_time 153.25246254500007
Test Epoch16 layer4 Acc 0.8852, AUC 0.9469815492630005, avg_entr 0.03691796958446503, f1 0.8852000832557678
ep16_l4_test_time 5.353766550999808
gc 0
Train Epoch17 Acc 0.9561 (38244/40000), AUC 0.989778995513916
ep17_train_time 154.10576157000014
Test Epoch17 layer4 Acc 0.8832, AUC 0.9467777013778687, avg_entr 0.04317260533571243, f1 0.8831999897956848
ep17_l4_test_time 5.082192306000252
gc 0
Train Epoch18 Acc 0.9583 (38332/40000), AUC 0.9904959201812744
ep18_train_time 154.33824066399984
Test Epoch18 layer4 Acc 0.8836, AUC 0.9447102546691895, avg_entr 0.03753453493118286, f1 0.8835999965667725
ep18_l4_test_time 5.114024083000004
gc 0
Train Epoch19 Acc 0.96025 (38410/40000), AUC 0.9913554191589355
ep19_train_time 154.57537335000006
Test Epoch19 layer4 Acc 0.8756, AUC 0.9400126934051514, avg_entr 0.03223027288913727, f1 0.8756000399589539
ep19_l4_test_time 5.091343196000253
Best AUC tensor(0.8900) 11
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 3181.120438375
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt
gc 10
Test layer0 Acc 0.8766, AUC 0.955383837223053, avg_entr 0.20221030712127686, f1 0.8766000270843506
l0_test_time 0.6610959820000062
gc 0
Test layer1 Acc 0.8874, AUC 0.9435752630233765, avg_entr 0.08029963076114655, f1 0.8873999714851379
l1_test_time 1.5542690870001934
gc 0
Test layer2 Acc 0.8862, AUC 0.9435468912124634, avg_entr 0.06258083879947662, f1 0.8862000107765198
l2_test_time 2.728475505000006
gc 0
Test layer3 Acc 0.8854, AUC 0.9434690475463867, avg_entr 0.05631570518016815, f1 0.8853999972343445
l3_test_time 3.906519204000233
gc 0
Test layer4 Acc 0.885, AUC 0.9440070390701294, avg_entr 0.05333957448601723, f1 0.8849999904632568
l4_test_time 5.020637564000026
gc 0
Test threshold 0.1 Acc 0.8858, AUC 0.9359538555145264, avg_entr 0.08836769312620163, f1 0.8858000040054321
t0.1_test_time 2.534431508000125
gc 0
Test threshold 0.2 Acc 0.8864, AUC 0.9332960844039917, avg_entr 0.10385852307081223, f1 0.8863999843597412
t0.2_test_time 2.353645757999857
gc 0
Test threshold 0.3 Acc 0.8872, AUC 0.9340137243270874, avg_entr 0.12295325845479965, f1 0.8871999979019165
t0.3_test_time 2.182693051000115
gc 0
Test threshold 0.4 Acc 0.888, AUC 0.935006856918335, avg_entr 0.14071716368198395, f1 0.8880000114440918
t0.4_test_time 2.1086341360000915
gc 0
Test threshold 0.5 Acc 0.8888, AUC 0.9360894560813904, avg_entr 0.15921954810619354, f1 0.8888000249862671
t0.5_test_time 2.0253298960001302
gc 0
Test threshold 0.6 Acc 0.8888, AUC 0.9386836290359497, avg_entr 0.17536719143390656, f1 0.8888000249862671
t0.6_test_time 2.0673669169996174
gc 0
Test threshold 0.7 Acc 0.8896, AUC 0.9399079084396362, avg_entr 0.19447018206119537, f1 0.8895999193191528
t0.7_test_time 2.0068342729996402
gc 0
Test threshold 0.8 Acc 0.8934, AUC 0.9440901875495911, avg_entr 0.21285195648670197, f1 0.8934000134468079
t0.8_test_time 1.9690056210001785
gc 0
Test threshold 0.9 Acc 0.8932, AUC 0.9480770826339722, avg_entr 0.2389420121908188, f1 0.8931999802589417
t0.9_test_time 1.8759297869996772
