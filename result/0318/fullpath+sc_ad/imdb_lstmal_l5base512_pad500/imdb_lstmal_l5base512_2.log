total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 26.753615318999998
Start Training
gc 0
Train Epoch0 Acc 0.499225 (19969/40000), AUC 0.500127375125885
ep0_train_time 153.635113762
Test Epoch0 layer4 Acc 0.499, AUC 0.4917902946472168, avg_entr 0.7009987235069275, f1 0.49900001287460327
ep0_l4_test_time 5.019063308
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.501625 (20065/40000), AUC 0.501537561416626
ep1_train_time 154.92217935199997
Test Epoch1 layer4 Acc 0.5, AUC 0.4996126592159271, avg_entr 0.6953722834587097, f1 0.5
ep1_l4_test_time 5.0630924959999675
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.501125 (20045/40000), AUC 0.522041916847229
ep2_train_time 153.95405234499998
Test Epoch2 layer4 Acc 0.5, AUC 0.5819653272628784, avg_entr 0.6949040293693542, f1 0.5
ep2_l4_test_time 5.167779523000036
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.66335 (26534/40000), AUC 0.7551024556159973
ep3_train_time 154.65141644699997
Test Epoch3 layer4 Acc 0.815, AUC 0.8860110640525818, avg_entr 0.26967594027519226, f1 0.8149999976158142
ep3_l4_test_time 5.07453509000004
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.83825 (33530/40000), AUC 0.8894443511962891
ep4_train_time 154.07794144499996
Test Epoch4 layer4 Acc 0.8392, AUC 0.9097729921340942, avg_entr 0.15845513343811035, f1 0.8392000198364258
ep4_l4_test_time 5.143185670999969
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.8854 (35416/40000), AUC 0.9347759485244751
ep5_train_time 153.58036078599991
Test Epoch5 layer4 Acc 0.876, AUC 0.9360372424125671, avg_entr 0.11980661749839783, f1 0.8760000467300415
ep5_l4_test_time 5.235062857000003
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.900325 (36013/40000), AUC 0.9519593119621277
ep6_train_time 152.91366599699995
Test Epoch6 layer4 Acc 0.8798, AUC 0.9372996091842651, avg_entr 0.09290556609630585, f1 0.879800021648407
ep6_l4_test_time 5.224628714000119
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.911275 (36451/40000), AUC 0.9598633050918579
ep7_train_time 154.09388434599987
Test Epoch7 layer4 Acc 0.8846, AUC 0.9469889402389526, avg_entr 0.09621863067150116, f1 0.8845999836921692
ep7_l4_test_time 5.328785994999862
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.920725 (36829/40000), AUC 0.9646199941635132
ep8_train_time 152.74911231500005
Test Epoch8 layer4 Acc 0.8482, AUC 0.9454702734947205, avg_entr 0.11262418329715729, f1 0.8482000231742859
ep8_l4_test_time 5.389261838999801
gc 0
Train Epoch9 Acc 0.924675 (36987/40000), AUC 0.9686700105667114
ep9_train_time 152.233385989
Test Epoch9 layer4 Acc 0.8822, AUC 0.9491326808929443, avg_entr 0.06866629421710968, f1 0.8822000026702881
ep9_l4_test_time 5.445016230999954
gc 0
Train Epoch10 Acc 0.9362 (37448/40000), AUC 0.9780374765396118
ep10_train_time 153.20911442200008
Test Epoch10 layer4 Acc 0.89, AUC 0.9482361674308777, avg_entr 0.050115086138248444, f1 0.8899999856948853
ep10_l4_test_time 4.997657987999901
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9384 (37536/40000), AUC 0.9784189462661743
ep11_train_time 154.79023783899993
Test Epoch11 layer4 Acc 0.8878, AUC 0.9486632347106934, avg_entr 0.045718465000391006, f1 0.8877999782562256
ep11_l4_test_time 5.006416997000088
gc 0
Train Epoch12 Acc 0.9401 (37604/40000), AUC 0.9801981449127197
ep12_train_time 154.02987436700028
Test Epoch12 layer4 Acc 0.89, AUC 0.9512825608253479, avg_entr 0.05119183287024498, f1 0.8899999856948853
ep12_l4_test_time 5.200178986000083
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.9468 (37872/40000), AUC 0.9846203327178955
ep13_train_time 149.79858356899967
Test Epoch13 layer4 Acc 0.8896, AUC 0.9515551924705505, avg_entr 0.04982326552271843, f1 0.8895999193191528
ep13_l4_test_time 3.2383764900000642
gc 0
Train Epoch14 Acc 0.94985 (37994/40000), AUC 0.9862270355224609
ep14_train_time 145.8943297159999
Test Epoch14 layer4 Acc 0.8854, AUC 0.9470517635345459, avg_entr 0.04033773019909859, f1 0.8853999972343445
ep14_l4_test_time 5.103923283999848
gc 0
Train Epoch15 Acc 0.950275 (38011/40000), AUC 0.9861689805984497
ep15_train_time 152.83644257700007
Test Epoch15 layer4 Acc 0.8878, AUC 0.9488350749015808, avg_entr 0.0454721637070179, f1 0.8877999782562256
ep15_l4_test_time 5.2804100540001855
gc 0
Train Epoch16 Acc 0.954775 (38191/40000), AUC 0.988358736038208
ep16_train_time 152.60833731599996
Test Epoch16 layer4 Acc 0.8884, AUC 0.9478168487548828, avg_entr 0.043783947825431824, f1 0.8884000182151794
ep16_l4_test_time 5.25232657100014
gc 0
Train Epoch17 Acc 0.9556 (38224/40000), AUC 0.9890309572219849
ep17_train_time 153.46354566799982
Test Epoch17 layer4 Acc 0.8838, AUC 0.947838306427002, avg_entr 0.03958452120423317, f1 0.8838000297546387
ep17_l4_test_time 5.361311322999882
gc 0
Train Epoch18 Acc 0.957725 (38309/40000), AUC 0.9901986122131348
ep18_train_time 152.10320327599993
Test Epoch18 layer4 Acc 0.88, AUC 0.9431511759757996, avg_entr 0.037905581295490265, f1 0.8799999952316284
ep18_l4_test_time 5.381759475999843
gc 0
Train Epoch19 Acc 0.959925 (38397/40000), AUC 0.9905314445495605
ep19_train_time 151.87837292699987
Test Epoch19 layer4 Acc 0.8754, AUC 0.9430310726165771, avg_entr 0.03952328488230705, f1 0.8754000067710876
ep19_l4_test_time 5.440870415000063
Best AUC tensor(0.8900) 12
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 3161.620202484
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt
gc 10
Test layer0 Acc 0.8972, AUC 0.955568790435791, avg_entr 0.2007734179496765, f1 0.8971999883651733
l0_test_time 0.6869425960003355
gc 0
Test layer1 Acc 0.8844, AUC 0.9466038346290588, avg_entr 0.07222138345241547, f1 0.8844000101089478
l1_test_time 1.6552850630000648
gc 0
Test layer2 Acc 0.8844, AUC 0.9462416172027588, avg_entr 0.05700594559311867, f1 0.8844000101089478
l2_test_time 2.8968181589998494
gc 0
Test layer3 Acc 0.8854, AUC 0.9467754364013672, avg_entr 0.05340363085269928, f1 0.8853999972343445
l3_test_time 4.177506369999719
gc 0
Test layer4 Acc 0.8846, AUC 0.9465029239654541, avg_entr 0.05467052012681961, f1 0.8845999836921692
l4_test_time 5.412963587999911
gc 0
Test threshold 0.1 Acc 0.8856, AUC 0.9406062364578247, avg_entr 0.08491533249616623, f1 0.8855999708175659
t0.1_test_time 2.782215952000115
gc 0
Test threshold 0.2 Acc 0.886, AUC 0.9362916946411133, avg_entr 0.10059358924627304, f1 0.8859999775886536
t0.2_test_time 2.5394157050000103
gc 0
Test threshold 0.3 Acc 0.8866, AUC 0.9326924085617065, avg_entr 0.11782599240541458, f1 0.8866000771522522
t0.3_test_time 2.438113764999798
gc 0
Test threshold 0.4 Acc 0.887, AUC 0.9329442977905273, avg_entr 0.1347263604402542, f1 0.8870000243186951
t0.4_test_time 2.3724834329996156
gc 0
Test threshold 0.5 Acc 0.8868, AUC 0.9320681095123291, avg_entr 0.1542089581489563, f1 0.8867999911308289
t0.5_test_time 2.2391805289998956
gc 0
Test threshold 0.6 Acc 0.8874, AUC 0.934651792049408, avg_entr 0.17570775747299194, f1 0.8873999714851379
t0.6_test_time 2.179291959999773
gc 0
Test threshold 0.7 Acc 0.8884, AUC 0.938130259513855, avg_entr 0.19898183643817902, f1 0.8884000182151794
t0.7_test_time 2.181773141999656
gc 0
Test threshold 0.8 Acc 0.8894, AUC 0.9423958659172058, avg_entr 0.22154374420642853, f1 0.8894000053405762
t0.8_test_time 2.0788032810000914
gc 0
Test threshold 0.9 Acc 0.8922, AUC 0.9444204568862915, avg_entr 0.2457231730222702, f1 0.8921999931335449
t0.9_test_time 2.009814760000154
