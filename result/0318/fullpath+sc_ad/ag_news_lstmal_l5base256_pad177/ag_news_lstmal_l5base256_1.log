total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 20.575211834
Start Training
gc 0
Train Epoch0 Acc 0.5635166666666667 (67622/120000), AUC 0.7900280952453613
ep0_train_time 182.012539506
Test Epoch0 layer4 Acc 0.8907894736842106, AUC 0.9728232622146606, avg_entr 0.2493092119693756, f1 0.8907894492149353
ep0_l4_test_time 1.587862414
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9090583333333333 (109087/120000), AUC 0.9767670631408691
ep1_train_time 188.09841300000002
Test Epoch1 layer4 Acc 0.9073684210526316, AUC 0.980144739151001, avg_entr 0.11123262345790863, f1 0.9073684215545654
ep1_l4_test_time 1.5841385709999827
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9237833333333333 (110854/120000), AUC 0.9833155870437622
ep2_train_time 186.294545942
Test Epoch2 layer4 Acc 0.9184210526315789, AUC 0.982655942440033, avg_entr 0.06663354486227036, f1 0.9184210896492004
ep2_l4_test_time 1.6370077709999578
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.932075 (111849/120000), AUC 0.9866036176681519
ep3_train_time 184.14670210300005
Test Epoch3 layer4 Acc 0.9213157894736842, AUC 0.9846006035804749, avg_entr 0.049712855368852615, f1 0.9213157892227173
ep3_l4_test_time 1.6564090770000348
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9379333333333333 (112552/120000), AUC 0.9885808229446411
ep4_train_time 173.71594947200003
Test Epoch4 layer4 Acc 0.9226315789473685, AUC 0.9837493896484375, avg_entr 0.03885657712817192, f1 0.922631561756134
ep4_l4_test_time 1.5303740699999935
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.941875 (113025/120000), AUC 0.9900199174880981
ep5_train_time 185.48003602199992
Test Epoch5 layer4 Acc 0.9213157894736842, AUC 0.9826557636260986, avg_entr 0.03291216865181923, f1 0.9213157892227173
ep5_l4_test_time 1.5463435699998627
gc 0
Train Epoch6 Acc 0.945625 (113475/120000), AUC 0.9910669922828674
ep6_train_time 184.93847271799996
Test Epoch6 layer4 Acc 0.9207894736842105, AUC 0.982689380645752, avg_entr 0.02569439448416233, f1 0.9207894802093506
ep6_l4_test_time 1.6216807420000805
gc 0
Train Epoch7 Acc 0.9484666666666667 (113816/120000), AUC 0.9918726682662964
ep7_train_time 184.60788743900002
Test Epoch7 layer4 Acc 0.9218421052631579, AUC 0.9831470251083374, avg_entr 0.02481958270072937, f1 0.921842098236084
ep7_l4_test_time 1.485456498000076
gc 0
Train Epoch8 Acc 0.9509833333333333 (114118/120000), AUC 0.9926270842552185
ep8_train_time 185.93544462699992
Test Epoch8 layer4 Acc 0.9205263157894736, AUC 0.982427716255188, avg_entr 0.023064222186803818, f1 0.9205263257026672
ep8_l4_test_time 1.5350133330000517
gc 0
Train Epoch9 Acc 0.9532083333333333 (114385/120000), AUC 0.9932814836502075
ep9_train_time 185.35085668500005
Test Epoch9 layer4 Acc 0.9210526315789473, AUC 0.9826803803443909, avg_entr 0.022560404613614082, f1 0.9210526347160339
ep9_l4_test_time 1.5849300810000386
gc 0
Train Epoch10 Acc 0.9551166666666666 (114614/120000), AUC 0.9937071800231934
ep10_train_time 184.462798046
Test Epoch10 layer4 Acc 0.9197368421052632, AUC 0.9824663996696472, avg_entr 0.020652327686548233, f1 0.9197368621826172
ep10_l4_test_time 1.6600040019998232
gc 0
Train Epoch11 Acc 0.957 (114840/120000), AUC 0.9939932823181152
ep11_train_time 184.9027559709998
Test Epoch11 layer4 Acc 0.9197368421052632, AUC 0.981848955154419, avg_entr 0.01958455517888069, f1 0.9197368621826172
ep11_l4_test_time 1.5839117319997058
gc 0
Train Epoch12 Acc 0.9586833333333333 (115042/120000), AUC 0.9944463968276978
ep12_train_time 185.81162157800009
Test Epoch12 layer4 Acc 0.9184210526315789, AUC 0.9822465777397156, avg_entr 0.01894873008131981, f1 0.9184210896492004
ep12_l4_test_time 1.53186875900019
gc 0
Train Epoch13 Acc 0.9600833333333333 (115210/120000), AUC 0.9948039650917053
ep13_train_time 185.41308659800006
Test Epoch13 layer4 Acc 0.9163157894736842, AUC 0.9818763732910156, avg_entr 0.017030838876962662, f1 0.9163157939910889
ep13_l4_test_time 1.63521515299999
gc 0
Train Epoch14 Acc 0.9616666666666667 (115400/120000), AUC 0.995063304901123
ep14_train_time 184.51312518700024
Test Epoch14 layer4 Acc 0.9178947368421052, AUC 0.9822072386741638, avg_entr 0.015886666253209114, f1 0.917894721031189
ep14_l4_test_time 1.6669426469998143
gc 0
Train Epoch15 Acc 0.9628833333333333 (115546/120000), AUC 0.9951934218406677
ep15_train_time 186.082376803
Test Epoch15 layer4 Acc 0.9173684210526316, AUC 0.9820708632469177, avg_entr 0.017285604029893875, f1 0.9173683524131775
ep15_l4_test_time 1.5523910539995995
gc 0
Train Epoch16 Acc 0.9642416666666667 (115709/120000), AUC 0.9954779744148254
ep16_train_time 185.53388593299997
Test Epoch16 layer4 Acc 0.9160526315789473, AUC 0.9815157651901245, avg_entr 0.014729836024343967, f1 0.9160526394844055
ep16_l4_test_time 1.5726927310001884
gc 0
Train Epoch17 Acc 0.9656666666666667 (115880/120000), AUC 0.9956701993942261
ep17_train_time 184.80591020500015
Test Epoch17 layer4 Acc 0.9163157894736842, AUC 0.9814974069595337, avg_entr 0.014179876074194908, f1 0.9163157939910889
ep17_l4_test_time 1.6222942650001642
gc 0
Train Epoch18 Acc 0.9668333333333333 (116020/120000), AUC 0.9958318471908569
ep18_train_time 184.40766471799998
Test Epoch18 layer4 Acc 0.9142105263157895, AUC 0.9815999269485474, avg_entr 0.013475879095494747, f1 0.9142104983329773
ep18_l4_test_time 1.5147832580000795
gc 0
Train Epoch19 Acc 0.9684333333333334 (116212/120000), AUC 0.9960356950759888
ep19_train_time 185.7886474439997
Test Epoch19 layer4 Acc 0.915, AUC 0.9806929230690002, avg_entr 0.01288202591240406, f1 0.9150000214576721
ep19_l4_test_time 1.5446103939998466
Best AUC tensor(0.9226) 4
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 3725.571194453
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9142105263157895, AUC 0.9798759818077087, avg_entr 0.12286847829818726, f1 0.9142104983329773
l0_test_time 0.2976608359999773
gc 0
Test layer1 Acc 0.9131578947368421, AUC 0.9823769927024841, avg_entr 0.048223827034235, f1 0.9131578803062439
l1_test_time 0.5075403269997878
gc 0
Test layer2 Acc 0.9131578947368421, AUC 0.9830142259597778, avg_entr 0.043752461671829224, f1 0.9131578803062439
l2_test_time 0.8392115730002843
gc 0
Test layer3 Acc 0.9131578947368421, AUC 0.9824063777923584, avg_entr 0.04571016877889633, f1 0.9131578803062439
l3_test_time 1.2035243279997303
gc 0
Test layer4 Acc 0.9123684210526316, AUC 0.981830894947052, avg_entr 0.043191540986299515, f1 0.9123684167861938
l4_test_time 1.5487229969999134
gc 0
Test threshold 0.1 Acc 0.9121052631578948, AUC 0.979000985622406, avg_entr 0.04190662130713463, f1 0.9121052622795105
t0.1_test_time 1.3609462389999862
gc 0
Test threshold 0.2 Acc 0.9110526315789473, AUC 0.9787024259567261, avg_entr 0.05230441316962242, f1 0.9110526442527771
t0.2_test_time 1.2666540399995938
gc 0
Test threshold 0.3 Acc 0.9105263157894737, AUC 0.9782984256744385, avg_entr 0.06167004629969597, f1 0.9105263352394104
t0.3_test_time 1.2803541700000096
gc 0
Test threshold 0.4 Acc 0.9131578947368421, AUC 0.9796161651611328, avg_entr 0.07789692282676697, f1 0.9131578803062439
t0.4_test_time 1.0506379409998772
gc 0
Test threshold 0.5 Acc 0.9144736842105263, AUC 0.9796727895736694, avg_entr 0.08570550382137299, f1 0.9144737124443054
t0.5_test_time 0.6563523370000439
gc 0
Test threshold 0.6 Acc 0.9142105263157895, AUC 0.9798759818077087, avg_entr 0.08863086998462677, f1 0.9142104983329773
t0.6_test_time 0.40923057800000606
gc 0
Test threshold 0.7 Acc 0.9142105263157895, AUC 0.9798759818077087, avg_entr 0.08863086998462677, f1 0.9142104983329773
t0.7_test_time 0.38073066300012215
gc 0
Test threshold 0.8 Acc 0.9142105263157895, AUC 0.9798759818077087, avg_entr 0.08863086998462677, f1 0.9142104983329773
t0.8_test_time 0.4010646820001966
gc 0
Test threshold 0.9 Acc 0.9142105263157895, AUC 0.9798759818077087, avg_entr 0.08863086998462677, f1 0.9142104983329773
t0.9_test_time 0.40482352999970317
