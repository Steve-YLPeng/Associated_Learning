total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 51.209996763999996
Start Training
gc 0
Train Epoch0 Acc 0.575275 (69033/120000), AUC 0.7993682622909546
ep0_train_time 170.72208207199998
Test Epoch0 layer4 Acc 0.8931578947368422, AUC 0.9757398366928101, avg_entr 0.24809885025024414, f1 0.8931578993797302
ep0_l4_test_time 1.5443754400000103
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.909975 (109197/120000), AUC 0.9773564338684082
ep1_train_time 175.187434553
Test Epoch1 layer4 Acc 0.9084210526315789, AUC 0.9835110306739807, avg_entr 0.11439218372106552, f1 0.9084210395812988
ep1_l4_test_time 1.5432485669999778
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.924425 (110931/120000), AUC 0.9836454391479492
ep2_train_time 175.02385011400003
Test Epoch2 layer4 Acc 0.9189473684210526, AUC 0.9849016070365906, avg_entr 0.06744464486837387, f1 0.9189472794532776
ep2_l4_test_time 1.551307204000068
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9324166666666667 (111890/120000), AUC 0.9868344664573669
ep3_train_time 174.873595282
Test Epoch3 layer4 Acc 0.9202631578947369, AUC 0.9852472543716431, avg_entr 0.05055876076221466, f1 0.9202631711959839
ep3_l4_test_time 1.5230434549999927
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9387666666666666 (112652/120000), AUC 0.988839864730835
ep4_train_time 174.713490622
Test Epoch4 layer4 Acc 0.9186842105263158, AUC 0.9831278920173645, avg_entr 0.038714319467544556, f1 0.918684184551239
ep4_l4_test_time 1.583384092000074
gc 0
Train Epoch5 Acc 0.9423666666666667 (113084/120000), AUC 0.9900580644607544
ep5_train_time 174.25662984899998
Test Epoch5 layer4 Acc 0.9192105263157895, AUC 0.9841026067733765, avg_entr 0.03170596435666084, f1 0.9192105531692505
ep5_l4_test_time 1.6425414380000802
gc 0
Train Epoch6 Acc 0.9459083333333334 (113509/120000), AUC 0.9911328554153442
ep6_train_time 174.97035501599998
Test Epoch6 layer4 Acc 0.9176315789473685, AUC 0.9837833642959595, avg_entr 0.0305185467004776, f1 0.9176315665245056
ep6_l4_test_time 1.5034354809999968
gc 0
Train Epoch7 Acc 0.9486166666666667 (113834/120000), AUC 0.9921356439590454
ep7_train_time 174.83612609899978
Test Epoch7 layer4 Acc 0.9205263157894736, AUC 0.9836678504943848, avg_entr 0.026834214106202126, f1 0.9205263257026672
ep7_l4_test_time 1.4965866520001327
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9511083333333333 (114133/120000), AUC 0.9926196336746216
ep8_train_time 175.5169979520001
Test Epoch8 layer4 Acc 0.9194736842105263, AUC 0.9834570288658142, avg_entr 0.02490801364183426, f1 0.9194737076759338
ep8_l4_test_time 1.4856790030000866
gc 0
Train Epoch9 Acc 0.9534583333333333 (114415/120000), AUC 0.9931720495223999
ep9_train_time 175.388405767
Test Epoch9 layer4 Acc 0.9171052631578948, AUC 0.982711136341095, avg_entr 0.02240188978612423, f1 0.9171052575111389
ep9_l4_test_time 1.5245930570001747
gc 0
Train Epoch10 Acc 0.9554166666666667 (114650/120000), AUC 0.9934777021408081
ep10_train_time 175.06228115699992
Test Epoch10 layer4 Acc 0.9181578947368421, AUC 0.9826453924179077, avg_entr 0.022808663547039032, f1 0.9181578755378723
ep10_l4_test_time 1.531018301000131
gc 0
Train Epoch11 Acc 0.9568916666666667 (114827/120000), AUC 0.9937835335731506
ep11_train_time 174.66710712500003
Test Epoch11 layer4 Acc 0.9168421052631579, AUC 0.9825268387794495, avg_entr 0.021449372172355652, f1 0.9168421030044556
ep11_l4_test_time 1.5574416120002752
gc 0
Train Epoch12 Acc 0.9589333333333333 (115072/120000), AUC 0.9942749738693237
ep12_train_time 175.42536030700012
Test Epoch12 layer4 Acc 0.916578947368421, AUC 0.9821058511734009, avg_entr 0.02016797475516796, f1 0.9165789484977722
ep12_l4_test_time 1.5224855209999077
gc 0
Train Epoch13 Acc 0.9605 (115260/120000), AUC 0.9944814443588257
ep13_train_time 174.7711658190001
Test Epoch13 layer4 Acc 0.9155263157894736, AUC 0.9818934798240662, avg_entr 0.017105601727962494, f1 0.9155263304710388
ep13_l4_test_time 1.566567622999628
gc 0
Train Epoch14 Acc 0.9617666666666667 (115412/120000), AUC 0.9945530891418457
ep14_train_time 174.8299861559999
Test Epoch14 layer4 Acc 0.9155263157894736, AUC 0.9815773963928223, avg_entr 0.0172423142939806, f1 0.9155263304710388
ep14_l4_test_time 1.5237377160001415
gc 0
Train Epoch15 Acc 0.9631083333333333 (115573/120000), AUC 0.994816780090332
ep15_train_time 174.24918007799988
Test Epoch15 layer4 Acc 0.9139473684210526, AUC 0.9807549118995667, avg_entr 0.015864137560129166, f1 0.913947343826294
ep15_l4_test_time 1.5443856580000102
gc 0
Train Epoch16 Acc 0.9644 (115728/120000), AUC 0.9951052665710449
ep16_train_time 158.82450997600017
Test Epoch16 layer4 Acc 0.9152631578947369, AUC 0.9800183773040771, avg_entr 0.016328535974025726, f1 0.9152631759643555
ep16_l4_test_time 1.5997946769998634
gc 0
Train Epoch17 Acc 0.9660833333333333 (115930/120000), AUC 0.9951256513595581
ep17_train_time 179.48153084399974
Test Epoch17 layer4 Acc 0.9139473684210526, AUC 0.9801478385925293, avg_entr 0.01561290305107832, f1 0.913947343826294
ep17_l4_test_time 1.5955779910000274
gc 0
Train Epoch18 Acc 0.9671666666666666 (116060/120000), AUC 0.995255708694458
ep18_train_time 180.28655152800002
Test Epoch18 layer4 Acc 0.9102631578947369, AUC 0.9795136451721191, avg_entr 0.014912175014615059, f1 0.910263180732727
ep18_l4_test_time 1.520869574000244
gc 0
Train Epoch19 Acc 0.9685333333333334 (116224/120000), AUC 0.9953047633171082
ep19_train_time 179.365950547
Test Epoch19 layer4 Acc 0.9086842105263158, AUC 0.9789617657661438, avg_entr 0.013702739961445332, f1 0.9086841940879822
ep19_l4_test_time 1.642326298000171
Best AUC tensor(0.9205) 7
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 3525.8074370480003
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9131578947368421, AUC 0.9808184504508972, avg_entr 0.09421119093894958, f1 0.9131578803062439
l0_test_time 0.39065135100008774
gc 0
Test layer1 Acc 0.9086842105263158, AUC 0.9823210835456848, avg_entr 0.03634549304842949, f1 0.9086841940879822
l1_test_time 0.6495132959998955
gc 0
Test layer2 Acc 0.9102631578947369, AUC 0.9830312132835388, avg_entr 0.03241909667849541, f1 0.910263180732727
l2_test_time 0.9433623649997571
gc 0
Test layer3 Acc 0.9110526315789473, AUC 0.9815812110900879, avg_entr 0.03246326744556427, f1 0.9110526442527771
l3_test_time 1.3340683000001263
gc 0
Test layer4 Acc 0.9105263157894737, AUC 0.9823442697525024, avg_entr 0.03272530436515808, f1 0.9105263352394104
l4_test_time 1.7035972619996755
gc 0
Test threshold 0.1 Acc 0.9097368421052632, AUC 0.977251410484314, avg_entr 0.030766593292355537, f1 0.9097368717193604
t0.1_test_time 1.523566553999899
gc 0
Test threshold 0.2 Acc 0.9086842105263158, AUC 0.9772367477416992, avg_entr 0.038547977805137634, f1 0.9086841940879822
t0.2_test_time 1.4430986239999584
gc 0
Test threshold 0.3 Acc 0.9089473684210526, AUC 0.9788028001785278, avg_entr 0.04949332773685455, f1 0.9089473485946655
t0.3_test_time 1.4778958699998839
gc 0
Test threshold 0.4 Acc 0.9121052631578948, AUC 0.9800886511802673, avg_entr 0.06079000234603882, f1 0.9121052622795105
t0.4_test_time 1.0994950780000181
gc 0
Test threshold 0.5 Acc 0.9118421052631579, AUC 0.9805062413215637, avg_entr 0.06593122333288193, f1 0.9118421077728271
t0.5_test_time 0.6875508129996888
gc 0
Test threshold 0.6 Acc 0.9131578947368421, AUC 0.9808184504508972, avg_entr 0.0679590180516243, f1 0.9131578803062439
t0.6_test_time 0.5058017189999191
gc 0
Test threshold 0.7 Acc 0.9131578947368421, AUC 0.9808184504508972, avg_entr 0.0679590180516243, f1 0.9131578803062439
t0.7_test_time 0.4590600659998927
gc 0
Test threshold 0.8 Acc 0.9131578947368421, AUC 0.9808184504508972, avg_entr 0.0679590180516243, f1 0.9131578803062439
t0.8_test_time 0.49191774800010535
gc 0
Test threshold 0.9 Acc 0.9131578947368421, AUC 0.9808184504508972, avg_entr 0.0679590180516243, f1 0.9131578803062439
t0.9_test_time 0.4677823439997155
