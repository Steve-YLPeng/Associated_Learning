total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 19.2317337
Start Training
gc 0
Train Epoch0 Acc 0.5498666666666666 (65984/120000), AUC 0.7801576256752014
ep0_train_time 193.504829763
Test Epoch0 layer4 Acc 0.8960526315789473, AUC 0.9704141020774841, avg_entr 0.2783099412918091, f1 0.8960526585578918
ep0_l4_test_time 1.6296887120000179
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9099583333333333 (109195/120000), AUC 0.9762154221534729
ep1_train_time 193.11015902900002
Test Epoch1 layer4 Acc 0.9092105263157895, AUC 0.9816219806671143, avg_entr 0.1138899102807045, f1 0.9092105031013489
ep1_l4_test_time 1.7138742849999744
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9246 (110952/120000), AUC 0.9833434820175171
ep2_train_time 175.13581320500003
Test Epoch2 layer4 Acc 0.9184210526315789, AUC 0.9839257001876831, avg_entr 0.07006838172674179, f1 0.9184210896492004
ep2_l4_test_time 1.1634821259999626
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9324166666666667 (111890/120000), AUC 0.9866190552711487
ep3_train_time 186.494061245
Test Epoch3 layer4 Acc 0.921578947368421, AUC 0.9830363988876343, avg_entr 0.05646008625626564, f1 0.9215789437294006
ep3_l4_test_time 1.5884253310000531
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.938675 (112641/120000), AUC 0.9884692430496216
ep4_train_time 188.84699179899997
Test Epoch4 layer4 Acc 0.9197368421052632, AUC 0.9830501675605774, avg_entr 0.04196847975254059, f1 0.9197368621826172
ep4_l4_test_time 1.58282662299996
gc 0
Train Epoch5 Acc 0.9427 (113124/120000), AUC 0.9899672865867615
ep5_train_time 188.7276660309999
Test Epoch5 layer4 Acc 0.92, AUC 0.9827244281768799, avg_entr 0.03655381128191948, f1 0.9200000166893005
ep5_l4_test_time 1.6148163410000507
gc 0
Train Epoch6 Acc 0.94615 (113538/120000), AUC 0.9910582304000854
ep6_train_time 188.52562506999993
Test Epoch6 layer4 Acc 0.9197368421052632, AUC 0.9827501773834229, avg_entr 0.02911432832479477, f1 0.9197368621826172
ep6_l4_test_time 1.632646209000086
gc 0
Train Epoch7 Acc 0.9489833333333333 (113878/120000), AUC 0.9922512173652649
ep7_train_time 188.043819085
Test Epoch7 layer4 Acc 0.9186842105263158, AUC 0.9819112420082092, avg_entr 0.030069932341575623, f1 0.918684184551239
ep7_l4_test_time 1.678839225999809
gc 0
Train Epoch8 Acc 0.9516333333333333 (114196/120000), AUC 0.9928189516067505
ep8_train_time 187.88662638999995
Test Epoch8 layer4 Acc 0.9163157894736842, AUC 0.9819173216819763, avg_entr 0.0259635541588068, f1 0.9163157939910889
ep8_l4_test_time 1.5813589650001632
gc 0
Train Epoch9 Acc 0.9534583333333333 (114415/120000), AUC 0.9933327436447144
ep9_train_time 189.42560632599998
Test Epoch9 layer4 Acc 0.9194736842105263, AUC 0.9825356602668762, avg_entr 0.026349015533924103, f1 0.9194737076759338
ep9_l4_test_time 1.563849793000145
gc 0
Train Epoch10 Acc 0.9556833333333333 (114682/120000), AUC 0.9936015605926514
ep10_train_time 189.0421859579999
Test Epoch10 layer4 Acc 0.9194736842105263, AUC 0.9819707870483398, avg_entr 0.023365270346403122, f1 0.9194737076759338
ep10_l4_test_time 1.5727910900000097
gc 0
Train Epoch11 Acc 0.9573 (114876/120000), AUC 0.9942377805709839
ep11_train_time 188.8909017980004
Test Epoch11 layer4 Acc 0.9152631578947369, AUC 0.9824126958847046, avg_entr 0.022258589044213295, f1 0.9152631759643555
ep11_l4_test_time 1.5976252169998588
gc 0
Train Epoch12 Acc 0.9588833333333333 (115066/120000), AUC 0.9944770932197571
ep12_train_time 188.15815628400014
Test Epoch12 layer4 Acc 0.9171052631578948, AUC 0.9820091724395752, avg_entr 0.020812561735510826, f1 0.9171052575111389
ep12_l4_test_time 1.6529239689998576
gc 0
Train Epoch13 Acc 0.9608166666666667 (115298/120000), AUC 0.9946721792221069
ep13_train_time 187.59189436499992
Test Epoch13 layer4 Acc 0.9152631578947369, AUC 0.9811083078384399, avg_entr 0.01982307992875576, f1 0.9152631759643555
ep13_l4_test_time 1.6578796359999615
gc 0
Train Epoch14 Acc 0.9621833333333333 (115462/120000), AUC 0.994975209236145
ep14_train_time 188.36848089900013
Test Epoch14 layer4 Acc 0.9155263157894736, AUC 0.9816890954971313, avg_entr 0.018817124888300896, f1 0.9155263304710388
ep14_l4_test_time 1.5716014990002805
gc 0
Train Epoch15 Acc 0.9636583333333333 (115639/120000), AUC 0.9952166080474854
ep15_train_time 189.09078150599998
Test Epoch15 layer4 Acc 0.9128947368421053, AUC 0.9807075262069702, avg_entr 0.017002420499920845, f1 0.9128947257995605
ep15_l4_test_time 1.5977553799998532
gc 0
Train Epoch16 Acc 0.9652 (115824/120000), AUC 0.995418131351471
ep16_train_time 182.49249953700019
Test Epoch16 layer4 Acc 0.9131578947368421, AUC 0.9807750582695007, avg_entr 0.017007973045110703, f1 0.9131578803062439
ep16_l4_test_time 1.6430923890002305
gc 0
Train Epoch17 Acc 0.966325 (115959/120000), AUC 0.9954885840415955
ep17_train_time 188.44786460600017
Test Epoch17 layer4 Acc 0.9136842105263158, AUC 0.9798682928085327, avg_entr 0.016736432909965515, f1 0.9136841893196106
ep17_l4_test_time 1.7018064639996737
gc 0
Train Epoch18 Acc 0.9679666666666666 (116156/120000), AUC 0.9957001805305481
ep18_train_time 188.1205711880002
Test Epoch18 layer4 Acc 0.915, AUC 0.9791518449783325, avg_entr 0.014891206286847591, f1 0.9150000214576721
ep18_l4_test_time 1.5565710790001503
gc 0
Train Epoch19 Acc 0.9691916666666667 (116303/120000), AUC 0.9957324266433716
ep19_train_time 189.32429225500027
Test Epoch19 layer4 Acc 0.9094736842105263, AUC 0.9787917137145996, avg_entr 0.014334105886518955, f1 0.9094736576080322
ep19_l4_test_time 1.580002639000213
Best AUC tensor(0.9216) 3
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 3792.532030904
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9126315789473685, AUC 0.9792196750640869, avg_entr 0.14238198101520538, f1 0.9126315712928772
l0_test_time 0.2831013499999244
gc 0
Test layer1 Acc 0.9142105263157895, AUC 0.9829620122909546, avg_entr 0.055635977536439896, f1 0.9142104983329773
l1_test_time 0.5252358590000767
gc 0
Test layer2 Acc 0.9136842105263158, AUC 0.9832140207290649, avg_entr 0.051121845841407776, f1 0.9136841893196106
l2_test_time 0.8681343469997955
gc 0
Test layer3 Acc 0.9126315789473685, AUC 0.9817483425140381, avg_entr 0.05350138619542122, f1 0.9126315712928772
l3_test_time 1.2035250119997727
gc 0
Test layer4 Acc 0.9123684210526316, AUC 0.9804913997650146, avg_entr 0.05939913168549538, f1 0.9123684167861938
l4_test_time 1.5608842229999027
gc 0
Test threshold 0.1 Acc 0.9118421052631579, AUC 0.978451132774353, avg_entr 0.04874878004193306, f1 0.9118421077728271
t0.1_test_time 1.426298319000125
gc 0
Test threshold 0.2 Acc 0.9118421052631579, AUC 0.9776121377944946, avg_entr 0.059170108288526535, f1 0.9118421077728271
t0.2_test_time 1.355730918000063
gc 0
Test threshold 0.3 Acc 0.9105263157894737, AUC 0.9772789478302002, avg_entr 0.0726318210363388, f1 0.9105263352394104
t0.3_test_time 1.353820609000195
gc 0
Test threshold 0.4 Acc 0.9105263157894737, AUC 0.9787324070930481, avg_entr 0.08786622434854507, f1 0.9105263352394104
t0.4_test_time 1.315513830999862
gc 0
Test threshold 0.5 Acc 0.9126315789473685, AUC 0.9791679382324219, avg_entr 0.09957149624824524, f1 0.9126315712928772
t0.5_test_time 0.7608482070004357
gc 0
Test threshold 0.6 Acc 0.9126315789473685, AUC 0.9792196750640869, avg_entr 0.10270688682794571, f1 0.9126315712928772
t0.6_test_time 0.38243761400008225
gc 0
Test threshold 0.7 Acc 0.9126315789473685, AUC 0.9792196750640869, avg_entr 0.10270688682794571, f1 0.9126315712928772
t0.7_test_time 0.44162323999989894
gc 0
Test threshold 0.8 Acc 0.9126315789473685, AUC 0.9792196750640869, avg_entr 0.10270688682794571, f1 0.9126315712928772
t0.8_test_time 0.40370965500005696
gc 0
Test threshold 0.9 Acc 0.9126315789473685, AUC 0.9792196750640869, avg_entr 0.10270688682794571, f1 0.9126315712928772
t0.9_test_time 0.4300307539997448
