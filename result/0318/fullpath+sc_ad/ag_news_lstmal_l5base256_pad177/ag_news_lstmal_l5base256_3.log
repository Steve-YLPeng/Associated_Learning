total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 45.392789562
Start Training
gc 0
Train Epoch0 Acc 0.5724083333333333 (68689/120000), AUC 0.7924512028694153
ep0_train_time 184.471192091
Test Epoch0 layer4 Acc 0.895, AUC 0.9742403626441956, avg_entr 0.2607211768627167, f1 0.8949999809265137
ep0_l4_test_time 1.6932363379999913
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9096916666666667 (109163/120000), AUC 0.9760271906852722
ep1_train_time 184.80686982999998
Test Epoch1 layer4 Acc 0.9092105263157895, AUC 0.9801602959632874, avg_entr 0.10807079076766968, f1 0.9092105031013489
ep1_l4_test_time 1.6354980689999934
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.92395 (110874/120000), AUC 0.9822390079498291
ep2_train_time 174.406414385
Test Epoch2 layer4 Acc 0.9160526315789473, AUC 0.9809305667877197, avg_entr 0.08049935847520828, f1 0.9160526394844055
ep2_l4_test_time 1.6413048549999303
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9317 (111804/120000), AUC 0.9852631092071533
ep3_train_time 183.666951766
Test Epoch3 layer4 Acc 0.9205263157894736, AUC 0.9824393391609192, avg_entr 0.04767689108848572, f1 0.9205263257026672
ep3_l4_test_time 1.5672455469999704
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.937275 (112473/120000), AUC 0.9877069592475891
ep4_train_time 185.61918013399998
Test Epoch4 layer4 Acc 0.921578947368421, AUC 0.9828321933746338, avg_entr 0.04048749431967735, f1 0.9215789437294006
ep4_l4_test_time 1.646935094000014
Save ckpt to ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9418666666666666 (113024/120000), AUC 0.9892320036888123
ep5_train_time 183.81890135999993
Test Epoch5 layer4 Acc 0.9194736842105263, AUC 0.9838842153549194, avg_entr 0.03369256108999252, f1 0.9194737076759338
ep5_l4_test_time 1.572087490000058
gc 0
Train Epoch6 Acc 0.9450166666666666 (113402/120000), AUC 0.9903736114501953
ep6_train_time 184.2569086819999
Test Epoch6 layer4 Acc 0.9197368421052632, AUC 0.9828588366508484, avg_entr 0.029694784432649612, f1 0.9197368621826172
ep6_l4_test_time 1.7349328420000347
gc 0
Train Epoch7 Acc 0.9480916666666667 (113771/120000), AUC 0.9913208484649658
ep7_train_time 184.4042933809999
Test Epoch7 layer4 Acc 0.9194736842105263, AUC 0.9833859205245972, avg_entr 0.025689823552966118, f1 0.9194737076759338
ep7_l4_test_time 1.5504416320000018
gc 0
Train Epoch8 Acc 0.9507 (114084/120000), AUC 0.9919226169586182
ep8_train_time 183.95506219999993
Test Epoch8 layer4 Acc 0.9181578947368421, AUC 0.9817471504211426, avg_entr 0.024616263806819916, f1 0.9181578755378723
ep8_l4_test_time 1.6988780750000387
gc 0
Train Epoch9 Acc 0.9531083333333333 (114373/120000), AUC 0.9926083087921143
ep9_train_time 184.55157433699992
Test Epoch9 layer4 Acc 0.9173684210526316, AUC 0.9813759922981262, avg_entr 0.024664409458637238, f1 0.9173683524131775
ep9_l4_test_time 1.6592608749999727
gc 0
Train Epoch10 Acc 0.9548916666666667 (114587/120000), AUC 0.9930419921875
ep10_train_time 183.7782907610001
Test Epoch10 layer4 Acc 0.92, AUC 0.9817484617233276, avg_entr 0.02246064506471157, f1 0.9200000166893005
ep10_l4_test_time 1.7385062980001749
gc 0
Train Epoch11 Acc 0.9566833333333333 (114802/120000), AUC 0.9933530688285828
ep11_train_time 170.07602614999996
Test Epoch11 layer4 Acc 0.9157894736842105, AUC 0.9812765121459961, avg_entr 0.020362745970487595, f1 0.9157894849777222
ep11_l4_test_time 1.0894869270000527
gc 0
Train Epoch12 Acc 0.9580583333333333 (114967/120000), AUC 0.9936974048614502
ep12_train_time 181.84458571599998
Test Epoch12 layer4 Acc 0.9186842105263158, AUC 0.9801708459854126, avg_entr 0.02040109410881996, f1 0.918684184551239
ep12_l4_test_time 1.5473020239996913
gc 0
Train Epoch13 Acc 0.960125 (115215/120000), AUC 0.9938583970069885
ep13_train_time 184.7053801279999
Test Epoch13 layer4 Acc 0.9142105263157895, AUC 0.9816676378250122, avg_entr 0.01805548556149006, f1 0.9142104983329773
ep13_l4_test_time 1.7499170329997469
gc 0
Train Epoch14 Acc 0.961225 (115347/120000), AUC 0.9941713809967041
ep14_train_time 184.63363031100016
Test Epoch14 layer4 Acc 0.9157894736842105, AUC 0.9799491167068481, avg_entr 0.01713617891073227, f1 0.9157894849777222
ep14_l4_test_time 1.6715517419997923
gc 0
Train Epoch15 Acc 0.9626583333333333 (115519/120000), AUC 0.9943828582763672
ep15_train_time 183.96800672500012
Test Epoch15 layer4 Acc 0.9147368421052632, AUC 0.9806495904922485, avg_entr 0.01693742908537388, f1 0.9147368669509888
ep15_l4_test_time 1.7376816850000978
gc 0
Train Epoch16 Acc 0.964125 (115695/120000), AUC 0.9946696758270264
ep16_train_time 185.21052341800032
Test Epoch16 layer4 Acc 0.9134210526315789, AUC 0.978922426700592, avg_entr 0.014191341586411, f1 0.9134210348129272
ep16_l4_test_time 1.6165966669996124
gc 0
Train Epoch17 Acc 0.965275 (115833/120000), AUC 0.9947289228439331
ep17_train_time 183.6081359130003
Test Epoch17 layer4 Acc 0.9123684210526316, AUC 0.9795068502426147, avg_entr 0.016611890867352486, f1 0.9123684167861938
ep17_l4_test_time 1.704388631999791
gc 0
Train Epoch18 Acc 0.967125 (116055/120000), AUC 0.994900107383728
ep18_train_time 185.15620704599996
Test Epoch18 layer4 Acc 0.9123684210526316, AUC 0.9788922071456909, avg_entr 0.013613521121442318, f1 0.9123684167861938
ep18_l4_test_time 1.695861691999653
gc 0
Train Epoch19 Acc 0.9680666666666666 (116168/120000), AUC 0.9950681328773499
ep19_train_time 184.08730160000005
Test Epoch19 layer4 Acc 0.9118421052631579, AUC 0.9791699051856995, avg_entr 0.012390880845487118, f1 0.9118421077728271
ep19_l4_test_time 1.6607821150000746
Best AUC tensor(0.9216) 4
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 3695.968540736
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base256_pad177//ag_news_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9128947368421053, AUC 0.9799970388412476, avg_entr 0.12373863905668259, f1 0.9128947257995605
l0_test_time 0.3583409230000143
gc 0
Test layer1 Acc 0.9123684210526316, AUC 0.9823533296585083, avg_entr 0.04653129726648331, f1 0.9123684167861938
l1_test_time 0.5880333719996997
gc 0
Test layer2 Acc 0.9131578947368421, AUC 0.9832198619842529, avg_entr 0.041655704379081726, f1 0.9131578803062439
l2_test_time 0.9809376179996434
gc 0
Test layer3 Acc 0.9118421052631579, AUC 0.9811943769454956, avg_entr 0.04761052504181862, f1 0.9118421077728271
l3_test_time 1.2461072760002025
gc 0
Test layer4 Acc 0.9121052631578948, AUC 0.980708658695221, avg_entr 0.04540802165865898, f1 0.9121052622795105
l4_test_time 1.6297703190002721
gc 0
Test threshold 0.1 Acc 0.911578947368421, AUC 0.9779601097106934, avg_entr 0.042191069573163986, f1 0.9115789532661438
t0.1_test_time 1.3468316809999124
gc 0
Test threshold 0.2 Acc 0.9107894736842105, AUC 0.9779914617538452, avg_entr 0.05139661207795143, f1 0.9107894897460938
t0.2_test_time 1.3080081010002687
gc 0
Test threshold 0.3 Acc 0.9092105263157895, AUC 0.9781564474105835, avg_entr 0.06402008980512619, f1 0.9092105031013489
t0.3_test_time 1.4740247489999092
gc 0
Test threshold 0.4 Acc 0.9126315789473685, AUC 0.978930652141571, avg_entr 0.07766372710466385, f1 0.9126315712928772
t0.4_test_time 1.1864921549999963
gc 0
Test threshold 0.5 Acc 0.9134210526315789, AUC 0.9795306921005249, avg_entr 0.0861147940158844, f1 0.9134210348129272
t0.5_test_time 0.7977492720001464
gc 0
Test threshold 0.6 Acc 0.9128947368421053, AUC 0.9799970388412476, avg_entr 0.08925855904817581, f1 0.9128947257995605
t0.6_test_time 0.5991787610000756
gc 0
Test threshold 0.7 Acc 0.9128947368421053, AUC 0.9799970388412476, avg_entr 0.08925855904817581, f1 0.9128947257995605
t0.7_test_time 0.5475394719996984
gc 0
Test threshold 0.8 Acc 0.9128947368421053, AUC 0.9799970388412476, avg_entr 0.08925855904817581, f1 0.9128947257995605
t0.8_test_time 0.5282979180001348
gc 0
Test threshold 0.9 Acc 0.9128947368421053, AUC 0.9799970388412476, avg_entr 0.08925855904817581, f1 0.9128947257995605
t0.9_test_time 0.5331720700000915
