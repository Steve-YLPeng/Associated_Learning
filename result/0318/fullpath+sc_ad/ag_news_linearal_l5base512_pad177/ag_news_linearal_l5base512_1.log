total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 27.221204893
Start Training
gc 0
Train Epoch0 Acc 0.24759166666666665 (29711/120000), AUC 0.4957613945007324
ep0_train_time 17.672183795000002
Test Epoch0 layer4 Acc 0.24868421052631579, AUC 0.4212413430213928, avg_entr 1.2646565437316895, f1 0.24868421256542206
ep0_l4_test_time 0.30803770600000036
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.6423666666666666 (77084/120000), AUC 0.8568871021270752
ep1_train_time 15.256012691999999
Test Epoch1 layer4 Acc 0.8847368421052632, AUC 0.9730352759361267, avg_entr 0.38624855875968933, f1 0.8847368359565735
ep1_l4_test_time 0.3114092299999953
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.906025 (108723/120000), AUC 0.9771476984024048
ep2_train_time 15.400580867999992
Test Epoch2 layer4 Acc 0.9078947368421053, AUC 0.9781595468521118, avg_entr 0.2518966794013977, f1 0.9078947901725769
ep2_l4_test_time 0.3142951469999957
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.91705 (110046/120000), AUC 0.9818315505981445
ep3_train_time 14.820073495000003
Test Epoch3 layer4 Acc 0.9144736842105263, AUC 0.9799198508262634, avg_entr 0.18975429236888885, f1 0.9144737124443054
ep3_l4_test_time 0.2915055080000002
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9229833333333334 (110758/120000), AUC 0.9841375350952148
ep4_train_time 15.166545378999999
Test Epoch4 layer4 Acc 0.9168421052631579, AUC 0.9809215068817139, avg_entr 0.1580432504415512, f1 0.9168421030044556
ep4_l4_test_time 0.28591962599999476
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9275333333333333 (111304/120000), AUC 0.9857609272003174
ep5_train_time 15.074472070999988
Test Epoch5 layer4 Acc 0.9202631578947369, AUC 0.9813189506530762, avg_entr 0.1319090574979782, f1 0.9202631711959839
ep5_l4_test_time 0.30015853899999456
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9303 (111636/120000), AUC 0.9870750904083252
ep6_train_time 15.180449233999994
Test Epoch6 layer4 Acc 0.92, AUC 0.9818577170372009, avg_entr 0.11698421835899353, f1 0.9200000166893005
ep6_l4_test_time 0.30060697400000436
gc 0
Train Epoch7 Acc 0.9329833333333334 (111958/120000), AUC 0.9881539344787598
ep7_train_time 15.096645435999989
Test Epoch7 layer4 Acc 0.9194736842105263, AUC 0.982546329498291, avg_entr 0.10267322510480881, f1 0.9194737076759338
ep7_l4_test_time 0.29676512999998295
gc 0
Train Epoch8 Acc 0.9356 (112272/120000), AUC 0.989109992980957
ep8_train_time 14.668674420999992
Test Epoch8 layer4 Acc 0.9213157894736842, AUC 0.9825744032859802, avg_entr 0.0882418230175972, f1 0.9213157892227173
ep8_l4_test_time 0.3142744920000098
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9378166666666666 (112538/120000), AUC 0.989957332611084
ep9_train_time 15.28829105700001
Test Epoch9 layer4 Acc 0.9242105263157895, AUC 0.9828413128852844, avg_entr 0.07586884498596191, f1 0.9242105484008789
ep9_l4_test_time 0.30288634599997977
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.939275 (112713/120000), AUC 0.9905965328216553
ep10_train_time 14.637153167000008
Test Epoch10 layer4 Acc 0.9218421052631579, AUC 0.9828974604606628, avg_entr 0.06499683856964111, f1 0.921842098236084
ep10_l4_test_time 0.32097860600001127
gc 0
Train Epoch11 Acc 0.941 (112920/120000), AUC 0.9911770224571228
ep11_train_time 15.05882362700001
Test Epoch11 layer4 Acc 0.9242105263157895, AUC 0.9835406541824341, avg_entr 0.055268775671720505, f1 0.9242105484008789
ep11_l4_test_time 0.2948857859999805
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9422833333333334 (113074/120000), AUC 0.9916181564331055
ep12_train_time 14.836130244999993
Test Epoch12 layer4 Acc 0.9231578947368421, AUC 0.9831478595733643, avg_entr 0.04673667997121811, f1 0.9231578707695007
ep12_l4_test_time 0.2988865850000195
gc 0
Train Epoch13 Acc 0.9436083333333334 (113233/120000), AUC 0.9918323755264282
ep13_train_time 15.14021975099999
Test Epoch13 layer4 Acc 0.9236842105263158, AUC 0.9830573797225952, avg_entr 0.04218281805515289, f1 0.9236842393875122
ep13_l4_test_time 0.2981885039999952
gc 0
Train Epoch14 Acc 0.9447083333333334 (113365/120000), AUC 0.99187833070755
ep14_train_time 15.62515477499997
Test Epoch14 layer4 Acc 0.9218421052631579, AUC 0.9817838668823242, avg_entr 0.03811020404100418, f1 0.921842098236084
ep14_l4_test_time 0.3247145059999639
gc 0
Train Epoch15 Acc 0.9453916666666666 (113447/120000), AUC 0.9919496774673462
ep15_train_time 15.09573677200001
Test Epoch15 layer4 Acc 0.9228947368421052, AUC 0.9814063906669617, avg_entr 0.0348343588411808, f1 0.9228947162628174
ep15_l4_test_time 0.3423022139999716
gc 0
Train Epoch16 Acc 0.946675 (113601/120000), AUC 0.9922060966491699
ep16_train_time 15.702618889999997
Test Epoch16 layer4 Acc 0.9223684210526316, AUC 0.9818272590637207, avg_entr 0.03338877856731415, f1 0.9223684072494507
ep16_l4_test_time 0.30777858699997296
gc 0
Train Epoch17 Acc 0.947675 (113721/120000), AUC 0.992374062538147
ep17_train_time 15.592447494999988
Test Epoch17 layer4 Acc 0.9226315789473685, AUC 0.9811506271362305, avg_entr 0.031145529821515083, f1 0.922631561756134
ep17_l4_test_time 0.2927675270000236
gc 0
Train Epoch18 Acc 0.9485166666666667 (113822/120000), AUC 0.9926440715789795
ep18_train_time 15.840558684999962
Test Epoch18 layer4 Acc 0.9218421052631579, AUC 0.9803582429885864, avg_entr 0.029582640156149864, f1 0.921842098236084
ep18_l4_test_time 0.32611702200000536
gc 0
Train Epoch19 Acc 0.949175 (113901/120000), AUC 0.9928745031356812
ep19_train_time 15.94625789600002
Test Epoch19 layer4 Acc 0.9223684210526316, AUC 0.9808611869812012, avg_entr 0.028338152915239334, f1 0.9223684072494507
ep19_l4_test_time 0.32615968400000384
Best AUC tensor(0.9242) 11
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 315.614434516
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9131578947368421, AUC 0.9806666374206543, avg_entr 0.10624448210000992, f1 0.9131578803062439
l0_test_time 0.283809701999985
gc 0
Test layer1 Acc 0.9128947368421053, AUC 0.9804221987724304, avg_entr 0.10105857253074646, f1 0.9128947257995605
l1_test_time 0.317926209999996
gc 0
Test layer2 Acc 0.9126315789473685, AUC 0.9804802536964417, avg_entr 0.09654513001441956, f1 0.9126315712928772
l2_test_time 0.2930955299999596
gc 0
Test layer3 Acc 0.9126315789473685, AUC 0.9812891483306885, avg_entr 0.07982071489095688, f1 0.9126315712928772
l3_test_time 0.3163562589999742
gc 0
Test layer4 Acc 0.9121052631578948, AUC 0.9820531010627747, avg_entr 0.06056125462055206, f1 0.9121052622795105
l4_test_time 0.29578736400003436
gc 0
Test threshold 0.1 Acc 0.9121052631578948, AUC 0.9805443286895752, avg_entr 0.05663139000535011, f1 0.9121052622795105
t0.1_test_time 0.6736282009999854
gc 0
Test threshold 0.2 Acc 0.9123684210526316, AUC 0.9806122779846191, avg_entr 0.06506627798080444, f1 0.9123684167861938
t0.2_test_time 0.6496164940000426
gc 0
Test threshold 0.3 Acc 0.911578947368421, AUC 0.980490505695343, avg_entr 0.07129981368780136, f1 0.9115789532661438
t0.3_test_time 0.6432502010000007
gc 0
Test threshold 0.4 Acc 0.9118421052631579, AUC 0.9805699586868286, avg_entr 0.07493226230144501, f1 0.9118421077728271
t0.4_test_time 0.7031095910000431
gc 0
Test threshold 0.5 Acc 0.9126315789473685, AUC 0.9806798100471497, avg_entr 0.07636188715696335, f1 0.9126315712928772
t0.5_test_time 0.595602686999996
gc 0
Test threshold 0.6 Acc 0.9131578947368421, AUC 0.9806655645370483, avg_entr 0.07662589848041534, f1 0.9131578803062439
t0.6_test_time 0.49349343799997314
gc 0
Test threshold 0.7 Acc 0.9131578947368421, AUC 0.9806666374206543, avg_entr 0.07663919776678085, f1 0.9131578803062439
t0.7_test_time 0.4752067559999773
gc 0
Test threshold 0.8 Acc 0.9131578947368421, AUC 0.9806666374206543, avg_entr 0.07663919776678085, f1 0.9131578803062439
t0.8_test_time 0.48034802799998033
gc 0
Test threshold 0.9 Acc 0.9131578947368421, AUC 0.9806666374206543, avg_entr 0.07663919776678085, f1 0.9131578803062439
t0.9_test_time 0.3333776090000242
