total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 26.220451183
Start Training
gc 0
Train Epoch0 Acc 0.23553333333333334 (28264/120000), AUC 0.5001706480979919
ep0_train_time 17.453575673999996
Test Epoch0 layer4 Acc 0.21447368421052632, AUC 0.4805145263671875, avg_entr 1.2424187660217285, f1 0.2144736796617508
ep0_l4_test_time 0.29877249500000147
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.6481333333333333 (77776/120000), AUC 0.836769700050354
ep1_train_time 15.015874015999998
Test Epoch1 layer4 Acc 0.885, AUC 0.9704061150550842, avg_entr 0.46493321657180786, f1 0.8849999904632568
ep1_l4_test_time 0.30138557000000077
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9059916666666666 (108719/120000), AUC 0.9772716164588928
ep2_train_time 15.409409032999996
Test Epoch2 layer4 Acc 0.9073684210526316, AUC 0.9780133366584778, avg_entr 0.24758677184581757, f1 0.9073684215545654
ep2_l4_test_time 0.27662542699999904
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9177416666666667 (110129/120000), AUC 0.9818624258041382
ep3_train_time 15.463200776000008
Test Epoch3 layer4 Acc 0.9134210526315789, AUC 0.9799319505691528, avg_entr 0.19027356803417206, f1 0.9134210348129272
ep3_l4_test_time 0.3318085509999946
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.92355 (110826/120000), AUC 0.9840610027313232
ep4_train_time 15.275930861000006
Test Epoch4 layer4 Acc 0.9155263157894736, AUC 0.9809504747390747, avg_entr 0.15681445598602295, f1 0.9155263304710388
ep4_l4_test_time 0.2940605709999886
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.927425 (111291/120000), AUC 0.9857624769210815
ep5_train_time 15.134846186999994
Test Epoch5 layer4 Acc 0.9194736842105263, AUC 0.9815250635147095, avg_entr 0.13258253037929535, f1 0.9194737076759338
ep5_l4_test_time 0.25941535100000124
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.93055 (111666/120000), AUC 0.987050473690033
ep6_train_time 15.159760750000018
Test Epoch6 layer4 Acc 0.9213157894736842, AUC 0.9817942380905151, avg_entr 0.11474896967411041, f1 0.9213157892227173
ep6_l4_test_time 0.31423156799999674
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9331583333333333 (111979/120000), AUC 0.9881384372711182
ep7_train_time 15.158186803999996
Test Epoch7 layer4 Acc 0.9205263157894736, AUC 0.9823073744773865, avg_entr 0.10245265066623688, f1 0.9205263257026672
ep7_l4_test_time 0.2932689419999974
gc 0
Train Epoch8 Acc 0.93585 (112302/120000), AUC 0.9890251159667969
ep8_train_time 15.427753580000001
Test Epoch8 layer4 Acc 0.9194736842105263, AUC 0.9823931455612183, avg_entr 0.0934276282787323, f1 0.9194737076759338
ep8_l4_test_time 0.3100227059999838
gc 0
Train Epoch9 Acc 0.937825 (112539/120000), AUC 0.9898048043251038
ep9_train_time 15.093173136000019
Test Epoch9 layer4 Acc 0.921578947368421, AUC 0.9830844402313232, avg_entr 0.08271826803684235, f1 0.9215789437294006
ep9_l4_test_time 0.3249292880000212
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.939075 (112689/120000), AUC 0.9905285835266113
ep10_train_time 15.074574856999988
Test Epoch10 layer4 Acc 0.92, AUC 0.9830103516578674, avg_entr 0.07163142412900925, f1 0.9200000166893005
ep10_l4_test_time 0.30259416200001965
gc 0
Train Epoch11 Acc 0.9408416666666667 (112901/120000), AUC 0.9911583662033081
ep11_train_time 15.353234342000007
Test Epoch11 layer4 Acc 0.9234210526315789, AUC 0.9834426045417786, avg_entr 0.06281910836696625, f1 0.9234210252761841
ep11_l4_test_time 0.3119451390000165
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9420333333333333 (113044/120000), AUC 0.9915627837181091
ep12_train_time 15.38494594300002
Test Epoch12 layer4 Acc 0.9218421052631579, AUC 0.9833715558052063, avg_entr 0.05542157217860222, f1 0.921842098236084
ep12_l4_test_time 0.357886738000019
gc 0
Train Epoch13 Acc 0.94365 (113238/120000), AUC 0.9919079542160034
ep13_train_time 15.045218102999996
Test Epoch13 layer4 Acc 0.921578947368421, AUC 0.9832408428192139, avg_entr 0.04698469489812851, f1 0.9215789437294006
ep13_l4_test_time 0.3023343710000006
gc 0
Train Epoch14 Acc 0.944725 (113367/120000), AUC 0.9921578168869019
ep14_train_time 14.868058055999967
Test Epoch14 layer4 Acc 0.9202631578947369, AUC 0.9832710027694702, avg_entr 0.04375116527080536, f1 0.9202631711959839
ep14_l4_test_time 0.28218799500001523
gc 0
Train Epoch15 Acc 0.94585 (113502/120000), AUC 0.9923496246337891
ep15_train_time 14.447003646999974
Test Epoch15 layer4 Acc 0.9202631578947369, AUC 0.9827605485916138, avg_entr 0.03839344531297684, f1 0.9202631711959839
ep15_l4_test_time 0.27950594200001433
gc 0
Train Epoch16 Acc 0.946375 (113565/120000), AUC 0.9925743341445923
ep16_train_time 14.915692707999995
Test Epoch16 layer4 Acc 0.9207894736842105, AUC 0.9827316999435425, avg_entr 0.03667432814836502, f1 0.9207894802093506
ep16_l4_test_time 0.3028608510000481
gc 0
Train Epoch17 Acc 0.9473583333333333 (113683/120000), AUC 0.9926319122314453
ep17_train_time 14.540049263000014
Test Epoch17 layer4 Acc 0.921578947368421, AUC 0.9817193746566772, avg_entr 0.03299367055296898, f1 0.9215789437294006
ep17_l4_test_time 0.2749152590000108
gc 0
Train Epoch18 Acc 0.9481583333333333 (113779/120000), AUC 0.9928938150405884
ep18_train_time 14.30528706900003
Test Epoch18 layer4 Acc 0.9223684210526316, AUC 0.9818986654281616, avg_entr 0.030676867812871933, f1 0.9223684072494507
ep18_l4_test_time 0.28628817600002776
gc 0
Train Epoch19 Acc 0.9491 (113892/120000), AUC 0.9931898713111877
ep19_train_time 15.007214615999999
Test Epoch19 layer4 Acc 0.9223684210526316, AUC 0.9810575842857361, avg_entr 0.029649393633008003, f1 0.9223684072494507
ep19_l4_test_time 0.2907886379999809
Best AUC tensor(0.9234) 11
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 311.76902893199997
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.915, AUC 0.9807189106941223, avg_entr 0.10520056635141373, f1 0.9150000214576721
l0_test_time 0.3014475569999604
gc 0
Test layer1 Acc 0.9126315789473685, AUC 0.9807025194168091, avg_entr 0.10103008896112442, f1 0.9126315712928772
l1_test_time 0.30733010400001604
gc 0
Test layer2 Acc 0.9131578947368421, AUC 0.9806677103042603, avg_entr 0.09643278270959854, f1 0.9131578803062439
l2_test_time 0.3033667120000132
gc 0
Test layer3 Acc 0.9123684210526316, AUC 0.9810649752616882, avg_entr 0.086946040391922, f1 0.9123684167861938
l3_test_time 0.30292361200002915
gc 0
Test layer4 Acc 0.9118421052631579, AUC 0.9819932579994202, avg_entr 0.06745774298906326, f1 0.9118421077728271
l4_test_time 0.29677585500002124
gc 0
Test threshold 0.1 Acc 0.9121052631578948, AUC 0.9806363582611084, avg_entr 0.059149038046598434, f1 0.9121052622795105
t0.1_test_time 0.48988667499997973
gc 0
Test threshold 0.2 Acc 0.9121052631578948, AUC 0.9805380702018738, avg_entr 0.06594469398260117, f1 0.9121052622795105
t0.2_test_time 0.4955523539999831
gc 0
Test threshold 0.3 Acc 0.9123684210526316, AUC 0.9806902408599854, avg_entr 0.07121577113866806, f1 0.9123684167861938
t0.3_test_time 0.41024959800000715
gc 0
Test threshold 0.4 Acc 0.9131578947368421, AUC 0.9806530475616455, avg_entr 0.07460526376962662, f1 0.9131578803062439
t0.4_test_time 0.6188352949999967
gc 0
Test threshold 0.5 Acc 0.9142105263157895, AUC 0.9807180166244507, avg_entr 0.07568493485450745, f1 0.9142104983329773
t0.5_test_time 0.4625090559999876
gc 0
Test threshold 0.6 Acc 0.915, AUC 0.9807146191596985, avg_entr 0.07586023956537247, f1 0.9150000214576721
t0.6_test_time 0.44239767199997004
gc 0
Test threshold 0.7 Acc 0.915, AUC 0.9807189106941223, avg_entr 0.07588616758584976, f1 0.9150000214576721
t0.7_test_time 0.40089819199999965
gc 0
Test threshold 0.8 Acc 0.915, AUC 0.9807189106941223, avg_entr 0.07588616758584976, f1 0.9150000214576721
t0.8_test_time 0.4292872820000184
gc 0
Test threshold 0.9 Acc 0.915, AUC 0.9807189106941223, avg_entr 0.07588616758584976, f1 0.9150000214576721
t0.9_test_time 0.4031743429999892
