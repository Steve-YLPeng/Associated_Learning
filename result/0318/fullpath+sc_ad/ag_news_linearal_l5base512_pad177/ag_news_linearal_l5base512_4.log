total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 26.890156745000002
Start Training
gc 0
Train Epoch0 Acc 0.24615 (29538/120000), AUC 0.49865180253982544
ep0_train_time 17.257517484999997
Test Epoch0 layer4 Acc 0.24421052631578946, AUC 0.4466831684112549, avg_entr 1.2717891931533813, f1 0.24421052634716034
ep0_l4_test_time 0.3789326419999952
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.6582583333333333 (78991/120000), AUC 0.8591888546943665
ep1_train_time 16.006059488
Test Epoch1 layer4 Acc 0.8905263157894737, AUC 0.9740443229675293, avg_entr 0.40121936798095703, f1 0.890526294708252
ep1_l4_test_time 0.31800994599999655
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9062 (108744/120000), AUC 0.977617621421814
ep2_train_time 16.19158543600001
Test Epoch2 layer4 Acc 0.9076315789473685, AUC 0.9784260988235474, avg_entr 0.25459688901901245, f1 0.9076315760612488
ep2_l4_test_time 0.35748840000000826
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9174833333333333 (110098/120000), AUC 0.9819049835205078
ep3_train_time 16.159003611999992
Test Epoch3 layer4 Acc 0.9131578947368421, AUC 0.9800843000411987, avg_entr 0.19531458616256714, f1 0.9131578803062439
ep3_l4_test_time 0.31417869099999507
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9234916666666667 (110819/120000), AUC 0.9842082858085632
ep4_train_time 15.571708536999992
Test Epoch4 layer4 Acc 0.916578947368421, AUC 0.981070876121521, avg_entr 0.1606213003396988, f1 0.9165789484977722
ep4_l4_test_time 0.3187325720000018
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9276916666666667 (111323/120000), AUC 0.985785186290741
ep5_train_time 15.783420294999985
Test Epoch5 layer4 Acc 0.9181578947368421, AUC 0.9814009666442871, avg_entr 0.13516269624233246, f1 0.9181578755378723
ep5_l4_test_time 0.3160116319999986
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9309833333333334 (111718/120000), AUC 0.9871235489845276
ep6_train_time 15.44616334700001
Test Epoch6 layer4 Acc 0.9210526315789473, AUC 0.9819730520248413, avg_entr 0.119574636220932, f1 0.9210526347160339
ep6_l4_test_time 0.33670487200001276
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9335166666666667 (112022/120000), AUC 0.9881638884544373
ep7_train_time 15.943167235999994
Test Epoch7 layer4 Acc 0.9213157894736842, AUC 0.982532262802124, avg_entr 0.10728909820318222, f1 0.9213157892227173
ep7_l4_test_time 0.33321032500001024
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9359583333333333 (112315/120000), AUC 0.989101767539978
ep8_train_time 15.757035352000003
Test Epoch8 layer4 Acc 0.9223684210526316, AUC 0.9828704595565796, avg_entr 0.093059241771698, f1 0.9223684072494507
ep8_l4_test_time 0.30294155800001477
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9379583333333333 (112555/120000), AUC 0.9899051785469055
ep9_train_time 15.527119411000001
Test Epoch9 layer4 Acc 0.9228947368421052, AUC 0.9828567504882812, avg_entr 0.08200489729642868, f1 0.9228947162628174
ep9_l4_test_time 0.30270391799999175
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9394583333333333 (112735/120000), AUC 0.9905537962913513
ep10_train_time 15.535097656999994
Test Epoch10 layer4 Acc 0.9234210526315789, AUC 0.9829136729240417, avg_entr 0.07268835604190826, f1 0.9234210252761841
ep10_l4_test_time 0.32414206499998954
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9409416666666667 (112913/120000), AUC 0.9911709427833557
ep11_train_time 17.19464277899999
Test Epoch11 layer4 Acc 0.9239473684210526, AUC 0.9833154082298279, avg_entr 0.06151138246059418, f1 0.9239473938941956
ep11_l4_test_time 0.2874516779999965
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9423 (113076/120000), AUC 0.9915661811828613
ep12_train_time 15.641269352999984
Test Epoch12 layer4 Acc 0.9234210526315789, AUC 0.9829581379890442, avg_entr 0.054085683077573776, f1 0.9234210252761841
ep12_l4_test_time 0.31787994699999444
gc 0
Train Epoch13 Acc 0.943675 (113241/120000), AUC 0.991915762424469
ep13_train_time 15.806528840000027
Test Epoch13 layer4 Acc 0.9236842105263158, AUC 0.9828483462333679, avg_entr 0.04563338682055473, f1 0.9236842393875122
ep13_l4_test_time 0.31001866399998335
gc 0
Train Epoch14 Acc 0.944825 (113379/120000), AUC 0.9920123219490051
ep14_train_time 16.047687080999992
Test Epoch14 layer4 Acc 0.9210526315789473, AUC 0.9827883243560791, avg_entr 0.04173349589109421, f1 0.9210526347160339
ep14_l4_test_time 0.3250183119999974
gc 0
Train Epoch15 Acc 0.946 (113520/120000), AUC 0.9920451045036316
ep15_train_time 15.596755747000032
Test Epoch15 layer4 Acc 0.9231578947368421, AUC 0.9817901849746704, avg_entr 0.037786222994327545, f1 0.9231578707695007
ep15_l4_test_time 0.31135443700003407
gc 0
Train Epoch16 Acc 0.9468833333333333 (113626/120000), AUC 0.9920759797096252
ep16_train_time 15.68170169299998
Test Epoch16 layer4 Acc 0.9239473684210526, AUC 0.9807083010673523, avg_entr 0.03438293933868408, f1 0.9239473938941956
ep16_l4_test_time 0.27940032700001893
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.948075 (113769/120000), AUC 0.9921631813049316
ep17_train_time 15.487151812000036
Test Epoch17 layer4 Acc 0.9234210526315789, AUC 0.9804261922836304, avg_entr 0.03155381232500076, f1 0.9234210252761841
ep17_l4_test_time 0.3299881560000131
gc 0
Train Epoch18 Acc 0.9487333333333333 (113848/120000), AUC 0.9923807382583618
ep18_train_time 15.915961947000028
Test Epoch18 layer4 Acc 0.9247368421052632, AUC 0.979857861995697, avg_entr 0.03026396408677101, f1 0.9247368574142456
ep18_l4_test_time 0.30750379500000236
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 18
gc 0
Train Epoch19 Acc 0.9493416666666666 (113921/120000), AUC 0.9926275610923767
ep19_train_time 15.671575502999985
Test Epoch19 layer4 Acc 0.9223684210526316, AUC 0.9791373014450073, avg_entr 0.030309325084090233, f1 0.9223684072494507
ep19_l4_test_time 0.30858509900002673
Best AUC tensor(0.9247) 18
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 327.42369246600003
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9139473684210526, AUC 0.9804593324661255, avg_entr 0.08543387800455093, f1 0.913947343826294
l0_test_time 0.3281731830000467
gc 0
Test layer1 Acc 0.9134210526315789, AUC 0.9803693294525146, avg_entr 0.08241979777812958, f1 0.9134210348129272
l1_test_time 0.32732202299996516
gc 0
Test layer2 Acc 0.9121052631578948, AUC 0.9806487560272217, avg_entr 0.07564876973628998, f1 0.9121052622795105
l2_test_time 0.33009376100000054
gc 0
Test layer3 Acc 0.9128947368421053, AUC 0.9810105562210083, avg_entr 0.04735923931002617, f1 0.9128947257995605
l3_test_time 0.3292733000000112
gc 0
Test layer4 Acc 0.9118421052631579, AUC 0.9782917499542236, avg_entr 0.034693870693445206, f1 0.9118421077728271
l4_test_time 0.31834529299999303
gc 0
Test threshold 0.1 Acc 0.9121052631578948, AUC 0.9793457984924316, avg_entr 0.037733376026153564, f1 0.9121052622795105
t0.1_test_time 0.6661599409999894
gc 0
Test threshold 0.2 Acc 0.9123684210526316, AUC 0.9797175526618958, avg_entr 0.04631990194320679, f1 0.9123684167861938
t0.2_test_time 0.7515519980000249
gc 0
Test threshold 0.3 Acc 0.9123684210526316, AUC 0.980217695236206, avg_entr 0.0551934689283371, f1 0.9123684167861938
t0.3_test_time 0.6367821889999732
gc 0
Test threshold 0.4 Acc 0.9134210526315789, AUC 0.9803751707077026, avg_entr 0.05947171524167061, f1 0.9134210348129272
t0.4_test_time 0.6394544330000258
gc 0
Test threshold 0.5 Acc 0.9139473684210526, AUC 0.980451226234436, avg_entr 0.061223044991493225, f1 0.913947343826294
t0.5_test_time 0.5345447990000025
gc 0
Test threshold 0.6 Acc 0.9144736842105263, AUC 0.9804691076278687, avg_entr 0.061475664377212524, f1 0.9144737124443054
t0.6_test_time 0.5144764589999795
gc 0
Test threshold 0.7 Acc 0.9139473684210526, AUC 0.9804593324661255, avg_entr 0.061627522110939026, f1 0.913947343826294
t0.7_test_time 0.4982602689999567
gc 0
Test threshold 0.8 Acc 0.9139473684210526, AUC 0.9804593324661255, avg_entr 0.061627522110939026, f1 0.913947343826294
t0.8_test_time 0.44766806399996995
gc 0
Test threshold 0.9 Acc 0.9139473684210526, AUC 0.9804593324661255, avg_entr 0.061627522110939026, f1 0.913947343826294
t0.9_test_time 0.3945305670000039
