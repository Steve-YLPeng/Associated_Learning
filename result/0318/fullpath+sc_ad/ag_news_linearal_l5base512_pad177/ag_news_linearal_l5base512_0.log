total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.731545466
Start Training
gc 0
Train Epoch0 Acc 0.24095 (28914/120000), AUC 0.49454593658447266
ep0_train_time 17.247976993
Test Epoch0 layer4 Acc 0.29526315789473684, AUC 0.39412379264831543, avg_entr 1.2509129047393799, f1 0.2952631711959839
ep0_l4_test_time 0.2567524020000036
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.6486083333333333 (77833/120000), AUC 0.8417586088180542
ep1_train_time 15.062541339000006
Test Epoch1 layer4 Acc 0.8860526315789473, AUC 0.974294900894165, avg_entr 0.38295960426330566, f1 0.886052668094635
ep1_l4_test_time 0.23801209199999818
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9069 (108828/120000), AUC 0.9776840209960938
ep2_train_time 15.547618298000003
Test Epoch2 layer4 Acc 0.9084210526315789, AUC 0.9783687591552734, avg_entr 0.2519386410713196, f1 0.9084210395812988
ep2_l4_test_time 0.3241172289999952
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.91785 (110142/120000), AUC 0.9820905923843384
ep3_train_time 15.136555290000004
Test Epoch3 layer4 Acc 0.9152631578947369, AUC 0.9798486828804016, avg_entr 0.19630444049835205, f1 0.9152631759643555
ep3_l4_test_time 0.25495400500000187
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9232583333333333 (110791/120000), AUC 0.9843379855155945
ep4_train_time 15.176348370999989
Test Epoch4 layer4 Acc 0.9181578947368421, AUC 0.9808383584022522, avg_entr 0.15879561007022858, f1 0.9181578755378723
ep4_l4_test_time 0.24223021599999583
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9274833333333333 (111298/120000), AUC 0.9859708547592163
ep5_train_time 15.209608677000006
Test Epoch5 layer4 Acc 0.9189473684210526, AUC 0.9814473986625671, avg_entr 0.1356547325849533, f1 0.9189472794532776
ep5_l4_test_time 0.23852981599999623
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9300416666666667 (111605/120000), AUC 0.9872635006904602
ep6_train_time 15.200899037000013
Test Epoch6 layer4 Acc 0.9213157894736842, AUC 0.9819838404655457, avg_entr 0.1174253448843956, f1 0.9213157892227173
ep6_l4_test_time 0.25158179000001724
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9330166666666667 (111962/120000), AUC 0.9883577823638916
ep7_train_time 15.564282141999996
Test Epoch7 layer4 Acc 0.9234210526315789, AUC 0.9823349714279175, avg_entr 0.10296608507633209, f1 0.9234210252761841
ep7_l4_test_time 0.24308025700000258
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9359666666666666 (112316/120000), AUC 0.9892038106918335
ep8_train_time 14.981103292
Test Epoch8 layer4 Acc 0.9242105263157895, AUC 0.9825324416160583, avg_entr 0.09259163588285446, f1 0.9242105484008789
ep8_l4_test_time 0.3144553650000148
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9376666666666666 (112520/120000), AUC 0.9899846315383911
ep9_train_time 15.347425599000019
Test Epoch9 layer4 Acc 0.9247368421052632, AUC 0.9828705191612244, avg_entr 0.08074589818716049, f1 0.9247368574142456
ep9_l4_test_time 0.24445045099997742
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9393083333333333 (112717/120000), AUC 0.9906283617019653
ep10_train_time 13.126279546999996
Test Epoch10 layer4 Acc 0.9234210526315789, AUC 0.9828860759735107, avg_entr 0.06893189996480942, f1 0.9234210252761841
ep10_l4_test_time 0.29488902400001393
gc 0
Train Epoch11 Acc 0.940825 (112899/120000), AUC 0.9910812377929688
ep11_train_time 12.414066742000017
Test Epoch11 layer4 Acc 0.9236842105263158, AUC 0.9825278520584106, avg_entr 0.06094855070114136, f1 0.9236842393875122
ep11_l4_test_time 0.23566139700000122
gc 0
Train Epoch12 Acc 0.9424333333333333 (113092/120000), AUC 0.991515040397644
ep12_train_time 15.41050357399999
Test Epoch12 layer4 Acc 0.9244736842105263, AUC 0.9829776287078857, avg_entr 0.05354808643460274, f1 0.9244737029075623
ep12_l4_test_time 0.24838494200000127
gc 0
Train Epoch13 Acc 0.94365 (113238/120000), AUC 0.9918292760848999
ep13_train_time 15.284533224
Test Epoch13 layer4 Acc 0.9231578947368421, AUC 0.9821993112564087, avg_entr 0.04509884491562843, f1 0.9231578707695007
ep13_l4_test_time 0.26728827899998464
gc 0
Train Epoch14 Acc 0.9454666666666667 (113456/120000), AUC 0.9920655488967896
ep14_train_time 15.391813788999997
Test Epoch14 layer4 Acc 0.9234210526315789, AUC 0.9826184511184692, avg_entr 0.040114738047122955, f1 0.9234210252761841
ep14_l4_test_time 0.24438915400000383
gc 0
Train Epoch15 Acc 0.945925 (113511/120000), AUC 0.9921994805335999
ep15_train_time 15.168063409999974
Test Epoch15 layer4 Acc 0.9252631578947368, AUC 0.9823817014694214, avg_entr 0.03739267960190773, f1 0.9252631664276123
ep15_l4_test_time 0.26615911100003586
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.94725 (113670/120000), AUC 0.9921817779541016
ep16_train_time 15.528654087999996
Test Epoch16 layer4 Acc 0.9239473684210526, AUC 0.9810453653335571, avg_entr 0.03484848886728287, f1 0.9239473938941956
ep16_l4_test_time 0.29111463399999593
gc 0
Train Epoch17 Acc 0.9479166666666666 (113750/120000), AUC 0.9922472238540649
ep17_train_time 15.269450084000027
Test Epoch17 layer4 Acc 0.9242105263157895, AUC 0.9805096387863159, avg_entr 0.031991295516490936, f1 0.9242105484008789
ep17_l4_test_time 0.24173115799999323
gc 0
Train Epoch18 Acc 0.9489083333333334 (113869/120000), AUC 0.992272138595581
ep18_train_time 15.255796728000007
Test Epoch18 layer4 Acc 0.9221052631578948, AUC 0.9798519611358643, avg_entr 0.030076073482632637, f1 0.9221052527427673
ep18_l4_test_time 0.2351117069999873
gc 0
Train Epoch19 Acc 0.9496666666666667 (113960/120000), AUC 0.9925851821899414
ep19_train_time 15.418470162999995
Test Epoch19 layer4 Acc 0.9210526315789473, AUC 0.9805347919464111, avg_entr 0.029991796240210533, f1 0.9210526347160339
ep19_l4_test_time 0.3313756860000012
Best AUC tensor(0.9253) 15
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 310.029362709
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.9121052631578948, AUC 0.9807758331298828, avg_entr 0.0941995233297348, f1 0.9121052622795105
l0_test_time 0.2788027629999874
gc 0
Test layer1 Acc 0.9121052631578948, AUC 0.9807643890380859, avg_entr 0.09083151072263718, f1 0.9121052622795105
l1_test_time 0.32102323600003047
gc 0
Test layer2 Acc 0.9121052631578948, AUC 0.9808573722839355, avg_entr 0.08472780883312225, f1 0.9121052622795105
l2_test_time 0.2967123789999846
gc 0
Test layer3 Acc 0.9142105263157895, AUC 0.9817713499069214, avg_entr 0.06436973810195923, f1 0.9142104983329773
l3_test_time 0.2860575309999831
gc 0
Test layer4 Acc 0.9144736842105263, AUC 0.9802954792976379, avg_entr 0.04292014613747597, f1 0.9144737124443054
l4_test_time 0.268306994999989
gc 0
Test threshold 0.1 Acc 0.9139473684210526, AUC 0.9802322387695312, avg_entr 0.04447131231427193, f1 0.913947343826294
t0.1_test_time 0.615927390999957
gc 0
Test threshold 0.2 Acc 0.9136842105263158, AUC 0.9802160263061523, avg_entr 0.05348912253975868, f1 0.9136841893196106
t0.2_test_time 0.654559570999993
gc 0
Test threshold 0.3 Acc 0.9131578947368421, AUC 0.9806047677993774, avg_entr 0.0617140494287014, f1 0.9131578803062439
t0.3_test_time 0.4355450410000117
gc 0
Test threshold 0.4 Acc 0.9136842105263158, AUC 0.9807835817337036, avg_entr 0.06594892591238022, f1 0.9136841893196106
t0.4_test_time 0.47038647099998343
gc 0
Test threshold 0.5 Acc 0.9123684210526316, AUC 0.9807875156402588, avg_entr 0.06747409701347351, f1 0.9123684167861938
t0.5_test_time 0.4165945760000227
gc 0
Test threshold 0.6 Acc 0.9121052631578948, AUC 0.9807758331298828, avg_entr 0.06795059144496918, f1 0.9121052622795105
t0.6_test_time 0.38442859600002066
gc 0
Test threshold 0.7 Acc 0.9121052631578948, AUC 0.9807758331298828, avg_entr 0.06795059144496918, f1 0.9121052622795105
t0.7_test_time 0.3735114179999641
gc 0
Test threshold 0.8 Acc 0.9121052631578948, AUC 0.9807758331298828, avg_entr 0.06795059144496918, f1 0.9121052622795105
t0.8_test_time 0.3936725649999744
gc 0
Test threshold 0.9 Acc 0.9121052631578948, AUC 0.9807758331298828, avg_entr 0.06795059144496918, f1 0.9121052622795105
t0.9_test_time 0.4316292879999537
