total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 30.12577199
Start Training
gc 0
Train Epoch0 Acc 0.24833333333333332 (29800/120000), AUC 0.4968698024749756
ep0_train_time 17.272187538000004
Test Epoch0 layer4 Acc 0.25552631578947366, AUC 0.4106901288032532, avg_entr 1.263110876083374, f1 0.2555263042449951
ep0_l4_test_time 0.33333541200000383
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.5727416666666667 (68729/120000), AUC 0.8074500560760498
ep1_train_time 15.223134655000003
Test Epoch1 layer4 Acc 0.8894736842105263, AUC 0.9715690612792969, avg_entr 0.47037389874458313, f1 0.8894736766815186
ep1_l4_test_time 0.29723775899999794
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.904075 (108489/120000), AUC 0.9774141311645508
ep2_train_time 15.071543833000007
Test Epoch2 layer4 Acc 0.9063157894736842, AUC 0.9784196615219116, avg_entr 0.25390657782554626, f1 0.906315803527832
ep2_l4_test_time 0.31101605499999607
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9163833333333333 (109966/120000), AUC 0.9821791052818298
ep3_train_time 15.125501454999991
Test Epoch3 layer4 Acc 0.915, AUC 0.9798151254653931, avg_entr 0.19220593571662903, f1 0.9150000214576721
ep3_l4_test_time 0.3084284170000018
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.923025 (110763/120000), AUC 0.9844565987586975
ep4_train_time 14.798245495000003
Test Epoch4 layer4 Acc 0.9173684210526316, AUC 0.9809114933013916, avg_entr 0.1578705608844757, f1 0.9173683524131775
ep4_l4_test_time 0.30821620099999336
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9272166666666667 (111266/120000), AUC 0.9860457181930542
ep5_train_time 15.496761719999995
Test Epoch5 layer4 Acc 0.916578947368421, AUC 0.9817408323287964, avg_entr 0.13930340111255646, f1 0.9165789484977722
ep5_l4_test_time 0.3334707680000122
gc 0
Train Epoch6 Acc 0.930225 (111627/120000), AUC 0.9873911142349243
ep6_train_time 14.982737992000011
Test Epoch6 layer4 Acc 0.9197368421052632, AUC 0.9818933010101318, avg_entr 0.11560948193073273, f1 0.9197368621826172
ep6_l4_test_time 0.30836668700001724
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.933525 (112023/120000), AUC 0.9883700609207153
ep7_train_time 15.78024695900001
Test Epoch7 layer4 Acc 0.92, AUC 0.9825234413146973, avg_entr 0.1027919352054596, f1 0.9200000166893005
ep7_l4_test_time 0.3223281939999936
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9357666666666666 (112292/120000), AUC 0.9892764091491699
ep8_train_time 15.940595265000013
Test Epoch8 layer4 Acc 0.9221052631578948, AUC 0.9826193451881409, avg_entr 0.08954145759344101, f1 0.9221052527427673
ep8_l4_test_time 0.31827681199999347
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9373583333333333 (112483/120000), AUC 0.9900528192520142
ep9_train_time 15.350184468999998
Test Epoch9 layer4 Acc 0.9226315789473685, AUC 0.9830268025398254, avg_entr 0.07826470583677292, f1 0.922631561756134
ep9_l4_test_time 0.31010113000002093
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9388666666666666 (112664/120000), AUC 0.9907282590866089
ep10_train_time 15.535192348999999
Test Epoch10 layer4 Acc 0.9242105263157895, AUC 0.9829399585723877, avg_entr 0.0674925222992897, f1 0.9242105484008789
ep10_l4_test_time 0.3427099840000096
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9406916666666667 (112883/120000), AUC 0.9912798404693604
ep11_train_time 15.243171146999998
Test Epoch11 layer4 Acc 0.9242105263157895, AUC 0.9828219413757324, avg_entr 0.05832375958561897, f1 0.9242105484008789
ep11_l4_test_time 0.2844178290000059
Save ckpt to ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9422583333333333 (113071/120000), AUC 0.991649329662323
ep12_train_time 15.143045460999986
Test Epoch12 layer4 Acc 0.9231578947368421, AUC 0.9833517074584961, avg_entr 0.05197274684906006, f1 0.9231578707695007
ep12_l4_test_time 0.2982630239999935
gc 0
Train Epoch13 Acc 0.94345 (113214/120000), AUC 0.991910457611084
ep13_train_time 15.283310628999999
Test Epoch13 layer4 Acc 0.9210526315789473, AUC 0.9832344055175781, avg_entr 0.044360678642988205, f1 0.9210526347160339
ep13_l4_test_time 0.3122308849999911
gc 0
Train Epoch14 Acc 0.9447666666666666 (113372/120000), AUC 0.9920923709869385
ep14_train_time 14.64623079499998
Test Epoch14 layer4 Acc 0.9221052631578948, AUC 0.9825511574745178, avg_entr 0.03996417298913002, f1 0.9221052527427673
ep14_l4_test_time 0.28232672899997624
gc 0
Train Epoch15 Acc 0.9459083333333334 (113509/120000), AUC 0.9921963214874268
ep15_train_time 15.303689132000045
Test Epoch15 layer4 Acc 0.9213157894736842, AUC 0.9816128611564636, avg_entr 0.03655651584267616, f1 0.9213157892227173
ep15_l4_test_time 0.29798380800002633
gc 0
Train Epoch16 Acc 0.9468916666666667 (113627/120000), AUC 0.9923573732376099
ep16_train_time 15.399695447999989
Test Epoch16 layer4 Acc 0.9223684210526316, AUC 0.9810045957565308, avg_entr 0.03341379761695862, f1 0.9223684072494507
ep16_l4_test_time 0.28787307499999315
gc 0
Train Epoch17 Acc 0.9478833333333333 (113746/120000), AUC 0.9925758838653564
ep17_train_time 14.860065566000003
Test Epoch17 layer4 Acc 0.9221052631578948, AUC 0.9812124967575073, avg_entr 0.031137535348534584, f1 0.9221052527427673
ep17_l4_test_time 0.33738764299999957
gc 0
Train Epoch18 Acc 0.9486666666666667 (113840/120000), AUC 0.9927185773849487
ep18_train_time 15.263822828999992
Test Epoch18 layer4 Acc 0.921578947368421, AUC 0.9810110926628113, avg_entr 0.02942466177046299, f1 0.9215789437294006
ep18_l4_test_time 0.3010317520000285
gc 0
Train Epoch19 Acc 0.9493416666666666 (113921/120000), AUC 0.9930081963539124
ep19_train_time 15.335337969999955
Test Epoch19 layer4 Acc 0.9192105263157895, AUC 0.9811918139457703, avg_entr 0.030324013903737068, f1 0.9192105531692505
ep19_l4_test_time 0.284025406000012
Best AUC tensor(0.9242) 11
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 315.766954128
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base512_pad177//ag_news_linearal_l5.pt
gc 10
Test layer0 Acc 0.911578947368421, AUC 0.9808889627456665, avg_entr 0.10637714713811874, f1 0.9115789532661438
l0_test_time 0.32963064399996256
gc 0
Test layer1 Acc 0.9123684210526316, AUC 0.980583667755127, avg_entr 0.10347755998373032, f1 0.9123684167861938
l1_test_time 0.30491766599999437
gc 0
Test layer2 Acc 0.911578947368421, AUC 0.9805799722671509, avg_entr 0.09744403511285782, f1 0.9115789532661438
l2_test_time 0.33086302999998907
gc 0
Test layer3 Acc 0.911578947368421, AUC 0.9810571670532227, avg_entr 0.08377721160650253, f1 0.9115789532661438
l3_test_time 0.3227764950000278
gc 0
Test layer4 Acc 0.9134210526315789, AUC 0.981130838394165, avg_entr 0.06223597377538681, f1 0.9134210348129272
l4_test_time 0.32346544299997504
gc 0
Test threshold 0.1 Acc 0.9131578947368421, AUC 0.980681300163269, avg_entr 0.05698863044381142, f1 0.9131578803062439
t0.1_test_time 0.5326371130000211
gc 0
Test threshold 0.2 Acc 0.9131578947368421, AUC 0.9806957244873047, avg_entr 0.06534319370985031, f1 0.9131578803062439
t0.2_test_time 0.6283747919999882
gc 0
Test threshold 0.3 Acc 0.9123684210526316, AUC 0.9807741641998291, avg_entr 0.07151035219430923, f1 0.9123684167861938
t0.3_test_time 0.4525423619999742
gc 0
Test threshold 0.4 Acc 0.911578947368421, AUC 0.9808436036109924, avg_entr 0.07543503493070602, f1 0.9115789532661438
t0.4_test_time 0.6125766750000139
gc 0
Test threshold 0.5 Acc 0.9118421052631579, AUC 0.9808935523033142, avg_entr 0.07650253921747208, f1 0.9118421077728271
t0.5_test_time 0.6826212099999793
gc 0
Test threshold 0.6 Acc 0.911578947368421, AUC 0.9808889627456665, avg_entr 0.07673487812280655, f1 0.9115789532661438
t0.6_test_time 0.4747927349999941
gc 0
Test threshold 0.7 Acc 0.911578947368421, AUC 0.9808889627456665, avg_entr 0.07673487812280655, f1 0.9115789532661438
t0.7_test_time 0.4622051590000069
gc 0
Test threshold 0.8 Acc 0.911578947368421, AUC 0.9808889627456665, avg_entr 0.07673487812280655, f1 0.9115789532661438
t0.8_test_time 0.46330002199999853
gc 0
Test threshold 0.9 Acc 0.911578947368421, AUC 0.9808889627456665, avg_entr 0.07673487812280655, f1 0.9115789532661438
t0.9_test_time 0.4610303169999952
