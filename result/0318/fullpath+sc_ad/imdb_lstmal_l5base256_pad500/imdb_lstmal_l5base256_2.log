total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 25.488346556
Start Training
gc 0
Train Epoch0 Acc 0.499325 (19973/40000), AUC 0.501573920249939
ep0_train_time 198.908491617
Test Epoch0 layer4 Acc 0.5, AUC 0.4994376599788666, avg_entr 0.6970490217208862, f1 0.5
ep0_l4_test_time 7.115051004000009
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.558525 (22341/40000), AUC 0.6019713282585144
ep1_train_time 203.20872470099997
Test Epoch1 layer4 Acc 0.772, AUC 0.8510493040084839, avg_entr 0.4436643421649933, f1 0.7720000147819519
ep1_l4_test_time 6.653993306000018
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.7966 (31864/40000), AUC 0.8605924844741821
ep2_train_time 209.78826331500005
Test Epoch2 layer4 Acc 0.8118, AUC 0.8922403454780579, avg_entr 0.13080601394176483, f1 0.8118000030517578
ep2_l4_test_time 6.852288593000026
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.87025 (34810/40000), AUC 0.9110371470451355
ep3_train_time 203.55610976000003
Test Epoch3 layer4 Acc 0.8612, AUC 0.9238576889038086, avg_entr 0.08662724494934082, f1 0.8612000346183777
ep3_l4_test_time 6.9683928499999865
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.889275 (35571/40000), AUC 0.9392873048782349
ep4_train_time 207.09636400199997
Test Epoch4 layer4 Acc 0.8754, AUC 0.9364129304885864, avg_entr 0.06885620206594467, f1 0.8754000067710876
ep4_l4_test_time 6.778820758999927
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9164 (36656/40000), AUC 0.9628098011016846
ep5_train_time 206.96955697199996
Test Epoch5 layer4 Acc 0.8822, AUC 0.9430074691772461, avg_entr 0.060493480414152145, f1 0.8822000026702881
ep5_l4_test_time 7.074905782000087
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.92975 (37190/40000), AUC 0.9737950563430786
ep6_train_time 203.3767984629999
Test Epoch6 layer4 Acc 0.877, AUC 0.9432895183563232, avg_entr 0.05667897313833237, f1 0.8769999742507935
ep6_l4_test_time 6.6301047869999366
gc 0
Train Epoch7 Acc 0.93725 (37490/40000), AUC 0.9789124131202698
ep7_train_time 209.28557323999985
Test Epoch7 layer4 Acc 0.8846, AUC 0.9471162557601929, avg_entr 0.06373948603868484, f1 0.8845999836921692
ep7_l4_test_time 6.891564631999927
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.942375 (37695/40000), AUC 0.9824126958847046
ep8_train_time 203.63134117899995
Test Epoch8 layer4 Acc 0.8818, AUC 0.9455218315124512, avg_entr 0.04061831533908844, f1 0.8818000555038452
ep8_l4_test_time 6.939707324999972
gc 0
Train Epoch9 Acc 0.94685 (37874/40000), AUC 0.9842348694801331
ep9_train_time 207.92611841999974
Test Epoch9 layer4 Acc 0.881, AUC 0.9471666812896729, avg_entr 0.03982354328036308, f1 0.8809999823570251
ep9_l4_test_time 6.7968928099999175
gc 0
Train Epoch10 Acc 0.952375 (38095/40000), AUC 0.9875070452690125
ep10_train_time 202.57719444500026
Test Epoch10 layer4 Acc 0.8834, AUC 0.9468372464179993, avg_entr 0.03698103502392769, f1 0.8834000825881958
ep10_l4_test_time 7.107118077999985
gc 0
Train Epoch11 Acc 0.9566 (38264/40000), AUC 0.9893856048583984
ep11_train_time 204.62468045299966
Test Epoch11 layer4 Acc 0.8816, AUC 0.9446128606796265, avg_entr 0.03973761945962906, f1 0.881600022315979
ep11_l4_test_time 6.746403821000058
gc 0
Train Epoch12 Acc 0.9566 (38264/40000), AUC 0.9892122745513916
ep12_train_time 209.23222068999985
Test Epoch12 layer4 Acc 0.8798, AUC 0.9432264566421509, avg_entr 0.03797045722603798, f1 0.879800021648407
ep12_l4_test_time 6.760853843999939
gc 0
Train Epoch13 Acc 0.961625 (38465/40000), AUC 0.9912979602813721
ep13_train_time 202.64788486600037
Test Epoch13 layer4 Acc 0.8764, AUC 0.9395078420639038, avg_entr 0.026245485991239548, f1 0.8763999938964844
ep13_l4_test_time 6.967597737999768
gc 0
Train Epoch14 Acc 0.954125 (38165/40000), AUC 0.988706111907959
ep14_train_time 208.65131558300027
Test Epoch14 layer4 Acc 0.8698, AUC 0.9390426874160767, avg_entr 0.027594445273280144, f1 0.8697999715805054
ep14_l4_test_time 6.72074937699972
gc 0
Train Epoch15 Acc 0.966275 (38651/40000), AUC 0.9935853481292725
ep15_train_time 205.56210523899972
Test Epoch15 layer4 Acc 0.8712, AUC 0.9393166303634644, avg_entr 0.029261745512485504, f1 0.8712000846862793
ep15_l4_test_time 7.136349001999861
gc 0
Train Epoch16 Acc 0.967675 (38707/40000), AUC 0.9939894080162048
ep16_train_time 205.6129501659998
Test Epoch16 layer4 Acc 0.8714, AUC 0.9372291564941406, avg_entr 0.026209454983472824, f1 0.871399998664856
ep16_l4_test_time 6.730767867000395
gc 0
Train Epoch17 Acc 0.970725 (38829/40000), AUC 0.994903564453125
ep17_train_time 208.38014287500027
Test Epoch17 layer4 Acc 0.8708, AUC 0.9356196522712708, avg_entr 0.022438928484916687, f1 0.8708000183105469
ep17_l4_test_time 6.894994275000045
gc 0
Train Epoch18 Acc 0.972025 (38881/40000), AUC 0.9951213598251343
ep18_train_time 202.58179479
Test Epoch18 layer4 Acc 0.8664, AUC 0.9344919323921204, avg_entr 0.02621014043688774, f1 0.8664000034332275
ep18_l4_test_time 6.991046906000065
gc 0
Train Epoch19 Acc 0.9735 (38940/40000), AUC 0.9957635998725891
ep19_train_time 206.34640377799997
Test Epoch19 layer4 Acc 0.8668, AUC 0.9342337846755981, avg_entr 0.023789498955011368, f1 0.8668000102043152
ep19_l4_test_time 6.823158201000297
Best AUC tensor(0.8846) 7
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 4249.176241762
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt
gc 10
Test layer0 Acc 0.888, AUC 0.9558693170547485, avg_entr 0.18302033841609955, f1 0.8880000114440918
l0_test_time 0.7758655440002258
gc 0
Test layer1 Acc 0.8822, AUC 0.9456527233123779, avg_entr 0.08370480686426163, f1 0.8822000026702881
l1_test_time 1.995489376000478
gc 0
Test layer2 Acc 0.882, AUC 0.9447330236434937, avg_entr 0.0676722303032875, f1 0.8820000290870667
l2_test_time 3.6028289410005527
gc 0
Test layer3 Acc 0.883, AUC 0.9449372887611389, avg_entr 0.07028328627347946, f1 0.8830000162124634
l3_test_time 5.124017117999756
gc 0
Test layer4 Acc 0.882, AUC 0.9446728825569153, avg_entr 0.06859228014945984, f1 0.8820000290870667
l4_test_time 6.6893063059997075
gc 0
Test threshold 0.1 Acc 0.884, AUC 0.9416497945785522, avg_entr 0.10148013383150101, f1 0.8840000033378601
t0.1_test_time 5.069191583000247
gc 0
Test threshold 0.2 Acc 0.8846, AUC 0.940392792224884, avg_entr 0.11310993880033493, f1 0.8845999836921692
t0.2_test_time 4.651291070999832
gc 0
Test threshold 0.3 Acc 0.8848, AUC 0.9401416778564453, avg_entr 0.12647439539432526, f1 0.8848000168800354
t0.3_test_time 4.362823698999819
gc 0
Test threshold 0.4 Acc 0.8848, AUC 0.9388474225997925, avg_entr 0.14113011956214905, f1 0.8848000168800354
t0.4_test_time 4.192185709000114
gc 0
Test threshold 0.5 Acc 0.886, AUC 0.9401497840881348, avg_entr 0.1556806117296219, f1 0.8859999775886536
t0.5_test_time 4.1962090939996415
gc 0
Test threshold 0.6 Acc 0.8876, AUC 0.9418544769287109, avg_entr 0.17342516779899597, f1 0.8876000046730042
t0.6_test_time 3.9181807659997503
gc 0
Test threshold 0.7 Acc 0.8882, AUC 0.9420273303985596, avg_entr 0.188772052526474, f1 0.888200044631958
t0.7_test_time 3.8001966490000996
gc 0
Test threshold 0.8 Acc 0.89, AUC 0.9441730976104736, avg_entr 0.2071540355682373, f1 0.8899999856948853
t0.8_test_time 3.8849541629997475
gc 0
Test threshold 0.9 Acc 0.8908, AUC 0.9491616487503052, avg_entr 0.22919943928718567, f1 0.8907999992370605
t0.9_test_time 3.8711064120006995
