total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 28.374618088000002
Start Training
gc 0
Train Epoch0 Acc 0.504475 (20179/40000), AUC 0.5038118362426758
ep0_train_time 211.716299848
Test Epoch0 layer4 Acc 0.4994, AUC 0.5276780128479004, avg_entr 0.6749382615089417, f1 0.49939998984336853
ep0_l4_test_time 6.921327732999998
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.602125 (24085/40000), AUC 0.657001256942749
ep1_train_time 215.433137269
Test Epoch1 layer4 Acc 0.5852, AUC 0.7635441422462463, avg_entr 0.5267115831375122, f1 0.5852000117301941
ep1_l4_test_time 7.43040483599998
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.800225 (32009/40000), AUC 0.8706517219543457
ep2_train_time 211.95102662499994
Test Epoch2 layer4 Acc 0.8454, AUC 0.913261890411377, avg_entr 0.11155838519334793, f1 0.8453999757766724
ep2_l4_test_time 6.9395698509999875
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.86685 (34674/40000), AUC 0.9178193807601929
ep3_train_time 217.39205203199992
Test Epoch3 layer4 Acc 0.8652, AUC 0.9324682950973511, avg_entr 0.0953960195183754, f1 0.8652000427246094
ep3_l4_test_time 7.040968343000031
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.801525 (32061/40000), AUC 0.8903052806854248
ep4_train_time 211.78231237800003
Test Epoch4 layer4 Acc 0.6526, AUC 0.7813463807106018, avg_entr 0.6179642677307129, f1 0.6525999903678894
ep4_l4_test_time 7.331770411999969
gc 0
Train Epoch5 Acc 0.74065 (29626/40000), AUC 0.8160287737846375
ep5_train_time 211.75297362200013
Test Epoch5 layer4 Acc 0.8408, AUC 0.9040218591690063, avg_entr 0.08396921306848526, f1 0.8408000469207764
ep5_l4_test_time 7.04566954500001
gc 0
Train Epoch6 Acc 0.89335 (35734/40000), AUC 0.9498993158340454
ep6_train_time 214.96821799999998
Test Epoch6 layer4 Acc 0.874, AUC 0.9432492256164551, avg_entr 0.054585229605436325, f1 0.8740000128746033
ep6_l4_test_time 7.384013943999889
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.928175 (37127/40000), AUC 0.9739460945129395
ep7_train_time 211.94982483800004
Test Epoch7 layer4 Acc 0.8856, AUC 0.9501060247421265, avg_entr 0.0432954840362072, f1 0.8855999708175659
ep7_l4_test_time 6.9022493370000575
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.939675 (37587/40000), AUC 0.9808357954025269
ep8_train_time 217.1989160930002
Test Epoch8 layer4 Acc 0.8854, AUC 0.9495794773101807, avg_entr 0.040747273713350296, f1 0.8853999972343445
ep8_l4_test_time 7.123021511999923
gc 0
Train Epoch9 Acc 0.946075 (37843/40000), AUC 0.9844064712524414
ep9_train_time 211.84333343999992
Test Epoch9 layer4 Acc 0.8862, AUC 0.9488139152526855, avg_entr 0.03760743886232376, f1 0.8862000107765198
ep9_l4_test_time 7.353982003000056
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9508 (38032/40000), AUC 0.9861890077590942
ep10_train_time 211.81421511899998
Test Epoch10 layer4 Acc 0.8826, AUC 0.9457158446311951, avg_entr 0.0371650829911232, f1 0.8826000094413757
ep10_l4_test_time 7.099042931999975
gc 0
Train Epoch11 Acc 0.9548 (38192/40000), AUC 0.9881651401519775
ep11_train_time 213.86295274400027
Test Epoch11 layer4 Acc 0.8832, AUC 0.9451867341995239, avg_entr 0.03377901017665863, f1 0.8831999897956848
ep11_l4_test_time 7.4076888249996955
gc 0
Train Epoch12 Acc 0.956875 (38275/40000), AUC 0.9893556833267212
ep12_train_time 212.77449958599982
Test Epoch12 layer4 Acc 0.881, AUC 0.9436650276184082, avg_entr 0.03309512883424759, f1 0.8809999823570251
ep12_l4_test_time 7.0389773279998735
gc 0
Train Epoch13 Acc 0.9606 (38424/40000), AUC 0.9908331036567688
ep13_train_time 217.06855353399988
Test Epoch13 layer4 Acc 0.8738, AUC 0.9405567646026611, avg_entr 0.02952667884528637, f1 0.8737999796867371
ep13_l4_test_time 7.069489252000039
gc 0
Train Epoch14 Acc 0.961275 (38451/40000), AUC 0.9914445877075195
ep14_train_time 211.40976728299984
Test Epoch14 layer4 Acc 0.8756, AUC 0.9398478269577026, avg_entr 0.030151907354593277, f1 0.8756000399589539
ep14_l4_test_time 7.345935027999985
gc 0
Train Epoch15 Acc 0.965625 (38625/40000), AUC 0.9928076863288879
ep15_train_time 207.66542167199987
Test Epoch15 layer4 Acc 0.8716, AUC 0.9385757446289062, avg_entr 0.028348077088594437, f1 0.8715999722480774
ep15_l4_test_time 6.971022663999975
gc 0
Train Epoch16 Acc 0.9675 (38700/40000), AUC 0.9934528470039368
ep16_train_time 210.30218353200007
Test Epoch16 layer4 Acc 0.8724, AUC 0.937505841255188, avg_entr 0.025995025411248207, f1 0.8723999857902527
ep16_l4_test_time 7.272778605999974
gc 0
Train Epoch17 Acc 0.96895 (38758/40000), AUC 0.9942429065704346
ep17_train_time 208.98719843100025
Test Epoch17 layer4 Acc 0.8718, AUC 0.9363400936126709, avg_entr 0.02561166137456894, f1 0.8718000650405884
ep17_l4_test_time 6.774017136000111
gc 0
Train Epoch18 Acc 0.970675 (38827/40000), AUC 0.9947959780693054
ep18_train_time 212.8885478520001
Test Epoch18 layer4 Acc 0.8628, AUC 0.9335329532623291, avg_entr 0.026353511959314346, f1 0.8628000020980835
ep18_l4_test_time 6.92673877299967
gc 0
Train Epoch19 Acc 0.970725 (38829/40000), AUC 0.9947785139083862
ep19_train_time 194.4675315960003
Test Epoch19 layer4 Acc 0.8654, AUC 0.9325788021087646, avg_entr 0.026155078783631325, f1 0.865399956703186
ep19_l4_test_time 7.178235485999721
Best AUC tensor(0.8862) 9
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 4381.355427951999
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt
gc 10
Test layer0 Acc 0.8856, AUC 0.9537273645401001, avg_entr 0.1684158444404602, f1 0.8855999708175659
l0_test_time 0.8361795660002826
gc 0
Test layer1 Acc 0.8814, AUC 0.9414008855819702, avg_entr 0.057367272675037384, f1 0.8813999891281128
l1_test_time 2.144389105999835
gc 0
Test layer2 Acc 0.8794, AUC 0.9404317140579224, avg_entr 0.044558342546224594, f1 0.8794000148773193
l2_test_time 3.8403604400000404
gc 0
Test layer3 Acc 0.8798, AUC 0.9409419298171997, avg_entr 0.046785060316324234, f1 0.879800021648407
l3_test_time 5.542343554000581
gc 0
Test layer4 Acc 0.8788, AUC 0.9414807558059692, avg_entr 0.040913086384534836, f1 0.8787999749183655
l4_test_time 7.190831201999572
gc 0
Test threshold 0.1 Acc 0.8798, AUC 0.9314739108085632, avg_entr 0.06937744468450546, f1 0.879800021648407
t0.1_test_time 5.249646424000275
gc 0
Test threshold 0.2 Acc 0.8802, AUC 0.9294620156288147, avg_entr 0.08304662257432938, f1 0.8802000284194946
t0.2_test_time 5.049830949000352
gc 0
Test threshold 0.3 Acc 0.882, AUC 0.9288552403450012, avg_entr 0.0953291580080986, f1 0.8820000290870667
t0.3_test_time 4.863562550000097
gc 0
Test threshold 0.4 Acc 0.8826, AUC 0.9315005540847778, avg_entr 0.11032691597938538, f1 0.8826000094413757
t0.4_test_time 4.681984896999893
gc 0
Test threshold 0.5 Acc 0.8838, AUC 0.9332082271575928, avg_entr 0.12694697082042694, f1 0.8838000297546387
t0.5_test_time 4.740871054999843
gc 0
Test threshold 0.6 Acc 0.8862, AUC 0.9343994855880737, avg_entr 0.14078012108802795, f1 0.8862000107765198
t0.6_test_time 4.746736735999548
gc 0
Test threshold 0.7 Acc 0.8866, AUC 0.9355485439300537, avg_entr 0.1562175452709198, f1 0.8866000771522522
t0.7_test_time 4.388525478000702
gc 0
Test threshold 0.8 Acc 0.8892, AUC 0.9404894113540649, avg_entr 0.17566151916980743, f1 0.88919997215271
t0.8_test_time 4.242386029000045
gc 0
Test threshold 0.9 Acc 0.8922, AUC 0.9446755647659302, avg_entr 0.1941109597682953, f1 0.8921999931335449
t0.9_test_time 3.548610563000693
