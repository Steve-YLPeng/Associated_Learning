total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 57.25943088531494
Start Training
gc 0
Train Epoch0 Acc 0.9030660714285714 (505717/560000), AUC 0.99054354429245
ep0_train_time 215.36610341072083
Test Epoch0 layer0 Acc 0.9722285714285714, AUC 0.9982962012290955, avg_entr 0.0858927071094513, f1 0.9722285866737366
ep0_l0_test_time 0.8805756568908691
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9815142857142857, AUC 0.9987334609031677, avg_entr 0.02108616568148136, f1 0.9815142750740051
ep0_l1_test_time 1.4736461639404297
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9814, AUC 0.9986010789871216, avg_entr 0.01857379451394081, f1 0.9814000129699707
ep0_l2_test_time 2.148770570755005
Test Epoch0 layer3 Acc 0.981, AUC 0.9979040026664734, avg_entr 0.020312529057264328, f1 0.9810000061988831
ep0_l3_test_time 2.82342267036438
Test Epoch0 layer4 Acc 0.9810571428571428, AUC 0.9979071617126465, avg_entr 0.02605583332479, f1 0.9810571670532227
ep0_l4_test_time 3.534679889678955
gc 0
Train Epoch1 Acc 0.9849125 (551551/560000), AUC 0.9978728890419006
ep1_train_time 221.19961380958557
Test Epoch1 layer0 Acc 0.974, AUC 0.9984412789344788, avg_entr 0.046813204884529114, f1 0.9739999771118164
ep1_l0_test_time 1.0327107906341553
Test Epoch1 layer1 Acc 0.9829714285714286, AUC 0.998851478099823, avg_entr 0.006154859904199839, f1 0.9829714298248291
ep1_l1_test_time 1.6728544235229492
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9832, AUC 0.9986610412597656, avg_entr 0.004611581563949585, f1 0.9832000136375427
ep1_l2_test_time 2.517418622970581
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9831428571428571, AUC 0.9982379078865051, avg_entr 0.004427372012287378, f1 0.9831428527832031
ep1_l3_test_time 3.2427995204925537
Test Epoch1 layer4 Acc 0.983, AUC 0.9981362223625183, avg_entr 0.004833962768316269, f1 0.9829999804496765
ep1_l4_test_time 3.7225162982940674
gc 0
Train Epoch2 Acc 0.9870571428571429 (552752/560000), AUC 0.9983637928962708
ep2_train_time 214.26924991607666
Test Epoch2 layer0 Acc 0.9740285714285715, AUC 0.9984933137893677, avg_entr 0.03344683349132538, f1 0.9740285873413086
ep2_l0_test_time 0.8986685276031494
Test Epoch2 layer1 Acc 0.9848, AUC 0.9989061951637268, avg_entr 0.003797545563429594, f1 0.9847999811172485
ep2_l1_test_time 1.4819114208221436
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.9847714285714285, AUC 0.998830258846283, avg_entr 0.0027010131161659956, f1 0.9847714304924011
ep2_l2_test_time 2.16557240486145
Test Epoch2 layer3 Acc 0.9847142857142858, AUC 0.998439610004425, avg_entr 0.0024309500586241484, f1 0.9847142696380615
ep2_l3_test_time 2.8272783756256104
Test Epoch2 layer4 Acc 0.9847428571428571, AUC 0.9983349442481995, avg_entr 0.0024240121711045504, f1 0.9847428798675537
ep2_l4_test_time 3.5410261154174805
gc 0
Train Epoch3 Acc 0.9885035714285715 (553562/560000), AUC 0.9986223578453064
ep3_train_time 222.85551619529724
Test Epoch3 layer0 Acc 0.9745714285714285, AUC 0.9985218644142151, avg_entr 0.027185149490833282, f1 0.9745714068412781
ep3_l0_test_time 0.9340708255767822
Test Epoch3 layer1 Acc 0.9851428571428571, AUC 0.9989591836929321, avg_entr 0.0026915641501545906, f1 0.9851428866386414
ep3_l1_test_time 1.4863293170928955
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.9851142857142857, AUC 0.9989093542098999, avg_entr 0.002117506228387356, f1 0.9851142764091492
ep3_l2_test_time 2.1948764324188232
Test Epoch3 layer3 Acc 0.9849142857142857, AUC 0.9986261129379272, avg_entr 0.0018966951174661517, f1 0.9849143028259277
ep3_l3_test_time 2.908846378326416
Test Epoch3 layer4 Acc 0.9848, AUC 0.9981946349143982, avg_entr 0.0017821009969338775, f1 0.9847999811172485
ep3_l4_test_time 3.5747227668762207
gc 0
Train Epoch4 Acc 0.9895678571428571 (554158/560000), AUC 0.9987802505493164
ep4_train_time 223.1661412715912
Test Epoch4 layer0 Acc 0.9745428571428572, AUC 0.9985536932945251, avg_entr 0.02547304332256317, f1 0.9745428562164307
ep4_l0_test_time 0.8675901889801025
Test Epoch4 layer1 Acc 0.9856, AUC 0.9990398287773132, avg_entr 0.0022666421718895435, f1 0.9855999946594238
ep4_l1_test_time 1.4622561931610107
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.9856285714285714, AUC 0.9989110231399536, avg_entr 0.0018022885778918862, f1 0.9856285452842712
ep4_l2_test_time 2.1514601707458496
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
Test Epoch4 layer3 Acc 0.9857714285714285, AUC 0.9986568093299866, avg_entr 0.0015985964564606547, f1 0.9857714176177979
ep4_l3_test_time 2.8109357357025146
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
Test Epoch4 layer4 Acc 0.9855428571428572, AUC 0.9983381628990173, avg_entr 0.0015991708496585488, f1 0.9855428338050842
ep4_l4_test_time 3.511315107345581
gc 0
Train Epoch5 Acc 0.9904321428571429 (554642/560000), AUC 0.9989932179450989
ep5_train_time 213.95646786689758
Test Epoch5 layer0 Acc 0.9747142857142858, AUC 0.9984898567199707, avg_entr 0.02479887753725052, f1 0.9747142791748047
ep5_l0_test_time 0.8975539207458496
Test Epoch5 layer1 Acc 0.9856571428571429, AUC 0.9988208413124084, avg_entr 0.0019600759260356426, f1 0.9856571555137634
ep5_l1_test_time 1.4238011837005615
Test Epoch5 layer2 Acc 0.9858, AUC 0.9987078309059143, avg_entr 0.0014449168229475617, f1 0.98580002784729
ep5_l2_test_time 2.138758659362793
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
Test Epoch5 layer3 Acc 0.9855714285714285, AUC 0.9985518455505371, avg_entr 0.0013725562021136284, f1 0.9855714440345764
ep5_l3_test_time 2.8206093311309814
Test Epoch5 layer4 Acc 0.9854857142857143, AUC 0.9981288313865662, avg_entr 0.0012826926540583372, f1 0.9854857325553894
ep5_l4_test_time 3.4724977016448975
gc 0
Train Epoch6 Acc 0.9912964285714285 (555126/560000), AUC 0.9991516470909119
ep6_train_time 214.18633580207825
Test Epoch6 layer0 Acc 0.9746857142857143, AUC 0.9984952211380005, avg_entr 0.023917697370052338, f1 0.9746857285499573
ep6_l0_test_time 0.8661892414093018
Test Epoch6 layer1 Acc 0.9860285714285715, AUC 0.9989398121833801, avg_entr 0.0022218963131308556, f1 0.9860285520553589
ep6_l1_test_time 1.4708662033081055
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
Test Epoch6 layer2 Acc 0.9862571428571428, AUC 0.9989375472068787, avg_entr 0.0018215362215414643, f1 0.9862571358680725
ep6_l2_test_time 2.1118736267089844
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
Test Epoch6 layer3 Acc 0.9861428571428571, AUC 0.998712956905365, avg_entr 0.00158326153177768, f1 0.9861428737640381
ep6_l3_test_time 2.80069899559021
Test Epoch6 layer4 Acc 0.9861714285714286, AUC 0.9982226490974426, avg_entr 0.0015345714055001736, f1 0.9861714243888855
ep6_l4_test_time 3.498690366744995
gc 0
Train Epoch7 Acc 0.9918767857142857 (555451/560000), AUC 0.9991931319236755
ep7_train_time 214.53140330314636
Test Epoch7 layer0 Acc 0.9750571428571428, AUC 0.9985523819923401, avg_entr 0.023921944200992584, f1 0.9750571250915527
ep7_l0_test_time 0.8524389266967773
Test Epoch7 layer1 Acc 0.9853142857142857, AUC 0.9987837076187134, avg_entr 0.0019697267562150955, f1 0.9853143095970154
ep7_l1_test_time 1.4208452701568604
Test Epoch7 layer2 Acc 0.9854571428571428, AUC 0.9987087249755859, avg_entr 0.001576887210831046, f1 0.9854571223258972
ep7_l2_test_time 2.109992265701294
Test Epoch7 layer3 Acc 0.9854, AUC 0.9986051321029663, avg_entr 0.0014763791114091873, f1 0.9854000210762024
ep7_l3_test_time 2.8185486793518066
Test Epoch7 layer4 Acc 0.9853428571428572, AUC 0.9979977607727051, avg_entr 0.0012921645538881421, f1 0.9853428602218628
ep7_l4_test_time 3.455723285675049
gc 0
Train Epoch8 Acc 0.9926535714285715 (555886/560000), AUC 0.9991912245750427
ep8_train_time 214.6536865234375
Test Epoch8 layer0 Acc 0.9746571428571429, AUC 0.9985357522964478, avg_entr 0.024444231763482094, f1 0.9746571183204651
ep8_l0_test_time 0.8617455959320068
Test Epoch8 layer1 Acc 0.9858857142857143, AUC 0.9988627433776855, avg_entr 0.0017410580767318606, f1 0.985885739326477
ep8_l1_test_time 1.4263968467712402
Test Epoch8 layer2 Acc 0.9858571428571429, AUC 0.9986711144447327, avg_entr 0.0015022305306047201, f1 0.9858571290969849
ep8_l2_test_time 2.1017065048217773
Test Epoch8 layer3 Acc 0.9857714285714285, AUC 0.998589813709259, avg_entr 0.0013402020558714867, f1 0.9857714176177979
ep8_l3_test_time 2.8434653282165527
Test Epoch8 layer4 Acc 0.9857714285714285, AUC 0.9980674982070923, avg_entr 0.0012864754535257816, f1 0.9857714176177979
ep8_l4_test_time 3.4962408542633057
gc 0
Train Epoch9 Acc 0.9933357142857143 (556268/560000), AUC 0.9992147088050842
ep9_train_time 214.22083187103271
Test Epoch9 layer0 Acc 0.9748, AUC 0.9985384345054626, avg_entr 0.02370840683579445, f1 0.9747999906539917
ep9_l0_test_time 0.8729293346405029
Test Epoch9 layer1 Acc 0.9858857142857143, AUC 0.9987917542457581, avg_entr 0.0017016271594911814, f1 0.985885739326477
ep9_l1_test_time 1.4525415897369385
Test Epoch9 layer2 Acc 0.9859714285714286, AUC 0.9985492825508118, avg_entr 0.0013216821243986487, f1 0.9859714508056641
ep9_l2_test_time 2.1154158115386963
Test Epoch9 layer3 Acc 0.9860285714285715, AUC 0.9984272122383118, avg_entr 0.0011893941555172205, f1 0.9860285520553589
ep9_l3_test_time 2.856653928756714
Test Epoch9 layer4 Acc 0.9859714285714286, AUC 0.9978532791137695, avg_entr 0.0010844316566362977, f1 0.9859714508056641
ep9_l4_test_time 3.449589490890503
gc 0
