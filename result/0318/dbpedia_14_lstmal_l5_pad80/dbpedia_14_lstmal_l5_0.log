total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 57.678629636764526
Start Training
gc 0
Train Epoch0 Acc 0.9044267857142857 (506479/560000), AUC 0.9901469349861145
ep0_train_time 410.4578251838684
Test Epoch0 layer0 Acc 0.9725142857142857, AUC 0.9982476830482483, avg_entr 0.08489909768104553, f1 0.972514271736145
ep0_l0_test_time 2.1145594120025635
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9814571428571428, AUC 0.9985210299491882, avg_entr 0.021060407161712646, f1 0.9814571142196655
ep0_l1_test_time 3.1947011947631836
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9814285714285714, AUC 0.9983739852905273, avg_entr 0.01825464516878128, f1 0.9814285635948181
ep0_l2_test_time 4.495569467544556
Test Epoch0 layer3 Acc 0.9813428571428572, AUC 0.9976075887680054, avg_entr 0.02616839110851288, f1 0.9813428521156311
ep0_l3_test_time 5.81296968460083
Test Epoch0 layer4 Acc 0.9814571428571428, AUC 0.997724175453186, avg_entr 0.01986929029226303, f1 0.9814571142196655
ep0_l4_test_time 7.00738787651062
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9848303571428572 (551505/560000), AUC 0.9975872039794922
ep1_train_time 408.6246054172516
Test Epoch1 layer0 Acc 0.9740857142857143, AUC 0.9983784556388855, avg_entr 0.04604072868824005, f1 0.9740856885910034
ep1_l0_test_time 2.1147279739379883
Test Epoch1 layer1 Acc 0.9834285714285714, AUC 0.9987044930458069, avg_entr 0.00621229549869895, f1 0.9834285974502563
ep1_l1_test_time 3.2143890857696533
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9836857142857143, AUC 0.9984177947044373, avg_entr 0.004923131316900253, f1 0.9836857318878174
ep1_l2_test_time 4.588648319244385
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9834857142857143, AUC 0.9977589845657349, avg_entr 0.005498592741787434, f1 0.9834856986999512
ep1_l3_test_time 5.896453619003296
Test Epoch1 layer4 Acc 0.9833142857142857, AUC 0.9977670311927795, avg_entr 0.0045624240301549435, f1 0.9833142757415771
ep1_l4_test_time 6.954040288925171
gc 0
Train Epoch2 Acc 0.9869607142857143 (552698/560000), AUC 0.9979859590530396
ep2_train_time 408.32388639450073
Test Epoch2 layer0 Acc 0.9746857142857143, AUC 0.9984477758407593, avg_entr 0.0334496945142746, f1 0.9746857285499573
ep2_l0_test_time 1.8083586692810059
Test Epoch2 layer1 Acc 0.9843428571428572, AUC 0.9987087845802307, avg_entr 0.0038348285015672445, f1 0.9843428730964661
ep2_l1_test_time 2.939760446548462
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.9845142857142857, AUC 0.998489260673523, avg_entr 0.0028681072872132063, f1 0.9845142960548401
ep2_l2_test_time 2.3274905681610107
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.9843714285714286, AUC 0.9977717399597168, avg_entr 0.002802429487928748, f1 0.9843714237213135
ep2_l3_test_time 2.8696632385253906
Test Epoch2 layer4 Acc 0.9844571428571428, AUC 0.9977561831474304, avg_entr 0.002444436540827155, f1 0.9844571352005005
ep2_l4_test_time 3.5689139366149902
gc 0
Train Epoch3 Acc 0.9883303571428571 (553465/560000), AUC 0.998288631439209
ep3_train_time 388.5508027076721
Test Epoch3 layer0 Acc 0.9745142857142857, AUC 0.9984416365623474, avg_entr 0.027005290612578392, f1 0.9745143055915833
ep3_l0_test_time 2.038731575012207
Test Epoch3 layer1 Acc 0.9848857142857143, AUC 0.9986893534660339, avg_entr 0.0026199929416179657, f1 0.9848856925964355
ep3_l1_test_time 2.816563367843628
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.9845428571428572, AUC 0.9985297322273254, avg_entr 0.002133849775418639, f1 0.9845428466796875
ep3_l2_test_time 4.4444005489349365
Test Epoch3 layer3 Acc 0.9845142857142857, AUC 0.9979711174964905, avg_entr 0.0019174774643033743, f1 0.9845142960548401
ep3_l3_test_time 5.577035665512085
Test Epoch3 layer4 Acc 0.9845714285714285, AUC 0.9980357885360718, avg_entr 0.0017664895858615637, f1 0.9845714569091797
ep3_l4_test_time 6.771125078201294
gc 0
Train Epoch4 Acc 0.9894732142857143 (554105/560000), AUC 0.9984636902809143
ep4_train_time 403.08689188957214
Test Epoch4 layer0 Acc 0.975, AUC 0.9984755516052246, avg_entr 0.025589117780327797, f1 0.9750000238418579
ep4_l0_test_time 2.0841829776763916
Test Epoch4 layer1 Acc 0.9852, AUC 0.9986772537231445, avg_entr 0.002559334971010685, f1 0.9851999878883362
ep4_l1_test_time 2.8429224491119385
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.9851428571428571, AUC 0.9985125660896301, avg_entr 0.0019380883313715458, f1 0.9851428866386414
ep4_l2_test_time 4.395354986190796
Test Epoch4 layer3 Acc 0.9850857142857142, AUC 0.9980922341346741, avg_entr 0.001867908169515431, f1 0.9850857257843018
ep4_l3_test_time 5.6741132736206055
Test Epoch4 layer4 Acc 0.9850857142857142, AUC 0.9981768727302551, avg_entr 0.00175500160548836, f1 0.9850857257843018
ep4_l4_test_time 6.831018924713135
gc 0
Train Epoch5 Acc 0.9903339285714285 (554587/560000), AUC 0.9987525939941406
ep5_train_time 403.2459843158722
Test Epoch5 layer0 Acc 0.9744857142857143, AUC 0.9984427690505981, avg_entr 0.024771377444267273, f1 0.9744856953620911
ep5_l0_test_time 2.0626306533813477
Test Epoch5 layer1 Acc 0.9854285714285714, AUC 0.998583972454071, avg_entr 0.002178730210289359, f1 0.9854285717010498
ep5_l1_test_time 3.081336736679077
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
Test Epoch5 layer2 Acc 0.9854571428571428, AUC 0.9984426498413086, avg_entr 0.0017733598360791802, f1 0.9854571223258972
ep5_l2_test_time 4.437278747558594
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
Test Epoch5 layer3 Acc 0.9854571428571428, AUC 0.9980676770210266, avg_entr 0.0016126257833093405, f1 0.9854571223258972
ep5_l3_test_time 5.664326429367065
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
Test Epoch5 layer4 Acc 0.9854285714285714, AUC 0.9980916380882263, avg_entr 0.0015248714480549097, f1 0.9854285717010498
ep5_l4_test_time 6.8089985847473145
gc 0
Train Epoch6 Acc 0.9915857142857143 (555288/560000), AUC 0.9989866614341736
ep6_train_time 403.11840319633484
Test Epoch6 layer0 Acc 0.9745428571428572, AUC 0.9984698295593262, avg_entr 0.024439888074994087, f1 0.9745428562164307
ep6_l0_test_time 2.0581419467926025
Test Epoch6 layer1 Acc 0.9854857142857143, AUC 0.9985033273696899, avg_entr 0.0021235905587673187, f1 0.9854857325553894
ep6_l1_test_time 3.0650224685668945
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
Test Epoch6 layer2 Acc 0.9854857142857143, AUC 0.9984397888183594, avg_entr 0.001849489868618548, f1 0.9854857325553894
ep6_l2_test_time 4.433130741119385
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
Test Epoch6 layer3 Acc 0.9853142857142857, AUC 0.998170018196106, avg_entr 0.0015806677984073758, f1 0.9853143095970154
ep6_l3_test_time 5.717678785324097
Test Epoch6 layer4 Acc 0.9854285714285714, AUC 0.9981828331947327, avg_entr 0.0014363437658175826, f1 0.9854285717010498
ep6_l4_test_time 6.7427685260772705
gc 0
Train Epoch7 Acc 0.9921214285714286 (555588/560000), AUC 0.9990265965461731
ep7_train_time 386.75270819664
Test Epoch7 layer0 Acc 0.9746571428571429, AUC 0.9984863996505737, avg_entr 0.024335844442248344, f1 0.9746571183204651
ep7_l0_test_time 2.0356621742248535
Test Epoch7 layer1 Acc 0.9853428571428572, AUC 0.9984716176986694, avg_entr 0.002016742480918765, f1 0.9853428602218628
ep7_l1_test_time 3.099074602127075
Test Epoch7 layer2 Acc 0.9853714285714286, AUC 0.9982672333717346, avg_entr 0.0016299700364470482, f1 0.9853714108467102
ep7_l2_test_time 4.452078104019165
Test Epoch7 layer3 Acc 0.9854571428571428, AUC 0.9978570342063904, avg_entr 0.0015596740413457155, f1 0.9854571223258972
ep7_l3_test_time 5.640961408615112
Test Epoch7 layer4 Acc 0.9856285714285714, AUC 0.9978731870651245, avg_entr 0.0014219556469470263, f1 0.9856285452842712
ep7_l4_test_time 6.733890056610107
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9925392857142857 (555822/560000), AUC 0.9990549683570862
ep8_train_time 403.2533767223358
Test Epoch8 layer0 Acc 0.9748857142857142, AUC 0.9984623789787292, avg_entr 0.023879261687397957, f1 0.9748857021331787
ep8_l0_test_time 2.057372808456421
Test Epoch8 layer1 Acc 0.9853428571428572, AUC 0.9983447790145874, avg_entr 0.001966125098988414, f1 0.9853428602218628
ep8_l1_test_time 2.7860093116760254
Test Epoch8 layer2 Acc 0.9853428571428572, AUC 0.9983692169189453, avg_entr 0.0015394727233797312, f1 0.9853428602218628
ep8_l2_test_time 4.382519006729126
Test Epoch8 layer3 Acc 0.9854285714285714, AUC 0.9980932474136353, avg_entr 0.001353411702439189, f1 0.9854285717010498
ep8_l3_test_time 5.618587493896484
Test Epoch8 layer4 Acc 0.9854, AUC 0.997879683971405, avg_entr 0.001275860471650958, f1 0.9854000210762024
ep8_l4_test_time 6.658758163452148
gc 0
Train Epoch9 Acc 0.9930428571428571 (556104/560000), AUC 0.9990361332893372
ep9_train_time 402.79761362075806
Test Epoch9 layer0 Acc 0.9747142857142858, AUC 0.9984491467475891, avg_entr 0.023862507194280624, f1 0.9747142791748047
ep9_l0_test_time 2.0540568828582764
Test Epoch9 layer1 Acc 0.9857142857142858, AUC 0.9983702301979065, avg_entr 0.0018317984649911523, f1 0.9857142567634583
ep9_l1_test_time 3.119542121887207
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 9
Test Epoch9 layer2 Acc 0.9857142857142858, AUC 0.9982531666755676, avg_entr 0.0015135373687371612, f1 0.9857142567634583
ep9_l2_test_time 4.400352954864502
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 9
Test Epoch9 layer3 Acc 0.9857428571428571, AUC 0.9981067776679993, avg_entr 0.00134625646751374, f1 0.9857428669929504
ep9_l3_test_time 5.541485786437988
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 9
Test Epoch9 layer4 Acc 0.9857714285714285, AUC 0.9980334639549255, avg_entr 0.0012330649187788367, f1 0.9857714176177979
ep9_l4_test_time 6.787307024002075
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9935267857142858 (556375/560000), AUC 0.9991016387939453
ep10_train_time 403.44280433654785
Test Epoch10 layer0 Acc 0.9746571428571429, AUC 0.9984623789787292, avg_entr 0.023605825379490852, f1 0.9746571183204651
ep10_l0_test_time 2.0552196502685547
Test Epoch10 layer1 Acc 0.9853714285714286, AUC 0.9982965588569641, avg_entr 0.0018731437157839537, f1 0.9853714108467102
ep10_l1_test_time 3.138422727584839
Test Epoch10 layer2 Acc 0.9853142857142857, AUC 0.9981185793876648, avg_entr 0.0013379940064623952, f1 0.9853143095970154
ep10_l2_test_time 4.372812271118164
Test Epoch10 layer3 Acc 0.9854571428571428, AUC 0.9978768229484558, avg_entr 0.0011485784780234098, f1 0.9854571223258972
ep10_l3_test_time 5.629628658294678
Test Epoch10 layer4 Acc 0.9854, AUC 0.9977008700370789, avg_entr 0.0010848561068996787, f1 0.9854000210762024
ep10_l4_test_time 6.7631261348724365
gc 0
Train Epoch11 Acc 0.9938071428571429 (556532/560000), AUC 0.9991002678871155
ep11_train_time 402.9915976524353
Test Epoch11 layer0 Acc 0.9746857142857143, AUC 0.9984570741653442, avg_entr 0.02397385612130165, f1 0.9746857285499573
ep11_l0_test_time 2.0612804889678955
Test Epoch11 layer1 Acc 0.9852285714285715, AUC 0.9982500076293945, avg_entr 0.0018606946105137467, f1 0.9852285981178284
ep11_l1_test_time 3.044039726257324
Test Epoch11 layer2 Acc 0.9851428571428571, AUC 0.9981698393821716, avg_entr 0.0013679593103006482, f1 0.9851428866386414
ep11_l2_test_time 4.446790456771851
Test Epoch11 layer3 Acc 0.9853428571428572, AUC 0.9979315400123596, avg_entr 0.0012309072772040963, f1 0.9853428602218628
ep11_l3_test_time 5.705686807632446
Test Epoch11 layer4 Acc 0.9852857142857143, AUC 0.9977285265922546, avg_entr 0.001165327848866582, f1 0.9852856993675232
ep11_l4_test_time 6.818000078201294
gc 0
Train Epoch12 Acc 0.9941803571428571 (556741/560000), AUC 0.9991376996040344
ep12_train_time 386.34231066703796
Test Epoch12 layer0 Acc 0.9746857142857143, AUC 0.9984678030014038, avg_entr 0.02366381511092186, f1 0.9746857285499573
ep12_l0_test_time 2.053981065750122
Test Epoch12 layer1 Acc 0.9852571428571428, AUC 0.9981949925422668, avg_entr 0.0017349959816783667, f1 0.9852571487426758
ep12_l1_test_time 3.078200578689575
Test Epoch12 layer2 Acc 0.9853142857142857, AUC 0.9979817271232605, avg_entr 0.001359438174404204, f1 0.9853143095970154
ep12_l2_test_time 4.402775049209595
Test Epoch12 layer3 Acc 0.9853428571428572, AUC 0.9977370500564575, avg_entr 0.0011468969751149416, f1 0.9853428602218628
ep12_l3_test_time 5.67866063117981
Test Epoch12 layer4 Acc 0.9853714285714286, AUC 0.9975577592849731, avg_entr 0.0010531237348914146, f1 0.9853714108467102
ep12_l4_test_time 6.785889625549316
gc 0
Train Epoch13 Acc 0.9943875 (556857/560000), AUC 0.9991112947463989
ep13_train_time 402.20266461372375
Test Epoch13 layer0 Acc 0.9747714285714286, AUC 0.9984681010246277, avg_entr 0.023645395413041115, f1 0.9747714400291443
ep13_l0_test_time 2.047746419906616
Test Epoch13 layer1 Acc 0.9852, AUC 0.9981326460838318, avg_entr 0.0017094125505536795, f1 0.9851999878883362
ep13_l1_test_time 2.81005859375
Test Epoch13 layer2 Acc 0.9853142857142857, AUC 0.9979416728019714, avg_entr 0.001222278573550284, f1 0.9853143095970154
ep13_l2_test_time 4.406444549560547
Test Epoch13 layer3 Acc 0.9852857142857143, AUC 0.9977823495864868, avg_entr 0.0011313928989693522, f1 0.9852856993675232
ep13_l3_test_time 5.593929052352905
Test Epoch13 layer4 Acc 0.9853428571428572, AUC 0.9975653290748596, avg_entr 0.0010103507665917277, f1 0.9853428602218628
ep13_l4_test_time 6.726804494857788
gc 0
Train Epoch14 Acc 0.9946 (556976/560000), AUC 0.999118983745575
ep14_train_time 401.89222717285156
Test Epoch14 layer0 Acc 0.9747428571428571, AUC 0.9984664916992188, avg_entr 0.023593492805957794, f1 0.9747428297996521
ep14_l0_test_time 2.065011978149414
Test Epoch14 layer1 Acc 0.9850857142857142, AUC 0.9979772567749023, avg_entr 0.0018241001525893807, f1 0.9850857257843018
ep14_l1_test_time 3.1510958671569824
Test Epoch14 layer2 Acc 0.9851714285714286, AUC 0.9976358413696289, avg_entr 0.0012465360341593623, f1 0.9851714372634888
ep14_l2_test_time 4.450758457183838
Test Epoch14 layer3 Acc 0.9853142857142857, AUC 0.9974717497825623, avg_entr 0.0011330352863296866, f1 0.9853143095970154
ep14_l3_test_time 5.668156147003174
Test Epoch14 layer4 Acc 0.9853428571428572, AUC 0.9973774552345276, avg_entr 0.0010347409406676888, f1 0.9853428602218628
ep14_l4_test_time 6.788262367248535
gc 0
Train Epoch15 Acc 0.9947946428571428 (557085/560000), AUC 0.9991193413734436
ep15_train_time 401.8431034088135
Test Epoch15 layer0 Acc 0.9747714285714286, AUC 0.9984624981880188, avg_entr 0.02346501499414444, f1 0.9747714400291443
ep15_l0_test_time 2.096069812774658
Test Epoch15 layer1 Acc 0.9851428571428571, AUC 0.9980522394180298, avg_entr 0.001721372944302857, f1 0.9851428866386414
ep15_l1_test_time 2.828125238418579
Test Epoch15 layer2 Acc 0.9854857142857143, AUC 0.9977673292160034, avg_entr 0.001272388268262148, f1 0.9854857325553894
ep15_l2_test_time 4.353028297424316
Test Epoch15 layer3 Acc 0.9854571428571428, AUC 0.9975482225418091, avg_entr 0.0011166882468387485, f1 0.9854571223258972
ep15_l3_test_time 5.67536735534668
Test Epoch15 layer4 Acc 0.9853428571428572, AUC 0.9973701238632202, avg_entr 0.0010263457661494613, f1 0.9853428602218628
ep15_l4_test_time 6.659181594848633
gc 0
Train Epoch16 Acc 0.9949446428571429 (557169/560000), AUC 0.9991231560707092
ep16_train_time 386.0293200016022
Test Epoch16 layer0 Acc 0.9747428571428571, AUC 0.9984615445137024, avg_entr 0.023520346730947495, f1 0.9747428297996521
ep16_l0_test_time 2.039156913757324
Test Epoch16 layer1 Acc 0.9851142857142857, AUC 0.9978854060173035, avg_entr 0.0016225629951804876, f1 0.9851142764091492
ep16_l1_test_time 3.1210439205169678
Test Epoch16 layer2 Acc 0.9851142857142857, AUC 0.9976444244384766, avg_entr 0.0011172029189765453, f1 0.9851142764091492
ep16_l2_test_time 4.437055349349976
Test Epoch16 layer3 Acc 0.9852857142857143, AUC 0.9974364042282104, avg_entr 0.0009937644936144352, f1 0.9852856993675232
ep16_l3_test_time 5.53366756439209
Test Epoch16 layer4 Acc 0.9852857142857143, AUC 0.9973154067993164, avg_entr 0.000936711672693491, f1 0.9852856993675232
ep16_l4_test_time 6.743200778961182
gc 0
Train Epoch17 Acc 0.9950892857142857 (557250/560000), AUC 0.9991139769554138
ep17_train_time 401.82893538475037
Test Epoch17 layer0 Acc 0.9748571428571429, AUC 0.9984703660011292, avg_entr 0.023495633155107498, f1 0.9748571515083313
ep17_l0_test_time 2.05153751373291
Test Epoch17 layer1 Acc 0.9848571428571429, AUC 0.9978445768356323, avg_entr 0.0016422601183876395, f1 0.9848571419715881
ep17_l1_test_time 3.0841312408447266
Test Epoch17 layer2 Acc 0.9850571428571429, AUC 0.9975503087043762, avg_entr 0.0011564946034923196, f1 0.9850571155548096
ep17_l2_test_time 4.406512260437012
Test Epoch17 layer3 Acc 0.9852, AUC 0.9973506927490234, avg_entr 0.0009718664805404842, f1 0.9851999878883362
ep17_l3_test_time 5.577059268951416
Test Epoch17 layer4 Acc 0.9852857142857143, AUC 0.997163712978363, avg_entr 0.0009225975954905152, f1 0.9852856993675232
ep17_l4_test_time 6.783984899520874
gc 0
Train Epoch18 Acc 0.9951910714285714 (557307/560000), AUC 0.9991198778152466
ep18_train_time 401.7984437942505
Test Epoch18 layer0 Acc 0.9749142857142857, AUC 0.998457133769989, avg_entr 0.02343594841659069, f1 0.9749143123626709
ep18_l0_test_time 2.0802009105682373
Test Epoch18 layer1 Acc 0.9848571428571429, AUC 0.997825562953949, avg_entr 0.0016901372000575066, f1 0.9848571419715881
ep18_l1_test_time 2.7941665649414062
Test Epoch18 layer2 Acc 0.985, AUC 0.997407853603363, avg_entr 0.001159602776169777, f1 0.9850000143051147
ep18_l2_test_time 4.408315420150757
Test Epoch18 layer3 Acc 0.9851142857142857, AUC 0.9972580075263977, avg_entr 0.0009970589308068156, f1 0.9851142764091492
ep18_l3_test_time 5.537899494171143
Test Epoch18 layer4 Acc 0.9851714285714286, AUC 0.997177004814148, avg_entr 0.0009000880527310073, f1 0.9851714372634888
ep18_l4_test_time 6.740049600601196
gc 0
Train Epoch19 Acc 0.9952428571428571 (557336/560000), AUC 0.9991218447685242
ep19_train_time 401.86995577812195
Test Epoch19 layer0 Acc 0.9749142857142857, AUC 0.9984530806541443, avg_entr 0.023358743637800217, f1 0.9749143123626709
ep19_l0_test_time 2.053880214691162
Test Epoch19 layer1 Acc 0.9847714285714285, AUC 0.997803270816803, avg_entr 0.0016568462597206235, f1 0.9847714304924011
ep19_l1_test_time 3.066082239151001
Test Epoch19 layer2 Acc 0.985, AUC 0.9973995089530945, avg_entr 0.0012014068197458982, f1 0.9850000143051147
ep19_l2_test_time 4.351155996322632
Test Epoch19 layer3 Acc 0.9850285714285715, AUC 0.9972326159477234, avg_entr 0.0010742531158030033, f1 0.9850285649299622
ep19_l3_test_time 5.658759117126465
Test Epoch19 layer4 Acc 0.9851142857142857, AUC 0.9970942735671997, avg_entr 0.0010174562921747565, f1 0.9851142764091492
ep19_l4_test_time 6.781630277633667
gc 0
Train Epoch20 Acc 0.9953464285714285 (557394/560000), AUC 0.9991289377212524
ep20_train_time 401.9534776210785
Test Epoch20 layer0 Acc 0.9747714285714286, AUC 0.9984574913978577, avg_entr 0.02347419783473015, f1 0.9747714400291443
ep20_l0_test_time 2.0467541217803955
Test Epoch20 layer1 Acc 0.9845714285714285, AUC 0.9977527856826782, avg_entr 0.0016056830063462257, f1 0.9845714569091797
ep20_l1_test_time 2.7653889656066895
Test Epoch20 layer2 Acc 0.9844857142857143, AUC 0.9973254203796387, avg_entr 0.0011417042696848512, f1 0.9844856858253479
ep20_l2_test_time 4.4275383949279785
Test Epoch20 layer3 Acc 0.9846, AUC 0.9971864819526672, avg_entr 0.0009901957819238305, f1 0.9846000075340271
ep20_l3_test_time 5.638282299041748
Test Epoch20 layer4 Acc 0.9845428571428572, AUC 0.997029721736908, avg_entr 0.0009111274848692119, f1 0.9845428466796875
ep20_l4_test_time 6.764621019363403
gc 0
Train Epoch21 Acc 0.9953946428571429 (557421/560000), AUC 0.9991276860237122
ep21_train_time 385.7123417854309
Test Epoch21 layer0 Acc 0.9749142857142857, AUC 0.9984657168388367, avg_entr 0.023401761427521706, f1 0.9749143123626709
ep21_l0_test_time 1.9795811176300049
Test Epoch21 layer1 Acc 0.9846285714285714, AUC 0.997792661190033, avg_entr 0.0016462886705994606, f1 0.9846285581588745
ep21_l1_test_time 3.0938353538513184
Test Epoch21 layer2 Acc 0.9847142857142858, AUC 0.9973953366279602, avg_entr 0.0011765104718506336, f1 0.9847142696380615
ep21_l2_test_time 4.450636148452759
Test Epoch21 layer3 Acc 0.9847714285714285, AUC 0.9972286820411682, avg_entr 0.0010358227882534266, f1 0.9847714304924011
ep21_l3_test_time 5.696654558181763
Test Epoch21 layer4 Acc 0.9848, AUC 0.997100830078125, avg_entr 0.0009649833664298058, f1 0.9847999811172485
ep21_l4_test_time 6.80043625831604
gc 0
Train Epoch22 Acc 0.9954892857142857 (557474/560000), AUC 0.9991282224655151
ep22_train_time 402.2673547267914
Test Epoch22 layer0 Acc 0.9748571428571429, AUC 0.998458743095398, avg_entr 0.02345293201506138, f1 0.9748571515083313
ep22_l0_test_time 2.04003643989563
Test Epoch22 layer1 Acc 0.9847142857142858, AUC 0.9977555871009827, avg_entr 0.001681475667282939, f1 0.9847142696380615
ep22_l1_test_time 3.0530128479003906
Test Epoch22 layer2 Acc 0.9845714285714285, AUC 0.9972836375236511, avg_entr 0.0012344670249149203, f1 0.9845714569091797
ep22_l2_test_time 4.388388395309448
Test Epoch22 layer3 Acc 0.9847714285714285, AUC 0.9971485137939453, avg_entr 0.0010628554737195373, f1 0.9847714304924011
ep22_l3_test_time 5.679187297821045
Test Epoch22 layer4 Acc 0.9848857142857143, AUC 0.9970782399177551, avg_entr 0.0009927806677296758, f1 0.9848856925964355
ep22_l4_test_time 6.764486789703369
gc 0
Train Epoch23 Acc 0.995525 (557494/560000), AUC 0.9991310238838196
ep23_train_time 402.1800615787506
Test Epoch23 layer0 Acc 0.9749428571428571, AUC 0.9984588623046875, avg_entr 0.023451639339327812, f1 0.9749428629875183
ep23_l0_test_time 2.053266763687134
Test Epoch23 layer1 Acc 0.9846285714285714, AUC 0.997739851474762, avg_entr 0.001584737910889089, f1 0.9846285581588745
ep23_l1_test_time 3.0168821811676025
Test Epoch23 layer2 Acc 0.9848857142857143, AUC 0.9973345994949341, avg_entr 0.0012081671738997102, f1 0.9848856925964355
ep23_l2_test_time 4.435349702835083
Test Epoch23 layer3 Acc 0.9848571428571429, AUC 0.9972043037414551, avg_entr 0.0010813837870955467, f1 0.9848571419715881
ep23_l3_test_time 5.629371166229248
Test Epoch23 layer4 Acc 0.9848571428571429, AUC 0.997031033039093, avg_entr 0.0010079628555104136, f1 0.9848571419715881
ep23_l4_test_time 6.778543949127197
gc 0
Train Epoch24 Acc 0.995575 (557522/560000), AUC 0.9991321563720703
ep24_train_time 402.1408030986786
Test Epoch24 layer0 Acc 0.9748285714285714, AUC 0.9984568953514099, avg_entr 0.023371119052171707, f1 0.9748286008834839
ep24_l0_test_time 2.043825149536133
Test Epoch24 layer1 Acc 0.9846, AUC 0.9977280497550964, avg_entr 0.0015322072431445122, f1 0.9846000075340271
ep24_l1_test_time 2.7809855937957764
Test Epoch24 layer2 Acc 0.9849142857142857, AUC 0.9973157644271851, avg_entr 0.001202716724947095, f1 0.9849143028259277
ep24_l2_test_time 4.458978652954102
Test Epoch24 layer3 Acc 0.9850285714285715, AUC 0.9971662163734436, avg_entr 0.001072100130841136, f1 0.9850285649299622
ep24_l3_test_time 5.658992767333984
Test Epoch24 layer4 Acc 0.9851428571428571, AUC 0.99703449010849, avg_entr 0.0010119833750650287, f1 0.9851428866386414
ep24_l4_test_time 6.726278066635132
gc 0
Train Epoch25 Acc 0.9956125 (557543/560000), AUC 0.99913090467453
ep25_train_time 397.3083324432373
Test Epoch25 layer0 Acc 0.9748, AUC 0.998461127281189, avg_entr 0.02339646965265274, f1 0.9747999906539917
ep25_l0_test_time 0.8554389476776123
Test Epoch25 layer1 Acc 0.9844857142857143, AUC 0.9977118372917175, avg_entr 0.0015593476127833128, f1 0.9844856858253479
ep25_l1_test_time 1.4322538375854492
Test Epoch25 layer2 Acc 0.9846857142857143, AUC 0.9972819089889526, avg_entr 0.0012717595091089606, f1 0.9846857190132141
ep25_l2_test_time 2.135265588760376
Test Epoch25 layer3 Acc 0.9846285714285714, AUC 0.9971258044242859, avg_entr 0.00115330854896456, f1 0.9846285581588745
ep25_l3_test_time 2.8456900119781494
Test Epoch25 layer4 Acc 0.9848, AUC 0.9970330595970154, avg_entr 0.0010763137834146619, f1 0.9847999811172485
ep25_l4_test_time 3.4975810050964355
gc 0
Train Epoch26 Acc 0.9956392857142857 (557558/560000), AUC 0.9991341829299927
ep26_train_time 360.4814941883087
Test Epoch26 layer0 Acc 0.9748, AUC 0.9984574317932129, avg_entr 0.023395441472530365, f1 0.9747999906539917
ep26_l0_test_time 1.5211527347564697
Test Epoch26 layer1 Acc 0.9844857142857143, AUC 0.9976983070373535, avg_entr 0.0015397085808217525, f1 0.9844856858253479
ep26_l1_test_time 2.59820294380188
Test Epoch26 layer2 Acc 0.9846571428571429, AUC 0.9972389936447144, avg_entr 0.0012157474411651492, f1 0.9846571683883667
ep26_l2_test_time 4.098100185394287
Test Epoch26 layer3 Acc 0.9847428571428571, AUC 0.9971081018447876, avg_entr 0.0010919782798737288, f1 0.9847428798675537
ep26_l3_test_time 5.06308388710022
Test Epoch26 layer4 Acc 0.9848571428571429, AUC 0.9969792366027832, avg_entr 0.0010628370800986886, f1 0.9848571419715881
ep26_l4_test_time 6.836084365844727
gc 0
Train Epoch27 Acc 0.9956678571428571 (557574/560000), AUC 0.9991337656974792
ep27_train_time 352.93273997306824
Test Epoch27 layer0 Acc 0.9748, AUC 0.9984599351882935, avg_entr 0.023440781980752945, f1 0.9747999906539917
ep27_l0_test_time 1.5226683616638184
Test Epoch27 layer1 Acc 0.9845714285714285, AUC 0.9977086186408997, avg_entr 0.0015319783706218004, f1 0.9845714569091797
ep27_l1_test_time 2.5237746238708496
Test Epoch27 layer2 Acc 0.9847714285714285, AUC 0.9972530603408813, avg_entr 0.0012258325004950166, f1 0.9847714304924011
ep27_l2_test_time 4.047115087509155
Test Epoch27 layer3 Acc 0.9848, AUC 0.9971694946289062, avg_entr 0.0010891692945733666, f1 0.9847999811172485
ep27_l3_test_time 4.9353392124176025
Test Epoch27 layer4 Acc 0.9848571428571429, AUC 0.9970035552978516, avg_entr 0.0010377406142652035, f1 0.9848571419715881
ep27_l4_test_time 6.291769742965698
gc 0
Train Epoch28 Acc 0.9956785714285714 (557580/560000), AUC 0.9991366267204285
ep28_train_time 353.2009844779968
Test Epoch28 layer0 Acc 0.9747714285714286, AUC 0.9984597563743591, avg_entr 0.02341706119477749, f1 0.9747714400291443
ep28_l0_test_time 1.5396826267242432
Test Epoch28 layer1 Acc 0.9844857142857143, AUC 0.9977080225944519, avg_entr 0.001554489484988153, f1 0.9844856858253479
ep28_l1_test_time 2.583554983139038
Test Epoch28 layer2 Acc 0.9847142857142858, AUC 0.9972385168075562, avg_entr 0.0012218874180689454, f1 0.9847142696380615
ep28_l2_test_time 4.0637829303741455
Test Epoch28 layer3 Acc 0.9847714285714285, AUC 0.9970923066139221, avg_entr 0.001077772118151188, f1 0.9847714304924011
ep28_l3_test_time 5.005771160125732
Test Epoch28 layer4 Acc 0.9848, AUC 0.9969838261604309, avg_entr 0.0010285653406754136, f1 0.9847999811172485
ep28_l4_test_time 6.648578405380249
gc 0
Train Epoch29 Acc 0.9956928571428572 (557588/560000), AUC 0.9991404414176941
ep29_train_time 353.40456676483154
Test Epoch29 layer0 Acc 0.9747714285714286, AUC 0.9984564185142517, avg_entr 0.023347893729805946, f1 0.9747714400291443
ep29_l0_test_time 1.5123319625854492
Test Epoch29 layer1 Acc 0.9846571428571429, AUC 0.9976884126663208, avg_entr 0.001506211468949914, f1 0.9846571683883667
ep29_l1_test_time 2.526268720626831
Test Epoch29 layer2 Acc 0.9847714285714285, AUC 0.9972271919250488, avg_entr 0.0012133150594308972, f1 0.9847714304924011
ep29_l2_test_time 4.077402114868164
Test Epoch29 layer3 Acc 0.9848285714285714, AUC 0.9970795512199402, avg_entr 0.0010993373580276966, f1 0.9848285913467407
ep29_l3_test_time 5.0402655601501465
Test Epoch29 layer4 Acc 0.9848571428571429, AUC 0.9969618916511536, avg_entr 0.001073908992111683, f1 0.9848571419715881
ep29_l4_test_time 6.5654096603393555
Best AUC tensor(0.9858) 9 4
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 12452.907623052597
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt
Test layer0 Acc 0.9746857142857143, AUC 0.998238742351532, avg_entr 0.023634647950530052, f1 0.9746857285499573
l0_test_time 1.5455076694488525
Test layer1 Acc 0.9857428571428571, AUC 0.9982805252075195, avg_entr 0.0018808129243552685, f1 0.9857428669929504
l1_test_time 2.5051229000091553
Test layer2 Acc 0.9858285714285714, AUC 0.9981463551521301, avg_entr 0.0015871472423896194, f1 0.9858285784721375
l2_test_time 4.048848867416382
Test layer3 Acc 0.9857142857142858, AUC 0.9979808926582336, avg_entr 0.0015079686418175697, f1 0.9857142567634583
l3_test_time 4.982906818389893
Test layer4 Acc 0.9856571428571429, AUC 0.9981078505516052, avg_entr 0.0014074061764404178, f1 0.9856571555137634
l4_test_time 6.809848785400391
