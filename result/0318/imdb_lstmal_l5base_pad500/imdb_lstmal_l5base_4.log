total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.091141992
Start Training
gc 0
Train Epoch0 Acc 0.509925 (20397/40000), AUC 0.5231386423110962
ep0_train_time 78.59387339400001
Test Epoch0 layer4 Acc 0.6056, AUC 0.7123871445655823, avg_entr 0.6815385222434998, f1 0.6055999994277954
ep0_l4_test_time 2.889552721000001
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.81185 (32474/40000), AUC 0.8736655116081238
ep1_train_time 79.17283807000001
Test Epoch1 layer4 Acc 0.8588, AUC 0.9318418502807617, avg_entr 0.09029374271631241, f1 0.8587999939918518
ep1_l4_test_time 2.847065122999993
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.897475 (35899/40000), AUC 0.9459748268127441
ep2_train_time 79.06903694400003
Test Epoch2 layer4 Acc 0.8572, AUC 0.9382656812667847, avg_entr 0.08368223160505295, f1 0.857200026512146
ep2_l4_test_time 2.863936191999983
gc 0
Train Epoch3 Acc 0.901875 (36075/40000), AUC 0.9561396837234497
ep3_train_time 79.08808904400001
Test Epoch3 layer4 Acc 0.8652, AUC 0.9457708597183228, avg_entr 0.07178819924592972, f1 0.8652000427246094
ep3_l4_test_time 2.8725927229999684
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.933525 (37341/40000), AUC 0.9755958318710327
ep4_train_time 79.06677933899999
Test Epoch4 layer4 Acc 0.8858, AUC 0.9502618312835693, avg_entr 0.047862760722637177, f1 0.8858000040054321
ep4_l4_test_time 2.860400829000014
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9428 (37712/40000), AUC 0.9816675186157227
ep5_train_time 79.03112802000004
Test Epoch5 layer4 Acc 0.8844, AUC 0.949331521987915, avg_entr 0.04021154344081879, f1 0.8844000101089478
ep5_l4_test_time 2.9494786399999384
gc 0
Train Epoch6 Acc 0.95065 (38026/40000), AUC 0.9868708848953247
ep6_train_time 111.13839111300001
Test Epoch6 layer4 Acc 0.889, AUC 0.9484968185424805, avg_entr 0.02936524897813797, f1 0.8889999985694885
ep6_l4_test_time 5.334239642000057
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9553 (38212/40000), AUC 0.9881588220596313
ep7_train_time 130.59095449999995
Test Epoch7 layer4 Acc 0.8842, AUC 0.946857213973999, avg_entr 0.031873919069767, f1 0.8842000365257263
ep7_l4_test_time 2.9758780240000533
gc 0
Train Epoch8 Acc 0.95975 (38390/40000), AUC 0.990310788154602
ep8_train_time 114.79086046100008
Test Epoch8 layer4 Acc 0.8806, AUC 0.9428220987319946, avg_entr 0.02106856368482113, f1 0.8805999755859375
ep8_l4_test_time 4.0394868060000135
gc 0
Train Epoch9 Acc 0.962125 (38485/40000), AUC 0.9913604855537415
ep9_train_time 132.68020281500003
Test Epoch9 layer4 Acc 0.8758, AUC 0.9431001543998718, avg_entr 0.029435638338327408, f1 0.8758000135421753
ep9_l4_test_time 5.445788672000049
gc 0
Train Epoch10 Acc 0.965675 (38627/40000), AUC 0.9929981827735901
ep10_train_time 91.01949475699996
Test Epoch10 layer4 Acc 0.8716, AUC 0.9341111183166504, avg_entr 0.02091124653816223, f1 0.8715999722480774
ep10_l4_test_time 2.8871500380000725
gc 0
Train Epoch11 Acc 0.969525 (38781/40000), AUC 0.9937736988067627
ep11_train_time 78.99758801199982
Test Epoch11 layer4 Acc 0.874, AUC 0.9406530857086182, avg_entr 0.024539800360798836, f1 0.8740000128746033
ep11_l4_test_time 2.844110283999953
gc 0
Train Epoch12 Acc 0.971775 (38871/40000), AUC 0.9948267936706543
ep12_train_time 79.05876069700003
Test Epoch12 layer4 Acc 0.8694, AUC 0.9378675222396851, avg_entr 0.028845690190792084, f1 0.8694000244140625
ep12_l4_test_time 2.8631797470000038
gc 0
Train Epoch13 Acc 0.97415 (38966/40000), AUC 0.9956257939338684
ep13_train_time 79.05491227399989
Test Epoch13 layer4 Acc 0.8704, AUC 0.9350695610046387, avg_entr 0.018683159723877907, f1 0.8704000115394592
ep13_l4_test_time 2.875414193000097
gc 0
Train Epoch14 Acc 0.976575 (39063/40000), AUC 0.9961757063865662
ep14_train_time 107.72221584199997
Test Epoch14 layer4 Acc 0.8652, AUC 0.9322978258132935, avg_entr 0.018175380304455757, f1 0.8652000427246094
ep14_l4_test_time 2.9290713180000694
gc 0
Train Epoch15 Acc 0.9775 (39100/40000), AUC 0.996495246887207
ep15_train_time 113.83012890400005
Test Epoch15 layer4 Acc 0.865, AUC 0.9325522780418396, avg_entr 0.017993800342082977, f1 0.8650000095367432
ep15_l4_test_time 5.4948193979998905
gc 0
Train Epoch16 Acc 0.97925 (39170/40000), AUC 0.9968228340148926
ep16_train_time 130.71380832000023
Test Epoch16 layer4 Acc 0.8614, AUC 0.9298746585845947, avg_entr 0.01578928530216217, f1 0.8614000082015991
ep16_l4_test_time 5.246983571999863
gc 0
Train Epoch17 Acc 0.98045 (39218/40000), AUC 0.9972867965698242
ep17_train_time 85.72281162400009
Test Epoch17 layer4 Acc 0.8608, AUC 0.928848385810852, avg_entr 0.014777833595871925, f1 0.86080002784729
ep17_l4_test_time 2.866750183999784
gc 0
Train Epoch18 Acc 0.98135 (39254/40000), AUC 0.9977191686630249
ep18_train_time 78.93038894300003
Test Epoch18 layer4 Acc 0.8578, AUC 0.9280006885528564, avg_entr 0.015564206056296825, f1 0.8578000068664551
ep18_l4_test_time 2.875863648999939
gc 0
Train Epoch19 Acc 0.98265 (39306/40000), AUC 0.9979681968688965
ep19_train_time 79.00977172599983
Test Epoch19 layer4 Acc 0.8588, AUC 0.9268434047698975, avg_entr 0.013114686124026775, f1 0.8587999939918518
ep19_l4_test_time 2.8482985099999496
gc 0
Train Epoch20 Acc 0.983675 (39347/40000), AUC 0.9980458617210388
ep20_train_time 78.94805401200028
Test Epoch20 layer4 Acc 0.8562, AUC 0.9264678359031677, avg_entr 0.013054164126515388, f1 0.8561999797821045
ep20_l4_test_time 2.8861274229998344
gc 0
Train Epoch21 Acc 0.9852 (39408/40000), AUC 0.9984619617462158
ep21_train_time 78.97124561999999
Test Epoch21 layer4 Acc 0.8492, AUC 0.9199971556663513, avg_entr 0.011327365413308144, f1 0.8492000102996826
ep21_l4_test_time 2.8451914600000237
gc 0
Train Epoch22 Acc 0.985625 (39425/40000), AUC 0.9984307885169983
ep22_train_time 78.95257402700008
Test Epoch22 layer4 Acc 0.8536, AUC 0.9237111806869507, avg_entr 0.012850048951804638, f1 0.853600025177002
ep22_l4_test_time 2.8618347560000075
gc 0
Train Epoch23 Acc 0.986425 (39457/40000), AUC 0.9985560178756714
ep23_train_time 78.98227586899975
Test Epoch23 layer4 Acc 0.8454, AUC 0.9213290214538574, avg_entr 0.015538373030722141, f1 0.8453999757766724
ep23_l4_test_time 2.876700960999642
gc 0
Train Epoch24 Acc 0.987925 (39517/40000), AUC 0.998839259147644
ep24_train_time 78.93060222999975
Test Epoch24 layer4 Acc 0.851, AUC 0.9206898212432861, avg_entr 0.012943444773554802, f1 0.8510000109672546
ep24_l4_test_time 2.84656773100005
gc 0
Train Epoch25 Acc 0.986925 (39477/40000), AUC 0.9986981153488159
ep25_train_time 78.93380250399969
Test Epoch25 layer4 Acc 0.8472, AUC 0.916183352470398, avg_entr 0.01345828827470541, f1 0.8471999764442444
ep25_l4_test_time 2.888231985999937
gc 0
Train Epoch26 Acc 0.98955 (39582/40000), AUC 0.9990757703781128
ep26_train_time 78.9648936829999
Test Epoch26 layer4 Acc 0.8486, AUC 0.9148227572441101, avg_entr 0.00769601296633482, f1 0.8485999703407288
ep26_l4_test_time 2.8424026349998712
gc 0
Train Epoch27 Acc 0.989175 (39567/40000), AUC 0.9989299774169922
ep27_train_time 78.92653929400012
Test Epoch27 layer4 Acc 0.8416, AUC 0.916245698928833, avg_entr 0.009856697171926498, f1 0.8416000008583069
ep27_l4_test_time 2.860693475000062
gc 0
Train Epoch28 Acc 0.989975 (39599/40000), AUC 0.9991612434387207
ep28_train_time 78.93567466700006
Test Epoch28 layer4 Acc 0.8448, AUC 0.9104597568511963, avg_entr 0.010159730911254883, f1 0.8447999358177185
ep28_l4_test_time 2.8752373970000917
gc 0
Train Epoch29 Acc 0.99055 (39622/40000), AUC 0.9992004632949829
ep29_train_time 79.27282216000003
Test Epoch29 layer4 Acc 0.8396, AUC 0.9105933904647827, avg_entr 0.012420046143233776, f1 0.8396000266075134
ep29_l4_test_time 2.85314244600022
Best AUC tensor(0.8890) 6
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 2776.175732915
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
gc 10
Test layer0 Acc 0.8868, AUC 0.9523652791976929, avg_entr 0.1586109846830368, f1 0.8867999911308289
l0_test_time 0.5614335709997249
gc 0
Test layer1 Acc 0.8778, AUC 0.9413864016532898, avg_entr 0.04379543662071228, f1 0.8778000473976135
l1_test_time 1.053417004000039
gc 0
Test layer2 Acc 0.8762, AUC 0.9413797855377197, avg_entr 0.0358913317322731, f1 0.8762000203132629
l2_test_time 1.6423123520003173
gc 0
Test layer3 Acc 0.8762, AUC 0.9414029717445374, avg_entr 0.0341637097299099, f1 0.8762000203132629
l3_test_time 2.2585312380001596
gc 0
Test layer4 Acc 0.8756, AUC 0.9416689872741699, avg_entr 0.031540583819150925, f1 0.8756000399589539
l4_test_time 2.859987383999851
gc 0
Test threshold 0.1 Acc 0.8768, AUC 0.929175853729248, avg_entr 0.05729392543435097, f1 0.876800000667572
t0.1_test_time 1.7279297249997398
gc 0
Test threshold 0.2 Acc 0.8782, AUC 0.9266008734703064, avg_entr 0.07015872001647949, f1 0.8781999945640564
t0.2_test_time 1.6727978839999196
gc 0
Test threshold 0.3 Acc 0.8788, AUC 0.928598165512085, avg_entr 0.08261334151029587, f1 0.8787999749183655
t0.3_test_time 1.6337024139997993
gc 0
Test threshold 0.4 Acc 0.8798, AUC 0.9311454892158508, avg_entr 0.09626930207014084, f1 0.879800021648407
t0.4_test_time 1.6180063840001822
gc 0
Test threshold 0.5 Acc 0.8808, AUC 0.93107008934021, avg_entr 0.11001721024513245, f1 0.8808000087738037
t0.5_test_time 1.6030520730000717
gc 0
Test threshold 0.6 Acc 0.8824, AUC 0.9333374500274658, avg_entr 0.1244836077094078, f1 0.8823999762535095
t0.6_test_time 1.5807527229999323
gc 0
Test threshold 0.7 Acc 0.883, AUC 0.9353395700454712, avg_entr 0.13825775682926178, f1 0.8830000162124634
t0.7_test_time 1.4634118750000198
gc 0
Test threshold 0.8 Acc 0.885, AUC 0.9375620484352112, avg_entr 0.155906543135643, f1 0.8849999904632568
t0.8_test_time 1.3177838389997305
gc 0
Test threshold 0.9 Acc 0.8866, AUC 0.94041907787323, avg_entr 0.1779222935438156, f1 0.8866000771522522
t0.9_test_time 1.1118596719998095
