total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 23.515276358
Start Training
gc 0
Train Epoch0 Acc 0.497525 (19901/40000), AUC 0.49857160449028015
ep0_train_time 154.039180715
Test Epoch0 layer4 Acc 0.5326, AUC 0.6504993438720703, avg_entr 0.6871930956840515, f1 0.5325999855995178
ep0_l4_test_time 5.472425416999982
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.796175 (31847/40000), AUC 0.8588192462921143
ep1_train_time 149.58956391299998
Test Epoch1 layer4 Acc 0.8606, AUC 0.9207095503807068, avg_entr 0.08807879686355591, f1 0.8605999946594238
ep1_l4_test_time 2.8975579229999653
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.88355 (35342/40000), AUC 0.9309784173965454
ep2_train_time 144.175701248
Test Epoch2 layer4 Acc 0.8718, AUC 0.9379467368125916, avg_entr 0.0885988175868988, f1 0.8718000650405884
ep2_l4_test_time 5.443784860999983
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.898275 (35931/40000), AUC 0.9479713439941406
ep3_train_time 154.08403004400003
Test Epoch3 layer4 Acc 0.86, AUC 0.9431322813034058, avg_entr 0.11612541228532791, f1 0.8600000143051147
ep3_l4_test_time 5.433888002000003
gc 0
Train Epoch4 Acc 0.911125 (36445/40000), AUC 0.9571206569671631
ep4_train_time 153.88490600700004
Test Epoch4 layer4 Acc 0.8664, AUC 0.9319300651550293, avg_entr 0.03198345750570297, f1 0.8664000034332275
ep4_l4_test_time 5.458983303000082
gc 0
Train Epoch5 Acc 0.92385 (36954/40000), AUC 0.9680219888687134
ep5_train_time 154.00453050399994
Test Epoch5 layer4 Acc 0.8816, AUC 0.9434174299240112, avg_entr 0.03663693740963936, f1 0.881600022315979
ep5_l4_test_time 5.497102153000014
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.945825 (37833/40000), AUC 0.9821498990058899
ep6_train_time 154.13717797000015
Test Epoch6 layer4 Acc 0.8812, AUC 0.9428318738937378, avg_entr 0.0377073809504509, f1 0.8812000155448914
ep6_l4_test_time 5.425166405000027
gc 0
Train Epoch7 Acc 0.9503 (38012/40000), AUC 0.9853289723396301
ep7_train_time 153.76767614699997
Test Epoch7 layer4 Acc 0.8814, AUC 0.9433342218399048, avg_entr 0.03283664584159851, f1 0.8813999891281128
ep7_l4_test_time 5.401587391000021
gc 0
Train Epoch8 Acc 0.95565 (38226/40000), AUC 0.9877828359603882
ep8_train_time 153.87669229099993
Test Epoch8 layer4 Acc 0.876, AUC 0.9407463073730469, avg_entr 0.026936247944831848, f1 0.8760000467300415
ep8_l4_test_time 5.492067730999906
gc 0
Train Epoch9 Acc 0.960775 (38431/40000), AUC 0.9909577369689941
ep9_train_time 153.92153853699983
Test Epoch9 layer4 Acc 0.8768, AUC 0.9381402134895325, avg_entr 0.020207958295941353, f1 0.876800000667572
ep9_l4_test_time 5.439344887000061
gc 0
Train Epoch10 Acc 0.96295 (38518/40000), AUC 0.9919883608818054
ep10_train_time 154.0633567169998
Test Epoch10 layer4 Acc 0.8732, AUC 0.9369139671325684, avg_entr 0.026417715474963188, f1 0.873199999332428
ep10_l4_test_time 5.345277054999997
gc 0
Train Epoch11 Acc 0.96705 (38682/40000), AUC 0.9932053685188293
ep11_train_time 136.42634835800004
Test Epoch11 layer4 Acc 0.871, AUC 0.9361613988876343, avg_entr 0.026389773935079575, f1 0.8709999918937683
ep11_l4_test_time 5.395359019000125
gc 0
Train Epoch12 Acc 0.96965 (38786/40000), AUC 0.9941762685775757
ep12_train_time 154.21325378100028
Test Epoch12 layer4 Acc 0.8702, AUC 0.9329948425292969, avg_entr 0.026339147239923477, f1 0.870199978351593
ep12_l4_test_time 5.46242438399986
gc 0
Train Epoch13 Acc 0.9716 (38864/40000), AUC 0.9946276545524597
ep13_train_time 154.3260644679999
Test Epoch13 layer4 Acc 0.868, AUC 0.929834246635437, avg_entr 0.019193654879927635, f1 0.8679999709129333
ep13_l4_test_time 5.432812066999759
gc 0
Train Epoch14 Acc 0.97435 (38974/40000), AUC 0.9956077337265015
ep14_train_time 154.06518072900008
Test Epoch14 layer4 Acc 0.8452, AUC 0.9266858100891113, avg_entr 0.02475949004292488, f1 0.8452000021934509
ep14_l4_test_time 5.358077807999962
gc 0
Train Epoch15 Acc 0.97645 (39058/40000), AUC 0.9958237409591675
ep15_train_time 154.19022569200024
Test Epoch15 layer4 Acc 0.8624, AUC 0.9271677732467651, avg_entr 0.01776653341948986, f1 0.8623999953269958
ep15_l4_test_time 5.4828501850001885
gc 0
Train Epoch16 Acc 0.978125 (39125/40000), AUC 0.9964829683303833
ep16_train_time 154.1697725869999
Test Epoch16 layer4 Acc 0.8574, AUC 0.9193875193595886, avg_entr 0.012202498503029346, f1 0.8574000000953674
ep16_l4_test_time 5.361409001000084
gc 0
Train Epoch17 Acc 0.9786 (39144/40000), AUC 0.9970179200172424
ep17_train_time 153.94221802899983
Test Epoch17 layer4 Acc 0.8574, AUC 0.9247035980224609, avg_entr 0.019327323883771896, f1 0.8574000000953674
ep17_l4_test_time 5.248218598999756
gc 0
Train Epoch18 Acc 0.981 (39240/40000), AUC 0.9974962472915649
ep18_train_time 154.25405655900022
Test Epoch18 layer4 Acc 0.8546, AUC 0.9207500219345093, avg_entr 0.01893826201558113, f1 0.8546000123023987
ep18_l4_test_time 5.503693088000091
gc 0
Train Epoch19 Acc 0.979925 (39197/40000), AUC 0.9971461296081543
ep19_train_time 154.02074058499966
Test Epoch19 layer4 Acc 0.8532, AUC 0.9194971323013306, avg_entr 0.015056469477713108, f1 0.8532000184059143
ep19_l4_test_time 5.43263258099978
gc 0
Train Epoch20 Acc 0.9824 (39296/40000), AUC 0.9976307153701782
ep20_train_time 154.05750586299973
Test Epoch20 layer4 Acc 0.8526, AUC 0.9176197052001953, avg_entr 0.015772297978401184, f1 0.8525999784469604
ep20_l4_test_time 5.433501358000285
gc 0
Train Epoch21 Acc 0.98405 (39362/40000), AUC 0.9980573654174805
ep21_train_time 137.41511266899988
Test Epoch21 layer4 Acc 0.8488, AUC 0.9156424403190613, avg_entr 0.01221294142305851, f1 0.848800003528595
ep21_l4_test_time 5.423143643000003
gc 0
Train Epoch22 Acc 0.9842 (39368/40000), AUC 0.998212456703186
ep22_train_time 154.2019743169999
Test Epoch22 layer4 Acc 0.8494, AUC 0.9134436249732971, avg_entr 0.013997436501085758, f1 0.849399983882904
ep22_l4_test_time 5.472049517999949
gc 0
Train Epoch23 Acc 0.985475 (39419/40000), AUC 0.998293936252594
ep23_train_time 154.17437772799985
Test Epoch23 layer4 Acc 0.8462, AUC 0.9106314182281494, avg_entr 0.012020942755043507, f1 0.8461999893188477
ep23_l4_test_time 5.383822986999803
gc 0
Train Epoch24 Acc 0.986 (39440/40000), AUC 0.9982562065124512
ep24_train_time 153.93698193
Test Epoch24 layer4 Acc 0.8448, AUC 0.9089639186859131, avg_entr 0.009842722676694393, f1 0.8447999358177185
ep24_l4_test_time 5.311349449999852
gc 0
Train Epoch25 Acc 0.987 (39480/40000), AUC 0.9986328482627869
ep25_train_time 153.96663619399988
Test Epoch25 layer4 Acc 0.8382, AUC 0.9114639163017273, avg_entr 0.01690628007054329, f1 0.8381999731063843
ep25_l4_test_time 5.53914178299965
gc 0
Train Epoch26 Acc 0.9877 (39508/40000), AUC 0.9986329674720764
ep26_train_time 153.9237929259998
Test Epoch26 layer4 Acc 0.8428, AUC 0.9093090295791626, avg_entr 0.009906670078635216, f1 0.8428000211715698
ep26_l4_test_time 5.410544582000512
gc 0
Train Epoch27 Acc 0.9878 (39512/40000), AUC 0.9987373352050781
ep27_train_time 153.92858994900052
Test Epoch27 layer4 Acc 0.845, AUC 0.9020170569419861, avg_entr 0.012840930372476578, f1 0.8449999690055847
ep27_l4_test_time 5.303558575999887
gc 0
Train Epoch28 Acc 0.988375 (39535/40000), AUC 0.998813271522522
ep28_train_time 153.8894692269996
Test Epoch28 layer4 Acc 0.84, AUC 0.9023275971412659, avg_entr 0.012139478698372841, f1 0.8399999737739563
ep28_l4_test_time 5.482288531999984
gc 0
Train Epoch29 Acc 0.98865 (39546/40000), AUC 0.9986228942871094
ep29_train_time 154.0874839299995
Test Epoch29 layer4 Acc 0.8404, AUC 0.8993442058563232, avg_entr 0.012085149995982647, f1 0.840399980545044
ep29_l4_test_time 5.410047322999162
Best AUC tensor(0.8816) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 4734.496760055
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
gc 10
Test layer0 Acc 0.8726, AUC 0.9551679491996765, avg_entr 0.173481747508049, f1 0.8726000189781189
l0_test_time 0.7556231319995277
gc 0
Test layer1 Acc 0.8806, AUC 0.9397709369659424, avg_entr 0.061237700283527374, f1 0.8805999755859375
l1_test_time 1.7452158810001492
gc 0
Test layer2 Acc 0.8776, AUC 0.9399659037590027, avg_entr 0.04450594633817673, f1 0.8776000142097473
l2_test_time 2.9953144829996745
gc 0
Test layer3 Acc 0.877, AUC 0.9406799077987671, avg_entr 0.04053400084376335, f1 0.8769999742507935
l3_test_time 4.1039347609994365
gc 0
Test layer4 Acc 0.875, AUC 0.939660906791687, avg_entr 0.041031885892152786, f1 0.875
l4_test_time 5.516835065000123
gc 0
Test threshold 0.1 Acc 0.877, AUC 0.930901288986206, avg_entr 0.06453774869441986, f1 0.8769999742507935
t0.1_test_time 4.647395024000616
gc 0
Test threshold 0.2 Acc 0.8786, AUC 0.9305702447891235, avg_entr 0.07502096891403198, f1 0.878600001335144
t0.2_test_time 4.745141518999844
gc 0
Test threshold 0.3 Acc 0.8798, AUC 0.9306778311729431, avg_entr 0.08750121295452118, f1 0.879800021648407
t0.3_test_time 4.713901833999444
gc 0
Test threshold 0.4 Acc 0.8824, AUC 0.9324067831039429, avg_entr 0.10046964138746262, f1 0.8823999762535095
t0.4_test_time 4.348939819999941
gc 0
Test threshold 0.5 Acc 0.8856, AUC 0.9335323572158813, avg_entr 0.11232414841651917, f1 0.8855999708175659
t0.5_test_time 4.457582968999304
gc 0
Test threshold 0.6 Acc 0.8866, AUC 0.9363501667976379, avg_entr 0.12514719367027283, f1 0.8866000771522522
t0.6_test_time 4.205364690999886
gc 0
Test threshold 0.7 Acc 0.8876, AUC 0.9384734630584717, avg_entr 0.14138752222061157, f1 0.8876000046730042
t0.7_test_time 3.960446633999709
gc 0
Test threshold 0.8 Acc 0.8894, AUC 0.9427028894424438, avg_entr 0.16178661584854126, f1 0.8894000053405762
t0.8_test_time 3.4707506389995615
gc 0
Test threshold 0.9 Acc 0.887, AUC 0.946345329284668, avg_entr 0.1872158944606781, f1 0.8870000243186951
t0.9_test_time 2.650268352999774
