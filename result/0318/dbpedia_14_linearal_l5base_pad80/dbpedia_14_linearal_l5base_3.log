total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.463621616363525
Start Training
gc 0
Train Epoch0 Acc 0.8732946428571429 (489045/560000), AUC 0.9858816266059875
ep0_train_time 105.64788913726807
Test Epoch0 layer4 Acc 0.9737428571428571, AUC 0.9985347390174866, avg_entr 0.06093496084213257, f1 0.9737428426742554
ep0_l4_test_time 2.1550188064575195
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9779642857142857 (547660/560000), AUC 0.9987162351608276
ep1_train_time 103.81879544258118
Test Epoch1 layer4 Acc 0.9753714285714286, AUC 0.9984012246131897, avg_entr 0.021867917850613594, f1 0.9753714799880981
ep1_l4_test_time 2.1489310264587402
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.97985 (548716/560000), AUC 0.9986156821250916
ep2_train_time 103.06338405609131
Test Epoch2 layer4 Acc 0.9762, AUC 0.9979695081710815, avg_entr 0.011518127284944057, f1 0.9761999845504761
ep2_l4_test_time 2.1518259048461914
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9807821428571428 (549238/560000), AUC 0.9985160231590271
ep3_train_time 103.1433002948761
Test Epoch3 layer4 Acc 0.9767142857142858, AUC 0.997729480266571, avg_entr 0.008044878020882607, f1 0.9767143130302429
ep3_l4_test_time 2.201022148132324
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9813178571428571 (549538/560000), AUC 0.9985408186912537
ep4_train_time 103.00401306152344
Test Epoch4 layer4 Acc 0.9773714285714286, AUC 0.9977951049804688, avg_entr 0.006726383697241545, f1 0.9773714542388916
ep4_l4_test_time 2.172711133956909
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9817214285714285 (549764/560000), AUC 0.9986419081687927
ep5_train_time 103.17529201507568
Test Epoch5 layer4 Acc 0.9772, AUC 0.9978181719779968, avg_entr 0.005879675038158894, f1 0.977199912071228
ep5_l4_test_time 2.1546852588653564
gc 0
Train Epoch6 Acc 0.9822053571428572 (550035/560000), AUC 0.9987102150917053
ep6_train_time 104.17315888404846
Test Epoch6 layer4 Acc 0.9775142857142857, AUC 0.9976323843002319, avg_entr 0.005123815964907408, f1 0.9775142669677734
ep6_l4_test_time 1.953413486480713
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9825410714285714 (550223/560000), AUC 0.9987636804580688
ep7_train_time 103.65073752403259
Test Epoch7 layer4 Acc 0.9777428571428571, AUC 0.9977599382400513, avg_entr 0.004794494714587927, f1 0.9777428507804871
ep7_l4_test_time 2.1666557788848877
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9829107142857143 (550430/560000), AUC 0.998798668384552
ep8_train_time 103.29720664024353
Test Epoch8 layer4 Acc 0.9776571428571429, AUC 0.9974713921546936, avg_entr 0.004543734714388847, f1 0.9776571393013
ep8_l4_test_time 2.143749952316284
gc 0
Train Epoch9 Acc 0.9831928571428571 (550588/560000), AUC 0.9987326264381409
ep9_train_time 103.38508343696594
Test Epoch9 layer4 Acc 0.9786571428571429, AUC 0.9975730776786804, avg_entr 0.0042676059529185295, f1 0.9786571264266968
ep9_l4_test_time 2.1958038806915283
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9833089285714286 (550653/560000), AUC 0.9987494349479675
ep10_train_time 103.2570960521698
Test Epoch10 layer4 Acc 0.9785142857142857, AUC 0.9974787831306458, avg_entr 0.004207874182611704, f1 0.9785143136978149
ep10_l4_test_time 2.1543521881103516
gc 0
Train Epoch11 Acc 0.9836803571428572 (550861/560000), AUC 0.998778760433197
ep11_train_time 103.67627739906311
Test Epoch11 layer4 Acc 0.9782, AUC 0.9975840449333191, avg_entr 0.003932141698896885, f1 0.9782000184059143
ep11_l4_test_time 1.951019287109375
gc 0
Train Epoch12 Acc 0.9838517857142857 (550957/560000), AUC 0.9988151788711548
ep12_train_time 104.31958961486816
Test Epoch12 layer4 Acc 0.9785428571428572, AUC 0.9976660013198853, avg_entr 0.003929097205400467, f1 0.9785428643226624
ep12_l4_test_time 2.181804656982422
gc 0
Train Epoch13 Acc 0.9839892857142857 (551034/560000), AUC 0.9987971186637878
ep13_train_time 102.80155086517334
Test Epoch13 layer4 Acc 0.9784571428571428, AUC 0.9975413084030151, avg_entr 0.0038680045399814844, f1 0.9784571528434753
ep13_l4_test_time 2.1517727375030518
gc 0
Train Epoch14 Acc 0.9842928571428572 (551204/560000), AUC 0.9988179206848145
ep14_train_time 103.25200963020325
Test Epoch14 layer4 Acc 0.9789428571428571, AUC 0.9975929856300354, avg_entr 0.0036758340429514647, f1 0.97894287109375
ep14_l4_test_time 2.1997032165527344
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.9843964285714286 (551262/560000), AUC 0.9988164901733398
ep15_train_time 103.17124199867249
Test Epoch15 layer4 Acc 0.9786857142857143, AUC 0.9977437257766724, avg_entr 0.0035966732539236546, f1 0.978685736656189
ep15_l4_test_time 2.161993980407715
gc 0
Train Epoch16 Acc 0.9844482142857143 (551291/560000), AUC 0.9988260269165039
ep16_train_time 103.02474403381348
Test Epoch16 layer4 Acc 0.9784571428571428, AUC 0.9976214170455933, avg_entr 0.0036670234985649586, f1 0.9784571528434753
ep16_l4_test_time 2.215099334716797
gc 0
Train Epoch17 Acc 0.9846375 (551397/560000), AUC 0.9988377690315247
ep17_train_time 104.09007358551025
Test Epoch17 layer4 Acc 0.9782, AUC 0.9976065754890442, avg_entr 0.0033438035752624273, f1 0.9782000184059143
ep17_l4_test_time 2.1529972553253174
gc 0
Train Epoch18 Acc 0.9847910714285715 (551483/560000), AUC 0.9988504648208618
ep18_train_time 103.30374956130981
Test Epoch18 layer4 Acc 0.9786857142857143, AUC 0.9975687861442566, avg_entr 0.00340280937962234, f1 0.978685736656189
ep18_l4_test_time 2.1990163326263428
gc 0
Train Epoch19 Acc 0.9848857142857143 (551536/560000), AUC 0.9988530278205872
ep19_train_time 103.3185670375824
Test Epoch19 layer4 Acc 0.9786571428571429, AUC 0.9975037574768066, avg_entr 0.0034459892194718122, f1 0.9786571264266968
ep19_l4_test_time 2.1577818393707275
gc 0
Train Epoch20 Acc 0.9849785714285715 (551588/560000), AUC 0.9988576769828796
ep20_train_time 103.35648894309998
Test Epoch20 layer4 Acc 0.9784, AUC 0.9975422620773315, avg_entr 0.0034750623162835836, f1 0.9783999919891357
ep20_l4_test_time 2.113581657409668
gc 0
Train Epoch21 Acc 0.9850160714285714 (551609/560000), AUC 0.9988464117050171
ep21_train_time 103.26638531684875
Test Epoch21 layer4 Acc 0.9786285714285714, AUC 0.997573733329773, avg_entr 0.0034203778486698866, f1 0.9786285758018494
ep21_l4_test_time 2.1930530071258545
gc 0
Train Epoch22 Acc 0.9850821428571429 (551646/560000), AUC 0.9988389611244202
ep22_train_time 104.31935548782349
Test Epoch22 layer4 Acc 0.9788571428571429, AUC 0.9974571466445923, avg_entr 0.003255356103181839, f1 0.978857159614563
ep22_l4_test_time 2.162004232406616
gc 0
Train Epoch23 Acc 0.985225 (551726/560000), AUC 0.9988536238670349
ep23_train_time 103.00576376914978
Test Epoch23 layer4 Acc 0.9786, AUC 0.9974744915962219, avg_entr 0.003312045708298683, f1 0.978600025177002
ep23_l4_test_time 2.165684461593628
gc 0
Train Epoch24 Acc 0.9853125 (551775/560000), AUC 0.9988508820533752
ep24_train_time 103.28795433044434
Test Epoch24 layer4 Acc 0.9785714285714285, AUC 0.9974212646484375, avg_entr 0.0032796456944197416, f1 0.9785714149475098
ep24_l4_test_time 2.1765663623809814
gc 0
Train Epoch25 Acc 0.9853571428571428 (551800/560000), AUC 0.9988502860069275
ep25_train_time 103.13600611686707
Test Epoch25 layer4 Acc 0.9784285714285714, AUC 0.9974747896194458, avg_entr 0.0032848541159182787, f1 0.9784285426139832
ep25_l4_test_time 2.1587588787078857
gc 0
Train Epoch26 Acc 0.9854839285714285 (551871/560000), AUC 0.9988561868667603
ep26_train_time 103.24406385421753
Test Epoch26 layer4 Acc 0.9785714285714285, AUC 0.9975141882896423, avg_entr 0.0032139148097485304, f1 0.9785714149475098
ep26_l4_test_time 2.156700372695923
gc 0
Train Epoch27 Acc 0.9854821428571429 (551870/560000), AUC 0.9988284707069397
ep27_train_time 103.92637896537781
Test Epoch27 layer4 Acc 0.9789714285714286, AUC 0.9974208474159241, avg_entr 0.003082629293203354, f1 0.9789714217185974
ep27_l4_test_time 2.1389315128326416
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 27
gc 0
Train Epoch28 Acc 0.9855357142857143 (551900/560000), AUC 0.9988495707511902
ep28_train_time 102.92727184295654
Test Epoch28 layer4 Acc 0.9784285714285714, AUC 0.9977301955223083, avg_entr 0.0033334193285554647, f1 0.9784285426139832
ep28_l4_test_time 2.178697109222412
gc 0
Train Epoch29 Acc 0.9856589285714286 (551969/560000), AUC 0.9988526105880737
ep29_train_time 103.12313747406006
Test Epoch29 layer4 Acc 0.9787142857142858, AUC 0.9975124597549438, avg_entr 0.0030904151499271393, f1 0.9787142872810364
ep29_l4_test_time 2.191391944885254
Best AUC tensor(0.9790) 27
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 3171.1655580997467
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt
Test layer0 Acc 0.9742571428571428, AUC 0.9982711672782898, avg_entr 0.022464502602815628, f1 0.9742571711540222
l0_test_time 2.119311809539795
Test layer1 Acc 0.9788, AUC 0.9982792735099792, avg_entr 0.008179360069334507, f1 0.9787999987602234
l1_test_time 2.0709965229034424
Test layer2 Acc 0.9788571428571429, AUC 0.9980915784835815, avg_entr 0.004978988319635391, f1 0.978857159614563
l2_test_time 2.11570405960083
Test layer3 Acc 0.9792285714285714, AUC 0.9979534149169922, avg_entr 0.003843895625323057, f1 0.9792285561561584
l3_test_time 2.1357531547546387
Test layer4 Acc 0.9792285714285714, AUC 0.9976384043693542, avg_entr 0.0033061662688851357, f1 0.9792285561561584
l4_test_time 2.146641254425049
