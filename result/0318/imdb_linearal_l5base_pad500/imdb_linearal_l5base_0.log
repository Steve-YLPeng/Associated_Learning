total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.282209638999998
Start Training
gc 0
Train Epoch0 Acc 0.518625 (20745/40000), AUC 0.5338672399520874
ep0_train_time 11.630450110999998
Test Epoch0 layer4 Acc 0.5086, AUC 0.838301956653595, avg_entr 0.6858881115913391, f1 0.5085999965667725
ep0_l4_test_time 0.7556842329999967
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.8133 (32532/40000), AUC 0.8920376300811768
ep1_train_time 10.579606685000002
Test Epoch1 layer4 Acc 0.8782, AUC 0.944772481918335, avg_entr 0.23956559598445892, f1 0.8781999945640564
ep1_l4_test_time 0.765428159999999
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9033 (36132/40000), AUC 0.9634925127029419
ep2_train_time 10.648449872
Test Epoch2 layer4 Acc 0.8922, AUC 0.9558706283569336, avg_entr 0.17219381034374237, f1 0.8921999931335449
ep2_l4_test_time 0.7647557419999984
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.922775 (36911/40000), AUC 0.975406289100647
ep3_train_time 10.677507278
Test Epoch3 layer4 Acc 0.871, AUC 0.9591917991638184, avg_entr 0.1418835073709488, f1 0.8709999918937683
ep3_l4_test_time 0.764628946000002
gc 0
Train Epoch4 Acc 0.934025 (37361/40000), AUC 0.9811978340148926
ep4_train_time 10.600144319999998
Test Epoch4 layer4 Acc 0.8972, AUC 0.9603419303894043, avg_entr 0.0912414938211441, f1 0.8971999883651733
ep4_l4_test_time 0.7397752819999965
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.942475 (37699/40000), AUC 0.9848139882087708
ep5_train_time 10.710004270000013
Test Epoch5 layer4 Acc 0.8978, AUC 0.960396409034729, avg_entr 0.06518565863370895, f1 0.8978000283241272
ep5_l4_test_time 0.7599967099999958
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.94885 (37954/40000), AUC 0.9873852729797363
ep6_train_time 10.606324550999986
Test Epoch6 layer4 Acc 0.8974, AUC 0.9579566717147827, avg_entr 0.04880024120211601, f1 0.8974000215530396
ep6_l4_test_time 0.7613348900000005
gc 0
Train Epoch7 Acc 0.953375 (38135/40000), AUC 0.9886032938957214
ep7_train_time 10.555574554000003
Test Epoch7 layer4 Acc 0.8882, AUC 0.9517298936843872, avg_entr 0.0441121943295002, f1 0.888200044631958
ep7_l4_test_time 0.7512259240000105
gc 0
Train Epoch8 Acc 0.958525 (38341/40000), AUC 0.9909499287605286
ep8_train_time 10.671070827000008
Test Epoch8 layer4 Acc 0.8896, AUC 0.9518550634384155, avg_entr 0.03870081529021263, f1 0.8895999193191528
ep8_l4_test_time 0.7464059280000015
gc 0
Train Epoch9 Acc 0.962 (38480/40000), AUC 0.9922881126403809
ep9_train_time 10.603092117999992
Test Epoch9 layer4 Acc 0.8888, AUC 0.9474706053733826, avg_entr 0.032037608325481415, f1 0.8888000249862671
ep9_l4_test_time 0.7702564350000216
gc 0
Train Epoch10 Acc 0.96405 (38562/40000), AUC 0.9933438301086426
ep10_train_time 10.598403297999994
Test Epoch10 layer4 Acc 0.8852, AUC 0.947928786277771, avg_entr 0.03137718513607979, f1 0.8852000832557678
ep10_l4_test_time 0.7733371820000059
gc 0
Train Epoch11 Acc 0.967275 (38691/40000), AUC 0.9941517114639282
ep11_train_time 10.733996802000007
Test Epoch11 layer4 Acc 0.882, AUC 0.9473119974136353, avg_entr 0.02898233011364937, f1 0.8820000290870667
ep11_l4_test_time 0.7501651780000032
gc 0
Train Epoch12 Acc 0.9695 (38780/40000), AUC 0.9948818683624268
ep12_train_time 10.620114537999996
Test Epoch12 layer4 Acc 0.8804, AUC 0.9453009366989136, avg_entr 0.026187293231487274, f1 0.8804000020027161
ep12_l4_test_time 0.767864330000009
gc 0
Train Epoch13 Acc 0.97185 (38874/40000), AUC 0.9955288171768188
ep13_train_time 10.605013388999993
Test Epoch13 layer4 Acc 0.8756, AUC 0.9412405490875244, avg_entr 0.023215100169181824, f1 0.8756000399589539
ep13_l4_test_time 0.7517482339999901
gc 0
Train Epoch14 Acc 0.9733 (38932/40000), AUC 0.9957822561264038
ep14_train_time 10.702025206000002
Test Epoch14 layer4 Acc 0.8752, AUC 0.9421083927154541, avg_entr 0.023668285459280014, f1 0.8751999735832214
ep14_l4_test_time 0.7562202729999967
gc 0
Train Epoch15 Acc 0.9752 (39008/40000), AUC 0.996358335018158
ep15_train_time 10.622261226999996
Test Epoch15 layer4 Acc 0.873, AUC 0.9371074438095093, avg_entr 0.021685486659407616, f1 0.8730000257492065
ep15_l4_test_time 0.7547789110000167
gc 0
Train Epoch16 Acc 0.97645 (39058/40000), AUC 0.9966112971305847
ep16_train_time 10.661784941999997
Test Epoch16 layer4 Acc 0.8668, AUC 0.9348872900009155, avg_entr 0.020593032240867615, f1 0.8668000102043152
ep16_l4_test_time 0.7482284209999932
gc 0
Train Epoch17 Acc 0.9783 (39132/40000), AUC 0.9971392154693604
ep17_train_time 10.675118826000016
Test Epoch17 layer4 Acc 0.8674, AUC 0.9309773445129395, avg_entr 0.02089659683406353, f1 0.8673999905586243
ep17_l4_test_time 0.7741837389999944
gc 0
Train Epoch18 Acc 0.97895 (39158/40000), AUC 0.9972699880599976
ep18_train_time 10.666534072000019
Test Epoch18 layer4 Acc 0.8632, AUC 0.9303656816482544, avg_entr 0.01966082863509655, f1 0.8632000088691711
ep18_l4_test_time 0.7360360430000128
gc 0
Train Epoch19 Acc 0.98 (39200/40000), AUC 0.9975206255912781
ep19_train_time 10.63595618399998
Test Epoch19 layer4 Acc 0.8618, AUC 0.9289636015892029, avg_entr 0.019814075902104378, f1 0.8618000149726868
ep19_l4_test_time 0.7454275100000132
gc 0
Train Epoch20 Acc 0.982175 (39287/40000), AUC 0.9977385401725769
ep20_train_time 10.697562535000003
Test Epoch20 layer4 Acc 0.8576, AUC 0.9259785413742065, avg_entr 0.019404051825404167, f1 0.8575999140739441
ep20_l4_test_time 0.7587626310000246
gc 0
Train Epoch21 Acc 0.982725 (39309/40000), AUC 0.9980441331863403
ep21_train_time 10.631708968999988
Test Epoch21 layer4 Acc 0.8548, AUC 0.9254620671272278, avg_entr 0.013767663389444351, f1 0.8547999858856201
ep21_l4_test_time 0.7368157459999907
gc 0
Train Epoch22 Acc 0.98335 (39334/40000), AUC 0.9981377124786377
ep22_train_time 10.736069799000006
Test Epoch22 layer4 Acc 0.8548, AUC 0.9229871034622192, avg_entr 0.014598771929740906, f1 0.8547999858856201
ep22_l4_test_time 0.756472672999962
gc 0
Train Epoch23 Acc 0.983975 (39359/40000), AUC 0.9981946349143982
ep23_train_time 10.572742696999967
Test Epoch23 layer4 Acc 0.8524, AUC 0.9210688471794128, avg_entr 0.014649493619799614, f1 0.852400004863739
ep23_l4_test_time 0.7807884869999953
gc 0
Train Epoch24 Acc 0.984425 (39377/40000), AUC 0.9984596967697144
ep24_train_time 10.630256574999976
Test Epoch24 layer4 Acc 0.8496, AUC 0.9207976460456848, avg_entr 0.013362511992454529, f1 0.8496000170707703
ep24_l4_test_time 0.7531677750000085
gc 0
Train Epoch25 Acc 0.985425 (39417/40000), AUC 0.9985167980194092
ep25_train_time 10.702328279000028
Test Epoch25 layer4 Acc 0.8482, AUC 0.9166194200515747, avg_entr 0.013289513997733593, f1 0.8482000231742859
ep25_l4_test_time 0.7514107509999803
gc 0
Train Epoch26 Acc 0.98605 (39442/40000), AUC 0.9985832571983337
ep26_train_time 10.537476112000036
Test Epoch26 layer4 Acc 0.8474, AUC 0.9152175784111023, avg_entr 0.01421517226845026, f1 0.8474000096321106
ep26_l4_test_time 0.7517344419999858
gc 0
Train Epoch27 Acc 0.986125 (39445/40000), AUC 0.9987413883209229
ep27_train_time 10.624588146999997
Test Epoch27 layer4 Acc 0.845, AUC 0.9148335456848145, avg_entr 0.011656949296593666, f1 0.8449999690055847
ep27_l4_test_time 0.7545903579999731
gc 0
Train Epoch28 Acc 0.9867 (39468/40000), AUC 0.9987572431564331
ep28_train_time 10.696082203000003
Test Epoch28 layer4 Acc 0.8448, AUC 0.9140664339065552, avg_entr 0.013259627856314182, f1 0.8447999358177185
ep28_l4_test_time 0.74061311600002
gc 0
Train Epoch29 Acc 0.987425 (39497/40000), AUC 0.998961329460144
ep29_train_time 10.584325716000023
Test Epoch29 layer4 Acc 0.8414, AUC 0.9107376337051392, avg_entr 0.013984338380396366, f1 0.8414000272750854
ep29_l4_test_time 0.7655839779999951
Best AUC tensor(0.8978) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 344.453223154
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8928, AUC 0.9546230435371399, avg_entr 0.16931377351284027, f1 0.892799973487854
l0_test_time 0.7538375679999945
gc 0
Test layer1 Acc 0.8918, AUC 0.9550937414169312, avg_entr 0.14675521850585938, f1 0.8917999863624573
l1_test_time 0.7646044520000146
gc 0
Test layer2 Acc 0.8938, AUC 0.9554725885391235, avg_entr 0.13184703886508942, f1 0.8938000202178955
l2_test_time 0.7592024839999567
gc 0
Test layer3 Acc 0.8938, AUC 0.9561381340026855, avg_entr 0.10217829048633575, f1 0.8938000202178955
l3_test_time 0.7676471279999646
gc 0
Test layer4 Acc 0.894, AUC 0.9561436176300049, avg_entr 0.06927140802145004, f1 0.8939999938011169
l4_test_time 0.7602532330000145
gc 0
Test threshold 0.1 Acc 0.894, AUC 0.9505366683006287, avg_entr 0.11882908642292023, f1 0.8939999938011169
t0.1_test_time 1.6988623400000051
gc 0
Test threshold 0.2 Acc 0.894, AUC 0.9508332014083862, avg_entr 0.1388208568096161, f1 0.8939999938011169
t0.2_test_time 1.828468466000004
gc 0
Test threshold 0.3 Acc 0.894, AUC 0.9514498710632324, avg_entr 0.1579788625240326, f1 0.8939999938011169
t0.3_test_time 1.8064142009999955
gc 0
Test threshold 0.4 Acc 0.894, AUC 0.9525882005691528, avg_entr 0.1753367930650711, f1 0.8939999938011169
t0.4_test_time 1.7897901769999862
gc 0
Test threshold 0.5 Acc 0.894, AUC 0.953248143196106, avg_entr 0.19083145260810852, f1 0.8939999938011169
t0.5_test_time 1.756391482999959
gc 0
Test threshold 0.6 Acc 0.894, AUC 0.9531818628311157, avg_entr 0.20508486032485962, f1 0.8939999938011169
t0.6_test_time 1.7398985699999798
gc 0
Test threshold 0.7 Acc 0.894, AUC 0.95356684923172, avg_entr 0.21820175647735596, f1 0.8939999938011169
t0.7_test_time 1.7189279650000344
gc 0
Test threshold 0.8 Acc 0.894, AUC 0.9540706276893616, avg_entr 0.23006004095077515, f1 0.8939999938011169
t0.8_test_time 1.7663686809999604
gc 0
Test threshold 0.9 Acc 0.894, AUC 0.9546089768409729, avg_entr 0.23908774554729462, f1 0.8939999938011169
t0.9_test_time 1.657893018999971
