total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.744597994
Start Training
gc 0
Train Epoch0 Acc 0.49365 (19746/40000), AUC 0.49030858278274536
ep0_train_time 7.190114744999999
Test Epoch0 layer4 Acc 0.4994, AUC 0.36493611335754395, avg_entr 0.690869152545929, f1 0.49939998984336853
ep0_l4_test_time 0.5826446589999996
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.777525 (31101/40000), AUC 0.8758789896965027
ep1_train_time 6.879896250999998
Test Epoch1 layer4 Acc 0.8724, AUC 0.9463633298873901, avg_entr 0.23322543501853943, f1 0.8723999857902527
ep1_l4_test_time 0.6142432659999955
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.90385 (36154/40000), AUC 0.9638068675994873
ep2_train_time 11.034591106
Test Epoch2 layer4 Acc 0.8918, AUC 0.9559412002563477, avg_entr 0.1784912496805191, f1 0.8917999863624573
ep2_l4_test_time 0.7758305289999967
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.923125 (36925/40000), AUC 0.9757663011550903
ep3_train_time 10.963186123
Test Epoch3 layer4 Acc 0.8954, AUC 0.959479808807373, avg_entr 0.1293281465768814, f1 0.8953999876976013
ep3_l4_test_time 0.7633819059999993
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.934225 (37369/40000), AUC 0.9815686941146851
ep4_train_time 10.997547087999997
Test Epoch4 layer4 Acc 0.9014, AUC 0.9606980085372925, avg_entr 0.09720481187105179, f1 0.9014000296592712
ep4_l4_test_time 0.7710291430000069
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9421 (37684/40000), AUC 0.9850472211837769
ep5_train_time 10.851688507999995
Test Epoch5 layer4 Acc 0.897, AUC 0.9610152244567871, avg_entr 0.06527119129896164, f1 0.8970000147819519
ep5_l4_test_time 0.7715739530000008
gc 0
Train Epoch6 Acc 0.948875 (37955/40000), AUC 0.9876760244369507
ep6_train_time 10.892694726000002
Test Epoch6 layer4 Acc 0.897, AUC 0.9596481919288635, avg_entr 0.05363309755921364, f1 0.8970000147819519
ep6_l4_test_time 0.7585147660000047
gc 0
Train Epoch7 Acc 0.95365 (38146/40000), AUC 0.9891867637634277
ep7_train_time 10.96062749299999
Test Epoch7 layer4 Acc 0.8962, AUC 0.9558389186859131, avg_entr 0.04044272378087044, f1 0.8962000012397766
ep7_l4_test_time 0.7900720399999983
gc 0
Train Epoch8 Acc 0.957725 (38309/40000), AUC 0.9908133745193481
ep8_train_time 10.881733401000005
Test Epoch8 layer4 Acc 0.8934, AUC 0.9548633098602295, avg_entr 0.035058651119470596, f1 0.8934000134468079
ep8_l4_test_time 0.76840811000001
gc 0
Train Epoch9 Acc 0.9619 (38476/40000), AUC 0.9921824932098389
ep9_train_time 10.998271040999995
Test Epoch9 layer4 Acc 0.8852, AUC 0.950890064239502, avg_entr 0.030661923810839653, f1 0.8852000832557678
ep9_l4_test_time 0.7909820120000006
gc 0
Train Epoch10 Acc 0.965025 (38601/40000), AUC 0.9931665658950806
ep10_train_time 10.877270907999986
Test Epoch10 layer4 Acc 0.8874, AUC 0.9480640292167664, avg_entr 0.027180807664990425, f1 0.8873999714851379
ep10_l4_test_time 0.7733592059999808
gc 0
Train Epoch11 Acc 0.96765 (38706/40000), AUC 0.9938832521438599
ep11_train_time 10.938788709000022
Test Epoch11 layer4 Acc 0.884, AUC 0.9500125646591187, avg_entr 0.026791570708155632, f1 0.8840000033378601
ep11_l4_test_time 0.7740189090000058
gc 0
Train Epoch12 Acc 0.96955 (38782/40000), AUC 0.9948892593383789
ep12_train_time 11.070530961999992
Test Epoch12 layer4 Acc 0.8818, AUC 0.9440574645996094, avg_entr 0.02353081665933132, f1 0.8818000555038452
ep12_l4_test_time 0.8000617200000022
gc 0
Train Epoch13 Acc 0.972075 (38883/40000), AUC 0.9954330921173096
ep13_train_time 10.876329956000006
Test Epoch13 layer4 Acc 0.8762, AUC 0.944107174873352, avg_entr 0.024332206696271896, f1 0.8762000203132629
ep13_l4_test_time 0.7507086270000229
gc 0
Train Epoch14 Acc 0.974025 (38961/40000), AUC 0.9958199262619019
ep14_train_time 11.013850286999997
Test Epoch14 layer4 Acc 0.8756, AUC 0.9430373907089233, avg_entr 0.021536920219659805, f1 0.8756000399589539
ep14_l4_test_time 0.7648198910000019
gc 0
Train Epoch15 Acc 0.974675 (38987/40000), AUC 0.996244490146637
ep15_train_time 10.879439195000003
Test Epoch15 layer4 Acc 0.8714, AUC 0.9385772347450256, avg_entr 0.020470861345529556, f1 0.871399998664856
ep15_l4_test_time 0.7543674990000113
gc 0
Train Epoch16 Acc 0.9763 (39052/40000), AUC 0.9967257976531982
ep16_train_time 10.977298531000002
Test Epoch16 layer4 Acc 0.8644, AUC 0.9349058866500854, avg_entr 0.01904412731528282, f1 0.8644000291824341
ep16_l4_test_time 0.7774239730000261
gc 0
Train Epoch17 Acc 0.9778 (39112/40000), AUC 0.9970806837081909
ep17_train_time 10.971093977999999
Test Epoch17 layer4 Acc 0.866, AUC 0.9344968795776367, avg_entr 0.017526552081108093, f1 0.8659999966621399
ep17_l4_test_time 0.7769082970000056
gc 0
Train Epoch18 Acc 0.9781 (39124/40000), AUC 0.9973801970481873
ep18_train_time 10.972390797999992
Test Epoch18 layer4 Acc 0.8624, AUC 0.9332011938095093, avg_entr 0.01586740091443062, f1 0.8623999953269958
ep18_l4_test_time 0.7619265040000016
gc 0
Train Epoch19 Acc 0.9813 (39252/40000), AUC 0.9976934194564819
ep19_train_time 11.046209066999978
Test Epoch19 layer4 Acc 0.8576, AUC 0.9295724630355835, avg_entr 0.016475165262818336, f1 0.8575999140739441
ep19_l4_test_time 0.7692048039999975
gc 0
Train Epoch20 Acc 0.980975 (39239/40000), AUC 0.9977517127990723
ep20_train_time 10.936520348000016
Test Epoch20 layer4 Acc 0.8596, AUC 0.9268430471420288, avg_entr 0.01759336329996586, f1 0.8596000075340271
ep20_l4_test_time 0.7614640259999987
gc 0
Train Epoch21 Acc 0.981825 (39273/40000), AUC 0.9980013370513916
ep21_train_time 11.004026667999995
Test Epoch21 layer4 Acc 0.8558, AUC 0.9245034456253052, avg_entr 0.014066653326153755, f1 0.8558000326156616
ep21_l4_test_time 0.7456915270000195
gc 0
Train Epoch22 Acc 0.982975 (39319/40000), AUC 0.9982414245605469
ep22_train_time 10.930846659999986
Test Epoch22 layer4 Acc 0.8542, AUC 0.9238308668136597, avg_entr 0.013992729596793652, f1 0.854200005531311
ep22_l4_test_time 0.77058287899996
gc 0
Train Epoch23 Acc 0.983925 (39357/40000), AUC 0.9983272552490234
ep23_train_time 11.014180854000017
Test Epoch23 layer4 Acc 0.8512, AUC 0.9195951223373413, avg_entr 0.017856964841485023, f1 0.8511999845504761
ep23_l4_test_time 0.7656226960000367
gc 0
Train Epoch24 Acc 0.98425 (39370/40000), AUC 0.9984692335128784
ep24_train_time 10.917199614000026
Test Epoch24 layer4 Acc 0.8496, AUC 0.9191821217536926, avg_entr 0.012802508659660816, f1 0.8496000170707703
ep24_l4_test_time 0.7840065500000151
gc 0
Train Epoch25 Acc 0.985025 (39401/40000), AUC 0.9985623359680176
ep25_train_time 10.88219025699999
Test Epoch25 layer4 Acc 0.8482, AUC 0.9179942607879639, avg_entr 0.01364134531468153, f1 0.8482000231742859
ep25_l4_test_time 0.7732583339999906
gc 0
Train Epoch26 Acc 0.985625 (39425/40000), AUC 0.9986170530319214
ep26_train_time 11.011972188000016
Test Epoch26 layer4 Acc 0.8454, AUC 0.916073203086853, avg_entr 0.013173392973840237, f1 0.8453999757766724
ep26_l4_test_time 0.7611461590000204
gc 0
Train Epoch27 Acc 0.9858 (39432/40000), AUC 0.9987884759902954
ep27_train_time 10.900338165999983
Test Epoch27 layer4 Acc 0.846, AUC 0.9129436612129211, avg_entr 0.0157130416482687, f1 0.8460000157356262
ep27_l4_test_time 0.7568509139999833
gc 0
Train Epoch28 Acc 0.9865 (39460/40000), AUC 0.9988091588020325
ep28_train_time 11.048495057000025
Test Epoch28 layer4 Acc 0.8448, AUC 0.9121111631393433, avg_entr 0.013470950536429882, f1 0.8447999358177185
ep28_l4_test_time 0.7689917019999939
gc 0
Train Epoch29 Acc 0.987525 (39501/40000), AUC 0.9989243149757385
ep29_train_time 10.955645749999974
Test Epoch29 layer4 Acc 0.8414, AUC 0.9097135066986084, avg_entr 0.01324508711695671, f1 0.8414000272750854
ep29_l4_test_time 0.7476402929999608
Best AUC tensor(0.9014) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 345.13202046400005
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8954, AUC 0.9558082818984985, avg_entr 0.18112462759017944, f1 0.8953999876976013
l0_test_time 0.7642618250000055
gc 0
Test layer1 Acc 0.8938, AUC 0.9563578963279724, avg_entr 0.16193819046020508, f1 0.8938000202178955
l1_test_time 0.7578231609999762
gc 0
Test layer2 Acc 0.8948, AUC 0.9568783044815063, avg_entr 0.14765629172325134, f1 0.8948000073432922
l2_test_time 0.7403493950000097
gc 0
Test layer3 Acc 0.8956, AUC 0.9570675492286682, avg_entr 0.1303960531949997, f1 0.8956000208854675
l3_test_time 0.7684629529999825
gc 0
Test layer4 Acc 0.8958, AUC 0.9574700593948364, avg_entr 0.10134448111057281, f1 0.895799994468689
l4_test_time 0.7680369930000097
gc 0
Test threshold 0.1 Acc 0.8958, AUC 0.9561437368392944, avg_entr 0.16118986904621124, f1 0.895799994468689
t0.1_test_time 1.7826456120000103
gc 0
Test threshold 0.2 Acc 0.8958, AUC 0.9541985988616943, avg_entr 0.17694270610809326, f1 0.895799994468689
t0.2_test_time 1.7606207599999948
gc 0
Test threshold 0.3 Acc 0.8958, AUC 0.954694926738739, avg_entr 0.19244889914989471, f1 0.895799994468689
t0.3_test_time 1.78092101499999
gc 0
Test threshold 0.4 Acc 0.8958, AUC 0.9549779891967773, avg_entr 0.2063392847776413, f1 0.895799994468689
t0.4_test_time 1.7324047860000178
gc 0
Test threshold 0.5 Acc 0.8958, AUC 0.9548546075820923, avg_entr 0.2201826423406601, f1 0.895799994468689
t0.5_test_time 1.9229884729999753
gc 0
Test threshold 0.6 Acc 0.8958, AUC 0.9553813934326172, avg_entr 0.2313467562198639, f1 0.895799994468689
t0.6_test_time 1.9567271559999995
gc 0
Test threshold 0.7 Acc 0.8958, AUC 0.9555224776268005, avg_entr 0.24069909751415253, f1 0.895799994468689
t0.7_test_time 1.8164242799999784
gc 0
Test threshold 0.8 Acc 0.8958, AUC 0.9556399583816528, avg_entr 0.24926923215389252, f1 0.895799994468689
t0.8_test_time 1.871159017000025
gc 0
Test threshold 0.9 Acc 0.8958, AUC 0.9556847810745239, avg_entr 0.2562560737133026, f1 0.895799994468689
t0.9_test_time 1.7617395589999774
