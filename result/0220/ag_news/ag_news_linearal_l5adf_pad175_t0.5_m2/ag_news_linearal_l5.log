total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.755127429962158
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.248475 (29817/120000), AUC 0.55629563331604
ep0_train_time 7.185534715652466
Test Epoch0 threshold 0.5 Acc 0.9126315789473685, AUC 0.9789643287658691, avg_entr 0.045693572610616684
ep0_t0.5_test_time 0.16080045700073242
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.653714120388031
ep1_train_time 6.791488409042358
Test Epoch1 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789764881134033, avg_entr 0.04592136666178703
ep1_t0.5_test_time 0.15916681289672852
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.6644428968429565
ep2_train_time 6.926150798797607
Test Epoch2 threshold 0.5 Acc 0.9118421052631579, AUC 0.9789832830429077, avg_entr 0.04597671329975128
ep2_t0.5_test_time 0.15915322303771973
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25000833333333333 (30001/120000), AUC 0.6687057018280029
ep3_train_time 6.776257753372192
Test Epoch3 threshold 0.5 Acc 0.9128947368421053, AUC 0.9789773225784302, avg_entr 0.045968394726514816
ep3_t0.5_test_time 0.15932679176330566
gc 0
Train Epoch4 Acc 0.25000833333333333 (30001/120000), AUC 0.6711128950119019
ep4_train_time 6.775418758392334
Test Epoch4 threshold 0.5 Acc 0.9123684210526316, AUC 0.9789837598800659, avg_entr 0.04593261703848839
ep4_t0.5_test_time 0.15965938568115234
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25000833333333333 (30001/120000), AUC 0.6709263920783997
ep5_train_time 6.885608196258545
Test Epoch5 threshold 0.5 Acc 0.911578947368421, AUC 0.9789730906486511, avg_entr 0.04591621458530426
ep5_t0.5_test_time 0.15961122512817383
gc 0
Train Epoch6 Acc 0.25000833333333333 (30001/120000), AUC 0.6705193519592285
ep6_train_time 6.735140085220337
Test Epoch6 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789754152297974, avg_entr 0.04591136798262596
ep6_t0.5_test_time 0.15976667404174805
gc 0
Train Epoch7 Acc 0.24998333333333334 (29998/120000), AUC 0.6705436706542969
ep7_train_time 6.762738466262817
Test Epoch7 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789747595787048, avg_entr 0.045961666852235794
ep7_t0.5_test_time 0.15994668006896973
gc 0
Train Epoch8 Acc 0.249975 (29997/120000), AUC 0.6706860065460205
ep8_train_time 6.776965379714966
Test Epoch8 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789736270904541, avg_entr 0.045909520238637924
ep8_t0.5_test_time 0.15982699394226074
gc 0
Train Epoch9 Acc 0.24998333333333334 (29998/120000), AUC 0.6708492040634155
ep9_train_time 6.8353798389434814
Test Epoch9 threshold 0.5 Acc 0.9118421052631579, AUC 0.9789721369743347, avg_entr 0.04590307176113129
ep9_t0.5_test_time 0.15944457054138184
Best AUC 0.9789837598800659
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 70.96956491470337
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5.pt
Test threshold 0.5 Acc 0.9234210526315789, AUC 0.9849287271499634, avg_entr 0.044924698770046234
t0.5_test_time 0.15827083587646484
