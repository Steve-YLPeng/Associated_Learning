total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.843678951263428
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.253475 (30417/120000), AUC 0.5388767719268799
ep0_train_time 8.538622617721558
Test Epoch0 threshold 0.2 Acc 0.8894736842105263, AUC 0.9712598919868469, avg_entr 0.18676456809043884
ep0_t0.2_test_time 0.16374564170837402
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25538333333333335 (30646/120000), AUC 0.5766535997390747
ep1_train_time 7.937697410583496
Test Epoch1 threshold 0.2 Acc 0.9036842105263158, AUC 0.9756727814674377, avg_entr 0.10757134854793549
ep1_t0.2_test_time 0.1582186222076416
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25645833333333334 (30775/120000), AUC 0.5830010175704956
ep2_train_time 8.556143283843994
Test Epoch2 threshold 0.2 Acc 0.9118421052631579, AUC 0.9772580862045288, avg_entr 0.08355149626731873
ep2_t0.2_test_time 0.1583728790283203
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25700833333333334 (30841/120000), AUC 0.5831298828125
ep3_train_time 8.05000615119934
Test Epoch3 threshold 0.2 Acc 0.9107894736842105, AUC 0.9781797528266907, avg_entr 0.06805058568716049
ep3_t0.2_test_time 0.15900921821594238
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.2579666666666667 (30956/120000), AUC 0.5822761058807373
ep4_train_time 8.054898500442505
Test Epoch4 threshold 0.2 Acc 0.9139473684210526, AUC 0.9785612225532532, avg_entr 0.05972815304994583
ep4_t0.2_test_time 0.15923428535461426
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25895833333333335 (31075/120000), AUC 0.5809269547462463
ep5_train_time 8.095012664794922
Test Epoch5 threshold 0.2 Acc 0.9086842105263158, AUC 0.9787837862968445, avg_entr 0.057543590664863586
ep5_t0.2_test_time 0.15974187850952148
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.26033333333333336 (31240/120000), AUC 0.579608142375946
ep6_train_time 8.043367147445679
Test Epoch6 threshold 0.2 Acc 0.91, AUC 0.9786885976791382, avg_entr 0.0503092035651207
ep6_t0.2_test_time 0.1593177318572998
gc 0
Train Epoch7 Acc 0.26211666666666666 (31454/120000), AUC 0.5791435837745667
ep7_train_time 7.995784521102905
Test Epoch7 threshold 0.2 Acc 0.911578947368421, AUC 0.9785635471343994, avg_entr 0.047692641615867615
ep7_t0.2_test_time 0.15892672538757324
gc 0
Train Epoch8 Acc 0.264175 (31701/120000), AUC 0.5781230926513672
ep8_train_time 8.275113582611084
Test Epoch8 threshold 0.2 Acc 0.9110526315789473, AUC 0.9785076379776001, avg_entr 0.042802855372428894
ep8_t0.2_test_time 0.1590256690979004
gc 0
Train Epoch9 Acc 0.26698333333333335 (32038/120000), AUC 0.5772392153739929
ep9_train_time 8.172410249710083
Test Epoch9 threshold 0.2 Acc 0.9121052631578948, AUC 0.9782793521881104, avg_entr 0.04081137850880623
ep9_t0.2_test_time 0.15961503982543945
Best AUC 0.9787837862968445
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 84.38510370254517
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5.pt
Test threshold 0.2 Acc 0.9247368421052632, AUC 0.9847771525382996, avg_entr 0.055126264691352844
t0.2_test_time 0.1574079990386963
