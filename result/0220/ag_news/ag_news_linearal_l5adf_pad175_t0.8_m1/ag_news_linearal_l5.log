total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.378931522369385
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.250125 (30015/120000), AUC 0.4795779883861542
ep0_train_time 8.5351243019104
Test Epoch0 threshold 0.8 Acc 0.8910526315789473, AUC 0.9715369343757629, avg_entr 0.18336336314678192
ep0_t0.8_test_time 0.17022275924682617
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24934166666666666 (29921/120000), AUC 0.43574970960617065
ep1_train_time 8.181917905807495
Test Epoch1 threshold 0.8 Acc 0.9060526315789473, AUC 0.976173996925354, avg_entr 0.10652566701173782
ep1_t0.8_test_time 0.16067004203796387
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24929166666666666 (29915/120000), AUC 0.4413529634475708
ep2_train_time 8.15786600112915
Test Epoch2 threshold 0.8 Acc 0.9089473684210526, AUC 0.9777228236198425, avg_entr 0.08003002405166626
ep2_t0.8_test_time 0.16265487670898438
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24926666666666666 (29912/120000), AUC 0.4538666605949402
ep3_train_time 8.170982837677002
Test Epoch3 threshold 0.8 Acc 0.9078947368421053, AUC 0.9782286286354065, avg_entr 0.0683140680193901
ep3_t0.8_test_time 0.15982866287231445
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.249575 (29949/120000), AUC 0.4649887681007385
ep4_train_time 8.186684846878052
Test Epoch4 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep4_t0.8_test_time 0.1618802547454834
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24965833333333334 (29959/120000), AUC 0.47419366240501404
ep5_train_time 8.170951843261719
Test Epoch5 threshold 0.8 Acc 0.91, AUC 0.978810727596283, avg_entr 0.055796921253204346
ep5_t0.8_test_time 0.16380882263183594
gc 0
Train Epoch6 Acc 0.2500583333333333 (30007/120000), AUC 0.48161619901657104
ep6_train_time 8.151293277740479
Test Epoch6 threshold 0.8 Acc 0.9126315789473685, AUC 0.9785497784614563, avg_entr 0.050471074879169464
ep6_t0.8_test_time 0.1636674404144287
gc 0
Train Epoch7 Acc 0.250325 (30039/120000), AUC 0.48797792196273804
ep7_train_time 8.175234317779541
Test Epoch7 threshold 0.8 Acc 0.9107894736842105, AUC 0.9784711003303528, avg_entr 0.047050561755895615
ep7_t0.8_test_time 0.1607053279876709
gc 0
Train Epoch8 Acc 0.25035833333333335 (30043/120000), AUC 0.4933941662311554
ep8_train_time 8.214875221252441
Test Epoch8 threshold 0.8 Acc 0.9105263157894737, AUC 0.9783303141593933, avg_entr 0.04324634373188019
ep8_t0.8_test_time 0.1608412265777588
gc 0
Train Epoch9 Acc 0.250575 (30069/120000), AUC 0.49705368280410767
ep9_train_time 8.201045274734497
Test Epoch9 threshold 0.8 Acc 0.9121052631578948, AUC 0.9783836603164673, avg_entr 0.04172758758068085
ep9_t0.8_test_time 0.16427087783813477
Best AUC 0.9788198471069336
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 84.76884913444519
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5.pt
Test threshold 0.8 Acc 0.9221052631578948, AUC 0.9848241209983826, avg_entr 0.06039261817932129
t0.8_test_time 0.15883541107177734
