total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.81879711151123
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.25196666666666667 (30236/120000), AUC 0.8819466829299927
ep0_train_time 7.473450422286987
Test Epoch0 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep0_t0.9_test_time 0.16348481178283691
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2506833333333333 (30082/120000), AUC 0.9222837686538696
ep1_train_time 6.9852259159088135
Test Epoch1 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep1_t0.9_test_time 0.1606297492980957
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2562583333333333 (30751/120000), AUC 0.9363589286804199
ep2_train_time 6.993707895278931
Test Epoch2 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep2_t0.9_test_time 0.16244029998779297
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.285975 (34317/120000), AUC 0.9350755214691162
ep3_train_time 7.039374828338623
Test Epoch3 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep3_t0.9_test_time 0.16097593307495117
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.3561166666666667 (42734/120000), AUC 0.9292134046554565
ep4_train_time 6.969371318817139
Test Epoch4 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep4_t0.9_test_time 0.1606426239013672
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.4063833333333333 (48766/120000), AUC 0.9208189249038696
ep5_train_time 6.971357583999634
Test Epoch5 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep5_t0.9_test_time 0.1611020565032959
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.43299166666666666 (51959/120000), AUC 0.9106456637382507
ep6_train_time 6.9484336376190186
Test Epoch6 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep6_t0.9_test_time 0.16147732734680176
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.45495 (54594/120000), AUC 0.8890069127082825
ep7_train_time 6.993798017501831
Test Epoch7 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep7_t0.9_test_time 0.1602640151977539
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.46945 (56334/120000), AUC 0.8489532470703125
ep8_train_time 7.051066160202026
Test Epoch8 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep8_t0.9_test_time 0.16184449195861816
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.47536666666666666 (57044/120000), AUC 0.8096280694007874
ep9_train_time 6.953266859054565
Test Epoch9 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep9_t0.9_test_time 0.1612098217010498
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9788055419921875
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 73.31911325454712
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5.pt
Test threshold 0.9 Acc 0.9242105263157895, AUC 0.9847592115402222, avg_entr 0.052668217569589615
t0.9_test_time 0.1592423915863037
