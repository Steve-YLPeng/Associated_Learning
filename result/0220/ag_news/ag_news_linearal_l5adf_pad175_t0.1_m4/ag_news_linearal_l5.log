total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.02274250984192
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.23246666666666665 (27896/120000), AUC 0.6527082324028015
ep0_train_time 7.243240118026733
Test Epoch0 threshold 0.1 Acc 0.911578947368421, AUC 0.9785999655723572, avg_entr 0.04562027379870415
ep0_t0.1_test_time 0.1750328540802002
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m4//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3072666666666667 (36872/120000), AUC 0.6730947494506836
ep1_train_time 6.779646635055542
Test Epoch1 threshold 0.1 Acc 0.9105263157894737, AUC 0.97849041223526, avg_entr 0.04341621696949005
ep1_t0.1_test_time 0.17334485054016113
gc 0
Train Epoch2 Acc 0.3829 (45948/120000), AUC 0.7059103846549988
ep2_train_time 6.7013280391693115
Test Epoch2 threshold 0.1 Acc 0.9126315789473685, AUC 0.9782913327217102, avg_entr 0.040562704205513
ep2_t0.1_test_time 0.17412090301513672
gc 0
Train Epoch3 Acc 0.4156416666666667 (49877/120000), AUC 0.7276241779327393
ep3_train_time 6.853066921234131
Test Epoch3 threshold 0.1 Acc 0.9118421052631579, AUC 0.9779534339904785, avg_entr 0.03822600841522217
ep3_t0.1_test_time 0.1738743782043457
gc 0
Train Epoch4 Acc 0.42935833333333334 (51523/120000), AUC 0.7404669523239136
ep4_train_time 6.762070894241333
Test Epoch4 threshold 0.1 Acc 0.9144736842105263, AUC 0.978065550327301, avg_entr 0.037061985582113266
ep4_t0.1_test_time 0.17315077781677246
gc 0
Train Epoch5 Acc 0.43561666666666665 (52274/120000), AUC 0.747594952583313
ep5_train_time 6.771472454071045
Test Epoch5 threshold 0.1 Acc 0.9142105263157895, AUC 0.9779226183891296, avg_entr 0.036509186029434204
ep5_t0.1_test_time 0.17272233963012695
gc 0
Train Epoch6 Acc 0.44024166666666664 (52829/120000), AUC 0.7508339881896973
ep6_train_time 6.777693271636963
Test Epoch6 threshold 0.1 Acc 0.9147368421052632, AUC 0.9779543280601501, avg_entr 0.03634028136730194
ep6_t0.1_test_time 0.17383384704589844
gc 0
Train Epoch7 Acc 0.4453666666666667 (53444/120000), AUC 0.7548333406448364
ep7_train_time 6.779772996902466
Test Epoch7 threshold 0.1 Acc 0.9136842105263158, AUC 0.9779945015907288, avg_entr 0.03606894984841347
ep7_t0.1_test_time 0.17306995391845703
gc 0
Train Epoch8 Acc 0.4503666666666667 (54044/120000), AUC 0.7595288753509521
ep8_train_time 6.7729902267456055
Test Epoch8 threshold 0.1 Acc 0.9142105263157895, AUC 0.9778662919998169, avg_entr 0.035646919161081314
ep8_t0.1_test_time 0.17360544204711914
gc 0
Train Epoch9 Acc 0.4547583333333333 (54571/120000), AUC 0.7627137899398804
ep9_train_time 6.797420978546143
Test Epoch9 threshold 0.1 Acc 0.9144736842105263, AUC 0.9778674840927124, avg_entr 0.03588750958442688
ep9_t0.1_test_time 0.1731564998626709
Best AUC 0.9785999655723572
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 70.69629502296448
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m4//ag_news_linearal_l5.pt
Test threshold 0.1 Acc 0.9242105263157895, AUC 0.9846556186676025, avg_entr 0.04506988078355789
t0.1_test_time 0.17317914962768555
