total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 20.527362823486328
Start Training
gc 0
Train Epoch0 Acc 0.7347 (88164/120000), AUC 0.9176393747329712
ep0_train_time 61.041860818862915
Test Epoch0 layer4 Acc 0.9128947368421053, AUC 0.9808165431022644, avg_entr 0.10914980620145798
ep0_l4_test_time 0.5449039936065674
Save ckpt to ckpt/ag_news_lstmal_l5base_pad50//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9266166666666666 (111194/120000), AUC 0.9826904535293579
ep1_train_time 61.560266971588135
Test Epoch1 layer4 Acc 0.9197368421052632, AUC 0.9820384979248047, avg_entr 0.04740680009126663
ep1_l4_test_time 0.5182197093963623
Save ckpt to ckpt/ag_news_lstmal_l5base_pad50//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9375833333333333 (112510/120000), AUC 0.9868221879005432
ep2_train_time 61.48007392883301
Test Epoch2 layer4 Acc 0.9210526315789473, AUC 0.9827826023101807, avg_entr 0.030265258625149727
ep2_l4_test_time 0.5237817764282227
Save ckpt to ckpt/ag_news_lstmal_l5base_pad50//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.943075 (113169/120000), AUC 0.9891684055328369
ep3_train_time 60.51427412033081
Test Epoch3 layer4 Acc 0.9210526315789473, AUC 0.9826962351799011, avg_entr 0.026538196951150894
ep3_l4_test_time 0.5463154315948486
gc 0
Train Epoch4 Acc 0.9475583333333333 (113707/120000), AUC 0.9903585910797119
ep4_train_time 61.50294589996338
Test Epoch4 layer4 Acc 0.9221052631578948, AUC 0.9822306632995605, avg_entr 0.023246821016073227
ep4_l4_test_time 0.527000904083252
gc 0
Train Epoch5 Acc 0.9511166666666667 (114134/120000), AUC 0.9911988377571106
ep5_train_time 61.615620613098145
Test Epoch5 layer4 Acc 0.9202631578947369, AUC 0.981734037399292, avg_entr 0.019908050075173378
ep5_l4_test_time 0.5117475986480713
gc 0
Train Epoch6 Acc 0.9538666666666666 (114464/120000), AUC 0.9918801188468933
ep6_train_time 61.53393340110779
Test Epoch6 layer4 Acc 0.9218421052631579, AUC 0.9812244772911072, avg_entr 0.020768102258443832
ep6_l4_test_time 0.5335986614227295
gc 0
Train Epoch7 Acc 0.9565166666666667 (114782/120000), AUC 0.9925653338432312
ep7_train_time 60.704015254974365
Test Epoch7 layer4 Acc 0.9173684210526316, AUC 0.9794034957885742, avg_entr 0.014789197593927383
ep7_l4_test_time 0.5338196754455566
gc 0
Train Epoch8 Acc 0.9586166666666667 (115034/120000), AUC 0.9929782748222351
ep8_train_time 61.40308499336243
Test Epoch8 layer4 Acc 0.9189473684210526, AUC 0.9807208776473999, avg_entr 0.0168050117790699
ep8_l4_test_time 0.5149803161621094
gc 0
Train Epoch9 Acc 0.9607333333333333 (115288/120000), AUC 0.9934254884719849
ep9_train_time 61.716705560684204
Test Epoch9 layer4 Acc 0.91, AUC 0.9795931577682495, avg_entr 0.014782214537262917
ep9_l4_test_time 0.5162487030029297
gc 0
Train Epoch10 Acc 0.9628666666666666 (115544/120000), AUC 0.9938056468963623
ep10_train_time 60.66842079162598
Test Epoch10 layer4 Acc 0.9155263157894736, AUC 0.9794061779975891, avg_entr 0.01621929742395878
ep10_l4_test_time 0.4705793857574463
gc 0
Train Epoch11 Acc 0.964475 (115737/120000), AUC 0.9940873980522156
ep11_train_time 61.561179876327515
Test Epoch11 layer4 Acc 0.9157894736842105, AUC 0.9793241024017334, avg_entr 0.012346767820417881
ep11_l4_test_time 0.5211668014526367
gc 0
Train Epoch12 Acc 0.965975 (115917/120000), AUC 0.9943322539329529
ep12_train_time 61.45589017868042
Test Epoch12 layer4 Acc 0.9118421052631579, AUC 0.9790716767311096, avg_entr 0.011512644588947296
ep12_l4_test_time 0.5196504592895508
gc 0
Train Epoch13 Acc 0.9677333333333333 (116128/120000), AUC 0.9945145845413208
ep13_train_time 61.55249810218811
Test Epoch13 layer4 Acc 0.9123684210526316, AUC 0.9779055118560791, avg_entr 0.01085690688341856
ep13_l4_test_time 0.5195915699005127
gc 0
Train Epoch14 Acc 0.9695416666666666 (116345/120000), AUC 0.9946739077568054
ep14_train_time 60.654598236083984
Test Epoch14 layer4 Acc 0.9089473684210526, AUC 0.9771901369094849, avg_entr 0.010397730395197868
ep14_l4_test_time 0.529609203338623
gc 0
Train Epoch15 Acc 0.9713166666666667 (116558/120000), AUC 0.9948656558990479
ep15_train_time 61.3452730178833
Test Epoch15 layer4 Acc 0.9110526315789473, AUC 0.9769471883773804, avg_entr 0.010452274233102798
ep15_l4_test_time 0.5241127014160156
gc 0
Train Epoch16 Acc 0.9725 (116700/120000), AUC 0.9949944019317627
ep16_train_time 61.523303508758545
Test Epoch16 layer4 Acc 0.91, AUC 0.9760558605194092, avg_entr 0.008583077229559422
ep16_l4_test_time 0.5329134464263916
gc 0
Train Epoch17 Acc 0.9743416666666667 (116921/120000), AUC 0.9950213432312012
ep17_train_time 61.05926489830017
Test Epoch17 layer4 Acc 0.9123684210526316, AUC 0.9744481444358826, avg_entr 0.007648406084626913
ep17_l4_test_time 0.47769880294799805
gc 0
Train Epoch18 Acc 0.9759416666666667 (117113/120000), AUC 0.9953833818435669
ep18_train_time 61.172990560531616
Test Epoch18 layer4 Acc 0.91, AUC 0.9730938076972961, avg_entr 0.007259794510900974
ep18_l4_test_time 0.516148567199707
gc 0
Train Epoch19 Acc 0.9777083333333333 (117325/120000), AUC 0.9954611659049988
ep19_train_time 61.40601086616516
Test Epoch19 layer4 Acc 0.9086842105263158, AUC 0.9723940491676331, avg_entr 0.006125439424067736
ep19_l4_test_time 0.5282611846923828
gc 0
Train Epoch20 Acc 0.9788333333333333 (117460/120000), AUC 0.9956294298171997
ep20_train_time 61.63576698303223
Test Epoch20 layer4 Acc 0.9073684210526316, AUC 0.9724354147911072, avg_entr 0.007503216620534658
ep20_l4_test_time 0.5319898128509521
gc 0
Train Epoch21 Acc 0.9805416666666666 (117665/120000), AUC 0.9956934452056885
ep21_train_time 60.90225648880005
Test Epoch21 layer4 Acc 0.905, AUC 0.9710217118263245, avg_entr 0.00612688111141324
ep21_l4_test_time 0.520993709564209
gc 0
Train Epoch22 Acc 0.9815166666666667 (117782/120000), AUC 0.9958835244178772
ep22_train_time 61.470341205596924
Test Epoch22 layer4 Acc 0.9036842105263158, AUC 0.9704365134239197, avg_entr 0.007970704697072506
ep22_l4_test_time 0.5342531204223633
gc 0
Train Epoch23 Acc 0.9826583333333333 (117919/120000), AUC 0.9959709048271179
ep23_train_time 61.57364082336426
Test Epoch23 layer4 Acc 0.9055263157894737, AUC 0.9702554941177368, avg_entr 0.0051770457066595554
ep23_l4_test_time 0.5293540954589844
gc 0
Train Epoch24 Acc 0.983775 (118053/120000), AUC 0.9961146712303162
ep24_train_time 61.35199809074402
Test Epoch24 layer4 Acc 0.9023684210526316, AUC 0.9681564569473267, avg_entr 0.006839841604232788
ep24_l4_test_time 0.4270446300506592
gc 0
Train Epoch25 Acc 0.984675 (118161/120000), AUC 0.9962256550788879
ep25_train_time 61.13645601272583
Test Epoch25 layer4 Acc 0.9039473684210526, AUC 0.9691979885101318, avg_entr 0.005836558993905783
ep25_l4_test_time 0.5241572856903076
gc 0
Train Epoch26 Acc 0.9850583333333334 (118207/120000), AUC 0.9962746500968933
ep26_train_time 61.643954277038574
Test Epoch26 layer4 Acc 0.9023684210526316, AUC 0.9667128324508667, avg_entr 0.0052269818261265755
ep26_l4_test_time 0.5174350738525391
gc 0
Train Epoch27 Acc 0.9864166666666667 (118370/120000), AUC 0.9964715838432312
ep27_train_time 61.58055281639099
Test Epoch27 layer4 Acc 0.9076315789473685, AUC 0.965965211391449, avg_entr 0.0053906915709376335
ep27_l4_test_time 0.5310792922973633
gc 0
Train Epoch28 Acc 0.9868 (118416/120000), AUC 0.996454119682312
ep28_train_time 60.76461887359619
Test Epoch28 layer4 Acc 0.8986842105263158, AUC 0.9665756225585938, avg_entr 0.006107210647314787
ep28_l4_test_time 0.5336260795593262
gc 0
Train Epoch29 Acc 0.98735 (118482/120000), AUC 0.9965603351593018
ep29_train_time 61.59481430053711
Test Epoch29 layer4 Acc 0.9013157894736842, AUC 0.9654353857040405, avg_entr 0.003787163645029068
ep29_l4_test_time 0.5263018608093262
gc 0
Train Epoch30 Acc 0.9879416666666667 (118553/120000), AUC 0.996650218963623
ep30_train_time 61.52980136871338
Test Epoch30 layer4 Acc 0.9018421052631579, AUC 0.9671838879585266, avg_entr 0.006265079602599144
ep30_l4_test_time 0.5275321006774902
gc 0
Train Epoch31 Acc 0.98835 (118602/120000), AUC 0.9967674612998962
ep31_train_time 61.471495389938354
Test Epoch31 layer4 Acc 0.9026315789473685, AUC 0.9663147330284119, avg_entr 0.005222802050411701
ep31_l4_test_time 0.4188687801361084
gc 0
Train Epoch32 Acc 0.9888166666666667 (118658/120000), AUC 0.9968255758285522
ep32_train_time 60.743366956710815
Test Epoch32 layer4 Acc 0.8989473684210526, AUC 0.9644408822059631, avg_entr 0.005247201304882765
ep32_l4_test_time 0.529055118560791
gc 0
Train Epoch33 Acc 0.9893166666666666 (118718/120000), AUC 0.9968754053115845
ep33_train_time 61.56759333610535
Test Epoch33 layer4 Acc 0.9005263157894737, AUC 0.96494460105896, avg_entr 0.004906547721475363
ep33_l4_test_time 0.5243299007415771
gc 0
Train Epoch34 Acc 0.9896916666666666 (118763/120000), AUC 0.9969298243522644
ep34_train_time 61.58275270462036
Test Epoch34 layer4 Acc 0.9002631578947369, AUC 0.965587854385376, avg_entr 0.004758036229759455
ep34_l4_test_time 0.5219032764434814
gc 0
Train Epoch35 Acc 0.9898666666666667 (118784/120000), AUC 0.9970623254776001
ep35_train_time 60.75926065444946
Test Epoch35 layer4 Acc 0.8973684210526316, AUC 0.9636173844337463, avg_entr 0.004057031124830246
ep35_l4_test_time 0.5410428047180176
gc 0
Train Epoch36 Acc 0.9901583333333334 (118819/120000), AUC 0.99709552526474
ep36_train_time 61.529237031936646
Test Epoch36 layer4 Acc 0.8968421052631579, AUC 0.965036153793335, avg_entr 0.004737538751214743
ep36_l4_test_time 0.5211987495422363
gc 0
Train Epoch37 Acc 0.990425 (118851/120000), AUC 0.9972059726715088
ep37_train_time 61.51859736442566
Test Epoch37 layer4 Acc 0.9, AUC 0.962874174118042, avg_entr 0.004476055037230253
ep37_l4_test_time 0.5321285724639893
gc 0
Train Epoch38 Acc 0.9907166666666667 (118886/120000), AUC 0.9971543550491333
ep38_train_time 61.61739754676819
Test Epoch38 layer4 Acc 0.9002631578947369, AUC 0.9625900387763977, avg_entr 0.004850227851420641
ep38_l4_test_time 0.5280818939208984
gc 0
Train Epoch39 Acc 0.99095 (118914/120000), AUC 0.9972953200340271
ep39_train_time 60.754554748535156
Test Epoch39 layer4 Acc 0.8986842105263158, AUC 0.9628929495811462, avg_entr 0.004187409300357103
ep39_l4_test_time 0.5236334800720215
gc 0
Train Epoch40 Acc 0.9911166666666666 (118934/120000), AUC 0.9974120855331421
ep40_train_time 61.55925440788269
Test Epoch40 layer4 Acc 0.8984210526315789, AUC 0.9620086550712585, avg_entr 0.004495146684348583
ep40_l4_test_time 0.5206747055053711
gc 0
Train Epoch41 Acc 0.9914 (118968/120000), AUC 0.9973458051681519
ep41_train_time 61.5308780670166
Test Epoch41 layer4 Acc 0.9010526315789473, AUC 0.9632956981658936, avg_entr 0.004024443682283163
ep41_l4_test_time 0.5143637657165527
gc 0
Train Epoch42 Acc 0.9917166666666667 (119006/120000), AUC 0.9975839257240295
ep42_train_time 60.837464332580566
Test Epoch42 layer4 Acc 0.8976315789473684, AUC 0.9608299732208252, avg_entr 0.00427381694316864
ep42_l4_test_time 0.504725456237793
gc 0
Train Epoch43 Acc 0.9917666666666667 (119012/120000), AUC 0.9975512027740479
ep43_train_time 61.508453130722046
Test Epoch43 layer4 Acc 0.8984210526315789, AUC 0.9626110792160034, avg_entr 0.0032543709967285395
ep43_l4_test_time 0.5173079967498779
gc 0
Train Epoch44 Acc 0.992075 (119049/120000), AUC 0.9975756406784058
ep44_train_time 61.447269439697266
Test Epoch44 layer4 Acc 0.8973684210526316, AUC 0.9597222208976746, avg_entr 0.004915730096399784
ep44_l4_test_time 0.5344195365905762
gc 0
Train Epoch45 Acc 0.9921333333333333 (119056/120000), AUC 0.9976003170013428
ep45_train_time 61.6231803894043
Test Epoch45 layer4 Acc 0.896578947368421, AUC 0.9592702984809875, avg_entr 0.004114354494959116
ep45_l4_test_time 0.5336647033691406
gc 0
Train Epoch46 Acc 0.9922583333333334 (119071/120000), AUC 0.9975762963294983
ep46_train_time 60.82213115692139
Test Epoch46 layer4 Acc 0.895, AUC 0.9604367613792419, avg_entr 0.003995123784989119
ep46_l4_test_time 0.5237281322479248
gc 0
Train Epoch47 Acc 0.99255 (119106/120000), AUC 0.9975501298904419
ep47_train_time 61.625887870788574
Test Epoch47 layer4 Acc 0.8971052631578947, AUC 0.9580555558204651, avg_entr 0.004466279875487089
ep47_l4_test_time 0.5246930122375488
gc 0
Train Epoch48 Acc 0.9924916666666667 (119099/120000), AUC 0.997509241104126
ep48_train_time 61.58983135223389
Test Epoch48 layer4 Acc 0.9005263157894737, AUC 0.9582585096359253, avg_entr 0.003207020927220583
ep48_l4_test_time 0.5388989448547363
gc 0
Train Epoch49 Acc 0.9927666666666667 (119132/120000), AUC 0.9976503849029541
ep49_train_time 60.877132177352905
Test Epoch49 layer4 Acc 0.8971052631578947, AUC 0.9589456915855408, avg_entr 0.003487539244815707
ep49_l4_test_time 0.5410692691802979
Best AUC 0.9827826023101807
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 3094.6872384548187
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad50//ag_news_lstmal_l5.pt
Test layer4 Acc 0.9097368421052632, AUC 0.9806265830993652, avg_entr 0.03617292642593384
l4_test_time 0.5075187683105469
