total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 20.23960828781128
Start Training
gc 0
Train Epoch0 Acc 0.7239583333333334 (86875/120000), AUC 0.9134221076965332
ep0_train_time 142.97494554519653
Test Epoch0 layer4 Acc 0.906578947368421, AUC 0.9788519144058228, avg_entr 0.11944589763879776
ep0_l4_test_time 1.267136573791504
Save ckpt to ckpt/ag_news_lstmal_l5base_pad150//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9214583333333334 (110575/120000), AUC 0.9820984601974487
ep1_train_time 143.02176308631897
Test Epoch1 layer4 Acc 0.9186842105263158, AUC 0.9838842153549194, avg_entr 0.05312104895710945
ep1_l4_test_time 1.2365765571594238
Save ckpt to ckpt/ag_news_lstmal_l5base_pad150//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9324666666666667 (111896/120000), AUC 0.9870080947875977
ep2_train_time 142.15416145324707
Test Epoch2 layer4 Acc 0.92, AUC 0.9839463829994202, avg_entr 0.035916369408369064
ep2_l4_test_time 1.2482168674468994
Save ckpt to ckpt/ag_news_lstmal_l5base_pad150//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9398333333333333 (112780/120000), AUC 0.9894422292709351
ep3_train_time 143.19837403297424
Test Epoch3 layer4 Acc 0.9197368421052632, AUC 0.9836775660514832, avg_entr 0.027260497212409973
ep3_l4_test_time 1.2337079048156738
gc 0
Train Epoch4 Acc 0.9447166666666666 (113366/120000), AUC 0.9908972978591919
ep4_train_time 142.50619626045227
Test Epoch4 layer4 Acc 0.9202631578947369, AUC 0.9833799600601196, avg_entr 0.02482954040169716
ep4_l4_test_time 1.2651171684265137
gc 0
Train Epoch5 Acc 0.9481416666666667 (113777/120000), AUC 0.9919438362121582
ep5_train_time 142.63180923461914
Test Epoch5 layer4 Acc 0.9181578947368421, AUC 0.9826311469078064, avg_entr 0.02069307118654251
ep5_l4_test_time 1.2540700435638428
gc 0
Train Epoch6 Acc 0.9517916666666667 (114215/120000), AUC 0.9929032921791077
ep6_train_time 142.56743264198303
Test Epoch6 layer4 Acc 0.9157894736842105, AUC 0.9826246500015259, avg_entr 0.01823190227150917
ep6_l4_test_time 1.2365739345550537
gc 0
Train Epoch7 Acc 0.9540416666666667 (114485/120000), AUC 0.9933457970619202
ep7_train_time 141.7014935016632
Test Epoch7 layer4 Acc 0.9184210526315789, AUC 0.9825500845909119, avg_entr 0.019992105662822723
ep7_l4_test_time 1.2387123107910156
gc 0
Train Epoch8 Acc 0.9566083333333333 (114793/120000), AUC 0.9938846826553345
ep8_train_time 142.3427975177765
Test Epoch8 layer4 Acc 0.9160526315789473, AUC 0.9810146689414978, avg_entr 0.015210490673780441
ep8_l4_test_time 1.255014419555664
gc 0
Train Epoch9 Acc 0.9588416666666667 (115061/120000), AUC 0.9940908551216125
ep9_train_time 141.74447560310364
Test Epoch9 layer4 Acc 0.9152631578947369, AUC 0.9813247323036194, avg_entr 0.01418703980743885
ep9_l4_test_time 1.235271692276001
gc 0
Train Epoch10 Acc 0.96015 (115218/120000), AUC 0.9944855570793152
ep10_train_time 141.691978931427
Test Epoch10 layer4 Acc 0.9147368421052632, AUC 0.9802067279815674, avg_entr 0.013044120743870735
ep10_l4_test_time 1.2329366207122803
gc 0
Train Epoch11 Acc 0.9623666666666667 (115484/120000), AUC 0.9947720170021057
ep11_train_time 142.55533051490784
Test Epoch11 layer4 Acc 0.9139473684210526, AUC 0.9800206422805786, avg_entr 0.012121080420911312
ep11_l4_test_time 1.2507238388061523
gc 0
Train Epoch12 Acc 0.9637833333333333 (115654/120000), AUC 0.994952380657196
ep12_train_time 142.0556652545929
Test Epoch12 layer4 Acc 0.9142105263157895, AUC 0.980202317237854, avg_entr 0.010544756427407265
ep12_l4_test_time 1.24629545211792
gc 0
Train Epoch13 Acc 0.9656 (115872/120000), AUC 0.9951666593551636
ep13_train_time 142.44884037971497
Test Epoch13 layer4 Acc 0.911578947368421, AUC 0.9786156415939331, avg_entr 0.010632781311869621
ep13_l4_test_time 1.236891746520996
gc 0
Train Epoch14 Acc 0.9673333333333334 (116080/120000), AUC 0.9953522682189941
ep14_train_time 141.6608328819275
Test Epoch14 layer4 Acc 0.9134210526315789, AUC 0.9793567657470703, avg_entr 0.01090096216648817
ep14_l4_test_time 1.2391870021820068
gc 0
Train Epoch15 Acc 0.9688833333333333 (116266/120000), AUC 0.9953193664550781
ep15_train_time 142.44293022155762
Test Epoch15 layer4 Acc 0.9126315789473685, AUC 0.9774291515350342, avg_entr 0.008713260293006897
ep15_l4_test_time 1.2493479251861572
gc 0
Train Epoch16 Acc 0.9706 (116472/120000), AUC 0.9953774809837341
ep16_train_time 141.91613101959229
Test Epoch16 layer4 Acc 0.9102631578947369, AUC 0.9749099016189575, avg_entr 0.00794562604278326
ep16_l4_test_time 1.250328540802002
gc 0
Train Epoch17 Acc 0.9722166666666666 (116666/120000), AUC 0.995402455329895
ep17_train_time 141.6630334854126
Test Epoch17 layer4 Acc 0.9073684210526316, AUC 0.975483775138855, avg_entr 0.008269465528428555
ep17_l4_test_time 1.2346091270446777
gc 0
Train Epoch18 Acc 0.9740083333333334 (116881/120000), AUC 0.9955011606216431
ep18_train_time 142.3921980857849
Test Epoch18 layer4 Acc 0.9094736842105263, AUC 0.9735018014907837, avg_entr 0.007773841265588999
ep18_l4_test_time 1.2473783493041992
gc 0
Train Epoch19 Acc 0.9752 (117024/120000), AUC 0.9955736994743347
ep19_train_time 141.5435757637024
Test Epoch19 layer4 Acc 0.9076315789473685, AUC 0.9715998768806458, avg_entr 0.00654907850548625
ep19_l4_test_time 1.2309150695800781
gc 0
Train Epoch20 Acc 0.9768666666666667 (117224/120000), AUC 0.9956716895103455
ep20_train_time 142.03897070884705
Test Epoch20 layer4 Acc 0.9086842105263158, AUC 0.9707093238830566, avg_entr 0.006325869355350733
ep20_l4_test_time 1.2628583908081055
gc 0
Train Epoch21 Acc 0.9780916666666667 (117371/120000), AUC 0.9956738352775574
ep21_train_time 141.8049852848053
Test Epoch21 layer4 Acc 0.9031578947368422, AUC 0.9716063737869263, avg_entr 0.0067060403525829315
ep21_l4_test_time 1.259995460510254
gc 0
Train Epoch22 Acc 0.97945 (117534/120000), AUC 0.9958478808403015
ep22_train_time 142.39266920089722
Test Epoch22 layer4 Acc 0.9060526315789473, AUC 0.9697186946868896, avg_entr 0.005553170572966337
ep22_l4_test_time 1.188126802444458
gc 0
Train Epoch23 Acc 0.980825 (117699/120000), AUC 0.9959189891815186
ep23_train_time 141.7604160308838
Test Epoch23 layer4 Acc 0.9055263157894737, AUC 0.9680492281913757, avg_entr 0.00573930935934186
ep23_l4_test_time 1.2141592502593994
gc 0
Train Epoch24 Acc 0.9819833333333333 (117838/120000), AUC 0.9959137439727783
ep24_train_time 141.93621730804443
Test Epoch24 layer4 Acc 0.905, AUC 0.9662960171699524, avg_entr 0.004926836583763361
ep24_l4_test_time 1.2418429851531982
gc 0
Train Epoch25 Acc 0.9830166666666666 (117962/120000), AUC 0.9960828423500061
ep25_train_time 142.41555762290955
Test Epoch25 layer4 Acc 0.9047368421052632, AUC 0.9662026166915894, avg_entr 0.006531707011163235
ep25_l4_test_time 1.2370846271514893
gc 0
Train Epoch26 Acc 0.9838916666666667 (118067/120000), AUC 0.99611896276474
ep26_train_time 141.76088047027588
Test Epoch26 layer4 Acc 0.9044736842105263, AUC 0.9668155312538147, avg_entr 0.005067615304142237
ep26_l4_test_time 1.2516911029815674
gc 0
Train Epoch27 Acc 0.9848333333333333 (118180/120000), AUC 0.9963487386703491
ep27_train_time 142.88155126571655
Test Epoch27 layer4 Acc 0.8992105263157895, AUC 0.9652458429336548, avg_entr 0.005206345580518246
ep27_l4_test_time 1.2383143901824951
gc 0
Train Epoch28 Acc 0.9855166666666667 (118262/120000), AUC 0.9962804913520813
ep28_train_time 142.56044793128967
Test Epoch28 layer4 Acc 0.9073684210526316, AUC 0.9661383628845215, avg_entr 0.004463184159249067
ep28_l4_test_time 1.2399237155914307
gc 0
Train Epoch29 Acc 0.9864333333333334 (118372/120000), AUC 0.9964020252227783
ep29_train_time 141.9480369091034
Test Epoch29 layer4 Acc 0.9026315789473685, AUC 0.9636957049369812, avg_entr 0.004440391436219215
ep29_l4_test_time 1.2502734661102295
gc 0
Train Epoch30 Acc 0.987 (118440/120000), AUC 0.9964262247085571
ep30_train_time 142.39575600624084
Test Epoch30 layer4 Acc 0.901578947368421, AUC 0.962452232837677, avg_entr 0.004759415052831173
ep30_l4_test_time 1.227564811706543
gc 0
Train Epoch31 Acc 0.9876 (118512/120000), AUC 0.9965463876724243
ep31_train_time 141.70075726509094
Test Epoch31 layer4 Acc 0.9021052631578947, AUC 0.9603664875030518, avg_entr 0.003926606383174658
ep31_l4_test_time 1.2544009685516357
gc 0
Train Epoch32 Acc 0.9879916666666667 (118559/120000), AUC 0.9964980483055115
ep32_train_time 142.4266791343689
Test Epoch32 layer4 Acc 0.9057894736842105, AUC 0.9618540406227112, avg_entr 0.0038990157190710306
ep32_l4_test_time 1.260840892791748
gc 0
Train Epoch33 Acc 0.988525 (118623/120000), AUC 0.9966989755630493
ep33_train_time 141.71607995033264
Test Epoch33 layer4 Acc 0.9023684210526316, AUC 0.9612870812416077, avg_entr 0.00438722874969244
ep33_l4_test_time 1.2372286319732666
gc 0
Train Epoch34 Acc 0.988925 (118671/120000), AUC 0.9967416524887085
ep34_train_time 142.37903237342834
Test Epoch34 layer4 Acc 0.9039473684210526, AUC 0.9622980952262878, avg_entr 0.0035023370292037725
ep34_l4_test_time 1.2480573654174805
gc 0
Train Epoch35 Acc 0.9894166666666667 (118730/120000), AUC 0.9967532753944397
ep35_train_time 141.64326190948486
Test Epoch35 layer4 Acc 0.9013157894736842, AUC 0.9607524871826172, avg_entr 0.003965368494391441
ep35_l4_test_time 1.2324936389923096
gc 0
Train Epoch36 Acc 0.9898416666666666 (118781/120000), AUC 0.9968908429145813
ep36_train_time 141.82646560668945
Test Epoch36 layer4 Acc 0.901578947368421, AUC 0.9613881707191467, avg_entr 0.004398745484650135
ep36_l4_test_time 1.2396743297576904
gc 0
Train Epoch37 Acc 0.98975 (118770/120000), AUC 0.9969327449798584
ep37_train_time 142.23181319236755
Test Epoch37 layer4 Acc 0.8984210526315789, AUC 0.9620818495750427, avg_entr 0.004363799002021551
ep37_l4_test_time 1.26401686668396
gc 0
Train Epoch38 Acc 0.9902416666666667 (118829/120000), AUC 0.9970856308937073
ep38_train_time 141.67032027244568
Test Epoch38 layer4 Acc 0.9002631578947369, AUC 0.9617795944213867, avg_entr 0.004323581233620644
ep38_l4_test_time 1.2627766132354736
gc 0
Train Epoch39 Acc 0.9905833333333334 (118870/120000), AUC 0.9971988201141357
ep39_train_time 142.32564496994019
Test Epoch39 layer4 Acc 0.9034210526315789, AUC 0.9610522389411926, avg_entr 0.004921879153698683
ep39_l4_test_time 1.2571382522583008
gc 0
Train Epoch40 Acc 0.990775 (118893/120000), AUC 0.9972295761108398
ep40_train_time 141.65934371948242
Test Epoch40 layer4 Acc 0.9013157894736842, AUC 0.9597198963165283, avg_entr 0.0043248375877738
ep40_l4_test_time 1.252166986465454
gc 0
Train Epoch41 Acc 0.9910666666666667 (118928/120000), AUC 0.9972211718559265
ep41_train_time 142.41115283966064
Test Epoch41 layer4 Acc 0.9036842105263158, AUC 0.9596173763275146, avg_entr 0.004243111703544855
ep41_l4_test_time 1.2659893035888672
gc 0
Train Epoch42 Acc 0.9911166666666666 (118934/120000), AUC 0.9972803592681885
ep42_train_time 84.24869894981384
Test Epoch42 layer4 Acc 0.9036842105263158, AUC 0.9566285610198975, avg_entr 0.0026662645395845175
ep42_l4_test_time 1.2564728260040283
gc 0
Train Epoch43 Acc 0.9913916666666667 (118967/120000), AUC 0.9972002506256104
ep43_train_time 142.34408712387085
Test Epoch43 layer4 Acc 0.8978947368421053, AUC 0.9583010077476501, avg_entr 0.00496206758543849
ep43_l4_test_time 1.242826223373413
gc 0
Train Epoch44 Acc 0.9916083333333333 (118993/120000), AUC 0.9974019527435303
ep44_train_time 141.77819323539734
Test Epoch44 layer4 Acc 0.9031578947368422, AUC 0.9609030485153198, avg_entr 0.00365150417201221
ep44_l4_test_time 1.2416350841522217
gc 0
Train Epoch45 Acc 0.9918916666666666 (119027/120000), AUC 0.9974822402000427
ep45_train_time 142.5167100429535
Test Epoch45 layer4 Acc 0.9042105263157895, AUC 0.961364209651947, avg_entr 0.0040090372785925865
ep45_l4_test_time 1.2378020286560059
gc 0
Train Epoch46 Acc 0.9921 (119052/120000), AUC 0.9974322319030762
ep46_train_time 141.7175121307373
Test Epoch46 layer4 Acc 0.9052631578947369, AUC 0.9603159427642822, avg_entr 0.004058650229126215
ep46_l4_test_time 1.2129416465759277
gc 0
Train Epoch47 Acc 0.992375 (119085/120000), AUC 0.9976532459259033
ep47_train_time 142.2973506450653
Test Epoch47 layer4 Acc 0.9021052631578947, AUC 0.9584794640541077, avg_entr 0.0035498468205332756
ep47_l4_test_time 1.275691270828247
gc 0
Train Epoch48 Acc 0.992575 (119109/120000), AUC 0.9976059794425964
ep48_train_time 141.82293033599854
Test Epoch48 layer4 Acc 0.8963157894736842, AUC 0.958670973777771, avg_entr 0.004197103437036276
ep48_l4_test_time 1.2615382671356201
gc 0
Train Epoch49 Acc 0.9926416666666666 (119117/120000), AUC 0.9976427555084229
ep49_train_time 142.4216024875641
Test Epoch49 layer4 Acc 0.9021052631578947, AUC 0.9615381956100464, avg_entr 0.004435073584318161
ep49_l4_test_time 1.2613577842712402
Best AUC 0.9839463829994202
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 7115.604364156723
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad150//ag_news_lstmal_l5.pt
Test layer4 Acc 0.9076315789473685, AUC 0.982193112373352, avg_entr 0.042290449142456055
l4_test_time 1.2860617637634277
