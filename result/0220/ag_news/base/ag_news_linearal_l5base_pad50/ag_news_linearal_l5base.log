total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.281155109405518
Start Training
gc 0
Train Epoch0 Acc 0.7208083333333334 (86497/120000), AUC 0.911650538444519
ep0_train_time 19.261061191558838
Test Epoch0 layer4 Acc 0.9126315789473685, AUC 0.9806331992149353, avg_entr 0.1921657770872116
ep0_l4_test_time 0.21503376960754395
Save ckpt to ckpt/ag_news_linearal_l5base_pad50//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9273916666666666 (111287/120000), AUC 0.9855747222900391
ep1_train_time 19.785258531570435
Test Epoch1 layer4 Acc 0.9178947368421052, AUC 0.983274519443512, avg_entr 0.10889479517936707
ep1_l4_test_time 0.22804546356201172
Save ckpt to ckpt/ag_news_linearal_l5base_pad50//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9363333333333334 (112360/120000), AUC 0.9893957376480103
ep2_train_time 19.777479648590088
Test Epoch2 layer4 Acc 0.9242105263157895, AUC 0.9842581748962402, avg_entr 0.06884010136127472
ep2_l4_test_time 0.21959638595581055
Save ckpt to ckpt/ag_news_linearal_l5base_pad50//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.94125 (112950/120000), AUC 0.9910222887992859
ep3_train_time 19.76016068458557
Test Epoch3 layer4 Acc 0.9234210526315789, AUC 0.9835630059242249, avg_entr 0.045697081834077835
ep3_l4_test_time 0.21347713470458984
gc 0
Train Epoch4 Acc 0.9445333333333333 (113344/120000), AUC 0.9916963577270508
ep4_train_time 19.6232693195343
Test Epoch4 layer4 Acc 0.9234210526315789, AUC 0.9836704134941101, avg_entr 0.0318659245967865
ep4_l4_test_time 0.22359871864318848
gc 0
Train Epoch5 Acc 0.94665 (113598/120000), AUC 0.9918693900108337
ep5_train_time 19.604737520217896
Test Epoch5 layer4 Acc 0.9239473684210526, AUC 0.9831299781799316, avg_entr 0.02694695070385933
ep5_l4_test_time 0.21715426445007324
gc 0
Train Epoch6 Acc 0.9484 (113808/120000), AUC 0.9924408793449402
ep6_train_time 19.782491445541382
Test Epoch6 layer4 Acc 0.92, AUC 0.980830729007721, avg_entr 0.025584939867258072
ep6_l4_test_time 0.22530722618103027
gc 0
Train Epoch7 Acc 0.949875 (113985/120000), AUC 0.9930151104927063
ep7_train_time 18.284175634384155
Test Epoch7 layer4 Acc 0.9194736842105263, AUC 0.9822337031364441, avg_entr 0.022288689389824867
ep7_l4_test_time 0.2252812385559082
gc 0
Train Epoch8 Acc 0.9510583333333333 (114127/120000), AUC 0.9935621619224548
ep8_train_time 19.665226459503174
Test Epoch8 layer4 Acc 0.9202631578947369, AUC 0.981228768825531, avg_entr 0.02052903361618519
ep8_l4_test_time 0.21563243865966797
gc 0
Train Epoch9 Acc 0.952 (114240/120000), AUC 0.9937630295753479
ep9_train_time 19.76071858406067
Test Epoch9 layer4 Acc 0.9205263157894736, AUC 0.9818953275680542, avg_entr 0.019416440278291702
ep9_l4_test_time 0.21931862831115723
gc 0
Train Epoch10 Acc 0.9532583333333333 (114391/120000), AUC 0.9939990639686584
ep10_train_time 19.757893085479736
Test Epoch10 layer4 Acc 0.9197368421052632, AUC 0.9823873043060303, avg_entr 0.017296504229307175
ep10_l4_test_time 0.21538972854614258
gc 0
Train Epoch11 Acc 0.9538666666666666 (114464/120000), AUC 0.9943788051605225
ep11_train_time 19.6187584400177
Test Epoch11 layer4 Acc 0.9210526315789473, AUC 0.9822449684143066, avg_entr 0.01602363958954811
ep11_l4_test_time 0.22439026832580566
gc 0
Train Epoch12 Acc 0.95425 (114510/120000), AUC 0.9944199323654175
ep12_train_time 19.790567874908447
Test Epoch12 layer4 Acc 0.9223684210526316, AUC 0.9826433658599854, avg_entr 0.016224408522248268
ep12_l4_test_time 0.23236918449401855
gc 0
Train Epoch13 Acc 0.9546083333333333 (114553/120000), AUC 0.9946819543838501
ep13_train_time 19.7502224445343
Test Epoch13 layer4 Acc 0.9202631578947369, AUC 0.9811272621154785, avg_entr 0.014913449995219707
ep13_l4_test_time 0.2352743148803711
gc 0
Train Epoch14 Acc 0.9556833333333333 (114682/120000), AUC 0.9949160218238831
ep14_train_time 18.25162363052368
Test Epoch14 layer4 Acc 0.9186842105263158, AUC 0.9820027351379395, avg_entr 0.014523675665259361
ep14_l4_test_time 0.21614837646484375
gc 0
Train Epoch15 Acc 0.955925 (114711/120000), AUC 0.9950093030929565
ep15_train_time 19.6741201877594
Test Epoch15 layer4 Acc 0.9192105263157895, AUC 0.980957567691803, avg_entr 0.01446433737874031
ep15_l4_test_time 0.21632623672485352
gc 0
Train Epoch16 Acc 0.9563583333333333 (114763/120000), AUC 0.9950631856918335
ep16_train_time 19.58852744102478
Test Epoch16 layer4 Acc 0.9173684210526316, AUC 0.9817261695861816, avg_entr 0.014115857891738415
ep16_l4_test_time 0.21662473678588867
gc 0
Train Epoch17 Acc 0.95715 (114858/120000), AUC 0.9951010942459106
ep17_train_time 19.548639059066772
Test Epoch17 layer4 Acc 0.9192105263157895, AUC 0.9812387824058533, avg_entr 0.013030195608735085
ep17_l4_test_time 0.21916866302490234
gc 0
Train Epoch18 Acc 0.9581166666666666 (114974/120000), AUC 0.9951992034912109
ep18_train_time 19.67760729789734
Test Epoch18 layer4 Acc 0.9186842105263158, AUC 0.9802910685539246, avg_entr 0.014375394210219383
ep18_l4_test_time 0.20094704627990723
gc 0
Train Epoch19 Acc 0.958375 (115005/120000), AUC 0.9953608512878418
ep19_train_time 19.656543970108032
Test Epoch19 layer4 Acc 0.9176315789473685, AUC 0.9802347421646118, avg_entr 0.013389858417212963
ep19_l4_test_time 0.21950149536132812
gc 0
Train Epoch20 Acc 0.95865 (115038/120000), AUC 0.9953202605247498
ep20_train_time 19.595336198806763
Test Epoch20 layer4 Acc 0.9178947368421052, AUC 0.9803542494773865, avg_entr 0.014101470820605755
ep20_l4_test_time 0.2103114128112793
gc 0
Train Epoch21 Acc 0.9591166666666666 (115094/120000), AUC 0.9954395890235901
ep21_train_time 18.345139026641846
Test Epoch21 layer4 Acc 0.9171052631578948, AUC 0.9796589016914368, avg_entr 0.011576350778341293
ep21_l4_test_time 0.22354817390441895
gc 0
Train Epoch22 Acc 0.9593833333333334 (115126/120000), AUC 0.9955028295516968
ep22_train_time 19.687914848327637
Test Epoch22 layer4 Acc 0.9176315789473685, AUC 0.9798305034637451, avg_entr 0.012918139807879925
ep22_l4_test_time 0.2295384407043457
gc 0
Train Epoch23 Acc 0.9601416666666667 (115217/120000), AUC 0.9956228733062744
ep23_train_time 19.673774242401123
Test Epoch23 layer4 Acc 0.9181578947368421, AUC 0.9785125851631165, avg_entr 0.012178475968539715
ep23_l4_test_time 0.23465895652770996
gc 0
Train Epoch24 Acc 0.96035 (115242/120000), AUC 0.9957185387611389
ep24_train_time 19.755936861038208
Test Epoch24 layer4 Acc 0.9207894736842105, AUC 0.9791853427886963, avg_entr 0.011049152351915836
ep24_l4_test_time 0.23212146759033203
gc 0
Train Epoch25 Acc 0.9607 (115284/120000), AUC 0.9957213401794434
ep25_train_time 19.639907121658325
Test Epoch25 layer4 Acc 0.916578947368421, AUC 0.9780817031860352, avg_entr 0.01263710018247366
ep25_l4_test_time 0.23487305641174316
gc 0
Train Epoch26 Acc 0.9612916666666667 (115355/120000), AUC 0.9957664608955383
ep26_train_time 19.79423236846924
Test Epoch26 layer4 Acc 0.9171052631578948, AUC 0.9797308444976807, avg_entr 0.010846209712326527
ep26_l4_test_time 0.21903276443481445
gc 0
Train Epoch27 Acc 0.961475 (115377/120000), AUC 0.9958274364471436
ep27_train_time 19.640135765075684
Test Epoch27 layer4 Acc 0.9178947368421052, AUC 0.9781250357627869, avg_entr 0.011476731859147549
ep27_l4_test_time 0.22850894927978516
gc 0
Train Epoch28 Acc 0.9618666666666666 (115424/120000), AUC 0.9958256483078003
ep28_train_time 18.35639786720276
Test Epoch28 layer4 Acc 0.9147368421052632, AUC 0.9787212610244751, avg_entr 0.012371236458420753
ep28_l4_test_time 0.23142790794372559
gc 0
Train Epoch29 Acc 0.9620083333333334 (115441/120000), AUC 0.9959150552749634
ep29_train_time 19.604729413986206
Test Epoch29 layer4 Acc 0.9160526315789473, AUC 0.9787277579307556, avg_entr 0.010852756910026073
ep29_l4_test_time 0.22733259201049805
gc 0
Train Epoch30 Acc 0.9624416666666666 (115493/120000), AUC 0.9959372282028198
ep30_train_time 19.888463973999023
Test Epoch30 layer4 Acc 0.9157894736842105, AUC 0.9770575165748596, avg_entr 0.012129348702728748
ep30_l4_test_time 0.22006845474243164
gc 0
Train Epoch31 Acc 0.9627916666666667 (115535/120000), AUC 0.9960544109344482
ep31_train_time 19.762481689453125
Test Epoch31 layer4 Acc 0.9160526315789473, AUC 0.9774755239486694, avg_entr 0.01198510080575943
ep31_l4_test_time 0.2169780731201172
gc 0
Train Epoch32 Acc 0.962875 (115545/120000), AUC 0.9960616827011108
ep32_train_time 19.633147478103638
Test Epoch32 layer4 Acc 0.9144736842105263, AUC 0.9770116806030273, avg_entr 0.011657148599624634
ep32_l4_test_time 0.2190837860107422
gc 0
Train Epoch33 Acc 0.9634166666666667 (115610/120000), AUC 0.996099591255188
ep33_train_time 19.762267112731934
Test Epoch33 layer4 Acc 0.9155263157894736, AUC 0.9773318767547607, avg_entr 0.011744722723960876
ep33_l4_test_time 0.21927952766418457
gc 0
Train Epoch34 Acc 0.9639166666666666 (115670/120000), AUC 0.9960818886756897
ep34_train_time 19.676966428756714
Test Epoch34 layer4 Acc 0.915, AUC 0.9767202734947205, avg_entr 0.012022281996905804
ep34_l4_test_time 0.22646141052246094
gc 0
Train Epoch35 Acc 0.964175 (115701/120000), AUC 0.9962030053138733
ep35_train_time 11.618184804916382
Test Epoch35 layer4 Acc 0.9136842105263158, AUC 0.9767796993255615, avg_entr 0.011816514655947685
ep35_l4_test_time 0.06453585624694824
gc 0
Train Epoch36 Acc 0.9643666666666667 (115724/120000), AUC 0.9962268471717834
ep36_train_time 6.656792163848877
Test Epoch36 layer4 Acc 0.9152631578947369, AUC 0.9760169386863708, avg_entr 0.012340889312326908
ep36_l4_test_time 0.06609845161437988
gc 0
Train Epoch37 Acc 0.96475 (115770/120000), AUC 0.9963012337684631
ep37_train_time 6.710460901260376
Test Epoch37 layer4 Acc 0.9157894736842105, AUC 0.976823627948761, avg_entr 0.012056021019816399
ep37_l4_test_time 0.06557130813598633
gc 0
Train Epoch38 Acc 0.9649333333333333 (115792/120000), AUC 0.9963990449905396
ep38_train_time 6.6228272914886475
Test Epoch38 layer4 Acc 0.9144736842105263, AUC 0.9765334129333496, avg_entr 0.012813083827495575
ep38_l4_test_time 0.0659184455871582
gc 0
Train Epoch39 Acc 0.9653916666666666 (115847/120000), AUC 0.996399998664856
ep39_train_time 6.638603925704956
Test Epoch39 layer4 Acc 0.9131578947368421, AUC 0.975599467754364, avg_entr 0.011509613133966923
ep39_l4_test_time 0.06616401672363281
gc 0
Train Epoch40 Acc 0.9654666666666667 (115856/120000), AUC 0.9964767098426819
ep40_train_time 6.726219892501831
Test Epoch40 layer4 Acc 0.9134210526315789, AUC 0.9761790633201599, avg_entr 0.011541939340531826
ep40_l4_test_time 0.0660715103149414
gc 0
Train Epoch41 Acc 0.9658333333333333 (115900/120000), AUC 0.9964919686317444
ep41_train_time 6.772684574127197
Test Epoch41 layer4 Acc 0.9128947368421053, AUC 0.9761003255844116, avg_entr 0.012804508209228516
ep41_l4_test_time 0.06550931930541992
gc 0
Train Epoch42 Acc 0.9663333333333334 (115960/120000), AUC 0.9965957999229431
ep42_train_time 6.707040309906006
Test Epoch42 layer4 Acc 0.9131578947368421, AUC 0.9760473370552063, avg_entr 0.013064754195511341
ep42_l4_test_time 0.06567692756652832
gc 0
Train Epoch43 Acc 0.966725 (116007/120000), AUC 0.9965822100639343
ep43_train_time 6.93971061706543
Test Epoch43 layer4 Acc 0.9121052631578948, AUC 0.9758710861206055, avg_entr 0.012211211025714874
ep43_l4_test_time 0.06729435920715332
gc 0
Train Epoch44 Acc 0.9671416666666667 (116057/120000), AUC 0.9966649413108826
ep44_train_time 6.805414438247681
Test Epoch44 layer4 Acc 0.9102631578947369, AUC 0.9755809903144836, avg_entr 0.012903809547424316
ep44_l4_test_time 0.06724810600280762
gc 0
Train Epoch45 Acc 0.9669916666666667 (116039/120000), AUC 0.9967559576034546
ep45_train_time 15.392413854598999
Test Epoch45 layer4 Acc 0.9105263157894737, AUC 0.9754056930541992, avg_entr 0.012017522007226944
ep45_l4_test_time 0.2250964641571045
gc 0
Train Epoch46 Acc 0.9674 (116088/120000), AUC 0.9967061877250671
ep46_train_time 19.733011960983276
Test Epoch46 layer4 Acc 0.9102631578947369, AUC 0.9751371145248413, avg_entr 0.013437984511256218
ep46_l4_test_time 0.214033842086792
gc 0
Train Epoch47 Acc 0.9675583333333333 (116107/120000), AUC 0.9968341588973999
ep47_train_time 19.64312982559204
Test Epoch47 layer4 Acc 0.91, AUC 0.9749101400375366, avg_entr 0.01274225115776062
ep47_l4_test_time 0.21284198760986328
gc 0
Train Epoch48 Acc 0.9678166666666667 (116138/120000), AUC 0.9968674778938293
ep48_train_time 19.58937692642212
Test Epoch48 layer4 Acc 0.9121052631578948, AUC 0.9753726124763489, avg_entr 0.012293355539441109
ep48_l4_test_time 0.23190832138061523
gc 0
Train Epoch49 Acc 0.9686583333333333 (116239/120000), AUC 0.9968946576118469
ep49_train_time 19.72953963279724
Test Epoch49 layer4 Acc 0.9089473684210526, AUC 0.9759663343429565, avg_entr 0.012576299719512463
ep49_l4_test_time 0.2134087085723877
Best AUC 0.9842581748962402
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 862.158194065094
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad50//ag_news_linearal_l5.pt
Test layer4 Acc 0.911578947368421, AUC 0.9823609590530396, avg_entr 0.07592853903770447
l4_test_time 0.2360246181488037
