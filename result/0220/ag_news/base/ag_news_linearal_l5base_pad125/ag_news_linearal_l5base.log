total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 20.985440254211426
Start Training
gc 0
Train Epoch0 Acc 0.6754333333333333 (81052/120000), AUC 0.8783650398254395
ep0_train_time 21.488173246383667
Test Epoch0 layer4 Acc 0.9052631578947369, AUC 0.9776185750961304, avg_entr 0.21768133342266083
ep0_l4_test_time 0.259732723236084
Save ckpt to ckpt/ag_news_linearal_l5base_pad125//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9205916666666667 (110471/120000), AUC 0.9825778007507324
ep1_train_time 20.49497890472412
Test Epoch1 layer4 Acc 0.9160526315789473, AUC 0.9811545610427856, avg_entr 0.12290874123573303
ep1_l4_test_time 0.23900389671325684
Save ckpt to ckpt/ag_news_linearal_l5base_pad125//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9302333333333334 (111628/120000), AUC 0.9866901636123657
ep2_train_time 20.60260009765625
Test Epoch2 layer4 Acc 0.921578947368421, AUC 0.9823896884918213, avg_entr 0.07689287513494492
ep2_l4_test_time 0.2557351589202881
Save ckpt to ckpt/ag_news_linearal_l5base_pad125//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9358166666666666 (112298/120000), AUC 0.9891018867492676
ep3_train_time 20.513301372528076
Test Epoch3 layer4 Acc 0.921578947368421, AUC 0.9829494953155518, avg_entr 0.050370026379823685
ep3_l4_test_time 0.24885773658752441
Save ckpt to ckpt/ag_news_linearal_l5base_pad125//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9401416666666667 (112817/120000), AUC 0.9903630018234253
ep4_train_time 19.349249124526978
Test Epoch4 layer4 Acc 0.9239473684210526, AUC 0.9841287732124329, avg_entr 0.03681895509362221
ep4_l4_test_time 0.2503821849822998
Save ckpt to ckpt/ag_news_linearal_l5base_pad125//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.942875 (113145/120000), AUC 0.9909762144088745
ep5_train_time 20.532925844192505
Test Epoch5 layer4 Acc 0.9213157894736842, AUC 0.982184648513794, avg_entr 0.027224291115999222
ep5_l4_test_time 0.24781060218811035
gc 0
Train Epoch6 Acc 0.9448083333333334 (113377/120000), AUC 0.9917604923248291
ep6_train_time 29.506061792373657
Test Epoch6 layer4 Acc 0.9236842105263158, AUC 0.9822649359703064, avg_entr 0.02549104019999504
ep6_l4_test_time 0.3462090492248535
gc 0
Train Epoch7 Acc 0.9472916666666666 (113675/120000), AUC 0.9924596548080444
ep7_train_time 31.931615829467773
Test Epoch7 layer4 Acc 0.9218421052631579, AUC 0.9827761650085449, avg_entr 0.023737143725156784
ep7_l4_test_time 0.3657193183898926
gc 0
Train Epoch8 Acc 0.948225 (113787/120000), AUC 0.9929426908493042
ep8_train_time 31.962017059326172
Test Epoch8 layer4 Acc 0.9207894736842105, AUC 0.9819158911705017, avg_entr 0.021226851269602776
ep8_l4_test_time 0.33494067192077637
gc 0
Train Epoch9 Acc 0.9500166666666666 (114002/120000), AUC 0.9934825301170349
ep9_train_time 32.03982877731323
Test Epoch9 layer4 Acc 0.9213157894736842, AUC 0.9814135432243347, avg_entr 0.017648933455348015
ep9_l4_test_time 0.3673057556152344
gc 0
Train Epoch10 Acc 0.9510166666666666 (114122/120000), AUC 0.9938145875930786
ep10_train_time 32.005234241485596
Test Epoch10 layer4 Acc 0.9210526315789473, AUC 0.9818471074104309, avg_entr 0.018055416643619537
ep10_l4_test_time 0.34421563148498535
gc 0
Train Epoch11 Acc 0.952275 (114273/120000), AUC 0.9940627217292786
ep11_train_time 31.09004020690918
Test Epoch11 layer4 Acc 0.9197368421052632, AUC 0.9815544486045837, avg_entr 0.016504568979144096
ep11_l4_test_time 0.3508882522583008
gc 0
Train Epoch12 Acc 0.9530166666666666 (114362/120000), AUC 0.9942623376846313
ep12_train_time 31.9322190284729
Test Epoch12 layer4 Acc 0.92, AUC 0.9806740283966064, avg_entr 0.01633445732295513
ep12_l4_test_time 0.3564486503601074
gc 0
Train Epoch13 Acc 0.9539916666666667 (114479/120000), AUC 0.9944589138031006
ep13_train_time 31.952411890029907
Test Epoch13 layer4 Acc 0.9192105263157895, AUC 0.9800803661346436, avg_entr 0.014845743775367737
ep13_l4_test_time 0.3483738899230957
gc 0
Train Epoch14 Acc 0.9544416666666666 (114533/120000), AUC 0.994540274143219
ep14_train_time 31.938403606414795
Test Epoch14 layer4 Acc 0.9207894736842105, AUC 0.9799706935882568, avg_entr 0.014457453042268753
ep14_l4_test_time 0.3480072021484375
gc 0
Train Epoch15 Acc 0.9549333333333333 (114592/120000), AUC 0.994715690612793
ep15_train_time 31.928537130355835
Test Epoch15 layer4 Acc 0.9202631578947369, AUC 0.9807732105255127, avg_entr 0.014800605364143848
ep15_l4_test_time 0.35349559783935547
gc 0
Train Epoch16 Acc 0.9555166666666667 (114662/120000), AUC 0.9948230385780334
ep16_train_time 31.97795057296753
Test Epoch16 layer4 Acc 0.9186842105263158, AUC 0.9815354347229004, avg_entr 0.014507807791233063
ep16_l4_test_time 0.34175777435302734
gc 0
Train Epoch17 Acc 0.9561166666666666 (114734/120000), AUC 0.9949092864990234
ep17_train_time 32.0811882019043
Test Epoch17 layer4 Acc 0.9186842105263158, AUC 0.9807668924331665, avg_entr 0.014438387006521225
ep17_l4_test_time 0.336719274520874
gc 0
Train Epoch18 Acc 0.95665 (114798/120000), AUC 0.9950265884399414
ep18_train_time 31.865899801254272
Test Epoch18 layer4 Acc 0.9194736842105263, AUC 0.9803292751312256, avg_entr 0.013304994441568851
ep18_l4_test_time 0.34645795822143555
gc 0
Train Epoch19 Acc 0.9569833333333333 (114838/120000), AUC 0.9950939416885376
ep19_train_time 31.327754497528076
Test Epoch19 layer4 Acc 0.9189473684210526, AUC 0.9800829887390137, avg_entr 0.012859111651778221
ep19_l4_test_time 0.35180187225341797
gc 0
Train Epoch20 Acc 0.9576416666666666 (114917/120000), AUC 0.9951702952384949
ep20_train_time 32.08952617645264
Test Epoch20 layer4 Acc 0.9171052631578948, AUC 0.9801226854324341, avg_entr 0.0125083914026618
ep20_l4_test_time 0.3525521755218506
gc 0
Train Epoch21 Acc 0.958175 (114981/120000), AUC 0.9952086210250854
ep21_train_time 31.93367314338684
Test Epoch21 layer4 Acc 0.9173684210526316, AUC 0.9804716110229492, avg_entr 0.012246416881680489
ep21_l4_test_time 0.3348839282989502
gc 0
Train Epoch22 Acc 0.95835 (115002/120000), AUC 0.9953146576881409
ep22_train_time 31.94718647003174
Test Epoch22 layer4 Acc 0.9157894736842105, AUC 0.9800595045089722, avg_entr 0.012244250625371933
ep22_l4_test_time 0.3510005474090576
gc 0
Train Epoch23 Acc 0.9587166666666667 (115046/120000), AUC 0.9954009056091309
ep23_train_time 32.00349402427673
Test Epoch23 layer4 Acc 0.9157894736842105, AUC 0.979801595211029, avg_entr 0.012430979870259762
ep23_l4_test_time 0.34961628913879395
gc 0
Train Epoch24 Acc 0.9594 (115128/120000), AUC 0.9953880310058594
ep24_train_time 31.996744871139526
Test Epoch24 layer4 Acc 0.9178947368421052, AUC 0.97956383228302, avg_entr 0.011888442561030388
ep24_l4_test_time 0.3429696559906006
gc 0
Train Epoch25 Acc 0.9597416666666667 (115169/120000), AUC 0.995502233505249
ep25_train_time 32.04008960723877
Test Epoch25 layer4 Acc 0.9163157894736842, AUC 0.9804030060768127, avg_entr 0.011723393574357033
ep25_l4_test_time 0.34765005111694336
gc 0
Train Epoch26 Acc 0.9597 (115164/120000), AUC 0.9955426454544067
ep26_train_time 31.163883924484253
Test Epoch26 layer4 Acc 0.9171052631578948, AUC 0.9795451164245605, avg_entr 0.01191636547446251
ep26_l4_test_time 0.35137438774108887
gc 0
Train Epoch27 Acc 0.960275 (115233/120000), AUC 0.9956027865409851
ep27_train_time 23.731465578079224
Test Epoch27 layer4 Acc 0.9152631578947369, AUC 0.97950279712677, avg_entr 0.011761562898755074
ep27_l4_test_time 0.23936080932617188
gc 0
Train Epoch28 Acc 0.9606333333333333 (115276/120000), AUC 0.9956889748573303
ep28_train_time 26.590304136276245
Test Epoch28 layer4 Acc 0.9171052631578948, AUC 0.9794514179229736, avg_entr 0.012006087228655815
ep28_l4_test_time 0.3483920097351074
gc 0
Train Epoch29 Acc 0.9610666666666666 (115328/120000), AUC 0.9957828521728516
ep29_train_time 32.08061218261719
Test Epoch29 layer4 Acc 0.9160526315789473, AUC 0.9786287546157837, avg_entr 0.012551403604447842
ep29_l4_test_time 0.3472177982330322
gc 0
Train Epoch30 Acc 0.9610166666666666 (115322/120000), AUC 0.995821475982666
ep30_train_time 31.987202644348145
Test Epoch30 layer4 Acc 0.9155263157894736, AUC 0.9789091944694519, avg_entr 0.011976768262684345
ep30_l4_test_time 0.3529229164123535
gc 0
Train Epoch31 Acc 0.9614333333333334 (115372/120000), AUC 0.9957969784736633
ep31_train_time 32.04323601722717
Test Epoch31 layer4 Acc 0.916578947368421, AUC 0.9790753126144409, avg_entr 0.012271834537386894
ep31_l4_test_time 0.35469722747802734
gc 0
Train Epoch32 Acc 0.961775 (115413/120000), AUC 0.9958177208900452
ep32_train_time 31.981396198272705
Test Epoch32 layer4 Acc 0.9152631578947369, AUC 0.9789732694625854, avg_entr 0.011670057661831379
ep32_l4_test_time 0.3660893440246582
gc 0
Train Epoch33 Acc 0.9620833333333333 (115450/120000), AUC 0.9958746433258057
ep33_train_time 31.234472036361694
Test Epoch33 layer4 Acc 0.9160526315789473, AUC 0.978909432888031, avg_entr 0.011698847636580467
ep33_l4_test_time 0.3456883430480957
gc 0
Train Epoch34 Acc 0.962325 (115479/120000), AUC 0.9959410429000854
ep34_train_time 32.0410521030426
Test Epoch34 layer4 Acc 0.9144736842105263, AUC 0.9786661863327026, avg_entr 0.01154997106641531
ep34_l4_test_time 0.34125542640686035
gc 0
Train Epoch35 Acc 0.9627333333333333 (115528/120000), AUC 0.9959293603897095
ep35_train_time 31.957185983657837
Test Epoch35 layer4 Acc 0.9142105263157895, AUC 0.9779812097549438, avg_entr 0.012483131140470505
ep35_l4_test_time 0.33603930473327637
gc 0
Train Epoch36 Acc 0.96305 (115566/120000), AUC 0.9958978295326233
ep36_train_time 31.849935054779053
Test Epoch36 layer4 Acc 0.915, AUC 0.978424072265625, avg_entr 0.013084111735224724
ep36_l4_test_time 0.3514838218688965
gc 0
Train Epoch37 Acc 0.963175 (115581/120000), AUC 0.996009111404419
ep37_train_time 31.93668222427368
Test Epoch37 layer4 Acc 0.9155263157894736, AUC 0.9774702191352844, avg_entr 0.0134704215452075
ep37_l4_test_time 0.3585216999053955
gc 0
Train Epoch38 Acc 0.9632333333333334 (115588/120000), AUC 0.9960677623748779
ep38_train_time 31.977380514144897
Test Epoch38 layer4 Acc 0.9147368421052632, AUC 0.9775423407554626, avg_entr 0.012202943675220013
ep38_l4_test_time 0.35678601264953613
gc 0
Train Epoch39 Acc 0.9638916666666667 (115667/120000), AUC 0.9960625171661377
ep39_train_time 31.91700553894043
Test Epoch39 layer4 Acc 0.9126315789473685, AUC 0.9779671430587769, avg_entr 0.012410573661327362
ep39_l4_test_time 0.3528323173522949
gc 0
Train Epoch40 Acc 0.964375 (115725/120000), AUC 0.9961124062538147
ep40_train_time 32.150763511657715
Test Epoch40 layer4 Acc 0.9144736842105263, AUC 0.9759462475776672, avg_entr 0.011902551166713238
ep40_l4_test_time 0.33324575424194336
gc 0
Train Epoch41 Acc 0.9640083333333334 (115681/120000), AUC 0.996050238609314
ep41_train_time 31.07276153564453
Test Epoch41 layer4 Acc 0.9131578947368421, AUC 0.9758746027946472, avg_entr 0.012462517246603966
ep41_l4_test_time 0.3470442295074463
gc 0
Train Epoch42 Acc 0.964575 (115749/120000), AUC 0.9960971474647522
ep42_train_time 31.98224377632141
Test Epoch42 layer4 Acc 0.9142105263157895, AUC 0.9764117002487183, avg_entr 0.012616405263543129
ep42_l4_test_time 0.34875011444091797
gc 0
Train Epoch43 Acc 0.9650666666666666 (115808/120000), AUC 0.9960867166519165
ep43_train_time 32.0440092086792
Test Epoch43 layer4 Acc 0.9118421052631579, AUC 0.9766991138458252, avg_entr 0.011242176406085491
ep43_l4_test_time 0.3513178825378418
gc 0
Train Epoch44 Acc 0.9652666666666667 (115832/120000), AUC 0.996080756187439
ep44_train_time 32.066365003585815
Test Epoch44 layer4 Acc 0.9131578947368421, AUC 0.9756397008895874, avg_entr 0.01226954348385334
ep44_l4_test_time 0.35918593406677246
gc 0
Train Epoch45 Acc 0.9653666666666667 (115844/120000), AUC 0.9961262941360474
ep45_train_time 31.90197467803955
Test Epoch45 layer4 Acc 0.9131578947368421, AUC 0.9757971167564392, avg_entr 0.012724880129098892
ep45_l4_test_time 0.34493017196655273
gc 0
Train Epoch46 Acc 0.9657666666666667 (115892/120000), AUC 0.99612957239151
ep46_train_time 31.983463525772095
Test Epoch46 layer4 Acc 0.9113157894736842, AUC 0.9750839471817017, avg_entr 0.012031271122395992
ep46_l4_test_time 0.3454718589782715
gc 0
Train Epoch47 Acc 0.9656833333333333 (115882/120000), AUC 0.9961747527122498
ep47_train_time 32.0718412399292
Test Epoch47 layer4 Acc 0.9102631578947369, AUC 0.9747532606124878, avg_entr 0.011856024153530598
ep47_l4_test_time 0.35280704498291016
gc 0
Train Epoch48 Acc 0.9661416666666667 (115937/120000), AUC 0.9961820840835571
ep48_train_time 31.173303604125977
Test Epoch48 layer4 Acc 0.9131578947368421, AUC 0.9754414558410645, avg_entr 0.012714410200715065
ep48_l4_test_time 0.358532190322876
gc 0
Train Epoch49 Acc 0.96645 (115974/120000), AUC 0.9962130784988403
ep49_train_time 27.230077505111694
Test Epoch49 layer4 Acc 0.911578947368421, AUC 0.9751882553100586, avg_entr 0.01135068666189909
ep49_l4_test_time 0.24616599082946777
Best AUC 0.9841287732124329
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 1524.5194065570831
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad125//ag_news_linearal_l5.pt
Test layer4 Acc 0.9136842105263158, AUC 0.9811896085739136, avg_entr 0.04168340563774109
l4_test_time 0.2442469596862793
