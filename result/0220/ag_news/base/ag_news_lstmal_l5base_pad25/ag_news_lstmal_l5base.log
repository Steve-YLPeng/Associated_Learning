total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 20.428611993789673
Start Training
gc 0
Train Epoch0 Acc 0.7028416666666667 (84341/120000), AUC 0.9038037061691284
ep0_train_time 40.65487790107727
Test Epoch0 layer4 Acc 0.9084210526315789, AUC 0.9822788834571838, avg_entr 0.1113109141588211
ep0_l4_test_time 0.37228918075561523
Save ckpt to ckpt/ag_news_lstmal_l5base_pad25//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9259 (111108/120000), AUC 0.9844908714294434
ep1_train_time 40.26920509338379
Test Epoch1 layer4 Acc 0.9197368421052632, AUC 0.9846936464309692, avg_entr 0.05515275150537491
ep1_l4_test_time 0.35251474380493164
Save ckpt to ckpt/ag_news_lstmal_l5base_pad25//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9363416666666666 (112361/120000), AUC 0.9884548783302307
ep2_train_time 40.32331895828247
Test Epoch2 layer4 Acc 0.9205263157894736, AUC 0.9852750301361084, avg_entr 0.035987116396427155
ep2_l4_test_time 0.348874568939209
Save ckpt to ckpt/ag_news_lstmal_l5base_pad25//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.94295 (113154/120000), AUC 0.9904047250747681
ep3_train_time 40.31657266616821
Test Epoch3 layer4 Acc 0.9189473684210526, AUC 0.9839485287666321, avg_entr 0.0265713669359684
ep3_l4_test_time 0.35257816314697266
gc 0
Train Epoch4 Acc 0.9476333333333333 (113716/120000), AUC 0.991521418094635
ep4_train_time 39.99275851249695
Test Epoch4 layer4 Acc 0.9144736842105263, AUC 0.9841461181640625, avg_entr 0.023431211709976196
ep4_l4_test_time 0.34059715270996094
gc 0
Train Epoch5 Acc 0.9503916666666666 (114047/120000), AUC 0.9924303889274597
ep5_train_time 40.399484634399414
Test Epoch5 layer4 Acc 0.9144736842105263, AUC 0.9841200113296509, avg_entr 0.019977794960141182
ep5_l4_test_time 0.3522608280181885
gc 0
Train Epoch6 Acc 0.9530083333333333 (114361/120000), AUC 0.99303138256073
ep6_train_time 40.460843086242676
Test Epoch6 layer4 Acc 0.9139473684210526, AUC 0.9842066168785095, avg_entr 0.01878429763019085
ep6_l4_test_time 0.3485689163208008
gc 0
Train Epoch7 Acc 0.9550916666666667 (114611/120000), AUC 0.9936596155166626
ep7_train_time 40.393280029296875
Test Epoch7 layer4 Acc 0.9152631578947369, AUC 0.9835942983627319, avg_entr 0.014563965611159801
ep7_l4_test_time 0.3465249538421631
gc 0
Train Epoch8 Acc 0.95755 (114906/120000), AUC 0.9940759539604187
ep8_train_time 40.42935752868652
Test Epoch8 layer4 Acc 0.911578947368421, AUC 0.9816717505455017, avg_entr 0.014515352435410023
ep8_l4_test_time 0.3509047031402588
gc 0
Train Epoch9 Acc 0.95855 (115026/120000), AUC 0.9943148493766785
ep9_train_time 39.90694284439087
Test Epoch9 layer4 Acc 0.9139473684210526, AUC 0.9826681613922119, avg_entr 0.013882356695830822
ep9_l4_test_time 0.36127257347106934
gc 0
Train Epoch10 Acc 0.9610166666666666 (115322/120000), AUC 0.9945187568664551
ep10_train_time 40.47948360443115
Test Epoch10 layer4 Acc 0.9123684210526316, AUC 0.9812334179878235, avg_entr 0.014449850656092167
ep10_l4_test_time 0.35315775871276855
gc 0
Train Epoch11 Acc 0.9621916666666667 (115463/120000), AUC 0.9948842525482178
ep11_train_time 40.41636300086975
Test Epoch11 layer4 Acc 0.9136842105263158, AUC 0.980811595916748, avg_entr 0.012517692521214485
ep11_l4_test_time 0.3543365001678467
gc 0
Train Epoch12 Acc 0.96385 (115662/120000), AUC 0.9948834180831909
ep12_train_time 40.330509662628174
Test Epoch12 layer4 Acc 0.9118421052631579, AUC 0.9806900024414062, avg_entr 0.012527814134955406
ep12_l4_test_time 0.34453368186950684
gc 0
Train Epoch13 Acc 0.9653 (115836/120000), AUC 0.9953287839889526
ep13_train_time 40.31369924545288
Test Epoch13 layer4 Acc 0.9078947368421053, AUC 0.9791315793991089, avg_entr 0.010758679360151291
ep13_l4_test_time 0.3381192684173584
gc 0
Train Epoch14 Acc 0.9664416666666666 (115973/120000), AUC 0.9953334927558899
ep14_train_time 39.82998466491699
Test Epoch14 layer4 Acc 0.9076315789473685, AUC 0.9798063039779663, avg_entr 0.01068254467099905
ep14_l4_test_time 0.356630802154541
gc 0
Train Epoch15 Acc 0.968325 (116199/120000), AUC 0.9954861998558044
ep15_train_time 40.427388429641724
Test Epoch15 layer4 Acc 0.9071052631578947, AUC 0.9779133200645447, avg_entr 0.008892025798559189
ep15_l4_test_time 0.35414624214172363
gc 0
Train Epoch16 Acc 0.9693833333333334 (116326/120000), AUC 0.9955673217773438
ep16_train_time 40.51881504058838
Test Epoch16 layer4 Acc 0.9068421052631579, AUC 0.9773618578910828, avg_entr 0.009590281173586845
ep16_l4_test_time 0.3414146900177002
gc 0
Train Epoch17 Acc 0.9706416666666666 (116477/120000), AUC 0.9956547021865845
ep17_train_time 40.39851093292236
Test Epoch17 layer4 Acc 0.9055263157894737, AUC 0.9770023822784424, avg_entr 0.00707361102104187
ep17_l4_test_time 0.3547389507293701
gc 0
Train Epoch18 Acc 0.9723416666666667 (116681/120000), AUC 0.9958304166793823
ep18_train_time 40.06995487213135
Test Epoch18 layer4 Acc 0.9055263157894737, AUC 0.9762582778930664, avg_entr 0.007425769232213497
ep18_l4_test_time 0.25562191009521484
gc 0
Train Epoch19 Acc 0.973725 (116847/120000), AUC 0.9959944486618042
ep19_train_time 40.096346855163574
Test Epoch19 layer4 Acc 0.9034210526315789, AUC 0.9744600057601929, avg_entr 0.006573022343218327
ep19_l4_test_time 0.343766450881958
gc 0
Train Epoch20 Acc 0.975375 (117045/120000), AUC 0.9961433410644531
ep20_train_time 40.406322956085205
Test Epoch20 layer4 Acc 0.9047368421052632, AUC 0.9748795032501221, avg_entr 0.008296039886772633
ep20_l4_test_time 0.353701114654541
gc 0
Train Epoch21 Acc 0.976725 (117207/120000), AUC 0.996190071105957
ep21_train_time 40.318551540374756
Test Epoch21 layer4 Acc 0.9036842105263158, AUC 0.974021852016449, avg_entr 0.008140706457197666
ep21_l4_test_time 0.34855079650878906
gc 0
Train Epoch22 Acc 0.9781416666666667 (117377/120000), AUC 0.9962687492370605
ep22_train_time 40.41313171386719
Test Epoch22 layer4 Acc 0.9, AUC 0.9716374278068542, avg_entr 0.0056674787774682045
ep22_l4_test_time 0.35631489753723145
gc 0
Train Epoch23 Acc 0.9793083333333333 (117517/120000), AUC 0.9964170455932617
ep23_train_time 39.82590126991272
Test Epoch23 layer4 Acc 0.901578947368421, AUC 0.9711605310440063, avg_entr 0.004873023834079504
ep23_l4_test_time 0.3596522808074951
gc 0
Train Epoch24 Acc 0.9802083333333333 (117625/120000), AUC 0.9965134263038635
ep24_train_time 40.513927698135376
Test Epoch24 layer4 Acc 0.9021052631578947, AUC 0.9705540537834167, avg_entr 0.005602451507002115
ep24_l4_test_time 0.350543737411499
gc 0
Train Epoch25 Acc 0.9813 (117756/120000), AUC 0.9965596199035645
ep25_train_time 40.45053672790527
Test Epoch25 layer4 Acc 0.8994736842105263, AUC 0.969956636428833, avg_entr 0.005853885319083929
ep25_l4_test_time 0.35405492782592773
gc 0
Train Epoch26 Acc 0.982575 (117909/120000), AUC 0.9965755939483643
ep26_train_time 40.545456886291504
Test Epoch26 layer4 Acc 0.9007894736842105, AUC 0.9696911573410034, avg_entr 0.004858065862208605
ep26_l4_test_time 0.3448798656463623
gc 0
Train Epoch27 Acc 0.9835916666666666 (118031/120000), AUC 0.9966510534286499
ep27_train_time 40.44803500175476
Test Epoch27 layer4 Acc 0.8992105263157895, AUC 0.9692270159721375, avg_entr 0.005843060556799173
ep27_l4_test_time 0.3556241989135742
gc 0
Train Epoch28 Acc 0.98445 (118134/120000), AUC 0.9967455863952637
ep28_train_time 39.82586979866028
Test Epoch28 layer4 Acc 0.8968421052631579, AUC 0.9691368937492371, avg_entr 0.006680100224912167
ep28_l4_test_time 0.3480362892150879
gc 0
Train Epoch29 Acc 0.9849916666666667 (118199/120000), AUC 0.9968394637107849
ep29_train_time 40.35455083847046
Test Epoch29 layer4 Acc 0.8986842105263158, AUC 0.9667913317680359, avg_entr 0.005607293918728828
ep29_l4_test_time 0.33852100372314453
gc 0
Train Epoch30 Acc 0.985825 (118299/120000), AUC 0.9969258308410645
ep30_train_time 40.35414457321167
Test Epoch30 layer4 Acc 0.8976315789473684, AUC 0.9641535878181458, avg_entr 0.005049313884228468
ep30_l4_test_time 0.3506648540496826
gc 0
Train Epoch31 Acc 0.9863083333333333 (118357/120000), AUC 0.9969282746315002
ep31_train_time 40.55813527107239
Test Epoch31 layer4 Acc 0.9018421052631579, AUC 0.9691281318664551, avg_entr 0.005549632012844086
ep31_l4_test_time 0.3495509624481201
gc 0
Train Epoch32 Acc 0.9874666666666667 (118496/120000), AUC 0.9970837831497192
ep32_train_time 40.339988231658936
Test Epoch32 layer4 Acc 0.895, AUC 0.9639052748680115, avg_entr 0.005137532018125057
ep32_l4_test_time 0.36380434036254883
gc 0
Train Epoch33 Acc 0.9877333333333334 (118528/120000), AUC 0.9970991611480713
ep33_train_time 39.85665774345398
Test Epoch33 layer4 Acc 0.8986842105263158, AUC 0.9635835886001587, avg_entr 0.005002581048756838
ep33_l4_test_time 0.35889220237731934
gc 0
Train Epoch34 Acc 0.9880333333333333 (118564/120000), AUC 0.9972487688064575
ep34_train_time 40.44487023353577
Test Epoch34 layer4 Acc 0.8947368421052632, AUC 0.9643145799636841, avg_entr 0.004635944496840239
ep34_l4_test_time 0.3522469997406006
gc 0
Train Epoch35 Acc 0.9885666666666667 (118628/120000), AUC 0.9972715973854065
ep35_train_time 40.55449104309082
Test Epoch35 layer4 Acc 0.8931578947368422, AUC 0.9639379978179932, avg_entr 0.004567129537463188
ep35_l4_test_time 0.357067346572876
gc 0
Train Epoch36 Acc 0.9889 (118668/120000), AUC 0.9973866939544678
ep36_train_time 40.36615443229675
Test Epoch36 layer4 Acc 0.8926315789473684, AUC 0.9630286693572998, avg_entr 0.00491329887881875
ep36_l4_test_time 0.3477771282196045
gc 0
Train Epoch37 Acc 0.989275 (118713/120000), AUC 0.9974430799484253
ep37_train_time 40.39289379119873
Test Epoch37 layer4 Acc 0.8936842105263157, AUC 0.962648868560791, avg_entr 0.004044669214636087
ep37_l4_test_time 0.3571963310241699
gc 0
Train Epoch38 Acc 0.98935 (118722/120000), AUC 0.9974778890609741
ep38_train_time 39.94329571723938
Test Epoch38 layer4 Acc 0.8934210526315789, AUC 0.9632657766342163, avg_entr 0.004029619973152876
ep38_l4_test_time 0.3577392101287842
gc 0
Train Epoch39 Acc 0.9899583333333334 (118795/120000), AUC 0.9975292682647705
ep39_train_time 40.37685799598694
Test Epoch39 layer4 Acc 0.8918421052631579, AUC 0.9640552401542664, avg_entr 0.003837163560092449
ep39_l4_test_time 0.35259509086608887
gc 0
Train Epoch40 Acc 0.9901 (118812/120000), AUC 0.997498095035553
ep40_train_time 40.45513677597046
Test Epoch40 layer4 Acc 0.8944736842105263, AUC 0.9625979661941528, avg_entr 0.004657468758523464
ep40_l4_test_time 0.34784460067749023
gc 0
Train Epoch41 Acc 0.9902166666666666 (118826/120000), AUC 0.9975340366363525
ep41_train_time 40.416378021240234
Test Epoch41 layer4 Acc 0.8939473684210526, AUC 0.9617681503295898, avg_entr 0.004172847606241703
ep41_l4_test_time 0.34893345832824707
gc 0
Train Epoch42 Acc 0.9902166666666666 (118826/120000), AUC 0.9974467754364014
ep42_train_time 40.42878723144531
Test Epoch42 layer4 Acc 0.8936842105263157, AUC 0.9597650766372681, avg_entr 0.004454889800399542
ep42_l4_test_time 0.3555417060852051
gc 0
Train Epoch43 Acc 0.990675 (118881/120000), AUC 0.9975141286849976
ep43_train_time 39.81983256340027
Test Epoch43 layer4 Acc 0.8942105263157895, AUC 0.9619612693786621, avg_entr 0.003946368582546711
ep43_l4_test_time 0.34336042404174805
gc 0
Train Epoch44 Acc 0.990725 (118887/120000), AUC 0.9974815845489502
ep44_train_time 40.48045873641968
Test Epoch44 layer4 Acc 0.8902631578947369, AUC 0.9603623151779175, avg_entr 0.004960304591804743
ep44_l4_test_time 0.34614014625549316
gc 0
Train Epoch45 Acc 0.990975 (118917/120000), AUC 0.9974030256271362
ep45_train_time 40.41160988807678
Test Epoch45 layer4 Acc 0.8928947368421053, AUC 0.9616446495056152, avg_entr 0.0038406047970056534
ep45_l4_test_time 0.35818982124328613
gc 0
Train Epoch46 Acc 0.99115 (118938/120000), AUC 0.9973927736282349
ep46_train_time 40.436272382736206
Test Epoch46 layer4 Acc 0.8955263157894737, AUC 0.9608761668205261, avg_entr 0.002896570833399892
ep46_l4_test_time 0.3433647155761719
gc 0
Train Epoch47 Acc 0.9913833333333333 (118966/120000), AUC 0.9973340034484863
ep47_train_time 40.447988748550415
Test Epoch47 layer4 Acc 0.8976315789473684, AUC 0.963019073009491, avg_entr 0.003971384838223457
ep47_l4_test_time 0.3547403812408447
gc 0
Train Epoch48 Acc 0.9914166666666666 (118970/120000), AUC 0.9973578453063965
ep48_train_time 39.74660277366638
Test Epoch48 layer4 Acc 0.8902631578947369, AUC 0.9588258266448975, avg_entr 0.004223438445478678
ep48_l4_test_time 0.36707520484924316
gc 0
Train Epoch49 Acc 0.991525 (118983/120000), AUC 0.9972195029258728
ep49_train_time 40.59186267852783
Test Epoch49 layer4 Acc 0.8931578947368422, AUC 0.9594148397445679, avg_entr 0.00407013762742281
ep49_l4_test_time 0.3520679473876953
Best AUC 0.9852750301361084
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 2036.058495759964
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad25//ag_news_lstmal_l5.pt
Test layer4 Acc 0.911578947368421, AUC 0.9823240041732788, avg_entr 0.03773510456085205
l4_test_time 0.3513615131378174
