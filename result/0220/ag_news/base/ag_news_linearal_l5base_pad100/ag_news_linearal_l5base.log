total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.911141872406006
Start Training
gc 0
Train Epoch0 Acc 0.6848416666666667 (82181/120000), AUC 0.8857460021972656
ep0_train_time 20.5088894367218
Test Epoch0 layer4 Acc 0.9092105263157895, AUC 0.9785911440849304, avg_entr 0.2089637964963913
ep0_l4_test_time 0.21643757820129395
Save ckpt to ckpt/ag_news_linearal_l5base_pad100//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9220833333333334 (110650/120000), AUC 0.9835680723190308
ep1_train_time 18.549015760421753
Test Epoch1 layer4 Acc 0.9192105263157895, AUC 0.9819763898849487, avg_entr 0.1170259490609169
ep1_l4_test_time 0.21585512161254883
Save ckpt to ckpt/ag_news_linearal_l5base_pad100//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9319 (111828/120000), AUC 0.9875251650810242
ep2_train_time 19.475996017456055
Test Epoch2 layer4 Acc 0.9202631578947369, AUC 0.9828170537948608, avg_entr 0.07963114976882935
ep2_l4_test_time 0.21573925018310547
Save ckpt to ckpt/ag_news_linearal_l5base_pad100//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9374666666666667 (112496/120000), AUC 0.9897463321685791
ep3_train_time 19.376076459884644
Test Epoch3 layer4 Acc 0.9197368421052632, AUC 0.9840677976608276, avg_entr 0.052261821925640106
ep3_l4_test_time 0.20612454414367676
Save ckpt to ckpt/ag_news_linearal_l5base_pad100//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.940875 (112905/120000), AUC 0.9909953474998474
ep4_train_time 19.53037452697754
Test Epoch4 layer4 Acc 0.9226315789473685, AUC 0.9828854203224182, avg_entr 0.03696659952402115
ep4_l4_test_time 0.22048306465148926
gc 0
Train Epoch5 Acc 0.9438916666666667 (113267/120000), AUC 0.9915689826011658
ep5_train_time 19.524025678634644
Test Epoch5 layer4 Acc 0.9218421052631579, AUC 0.9833181500434875, avg_entr 0.030449960380792618
ep5_l4_test_time 0.214585542678833
gc 0
Train Epoch6 Acc 0.946075 (113529/120000), AUC 0.992273211479187
ep6_train_time 19.45954656600952
Test Epoch6 layer4 Acc 0.9223684210526316, AUC 0.9826172590255737, avg_entr 0.025959352031350136
ep6_l4_test_time 0.22971701622009277
gc 0
Train Epoch7 Acc 0.9476083333333334 (113713/120000), AUC 0.9926586747169495
ep7_train_time 19.565535068511963
Test Epoch7 layer4 Acc 0.9197368421052632, AUC 0.982442319393158, avg_entr 0.02329929918050766
ep7_l4_test_time 0.22382736206054688
gc 0
Train Epoch8 Acc 0.949675 (113961/120000), AUC 0.9932997226715088
ep8_train_time 18.58479380607605
Test Epoch8 layer4 Acc 0.9194736842105263, AUC 0.9822244048118591, avg_entr 0.021206090226769447
ep8_l4_test_time 0.2233874797821045
gc 0
Train Epoch9 Acc 0.9504 (114048/120000), AUC 0.9934971332550049
ep9_train_time 19.370809316635132
Test Epoch9 layer4 Acc 0.9213157894736842, AUC 0.9817426204681396, avg_entr 0.020213834941387177
ep9_l4_test_time 0.20825767517089844
gc 0
Train Epoch10 Acc 0.9517916666666667 (114215/120000), AUC 0.9938992261886597
ep10_train_time 19.490309476852417
Test Epoch10 layer4 Acc 0.9207894736842105, AUC 0.9806890487670898, avg_entr 0.018099820241332054
ep10_l4_test_time 0.21671581268310547
gc 0
Train Epoch11 Acc 0.9525 (114300/120000), AUC 0.9940797090530396
ep11_train_time 19.52895712852478
Test Epoch11 layer4 Acc 0.9197368421052632, AUC 0.9813458323478699, avg_entr 0.017762668430805206
ep11_l4_test_time 0.22057509422302246
gc 0
Train Epoch12 Acc 0.9530583333333333 (114367/120000), AUC 0.9943573474884033
ep12_train_time 19.492465496063232
Test Epoch12 layer4 Acc 0.9197368421052632, AUC 0.9813786149024963, avg_entr 0.016527891159057617
ep12_l4_test_time 0.21593618392944336
gc 0
Train Epoch13 Acc 0.954075 (114489/120000), AUC 0.994491457939148
ep13_train_time 19.530905961990356
Test Epoch13 layer4 Acc 0.9186842105263158, AUC 0.9806137084960938, avg_entr 0.016834791749715805
ep13_l4_test_time 0.20975375175476074
gc 0
Train Epoch14 Acc 0.9545833333333333 (114550/120000), AUC 0.9946497678756714
ep14_train_time 19.586812257766724
Test Epoch14 layer4 Acc 0.9197368421052632, AUC 0.980931282043457, avg_entr 0.01497522834688425
ep14_l4_test_time 0.23116254806518555
gc 0
Train Epoch15 Acc 0.9549333333333333 (114592/120000), AUC 0.9947312474250793
ep15_train_time 18.959635734558105
Test Epoch15 layer4 Acc 0.92, AUC 0.9808374643325806, avg_entr 0.015395787544548512
ep15_l4_test_time 0.22430920600891113
gc 0
Train Epoch16 Acc 0.9559916666666667 (114719/120000), AUC 0.9949001669883728
ep16_train_time 19.26486611366272
Test Epoch16 layer4 Acc 0.9186842105263158, AUC 0.9808697700500488, avg_entr 0.013372487388551235
ep16_l4_test_time 0.20340633392333984
gc 0
Train Epoch17 Acc 0.9563833333333334 (114766/120000), AUC 0.9949519634246826
ep17_train_time 19.54512095451355
Test Epoch17 layer4 Acc 0.9192105263157895, AUC 0.9803875684738159, avg_entr 0.013863416388630867
ep17_l4_test_time 0.21002888679504395
gc 0
Train Epoch18 Acc 0.9568916666666667 (114827/120000), AUC 0.9949616193771362
ep18_train_time 19.42397117614746
Test Epoch18 layer4 Acc 0.9176315789473685, AUC 0.9804794788360596, avg_entr 0.013760658912360668
ep18_l4_test_time 0.21692609786987305
gc 0
Train Epoch19 Acc 0.9569666666666666 (114836/120000), AUC 0.995155930519104
ep19_train_time 19.57030725479126
Test Epoch19 layer4 Acc 0.9152631578947369, AUC 0.9800353050231934, avg_entr 0.013479436747729778
ep19_l4_test_time 0.21265912055969238
gc 0
Train Epoch20 Acc 0.9575416666666666 (114905/120000), AUC 0.9952738881111145
ep20_train_time 19.551716327667236
Test Epoch20 layer4 Acc 0.9186842105263158, AUC 0.9804273843765259, avg_entr 0.012563027441501617
ep20_l4_test_time 0.22357749938964844
gc 0
Train Epoch21 Acc 0.9581666666666667 (114980/120000), AUC 0.995307445526123
ep21_train_time 19.55491304397583
Test Epoch21 layer4 Acc 0.916578947368421, AUC 0.9804457426071167, avg_entr 0.011443033814430237
ep21_l4_test_time 0.22049450874328613
gc 0
Train Epoch22 Acc 0.9583 (114996/120000), AUC 0.9955254793167114
ep22_train_time 19.625375747680664
Test Epoch22 layer4 Acc 0.916578947368421, AUC 0.9797702431678772, avg_entr 0.011855735443532467
ep22_l4_test_time 0.22067475318908691
gc 0
Train Epoch23 Acc 0.9589 (115068/120000), AUC 0.9955230355262756
ep23_train_time 18.7082781791687
Test Epoch23 layer4 Acc 0.9163157894736842, AUC 0.9802113175392151, avg_entr 0.011542423628270626
ep23_l4_test_time 0.21101093292236328
gc 0
Train Epoch24 Acc 0.9590416666666667 (115085/120000), AUC 0.9956563115119934
ep24_train_time 19.490806818008423
Test Epoch24 layer4 Acc 0.9186842105263158, AUC 0.9800119400024414, avg_entr 0.0129037294536829
ep24_l4_test_time 0.21458101272583008
gc 0
Train Epoch25 Acc 0.9596083333333333 (115153/120000), AUC 0.9955958127975464
ep25_train_time 19.66701912879944
Test Epoch25 layer4 Acc 0.9173684210526316, AUC 0.979783833026886, avg_entr 0.011833989061415195
ep25_l4_test_time 0.21422982215881348
gc 0
Train Epoch26 Acc 0.9599166666666666 (115190/120000), AUC 0.9957201480865479
ep26_train_time 19.64353108406067
Test Epoch26 layer4 Acc 0.9157894736842105, AUC 0.9791117906570435, avg_entr 0.012168721295893192
ep26_l4_test_time 0.223114013671875
gc 0
Train Epoch27 Acc 0.95985 (115182/120000), AUC 0.9957529306411743
ep27_train_time 19.477189302444458
Test Epoch27 layer4 Acc 0.9168421052631579, AUC 0.9791852235794067, avg_entr 0.011740137822926044
ep27_l4_test_time 0.2139437198638916
gc 0
Train Epoch28 Acc 0.9605083333333333 (115261/120000), AUC 0.9958325028419495
ep28_train_time 19.503656148910522
Test Epoch28 layer4 Acc 0.9171052631578948, AUC 0.9791343808174133, avg_entr 0.012846044264733791
ep28_l4_test_time 0.20867323875427246
gc 0
Train Epoch29 Acc 0.9604166666666667 (115250/120000), AUC 0.9958411455154419
ep29_train_time 19.538586378097534
Test Epoch29 layer4 Acc 0.9152631578947369, AUC 0.978449821472168, avg_entr 0.012029199860990047
ep29_l4_test_time 0.21189665794372559
gc 0
Train Epoch30 Acc 0.9609916666666667 (115319/120000), AUC 0.9959656596183777
ep30_train_time 18.526653289794922
Test Epoch30 layer4 Acc 0.9131578947368421, AUC 0.9788018465042114, avg_entr 0.01180242095142603
ep30_l4_test_time 0.2218494415283203
gc 0
Train Epoch31 Acc 0.9613083333333333 (115357/120000), AUC 0.9959790706634521
ep31_train_time 19.651255130767822
Test Epoch31 layer4 Acc 0.9173684210526316, AUC 0.9780718088150024, avg_entr 0.012152055278420448
ep31_l4_test_time 0.2052145004272461
gc 0
Train Epoch32 Acc 0.96155 (115386/120000), AUC 0.9959786534309387
ep32_train_time 19.538194179534912
Test Epoch32 layer4 Acc 0.9155263157894736, AUC 0.9782103300094604, avg_entr 0.011382581666111946
ep32_l4_test_time 0.22332167625427246
gc 0
Train Epoch33 Acc 0.9615833333333333 (115390/120000), AUC 0.9960243701934814
ep33_train_time 19.539217710494995
Test Epoch33 layer4 Acc 0.9157894736842105, AUC 0.9782214164733887, avg_entr 0.01215943694114685
ep33_l4_test_time 0.2110447883605957
gc 0
Train Epoch34 Acc 0.9619916666666667 (115439/120000), AUC 0.9960687160491943
ep34_train_time 19.468610286712646
Test Epoch34 layer4 Acc 0.9163157894736842, AUC 0.9774032235145569, avg_entr 0.011971174739301205
ep34_l4_test_time 0.20868992805480957
gc 0
Train Epoch35 Acc 0.9626083333333333 (115513/120000), AUC 0.9961392879486084
ep35_train_time 19.524609088897705
Test Epoch35 layer4 Acc 0.9152631578947369, AUC 0.9775565266609192, avg_entr 0.013454947620630264
ep35_l4_test_time 0.21629834175109863
gc 0
Train Epoch36 Acc 0.962625 (115515/120000), AUC 0.9961004853248596
ep36_train_time 19.664111852645874
Test Epoch36 layer4 Acc 0.9136842105263158, AUC 0.9780514240264893, avg_entr 0.012516497634351254
ep36_l4_test_time 0.20570158958435059
gc 0
Train Epoch37 Acc 0.9629083333333334 (115549/120000), AUC 0.9961886405944824
ep37_train_time 18.737067461013794
Test Epoch37 layer4 Acc 0.9147368421052632, AUC 0.9770150184631348, avg_entr 0.013360744342207909
ep37_l4_test_time 0.21964621543884277
gc 0
Train Epoch38 Acc 0.96335 (115602/120000), AUC 0.9962003231048584
ep38_train_time 19.482309341430664
Test Epoch38 layer4 Acc 0.9139473684210526, AUC 0.9781044721603394, avg_entr 0.012317746877670288
ep38_l4_test_time 0.21158790588378906
gc 0
Train Epoch39 Acc 0.9634333333333334 (115612/120000), AUC 0.9962551593780518
ep39_train_time 19.58137035369873
Test Epoch39 layer4 Acc 0.9147368421052632, AUC 0.9778292179107666, avg_entr 0.012566788122057915
ep39_l4_test_time 0.2247447967529297
gc 0
Train Epoch40 Acc 0.963625 (115635/120000), AUC 0.9962294697761536
ep40_train_time 19.51508331298828
Test Epoch40 layer4 Acc 0.9134210526315789, AUC 0.9771313667297363, avg_entr 0.013310353271663189
ep40_l4_test_time 0.21216082572937012
gc 0
Train Epoch41 Acc 0.9638583333333334 (115663/120000), AUC 0.9962239861488342
ep41_train_time 19.549248456954956
Test Epoch41 layer4 Acc 0.9142105263157895, AUC 0.9766229391098022, avg_entr 0.013395068235695362
ep41_l4_test_time 0.22066211700439453
gc 0
Train Epoch42 Acc 0.9643916666666666 (115727/120000), AUC 0.9963772892951965
ep42_train_time 19.574389457702637
Test Epoch42 layer4 Acc 0.9144736842105263, AUC 0.9762417078018188, avg_entr 0.013299000449478626
ep42_l4_test_time 0.221266508102417
gc 0
Train Epoch43 Acc 0.9646583333333333 (115759/120000), AUC 0.996399462223053
ep43_train_time 19.50967764854431
Test Epoch43 layer4 Acc 0.9123684210526316, AUC 0.9767408967018127, avg_entr 0.013838234357535839
ep43_l4_test_time 0.22447419166564941
gc 0
Train Epoch44 Acc 0.9649416666666667 (115793/120000), AUC 0.9963561296463013
ep44_train_time 18.879955291748047
Test Epoch44 layer4 Acc 0.9142105263157895, AUC 0.9772742986679077, avg_entr 0.01393146812915802
ep44_l4_test_time 0.1928555965423584
gc 0
Train Epoch45 Acc 0.9651916666666667 (115823/120000), AUC 0.9964731931686401
ep45_train_time 19.400583505630493
Test Epoch45 layer4 Acc 0.9118421052631579, AUC 0.977178156375885, avg_entr 0.013766815885901451
ep45_l4_test_time 0.20944499969482422
gc 0
Train Epoch46 Acc 0.9654083333333333 (115849/120000), AUC 0.9965264797210693
ep46_train_time 19.67404580116272
Test Epoch46 layer4 Acc 0.91, AUC 0.9763206243515015, avg_entr 0.012769103050231934
ep46_l4_test_time 0.21544146537780762
gc 0
Train Epoch47 Acc 0.9657083333333333 (115885/120000), AUC 0.9965326189994812
ep47_train_time 19.573566436767578
Test Epoch47 layer4 Acc 0.9110526315789473, AUC 0.975058376789093, avg_entr 0.012135038152337074
ep47_l4_test_time 0.22509121894836426
gc 0
Train Epoch48 Acc 0.9662 (115944/120000), AUC 0.9965366125106812
ep48_train_time 19.439165115356445
Test Epoch48 layer4 Acc 0.9105263157894737, AUC 0.9759082794189453, avg_entr 0.013308863155543804
ep48_l4_test_time 0.22263336181640625
gc 0
Train Epoch49 Acc 0.9660833333333333 (115930/120000), AUC 0.9966166615486145
ep49_train_time 19.535882472991943
Test Epoch49 layer4 Acc 0.9105263157894737, AUC 0.9767130613327026, avg_entr 0.012885550037026405
ep49_l4_test_time 0.22063922882080078
Best AUC 0.9840677976608276
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 985.2944092750549
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad100//ag_news_linearal_l5.pt
Test layer4 Acc 0.9118421052631579, AUC 0.9822801351547241, avg_entr 0.05739811807870865
l4_test_time 0.21714997291564941
