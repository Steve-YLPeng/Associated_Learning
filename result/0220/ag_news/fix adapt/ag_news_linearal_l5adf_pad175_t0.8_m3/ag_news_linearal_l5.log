total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.670726776123047
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.32008333333333333 (38410/120000), AUC 0.5773805379867554
ep0_train_time 7.45794153213501
Test Epoch0 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep0_t0.8_test_time 0.16329717636108398
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.35204166666666664 (42245/120000), AUC 0.6262232065200806
ep1_train_time 6.975019454956055
Test Epoch1 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep1_t0.8_test_time 0.16180658340454102
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.42555 (51066/120000), AUC 0.6618877649307251
ep2_train_time 7.051011323928833
Test Epoch2 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep2_t0.8_test_time 0.1614217758178711
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.46799166666666664 (56159/120000), AUC 0.7124301791191101
ep3_train_time 6.992252826690674
Test Epoch3 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep3_t0.8_test_time 0.16136431694030762
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.483225 (57987/120000), AUC 0.7076336145401001
ep4_train_time 6.958813667297363
Test Epoch4 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep4_t0.8_test_time 0.16071796417236328
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.48878333333333335 (58654/120000), AUC 0.6967507600784302
ep5_train_time 6.962845802307129
Test Epoch5 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep5_t0.8_test_time 0.16074299812316895
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.49088333333333334 (58906/120000), AUC 0.6869368553161621
ep6_train_time 6.910620450973511
Test Epoch6 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep6_t0.8_test_time 0.16038155555725098
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.49233333333333335 (59080/120000), AUC 0.6780596971511841
ep7_train_time 7.078440189361572
Test Epoch7 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep7_t0.8_test_time 0.16167330741882324
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.493075 (59169/120000), AUC 0.6731268763542175
ep8_train_time 7.050824880599976
Test Epoch8 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep8_t0.8_test_time 0.16082048416137695
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.49249166666666666 (59099/120000), AUC 0.6722737550735474
ep9_train_time 7.036609411239624
Test Epoch9 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep9_t0.8_test_time 0.16228079795837402
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9788198471069336
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 73.40588760375977
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5.pt
Test threshold 0.8 Acc 0.9221052631578948, AUC 0.9848241209983826, avg_entr 0.06039261817932129
t0.8_test_time 0.1595134735107422
