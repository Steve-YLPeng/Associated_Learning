total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.62198281288147
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.340775 (40893/120000), AUC 0.5774574875831604
ep0_train_time 7.380706548690796
Test Epoch0 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep0_t0.9_test_time 0.16030430793762207
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2950583333333333 (35407/120000), AUC 0.6151270866394043
ep1_train_time 6.874752044677734
Test Epoch1 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep1_t0.9_test_time 0.15737032890319824
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.325975 (39117/120000), AUC 0.6534327268600464
ep2_train_time 6.906757116317749
Test Epoch2 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep2_t0.9_test_time 0.15782666206359863
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.37971666666666665 (45566/120000), AUC 0.6593605279922485
ep3_train_time 6.878779411315918
Test Epoch3 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep3_t0.9_test_time 0.1582202911376953
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.395975 (47517/120000), AUC 0.6498539447784424
ep4_train_time 6.791508913040161
Test Epoch4 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep4_t0.9_test_time 0.1587662696838379
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.40699166666666664 (48839/120000), AUC 0.6410201787948608
ep5_train_time 6.946638584136963
Test Epoch5 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep5_t0.9_test_time 0.15851235389709473
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.41986666666666667 (50384/120000), AUC 0.639051616191864
ep6_train_time 6.940758466720581
Test Epoch6 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep6_t0.9_test_time 0.15886807441711426
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.43450833333333333 (52141/120000), AUC 0.6368423104286194
ep7_train_time 6.943758726119995
Test Epoch7 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep7_t0.9_test_time 0.1581423282623291
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.449575 (53949/120000), AUC 0.6376605033874512
ep8_train_time 6.961123943328857
Test Epoch8 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep8_t0.9_test_time 0.1585848331451416
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.4613583333333333 (55363/120000), AUC 0.639822781085968
ep9_train_time 6.864806413650513
Test Epoch9 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep9_t0.9_test_time 0.15828347206115723
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9788055419921875
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 72.40300559997559
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5.pt
Test threshold 0.9 Acc 0.9242105263157895, AUC 0.9847592115402222, avg_entr 0.052668217569589615
t0.9_test_time 0.15703463554382324
