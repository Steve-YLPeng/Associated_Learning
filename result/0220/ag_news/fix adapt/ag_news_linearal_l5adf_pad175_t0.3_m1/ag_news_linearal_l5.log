total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 20.282570838928223
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.249075 (29889/120000), AUC 0.4894755780696869
ep0_train_time 8.469964027404785
Test Epoch0 threshold 0.3 Acc 0.8955263157894737, AUC 0.9710133075714111, avg_entr 0.1854100525379181
ep0_t0.3_test_time 0.16058731079101562
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.4501325488090515
ep1_train_time 8.02140998840332
Test Epoch1 threshold 0.3 Acc 0.9044736842105263, AUC 0.9755277633666992, avg_entr 0.10659865289926529
ep1_t0.3_test_time 0.15800166130065918
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.44638141989707947
ep2_train_time 7.9791576862335205
Test Epoch2 threshold 0.3 Acc 0.9113157894736842, AUC 0.9774812459945679, avg_entr 0.08067423850297928
ep2_t0.3_test_time 0.1584482192993164
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.44655799865722656
ep3_train_time 7.992044448852539
Test Epoch3 threshold 0.3 Acc 0.9139473684210526, AUC 0.978247344493866, avg_entr 0.06873863190412521
ep3_t0.3_test_time 0.1573960781097412
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.44700443744659424
ep4_train_time 7.940850257873535
Test Epoch4 threshold 0.3 Acc 0.9123684210526316, AUC 0.9785969257354736, avg_entr 0.0600101575255394
ep4_t0.3_test_time 0.15770864486694336
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.4478437006473541
ep5_train_time 7.967896223068237
Test Epoch5 threshold 0.3 Acc 0.9118421052631579, AUC 0.9787273406982422, avg_entr 0.053758732974529266
ep5_t0.3_test_time 0.15854930877685547
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.44820743799209595
ep6_train_time 8.004920721054077
Test Epoch6 threshold 0.3 Acc 0.9131578947368421, AUC 0.9788088202476501, avg_entr 0.05009864270687103
ep6_t0.3_test_time 0.15725135803222656
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.4490587115287781
ep7_train_time 7.9822070598602295
Test Epoch7 threshold 0.3 Acc 0.9110526315789473, AUC 0.978664755821228, avg_entr 0.046487245708703995
ep7_t0.3_test_time 0.15734624862670898
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.4491680860519409
ep8_train_time 7.936734676361084
Test Epoch8 threshold 0.3 Acc 0.9121052631578948, AUC 0.9786140322685242, avg_entr 0.04389813914895058
ep8_t0.3_test_time 0.15785717964172363
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.44974246621131897
ep9_train_time 7.963972330093384
Test Epoch9 threshold 0.3 Acc 0.911578947368421, AUC 0.9785810708999634, avg_entr 0.041073206812143326
ep9_t0.3_test_time 0.15766286849975586
Best AUC 0.9788088202476501
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 82.95072913169861
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5.pt
Test threshold 0.3 Acc 0.9226315789473685, AUC 0.98492830991745, avg_entr 0.04988190531730652
t0.3_test_time 0.15682673454284668
