total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m4//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.389790534973145
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.9235916666666667 (110831/120000), AUC 0.9865375757217407
ep0_train_time 7.346699476242065
Test Epoch0 threshold 0.1 Acc 0.9123684210526316, AUC 0.9785994291305542, avg_entr 0.04401220753788948
ep0_t0.1_test_time 0.19382333755493164
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m5//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9444666666666667 (113336/120000), AUC 0.9921815395355225
ep1_train_time 6.736814498901367
Test Epoch1 threshold 0.1 Acc 0.9118421052631579, AUC 0.9785672426223755, avg_entr 0.04182077944278717
ep1_t0.1_test_time 0.18173909187316895
gc 0
Train Epoch2 Acc 0.944725 (113367/120000), AUC 0.9922599792480469
ep2_train_time 6.780137300491333
Test Epoch2 threshold 0.1 Acc 0.9118421052631579, AUC 0.978236198425293, avg_entr 0.038837041705846786
ep2_t0.1_test_time 0.1819319725036621
gc 0
Train Epoch3 Acc 0.9446333333333333 (113356/120000), AUC 0.992229700088501
ep3_train_time 6.8429224491119385
Test Epoch3 threshold 0.1 Acc 0.9126315789473685, AUC 0.9781732559204102, avg_entr 0.03713991492986679
ep3_t0.1_test_time 0.18187546730041504
gc 0
Train Epoch4 Acc 0.9447416666666667 (113369/120000), AUC 0.9920802712440491
ep4_train_time 6.740920543670654
Test Epoch4 threshold 0.1 Acc 0.9136842105263158, AUC 0.9780421257019043, avg_entr 0.036484990268945694
ep4_t0.1_test_time 0.18172717094421387
gc 0
Train Epoch5 Acc 0.9449583333333333 (113395/120000), AUC 0.992077648639679
ep5_train_time 6.8128437995910645
Test Epoch5 threshold 0.1 Acc 0.9139473684210526, AUC 0.9779577851295471, avg_entr 0.036188215017318726
ep5_t0.1_test_time 0.18170833587646484
gc 0
Train Epoch6 Acc 0.9448916666666667 (113387/120000), AUC 0.9920392036437988
ep6_train_time 6.741881608963013
Test Epoch6 threshold 0.1 Acc 0.9136842105263158, AUC 0.9779436588287354, avg_entr 0.035836540162563324
ep6_t0.1_test_time 0.1815354824066162
gc 0
Train Epoch7 Acc 0.9447333333333333 (113368/120000), AUC 0.9920468926429749
ep7_train_time 6.804025173187256
Test Epoch7 threshold 0.1 Acc 0.9128947368421053, AUC 0.9778984785079956, avg_entr 0.035619430243968964
ep7_t0.1_test_time 0.18136167526245117
gc 0
Train Epoch8 Acc 0.9447333333333333 (113368/120000), AUC 0.9921265244483948
ep8_train_time 6.776743173599243
Test Epoch8 threshold 0.1 Acc 0.9134210526315789, AUC 0.9779275059700012, avg_entr 0.035412196069955826
ep8_t0.1_test_time 0.18204283714294434
gc 0
Train Epoch9 Acc 0.9448 (113376/120000), AUC 0.9921454191207886
ep9_train_time 6.853578329086304
Test Epoch9 threshold 0.1 Acc 0.9131578947368421, AUC 0.9778963327407837, avg_entr 0.03527752682566643
ep9_t0.1_test_time 0.18182063102722168
Best AUC 0.9785994291305542
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 70.98967003822327
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m5//ag_news_linearal_l5.pt
Test threshold 0.1 Acc 0.9239473684210526, AUC 0.9846179485321045, avg_entr 0.04348374158143997
t0.1_test_time 0.17920780181884766
