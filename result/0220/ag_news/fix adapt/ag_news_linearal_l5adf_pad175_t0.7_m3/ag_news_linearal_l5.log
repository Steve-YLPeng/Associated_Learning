total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.622650146484375
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.21070833333333333 (25285/120000), AUC 0.5361315011978149
ep0_train_time 7.3437275886535645
Test Epoch0 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep0_t0.7_test_time 0.15862822532653809
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2558 (30696/120000), AUC 0.5614449977874756
ep1_train_time 6.855616807937622
Test Epoch1 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep1_t0.7_test_time 0.1570589542388916
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.27470833333333333 (32965/120000), AUC 0.5501920580863953
ep2_train_time 6.862842798233032
Test Epoch2 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep2_t0.7_test_time 0.15853142738342285
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.264475 (31737/120000), AUC 0.5448336005210876
ep3_train_time 6.869656801223755
Test Epoch3 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep3_t0.7_test_time 0.15748882293701172
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.23974166666666666 (28769/120000), AUC 0.5216325521469116
ep4_train_time 6.812019348144531
Test Epoch4 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep4_t0.7_test_time 0.1582167148590088
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.22045 (26454/120000), AUC 0.49955999851226807
ep5_train_time 6.817785978317261
Test Epoch5 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep5_t0.7_test_time 0.15776515007019043
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.20296666666666666 (24356/120000), AUC 0.48786771297454834
ep6_train_time 6.83701753616333
Test Epoch6 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep6_t0.7_test_time 0.1575784683227539
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.17555 (21066/120000), AUC 0.47726231813430786
ep7_train_time 6.842051029205322
Test Epoch7 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep7_t0.7_test_time 0.15809273719787598
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.1423 (17076/120000), AUC 0.4678739607334137
ep8_train_time 6.883910417556763
Test Epoch8 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep8_t0.7_test_time 0.15862703323364258
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.12365833333333333 (14839/120000), AUC 0.4607931077480316
ep9_train_time 6.8609938621521
Test Epoch9 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep9_t0.7_test_time 0.1578235626220703
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9786908626556396
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 71.88389658927917
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5.pt
Test threshold 0.7 Acc 0.9244736842105263, AUC 0.9849400520324707, avg_entr 0.048732418566942215
t0.7_test_time 0.15656685829162598
