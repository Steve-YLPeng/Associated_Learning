total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.3_m2//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.92476749420166
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.23744166666666666 (28493/120000), AUC 0.4566696584224701
ep0_train_time 7.2439515590667725
Test Epoch0 threshold 0.3 Acc 0.9105263157894737, AUC 0.978744387626648, avg_entr 0.04890678822994232
ep0_t0.3_test_time 0.17138409614562988
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m3//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2571 (30852/120000), AUC 0.5106104612350464
ep1_train_time 6.815683841705322
Test Epoch1 threshold 0.3 Acc 0.9126315789473685, AUC 0.9787831902503967, avg_entr 0.049084652215242386
ep1_t0.3_test_time 0.16893291473388672
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m3//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.26640833333333336 (31969/120000), AUC 0.5630280375480652
ep2_train_time 6.872572660446167
Test Epoch2 threshold 0.3 Acc 0.9134210526315789, AUC 0.9788104295730591, avg_entr 0.04909949377179146
ep2_t0.3_test_time 0.16995954513549805
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m3//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.308225 (36987/120000), AUC 0.6116849184036255
ep3_train_time 6.904159307479858
Test Epoch3 threshold 0.3 Acc 0.9123684210526316, AUC 0.9787984490394592, avg_entr 0.04869014397263527
ep3_t0.3_test_time 0.16900324821472168
gc 0
Train Epoch4 Acc 0.35551666666666665 (42662/120000), AUC 0.6410606503486633
ep4_train_time 6.959044694900513
Test Epoch4 threshold 0.3 Acc 0.9121052631578948, AUC 0.9787932634353638, avg_entr 0.04887916520237923
ep4_t0.3_test_time 0.16896319389343262
gc 0
Train Epoch5 Acc 0.36470833333333336 (43765/120000), AUC 0.6467643976211548
ep5_train_time 6.85968804359436
Test Epoch5 threshold 0.3 Acc 0.9123684210526316, AUC 0.9788053035736084, avg_entr 0.04878135025501251
ep5_t0.3_test_time 0.16924428939819336
gc 0
Train Epoch6 Acc 0.379125 (45495/120000), AUC 0.6517397165298462
ep6_train_time 6.896302938461304
Test Epoch6 threshold 0.3 Acc 0.9121052631578948, AUC 0.9787925481796265, avg_entr 0.04846104979515076
ep6_t0.3_test_time 0.16925358772277832
gc 0
Train Epoch7 Acc 0.407975 (48957/120000), AUC 0.6623426675796509
ep7_train_time 6.862736701965332
Test Epoch7 threshold 0.3 Acc 0.9126315789473685, AUC 0.9788134694099426, avg_entr 0.04843023419380188
ep7_t0.3_test_time 0.16936373710632324
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m3//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.417725 (50127/120000), AUC 0.6748812198638916
ep8_train_time 6.907147407531738
Test Epoch8 threshold 0.3 Acc 0.9121052631578948, AUC 0.978830873966217, avg_entr 0.04817837104201317
ep8_t0.3_test_time 0.168837308883667
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m3//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.407325 (48879/120000), AUC 0.6823656558990479
ep9_train_time 6.861327886581421
Test Epoch9 threshold 0.3 Acc 0.9121052631578948, AUC 0.9787998199462891, avg_entr 0.048044346272945404
ep9_t0.3_test_time 0.16903257369995117
Best AUC 0.978830873966217
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 71.84702563285828
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m3//ag_news_linearal_l5.pt
Test threshold 0.3 Acc 0.9244736842105263, AUC 0.9847345352172852, avg_entr 0.048640746623277664
t0.3_test_time 0.16866159439086914
