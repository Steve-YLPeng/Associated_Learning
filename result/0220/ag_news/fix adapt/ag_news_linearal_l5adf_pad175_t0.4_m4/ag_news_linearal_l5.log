total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 28.09584903717041
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.21555833333333332 (25867/120000), AUC 0.30920764803886414
ep0_train_time 7.345397472381592
Test Epoch0 threshold 0.4 Acc 0.9118421052631579, AUC 0.978445291519165, avg_entr 0.04667852073907852
ep0_t0.4_test_time 0.1747417449951172
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.12980833333333333 (15577/120000), AUC 0.33634960651397705
ep1_train_time 6.917473077774048
Test Epoch1 threshold 0.4 Acc 0.9118421052631579, AUC 0.9784461259841919, avg_entr 0.04656108841300011
ep1_t0.4_test_time 0.1721668243408203
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.07624166666666667 (9149/120000), AUC 0.3720206022262573
ep2_train_time 6.8889241218566895
Test Epoch2 threshold 0.4 Acc 0.9118421052631579, AUC 0.9784546494483948, avg_entr 0.04640568420290947
ep2_t0.4_test_time 0.1730794906616211
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.06973333333333333 (8368/120000), AUC 0.38658851385116577
ep3_train_time 6.955142498016357
Test Epoch3 threshold 0.4 Acc 0.9118421052631579, AUC 0.97845858335495, avg_entr 0.046292081475257874
ep3_t0.4_test_time 0.17353320121765137
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.07253333333333334 (8704/120000), AUC 0.4224889576435089
ep4_train_time 6.938647270202637
Test Epoch4 threshold 0.4 Acc 0.9110526315789473, AUC 0.978451132774353, avg_entr 0.04592050611972809
ep4_t0.4_test_time 0.17235302925109863
gc 0
Train Epoch5 Acc 0.07708333333333334 (9250/120000), AUC 0.44996029138565063
ep5_train_time 6.869554281234741
Test Epoch5 threshold 0.4 Acc 0.9113157894736842, AUC 0.9784575700759888, avg_entr 0.04593345522880554
ep5_t0.4_test_time 0.17246651649475098
gc 0
Train Epoch6 Acc 0.08171666666666667 (9806/120000), AUC 0.4682837724685669
ep6_train_time 6.9128258228302
Test Epoch6 threshold 0.4 Acc 0.9113157894736842, AUC 0.9784605503082275, avg_entr 0.04604463279247284
ep6_t0.4_test_time 0.17267537117004395
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.08663333333333334 (10396/120000), AUC 0.4869931936264038
ep7_train_time 6.838575601577759
Test Epoch7 threshold 0.4 Acc 0.9113157894736842, AUC 0.9784560799598694, avg_entr 0.04589344933629036
ep7_t0.4_test_time 0.17309927940368652
gc 0
Train Epoch8 Acc 0.090975 (10917/120000), AUC 0.5022553205490112
ep8_train_time 6.834881067276001
Test Epoch8 threshold 0.4 Acc 0.9110526315789473, AUC 0.9784539937973022, avg_entr 0.045842245221138
ep8_t0.4_test_time 0.17241549491882324
gc 0
Train Epoch9 Acc 0.09413333333333333 (11296/120000), AUC 0.5120476484298706
ep9_train_time 6.940908908843994
Test Epoch9 threshold 0.4 Acc 0.9113157894736842, AUC 0.9784591197967529, avg_entr 0.045933496206998825
ep9_t0.4_test_time 0.17278051376342773
Best AUC 0.9784605503082275
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 72.1492531299591
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5.pt
Test threshold 0.4 Acc 0.9247368421052632, AUC 0.9846749305725098, avg_entr 0.045141447335481644
t0.4_test_time 0.17095232009887695
