total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m2//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 22.59607744216919
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.20995833333333333 (25195/120000), AUC 0.3805936872959137
ep0_train_time 7.336849689483643
Test Epoch0 threshold 0.4 Acc 0.9121052631578948, AUC 0.9784417748451233, avg_entr 0.04706919938325882
ep0_t0.4_test_time 0.17870688438415527
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.19523333333333334 (23428/120000), AUC 0.3389139771461487
ep1_train_time 6.9133336544036865
Test Epoch1 threshold 0.4 Acc 0.9121052631578948, AUC 0.9784460663795471, avg_entr 0.04703260585665703
ep1_t0.4_test_time 0.16944503784179688
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.17936666666666667 (21524/120000), AUC 0.3324897885322571
ep2_train_time 6.902710199356079
Test Epoch2 threshold 0.4 Acc 0.9118421052631579, AUC 0.9784457683563232, avg_entr 0.04699132964015007
ep2_t0.4_test_time 0.170121431350708
gc 0
Train Epoch3 Acc 0.15681666666666666 (18818/120000), AUC 0.3276827931404114
ep3_train_time 6.871945858001709
Test Epoch3 threshold 0.4 Acc 0.9118421052631579, AUC 0.9784432649612427, avg_entr 0.047002390027046204
ep3_t0.4_test_time 0.16933727264404297
gc 0
Train Epoch4 Acc 0.13231666666666667 (15878/120000), AUC 0.3248800039291382
ep4_train_time 6.792627573013306
Test Epoch4 threshold 0.4 Acc 0.911578947368421, AUC 0.9784429669380188, avg_entr 0.04691139608621597
ep4_t0.4_test_time 0.17028284072875977
gc 0
Train Epoch5 Acc 0.11633333333333333 (13960/120000), AUC 0.3319883346557617
ep5_train_time 6.966768741607666
Test Epoch5 threshold 0.4 Acc 0.9118421052631579, AUC 0.9784414172172546, avg_entr 0.046679381281137466
ep5_t0.4_test_time 0.16954779624938965
gc 0
Train Epoch6 Acc 0.11045 (13254/120000), AUC 0.341879278421402
ep6_train_time 6.80729341506958
Test Epoch6 threshold 0.4 Acc 0.9118421052631579, AUC 0.9784419536590576, avg_entr 0.046661414206027985
ep6_t0.4_test_time 0.17010974884033203
gc 0
Train Epoch7 Acc 0.110025 (13203/120000), AUC 0.35520172119140625
ep7_train_time 6.920979022979736
Test Epoch7 threshold 0.4 Acc 0.9126315789473685, AUC 0.9784471988677979, avg_entr 0.04672551155090332
ep7_t0.4_test_time 0.16908907890319824
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.11613333333333334 (13936/120000), AUC 0.3705558776855469
ep8_train_time 6.9345543384552
Test Epoch8 threshold 0.4 Acc 0.9123684210526316, AUC 0.9784486293792725, avg_entr 0.04676072672009468
ep8_t0.4_test_time 0.16872501373291016
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.12248333333333333 (14698/120000), AUC 0.38157814741134644
ep9_train_time 6.833932876586914
Test Epoch9 threshold 0.4 Acc 0.9123684210526316, AUC 0.9784461259841919, avg_entr 0.046637874096632004
ep9_t0.4_test_time 0.16945195198059082
Best AUC 0.9784486293792725
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 71.90487623214722
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5.pt
Test threshold 0.4 Acc 0.9244736842105263, AUC 0.9846524596214294, avg_entr 0.04584384709596634
t0.4_test_time 0.1680765151977539
