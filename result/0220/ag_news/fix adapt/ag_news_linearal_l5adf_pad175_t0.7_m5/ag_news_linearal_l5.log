total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.391993522644043
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.9281916666666666 (111383/120000), AUC 0.9873554706573486
ep0_train_time 7.239147424697876
Test Epoch0 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep0_t0.7_test_time 0.16115450859069824
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9468333333333333 (113620/120000), AUC 0.9928603768348694
ep1_train_time 6.8751537799835205
Test Epoch1 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep1_t0.7_test_time 0.159834623336792
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.946925 (113631/120000), AUC 0.9927026033401489
ep2_train_time 6.8674211502075195
Test Epoch2 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep2_t0.7_test_time 0.15842986106872559
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9470083333333333 (113641/120000), AUC 0.9926812648773193
ep3_train_time 6.824211835861206
Test Epoch3 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep3_t0.7_test_time 0.16153669357299805
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.947 (113640/120000), AUC 0.9926565289497375
ep4_train_time 6.806728363037109
Test Epoch4 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep4_t0.7_test_time 0.15919232368469238
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9467666666666666 (113612/120000), AUC 0.9927260875701904
ep5_train_time 6.867739915847778
Test Epoch5 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep5_t0.7_test_time 0.16047191619873047
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9470166666666666 (113642/120000), AUC 0.9927486181259155
ep6_train_time 6.835052728652954
Test Epoch6 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep6_t0.7_test_time 0.1591813564300537
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9469 (113628/120000), AUC 0.9927712678909302
ep7_train_time 6.848639488220215
Test Epoch7 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep7_t0.7_test_time 0.15887808799743652
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9471583333333333 (113659/120000), AUC 0.9928091764450073
ep8_train_time 6.84090781211853
Test Epoch8 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep8_t0.7_test_time 0.16024374961853027
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.94695 (113634/120000), AUC 0.9927867650985718
ep9_train_time 6.867496728897095
Test Epoch9 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep9_t0.7_test_time 0.16064929962158203
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9786908626556396
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 71.81666731834412
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5.pt
Test threshold 0.7 Acc 0.9244736842105263, AUC 0.9849400520324707, avg_entr 0.048732418566942215
t0.7_test_time 0.15757417678833008
