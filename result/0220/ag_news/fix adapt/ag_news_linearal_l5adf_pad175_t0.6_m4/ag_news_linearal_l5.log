total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.571345329284668
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.330175 (39621/120000), AUC 0.7317466735839844
ep0_train_time 7.475343465805054
Test Epoch0 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep0_t0.6_test_time 0.16729021072387695
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.44126666666666664 (52952/120000), AUC 0.7432986497879028
ep1_train_time 7.094998836517334
Test Epoch1 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep1_t0.6_test_time 0.16405725479125977
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.38414166666666666 (46097/120000), AUC 0.7358245849609375
ep2_train_time 7.058377027511597
Test Epoch2 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep2_t0.6_test_time 0.16417813301086426
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.28249166666666664 (33899/120000), AUC 0.7130696177482605
ep3_train_time 7.028759956359863
Test Epoch3 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep3_t0.6_test_time 0.1633768081665039
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25995 (31194/120000), AUC 0.6728275418281555
ep4_train_time 7.046313762664795
Test Epoch4 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep4_t0.6_test_time 0.1641521453857422
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25750833333333334 (30901/120000), AUC 0.6504055857658386
ep5_train_time 7.034925937652588
Test Epoch5 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep5_t0.6_test_time 0.16341805458068848
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25729166666666664 (30875/120000), AUC 0.638778805732727
ep6_train_time 6.975483179092407
Test Epoch6 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep6_t0.6_test_time 0.1638035774230957
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.2571083333333333 (30853/120000), AUC 0.628425657749176
ep7_train_time 7.091767311096191
Test Epoch7 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep7_t0.6_test_time 0.16335630416870117
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.257675 (30921/120000), AUC 0.620856761932373
ep8_train_time 7.068573713302612
Test Epoch8 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep8_t0.6_test_time 0.16324472427368164
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.2581333333333333 (30976/120000), AUC 0.6144462823867798
ep9_train_time 7.026612043380737
Test Epoch9 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep9_t0.6_test_time 0.16377592086791992
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9788230657577515
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 73.86823582649231
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5.pt
Test threshold 0.6 Acc 0.9260526315789473, AUC 0.9847800135612488, avg_entr 0.04997207596898079
t0.6_test_time 0.16335034370422363
