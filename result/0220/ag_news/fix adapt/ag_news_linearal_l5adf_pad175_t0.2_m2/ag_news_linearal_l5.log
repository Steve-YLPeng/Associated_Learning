total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.089183807373047
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.20649166666666666 (24779/120000), AUC 0.48138290643692017
ep0_train_time 7.337021350860596
Test Epoch0 threshold 0.2 Acc 0.9107894736842105, AUC 0.9781409502029419, avg_entr 0.05253347009420395
ep0_t0.2_test_time 0.18153619766235352
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25988333333333336 (31186/120000), AUC 0.47804591059684753
ep1_train_time 6.779529809951782
Test Epoch1 threshold 0.2 Acc 0.9134210526315789, AUC 0.9782063961029053, avg_entr 0.04988137632608414
ep1_t0.2_test_time 0.1645948886871338
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.250525 (30063/120000), AUC 0.48812490701675415
ep2_train_time 6.782602071762085
Test Epoch2 threshold 0.2 Acc 0.9107894736842105, AUC 0.9785286784172058, avg_entr 0.05285864695906639
ep2_t0.2_test_time 0.16428303718566895
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.251925 (30231/120000), AUC 0.4884396195411682
ep3_train_time 6.771906137466431
Test Epoch3 threshold 0.2 Acc 0.9121052631578948, AUC 0.9784420132637024, avg_entr 0.05113811790943146
ep3_t0.2_test_time 0.16476202011108398
gc 0
Train Epoch4 Acc 0.2506583333333333 (30079/120000), AUC 0.4870435297489166
ep4_train_time 6.766057729721069
Test Epoch4 threshold 0.2 Acc 0.9110526315789473, AUC 0.9785684943199158, avg_entr 0.051775626838207245
ep4_t0.2_test_time 0.16402029991149902
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.26038333333333336 (31246/120000), AUC 0.48449015617370605
ep5_train_time 6.80561089515686
Test Epoch5 threshold 0.2 Acc 0.9105263157894737, AUC 0.9785956740379333, avg_entr 0.05227169767022133
ep5_t0.2_test_time 0.16463112831115723
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.27035 (32442/120000), AUC 0.48298880457878113
ep6_train_time 6.9733781814575195
Test Epoch6 threshold 0.2 Acc 0.9121052631578948, AUC 0.978507936000824, avg_entr 0.051600340753793716
ep6_t0.2_test_time 0.16418814659118652
gc 0
Train Epoch7 Acc 0.2828833333333333 (33946/120000), AUC 0.48290032148361206
ep7_train_time 6.741543769836426
Test Epoch7 threshold 0.2 Acc 0.9128947368421053, AUC 0.9783445596694946, avg_entr 0.05008571594953537
ep7_t0.2_test_time 0.16412091255187988
gc 0
Train Epoch8 Acc 0.2970583333333333 (35647/120000), AUC 0.4821765720844269
ep8_train_time 6.895395517349243
Test Epoch8 threshold 0.2 Acc 0.9123684210526316, AUC 0.9784982204437256, avg_entr 0.051199935376644135
ep8_t0.2_test_time 0.16408395767211914
gc 0
Train Epoch9 Acc 0.312525 (37503/120000), AUC 0.4813673496246338
ep9_train_time 6.85931134223938
Test Epoch9 threshold 0.2 Acc 0.9118421052631579, AUC 0.9783442616462708, avg_entr 0.05021243542432785
ep9_t0.2_test_time 0.16478347778320312
Best AUC 0.9785956740379333
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 71.37387180328369
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5.pt
Test threshold 0.2 Acc 0.9247368421052632, AUC 0.9844088554382324, avg_entr 0.05032502859830856
t0.2_test_time 0.16440510749816895
