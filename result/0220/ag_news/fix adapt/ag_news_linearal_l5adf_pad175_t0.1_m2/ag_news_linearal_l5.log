total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.860572338104248
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.3242 (38904/120000), AUC 0.46142226457595825
ep0_train_time 7.293204307556152
Test Epoch0 threshold 0.1 Acc 0.9086842105263158, AUC 0.9783347845077515, avg_entr 0.054058779031038284
ep0_t0.1_test_time 0.1658926010131836
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.29273333333333335 (35128/120000), AUC 0.4470584988594055
ep1_train_time 6.723795175552368
Test Epoch1 threshold 0.1 Acc 0.91, AUC 0.9785615801811218, avg_entr 0.05223383009433746
ep1_t0.1_test_time 0.1636066436767578
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.31900833333333334 (38281/120000), AUC 0.44236963987350464
ep2_train_time 6.701288938522339
Test Epoch2 threshold 0.1 Acc 0.9102631578947369, AUC 0.9785532355308533, avg_entr 0.051925648003816605
ep2_t0.1_test_time 0.1642608642578125
gc 0
Train Epoch3 Acc 0.35756666666666664 (42908/120000), AUC 0.4421750009059906
ep3_train_time 6.816006183624268
Test Epoch3 threshold 0.1 Acc 0.91, AUC 0.9784914255142212, avg_entr 0.05197371914982796
ep3_t0.1_test_time 0.16375374794006348
gc 0
Train Epoch4 Acc 0.417225 (50067/120000), AUC 0.44154152274131775
ep4_train_time 6.803149938583374
Test Epoch4 threshold 0.1 Acc 0.9123684210526316, AUC 0.978524923324585, avg_entr 0.05179419741034508
ep4_t0.1_test_time 0.16410541534423828
gc 0
Train Epoch5 Acc 0.36564166666666664 (43877/120000), AUC 0.4402247667312622
ep5_train_time 6.899654865264893
Test Epoch5 threshold 0.1 Acc 0.9123684210526316, AUC 0.9785500764846802, avg_entr 0.05201585218310356
ep5_t0.1_test_time 0.16416215896606445
gc 0
Train Epoch6 Acc 0.3168166666666667 (38018/120000), AUC 0.4398026764392853
ep6_train_time 6.851562261581421
Test Epoch6 threshold 0.1 Acc 0.9113157894736842, AUC 0.9785757660865784, avg_entr 0.052237868309020996
ep6_t0.1_test_time 0.1636970043182373
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.2913833333333333 (34966/120000), AUC 0.4400208592414856
ep7_train_time 6.75990891456604
Test Epoch7 threshold 0.1 Acc 0.9110526315789473, AUC 0.9786320328712463, avg_entr 0.05195103958249092
ep7_t0.1_test_time 0.16328787803649902
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.285025 (34203/120000), AUC 0.44060730934143066
ep8_train_time 6.6952831745147705
Test Epoch8 threshold 0.1 Acc 0.911578947368421, AUC 0.978482723236084, avg_entr 0.05185920000076294
ep8_t0.1_test_time 0.1636962890625
gc 0
Train Epoch9 Acc 0.28618333333333335 (34342/120000), AUC 0.4413157105445862
ep9_train_time 6.7457499504089355
Test Epoch9 threshold 0.1 Acc 0.9128947368421053, AUC 0.9785208702087402, avg_entr 0.05195234715938568
ep9_t0.1_test_time 0.16366267204284668
Best AUC 0.9786320328712463
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 70.83255290985107
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5.pt
Test threshold 0.1 Acc 0.9244736842105263, AUC 0.9848040342330933, avg_entr 0.051167335361242294
t0.1_test_time 0.1623854637145996
