total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.862828969955444
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.4058333333333333 (48700/120000), AUC 0.6206718683242798
ep0_train_time 7.183171510696411
Test Epoch0 threshold 0.1 Acc 0.911578947368421, AUC 0.9784818291664124, avg_entr 0.050987619906663895
ep0_t0.1_test_time 0.17079567909240723
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4192666666666667 (50312/120000), AUC 0.6414490938186646
ep1_train_time 6.6878674030303955
Test Epoch1 threshold 0.1 Acc 0.9121052631578948, AUC 0.9785831570625305, avg_entr 0.05102325603365898
ep1_t0.1_test_time 0.1687784194946289
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.39418333333333333 (47302/120000), AUC 0.6528822779655457
ep2_train_time 6.659955978393555
Test Epoch2 threshold 0.1 Acc 0.9121052631578948, AUC 0.9785047769546509, avg_entr 0.05054439604282379
ep2_t0.1_test_time 0.1691141128540039
gc 0
Train Epoch3 Acc 0.27865 (33438/120000), AUC 0.6501010060310364
ep3_train_time 6.659451007843018
Test Epoch3 threshold 0.1 Acc 0.9118421052631579, AUC 0.9784941077232361, avg_entr 0.0491630993783474
ep3_t0.1_test_time 0.16902613639831543
gc 0
Train Epoch4 Acc 0.25221666666666664 (30266/120000), AUC 0.6352933645248413
ep4_train_time 6.713746786117554
Test Epoch4 threshold 0.1 Acc 0.9118421052631579, AUC 0.9786849021911621, avg_entr 0.04871539771556854
ep4_t0.1_test_time 0.16874051094055176
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24936666666666665 (29924/120000), AUC 0.6142805814743042
ep5_train_time 6.7325639724731445
Test Epoch5 threshold 0.1 Acc 0.9118421052631579, AUC 0.9786752462387085, avg_entr 0.04667258635163307
ep5_t0.1_test_time 0.1683664321899414
gc 0
Train Epoch6 Acc 0.24455 (29346/120000), AUC 0.6116989850997925
ep6_train_time 6.73111367225647
Test Epoch6 threshold 0.1 Acc 0.9126315789473685, AUC 0.9788359999656677, avg_entr 0.04532020539045334
ep6_t0.1_test_time 0.1683797836303711
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.233575 (28029/120000), AUC 0.6211766004562378
ep7_train_time 6.813924074172974
Test Epoch7 threshold 0.1 Acc 0.9136842105263158, AUC 0.9787226915359497, avg_entr 0.04319757595658302
ep7_t0.1_test_time 0.16870784759521484
gc 0
Train Epoch8 Acc 0.23599166666666666 (28319/120000), AUC 0.6288817524909973
ep8_train_time 6.85040283203125
Test Epoch8 threshold 0.1 Acc 0.9126315789473685, AUC 0.9786954522132874, avg_entr 0.04187316074967384
ep8_t0.1_test_time 0.16824650764465332
gc 0
Train Epoch9 Acc 0.24708333333333332 (29650/120000), AUC 0.633036196231842
ep9_train_time 6.7215471267700195
Test Epoch9 threshold 0.1 Acc 0.9142105263157895, AUC 0.9787382483482361, avg_entr 0.04057846963405609
ep9_t0.1_test_time 0.16819381713867188
Best AUC 0.9788359999656677
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 70.35894727706909
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5.pt
Test threshold 0.1 Acc 0.9231578947368421, AUC 0.9847518801689148, avg_entr 0.044568974524736404
t0.1_test_time 0.16730451583862305
