total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.686407327651978
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.45696496963500977
ep0_train_time 8.582371234893799
Test Epoch0 threshold 0.9 Acc 0.8913157894736842, AUC 0.9717061519622803, avg_entr 0.1818653643131256
ep0_t0.9_test_time 0.16077041625976562
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24985 (29982/120000), AUC 0.41760069131851196
ep1_train_time 8.145469427108765
Test Epoch1 threshold 0.9 Acc 0.9044736842105263, AUC 0.9758870005607605, avg_entr 0.10723423957824707
ep1_t0.9_test_time 0.15900278091430664
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24985 (29982/120000), AUC 0.4251169264316559
ep2_train_time 8.156242609024048
Test Epoch2 threshold 0.9 Acc 0.9128947368421053, AUC 0.9775513410568237, avg_entr 0.08033904433250427
ep2_t0.9_test_time 0.15935015678405762
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24991666666666668 (29990/120000), AUC 0.4290867745876312
ep3_train_time 8.12697434425354
Test Epoch3 threshold 0.9 Acc 0.911578947368421, AUC 0.9782795310020447, avg_entr 0.06770258396863937
ep3_t0.9_test_time 0.15936589241027832
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.249975 (29997/120000), AUC 0.4310498833656311
ep4_train_time 8.13956069946289
Test Epoch4 threshold 0.9 Acc 0.9094736842105263, AUC 0.9786369800567627, avg_entr 0.060930658131837845
ep4_t0.9_test_time 0.15928173065185547
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24999166666666667 (29999/120000), AUC 0.4313774108886719
ep5_train_time 8.16265344619751
Test Epoch5 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep5_t0.9_test_time 0.15940403938293457
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24999166666666667 (29999/120000), AUC 0.43233218789100647
ep6_train_time 8.178706169128418
Test Epoch6 threshold 0.9 Acc 0.911578947368421, AUC 0.9787388443946838, avg_entr 0.04939013347029686
ep6_t0.9_test_time 0.16078519821166992
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.4330979585647583
ep7_train_time 8.117745161056519
Test Epoch7 threshold 0.9 Acc 0.911578947368421, AUC 0.9787800312042236, avg_entr 0.04582587257027626
ep7_t0.9_test_time 0.1608414649963379
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.43365228176116943
ep8_train_time 8.139461278915405
Test Epoch8 threshold 0.9 Acc 0.9094736842105263, AUC 0.9786969423294067, avg_entr 0.04336022213101387
ep8_t0.9_test_time 0.15906739234924316
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.43457430601119995
ep9_train_time 8.22876238822937
Test Epoch9 threshold 0.9 Acc 0.9113157894736842, AUC 0.9785618782043457, avg_entr 0.04136689007282257
ep9_t0.9_test_time 0.15946459770202637
Best AUC 0.9788055419921875
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 84.62556672096252
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5.pt
Test threshold 0.9 Acc 0.9242105263157895, AUC 0.9847592115402222, avg_entr 0.052668217569589615
t0.9_test_time 0.15776658058166504
