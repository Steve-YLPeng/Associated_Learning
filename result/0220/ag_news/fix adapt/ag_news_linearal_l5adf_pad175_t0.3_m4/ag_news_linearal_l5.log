total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.3_m3//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.1725754737854
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.26155833333333334 (31387/120000), AUC 0.6551271677017212
ep0_train_time 7.309433221817017
Test Epoch0 threshold 0.3 Acc 0.9134210526315789, AUC 0.9788292646408081, avg_entr 0.04829953983426094
ep0_t0.3_test_time 0.17392373085021973
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m4//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.28529166666666667 (34235/120000), AUC 0.6966030597686768
ep1_train_time 6.785159349441528
Test Epoch1 threshold 0.3 Acc 0.9121052631578948, AUC 0.9787914752960205, avg_entr 0.04813985899090767
ep1_t0.3_test_time 0.17314434051513672
gc 0
Train Epoch2 Acc 0.322375 (38685/120000), AUC 0.7025808691978455
ep2_train_time 6.866333484649658
Test Epoch2 threshold 0.3 Acc 0.9118421052631579, AUC 0.9787396192550659, avg_entr 0.047134801745414734
ep2_t0.3_test_time 0.17384886741638184
gc 0
Train Epoch3 Acc 0.31121666666666664 (37346/120000), AUC 0.6782671213150024
ep3_train_time 6.819378614425659
Test Epoch3 threshold 0.3 Acc 0.9121052631578948, AUC 0.978834867477417, avg_entr 0.046958550810813904
ep3_t0.3_test_time 0.17313218116760254
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m4//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.28184166666666666 (33821/120000), AUC 0.6547843217849731
ep4_train_time 6.903723239898682
Test Epoch4 threshold 0.3 Acc 0.9113157894736842, AUC 0.9787219762802124, avg_entr 0.04650067910552025
ep4_t0.3_test_time 0.17309832572937012
gc 0
Train Epoch5 Acc 0.2684666666666667 (32216/120000), AUC 0.6441824436187744
ep5_train_time 6.806743860244751
Test Epoch5 threshold 0.3 Acc 0.9113157894736842, AUC 0.9787577986717224, avg_entr 0.04631876200437546
ep5_t0.3_test_time 0.17369556427001953
gc 0
Train Epoch6 Acc 0.2621 (31452/120000), AUC 0.6409371495246887
ep6_train_time 6.910797595977783
Test Epoch6 threshold 0.3 Acc 0.9105263157894737, AUC 0.9786959886550903, avg_entr 0.04635745286941528
ep6_t0.3_test_time 0.17379188537597656
gc 0
Train Epoch7 Acc 0.2578 (30936/120000), AUC 0.6378063559532166
ep7_train_time 6.836717128753662
Test Epoch7 threshold 0.3 Acc 0.9105263157894737, AUC 0.9787560105323792, avg_entr 0.04607466980814934
ep7_t0.3_test_time 0.1739501953125
gc 0
Train Epoch8 Acc 0.25374166666666664 (30449/120000), AUC 0.637445330619812
ep8_train_time 6.865426063537598
Test Epoch8 threshold 0.3 Acc 0.9107894736842105, AUC 0.9787227511405945, avg_entr 0.046106912195682526
ep8_t0.3_test_time 0.1736607551574707
gc 0
Train Epoch9 Acc 0.25114166666666665 (30137/120000), AUC 0.6379941701889038
ep9_train_time 6.819735050201416
Test Epoch9 threshold 0.3 Acc 0.9113157894736842, AUC 0.978760838508606, avg_entr 0.04600874334573746
ep9_t0.3_test_time 0.17369484901428223
Best AUC 0.978834867477417
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 71.43731760978699
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m4//ag_news_linearal_l5.pt
Test threshold 0.3 Acc 0.9242105263157895, AUC 0.9846524596214294, avg_entr 0.04671487584710121
t0.3_test_time 0.17219090461730957
