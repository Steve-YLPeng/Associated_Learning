total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 25.47479820251465
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.9094083333333334 (109129/120000), AUC 0.987018346786499
ep0_train_time 7.191115856170654
Test Epoch0 threshold 0.4 Acc 0.911578947368421, AUC 0.9784504175186157, avg_entr 0.04607361555099487
ep0_t0.4_test_time 0.17349720001220703
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m5//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9483833333333334 (113806/120000), AUC 0.9931567311286926
ep1_train_time 6.705474138259888
Test Epoch1 threshold 0.4 Acc 0.911578947368421, AUC 0.978458046913147, avg_entr 0.04598018154501915
ep1_t0.4_test_time 0.171126127243042
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m5//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9485583333333333 (113827/120000), AUC 0.9929731488227844
ep2_train_time 6.767429351806641
Test Epoch2 threshold 0.4 Acc 0.9113157894736842, AUC 0.9784518480300903, avg_entr 0.04586554318666458
ep2_t0.4_test_time 0.17174148559570312
gc 0
Train Epoch3 Acc 0.9486166666666667 (113834/120000), AUC 0.9929567575454712
ep3_train_time 6.742961406707764
Test Epoch3 threshold 0.4 Acc 0.9113157894736842, AUC 0.9784519076347351, avg_entr 0.04589790850877762
ep3_t0.4_test_time 0.171295166015625
gc 0
Train Epoch4 Acc 0.9487 (113844/120000), AUC 0.9929770231246948
ep4_train_time 6.713271856307983
Test Epoch4 threshold 0.4 Acc 0.911578947368421, AUC 0.9784550666809082, avg_entr 0.04588785767555237
ep4_t0.4_test_time 0.17116451263427734
gc 0
Train Epoch5 Acc 0.948575 (113829/120000), AUC 0.9930375814437866
ep5_train_time 6.7790679931640625
Test Epoch5 threshold 0.4 Acc 0.9113157894736842, AUC 0.978455662727356, avg_entr 0.04583262279629707
ep5_t0.4_test_time 0.1712322235107422
gc 0
Train Epoch6 Acc 0.9486416666666667 (113837/120000), AUC 0.9930295944213867
ep6_train_time 6.966064691543579
Test Epoch6 threshold 0.4 Acc 0.9113157894736842, AUC 0.9784547090530396, avg_entr 0.04582972079515457
ep6_t0.4_test_time 0.17028141021728516
gc 0
Train Epoch7 Acc 0.9486083333333334 (113833/120000), AUC 0.9930657148361206
ep7_train_time 6.930218935012817
Test Epoch7 threshold 0.4 Acc 0.9113157894736842, AUC 0.9784550666809082, avg_entr 0.04584748297929764
ep7_t0.4_test_time 0.17102456092834473
gc 0
Train Epoch8 Acc 0.9487416666666667 (113849/120000), AUC 0.9931472539901733
ep8_train_time 6.761214017868042
Test Epoch8 threshold 0.4 Acc 0.9113157894736842, AUC 0.978455662727356, avg_entr 0.04580049216747284
ep8_t0.4_test_time 0.17061829566955566
gc 0
Train Epoch9 Acc 0.948575 (113829/120000), AUC 0.9930927753448486
ep9_train_time 6.842242002487183
Test Epoch9 threshold 0.4 Acc 0.911578947368421, AUC 0.9784559607505798, avg_entr 0.0458703376352787
ep9_t0.4_test_time 0.17077136039733887
Best AUC 0.978458046913147
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 70.90602612495422
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m5//ag_news_linearal_l5.pt
Test threshold 0.4 Acc 0.925, AUC 0.9846726059913635, avg_entr 0.045082937926054
t0.4_test_time 0.17098784446716309
