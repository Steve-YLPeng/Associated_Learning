total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.31508708000183
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.2485 (29820/120000), AUC 0.4625951051712036
ep0_train_time 8.5722815990448
Test Epoch0 threshold 0.6 Acc 0.895, AUC 0.9712380170822144, avg_entr 0.18605762720108032
ep0_t0.6_test_time 0.1617419719696045
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24833333333333332 (29800/120000), AUC 0.42025026679039
ep1_train_time 8.064090013504028
Test Epoch1 threshold 0.6 Acc 0.9055263157894737, AUC 0.9757723808288574, avg_entr 0.10779417306184769
ep1_t0.6_test_time 0.15980982780456543
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.248025 (29763/120000), AUC 0.41310861706733704
ep2_train_time 8.075406312942505
Test Epoch2 threshold 0.6 Acc 0.9097368421052632, AUC 0.9772982597351074, avg_entr 0.08106335252523422
ep2_t0.6_test_time 0.15968942642211914
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.247575 (29709/120000), AUC 0.40964025259017944
ep3_train_time 8.051116943359375
Test Epoch3 threshold 0.6 Acc 0.9118421052631579, AUC 0.9781754016876221, avg_entr 0.06797030568122864
ep3_t0.6_test_time 0.15898609161376953
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24684166666666665 (29621/120000), AUC 0.40640246868133545
ep4_train_time 8.078144311904907
Test Epoch4 threshold 0.6 Acc 0.9110526315789473, AUC 0.9785283803939819, avg_entr 0.06014294922351837
ep4_t0.6_test_time 0.15888047218322754
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24538333333333334 (29446/120000), AUC 0.404646635055542
ep5_train_time 8.118419408798218
Test Epoch5 threshold 0.6 Acc 0.9076315789473685, AUC 0.9787027835845947, avg_entr 0.05606498941779137
ep5_t0.6_test_time 0.15935945510864258
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24355833333333332 (29227/120000), AUC 0.403082937002182
ep6_train_time 8.171196222305298
Test Epoch6 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep6_t0.6_test_time 0.16017365455627441
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.24059166666666668 (28871/120000), AUC 0.40223562717437744
ep7_train_time 8.125959157943726
Test Epoch7 threshold 0.6 Acc 0.9102631578947369, AUC 0.978757381439209, avg_entr 0.04664422944188118
ep7_t0.6_test_time 0.15941524505615234
gc 0
Train Epoch8 Acc 0.23690833333333333 (28429/120000), AUC 0.401467889547348
ep8_train_time 8.06881833076477
Test Epoch8 threshold 0.6 Acc 0.9123684210526316, AUC 0.9784770011901855, avg_entr 0.04424639418721199
ep8_t0.6_test_time 0.15933728218078613
gc 0
Train Epoch9 Acc 0.23536666666666667 (28244/120000), AUC 0.4013061821460724
ep9_train_time 8.145787954330444
Test Epoch9 threshold 0.6 Acc 0.9105263157894737, AUC 0.9785233736038208, avg_entr 0.04207627475261688
ep9_t0.6_test_time 0.1588115692138672
Best AUC 0.9788230657577515
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 84.19183373451233
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5.pt
Test threshold 0.6 Acc 0.9260526315789473, AUC 0.9847800135612488, avg_entr 0.04997207596898079
t0.6_test_time 0.15786528587341309
