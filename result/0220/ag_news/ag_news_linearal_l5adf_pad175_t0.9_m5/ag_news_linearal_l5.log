total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.437438011169434
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.9170916666666666 (110051/120000), AUC 0.9861632585525513
ep0_train_time 7.455374002456665
Test Epoch0 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep0_t0.9_test_time 0.16713929176330566
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9445416666666666 (113345/120000), AUC 0.9924975633621216
ep1_train_time 7.016651153564453
Test Epoch1 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep1_t0.9_test_time 0.1627352237701416
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9449833333333333 (113398/120000), AUC 0.9923017024993896
ep2_train_time 7.051831245422363
Test Epoch2 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep2_t0.9_test_time 0.16245436668395996
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9449416666666667 (113393/120000), AUC 0.9921485185623169
ep3_train_time 7.003834247589111
Test Epoch3 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep3_t0.9_test_time 0.16194939613342285
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.94495 (113394/120000), AUC 0.9921761751174927
ep4_train_time 6.951495885848999
Test Epoch4 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep4_t0.9_test_time 0.1630544662475586
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9449583333333333 (113395/120000), AUC 0.9922254085540771
ep5_train_time 7.015406608581543
Test Epoch5 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep5_t0.9_test_time 0.16194748878479004
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9448416666666667 (113381/120000), AUC 0.9922811985015869
ep6_train_time 6.927196264266968
Test Epoch6 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep6_t0.9_test_time 0.1628246307373047
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9448416666666667 (113381/120000), AUC 0.9922278523445129
ep7_train_time 7.062174558639526
Test Epoch7 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep7_t0.9_test_time 0.16133928298950195
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9448916666666667 (113387/120000), AUC 0.9923111200332642
ep8_train_time 6.9857447147369385
Test Epoch8 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep8_t0.9_test_time 0.16186308860778809
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.944925 (113391/120000), AUC 0.9922960996627808
ep9_train_time 7.011883497238159
Test Epoch9 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep9_t0.9_test_time 0.16200971603393555
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9788055419921875
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 73.44239163398743
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5.pt
Test threshold 0.9 Acc 0.9242105263157895, AUC 0.9847592115402222, avg_entr 0.052668217569589615
t0.9_test_time 0.16089510917663574
