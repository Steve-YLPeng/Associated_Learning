total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.31960391998291
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.9071083333333333 (108853/120000), AUC 0.9858843088150024
ep0_train_time 7.443409442901611
Test Epoch0 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep0_t0.6_test_time 0.16587543487548828
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9468583333333334 (113623/120000), AUC 0.9928686618804932
ep1_train_time 7.058940887451172
Test Epoch1 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep1_t0.6_test_time 0.16382050514221191
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.947025 (113643/120000), AUC 0.9926664233207703
ep2_train_time 7.04614782333374
Test Epoch2 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep2_t0.6_test_time 0.1638791561126709
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9471083333333333 (113653/120000), AUC 0.9925826191902161
ep3_train_time 6.959229946136475
Test Epoch3 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep3_t0.6_test_time 0.16424846649169922
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9471083333333333 (113653/120000), AUC 0.9926772117614746
ep4_train_time 7.031540155410767
Test Epoch4 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep4_t0.6_test_time 0.16399621963500977
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9468666666666666 (113624/120000), AUC 0.9927228689193726
ep5_train_time 6.998856067657471
Test Epoch5 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep5_t0.6_test_time 0.1638169288635254
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9470583333333333 (113647/120000), AUC 0.9927621483802795
ep6_train_time 6.983220338821411
Test Epoch6 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep6_t0.6_test_time 0.16419625282287598
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9470416666666667 (113645/120000), AUC 0.9927723407745361
ep7_train_time 6.961038112640381
Test Epoch7 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep7_t0.6_test_time 0.16396594047546387
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9471833333333334 (113662/120000), AUC 0.9928319454193115
ep8_train_time 6.961916446685791
Test Epoch8 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep8_t0.6_test_time 0.1661374568939209
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9470583333333333 (113647/120000), AUC 0.9928560256958008
ep9_train_time 7.037834644317627
Test Epoch9 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep9_t0.6_test_time 0.16273951530456543
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9788230657577515
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 73.45072603225708
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5.pt
Test threshold 0.6 Acc 0.9260526315789473, AUC 0.9847800135612488, avg_entr 0.04997207596898079
t0.6_test_time 0.16137337684631348
