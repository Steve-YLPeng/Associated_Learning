total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.626041173934937
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.24986666666666665 (29984/120000), AUC 0.5286352038383484
ep0_train_time 8.53815507888794
Test Epoch0 threshold 0.1 Acc 0.8957894736842106, AUC 0.9715585112571716, avg_entr 0.18787717819213867
ep0_t0.1_test_time 0.16127490997314453
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24995 (29994/120000), AUC 0.5500465631484985
ep1_train_time 8.034188270568848
Test Epoch1 threshold 0.1 Acc 0.9060526315789473, AUC 0.9758297204971313, avg_entr 0.10910354554653168
ep1_t0.1_test_time 0.15993452072143555
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24991666666666668 (29990/120000), AUC 0.5504648685455322
ep2_train_time 7.94469141960144
Test Epoch2 threshold 0.1 Acc 0.9102631578947369, AUC 0.9775134325027466, avg_entr 0.08160790801048279
ep2_t0.1_test_time 0.16074800491333008
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.2499 (29988/120000), AUC 0.5496514439582825
ep3_train_time 8.212774753570557
Test Epoch3 threshold 0.1 Acc 0.91, AUC 0.9783697128295898, avg_entr 0.07065113633871078
ep3_t0.1_test_time 0.16018176078796387
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24986666666666665 (29984/120000), AUC 0.548973560333252
ep4_train_time 8.284988164901733
Test Epoch4 threshold 0.1 Acc 0.9123684210526316, AUC 0.9786467552185059, avg_entr 0.05915870890021324
ep4_t0.1_test_time 0.16035819053649902
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24988333333333335 (29986/120000), AUC 0.5486425757408142
ep5_train_time 8.209906101226807
Test Epoch5 threshold 0.1 Acc 0.9121052631578948, AUC 0.9788886308670044, avg_entr 0.05397163704037666
ep5_t0.1_test_time 0.15898418426513672
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24986666666666665 (29984/120000), AUC 0.5489133596420288
ep6_train_time 7.967740297317505
Test Epoch6 threshold 0.1 Acc 0.91, AUC 0.9788191914558411, avg_entr 0.05066550150513649
ep6_t0.1_test_time 0.1599891185760498
gc 0
Train Epoch7 Acc 0.24985833333333332 (29983/120000), AUC 0.5490265488624573
ep7_train_time 8.009318828582764
Test Epoch7 threshold 0.1 Acc 0.9110526315789473, AUC 0.9788476824760437, avg_entr 0.04609258100390434
ep7_t0.1_test_time 0.16025805473327637
gc 0
Train Epoch8 Acc 0.24985 (29982/120000), AUC 0.5498731732368469
ep8_train_time 8.030421257019043
Test Epoch8 threshold 0.1 Acc 0.9068421052631579, AUC 0.9785987138748169, avg_entr 0.046046752482652664
ep8_t0.1_test_time 0.1603853702545166
gc 0
Train Epoch9 Acc 0.24985833333333332 (29983/120000), AUC 0.5506119728088379
ep9_train_time 8.019227027893066
Test Epoch9 threshold 0.1 Acc 0.91, AUC 0.9785531163215637, avg_entr 0.04159272089600563
ep9_t0.1_test_time 0.15960383415222168
Best AUC 0.9788886308670044
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 83.91632676124573
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5.pt
Test threshold 0.1 Acc 0.9234210526315789, AUC 0.9849480390548706, avg_entr 0.05309911072254181
t0.1_test_time 0.15813279151916504
