total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.121965885162354
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.251125 (30135/120000), AUC 0.3988261818885803
ep0_train_time 7.419240236282349
Test Epoch0 threshold 0.3 Acc 0.9121052631578948, AUC 0.9787156581878662, avg_entr 0.04883356764912605
ep0_t0.3_test_time 0.16665410995483398
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m2//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24691666666666667 (29630/120000), AUC 0.45086047053337097
ep1_train_time 6.854712963104248
Test Epoch1 threshold 0.3 Acc 0.9128947368421053, AUC 0.978741466999054, avg_entr 0.04901339113712311
ep1_t0.3_test_time 0.16414403915405273
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m2//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24866666666666667 (29840/120000), AUC 0.457195520401001
ep2_train_time 6.754658460617065
Test Epoch2 threshold 0.3 Acc 0.9128947368421053, AUC 0.9787877798080444, avg_entr 0.04942956566810608
ep2_t0.3_test_time 0.16484832763671875
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m2//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24998333333333334 (29998/120000), AUC 0.458650678396225
ep3_train_time 6.7712907791137695
Test Epoch3 threshold 0.3 Acc 0.9110526315789473, AUC 0.9787165522575378, avg_entr 0.048769671469926834
ep3_t0.3_test_time 0.16449689865112305
gc 0
Train Epoch4 Acc 0.24999166666666667 (29999/120000), AUC 0.46017971634864807
ep4_train_time 6.832007646560669
Test Epoch4 threshold 0.3 Acc 0.9123684210526316, AUC 0.9787958860397339, avg_entr 0.04905311018228531
ep4_t0.3_test_time 0.1647183895111084
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m2//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24998333333333334 (29998/120000), AUC 0.45994293689727783
ep5_train_time 6.863802671432495
Test Epoch5 threshold 0.3 Acc 0.9139473684210526, AUC 0.978826105594635, avg_entr 0.049402277916669846
ep5_t0.3_test_time 0.1644458770751953
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m2//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24996666666666667 (29996/120000), AUC 0.45953187346458435
ep6_train_time 6.906445264816284
Test Epoch6 threshold 0.3 Acc 0.911578947368421, AUC 0.9787465333938599, avg_entr 0.04918660968542099
ep6_t0.3_test_time 0.16463112831115723
gc 0
Train Epoch7 Acc 0.24996666666666667 (29996/120000), AUC 0.459342896938324
ep7_train_time 6.916852951049805
Test Epoch7 threshold 0.3 Acc 0.911578947368421, AUC 0.978729784488678, avg_entr 0.048889607191085815
ep7_t0.3_test_time 0.16438579559326172
gc 0
Train Epoch8 Acc 0.24996666666666667 (29996/120000), AUC 0.4589570164680481
ep8_train_time 6.918612480163574
Test Epoch8 threshold 0.3 Acc 0.9123684210526316, AUC 0.9787948131561279, avg_entr 0.049430303275585175
ep8_t0.3_test_time 0.16401410102844238
gc 0
Train Epoch9 Acc 0.24995 (29994/120000), AUC 0.45906582474708557
ep9_train_time 6.8397650718688965
Test Epoch9 threshold 0.3 Acc 0.9118421052631579, AUC 0.9787644147872925, avg_entr 0.048982515931129456
ep9_t0.3_test_time 0.1642911434173584
Best AUC 0.978826105594635
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 71.70089888572693
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m2//ag_news_linearal_l5.pt
Test threshold 0.3 Acc 0.9239473684210526, AUC 0.9847753047943115, avg_entr 0.04935307055711746
t0.3_test_time 0.16356444358825684
