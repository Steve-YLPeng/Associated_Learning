total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m3//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.582016229629517
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.33219166666666666 (39863/120000), AUC 0.7453913688659668
ep0_train_time 7.3777711391448975
Test Epoch0 threshold 0.5 Acc 0.9123684210526316, AUC 0.9789853096008301, avg_entr 0.04590509086847305
ep0_t0.5_test_time 0.17628049850463867
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m4//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3915666666666667 (46988/120000), AUC 0.7246834635734558
ep1_train_time 6.943035125732422
Test Epoch1 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789837598800659, avg_entr 0.04586838558316231
ep1_t0.5_test_time 0.16562414169311523
gc 0
Train Epoch2 Acc 0.41686666666666666 (50024/120000), AUC 0.7053787708282471
ep2_train_time 6.875127077102661
Test Epoch2 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789845943450928, avg_entr 0.045897964388132095
ep2_t0.5_test_time 0.16715288162231445
gc 0
Train Epoch3 Acc 0.4257416666666667 (51089/120000), AUC 0.7220253944396973
ep3_train_time 6.959959030151367
Test Epoch3 threshold 0.5 Acc 0.9123684210526316, AUC 0.9789828658103943, avg_entr 0.04585888236761093
ep3_t0.5_test_time 0.16623640060424805
gc 0
Train Epoch4 Acc 0.442225 (53067/120000), AUC 0.7424294948577881
ep4_train_time 6.943885087966919
Test Epoch4 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789823889732361, avg_entr 0.04579615220427513
ep4_t0.5_test_time 0.16710329055786133
gc 0
Train Epoch5 Acc 0.39384166666666665 (47261/120000), AUC 0.7316285371780396
ep5_train_time 6.936816692352295
Test Epoch5 threshold 0.5 Acc 0.9121052631578948, AUC 0.978981077671051, avg_entr 0.04580998420715332
ep5_t0.5_test_time 0.16658782958984375
gc 0
Train Epoch6 Acc 0.3569083333333333 (42829/120000), AUC 0.7156929969787598
ep6_train_time 7.009654998779297
Test Epoch6 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789804220199585, avg_entr 0.04576704651117325
ep6_t0.5_test_time 0.1669769287109375
gc 0
Train Epoch7 Acc 0.33236666666666664 (39884/120000), AUC 0.7001588940620422
ep7_train_time 6.99665904045105
Test Epoch7 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789806008338928, avg_entr 0.045739561319351196
ep7_t0.5_test_time 0.1679682731628418
gc 0
Train Epoch8 Acc 0.3171583333333333 (38059/120000), AUC 0.6857728958129883
ep8_train_time 6.8967673778533936
Test Epoch8 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789798259735107, avg_entr 0.04569046199321747
ep8_t0.5_test_time 0.16636276245117188
gc 0
Train Epoch9 Acc 0.3088416666666667 (37061/120000), AUC 0.6768023371696472
ep9_train_time 6.9291675090789795
Test Epoch9 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789786338806152, avg_entr 0.0457371361553669
ep9_t0.5_test_time 0.16669034957885742
Best AUC 0.9789853096008301
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 72.26033687591553
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m4//ag_news_linearal_l5.pt
Test threshold 0.5 Acc 0.9231578947368421, AUC 0.9849252104759216, avg_entr 0.04485227167606354
t0.5_test_time 0.16383147239685059
