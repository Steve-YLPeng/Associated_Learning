total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.86362385749817
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.912675 (109521/120000), AUC 0.9842238426208496
ep0_train_time 7.455365419387817
Test Epoch0 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep0_t0.8_test_time 0.16608524322509766
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9419333333333333 (113032/120000), AUC 0.991600751876831
ep1_train_time 7.0672688484191895
Test Epoch1 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep1_t0.8_test_time 0.16544842720031738
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.94215 (113058/120000), AUC 0.9913944005966187
ep2_train_time 7.03600287437439
Test Epoch2 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep2_t0.8_test_time 0.16456937789916992
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.94215 (113058/120000), AUC 0.9913036823272705
ep3_train_time 7.1454126834869385
Test Epoch3 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep3_t0.8_test_time 0.16469383239746094
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9421 (113052/120000), AUC 0.991346538066864
ep4_train_time 7.061792850494385
Test Epoch4 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep4_t0.8_test_time 0.1645059585571289
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9422583333333333 (113071/120000), AUC 0.9913340210914612
ep5_train_time 7.102109909057617
Test Epoch5 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep5_t0.8_test_time 0.16411733627319336
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9422083333333333 (113065/120000), AUC 0.9913407564163208
ep6_train_time 7.065591812133789
Test Epoch6 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep6_t0.8_test_time 0.1646120548248291
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9423666666666667 (113084/120000), AUC 0.9913873076438904
ep7_train_time 7.161063194274902
Test Epoch7 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep7_t0.8_test_time 0.16341924667358398
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9422333333333334 (113068/120000), AUC 0.9914054274559021
ep8_train_time 7.06546425819397
Test Epoch8 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep8_t0.8_test_time 0.1640758514404297
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9422083333333333 (113065/120000), AUC 0.9914894104003906
ep9_train_time 7.072017192840576
Test Epoch9 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep9_t0.8_test_time 0.1638050079345703
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9788198471069336
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 74.20613479614258
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5.pt
Test threshold 0.8 Acc 0.9221052631578948, AUC 0.9848241209983826, avg_entr 0.06039261817932129
t0.8_test_time 0.16345453262329102
