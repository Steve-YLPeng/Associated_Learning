total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.636845350265503
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.4578 (54936/120000), AUC 0.7329709529876709
ep0_train_time 7.249791622161865
Test Epoch0 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep0_t0.7_test_time 0.16849303245544434
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4641 (55692/120000), AUC 0.6118881106376648
ep1_train_time 6.790801763534546
Test Epoch1 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep1_t0.7_test_time 0.15735626220703125
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.44955833333333334 (53947/120000), AUC 0.5708816647529602
ep2_train_time 6.861467599868774
Test Epoch2 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep2_t0.7_test_time 0.15859556198120117
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.42896666666666666 (51476/120000), AUC 0.5614302754402161
ep3_train_time 6.806970119476318
Test Epoch3 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep3_t0.7_test_time 0.15775775909423828
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.42063333333333336 (50476/120000), AUC 0.5706594586372375
ep4_train_time 6.882336139678955
Test Epoch4 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep4_t0.7_test_time 0.15727734565734863
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.42695833333333333 (51235/120000), AUC 0.579622745513916
ep5_train_time 6.878135681152344
Test Epoch5 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep5_t0.7_test_time 0.15767550468444824
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.4318666666666667 (51824/120000), AUC 0.58516526222229
ep6_train_time 6.900611162185669
Test Epoch6 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep6_t0.7_test_time 0.15747356414794922
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.4354 (52248/120000), AUC 0.5898692011833191
ep7_train_time 6.828412771224976
Test Epoch7 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep7_t0.7_test_time 0.15821337699890137
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.43859166666666666 (52631/120000), AUC 0.5934602618217468
ep8_train_time 6.9111487865448
Test Epoch8 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep8_t0.7_test_time 0.15829920768737793
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.440125 (52815/120000), AUC 0.5951012372970581
ep9_train_time 6.778339862823486
Test Epoch9 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep9_t0.7_test_time 0.15764641761779785
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9786908626556396
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 71.80442357063293
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5.pt
Test threshold 0.7 Acc 0.9244736842105263, AUC 0.9849400520324707, avg_entr 0.048732418566942215
t0.7_test_time 0.15731358528137207
