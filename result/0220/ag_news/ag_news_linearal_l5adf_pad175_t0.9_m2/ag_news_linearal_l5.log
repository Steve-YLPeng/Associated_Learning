total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.084362030029297
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.2690916666666667 (32291/120000), AUC 0.5490150451660156
ep0_train_time 7.538784742355347
Test Epoch0 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep0_t0.9_test_time 0.1634671688079834
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25083333333333335 (30100/120000), AUC 0.5737999677658081
ep1_train_time 7.0254786014556885
Test Epoch1 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep1_t0.9_test_time 0.16140389442443848
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2661833333333333 (31942/120000), AUC 0.5525156259536743
ep2_train_time 7.0285797119140625
Test Epoch2 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep2_t0.9_test_time 0.16119098663330078
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.36666666666666664 (44000/120000), AUC 0.5454447269439697
ep3_train_time 6.9843926429748535
Test Epoch3 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep3_t0.9_test_time 0.16048717498779297
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.44953333333333334 (53944/120000), AUC 0.5470970869064331
ep4_train_time 7.047542333602905
Test Epoch4 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep4_t0.9_test_time 0.1618502140045166
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.45926666666666666 (55112/120000), AUC 0.5473147630691528
ep5_train_time 7.001296758651733
Test Epoch5 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep5_t0.9_test_time 0.16238975524902344
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.4494166666666667 (53930/120000), AUC 0.5472009778022766
ep6_train_time 7.127726316452026
Test Epoch6 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep6_t0.9_test_time 0.1610867977142334
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.43083333333333335 (51700/120000), AUC 0.5477189421653748
ep7_train_time 7.065329313278198
Test Epoch7 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep7_t0.9_test_time 0.16103649139404297
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.40185 (48222/120000), AUC 0.5477179288864136
ep8_train_time 7.106003284454346
Test Epoch8 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep8_t0.9_test_time 0.16219878196716309
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.3737333333333333 (44848/120000), AUC 0.546990692615509
ep9_train_time 7.034348726272583
Test Epoch9 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788055419921875, avg_entr 0.05345411226153374
ep9_t0.9_test_time 0.1603250503540039
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9788055419921875
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 73.8956823348999
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5.pt
Test threshold 0.9 Acc 0.9242105263157895, AUC 0.9847592115402222, avg_entr 0.052668217569589615
t0.9_test_time 0.16049909591674805
