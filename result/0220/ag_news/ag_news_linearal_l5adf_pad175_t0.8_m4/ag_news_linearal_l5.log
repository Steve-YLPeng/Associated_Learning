total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.68878722190857
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.5882833333333334 (70594/120000), AUC 0.7401150465011597
ep0_train_time 7.418619394302368
Test Epoch0 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep0_t0.8_test_time 0.17334890365600586
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.5481166666666667 (65774/120000), AUC 0.6579158306121826
ep1_train_time 7.008403301239014
Test Epoch1 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep1_t0.8_test_time 0.16464638710021973
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.352125 (42255/120000), AUC 0.5791432857513428
ep2_train_time 7.017021894454956
Test Epoch2 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep2_t0.8_test_time 0.1657848358154297
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.2554666666666667 (30656/120000), AUC 0.5597755908966064
ep3_train_time 7.013201951980591
Test Epoch3 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep3_t0.8_test_time 0.16434311866760254
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.2515 (30180/120000), AUC 0.5509527921676636
ep4_train_time 7.019414663314819
Test Epoch4 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep4_t0.8_test_time 0.16468238830566406
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24933333333333332 (29920/120000), AUC 0.5458191633224487
ep5_train_time 7.048631429672241
Test Epoch5 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep5_t0.8_test_time 0.16372990608215332
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24870833333333334 (29845/120000), AUC 0.5436367392539978
ep6_train_time 7.126828908920288
Test Epoch6 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep6_t0.8_test_time 0.165543794631958
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.247975 (29757/120000), AUC 0.5413328409194946
ep7_train_time 7.101656436920166
Test Epoch7 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep7_t0.8_test_time 0.16396737098693848
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.24723333333333333 (29668/120000), AUC 0.539885401725769
ep8_train_time 7.077401161193848
Test Epoch8 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep8_t0.8_test_time 0.16254758834838867
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.24725 (29670/120000), AUC 0.5393995046615601
ep9_train_time 7.103824138641357
Test Epoch9 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep9_t0.8_test_time 0.16430139541625977
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9788198471069336
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 73.92769575119019
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5.pt
Test threshold 0.8 Acc 0.9221052631578948, AUC 0.9848241209983826, avg_entr 0.06039261817932129
t0.8_test_time 0.1622486114501953
