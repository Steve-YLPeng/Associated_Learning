total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.88064408302307
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.247525 (29703/120000), AUC 0.47892165184020996
ep0_train_time 7.343884468078613
Test Epoch0 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep0_t0.6_test_time 0.16169214248657227
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.247425 (29691/120000), AUC 0.45114031434059143
ep1_train_time 6.9226014614105225
Test Epoch1 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep1_t0.6_test_time 0.1597919464111328
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25015 (30018/120000), AUC 0.45407137274742126
ep2_train_time 7.002429008483887
Test Epoch2 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep2_t0.6_test_time 0.16014313697814941
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25078333333333336 (30094/120000), AUC 0.4569963812828064
ep3_train_time 7.014724254608154
Test Epoch3 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep3_t0.6_test_time 0.16048026084899902
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25145 (30174/120000), AUC 0.46016621589660645
ep4_train_time 7.080129623413086
Test Epoch4 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep4_t0.6_test_time 0.16011834144592285
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25164166666666665 (30197/120000), AUC 0.46122312545776367
ep5_train_time 6.983707904815674
Test Epoch5 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep5_t0.6_test_time 0.15952563285827637
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25146666666666667 (30176/120000), AUC 0.4620600938796997
ep6_train_time 7.004486799240112
Test Epoch6 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep6_t0.6_test_time 0.15990376472473145
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25059166666666666 (30071/120000), AUC 0.4629308879375458
ep7_train_time 7.019718170166016
Test Epoch7 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep7_t0.6_test_time 0.16083717346191406
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.24953333333333333 (29944/120000), AUC 0.46397772431373596
ep8_train_time 6.982597827911377
Test Epoch8 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep8_t0.6_test_time 0.16024470329284668
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.24850833333333333 (29821/120000), AUC 0.4647095799446106
ep9_train_time 6.979589462280273
Test Epoch9 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep9_t0.6_test_time 0.1601107120513916
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9788230657577515
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 73.26057052612305
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5.pt
Test threshold 0.6 Acc 0.9260526315789473, AUC 0.9847800135612488, avg_entr 0.04997207596898079
t0.6_test_time 0.15814590454101562
