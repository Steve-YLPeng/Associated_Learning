total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.77424454689026
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.0806 (9672/120000), AUC 0.3199150860309601
ep0_train_time 7.319700479507446
Test Epoch0 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep0_t0.7_test_time 0.16046786308288574
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.15900833333333333 (19081/120000), AUC 0.16038446128368378
ep1_train_time 6.908504962921143
Test Epoch1 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep1_t0.7_test_time 0.1580038070678711
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.124625 (14955/120000), AUC 0.15575876832008362
ep2_train_time 6.882334232330322
Test Epoch2 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep2_t0.7_test_time 0.15829730033874512
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.07565833333333333 (9079/120000), AUC 0.1491883099079132
ep3_train_time 6.844036340713501
Test Epoch3 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep3_t0.7_test_time 0.15782785415649414
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.0539 (6468/120000), AUC 0.14270146191120148
ep4_train_time 6.872594118118286
Test Epoch4 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep4_t0.7_test_time 0.1608576774597168
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.047733333333333336 (5728/120000), AUC 0.13879677653312683
ep5_train_time 6.825693368911743
Test Epoch5 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep5_t0.7_test_time 0.15823769569396973
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.042458333333333334 (5095/120000), AUC 0.13624072074890137
ep6_train_time 6.883697032928467
Test Epoch6 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep6_t0.7_test_time 0.15889406204223633
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.036908333333333335 (4429/120000), AUC 0.13390207290649414
ep7_train_time 6.939159393310547
Test Epoch7 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep7_t0.7_test_time 0.1589033603668213
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.03320833333333333 (3985/120000), AUC 0.13155288994312286
ep8_train_time 6.836617708206177
Test Epoch8 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep8_t0.7_test_time 0.15866923332214355
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.031241666666666668 (3749/120000), AUC 0.1297972947359085
ep9_train_time 6.835525274276733
Test Epoch9 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep9_t0.7_test_time 0.15812230110168457
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9786908626556396
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 72.0639579296112
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5.pt
Test threshold 0.7 Acc 0.9244736842105263, AUC 0.9849400520324707, avg_entr 0.048732418566942215
t0.7_test_time 0.1561274528503418
