total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.63474988937378
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.2565 (30780/120000), AUC 0.6846002340316772
ep0_train_time 7.309158802032471
Test Epoch0 threshold 0.5 Acc 0.9123684210526316, AUC 0.9789861440658569, avg_entr 0.04589744657278061
ep0_t0.5_test_time 0.1653120517730713
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m3//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2568166666666667 (30818/120000), AUC 0.7846646308898926
ep1_train_time 6.883543252944946
Test Epoch1 threshold 0.5 Acc 0.9126315789473685, AUC 0.978985607624054, avg_entr 0.04588478431105614
ep1_t0.5_test_time 0.1638355255126953
gc 0
Train Epoch2 Acc 0.26481666666666664 (31778/120000), AUC 0.8420806527137756
ep2_train_time 7.033775091171265
Test Epoch2 threshold 0.5 Acc 0.9123684210526316, AUC 0.9789841771125793, avg_entr 0.04586322605609894
ep2_t0.5_test_time 0.16299700736999512
gc 0
Train Epoch3 Acc 0.29104166666666664 (34925/120000), AUC 0.8762586712837219
ep3_train_time 6.916508674621582
Test Epoch3 threshold 0.5 Acc 0.9123684210526316, AUC 0.9789801836013794, avg_entr 0.04586620628833771
ep3_t0.5_test_time 0.16317248344421387
gc 0
Train Epoch4 Acc 0.335175 (40221/120000), AUC 0.8898959755897522
ep4_train_time 6.92445182800293
Test Epoch4 threshold 0.5 Acc 0.9126315789473685, AUC 0.9789829254150391, avg_entr 0.0458746962249279
ep4_t0.5_test_time 0.16435503959655762
gc 0
Train Epoch5 Acc 0.3631333333333333 (43576/120000), AUC 0.8929975032806396
ep5_train_time 6.855061292648315
Test Epoch5 threshold 0.5 Acc 0.9123684210526316, AUC 0.9789828658103943, avg_entr 0.045858681201934814
ep5_t0.5_test_time 0.1631333827972412
gc 0
Train Epoch6 Acc 0.37075833333333336 (44491/120000), AUC 0.8920639753341675
ep6_train_time 6.913773536682129
Test Epoch6 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789801836013794, avg_entr 0.04582738131284714
ep6_t0.5_test_time 0.16355514526367188
gc 0
Train Epoch7 Acc 0.3817583333333333 (45811/120000), AUC 0.8891164064407349
ep7_train_time 6.904837131500244
Test Epoch7 threshold 0.5 Acc 0.9123684210526316, AUC 0.9789772033691406, avg_entr 0.04579538851976395
ep7_t0.5_test_time 0.16365313529968262
gc 0
Train Epoch8 Acc 0.394075 (47289/120000), AUC 0.8840474486351013
ep8_train_time 6.887136459350586
Test Epoch8 threshold 0.5 Acc 0.9123684210526316, AUC 0.9789732694625854, avg_entr 0.045738279819488525
ep8_t0.5_test_time 0.16346526145935059
gc 0
Train Epoch9 Acc 0.40029166666666666 (48035/120000), AUC 0.8792093992233276
ep9_train_time 6.8657004833221436
Test Epoch9 threshold 0.5 Acc 0.9123684210526316, AUC 0.9789774417877197, avg_entr 0.04578952118754387
ep9_t0.5_test_time 0.16341257095336914
Best AUC 0.9789861440658569
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 71.84506916999817
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m3//ag_news_linearal_l5.pt
Test threshold 0.5 Acc 0.9228947368421052, AUC 0.9849264621734619, avg_entr 0.04486489295959473
t0.5_test_time 0.16213011741638184
