total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m4//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.87753987312317
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.921375 (110565/120000), AUC 0.9866737127304077
ep0_train_time 7.217353582382202
Test Epoch0 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789835214614868, avg_entr 0.045892614871263504
ep0_t0.5_test_time 0.16455960273742676
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m5//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9479666666666666 (113756/120000), AUC 0.9928638339042664
ep1_train_time 6.762415885925293
Test Epoch1 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789847135543823, avg_entr 0.045881595462560654
ep1_t0.5_test_time 0.16340017318725586
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m5//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9479416666666667 (113753/120000), AUC 0.992958664894104
ep2_train_time 6.769714117050171
Test Epoch2 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789838790893555, avg_entr 0.04587238281965256
ep2_t0.5_test_time 0.16270971298217773
gc 0
Train Epoch3 Acc 0.948075 (113769/120000), AUC 0.9930771589279175
ep3_train_time 6.742206335067749
Test Epoch3 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789848923683167, avg_entr 0.04580042138695717
ep3_t0.5_test_time 0.1630387306213379
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m5//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9481666666666667 (113780/120000), AUC 0.9931031465530396
ep4_train_time 6.762880325317383
Test Epoch4 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789837598800659, avg_entr 0.04579734057188034
ep4_t0.5_test_time 0.16380786895751953
gc 0
Train Epoch5 Acc 0.9483 (113796/120000), AUC 0.9931355118751526
ep5_train_time 6.749174118041992
Test Epoch5 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789848327636719, avg_entr 0.045764219015836716
ep5_t0.5_test_time 0.1629958152770996
gc 0
Train Epoch6 Acc 0.9482916666666666 (113795/120000), AUC 0.9931528568267822
ep6_train_time 6.7146501541137695
Test Epoch6 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789837002754211, avg_entr 0.04576681926846504
ep6_t0.5_test_time 0.1631016731262207
gc 0
Train Epoch7 Acc 0.9483583333333333 (113803/120000), AUC 0.9930707812309265
ep7_train_time 6.704536199569702
Test Epoch7 threshold 0.5 Acc 0.9121052631578948, AUC 0.978981614112854, avg_entr 0.04565504193305969
ep7_t0.5_test_time 0.16287565231323242
gc 0
Train Epoch8 Acc 0.94865 (113838/120000), AUC 0.9930704832077026
ep8_train_time 6.718432188034058
Test Epoch8 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789804816246033, avg_entr 0.04566650465130806
ep8_t0.5_test_time 0.16309690475463867
gc 0
Train Epoch9 Acc 0.9484833333333333 (113818/120000), AUC 0.9931125044822693
ep9_train_time 6.743697166442871
Test Epoch9 threshold 0.5 Acc 0.9121052631578948, AUC 0.9789797067642212, avg_entr 0.045689862221479416
ep9_t0.5_test_time 0.16276311874389648
Best AUC 0.9789848923683167
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 70.38007402420044
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m5//ag_news_linearal_l5.pt
Test threshold 0.5 Acc 0.9231578947368421, AUC 0.9849226474761963, avg_entr 0.0448254756629467
t0.5_test_time 0.16101694107055664
