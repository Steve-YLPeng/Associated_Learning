total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 22.172062397003174
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.24995 (29994/120000), AUC 0.3835304379463196
ep0_train_time 7.208988189697266
Test Epoch0 threshold 0.4 Acc 0.9131578947368421, AUC 0.9784003496170044, avg_entr 0.04658450558781624
ep0_t0.4_test_time 0.1651318073272705
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m2//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24979166666666666 (29975/120000), AUC 0.3043903708457947
ep1_train_time 6.864272594451904
Test Epoch1 threshold 0.4 Acc 0.9128947368421053, AUC 0.978435754776001, avg_entr 0.04696246609091759
ep1_t0.4_test_time 0.16295599937438965
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m2//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24973333333333333 (29968/120000), AUC 0.3118545114994049
ep2_train_time 6.706008434295654
Test Epoch2 threshold 0.4 Acc 0.9121052631578948, AUC 0.978445827960968, avg_entr 0.04708944261074066
ep2_t0.4_test_time 0.1627357006072998
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m2//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24979166666666666 (29975/120000), AUC 0.31544002890586853
ep3_train_time 6.801450252532959
Test Epoch3 threshold 0.4 Acc 0.9123684210526316, AUC 0.9784485101699829, avg_entr 0.047057248651981354
ep3_t0.4_test_time 0.16270804405212402
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m2//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.249825 (29979/120000), AUC 0.31587710976600647
ep4_train_time 6.750996828079224
Test Epoch4 threshold 0.4 Acc 0.9123684210526316, AUC 0.9784446954727173, avg_entr 0.04706769436597824
ep4_t0.4_test_time 0.1635270118713379
gc 0
Train Epoch5 Acc 0.24984166666666666 (29981/120000), AUC 0.31421250104904175
ep5_train_time 6.804630994796753
Test Epoch5 threshold 0.4 Acc 0.9126315789473685, AUC 0.978430986404419, avg_entr 0.04705888032913208
ep5_t0.4_test_time 0.16347908973693848
gc 0
Train Epoch6 Acc 0.24985833333333332 (29983/120000), AUC 0.313102662563324
ep6_train_time 6.787123918533325
Test Epoch6 threshold 0.4 Acc 0.9131578947368421, AUC 0.9784454107284546, avg_entr 0.04704025015234947
ep6_t0.4_test_time 0.1631627082824707
gc 0
Train Epoch7 Acc 0.24985833333333332 (29983/120000), AUC 0.3117033839225769
ep7_train_time 6.781470060348511
Test Epoch7 threshold 0.4 Acc 0.9107894736842105, AUC 0.9784440994262695, avg_entr 0.04710521921515465
ep7_t0.4_test_time 0.16340970993041992
gc 0
Train Epoch8 Acc 0.24985833333333332 (29983/120000), AUC 0.3100665211677551
ep8_train_time 6.710675954818726
Test Epoch8 threshold 0.4 Acc 0.9121052631578948, AUC 0.9784442186355591, avg_entr 0.04710470885038376
ep8_t0.4_test_time 0.16304802894592285
gc 0
Train Epoch9 Acc 0.24985 (29982/120000), AUC 0.3086843490600586
ep9_train_time 6.7026207447052
Test Epoch9 threshold 0.4 Acc 0.9128947368421053, AUC 0.9784399271011353, avg_entr 0.04698728770017624
ep9_t0.4_test_time 0.16230154037475586
Best AUC 0.9784485101699829
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 70.66271209716797
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m2//ag_news_linearal_l5.pt
Test threshold 0.4 Acc 0.9242105263157895, AUC 0.9846541881561279, avg_entr 0.04615921899676323
t0.4_test_time 0.16164135932922363
