total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.772099494934082
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.24701666666666666 (29642/120000), AUC 0.35375189781188965
ep0_train_time 7.3386619091033936
Test Epoch0 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep0_t0.8_test_time 0.17178058624267578
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24979166666666666 (29975/120000), AUC 0.2455984652042389
ep1_train_time 6.925640821456909
Test Epoch1 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep1_t0.8_test_time 0.16246438026428223
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24968333333333334 (29962/120000), AUC 0.2485957145690918
ep2_train_time 6.945501089096069
Test Epoch2 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep2_t0.8_test_time 0.16318106651306152
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.2495 (29940/120000), AUC 0.24942156672477722
ep3_train_time 6.9202775955200195
Test Epoch3 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep3_t0.8_test_time 0.16465282440185547
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24938333333333335 (29926/120000), AUC 0.24904464185237885
ep4_train_time 6.929094076156616
Test Epoch4 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep4_t0.8_test_time 0.1607053279876709
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24913333333333335 (29896/120000), AUC 0.24911484122276306
ep5_train_time 6.982226610183716
Test Epoch5 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep5_t0.8_test_time 0.16242337226867676
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24893333333333334 (29872/120000), AUC 0.24953311681747437
ep6_train_time 6.984709024429321
Test Epoch6 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep6_t0.8_test_time 0.16260504722595215
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.24859166666666666 (29831/120000), AUC 0.24982808530330658
ep7_train_time 6.927210807800293
Test Epoch7 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep7_t0.8_test_time 0.16338300704956055
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.24809166666666665 (29771/120000), AUC 0.24993637204170227
ep8_train_time 6.967937707901001
Test Epoch8 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep8_t0.8_test_time 0.16141510009765625
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.2478 (29736/120000), AUC 0.24974600970745087
ep9_train_time 6.9971067905426025
Test Epoch9 threshold 0.8 Acc 0.9039473684210526, AUC 0.9788198471069336, avg_entr 0.06293603032827377
ep9_t0.8_test_time 0.16149497032165527
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9788198471069336
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 72.88832235336304
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5.pt
Test threshold 0.8 Acc 0.9221052631578948, AUC 0.9848241209983826, avg_entr 0.06039261817932129
t0.8_test_time 0.16175007820129395
