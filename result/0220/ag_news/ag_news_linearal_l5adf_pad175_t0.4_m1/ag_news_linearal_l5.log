total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 24.06695032119751
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.24998333333333334 (29998/120000), AUC 0.45794400572776794
ep0_train_time 8.454938650131226
Test Epoch0 threshold 0.4 Acc 0.8918421052631579, AUC 0.970733642578125, avg_entr 0.19145184755325317
ep0_t0.4_test_time 0.16033411026000977
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24993333333333334 (29992/120000), AUC 0.42420536279678345
ep1_train_time 8.070863723754883
Test Epoch1 threshold 0.4 Acc 0.9057894736842105, AUC 0.9753196239471436, avg_entr 0.11017832905054092
ep1_t0.4_test_time 0.1586606502532959
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.249925 (29991/120000), AUC 0.42077332735061646
ep2_train_time 8.002116680145264
Test Epoch2 threshold 0.4 Acc 0.91, AUC 0.9769163131713867, avg_entr 0.0818924680352211
ep2_t0.4_test_time 0.16000080108642578
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24990833333333334 (29989/120000), AUC 0.4220965802669525
ep3_train_time 8.063380241394043
Test Epoch3 threshold 0.4 Acc 0.9118421052631579, AUC 0.9778674244880676, avg_entr 0.06960079818964005
ep3_t0.4_test_time 0.15830612182617188
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24991666666666668 (29990/120000), AUC 0.42423826456069946
ep4_train_time 8.023204565048218
Test Epoch4 threshold 0.4 Acc 0.9110526315789473, AUC 0.97819584608078, avg_entr 0.06213713437318802
ep4_t0.4_test_time 0.1592087745666504
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24993333333333334 (29992/120000), AUC 0.4265715479850769
ep5_train_time 7.942120552062988
Test Epoch5 threshold 0.4 Acc 0.9097368421052632, AUC 0.978412389755249, avg_entr 0.055080581456422806
ep5_t0.4_test_time 0.15931344032287598
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24995 (29994/120000), AUC 0.42931437492370605
ep6_train_time 8.110075235366821
Test Epoch6 threshold 0.4 Acc 0.9113157894736842, AUC 0.9783588647842407, avg_entr 0.04981928691267967
ep6_t0.4_test_time 0.15888166427612305
gc 0
Train Epoch7 Acc 0.24995833333333334 (29995/120000), AUC 0.43149787187576294
ep7_train_time 7.9812376499176025
Test Epoch7 threshold 0.4 Acc 0.911578947368421, AUC 0.9784243106842041, avg_entr 0.04741091653704643
ep7_t0.4_test_time 0.15892243385314941
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.24995833333333334 (29995/120000), AUC 0.4336387515068054
ep8_train_time 8.012720108032227
Test Epoch8 threshold 0.4 Acc 0.9121052631578948, AUC 0.9781942367553711, avg_entr 0.043996959924697876
ep8_t0.4_test_time 0.1597750186920166
gc 0
Train Epoch9 Acc 0.249975 (29997/120000), AUC 0.43609386682510376
ep9_train_time 7.997797966003418
Test Epoch9 threshold 0.4 Acc 0.9118421052631579, AUC 0.9780534505844116, avg_entr 0.04207591712474823
ep9_t0.4_test_time 0.1586930751800537
Best AUC 0.9784243106842041
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 83.37106418609619
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5.pt
Test threshold 0.4 Acc 0.9257894736842105, AUC 0.9847031831741333, avg_entr 0.04646759852766991
t0.4_test_time 0.15772557258605957
