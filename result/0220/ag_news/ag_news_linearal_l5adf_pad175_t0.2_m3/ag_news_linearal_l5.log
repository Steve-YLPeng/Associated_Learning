total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.117828607559204
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.44138333333333335 (52966/120000), AUC 0.6484981775283813
ep0_train_time 7.2757978439331055
Test Epoch0 threshold 0.2 Acc 0.9105263157894737, AUC 0.9785683751106262, avg_entr 0.05221658945083618
ep0_t0.2_test_time 0.18217015266418457
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.44759166666666667 (53711/120000), AUC 0.6818721890449524
ep1_train_time 6.711091995239258
Test Epoch1 threshold 0.2 Acc 0.9102631578947369, AUC 0.9785784482955933, avg_entr 0.0524081289768219
ep1_t0.2_test_time 0.16741371154785156
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.43775 (52530/120000), AUC 0.6859769821166992
ep2_train_time 6.670915365219116
Test Epoch2 threshold 0.2 Acc 0.9107894736842105, AUC 0.9785395264625549, avg_entr 0.051589079201221466
ep2_t0.2_test_time 0.16697359085083008
gc 0
Train Epoch3 Acc 0.44560833333333333 (53473/120000), AUC 0.6904299259185791
ep3_train_time 6.693673372268677
Test Epoch3 threshold 0.2 Acc 0.9107894736842105, AUC 0.9785700440406799, avg_entr 0.05139726772904396
ep3_t0.2_test_time 0.1674797534942627
gc 0
Train Epoch4 Acc 0.4625666666666667 (55508/120000), AUC 0.6869392395019531
ep4_train_time 6.762001276016235
Test Epoch4 threshold 0.2 Acc 0.9118421052631579, AUC 0.9785811305046082, avg_entr 0.05074060708284378
ep4_t0.2_test_time 0.1684246063232422
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.468475 (56217/120000), AUC 0.6801882982254028
ep5_train_time 6.702017307281494
Test Epoch5 threshold 0.2 Acc 0.9131578947368421, AUC 0.9784372448921204, avg_entr 0.04955516755580902
ep5_t0.2_test_time 0.16706490516662598
gc 0
Train Epoch6 Acc 0.46791666666666665 (56150/120000), AUC 0.6713979244232178
ep6_train_time 6.7155091762542725
Test Epoch6 threshold 0.2 Acc 0.9113157894736842, AUC 0.9785023927688599, avg_entr 0.04975495859980583
ep6_t0.2_test_time 0.1673436164855957
gc 0
Train Epoch7 Acc 0.46574166666666666 (55889/120000), AUC 0.6642141342163086
ep7_train_time 6.790982961654663
Test Epoch7 threshold 0.2 Acc 0.9128947368421053, AUC 0.9784430265426636, avg_entr 0.04897122085094452
ep7_t0.2_test_time 0.16661310195922852
gc 0
Train Epoch8 Acc 0.4609333333333333 (55312/120000), AUC 0.659360408782959
ep8_train_time 6.615784168243408
Test Epoch8 threshold 0.2 Acc 0.9113157894736842, AUC 0.9785763025283813, avg_entr 0.049064330756664276
ep8_t0.2_test_time 0.1673898696899414
gc 0
Train Epoch9 Acc 0.4557583333333333 (54691/120000), AUC 0.6582823991775513
ep9_train_time 6.674786567687988
Test Epoch9 threshold 0.2 Acc 0.9113157894736842, AUC 0.9785998463630676, avg_entr 0.04913675785064697
ep9_t0.2_test_time 0.1672666072845459
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9785998463630676
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 70.2176923751831
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5.pt
Test threshold 0.2 Acc 0.9236842105263158, AUC 0.984332799911499, avg_entr 0.047197457402944565
t0.2_test_time 0.16664791107177734
