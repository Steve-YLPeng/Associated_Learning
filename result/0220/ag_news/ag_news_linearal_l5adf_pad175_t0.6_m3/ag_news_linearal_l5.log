total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.786860466003418
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.24931666666666666 (29918/120000), AUC 0.41732078790664673
ep0_train_time 7.512743234634399
Test Epoch0 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep0_t0.6_test_time 0.16378998756408691
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24861666666666668 (29834/120000), AUC 0.4731866121292114
ep1_train_time 7.011995077133179
Test Epoch1 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep1_t0.6_test_time 0.16222023963928223
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24879166666666666 (29855/120000), AUC 0.6124961376190186
ep2_train_time 7.038354396820068
Test Epoch2 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep2_t0.6_test_time 0.162916898727417
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24945833333333334 (29935/120000), AUC 0.7441785335540771
ep3_train_time 7.032250881195068
Test Epoch3 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep3_t0.6_test_time 0.16218328475952148
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.2503416666666667 (30041/120000), AUC 0.7755525708198547
ep4_train_time 7.034775257110596
Test Epoch4 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep4_t0.6_test_time 0.1630263328552246
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.251125 (30135/120000), AUC 0.7890691161155701
ep5_train_time 7.004237174987793
Test Epoch5 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep5_t0.6_test_time 0.16179919242858887
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.2514 (30168/120000), AUC 0.7939738631248474
ep6_train_time 7.035205364227295
Test Epoch6 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep6_t0.6_test_time 0.16225576400756836
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25151666666666667 (30182/120000), AUC 0.793865442276001
ep7_train_time 7.08573579788208
Test Epoch7 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep7_t0.6_test_time 0.1627495288848877
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.251225 (30147/120000), AUC 0.7840763330459595
ep8_train_time 6.998366117477417
Test Epoch8 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep8_t0.6_test_time 0.16323423385620117
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.251725 (30207/120000), AUC 0.7709147334098816
ep9_train_time 7.150261640548706
Test Epoch9 threshold 0.6 Acc 0.9102631578947369, AUC 0.9788230657577515, avg_entr 0.05115126445889473
ep9_t0.6_test_time 0.16189289093017578
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5.pt  ,ep 9
Best AUC 0.9788230657577515
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 73.85053777694702
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5.pt
Test threshold 0.6 Acc 0.9260526315789473, AUC 0.9847800135612488, avg_entr 0.04997207596898079
t0.6_test_time 0.16201472282409668
