total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.063495635986328
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.27574166666666666 (33089/120000), AUC 0.5976033210754395
ep0_train_time 7.231220006942749
Test Epoch0 threshold 0.2 Acc 0.9118421052631579, AUC 0.9785562753677368, avg_entr 0.04948887974023819
ep0_t0.2_test_time 0.20063519477844238
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m4//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.22990833333333333 (27589/120000), AUC 0.5811403393745422
ep1_train_time 6.746072292327881
Test Epoch1 threshold 0.2 Acc 0.9105263157894737, AUC 0.9785783290863037, avg_entr 0.04863104969263077
ep1_t0.2_test_time 0.17106294631958008
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m4//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.17684166666666667 (21221/120000), AUC 0.5629222393035889
ep2_train_time 6.6444268226623535
Test Epoch2 threshold 0.2 Acc 0.9110526315789473, AUC 0.9785804748535156, avg_entr 0.046904634684324265
ep2_t0.2_test_time 0.17224740982055664
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m4//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.172875 (20745/120000), AUC 0.5764545798301697
ep3_train_time 6.743605613708496
Test Epoch3 threshold 0.2 Acc 0.9105263157894737, AUC 0.9786508083343506, avg_entr 0.04508271813392639
ep3_t0.2_test_time 0.1737968921661377
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m4//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.15601666666666666 (18722/120000), AUC 0.583078920841217
ep4_train_time 6.711774826049805
Test Epoch4 threshold 0.2 Acc 0.9102631578947369, AUC 0.9786072969436646, avg_entr 0.04434136301279068
ep4_t0.2_test_time 0.17292165756225586
gc 0
Train Epoch5 Acc 0.14421666666666666 (17306/120000), AUC 0.5866416692733765
ep5_train_time 6.953352212905884
Test Epoch5 threshold 0.2 Acc 0.9107894736842105, AUC 0.9783750772476196, avg_entr 0.04428838565945625
ep5_t0.2_test_time 0.17306089401245117
gc 0
Train Epoch6 Acc 0.136 (16320/120000), AUC 0.5885499715805054
ep6_train_time 6.856788396835327
Test Epoch6 threshold 0.2 Acc 0.9107894736842105, AUC 0.9783996939659119, avg_entr 0.04411055147647858
ep6_t0.2_test_time 0.17325282096862793
gc 0
Train Epoch7 Acc 0.12890833333333335 (15469/120000), AUC 0.5901510715484619
ep7_train_time 6.75480318069458
Test Epoch7 threshold 0.2 Acc 0.9126315789473685, AUC 0.9784547090530396, avg_entr 0.0436800941824913
ep7_t0.2_test_time 0.1722865104675293
gc 0
Train Epoch8 Acc 0.12495 (14994/120000), AUC 0.5913517475128174
ep8_train_time 6.886460542678833
Test Epoch8 threshold 0.2 Acc 0.9118421052631579, AUC 0.9784715175628662, avg_entr 0.04358713701367378
ep8_t0.2_test_time 0.17259693145751953
gc 0
Train Epoch9 Acc 0.12085 (14502/120000), AUC 0.5924942493438721
ep9_train_time 6.644983530044556
Test Epoch9 threshold 0.2 Acc 0.9113157894736842, AUC 0.9784805774688721, avg_entr 0.04327568784356117
ep9_t0.2_test_time 0.1738133430480957
Best AUC 0.9786508083343506
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 70.86650919914246
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m4//ag_news_linearal_l5.pt
Test threshold 0.2 Acc 0.9255263157894736, AUC 0.9841688871383667, avg_entr 0.04400552809238434
t0.2_test_time 0.17188525199890137
