total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.46064567565918
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.16851666666666668 (20222/120000), AUC 0.33588892221450806
ep0_train_time 8.521687030792236
Test Epoch0 threshold 0.7 Acc 0.8936842105263157, AUC 0.9716513156890869, avg_entr 0.19009153544902802
ep0_t0.7_test_time 0.1600494384765625
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.09473333333333334 (11368/120000), AUC 0.23024331033229828
ep1_train_time 8.074041843414307
Test Epoch1 threshold 0.7 Acc 0.9042105263157895, AUC 0.9754430651664734, avg_entr 0.11125896126031876
ep1_t0.7_test_time 0.15913629531860352
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.08654166666666667 (10385/120000), AUC 0.22760841250419617
ep2_train_time 8.095888137817383
Test Epoch2 threshold 0.7 Acc 0.9097368421052632, AUC 0.9772202968597412, avg_entr 0.08378948271274567
ep2_t0.7_test_time 0.15980267524719238
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.17054166666666667 (20465/120000), AUC 0.23144444823265076
ep3_train_time 8.047094106674194
Test Epoch3 threshold 0.7 Acc 0.9107894736842105, AUC 0.9779347777366638, avg_entr 0.06986313313245773
ep3_t0.7_test_time 0.15897774696350098
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.22369166666666668 (26843/120000), AUC 0.23622411489486694
ep4_train_time 8.078279733657837
Test Epoch4 threshold 0.7 Acc 0.9128947368421053, AUC 0.978556752204895, avg_entr 0.060279060155153275
ep4_t0.7_test_time 0.15736174583435059
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24106666666666668 (28928/120000), AUC 0.24024096131324768
ep5_train_time 8.091552019119263
Test Epoch5 threshold 0.7 Acc 0.9113157894736842, AUC 0.978401243686676, avg_entr 0.05606687813997269
ep5_t0.7_test_time 0.15853476524353027
gc 0
Train Epoch6 Acc 0.246425 (29571/120000), AUC 0.24427929520606995
ep6_train_time 8.103094577789307
Test Epoch6 threshold 0.7 Acc 0.9107894736842105, AUC 0.9786908626556396, avg_entr 0.04989993944764137
ep6_t0.7_test_time 0.15863966941833496
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.248275 (29793/120000), AUC 0.24754732847213745
ep7_train_time 8.107620000839233
Test Epoch7 threshold 0.7 Acc 0.9113157894736842, AUC 0.9783701300621033, avg_entr 0.04571184888482094
ep7_t0.7_test_time 0.15846848487854004
gc 0
Train Epoch8 Acc 0.24903333333333333 (29884/120000), AUC 0.2503247559070587
ep8_train_time 8.132351636886597
Test Epoch8 threshold 0.7 Acc 0.9123684210526316, AUC 0.9785220623016357, avg_entr 0.04310665652155876
ep8_t0.7_test_time 0.15781545639038086
gc 0
Train Epoch9 Acc 0.2493 (29916/120000), AUC 0.25285816192626953
ep9_train_time 8.151965618133545
Test Epoch9 threshold 0.7 Acc 0.908157894736842, AUC 0.9782854914665222, avg_entr 0.042397480458021164
ep9_t0.7_test_time 0.15826010704040527
Best AUC 0.9786908626556396
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 84.05359435081482
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5.pt
Test threshold 0.7 Acc 0.9244736842105263, AUC 0.9849400520324707, avg_entr 0.048732418566942215
t0.7_test_time 0.15667366981506348
