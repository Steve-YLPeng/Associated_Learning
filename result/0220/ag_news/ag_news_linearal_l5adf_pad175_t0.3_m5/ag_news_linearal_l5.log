total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.3_m4//ag_news_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.887749910354614
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.9134416666666667 (109613/120000), AUC 0.9865764379501343
ep0_train_time 7.350154161453247
Test Epoch0 threshold 0.3 Acc 0.9105263157894737, AUC 0.9787744283676147, avg_entr 0.04688405245542526
ep0_t0.3_test_time 0.18201398849487305
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m5//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.947075 (113649/120000), AUC 0.9929245710372925
ep1_train_time 6.847882509231567
Test Epoch1 threshold 0.3 Acc 0.9113157894736842, AUC 0.9787442684173584, avg_entr 0.04641836881637573
ep1_t0.3_test_time 0.17975211143493652
gc 0
Train Epoch2 Acc 0.9474416666666666 (113693/120000), AUC 0.9927346706390381
ep2_train_time 6.866926670074463
Test Epoch2 threshold 0.3 Acc 0.9105263157894737, AUC 0.978690505027771, avg_entr 0.04624941200017929
ep2_t0.3_test_time 0.17986178398132324
gc 0
Train Epoch3 Acc 0.94725 (113670/120000), AUC 0.9926245212554932
ep3_train_time 6.92375111579895
Test Epoch3 threshold 0.3 Acc 0.9105263157894737, AUC 0.9786897897720337, avg_entr 0.046143803745508194
ep3_t0.3_test_time 0.18025970458984375
gc 0
Train Epoch4 Acc 0.9472833333333334 (113674/120000), AUC 0.9926174879074097
ep4_train_time 6.801314830780029
Test Epoch4 threshold 0.3 Acc 0.9113157894736842, AUC 0.9787145256996155, avg_entr 0.04601740092039108
ep4_t0.3_test_time 0.17910456657409668
gc 0
Train Epoch5 Acc 0.9474666666666667 (113696/120000), AUC 0.9926981925964355
ep5_train_time 6.859063148498535
Test Epoch5 threshold 0.3 Acc 0.911578947368421, AUC 0.9787170886993408, avg_entr 0.04609904810786247
ep5_t0.3_test_time 0.17987346649169922
gc 0
Train Epoch6 Acc 0.9474666666666667 (113696/120000), AUC 0.992673933506012
ep6_train_time 6.908674001693726
Test Epoch6 threshold 0.3 Acc 0.9126315789473685, AUC 0.9787524938583374, avg_entr 0.046053651720285416
ep6_t0.3_test_time 0.18026518821716309
gc 0
Train Epoch7 Acc 0.9474916666666666 (113699/120000), AUC 0.9927188158035278
ep7_train_time 6.884350061416626
Test Epoch7 threshold 0.3 Acc 0.9118421052631579, AUC 0.9787293672561646, avg_entr 0.04610331356525421
ep7_t0.3_test_time 0.1803572177886963
gc 0
Train Epoch8 Acc 0.9475416666666666 (113705/120000), AUC 0.9927335977554321
ep8_train_time 6.882141828536987
Test Epoch8 threshold 0.3 Acc 0.9105263157894737, AUC 0.9786874055862427, avg_entr 0.045993540436029434
ep8_t0.3_test_time 0.18034768104553223
gc 0
Train Epoch9 Acc 0.9475333333333333 (113704/120000), AUC 0.9927738904953003
ep9_train_time 6.852471113204956
Test Epoch9 threshold 0.3 Acc 0.9113157894736842, AUC 0.9787029027938843, avg_entr 0.045978762209415436
ep9_t0.3_test_time 0.18017792701721191
Best AUC 0.9787744283676147
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 71.68909740447998
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m5//ag_news_linearal_l5.pt
Test threshold 0.3 Acc 0.9236842105263158, AUC 0.9846815466880798, avg_entr 0.046662408858537674
t0.3_test_time 0.17981743812561035
