total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 20.246819734573364
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.2559166666666667 (30710/120000), AUC 0.609768807888031
ep0_train_time 8.594573020935059
Test Epoch0 threshold 0.5 Acc 0.8944736842105263, AUC 0.970855712890625, avg_entr 0.1882266402244568
ep0_t0.5_test_time 0.16203975677490234
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.28186666666666665 (33824/120000), AUC 0.6825447082519531
ep1_train_time 7.987297058105469
Test Epoch1 threshold 0.5 Acc 0.906578947368421, AUC 0.9753615856170654, avg_entr 0.10735224187374115
ep1_t0.5_test_time 0.16131901741027832
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.30598333333333333 (36718/120000), AUC 0.6871949434280396
ep2_train_time 8.145514011383057
Test Epoch2 threshold 0.5 Acc 0.9097368421052632, AUC 0.9772039651870728, avg_entr 0.08278075605630875
ep2_t0.5_test_time 0.1611936092376709
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.32979166666666665 (39575/120000), AUC 0.683637261390686
ep3_train_time 8.103193759918213
Test Epoch3 threshold 0.5 Acc 0.9078947368421053, AUC 0.9782087206840515, avg_entr 0.07102193683385849
ep3_t0.5_test_time 0.16113853454589844
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.3525916666666667 (42311/120000), AUC 0.678998589515686
ep4_train_time 8.088616847991943
Test Epoch4 threshold 0.5 Acc 0.9057894736842105, AUC 0.9786934852600098, avg_entr 0.06340381503105164
ep4_t0.5_test_time 0.16042876243591309
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.3698416666666667 (44381/120000), AUC 0.6745272874832153
ep5_train_time 8.044409036636353
Test Epoch5 threshold 0.5 Acc 0.911578947368421, AUC 0.9788932204246521, avg_entr 0.05395957827568054
ep5_t0.5_test_time 0.16132450103759766
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.3804916666666667 (45659/120000), AUC 0.6701807975769043
ep6_train_time 8.084408044815063
Test Epoch6 threshold 0.5 Acc 0.9060526315789473, AUC 0.9788835048675537, avg_entr 0.052725426852703094
ep6_t0.5_test_time 0.1617274284362793
gc 0
Train Epoch7 Acc 0.38055 (45666/120000), AUC 0.6671565175056458
ep7_train_time 8.07207465171814
Test Epoch7 threshold 0.5 Acc 0.9123684210526316, AUC 0.9789841175079346, avg_entr 0.046063296496868134
ep7_t0.5_test_time 0.1617598533630371
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.368075 (44169/120000), AUC 0.6641561985015869
ep8_train_time 8.090956449508667
Test Epoch8 threshold 0.5 Acc 0.9123684210526316, AUC 0.9786704182624817, avg_entr 0.044393621385097504
ep8_t0.5_test_time 0.1608877182006836
gc 0
Train Epoch9 Acc 0.346275 (41553/120000), AUC 0.6617746353149414
ep9_train_time 8.065798044204712
Test Epoch9 threshold 0.5 Acc 0.9105263157894737, AUC 0.9786010980606079, avg_entr 0.04206880182027817
ep9_t0.5_test_time 0.1612992286682129
Best AUC 0.9789841175079346
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 84.00940108299255
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5.pt
Test threshold 0.5 Acc 0.9234210526315789, AUC 0.9849312901496887, avg_entr 0.045016106218099594
t0.5_test_time 0.15789508819580078
