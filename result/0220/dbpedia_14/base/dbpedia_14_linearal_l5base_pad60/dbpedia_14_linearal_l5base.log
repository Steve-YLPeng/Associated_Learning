total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 59.44347333908081
Start Training
gc 0
Train Epoch0 Acc 0.8811303571428571 (493433/560000), AUC 0.9866079092025757
ep0_train_time 106.75152087211609
Test Epoch0 layer4 Acc 0.9742, AUC 0.9984793066978455, avg_entr 0.06166577711701393
ep0_l4_test_time 2.1946280002593994
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad60//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9779571428571429 (547656/560000), AUC 0.9987092614173889
ep1_train_time 78.09432649612427
Test Epoch1 layer4 Acc 0.9761142857142857, AUC 0.9985062479972839, avg_entr 0.022224096581339836
ep1_l4_test_time 0.7373833656311035
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad60//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9798071428571429 (548692/560000), AUC 0.9986190795898438
ep2_train_time 101.5038251876831
Test Epoch2 layer4 Acc 0.9763428571428572, AUC 0.9979889988899231, avg_entr 0.011532172560691833
ep2_l4_test_time 2.1257450580596924
gc 0
Train Epoch3 Acc 0.9805642857142857 (549116/560000), AUC 0.9984503388404846
ep3_train_time 103.02067804336548
Test Epoch3 layer4 Acc 0.9764857142857143, AUC 0.997817873954773, avg_entr 0.007988464087247849
ep3_l4_test_time 2.1736645698547363
gc 0
Train Epoch4 Acc 0.9811821428571429 (549462/560000), AUC 0.9984699487686157
ep4_train_time 103.22289800643921
Test Epoch4 layer4 Acc 0.9768857142857142, AUC 0.9974783658981323, avg_entr 0.006607958115637302
ep4_l4_test_time 2.1722421646118164
gc 0
Train Epoch5 Acc 0.9817428571428571 (549776/560000), AUC 0.9985156655311584
ep5_train_time 103.05873417854309
Test Epoch5 layer4 Acc 0.9771142857142857, AUC 0.9976144433021545, avg_entr 0.005721734836697578
ep5_l4_test_time 2.1463401317596436
gc 0
Train Epoch6 Acc 0.9821321428571429 (549994/560000), AUC 0.9985954165458679
ep6_train_time 103.20532417297363
Test Epoch6 layer4 Acc 0.9776285714285714, AUC 0.9975042939186096, avg_entr 0.005040233954787254
ep6_l4_test_time 2.1997594833374023
gc 0
Train Epoch7 Acc 0.9825839285714286 (550247/560000), AUC 0.9986568689346313
ep7_train_time 103.19237017631531
Test Epoch7 layer4 Acc 0.9772571428571428, AUC 0.9974769949913025, avg_entr 0.00467443373054266
ep7_l4_test_time 2.1946539878845215
gc 0
Train Epoch8 Acc 0.9829017857142858 (550425/560000), AUC 0.998721718788147
ep8_train_time 102.87169861793518
Test Epoch8 layer4 Acc 0.9774285714285714, AUC 0.997651994228363, avg_entr 0.00434216670691967
ep8_l4_test_time 2.174213409423828
gc 0
Train Epoch9 Acc 0.9832178571428571 (550602/560000), AUC 0.9987168312072754
ep9_train_time 103.3346381187439
Test Epoch9 layer4 Acc 0.9778285714285714, AUC 0.9975903630256653, avg_entr 0.004332184325903654
ep9_l4_test_time 2.203476667404175
gc 0
Train Epoch10 Acc 0.9834 (550704/560000), AUC 0.9987103343009949
ep10_train_time 103.08724570274353
Test Epoch10 layer4 Acc 0.9778, AUC 0.9974604249000549, avg_entr 0.004271390847861767
ep10_l4_test_time 2.2421982288360596
gc 0
Train Epoch11 Acc 0.9837321428571428 (550890/560000), AUC 0.99876868724823
ep11_train_time 103.09979605674744
Test Epoch11 layer4 Acc 0.9780285714285715, AUC 0.9973763227462769, avg_entr 0.003736046375706792
ep11_l4_test_time 2.1482670307159424
gc 0
Train Epoch12 Acc 0.9839678571428572 (551022/560000), AUC 0.998771607875824
ep12_train_time 68.23735904693604
Test Epoch12 layer4 Acc 0.9778857142857142, AUC 0.9974002242088318, avg_entr 0.0036593060940504074
ep12_l4_test_time 2.194450616836548
gc 0
Train Epoch13 Acc 0.9841089285714286 (551101/560000), AUC 0.998747706413269
ep13_train_time 102.95733547210693
Test Epoch13 layer4 Acc 0.9781428571428571, AUC 0.99740070104599, avg_entr 0.0037175018806010485
ep13_l4_test_time 2.209789514541626
gc 0
Train Epoch14 Acc 0.9841625 (551131/560000), AUC 0.9987894892692566
ep14_train_time 103.11297607421875
Test Epoch14 layer4 Acc 0.9785714285714285, AUC 0.9973341822624207, avg_entr 0.003529632929712534
ep14_l4_test_time 2.1972272396087646
gc 0
Train Epoch15 Acc 0.984375 (551250/560000), AUC 0.9987806677818298
ep15_train_time 103.09138536453247
Test Epoch15 layer4 Acc 0.9782, AUC 0.9975029826164246, avg_entr 0.0037840022705495358
ep15_l4_test_time 2.099763870239258
gc 0
Train Epoch16 Acc 0.9845357142857143 (551340/560000), AUC 0.9988037943840027
ep16_train_time 103.10553765296936
Test Epoch16 layer4 Acc 0.9777714285714286, AUC 0.9974947571754456, avg_entr 0.0036267417017370462
ep16_l4_test_time 2.1277623176574707
gc 0
Train Epoch17 Acc 0.9846232142857143 (551389/560000), AUC 0.9988057017326355
ep17_train_time 103.26236462593079
Test Epoch17 layer4 Acc 0.9780857142857143, AUC 0.9974681735038757, avg_entr 0.00353215797804296
ep17_l4_test_time 2.092519760131836
gc 0
Train Epoch18 Acc 0.9847107142857143 (551438/560000), AUC 0.9988204836845398
ep18_train_time 103.20170259475708
Test Epoch18 layer4 Acc 0.9784857142857143, AUC 0.9975685477256775, avg_entr 0.003177716163918376
ep18_l4_test_time 2.064122438430786
gc 0
Train Epoch19 Acc 0.984825 (551502/560000), AUC 0.9988072514533997
ep19_train_time 103.28642630577087
Test Epoch19 layer4 Acc 0.9781714285714286, AUC 0.9973558783531189, avg_entr 0.0034937653690576553
ep19_l4_test_time 2.0480377674102783
gc 0
Train Epoch20 Acc 0.9848946428571429 (551541/560000), AUC 0.998829185962677
ep20_train_time 103.38884949684143
Test Epoch20 layer4 Acc 0.9788, AUC 0.9974761009216309, avg_entr 0.0033051148056983948
ep20_l4_test_time 2.1257214546203613
gc 0
Train Epoch21 Acc 0.9850642857142857 (551636/560000), AUC 0.9988274574279785
ep21_train_time 103.50693082809448
Test Epoch21 layer4 Acc 0.9783142857142857, AUC 0.9974929690361023, avg_entr 0.003235148498788476
ep21_l4_test_time 2.1135740280151367
gc 0
Train Epoch22 Acc 0.9851035714285714 (551658/560000), AUC 0.9988316297531128
ep22_train_time 80.50683498382568
Test Epoch22 layer4 Acc 0.9785428571428572, AUC 0.9975007176399231, avg_entr 0.003357857931405306
ep22_l4_test_time 0.7466728687286377
gc 0
Train Epoch23 Acc 0.985175 (551698/560000), AUC 0.9988420605659485
ep23_train_time 92.61952996253967
Test Epoch23 layer4 Acc 0.9784857142857143, AUC 0.9974375367164612, avg_entr 0.0033000160474330187
ep23_l4_test_time 2.228274345397949
gc 0
Train Epoch24 Acc 0.985325 (551782/560000), AUC 0.9988448023796082
ep24_train_time 105.64577341079712
Test Epoch24 layer4 Acc 0.9786571428571429, AUC 0.9974328875541687, avg_entr 0.003297212067991495
ep24_l4_test_time 2.2158308029174805
gc 0
Train Epoch25 Acc 0.9853803571428571 (551813/560000), AUC 0.9988738298416138
ep25_train_time 105.70445847511292
Test Epoch25 layer4 Acc 0.9787428571428571, AUC 0.9973845481872559, avg_entr 0.003162234090268612
ep25_l4_test_time 2.240177631378174
gc 0
Train Epoch26 Acc 0.9854196428571429 (551835/560000), AUC 0.9988449811935425
ep26_train_time 105.79588508605957
Test Epoch26 layer4 Acc 0.9786285714285714, AUC 0.9974068403244019, avg_entr 0.0032599298283457756
ep26_l4_test_time 2.1803348064422607
gc 0
Train Epoch27 Acc 0.9855071428571428 (551884/560000), AUC 0.9988304376602173
ep27_train_time 105.71360611915588
Test Epoch27 layer4 Acc 0.9784285714285714, AUC 0.9973026514053345, avg_entr 0.003140621120110154
ep27_l4_test_time 2.308398485183716
gc 0
Train Epoch28 Acc 0.9855375 (551901/560000), AUC 0.998858630657196
ep28_train_time 105.23563241958618
Test Epoch28 layer4 Acc 0.9784857142857143, AUC 0.9974990487098694, avg_entr 0.0030773512553423643
ep28_l4_test_time 2.2417197227478027
gc 0
Train Epoch29 Acc 0.9856946428571428 (551989/560000), AUC 0.998868465423584
ep29_train_time 105.5598509311676
Test Epoch29 layer4 Acc 0.9786571428571429, AUC 0.9973992705345154, avg_entr 0.003074204782024026
ep29_l4_test_time 2.2272589206695557
gc 0
Train Epoch30 Acc 0.9856732142857143 (551977/560000), AUC 0.9988452792167664
ep30_train_time 105.52453589439392
Test Epoch30 layer4 Acc 0.9786, AUC 0.9975223541259766, avg_entr 0.0031920054461807013
ep30_l4_test_time 2.2197976112365723
gc 0
Train Epoch31 Acc 0.9857589285714285 (552025/560000), AUC 0.9988533854484558
ep31_train_time 105.6733193397522
Test Epoch31 layer4 Acc 0.9784, AUC 0.9974345564842224, avg_entr 0.00309553649276495
ep31_l4_test_time 2.0594654083251953
gc 0
Train Epoch32 Acc 0.9857214285714285 (552004/560000), AUC 0.9988659024238586
ep32_train_time 92.38185906410217
Test Epoch32 layer4 Acc 0.9786285714285714, AUC 0.9974766969680786, avg_entr 0.003217170014977455
ep32_l4_test_time 0.7139835357666016
gc 0
Train Epoch33 Acc 0.9857875 (552041/560000), AUC 0.9988569021224976
ep33_train_time 87.57348442077637
Test Epoch33 layer4 Acc 0.9784285714285714, AUC 0.9972463846206665, avg_entr 0.002945708343759179
ep33_l4_test_time 2.2063095569610596
gc 0
Train Epoch34 Acc 0.9859535714285714 (552134/560000), AUC 0.998850405216217
ep34_train_time 105.53086042404175
Test Epoch34 layer4 Acc 0.9789142857142857, AUC 0.9971938729286194, avg_entr 0.003115593222901225
ep34_l4_test_time 2.184668779373169
gc 0
Train Epoch35 Acc 0.9860267857142857 (552175/560000), AUC 0.9988763928413391
ep35_train_time 105.48714637756348
Test Epoch35 layer4 Acc 0.9786857142857143, AUC 0.9974459409713745, avg_entr 0.0031596720218658447
ep35_l4_test_time 2.2775936126708984
gc 0
Train Epoch36 Acc 0.9860107142857143 (552166/560000), AUC 0.9988552927970886
ep36_train_time 105.70852446556091
Test Epoch36 layer4 Acc 0.9786857142857143, AUC 0.9974321722984314, avg_entr 0.003161162370815873
ep36_l4_test_time 2.2172093391418457
gc 0
Train Epoch37 Acc 0.9861482142857143 (552243/560000), AUC 0.9988412857055664
ep37_train_time 105.46030473709106
Test Epoch37 layer4 Acc 0.9789142857142857, AUC 0.997113049030304, avg_entr 0.00318377953954041
ep37_l4_test_time 2.2284066677093506
gc 0
Train Epoch38 Acc 0.9861714285714286 (552256/560000), AUC 0.9988675713539124
ep38_train_time 105.5572509765625
Test Epoch38 layer4 Acc 0.9786285714285714, AUC 0.9972265362739563, avg_entr 0.0031101920176297426
ep38_l4_test_time 2.1695430278778076
gc 0
Train Epoch39 Acc 0.9863321428571429 (552346/560000), AUC 0.9988300204277039
ep39_train_time 105.83720254898071
Test Epoch39 layer4 Acc 0.9784571428571428, AUC 0.9972333908081055, avg_entr 0.003029394196346402
ep39_l4_test_time 2.2435178756713867
gc 0
Train Epoch40 Acc 0.9862946428571429 (552325/560000), AUC 0.9988309741020203
ep40_train_time 105.9591772556305
Test Epoch40 layer4 Acc 0.9788571428571429, AUC 0.9973369240760803, avg_entr 0.003232936840504408
ep40_l4_test_time 2.177414655685425
gc 0
Train Epoch41 Acc 0.9864357142857143 (552404/560000), AUC 0.9988406300544739
ep41_train_time 105.86845111846924
Test Epoch41 layer4 Acc 0.9788857142857142, AUC 0.9974192380905151, avg_entr 0.003013822715729475
ep41_l4_test_time 2.144116163253784
gc 0
Train Epoch42 Acc 0.9863892857142857 (552378/560000), AUC 0.9988122582435608
ep42_train_time 97.17003178596497
Test Epoch42 layer4 Acc 0.9786, AUC 0.997115433216095, avg_entr 0.0029578579124063253
ep42_l4_test_time 0.7219491004943848
gc 0
Train Epoch43 Acc 0.9864553571428571 (552415/560000), AUC 0.9988182187080383
ep43_train_time 82.57696986198425
Test Epoch43 layer4 Acc 0.9783714285714286, AUC 0.9972415566444397, avg_entr 0.0030350929591804743
ep43_l4_test_time 2.2337894439697266
gc 0
Train Epoch44 Acc 0.9865214285714285 (552452/560000), AUC 0.9987939596176147
ep44_train_time 105.59353518486023
Test Epoch44 layer4 Acc 0.9784857142857143, AUC 0.9971871376037598, avg_entr 0.003270138520747423
ep44_l4_test_time 2.2008869647979736
gc 0
Train Epoch45 Acc 0.9866160714285714 (552505/560000), AUC 0.9988299012184143
ep45_train_time 105.95525813102722
Test Epoch45 layer4 Acc 0.9789428571428571, AUC 0.9970946907997131, avg_entr 0.0030318242497742176
ep45_l4_test_time 2.168623447418213
gc 0
Train Epoch46 Acc 0.986625 (552510/560000), AUC 0.998817503452301
ep46_train_time 105.40619611740112
Test Epoch46 layer4 Acc 0.9788571428571429, AUC 0.9969630837440491, avg_entr 0.003199551021680236
ep46_l4_test_time 2.1762499809265137
gc 0
Train Epoch47 Acc 0.9866839285714286 (552543/560000), AUC 0.9988177418708801
ep47_train_time 105.69481801986694
Test Epoch47 layer4 Acc 0.9783714285714286, AUC 0.9971112608909607, avg_entr 0.0029613159131258726
ep47_l4_test_time 2.1938724517822266
gc 0
Train Epoch48 Acc 0.9867125 (552559/560000), AUC 0.9988121390342712
ep48_train_time 105.6778917312622
Test Epoch48 layer4 Acc 0.9785142857142857, AUC 0.9972719550132751, avg_entr 0.003082526847720146
ep48_l4_test_time 2.142841100692749
gc 0
Train Epoch49 Acc 0.9867696428571429 (552591/560000), AUC 0.9987797737121582
ep49_train_time 105.67147755622864
Test Epoch49 layer4 Acc 0.9785428571428572, AUC 0.9970201253890991, avg_entr 0.002875010948628187
ep49_l4_test_time 2.1777710914611816
Best AUC 0.9985062479972839
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 5174.965680599213
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base_pad60//dbpedia_14_linearal_l5.pt
Test layer4 Acc 0.9757714285714286, AUC 0.9984486699104309, avg_entr 0.022439856082201004
l4_test_time 2.1905715465545654
