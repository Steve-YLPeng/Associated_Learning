total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 58.62219190597534
Start Training
gc 0
Train Epoch0 Acc 0.8934946428571429 (500357/560000), AUC 0.9884467124938965
ep0_train_time 141.5320987701416
Test Epoch0 layer4 Acc 0.9748, AUC 0.9985226392745972, avg_entr 0.0601888932287693
ep0_l4_test_time 2.9445385932922363
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad40//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9787178571428572 (548082/560000), AUC 0.9987220168113708
ep1_train_time 138.11983108520508
Test Epoch1 layer4 Acc 0.9757142857142858, AUC 0.9984922409057617, avg_entr 0.020995205268263817
ep1_l4_test_time 2.8064050674438477
gc 0
Train Epoch2 Acc 0.9802142857142857 (548920/560000), AUC 0.9985319972038269
ep2_train_time 138.07637095451355
Test Epoch2 layer4 Acc 0.9768285714285714, AUC 0.9981042742729187, avg_entr 0.010606499388813972
ep2_l4_test_time 2.9753623008728027
gc 0
Train Epoch3 Acc 0.9809196428571428 (549315/560000), AUC 0.9984254837036133
ep3_train_time 138.5357391834259
Test Epoch3 layer4 Acc 0.9768285714285714, AUC 0.9978813529014587, avg_entr 0.00723804859444499
ep3_l4_test_time 2.972745895385742
gc 0
Train Epoch4 Acc 0.9815160714285714 (549649/560000), AUC 0.9984875917434692
ep4_train_time 138.2003517150879
Test Epoch4 layer4 Acc 0.9772857142857143, AUC 0.9979566335678101, avg_entr 0.005938790272921324
ep4_l4_test_time 1.6242597103118896
gc 0
Train Epoch5 Acc 0.9819982142857143 (549919/560000), AUC 0.9985238909721375
ep5_train_time 131.0323474407196
Test Epoch5 layer4 Acc 0.9772857142857143, AUC 0.9978350400924683, avg_entr 0.005034696310758591
ep5_l4_test_time 3.0991287231445312
gc 0
Train Epoch6 Acc 0.9823821428571429 (550134/560000), AUC 0.9987064003944397
ep6_train_time 146.95317268371582
Test Epoch6 layer4 Acc 0.9778, AUC 0.9977205395698547, avg_entr 0.0046948837116360664
ep6_l4_test_time 3.193901777267456
gc 0
Train Epoch7 Acc 0.9827410714285715 (550335/560000), AUC 0.9987428784370422
ep7_train_time 147.00634956359863
Test Epoch7 layer4 Acc 0.9779714285714286, AUC 0.9977596402168274, avg_entr 0.004476876463741064
ep7_l4_test_time 3.262026071548462
gc 0
Train Epoch8 Acc 0.9831839285714286 (550583/560000), AUC 0.9988295435905457
ep8_train_time 147.29145050048828
Test Epoch8 layer4 Acc 0.9779142857142857, AUC 0.9979212880134583, avg_entr 0.004143950529396534
ep8_l4_test_time 3.1870391368865967
gc 0
Train Epoch9 Acc 0.9834 (550704/560000), AUC 0.9988117814064026
ep9_train_time 146.74561643600464
Test Epoch9 layer4 Acc 0.9780571428571428, AUC 0.9978294372558594, avg_entr 0.0038139696698635817
ep9_l4_test_time 3.245985984802246
gc 0
Train Epoch10 Acc 0.9836482142857143 (550843/560000), AUC 0.9988380670547485
ep10_train_time 146.61072707176208
Test Epoch10 layer4 Acc 0.9783142857142857, AUC 0.9978504776954651, avg_entr 0.003781715175136924
ep10_l4_test_time 3.2001492977142334
gc 0
Train Epoch11 Acc 0.9838339285714286 (550947/560000), AUC 0.9988648295402527
ep11_train_time 132.13026547431946
Test Epoch11 layer4 Acc 0.9785714285714285, AUC 0.9976943135261536, avg_entr 0.0037366612814366817
ep11_l4_test_time 3.2074832916259766
gc 0
Train Epoch12 Acc 0.9839642857142857 (551020/560000), AUC 0.9989203810691833
ep12_train_time 147.3394079208374
Test Epoch12 layer4 Acc 0.9783142857142857, AUC 0.9977794289588928, avg_entr 0.0038045737892389297
ep12_l4_test_time 3.1927359104156494
gc 0
Train Epoch13 Acc 0.9840785714285715 (551084/560000), AUC 0.9988883137702942
ep13_train_time 147.1415297985077
Test Epoch13 layer4 Acc 0.9784857142857143, AUC 0.9977443814277649, avg_entr 0.0034764688462018967
ep13_l4_test_time 3.165106773376465
gc 0
Train Epoch14 Acc 0.9842785714285714 (551196/560000), AUC 0.9989136457443237
ep14_train_time 146.86233043670654
Test Epoch14 layer4 Acc 0.9781714285714286, AUC 0.9978600740432739, avg_entr 0.003607736201956868
ep14_l4_test_time 3.145636796951294
gc 0
Train Epoch15 Acc 0.9844464285714286 (551290/560000), AUC 0.9989201426506042
ep15_train_time 147.25387573242188
Test Epoch15 layer4 Acc 0.9783428571428572, AUC 0.9978099465370178, avg_entr 0.0033889261540025473
ep15_l4_test_time 3.235960006713867
gc 0
Train Epoch16 Acc 0.9846071428571429 (551380/560000), AUC 0.9989358186721802
ep16_train_time 147.0741367340088
Test Epoch16 layer4 Acc 0.9784571428571428, AUC 0.9977970719337463, avg_entr 0.0032669720239937305
ep16_l4_test_time 3.0594756603240967
gc 0
Train Epoch17 Acc 0.9847 (551432/560000), AUC 0.9989331364631653
ep17_train_time 147.49484157562256
Test Epoch17 layer4 Acc 0.9782857142857143, AUC 0.9977400898933411, avg_entr 0.00325256516225636
ep17_l4_test_time 3.3096024990081787
gc 0
Train Epoch18 Acc 0.9848785714285714 (551532/560000), AUC 0.9989424347877502
ep18_train_time 146.96739673614502
Test Epoch18 layer4 Acc 0.9785142857142857, AUC 0.9978271126747131, avg_entr 0.00332746934145689
ep18_l4_test_time 3.1806342601776123
gc 0
Train Epoch19 Acc 0.9849125 (551551/560000), AUC 0.998948872089386
ep19_train_time 147.51839232444763
Test Epoch19 layer4 Acc 0.9781714285714286, AUC 0.9979523420333862, avg_entr 0.0033257075119763613
ep19_l4_test_time 3.290982723236084
gc 0
Train Epoch20 Acc 0.9849839285714286 (551591/560000), AUC 0.9989348649978638
ep20_train_time 133.14913940429688
Test Epoch20 layer4 Acc 0.9785142857142857, AUC 0.997787356376648, avg_entr 0.003195740282535553
ep20_l4_test_time 3.0116679668426514
gc 0
Train Epoch21 Acc 0.9850410714285714 (551623/560000), AUC 0.998926043510437
ep21_train_time 147.55691742897034
Test Epoch21 layer4 Acc 0.9784, AUC 0.9978117346763611, avg_entr 0.003237937344238162
ep21_l4_test_time 3.182570695877075
gc 0
Train Epoch22 Acc 0.9852142857142857 (551720/560000), AUC 0.998934805393219
ep22_train_time 147.4343123435974
Test Epoch22 layer4 Acc 0.9785714285714285, AUC 0.9978324174880981, avg_entr 0.003239705227315426
ep22_l4_test_time 3.1348202228546143
gc 0
Train Epoch23 Acc 0.9852053571428572 (551715/560000), AUC 0.9989549517631531
ep23_train_time 147.7394313812256
Test Epoch23 layer4 Acc 0.9783142857142857, AUC 0.9978913068771362, avg_entr 0.003144318936392665
ep23_l4_test_time 3.2051632404327393
gc 0
Train Epoch24 Acc 0.9854089285714286 (551829/560000), AUC 0.9989582896232605
ep24_train_time 147.14999890327454
Test Epoch24 layer4 Acc 0.9784857142857143, AUC 0.9979485869407654, avg_entr 0.0031102795619517565
ep24_l4_test_time 3.2062833309173584
gc 0
Train Epoch25 Acc 0.9854571428571428 (551856/560000), AUC 0.9989432096481323
ep25_train_time 147.76930856704712
Test Epoch25 layer4 Acc 0.9787142857142858, AUC 0.997969925403595, avg_entr 0.003082397161051631
ep25_l4_test_time 3.1970105171203613
gc 0
Train Epoch26 Acc 0.9856 (551936/560000), AUC 0.998960554599762
ep26_train_time 147.64671802520752
Test Epoch26 layer4 Acc 0.9787714285714286, AUC 0.9978801608085632, avg_entr 0.0031812009401619434
ep26_l4_test_time 3.236891269683838
gc 0
Train Epoch27 Acc 0.9855553571428571 (551911/560000), AUC 0.9989592432975769
ep27_train_time 132.02649426460266
Test Epoch27 layer4 Acc 0.9786857142857143, AUC 0.997791588306427, avg_entr 0.0030705975368618965
ep27_l4_test_time 3.2009081840515137
gc 0
Train Epoch28 Acc 0.9857303571428572 (552009/560000), AUC 0.9989780783653259
ep28_train_time 147.92509078979492
Test Epoch28 layer4 Acc 0.9789142857142857, AUC 0.9977750778198242, avg_entr 0.0030488751363009214
ep28_l4_test_time 3.203836679458618
gc 0
Train Epoch29 Acc 0.9858821428571428 (552094/560000), AUC 0.9989615678787231
ep29_train_time 147.57141017913818
Test Epoch29 layer4 Acc 0.9785714285714285, AUC 0.9979336857795715, avg_entr 0.003132221754640341
ep29_l4_test_time 3.19734525680542
gc 0
Train Epoch30 Acc 0.9858714285714286 (552088/560000), AUC 0.998972475528717
ep30_train_time 147.40872645378113
Test Epoch30 layer4 Acc 0.9790857142857143, AUC 0.9979297518730164, avg_entr 0.0032689576037228107
ep30_l4_test_time 3.0158023834228516
gc 0
Train Epoch31 Acc 0.9859535714285714 (552134/560000), AUC 0.9989871978759766
ep31_train_time 147.51861548423767
Test Epoch31 layer4 Acc 0.9787428571428571, AUC 0.9977508187294006, avg_entr 0.0030335141345858574
ep31_l4_test_time 3.2185537815093994
gc 0
Train Epoch32 Acc 0.9860660714285714 (552197/560000), AUC 0.9989914894104004
ep32_train_time 147.80018782615662
Test Epoch32 layer4 Acc 0.9787428571428571, AUC 0.9978317618370056, avg_entr 0.0030748932622373104
ep32_l4_test_time 3.204083204269409
gc 0
Train Epoch33 Acc 0.9860982142857143 (552215/560000), AUC 0.9989895224571228
ep33_train_time 148.07524228096008
Test Epoch33 layer4 Acc 0.9788571428571429, AUC 0.9977968335151672, avg_entr 0.0030801822431385517
ep33_l4_test_time 3.2621285915374756
gc 0
Train Epoch34 Acc 0.9861964285714285 (552270/560000), AUC 0.9989935755729675
ep34_train_time 147.44752955436707
Test Epoch34 layer4 Acc 0.9784857142857143, AUC 0.9979336857795715, avg_entr 0.003076123306527734
ep34_l4_test_time 3.21848464012146
gc 0
Train Epoch35 Acc 0.9862553571428572 (552303/560000), AUC 0.9990201592445374
ep35_train_time 133.88129591941833
Test Epoch35 layer4 Acc 0.9786285714285714, AUC 0.9977571368217468, avg_entr 0.0031596000771969557
ep35_l4_test_time 3.1794416904449463
gc 0
Train Epoch36 Acc 0.9863321428571429 (552346/560000), AUC 0.9989985823631287
ep36_train_time 147.61425733566284
Test Epoch36 layer4 Acc 0.9786285714285714, AUC 0.9978575706481934, avg_entr 0.0030501617584377527
ep36_l4_test_time 3.226102352142334
gc 0
Train Epoch37 Acc 0.9864053571428572 (552387/560000), AUC 0.9990156888961792
ep37_train_time 147.54002690315247
Test Epoch37 layer4 Acc 0.9786285714285714, AUC 0.9977340698242188, avg_entr 0.003040508134290576
ep37_l4_test_time 3.197824478149414
gc 0
Train Epoch38 Acc 0.9864607142857142 (552418/560000), AUC 0.9990164041519165
ep38_train_time 147.38073086738586
Test Epoch38 layer4 Acc 0.9788285714285714, AUC 0.9977689981460571, avg_entr 0.003193914657458663
ep38_l4_test_time 3.159776210784912
gc 0
Train Epoch39 Acc 0.9865714285714285 (552480/560000), AUC 0.9990283250808716
ep39_train_time 147.78447365760803
Test Epoch39 layer4 Acc 0.9790571428571428, AUC 0.9977810978889465, avg_entr 0.003091836115345359
ep39_l4_test_time 3.2094032764434814
gc 0
Train Epoch40 Acc 0.9866 (552496/560000), AUC 0.9990162253379822
ep40_train_time 148.02023124694824
Test Epoch40 layer4 Acc 0.9786285714285714, AUC 0.9977545142173767, avg_entr 0.0032622634898871183
ep40_l4_test_time 3.1883745193481445
gc 0
Train Epoch41 Acc 0.9867196428571429 (552563/560000), AUC 0.9990221858024597
ep41_train_time 147.8188714981079
Test Epoch41 layer4 Acc 0.9786, AUC 0.9976698756217957, avg_entr 0.003104842733591795
ep41_l4_test_time 3.1040544509887695
gc 0
Train Epoch42 Acc 0.9867767857142857 (552595/560000), AUC 0.9990471005439758
ep42_train_time 132.84635639190674
Test Epoch42 layer4 Acc 0.9788857142857142, AUC 0.9977227449417114, avg_entr 0.0030152378603816032
ep42_l4_test_time 3.1941945552825928
gc 0
Train Epoch43 Acc 0.9867464285714286 (552578/560000), AUC 0.9990333914756775
ep43_train_time 148.01794004440308
Test Epoch43 layer4 Acc 0.9787714285714286, AUC 0.9978368878364563, avg_entr 0.003130116034299135
ep43_l4_test_time 3.2183451652526855
gc 0
Train Epoch44 Acc 0.9868464285714286 (552634/560000), AUC 0.9990553259849548
ep44_train_time 147.98303484916687
Test Epoch44 layer4 Acc 0.9789428571428571, AUC 0.9976440072059631, avg_entr 0.0030182062182575464
ep44_l4_test_time 3.2368767261505127
gc 0
Train Epoch45 Acc 0.9869839285714286 (552711/560000), AUC 0.9990257620811462
ep45_train_time 147.66637659072876
Test Epoch45 layer4 Acc 0.9789428571428571, AUC 0.9977569580078125, avg_entr 0.0031582394149154425
ep45_l4_test_time 3.198643684387207
gc 0
Train Epoch46 Acc 0.9870607142857143 (552754/560000), AUC 0.9990358352661133
ep46_train_time 147.93557214736938
Test Epoch46 layer4 Acc 0.9786857142857143, AUC 0.9975763559341431, avg_entr 0.0031328925397247076
ep46_l4_test_time 3.231719493865967
gc 0
Train Epoch47 Acc 0.9870678571428572 (552758/560000), AUC 0.9990254044532776
ep47_train_time 147.86031103134155
Test Epoch47 layer4 Acc 0.9791142857142857, AUC 0.9976624846458435, avg_entr 0.00326487491838634
ep47_l4_test_time 3.1661345958709717
gc 0
Train Epoch48 Acc 0.9871910714285714 (552827/560000), AUC 0.9990359544754028
ep48_train_time 147.24664115905762
Test Epoch48 layer4 Acc 0.9789714285714286, AUC 0.9977110028266907, avg_entr 0.0031515422742813826
ep48_l4_test_time 3.162947177886963
gc 0
Train Epoch49 Acc 0.9872267857142857 (552847/560000), AUC 0.9990496635437012
ep49_train_time 147.04493594169617
Test Epoch49 layer4 Acc 0.9790571428571428, AUC 0.9977669715881348, avg_entr 0.003105629701167345
ep49_l4_test_time 3.213005304336548
Best AUC 0.9985226392745972
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 7400.727493047714
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base_pad40//dbpedia_14_linearal_l5.pt
Test layer4 Acc 0.9752857142857143, AUC 0.9984384179115295, avg_entr 0.05989065393805504
l4_test_time 3.1859629154205322
