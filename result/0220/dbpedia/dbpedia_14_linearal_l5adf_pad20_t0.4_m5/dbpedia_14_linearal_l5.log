total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m4//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 58.068254470825195
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.9585803571428572 (536805/560000), AUC 0.9972690343856812
ep0_train_time 21.499969720840454
Test Epoch0 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep0_t0.4_test_time 0.41338324546813965
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m5//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9846232142857143 (551389/560000), AUC 0.9989365935325623
ep1_train_time 18.823896169662476
Test Epoch1 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep1_t0.4_test_time 0.4136505126953125
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m5//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9846339285714286 (551395/560000), AUC 0.9989227056503296
ep2_train_time 18.87733483314514
Test Epoch2 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep2_t0.4_test_time 0.41582369804382324
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m5//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9846964285714286 (551430/560000), AUC 0.9989256262779236
ep3_train_time 18.883302450180054
Test Epoch3 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep3_t0.4_test_time 0.4126598834991455
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m5//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9846964285714286 (551430/560000), AUC 0.9989437460899353
ep4_train_time 18.8970844745636
Test Epoch4 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep4_t0.4_test_time 0.41799187660217285
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m5//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9847517857142857 (551461/560000), AUC 0.9988723993301392
ep5_train_time 19.00258445739746
Test Epoch5 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep5_t0.4_test_time 0.41385602951049805
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m5//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9847285714285714 (551448/560000), AUC 0.9988808631896973
ep6_train_time 18.918246030807495
Test Epoch6 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep6_t0.4_test_time 0.414168119430542
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m5//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9847214285714285 (551444/560000), AUC 0.9988762736320496
ep7_train_time 18.89348602294922
Test Epoch7 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep7_t0.4_test_time 0.4166707992553711
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m5//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.98475 (551460/560000), AUC 0.9988812208175659
ep8_train_time 19.00399088859558
Test Epoch8 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep8_t0.4_test_time 0.41207098960876465
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m5//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.98475 (551460/560000), AUC 0.9988417029380798
ep9_train_time 18.99863576889038
Test Epoch9 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep9_t0.4_test_time 0.41382861137390137
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m5//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987098276615143
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 197.23191452026367
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m5//dbpedia_14_linearal_l5.pt
Test threshold 0.4 Acc 0.9842, AUC 0.499706894159317, avg_entr 0.005910081323236227
t0.4_test_time 0.4098184108734131
