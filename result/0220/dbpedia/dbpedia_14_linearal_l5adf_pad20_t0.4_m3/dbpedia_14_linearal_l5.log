total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m2//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 62.46642518043518
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.010333928571428572 (5787/560000), AUC 0.3238928020000458
ep0_train_time 22.099055528640747
Test Epoch0 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep0_t0.4_test_time 0.4170982837677002
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m3//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.0015785714285714285 (884/560000), AUC 0.33940476179122925
ep1_train_time 18.88862943649292
Test Epoch1 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep1_t0.4_test_time 0.4097473621368408
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m3//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.003030357142857143 (1697/560000), AUC 0.37475675344467163
ep2_train_time 19.158188581466675
Test Epoch2 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep2_t0.4_test_time 0.41051816940307617
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m3//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.004232142857142857 (2370/560000), AUC 0.39598730206489563
ep3_train_time 19.017656326293945
Test Epoch3 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep3_t0.4_test_time 0.41083693504333496
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m3//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.004460714285714286 (2498/560000), AUC 0.4072690010070801
ep4_train_time 18.910454511642456
Test Epoch4 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep4_t0.4_test_time 0.4092447757720947
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m3//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.004492857142857143 (2516/560000), AUC 0.41408947110176086
ep5_train_time 18.996599674224854
Test Epoch5 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep5_t0.4_test_time 0.40868115425109863
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m3//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.004446428571428572 (2490/560000), AUC 0.41872406005859375
ep6_train_time 19.03821301460266
Test Epoch6 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep6_t0.4_test_time 0.4095022678375244
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m3//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.004419642857142857 (2475/560000), AUC 0.42328140139579773
ep7_train_time 18.9767165184021
Test Epoch7 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep7_t0.4_test_time 0.40709495544433594
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m3//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.004357142857142857 (2440/560000), AUC 0.4277179539203644
ep8_train_time 19.119115352630615
Test Epoch8 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep8_t0.4_test_time 0.40721821784973145
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m3//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.004319642857142857 (2419/560000), AUC 0.43064528703689575
ep9_train_time 19.145856618881226
Test Epoch9 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep9_t0.4_test_time 0.4297201633453369
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m3//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987098276615143
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 198.77437496185303
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m3//dbpedia_14_linearal_l5.pt
Test threshold 0.4 Acc 0.9842, AUC 0.499706894159317, avg_entr 0.005910081323236227
t0.4_test_time 0.4047262668609619
