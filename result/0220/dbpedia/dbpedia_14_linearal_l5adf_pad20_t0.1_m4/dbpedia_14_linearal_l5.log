total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m3//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 58.12699294090271
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.07636071428571428 (42762/560000), AUC 0.49856120347976685
ep0_train_time 21.207775831222534
Test Epoch0 threshold 0.1 Acc 0.9665714285714285, AUC 0.4987332224845886, avg_entr 0.004769805818796158
ep0_t0.1_test_time 0.5145349502563477
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m4//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.07411785714285714 (41506/560000), AUC 0.5309346914291382
ep1_train_time 18.70081901550293
Test Epoch1 threshold 0.1 Acc 0.9666571428571429, AUC 0.4987345337867737, avg_entr 0.004754710476845503
ep1_t0.1_test_time 0.5112204551696777
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m4//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.07594464285714286 (42529/560000), AUC 0.5557249188423157
ep2_train_time 18.653630018234253
Test Epoch2 threshold 0.1 Acc 0.9666, AUC 0.49873584508895874, avg_entr 0.004720269702374935
ep2_t0.1_test_time 0.4981966018676758
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m4//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.07490357142857143 (41946/560000), AUC 0.5699806809425354
ep3_train_time 18.74029016494751
Test Epoch3 threshold 0.1 Acc 0.9666857142857143, AUC 0.4987342655658722, avg_entr 0.004699327051639557
ep3_t0.1_test_time 0.5032081604003906
gc 0
Train Epoch4 Acc 0.07396607142857142 (41421/560000), AUC 0.5791468620300293
ep4_train_time 18.678229570388794
Test Epoch4 threshold 0.1 Acc 0.9666285714285714, AUC 0.4987344741821289, avg_entr 0.0046890731900930405
ep4_t0.1_test_time 0.5122852325439453
gc 0
Train Epoch5 Acc 0.07386607142857143 (41365/560000), AUC 0.5844000577926636
ep5_train_time 18.716866731643677
Test Epoch5 threshold 0.1 Acc 0.9666, AUC 0.4987315237522125, avg_entr 0.004670680500566959
ep5_t0.1_test_time 0.5093097686767578
gc 0
Train Epoch6 Acc 0.07393035714285714 (41401/560000), AUC 0.5878553986549377
ep6_train_time 18.853821992874146
Test Epoch6 threshold 0.1 Acc 0.9665142857142857, AUC 0.49873313307762146, avg_entr 0.004637478850781918
ep6_t0.1_test_time 0.5039718151092529
gc 0
Train Epoch7 Acc 0.07391964285714285 (41395/560000), AUC 0.5917574167251587
ep7_train_time 18.87150263786316
Test Epoch7 threshold 0.1 Acc 0.9666285714285714, AUC 0.49873021245002747, avg_entr 0.004662585444748402
ep7_t0.1_test_time 0.5066425800323486
gc 0
Train Epoch8 Acc 0.07424464285714286 (41577/560000), AUC 0.5952809453010559
ep8_train_time 18.873218059539795
Test Epoch8 threshold 0.1 Acc 0.9666285714285714, AUC 0.49872979521751404, avg_entr 0.004662140738219023
ep8_t0.1_test_time 0.5072634220123291
gc 0
Train Epoch9 Acc 0.07459821428571428 (41775/560000), AUC 0.5978094339370728
ep9_train_time 18.79010558128357
Test Epoch9 threshold 0.1 Acc 0.9666285714285714, AUC 0.49873098731040955, avg_entr 0.004645498003810644
ep9_t0.1_test_time 0.502701997756958
Best AUC 0.49873584508895874
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 196.08720922470093
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m4//dbpedia_14_linearal_l5.pt
Test threshold 0.1 Acc 0.9854857142857143, AUC 0.4996802806854248, avg_entr 0.0032683664467185736
t0.1_test_time 0.4936556816101074
