total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m4//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.8490355014801
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.9634839285714286 (539551/560000), AUC 0.9978882074356079
ep0_train_time 21.63540244102478
Test Epoch0 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep0_t0.3_test_time 0.41547536849975586
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m5//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9842535714285714 (551182/560000), AUC 0.9990731477737427
ep1_train_time 18.937419652938843
Test Epoch1 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep1_t0.3_test_time 0.41799116134643555
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m5//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9842821428571429 (551198/560000), AUC 0.99908447265625
ep2_train_time 18.9375581741333
Test Epoch2 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep2_t0.3_test_time 0.4108753204345703
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m5//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9843517857142857 (551237/560000), AUC 0.9990838170051575
ep3_train_time 18.838316679000854
Test Epoch3 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep3_t0.3_test_time 0.411088228225708
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m5//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9843857142857143 (551256/560000), AUC 0.9990754723548889
ep4_train_time 19.14192771911621
Test Epoch4 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep4_t0.3_test_time 0.4098830223083496
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m5//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9843678571428571 (551246/560000), AUC 0.9990348219871521
ep5_train_time 18.99851942062378
Test Epoch5 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep5_t0.3_test_time 0.4118020534515381
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m5//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9843821428571429 (551254/560000), AUC 0.9990407824516296
ep6_train_time 18.95702862739563
Test Epoch6 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep6_t0.3_test_time 0.40974974632263184
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m5//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9844071428571428 (551268/560000), AUC 0.9990342259407043
ep7_train_time 18.936738967895508
Test Epoch7 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep7_t0.3_test_time 0.4099583625793457
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m5//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9843892857142857 (551258/560000), AUC 0.999036431312561
ep8_train_time 19.048707485198975
Test Epoch8 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep8_t0.3_test_time 0.4120368957519531
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m5//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9843928571428572 (551260/560000), AUC 0.99900883436203
ep9_train_time 19.074896812438965
Test Epoch9 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep9_t0.3_test_time 0.4208083152770996
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m5//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.49872636795043945
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 197.98354148864746
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m5//dbpedia_14_linearal_l5.pt
Test threshold 0.3 Acc 0.9848571428571429, AUC 0.4997192919254303, avg_entr 0.005990233737975359
t0.3_test_time 0.4141836166381836
