total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m1//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.31062912940979
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.08185357142857143 (45838/560000), AUC 0.43582120537757874
ep0_train_time 22.143924474716187
Test Epoch0 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep0_t0.3_test_time 0.4173581600189209
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m2//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.06964285714285715 (39000/560000), AUC 0.42554426193237305
ep1_train_time 19.513288974761963
Test Epoch1 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep1_t0.3_test_time 0.4098339080810547
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m2//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.06498392857142857 (36391/560000), AUC 0.41500478982925415
ep2_train_time 19.581615209579468
Test Epoch2 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep2_t0.3_test_time 0.41103219985961914
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m2//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.0456 (25536/560000), AUC 0.411825954914093
ep3_train_time 19.421104669570923
Test Epoch3 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep3_t0.3_test_time 0.4124174118041992
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m2//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.019539285714285714 (10942/560000), AUC 0.4172241985797882
ep4_train_time 19.35178303718567
Test Epoch4 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep4_t0.3_test_time 0.4091956615447998
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m2//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.00962142857142857 (5388/560000), AUC 0.4218154549598694
ep5_train_time 19.504980087280273
Test Epoch5 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep5_t0.3_test_time 0.41158485412597656
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m2//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.006317857142857143 (3538/560000), AUC 0.4232187271118164
ep6_train_time 19.37952756881714
Test Epoch6 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep6_t0.3_test_time 0.4085850715637207
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m2//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.004928571428571429 (2760/560000), AUC 0.423997700214386
ep7_train_time 19.270638942718506
Test Epoch7 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep7_t0.3_test_time 0.4103705883026123
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m2//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.004282142857142857 (2398/560000), AUC 0.42367199063301086
ep8_train_time 19.419463396072388
Test Epoch8 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep8_t0.3_test_time 0.41164326667785645
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m2//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.004039285714285714 (2262/560000), AUC 0.4231414794921875
ep9_train_time 19.408363580703735
Test Epoch9 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep9_t0.3_test_time 0.40999364852905273
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m2//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.49872636795043945
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 202.43290281295776
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m2//dbpedia_14_linearal_l5.pt
Test threshold 0.3 Acc 0.9848571428571429, AUC 0.4997192919254303, avg_entr 0.005990233737975359
t0.3_test_time 0.4125020503997803
