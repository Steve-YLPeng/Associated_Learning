total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.3_m1//dbpedia_14_lstmal_l5.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 59.50360345840454
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.06944464285714286 (38889/560000), AUC 0.4682764708995819
ep0_train_time 49.20369505882263
Test Epoch0 threshold 0.3 Acc 0.9652, AUC 0.49873191118240356, avg_entr 0.008167214691638947
ep0_t0.3_test_time 0.42818450927734375
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.3_m2//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.088325 (49462/560000), AUC 0.4647756516933441
ep1_train_time 46.81625461578369
Test Epoch1 threshold 0.3 Acc 0.9652, AUC 0.49873191118240356, avg_entr 0.008167214691638947
ep1_t0.3_test_time 0.41420531272888184
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.3_m2//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.09089107142857143 (50899/560000), AUC 0.4557516872882843
ep2_train_time 47.326026916503906
Test Epoch2 threshold 0.3 Acc 0.9652, AUC 0.49873191118240356, avg_entr 0.008167214691638947
ep2_t0.3_test_time 0.41749143600463867
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.3_m2//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.08991071428571429 (50350/560000), AUC 0.451223224401474
ep3_train_time 47.3919517993927
Test Epoch3 threshold 0.3 Acc 0.9652, AUC 0.49873191118240356, avg_entr 0.008167214691638947
ep3_t0.3_test_time 0.41582250595092773
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.3_m2//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.08931964285714286 (50019/560000), AUC 0.45375189185142517
ep4_train_time 47.47432613372803
Test Epoch4 threshold 0.3 Acc 0.9652, AUC 0.49873191118240356, avg_entr 0.008167214691638947
ep4_t0.3_test_time 0.41347289085388184
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.3_m2//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.08634285714285714 (48352/560000), AUC 0.4526972770690918
ep5_train_time 47.34289050102234
Test Epoch5 threshold 0.3 Acc 0.9652, AUC 0.49873191118240356, avg_entr 0.008167214691638947
ep5_t0.3_test_time 0.4144864082336426
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.3_m2//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.08621964285714286 (48283/560000), AUC 0.4545040726661682
ep6_train_time 47.21409225463867
Test Epoch6 threshold 0.3 Acc 0.9652, AUC 0.49873191118240356, avg_entr 0.008167214691638947
ep6_t0.3_test_time 0.4206535816192627
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.3_m2//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.08485357142857143 (47518/560000), AUC 0.4566214382648468
ep7_train_time 47.43345761299133
Test Epoch7 threshold 0.3 Acc 0.9652, AUC 0.49873191118240356, avg_entr 0.008167214691638947
ep7_t0.3_test_time 0.41851353645324707
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.3_m2//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.08315535714285714 (46567/560000), AUC 0.454438716173172
ep8_train_time 47.199729919433594
Test Epoch8 threshold 0.3 Acc 0.9652, AUC 0.49873191118240356, avg_entr 0.008167214691638947
ep8_t0.3_test_time 0.4116194248199463
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.3_m2//dbpedia_14_lstmal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.0829125 (46431/560000), AUC 0.45295748114585876
ep9_train_time 47.43028283119202
Test Epoch9 threshold 0.3 Acc 0.9652, AUC 0.49873191118240356, avg_entr 0.008167214691638947
ep9_t0.3_test_time 0.4184279441833496
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.3_m2//dbpedia_14_lstmal_l5.pt  ,ep 9
Best AUC 0.49873191118240356
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 480.649533033371
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.3_m2//dbpedia_14_lstmal_l5.pt
Test threshold 0.3 Acc 0.9848857142857143, AUC 0.49970921874046326, avg_entr 0.005748467519879341
t0.3_test_time 0.41108250617980957
