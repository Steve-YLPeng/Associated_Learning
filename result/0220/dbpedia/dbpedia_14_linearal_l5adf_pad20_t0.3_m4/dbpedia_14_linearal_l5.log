total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m3//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 58.672749519348145
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.04685 (26236/560000), AUC 0.5036922097206116
ep0_train_time 20.996826648712158
Test Epoch0 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep0_t0.3_test_time 0.41124820709228516
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m4//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.009994642857142856 (5597/560000), AUC 0.4988420605659485
ep1_train_time 18.775769472122192
Test Epoch1 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep1_t0.3_test_time 0.41436767578125
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m4//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.0048821428571428575 (2734/560000), AUC 0.49303141236305237
ep2_train_time 18.8723783493042
Test Epoch2 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep2_t0.3_test_time 0.413510799407959
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m4//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.005180357142857143 (2901/560000), AUC 0.49141693115234375
ep3_train_time 18.866525173187256
Test Epoch3 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep3_t0.3_test_time 0.4121670722961426
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m4//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.006382142857142857 (3574/560000), AUC 0.4883185923099518
ep4_train_time 18.89445686340332
Test Epoch4 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep4_t0.3_test_time 0.4214439392089844
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m4//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.006930357142857143 (3881/560000), AUC 0.48465362191200256
ep5_train_time 18.726130962371826
Test Epoch5 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep5_t0.3_test_time 0.4129350185394287
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m4//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.007285714285714286 (4080/560000), AUC 0.4829963147640228
ep6_train_time 18.83502197265625
Test Epoch6 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep6_t0.3_test_time 0.41319775581359863
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m4//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.007716071428571429 (4321/560000), AUC 0.4808214008808136
ep7_train_time 18.956275701522827
Test Epoch7 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep7_t0.3_test_time 0.41276025772094727
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m4//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.008371428571428571 (4688/560000), AUC 0.4781225025653839
ep8_train_time 18.757681846618652
Test Epoch8 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep8_t0.3_test_time 0.41120386123657227
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m4//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.009048214285714286 (5067/560000), AUC 0.47684594988822937
ep9_train_time 18.889267206192017
Test Epoch9 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep9_t0.3_test_time 0.40589022636413574
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m4//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.49872636795043945
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 196.01272583007812
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m4//dbpedia_14_linearal_l5.pt
Test threshold 0.3 Acc 0.9848571428571429, AUC 0.4997192919254303, avg_entr 0.005990233737975359
t0.3_test_time 0.4053843021392822
