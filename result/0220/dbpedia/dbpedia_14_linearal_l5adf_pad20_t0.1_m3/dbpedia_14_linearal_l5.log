total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m2//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.444167137145996
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.11350357142857143 (63562/560000), AUC 0.4643183648586273
ep0_train_time 21.629215717315674
Test Epoch0 threshold 0.1 Acc 0.9662, AUC 0.4987344741821289, avg_entr 0.005011811386793852
ep0_t0.1_test_time 0.5088043212890625
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m3//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.1318767857142857 (73851/560000), AUC 0.4727318584918976
ep1_train_time 19.139147996902466
Test Epoch1 threshold 0.1 Acc 0.9665714285714285, AUC 0.49873608350753784, avg_entr 0.004915766883641481
ep1_t0.1_test_time 0.512932300567627
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m3//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.13462321428571428 (75389/560000), AUC 0.4746135175228119
ep2_train_time 19.150205850601196
Test Epoch2 threshold 0.1 Acc 0.9667428571428571, AUC 0.49873921275138855, avg_entr 0.004808690398931503
ep2_t0.1_test_time 0.5138530731201172
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m3//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.1372232142857143 (76845/560000), AUC 0.4778699278831482
ep3_train_time 19.252906799316406
Test Epoch3 threshold 0.1 Acc 0.9665714285714285, AUC 0.49873462319374084, avg_entr 0.004792006686329842
ep3_t0.1_test_time 0.5074334144592285
gc 0
Train Epoch4 Acc 0.1365357142857143 (76460/560000), AUC 0.48492056131362915
ep4_train_time 19.093956470489502
Test Epoch4 threshold 0.1 Acc 0.9666, AUC 0.4987376630306244, avg_entr 0.004763567354530096
ep4_t0.1_test_time 0.5071253776550293
gc 0
Train Epoch5 Acc 0.13398214285714286 (75030/560000), AUC 0.4913913309574127
ep5_train_time 19.192489624023438
Test Epoch5 threshold 0.1 Acc 0.9666285714285714, AUC 0.49873852729797363, avg_entr 0.0047320532612502575
ep5_t0.1_test_time 0.508108377456665
gc 0
Train Epoch6 Acc 0.13144285714285714 (73608/560000), AUC 0.4942037761211395
ep6_train_time 19.286721229553223
Test Epoch6 threshold 0.1 Acc 0.9667142857142857, AUC 0.49873629212379456, avg_entr 0.0046994443982839584
ep6_t0.1_test_time 0.5086832046508789
gc 0
Train Epoch7 Acc 0.12710714285714286 (71180/560000), AUC 0.49658122658729553
ep7_train_time 19.333226203918457
Test Epoch7 threshold 0.1 Acc 0.9667428571428571, AUC 0.4987385869026184, avg_entr 0.004700849298387766
ep7_t0.1_test_time 0.5150971412658691
gc 0
Train Epoch8 Acc 0.121725 (68166/560000), AUC 0.49804630875587463
ep8_train_time 19.07282257080078
Test Epoch8 threshold 0.1 Acc 0.9666, AUC 0.4987356662750244, avg_entr 0.0046935961581766605
ep8_t0.1_test_time 0.5105154514312744
gc 0
Train Epoch9 Acc 0.11772142857142857 (65924/560000), AUC 0.49912434816360474
ep9_train_time 19.22939395904541
Test Epoch9 threshold 0.1 Acc 0.9665714285714285, AUC 0.4987344741821289, avg_entr 0.004680836107581854
ep9_t0.1_test_time 0.5087156295776367
Best AUC 0.49873921275138855
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 200.3868567943573
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m3//dbpedia_14_linearal_l5.pt
Test threshold 0.1 Acc 0.9853714285714286, AUC 0.4996805191040039, avg_entr 0.003373769810423255
t0.1_test_time 0.49817895889282227
