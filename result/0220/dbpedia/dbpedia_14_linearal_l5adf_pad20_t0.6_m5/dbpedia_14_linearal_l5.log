total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m4//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.417770862579346
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.9611785714285714 (538260/560000), AUC 0.9979199171066284
ep0_train_time 22.196454763412476
Test Epoch0 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep0_t0.6_test_time 0.41673731803894043
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m5//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9842732142857142 (551193/560000), AUC 0.9991244077682495
ep1_train_time 19.126055240631104
Test Epoch1 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep1_t0.6_test_time 0.4123399257659912
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m5//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9843767857142857 (551251/560000), AUC 0.999130129814148
ep2_train_time 19.300536632537842
Test Epoch2 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep2_t0.6_test_time 0.4177525043487549
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m5//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9843785714285714 (551252/560000), AUC 0.9991269707679749
ep3_train_time 19.002567291259766
Test Epoch3 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep3_t0.6_test_time 0.41831183433532715
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m5//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9844053571428572 (551267/560000), AUC 0.9991512298583984
ep4_train_time 19.12815284729004
Test Epoch4 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep4_t0.6_test_time 0.4126460552215576
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m5//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9844553571428571 (551295/560000), AUC 0.99910968542099
ep5_train_time 19.174039602279663
Test Epoch5 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep5_t0.6_test_time 0.41780734062194824
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m5//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9844375 (551285/560000), AUC 0.9990983009338379
ep6_train_time 19.12140655517578
Test Epoch6 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep6_t0.6_test_time 0.41573596000671387
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m5//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9844142857142857 (551272/560000), AUC 0.9991021156311035
ep7_train_time 19.09068489074707
Test Epoch7 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep7_t0.6_test_time 0.42033839225769043
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m5//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9844232142857143 (551277/560000), AUC 0.9991151690483093
ep8_train_time 19.167217254638672
Test Epoch8 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep8_t0.6_test_time 0.41303038597106934
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m5//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9843857142857143 (551256/560000), AUC 0.9990836977958679
ep9_train_time 19.135085582733154
Test Epoch9 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep9_t0.6_test_time 0.4180119037628174
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m5//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987121522426605
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 199.98060274124146
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m5//dbpedia_14_linearal_l5.pt
Test threshold 0.6 Acc 0.9849428571428571, AUC 0.4997170567512512, avg_entr 0.0057458127848804
t0.6_test_time 0.41500020027160645
