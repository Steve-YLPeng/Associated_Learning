total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m3//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 58.06902766227722
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.05266607142857143 (29493/560000), AUC 0.45348963141441345
ep0_train_time 21.919338703155518
Test Epoch0 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep0_t0.5_test_time 0.41271495819091797
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m4//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.0417625 (23387/560000), AUC 0.4452376961708069
ep1_train_time 18.834364891052246
Test Epoch1 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep1_t0.5_test_time 0.4094831943511963
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m4//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.04537857142857143 (25412/560000), AUC 0.43293237686157227
ep2_train_time 18.914308786392212
Test Epoch2 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep2_t0.5_test_time 0.41429567337036133
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m4//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.03843214285714286 (21522/560000), AUC 0.4268030822277069
ep3_train_time 18.8531973361969
Test Epoch3 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep3_t0.5_test_time 0.40848374366760254
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m4//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.013821428571428571 (7740/560000), AUC 0.4151310622692108
ep4_train_time 18.694437980651855
Test Epoch4 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep4_t0.5_test_time 0.4105210304260254
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m4//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.005367857142857143 (3006/560000), AUC 0.4099583625793457
ep5_train_time 18.84350275993347
Test Epoch5 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep5_t0.5_test_time 0.40953803062438965
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m4//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.0031964285714285714 (1790/560000), AUC 0.4083258807659149
ep6_train_time 18.95406675338745
Test Epoch6 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep6_t0.5_test_time 0.4118027687072754
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m4//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.002067857142857143 (1158/560000), AUC 0.40776586532592773
ep7_train_time 18.973151206970215
Test Epoch7 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep7_t0.5_test_time 0.41867709159851074
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m4//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.0016107142857142856 (902/560000), AUC 0.4086053669452667
ep8_train_time 19.02972960472107
Test Epoch8 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep8_t0.5_test_time 0.40990662574768066
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m4//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.0014178571428571428 (794/560000), AUC 0.4093450605869293
ep9_train_time 18.745213508605957
Test Epoch9 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep9_t0.5_test_time 0.41098666191101074
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m4//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.498745858669281
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 197.19425058364868
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m4//dbpedia_14_linearal_l5.pt
Test threshold 0.5 Acc 0.9845142857142857, AUC 0.49971795082092285, avg_entr 0.005792997311800718
t0.5_test_time 0.4108238220214844
