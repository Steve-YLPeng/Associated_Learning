total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m4//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 56.49953842163086
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.9574267857142857 (536159/560000), AUC 0.9976949095726013
ep0_train_time 22.118834018707275
Test Epoch0 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep0_t0.5_test_time 0.41901397705078125
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m5//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9845803571428572 (551365/560000), AUC 0.9991183280944824
ep1_train_time 19.10029172897339
Test Epoch1 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep1_t0.5_test_time 0.41745781898498535
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m5//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.984675 (551418/560000), AUC 0.999117910861969
ep2_train_time 19.03165316581726
Test Epoch2 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep2_t0.5_test_time 0.42481470108032227
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m5//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9846928571428571 (551428/560000), AUC 0.9991232752799988
ep3_train_time 19.005383253097534
Test Epoch3 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep3_t0.5_test_time 0.4196929931640625
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m5//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9847660714285714 (551469/560000), AUC 0.9991281628608704
ep4_train_time 19.055447101593018
Test Epoch4 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep4_t0.5_test_time 0.4177701473236084
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m5//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9847392857142857 (551454/560000), AUC 0.9990779161453247
ep5_train_time 19.0297634601593
Test Epoch5 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep5_t0.5_test_time 0.42601466178894043
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m5//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9847196428571429 (551443/560000), AUC 0.9990680813789368
ep6_train_time 19.11832094192505
Test Epoch6 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep6_t0.5_test_time 0.4172499179840088
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m5//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9847410714285715 (551455/560000), AUC 0.9990853071212769
ep7_train_time 19.197768449783325
Test Epoch7 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep7_t0.5_test_time 0.4130825996398926
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m5//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9847839285714286 (551479/560000), AUC 0.9990853667259216
ep8_train_time 19.171809911727905
Test Epoch8 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep8_t0.5_test_time 0.41694021224975586
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m5//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9847946428571429 (551485/560000), AUC 0.9990514516830444
ep9_train_time 19.123493432998657
Test Epoch9 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep9_t0.5_test_time 0.4143061637878418
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m5//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.498745858669281
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 199.52170705795288
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m5//dbpedia_14_linearal_l5.pt
Test threshold 0.5 Acc 0.9845142857142857, AUC 0.49971795082092285, avg_entr 0.005792997311800718
t0.5_test_time 0.4174354076385498
