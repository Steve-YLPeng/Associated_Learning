total count words 887881
vocab size 30000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.934765100479126
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.08169642857142857 (45750/560000), AUC 0.5091643929481506
ep0_train_time 26.229027271270752
Test Epoch0 threshold 0.4 Acc 0.9641714285714286, AUC 0.49858665466308594, avg_entr 0.03002813272178173
ep0_t0.4_test_time 0.4091451168060303
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m1//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.08664107142857143 (48519/560000), AUC 0.5074555277824402
ep1_train_time 23.46131944656372
Test Epoch1 threshold 0.4 Acc 0.9645428571428571, AUC 0.49864715337753296, avg_entr 0.016765307635068893
ep1_t0.4_test_time 0.410114049911499
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m1//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.08730357142857142 (48890/560000), AUC 0.5050017237663269
ep2_train_time 23.230812072753906
Test Epoch2 threshold 0.4 Acc 0.9648857142857142, AUC 0.4986536204814911, avg_entr 0.01214831043034792
ep2_t0.4_test_time 0.41266632080078125
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m1//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.08698571428571429 (48712/560000), AUC 0.5025965571403503
ep3_train_time 23.338833570480347
Test Epoch3 threshold 0.4 Acc 0.9646285714285714, AUC 0.49866554141044617, avg_entr 0.00974415335804224
ep3_t0.4_test_time 0.41381382942199707
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m1//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.08511428571428571 (47664/560000), AUC 0.5003198385238647
ep4_train_time 23.229690074920654
Test Epoch4 threshold 0.4 Acc 0.965, AUC 0.49870628118515015, avg_entr 0.008846084587275982
ep4_t0.4_test_time 0.4090449810028076
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m1//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.08223392857142857 (46051/560000), AUC 0.4989341199398041
ep5_train_time 23.459411144256592
Test Epoch5 threshold 0.4 Acc 0.9645428571428571, AUC 0.4987010955810547, avg_entr 0.00863901898264885
ep5_t0.4_test_time 0.4099094867706299
gc 0
Train Epoch6 Acc 0.07911607142857142 (44305/560000), AUC 0.49844542145729065
ep6_train_time 23.39366602897644
Test Epoch6 threshold 0.4 Acc 0.9639714285714286, AUC 0.49869662523269653, avg_entr 0.008600003086030483
ep6_t0.4_test_time 0.41164731979370117
gc 0
Train Epoch7 Acc 0.07603035714285715 (42577/560000), AUC 0.4974203109741211
ep7_train_time 23.39725637435913
Test Epoch7 threshold 0.4 Acc 0.9645714285714285, AUC 0.49870017170906067, avg_entr 0.00845400057733059
ep7_t0.4_test_time 0.4145190715789795
gc 0
Train Epoch8 Acc 0.07315535714285715 (40967/560000), AUC 0.49717065691947937
ep8_train_time 23.33174777030945
Test Epoch8 threshold 0.4 Acc 0.9644, AUC 0.4986957907676697, avg_entr 0.008642850443720818
ep8_t0.4_test_time 0.4086165428161621
gc 0
Train Epoch9 Acc 0.0730375 (40901/560000), AUC 0.4968315064907074
ep9_train_time 23.228905200958252
Test Epoch9 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep9_t0.4_test_time 0.41219425201416016
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m1//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987098276615143
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 241.50531649589539
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m1//dbpedia_14_linearal_l5.pt
Test threshold 0.4 Acc 0.9842, AUC 0.499706894159317, avg_entr 0.005910081323236227
t0.4_test_time 0.4083573818206787
