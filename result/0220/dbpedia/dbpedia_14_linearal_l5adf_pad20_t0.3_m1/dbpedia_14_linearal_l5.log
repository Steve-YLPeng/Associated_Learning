total count words 887881
vocab size 30000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 58.02313470840454
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.057360714285714286 (32122/560000), AUC 0.46018680930137634
ep0_train_time 26.205082893371582
Test Epoch0 threshold 0.3 Acc 0.9642571428571428, AUC 0.49855878949165344, avg_entr 0.029870688915252686
ep0_t0.3_test_time 0.41227221488952637
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m1//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.061594642857142855 (34493/560000), AUC 0.4564191997051239
ep1_train_time 23.387242317199707
Test Epoch1 threshold 0.3 Acc 0.9638, AUC 0.4985814094543457, avg_entr 0.01698344387114048
ep1_t0.3_test_time 0.41849303245544434
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m1//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.06130535714285714 (34331/560000), AUC 0.4552134871482849
ep2_train_time 23.43246817588806
Test Epoch2 threshold 0.3 Acc 0.9657428571428571, AUC 0.49869441986083984, avg_entr 0.012061729095876217
ep2_t0.3_test_time 0.42053794860839844
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m1//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.060189285714285716 (33706/560000), AUC 0.4544549286365509
ep3_train_time 23.43741488456726
Test Epoch3 threshold 0.3 Acc 0.9654, AUC 0.4986504912376404, avg_entr 0.009809378534555435
ep3_t0.3_test_time 0.4137077331542969
gc 0
Train Epoch4 Acc 0.05775535714285714 (32343/560000), AUC 0.4543168842792511
ep4_train_time 23.357908248901367
Test Epoch4 threshold 0.3 Acc 0.9652571428571428, AUC 0.4986858069896698, avg_entr 0.009064496494829655
ep4_t0.3_test_time 0.4129927158355713
gc 0
Train Epoch5 Acc 0.054789285714285714 (30682/560000), AUC 0.4542931914329529
ep5_train_time 23.418396472930908
Test Epoch5 threshold 0.3 Acc 0.965, AUC 0.49868467450141907, avg_entr 0.00856349803507328
ep5_t0.3_test_time 0.41271042823791504
gc 0
Train Epoch6 Acc 0.05095892857142857 (28537/560000), AUC 0.45445725321769714
ep6_train_time 23.294195413589478
Test Epoch6 threshold 0.3 Acc 0.9651714285714286, AUC 0.4986833930015564, avg_entr 0.008383474312722683
ep6_t0.3_test_time 0.4127676486968994
gc 0
Train Epoch7 Acc 0.04853214285714286 (27178/560000), AUC 0.45463234186172485
ep7_train_time 23.352904081344604
Test Epoch7 threshold 0.3 Acc 0.9650285714285715, AUC 0.4986971914768219, avg_entr 0.008418843150138855
ep7_t0.3_test_time 0.41567039489746094
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m1//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.047476785714285714 (26587/560000), AUC 0.4551422894001007
ep8_train_time 23.466235399246216
Test Epoch8 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep8_t0.3_test_time 0.4165477752685547
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m1//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.04656964285714286 (26079/560000), AUC 0.45543691515922546
ep9_train_time 23.273389101028442
Test Epoch9 threshold 0.3 Acc 0.9648285714285715, AUC 0.4987063705921173, avg_entr 0.00834717508405447
ep9_t0.3_test_time 0.4131805896759033
Best AUC 0.49872636795043945
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 241.80178928375244
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m1//dbpedia_14_linearal_l5.pt
Test threshold 0.3 Acc 0.9848571428571429, AUC 0.4997192919254303, avg_entr 0.005990233737975359
t0.3_test_time 0.4118504524230957
