total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m2//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 56.887917041778564
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.0018660714285714285 (1045/560000), AUC 0.4429378807544708
ep0_train_time 21.202311992645264
Test Epoch0 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep0_t0.3_test_time 0.411898136138916
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m3//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.0022125 (1239/560000), AUC 0.4535692036151886
ep1_train_time 19.258167266845703
Test Epoch1 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep1_t0.3_test_time 0.41113758087158203
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m3//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.002625 (1470/560000), AUC 0.4574539065361023
ep2_train_time 19.071338891983032
Test Epoch2 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep2_t0.3_test_time 0.4114241600036621
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m3//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.0025910714285714287 (1451/560000), AUC 0.45775213837623596
ep3_train_time 19.258927822113037
Test Epoch3 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep3_t0.3_test_time 0.4153432846069336
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m3//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.002498214285714286 (1399/560000), AUC 0.465198814868927
ep4_train_time 19.216828107833862
Test Epoch4 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep4_t0.3_test_time 0.4103274345397949
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m3//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.002801785714285714 (1569/560000), AUC 0.47171837091445923
ep5_train_time 19.34607982635498
Test Epoch5 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep5_t0.3_test_time 0.41293907165527344
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m3//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.0031714285714285716 (1776/560000), AUC 0.47678107023239136
ep6_train_time 19.252811431884766
Test Epoch6 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep6_t0.3_test_time 0.41469573974609375
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m3//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.0034660714285714286 (1941/560000), AUC 0.48074617981910706
ep7_train_time 19.235774040222168
Test Epoch7 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep7_t0.3_test_time 0.41165733337402344
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m3//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.0038089285714285716 (2133/560000), AUC 0.4844834506511688
ep8_train_time 19.20872712135315
Test Epoch8 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep8_t0.3_test_time 0.41182947158813477
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m3//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.004042857142857143 (2264/560000), AUC 0.4869285225868225
ep9_train_time 19.464637279510498
Test Epoch9 threshold 0.3 Acc 0.9656, AUC 0.49872636795043945, avg_entr 0.008326206356287003
ep9_t0.3_test_time 0.4128885269165039
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m3//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.49872636795043945
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 200.02720713615417
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.3_m3//dbpedia_14_linearal_l5.pt
Test threshold 0.3 Acc 0.9848571428571429, AUC 0.4997192919254303, avg_entr 0.005990233737975359
t0.3_test_time 0.4032571315765381
