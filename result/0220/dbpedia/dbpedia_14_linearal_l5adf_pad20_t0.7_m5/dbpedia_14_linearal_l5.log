total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m4//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.064913749694824
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.9632196428571429 (539403/560000), AUC 0.9978827238082886
ep0_train_time 21.94035029411316
Test Epoch0 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep0_t0.7_test_time 0.4086475372314453
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m5//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9834892857142857 (550754/560000), AUC 0.9990463256835938
ep1_train_time 18.981518507003784
Test Epoch1 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep1_t0.7_test_time 0.4067680835723877
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m5//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9835053571428571 (550763/560000), AUC 0.9990490674972534
ep2_train_time 19.15305519104004
Test Epoch2 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep2_t0.7_test_time 0.4103515148162842
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m5//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9836 (550816/560000), AUC 0.9990680813789368
ep3_train_time 19.068861961364746
Test Epoch3 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep3_t0.7_test_time 0.4141068458557129
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m5//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9835767857142858 (550803/560000), AUC 0.9990624189376831
ep4_train_time 19.00098943710327
Test Epoch4 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep4_t0.7_test_time 0.4180922508239746
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m5//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9835910714285714 (550811/560000), AUC 0.9990096092224121
ep5_train_time 19.159642219543457
Test Epoch5 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep5_t0.7_test_time 0.41103219985961914
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m5//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9836464285714286 (550842/560000), AUC 0.9990191459655762
ep6_train_time 19.16419243812561
Test Epoch6 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep6_t0.7_test_time 0.40976762771606445
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m5//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9836232142857143 (550829/560000), AUC 0.9990016222000122
ep7_train_time 19.160210132598877
Test Epoch7 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep7_t0.7_test_time 0.4126453399658203
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m5//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9836285714285714 (550832/560000), AUC 0.9990199208259583
ep8_train_time 19.118880033493042
Test Epoch8 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep8_t0.7_test_time 0.41942644119262695
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m5//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9836017857142857 (550817/560000), AUC 0.9989945292472839
ep9_train_time 19.27644419670105
Test Epoch9 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep9_t0.7_test_time 0.41408872604370117
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m5//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987258315086365
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 199.38100862503052
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m5//dbpedia_14_linearal_l5.pt
Test threshold 0.7 Acc 0.9852, AUC 0.49968987703323364, avg_entr 0.006038835272192955
t0.7_test_time 0.41032910346984863
