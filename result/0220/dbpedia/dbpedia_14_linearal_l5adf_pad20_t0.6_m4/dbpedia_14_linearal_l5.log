total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m3//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 62.48076915740967
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.0306375 (17157/560000), AUC 0.5038526058197021
ep0_train_time 22.358155727386475
Test Epoch0 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep0_t0.6_test_time 0.40853381156921387
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m4//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.04313392857142857 (24155/560000), AUC 0.5309832096099854
ep1_train_time 19.40449070930481
Test Epoch1 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep1_t0.6_test_time 0.41181087493896484
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m4//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.02497142857142857 (13984/560000), AUC 0.5241938233375549
ep2_train_time 19.328295469284058
Test Epoch2 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep2_t0.6_test_time 0.4149298667907715
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m4//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.02552142857142857 (14292/560000), AUC 0.5170336365699768
ep3_train_time 19.239425659179688
Test Epoch3 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep3_t0.6_test_time 0.41365694999694824
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m4//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.03681607142857143 (20617/560000), AUC 0.509653627872467
ep4_train_time 19.41603946685791
Test Epoch4 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep4_t0.6_test_time 0.41946887969970703
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m4//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.043507142857142855 (24364/560000), AUC 0.5080021619796753
ep5_train_time 19.321579933166504
Test Epoch5 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep5_t0.6_test_time 0.41170382499694824
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m4//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.04626071428571429 (25906/560000), AUC 0.5082505345344543
ep6_train_time 19.443410873413086
Test Epoch6 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep6_t0.6_test_time 0.41465306282043457
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m4//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.049419642857142856 (27675/560000), AUC 0.5086425542831421
ep7_train_time 19.45933198928833
Test Epoch7 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep7_t0.6_test_time 0.410858154296875
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m4//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.0517125 (28959/560000), AUC 0.5082842707633972
ep8_train_time 19.385688066482544
Test Epoch8 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep8_t0.6_test_time 0.4156515598297119
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m4//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.05328928571428571 (29842/560000), AUC 0.5080031156539917
ep9_train_time 19.37930941581726
Test Epoch9 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep9_t0.6_test_time 0.4160628318786621
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m4//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987121522426605
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 202.26296019554138
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m4//dbpedia_14_linearal_l5.pt
Test threshold 0.6 Acc 0.9849428571428571, AUC 0.4997170567512512, avg_entr 0.0057458127848804
t0.6_test_time 0.4071352481842041
