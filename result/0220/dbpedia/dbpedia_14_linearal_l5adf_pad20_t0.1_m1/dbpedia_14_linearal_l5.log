total count words 887881
vocab size 30000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.47576928138733
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.10326428571428571 (57828/560000), AUC 0.4794444143772125
ep0_train_time 25.14459800720215
Test Epoch0 threshold 0.1 Acc 0.9642571428571428, AUC 0.4985203742980957, avg_entr 0.030234022065997124
ep0_t0.1_test_time 0.43054628372192383
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m1//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.11740178571428571 (65745/560000), AUC 0.4852345287799835
ep1_train_time 23.013777017593384
Test Epoch1 threshold 0.1 Acc 0.9648285714285715, AUC 0.4985904097557068, avg_entr 0.016619957983493805
ep1_t0.1_test_time 0.4198648929595947
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m1//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.12024642857142857 (67338/560000), AUC 0.4883764684200287
ep2_train_time 23.041577577590942
Test Epoch2 threshold 0.1 Acc 0.9652857142857143, AUC 0.49862465262413025, avg_entr 0.012237127870321274
ep2_t0.1_test_time 0.42223501205444336
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m1//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.12054285714285715 (67504/560000), AUC 0.49104878306388855
ep3_train_time 23.06503200531006
Test Epoch3 threshold 0.1 Acc 0.9647428571428571, AUC 0.4986601769924164, avg_entr 0.009938934817910194
ep3_t0.1_test_time 0.4173760414123535
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m1//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.11909821428571428 (66695/560000), AUC 0.4929213523864746
ep4_train_time 22.978596925735474
Test Epoch4 threshold 0.1 Acc 0.9647714285714286, AUC 0.4986655116081238, avg_entr 0.009038623422384262
ep4_t0.1_test_time 0.4188859462738037
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m1//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.116475 (65226/560000), AUC 0.49329233169555664
ep5_train_time 23.108365535736084
Test Epoch5 threshold 0.1 Acc 0.9653142857142857, AUC 0.49867114424705505, avg_entr 0.008717859163880348
ep5_t0.1_test_time 0.4181694984436035
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m1//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.11402321428571428 (63853/560000), AUC 0.4925782382488251
ep6_train_time 23.097909450531006
Test Epoch6 threshold 0.1 Acc 0.9649714285714286, AUC 0.4986942708492279, avg_entr 0.008419527672231197
ep6_t0.1_test_time 0.415508508682251
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m1//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.11208214285714285 (62766/560000), AUC 0.4916132986545563
ep7_train_time 23.164655923843384
Test Epoch7 threshold 0.1 Acc 0.9652857142857143, AUC 0.49872756004333496, avg_entr 0.008341334760189056
ep7_t0.1_test_time 0.41668701171875
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m1//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.10991428571428571 (61552/560000), AUC 0.49020418524742126
ep8_train_time 23.013547658920288
Test Epoch8 threshold 0.1 Acc 0.9644, AUC 0.4986940026283264, avg_entr 0.008507980965077877
ep8_t0.1_test_time 0.4148859977722168
gc 0
Train Epoch9 Acc 0.10792142857142857 (60436/560000), AUC 0.48876136541366577
ep9_train_time 23.050291776657104
Test Epoch9 threshold 0.1 Acc 0.9652571428571428, AUC 0.4986855089664459, avg_entr 0.008403031155467033
ep9_t0.1_test_time 0.42343735694885254
Best AUC 0.49872756004333496
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 238.10170340538025
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m1//dbpedia_14_linearal_l5.pt
Test threshold 0.1 Acc 0.9850857142857142, AUC 0.4996786415576935, avg_entr 0.005869035143405199
t0.1_test_time 0.4172990322113037
