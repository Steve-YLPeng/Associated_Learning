total count words 887881
vocab size 30000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 58.208614110946655
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.042178571428571426 (23620/560000), AUC 0.4969145357608795
ep0_train_time 26.55838441848755
Test Epoch0 threshold 0.7 Acc 0.9628571428571429, AUC 0.49852338433265686, avg_entr 0.030805183574557304
ep0_t0.7_test_time 0.41349339485168457
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m1//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.042621428571428574 (23868/560000), AUC 0.5017275810241699
ep1_train_time 23.628503561019897
Test Epoch1 threshold 0.7 Acc 0.9646857142857143, AUC 0.49860426783561707, avg_entr 0.016906095668673515
ep1_t0.7_test_time 0.4149792194366455
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m1//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.04466785714285714 (25014/560000), AUC 0.5035703182220459
ep2_train_time 23.686901092529297
Test Epoch2 threshold 0.7 Acc 0.9645714285714285, AUC 0.4986605942249298, avg_entr 0.012347465381026268
ep2_t0.7_test_time 0.4201359748840332
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m1//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.047232142857142854 (26450/560000), AUC 0.5041831135749817
ep3_train_time 23.615997314453125
Test Epoch3 threshold 0.7 Acc 0.9656571428571429, AUC 0.4986990988254547, avg_entr 0.009736837819218636
ep3_t0.7_test_time 0.41710829734802246
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m1//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.050385714285714284 (28216/560000), AUC 0.5057886242866516
ep4_train_time 23.633986473083496
Test Epoch4 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep4_t0.7_test_time 0.42039942741394043
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m1//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.054580357142857146 (30565/560000), AUC 0.5077788233757019
ep5_train_time 23.59300398826599
Test Epoch5 threshold 0.7 Acc 0.9648571428571429, AUC 0.4987034797668457, avg_entr 0.008569106459617615
ep5_t0.7_test_time 0.42491912841796875
gc 0
Train Epoch6 Acc 0.058805357142857145 (32931/560000), AUC 0.5101141333580017
ep6_train_time 23.653446197509766
Test Epoch6 threshold 0.7 Acc 0.9644285714285714, AUC 0.49871301651000977, avg_entr 0.008387180976569653
ep6_t0.7_test_time 0.41288137435913086
gc 0
Train Epoch7 Acc 0.063175 (35378/560000), AUC 0.5124377012252808
ep7_train_time 23.70628833770752
Test Epoch7 threshold 0.7 Acc 0.9645428571428571, AUC 0.4987246096134186, avg_entr 0.008270376361906528
ep7_t0.7_test_time 0.42262768745422363
gc 0
Train Epoch8 Acc 0.0682125 (38199/560000), AUC 0.5146682858467102
ep8_train_time 23.564180850982666
Test Epoch8 threshold 0.7 Acc 0.9645714285714285, AUC 0.4987160265445709, avg_entr 0.008343074470758438
ep8_t0.7_test_time 0.41627025604248047
gc 0
Train Epoch9 Acc 0.07057321428571428 (39521/560000), AUC 0.5157650113105774
ep9_train_time 23.827295780181885
Test Epoch9 threshold 0.7 Acc 0.9648285714285715, AUC 0.4987230598926544, avg_entr 0.008309737779200077
ep9_t0.7_test_time 0.41956496238708496
Best AUC 0.4987258315086365
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 244.68636012077332
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m1//dbpedia_14_linearal_l5.pt
Test threshold 0.7 Acc 0.9852, AUC 0.49968987703323364, avg_entr 0.006038835272192955
t0.7_test_time 0.41455721855163574
