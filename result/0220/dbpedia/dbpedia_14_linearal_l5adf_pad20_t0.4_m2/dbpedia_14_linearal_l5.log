total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m1//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 58.42569661140442
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.040119642857142854 (22467/560000), AUC 0.47206005454063416
ep0_train_time 22.207165956497192
Test Epoch0 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep0_t0.4_test_time 0.4105350971221924
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m2//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.017219642857142857 (9643/560000), AUC 0.4205312132835388
ep1_train_time 19.162583827972412
Test Epoch1 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep1_t0.4_test_time 0.4153401851654053
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m2//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.011198214285714285 (6271/560000), AUC 0.3826381266117096
ep2_train_time 19.22308588027954
Test Epoch2 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep2_t0.4_test_time 0.416003942489624
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m2//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.006739285714285714 (3774/560000), AUC 0.35882768034935
ep3_train_time 19.185054779052734
Test Epoch3 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep3_t0.4_test_time 0.41478729248046875
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m2//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.005201785714285714 (2913/560000), AUC 0.3452175557613373
ep4_train_time 19.212020874023438
Test Epoch4 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep4_t0.4_test_time 0.4119079113006592
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m2//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.004639285714285715 (2598/560000), AUC 0.33779650926589966
ep5_train_time 19.318603515625
Test Epoch5 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep5_t0.4_test_time 0.4128868579864502
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m2//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.0045053571428571425 (2523/560000), AUC 0.334023654460907
ep6_train_time 19.259623289108276
Test Epoch6 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep6_t0.4_test_time 0.4128255844116211
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m2//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.004226785714285714 (2367/560000), AUC 0.3311139941215515
ep7_train_time 19.260196447372437
Test Epoch7 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep7_t0.4_test_time 0.4117913246154785
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m2//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.0041089285714285715 (2301/560000), AUC 0.32885727286338806
ep8_train_time 19.275049448013306
Test Epoch8 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep8_t0.4_test_time 0.41518545150756836
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m2//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.004021428571428572 (2252/560000), AUC 0.32710614800453186
ep9_train_time 19.228764057159424
Test Epoch9 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep9_t0.4_test_time 0.41013121604919434
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m2//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987098276615143
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 200.83572125434875
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m2//dbpedia_14_linearal_l5.pt
Test threshold 0.4 Acc 0.9842, AUC 0.499706894159317, avg_entr 0.005910081323236227
t0.4_test_time 0.41660118103027344
