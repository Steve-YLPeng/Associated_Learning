total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m2//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 62.39569044113159
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.007494642857142857 (4197/560000), AUC 0.5093684792518616
ep0_train_time 20.647098064422607
Test Epoch0 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep0_t0.6_test_time 0.40912628173828125
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m3//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.007744642857142857 (4337/560000), AUC 0.4928959012031555
ep1_train_time 19.21776795387268
Test Epoch1 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep1_t0.6_test_time 0.4105210304260254
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m3//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.005358928571428572 (3001/560000), AUC 0.4649500548839569
ep2_train_time 19.302273988723755
Test Epoch2 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep2_t0.6_test_time 0.41393113136291504
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m3//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.003014285714285714 (1688/560000), AUC 0.44548535346984863
ep3_train_time 19.333746194839478
Test Epoch3 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep3_t0.6_test_time 0.41437864303588867
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m3//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.002007142857142857 (1124/560000), AUC 0.435513436794281
ep4_train_time 19.30878734588623
Test Epoch4 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep4_t0.6_test_time 0.41710901260375977
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m3//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.0030839285714285712 (1727/560000), AUC 0.4327273666858673
ep5_train_time 19.2954843044281
Test Epoch5 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep5_t0.6_test_time 0.41801929473876953
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m3//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.005189285714285714 (2906/560000), AUC 0.4300284683704376
ep6_train_time 19.261056423187256
Test Epoch6 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep6_t0.6_test_time 0.4187469482421875
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m3//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.0075785714285714284 (4244/560000), AUC 0.4278579354286194
ep7_train_time 19.329509258270264
Test Epoch7 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep7_t0.6_test_time 0.40963172912597656
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m3//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.009167857142857143 (5134/560000), AUC 0.4257047176361084
ep8_train_time 19.306010246276855
Test Epoch8 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep8_t0.6_test_time 0.41564464569091797
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m3//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.010207142857142857 (5716/560000), AUC 0.42466598749160767
ep9_train_time 19.300121068954468
Test Epoch9 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep9_t0.6_test_time 0.4100067615509033
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m3//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987121522426605
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 199.8318543434143
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m3//dbpedia_14_linearal_l5.pt
Test threshold 0.6 Acc 0.9849428571428571, AUC 0.4997170567512512, avg_entr 0.0057458127848804
t0.6_test_time 0.4113345146179199
