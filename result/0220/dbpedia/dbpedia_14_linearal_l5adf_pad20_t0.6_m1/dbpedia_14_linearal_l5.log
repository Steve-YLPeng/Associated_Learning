total count words 887881
vocab size 30000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 59.08579206466675
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.07148214285714286 (40030/560000), AUC 0.44641607999801636
ep0_train_time 26.249220848083496
Test Epoch0 threshold 0.6 Acc 0.9641714285714286, AUC 0.498539537191391, avg_entr 0.029956843703985214
ep0_t0.6_test_time 0.41355323791503906
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m1//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.07143392857142856 (40003/560000), AUC 0.4479905664920807
ep1_train_time 23.783416986465454
Test Epoch1 threshold 0.6 Acc 0.9638857142857142, AUC 0.4986611008644104, avg_entr 0.016736628487706184
ep1_t0.6_test_time 0.4223668575286865
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m1//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.07143928571428572 (40006/560000), AUC 0.4567716717720032
ep2_train_time 23.7703378200531
Test Epoch2 threshold 0.6 Acc 0.9646, AUC 0.49868568778038025, avg_entr 0.012362923473119736
ep2_t0.6_test_time 0.41312146186828613
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m1//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.07145714285714286 (40016/560000), AUC 0.46374574303627014
ep3_train_time 23.763345956802368
Test Epoch3 threshold 0.6 Acc 0.9642857142857143, AUC 0.49869757890701294, avg_entr 0.009865297004580498
ep3_t0.6_test_time 0.41271233558654785
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m1//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.071475 (40026/560000), AUC 0.4685029089450836
ep4_train_time 23.8939790725708
Test Epoch4 threshold 0.6 Acc 0.9644857142857143, AUC 0.49867862462997437, avg_entr 0.008996390737593174
ep4_t0.6_test_time 0.4102201461791992
gc 0
Train Epoch5 Acc 0.071475 (40026/560000), AUC 0.47125107049942017
ep5_train_time 23.64813804626465
Test Epoch5 threshold 0.6 Acc 0.9648, AUC 0.4987044930458069, avg_entr 0.008438792079687119
ep5_t0.6_test_time 0.41550254821777344
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m1//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.07146964285714286 (40023/560000), AUC 0.4725765287876129
ep6_train_time 23.698153495788574
Test Epoch6 threshold 0.6 Acc 0.9649142857142857, AUC 0.4986967146396637, avg_entr 0.00847435463219881
ep6_t0.6_test_time 0.4184567928314209
gc 0
Train Epoch7 Acc 0.07147321428571428 (40025/560000), AUC 0.47339698672294617
ep7_train_time 23.780896425247192
Test Epoch7 threshold 0.6 Acc 0.9647428571428571, AUC 0.49871212244033813, avg_entr 0.008477747440338135
ep7_t0.6_test_time 0.41260242462158203
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m1//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.07147321428571428 (40025/560000), AUC 0.47374290227890015
ep8_train_time 23.810422897338867
Test Epoch8 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep8_t0.6_test_time 0.41472935676574707
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m1//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.0714625 (40019/560000), AUC 0.4742732048034668
ep9_train_time 23.748488426208496
Test Epoch9 threshold 0.6 Acc 0.9648285714285715, AUC 0.49870795011520386, avg_entr 0.008350828662514687
ep9_t0.6_test_time 0.41162753105163574
Best AUC 0.4987121522426605
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 245.47123527526855
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m1//dbpedia_14_linearal_l5.pt
Test threshold 0.6 Acc 0.9849428571428571, AUC 0.4997170567512512, avg_entr 0.0057458127848804
t0.6_test_time 0.41039562225341797
