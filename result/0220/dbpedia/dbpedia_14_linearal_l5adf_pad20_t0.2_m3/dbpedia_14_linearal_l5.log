total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m2//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.19245386123657
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.052892857142857144 (29620/560000), AUC 0.4643996059894562
ep0_train_time 20.77473545074463
Test Epoch0 threshold 0.2 Acc 0.9649714285714286, AUC 0.4987093508243561, avg_entr 0.008494749665260315
ep0_t0.2_test_time 0.4322078227996826
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m3//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.07393035714285714 (41401/560000), AUC 0.4886013865470886
ep1_train_time 18.976543188095093
Test Epoch1 threshold 0.2 Acc 0.965, AUC 0.49870923161506653, avg_entr 0.008492407388985157
ep1_t0.2_test_time 0.4272150993347168
gc 0
Train Epoch2 Acc 0.06978571428571428 (39080/560000), AUC 0.5079705119132996
ep2_train_time 19.139028549194336
Test Epoch2 threshold 0.2 Acc 0.9650285714285715, AUC 0.49870920181274414, avg_entr 0.008477612398564816
ep2_t0.2_test_time 0.43512916564941406
gc 0
Train Epoch3 Acc 0.06844821428571428 (38331/560000), AUC 0.5155893564224243
ep3_train_time 19.05949115753174
Test Epoch3 threshold 0.2 Acc 0.965, AUC 0.4987090229988098, avg_entr 0.008466124534606934
ep3_t0.2_test_time 0.43248915672302246
gc 0
Train Epoch4 Acc 0.06503035714285714 (36417/560000), AUC 0.5206573009490967
ep4_train_time 19.04702639579773
Test Epoch4 threshold 0.2 Acc 0.9649714285714286, AUC 0.49870964884757996, avg_entr 0.008476004004478455
ep4_t0.2_test_time 0.4316384792327881
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m3//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.05942857142857143 (33280/560000), AUC 0.5235872864723206
ep5_train_time 18.993441343307495
Test Epoch5 threshold 0.2 Acc 0.9649714285714286, AUC 0.498709499835968, avg_entr 0.008470140397548676
ep5_t0.2_test_time 0.4259755611419678
gc 0
Train Epoch6 Acc 0.05520714285714286 (30916/560000), AUC 0.5254520177841187
ep6_train_time 18.941632509231567
Test Epoch6 threshold 0.2 Acc 0.965, AUC 0.4987097382545471, avg_entr 0.008472385816276073
ep6_t0.2_test_time 0.43051791191101074
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m3//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.05118214285714286 (28662/560000), AUC 0.5265363454818726
ep7_train_time 18.919941425323486
Test Epoch7 threshold 0.2 Acc 0.9649714285714286, AUC 0.49870967864990234, avg_entr 0.008473187685012817
ep7_t0.2_test_time 0.43103647232055664
gc 0
Train Epoch8 Acc 0.047346428571428574 (26514/560000), AUC 0.5268456935882568
ep8_train_time 19.03037428855896
Test Epoch8 threshold 0.2 Acc 0.9650285714285715, AUC 0.49870988726615906, avg_entr 0.008473827503621578
ep8_t0.2_test_time 0.4640321731567383
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m3//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.045025 (25214/560000), AUC 0.5268155336380005
ep9_train_time 18.991061449050903
Test Epoch9 threshold 0.2 Acc 0.9650285714285715, AUC 0.4987100660800934, avg_entr 0.008470955304801464
ep9_t0.2_test_time 0.4282417297363281
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m3//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987100660800934
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 197.21801114082336
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m3//dbpedia_14_linearal_l5.pt
Test threshold 0.2 Acc 0.9844, AUC 0.4996534287929535, avg_entr 0.006190876942127943
t0.2_test_time 0.4185187816619873
