total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m3//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.749998807907104
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.018114285714285715 (10144/560000), AUC 0.4273223578929901
ep0_train_time 21.961649894714355
Test Epoch0 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep0_t0.4_test_time 0.41260218620300293
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m4//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.005989285714285714 (3354/560000), AUC 0.44557985663414
ep1_train_time 19.2465181350708
Test Epoch1 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep1_t0.4_test_time 0.41838598251342773
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m4//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.0309 (17304/560000), AUC 0.45739513635635376
ep2_train_time 19.526047706604004
Test Epoch2 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep2_t0.4_test_time 0.4172086715698242
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m4//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.06268214285714285 (35102/560000), AUC 0.47109702229499817
ep3_train_time 19.393649339675903
Test Epoch3 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep3_t0.4_test_time 0.4096977710723877
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m4//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.066075 (37002/560000), AUC 0.4847978949546814
ep4_train_time 19.313920497894287
Test Epoch4 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep4_t0.4_test_time 0.41215014457702637
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m4//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.06565535714285714 (36767/560000), AUC 0.49330371618270874
ep5_train_time 19.265121698379517
Test Epoch5 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep5_t0.4_test_time 0.41857433319091797
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m4//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.06562678571428572 (36751/560000), AUC 0.49770134687423706
ep6_train_time 19.427574396133423
Test Epoch6 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep6_t0.4_test_time 0.41568994522094727
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m4//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.06583392857142857 (36867/560000), AUC 0.5004951357841492
ep7_train_time 19.203112363815308
Test Epoch7 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep7_t0.4_test_time 0.41428351402282715
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m4//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.0659 (36904/560000), AUC 0.5024582147598267
ep8_train_time 19.48187565803528
Test Epoch8 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep8_t0.4_test_time 0.41844868659973145
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m4//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.06609464285714285 (37013/560000), AUC 0.5037098526954651
ep9_train_time 19.537954092025757
Test Epoch9 threshold 0.4 Acc 0.9652, AUC 0.4987098276615143, avg_entr 0.00826717633754015
ep9_t0.4_test_time 0.4141998291015625
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m4//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987098276615143
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 201.9219150543213
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.4_m4//dbpedia_14_linearal_l5.pt
Test threshold 0.4 Acc 0.9842, AUC 0.499706894159317, avg_entr 0.005910081323236227
t0.4_test_time 0.4154343605041504
