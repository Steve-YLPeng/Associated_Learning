total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m1//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.605403661727905
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.013294642857142857 (7445/560000), AUC 0.41997724771499634
ep0_train_time 21.23064351081848
Test Epoch0 threshold 0.2 Acc 0.9643714285714285, AUC 0.49870726466178894, avg_entr 0.008731917478144169
ep0_t0.2_test_time 0.42270588874816895
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m2//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.019244642857142856 (10777/560000), AUC 0.4556366801261902
ep1_train_time 19.145082712173462
Test Epoch1 threshold 0.2 Acc 0.9645142857142858, AUC 0.4987054467201233, avg_entr 0.008695976808667183
ep1_t0.2_test_time 0.4243888854980469
gc 0
Train Epoch2 Acc 0.053144642857142856 (29761/560000), AUC 0.49498194456100464
ep2_train_time 19.075180530548096
Test Epoch2 threshold 0.2 Acc 0.9646, AUC 0.4987061619758606, avg_entr 0.008642035536468029
ep2_t0.2_test_time 0.42675065994262695
gc 0
Train Epoch3 Acc 0.07012678571428571 (39271/560000), AUC 0.5154849290847778
ep3_train_time 19.072668313980103
Test Epoch3 threshold 0.2 Acc 0.9646857142857143, AUC 0.4987064301967621, avg_entr 0.008584573864936829
ep3_t0.2_test_time 0.4310483932495117
gc 0
Train Epoch4 Acc 0.06204642857142857 (34746/560000), AUC 0.5200598239898682
ep4_train_time 18.991816759109497
Test Epoch4 threshold 0.2 Acc 0.9647428571428571, AUC 0.4987080693244934, avg_entr 0.008543185889720917
ep4_t0.2_test_time 0.4271574020385742
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m2//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.05506607142857143 (30837/560000), AUC 0.5207463502883911
ep5_train_time 19.09897255897522
Test Epoch5 threshold 0.2 Acc 0.9649142857142857, AUC 0.49870923161506653, avg_entr 0.008532513864338398
ep5_t0.2_test_time 0.4283292293548584
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m2//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.04965 (27804/560000), AUC 0.5199109315872192
ep6_train_time 19.062078952789307
Test Epoch6 threshold 0.2 Acc 0.9649428571428571, AUC 0.4987087547779083, avg_entr 0.008524641394615173
ep6_t0.2_test_time 0.42232441902160645
gc 0
Train Epoch7 Acc 0.04358392857142857 (24407/560000), AUC 0.519080400466919
ep7_train_time 19.12829613685608
Test Epoch7 threshold 0.2 Acc 0.965, AUC 0.49870947003364563, avg_entr 0.008519555442035198
ep7_t0.2_test_time 0.4254729747772217
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m2//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.03773928571428571 (21134/560000), AUC 0.5174509286880493
ep8_train_time 18.885536670684814
Test Epoch8 threshold 0.2 Acc 0.965, AUC 0.49870914220809937, avg_entr 0.00850545521825552
ep8_t0.2_test_time 0.4243659973144531
gc 0
Train Epoch9 Acc 0.03401607142857143 (19049/560000), AUC 0.5159220099449158
ep9_train_time 19.13233184814453
Test Epoch9 threshold 0.2 Acc 0.9650285714285715, AUC 0.498709499835968, avg_entr 0.008502417244017124
ep9_t0.2_test_time 0.4276771545410156
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m2//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.498709499835968
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 198.1148076057434
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m2//dbpedia_14_linearal_l5.pt
Test threshold 0.2 Acc 0.9844857142857143, AUC 0.4996536076068878, avg_entr 0.006205308251082897
t0.2_test_time 0.418140172958374
