total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m4//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.328697204589844
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.961925 (538678/560000), AUC 0.9979305267333984
ep0_train_time 21.48565912246704
Test Epoch0 threshold 0.2 Acc 0.965, AUC 0.49871012568473816, avg_entr 0.00846915878355503
ep0_t0.2_test_time 0.4266080856323242
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m5//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9834589285714286 (550737/560000), AUC 0.9990406036376953
ep1_train_time 18.837788581848145
Test Epoch1 threshold 0.2 Acc 0.965, AUC 0.4987100660800934, avg_entr 0.008467234671115875
ep1_t0.2_test_time 0.42766666412353516
gc 0
Train Epoch2 Acc 0.9835339285714285 (550779/560000), AUC 0.9990485310554504
ep2_train_time 18.620025873184204
Test Epoch2 threshold 0.2 Acc 0.965, AUC 0.49871012568473816, avg_entr 0.008469605818390846
ep2_t0.2_test_time 0.4363095760345459
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m5//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9835607142857142 (550794/560000), AUC 0.9990410208702087
ep3_train_time 18.938427925109863
Test Epoch3 threshold 0.2 Acc 0.965, AUC 0.49871012568473816, avg_entr 0.008466902188956738
ep3_t0.2_test_time 0.4345226287841797
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m5//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9836428571428572 (550840/560000), AUC 0.9990400671958923
ep4_train_time 18.72350287437439
Test Epoch4 threshold 0.2 Acc 0.9649714285714286, AUC 0.4987100660800934, avg_entr 0.008467948995530605
ep4_t0.2_test_time 0.42371225357055664
gc 0
Train Epoch5 Acc 0.9835875 (550809/560000), AUC 0.9990107417106628
ep5_train_time 18.79628872871399
Test Epoch5 threshold 0.2 Acc 0.965, AUC 0.4987100660800934, avg_entr 0.008466328494250774
ep5_t0.2_test_time 0.4391138553619385
gc 0
Train Epoch6 Acc 0.9835946428571428 (550813/560000), AUC 0.9990221261978149
ep6_train_time 18.80900502204895
Test Epoch6 threshold 0.2 Acc 0.9649714285714286, AUC 0.4987100064754486, avg_entr 0.008466847240924835
ep6_t0.2_test_time 0.4319725036621094
gc 0
Train Epoch7 Acc 0.9836589285714286 (550849/560000), AUC 0.9990141987800598
ep7_train_time 18.774567127227783
Test Epoch7 threshold 0.2 Acc 0.965, AUC 0.4987100660800934, avg_entr 0.00846626702696085
ep7_t0.2_test_time 0.43221521377563477
gc 0
Train Epoch8 Acc 0.9836428571428572 (550840/560000), AUC 0.9990083575248718
ep8_train_time 18.835441827774048
Test Epoch8 threshold 0.2 Acc 0.965, AUC 0.4987100064754486, avg_entr 0.008466134779155254
ep8_t0.2_test_time 0.4309704303741455
gc 0
Train Epoch9 Acc 0.9836660714285714 (550853/560000), AUC 0.9989933967590332
ep9_train_time 18.768508911132812
Test Epoch9 threshold 0.2 Acc 0.965, AUC 0.4987100064754486, avg_entr 0.008467485196888447
ep9_t0.2_test_time 0.43273138999938965
Best AUC 0.49871012568473816
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 195.82969212532043
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m5//dbpedia_14_linearal_l5.pt
Test threshold 0.2 Acc 0.9844, AUC 0.49965348839759827, avg_entr 0.006189337000250816
t0.2_test_time 0.4195566177368164
