total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m3//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 58.34073042869568
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.06326964285714286 (35431/560000), AUC 0.5582077503204346
ep0_train_time 21.98907995223999
Test Epoch0 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep0_t0.7_test_time 0.41248536109924316
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m4//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.07409821428571428 (41495/560000), AUC 0.570153534412384
ep1_train_time 19.40907096862793
Test Epoch1 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep1_t0.7_test_time 0.41620445251464844
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m4//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.12116964285714285 (67855/560000), AUC 0.5754459500312805
ep2_train_time 19.30867028236389
Test Epoch2 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep2_t0.7_test_time 0.41365933418273926
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m4//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.1589875 (89033/560000), AUC 0.575654149055481
ep3_train_time 19.185950756072998
Test Epoch3 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep3_t0.7_test_time 0.41661691665649414
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m4//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.16519642857142858 (92510/560000), AUC 0.5783639550209045
ep4_train_time 19.43497323989868
Test Epoch4 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep4_t0.7_test_time 0.42149806022644043
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m4//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.13087142857142858 (73288/560000), AUC 0.5826219320297241
ep5_train_time 19.470566034317017
Test Epoch5 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep5_t0.7_test_time 0.4154520034790039
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m4//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.13084107142857143 (73271/560000), AUC 0.587745189666748
ep6_train_time 19.32462763786316
Test Epoch6 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep6_t0.7_test_time 0.4127919673919678
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m4//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.13354821428571428 (74787/560000), AUC 0.5911115407943726
ep7_train_time 19.414273023605347
Test Epoch7 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep7_t0.7_test_time 0.4135863780975342
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m4//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.1349732142857143 (75585/560000), AUC 0.5940130352973938
ep8_train_time 19.256673574447632
Test Epoch8 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep8_t0.7_test_time 0.41492795944213867
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m4//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.13561964285714287 (75947/560000), AUC 0.5955362319946289
ep9_train_time 19.332283973693848
Test Epoch9 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep9_t0.7_test_time 0.41077375411987305
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m4//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987258315086365
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 201.6485300064087
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m4//dbpedia_14_linearal_l5.pt
Test threshold 0.7 Acc 0.9852, AUC 0.49968987703323364, avg_entr 0.006038835272192955
t0.7_test_time 0.41861987113952637
