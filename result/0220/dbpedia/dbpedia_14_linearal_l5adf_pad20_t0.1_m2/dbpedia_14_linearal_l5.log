total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m1//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.38493728637695
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.035189285714285715 (19706/560000), AUC 0.4079343378543854
ep0_train_time 21.332272052764893
Test Epoch0 threshold 0.1 Acc 0.9652571428571428, AUC 0.49872225522994995, avg_entr 0.007632971275597811
ep0_t0.1_test_time 0.4675421714782715
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m2//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.021591071428571428 (12091/560000), AUC 0.38526657223701477
ep1_train_time 19.114413738250732
Test Epoch1 threshold 0.1 Acc 0.9652, AUC 0.4987168610095978, avg_entr 0.007008404936641455
ep1_t0.1_test_time 0.47095179557800293
gc 0
Train Epoch2 Acc 0.005851785714285714 (3277/560000), AUC 0.3700063228607178
ep2_train_time 19.116669416427612
Test Epoch2 threshold 0.1 Acc 0.9654857142857143, AUC 0.4987219274044037, avg_entr 0.006460384000092745
ep2_t0.1_test_time 0.47380685806274414
gc 0
Train Epoch3 Acc 0.0070875 (3969/560000), AUC 0.3872621953487396
ep3_train_time 19.01040005683899
Test Epoch3 threshold 0.1 Acc 0.9658571428571429, AUC 0.4987266957759857, avg_entr 0.005902654957026243
ep3_t0.1_test_time 0.4689955711364746
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m2//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.0086125 (4823/560000), AUC 0.4119837284088135
ep4_train_time 19.157476663589478
Test Epoch4 threshold 0.1 Acc 0.9662285714285714, AUC 0.4987325370311737, avg_entr 0.005592227913439274
ep4_t0.1_test_time 0.4678947925567627
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m2//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.008069642857142857 (4519/560000), AUC 0.42565152049064636
ep5_train_time 18.918579816818237
Test Epoch5 threshold 0.1 Acc 0.9662285714285714, AUC 0.4987322688102722, avg_entr 0.005447405856102705
ep5_t0.1_test_time 0.4740612506866455
gc 0
Train Epoch6 Acc 0.007321428571428572 (4100/560000), AUC 0.43379491567611694
ep6_train_time 19.11802911758423
Test Epoch6 threshold 0.1 Acc 0.9663142857142857, AUC 0.4987333416938782, avg_entr 0.005368112586438656
ep6_t0.1_test_time 0.47075557708740234
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m2//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.006844642857142857 (3833/560000), AUC 0.441081702709198
ep7_train_time 19.059812784194946
Test Epoch7 threshold 0.1 Acc 0.9664571428571429, AUC 0.4987317621707916, avg_entr 0.005224804859608412
ep7_t0.1_test_time 0.46952128410339355
gc 0
Train Epoch8 Acc 0.006764285714285714 (3788/560000), AUC 0.4475685656070709
ep8_train_time 19.124563694000244
Test Epoch8 threshold 0.1 Acc 0.9665714285714285, AUC 0.4987342059612274, avg_entr 0.0051428875885903835
ep8_t0.1_test_time 0.46807432174682617
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m2//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.006864285714285714 (3844/560000), AUC 0.45161792635917664
ep9_train_time 19.1402804851532
Test Epoch9 threshold 0.1 Acc 0.9664857142857143, AUC 0.49873086810112, avg_entr 0.005116582382470369
ep9_t0.1_test_time 0.47226786613464355
Best AUC 0.4987342059612274
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 198.83996033668518
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m2//dbpedia_14_linearal_l5.pt
Test threshold 0.1 Acc 0.9853142857142857, AUC 0.4996805191040039, avg_entr 0.0036422754637897015
t0.1_test_time 0.4645085334777832
