total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m1//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.14012050628662
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.05171071428571428 (28958/560000), AUC 0.4638221561908722
ep0_train_time 22.196155071258545
Test Epoch0 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep0_t0.5_test_time 0.4143977165222168
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m2//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.04317142857142857 (24176/560000), AUC 0.4922500550746918
ep1_train_time 19.188475131988525
Test Epoch1 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep1_t0.5_test_time 0.41596293449401855
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m2//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.05916071428571429 (33130/560000), AUC 0.4792667329311371
ep2_train_time 19.359068632125854
Test Epoch2 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep2_t0.5_test_time 0.42062902450561523
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m2//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.049807142857142855 (27892/560000), AUC 0.46499010920524597
ep3_train_time 19.445379495620728
Test Epoch3 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep3_t0.5_test_time 0.4163689613342285
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m2//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.034307142857142855 (19212/560000), AUC 0.46160393953323364
ep4_train_time 19.295044660568237
Test Epoch4 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep4_t0.5_test_time 0.4147357940673828
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m2//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.02505 (14028/560000), AUC 0.45888814330101013
ep5_train_time 19.34957265853882
Test Epoch5 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep5_t0.5_test_time 0.4170372486114502
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m2//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.024317857142857145 (13618/560000), AUC 0.4559359550476074
ep6_train_time 19.496711254119873
Test Epoch6 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep6_t0.5_test_time 0.41632890701293945
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m2//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.030076785714285716 (16843/560000), AUC 0.45231518149375916
ep7_train_time 19.27200412750244
Test Epoch7 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep7_t0.5_test_time 0.4116840362548828
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m2//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.038023214285714285 (21293/560000), AUC 0.44912299513816833
ep8_train_time 19.387634754180908
Test Epoch8 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep8_t0.5_test_time 0.4154508113861084
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m2//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.04333928571428571 (24270/560000), AUC 0.446948766708374
ep9_train_time 19.421165466308594
Test Epoch9 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep9_t0.5_test_time 0.4129910469055176
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m2//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.498745858669281
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 201.9594898223877
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m2//dbpedia_14_linearal_l5.pt
Test threshold 0.5 Acc 0.9845142857142857, AUC 0.49971795082092285, avg_entr 0.005792997311800718
t0.5_test_time 0.414531946182251
