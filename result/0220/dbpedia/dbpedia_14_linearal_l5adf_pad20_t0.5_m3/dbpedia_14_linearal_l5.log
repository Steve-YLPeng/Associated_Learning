total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m2//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.622491121292114
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.014853571428571428 (8318/560000), AUC 0.40096157789230347
ep0_train_time 21.780108213424683
Test Epoch0 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep0_t0.5_test_time 0.42141032218933105
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m3//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.05462857142857143 (30592/560000), AUC 0.4167456328868866
ep1_train_time 19.10914969444275
Test Epoch1 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep1_t0.5_test_time 0.4133188724517822
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m3//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.07274821428571429 (40739/560000), AUC 0.42888912558555603
ep2_train_time 19.07118558883667
Test Epoch2 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep2_t0.5_test_time 0.4206221103668213
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m3//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.06806607142857143 (38117/560000), AUC 0.4301145076751709
ep3_train_time 19.070736169815063
Test Epoch3 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep3_t0.5_test_time 0.4214439392089844
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m3//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.06205714285714286 (34752/560000), AUC 0.42494651675224304
ep4_train_time 19.198442935943604
Test Epoch4 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep4_t0.5_test_time 0.4103860855102539
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m3//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.06992857142857142 (39160/560000), AUC 0.4230661392211914
ep5_train_time 19.221095085144043
Test Epoch5 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep5_t0.5_test_time 0.4189932346343994
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m3//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.07589821428571429 (42503/560000), AUC 0.4216170907020569
ep6_train_time 19.44535756111145
Test Epoch6 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep6_t0.5_test_time 0.41210222244262695
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m3//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.08405535714285714 (47071/560000), AUC 0.42051124572753906
ep7_train_time 19.139527797698975
Test Epoch7 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep7_t0.5_test_time 0.41892528533935547
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m3//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.09112321428571428 (51029/560000), AUC 0.41909655928611755
ep8_train_time 19.042451858520508
Test Epoch8 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep8_t0.5_test_time 0.41604113578796387
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m3//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.09530714285714285 (53372/560000), AUC 0.4175240695476532
ep9_train_time 19.096009254455566
Test Epoch9 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep9_t0.5_test_time 0.4127376079559326
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m3//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.498745858669281
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 199.729088306427
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m3//dbpedia_14_linearal_l5.pt
Test threshold 0.5 Acc 0.9845142857142857, AUC 0.49971795082092285, avg_entr 0.005792997311800718
t0.5_test_time 0.40791964530944824
