total count words 887881
vocab size 30000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 58.54176902770996
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.07412321428571429 (41509/560000), AUC 0.5299872756004333
ep0_train_time 25.45034098625183
Test Epoch0 threshold 0.2 Acc 0.9642, AUC 0.4985763728618622, avg_entr 0.030754704028367996
ep0_t0.2_test_time 0.4175608158111572
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m1//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.07121964285714286 (39883/560000), AUC 0.5307313799858093
ep1_train_time 23.447896242141724
Test Epoch1 threshold 0.2 Acc 0.9635142857142858, AUC 0.49864551424980164, avg_entr 0.017303315922617912
ep1_t0.2_test_time 0.41718244552612305
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m1//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.0695625 (38955/560000), AUC 0.5304803252220154
ep2_train_time 23.43439793586731
Test Epoch2 threshold 0.2 Acc 0.9645428571428571, AUC 0.49866726994514465, avg_entr 0.012293551117181778
ep2_t0.2_test_time 0.42049622535705566
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m1//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.06808392857142857 (38127/560000), AUC 0.5307372808456421
ep3_train_time 23.424869775772095
Test Epoch3 threshold 0.2 Acc 0.9645142857142858, AUC 0.4986662268638611, avg_entr 0.010002829134464264
ep3_t0.2_test_time 0.41751670837402344
gc 0
Train Epoch4 Acc 0.06765 (37884/560000), AUC 0.5320077538490295
ep4_train_time 23.487390756607056
Test Epoch4 threshold 0.2 Acc 0.9647714285714286, AUC 0.4986395239830017, avg_entr 0.00902577955275774
ep4_t0.2_test_time 0.4153919219970703
gc 0
Train Epoch5 Acc 0.0677 (37912/560000), AUC 0.5325138568878174
ep5_train_time 23.407653093338013
Test Epoch5 threshold 0.2 Acc 0.9645714285714285, AUC 0.49870699644088745, avg_entr 0.00879613496363163
ep5_t0.2_test_time 0.4173705577850342
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m1//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.06860535714285715 (38419/560000), AUC 0.5323970317840576
ep6_train_time 23.395658016204834
Test Epoch6 threshold 0.2 Acc 0.9653428571428572, AUC 0.4986859858036041, avg_entr 0.008534842170774937
ep6_t0.2_test_time 0.4191913604736328
gc 0
Train Epoch7 Acc 0.06987678571428571 (39131/560000), AUC 0.5326651930809021
ep7_train_time 23.378174543380737
Test Epoch7 threshold 0.2 Acc 0.9647428571428571, AUC 0.4986971318721771, avg_entr 0.008485930971801281
ep7_t0.2_test_time 0.41967201232910156
gc 0
Train Epoch8 Acc 0.07099107142857143 (39755/560000), AUC 0.5330454111099243
ep8_train_time 23.459997415542603
Test Epoch8 threshold 0.2 Acc 0.9650571428571428, AUC 0.49869224429130554, avg_entr 0.008360208943486214
ep8_t0.2_test_time 0.423187255859375
gc 0
Train Epoch9 Acc 0.07223571428571429 (40452/560000), AUC 0.5336407423019409
ep9_train_time 23.363036394119263
Test Epoch9 threshold 0.2 Acc 0.9648, AUC 0.4987036883831024, avg_entr 0.008510994724929333
ep9_t0.2_test_time 0.42160773277282715
Best AUC 0.49870699644088745
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 241.43224453926086
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m1//dbpedia_14_linearal_l5.pt
Test threshold 0.2 Acc 0.9843714285714286, AUC 0.49965375661849976, avg_entr 0.006345505826175213
t0.2_test_time 0.41210126876831055
