total count words 887881
vocab size 30000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 57.95216989517212
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.07173392857142857 (40171/560000), AUC 0.4928124248981476
ep0_train_time 47.82589888572693
Test Epoch0 threshold 0.6 Acc 0.9639714285714286, AUC 0.49853286147117615, avg_entr 0.03043372370302677
ep0_t0.6_test_time 0.4145183563232422
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.6_m1//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.07142678571428572 (39999/560000), AUC 0.4946618676185608
ep1_train_time 46.49932909011841
Test Epoch1 threshold 0.6 Acc 0.9647428571428571, AUC 0.4986269176006317, avg_entr 0.01678415946662426
ep1_t0.6_test_time 0.4105560779571533
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.6_m1//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.07138214285714285 (39974/560000), AUC 0.4942799508571625
ep2_train_time 46.400169372558594
Test Epoch2 threshold 0.6 Acc 0.9644857142857143, AUC 0.498634397983551, avg_entr 0.012165163643658161
ep2_t0.6_test_time 0.41292309761047363
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.6_m1//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.07125178571428571 (39901/560000), AUC 0.492621511220932
ep3_train_time 46.455589294433594
Test Epoch3 threshold 0.6 Acc 0.9649428571428571, AUC 0.4986840784549713, avg_entr 0.009839318692684174
ep3_t0.6_test_time 0.41353726387023926
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.6_m1//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.07098928571428571 (39754/560000), AUC 0.4911646246910095
ep4_train_time 46.46225118637085
Test Epoch4 threshold 0.6 Acc 0.9643428571428572, AUC 0.4986497461795807, avg_entr 0.009040378965437412
ep4_t0.6_test_time 0.4109010696411133
gc 0
Train Epoch5 Acc 0.07085892857142857 (39681/560000), AUC 0.489058256149292
ep5_train_time 46.46222734451294
Test Epoch5 threshold 0.6 Acc 0.9640571428571428, AUC 0.49866023659706116, avg_entr 0.008837185800075531
ep5_t0.6_test_time 0.4118964672088623
gc 0
Train Epoch6 Acc 0.07075714285714285 (39624/560000), AUC 0.48712706565856934
ep6_train_time 46.551979064941406
Test Epoch6 threshold 0.6 Acc 0.9648285714285715, AUC 0.49869993329048157, avg_entr 0.008615035563707352
ep6_t0.6_test_time 0.41008663177490234
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.6_m1//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.07065892857142857 (39569/560000), AUC 0.48535671830177307
ep7_train_time 46.42734670639038
Test Epoch7 threshold 0.6 Acc 0.9638571428571429, AUC 0.4986565411090851, avg_entr 0.008653850294649601
ep7_t0.6_test_time 0.4185795783996582
gc 0
Train Epoch8 Acc 0.07056785714285714 (39518/560000), AUC 0.4843527674674988
ep8_train_time 46.44743752479553
Test Epoch8 threshold 0.6 Acc 0.965, AUC 0.4987178444862366, avg_entr 0.008323725312948227
ep8_t0.6_test_time 0.4119741916656494
Save ckpt to ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.6_m1//dbpedia_14_lstmal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.0705625 (39515/560000), AUC 0.4842018485069275
ep9_train_time 46.3691840171814
Test Epoch9 threshold 0.6 Acc 0.9646571428571429, AUC 0.4986964762210846, avg_entr 0.008315905928611755
ep9_t0.6_test_time 0.4187483787536621
Best AUC 0.4987178444862366
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 471.3530259132385
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5adf_pad20_t0.6_m1//dbpedia_14_lstmal_l5.pt
Test threshold 0.6 Acc 0.9845428571428572, AUC 0.49968281388282776, avg_entr 0.005934831686317921
t0.6_test_time 0.40831947326660156
