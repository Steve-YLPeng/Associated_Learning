total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m2//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.62793254852295
Start Training
train_mask {2} False
gc 9
Train Epoch0 Acc 0.056744642857142855 (31777/560000), AUC 0.5917472839355469
ep0_train_time 20.32789134979248
Test Epoch0 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep0_t0.7_test_time 0.41543030738830566
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m3//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.03017857142857143 (16900/560000), AUC 0.6064315438270569
ep1_train_time 19.109087467193604
Test Epoch1 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep1_t0.7_test_time 0.4151017665863037
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m3//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.021603571428571427 (12098/560000), AUC 0.6163058280944824
ep2_train_time 19.068374156951904
Test Epoch2 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep2_t0.7_test_time 0.421187162399292
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m3//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.014778571428571429 (8276/560000), AUC 0.6141391396522522
ep3_train_time 18.994739532470703
Test Epoch3 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep3_t0.7_test_time 0.4141974449157715
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m3//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.013814285714285715 (7736/560000), AUC 0.6112323999404907
ep4_train_time 19.134121417999268
Test Epoch4 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep4_t0.7_test_time 0.41988134384155273
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m3//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.015576785714285715 (8723/560000), AUC 0.609772801399231
ep5_train_time 19.035571098327637
Test Epoch5 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep5_t0.7_test_time 0.4104182720184326
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m3//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.017039285714285715 (9542/560000), AUC 0.6100720763206482
ep6_train_time 19.14595890045166
Test Epoch6 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep6_t0.7_test_time 0.41202807426452637
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m3//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.019082142857142857 (10686/560000), AUC 0.6105379462242126
ep7_train_time 19.078773021697998
Test Epoch7 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep7_t0.7_test_time 0.41497182846069336
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m3//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.02135357142857143 (11958/560000), AUC 0.6105987429618835
ep8_train_time 19.139270067214966
Test Epoch8 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep8_t0.7_test_time 0.4234788417816162
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m3//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.023473214285714285 (13145/560000), AUC 0.6107047200202942
ep9_train_time 19.07367205619812
Test Epoch9 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep9_t0.7_test_time 0.4153401851654053
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m3//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987258315086365
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 197.65671968460083
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m3//dbpedia_14_linearal_l5.pt
Test threshold 0.7 Acc 0.9852, AUC 0.49968987703323364, avg_entr 0.006038835272192955
t0.7_test_time 0.4110713005065918
