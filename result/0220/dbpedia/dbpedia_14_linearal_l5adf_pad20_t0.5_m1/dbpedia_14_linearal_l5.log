total count words 887881
vocab size 30000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.968101501464844
Start Training
train_mask {0} False
gc 0
Train Epoch0 Acc 0.0639 (35784/560000), AUC 0.5433552861213684
ep0_train_time 26.32313847541809
Test Epoch0 threshold 0.5 Acc 0.9634, AUC 0.4985654354095459, avg_entr 0.030526287853717804
ep0_t0.5_test_time 0.41558361053466797
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m1//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.06302321428571428 (35293/560000), AUC 0.5466002225875854
ep1_train_time 23.550759315490723
Test Epoch1 threshold 0.5 Acc 0.9651428571428572, AUC 0.49861669540405273, avg_entr 0.016654614359140396
ep1_t0.5_test_time 0.41428422927856445
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m1//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.06149107142857143 (34435/560000), AUC 0.5457308292388916
ep2_train_time 23.526655912399292
Test Epoch2 threshold 0.5 Acc 0.9640571428571428, AUC 0.49864551424980164, avg_entr 0.012198974378407001
ep2_t0.5_test_time 0.4154937267303467
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m1//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.05977142857142857 (33472/560000), AUC 0.5439596176147461
ep3_train_time 23.485344171524048
Test Epoch3 threshold 0.5 Acc 0.9646285714285714, AUC 0.4986434876918793, avg_entr 0.009696628898382187
ep3_t0.5_test_time 0.4193294048309326
gc 0
Train Epoch4 Acc 0.05883928571428571 (32950/560000), AUC 0.5422433614730835
ep4_train_time 23.411593437194824
Test Epoch4 threshold 0.5 Acc 0.9647142857142857, AUC 0.4986664354801178, avg_entr 0.00878271646797657
ep4_t0.5_test_time 0.4161109924316406
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m1//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.05858928571428571 (32810/560000), AUC 0.5405911207199097
ep5_train_time 23.505173206329346
Test Epoch5 threshold 0.5 Acc 0.9653428571428572, AUC 0.4986836910247803, avg_entr 0.00835861824452877
ep5_t0.5_test_time 0.42061734199523926
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m1//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.058685714285714285 (32864/560000), AUC 0.537916362285614
ep6_train_time 23.491576433181763
Test Epoch6 threshold 0.5 Acc 0.9647428571428571, AUC 0.4987203776836395, avg_entr 0.008568577468395233
ep6_t0.5_test_time 0.41469693183898926
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m1//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.058744642857142856 (32897/560000), AUC 0.5357474088668823
ep7_train_time 23.47353482246399
Test Epoch7 threshold 0.5 Acc 0.9650571428571428, AUC 0.4986634850502014, avg_entr 0.008180651813745499
ep7_t0.5_test_time 0.41144466400146484
gc 0
Train Epoch8 Acc 0.058753571428571426 (32902/560000), AUC 0.5338906645774841
ep8_train_time 23.52781867980957
Test Epoch8 threshold 0.5 Acc 0.9647428571428571, AUC 0.4986702501773834, avg_entr 0.008257617242634296
ep8_t0.5_test_time 0.41593313217163086
gc 0
Train Epoch9 Acc 0.058867857142857145 (32966/560000), AUC 0.531877338886261
ep9_train_time 23.4909725189209
Test Epoch9 threshold 0.5 Acc 0.9652285714285714, AUC 0.498745858669281, avg_entr 0.008091917261481285
ep9_t0.5_test_time 0.41608238220214844
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m1//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.498745858669281
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 243.0061457157135
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.5_m1//dbpedia_14_linearal_l5.pt
Test threshold 0.5 Acc 0.9845142857142857, AUC 0.49971795082092285, avg_entr 0.005792997311800718
t0.5_test_time 0.4134945869445801
