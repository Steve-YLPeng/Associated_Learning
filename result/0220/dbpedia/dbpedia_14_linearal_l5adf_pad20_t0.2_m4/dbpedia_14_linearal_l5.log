total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m3//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 56.47843599319458
Start Training
train_mask {3} False
gc 9
Train Epoch0 Acc 0.124425 (69678/560000), AUC 0.6480701565742493
ep0_train_time 20.892732858657837
Test Epoch0 threshold 0.2 Acc 0.9650285714285715, AUC 0.49871012568473816, avg_entr 0.008472385816276073
ep0_t0.2_test_time 0.4349548816680908
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m4//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.14825 (83020/560000), AUC 0.6662425398826599
ep1_train_time 18.830868005752563
Test Epoch1 threshold 0.2 Acc 0.965, AUC 0.4987100660800934, avg_entr 0.008469549007713795
ep1_t0.2_test_time 0.4304482936859131
gc 0
Train Epoch2 Acc 0.16178035714285716 (90597/560000), AUC 0.6635909676551819
ep2_train_time 18.87173581123352
Test Epoch2 threshold 0.2 Acc 0.9649714285714286, AUC 0.49871009588241577, avg_entr 0.008466264232993126
ep2_t0.2_test_time 0.4332122802734375
gc 0
Train Epoch3 Acc 0.18012678571428573 (100871/560000), AUC 0.6622233390808105
ep3_train_time 18.955188035964966
Test Epoch3 threshold 0.2 Acc 0.965, AUC 0.4987100064754486, avg_entr 0.008469946682453156
ep3_t0.2_test_time 0.4339718818664551
gc 0
Train Epoch4 Acc 0.19300357142857144 (108082/560000), AUC 0.656042754650116
ep4_train_time 18.89877438545227
Test Epoch4 threshold 0.2 Acc 0.965, AUC 0.4987099766731262, avg_entr 0.008468354120850563
ep4_t0.2_test_time 0.43413829803466797
gc 0
Train Epoch5 Acc 0.19989642857142856 (111942/560000), AUC 0.6511512994766235
ep5_train_time 18.915974378585815
Test Epoch5 threshold 0.2 Acc 0.965, AUC 0.49871009588241577, avg_entr 0.008466399274766445
ep5_t0.2_test_time 0.4328587055206299
gc 0
Train Epoch6 Acc 0.202775 (113554/560000), AUC 0.6459570527076721
ep6_train_time 18.939189672470093
Test Epoch6 threshold 0.2 Acc 0.965, AUC 0.49871009588241577, avg_entr 0.008464336395263672
ep6_t0.2_test_time 0.4301307201385498
gc 0
Train Epoch7 Acc 0.200225 (112126/560000), AUC 0.6432853937149048
ep7_train_time 18.87610363960266
Test Epoch7 threshold 0.2 Acc 0.965, AUC 0.4987100660800934, avg_entr 0.00846673734486103
ep7_t0.2_test_time 0.43499159812927246
gc 0
Train Epoch8 Acc 0.20119285714285715 (112668/560000), AUC 0.6418174505233765
ep8_train_time 18.96456527709961
Test Epoch8 threshold 0.2 Acc 0.965, AUC 0.4987100064754486, avg_entr 0.008464779704809189
ep8_t0.2_test_time 0.434342622756958
gc 0
Train Epoch9 Acc 0.20066964285714287 (112375/560000), AUC 0.6420329809188843
ep9_train_time 18.951961994171143
Test Epoch9 threshold 0.2 Acc 0.965, AUC 0.4987100064754486, avg_entr 0.00846379715949297
ep9_t0.2_test_time 0.43140101432800293
Best AUC 0.49871012568473816
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 196.2053952217102
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.2_m4//dbpedia_14_linearal_l5.pt
Test threshold 0.2 Acc 0.9844285714285714, AUC 0.49965348839759827, avg_entr 0.0061918203718960285
t0.2_test_time 0.4192945957183838
