total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m4//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 102.34525561332703
Start Training
train_mask {4} False
gc 9
Train Epoch0 Acc 0.9639321428571429 (539802/560000), AUC 0.9979966282844543
ep0_train_time 20.816364765167236
Test Epoch0 threshold 0.1 Acc 0.9666, AUC 0.49873074889183044, avg_entr 0.004708162043243647
ep0_t0.1_test_time 0.5129501819610596
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m5//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9840446428571429 (551065/560000), AUC 0.9990671277046204
ep1_train_time 18.72526264190674
Test Epoch1 threshold 0.1 Acc 0.9665714285714285, AUC 0.49873045086860657, avg_entr 0.004682191647589207
ep1_t0.1_test_time 0.5287210941314697
gc 0
Train Epoch2 Acc 0.9841178571428572 (551106/560000), AUC 0.9990743398666382
ep2_train_time 18.663848161697388
Test Epoch2 threshold 0.1 Acc 0.9666571428571429, AUC 0.4987284243106842, avg_entr 0.004662610590457916
ep2_t0.1_test_time 0.5163435935974121
gc 0
Train Epoch3 Acc 0.9841678571428571 (551134/560000), AUC 0.9990922808647156
ep3_train_time 18.653019189834595
Test Epoch3 threshold 0.1 Acc 0.9666571428571429, AUC 0.49872976541519165, avg_entr 0.004649714101105928
ep3_t0.1_test_time 0.5229542255401611
gc 0
Train Epoch4 Acc 0.9841785714285715 (551140/560000), AUC 0.9990951418876648
ep4_train_time 18.685518741607666
Test Epoch4 threshold 0.1 Acc 0.9665714285714285, AUC 0.4987291693687439, avg_entr 0.004636986646801233
ep4_t0.1_test_time 0.5182631015777588
gc 0
Train Epoch5 Acc 0.9841321428571429 (551114/560000), AUC 0.9990578293800354
ep5_train_time 18.689550399780273
Test Epoch5 threshold 0.1 Acc 0.9666285714285714, AUC 0.4987301826477051, avg_entr 0.004634584300220013
ep5_t0.1_test_time 0.5194234848022461
gc 0
Train Epoch6 Acc 0.9841553571428572 (551127/560000), AUC 0.9990567564964294
ep6_train_time 18.638237476348877
Test Epoch6 threshold 0.1 Acc 0.9665428571428571, AUC 0.49873045086860657, avg_entr 0.004636390134692192
ep6_t0.1_test_time 0.5228660106658936
gc 0
Train Epoch7 Acc 0.9841642857142857 (551132/560000), AUC 0.9990672469139099
ep7_train_time 18.73937964439392
Test Epoch7 threshold 0.1 Acc 0.9665428571428571, AUC 0.49872997403144836, avg_entr 0.004617251921445131
ep7_t0.1_test_time 0.5222740173339844
gc 0
Train Epoch8 Acc 0.9841839285714286 (551143/560000), AUC 0.9990553259849548
ep8_train_time 18.649972438812256
Test Epoch8 threshold 0.1 Acc 0.9665714285714285, AUC 0.4987289011478424, avg_entr 0.004623311571776867
ep8_t0.1_test_time 0.5209028720855713
gc 0
Train Epoch9 Acc 0.9841714285714286 (551136/560000), AUC 0.9990250468254089
ep9_train_time 18.616135358810425
Test Epoch9 threshold 0.1 Acc 0.9664857142857143, AUC 0.4987294673919678, avg_entr 0.004606381058692932
ep9_t0.1_test_time 0.5247147083282471
Best AUC 0.49873074889183044
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 194.8676736354828
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.1_m5//dbpedia_14_linearal_l5.pt
Test threshold 0.1 Acc 0.9854, AUC 0.4996800422668457, avg_entr 0.003262867918238044
t0.1_test_time 0.5041077136993408
