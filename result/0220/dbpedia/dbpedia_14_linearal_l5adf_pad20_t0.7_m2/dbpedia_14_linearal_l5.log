total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m1//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 58.05417561531067
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.08978214285714285 (50278/560000), AUC 0.5667072534561157
ep0_train_time 21.661407470703125
Test Epoch0 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep0_t0.7_test_time 0.40811872482299805
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m2//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.12076071428571429 (67626/560000), AUC 0.5975481867790222
ep1_train_time 19.170053482055664
Test Epoch1 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep1_t0.7_test_time 0.4167478084564209
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m2//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.1054125 (59031/560000), AUC 0.5950536727905273
ep2_train_time 19.44392728805542
Test Epoch2 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep2_t0.7_test_time 0.40918421745300293
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m2//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.07914642857142858 (44322/560000), AUC 0.5854854583740234
ep3_train_time 19.306805849075317
Test Epoch3 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep3_t0.7_test_time 0.40636658668518066
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m2//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.05972142857142857 (33444/560000), AUC 0.5721348524093628
ep4_train_time 19.342769861221313
Test Epoch4 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep4_t0.7_test_time 0.41319870948791504
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m2//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.05052321428571428 (28293/560000), AUC 0.5622026324272156
ep5_train_time 19.44472074508667
Test Epoch5 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep5_t0.7_test_time 0.4067952632904053
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m2//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.04428928571428571 (24802/560000), AUC 0.5568285584449768
ep6_train_time 19.364062309265137
Test Epoch6 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep6_t0.7_test_time 0.4103093147277832
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m2//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.03861785714285714 (21626/560000), AUC 0.5521638989448547
ep7_train_time 19.33136773109436
Test Epoch7 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep7_t0.7_test_time 0.4062316417694092
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m2//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.034164285714285716 (19132/560000), AUC 0.5483936667442322
ep8_train_time 19.445852279663086
Test Epoch8 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep8_t0.7_test_time 0.41196608543395996
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m2//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.031544642857142854 (17665/560000), AUC 0.5458239316940308
ep9_train_time 19.349287033081055
Test Epoch9 threshold 0.7 Acc 0.9642857142857143, AUC 0.4987258315086365, avg_entr 0.009167919866740704
ep9_t0.7_test_time 0.41934752464294434
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m2//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987258315086365
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 201.33508467674255
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.7_m2//dbpedia_14_linearal_l5.pt
Test threshold 0.7 Acc 0.9852, AUC 0.49968987703323364, avg_entr 0.006038835272192955
t0.7_test_time 0.4069232940673828
