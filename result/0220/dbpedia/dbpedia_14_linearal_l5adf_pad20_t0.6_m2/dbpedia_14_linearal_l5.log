total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m1//dbpedia_14_linearal_l5.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.68356370925903
Start Training
train_mask {1} False
gc 9
Train Epoch0 Acc 0.08765 (49084/560000), AUC 0.504602313041687
ep0_train_time 22.26349425315857
Test Epoch0 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep0_t0.6_test_time 0.4171438217163086
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m2//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.03893392857142857 (21803/560000), AUC 0.5274174213409424
ep1_train_time 19.555548667907715
Test Epoch1 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep1_t0.6_test_time 0.41478633880615234
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m2//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.019125 (10710/560000), AUC 0.515501856803894
ep2_train_time 19.546505212783813
Test Epoch2 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep2_t0.6_test_time 0.41428327560424805
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m2//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.031133928571428573 (17435/560000), AUC 0.49417734146118164
ep3_train_time 19.455999851226807
Test Epoch3 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep3_t0.6_test_time 0.4179220199584961
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m2//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.040780357142857146 (22837/560000), AUC 0.48950883746147156
ep4_train_time 19.39732527732849
Test Epoch4 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep4_t0.6_test_time 0.41901063919067383
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m2//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.045725 (25606/560000), AUC 0.4910588562488556
ep5_train_time 19.312671661376953
Test Epoch5 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep5_t0.6_test_time 0.4223487377166748
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m2//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.04687678571428571 (26251/560000), AUC 0.4924316108226776
ep6_train_time 19.398760557174683
Test Epoch6 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep6_t0.6_test_time 0.41552114486694336
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m2//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.04730357142857143 (26490/560000), AUC 0.49362292885780334
ep7_train_time 19.412537813186646
Test Epoch7 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep7_t0.6_test_time 0.4174072742462158
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m2//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.04622142857142857 (25884/560000), AUC 0.49469760060310364
ep8_train_time 19.67490005493164
Test Epoch8 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep8_t0.6_test_time 0.4137551784515381
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m2//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.04442857142857143 (24880/560000), AUC 0.49584004282951355
ep9_train_time 19.46084189414978
Test Epoch9 threshold 0.6 Acc 0.9651714285714286, AUC 0.4987121522426605, avg_entr 0.008356567472219467
ep9_t0.6_test_time 0.41931939125061035
Save ckpt to ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m2//dbpedia_14_linearal_l5.pt  ,ep 9
Best AUC 0.4987121522426605
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train/valid_time 203.05729365348816
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5adf_pad20_t0.6_m2//dbpedia_14_linearal_l5.pt
Test threshold 0.6 Acc 0.9849428571428571, AUC 0.4997170567512512, avg_entr 0.0057458127848804
t0.6_test_time 0.4143517017364502
