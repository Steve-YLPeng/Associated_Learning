total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.978776216506958
Start Training
gc 0
Train Epoch0 Acc 0.53155 (21262/40000), AUC 0.5490506887435913
ep0_train_time 10.465798616409302
Test Epoch0 layer4 Acc 0.5916, AUC 0.898335874080658, avg_entr 0.6733303666114807
ep0_l4_test_time 0.5638844966888428
Save ckpt to ckpt/imdb_linearal_l5base_pad300//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.87095 (34838/40000), AUC 0.9353187680244446
ep1_train_time 9.391333818435669
Test Epoch1 layer4 Acc 0.873, AUC 0.9504590034484863, avg_entr 0.19548432528972626
ep1_l4_test_time 0.5730440616607666
Save ckpt to ckpt/imdb_linearal_l5base_pad300//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.91665 (36666/40000), AUC 0.9710220098495483
ep2_train_time 9.29995322227478
Test Epoch2 layer4 Acc 0.8884, AUC 0.9561578035354614, avg_entr 0.14642591774463654
ep2_l4_test_time 0.5694525241851807
Save ckpt to ckpt/imdb_linearal_l5base_pad300//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.93285 (37314/40000), AUC 0.9803735613822937
ep3_train_time 9.362720489501953
Test Epoch3 layer4 Acc 0.8922, AUC 0.9569326043128967, avg_entr 0.10237901657819748
ep3_l4_test_time 0.5677177906036377
Save ckpt to ckpt/imdb_linearal_l5base_pad300//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.94405 (37762/40000), AUC 0.9852617979049683
ep4_train_time 9.372532367706299
Test Epoch4 layer4 Acc 0.8864, AUC 0.9552048444747925, avg_entr 0.07725325971841812
ep4_l4_test_time 0.5687978267669678
gc 0
Train Epoch5 Acc 0.950275 (38011/40000), AUC 0.9884018898010254
ep5_train_time 9.41698408126831
Test Epoch5 layer4 Acc 0.8882, AUC 0.953300416469574, avg_entr 0.05231887847185135
ep5_l4_test_time 0.5718250274658203
gc 0
Train Epoch6 Acc 0.958 (38320/40000), AUC 0.9905499219894409
ep6_train_time 9.300019264221191
Test Epoch6 layer4 Acc 0.8858, AUC 0.9494222402572632, avg_entr 0.0449540875852108
ep6_l4_test_time 0.5665640830993652
gc 0
Train Epoch7 Acc 0.962275 (38491/40000), AUC 0.9924296736717224
ep7_train_time 9.3857901096344
Test Epoch7 layer4 Acc 0.8816, AUC 0.9431938529014587, avg_entr 0.04205828905105591
ep7_l4_test_time 0.5680396556854248
gc 0
Train Epoch8 Acc 0.966675 (38667/40000), AUC 0.9937939643859863
ep8_train_time 9.358180046081543
Test Epoch8 layer4 Acc 0.8784, AUC 0.9404438734054565, avg_entr 0.034521084278821945
ep8_l4_test_time 0.5735015869140625
gc 0
Train Epoch9 Acc 0.97025 (38810/40000), AUC 0.9950815439224243
ep9_train_time 9.408161640167236
Test Epoch9 layer4 Acc 0.8748, AUC 0.9380295276641846, avg_entr 0.03061513416469097
ep9_l4_test_time 0.58188796043396
gc 0
Train Epoch10 Acc 0.972725 (38909/40000), AUC 0.9957504868507385
ep10_train_time 9.340763807296753
Test Epoch10 layer4 Acc 0.8696, AUC 0.9401118159294128, avg_entr 0.027125978842377663
ep10_l4_test_time 0.5936486721038818
gc 0
Train Epoch11 Acc 0.9752 (39008/40000), AUC 0.9964964389801025
ep11_train_time 9.361042261123657
Test Epoch11 layer4 Acc 0.8688, AUC 0.934151291847229, avg_entr 0.024507569149136543
ep11_l4_test_time 0.587092399597168
gc 0
Train Epoch12 Acc 0.977125 (39085/40000), AUC 0.9968558549880981
ep12_train_time 9.322760820388794
Test Epoch12 layer4 Acc 0.8632, AUC 0.931745171546936, avg_entr 0.025048326700925827
ep12_l4_test_time 0.5834875106811523
gc 0
Train Epoch13 Acc 0.9792 (39168/40000), AUC 0.997241735458374
ep13_train_time 9.329717874526978
Test Epoch13 layer4 Acc 0.8654, AUC 0.9325871467590332, avg_entr 0.020860819146037102
ep13_l4_test_time 0.5834252834320068
gc 0
Train Epoch14 Acc 0.98005 (39202/40000), AUC 0.9974340796470642
ep14_train_time 9.410115957260132
Test Epoch14 layer4 Acc 0.8586, AUC 0.9263478517532349, avg_entr 0.020047584548592567
ep14_l4_test_time 0.5853266716003418
gc 0
Train Epoch15 Acc 0.982 (39280/40000), AUC 0.9977613687515259
ep15_train_time 9.356097936630249
Test Epoch15 layer4 Acc 0.8588, AUC 0.9237271547317505, avg_entr 0.019978534430265427
ep15_l4_test_time 0.5923280715942383
gc 0
Train Epoch16 Acc 0.9829 (39316/40000), AUC 0.9979545474052429
ep16_train_time 9.351318359375
Test Epoch16 layer4 Acc 0.8548, AUC 0.9244173169136047, avg_entr 0.017163561657071114
ep16_l4_test_time 0.5737552642822266
gc 0
Train Epoch17 Acc 0.98435 (39374/40000), AUC 0.9981402158737183
ep17_train_time 9.371981382369995
Test Epoch17 layer4 Acc 0.8554, AUC 0.9192253351211548, avg_entr 0.01725873351097107
ep17_l4_test_time 0.5889763832092285
gc 0
Train Epoch18 Acc 0.98505 (39402/40000), AUC 0.9982277154922485
ep18_train_time 9.353291034698486
Test Epoch18 layer4 Acc 0.8522, AUC 0.9196398258209229, avg_entr 0.016144953668117523
ep18_l4_test_time 0.5759124755859375
gc 0
Train Epoch19 Acc 0.98685 (39474/40000), AUC 0.9982526302337646
ep19_train_time 9.419985294342041
Test Epoch19 layer4 Acc 0.8464, AUC 0.9154949188232422, avg_entr 0.018933085724711418
ep19_l4_test_time 0.5718307495117188
gc 0
Train Epoch20 Acc 0.98665 (39466/40000), AUC 0.9984958171844482
ep20_train_time 9.32092833518982
Test Epoch20 layer4 Acc 0.8472, AUC 0.9154670238494873, avg_entr 0.015315727330744267
ep20_l4_test_time 0.5617766380310059
gc 0
Train Epoch21 Acc 0.98755 (39502/40000), AUC 0.9987174272537231
ep21_train_time 9.405626058578491
Test Epoch21 layer4 Acc 0.8432, AUC 0.9104934930801392, avg_entr 0.014163380488753319
ep21_l4_test_time 0.5713627338409424
gc 0
Train Epoch22 Acc 0.98795 (39518/40000), AUC 0.9986645579338074
ep22_train_time 9.377570629119873
Test Epoch22 layer4 Acc 0.843, AUC 0.9105084538459778, avg_entr 0.015349197201430798
ep22_l4_test_time 0.5683486461639404
gc 0
Train Epoch23 Acc 0.98845 (39538/40000), AUC 0.9987743496894836
ep23_train_time 9.340080976486206
Test Epoch23 layer4 Acc 0.8392, AUC 0.9043850898742676, avg_entr 0.0138447480276227
ep23_l4_test_time 0.5800166130065918
gc 0
Train Epoch24 Acc 0.988725 (39549/40000), AUC 0.998938262462616
ep24_train_time 9.277697801589966
Test Epoch24 layer4 Acc 0.8412, AUC 0.9060027599334717, avg_entr 0.01426001451909542
ep24_l4_test_time 0.5941095352172852
gc 0
Train Epoch25 Acc 0.9903 (39612/40000), AUC 0.9990968704223633
ep25_train_time 9.400713443756104
Test Epoch25 layer4 Acc 0.8386, AUC 0.9034181237220764, avg_entr 0.013947859406471252
ep25_l4_test_time 0.5702166557312012
gc 0
Train Epoch26 Acc 0.989475 (39579/40000), AUC 0.9990671873092651
ep26_train_time 9.314301013946533
Test Epoch26 layer4 Acc 0.836, AUC 0.900248110294342, avg_entr 0.013478999026119709
ep26_l4_test_time 0.5801894664764404
gc 0
Train Epoch27 Acc 0.99015 (39606/40000), AUC 0.999026358127594
ep27_train_time 9.361401319503784
Test Epoch27 layer4 Acc 0.8346, AUC 0.8999921083450317, avg_entr 0.010879799723625183
ep27_l4_test_time 0.5722658634185791
gc 0
Train Epoch28 Acc 0.990825 (39633/40000), AUC 0.9992292523384094
ep28_train_time 9.29752254486084
Test Epoch28 layer4 Acc 0.8294, AUC 0.8955255746841431, avg_entr 0.011582726612687111
ep28_l4_test_time 0.593062162399292
gc 0
Train Epoch29 Acc 0.99085 (39634/40000), AUC 0.9992520809173584
ep29_train_time 9.374945163726807
Test Epoch29 layer4 Acc 0.8302, AUC 0.8949036598205566, avg_entr 0.01149924285709858
ep29_l4_test_time 0.5893406867980957
gc 0
Train Epoch30 Acc 0.9916 (39664/40000), AUC 0.9992596507072449
ep30_train_time 9.313958644866943
Test Epoch30 layer4 Acc 0.8304, AUC 0.8943480253219604, avg_entr 0.011278129182755947
ep30_l4_test_time 0.5786936283111572
gc 0
Train Epoch31 Acc 0.99155 (39662/40000), AUC 0.9992749691009521
ep31_train_time 9.414072513580322
Test Epoch31 layer4 Acc 0.8298, AUC 0.8917926549911499, avg_entr 0.01043741311877966
ep31_l4_test_time 0.579094409942627
gc 0
Train Epoch32 Acc 0.99235 (39694/40000), AUC 0.9993924498558044
ep32_train_time 9.334187746047974
Test Epoch32 layer4 Acc 0.8272, AUC 0.8891856074333191, avg_entr 0.010026955977082253
ep32_l4_test_time 0.5851986408233643
gc 0
Train Epoch33 Acc 0.992175 (39687/40000), AUC 0.9993234872817993
ep33_train_time 9.372780561447144
Test Epoch33 layer4 Acc 0.8268, AUC 0.8887526988983154, avg_entr 0.010636044666171074
ep33_l4_test_time 0.5870177745819092
gc 0
Train Epoch34 Acc 0.992775 (39711/40000), AUC 0.9994127154350281
ep34_train_time 9.300944805145264
Test Epoch34 layer4 Acc 0.8248, AUC 0.8873586058616638, avg_entr 0.010690290480852127
ep34_l4_test_time 0.583808422088623
gc 0
Train Epoch35 Acc 0.99275 (39710/40000), AUC 0.9994906783103943
ep35_train_time 9.362677812576294
Test Epoch35 layer4 Acc 0.8218, AUC 0.8849811553955078, avg_entr 0.010226069949567318
ep35_l4_test_time 0.5854282379150391
gc 0
Train Epoch36 Acc 0.993375 (39735/40000), AUC 0.999447226524353
ep36_train_time 9.346646785736084
Test Epoch36 layer4 Acc 0.8194, AUC 0.883331298828125, avg_entr 0.009469261392951012
ep36_l4_test_time 0.5817530155181885
gc 0
Train Epoch37 Acc 0.9933 (39732/40000), AUC 0.9995282888412476
ep37_train_time 9.371901988983154
Test Epoch37 layer4 Acc 0.8192, AUC 0.8818762898445129, avg_entr 0.00909147597849369
ep37_l4_test_time 0.5721714496612549
gc 0
Train Epoch38 Acc 0.993375 (39735/40000), AUC 0.9995672106742859
ep38_train_time 9.402040719985962
Test Epoch38 layer4 Acc 0.8174, AUC 0.8802852630615234, avg_entr 0.008492749184370041
ep38_l4_test_time 0.5639688968658447
gc 0
Train Epoch39 Acc 0.9937 (39748/40000), AUC 0.9995348453521729
ep39_train_time 9.380539417266846
Test Epoch39 layer4 Acc 0.8148, AUC 0.876142144203186, avg_entr 0.008683661930263042
ep39_l4_test_time 0.5832176208496094
gc 0
Train Epoch40 Acc 0.994 (39760/40000), AUC 0.9995787143707275
ep40_train_time 9.349141120910645
Test Epoch40 layer4 Acc 0.8142, AUC 0.8737306594848633, avg_entr 0.007988539524376392
ep40_l4_test_time 0.5846624374389648
gc 0
Train Epoch41 Acc 0.99405 (39762/40000), AUC 0.999559223651886
ep41_train_time 9.386747360229492
Test Epoch41 layer4 Acc 0.8118, AUC 0.8739507794380188, avg_entr 0.0075170439667999744
ep41_l4_test_time 0.5772476196289062
gc 0
Train Epoch42 Acc 0.994 (39760/40000), AUC 0.9995582699775696
ep42_train_time 9.28701400756836
Test Epoch42 layer4 Acc 0.8112, AUC 0.8714358806610107, avg_entr 0.007954011671245098
ep42_l4_test_time 0.5812063217163086
gc 0
Train Epoch43 Acc 0.994325 (39773/40000), AUC 0.9995992183685303
ep43_train_time 9.423442602157593
Test Epoch43 layer4 Acc 0.8118, AUC 0.871268093585968, avg_entr 0.008961939252912998
ep43_l4_test_time 0.5826435089111328
gc 0
Train Epoch44 Acc 0.9945 (39780/40000), AUC 0.9996569752693176
ep44_train_time 9.36525011062622
Test Epoch44 layer4 Acc 0.8102, AUC 0.8670715689659119, avg_entr 0.008012929931282997
ep44_l4_test_time 0.5795271396636963
gc 0
Train Epoch45 Acc 0.994825 (39793/40000), AUC 0.999631941318512
ep45_train_time 9.37734866142273
Test Epoch45 layer4 Acc 0.808, AUC 0.8656180500984192, avg_entr 0.007621464319527149
ep45_l4_test_time 0.5611908435821533
gc 0
Train Epoch46 Acc 0.99515 (39806/40000), AUC 0.9996305704116821
ep46_train_time 9.37187385559082
Test Epoch46 layer4 Acc 0.8062, AUC 0.8647887110710144, avg_entr 0.0072876992635428905
ep46_l4_test_time 0.5716633796691895
gc 0
Train Epoch47 Acc 0.9951 (39804/40000), AUC 0.9995790719985962
ep47_train_time 9.385030269622803
Test Epoch47 layer4 Acc 0.807, AUC 0.8616005182266235, avg_entr 0.007211936172097921
ep47_l4_test_time 0.5477035045623779
gc 0
Train Epoch48 Acc 0.995125 (39805/40000), AUC 0.9995483160018921
ep48_train_time 9.30980634689331
Test Epoch48 layer4 Acc 0.806, AUC 0.8625301122665405, avg_entr 0.006620517000555992
ep48_l4_test_time 0.5766932964324951
gc 0
Train Epoch49 Acc 0.99555 (39822/40000), AUC 0.9996806979179382
ep49_train_time 9.377251625061035
Test Epoch49 layer4 Acc 0.8062, AUC 0.8631927967071533, avg_entr 0.006671484559774399
ep49_l4_test_time 0.5863559246063232
Best AUC 0.9569326043128967
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 500.4952335357666
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad300//imdb_linearal_l5.pt
Test layer4 Acc 0.8866, AUC 0.9515295028686523, avg_entr 0.10741674900054932
l4_test_time 0.5770783424377441
