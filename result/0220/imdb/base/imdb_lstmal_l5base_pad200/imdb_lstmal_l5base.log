total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 25.023504495620728
Start Training
gc 0
Train Epoch0 Acc 0.510275 (20411/40000), AUC 0.5145179629325867
ep0_train_time 69.28123903274536
Test Epoch0 layer4 Acc 0.5652, AUC 0.7387711405754089, avg_entr 0.6815237402915955
ep0_l4_test_time 2.3042705059051514
Save ckpt to ckpt/imdb_lstmal_l5base_pad200//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.814225 (32569/40000), AUC 0.8847085237503052
ep1_train_time 66.24706673622131
Test Epoch1 layer4 Acc 0.8352, AUC 0.9281632900238037, avg_entr 0.1121559590101242
ep1_l4_test_time 2.270315170288086
Save ckpt to ckpt/imdb_lstmal_l5base_pad200//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.903025 (36121/40000), AUC 0.9506589770317078
ep2_train_time 67.26034045219421
Test Epoch2 layer4 Acc 0.8578, AUC 0.9355247616767883, avg_entr 0.07303936034440994
ep2_l4_test_time 2.75905442237854
Save ckpt to ckpt/imdb_lstmal_l5base_pad200//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.922625 (36905/40000), AUC 0.9694811701774597
ep3_train_time 68.93092036247253
Test Epoch3 layer4 Acc 0.8546, AUC 0.9298007488250732, avg_entr 0.06190111115574837
ep3_l4_test_time 2.268732786178589
gc 0
Train Epoch4 Acc 0.9407 (37628/40000), AUC 0.9788370132446289
ep4_train_time 65.66316223144531
Test Epoch4 layer4 Acc 0.8642, AUC 0.9350669384002686, avg_entr 0.06277360767126083
ep4_l4_test_time 2.280059814453125
gc 0
Train Epoch5 Acc 0.9499 (37996/40000), AUC 0.9850176572799683
ep5_train_time 65.71988439559937
Test Epoch5 layer4 Acc 0.861, AUC 0.9299978017807007, avg_entr 0.06152733042836189
ep5_l4_test_time 2.2737700939178467
gc 0
Train Epoch6 Acc 0.9583 (38332/40000), AUC 0.9889518022537231
ep6_train_time 65.82687830924988
Test Epoch6 layer4 Acc 0.8522, AUC 0.9268535375595093, avg_entr 0.039246611297130585
ep6_l4_test_time 2.269930839538574
gc 0
Train Epoch7 Acc 0.964175 (38567/40000), AUC 0.9919922351837158
ep7_train_time 65.87725257873535
Test Epoch7 layer4 Acc 0.8482, AUC 0.9169057607650757, avg_entr 0.031100763007998466
ep7_l4_test_time 2.269284248352051
gc 0
Train Epoch8 Acc 0.969375 (38775/40000), AUC 0.9939496517181396
ep8_train_time 65.81351852416992
Test Epoch8 layer4 Acc 0.845, AUC 0.9182593822479248, avg_entr 0.027951477095484734
ep8_l4_test_time 2.2425923347473145
gc 0
Train Epoch9 Acc 0.9712 (38848/40000), AUC 0.9946728944778442
ep9_train_time 65.80223369598389
Test Epoch9 layer4 Acc 0.841, AUC 0.912964940071106, avg_entr 0.02884580008685589
ep9_l4_test_time 2.254603147506714
gc 0
Train Epoch10 Acc 0.975925 (39037/40000), AUC 0.9960474371910095
ep10_train_time 65.63316202163696
Test Epoch10 layer4 Acc 0.8348, AUC 0.9086981415748596, avg_entr 0.023413481190800667
ep10_l4_test_time 2.24709153175354
gc 0
Train Epoch11 Acc 0.978875 (39155/40000), AUC 0.9966747760772705
ep11_train_time 65.80120944976807
Test Epoch11 layer4 Acc 0.8378, AUC 0.9079824686050415, avg_entr 0.02208215929567814
ep11_l4_test_time 2.280733346939087
gc 0
Train Epoch12 Acc 0.98 (39200/40000), AUC 0.9969646334648132
ep12_train_time 65.5944516658783
Test Epoch12 layer4 Acc 0.837, AUC 0.9052565097808838, avg_entr 0.031929709017276764
ep12_l4_test_time 2.2699286937713623
gc 0
Train Epoch13 Acc 0.98165 (39266/40000), AUC 0.9976227879524231
ep13_train_time 65.70194602012634
Test Epoch13 layer4 Acc 0.8294, AUC 0.9011646509170532, avg_entr 0.02565646730363369
ep13_l4_test_time 2.261855363845825
gc 0
Train Epoch14 Acc 0.9839 (39356/40000), AUC 0.9978368282318115
ep14_train_time 65.70573258399963
Test Epoch14 layer4 Acc 0.8232, AUC 0.9012681245803833, avg_entr 0.024077488109469414
ep14_l4_test_time 2.2866790294647217
gc 0
Train Epoch15 Acc 0.984075 (39363/40000), AUC 0.9979817867279053
ep15_train_time 65.83904528617859
Test Epoch15 layer4 Acc 0.829, AUC 0.898222804069519, avg_entr 0.021338732913136482
ep15_l4_test_time 2.3079307079315186
gc 0
Train Epoch16 Acc 0.9859 (39436/40000), AUC 0.9985082149505615
ep16_train_time 65.7336790561676
Test Epoch16 layer4 Acc 0.8214, AUC 0.8914721012115479, avg_entr 0.01698695868253708
ep16_l4_test_time 2.3024814128875732
gc 0
Train Epoch17 Acc 0.9873 (39492/40000), AUC 0.9985824227333069
ep17_train_time 65.79257202148438
Test Epoch17 layer4 Acc 0.8174, AUC 0.882632851600647, avg_entr 0.01809731498360634
ep17_l4_test_time 2.242184638977051
gc 0
Train Epoch18 Acc 0.98755 (39502/40000), AUC 0.9988806247711182
ep18_train_time 66.09064793586731
Test Epoch18 layer4 Acc 0.8148, AUC 0.8931927680969238, avg_entr 0.0175456702709198
ep18_l4_test_time 2.29986310005188
gc 0
Train Epoch19 Acc 0.988225 (39529/40000), AUC 0.9988363981246948
ep19_train_time 46.40711498260498
Test Epoch19 layer4 Acc 0.8186, AUC 0.8889967799186707, avg_entr 0.024013401940464973
ep19_l4_test_time 2.2559165954589844
gc 0
Train Epoch20 Acc 0.989425 (39577/40000), AUC 0.9988827705383301
ep20_train_time 66.03909015655518
Test Epoch20 layer4 Acc 0.8136, AUC 0.8728610873222351, avg_entr 0.01326419971883297
ep20_l4_test_time 2.243119239807129
gc 0
Train Epoch21 Acc 0.990325 (39613/40000), AUC 0.9991036057472229
ep21_train_time 65.97422409057617
Test Epoch21 layer4 Acc 0.8138, AUC 0.8724875450134277, avg_entr 0.013228990137577057
ep21_l4_test_time 2.2790944576263428
gc 0
Train Epoch22 Acc 0.990925 (39637/40000), AUC 0.999171257019043
ep22_train_time 65.81400394439697
Test Epoch22 layer4 Acc 0.813, AUC 0.8706012964248657, avg_entr 0.01267724484205246
ep22_l4_test_time 2.2561962604522705
gc 0
Train Epoch23 Acc 0.9909 (39636/40000), AUC 0.999140739440918
ep23_train_time 68.24955320358276
Test Epoch23 layer4 Acc 0.8106, AUC 0.8657152652740479, avg_entr 0.013837127946317196
ep23_l4_test_time 2.2700741291046143
gc 0
Train Epoch24 Acc 0.991125 (39645/40000), AUC 0.9991395473480225
ep24_train_time 67.97752070426941
Test Epoch24 layer4 Acc 0.8098, AUC 0.8726012706756592, avg_entr 0.013779792934656143
ep24_l4_test_time 2.2679078578948975
gc 0
Train Epoch25 Acc 0.992625 (39705/40000), AUC 0.999305009841919
ep25_train_time 65.63498377799988
Test Epoch25 layer4 Acc 0.8072, AUC 0.8638032674789429, avg_entr 0.014147529378533363
ep25_l4_test_time 2.257267713546753
gc 0
Train Epoch26 Acc 0.993225 (39729/40000), AUC 0.9994528293609619
ep26_train_time 70.49102997779846
Test Epoch26 layer4 Acc 0.8034, AUC 0.8551305532455444, avg_entr 0.009499622508883476
ep26_l4_test_time 2.255033016204834
gc 0
Train Epoch27 Acc 0.99415 (39766/40000), AUC 0.9994731545448303
ep27_train_time 65.94010949134827
Test Epoch27 layer4 Acc 0.8038, AUC 0.8625279664993286, avg_entr 0.012450624257326126
ep27_l4_test_time 2.176239252090454
gc 0
Train Epoch28 Acc 0.9943 (39772/40000), AUC 0.9995394349098206
ep28_train_time 66.03259110450745
Test Epoch28 layer4 Acc 0.802, AUC 0.8625874519348145, avg_entr 0.010608636774122715
ep28_l4_test_time 2.2193408012390137
gc 0
Train Epoch29 Acc 0.994375 (39775/40000), AUC 0.9995529651641846
ep29_train_time 65.95315194129944
Test Epoch29 layer4 Acc 0.8024, AUC 0.8649306297302246, avg_entr 0.0118938023224473
ep29_l4_test_time 2.2351036071777344
gc 0
Train Epoch30 Acc 0.99455 (39782/40000), AUC 0.9994713068008423
ep30_train_time 65.93539023399353
Test Epoch30 layer4 Acc 0.8022, AUC 0.8538691997528076, avg_entr 0.007493606768548489
ep30_l4_test_time 2.2739758491516113
gc 0
Train Epoch31 Acc 0.994825 (39793/40000), AUC 0.9996767044067383
ep31_train_time 65.92824530601501
Test Epoch31 layer4 Acc 0.8054, AUC 0.8623949289321899, avg_entr 0.010044547729194164
ep31_l4_test_time 2.249257802963257
gc 0
Train Epoch32 Acc 0.9955 (39820/40000), AUC 0.9996857643127441
ep32_train_time 68.27743482589722
Test Epoch32 layer4 Acc 0.8046, AUC 0.8590179681777954, avg_entr 0.010399891994893551
ep32_l4_test_time 2.2987334728240967
gc 0
Train Epoch33 Acc 0.995725 (39829/40000), AUC 0.9996540546417236
ep33_train_time 68.10167717933655
Test Epoch33 layer4 Acc 0.799, AUC 0.8551770448684692, avg_entr 0.007486628834158182
ep33_l4_test_time 2.259603500366211
gc 0
Train Epoch34 Acc 0.9965 (39860/40000), AUC 0.9997493028640747
ep34_train_time 65.8547670841217
Test Epoch34 layer4 Acc 0.7986, AUC 0.8523130416870117, avg_entr 0.00899987667798996
ep34_l4_test_time 2.2562010288238525
gc 0
Train Epoch35 Acc 0.996625 (39865/40000), AUC 0.9997483491897583
ep35_train_time 65.63335299491882
Test Epoch35 layer4 Acc 0.792, AUC 0.8507928848266602, avg_entr 0.0067351204343140125
ep35_l4_test_time 2.245161771774292
gc 0
Train Epoch36 Acc 0.996 (39840/40000), AUC 0.9997587203979492
ep36_train_time 65.62798500061035
Test Epoch36 layer4 Acc 0.8, AUC 0.8489353656768799, avg_entr 0.007938041351735592
ep36_l4_test_time 2.2234108448028564
gc 0
Train Epoch37 Acc 0.997175 (39887/40000), AUC 0.9997761845588684
ep37_train_time 65.80768299102783
Test Epoch37 layer4 Acc 0.7934, AUC 0.8487393856048584, avg_entr 0.005182269029319286
ep37_l4_test_time 2.2862396240234375
gc 0
Train Epoch38 Acc 0.996825 (39873/40000), AUC 0.9997481107711792
ep38_train_time 65.77337050437927
Test Epoch38 layer4 Acc 0.7938, AUC 0.8397247791290283, avg_entr 0.006086308974772692
ep38_l4_test_time 2.273946762084961
gc 0
Train Epoch39 Acc 0.99625 (39850/40000), AUC 0.9997912645339966
ep39_train_time 65.78400230407715
Test Epoch39 layer4 Acc 0.7908, AUC 0.8560924530029297, avg_entr 0.00810844637453556
ep39_l4_test_time 2.2895491123199463
gc 0
Train Epoch40 Acc 0.996875 (39875/40000), AUC 0.9998064041137695
ep40_train_time 65.80011296272278
Test Epoch40 layer4 Acc 0.7914, AUC 0.85254967212677, avg_entr 0.009802676737308502
ep40_l4_test_time 2.249589681625366
gc 0
Train Epoch41 Acc 0.997625 (39905/40000), AUC 0.9998372197151184
ep41_train_time 65.75789189338684
Test Epoch41 layer4 Acc 0.7928, AUC 0.8363966941833496, avg_entr 0.005616585724055767
ep41_l4_test_time 2.2784032821655273
gc 0
Train Epoch42 Acc 0.99785 (39914/40000), AUC 0.9998939633369446
ep42_train_time 65.68235206604004
Test Epoch42 layer4 Acc 0.7926, AUC 0.8485594987869263, avg_entr 0.008445867337286472
ep42_l4_test_time 2.306001901626587
gc 0
Train Epoch43 Acc 0.9982 (39928/40000), AUC 0.9997655749320984
ep43_train_time 73.27989435195923
Test Epoch43 layer4 Acc 0.79, AUC 0.8333584070205688, avg_entr 0.004399709869176149
ep43_l4_test_time 2.747572898864746
gc 0
Train Epoch44 Acc 0.9983 (39932/40000), AUC 0.999815821647644
ep44_train_time 54.02506375312805
Test Epoch44 layer4 Acc 0.79, AUC 0.8274019956588745, avg_entr 0.0049941870383918285
ep44_l4_test_time 2.751100778579712
gc 0
Train Epoch45 Acc 0.998375 (39935/40000), AUC 0.9998501539230347
ep45_train_time 73.8249945640564
Test Epoch45 layer4 Acc 0.7894, AUC 0.8339815139770508, avg_entr 0.0033464920707046986
ep45_l4_test_time 2.3250131607055664
gc 0
Train Epoch46 Acc 0.99805 (39922/40000), AUC 0.9997811913490295
ep46_train_time 71.3779890537262
Test Epoch46 layer4 Acc 0.7876, AUC 0.8388890027999878, avg_entr 0.005650734528899193
ep46_l4_test_time 2.280031204223633
gc 0
Train Epoch47 Acc 0.99835 (39934/40000), AUC 0.9997828006744385
ep47_train_time 65.8464744091034
Test Epoch47 layer4 Acc 0.787, AUC 0.8484488725662231, avg_entr 0.0076827071607112885
ep47_l4_test_time 2.274150848388672
gc 0
Train Epoch48 Acc 0.99805 (39922/40000), AUC 0.9997096657752991
ep48_train_time 65.83548402786255
Test Epoch48 layer4 Acc 0.789, AUC 0.8384839296340942, avg_entr 0.006253588013350964
ep48_l4_test_time 2.252537965774536
gc 0
Train Epoch49 Acc 0.99875 (39950/40000), AUC 0.9998583793640137
ep49_train_time 65.803307056427
Test Epoch49 layer4 Acc 0.7856, AUC 0.8304961919784546, avg_entr 0.004657921846956015
ep49_l4_test_time 2.2326321601867676
Best AUC 0.9355247616767883
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 3420.2321071624756
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad200//imdb_lstmal_l5.pt
Test layer4 Acc 0.8514, AUC 0.9279388189315796, avg_entr 0.0748722180724144
l4_test_time 2.26137375831604
