total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.77265691757202
Start Training
gc 0
Train Epoch0 Acc 0.550325 (22013/40000), AUC 0.5834987163543701
ep0_train_time 8.924758195877075
Test Epoch0 layer4 Acc 0.7912, AUC 0.8742391467094421, avg_entr 0.5802815556526184
ep0_l4_test_time 0.35953617095947266
Save ckpt to ckpt/imdb_linearal_l5base_pad100//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.8505 (34020/40000), AUC 0.92527174949646
ep1_train_time 7.571298599243164
Test Epoch1 layer4 Acc 0.834, AUC 0.9180247187614441, avg_entr 0.24154631793498993
ep1_l4_test_time 0.33533239364624023
Save ckpt to ckpt/imdb_linearal_l5base_pad100//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.894925 (35797/40000), AUC 0.9598976373672485
ep2_train_time 7.398478269577026
Test Epoch2 layer4 Acc 0.842, AUC 0.919466495513916, avg_entr 0.17491209506988525
ep2_l4_test_time 0.33476686477661133
Save ckpt to ckpt/imdb_linearal_l5base_pad100//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.914275 (36571/40000), AUC 0.972774088382721
ep3_train_time 7.518523454666138
Test Epoch3 layer4 Acc 0.8384, AUC 0.915931224822998, avg_entr 0.1416425257921219
ep3_l4_test_time 0.33571434020996094
gc 0
Train Epoch4 Acc 0.930375 (37215/40000), AUC 0.9805808067321777
ep4_train_time 7.565426588058472
Test Epoch4 layer4 Acc 0.8338, AUC 0.9102247357368469, avg_entr 0.11305680871009827
ep4_l4_test_time 0.33883166313171387
gc 0
Train Epoch5 Acc 0.942275 (37691/40000), AUC 0.9852323532104492
ep5_train_time 7.368036508560181
Test Epoch5 layer4 Acc 0.8266, AUC 0.9038693308830261, avg_entr 0.08087194710969925
ep5_l4_test_time 0.3356924057006836
gc 0
Train Epoch6 Acc 0.951 (38040/40000), AUC 0.9884141087532043
ep6_train_time 7.566283702850342
Test Epoch6 layer4 Acc 0.8202, AUC 0.8903442621231079, avg_entr 0.06325510889291763
ep6_l4_test_time 0.3335721492767334
gc 0
Train Epoch7 Acc 0.957075 (38283/40000), AUC 0.9901400208473206
ep7_train_time 7.4401373863220215
Test Epoch7 layer4 Acc 0.8164, AUC 0.8783104419708252, avg_entr 0.052653245627880096
ep7_l4_test_time 0.3179495334625244
gc 0
Train Epoch8 Acc 0.960875 (38435/40000), AUC 0.9917587041854858
ep8_train_time 7.599401950836182
Test Epoch8 layer4 Acc 0.8106, AUC 0.8719704151153564, avg_entr 0.04401339590549469
ep8_l4_test_time 0.29336023330688477
gc 0
Train Epoch9 Acc 0.9645 (38580/40000), AUC 0.9933593273162842
ep9_train_time 7.441197633743286
Test Epoch9 layer4 Acc 0.807, AUC 0.8702799081802368, avg_entr 0.038871586322784424
ep9_l4_test_time 0.325253963470459
gc 0
Train Epoch10 Acc 0.967525 (38701/40000), AUC 0.9944096803665161
ep10_train_time 7.516235113143921
Test Epoch10 layer4 Acc 0.804, AUC 0.8719848990440369, avg_entr 0.03860880061984062
ep10_l4_test_time 0.32887840270996094
gc 0
Train Epoch11 Acc 0.970575 (38823/40000), AUC 0.9952049851417542
ep11_train_time 7.5861732959747314
Test Epoch11 layer4 Acc 0.799, AUC 0.8650527596473694, avg_entr 0.03464365378022194
ep11_l4_test_time 0.3393261432647705
gc 0
Train Epoch12 Acc 0.97295 (38918/40000), AUC 0.9956241846084595
ep12_train_time 7.482331991195679
Test Epoch12 layer4 Acc 0.797, AUC 0.8651992082595825, avg_entr 0.02882113680243492
ep12_l4_test_time 0.3355729579925537
gc 0
Train Epoch13 Acc 0.974725 (38989/40000), AUC 0.9962801933288574
ep13_train_time 7.48060417175293
Test Epoch13 layer4 Acc 0.7906, AUC 0.8623514175415039, avg_entr 0.028029564768075943
ep13_l4_test_time 0.3460805416107178
gc 0
Train Epoch14 Acc 0.976275 (39051/40000), AUC 0.9966696500778198
ep14_train_time 7.480526447296143
Test Epoch14 layer4 Acc 0.79, AUC 0.861980676651001, avg_entr 0.027122655883431435
ep14_l4_test_time 0.31503868103027344
gc 0
Train Epoch15 Acc 0.97695 (39078/40000), AUC 0.9970583915710449
ep15_train_time 7.5206475257873535
Test Epoch15 layer4 Acc 0.786, AUC 0.8604367971420288, avg_entr 0.022210415452718735
ep15_l4_test_time 0.32799816131591797
gc 0
Train Epoch16 Acc 0.9788 (39152/40000), AUC 0.9973633885383606
ep16_train_time 7.482092380523682
Test Epoch16 layer4 Acc 0.7842, AUC 0.8564215898513794, avg_entr 0.022958235815167427
ep16_l4_test_time 0.3391435146331787
gc 0
Train Epoch17 Acc 0.98025 (39210/40000), AUC 0.9975638389587402
ep17_train_time 7.4888951778411865
Test Epoch17 layer4 Acc 0.785, AUC 0.8536468744277954, avg_entr 0.02231290563941002
ep17_l4_test_time 0.3232254981994629
gc 0
Train Epoch18 Acc 0.981225 (39249/40000), AUC 0.9978590607643127
ep18_train_time 7.585127115249634
Test Epoch18 layer4 Acc 0.7798, AUC 0.8512680530548096, avg_entr 0.018089307472109795
ep18_l4_test_time 0.3292715549468994
gc 0
Train Epoch19 Acc 0.98185 (39274/40000), AUC 0.9980496168136597
ep19_train_time 7.415660858154297
Test Epoch19 layer4 Acc 0.7796, AUC 0.8499239683151245, avg_entr 0.018515078350901604
ep19_l4_test_time 0.33356499671936035
gc 0
Train Epoch20 Acc 0.982525 (39301/40000), AUC 0.9980341792106628
ep20_train_time 7.5549476146698
Test Epoch20 layer4 Acc 0.7798, AUC 0.8456287384033203, avg_entr 0.01839548535645008
ep20_l4_test_time 0.30236029624938965
gc 0
Train Epoch21 Acc 0.983325 (39333/40000), AUC 0.9982578754425049
ep21_train_time 7.5364110469818115
Test Epoch21 layer4 Acc 0.776, AUC 0.8412633538246155, avg_entr 0.01844039000570774
ep21_l4_test_time 0.33545589447021484
gc 0
Train Epoch22 Acc 0.983775 (39351/40000), AUC 0.9983521699905396
ep22_train_time 7.441351890563965
Test Epoch22 layer4 Acc 0.7738, AUC 0.8424646258354187, avg_entr 0.016515331342816353
ep22_l4_test_time 0.33732056617736816
gc 0
Train Epoch23 Acc 0.98465 (39386/40000), AUC 0.9983812570571899
ep23_train_time 7.59304404258728
Test Epoch23 layer4 Acc 0.771, AUC 0.8381129503250122, avg_entr 0.017499808222055435
ep23_l4_test_time 0.3386390209197998
gc 0
Train Epoch24 Acc 0.985 (39400/40000), AUC 0.9985822439193726
ep24_train_time 7.401848793029785
Test Epoch24 layer4 Acc 0.77, AUC 0.8372052907943726, avg_entr 0.015887603163719177
ep24_l4_test_time 0.33939075469970703
gc 0
Train Epoch25 Acc 0.985875 (39435/40000), AUC 0.9986892938613892
ep25_train_time 7.5100297927856445
Test Epoch25 layer4 Acc 0.7664, AUC 0.8349369764328003, avg_entr 0.014450957998633385
ep25_l4_test_time 0.3347494602203369
gc 0
Train Epoch26 Acc 0.9865 (39460/40000), AUC 0.9987342357635498
ep26_train_time 7.443724632263184
Test Epoch26 layer4 Acc 0.7642, AUC 0.8312822580337524, avg_entr 0.01357472874224186
ep26_l4_test_time 0.3252716064453125
gc 0
Train Epoch27 Acc 0.9864 (39456/40000), AUC 0.9988107681274414
ep27_train_time 7.45245099067688
Test Epoch27 layer4 Acc 0.765, AUC 0.8283637166023254, avg_entr 0.013394363224506378
ep27_l4_test_time 0.32654762268066406
gc 0
Train Epoch28 Acc 0.987 (39480/40000), AUC 0.9989567995071411
ep28_train_time 7.568118095397949
Test Epoch28 layer4 Acc 0.7624, AUC 0.8279256820678711, avg_entr 0.012497907504439354
ep28_l4_test_time 0.29532885551452637
gc 0
Train Epoch29 Acc 0.9878 (39512/40000), AUC 0.9989558458328247
ep29_train_time 7.5865843296051025
Test Epoch29 layer4 Acc 0.7614, AUC 0.8257390260696411, avg_entr 0.011924097314476967
ep29_l4_test_time 0.3048286437988281
gc 0
Train Epoch30 Acc 0.988025 (39521/40000), AUC 0.9990689158439636
ep30_train_time 7.417328834533691
Test Epoch30 layer4 Acc 0.761, AUC 0.822460949420929, avg_entr 0.013044259510934353
ep30_l4_test_time 0.3336067199707031
gc 0
Train Epoch31 Acc 0.988375 (39535/40000), AUC 0.9990338683128357
ep31_train_time 7.53138279914856
Test Epoch31 layer4 Acc 0.759, AUC 0.8228970170021057, avg_entr 0.011063193902373314
ep31_l4_test_time 0.3050534725189209
gc 0
Train Epoch32 Acc 0.9888 (39552/40000), AUC 0.9991247653961182
ep32_train_time 7.510701894760132
Test Epoch32 layer4 Acc 0.7602, AUC 0.8196711540222168, avg_entr 0.012221076525747776
ep32_l4_test_time 0.35343337059020996
gc 0
Train Epoch33 Acc 0.989275 (39571/40000), AUC 0.9991498589515686
ep33_train_time 7.540712594985962
Test Epoch33 layer4 Acc 0.7608, AUC 0.8186880350112915, avg_entr 0.01145015750080347
ep33_l4_test_time 0.3373689651489258
gc 0
Train Epoch34 Acc 0.99 (39600/40000), AUC 0.999241054058075
ep34_train_time 7.530502796173096
Test Epoch34 layer4 Acc 0.7584, AUC 0.8169559240341187, avg_entr 0.011321286670863628
ep34_l4_test_time 0.33755016326904297
gc 0
Train Epoch35 Acc 0.98995 (39598/40000), AUC 0.9992032051086426
ep35_train_time 7.524498701095581
Test Epoch35 layer4 Acc 0.754, AUC 0.8157354593276978, avg_entr 0.010261567309498787
ep35_l4_test_time 0.31296730041503906
gc 0
Train Epoch36 Acc 0.990625 (39625/40000), AUC 0.9992563724517822
ep36_train_time 7.331805944442749
Test Epoch36 layer4 Acc 0.7548, AUC 0.8088418245315552, avg_entr 0.009926717728376389
ep36_l4_test_time 0.339263916015625
gc 0
Train Epoch37 Acc 0.9907 (39628/40000), AUC 0.9992945194244385
ep37_train_time 7.56619668006897
Test Epoch37 layer4 Acc 0.7544, AUC 0.8090842962265015, avg_entr 0.009573581628501415
ep37_l4_test_time 0.3270878791809082
gc 0
Train Epoch38 Acc 0.990975 (39639/40000), AUC 0.9993277788162231
ep38_train_time 7.523248195648193
Test Epoch38 layer4 Acc 0.753, AUC 0.8116402626037598, avg_entr 0.00919585395604372
ep38_l4_test_time 0.3403913974761963
gc 0
Train Epoch39 Acc 0.991525 (39661/40000), AUC 0.999319314956665
ep39_train_time 7.47782826423645
Test Epoch39 layer4 Acc 0.7528, AUC 0.8053802251815796, avg_entr 0.009520829655230045
ep39_l4_test_time 0.32244420051574707
gc 0
Train Epoch40 Acc 0.991575 (39663/40000), AUC 0.9994487166404724
ep40_train_time 7.547007083892822
Test Epoch40 layer4 Acc 0.7534, AUC 0.8051877021789551, avg_entr 0.008667893707752228
ep40_l4_test_time 0.3266012668609619
gc 0
Train Epoch41 Acc 0.99195 (39678/40000), AUC 0.9994808435440063
ep41_train_time 7.5239646434783936
Test Epoch41 layer4 Acc 0.7522, AUC 0.8044861555099487, avg_entr 0.009449047036468983
ep41_l4_test_time 0.29885196685791016
gc 0
Train Epoch42 Acc 0.9925 (39700/40000), AUC 0.9993972778320312
ep42_train_time 7.514073133468628
Test Epoch42 layer4 Acc 0.751, AUC 0.8016442656517029, avg_entr 0.009998981840908527
ep42_l4_test_time 0.32090306282043457
gc 0
Train Epoch43 Acc 0.99215 (39686/40000), AUC 0.9994518756866455
ep43_train_time 7.582749366760254
Test Epoch43 layer4 Acc 0.7486, AUC 0.8002150654792786, avg_entr 0.008041637018322945
ep43_l4_test_time 0.3390531539916992
gc 0
Train Epoch44 Acc 0.992675 (39707/40000), AUC 0.9995415210723877
ep44_train_time 7.48075270652771
Test Epoch44 layer4 Acc 0.7488, AUC 0.799098551273346, avg_entr 0.0077073159627616405
ep44_l4_test_time 0.3327951431274414
gc 0
Train Epoch45 Acc 0.993125 (39725/40000), AUC 0.9995396137237549
ep45_train_time 7.510601997375488
Test Epoch45 layer4 Acc 0.7506, AUC 0.7950360774993896, avg_entr 0.0075416830368340015
ep45_l4_test_time 0.28218746185302734
gc 0
Train Epoch46 Acc 0.993925 (39757/40000), AUC 0.9994955658912659
ep46_train_time 7.462325096130371
Test Epoch46 layer4 Acc 0.749, AUC 0.7952334880828857, avg_entr 0.009011178277432919
ep46_l4_test_time 0.3343775272369385
gc 0
Train Epoch47 Acc 0.9935 (39740/40000), AUC 0.9995495676994324
ep47_train_time 7.455100774765015
Test Epoch47 layer4 Acc 0.7496, AUC 0.7932957410812378, avg_entr 0.00616435194388032
ep47_l4_test_time 0.33874011039733887
gc 0
Train Epoch48 Acc 0.99385 (39754/40000), AUC 0.9994229078292847
ep48_train_time 7.468728303909302
Test Epoch48 layer4 Acc 0.7466, AUC 0.7885414361953735, avg_entr 0.008053578436374664
ep48_l4_test_time 0.3248786926269531
gc 0
Train Epoch49 Acc 0.994375 (39775/40000), AUC 0.9995396137237549
ep49_train_time 7.569429159164429
Test Epoch49 layer4 Acc 0.745, AUC 0.787044882774353, avg_entr 0.008283315226435661
ep49_l4_test_time 0.33553123474121094
Best AUC 0.919466495513916
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 395.6330335140228
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad100//imdb_linearal_l5.pt
Test layer4 Acc 0.8442, AUC 0.9205853939056396, avg_entr 0.1776491105556488
l4_test_time 0.3220500946044922
