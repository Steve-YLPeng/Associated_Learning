total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 23.551889896392822
Start Training
gc 0
Train Epoch0 Acc 0.5615 (22460/40000), AUC 0.6116193532943726
ep0_train_time 9.995516538619995
Test Epoch0 layer4 Acc 0.7992, AUC 0.90674889087677, avg_entr 0.605465292930603
ep0_l4_test_time 0.4682157039642334
Save ckpt to ckpt/imdb_linearal_l5base_pad200//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.8762 (35048/40000), AUC 0.9439425468444824
ep1_train_time 8.650905847549438
Test Epoch1 layer4 Acc 0.87, AUC 0.9443084001541138, avg_entr 0.2114214301109314
ep1_l4_test_time 0.4790670871734619
Save ckpt to ckpt/imdb_linearal_l5base_pad200//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.914825 (36593/40000), AUC 0.9709287881851196
ep2_train_time 10.391464948654175
Test Epoch2 layer4 Acc 0.8764, AUC 0.94754958152771, avg_entr 0.16582384705543518
ep2_l4_test_time 0.6907265186309814
Save ckpt to ckpt/imdb_linearal_l5base_pad200//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.93205 (37282/40000), AUC 0.9806952476501465
ep3_train_time 8.567342758178711
Test Epoch3 layer4 Acc 0.8792, AUC 0.9486041069030762, avg_entr 0.12469194084405899
ep3_l4_test_time 0.4395022392272949
Save ckpt to ckpt/imdb_linearal_l5base_pad200//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9454 (37816/40000), AUC 0.986514151096344
ep4_train_time 8.336797952651978
Test Epoch4 layer4 Acc 0.878, AUC 0.9456729888916016, avg_entr 0.09729505330324173
ep4_l4_test_time 0.43175649642944336
gc 0
Train Epoch5 Acc 0.9546 (38184/40000), AUC 0.9898717403411865
ep5_train_time 8.288179397583008
Test Epoch5 layer4 Acc 0.874, AUC 0.9434454441070557, avg_entr 0.06091521680355072
ep5_l4_test_time 0.4390082359313965
gc 0
Train Epoch6 Acc 0.960175 (38407/40000), AUC 0.9919048547744751
ep6_train_time 8.42588472366333
Test Epoch6 layer4 Acc 0.8708, AUC 0.9347873330116272, avg_entr 0.048769764602184296
ep6_l4_test_time 0.4449894428253174
gc 0
Train Epoch7 Acc 0.966425 (38657/40000), AUC 0.9935149550437927
ep7_train_time 8.334219217300415
Test Epoch7 layer4 Acc 0.8612, AUC 0.9294613599777222, avg_entr 0.04191085696220398
ep7_l4_test_time 0.44428348541259766
gc 0
Train Epoch8 Acc 0.9692 (38768/40000), AUC 0.9945410490036011
ep8_train_time 8.411190271377563
Test Epoch8 layer4 Acc 0.8578, AUC 0.9226365089416504, avg_entr 0.034471891820430756
ep8_l4_test_time 0.4301426410675049
gc 0
Train Epoch9 Acc 0.973625 (38945/40000), AUC 0.9955755472183228
ep9_train_time 8.353683948516846
Test Epoch9 layer4 Acc 0.8542, AUC 0.9176801443099976, avg_entr 0.02956518903374672
ep9_l4_test_time 0.46967196464538574
gc 0
Train Epoch10 Acc 0.975375 (39015/40000), AUC 0.9965506792068481
ep10_train_time 8.45293927192688
Test Epoch10 layer4 Acc 0.8478, AUC 0.9202178120613098, avg_entr 0.027126140892505646
ep10_l4_test_time 0.44073033332824707
gc 0
Train Epoch11 Acc 0.977725 (39109/40000), AUC 0.9967930912971497
ep11_train_time 8.39059853553772
Test Epoch11 layer4 Acc 0.8472, AUC 0.9142979383468628, avg_entr 0.023286262527108192
ep11_l4_test_time 0.4548664093017578
gc 0
Train Epoch12 Acc 0.9798 (39192/40000), AUC 0.9974400997161865
ep12_train_time 8.394091606140137
Test Epoch12 layer4 Acc 0.8432, AUC 0.9070677161216736, avg_entr 0.022526053711771965
ep12_l4_test_time 0.4359886646270752
gc 0
Train Epoch13 Acc 0.981425 (39257/40000), AUC 0.9977928400039673
ep13_train_time 8.465310335159302
Test Epoch13 layer4 Acc 0.8414, AUC 0.9070943593978882, avg_entr 0.020701831206679344
ep13_l4_test_time 0.4367969036102295
gc 0
Train Epoch14 Acc 0.983775 (39351/40000), AUC 0.997951865196228
ep14_train_time 8.474599838256836
Test Epoch14 layer4 Acc 0.8384, AUC 0.9029035568237305, avg_entr 0.02088809758424759
ep14_l4_test_time 0.44545912742614746
gc 0
Train Epoch15 Acc 0.983975 (39359/40000), AUC 0.9982000589370728
ep15_train_time 8.375111103057861
Test Epoch15 layer4 Acc 0.8346, AUC 0.8985437154769897, avg_entr 0.019543234258890152
ep15_l4_test_time 0.441662073135376
gc 0
Train Epoch16 Acc 0.986 (39440/40000), AUC 0.9981784820556641
ep16_train_time 8.422534227371216
Test Epoch16 layer4 Acc 0.833, AUC 0.893147349357605, avg_entr 0.01776142604649067
ep16_l4_test_time 0.44231224060058594
gc 0
Train Epoch17 Acc 0.9868 (39472/40000), AUC 0.9985312223434448
ep17_train_time 8.41926121711731
Test Epoch17 layer4 Acc 0.829, AUC 0.8907972574234009, avg_entr 0.016093062236905098
ep17_l4_test_time 0.44770312309265137
gc 0
Train Epoch18 Acc 0.987325 (39493/40000), AUC 0.9986796975135803
ep18_train_time 8.449145078659058
Test Epoch18 layer4 Acc 0.8268, AUC 0.8858177065849304, avg_entr 0.016863485798239708
ep18_l4_test_time 0.4296379089355469
gc 0
Train Epoch19 Acc 0.987725 (39509/40000), AUC 0.998965859413147
ep19_train_time 8.384631633758545
Test Epoch19 layer4 Acc 0.8234, AUC 0.8860437870025635, avg_entr 0.01675746962428093
ep19_l4_test_time 0.42896008491516113
gc 0
Train Epoch20 Acc 0.988675 (39547/40000), AUC 0.9989040493965149
ep20_train_time 8.45684027671814
Test Epoch20 layer4 Acc 0.8212, AUC 0.8810314536094666, avg_entr 0.015358666889369488
ep20_l4_test_time 0.4261646270751953
gc 0
Train Epoch21 Acc 0.989475 (39579/40000), AUC 0.9989933967590332
ep21_train_time 6.293355941772461
Test Epoch21 layer4 Acc 0.818, AUC 0.8818569779396057, avg_entr 0.016287244856357574
ep21_l4_test_time 0.25820302963256836
gc 0
Train Epoch22 Acc 0.990175 (39607/40000), AUC 0.9991323947906494
ep22_train_time 3.598785638809204
Test Epoch22 layer4 Acc 0.8154, AUC 0.876768946647644, avg_entr 0.012522508390247822
ep22_l4_test_time 0.25216102600097656
gc 0
Train Epoch23 Acc 0.990525 (39621/40000), AUC 0.9992101192474365
ep23_train_time 3.649240255355835
Test Epoch23 layer4 Acc 0.814, AUC 0.8737308382987976, avg_entr 0.011803099885582924
ep23_l4_test_time 0.2517678737640381
gc 0
Train Epoch24 Acc 0.990775 (39631/40000), AUC 0.9992519617080688
ep24_train_time 3.662154197692871
Test Epoch24 layer4 Acc 0.8118, AUC 0.8672640919685364, avg_entr 0.011460316367447376
ep24_l4_test_time 0.2585608959197998
gc 0
Train Epoch25 Acc 0.99085 (39634/40000), AUC 0.9992992877960205
ep25_train_time 3.676795244216919
Test Epoch25 layer4 Acc 0.8132, AUC 0.8693899512290955, avg_entr 0.012110380455851555
ep25_l4_test_time 0.2570383548736572
gc 0
Train Epoch26 Acc 0.9915 (39660/40000), AUC 0.9993820190429688
ep26_train_time 3.640056848526001
Test Epoch26 layer4 Acc 0.8094, AUC 0.8648316860198975, avg_entr 0.01309794932603836
ep26_l4_test_time 0.2744567394256592
gc 0
Train Epoch27 Acc 0.99195 (39678/40000), AUC 0.999414324760437
ep27_train_time 5.491911888122559
Test Epoch27 layer4 Acc 0.8082, AUC 0.8653395175933838, avg_entr 0.013523541390895844
ep27_l4_test_time 0.4279599189758301
gc 0
Train Epoch28 Acc 0.992125 (39685/40000), AUC 0.9994027614593506
ep28_train_time 8.31398320198059
Test Epoch28 layer4 Acc 0.8054, AUC 0.862334668636322, avg_entr 0.01016014814376831
ep28_l4_test_time 0.43172383308410645
gc 0
Train Epoch29 Acc 0.99255 (39702/40000), AUC 0.9995993375778198
ep29_train_time 8.44277811050415
Test Epoch29 layer4 Acc 0.8032, AUC 0.8590834736824036, avg_entr 0.01119798980653286
ep29_l4_test_time 0.4346120357513428
gc 0
Train Epoch30 Acc 0.992575 (39703/40000), AUC 0.9995453357696533
ep30_train_time 8.355241537094116
Test Epoch30 layer4 Acc 0.8036, AUC 0.8581329584121704, avg_entr 0.00892038457095623
ep30_l4_test_time 0.429002046585083
gc 0
Train Epoch31 Acc 0.99315 (39726/40000), AUC 0.9995503425598145
ep31_train_time 8.433640718460083
Test Epoch31 layer4 Acc 0.8018, AUC 0.8557196855545044, avg_entr 0.009335783310234547
ep31_l4_test_time 0.4325382709503174
gc 0
Train Epoch32 Acc 0.993075 (39723/40000), AUC 0.9995303153991699
ep32_train_time 8.311491966247559
Test Epoch32 layer4 Acc 0.8022, AUC 0.8509857654571533, avg_entr 0.010724186897277832
ep32_l4_test_time 0.4352290630340576
gc 0
Train Epoch33 Acc 0.993575 (39743/40000), AUC 0.9996494054794312
ep33_train_time 8.381394386291504
Test Epoch33 layer4 Acc 0.8004, AUC 0.8525755405426025, avg_entr 0.009388959035277367
ep33_l4_test_time 0.46387648582458496
gc 0
Train Epoch34 Acc 0.99405 (39762/40000), AUC 0.9996912479400635
ep34_train_time 8.345759868621826
Test Epoch34 layer4 Acc 0.7998, AUC 0.8515536785125732, avg_entr 0.007712065242230892
ep34_l4_test_time 0.46283817291259766
gc 0
Train Epoch35 Acc 0.993975 (39759/40000), AUC 0.9996219873428345
ep35_train_time 8.408633470535278
Test Epoch35 layer4 Acc 0.7994, AUC 0.8489861488342285, avg_entr 0.0081523098051548
ep35_l4_test_time 0.4181373119354248
gc 0
Train Epoch36 Acc 0.994075 (39763/40000), AUC 0.9997068047523499
ep36_train_time 8.353898525238037
Test Epoch36 layer4 Acc 0.796, AUC 0.8474570512771606, avg_entr 0.007555883843451738
ep36_l4_test_time 0.43384385108947754
gc 0
Train Epoch37 Acc 0.994775 (39791/40000), AUC 0.9997615218162537
ep37_train_time 8.393136501312256
Test Epoch37 layer4 Acc 0.7966, AUC 0.8486777544021606, avg_entr 0.009150932542979717
ep37_l4_test_time 0.42555665969848633
gc 0
Train Epoch38 Acc 0.99495 (39798/40000), AUC 0.9997522830963135
ep38_train_time 8.384581804275513
Test Epoch38 layer4 Acc 0.7956, AUC 0.8455948233604431, avg_entr 0.007959343492984772
ep38_l4_test_time 0.4328298568725586
gc 0
Train Epoch39 Acc 0.994725 (39789/40000), AUC 0.9997869729995728
ep39_train_time 8.341952800750732
Test Epoch39 layer4 Acc 0.7942, AUC 0.8450080156326294, avg_entr 0.007463620975613594
ep39_l4_test_time 0.42639636993408203
gc 0
Train Epoch40 Acc 0.9954 (39816/40000), AUC 0.9997479319572449
ep40_train_time 8.404070615768433
Test Epoch40 layer4 Acc 0.793, AUC 0.8464342355728149, avg_entr 0.007281990721821785
ep40_l4_test_time 0.43315601348876953
gc 0
Train Epoch41 Acc 0.99515 (39806/40000), AUC 0.9998104572296143
ep41_train_time 8.310688495635986
Test Epoch41 layer4 Acc 0.7916, AUC 0.8430224061012268, avg_entr 0.006761760916560888
ep41_l4_test_time 0.43083906173706055
gc 0
Train Epoch42 Acc 0.99545 (39818/40000), AUC 0.9997614622116089
ep42_train_time 8.303554058074951
Test Epoch42 layer4 Acc 0.7906, AUC 0.8419351577758789, avg_entr 0.00768568180501461
ep42_l4_test_time 0.42731595039367676
gc 0
Train Epoch43 Acc 0.9955 (39820/40000), AUC 0.9998238682746887
ep43_train_time 8.32892107963562
Test Epoch43 layer4 Acc 0.7918, AUC 0.8412281274795532, avg_entr 0.006863821297883987
ep43_l4_test_time 0.4252510070800781
gc 0
Train Epoch44 Acc 0.99565 (39826/40000), AUC 0.9997441172599792
ep44_train_time 8.345749855041504
Test Epoch44 layer4 Acc 0.7896, AUC 0.8393610715866089, avg_entr 0.006790144369006157
ep44_l4_test_time 0.42722415924072266
gc 0
Train Epoch45 Acc 0.99595 (39838/40000), AUC 0.999790608882904
ep45_train_time 8.334959268569946
Test Epoch45 layer4 Acc 0.7884, AUC 0.8396049737930298, avg_entr 0.007468665484338999
ep45_l4_test_time 0.44701623916625977
gc 0
Train Epoch46 Acc 0.996 (39840/40000), AUC 0.9997717142105103
ep46_train_time 8.32415223121643
Test Epoch46 layer4 Acc 0.7852, AUC 0.840004563331604, avg_entr 0.006402146071195602
ep46_l4_test_time 0.42979001998901367
gc 0
Train Epoch47 Acc 0.996425 (39857/40000), AUC 0.9997470378875732
ep47_train_time 8.34906554222107
Test Epoch47 layer4 Acc 0.7896, AUC 0.8411211967468262, avg_entr 0.008140508085489273
ep47_l4_test_time 0.4319267272949219
gc 0
Train Epoch48 Acc 0.996125 (39845/40000), AUC 0.9998043179512024
ep48_train_time 8.412344932556152
Test Epoch48 layer4 Acc 0.7868, AUC 0.8388872146606445, avg_entr 0.005881167016923428
ep48_l4_test_time 0.44077634811401367
gc 0
Train Epoch49 Acc 0.996475 (39859/40000), AUC 0.999811053276062
ep49_train_time 8.317248344421387
Test Epoch49 layer4 Acc 0.7848, AUC 0.8392605781555176, avg_entr 0.006694695446640253
ep49_l4_test_time 0.42798805236816406
Best AUC 0.9486041069030762
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 418.08917212486267
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad200//imdb_linearal_l5.pt
Test layer4 Acc 0.8676, AUC 0.9439784288406372, avg_entr 0.12447917461395264
l4_test_time 0.43759822845458984
