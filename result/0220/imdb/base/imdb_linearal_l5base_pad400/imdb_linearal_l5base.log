total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.2835955619812
Start Training
gc 0
Train Epoch0 Acc 0.514775 (20591/40000), AUC 0.5168113708496094
ep0_train_time 10.348199367523193
Test Epoch0 layer4 Acc 0.5566, AUC 0.8582199811935425, avg_entr 0.6901659369468689
ep0_l4_test_time 0.6953616142272949
Save ckpt to ckpt/imdb_linearal_l5base_pad400//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.84815 (33926/40000), AUC 0.9182988405227661
ep1_train_time 9.310582399368286
Test Epoch1 layer4 Acc 0.8806, AUC 0.949021577835083, avg_entr 0.2292470484972
ep1_l4_test_time 0.6620430946350098
Save ckpt to ckpt/imdb_linearal_l5base_pad400//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.912125 (36485/40000), AUC 0.9680163860321045
ep2_train_time 9.338086366653442
Test Epoch2 layer4 Acc 0.8854, AUC 0.9568946361541748, avg_entr 0.1721213310956955
ep2_l4_test_time 0.6870381832122803
Save ckpt to ckpt/imdb_linearal_l5base_pad400//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9285 (37140/40000), AUC 0.9782359600067139
ep3_train_time 9.216306686401367
Test Epoch3 layer4 Acc 0.8946, AUC 0.9587901830673218, avg_entr 0.11687535047531128
ep3_l4_test_time 0.6817641258239746
Save ckpt to ckpt/imdb_linearal_l5base_pad400//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.94035 (37614/40000), AUC 0.983794093132019
ep4_train_time 9.260018587112427
Test Epoch4 layer4 Acc 0.8972, AUC 0.9594340324401855, avg_entr 0.08381949365139008
ep4_l4_test_time 0.6783051490783691
Save ckpt to ckpt/imdb_linearal_l5base_pad400//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9463 (37852/40000), AUC 0.9865968823432922
ep5_train_time 9.323618650436401
Test Epoch5 layer4 Acc 0.8916, AUC 0.9579650163650513, avg_entr 0.05597152188420296
ep5_l4_test_time 0.6858036518096924
gc 0
Train Epoch6 Acc 0.953425 (38137/40000), AUC 0.9890285730361938
ep6_train_time 9.357686519622803
Test Epoch6 layer4 Acc 0.8934, AUC 0.953980565071106, avg_entr 0.046510014683008194
ep6_l4_test_time 0.6762034893035889
gc 0
Train Epoch7 Acc 0.9584 (38336/40000), AUC 0.990924060344696
ep7_train_time 9.223716020584106
Test Epoch7 layer4 Acc 0.8918, AUC 0.9519811868667603, avg_entr 0.03936314582824707
ep7_l4_test_time 0.6605246067047119
gc 0
Train Epoch8 Acc 0.9625 (38500/40000), AUC 0.9923161268234253
ep8_train_time 9.33576512336731
Test Epoch8 layer4 Acc 0.8884, AUC 0.9467024803161621, avg_entr 0.03570706397294998
ep8_l4_test_time 0.6745662689208984
gc 0
Train Epoch9 Acc 0.96535 (38614/40000), AUC 0.9934805631637573
ep9_train_time 9.231513023376465
Test Epoch9 layer4 Acc 0.8864, AUC 0.9475091695785522, avg_entr 0.030045868828892708
ep9_l4_test_time 0.6838095188140869
gc 0
Train Epoch10 Acc 0.96875 (38750/40000), AUC 0.9942845106124878
ep10_train_time 9.305246114730835
Test Epoch10 layer4 Acc 0.8818, AUC 0.9455502033233643, avg_entr 0.029078099876642227
ep10_l4_test_time 0.6844978332519531
gc 0
Train Epoch11 Acc 0.97085 (38834/40000), AUC 0.9951924085617065
ep11_train_time 9.342057228088379
Test Epoch11 layer4 Acc 0.88, AUC 0.9425920248031616, avg_entr 0.029364120215177536
ep11_l4_test_time 0.6827871799468994
gc 0
Train Epoch12 Acc 0.97405 (38962/40000), AUC 0.9956623315811157
ep12_train_time 9.288241386413574
Test Epoch12 layer4 Acc 0.8748, AUC 0.940422773361206, avg_entr 0.02480420470237732
ep12_l4_test_time 0.5390889644622803
gc 0
Train Epoch13 Acc 0.9751 (39004/40000), AUC 0.9963809251785278
ep13_train_time 9.285297632217407
Test Epoch13 layer4 Acc 0.871, AUC 0.9368413686752319, avg_entr 0.02297842875123024
ep13_l4_test_time 0.6701164245605469
gc 0
Train Epoch14 Acc 0.9773 (39092/40000), AUC 0.996699333190918
ep14_train_time 9.385391473770142
Test Epoch14 layer4 Acc 0.8672, AUC 0.9349321126937866, avg_entr 0.02031351998448372
ep14_l4_test_time 0.6847186088562012
gc 0
Train Epoch15 Acc 0.97815 (39126/40000), AUC 0.9972132444381714
ep15_train_time 9.301934957504272
Test Epoch15 layer4 Acc 0.8652, AUC 0.9333356618881226, avg_entr 0.022061269730329514
ep15_l4_test_time 0.6833899021148682
gc 0
Train Epoch16 Acc 0.979975 (39199/40000), AUC 0.9974181652069092
ep16_train_time 9.234005212783813
Test Epoch16 layer4 Acc 0.8634, AUC 0.9330906867980957, avg_entr 0.01930149458348751
ep16_l4_test_time 0.6810956001281738
gc 0
Train Epoch17 Acc 0.981525 (39261/40000), AUC 0.9977955222129822
ep17_train_time 9.151329517364502
Test Epoch17 layer4 Acc 0.8584, AUC 0.9280968904495239, avg_entr 0.019305046647787094
ep17_l4_test_time 0.6764931678771973
gc 0
Train Epoch18 Acc 0.982675 (39307/40000), AUC 0.997793436050415
ep18_train_time 9.362912654876709
Test Epoch18 layer4 Acc 0.8558, AUC 0.925365149974823, avg_entr 0.018684914335608482
ep18_l4_test_time 0.6689038276672363
gc 0
Train Epoch19 Acc 0.983575 (39343/40000), AUC 0.9981441497802734
ep19_train_time 9.303314208984375
Test Epoch19 layer4 Acc 0.855, AUC 0.9231127500534058, avg_entr 0.015410850755870342
ep19_l4_test_time 0.6587646007537842
gc 0
Train Epoch20 Acc 0.9838 (39352/40000), AUC 0.9982984066009521
ep20_train_time 9.215094804763794
Test Epoch20 layer4 Acc 0.8528, AUC 0.9218646287918091, avg_entr 0.014825987629592419
ep20_l4_test_time 0.673454999923706
gc 0
Train Epoch21 Acc 0.9852 (39408/40000), AUC 0.9985668063163757
ep21_train_time 9.283358812332153
Test Epoch21 layer4 Acc 0.8534, AUC 0.9193729162216187, avg_entr 0.013551492244005203
ep21_l4_test_time 0.6690006256103516
gc 0
Train Epoch22 Acc 0.986075 (39443/40000), AUC 0.9987443685531616
ep22_train_time 9.136783838272095
Test Epoch22 layer4 Acc 0.8504, AUC 0.9168001413345337, avg_entr 0.015465591102838516
ep22_l4_test_time 0.6620063781738281
gc 0
Train Epoch23 Acc 0.9866 (39464/40000), AUC 0.9986908435821533
ep23_train_time 9.306043148040771
Test Epoch23 layer4 Acc 0.8446, AUC 0.9134854078292847, avg_entr 0.014129063114523888
ep23_l4_test_time 0.6663498878479004
gc 0
Train Epoch24 Acc 0.9868 (39472/40000), AUC 0.9988700151443481
ep24_train_time 9.336085081100464
Test Epoch24 layer4 Acc 0.8288, AUC 0.9045988321304321, avg_entr 0.014666982926428318
ep24_l4_test_time 0.667534351348877
gc 0
Train Epoch25 Acc 0.98715 (39486/40000), AUC 0.9989248514175415
ep25_train_time 9.31105089187622
Test Epoch25 layer4 Acc 0.836, AUC 0.910010039806366, avg_entr 0.014945794828236103
ep25_l4_test_time 0.6725690364837646
gc 0
Train Epoch26 Acc 0.987975 (39519/40000), AUC 0.9989619255065918
ep26_train_time 9.463403224945068
Test Epoch26 layer4 Acc 0.842, AUC 0.9092644453048706, avg_entr 0.014860374853014946
ep26_l4_test_time 0.6708216667175293
gc 0
Train Epoch27 Acc 0.988175 (39527/40000), AUC 0.9990427494049072
ep27_train_time 9.25046420097351
Test Epoch27 layer4 Acc 0.84, AUC 0.9062602519989014, avg_entr 0.01576465554535389
ep27_l4_test_time 0.542356014251709
gc 0
Train Epoch28 Acc 0.98875 (39550/40000), AUC 0.9991374015808105
ep28_train_time 9.237038373947144
Test Epoch28 layer4 Acc 0.8368, AUC 0.9048303365707397, avg_entr 0.01489125844091177
ep28_l4_test_time 0.6632096767425537
gc 0
Train Epoch29 Acc 0.9891 (39564/40000), AUC 0.9991438388824463
ep29_train_time 9.198131561279297
Test Epoch29 layer4 Acc 0.835, AUC 0.9028792381286621, avg_entr 0.013159873895347118
ep29_l4_test_time 0.6868476867675781
gc 0
Train Epoch30 Acc 0.98925 (39570/40000), AUC 0.9992032051086426
ep30_train_time 9.37510871887207
Test Epoch30 layer4 Acc 0.8356, AUC 0.9025368690490723, avg_entr 0.014227638021111488
ep30_l4_test_time 0.6716148853302002
gc 0
Train Epoch31 Acc 0.9895 (39580/40000), AUC 0.9992925524711609
ep31_train_time 9.134894609451294
Test Epoch31 layer4 Acc 0.829, AUC 0.9013205766677856, avg_entr 0.010631964541971684
ep31_l4_test_time 0.6706573963165283
gc 0
Train Epoch32 Acc 0.990175 (39607/40000), AUC 0.9993125200271606
ep32_train_time 9.273130893707275
Test Epoch32 layer4 Acc 0.831, AUC 0.8977823257446289, avg_entr 0.012749254703521729
ep32_l4_test_time 0.6617794036865234
gc 0
Train Epoch33 Acc 0.990225 (39609/40000), AUC 0.99934321641922
ep33_train_time 9.327668190002441
Test Epoch33 layer4 Acc 0.8274, AUC 0.8976548910140991, avg_entr 0.01341996155679226
ep33_l4_test_time 0.6616983413696289
gc 0
Train Epoch34 Acc 0.9908 (39632/40000), AUC 0.9993826150894165
ep34_train_time 9.2786705493927
Test Epoch34 layer4 Acc 0.8256, AUC 0.8941916227340698, avg_entr 0.012323691509664059
ep34_l4_test_time 0.6664888858795166
gc 0
Train Epoch35 Acc 0.990925 (39637/40000), AUC 0.9994217157363892
ep35_train_time 9.20271372795105
Test Epoch35 layer4 Acc 0.8226, AUC 0.8928821086883545, avg_entr 0.009362424723803997
ep35_l4_test_time 0.6706826686859131
gc 0
Train Epoch36 Acc 0.9908 (39632/40000), AUC 0.9994020462036133
ep36_train_time 9.379125356674194
Test Epoch36 layer4 Acc 0.826, AUC 0.8940567970275879, avg_entr 0.012448723427951336
ep36_l4_test_time 0.6622233390808105
gc 0
Train Epoch37 Acc 0.991575 (39663/40000), AUC 0.9994103908538818
ep37_train_time 9.230075120925903
Test Epoch37 layer4 Acc 0.8208, AUC 0.8872177004814148, avg_entr 0.008673151955008507
ep37_l4_test_time 0.6653547286987305
gc 0
Train Epoch38 Acc 0.992325 (39693/40000), AUC 0.9994897842407227
ep38_train_time 9.332424402236938
Test Epoch38 layer4 Acc 0.821, AUC 0.885708212852478, avg_entr 0.00922783836722374
ep38_l4_test_time 0.6697473526000977
gc 0
Train Epoch39 Acc 0.9923 (39692/40000), AUC 0.9994697570800781
ep39_train_time 9.166590213775635
Test Epoch39 layer4 Acc 0.8216, AUC 0.8865234851837158, avg_entr 0.012442966923117638
ep39_l4_test_time 0.6663506031036377
gc 0
Train Epoch40 Acc 0.99215 (39686/40000), AUC 0.9994787573814392
ep40_train_time 9.237433195114136
Test Epoch40 layer4 Acc 0.8186, AUC 0.8838814496994019, avg_entr 0.010800933465361595
ep40_l4_test_time 0.6653892993927002
gc 0
Train Epoch41 Acc 0.99265 (39706/40000), AUC 0.9995691776275635
ep41_train_time 9.241366863250732
Test Epoch41 layer4 Acc 0.8156, AUC 0.8826085329055786, avg_entr 0.011481964029371738
ep41_l4_test_time 0.6682555675506592
gc 0
Train Epoch42 Acc 0.992625 (39705/40000), AUC 0.9995248317718506
ep42_train_time 9.276530504226685
Test Epoch42 layer4 Acc 0.8176, AUC 0.8792405128479004, avg_entr 0.01155017875134945
ep42_l4_test_time 0.5230121612548828
gc 0
Train Epoch43 Acc 0.9927 (39708/40000), AUC 0.999455451965332
ep43_train_time 9.212491035461426
Test Epoch43 layer4 Acc 0.8182, AUC 0.8778467178344727, avg_entr 0.00871202815324068
ep43_l4_test_time 0.6830775737762451
gc 0
Train Epoch44 Acc 0.993075 (39723/40000), AUC 0.9996093511581421
ep44_train_time 9.310881853103638
Test Epoch44 layer4 Acc 0.8138, AUC 0.8761999607086182, avg_entr 0.010441740974783897
ep44_l4_test_time 0.6791117191314697
gc 0
Train Epoch45 Acc 0.993525 (39741/40000), AUC 0.9995676279067993
ep45_train_time 9.297004461288452
Test Epoch45 layer4 Acc 0.8136, AUC 0.8760937452316284, avg_entr 0.009966936893761158
ep45_l4_test_time 0.6651456356048584
gc 0
Train Epoch46 Acc 0.9931 (39724/40000), AUC 0.9995115399360657
ep46_train_time 9.260189056396484
Test Epoch46 layer4 Acc 0.8148, AUC 0.8725827932357788, avg_entr 0.008589433506131172
ep46_l4_test_time 0.6610949039459229
gc 0
Train Epoch47 Acc 0.99355 (39742/40000), AUC 0.9994099140167236
ep47_train_time 9.280684232711792
Test Epoch47 layer4 Acc 0.8146, AUC 0.8723592758178711, avg_entr 0.008003815077245235
ep47_l4_test_time 0.6672842502593994
gc 0
Train Epoch48 Acc 0.99355 (39742/40000), AUC 0.9994055032730103
ep48_train_time 9.318098783493042
Test Epoch48 layer4 Acc 0.8088, AUC 0.8714766502380371, avg_entr 0.01004012767225504
ep48_l4_test_time 0.6761322021484375
gc 0
Train Epoch49 Acc 0.994125 (39765/40000), AUC 0.9995745420455933
ep49_train_time 9.316929578781128
Test Epoch49 layer4 Acc 0.811, AUC 0.870528519153595, avg_entr 0.008388843387365341
ep49_l4_test_time 0.6630373001098633
Best AUC 0.9594340324401855
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 500.99863147735596
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad400//imdb_linearal_l5.pt
Test layer4 Acc 0.893, AUC 0.9561616778373718, avg_entr 0.08841642737388611
l4_test_time 0.6684863567352295
