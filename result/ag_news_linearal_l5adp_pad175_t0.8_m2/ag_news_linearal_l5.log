total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.09275833333333333 (11131/120000), AUC 0.4088575541973114
ep0_train_time 9.087849378585815
Test Epoch0 threshold 0.8 Acc 0.9164473684210527, AUC 0.980990469455719, avg_entr 0.027513910084962845
ep0_t0.8_test_time 0.2559511661529541
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.07635 (9162/120000), AUC 0.4667956531047821
ep1_train_time 8.589248418807983
Test Epoch1 threshold 0.8 Acc 0.9123355263157895, AUC 0.9808846712112427, avg_entr 0.026721060276031494
ep1_t0.8_test_time 0.25542783737182617
gc 0
Train Epoch2 Acc 0.12934166666666666 (15521/120000), AUC 0.5031787753105164
ep2_train_time 8.7235586643219
Test Epoch2 threshold 0.8 Acc 0.9154605263157894, AUC 0.9806095361709595, avg_entr 0.025921178981661797
ep2_t0.8_test_time 0.25467920303344727
gc 0
Train Epoch3 Acc 0.1957 (23484/120000), AUC 0.5176862478256226
ep3_train_time 8.703469276428223
Test Epoch3 threshold 0.8 Acc 0.9154605263157894, AUC 0.9804580807685852, avg_entr 0.026752350851893425
ep3_t0.8_test_time 0.2551240921020508
gc 0
Train Epoch4 Acc 0.22483333333333333 (26980/120000), AUC 0.5232494473457336
ep4_train_time 8.75252890586853
Test Epoch4 threshold 0.8 Acc 0.9146381578947368, AUC 0.9803540706634521, avg_entr 0.02529572881758213
ep4_t0.8_test_time 0.2562415599822998
gc 0
Train Epoch5 Acc 0.235125 (28215/120000), AUC 0.5254713296890259
ep5_train_time 8.537423849105835
Test Epoch5 threshold 0.8 Acc 0.9141447368421053, AUC 0.9803270101547241, avg_entr 0.026340296491980553
ep5_t0.8_test_time 0.25787854194641113
gc 0
Train Epoch6 Acc 0.24119166666666667 (28943/120000), AUC 0.5264898538589478
ep6_train_time 9.029770851135254
Test Epoch6 threshold 0.8 Acc 0.9139802631578947, AUC 0.9801217317581177, avg_entr 0.025814728811383247
ep6_t0.8_test_time 0.2546205520629883
gc 0
Train Epoch7 Acc 0.245575 (29469/120000), AUC 0.527027428150177
ep7_train_time 8.739475011825562
Test Epoch7 threshold 0.8 Acc 0.9136513157894737, AUC 0.9800631999969482, avg_entr 0.026320211589336395
ep7_t0.8_test_time 0.25606822967529297
gc 0
Train Epoch8 Acc 0.247725 (29727/120000), AUC 0.5273315906524658
ep8_train_time 8.671900749206543
Test Epoch8 threshold 0.8 Acc 0.9126644736842106, AUC 0.9799574613571167, avg_entr 0.026021432131528854
ep8_t0.8_test_time 0.2548177242279053
gc 0
Train Epoch9 Acc 0.24845 (29814/120000), AUC 0.528094470500946
ep9_train_time 8.614464282989502
Test Epoch9 threshold 0.8 Acc 0.9139802631578947, AUC 0.9799212217330933, avg_entr 0.026140911504626274
ep9_t0.8_test_time 0.2550976276397705
Best AUC 0.980990469455719
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9230263157894737, AUC 0.9865916967391968, avg_entr 0.02809545397758484
t0.8_test_time 0.06430292129516602
