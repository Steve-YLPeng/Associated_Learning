total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.271539721
Start Training
gc 0
Train Epoch0 Acc 0.510175 (20407/40000), AUC 0.5132460594177246
ep0_train_time 78.58702189300001
Test Epoch0 layer0 Acc 0.7546, AUC 0.8814345002174377, avg_entr 0.5660678744316101, f1 0.7546000480651855
ep0_l0_test_time 0.559081128999992
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6072, AUC 0.6500982046127319, avg_entr 0.6626726388931274, f1 0.607200026512146
ep0_l1_test_time 1.0509288110000057
Test Epoch0 layer2 Acc 0.6106, AUC 0.6710488200187683, avg_entr 0.669781506061554, f1 0.6105999946594238
ep0_l2_test_time 1.6623753009999973
Test Epoch0 layer3 Acc 0.5258, AUC 0.6805919408798218, avg_entr 0.6382827758789062, f1 0.5257999897003174
ep0_l3_test_time 2.273767019999994
Test Epoch0 layer4 Acc 0.5288, AUC 0.6778031587600708, avg_entr 0.6888598203659058, f1 0.5288000106811523
ep0_l4_test_time 2.90573212999999
gc 0
Train Epoch1 Acc 0.792075 (31683/40000), AUC 0.8581849932670593
ep1_train_time 79.118692829
Test Epoch1 layer0 Acc 0.8802, AUC 0.9444150328636169, avg_entr 0.29286178946495056, f1 0.8802000284194946
ep1_l0_test_time 0.579945672000008
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8604, AUC 0.9170605540275574, avg_entr 0.09651631116867065, f1 0.8604000210762024
ep1_l1_test_time 1.0637692869999853
Test Epoch1 layer2 Acc 0.8628, AUC 0.9188877940177917, avg_entr 0.09238560497760773, f1 0.8628000020980835
ep1_l2_test_time 1.6538926730000014
Test Epoch1 layer3 Acc 0.8628, AUC 0.918974757194519, avg_entr 0.1028544157743454, f1 0.8628000020980835
ep1_l3_test_time 2.267569936000001
Test Epoch1 layer4 Acc 0.8634, AUC 0.9201620817184448, avg_entr 0.08468346297740936, f1 0.8634000420570374
ep1_l4_test_time 2.8817383559999996
gc 0
Train Epoch2 Acc 0.889625 (35585/40000), AUC 0.9401106238365173
ep2_train_time 79.08968712400002
Test Epoch2 layer0 Acc 0.895, AUC 0.9550113081932068, avg_entr 0.2301146239042282, f1 0.8949999809265137
ep2_l0_test_time 0.5767258829999946
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.869, AUC 0.9394899606704712, avg_entr 0.07656733691692352, f1 0.8690000176429749
ep2_l1_test_time 1.059669829000029
Test Epoch2 layer2 Acc 0.8716, AUC 0.9407115578651428, avg_entr 0.06371849030256271, f1 0.8715999722480774
ep2_l2_test_time 1.6628290010000342
Test Epoch2 layer3 Acc 0.866, AUC 0.9400926828384399, avg_entr 0.07276013493537903, f1 0.8659999966621399
ep2_l3_test_time 2.2714035660000036
Test Epoch2 layer4 Acc 0.8704, AUC 0.9407602548599243, avg_entr 0.0566718690097332, f1 0.8704000115394592
ep2_l4_test_time 2.88864431799999
gc 0
Train Epoch3 Acc 0.915075 (36603/40000), AUC 0.9593102931976318
ep3_train_time 79.05359122499999
Test Epoch3 layer0 Acc 0.897, AUC 0.9582619667053223, avg_entr 0.20064575970172882, f1 0.8970000147819519
ep3_l0_test_time 0.5650603149999824
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.884, AUC 0.9458533525466919, avg_entr 0.06346146762371063, f1 0.8840000033378601
ep3_l1_test_time 1.0711237579999988
Test Epoch3 layer2 Acc 0.8852, AUC 0.9475408792495728, avg_entr 0.05328168347477913, f1 0.8852000832557678
ep3_l2_test_time 1.6650009250000153
Test Epoch3 layer3 Acc 0.884, AUC 0.9476462006568909, avg_entr 0.053925927728414536, f1 0.8840000033378601
ep3_l3_test_time 2.2703286220000223
Test Epoch3 layer4 Acc 0.8856, AUC 0.9476668238639832, avg_entr 0.047947127372026443, f1 0.8855999708175659
ep3_l4_test_time 2.9049389879999694
gc 0
Train Epoch4 Acc 0.932825 (37313/40000), AUC 0.975387454032898
ep4_train_time 79.06380921499999
Test Epoch4 layer0 Acc 0.8958, AUC 0.9590374231338501, avg_entr 0.17677177488803864, f1 0.895799994468689
ep4_l0_test_time 0.5576761590000388
Test Epoch4 layer1 Acc 0.8868, AUC 0.951374351978302, avg_entr 0.07117322087287903, f1 0.8867999911308289
ep4_l1_test_time 1.0496166220000305
Test Epoch4 layer2 Acc 0.8868, AUC 0.9523798823356628, avg_entr 0.06436536461114883, f1 0.8867999911308289
ep4_l2_test_time 1.6553895460000376
Test Epoch4 layer3 Acc 0.8804, AUC 0.9523286819458008, avg_entr 0.06942182779312134, f1 0.8804000020027161
ep4_l3_test_time 2.263781193
Test Epoch4 layer4 Acc 0.8854, AUC 0.9521385431289673, avg_entr 0.05929979309439659, f1 0.8853999972343445
ep4_l4_test_time 2.8863202439999895
gc 0
Train Epoch5 Acc 0.918125 (36725/40000), AUC 0.9656579494476318
ep5_train_time 79.09056362199999
Test Epoch5 layer0 Acc 0.8764, AUC 0.9587053060531616, avg_entr 0.16265635192394257, f1 0.8763999938964844
ep5_l0_test_time 0.560025286000041
Test Epoch5 layer1 Acc 0.8718, AUC 0.9274671077728271, avg_entr 0.055451273918151855, f1 0.8718000650405884
ep5_l1_test_time 1.048588291000101
Test Epoch5 layer2 Acc 0.874, AUC 0.9324419498443604, avg_entr 0.04289558157324791, f1 0.8740000128746033
ep5_l2_test_time 1.6613047700000152
Test Epoch5 layer3 Acc 0.8728, AUC 0.9318780899047852, avg_entr 0.04794633015990257, f1 0.8727999925613403
ep5_l3_test_time 2.28418715600003
Test Epoch5 layer4 Acc 0.8726, AUC 0.9326236248016357, avg_entr 0.03372327983379364, f1 0.8726000189781189
ep5_l4_test_time 2.909286020999957
gc 0
Train Epoch6 Acc 0.9385 (37540/40000), AUC 0.9794679880142212
ep6_train_time 79.08057575499993
Test Epoch6 layer0 Acc 0.8982, AUC 0.9578084945678711, avg_entr 0.15636120736598969, f1 0.8981999754905701
ep6_l0_test_time 0.5553204999999934
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 6
Test Epoch6 layer1 Acc 0.8872, AUC 0.9435073137283325, avg_entr 0.04997478798031807, f1 0.8871999979019165
ep6_l1_test_time 1.0545738690000235
Test Epoch6 layer2 Acc 0.8882, AUC 0.9466347694396973, avg_entr 0.040895674377679825, f1 0.888200044631958
ep6_l2_test_time 1.654590575000043
Test Epoch6 layer3 Acc 0.8828, AUC 0.9463076591491699, avg_entr 0.04004440829157829, f1 0.8827999830245972
ep6_l3_test_time 2.2650674449999997
Test Epoch6 layer4 Acc 0.8878, AUC 0.9465258717536926, avg_entr 0.03417855128645897, f1 0.8877999782562256
ep6_l4_test_time 2.882925618999934
gc 0
Train Epoch7 Acc 0.950275 (38011/40000), AUC 0.9850032329559326
ep7_train_time 79.01603237500001
Test Epoch7 layer0 Acc 0.8786, AUC 0.955879271030426, avg_entr 0.144439697265625, f1 0.878600001335144
ep7_l0_test_time 0.5586691510000037
Test Epoch7 layer1 Acc 0.8846, AUC 0.9414628744125366, avg_entr 0.04313149303197861, f1 0.8845999836921692
ep7_l1_test_time 1.0630181720000564
Test Epoch7 layer2 Acc 0.887, AUC 0.9452438354492188, avg_entr 0.034934721887111664, f1 0.8870000243186951
ep7_l2_test_time 1.6670909560000382
Test Epoch7 layer3 Acc 0.8844, AUC 0.9446483850479126, avg_entr 0.035845398902893066, f1 0.8844000101089478
ep7_l3_test_time 2.268976651999992
Test Epoch7 layer4 Acc 0.8862, AUC 0.9450138807296753, avg_entr 0.029785986989736557, f1 0.8862000107765198
ep7_l4_test_time 2.8922930090000136
gc 0
Train Epoch8 Acc 0.956525 (38261/40000), AUC 0.9886293411254883
ep8_train_time 78.95582112399995
Test Epoch8 layer0 Acc 0.8872, AUC 0.9545997977256775, avg_entr 0.1373995542526245, f1 0.8871999979019165
ep8_l0_test_time 0.5637717129999373
Test Epoch8 layer1 Acc 0.8828, AUC 0.9380072951316833, avg_entr 0.03401186689734459, f1 0.8827999830245972
ep8_l1_test_time 1.0550140729999384
Test Epoch8 layer2 Acc 0.882, AUC 0.9405839443206787, avg_entr 0.026274634525179863, f1 0.8820000290870667
ep8_l2_test_time 1.6636626909998995
Test Epoch8 layer3 Acc 0.8818, AUC 0.9396243095397949, avg_entr 0.027326183393597603, f1 0.8818000555038452
ep8_l3_test_time 2.269179869000027
Test Epoch8 layer4 Acc 0.8808, AUC 0.9407392144203186, avg_entr 0.024100881069898605, f1 0.8808000087738037
ep8_l4_test_time 2.879342943000097
gc 0
Train Epoch9 Acc 0.96135 (38454/40000), AUC 0.9914723634719849
ep9_train_time 78.93523520399992
Test Epoch9 layer0 Acc 0.8926, AUC 0.9536335468292236, avg_entr 0.13600963354110718, f1 0.8925999999046326
ep9_l0_test_time 0.5567662600000176
Test Epoch9 layer1 Acc 0.8792, AUC 0.94090735912323, avg_entr 0.0420323982834816, f1 0.8791999816894531
ep9_l1_test_time 1.0484297650000372
Test Epoch9 layer2 Acc 0.878, AUC 0.943171501159668, avg_entr 0.030960991978645325, f1 0.878000020980835
ep9_l2_test_time 1.652564591999976
Test Epoch9 layer3 Acc 0.877, AUC 0.9425796270370483, avg_entr 0.030721161514520645, f1 0.8769999742507935
ep9_l3_test_time 2.2607178389999945
Test Epoch9 layer4 Acc 0.8778, AUC 0.9430325031280518, avg_entr 0.027573009952902794, f1 0.8778000473976135
ep9_l4_test_time 2.865261632000056
gc 0
Train Epoch10 Acc 0.9639 (38556/40000), AUC 0.9923487901687622
ep10_train_time 78.91451146199995
Test Epoch10 layer0 Acc 0.886, AUC 0.9525312781333923, avg_entr 0.13132460415363312, f1 0.8859999775886536
ep10_l0_test_time 0.5545247229999859
Test Epoch10 layer1 Acc 0.8782, AUC 0.9392127990722656, avg_entr 0.03703648969531059, f1 0.8781999945640564
ep10_l1_test_time 1.0476747669999895
Test Epoch10 layer2 Acc 0.8774, AUC 0.9425778985023499, avg_entr 0.027902521193027496, f1 0.8773999810218811
ep10_l2_test_time 1.6593365490000451
Test Epoch10 layer3 Acc 0.878, AUC 0.9418395161628723, avg_entr 0.030774466693401337, f1 0.878000020980835
ep10_l3_test_time 2.2725771570000006
Test Epoch10 layer4 Acc 0.8782, AUC 0.9426072835922241, avg_entr 0.02570176310837269, f1 0.8781999945640564
ep10_l4_test_time 2.8945498189999626
gc 0
Train Epoch11 Acc 0.96525 (38610/40000), AUC 0.9929088354110718
ep11_train_time 78.90706619799994
Test Epoch11 layer0 Acc 0.889, AUC 0.9512174725532532, avg_entr 0.13052959740161896, f1 0.8889999985694885
ep11_l0_test_time 0.5545944140001211
Test Epoch11 layer1 Acc 0.8782, AUC 0.9387249946594238, avg_entr 0.03686352074146271, f1 0.8781999945640564
ep11_l1_test_time 1.0470727710001029
Test Epoch11 layer2 Acc 0.8774, AUC 0.9408990144729614, avg_entr 0.02775760181248188, f1 0.8773999810218811
ep11_l2_test_time 1.6518217739999272
Test Epoch11 layer3 Acc 0.8764, AUC 0.9400011301040649, avg_entr 0.027858611196279526, f1 0.8763999938964844
ep11_l3_test_time 2.2552201839998816
Test Epoch11 layer4 Acc 0.8772, AUC 0.9408314228057861, avg_entr 0.02621733769774437, f1 0.8772000074386597
ep11_l4_test_time 2.8669657149998784
gc 0
Train Epoch12 Acc 0.967225 (38689/40000), AUC 0.9937633872032166
ep12_train_time 78.952719721
Test Epoch12 layer0 Acc 0.8858, AUC 0.9503303170204163, avg_entr 0.12628069519996643, f1 0.8858000040054321
ep12_l0_test_time 0.5613691450000715
Test Epoch12 layer1 Acc 0.876, AUC 0.9379074573516846, avg_entr 0.033932264894247055, f1 0.8760000467300415
ep12_l1_test_time 1.0695863850000933
Test Epoch12 layer2 Acc 0.8758, AUC 0.9402472972869873, avg_entr 0.025968478992581367, f1 0.8758000135421753
ep12_l2_test_time 1.6679833580001286
Test Epoch12 layer3 Acc 0.8738, AUC 0.939206600189209, avg_entr 0.026598168537020683, f1 0.8737999796867371
ep12_l3_test_time 2.266015798999888
Test Epoch12 layer4 Acc 0.8748, AUC 0.9402768611907959, avg_entr 0.023830806836485863, f1 0.8748000264167786
ep12_l4_test_time 2.8786664589999873
gc 0
Train Epoch13 Acc 0.969525 (38781/40000), AUC 0.9946320652961731
ep13_train_time 78.98496250000017
Test Epoch13 layer0 Acc 0.8874, AUC 0.9497494697570801, avg_entr 0.12521210312843323, f1 0.8873999714851379
ep13_l0_test_time 0.5565908940000099
Test Epoch13 layer1 Acc 0.8736, AUC 0.9378857612609863, avg_entr 0.03408924862742424, f1 0.8736000061035156
ep13_l1_test_time 1.0595083999999133
Test Epoch13 layer2 Acc 0.8754, AUC 0.9401125311851501, avg_entr 0.024543164297938347, f1 0.8754000067710876
ep13_l2_test_time 1.674683739000102
Test Epoch13 layer3 Acc 0.8746, AUC 0.9389362335205078, avg_entr 0.025189904496073723, f1 0.8745999932289124
ep13_l3_test_time 2.2684769570000753
Test Epoch13 layer4 Acc 0.8754, AUC 0.940131425857544, avg_entr 0.022080985829234123, f1 0.8754000067710876
ep13_l4_test_time 2.8906707459998415
gc 0
Train Epoch14 Acc 0.970625 (38825/40000), AUC 0.9947779178619385
ep14_train_time 79.02759558499997
Test Epoch14 layer0 Acc 0.888, AUC 0.94911789894104, avg_entr 0.12486116588115692, f1 0.8880000114440918
ep14_l0_test_time 0.5558723399999508
Test Epoch14 layer1 Acc 0.8692, AUC 0.935308575630188, avg_entr 0.0311810951679945, f1 0.8691999912261963
ep14_l1_test_time 1.0541107840001587
Test Epoch14 layer2 Acc 0.8702, AUC 0.9382764101028442, avg_entr 0.023607628419995308, f1 0.870199978351593
ep14_l2_test_time 1.661350615999936
Test Epoch14 layer3 Acc 0.8708, AUC 0.9373739957809448, avg_entr 0.025390734896063805, f1 0.8708000183105469
ep14_l3_test_time 2.265602374999844
Test Epoch14 layer4 Acc 0.8706, AUC 0.9385272860527039, avg_entr 0.022252269089221954, f1 0.8705999851226807
ep14_l4_test_time 2.8712917650000236
gc 0
