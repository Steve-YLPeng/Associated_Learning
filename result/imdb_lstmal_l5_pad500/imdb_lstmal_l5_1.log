total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.41331589
Start Training
gc 0
Train Epoch0 Acc 0.505375 (20215/40000), AUC 0.5066211223602295
ep0_train_time 78.641151709
Test Epoch0 layer0 Acc 0.7848, AUC 0.8848567008972168, avg_entr 0.5718217492103577, f1 0.7847999930381775
ep0_l0_test_time 0.543970281
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5928, AUC 0.6383657455444336, avg_entr 0.6718712449073792, f1 0.5928000211715698
ep0_l1_test_time 1.0411259039999976
Test Epoch0 layer2 Acc 0.6136, AUC 0.6583306193351746, avg_entr 0.6827779412269592, f1 0.6136000156402588
ep0_l2_test_time 1.6505131490000053
Test Epoch0 layer3 Acc 0.6088, AUC 0.6697041988372803, avg_entr 0.6880394816398621, f1 0.6087999939918518
ep0_l3_test_time 2.2645253430000025
Test Epoch0 layer4 Acc 0.5002, AUC 0.6641380786895752, avg_entr 0.6891696453094482, f1 0.5001999735832214
ep0_l4_test_time 2.8893632639999964
gc 0
Train Epoch1 Acc 0.794425 (31777/40000), AUC 0.8548870086669922
ep1_train_time 78.90738821400001
Test Epoch1 layer0 Acc 0.8784, AUC 0.9456444978713989, avg_entr 0.29376229643821716, f1 0.8784000277519226
ep1_l0_test_time 0.5418511409999951
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8362, AUC 0.9013514518737793, avg_entr 0.13285531103610992, f1 0.8361999988555908
ep1_l1_test_time 1.0388370720000069
Test Epoch1 layer2 Acc 0.8418, AUC 0.9058603048324585, avg_entr 0.11745843291282654, f1 0.8418000340461731
ep1_l2_test_time 1.6416394409999953
Test Epoch1 layer3 Acc 0.8372, AUC 0.9083782434463501, avg_entr 0.1181766614317894, f1 0.8371999859809875
ep1_l3_test_time 2.2386288110000123
Test Epoch1 layer4 Acc 0.8348, AUC 0.9069713354110718, avg_entr 0.14106298983097076, f1 0.8348000049591064
ep1_l4_test_time 2.845218783000007
gc 0
Train Epoch2 Acc 0.8869 (35476/40000), AUC 0.9386147260665894
ep2_train_time 78.99381251299997
Test Epoch2 layer0 Acc 0.8942, AUC 0.955755352973938, avg_entr 0.22997407615184784, f1 0.8942000269889832
ep2_l0_test_time 0.5427829489999567
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8734, AUC 0.9382584095001221, avg_entr 0.07669564336538315, f1 0.8733999729156494
ep2_l1_test_time 1.044342935999964
Test Epoch2 layer2 Acc 0.876, AUC 0.9405644536018372, avg_entr 0.0599999874830246, f1 0.8760000467300415
ep2_l2_test_time 1.6537202709999974
Test Epoch2 layer3 Acc 0.874, AUC 0.9414336681365967, avg_entr 0.05775636434555054, f1 0.8740000128746033
ep2_l3_test_time 2.250643640000021
Test Epoch2 layer4 Acc 0.8744, AUC 0.940514087677002, avg_entr 0.05530385673046112, f1 0.8744000792503357
ep2_l4_test_time 2.8655646760000195
gc 0
Train Epoch3 Acc 0.91635 (36654/40000), AUC 0.9638564586639404
ep3_train_time 78.93793320499998
Test Epoch3 layer0 Acc 0.8986, AUC 0.9588491916656494, avg_entr 0.1968887746334076, f1 0.8985999822616577
ep3_l0_test_time 0.5539116740000054
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8852, AUC 0.9440354108810425, avg_entr 0.046934355050325394, f1 0.8852000832557678
ep3_l1_test_time 1.035436599000036
Test Epoch3 layer2 Acc 0.8836, AUC 0.945344090461731, avg_entr 0.04608863592147827, f1 0.8835999965667725
ep3_l2_test_time 1.6546306170000094
Test Epoch3 layer3 Acc 0.8852, AUC 0.9465024471282959, avg_entr 0.0453827865421772, f1 0.8852000832557678
ep3_l3_test_time 2.2568133949999947
Test Epoch3 layer4 Acc 0.8836, AUC 0.9458683729171753, avg_entr 0.05275055393576622, f1 0.8835999965667725
ep3_l4_test_time 2.8728648439999915
gc 0
Train Epoch4 Acc 0.9297 (37188/40000), AUC 0.9727041721343994
ep4_train_time 78.926479712
Test Epoch4 layer0 Acc 0.8908, AUC 0.9585076570510864, avg_entr 0.1746189147233963, f1 0.8907999992370605
ep4_l0_test_time 0.5446561599999882
Test Epoch4 layer1 Acc 0.8948, AUC 0.9531331062316895, avg_entr 0.05390505492687225, f1 0.8948000073432922
ep4_l1_test_time 1.0376700020000271
Test Epoch4 layer2 Acc 0.8964, AUC 0.9542862176895142, avg_entr 0.04320298135280609, f1 0.896399974822998
ep4_l2_test_time 1.6552097640000056
Test Epoch4 layer3 Acc 0.8932, AUC 0.9546325206756592, avg_entr 0.04079388454556465, f1 0.8931999802589417
ep4_l3_test_time 2.241271331000007
Test Epoch4 layer4 Acc 0.8956, AUC 0.953628659248352, avg_entr 0.040117282420396805, f1 0.8956000208854675
ep4_l4_test_time 2.8492981829999735
gc 0
Train Epoch5 Acc 0.9426 (37704/40000), AUC 0.9812827110290527
ep5_train_time 78.87784642999998
Test Epoch5 layer0 Acc 0.8972, AUC 0.9587552547454834, avg_entr 0.1620372235774994, f1 0.8971999883651733
ep5_l0_test_time 0.5465731040000037
Test Epoch5 layer1 Acc 0.8914, AUC 0.9510751962661743, avg_entr 0.04915637895464897, f1 0.8913999795913696
ep5_l1_test_time 1.0368802300000652
Test Epoch5 layer2 Acc 0.892, AUC 0.9523905515670776, avg_entr 0.040431130677461624, f1 0.8920000195503235
ep5_l2_test_time 1.657326330999922
Test Epoch5 layer3 Acc 0.8908, AUC 0.953011155128479, avg_entr 0.037840574979782104, f1 0.8907999992370605
ep5_l3_test_time 2.2699154260000114
Test Epoch5 layer4 Acc 0.8928, AUC 0.9517489671707153, avg_entr 0.037915244698524475, f1 0.892799973487854
ep5_l4_test_time 2.887823780999952
gc 0
Train Epoch6 Acc 0.949775 (37991/40000), AUC 0.9855212569236755
ep6_train_time 79.02500726999995
Test Epoch6 layer0 Acc 0.8972, AUC 0.95779949426651, avg_entr 0.1517673283815384, f1 0.8971999883651733
ep6_l0_test_time 0.5433477270000822
Test Epoch6 layer1 Acc 0.8892, AUC 0.9496098756790161, avg_entr 0.04459312558174133, f1 0.88919997215271
ep6_l1_test_time 1.0363548210000317
Test Epoch6 layer2 Acc 0.8888, AUC 0.950798511505127, avg_entr 0.0381937138736248, f1 0.8888000249862671
ep6_l2_test_time 1.6400928139998996
Test Epoch6 layer3 Acc 0.8894, AUC 0.9514093399047852, avg_entr 0.03732050955295563, f1 0.8894000053405762
ep6_l3_test_time 2.239272368999991
Test Epoch6 layer4 Acc 0.8884, AUC 0.950084388256073, avg_entr 0.03737402334809303, f1 0.8884000182151794
ep6_l4_test_time 2.8437460990001
gc 0
Train Epoch7 Acc 0.953125 (38125/40000), AUC 0.9866846799850464
ep7_train_time 78.86348434999991
Test Epoch7 layer0 Acc 0.8938, AUC 0.9562029838562012, avg_entr 0.1483372002840042, f1 0.8938000202178955
ep7_l0_test_time 0.5482251789999282
Test Epoch7 layer1 Acc 0.8798, AUC 0.9457435607910156, avg_entr 0.043868787586688995, f1 0.879800021648407
ep7_l1_test_time 1.0418297599999278
Test Epoch7 layer2 Acc 0.8804, AUC 0.9463530778884888, avg_entr 0.03671112656593323, f1 0.8804000020027161
ep7_l2_test_time 1.6491975019999927
Test Epoch7 layer3 Acc 0.8798, AUC 0.9470383524894714, avg_entr 0.03484870865941048, f1 0.879800021648407
ep7_l3_test_time 2.248640317999957
Test Epoch7 layer4 Acc 0.8792, AUC 0.9458518624305725, avg_entr 0.03528707101941109, f1 0.8791999816894531
ep7_l4_test_time 2.8601425570000174
gc 0
Train Epoch8 Acc 0.961425 (38457/40000), AUC 0.9905425310134888
ep8_train_time 78.90578324900002
Test Epoch8 layer0 Acc 0.8966, AUC 0.9551033973693848, avg_entr 0.14243628084659576, f1 0.8966000080108643
ep8_l0_test_time 0.5438723219999702
Test Epoch8 layer1 Acc 0.8806, AUC 0.944983720779419, avg_entr 0.04026249051094055, f1 0.8805999755859375
ep8_l1_test_time 1.0354757769999878
Test Epoch8 layer2 Acc 0.8814, AUC 0.9457954168319702, avg_entr 0.033211272209882736, f1 0.8813999891281128
ep8_l2_test_time 1.646215720999976
Test Epoch8 layer3 Acc 0.8806, AUC 0.9467743635177612, avg_entr 0.032912034541368484, f1 0.8805999755859375
ep8_l3_test_time 2.254029573999901
Test Epoch8 layer4 Acc 0.881, AUC 0.9449480175971985, avg_entr 0.03360779583454132, f1 0.8809999823570251
ep8_l4_test_time 2.8695432760000585
gc 0
Train Epoch9 Acc 0.9637 (38548/40000), AUC 0.9922731518745422
ep9_train_time 78.92942797299997
Test Epoch9 layer0 Acc 0.8894, AUC 0.9541079998016357, avg_entr 0.13635268807411194, f1 0.8894000053405762
ep9_l0_test_time 0.5419811279999749
Test Epoch9 layer1 Acc 0.8798, AUC 0.9436705112457275, avg_entr 0.039141666144132614, f1 0.879800021648407
ep9_l1_test_time 1.0328002050000578
Test Epoch9 layer2 Acc 0.8792, AUC 0.9443445801734924, avg_entr 0.03234042972326279, f1 0.8791999816894531
ep9_l2_test_time 1.6404526840000244
Test Epoch9 layer3 Acc 0.8796, AUC 0.9451931715011597, avg_entr 0.030068106949329376, f1 0.8795999884605408
ep9_l3_test_time 2.2474511630000507
Test Epoch9 layer4 Acc 0.8804, AUC 0.9439249038696289, avg_entr 0.03021688014268875, f1 0.8804000020027161
ep9_l4_test_time 2.8486768840000423
gc 0
Train Epoch10 Acc 0.965925 (38637/40000), AUC 0.9930294752120972
ep10_train_time 78.95461447600007
Test Epoch10 layer0 Acc 0.889, AUC 0.9531855583190918, avg_entr 0.13346333801746368, f1 0.8889999985694885
ep10_l0_test_time 0.555647590000035
Test Epoch10 layer1 Acc 0.8798, AUC 0.9414132237434387, avg_entr 0.03028733842074871, f1 0.879800021648407
ep10_l1_test_time 1.038691760000006
Test Epoch10 layer2 Acc 0.8796, AUC 0.9423185586929321, avg_entr 0.024477658793330193, f1 0.8795999884605408
ep10_l2_test_time 1.6591085469999598
Test Epoch10 layer3 Acc 0.8796, AUC 0.943291425704956, avg_entr 0.02294093184173107, f1 0.8795999884605408
ep10_l3_test_time 2.265498647000072
Test Epoch10 layer4 Acc 0.8794, AUC 0.9419735074043274, avg_entr 0.023514075204730034, f1 0.8794000148773193
ep10_l4_test_time 2.8833666059999814
gc 0
Train Epoch11 Acc 0.96685 (38674/40000), AUC 0.9933204650878906
ep11_train_time 78.93307199200001
Test Epoch11 layer0 Acc 0.888, AUC 0.9518859386444092, avg_entr 0.129851832985878, f1 0.8880000114440918
ep11_l0_test_time 0.54487182999992
Test Epoch11 layer1 Acc 0.8774, AUC 0.943108081817627, avg_entr 0.03398070111870766, f1 0.8773999810218811
ep11_l1_test_time 1.0379001379999409
Test Epoch11 layer2 Acc 0.8772, AUC 0.9435839653015137, avg_entr 0.0273617971688509, f1 0.8772000074386597
ep11_l2_test_time 1.641655898999943
Test Epoch11 layer3 Acc 0.8768, AUC 0.9446269273757935, avg_entr 0.026534484699368477, f1 0.876800000667572
ep11_l3_test_time 2.241026536000163
Test Epoch11 layer4 Acc 0.8774, AUC 0.9431893825531006, avg_entr 0.0275130495429039, f1 0.8773999810218811
ep11_l4_test_time 2.8459337540000433
gc 0
Train Epoch12 Acc 0.96765 (38706/40000), AUC 0.9934656620025635
ep12_train_time 78.89362173399991
Test Epoch12 layer0 Acc 0.8888, AUC 0.9516034126281738, avg_entr 0.1292562484741211, f1 0.8888000249862671
ep12_l0_test_time 0.5437963819999823
Test Epoch12 layer1 Acc 0.876, AUC 0.9417109489440918, avg_entr 0.033021990209817886, f1 0.8760000467300415
ep12_l1_test_time 1.036292696000146
Test Epoch12 layer2 Acc 0.8764, AUC 0.9421771764755249, avg_entr 0.026703277602791786, f1 0.8763999938964844
ep12_l2_test_time 1.6585616840000057
Test Epoch12 layer3 Acc 0.8768, AUC 0.9434988498687744, avg_entr 0.025864312425255775, f1 0.876800000667572
ep12_l3_test_time 2.251272276999998
Test Epoch12 layer4 Acc 0.8768, AUC 0.9418177604675293, avg_entr 0.02628757618367672, f1 0.876800000667572
ep12_l4_test_time 2.8568265179999344
gc 0
Train Epoch13 Acc 0.9701 (38804/40000), AUC 0.9945290088653564
ep13_train_time 78.91152894900006
Test Epoch13 layer0 Acc 0.8866, AUC 0.9508863091468811, avg_entr 0.13009706139564514, f1 0.8866000771522522
ep13_l0_test_time 0.5696754789998977
Test Epoch13 layer1 Acc 0.8746, AUC 0.9412223100662231, avg_entr 0.03425050154328346, f1 0.8745999932289124
ep13_l1_test_time 1.03610673199978
Test Epoch13 layer2 Acc 0.874, AUC 0.9417290687561035, avg_entr 0.027781106531620026, f1 0.8740000128746033
ep13_l2_test_time 1.6540117369997915
Test Epoch13 layer3 Acc 0.8736, AUC 0.9428579807281494, avg_entr 0.027235308662056923, f1 0.8736000061035156
ep13_l3_test_time 2.2533066299999973
Test Epoch13 layer4 Acc 0.8742, AUC 0.9412741661071777, avg_entr 0.027893438935279846, f1 0.8741999864578247
ep13_l4_test_time 2.870037006000075
gc 0
Train Epoch14 Acc 0.971275 (38851/40000), AUC 0.9949098825454712
ep14_train_time 78.85865514600005
Test Epoch14 layer0 Acc 0.8878, AUC 0.9503331184387207, avg_entr 0.12577003240585327, f1 0.8877999782562256
ep14_l0_test_time 0.5420856349999212
Test Epoch14 layer1 Acc 0.8762, AUC 0.9379764795303345, avg_entr 0.028064465150237083, f1 0.8762000203132629
ep14_l1_test_time 1.0363614520001647
Test Epoch14 layer2 Acc 0.8768, AUC 0.9388134479522705, avg_entr 0.022919919341802597, f1 0.876800000667572
ep14_l2_test_time 1.645955635000064
Test Epoch14 layer3 Acc 0.8754, AUC 0.9401840567588806, avg_entr 0.022084670141339302, f1 0.8754000067710876
ep14_l3_test_time 2.246645811999997
Test Epoch14 layer4 Acc 0.8752, AUC 0.9382696151733398, avg_entr 0.02249608002603054, f1 0.8751999735832214
ep14_l4_test_time 2.846454359000063
gc 0
Train Epoch15 Acc 0.971575 (38863/40000), AUC 0.994998574256897
ep15_train_time 78.87078867200012
Test Epoch15 layer0 Acc 0.8854, AUC 0.9497135281562805, avg_entr 0.12599946558475494, f1 0.8853999972343445
ep15_l0_test_time 0.5550147339999967
Test Epoch15 layer1 Acc 0.8764, AUC 0.9388117790222168, avg_entr 0.030100565403699875, f1 0.8763999938964844
ep15_l1_test_time 1.0449610970001686
Test Epoch15 layer2 Acc 0.8766, AUC 0.9392428398132324, avg_entr 0.024052660912275314, f1 0.8766000270843506
ep15_l2_test_time 1.6582734980001987
Test Epoch15 layer3 Acc 0.8758, AUC 0.9405168294906616, avg_entr 0.023127345368266106, f1 0.8758000135421753
ep15_l3_test_time 2.2684897980000187
Test Epoch15 layer4 Acc 0.8762, AUC 0.9391219615936279, avg_entr 0.023553382605314255, f1 0.8762000203132629
ep15_l4_test_time 2.886634535999974
gc 0
Train Epoch16 Acc 0.97285 (38914/40000), AUC 0.9954656362533569
ep16_train_time 78.90840491199992
Test Epoch16 layer0 Acc 0.885, AUC 0.9493516683578491, avg_entr 0.12303664535284042, f1 0.8849999904632568
ep16_l0_test_time 0.5526201490001768
Test Epoch16 layer1 Acc 0.8748, AUC 0.9381362199783325, avg_entr 0.02842630073428154, f1 0.8748000264167786
ep16_l1_test_time 1.0508436840000286
Test Epoch16 layer2 Acc 0.8744, AUC 0.9386706352233887, avg_entr 0.02192767523229122, f1 0.8744000792503357
ep16_l2_test_time 1.6519955860001119
Test Epoch16 layer3 Acc 0.8742, AUC 0.9398175477981567, avg_entr 0.02099379152059555, f1 0.8741999864578247
ep16_l3_test_time 2.246593972000028
Test Epoch16 layer4 Acc 0.8738, AUC 0.9384821653366089, avg_entr 0.021549131721258163, f1 0.8737999796867371
ep16_l4_test_time 2.8434216850000666
gc 0
Train Epoch17 Acc 0.973275 (38931/40000), AUC 0.9955660104751587
ep17_train_time 78.86345464500005
Test Epoch17 layer0 Acc 0.886, AUC 0.949097752571106, avg_entr 0.12296354025602341, f1 0.8859999775886536
ep17_l0_test_time 0.5493310260001181
Test Epoch17 layer1 Acc 0.8738, AUC 0.9383505582809448, avg_entr 0.028925711289048195, f1 0.8737999796867371
ep17_l1_test_time 1.037805642999956
Test Epoch17 layer2 Acc 0.8732, AUC 0.9388936758041382, avg_entr 0.023177292197942734, f1 0.873199999332428
ep17_l2_test_time 1.6598681919999763
Test Epoch17 layer3 Acc 0.8738, AUC 0.9400923252105713, avg_entr 0.022210514172911644, f1 0.8737999796867371
ep17_l3_test_time 2.2493652089999614
Test Epoch17 layer4 Acc 0.8738, AUC 0.9386855363845825, avg_entr 0.022843316197395325, f1 0.8737999796867371
ep17_l4_test_time 2.860632825000039
gc 0
Train Epoch18 Acc 0.9738 (38952/40000), AUC 0.995780348777771
ep18_train_time 78.97814102400002
Test Epoch18 layer0 Acc 0.8862, AUC 0.9487624168395996, avg_entr 0.12171880900859833, f1 0.8862000107765198
ep18_l0_test_time 0.5465335720000439
Test Epoch18 layer1 Acc 0.8736, AUC 0.9378553032875061, avg_entr 0.027753012254834175, f1 0.8736000061035156
ep18_l1_test_time 1.0365333449999525
Test Epoch18 layer2 Acc 0.8728, AUC 0.9384424090385437, avg_entr 0.02195301465690136, f1 0.8727999925613403
ep18_l2_test_time 1.6562529249999898
Test Epoch18 layer3 Acc 0.8734, AUC 0.9396184682846069, avg_entr 0.020983649417757988, f1 0.8733999729156494
ep18_l3_test_time 2.2628333169998314
Test Epoch18 layer4 Acc 0.8736, AUC 0.9380902051925659, avg_entr 0.021749863401055336, f1 0.8736000061035156
ep18_l4_test_time 2.8726537999998527
gc 0
Train Epoch19 Acc 0.974175 (38967/40000), AUC 0.9959273934364319
ep19_train_time 78.99158980200014
Test Epoch19 layer0 Acc 0.885, AUC 0.9484580755233765, avg_entr 0.1205778568983078, f1 0.8849999904632568
ep19_l0_test_time 0.5445973580001464
Test Epoch19 layer1 Acc 0.874, AUC 0.9376370906829834, avg_entr 0.027633285149931908, f1 0.8740000128746033
ep19_l1_test_time 1.0409648940001262
Test Epoch19 layer2 Acc 0.8732, AUC 0.9382210373878479, avg_entr 0.02217140421271324, f1 0.873199999332428
ep19_l2_test_time 1.6531710740000563
Test Epoch19 layer3 Acc 0.8728, AUC 0.939420223236084, avg_entr 0.021347051486372948, f1 0.8727999925613403
ep19_l3_test_time 2.2446446540000125
Test Epoch19 layer4 Acc 0.873, AUC 0.9381413459777832, avg_entr 0.022205855697393417, f1 0.8730000257492065
ep19_l4_test_time 2.84525868500009
gc 0
Train Epoch20 Acc 0.974675 (38987/40000), AUC 0.9959205389022827
ep20_train_time 78.86214538499985
Test Epoch20 layer0 Acc 0.8848, AUC 0.9483478665351868, avg_entr 0.12035580724477768, f1 0.8848000168800354
ep20_l0_test_time 0.5442020720001892
Test Epoch20 layer1 Acc 0.874, AUC 0.9372826814651489, avg_entr 0.02709301747381687, f1 0.8740000128746033
ep20_l1_test_time 1.0388006470000164
Test Epoch20 layer2 Acc 0.8746, AUC 0.9378662705421448, avg_entr 0.021611513569951057, f1 0.8745999932289124
ep20_l2_test_time 1.6569162580001375
Test Epoch20 layer3 Acc 0.8732, AUC 0.9390050172805786, avg_entr 0.020680639892816544, f1 0.873199999332428
ep20_l3_test_time 2.2660337419999905
Test Epoch20 layer4 Acc 0.8748, AUC 0.9377776384353638, avg_entr 0.021534722298383713, f1 0.8748000264167786
ep20_l4_test_time 2.885065686999951
gc 0
Train Epoch21 Acc 0.975025 (39001/40000), AUC 0.9961645603179932
ep21_train_time 78.91429261799999
Test Epoch21 layer0 Acc 0.8852, AUC 0.9482221603393555, avg_entr 0.11985422670841217, f1 0.8852000832557678
ep21_l0_test_time 0.5421876130001237
Test Epoch21 layer1 Acc 0.8712, AUC 0.936857283115387, avg_entr 0.027219360694289207, f1 0.8712000846862793
ep21_l1_test_time 1.0392269590001888
Test Epoch21 layer2 Acc 0.8708, AUC 0.9375168085098267, avg_entr 0.021367251873016357, f1 0.8708000183105469
ep21_l2_test_time 1.6477278419999948
Test Epoch21 layer3 Acc 0.8712, AUC 0.9388142824172974, avg_entr 0.02051631547510624, f1 0.8712000846862793
ep21_l3_test_time 2.2493299049999678
Test Epoch21 layer4 Acc 0.8706, AUC 0.9372197985649109, avg_entr 0.021317258477211, f1 0.8705999851226807
ep21_l4_test_time 2.84635521600012
gc 0
Train Epoch22 Acc 0.975325 (39013/40000), AUC 0.9962300658226013
ep22_train_time 78.93495792299996
Test Epoch22 layer0 Acc 0.8832, AUC 0.9480728507041931, avg_entr 0.11866258829832077, f1 0.8831999897956848
ep22_l0_test_time 0.5430514170000151
Test Epoch22 layer1 Acc 0.8722, AUC 0.9363784193992615, avg_entr 0.02480178140103817, f1 0.872200071811676
ep22_l1_test_time 1.0416554860000815
Test Epoch22 layer2 Acc 0.8728, AUC 0.9369661808013916, avg_entr 0.01916288211941719, f1 0.8727999925613403
ep22_l2_test_time 1.6528229329999249
Test Epoch22 layer3 Acc 0.8722, AUC 0.9382410049438477, avg_entr 0.0182547178119421, f1 0.872200071811676
ep22_l3_test_time 2.2505693960001736
Test Epoch22 layer4 Acc 0.8732, AUC 0.9367614984512329, avg_entr 0.01907803677022457, f1 0.873199999332428
ep22_l4_test_time 2.85661819500001
gc 0
Train Epoch23 Acc 0.97515 (39006/40000), AUC 0.9962224960327148
ep23_train_time 78.9127623710001
Test Epoch23 layer0 Acc 0.8844, AUC 0.9479381442070007, avg_entr 0.11847459524869919, f1 0.8844000101089478
ep23_l0_test_time 0.5450881689998823
Test Epoch23 layer1 Acc 0.873, AUC 0.9356273412704468, avg_entr 0.0241992250084877, f1 0.8730000257492065
ep23_l1_test_time 1.0391992499999105
Test Epoch23 layer2 Acc 0.8726, AUC 0.9363254308700562, avg_entr 0.01888049952685833, f1 0.8726000189781189
ep23_l2_test_time 1.6532279859998198
Test Epoch23 layer3 Acc 0.8716, AUC 0.9376959800720215, avg_entr 0.01813720352947712, f1 0.8715999722480774
ep23_l3_test_time 2.2556828860001588
Test Epoch23 layer4 Acc 0.8722, AUC 0.9360570907592773, avg_entr 0.018646948039531708, f1 0.872200071811676
ep23_l4_test_time 2.8689025979997496
gc 0
Train Epoch24 Acc 0.975575 (39023/40000), AUC 0.9961905479431152
ep24_train_time 78.86583836399996
Test Epoch24 layer0 Acc 0.884, AUC 0.9477984309196472, avg_entr 0.11736022680997849, f1 0.8840000033378601
ep24_l0_test_time 0.5521062709999569
Test Epoch24 layer1 Acc 0.8736, AUC 0.9359138011932373, avg_entr 0.024581272155046463, f1 0.8736000061035156
ep24_l1_test_time 1.0329238869999244
Test Epoch24 layer2 Acc 0.872, AUC 0.9365232586860657, avg_entr 0.01900600455701351, f1 0.871999979019165
ep24_l2_test_time 1.6406773720000274
Test Epoch24 layer3 Acc 0.8722, AUC 0.9378440380096436, avg_entr 0.018206195905804634, f1 0.872200071811676
ep24_l3_test_time 2.2416860940002152
Test Epoch24 layer4 Acc 0.8722, AUC 0.9363447427749634, avg_entr 0.018782509490847588, f1 0.872200071811676
ep24_l4_test_time 2.848909952000213
gc 0
Train Epoch25 Acc 0.975875 (39035/40000), AUC 0.996300995349884
ep25_train_time 78.8981496299998
Test Epoch25 layer0 Acc 0.8846, AUC 0.947787344455719, avg_entr 0.11768335103988647, f1 0.8845999836921692
ep25_l0_test_time 0.5483369109997511
Test Epoch25 layer1 Acc 0.8714, AUC 0.9367704391479492, avg_entr 0.027956033125519753, f1 0.871399998664856
ep25_l1_test_time 1.0344107089999852
Test Epoch25 layer2 Acc 0.87, AUC 0.9372280836105347, avg_entr 0.021932309493422508, f1 0.8700000047683716
ep25_l2_test_time 1.650201638999988
Test Epoch25 layer3 Acc 0.8706, AUC 0.9385076761245728, avg_entr 0.021068191155791283, f1 0.8705999851226807
ep25_l3_test_time 2.262332891999904
Test Epoch25 layer4 Acc 0.8692, AUC 0.9370259046554565, avg_entr 0.021711250767111778, f1 0.8691999912261963
ep25_l4_test_time 2.8848227050002606
gc 0
Train Epoch26 Acc 0.975875 (39035/40000), AUC 0.9963564872741699
ep26_train_time 78.9655707009997
Test Epoch26 layer0 Acc 0.883, AUC 0.947709321975708, avg_entr 0.1165657564997673, f1 0.8830000162124634
ep26_l0_test_time 0.5402659440001116
Test Epoch26 layer1 Acc 0.872, AUC 0.9361752867698669, avg_entr 0.025874212384223938, f1 0.871999979019165
ep26_l1_test_time 1.0342386420002185
Test Epoch26 layer2 Acc 0.8718, AUC 0.936784029006958, avg_entr 0.020200936123728752, f1 0.8718000650405884
ep26_l2_test_time 1.6374892799999543
Test Epoch26 layer3 Acc 0.8712, AUC 0.9381018280982971, avg_entr 0.019271787256002426, f1 0.8712000846862793
ep26_l3_test_time 2.2392286029999013
Test Epoch26 layer4 Acc 0.8714, AUC 0.9365531206130981, avg_entr 0.019920891150832176, f1 0.871399998664856
ep26_l4_test_time 2.8422750189997714
gc 0
Train Epoch27 Acc 0.975775 (39031/40000), AUC 0.99637371301651
ep27_train_time 78.99485073400001
Test Epoch27 layer0 Acc 0.8828, AUC 0.9476486444473267, avg_entr 0.11603735387325287, f1 0.8827999830245972
ep27_l0_test_time 0.5568004329998075
Test Epoch27 layer1 Acc 0.872, AUC 0.9362664222717285, avg_entr 0.026070715859532356, f1 0.871999979019165
ep27_l1_test_time 1.0439893840002696
Test Epoch27 layer2 Acc 0.8716, AUC 0.9368444681167603, avg_entr 0.020271355286240578, f1 0.8715999722480774
ep27_l2_test_time 1.6452067959999113
Test Epoch27 layer3 Acc 0.871, AUC 0.9381167888641357, avg_entr 0.019202038645744324, f1 0.8709999918937683
ep27_l3_test_time 2.2490737909997733
Test Epoch27 layer4 Acc 0.8722, AUC 0.9366213083267212, avg_entr 0.019996553659439087, f1 0.872200071811676
ep27_l4_test_time 2.8626561450000736
gc 0
Train Epoch28 Acc 0.9761 (39044/40000), AUC 0.9964531660079956
ep28_train_time 79.13020951099998
Test Epoch28 layer0 Acc 0.883, AUC 0.9476072788238525, avg_entr 0.11570258438587189, f1 0.8830000162124634
ep28_l0_test_time 0.541889667000305
Test Epoch28 layer1 Acc 0.8702, AUC 0.9360668659210205, avg_entr 0.025855282321572304, f1 0.870199978351593
ep28_l1_test_time 1.0354491900002358
Test Epoch28 layer2 Acc 0.87, AUC 0.9366416931152344, avg_entr 0.019937515258789062, f1 0.8700000047683716
ep28_l2_test_time 1.645569221000187
Test Epoch28 layer3 Acc 0.8694, AUC 0.9380357265472412, avg_entr 0.018949970602989197, f1 0.8694000244140625
ep28_l3_test_time 2.252057634999801
Test Epoch28 layer4 Acc 0.8702, AUC 0.9364651441574097, avg_entr 0.01969669945538044, f1 0.870199978351593
ep28_l4_test_time 2.86700040300002
gc 0
Train Epoch29 Acc 0.975925 (39037/40000), AUC 0.9964476227760315
ep29_train_time 78.94807801999968
Test Epoch29 layer0 Acc 0.8834, AUC 0.9475993514060974, avg_entr 0.11570639908313751, f1 0.8834000825881958
ep29_l0_test_time 0.5449769279998691
Test Epoch29 layer1 Acc 0.8718, AUC 0.9361265897750854, avg_entr 0.025861559435725212, f1 0.8718000650405884
ep29_l1_test_time 1.0372466549997625
Test Epoch29 layer2 Acc 0.871, AUC 0.9367198944091797, avg_entr 0.020071636885404587, f1 0.8709999918937683
ep29_l2_test_time 1.6404341549996388
Test Epoch29 layer3 Acc 0.8702, AUC 0.9379967451095581, avg_entr 0.019095808267593384, f1 0.870199978351593
ep29_l3_test_time 2.239252118999957
Test Epoch29 layer4 Acc 0.8712, AUC 0.9365379810333252, avg_entr 0.019887344911694527, f1 0.8712000846862793
ep29_l4_test_time 2.845292458000131
Best AUC tensor(0.8986) 3 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 2619.5893746350002
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8938, AUC 0.9558327794075012, avg_entr 0.19644899666309357, f1 0.8938000202178955
l0_test_time 0.5547505950003142
Test layer1 Acc 0.878, AUC 0.9427960515022278, avg_entr 0.04875734820961952, f1 0.878000020980835
l1_test_time 1.0493628290000743
Test layer2 Acc 0.8778, AUC 0.9426189064979553, avg_entr 0.04780447483062744, f1 0.8778000473976135
l2_test_time 1.6414928249996592
Test layer3 Acc 0.8782, AUC 0.9437611103057861, avg_entr 0.047455254942178726, f1 0.8781999945640564
l3_test_time 2.259422695000012
Test layer4 Acc 0.8762, AUC 0.944607138633728, avg_entr 0.0547054260969162, f1 0.8762000203132629
l4_test_time 2.853300233000027
