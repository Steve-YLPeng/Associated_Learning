total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.346004135999998
Start Training
gc 0
Train Epoch0 Acc 0.50395 (20158/40000), AUC 0.5240376591682434
ep0_train_time 78.61653332
Test Epoch0 layer0 Acc 0.7564, AUC 0.8841594457626343, avg_entr 0.5857381820678711, f1 0.7563999891281128
ep0_l0_test_time 0.5464706949999965
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5856, AUC 0.656394362449646, avg_entr 0.6493280529975891, f1 0.5856000185012817
ep0_l1_test_time 1.034476130999991
Test Epoch0 layer2 Acc 0.5946, AUC 0.6762940883636475, avg_entr 0.661549985408783, f1 0.5946000218391418
ep0_l2_test_time 1.6503549020000037
Test Epoch0 layer3 Acc 0.6298, AUC 0.6927717924118042, avg_entr 0.6771650314331055, f1 0.629800021648407
ep0_l3_test_time 2.2662421450000068
Test Epoch0 layer4 Acc 0.6108, AUC 0.7068051099777222, avg_entr 0.6920608282089233, f1 0.61080002784729
ep0_l4_test_time 2.894991871000002
gc 0
Train Epoch1 Acc 0.778775 (31151/40000), AUC 0.8483179807662964
ep1_train_time 78.978835736
Test Epoch1 layer0 Acc 0.8738, AUC 0.9443032741546631, avg_entr 0.29315245151519775, f1 0.8737999796867371
ep1_l0_test_time 0.548337704000005
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.7254, AUC 0.8013609051704407, avg_entr 0.4076869487762451, f1 0.7253999710083008
ep1_l1_test_time 1.0416364059999808
Test Epoch1 layer2 Acc 0.7932, AUC 0.8813582062721252, avg_entr 0.09165000170469284, f1 0.7932000160217285
ep1_l2_test_time 1.6472339400000067
Test Epoch1 layer3 Acc 0.7972, AUC 0.8830620050430298, avg_entr 0.10469846427440643, f1 0.7971999645233154
ep1_l3_test_time 2.245925203000013
Test Epoch1 layer4 Acc 0.7946, AUC 0.8844884634017944, avg_entr 0.1288757026195526, f1 0.7946000695228577
ep1_l4_test_time 2.8514292989999888
gc 0
Train Epoch2 Acc 0.879 (35160/40000), AUC 0.9298665523529053
ep2_train_time 79.07176616999999
Test Epoch2 layer0 Acc 0.8902, AUC 0.9545068144798279, avg_entr 0.2288924753665924, f1 0.8902000188827515
ep2_l0_test_time 0.5435075999999981
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8792, AUC 0.9341917037963867, avg_entr 0.07959122955799103, f1 0.8791999816894531
ep2_l1_test_time 1.0436522660000378
Test Epoch2 layer2 Acc 0.8796, AUC 0.9349966049194336, avg_entr 0.0537358820438385, f1 0.8795999884605408
ep2_l2_test_time 1.6571106869999994
Test Epoch2 layer3 Acc 0.88, AUC 0.9352250099182129, avg_entr 0.0578707754611969, f1 0.8799999952316284
ep2_l3_test_time 2.259428770999989
Test Epoch2 layer4 Acc 0.8784, AUC 0.9354420900344849, avg_entr 0.05391823872923851, f1 0.8784000277519226
ep2_l4_test_time 2.862487876999978
gc 0
Train Epoch3 Acc 0.90805 (36322/40000), AUC 0.9544575810432434
ep3_train_time 78.93755857600001
Test Epoch3 layer0 Acc 0.894, AUC 0.9582129716873169, avg_entr 0.20278054475784302, f1 0.8939999938011169
ep3_l0_test_time 0.5432935610000413
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8812, AUC 0.9415967464447021, avg_entr 0.07195067405700684, f1 0.8812000155448914
ep3_l1_test_time 1.0429777630000103
Test Epoch3 layer2 Acc 0.8828, AUC 0.9423174858093262, avg_entr 0.05446883663535118, f1 0.8827999830245972
ep3_l2_test_time 1.6568171229999962
Test Epoch3 layer3 Acc 0.883, AUC 0.9424151182174683, avg_entr 0.05545540153980255, f1 0.8830000162124634
ep3_l3_test_time 2.2638588870000262
Test Epoch3 layer4 Acc 0.884, AUC 0.9427602887153625, avg_entr 0.054397180676460266, f1 0.8840000033378601
ep3_l4_test_time 2.8782959680000317
gc 0
Train Epoch4 Acc 0.92735 (37094/40000), AUC 0.9694324731826782
ep4_train_time 78.92584408600004
Test Epoch4 layer0 Acc 0.8952, AUC 0.9591488838195801, avg_entr 0.1776941865682602, f1 0.8952000141143799
ep4_l0_test_time 0.5431325440000023
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8856, AUC 0.939490020275116, avg_entr 0.045547183603048325, f1 0.8855999708175659
ep4_l1_test_time 1.0394335130000059
Test Epoch4 layer2 Acc 0.8844, AUC 0.9403095245361328, avg_entr 0.03493635356426239, f1 0.8844000101089478
ep4_l2_test_time 1.6457224780000388
Test Epoch4 layer3 Acc 0.8856, AUC 0.9401960372924805, avg_entr 0.036146897822618484, f1 0.8855999708175659
ep4_l3_test_time 2.247517737999999
Test Epoch4 layer4 Acc 0.8864, AUC 0.9405503273010254, avg_entr 0.03713853284716606, f1 0.8863999843597412
ep4_l4_test_time 2.8597424259999684
gc 0
Train Epoch5 Acc 0.9375 (37500/40000), AUC 0.9767664074897766
ep5_train_time 78.91337924099997
Test Epoch5 layer0 Acc 0.892, AUC 0.9586617350578308, avg_entr 0.1641543060541153, f1 0.8920000195503235
ep5_l0_test_time 0.5449478169999793
Test Epoch5 layer1 Acc 0.8874, AUC 0.939335286617279, avg_entr 0.03595304116606712, f1 0.8873999714851379
ep5_l1_test_time 1.0375804820000667
Test Epoch5 layer2 Acc 0.8868, AUC 0.9402627944946289, avg_entr 0.03001965582370758, f1 0.8867999911308289
ep5_l2_test_time 1.654834578999953
Test Epoch5 layer3 Acc 0.887, AUC 0.9404305815696716, avg_entr 0.03269662335515022, f1 0.8870000243186951
ep5_l3_test_time 2.271132900999987
Test Epoch5 layer4 Acc 0.8856, AUC 0.9405850768089294, avg_entr 0.0354461632668972, f1 0.8855999708175659
ep5_l4_test_time 2.8901955319998933
gc 0
Train Epoch6 Acc 0.943425 (37737/40000), AUC 0.9807209968566895
ep6_train_time 78.93978447000006
Test Epoch6 layer0 Acc 0.8988, AUC 0.957581639289856, avg_entr 0.15688927471637726, f1 0.8988000154495239
ep6_l0_test_time 0.5404171530000212
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 6
Test Epoch6 layer1 Acc 0.8822, AUC 0.9450266361236572, avg_entr 0.05433980002999306, f1 0.8822000026702881
ep6_l1_test_time 1.0385080419999895
Test Epoch6 layer2 Acc 0.883, AUC 0.9462097883224487, avg_entr 0.04140859097242355, f1 0.8830000162124634
ep6_l2_test_time 1.6443817960000615
Test Epoch6 layer3 Acc 0.8814, AUC 0.9462206363677979, avg_entr 0.04080729931592941, f1 0.8813999891281128
ep6_l3_test_time 2.251323669000044
Test Epoch6 layer4 Acc 0.8792, AUC 0.9461675882339478, avg_entr 0.04035818204283714, f1 0.8791999816894531
ep6_l4_test_time 2.8499615480000102
gc 0
Train Epoch7 Acc 0.9437 (37748/40000), AUC 0.9824630618095398
ep7_train_time 78.93038271600005
Test Epoch7 layer0 Acc 0.8888, AUC 0.9553648233413696, avg_entr 0.1447536200284958, f1 0.8888000249862671
ep7_l0_test_time 0.5506980750000139
Test Epoch7 layer1 Acc 0.8816, AUC 0.9419744610786438, avg_entr 0.04434509947896004, f1 0.881600022315979
ep7_l1_test_time 1.0404421679999132
Test Epoch7 layer2 Acc 0.8822, AUC 0.9429565668106079, avg_entr 0.03731684759259224, f1 0.8822000026702881
ep7_l2_test_time 1.6527462469999818
Test Epoch7 layer3 Acc 0.8838, AUC 0.9427615404129028, avg_entr 0.03662979602813721, f1 0.8838000297546387
ep7_l3_test_time 2.25443010999993
Test Epoch7 layer4 Acc 0.8848, AUC 0.9429271221160889, avg_entr 0.035336777567863464, f1 0.8848000168800354
ep7_l4_test_time 2.863935668999943
gc 0
Train Epoch8 Acc 0.9567 (38268/40000), AUC 0.9885336756706238
ep8_train_time 79.07318205400009
Test Epoch8 layer0 Acc 0.8902, AUC 0.9537590742111206, avg_entr 0.14006002247333527, f1 0.8902000188827515
ep8_l0_test_time 0.5434410000000298
Test Epoch8 layer1 Acc 0.8802, AUC 0.9411218762397766, avg_entr 0.034203074872493744, f1 0.8802000284194946
ep8_l1_test_time 1.0404419699999607
Test Epoch8 layer2 Acc 0.8792, AUC 0.9419682621955872, avg_entr 0.027414880692958832, f1 0.8791999816894531
ep8_l2_test_time 1.6592160710000599
Test Epoch8 layer3 Acc 0.8802, AUC 0.9416800737380981, avg_entr 0.027320580556988716, f1 0.8802000284194946
ep8_l3_test_time 2.2678290939999215
Test Epoch8 layer4 Acc 0.8796, AUC 0.9416502714157104, avg_entr 0.027000512927770615, f1 0.8795999884605408
ep8_l4_test_time 2.8764511819999825
gc 0
Train Epoch9 Acc 0.962175 (38487/40000), AUC 0.9902012348175049
ep9_train_time 78.96334665400002
Test Epoch9 layer0 Acc 0.891, AUC 0.9527140259742737, avg_entr 0.13751386106014252, f1 0.890999972820282
ep9_l0_test_time 0.543195264000019
Test Epoch9 layer1 Acc 0.8758, AUC 0.9393328428268433, avg_entr 0.03367900475859642, f1 0.8758000135421753
ep9_l1_test_time 1.0342060490000904
Test Epoch9 layer2 Acc 0.8762, AUC 0.9405562877655029, avg_entr 0.02795032039284706, f1 0.8762000203132629
ep9_l2_test_time 1.6389844299999368
Test Epoch9 layer3 Acc 0.8768, AUC 0.9400050640106201, avg_entr 0.026794934645295143, f1 0.876800000667572
ep9_l3_test_time 2.2478609720000122
Test Epoch9 layer4 Acc 0.8764, AUC 0.9399012327194214, avg_entr 0.02659762278199196, f1 0.8763999938964844
ep9_l4_test_time 2.860487324000019
gc 0
Train Epoch10 Acc 0.96415 (38566/40000), AUC 0.9909025430679321
ep10_train_time 78.91378808999991
Test Epoch10 layer0 Acc 0.8906, AUC 0.9518482089042664, avg_entr 0.13576598465442657, f1 0.8906000256538391
ep10_l0_test_time 0.5455966420000777
Test Epoch10 layer1 Acc 0.8752, AUC 0.9371524453163147, avg_entr 0.026118924841284752, f1 0.8751999735832214
ep10_l1_test_time 1.0391584120000061
Test Epoch10 layer2 Acc 0.8748, AUC 0.9382957220077515, avg_entr 0.020948050543665886, f1 0.8748000264167786
ep10_l2_test_time 1.6562476569999944
Test Epoch10 layer3 Acc 0.874, AUC 0.9384605884552002, avg_entr 0.020007476210594177, f1 0.8740000128746033
ep10_l3_test_time 2.270211791999941
Test Epoch10 layer4 Acc 0.8728, AUC 0.9379293918609619, avg_entr 0.020597808063030243, f1 0.8727999925613403
ep10_l4_test_time 2.8909708749999936
gc 0
Train Epoch11 Acc 0.96675 (38670/40000), AUC 0.992518424987793
ep11_train_time 89.2890634019999
Test Epoch11 layer0 Acc 0.8878, AUC 0.9507337808609009, avg_entr 0.13324862718582153, f1 0.8877999782562256
ep11_l0_test_time 0.7634808069999508
Test Epoch11 layer1 Acc 0.8728, AUC 0.9363306164741516, avg_entr 0.028670700266957283, f1 0.8727999925613403
ep11_l1_test_time 1.2419077970000671
Test Epoch11 layer2 Acc 0.8742, AUC 0.9375852346420288, avg_entr 0.024182762950658798, f1 0.8741999864578247
ep11_l2_test_time 2.0751551159999053
Test Epoch11 layer3 Acc 0.876, AUC 0.937333345413208, avg_entr 0.02327766641974449, f1 0.8760000467300415
ep11_l3_test_time 2.821954108
Test Epoch11 layer4 Acc 0.8764, AUC 0.9367006421089172, avg_entr 0.023497238755226135, f1 0.8763999938964844
ep11_l4_test_time 3.6769802700000582
gc 0
Train Epoch12 Acc 0.969175 (38767/40000), AUC 0.993361234664917
ep12_train_time 100.55575427999997
Test Epoch12 layer0 Acc 0.8868, AUC 0.9494675397872925, avg_entr 0.12850548326969147, f1 0.8867999911308289
ep12_l0_test_time 0.5542211350000343
Test Epoch12 layer1 Acc 0.874, AUC 0.9351379871368408, avg_entr 0.026972949504852295, f1 0.8740000128746033
ep12_l1_test_time 1.0535251870001048
Test Epoch12 layer2 Acc 0.8744, AUC 0.9367469549179077, avg_entr 0.02205415815114975, f1 0.8744000792503357
ep12_l2_test_time 1.6667423839999174
Test Epoch12 layer3 Acc 0.8732, AUC 0.9365541934967041, avg_entr 0.02104322239756584, f1 0.873199999332428
ep12_l3_test_time 2.2660930750000716
Test Epoch12 layer4 Acc 0.8732, AUC 0.9358563423156738, avg_entr 0.021726828068494797, f1 0.873199999332428
ep12_l4_test_time 3.0373522540000977
gc 0
Train Epoch13 Acc 0.97045 (38818/40000), AUC 0.9939088821411133
ep13_train_time 100.11170418899997
Test Epoch13 layer0 Acc 0.8868, AUC 0.9489666223526001, avg_entr 0.1279294192790985, f1 0.8867999911308289
ep13_l0_test_time 0.641907012000047
Test Epoch13 layer1 Acc 0.8704, AUC 0.934548556804657, avg_entr 0.029927829280495644, f1 0.8704000115394592
ep13_l1_test_time 1.285460151000052
Test Epoch13 layer2 Acc 0.8716, AUC 0.9358227252960205, avg_entr 0.02390182949602604, f1 0.8715999722480774
ep13_l2_test_time 2.0965473190001376
Test Epoch13 layer3 Acc 0.872, AUC 0.9354115724563599, avg_entr 0.022491183131933212, f1 0.871999979019165
ep13_l3_test_time 2.8349194559998523
Test Epoch13 layer4 Acc 0.8728, AUC 0.9347577095031738, avg_entr 0.022690055891871452, f1 0.8727999925613403
ep13_l4_test_time 3.733976365999979
gc 0
Train Epoch14 Acc 0.97105 (38842/40000), AUC 0.9943309426307678
ep14_train_time 94.16815470900019
Test Epoch14 layer0 Acc 0.8844, AUC 0.9483202695846558, avg_entr 0.12807071208953857, f1 0.8844000101089478
ep14_l0_test_time 0.6306984389998433
Test Epoch14 layer1 Acc 0.8708, AUC 0.9322822093963623, avg_entr 0.029112722724676132, f1 0.8708000183105469
ep14_l1_test_time 1.3156720990000395
Test Epoch14 layer2 Acc 0.8698, AUC 0.9337495565414429, avg_entr 0.024699322879314423, f1 0.8697999715805054
ep14_l2_test_time 2.0775907540000844
Test Epoch14 layer3 Acc 0.8696, AUC 0.9339722394943237, avg_entr 0.02339641936123371, f1 0.8695999383926392
ep14_l3_test_time 2.8653936030000295
Test Epoch14 layer4 Acc 0.8682, AUC 0.9332605600357056, avg_entr 0.024389000609517097, f1 0.8682000041007996
ep14_l4_test_time 3.710172418999946
gc 0
Train Epoch15 Acc 0.972825 (38913/40000), AUC 0.9946275949478149
ep15_train_time 101.18291699300016
Test Epoch15 layer0 Acc 0.8824, AUC 0.9475666284561157, avg_entr 0.1240830048918724, f1 0.8823999762535095
ep15_l0_test_time 0.5528910909999922
Test Epoch15 layer1 Acc 0.8746, AUC 0.9334344863891602, avg_entr 0.028063736855983734, f1 0.8745999932289124
ep15_l1_test_time 1.0443845279999096
Test Epoch15 layer2 Acc 0.8736, AUC 0.934411883354187, avg_entr 0.022646035999059677, f1 0.8736000061035156
ep15_l2_test_time 1.6604223159999947
Test Epoch15 layer3 Acc 0.8726, AUC 0.9346573352813721, avg_entr 0.021788543090224266, f1 0.8726000189781189
ep15_l3_test_time 2.27857718700011
Test Epoch15 layer4 Acc 0.871, AUC 0.9338250160217285, avg_entr 0.022826435044407845, f1 0.8709999918937683
ep15_l4_test_time 2.900396116000138
gc 0
Train Epoch16 Acc 0.973075 (38923/40000), AUC 0.9950511455535889
ep16_train_time 99.62438443500014
Test Epoch16 layer0 Acc 0.8834, AUC 0.9469188451766968, avg_entr 0.12289255112409592, f1 0.8834000825881958
ep16_l0_test_time 0.6575259999999616
Test Epoch16 layer1 Acc 0.8716, AUC 0.9327009916305542, avg_entr 0.026142220944166183, f1 0.8715999722480774
ep16_l1_test_time 1.3367293950000203
Test Epoch16 layer2 Acc 0.871, AUC 0.9336203336715698, avg_entr 0.021057166159152985, f1 0.8709999918937683
ep16_l2_test_time 2.0785230280000633
Test Epoch16 layer3 Acc 0.8718, AUC 0.9337957501411438, avg_entr 0.020469078794121742, f1 0.8718000650405884
ep16_l3_test_time 2.825259334000066
Test Epoch16 layer4 Acc 0.8714, AUC 0.9327276945114136, avg_entr 0.021117648109793663, f1 0.871399998664856
ep16_l4_test_time 3.6686364010001853
gc 0
Train Epoch17 Acc 0.973225 (38929/40000), AUC 0.9955077171325684
ep17_train_time 94.28872139500004
Test Epoch17 layer0 Acc 0.883, AUC 0.9466534852981567, avg_entr 0.12245311588048935, f1 0.8830000162124634
ep17_l0_test_time 0.6297541659998842
Test Epoch17 layer1 Acc 0.8724, AUC 0.9327322244644165, avg_entr 0.02667396329343319, f1 0.8723999857902527
ep17_l1_test_time 1.2991578500000287
Test Epoch17 layer2 Acc 0.8728, AUC 0.9335007071495056, avg_entr 0.021516239270567894, f1 0.8727999925613403
ep17_l2_test_time 2.09669167800007
Test Epoch17 layer3 Acc 0.8722, AUC 0.9340440630912781, avg_entr 0.020825564861297607, f1 0.872200071811676
ep17_l3_test_time 2.828463445000125
Test Epoch17 layer4 Acc 0.872, AUC 0.9329439997673035, avg_entr 0.02134563960134983, f1 0.871999979019165
ep17_l4_test_time 3.7631136280001556
gc 0
Train Epoch18 Acc 0.974275 (38971/40000), AUC 0.9954198598861694
ep18_train_time 101.62301170399996
Test Epoch18 layer0 Acc 0.8822, AUC 0.9463627338409424, avg_entr 0.12065987288951874, f1 0.8822000026702881
ep18_l0_test_time 0.5498712459998387
Test Epoch18 layer1 Acc 0.8722, AUC 0.9316555261611938, avg_entr 0.024359529837965965, f1 0.872200071811676
ep18_l1_test_time 1.0475666449999608
Test Epoch18 layer2 Acc 0.8714, AUC 0.9324713945388794, avg_entr 0.019354233518242836, f1 0.871399998664856
ep18_l2_test_time 1.6647082829999817
Test Epoch18 layer3 Acc 0.871, AUC 0.9328992366790771, avg_entr 0.018435630947351456, f1 0.8709999918937683
ep18_l3_test_time 2.278194595999821
Test Epoch18 layer4 Acc 0.8716, AUC 0.9316743612289429, avg_entr 0.019072359427809715, f1 0.8715999722480774
ep18_l4_test_time 3.095740601999978
gc 0
Train Epoch19 Acc 0.974525 (38981/40000), AUC 0.9956849813461304
ep19_train_time 98.51431649999995
Test Epoch19 layer0 Acc 0.8828, AUC 0.9460306763648987, avg_entr 0.12078241258859634, f1 0.8827999830245972
ep19_l0_test_time 0.6252490169999874
Test Epoch19 layer1 Acc 0.8702, AUC 0.9306176900863647, avg_entr 0.023379364982247353, f1 0.870199978351593
ep19_l1_test_time 1.3134092190000501
Test Epoch19 layer2 Acc 0.8706, AUC 0.9314836859703064, avg_entr 0.0178364384919405, f1 0.8705999851226807
ep19_l2_test_time 2.0888478119998126
Test Epoch19 layer3 Acc 0.87, AUC 0.931954562664032, avg_entr 0.01652739942073822, f1 0.8700000047683716
ep19_l3_test_time 2.8019938129998536
Test Epoch19 layer4 Acc 0.87, AUC 0.9305437803268433, avg_entr 0.016718927770853043, f1 0.8700000047683716
ep19_l4_test_time 3.7208568349999496
gc 0
Train Epoch20 Acc 0.9749 (38996/40000), AUC 0.9958056211471558
ep20_train_time 94.25244116700014
Test Epoch20 layer0 Acc 0.8826, AUC 0.9457923769950867, avg_entr 0.11988889425992966, f1 0.8826000094413757
ep20_l0_test_time 0.6275256710000576
Test Epoch20 layer1 Acc 0.872, AUC 0.9312633275985718, avg_entr 0.025058520957827568, f1 0.871999979019165
ep20_l1_test_time 1.2946230459997423
Test Epoch20 layer2 Acc 0.8722, AUC 0.9320724606513977, avg_entr 0.019738955423235893, f1 0.872200071811676
ep20_l2_test_time 2.1214812549997077
Test Epoch20 layer3 Acc 0.8714, AUC 0.9326815605163574, avg_entr 0.019002897664904594, f1 0.871399998664856
ep20_l3_test_time 2.846791424999992
Test Epoch20 layer4 Acc 0.871, AUC 0.9313673973083496, avg_entr 0.01947808265686035, f1 0.8709999918937683
ep20_l4_test_time 3.7424560879999262
gc 0
Train Epoch21 Acc 0.97545 (39018/40000), AUC 0.9959695339202881
ep21_train_time 102.32036348400015
Test Epoch21 layer0 Acc 0.8828, AUC 0.9456071853637695, avg_entr 0.11873932182788849, f1 0.8827999830245972
ep21_l0_test_time 0.5545657850002499
Test Epoch21 layer1 Acc 0.8708, AUC 0.9306662082672119, avg_entr 0.02458127960562706, f1 0.8708000183105469
ep21_l1_test_time 1.0524260810002488
Test Epoch21 layer2 Acc 0.8724, AUC 0.9315736889839172, avg_entr 0.019491201266646385, f1 0.8723999857902527
ep21_l2_test_time 1.6482935140002155
Test Epoch21 layer3 Acc 0.8718, AUC 0.9321916103363037, avg_entr 0.019036661833524704, f1 0.8718000650405884
ep21_l3_test_time 2.254955887000051
Test Epoch21 layer4 Acc 0.871, AUC 0.9308934807777405, avg_entr 0.01975892297923565, f1 0.8709999918937683
ep21_l4_test_time 2.86217994000026
gc 0
Train Epoch22 Acc 0.97545 (39018/40000), AUC 0.9959660172462463
ep22_train_time 98.45408020299965
Test Epoch22 layer0 Acc 0.881, AUC 0.9454710483551025, avg_entr 0.11968336254358292, f1 0.8809999823570251
ep22_l0_test_time 0.6543274690002363
Test Epoch22 layer1 Acc 0.8708, AUC 0.930773138999939, avg_entr 0.02550564333796501, f1 0.8708000183105469
ep22_l1_test_time 1.3055606180000723
Test Epoch22 layer2 Acc 0.8704, AUC 0.931605875492096, avg_entr 0.02088211290538311, f1 0.8704000115394592
ep22_l2_test_time 2.1130326060001607
Test Epoch22 layer3 Acc 0.87, AUC 0.9322826862335205, avg_entr 0.020078962668776512, f1 0.8700000047683716
ep22_l3_test_time 2.830501637999987
Test Epoch22 layer4 Acc 0.8694, AUC 0.9310444593429565, avg_entr 0.020306887105107307, f1 0.8694000244140625
ep22_l4_test_time 3.697207093999623
gc 0
Train Epoch23 Acc 0.976325 (39053/40000), AUC 0.9961251020431519
ep23_train_time 94.47207583399995
Test Epoch23 layer0 Acc 0.8814, AUC 0.9453309774398804, avg_entr 0.11813781410455704, f1 0.8813999891281128
ep23_l0_test_time 0.6366235450000204
Test Epoch23 layer1 Acc 0.8686, AUC 0.9308618903160095, avg_entr 0.024670900776982307, f1 0.8686000108718872
ep23_l1_test_time 1.2979407409998203
Test Epoch23 layer2 Acc 0.8694, AUC 0.9315097332000732, avg_entr 0.01962890662252903, f1 0.8694000244140625
ep23_l2_test_time 2.138303984999766
Test Epoch23 layer3 Acc 0.8694, AUC 0.9321261644363403, avg_entr 0.019421041011810303, f1 0.8694000244140625
ep23_l3_test_time 2.821511694000037
Test Epoch23 layer4 Acc 0.8698, AUC 0.9308923482894897, avg_entr 0.020200984552502632, f1 0.8697999715805054
ep23_l4_test_time 3.672117563000029
gc 0
Train Epoch24 Acc 0.9766 (39064/40000), AUC 0.996234655380249
ep24_train_time 102.70915505999983
Test Epoch24 layer0 Acc 0.8816, AUC 0.9451786279678345, avg_entr 0.11773836612701416, f1 0.881600022315979
ep24_l0_test_time 0.5635250700001961
Test Epoch24 layer1 Acc 0.8712, AUC 0.9301601052284241, avg_entr 0.02283404767513275, f1 0.8712000846862793
ep24_l1_test_time 1.049737886999992
Test Epoch24 layer2 Acc 0.8706, AUC 0.9309778213500977, avg_entr 0.01848272792994976, f1 0.8705999851226807
ep24_l2_test_time 1.6502728960003878
Test Epoch24 layer3 Acc 0.8702, AUC 0.9316936135292053, avg_entr 0.017820293083786964, f1 0.870199978351593
ep24_l3_test_time 2.246268824999788
Test Epoch24 layer4 Acc 0.8694, AUC 0.930162787437439, avg_entr 0.018322143703699112, f1 0.8694000244140625
ep24_l4_test_time 2.8632523219998802
gc 0
Train Epoch25 Acc 0.9764 (39056/40000), AUC 0.9962189793586731
ep25_train_time 98.08627173500008
Test Epoch25 layer0 Acc 0.8812, AUC 0.945081353187561, avg_entr 0.11682823300361633, f1 0.8812000155448914
ep25_l0_test_time 0.6362498919997961
Test Epoch25 layer1 Acc 0.8688, AUC 0.9306361675262451, avg_entr 0.0232271458953619, f1 0.8687999844551086
ep25_l1_test_time 1.2797032829998898
Test Epoch25 layer2 Acc 0.8696, AUC 0.931279718875885, avg_entr 0.017375124618411064, f1 0.8695999383926392
ep25_l2_test_time 2.0930427390003388
Test Epoch25 layer3 Acc 0.8694, AUC 0.9318310618400574, avg_entr 0.016948750242590904, f1 0.8694000244140625
ep25_l3_test_time 2.8671189789997698
Test Epoch25 layer4 Acc 0.8706, AUC 0.930436372756958, avg_entr 0.017477212473750114, f1 0.8705999851226807
ep25_l4_test_time 3.7232198830001835
gc 0
Train Epoch26 Acc 0.9766 (39064/40000), AUC 0.9962677359580994
ep26_train_time 94.32434273300032
Test Epoch26 layer0 Acc 0.8808, AUC 0.9450488090515137, avg_entr 0.11735326051712036, f1 0.8808000087738037
ep26_l0_test_time 0.6289235259996531
Test Epoch26 layer1 Acc 0.8688, AUC 0.9305912256240845, avg_entr 0.02451200783252716, f1 0.8687999844551086
ep26_l1_test_time 1.2986629239999274
Test Epoch26 layer2 Acc 0.8692, AUC 0.9312413334846497, avg_entr 0.019795013591647148, f1 0.8691999912261963
ep26_l2_test_time 2.1165288050001436
Test Epoch26 layer3 Acc 0.8686, AUC 0.9319064021110535, avg_entr 0.01926598511636257, f1 0.8686000108718872
ep26_l3_test_time 2.7703266130001793
Test Epoch26 layer4 Acc 0.869, AUC 0.9306190013885498, avg_entr 0.01961563341319561, f1 0.8690000176429749
ep26_l4_test_time 3.685505361000196
gc 0
Train Epoch27 Acc 0.977175 (39087/40000), AUC 0.9962869882583618
ep27_train_time 102.96430435899993
Test Epoch27 layer0 Acc 0.8808, AUC 0.944923996925354, avg_entr 0.11590388417243958, f1 0.8808000087738037
ep27_l0_test_time 0.6021303689999513
Test Epoch27 layer1 Acc 0.8694, AUC 0.9299288988113403, avg_entr 0.022462569177150726, f1 0.8694000244140625
ep27_l1_test_time 1.085268702999656
Test Epoch27 layer2 Acc 0.8696, AUC 0.9306868314743042, avg_entr 0.017890118062496185, f1 0.8695999383926392
ep27_l2_test_time 1.6588326149999375
Test Epoch27 layer3 Acc 0.869, AUC 0.931318998336792, avg_entr 0.01741180568933487, f1 0.8690000176429749
ep27_l3_test_time 2.2593385469999703
Test Epoch27 layer4 Acc 0.869, AUC 0.9298527836799622, avg_entr 0.018003730103373528, f1 0.8690000176429749
ep27_l4_test_time 2.8762361080002847
gc 0
Train Epoch28 Acc 0.9769 (39076/40000), AUC 0.9963240027427673
ep28_train_time 79.25466560899986
Test Epoch28 layer0 Acc 0.881, AUC 0.9448937177658081, avg_entr 0.11576806753873825, f1 0.8809999823570251
ep28_l0_test_time 0.5580304940003771
Test Epoch28 layer1 Acc 0.8694, AUC 0.9300391674041748, avg_entr 0.02395106479525566, f1 0.8694000244140625
ep28_l1_test_time 1.0697899600004348
Test Epoch28 layer2 Acc 0.869, AUC 0.9308936595916748, avg_entr 0.019149506464600563, f1 0.8690000176429749
ep28_l2_test_time 1.6683868390000498
Test Epoch28 layer3 Acc 0.8682, AUC 0.9315866231918335, avg_entr 0.018626436591148376, f1 0.8682000041007996
ep28_l3_test_time 2.2559169169999223
Test Epoch28 layer4 Acc 0.8688, AUC 0.9301257133483887, avg_entr 0.018951600417494774, f1 0.8687999844551086
ep28_l4_test_time 2.8770841049999945
gc 0
Train Epoch29 Acc 0.976925 (39077/40000), AUC 0.996379017829895
ep29_train_time 78.85770069800037
Test Epoch29 layer0 Acc 0.881, AUC 0.9448611736297607, avg_entr 0.11577128618955612, f1 0.8809999823570251
ep29_l0_test_time 0.5444858350001596
Test Epoch29 layer1 Acc 0.8702, AUC 0.9299018383026123, avg_entr 0.023155082017183304, f1 0.870199978351593
ep29_l1_test_time 1.0368217049999657
Test Epoch29 layer2 Acc 0.8702, AUC 0.9306555986404419, avg_entr 0.018797602504491806, f1 0.870199978351593
ep29_l2_test_time 1.6412649459998647
Test Epoch29 layer3 Acc 0.8696, AUC 0.9313704967498779, avg_entr 0.018168268725275993, f1 0.8695999383926392
ep29_l3_test_time 2.2329253200000494
Test Epoch29 layer4 Acc 0.8704, AUC 0.9298219084739685, avg_entr 0.01838364638388157, f1 0.8704000115394592
ep29_l4_test_time 2.8549082149997957
Best AUC tensor(0.8988) 6 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 2971.10534935
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8938, AUC 0.9535954594612122, avg_entr 0.1582328826189041, f1 0.8938000202178955
l0_test_time 0.5379392280001412
Test layer1 Acc 0.8756, AUC 0.9389839172363281, avg_entr 0.05519542098045349, f1 0.8756000399589539
l1_test_time 1.0330858180000178
Test layer2 Acc 0.8778, AUC 0.9408129453659058, avg_entr 0.043150268495082855, f1 0.8778000473976135
l2_test_time 1.6304166609997992
Test layer3 Acc 0.876, AUC 0.9405193328857422, avg_entr 0.04261799156665802, f1 0.8760000467300415
l3_test_time 2.238191942999947
Test layer4 Acc 0.8734, AUC 0.9407253265380859, avg_entr 0.04209556058049202, f1 0.8733999729156494
l4_test_time 2.8478541999998015
