total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 58.39765691757202
Start Training
gc 0
Train Epoch0 Acc 0.9038553571428571 (506159/560000), AUC 0.9899103045463562
ep0_train_time 434.06602144241333
Test Epoch0 layer0 Acc 0.9724285714285714, AUC 0.9982989430427551, avg_entr 0.08661331981420517, f1 0.972428560256958
ep0_l0_test_time 2.281653642654419
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9820857142857143, AUC 0.9986858367919922, avg_entr 0.021254858002066612, f1 0.9820857048034668
ep0_l1_test_time 3.503678560256958
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9821142857142857, AUC 0.9985595941543579, avg_entr 0.019169729202985764, f1 0.982114315032959
ep0_l2_test_time 4.733191013336182
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9819142857142857, AUC 0.9981012940406799, avg_entr 0.020399224013090134, f1 0.9819142818450928
ep0_l3_test_time 5.8607611656188965
Test Epoch0 layer4 Acc 0.9820857142857143, AUC 0.997441828250885, avg_entr 0.022309789434075356, f1 0.9820857048034668
ep0_l4_test_time 7.405830144882202
gc 0
Train Epoch1 Acc 0.9849232142857143 (551557/560000), AUC 0.9972809553146362
ep1_train_time 431.46921730041504
Test Epoch1 layer0 Acc 0.9733428571428572, AUC 0.9984248280525208, avg_entr 0.04699333757162094, f1 0.9733428359031677
ep1_l0_test_time 2.291292905807495
Test Epoch1 layer1 Acc 0.9837714285714285, AUC 0.9988365173339844, avg_entr 0.006321964785456657, f1 0.9837714433670044
ep1_l1_test_time 3.518171548843384
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9837142857142858, AUC 0.9985840916633606, avg_entr 0.004932888317853212, f1 0.9837142825126648
ep1_l2_test_time 4.832916259765625
Test Epoch1 layer3 Acc 0.9834857142857143, AUC 0.9981518387794495, avg_entr 0.004965579137206078, f1 0.9834856986999512
ep1_l3_test_time 6.112319707870483
Test Epoch1 layer4 Acc 0.9835142857142857, AUC 0.9976873993873596, avg_entr 0.004679734352976084, f1 0.9835143089294434
ep1_l4_test_time 7.3977906703948975
gc 0
Train Epoch2 Acc 0.9870375 (552741/560000), AUC 0.9978336095809937
ep2_train_time 431.0134835243225
Test Epoch2 layer0 Acc 0.9742, AUC 0.9984628558158875, avg_entr 0.03381086140871048, f1 0.9742000102996826
ep2_l0_test_time 2.310513973236084
Test Epoch2 layer1 Acc 0.9842857142857143, AUC 0.9987788200378418, avg_entr 0.003592871595174074, f1 0.9842857122421265
ep2_l1_test_time 3.5065269470214844
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.9843714285714286, AUC 0.998607337474823, avg_entr 0.0028225791174918413, f1 0.9843714237213135
ep2_l2_test_time 4.804899215698242
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.9844285714285714, AUC 0.9980334639549255, avg_entr 0.0026512115728110075, f1 0.9844285845756531
ep2_l3_test_time 6.103508949279785
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.9846285714285714, AUC 0.997669517993927, avg_entr 0.0025154801551252604, f1 0.9846285581588745
ep2_l4_test_time 7.4158453941345215
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9884392857142857 (553526/560000), AUC 0.9981769919395447
ep3_train_time 411.4771010875702
Test Epoch3 layer0 Acc 0.9745714285714285, AUC 0.9984713196754456, avg_entr 0.027605727314949036, f1 0.9745714068412781
ep3_l0_test_time 2.3126559257507324
Test Epoch3 layer1 Acc 0.9845428571428572, AUC 0.9988206624984741, avg_entr 0.0025675049982964993, f1 0.9845428466796875
ep3_l1_test_time 3.420095205307007
Test Epoch3 layer2 Acc 0.9850285714285715, AUC 0.9987022280693054, avg_entr 0.0018937368877232075, f1 0.9850285649299622
ep3_l2_test_time 4.821836709976196
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.985, AUC 0.9981536865234375, avg_entr 0.001792027265764773, f1 0.9850000143051147
ep3_l3_test_time 6.114951133728027
Test Epoch3 layer4 Acc 0.9848, AUC 0.9978939890861511, avg_entr 0.00167707703076303, f1 0.9847999811172485
ep3_l4_test_time 7.413084030151367
gc 0
Train Epoch4 Acc 0.9895696428571429 (554159/560000), AUC 0.9984506964683533
ep4_train_time 431.57912373542786
Test Epoch4 layer0 Acc 0.9749428571428571, AUC 0.9984763264656067, avg_entr 0.02588994987308979, f1 0.9749428629875183
ep4_l0_test_time 2.2824087142944336
Test Epoch4 layer1 Acc 0.9856, AUC 0.9987885355949402, avg_entr 0.0024041158612817526, f1 0.9855999946594238
ep4_l1_test_time 3.427510976791382
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.9858571428571429, AUC 0.9985336661338806, avg_entr 0.001881445525214076, f1 0.9858571290969849
ep4_l2_test_time 4.798168420791626
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
Test Epoch4 layer3 Acc 0.9858, AUC 0.9982050657272339, avg_entr 0.001703860005363822, f1 0.98580002784729
ep4_l3_test_time 6.109144449234009
Test Epoch4 layer4 Acc 0.9859428571428571, AUC 0.9978991150856018, avg_entr 0.0016643155831843615, f1 0.9859428405761719
ep4_l4_test_time 7.387490272521973
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9904714285714286 (554664/560000), AUC 0.9986609220504761
ep5_train_time 431.72951102256775
Test Epoch5 layer0 Acc 0.9750571428571428, AUC 0.9984931349754333, avg_entr 0.025006072595715523, f1 0.9750571250915527
ep5_l0_test_time 2.3029839992523193
Test Epoch5 layer1 Acc 0.9851714285714286, AUC 0.9988164305686951, avg_entr 0.0023482865653932095, f1 0.9851714372634888
ep5_l1_test_time 3.44250750541687
Test Epoch5 layer2 Acc 0.9856, AUC 0.9986957311630249, avg_entr 0.0018895751563832164, f1 0.9855999946594238
ep5_l2_test_time 4.794314384460449
Test Epoch5 layer3 Acc 0.9853142857142857, AUC 0.9983540773391724, avg_entr 0.0016819019801914692, f1 0.9853143095970154
ep5_l3_test_time 6.087752103805542
Test Epoch5 layer4 Acc 0.9854857142857143, AUC 0.9979507327079773, avg_entr 0.0015780591638758779, f1 0.9854857325553894
ep5_l4_test_time 7.283629894256592
gc 0
Train Epoch6 Acc 0.9918160714285714 (555417/560000), AUC 0.9988728761672974
ep6_train_time 431.79845905303955
Test Epoch6 layer0 Acc 0.9747142857142858, AUC 0.998510479927063, avg_entr 0.02468041703104973, f1 0.9747142791748047
ep6_l0_test_time 2.3157148361206055
Test Epoch6 layer1 Acc 0.9850857142857142, AUC 0.9987073540687561, avg_entr 0.0021166971419006586, f1 0.9850857257843018
ep6_l1_test_time 3.4338786602020264
Test Epoch6 layer2 Acc 0.9852857142857143, AUC 0.9984586834907532, avg_entr 0.0015769700985401869, f1 0.9852856993675232
ep6_l2_test_time 4.818607330322266
Test Epoch6 layer3 Acc 0.9852571428571428, AUC 0.9981499314308167, avg_entr 0.00137967593036592, f1 0.9852571487426758
ep6_l3_test_time 6.082251787185669
Test Epoch6 layer4 Acc 0.9852571428571428, AUC 0.9977649450302124, avg_entr 0.0014161161379888654, f1 0.9852571487426758
ep6_l4_test_time 7.411359071731567
gc 0
Train Epoch7 Acc 0.9922125 (555639/560000), AUC 0.9989158511161804
ep7_train_time 431.78457736968994
Test Epoch7 layer0 Acc 0.9749142857142857, AUC 0.9984906911849976, avg_entr 0.024547604843974113, f1 0.9749143123626709
ep7_l0_test_time 1.995615005493164
Test Epoch7 layer1 Acc 0.9852571428571428, AUC 0.9986986517906189, avg_entr 0.002147119492292404, f1 0.9852571487426758
ep7_l1_test_time 3.310218572616577
Test Epoch7 layer2 Acc 0.9853428571428572, AUC 0.998548686504364, avg_entr 0.0016230057226493955, f1 0.9853428602218628
ep7_l2_test_time 4.813880681991577
Test Epoch7 layer3 Acc 0.9852857142857143, AUC 0.9982357025146484, avg_entr 0.001431316719390452, f1 0.9852856993675232
ep7_l3_test_time 6.110994100570679
Test Epoch7 layer4 Acc 0.9852857142857143, AUC 0.9977298974990845, avg_entr 0.0013502020156010985, f1 0.9852856993675232
ep7_l4_test_time 7.391026735305786
gc 0
Train Epoch8 Acc 0.9927375 (555933/560000), AUC 0.9989283680915833
ep8_train_time 431.7142732143402
Test Epoch8 layer0 Acc 0.9751142857142857, AUC 0.9985014796257019, avg_entr 0.02443438582122326, f1 0.9751142859458923
ep8_l0_test_time 2.2963993549346924
Test Epoch8 layer1 Acc 0.9857428571428571, AUC 0.9985917210578918, avg_entr 0.0021987147629261017, f1 0.9857428669929504
ep8_l1_test_time 3.516545295715332
Test Epoch8 layer2 Acc 0.9862, AUC 0.9984670281410217, avg_entr 0.0015033913077786565, f1 0.9861999750137329
ep8_l2_test_time 4.833173513412476
Save ckpt to ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt  ,ep 8
Test Epoch8 layer3 Acc 0.9859714285714286, AUC 0.9981197118759155, avg_entr 0.0013290060451254249, f1 0.9859714508056641
ep8_l3_test_time 6.126767873764038
Test Epoch8 layer4 Acc 0.9861428571428571, AUC 0.9976625442504883, avg_entr 0.001301242271438241, f1 0.9861428737640381
ep8_l4_test_time 7.390635967254639
gc 0
Train Epoch9 Acc 0.9931553571428572 (556167/560000), AUC 0.998966634273529
ep9_train_time 431.02163910865784
Test Epoch9 layer0 Acc 0.9748285714285714, AUC 0.9984868764877319, avg_entr 0.02437310665845871, f1 0.9748286008834839
ep9_l0_test_time 2.2886831760406494
Test Epoch9 layer1 Acc 0.9852857142857143, AUC 0.9986368417739868, avg_entr 0.0018960334127768874, f1 0.9852856993675232
ep9_l1_test_time 3.4036314487457275
Test Epoch9 layer2 Acc 0.9857714285714285, AUC 0.9986037611961365, avg_entr 0.0013703142758458853, f1 0.9857714176177979
ep9_l2_test_time 4.768956184387207
Test Epoch9 layer3 Acc 0.9858, AUC 0.9982728362083435, avg_entr 0.0012130822287872434, f1 0.98580002784729
ep9_l3_test_time 6.0965917110443115
Test Epoch9 layer4 Acc 0.9856571428571429, AUC 0.997752845287323, avg_entr 0.001156471436843276, f1 0.9856571555137634
ep9_l4_test_time 7.379148721694946
gc 0
Train Epoch10 Acc 0.9938464285714286 (556554/560000), AUC 0.9990085959434509
ep10_train_time 432.95460510253906
Test Epoch10 layer0 Acc 0.9747142857142858, AUC 0.9985021352767944, avg_entr 0.024216551333665848, f1 0.9747142791748047
ep10_l0_test_time 2.2287235260009766
Test Epoch10 layer1 Acc 0.9858285714285714, AUC 0.9985234141349792, avg_entr 0.0018304985715076327, f1 0.9858285784721375
ep10_l1_test_time 3.1636900901794434
Test Epoch10 layer2 Acc 0.9856571428571429, AUC 0.9983604550361633, avg_entr 0.0012756764190271497, f1 0.9856571555137634
ep10_l2_test_time 4.741661787033081
Test Epoch10 layer3 Acc 0.9856571428571429, AUC 0.9980961680412292, avg_entr 0.0011582185979932547, f1 0.9856571555137634
ep10_l3_test_time 6.152797222137451
Test Epoch10 layer4 Acc 0.9857428571428571, AUC 0.9974280595779419, avg_entr 0.0011011046590283513, f1 0.9857428669929504
ep10_l4_test_time 7.443331003189087
gc 0
Train Epoch11 Acc 0.9941321428571429 (556714/560000), AUC 0.9990062117576599
ep11_train_time 432.3645658493042
Test Epoch11 layer0 Acc 0.9748285714285714, AUC 0.9984983205795288, avg_entr 0.024035619571805, f1 0.9748286008834839
ep11_l0_test_time 2.335330009460449
Test Epoch11 layer1 Acc 0.9854285714285714, AUC 0.9985419511795044, avg_entr 0.0019131526350975037, f1 0.9854285717010498
ep11_l1_test_time 3.4267566204071045
Test Epoch11 layer2 Acc 0.9855714285714285, AUC 0.9984719157218933, avg_entr 0.0013801389141008258, f1 0.9855714440345764
ep11_l2_test_time 4.816681146621704
Test Epoch11 layer3 Acc 0.9856571428571429, AUC 0.99815434217453, avg_entr 0.0011705243960022926, f1 0.9856571555137634
ep11_l3_test_time 6.1022608280181885
Test Epoch11 layer4 Acc 0.9856857142857143, AUC 0.9974856972694397, avg_entr 0.0011210863012820482, f1 0.9856857061386108
ep11_l4_test_time 7.428491115570068
gc 0
Train Epoch12 Acc 0.9943946428571429 (556861/560000), AUC 0.998996913433075
ep12_train_time 432.40012288093567
Test Epoch12 layer0 Acc 0.9747714285714286, AUC 0.9984896779060364, avg_entr 0.02390090376138687, f1 0.9747714400291443
ep12_l0_test_time 2.332639217376709
Test Epoch12 layer1 Acc 0.9856571428571429, AUC 0.9983892440795898, avg_entr 0.0018050221260637045, f1 0.9856571555137634
ep12_l1_test_time 3.4749257564544678
Test Epoch12 layer2 Acc 0.9856, AUC 0.9982940554618835, avg_entr 0.0012413813965395093, f1 0.9855999946594238
ep12_l2_test_time 4.836396932601929
Test Epoch12 layer3 Acc 0.9856, AUC 0.9979820251464844, avg_entr 0.0011432268656790257, f1 0.9855999946594238
ep12_l3_test_time 6.115428686141968
Test Epoch12 layer4 Acc 0.9856571428571429, AUC 0.9973502159118652, avg_entr 0.0009964806959033012, f1 0.9856571555137634
ep12_l4_test_time 7.441411256790161
gc 0
Train Epoch13 Acc 0.9946357142857143 (556996/560000), AUC 0.9990190863609314
ep13_train_time 432.9700391292572
Test Epoch13 layer0 Acc 0.9747714285714286, AUC 0.9984948039054871, avg_entr 0.02402922697365284, f1 0.9747714400291443
ep13_l0_test_time 2.334210157394409
Test Epoch13 layer1 Acc 0.9855142857142857, AUC 0.9984091520309448, avg_entr 0.0017057792283594608, f1 0.9855142831802368
ep13_l1_test_time 3.3711352348327637
Test Epoch13 layer2 Acc 0.9858571428571429, AUC 0.9983122944831848, avg_entr 0.0012446444015949965, f1 0.9858571290969849
ep13_l2_test_time 4.535725355148315
Test Epoch13 layer3 Acc 0.9858, AUC 0.9980081915855408, avg_entr 0.0011033931514248252, f1 0.98580002784729
ep13_l3_test_time 6.106395483016968
Test Epoch13 layer4 Acc 0.9857428571428571, AUC 0.997308611869812, avg_entr 0.0010306383483111858, f1 0.9857428669929504
ep13_l4_test_time 7.422457695007324
gc 0
Train Epoch14 Acc 0.9949517857142857 (557173/560000), AUC 0.9990372061729431
ep14_train_time 365.83706879615784
Test Epoch14 layer0 Acc 0.9745428571428572, AUC 0.9984907507896423, avg_entr 0.024009371176362038, f1 0.9745428562164307
ep14_l0_test_time 2.0536446571350098
Test Epoch14 layer1 Acc 0.9854, AUC 0.9982835650444031, avg_entr 0.0017802926013246179, f1 0.9854000210762024
ep14_l1_test_time 3.1763362884521484
Test Epoch14 layer2 Acc 0.9858571428571429, AUC 0.9980823397636414, avg_entr 0.0012552980333566666, f1 0.9858571290969849
ep14_l2_test_time 4.411532402038574
Test Epoch14 layer3 Acc 0.9858, AUC 0.9977613687515259, avg_entr 0.001128072733990848, f1 0.98580002784729
ep14_l3_test_time 5.718122482299805
Test Epoch14 layer4 Acc 0.9857714285714285, AUC 0.9969936013221741, avg_entr 0.0009911909000948071, f1 0.9857714176177979
ep14_l4_test_time 6.800271272659302
gc 0
Train Epoch15 Acc 0.9951089285714285 (557261/560000), AUC 0.9990488886833191
ep15_train_time 403.29184889793396
Test Epoch15 layer0 Acc 0.9749142857142857, AUC 0.9984908699989319, avg_entr 0.024038564413785934, f1 0.9749143123626709
ep15_l0_test_time 2.027242660522461
Test Epoch15 layer1 Acc 0.9854571428571428, AUC 0.9981561303138733, avg_entr 0.001760387560352683, f1 0.9854571223258972
ep15_l1_test_time 3.0276618003845215
Test Epoch15 layer2 Acc 0.9857714285714285, AUC 0.9980124831199646, avg_entr 0.0011693785199895501, f1 0.9857714176177979
ep15_l2_test_time 4.232796907424927
Test Epoch15 layer3 Acc 0.9858, AUC 0.9976714253425598, avg_entr 0.0010107416892424226, f1 0.98580002784729
ep15_l3_test_time 5.283679723739624
Test Epoch15 layer4 Acc 0.9859428571428571, AUC 0.9968786239624023, avg_entr 0.0009269005968235433, f1 0.9859428405761719
ep15_l4_test_time 6.859421730041504
gc 0
Train Epoch16 Acc 0.9952357142857143 (557332/560000), AUC 0.9990251660346985
ep16_train_time 403.71188592910767
Test Epoch16 layer0 Acc 0.9745714285714285, AUC 0.9984904527664185, avg_entr 0.024010319262742996, f1 0.9745714068412781
ep16_l0_test_time 2.0372166633605957
Test Epoch16 layer1 Acc 0.9853714285714286, AUC 0.9981468319892883, avg_entr 0.0017039574449881911, f1 0.9853714108467102
ep16_l1_test_time 3.009335994720459
Test Epoch16 layer2 Acc 0.9856285714285714, AUC 0.9980173110961914, avg_entr 0.0012120192404836416, f1 0.9856285452842712
ep16_l2_test_time 4.430548429489136
Test Epoch16 layer3 Acc 0.9854857142857143, AUC 0.9976478219032288, avg_entr 0.0010640702676028013, f1 0.9854857325553894
ep16_l3_test_time 5.556241035461426
Test Epoch16 layer4 Acc 0.9854857142857143, AUC 0.9968636631965637, avg_entr 0.0010241962736472487, f1 0.9854857325553894
ep16_l4_test_time 6.835352897644043
gc 0
Train Epoch17 Acc 0.9953928571428572 (557420/560000), AUC 0.9990271329879761
ep17_train_time 402.78190517425537
Test Epoch17 layer0 Acc 0.9746, AUC 0.9984939694404602, avg_entr 0.02385256066918373, f1 0.9746000170707703
ep17_l0_test_time 2.021916627883911
Test Epoch17 layer1 Acc 0.9854285714285714, AUC 0.9981192350387573, avg_entr 0.0017102601705119014, f1 0.9854285717010498
ep17_l1_test_time 3.2226943969726562
Test Epoch17 layer2 Acc 0.9857142857142858, AUC 0.9979552626609802, avg_entr 0.0012674045283347368, f1 0.9857142567634583
ep17_l2_test_time 4.388293743133545
Test Epoch17 layer3 Acc 0.9856857142857143, AUC 0.9975799918174744, avg_entr 0.0010759710567072034, f1 0.9856857061386108
ep17_l3_test_time 5.787327289581299
Test Epoch17 layer4 Acc 0.9857142857142858, AUC 0.9966937899589539, avg_entr 0.0009560108883306384, f1 0.9857142567634583
ep17_l4_test_time 6.887979745864868
gc 0
Train Epoch18 Acc 0.9955267857142858 (557495/560000), AUC 0.9990244507789612
ep18_train_time 401.84788489341736
Test Epoch18 layer0 Acc 0.9747428571428571, AUC 0.9984880685806274, avg_entr 0.023925576359033585, f1 0.9747428297996521
ep18_l0_test_time 1.9518606662750244
Test Epoch18 layer1 Acc 0.9854, AUC 0.9980630874633789, avg_entr 0.0017405112739652395, f1 0.9854000210762024
ep18_l1_test_time 3.1416118144989014
Test Epoch18 layer2 Acc 0.9856571428571429, AUC 0.9979208707809448, avg_entr 0.0011537069221958518, f1 0.9856571555137634
ep18_l2_test_time 4.377713680267334
Test Epoch18 layer3 Acc 0.9856857142857143, AUC 0.9975194334983826, avg_entr 0.0011277426965534687, f1 0.9856857061386108
ep18_l3_test_time 5.61313271522522
Test Epoch18 layer4 Acc 0.9856285714285714, AUC 0.9967396855354309, avg_entr 0.0010131478775292635, f1 0.9856285452842712
ep18_l4_test_time 6.960092782974243
gc 0
Train Epoch19 Acc 0.9955928571428572 (557532/560000), AUC 0.9990253448486328
ep19_train_time 401.5096061229706
Test Epoch19 layer0 Acc 0.9747142857142858, AUC 0.998496413230896, avg_entr 0.02394283190369606, f1 0.9747142791748047
ep19_l0_test_time 2.0005741119384766
Test Epoch19 layer1 Acc 0.9853142857142857, AUC 0.9980787634849548, avg_entr 0.0016706078313291073, f1 0.9853143095970154
ep19_l1_test_time 2.9147558212280273
Test Epoch19 layer2 Acc 0.9855142857142857, AUC 0.9978359937667847, avg_entr 0.0011299318866804242, f1 0.9855142831802368
ep19_l2_test_time 4.442871809005737
Test Epoch19 layer3 Acc 0.9854571428571428, AUC 0.9974706768989563, avg_entr 0.0009701402741484344, f1 0.9854571223258972
ep19_l3_test_time 5.609843730926514
Test Epoch19 layer4 Acc 0.9853428571428572, AUC 0.9966670274734497, avg_entr 0.0008936349768191576, f1 0.9853428602218628
ep19_l4_test_time 6.817783832550049
gc 0
Train Epoch20 Acc 0.9956625 (557571/560000), AUC 0.9990334510803223
ep20_train_time 401.5509374141693
Test Epoch20 layer0 Acc 0.9746857142857143, AUC 0.9984944462776184, avg_entr 0.023927316069602966, f1 0.9746857285499573
ep20_l0_test_time 1.9850494861602783
Test Epoch20 layer1 Acc 0.9854, AUC 0.9980489611625671, avg_entr 0.0017415409674867988, f1 0.9854000210762024
ep20_l1_test_time 3.154986619949341
Test Epoch20 layer2 Acc 0.9855142857142857, AUC 0.9979068040847778, avg_entr 0.001162588712759316, f1 0.9855142831802368
ep20_l2_test_time 4.336994171142578
Test Epoch20 layer3 Acc 0.9855428571428572, AUC 0.9974651336669922, avg_entr 0.0010959624778479338, f1 0.9855428338050842
ep20_l3_test_time 5.652325391769409
Test Epoch20 layer4 Acc 0.9854285714285714, AUC 0.996527373790741, avg_entr 0.0009145609219558537, f1 0.9854285717010498
ep20_l4_test_time 6.904756784439087
gc 0
Train Epoch21 Acc 0.9957 (557592/560000), AUC 0.9990227818489075
ep21_train_time 400.8468511104584
Test Epoch21 layer0 Acc 0.9746571428571429, AUC 0.9984949231147766, avg_entr 0.023939337581396103, f1 0.9746571183204651
ep21_l0_test_time 1.971912145614624
Test Epoch21 layer1 Acc 0.9854285714285714, AUC 0.9980279207229614, avg_entr 0.0016101670917123556, f1 0.9854285717010498
ep21_l1_test_time 2.9513940811157227
Test Epoch21 layer2 Acc 0.9854285714285714, AUC 0.9978336691856384, avg_entr 0.0011193790705874562, f1 0.9854285717010498
ep21_l2_test_time 4.348520040512085
Test Epoch21 layer3 Acc 0.9854571428571428, AUC 0.9974371194839478, avg_entr 0.001038645743392408, f1 0.9854571223258972
ep21_l3_test_time 5.6935296058654785
Test Epoch21 layer4 Acc 0.9853714285714286, AUC 0.9965430498123169, avg_entr 0.0009597386233508587, f1 0.9853714108467102
ep21_l4_test_time 6.909957647323608
gc 0
Train Epoch22 Acc 0.9957910714285715 (557643/560000), AUC 0.9990246891975403
ep22_train_time 403.4028298854828
Test Epoch22 layer0 Acc 0.9745714285714285, AUC 0.9984937310218811, avg_entr 0.02394448220729828, f1 0.9745714068412781
ep22_l0_test_time 1.9427356719970703
Test Epoch22 layer1 Acc 0.9853142857142857, AUC 0.9979737401008606, avg_entr 0.0016692543867975473, f1 0.9853143095970154
ep22_l1_test_time 3.1485488414764404
Test Epoch22 layer2 Acc 0.9855428571428572, AUC 0.9977068305015564, avg_entr 0.0011559444246813655, f1 0.9855428338050842
ep22_l2_test_time 4.45913553237915
Test Epoch22 layer3 Acc 0.9852571428571428, AUC 0.9972804188728333, avg_entr 0.0010115837212651968, f1 0.9852571487426758
ep22_l3_test_time 5.640458345413208
Test Epoch22 layer4 Acc 0.9853142857142857, AUC 0.9964398741722107, avg_entr 0.0009487348143011332, f1 0.9853143095970154
ep22_l4_test_time 6.731004953384399
gc 0
Train Epoch23 Acc 0.9958285714285714 (557664/560000), AUC 0.9990283846855164
ep23_train_time 401.6851341724396
Test Epoch23 layer0 Acc 0.9746285714285714, AUC 0.9984921216964722, avg_entr 0.02391485497355461, f1 0.9746285676956177
ep23_l0_test_time 1.9788310527801514
Test Epoch23 layer1 Acc 0.9853142857142857, AUC 0.9979656934738159, avg_entr 0.0015889178030192852, f1 0.9853143095970154
ep23_l1_test_time 3.115131378173828
Test Epoch23 layer2 Acc 0.9854, AUC 0.9977442622184753, avg_entr 0.0011565765598788857, f1 0.9854000210762024
ep23_l2_test_time 4.357559442520142
Test Epoch23 layer3 Acc 0.9854, AUC 0.9972992539405823, avg_entr 0.0010015986626967788, f1 0.9854000210762024
ep23_l3_test_time 5.666646242141724
Test Epoch23 layer4 Acc 0.9854285714285714, AUC 0.9963746666908264, avg_entr 0.0008910991018638015, f1 0.9854285717010498
ep23_l4_test_time 6.83445405960083
gc 0
Train Epoch24 Acc 0.9958607142857143 (557682/560000), AUC 0.9990228414535522
ep24_train_time 354.2010073661804
Test Epoch24 layer0 Acc 0.9746285714285714, AUC 0.9984907507896423, avg_entr 0.023979611694812775, f1 0.9746285676956177
ep24_l0_test_time 1.5500411987304688
Test Epoch24 layer1 Acc 0.9851428571428571, AUC 0.9979521632194519, avg_entr 0.0016781298909336329, f1 0.9851428866386414
ep24_l1_test_time 2.3453869819641113
Test Epoch24 layer2 Acc 0.9854571428571428, AUC 0.9977090954780579, avg_entr 0.0012087954673916101, f1 0.9854571223258972
ep24_l2_test_time 3.7523717880249023
Test Epoch24 layer3 Acc 0.9853142857142857, AUC 0.9972690939903259, avg_entr 0.001066801487468183, f1 0.9853143095970154
ep24_l3_test_time 4.5694780349731445
Test Epoch24 layer4 Acc 0.9853714285714286, AUC 0.9963653683662415, avg_entr 0.000990738975815475, f1 0.9853714108467102
ep24_l4_test_time 5.799492120742798
gc 0
Train Epoch25 Acc 0.9958964285714286 (557702/560000), AUC 0.999025821685791
ep25_train_time 356.46829891204834
Test Epoch25 layer0 Acc 0.9746571428571429, AUC 0.9984926581382751, avg_entr 0.02391546405851841, f1 0.9746571183204651
ep25_l0_test_time 1.1522889137268066
Test Epoch25 layer1 Acc 0.9851714285714286, AUC 0.9979292154312134, avg_entr 0.0016866930527612567, f1 0.9851714372634888
ep25_l1_test_time 1.935013771057129
Test Epoch25 layer2 Acc 0.9852857142857143, AUC 0.9976695775985718, avg_entr 0.0011865267297253013, f1 0.9852856993675232
ep25_l2_test_time 2.9207024574279785
Test Epoch25 layer3 Acc 0.9853428571428572, AUC 0.9972502589225769, avg_entr 0.0010542577365413308, f1 0.9853428602218628
ep25_l3_test_time 3.866272449493408
Test Epoch25 layer4 Acc 0.9853142857142857, AUC 0.9963319897651672, avg_entr 0.0009744465351104736, f1 0.9853143095970154
ep25_l4_test_time 4.800702810287476
gc 0
Train Epoch26 Acc 0.9959178571428572 (557714/560000), AUC 0.9990283250808716
ep26_train_time 275.2302224636078
Test Epoch26 layer0 Acc 0.9746857142857143, AUC 0.9984908103942871, avg_entr 0.023901211097836494, f1 0.9746857285499573
ep26_l0_test_time 1.2089617252349854
Test Epoch26 layer1 Acc 0.9852, AUC 0.9979237914085388, avg_entr 0.0016381560126319528, f1 0.9851999878883362
ep26_l1_test_time 1.9349613189697266
Test Epoch26 layer2 Acc 0.9853142857142857, AUC 0.9976820945739746, avg_entr 0.0012259602081030607, f1 0.9853143095970154
ep26_l2_test_time 2.898699998855591
Test Epoch26 layer3 Acc 0.9853428571428572, AUC 0.9971946477890015, avg_entr 0.0010326714254915714, f1 0.9853428602218628
ep26_l3_test_time 3.024183988571167
Test Epoch26 layer4 Acc 0.9853714285714286, AUC 0.9962725043296814, avg_entr 0.000941810489166528, f1 0.9853714108467102
ep26_l4_test_time 4.763071537017822
gc 0
Train Epoch27 Acc 0.9959482142857143 (557731/560000), AUC 0.9990288615226746
ep27_train_time 275.2251124382019
Test Epoch27 layer0 Acc 0.9746, AUC 0.9984908699989319, avg_entr 0.023876719176769257, f1 0.9746000170707703
ep27_l0_test_time 1.1785292625427246
Test Epoch27 layer1 Acc 0.9852, AUC 0.9979320168495178, avg_entr 0.0016218475066125393, f1 0.9851999878883362
ep27_l1_test_time 1.7425942420959473
Test Epoch27 layer2 Acc 0.9852285714285715, AUC 0.9976760745048523, avg_entr 0.0012409199262037873, f1 0.9852285981178284
ep27_l2_test_time 2.423293113708496
Test Epoch27 layer3 Acc 0.9851714285714286, AUC 0.997181236743927, avg_entr 0.001064741751179099, f1 0.9851714372634888
ep27_l3_test_time 3.20320463180542
Test Epoch27 layer4 Acc 0.9852571428571428, AUC 0.9962720274925232, avg_entr 0.0009503448382019997, f1 0.9852571487426758
ep27_l4_test_time 3.96317720413208
gc 0
Train Epoch28 Acc 0.9959625 (557739/560000), AUC 0.9990271925926208
ep28_train_time 252.55172610282898
Test Epoch28 layer0 Acc 0.9746285714285714, AUC 0.998492419719696, avg_entr 0.023889174684882164, f1 0.9746285676956177
ep28_l0_test_time 0.8569982051849365
Test Epoch28 layer1 Acc 0.9853142857142857, AUC 0.9979165196418762, avg_entr 0.001605456112883985, f1 0.9853143095970154
ep28_l1_test_time 1.4320383071899414
Test Epoch28 layer2 Acc 0.9852857142857143, AUC 0.9976633787155151, avg_entr 0.001195981982164085, f1 0.9852856993675232
ep28_l2_test_time 2.15487003326416
Test Epoch28 layer3 Acc 0.9852571428571428, AUC 0.9971853494644165, avg_entr 0.001006344915367663, f1 0.9852571487426758
ep28_l3_test_time 2.788337469100952
Test Epoch28 layer4 Acc 0.9852857142857143, AUC 0.99628084897995, avg_entr 0.0009382077842019498, f1 0.9852856993675232
ep28_l4_test_time 3.5118794441223145
gc 0
Train Epoch29 Acc 0.9959571428571429 (557736/560000), AUC 0.9990275502204895
ep29_train_time 215.48242259025574
Test Epoch29 layer0 Acc 0.9746857142857143, AUC 0.9984917044639587, avg_entr 0.023907747119665146, f1 0.9746857285499573
ep29_l0_test_time 0.8476207256317139
Test Epoch29 layer1 Acc 0.9852571428571428, AUC 0.9979096055030823, avg_entr 0.001586500438861549, f1 0.9852571487426758
ep29_l1_test_time 1.4491214752197266
Test Epoch29 layer2 Acc 0.9852571428571428, AUC 0.9977006316184998, avg_entr 0.0011768891708925366, f1 0.9852571487426758
ep29_l2_test_time 2.1519901752471924
Test Epoch29 layer3 Acc 0.9853428571428572, AUC 0.9971644282341003, avg_entr 0.0009502203902229667, f1 0.9853428602218628
ep29_l3_test_time 2.8094916343688965
Test Epoch29 layer4 Acc 0.9853142857142857, AUC 0.9962648153305054, avg_entr 0.0009097136789932847, f1 0.9853143095970154
ep29_l4_test_time 3.4513986110687256
Best AUC tensor(0.9862) 8 2
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 12382.489425897598
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5_pad80//dbpedia_14_lstmal_l5.pt
Test layer0 Acc 0.9746, AUC 0.9983379244804382, avg_entr 0.023989403620362282, f1 0.9746000170707703
l0_test_time 0.8399596214294434
Test layer1 Acc 0.9854857142857143, AUC 0.9988043904304504, avg_entr 0.002111781621351838, f1 0.9854857325553894
l1_test_time 1.4732024669647217
Test layer2 Acc 0.9856857142857143, AUC 0.9988152384757996, avg_entr 0.0016447470989078283, f1 0.9856857061386108
l2_test_time 2.228710174560547
Test layer3 Acc 0.9856571428571429, AUC 0.9981252551078796, avg_entr 0.00139453518204391, f1 0.9856571555137634
l3_test_time 2.7947018146514893
Test layer4 Acc 0.9855714285714285, AUC 0.997925877571106, avg_entr 0.0013328613713383675, f1 0.9855714440345764
l4_test_time 3.4870851039886475
