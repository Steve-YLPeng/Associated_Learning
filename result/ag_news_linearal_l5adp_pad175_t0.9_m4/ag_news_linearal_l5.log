total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.9_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.188175 (22581/120000), AUC 0.5170130729675293
ep0_train_time 10.084038019180298
Test Epoch0 threshold 0.9 Acc 0.9172697368421052, AUC 0.9807630181312561, avg_entr 0.02536979503929615
ep0_t0.9_test_time 0.26253557205200195
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.23995833333333333 (28795/120000), AUC 0.5222522020339966
ep1_train_time 9.650206089019775
Test Epoch1 threshold 0.9 Acc 0.9166118421052631, AUC 0.9807257652282715, avg_entr 0.026119232177734375
ep1_t0.9_test_time 0.2622873783111572
gc 0
Train Epoch2 Acc 0.2654416666666667 (31853/120000), AUC 0.5583105087280273
ep2_train_time 9.635120868682861
Test Epoch2 threshold 0.9 Acc 0.9164473684210527, AUC 0.9805521965026855, avg_entr 0.02530640736222267
ep2_t0.9_test_time 0.26279664039611816
gc 0
Train Epoch3 Acc 0.3705 (44460/120000), AUC 0.6256697773933411
ep3_train_time 9.656915426254272
Test Epoch3 threshold 0.9 Acc 0.9159539473684211, AUC 0.9802907705307007, avg_entr 0.026542512699961662
ep3_t0.9_test_time 0.2621481418609619
gc 0
Train Epoch4 Acc 0.41859166666666664 (50231/120000), AUC 0.6438429355621338
ep4_train_time 9.72124171257019
Test Epoch4 threshold 0.9 Acc 0.9120065789473685, AUC 0.9803283214569092, avg_entr 0.02666252851486206
ep4_t0.9_test_time 0.27196669578552246
gc 0
Train Epoch5 Acc 0.42175833333333335 (50611/120000), AUC 0.6516376733779907
ep5_train_time 9.715779781341553
Test Epoch5 threshold 0.9 Acc 0.9134868421052632, AUC 0.980144739151001, avg_entr 0.02626160904765129
ep5_t0.9_test_time 0.2614145278930664
gc 0
Train Epoch6 Acc 0.4216083333333333 (50593/120000), AUC 0.6570941209793091
ep6_train_time 9.71686315536499
Test Epoch6 threshold 0.9 Acc 0.9139802631578947, AUC 0.9800524115562439, avg_entr 0.026417002081871033
ep6_t0.9_test_time 0.2617917060852051
gc 0
Train Epoch7 Acc 0.42090833333333333 (50509/120000), AUC 0.6623485088348389
ep7_train_time 9.708287000656128
Test Epoch7 threshold 0.9 Acc 0.9148026315789474, AUC 0.9799802303314209, avg_entr 0.02592957206070423
ep7_t0.9_test_time 0.26142358779907227
gc 0
Train Epoch8 Acc 0.42005 (50406/120000), AUC 0.6671953201293945
ep8_train_time 9.593982219696045
Test Epoch8 threshold 0.9 Acc 0.9148026315789474, AUC 0.9798603057861328, avg_entr 0.026239555329084396
ep8_t0.9_test_time 0.26212191581726074
gc 0
Train Epoch9 Acc 0.41984166666666667 (50381/120000), AUC 0.6711568832397461
ep9_train_time 9.62724781036377
Test Epoch9 threshold 0.9 Acc 0.9136513157894737, AUC 0.9797899127006531, avg_entr 0.025843560695648193
ep9_t0.9_test_time 0.2611989974975586
Best AUC 0.9807630181312561
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.9_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9217105263157894, AUC 0.9862744808197021, avg_entr 0.024827400222420692
t0.9_test_time 0.06574130058288574
