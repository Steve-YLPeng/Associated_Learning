total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 48937892
init_time 16.464842527
Start Training
gc 0
Train Epoch0 Acc 0.2542 (30504/120000), AUC 0.5017964243888855
ep0_train_time 12.6965501
Test Epoch0 layer0 Acc 0.7113157894736842, AUC 0.9020529389381409, avg_entr 0.8396510481834412, f1 0.7113158106803894
ep0_l0_test_time 0.06505799400000001
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7118421052631579, AUC 0.8881604671478271, avg_entr 0.7584471106529236, f1 0.7118421792984009
ep0_l1_test_time 0.07443680199999747
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.6560526315789473, AUC 0.8717948794364929, avg_entr 0.8678482174873352, f1 0.6560526490211487
ep0_l2_test_time 0.08545289499999953
Test Epoch0 layer3 Acc 0.2594736842105263, AUC 0.589779794216156, avg_entr 1.2343685626983643, f1 0.25947368144989014
ep0_l3_test_time 0.09533469300000164
Test Epoch0 layer4 Acc 0.2513157894736842, AUC 0.45132461190223694, avg_entr 1.2330211400985718, f1 0.25131580233573914
ep0_l4_test_time 0.11423922400000208
gc 0
Train Epoch1 Acc 0.6752666666666667 (81032/120000), AUC 0.8840600848197937
ep1_train_time 12.491625789
Test Epoch1 layer0 Acc 0.8136842105263158, AUC 0.9508740901947021, avg_entr 0.38086748123168945, f1 0.8136842250823975
ep1_l0_test_time 0.06341580600000185
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8239473684210527, AUC 0.9584364295005798, avg_entr 0.29933539032936096, f1 0.8239473700523376
ep1_l1_test_time 0.07173261500000194
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8205263157894737, AUC 0.9537672996520996, avg_entr 0.2745102345943451, f1 0.8205263018608093
ep1_l2_test_time 0.08728876700000399
Test Epoch1 layer3 Acc 0.8213157894736842, AUC 0.9535046219825745, avg_entr 0.2712516784667969, f1 0.8213157653808594
ep1_l3_test_time 0.09579640900000186
Test Epoch1 layer4 Acc 0.8221052631578948, AUC 0.9475633502006531, avg_entr 0.26239442825317383, f1 0.8221052885055542
ep1_l4_test_time 0.11460466100000133
gc 0
Train Epoch2 Acc 0.8733166666666666 (104798/120000), AUC 0.9612915515899658
ep2_train_time 12.612694736000002
Test Epoch2 layer0 Acc 0.8471052631578947, AUC 0.9618434906005859, avg_entr 0.23805326223373413, f1 0.8471052646636963
ep2_l0_test_time 0.0631555370000001
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8647368421052631, AUC 0.9699215888977051, avg_entr 0.18414808809757233, f1 0.8647368550300598
ep2_l1_test_time 0.07797240800000083
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.865, AUC 0.9679206609725952, avg_entr 0.16596724092960358, f1 0.8650000095367432
ep2_l2_test_time 0.08773255899999555
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8660526315789474, AUC 0.9666088819503784, avg_entr 0.15194199979305267, f1 0.8660526275634766
ep2_l3_test_time 0.09993411700000365
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer4 Acc 0.865, AUC 0.9628000259399414, avg_entr 0.145013689994812, f1 0.8650000095367432
ep2_l4_test_time 0.11905987000000096
gc 0
Train Epoch3 Acc 0.8985833333333333 (107830/120000), AUC 0.9721083641052246
ep3_train_time 12.546637869999998
Test Epoch3 layer0 Acc 0.841842105263158, AUC 0.960736870765686, avg_entr 0.15352876484394073, f1 0.8418421149253845
ep3_l0_test_time 0.06318582299999775
Test Epoch3 layer1 Acc 0.8568421052631578, AUC 0.9678025841712952, avg_entr 0.12019465118646622, f1 0.8568421006202698
ep3_l1_test_time 0.06895413399999484
Test Epoch3 layer2 Acc 0.855, AUC 0.96778404712677, avg_entr 0.11518773436546326, f1 0.8550000190734863
ep3_l2_test_time 0.0804370669999912
Test Epoch3 layer3 Acc 0.8560526315789474, AUC 0.9673012495040894, avg_entr 0.11534539610147476, f1 0.8560526371002197
ep3_l3_test_time 0.09571710199999472
Test Epoch3 layer4 Acc 0.8563157894736843, AUC 0.9668747186660767, avg_entr 0.11215820163488388, f1 0.8563157916069031
ep3_l4_test_time 0.11439272100000153
gc 0
Train Epoch4 Acc 0.917325 (110079/120000), AUC 0.9783381223678589
ep4_train_time 12.678404100999998
Test Epoch4 layer0 Acc 0.8523684210526316, AUC 0.9649304747581482, avg_entr 0.11855485290288925, f1 0.8523684144020081
ep4_l0_test_time 0.06339098099999774
Test Epoch4 layer1 Acc 0.875, AUC 0.9722739458084106, avg_entr 0.09089300036430359, f1 0.875
ep4_l1_test_time 0.06891805000000772
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8742105263157894, AUC 0.9712960124015808, avg_entr 0.08700508624315262, f1 0.87421053647995
ep4_l2_test_time 0.08872525300000689
Test Epoch4 layer3 Acc 0.8736842105263158, AUC 0.9695090055465698, avg_entr 0.08455269783735275, f1 0.8736842274665833
ep4_l3_test_time 0.09558942600000364
Test Epoch4 layer4 Acc 0.8723684210526316, AUC 0.968464732170105, avg_entr 0.08577832579612732, f1 0.8723683953285217
ep4_l4_test_time 0.11438612999999975
gc 0
Train Epoch5 Acc 0.9301166666666667 (111614/120000), AUC 0.981826901435852
ep5_train_time 12.678282814
Test Epoch5 layer0 Acc 0.8531578947368421, AUC 0.96544349193573, avg_entr 0.09490789473056793, f1 0.8531579375267029
ep5_l0_test_time 0.0630483430000055
Test Epoch5 layer1 Acc 0.875, AUC 0.9717179536819458, avg_entr 0.07246504724025726, f1 0.875
ep5_l1_test_time 0.069094561
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.8755263157894737, AUC 0.9701907634735107, avg_entr 0.06414011120796204, f1 0.8755263090133667
ep5_l2_test_time 0.08798968500001081
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer3 Acc 0.8739473684210526, AUC 0.9686673283576965, avg_entr 0.06146392598748207, f1 0.8739473819732666
ep5_l3_test_time 0.10745522099999505
Test Epoch5 layer4 Acc 0.8744736842105263, AUC 0.964969277381897, avg_entr 0.0586891695857048, f1 0.8744736909866333
ep5_l4_test_time 0.11503892899999357
gc 0
Train Epoch6 Acc 0.939525 (112743/120000), AUC 0.9849252700805664
ep6_train_time 12.66260318900001
Test Epoch6 layer0 Acc 0.853421052631579, AUC 0.9647486209869385, avg_entr 0.08139930665493011, f1 0.8534210324287415
ep6_l0_test_time 0.06331932700000209
Test Epoch6 layer1 Acc 0.87, AUC 0.9692922830581665, avg_entr 0.058902837336063385, f1 0.8700000047683716
ep6_l1_test_time 0.06898110499999177
Test Epoch6 layer2 Acc 0.8689473684210526, AUC 0.9693394899368286, avg_entr 0.052880123257637024, f1 0.8689473867416382
ep6_l2_test_time 0.08035210900000322
Test Epoch6 layer3 Acc 0.87, AUC 0.9670950770378113, avg_entr 0.04999098554253578, f1 0.8700000047683716
ep6_l3_test_time 0.0953098930000067
Test Epoch6 layer4 Acc 0.8689473684210526, AUC 0.9656885862350464, avg_entr 0.04795943945646286, f1 0.8689473867416382
ep6_l4_test_time 0.11592752700001085
gc 0
Train Epoch7 Acc 0.9487583333333334 (113851/120000), AUC 0.9868658185005188
ep7_train_time 12.569749325999993
Test Epoch7 layer0 Acc 0.8563157894736843, AUC 0.9649183750152588, avg_entr 0.06810451298952103, f1 0.8563157916069031
ep7_l0_test_time 0.06310671600000717
Test Epoch7 layer1 Acc 0.876578947368421, AUC 0.972766101360321, avg_entr 0.044883038848638535, f1 0.8765789270401001
ep7_l1_test_time 0.06905480499999328
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer2 Acc 0.8778947368421053, AUC 0.9706947803497314, avg_entr 0.036965541541576385, f1 0.8778947591781616
ep7_l2_test_time 0.08882452299999954
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer3 Acc 0.8773684210526316, AUC 0.9681869745254517, avg_entr 0.035954490303993225, f1 0.8773684501647949
ep7_l3_test_time 0.10222761200000718
Test Epoch7 layer4 Acc 0.8773684210526316, AUC 0.9666673541069031, avg_entr 0.03443221002817154, f1 0.8773684501647949
ep7_l4_test_time 0.11435652699999821
gc 0
Train Epoch8 Acc 0.95545 (114654/120000), AUC 0.9883114099502563
ep8_train_time 12.757355488000002
Test Epoch8 layer0 Acc 0.8571052631578947, AUC 0.9638118743896484, avg_entr 0.05843406170606613, f1 0.8571051955223083
ep8_l0_test_time 0.06372461800000906
Test Epoch8 layer1 Acc 0.8726315789473684, AUC 0.9672995805740356, avg_entr 0.03985009714961052, f1 0.8726315498352051
ep8_l1_test_time 0.06895505100001742
Test Epoch8 layer2 Acc 0.8736842105263158, AUC 0.9675137996673584, avg_entr 0.03464726731181145, f1 0.8736842274665833
ep8_l2_test_time 0.08039176400001224
Test Epoch8 layer3 Acc 0.8747368421052631, AUC 0.9660382270812988, avg_entr 0.033794235438108444, f1 0.8747368454933167
ep8_l3_test_time 0.09567707299999029
Test Epoch8 layer4 Acc 0.8744736842105263, AUC 0.9653207659721375, avg_entr 0.031743139028549194, f1 0.8744736909866333
ep8_l4_test_time 0.11475701899999535
gc 0
Train Epoch9 Acc 0.9617666666666667 (115412/120000), AUC 0.9906405210494995
ep9_train_time 12.56679584600002
Test Epoch9 layer0 Acc 0.8621052631578947, AUC 0.9640284776687622, avg_entr 0.04796740040183067, f1 0.8621052503585815
ep9_l0_test_time 0.06401927100000648
Test Epoch9 layer1 Acc 0.876578947368421, AUC 0.9708285331726074, avg_entr 0.037282321602106094, f1 0.8765789270401001
ep9_l1_test_time 0.0694035719999988
Test Epoch9 layer2 Acc 0.8794736842105263, AUC 0.9715684056282043, avg_entr 0.0357176810503006, f1 0.8794736862182617
ep9_l2_test_time 0.08034374999999727
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer3 Acc 0.8797368421052632, AUC 0.9699512124061584, avg_entr 0.0361090824007988, f1 0.8797368407249451
ep9_l3_test_time 0.10389274700000328
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer4 Acc 0.8805263157894737, AUC 0.9694379568099976, avg_entr 0.03430303931236267, f1 0.8805263042449951
ep9_l4_test_time 0.13129895299999816
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.96935 (116322/120000), AUC 0.9922181367874146
ep10_train_time 12.673290860999998
Test Epoch10 layer0 Acc 0.8568421052631578, AUC 0.9623236656188965, avg_entr 0.0416395477950573, f1 0.8568421006202698
ep10_l0_test_time 0.06342732100000603
Test Epoch10 layer1 Acc 0.8731578947368421, AUC 0.9660800695419312, avg_entr 0.025133827701210976, f1 0.8731579184532166
ep10_l1_test_time 0.06960909500000412
Test Epoch10 layer2 Acc 0.8742105263157894, AUC 0.9675639867782593, avg_entr 0.022120032459497452, f1 0.87421053647995
ep10_l2_test_time 0.08058656999997993
Test Epoch10 layer3 Acc 0.8728947368421053, AUC 0.9675222635269165, avg_entr 0.02149651013314724, f1 0.8728947639465332
ep10_l3_test_time 0.09615545000002612
Test Epoch10 layer4 Acc 0.8726315789473684, AUC 0.9659605622291565, avg_entr 0.020607363432645798, f1 0.8726315498352051
ep10_l4_test_time 0.11499413800001435
gc 0
Train Epoch11 Acc 0.9737916666666667 (116855/120000), AUC 0.9927074909210205
ep11_train_time 12.653738328000003
Test Epoch11 layer0 Acc 0.8536842105263158, AUC 0.9584808349609375, avg_entr 0.03578238934278488, f1 0.8536841869354248
ep11_l0_test_time 0.06315886500001966
Test Epoch11 layer1 Acc 0.8723684210526316, AUC 0.9609143733978271, avg_entr 0.0222972109913826, f1 0.8723683953285217
ep11_l1_test_time 0.06964155500000402
Test Epoch11 layer2 Acc 0.8736842105263158, AUC 0.9620400667190552, avg_entr 0.018983367830514908, f1 0.8736842274665833
ep11_l2_test_time 0.08072943199999827
Test Epoch11 layer3 Acc 0.8726315789473684, AUC 0.958729088306427, avg_entr 0.018435239791870117, f1 0.8726315498352051
ep11_l3_test_time 0.09529963900001803
Test Epoch11 layer4 Acc 0.8739473684210526, AUC 0.9565451145172119, avg_entr 0.017759373411536217, f1 0.8739473819732666
ep11_l4_test_time 0.1145738129999927
gc 0
Train Epoch12 Acc 0.9771583333333334 (117259/120000), AUC 0.9933112859725952
ep12_train_time 12.615883991000004
Test Epoch12 layer0 Acc 0.8581578947368421, AUC 0.9562016129493713, avg_entr 0.033674415200948715, f1 0.8581578731536865
ep12_l0_test_time 0.0629624940000042
Test Epoch12 layer1 Acc 0.8739473684210526, AUC 0.9606344699859619, avg_entr 0.020809009671211243, f1 0.8739473819732666
ep12_l1_test_time 0.06905437599999686
Test Epoch12 layer2 Acc 0.8763157894736842, AUC 0.9635014533996582, avg_entr 0.017749253660440445, f1 0.8763157725334167
ep12_l2_test_time 0.08023412600002189
Test Epoch12 layer3 Acc 0.8752631578947369, AUC 0.9640868902206421, avg_entr 0.018253978341817856, f1 0.8752631545066833
ep12_l3_test_time 0.09552326200000039
Test Epoch12 layer4 Acc 0.8752631578947369, AUC 0.9636509418487549, avg_entr 0.017356636002659798, f1 0.8752631545066833
ep12_l4_test_time 0.11460017100000641
gc 0
Train Epoch13 Acc 0.9777833333333333 (117334/120000), AUC 0.992914080619812
ep13_train_time 12.575021334000013
Test Epoch13 layer0 Acc 0.855, AUC 0.9528282880783081, avg_entr 0.03093346767127514, f1 0.8550000190734863
ep13_l0_test_time 0.06311632599999939
Test Epoch13 layer1 Acc 0.8673684210526316, AUC 0.9592160582542419, avg_entr 0.02091926522552967, f1 0.8673684000968933
ep13_l1_test_time 0.06914715499999602
Test Epoch13 layer2 Acc 0.8676315789473684, AUC 0.9616009593009949, avg_entr 0.01689578779041767, f1 0.8676315546035767
ep13_l2_test_time 0.08048331499998085
Test Epoch13 layer3 Acc 0.8689473684210526, AUC 0.9604090452194214, avg_entr 0.016021082177758217, f1 0.8689473867416382
ep13_l3_test_time 0.09568492200000378
Test Epoch13 layer4 Acc 0.8692105263157894, AUC 0.9580317735671997, avg_entr 0.015757884830236435, f1 0.8692105412483215
ep13_l4_test_time 0.11469037399999138
gc 0
Train Epoch14 Acc 0.9779416666666667 (117353/120000), AUC 0.9920520782470703
ep14_train_time 12.532813344000004
Test Epoch14 layer0 Acc 0.8552631578947368, AUC 0.954637885093689, avg_entr 0.03046492487192154, f1 0.8552631735801697
ep14_l0_test_time 0.06325747899998646
Test Epoch14 layer1 Acc 0.8657894736842106, AUC 0.9561846256256104, avg_entr 0.019823720678687096, f1 0.8657894730567932
ep14_l1_test_time 0.06880029000001286
Test Epoch14 layer2 Acc 0.8676315789473684, AUC 0.9585621356964111, avg_entr 0.014602079056203365, f1 0.8676315546035767
ep14_l2_test_time 0.08040483299998868
Test Epoch14 layer3 Acc 0.8686842105263158, AUC 0.9588440656661987, avg_entr 0.014327478595077991, f1 0.8686841726303101
ep14_l3_test_time 0.09554800999998747
Test Epoch14 layer4 Acc 0.868421052631579, AUC 0.9574142694473267, avg_entr 0.013359029777348042, f1 0.8684210777282715
ep14_l4_test_time 0.11449633000000858
gc 0
Train Epoch15 Acc 0.9804166666666667 (117650/120000), AUC 0.9931076765060425
ep15_train_time 12.67508946800001
Test Epoch15 layer0 Acc 0.8563157894736843, AUC 0.9524393081665039, avg_entr 0.028684763237833977, f1 0.8563157916069031
ep15_l0_test_time 0.0633709720000013
Test Epoch15 layer1 Acc 0.8705263157894737, AUC 0.9530981779098511, avg_entr 0.015476075932383537, f1 0.8705263137817383
ep15_l1_test_time 0.0695884779999858
Test Epoch15 layer2 Acc 0.8731578947368421, AUC 0.9550254940986633, avg_entr 0.01281601283699274, f1 0.8731579184532166
ep15_l2_test_time 0.08078638300000307
Test Epoch15 layer3 Acc 0.8739473684210526, AUC 0.9507574439048767, avg_entr 0.013759110122919083, f1 0.8739473819732666
ep15_l3_test_time 0.09519880900000999
Test Epoch15 layer4 Acc 0.8739473684210526, AUC 0.9506928324699402, avg_entr 0.01360844261944294, f1 0.8739473819732666
ep15_l4_test_time 0.11452008899999555
gc 0
Train Epoch16 Acc 0.9826583333333333 (117919/120000), AUC 0.9935612082481384
ep16_train_time 12.784511479000003
Test Epoch16 layer0 Acc 0.8521052631578947, AUC 0.9506734609603882, avg_entr 0.025455530732870102, f1 0.8521052598953247
ep16_l0_test_time 0.06372035199999004
Test Epoch16 layer1 Acc 0.8628947368421053, AUC 0.95272296667099, avg_entr 0.018342528492212296, f1 0.8628947138786316
ep16_l1_test_time 0.06912859599998455
Test Epoch16 layer2 Acc 0.8668421052631579, AUC 0.955554723739624, avg_entr 0.012907943688333035, f1 0.8668420910835266
ep16_l2_test_time 0.08044322599999987
Test Epoch16 layer3 Acc 0.8660526315789474, AUC 0.9533722400665283, avg_entr 0.012235207483172417, f1 0.8660526275634766
ep16_l3_test_time 0.09553207499999417
Test Epoch16 layer4 Acc 0.8660526315789474, AUC 0.9523061513900757, avg_entr 0.011296209879219532, f1 0.8660526275634766
ep16_l4_test_time 0.11441036799999438
gc 0
Train Epoch17 Acc 0.9815416666666666 (117785/120000), AUC 0.992437481880188
ep17_train_time 12.607977208000023
Test Epoch17 layer0 Acc 0.8555263157894737, AUC 0.9496390223503113, avg_entr 0.027269965037703514, f1 0.855526328086853
ep17_l0_test_time 0.06405408199998419
Test Epoch17 layer1 Acc 0.8657894736842106, AUC 0.9494529962539673, avg_entr 0.013281437568366528, f1 0.8657894730567932
ep17_l1_test_time 0.0695806800000014
Test Epoch17 layer2 Acc 0.8660526315789474, AUC 0.95330810546875, avg_entr 0.00980206485837698, f1 0.8660526275634766
ep17_l2_test_time 0.08059013299998696
Test Epoch17 layer3 Acc 0.866578947368421, AUC 0.9504655003547668, avg_entr 0.01009132619947195, f1 0.8665789365768433
ep17_l3_test_time 0.09543306099999427
Test Epoch17 layer4 Acc 0.8673684210526316, AUC 0.9498381614685059, avg_entr 0.009814904071390629, f1 0.8673684000968933
ep17_l4_test_time 0.11425571199998785
gc 0
Train Epoch18 Acc 0.979925 (117591/120000), AUC 0.9909479022026062
ep18_train_time 12.676120641000011
Test Epoch18 layer0 Acc 0.8536842105263158, AUC 0.9468571543693542, avg_entr 0.02477388270199299, f1 0.8536841869354248
ep18_l0_test_time 0.06483854900000097
Test Epoch18 layer1 Acc 0.863421052631579, AUC 0.949093222618103, avg_entr 0.013473382219672203, f1 0.8634210228919983
ep18_l1_test_time 0.06892214800001284
Test Epoch18 layer2 Acc 0.8636842105263158, AUC 0.9515661001205444, avg_entr 0.010476323775947094, f1 0.8636842370033264
ep18_l2_test_time 0.08100361500004283
Test Epoch18 layer3 Acc 0.8647368421052631, AUC 0.9490711688995361, avg_entr 0.010854782536625862, f1 0.8647368550300598
ep18_l3_test_time 0.09581897599997546
Test Epoch18 layer4 Acc 0.8647368421052631, AUC 0.9478608965873718, avg_entr 0.010733848437666893, f1 0.8647368550300598
ep18_l4_test_time 0.11433421599997473
gc 0
Train Epoch19 Acc 0.97995 (117594/120000), AUC 0.9908421635627747
ep19_train_time 12.63062041400002
Test Epoch19 layer0 Acc 0.8510526315789474, AUC 0.9473625421524048, avg_entr 0.02305593341588974, f1 0.8510526418685913
ep19_l0_test_time 0.06340048999999226
Test Epoch19 layer1 Acc 0.8581578947368421, AUC 0.945931077003479, avg_entr 0.013922632671892643, f1 0.8581578731536865
ep19_l1_test_time 0.06911710900004664
Test Epoch19 layer2 Acc 0.8621052631578947, AUC 0.9476304054260254, avg_entr 0.011580990627408028, f1 0.8621052503585815
ep19_l2_test_time 0.08165934900000593
Test Epoch19 layer3 Acc 0.8605263157894737, AUC 0.944320023059845, avg_entr 0.01120315957814455, f1 0.8605263233184814
ep19_l3_test_time 0.0959037010000543
Test Epoch19 layer4 Acc 0.8605263157894737, AUC 0.9451674222946167, avg_entr 0.010761085897684097, f1 0.8605263233184814
ep19_l4_test_time 0.11432243699999844
Best AUC tensor(0.8805) 9 4
train_as_loss [[4.53133512e+02 3.56317962e+02 3.50999618e+02 3.49807238e+02
  3.49352889e+02 3.49133478e+02 3.49012170e+02 3.48939007e+02
  3.48892168e+02 3.48860849e+02 3.48843548e+02 3.48833679e+02
  3.48824756e+02 3.48816881e+02 3.48811594e+02 3.48808136e+02
  3.48804699e+02 3.48801370e+02 3.48798970e+02 3.48797306e+02]
 [1.50445284e+00 1.01654594e-05 6.88249687e-07 1.39446427e-07
  2.65453927e-07 8.81255262e-07 1.70643134e-06 3.27013957e-05
  1.14123466e-04 1.91241510e-04 3.16549318e-04 3.46796388e-04
  1.19677013e-07 6.74255337e-10 5.61356181e-10 1.45130553e-04
  4.04579249e-06 3.64718959e-10 2.73365338e-10 2.98328836e-05]
 [1.59013353e+00 1.45016530e-05 1.12363207e-06 2.38924514e-07
  8.55445610e-08 1.00170725e-07 7.58076482e-07 5.02271807e-05
  2.43748316e-04 1.13618904e-04 1.82037773e-04 2.19222087e-04
  8.16588276e-07 3.76589135e-09 1.23423585e-09 1.01611249e-04
  2.80532828e-05 1.74137580e-09 6.12630776e-10 1.97627003e-05]
 [1.71189130e+00 1.55290797e-05 1.29213011e-06 3.29242662e-07
  1.36776628e-07 1.31339230e-07 9.53402468e-07 6.83294111e-05
  3.26988377e-04 1.22830027e-04 1.72234350e-04 2.25716833e-04
  5.05827101e-06 2.68485984e-08 4.58878792e-09 1.10422865e-04
  1.20348724e-04 7.78041386e-09 1.39506097e-09 1.76167984e-05]
 [1.61566179e+00 1.02816543e-05 1.22796053e-06 5.02563037e-07
  2.73462075e-07 2.61070695e-07 1.16222669e-06 1.04528642e-04
  4.97391846e-04 1.50143250e-04 1.59744766e-04 2.51612730e-04
  3.03493826e-05 1.91816727e-07 2.46759291e-08 1.31500874e-04
  3.60339592e-04 2.94264734e-08 3.36503477e-09 1.73618018e-05]]
train_ae_loss [[11.1860033  11.63816005 10.59855252  9.86210005  9.202699    8.58698185
   8.07821943  7.55925389  7.07761169  6.60818293  5.38615865  4.95817302
   4.69109224  4.57313705  4.01782752  3.82545413  3.74327639  3.69440258
   3.47034821  3.39125668]
 [10.83701834 10.07779202  9.01115008  8.29844851  7.55571446  6.95231444
   6.4031412   5.81753745  5.34616632  4.86398002  3.87425752  3.46519983
   2.95122975  2.8105121   2.43985231  2.27581718  2.06762431  1.99252437
   1.86074665  1.80035753]
 [11.28818949  9.12546833  7.88715963  7.12587124  6.39496914  5.83095375
   5.31656203  4.80212844  4.38105806  3.91117478  3.11118684  2.78038337
   2.37727721  2.25774839  1.92967438  1.80755189  1.63364503  1.57732552
   1.45826718  1.40138014]
 [11.5110655  11.16295637  7.67779357  6.80368111  6.03344509  5.45648704
   4.93301591  4.42122696  4.01023764  3.54745594  2.79070317  2.49355741
   2.11723795  2.00422102  1.68970053  1.57719045  1.41626476  1.36576894
   1.25293079  1.19981608]
 [11.89043625 13.55291699  8.14739741  7.13754643  6.27287808  5.65581298
   5.07482406  4.52600581  4.09070622  3.59379475  2.81406414  2.51371835
   2.13175667  2.00899761  1.68729919  1.57016831  1.40181861  1.35183003
   1.23517078  1.18261627]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 265.999213817
Start Testing
Load ckpt at ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt
gc 10
Test layer0 Acc 0.8528947368421053, AUC 0.9579149484634399, avg_entr 0.05554989352822304, f1 0.8528947234153748
l0_test_time 0.06260447700003624
gc 0
Test layer1 Acc 0.8744736842105263, AUC 0.9670996069908142, avg_entr 0.04067368432879448, f1 0.8744736909866333
l1_test_time 0.0704826799999978
gc 0
Test layer2 Acc 0.8781578947368421, AUC 0.9667069911956787, avg_entr 0.035158347338438034, f1 0.878157913684845
l2_test_time 0.08235724099995423
gc 0
Test layer3 Acc 0.88, AUC 0.9670010209083557, avg_entr 0.03605663776397705, f1 0.8799999952316284
l3_test_time 0.09748296999998729
gc 0
Test layer4 Acc 0.8802631578947369, AUC 0.9665942192077637, avg_entr 0.03444730490446091, f1 0.880263090133667
l4_test_time 0.11645509400000265
gc 0
Test threshold 0.1 Acc 0.8692105263157894, AUC 0.9602043032646179, avg_entr 0.01948690041899681, f1 0.8692105412483215
t0.1_test_time 0.11982016799998974
gc 0
Test threshold 0.2 Acc 0.8639473684210527, AUC 0.9597780108451843, avg_entr 0.021403588354587555, f1 0.8639474511146545
t0.2_test_time 0.1178622910000513
gc 0
Test threshold 0.3 Acc 0.8592105263157894, AUC 0.9590590000152588, avg_entr 0.02498670667409897, f1 0.8592105507850647
t0.3_test_time 0.11363732199998822
gc 0
Test threshold 0.4 Acc 0.8539473684210527, AUC 0.9583975672721863, avg_entr 0.03309403359889984, f1 0.8539473414421082
t0.4_test_time 0.09105533700000024
gc 0
Test threshold 0.5 Acc 0.8531578947368421, AUC 0.9580458402633667, avg_entr 0.03877835348248482, f1 0.8531579375267029
t0.5_test_time 0.08078955899998164
gc 0
Test threshold 0.6 Acc 0.8528947368421053, AUC 0.9579149484634399, avg_entr 0.04007077217102051, f1 0.8528947234153748
t0.6_test_time 0.07535046299994974
gc 0
Test threshold 0.7 Acc 0.8528947368421053, AUC 0.9579149484634399, avg_entr 0.04007077217102051, f1 0.8528947234153748
t0.7_test_time 0.07541776800002253
gc 0
Test threshold 0.8 Acc 0.8528947368421053, AUC 0.9579149484634399, avg_entr 0.04007077217102051, f1 0.8528947234153748
t0.8_test_time 0.07663481700001284
gc 0
Test threshold 0.9 Acc 0.8528947368421053, AUC 0.9579149484634399, avg_entr 0.04007077217102051, f1 0.8528947234153748
t0.9_test_time 0.07565392800000836
