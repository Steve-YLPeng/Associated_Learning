total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 48937892
init_time 15.710361881
Start Training
gc 0
Train Epoch0 Acc 0.25625 (30750/120000), AUC 0.5015556812286377
ep0_train_time 12.863851856
Test Epoch0 layer0 Acc 0.7286842105263158, AUC 0.9078193306922913, avg_entr 0.8233563303947449, f1 0.7286841869354248
ep0_l0_test_time 0.06597522499999897
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.738421052631579, AUC 0.9136537313461304, avg_entr 0.7441371083259583, f1 0.7384210228919983
ep0_l1_test_time 0.07997401600000131
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.7086842105263158, AUC 0.8953679800033569, avg_entr 0.7855626940727234, f1 0.7086842656135559
ep0_l2_test_time 0.08764190199999788
Test Epoch0 layer3 Acc 0.2618421052631579, AUC 0.6808680295944214, avg_entr 1.2211549282073975, f1 0.26184210181236267
ep0_l3_test_time 0.09524463700000041
Test Epoch0 layer4 Acc 0.2594736842105263, AUC 0.3935127556324005, avg_entr 1.2268224954605103, f1 0.25947368144989014
ep0_l4_test_time 0.11321932799999956
gc 0
Train Epoch1 Acc 0.5987333333333333 (71848/120000), AUC 0.8464428186416626
ep1_train_time 12.576586309000003
Test Epoch1 layer0 Acc 0.8128947368421052, AUC 0.9540908932685852, avg_entr 0.35959717631340027, f1 0.8128947615623474
ep1_l0_test_time 0.06373143599999764
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8286842105263158, AUC 0.9576376676559448, avg_entr 0.2868095934391022, f1 0.8286842107772827
ep1_l1_test_time 0.07489158599999968
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8305263157894737, AUC 0.9567529559135437, avg_entr 0.2741435468196869, f1 0.8305262923240662
ep1_l2_test_time 0.08607791200000037
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer3 Acc 0.83, AUC 0.9529812335968018, avg_entr 0.2755504846572876, f1 0.8299999833106995
ep1_l3_test_time 0.09991752500000217
Test Epoch1 layer4 Acc 0.828421052631579, AUC 0.9523131847381592, avg_entr 0.27505606412887573, f1 0.8284210562705994
ep1_l4_test_time 0.1150045110000022
gc 0
Train Epoch2 Acc 0.8695583333333333 (104347/120000), AUC 0.961795449256897
ep2_train_time 12.542720410999998
Test Epoch2 layer0 Acc 0.8463157894736842, AUC 0.9612874388694763, avg_entr 0.23062972724437714, f1 0.8463158011436462
ep2_l0_test_time 0.0638120599999965
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8607894736842105, AUC 0.9663111567497253, avg_entr 0.1762033849954605, f1 0.8607894778251648
ep2_l1_test_time 0.07749535900000382
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8613157894736843, AUC 0.9656556844711304, avg_entr 0.1712963879108429, f1 0.8613157868385315
ep2_l2_test_time 0.08594486799999856
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8565789473684211, AUC 0.9632809162139893, avg_entr 0.16913153231143951, f1 0.8565789461135864
ep2_l3_test_time 0.09746601999999882
Test Epoch2 layer4 Acc 0.8552631578947368, AUC 0.9614824056625366, avg_entr 0.16606204211711884, f1 0.8552631735801697
ep2_l4_test_time 0.11473314999999928
gc 0
Train Epoch3 Acc 0.8962916666666667 (107555/120000), AUC 0.9715832471847534
ep3_train_time 12.762175878999997
Test Epoch3 layer0 Acc 0.8426315789473684, AUC 0.9624953866004944, avg_entr 0.1592138409614563, f1 0.8426315784454346
ep3_l0_test_time 0.06341489300000092
Test Epoch3 layer1 Acc 0.8618421052631579, AUC 0.9687653183937073, avg_entr 0.13339906930923462, f1 0.8618420958518982
ep3_l1_test_time 0.06970039099999781
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8642105263157894, AUC 0.9675288200378418, avg_entr 0.13027453422546387, f1 0.8642105460166931
ep3_l2_test_time 0.09026595200000997
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer3 Acc 0.8636842105263158, AUC 0.9669018387794495, avg_entr 0.12704037129878998, f1 0.8636842370033264
ep3_l3_test_time 0.10142668200001026
Test Epoch3 layer4 Acc 0.8607894736842105, AUC 0.9657189846038818, avg_entr 0.11834230273962021, f1 0.8607894778251648
ep3_l4_test_time 0.11461713100000281
gc 0
Train Epoch4 Acc 0.9143 (109716/120000), AUC 0.9785696268081665
ep4_train_time 12.636481840000002
Test Epoch4 layer0 Acc 0.8513157894736842, AUC 0.9637333154678345, avg_entr 0.11469452828168869, f1 0.8513157963752747
ep4_l0_test_time 0.06383882800000151
Test Epoch4 layer1 Acc 0.8721052631578947, AUC 0.9692838788032532, avg_entr 0.09117178618907928, f1 0.8721052408218384
ep4_l1_test_time 0.06933697399999517
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8744736842105263, AUC 0.9689798951148987, avg_entr 0.09132072329521179, f1 0.8744736909866333
ep4_l2_test_time 0.08917924200000016
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer3 Acc 0.8707894736842106, AUC 0.966560959815979, avg_entr 0.08735017478466034, f1 0.8707894682884216
ep4_l3_test_time 0.10231265199999484
Test Epoch4 layer4 Acc 0.8710526315789474, AUC 0.966254711151123, avg_entr 0.0844154953956604, f1 0.871052622795105
ep4_l4_test_time 0.11470088100000453
gc 0
Train Epoch5 Acc 0.9265416666666667 (111185/120000), AUC 0.9818283319473267
ep5_train_time 12.608059593999997
Test Epoch5 layer0 Acc 0.8565789473684211, AUC 0.964160144329071, avg_entr 0.09087835997343063, f1 0.8565789461135864
ep5_l0_test_time 0.06368092300000683
Test Epoch5 layer1 Acc 0.8689473684210526, AUC 0.9706687927246094, avg_entr 0.07428574562072754, f1 0.8689473867416382
ep5_l1_test_time 0.06956185100000312
Test Epoch5 layer2 Acc 0.8739473684210526, AUC 0.9704166054725647, avg_entr 0.07189547270536423, f1 0.8739473819732666
ep5_l2_test_time 0.08047582800000441
Test Epoch5 layer3 Acc 0.8710526315789474, AUC 0.9678820371627808, avg_entr 0.06987109035253525, f1 0.871052622795105
ep5_l3_test_time 0.09536199800000134
Test Epoch5 layer4 Acc 0.8689473684210526, AUC 0.9669156670570374, avg_entr 0.06735600531101227, f1 0.8689473867416382
ep5_l4_test_time 0.11435888500000146
gc 0
Train Epoch6 Acc 0.9383 (112596/120000), AUC 0.9848208427429199
ep6_train_time 12.643145793000002
Test Epoch6 layer0 Acc 0.8542105263157894, AUC 0.9638606309890747, avg_entr 0.07468913495540619, f1 0.8542105555534363
ep6_l0_test_time 0.06360387800000922
Test Epoch6 layer1 Acc 0.8686842105263158, AUC 0.9709988236427307, avg_entr 0.05844834819436073, f1 0.8686841726303101
ep6_l1_test_time 0.06947394000000884
Test Epoch6 layer2 Acc 0.8676315789473684, AUC 0.9709206819534302, avg_entr 0.05504070222377777, f1 0.8676315546035767
ep6_l2_test_time 0.08066286999999761
Test Epoch6 layer3 Acc 0.8676315789473684, AUC 0.9702099561691284, avg_entr 0.052716996520757675, f1 0.8676315546035767
ep6_l3_test_time 0.0957177439999981
Test Epoch6 layer4 Acc 0.8673684210526316, AUC 0.9689366817474365, avg_entr 0.049468204379081726, f1 0.8673684000968933
ep6_l4_test_time 0.11455925599999262
gc 0
Train Epoch7 Acc 0.9465333333333333 (113584/120000), AUC 0.9864990711212158
ep7_train_time 12.542185781
Test Epoch7 layer0 Acc 0.8526315789473684, AUC 0.9621075987815857, avg_entr 0.06669805198907852, f1 0.8526315689086914
ep7_l0_test_time 0.06406719599999633
Test Epoch7 layer1 Acc 0.8694736842105263, AUC 0.9708453416824341, avg_entr 0.05185734108090401, f1 0.8694736957550049
ep7_l1_test_time 0.06937515500000302
Test Epoch7 layer2 Acc 0.8713157894736843, AUC 0.969373881816864, avg_entr 0.048451028764247894, f1 0.8713157176971436
ep7_l2_test_time 0.0808119769999962
Test Epoch7 layer3 Acc 0.8678947368421053, AUC 0.9658341407775879, avg_entr 0.048210542649030685, f1 0.86789470911026
ep7_l3_test_time 0.09592754000000525
Test Epoch7 layer4 Acc 0.8692105263157894, AUC 0.9655745029449463, avg_entr 0.04529327154159546, f1 0.8692105412483215
ep7_l4_test_time 0.1148065530000082
gc 0
Train Epoch8 Acc 0.954375 (114525/120000), AUC 0.9887729287147522
ep8_train_time 12.615128145000014
Test Epoch8 layer0 Acc 0.8560526315789474, AUC 0.9615923762321472, avg_entr 0.05788130685687065, f1 0.8560526371002197
ep8_l0_test_time 0.06431585599997902
Test Epoch8 layer1 Acc 0.8813157894736842, AUC 0.9705303907394409, avg_entr 0.04513445496559143, f1 0.8813157677650452
ep8_l1_test_time 0.07534775700000296
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer2 Acc 0.8794736842105263, AUC 0.9709632396697998, avg_entr 0.04637446999549866, f1 0.8794736862182617
ep8_l2_test_time 0.08806565800000499
Test Epoch8 layer3 Acc 0.8794736842105263, AUC 0.9697691202163696, avg_entr 0.04508301243185997, f1 0.8794736862182617
ep8_l3_test_time 0.0958425649999981
Test Epoch8 layer4 Acc 0.8802631578947369, AUC 0.9682399034500122, avg_entr 0.044151339679956436, f1 0.880263090133667
ep8_l4_test_time 0.11493540600000074
gc 0
Train Epoch9 Acc 0.9605916666666666 (115271/120000), AUC 0.9899014234542847
ep9_train_time 12.583191951999993
Test Epoch9 layer0 Acc 0.8589473684210527, AUC 0.9613665342330933, avg_entr 0.048003796488046646, f1 0.8589473962783813
ep9_l0_test_time 0.06349447799999552
Test Epoch9 layer1 Acc 0.8705263157894737, AUC 0.9684270620346069, avg_entr 0.03221482038497925, f1 0.8705263137817383
ep9_l1_test_time 0.06922803699998781
Test Epoch9 layer2 Acc 0.8739473684210526, AUC 0.9658951759338379, avg_entr 0.029727717861533165, f1 0.8739473819732666
ep9_l2_test_time 0.08068812799999137
Test Epoch9 layer3 Acc 0.8728947368421053, AUC 0.9629064798355103, avg_entr 0.02823810465633869, f1 0.8728947639465332
ep9_l3_test_time 0.09573963599999047
Test Epoch9 layer4 Acc 0.8721052631578947, AUC 0.9627951383590698, avg_entr 0.02524556964635849, f1 0.8721052408218384
ep9_l4_test_time 0.1145564429999979
gc 0
Train Epoch10 Acc 0.9685083333333333 (116221/120000), AUC 0.9920003414154053
ep10_train_time 12.675872650999992
Test Epoch10 layer0 Acc 0.8571052631578947, AUC 0.9572679996490479, avg_entr 0.03987168148159981, f1 0.8571051955223083
ep10_l0_test_time 0.07498962400001119
Test Epoch10 layer1 Acc 0.8763157894736842, AUC 0.9649569988250732, avg_entr 0.02381662093102932, f1 0.8763157725334167
ep10_l1_test_time 0.06944574899998202
Test Epoch10 layer2 Acc 0.8760526315789474, AUC 0.9646803140640259, avg_entr 0.022105427458882332, f1 0.8760526180267334
ep10_l2_test_time 0.0807751650000057
Test Epoch10 layer3 Acc 0.8757894736842106, AUC 0.9640645980834961, avg_entr 0.02139473147690296, f1 0.87578946352005
ep10_l3_test_time 0.09590055999998981
Test Epoch10 layer4 Acc 0.8768421052631579, AUC 0.9623828530311584, avg_entr 0.020060375332832336, f1 0.8768420815467834
ep10_l4_test_time 0.1146977129999982
gc 0
Train Epoch11 Acc 0.974275 (116913/120000), AUC 0.9935132265090942
ep11_train_time 12.695500683999995
Test Epoch11 layer0 Acc 0.855, AUC 0.9572615027427673, avg_entr 0.04006432741880417, f1 0.8550000190734863
ep11_l0_test_time 0.06451702399999704
Test Epoch11 layer1 Acc 0.8736842105263158, AUC 0.9654060006141663, avg_entr 0.030287979170680046, f1 0.8736842274665833
ep11_l1_test_time 0.06982808300000443
Test Epoch11 layer2 Acc 0.8773684210526316, AUC 0.9632299542427063, avg_entr 0.025783365592360497, f1 0.8773684501647949
ep11_l2_test_time 0.08076939000000039
Test Epoch11 layer3 Acc 0.8773684210526316, AUC 0.9621610641479492, avg_entr 0.024031130596995354, f1 0.8773684501647949
ep11_l3_test_time 0.09557307599999376
Test Epoch11 layer4 Acc 0.8773684210526316, AUC 0.9618852138519287, avg_entr 0.022365599870681763, f1 0.8773684501647949
ep11_l4_test_time 0.11464453599998592
gc 0
Train Epoch12 Acc 0.9773416666666667 (117281/120000), AUC 0.9937693476676941
ep12_train_time 12.659596426999997
Test Epoch12 layer0 Acc 0.8502631578947368, AUC 0.9555608630180359, avg_entr 0.03800220042467117, f1 0.8502631783485413
ep12_l0_test_time 0.0638092380000046
Test Epoch12 layer1 Acc 0.8718421052631579, AUC 0.9640995264053345, avg_entr 0.023868758231401443, f1 0.8718421459197998
ep12_l1_test_time 0.06961656999999377
Test Epoch12 layer2 Acc 0.8731578947368421, AUC 0.9624810218811035, avg_entr 0.020082324743270874, f1 0.8731579184532166
ep12_l2_test_time 0.08068554499999436
Test Epoch12 layer3 Acc 0.8739473684210526, AUC 0.9585046768188477, avg_entr 0.01869046874344349, f1 0.8739473819732666
ep12_l3_test_time 0.09565967499997896
Test Epoch12 layer4 Acc 0.8755263157894737, AUC 0.9588490724563599, avg_entr 0.01854356937110424, f1 0.8755263090133667
ep12_l4_test_time 0.11501849999999081
gc 0
Train Epoch13 Acc 0.9796166666666667 (117554/120000), AUC 0.9939296841621399
ep13_train_time 12.613785966999984
Test Epoch13 layer0 Acc 0.8571052631578947, AUC 0.9545192718505859, avg_entr 0.032267168164253235, f1 0.8571051955223083
ep13_l0_test_time 0.06365774799999713
Test Epoch13 layer1 Acc 0.8744736842105263, AUC 0.9629625082015991, avg_entr 0.02076515182852745, f1 0.8744736909866333
ep13_l1_test_time 0.06935265699999604
Test Epoch13 layer2 Acc 0.8760526315789474, AUC 0.9632610082626343, avg_entr 0.018680840730667114, f1 0.8760526180267334
ep13_l2_test_time 0.08057352000000151
Test Epoch13 layer3 Acc 0.8773684210526316, AUC 0.9605038166046143, avg_entr 0.018147258087992668, f1 0.8773684501647949
ep13_l3_test_time 0.09568783399998892
Test Epoch13 layer4 Acc 0.8763157894736842, AUC 0.9559715986251831, avg_entr 0.017010647803544998, f1 0.8763157725334167
ep13_l4_test_time 0.11494376799998918
gc 0
Train Epoch14 Acc 0.981325 (117759/120000), AUC 0.9943662881851196
ep14_train_time 12.694091738999987
Test Epoch14 layer0 Acc 0.8547368421052631, AUC 0.9530997276306152, avg_entr 0.03620317950844765, f1 0.854736864566803
ep14_l0_test_time 0.06306390900002157
Test Epoch14 layer1 Acc 0.8678947368421053, AUC 0.9597199559211731, avg_entr 0.02098400704562664, f1 0.86789470911026
ep14_l1_test_time 0.06906037799998899
Test Epoch14 layer2 Acc 0.8705263157894737, AUC 0.9586503505706787, avg_entr 0.017769664525985718, f1 0.8705263137817383
ep14_l2_test_time 0.0803907160000108
Test Epoch14 layer3 Acc 0.8718421052631579, AUC 0.9585317969322205, avg_entr 0.016808463260531425, f1 0.8718421459197998
ep14_l3_test_time 0.09707140699998718
Test Epoch14 layer4 Acc 0.87, AUC 0.9567216634750366, avg_entr 0.015398552641272545, f1 0.8700000047683716
ep14_l4_test_time 0.11475810499999284
gc 0
Train Epoch15 Acc 0.9837166666666667 (118046/120000), AUC 0.9952765703201294
ep15_train_time 12.687646329999978
Test Epoch15 layer0 Acc 0.8542105263157894, AUC 0.9511942863464355, avg_entr 0.030056225135922432, f1 0.8542105555534363
ep15_l0_test_time 0.06372785099998168
Test Epoch15 layer1 Acc 0.866578947368421, AUC 0.9558881521224976, avg_entr 0.01781180128455162, f1 0.8665789365768433
ep15_l1_test_time 0.0693914070000119
Test Epoch15 layer2 Acc 0.8707894736842106, AUC 0.957618236541748, avg_entr 0.013824190013110638, f1 0.8707894682884216
ep15_l2_test_time 0.08071382500000368
Test Epoch15 layer3 Acc 0.8678947368421053, AUC 0.9550706148147583, avg_entr 0.013592624105513096, f1 0.86789470911026
ep15_l3_test_time 0.09558478600001763
Test Epoch15 layer4 Acc 0.87, AUC 0.9545413851737976, avg_entr 0.01225745864212513, f1 0.8700000047683716
ep15_l4_test_time 0.11488423599999464
gc 0
Train Epoch16 Acc 0.9848916666666667 (118187/120000), AUC 0.9954124689102173
ep16_train_time 12.66919525099999
Test Epoch16 layer0 Acc 0.8528947368421053, AUC 0.9494200944900513, avg_entr 0.025983955711126328, f1 0.8528947234153748
ep16_l0_test_time 0.06339059800001223
Test Epoch16 layer1 Acc 0.8663157894736843, AUC 0.9560909271240234, avg_entr 0.01734340377151966, f1 0.8663158416748047
ep16_l1_test_time 0.069246703999994
Test Epoch16 layer2 Acc 0.8642105263157894, AUC 0.9557953476905823, avg_entr 0.015076324343681335, f1 0.8642105460166931
ep16_l2_test_time 0.08069198999999116
Test Epoch16 layer3 Acc 0.863421052631579, AUC 0.9540457725524902, avg_entr 0.014782949350774288, f1 0.8634210228919983
ep16_l3_test_time 0.09612573200001862
Test Epoch16 layer4 Acc 0.8631578947368421, AUC 0.9534593224525452, avg_entr 0.012984235771000385, f1 0.8631578683853149
ep16_l4_test_time 0.11521093500002166
gc 0
Train Epoch17 Acc 0.9845916666666666 (118151/120000), AUC 0.9952985048294067
ep17_train_time 12.787133032000014
Test Epoch17 layer0 Acc 0.8555263157894737, AUC 0.9492775797843933, avg_entr 0.02710813656449318, f1 0.855526328086853
ep17_l0_test_time 0.06369407199997568
Test Epoch17 layer1 Acc 0.8655263157894737, AUC 0.9512206315994263, avg_entr 0.016032813116908073, f1 0.8655263185501099
ep17_l1_test_time 0.06947901699999193
Test Epoch17 layer2 Acc 0.8673684210526316, AUC 0.9526872038841248, avg_entr 0.011698264628648758, f1 0.8673684000968933
ep17_l2_test_time 0.08092476300004137
Test Epoch17 layer3 Acc 0.8655263157894737, AUC 0.951614260673523, avg_entr 0.010698794387280941, f1 0.8655263185501099
ep17_l3_test_time 0.09717227999999523
Test Epoch17 layer4 Acc 0.8652631578947368, AUC 0.9529984593391418, avg_entr 0.010035520419478416, f1 0.8652631640434265
ep17_l4_test_time 0.1153631560000008
gc 0
Train Epoch18 Acc 0.9857833333333333 (118294/120000), AUC 0.9956798553466797
ep18_train_time 12.952488888999994
Test Epoch18 layer0 Acc 0.8528947368421053, AUC 0.9484624862670898, avg_entr 0.026004862040281296, f1 0.8528947234153748
ep18_l0_test_time 0.06371153300000287
Test Epoch18 layer1 Acc 0.8631578947368421, AUC 0.9515640139579773, avg_entr 0.01564136892557144, f1 0.8631578683853149
ep18_l1_test_time 0.06981390099997498
Test Epoch18 layer2 Acc 0.8655263157894737, AUC 0.9524118900299072, avg_entr 0.013858571648597717, f1 0.8655263185501099
ep18_l2_test_time 0.0809474719999912
Test Epoch18 layer3 Acc 0.8647368421052631, AUC 0.9500879049301147, avg_entr 0.013743004761636257, f1 0.8647368550300598
ep18_l3_test_time 0.09618827299999566
Test Epoch18 layer4 Acc 0.8647368421052631, AUC 0.9496846795082092, avg_entr 0.01325896754860878, f1 0.8647368550300598
ep18_l4_test_time 0.11501939499999025
gc 0
Train Epoch19 Acc 0.9853833333333334 (118246/120000), AUC 0.9955263137817383
ep19_train_time 12.669140444999982
Test Epoch19 layer0 Acc 0.8505263157894737, AUC 0.9478124380111694, avg_entr 0.02423100359737873, f1 0.8505263328552246
ep19_l0_test_time 0.06372906100000364
Test Epoch19 layer1 Acc 0.8636842105263158, AUC 0.9506014585494995, avg_entr 0.01418975181877613, f1 0.8636842370033264
ep19_l1_test_time 0.06950430699998833
Test Epoch19 layer2 Acc 0.8623684210526316, AUC 0.951823353767395, avg_entr 0.01192160788923502, f1 0.8623684048652649
ep19_l2_test_time 0.08088331900000867
Test Epoch19 layer3 Acc 0.8631578947368421, AUC 0.9495702385902405, avg_entr 0.011526454240083694, f1 0.8631578683853149
ep19_l3_test_time 0.09592108300000746
Test Epoch19 layer4 Acc 0.8628947368421053, AUC 0.949466347694397, avg_entr 0.010560336522758007, f1 0.8628947138786316
ep19_l4_test_time 0.1149123120000013
Best AUC tensor(0.8813) 8 1
train_as_loss [[4.50322738e+02 3.56073875e+02 3.50928528e+02 3.49774994e+02
  3.49335395e+02 3.49123010e+02 3.49005515e+02 3.48934595e+02
  3.48889153e+02 3.48858754e+02 3.48841947e+02 3.48832350e+02
  3.48823674e+02 3.48816011e+02 3.48810869e+02 3.48807495e+02
  3.48804143e+02 3.48800910e+02 3.48798555e+02 3.48796938e+02]
 [1.93461192e+00 1.45467928e-05 1.09321342e-06 2.18366951e-07
  6.66794310e-08 2.54789950e-08 5.56604623e-07 9.32888195e-06
  5.85133214e-05 1.48388934e-04 2.39516136e-04 4.65478001e-07
  7.46935081e-10 8.98600436e-10 9.31811144e-05 4.37222014e-07
  3.33173602e-10 4.05125700e-10 2.75458588e-05 1.26858419e-07]
 [2.08614942e+00 1.39204149e-05 1.04971399e-06 2.15961979e-07
  7.36886616e-08 3.13768108e-08 1.71518146e-06 2.47207357e-05
  1.83099070e-04 4.47134969e-04 6.76900795e-04 1.46694600e-06
  1.88788966e-09 2.59342805e-09 2.25808202e-04 9.69062598e-07
  9.39022028e-10 1.41168435e-09 6.79620716e-05 1.70639528e-07]
 [2.10155186e+00 1.09824031e-05 1.04116846e-06 2.57288453e-07
  1.20162755e-07 6.50505616e-08 1.84352400e-06 3.18951942e-05
  3.52701614e-04 7.98024031e-04 1.18131878e-03 4.97757826e-06
  7.26577340e-09 1.00867966e-08 3.89976215e-04 2.24779859e-06
  3.43881831e-09 5.69548202e-09 1.20828417e-04 2.27802699e-07]
 [1.84288389e+00 1.22216570e-05 1.40509397e-06 4.49481898e-07
  2.80326765e-07 1.88030967e-07 1.98896861e-06 4.95573703e-05
  6.39012312e-04 1.33158469e-03 1.92075013e-03 1.27537370e-05
  2.51720497e-08 3.80732968e-08 5.64356105e-04 3.65904364e-06
  1.06121578e-08 2.06126842e-08 1.78327811e-04 3.57563280e-07]]
train_ae_loss [[11.96116733 12.21334127 11.06456161 10.31766797  9.59776191  9.01852584
   8.38899243  7.89976373  7.36343837  6.91110768  5.54564574  5.13464478
   4.84422749  4.63458136  4.0805671   3.87114157  3.75674324  3.70731524
   3.48271269  3.3885969 ]
 [12.02832932 10.53301705  9.11081189  8.31540696  7.54640818  7.01187977
   6.35391972  5.85796779  5.31126014  4.8346553   3.8363952   3.23919609
   2.96070835  2.76614087  2.39717105  2.12268029  2.02683121  1.96279639
   1.83266107  1.70452761]
 [12.63075903 10.49691903  8.88714119  8.0282675   7.22268939  6.66643076
   5.99408031  5.49197514  4.95339617  4.49238171  3.54142345  2.95331772
   2.69256035  2.4949585   2.16987195  1.88454418  1.77977488  1.71246297
   1.60417274  1.47314642]
 [11.66946447 12.23562821  7.88339174  7.0507182   6.29586649  5.77879279
   5.16952224  4.71851319  4.22399106  3.82165196  2.98634707  2.46680531
   2.24062644  2.06280631  1.784768    1.53803739  1.44290148  1.3877852
   1.29498922  1.18250035]
 [10.76451664 13.46347428  7.19692282  6.36211946  5.62319997  5.13054675
   4.56838609  4.15439351  3.70867481  3.34484921  2.60260536  2.13788036
   1.93811008  1.78206374  1.53863454  1.32072228  1.23690417  1.19000361
   1.10781158  1.01014183]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 266.018178376
Start Testing
Load ckpt at ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt
gc 10
Test layer0 Acc 0.8518421052631578, AUC 0.9598516821861267, avg_entr 0.05712181329727173, f1 0.8518421053886414
l0_test_time 0.06297095600001512
gc 0
Test layer1 Acc 0.875, AUC 0.9691196084022522, avg_entr 0.041900623589754105, f1 0.875
l1_test_time 0.07112281500002382
gc 0
Test layer2 Acc 0.8768421052631579, AUC 0.968643307685852, avg_entr 0.04248427599668503, f1 0.8768420815467834
l2_test_time 0.08273119299997234
gc 0
Test layer3 Acc 0.8786842105263157, AUC 0.9670637249946594, avg_entr 0.04318780079483986, f1 0.8786842226982117
l3_test_time 0.09790477600000713
gc 0
Test layer4 Acc 0.8789473684210526, AUC 0.9650794267654419, avg_entr 0.042846791446208954, f1 0.878947377204895
l4_test_time 0.11684966699999677
gc 0
Test threshold 0.1 Acc 0.8673684210526316, AUC 0.9618044495582581, avg_entr 0.02328813634812832, f1 0.8673684000968933
t0.1_test_time 0.1202544840000428
gc 0
Test threshold 0.2 Acc 0.8652631578947368, AUC 0.9610522985458374, avg_entr 0.024664057418704033, f1 0.8652631640434265
t0.2_test_time 0.11888033200000336
gc 0
Test threshold 0.3 Acc 0.8607894736842105, AUC 0.9608098268508911, avg_entr 0.027149206027388573, f1 0.8607894778251648
t0.3_test_time 0.11202246099998092
gc 0
Test threshold 0.4 Acc 0.8557894736842105, AUC 0.9604861736297607, avg_entr 0.03455062583088875, f1 0.8557894825935364
t0.4_test_time 0.09321577500003286
gc 0
Test threshold 0.5 Acc 0.8528947368421053, AUC 0.9600434303283691, avg_entr 0.03968410938978195, f1 0.8528947234153748
t0.5_test_time 0.08149099000002025
gc 0
Test threshold 0.6 Acc 0.8518421052631578, AUC 0.9598516821861267, avg_entr 0.041204679757356644, f1 0.8518421053886414
t0.6_test_time 0.07581728999997495
gc 0
Test threshold 0.7 Acc 0.8518421052631578, AUC 0.9598516821861267, avg_entr 0.041204679757356644, f1 0.8518421053886414
t0.7_test_time 0.07556585000003224
gc 0
Test threshold 0.8 Acc 0.8518421052631578, AUC 0.9598516821861267, avg_entr 0.041204679757356644, f1 0.8518421053886414
t0.8_test_time 0.07583567599999697
gc 0
Test threshold 0.9 Acc 0.8518421052631578, AUC 0.9598516821861267, avg_entr 0.041204679757356644, f1 0.8518421053886414
t0.9_test_time 0.07633457399998633
