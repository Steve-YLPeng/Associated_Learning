total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 48937892
init_time 16.515577042
Start Training
gc 0
Train Epoch0 Acc 0.2533666666666667 (30404/120000), AUC 0.5014281868934631
ep0_train_time 12.642911355999999
Test Epoch0 layer0 Acc 0.7163157894736842, AUC 0.9027065634727478, avg_entr 0.8673914074897766, f1 0.7163158059120178
ep0_l0_test_time 0.0651087480000001
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7423684210526316, AUC 0.9171252846717834, avg_entr 0.7896388173103333, f1 0.7423684597015381
ep0_l1_test_time 0.07804672099999976
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.6155263157894737, AUC 0.827283501625061, avg_entr 1.0608879327774048, f1 0.6155263185501099
ep0_l2_test_time 0.0886935599999994
Test Epoch0 layer3 Acc 0.4044736842105263, AUC 0.7300729155540466, avg_entr 1.221738576889038, f1 0.4044736921787262
ep0_l3_test_time 0.0961002310000012
Test Epoch0 layer4 Acc 0.3071052631578947, AUC 0.5812295079231262, avg_entr 1.238821268081665, f1 0.30710527300834656
ep0_l4_test_time 0.11621107499999894
gc 0
Train Epoch1 Acc 0.7326416666666666 (87917/120000), AUC 0.904046893119812
ep1_train_time 12.475953248000003
Test Epoch1 layer0 Acc 0.8031578947368421, AUC 0.9508659839630127, avg_entr 0.39161914587020874, f1 0.8031578660011292
ep1_l0_test_time 0.06401928499999343
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8236842105263158, AUC 0.9569459557533264, avg_entr 0.33280545473098755, f1 0.8236842155456543
ep1_l1_test_time 0.08073390599999897
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8226315789473684, AUC 0.9546414613723755, avg_entr 0.3275147080421448, f1 0.8226315975189209
ep1_l2_test_time 0.08781742300000417
Test Epoch1 layer3 Acc 0.8197368421052632, AUC 0.950217604637146, avg_entr 0.33262157440185547, f1 0.8197368383407593
ep1_l3_test_time 0.09615761999999961
Test Epoch1 layer4 Acc 0.8176315789473684, AUC 0.9441776275634766, avg_entr 0.3312661945819855, f1 0.8176316618919373
ep1_l4_test_time 0.1152346320000035
gc 0
Train Epoch2 Acc 0.871375 (104565/120000), AUC 0.961116373538971
ep2_train_time 12.504750979999997
Test Epoch2 layer0 Acc 0.8378947368421052, AUC 0.9600191712379456, avg_entr 0.225859135389328, f1 0.8378947377204895
ep2_l0_test_time 0.06361525499999487
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8581578947368421, AUC 0.9671551585197449, avg_entr 0.17797456681728363, f1 0.8581578731536865
ep2_l1_test_time 0.07727400800000339
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.858421052631579, AUC 0.9662854671478271, avg_entr 0.17135488986968994, f1 0.8584210276603699
ep2_l2_test_time 0.08871114100000455
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8589473684210527, AUC 0.9634636640548706, avg_entr 0.1577155739068985, f1 0.8589473962783813
ep2_l3_test_time 0.10068891699999938
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer4 Acc 0.8565789473684211, AUC 0.9601689577102661, avg_entr 0.1509799063205719, f1 0.8565789461135864
ep2_l4_test_time 0.1204641759999987
gc 0
Train Epoch3 Acc 0.89815 (107778/120000), AUC 0.9722810983657837
ep3_train_time 12.464826469000002
Test Epoch3 layer0 Acc 0.853421052631579, AUC 0.9639636874198914, avg_entr 0.16456660628318787, f1 0.8534210324287415
ep3_l0_test_time 0.06359077000000468
Test Epoch3 layer1 Acc 0.8713157894736843, AUC 0.9710158109664917, avg_entr 0.13230456411838531, f1 0.8713157176971436
ep3_l1_test_time 0.06923356800000136
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8728947368421053, AUC 0.969218373298645, avg_entr 0.12835609912872314, f1 0.8728947639465332
ep3_l2_test_time 0.08904832400000373
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer3 Acc 0.8692105263157894, AUC 0.9689910411834717, avg_entr 0.13231191039085388, f1 0.8692105412483215
ep3_l3_test_time 0.10204679100000646
Test Epoch3 layer4 Acc 0.8713157894736843, AUC 0.967559814453125, avg_entr 0.1269756704568863, f1 0.8713157176971436
ep3_l4_test_time 0.11515421600000764
gc 0
Train Epoch4 Acc 0.9126416666666667 (109517/120000), AUC 0.9769948720932007
ep4_train_time 12.535695259000008
Test Epoch4 layer0 Acc 0.8597368421052631, AUC 0.9649959206581116, avg_entr 0.12445604801177979, f1 0.8597368597984314
ep4_l0_test_time 0.06390266900000086
Test Epoch4 layer1 Acc 0.8726315789473684, AUC 0.9725707173347473, avg_entr 0.09869739413261414, f1 0.8726315498352051
ep4_l1_test_time 0.06948492099999726
Test Epoch4 layer2 Acc 0.8773684210526316, AUC 0.9719452261924744, avg_entr 0.08895280212163925, f1 0.8773684501647949
ep4_l2_test_time 0.0807302409999977
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer3 Acc 0.8771052631578947, AUC 0.971196711063385, avg_entr 0.08641517907381058, f1 0.8771052360534668
ep4_l3_test_time 0.1114751849999891
Test Epoch4 layer4 Acc 0.8776315789473684, AUC 0.9698975086212158, avg_entr 0.086622454226017, f1 0.8776316046714783
ep4_l4_test_time 0.11493938100001344
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9261833333333334 (111142/120000), AUC 0.9812837243080139
ep5_train_time 12.501230438000007
Test Epoch5 layer0 Acc 0.863421052631579, AUC 0.9643827080726624, avg_entr 0.0942336842417717, f1 0.8634210228919983
ep5_l0_test_time 0.0634328010000047
Test Epoch5 layer1 Acc 0.8792105263157894, AUC 0.9735733270645142, avg_entr 0.07728032767772675, f1 0.8792105317115784
ep5_l1_test_time 0.06907351200000278
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.8826315789473684, AUC 0.9728430509567261, avg_entr 0.0731818899512291, f1 0.8826315999031067
ep5_l2_test_time 0.09165396999999587
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer3 Acc 0.8831578947368421, AUC 0.9703586101531982, avg_entr 0.07194837182760239, f1 0.8831579089164734
ep5_l3_test_time 0.11110885499999767
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer4 Acc 0.8839473684210526, AUC 0.967278778553009, avg_entr 0.0704074576497078, f1 0.8839473724365234
ep5_l4_test_time 0.11722595400000557
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9380916666666667 (112571/120000), AUC 0.9845337271690369
ep6_train_time 12.489645019999998
Test Epoch6 layer0 Acc 0.8586842105263158, AUC 0.9633487462997437, avg_entr 0.07336518913507462, f1 0.8586841821670532
ep6_l0_test_time 0.06342436799999973
Test Epoch6 layer1 Acc 0.8797368421052632, AUC 0.9720369577407837, avg_entr 0.05621762201189995, f1 0.8797368407249451
ep6_l1_test_time 0.06935661400000015
Test Epoch6 layer2 Acc 0.8781578947368421, AUC 0.9702197909355164, avg_entr 0.05064160376787186, f1 0.878157913684845
ep6_l2_test_time 0.08071066000000826
Test Epoch6 layer3 Acc 0.8776315789473684, AUC 0.9683282375335693, avg_entr 0.04758709669113159, f1 0.8776316046714783
ep6_l3_test_time 0.09614477499999907
Test Epoch6 layer4 Acc 0.8773684210526316, AUC 0.9650427103042603, avg_entr 0.04221484810113907, f1 0.8773684501647949
ep6_l4_test_time 0.11505288200000052
gc 0
Train Epoch7 Acc 0.9469583333333333 (113635/120000), AUC 0.9866606593132019
ep7_train_time 12.53350592000001
Test Epoch7 layer0 Acc 0.8597368421052631, AUC 0.9631648659706116, avg_entr 0.06858375668525696, f1 0.8597368597984314
ep7_l0_test_time 0.06378166000000363
Test Epoch7 layer1 Acc 0.8810526315789474, AUC 0.9712984561920166, avg_entr 0.04508800804615021, f1 0.8810526132583618
ep7_l1_test_time 0.07010919800001147
Test Epoch7 layer2 Acc 0.8818421052631579, AUC 0.9708972573280334, avg_entr 0.03824781998991966, f1 0.8818420767784119
ep7_l2_test_time 0.08093287399999838
Test Epoch7 layer3 Acc 0.8821052631578947, AUC 0.967586100101471, avg_entr 0.03573198989033699, f1 0.88210529088974
ep7_l3_test_time 0.09576351200000488
Test Epoch7 layer4 Acc 0.8818421052631579, AUC 0.9643160104751587, avg_entr 0.03370813652873039, f1 0.8818420767784119
ep7_l4_test_time 0.11544555700000103
gc 0
Train Epoch8 Acc 0.954325 (114519/120000), AUC 0.9885991215705872
ep8_train_time 12.564362003999989
Test Epoch8 layer0 Acc 0.8647368421052631, AUC 0.9627175331115723, avg_entr 0.05617989972233772, f1 0.8647368550300598
ep8_l0_test_time 0.0633047880000106
Test Epoch8 layer1 Acc 0.8844736842105263, AUC 0.971307635307312, avg_entr 0.04573758319020271, f1 0.8844736814498901
ep8_l1_test_time 0.06933518200000321
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer2 Acc 0.8836842105263157, AUC 0.9722263216972351, avg_entr 0.04255009442567825, f1 0.8836842179298401
ep8_l2_test_time 0.09389274700001238
Test Epoch8 layer3 Acc 0.8842105263157894, AUC 0.9709342122077942, avg_entr 0.042229004204273224, f1 0.8842105865478516
ep8_l3_test_time 0.09628984500000115
Test Epoch8 layer4 Acc 0.883421052631579, AUC 0.9708452820777893, avg_entr 0.04159901663661003, f1 0.8834210634231567
ep8_l4_test_time 0.11564570200002322
gc 0
Train Epoch9 Acc 0.963325 (115599/120000), AUC 0.9903314709663391
ep9_train_time 12.643688869999977
Test Epoch9 layer0 Acc 0.8555263157894737, AUC 0.9605293869972229, avg_entr 0.05065936967730522, f1 0.855526328086853
ep9_l0_test_time 0.06375414699999737
Test Epoch9 layer1 Acc 0.8723684210526316, AUC 0.9691663384437561, avg_entr 0.040937528014183044, f1 0.8723683953285217
ep9_l1_test_time 0.0694897699999899
Test Epoch9 layer2 Acc 0.8755263157894737, AUC 0.9700673818588257, avg_entr 0.03499531373381615, f1 0.8755263090133667
ep9_l2_test_time 0.08092509900001232
Test Epoch9 layer3 Acc 0.8755263157894737, AUC 0.9680477380752563, avg_entr 0.03484899550676346, f1 0.8755263090133667
ep9_l3_test_time 0.09619156699997689
Test Epoch9 layer4 Acc 0.876578947368421, AUC 0.9648425579071045, avg_entr 0.03377023711800575, f1 0.8765789270401001
ep9_l4_test_time 0.11540888100000757
gc 0
Train Epoch10 Acc 0.9706583333333333 (116479/120000), AUC 0.9923022985458374
ep10_train_time 12.538956051000014
Test Epoch10 layer0 Acc 0.8578947368421053, AUC 0.9598996639251709, avg_entr 0.04709290340542793, f1 0.8578947186470032
ep10_l0_test_time 0.06373997800000097
Test Epoch10 layer1 Acc 0.8781578947368421, AUC 0.9679933786392212, avg_entr 0.030119799077510834, f1 0.878157913684845
ep10_l1_test_time 0.06959340599999564
Test Epoch10 layer2 Acc 0.8792105263157894, AUC 0.9684816598892212, avg_entr 0.026795247569680214, f1 0.8792105317115784
ep10_l2_test_time 0.08161951100001374
Test Epoch10 layer3 Acc 0.8781578947368421, AUC 0.9666213989257812, avg_entr 0.02658264711499214, f1 0.878157913684845
ep10_l3_test_time 0.09640401000001475
Test Epoch10 layer4 Acc 0.8802631578947369, AUC 0.9636256694793701, avg_entr 0.02457093819975853, f1 0.880263090133667
ep10_l4_test_time 0.1155655480000064
gc 0
Train Epoch11 Acc 0.9729166666666667 (116750/120000), AUC 0.9927583932876587
ep11_train_time 12.600643208000008
Test Epoch11 layer0 Acc 0.853421052631579, AUC 0.9552410840988159, avg_entr 0.03992769122123718, f1 0.8534210324287415
ep11_l0_test_time 0.06430494299999623
Test Epoch11 layer1 Acc 0.8755263157894737, AUC 0.9647864103317261, avg_entr 0.02836441807448864, f1 0.8755263090133667
ep11_l1_test_time 0.0693098829999883
Test Epoch11 layer2 Acc 0.8792105263157894, AUC 0.9649204611778259, avg_entr 0.026001863181591034, f1 0.8792105317115784
ep11_l2_test_time 0.08086184999999091
Test Epoch11 layer3 Acc 0.8771052631578947, AUC 0.9631155133247375, avg_entr 0.025983426719903946, f1 0.8771052360534668
ep11_l3_test_time 0.09587520300001984
Test Epoch11 layer4 Acc 0.8778947368421053, AUC 0.9587875008583069, avg_entr 0.025962723419070244, f1 0.8778947591781616
ep11_l4_test_time 0.11546786299999212
gc 0
Train Epoch12 Acc 0.9758583333333334 (117103/120000), AUC 0.9932454824447632
ep12_train_time 12.667566999000002
Test Epoch12 layer0 Acc 0.855, AUC 0.9541031122207642, avg_entr 0.03818264231085777, f1 0.8550000190734863
ep12_l0_test_time 0.06341854400000102
Test Epoch12 layer1 Acc 0.8686842105263158, AUC 0.9624953866004944, avg_entr 0.028156256303191185, f1 0.8686841726303101
ep12_l1_test_time 0.06922653500001275
Test Epoch12 layer2 Acc 0.8723684210526316, AUC 0.9630880355834961, avg_entr 0.023592855781316757, f1 0.8723683953285217
ep12_l2_test_time 0.08052635699999655
Test Epoch12 layer3 Acc 0.8728947368421053, AUC 0.960211992263794, avg_entr 0.022723959758877754, f1 0.8728947639465332
ep12_l3_test_time 0.09520487999998295
Test Epoch12 layer4 Acc 0.8726315789473684, AUC 0.9583996534347534, avg_entr 0.021146388724446297, f1 0.8726315498352051
ep12_l4_test_time 0.11465876499997307
gc 0
Train Epoch13 Acc 0.9791166666666666 (117494/120000), AUC 0.994084894657135
ep13_train_time 12.652527864999996
Test Epoch13 layer0 Acc 0.8510526315789474, AUC 0.9524917602539062, avg_entr 0.03603564575314522, f1 0.8510526418685913
ep13_l0_test_time 0.06382700199998226
Test Epoch13 layer1 Acc 0.8676315789473684, AUC 0.9600645303726196, avg_entr 0.023222507908940315, f1 0.8676315546035767
ep13_l1_test_time 0.06932403700000123
Test Epoch13 layer2 Acc 0.8702631578947368, AUC 0.9622212648391724, avg_entr 0.021520990878343582, f1 0.8702631592750549
ep13_l2_test_time 0.08059680399998115
Test Epoch13 layer3 Acc 0.8707894736842106, AUC 0.9613443613052368, avg_entr 0.020710870623588562, f1 0.8707894682884216
ep13_l3_test_time 0.09573580099998935
Test Epoch13 layer4 Acc 0.8707894736842106, AUC 0.9572614431381226, avg_entr 0.02015526406466961, f1 0.8707894682884216
ep13_l4_test_time 0.11485844399999223
gc 0
Train Epoch14 Acc 0.9815833333333334 (117790/120000), AUC 0.9948475360870361
ep14_train_time 12.720305927999988
Test Epoch14 layer0 Acc 0.8542105263157894, AUC 0.9528429508209229, avg_entr 0.033169910311698914, f1 0.8542105555534363
ep14_l0_test_time 0.06336605199999212
Test Epoch14 layer1 Acc 0.8623684210526316, AUC 0.959251344203949, avg_entr 0.024596476927399635, f1 0.8623684048652649
ep14_l1_test_time 0.06911152600000037
Test Epoch14 layer2 Acc 0.866578947368421, AUC 0.9588921666145325, avg_entr 0.020764967426657677, f1 0.8665789365768433
ep14_l2_test_time 0.08036716399999477
Test Epoch14 layer3 Acc 0.8663157894736843, AUC 0.957573413848877, avg_entr 0.02037329412996769, f1 0.8663158416748047
ep14_l3_test_time 0.09564382299998897
Test Epoch14 layer4 Acc 0.8673684210526316, AUC 0.9524827003479004, avg_entr 0.018042804673314095, f1 0.8673684000968933
ep14_l4_test_time 0.1146896709999794
gc 0
Train Epoch15 Acc 0.9825416666666666 (117905/120000), AUC 0.9951325058937073
ep15_train_time 12.711977168999994
Test Epoch15 layer0 Acc 0.8531578947368421, AUC 0.950066089630127, avg_entr 0.031143702566623688, f1 0.8531579375267029
ep15_l0_test_time 0.06368432799999368
Test Epoch15 layer1 Acc 0.8631578947368421, AUC 0.9559610486030579, avg_entr 0.02278175577521324, f1 0.8631578683853149
ep15_l1_test_time 0.06918870200001948
Test Epoch15 layer2 Acc 0.861578947368421, AUC 0.9563205242156982, avg_entr 0.02079666219651699, f1 0.8615789413452148
ep15_l2_test_time 0.08036793700000544
Test Epoch15 layer3 Acc 0.8602631578947368, AUC 0.9518972039222717, avg_entr 0.01941598393023014, f1 0.8602631688117981
ep15_l3_test_time 0.0954322080000054
Test Epoch15 layer4 Acc 0.8610526315789474, AUC 0.9445748329162598, avg_entr 0.018654171377420425, f1 0.8610526323318481
ep15_l4_test_time 0.11428738500001145
gc 0
Train Epoch16 Acc 0.9835833333333334 (118030/120000), AUC 0.9953359365463257
ep16_train_time 12.577435809999997
Test Epoch16 layer0 Acc 0.8526315789473684, AUC 0.9498197436332703, avg_entr 0.03144815191626549, f1 0.8526315689086914
ep16_l0_test_time 0.0634030310000071
Test Epoch16 layer1 Acc 0.8639473684210527, AUC 0.9563835859298706, avg_entr 0.01982054114341736, f1 0.8639474511146545
ep16_l1_test_time 0.06923220399997376
Test Epoch16 layer2 Acc 0.8668421052631579, AUC 0.9556131958961487, avg_entr 0.01743844524025917, f1 0.8668420910835266
ep16_l2_test_time 0.08047976699998571
Test Epoch16 layer3 Acc 0.8678947368421053, AUC 0.9530088901519775, avg_entr 0.015362611040472984, f1 0.86789470911026
ep16_l3_test_time 0.0952844599999878
Test Epoch16 layer4 Acc 0.8681578947368421, AUC 0.9509117007255554, avg_entr 0.014006545767188072, f1 0.8681579232215881
ep16_l4_test_time 0.11455146200000854
gc 0
Train Epoch17 Acc 0.9848 (118176/120000), AUC 0.9955384731292725
ep17_train_time 12.632592747000018
Test Epoch17 layer0 Acc 0.853421052631579, AUC 0.9499594569206238, avg_entr 0.029193226248025894, f1 0.8534210324287415
ep17_l0_test_time 0.06420990200001597
Test Epoch17 layer1 Acc 0.8642105263157894, AUC 0.9568006992340088, avg_entr 0.01945727877318859, f1 0.8642105460166931
ep17_l1_test_time 0.0697750570000153
Test Epoch17 layer2 Acc 0.865, AUC 0.9545069932937622, avg_entr 0.01613651029765606, f1 0.8650000095367432
ep17_l2_test_time 0.08124528100000816
Test Epoch17 layer3 Acc 0.865, AUC 0.953422486782074, avg_entr 0.014904997311532497, f1 0.8650000095367432
ep17_l3_test_time 0.09606719399999974
Test Epoch17 layer4 Acc 0.8657894736842106, AUC 0.9493895769119263, avg_entr 0.0137235838919878, f1 0.8657894730567932
ep17_l4_test_time 0.11482797899998332
gc 0
Train Epoch18 Acc 0.9857333333333334 (118288/120000), AUC 0.9957947731018066
ep18_train_time 12.916584989
Test Epoch18 layer0 Acc 0.8486842105263158, AUC 0.947724461555481, avg_entr 0.028907811269164085, f1 0.8486841917037964
ep18_l0_test_time 0.06356921899998724
Test Epoch18 layer1 Acc 0.8623684210526316, AUC 0.9542409181594849, avg_entr 0.01825599931180477, f1 0.8623684048652649
ep18_l1_test_time 0.06937674299996388
Test Epoch18 layer2 Acc 0.8613157894736843, AUC 0.9507350921630859, avg_entr 0.015272309072315693, f1 0.8613157868385315
ep18_l2_test_time 0.0807805970000004
Test Epoch18 layer3 Acc 0.861578947368421, AUC 0.9511311054229736, avg_entr 0.014561680145561695, f1 0.8615789413452148
ep18_l3_test_time 0.09554128000002038
Test Epoch18 layer4 Acc 0.8607894736842105, AUC 0.9477062821388245, avg_entr 0.013597171753644943, f1 0.8607894778251648
ep18_l4_test_time 0.11478010500002256
gc 0
Train Epoch19 Acc 0.9861583333333334 (118339/120000), AUC 0.9960013031959534
ep19_train_time 12.774481008999999
Test Epoch19 layer0 Acc 0.8505263157894737, AUC 0.9462372064590454, avg_entr 0.026515711098909378, f1 0.8505263328552246
ep19_l0_test_time 0.06370101699997122
Test Epoch19 layer1 Acc 0.8605263157894737, AUC 0.9538850784301758, avg_entr 0.017235130071640015, f1 0.8605263233184814
ep19_l1_test_time 0.06944059499994637
Test Epoch19 layer2 Acc 0.8618421052631579, AUC 0.9515910744667053, avg_entr 0.015431339852511883, f1 0.8618420958518982
ep19_l2_test_time 0.08065041800000472
Test Epoch19 layer3 Acc 0.8610526315789474, AUC 0.95096755027771, avg_entr 0.014611921273171902, f1 0.8610526323318481
ep19_l3_test_time 0.09571481599999743
Test Epoch19 layer4 Acc 0.8607894736842105, AUC 0.9461419582366943, avg_entr 0.01338971871882677, f1 0.8607894778251648
ep19_l4_test_time 0.11456390200004307
Best AUC tensor(0.8845) 8 1
train_as_loss [[4.57397255e+02 3.56798550e+02 3.51130054e+02 3.49866368e+02
  3.49385688e+02 3.49153696e+02 3.49025451e+02 3.48948108e+02
  3.48898581e+02 3.48871986e+02 3.48857090e+02 3.48843789e+02
  3.48832189e+02 3.48824473e+02 3.48819462e+02 3.48814508e+02
  3.48809748e+02 3.48806306e+02 3.48803963e+02 3.48801512e+02]
 [1.61458875e+00 1.56061779e-05 1.19298369e-06 2.45824485e-07
  7.59863158e-08 3.43659615e-07 1.65675046e-06 1.12798885e-05
  7.02490526e-05 1.17878948e-04 2.13213644e-07 1.17349885e-09
  1.25845618e-06 6.65680889e-05 3.64827443e-07 4.73733583e-10
  9.43020041e-06 1.72118026e-05 5.65230420e-09 2.66370563e-10]
 [1.98906487e+00 1.70660584e-05 1.42134926e-06 3.01099349e-07
  9.83076782e-08 8.34893170e-08 6.39181979e-07 1.19911661e-05
  1.74819336e-04 2.93098344e-04 8.17827097e-07 2.69637141e-09
  1.13412492e-06 1.67074619e-04 7.63545933e-07 1.21292587e-09
  1.22326589e-05 4.66422821e-05 1.45118216e-08 7.36419734e-10]
 [1.79388792e+00 1.32385932e-05 1.26013179e-06 3.04732862e-07
  1.28658986e-07 1.09510087e-07 7.09546499e-07 1.57978658e-05
  3.36157203e-04 1.83733473e-04 1.91223218e-06 1.14458281e-08
  1.04130178e-06 1.09575565e-04 1.93409586e-06 7.05271589e-09
  1.87076229e-05 3.53655315e-05 6.05654335e-08 4.81523894e-09]
 [1.62946018e+00 1.21595614e-05 1.66140267e-06 5.29021897e-07
  3.04685725e-07 2.62996249e-07 1.22686665e-06 3.29054676e-05
  8.42017739e-04 4.44306236e-04 2.14550431e-05 9.17198214e-08
  1.35602518e-04 2.43418289e-04 1.90094792e-05 6.78157376e-08
  1.25021101e-04 1.28702669e-04 4.40599667e-07 5.24739490e-08]]
train_ae_loss [[11.07277487 11.50809119 10.53930808  9.82520999  9.25857794  8.65231444
   8.06249834  7.51437336  7.10374391  5.78210491  5.28210438  5.04561446
   4.79620586  4.2050128   3.99596419  3.89052395  3.80924234  3.56485471
   3.47908523  3.42765663]
 [10.13986629  8.81670322  7.84491557  7.22534172  6.75779648  6.22448513
   5.66170707  5.13966852  4.77636622  3.88377237  3.218834    3.02744801
   2.81280813  2.40589111  2.14148207  2.0409834   1.97078082  1.82080921
   1.69679217  1.64993975]
 [10.65429243  9.00025777  7.59793646  6.87329175  6.36793517  5.79051715
   5.21661506  4.69231051  4.33820434  3.50965684  2.84953579  2.67504208
   2.47476645  2.10068628  1.84480563  1.74463064  1.67620102  1.54090656
   1.41319318  1.37353353]
 [10.29782298  9.73721119  7.47631264  6.66507455  6.13613893  5.53012015
   4.94244392  4.42581615  4.07312003  3.23473851  2.63385696  2.46926606
   2.27550178  1.90659293  1.67233747  1.57373339  1.50157924  1.36922918
   1.24535301  1.20953433]
 [ 9.57452191 10.30161191  7.20632026  6.39427776  5.87005817  5.27392744
   4.69000537  4.18551636  3.83786456  3.06217212  2.47363807  2.31569009
   2.12434923  1.75980742  1.53926659  1.44603257  1.3794269   1.24920476
   1.13027489  1.09700828]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 265.83195307999995
Start Testing
Load ckpt at ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt
gc 10
Test layer0 Acc 0.8547368421052631, AUC 0.961764395236969, avg_entr 0.06269844621419907, f1 0.854736864566803
l0_test_time 0.06256129799999144
gc 0
Test layer1 Acc 0.88, AUC 0.9710386991500854, avg_entr 0.0486283116042614, f1 0.8799999952316284
l1_test_time 0.07073431200001323
gc 0
Test layer2 Acc 0.8786842105263157, AUC 0.9721701145172119, avg_entr 0.04690570384263992, f1 0.8786842226982117
l2_test_time 0.08233905500003402
gc 0
Test layer3 Acc 0.8810526315789474, AUC 0.970851480960846, avg_entr 0.04578451067209244, f1 0.8810526132583618
l3_test_time 0.09756120999998075
gc 0
Test layer4 Acc 0.8805263157894737, AUC 0.9712903499603271, avg_entr 0.04550617188215256, f1 0.8805263042449951
l4_test_time 0.11658521099997188
gc 0
Test threshold 0.1 Acc 0.8731578947368421, AUC 0.964743435382843, avg_entr 0.025246918201446533, f1 0.8731579184532166
t0.1_test_time 0.12006916899997577
gc 0
Test threshold 0.2 Acc 0.8718421052631579, AUC 0.963866114616394, avg_entr 0.027510425075888634, f1 0.8718421459197998
t0.2_test_time 0.11854468499996074
gc 0
Test threshold 0.3 Acc 0.8655263157894737, AUC 0.9632745385169983, avg_entr 0.03024655021727085, f1 0.8655263185501099
t0.3_test_time 0.11634013299999424
gc 0
Test threshold 0.4 Acc 0.8602631578947368, AUC 0.9622613787651062, avg_entr 0.0364716611802578, f1 0.8602631688117981
t0.4_test_time 0.09935798399999385
gc 0
Test threshold 0.5 Acc 0.8557894736842105, AUC 0.9618757367134094, avg_entr 0.04289622977375984, f1 0.8557894825935364
t0.5_test_time 0.08217020099999672
gc 0
Test threshold 0.6 Acc 0.8547368421052631, AUC 0.961764395236969, avg_entr 0.04522736743092537, f1 0.854736864566803
t0.6_test_time 0.07516010800003414
gc 0
Test threshold 0.7 Acc 0.8547368421052631, AUC 0.961764395236969, avg_entr 0.04522736743092537, f1 0.854736864566803
t0.7_test_time 0.07533341000004157
gc 0
Test threshold 0.8 Acc 0.8547368421052631, AUC 0.961764395236969, avg_entr 0.04522736743092537, f1 0.854736864566803
t0.8_test_time 0.07532219799998074
gc 0
Test threshold 0.9 Acc 0.8547368421052631, AUC 0.961764395236969, avg_entr 0.04522736743092537, f1 0.854736864566803
t0.9_test_time 0.07650039000003517
