total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 48937892
init_time 15.665483732
Start Training
gc 0
Train Epoch0 Acc 0.253275 (30393/120000), AUC 0.5016671419143677
ep0_train_time 12.747072649
Test Epoch0 layer0 Acc 0.7021052631578948, AUC 0.9023467302322388, avg_entr 0.8568781614303589, f1 0.7021052837371826
ep0_l0_test_time 0.06472205699999733
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7115789473684211, AUC 0.912480890750885, avg_entr 0.7711950540542603, f1 0.7115789651870728
ep0_l1_test_time 0.07586429900000269
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.6089473684210527, AUC 0.8590164184570312, avg_entr 0.8954545259475708, f1 0.6089473962783813
ep0_l2_test_time 0.08797820700000258
Test Epoch0 layer3 Acc 0.2613157894736842, AUC 0.6585913896560669, avg_entr 1.2459837198257446, f1 0.26131579279899597
ep0_l3_test_time 0.09512172499999849
Test Epoch0 layer4 Acc 0.26, AUC 0.6245490312576294, avg_entr 1.2452682256698608, f1 0.25999999046325684
ep0_l4_test_time 0.11356909200000231
gc 0
Train Epoch1 Acc 0.6232916666666667 (74795/120000), AUC 0.8577037453651428
ep1_train_time 12.532511149999998
Test Epoch1 layer0 Acc 0.8271052631578948, AUC 0.9544523358345032, avg_entr 0.3798596262931824, f1 0.8271052837371826
ep1_l0_test_time 0.06300283799999562
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8436842105263158, AUC 0.9608051180839539, avg_entr 0.3036262094974518, f1 0.843684196472168
ep1_l1_test_time 0.07694272699999516
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8442105263157895, AUC 0.9569150805473328, avg_entr 0.3020869493484497, f1 0.8442105054855347
ep1_l2_test_time 0.08803275000000355
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer3 Acc 0.8436842105263158, AUC 0.9542770385742188, avg_entr 0.31167519092559814, f1 0.843684196472168
ep1_l3_test_time 0.09935924999999912
Test Epoch1 layer4 Acc 0.843421052631579, AUC 0.9513864517211914, avg_entr 0.3260757625102997, f1 0.8434211015701294
ep1_l4_test_time 0.11465268900000325
gc 0
Train Epoch2 Acc 0.868475 (104217/120000), AUC 0.9606689810752869
ep2_train_time 12.615945754000002
Test Epoch2 layer0 Acc 0.8431578947368421, AUC 0.9606406092643738, avg_entr 0.2307933270931244, f1 0.8431578874588013
ep2_l0_test_time 0.0631045350000008
Test Epoch2 layer1 Acc 0.8521052631578947, AUC 0.9679420590400696, avg_entr 0.17913232743740082, f1 0.8521052598953247
ep2_l1_test_time 0.06878572800000171
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8515789473684211, AUC 0.9651228189468384, avg_entr 0.173953115940094, f1 0.851578950881958
ep2_l2_test_time 0.0829053679999987
Test Epoch2 layer3 Acc 0.8505263157894737, AUC 0.9640318751335144, avg_entr 0.17290662229061127, f1 0.8505263328552246
ep2_l3_test_time 0.09543402700000314
Test Epoch2 layer4 Acc 0.8492105263157895, AUC 0.9635942578315735, avg_entr 0.16930879652500153, f1 0.8492104411125183
ep2_l4_test_time 0.11424389100000099
gc 0
Train Epoch3 Acc 0.8963833333333333 (107566/120000), AUC 0.9726619720458984
ep3_train_time 12.470422526000007
Test Epoch3 layer0 Acc 0.8413157894736842, AUC 0.962785005569458, avg_entr 0.1719161719083786, f1 0.8413158059120178
ep3_l0_test_time 0.06296645300000137
Test Epoch3 layer1 Acc 0.8568421052631578, AUC 0.9694209098815918, avg_entr 0.13300567865371704, f1 0.8568421006202698
ep3_l1_test_time 0.06918713099999252
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8531578947368421, AUC 0.9672846794128418, avg_entr 0.12920495867729187, f1 0.8531579375267029
ep3_l2_test_time 0.08823096899999427
Test Epoch3 layer3 Acc 0.8497368421052631, AUC 0.9653295278549194, avg_entr 0.12923136353492737, f1 0.8497368693351746
ep3_l3_test_time 0.0950742089999892
Test Epoch3 layer4 Acc 0.8473684210526315, AUC 0.961789071559906, avg_entr 0.1271062195301056, f1 0.8473684191703796
ep3_l4_test_time 0.11412180499999636
gc 0
Train Epoch4 Acc 0.9166666666666666 (110000/120000), AUC 0.9785771369934082
ep4_train_time 12.463038978
Test Epoch4 layer0 Acc 0.8539473684210527, AUC 0.9640328884124756, avg_entr 0.1237587183713913, f1 0.8539473414421082
ep4_l0_test_time 0.06307527900000309
Test Epoch4 layer1 Acc 0.8744736842105263, AUC 0.9711691737174988, avg_entr 0.09286520630121231, f1 0.8744736909866333
ep4_l1_test_time 0.06871804700000439
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8736842105263158, AUC 0.969794511795044, avg_entr 0.08541877567768097, f1 0.8736842274665833
ep4_l2_test_time 0.08851234699999111
Test Epoch4 layer3 Acc 0.8723684210526316, AUC 0.9680298566818237, avg_entr 0.0802316963672638, f1 0.8723683953285217
ep4_l3_test_time 0.09545067199999835
Test Epoch4 layer4 Acc 0.8705263157894737, AUC 0.9641788601875305, avg_entr 0.07419533282518387, f1 0.8705263137817383
ep4_l4_test_time 0.1142030649999981
gc 0
Train Epoch5 Acc 0.9284666666666667 (111416/120000), AUC 0.9820457696914673
ep5_train_time 12.517101253000007
Test Epoch5 layer0 Acc 0.8521052631578947, AUC 0.9631116390228271, avg_entr 0.10053554177284241, f1 0.8521052598953247
ep5_l0_test_time 0.06336229800000126
Test Epoch5 layer1 Acc 0.8718421052631579, AUC 0.9716430902481079, avg_entr 0.08128947019577026, f1 0.8718421459197998
ep5_l1_test_time 0.06887285000000531
Test Epoch5 layer2 Acc 0.871578947368421, AUC 0.9709000587463379, avg_entr 0.07633847743272781, f1 0.8715789318084717
ep5_l2_test_time 0.08019154400000161
Test Epoch5 layer3 Acc 0.8721052631578947, AUC 0.9685850143432617, avg_entr 0.07745248824357986, f1 0.8721052408218384
ep5_l3_test_time 0.09638240700000722
Test Epoch5 layer4 Acc 0.8728947368421053, AUC 0.9686425924301147, avg_entr 0.07402925938367844, f1 0.8728947639465332
ep5_l4_test_time 0.11448418999999888
gc 0
Train Epoch6 Acc 0.9396833333333333 (112762/120000), AUC 0.9855219721794128
ep6_train_time 12.569234283
Test Epoch6 layer0 Acc 0.863421052631579, AUC 0.9626379609107971, avg_entr 0.08147066086530685, f1 0.8634210228919983
ep6_l0_test_time 0.06293025899999805
Test Epoch6 layer1 Acc 0.8797368421052632, AUC 0.9712073802947998, avg_entr 0.06015484035015106, f1 0.8797368407249451
ep6_l1_test_time 0.06867963099999486
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer2 Acc 0.8813157894736842, AUC 0.9694900512695312, avg_entr 0.05939549580216408, f1 0.8813157677650452
ep6_l2_test_time 0.08856403999999429
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer3 Acc 0.8805263157894737, AUC 0.9675255417823792, avg_entr 0.06050245463848114, f1 0.8805263042449951
ep6_l3_test_time 0.10333297600000435
Test Epoch6 layer4 Acc 0.8807894736842106, AUC 0.9662421941757202, avg_entr 0.058264054358005524, f1 0.8807894587516785
ep6_l4_test_time 0.11450194900000099
gc 0
Train Epoch7 Acc 0.9479083333333334 (113749/120000), AUC 0.9867777824401855
ep7_train_time 12.715826153999998
Test Epoch7 layer0 Acc 0.8526315789473684, AUC 0.9592816829681396, avg_entr 0.062477972358465195, f1 0.8526315689086914
ep7_l0_test_time 0.06287633099999823
Test Epoch7 layer1 Acc 0.8773684210526316, AUC 0.9715825915336609, avg_entr 0.04833036661148071, f1 0.8773684501647949
ep7_l1_test_time 0.06868158599999674
Test Epoch7 layer2 Acc 0.8802631578947369, AUC 0.9706709384918213, avg_entr 0.04386989772319794, f1 0.880263090133667
ep7_l2_test_time 0.08004770200000166
Test Epoch7 layer3 Acc 0.8792105263157894, AUC 0.9688848257064819, avg_entr 0.04414242133498192, f1 0.8792105317115784
ep7_l3_test_time 0.09521934200000715
Test Epoch7 layer4 Acc 0.8786842105263157, AUC 0.9682028889656067, avg_entr 0.0422586165368557, f1 0.8786842226982117
ep7_l4_test_time 0.11444382399999142
gc 0
Train Epoch8 Acc 0.9556833333333333 (114682/120000), AUC 0.988813579082489
ep8_train_time 12.553379756999988
Test Epoch8 layer0 Acc 0.8586842105263158, AUC 0.9622164964675903, avg_entr 0.06152329593896866, f1 0.8586841821670532
ep8_l0_test_time 0.06373312199997372
Test Epoch8 layer1 Acc 0.8818421052631579, AUC 0.9728447794914246, avg_entr 0.04479235038161278, f1 0.8818420767784119
ep8_l1_test_time 0.06894683799998802
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer2 Acc 0.8836842105263157, AUC 0.9718935489654541, avg_entr 0.040097109973430634, f1 0.8836842179298401
ep8_l2_test_time 0.08883144999998649
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer3 Acc 0.8828947368421053, AUC 0.969363808631897, avg_entr 0.039746761322021484, f1 0.88289475440979
ep8_l3_test_time 0.09960133999999243
Test Epoch8 layer4 Acc 0.8821052631578947, AUC 0.9696887731552124, avg_entr 0.036661360412836075, f1 0.88210529088974
ep8_l4_test_time 0.11476612600000635
gc 0
Train Epoch9 Acc 0.9644916666666666 (115739/120000), AUC 0.9901421070098877
ep9_train_time 12.708542160999997
Test Epoch9 layer0 Acc 0.8639473684210527, AUC 0.9585386514663696, avg_entr 0.0512000247836113, f1 0.8639474511146545
ep9_l0_test_time 0.06291620800001851
Test Epoch9 layer1 Acc 0.8776315789473684, AUC 0.969520092010498, avg_entr 0.03433501720428467, f1 0.8776316046714783
ep9_l1_test_time 0.0705454489999795
Test Epoch9 layer2 Acc 0.883421052631579, AUC 0.9688065052032471, avg_entr 0.032241467386484146, f1 0.8834210634231567
ep9_l2_test_time 0.08055095200001006
Test Epoch9 layer3 Acc 0.883421052631579, AUC 0.9680519104003906, avg_entr 0.034041695296764374, f1 0.8834210634231567
ep9_l3_test_time 0.09544379999999819
Test Epoch9 layer4 Acc 0.8823684210526316, AUC 0.9651361107826233, avg_entr 0.03189917281270027, f1 0.8823684453964233
ep9_l4_test_time 0.11439248700000348
gc 0
Train Epoch10 Acc 0.97035 (116442/120000), AUC 0.9916929602622986
ep10_train_time 12.650648122999996
Test Epoch10 layer0 Acc 0.8647368421052631, AUC 0.9562771916389465, avg_entr 0.04816552251577377, f1 0.8647368550300598
ep10_l0_test_time 0.06269921599999861
Test Epoch10 layer1 Acc 0.8797368421052632, AUC 0.9669848084449768, avg_entr 0.02661232464015484, f1 0.8797368407249451
ep10_l1_test_time 0.06878636799999072
Test Epoch10 layer2 Acc 0.8818421052631579, AUC 0.9657943844795227, avg_entr 0.024480413645505905, f1 0.8818420767784119
ep10_l2_test_time 0.08021421500001225
Test Epoch10 layer3 Acc 0.8805263157894737, AUC 0.9651384353637695, avg_entr 0.024887336418032646, f1 0.8805263042449951
ep10_l3_test_time 0.09534349699998756
Test Epoch10 layer4 Acc 0.8805263157894737, AUC 0.961988627910614, avg_entr 0.02318527363240719, f1 0.8805263042449951
ep10_l4_test_time 0.11446975100000145
gc 0
Train Epoch11 Acc 0.97375 (116850/120000), AUC 0.9923467636108398
ep11_train_time 12.634033090000003
Test Epoch11 layer0 Acc 0.8565789473684211, AUC 0.9530153870582581, avg_entr 0.04010328650474548, f1 0.8565789461135864
ep11_l0_test_time 0.06308405200002198
Test Epoch11 layer1 Acc 0.8760526315789474, AUC 0.9649123549461365, avg_entr 0.028367137536406517, f1 0.8760526180267334
ep11_l1_test_time 0.06915437800000745
Test Epoch11 layer2 Acc 0.8786842105263157, AUC 0.9646379947662354, avg_entr 0.023763880133628845, f1 0.8786842226982117
ep11_l2_test_time 0.08044518099998754
Test Epoch11 layer3 Acc 0.88, AUC 0.9648353457450867, avg_entr 0.02327067404985428, f1 0.8799999952316284
ep11_l3_test_time 0.09539490400001682
Test Epoch11 layer4 Acc 0.8789473684210526, AUC 0.9610840082168579, avg_entr 0.02186930738389492, f1 0.878947377204895
ep11_l4_test_time 0.11428323299998056
gc 0
Train Epoch12 Acc 0.9761666666666666 (117140/120000), AUC 0.9926084280014038
ep12_train_time 12.710389692999996
Test Epoch12 layer0 Acc 0.858421052631579, AUC 0.9526983499526978, avg_entr 0.03730223700404167, f1 0.8584210276603699
ep12_l0_test_time 0.06294720799999709
Test Epoch12 layer1 Acc 0.8731578947368421, AUC 0.9647097587585449, avg_entr 0.027116237208247185, f1 0.8731579184532166
ep12_l1_test_time 0.06882545100000925
Test Epoch12 layer2 Acc 0.878421052631579, AUC 0.9643750786781311, avg_entr 0.025483600795269012, f1 0.8784210681915283
ep12_l2_test_time 0.0803056290000086
Test Epoch12 layer3 Acc 0.8773684210526316, AUC 0.9623783826828003, avg_entr 0.026461027562618256, f1 0.8773684501647949
ep12_l3_test_time 0.09645007700001429
Test Epoch12 layer4 Acc 0.8781578947368421, AUC 0.9579334855079651, avg_entr 0.023034458979964256, f1 0.878157913684845
ep12_l4_test_time 0.11494928700000173
gc 0
Train Epoch13 Acc 0.9811666666666666 (117740/120000), AUC 0.9943722486495972
ep13_train_time 12.934390395999998
Test Epoch13 layer0 Acc 0.863421052631579, AUC 0.9525145888328552, avg_entr 0.03457146883010864, f1 0.8634210228919983
ep13_l0_test_time 0.06281717199999548
Test Epoch13 layer1 Acc 0.8776315789473684, AUC 0.9603748321533203, avg_entr 0.020340275019407272, f1 0.8776316046714783
ep13_l1_test_time 0.0690039749999869
Test Epoch13 layer2 Acc 0.8792105263157894, AUC 0.9593642354011536, avg_entr 0.017202317714691162, f1 0.8792105317115784
ep13_l2_test_time 0.0802567970000041
Test Epoch13 layer3 Acc 0.8789473684210526, AUC 0.9583345651626587, avg_entr 0.01629953272640705, f1 0.878947377204895
ep13_l3_test_time 0.09541309200000114
Test Epoch13 layer4 Acc 0.878421052631579, AUC 0.9582004547119141, avg_entr 0.014267951250076294, f1 0.8784210681915283
ep13_l4_test_time 0.11449453899999185
gc 0
Train Epoch14 Acc 0.9825 (117900/120000), AUC 0.9945852756500244
ep14_train_time 12.534211780000021
Test Epoch14 layer0 Acc 0.86, AUC 0.9502655267715454, avg_entr 0.03234904259443283, f1 0.8600000143051147
ep14_l0_test_time 0.06292517099998918
Test Epoch14 layer1 Acc 0.8802631578947369, AUC 0.9600565433502197, avg_entr 0.018369916826486588, f1 0.880263090133667
ep14_l1_test_time 0.06870190099999718
Test Epoch14 layer2 Acc 0.8807894736842106, AUC 0.9611632823944092, avg_entr 0.015107926912605762, f1 0.8807894587516785
ep14_l2_test_time 0.08016473300000371
Test Epoch14 layer3 Acc 0.8797368421052632, AUC 0.9615340232849121, avg_entr 0.014753331430256367, f1 0.8797368407249451
ep14_l3_test_time 0.09511133999998833
Test Epoch14 layer4 Acc 0.8805263157894737, AUC 0.9614450335502625, avg_entr 0.013978416100144386, f1 0.8805263042449951
ep14_l4_test_time 0.11431516600001146
gc 0
Train Epoch15 Acc 0.984225 (118107/120000), AUC 0.9946480989456177
ep15_train_time 12.674762818000005
Test Epoch15 layer0 Acc 0.8597368421052631, AUC 0.9499715566635132, avg_entr 0.0303623266518116, f1 0.8597368597984314
ep15_l0_test_time 0.06303831599998944
Test Epoch15 layer1 Acc 0.8744736842105263, AUC 0.9564672112464905, avg_entr 0.016260627657175064, f1 0.8744736909866333
ep15_l1_test_time 0.06902386499999125
Test Epoch15 layer2 Acc 0.8752631578947369, AUC 0.9563442468643188, avg_entr 0.011667515151202679, f1 0.8752631545066833
ep15_l2_test_time 0.08046263599999293
Test Epoch15 layer3 Acc 0.8757894736842106, AUC 0.9567239880561829, avg_entr 0.011903150007128716, f1 0.87578946352005
ep15_l3_test_time 0.09662353100000587
Test Epoch15 layer4 Acc 0.8752631578947369, AUC 0.9552357196807861, avg_entr 0.010880795307457447, f1 0.8752631545066833
ep15_l4_test_time 0.1146649899999943
gc 0
Train Epoch16 Acc 0.9848666666666667 (118184/120000), AUC 0.9947351217269897
ep16_train_time 12.682364981999996
Test Epoch16 layer0 Acc 0.858421052631579, AUC 0.9502435326576233, avg_entr 0.030888114124536514, f1 0.8584210276603699
ep16_l0_test_time 0.06341627200001199
Test Epoch16 layer1 Acc 0.8707894736842106, AUC 0.9597117900848389, avg_entr 0.020933115854859352, f1 0.8707894682884216
ep16_l1_test_time 0.06876356300000452
Test Epoch16 layer2 Acc 0.8728947368421053, AUC 0.958679735660553, avg_entr 0.0168311670422554, f1 0.8728947639465332
ep16_l2_test_time 0.08018680400002154
Test Epoch16 layer3 Acc 0.873421052631579, AUC 0.9574253559112549, avg_entr 0.016787860542535782, f1 0.8734210729598999
ep16_l3_test_time 0.09510797999999454
Test Epoch16 layer4 Acc 0.8736842105263158, AUC 0.9554317593574524, avg_entr 0.015131564810872078, f1 0.8736842274665833
ep16_l4_test_time 0.11453732800001148
gc 0
Train Epoch17 Acc 0.9865 (118380/120000), AUC 0.9954841732978821
ep17_train_time 12.833035591999987
Test Epoch17 layer0 Acc 0.8568421052631578, AUC 0.9482880234718323, avg_entr 0.027026383206248283, f1 0.8568421006202698
ep17_l0_test_time 0.06319095699998911
Test Epoch17 layer1 Acc 0.8689473684210526, AUC 0.9559702277183533, avg_entr 0.0169855784624815, f1 0.8689473867416382
ep17_l1_test_time 0.07268260200001464
Test Epoch17 layer2 Acc 0.8707894736842106, AUC 0.9538691639900208, avg_entr 0.011947856284677982, f1 0.8707894682884216
ep17_l2_test_time 0.08093810899998743
Test Epoch17 layer3 Acc 0.871578947368421, AUC 0.9557712078094482, avg_entr 0.011332560330629349, f1 0.8715789318084717
ep17_l3_test_time 0.09564357400000745
Test Epoch17 layer4 Acc 0.8718421052631579, AUC 0.9558833241462708, avg_entr 0.009868471883237362, f1 0.8718421459197998
ep17_l4_test_time 0.11487524000000349
gc 0
Train Epoch18 Acc 0.9872333333333333 (118468/120000), AUC 0.9956406950950623
ep18_train_time 12.713930928000025
Test Epoch18 layer0 Acc 0.8536842105263158, AUC 0.9456520080566406, avg_entr 0.025909172371029854, f1 0.8536841869354248
ep18_l0_test_time 0.06304630800002542
Test Epoch18 layer1 Acc 0.8652631578947368, AUC 0.9518628120422363, avg_entr 0.015808410942554474, f1 0.8652631640434265
ep18_l1_test_time 0.06921675300003471
Test Epoch18 layer2 Acc 0.865, AUC 0.9513552784919739, avg_entr 0.011225486174225807, f1 0.8650000095367432
ep18_l2_test_time 0.08062358799998037
Test Epoch18 layer3 Acc 0.865, AUC 0.9526117444038391, avg_entr 0.011851231567561626, f1 0.8650000095367432
ep18_l3_test_time 0.09670298499997898
Test Epoch18 layer4 Acc 0.8655263157894737, AUC 0.9510483741760254, avg_entr 0.010355588980019093, f1 0.8655263185501099
ep18_l4_test_time 0.11523607300000549
gc 0
Train Epoch19 Acc 0.9880666666666666 (118568/120000), AUC 0.9959748983383179
ep19_train_time 12.60342412700004
Test Epoch19 layer0 Acc 0.855, AUC 0.9459061622619629, avg_entr 0.02443360537290573, f1 0.8550000190734863
ep19_l0_test_time 0.06355724799999507
Test Epoch19 layer1 Acc 0.8686842105263158, AUC 0.9550665616989136, avg_entr 0.014977090992033482, f1 0.8686841726303101
ep19_l1_test_time 0.06909027299997206
Test Epoch19 layer2 Acc 0.8692105263157894, AUC 0.9520548582077026, avg_entr 0.012299701571464539, f1 0.8692105412483215
ep19_l2_test_time 0.08066741599998295
Test Epoch19 layer3 Acc 0.8689473684210526, AUC 0.953210175037384, avg_entr 0.012100731022655964, f1 0.8689473867416382
ep19_l3_test_time 0.0957876469999519
Test Epoch19 layer4 Acc 0.8694736842105263, AUC 0.9527444839477539, avg_entr 0.011831115931272507, f1 0.8694736957550049
ep19_l4_test_time 0.11520334700003332
Best AUC tensor(0.8837) 8 2
train_as_loss [[4.56174460e+02 3.56545228e+02 3.51062429e+02 3.49833508e+02
  3.49365897e+02 3.49140523e+02 3.49016198e+02 3.48941389e+02
  3.48893612e+02 3.48868000e+02 3.48853685e+02 3.48840912e+02
  3.48829799e+02 3.48822417e+02 3.48817624e+02 3.48812886e+02
  3.48808341e+02 3.48805076e+02 3.48802812e+02 3.48800498e+02]
 [1.93288071e+00 1.73833306e-05 1.34583351e-06 2.78955098e-07
  8.61925084e-08 3.26170942e-08 1.46307074e-08 2.12981488e-07
  3.33352801e-05 6.92404028e-05 2.00450601e-04 3.20562564e-04
  3.79356296e-04 2.29260411e-08 3.46220019e-10 5.38274513e-10
  9.22419159e-05 3.13276812e-06 2.01872516e-10 7.39978254e-10]
 [1.81291731e+00 1.63559131e-05 1.40717378e-06 3.10026371e-07
  1.05567762e-07 4.23146545e-08 2.32335981e-08 9.38209143e-08
  1.04656066e-04 2.10346952e-04 5.56810855e-04 7.18991708e-04
  8.47467237e-04 7.69925451e-08 9.80495930e-10 1.70188714e-09
  1.67100456e-04 5.68079342e-06 6.50723638e-10 1.95866159e-09]
 [1.69907594e+00 1.53355694e-05 1.43731735e-06 3.66422088e-07
  1.64453782e-07 7.76333242e-08 6.03219819e-08 1.29497165e-07
  2.32262556e-04 3.53656976e-04 9.59632670e-04 1.11514029e-03
  1.24757953e-03 2.87144000e-07 3.95457286e-09 6.38032406e-09
  2.29281600e-04 7.13541687e-06 2.68000385e-09 6.62314254e-09]
 [1.81040064e+00 1.80017556e-05 1.98599835e-06 6.49477702e-07
  3.90995803e-07 2.23349568e-07 2.19453528e-07 3.16736098e-07
  4.07031995e-04 6.33202420e-04 1.55511044e-03 1.72301579e-03
  1.74692240e-03 5.22827063e-07 1.63526311e-08 2.51687897e-08
  3.03168752e-04 9.34074905e-06 1.02982121e-08 2.41173791e-08]]
train_ae_loss [[11.26375213 11.86937031 10.89971102 10.12050618  9.39477287  8.83654401
   8.20961338  7.73174749  7.17954605  5.86585868  5.38960673  5.1177918
   4.92255073  4.25055058  4.04210347  3.94397038  3.84759529  3.59544125
   3.50967026  3.47118238]
 [10.86328026  9.74699693  8.70006148  7.91553538  7.17995498  6.62683468
   6.0369153   5.55735397  4.99316145  4.06440006  3.58166288  3.28585908
   3.06464606  2.38573092  2.18133116  2.08244186  1.98275154  1.73527518
   1.65266313  1.59935225]
 [11.09182184  9.27405187  7.83516401  6.99775706  6.27618547  5.73631468
   5.17237984  4.74606326  4.24106425  3.44500053  3.00820164  2.74320452
   2.55511386  1.94429273  1.7660131   1.67111425  1.58298513  1.35587897
   1.28784957  1.24647921]
 [10.65238221 10.394863    7.29415413  6.40044301  5.67363017  5.14166774
   4.60320181  4.20104785  3.72423465  3.00544647  2.6107109   2.36397379
   2.19079612  1.64028599  1.49033536  1.40741847  1.32665645  1.12727052
   1.07099297  1.03777378]
 [ 9.30901203 11.42496912  6.5735051   5.71518999  5.03079399  4.53841344
   4.04205656  3.68158706  3.24077704  2.60686967  2.25841224  2.03256403
   1.87755542  1.39621666  1.26626535  1.19482513  1.12394634  0.9492445
   0.90076924  0.87389068]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 265.14468308700003
Start Testing
Load ckpt at ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt
gc 10
Test layer0 Acc 0.8492105263157895, AUC 0.9586142897605896, avg_entr 0.0595611073076725, f1 0.8492104411125183
l0_test_time 0.06206932899999629
gc 0
Test layer1 Acc 0.8705263157894737, AUC 0.9687672853469849, avg_entr 0.04337942600250244, f1 0.8705263137817383
l1_test_time 0.07015976899998577
gc 0
Test layer2 Acc 0.871578947368421, AUC 0.9686023592948914, avg_entr 0.04096406325697899, f1 0.8715789318084717
l2_test_time 0.08200989300001993
gc 0
Test layer3 Acc 0.8728947368421053, AUC 0.968791127204895, avg_entr 0.0406266525387764, f1 0.8728947639465332
l3_test_time 0.09776175900003636
gc 0
Test layer4 Acc 0.8739473684210526, AUC 0.9690415263175964, avg_entr 0.03805782273411751, f1 0.8739473819732666
l4_test_time 0.11722757199999023
gc 0
Test threshold 0.1 Acc 0.8660526315789474, AUC 0.9614294171333313, avg_entr 0.022546311840415, f1 0.8660526275634766
t0.1_test_time 0.1196754729999725
gc 0
Test threshold 0.2 Acc 0.8623684210526316, AUC 0.9600870013237, avg_entr 0.023914381861686707, f1 0.8623684048652649
t0.2_test_time 0.11724839299995438
gc 0
Test threshold 0.3 Acc 0.8586842105263158, AUC 0.959602415561676, avg_entr 0.02784106694161892, f1 0.8586841821670532
t0.3_test_time 0.11607276099999808
gc 0
Test threshold 0.4 Acc 0.8552631578947368, AUC 0.9591957926750183, avg_entr 0.03440158814191818, f1 0.8552631735801697
t0.4_test_time 0.09583110500000203
gc 0
Test threshold 0.5 Acc 0.8505263157894737, AUC 0.9587196111679077, avg_entr 0.04097076505422592, f1 0.8505263328552246
t0.5_test_time 0.08092078399999991
gc 0
Test threshold 0.6 Acc 0.8494736842105263, AUC 0.9586405158042908, avg_entr 0.0428023636341095, f1 0.8494736552238464
t0.6_test_time 0.0757619679999948
gc 0
Test threshold 0.7 Acc 0.8492105263157895, AUC 0.9586142897605896, avg_entr 0.04296426102519035, f1 0.8492104411125183
t0.7_test_time 0.0750888649999979
gc 0
Test threshold 0.8 Acc 0.8492105263157895, AUC 0.9586142897605896, avg_entr 0.04296426102519035, f1 0.8492104411125183
t0.8_test_time 0.07541443000002346
gc 0
Test threshold 0.9 Acc 0.8492105263157895, AUC 0.9586142897605896, avg_entr 0.04296426102519035, f1 0.8492104411125183
t0.9_test_time 0.07570170799999687
