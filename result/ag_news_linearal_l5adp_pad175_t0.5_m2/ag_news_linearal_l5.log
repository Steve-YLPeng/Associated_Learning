total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.15635833333333332 (18763/120000), AUC 0.5362165570259094
ep0_train_time 9.132112503051758
Test Epoch0 threshold 0.5 Acc 0.9157894736842105, AUC 0.9809233546257019, avg_entr 0.030077528208494186
ep0_t0.5_test_time 0.25544023513793945
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.036875 (4425/120000), AUC 0.5619351863861084
ep1_train_time 8.830804586410522
Test Epoch1 threshold 0.5 Acc 0.9136513157894737, AUC 0.9811172485351562, avg_entr 0.028418390080332756
ep1_t0.5_test_time 0.25499629974365234
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.030875 (3705/120000), AUC 0.5670313835144043
ep2_train_time 8.599227905273438
Test Epoch2 threshold 0.5 Acc 0.9154605263157894, AUC 0.9810735583305359, avg_entr 0.02711271308362484
ep2_t0.5_test_time 0.25285840034484863
gc 0
Train Epoch3 Acc 0.03299166666666667 (3959/120000), AUC 0.5671180486679077
ep3_train_time 8.659153938293457
Test Epoch3 threshold 0.5 Acc 0.915625, AUC 0.9810324311256409, avg_entr 0.0268594641238451
ep3_t0.5_test_time 0.2528834342956543
gc 0
Train Epoch4 Acc 0.035475 (4257/120000), AUC 0.5667891502380371
ep4_train_time 8.616458654403687
Test Epoch4 threshold 0.5 Acc 0.915296052631579, AUC 0.9810227751731873, avg_entr 0.026209384202957153
ep4_t0.5_test_time 0.25420379638671875
gc 0
Train Epoch5 Acc 0.03460833333333333 (4153/120000), AUC 0.5664958953857422
ep5_train_time 8.563533067703247
Test Epoch5 threshold 0.5 Acc 0.9144736842105263, AUC 0.980599045753479, avg_entr 0.025682251900434494
ep5_t0.5_test_time 0.2529428005218506
gc 0
Train Epoch6 Acc 0.03261666666666667 (3914/120000), AUC 0.5659455060958862
ep6_train_time 8.71485424041748
Test Epoch6 threshold 0.5 Acc 0.9162828947368421, AUC 0.9805451035499573, avg_entr 0.026019513607025146
ep6_t0.5_test_time 0.25398898124694824
gc 0
Train Epoch7 Acc 0.032825 (3939/120000), AUC 0.5657572150230408
ep7_train_time 8.660873413085938
Test Epoch7 threshold 0.5 Acc 0.9154605263157894, AUC 0.9805639386177063, avg_entr 0.02565588988363743
ep7_t0.5_test_time 0.2534615993499756
gc 0
Train Epoch8 Acc 0.03149166666666667 (3779/120000), AUC 0.5649707913398743
ep8_train_time 8.99782419204712
Test Epoch8 threshold 0.5 Acc 0.9148026315789474, AUC 0.9804608821868896, avg_entr 0.026458341628313065
ep8_t0.5_test_time 0.2538423538208008
gc 0
Train Epoch9 Acc 0.030633333333333332 (3676/120000), AUC 0.5647133588790894
ep9_train_time 8.643537998199463
Test Epoch9 threshold 0.5 Acc 0.9139802631578947, AUC 0.9802888631820679, avg_entr 0.025906678289175034
ep9_t0.5_test_time 0.2535676956176758
Best AUC 0.9811172485351562
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9263157894736842, AUC 0.9866725206375122, avg_entr 0.029214957728981972
t0.5_test_time 0.06423807144165039
