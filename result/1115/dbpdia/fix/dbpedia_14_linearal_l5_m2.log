total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l5_m1.pt
Start Training
gc 9
[[4440.61607122   80.85146683]
 [  50.64440035   95.70472332]
 [1664.53623119  836.45357798]
 [1209.07922524  720.50475559]
 [1062.73266844  625.41944741]]
Train Epoch0 Acc 0.18109642857142857 (101414/560000), AUC 0.6157737374305725
Test Epoch0 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch0 layer1 Acc 0.9737285714285714, AUC 0.9983048439025879
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.05277142857142857, AUC 0.47226661443710327
Test Epoch0 layer3 Acc 0.033542857142857145, AUC 0.5192572474479675
Test Epoch0 layer4 Acc 0.17777142857142858, AUC 0.6360073089599609
gc 0
[[4.44061607e+03 8.08595881e+01]
 [1.67821574e-11 6.25865980e+01]
 [1.68223300e+03 9.77541516e+02]
 [1.22320633e+03 8.22168096e+02]
 [1.07261513e+03 6.80691357e+02]]
Train Epoch1 Acc 0.15927142857142856 (89192/560000), AUC 0.6363267302513123
Test Epoch1 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch1 layer1 Acc 0.9739714285714286, AUC 0.998421311378479
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2.pt  ,ep 1
Test Epoch1 layer2 Acc 0.07045714285714286, AUC 0.4878787100315094
Test Epoch1 layer3 Acc 0.04385714285714286, AUC 0.515807569026947
Test Epoch1 layer4 Acc 0.13577142857142857, AUC 0.6292625069618225
gc 0
[[4.44061607e+03 8.08597453e+01]
 [1.65363900e-04 5.69810617e+01]
 [1.68207550e+03 1.07126142e+03]
 [1.22312582e+03 8.93187097e+02]
 [1.07256714e+03 7.18202586e+02]]
Train Epoch2 Acc 0.12077857142857143 (67636/560000), AUC 0.6253013610839844
Test Epoch2 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch2 layer1 Acc 0.9741571428571428, AUC 0.9984973073005676
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2.pt  ,ep 2
Test Epoch2 layer2 Acc 0.06931428571428572, AUC 0.4759235978126526
Test Epoch2 layer3 Acc 0.05701428571428571, AUC 0.5119073987007141
Test Epoch2 layer4 Acc 0.10401428571428571, AUC 0.6187767386436462
gc 0
[[4.44061607e+03 8.08790120e+01]
 [3.93755147e-04 5.28757599e+01]
 [1.68065498e+03 1.13025466e+03]
 [1.22243231e+03 9.41254681e+02]
 [1.07193663e+03 7.47402464e+02]]
Train Epoch3 Acc 0.09494107142857143 (53167/560000), AUC 0.6197085976600647
Test Epoch3 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch3 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2.pt  ,ep 3
Test Epoch3 layer2 Acc 0.06024285714285714, AUC 0.47132641077041626
Test Epoch3 layer3 Acc 0.0575, AUC 0.4969854950904846
Test Epoch3 layer4 Acc 0.08644285714285714, AUC 0.6181614995002747
gc 0
[[4.44061607e+03 8.08854850e+01]
 [3.98040403e-04 4.91601233e+01]
 [1.67868864e+03 1.17831868e+03]
 [1.22148156e+03 9.81026868e+02]
 [1.07103666e+03 7.77214713e+02]]
Train Epoch4 Acc 0.08255535714285714 (46231/560000), AUC 0.6208076477050781
Test Epoch4 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch4 layer1 Acc 0.9747, AUC 0.99852055311203
Test Epoch4 layer2 Acc 0.05551428571428572, AUC 0.4734480381011963
Test Epoch4 layer3 Acc 0.050885714285714284, AUC 0.4831029772758484
Test Epoch4 layer4 Acc 0.07967142857142857, AUC 0.6209715008735657
gc 0
[[4.44061607e+03 8.08723198e+01]
 [3.98573587e-04 4.58849050e+01]
 [1.67667924e+03 1.22413770e+03]
 [1.22050539e+03 1.01512573e+03]
 [1.07010415e+03 8.07653883e+02]]
Train Epoch5 Acc 0.07665357142857143 (42926/560000), AUC 0.6220503449440002
Test Epoch5 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch5 layer1 Acc 0.9750428571428571, AUC 0.9985403418540955
Test Epoch5 layer2 Acc 0.051371428571428575, AUC 0.48280543088912964
Test Epoch5 layer3 Acc 0.04378571428571429, AUC 0.4731155037879944
Test Epoch5 layer4 Acc 0.07262857142857143, AUC 0.6219688653945923
gc 0
[[4.44061607e+03 8.08797351e+01]
 [3.91067210e-04 4.29927829e+01]
 [1.67472006e+03 1.26805225e+03]
 [1.21953800e+03 1.04590216e+03]
 [1.06919415e+03 8.36537574e+02]]
Train Epoch6 Acc 0.07103571428571429 (39780/560000), AUC 0.6231123208999634
Test Epoch6 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch6 layer1 Acc 0.9754428571428572, AUC 0.9985098242759705
Test Epoch6 layer2 Acc 0.04414285714285714, AUC 0.495045006275177
Test Epoch6 layer3 Acc 0.04107142857142857, AUC 0.4647371470928192
Test Epoch6 layer4 Acc 0.06818571428571428, AUC 0.6229355931282043
gc 0
[[4.44061607e+03 8.08812199e+01]
 [4.03403182e-04 4.04279804e+01]
 [1.67272430e+03 1.30934282e+03]
 [1.21856783e+03 1.07512771e+03]
 [1.06827671e+03 8.62702096e+02]]
Train Epoch7 Acc 0.06803928571428572 (38102/560000), AUC 0.6241322159767151
Test Epoch7 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch7 layer1 Acc 0.9758428571428571, AUC 0.9985225796699524
Test Epoch7 layer2 Acc 0.03835714285714286, AUC 0.5079749822616577
Test Epoch7 layer3 Acc 0.04064285714285714, AUC 0.4603347182273865
Test Epoch7 layer4 Acc 0.066, AUC 0.6245941519737244
gc 0
[[4.44061607e+03 8.08870611e+01]
 [6.70966160e-05 3.85837271e+01]
 [1.67159553e+03 1.33762883e+03]
 [1.21802701e+03 1.09557166e+03]
 [1.06775905e+03 8.80313421e+02]]
Train Epoch8 Acc 0.06634821428571429 (37155/560000), AUC 0.6247574687004089
Test Epoch8 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch8 layer1 Acc 0.9760142857142857, AUC 0.9984797835350037
Test Epoch8 layer2 Acc 0.036257142857142856, AUC 0.5132448077201843
Test Epoch8 layer3 Acc 0.04151428571428571, AUC 0.4592476487159729
Test Epoch8 layer4 Acc 0.06512857142857142, AUC 0.6245308518409729
gc 0
[[4.44061607e+03 8.08535249e+01]
 [9.75414337e-05 3.75104409e+01]
 [1.67114409e+03 1.35723333e+03]
 [1.21780688e+03 1.10967466e+03]
 [1.06755237e+03 8.92106364e+02]]
Train Epoch9 Acc 0.06524464285714286 (36537/560000), AUC 0.6244820356369019
Test Epoch9 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch9 layer1 Acc 0.9759857142857142, AUC 0.9985074400901794
Test Epoch9 layer2 Acc 0.034185714285714285, AUC 0.5175467133522034
Test Epoch9 layer3 Acc 0.041814285714285714, AUC 0.45823121070861816
Test Epoch9 layer4 Acc 0.06397142857142857, AUC 0.6247990727424622
Best AUC 0.9985482096672058
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2.pt
[[4700   40   23   14   11   67   41    7    4    6    4   18   18   47]
 [  35 4894    1    1    8    0   35    8    3    2    1    1    3    8]
 [  38   13 4606   17   49    2   10    4    5    0    1   86   20  149]
 [   4    1   26 4952   12    1    1    0    0    0    0    1    0    2]
 [  13   14   79   13 4849    8    5    1    2    0    0    1    2   13]
 [  39    1    3    4    1 4939    5    3    1    1    0    0    1    2]
 [  62   42    4    2   10   16 4802   39    9    5    1    1    4    3]
 [   0    0    0    0    2    0   12 4966   15    3    1    0    0    1]
 [   2    3    2    0    4    0   12   13 4964    0    0    0    0    0]
 [   1    0    0    2    1    0    0    8    0 4955   31    1    0    1]
 [  12    1    0    0    0    0    2    5    0   32 4947    1    0    0]
 [   7    0   43    2    0    0    0    0    0    1    0 4920   13   14]
 [  11    2   26    8    1    3    1    3    1    3    0   23 4866   52]
 [  30    5   75    8   11    3    4    9    1    4    4    5   40 4801]]
Figure(640x480)
[[4678   45   20   14   11   65   44    7    2    5    4   34   22   49]
 [  33 4901    2    2    7    0   38    1    2    2    0    0    6    6]
 [  39   14 4554   20   64    2   11    2    4    0    1  124   38  127]
 [   5    2   24 4955   12    1    1    0    0    0    0    0    0    0]
 [   9   16   61   14 4871    9    7    0    2    2    0    0    2    7]
 [  38    1    2    3    1 4944    5    2    1    0    0    0    1    2]
 [  53   37    3    2   10   19 4827   30    5    5    1    1    6    1]
 [   1    1    0    0    2    0   14 4964   13    3    1    0    0    1]
 [   2    2    2    0    5    0   14   14 4961    0    0    0    0    0]
 [   1    0    1    3    0    0    0    6    0 4953   35    0    0    1]
 [  13    1    0    0    0    0    2    3    0   36 4945    0    0    0]
 [   7    0   22    2    0    0    2    0    0    0    0 4942   14   11]
 [   7    1   18    4    1    3    1    2    0    1    0   18 4906   38]
 [  26    4   69    7   11    3    4    4    1    2    2    7   59 4801]]
Figure(640x480)
[[  41    0  420   90   40 1940   39   15   94    0    1    0  164 2156]
 [  10    0  430 2082   20    2  391    1    2    0    0    0   13 2049]
 [ 122    1   11 3813  267    8   58    0    3    0    0    0   16  701]
 [  14    0   80  122  491 1817 2438    0    0    0    0    0    0   38]
 [ 480  648    1   58 3473   15    7    9    0    0    0    0   13  296]
 [  81    0  299   29 4244   41    1    0    3    0    0    0  115  187]
 [ 120    0    6   58 3479    8    6  363  863    0    0    0   13   84]
 [  14    0   70    6  242  882    4    0  100    0    0    0 3679    3]
 [  45    0 1262 1234  922   13    1    2   18    0    0    0   20 1483]
 [2279    0   12  520 2156   14   14    0    0    0    0    0    5    0]
 [2021    0    2   40   25 2765   94    0    9    0    0    0   36    8]
 [   5    0  277   14  527 3000 1158    1    1    0    0    0    5   12]
 [ 402    0  265   62  784 3279   48    0   72    0    0    0    7   81]
 [ 283    0   53  159  236   71    5    3  478    0    0    0 3214  498]]
Figure(640x480)
[[  74    0    0    0    0   23    0 4901    0    0    0    0    0    2]
 [   5    0    0    0    0  708    0 4286    0    0    0    0    0    1]
 [  19    0    0    0    0 4435    1  516    0    0    0    0    0   29]
 [   4    0    0    0    0 3353    0 1634    0    0    0    0    0    9]
 [  10    0    0    0    0  630    0 4007    0    0    0    0    0  353]
 [  29    0    0    0    0  962    0 2665    0    0    0    0    0 1344]
 [   6    0    0    0    0  100    7 4368    0    4    0    0    0  515]
 [   1    0    0    0    0 2964    0 1369    0    0    0    0    0  666]
 [   0    0    0    0    8   26    0 4937    0   28    0    0    0    1]
 [  30    0    0    0    0 4301    0  598    0    0    2    0    0   69]
 [  45    0    0    0    4  162    0 3123    0   34 1613    0    0   19]
 [   3    0    0    0    0  260    0 4736    0    1    0    0    0    0]
 [  39    0    0    0    0  151    0 4803    0    0    0    0    0    7]
 [  31    0    0    0    0  203    0 4766    0    0    0    0    0    0]]
Figure(640x480)
[[ 544    0    0    0    0   15 2111    0   49    4    0    0    0 2277]
 [  20    0    0    0    0  277   26    2    0    1  250    0    0 4424]
 [ 142    0    0    0    0    1 1601    0    0    4    0    0    0 3252]
 [2342    0    0    2    0    0  107    0    0    9    0    2    0 2538]
 [ 608    0    0    0    0  372  259    0    0    2    0   24    0 3735]
 [ 100    0    0    0    0 1365   28    0    0   11    0    0    0 3496]
 [ 633    0    0    0    0   12  233    0    0    1    0    0    0 4121]
 [2470    0    0    0    0   23   69    0    0 1660    0    0    0  778]
 [   5    0 1606    0    0    2 1088    0    0    0    0    0    0 2299]
 [  11    0    0    0    0 3111   25    0    0 1333    2    0    0  518]
 [2352    0    0    0    0  315  104    0    0   62 1877    0    0  290]
 [ 337    0    0    0    0  107  316    0    0    7    0    0    0 4233]
 [ 685    0    0    0    0   90  522    0    0    2    0    7    0 3694]
 [4161    0   27    0    0    3  107    0    0    5    0    0    0  697]]
Figure(640x480)
