total count words 887880
vocab size 30000
found 28354 words in glove
Start Training
gc 0
[[4562.38593459   61.45600448]
 [1027.20679266  787.99971679]
 [ 807.70335728  483.9377774 ]
 [ 774.85239213  401.56051247]
 [ 639.41520569  319.57920963]]
Train Epoch0 Acc 0.09088571428571429 (50896/560000), AUC 0.47723549604415894
Test Epoch0 layer0 Acc 0.9731428571428572, AUC 0.9979956746101379
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1.pt  ,ep 0
Test Epoch0 layer1 Acc 0.0654, AUC 0.45562559366226196
Test Epoch0 layer2 Acc 0.07525714285714286, AUC 0.49025577306747437
Test Epoch0 layer3 Acc 0.06562857142857143, AUC 0.47052696347236633
Test Epoch0 layer4 Acc 0.08825714285714285, AUC 0.4761187434196472
gc 0
[[4440.79739988   65.96696583]
 [1362.52202109  888.37293001]
 [1019.98014575  555.55302456]
 [ 951.96739379  463.98156679]
 [ 754.65111125  367.63138086]]
Train Epoch1 Acc 0.08296071428571429 (46458/560000), AUC 0.4755026400089264
Test Epoch1 layer0 Acc 0.9736428571428571, AUC 0.9981317520141602
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1.pt  ,ep 1
Test Epoch1 layer1 Acc 0.06437142857142857, AUC 0.4536423683166504
Test Epoch1 layer2 Acc 0.0745, AUC 0.48797574639320374
Test Epoch1 layer3 Acc 0.06988571428571429, AUC 0.48221805691719055
Test Epoch1 layer4 Acc 0.08104285714285714, AUC 0.4786275029182434
gc 0
[[4440.63242757   73.55749623]
 [1555.60690454  931.749237  ]
 [1129.38327129  584.81460941]
 [1036.50919756  489.2023522 ]
 [ 807.15999088  388.83176729]]
Train Epoch2 Acc 0.0792875 (44401/560000), AUC 0.47682592272758484
Test Epoch2 layer0 Acc 0.9736, AUC 0.9982146620750427
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1.pt  ,ep 2
Test Epoch2 layer1 Acc 0.06344285714285715, AUC 0.45298370718955994
Test Epoch2 layer2 Acc 0.07408571428571428, AUC 0.4867197573184967
Test Epoch2 layer3 Acc 0.07614285714285714, AUC 0.4910880923271179
Test Epoch2 layer4 Acc 0.07895714285714285, AUC 0.47895726561546326
gc 0
[[4440.62061834   80.3722982 ]
 [1721.30029342  964.09927987]
 [1218.42237082  606.39551727]
 [1102.6097517   506.84619985]
 [ 847.71069509  405.23747849]]
Train Epoch3 Acc 0.07769464285714285 (43509/560000), AUC 0.47725731134414673
Test Epoch3 layer0 Acc 0.9734714285714285, AUC 0.9982529282569885
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1.pt  ,ep 3
Test Epoch3 layer1 Acc 0.06157142857142857, AUC 0.45099347829818726
Test Epoch3 layer2 Acc 0.07387142857142857, AUC 0.48677873611450195
Test Epoch3 layer3 Acc 0.08055714285714285, AUC 0.4988313615322113
Test Epoch3 layer4 Acc 0.07797142857142857, AUC 0.4796762466430664
gc 0
[[4440.61740255   85.04862237]
 [1850.67234299  983.35410273]
 [1285.99403039  620.43052313]
 [1151.36276418  517.44469987]
 [ 876.97304426  417.37250806]]
Train Epoch4 Acc 0.07714285714285714 (43200/560000), AUC 0.47776779532432556
Test Epoch4 layer0 Acc 0.9737857142857143, AUC 0.9983229041099548
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1.pt  ,ep 4
Test Epoch4 layer1 Acc 0.05977142857142857, AUC 0.44851499795913696
Test Epoch4 layer2 Acc 0.07395714285714286, AUC 0.4853818714618683
Test Epoch4 layer3 Acc 0.08688571428571429, AUC 0.5055252909660339
Test Epoch4 layer4 Acc 0.07874285714285714, AUC 0.48020532727241516
gc 0
[[4440.61607122   84.90589333]
 [1870.81255531  967.09283563]
 [1296.86209506  615.01250413]
 [1159.28004274  513.36586023]
 [ 881.20276284  419.25993004]]
Train Epoch5 Acc 0.07953214285714286 (44538/560000), AUC 0.4777373671531677
Test Epoch5 layer0 Acc 0.9737571428571429, AUC 0.9983039498329163
Test Epoch5 layer1 Acc 0.05632857142857143, AUC 0.44532206654548645
Test Epoch5 layer2 Acc 0.07432857142857142, AUC 0.4848189353942871
Test Epoch5 layer3 Acc 0.0942, AUC 0.5096411108970642
Test Epoch5 layer4 Acc 0.08242857142857143, AUC 0.4794895350933075
gc 0
[[4440.61607122   84.43104036]
 [1870.81255656  947.08316343]
 [1296.86209562  608.99474947]
 [1159.28004253  507.36560289]
 [ 881.20276299  419.13724376]]
Train Epoch6 Acc 0.0881625 (49371/560000), AUC 0.4773285686969757
Test Epoch6 layer0 Acc 0.9738, AUC 0.9983609318733215
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1.pt  ,ep 6
Test Epoch6 layer1 Acc 0.05297142857142857, AUC 0.44364094734191895
Test Epoch6 layer2 Acc 0.07514285714285714, AUC 0.48565441370010376
Test Epoch6 layer3 Acc 0.09968571428571428, AUC 0.5125125646591187
Test Epoch6 layer4 Acc 0.09618571428571429, AUC 0.47908902168273926
gc 0
[[4440.61607122   84.17484566]
 [1870.81255585  931.07284504]
 [1296.86209506  605.83419326]
 [1159.28004304  503.00728817]
 [ 881.20276269  419.01582532]]
Train Epoch7 Acc 0.10243392857142856 (57363/560000), AUC 0.47743481397628784
Test Epoch7 layer0 Acc 0.9733571428571428, AUC 0.9983310103416443
Test Epoch7 layer1 Acc 0.049185714285714284, AUC 0.44196346402168274
Test Epoch7 layer2 Acc 0.07578571428571429, AUC 0.48452314734458923
Test Epoch7 layer3 Acc 0.1057, AUC 0.5133818984031677
Test Epoch7 layer4 Acc 0.1074, AUC 0.4784598648548126
gc 0
[[4440.61607122   83.99269816]
 [1870.81255558  917.86964573]
 [1296.86209381  603.87194128]
 [1159.28004134  500.21205104]
 [ 881.20276292  419.1520169 ]]
Train Epoch8 Acc 0.10937678571428572 (61251/560000), AUC 0.4781074523925781
Test Epoch8 layer0 Acc 0.9735285714285714, AUC 0.9983068704605103
Test Epoch8 layer1 Acc 0.04624285714285714, AUC 0.44187137484550476
Test Epoch8 layer2 Acc 0.07761428571428572, AUC 0.48391035199165344
Test Epoch8 layer3 Acc 0.10831428571428571, AUC 0.5143243670463562
Test Epoch8 layer4 Acc 0.11132857142857143, AUC 0.4797866642475128
gc 0
[[4440.61607122   83.79056493]
 [1870.81255651  907.38590422]
 [1296.86209381  602.47776878]
 [1159.2800422   498.24041404]
 [ 881.20276281  419.47525635]]
Train Epoch9 Acc 0.11146607142857143 (62421/560000), AUC 0.47939392924308777
Test Epoch9 layer0 Acc 0.9740714285714286, AUC 0.9983043074607849
Test Epoch9 layer1 Acc 0.04517142857142857, AUC 0.44263118505477905
Test Epoch9 layer2 Acc 0.08005714285714285, AUC 0.48406532406806946
Test Epoch9 layer3 Acc 0.10948571428571428, AUC 0.5138731598854065
Test Epoch9 layer4 Acc 0.11164285714285714, AUC 0.48132941126823425
Best AUC 0.9983609318733215
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1.pt
[[4674   46   25   15   11   80   42    9    4    6    4   20   21   43]
 [  32 4910    2    1    7    0   26    4    2    2    1    0    4    9]
 [  30   13 4634   18   51    1   10    3    6    0    1   74   21  138]
 [   3    2   31 4949   10    1    1    0    0    0    0    0    0    3]
 [   8   20   75   13 4849    8    6    2    2    1    0    1    3   12]
 [  30    1    3    3    1 4948    5    3    1    2    0    0    1    2]
 [  58   53    4    3   10   16 4792   41    9    5    1    1    4    3]
 [   0    1    0    0    2    0   12 4962   18    3    1    0    0    1]
 [   1    3    2    0    3    0   11   15 4964    1    0    0    0    0]
 [   1    0    1    2    0    0    0    8    0 4950   37    0    0    1]
 [  12    1    0    0    0    0    1    5    0   31 4950    0    0    0]
 [   5    0   45    2    0    0    1    1    0    1    0 4915   17   13]
 [   7    2   25    5    2    4    1    3    1    2    0   22 4880   46]
 [  30    5   87    8   12    3    4    9    1    4    3    5   40 4789]]
Figure(640x480)
[[  77   62  108   43 1166   61    8  244   52  104   32 1458  125 1460]
 [ 377  100  164   24 1911   38    7   67   81   80   13  928   71 1139]
 [  41   63   63   22 1309   36   10  132  118  163   90 1485  228 1240]
 [  55   85   87   29 1093   36    7  109  169  140   68 1785  189 1148]
 [  56   76   70   29 1193   30   15  146  138  137   53 1604  144 1309]
 [ 356   19   85  211 1286   17   23  135  168   43   79  704  135 1739]
 [  55   46   61   40 1512   36   31  269  264   77   40 1340  130 1099]
 [  41   51   81   28 1981    3   20   85   59  192  117 1885   75  382]
 [  34   41    6    4  652    1    8   51    5   13   32  183   28 3942]
 [  34   13    5    1 1644   10   14  120   12    6   91  191   18 2841]
 [ 242   42    9   13 1520    3   97  616   10   32   23  292   19 2082]
 [  55   47   41   15 2035   65   15  268   74  188   58  616  326 1197]
 [  98   92  122   64 1586   63   16  344  218  226   36  573  107 1455]
 [ 103   57  113  102 1087  393    9  363  160  169   23  836  229 1356]]
Figure(640x480)
[[ 181    0    6    4    9    1    1 4584    0    9  188   14    1    2]
 [1265    0   21    9  152    0    6 2113    0   47 1231  156    0    0]
 [ 173    0    0    6   19    0    1 4651    0   10   85   54    0    1]
 [ 255    0    1    5    5    0    0 4656    0    9   37   31    0    1]
 [ 359    0    4    6    2    1    2 4529    0    6   47   39    0    5]
 [ 711   33   39   10    4    0    0 3727    0  291  118   40    4   23]
 [ 940    0   24    5    7    1    1 3773    0   17  209   21    1    1]
 [ 110    0    4    1    0    1    0 4828    0    3   48    3    0    2]
 [  32    0   13    1    1    0    0 4837    0   31   31   54    0    0]
 [  12    0   68    8   20    0    0 4306    0    4  574    5    0    3]
 [ 112    0  246    4  281    1    2 3729    0   61  178  275    0  111]
 [  75    0    9    5    2    0    0 4771    0   16   61   53    7    1]
 [ 316    0   24    7   21    0    0 4231    0   28  323   37    3   10]
 [ 106    2    5    7   12    0    0 4724    1   26   83   29    0    5]]
Figure(640x480)
[[ 422  835    1    1  100    0    0    5    0 1158 2057  134  285    2]
 [  40  616    3    0  277    0    0   55    0 1346  806  393 1463    1]
 [ 428  661    2    3   23    0    0    1    0 1541  620   21 1699    1]
 [ 353  521    2    0   70    0    0    0    0 1647  303   12 2092    0]
 [ 417  426    0    1   15    0    0    0    0 1704  386   13 2035    3]
 [ 161  161    3   10  289    0    0   11    0  806 1618 1213  727    1]
 [ 404 1277    2   17  280    0    0   68    5 1020 1152  184  585    6]
 [  63   95    1    0   25    0    0    0    0 2715 2009   21   71    0]
 [   7 1003    6    0    2    0    0    1    0 2871  901   11  196    2]
 [  25  443    0    0    3    0    0  753    0  790 1008    5 1972    1]
 [   9 1134    0    0   50    2    0  426    0  524 1942   13  899    1]
 [ 292 1560    2   22  753    0    0    7    0  958  397  114  893    2]
 [ 581  220    1    3  143    0    0    2    0  343  562   68 3075    2]
 [ 580  151    3    0  130    0    0    1    0 1255 1485  198 1195    2]]
Figure(640x480)
[[   2    0    0  161    0    0    0  109    1   97 3075 1555    0    0]
 [   4    0    0  330    0    0    0   13    0 1934  900 1800   19    0]
 [   5    0    0  232    0    0    0    5    0  226 1429 3103    0    0]
 [   7    0    0  206    0    0    0    1    1  167 1163 3453    2    0]
 [   3    1    0  116    0    0    0    8    0  151  905 3816    0    0]
 [ 751    0   20  495    0    0    0    8    9  854 2143  720    0    0]
 [   1    1    0  100    0    0    0   91    1  615 2697 1486    8    0]
 [  80    4    0 1591    0    0    0  146    0   83 1818 1243   35    0]
 [   0    0    0   11    0    0    0    9    0  437 4107  436    0    0]
 [   7    4    0  668    0    0    0   95    0 1219 2047  959    1    0]
 [   1    0    0   85    0    0    0   28    0  185  943 3758    0    0]
 [   5    0    0   82    0    0    0   54    1  209  432 4217    0    0]
 [  11    2    0  130    0    0    0   10    1  734  978 3134    0    0]
 [  41    3    0  236    1    0    0   62    0  272 3610  774    1    0]]
Figure(640x480)
