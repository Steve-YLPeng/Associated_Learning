total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l5_m2.pt
Start Training
gc 9
[[4.44061607e+03 8.14723710e+01]
 [1.54763593e-11 1.29930953e+01]
 [4.34663418e+01 1.81768235e+01]
 [1.50917360e+03 8.86423208e+02]
 [1.33618886e+03 6.68698559e+02]]
Train Epoch0 Acc 0.078675 (44058/560000), AUC 0.5144890546798706
Test Epoch0 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch0 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch0 layer2 Acc 0.9835571428571429, AUC 0.9983415603637695
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l5_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.07337142857142857, AUC 0.5611633658409119
Test Epoch0 layer4 Acc 0.07117142857142857, AUC 0.515557587146759
gc 0
[[4.44061607e+03 8.14496176e+01]
 [1.54763593e-11 1.29929973e+01]
 [1.56944080e-11 1.05690711e+01]
 [1.52474463e+03 8.56372095e+02]
 [1.34218507e+03 6.65401800e+02]]
Train Epoch1 Acc 0.07039642857142857 (39422/560000), AUC 0.5158674716949463
Test Epoch1 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch1 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch1 layer2 Acc 0.984, AUC 0.9983140230178833
Test Epoch1 layer3 Acc 0.07447142857142858, AUC 0.5468268394470215
Test Epoch1 layer4 Acc 0.06995714285714286, AUC 0.5218895673751831
gc 0
[[4.44061607e+03 8.14442014e+01]
 [1.54763593e-11 1.29948825e+01]
 [1.69611183e-04 1.01949415e+01]
 [1.52446914e+03 8.34948865e+02]
 [1.34192469e+03 6.64711623e+02]]
Train Epoch2 Acc 0.07025535714285715 (39343/560000), AUC 0.5282189249992371
Test Epoch2 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch2 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch2 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l5_m3.pt  ,ep 2
Test Epoch2 layer3 Acc 0.07282857142857142, AUC 0.5374606847763062
Test Epoch2 layer4 Acc 0.07072857142857143, AUC 0.5334987044334412
gc 0
[[4.44061607e+03 8.15283029e+01]
 [1.54763593e-11 1.29925683e+01]
 [3.48083590e-04 9.99676196e+00]
 [1.52236349e+03 8.23547667e+02]
 [1.34000765e+03 6.63392005e+02]]
Train Epoch3 Acc 0.07084285714285714 (39672/560000), AUC 0.5415480136871338
Test Epoch3 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch3 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch3 layer2 Acc 0.9844285714285714, AUC 0.9983687996864319
Test Epoch3 layer3 Acc 0.07257142857142856, AUC 0.5326415300369263
Test Epoch3 layer4 Acc 0.07108571428571428, AUC 0.544626772403717
gc 0
[[4.44061607e+03 8.15274683e+01]
 [1.54763593e-11 1.29919706e+01]
 [3.60451639e-04 9.84753920e+00]
 [1.51951884e+03 8.15236307e+02]
 [1.33747689e+03 6.62392232e+02]]
Train Epoch4 Acc 0.07109464285714286 (39813/560000), AUC 0.5534082651138306
Test Epoch4 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch4 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch4 layer2 Acc 0.9844142857142857, AUC 0.9982212781906128
Test Epoch4 layer3 Acc 0.07322857142857143, AUC 0.530973494052887
Test Epoch4 layer4 Acc 0.07161428571428571, AUC 0.5593109726905823
gc 0
[[4.44061607e+03 8.14605732e+01]
 [1.54763593e-11 1.29932500e+01]
 [6.47365080e-05 9.63693868e+00]
 [1.51792102e+03 8.13936338e+02]
 [1.33605886e+03 6.62917387e+02]]
Train Epoch5 Acc 0.07104642857142857 (39786/560000), AUC 0.5591961145401001
Test Epoch5 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch5 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch5 layer2 Acc 0.9844285714285714, AUC 0.99834805727005
Test Epoch5 layer3 Acc 0.07368571428571428, AUC 0.5289447903633118
Test Epoch5 layer4 Acc 0.07065714285714286, AUC 0.5636269450187683
gc 0
[[4.44061607e+03 8.14949536e+01]
 [1.54763593e-11 1.29916614e+01]
 [8.68708762e-05 9.56004701e+00]
 [1.51723799e+03 8.14261962e+02]
 [1.33545221e+03 6.63856695e+02]]
Train Epoch6 Acc 0.07103035714285715 (39777/560000), AUC 0.560764729976654
Test Epoch6 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch6 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch6 layer2 Acc 0.9846571428571429, AUC 0.9982926249504089
Test Epoch6 layer3 Acc 0.07494285714285714, AUC 0.5303784608840942
Test Epoch6 layer4 Acc 0.0702, AUC 0.5616613030433655
gc 0
[[4.44061607e+03 8.14696894e+01]
 [1.54763593e-11 1.29940131e+01]
 [8.58095953e-05 9.49133867e+00]
 [1.51653742e+03 8.14761118e+02]
 [1.33482698e+03 6.64809726e+02]]
Train Epoch7 Acc 0.07066428571428572 (39572/560000), AUC 0.5608192086219788
Test Epoch7 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch7 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch7 layer2 Acc 0.9848285714285714, AUC 0.9981823563575745
Test Epoch7 layer3 Acc 0.07715714285714285, AUC 0.5314973592758179
Test Epoch7 layer4 Acc 0.0708, AUC 0.5609024167060852
gc 0
[[4.44061607e+03 8.15096142e+01]
 [1.54763593e-11 1.29920522e+01]
 [9.40864372e-05 9.42105121e+00]
 [1.51581067e+03 8.16345989e+02]
 [1.33418126e+03 6.64495362e+02]]
Train Epoch8 Acc 0.06993035714285714 (39161/560000), AUC 0.5615927577018738
Test Epoch8 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch8 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch8 layer2 Acc 0.9847571428571429, AUC 0.9982689023017883
Test Epoch8 layer3 Acc 0.07844285714285715, AUC 0.5332466959953308
Test Epoch8 layer4 Acc 0.0717, AUC 0.5617525577545166
gc 0
[[4.44061607e+03 8.14816898e+01]
 [1.54763593e-11 1.29932067e+01]
 [1.49492526e-05 9.29882455e+00]
 [1.51540612e+03 8.18446052e+02]
 [1.33382403e+03 6.63813890e+02]]
Train Epoch9 Acc 0.06951607142857143 (38929/560000), AUC 0.5617673993110657
Test Epoch9 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch9 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch9 layer2 Acc 0.9849, AUC 0.9982494115829468
Test Epoch9 layer3 Acc 0.10325714285714285, AUC 0.5335766077041626
Test Epoch9 layer4 Acc 0.06978571428571428, AUC 0.5606433153152466
Best AUC 0.9983829855918884
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l5_m3.pt
[[4674   46   25   15   11   80   42    9    4    6    4   20   21   43]
 [  32 4910    2    1    7    0   26    4    2    2    1    0    4    9]
 [  30   13 4634   18   51    1   10    3    6    0    1   74   21  138]
 [   3    2   31 4949   10    1    1    0    0    0    0    0    0    3]
 [   8   20   75   13 4849    8    6    2    2    1    0    1    3   12]
 [  30    1    3    3    1 4948    5    3    1    2    0    0    1    2]
 [  58   53    4    3   10   16 4792   41    9    5    1    1    4    3]
 [   0    1    0    0    2    0   12 4962   18    3    1    0    0    1]
 [   1    3    2    0    3    0   11   15 4964    1    0    0    0    0]
 [   1    0    1    2    0    0    0    8    0 4950   37    0    0    1]
 [  12    1    0    0    0    0    1    5    0   31 4950    0    0    0]
 [   5    0   45    2    0    0    1    1    0    1    0 4915   17   13]
 [   7    2   25    5    2    4    1    3    1    2    0   22 4880   46]
 [  30    5   87    8   12    3    4    9    1    4    3    5   40 4789]]
Figure(640x480)
[[4767   41   23    3   11   37   53    4    0    2    2   12    5   40]
 [  34 4912    5    0    6    0   34    1    1    0    0    1    0    6]
 [  16    4 4864    5   66    1    5    0    0    0    0   13    6   20]
 [   1    1   35 4940   18    2    1    0    0    0    0    2    0    0]
 [   5    4   65    5 4903    5    6    0    0    3    0    0    2    2]
 [  36    0    2    0    1 4952    4    2    0    0    0    0    1    2]
 [  46   30    5    0    6   12 4874   17    4    3    0    1    0    2]
 [   2    0    0    0    0    1   21 4966    7    0    0    1    1    1]
 [   1    1    1    0    3    0   10    7 4974    0    0    0    0    3]
 [   1    0    2    1    0    0    0    4    0 4963   27    0    1    1]
 [  13    1    1    0    0    0    1    1    0   26 4956    1    0    0]
 [   4    0   16    1    0    0    0    0    0    0    0 4963    9    7]
 [   4    1   22    0    1    2    2    0    0    0    0   22 4905   41]
 [  29    2   40    1    5    3    2    0    0    1    2    8   14 4893]]
Figure(640x480)
[[4789   39   19    5   11   32   49    2    0    2    2   10    6   34]
 [  39 4914    0    1    7    0   33    0    1    1    0    0    0    4]
 [  17    4 4855   13   58    1    6    0    0    0    0   12    8   26]
 [   1    1   15 4968   13    1    0    0    0    0    0    0    1    0]
 [   6    4   63    9 4901    5    5    0    0    3    0    0    2    2]
 [  41    0    2    0    1 4947    4    1    0    1    0    0    1    2]
 [  47   31    3    0    3   12 4875   18    4    3    0    1    1    2]
 [   2    0    1    0    0    0   17 4967   10    0    0    1    1    1]
 [   2    1    1    0    3    0    7    6 4977    0    0    0    0    3]
 [   1    0    0    1    0    0    0    4    0 4971   21    0    1    1]
 [  13    1    1    0    0    0    1    0    0   28 4956    0    0    0]
 [   6    0   14    1    0    0    0    0    0    0    0 4960   12    7]
 [   5    2   10    0    1    2    1    0    0    0    0   21 4922   36]
 [  31    2   34    1    5    3    2    0    0    1    2    7   18 4894]]
Figure(640x480)
[[  39    0    0 4785    0   27    0    1    0   18   21   32   77    0]
 [  21    0    0   27    0    9    0    0    0    6    2    6 4929    0]
 [   6    0    0   14    0   32    0    0    0 1683 3204    8   50    3]
 [   0    0    8    8    0   10    0 2656    0    0 2310    5    3    0]
 [   2    0    1    5    0 3902    0    0    0   41 1026   17    6    0]
 [   1    0    0  112    0    2    0    0    0    1    3 4881    0    0]
 [3505    0    0   63    0    2    0    0    0    7   22 1334   67    0]
 [   0    0    0    1    0    3    0    0    0  111 4845   39    1    0]
 [   1    0    0    0    0    3    0    0    0 4988    2    6    0    0]
 [   0    0    0    1    0    4    0   86    0   46 4862    0    1    0]
 [   0    0    0   12    1    0    0    0    0    1 4982    2    2    0]
 [   2    0    0    7    3   35    0    1    0    7    2    1 4942    0]
 [   6    0    0    6    0 4962    0    0    0    2    4    0   20    0]
 [ 351    0    0   29    0 4552    0    0    0   10   49    1    8    0]]
Figure(640x480)
[[  14   18    2   20    1    0    0  214    0    0    0 4723    8    0]
 [   1    3    1    4    0    0    0   45    0   15    0 4862   69    0]
 [  29 2960    4    9    0    0    0    9    0    0    0 1975   14    0]
 [   9   22    0    4    0    0    0    1    0    0    0    2 4962    0]
 [4801  160    1    2    0    0    0   14    0    1    0   13    8    0]
 [   1   14    2    0    0    0    0 4940    0    0    0   43    0    0]
 [1029   19    0    1    0    0    0 3865    0    3    1   71   11    0]
 [  19 1140    7    0    0    0    0   26    0    0 3762   45    1    0]
 [   3   10   11    0    0    0    0 4975    0    0    1    0    0    0]
 [ 124    8    0    0    0    0    0    0    0    1    0    5 4862    0]
 [   1    1    1    0   56    0    0    1    0    0    0  398 4542    0]
 [   1   93    0    2    0    0    0    0    0    4    0 4899    1    0]
 [   1  740    0   36    0    0    0    2    0 2419    0 1802    0    0]
 [  41  821  151 3902    0    0    0   34    0   10    0   38    3    0]]
Figure(640x480)
