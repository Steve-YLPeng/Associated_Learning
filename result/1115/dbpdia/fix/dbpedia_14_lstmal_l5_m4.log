total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l5_m3.pt
Start Training
gc 9
[[4.44061607e+03 8.14911915e+01]
 [1.54763593e-11 1.29921031e+01]
 [5.28888729e-04 9.99902574e+00]
 [4.04685558e+01 1.51119868e+01]
 [1.45921861e+03 8.12222235e+02]]
Train Epoch0 Acc 0.039232142857142854 (21970/560000), AUC 0.5875049829483032
Test Epoch0 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch0 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch0 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch0 layer3 Acc 0.9842, AUC 0.9972320199012756
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l5_m4.pt  ,ep 0
Test Epoch0 layer4 Acc 0.05374285714285714, AUC 0.585066020488739
gc 0
[[4.44061607e+03 8.14772569e+01]
 [1.54763593e-11 1.29927605e+01]
 [5.28888729e-04 9.99926103e+00]
 [1.59570669e-11 9.20215966e+00]
 [1.47637767e+03 8.07192242e+02]]
Train Epoch1 Acc 0.058507142857142855 (32764/560000), AUC 0.5965480208396912
Test Epoch1 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch1 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch1 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch1 layer3 Acc 0.9842285714285715, AUC 0.9974208474159241
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l5_m4.pt  ,ep 1
Test Epoch1 layer4 Acc 0.051128571428571426, AUC 0.6016427278518677
gc 0
[[4.44061607e+03 8.15015356e+01]
 [1.54763593e-11 1.29936701e+01]
 [5.28888729e-04 9.99952862e+00]
 [1.45635282e-04 9.05576849e+00]
 [1.47613313e+03 7.90005227e+02]]
Train Epoch2 Acc 0.073475 (41146/560000), AUC 0.601030707359314
Test Epoch2 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch2 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch2 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch2 layer3 Acc 0.9842714285714286, AUC 0.9975062012672424
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l5_m4.pt  ,ep 2
Test Epoch2 layer4 Acc 0.06022857142857143, AUC 0.6021386981010437
gc 0
[[4.44061607e+03 8.14677585e+01]
 [1.54763593e-11 1.29920825e+01]
 [5.28888729e-04 9.99990830e+00]
 [3.42026038e-04 8.98881694e+00]
 [1.47420461e+03 7.72456196e+02]]
Train Epoch3 Acc 0.07788214285714286 (43614/560000), AUC 0.601974368095398
Test Epoch3 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch3 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch3 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch3 layer3 Acc 0.9841428571428571, AUC 0.997622549533844
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l5_m4.pt  ,ep 3
Test Epoch3 layer4 Acc 0.12037142857142857, AUC 0.596729576587677
gc 0
[[4.44061607e+03 8.14699696e+01]
 [1.54763593e-11 1.29910767e+01]
 [5.28888729e-04 9.99998962e+00]
 [3.37590555e-04 8.94433614e+00]
 [1.47167040e+03 7.58546305e+02]]
Train Epoch4 Acc 0.09108214285714286 (51006/560000), AUC 0.598422646522522
Test Epoch4 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch4 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch4 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch4 layer3 Acc 0.9841428571428571, AUC 0.9976376891136169
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l5_m4.pt  ,ep 4
Test Epoch4 layer4 Acc 0.10934285714285714, AUC 0.5976354479789734
gc 0
[[4.44061607e+03 8.14632287e+01]
 [1.54763593e-11 1.29911655e+01]
 [5.28888729e-04 9.99881881e+00]
 [3.41105420e-04 8.91606495e+00]
 [1.46907631e+03 7.46004587e+02]]
Train Epoch5 Acc 0.08667321428571428 (48537/560000), AUC 0.5994215607643127
Test Epoch5 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch5 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch5 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch5 layer3 Acc 0.9842857142857143, AUC 0.9977813959121704
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l5_m4.pt  ,ep 5
Test Epoch5 layer4 Acc 0.08344285714285714, AUC 0.5988873243331909
gc 0
[[4.44061607e+03 8.14648053e+01]
 [1.54763593e-11 1.29917309e+01]
 [5.28888729e-04 9.99958293e+00]
 [3.28539532e-04 8.88855188e+00]
 [1.46652965e+03 7.36948948e+02]]
Train Epoch6 Acc 0.07901428571428572 (44248/560000), AUC 0.5992588996887207
Test Epoch6 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch6 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch6 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch6 layer3 Acc 0.9842857142857143, AUC 0.9976690411567688
Test Epoch6 layer4 Acc 0.0772, AUC 0.5997650027275085
gc 0
[[4.44061607e+03 8.14671666e+01]
 [1.54763593e-11 1.29936809e+01]
 [5.28888729e-04 1.00000707e+01]
 [3.35860484e-04 8.86452201e+00]
 [1.46393689e+03 7.27376244e+02]]
Train Epoch7 Acc 0.0765 (42840/560000), AUC 0.6018358469009399
Test Epoch7 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch7 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch7 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch7 layer3 Acc 0.9844, AUC 0.9976804852485657
Test Epoch7 layer4 Acc 0.07144285714285714, AUC 0.5975376963615417
gc 0
[[4.44061607e+03 8.14852594e+01]
 [1.54763593e-11 1.29920023e+01]
 [5.28888729e-04 9.99820539e+00]
 [3.22994980e-04 8.83755489e+00]
 [1.46136404e+03 7.19563557e+02]]
Train Epoch8 Acc 0.07205892857142857 (40353/560000), AUC 0.5988472700119019
Test Epoch8 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch8 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch8 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch8 layer3 Acc 0.9845142857142857, AUC 0.9976845979690552
Test Epoch8 layer4 Acc 0.0711, AUC 0.5924672484397888
gc 0
[[4.44061607e+03 8.15284296e+01]
 [1.54763593e-11 1.29928836e+01]
 [5.28888729e-04 9.99966651e+00]
 [3.35572164e-04 8.81896502e+00]
 [1.45878972e+03 7.13826538e+02]]
Train Epoch9 Acc 0.07085892857142857 (39681/560000), AUC 0.5985106825828552
Test Epoch9 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch9 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch9 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch9 layer3 Acc 0.9844285714285714, AUC 0.9977598190307617
Test Epoch9 layer4 Acc 0.07552857142857143, AUC 0.5937266945838928
Best AUC 0.9977813959121704
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l5_m4.pt
[[4674   46   25   15   11   80   42    9    4    6    4   20   21   43]
 [  32 4910    2    1    7    0   26    4    2    2    1    0    4    9]
 [  30   13 4634   18   51    1   10    3    6    0    1   74   21  138]
 [   3    2   31 4949   10    1    1    0    0    0    0    0    0    3]
 [   8   20   75   13 4849    8    6    2    2    1    0    1    3   12]
 [  30    1    3    3    1 4948    5    3    1    2    0    0    1    2]
 [  58   53    4    3   10   16 4792   41    9    5    1    1    4    3]
 [   0    1    0    0    2    0   12 4962   18    3    1    0    0    1]
 [   1    3    2    0    3    0   11   15 4964    1    0    0    0    0]
 [   1    0    1    2    0    0    0    8    0 4950   37    0    0    1]
 [  12    1    0    0    0    0    1    5    0   31 4950    0    0    0]
 [   5    0   45    2    0    0    1    1    0    1    0 4915   17   13]
 [   7    2   25    5    2    4    1    3    1    2    0   22 4880   46]
 [  30    5   87    8   12    3    4    9    1    4    3    5   40 4789]]
Figure(640x480)
[[4767   41   23    3   11   37   53    4    0    2    2   12    5   40]
 [  34 4912    5    0    6    0   34    1    1    0    0    1    0    6]
 [  16    4 4864    5   66    1    5    0    0    0    0   13    6   20]
 [   1    1   35 4940   18    2    1    0    0    0    0    2    0    0]
 [   5    4   65    5 4903    5    6    0    0    3    0    0    2    2]
 [  36    0    2    0    1 4952    4    2    0    0    0    0    1    2]
 [  46   30    5    0    6   12 4874   17    4    3    0    1    0    2]
 [   2    0    0    0    0    1   21 4966    7    0    0    1    1    1]
 [   1    1    1    0    3    0   10    7 4974    0    0    0    0    3]
 [   1    0    2    1    0    0    0    4    0 4963   27    0    1    1]
 [  13    1    1    0    0    0    1    1    0   26 4956    1    0    0]
 [   4    0   16    1    0    0    0    0    0    0    0 4963    9    7]
 [   4    1   22    0    1    2    2    0    0    0    0   22 4905   41]
 [  29    2   40    1    5    3    2    0    0    1    2    8   14 4893]]
Figure(640x480)
[[4789   39   19    5   11   32   49    2    0    2    2   10    6   34]
 [  39 4914    0    1    7    0   33    0    1    1    0    0    0    4]
 [  17    4 4855   13   58    1    6    0    0    0    0   12    8   26]
 [   1    1   15 4968   13    1    0    0    0    0    0    0    1    0]
 [   6    4   63    9 4901    5    5    0    0    3    0    0    2    2]
 [  41    0    2    0    1 4947    4    1    0    1    0    0    1    2]
 [  47   31    3    0    3   12 4875   18    4    3    0    1    1    2]
 [   2    0    1    0    0    0   17 4967   10    0    0    1    1    1]
 [   2    1    1    0    3    0    7    6 4977    0    0    0    0    3]
 [   1    0    0    1    0    0    0    4    0 4971   21    0    1    1]
 [  13    1    1    0    0    0    1    0    0   28 4956    0    0    0]
 [   6    0   14    1    0    0    0    0    0    0    0 4960   12    7]
 [   5    2   10    0    1    2    1    0    0    0    0   21 4922   36]
 [  31    2   34    1    5    3    2    0    0    1    2    7   18 4894]]
Figure(640x480)
[[4798   37   19    5   11   31   49    3    0    2    2    8    6   29]
 [  39 4916    0    1    7    0   31    0    1    1    0    0    0    4]
 [  16    4 4845   13   70    1    6    0    0    0    0   12    8   25]
 [   1    1   14 4968   14    1    0    0    0    0    0    0    1    0]
 [   6    4   57    8 4908    4    6    0    0    3    0    0    2    2]
 [  43    0    2    0    1 4945    4    1    0    1    0    0    1    2]
 [  48   33    2    0    3   12 4870   19    6    3    0    1    0    3]
 [   2    0    0    0    0    1   15 4969   10    0    0    1    1    1]
 [   0    1    1    0    3    0    7    6 4979    0    0    0    0    3]
 [   1    0    0    1    0    0    0    4    0 4968   24    0    1    1]
 [  13    1    0    0    1    0    1    0    0   27 4957    0    0    0]
 [   6    0   13    1    0    0    0    0    0    0    0 4960   12    8]
 [   5    2    9    0    1    2    1    0    0    0    0   20 4923   37]
 [  32    2   32    1    6    3    2    0    0    1    1    8   18 4894]]
Figure(640x480)
[[   7  106    0    0    0    0    0  118 3723  955   26   13   52    0]
 [   1    0    0    0    0    0    0 4908    7   62    2    1   19    0]
 [  28    2    0    1    0    0    0 4687    1  231   24    1   25    0]
 [   7    1    0  221    0    0    0   21    0    7    1    0 4742    0]
 [4760    8    0    3    0    0    0  113   15   40    2    2   57    0]
 [   0 4963    0    0    0    0    0   10    5   13    1    5    3    0]
 [   0   16    2    0    0    0    0  112    8   24    4    4 4830    0]
 [   0    0 4116    0    0    0    0  875    0    0    1    0    8    0]
 [   1    0    1    0    0    0    0 4992    0    0    2    0    4    0]
 [   0    0    1    0    0    0    0    4    0    1    0 4953   41    0]
 [   0    1    1    0    0    0    0    7    6    5    0   20 4960    0]
 [   0    0    0    1    0    0    0 4955    0   33    5    0    6    0]
 [   1    1    0    2    0    0    0   27    1  161   70    0 4737    0]
 [   0    7    0    0    0    0    0   75    5   27 4870    2   14    0]]
Figure(640x480)
