total count words 887880
vocab size 30000
found 28354 words in glove
Start Training
gc 0
[[4561.39327288   61.93000718]
 [ 999.49239049           nan]
 [ 835.30584719           nan]
 [ 742.98406383           nan]
 [ 674.2497264            nan]]
Train Epoch0 Acc 0.062107142857142854 (34780/560000), AUC 0.46883389353752136
Test Epoch0 layer0 Acc 0.9733857142857143, AUC 0.9980462789535522
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1.pt  ,ep 0
Test Epoch0 layer1 Acc 0.0965, AUC 0.5047419667243958
Test Epoch0 layer2 Acc 0.07282857142857142, AUC 0.4864051043987274
Test Epoch0 layer3 Acc 0.0759, AUC 0.5571044683456421
Test Epoch0 layer4 Acc 0.06027142857142857, AUC 0.4668164551258087
gc 0
[[4440.80802166   66.18086275]
 [1326.66988182           nan]
 [1044.889985             nan]
 [ 907.46373852           nan]
 [ 787.60639322           nan]]
Train Epoch1 Acc 0.056608928571428574 (31701/560000), AUC 0.46485549211502075
Test Epoch1 layer0 Acc 0.9737857142857143, AUC 0.9981819987297058
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1.pt  ,ep 1
Test Epoch1 layer1 Acc 0.09182857142857143, AUC 0.5086719393730164
Test Epoch1 layer2 Acc 0.07265714285714285, AUC 0.48371246457099915
Test Epoch1 layer3 Acc 0.06572857142857143, AUC 0.5573486685752869
Test Epoch1 layer4 Acc 0.05444285714285714, AUC 0.4660966992378235
gc 0
[[4440.63337326   73.99875671]
 [1517.72692549           nan]
 [1157.57112324           nan]
 [ 988.97384131           nan]
 [ 841.72369492           nan]]
Train Epoch2 Acc 0.050691071428571426 (28387/560000), AUC 0.46364539861679077
Test Epoch2 layer0 Acc 0.974, AUC 0.998245894908905
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1.pt  ,ep 2
Test Epoch2 layer1 Acc 0.09011428571428572, AUC 0.5122965574264526
Test Epoch2 layer2 Acc 0.07261428571428571, AUC 0.48238465189933777
Test Epoch2 layer3 Acc 0.05594285714285714, AUC 0.5567718148231506
Test Epoch2 layer4 Acc 0.04758571428571429, AUC 0.4637996554374695
gc 0
[[4440.62065661   81.06768472]
 [1683.70653588           nan]
 [1250.73456818           nan]
 [1053.50519967           nan]
 [ 885.00761254           nan]]
Train Epoch3 Acc 0.04421428571428571 (24760/560000), AUC 0.4613300859928131
Test Epoch3 layer0 Acc 0.9739714285714286, AUC 0.9983092546463013
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1.pt  ,ep 3
Test Epoch3 layer1 Acc 0.08977142857142857, AUC 0.5147204995155334
Test Epoch3 layer2 Acc 0.07221428571428572, AUC 0.4810763895511627
Test Epoch3 layer3 Acc 0.047657142857142856, AUC 0.5574861168861389
Test Epoch3 layer4 Acc 0.041114285714285714, AUC 0.46114876866340637
gc 0
[[4440.61750519   85.94028164]
 [1815.93929699           nan]
 [1322.09314817           nan]
 [1101.07200631           nan]
 [ 917.58691229           nan]]
Train Epoch4 Acc 0.03974107142857143 (22255/560000), AUC 0.4581233859062195
Test Epoch4 layer0 Acc 0.9741571428571428, AUC 0.9982997179031372
Test Epoch4 layer1 Acc 0.09014285714285715, AUC 0.5140612721443176
Test Epoch4 layer2 Acc 0.0717, AUC 0.48027923703193665
Test Epoch4 layer3 Acc 0.04352857142857143, AUC 0.558210551738739
Test Epoch4 layer4 Acc 0.03907142857142857, AUC 0.45773977041244507
gc 0
[[4440.61607122   85.85351903]
 [1839.05878687           nan]
 [1334.4016152            nan]
 [1109.07653838           nan]
 [ 922.96465766           nan]]
Train Epoch5 Acc 0.03835178571428571 (21477/560000), AUC 0.45523205399513245
Test Epoch5 layer0 Acc 0.9737571428571429, AUC 0.9983277916908264
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1.pt  ,ep 5
Test Epoch5 layer1 Acc 0.09292857142857143, AUC 0.5105584859848022
Test Epoch5 layer2 Acc 0.07018571428571428, AUC 0.47834330797195435
Test Epoch5 layer3 Acc 0.04212857142857143, AUC 0.5602960586547852
Test Epoch5 layer4 Acc 0.0382, AUC 0.4551598131656647
gc 0
[[4440.61607122   85.49076735]
 [1839.05878663           nan]
 [1334.4016149            nan]
 [1109.07653885           nan]
 [ 922.96465741           nan]]
Train Epoch6 Acc 0.03717142857142857 (20816/560000), AUC 0.4519936740398407
Test Epoch6 layer0 Acc 0.9737857142857143, AUC 0.9983240365982056
Test Epoch6 layer1 Acc 0.09411428571428572, AUC 0.5095803737640381
Test Epoch6 layer2 Acc 0.06842857142857142, AUC 0.4778751730918884
Test Epoch6 layer3 Acc 0.04032857142857143, AUC 0.5616185665130615
Test Epoch6 layer4 Acc 0.03712857142857143, AUC 0.4515915811061859
gc 0
[[4440.61607122   85.19633532]
 [1839.05878589           nan]
 [1334.40161505           nan]
 [1109.0765397            nan]
 [ 922.96465668           nan]]
Train Epoch7 Acc 0.03579821428571429 (20047/560000), AUC 0.4487498700618744
Test Epoch7 layer0 Acc 0.9739428571428571, AUC 0.9983223080635071
Test Epoch7 layer1 Acc 0.09425714285714286, AUC 0.507575273513794
Test Epoch7 layer2 Acc 0.06747142857142857, AUC 0.4773155152797699
Test Epoch7 layer3 Acc 0.039857142857142855, AUC 0.5628985166549683
Test Epoch7 layer4 Acc 0.03547142857142857, AUC 0.44820624589920044
gc 0
[[4440.61607122   83.34982511]
 [1839.05878636           nan]
 [1334.40161452           nan]
 [1109.0765387            nan]
 [ 922.9646571            nan]]
Train Epoch8 Acc 0.03517142857142857 (19696/560000), AUC 0.4469013512134552
Test Epoch8 layer0 Acc 0.9740142857142857, AUC 0.9983325004577637
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1.pt  ,ep 8
Test Epoch8 layer1 Acc 0.09464285714285714, AUC 0.5077691078186035
Test Epoch8 layer2 Acc 0.06698571428571429, AUC 0.4761672616004944
Test Epoch8 layer3 Acc 0.03918571428571429, AUC 0.5631900429725647
Test Epoch8 layer4 Acc 0.03527142857142857, AUC 0.4473184049129486
gc 0
[[4440.61607122   83.16793688]
 [1839.05878845           nan]
 [1334.40161657           nan]
 [1109.07653895           nan]
 [ 922.96465778           nan]]
Train Epoch9 Acc 0.03486607142857143 (19525/560000), AUC 0.4460614025592804
Test Epoch9 layer0 Acc 0.9736714285714285, AUC 0.9983178377151489
Test Epoch9 layer1 Acc 0.0951, AUC 0.5077683329582214
Test Epoch9 layer2 Acc 0.06655714285714286, AUC 0.4756104648113251
Test Epoch9 layer3 Acc 0.039285714285714285, AUC 0.5630624294281006
Test Epoch9 layer4 Acc 0.035385714285714284, AUC 0.44696179032325745
Best AUC 0.9983325004577637
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1.pt
[[4707   39   23   13   11   67   35    7    4    6    4   21   18   45]
 [  37 4895    2    1    6    0   30    6    4    2    1    0    5   11]
 [  37   12 4607   18   56    1    9    3    5    1    1   77   23  150]
 [   4    1   30 4949   11    1    0    0    0    0    0    0    0    4]
 [  12   18   71   11 4852    9    5    0    2    1    0    1    3   15]
 [  34    1    2    3    1 4946    5    2    1    2    0    0    1    2]
 [  69   51    5    2   11   18 4782   38   11    5    1    1    3    3]
 [   0    1    0    0    2    0   11 4964   17    3    1    0    0    1]
 [   1    2    2    0    4    0    8   12 4971    0    0    0    0    0]
 [   1    0    0    2    0    0    0    6    0 4961   28    1    0    1]
 [  13    1    0    0    0    0    2    3    0   38 4943    0    0    0]
 [   8    0   37    3    0    0    0    0    0    1    1 4923   15   12]
 [   9    2   22    7    1    3    1    3    1    2    0   20 4877   52]
 [  29    3   73    7   13    3    3    9    1    6    3    6   40 4804]]
Figure(640x480)
[[  36    0   11  186   95  815  862   42  619    3 2310   14    7    0]
 [   2    0   26  588   62  944 2204    5   19    3 1100   47    0    0]
 [   9    0   63   87   31 1851  563    0  479    0 1917    0    0    0]
 [   0    0    7  740   48 1476 1688    1  151    1  879    9    0    0]
 [   2    0    9  240   13 1271 1232    2  116    0 2114    1    0    0]
 [ 578    1    3    4  255  151 1243    0  223    0 2542    0    0    0]
 [ 200    0  114  258   16  525 1918    1  177    1 1788    2    0    0]
 [   6    3    1  409  587   19 1101    0    1    0 2867    5    1    0]
 [   0    2   21   10 1627  235 1042    2   48    7 1047    1  958    0]
 [ 103    0   40    0  953  190  261    0 2164    4 1277    0    8    0]
 [ 337    0    7    4   73  576  276    1   81    0 3642    0    3    0]
 [   8    0   71  133  110  403  699   21   69    3 3467    8    8    0]
 [  22    0    1  142    6   94 2895    1  225    3 1609    0    2    0]
 [  73    9   29  427   66  460 1050  162  306    5 2374    5   34    0]]
Figure(640x480)
[[   0    2 4961    7    9    0    4    0    1    0   14    2    0    0]
 [   0    0 4833    1    5    0   10    1    0    0  147    3    0    0]
 [  11    1 4310    9   15    8  125    0    2    0  513    6    0    0]
 [   0    0 4735    1    5    0   30    0    1    0  198   30    0    0]
 [   0    0 4267    1   70    0  204    0   50    0  197  211    0    0]
 [   0    0 4531    9  351    0   40    0    0    0   61    8    0    0]
 [   1    0 3409    7  232    0  167    0   51    0 1094   39    0    0]
 [   0    0 4520    3    0    0    6    0    2    0  469    0    0    0]
 [   0   59  734   87   10   31  601    0   32    0 3435    1    0   10]
 [   0    0 4711   52   17   14    8    0    0    0  177   21    0    0]
 [   0    0 4973    6    0    1    4    0    0    0   16    0    0    0]
 [   0    3 3487    2  474    0  630    0    0    0  295   93    0   16]
 [   0    0 4562   20   42   10  192    0   71    0   95    3    0    5]
 [   0    0 4420    1   87    0   57    0    7    0  425    3    0    0]]
Figure(640x480)
[[   0  156    0    8   25 3891  917    0    1    1    1    0    0    0]
 [   0  823    0   13   16 1595 2547    2    2    0    0    0    0    2]
 [   0  249    8   34 1068 3099  536    3    1    2    0    0    0    0]
 [   0 1649    0   10  214 1132 1968    8   18    0    0    0    0    1]
 [   0 2942    3   10   57  581 1400    2    4    0    0    1    0    0]
 [   0  129  202  530  268 1460 2376   18    3    9    1    0    4    0]
 [  10 1106    5   12  250 3226  325    2    3    0   61    0    0    0]
 [   2  158    0  231   91 3873  620   19    0    0    3    1    0    2]
 [   0    4    0    9    6 4562  387    0   31    0    0    1    0    0]
 [   0   35    0 1768   70 1391 1723    0    0    0   13    0    0    0]
 [   0   14    0  297    4 1900 2784    0    1    0    0    0    0    0]
 [   0  387   59  234  971 2616  650   47   27    0    1    8    0    0]
 [   0  114   31  547  211 3837  250    1    2    0    0    6    0    1]
 [   0  557    1   82 1043 1393 1904    5    1    1    1   10    0    2]]
Figure(640x480)
[[  42    4    2  349  127    3   47 1977    0 2311    0  138    0    0]
 [   3    0   23  170   39    0    1 2279    0 2462    3   20    0    0]
 [   4    0    1   57   91    1   10 1852    0 2955    0   29    0    0]
 [   1    0    2  300   30    1    0 3009    0 1627    1   29    0    0]
 [   0    7    6  880   45    2    0  997    0 3036    7   20    0    0]
 [  27    0    0  131 1104    0    4 1787    0 1901    0   46    0    0]
 [  20   10    0  215  114    1    3  801    0 2892    0  944    0    0]
 [   0    0    1  311 1573    0    0  340    0 2747    0   28    0    0]
 [   0    0    0  140 1845    0    2 2817    0  149   41    6    0    0]
 [ 343    0    0  239  298   22   32 2334    0 1729    0    3    0    0]
 [  26    1    0 2203  185    0   17  238    0 2299    0   31    0    0]
 [  31   35   22  552  353    1    0 2218    2 1774    3    9    0    0]
 [   4   14   18  365  159   19   13 2027    0 2371    3    7    0    0]
 [  24    4   47  359  162   34    2 1403    0 2955    4    6    0    0]]
Figure(640x480)
