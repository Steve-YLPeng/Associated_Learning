total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l5_m2_prefix.pt
Start Training
gc 9
[[4.44061607e+03 8.39029071e+01]
 [4.81543870e-04 1.31375152e+01]
 [4.43844271e+01 1.85919848e+01]
 [1.67109260e+03 8.54523624e+02]
 [1.13908440e+03 5.96565705e+02]]
Train Epoch0 Acc 0.13839107142857143 (77499/560000), AUC 0.40544477105140686
Test Epoch0 layer0 Acc 0.9735142857142857, AUC 0.9982843995094299
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l5_m3_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9845714285714285, AUC 0.9985755681991577
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l5_m3_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9844142857142857, AUC 0.9985135197639465
Test Epoch0 layer3 Acc 0.29115714285714284, AUC 0.5967200994491577
Test Epoch0 layer4 Acc 0.14152857142857142, AUC 0.42545637488365173
gc 0
[[4.44061607e+03 8.37064788e+01]
 [4.43757177e-04 1.17473327e+01]
 [1.22350450e-04 1.04357955e+01]
 [1.69203595e+03 8.44038633e+02]
 [1.14929317e+03 5.88116837e+02]]
Train Epoch1 Acc 0.14155357142857142 (79270/560000), AUC 0.4224415123462677
Test Epoch1 layer0 Acc 0.9741, AUC 0.9983264803886414
Test Epoch1 layer1 Acc 0.9850428571428571, AUC 0.9985812902450562
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l5_m3_prefix.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9848857142857143, AUC 0.9984685182571411
Test Epoch1 layer3 Acc 0.29495714285714286, AUC 0.5990096926689148
Test Epoch1 layer4 Acc 0.14122857142857143, AUC 0.42718714475631714
gc 0
[[4.44061607e+03 8.36141612e+01]
 [4.27530725e-04 1.07664347e+01]
 [5.17379357e-04 9.49695965e+00]
 [1.69024136e+03 8.32391963e+02]
 [1.14863479e+03 5.81856912e+02]]
Train Epoch2 Acc 0.14133035714285713 (79145/560000), AUC 0.42801475524902344
Test Epoch2 layer0 Acc 0.9736857142857143, AUC 0.9983164072036743
Test Epoch2 layer1 Acc 0.9853285714285714, AUC 0.9985743761062622
Test Epoch2 layer2 Acc 0.9852, AUC 0.9984902143478394
Test Epoch2 layer3 Acc 0.25995714285714283, AUC 0.6105929613113403
Test Epoch2 layer4 Acc 0.14065714285714287, AUC 0.4275627136230469
gc 0
[[4.44061607e+03 8.34949884e+01]
 [4.06566315e-04 9.93914997e+00]
 [7.22573360e-04 8.76998525e+00]
 [1.68649519e+03 8.24547212e+02]
 [1.14708154e+03 5.75940147e+02]]
Train Epoch3 Acc 0.13916071428571428 (77930/560000), AUC 0.42577794194221497
Test Epoch3 layer0 Acc 0.9735142857142857, AUC 0.9983261823654175
Test Epoch3 layer1 Acc 0.9852571428571428, AUC 0.9984773993492126
Test Epoch3 layer2 Acc 0.9851571428571428, AUC 0.9984248280525208
Test Epoch3 layer3 Acc 0.27505714285714283, AUC 0.6169808506965637
Test Epoch3 layer4 Acc 0.13408571428571428, AUC 0.4216872751712799
gc 0
[[4.44061607e+03 8.34124313e+01]
 [4.24934564e-04 9.22675979e+00]
 [7.60399846e-04 8.16876448e+00]
 [1.68234827e+03 8.19095020e+02]
 [1.14528755e+03 5.69940861e+02]]
Train Epoch4 Acc 0.12051607142857143 (67489/560000), AUC 0.42168092727661133
Test Epoch4 layer0 Acc 0.9735571428571429, AUC 0.9983538389205933
Test Epoch4 layer1 Acc 0.9852, AUC 0.9984404444694519
Test Epoch4 layer2 Acc 0.9852428571428572, AUC 0.9983779191970825
Test Epoch4 layer3 Acc 0.2671, AUC 0.6145099997520447
Test Epoch4 layer4 Acc 0.10292857142857142, AUC 0.4186365604400635
gc 0
[[4.44061607e+03 8.18988400e+01]
 [7.13406658e-05 8.04132503e+00]
 [1.31038802e-04 7.07480409e+00]
 [1.68001334e+03 8.16107951e+02]
 [1.14430285e+03 5.68392207e+02]]
Train Epoch5 Acc 0.103125 (57750/560000), AUC 0.41842183470726013
Test Epoch5 layer0 Acc 0.9739, AUC 0.9983150362968445
Test Epoch5 layer1 Acc 0.9852571428571428, AUC 0.9983293414115906
Test Epoch5 layer2 Acc 0.9852285714285715, AUC 0.9981632232666016
Test Epoch5 layer3 Acc 0.26677142857142855, AUC 0.6200855374336243
Test Epoch5 layer4 Acc 0.09388571428571428, AUC 0.4222339987754822
gc 0
[[4.44061607e+03 8.18332089e+01]
 [1.04593473e-04 7.65266881e+00]
 [1.89661639e-04 6.72247792e+00]
 [1.67903105e+03 8.16731779e+02]
 [1.14388346e+03 5.68261295e+02]]
Train Epoch6 Acc 0.09322142857142857 (52204/560000), AUC 0.41872638463974
Test Epoch6 layer0 Acc 0.9736428571428571, AUC 0.998318612575531
Test Epoch6 layer1 Acc 0.9853714285714286, AUC 0.9983771443367004
Test Epoch6 layer2 Acc 0.9853, AUC 0.9982537627220154
Test Epoch6 layer3 Acc 0.27612857142857145, AUC 0.6246541142463684
Test Epoch6 layer4 Acc 0.0847, AUC 0.4170874059200287
gc 0
[[4.44061607e+03 8.17724160e+01]
 [1.03153287e-04 7.28341436e+00]
 [1.86628202e-04 6.39149967e+00]
 [1.67800390e+03 8.16294292e+02]
 [1.14345047e+03 5.67152528e+02]]
Train Epoch7 Acc 0.0839 (46984/560000), AUC 0.41529276967048645
Test Epoch7 layer0 Acc 0.9736142857142858, AUC 0.9983102083206177
Test Epoch7 layer1 Acc 0.9853714285714286, AUC 0.9983245730400085
Test Epoch7 layer2 Acc 0.9852714285714286, AUC 0.9982194304466248
Test Epoch7 layer3 Acc 0.2727857142857143, AUC 0.6183953881263733
Test Epoch7 layer4 Acc 0.08031428571428571, AUC 0.41808390617370605
gc 0
[[4.44061607e+03 8.17508189e+01]
 [1.06998493e-04 6.95649247e+00]
 [1.92893328e-04 6.09985020e+00]
 [1.67696730e+03 8.15655904e+02]
 [1.14301364e+03 5.66586304e+02]]
Train Epoch8 Acc 0.07750357142857142 (43402/560000), AUC 0.4153807461261749
Test Epoch8 layer0 Acc 0.9734571428571429, AUC 0.9982904195785522
Test Epoch8 layer1 Acc 0.9853142857142857, AUC 0.9982818365097046
Test Epoch8 layer2 Acc 0.9853571428571428, AUC 0.998184323310852
Test Epoch8 layer3 Acc 0.27354285714285714, AUC 0.6172875165939331
Test Epoch8 layer4 Acc 0.07817142857142857, AUC 0.4118853211402893
gc 0
[[4.44061607e+03 8.09175449e+01]
 [1.64505823e-05 6.34310436e+00]
 [3.12951007e-05 5.51572851e+00]
 [1.67636568e+03 8.16765997e+02]
 [1.14275459e+03 5.67007627e+02]]
Train Epoch9 Acc 0.07640535714285714 (42787/560000), AUC 0.41157063841819763
Test Epoch9 layer0 Acc 0.9737857142857143, AUC 0.9982927441596985
Test Epoch9 layer1 Acc 0.9853, AUC 0.9981893301010132
Test Epoch9 layer2 Acc 0.9852571428571428, AUC 0.9980171918869019
Test Epoch9 layer3 Acc 0.2685, AUC 0.6162010431289673
Test Epoch9 layer4 Acc 0.07772857142857142, AUC 0.41090792417526245
Best AUC 0.9985812902450562
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l5_m3_prefix.pt
[[4705   38   23   15   11   62   42    8    4    6    4   22   20   40]
 [  37 4886    3    2    7    0   38    9    3    2    1    1    4    7]
 [  37   13 4611   17   55    1   12    4    5    0    1   87   24  133]
 [   4    1   29 4950   12    0    1    0    0    0    0    2    0    1]
 [   8   15   65   11 4868    9    7    1    2    0    0    3    3    8]
 [  37    2    3    3    1 4940    5    3    1    2    0    0    1    2]
 [  64   38    2    3   10   14 4807   40    9    5    1    1    5    1]
 [   0    0    0    0    3    0   13 4962   17    3    1    0    0    1]
 [   1    3    2    0    4    0   11   12 4967    0    0    0    0    0]
 [   1    0    1    2    0    0    0    6    0 4951   38    0    0    1]
 [  12    1    0    0    0    0    2    5    0   28 4951    1    0    0]
 [   5    0   35    2    0    0    0    0    0    1    0 4932   14   11]
 [  10    2   19    5    1    1    1    3    1    2    0   24 4889   42]
 [  38    5   80    9   13    3    6   11    1    6    4    7   49 4768]]
Figure(640x480)
[[4810   36   13    4   13   35   39    3    1    1    1    6    6   32]
 [  37 4920    2    0    5    0   27    0    1    1    0    0    0    7]
 [  16    4 4860    7   62    1    3    0    1    1    0   14    6   25]
 [   2    1   20 4959   12    1    1    0    0    1    1    1    0    1]
 [   5    3   62    4 4910    4    4    2    0    3    0    0    1    2]
 [  36    0    2    0    1 4953    2    2    1    0    0    0    2    1]
 [  46   30    6    0    5   15 4860   27    4    2    0    0    2    3]
 [   1    0    0    0    0    1   12 4977    8    0    0    0    0    1]
 [   2    1    1    0    2    0    4    6 4983    0    0    0    0    1]
 [   1    0    1    1    0    0    0    3    0 4971   22    0    0    1]
 [  14    1    1    0    0    0    1    2    0   25 4952    2    0    2]
 [   7    0    8    1    0    0    0    0    0    0    0 4962   12   10]
 [   6    0    9    0    1    0    0    0    0    0    0   18 4920   46]
 [  33    0   23    1    5    4    3    0    0    2    1    2   10 4916]]
Figure(640x480)
[[4811   36   15    4   14   35   39    3    1    1    1    5    5   30]
 [  40 4918    1    0    6    0   27    0    2    1    0    0    0    5]
 [  19    5 4861    7   60    1    3    0    1    1    0   12    5   25]
 [   3    1   22 4959   12    1    0    0    0    0    0    1    0    1]
 [   6    3   63    5 4907    3    4    2    0    2    0    0    2    3]
 [  39    0    2    0    1 4950    2    2    1    0    0    0    2    1]
 [  46   30    5    0    5   14 4862   26    5    2    0    0    2    3]
 [   0    0    0    0    0    1   15 4975    8    0    0    0    0    1]
 [   2    1    1    0    2    0    4    7 4982    0    0    0    0    1]
 [   1    0    1    1    0    0    0    3    0 4971   22    0    0    1]
 [  14    1    1    0    0    0    1    3    0   24 4953    2    0    1]
 [   7    0    8    1    0    0    0    0    0    0    0 4962   13    9]
 [   7    0    9    0    1    1    0    0    0    0    0   18 4916   48]
 [  33    0   24    1    5    4    3    0    0    1    1    3   10 4915]]
Figure(640x480)
[[  11    0    1    9    0    0 1392   22    0 3501    0    0   11   53]
 [  11    0    3    2    0    0   46    0    0 4934    0    0    3    1]
 [2234    0    1   14    0    0 2485    6    0   16    0    0  242    2]
 [   9    0    0 4964    0    0    8    1    0    1    0    0   16    1]
 [  17    0    0   13    0    0   35    4    0   11    0    0 4916    4]
 [   2    0    1    1    0 2051 1126 1434    0   33    0    0    3  349]
 [  23    0    4   45    0    0 4858    7    0   55    0    0    4    4]
 [4823    0   12   14    0    0  136    0    0    1   14    0    0    0]
 [   3    0 4977    0    0    0   15    0    0    2    0    0    3    0]
 [ 207    0    0    1    0    0    1   23    0 4768    0    0    0    0]
 [  29    0    1    0    0    0   10 4948    0   12    0    0    0    0]
 [   8    0    0    1    0    0 1674    0    0    5    0    0 3307    5]
 [ 338    0    0  622    0    0    9    2    0   27    0    0 3993    9]
 [ 488    0    0    1    0    0   16    2    0 4479    0    0   13    1]]
Figure(640x480)
[[4916    0    0    0    0    0   15    3    0    0    0    1   65    0]
 [4982    0    0    0    0    0    6    5    0    0    0    0    7    0]
 [  35    0    0    0    0    0   98   31    0    0    0    0 4836    0]
 [  17    0    0    0    0    0 4968    0    0    0    0    0   15    0]
 [  31    0    0    0    0    0 4895   27    0    0    0    1   46    0]
 [4991    0    0    0    0    0    2    1    0    0    0    2    4    0]
 [4980    0    0    0    0    0    2    2    0    0    0    9    7    0]
 [ 113    0    0    0    0    0    0    2    0    0   47 4833    5    0]
 [ 108    0    0    0    0    0    2 4887    0    0    0    2    1    0]
 [   4    0    0    0    0    0    1    0    0    0    0   10 4985    0]
 [  20    0    0    0    0    0    2   58    0   28    0    0 4892    0]
 [  16    0    0    0  920    0 4030    5    0    0    0    0   29    0]
 [  18    0    0    0    1    0   14    1    0    0    0    0 4966    0]
 [  44    0    0    0    0    0    8   36    0    0    0    0 4912    0]]
Figure(640x480)
