total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l5_m3_prefix.pt
Start Training
gc 9
[[4.44061607e+03 8.37915995e+01]
 [4.91040137e-04 4.50867475e+01]
 [8.72377132e-04 3.87286049e+01]
 [3.45068259e+01 4.81296885e+01]
 [1.32171683e+03 1.08104589e+03]]
Train Epoch0 Acc 0.0117125 (6559/560000), AUC 0.354535847902298
Test Epoch0 layer0 Acc 0.9737571428571429, AUC 0.9983139038085938
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_linearal_l5_m4_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9756428571428571, AUC 0.998505175113678
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_linearal_l5_m4_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9759571428571429, AUC 0.9984569549560547
Test Epoch0 layer3 Acc 0.9762571428571428, AUC 0.9984869956970215
Test Epoch0 layer4 Acc 0.018885714285714287, AUC 0.3394051194190979
gc 0
[[4.44061607e+03 8.37234671e+01]
 [3.99783225e-04 4.19660121e+01]
 [7.38718725e-04 3.33783288e+01]
 [2.88220515e-04 3.02991168e+01]
 [1.33796360e+03 1.15451294e+03]]
Train Epoch1 Acc 0.012083928571428572 (6767/560000), AUC 0.34530502557754517
Test Epoch1 layer0 Acc 0.9737285714285714, AUC 0.9983229041099548
Test Epoch1 layer1 Acc 0.9758, AUC 0.9985032081604004
Test Epoch1 layer2 Acc 0.9761285714285715, AUC 0.9984192848205566
Test Epoch1 layer3 Acc 0.9762714285714286, AUC 0.9983035922050476
Test Epoch1 layer4 Acc 0.011871428571428571, AUC 0.3548392653465271
gc 0
[[4.44061607e+03 8.36083051e+01]
 [3.96492817e-04 3.93242523e+01]
 [7.34540642e-04 2.97354658e+01]
 [9.54885563e-04 2.59384938e+01]
 [1.33391933e+03 1.25791764e+03]]
Train Epoch2 Acc 0.012164285714285714 (6812/560000), AUC 0.36499470472335815
Test Epoch2 layer0 Acc 0.9738571428571429, AUC 0.9983218908309937
Test Epoch2 layer1 Acc 0.9762142857142857, AUC 0.998447060585022
Test Epoch2 layer2 Acc 0.9763857142857143, AUC 0.9982901811599731
Test Epoch2 layer3 Acc 0.9763428571428572, AUC 0.9981851577758789
Test Epoch2 layer4 Acc 0.01707142857142857, AUC 0.3731776177883148
gc 0
[[4.44061607e+03 8.35204548e+01]
 [3.96324659e-04 3.71592071e+01]
 [7.35811363e-04 2.71278849e+01]
 [1.25411569e-03 2.32275093e+01]
 [1.32766812e+03 1.36238212e+03]]
Train Epoch3 Acc 0.019792857142857143 (11084/560000), AUC 0.3737565875053406
Test Epoch3 layer0 Acc 0.9736142857142858, AUC 0.9983043074607849
Test Epoch3 layer1 Acc 0.9764714285714285, AUC 0.9984558820724487
Test Epoch3 layer2 Acc 0.9767571428571429, AUC 0.9982961416244507
Test Epoch3 layer3 Acc 0.9768, AUC 0.9981406331062317
Test Epoch3 layer4 Acc 0.033857142857142856, AUC 0.38125988841056824
gc 0
[[4.44061607e+03 8.34465588e+01]
 [4.08683887e-04 3.54093308e+01]
 [7.51162243e-04 2.51757637e+01]
 [1.30344053e-03 2.13885165e+01]
 [1.32108868e+03 1.45372506e+03]]
Train Epoch4 Acc 0.0287625 (16107/560000), AUC 0.3866032063961029
Test Epoch4 layer0 Acc 0.9738857142857142, AUC 0.9982744455337524
Test Epoch4 layer1 Acc 0.9765, AUC 0.9984205961227417
Test Epoch4 layer2 Acc 0.9768428571428571, AUC 0.9981725811958313
Test Epoch4 layer3 Acc 0.9770142857142857, AUC 0.9980282187461853
Test Epoch4 layer4 Acc 0.04511428571428571, AUC 0.39486533403396606
gc 0
[[4.44061607e+03 8.20425915e+01]
 [6.93371292e-05 3.33181521e+01]
 [1.29377283e-04 2.30700947e+01]
 [2.25135600e-04 1.93070862e+01]
 [1.31743043e+03 1.51962261e+03]]
Train Epoch5 Acc 0.03174642857142857 (17778/560000), AUC 0.3949793875217438
Test Epoch5 layer0 Acc 0.9740857142857143, AUC 0.9983027577400208
Test Epoch5 layer1 Acc 0.9767285714285714, AUC 0.9984616637229919
Test Epoch5 layer2 Acc 0.9768428571428571, AUC 0.9982184767723083
Test Epoch5 layer3 Acc 0.9769, AUC 0.9980548620223999
Test Epoch5 layer4 Acc 0.039542857142857143, AUC 0.3983074128627777
gc 0
[[4.44061607e+03 8.19328174e+01]
 [9.72352632e-05 3.25983847e+01]
 [1.79285967e-04 2.23770168e+01]
 [3.09612674e-04 1.87419765e+01]
 [1.31588426e+03 1.56338527e+03]]
Train Epoch6 Acc 0.024364285714285713 (13644/560000), AUC 0.3999534249305725
Test Epoch6 layer0 Acc 0.9737714285714286, AUC 0.9982942938804626
Test Epoch6 layer1 Acc 0.9769285714285715, AUC 0.998432993888855
Test Epoch6 layer2 Acc 0.9772428571428572, AUC 0.9981697201728821
Test Epoch6 layer3 Acc 0.9773428571428572, AUC 0.9980508089065552
Test Epoch6 layer4 Acc 0.03365714285714286, AUC 0.4047251343727112
gc 0
[[4.44061607e+03 8.19021273e+01]
 [9.47525956e-05 3.19634519e+01]
 [1.76568992e-04 2.17671309e+01]
 [3.05283291e-04 1.82461141e+01]
 [1.31425251e+03 1.60264995e+03]]
Train Epoch7 Acc 0.021875 (12250/560000), AUC 0.40533751249313354
Test Epoch7 layer0 Acc 0.9735428571428572, AUC 0.9982958436012268
Test Epoch7 layer1 Acc 0.977, AUC 0.9984230995178223
Test Epoch7 layer2 Acc 0.9770285714285715, AUC 0.9981433749198914
Test Epoch7 layer3 Acc 0.9771857142857143, AUC 0.9978978037834167
Test Epoch7 layer4 Acc 0.0262, AUC 0.4102976620197296
gc 0
[[4.44061607e+03 8.18997875e+01]
 [9.88578682e-05 3.13862912e+01]
 [1.80195857e-04 2.12374452e+01]
 [3.12814988e-04 1.78279145e+01]
 [1.31264812e+03 1.63847743e+03]]
Train Epoch8 Acc 0.01845535714285714 (10335/560000), AUC 0.4107946753501892
Test Epoch8 layer0 Acc 0.9735714285714285, AUC 0.9983073472976685
Test Epoch8 layer1 Acc 0.977, AUC 0.9984533190727234
Test Epoch8 layer2 Acc 0.9770857142857143, AUC 0.9981141090393066
Test Epoch8 layer3 Acc 0.9770285714285715, AUC 0.9979730248451233
Test Epoch8 layer4 Acc 0.022471428571428573, AUC 0.415872186422348
gc 0
[[4.44061607e+03 8.11145155e+01]
 [1.57828404e-05 3.04583715e+01]
 [3.02517263e-05 2.03880202e+01]
 [5.20452970e-05 1.70254759e+01]
 [1.31176333e+03 1.66624221e+03]]
Train Epoch9 Acc 0.019614285714285713 (10984/560000), AUC 0.4148114025592804
Test Epoch9 layer0 Acc 0.9737857142857143, AUC 0.998309314250946
Test Epoch9 layer1 Acc 0.9770285714285715, AUC 0.9984226226806641
Test Epoch9 layer2 Acc 0.9772428571428572, AUC 0.9981432557106018
Test Epoch9 layer3 Acc 0.9773, AUC 0.9979289770126343
Test Epoch9 layer4 Acc 0.023571428571428573, AUC 0.41759181022644043
Best AUC 0.998505175113678
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//dbpedia_14/dbpedia_14_linearal_l5_m4_prefix.pt
[[4691   41   23   14   12   69   42    8    4    6    4   23   18   45]
 [  34 4897    2    3    7    1   30    7    3    2    1    0    4    9]
 [  36   14 4594   19   57    1   11    4    5    0    1   85   22  151]
 [   3    1   29 4952   10    0    2    0    0    0    0    0    0    3]
 [  10   20   70   13 4851    9    5    1    2    1    0    1    3   14]
 [  35    2    3    3    1 4944    5    2    1    1    0    0    1    2]
 [  50   51    4    2   10   16 4802   38   14    5    1    1    4    2]
 [   0    1    0    0    2    0   11 4965   16    3    0    0    1    1]
 [   1    4    2    0    3    0    8   13 4969    0    0    0    0    0]
 [   1    0    0    2    1    0    0    7    0 4950   37    1    0    1]
 [  12    1    0    0    0    0    2    4    0   33 4947    1    0    0]
 [   5    0   36    2    0    0    1    0    0    1    0 4927   15   13]
 [   8    2   21    8    2    3    1    3    1    2    0   24 4879   46]
 [  29    6   70    8   12    3    4   10    1    5    3    7   47 4795]]
Figure(640x480)
[[4702   44   21   11   12   58   41    6    2    6    4   23   19   51]
 [  29 4909    1    2    7    0   32    1    1    2    0    0    8    8]
 [  32   14 4622   18   61    1   10    0    2    0    1   93   35  111]
 [   2    2   26 4954   10    1    1    0    0    0    0    0    1    3]
 [   6   15   59   14 4875    9    6    0    2    2    0    0    3    9]
 [  40    1    2    3    1 4942    5    2    1    0    0    0    1    2]
 [  48   42    3    4   10   15 4828   28    6    5    1    1    6    3]
 [   0    1    0    0    3    1   15 4960   13    3    3    0    0    1]
 [   1    3    2    0    5    0   15   11 4961    1    0    0    0    1]
 [   1    0    1    2    1    2    0    6    0 4951   35    0    0    1]
 [  12    1    0    0    0    0    2    3    0   32 4950    0    0    0]
 [   6    0   29    2    0    0    1    0    0    0    0 4935   15   12]
 [   6    2   16    3    1    3    0    1    0    1    0   19 4910   38]
 [  25    2   67    7   11    3    3    2    0    1    3    9   71 4796]]
Figure(640x480)
[[4726   42   22    9   12   54   43    5    1    4    5   18   16   43]
 [  33 4907    2    2    7    0   33    1    1    1    0    0    6    7]
 [  33   14 4664   17   58    2   10    0    1    2    1   63   29  106]
 [   2    2   29 4951   11    1    0    0    0    1    0    0    1    2]
 [   7   13   62   14 4873    9    6    0    2    3    0    0    4    7]
 [  43    2    1    2    1 4940    5    2    1    0    0    0    1    2]
 [  54   43    4    2    7   17 4831   27    4    3    0    1    6    1]
 [   3    1    0    0    3    1   20 4952   13    3    2    0    1    1]
 [   1    4    2    0    5    0   15   11 4960    1    0    0    0    1]
 [   1    0    1    2    1    1    0    6    0 4947   40    0    0    1]
 [  12    1    0    0    0    0    2    2    0   35 4948    0    0    0]
 [   8    0   37    2    0    0    0    0    0    0    0 4922   18   13]
 [  10    2   18    3    0    3    0    1    0    1    0   19 4903   40]
 [  28    2   72    5   10    3    4    2    0    0    1    9   71 4793]]
Figure(640x480)
[[4729   41   21    9   12   51   44    5    1    5    3   18   16   45]
 [  35 4907    1    2    7    1   35    0    1    1    0    0    3    7]
 [  36   14 4666   17   60    2   10    0    0    0    1   57   29  108]
 [   3    2   33 4947   10    1    0    0    0    1    0    0    1    2]
 [   7   12   57   14 4877    9    6    0    2    3    0    0    4    9]
 [  45    1    3    2    1 4937    5    2    1    0    0    0    1    2]
 [  52   41    4    0    8   16 4840   26    3    3    0    1    5    1]
 [   3    1    0    0    3    1   20 4954   11    3    2    0    1    1]
 [   2    4    2    0    4    0   16   15 4954    1    0    0    0    2]
 [   1    0    1    2    1    0    0    6    0 4950   38    0    0    1]
 [  13    1    0    0    0    0    2    2    0   33 4949    0    0    0]
 [   8    0   37    2    0    0    0    0    0    0    0 4922   19   12]
 [   9    1   17    2    0    3    1    1    0    0    0   18 4908   40]
 [  26    2   74    5   10    3    4    2    0    0    2    7   67 4798]]
Figure(640x480)
[[   3  400  570    1    8    2    2    0    0  527 2757    0    1  729]
 [ 453    4 2287    0 1830    5    0    0    0   38   20    1   38  324]
 [   2 2044  486   33    6  658 1362  170    0   28    2  191    0   18]
 [   0    1 1592    0    0    1   10    1    0 3386    0    0    0    9]
 [  41   53 1713  449    0   33   12    1    0 2676    1    1    2   18]
 [   0    1 4867    0    0    2    0    0    0    1    8    0    0  121]
 [ 597    1  299    0    2    1    0  173    0 3875    3    0    0   49]
 [   9    0 4013    0    0  972    0    0    0    1    0    0    0    5]
 [ 666    1 2815    0 1350    0    0    0    0   51    0    1    0  116]
 [   0    0 4667    0    0    2   36    0    0    1    0    2    3  289]
 [   1    0 2728    6    0    1    0    0    0   18  758    0 1304  184]
 [   0    7  117    0    4 3587    0    0    0   39    0   60    0 1186]
 [   0    1  832    0    1   30    0    0    0    0    0    0    0 4136]
 [   1   11 4925    0    1   44    0    6    0    1    3    0    0    8]]
Figure(640x480)
