total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l5_m1_prefix.pt
Start Training
gc 9
[[4440.61607122   84.5174711 ]
 [  45.38430356   95.19251029]
 [1532.2554324   785.60956771]
 [1102.90351819  646.45673639]
 [ 873.02290677  572.81696529]]
Train Epoch0 Acc 0.02826607142857143 (15829/560000), AUC 0.45055529475212097
Test Epoch0 layer0 Acc 0.9736714285714285, AUC 0.9983001947402954
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9737571428571429, AUC 0.9983306527137756
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.0655, AUC 0.4196203351020813
Test Epoch0 layer3 Acc 0.0332, AUC 0.48390892148017883
Test Epoch0 layer4 Acc 0.015157142857142857, AUC 0.4504968225955963
gc 0
[[4.44061607e+03 8.43053312e+01]
 [1.42760871e-11 6.43054936e+01]
 [1.55293412e+03 9.03816473e+02]
 [1.12127904e+03 7.29258185e+02]
 [8.81709075e+02 6.79376917e+02]]
Train Epoch1 Acc 0.010875 (6090/560000), AUC 0.45226240158081055
Test Epoch1 layer0 Acc 0.9739285714285715, AUC 0.9983022809028625
Test Epoch1 layer1 Acc 0.9741428571428571, AUC 0.9984372854232788
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2_prefix.pt  ,ep 1
Test Epoch1 layer2 Acc 0.05632857142857143, AUC 0.4514261782169342
Test Epoch1 layer3 Acc 0.028371428571428572, AUC 0.47615617513656616
Test Epoch1 layer4 Acc 0.009128571428571429, AUC 0.4493646025657654
gc 0
[[4.44061607e+03 8.41093046e+01]
 [1.95508367e-04 5.81021623e+01]
 [1.55273083e+03 9.80270069e+02]
 [1.12120606e+03 7.87425280e+02]
 [8.81644368e+02 7.44850604e+02]]
Train Epoch2 Acc 0.007058928571428571 (3953/560000), AUC 0.44570255279541016
Test Epoch2 layer0 Acc 0.9741142857142857, AUC 0.9982919096946716
Test Epoch2 layer1 Acc 0.9744857142857143, AUC 0.9984734654426575
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2_prefix.pt  ,ep 2
Test Epoch2 layer2 Acc 0.05558571428571429, AUC 0.45962873101234436
Test Epoch2 layer3 Acc 0.030242857142857144, AUC 0.47567540407180786
Test Epoch2 layer4 Acc 0.0076, AUC 0.4415604770183563
gc 0
[[4.44061607e+03 8.40057139e+01]
 [4.04562259e-04 5.31183988e+01]
 [1.55121923e+03 1.03163101e+03]
 [1.12068709e+03 8.29341594e+02]
 [8.81161048e+02 7.89253775e+02]]
Train Epoch3 Acc 0.007335714285714286 (4108/560000), AUC 0.4427206218242645
Test Epoch3 layer0 Acc 0.9738571428571429, AUC 0.998312771320343
Test Epoch3 layer1 Acc 0.9749428571428571, AUC 0.9985723495483398
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2_prefix.pt  ,ep 3
Test Epoch3 layer2 Acc 0.05272857142857143, AUC 0.46677666902542114
Test Epoch3 layer3 Acc 0.0353, AUC 0.47537216544151306
Test Epoch3 layer4 Acc 0.011128571428571429, AUC 0.44450193643569946
gc 0
[[4.44061607e+03 8.38805010e+01]
 [4.00939172e-04 4.87558409e+01]
 [1.54916659e+03 1.07010609e+03]
 [1.11999410e+03 8.64264135e+02]
 [8.80518094e+02 8.25023097e+02]]
Train Epoch4 Acc 0.0160125 (8967/560000), AUC 0.4511191248893738
Test Epoch4 layer0 Acc 0.9739, AUC 0.9982842803001404
Test Epoch4 layer1 Acc 0.9752714285714286, AUC 0.9984766840934753
Test Epoch4 layer2 Acc 0.04882857142857143, AUC 0.47363168001174927
Test Epoch4 layer3 Acc 0.046857142857142854, AUC 0.4708222448825836
Test Epoch4 layer4 Acc 0.02177142857142857, AUC 0.45657116174697876
gc 0
[[4.44061607e+03 8.22915127e+01]
 [3.98020090e-04 4.41205867e+01]
 [1.54707050e+03 1.10743400e+03]
 [1.11928614e+03 8.98795774e+02]
 [8.79878227e+02 8.58550327e+02]]
Train Epoch5 Acc 0.020548214285714284 (11507/560000), AUC 0.4646371304988861
Test Epoch5 layer0 Acc 0.9740714285714286, AUC 0.9983058571815491
Test Epoch5 layer1 Acc 0.9755857142857143, AUC 0.9985023140907288
Test Epoch5 layer2 Acc 0.0496, AUC 0.48056918382644653
Test Epoch5 layer3 Acc 0.056285714285714286, AUC 0.46689972281455994
Test Epoch5 layer4 Acc 0.017985714285714285, AUC 0.47147706151008606
gc 0
[[4.44061607e+03 8.22223665e+01]
 [3.97897794e-04 4.11149013e+01]
 [1.54500567e+03 1.14512123e+03]
 [1.11859112e+03 9.34035396e+02]
 [8.79235814e+02 8.90866183e+02]]
Train Epoch6 Acc 0.01845892857142857 (10337/560000), AUC 0.4802548587322235
Test Epoch6 layer0 Acc 0.9739, AUC 0.9983114004135132
Test Epoch6 layer1 Acc 0.9757571428571429, AUC 0.9985310435295105
Test Epoch6 layer2 Acc 0.04814285714285714, AUC 0.4858410060405731
Test Epoch6 layer3 Acc 0.058742857142857145, AUC 0.46405601501464844
Test Epoch6 layer4 Acc 0.01902857142857143, AUC 0.4862351417541504
gc 0
[[4.44061607e+03 8.21961846e+01]
 [3.95277965e-04 3.86357841e+01]
 [1.54298939e+03 1.17738986e+03]
 [1.11790240e+03 9.65289690e+02]
 [8.78582067e+02 9.18401551e+02]]
Train Epoch7 Acc 0.0189375 (10605/560000), AUC 0.4950794279575348
Test Epoch7 layer0 Acc 0.9735, AUC 0.998320460319519
Test Epoch7 layer1 Acc 0.9760285714285715, AUC 0.9984771013259888
Test Epoch7 layer2 Acc 0.04411428571428572, AUC 0.48878946900367737
Test Epoch7 layer3 Acc 0.05991428571428571, AUC 0.46155276894569397
Test Epoch7 layer4 Acc 0.020171428571428573, AUC 0.5006682276725769
gc 0
[[4.44061607e+03 8.20932443e+01]
 [6.59068981e-05 3.68784853e+01]
 [1.54186619e+03 1.19853550e+03]
 [1.11752896e+03 9.86366923e+02]
 [8.78235298e+02 9.36193192e+02]]
Train Epoch8 Acc 0.020882142857142856 (11694/560000), AUC 0.5055416226387024
Test Epoch8 layer0 Acc 0.9736857142857143, AUC 0.9983083009719849
Test Epoch8 layer1 Acc 0.9761285714285715, AUC 0.998480498790741
Test Epoch8 layer2 Acc 0.0409, AUC 0.489836186170578
Test Epoch8 layer3 Acc 0.05688571428571428, AUC 0.46075382828712463
Test Epoch8 layer4 Acc 0.0225, AUC 0.5078677535057068
gc 0
[[4.44061607e+03 8.13023144e+01]
 [1.02208083e-04 3.54409387e+01]
 [1.54137543e+03 1.21290200e+03]
 [1.11736040e+03 1.00039492e+03]
 [8.78085490e+02 9.48351679e+02]]
Train Epoch9 Acc 0.022128571428571428 (12392/560000), AUC 0.5117757320404053
Test Epoch9 layer0 Acc 0.9737142857142858, AUC 0.9983256459236145
Test Epoch9 layer1 Acc 0.9765428571428572, AUC 0.9984683394432068
Test Epoch9 layer2 Acc 0.04058571428571429, AUC 0.4909331202507019
Test Epoch9 layer3 Acc 0.05581428571428571, AUC 0.4604168236255646
Test Epoch9 layer4 Acc 0.023571428571428573, AUC 0.5128456950187683
Best AUC 0.9985723495483398
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2_prefix.pt
[[4694   40   23   14   11   68   43    9    4    6    4   22   19   43]
 [  36 4891    3    2    5    0   35    7    3    2    1    0    5   10]
 [  34   14 4628   18   51    1    9    4    4    0    1   79   21  136]
 [   3    1   33 4949   10    0    1    0    0    0    0    0    0    3]
 [  11   19   85   12 4837    9    6    0    2    1    0    0    2   16]
 [  38    0    3    3    1 4943    5    2    1    1    0    0    1    2]
 [  54   39    5    2   10   15 4816   38    9    5    1    1    4    1]
 [   0    1    0    0    2    0   12 4965   15    3    1    0    0    1]
 [   1    4    2    0    3    0   12   13 4965    0    0    0    0    0]
 [   1    0    1    2    1    0    0    7    0 4945   42    0    0    1]
 [  12    1    0    0    0    0    2    2    0   28 4954    0    0    1]
 [   5    0   38    2    0    0    1    0    0    1    0 4925   15   13]
 [   9    2   22    7    2    3    1    3    1    2    0   21 4879   48]
 [  33    4   81    9   12    3    6   10    1    6    3    7   46 4779]]
Figure(640x480)
[[4688   42   20   10   12   67   46    8    2    5    2   28   21   49]
 [  34 4907    2    2    7    1   30    1    2    1    0    0    6    7]
 [  35   13 4598   19   58    2   10    2    3    0    1  107   32  120]
 [   3    2   29 4953   10    0    1    0    0    0    0    0    0    2]
 [   8   18   70   14 4861    9    7    0    2    0    0    0    2    9]
 [  36    1    2    3    1 4946    5    2    1    0    0    0    1    2]
 [  50   41    4    4   10   16 4826   30    6    5    1    1    5    1]
 [   0    2    0    0    2    0   15 4965   12    2    1    0    0    1]
 [   1    3    2    0    4    0   15   12 4963    0    0    0    0    0]
 [   1    0    1    2    1    1    0    7    0 4945   41    0    0    1]
 [  13    1    0    0    0    0    2    3    0   23 4958    0    0    0]
 [   7    0   27    2    0    0    1    0    0    0    0 4938   14   11]
 [   7    2   19    4    1    3    1    2    0    1    0   18 4903   39]
 [  24    4   70    7   10    3    4    3    0    4    2    8   66 4795]]
Figure(640x480)
[[   1    1   35  335   19    0 4076  530    1    1    1    0    0    0]
 [   0    0    9    0    3    0 3189 1795    3    0    1    0    0    0]
 [   0    0   96    0 4460    0   39  405    0    0    0    0    0    0]
 [   1    0    8    0   21    0 2440 2530    0    0    0    0    0    0]
 [   2    0   20    1  279    1   37 4651    9    0    0    0    0    0]
 [  14    0  145    1  305    1   46 4479    9    0    0    0    0    0]
 [   9    0   13    1  893    1 1561  189 2332    1    0    0    0    0]
 [   1    0   77    0   33    1 3179 1709    0    0    0    0    0    0]
 [2208    0    9    0 2568   14  181   19    1    0    0    0    0    0]
 [   0    0   53    0 3849    1   68 1029    0    0    0    0    0    0]
 [   1    0   16    0  116    2 3729 1136    0    0    0    0    0    0]
 [   0    0   12    0 3553  174   39 1221    1    0    0    0    0    0]
 [   3    0    4    0   78    0 4850   65    0    0    0    0    0    0]
 [ 656    0   18    0  264   97 1903 1822    1  183    6    7    0   43]]
Figure(640x480)
[[   0    0  161  372    2  366    0    0 2937    0   15    0    3 1144]
 [   0    0    6    1  259 4276    1    0   34    0    4  155   19  245]
 [   0    0   33   71    0 4787    0    0   11    0   94    0    4    0]
 [   0    0 1004    0    0 3982    0    0    2    0   11    0    1    0]
 [   0    0 3639    3  135  793    0    0   10    8   23    0  389    0]
 [   0    0 2163    0   27 2048   57    0  703    0    2    0    0    0]
 [   0    0   43    0   15 4575  220    0   96    0    4    0   41    6]
 [   0    0    1   43  145 4181    0    0    0    0  532    0   98    0]
 [   0    0   33    0 3240 1722    2    0    1    0    2    0    0    0]
 [   0    0  100    0 2440 2223   92    0   23    0  121    0    0    1]
 [   0    0    1    2    3 2074    2    0 2900    0   16    0    0    2]
 [   0    0    8    0   15 4933    0   16    5    0   23    0    0    0]
 [  23    0    3    0    0 4949    0    0    2    0    6    0   17    0]
 [   0    0 3523    4    1 1345   68    0   14    0   44    0    0    1]]
Figure(640x480)
[[   2    1  216    0 1194    0    0 1758  250    0 1575    3    1    0]
 [ 181    0   71    0 3552    5    0 1183    2    0    1    5    0    0]
 [   2    0   56    0  363    9  282 4131   18   94   11   34    0    0]
 [1589    0    8    0   29    0    6 3297   28    0    0   43    0    0]
 [1526    0 1940    0   59    0    4  806    5    0    1  659    0    0]
 [   0    0 1172    0 1294    0    0 2423    0    0    2  109    0    0]
 [   3    0  513    0  255    0    0 4138    0   88    1    1    1    0]
 [  44    0 2415    0  816   67    0  490    1    0    0 1167    0    0]
 [  53    0   49    0   21 4487  158   77    0    0    0  155    0    0]
 [   0    0 1132    0  110   31    0 1134    1    0    0 2592    0    0]
 [   0    0 2189    0  281    1    0 2262    0    0  171   96    0    0]
 [  16    0    8    0   50 2032    0 2892    0    0    1    1    0    0]
 [   0    0  145    0  103    1    0 4751    0    0    0    0    0    0]
 [  10   11 2255    0  377  542    1 1802    0    0    0    2    0    0]]
Figure(640x480)
