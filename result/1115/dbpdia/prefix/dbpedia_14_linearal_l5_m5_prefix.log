total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask4//dbpedia_14/dbpedia_14_linearal_l5_m4_prefix.pt
Start Training
gc 9
[[4.44061607e+03 8.37331280e+01]
 [5.21377350e-04 4.19927921e+01]
 [9.24293231e-04 3.34168772e+01]
 [1.58873292e-03 3.03385742e+01]
 [3.59016395e+01 3.97952849e+01]]
Train Epoch0 Acc 0.9565232142857143 (535653/560000), AUC 0.9975506663322449
Test Epoch0 layer0 Acc 0.9740714285714286, AUC 0.9983020424842834
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_linearal_l5_m5_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9758142857142857, AUC 0.9984692931175232
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_linearal_l5_m5_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9761142857142857, AUC 0.9983553290367126
Test Epoch0 layer3 Acc 0.9760714285714286, AUC 0.9982737898826599
Test Epoch0 layer4 Acc 0.9761, AUC 0.9982271194458008
gc 0
[[4.44061607e+03 8.36340677e+01]
 [3.93384583e-04 3.93500092e+01]
 [7.20653633e-04 2.97883445e+01]
 [1.22858486e-03 2.59821444e+01]
 [5.55999106e-04 2.38096475e+01]]
Train Epoch1 Acc 0.9819214285714286 (549876/560000), AUC 0.9989380836486816
Test Epoch1 layer0 Acc 0.9736142857142858, AUC 0.9982951283454895
Test Epoch1 layer1 Acc 0.9758857142857142, AUC 0.9984473586082458
Test Epoch1 layer2 Acc 0.9762714285714286, AUC 0.9982947707176208
Test Epoch1 layer3 Acc 0.9765, AUC 0.9982097744941711
Test Epoch1 layer4 Acc 0.9766714285714285, AUC 0.9981223344802856
gc 0
[[4.44061607e+03 8.35410933e+01]
 [4.06474165e-04 3.72095542e+01]
 [7.45610899e-04 2.71637878e+01]
 [1.27222064e-03 2.32568986e+01]
 [1.78797112e-03 2.07976671e+01]]
Train Epoch2 Acc 0.9823125 (550095/560000), AUC 0.9989119172096252
Test Epoch2 layer0 Acc 0.9739, AUC 0.99830561876297
Test Epoch2 layer1 Acc 0.9764571428571429, AUC 0.9984596371650696
Test Epoch2 layer2 Acc 0.9768285714285714, AUC 0.9982210397720337
Test Epoch2 layer3 Acc 0.9769285714285715, AUC 0.9980820417404175
Test Epoch2 layer4 Acc 0.9770142857142857, AUC 0.9980849623680115
gc 0
[[4.44061607e+03 8.34871922e+01]
 [4.01069872e-04 3.54522890e+01]
 [7.44551701e-04 2.52257696e+01]
 [1.27963717e-03 2.14330840e+01]
 [2.17900342e-03 1.90111993e+01]]
Train Epoch3 Acc 0.9824446428571428 (550169/560000), AUC 0.9989105463027954
Test Epoch3 layer0 Acc 0.9739, AUC 0.9982901215553284
Test Epoch3 layer1 Acc 0.9765857142857143, AUC 0.9984235167503357
Test Epoch3 layer2 Acc 0.9768857142857142, AUC 0.9982172846794128
Test Epoch3 layer3 Acc 0.9768285714285714, AUC 0.9980328679084778
Test Epoch3 layer4 Acc 0.9769714285714286, AUC 0.9979969263076782
gc 0
[[4.44061607e+03 8.33823958e+01]
 [3.99048964e-04 3.39648850e+01]
 [7.40468871e-04 2.37154760e+01]
 [1.27968366e-03 2.01134245e+01]
 [2.16025484e-03 1.78070745e+01]]
Train Epoch4 Acc 0.9826375 (550277/560000), AUC 0.9989168047904968
Test Epoch4 layer0 Acc 0.9735714285714285, AUC 0.998293399810791
Test Epoch4 layer1 Acc 0.9767428571428571, AUC 0.9984580278396606
Test Epoch4 layer2 Acc 0.9771142857142857, AUC 0.9982007145881653
Test Epoch4 layer3 Acc 0.9770285714285715, AUC 0.9980023503303528
Test Epoch4 layer4 Acc 0.9772285714285714, AUC 0.99795001745224
gc 0
[[4.44061607e+03 8.19223413e+01]
 [7.06022873e-05 3.20514812e+01]
 [1.29619147e-04 2.18781676e+01]
 [2.24499662e-04 1.83355636e+01]
 [3.84055795e-04 1.61686620e+01]]
Train Epoch5 Acc 0.9831 (550536/560000), AUC 0.9989336729049683
Test Epoch5 layer0 Acc 0.9738285714285714, AUC 0.9983057975769043
Test Epoch5 layer1 Acc 0.9767857142857143, AUC 0.998414933681488
Test Epoch5 layer2 Acc 0.9769714285714286, AUC 0.9982209205627441
Test Epoch5 layer3 Acc 0.9770857142857143, AUC 0.9980908632278442
Test Epoch5 layer4 Acc 0.9772142857142857, AUC 0.9980149269104004
gc 0
[[4.44061607e+03 8.19011902e+01]
 [1.02027898e-04 3.14212321e+01]
 [1.89225336e-04 2.13065514e+01]
 [3.23593482e-04 1.78943133e+01]
 [5.43786907e-04 1.58011158e+01]]
Train Epoch6 Acc 0.9831928571428571 (550588/560000), AUC 0.998914361000061
Test Epoch6 layer0 Acc 0.9734714285714285, AUC 0.9983035326004028
Test Epoch6 layer1 Acc 0.9770428571428571, AUC 0.9984415173530579
Test Epoch6 layer2 Acc 0.9770714285714286, AUC 0.9981371164321899
Test Epoch6 layer3 Acc 0.9771714285714286, AUC 0.9979433417320251
Test Epoch6 layer4 Acc 0.9771857142857143, AUC 0.9979661703109741
gc 0
[[4.44061607e+03 8.18636931e+01]
 [9.49805381e-05 3.08943613e+01]
 [1.75872043e-04 2.08276891e+01]
 [3.02466155e-04 1.75233310e+01]
 [5.09794564e-04 1.54975923e+01]]
Train Epoch7 Acc 0.9832017857142857 (550593/560000), AUC 0.9989191293716431
Test Epoch7 layer0 Acc 0.9736142857142858, AUC 0.9983193278312683
Test Epoch7 layer1 Acc 0.9771142857142857, AUC 0.9984254837036133
Test Epoch7 layer2 Acc 0.9774571428571428, AUC 0.9981548190116882
Test Epoch7 layer3 Acc 0.9773428571428572, AUC 0.9979076981544495
Test Epoch7 layer4 Acc 0.9773857142857143, AUC 0.9979864358901978
gc 0
[[4.44061607e+03 8.18723497e+01]
 [9.55696280e-05 3.03733611e+01]
 [1.77560774e-04 2.04034302e+01]
 [3.05820343e-04 1.72032352e+01]
 [5.19289616e-04 1.52450555e+01]]
Train Epoch8 Acc 0.9833821428571429 (550694/560000), AUC 0.9989364743232727
Test Epoch8 layer0 Acc 0.9738428571428571, AUC 0.9982929825782776
Test Epoch8 layer1 Acc 0.9772714285714286, AUC 0.9983910918235779
Test Epoch8 layer2 Acc 0.9773428571428572, AUC 0.9982045888900757
Test Epoch8 layer3 Acc 0.9775285714285714, AUC 0.9980126023292542
Test Epoch8 layer4 Acc 0.9774714285714285, AUC 0.9979340434074402
gc 0
[[4.44061607e+03 8.11175685e+01]
 [1.57110152e-05 2.94960659e+01]
 [2.93963864e-05 1.96152757e+01]
 [5.14286335e-05 1.64548291e+01]
 [8.67304211e-05 1.45656333e+01]]
Train Epoch9 Acc 0.9836125 (550823/560000), AUC 0.9989315867424011
Test Epoch9 layer0 Acc 0.9736857142857143, AUC 0.9982947111129761
Test Epoch9 layer1 Acc 0.9772857142857143, AUC 0.9984215497970581
Test Epoch9 layer2 Acc 0.9774, AUC 0.9981614947319031
Test Epoch9 layer3 Acc 0.9772857142857143, AUC 0.9979538321495056
Test Epoch9 layer4 Acc 0.9773857142857143, AUC 0.9979816675186157
Best AUC 0.9984692931175232
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//dbpedia_14/dbpedia_14_linearal_l5_m5_prefix.pt
[[4696   40   26   15   11   66   43    8    4    6    4   20   17   44]
 [  36 4893    2    3    6    0   33    6    3    2    1    0    4   11]
 [  34   13 4628   16   52    2   10    3    4    0    1   73   20  144]
 [   4    1   31 4948   11    1    1    0    0    0    0    0    0    3]
 [   9   16   78   12 4850    8    6    0    2    1    0    2    3   13]
 [  33    1    3    3    1 4947    5    2    1    1    0    0    1    2]
 [  59   41    6    4   11   15 4803   38   11    5    1    1    3    2]
 [   0    1    0    0    2    0   12 4963   17    3    1    0    0    1]
 [   1    3    2    0    3    0    9   12 4970    0    0    0    0    0]
 [   1    0    0    2    0    0    0    6    0 4960   29    1    0    1]
 [  12    1    0    0    0    0    2    4    1   36 4943    1    0    0]
 [   6    0   43    2    0    0    0    0    0    1    0 4922   15   11]
 [   5    2   23    9    2    3    1    3    1    3    0   25 4876   47]
 [  30    4   81    9   12    3    4   10    1    5    2    7   46 4786]]
Figure(640x480)
[[4723   43   22    9   12   51   44    5    1    6    2   21   15   46]
 [  33 4904    1    2    6    1   35    1    1    2    0    0    6    8]
 [  33   13 4660   18   52    2    9    0    1    4    1   78   24  105]
 [   2    2   28 4953   11    0    1    0    0    1    0    0    0    2]
 [   6   11   68   17 4864    8    8    1    2    3    0    0    3    9]
 [  43    1    3    2    1 4939    5    2    1    0    0    0    1    2]
 [  56   40    6    3   10   13 4826   29    4    4    1    1    5    2]
 [   2    2    0    0    2    0   19 4957   11    3    3    0    0    1]
 [   2    3    2    0    5    0   13   18 4956    0    0    0    0    1]
 [   1    0    0    2    0    0    0    6    0 4963   27    0    0    1]
 [  12    1    0    0    0    0    2    3    0   49 4933    0    0    0]
 [   8    0   35    2    0    0    0    0    0    0    0 4930   14   11]
 [   8    2   19    2    0    3    0    1    0    1    0   19 4906   39]
 [  27    3   71    7   10    3    3    2    0    0    2    9   70 4793]]
Figure(640x480)
[[4744   41   23    7   11   46   44    6    1    6    2   18   12   39]
 [  38 4901    3    2    7    0   36    1    1    3    0    0    2    6]
 [  32   13 4697   14   53    1    9    0    0    5    1   53   20  102]
 [   3    2   32 4947   11    0    0    0    0    3    0    0    1    1]
 [   7   10   71   15 4868    7    8    1    1    5    0    0    2    5]
 [  45    1    2    2    1 4938    5    2    1    0    0    0    1    2]
 [  58   36    6    3    8   15 4838   26    3    3    0    1    2    1]
 [   4    1    0    0    2    1   21 4952   11    3    4    0    0    1]
 [   3    4    2    0    6    0   18   18 4946    1    0    0    0    2]
 [   1    0    0    1    0    0    0    6    0 4963   28    0    0    1]
 [  12    1    0    0    0    0    2    2    0   59 4924    0    0    0]
 [  11    0   42    2    0    0    0    0    0    0    0 4919   14   12]
 [  12    2   23    3    0    3    1    1    0    1    0   19 4894   41]
 [  31    2   81    5   10    3    3    2    0    0    1    8   57 4797]]
Figure(640x480)
[[4734   41   25    7   12   49   45    5    1    7    2   18   12   42]
 [  37 4902    1    1    8    0   36    1    1    2    0    0    3    8]
 [  32   12 4690   14   56    2    9    0    0    5    1   53   20  106]
 [   3    2   33 4947   11    0    0    0    0    3    0    0    0    1]
 [   7    9   63   15 4877    7    8    1    1    5    0    0    2    5]
 [  45    1    3    2    1 4937    5    2    1    0    0    0    1    2]
 [  57   36    6    2    8   14 4842   26    2    3    0    1    2    1]
 [   5    1    0    0    2    1   21 4951   11    3    4    0    0    1]
 [   3    5    2    0    6    0   16   19 4944    2    0    0    0    3]
 [   1    0    0    2    0    0    0    6    0 4968   22    0    0    1]
 [  12    1    0    0    0    0    2    2    0   62 4921    0    0    0]
 [  11    0   42    2    0    0    0    0    0    0    0 4916   16   13]
 [  11    2   25    3    0    3    1    1    0    1    0   19 4892   42]
 [  30    2   78    5   10    3    4    2    0    0    0    7   55 4804]]
Figure(640x480)
[[4735   40   25    8   12   50   45    5    1    6    2   16   12   43]
 [  37 4903    1    2    8    0   36    0    1    3    0    0    2    7]
 [  30   13 4698   14   58    1    9    0    0    5    1   53   18  100]
 [   3    2   30 4950   11    0    0    1    0    3    0    0    0    0]
 [   7    9   64   16 4876    7    7    1    1    6    0    0    2    4]
 [  44    1    2    0    1 4941    5    2    1    0    0    0    1    2]
 [  56   37    6    2    9   14 4839   26    3    4    0    1    2    1]
 [   3    1    0    0    2    1   22 4951   12    3    4    0    0    1]
 [   4    3    2    0    6    0   15   15 4950    2    0    0    0    3]
 [   1    0    0    2    0    0    0    6    0 4967   23    0    0    1]
 [  12    1    0    0    0    0    2    2    0   64 4919    0    0    0]
 [  10    0   44    2    0    0    0    0    0    0    0 4916   14   14]
 [  12    2   29    3    1    3    1    1    0    1    0   18 4887   42]
 [  30    2   87    5   10    3    4    2    0    0    1    7   54 4795]]
Figure(640x480)
