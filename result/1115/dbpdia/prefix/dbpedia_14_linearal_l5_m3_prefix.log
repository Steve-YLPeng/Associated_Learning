total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2_prefix.pt
Start Training
gc 9
[[4.44061607e+03 8.39203794e+01]
 [5.07456148e-04 4.87783371e+01]
 [4.26492277e+01 6.17805578e+01]
 [1.21149218e+03 9.43580776e+02]
 [1.09105653e+03 8.30625511e+02]]
Train Epoch0 Acc 0.029073214285714286 (16281/560000), AUC 0.473492830991745
Test Epoch0 layer0 Acc 0.9737857142857143, AUC 0.9982913136482239
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l5_m3_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.975, AUC 0.9984933733940125
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l5_m3_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9747285714285714, AUC 0.9984992146492004
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l5_m3_prefix.pt  ,ep 0
Test Epoch0 layer3 Acc 0.05712857142857143, AUC 0.35151195526123047
Test Epoch0 layer4 Acc 0.0061285714285714285, AUC 0.46812111139297485
gc 0
[[4.44061607e+03 8.38096987e+01]
 [3.94537145e-04 4.50830796e+01]
 [1.09637603e-04 3.87495183e+01]
 [1.23100087e+03 1.01712530e+03]
 [1.10397976e+03 9.06118964e+02]]
Train Epoch1 Acc 0.008467857142857143 (4742/560000), AUC 0.4628705084323883
Test Epoch1 layer0 Acc 0.9736142857142858, AUC 0.9982933402061462
Test Epoch1 layer1 Acc 0.9753714285714286, AUC 0.9984849095344543
Test Epoch1 layer2 Acc 0.9759857142857142, AUC 0.998462975025177
Test Epoch1 layer3 Acc 0.06362857142857142, AUC 0.3474500775337219
Test Epoch1 layer4 Acc 0.013542857142857143, AUC 0.46057143807411194
gc 0
[[4.44061607e+03 8.37358889e+01]
 [4.07895345e-04 4.19231979e+01]
 [4.63166596e-04 3.33387420e+01]
 [1.23008229e+03 1.13042567e+03]
 [1.10273587e+03 1.00337976e+03]]
Train Epoch2 Acc 0.011244642857142858 (6297/560000), AUC 0.46153149008750916
Test Epoch2 layer0 Acc 0.9736142857142858, AUC 0.9982983469963074
Test Epoch2 layer1 Acc 0.9760285714285715, AUC 0.9984771609306335
Test Epoch2 layer2 Acc 0.9765, AUC 0.9984001517295837
Test Epoch2 layer3 Acc 0.06924285714285715, AUC 0.3531160354614258
Test Epoch2 layer4 Acc 0.0125, AUC 0.45672422647476196
gc 0
[[4.44061607e+03 8.36234344e+01]
 [4.02953333e-04 3.92936847e+01]
 [7.41129876e-04 2.97154407e+01]
 [1.22788615e+03 1.24011555e+03]
 [1.10046544e+03 1.08739637e+03]]
Train Epoch3 Acc 0.009096428571428571 (5094/560000), AUC 0.4597475826740265
Test Epoch3 layer0 Acc 0.9738, AUC 0.998312771320343
Test Epoch3 layer1 Acc 0.9764714285714285, AUC 0.9984696507453918
Test Epoch3 layer2 Acc 0.9765428571428572, AUC 0.998306930065155
Test Epoch3 layer3 Acc 0.0704, AUC 0.36245083808898926
Test Epoch3 layer4 Acc 0.009985714285714285, AUC 0.4557928740978241
gc 0
[[4.44061607e+03 8.35540508e+01]
 [4.11311724e-04 3.71535399e+01]
 [7.56050153e-04 2.71027132e+01]
 [1.22526714e+03 1.33833209e+03]
 [1.09795145e+03 1.16840885e+03]]
Train Epoch4 Acc 0.007764285714285714 (4348/560000), AUC 0.45464783906936646
Test Epoch4 layer0 Acc 0.9736142857142858, AUC 0.9982924461364746
Test Epoch4 layer1 Acc 0.9760857142857143, AUC 0.9984236359596252
Test Epoch4 layer2 Acc 0.9764857142857143, AUC 0.9982768297195435
Test Epoch4 layer3 Acc 0.07088571428571429, AUC 0.36559516191482544
Test Epoch4 layer4 Acc 0.009257142857142858, AUC 0.45005592703819275
gc 0
[[4.44061607e+03 8.21018022e+01]
 [6.75697037e-05 3.48286218e+01]
 [1.26650322e-04 2.46428946e+01]
 [1.22383809e+03 1.40542772e+03]
 [1.09657127e+03 1.22838662e+03]]
Train Epoch5 Acc 0.0071 (3976/560000), AUC 0.44875627756118774
Test Epoch5 layer0 Acc 0.9734714285714285, AUC 0.9983057379722595
Test Epoch5 layer1 Acc 0.9765285714285714, AUC 0.9984601140022278
Test Epoch5 layer2 Acc 0.9768142857142857, AUC 0.9982677102088928
Test Epoch5 layer3 Acc 0.07097142857142857, AUC 0.36705607175827026
Test Epoch5 layer4 Acc 0.009528571428571428, AUC 0.4460429251194
gc 0
[[4.44061607e+03 8.20252226e+01]
 [9.45766889e-05 3.40011780e+01]
 [1.76860430e-04 2.37466766e+01]
 [1.22323465e+03 1.44666814e+03]
 [1.09599186e+03 1.26573249e+03]]
Train Epoch6 Acc 0.007141071428571429 (3999/560000), AUC 0.44425517320632935
Test Epoch6 layer0 Acc 0.9738571428571429, AUC 0.9983091354370117
Test Epoch6 layer1 Acc 0.9767142857142858, AUC 0.9984018206596375
Test Epoch6 layer2 Acc 0.9767714285714286, AUC 0.998171329498291
Test Epoch6 layer3 Acc 0.0711, AUC 0.36706772446632385
Test Epoch6 layer4 Acc 0.009485714285714287, AUC 0.44167694449424744
gc 0
[[4.44061607e+03 8.18988044e+01]
 [9.76411548e-05 3.32578416e+01]
 [1.82738709e-04 2.29878147e+01]
 [1.22260631e+03 1.48585209e+03]
 [1.09538553e+03 1.30187285e+03]]
Train Epoch7 Acc 0.0071125 (3983/560000), AUC 0.4400302767753601
Test Epoch7 layer0 Acc 0.9737142857142858, AUC 0.998295247554779
Test Epoch7 layer1 Acc 0.9769571428571429, AUC 0.9984042048454285
Test Epoch7 layer2 Acc 0.9770857142857143, AUC 0.9981975555419922
Test Epoch7 layer3 Acc 0.0711, AUC 0.3697187900543213
Test Epoch7 layer4 Acc 0.009485714285714287, AUC 0.43724867701530457
gc 0
[[4.44061607e+03 8.19325339e+01]
 [9.63708229e-05 3.25857831e+01]
 [1.80633104e-04 2.23181628e+01]
 [1.22197888e+03 1.52180498e+03]
 [1.09478234e+03 1.33466508e+03]]
Train Epoch8 Acc 0.007025 (3934/560000), AUC 0.43498286604881287
Test Epoch8 layer0 Acc 0.9738, AUC 0.998291552066803
Test Epoch8 layer1 Acc 0.9768714285714286, AUC 0.9984269738197327
Test Epoch8 layer2 Acc 0.977, AUC 0.9982147216796875
Test Epoch8 layer3 Acc 0.07107142857142858, AUC 0.37160608172416687
Test Epoch8 layer4 Acc 0.009214285714285715, AUC 0.4325422942638397
gc 0
[[4.44061607e+03 8.11366236e+01]
 [1.61817595e-05 3.15901792e+01]
 [3.00723543e-05 2.13675583e+01]
 [1.22163532e+03 1.54711013e+03]
 [1.09445222e+03 1.35882002e+03]]
Train Epoch9 Acc 0.006821428571428571 (3820/560000), AUC 0.4306579530239105
Test Epoch9 layer0 Acc 0.9736, AUC 0.9983100295066833
Test Epoch9 layer1 Acc 0.9769428571428571, AUC 0.9984349608421326
Test Epoch9 layer2 Acc 0.9771428571428571, AUC 0.998197615146637
Test Epoch9 layer3 Acc 0.07127142857142857, AUC 0.3731203079223633
Test Epoch9 layer4 Acc 0.009128571428571429, AUC 0.43033626675605774
Best AUC 0.9984992146492004
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l5_m3_prefix.pt
[[4724   39   20   14   11   60   39    7    3    6    4   18   13   42]
 [  39 4899    2    2    6    0   29    5    3    2    1    0    2   10]
 [  45   14 4593   19   56    1   11    4    4    0    1   80   21  151]
 [   4    1   30 4950   11    0    1    0    0    0    0    0    0    3]
 [  12   21   57   13 4859    8    6    0    2    1    0    0    2   19]
 [  42    1    3    4    1 4937    5    2    1    1    0    0    1    2]
 [  62   52    5    3   11   16 4788   39   11    5    1    1    3    3]
 [   0    0    0    0    2    0   13 4962   18    3    0    0    1    1]
 [   1    4    2    0    3    0   10   12 4968    0    0    0    0    0]
 [   1    0    1    2    1    0    0    7    0 4946   41    0    0    1]
 [  12    1    0    0    0    0    2    3    0   33 4948    0    0    1]
 [  11    0   38    2    0    0    1    0    0    1    1 4919   15   12]
 [  12    2   22    9    1    2    1    3    0    3    0   23 4871   51]
 [  32    6   70    8   12    3    3    9    1    6    3    5   41 4801]]
Figure(640x480)
[[4731   40   20    9   12   54   40    5    2    5    2   22   15   43]
 [  40 4907    1    2    7    0   28    1    1    1    0    0    5    7]
 [  41   13 4596   19   66    2   11    3    1    0    2   99   35  112]
 [   4    2   26 4953   11    0    1    0    0    0    0    0    1    2]
 [  12   18   54   15 4876    9    6    0    2    0    0    0    2    6]
 [  46    1    3    2    1 4936    5    2    1    0    0    0    1    2]
 [  60   50    4    4   10   14 4807   30    5    5    1    1    7    2]
 [   1    1    0    0    2    0   14 4962   14    3    2    0    0    1]
 [   2    3    2    0    5    0   14   12 4962    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4950   38    0    0    1]
 [  13    1    0    0    0    0    2    2    0   25 4957    0    0    0]
 [   9    0   30    3    0    0    1    0    0    0    1 4930   15   11]
 [   6    2   18    4    0    3    0    1    0    1    0   19 4909   37]
 [  31    4   71    7   11    3    3    3    0    5    3   11   74 4774]]
Figure(640x480)
[[4730   39   19    9   12   59   41    6    1    4    4   19   14   43]
 [  40 4903    2    2    6    0   31    1    2    1    0    0    5    7]
 [  42   14 4613   17   63    2   11    1    3    0    2   95   32  105]
 [   4    2   28 4951   11    0    1    0    0    0    0    0    1    2]
 [  12   15   57   12 4876    9    6    0    2    0    0    0    3    8]
 [  43    1    3    2    1 4939    5    2    1    0    0    0    1    2]
 [  60   44    4    3   11   20 4813   28    3    5    1    1    6    1]
 [   1    1    0    0    2    1   17 4955   16    3    2    0    1    1]
 [   1    3    2    0    5    0   15   11 4962    0    0    0    0    1]
 [   1    0    1    3    1    0    0    6    0 4944   43    0    0    1]
 [  13    1    0    0    0    0    2    3    0   28 4953    0    0    0]
 [  10    0   30    2    0    0    0    0    0    0    1 4929   15   13]
 [  10    2   19    4    0    3    1    2    0    1    0   20 4900   38]
 [  37    6   78    7   11    3    3    3    0    2    4    9   74 4763]]
Figure(640x480)
[[   0    0    3   50    0 2189    1    0    0   58    2    0  109 2588]
 [   0    0   17    0    0  720    0    0    0    7    0    0  122 4134]
 [   0    0    4    0    0 3272    0    0    0    1    0    0 1722    1]
 [   0    0   36    0    0 4926    0    0    0    0    0    0   38    0]
 [   0    0    3    0    0   81    0    0    0    1    0    0 4915    0]
 [   0    0  119    0    2 3958  824    0    0   19    0    0   75    3]
 [   0    0    1    0    0  540    0    0    0    1    0    0 4449    9]
 [   0    0    0    1  127 2956    0    0    0    0    0    0 1916    0]
 [   0    0    0    0  184 4797    0    0    0    4    0    0   15    0]
 [   0    0   24    0   55 4738    0    0    0    0    0    0  181    2]
 [   0    0    3    0    2 4928    2    0    0    1    0    0   61    3]
 [   0    0    0    0    1 3006    0    0    0    1    0    0 1992    0]
 [   0    0    0    0    0 4965    0    0    0    0    0    0   35    0]
 [   0    0 1377    2    1 3410   13    0    0    0    0    0  195    2]]
Figure(640x480)
[[   0  220 1615    0   11  111    0    0  958   65  151    0 1869    0]
 [   0    5 4610    0  137  243    0    0    3    1    0    0    1    0]
 [   0  358  295 1102   27 2909   32    0    4    0  265    4    4    0]
 [   0    0 4977    4    5    7    1    0    0    2    1    3    0    0]
 [   0    2 4839   30   12  107    0    0    1    0    4    4    1    0]
 [   0    0 4851    1   33  111    0    0    1    0    0    0    3    0]
 [   0    0 3269    0   10   34    0    0    3   26 1655    0    3    0]
 [   0    0 3303    0   83 1236  289    0    0    0    0   89    0    0]
 [   0    0  134    0   75 4791    0    0    0    0    0    0    0    0]
 [   0    0 4943    0   51    4    0    0    0    0    0    2    0    0]
 [   0    1 4983    0   12    0    0    0    0    0    1    0    3    0]
 [   0    0   80    1    7 4911    0    0    0    0    0    1    0    0]
 [   0    0  465    5   29 4501    0    0    0    0    0    0    0    0]
 [   0    1 4827    1    4  156    1    0    9    0    0    1    0    0]]
Figure(640x480)
