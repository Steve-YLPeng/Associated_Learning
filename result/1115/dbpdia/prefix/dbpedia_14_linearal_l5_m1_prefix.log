total count words 887880
vocab size 30000
found 28354 words in glove
Start Training
gc 0
[[4560.05832565   60.68261808]
 [ 882.69872051  650.69478849]
 [ 804.1750031   506.22220741]
 [ 620.44549646  512.98400608]
 [ 585.45415456  546.32155412]]
Train Epoch0 Acc 0.07063571428571429 (39556/560000), AUC 0.47327354550361633
Test Epoch0 layer0 Acc 0.9728428571428571, AUC 0.9980279207229614
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l5_m1_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.08011428571428572, AUC 0.4334670901298523
Test Epoch0 layer2 Acc 0.11697142857142857, AUC 0.5288640260696411
Test Epoch0 layer3 Acc 0.07408571428571428, AUC 0.46384814381599426
Test Epoch0 layer4 Acc 0.07107142857142858, AUC 0.4690144658088684
gc 0
[[4440.79358459   66.24196263]
 [1190.24646544  729.0307499 ]
 [1019.93999459  563.70509399]
 [ 757.99839906  549.91735836]
 [ 701.44118257  553.01575688]]
Train Epoch1 Acc 0.07026607142857143 (39349/560000), AUC 0.4712561070919037
Test Epoch1 layer0 Acc 0.9736571428571429, AUC 0.9981390237808228
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l5_m1_prefix.pt  ,ep 1
Test Epoch1 layer1 Acc 0.07137142857142857, AUC 0.42929357290267944
Test Epoch1 layer2 Acc 0.12762857142857142, AUC 0.5262486338615417
Test Epoch1 layer3 Acc 0.07611428571428572, AUC 0.467677503824234
Test Epoch1 layer4 Acc 0.07072857142857143, AUC 0.4756118655204773
gc 0
[[4440.63210452   74.08817526]
 [1372.89041871  758.57119313]
 [1133.74493717  583.35244919]
 [ 825.57891677  556.69332787]
 [ 756.10144553  538.88366085]]
Train Epoch2 Acc 0.06960892857142857 (38981/560000), AUC 0.47792428731918335
Test Epoch2 layer0 Acc 0.9736142857142858, AUC 0.9982079267501831
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l5_m1_prefix.pt  ,ep 2
Test Epoch2 layer1 Acc 0.0592, AUC 0.4246099591255188
Test Epoch2 layer2 Acc 0.1333, AUC 0.5224176049232483
Test Epoch2 layer3 Acc 0.08051428571428572, AUC 0.46880626678466797
Test Epoch2 layer4 Acc 0.07021428571428572, AUC 0.4821791350841522
gc 0
[[4440.62056327   80.9632711 ]
 [1530.9214544   781.18987934]
 [1225.9388667   596.76425174]
 [ 878.50216442  558.70333844]
 [ 798.13620533  522.17664526]]
Train Epoch3 Acc 0.06861428571428571 (38424/560000), AUC 0.4843091070652008
Test Epoch3 layer0 Acc 0.9738571428571429, AUC 0.9982512593269348
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l5_m1_prefix.pt  ,ep 3
Test Epoch3 layer1 Acc 0.06417142857142857, AUC 0.41746634244918823
Test Epoch3 layer2 Acc 0.1365, AUC 0.5160799026489258
Test Epoch3 layer3 Acc 0.08995714285714286, AUC 0.4679895341396332
Test Epoch3 layer4 Acc 0.06928571428571428, AUC 0.48865023255348206
gc 0
[[4440.6173327    85.67381624]
 [1652.66595212  795.33006535]
 [1293.51412916  603.67293975]
 [ 916.39897454  556.35230745]
 [ 828.40903232  505.03578731]]
Train Epoch4 Acc 0.06714107142857142 (37599/560000), AUC 0.4915761649608612
Test Epoch4 layer0 Acc 0.9737857142857143, AUC 0.9982916712760925
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l5_m1_prefix.pt  ,ep 4
Test Epoch4 layer1 Acc 0.06847142857142857, AUC 0.41155165433883667
Test Epoch4 layer2 Acc 0.14402857142857142, AUC 0.5089589357376099
Test Epoch4 layer3 Acc 0.09802857142857142, AUC 0.46448686718940735
Test Epoch4 layer4 Acc 0.06885714285714285, AUC 0.4948056638240814
gc 0
[[4440.61607122   85.44978978]
 [1669.60162631  779.54609524]
 [1302.65913683  592.63504368]
 [ 921.45595403  541.47870701]
 [ 832.89010625  483.93381441]]
Train Epoch5 Acc 0.068175 (38178/560000), AUC 0.49836307764053345
Test Epoch5 layer0 Acc 0.9736571428571429, AUC 0.998309314250946
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l5_m1_prefix.pt  ,ep 5
Test Epoch5 layer1 Acc 0.0697, AUC 0.4073331654071808
Test Epoch5 layer2 Acc 0.15097142857142856, AUC 0.5009546875953674
Test Epoch5 layer3 Acc 0.09832857142857143, AUC 0.4596533477306366
Test Epoch5 layer4 Acc 0.07051428571428571, AUC 0.5012773275375366
gc 0
[[4440.61607122   85.06056784]
 [1669.60162613  764.95660989]
 [1302.65913847  581.441577  ]
 [ 921.45595516  527.03824919]
 [ 832.89010622  467.9951429 ]]
Train Epoch6 Acc 0.06558035714285715 (36725/560000), AUC 0.5064996480941772
Test Epoch6 layer0 Acc 0.9737, AUC 0.9983099699020386
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l5_m1_prefix.pt  ,ep 6
Test Epoch6 layer1 Acc 0.06984285714285714, AUC 0.4054580330848694
Test Epoch6 layer2 Acc 0.11052857142857143, AUC 0.49495071172714233
Test Epoch6 layer3 Acc 0.09025714285714286, AUC 0.45454174280166626
Test Epoch6 layer4 Acc 0.06092857142857143, AUC 0.5104020237922668
gc 0
[[4440.61607122   84.7686523 ]
 [1669.60162595  756.27863562]
 [1302.6591363   573.12187392]
 [ 921.45595542  516.04143523]
 [ 832.89010607  459.15939913]]
Train Epoch7 Acc 0.06010714285714286 (33660/560000), AUC 0.5141019821166992
Test Epoch7 layer0 Acc 0.9736285714285714, AUC 0.9983120560646057
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l5_m1_prefix.pt  ,ep 7
Test Epoch7 layer1 Acc 0.0695, AUC 0.4049244523048401
Test Epoch7 layer2 Acc 0.09128571428571429, AUC 0.4915434718132019
Test Epoch7 layer3 Acc 0.08588571428571429, AUC 0.44992488622665405
Test Epoch7 layer4 Acc 0.05815714285714286, AUC 0.516382098197937
gc 0
[[4440.61607122   82.91105416]
 [1669.60162565  752.6425803 ]
 [1302.65913746  569.21102081]
 [ 921.45595495  510.82974273]
 [ 832.89010543  455.75558469]]
Train Epoch8 Acc 0.058975 (33026/560000), AUC 0.5172596573829651
Test Epoch8 layer0 Acc 0.9738285714285714, AUC 0.9983035922050476
Test Epoch8 layer1 Acc 0.06932857142857143, AUC 0.4049813747406006
Test Epoch8 layer2 Acc 0.08865714285714285, AUC 0.49090126156806946
Test Epoch8 layer3 Acc 0.08542857142857142, AUC 0.4481010138988495
Test Epoch8 layer4 Acc 0.05738571428571428, AUC 0.517867386341095
gc 0
[[4440.61607122   82.72876504]
 [1669.60162562  751.33204946]
 [1302.65913787  567.74754627]
 [ 921.4559557   508.93458001]
 [ 832.89010617  454.59839462]]
Train Epoch9 Acc 0.0584375 (32725/560000), AUC 0.5185506343841553
Test Epoch9 layer0 Acc 0.9737571428571429, AUC 0.998279869556427
Test Epoch9 layer1 Acc 0.06917142857142858, AUC 0.4055165946483612
Test Epoch9 layer2 Acc 0.08702857142857143, AUC 0.4903702735900879
Test Epoch9 layer3 Acc 0.08641428571428571, AUC 0.4469323754310608
Test Epoch9 layer4 Acc 0.056857142857142856, AUC 0.5183736681938171
Best AUC 0.9983120560646057
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l5_m1_prefix.pt
[[4683   45   25   15   11   68   44    9    4    6    4   22   18   46]
 [  34 4903    3    1    6    1   28    6    3    2    1    0    3    9]
 [  34   14 4628   18   44    1   10    3    3    0    1   79   20  145]
 [   3    1   30 4950   11    0    0    0    0    1    0    0    0    4]
 [  10   22   97   14 4818    9    5    2    2    1    0    1    2   17]
 [  33    2    3    3    1 4945    5    3    1    1    0    0    1    2]
 [  52   48    6    3   10   17 4806   36    9    5    1    1    4    2]
 [   0    1    0    0    2    0   13 4962   17    3    1    0    0    1]
 [   1    5    2    0    3    0   11   12 4965    1    0    0    0    0]
 [   1    0    1    2    0    0    0    6    0 4962   27    0    0    1]
 [  12    1    0    0    0    0    2    3    2   38 4941    0    0    1]
 [   5    0   40    3    0    0    0    0    0    1    0 4924   14   13]
 [   6    2   23    9    1    3    1    3    1    3    0   22 4879   47]
 [  27    7   81    8   11    3    4   10    1    5    3    6   46 4788]]
Figure(640x480)
[[   0    2  119    0  191    5 4676    4    0    0    0    3    0    0]
 [   0    0    0    0    1    0 4999    0    0    0    0    0    0    0]
 [   0    0    3    0    2    0 4985   10    0    0    0    0    0    0]
 [   2    0    0    0    1  201 4794    1    0    0    0    1    0    0]
 [   0    0    0    0    0    0 4822  178    0    0    0    0    0    0]
 [   0    1  142    0  161    0 4457  225    0    0    0   14    0    0]
 [   0    0    5    0    6   12 4853  123    0    0    0    1    0    0]
 [   0    0    0    0    0    4 4988    8    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4999    1    0    0    0    0    0    0]
 [   0    0    0    0    0    0 4999    1    0    0    0    0    0    0]
 [   0    0    0    0    1    0 4999    0    0    0    0    0    0    0]
 [   0    6  261    0    3    5 4614    0    0    0   83    1   27    0]
 [   0    0    0    0    0    0 5000    0    0    0    0    0    0    0]
 [   0    0    0    0    1    1 4878  120    0    0    0    0    0    0]]
Figure(640x480)
[[   0    0    0    0   96    7 4791  105    0    0    0    1    0    0]
 [   0    0    0    0   44    1 3328 1627    0    0    0    0    0    0]
 [   0    1    3    0  115    0 4819   61    0    0    0    1    0    0]
 [   0    0    0    0    4   17 3841 1107    0    0    0   31    0    0]
 [   0    0    0    0 1363    0 3618   17    0    0    0    2    0    0]
 [   0    0    1    0 1678    7 2935  204    1    0    0  174    0    0]
 [   0    0    0    0   54    2 4841   67    0    0    0   36    0    0]
 [   0    0    0    0    4    1 4819  176    0    0    0    0    0    0]
 [   0    0    0    0  115   58 4812   13    0    0    0    2    0    0]
 [   0    0    0    0   10   27 4817   69    0    0    2   75    0    0]
 [   0    0    0    0  131  181 4460   43    0    0    0  185    0    0]
 [   0    0   12    0 4231    9  649   99    0    0    0    0    0    0]
 [   0    0    0    0   21    9 4932   37    0    0    0    1    0    0]
 [   0    0    0    0   21    9 4901   59    0    0    0   10    0    0]]
Figure(640x480)
[[   0    0    1    6    2  291  388  623 3400    0    0    1  288    0]
 [  15    0    8  121    1   91   13 1140 3469    0    0    0  142    0]
 [  67    0  840   62  456  526  107  395 1212    0    0    0 1335    0]
 [   0    0 2711    0   24  201    4   21 1760    0    0    0  279    0]
 [   0    0  104   20    1 2227   16  230  597    0    0    0 1805    0]
 [   0    0  228    0    0 2803  516  133 1219    0    0    0  101    0]
 [   9    0    9   19    2 1523 1335  134 1418    0    0    0  551    0]
 [   0    0   61  300  702  850   42  740 2029    0    0    0  276    0]
 [   0    0  250    1 1099    5 3481   71   93    0    0    0    0    0]
 [   0    0  445   42    1 1760  300  286 2164    0    0    0    2    0]
 [   0    0   26   82    1 1343   68  378 3009    0    0    0   93    0]
 [   0    0    0    0   20   47    8 3207 1710    0    0    0    8    0]
 [   0    0    3    7    0 3206    5  386 1193    0    0    0  200    0]
 [   0    0  105   92    1 2432   22  347  449    0    0    0 1552    0]]
Figure(640x480)
[[ 107    0  107    0  603   51    0    0    0    0    0 4132    0    0]
 [   0    0 1623    0 1640    0    0    0    0    0    0 1737    0    0]
 [   0    0  870    0 1675    0    5    2    0    0    0 2448    0    0]
 [   0    0    2    0  130    0    3    0    0    0    0 4865    0    0]
 [   0    0  169    0 2303    0    1    0    0    7    0 2520    0    0]
 [   0    0 1323    0 1140   16    0    0    0    0    0 2521    0    0]
 [   1    0  132    0  167    0    0    0    0    0    0 4700    0    0]
 [   0    0   93    0  230    1    0    0    0    0    0 4676    0    0]
 [   0    0    4    0 1226    0  145    0    0    0    0 3625    0    0]
 [   0    0  451    0 2321    1    1    0    0    0    0 2226    0    0]
 [   0    0  102    0  742    0    0    0    0    0    0 4156    0    0]
 [   0    0 1410    0 2815    0    0    0    0    0    0  775    0    0]
 [  19    0  142    0 1961   20   62   20    0    0    0 2776    0    0]
 [   0    0  218    0  883    0    0    0    0    0    0 3899    0    0]]
Figure(640x480)
