total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l5_m3_prefix.pt
Start Training
gc 9
[[4.44061607e+03 8.36820019e+01]
 [5.15312005e-04 1.07834174e+01]
 [9.71478986e-04 9.52203120e+00]
 [4.66778713e+01 1.50877577e+01]
 [1.42761446e+03 7.63036572e+02]]
Train Epoch0 Acc 0.10071785714285714 (56402/560000), AUC 0.4602591097354889
Test Epoch0 layer0 Acc 0.9735857142857143, AUC 0.9982908368110657
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l5_m4_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9852571428571428, AUC 0.9985160827636719
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l5_m4_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9852571428571428, AUC 0.9984394311904907
Test Epoch0 layer3 Acc 0.9851142857142857, AUC 0.9978200793266296
Test Epoch0 layer4 Acc 0.13785714285714284, AUC 0.4600508511066437
gc 0
[[4.44061607e+03 8.35706658e+01]
 [4.41271472e-04 9.99622297e+00]
 [7.74274332e-04 8.81926276e+00]
 [2.96575132e-04 8.51420799e+00]
 [1.44862734e+03 7.37310070e+02]]
Train Epoch1 Acc 0.12105535714285715 (67791/560000), AUC 0.4571637511253357
Test Epoch1 layer0 Acc 0.9736, AUC 0.9983118772506714
Test Epoch1 layer1 Acc 0.9851428571428571, AUC 0.9983973503112793
Test Epoch1 layer2 Acc 0.9850857142857142, AUC 0.9982245564460754
Test Epoch1 layer3 Acc 0.9850714285714286, AUC 0.9975959062576294
Test Epoch1 layer4 Acc 0.07812857142857142, AUC 0.44676321744918823
gc 0
[[4.44061607e+03 8.34629048e+01]
 [4.08186207e-04 9.24941747e+00]
 [7.41834936e-04 8.18083585e+00]
 [9.22839108e-04 7.84347019e+00]
 [1.44543147e+03 7.14356775e+02]]
Train Epoch2 Acc 0.07346785714285714 (41142/560000), AUC 0.4487963318824768
Test Epoch2 layer0 Acc 0.9736857142857143, AUC 0.9983357787132263
Test Epoch2 layer1 Acc 0.9853, AUC 0.9984681010246277
Test Epoch2 layer2 Acc 0.9852571428571428, AUC 0.9982811212539673
Test Epoch2 layer3 Acc 0.9852428571428572, AUC 0.9975977540016174
Test Epoch2 layer4 Acc 0.05261428571428572, AUC 0.44485801458358765
gc 0
[[4.44061607e+03 8.33502395e+01]
 [4.43595122e-04 8.60521175e+00]
 [7.95819726e-04 7.62195506e+00]
 [1.34970532e-03 7.28600166e+00]
 [1.44015321e+03 6.98206066e+02]]
Train Epoch3 Acc 0.04691607142857143 (26273/560000), AUC 0.44461938738822937
Test Epoch3 layer0 Acc 0.9738857142857142, AUC 0.9983111023902893
Test Epoch3 layer1 Acc 0.9855142857142857, AUC 0.9983426332473755
Test Epoch3 layer2 Acc 0.9855714285714285, AUC 0.9983207583427429
Test Epoch3 layer3 Acc 0.9855714285714285, AUC 0.9975321888923645
Test Epoch3 layer4 Acc 0.011242857142857143, AUC 0.44757595658302307
gc 0
[[4.44061607e+03 8.32865929e+01]
 [3.94680644e-04 8.05770888e+00]
 [7.21914852e-04 7.13263796e+00]
 [1.23502863e-03 6.80887466e+00]
 [1.43456567e+03 6.87090117e+02]]
Train Epoch4 Acc 0.008208928571428572 (4597/560000), AUC 0.441457062959671
Test Epoch4 layer0 Acc 0.9735714285714285, AUC 0.9983305335044861
Test Epoch4 layer1 Acc 0.9850714285714286, AUC 0.9983707666397095
Test Epoch4 layer2 Acc 0.9851428571428571, AUC 0.9983048439025879
Test Epoch4 layer3 Acc 0.9850285714285715, AUC 0.9976043105125427
Test Epoch4 layer4 Acc 0.0055, AUC 0.4379344880580902
gc 0
[[4.44061607e+03 8.17893638e+01]
 [6.90583326e-05 6.96518217e+00]
 [1.25887979e-04 6.12216847e+00]
 [2.14426599e-04 5.82458142e+00]
 [1.43147213e+03 6.82994669e+02]]
Train Epoch5 Acc 0.0037910714285714284 (2123/560000), AUC 0.4352172017097473
Test Epoch5 layer0 Acc 0.9737285714285714, AUC 0.9983042478561401
Test Epoch5 layer1 Acc 0.9850571428571429, AUC 0.9983887076377869
Test Epoch5 layer2 Acc 0.9850428571428571, AUC 0.9982805848121643
Test Epoch5 layer3 Acc 0.9849571428571429, AUC 0.9974332451820374
Test Epoch5 layer4 Acc 0.005585714285714286, AUC 0.4358486533164978
gc 0
[[4.44061607e+03 8.16677111e+01]
 [1.02547924e-04 6.59546147e+00]
 [1.88753948e-04 5.77916054e+00]
 [3.21512487e-04 5.49421053e+00]
 [1.43017243e+03 6.82241565e+02]]
Train Epoch6 Acc 0.003707142857142857 (2076/560000), AUC 0.43224969506263733
Test Epoch6 layer0 Acc 0.9733714285714286, AUC 0.9983046650886536
Test Epoch6 layer1 Acc 0.9853142857142857, AUC 0.998287558555603
Test Epoch6 layer2 Acc 0.9853428571428572, AUC 0.9981043934822083
Test Epoch6 layer3 Acc 0.9853571428571428, AUC 0.9973277449607849
Test Epoch6 layer4 Acc 0.004871428571428572, AUC 0.4322481155395508
gc 0
[[4.44061607e+03 8.17162484e+01]
 [1.02448687e-04 6.30874132e+00]
 [1.83160534e-04 5.51965576e+00]
 [3.12740780e-04 5.24641097e+00]
 [1.42878421e+03 6.81335010e+02]]
Train Epoch7 Acc 0.002742857142857143 (1536/560000), AUC 0.43163445591926575
Test Epoch7 layer0 Acc 0.9735714285714285, AUC 0.9983161687850952
Test Epoch7 layer1 Acc 0.9851857142857143, AUC 0.998196005821228
Test Epoch7 layer2 Acc 0.9853857142857143, AUC 0.9980305433273315
Test Epoch7 layer3 Acc 0.9853142857142857, AUC 0.9971694946289062
Test Epoch7 layer4 Acc 0.004657142857142857, AUC 0.433286190032959
gc 0
[[4.44061607e+03 8.16462384e+01]
 [1.01754772e-04 6.02323703e+00]
 [1.86298258e-04 5.25459934e+00]
 [3.15127776e-04 4.98974371e+00]
 [1.42740715e+03 6.79893836e+02]]
Train Epoch8 Acc 0.0025910714285714287 (1451/560000), AUC 0.42884084582328796
Test Epoch8 layer0 Acc 0.9735571428571429, AUC 0.9983330368995667
Test Epoch8 layer1 Acc 0.9852, AUC 0.9980860352516174
Test Epoch8 layer2 Acc 0.9852285714285715, AUC 0.9978680610656738
Test Epoch8 layer3 Acc 0.9851714285714286, AUC 0.9969976544380188
Test Epoch8 layer4 Acc 0.0037571428571428573, AUC 0.42716073989868164
gc 0
[[4.44061607e+03 8.08505585e+01]
 [1.64656487e-05 5.46086119e+00]
 [3.01031658e-05 4.72170428e+00]
 [5.16386994e-05 4.47167354e+00]
 [1.42663567e+03 6.79559406e+02]]
Train Epoch9 Acc 0.002067857142857143 (1158/560000), AUC 0.42679914832115173
Test Epoch9 layer0 Acc 0.9734857142857143, AUC 0.9983144998550415
Test Epoch9 layer1 Acc 0.9850714285714286, AUC 0.9981275796890259
Test Epoch9 layer2 Acc 0.9850857142857142, AUC 0.99788898229599
Test Epoch9 layer3 Acc 0.9850571428571429, AUC 0.9968416094779968
Test Epoch9 layer4 Acc 0.0036714285714285716, AUC 0.42550128698349
Best AUC 0.9985160827636719
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l5_m4_prefix.pt
[[4705   40   23   13   11   70   41    8    4    6    3   17   19   40]
 [  36 4900    2    2    7    0   27    8    4    2    1    0    4    7]
 [  38   14 4648   17   46    1   10    6    6    0    1   79   23  111]
 [   3    2   32 4949   10    0    1    1    0    0    0    0    0    2]
 [  12   19   89   13 4834    9    6    2    2    1    0    1    3    9]
 [  35    2    3    3    1 4942    5    3    1    2    0    0    1    2]
 [  64   54    6    3   11   17 4780   40   11    5    1    1    6    1]
 [   0    1    0    0    2    0   10 4965   17    3    1    0    0    1]
 [   1    4    2    0    3    0   10   13 4967    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4957   31    0    0    1]
 [  12    1    0    0    0    0    2    5    0   37 4943    0    0    0]
 [   7    0   44    3    0    0    0    0    0    1    0 4919   13   13]
 [  11    2   26    5    1    2    1    3    1    2    0   22 4881   43]
 [  35    8   94    9   13    3    3    9    1    6    3    7   48 4761]]
Figure(640x480)
[[4816   35   14    3   14   28   40    2    2    3    0    6    9   28]
 [  39 4921    0    0    6    0   26    0    1    1    0    0    0    6]
 [  18    5 4867    8   63    1    4    0    0    1    0   11    3   19]
 [   3    1   15 4967    9    1    1    0    0    1    0    1    0    1]
 [   6    3   64    7 4906    4    4    2    0    1    0    0    2    1]
 [  32    0    2    0    1 4954    5    1    1    1    0    0    2    1]
 [  51   36    2    0    3   12 4861   23    5    2    0    0    1    4]
 [   1    0    0    0    0    1   13 4972   10    1    0    0    1    1]
 [   2    1    1    0    2    0    5    4 4984    0    0    0    0    1]
 [   1    0    1    1    0    1    0    2    0 4971   22    0    0    1]
 [  15    1    1    0    0    0    1    2    0   27 4953    0    0    0]
 [   6    0   13    1    0    0    0    0    0    0    0 4962   11    7]
 [   6    0    6    0    0    0    0    0    0    0    0   17 4934   37]
 [  30    1   32    1    6    4    3    0    0    0    0    4   19 4900]]
Figure(640x480)
[[4813   36   13    3   14   28   42    2    2    2    1    6   10   28]
 [  38 4921    0    0    7    0   26    0    1    1    0    0    0    6]
 [  18    5 4870    8   61    1    4    0    0    1    0   11    3   18]
 [   3    1   13 4968   12    1    0    0    0    0    0    1    0    1]
 [   6    3   66    7 4904    3    4    2    0    2    0    0    2    1]
 [  34    0    2    0    1 4952    5    1    1    1    0    0    2    1]
 [  52   35    2    0    3   12 4860   23    6    2    0    0    1    4]
 [   1    0    0    0    0    1   13 4972   10    1    0    0    1    1]
 [   2    1    1    0    2    0    3    4 4986    0    0    0    0    1]
 [   1    0    1    1    0    1    0    1    0 4972   22    0    0    1]
 [  15    1    0    0    0    1    1    2    0   26 4954    0    0    0]
 [   6    0   13    1    0    0    0    0    0    0    0 4961   11    8]
 [   7    0    6    0    0    0    0    0    0    0    0   17 4933   37]
 [  29    0   30    1    6    4    4    0    0    0    1    4   19 4902]]
Figure(640x480)
[[4812   37   14    3   14   28   42    2    2    2    1    6    8   29]
 [  40 4921    0    0    5    0   25    0    2    1    0    0    0    6]
 [  18    5 4863    8   63    1    4    0    0    1    0   12    5   20]
 [   3    1   12 4968   13    1    1    0    0    0    0    0    0    1]
 [   6    4   63    8 4903    3    4    2    1    3    0    0    2    1]
 [  35    0    2    0    1 4951    5    1    1    1    0    0    2    1]
 [  54   36    2    0    3   12 4852   23    8    3    0    0    3    4]
 [   0    0    0    0    0    1   13 4970   13    1    0    0    1    1]
 [   2    1    1    0    2    0    3    4 4986    0    0    0    0    1]
 [   1    0    1    0    0    1    0    1    0 4975   21    0    0    0]
 [  15    1    0    0    0    1    1    2    0   26 4954    0    0    0]
 [   4    0   12    1    0    0    0    0    0    0    0 4965   10    8]
 [   7    0    6    0    0    0    0    0    0    0    0   18 4933   36]
 [  27    0   30    1    7    4    3    0    0    0    0    4   19 4905]]
Figure(640x480)
[[4734    0    0    5   32    0    0  229    0    0    0    0    0    0]
 [4992    0    0    0    0    0    0    8    0    0    0    0    0    0]
 [4966    0    0    2   11    0    0   18    0    0    0    0    3    0]
 [4998    0    0    0    0    0    0    2    0    0    0    0    0    0]
 [4996    0    0    1    1    0    0    2    0    0    0    0    0    0]
 [4994    0    0    2    0    0    0    4    0    0    0    0    0    0]
 [4985    0    0    1    3    0    0   11    0    0    0    0    0    0]
 [  46    0    0    0   39    0    0 4915    0    0    0    0    0    0]
 [  23    0    0    0    2    0    0 4975    0    0    0    0    0    0]
 [ 297    0    0 4340   20    0    0   98    0    0  245    0    0    0]
 [  20    0    0   11    0    0    0 4969    0    0    0    0    0    0]
 [  23    0    0   36 4924    0    0   17    0    0    0    0    0    0]
 [  18    0    0 4924   12    0    0   46    0    0    0    0    0    0]
 [ 119    0    0   75    3    0    0 4803    0    0    0    0    0    0]]
Figure(640x480)
