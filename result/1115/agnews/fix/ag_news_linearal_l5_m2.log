total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask1//ag_news/ag_news_linearal_l5_m1.pt
Start Training
gc 9
[[320.10365754  10.09389495]
 [ 12.13733597  19.01026096]
 [181.82228321 128.17737605]
 [185.42524648 106.64693323]
 [179.66301571  93.6911165 ]]
Train Epoch0 Acc 0.2115 (25380/120000), AUC 0.5226557850837708
Test Epoch0 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch0 layer1 Acc 0.9140789473684211, AUC 0.9809659719467163
Save ckpt to ./ckpt/mask2//ag_news/ag_news_linearal_l5_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.15697368421052632, AUC 0.43561679124832153
Test Epoch0 layer3 Acc 0.18460526315789474, AUC 0.4594753384590149
Test Epoch0 layer4 Acc 0.21092105263157895, AUC 0.5189389586448669
gc 0
[[3.20103661e+02 1.00930874e+01]
 [1.10321127e-10 1.12537106e+01]
 [1.91656488e+02 1.34808391e+02]
 [1.94284807e+02 1.12747654e+02]
 [1.86297430e+02 9.65731193e+01]]
Train Epoch1 Acc 0.21299166666666666 (25559/120000), AUC 0.5187877416610718
Test Epoch1 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch1 layer1 Acc 0.9142105263157895, AUC 0.9813787937164307
Save ckpt to ./ckpt/mask2//ag_news/ag_news_linearal_l5_m2.pt  ,ep 1
Test Epoch1 layer2 Acc 0.17802631578947367, AUC 0.42274394631385803
Test Epoch1 layer3 Acc 0.18842105263157893, AUC 0.4525831341743469
Test Epoch1 layer4 Acc 0.21986842105263157, AUC 0.512772262096405
gc 0
[[3.20103656e+02 1.00900616e+01]
 [2.87020894e-12 1.06675169e+01]
 [1.91654477e+02 1.35052300e+02]
 [1.94281653e+02 1.13971535e+02]
 [1.86297502e+02 9.61457284e+01]]
Train Epoch2 Acc 0.21889166666666668 (26267/120000), AUC 0.5121654272079468
Test Epoch2 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch2 layer1 Acc 0.9148684210526316, AUC 0.9813780784606934
Test Epoch2 layer2 Acc 0.1838157894736842, AUC 0.41521763801574707
Test Epoch2 layer3 Acc 0.19842105263157894, AUC 0.4459277391433716
Test Epoch2 layer4 Acc 0.2243421052631579, AUC 0.5058817267417908
gc 0
[[3.20103662e+02 1.00957426e+01]
 [8.16492892e-13 1.04163309e+01]
 [1.91651539e+02 1.35480214e+02]
 [1.94284738e+02 1.15127901e+02]
 [1.86293641e+02 9.58764489e+01]]
Train Epoch3 Acc 0.22245 (26694/120000), AUC 0.5062161087989807
Test Epoch3 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch3 layer1 Acc 0.9146052631578947, AUC 0.9813438057899475
Test Epoch3 layer2 Acc 0.19276315789473683, AUC 0.40872126817703247
Test Epoch3 layer3 Acc 0.21460526315789474, AUC 0.44065791368484497
Test Epoch3 layer4 Acc 0.22763157894736843, AUC 0.5013923645019531
gc 0
[[3.20103660e+02 1.00923528e+01]
 [7.12875603e-13 1.02773230e+01]
 [1.91652239e+02 1.35981127e+02]
 [1.94281436e+02 1.16208764e+02]
 [1.86294519e+02 9.55742198e+01]]
Train Epoch4 Acc 0.2238 (26856/120000), AUC 0.5015489459037781
Test Epoch4 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch4 layer1 Acc 0.9151315789473684, AUC 0.9812535643577576
Test Epoch4 layer2 Acc 0.19421052631578947, AUC 0.4059721529483795
Test Epoch4 layer3 Acc 0.22513157894736843, AUC 0.4342093765735626
Test Epoch4 layer4 Acc 0.22552631578947369, AUC 0.4981411099433899
gc 0
[[3.20103662e+02 1.00951391e+01]
 [8.62195083e-13 1.01833526e+01]
 [1.91652171e+02 1.36573985e+02]
 [1.94284667e+02 1.17202849e+02]
 [1.86294461e+02 9.53050927e+01]]
Train Epoch5 Acc 0.22165 (26598/120000), AUC 0.49810659885406494
Test Epoch5 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch5 layer1 Acc 0.9155263157894736, AUC 0.9814234972000122
Save ckpt to ./ckpt/mask2//ag_news/ag_news_linearal_l5_m2.pt  ,ep 5
Test Epoch5 layer2 Acc 0.1931578947368421, AUC 0.4039977788925171
Test Epoch5 layer3 Acc 0.23605263157894738, AUC 0.42839133739471436
Test Epoch5 layer4 Acc 0.2206578947368421, AUC 0.49450671672821045
gc 0
[[3.20103655e+02 1.00928595e+01]
 [7.74339336e-13 1.01101904e+01]
 [1.91651380e+02 1.37094022e+02]
 [1.94286404e+02 1.18041517e+02]
 [1.86298231e+02 9.51781518e+01]]
Train Epoch6 Acc 0.21934166666666666 (26321/120000), AUC 0.49576565623283386
Test Epoch6 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch6 layer1 Acc 0.9151315789473684, AUC 0.9813623428344727
Test Epoch6 layer2 Acc 0.19526315789473683, AUC 0.40399497747421265
Test Epoch6 layer3 Acc 0.23907894736842106, AUC 0.42560529708862305
Test Epoch6 layer4 Acc 0.21986842105263157, AUC 0.4935459792613983
gc 0
[[3.20103658e+02 1.00887579e+01]
 [1.00728698e-12 1.00769211e+01]
 [1.91654566e+02 1.37542517e+02]
 [1.94281710e+02 1.18685712e+02]
 [1.86296683e+02 9.51779154e+01]]
Train Epoch7 Acc 0.216075 (25929/120000), AUC 0.4940170347690582
Test Epoch7 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch7 layer1 Acc 0.9153947368421053, AUC 0.9814454913139343
Save ckpt to ./ckpt/mask2//ag_news/ag_news_linearal_l5_m2.pt  ,ep 7
Test Epoch7 layer2 Acc 0.19473684210526315, AUC 0.40257954597473145
Test Epoch7 layer3 Acc 0.2419736842105263, AUC 0.4226951599121094
Test Epoch7 layer4 Acc 0.2156578947368421, AUC 0.4928903579711914
gc 0
[[3.20103657e+02 1.00926603e+01]
 [1.40233027e-12 1.00587257e+01]
 [1.91656035e+02 1.37960363e+02]
 [1.94280070e+02 1.19256157e+02]
 [1.86296288e+02 9.51608438e+01]]
Train Epoch8 Acc 0.21361666666666668 (25634/120000), AUC 0.4927433431148529
Test Epoch8 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch8 layer1 Acc 0.915, AUC 0.9813278913497925
Test Epoch8 layer2 Acc 0.19197368421052632, AUC 0.4014766812324524
Test Epoch8 layer3 Acc 0.24526315789473685, AUC 0.4197964072227478
Test Epoch8 layer4 Acc 0.21157894736842106, AUC 0.49075058102607727
gc 0
[[3.20103661e+02 1.00923946e+01]
 [2.32245986e-12 1.00381370e+01]
 [1.91652002e+02 1.38403897e+02]
 [1.94283674e+02 1.19855559e+02]
 [1.86295065e+02 9.51873292e+01]]
Train Epoch9 Acc 0.21011666666666667 (25214/120000), AUC 0.49157798290252686
Test Epoch9 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch9 layer1 Acc 0.915, AUC 0.9814504384994507
Save ckpt to ./ckpt/mask2//ag_news/ag_news_linearal_l5_m2.pt  ,ep 9
Test Epoch9 layer2 Acc 0.19144736842105264, AUC 0.40026965737342834
Test Epoch9 layer3 Acc 0.24723684210526317, AUC 0.4169594943523407
Test Epoch9 layer4 Acc 0.20894736842105263, AUC 0.4907771944999695
Best AUC 0.9814504384994507
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//ag_news/ag_news_linearal_l5_m2.pt
[[1711   59   89   41]
 [  15 1865   10   10]
 [  50   15 1688  147]
 [  59   16  145 1680]]
Figure(640x480)
[[1706   60   90   44]
 [  14 1865   12    9]
 [  43   16 1698  143]
 [  56   14  145 1685]]
Figure(640x480)
[[ 673    2   25 1200]
 [1131    1    2  766]
 [1644   28   31  197]
 [ 910    3  237  750]]
Figure(640x480)
[[   6  253 1635    6]
 [  16   51 1797   36]
 [  16    6 1822   56]
 [   3   17 1880    0]]
Figure(640x480)
[[ 126   28 1739    7]
 [  30    4 1865    1]
 [ 101  405 1388    6]
 [ 722  807  301   70]]
Figure(640x480)
