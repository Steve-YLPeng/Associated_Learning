total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask4//ag_news/ag_news_lstmal_l5_m4.pt
Start Training
gc 9
[[3.20071699e+02 9.91276513e+00]
 [9.37911422e-13 5.97688207e+00]
 [5.35992557e-12 5.56744526e+00]
 [1.34656565e-12 5.64331218e+00]
 [1.41788170e+01 8.09743153e+00]]
Train Epoch0 Acc 0.9007 (108084/120000), AUC 0.9813969135284424
Test Epoch0 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch0 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch0 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch0 layer3 Acc 0.9134210526315789, AUC 0.9826720356941223
Test Epoch0 layer4 Acc 0.9135526315789474, AUC 0.9778992533683777
Save ckpt to ./ckpt/mask5//ag_news/ag_news_lstmal_l5_m5.pt  ,ep 0
gc 0
[[3.20071698e+02 9.91086579e+00]
 [9.37917503e-13 5.97631979e+00]
 [5.35996535e-12 5.56724544e+00]
 [1.34655354e-12 5.64358053e+00]
 [7.06971803e-10 5.84940153e+00]]
Train Epoch1 Acc 0.947775 (113733/120000), AUC 0.9896718859672546
Test Epoch1 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch1 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch1 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch1 layer3 Acc 0.9134210526315789, AUC 0.9826720356941223
Test Epoch1 layer4 Acc 0.9142105263157895, AUC 0.9779406785964966
Save ckpt to ./ckpt/mask5//ag_news/ag_news_lstmal_l5_m5.pt  ,ep 1
gc 0
[[3.20071700e+02 9.90887514e+00]
 [9.37907687e-13 5.97775700e+00]
 [5.35997698e-12 5.56825063e+00]
 [1.34656198e-12 5.64450781e+00]
 [5.03748470e-12 5.78396314e+00]]
Train Epoch2 Acc 0.9483083333333333 (113797/120000), AUC 0.9899366497993469
Test Epoch2 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch2 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch2 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch2 layer3 Acc 0.9134210526315789, AUC 0.9826720356941223
Test Epoch2 layer4 Acc 0.9148684210526316, AUC 0.9780887365341187
Save ckpt to ./ckpt/mask5//ag_news/ag_news_lstmal_l5_m5.pt  ,ep 2
gc 0
[[3.20071699e+02 9.91307118e+00]
 [9.37898900e-13 5.97980153e+00]
 [5.35989114e-12 5.57117409e+00]
 [1.34658699e-12 5.64794482e+00]
 [1.26957877e-12 5.75800844e+00]]
Train Epoch3 Acc 0.9485666666666667 (113828/120000), AUC 0.9900446534156799
Test Epoch3 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch3 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch3 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch3 layer3 Acc 0.9134210526315789, AUC 0.9826720356941223
Test Epoch3 layer4 Acc 0.9142105263157895, AUC 0.980156421661377
Save ckpt to ./ckpt/mask5//ag_news/ag_news_lstmal_l5_m5.pt  ,ep 3
gc 0
[[3.20071700e+02 9.90714774e+00]
 [9.37894648e-13 5.97532669e+00]
 [5.35989639e-12 5.56597988e+00]
 [1.34659386e-12 5.64279936e+00]
 [9.22850216e-13 5.72873369e+00]]
Train Epoch4 Acc 0.9486666666666667 (113840/120000), AUC 0.9901607036590576
Test Epoch4 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch4 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch4 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch4 layer3 Acc 0.9134210526315789, AUC 0.9826720356941223
Test Epoch4 layer4 Acc 0.9138157894736842, AUC 0.9790375232696533
gc 0
[[3.20071699e+02 9.90853786e+00]
 [9.37919115e-13 5.97583007e+00]
 [5.35990613e-12 5.56565237e+00]
 [1.34655341e-12 5.64213864e+00]
 [1.07049203e-12 5.70932483e+00]]
Train Epoch5 Acc 0.9488416666666667 (113861/120000), AUC 0.9902719855308533
Test Epoch5 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch5 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch5 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch5 layer3 Acc 0.9134210526315789, AUC 0.9826720356941223
Test Epoch5 layer4 Acc 0.9136842105263158, AUC 0.9792556762695312
gc 0
[[3.20071701e+02 9.91306852e+00]
 [9.37894941e-13 5.97677765e+00]
 [5.35991550e-12 5.56793445e+00]
 [1.34658552e-12 5.64485916e+00]
 [1.46542712e-12 5.69525215e+00]]
Train Epoch6 Acc 0.9488166666666666 (113858/120000), AUC 0.9903903007507324
Test Epoch6 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch6 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch6 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch6 layer3 Acc 0.9134210526315789, AUC 0.9826720356941223
Test Epoch6 layer4 Acc 0.9138157894736842, AUC 0.9782538414001465
gc 0
[[3.20071700e+02 9.91341807e+00]
 [9.37909076e-13 5.97738428e+00]
 [5.35989070e-12 5.56828828e+00]
 [1.34656404e-12 5.64469219e+00]
 [2.25965946e-12 5.68456773e+00]]
Train Epoch7 Acc 0.9489916666666667 (113879/120000), AUC 0.9904823303222656
Test Epoch7 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch7 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch7 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch7 layer3 Acc 0.9134210526315789, AUC 0.9826720356941223
Test Epoch7 layer4 Acc 0.9127631578947368, AUC 0.9789345264434814
gc 0
[[3.20071699e+02 9.90832816e+00]
 [9.37904581e-13 5.97492574e+00]
 [5.35991601e-12 5.56560692e+00]
 [1.34656841e-12 5.64200874e+00]
 [1.71709570e-12 5.65961170e+00]]
Train Epoch8 Acc 0.948975 (113877/120000), AUC 0.9905083179473877
Test Epoch8 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch8 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch8 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch8 layer3 Acc 0.9134210526315789, AUC 0.9826720356941223
Test Epoch8 layer4 Acc 0.9131578947368421, AUC 0.9791240692138672
gc 0
[[3.20071700e+02 9.90928402e+00]
 [9.37913680e-13 5.97714929e+00]
 [5.35991749e-12 5.56787014e+00]
 [1.34655713e-12 5.64477040e+00]
 [2.91746578e-12 5.65997682e+00]]
Train Epoch9 Acc 0.9489916666666667 (113879/120000), AUC 0.9905123114585876
Test Epoch9 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch9 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch9 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch9 layer3 Acc 0.9134210526315789, AUC 0.9826720356941223
Test Epoch9 layer4 Acc 0.9134210526315789, AUC 0.979041337966919
Best AUC 0.980156421661377
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//ag_news/ag_news_lstmal_l5_m5.pt
[[1710   59   84   47]
 [  12 1874    5    9]
 [  56   17 1646  181]
 [  55   12  105 1728]]
Figure(640x480)
[[1724   48   71   57]
 [  23 1850   14   13]
 [  58   10 1652  180]
 [  50   13  116 1721]]
Figure(640x480)
[[1724   48   72   56]
 [  19 1853   15   13]
 [  58   10 1661  171]
 [  52   17  128 1703]]
Figure(640x480)
[[1725   48   71   56]
 [  19 1855   13   13]
 [  60   11 1656  173]
 [  54   17  123 1706]]
Figure(640x480)
[[1726   48   71   55]
 [  19 1855   13   13]
 [  62    9 1654  175]
 [  52   16  119 1713]]
Figure(640x480)
