total count words 102019
vocab size 30000
found 26754 words in glove
Start Training
gc 0
[[383.99968725  11.94628989]
 [158.07814924 151.19862534]
 [152.17696285  97.17393874]
 [127.79722065  73.39838387]
 [122.37417742  67.32908446]]
Train Epoch0 Acc 0.24206666666666668 (29048/120000), AUC 0.4539777338504791
Test Epoch0 layer0 Acc 0.9138157894736842, AUC 0.9797144532203674
Save ckpt to ./ckpt/mask1//ag_news/ag_news_lstmal_l5_m1.pt  ,ep 0
Test Epoch0 layer1 Acc 0.2561842105263158, AUC 0.457127183675766
Test Epoch0 layer2 Acc 0.2557894736842105, AUC 0.48900288343429565
Test Epoch0 layer3 Acc 0.24328947368421053, AUC 0.4346392750740051
Test Epoch0 layer4 Acc 0.24026315789473685, AUC 0.43294036388397217
gc 0
[[320.55125067  10.71419331]
 [180.07086223 160.88510452]
 [164.03908731 104.07663066]
 [140.15978874  77.35575406]
 [130.04834898  69.51058054]]
Train Epoch1 Acc 0.237975 (28557/120000), AUC 0.4328862428665161
Test Epoch1 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Save ckpt to ./ckpt/mask1//ag_news/ag_news_lstmal_l5_m1.pt  ,ep 1
Test Epoch1 layer1 Acc 0.2561842105263158, AUC 0.45420801639556885
Test Epoch1 layer2 Acc 0.25605263157894737, AUC 0.48970621824264526
Test Epoch1 layer3 Acc 0.24473684210526317, AUC 0.4330548644065857
Test Epoch1 layer4 Acc 0.24105263157894738, AUC 0.4311187267303467
gc 0
[[319.91024727  11.07842376]
 [192.75989579 165.48833504]
 [170.79055366 107.3286795 ]
 [146.84609528  79.63601658]
 [133.81155051  70.7296327 ]]
Train Epoch2 Acc 0.23808333333333334 (28570/120000), AUC 0.43112045526504517
Test Epoch2 layer0 Acc 0.9138157894736842, AUC 0.9814483523368835
Test Epoch2 layer1 Acc 0.2553947368421053, AUC 0.45401906967163086
Test Epoch2 layer2 Acc 0.2567105263157895, AUC 0.4904009699821472
Test Epoch2 layer3 Acc 0.24513157894736842, AUC 0.4336056709289551
Test Epoch2 layer4 Acc 0.24092105263157895, AUC 0.4307853579521179
gc 0
[[319.74986285  11.48028966]
 [202.41652873 168.83281578]
 [175.94416331 109.67410687]
 [151.87097141  81.3576646 ]
 [136.5526426   71.65075608]]
Train Epoch3 Acc 0.23806666666666668 (28568/120000), AUC 0.43030574917793274
Test Epoch3 layer0 Acc 0.9151315789473684, AUC 0.9811049103736877
Test Epoch3 layer1 Acc 0.25526315789473686, AUC 0.4532938003540039
Test Epoch3 layer2 Acc 0.2538157894736842, AUC 0.4910115599632263
Test Epoch3 layer3 Acc 0.24697368421052632, AUC 0.43314966559410095
Test Epoch3 layer4 Acc 0.24105263157894738, AUC 0.42955800890922546
gc 0
[[319.68827119  11.88550477]
 [210.66523702 171.66858867]
 [180.35510002 111.64773291]
 [156.12510449  82.84375735]
 [138.83483854  72.43228461]]
Train Epoch4 Acc 0.23765833333333333 (28519/120000), AUC 0.4285205006599426
Test Epoch4 layer0 Acc 0.9143421052631578, AUC 0.9808384776115417
Test Epoch4 layer1 Acc 0.25513157894736843, AUC 0.45261338353157043
Test Epoch4 layer2 Acc 0.25263157894736843, AUC 0.4912490248680115
Test Epoch4 layer3 Acc 0.24644736842105264, AUC 0.4327472448348999
Test Epoch4 layer4 Acc 0.24078947368421053, AUC 0.42857396602630615
gc 0
[[319.65972677  12.29145983]
 [218.15023401 174.09435742]
 [184.35410753 113.35531891]
 [159.95594184  84.18694568]
 [140.8535604   73.13387058]]
Train Epoch5 Acc 0.23725833333333332 (28471/120000), AUC 0.4278377592563629
Test Epoch5 layer0 Acc 0.9122368421052631, AUC 0.9805193543434143
Test Epoch5 layer1 Acc 0.255, AUC 0.45276543498039246
Test Epoch5 layer2 Acc 0.2530263157894737, AUC 0.49181920289993286
Test Epoch5 layer3 Acc 0.24789473684210525, AUC 0.43235474824905396
Test Epoch5 layer4 Acc 0.24, AUC 0.42739999294281006
gc 0
[[319.64749137  11.94466705]
 [223.59215873 175.95727681]
 [187.26067182 114.64148215]
 [162.72377917  85.16411635]
 [142.30547999  73.64404921]]
Train Epoch6 Acc 0.23703333333333335 (28444/120000), AUC 0.4271496832370758
Test Epoch6 layer0 Acc 0.9136842105263158, AUC 0.9805960059165955
Test Epoch6 layer1 Acc 0.255, AUC 0.4530497193336487
Test Epoch6 layer2 Acc 0.25276315789473686, AUC 0.49253273010253906
Test Epoch6 layer3 Acc 0.24763157894736842, AUC 0.43314802646636963
Test Epoch6 layer4 Acc 0.2406578947368421, AUC 0.42759811878204346
gc 0
[[319.64136869  12.14787406]
 [227.77991274 177.54300588]
 [189.49446683 115.70217443]
 [164.84381944  85.91744374]
 [143.40449739  74.04806039]]
Train Epoch7 Acc 0.237975 (28557/120000), AUC 0.4268771708011627
Test Epoch7 layer0 Acc 0.9135526315789474, AUC 0.9801990985870361
Test Epoch7 layer1 Acc 0.2546052631578947, AUC 0.4528851807117462
Test Epoch7 layer2 Acc 0.25342105263157894, AUC 0.49342215061187744
Test Epoch7 layer3 Acc 0.24763157894736842, AUC 0.4339868426322937
Test Epoch7 layer4 Acc 0.24118421052631578, AUC 0.4276896119117737
gc 0
[[319.63650578  12.44599248]
 [232.56056714 179.35484685]
 [192.04204147 116.92025205]
 [167.24398948  86.77739394]
 [144.64228378  74.50256432]]
Train Epoch8 Acc 0.23736666666666667 (28484/120000), AUC 0.4266646206378937
Test Epoch8 layer0 Acc 0.9118421052631579, AUC 0.9802302122116089
Test Epoch8 layer1 Acc 0.2548684210526316, AUC 0.4532300531864166
Test Epoch8 layer2 Acc 0.2538157894736842, AUC 0.49390220642089844
Test Epoch8 layer3 Acc 0.2475, AUC 0.4342806339263916
Test Epoch8 layer4 Acc 0.24157894736842106, AUC 0.42766493558883667
gc 0
[[319.63295412  12.76836283]
 [237.77731642 181.32318175]
 [194.81844996 118.23035333]
 [169.85966516  87.71372977]
 [145.98529422  74.99957165]]
Train Epoch9 Acc 0.23804166666666668 (28565/120000), AUC 0.4267183542251587
Test Epoch9 layer0 Acc 0.910921052631579, AUC 0.9798814654350281
Test Epoch9 layer1 Acc 0.25473684210526315, AUC 0.4532519280910492
Test Epoch9 layer2 Acc 0.2521052631578947, AUC 0.4945029318332672
Test Epoch9 layer3 Acc 0.24789473684210525, AUC 0.4347248673439026
Test Epoch9 layer4 Acc 0.24039473684210527, AUC 0.42756909132003784
Best AUC 0.9815508127212524
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//ag_news/ag_news_lstmal_l5_m1.pt
[[1710   59   84   47]
 [  12 1874    5    9]
 [  56   17 1646  181]
 [  55   12  105 1728]]
Figure(640x480)
[[1779    6  112    3]
 [1764    2  128    6]
 [1733    1  165    1]
 [1711    1  187    1]]
Figure(640x480)
[[   7  651 1233    9]
 [  24  634 1225   17]
 [   9  588 1279   24]
 [   7  445 1422   26]]
Figure(640x480)
[[   0   35 1820   45]
 [   5   53 1840    2]
 [   4   81 1794   21]
 [   4   89 1794   13]]
Figure(640x480)
[[   2    0 1377  521]
 [   1    0 1198  701]
 [   1    0 1257  642]
 [   0    0 1327  573]]
Figure(640x480)
