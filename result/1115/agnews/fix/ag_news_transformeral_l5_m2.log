total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask1//ag_news/ag_news_transformeral_l5_m1.pt
Start Training
gc 9
[[319.79093507  10.49757052]
 [  2.79140843  27.65540283]
 [163.98309219 531.35732335]
 [165.79926713 518.58309901]
 [148.05236417 512.80366755]]
Train Epoch0 Acc 0.25099166666666667 (30119/120000), AUC 0.46961450576782227
Test Epoch0 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch0 layer1 Acc 0.9161842105263158, AUC 0.9800429940223694
Save ckpt to ./ckpt/mask2//ag_news/ag_news_transformeral_l5_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.25, AUC 0.45218247175216675
Test Epoch0 layer3 Acc 0.25, AUC 0.5382481813430786
Test Epoch0 layer4 Acc 0.25, AUC 0.43950632214546204
gc 0
[[3.19790934e+02 1.05014676e+01]
 [1.08567779e-12 1.26791021e+01]
 [1.64767319e+02 5.30339809e+02]
 [1.66619552e+02 5.11926480e+02]
 [1.48823917e+02 5.08264749e+02]]
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.46953001618385315
Test Epoch1 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch1 layer1 Acc 0.9148684210526316, AUC 0.9806102514266968
Save ckpt to ./ckpt/mask2//ag_news/ag_news_transformeral_l5_m2.pt  ,ep 1
Test Epoch1 layer2 Acc 0.25, AUC 0.5046943426132202
Test Epoch1 layer3 Acc 0.25, AUC 0.5383327007293701
Test Epoch1 layer4 Acc 0.25, AUC 0.4931783080101013
gc 0
[[3.19790935e+02 1.05003946e+01]
 [1.63846513e-12 1.06849388e+01]
 [1.64771513e+02 5.26542948e+02]
 [1.66622802e+02 5.10091542e+02]
 [1.48827675e+02 5.10449453e+02]]
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.5199492573738098
Test Epoch2 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch2 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Save ckpt to ./ckpt/mask2//ag_news/ag_news_transformeral_l5_m2.pt  ,ep 2
Test Epoch2 layer2 Acc 0.25, AUC 0.5740443468093872
Test Epoch2 layer3 Acc 0.25, AUC 0.5209783911705017
Test Epoch2 layer4 Acc 0.25, AUC 0.5520724654197693
gc 0
[[3.19790935e+02 1.04989328e+01]
 [3.25531508e-12 8.98344215e+00]
 [1.64766993e+02 5.21237657e+02]
 [1.66619084e+02 5.08072954e+02]
 [1.48820983e+02 5.11191344e+02]]
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5136298537254333
Test Epoch3 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch3 layer1 Acc 0.9126315789473685, AUC 0.9799970388412476
Test Epoch3 layer2 Acc 0.25, AUC 0.629665195941925
Test Epoch3 layer3 Acc 0.25, AUC 0.4868220090866089
Test Epoch3 layer4 Acc 0.25, AUC 0.47461169958114624
gc 0
[[3.19790933e+02 1.04981161e+01]
 [3.35672256e-05 7.69672413e+00]
 [1.64760083e+02 5.15845950e+02]
 [1.66609917e+02 5.06727193e+02]
 [1.48816991e+02 5.10900775e+02]]
Train Epoch4 Acc 0.25000833333333333 (30001/120000), AUC 0.4544796943664551
Test Epoch4 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch4 layer1 Acc 0.9125, AUC 0.9778147339820862
Test Epoch4 layer2 Acc 0.25, AUC 0.6750193238258362
Test Epoch4 layer3 Acc 0.25, AUC 0.47702208161354065
Test Epoch4 layer4 Acc 0.25, AUC 0.42688044905662537
gc 0
[[3.19790934e+02 1.04986695e+01]
 [3.27001705e-04 6.91669230e+00]
 [1.64592263e+02 5.10214730e+02]
 [1.66471122e+02 5.07978850e+02]
 [1.48674070e+02 5.11393051e+02]]
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.43904852867126465
Test Epoch5 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch5 layer1 Acc 0.9128947368421053, AUC 0.9774972200393677
Test Epoch5 layer2 Acc 0.25, AUC 0.698990523815155
Test Epoch5 layer3 Acc 0.25, AUC 0.468517005443573
Test Epoch5 layer4 Acc 0.25, AUC 0.4375622868537903
gc 0
[[3.19790935e+02 1.05003189e+01]
 [7.11695698e-04 6.37295471e+00]
 [1.63874569e+02 5.03926200e+02]
 [1.65918042e+02 5.12400825e+02]
 [1.48195094e+02 5.13541309e+02]]
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.459640771150589
Test Epoch6 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch6 layer1 Acc 0.9113157894736842, AUC 0.9775790572166443
Test Epoch6 layer2 Acc 0.25, AUC 0.7137954235076904
Test Epoch6 layer3 Acc 0.25, AUC 0.46343737840652466
Test Epoch6 layer4 Acc 0.25, AUC 0.4661526679992676
gc 0
[[3.19790934e+02 1.04990982e+01]
 [2.03496618e-06 5.88400289e+00]
 [1.63306893e+02 5.00518615e+02]
 [1.65491574e+02 5.16710070e+02]
 [1.47851139e+02 5.17197214e+02]]
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.4789067208766937
Test Epoch7 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch7 layer1 Acc 0.9122368421052631, AUC 0.9775424003601074
Test Epoch7 layer2 Acc 0.25, AUC 0.7156915664672852
Test Epoch7 layer3 Acc 0.25, AUC 0.4669995903968811
Test Epoch7 layer4 Acc 0.25, AUC 0.49047917127609253
gc 0
[[3.19790934e+02 1.05021387e+01]
 [1.08408153e-04 5.65769546e+00]
 [1.63264023e+02 4.99082215e+02]
 [1.65459597e+02 5.20441284e+02]
 [1.47825642e+02 5.21092107e+02]]
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.49393707513809204
Test Epoch8 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch8 layer1 Acc 0.9122368421052631, AUC 0.9765378832817078
Test Epoch8 layer2 Acc 0.25, AUC 0.7116184234619141
Test Epoch8 layer3 Acc 0.25, AUC 0.4991701543331146
Test Epoch8 layer4 Acc 0.25, AUC 0.4996706545352936
gc 0
[[3.19790934e+02 1.05040483e+01]
 [2.85840434e-04 5.44392923e+00]
 [1.62870074e+02 4.98570530e+02]
 [1.65154279e+02 5.24515007e+02]
 [1.47584083e+02 5.25163260e+02]]
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.4995970129966736
Test Epoch9 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch9 layer1 Acc 0.9113157894736842, AUC 0.9773290753364563
Test Epoch9 layer2 Acc 0.25, AUC 0.7023719549179077
Test Epoch9 layer3 Acc 0.25, AUC 0.5145506262779236
Test Epoch9 layer4 Acc 0.25, AUC 0.5040103197097778
Best AUC 0.9808547496795654
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//ag_news/ag_news_transformeral_l5_m2.pt
[[1716   52   87   45]
 [  18 1855   10   17]
 [  44   10 1684  162]
 [  57   12  135 1696]]
Figure(640x480)
[[1705   62   79   54]
 [  12 1866   13    9]
 [  44   19 1688  149]
 [  55   17  147 1681]]
Figure(640x480)
[[   0    0    0 1900]
 [   0    0    0 1900]
 [   0    0    0 1900]
 [   0    0    0 1900]]
Figure(640x480)
[[   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]]
Figure(640x480)
[[1900    0    0    0]
 [1900    0    0    0]
 [1900    0    0    0]
 [1900    0    0    0]]
Figure(640x480)
