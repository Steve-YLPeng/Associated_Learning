total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask4//ag_news/ag_news_transformeral_l5_m4_prefix.pt
Start Training
gc 9
[[3.19626248e+02 1.93804284e+01]
 [4.05441869e-03 1.17537821e+01]
 [7.92597308e-03 1.08050556e+01]
 [1.37185970e-02 1.11887392e+01]
 [2.98945090e+00 2.06657560e+01]]
Train Epoch0 Acc 0.926375 (111165/120000), AUC 0.9864469766616821
Test Epoch0 layer0 Acc 0.9144736842105263, AUC 0.9807368516921997
Save ckpt to ./ckpt/mask5//ag_news/ag_news_transformeral_l5_m5_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9151315789473684, AUC 0.977955162525177
Test Epoch0 layer2 Acc 0.9144736842105263, AUC 0.976295530796051
Test Epoch0 layer3 Acc 0.9155263157894736, AUC 0.9770060777664185
Test Epoch0 layer4 Acc 0.9155263157894736, AUC 0.9761558175086975
gc 0
[[3.19626248e+02 1.91247431e+01]
 [1.10452492e-03 1.07513766e+01]
 [2.23235973e-03 9.83299100e+00]
 [3.50450698e-03 9.89130655e+00]
 [1.65599403e-03 9.81219358e+00]]
Train Epoch1 Acc 0.954975 (114597/120000), AUC 0.9915791153907776
Test Epoch1 layer0 Acc 0.9142105263157895, AUC 0.9804727435112
Test Epoch1 layer1 Acc 0.9146052631578947, AUC 0.9771744608879089
Test Epoch1 layer2 Acc 0.915, AUC 0.9768801331520081
Test Epoch1 layer3 Acc 0.9144736842105263, AUC 0.9778557419776917
Test Epoch1 layer4 Acc 0.9143421052631578, AUC 0.9756900072097778
gc 0
[[3.19626248e+02 1.88774404e+01]
 [1.54745992e-03 9.94444048e+00]
 [2.90460662e-03 9.05839887e+00]
 [4.67789593e-03 8.99434386e+00]
 [2.44714026e-03 8.84688200e+00]]
Train Epoch2 Acc 0.9578416666666667 (114941/120000), AUC 0.9920903444290161
Test Epoch2 layer0 Acc 0.9113157894736842, AUC 0.9801604151725769
Test Epoch2 layer1 Acc 0.9122368421052631, AUC 0.9766252040863037
Test Epoch2 layer2 Acc 0.9114473684210527, AUC 0.9767356514930725
Test Epoch2 layer3 Acc 0.9122368421052631, AUC 0.9776225686073303
Test Epoch2 layer4 Acc 0.9119736842105263, AUC 0.9765037298202515
gc 0
[[3.19626248e+02 1.87040272e+01]
 [1.88809573e-03 9.25715376e+00]
 [3.51001320e-03 8.35662577e+00]
 [5.63804746e-03 8.10483381e+00]
 [3.94430137e-03 8.05820338e+00]]
Train Epoch3 Acc 0.9601416666666667 (115217/120000), AUC 0.9929492473602295
Test Epoch3 layer0 Acc 0.9123684210526316, AUC 0.9798830151557922
Test Epoch3 layer1 Acc 0.9128947368421053, AUC 0.976298451423645
Test Epoch3 layer2 Acc 0.9125, AUC 0.9767619371414185
Test Epoch3 layer3 Acc 0.9126315789473685, AUC 0.9772052764892578
Test Epoch3 layer4 Acc 0.911578947368421, AUC 0.9758427143096924
gc 0
[[3.19626248e+02 1.85551990e+01]
 [1.03120718e-03 8.66649741e+00]
 [1.83315696e-03 7.68513987e+00]
 [2.84741379e-03 7.27084674e+00]
 [2.74517218e-03 7.41861225e+00]]
Train Epoch4 Acc 0.962225 (115467/120000), AUC 0.9931280016899109
Test Epoch4 layer0 Acc 0.9119736842105263, AUC 0.9798732995986938
Test Epoch4 layer1 Acc 0.9103947368421053, AUC 0.9755065441131592
Test Epoch4 layer2 Acc 0.91, AUC 0.9746108055114746
Test Epoch4 layer3 Acc 0.9098684210526315, AUC 0.9749669432640076
Test Epoch4 layer4 Acc 0.9096052631578947, AUC 0.9730724096298218
gc 0
[[3.19626248e+02 1.75986799e+01]
 [3.92302614e-08 7.60328803e+00]
 [6.71714803e-07 6.58260280e+00]
 [4.40001706e-06 6.13281889e+00]
 [7.36666722e-06 6.30505920e+00]]
Train Epoch5 Acc 0.9663166666666667 (115958/120000), AUC 0.9943724870681763
Test Epoch5 layer0 Acc 0.9105263157894737, AUC 0.9796695709228516
Test Epoch5 layer1 Acc 0.9092105263157895, AUC 0.974892795085907
Test Epoch5 layer2 Acc 0.908157894736842, AUC 0.9733807444572449
Test Epoch5 layer3 Acc 0.9076315789473685, AUC 0.9727123975753784
Test Epoch5 layer4 Acc 0.9078947368421053, AUC 0.9694496393203735
gc 0
[[3.19626248e+02 1.75141990e+01]
 [2.06322950e-04 7.35583997e+00]
 [4.66701717e-04 6.16303926e+00]
 [7.29634176e-04 5.72400978e+00]
 [3.68528947e-03 5.71391912e+00]]
Train Epoch6 Acc 0.9673416666666667 (116081/120000), AUC 0.9948207139968872
Test Epoch6 layer0 Acc 0.9097368421052632, AUC 0.9791214466094971
Test Epoch6 layer1 Acc 0.9089473684210526, AUC 0.9742750525474548
Test Epoch6 layer2 Acc 0.9082894736842105, AUC 0.9713300466537476
Test Epoch6 layer3 Acc 0.9084210526315789, AUC 0.9696824550628662
Test Epoch6 layer4 Acc 0.9080263157894737, AUC 0.9674422144889832
gc 0
[[3.19626248e+02 1.74509346e+01]
 [3.58339465e-04 7.11545816e+00]
 [6.59765954e-04 5.90549174e+00]
 [1.02269489e-03 5.48335386e+00]
 [7.52549564e-04 5.21334434e+00]]
Train Epoch7 Acc 0.9684 (116208/120000), AUC 0.9950818419456482
Test Epoch7 layer0 Acc 0.9093421052631578, AUC 0.9793649315834045
Test Epoch7 layer1 Acc 0.9102631578947369, AUC 0.97464919090271
Test Epoch7 layer2 Acc 0.9080263157894737, AUC 0.9727232456207275
Test Epoch7 layer3 Acc 0.9085526315789474, AUC 0.9705259203910828
Test Epoch7 layer4 Acc 0.9080263157894737, AUC 0.9690071940422058
gc 0
[[3.19626248e+02 1.73990042e+01]
 [2.89433396e-04 6.87692417e+00]
 [4.68079630e-04 5.65338087e+00]
 [7.11804616e-04 5.26152060e+00]
 [7.67278347e-04 4.97619000e+00]]
Train Epoch8 Acc 0.9692833333333334 (116314/120000), AUC 0.9950486421585083
Test Epoch8 layer0 Acc 0.9097368421052632, AUC 0.9790241718292236
Test Epoch8 layer1 Acc 0.9084210526315789, AUC 0.9740422964096069
Test Epoch8 layer2 Acc 0.9071052631578947, AUC 0.9703269004821777
Test Epoch8 layer3 Acc 0.9073684210526316, AUC 0.9685105681419373
Test Epoch8 layer4 Acc 0.9068421052631579, AUC 0.9649446606636047
gc 0
[[3.19626248e+02 1.68876641e+01]
 [6.34054548e-06 6.34850060e+00]
 [1.51570388e-04 5.13862130e+00]
 [5.74202015e-04 4.76948960e+00]
 [1.16688448e-03 4.46947209e+00]]
Train Epoch9 Acc 0.9714833333333334 (116578/120000), AUC 0.9955437183380127
Test Epoch9 layer0 Acc 0.9089473684210526, AUC 0.9789524078369141
Test Epoch9 layer1 Acc 0.9068421052631579, AUC 0.9736276268959045
Test Epoch9 layer2 Acc 0.9061842105263158, AUC 0.9699100852012634
Test Epoch9 layer3 Acc 0.9063157894736842, AUC 0.9681098461151123
Test Epoch9 layer4 Acc 0.9068421052631579, AUC 0.9657639861106873
Best AUC 0.9807368516921997
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//ag_news/ag_news_transformeral_l5_m5_prefix.pt
[[1711   58   84   47]
 [  17 1859   14   10]
 [  47   20 1673  160]
 [  48   14  131 1707]]
Figure(640x480)
[[1728   49   67   56]
 [  21 1842   21   16]
 [  53   13 1678  156]
 [  48   11  134 1707]]
Figure(640x480)
[[1729   50   65   56]
 [  23 1838   24   15]
 [  53   11 1682  154]
 [  48   10  141 1701]]
Figure(640x480)
[[1728   51   65   56]
 [  21 1843   21   15]
 [  53   12 1682  153]
 [  48   10  137 1705]]
Figure(640x480)
[[1728   51   64   57]
 [  20 1843   22   15]
 [  53   12 1682  153]
 [  48   10  137 1705]]
Figure(640x480)
