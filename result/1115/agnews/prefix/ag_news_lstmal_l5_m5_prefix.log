total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask4//ag_news/ag_news_lstmal_l5_m4_prefix.pt
Start Training
gc 9
[[3.19626248e+02 1.84559966e+01]
 [9.85191181e-05 1.17329291e+01]
 [2.31701802e-04 1.06085844e+01]
 [4.53504738e-04 1.00704711e+01]
 [1.61580868e+01 1.20992995e+01]]
Train Epoch0 Acc 0.91145 (109374/120000), AUC 0.9824080467224121
Test Epoch0 layer0 Acc 0.9135526315789474, AUC 0.9797770977020264
Save ckpt to ./ckpt/mask5//ag_news/ag_news_lstmal_l5_m5_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9117105263157895, AUC 0.9813846349716187
Save ckpt to ./ckpt/mask5//ag_news/ag_news_lstmal_l5_m5_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.910921052631579, AUC 0.9808233976364136
Test Epoch0 layer3 Acc 0.9103947368421053, AUC 0.9799756407737732
Test Epoch0 layer4 Acc 0.9085526315789474, AUC 0.9738231301307678
gc 0
[[3.19626248e+02 1.82741327e+01]
 [6.64967382e-05 1.11610706e+01]
 [1.57928540e-04 1.00894110e+01]
 [2.98010311e-04 9.47218173e+00]
 [9.25535141e-05 9.53558632e+00]]
Train Epoch1 Acc 0.9538916666666667 (114467/120000), AUC 0.9907230138778687
Test Epoch1 layer0 Acc 0.9136842105263158, AUC 0.9797673225402832
Test Epoch1 layer1 Acc 0.9103947368421053, AUC 0.9820788502693176
Save ckpt to ./ckpt/mask5//ag_news/ag_news_lstmal_l5_m5_prefix.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9110526315789473, AUC 0.9817405939102173
Test Epoch1 layer3 Acc 0.9102631578947369, AUC 0.9798771739006042
Test Epoch1 layer4 Acc 0.9105263157894737, AUC 0.977279543876648
gc 0
[[3.19626248e+02 1.81191112e+01]
 [5.66588185e-05 1.06589981e+01]
 [1.31199199e-04 9.64470399e+00]
 [2.35780753e-04 9.02304724e+00]
 [7.55908628e-05 9.02150882e+00]]
Train Epoch2 Acc 0.9564833333333334 (114778/120000), AUC 0.9913773536682129
Test Epoch2 layer0 Acc 0.9111842105263158, AUC 0.9797646999359131
Test Epoch2 layer1 Acc 0.9072368421052631, AUC 0.9806265830993652
Test Epoch2 layer2 Acc 0.9073684210526316, AUC 0.9808938503265381
Test Epoch2 layer3 Acc 0.9073684210526316, AUC 0.9781748056411743
Test Epoch2 layer4 Acc 0.9063157894736842, AUC 0.9741049408912659
gc 0
[[3.19626248e+02 1.79869373e+01]
 [7.76099626e-05 1.01882791e+01]
 [1.74815254e-04 9.21490939e+00]
 [2.98452158e-04 8.60441271e+00]
 [9.96011496e-05 8.56521734e+00]]
Train Epoch3 Acc 0.9586833333333333 (115042/120000), AUC 0.9918150305747986
Test Epoch3 layer0 Acc 0.9126315789473685, AUC 0.9794958233833313
Test Epoch3 layer1 Acc 0.9076315789473685, AUC 0.9799352884292603
Test Epoch3 layer2 Acc 0.9082894736842105, AUC 0.978786826133728
Test Epoch3 layer3 Acc 0.9077631578947368, AUC 0.9787143468856812
Test Epoch3 layer4 Acc 0.9073684210526316, AUC 0.9713549613952637
gc 0
[[3.19626248e+02 1.78791957e+01]
 [6.59389177e-05 9.83273452e+00]
 [1.45383279e-04 8.90912775e+00]
 [2.66428030e-04 8.31623863e+00]
 [9.38265332e-05 8.26738862e+00]]
Train Epoch4 Acc 0.9606 (115272/120000), AUC 0.992201566696167
Test Epoch4 layer0 Acc 0.9105263157894737, AUC 0.9793128967285156
Test Epoch4 layer1 Acc 0.9040789473684211, AUC 0.9794789552688599
Test Epoch4 layer2 Acc 0.904342105263158, AUC 0.9796619415283203
Test Epoch4 layer3 Acc 0.9039473684210526, AUC 0.9758958220481873
Test Epoch4 layer4 Acc 0.9031578947368422, AUC 0.9713646173477173
gc 0
[[3.19626248e+02 1.69992603e+01]
 [6.63988896e-05 8.80649730e+00]
 [1.39537476e-04 7.95511181e+00]
 [7.25697325e-05 7.38675747e+00]
 [4.25601883e-05 7.34434470e+00]]
Train Epoch5 Acc 0.9642 (115704/120000), AUC 0.9929014444351196
Test Epoch5 layer0 Acc 0.9107894736842105, AUC 0.9792019128799438
Test Epoch5 layer1 Acc 0.9031578947368422, AUC 0.9785152673721313
Test Epoch5 layer2 Acc 0.904342105263158, AUC 0.9785767197608948
Test Epoch5 layer3 Acc 0.9039473684210526, AUC 0.975330650806427
Test Epoch5 layer4 Acc 0.9038157894736842, AUC 0.9715097546577454
gc 0
[[3.19626248e+02 1.69218217e+01]
 [1.67067339e-06 8.34321279e+00]
 [4.26650239e-06 7.50845103e+00]
 [1.50573657e-05 6.98752019e+00]
 [5.10137080e-06 6.90307972e+00]]
Train Epoch6 Acc 0.9662666666666667 (115952/120000), AUC 0.9930319786071777
Test Epoch6 layer0 Acc 0.91, AUC 0.9790732860565186
Test Epoch6 layer1 Acc 0.9019736842105263, AUC 0.9774643182754517
Test Epoch6 layer2 Acc 0.9030263157894737, AUC 0.9770916700363159
Test Epoch6 layer3 Acc 0.9031578947368422, AUC 0.9740411043167114
Test Epoch6 layer4 Acc 0.9022368421052631, AUC 0.9679720401763916
gc 0
[[3.19626248e+02 1.68884589e+01]
 [7.28294972e-06 8.15573409e+00]
 [1.68107178e-05 7.33691797e+00]
 [5.32228467e-05 6.82529854e+00]
 [2.01940550e-05 6.74372132e+00]]
Train Epoch7 Acc 0.9668583333333334 (116023/120000), AUC 0.9931612014770508
Test Epoch7 layer0 Acc 0.9088157894736842, AUC 0.9788937568664551
Test Epoch7 layer1 Acc 0.9022368421052631, AUC 0.9773893356323242
Test Epoch7 layer2 Acc 0.9027631578947368, AUC 0.9767907857894897
Test Epoch7 layer3 Acc 0.9031578947368422, AUC 0.9745420217514038
Test Epoch7 layer4 Acc 0.9040789473684211, AUC 0.968728244304657
gc 0
[[3.19626248e+02 1.68605814e+01]
 [1.86988116e-05 7.96727977e+00]
 [4.20496105e-05 7.15710600e+00]
 [7.42716537e-05 6.65692435e+00]
 [3.53168837e-05 6.57921226e+00]]
Train Epoch8 Acc 0.96805 (116166/120000), AUC 0.993229866027832
Test Epoch8 layer0 Acc 0.9092105263157895, AUC 0.9787558317184448
Test Epoch8 layer1 Acc 0.8984210526315789, AUC 0.9769188165664673
Test Epoch8 layer2 Acc 0.9, AUC 0.9768050909042358
Test Epoch8 layer3 Acc 0.8998684210526315, AUC 0.9728112816810608
Test Epoch8 layer4 Acc 0.9001315789473684, AUC 0.9681612253189087
gc 0
[[3.19626248e+02 1.63668037e+01]
 [1.16566641e-05 7.41597257e+00]
 [2.48992192e-05 6.63342265e+00]
 [1.23294768e-05 6.14911099e+00]
 [1.15638034e-05 6.08121937e+00]]
Train Epoch9 Acc 0.97045 (116454/120000), AUC 0.9935094118118286
Test Epoch9 layer0 Acc 0.9092105263157895, AUC 0.9786372184753418
Test Epoch9 layer1 Acc 0.8973684210526316, AUC 0.9745657444000244
Test Epoch9 layer2 Acc 0.8981578947368422, AUC 0.9740793108940125
Test Epoch9 layer3 Acc 0.8986842105263158, AUC 0.9707643389701843
Test Epoch9 layer4 Acc 0.8982894736842105, AUC 0.9652010202407837
Best AUC 0.9820788502693176
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//ag_news/ag_news_lstmal_l5_m5_prefix.pt
[[1700   57   95   48]
 [  15 1854   16   15]
 [  40   18 1682  160]
 [  46   15  131 1708]]
Figure(640x480)
[[1704   58   79   59]
 [  23 1844   19   14]
 [  46   18 1674  162]
 [  49   15  139 1697]]
Figure(640x480)
[[1707   56   77   60]
 [  24 1842   19   15]
 [  46   17 1673  164]
 [  45   15  138 1702]]
Figure(640x480)
[[1704   58   78   60]
 [  23 1843   19   15]
 [  48   18 1670  164]
 [  44   15  140 1701]]
Figure(640x480)
[[1705   56   81   58]
 [  26 1840   19   15]
 [  47   17 1684  152]
 [  49   15  145 1691]]
Figure(640x480)
