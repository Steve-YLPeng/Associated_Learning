total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask2//ag_news/ag_news_transformeral_l5_m2_prefix.pt
Start Training
gc 9
[[3.19626254e+02 2.00180412e+01]
 [2.67902916e-03 1.68106885e+01]
 [3.07666588e+00 2.62761294e+01]
 [2.18171588e+02 5.44131354e+02]
 [1.85331528e+02 5.39178031e+02]]
Train Epoch0 Acc 0.07235 (8682/120000), AUC 0.3780262768268585
Test Epoch0 layer0 Acc 0.9143421052631578, AUC 0.9807870388031006
Save ckpt to ./ckpt/mask3//ag_news/ag_news_transformeral_l5_m3_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.915, AUC 0.9792570471763611
Test Epoch0 layer2 Acc 0.9147368421052632, AUC 0.9782921671867371
Test Epoch0 layer3 Acc 0.019605263157894737, AUC 0.4815421402454376
Test Epoch0 layer4 Acc 0.017236842105263158, AUC 0.31840211153030396
gc 0
[[3.19626248e+02 1.96043983e+01]
 [1.26385386e-03 1.29770792e+01]
 [3.65914481e-04 1.21155001e+01]
 [2.19441768e+02 5.61149529e+02]
 [1.86208214e+02 5.46303679e+02]]
Train Epoch1 Acc 0.010891666666666666 (1307/120000), AUC 0.31145179271698
Test Epoch1 layer0 Acc 0.9135526315789474, AUC 0.9803289175033569
Test Epoch1 layer1 Acc 0.9152631578947369, AUC 0.978402853012085
Test Epoch1 layer2 Acc 0.9143421052631578, AUC 0.9781662225723267
Test Epoch1 layer3 Acc 0.015789473684210527, AUC 0.41112959384918213
Test Epoch1 layer4 Acc 0.016710526315789474, AUC 0.31578782200813293
gc 0
[[3.19626248e+02 1.92707180e+01]
 [1.49460439e-03 1.14808769e+01]
 [4.74134914e-04 1.07043243e+01]
 [2.18125641e+02 5.66264597e+02]
 [1.85178859e+02 5.46606085e+02]]
Train Epoch2 Acc 0.014633333333333333 (1756/120000), AUC 0.32384341955184937
Test Epoch2 layer0 Acc 0.9118421052631579, AUC 0.9805762767791748
Test Epoch2 layer1 Acc 0.9130263157894737, AUC 0.9785187840461731
Test Epoch2 layer2 Acc 0.9121052631578948, AUC 0.9781940579414368
Test Epoch2 layer3 Acc 0.020526315789473684, AUC 0.38873136043548584
Test Epoch2 layer4 Acc 0.019210526315789473, AUC 0.3479437828063965
gc 0
[[3.19626248e+02 1.90208207e+01]
 [1.50018347e-03 1.05280084e+01]
 [5.86921675e-04 9.81362565e+00]
 [2.16797707e+02 5.68916060e+02]
 [1.84147606e+02 5.46157388e+02]]
Train Epoch3 Acc 0.06365 (7638/120000), AUC 0.34101390838623047
Test Epoch3 layer0 Acc 0.9105263157894737, AUC 0.9799764156341553
Test Epoch3 layer1 Acc 0.9103947368421053, AUC 0.9751265645027161
Test Epoch3 layer2 Acc 0.9105263157894737, AUC 0.9745567440986633
Test Epoch3 layer3 Acc 0.023289473684210527, AUC 0.34624069929122925
Test Epoch3 layer4 Acc 0.03342105263157895, AUC 0.37314167618751526
gc 0
[[3.19626248e+02 1.88240423e+01]
 [1.34665914e-03 9.75064637e+00]
 [8.26442555e-04 9.13076575e+00]
 [2.15270118e+02 5.69264717e+02]
 [1.82943418e+02 5.46847314e+02]]
Train Epoch4 Acc 0.1764 (21168/120000), AUC 0.3584829568862915
Test Epoch4 layer0 Acc 0.9117105263157895, AUC 0.9797196984291077
Test Epoch4 layer1 Acc 0.911578947368421, AUC 0.9765382409095764
Test Epoch4 layer2 Acc 0.9121052631578948, AUC 0.977111279964447
Test Epoch4 layer3 Acc 0.025657894736842105, AUC 0.3358533978462219
Test Epoch4 layer4 Acc 0.2501315789473684, AUC 0.38951534032821655
gc 0
[[3.19626248e+02 1.77850281e+01]
 [1.47919009e-05 8.57778287e+00]
 [1.07063989e-05 7.96540512e+00]
 [2.14581740e+02 5.68360301e+02]
 [1.82411036e+02 5.48003504e+02]]
Train Epoch5 Acc 0.22848333333333334 (27418/120000), AUC 0.37150096893310547
Test Epoch5 layer0 Acc 0.91, AUC 0.9799718260765076
Test Epoch5 layer1 Acc 0.9111842105263158, AUC 0.9744775891304016
Test Epoch5 layer2 Acc 0.9107894736842105, AUC 0.9732774496078491
Test Epoch5 layer3 Acc 0.025657894736842105, AUC 0.328636109828949
Test Epoch5 layer4 Acc 0.25, AUC 0.4129031300544739
gc 0
[[3.19626248e+02 1.76652650e+01]
 [2.69986765e-04 8.24398762e+00]
 [2.96869572e-04 7.63630930e+00]
 [2.14453033e+02 5.67354040e+02]
 [1.82292052e+02 5.49743681e+02]]
Train Epoch6 Acc 0.24726666666666666 (29672/120000), AUC 0.38795173168182373
Test Epoch6 layer0 Acc 0.9127631578947368, AUC 0.9794211983680725
Test Epoch6 layer1 Acc 0.91, AUC 0.9755118489265442
Test Epoch6 layer2 Acc 0.9103947368421053, AUC 0.9750584363937378
Test Epoch6 layer3 Acc 0.02763157894736842, AUC 0.28506186604499817
Test Epoch6 layer4 Acc 0.25, AUC 0.4238000512123108
gc 0
[[3.19626248e+02 1.76066989e+01]
 [3.87183555e-04 7.95684870e+00]
 [4.96869431e-04 7.34304458e+00]
 [2.14009971e+02 5.65782162e+02]
 [1.81924924e+02 5.53103887e+02]]
Train Epoch7 Acc 0.24980833333333333 (29977/120000), AUC 0.4099363386631012
Test Epoch7 layer0 Acc 0.91, AUC 0.9795781373977661
Test Epoch7 layer1 Acc 0.9094736842105263, AUC 0.9743266105651855
Test Epoch7 layer2 Acc 0.9082894736842105, AUC 0.9721422791481018
Test Epoch7 layer3 Acc 0.02631578947368421, AUC 0.28287526965141296
Test Epoch7 layer4 Acc 0.25, AUC 0.4247052073478699
gc 0
[[3.19626248e+02 1.75451098e+01]
 [3.35228671e-04 7.68345169e+00]
 [5.72938960e-04 7.05773578e+00]
 [2.13343569e+02 5.63872156e+02]
 [1.81371152e+02 5.56513256e+02]]
Train Epoch8 Acc 0.24999166666666667 (29999/120000), AUC 0.42774587869644165
Test Epoch8 layer0 Acc 0.9106578947368421, AUC 0.9791623950004578
Test Epoch8 layer1 Acc 0.9096052631578947, AUC 0.9735012054443359
Test Epoch8 layer2 Acc 0.9097368421052632, AUC 0.9715790748596191
Test Epoch8 layer3 Acc 0.03118421052631579, AUC 0.26565563678741455
Test Epoch8 layer4 Acc 0.25, AUC 0.42982402443885803
gc 0
[[3.19626248e+02 1.69964867e+01]
 [6.32377438e-08 7.10082061e+00]
 [1.15467240e-07 6.43394614e+00]
 [2.13014817e+02 5.63285329e+02]
 [1.81096951e+02 5.57870187e+02]]
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.4326425790786743
Test Epoch9 layer0 Acc 0.9107894736842105, AUC 0.979125440120697
Test Epoch9 layer1 Acc 0.9084210526315789, AUC 0.9732424020767212
Test Epoch9 layer2 Acc 0.9082894736842105, AUC 0.9713033437728882
Test Epoch9 layer3 Acc 0.03328947368421053, AUC 0.2698472738265991
Test Epoch9 layer4 Acc 0.25, AUC 0.42988884449005127
Best AUC 0.9807870388031006
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//ag_news/ag_news_transformeral_l5_m3_prefix.pt
[[1709   58   82   51]
 [  16 1857   12   15]
 [  47   16 1663  174]
 [  45   13  122 1720]]
Figure(640x480)
[[1713   57   69   61]
 [  15 1859   10   16]
 [  51   18 1636  195]
 [  41   12  101 1746]]
Figure(640x480)
[[1709   59   69   63]
 [  14 1858   10   18]
 [  51   18 1623  208]
 [  35   12   91 1762]]
Figure(640x480)
[[   2  151 1747    0]
 [   0   83 1817    0]
 [   2 1834   64    0]
 [   0  646 1254    0]]
Figure(640x480)
[[  85  165    0 1650]
 [1885   13    0    2]
 [  73 1798    0   29]
 [  45 1822    0   33]]
Figure(640x480)
