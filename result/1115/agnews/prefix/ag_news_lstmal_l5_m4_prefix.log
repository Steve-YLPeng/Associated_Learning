total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask3//ag_news/ag_news_lstmal_l5_m3_prefix.pt
Start Training
gc 9
[[3.19626248e+02 1.85822143e+01]
 [1.66764061e-04 1.21935763e+01]
 [3.51803932e-04 1.10297536e+01]
 [1.96989997e+01 1.29604760e+01]
 [2.41607167e+02 1.33522482e+02]]
Train Epoch0 Acc 0.0025083333333333333 (301/120000), AUC 0.026018206030130386
Test Epoch0 layer0 Acc 0.9127631578947368, AUC 0.980099618434906
Save ckpt to ./ckpt/mask4//ag_news/ag_news_lstmal_l5_m4_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9123684210526316, AUC 0.9822193384170532
Save ckpt to ./ckpt/mask4//ag_news/ag_news_lstmal_l5_m4_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9117105263157895, AUC 0.9824992418289185
Save ckpt to ./ckpt/mask4//ag_news/ag_news_lstmal_l5_m4_prefix.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9093421052631578, AUC 0.980257511138916
Test Epoch0 layer4 Acc 0.006842105263157895, AUC 0.043929293751716614
gc 0
[[3.19626248e+02 1.83928800e+01]
 [5.84234055e-05 1.15880078e+01]
 [1.42794955e-04 1.04703413e+01]
 [4.35598349e-05 9.95878277e+00]
 [2.53044663e+02 1.35851286e+02]]
Train Epoch1 Acc 0.0019416666666666666 (233/120000), AUC 0.022936290130019188
Test Epoch1 layer0 Acc 0.9119736842105263, AUC 0.9799684286117554
Test Epoch1 layer1 Acc 0.910921052631579, AUC 0.9820797443389893
Test Epoch1 layer2 Acc 0.91, AUC 0.981840968132019
Test Epoch1 layer3 Acc 0.9097368421052632, AUC 0.9787667989730835
Test Epoch1 layer4 Acc 0.006710526315789474, AUC 0.04559160768985748
gc 0
[[3.19626248e+02 1.82264854e+01]
 [6.25606804e-05 1.10636538e+01]
 [1.40443008e-04 9.99695558e+00]
 [4.11822264e-05 9.42231390e+00]
 [2.52949120e+02 1.33473719e+02]]
Train Epoch2 Acc 0.0017333333333333333 (208/120000), AUC 0.02341737598180771
Test Epoch2 layer0 Acc 0.9111842105263158, AUC 0.9800647497177124
Test Epoch2 layer1 Acc 0.9101315789473684, AUC 0.9810791015625
Test Epoch2 layer2 Acc 0.9089473684210526, AUC 0.9796332716941833
Test Epoch2 layer3 Acc 0.9080263157894737, AUC 0.9794396162033081
Test Epoch2 layer4 Acc 0.008157894736842105, AUC 0.0461411252617836
gc 0
[[3.19626248e+02 1.80755596e+01]
 [6.82398648e-05 1.05461539e+01]
 [1.53550006e-04 9.53427104e+00]
 [4.42742361e-05 8.94670717e+00]
 [2.52844583e+02 1.31927622e+02]]
Train Epoch3 Acc 0.0017166666666666667 (206/120000), AUC 0.023991886526346207
Test Epoch3 layer0 Acc 0.9102631578947369, AUC 0.9796989560127258
Test Epoch3 layer1 Acc 0.9094736842105263, AUC 0.9810322523117065
Test Epoch3 layer2 Acc 0.9086842105263158, AUC 0.9807257056236267
Test Epoch3 layer3 Acc 0.9080263157894737, AUC 0.9787114858627319
Test Epoch3 layer4 Acc 0.007105263157894737, AUC 0.04935191571712494
gc 0
[[3.19626248e+02 1.79554022e+01]
 [6.56638423e-05 1.01027626e+01]
 [1.49823335e-04 9.13812934e+00]
 [4.38390043e-05 8.54756620e+00]
 [2.52729567e+02 1.30785544e+02]]
Train Epoch4 Acc 0.00165 (198/120000), AUC 0.024583719670772552
Test Epoch4 layer0 Acc 0.9102631578947369, AUC 0.9798831343650818
Test Epoch4 layer1 Acc 0.9078947368421053, AUC 0.9805575609207153
Test Epoch4 layer2 Acc 0.9080263157894737, AUC 0.9801660180091858
Test Epoch4 layer3 Acc 0.9082894736842105, AUC 0.9775089025497437
Test Epoch4 layer4 Acc 0.007368421052631579, AUC 0.048762544989585876
gc 0
[[3.19626248e+02 1.70593879e+01]
 [9.24651119e-08 9.00125855e+00]
 [1.93802833e-07 8.10559674e+00]
 [5.71705461e-08 7.55431485e+00]
 [2.52672653e+02 1.30334040e+02]]
Train Epoch5 Acc 0.0014666666666666667 (176/120000), AUC 0.023167071864008904
Test Epoch5 layer0 Acc 0.911578947368421, AUC 0.9794018268585205
Test Epoch5 layer1 Acc 0.9060526315789473, AUC 0.9795775413513184
Test Epoch5 layer2 Acc 0.9057894736842105, AUC 0.9796168804168701
Test Epoch5 layer3 Acc 0.9053947368421053, AUC 0.9757977724075317
Test Epoch5 layer4 Acc 0.008026315789473683, AUC 0.05132729560136795
gc 0
[[3.19626248e+02 1.69806309e+01]
 [9.09658372e-06 8.76223390e+00]
 [2.05196850e-05 7.88036482e+00]
 [6.30262465e-06 7.34047576e+00]
 [2.52669318e+02 1.30210596e+02]]
Train Epoch6 Acc 0.0015166666666666666 (182/120000), AUC 0.023071905598044395
Test Epoch6 layer0 Acc 0.9102631578947369, AUC 0.9792637825012207
Test Epoch6 layer1 Acc 0.9040789473684211, AUC 0.9792124629020691
Test Epoch6 layer2 Acc 0.9047368421052632, AUC 0.9789527654647827
Test Epoch6 layer3 Acc 0.9046052631578947, AUC 0.9753440618515015
Test Epoch6 layer4 Acc 0.008026315789473683, AUC 0.05349799245595932
gc 0
[[3.19626248e+02 1.69349916e+01]
 [1.87365362e-05 8.58553521e+00]
 [4.40112150e-05 7.72397845e+00]
 [1.46482202e-05 7.19050998e+00]
 [2.52637004e+02 1.30039039e+02]]
Train Epoch7 Acc 0.0014916666666666667 (179/120000), AUC 0.024641400203108788
Test Epoch7 layer0 Acc 0.9094736842105263, AUC 0.9790630340576172
Test Epoch7 layer1 Acc 0.9035526315789474, AUC 0.9780269861221313
Test Epoch7 layer2 Acc 0.9047368421052632, AUC 0.9778951406478882
Test Epoch7 layer3 Acc 0.9042105263157895, AUC 0.9744055271148682
Test Epoch7 layer4 Acc 0.008157894736842105, AUC 0.05638767033815384
gc 0
[[3.19626248e+02 1.69030390e+01]
 [1.61639364e-05 8.35444521e+00]
 [3.73488266e-05 7.49947759e+00]
 [1.41326695e-05 6.97287656e+00]
 [2.52613728e+02 1.29961853e+02]]
Train Epoch8 Acc 0.001325 (159/120000), AUC 0.02546437829732895
Test Epoch8 layer0 Acc 0.9075, AUC 0.978804886341095
Test Epoch8 layer1 Acc 0.9007894736842105, AUC 0.9768322706222534
Test Epoch8 layer2 Acc 0.9014473684210527, AUC 0.9770107269287109
Test Epoch8 layer3 Acc 0.9023684210526316, AUC 0.9723806381225586
Test Epoch8 layer4 Acc 0.009868421052631578, AUC 0.05660475790500641
gc 0
[[3.19626248e+02 1.64060783e+01]
 [7.66721369e-08 7.75303673e+00]
 [3.56157945e-07 6.94149865e+00]
 [1.38563540e-07 6.44037373e+00]
 [2.52598474e+02 1.29870204e+02]]
Train Epoch9 Acc 0.001275 (153/120000), AUC 0.026370134204626083
Test Epoch9 layer0 Acc 0.9085526315789474, AUC 0.9787007570266724
Test Epoch9 layer1 Acc 0.8988157894736842, AUC 0.9764615297317505
Test Epoch9 layer2 Acc 0.9003947368421052, AUC 0.9762751460075378
Test Epoch9 layer3 Acc 0.9006578947368421, AUC 0.9717008471488953
Test Epoch9 layer4 Acc 0.009078947368421053, AUC 0.060662947595119476
Best AUC 0.9824992418289185
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//ag_news/ag_news_lstmal_l5_m4_prefix.pt
[[1706   58   86   50]
 [  17 1861   12   10]
 [  44   20 1661  175]
 [  53   14  124 1709]]
Figure(640x480)
[[1706   60   76   58]
 [  20 1852   17   11]
 [  49   19 1677  155]
 [  49   16  136 1699]]
Figure(640x480)
[[1701   61   78   60]
 [  18 1854   17   11]
 [  46   18 1679  157]
 [  54   15  136 1695]]
Figure(640x480)
[[1696   63   77   64]
 [  18 1853   18   11]
 [  45   18 1668  169]
 [  51   17  138 1694]]
Figure(640x480)
[[   0 1832   52   16]
 [   3   36 1830   31]
 [   0 1851   14   35]
 [   0 1879   19    2]]
Figure(640x480)
