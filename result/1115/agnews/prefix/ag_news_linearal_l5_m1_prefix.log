total count words 102019
vocab size 30000
found 26754 words in glove
Start Training
gc 0
[[371.00610441  12.73509169]
 [214.47141901 101.56148151]
 [150.72739129  94.40974496]
 [144.49050465  90.90182793]
 [135.71566439  86.2559685 ]]
Train Epoch0 Acc 0.263775 (31653/120000), AUC 0.5430413484573364
Test Epoch0 layer0 Acc 0.9123684210526316, AUC 0.9797435998916626
Save ckpt to ./ckpt/mask1//ag_news/ag_news_linearal_l5_m1_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.2380263157894737, AUC 0.49466779828071594
Test Epoch0 layer2 Acc 0.2632894736842105, AUC 0.519408643245697
Test Epoch0 layer3 Acc 0.2693421052631579, AUC 0.5034986734390259
Test Epoch0 layer4 Acc 0.26092105263157894, AUC 0.5520781874656677
gc 0
[[320.49913833  11.37288108]
 [237.67244196 108.01367451]
 [165.31287846  99.46518397]
 [151.42849343  93.57592431]
 [142.49203637  87.56475094]]
Train Epoch1 Acc 0.2656833333333333 (31882/120000), AUC 0.5519667863845825
Test Epoch1 layer0 Acc 0.9155263157894736, AUC 0.9813458323478699
Save ckpt to ./ckpt/mask1//ag_news/ag_news_linearal_l5_m1_prefix.pt  ,ep 1
Test Epoch1 layer1 Acc 0.23421052631578948, AUC 0.4932217597961426
Test Epoch1 layer2 Acc 0.2619736842105263, AUC 0.5214866995811462
Test Epoch1 layer3 Acc 0.2714473684210526, AUC 0.5031304359436035
Test Epoch1 layer4 Acc 0.26539473684210524, AUC 0.5516324043273926
gc 0
[[319.89739645  11.77660802]
 [250.63157111 111.62104624]
 [172.99292624 102.0138486 ]
 [155.65745379  95.09035334]
 [146.23416032  88.2091652 ]]
Train Epoch2 Acc 0.2674166666666667 (32090/120000), AUC 0.5525858998298645
Test Epoch2 layer0 Acc 0.9140789473684211, AUC 0.9814217686653137
Save ckpt to ./ckpt/mask1//ag_news/ag_news_linearal_l5_m1_prefix.pt  ,ep 2
Test Epoch2 layer1 Acc 0.23342105263157895, AUC 0.4933329224586487
Test Epoch2 layer2 Acc 0.26355263157894737, AUC 0.522611677646637
Test Epoch2 layer3 Acc 0.2714473684210526, AUC 0.5031589269638062
Test Epoch2 layer4 Acc 0.2640789473684211, AUC 0.5506806373596191
gc 0
[[319.74482578  12.20076465]
 [260.52310005 114.27814706]
 [178.7145295  103.76636746]
 [158.86459266  96.14276466]
 [149.02165574  88.5381237 ]]
Train Epoch3 Acc 0.26864166666666667 (32237/120000), AUC 0.5527620911598206
Test Epoch3 layer0 Acc 0.9144736842105263, AUC 0.981503963470459
Save ckpt to ./ckpt/mask1//ag_news/ag_news_linearal_l5_m1_prefix.pt  ,ep 3
Test Epoch3 layer1 Acc 0.2325, AUC 0.49299103021621704
Test Epoch3 layer2 Acc 0.2656578947368421, AUC 0.5232404470443726
Test Epoch3 layer3 Acc 0.2718421052631579, AUC 0.5024233460426331
Test Epoch3 layer4 Acc 0.26671052631578945, AUC 0.5512166023254395
gc 0
[[319.68589675  12.62203171]
 [268.99287131 116.6027571 ]
 [183.54843973 105.24651653]
 [161.59667486  97.0683855 ]
 [151.37296793  88.84597162]]
Train Epoch4 Acc 0.2679416666666667 (32153/120000), AUC 0.5532774925231934
Test Epoch4 layer0 Acc 0.9130263157894737, AUC 0.9810487627983093
Test Epoch4 layer1 Acc 0.23236842105263159, AUC 0.49301475286483765
Test Epoch4 layer2 Acc 0.26631578947368423, AUC 0.5241109132766724
Test Epoch4 layer3 Acc 0.2730263157894737, AUC 0.5018214583396912
Test Epoch4 layer4 Acc 0.26671052631578945, AUC 0.5516591668128967
gc 0
[[319.65849063  13.03348653]
 [276.7162376  118.68182263]
 [187.90112916 106.54784053]
 [164.06864677  97.8736264 ]
 [153.4786173   89.10686179]]
Train Epoch5 Acc 0.26913333333333334 (32296/120000), AUC 0.5535884499549866
Test Epoch5 layer0 Acc 0.9151315789473684, AUC 0.9808909296989441
Test Epoch5 layer1 Acc 0.23328947368421052, AUC 0.49276190996170044
Test Epoch5 layer2 Acc 0.26631578947368423, AUC 0.5251362323760986
Test Epoch5 layer3 Acc 0.27342105263157895, AUC 0.5007249712944031
Test Epoch5 layer4 Acc 0.26881578947368423, AUC 0.5517821311950684
gc 0
[[319.64441127  13.47577431]
 [283.96670419 120.65893144]
 [191.95737021 107.79163319]
 [166.38421845  98.68766798]
 [155.44356635  89.35879423]]
Train Epoch6 Acc 0.26914166666666667 (32297/120000), AUC 0.5536816120147705
Test Epoch6 layer0 Acc 0.9136842105263158, AUC 0.9805335998535156
Test Epoch6 layer1 Acc 0.2325, AUC 0.4931289255619049
Test Epoch6 layer2 Acc 0.2648684210526316, AUC 0.5261982679367065
Test Epoch6 layer3 Acc 0.2730263157894737, AUC 0.4987480938434601
Test Epoch6 layer4 Acc 0.26881578947368423, AUC 0.552071213722229
gc 0
[[319.63673854  13.88199195]
 [290.93814749 122.55170162]
 [195.82422517 108.97136306]
 [168.59474488  99.46518803]
 [157.30127795  89.59322971]]
Train Epoch7 Acc 0.26903333333333335 (32284/120000), AUC 0.5542157888412476
Test Epoch7 layer0 Acc 0.9118421052631579, AUC 0.9806279540061951
Test Epoch7 layer1 Acc 0.2301315789473684, AUC 0.4929753243923187
Test Epoch7 layer2 Acc 0.26539473684210524, AUC 0.5272690057754517
Test Epoch7 layer3 Acc 0.2725, AUC 0.4976305663585663
Test Epoch7 layer4 Acc 0.26921052631578946, AUC 0.5522410869598389
gc 0
[[319.63313976  13.49838428]
 [296.16893545 123.99038437]
 [198.71308203 109.88736179]
 [170.25621036 100.06263154]
 [158.69342934  89.81000946]]
Train Epoch8 Acc 0.26925 (32310/120000), AUC 0.554209291934967
Test Epoch8 layer0 Acc 0.911578947368421, AUC 0.9802843928337097
Test Epoch8 layer1 Acc 0.23092105263157894, AUC 0.493389368057251
Test Epoch8 layer2 Acc 0.26473684210526316, AUC 0.5271111130714417
Test Epoch8 layer3 Acc 0.27342105263157895, AUC 0.4974760413169861
Test Epoch8 layer4 Acc 0.2694736842105263, AUC 0.5518849492073059
gc 0
[[319.631262    13.70598928]
 [300.26999187 125.18122056]
 [200.96731979 110.65503848]
 [171.55002341 100.55775755]
 [159.77113691  90.06825473]]
Train Epoch9 Acc 0.2698 (32376/120000), AUC 0.5544242858886719
Test Epoch9 layer0 Acc 0.9101315789473684, AUC 0.980067789554596
Test Epoch9 layer1 Acc 0.2313157894736842, AUC 0.4937307834625244
Test Epoch9 layer2 Acc 0.26473684210526316, AUC 0.5272013545036316
Test Epoch9 layer3 Acc 0.27421052631578946, AUC 0.49753063917160034
Test Epoch9 layer4 Acc 0.2685526315789474, AUC 0.5514037013053894
Best AUC 0.981503963470459
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//ag_news/ag_news_linearal_l5_m1_prefix.pt
[[1696   60   97   47]
 [  13 1857   14   16]
 [  40   15 1694  151]
 [  44   15  138 1703]]
Figure(640x480)
[[  58 1691   59   92]
 [  54 1152   31  663]
 [  27 1591   26  256]
 [  80 1236   53  531]]
Figure(640x480)
[[1598    0   94  208]
 [1473    0  214  213]
 [1557    0   91  252]
 [1467    0  103  330]]
Figure(640x480)
[[ 471    0    3 1426]
 [ 467    0   13 1420]
 [ 530    0   10 1360]
 [ 310    0    5 1585]]
Figure(640x480)
[[1198    0  243  459]
 [1226    0  305  369]
 [1049    0  644  207]
 [ 947    0  768  185]]
Figure(640x480)
