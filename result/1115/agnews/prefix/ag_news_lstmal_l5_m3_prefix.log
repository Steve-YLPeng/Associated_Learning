total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2_prefix.pt
Start Training
gc 9
[[3.19626248e+02 1.90865061e+01]
 [1.14585917e-04 1.38543749e+01]
 [2.13227871e+01 1.53131061e+01]
 [2.72546465e+02 1.56731940e+02]
 [2.21101138e+02 1.07726663e+02]]
Train Epoch0 Acc 0.0037166666666666667 (446/120000), AUC 0.07859055697917938
Test Epoch0 layer0 Acc 0.9139473684210526, AUC 0.9806954264640808
Save ckpt to ./ckpt/mask3//ag_news/ag_news_lstmal_l5_m3_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9134210526315789, AUC 0.9823383092880249
Save ckpt to ./ckpt/mask3//ag_news/ag_news_lstmal_l5_m3_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9113157894736842, AUC 0.9823130965232849
Test Epoch0 layer3 Acc 0.015, AUC 0.057187408208847046
Test Epoch0 layer4 Acc 0.008552631578947369, AUC 0.0630159080028534
gc 0
[[3.19626248e+02 1.87743273e+01]
 [6.42389539e-05 1.28046170e+01]
 [1.46586803e-05 1.16317329e+01]
 [2.89254242e+02 1.61817853e+02]
 [2.30057095e+02 1.10741228e+02]]
Train Epoch1 Acc 0.0030416666666666665 (365/120000), AUC 0.04493843764066696
Test Epoch1 layer0 Acc 0.9136842105263158, AUC 0.9805705547332764
Test Epoch1 layer1 Acc 0.9134210526315789, AUC 0.982441782951355
Save ckpt to ./ckpt/mask3//ag_news/ag_news_lstmal_l5_m3_prefix.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9117105263157895, AUC 0.9827905297279358
Save ckpt to ./ckpt/mask3//ag_news/ag_news_lstmal_l5_m3_prefix.pt  ,ep 1
Test Epoch1 layer3 Acc 0.015263157894736841, AUC 0.049232952296733856
Test Epoch1 layer4 Acc 0.008421052631578947, AUC 0.0656026303768158
gc 0
[[3.19626248e+02 1.85428562e+01]
 [8.25198173e-05 1.21070387e+01]
 [1.77790962e-05 1.09579226e+01]
 [2.89157024e+02 1.59340744e+02]
 [2.30011333e+02 1.10039581e+02]]
Train Epoch2 Acc 0.0028 (336/120000), AUC 0.04581394046545029
Test Epoch2 layer0 Acc 0.9123684210526316, AUC 0.9804716110229492
Test Epoch2 layer1 Acc 0.9126315789473685, AUC 0.9818516969680786
Test Epoch2 layer2 Acc 0.9110526315789473, AUC 0.9821757078170776
Test Epoch2 layer3 Acc 0.015789473684210527, AUC 0.04359402507543564
Test Epoch2 layer4 Acc 0.009473684210526316, AUC 0.07331028580665588
gc 0
[[3.19626248e+02 1.83288397e+01]
 [6.11814747e-05 1.14517477e+01]
 [1.35749386e-05 1.03519943e+01]
 [2.89049702e+02 1.57602319e+02]
 [2.29958401e+02 1.09597870e+02]]
Train Epoch3 Acc 0.002575 (309/120000), AUC 0.05185480788350105
Test Epoch3 layer0 Acc 0.9123684210526316, AUC 0.979719877243042
Test Epoch3 layer1 Acc 0.9114473684210527, AUC 0.9814196825027466
Test Epoch3 layer2 Acc 0.910921052631579, AUC 0.9810643196105957
Test Epoch3 layer3 Acc 0.015657894736842107, AUC 0.042085468769073486
Test Epoch3 layer4 Acc 0.008026315789473683, AUC 0.08841560035943985
gc 0
[[3.19626248e+02 1.81843496e+01]
 [5.98435577e-05 1.09184219e+01]
 [1.32693718e-05 9.86994069e+00]
 [2.88963239e+02 1.56263428e+02]
 [2.29924157e+02 1.09200983e+02]]
Train Epoch4 Acc 0.002325 (279/120000), AUC 0.06044991686940193
Test Epoch4 layer0 Acc 0.9114473684210527, AUC 0.9795840382575989
Test Epoch4 layer1 Acc 0.9094736842105263, AUC 0.9804688692092896
Test Epoch4 layer2 Acc 0.9082894736842105, AUC 0.9805194139480591
Test Epoch4 layer3 Acc 0.016578947368421054, AUC 0.042788296937942505
Test Epoch4 layer4 Acc 0.009473684210526316, AUC 0.09513445943593979
gc 0
[[3.19626248e+02 1.72075350e+01]
 [5.90580962e-05 9.81308054e+00]
 [1.40538242e-05 8.85903211e+00]
 [2.88865406e+02 1.55346654e+02]
 [2.29878906e+02 1.09075684e+02]]
Train Epoch5 Acc 0.0018666666666666666 (224/120000), AUC 0.06928937882184982
Test Epoch5 layer0 Acc 0.9122368421052631, AUC 0.9795836806297302
Test Epoch5 layer1 Acc 0.9072368421052631, AUC 0.9803646802902222
Test Epoch5 layer2 Acc 0.9069736842105263, AUC 0.9805796146392822
Test Epoch5 layer3 Acc 0.016052631578947367, AUC 0.04475179687142372
Test Epoch5 layer4 Acc 0.008947368421052631, AUC 0.10004440695047379
gc 0
[[3.19626248e+02 1.71192633e+01]
 [1.24532679e-06 9.29784769e+00]
 [3.05661072e-07 8.36836312e+00]
 [2.88827133e+02 1.55033953e+02]
 [2.29863353e+02 1.09010168e+02]]
Train Epoch6 Acc 0.0017583333333333333 (211/120000), AUC 0.07535858452320099
Test Epoch6 layer0 Acc 0.9101315789473684, AUC 0.9795182943344116
Test Epoch6 layer1 Acc 0.9064473684210527, AUC 0.9800209403038025
Test Epoch6 layer2 Acc 0.9061842105263158, AUC 0.9800537824630737
Test Epoch6 layer3 Acc 0.016710526315789474, AUC 0.046232812106609344
Test Epoch6 layer4 Acc 0.009473684210526316, AUC 0.1060502901673317
gc 0
[[3.19626248e+02 1.70623760e+01]
 [1.17449474e-05 9.07965216e+00]
 [2.99998143e-06 8.16909675e+00]
 [2.88827625e+02 1.54838732e+02]
 [2.29865627e+02 1.09011145e+02]]
Train Epoch7 Acc 0.001825 (219/120000), AUC 0.07877465337514877
Test Epoch7 layer0 Acc 0.9103947368421053, AUC 0.9791791439056396
Test Epoch7 layer1 Acc 0.9023684210526316, AUC 0.9784270524978638
Test Epoch7 layer2 Acc 0.9027631578947368, AUC 0.9788011312484741
Test Epoch7 layer3 Acc 0.01881578947368421, AUC 0.04631928354501724
Test Epoch7 layer4 Acc 0.010789473684210526, AUC 0.11589410156011581
gc 0
[[3.19626248e+02 1.70181504e+01]
 [1.69496985e-05 8.88655851e+00]
 [4.65323482e-06 7.99657222e+00]
 [2.88800936e+02 1.54609958e+02]
 [2.29851688e+02 1.08943693e+02]]
Train Epoch8 Acc 0.0016666666666666668 (200/120000), AUC 0.0829450786113739
Test Epoch8 layer0 Acc 0.9103947368421053, AUC 0.9791641235351562
Test Epoch8 layer1 Acc 0.9025, AUC 0.9789963960647583
Test Epoch8 layer2 Acc 0.9025, AUC 0.9786455631256104
Test Epoch8 layer3 Acc 0.018421052631578946, AUC 0.04698702692985535
Test Epoch8 layer4 Acc 0.009473684210526316, AUC 0.11377110332250595
gc 0
[[3.19626248e+02 1.65048506e+01]
 [1.48929408e-05 8.31609302e+00]
 [4.96823634e-06 7.46851855e+00]
 [2.88776770e+02 1.54524998e+02]
 [2.29842985e+02 1.08880125e+02]]
Train Epoch9 Acc 0.001625 (195/120000), AUC 0.08338497579097748
Test Epoch9 layer0 Acc 0.9106578947368421, AUC 0.978893518447876
Test Epoch9 layer1 Acc 0.9035526315789474, AUC 0.9784987568855286
Test Epoch9 layer2 Acc 0.9034210526315789, AUC 0.978270947933197
Test Epoch9 layer3 Acc 0.01868421052631579, AUC 0.04896720126271248
Test Epoch9 layer4 Acc 0.008947368421052631, AUC 0.11228899657726288
Best AUC 0.9827905297279358
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//ag_news/ag_news_lstmal_l5_m3_prefix.pt
[[1706   56   91   47]
 [  19 1855   11   15]
 [  49   19 1660  172]
 [  49   16  112 1723]]
Figure(640x480)
[[1722   52   72   54]
 [  23 1846   17   14]
 [  54   17 1655  174]
 [  54   12  115 1719]]
Figure(640x480)
[[1718   55   71   56]
 [  25 1843   17   15]
 [  55   16 1646  183]
 [  55   13  110 1722]]
Figure(640x480)
[[  76 1823    0    1]
 [1860   40    0    0]
 [ 903  997    0    0]
 [  41 1859    0    0]]
Figure(640x480)
[[   0 1842   55    3]
 [   0   51 1845    4]
 [   0 1885   12    3]
 [   0 1885   14    1]]
Figure(640x480)
