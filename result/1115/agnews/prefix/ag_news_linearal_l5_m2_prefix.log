total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask1//ag_news/ag_news_linearal_l5_m1_prefix.pt
Start Training
gc 9
[[319.62857518  17.36660044]
 [ 19.31444187  26.91663641]
 [259.27530894 143.6916733 ]
 [198.77718432 132.43300819]
 [196.81662913 121.56627072]]
Train Epoch0 Acc 0.287375 (34485/120000), AUC 0.6665764451026917
Test Epoch0 layer0 Acc 0.915, AUC 0.9812489151954651
Save ckpt to ./ckpt/mask2//ag_news/ag_news_linearal_l5_m2_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9136842105263158, AUC 0.9809887409210205
Test Epoch0 layer2 Acc 0.38421052631578945, AUC 0.7494601011276245
Test Epoch0 layer3 Acc 0.3061842105263158, AUC 0.5121062994003296
Test Epoch0 layer4 Acc 0.2881578947368421, AUC 0.716202974319458
gc 0
[[3.19626263e+02 1.90663714e+01]
 [3.71001287e-05 1.79695281e+01]
 [2.92193982e+02 1.60694542e+02]
 [2.18089223e+02 1.44487980e+02]
 [2.13161950e+02 1.30240760e+02]]
Train Epoch1 Acc 0.28196666666666664 (33836/120000), AUC 0.728773832321167
Test Epoch1 layer0 Acc 0.9121052631578948, AUC 0.9807647466659546
Test Epoch1 layer1 Acc 0.9127631578947368, AUC 0.9807180166244507
Test Epoch1 layer2 Acc 0.3678947368421053, AUC 0.756189227104187
Test Epoch1 layer3 Acc 0.29894736842105263, AUC 0.5091397762298584
Test Epoch1 layer4 Acc 0.28157894736842104, AUC 0.7235280275344849
gc 0
[[3.19626248e+02 1.95927891e+01]
 [5.04942568e-06 1.77343455e+01]
 [2.99690451e+02 1.64566569e+02]
 [2.22301275e+02 1.45944255e+02]
 [2.16516825e+02 1.31784321e+02]]
Train Epoch2 Acc 0.27598333333333336 (33118/120000), AUC 0.7361592650413513
Test Epoch2 layer0 Acc 0.9134210526315789, AUC 0.9803536534309387
Test Epoch2 layer1 Acc 0.9128947368421053, AUC 0.9804597496986389
Test Epoch2 layer2 Acc 0.3609210526315789, AUC 0.7566337585449219
Test Epoch2 layer3 Acc 0.2925, AUC 0.5022898316383362
Test Epoch2 layer4 Acc 0.27671052631578946, AUC 0.7317075729370117
gc 0
[[3.19626248e+02 1.95323007e+01]
 [6.82785563e-08 1.73207053e+01]
 [3.04285238e+02 1.67335630e+02]
 [2.24522948e+02 1.47021967e+02]
 [2.18306565e+02 1.32983503e+02]]
Train Epoch3 Acc 0.2720416666666667 (32645/120000), AUC 0.7419097423553467
Test Epoch3 layer0 Acc 0.9134210526315789, AUC 0.9803212881088257
Test Epoch3 layer1 Acc 0.9134210526315789, AUC 0.9804025888442993
Test Epoch3 layer2 Acc 0.3518421052631579, AUC 0.7561200261116028
Test Epoch3 layer3 Acc 0.28592105263157896, AUC 0.49842289090156555
Test Epoch3 layer4 Acc 0.2725, AUC 0.7359211444854736
gc 0
[[3.19626248e+02 1.92847312e+01]
 [1.25063463e-12 1.69200851e+01]
 [3.04293125e+02 1.68384173e+02]
 [2.24527122e+02 1.47002555e+02]
 [2.18306765e+02 1.33437858e+02]]
Train Epoch4 Acc 0.2694 (32328/120000), AUC 0.7444661259651184
Test Epoch4 layer0 Acc 0.9119736842105263, AUC 0.9802379608154297
Test Epoch4 layer1 Acc 0.9119736842105263, AUC 0.9801503419876099
Test Epoch4 layer2 Acc 0.3535526315789474, AUC 0.7583953738212585
Test Epoch4 layer3 Acc 0.2823684210526316, AUC 0.4902566075325012
Test Epoch4 layer4 Acc 0.27013157894736844, AUC 0.7379215359687805
gc 0
[[3.19626248e+02 1.82415854e+01]
 [1.14340594e-12 1.59367395e+01]
 [3.04287822e+02 1.69325450e+02]
 [2.24523624e+02 1.47130109e+02]
 [2.18306169e+02 1.33888771e+02]]
Train Epoch5 Acc 0.26814166666666667 (32177/120000), AUC 0.7458508014678955
Test Epoch5 layer0 Acc 0.9118421052631579, AUC 0.9796749353408813
Test Epoch5 layer1 Acc 0.9122368421052631, AUC 0.9797667860984802
Test Epoch5 layer2 Acc 0.35118421052631577, AUC 0.7558209300041199
Test Epoch5 layer3 Acc 0.27789473684210525, AUC 0.48715853691101074
Test Epoch5 layer4 Acc 0.26921052631578946, AUC 0.7372284531593323
gc 0
[[3.19626248e+02 1.81242701e+01]
 [1.41010642e-12 1.57820741e+01]
 [3.04287441e+02 1.69667420e+02]
 [2.24524206e+02 1.47054839e+02]
 [2.18307137e+02 1.34028121e+02]]
Train Epoch6 Acc 0.26726666666666665 (32072/120000), AUC 0.7450467348098755
Test Epoch6 layer0 Acc 0.910921052631579, AUC 0.9796306490898132
Test Epoch6 layer1 Acc 0.9113157894736842, AUC 0.979600727558136
Test Epoch6 layer2 Acc 0.3488157894736842, AUC 0.7571218013763428
Test Epoch6 layer3 Acc 0.27578947368421053, AUC 0.4828852117061615
Test Epoch6 layer4 Acc 0.26842105263157895, AUC 0.7356074452400208
gc 0
[[3.19626248e+02 1.80510409e+01]
 [1.86693447e-12 1.56637017e+01]
 [3.04290041e+02 1.70137317e+02]
 [2.24525565e+02 1.47100358e+02]
 [2.18308328e+02 1.34254735e+02]]
Train Epoch7 Acc 0.2664666666666667 (31976/120000), AUC 0.7440874576568604
Test Epoch7 layer0 Acc 0.9097368421052632, AUC 0.9793887138366699
Test Epoch7 layer1 Acc 0.9102631578947369, AUC 0.9794802665710449
Test Epoch7 layer2 Acc 0.3451315789473684, AUC 0.7585598230361938
Test Epoch7 layer3 Acc 0.27578947368421053, AUC 0.47718164324760437
Test Epoch7 layer4 Acc 0.26842105263157895, AUC 0.7341002225875854
gc 0
[[3.19626248e+02 1.79935372e+01]
 [2.78617806e-12 1.55650353e+01]
 [3.04285739e+02 1.70703219e+02]
 [2.24522657e+02 1.47273332e+02]
 [2.18305833e+02 1.34624644e+02]]
Train Epoch8 Acc 0.2659416666666667 (31913/120000), AUC 0.74294114112854
Test Epoch8 layer0 Acc 0.9106578947368421, AUC 0.9792559146881104
Test Epoch8 layer1 Acc 0.9107894736842105, AUC 0.9793111085891724
Test Epoch8 layer2 Acc 0.3447368421052632, AUC 0.7610958814620972
Test Epoch8 layer3 Acc 0.27289473684210525, AUC 0.4709419906139374
Test Epoch8 layer4 Acc 0.2686842105263158, AUC 0.7335101366043091
gc 0
[[3.19626248e+02 1.74366862e+01]
 [2.34431708e-12 1.50593142e+01]
 [3.04289987e+02 1.71091071e+02]
 [2.24525888e+02 1.47382248e+02]
 [2.18305999e+02 1.34848281e+02]]
Train Epoch9 Acc 0.265025 (31803/120000), AUC 0.7420403361320496
Test Epoch9 layer0 Acc 0.9090789473684211, AUC 0.9788607358932495
Test Epoch9 layer1 Acc 0.9093421052631578, AUC 0.979116678237915
Test Epoch9 layer2 Acc 0.3451315789473684, AUC 0.7593125700950623
Test Epoch9 layer3 Acc 0.2732894736842105, AUC 0.46866726875305176
Test Epoch9 layer4 Acc 0.26763157894736844, AUC 0.732595682144165
Best AUC 0.9812489151954651
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//ag_news/ag_news_linearal_l5_m2_prefix.pt
[[1698   60   92   50]
 [  12 1860   10   18]
 [  39   19 1673  169]
 [  38   15  124 1723]]
Figure(640x480)
[[1696   59   90   55]
 [  13 1862   10   15]
 [  39   18 1670  173]
 [  39   18  127 1716]]
Figure(640x480)
[[1458  266   15  161]
 [1662  149    0   89]
 [ 813  190  286  611]
 [ 674   41  158 1027]]
Figure(640x480)
[[1354    0   45  501]
 [ 568    0    3 1329]
 [1178    3  233  486]
 [1085    0   75  740]]
Figure(640x480)
[[ 317    0 1582    1]
 [ 892    0  991   17]
 [  27    0 1873    0]
 [  27    0 1873    0]]
Figure(640x480)
