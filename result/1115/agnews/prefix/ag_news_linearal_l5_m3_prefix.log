total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask2//ag_news/ag_news_linearal_l5_m2_prefix.pt
Start Training
gc 9
[[3.19626249e+02 1.99206941e+01]
 [1.23132515e-04 1.85031746e+01]
 [2.00615209e+01 2.31137907e+01]
 [2.99336079e+02 1.97984105e+02]
 [2.53210049e+02 1.62174623e+02]]
Train Epoch0 Acc 0.2747833333333333 (32974/120000), AUC 0.7947512865066528
Test Epoch0 layer0 Acc 0.9117105263157895, AUC 0.9805223941802979
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9122368421052631, AUC 0.9805518984794617
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9118421052631579, AUC 0.980329155921936
Test Epoch0 layer3 Acc 0.23526315789473684, AUC 0.6320184469223022
Test Epoch0 layer4 Acc 0.2668421052631579, AUC 0.7727925181388855
gc 0
[[3.19626248e+02 1.95793414e+01]
 [6.75648691e-05 1.76074640e+01]
 [1.62586822e-05 1.70116538e+01]
 [3.19529396e+02 2.13426156e+02]
 [2.64768353e+02 1.75078684e+02]]
Train Epoch1 Acc 0.2609666666666667 (31316/120000), AUC 0.7655521631240845
Test Epoch1 layer0 Acc 0.9134210526315789, AUC 0.9803920388221741
Test Epoch1 layer1 Acc 0.9140789473684211, AUC 0.9802977442741394
Test Epoch1 layer2 Acc 0.9139473684210526, AUC 0.980366051197052
Test Epoch1 layer3 Acc 0.22289473684210526, AUC 0.6032896041870117
Test Epoch1 layer4 Acc 0.2611842105263158, AUC 0.740654468536377
gc 0
[[3.19626248e+02 1.92883525e+01]
 [6.23465574e-05 1.70988738e+01]
 [1.41542022e-05 1.60724759e+01]
 [3.19452826e+02 2.23040234e+02]
 [2.64726859e+02 1.83174957e+02]]
Train Epoch2 Acc 0.2597 (31164/120000), AUC 0.7303266525268555
Test Epoch2 layer0 Acc 0.9125, AUC 0.9804955720901489
Test Epoch2 layer1 Acc 0.9125, AUC 0.9804098606109619
Test Epoch2 layer2 Acc 0.9127631578947368, AUC 0.9806240200996399
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3_prefix.pt  ,ep 2
Test Epoch2 layer3 Acc 0.20934210526315788, AUC 0.55443274974823
Test Epoch2 layer4 Acc 0.26223684210526316, AUC 0.7081593871116638
gc 0
[[3.19626248e+02 1.91018619e+01]
 [6.49271349e-05 1.67679866e+01]
 [1.54373948e-05 1.53077808e+01]
 [3.19362694e+02 2.34780716e+02]
 [2.64676167e+02 1.91491866e+02]]
Train Epoch3 Acc 0.26334166666666664 (31601/120000), AUC 0.7008557319641113
Test Epoch3 layer0 Acc 0.9110526315789473, AUC 0.9800145626068115
Test Epoch3 layer1 Acc 0.9113157894736842, AUC 0.9800297021865845
Test Epoch3 layer2 Acc 0.9119736842105263, AUC 0.9804530143737793
Test Epoch3 layer3 Acc 0.18618421052631579, AUC 0.5133443474769592
Test Epoch3 layer4 Acc 0.2727631578947368, AUC 0.6849014759063721
gc 0
[[3.19626248e+02 1.89164409e+01]
 [5.84149970e-05 1.64833801e+01]
 [1.39860577e-05 1.45283559e+01]
 [3.19273562e+02 2.47783302e+02]
 [2.64626985e+02 2.00632350e+02]]
Train Epoch4 Acc 0.281275 (33753/120000), AUC 0.6738339066505432
Test Epoch4 layer0 Acc 0.91, AUC 0.9797791838645935
Test Epoch4 layer1 Acc 0.9105263157894737, AUC 0.9797979593276978
Test Epoch4 layer2 Acc 0.9103947368421053, AUC 0.9802149534225464
Test Epoch4 layer3 Acc 0.14723684210526317, AUC 0.4633355140686035
Test Epoch4 layer4 Acc 0.3013157894736842, AUC 0.6561868190765381
gc 0
[[3.19626248e+02 1.79287127e+01]
 [5.77851097e-07 1.55705244e+01]
 [1.72785790e-07 1.32217829e+01]
 [3.19232484e+02 2.60948153e+02]
 [2.64604515e+02 2.10359917e+02]]
Train Epoch5 Acc 0.3349666666666667 (40196/120000), AUC 0.6537202596664429
Test Epoch5 layer0 Acc 0.910921052631579, AUC 0.9797692894935608
Test Epoch5 layer1 Acc 0.9107894736842105, AUC 0.979913055896759
Test Epoch5 layer2 Acc 0.9117105263157895, AUC 0.9803832769393921
Test Epoch5 layer3 Acc 0.11644736842105263, AUC 0.43196186423301697
Test Epoch5 layer4 Acc 0.3575, AUC 0.6549322009086609
gc 0
[[3.19626248e+02 1.78211571e+01]
 [8.71583481e-06 1.54366466e+01]
 [2.53428802e-06 1.26390762e+01]
 [3.19229216e+02 2.72889338e+02]
 [2.64603072e+02 2.19528255e+02]]
Train Epoch6 Acc 0.40570833333333334 (48685/120000), AUC 0.6637204885482788
Test Epoch6 layer0 Acc 0.9098684210526315, AUC 0.9794966578483582
Test Epoch6 layer1 Acc 0.9102631578947369, AUC 0.9797446727752686
Test Epoch6 layer2 Acc 0.9113157894736842, AUC 0.9803857803344727
Test Epoch6 layer3 Acc 0.09789473684210526, AUC 0.41493383049964905
Test Epoch6 layer4 Acc 0.4139473684210526, AUC 0.6704092621803284
gc 0
[[3.19626248e+02 1.77771297e+01]
 [1.87954406e-05 1.53469014e+01]
 [4.75807523e-06 1.22149185e+01]
 [3.19205440e+02 2.81849054e+02]
 [2.64590735e+02 2.26813308e+02]]
Train Epoch7 Acc 0.4407916666666667 (52895/120000), AUC 0.6823729276657104
Test Epoch7 layer0 Acc 0.9101315789473684, AUC 0.9793856143951416
Test Epoch7 layer1 Acc 0.9114473684210527, AUC 0.9794632196426392
Test Epoch7 layer2 Acc 0.910921052631579, AUC 0.9801516532897949
Test Epoch7 layer3 Acc 0.08802631578947369, AUC 0.41830259561538696
Test Epoch7 layer4 Acc 0.4292105263157895, AUC 0.6800366640090942
gc 0
[[3.19626248e+02 1.77116418e+01]
 [2.03740852e-05 1.52450082e+01]
 [6.02820972e-06 1.19127834e+01]
 [3.19179866e+02 2.88367305e+02]
 [2.64577087e+02 2.32148226e+02]]
Train Epoch8 Acc 0.452525 (54303/120000), AUC 0.6942930221557617
Test Epoch8 layer0 Acc 0.9102631578947369, AUC 0.9791011214256287
Test Epoch8 layer1 Acc 0.9102631578947369, AUC 0.9792174100875854
Test Epoch8 layer2 Acc 0.9105263157894737, AUC 0.9795795679092407
Test Epoch8 layer3 Acc 0.08328947368421052, AUC 0.4208129644393921
Test Epoch8 layer4 Acc 0.43565789473684213, AUC 0.6919705271720886
gc 0
[[3.19626248e+02 1.71797147e+01]
 [1.15539459e-08 1.47661278e+01]
 [8.55514564e-09 1.13153639e+01]
 [3.19171323e+02 2.94958853e+02]
 [2.64571999e+02 2.37633048e+02]]
Train Epoch9 Acc 0.46126666666666666 (55352/120000), AUC 0.7061184644699097
Test Epoch9 layer0 Acc 0.9093421052631578, AUC 0.9789801239967346
Test Epoch9 layer1 Acc 0.9101315789473684, AUC 0.9792231917381287
Test Epoch9 layer2 Acc 0.911578947368421, AUC 0.9795593023300171
Test Epoch9 layer3 Acc 0.08144736842105263, AUC 0.4205583333969116
Test Epoch9 layer4 Acc 0.44394736842105265, AUC 0.7001935243606567
Best AUC 0.9806240200996399
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3_prefix.pt
[[1703   56   96   45]
 [  15 1857   17   11]
 [  41   18 1691  150]
 [  50   16  150 1684]]
Figure(640x480)
[[1706   55   95   44]
 [  15 1855   18   12]
 [  41   17 1689  153]
 [  49   16  150 1685]]
Figure(640x480)
[[1707   56   92   45]
 [  16 1854   18   12]
 [  41   18 1684  157]
 [  49   17  142 1692]]
Figure(640x480)
[[1400    0  493    7]
 [1869    0   15   16]
 [1620    0  171  109]
 [ 225    0 1655   20]]
Figure(640x480)
[[  97    0 1802    1]
 [ 504    0 1396    0]
 [   4    0 1896    0]
 [   6    0 1894    0]]
Figure(640x480)
