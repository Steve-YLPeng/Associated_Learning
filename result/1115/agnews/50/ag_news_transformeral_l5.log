total count words 102019
vocab size 30000
found 26754 words in glove
Start Training
gc 0
[[703.76629046  26.00552655]
 [  1.71155728  42.52477638]
 [  1.77159288  42.29017565]
 [  1.61799084  45.42077631]
 [  1.57292016  43.89864574]]
Train Epoch0 Acc 0.6951666666666667 (83420/120000), AUC 0.9003089070320129
Test Epoch0 layer0 Acc 0.9118421052631579, AUC 0.9807735085487366
Save ckpt to ./ckpt//ag_news/ag_news_transformeral_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9142105263157895, AUC 0.9802307486534119
Test Epoch0 layer2 Acc 0.9146052631578947, AUC 0.9804989099502563
Test Epoch0 layer3 Acc 0.9114473684210527, AUC 0.9806468486785889
Test Epoch0 layer4 Acc 0.9073684210526316, AUC 0.9807071685791016
gc 0
[[6.39374846e+02 2.57552398e+01]
 [1.42172094e-05 2.63341945e+01]
 [3.31511602e-05 2.37400227e+01]
 [7.50320070e-05 2.23175538e+01]
 [2.58741322e-04 2.03960096e+01]]
Train Epoch1 Acc 0.9294833333333333 (111538/120000), AUC 0.9840835332870483
Test Epoch1 layer0 Acc 0.9151315789473684, AUC 0.9812048673629761
Save ckpt to ./ckpt//ag_news/ag_news_transformeral_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9175, AUC 0.9811656475067139
Test Epoch1 layer2 Acc 0.9189473684210526, AUC 0.9806853532791138
Test Epoch1 layer3 Acc 0.9196052631578947, AUC 0.9789782762527466
Test Epoch1 layer4 Acc 0.9197368421052632, AUC 0.9802854061126709
gc 0
[[6.39020615e+02 2.72921420e+01]
 [1.51028803e-03 2.15726895e+01]
 [4.35302567e-03 1.92709686e+01]
 [9.85806362e-03 1.81315078e+01]
 [1.80890127e-02 1.60786368e+01]]
Train Epoch2 Acc 0.9416 (112992/120000), AUC 0.9878222346305847
Test Epoch2 layer0 Acc 0.9144736842105263, AUC 0.9815583825111389
Save ckpt to ./ckpt//ag_news/ag_news_transformeral_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.9177631578947368, AUC 0.9812130928039551
Test Epoch2 layer2 Acc 0.9171052631578948, AUC 0.9819402098655701
Save ckpt to ./ckpt//ag_news/ag_news_transformeral_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.9173684210526316, AUC 0.9815663695335388
Test Epoch2 layer4 Acc 0.9175, AUC 0.9815824031829834
gc 0
[[6.38945673e+02 2.88453526e+01]
 [3.26434255e-03 1.93638867e+01]
 [7.18868726e-03 1.75005262e+01]
 [1.20590316e-02 1.59820190e+01]
 [1.71639443e-02 1.38129578e+01]]
Train Epoch3 Acc 0.9483833333333334 (113806/120000), AUC 0.9894694685935974
Test Epoch3 layer0 Acc 0.9127631578947368, AUC 0.9811385273933411
Test Epoch3 layer1 Acc 0.9169736842105263, AUC 0.9812796115875244
Test Epoch3 layer2 Acc 0.9173684210526316, AUC 0.9826245903968811
Save ckpt to ./ckpt//ag_news/ag_news_transformeral_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.9167105263157894, AUC 0.9819709062576294
Test Epoch3 layer4 Acc 0.9172368421052631, AUC 0.9822503328323364
gc 0
[[6.38923376e+02 3.04333456e+01]
 [3.67968804e-03 1.81372679e+01]
 [7.97291443e-03 1.58704157e+01]
 [1.22313214e-02 1.37525724e+01]
 [1.62583439e-02 1.13414281e+01]]
Train Epoch4 Acc 0.95195 (114234/120000), AUC 0.9910049438476562
Test Epoch4 layer0 Acc 0.9130263157894737, AUC 0.9812257289886475
Test Epoch4 layer1 Acc 0.9126315789473685, AUC 0.9774049520492554
Test Epoch4 layer2 Acc 0.9105263157894737, AUC 0.9782851934432983
Test Epoch4 layer3 Acc 0.9102631578947369, AUC 0.9790273904800415
Test Epoch4 layer4 Acc 0.9101315789473684, AUC 0.9753405451774597
gc 0
[[6.38915933e+02 3.19962264e+01]
 [3.61695427e-03 1.70389249e+01]
 [7.48170347e-03 1.41422054e+01]
 [1.06442416e-02 1.18722360e+01]
 [1.30547567e-02 9.00410247e+00]]
Train Epoch5 Acc 0.9556416666666666 (114677/120000), AUC 0.9920523762702942
Test Epoch5 layer0 Acc 0.9140789473684211, AUC 0.9811835289001465
Test Epoch5 layer1 Acc 0.9157894736842105, AUC 0.9782682657241821
Test Epoch5 layer2 Acc 0.9152631578947369, AUC 0.9793869853019714
Test Epoch5 layer3 Acc 0.9140789473684211, AUC 0.9793179631233215
Test Epoch5 layer4 Acc 0.9146052631578947, AUC 0.9782896041870117
gc 0
[[6.38913233e+02 3.35455549e+01]
 [4.23384786e-03 1.61719879e+01]
 [8.38148243e-03 1.28345386e+01]
 [1.11340725e-02 1.03629587e+01]
 [1.30024972e-02 7.30372670e+00]]
Train Epoch6 Acc 0.959075 (115089/120000), AUC 0.9925110340118408
Test Epoch6 layer0 Acc 0.9123684210526316, AUC 0.9807544350624084
Test Epoch6 layer1 Acc 0.9143421052631578, AUC 0.978639543056488
Test Epoch6 layer2 Acc 0.9131578947368421, AUC 0.9806663990020752
Test Epoch6 layer3 Acc 0.9131578947368421, AUC 0.9810905456542969
Test Epoch6 layer4 Acc 0.9142105263157895, AUC 0.9807405471801758
gc 0
[[6.38912457e+02 3.50142047e+01]
 [4.47182341e-03 1.54439445e+01]
 [8.61429854e-03 1.18340678e+01]
 [1.10213939e-02 9.07256785e+00]
 [1.19651920e-02 6.00086413e+00]]
Train Epoch7 Acc 0.9615666666666667 (115388/120000), AUC 0.9930790066719055
Test Epoch7 layer0 Acc 0.9119736842105263, AUC 0.9808168411254883
Test Epoch7 layer1 Acc 0.9130263157894737, AUC 0.9781031608581543
Test Epoch7 layer2 Acc 0.9134210526315789, AUC 0.9776890277862549
Test Epoch7 layer3 Acc 0.9131578947368421, AUC 0.9763420820236206
Test Epoch7 layer4 Acc 0.9128947368421053, AUC 0.9749963879585266
gc 0
[[6.38911970e+02 3.64622366e+01]
 [3.48208516e-03 1.47547024e+01]
 [5.98252715e-03 1.08800287e+01]
 [6.96312036e-03 7.87320902e+00]
 [7.30182772e-03 4.90572011e+00]]
Train Epoch8 Acc 0.9642416666666667 (115709/120000), AUC 0.9936412572860718
Test Epoch8 layer0 Acc 0.9132894736842105, AUC 0.9804404973983765
Test Epoch8 layer1 Acc 0.9132894736842105, AUC 0.9763770699501038
Test Epoch8 layer2 Acc 0.9121052631578948, AUC 0.9770550727844238
Test Epoch8 layer3 Acc 0.9117105263157895, AUC 0.97407066822052
Test Epoch8 layer4 Acc 0.910921052631579, AUC 0.9722186923027039
gc 0
[[6.38911743e+02 3.78116012e+01]
 [4.48830314e-03 1.41165720e+01]
 [8.39209340e-03 9.98168166e+00]
 [1.01179431e-02 6.80876805e+00]
 [1.05328773e-02 4.01698733e+00]]
Train Epoch9 Acc 0.9663916666666666 (115967/120000), AUC 0.9937276840209961
Test Epoch9 layer0 Acc 0.9121052631578948, AUC 0.980131983757019
Test Epoch9 layer1 Acc 0.9110526315789473, AUC 0.9755703210830688
Test Epoch9 layer2 Acc 0.9101315789473684, AUC 0.9744622111320496
Test Epoch9 layer3 Acc 0.9094736842105263, AUC 0.9727058410644531
Test Epoch9 layer4 Acc 0.9098684210526315, AUC 0.9689615964889526
gc 0
[[6.38911743e+02 3.85398051e+01]
 [3.46482541e-03 1.33231629e+01]
 [5.79191409e-03 9.07197929e+00]
 [6.56863891e-03 5.88611217e+00]
 [6.25242648e-03 3.33615932e+00]]
Train Epoch10 Acc 0.9684083333333333 (116209/120000), AUC 0.994348406791687
Test Epoch10 layer0 Acc 0.9117105263157895, AUC 0.9795701503753662
Test Epoch10 layer1 Acc 0.9126315789473685, AUC 0.9751776456832886
Test Epoch10 layer2 Acc 0.9127631578947368, AUC 0.9749346375465393
Test Epoch10 layer3 Acc 0.9126315789473685, AUC 0.9724287986755371
Test Epoch10 layer4 Acc 0.9126315789473685, AUC 0.9673616290092468
gc 0
[[6.38911743e+02 3.83813376e+01]
 [4.11907539e-03 1.24899577e+01]
 [6.70792665e-03 8.17809353e+00]
 [7.02425037e-03 5.09050852e+00]
 [6.38734734e-03 2.79086322e+00]]
Train Epoch11 Acc 0.9711333333333333 (116536/120000), AUC 0.9946792125701904
Test Epoch11 layer0 Acc 0.910921052631579, AUC 0.9795193672180176
Test Epoch11 layer1 Acc 0.9122368421052631, AUC 0.9739218950271606
Test Epoch11 layer2 Acc 0.9086842105263158, AUC 0.9723773002624512
Test Epoch11 layer3 Acc 0.9086842105263158, AUC 0.9672531485557556
Test Epoch11 layer4 Acc 0.9086842105263158, AUC 0.9633820652961731
gc 0
[[6.38911743e+02 3.81657061e+01]
 [3.45325764e-03 1.16611882e+01]
 [5.77992330e-03 7.33076930e+00]
 [6.27431629e-03 4.38809635e+00]
 [5.78882770e-03 2.32964160e+00]]
Train Epoch12 Acc 0.9730583333333334 (116767/120000), AUC 0.994858980178833
Test Epoch12 layer0 Acc 0.9106578947368421, AUC 0.979781448841095
Test Epoch12 layer1 Acc 0.9102631578947369, AUC 0.973907470703125
Test Epoch12 layer2 Acc 0.9085526315789474, AUC 0.9710366725921631
Test Epoch12 layer3 Acc 0.9072368421052631, AUC 0.9684230089187622
Test Epoch12 layer4 Acc 0.9069736842105263, AUC 0.9626085162162781
gc 0
[[6.38911743e+02 3.79566883e+01]
 [4.13579278e-03 1.08445986e+01]
 [6.53501202e-03 6.52581304e+00]
 [6.52211396e-03 3.76281678e+00]
 [5.64197651e-03 1.94338289e+00]]
Train Epoch13 Acc 0.9746916666666666 (116963/120000), AUC 0.9950449466705322
Test Epoch13 layer0 Acc 0.9103947368421053, AUC 0.9793500900268555
Test Epoch13 layer1 Acc 0.9102631578947369, AUC 0.9731773138046265
Test Epoch13 layer2 Acc 0.9085526315789474, AUC 0.9741926193237305
Test Epoch13 layer3 Acc 0.9084210526315789, AUC 0.9720726013183594
Test Epoch13 layer4 Acc 0.9084210526315789, AUC 0.9647620916366577
gc 0
[[6.38911743e+02 3.77795392e+01]
 [3.04301112e-03 1.01389289e+01]
 [4.89142508e-03 5.80521892e+00]
 [5.26631086e-03 3.23776425e+00]
 [4.68114383e-03 1.63151890e+00]]
Train Epoch14 Acc 0.9766 (117192/120000), AUC 0.995720386505127
Test Epoch14 layer0 Acc 0.9096052631578947, AUC 0.9793694615364075
Test Epoch14 layer1 Acc 0.910921052631579, AUC 0.9730163812637329
Test Epoch14 layer2 Acc 0.9077631578947368, AUC 0.9704724550247192
Test Epoch14 layer3 Acc 0.9076315789473685, AUC 0.964489758014679
Test Epoch14 layer4 Acc 0.9077631578947368, AUC 0.9605712890625
gc 0
[[6.38911743e+02 3.76140005e+01]
 [3.15456999e-03 9.46005952e+00]
 [4.50558620e-03 5.20081308e+00]
 [4.32335189e-03 2.82564160e+00]
 [3.45614684e-03 1.39456918e+00]]
Train Epoch15 Acc 0.9780833333333333 (117370/120000), AUC 0.9959119558334351
Test Epoch15 layer0 Acc 0.9111842105263158, AUC 0.9795101881027222
Test Epoch15 layer1 Acc 0.9080263157894737, AUC 0.9731310606002808
Test Epoch15 layer2 Acc 0.9039473684210526, AUC 0.9680383205413818
Test Epoch15 layer3 Acc 0.9021052631578947, AUC 0.9649701118469238
Test Epoch15 layer4 Acc 0.9018421052631579, AUC 0.9606269001960754
gc 0
[[6.38911743e+02 3.74766878e+01]
 [4.19886050e-03 8.83032505e+00]
 [6.45559499e-03 4.60092493e+00]
 [6.59314631e-03 2.41929451e+00]
 [5.86336591e-03 1.16537644e+00]]
Train Epoch16 Acc 0.97985 (117582/120000), AUC 0.9963116645812988
Test Epoch16 layer0 Acc 0.9105263157894737, AUC 0.9796076416969299
Test Epoch16 layer1 Acc 0.9090789473684211, AUC 0.9715071320533752
Test Epoch16 layer2 Acc 0.9069736842105263, AUC 0.9702906012535095
Test Epoch16 layer3 Acc 0.9068421052631579, AUC 0.9643366932868958
Test Epoch16 layer4 Acc 0.906578947368421, AUC 0.95945143699646
gc 0
[[6.38911743e+02 3.73298611e+01]
 [3.12407879e-03 8.34797675e+00]
 [4.70120111e-03 4.21018992e+00]
 [4.61884650e-03 2.17877708e+00]
 [3.84062386e-03 1.04478858e+00]]
Train Epoch17 Acc 0.981 (117720/120000), AUC 0.9965499639511108
Test Epoch17 layer0 Acc 0.9118421052631579, AUC 0.9794480800628662
Test Epoch17 layer1 Acc 0.9101315789473684, AUC 0.9707167148590088
Test Epoch17 layer2 Acc 0.9084210526315789, AUC 0.967438280582428
Test Epoch17 layer3 Acc 0.9082894736842105, AUC 0.9648053646087646
Test Epoch17 layer4 Acc 0.9072368421052631, AUC 0.9600536823272705
gc 0
[[6.38911743e+02 3.72623623e+01]
 [3.35013601e-03 7.96325779e+00]
 [5.23449646e-03 3.85614161e+00]
 [5.64673466e-03 1.96266112e+00]
 [5.75489375e-03 9.21883083e-01]]
Train Epoch18 Acc 0.981775 (117813/120000), AUC 0.9966843128204346
Test Epoch18 layer0 Acc 0.9096052631578947, AUC 0.9792556762695312
Test Epoch18 layer1 Acc 0.9067105263157895, AUC 0.9711641073226929
Test Epoch18 layer2 Acc 0.9042105263157895, AUC 0.9667754173278809
Test Epoch18 layer3 Acc 0.9039473684210526, AUC 0.9639726281166077
Test Epoch18 layer4 Acc 0.9034210526315789, AUC 0.9581564664840698
gc 0
[[6.38911743e+02 3.70881177e+01]
 [3.33742752e-03 7.56515737e+00]
 [4.92474071e-03 3.52394772e+00]
 [5.17124221e-03 1.76906432e+00]
 [4.48050646e-03 8.18161191e-01]]
Train Epoch19 Acc 0.98315 (117978/120000), AUC 0.9967767596244812
Test Epoch19 layer0 Acc 0.9110526315789473, AUC 0.9793643951416016
Test Epoch19 layer1 Acc 0.9082894736842105, AUC 0.9716752171516418
Test Epoch19 layer2 Acc 0.9051315789473684, AUC 0.9660079479217529
Test Epoch19 layer3 Acc 0.905, AUC 0.9623951315879822
Test Epoch19 layer4 Acc 0.9047368421052632, AUC 0.9602729082107544
gc 0
[[6.38911743e+02 3.70238033e+01]
 [2.38636186e-03 7.22619057e+00]
 [2.94527633e-03 3.24874189e+00]
 [2.30534844e-03 1.63086035e+00]
 [1.69864283e-03 7.44013459e-01]]
Train Epoch20 Acc 0.9835166666666667 (118022/120000), AUC 0.9970636963844299
Test Epoch20 layer0 Acc 0.91, AUC 0.979411244392395
Test Epoch20 layer1 Acc 0.9090789473684211, AUC 0.9690910577774048
Test Epoch20 layer2 Acc 0.9044736842105263, AUC 0.9632247686386108
Test Epoch20 layer3 Acc 0.9044736842105263, AUC 0.9589187502861023
Test Epoch20 layer4 Acc 0.904342105263158, AUC 0.9549176096916199
gc 0
[[6.38911743e+02 3.68930465e+01]
 [2.69923564e-03 6.87303094e+00]
 [4.07020146e-03 2.95829935e+00]
 [4.33010810e-03 1.44718519e+00]
 [4.59394593e-03 6.48280856e-01]]
Train Epoch21 Acc 0.984925 (118191/120000), AUC 0.9974130988121033
Test Epoch21 layer0 Acc 0.91, AUC 0.9789652824401855
Test Epoch21 layer1 Acc 0.908157894736842, AUC 0.96990567445755
Test Epoch21 layer2 Acc 0.9047368421052632, AUC 0.9648528695106506
Test Epoch21 layer3 Acc 0.9042105263157895, AUC 0.9610939621925354
Test Epoch21 layer4 Acc 0.9040789473684211, AUC 0.9566701054573059
gc 0
[[6.38911743e+02 3.68021771e+01]
 [2.93482229e-03 6.62507372e+00]
 [4.79751640e-03 2.78352886e+00]
 [5.40355804e-03 1.34695348e+00]
 [5.92952606e-03 6.02672534e-01]]
Train Epoch22 Acc 0.9856583333333333 (118279/120000), AUC 0.9974315166473389
Test Epoch22 layer0 Acc 0.9098684210526315, AUC 0.9787225723266602
Test Epoch22 layer1 Acc 0.9089473684210526, AUC 0.9694650173187256
Test Epoch22 layer2 Acc 0.9061842105263158, AUC 0.9623836278915405
Test Epoch22 layer3 Acc 0.9056578947368421, AUC 0.9586403369903564
Test Epoch22 layer4 Acc 0.9051315789473684, AUC 0.9540241956710815
gc 0
[[6.38911743e+02 3.67274766e+01]
 [2.59781088e-03 6.35315649e+00]
 [4.05783825e-03 2.60592194e+00]
 [4.43026337e-03 1.24698779e+00]
 [4.49449945e-03 5.51406469e-01]]
Train Epoch23 Acc 0.986575 (118389/120000), AUC 0.9976019263267517
Test Epoch23 layer0 Acc 0.9082894736842105, AUC 0.9791132211685181
Test Epoch23 layer1 Acc 0.9073684210526316, AUC 0.9697462916374207
Test Epoch23 layer2 Acc 0.9027631578947368, AUC 0.963509202003479
Test Epoch23 layer3 Acc 0.9026315789473685, AUC 0.9583582878112793
Test Epoch23 layer4 Acc 0.9022368421052631, AUC 0.9548407793045044
gc 0
[[6.38911743e+02 3.66758685e+01]
 [3.29492679e-03 6.13822864e+00]
 [6.39975168e-03 2.44288913e+00]
 [7.78345398e-03 1.15124733e+00]
 [9.19074044e-03 5.08733274e-01]]
Train Epoch24 Acc 0.9872 (118464/120000), AUC 0.9976916909217834
Test Epoch24 layer0 Acc 0.908157894736842, AUC 0.9791200160980225
Test Epoch24 layer1 Acc 0.9072368421052631, AUC 0.969215989112854
Test Epoch24 layer2 Acc 0.901578947368421, AUC 0.9625109434127808
Test Epoch24 layer3 Acc 0.9010526315789473, AUC 0.9587435126304626
Test Epoch24 layer4 Acc 0.9014473684210527, AUC 0.9556058049201965
gc 0
[[6.38911743e+02 3.66127468e+01]
 [2.18427964e-03 5.89189512e+00]
 [3.39164117e-03 2.26442558e+00]
 [4.01216955e-03 1.05254233e+00]
 [4.44130718e-03 4.55405857e-01]]
Train Epoch25 Acc 0.98785 (118542/120000), AUC 0.997800350189209
Test Epoch25 layer0 Acc 0.9090789473684211, AUC 0.9789571166038513
Test Epoch25 layer1 Acc 0.9056578947368421, AUC 0.9691528081893921
Test Epoch25 layer2 Acc 0.9010526315789473, AUC 0.9608070850372314
Test Epoch25 layer3 Acc 0.9006578947368421, AUC 0.9559260010719299
Test Epoch25 layer4 Acc 0.9007894736842105, AUC 0.9541452527046204
gc 0
[[6.38911743e+02 3.65170549e+01]
 [2.74815053e-03 5.72600352e+00]
 [4.20997437e-03 2.18084085e+00]
 [4.38085257e-03 1.01612597e+00]
 [4.49734903e-03 4.43031466e-01]]
Train Epoch26 Acc 0.9884583333333333 (118615/120000), AUC 0.9978761672973633
Test Epoch26 layer0 Acc 0.908157894736842, AUC 0.9794019460678101
Test Epoch26 layer1 Acc 0.9084210526315789, AUC 0.9684476852416992
Test Epoch26 layer2 Acc 0.9048684210526315, AUC 0.963261604309082
Test Epoch26 layer3 Acc 0.9046052631578947, AUC 0.9587017297744751
Test Epoch26 layer4 Acc 0.9044736842105263, AUC 0.9565391540527344
gc 0
[[6.38911743e+02 3.64834717e+01]
 [2.54642625e-03 5.54811105e+00]
 [4.31108936e-03 2.05197612e+00]
 [5.57742767e-03 9.33635434e-01]
 [6.94325248e-03 3.98658510e-01]]
Train Epoch27 Acc 0.9889166666666667 (118670/120000), AUC 0.9980177283287048
Test Epoch27 layer0 Acc 0.9082894736842105, AUC 0.9792284369468689
Test Epoch27 layer1 Acc 0.9076315789473685, AUC 0.9690872430801392
Test Epoch27 layer2 Acc 0.9017105263157895, AUC 0.9600730538368225
Test Epoch27 layer3 Acc 0.900921052631579, AUC 0.9566628336906433
Test Epoch27 layer4 Acc 0.9006578947368421, AUC 0.9548357725143433
gc 0
[[6.38911743e+02 3.63829925e+01]
 [2.98784605e-03 5.33461126e+00]
 [7.87578479e-03 1.91355044e+00]
 [1.20874377e-02 8.46062480e-01]
 [1.59426329e-02 3.88897857e-01]]
Train Epoch28 Acc 0.9895083333333333 (118741/120000), AUC 0.9981092810630798
Test Epoch28 layer0 Acc 0.91, AUC 0.9787931442260742
Test Epoch28 layer1 Acc 0.9072368421052631, AUC 0.9685350060462952
Test Epoch28 layer2 Acc 0.9007894736842105, AUC 0.9593507051467896
Test Epoch28 layer3 Acc 0.9005263157894737, AUC 0.9561938643455505
Test Epoch28 layer4 Acc 0.9006578947368421, AUC 0.9535942077636719
gc 0
[[6.38911743e+02 3.63486468e+01]
 [2.41015358e-03 5.23494664e+00]
 [3.27238062e-03 1.81576775e+00]
 [3.41276823e-03 7.59556347e-01]
 [2.80486191e-03 2.95738020e-01]]
Train Epoch29 Acc 0.9899 (118788/120000), AUC 0.9982305765151978
Test Epoch29 layer0 Acc 0.9092105263157895, AUC 0.9788636565208435
Test Epoch29 layer1 Acc 0.9071052631578947, AUC 0.9684522151947021
Test Epoch29 layer2 Acc 0.9023684210526316, AUC 0.958612322807312
Test Epoch29 layer3 Acc 0.9019736842105263, AUC 0.9557050466537476
Test Epoch29 layer4 Acc 0.9019736842105263, AUC 0.9528871178627014
gc 0
[[6.38911743e+02 3.62808835e+01]
 [1.93644448e-03 5.07976035e+00]
 [3.13005046e-03 1.76383260e+00]
 [4.44689903e-03 7.44022434e-01]
 [3.77946635e-03 2.88141302e-01]]
Train Epoch30 Acc 0.9904583333333333 (118855/120000), AUC 0.9981169104576111
Test Epoch30 layer0 Acc 0.9076315789473685, AUC 0.9784463047981262
Test Epoch30 layer1 Acc 0.9075, AUC 0.9692319631576538
Test Epoch30 layer2 Acc 0.9013157894736842, AUC 0.9614534378051758
Test Epoch30 layer3 Acc 0.901578947368421, AUC 0.957982063293457
Test Epoch30 layer4 Acc 0.901578947368421, AUC 0.953125
gc 0
[[6.38911743e+02 3.62415781e+01]
 [2.41550074e-03 4.92327761e+00]
 [7.80769199e-03 1.69151816e+00]
 [1.31561345e-02 7.39028822e-01]
 [1.87295002e-02 3.49447842e-01]]
Train Epoch31 Acc 0.9906916666666666 (118883/120000), AUC 0.9982975125312805
Test Epoch31 layer0 Acc 0.9080263157894737, AUC 0.9791035652160645
Test Epoch31 layer1 Acc 0.9051315789473684, AUC 0.9662209749221802
Test Epoch31 layer2 Acc 0.8980263157894737, AUC 0.9609665870666504
Test Epoch31 layer3 Acc 0.8977631578947368, AUC 0.9565328359603882
Test Epoch31 layer4 Acc 0.8972368421052631, AUC 0.9547067880630493
gc 0
[[6.38911743e+02 3.62135126e+01]
 [2.33949439e-03 4.81087501e+00]
 [2.19354796e-03 1.60086905e+00]
 [1.69275694e-03 6.51151225e-01]
 [1.16519661e-03 2.41376803e-01]]
Train Epoch32 Acc 0.9909416666666667 (118913/120000), AUC 0.9983883500099182
Test Epoch32 layer0 Acc 0.9096052631578947, AUC 0.9791197180747986
Test Epoch32 layer1 Acc 0.9055263157894737, AUC 0.9693828821182251
Test Epoch32 layer2 Acc 0.9005263157894737, AUC 0.9565064907073975
Test Epoch32 layer3 Acc 0.8996052631578947, AUC 0.9575784206390381
Test Epoch32 layer4 Acc 0.8994736842105263, AUC 0.9581591486930847
gc 0
[[6.38911743e+02 3.61612983e+01]
 [2.53885086e-03 4.70684855e+00]
 [9.19726955e-03 1.61119273e+00]
 [1.87989369e-02 7.15872721e-01]
 [2.25761327e-02 3.23677041e-01]]
Train Epoch33 Acc 0.9915 (118980/120000), AUC 0.9984831809997559
Test Epoch33 layer0 Acc 0.9096052631578947, AUC 0.9787350296974182
Test Epoch33 layer1 Acc 0.9057894736842105, AUC 0.967787504196167
Test Epoch33 layer2 Acc 0.9011842105263158, AUC 0.9632667899131775
Test Epoch33 layer3 Acc 0.9017105263157895, AUC 0.961467981338501
Test Epoch33 layer4 Acc 0.901578947368421, AUC 0.9562902450561523
gc 0
[[6.38911743e+02 3.61124106e+01]
 [1.69300593e-03 4.58710267e+00]
 [1.31962949e-03 1.50307739e+00]
 [8.54568630e-04 6.36220066e-01]
 [5.56652773e-04 2.28407076e-01]]
Train Epoch34 Acc 0.9916166666666667 (118994/120000), AUC 0.9985834360122681
Test Epoch34 layer0 Acc 0.9067105263157895, AUC 0.9785998463630676
Test Epoch34 layer1 Acc 0.9039473684210526, AUC 0.9668148756027222
Test Epoch34 layer2 Acc 0.8955263157894737, AUC 0.956017792224884
Test Epoch34 layer3 Acc 0.8948684210526315, AUC 0.9538702964782715
Test Epoch34 layer4 Acc 0.8947368421052632, AUC 0.951352596282959
gc 0
[[6.38911743e+02 3.60666981e+01]
 [1.99608575e-03 4.52721791e+00]
 [5.67002514e-03 1.46748644e+00]
 [1.22397384e-02 6.20697806e-01]
 [1.80674906e-02 2.64396307e-01]]
Train Epoch35 Acc 0.9921833333333333 (119062/120000), AUC 0.9986385107040405
Test Epoch35 layer0 Acc 0.9082894736842105, AUC 0.9788228869438171
Test Epoch35 layer1 Acc 0.905, AUC 0.9663715958595276
Test Epoch35 layer2 Acc 0.8952631578947369, AUC 0.9573628306388855
Test Epoch35 layer3 Acc 0.8953947368421052, AUC 0.9565670490264893
Test Epoch35 layer4 Acc 0.8952631578947369, AUC 0.9557929635047913
gc 0
[[6.38911743e+02 3.60156906e+01]
 [2.17225198e-03 4.41154999e+00]
 [5.83981691e-03 1.37939599e+00]
 [9.95042701e-03 5.61189879e-01]
 [1.35279308e-02 2.26800034e-01]]
Train Epoch36 Acc 0.9924 (119088/120000), AUC 0.9986964464187622
Test Epoch36 layer0 Acc 0.9078947368421053, AUC 0.9784948825836182
Test Epoch36 layer1 Acc 0.905, AUC 0.9677108526229858
Test Epoch36 layer2 Acc 0.9019736842105263, AUC 0.9577124118804932
Test Epoch36 layer3 Acc 0.9014473684210527, AUC 0.9564530849456787
Test Epoch36 layer4 Acc 0.9013157894736842, AUC 0.9526302814483643
gc 0
[[6.38911743e+02 3.59664768e+01]
 [2.37052920e-03 4.24626031e+00]
 [5.91307888e-03 1.28094394e+00]
 [1.06279594e-02 5.26221273e-01]
 [1.30167197e-02 2.29337031e-01]]
Train Epoch37 Acc 0.9928416666666666 (119141/120000), AUC 0.9987385272979736
Test Epoch37 layer0 Acc 0.9068421052631579, AUC 0.978675127029419
Test Epoch37 layer1 Acc 0.9057894736842105, AUC 0.9672531485557556
Test Epoch37 layer2 Acc 0.9007894736842105, AUC 0.9568647146224976
Test Epoch37 layer3 Acc 0.9001315789473684, AUC 0.9588889479637146
Test Epoch37 layer4 Acc 0.9007894736842105, AUC 0.9528652429580688
gc 0
[[6.38911743e+02 3.59680125e+01]
 [1.91250974e-03 4.22945836e+00]
 [3.77292380e-03 1.24886644e+00]
 [5.58321939e-03 4.94659658e-01]
 [6.34002858e-03 1.95343945e-01]]
Train Epoch38 Acc 0.9927916666666666 (119135/120000), AUC 0.9987874031066895
Test Epoch38 layer0 Acc 0.9069736842105263, AUC 0.978690505027771
Test Epoch38 layer1 Acc 0.9068421052631579, AUC 0.9669989347457886
Test Epoch38 layer2 Acc 0.9018421052631579, AUC 0.9557892680168152
Test Epoch38 layer3 Acc 0.9018421052631579, AUC 0.9536358714103699
Test Epoch38 layer4 Acc 0.9017105263157895, AUC 0.9518053531646729
gc 0
[[6.38911743e+02 3.58963911e+01]
 [1.95498079e-03 4.11808624e+00]
 [5.18947061e-03 1.20646981e+00]
 [1.05472365e-02 4.84293776e-01]
 [1.52066326e-02 2.11742875e-01]]
Train Epoch39 Acc 0.992975 (119157/120000), AUC 0.9988542199134827
Test Epoch39 layer0 Acc 0.9068421052631579, AUC 0.9786497354507446
Test Epoch39 layer1 Acc 0.9061842105263158, AUC 0.9662045240402222
Test Epoch39 layer2 Acc 0.8994736842105263, AUC 0.9593985080718994
Test Epoch39 layer3 Acc 0.8993421052631579, AUC 0.9569803476333618
Test Epoch39 layer4 Acc 0.8997368421052632, AUC 0.9507684707641602
gc 0
[[6.38911743e+02 3.58824464e+01]
 [2.72313770e-03 4.08935563e+00]
 [7.93572893e-03 1.18028872e+00]
 [1.67340088e-02 5.23508469e-01]
 [2.57576833e-02 3.23328490e-01]]
Train Epoch40 Acc 0.9933666666666666 (119204/120000), AUC 0.9988356232643127
Test Epoch40 layer0 Acc 0.9093421052631578, AUC 0.9783662557601929
Test Epoch40 layer1 Acc 0.9071052631578947, AUC 0.9676346182823181
Test Epoch40 layer2 Acc 0.9017105263157895, AUC 0.9605139493942261
Test Epoch40 layer3 Acc 0.9018421052631579, AUC 0.9557912945747375
Test Epoch40 layer4 Acc 0.9018421052631579, AUC 0.9528848528862
gc 0
[[6.38911743e+02 3.58333340e+01]
 [1.54783074e-03 4.00851757e+00]
 [1.88759791e-03 1.09419672e+00]
 [1.54277831e-03 4.13574138e-01]
 [9.20037302e-04 1.62157642e-01]]
Train Epoch41 Acc 0.9935833333333334 (119230/120000), AUC 0.9989075660705566
Test Epoch41 layer0 Acc 0.9075, AUC 0.9787391424179077
Test Epoch41 layer1 Acc 0.9080263157894737, AUC 0.9669449329376221
Test Epoch41 layer2 Acc 0.9038157894736842, AUC 0.960188090801239
Test Epoch41 layer3 Acc 0.9038157894736842, AUC 0.9571384191513062
Test Epoch41 layer4 Acc 0.9038157894736842, AUC 0.9534558057785034
gc 0
[[6.38911743e+02 3.58237876e+01]
 [2.47528429e-03 3.92521574e+00]
 [1.04660752e-02 1.08879756e+00]
 [2.29064795e-02 4.72528736e-01]
 [2.83555234e-02 2.77005559e-01]]
Train Epoch42 Acc 0.9940083333333334 (119281/120000), AUC 0.9989792108535767
Test Epoch42 layer0 Acc 0.9069736842105263, AUC 0.9783754348754883
Test Epoch42 layer1 Acc 0.9073684210526316, AUC 0.9678353071212769
Test Epoch42 layer2 Acc 0.9038157894736842, AUC 0.9553966522216797
Test Epoch42 layer3 Acc 0.9042105263157895, AUC 0.9532007575035095
Test Epoch42 layer4 Acc 0.9047368421052632, AUC 0.9514181017875671
gc 0
[[6.38911743e+02 3.57552077e+01]
 [1.37099671e-03 3.82808295e+00]
 [6.07761871e-03 1.04357018e+00]
 [1.23315794e-02 4.16809367e-01]
 [1.57131617e-02 2.16510594e-01]]
Train Epoch43 Acc 0.99415 (119298/120000), AUC 0.9989701509475708
Test Epoch43 layer0 Acc 0.9075, AUC 0.9783937335014343
Test Epoch43 layer1 Acc 0.9073684210526316, AUC 0.966772198677063
Test Epoch43 layer2 Acc 0.901578947368421, AUC 0.9572414755821228
Test Epoch43 layer3 Acc 0.9007894736842105, AUC 0.9573973417282104
Test Epoch43 layer4 Acc 0.900921052631579, AUC 0.9521589279174805
gc 0
[[6.38911743e+02 3.57487209e+01]
 [1.92141559e-03 3.76382056e+00]
 [2.59494092e-03 9.72649500e-01]
 [2.86261846e-03 3.43735924e-01]
 [2.95678380e-03 1.27144734e-01]]
Train Epoch44 Acc 0.994125 (119295/120000), AUC 0.9988700151443481
Test Epoch44 layer0 Acc 0.9077631578947368, AUC 0.9783918857574463
Test Epoch44 layer1 Acc 0.905, AUC 0.9661906957626343
Test Epoch44 layer2 Acc 0.8977631578947368, AUC 0.9557650685310364
Test Epoch44 layer3 Acc 0.8975, AUC 0.9548091888427734
Test Epoch44 layer4 Acc 0.8971052631578947, AUC 0.9500336050987244
gc 0
[[6.38911743e+02 3.57458153e+01]
 [2.26835015e-03 3.74420118e+00]
 [7.22941438e-03 9.97471178e-01]
 [1.68912635e-02 4.19555572e-01]
 [2.29298797e-02 2.57500877e-01]]
Train Epoch45 Acc 0.9944083333333333 (119329/120000), AUC 0.9990906715393066
Test Epoch45 layer0 Acc 0.908157894736842, AUC 0.9787063598632812
Test Epoch45 layer1 Acc 0.9060526315789473, AUC 0.9669623374938965
Test Epoch45 layer2 Acc 0.9006578947368421, AUC 0.957146406173706
Test Epoch45 layer3 Acc 0.8998684210526315, AUC 0.9546879529953003
Test Epoch45 layer4 Acc 0.9, AUC 0.948853611946106
gc 0
[[6.38911743e+02 3.56899422e+01]
 [1.42181021e-03 3.61587517e+00]
 [1.16501901e-03 8.97844988e-01]
 [1.20391453e-03 3.08453572e-01]
 [1.05285395e-03 1.07058454e-01]]
Train Epoch46 Acc 0.9946333333333334 (119356/120000), AUC 0.9990484714508057
Test Epoch46 layer0 Acc 0.9085526315789474, AUC 0.9784456491470337
Test Epoch46 layer1 Acc 0.906578947368421, AUC 0.9667552709579468
Test Epoch46 layer2 Acc 0.9023684210526316, AUC 0.9533513784408569
Test Epoch46 layer3 Acc 0.9019736842105263, AUC 0.9554480910301208
Test Epoch46 layer4 Acc 0.9021052631578947, AUC 0.9503031969070435
gc 0
[[6.38911743e+02 3.56582456e+01]
 [1.68745238e-03 3.61509974e+00]
 [8.72095690e-03 9.07313022e-01]
 [2.06809444e-02 3.65410262e-01]
 [2.83706479e-02 2.17488545e-01]]
Train Epoch47 Acc 0.9947166666666667 (119366/120000), AUC 0.9990116953849792
Test Epoch47 layer0 Acc 0.9073684210526316, AUC 0.9781603217124939
Test Epoch47 layer1 Acc 0.906578947368421, AUC 0.968090832233429
Test Epoch47 layer2 Acc 0.9040789473684211, AUC 0.9596703052520752
Test Epoch47 layer3 Acc 0.9035526315789474, AUC 0.958415150642395
Test Epoch47 layer4 Acc 0.9038157894736842, AUC 0.9520488381385803
gc 0
[[6.38911743e+02 3.56735620e+01]
 [1.78804315e-03 3.54663527e+00]
 [7.37030625e-03 8.67979181e-01]
 [1.60885074e-02 3.35334008e-01]
 [1.81721796e-02 1.86865180e-01]]
Train Epoch48 Acc 0.9947833333333334 (119374/120000), AUC 0.9991365671157837
Test Epoch48 layer0 Acc 0.9071052631578947, AUC 0.9783005714416504
Test Epoch48 layer1 Acc 0.9051315789473684, AUC 0.9667906761169434
Test Epoch48 layer2 Acc 0.9002631578947369, AUC 0.9607184529304504
Test Epoch48 layer3 Acc 0.9006578947368421, AUC 0.9555125832557678
Test Epoch48 layer4 Acc 0.9002631578947369, AUC 0.9535850286483765
gc 0
[[6.38911743e+02 3.56151064e+01]
 [1.66857780e-03 3.45696398e+00]
 [2.02882815e-03 7.79877266e-01]
 [3.03198889e-03 2.57110949e-01]
 [3.51804581e-03 1.00153826e-01]]
Train Epoch49 Acc 0.995275 (119433/120000), AUC 0.9992176294326782
Test Epoch49 layer0 Acc 0.9053947368421053, AUC 0.9784626960754395
Test Epoch49 layer1 Acc 0.9063157894736842, AUC 0.9675711393356323
Test Epoch49 layer2 Acc 0.9019736842105263, AUC 0.9570596218109131
Test Epoch49 layer3 Acc 0.9023684210526316, AUC 0.9545884728431702
Test Epoch49 layer4 Acc 0.9026315789473685, AUC 0.9497557878494263
Best AUC 0.9826245903968811
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt//ag_news/ag_news_transformeral_l5.pt
[[1704   60   89   47]
 [  16 1866   12    6]
 [  49   17 1675  159]
 [  56   17  135 1692]]
Figure(640x480)
[[1719   56   71   54]
 [  16 1857   18    9]
 [  50   13 1680  157]
 [  51   16  120 1713]]
Figure(640x480)
[[1720   56   69   55]
 [  15 1858   16   11]
 [  53   13 1665  169]
 [  46   13  112 1729]]
Figure(640x480)
[[1722   56   67   55]
 [  17 1857   16   10]
 [  55   13 1664  168]
 [  50   14  112 1724]]
Figure(640x480)
[[1721   56   68   55]
 [  16 1857   16   11]
 [  53   13 1664  170]
 [  47   13  111 1729]]
Figure(640x480)
