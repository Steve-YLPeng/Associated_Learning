total count words 102019
vocab size 30000
found 26754 words in glove
Start Training
gc 0
[[704.0461579   25.86222305]
 [  7.95047144  31.38682366]
 [ 10.53681093  27.27046029]
 [  7.67971296  24.0007579 ]
 [  6.95619986  21.2848864 ]]
Train Epoch0 Acc 0.7934583333333334 (95215/120000), AUC 0.9469376802444458
Test Epoch0 layer0 Acc 0.915, AUC 0.9800109267234802
Save ckpt to ./ckpt//ag_news/ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9123684210526316, AUC 0.9802443981170654
Save ckpt to ./ckpt//ag_news/ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9139473684210526, AUC 0.9803459644317627
Save ckpt to ./ckpt//ag_news/ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9144736842105263, AUC 0.9804447889328003
Save ckpt to ./ckpt//ag_news/ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer4 Acc 0.9151315789473684, AUC 0.980573832988739
Save ckpt to ./ckpt//ag_news/ag_news_linearal_l5.pt  ,ep 0
gc 0
[[6.39373238e+02 2.57292627e+01]
 [7.79826164e-06 2.63322016e+01]
 [7.96038321e-06 2.40909788e+01]
 [3.01195469e-06 2.13170241e+01]
 [1.95159403e-06 1.92769923e+01]]
Train Epoch1 Acc 0.930675 (111681/120000), AUC 0.9869263172149658
Test Epoch1 layer0 Acc 0.9140789473684211, AUC 0.9808774590492249
Save ckpt to ./ckpt//ag_news/ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9160526315789473, AUC 0.9811375141143799
Save ckpt to ./ckpt//ag_news/ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9152631578947369, AUC 0.9811981916427612
Save ckpt to ./ckpt//ag_news/ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9152631578947369, AUC 0.9815024733543396
Save ckpt to ./ckpt//ag_news/ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.9152631578947369, AUC 0.9819985628128052
Save ckpt to ./ckpt//ag_news/ag_news_linearal_l5.pt  ,ep 1
gc 0
[[6.39019920e+02 2.72545461e+01]
 [3.45063726e-07 2.68370201e+01]
 [3.52959506e-07 2.39896434e+01]
 [1.61049922e-07 2.01743533e+01]
 [1.69203116e-07 1.71655487e+01]]
Train Epoch2 Acc 0.93685 (112422/120000), AUC 0.9896725416183472
Test Epoch2 layer0 Acc 0.9143421052631578, AUC 0.9811410903930664
Test Epoch2 layer1 Acc 0.9153947368421053, AUC 0.9813133478164673
Test Epoch2 layer2 Acc 0.9144736842105263, AUC 0.9814473390579224
Test Epoch2 layer3 Acc 0.9153947368421053, AUC 0.9817217588424683
Test Epoch2 layer4 Acc 0.9148684210526316, AUC 0.9823271036148071
Save ckpt to ./ckpt//ag_news/ag_news_linearal_l5.pt  ,ep 2
gc 0
[[6.38945455e+02 2.87844183e+01]
 [4.69351182e-08 2.76867419e+01]
 [4.36268628e-08 2.38419477e+01]
 [6.47028794e-08 1.86841047e+01]
 [2.88268670e-07 1.53884744e+01]]
Train Epoch3 Acc 0.9411416666666667 (112937/120000), AUC 0.9903991222381592
Test Epoch3 layer0 Acc 0.9144736842105263, AUC 0.9814492464065552
Test Epoch3 layer1 Acc 0.9139473684210526, AUC 0.9816121459007263
Test Epoch3 layer2 Acc 0.9142105263157895, AUC 0.9821916818618774
Test Epoch3 layer3 Acc 0.9136842105263158, AUC 0.9825136661529541
Save ckpt to ./ckpt//ag_news/ag_news_linearal_l5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.9142105263157895, AUC 0.980778157711029
gc 0
[[6.38923315e+02 3.03386838e+01]
 [2.71610724e-05 2.86143853e+01]
 [8.44287934e-05 2.34492220e+01]
 [3.22686656e-04 1.73242516e+01]
 [8.18655939e-04 1.50134153e+01]]
Train Epoch4 Acc 0.9435833333333333 (113230/120000), AUC 0.9908837676048279
Test Epoch4 layer0 Acc 0.9152631578947369, AUC 0.981482207775116
Test Epoch4 layer1 Acc 0.9147368421052632, AUC 0.981599748134613
Test Epoch4 layer2 Acc 0.9163157894736842, AUC 0.9823035001754761
Test Epoch4 layer3 Acc 0.9157894736842105, AUC 0.9815655946731567
Test Epoch4 layer4 Acc 0.9153947368421053, AUC 0.9815754890441895
gc 0
[[6.38915912e+02 3.18741048e+01]
 [1.56404759e-04 2.94963722e+01]
 [4.49699860e-04 2.28090167e+01]
 [1.05098154e-03 1.66878922e+01]
 [1.91710186e-03 1.49815690e+01]]
Train Epoch5 Acc 0.9453916666666666 (113447/120000), AUC 0.9915227890014648
Test Epoch5 layer0 Acc 0.9143421052631578, AUC 0.9809209704399109
Test Epoch5 layer1 Acc 0.9151315789473684, AUC 0.9812322854995728
Test Epoch5 layer2 Acc 0.9157894736842105, AUC 0.9819015264511108
Test Epoch5 layer3 Acc 0.9152631578947369, AUC 0.9810214638710022
Test Epoch5 layer4 Acc 0.9155263157894736, AUC 0.980792760848999
gc 0
[[6.38913232e+02 3.33731400e+01]
 [1.40460262e-04 3.02269700e+01]
 [3.32461086e-04 2.20253971e+01]
 [6.38236125e-04 1.66451366e+01]
 [9.51589212e-04 1.50495970e+01]]
Train Epoch6 Acc 0.946725 (113607/120000), AUC 0.9922229647636414
Test Epoch6 layer0 Acc 0.9121052631578948, AUC 0.9806416034698486
Test Epoch6 layer1 Acc 0.9134210526315789, AUC 0.9809942841529846
Test Epoch6 layer2 Acc 0.9136842105263158, AUC 0.9815905094146729
Test Epoch6 layer3 Acc 0.9125, AUC 0.9809328317642212
Test Epoch6 layer4 Acc 0.9131578947368421, AUC 0.9823229908943176
gc 0
[[6.38912454e+02 3.48015979e+01]
 [1.83435427e-04 3.07964801e+01]
 [4.27416847e-04 2.11749981e+01]
 [7.90750170e-04 1.67036979e+01]
 [1.28563319e-03 1.51197122e+01]]
Train Epoch7 Acc 0.9481583333333333 (113779/120000), AUC 0.9926720857620239
Test Epoch7 layer0 Acc 0.911578947368421, AUC 0.9807028770446777
Test Epoch7 layer1 Acc 0.9122368421052631, AUC 0.981112003326416
Test Epoch7 layer2 Acc 0.9135526315789474, AUC 0.9805933833122253
Test Epoch7 layer3 Acc 0.9128947368421053, AUC 0.9792537689208984
Test Epoch7 layer4 Acc 0.9128947368421053, AUC 0.9805381298065186
gc 0
[[6.38911986e+02 3.61901820e+01]
 [2.33786799e-04 3.11929464e+01]
 [5.23083470e-04 2.06075295e+01]
 [9.85083567e-04 1.68541190e+01]
 [1.63428907e-03 1.52591276e+01]]
Train Epoch8 Acc 0.9487583333333334 (113851/120000), AUC 0.9930105209350586
Test Epoch8 layer0 Acc 0.9135526315789474, AUC 0.9804209470748901
Test Epoch8 layer1 Acc 0.9130263157894737, AUC 0.980819582939148
Test Epoch8 layer2 Acc 0.9136842105263158, AUC 0.980538547039032
Test Epoch8 layer3 Acc 0.9131578947368421, AUC 0.9809054136276245
Test Epoch8 layer4 Acc 0.9119736842105263, AUC 0.9812471866607666
gc 0
[[6.38911743e+02 3.74757319e+01]
 [2.21396583e-04 3.13254895e+01]
 [5.04249332e-04 2.03018152e+01]
 [9.50928109e-04 1.69454360e+01]
 [1.53247454e-03 1.53437806e+01]]
Train Epoch9 Acc 0.949925 (113991/120000), AUC 0.9931949973106384
Test Epoch9 layer0 Acc 0.91, AUC 0.9800333380699158
Test Epoch9 layer1 Acc 0.910921052631579, AUC 0.9808666706085205
Test Epoch9 layer2 Acc 0.9111842105263158, AUC 0.9801962375640869
Test Epoch9 layer3 Acc 0.9123684210526316, AUC 0.980293333530426
Test Epoch9 layer4 Acc 0.9119736842105263, AUC 0.9806066751480103
gc 0
[[6.38911743e+02 3.82398104e+01]
 [1.63020188e-04 3.08765137e+01]
 [3.74416001e-04 1.99055579e+01]
 [7.11394137e-04 1.67461652e+01]
 [1.15988940e-03 1.51538672e+01]]
Train Epoch10 Acc 0.9509916666666667 (114119/120000), AUC 0.9932887554168701
Test Epoch10 layer0 Acc 0.9132894736842105, AUC 0.9797557592391968
Test Epoch10 layer1 Acc 0.9132894736842105, AUC 0.9803181886672974
Test Epoch10 layer2 Acc 0.9136842105263158, AUC 0.9796223044395447
Test Epoch10 layer3 Acc 0.9127631578947368, AUC 0.9800942540168762
Test Epoch10 layer4 Acc 0.9135526315789474, AUC 0.9798398017883301
gc 0
[[6.38911743e+02 3.80817065e+01]
 [2.38033319e-04 2.98088204e+01]
 [5.46826767e-04 1.94129862e+01]
 [1.02566941e-03 1.64522200e+01]
 [1.64512624e-03 1.49153329e+01]]
Train Epoch11 Acc 0.9515583333333333 (114187/120000), AUC 0.9935610890388489
Test Epoch11 layer0 Acc 0.9123684210526316, AUC 0.9796276092529297
Test Epoch11 layer1 Acc 0.9127631578947368, AUC 0.9804789423942566
Test Epoch11 layer2 Acc 0.9125, AUC 0.9790341854095459
Test Epoch11 layer3 Acc 0.9123684210526316, AUC 0.9792267680168152
Test Epoch11 layer4 Acc 0.9118421052631579, AUC 0.9791613817214966
gc 0
[[6.38911743e+02 3.78540004e+01]
 [1.98009514e-04 2.87391204e+01]
 [4.57993092e-04 1.89803806e+01]
 [8.45153317e-04 1.61629512e+01]
 [1.32830897e-03 1.46715694e+01]]
Train Epoch12 Acc 0.9523666666666667 (114284/120000), AUC 0.9936450123786926
Test Epoch12 layer0 Acc 0.9122368421052631, AUC 0.979856550693512
Test Epoch12 layer1 Acc 0.9122368421052631, AUC 0.9807152152061462
Test Epoch12 layer2 Acc 0.9121052631578948, AUC 0.9792372584342957
Test Epoch12 layer3 Acc 0.9114473684210527, AUC 0.9786080121994019
Test Epoch12 layer4 Acc 0.9118421052631579, AUC 0.9787440299987793
gc 0
[[6.38911743e+02 3.76716679e+01]
 [2.67028489e-04 2.77914520e+01]
 [6.22859348e-04 1.86381923e+01]
 [1.11420384e-03 1.59205677e+01]
 [1.85670332e-03 1.44785075e+01]]
Train Epoch13 Acc 0.952875 (114345/120000), AUC 0.993895411491394
Test Epoch13 layer0 Acc 0.911578947368421, AUC 0.9796470999717712
Test Epoch13 layer1 Acc 0.9119736842105263, AUC 0.9804563522338867
Test Epoch13 layer2 Acc 0.910921052631579, AUC 0.977424144744873
Test Epoch13 layer3 Acc 0.9103947368421053, AUC 0.9778119325637817
Test Epoch13 layer4 Acc 0.9107894736842105, AUC 0.9782038927078247
gc 0
[[6.38911743e+02 3.74523245e+01]
 [1.45251517e-04 2.68744071e+01]
 [3.30629353e-04 1.82940643e+01]
 [6.49622658e-04 1.56759536e+01]
 [9.99685025e-04 1.42632193e+01]]
Train Epoch14 Acc 0.953925 (114471/120000), AUC 0.9940287470817566
Test Epoch14 layer0 Acc 0.9113157894736842, AUC 0.97938072681427
Test Epoch14 layer1 Acc 0.9127631578947368, AUC 0.9800978302955627
Test Epoch14 layer2 Acc 0.911578947368421, AUC 0.9789497256278992
Test Epoch14 layer3 Acc 0.9114473684210527, AUC 0.9791034460067749
Test Epoch14 layer4 Acc 0.9119736842105263, AUC 0.9795399904251099
gc 0
[[6.38911743e+02 3.73041570e+01]
 [3.27131369e-04 2.60878192e+01]
 [7.28333832e-04 1.80361805e+01]
 [1.38247623e-03 1.54981997e+01]
 [2.29915019e-03 1.41184193e+01]]
Train Epoch15 Acc 0.954125 (114495/120000), AUC 0.9941322803497314
Test Epoch15 layer0 Acc 0.9101315789473684, AUC 0.9795704483985901
Test Epoch15 layer1 Acc 0.91, AUC 0.9798692464828491
Test Epoch15 layer2 Acc 0.91, AUC 0.9763954281806946
Test Epoch15 layer3 Acc 0.9111842105263158, AUC 0.9766412973403931
Test Epoch15 layer4 Acc 0.9111842105263158, AUC 0.9779200553894043
gc 0
[[6.38911743e+02 3.71681167e+01]
 [1.53399347e-04 2.53232980e+01]
 [3.31614281e-04 1.77506304e+01]
 [6.10900132e-04 1.52730347e+01]
 [9.43049448e-04 1.39296348e+01]]
Train Epoch16 Acc 0.9547666666666667 (114572/120000), AUC 0.9942677021026611
Test Epoch16 layer0 Acc 0.9092105263157895, AUC 0.9795856475830078
Test Epoch16 layer1 Acc 0.9098684210526315, AUC 0.9801511764526367
Test Epoch16 layer2 Acc 0.9093421052631578, AUC 0.9767146110534668
Test Epoch16 layer3 Acc 0.91, AUC 0.9766440987586975
Test Epoch16 layer4 Acc 0.9096052631578947, AUC 0.9766226410865784
gc 0
[[6.38911743e+02 3.70484249e+01]
 [2.14962020e-04 2.46426060e+01]
 [4.77137248e-04 1.74928037e+01]
 [8.61737597e-04 1.50883003e+01]
 [1.34263820e-03 1.37657089e+01]]
Train Epoch17 Acc 0.9553333333333334 (114640/120000), AUC 0.9943152666091919
Test Epoch17 layer0 Acc 0.91, AUC 0.979412317276001
Test Epoch17 layer1 Acc 0.9094736842105263, AUC 0.979813814163208
Test Epoch17 layer2 Acc 0.9107894736842105, AUC 0.9763273596763611
Test Epoch17 layer3 Acc 0.911578947368421, AUC 0.9767259359359741
Test Epoch17 layer4 Acc 0.9123684210526316, AUC 0.9773111343383789
gc 0
[[6.38911743e+02 3.69293232e+01]
 [1.81752424e-04 2.39824399e+01]
 [4.42235531e-04 1.72592122e+01]
 [8.44556096e-04 1.49060371e+01]
 [1.41101994e-03 1.36095130e+01]]
Train Epoch18 Acc 0.9558583333333334 (114703/120000), AUC 0.9944996237754822
Test Epoch18 layer0 Acc 0.9113157894736842, AUC 0.9792819023132324
Test Epoch18 layer1 Acc 0.91, AUC 0.9796972274780273
Test Epoch18 layer2 Acc 0.9094736842105263, AUC 0.9773530960083008
Test Epoch18 layer3 Acc 0.91, AUC 0.9769662022590637
Test Epoch18 layer4 Acc 0.91, AUC 0.9771509170532227
gc 0
[[6.38911743e+02 3.68137678e+01]
 [2.03213006e-04 2.33629556e+01]
 [4.65161098e-04 1.69604654e+01]
 [8.22388730e-04 1.46498773e+01]
 [1.23455837e-03 1.33780905e+01]]
Train Epoch19 Acc 0.9567416666666667 (114809/120000), AUC 0.9946044087409973
Test Epoch19 layer0 Acc 0.9111842105263158, AUC 0.9792845249176025
Test Epoch19 layer1 Acc 0.91, AUC 0.9795659780502319
Test Epoch19 layer2 Acc 0.9092105263157895, AUC 0.9775346517562866
Test Epoch19 layer3 Acc 0.9093421052631578, AUC 0.9782509207725525
Test Epoch19 layer4 Acc 0.9092105263157895, AUC 0.978417694568634
gc 0
[[6.38911743e+02 3.67450855e+01]
 [1.96732729e-04 2.28428974e+01]
 [4.31358071e-04 1.68047704e+01]
 [7.77613946e-04 1.45297069e+01]
 [1.22850768e-03 1.32655156e+01]]
Train Epoch20 Acc 0.9569333333333333 (114832/120000), AUC 0.9948394894599915
Test Epoch20 layer0 Acc 0.9098684210526315, AUC 0.9793574213981628
Test Epoch20 layer1 Acc 0.9077631578947368, AUC 0.9791163802146912
Test Epoch20 layer2 Acc 0.9080263157894737, AUC 0.9760286211967468
Test Epoch20 layer3 Acc 0.908157894736842, AUC 0.975597620010376
Test Epoch20 layer4 Acc 0.9078947368421053, AUC 0.976100504398346
gc 0
[[6.38911743e+02 3.66122927e+01]
 [2.23299906e-04 2.23117983e+01]
 [5.46983571e-04 1.65790988e+01]
 [1.05350134e-03 1.43211341e+01]
 [1.70268435e-03 1.30585470e+01]]
Train Epoch21 Acc 0.9579416666666667 (114953/120000), AUC 0.994869589805603
Test Epoch21 layer0 Acc 0.9111842105263158, AUC 0.9788237810134888
Test Epoch21 layer1 Acc 0.9089473684210526, AUC 0.9784889221191406
Test Epoch21 layer2 Acc 0.9092105263157895, AUC 0.976047694683075
Test Epoch21 layer3 Acc 0.9088157894736842, AUC 0.9767026901245117
Test Epoch21 layer4 Acc 0.9086842105263158, AUC 0.9768648147583008
gc 0
[[6.38911743e+02 3.65151438e+01]
 [2.11309140e-04 2.18014880e+01]
 [4.68559524e-04 1.63322312e+01]
 [8.90484622e-04 1.41151779e+01]
 [1.47069165e-03 1.28566938e+01]]
Train Epoch22 Acc 0.958275 (114993/120000), AUC 0.9949796795845032
Test Epoch22 layer0 Acc 0.9080263157894737, AUC 0.9790005087852478
Test Epoch22 layer1 Acc 0.9086842105263158, AUC 0.9784101247787476
Test Epoch22 layer2 Acc 0.9085526315789474, AUC 0.9749799370765686
Test Epoch22 layer3 Acc 0.9089473684210526, AUC 0.9752036333084106
Test Epoch22 layer4 Acc 0.9085526315789474, AUC 0.974831223487854
gc 0
[[6.38911743e+02 3.64556880e+01]
 [3.17853006e-04 2.14370079e+01]
 [7.70202787e-04 1.61900503e+01]
 [1.51183539e-03 1.39670521e+01]
 [2.40832005e-03 1.27076771e+01]]
Train Epoch23 Acc 0.9591416666666667 (115097/120000), AUC 0.9950453639030457
Test Epoch23 layer0 Acc 0.9089473684210526, AUC 0.9790904521942139
Test Epoch23 layer1 Acc 0.9076315789473685, AUC 0.9785923361778259
Test Epoch23 layer2 Acc 0.9076315789473685, AUC 0.976045548915863
Test Epoch23 layer3 Acc 0.9071052631578947, AUC 0.9763121008872986
Test Epoch23 layer4 Acc 0.9069736842105263, AUC 0.9758791923522949
gc 0
[[6.38911743e+02 3.63331065e+01]
 [1.87836738e-04 2.09909685e+01]
 [4.26381005e-04 1.59674815e+01]
 [7.19114712e-04 1.37499185e+01]
 [1.06972406e-03 1.24962518e+01]]
Train Epoch24 Acc 0.9597666666666667 (115172/120000), AUC 0.9951989650726318
Test Epoch24 layer0 Acc 0.9084210526315789, AUC 0.9795092344284058
Test Epoch24 layer1 Acc 0.9090789473684211, AUC 0.9784537553787231
Test Epoch24 layer2 Acc 0.9077631578947368, AUC 0.9757444262504578
Test Epoch24 layer3 Acc 0.9075, AUC 0.9753837585449219
Test Epoch24 layer4 Acc 0.9080263157894737, AUC 0.9761592149734497
gc 0
[[6.38911743e+02 3.62794589e+01]
 [1.92965163e-04 2.06470807e+01]
 [4.29913666e-04 1.57902667e+01]
 [7.45386249e-04 1.35846942e+01]
 [1.10917969e-03 1.23179158e+01]]
Train Epoch25 Acc 0.96055 (115266/120000), AUC 0.9952141046524048
Test Epoch25 layer0 Acc 0.9085526315789474, AUC 0.9788832068443298
Test Epoch25 layer1 Acc 0.9053947368421053, AUC 0.9778857231140137
Test Epoch25 layer2 Acc 0.9055263157894737, AUC 0.9746690988540649
Test Epoch25 layer3 Acc 0.905, AUC 0.9745661616325378
Test Epoch25 layer4 Acc 0.9052631578947369, AUC 0.9755432605743408
gc 0
[[6.38911743e+02 3.62122368e+01]
 [2.31978686e-04 2.03529636e+01]
 [5.45382406e-04 1.56772071e+01]
 [1.02225463e-03 1.34777739e+01]
 [1.62617389e-03 1.21997473e+01]]
Train Epoch26 Acc 0.961025 (115323/120000), AUC 0.9953967332839966
Test Epoch26 layer0 Acc 0.9096052631578947, AUC 0.979096531867981
Test Epoch26 layer1 Acc 0.906578947368421, AUC 0.9776525497436523
Test Epoch26 layer2 Acc 0.905, AUC 0.9746637940406799
Test Epoch26 layer3 Acc 0.9060526315789473, AUC 0.9750415682792664
Test Epoch26 layer4 Acc 0.905, AUC 0.9755884408950806
gc 0
[[6.38911743e+02 3.61695919e+01]
 [1.61330129e-04 2.00867660e+01]
 [3.51276816e-04 1.55287531e+01]
 [6.04581629e-04 1.33284389e+01]
 [8.97370683e-04 1.20442016e+01]]
Train Epoch27 Acc 0.9618 (115416/120000), AUC 0.9953891038894653
Test Epoch27 layer0 Acc 0.908157894736842, AUC 0.9786880016326904
Test Epoch27 layer1 Acc 0.9073684210526316, AUC 0.9768205881118774
Test Epoch27 layer2 Acc 0.9055263157894737, AUC 0.9732339382171631
Test Epoch27 layer3 Acc 0.9051315789473684, AUC 0.9733994007110596
Test Epoch27 layer4 Acc 0.9052631578947369, AUC 0.9728446006774902
gc 0
[[6.38911743e+02 3.61050573e+01]
 [1.86971385e-04 1.98132799e+01]
 [4.24694158e-04 1.53533574e+01]
 [7.52149450e-04 1.31450208e+01]
 [1.15359157e-03 1.18567896e+01]]
Train Epoch28 Acc 0.9623833333333334 (115486/120000), AUC 0.9955437779426575
Test Epoch28 layer0 Acc 0.9090789473684211, AUC 0.9787877798080444
Test Epoch28 layer1 Acc 0.9057894736842105, AUC 0.9768053889274597
Test Epoch28 layer2 Acc 0.9048684210526315, AUC 0.9735114574432373
Test Epoch28 layer3 Acc 0.9042105263157895, AUC 0.9731686115264893
Test Epoch28 layer4 Acc 0.9047368421052632, AUC 0.9733467102050781
gc 0
[[6.38911743e+02 3.60455999e+01]
 [1.99283838e-04 1.95756760e+01]
 [4.39629783e-04 1.52235617e+01]
 [7.92647685e-04 1.30236784e+01]
 [1.17754247e-03 1.17235404e+01]]
Train Epoch29 Acc 0.9628833333333333 (115546/120000), AUC 0.9956107139587402
Test Epoch29 layer0 Acc 0.9092105263157895, AUC 0.9787358045578003
Test Epoch29 layer1 Acc 0.9063157894736842, AUC 0.9761463403701782
Test Epoch29 layer2 Acc 0.905, AUC 0.9735591411590576
Test Epoch29 layer3 Acc 0.9034210526315789, AUC 0.9733227491378784
Test Epoch29 layer4 Acc 0.9044736842105263, AUC 0.9737164974212646
gc 0
[[6.38911743e+02 3.59900513e+01]
 [1.98718330e-04 1.93584705e+01]
 [4.37667325e-04 1.50791253e+01]
 [7.57584813e-04 1.28723058e+01]
 [1.15801181e-03 1.15574020e+01]]
Train Epoch30 Acc 0.9635166666666667 (115622/120000), AUC 0.9957531690597534
Test Epoch30 layer0 Acc 0.9084210526315789, AUC 0.9788539409637451
Test Epoch30 layer1 Acc 0.9064473684210527, AUC 0.9764612913131714
Test Epoch30 layer2 Acc 0.9060526315789473, AUC 0.9727524518966675
Test Epoch30 layer3 Acc 0.9052631578947369, AUC 0.9723239541053772
Test Epoch30 layer4 Acc 0.9056578947368421, AUC 0.9726237058639526
gc 0
[[6.38911743e+02 3.59387904e+01]
 [1.87711324e-04 1.91181925e+01]
 [4.58398059e-04 1.49462894e+01]
 [8.32439224e-04 1.27415596e+01]
 [1.31267283e-03 1.14127453e+01]]
Train Epoch31 Acc 0.9639833333333333 (115678/120000), AUC 0.9957485198974609
Test Epoch31 layer0 Acc 0.9096052631578947, AUC 0.9786827564239502
Test Epoch31 layer1 Acc 0.9063157894736842, AUC 0.9757386445999146
Test Epoch31 layer2 Acc 0.905, AUC 0.9730035662651062
Test Epoch31 layer3 Acc 0.9040789473684211, AUC 0.9721331596374512
Test Epoch31 layer4 Acc 0.9042105263157895, AUC 0.9710553884506226
gc 0
[[6.38911743e+02 3.58857034e+01]
 [2.11727859e-04 1.90086480e+01]
 [4.79561099e-04 1.48820114e+01]
 [8.33923572e-04 1.26597799e+01]
 [1.29494067e-03 1.13140086e+01]]
Train Epoch32 Acc 0.964675 (115761/120000), AUC 0.995795488357544
Test Epoch32 layer0 Acc 0.9084210526315789, AUC 0.9790164828300476
Test Epoch32 layer1 Acc 0.9057894736842105, AUC 0.9756243824958801
Test Epoch32 layer2 Acc 0.9068421052631579, AUC 0.9736756682395935
Test Epoch32 layer3 Acc 0.9051315789473684, AUC 0.9733644127845764
Test Epoch32 layer4 Acc 0.9044736842105263, AUC 0.9730232954025269
gc 0
[[6.38911743e+02 3.58310507e+01]
 [1.73828895e-04 1.87810405e+01]
 [3.96108378e-04 1.47021422e+01]
 [6.86754511e-04 1.24788303e+01]
 [1.01679395e-03 1.11219789e+01]]
Train Epoch33 Acc 0.9648583333333334 (115783/120000), AUC 0.995951235294342
Test Epoch33 layer0 Acc 0.9089473684210526, AUC 0.9785301685333252
Test Epoch33 layer1 Acc 0.9067105263157895, AUC 0.9757420420646667
Test Epoch33 layer2 Acc 0.904342105263158, AUC 0.9730147123336792
Test Epoch33 layer3 Acc 0.9032894736842105, AUC 0.9719849824905396
Test Epoch33 layer4 Acc 0.9035526315789474, AUC 0.9719874262809753
gc 0
[[6.38911743e+02 3.57980874e+01]
 [1.97328096e-04 1.86245748e+01]
 [4.58653404e-04 1.45919604e+01]
 [8.07559938e-04 1.23656290e+01]
 [1.20746859e-03 1.09878318e+01]]
Train Epoch34 Acc 0.9654 (115848/120000), AUC 0.9960622787475586
Test Epoch34 layer0 Acc 0.9078947368421053, AUC 0.9789847135543823
Test Epoch34 layer1 Acc 0.905, AUC 0.9754087924957275
Test Epoch34 layer2 Acc 0.9046052631578947, AUC 0.9724870920181274
Test Epoch34 layer3 Acc 0.9032894736842105, AUC 0.9713579416275024
Test Epoch34 layer4 Acc 0.9019736842105263, AUC 0.9709245562553406
gc 0
[[6.38911743e+02 3.57210406e+01]
 [2.36541623e-04 1.84466276e+01]
 [5.17498779e-04 1.44600540e+01]
 [9.36550097e-04 1.22316564e+01]
 [1.40051606e-03 1.08541884e+01]]
Train Epoch35 Acc 0.9658166666666667 (115898/120000), AUC 0.9959712028503418
Test Epoch35 layer0 Acc 0.9092105263157895, AUC 0.97918301820755
Test Epoch35 layer1 Acc 0.9052631578947369, AUC 0.9753230810165405
Test Epoch35 layer2 Acc 0.9055263157894737, AUC 0.9740675687789917
Test Epoch35 layer3 Acc 0.9039473684210526, AUC 0.9738009572029114
Test Epoch35 layer4 Acc 0.9019736842105263, AUC 0.973525881767273
gc 0
[[6.38911743e+02 3.57193084e+01]
 [1.73482629e-04 1.83006255e+01]
 [3.90593826e-04 1.43787841e+01]
 [6.47849642e-04 1.21423317e+01]
 [9.59988776e-04 1.07416899e+01]]
Train Epoch36 Acc 0.9660666666666666 (115928/120000), AUC 0.9960731267929077
Test Epoch36 layer0 Acc 0.9082894736842105, AUC 0.9783969521522522
Test Epoch36 layer1 Acc 0.9063157894736842, AUC 0.9746930003166199
Test Epoch36 layer2 Acc 0.9056578947368421, AUC 0.9717497229576111
Test Epoch36 layer3 Acc 0.9051315789473684, AUC 0.9711524844169617
Test Epoch36 layer4 Acc 0.904342105263158, AUC 0.9696250557899475
gc 0
[[6.38911743e+02 3.56640204e+01]
 [1.98165461e-04 1.81971749e+01]
 [4.37134994e-04 1.42939492e+01]
 [7.59231169e-04 1.20502861e+01]
 [1.13137547e-03 1.06539502e+01]]
Train Epoch37 Acc 0.966125 (115935/120000), AUC 0.9961669445037842
Test Epoch37 layer0 Acc 0.9086842105263158, AUC 0.9787399768829346
Test Epoch37 layer1 Acc 0.9055263157894737, AUC 0.9751424193382263
Test Epoch37 layer2 Acc 0.9038157894736842, AUC 0.9742411375045776
Test Epoch37 layer3 Acc 0.9036842105263158, AUC 0.9738597869873047
Test Epoch37 layer4 Acc 0.9025, AUC 0.9737696647644043
gc 0
[[6.38911743e+02 3.56388235e+01]
 [1.97930603e-04 1.80368221e+01]
 [4.45912272e-04 1.41646637e+01]
 [7.68893824e-04 1.19214935e+01]
 [1.16865590e-03 1.05077614e+01]]
Train Epoch38 Acc 0.966575 (115989/120000), AUC 0.9962570667266846
Test Epoch38 layer0 Acc 0.9077631578947368, AUC 0.9783943295478821
Test Epoch38 layer1 Acc 0.9040789473684211, AUC 0.9744734764099121
Test Epoch38 layer2 Acc 0.9027631578947368, AUC 0.9723821878433228
Test Epoch38 layer3 Acc 0.901578947368421, AUC 0.971307635307312
Test Epoch38 layer4 Acc 0.9005263157894737, AUC 0.9706795811653137
gc 0
[[6.38911743e+02 3.55972622e+01]
 [1.91390206e-04 1.78888448e+01]
 [4.25830186e-04 1.40702513e+01]
 [7.30949945e-04 1.18080302e+01]
 [1.06800457e-03 1.03756377e+01]]
Train Epoch39 Acc 0.96715 (116058/120000), AUC 0.9963138103485107
Test Epoch39 layer0 Acc 0.9080263157894737, AUC 0.9786614179611206
Test Epoch39 layer1 Acc 0.9048684210526315, AUC 0.9746429324150085
Test Epoch39 layer2 Acc 0.9021052631578947, AUC 0.9715811014175415
Test Epoch39 layer3 Acc 0.9025, AUC 0.9695972204208374
Test Epoch39 layer4 Acc 0.9011842105263158, AUC 0.9687647819519043
gc 0
[[6.38911743e+02 3.55735777e+01]
 [1.79951722e-04 1.78161717e+01]
 [4.01653990e-04 1.40043992e+01]
 [7.03206110e-04 1.17362560e+01]
 [1.04329781e-03 1.02954721e+01]]
Train Epoch40 Acc 0.9673 (116076/120000), AUC 0.9962508082389832
Test Epoch40 layer0 Acc 0.9077631578947368, AUC 0.9787136912345886
Test Epoch40 layer1 Acc 0.9044736842105263, AUC 0.9739444851875305
Test Epoch40 layer2 Acc 0.9036842105263158, AUC 0.9708762168884277
Test Epoch40 layer3 Acc 0.9022368421052631, AUC 0.9695125818252563
Test Epoch40 layer4 Acc 0.8992105263157895, AUC 0.969231367111206
gc 0
[[6.38911743e+02 3.55358975e+01]
 [2.60333108e-04 1.76481341e+01]
 [5.80023810e-04 1.38633088e+01]
 [1.05678430e-03 1.15869455e+01]
 [1.64743489e-03 1.01375343e+01]]
Train Epoch41 Acc 0.9679166666666666 (116150/120000), AUC 0.9963252544403076
Test Epoch41 layer0 Acc 0.9064473684210527, AUC 0.9786688685417175
Test Epoch41 layer1 Acc 0.9026315789473685, AUC 0.9747369885444641
Test Epoch41 layer2 Acc 0.901578947368421, AUC 0.9727900624275208
Test Epoch41 layer3 Acc 0.8997368421052632, AUC 0.9708585143089294
Test Epoch41 layer4 Acc 0.8984210526315789, AUC 0.9697557091712952
gc 0
[[6.38911743e+02 3.55041131e+01]
 [2.15303516e-04 1.75770496e+01]
 [5.33112084e-04 1.38151280e+01]
 [9.44845510e-04 1.15292691e+01]
 [1.41045010e-03 1.00745398e+01]]
Train Epoch42 Acc 0.9680833333333333 (116170/120000), AUC 0.9964220523834229
Test Epoch42 layer0 Acc 0.9069736842105263, AUC 0.9784111976623535
Test Epoch42 layer1 Acc 0.9047368421052632, AUC 0.9739288091659546
Test Epoch42 layer2 Acc 0.9039473684210526, AUC 0.9703184366226196
Test Epoch42 layer3 Acc 0.9028947368421053, AUC 0.9697306156158447
Test Epoch42 layer4 Acc 0.9010526315789473, AUC 0.9702665209770203
gc 0
[[6.38911743e+02 3.54444031e+01]
 [1.98677141e-04 1.74127417e+01]
 [4.65962330e-04 1.36692432e+01]
 [8.72036042e-04 1.13876766e+01]
 [1.35663078e-03 9.91678807e+00]]
Train Epoch43 Acc 0.9682916666666667 (116195/120000), AUC 0.9965037107467651
Test Epoch43 layer0 Acc 0.9085526315789474, AUC 0.9785844087600708
Test Epoch43 layer1 Acc 0.9042105263157895, AUC 0.9736288189888
Test Epoch43 layer2 Acc 0.9038157894736842, AUC 0.9708279371261597
Test Epoch43 layer3 Acc 0.9030263157894737, AUC 0.9695937633514404
Test Epoch43 layer4 Acc 0.8997368421052632, AUC 0.9691981673240662
gc 0
[[6.38911743e+02 3.54407644e+01]
 [1.70915393e-04 1.73660451e+01]
 [3.78335672e-04 1.36539488e+01]
 [6.23736498e-04 1.13649473e+01]
 [8.64713188e-04 9.88767761e+00]]
Train Epoch44 Acc 0.96845 (116214/120000), AUC 0.9963898658752441
Test Epoch44 layer0 Acc 0.9085526315789474, AUC 0.9781814813613892
Test Epoch44 layer1 Acc 0.9051315789473684, AUC 0.9738055467605591
Test Epoch44 layer2 Acc 0.9052631578947369, AUC 0.9713138341903687
Test Epoch44 layer3 Acc 0.9026315789473685, AUC 0.9693796038627625
Test Epoch44 layer4 Acc 0.900921052631579, AUC 0.9684396982192993
gc 0
[[6.38911743e+02 3.53653329e+01]
 [2.21428861e-04 1.71761025e+01]
 [4.98682552e-04 1.34841114e+01]
 [9.13582925e-04 1.11862744e+01]
 [1.39689459e-03 9.71046902e+00]]
Train Epoch45 Acc 0.9691166666666666 (116294/120000), AUC 0.9964672923088074
Test Epoch45 layer0 Acc 0.9088157894736842, AUC 0.9785342216491699
Test Epoch45 layer1 Acc 0.9048684210526315, AUC 0.9744049310684204
Test Epoch45 layer2 Acc 0.9040789473684211, AUC 0.9722448587417603
Test Epoch45 layer3 Acc 0.8997368421052632, AUC 0.9695709347724915
Test Epoch45 layer4 Acc 0.8985526315789474, AUC 0.9687151908874512
gc 0
[[6.38911743e+02 3.53905847e+01]
 [1.89006065e-04 1.71275473e+01]
 [4.11057684e-04 1.34426006e+01]
 [6.82295282e-04 1.11312413e+01]
 [9.72209238e-04 9.64496208e+00]]
Train Epoch46 Acc 0.969475 (116337/120000), AUC 0.9964569211006165
Test Epoch46 layer0 Acc 0.9077631578947368, AUC 0.9780363440513611
Test Epoch46 layer1 Acc 0.9035526315789474, AUC 0.9730536341667175
Test Epoch46 layer2 Acc 0.9035526315789474, AUC 0.9711982011795044
Test Epoch46 layer3 Acc 0.9006578947368421, AUC 0.9693863391876221
Test Epoch46 layer4 Acc 0.8993421052631579, AUC 0.9686461687088013
gc 0
[[6.38911743e+02 3.53283020e+01]
 [1.81700306e-04 1.69941327e+01]
 [4.06348323e-04 1.33182175e+01]
 [6.73626215e-04 1.10097137e+01]
 [9.41460462e-04 9.52949961e+00]]
Train Epoch47 Acc 0.969675 (116361/120000), AUC 0.9965952634811401
Test Epoch47 layer0 Acc 0.9078947368421053, AUC 0.9785863757133484
Test Epoch47 layer1 Acc 0.9042105263157895, AUC 0.9737007021903992
Test Epoch47 layer2 Acc 0.9017105263157895, AUC 0.9699832201004028
Test Epoch47 layer3 Acc 0.8993421052631579, AUC 0.968454897403717
Test Epoch47 layer4 Acc 0.8981578947368422, AUC 0.9672536849975586
gc 0
[[6.38911743e+02 3.53247365e+01]
 [2.12705074e-04 1.69032167e+01]
 [4.60476226e-04 1.32668797e+01]
 [8.00292612e-04 1.09569318e+01]
 [1.17866626e-03 9.48842862e+00]]
Train Epoch48 Acc 0.9696416666666666 (116357/120000), AUC 0.9965956211090088
Test Epoch48 layer0 Acc 0.9069736842105263, AUC 0.9784389734268188
Test Epoch48 layer1 Acc 0.9044736842105263, AUC 0.9734147787094116
Test Epoch48 layer2 Acc 0.9028947368421053, AUC 0.9709801077842712
Test Epoch48 layer3 Acc 0.9002631578947369, AUC 0.967856764793396
Test Epoch48 layer4 Acc 0.8967105263157895, AUC 0.9651620388031006
gc 0
[[6.38911743e+02 3.52904162e+01]
 [2.10859842e-04 1.67960097e+01]
 [4.53221554e-04 1.31645030e+01]
 [7.68530265e-04 1.08504141e+01]
 [1.13520349e-03 9.35746580e+00]]
Train Epoch49 Acc 0.9700583333333334 (116407/120000), AUC 0.996711015701294
Test Epoch49 layer0 Acc 0.905, AUC 0.9783229827880859
Test Epoch49 layer1 Acc 0.9030263157894737, AUC 0.9735519886016846
Test Epoch49 layer2 Acc 0.9027631578947368, AUC 0.9713739156723022
Test Epoch49 layer3 Acc 0.9002631578947369, AUC 0.9688830971717834
Test Epoch49 layer4 Acc 0.8986842105263158, AUC 0.9687702655792236
Best AUC 0.9825136661529541
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt//ag_news/ag_news_linearal_l5.pt
[[1712   55   84   49]
 [  15 1864   10   11]
 [  46   17 1673  164]
 [  51   14  134 1701]]
Figure(640x480)
[[1707   57   85   51]
 [  13 1867   10   10]
 [  45   15 1674  166]
 [  52   14  136 1698]]
Figure(640x480)
[[1714   56   82   48]
 [  13 1866   10   11]
 [  48   16 1667  169]
 [  54   14  131 1701]]
Figure(640x480)
[[1712   56   82   50]
 [  14 1866    9   11]
 [  51   16 1669  164]
 [  54   13  136 1697]]
Figure(640x480)
[[1711   54   82   53]
 [  16 1858   13   13]
 [  48   10 1671  171]
 [  54   12  126 1708]]
Figure(640x480)
