total count words 222751
vocab size 30000
found 27937 words in glove
Load ckpt from ./ckpt/mask4//imdb/imdb_lstmal_l5_m4.pt
Start Training
gc 9
[[3.97284878e+01 1.03438443e+01]
 [9.40273468e-03 5.14353937e+00]
 [2.44201374e-02 3.97931021e+00]
 [4.38856373e-02 2.99404310e+00]
 [6.76174487e-01 2.88757058e+00]]
Train Epoch0 Acc 0.878475 (35139/40000), AUC 0.942693829536438
Test Epoch0 layer0 Acc 0.8582, AUC 0.9317511916160583
Save ckpt to ./ckpt/mask5//imdb/imdb_lstmal_l5_m5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.8711, AUC 0.940016508102417
Save ckpt to ./ckpt/mask5//imdb/imdb_lstmal_l5_m5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.8713, AUC 0.9393579959869385
Test Epoch0 layer3 Acc 0.8715, AUC 0.9387302398681641
Test Epoch0 layer4 Acc 0.8699, AUC 0.9386423230171204
gc 0
[[3.97284878e+01 9.68521812e+00]
 [6.48750448e-04 4.54670468e+00]
 [4.29087015e-04 3.49438534e+00]
 [3.72101593e-04 2.58260992e+00]
 [3.05550885e-04 2.14145784e+00]]
Train Epoch1 Acc 0.899675 (35987/40000), AUC 0.9566054344177246
Test Epoch1 layer0 Acc 0.8384, AUC 0.9188635349273682
Test Epoch1 layer1 Acc 0.8469, AUC 0.9267444610595703
Test Epoch1 layer2 Acc 0.8465, AUC 0.9257587790489197
Test Epoch1 layer3 Acc 0.844, AUC 0.925309956073761
Test Epoch1 layer4 Acc 0.8456, AUC 0.9247668981552124
gc 0
[[3.97284878e+01 9.16171572e+00]
 [1.29417043e-03 4.05782145e+00]
 [1.02689047e-03 3.10968262e+00]
 [9.00864332e-04 2.29929642e+00]
 [6.93264107e-04 1.89135132e+00]]
Train Epoch2 Acc 0.910725 (36429/40000), AUC 0.9644359350204468
Test Epoch2 layer0 Acc 0.8294, AUC 0.9070643186569214
Test Epoch2 layer1 Acc 0.8345, AUC 0.9116848111152649
Test Epoch2 layer2 Acc 0.8349, AUC 0.9120500683784485
Test Epoch2 layer3 Acc 0.8343, AUC 0.9085898399353027
Test Epoch2 layer4 Acc 0.8336, AUC 0.907239556312561
gc 0
[[3.97284878e+01 8.66434323e+00]
 [1.29083804e-03 3.60025349e+00]
 [1.19482305e-03 2.74708849e+00]
 [1.07469803e-03 2.03237395e+00]
 [8.86591070e-04 1.67201326e+00]]
Train Epoch3 Acc 0.923225 (36929/40000), AUC 0.9687134027481079
Test Epoch3 layer0 Acc 0.8153, AUC 0.8965080380439758
Test Epoch3 layer1 Acc 0.8184, AUC 0.8974461555480957
Test Epoch3 layer2 Acc 0.8184, AUC 0.8969610929489136
Test Epoch3 layer3 Acc 0.8196, AUC 0.8942432403564453
Test Epoch3 layer4 Acc 0.819, AUC 0.89165198802948
gc 0
[[3.97284878e+01 8.31413800e+00]
 [1.87429170e-03 3.24185392e+00]
 [1.91270556e-03 2.45205839e+00]
 [1.89895924e-03 1.80442490e+00]
 [1.39027177e-03 1.49351077e+00]]
Train Epoch4 Acc 0.9317 (37268/40000), AUC 0.9726309776306152
Test Epoch4 layer0 Acc 0.8019, AUC 0.8857852220535278
Test Epoch4 layer1 Acc 0.8072, AUC 0.889456033706665
Test Epoch4 layer2 Acc 0.8068, AUC 0.8892112970352173
Test Epoch4 layer3 Acc 0.8059, AUC 0.8831297159194946
Test Epoch4 layer4 Acc 0.807, AUC 0.8761571645736694
gc 0
[[3.97284878e+01 7.53138941e+00]
 [4.31045837e-06 2.46010486e+00]
 [2.17357650e-05 1.81641710e+00]
 [2.77499221e-05 1.31959806e+00]
 [2.20424964e-05 1.09297743e+00]]
Train Epoch5 Acc 0.948475 (37939/40000), AUC 0.9799382090568542
Test Epoch5 layer0 Acc 0.8014, AUC 0.8808786869049072
Test Epoch5 layer1 Acc 0.8065, AUC 0.8791403770446777
Test Epoch5 layer2 Acc 0.8072, AUC 0.8766635060310364
Test Epoch5 layer3 Acc 0.8063, AUC 0.877377986907959
Test Epoch5 layer4 Acc 0.8061, AUC 0.865018367767334
gc 0
[[3.97284878e+01 7.37042700e+00]
 [4.33553232e-12 2.22902092e+00]
 [2.33967059e-11 1.63887087e+00]
 [9.22200302e-11 1.18737731e+00]
 [1.05355346e-10 9.88095593e-01]]
Train Epoch6 Acc 0.954475 (38179/40000), AUC 0.9828969240188599
Test Epoch6 layer0 Acc 0.7961, AUC 0.8753448128700256
Test Epoch6 layer1 Acc 0.7985, AUC 0.871244490146637
Test Epoch6 layer2 Acc 0.7988, AUC 0.8712791204452515
Test Epoch6 layer3 Acc 0.798, AUC 0.8667551279067993
Test Epoch6 layer4 Acc 0.7986, AUC 0.8584616184234619
gc 0
[[3.97284878e+01 7.21859358e+00]
 [1.19540078e-11 2.04211338e+00]
 [5.37404005e-11 1.49458457e+00]
 [2.03004332e-10 1.08292648e+00]
 [2.14593978e-10 9.03185749e-01]]
Train Epoch7 Acc 0.959725 (38389/40000), AUC 0.985343337059021
Test Epoch7 layer0 Acc 0.7888, AUC 0.8708140850067139
Test Epoch7 layer1 Acc 0.7893, AUC 0.8577580451965332
Test Epoch7 layer2 Acc 0.7903, AUC 0.8560833930969238
Test Epoch7 layer3 Acc 0.7886, AUC 0.8564796447753906
Test Epoch7 layer4 Acc 0.7896, AUC 0.8385957479476929
gc 0
[[3.97284878e+01 7.08793908e+00]
 [7.77678862e-11 1.83797116e+00]
 [1.80030083e-10 1.33471952e+00]
 [5.08160973e-10 9.65119096e-01]
 [4.71595393e-10 8.06313621e-01]]
Train Epoch8 Acc 0.964725 (38589/40000), AUC 0.9870413541793823
Test Epoch8 layer0 Acc 0.7864, AUC 0.8656264543533325
Test Epoch8 layer1 Acc 0.7886, AUC 0.8494675159454346
Test Epoch8 layer2 Acc 0.7878, AUC 0.8460474610328674
Test Epoch8 layer3 Acc 0.7878, AUC 0.848981499671936
Test Epoch8 layer4 Acc 0.7883, AUC 0.8291976451873779
gc 0
[[3.97284878e+01 6.70925239e+00]
 [4.29977541e-12 1.46733745e+00]
 [1.88012382e-11 1.06061759e+00]
 [8.19278108e-11 7.61029553e-01]
 [8.41290236e-11 6.31060441e-01]]
Train Epoch9 Acc 0.971825 (38873/40000), AUC 0.9907964468002319
Test Epoch9 layer0 Acc 0.7859, AUC 0.8632221817970276
Test Epoch9 layer1 Acc 0.7879, AUC 0.8456583619117737
Test Epoch9 layer2 Acc 0.7884, AUC 0.8440735340118408
Test Epoch9 layer3 Acc 0.7894, AUC 0.8408247232437134
Test Epoch9 layer4 Acc 0.7896, AUC 0.8275637626647949
Best AUC 0.940016508102417
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//imdb/imdb_lstmal_l5_m5.pt
[[4438  571]
 [ 847 4144]]
Figure(640x480)
[[4414  595]
 [ 694 4297]]
Figure(640x480)
[[4420  589]
 [ 698 4293]]
Figure(640x480)
[[4374  635]
 [ 650 4341]]
Figure(640x480)
[[4394  615]
 [ 686 4305]]
Figure(640x480)
