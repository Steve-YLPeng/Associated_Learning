total count words 222751
vocab size 30000
found 27937 words in glove
Load ckpt from ./ckpt/mask1//imdb/imdb_lstmal_l5_m1.pt
Start Training
gc 9
[[39.74035028  7.48254658]
 [ 1.64513996  7.30305719]
 [68.40698896 36.35372443]
 [53.60957599 24.23158561]
 [43.79457182 21.33805914]]
Train Epoch0 Acc 0.5 (20000/40000), AUC 0.21693018078804016
Test Epoch0 layer0 Acc 0.8289, AUC 0.9128960371017456
Save ckpt to ./ckpt/mask2//imdb/imdb_lstmal_l5_m2.pt  ,ep 0
Test Epoch0 layer1 Acc 0.8197, AUC 0.9116990566253662
Test Epoch0 layer2 Acc 0.4014, AUC 0.10253526270389557
Test Epoch0 layer3 Acc 0.5, AUC 0.3559916019439697
Test Epoch0 layer4 Acc 0.5, AUC 0.10555457323789597
gc 0
[[3.97290072e+01 8.02956201e+00]
 [6.57691512e-07 4.99743518e+00]
 [6.73445131e+01 3.57029011e+01]
 [5.26318102e+01 2.44523857e+01]
 [4.43964664e+01 2.16855207e+01]]
Train Epoch1 Acc 0.5 (20000/40000), AUC 0.0771610364317894
Test Epoch1 layer0 Acc 0.8176, AUC 0.9010509848594666
Test Epoch1 layer1 Acc 0.8245, AUC 0.902824878692627
Test Epoch1 layer2 Acc 0.3958, AUC 0.10667185485363007
Test Epoch1 layer3 Acc 0.5, AUC 0.2977295219898224
Test Epoch1 layer4 Acc 0.5, AUC 0.11719675362110138
gc 0
[[3.97286722e+01 7.90597376e+00]
 [1.27086107e-07 4.56142645e+00]
 [6.73851907e+01 3.56873646e+01]
 [5.23556762e+01 2.46918037e+01]
 [4.47970703e+01 2.19475830e+01]]
Train Epoch2 Acc 0.5 (20000/40000), AUC 0.06066426634788513
Test Epoch2 layer0 Acc 0.8096, AUC 0.8886936902999878
Test Epoch2 layer1 Acc 0.8075, AUC 0.8882839679718018
Test Epoch2 layer2 Acc 0.4178, AUC 0.12264460325241089
Test Epoch2 layer3 Acc 0.5, AUC 0.2721810042858124
Test Epoch2 layer4 Acc 0.5, AUC 0.13376668095588684
gc 0
[[3.97285759e+01 7.71560612e+00]
 [3.82628611e-08 4.26414171e+00]
 [6.74670620e+01 3.59718458e+01]
 [5.21922767e+01 2.48751103e+01]
 [4.51161095e+01 2.21410617e+01]]
Train Epoch3 Acc 0.5 (20000/40000), AUC 0.05199921876192093
Test Epoch3 layer0 Acc 0.7962, AUC 0.8793127536773682
Test Epoch3 layer1 Acc 0.786, AUC 0.8745302557945251
Test Epoch3 layer2 Acc 0.4662, AUC 0.14214414358139038
Test Epoch3 layer3 Acc 0.5, AUC 0.360382616519928
Test Epoch3 layer4 Acc 0.5, AUC 0.14727213978767395
gc 0
[[3.97285262e+01 7.52039998e+00]
 [1.59271541e-08 3.98370842e+00]
 [6.75598707e+01 3.63616941e+01]
 [5.20859888e+01 2.50266517e+01]
 [4.53900592e+01 2.23128185e+01]]
Train Epoch4 Acc 0.5 (20000/40000), AUC 0.04575488716363907
Test Epoch4 layer0 Acc 0.7883, AUC 0.8685321807861328
Test Epoch4 layer1 Acc 0.7892, AUC 0.8656822443008423
Test Epoch4 layer2 Acc 0.4676, AUC 0.14673563838005066
Test Epoch4 layer3 Acc 0.5, AUC 0.2893691658973694
Test Epoch4 layer4 Acc 0.5, AUC 0.15873250365257263
gc 0
[[3.97284972e+01 6.91398573e+00]
 [7.50772651e-09 3.35934659e+00]
 [6.76304655e+01 3.66530669e+01]
 [5.20290831e+01 2.51965825e+01]
 [4.55769647e+01 2.24298892e+01]]
Train Epoch5 Acc 0.5 (20000/40000), AUC 0.037561651319265366
Test Epoch5 layer0 Acc 0.787, AUC 0.8638733625411987
Test Epoch5 layer1 Acc 0.7822, AUC 0.8583532571792603
Test Epoch5 layer2 Acc 0.4858, AUC 0.153224378824234
Test Epoch5 layer3 Acc 0.5, AUC 0.3266516923904419
Test Epoch5 layer4 Acc 0.5, AUC 0.16602109372615814
gc 0
[[3.97284972e+01 6.78944208e+00]
 [5.59569220e-09 3.18181576e+00]
 [6.76819468e+01 3.68798940e+01]
 [5.19961168e+01 2.53695847e+01]
 [4.57018239e+01 2.25092099e+01]]
Train Epoch6 Acc 0.5 (20000/40000), AUC 0.036131955683231354
Test Epoch6 layer0 Acc 0.7811, AUC 0.8583886623382568
Test Epoch6 layer1 Acc 0.7799, AUC 0.8546886444091797
Test Epoch6 layer2 Acc 0.4885, AUC 0.15474329888820648
Test Epoch6 layer3 Acc 0.5, AUC 0.3062626123428345
Test Epoch6 layer4 Acc 0.5, AUC 0.1703135371208191
gc 0
[[3.97284972e+01 6.69195814e+00]
 [3.35722735e-09 3.04351091e+00]
 [6.77372959e+01 3.71113511e+01]
 [5.19690642e+01 2.55866030e+01]
 [4.58297034e+01 2.26086839e+01]]
Train Epoch7 Acc 0.5 (20000/40000), AUC 0.03490099310874939
Test Epoch7 layer0 Acc 0.7771, AUC 0.8535816669464111
Test Epoch7 layer1 Acc 0.7768, AUC 0.8478726148605347
Test Epoch7 layer2 Acc 0.4924, AUC 0.15998178720474243
Test Epoch7 layer3 Acc 0.5, AUC 0.3416496217250824
Test Epoch7 layer4 Acc 0.5, AUC 0.177714005112648
gc 0
[[3.97284972e+01 6.61224598e+00]
 [2.44293170e-09 2.90295398e+00]
 [6.77956231e+01 3.73338226e+01]
 [5.19458777e+01 2.57713407e+01]
 [4.59588288e+01 2.26877740e+01]]
Train Epoch8 Acc 0.5 (20000/40000), AUC 0.03671731799840927
Test Epoch8 layer0 Acc 0.7705, AUC 0.8490967154502869
Test Epoch8 layer1 Acc 0.7662, AUC 0.8374391794204712
Test Epoch8 layer2 Acc 0.4954, AUC 0.1719643473625183
Test Epoch8 layer3 Acc 0.5, AUC 0.40523821115493774
Test Epoch8 layer4 Acc 0.5, AUC 0.18922990560531616
gc 0
[[3.97284896e+01 6.31359070e+00]
 [1.67194852e-09 2.56257604e+00]
 [6.78434580e+01 3.75452098e+01]
 [5.19317597e+01 2.59627634e+01]
 [4.60594094e+01 2.27512364e+01]]
Train Epoch9 Acc 0.5 (20000/40000), AUC 0.03596320003271103
Test Epoch9 layer0 Acc 0.77, AUC 0.8469372987747192
Test Epoch9 layer1 Acc 0.7688, AUC 0.837308943271637
Test Epoch9 layer2 Acc 0.4974, AUC 0.16919353604316711
Test Epoch9 layer3 Acc 0.5, AUC 0.3754783868789673
Test Epoch9 layer4 Acc 0.5, AUC 0.19285988807678223
Best AUC 0.9128960371017456
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//imdb/imdb_lstmal_l5_m2.pt
[[3895 1105]
 [ 606 4394]]
Figure(640x480)
[[3626 1374]
 [ 429 4571]]
Figure(640x480)
[[3976 1024]
 [4962   38]]
Figure(640x480)
[[5000    0]
 [5000    0]]
Figure(640x480)
[[5000    0]
 [5000    0]]
Figure(640x480)
