total count words 222751
vocab size 30000
found 27937 words in glove
Load ckpt from ./ckpt/mask4//imdb/imdb_lstmal_l5_m4.pt
Start Training
gc 9
[[3.97284878e+01 7.67653730e+00]
 [1.38067030e-04 6.62487233e+00]
 [4.13196269e-04 6.25196975e+00]
 [9.31569088e-04 6.17546972e+00]
 [1.13671785e+01 7.42095270e+00]]
Train Epoch0 Acc 0.907325 (36293/40000), AUC 0.949068546295166
Test Epoch0 layer0 Acc 0.9159, AUC 0.970403254032135
Save ckpt to ./ckpt/mask5//imdb/imdb_lstmal_l5_m5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9109, AUC 0.9674877524375916
Test Epoch0 layer2 Acc 0.909, AUC 0.9677256345748901
Test Epoch0 layer3 Acc 0.9082, AUC 0.9671100378036499
Test Epoch0 layer4 Acc 0.904, AUC 0.9665142893791199
gc 0
[[3.97284878e+01 7.09461999e+00]
 [1.05269349e-05 5.67985790e+00]
 [7.97814763e-06 5.31588669e+00]
 [7.03984608e-06 5.22167856e+00]
 [1.18044552e-05 5.52170645e+00]]
Train Epoch1 Acc 0.9266 (37064/40000), AUC 0.9748579859733582
Test Epoch1 layer0 Acc 0.903, AUC 0.9630566835403442
Test Epoch1 layer1 Acc 0.8993, AUC 0.9594522714614868
Test Epoch1 layer2 Acc 0.8986, AUC 0.9598870277404785
Test Epoch1 layer3 Acc 0.8968, AUC 0.9595550298690796
Test Epoch1 layer4 Acc 0.8973, AUC 0.9594953060150146
gc 0
[[3.97284878e+01 6.62389791e+00]
 [3.27593454e-05 5.04953641e+00]
 [4.27385700e-05 4.70563234e+00]
 [4.14633087e-05 4.61769616e+00]
 [1.84830650e-05 4.86742605e+00]]
Train Epoch2 Acc 0.936975 (37479/40000), AUC 0.9800531268119812
Test Epoch2 layer0 Acc 0.8915, AUC 0.9564821720123291
Test Epoch2 layer1 Acc 0.8941, AUC 0.9544646143913269
Test Epoch2 layer2 Acc 0.8944, AUC 0.9541013836860657
Test Epoch2 layer3 Acc 0.8927, AUC 0.9539648294448853
Test Epoch2 layer4 Acc 0.8918, AUC 0.9523882865905762
gc 0
[[3.97284878e+01 6.22735393e+00]
 [5.71812903e-06 4.44771284e+00]
 [6.10590605e-06 4.10045029e+00]
 [6.73201171e-06 4.01598392e+00]
 [3.06688406e-06 4.21738109e+00]]
Train Epoch3 Acc 0.94595 (37838/40000), AUC 0.984299898147583
Test Epoch3 layer0 Acc 0.8779, AUC 0.9490423202514648
Test Epoch3 layer1 Acc 0.8754, AUC 0.94239741563797
Test Epoch3 layer2 Acc 0.8742, AUC 0.9440041780471802
Test Epoch3 layer3 Acc 0.8748, AUC 0.9437249898910522
Test Epoch3 layer4 Acc 0.8743, AUC 0.9439224004745483
gc 0
[[3.97284878e+01 5.91538461e+00]
 [1.63886233e-05 4.07598596e+00]
 [2.32776138e-05 3.76451868e+00]
 [2.76717276e-05 3.69004013e+00]
 [1.11568549e-05 3.87832043e+00]]
Train Epoch4 Acc 0.951175 (38047/40000), AUC 0.9864726066589355
Test Epoch4 layer0 Acc 0.871, AUC 0.942418098449707
Test Epoch4 layer1 Acc 0.8695, AUC 0.936847448348999
Test Epoch4 layer2 Acc 0.8688, AUC 0.9367979764938354
Test Epoch4 layer3 Acc 0.8687, AUC 0.937650203704834
Test Epoch4 layer4 Acc 0.8686, AUC 0.936890184879303
gc 0
[[3.97284878e+01 5.31381297e+00]
 [2.60225329e-10 3.21165510e+00]
 [7.37078108e-10 2.88760381e+00]
 [1.57858330e-09 2.82092991e+00]
 [5.15486324e-10 2.94635211e+00]]
Train Epoch5 Acc 0.9616 (38464/40000), AUC 0.9910193681716919
Test Epoch5 layer0 Acc 0.8672, AUC 0.9389998912811279
Test Epoch5 layer1 Acc 0.8659, AUC 0.9362045526504517
Test Epoch5 layer2 Acc 0.8668, AUC 0.934823751449585
Test Epoch5 layer3 Acc 0.8666, AUC 0.9350963830947876
Test Epoch5 layer4 Acc 0.8663, AUC 0.9343881607055664
gc 0
[[3.97284878e+01 5.17897112e+00]
 [8.62789126e-12 3.06083539e+00]
 [4.93194153e-11 2.74982341e+00]
 [2.33042262e-10 2.68464814e+00]
 [7.85544515e-11 2.80603911e+00]]
Train Epoch6 Acc 0.96345 (38538/40000), AUC 0.9918680191040039
Test Epoch6 layer0 Acc 0.8595, AUC 0.9354171752929688
Test Epoch6 layer1 Acc 0.8586, AUC 0.9310684204101562
Test Epoch6 layer2 Acc 0.8585, AUC 0.9295423030853271
Test Epoch6 layer3 Acc 0.8577, AUC 0.9300675392150879
Test Epoch6 layer4 Acc 0.8564, AUC 0.9294826984405518
gc 0
[[3.97284878e+01 5.05256010e+00]
 [1.97714806e-11 2.88127466e+00]
 [1.11678682e-10 2.58211173e+00]
 [5.65982700e-10 2.51809810e+00]
 [1.80590936e-10 2.62935544e+00]]
Train Epoch7 Acc 0.9656 (38624/40000), AUC 0.9928863048553467
Test Epoch7 layer0 Acc 0.8577, AUC 0.931916356086731
Test Epoch7 layer1 Acc 0.8564, AUC 0.9249430894851685
Test Epoch7 layer2 Acc 0.857, AUC 0.9244461059570312
Test Epoch7 layer3 Acc 0.8569, AUC 0.9237990379333496
Test Epoch7 layer4 Acc 0.8575, AUC 0.9232028722763062
gc 0
[[3.97284878e+01 4.94489086e+00]
 [1.09228135e-10 2.72580191e+00]
 [3.05872360e-10 2.44671568e+00]
 [1.23950844e-09 2.38445882e+00]
 [3.96379533e-10 2.49193238e+00]]
Train Epoch8 Acc 0.967875 (38715/40000), AUC 0.9934424161911011
Test Epoch8 layer0 Acc 0.8539, AUC 0.9288541078567505
Test Epoch8 layer1 Acc 0.8451, AUC 0.9204176664352417
Test Epoch8 layer2 Acc 0.8443, AUC 0.9189102649688721
Test Epoch8 layer3 Acc 0.8448, AUC 0.9209854602813721
Test Epoch8 layer4 Acc 0.8434, AUC 0.9186519384384155
gc 0
[[3.97284878e+01 4.66742227e+00]
 [2.05487606e-11 2.41884609e+00]
 [5.24585134e-11 2.14519669e+00]
 [1.98049858e-10 2.08740694e+00]
 [7.33381286e-11 2.17885490e+00]]
Train Epoch9 Acc 0.97145 (38858/40000), AUC 0.994543194770813
Test Epoch9 layer0 Acc 0.8519, AUC 0.9269570112228394
Test Epoch9 layer1 Acc 0.8499, AUC 0.9194372892379761
Test Epoch9 layer2 Acc 0.8518, AUC 0.9178813099861145
Test Epoch9 layer3 Acc 0.8526, AUC 0.9177795648574829
Test Epoch9 layer4 Acc 0.8522, AUC 0.9168634414672852
Best AUC 0.970403254032135
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//imdb/imdb_lstmal_l5_m5.pt
[[4554  439]
 [ 402 4605]]
Figure(640x480)
[[4439  554]
 [ 337 4670]]
Figure(640x480)
[[4416  577]
 [ 333 4674]]
Figure(640x480)
[[4403  590]
 [ 328 4679]]
Figure(640x480)
[[4360  633]
 [ 327 4680]]
Figure(640x480)
