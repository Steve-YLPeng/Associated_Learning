total count words 222751
vocab size 30000
found 27937 words in glove
Load ckpt from ./ckpt/mask3//imdb/imdb_lstmal_l5_m3.pt
Start Training
gc 9
[[3.97284878e+01 8.01637243e+00]
 [2.18315660e-04 7.36870561e+00]
 [4.16381649e-04 6.99426931e+00]
 [1.30842642e+01 6.75682566e+00]
 [6.84882341e+01 3.97116467e+01]]
Train Epoch0 Acc 0.7874 (31496/40000), AUC 0.925826907157898
Test Epoch0 layer0 Acc 0.9026, AUC 0.9648541212081909
Save ckpt to ./ckpt/mask4//imdb/imdb_lstmal_l5_m4.pt  ,ep 0
Test Epoch0 layer1 Acc 0.902, AUC 0.960250198841095
Test Epoch0 layer2 Acc 0.9006, AUC 0.9598702788352966
Test Epoch0 layer3 Acc 0.899, AUC 0.9588112831115723
Test Epoch0 layer4 Acc 0.8706, AUC 0.945400595664978
gc 0
[[3.97284878e+01 7.34899516e+00]
 [6.82478086e-07 6.23373024e+00]
 [1.00588459e-06 5.85375488e+00]
 [1.66891833e-05 5.78154541e+00]
 [8.31348888e+01 4.67014865e+01]]
Train Epoch1 Acc 0.901025 (36041/40000), AUC 0.9604061841964722
Test Epoch1 layer0 Acc 0.8946, AUC 0.9578953385353088
Test Epoch1 layer1 Acc 0.8921, AUC 0.9519622921943665
Test Epoch1 layer2 Acc 0.8908, AUC 0.951543927192688
Test Epoch1 layer3 Acc 0.8891, AUC 0.951242208480835
Test Epoch1 layer4 Acc 0.8817, AUC 0.9379459619522095
gc 0
[[3.97284878e+01 6.81069975e+00]
 [7.95365482e-06 5.33852120e+00]
 [1.85494554e-05 4.96528802e+00]
 [6.23694066e-06 4.88185586e+00]
 [8.31396608e+01 4.65308062e+01]]
Train Epoch2 Acc 0.923925 (36957/40000), AUC 0.9723305702209473
Test Epoch2 layer0 Acc 0.8809, AUC 0.9501498937606812
Test Epoch2 layer1 Acc 0.8811, AUC 0.9465799331665039
Test Epoch2 layer2 Acc 0.8794, AUC 0.946365475654602
Test Epoch2 layer3 Acc 0.8792, AUC 0.9457591772079468
Test Epoch2 layer4 Acc 0.8587, AUC 0.9331051111221313
gc 0
[[3.97284878e+01 6.42126527e+00]
 [9.92624672e-06 4.81057328e+00]
 [2.27369053e-05 4.45578155e+00]
 [7.54855009e-06 4.37903245e+00]
 [8.31335637e+01 4.63832370e+01]]
Train Epoch3 Acc 0.93325 (37330/40000), AUC 0.977199375629425
Test Epoch3 layer0 Acc 0.8719, AUC 0.9437511563301086
Test Epoch3 layer1 Acc 0.8719, AUC 0.9376357197761536
Test Epoch3 layer2 Acc 0.8708, AUC 0.937476634979248
Test Epoch3 layer3 Acc 0.8699, AUC 0.9374045133590698
Test Epoch3 layer4 Acc 0.8638, AUC 0.9239429831504822
gc 0
[[3.97284878e+01 6.03366420e+00]
 [2.53262983e-05 4.22348874e+00]
 [5.35698339e-05 3.86815124e+00]
 [1.64366746e-05 3.80085252e+00]
 [8.31160598e+01 4.63384916e+01]]
Train Epoch4 Acc 0.944225 (37769/40000), AUC 0.9815983772277832
Test Epoch4 layer0 Acc 0.8618, AUC 0.9364429712295532
Test Epoch4 layer1 Acc 0.8534, AUC 0.9280256032943726
Test Epoch4 layer2 Acc 0.8517, AUC 0.9278528690338135
Test Epoch4 layer3 Acc 0.8511, AUC 0.9282810688018799
Test Epoch4 layer4 Acc 0.8522, AUC 0.9150999784469604
gc 0
[[3.97284878e+01 5.42075709e+00]
 [8.98526863e-09 3.39979305e+00]
 [8.29641086e-08 3.05417051e+00]
 [2.03871089e-08 2.99150315e+00]
 [8.31045359e+01 4.63829511e+01]]
Train Epoch5 Acc 0.95465 (38186/40000), AUC 0.9869834184646606
Test Epoch5 layer0 Acc 0.8585, AUC 0.9337253570556641
Test Epoch5 layer1 Acc 0.8557, AUC 0.9282958507537842
Test Epoch5 layer2 Acc 0.8553, AUC 0.9273380041122437
Test Epoch5 layer3 Acc 0.8544, AUC 0.9278842210769653
Test Epoch5 layer4 Acc 0.8529, AUC 0.9154081344604492
gc 0
[[3.97284878e+01 5.27262882e+00]
 [5.23696196e-12 3.17068637e+00]
 [2.53900630e-11 2.83238811e+00]
 [1.06524072e-11 2.77306642e+00]
 [8.31071986e+01 4.64003910e+01]]
Train Epoch6 Acc 0.957875 (38315/40000), AUC 0.9886620044708252
Test Epoch6 layer0 Acc 0.8549, AUC 0.9299069046974182
Test Epoch6 layer1 Acc 0.8543, AUC 0.9259284734725952
Test Epoch6 layer2 Acc 0.8532, AUC 0.9248987436294556
Test Epoch6 layer3 Acc 0.8529, AUC 0.9247528314590454
Test Epoch6 layer4 Acc 0.8468, AUC 0.9131488800048828
gc 0
[[3.97284878e+01 5.13440012e+00]
 [1.16180524e-11 3.04142832e+00]
 [6.82699900e-11 2.71145220e+00]
 [2.14501026e-11 2.65449717e+00]
 [8.31036476e+01 4.64147714e+01]]
Train Epoch7 Acc 0.9596 (38384/40000), AUC 0.9888604283332825
Test Epoch7 layer0 Acc 0.8511, AUC 0.9267550706863403
Test Epoch7 layer1 Acc 0.8463, AUC 0.9207178950309753
Test Epoch7 layer2 Acc 0.8459, AUC 0.9195930361747742
Test Epoch7 layer3 Acc 0.8461, AUC 0.9206008911132812
Test Epoch7 layer4 Acc 0.8337, AUC 0.9019709825515747
gc 0
[[3.97284878e+01 5.02554809e+00]
 [2.62411132e-11 2.91607908e+00]
 [1.31201694e-10 2.60237099e+00]
 [3.81948922e-11 2.54637181e+00]
 [8.31071795e+01 4.64161950e+01]]
Train Epoch8 Acc 0.96155 (38462/40000), AUC 0.9893653392791748
Test Epoch8 layer0 Acc 0.8474, AUC 0.923138439655304
Test Epoch8 layer1 Acc 0.8426, AUC 0.9160890579223633
Test Epoch8 layer2 Acc 0.8428, AUC 0.9145205020904541
Test Epoch8 layer3 Acc 0.8425, AUC 0.9153401851654053
Test Epoch8 layer4 Acc 0.8396, AUC 0.898647129535675
gc 0
[[3.97284878e+01 4.71690655e+00]
 [4.42309791e-12 2.49643045e+00]
 [1.75193201e-11 2.18667758e+00]
 [8.36202301e-12 2.13209877e+00]
 [8.31014211e+01 4.64692867e+01]]
Train Epoch9 Acc 0.967025 (38681/40000), AUC 0.9914907217025757
Test Epoch9 layer0 Acc 0.8447, AUC 0.9215807914733887
Test Epoch9 layer1 Acc 0.8392, AUC 0.9117973446846008
Test Epoch9 layer2 Acc 0.8385, AUC 0.9110898971557617
Test Epoch9 layer3 Acc 0.8385, AUC 0.9113970398902893
Test Epoch9 layer4 Acc 0.8312, AUC 0.8903442621231079
Best AUC 0.9648541212081909
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//imdb/imdb_lstmal_l5_m4.pt
[[4395  547]
 [ 427 4631]]
Figure(640x480)
[[4401  541]
 [ 439 4619]]
Figure(640x480)
[[4397  545]
 [ 449 4609]]
Figure(640x480)
[[4406  536]
 [ 474 4584]]
Figure(640x480)
[[3898 1044]
 [ 250 4808]]
Figure(640x480)
