total count words 222751
vocab size 30000
found 27937 words in glove
Load ckpt from ./ckpt/mask1//imdb/imdb_lstmal_l5_m1.pt
Start Training
gc 9
[[39.74056578  5.6703621 ]
 [15.58171169 11.80721482]
 [78.56753954 42.90891638]
 [58.56978422 25.24386682]
 [46.94281198 23.02251858]]
Train Epoch0 Acc 0.4895 (19580/40000), AUC 0.4393220543861389
Test Epoch0 layer0 Acc 0.8901, AUC 0.9560755491256714
Save ckpt to ./ckpt/mask2//imdb/imdb_lstmal_l5_m2.pt  ,ep 0
Test Epoch0 layer1 Acc 0.8739, AUC 0.9377306699752808
Test Epoch0 layer2 Acc 0.4652, AUC 0.3950989246368408
Test Epoch0 layer3 Acc 0.4969, AUC 0.6668790578842163
Test Epoch0 layer4 Acc 0.4591, AUC 0.332383394241333
gc 0
[[3.97290065e+01 6.07687644e+00]
 [9.39584880e-04 6.51926722e+00]
 [8.70526236e+01 4.90078004e+01]
 [6.18663037e+01 2.73705119e+01]
 [5.01171803e+01 2.41956026e+01]]
Train Epoch1 Acc 0.473575 (18943/40000), AUC 0.358293354511261
Test Epoch1 layer0 Acc 0.8826, AUC 0.9512693881988525
Test Epoch1 layer1 Acc 0.8682, AUC 0.9400107860565186
Test Epoch1 layer2 Acc 0.4774, AUC 0.45779770612716675
Test Epoch1 layer3 Acc 0.497, AUC 0.7582775950431824
Test Epoch1 layer4 Acc 0.4671, AUC 0.3686847984790802
gc 0
[[3.97286704e+01 5.90685670e+00]
 [8.66228682e-05 5.43640407e+00]
 [8.67023036e+01 4.95115310e+01]
 [6.18867819e+01 2.76375160e+01]
 [5.01007572e+01 2.43904208e+01]]
Train Epoch2 Acc 0.479375 (19175/40000), AUC 0.4137989580631256
Test Epoch2 layer0 Acc 0.8752, AUC 0.9447599649429321
Test Epoch2 layer1 Acc 0.8636, AUC 0.9378479719161987
Test Epoch2 layer2 Acc 0.4895, AUC 0.48029807209968567
Test Epoch2 layer3 Acc 0.497, AUC 0.817266047000885
Test Epoch2 layer4 Acc 0.4717, AUC 0.3976033926010132
gc 0
[[3.97285736e+01 5.68175558e+00]
 [3.04589349e-05 4.75100132e+00]
 [8.64885176e+01 5.00232389e+01]
 [6.19199210e+01 2.78496295e+01]
 [5.01145382e+01 2.45421060e+01]]
Train Epoch3 Acc 0.494875 (19795/40000), AUC 0.48376011848449707
Test Epoch3 layer0 Acc 0.8647, AUC 0.9383022785186768
Test Epoch3 layer1 Acc 0.8589, AUC 0.9337524175643921
Test Epoch3 layer2 Acc 0.5116, AUC 0.49246060848236084
Test Epoch3 layer3 Acc 0.4971, AUC 0.7974932193756104
Test Epoch3 layer4 Acc 0.4914, AUC 0.49949294328689575
gc 0
[[3.97285202e+01 5.51937903e+00]
 [1.31863889e-05 4.36534142e+00]
 [8.63674887e+01 5.01111271e+01]
 [6.19645718e+01 2.79755057e+01]
 [5.01470665e+01 2.46022666e+01]]
Train Epoch4 Acc 0.52295 (20918/40000), AUC 0.5438368320465088
Test Epoch4 layer0 Acc 0.859, AUC 0.9328440427780151
Test Epoch4 layer1 Acc 0.8527, AUC 0.9280062913894653
Test Epoch4 layer2 Acc 0.5365, AUC 0.5032086968421936
Test Epoch4 layer3 Acc 0.4971, AUC 0.8188819885253906
Test Epoch4 layer4 Acc 0.5354, AUC 0.5568397045135498
gc 0
[[3.97284972e+01 5.01273723e+00]
 [1.94971050e-06 3.64874543e+00]
 [8.63184159e+01 5.03677427e+01]
 [6.20051322e+01 2.81183939e+01]
 [5.01754764e+01 2.46888411e+01]]
Train Epoch5 Acc 0.577325 (23093/40000), AUC 0.6093636751174927
Test Epoch5 layer0 Acc 0.855, AUC 0.9290295839309692
Test Epoch5 layer1 Acc 0.8487, AUC 0.9236049056053162
Test Epoch5 layer2 Acc 0.5704, AUC 0.5137684941291809
Test Epoch5 layer3 Acc 0.4971, AUC 0.8235349655151367
Test Epoch5 layer4 Acc 0.5537, AUC 0.571932315826416
gc 0
[[3.97284972e+01 4.90368773e+00]
 [4.74195552e-06 3.29679001e+00]
 [8.62983982e+01 5.05057436e+01]
 [6.20373019e+01 2.82076830e+01]
 [5.01973560e+01 2.47558011e+01]]
Train Epoch6 Acc 0.612625 (24505/40000), AUC 0.6312688589096069
Test Epoch6 layer0 Acc 0.8511, AUC 0.9251730442047119
Test Epoch6 layer1 Acc 0.8425, AUC 0.9193665981292725
Test Epoch6 layer2 Acc 0.6005, AUC 0.5291687250137329
Test Epoch6 layer3 Acc 0.4971, AUC 0.8376294374465942
Test Epoch6 layer4 Acc 0.5642, AUC 0.555441677570343
gc 0
[[3.97284972e+01 4.84161890e+00]
 [3.43921808e-06 3.17146214e+00]
 [8.62888825e+01 5.05860044e+01]
 [6.20730045e+01 2.82656325e+01]
 [5.02231392e+01 2.47899623e+01]]
Train Epoch7 Acc 0.63785 (25514/40000), AUC 0.6485553979873657
Test Epoch7 layer0 Acc 0.8456, AUC 0.9213823080062866
Test Epoch7 layer1 Acc 0.8351, AUC 0.9149595499038696
Test Epoch7 layer2 Acc 0.6283, AUC 0.5418022871017456
Test Epoch7 layer3 Acc 0.4971, AUC 0.8393228054046631
Test Epoch7 layer4 Acc 0.5732, AUC 0.554404079914093
gc 0
[[3.97284948e+01 4.75830672e+00]
 [2.28422268e-06 3.02324850e+00]
 [8.62874446e+01 5.06453763e+01]
 [6.21112610e+01 2.83408057e+01]
 [5.02495277e+01 2.48371403e+01]]
Train Epoch8 Acc 0.672775 (26911/40000), AUC 0.6714839935302734
Test Epoch8 layer0 Acc 0.8416, AUC 0.9177922010421753
Test Epoch8 layer1 Acc 0.8277, AUC 0.9109896421432495
Test Epoch8 layer2 Acc 0.6065, AUC 0.5220942497253418
Test Epoch8 layer3 Acc 0.4971, AUC 0.7998226284980774
Test Epoch8 layer4 Acc 0.6612, AUC 0.6448630094528198
gc 0
[[3.97284878e+01 4.50796440e+00]
 [4.20493310e-07 2.69723713e+00]
 [8.62968927e+01 5.07937458e+01]
 [6.21436151e+01 2.83979832e+01]
 [5.02729544e+01 2.48853051e+01]]
Train Epoch9 Acc 0.6923 (27692/40000), AUC 0.6828466653823853
Test Epoch9 layer0 Acc 0.843, AUC 0.9167846441268921
Test Epoch9 layer1 Acc 0.8344, AUC 0.9090319275856018
Test Epoch9 layer2 Acc 0.6369, AUC 0.5385644435882568
Test Epoch9 layer3 Acc 0.4971, AUC 0.8306399583816528
Test Epoch9 layer4 Acc 0.6378, AUC 0.6076408624649048
Best AUC 0.9560755491256714
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//imdb/imdb_lstmal_l5_m2.pt
[[4478  553]
 [ 546 4423]]
Figure(640x480)
[[4436  595]
 [ 666 4303]]
Figure(640x480)
[[4341  690]
 [4658  311]]
Figure(640x480)
[[   2 5029]
 [   2 4967]]
Figure(640x480)
[[  77 4954]
 [ 455 4514]]
Figure(640x480)
