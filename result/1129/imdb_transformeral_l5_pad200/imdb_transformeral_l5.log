total count words 222751
vocab size 30000
found 27937 words in glove
Start Training
gc 0
Train Epoch0 Acc 0.515625 (20625/40000), AUC 0.5130574107170105
Test Epoch0 layer0 Acc 0.8435, AUC 0.9221868515014648
Save ckpt to ckpt/imdb_transformeral_l5_pad200//imdb_transformeral_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.823, AUC 0.9027575254440308
Test Epoch0 layer2 Acc 0.8106, AUC 0.8914745450019836
Test Epoch0 layer3 Acc 0.5614, AUC 0.6294687986373901
Test Epoch0 layer4 Acc 0.5034, AUC 0.45455849170684814
gc 0
Train Epoch1 Acc 0.749275 (29971/40000), AUC 0.8477605581283569
Test Epoch1 layer0 Acc 0.8754, AUC 0.9453802108764648
Save ckpt to ckpt/imdb_transformeral_l5_pad200//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8697, AUC 0.9465072154998779
Save ckpt to ckpt/imdb_transformeral_l5_pad200//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8236, AUC 0.9461160898208618
Test Epoch1 layer3 Acc 0.7875, AUC 0.9447569251060486
Test Epoch1 layer4 Acc 0.7609, AUC 0.9451401233673096
gc 0
Train Epoch2 Acc 0.89835 (35934/40000), AUC 0.961970329284668
Test Epoch2 layer0 Acc 0.8761, AUC 0.9481315612792969
Save ckpt to ckpt/imdb_transformeral_l5_pad200//imdb_transformeral_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8746, AUC 0.9484645128250122
Save ckpt to ckpt/imdb_transformeral_l5_pad200//imdb_transformeral_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8596, AUC 0.9462850093841553
Test Epoch2 layer3 Acc 0.8575, AUC 0.9460304975509644
Test Epoch2 layer4 Acc 0.8483, AUC 0.9461520314216614
gc 0
Train Epoch3 Acc 0.93405 (37362/40000), AUC 0.9795420169830322
Test Epoch3 layer0 Acc 0.8809, AUC 0.9479589462280273
Test Epoch3 layer1 Acc 0.8722, AUC 0.944284200668335
Test Epoch3 layer2 Acc 0.8705, AUC 0.9411081075668335
Test Epoch3 layer3 Acc 0.8703, AUC 0.9418122172355652
Test Epoch3 layer4 Acc 0.8709, AUC 0.9419691562652588
gc 0
Train Epoch4 Acc 0.948725 (37949/40000), AUC 0.9850562810897827
Test Epoch4 layer0 Acc 0.8781, AUC 0.9453504681587219
Test Epoch4 layer1 Acc 0.8629, AUC 0.9377048015594482
Test Epoch4 layer2 Acc 0.862, AUC 0.9331942796707153
Test Epoch4 layer3 Acc 0.8615, AUC 0.9367890357971191
Test Epoch4 layer4 Acc 0.8616, AUC 0.9372085332870483
gc 0
Train Epoch5 Acc 0.95755 (38302/40000), AUC 0.9885239601135254
Test Epoch5 layer0 Acc 0.8739, AUC 0.9430404305458069
Test Epoch5 layer1 Acc 0.8592, AUC 0.9341621398925781
Test Epoch5 layer2 Acc 0.8603, AUC 0.9310992360115051
Test Epoch5 layer3 Acc 0.8593, AUC 0.9342508912086487
Test Epoch5 layer4 Acc 0.8587, AUC 0.9346859455108643
gc 0
Train Epoch6 Acc 0.963775 (38551/40000), AUC 0.9908385276794434
Test Epoch6 layer0 Acc 0.8668, AUC 0.938982367515564
Test Epoch6 layer1 Acc 0.8632, AUC 0.9308072328567505
Test Epoch6 layer2 Acc 0.8628, AUC 0.9320409893989563
Test Epoch6 layer3 Acc 0.8624, AUC 0.9332021474838257
Test Epoch6 layer4 Acc 0.8629, AUC 0.9341393113136292
gc 0
Train Epoch7 Acc 0.9714 (38856/40000), AUC 0.9931677579879761
Test Epoch7 layer0 Acc 0.8663, AUC 0.9375075697898865
Test Epoch7 layer1 Acc 0.8594, AUC 0.9258811473846436
Test Epoch7 layer2 Acc 0.8604, AUC 0.9298333525657654
Test Epoch7 layer3 Acc 0.8608, AUC 0.9311564564704895
Test Epoch7 layer4 Acc 0.8604, AUC 0.9322621822357178
gc 0
Train Epoch8 Acc 0.974025 (38961/40000), AUC 0.9939625263214111
Test Epoch8 layer0 Acc 0.8644, AUC 0.936110258102417
Test Epoch8 layer1 Acc 0.8563, AUC 0.9190552830696106
Test Epoch8 layer2 Acc 0.8575, AUC 0.9246772527694702
Test Epoch8 layer3 Acc 0.858, AUC 0.9286477565765381
Test Epoch8 layer4 Acc 0.858, AUC 0.9300922155380249
gc 0
Train Epoch9 Acc 0.975125 (39005/40000), AUC 0.9944549798965454
Test Epoch9 layer0 Acc 0.8623, AUC 0.9344497919082642
Test Epoch9 layer1 Acc 0.8525, AUC 0.9177721738815308
Test Epoch9 layer2 Acc 0.8544, AUC 0.9216811656951904
Test Epoch9 layer3 Acc 0.855, AUC 0.9276095032691956
Test Epoch9 layer4 Acc 0.8547, AUC 0.9290561676025391
gc 0
Train Epoch10 Acc 0.9775 (39100/40000), AUC 0.9950810074806213
Test Epoch10 layer0 Acc 0.8612, AUC 0.931918740272522
Test Epoch10 layer1 Acc 0.8573, AUC 0.9128649830818176
Test Epoch10 layer2 Acc 0.8579, AUC 0.9208318591117859
Test Epoch10 layer3 Acc 0.8585, AUC 0.9265592694282532
Test Epoch10 layer4 Acc 0.8579, AUC 0.928189218044281
gc 0
Train Epoch11 Acc 0.980175 (39207/40000), AUC 0.9962035417556763
Test Epoch11 layer0 Acc 0.8613, AUC 0.93133145570755
Test Epoch11 layer1 Acc 0.8527, AUC 0.9100338220596313
Test Epoch11 layer2 Acc 0.8538, AUC 0.9163017272949219
Test Epoch11 layer3 Acc 0.8538, AUC 0.9246540069580078
Test Epoch11 layer4 Acc 0.8536, AUC 0.925971269607544
gc 0
Train Epoch12 Acc 0.980475 (39219/40000), AUC 0.9960637092590332
Test Epoch12 layer0 Acc 0.8616, AUC 0.9302312731742859
Test Epoch12 layer1 Acc 0.8533, AUC 0.9094938039779663
Test Epoch12 layer2 Acc 0.8551, AUC 0.9167466759681702
Test Epoch12 layer3 Acc 0.8546, AUC 0.9231554269790649
Test Epoch12 layer4 Acc 0.8548, AUC 0.9249871969223022
gc 0
Train Epoch13 Acc 0.9811 (39244/40000), AUC 0.9964241981506348
Test Epoch13 layer0 Acc 0.8591, AUC 0.9294151663780212
Test Epoch13 layer1 Acc 0.8541, AUC 0.9064320921897888
Test Epoch13 layer2 Acc 0.8548, AUC 0.9148950576782227
Test Epoch13 layer3 Acc 0.8551, AUC 0.9216104745864868
Test Epoch13 layer4 Acc 0.8555, AUC 0.9238829612731934
gc 0
Train Epoch14 Acc 0.982225 (39289/40000), AUC 0.9963029623031616
Test Epoch14 layer0 Acc 0.8578, AUC 0.9282236695289612
Test Epoch14 layer1 Acc 0.8495, AUC 0.9039275050163269
Test Epoch14 layer2 Acc 0.8498, AUC 0.9102755784988403
Test Epoch14 layer3 Acc 0.8501, AUC 0.9190306663513184
Test Epoch14 layer4 Acc 0.8505, AUC 0.9211069345474243
gc 0
Train Epoch15 Acc 0.9831 (39324/40000), AUC 0.9969338178634644
Test Epoch15 layer0 Acc 0.8576, AUC 0.9278992414474487
Test Epoch15 layer1 Acc 0.8512, AUC 0.9036426544189453
Test Epoch15 layer2 Acc 0.8512, AUC 0.909152626991272
Test Epoch15 layer3 Acc 0.8512, AUC 0.9182559251785278
Test Epoch15 layer4 Acc 0.8511, AUC 0.9201513528823853
gc 0
Train Epoch16 Acc 0.98355 (39342/40000), AUC 0.9970148801803589
Test Epoch16 layer0 Acc 0.8571, AUC 0.9274230003356934
Test Epoch16 layer1 Acc 0.8514, AUC 0.9014666080474854
Test Epoch16 layer2 Acc 0.8517, AUC 0.9070916175842285
Test Epoch16 layer3 Acc 0.8519, AUC 0.9164592623710632
Test Epoch16 layer4 Acc 0.8516, AUC 0.9189119338989258
gc 0
Train Epoch17 Acc 0.9837 (39348/40000), AUC 0.9972066283226013
Test Epoch17 layer0 Acc 0.8539, AUC 0.9266664981842041
Test Epoch17 layer1 Acc 0.8504, AUC 0.9011167287826538
Test Epoch17 layer2 Acc 0.8506, AUC 0.9035086631774902
Test Epoch17 layer3 Acc 0.8504, AUC 0.9171667695045471
Test Epoch17 layer4 Acc 0.8504, AUC 0.9186650514602661
gc 0
Train Epoch18 Acc 0.9842 (39368/40000), AUC 0.9971820116043091
Test Epoch18 layer0 Acc 0.8566, AUC 0.926581621170044
Test Epoch18 layer1 Acc 0.8484, AUC 0.8998353481292725
Test Epoch18 layer2 Acc 0.8484, AUC 0.9040263891220093
Test Epoch18 layer3 Acc 0.8487, AUC 0.9166317582130432
Test Epoch18 layer4 Acc 0.8487, AUC 0.9184175729751587
gc 0
Train Epoch19 Acc 0.98455 (39382/40000), AUC 0.9973884224891663
Test Epoch19 layer0 Acc 0.8556, AUC 0.9263173937797546
Test Epoch19 layer1 Acc 0.8491, AUC 0.8992087244987488
Test Epoch19 layer2 Acc 0.8487, AUC 0.9008617997169495
Test Epoch19 layer3 Acc 0.8487, AUC 0.9144206047058105
Test Epoch19 layer4 Acc 0.8485, AUC 0.9167467355728149
gc 0
Train Epoch20 Acc 0.9848 (39392/40000), AUC 0.9974238276481628
Test Epoch20 layer0 Acc 0.8562, AUC 0.9260783195495605
Test Epoch20 layer1 Acc 0.8492, AUC 0.8978089690208435
Test Epoch20 layer2 Acc 0.8489, AUC 0.8977195024490356
Test Epoch20 layer3 Acc 0.8488, AUC 0.912601113319397
Test Epoch20 layer4 Acc 0.8487, AUC 0.9155646562576294
gc 0
Train Epoch21 Acc 0.9851 (39404/40000), AUC 0.9974091053009033
Test Epoch21 layer0 Acc 0.8557, AUC 0.9257866144180298
Test Epoch21 layer1 Acc 0.8483, AUC 0.8981317281723022
Test Epoch21 layer2 Acc 0.8474, AUC 0.8974431753158569
Test Epoch21 layer3 Acc 0.8472, AUC 0.9117825031280518
Test Epoch21 layer4 Acc 0.8471, AUC 0.9146698713302612
gc 0
Train Epoch22 Acc 0.985425 (39417/40000), AUC 0.997362494468689
Test Epoch22 layer0 Acc 0.8557, AUC 0.9256531000137329
Test Epoch22 layer1 Acc 0.8494, AUC 0.8974543809890747
Test Epoch22 layer2 Acc 0.8482, AUC 0.8947107195854187
Test Epoch22 layer3 Acc 0.8484, AUC 0.9113742709159851
Test Epoch22 layer4 Acc 0.8483, AUC 0.9138525724411011
gc 0
Train Epoch23 Acc 0.9854 (39416/40000), AUC 0.9973907470703125
Test Epoch23 layer0 Acc 0.8559, AUC 0.925518810749054
Test Epoch23 layer1 Acc 0.8482, AUC 0.8965699672698975
Test Epoch23 layer2 Acc 0.8474, AUC 0.8953580856323242
Test Epoch23 layer3 Acc 0.8474, AUC 0.9109702706336975
Test Epoch23 layer4 Acc 0.8477, AUC 0.9136816263198853
gc 0
Train Epoch24 Acc 0.9856 (39424/40000), AUC 0.9975697994232178
Test Epoch24 layer0 Acc 0.8555, AUC 0.9254063963890076
Test Epoch24 layer1 Acc 0.8486, AUC 0.8966541290283203
Test Epoch24 layer2 Acc 0.8474, AUC 0.894664466381073
Test Epoch24 layer3 Acc 0.8471, AUC 0.9104551672935486
Test Epoch24 layer4 Acc 0.8473, AUC 0.9132071733474731
gc 0
Train Epoch25 Acc 0.9862 (39448/40000), AUC 0.9974679350852966
Test Epoch25 layer0 Acc 0.8555, AUC 0.9253236055374146
Test Epoch25 layer1 Acc 0.8472, AUC 0.8957802057266235
Test Epoch25 layer2 Acc 0.8467, AUC 0.8939252495765686
Test Epoch25 layer3 Acc 0.847, AUC 0.9084795117378235
Test Epoch25 layer4 Acc 0.847, AUC 0.9121308326721191
gc 0
Train Epoch26 Acc 0.986025 (39441/40000), AUC 0.9975130558013916
Test Epoch26 layer0 Acc 0.8551, AUC 0.9252310395240784
Test Epoch26 layer1 Acc 0.849, AUC 0.8957526087760925
Test Epoch26 layer2 Acc 0.8473, AUC 0.8930141925811768
Test Epoch26 layer3 Acc 0.8473, AUC 0.9094182252883911
Test Epoch26 layer4 Acc 0.8473, AUC 0.9122502207756042
gc 0
Train Epoch27 Acc 0.9858 (39432/40000), AUC 0.9977338314056396
Test Epoch27 layer0 Acc 0.855, AUC 0.9251798391342163
Test Epoch27 layer1 Acc 0.8478, AUC 0.8956680297851562
Test Epoch27 layer2 Acc 0.847, AUC 0.8930501937866211
Test Epoch27 layer3 Acc 0.8469, AUC 0.9089471101760864
Test Epoch27 layer4 Acc 0.8471, AUC 0.9117943048477173
gc 0
Train Epoch28 Acc 0.9861 (39444/40000), AUC 0.9977211952209473
Test Epoch28 layer0 Acc 0.8553, AUC 0.9251366257667542
Test Epoch28 layer1 Acc 0.8475, AUC 0.8955091238021851
Test Epoch28 layer2 Acc 0.847, AUC 0.8927152752876282
Test Epoch28 layer3 Acc 0.8469, AUC 0.908493161201477
Test Epoch28 layer4 Acc 0.8473, AUC 0.9114276766777039
gc 0
Train Epoch29 Acc 0.98615 (39446/40000), AUC 0.99753737449646
Test Epoch29 layer0 Acc 0.8555, AUC 0.9250961542129517
Test Epoch29 layer1 Acc 0.8473, AUC 0.8950961828231812
Test Epoch29 layer2 Acc 0.8464, AUC 0.891609251499176
Test Epoch29 layer3 Acc 0.8465, AUC 0.9071916341781616
Test Epoch29 layer4 Acc 0.8467, AUC 0.910445511341095
Best AUC 0.9484645128250122
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_transformeral_l5_pad200//imdb_transformeral_l5.pt
[[4505  461]
 [ 778 4256]]
Figure(640x480)
[[4173  793]
 [ 461 4573]]
Figure(640x480)
[[3916 1050]
 [ 354 4680]]
Figure(640x480)
[[3879 1087]
 [ 338 4696]]
Figure(640x480)
[[3747 1219]
 [ 298 4736]]
Figure(640x480)
