total count words 222751
vocab size 30000
found 27937 words in glove
Start Training
gc 0
Train Epoch0 Acc 0.505325 (20213/40000), AUC 0.5078045725822449
Test Epoch0 layer0 Acc 0.8167, AUC 0.896882176399231
Save ckpt to ckpt/imdb_transformeral_l5_pad100//imdb_transformeral_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7062, AUC 0.859685480594635
Test Epoch0 layer2 Acc 0.515, AUC 0.7942495942115784
Test Epoch0 layer3 Acc 0.5347, AUC 0.7631892561912537
Test Epoch0 layer4 Acc 0.5111, AUC 0.600119948387146
gc 0
Train Epoch1 Acc 0.753775 (30151/40000), AUC 0.8402827978134155
Test Epoch1 layer0 Acc 0.8477, AUC 0.9229801297187805
Save ckpt to ckpt/imdb_transformeral_l5_pad100//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8453, AUC 0.9237712621688843
Save ckpt to ckpt/imdb_transformeral_l5_pad100//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8441, AUC 0.9232803583145142
Test Epoch1 layer3 Acc 0.8443, AUC 0.9228194952011108
Test Epoch1 layer4 Acc 0.8422, AUC 0.9228063225746155
gc 0
Train Epoch2 Acc 0.880925 (35237/40000), AUC 0.9492316246032715
Test Epoch2 layer0 Acc 0.8515, AUC 0.9257985353469849
Save ckpt to ckpt/imdb_transformeral_l5_pad100//imdb_transformeral_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8443, AUC 0.9210500717163086
Test Epoch2 layer2 Acc 0.8405, AUC 0.9199033975601196
Test Epoch2 layer3 Acc 0.836, AUC 0.919958233833313
Test Epoch2 layer4 Acc 0.8289, AUC 0.9198553562164307
gc 0
Train Epoch3 Acc 0.9205 (36820/40000), AUC 0.9728628993034363
Test Epoch3 layer0 Acc 0.8517, AUC 0.923434853553772
Test Epoch3 layer1 Acc 0.8395, AUC 0.9133807420730591
Test Epoch3 layer2 Acc 0.8396, AUC 0.9125545024871826
Test Epoch3 layer3 Acc 0.8399, AUC 0.9117785692214966
Test Epoch3 layer4 Acc 0.8396, AUC 0.9118877053260803
gc 0
Train Epoch4 Acc 0.93605 (37442/40000), AUC 0.978361964225769
Test Epoch4 layer0 Acc 0.8449, AUC 0.9185348749160767
Test Epoch4 layer1 Acc 0.8307, AUC 0.9070279598236084
Test Epoch4 layer2 Acc 0.8321, AUC 0.9074625968933105
Test Epoch4 layer3 Acc 0.8315, AUC 0.9068484306335449
Test Epoch4 layer4 Acc 0.8318, AUC 0.9067919254302979
gc 0
Train Epoch5 Acc 0.946975 (37879/40000), AUC 0.9850761890411377
Test Epoch5 layer0 Acc 0.8381, AUC 0.9128150939941406
Test Epoch5 layer1 Acc 0.8252, AUC 0.9021434783935547
Test Epoch5 layer2 Acc 0.8272, AUC 0.903494119644165
Test Epoch5 layer3 Acc 0.8271, AUC 0.9037595987319946
Test Epoch5 layer4 Acc 0.8261, AUC 0.9035762548446655
gc 0
Train Epoch6 Acc 0.9552 (38208/40000), AUC 0.9884006977081299
Test Epoch6 layer0 Acc 0.8316, AUC 0.9074501991271973
Test Epoch6 layer1 Acc 0.8235, AUC 0.8946511745452881
Test Epoch6 layer2 Acc 0.8228, AUC 0.899238109588623
Test Epoch6 layer3 Acc 0.823, AUC 0.899449348449707
Test Epoch6 layer4 Acc 0.8221, AUC 0.8991544246673584
gc 0
Train Epoch7 Acc 0.9622 (38488/40000), AUC 0.9913925528526306
Test Epoch7 layer0 Acc 0.8292, AUC 0.9049522876739502
Test Epoch7 layer1 Acc 0.8187, AUC 0.8882210850715637
Test Epoch7 layer2 Acc 0.8191, AUC 0.8948832750320435
Test Epoch7 layer3 Acc 0.8188, AUC 0.8967239856719971
Test Epoch7 layer4 Acc 0.8193, AUC 0.8965421915054321
gc 0
Train Epoch8 Acc 0.96565 (38626/40000), AUC 0.9918786883354187
Test Epoch8 layer0 Acc 0.8246, AUC 0.901698112487793
Test Epoch8 layer1 Acc 0.8136, AUC 0.8805156946182251
Test Epoch8 layer2 Acc 0.8136, AUC 0.8889186382293701
Test Epoch8 layer3 Acc 0.8127, AUC 0.892508864402771
Test Epoch8 layer4 Acc 0.8132, AUC 0.8924302458763123
gc 0
Train Epoch9 Acc 0.967525 (38701/40000), AUC 0.9921201467514038
Test Epoch9 layer0 Acc 0.8207, AUC 0.8983533382415771
Test Epoch9 layer1 Acc 0.8148, AUC 0.8771021366119385
Test Epoch9 layer2 Acc 0.8141, AUC 0.8880570530891418
Test Epoch9 layer3 Acc 0.8144, AUC 0.8912450075149536
Test Epoch9 layer4 Acc 0.8144, AUC 0.891046404838562
gc 0
Train Epoch10 Acc 0.970225 (38809/40000), AUC 0.994131326675415
Test Epoch10 layer0 Acc 0.8196, AUC 0.8962795734405518
Test Epoch10 layer1 Acc 0.8145, AUC 0.8743622303009033
Test Epoch10 layer2 Acc 0.8149, AUC 0.8867905735969543
Test Epoch10 layer3 Acc 0.8146, AUC 0.889737606048584
Test Epoch10 layer4 Acc 0.8155, AUC 0.889545738697052
gc 0
Train Epoch11 Acc 0.973025 (38921/40000), AUC 0.994725227355957
Test Epoch11 layer0 Acc 0.8179, AUC 0.8939200043678284
Test Epoch11 layer1 Acc 0.8128, AUC 0.8710001707077026
Test Epoch11 layer2 Acc 0.8128, AUC 0.8843904733657837
Test Epoch11 layer3 Acc 0.8127, AUC 0.8878250122070312
Test Epoch11 layer4 Acc 0.8127, AUC 0.8876987099647522
gc 0
Train Epoch12 Acc 0.973875 (38955/40000), AUC 0.9950771927833557
Test Epoch12 layer0 Acc 0.815, AUC 0.8922874331474304
Test Epoch12 layer1 Acc 0.81, AUC 0.8648354411125183
Test Epoch12 layer2 Acc 0.8103, AUC 0.879250168800354
Test Epoch12 layer3 Acc 0.8104, AUC 0.8848627805709839
Test Epoch12 layer4 Acc 0.8103, AUC 0.8849035501480103
gc 0
Train Epoch13 Acc 0.975075 (39003/40000), AUC 0.9949871897697449
Test Epoch13 layer0 Acc 0.8157, AUC 0.8910520672798157
Test Epoch13 layer1 Acc 0.811, AUC 0.864351749420166
Test Epoch13 layer2 Acc 0.8117, AUC 0.8800920844078064
Test Epoch13 layer3 Acc 0.8117, AUC 0.8846685886383057
Test Epoch13 layer4 Acc 0.8118, AUC 0.884350061416626
gc 0
Train Epoch14 Acc 0.976 (39040/40000), AUC 0.9957284331321716
Test Epoch14 layer0 Acc 0.8133, AUC 0.8896054029464722
Test Epoch14 layer1 Acc 0.8103, AUC 0.8622696995735168
Test Epoch14 layer2 Acc 0.811, AUC 0.8778291940689087
Test Epoch14 layer3 Acc 0.8111, AUC 0.8835266828536987
Test Epoch14 layer4 Acc 0.8112, AUC 0.8835017681121826
gc 0
Train Epoch15 Acc 0.977475 (39099/40000), AUC 0.9959280490875244
Test Epoch15 layer0 Acc 0.8128, AUC 0.8886188864707947
Test Epoch15 layer1 Acc 0.8087, AUC 0.8602918386459351
Test Epoch15 layer2 Acc 0.8089, AUC 0.8746342658996582
Test Epoch15 layer3 Acc 0.8085, AUC 0.881545901298523
Test Epoch15 layer4 Acc 0.8087, AUC 0.8814161419868469
gc 0
Train Epoch16 Acc 0.9781 (39124/40000), AUC 0.9961549639701843
Test Epoch16 layer0 Acc 0.8116, AUC 0.8878097534179688
Test Epoch16 layer1 Acc 0.8076, AUC 0.8596973419189453
Test Epoch16 layer2 Acc 0.8087, AUC 0.8754128217697144
Test Epoch16 layer3 Acc 0.8079, AUC 0.8811665177345276
Test Epoch16 layer4 Acc 0.8087, AUC 0.8810001611709595
gc 0
Train Epoch17 Acc 0.978125 (39125/40000), AUC 0.9963755011558533
Test Epoch17 layer0 Acc 0.8099, AUC 0.8868871331214905
Test Epoch17 layer1 Acc 0.8074, AUC 0.8568727970123291
Test Epoch17 layer2 Acc 0.8059, AUC 0.8716810941696167
Test Epoch17 layer3 Acc 0.8063, AUC 0.8793256878852844
Test Epoch17 layer4 Acc 0.8062, AUC 0.8794032335281372
gc 0
Train Epoch18 Acc 0.97895 (39158/40000), AUC 0.9963552951812744
Test Epoch18 layer0 Acc 0.8101, AUC 0.8863344192504883
Test Epoch18 layer1 Acc 0.8072, AUC 0.8561394214630127
Test Epoch18 layer2 Acc 0.8068, AUC 0.8709350824356079
Test Epoch18 layer3 Acc 0.8062, AUC 0.8790335655212402
Test Epoch18 layer4 Acc 0.8069, AUC 0.8790286183357239
gc 0
Train Epoch19 Acc 0.979575 (39183/40000), AUC 0.9965540170669556
Test Epoch19 layer0 Acc 0.81, AUC 0.8863037824630737
Test Epoch19 layer1 Acc 0.8065, AUC 0.8551661968231201
Test Epoch19 layer2 Acc 0.8054, AUC 0.8698281645774841
Test Epoch19 layer3 Acc 0.8059, AUC 0.8785632848739624
Test Epoch19 layer4 Acc 0.8059, AUC 0.8786166906356812
gc 0
Train Epoch20 Acc 0.979975 (39199/40000), AUC 0.9968482851982117
Test Epoch20 layer0 Acc 0.8102, AUC 0.8857725858688354
Test Epoch20 layer1 Acc 0.8072, AUC 0.8550262451171875
Test Epoch20 layer2 Acc 0.8082, AUC 0.869793713092804
Test Epoch20 layer3 Acc 0.8082, AUC 0.8784400224685669
Test Epoch20 layer4 Acc 0.8081, AUC 0.878366231918335
gc 0
Train Epoch21 Acc 0.98 (39200/40000), AUC 0.996345043182373
Test Epoch21 layer0 Acc 0.8085, AUC 0.8853633403778076
Test Epoch21 layer1 Acc 0.8054, AUC 0.8533294796943665
Test Epoch21 layer2 Acc 0.805, AUC 0.8673943281173706
Test Epoch21 layer3 Acc 0.8053, AUC 0.8774737119674683
Test Epoch21 layer4 Acc 0.8052, AUC 0.8775731325149536
gc 0
Train Epoch22 Acc 0.98015 (39206/40000), AUC 0.9967761039733887
Test Epoch22 layer0 Acc 0.8089, AUC 0.8847367763519287
Test Epoch22 layer1 Acc 0.8053, AUC 0.853652834892273
Test Epoch22 layer2 Acc 0.806, AUC 0.8689074516296387
Test Epoch22 layer3 Acc 0.8061, AUC 0.877593994140625
Test Epoch22 layer4 Acc 0.8064, AUC 0.8775100111961365
gc 0
Train Epoch23 Acc 0.980925 (39237/40000), AUC 0.9969081878662109
Test Epoch23 layer0 Acc 0.8087, AUC 0.884685754776001
Test Epoch23 layer1 Acc 0.8048, AUC 0.8530710935592651
Test Epoch23 layer2 Acc 0.8064, AUC 0.8683522939682007
Test Epoch23 layer3 Acc 0.8065, AUC 0.8773126602172852
Test Epoch23 layer4 Acc 0.8068, AUC 0.8772233128547668
gc 0
Train Epoch24 Acc 0.980575 (39223/40000), AUC 0.9969242811203003
Test Epoch24 layer0 Acc 0.8081, AUC 0.8844937086105347
Test Epoch24 layer1 Acc 0.8049, AUC 0.8524022102355957
Test Epoch24 layer2 Acc 0.8046, AUC 0.8667589426040649
Test Epoch24 layer3 Acc 0.8042, AUC 0.8767638802528381
Test Epoch24 layer4 Acc 0.8048, AUC 0.8768953084945679
gc 0
Train Epoch25 Acc 0.980625 (39225/40000), AUC 0.9970391988754272
Test Epoch25 layer0 Acc 0.8085, AUC 0.8844308257102966
Test Epoch25 layer1 Acc 0.8049, AUC 0.8518173694610596
Test Epoch25 layer2 Acc 0.8047, AUC 0.8660951852798462
Test Epoch25 layer3 Acc 0.8047, AUC 0.8764764070510864
Test Epoch25 layer4 Acc 0.8043, AUC 0.8766458034515381
gc 0
Train Epoch26 Acc 0.98065 (39226/40000), AUC 0.997104287147522
Test Epoch26 layer0 Acc 0.808, AUC 0.8843192458152771
Test Epoch26 layer1 Acc 0.8046, AUC 0.8518792390823364
Test Epoch26 layer2 Acc 0.8047, AUC 0.8664178848266602
Test Epoch26 layer3 Acc 0.8045, AUC 0.8765240907669067
Test Epoch26 layer4 Acc 0.8049, AUC 0.8766205310821533
gc 0
Train Epoch27 Acc 0.98085 (39234/40000), AUC 0.9970380067825317
Test Epoch27 layer0 Acc 0.8078, AUC 0.8841841816902161
Test Epoch27 layer1 Acc 0.8045, AUC 0.8517532348632812
Test Epoch27 layer2 Acc 0.8048, AUC 0.8661433458328247
Test Epoch27 layer3 Acc 0.8045, AUC 0.8764010667800903
Test Epoch27 layer4 Acc 0.8051, AUC 0.876528799533844
gc 0
Train Epoch28 Acc 0.9812 (39248/40000), AUC 0.9969472289085388
Test Epoch28 layer0 Acc 0.8078, AUC 0.884096622467041
Test Epoch28 layer1 Acc 0.8041, AUC 0.8513821959495544
Test Epoch28 layer2 Acc 0.8052, AUC 0.8656703233718872
Test Epoch28 layer3 Acc 0.805, AUC 0.8762359619140625
Test Epoch28 layer4 Acc 0.8052, AUC 0.876367449760437
gc 0
Train Epoch29 Acc 0.98115 (39246/40000), AUC 0.9971767663955688
Test Epoch29 layer0 Acc 0.8084, AUC 0.8840513229370117
Test Epoch29 layer1 Acc 0.8044, AUC 0.851121187210083
Test Epoch29 layer2 Acc 0.8041, AUC 0.8653653264045715
Test Epoch29 layer3 Acc 0.8041, AUC 0.8760807514190674
Test Epoch29 layer4 Acc 0.8041, AUC 0.8763276934623718
Best AUC 0.9257985353469849
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_transformeral_l5_pad100//imdb_transformeral_l5.pt
[[4166  735]
 [ 750 4349]]
Figure(640x480)
[[4310  591]
 [ 966 4133]]
Figure(640x480)
[[4344  557]
 [1038 4061]]
Figure(640x480)
[[4421  480]
 [1160 3939]]
Figure(640x480)
[[4493  408]
 [1303 3796]]
Figure(640x480)
