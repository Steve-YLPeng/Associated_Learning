total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.1_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9012 (108144/120000), AUC 0.9839491844177246
ep0_train_time 6.329216957092285
Test Epoch0 threshold 0.1 Acc 0.9118421052631579, AUC 0.9807519912719727, avg_entr 0.019783498719334602
ep0_t0.1_test_time 0.10396528244018555
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.1_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9476416666666667 (113717/120000), AUC 0.9925104379653931
ep1_train_time 5.913787126541138
Test Epoch1 threshold 0.1 Acc 0.9116776315789473, AUC 0.9806302189826965, avg_entr 0.01579493284225464
ep1_t0.1_test_time 0.10274600982666016
gc 0
Train Epoch2 Acc 0.9494 (113928/120000), AUC 0.9929775595664978
ep2_train_time 5.97638463973999
Test Epoch2 threshold 0.1 Acc 0.9110197368421052, AUC 0.9796937108039856, avg_entr 0.013071080669760704
ep2_t0.1_test_time 0.10211396217346191
gc 0
Train Epoch3 Acc 0.9518166666666666 (114218/120000), AUC 0.9931554794311523
ep3_train_time 5.971852540969849
Test Epoch3 threshold 0.1 Acc 0.9125, AUC 0.9793920516967773, avg_entr 0.012419690378010273
ep3_t0.1_test_time 0.10204529762268066
gc 0
Train Epoch4 Acc 0.9525583333333333 (114307/120000), AUC 0.9934548139572144
ep4_train_time 6.260520696640015
Test Epoch4 threshold 0.1 Acc 0.9105263157894737, AUC 0.9794453382492065, avg_entr 0.01214140560477972
ep4_t0.1_test_time 0.10513520240783691
gc 0
Train Epoch5 Acc 0.9552583333333333 (114631/120000), AUC 0.9945312738418579
ep5_train_time 6.127310037612915
Test Epoch5 threshold 0.1 Acc 0.9110197368421052, AUC 0.9792363047599792, avg_entr 0.012399648316204548
ep5_t0.1_test_time 0.1023857593536377
gc 0
Train Epoch6 Acc 0.9559666666666666 (114716/120000), AUC 0.9946877956390381
ep6_train_time 5.961923122406006
Test Epoch6 threshold 0.1 Acc 0.9100328947368421, AUC 0.9789812564849854, avg_entr 0.011816943064332008
ep6_t0.1_test_time 0.10171723365783691
gc 0
Train Epoch7 Acc 0.9565666666666667 (114788/120000), AUC 0.994775652885437
ep7_train_time 5.88387393951416
Test Epoch7 threshold 0.1 Acc 0.9110197368421052, AUC 0.9785329103469849, avg_entr 0.011495890095829964
ep7_t0.1_test_time 0.10119295120239258
gc 0
Train Epoch8 Acc 0.9573083333333333 (114877/120000), AUC 0.9950014352798462
ep8_train_time 5.937031984329224
Test Epoch8 threshold 0.1 Acc 0.9106907894736842, AUC 0.9783845543861389, avg_entr 0.011555686593055725
ep8_t0.1_test_time 0.10101437568664551
gc 0
Train Epoch9 Acc 0.9585916666666666 (115031/120000), AUC 0.9953629970550537
ep9_train_time 5.966772794723511
Test Epoch9 threshold 0.1 Acc 0.9092105263157895, AUC 0.9783790111541748, avg_entr 0.01142104808241129
ep9_t0.1_test_time 0.10245156288146973
Best AUC 0.9807519912719727
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.1_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9203947368421053, AUC 0.9861597418785095, avg_entr 0.021000342443585396
t0.1_test_time 0.026532888412475586
