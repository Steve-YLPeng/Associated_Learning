Files already downloaded and verified
model: VGG_AL(
  (layers): ModuleList(
    (0): CNNLayer(
      (enc): ENC(
        (f): Sequential(
          (0): Sequential(
            (0): Conv2d(3, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU()
          )
          (1): Sequential(
            (0): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU()
          )
          (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        )
        (b): Sequential(
          (0): Flatten()
          (1): Linear(in_features=65536, out_features=2500, bias=True)
          (2): Sigmoid()
          (3): Linear(in_features=2500, out_features=500, bias=True)
          (4): Sigmoid()
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=10, out_features=500, bias=True)
          (1): Sigmoid()
        )
        (h): Sequential(
          (0): Linear(in_features=500, out_features=10, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): CNNLayer(
      (enc): ENC(
        (f): Sequential(
          (0): Sequential(
            (0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU()
          )
          (1): Sequential(
            (0): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU()
          )
          (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        )
        (b): Sequential(
          (0): Flatten()
          (1): Linear(in_features=32768, out_features=2500, bias=True)
          (2): Sigmoid()
          (3): Linear(in_features=2500, out_features=500, bias=True)
          (4): Sigmoid()
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=500, out_features=500, bias=True)
          (1): Sigmoid()
        )
        (h): Sequential(
          (0): Linear(in_features=500, out_features=500, bias=True)
          (1): Sigmoid()
        )
        (cri): MSELoss()
      )
    )
    (2): CNNLayer(
      (enc): ENC(
        (f): Sequential(
          (0): Sequential(
            (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU()
          )
          (1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        )
        (b): Sequential(
          (0): Flatten()
          (1): Linear(in_features=8192, out_features=2500, bias=True)
          (2): Sigmoid()
          (3): Linear(in_features=2500, out_features=500, bias=True)
          (4): Sigmoid()
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=500, out_features=500, bias=True)
          (1): Sigmoid()
        )
        (h): Sequential(
          (0): Linear(in_features=500, out_features=500, bias=True)
          (1): Sigmoid()
        )
        (cri): MSELoss()
      )
    )
    (3): CNNLayer(
      (enc): ENC(
        (f): Sequential(
          (0): Sequential(
            (0): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
            (2): ReLU()
          )
          (1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
        )
        (b): Sequential(
          (0): Flatten()
          (1): Linear(in_features=2048, out_features=2500, bias=True)
          (2): Sigmoid()
          (3): Linear(in_features=2500, out_features=500, bias=True)
          (4): Sigmoid()
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=500, out_features=500, bias=True)
          (1): Sigmoid()
        )
        (h): Sequential(
          (0): Linear(in_features=500, out_features=500, bias=True)
          (1): Sigmoid()
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.f.0.0.weight 3456
layers.0.enc.f.0.1.weight 128
layers.0.enc.f.0.1.bias 128
layers.0.enc.f.1.0.weight 294912
layers.0.enc.f.1.1.weight 256
layers.0.enc.f.1.1.bias 256
layers.0.enc.b.1.weight 163840000
layers.0.enc.b.1.bias 2500
layers.0.enc.b.3.weight 1250000
layers.0.enc.b.3.bias 500
layers.0.ae.g.0.weight 5000
layers.0.ae.g.0.bias 500
layers.0.ae.h.0.weight 5000
layers.0.ae.h.0.bias 10
layers.1.enc.f.0.0.weight 589824
layers.1.enc.f.0.1.weight 256
layers.1.enc.f.0.1.bias 256
layers.1.enc.f.1.0.weight 1179648
layers.1.enc.f.1.1.weight 512
layers.1.enc.f.1.1.bias 512
layers.1.enc.b.1.weight 81920000
layers.1.enc.b.1.bias 2500
layers.1.enc.b.3.weight 1250000
layers.1.enc.b.3.bias 500
layers.1.ae.g.0.weight 250000
layers.1.ae.g.0.bias 500
layers.1.ae.h.0.weight 250000
layers.1.ae.h.0.bias 500
layers.2.enc.f.0.0.weight 2359296
layers.2.enc.f.0.1.weight 512
layers.2.enc.f.0.1.bias 512
layers.2.enc.b.1.weight 20480000
layers.2.enc.b.1.bias 2500
layers.2.enc.b.3.weight 1250000
layers.2.enc.b.3.bias 500
layers.2.ae.g.0.weight 250000
layers.2.ae.g.0.bias 500
layers.2.ae.h.0.weight 250000
layers.2.ae.h.0.bias 500
layers.3.enc.f.0.0.weight 2359296
layers.3.enc.f.0.1.weight 512
layers.3.enc.f.0.1.bias 512
layers.3.enc.b.1.weight 5120000
layers.3.enc.b.1.bias 2500
layers.3.enc.b.3.weight 1250000
layers.3.enc.b.3.bias 500
layers.3.ae.g.0.weight 250000
layers.3.ae.g.0.bias 500
layers.3.ae.h.0.weight 250000
layers.3.ae.h.0.bias 500
Total Trainable Params: 284676294
init_time 4.187511287
Start Training
gc 0
Train Epoch0 Acc 0.10046 (10046/100000)
ep0_train_time 92.81508615599999
Test Epoch0 layer0 Acc 0.1
ep0_l0_test_time 2.0849097880000045
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
Test Epoch0 layer1 Acc 0.1
ep0_l1_test_time 2.23314852499999
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
Test Epoch0 layer2 Acc 0.1
ep0_l2_test_time 2.212412088999997
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
Test Epoch0 layer3 Acc 0.1
ep0_l3_test_time 2.2365446849999984
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
gc 0
Test threshold 0.1 Acc 0.1
t0.1_test_time 2.065388784999996
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
gc 0
Test threshold 0.2 Acc 0.1
t0.2_test_time 2.0590561930000035
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
gc 0
Test threshold 0.3 Acc 0.1
t0.3_test_time 2.0640614
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
gc 0
Test threshold 0.4 Acc 0.1
t0.4_test_time 2.058912156000005
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
gc 0
Test threshold 0.5 Acc 0.1
t0.5_test_time 2.062584521000005
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
gc 0
Test threshold 0.6 Acc 0.1
t0.6_test_time 2.5699581189999776
data_distribution  [0, 0, 0, 10000]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
gc 0
Test threshold 0.7 Acc 0.1
t0.7_test_time 2.5626664920000053
data_distribution  [0, 0, 0, 10000]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
gc 0
Test threshold 0.8 Acc 0.1
t0.8_test_time 2.5544045160000053
data_distribution  [0, 0, 0, 10000]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
gc 0
Test threshold 0.9 Acc 0.1
t0.9_test_time 2.552106006999992
data_distribution  [0, 0, 0, 10000]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.10065 (10065/100000)
ep1_train_time 91.68071220299998
Test Epoch1 layer0 Acc 0.1759
ep1_l0_test_time 2.0593081209999866
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 1
Test Epoch1 layer1 Acc 0.1
ep1_l1_test_time 2.186504030000009
Test Epoch1 layer2 Acc 0.1
ep1_l2_test_time 2.1968478849999826
Test Epoch1 layer3 Acc 0.1
ep1_l3_test_time 2.2163672860000077
gc 0
Test threshold 0.1 Acc 0.1759
t0.1_test_time 2.051442979000001
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 1
gc 0
Test threshold 0.2 Acc 0.1759
t0.2_test_time 2.058161788999996
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 1
gc 0
Test threshold 0.3 Acc 0.1759
t0.3_test_time 2.061868895999993
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 1
gc 0
Test threshold 0.4 Acc 0.1759
t0.4_test_time 2.054425388000027
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 1
gc 0
Test threshold 0.5 Acc 0.1
t0.5_test_time 2.564812694000011
data_distribution  [0, 0, 0, 10000]
gc 0
Test threshold 0.6 Acc 0.1
t0.6_test_time 2.552994116999969
data_distribution  [0, 0, 0, 10000]
gc 0
Test threshold 0.7 Acc 0.1
t0.7_test_time 2.5525165130000005
data_distribution  [0, 0, 0, 10000]
gc 0
Test threshold 0.8 Acc 0.1
t0.8_test_time 2.5730609870000194
data_distribution  [0, 0, 0, 10000]
gc 0
Test threshold 0.9 Acc 0.1
t0.9_test_time 2.5557137939999848
data_distribution  [0, 0, 0, 10000]
gc 0
Train Epoch2 Acc 0.10159 (10159/100000)
ep2_train_time 92.04330507500003
Test Epoch2 layer0 Acc 0.3612
ep2_l0_test_time 2.05321918300001
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 2
Test Epoch2 layer1 Acc 0.1
ep2_l1_test_time 2.188681121000002
Test Epoch2 layer2 Acc 0.1
ep2_l2_test_time 2.2251924949999875
Test Epoch2 layer3 Acc 0.1
ep2_l3_test_time 2.2227331799999774
gc 0
Test threshold 0.1 Acc 0.3612
t0.1_test_time 2.052078375000008
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 2
gc 0
Test threshold 0.2 Acc 0.3612
t0.2_test_time 2.061145463999992
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 2
gc 0
Test threshold 0.3 Acc 0.3612
t0.3_test_time 2.0648069849999615
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 2
gc 0
Test threshold 0.4 Acc 0.3612
t0.4_test_time 2.0626027469999713
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 2
gc 0
Test threshold 0.5 Acc 0.1
t0.5_test_time 2.5580900290000272
data_distribution  [0, 0, 0, 10000]
gc 0
Test threshold 0.6 Acc 0.1
t0.6_test_time 2.557461558
data_distribution  [0, 0, 0, 10000]
gc 0
Test threshold 0.7 Acc 0.1
t0.7_test_time 2.570035823000012
data_distribution  [0, 0, 0, 10000]
gc 0
Test threshold 0.8 Acc 0.1
t0.8_test_time 2.561149478999994
data_distribution  [0, 0, 0, 10000]
gc 0
Test threshold 0.9 Acc 0.1
t0.9_test_time 2.560191886000041
data_distribution  [0, 0, 0, 10000]
gc 0
Train Epoch3 Acc 0.10347 (10347/100000)
ep3_train_time 92.34225831499998
Test Epoch3 layer0 Acc 0.5196
ep3_l0_test_time 2.0623419529999865
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 3
Test Epoch3 layer1 Acc 0.3443
ep3_l1_test_time 2.2027308410000046
Test Epoch3 layer2 Acc 0.1
ep3_l2_test_time 2.2993313469999634
Test Epoch3 layer3 Acc 0.1
ep3_l3_test_time 2.2128021999999987
gc 0
Test threshold 0.1 Acc 0.5196
t0.1_test_time 2.0604458189999946
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 3
gc 0
Test threshold 0.2 Acc 0.5196
t0.2_test_time 2.06580883099997
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 3
gc 0
Test threshold 0.3 Acc 0.5196
t0.3_test_time 2.0787583569999697
data_distribution  [10000, 0, 0, 0]
Save ckpt to ckpt/cifar10_VGG_AL_l4_strong//cifar10_VGG_AL_l4.pt  ,ep 3
gc 0
Test threshold 0.4 Acc 0.4919
t0.4_test_time 2.1488726180000413
data_distribution  [8561, 1, 0, 1438]
gc 0
Test threshold 0.5 Acc 0.1596
t0.5_test_time 2.5010017549999475
data_distribution  [1472, 0, 0, 8528]
gc 0
Test threshold 0.6 Acc 0.1
t0.6_test_time 2.5629041830000006
data_distribution  [0, 0, 0, 10000]
gc 0
Test threshold 0.7 Acc 0.1
t0.7_test_time 2.566624673000092
data_distribution  [0, 0, 0, 10000]
gc 0
