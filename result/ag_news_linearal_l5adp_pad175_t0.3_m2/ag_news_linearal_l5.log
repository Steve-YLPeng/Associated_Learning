total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.2503416666666667 (30041/120000), AUC 0.5495069026947021
ep0_train_time 9.136955738067627
Test Epoch0 threshold 0.3 Acc 0.9141447368421053, AUC 0.9808688163757324, avg_entr 0.026927802711725235
ep0_t0.3_test_time 0.2603776454925537
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2502 (30024/120000), AUC 0.6583064198493958
ep1_train_time 8.53523325920105
Test Epoch1 threshold 0.3 Acc 0.9154605263157894, AUC 0.9808766841888428, avg_entr 0.02597229555249214
ep1_t0.3_test_time 0.2580866813659668
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25035833333333335 (30043/120000), AUC 0.6611620783805847
ep2_train_time 8.556653022766113
Test Epoch2 threshold 0.3 Acc 0.9159539473684211, AUC 0.9808751344680786, avg_entr 0.026308847591280937
ep2_t0.3_test_time 0.25711536407470703
gc 0
Train Epoch3 Acc 0.25045 (30054/120000), AUC 0.6645783185958862
ep3_train_time 8.562960624694824
Test Epoch3 threshold 0.3 Acc 0.915296052631579, AUC 0.9807512164115906, avg_entr 0.026394184678792953
ep3_t0.3_test_time 0.25722265243530273
gc 0
Train Epoch4 Acc 0.25043333333333334 (30052/120000), AUC 0.6657456159591675
ep4_train_time 8.42833161354065
Test Epoch4 threshold 0.3 Acc 0.9133223684210526, AUC 0.9805753231048584, avg_entr 0.025707438588142395
ep4_t0.3_test_time 0.25730466842651367
gc 0
Train Epoch5 Acc 0.250375 (30045/120000), AUC 0.6667435765266418
ep5_train_time 8.535118341445923
Test Epoch5 threshold 0.3 Acc 0.9149671052631579, AUC 0.9804810881614685, avg_entr 0.025396622717380524
ep5_t0.3_test_time 0.25694823265075684
gc 0
Train Epoch6 Acc 0.25040833333333334 (30049/120000), AUC 0.6667433977127075
ep6_train_time 8.593944072723389
Test Epoch6 threshold 0.3 Acc 0.9139802631578947, AUC 0.980339765548706, avg_entr 0.02505001798272133
ep6_t0.3_test_time 0.2570323944091797
gc 0
Train Epoch7 Acc 0.250375 (30045/120000), AUC 0.6654691100120544
ep7_train_time 8.76000189781189
Test Epoch7 threshold 0.3 Acc 0.9143092105263158, AUC 0.9801642894744873, avg_entr 0.025786079466342926
ep7_t0.3_test_time 0.2563962936401367
gc 0
Train Epoch8 Acc 0.2503666666666667 (30044/120000), AUC 0.6639003157615662
ep8_train_time 8.589494943618774
Test Epoch8 threshold 0.3 Acc 0.9134868421052632, AUC 0.9800189137458801, avg_entr 0.025319287553429604
ep8_t0.3_test_time 0.25548362731933594
gc 0
Train Epoch9 Acc 0.25038333333333335 (30046/120000), AUC 0.6626189947128296
ep9_train_time 8.737144947052002
Test Epoch9 threshold 0.3 Acc 0.9134868421052632, AUC 0.9799906611442566, avg_entr 0.02521786466240883
ep9_t0.3_test_time 0.2563910484313965
Best AUC 0.9808766841888428
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9197368421052632, AUC 0.986516535282135, avg_entr 0.026174364611506462
t0.3_test_time 0.06609177589416504
