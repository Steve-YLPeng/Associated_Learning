total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.4_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.45326666666666665 (54392/120000), AUC 0.775641679763794
ep0_train_time 4.8235273361206055
Test Epoch0 threshold 0.4 Acc 0.9138157894736842, AUC 0.9812102913856506, avg_entr 0.03262065351009369
ep0_t0.4_test_time 0.07904195785522461
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.4_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.46825833333333333 (56191/120000), AUC 0.8064161539077759
ep1_train_time 4.363324403762817
Test Epoch1 threshold 0.4 Acc 0.9129934210526316, AUC 0.9808362722396851, avg_entr 0.030086111277341843
ep1_t0.4_test_time 0.07677769660949707
gc 0
Train Epoch2 Acc 0.45593333333333336 (54712/120000), AUC 0.8105255365371704
ep2_train_time 4.471192121505737
Test Epoch2 threshold 0.4 Acc 0.9126644736842106, AUC 0.980245053768158, avg_entr 0.02745981514453888
ep2_t0.4_test_time 0.0780785083770752
gc 0
Train Epoch3 Acc 0.4411833333333333 (52942/120000), AUC 0.8023168444633484
ep3_train_time 4.6106977462768555
Test Epoch3 threshold 0.4 Acc 0.9115131578947369, AUC 0.9802660942077637, avg_entr 0.02754027210175991
ep3_t0.4_test_time 0.07935118675231934
gc 0
Train Epoch4 Acc 0.4256083333333333 (51073/120000), AUC 0.7822408676147461
ep4_train_time 4.619761943817139
Test Epoch4 threshold 0.4 Acc 0.9113486842105263, AUC 0.9797447323799133, avg_entr 0.02748001739382744
ep4_t0.4_test_time 0.07748746871948242
gc 0
Train Epoch5 Acc 0.4139833333333333 (49678/120000), AUC 0.7625942230224609
ep5_train_time 4.505316495895386
Test Epoch5 threshold 0.4 Acc 0.9113486842105263, AUC 0.9797337055206299, avg_entr 0.026993345469236374
ep5_t0.4_test_time 0.07534193992614746
gc 0
Train Epoch6 Acc 0.399425 (47931/120000), AUC 0.747565746307373
ep6_train_time 4.422258138656616
Test Epoch6 threshold 0.4 Acc 0.9108552631578948, AUC 0.979398250579834, avg_entr 0.02652077004313469
ep6_t0.4_test_time 0.07550859451293945
gc 0
Train Epoch7 Acc 0.3857 (46284/120000), AUC 0.732860803604126
ep7_train_time 4.4766762256622314
Test Epoch7 threshold 0.4 Acc 0.9098684210526315, AUC 0.9789773225784302, avg_entr 0.02645459957420826
ep7_t0.4_test_time 0.07603573799133301
gc 0
Train Epoch8 Acc 0.370875 (44505/120000), AUC 0.7169916033744812
ep8_train_time 4.386288166046143
Test Epoch8 threshold 0.4 Acc 0.9087171052631579, AUC 0.9792102575302124, avg_entr 0.026227226480841637
ep8_t0.4_test_time 0.07485008239746094
gc 0
Train Epoch9 Acc 0.36068333333333336 (43282/120000), AUC 0.7063472867012024
ep9_train_time 4.409546852111816
Test Epoch9 threshold 0.4 Acc 0.909375, AUC 0.9788583517074585, avg_entr 0.025958623737096786
ep9_t0.4_test_time 0.07477664947509766
Best AUC 0.9812102913856506
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.4_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9230263157894737, AUC 0.9861035943031311, avg_entr 0.034448083490133286
t0.4_test_time 0.020076513290405273
