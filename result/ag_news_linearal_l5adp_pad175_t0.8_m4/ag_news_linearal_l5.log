total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.022433333333333333 (2692/120000), AUC 0.5153261423110962
ep0_train_time 10.210339784622192
Test Epoch0 threshold 0.8 Acc 0.9149671052631579, AUC 0.9805549383163452, avg_entr 0.025272097438573837
ep0_t0.8_test_time 0.2595500946044922
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.010708333333333334 (1285/120000), AUC 0.38514021039009094
ep1_train_time 9.461281776428223
Test Epoch1 threshold 0.8 Acc 0.9138157894736842, AUC 0.9804737567901611, avg_entr 0.02492371015250683
ep1_t0.8_test_time 0.2512660026550293
gc 0
Train Epoch2 Acc 0.008391666666666667 (1007/120000), AUC 0.1963503509759903
ep2_train_time 9.430011510848999
Test Epoch2 threshold 0.8 Acc 0.9144736842105263, AUC 0.9803191423416138, avg_entr 0.026320412755012512
ep2_t0.8_test_time 0.250838041305542
gc 0
Train Epoch3 Acc 0.009325 (1119/120000), AUC 0.19724354147911072
ep3_train_time 9.60506558418274
Test Epoch3 threshold 0.8 Acc 0.9134868421052632, AUC 0.9802881479263306, avg_entr 0.0272300336509943
ep3_t0.8_test_time 0.25101327896118164
gc 0
Train Epoch4 Acc 0.012541666666666666 (1505/120000), AUC 0.20107470452785492
ep4_train_time 9.438331842422485
Test Epoch4 threshold 0.8 Acc 0.9139802631578947, AUC 0.9800599217414856, avg_entr 0.026791702955961227
ep4_t0.8_test_time 0.2509737014770508
gc 0
Train Epoch5 Acc 0.013316666666666666 (1598/120000), AUC 0.18356987833976746
ep5_train_time 9.454787254333496
Test Epoch5 threshold 0.8 Acc 0.9125, AUC 0.9800059795379639, avg_entr 0.025953345000743866
ep5_t0.8_test_time 0.25000548362731934
gc 0
Train Epoch6 Acc 0.013241666666666667 (1589/120000), AUC 0.17388440668582916
ep6_train_time 9.580384969711304
Test Epoch6 threshold 0.8 Acc 0.9133223684210526, AUC 0.9798839092254639, avg_entr 0.026498015969991684
ep6_t0.8_test_time 0.2584545612335205
gc 0
Train Epoch7 Acc 0.012808333333333333 (1537/120000), AUC 0.1700349897146225
ep7_train_time 9.615253210067749
Test Epoch7 threshold 0.8 Acc 0.9126644736842106, AUC 0.9797290563583374, avg_entr 0.02567039616405964
ep7_t0.8_test_time 0.2501647472381592
gc 0
Train Epoch8 Acc 0.012433333333333333 (1492/120000), AUC 0.165540874004364
ep8_train_time 9.37559461593628
Test Epoch8 threshold 0.8 Acc 0.9126644736842106, AUC 0.9796628952026367, avg_entr 0.025816237553954124
ep8_t0.8_test_time 0.2505486011505127
gc 0
Train Epoch9 Acc 0.012225 (1467/120000), AUC 0.16231608390808105
ep9_train_time 9.491504907608032
Test Epoch9 threshold 0.8 Acc 0.9123355263157895, AUC 0.9795898795127869, avg_entr 0.025909559801220894
ep9_t0.8_test_time 0.2503688335418701
Best AUC 0.9805549383163452
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9230263157894737, AUC 0.986158549785614, avg_entr 0.025246310979127884
t0.8_test_time 0.0631568431854248
