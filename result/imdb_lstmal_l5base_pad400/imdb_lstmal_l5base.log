total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.954816579818726
Start Training
gc 0
Train Epoch0 Acc 0.506825 (20273/40000), AUC 0.5107191801071167
ep0_train_time 116.38066363334656
Test Epoch0 layer4 Acc 0.565, AUC 0.7116332054138184, avg_entr 0.6706120371818542
ep0_l4_test_time 4.130181312561035
Save ckpt to ckpt/imdb_lstmal_l5base_pad400//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.770675 (30827/40000), AUC 0.8370382189750671
ep1_train_time 116.12940216064453
Test Epoch1 layer4 Acc 0.846, AUC 0.9139993190765381, avg_entr 0.09541118890047073
ep1_l4_test_time 4.027155637741089
Save ckpt to ckpt/imdb_lstmal_l5base_pad400//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.873425 (34937/40000), AUC 0.9159675240516663
ep2_train_time 116.87647247314453
Test Epoch2 layer4 Acc 0.8764, AUC 0.9332554340362549, avg_entr 0.055190350860357285
ep2_l4_test_time 4.1226701736450195
Save ckpt to ckpt/imdb_lstmal_l5base_pad400//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.8375 (33500/40000), AUC 0.912564754486084
ep3_train_time 116.05767107009888
Test Epoch3 layer4 Acc 0.8612, AUC 0.9268423318862915, avg_entr 0.03602476790547371
ep3_l4_test_time 4.084632396697998
gc 0
Train Epoch4 Acc 0.882175 (35287/40000), AUC 0.9462214112281799
ep4_train_time 116.03084802627563
Test Epoch4 layer4 Acc 0.8322, AUC 0.9362384080886841, avg_entr 0.06056484952569008
ep4_l4_test_time 4.077395915985107
Save ckpt to ckpt/imdb_lstmal_l5base_pad400//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.930475 (37219/40000), AUC 0.973146915435791
ep5_train_time 116.33539056777954
Test Epoch5 layer4 Acc 0.8854, AUC 0.9443659782409668, avg_entr 0.04238233342766762
ep5_l4_test_time 4.116925001144409
Save ckpt to ckpt/imdb_lstmal_l5base_pad400//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.946075 (37843/40000), AUC 0.9831860065460205
ep6_train_time 116.2856616973877
Test Epoch6 layer4 Acc 0.8794, AUC 0.9439917802810669, avg_entr 0.04286295920610428
ep6_l4_test_time 4.0396857261657715
gc 0
Train Epoch7 Acc 0.953 (38120/40000), AUC 0.9871243238449097
ep7_train_time 116.10577750205994
Test Epoch7 layer4 Acc 0.8754, AUC 0.9419718980789185, avg_entr 0.025949865579605103
ep7_l4_test_time 4.099521160125732
gc 0
Train Epoch8 Acc 0.959825 (38393/40000), AUC 0.9905193448066711
ep8_train_time 116.17935490608215
Test Epoch8 layer4 Acc 0.8778, AUC 0.9426663517951965, avg_entr 0.027628295123577118
ep8_l4_test_time 4.075684070587158
gc 0
Train Epoch9 Acc 0.964325 (38573/40000), AUC 0.9918639659881592
ep9_train_time 116.5328254699707
Test Epoch9 layer4 Acc 0.8762, AUC 0.9395127296447754, avg_entr 0.026292141526937485
ep9_l4_test_time 3.8254575729370117
gc 0
Train Epoch10 Acc 0.96735 (38694/40000), AUC 0.9936900734901428
ep10_train_time 116.79632377624512
Test Epoch10 layer4 Acc 0.8688, AUC 0.9396532773971558, avg_entr 0.0349084846675396
ep10_l4_test_time 4.1351072788238525
gc 0
Train Epoch11 Acc 0.9699 (38796/40000), AUC 0.9947044849395752
ep11_train_time 116.14128684997559
Test Epoch11 layer4 Acc 0.8612, AUC 0.9357081055641174, avg_entr 0.028803274035453796
ep11_l4_test_time 4.061326026916504
gc 0
Train Epoch12 Acc 0.972125 (38885/40000), AUC 0.9954235553741455
ep12_train_time 116.24119257926941
Test Epoch12 layer4 Acc 0.8642, AUC 0.933322548866272, avg_entr 0.024956844747066498
ep12_l4_test_time 4.117159843444824
gc 0
Train Epoch13 Acc 0.974925 (38997/40000), AUC 0.9963032007217407
ep13_train_time 116.08918714523315
Test Epoch13 layer4 Acc 0.86, AUC 0.9320371150970459, avg_entr 0.026518218219280243
ep13_l4_test_time 4.071736574172974
gc 0
Train Epoch14 Acc 0.977175 (39087/40000), AUC 0.996546745300293
ep14_train_time 116.23403811454773
Test Epoch14 layer4 Acc 0.8558, AUC 0.9252228140830994, avg_entr 0.018326232209801674
ep14_l4_test_time 4.097638368606567
gc 0
Train Epoch15 Acc 0.97875 (39150/40000), AUC 0.9970396757125854
ep15_train_time 116.18888688087463
Test Epoch15 layer4 Acc 0.8556, AUC 0.9245772361755371, avg_entr 0.023349355906248093
ep15_l4_test_time 4.112293481826782
gc 0
Train Epoch16 Acc 0.979925 (39197/40000), AUC 0.9973490834236145
ep16_train_time 259.49685740470886
Test Epoch16 layer4 Acc 0.848, AUC 0.9236904978752136, avg_entr 0.021005932241678238
ep16_l4_test_time 4.022620677947998
gc 0
Train Epoch17 Acc 0.980725 (39229/40000), AUC 0.997336745262146
ep17_train_time 116.68534326553345
Test Epoch17 layer4 Acc 0.8532, AUC 0.919355034828186, avg_entr 0.019234759733080864
ep17_l4_test_time 4.014714002609253
gc 0
Train Epoch18 Acc 0.98265 (39306/40000), AUC 0.9976379871368408
ep18_train_time 116.17085099220276
Test Epoch18 layer4 Acc 0.8494, AUC 0.911409854888916, avg_entr 0.013466998003423214
ep18_l4_test_time 4.078845739364624
gc 0
Train Epoch19 Acc 0.9829 (39316/40000), AUC 0.9977977275848389
ep19_train_time 116.20397901535034
Test Epoch19 layer4 Acc 0.846, AUC 0.9144880771636963, avg_entr 0.015273655764758587
ep19_l4_test_time 4.197316884994507
gc 0
Train Epoch20 Acc 0.985225 (39409/40000), AUC 0.9981765151023865
ep20_train_time 119.77271866798401
Test Epoch20 layer4 Acc 0.8354, AUC 0.912834644317627, avg_entr 0.017517076805233955
ep20_l4_test_time 4.267810106277466
gc 0
Train Epoch21 Acc 0.9854 (39416/40000), AUC 0.9982588291168213
ep21_train_time 119.78552460670471
Test Epoch21 layer4 Acc 0.8398, AUC 0.9133424162864685, avg_entr 0.016898246482014656
ep21_l4_test_time 4.166403293609619
gc 0
Train Epoch22 Acc 0.98605 (39442/40000), AUC 0.9985494017601013
ep22_train_time 119.80568218231201
Test Epoch22 layer4 Acc 0.8442, AUC 0.9064158201217651, avg_entr 0.015531410463154316
ep22_l4_test_time 4.204966306686401
gc 0
Train Epoch23 Acc 0.9877 (39508/40000), AUC 0.9986587762832642
ep23_train_time 119.8553261756897
Test Epoch23 layer4 Acc 0.8398, AUC 0.9006721377372742, avg_entr 0.014852301217615604
ep23_l4_test_time 4.188136577606201
gc 0
Train Epoch24 Acc 0.987875 (39515/40000), AUC 0.9987305402755737
ep24_train_time 120.42066287994385
Test Epoch24 layer4 Acc 0.8386, AUC 0.9054297804832458, avg_entr 0.014296421781182289
ep24_l4_test_time 3.850529670715332
gc 0
Train Epoch25 Acc 0.988175 (39527/40000), AUC 0.9986052513122559
ep25_train_time 120.3536925315857
Test Epoch25 layer4 Acc 0.829, AUC 0.9036740064620972, avg_entr 0.015424290671944618
ep25_l4_test_time 4.2734363079071045
gc 0
Train Epoch26 Acc 0.98835 (39534/40000), AUC 0.9989694952964783
ep26_train_time 72.15237545967102
Test Epoch26 layer4 Acc 0.8314, AUC 0.8954761028289795, avg_entr 0.00931423157453537
ep26_l4_test_time 2.5575942993164062
gc 0
Train Epoch27 Acc 0.98935 (39574/40000), AUC 0.9988052845001221
ep27_train_time 70.85842108726501
Test Epoch27 layer4 Acc 0.8376, AUC 0.895796537399292, avg_entr 0.012470481917262077
ep27_l4_test_time 2.5674235820770264
gc 0
Train Epoch28 Acc 0.990575 (39623/40000), AUC 0.9990413188934326
ep28_train_time 70.84888076782227
Test Epoch28 layer4 Acc 0.8304, AUC 0.8928322792053223, avg_entr 0.009546318091452122
ep28_l4_test_time 2.558495283126831
gc 0
Train Epoch29 Acc 0.9909 (39636/40000), AUC 0.9992111921310425
ep29_train_time 70.8712387084961
Test Epoch29 layer4 Acc 0.8142, AUC 0.8678959608078003, avg_entr 0.009960372932255268
ep29_l4_test_time 2.568873643875122
gc 0
Train Epoch30 Acc 0.990475 (39619/40000), AUC 0.9990341663360596
ep30_train_time 70.82800602912903
Test Epoch30 layer4 Acc 0.8304, AUC 0.8890689611434937, avg_entr 0.009787924587726593
ep30_l4_test_time 2.5753724575042725
gc 0
Train Epoch31 Acc 0.991475 (39659/40000), AUC 0.9992828369140625
ep31_train_time 70.81698417663574
Test Epoch31 layer4 Acc 0.8306, AUC 0.8932515382766724, avg_entr 0.01306017767637968
ep31_l4_test_time 2.5549283027648926
gc 0
Train Epoch32 Acc 0.9914 (39656/40000), AUC 0.9993040561676025
ep32_train_time 70.93812322616577
Test Epoch32 layer4 Acc 0.8212, AUC 0.8664408326148987, avg_entr 0.011370641179382801
ep32_l4_test_time 2.573685884475708
gc 0
Train Epoch33 Acc 0.991825 (39673/40000), AUC 0.9992990493774414
ep33_train_time 70.80658674240112
Test Epoch33 layer4 Acc 0.8256, AUC 0.8866240978240967, avg_entr 0.012167003005743027
ep33_l4_test_time 2.572634696960449
gc 0
Train Epoch34 Acc 0.9925 (39700/40000), AUC 0.9992966651916504
ep34_train_time 70.80700945854187
Test Epoch34 layer4 Acc 0.824, AUC 0.8882136344909668, avg_entr 0.013723846524953842
ep34_l4_test_time 2.5673656463623047
gc 0
Train Epoch35 Acc 0.99315 (39726/40000), AUC 0.9994077682495117
ep35_train_time 70.8938250541687
Test Epoch35 layer4 Acc 0.8272, AUC 0.8736487627029419, avg_entr 0.008191414177417755
ep35_l4_test_time 2.5809028148651123
gc 0
Train Epoch36 Acc 0.99265 (39706/40000), AUC 0.9994422197341919
ep36_train_time 70.83466362953186
Test Epoch36 layer4 Acc 0.8264, AUC 0.8808480501174927, avg_entr 0.009241023100912571
ep36_l4_test_time 2.5504324436187744
gc 0
Train Epoch37 Acc 0.993375 (39735/40000), AUC 0.9995124340057373
ep37_train_time 70.91578483581543
Test Epoch37 layer4 Acc 0.8252, AUC 0.8762734532356262, avg_entr 0.010081963613629341
ep37_l4_test_time 2.56874418258667
gc 0
Train Epoch38 Acc 0.993375 (39735/40000), AUC 0.9995216131210327
ep38_train_time 70.89507007598877
Test Epoch38 layer4 Acc 0.8208, AUC 0.8760057687759399, avg_entr 0.01165721658617258
ep38_l4_test_time 2.5810158252716064
gc 0
Train Epoch39 Acc 0.994175 (39767/40000), AUC 0.9995994567871094
ep39_train_time 70.9289858341217
Test Epoch39 layer4 Acc 0.8184, AUC 0.8609907031059265, avg_entr 0.008601246401667595
ep39_l4_test_time 2.576540470123291
gc 0
Train Epoch40 Acc 0.9941 (39764/40000), AUC 0.9995384216308594
ep40_train_time 70.93833947181702
Test Epoch40 layer4 Acc 0.821, AUC 0.8775410652160645, avg_entr 0.008696888573467731
ep40_l4_test_time 2.582127094268799
gc 0
Train Epoch41 Acc 0.994975 (39799/40000), AUC 0.9995661973953247
ep41_train_time 70.9374566078186
Test Epoch41 layer4 Acc 0.8168, AUC 0.8672746419906616, avg_entr 0.009296613745391369
ep41_l4_test_time 2.5571422576904297
gc 0
Train Epoch42 Acc 0.9948 (39792/40000), AUC 0.9996706247329712
ep42_train_time 70.87202024459839
Test Epoch42 layer4 Acc 0.8156, AUC 0.8720464706420898, avg_entr 0.007357149384915829
ep42_l4_test_time 2.558248996734619
gc 0
Train Epoch43 Acc 0.9956 (39824/40000), AUC 0.9996201992034912
ep43_train_time 70.84389400482178
Test Epoch43 layer4 Acc 0.8188, AUC 0.8553041219711304, avg_entr 0.00725929718464613
ep43_l4_test_time 2.559648036956787
gc 0
Train Epoch44 Acc 0.995775 (39831/40000), AUC 0.9996213912963867
ep44_train_time 70.9171667098999
Test Epoch44 layer4 Acc 0.8028, AUC 0.8691121339797974, avg_entr 0.009273928590118885
ep44_l4_test_time 2.5630645751953125
gc 0
Train Epoch45 Acc 0.994375 (39775/40000), AUC 0.9995577335357666
ep45_train_time 70.8894636631012
Test Epoch45 layer4 Acc 0.8146, AUC 0.8568049669265747, avg_entr 0.009524654597043991
ep45_l4_test_time 2.5794661045074463
gc 0
Train Epoch46 Acc 0.995975 (39839/40000), AUC 0.9995499849319458
ep46_train_time 70.88264489173889
Test Epoch46 layer4 Acc 0.8136, AUC 0.8598728775978088, avg_entr 0.006014915183186531
ep46_l4_test_time 2.5465760231018066
gc 0
Train Epoch47 Acc 0.99615 (39846/40000), AUC 0.9996370077133179
ep47_train_time 70.94377183914185
Test Epoch47 layer4 Acc 0.817, AUC 0.8524705171585083, avg_entr 0.007924744859337807
ep47_l4_test_time 2.5733609199523926
gc 0
Train Epoch48 Acc 0.99595 (39838/40000), AUC 0.9996743202209473
ep48_train_time 70.90924644470215
Test Epoch48 layer4 Acc 0.8126, AUC 0.8561472296714783, avg_entr 0.006891436874866486
ep48_l4_test_time 2.5601301193237305
gc 0
Train Epoch49 Acc 0.996725 (39869/40000), AUC 0.9997451305389404
ep49_train_time 70.86752986907959
Test Epoch49 layer4 Acc 0.807, AUC 0.8482293486595154, avg_entr 0.006335774902254343
ep49_l4_test_time 2.553337812423706
Best AUC 0.9443659782409668
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 5062.581364393234
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad400//imdb_lstmal_l5.pt
Test layer4 Acc 0.8754, AUC 0.9402405023574829, avg_entr 0.046863261610269547
l4_test_time 2.5601561069488525
