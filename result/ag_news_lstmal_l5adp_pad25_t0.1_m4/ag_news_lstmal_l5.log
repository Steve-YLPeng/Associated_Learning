total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad25_t0.1_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.26300833333333334 (31561/120000), AUC 0.5749147534370422
ep0_train_time 16.6724271774292
Test Epoch0 threshold 0.1 Acc 0.9106907894736842, AUC 0.9797168970108032, avg_entr 0.008280272595584393
ep0_t0.1_test_time 0.14630389213562012
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad25_t0.1_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.242175 (29061/120000), AUC 0.5831127166748047
ep1_train_time 16.203327894210815
Test Epoch1 threshold 0.1 Acc 0.9131578947368421, AUC 0.9796204566955566, avg_entr 0.007976870983839035
ep1_t0.1_test_time 0.14526152610778809
gc 0
Train Epoch2 Acc 0.243 (29160/120000), AUC 0.581044614315033
ep2_train_time 16.54347252845764
Test Epoch2 threshold 0.1 Acc 0.9125, AUC 0.9791454076766968, avg_entr 0.008317061699926853
ep2_t0.1_test_time 0.14676880836486816
gc 0
Train Epoch3 Acc 0.233325 (27999/120000), AUC 0.5743587017059326
ep3_train_time 16.69304370880127
Test Epoch3 threshold 0.1 Acc 0.9111842105263158, AUC 0.9784309267997742, avg_entr 0.008515169844031334
ep3_t0.1_test_time 0.14348626136779785
gc 0
Train Epoch4 Acc 0.20045833333333332 (24055/120000), AUC 0.56463623046875
ep4_train_time 16.344672441482544
Test Epoch4 threshold 0.1 Acc 0.9090460526315789, AUC 0.9779646992683411, avg_entr 0.008725476451218128
ep4_t0.1_test_time 0.14533782005310059
gc 0
Train Epoch5 Acc 0.165325 (19839/120000), AUC 0.5578029155731201
ep5_train_time 16.526182889938354
Test Epoch5 threshold 0.1 Acc 0.9080592105263158, AUC 0.9773006439208984, avg_entr 0.007530315779149532
ep5_t0.1_test_time 0.1441028118133545
gc 0
Train Epoch6 Acc 0.14189166666666667 (17027/120000), AUC 0.5487164855003357
ep6_train_time 16.654873847961426
Test Epoch6 threshold 0.1 Acc 0.9098684210526315, AUC 0.9771959781646729, avg_entr 0.0077912514097988605
ep6_t0.1_test_time 0.14925909042358398
gc 0
Train Epoch7 Acc 0.1342 (16104/120000), AUC 0.5400220155715942
ep7_train_time 16.6022789478302
Test Epoch7 threshold 0.1 Acc 0.9078947368421053, AUC 0.9767824411392212, avg_entr 0.007694346830248833
ep7_t0.1_test_time 0.14725613594055176
gc 0
Train Epoch8 Acc 0.11390833333333333 (13669/120000), AUC 0.5276950597763062
ep8_train_time 16.867299795150757
Test Epoch8 threshold 0.1 Acc 0.9055921052631579, AUC 0.9764014482498169, avg_entr 0.007677608635276556
ep8_t0.1_test_time 0.14854025840759277
gc 0
Train Epoch9 Acc 0.09718333333333333 (11662/120000), AUC 0.5209946036338806
ep9_train_time 16.63867712020874
Test Epoch9 threshold 0.1 Acc 0.9055921052631579, AUC 0.9760596752166748, avg_entr 0.007621804252266884
ep9_t0.1_test_time 0.1456902027130127
Best AUC 0.9797168970108032
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad25_t0.1_m4//ag_news_lstmal_l5_prefix.pt
Test threshold 0.1 Acc 0.9210526315789473, AUC 0.9839195013046265, avg_entr 0.007732833735644817
t0.1_test_time 0.03839421272277832
