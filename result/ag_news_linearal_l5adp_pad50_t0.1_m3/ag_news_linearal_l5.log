total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad50_t0.1_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.03745 (4494/120000), AUC 0.6421341896057129
ep0_train_time 6.009718656539917
Test Epoch0 threshold 0.1 Acc 0.915296052631579, AUC 0.980256974697113, avg_entr 0.02527308650314808
ep0_t0.1_test_time 0.11698007583618164
Save ckpt to ckpt/ag_news_linearal_l5adp_pad50_t0.1_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.005025 (603/120000), AUC 0.668632447719574
ep1_train_time 5.478187084197998
Test Epoch1 threshold 0.1 Acc 0.9129934210526316, AUC 0.9799792170524597, avg_entr 0.02417225018143654
ep1_t0.1_test_time 0.11544680595397949
gc 0
Train Epoch2 Acc 0.010975 (1317/120000), AUC 0.6807835102081299
ep2_train_time 5.47946572303772
Test Epoch2 threshold 0.1 Acc 0.9138157894736842, AUC 0.9803372621536255, avg_entr 0.023989135399460793
ep2_t0.1_test_time 0.11528921127319336
Save ckpt to ckpt/ag_news_linearal_l5adp_pad50_t0.1_m3//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.014025 (1683/120000), AUC 0.6648053526878357
ep3_train_time 5.862860441207886
Test Epoch3 threshold 0.1 Acc 0.912828947368421, AUC 0.9798682928085327, avg_entr 0.022583767771720886
ep3_t0.1_test_time 0.11916208267211914
gc 0
Train Epoch4 Acc 0.012391666666666667 (1487/120000), AUC 0.6205452084541321
ep4_train_time 5.8988542556762695
Test Epoch4 threshold 0.1 Acc 0.9113486842105263, AUC 0.979653537273407, avg_entr 0.02078346535563469
ep4_t0.1_test_time 0.11972689628601074
gc 0
Train Epoch5 Acc 0.0117 (1404/120000), AUC 0.6055659651756287
ep5_train_time 5.619687080383301
Test Epoch5 threshold 0.1 Acc 0.9123355263157895, AUC 0.9793840646743774, avg_entr 0.020909542217850685
ep5_t0.1_test_time 0.1150960922241211
gc 0
Train Epoch6 Acc 0.012783333333333334 (1534/120000), AUC 0.602205753326416
ep6_train_time 5.6009252071380615
Test Epoch6 threshold 0.1 Acc 0.9125, AUC 0.9793431758880615, avg_entr 0.020686296746134758
ep6_t0.1_test_time 0.11553072929382324
gc 0
Train Epoch7 Acc 0.014975 (1797/120000), AUC 0.5991281270980835
ep7_train_time 5.577575445175171
Test Epoch7 threshold 0.1 Acc 0.9120065789473685, AUC 0.9791824817657471, avg_entr 0.019238268956542015
ep7_t0.1_test_time 0.1157834529876709
gc 0
Train Epoch8 Acc 0.0187 (2244/120000), AUC 0.5940276980400085
ep8_train_time 5.541298866271973
Test Epoch8 threshold 0.1 Acc 0.9110197368421052, AUC 0.9790611267089844, avg_entr 0.018555475398898125
ep8_t0.1_test_time 0.11649203300476074
gc 0
Train Epoch9 Acc 0.021158333333333335 (2539/120000), AUC 0.5900049805641174
ep9_train_time 5.859587907791138
Test Epoch9 threshold 0.1 Acc 0.9116776315789473, AUC 0.9789783954620361, avg_entr 0.018026946112513542
ep9_t0.1_test_time 0.11554813385009766
Best AUC 0.9803372621536255
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad50_t0.1_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9236842105263158, AUC 0.9854573011398315, avg_entr 0.022022295743227005
t0.1_test_time 0.030230998992919922
