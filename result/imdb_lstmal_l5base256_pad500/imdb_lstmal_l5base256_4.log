total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 27.619271503
Start Training
gc 0
Train Epoch0 Acc 0.500825 (20033/40000), AUC 0.49945276975631714
ep0_train_time 203.143520859
Test Epoch0 layer4 Acc 0.5056, AUC 0.504712700843811, avg_entr 0.6845753788948059, f1 0.5055999755859375
ep0_l4_test_time 6.941067594999993
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.5287 (21148/40000), AUC 0.551910400390625
ep1_train_time 202.65873822799998
Test Epoch1 layer4 Acc 0.7054, AUC 0.7867851257324219, avg_entr 0.5710420608520508, f1 0.7053999900817871
ep1_l4_test_time 6.681610434999982
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.812275 (32491/40000), AUC 0.8651638627052307
ep2_train_time 204.95866039200007
Test Epoch2 layer4 Acc 0.8376, AUC 0.9090562462806702, avg_entr 0.15831398963928223, f1 0.8375999927520752
ep2_l4_test_time 6.871318925999958
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.869225 (34769/40000), AUC 0.9229936599731445
ep3_train_time 198.636468992
Test Epoch3 layer4 Acc 0.8546, AUC 0.9287152290344238, avg_entr 0.08750031888484955, f1 0.8546000123023987
ep3_l4_test_time 6.520205368999996
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.90345 (36138/40000), AUC 0.95195072889328
ep4_train_time 206.40014839699995
Test Epoch4 layer4 Acc 0.882, AUC 0.9444892406463623, avg_entr 0.06628478318452835, f1 0.8820000290870667
ep4_l4_test_time 6.824336820000099
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.91675 (36670/40000), AUC 0.9644631743431091
ep5_train_time 200.2006641490002
Test Epoch5 layer4 Acc 0.8808, AUC 0.949384331703186, avg_entr 0.05530256778001785, f1 0.8808000087738037
ep5_l4_test_time 6.974101663000056
gc 0
Train Epoch6 Acc 0.931125 (37245/40000), AUC 0.975048840045929
ep6_train_time 206.23080053499984
Test Epoch6 layer4 Acc 0.8776, AUC 0.9491313695907593, avg_entr 0.057854168117046356, f1 0.8776000142097473
ep6_l4_test_time 6.795548910999969
gc 0
Train Epoch7 Acc 0.938025 (37521/40000), AUC 0.9788169860839844
ep7_train_time 202.09969266100006
Test Epoch7 layer4 Acc 0.8904, AUC 0.9493866562843323, avg_entr 0.045412782579660416, f1 0.8903999924659729
ep7_l4_test_time 6.904435449999937
Save ckpt to ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.94545 (37818/40000), AUC 0.982375979423523
ep8_train_time 204.60263409799995
Test Epoch8 layer4 Acc 0.889, AUC 0.9490986466407776, avg_entr 0.03940155357122421, f1 0.8889999985694885
ep8_l4_test_time 6.567540047999955
gc 0
Train Epoch9 Acc 0.948325 (37933/40000), AUC 0.9848552942276001
ep9_train_time 203.68527632099995
Test Epoch9 layer4 Acc 0.8854, AUC 0.9505528211593628, avg_entr 0.04490743577480316, f1 0.8853999972343445
ep9_l4_test_time 6.940830754999752
gc 0
Train Epoch10 Acc 0.952725 (38109/40000), AUC 0.9867584705352783
ep10_train_time 202.17134901200006
Test Epoch10 layer4 Acc 0.884, AUC 0.946405291557312, avg_entr 0.03828468546271324, f1 0.8840000033378601
ep10_l4_test_time 6.736820992000048
gc 0
Train Epoch11 Acc 0.958425 (38337/40000), AUC 0.9893563985824585
ep11_train_time 205.64265617799992
Test Epoch11 layer4 Acc 0.8802, AUC 0.9443274736404419, avg_entr 0.03239298239350319, f1 0.8802000284194946
ep11_l4_test_time 6.909244942999976
gc 0
Train Epoch12 Acc 0.9603 (38412/40000), AUC 0.9904849529266357
ep12_train_time 200.9152198380002
Test Epoch12 layer4 Acc 0.8782, AUC 0.941020131111145, avg_entr 0.028756197541952133, f1 0.8781999945640564
ep12_l4_test_time 6.625232837000112
gc 0
Train Epoch13 Acc 0.963025 (38521/40000), AUC 0.9912815093994141
ep13_train_time 206.78425252599982
Test Epoch13 layer4 Acc 0.8774, AUC 0.9419733285903931, avg_entr 0.03488951548933983, f1 0.8773999810218811
ep13_l4_test_time 6.6402967300000455
gc 0
Train Epoch14 Acc 0.965225 (38609/40000), AUC 0.9928135871887207
ep14_train_time 201.09802882799977
Test Epoch14 layer4 Acc 0.877, AUC 0.9402756094932556, avg_entr 0.034791331738233566, f1 0.8769999742507935
ep14_l4_test_time 6.9630026120003095
gc 0
Train Epoch15 Acc 0.966425 (38657/40000), AUC 0.9929440021514893
ep15_train_time 205.5466830539999
Test Epoch15 layer4 Acc 0.8698, AUC 0.9397419095039368, avg_entr 0.030159685760736465, f1 0.8697999715805054
ep15_l4_test_time 6.758913696000036
gc 0
Train Epoch16 Acc 0.9688 (38752/40000), AUC 0.9940069913864136
ep16_train_time 202.77381699299985
Test Epoch16 layer4 Acc 0.874, AUC 0.936815619468689, avg_entr 0.021063530817627907, f1 0.8740000128746033
ep16_l4_test_time 7.019023587999982
gc 0
Train Epoch17 Acc 0.971875 (38875/40000), AUC 0.9947609901428223
ep17_train_time 203.87080274300024
Test Epoch17 layer4 Acc 0.8696, AUC 0.9321630001068115, avg_entr 0.01976589858531952, f1 0.8695999383926392
ep17_l4_test_time 6.665383235999798
gc 0
Train Epoch18 Acc 0.972775 (38911/40000), AUC 0.995189905166626
ep18_train_time 204.7320525519999
Test Epoch18 layer4 Acc 0.861, AUC 0.9320279955863953, avg_entr 0.023363357409834862, f1 0.8610000014305115
ep18_l4_test_time 6.762209868999889
gc 0
Train Epoch19 Acc 0.973675 (38947/40000), AUC 0.995671808719635
ep19_train_time 195.6167468800004
Test Epoch19 layer4 Acc 0.8668, AUC 0.9319772720336914, avg_entr 0.019837994128465652, f1 0.8668000102043152
ep19_l4_test_time 6.459843477000504
Best AUC tensor(0.8904) 7
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 4198.821875174999
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base256_pad500//imdb_lstmal_l5.pt
gc 10
Test layer0 Acc 0.8928, AUC 0.9552477598190308, avg_entr 0.1900414228439331, f1 0.892799973487854
l0_test_time 0.8091673350008932
gc 0
Test layer1 Acc 0.8876, AUC 0.944139838218689, avg_entr 0.06466501206159592, f1 0.8876000046730042
l1_test_time 2.021188797999457
gc 0
Test layer2 Acc 0.8866, AUC 0.9437602758407593, avg_entr 0.05383947864174843, f1 0.8866000771522522
l2_test_time 3.5696512559998155
gc 0
Test layer3 Acc 0.8856, AUC 0.9437497854232788, avg_entr 0.05074469745159149, f1 0.8855999708175659
l3_test_time 5.105868860000555
gc 0
Test layer4 Acc 0.884, AUC 0.9439917206764221, avg_entr 0.04871509224176407, f1 0.8840000033378601
l4_test_time 6.55412796300061
gc 0
Test threshold 0.1 Acc 0.885, AUC 0.9349024891853333, avg_entr 0.07857150584459305, f1 0.8849999904632568
t0.1_test_time 4.408068039999307
gc 0
Test threshold 0.2 Acc 0.886, AUC 0.9312542676925659, avg_entr 0.0943138524889946, f1 0.8859999775886536
t0.2_test_time 4.240878196999802
gc 0
Test threshold 0.3 Acc 0.8872, AUC 0.9299955368041992, avg_entr 0.10966435819864273, f1 0.8871999979019165
t0.3_test_time 4.129861756000537
gc 0
Test threshold 0.4 Acc 0.8882, AUC 0.9300346374511719, avg_entr 0.12664800882339478, f1 0.888200044631958
t0.4_test_time 4.018772071000058
gc 0
Test threshold 0.5 Acc 0.8886, AUC 0.9305406808853149, avg_entr 0.1454000025987625, f1 0.8885999917984009
t0.5_test_time 4.305870244000289
gc 0
Test threshold 0.6 Acc 0.8892, AUC 0.935483992099762, avg_entr 0.16628535091876984, f1 0.88919997215271
t0.6_test_time 4.440380701999857
gc 0
Test threshold 0.7 Acc 0.8894, AUC 0.9377397894859314, avg_entr 0.18706895411014557, f1 0.8894000053405762
t0.7_test_time 4.518769590000375
gc 0
Test threshold 0.8 Acc 0.8908, AUC 0.940804660320282, avg_entr 0.20580558478832245, f1 0.8907999992370605
t0.8_test_time 4.375423047999902
gc 0
Test threshold 0.9 Acc 0.8932, AUC 0.9445580840110779, avg_entr 0.23051926493644714, f1 0.8931999802589417
t0.9_test_time 4.220564632999412
