total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 56.565662833999994
Start Training
gc 0
Train Epoch0 Acc 0.6179160714285714 (346033/560000), AUC 0.8786362409591675
ep0_train_time 65.06978132699999
Test Epoch0 layer4 Acc 0.9694285714285714, AUC 0.997756838798523, avg_entr 0.3207188546657562, f1 0.9694285988807678
ep0_l4_test_time 1.5471252809999925
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9742732142857143 (545593/560000), AUC 0.9983364343643188
ep1_train_time 63.202720390999986
Test Epoch1 layer4 Acc 0.9727142857142858, AUC 0.9984492063522339, avg_entr 0.1312752366065979, f1 0.9727143049240112
ep1_l4_test_time 1.565056209000005
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9770339285714286 (547139/560000), AUC 0.9988560080528259
ep2_train_time 62.68270120699998
Test Epoch2 layer4 Acc 0.9742571428571428, AUC 0.9986391067504883, avg_entr 0.07707063108682632, f1 0.9742571711540222
ep2_l4_test_time 1.5276122920000148
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9785410714285714 (547983/560000), AUC 0.9990484118461609
ep3_train_time 62.73396475000001
Test Epoch3 layer4 Acc 0.9752857142857143, AUC 0.9986859560012817, avg_entr 0.052253931760787964, f1 0.9752857089042664
ep3_l4_test_time 1.5563059509999562
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9796946428571428 (548629/560000), AUC 0.9991204142570496
ep4_train_time 62.386612928999966
Test Epoch4 layer4 Acc 0.976, AUC 0.9986406564712524, avg_entr 0.03544243797659874, f1 0.9760000109672546
ep4_l4_test_time 1.1747382469999934
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9804053571428571 (549027/560000), AUC 0.9990903735160828
ep5_train_time 53.63148428599999
Test Epoch5 layer4 Acc 0.9764571428571429, AUC 0.998461127281189, avg_entr 0.025876199826598167, f1 0.9764571189880371
ep5_l4_test_time 1.5337925810000002
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9807910714285715 (549243/560000), AUC 0.9990058541297913
ep6_train_time 63.19411189499999
Test Epoch6 layer4 Acc 0.9760285714285715, AUC 0.998225212097168, avg_entr 0.02000906504690647, f1 0.976028561592102
ep6_l4_test_time 1.5359958490000167
gc 0
Train Epoch7 Acc 0.9811714285714286 (549456/560000), AUC 0.9989266395568848
ep7_train_time 62.74270562000004
Test Epoch7 layer4 Acc 0.9765714285714285, AUC 0.998231053352356, avg_entr 0.016039442270994186, f1 0.9765714406967163
ep7_l4_test_time 1.5741299339999841
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9814107142857142 (549590/560000), AUC 0.9988718628883362
ep8_train_time 62.760856632000014
Test Epoch8 layer4 Acc 0.9761714285714286, AUC 0.9981504678726196, avg_entr 0.0135932806879282, f1 0.9761714339256287
ep8_l4_test_time 1.53621625400001
gc 0
Train Epoch9 Acc 0.9816232142857143 (549709/560000), AUC 0.9988517761230469
ep9_train_time 62.70888916900003
Test Epoch9 layer4 Acc 0.9765142857142857, AUC 0.9980015158653259, avg_entr 0.011780071072280407, f1 0.9765142798423767
ep9_l4_test_time 1.5215832129999853
gc 0
Train Epoch10 Acc 0.9819053571428571 (549867/560000), AUC 0.9988154768943787
ep10_train_time 62.17177355900003
Test Epoch10 layer4 Acc 0.9762285714285714, AUC 0.9980148077011108, avg_entr 0.010548543184995651, f1 0.9762285947799683
ep10_l4_test_time 1.4981088249999175
gc 0
Train Epoch11 Acc 0.9820214285714286 (549932/560000), AUC 0.9987993836402893
ep11_train_time 62.92211003300008
Test Epoch11 layer4 Acc 0.9764571428571429, AUC 0.9979099035263062, avg_entr 0.00961602944880724, f1 0.9764571189880371
ep11_l4_test_time 1.51910229300006
gc 0
Train Epoch12 Acc 0.9822071428571428 (550036/560000), AUC 0.9987729787826538
ep12_train_time 62.76595584300003
Test Epoch12 layer4 Acc 0.9764285714285714, AUC 0.9978785514831543, avg_entr 0.008666596375405788, f1 0.9764285683631897
ep12_l4_test_time 1.528701913999953
gc 0
Train Epoch13 Acc 0.9823803571428571 (550133/560000), AUC 0.9987700581550598
ep13_train_time 62.86526308700002
Test Epoch13 layer4 Acc 0.9763714285714286, AUC 0.9978685975074768, avg_entr 0.008132031187415123, f1 0.9763714075088501
ep13_l4_test_time 1.509270980999986
gc 0
Train Epoch14 Acc 0.9825357142857143 (550220/560000), AUC 0.9987749457359314
ep14_train_time 62.792965510000045
Test Epoch14 layer4 Acc 0.9766285714285714, AUC 0.9978180527687073, avg_entr 0.007541164755821228, f1 0.9766285419464111
ep14_l4_test_time 1.529018570000062
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.9826732142857143 (550297/560000), AUC 0.9987449049949646
ep15_train_time 62.339501954999946
Test Epoch15 layer4 Acc 0.9766571428571429, AUC 0.9977838397026062, avg_entr 0.007007343228906393, f1 0.9766571521759033
ep15_l4_test_time 1.5120616740000514
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.9827875 (550361/560000), AUC 0.9987501502037048
ep16_train_time 62.27766101300017
Test Epoch16 layer4 Acc 0.9764857142857143, AUC 0.9977355003356934, avg_entr 0.006645447574555874, f1 0.9764857292175293
ep16_l4_test_time 1.5337544470000921
gc 0
Train Epoch17 Acc 0.9828767857142857 (550411/560000), AUC 0.9987301826477051
ep17_train_time 63.09494645299992
Test Epoch17 layer4 Acc 0.9772285714285714, AUC 0.9977213740348816, avg_entr 0.006296345964074135, f1 0.977228581905365
ep17_l4_test_time 1.5251126189998558
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 17
gc 0
Train Epoch18 Acc 0.9830714285714286 (550520/560000), AUC 0.9987427592277527
ep18_train_time 62.96498875299994
Test Epoch18 layer4 Acc 0.9767428571428571, AUC 0.9977259635925293, avg_entr 0.006008385214954615, f1 0.9767428636550903
ep18_l4_test_time 1.5503786960000525
gc 0
Train Epoch19 Acc 0.9831625 (550571/560000), AUC 0.9987574219703674
ep19_train_time 62.63342644299996
Test Epoch19 layer4 Acc 0.9769428571428571, AUC 0.9976810812950134, avg_entr 0.0057926420122385025, f1 0.9769428372383118
ep19_l4_test_time 1.531994412999893
Best AUC tensor(0.9772) 17
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 1279.953359689
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9738857142857142, AUC 0.9982498288154602, avg_entr 0.025923877954483032, f1 0.973885715007782
l0_test_time 1.5334304150001117
gc 0
Test layer1 Acc 0.9746, AUC 0.9984460473060608, avg_entr 0.019753528758883476, f1 0.9746000170707703
l1_test_time 1.532110350000039
gc 0
Test layer2 Acc 0.9764857142857143, AUC 0.998411238193512, avg_entr 0.011931613087654114, f1 0.9764857292175293
l2_test_time 1.5110590889999003
gc 0
Test layer3 Acc 0.9763428571428572, AUC 0.9980868101119995, avg_entr 0.00803296733647585, f1 0.9763428568840027
l3_test_time 1.5206374269998832
gc 0
Test layer4 Acc 0.9759428571428571, AUC 0.997943103313446, avg_entr 0.006687552202492952, f1 0.975942850112915
l4_test_time 1.5173280559999966
gc 0
Test threshold 0.1 Acc 0.9748285714285714, AUC 0.9982916116714478, avg_entr 0.005835970863699913, f1 0.9748286008834839
t0.1_test_time 5.691909629000065
gc 0
Test threshold 0.2 Acc 0.9741142857142857, AUC 0.9982511401176453, avg_entr 0.009581747464835644, f1 0.9741142988204956
t0.2_test_time 3.6594499010000163
gc 0
Test threshold 0.3 Acc 0.9738857142857142, AUC 0.9982498288154602, avg_entr 0.009823158383369446, f1 0.973885715007782
t0.3_test_time 3.0269471100000374
gc 0
Test threshold 0.4 Acc 0.9738857142857142, AUC 0.9982498288154602, avg_entr 0.009823158383369446, f1 0.973885715007782
t0.4_test_time 2.9574517710000237
gc 0
Test threshold 0.5 Acc 0.9738857142857142, AUC 0.9982498288154602, avg_entr 0.009823158383369446, f1 0.973885715007782
t0.5_test_time 2.97449854599995
gc 0
Test threshold 0.6 Acc 0.9738857142857142, AUC 0.9982498288154602, avg_entr 0.009823158383369446, f1 0.973885715007782
t0.6_test_time 2.8845389369998884
gc 0
Test threshold 0.7 Acc 0.9738857142857142, AUC 0.9982498288154602, avg_entr 0.009823158383369446, f1 0.973885715007782
t0.7_test_time 2.9261537639999915
gc 0
Test threshold 0.8 Acc 0.9738857142857142, AUC 0.9982498288154602, avg_entr 0.009823158383369446, f1 0.973885715007782
t0.8_test_time 2.917976316000022
gc 0
Test threshold 0.9 Acc 0.9738857142857142, AUC 0.9982498288154602, avg_entr 0.009823158383369446, f1 0.973885715007782
t0.9_test_time 2.9053636880000795
