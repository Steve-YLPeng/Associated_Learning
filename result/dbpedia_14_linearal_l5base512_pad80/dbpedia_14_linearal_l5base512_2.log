total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 56.483544415000004
Start Training
gc 0
Train Epoch0 Acc 0.5897482142857143 (330259/560000), AUC 0.865204393863678
ep0_train_time 64.443612458
Test Epoch0 layer4 Acc 0.9687714285714286, AUC 0.9974742531776428, avg_entr 0.31752219796180725, f1 0.9687715172767639
ep0_l4_test_time 1.5260720229999976
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9742428571428572 (545576/560000), AUC 0.9982636570930481
ep1_train_time 63.504370984999994
Test Epoch1 layer4 Acc 0.9726857142857143, AUC 0.9982696771621704, avg_entr 0.132485494017601, f1 0.972685694694519
ep1_l4_test_time 1.5373994089999883
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9771375 (547197/560000), AUC 0.9988170266151428
ep2_train_time 62.96354898999999
Test Epoch2 layer4 Acc 0.9744285714285714, AUC 0.9984947443008423, avg_entr 0.0761079415678978, f1 0.9744285941123962
ep2_l4_test_time 1.5389234339999973
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9786464285714286 (548042/560000), AUC 0.9990280866622925
ep3_train_time 62.967441794999985
Test Epoch3 layer4 Acc 0.9753428571428572, AUC 0.998566210269928, avg_entr 0.05078866332769394, f1 0.975342869758606
ep3_l4_test_time 1.5432235170000013
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9796196428571429 (548587/560000), AUC 0.9991229176521301
ep4_train_time 63.05647750000003
Test Epoch4 layer4 Acc 0.9760285714285715, AUC 0.9985276460647583, avg_entr 0.034746017307043076, f1 0.976028561592102
ep4_l4_test_time 1.5123547389999885
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9804071428571428 (549028/560000), AUC 0.9991074800491333
ep5_train_time 62.571507645000054
Test Epoch5 layer4 Acc 0.9764857142857143, AUC 0.9982998967170715, avg_entr 0.024849874898791313, f1 0.9764857292175293
ep5_l4_test_time 1.4767399360000013
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.98095 (549332/560000), AUC 0.9990113377571106
ep6_train_time 62.78721605499999
Test Epoch6 layer4 Acc 0.9758, AUC 0.998198390007019, avg_entr 0.018923232331871986, f1 0.9757999777793884
ep6_l4_test_time 1.5088923499999964
gc 0
Train Epoch7 Acc 0.9812428571428572 (549496/560000), AUC 0.9989281892776489
ep7_train_time 63.034084898
Test Epoch7 layer4 Acc 0.976, AUC 0.9979856610298157, avg_entr 0.01540922187268734, f1 0.9760000109672546
ep7_l4_test_time 1.5502514780000638
gc 0
Train Epoch8 Acc 0.9816107142857143 (549702/560000), AUC 0.9988904595375061
ep8_train_time 62.939391332000014
Test Epoch8 layer4 Acc 0.976, AUC 0.9978980422019958, avg_entr 0.013208421878516674, f1 0.9760000109672546
ep8_l4_test_time 1.524958584999922
gc 0
Train Epoch9 Acc 0.9817607142857143 (549786/560000), AUC 0.998868465423584
ep9_train_time 63.058973175000006
Test Epoch9 layer4 Acc 0.9760857142857143, AUC 0.9978869557380676, avg_entr 0.011635216884315014, f1 0.9760857224464417
ep9_l4_test_time 1.5366799380000202
gc 0
Train Epoch10 Acc 0.9819339285714286 (549883/560000), AUC 0.9988600015640259
ep10_train_time 62.64921433500001
Test Epoch10 layer4 Acc 0.9759428571428571, AUC 0.9978212118148804, avg_entr 0.010395657271146774, f1 0.975942850112915
ep10_l4_test_time 1.4714936630000466
gc 0
Train Epoch11 Acc 0.9820857142857143 (549968/560000), AUC 0.9988168478012085
ep11_train_time 62.21041348999995
Test Epoch11 layer4 Acc 0.9766285714285714, AUC 0.9977712631225586, avg_entr 0.009356393478810787, f1 0.9766285419464111
ep11_l4_test_time 1.4953482669999403
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9822714285714286 (550072/560000), AUC 0.998836100101471
ep12_train_time 63.08721488799995
Test Epoch12 layer4 Acc 0.9766, AUC 0.9977054595947266, avg_entr 0.008519462309777737, f1 0.9765999913215637
ep12_l4_test_time 1.5352732159999505
gc 0
Train Epoch13 Acc 0.9824392857142857 (550166/560000), AUC 0.9988006949424744
ep13_train_time 63.18300711200004
Test Epoch13 layer4 Acc 0.9761428571428571, AUC 0.9976946711540222, avg_entr 0.00792380329221487, f1 0.9761428833007812
ep13_l4_test_time 1.5201230249999753
gc 0
Train Epoch14 Acc 0.9826035714285715 (550258/560000), AUC 0.998797595500946
ep14_train_time 62.945534688000066
Test Epoch14 layer4 Acc 0.9764857142857143, AUC 0.9976359009742737, avg_entr 0.007268068380653858, f1 0.9764857292175293
ep14_l4_test_time 1.530180153000174
gc 0
Train Epoch15 Acc 0.9826892857142857 (550306/560000), AUC 0.9987813234329224
ep15_train_time 62.83214802799989
Test Epoch15 layer4 Acc 0.9767714285714286, AUC 0.9976963400840759, avg_entr 0.006834982428699732, f1 0.9767714142799377
ep15_l4_test_time 1.519322844000044
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.9827696428571429 (550351/560000), AUC 0.9987700581550598
ep16_train_time 62.36577181100006
Test Epoch16 layer4 Acc 0.9764857142857143, AUC 0.9975829720497131, avg_entr 0.0064287916757166386, f1 0.9764857292175293
ep16_l4_test_time 1.5098655670001335
gc 0
Train Epoch17 Acc 0.9829767857142857 (550467/560000), AUC 0.998741626739502
ep17_train_time 62.866816394000125
Test Epoch17 layer4 Acc 0.9766857142857143, AUC 0.9976421594619751, avg_entr 0.006252443417906761, f1 0.9766857028007507
ep17_l4_test_time 1.5138345309999295
gc 0
Train Epoch18 Acc 0.9830928571428571 (550532/560000), AUC 0.998782753944397
ep18_train_time 63.20002348400021
Test Epoch18 layer4 Acc 0.977, AUC 0.997552216053009, avg_entr 0.005959661677479744, f1 0.9769999980926514
ep18_l4_test_time 1.5159966180001447
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 18
gc 0
Train Epoch19 Acc 0.9830714285714286 (550520/560000), AUC 0.9987611174583435
ep19_train_time 62.78052817799994
Test Epoch19 layer4 Acc 0.977, AUC 0.9975822567939758, avg_entr 0.0057726274244487286, f1 0.9769999980926514
ep19_l4_test_time 1.5415055309999843
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 19
Best AUC tensor(0.9770) 19
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 1291.564801997
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9744857142857143, AUC 0.998271107673645, avg_entr 0.025536643341183662, f1 0.9744856953620911
l0_test_time 1.5186350190001576
gc 0
Test layer1 Acc 0.9751142857142857, AUC 0.9984477758407593, avg_entr 0.019027231261134148, f1 0.9751142859458923
l1_test_time 1.5142881169999782
gc 0
Test layer2 Acc 0.9762, AUC 0.9983302354812622, avg_entr 0.010846244171261787, f1 0.9761999845504761
l2_test_time 1.546512668000105
gc 0
Test layer3 Acc 0.9769142857142857, AUC 0.998008131980896, avg_entr 0.007414072751998901, f1 0.9769142866134644
l3_test_time 1.5475138209999386
gc 0
Test layer4 Acc 0.9766285714285714, AUC 0.9977421760559082, avg_entr 0.006164685823023319, f1 0.9766285419464111
l4_test_time 1.5408498799999961
gc 0
Test threshold 0.1 Acc 0.9751428571428571, AUC 0.9982947111129761, avg_entr 0.005658646114170551, f1 0.9751428365707397
t0.1_test_time 5.333898901000111
gc 0
Test threshold 0.2 Acc 0.9744857142857143, AUC 0.9982721209526062, avg_entr 0.009450874291360378, f1 0.9744856953620911
t0.2_test_time 3.458897042999979
gc 0
Test threshold 0.3 Acc 0.9744571428571429, AUC 0.998271107673645, avg_entr 0.00966978631913662, f1 0.9744571447372437
t0.3_test_time 2.9279509839998354
gc 0
Test threshold 0.4 Acc 0.9744857142857143, AUC 0.998271107673645, avg_entr 0.009676424786448479, f1 0.9744856953620911
t0.4_test_time 3.0533058739999888
gc 0
Test threshold 0.5 Acc 0.9744857142857143, AUC 0.998271107673645, avg_entr 0.009676424786448479, f1 0.9744856953620911
t0.5_test_time 3.087525970000115
gc 0
Test threshold 0.6 Acc 0.9744857142857143, AUC 0.998271107673645, avg_entr 0.009676424786448479, f1 0.9744856953620911
t0.6_test_time 2.9457496160000574
gc 0
Test threshold 0.7 Acc 0.9744857142857143, AUC 0.998271107673645, avg_entr 0.009676424786448479, f1 0.9744856953620911
t0.7_test_time 3.0689828570000373
gc 0
Test threshold 0.8 Acc 0.9744857142857143, AUC 0.998271107673645, avg_entr 0.009676424786448479, f1 0.9744856953620911
t0.8_test_time 2.962089137000021
gc 0
Test threshold 0.9 Acc 0.9744857142857143, AUC 0.998271107673645, avg_entr 0.009676424786448479, f1 0.9744856953620911
t0.9_test_time 3.0787533489999532
