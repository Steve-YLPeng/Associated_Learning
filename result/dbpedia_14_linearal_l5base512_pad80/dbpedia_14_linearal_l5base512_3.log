total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 55.222585446
Start Training
gc 0
Train Epoch0 Acc 0.6440857142857143 (360688/560000), AUC 0.8858186602592468
ep0_train_time 52.446379066999995
Test Epoch0 layer4 Acc 0.9696571428571429, AUC 0.9977446794509888, avg_entr 0.3271492123603821, f1 0.9696571230888367
ep0_l4_test_time 1.3861137610000043
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9745732142857143 (545761/560000), AUC 0.998346745967865
ep1_train_time 49.51903519400001
Test Epoch1 layer4 Acc 0.9726571428571429, AUC 0.9983498454093933, avg_entr 0.13054855167865753, f1 0.9726571440696716
ep1_l4_test_time 1.263391743999989
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.977225 (547246/560000), AUC 0.9988504648208618
ep2_train_time 48.89396359
Test Epoch2 layer4 Acc 0.9745714285714285, AUC 0.9985423684120178, avg_entr 0.0764126256108284, f1 0.9745714068412781
ep2_l4_test_time 1.2764836890000026
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9786678571428571 (548054/560000), AUC 0.9990323781967163
ep3_train_time 47.350577912999995
Test Epoch3 layer4 Acc 0.9755714285714285, AUC 0.9986353516578674, avg_entr 0.05157532915472984, f1 0.9755714535713196
ep3_l4_test_time 1.2074840759999574
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9798142857142857 (548696/560000), AUC 0.9990864992141724
ep4_train_time 48.920128001999956
Test Epoch4 layer4 Acc 0.9753428571428572, AUC 0.9985147714614868, avg_entr 0.03513320907950401, f1 0.975342869758606
ep4_l4_test_time 1.4386849250000182
gc 0
Train Epoch5 Acc 0.9804053571428571 (549027/560000), AUC 0.9990386962890625
ep5_train_time 50.946062289999986
Test Epoch5 layer4 Acc 0.9756571428571429, AUC 0.9983469843864441, avg_entr 0.025852512568235397, f1 0.9756571650505066
ep5_l4_test_time 1.3260343540000008
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9807053571428571 (549195/560000), AUC 0.9989527463912964
ep6_train_time 48.10028743699996
Test Epoch6 layer4 Acc 0.9757142857142858, AUC 0.998171329498291, avg_entr 0.019735628738999367, f1 0.9757142663002014
ep6_l4_test_time 1.2689157249999994
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9810875 (549409/560000), AUC 0.9988779425621033
ep7_train_time 49.461565586000006
Test Epoch7 layer4 Acc 0.9760285714285715, AUC 0.9980753064155579, avg_entr 0.0159041378647089, f1 0.976028561592102
ep7_l4_test_time 1.284651044000043
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9813142857142857 (549536/560000), AUC 0.9988215565681458
ep8_train_time 46.87084015199997
Test Epoch8 layer4 Acc 0.9757142857142858, AUC 0.997951090335846, avg_entr 0.013400436379015446, f1 0.9757142663002014
ep8_l4_test_time 1.196117322999953
gc 0
Train Epoch9 Acc 0.9814428571428572 (549608/560000), AUC 0.9988232851028442
ep9_train_time 49.45869336099997
Test Epoch9 layer4 Acc 0.9761428571428571, AUC 0.9979812502861023, avg_entr 0.011574424803256989, f1 0.9761428833007812
ep9_l4_test_time 1.371040315000073
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9817089285714286 (549757/560000), AUC 0.9988092184066772
ep10_train_time 50.84351699000001
Test Epoch10 layer4 Acc 0.9761142857142857, AUC 0.9979119300842285, avg_entr 0.010276307351887226, f1 0.9761142730712891
ep10_l4_test_time 1.259874491000005
gc 0
Train Epoch11 Acc 0.9819553571428571 (549895/560000), AUC 0.9988036155700684
ep11_train_time 47.605224713999974
Test Epoch11 layer4 Acc 0.9762, AUC 0.9977810978889465, avg_entr 0.0092995660379529, f1 0.9761999845504761
ep11_l4_test_time 1.292704365000077
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9820178571428572 (549930/560000), AUC 0.99878990650177
ep12_train_time 47.15078876999996
Test Epoch12 layer4 Acc 0.9762, AUC 0.9976781606674194, avg_entr 0.008477430790662766, f1 0.9761999845504761
ep12_l4_test_time 1.2913164959999222
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.9822625 (550067/560000), AUC 0.9987663626670837
ep13_train_time 46.21788854600004
Test Epoch13 layer4 Acc 0.9762857142857143, AUC 0.9976038932800293, avg_entr 0.007918802089989185, f1 0.9762856960296631
ep13_l4_test_time 1.2675406710000061
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.9823660714285715 (550125/560000), AUC 0.9987646341323853
ep14_train_time 50.38682733200005
Test Epoch14 layer4 Acc 0.9761714285714286, AUC 0.9974806904792786, avg_entr 0.0073951417580246925, f1 0.9761714339256287
ep14_l4_test_time 1.3189539069999228
gc 0
Train Epoch15 Acc 0.9824303571428571 (550161/560000), AUC 0.9987573027610779
ep15_train_time 53.24932137600001
Test Epoch15 layer4 Acc 0.9761428571428571, AUC 0.997536301612854, avg_entr 0.006957808509469032, f1 0.9761428833007812
ep15_l4_test_time 1.5144826360000252
gc 0
Train Epoch16 Acc 0.9825964285714286 (550254/560000), AUC 0.9987369775772095
ep16_train_time 52.59114956799999
Test Epoch16 layer4 Acc 0.9761142857142857, AUC 0.9974501729011536, avg_entr 0.006490667816251516, f1 0.9761142730712891
ep16_l4_test_time 1.2858739799999057
gc 0
Train Epoch17 Acc 0.9828392857142857 (550390/560000), AUC 0.9987365007400513
ep17_train_time 46.82616787199993
Test Epoch17 layer4 Acc 0.9762285714285714, AUC 0.9974711537361145, avg_entr 0.006140183657407761, f1 0.9762285947799683
ep17_l4_test_time 1.1275294559999338
gc 0
Train Epoch18 Acc 0.9829089285714285 (550429/560000), AUC 0.9987422227859497
ep18_train_time 48.593028694000054
Test Epoch18 layer4 Acc 0.9764, AUC 0.9975281953811646, avg_entr 0.005984593648463488, f1 0.9764000177383423
ep18_l4_test_time 1.3693582079999942
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 18
gc 0
Train Epoch19 Acc 0.9830696428571428 (550519/560000), AUC 0.9987306594848633
ep19_train_time 50.823218535000024
Test Epoch19 layer4 Acc 0.9766, AUC 0.9974748492240906, avg_entr 0.00569875119253993, f1 0.9765999913215637
ep19_l4_test_time 1.332482994999964
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 19
Best AUC tensor(0.9766) 19
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 1014.1196332290001
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9741428571428571, AUC 0.9983172416687012, avg_entr 0.024857455864548683, f1 0.974142849445343
l0_test_time 1.273436601999947
gc 0
Test layer1 Acc 0.9750857142857143, AUC 0.9984962344169617, avg_entr 0.018672917038202286, f1 0.9750857353210449
l1_test_time 1.280707171000131
gc 0
Test layer2 Acc 0.9767428571428571, AUC 0.9982811808586121, avg_entr 0.011207734234631062, f1 0.9767428636550903
l2_test_time 1.2415003779999552
gc 0
Test layer3 Acc 0.9765428571428572, AUC 0.9980891942977905, avg_entr 0.00778409605845809, f1 0.9765428304672241
l3_test_time 1.2356316210000386
gc 0
Test layer4 Acc 0.9764571428571429, AUC 0.9978440999984741, avg_entr 0.006393253803253174, f1 0.9764571189880371
l4_test_time 1.2350454850000006
gc 0
Test threshold 0.1 Acc 0.9745142857142857, AUC 0.9982815980911255, avg_entr 0.005528024863451719, f1 0.9745143055915833
t0.1_test_time 2.7166543450000518
gc 0
Test threshold 0.2 Acc 0.9744, AUC 0.9983186721801758, avg_entr 0.009180553257465363, f1 0.974399983882904
t0.2_test_time 1.7867051450000417
gc 0
Test threshold 0.3 Acc 0.9741428571428571, AUC 0.9983172416687012, avg_entr 0.009419066831469536, f1 0.974142849445343
t0.3_test_time 1.6719233149999582
gc 0
Test threshold 0.4 Acc 0.9741428571428571, AUC 0.9983172416687012, avg_entr 0.009419066831469536, f1 0.974142849445343
t0.4_test_time 1.6801065019999442
gc 0
Test threshold 0.5 Acc 0.9741428571428571, AUC 0.9983172416687012, avg_entr 0.009419066831469536, f1 0.974142849445343
t0.5_test_time 1.6646833190000052
gc 0
Test threshold 0.6 Acc 0.9741428571428571, AUC 0.9983172416687012, avg_entr 0.009419066831469536, f1 0.974142849445343
t0.6_test_time 1.6803202950000014
gc 0
Test threshold 0.7 Acc 0.9741428571428571, AUC 0.9983172416687012, avg_entr 0.009419066831469536, f1 0.974142849445343
t0.7_test_time 1.649686481000117
gc 0
Test threshold 0.8 Acc 0.9741428571428571, AUC 0.9983172416687012, avg_entr 0.009419066831469536, f1 0.974142849445343
t0.8_test_time 1.742999675999954
gc 0
Test threshold 0.9 Acc 0.9741428571428571, AUC 0.9983172416687012, avg_entr 0.009419066831469536, f1 0.974142849445343
t0.9_test_time 1.683397136999929
