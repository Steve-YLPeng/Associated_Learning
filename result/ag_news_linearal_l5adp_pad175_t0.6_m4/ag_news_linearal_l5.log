total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.021666666666666667 (2600/120000), AUC 0.37239062786102295
ep0_train_time 9.987602949142456
Test Epoch0 threshold 0.6 Acc 0.9179276315789474, AUC 0.9807909727096558, avg_entr 0.026516858488321304
ep0_t0.6_test_time 0.2502431869506836
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.020683333333333335 (2482/120000), AUC 0.3389565348625183
ep1_train_time 9.469376564025879
Test Epoch1 threshold 0.6 Acc 0.9148026315789474, AUC 0.9807254076004028, avg_entr 0.025466281920671463
ep1_t0.6_test_time 0.24903178215026855
gc 0
Train Epoch2 Acc 0.014141666666666667 (1697/120000), AUC 0.22587747871875763
ep2_train_time 9.431581735610962
Test Epoch2 threshold 0.6 Acc 0.9162828947368421, AUC 0.9805026650428772, avg_entr 0.02704204060137272
ep2_t0.6_test_time 0.24856925010681152
gc 0
Train Epoch3 Acc 0.008683333333333333 (1042/120000), AUC 0.1919393241405487
ep3_train_time 9.481326341629028
Test Epoch3 threshold 0.6 Acc 0.9148026315789474, AUC 0.9802603721618652, avg_entr 0.025050034746527672
ep3_t0.6_test_time 0.24885058403015137
gc 0
Train Epoch4 Acc 0.006691666666666667 (803/120000), AUC 0.18479953706264496
ep4_train_time 9.585864305496216
Test Epoch4 threshold 0.6 Acc 0.9138157894736842, AUC 0.9800997376441956, avg_entr 0.025877434760332108
ep4_t0.6_test_time 0.24912261962890625
gc 0
Train Epoch5 Acc 0.005891666666666667 (707/120000), AUC 0.1813890039920807
ep5_train_time 9.486114978790283
Test Epoch5 threshold 0.6 Acc 0.9149671052631579, AUC 0.9801070690155029, avg_entr 0.025435756891965866
ep5_t0.6_test_time 0.25614094734191895
gc 0
Train Epoch6 Acc 0.00595 (714/120000), AUC 0.18095874786376953
ep6_train_time 9.586292505264282
Test Epoch6 threshold 0.6 Acc 0.9146381578947368, AUC 0.98002028465271, avg_entr 0.02629891224205494
ep6_t0.6_test_time 0.2492518424987793
gc 0
Train Epoch7 Acc 0.005875 (705/120000), AUC 0.18076638877391815
ep7_train_time 9.554454803466797
Test Epoch7 threshold 0.6 Acc 0.9129934210526316, AUC 0.9798700213432312, avg_entr 0.02603813260793686
ep7_t0.6_test_time 0.2485053539276123
gc 0
Train Epoch8 Acc 0.005966666666666667 (716/120000), AUC 0.1810167282819748
ep8_train_time 9.437843799591064
Test Epoch8 threshold 0.6 Acc 0.9125, AUC 0.9796915650367737, avg_entr 0.02515164390206337
ep8_t0.6_test_time 0.2487931251525879
gc 0
Train Epoch9 Acc 0.006125 (735/120000), AUC 0.18111586570739746
ep9_train_time 9.398656606674194
Test Epoch9 threshold 0.6 Acc 0.9113486842105263, AUC 0.9796388745307922, avg_entr 0.026475409045815468
ep9_t0.6_test_time 0.24979734420776367
Best AUC 0.9807909727096558
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9269736842105263, AUC 0.9864409565925598, avg_entr 0.024872159585356712
t0.6_test_time 0.06298518180847168
