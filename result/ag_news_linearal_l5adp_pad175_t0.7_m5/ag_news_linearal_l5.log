total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9027583333333333 (108331/120000), AUC 0.9825237989425659
ep0_train_time 10.387507438659668
Test Epoch0 threshold 0.7 Acc 0.9157894736842105, AUC 0.980512261390686, avg_entr 0.026375720277428627
ep0_t0.7_test_time 0.25067877769470215
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.949525 (113943/120000), AUC 0.9930552244186401
ep1_train_time 9.834385871887207
Test Epoch1 threshold 0.7 Acc 0.9166118421052631, AUC 0.9805503487586975, avg_entr 0.025609232485294342
ep1_t0.7_test_time 0.24803972244262695
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m5//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9511 (114132/120000), AUC 0.9931062459945679
ep2_train_time 10.001998901367188
Test Epoch2 threshold 0.7 Acc 0.9157894736842105, AUC 0.9804865121841431, avg_entr 0.026187075302004814
ep2_t0.7_test_time 0.24909019470214844
gc 0
Train Epoch3 Acc 0.95225 (114270/120000), AUC 0.9931572079658508
ep3_train_time 10.250844955444336
Test Epoch3 threshold 0.7 Acc 0.9149671052631579, AUC 0.9801947474479675, avg_entr 0.026562057435512543
ep3_t0.7_test_time 0.24800324440002441
gc 0
Train Epoch4 Acc 0.953025 (114363/120000), AUC 0.9936766624450684
ep4_train_time 9.78293752670288
Test Epoch4 threshold 0.7 Acc 0.9149671052631579, AUC 0.979981541633606, avg_entr 0.02541419304907322
ep4_t0.7_test_time 0.2486708164215088
gc 0
Train Epoch5 Acc 0.95495 (114594/120000), AUC 0.9943870902061462
ep5_train_time 9.914249897003174
Test Epoch5 threshold 0.7 Acc 0.9134868421052632, AUC 0.9799008369445801, avg_entr 0.026211103424429893
ep5_t0.7_test_time 0.2480013370513916
gc 0
Train Epoch6 Acc 0.9553916666666666 (114647/120000), AUC 0.9945104122161865
ep6_train_time 9.885748863220215
Test Epoch6 threshold 0.7 Acc 0.9141447368421053, AUC 0.979803740978241, avg_entr 0.026561137288808823
ep6_t0.7_test_time 0.24824976921081543
gc 0
Train Epoch7 Acc 0.9558833333333333 (114706/120000), AUC 0.9946567416191101
ep7_train_time 9.960280656814575
Test Epoch7 threshold 0.7 Acc 0.9110197368421052, AUC 0.9796188473701477, avg_entr 0.026208821684122086
ep7_t0.7_test_time 0.24763178825378418
gc 0
Train Epoch8 Acc 0.9563 (114756/120000), AUC 0.9948310256004333
ep8_train_time 9.819402694702148
Test Epoch8 threshold 0.7 Acc 0.9108552631578948, AUC 0.9795902967453003, avg_entr 0.02613751031458378
ep8_t0.7_test_time 0.24808907508850098
gc 0
Train Epoch9 Acc 0.9573833333333334 (114886/120000), AUC 0.9950448274612427
ep9_train_time 10.215429067611694
Test Epoch9 threshold 0.7 Acc 0.9126644736842106, AUC 0.9795598983764648, avg_entr 0.026723820716142654
ep9_t0.7_test_time 0.24814748764038086
Best AUC 0.9805503487586975
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.7_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9263157894736842, AUC 0.9860597848892212, avg_entr 0.024597393348813057
t0.7_test_time 0.0630640983581543
