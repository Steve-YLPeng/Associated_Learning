total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.8_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.3127666666666667 (37532/120000), AUC 0.6799271106719971
ep0_train_time 5.312469959259033
Test Epoch0 threshold 0.8 Acc 0.9120065789473685, AUC 0.9806032776832581, avg_entr 0.025432968512177467
ep0_t0.8_test_time 0.08182668685913086
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.8_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.29235833333333333 (35083/120000), AUC 0.6464476585388184
ep1_train_time 4.941096067428589
Test Epoch1 threshold 0.8 Acc 0.9123355263157895, AUC 0.9803822040557861, avg_entr 0.024658985435962677
ep1_t0.8_test_time 0.07230734825134277
gc 0
Train Epoch2 Acc 0.2748 (32976/120000), AUC 0.5615736246109009
ep2_train_time 4.877058982849121
Test Epoch2 threshold 0.8 Acc 0.9113486842105263, AUC 0.9800217747688293, avg_entr 0.025149866938591003
ep2_t0.8_test_time 0.07208418846130371
gc 0
Train Epoch3 Acc 0.26700833333333335 (32041/120000), AUC 0.5141474604606628
ep3_train_time 4.932601690292358
Test Epoch3 threshold 0.8 Acc 0.9123355263157895, AUC 0.9798074960708618, avg_entr 0.024364139884710312
ep3_t0.8_test_time 0.07153916358947754
gc 0
Train Epoch4 Acc 0.24955 (29946/120000), AUC 0.5036600828170776
ep4_train_time 4.890058279037476
Test Epoch4 threshold 0.8 Acc 0.9098684210526315, AUC 0.9796488285064697, avg_entr 0.025131823495030403
ep4_t0.8_test_time 0.07172012329101562
gc 0
Train Epoch5 Acc 0.225625 (27075/120000), AUC 0.5066103339195251
ep5_train_time 4.919672966003418
Test Epoch5 threshold 0.8 Acc 0.909375, AUC 0.9793115854263306, avg_entr 0.02533525973558426
ep5_t0.8_test_time 0.07203435897827148
gc 0
Train Epoch6 Acc 0.218375 (26205/120000), AUC 0.5107683539390564
ep6_train_time 4.886264085769653
Test Epoch6 threshold 0.8 Acc 0.9103618421052632, AUC 0.9792690277099609, avg_entr 0.02588486485183239
ep6_t0.8_test_time 0.07152414321899414
gc 0
Train Epoch7 Acc 0.2195 (26340/120000), AUC 0.5161125659942627
ep7_train_time 5.055629014968872
Test Epoch7 threshold 0.8 Acc 0.9111842105263158, AUC 0.9790359139442444, avg_entr 0.025116559118032455
ep7_t0.8_test_time 0.07435846328735352
gc 0
Train Epoch8 Acc 0.22334166666666666 (26801/120000), AUC 0.5226351618766785
ep8_train_time 5.1668291091918945
Test Epoch8 threshold 0.8 Acc 0.9113486842105263, AUC 0.9788236618041992, avg_entr 0.025412870571017265
ep8_t0.8_test_time 0.07417678833007812
gc 0
Train Epoch9 Acc 0.2242 (26904/120000), AUC 0.526540994644165
ep9_train_time 5.156598329544067
Test Epoch9 threshold 0.8 Acc 0.909375, AUC 0.9785709381103516, avg_entr 0.025602169334888458
ep9_t0.8_test_time 0.07463574409484863
Best AUC 0.9806032776832581
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.8_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9184210526315789, AUC 0.9849363565444946, avg_entr 0.026685064658522606
t0.8_test_time 0.019919872283935547
