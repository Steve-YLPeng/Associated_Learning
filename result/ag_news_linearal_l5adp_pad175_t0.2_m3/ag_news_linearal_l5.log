total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.41520833333333335 (49825/120000), AUC 0.6535757780075073
ep0_train_time 9.452191591262817
Test Epoch0 threshold 0.2 Acc 0.9157894736842105, AUC 0.980798602104187, avg_entr 0.024548163637518883
ep0_t0.2_test_time 0.26917433738708496
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4464416666666667 (53573/120000), AUC 0.6686185002326965
ep1_train_time 9.034770011901855
Test Epoch1 threshold 0.2 Acc 0.9171052631578948, AUC 0.9808156490325928, avg_entr 0.023787377402186394
ep1_t0.2_test_time 0.2685565948486328
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.4397 (52764/120000), AUC 0.6983060836791992
ep2_train_time 8.934491395950317
Test Epoch2 threshold 0.2 Acc 0.9166118421052631, AUC 0.9806045293807983, avg_entr 0.024339891970157623
ep2_t0.2_test_time 0.2687258720397949
gc 0
Train Epoch3 Acc 0.4417333333333333 (53008/120000), AUC 0.7350016236305237
ep3_train_time 8.997168779373169
Test Epoch3 threshold 0.2 Acc 0.9161184210526315, AUC 0.9804499745368958, avg_entr 0.024605274200439453
ep3_t0.2_test_time 0.26790285110473633
gc 0
Train Epoch4 Acc 0.4575166666666667 (54902/120000), AUC 0.7488387823104858
ep4_train_time 9.076043844223022
Test Epoch4 threshold 0.2 Acc 0.915625, AUC 0.9803124666213989, avg_entr 0.023244448006153107
ep4_t0.2_test_time 0.26772093772888184
gc 0
Train Epoch5 Acc 0.4790333333333333 (57484/120000), AUC 0.7494842410087585
ep5_train_time 9.075878381729126
Test Epoch5 threshold 0.2 Acc 0.9151315789473684, AUC 0.9801940321922302, avg_entr 0.02303471788764
ep5_t0.2_test_time 0.26885008811950684
gc 0
Train Epoch6 Acc 0.493425 (59211/120000), AUC 0.7494071125984192
ep6_train_time 9.060863256454468
Test Epoch6 threshold 0.2 Acc 0.915296052631579, AUC 0.9800496101379395, avg_entr 0.022653853520751
ep6_t0.2_test_time 0.2680962085723877
gc 0
Train Epoch7 Acc 0.5082916666666667 (60995/120000), AUC 0.7477830052375793
ep7_train_time 9.088318109512329
Test Epoch7 threshold 0.2 Acc 0.9149671052631579, AUC 0.9799603223800659, avg_entr 0.022674841806292534
ep7_t0.2_test_time 0.26802754402160645
gc 0
Train Epoch8 Acc 0.5254 (63048/120000), AUC 0.7413843870162964
ep8_train_time 9.021883010864258
Test Epoch8 threshold 0.2 Acc 0.9144736842105263, AUC 0.9799262881278992, avg_entr 0.0220208540558815
ep8_t0.2_test_time 0.2678103446960449
gc 0
Train Epoch9 Acc 0.5402916666666666 (64835/120000), AUC 0.7349323034286499
ep9_train_time 9.003411054611206
Test Epoch9 threshold 0.2 Acc 0.9139802631578947, AUC 0.9797725677490234, avg_entr 0.021538598462939262
ep9_t0.2_test_time 0.2668800354003906
Best AUC 0.9808156490325928
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9243421052631579, AUC 0.9863687753677368, avg_entr 0.023236196488142014
t0.2_test_time 0.06799912452697754
