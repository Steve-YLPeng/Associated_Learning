total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.402225 (48267/120000), AUC 0.46338263154029846
ep0_train_time 9.914901971817017
Test Epoch0 threshold 0.3 Acc 0.9169407894736842, AUC 0.9805607795715332, avg_entr 0.02606978639960289
ep0_t0.3_test_time 0.26711606979370117
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.30025833333333335 (36031/120000), AUC 0.490085631608963
ep1_train_time 9.55379843711853
Test Epoch1 threshold 0.3 Acc 0.915625, AUC 0.9803826212882996, avg_entr 0.02517714723944664
ep1_t0.3_test_time 0.26372504234313965
gc 0
Train Epoch2 Acc 0.31876666666666664 (38252/120000), AUC 0.473180890083313
ep2_train_time 9.42077922821045
Test Epoch2 threshold 0.3 Acc 0.9136513157894737, AUC 0.9800844192504883, avg_entr 0.02513858862221241
ep2_t0.3_test_time 0.264237642288208
gc 0
Train Epoch3 Acc 0.3609 (43308/120000), AUC 0.4680452346801758
ep3_train_time 9.521125555038452
Test Epoch3 threshold 0.3 Acc 0.9138157894736842, AUC 0.9798714518547058, avg_entr 0.025509342551231384
ep3_t0.3_test_time 0.26305699348449707
gc 0
Train Epoch4 Acc 0.42938333333333334 (51526/120000), AUC 0.49430543184280396
ep4_train_time 9.428895711898804
Test Epoch4 threshold 0.3 Acc 0.912828947368421, AUC 0.9797864556312561, avg_entr 0.025403397157788277
ep4_t0.3_test_time 0.2627100944519043
gc 0
Train Epoch5 Acc 0.46605833333333335 (55927/120000), AUC 0.5094583034515381
ep5_train_time 9.461949110031128
Test Epoch5 threshold 0.3 Acc 0.9134868421052632, AUC 0.9797921180725098, avg_entr 0.024963000789284706
ep5_t0.3_test_time 0.261199951171875
gc 0
Train Epoch6 Acc 0.465075 (55809/120000), AUC 0.5273621082305908
ep6_train_time 9.39760947227478
Test Epoch6 threshold 0.3 Acc 0.9133223684210526, AUC 0.9796715974807739, avg_entr 0.02429281733930111
ep6_t0.3_test_time 0.25999975204467773
gc 0
Train Epoch7 Acc 0.4564 (54768/120000), AUC 0.5473027229309082
ep7_train_time 9.467234134674072
Test Epoch7 threshold 0.3 Acc 0.9136513157894737, AUC 0.9795681238174438, avg_entr 0.024243267253041267
ep7_t0.3_test_time 0.27166748046875
gc 0
Train Epoch8 Acc 0.44051666666666667 (52862/120000), AUC 0.5628782510757446
ep8_train_time 9.667528867721558
Test Epoch8 threshold 0.3 Acc 0.9133223684210526, AUC 0.9794891476631165, avg_entr 0.024523282423615456
ep8_t0.3_test_time 0.2604954242706299
gc 0
Train Epoch9 Acc 0.42656666666666665 (51188/120000), AUC 0.5737448930740356
ep9_train_time 9.488532066345215
Test Epoch9 threshold 0.3 Acc 0.9118421052631579, AUC 0.979433000087738, avg_entr 0.02413039281964302
ep9_t0.3_test_time 0.26198291778564453
Best AUC 0.9805607795715332
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9256578947368421, AUC 0.9861618280410767, avg_entr 0.024755222722887993
t0.3_test_time 0.06723284721374512
