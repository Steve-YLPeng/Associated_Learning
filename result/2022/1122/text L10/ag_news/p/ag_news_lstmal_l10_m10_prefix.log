total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask9//ag_news/ag_news_lstmal_l10_m9.pt
Start Training
gc 9
Train Epoch0 Acc 0.9062666666666667 (108752/120000), AUC 0.9825468063354492
Test Epoch0 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch0 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch0 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch0 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch0 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch0 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch0 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch0 layer7 Acc 0.9148684210526316, AUC 0.9825167059898376
Test Epoch0 layer8 Acc 0.9146052631578947, AUC 0.9830958247184753
Test Epoch0 layer9 Acc 0.9130263157894737, AUC 0.980809211730957
Save ckpt to ./ckpt/mask10//ag_news/ag_news_lstmal_l10_m10.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9508916666666667 (114107/120000), AUC 0.9924240112304688
Test Epoch1 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch1 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch1 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch1 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch1 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch1 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch1 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch1 layer7 Acc 0.9148684210526316, AUC 0.9825167059898376
Test Epoch1 layer8 Acc 0.9146052631578947, AUC 0.9830958247184753
Test Epoch1 layer9 Acc 0.9131578947368421, AUC 0.98060542345047
gc 0
Train Epoch2 Acc 0.95125 (114150/120000), AUC 0.9925010204315186
Test Epoch2 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch2 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch2 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch2 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch2 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch2 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch2 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch2 layer7 Acc 0.9148684210526316, AUC 0.9825167059898376
Test Epoch2 layer8 Acc 0.9146052631578947, AUC 0.9830958247184753
Test Epoch2 layer9 Acc 0.9135526315789474, AUC 0.9811520576477051
Save ckpt to ./ckpt/mask10//ag_news/ag_news_lstmal_l10_m10.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.951475 (114177/120000), AUC 0.9926126003265381
Test Epoch3 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch3 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch3 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch3 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch3 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch3 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch3 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch3 layer7 Acc 0.9148684210526316, AUC 0.9825167059898376
Test Epoch3 layer8 Acc 0.9146052631578947, AUC 0.9830958247184753
Test Epoch3 layer9 Acc 0.9136842105263158, AUC 0.9806463718414307
gc 0
Train Epoch4 Acc 0.95165 (114198/120000), AUC 0.9926437139511108
Test Epoch4 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch4 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch4 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch4 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch4 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch4 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch4 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch4 layer7 Acc 0.9148684210526316, AUC 0.9825167059898376
Test Epoch4 layer8 Acc 0.9146052631578947, AUC 0.9830958247184753
Test Epoch4 layer9 Acc 0.9138157894736842, AUC 0.9812954068183899
Save ckpt to ./ckpt/mask10//ag_news/ag_news_lstmal_l10_m10.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.951775 (114213/120000), AUC 0.9927703142166138
Test Epoch5 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch5 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch5 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch5 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch5 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch5 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch5 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch5 layer7 Acc 0.9148684210526316, AUC 0.9825167059898376
Test Epoch5 layer8 Acc 0.9146052631578947, AUC 0.9830958247184753
Test Epoch5 layer9 Acc 0.9131578947368421, AUC 0.9809756278991699
gc 0
Train Epoch6 Acc 0.9516833333333333 (114202/120000), AUC 0.9927904605865479
Test Epoch6 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch6 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch6 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch6 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch6 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch6 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch6 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch6 layer7 Acc 0.9148684210526316, AUC 0.9825167059898376
Test Epoch6 layer8 Acc 0.9146052631578947, AUC 0.9830958247184753
Test Epoch6 layer9 Acc 0.9130263157894737, AUC 0.981494665145874
Save ckpt to ./ckpt/mask10//ag_news/ag_news_lstmal_l10_m10.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.951925 (114231/120000), AUC 0.9928429126739502
Test Epoch7 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch7 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch7 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch7 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch7 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch7 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch7 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch7 layer7 Acc 0.9148684210526316, AUC 0.9825167059898376
Test Epoch7 layer8 Acc 0.9146052631578947, AUC 0.9830958247184753
Test Epoch7 layer9 Acc 0.9132894736842105, AUC 0.9815517663955688
Save ckpt to ./ckpt/mask10//ag_news/ag_news_lstmal_l10_m10.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9518333333333333 (114220/120000), AUC 0.9929440021514893
Test Epoch8 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch8 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch8 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch8 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch8 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch8 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch8 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch8 layer7 Acc 0.9148684210526316, AUC 0.9825167059898376
Test Epoch8 layer8 Acc 0.9146052631578947, AUC 0.9830958247184753
Test Epoch8 layer9 Acc 0.9138157894736842, AUC 0.981547474861145
gc 0
Train Epoch9 Acc 0.95205 (114246/120000), AUC 0.9929754734039307
Test Epoch9 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch9 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch9 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch9 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch9 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch9 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch9 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch9 layer7 Acc 0.9148684210526316, AUC 0.9825167059898376
Test Epoch9 layer8 Acc 0.9146052631578947, AUC 0.9830958247184753
Test Epoch9 layer9 Acc 0.9136842105263158, AUC 0.9814701080322266
Best AUC 0.9815517663955688
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask10//ag_news/ag_news_lstmal_l10_m10.pt
[[1694   64   95   47]
 [  11 1870   10    9]
 [  39   19 1682  160]
 [  43   16  151 1690]]
Figure(640x480)
[[1723   52   70   55]
 [  24 1852   12   12]
 [  53   16 1658  173]
 [  48   17  124 1711]]
Figure(640x480)
[[1722   50   75   53]
 [  22 1851   15   12]
 [  49   15 1676  160]
 [  51   17  138 1694]]
Figure(640x480)
[[1717   50   75   58]
 [  22 1850   15   13]
 [  44   15 1676  165]
 [  43   16  131 1710]]
Figure(640x480)
[[1714   52   74   60]
 [  20 1854   13   13]
 [  43   16 1669  172]
 [  42   16  127 1715]]
Figure(640x480)
[[1718   51   74   57]
 [  22 1853   14   11]
 [  46   15 1672  167]
 [  46   16  129 1709]]
Figure(640x480)
[[1716   51   75   58]
 [  22 1852   15   11]
 [  45   14 1675  166]
 [  45   15  135 1705]]
Figure(640x480)
[[1718   51   73   58]
 [  19 1857   13   11]
 [  46   16 1667  171]
 [  44   16  129 1711]]
Figure(640x480)
[[1713   50   73   64]
 [  20 1855   14   11]
 [  46   15 1662  177]
 [  41   16  122 1721]]
Figure(640x480)
[[1717   50   72   61]
 [  22 1851   14   13]
 [  47   14 1657  182]
 [  42   16  126 1716]]
Figure(640x480)
