total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask6//ag_news/ag_news_lstmal_l10_m6.pt
Start Training
gc 9
Train Epoch0 Acc 0.242375 (29085/120000), AUC 0.2802206575870514
Test Epoch0 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch0 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch0 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch0 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch0 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch0 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch0 layer6 Acc 0.9126315789473685, AUC 0.9830327033996582
Save ckpt to ./ckpt/mask7//ag_news/ag_news_lstmal_l10_m7.pt  ,ep 0
Test Epoch0 layer7 Acc 0.45973684210526317, AUC 0.5914021134376526
Test Epoch0 layer8 Acc 0.25, AUC 0.7013273239135742
Test Epoch0 layer9 Acc 0.25, AUC 0.2751670479774475
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.2435733675956726
Test Epoch1 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch1 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch1 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch1 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch1 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch1 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch1 layer6 Acc 0.9140789473684211, AUC 0.9834181070327759
Save ckpt to ./ckpt/mask7//ag_news/ag_news_lstmal_l10_m7.pt  ,ep 1
Test Epoch1 layer7 Acc 0.4373684210526316, AUC 0.5918884873390198
Test Epoch1 layer8 Acc 0.25, AUC 0.7055598497390747
Test Epoch1 layer9 Acc 0.25, AUC 0.2227640300989151
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.19310253858566284
Test Epoch2 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch2 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch2 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch2 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch2 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch2 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch2 layer6 Acc 0.9138157894736842, AUC 0.9832047820091248
Test Epoch2 layer7 Acc 0.38723684210526316, AUC 0.5942099094390869
Test Epoch2 layer8 Acc 0.25, AUC 0.7054150700569153
Test Epoch2 layer9 Acc 0.25, AUC 0.202475443482399
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.1855040043592453
Test Epoch3 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch3 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch3 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch3 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch3 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch3 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch3 layer6 Acc 0.9146052631578947, AUC 0.9832388758659363
Test Epoch3 layer7 Acc 0.24605263157894736, AUC 0.5964772701263428
Test Epoch3 layer8 Acc 0.25, AUC 0.7010666728019714
Test Epoch3 layer9 Acc 0.25, AUC 0.19853268563747406
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.18404538929462433
Test Epoch4 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch4 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch4 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch4 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch4 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch4 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch4 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Save ckpt to ./ckpt/mask7//ag_news/ag_news_lstmal_l10_m7.pt  ,ep 4
Test Epoch4 layer7 Acc 0.2375, AUC 0.5994203090667725
Test Epoch4 layer8 Acc 0.25, AUC 0.7041000723838806
Test Epoch4 layer9 Acc 0.25, AUC 0.19560228288173676
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.1813868135213852
Test Epoch5 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch5 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch5 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch5 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch5 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch5 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch5 layer6 Acc 0.9155263157894736, AUC 0.9829791784286499
Test Epoch5 layer7 Acc 0.2369736842105263, AUC 0.6099055409431458
Test Epoch5 layer8 Acc 0.25, AUC 0.704157292842865
Test Epoch5 layer9 Acc 0.25, AUC 0.19384504854679108
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.1809333711862564
Test Epoch6 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch6 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch6 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch6 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch6 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch6 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch6 layer6 Acc 0.9151315789473684, AUC 0.9832969903945923
Test Epoch6 layer7 Acc 0.23657894736842106, AUC 0.6117771863937378
Test Epoch6 layer8 Acc 0.25, AUC 0.7007659673690796
Test Epoch6 layer9 Acc 0.25, AUC 0.19346728920936584
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.18079571425914764
Test Epoch7 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch7 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch7 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch7 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch7 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch7 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch7 layer6 Acc 0.9153947368421053, AUC 0.9828720092773438
Test Epoch7 layer7 Acc 0.23644736842105263, AUC 0.6242254972457886
Test Epoch7 layer8 Acc 0.25, AUC 0.6957088708877563
Test Epoch7 layer9 Acc 0.25, AUC 0.1919601559638977
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.18076352775096893
Test Epoch8 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch8 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch8 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch8 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch8 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch8 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch8 layer6 Acc 0.9153947368421053, AUC 0.9832817316055298
Test Epoch8 layer7 Acc 0.23644736842105263, AUC 0.6412256956100464
Test Epoch8 layer8 Acc 0.25, AUC 0.696940541267395
Test Epoch8 layer9 Acc 0.25, AUC 0.19183647632598877
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.1798207312822342
Test Epoch9 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch9 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch9 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch9 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch9 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch9 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch9 layer6 Acc 0.9147368421052632, AUC 0.9830758571624756
Test Epoch9 layer7 Acc 0.2361842105263158, AUC 0.6542948484420776
Test Epoch9 layer8 Acc 0.25, AUC 0.6927628517150879
Test Epoch9 layer9 Acc 0.25, AUC 0.18994277715682983
Best AUC 0.9834202527999878
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask7//ag_news/ag_news_lstmal_l10_m7.pt
[[1694   64   95   47]
 [  11 1870   10    9]
 [  39   19 1682  160]
 [  43   16  151 1690]]
Figure(640x480)
[[1723   52   70   55]
 [  24 1852   12   12]
 [  53   16 1658  173]
 [  48   17  124 1711]]
Figure(640x480)
[[1722   50   75   53]
 [  22 1851   15   12]
 [  49   15 1676  160]
 [  51   17  138 1694]]
Figure(640x480)
[[1717   50   75   58]
 [  22 1850   15   13]
 [  44   15 1676  165]
 [  43   16  131 1710]]
Figure(640x480)
[[1714   52   74   60]
 [  20 1854   13   13]
 [  43   16 1669  172]
 [  42   16  127 1715]]
Figure(640x480)
[[1718   51   74   57]
 [  22 1853   14   11]
 [  46   15 1672  167]
 [  46   16  129 1709]]
Figure(640x480)
[[1716   51   75   58]
 [  22 1852   15   11]
 [  45   14 1675  166]
 [  45   15  135 1705]]
Figure(640x480)
[[1747  153    0    0]
 [1842   58    0    0]
 [  43 1857    0    0]
 [  58 1842    0    0]]
Figure(640x480)
[[   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]]
Figure(640x480)
[[1900    0    0    0]
 [1900    0    0    0]
 [1900    0    0    0]
 [1900    0    0    0]]
Figure(640x480)
