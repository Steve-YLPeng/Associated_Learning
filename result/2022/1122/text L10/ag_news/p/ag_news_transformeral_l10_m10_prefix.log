total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask9//ag_news/ag_news_transformeral_l10_m9.pt
Start Training
gc 9
Train Epoch0 Acc 0.8968916666666666 (107627/120000), AUC 0.9727179408073425
Test Epoch0 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch0 layer1 Acc 0.9156578947368421, AUC 0.9808440208435059
Test Epoch0 layer2 Acc 0.9160526315789473, AUC 0.9807242155075073
Test Epoch0 layer3 Acc 0.9155263157894736, AUC 0.9807735681533813
Test Epoch0 layer4 Acc 0.9157894736842105, AUC 0.9808797836303711
Test Epoch0 layer5 Acc 0.9156578947368421, AUC 0.9810038805007935
Test Epoch0 layer6 Acc 0.9156578947368421, AUC 0.9803842306137085
Test Epoch0 layer7 Acc 0.9146052631578947, AUC 0.9807264804840088
Test Epoch0 layer8 Acc 0.9157894736842105, AUC 0.9797008037567139
Test Epoch0 layer9 Acc 0.915921052631579, AUC 0.9788510203361511
Save ckpt to ./ckpt/mask10//ag_news/ag_news_transformeral_l10_m10.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9483916666666666 (113807/120000), AUC 0.9907258749008179
Test Epoch1 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch1 layer1 Acc 0.9156578947368421, AUC 0.9808440208435059
Test Epoch1 layer2 Acc 0.9160526315789473, AUC 0.9807242155075073
Test Epoch1 layer3 Acc 0.9155263157894736, AUC 0.9807735681533813
Test Epoch1 layer4 Acc 0.9157894736842105, AUC 0.9808797836303711
Test Epoch1 layer5 Acc 0.9156578947368421, AUC 0.9810038805007935
Test Epoch1 layer6 Acc 0.9156578947368421, AUC 0.9803842306137085
Test Epoch1 layer7 Acc 0.9146052631578947, AUC 0.9807264804840088
Test Epoch1 layer8 Acc 0.9157894736842105, AUC 0.9797008037567139
Test Epoch1 layer9 Acc 0.9151315789473684, AUC 0.9785863757133484
gc 0
Train Epoch2 Acc 0.9485916666666667 (113831/120000), AUC 0.9912735223770142
Test Epoch2 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch2 layer1 Acc 0.9156578947368421, AUC 0.9808440208435059
Test Epoch2 layer2 Acc 0.9160526315789473, AUC 0.9807242155075073
Test Epoch2 layer3 Acc 0.9155263157894736, AUC 0.9807735681533813
Test Epoch2 layer4 Acc 0.9157894736842105, AUC 0.9808797836303711
Test Epoch2 layer5 Acc 0.9156578947368421, AUC 0.9810038805007935
Test Epoch2 layer6 Acc 0.9156578947368421, AUC 0.9803842306137085
Test Epoch2 layer7 Acc 0.9146052631578947, AUC 0.9807264804840088
Test Epoch2 layer8 Acc 0.9157894736842105, AUC 0.9797008037567139
Test Epoch2 layer9 Acc 0.9156578947368421, AUC 0.9798469543457031
Save ckpt to ./ckpt/mask10//ag_news/ag_news_transformeral_l10_m10.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9485083333333333 (113821/120000), AUC 0.9917779564857483
Test Epoch3 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch3 layer1 Acc 0.9156578947368421, AUC 0.9808440208435059
Test Epoch3 layer2 Acc 0.9160526315789473, AUC 0.9807242155075073
Test Epoch3 layer3 Acc 0.9155263157894736, AUC 0.9807735681533813
Test Epoch3 layer4 Acc 0.9157894736842105, AUC 0.9808797836303711
Test Epoch3 layer5 Acc 0.9156578947368421, AUC 0.9810038805007935
Test Epoch3 layer6 Acc 0.9156578947368421, AUC 0.9803842306137085
Test Epoch3 layer7 Acc 0.9146052631578947, AUC 0.9807264804840088
Test Epoch3 layer8 Acc 0.9157894736842105, AUC 0.9797008037567139
Test Epoch3 layer9 Acc 0.9157894736842105, AUC 0.9777317643165588
gc 0
Train Epoch4 Acc 0.9486833333333333 (113842/120000), AUC 0.9920722246170044
Test Epoch4 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch4 layer1 Acc 0.9156578947368421, AUC 0.9808440208435059
Test Epoch4 layer2 Acc 0.9160526315789473, AUC 0.9807242155075073
Test Epoch4 layer3 Acc 0.9155263157894736, AUC 0.9807735681533813
Test Epoch4 layer4 Acc 0.9157894736842105, AUC 0.9808797836303711
Test Epoch4 layer5 Acc 0.9156578947368421, AUC 0.9810038805007935
Test Epoch4 layer6 Acc 0.9156578947368421, AUC 0.9803842306137085
Test Epoch4 layer7 Acc 0.9146052631578947, AUC 0.9807264804840088
Test Epoch4 layer8 Acc 0.9157894736842105, AUC 0.9797008037567139
Test Epoch4 layer9 Acc 0.9167105263157894, AUC 0.9790199995040894
gc 0
Train Epoch5 Acc 0.9487583333333334 (113851/120000), AUC 0.9924164414405823
Test Epoch5 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch5 layer1 Acc 0.9156578947368421, AUC 0.9808440208435059
Test Epoch5 layer2 Acc 0.9160526315789473, AUC 0.9807242155075073
Test Epoch5 layer3 Acc 0.9155263157894736, AUC 0.9807735681533813
Test Epoch5 layer4 Acc 0.9157894736842105, AUC 0.9808797836303711
Test Epoch5 layer5 Acc 0.9156578947368421, AUC 0.9810038805007935
Test Epoch5 layer6 Acc 0.9156578947368421, AUC 0.9803842306137085
Test Epoch5 layer7 Acc 0.9146052631578947, AUC 0.9807264804840088
Test Epoch5 layer8 Acc 0.9157894736842105, AUC 0.9797008037567139
Test Epoch5 layer9 Acc 0.9155263157894736, AUC 0.9804094433784485
Save ckpt to ./ckpt/mask10//ag_news/ag_news_transformeral_l10_m10.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9488083333333334 (113857/120000), AUC 0.9924979209899902
Test Epoch6 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch6 layer1 Acc 0.9156578947368421, AUC 0.9808440208435059
Test Epoch6 layer2 Acc 0.9160526315789473, AUC 0.9807242155075073
Test Epoch6 layer3 Acc 0.9155263157894736, AUC 0.9807735681533813
Test Epoch6 layer4 Acc 0.9157894736842105, AUC 0.9808797836303711
Test Epoch6 layer5 Acc 0.9156578947368421, AUC 0.9810038805007935
Test Epoch6 layer6 Acc 0.9156578947368421, AUC 0.9803842306137085
Test Epoch6 layer7 Acc 0.9146052631578947, AUC 0.9807264804840088
Test Epoch6 layer8 Acc 0.9157894736842105, AUC 0.9797008037567139
Test Epoch6 layer9 Acc 0.9156578947368421, AUC 0.9800659418106079
gc 0
Train Epoch7 Acc 0.9488083333333334 (113857/120000), AUC 0.9926111102104187
Test Epoch7 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch7 layer1 Acc 0.9156578947368421, AUC 0.9808440208435059
Test Epoch7 layer2 Acc 0.9160526315789473, AUC 0.9807242155075073
Test Epoch7 layer3 Acc 0.9155263157894736, AUC 0.9807735681533813
Test Epoch7 layer4 Acc 0.9157894736842105, AUC 0.9808797836303711
Test Epoch7 layer5 Acc 0.9156578947368421, AUC 0.9810038805007935
Test Epoch7 layer6 Acc 0.9156578947368421, AUC 0.9803842306137085
Test Epoch7 layer7 Acc 0.9146052631578947, AUC 0.9807264804840088
Test Epoch7 layer8 Acc 0.9157894736842105, AUC 0.9797008037567139
Test Epoch7 layer9 Acc 0.9156578947368421, AUC 0.9792045950889587
gc 0
Train Epoch8 Acc 0.948675 (113841/120000), AUC 0.9927784204483032
Test Epoch8 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch8 layer1 Acc 0.9156578947368421, AUC 0.9808440208435059
Test Epoch8 layer2 Acc 0.9160526315789473, AUC 0.9807242155075073
Test Epoch8 layer3 Acc 0.9155263157894736, AUC 0.9807735681533813
Test Epoch8 layer4 Acc 0.9157894736842105, AUC 0.9808797836303711
Test Epoch8 layer5 Acc 0.9156578947368421, AUC 0.9810038805007935
Test Epoch8 layer6 Acc 0.9156578947368421, AUC 0.9803842306137085
Test Epoch8 layer7 Acc 0.9146052631578947, AUC 0.9807264804840088
Test Epoch8 layer8 Acc 0.9157894736842105, AUC 0.9797008037567139
Test Epoch8 layer9 Acc 0.9157894736842105, AUC 0.9799059629440308
gc 0
Train Epoch9 Acc 0.949 (113880/120000), AUC 0.9928624629974365
Test Epoch9 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch9 layer1 Acc 0.9156578947368421, AUC 0.9808440208435059
Test Epoch9 layer2 Acc 0.9160526315789473, AUC 0.9807242155075073
Test Epoch9 layer3 Acc 0.9155263157894736, AUC 0.9807735681533813
Test Epoch9 layer4 Acc 0.9157894736842105, AUC 0.9808797836303711
Test Epoch9 layer5 Acc 0.9156578947368421, AUC 0.9810038805007935
Test Epoch9 layer6 Acc 0.9156578947368421, AUC 0.9803842306137085
Test Epoch9 layer7 Acc 0.9146052631578947, AUC 0.9807264804840088
Test Epoch9 layer8 Acc 0.9157894736842105, AUC 0.9797008037567139
Test Epoch9 layer9 Acc 0.9152631578947369, AUC 0.9802317023277283
Best AUC 0.9804094433784485
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask10//ag_news/ag_news_transformeral_l10_m10.pt
[[1712   58   90   40]
 [  16 1862   13    9]
 [  47   10 1701  142]
 [  61   13  149 1677]]
Figure(640x480)
[[1695   63   84   58]
 [   9 1872    7   12]
 [  44   21 1660  175]
 [  40   16  112 1732]]
Figure(640x480)
[[1702   61   81   56]
 [  14 1861   12   13]
 [  45   18 1668  169]
 [  40   15  114 1731]]
Figure(640x480)
[[1711   56   79   54]
 [  18 1858   13   11]
 [  53   12 1688  147]
 [  42   13  144 1701]]
Figure(640x480)
[[1715   55   74   56]
 [  19 1852   13   16]
 [  53   12 1674  161]
 [  41   13  127 1719]]
Figure(640x480)
[[1718   54   73   55]
 [  19 1854   12   15]
 [  55   11 1679  155]
 [  43   13  136 1708]]
Figure(640x480)
[[1715   54   76   55]
 [  19 1853   14   14]
 [  52   11 1686  151]
 [  41   13  141 1705]]
Figure(640x480)
[[1717   54   78   51]
 [  20 1853   15   12]
 [  55   10 1692  143]
 [  45   13  153 1689]]
Figure(640x480)
[[1718   53   73   56]
 [  21 1851   13   15]
 [  56   10 1677  157]
 [  42   13  131 1714]]
Figure(640x480)
[[1717   53   76   54]
 [  20 1853   14   13]
 [  56   11 1688  145]
 [  41   13  146 1700]]
Figure(640x480)
