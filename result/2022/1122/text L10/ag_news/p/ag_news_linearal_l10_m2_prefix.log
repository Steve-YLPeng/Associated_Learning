total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask1//ag_news/ag_news_linearal_l10_m1.pt
Start Training
gc 9
Train Epoch0 Acc 0.136975 (16437/120000), AUC 0.3672071695327759
Test Epoch0 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch0 layer1 Acc 0.9142105263157895, AUC 0.9815261960029602
Save ckpt to ./ckpt/mask2//ag_news/ag_news_linearal_l10_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.28171052631578947, AUC 0.4860078990459442
Test Epoch0 layer3 Acc 0.25342105263157894, AUC 0.5821338295936584
Test Epoch0 layer4 Acc 0.2613157894736842, AUC 0.5247179865837097
Test Epoch0 layer5 Acc 0.2806578947368421, AUC 0.6084926128387451
Test Epoch0 layer6 Acc 0.25092105263157893, AUC 0.38301998376846313
Test Epoch0 layer7 Acc 0.3576315789473684, AUC 0.7090659737586975
Test Epoch0 layer8 Acc 0.24868421052631579, AUC 0.42794069647789
Test Epoch0 layer9 Acc 0.1394736842105263, AUC 0.38254213333129883
gc 0
Train Epoch1 Acc 0.140675 (16881/120000), AUC 0.37868696451187134
Test Epoch1 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch1 layer1 Acc 0.9140789473684211, AUC 0.9816176891326904
Save ckpt to ./ckpt/mask2//ag_news/ag_news_linearal_l10_m2.pt  ,ep 1
Test Epoch1 layer2 Acc 0.2847368421052632, AUC 0.48440971970558167
Test Epoch1 layer3 Acc 0.25552631578947366, AUC 0.5948531031608582
Test Epoch1 layer4 Acc 0.2693421052631579, AUC 0.5306553840637207
Test Epoch1 layer5 Acc 0.2756578947368421, AUC 0.6083095073699951
Test Epoch1 layer6 Acc 0.25, AUC 0.39201945066452026
Test Epoch1 layer7 Acc 0.3501315789473684, AUC 0.6986956000328064
Test Epoch1 layer8 Acc 0.24855263157894736, AUC 0.425150603055954
Test Epoch1 layer9 Acc 0.15144736842105264, AUC 0.3820174038410187
gc 0
Train Epoch2 Acc 0.14370833333333333 (17245/120000), AUC 0.3733862638473511
Test Epoch2 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch2 layer1 Acc 0.9143421052631578, AUC 0.9816210269927979
Save ckpt to ./ckpt/mask2//ag_news/ag_news_linearal_l10_m2.pt  ,ep 2
Test Epoch2 layer2 Acc 0.27960526315789475, AUC 0.48042190074920654
Test Epoch2 layer3 Acc 0.2598684210526316, AUC 0.6061949133872986
Test Epoch2 layer4 Acc 0.27710526315789474, AUC 0.5383011102676392
Test Epoch2 layer5 Acc 0.2631578947368421, AUC 0.6017810702323914
Test Epoch2 layer6 Acc 0.24986842105263157, AUC 0.40152496099472046
Test Epoch2 layer7 Acc 0.32723684210526316, AUC 0.6819866299629211
Test Epoch2 layer8 Acc 0.2468421052631579, AUC 0.42415693402290344
Test Epoch2 layer9 Acc 0.14842105263157895, AUC 0.374872624874115
gc 0
Train Epoch3 Acc 0.14248333333333332 (17098/120000), AUC 0.3682132661342621
Test Epoch3 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch3 layer1 Acc 0.9142105263157895, AUC 0.9815553426742554
Test Epoch3 layer2 Acc 0.2739473684210526, AUC 0.47875577211380005
Test Epoch3 layer3 Acc 0.26671052631578945, AUC 0.6166389584541321
Test Epoch3 layer4 Acc 0.28157894736842104, AUC 0.5444656610488892
Test Epoch3 layer5 Acc 0.24763157894736842, AUC 0.5926178693771362
Test Epoch3 layer6 Acc 0.2503947368421053, AUC 0.41219672560691833
Test Epoch3 layer7 Acc 0.3136842105263158, AUC 0.6623269319534302
Test Epoch3 layer8 Acc 0.24263157894736842, AUC 0.42474257946014404
Test Epoch3 layer9 Acc 0.14789473684210527, AUC 0.37011298537254333
gc 0
Train Epoch4 Acc 0.141075 (16929/120000), AUC 0.36375972628593445
Test Epoch4 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch4 layer1 Acc 0.9134210526315789, AUC 0.9816054105758667
Test Epoch4 layer2 Acc 0.27223684210526317, AUC 0.4771761894226074
Test Epoch4 layer3 Acc 0.2761842105263158, AUC 0.6250625848770142
Test Epoch4 layer4 Acc 0.28657894736842104, AUC 0.551665186882019
Test Epoch4 layer5 Acc 0.24473684210526317, AUC 0.5831762552261353
Test Epoch4 layer6 Acc 0.24973684210526315, AUC 0.4191547930240631
Test Epoch4 layer7 Acc 0.3042105263157895, AUC 0.6459687948226929
Test Epoch4 layer8 Acc 0.24026315789473685, AUC 0.42498090863227844
Test Epoch4 layer9 Acc 0.1481578947368421, AUC 0.3666115403175354
gc 0
Train Epoch5 Acc 0.14083333333333334 (16900/120000), AUC 0.3605327606201172
Test Epoch5 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch5 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Save ckpt to ./ckpt/mask2//ag_news/ag_news_linearal_l10_m2.pt  ,ep 5
Test Epoch5 layer2 Acc 0.2719736842105263, AUC 0.47698161005973816
Test Epoch5 layer3 Acc 0.2786842105263158, AUC 0.6302445530891418
Test Epoch5 layer4 Acc 0.28657894736842104, AUC 0.5542140603065491
Test Epoch5 layer5 Acc 0.24460526315789474, AUC 0.5797850489616394
Test Epoch5 layer6 Acc 0.24947368421052632, AUC 0.4222601652145386
Test Epoch5 layer7 Acc 0.29776315789473684, AUC 0.6365529298782349
Test Epoch5 layer8 Acc 0.23921052631578948, AUC 0.424690306186676
Test Epoch5 layer9 Acc 0.1481578947368421, AUC 0.36404067277908325
gc 0
Train Epoch6 Acc 0.14023333333333332 (16828/120000), AUC 0.35909080505371094
Test Epoch6 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch6 layer1 Acc 0.9142105263157895, AUC 0.9815765023231506
Test Epoch6 layer2 Acc 0.2718421052631579, AUC 0.4767646789550781
Test Epoch6 layer3 Acc 0.2805263157894737, AUC 0.634705662727356
Test Epoch6 layer4 Acc 0.28592105263157896, AUC 0.5569636225700378
Test Epoch6 layer5 Acc 0.24302631578947367, AUC 0.574383020401001
Test Epoch6 layer6 Acc 0.2493421052631579, AUC 0.4258120656013489
Test Epoch6 layer7 Acc 0.29368421052631577, AUC 0.6273894906044006
Test Epoch6 layer8 Acc 0.23868421052631578, AUC 0.4233556389808655
Test Epoch6 layer9 Acc 0.1475, AUC 0.36234134435653687
gc 0
Train Epoch7 Acc 0.14074166666666665 (16889/120000), AUC 0.35766738653182983
Test Epoch7 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch7 layer1 Acc 0.9135526315789474, AUC 0.9815763235092163
Test Epoch7 layer2 Acc 0.2693421052631579, AUC 0.4767240285873413
Test Epoch7 layer3 Acc 0.2843421052631579, AUC 0.6389478445053101
Test Epoch7 layer4 Acc 0.2856578947368421, AUC 0.5593553185462952
Test Epoch7 layer5 Acc 0.24302631578947367, AUC 0.5697801113128662
Test Epoch7 layer6 Acc 0.24828947368421053, AUC 0.42899081110954285
Test Epoch7 layer7 Acc 0.29092105263157897, AUC 0.6194870471954346
Test Epoch7 layer8 Acc 0.23776315789473684, AUC 0.4237639904022217
Test Epoch7 layer9 Acc 0.14736842105263157, AUC 0.3608705401420593
gc 0
Train Epoch8 Acc 0.14178333333333334 (17014/120000), AUC 0.3558770418167114
Test Epoch8 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch8 layer1 Acc 0.9131578947368421, AUC 0.9815396666526794
Test Epoch8 layer2 Acc 0.27, AUC 0.47635889053344727
Test Epoch8 layer3 Acc 0.2876315789473684, AUC 0.6432238221168518
Test Epoch8 layer4 Acc 0.28460526315789475, AUC 0.5619636178016663
Test Epoch8 layer5 Acc 0.24184210526315789, AUC 0.5642707347869873
Test Epoch8 layer6 Acc 0.24868421052631579, AUC 0.43175259232521057
Test Epoch8 layer7 Acc 0.28657894736842104, AUC 0.6126823425292969
Test Epoch8 layer8 Acc 0.23710526315789474, AUC 0.4229144752025604
Test Epoch8 layer9 Acc 0.14894736842105263, AUC 0.35975268483161926
gc 0
Train Epoch9 Acc 0.141825 (17019/120000), AUC 0.3548431396484375
Test Epoch9 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch9 layer1 Acc 0.9130263157894737, AUC 0.981604814529419
Test Epoch9 layer2 Acc 0.26973684210526316, AUC 0.47634702920913696
Test Epoch9 layer3 Acc 0.2914473684210526, AUC 0.6474852561950684
Test Epoch9 layer4 Acc 0.2848684210526316, AUC 0.5645865797996521
Test Epoch9 layer5 Acc 0.24184210526315789, AUC 0.5592586994171143
Test Epoch9 layer6 Acc 0.24802631578947368, AUC 0.4345376789569855
Test Epoch9 layer7 Acc 0.2836842105263158, AUC 0.6050503253936768
Test Epoch9 layer8 Acc 0.23671052631578948, AUC 0.4228955805301666
Test Epoch9 layer9 Acc 0.14947368421052631, AUC 0.3587248623371124
Best AUC 0.9816479682922363
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//ag_news/ag_news_linearal_l10_m2.pt
[[1706   59   91   44]
 [  16 1860   16    8]
 [  48   15 1701  136]
 [  58   13  153 1676]]
Figure(640x480)
[[1700   59   94   47]
 [  13 1865   12   10]
 [  45   17 1684  154]
 [  53   15  135 1697]]
Figure(640x480)
[[  70   41 1128  661]
 [ 191    0   22 1687]
 [  28    0  546 1326]
 [ 214    0  235 1451]]
Figure(640x480)
[[   0 1877   18    5]
 [   0 1900    0    0]
 [   0 1681  217    2]
 [   2 1725  172    1]]
Figure(640x480)
[[1581  261    3   55]
 [1318  578    0    4]
 [1598  279    0   23]
 [ 703 1170    8   19]]
Figure(640x480)
[[  58    0 1804   38]
 [ 103    0 1781   16]
 [  18    0 1695  187]
 [ 152    0 1642  106]]
Figure(640x480)
[[  92   12 1540  256]
 [ 767    1  853  279]
 [ 101    0 1799    0]
 [ 150    0 1746    4]]
Figure(640x480)
[[   9   96  132 1663]
 [   0    5 1255  640]
 [   1  676  574  649]
 [   0   17  208 1675]]
Figure(640x480)
[[   0  110    0 1790]
 [  21   11    0 1868]
 [   0   32    0 1868]
 [   1   92    0 1807]]
Figure(640x480)
[[1023    0   21  856]
 [1280    0    0  620]
 [1717    0    0  183]
 [1797    0    0  103]]
Figure(640x480)
