total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l10_m3_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.07142857142857142 (40000/560000), AUC 0.4928714334964752
Test Epoch0 layer0 Acc 0.9736857142857143, AUC 0.9982806444168091
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l10_m4_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9854857142857143, AUC 0.9986684918403625
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l10_m4_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9854142857142857, AUC 0.9986036419868469
Test Epoch0 layer3 Acc 0.9853571428571428, AUC 0.9973421096801758
Test Epoch0 layer4 Acc 0.06267142857142857, AUC 0.5054787397384644
Test Epoch0 layer5 Acc 0.0714, AUC 0.48658642172813416
Test Epoch0 layer6 Acc 0.0016857142857142856, AUC 0.4466169774532318
Test Epoch0 layer7 Acc 0.032042857142857144, AUC 0.5157690644264221
Test Epoch0 layer8 Acc 0.07164285714285715, AUC 0.5257574915885925
Test Epoch0 layer9 Acc 0.07142857142857142, AUC 0.48976650834083557
gc 0
Train Epoch1 Acc 0.07142857142857142 (40000/560000), AUC 0.4809567630290985
Test Epoch1 layer0 Acc 0.9739142857142857, AUC 0.9982547163963318
Test Epoch1 layer1 Acc 0.9858428571428571, AUC 0.9985460638999939
Test Epoch1 layer2 Acc 0.9859, AUC 0.9983557462692261
Test Epoch1 layer3 Acc 0.9857, AUC 0.9973229169845581
Test Epoch1 layer4 Acc 0.0708, AUC 0.505677342414856
Test Epoch1 layer5 Acc 0.1011, AUC 0.4950093626976013
Test Epoch1 layer6 Acc 0.0019285714285714286, AUC 0.4524720013141632
Test Epoch1 layer7 Acc 0.071, AUC 0.5247350335121155
Test Epoch1 layer8 Acc 0.07164285714285715, AUC 0.520610511302948
Test Epoch1 layer9 Acc 0.07142857142857142, AUC 0.47160956263542175
gc 0
Train Epoch2 Acc 0.07142857142857142 (40000/560000), AUC 0.46598175168037415
Test Epoch2 layer0 Acc 0.9736714285714285, AUC 0.9982908964157104
Test Epoch2 layer1 Acc 0.9858285714285714, AUC 0.9985435605049133
Test Epoch2 layer2 Acc 0.9859857142857142, AUC 0.998481273651123
Test Epoch2 layer3 Acc 0.9859571428571429, AUC 0.9975362420082092
Test Epoch2 layer4 Acc 0.07127142857142857, AUC 0.5014576315879822
Test Epoch2 layer5 Acc 0.13785714285714284, AUC 0.506097674369812
Test Epoch2 layer6 Acc 0.0019, AUC 0.4509868621826172
Test Epoch2 layer7 Acc 0.07117142857142857, AUC 0.5277333855628967
Test Epoch2 layer8 Acc 0.07155714285714286, AUC 0.5255380868911743
Test Epoch2 layer9 Acc 0.07142857142857142, AUC 0.4679935872554779
gc 0
Train Epoch3 Acc 0.07142857142857142 (40000/560000), AUC 0.46704787015914917
Test Epoch3 layer0 Acc 0.9738714285714286, AUC 0.9982734322547913
Test Epoch3 layer1 Acc 0.9857, AUC 0.9984331130981445
Test Epoch3 layer2 Acc 0.9855142857142857, AUC 0.9983752369880676
Test Epoch3 layer3 Acc 0.9856285714285714, AUC 0.9972001314163208
Test Epoch3 layer4 Acc 0.07115714285714286, AUC 0.5039113759994507
Test Epoch3 layer5 Acc 0.13914285714285715, AUC 0.4957621395587921
Test Epoch3 layer6 Acc 0.0029714285714285715, AUC 0.44500109553337097
Test Epoch3 layer7 Acc 0.07132857142857142, AUC 0.5244936943054199
Test Epoch3 layer8 Acc 0.07152857142857143, AUC 0.5243061184883118
Test Epoch3 layer9 Acc 0.07142857142857142, AUC 0.46644994616508484
gc 0
Train Epoch4 Acc 0.07142857142857142 (40000/560000), AUC 0.46644142270088196
Test Epoch4 layer0 Acc 0.9735, AUC 0.9982813596725464
Test Epoch4 layer1 Acc 0.9858142857142858, AUC 0.9982777833938599
Test Epoch4 layer2 Acc 0.9859142857142857, AUC 0.998174250125885
Test Epoch4 layer3 Acc 0.9858857142857143, AUC 0.9972192049026489
Test Epoch4 layer4 Acc 0.07205714285714286, AUC 0.4988139569759369
Test Epoch4 layer5 Acc 0.13987142857142856, AUC 0.4872376620769501
Test Epoch4 layer6 Acc 0.004557142857142857, AUC 0.44959285855293274
Test Epoch4 layer7 Acc 0.07141428571428571, AUC 0.5311749577522278
Test Epoch4 layer8 Acc 0.07168571428571428, AUC 0.5180209279060364
Test Epoch4 layer9 Acc 0.07142857142857142, AUC 0.4708010256290436
gc 0
Train Epoch5 Acc 0.07142857142857142 (40000/560000), AUC 0.4696638882160187
Test Epoch5 layer0 Acc 0.9738857142857142, AUC 0.9982813000679016
Test Epoch5 layer1 Acc 0.9856428571428572, AUC 0.998242199420929
Test Epoch5 layer2 Acc 0.9856142857142857, AUC 0.9980610609054565
Test Epoch5 layer3 Acc 0.9857, AUC 0.9970336556434631
Test Epoch5 layer4 Acc 0.07274285714285714, AUC 0.5028374791145325
Test Epoch5 layer5 Acc 0.14104285714285714, AUC 0.4826224744319916
Test Epoch5 layer6 Acc 0.004285714285714286, AUC 0.45938119292259216
Test Epoch5 layer7 Acc 0.0714, AUC 0.5331364274024963
Test Epoch5 layer8 Acc 0.07161428571428571, AUC 0.5129398107528687
Test Epoch5 layer9 Acc 0.07142857142857142, AUC 0.4715648293495178
gc 0
Train Epoch6 Acc 0.07142857142857142 (40000/560000), AUC 0.47012513875961304
Test Epoch6 layer0 Acc 0.9738285714285714, AUC 0.9982919692993164
Test Epoch6 layer1 Acc 0.9857, AUC 0.9982175827026367
Test Epoch6 layer2 Acc 0.9857428571428571, AUC 0.9979543089866638
Test Epoch6 layer3 Acc 0.9857, AUC 0.9970182776451111
Test Epoch6 layer4 Acc 0.07251428571428571, AUC 0.5131574869155884
Test Epoch6 layer5 Acc 0.14125714285714286, AUC 0.47584494948387146
Test Epoch6 layer6 Acc 0.005842857142857143, AUC 0.4634624123573303
Test Epoch6 layer7 Acc 0.0714, AUC 0.5392947196960449
Test Epoch6 layer8 Acc 0.0716, AUC 0.5072051882743835
Test Epoch6 layer9 Acc 0.07142857142857142, AUC 0.4709136188030243
gc 0
Train Epoch7 Acc 0.07142857142857142 (40000/560000), AUC 0.4701801836490631
Test Epoch7 layer0 Acc 0.9737285714285714, AUC 0.9982616305351257
Test Epoch7 layer1 Acc 0.9857857142857143, AUC 0.9980434775352478
Test Epoch7 layer2 Acc 0.9859285714285714, AUC 0.997805655002594
Test Epoch7 layer3 Acc 0.9859142857142857, AUC 0.9967061281204224
Test Epoch7 layer4 Acc 0.07267142857142857, AUC 0.5154157876968384
Test Epoch7 layer5 Acc 0.14138571428571428, AUC 0.48023074865341187
Test Epoch7 layer6 Acc 0.0049, AUC 0.46266576647758484
Test Epoch7 layer7 Acc 0.0714, AUC 0.5386638641357422
Test Epoch7 layer8 Acc 0.07154285714285714, AUC 0.5055192112922668
Test Epoch7 layer9 Acc 0.07142857142857142, AUC 0.47113820910453796
gc 0
Train Epoch8 Acc 0.07142857142857142 (40000/560000), AUC 0.47361770272254944
Test Epoch8 layer0 Acc 0.9734428571428572, AUC 0.9982882738113403
Test Epoch8 layer1 Acc 0.9851714285714286, AUC 0.9979179501533508
Test Epoch8 layer2 Acc 0.9852285714285715, AUC 0.9976170659065247
Test Epoch8 layer3 Acc 0.9852285714285715, AUC 0.9968026876449585
Test Epoch8 layer4 Acc 0.07228571428571429, AUC 0.5187329053878784
Test Epoch8 layer5 Acc 0.14137142857142856, AUC 0.4819056987762451
Test Epoch8 layer6 Acc 0.005242857142857143, AUC 0.4641203284263611
Test Epoch8 layer7 Acc 0.07137142857142857, AUC 0.5391043424606323
Test Epoch8 layer8 Acc 0.07161428571428571, AUC 0.5066014528274536
Test Epoch8 layer9 Acc 0.07142857142857142, AUC 0.47381505370140076
gc 0
Train Epoch9 Acc 0.07142857142857142 (40000/560000), AUC 0.47368475794792175
Test Epoch9 layer0 Acc 0.9738142857142857, AUC 0.9982742667198181
Test Epoch9 layer1 Acc 0.9854285714285714, AUC 0.9979395270347595
Test Epoch9 layer2 Acc 0.9855428571428572, AUC 0.9977484345436096
Test Epoch9 layer3 Acc 0.9854714285714286, AUC 0.996590793132782
Test Epoch9 layer4 Acc 0.0723, AUC 0.5192546844482422
Test Epoch9 layer5 Acc 0.14142857142857143, AUC 0.4826606214046478
Test Epoch9 layer6 Acc 0.03718571428571429, AUC 0.4630749225616455
Test Epoch9 layer7 Acc 0.07135714285714286, AUC 0.5417764782905579
Test Epoch9 layer8 Acc 0.07158571428571428, AUC 0.5051137804985046
Test Epoch9 layer9 Acc 0.07142857142857142, AUC 0.4766784608364105
Best AUC 0.9986684918403625
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l10_m4_prefix.pt
[[4690   43   23   14   11   71   41    7    3    6    6   19   19   47]
 [  34 4909    1    1    7    0   23    6    3    2    1    0    5    8]
 [  39   14 4608   19   50    1   10    2    6    0    1   82   23  145]
 [   3    2   29 4950   12    0    1    0    0    0    0    0    0    3]
 [  12   20   86   11 4836    9    6    1    2    1    0    1    3   12]
 [  33    2    3    4    1 4943    5    2    1    3    0    0    1    2]
 [  64   56    6    3   10   15 4783   40   10    5    1    1    3    3]
 [   0    1    0    0    2    0   12 4963   17    3    1    0    0    1]
 [   1    4    2    0    3    0   12   12 4966    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4952   36    0    0    1]
 [  13    1    0    0    0    0    2    3    0   29 4952    0    0    0]
 [   6    0   40    2    0    0    0    0    0    1    0 4923   15   13]
 [   7    2   24    5    1    3    1    3    0    2    0   20 4884   48]
 [  27    6   73    7   12    3    3    9    1    6    3    5   46 4799]]
Figure(640x480)
[[4813   43   17    3   11   25   39    2    1    2    0    8    7   29]
 [  30 4935    0    0    5    0   20    3    1    1    0    0    1    4]
 [  14    6 4837   11   83    1    2    0    0    3    0   12    8   23]
 [   3    1    8 4969   15    0    0    0    0    1    0    1    1    1]
 [   5    5   45    9 4919    4    4    1    0    2    0    0    3    3]
 [  33    0    0    0    1 4953    4    2    1    3    0    1    1    1]
 [  54   42    1    0    1   12 4855   22    6    2    0    0    2    3]
 [   1    0    0    0    0    1   16 4971    6    3    1    0    0    1]
 [   3    0    1    0    1    0    5   11 4977    1    0    0    0    1]
 [   1    0    0    0    0    0    0    2    0 4981   16    0    0    0]
 [  14    1    0    0    0    1    1    1    0   30 4952    0    0    0]
 [   3    0    9    1    0    0    0    0    0    0    0 4973    9    5]
 [   5    0    4    0    0    1    0    0    0    0    0   20 4940   30]
 [  25    2   20    1    4    3    4    0    0    1    1    8   22 4909]]
Figure(640x480)
[[4815   40   17    3   11   24   41    2    1    2    0    8    7   29]
 [  32 4934    0    0    6    0   20    2    1    1    0    0    0    4]
 [  14    6 4836   12   84    1    1    0    0    3    0   12    7   24]
 [   3    1   11 4971   13    0    0    0    0    0    0    0    1    0]
 [   5    5   47    9 4917    4    4    1    0    1    0    0    3    4]
 [  35    0    0    0    1 4950    5    2    1    3    0    1    1    1]
 [  54   42    1    0    1   12 4856   23    4    2    0    0    2    3]
 [   1    0    0    0    0    0   16 4972    6    3    1    0    0    1]
 [   3    0    1    0    1    0    6   11 4976    1    0    0    0    1]
 [   1    0    1    0    0    0    1    2    0 4979   16    0    0    0]
 [  14    1    0    0    0    0    1    1    0   30 4953    0    0    0]
 [   3    0    9    1    0    0    0    0    0    0    0 4973    9    5]
 [   6    0    4    0    0    1    0    0    0    0    0   22 4938   29]
 [  25    3   19    1    4    3    3    0    0    1    1    9   22 4909]]
Figure(640x480)
[[4813   41   18    4   10   25   40    2    1    2    0    8    6   30]
 [  33 4934    0    0    6    0   19    2    1    1    0    0    0    4]
 [  14    6 4841   12   79    1    1    0    0    3    0   13    7   23]
 [   2    1   12 4971   12    0    0    0    0    1    0    0    1    0]
 [   4    5   49    9 4917    4    3    1    0    1    0    0    3    4]
 [  36    0    0    0    1 4947    6    2    1    3    0    1    2    1]
 [  54   42    3    0    2   12 4854   22    4    2    0    0    2    3]
 [   1    0    0    0    0    0   17 4970    7    3    1    0    0    1]
 [   3    0    1    0    1    0    6   10 4977    1    0    0    0    1]
 [   1    0    1    0    0    0    0    2    0 4980   16    0    0    0]
 [  14    1    0    0    0    2    1    1    0   32 4949    0    0    0]
 [   3    0    9    1    0    0    0    0    0    0    0 4973    9    5]
 [   5    0    5    0    0    1    0    0    0    0    0   21 4939   29]
 [  25    3   19    1    4    3    3    0    0    1    1    9   21 4910]]
Figure(640x480)
[[   0 4841    0    0    0    0    0   23    0    0    0    0    0  136]
 [   0   36    0    0    0    0    0    1    0    6   14    0    0 4943]
 [   0  116    0    0    0    0    0 4185    0    1    0    0    0  698]
 [   0   12    0    0    0    0    0    1    0    0    0    0    0 4987]
 [   0 4917    0    0    0    0    0   13    0    0    0    0    0   70]
 [   0  116    0    0    0    0    0 4854    4    0    0    0    0   26]
 [   0   53    0    0    0    0    0   13    0    0    0    0    0 4934]
 [   0    1    0    0    0    0    0 4039    0    0    0    0    0  960]
 [   0    3    0    0    0    0    0 4952    0    0    0    0    0   45]
 [   0    1    0 3982    0    0    0    0    0    0    0    2    0 1015]
 [   0   15    0 4895    0    0    0    0   59    0    0    0    0   31]
 [   0 4412    0    0    0    0    0  573    0    0    0    0    0   15]
 [   0 4988    0    0    0    0    0    1    0    0    0    0    0   11]
 [   0 4681    0    3    0    0    0    4    0    0    0    0    0  312]]
Figure(640x480)
[[   0    0    0  111 4881    6    0    1    0    0    0    0    0    1]
 [   0    0    0   15 4972    0    0    0    0    0    0    0    0   13]
 [   0    0    0    4 4995    1    0    0    0    0    0    0    0    0]
 [   0    0    0    0 4999    1    0    0    0    0    0    0    0    0]
 [   0    0    0    8 4992    0    0    0    0    0    0    0    0    0]
 [   0    0    0 4972   25    0    0    0    0    0    0    0    0    3]
 [   0    0    0 4635  216   16    0    1    0    0    0  129    0    3]
 [   0    0    0   30 4955    2    0    1    0    0    1    1    0   10]
 [   0    0    0  144    8   14    7    0    0    0    2    1    0 4824]
 [   0    0    0    7   46   43    0 3288    0    0    0    0    0 1616]
 [   0    0    0   75   43 4817    0   51    8    0    0    0    0    6]
 [   0    0    0    0 5000    0    0    0    0    0    0    0    0    0]
 [   0    0    0    1 4998    0    0    0    0    0    1    0    0    0]
 [   0    0    0    6 4985    0    0    4    0    0    0    0    0    5]]
Figure(640x480)
[[   0    0    0    0    1    0    0    8   46    0    0  228    0 4717]
 [   0    0    0    0    0    0    0   16   15    0    0 4935    0   34]
 [   0    0    0    0    0    0    0   39    9    0    0   52    0 4900]
 [   0    0    0    0    0    0    0   10   50    0    0 4918    0   22]
 [   0    0    0    0    0    0    0    3    4    0    0   30    0 4963]
 [   0    0    0    0    0    0    0   10    6    0    0 4947    0   37]
 [   0    0    0    0    0    0    0   23 4727    0    0  184    0   66]
 [   0    0    0    0  905    0    0   46   24    0    0   60    0 3965]
 [   0    0    0    0    0    0    0 4963   12    0    0    8    0   17]
 [   0    0    0    0   20    0    0 4526    0    0    0   28    0  426]
 [   0    0    0    0    6    0    0   22    0    0    0 4935    0   37]
 [   0    0    0    0    0    0    0   12   10    0    0    6    0 4972]
 [   0    0    0    0    0    0    0   20 4733    0    0   35    0  212]
 [   0    0    0    0    1    0    0   24    7    0    0 4914    0   54]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    6    0    0 4994    0    0]
 [   0    0    0    0    0    0    0    0    1    0    0 4999    0    0]
 [   0    0    0    0    0    0    0    0    6    0    0 4994    0    0]
 [   0    0    0    0    0    0    0    0   44    0    0 4956    0    0]
 [   0    0    0    0    0    0    0    0    2    0    0 4998    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    4    0    0 4996    0    0]
 [   0    0    0    0    0    0    0    0    1    0    0 4999    0    0]
 [   0    0    0    0    0    0    0    0    1    0    0 4999    0    0]
 [   0    0    0    0    0    0    0    0 4642    0    0  358    0    0]
 [   0    0    0    0    0    0    0    0   10    0    0 4990    0    0]
 [   0    0    0    0    0    0    0    0 2758    0    0 2242    0    0]
 [   0    0    0    0    0    0    0    0 4651    0    0  349    0    0]
 [   0    0    0    0    0    0    0    0   41    0    0 4959    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0   26    0    0    0 4958    0   16]
 [   0    0    0    0    0    0    0   19    0    0    0  909    0 4072]
 [   0    0    0    0    0    0    0    3    0    0    0 4993    0    4]
 [   0    0    0    0    0    0    0 1206    0    0    0  347    0 3447]
 [   0    0    0    0    0    0    0    4    0    0    0 4996    0    0]
 [   0    0    0    0    0    0    0    2    0    0    0 4998    0    0]
 [   0    0    0    0    0    0    0 4686    0    0    0  297    0   17]
 [   0    0    0    0    0    0    0   16    0    0    0 4984    0    0]
 [   0    0    0    0    0    0    0    4    0    0    0 4996    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    1    0    0    0 4999    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    1    0    0    0 4999    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]]
Figure(640x480)
