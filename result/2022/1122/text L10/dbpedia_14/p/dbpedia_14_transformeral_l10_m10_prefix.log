total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask9//dbpedia_14/dbpedia_14_transformeral_l10_m9_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.9599732142857142 (537585/560000), AUC 0.9949455857276917
Test Epoch0 layer0 Acc 0.9738571428571429, AUC 0.998234212398529
Save ckpt to ./ckpt/mask10//dbpedia_14/dbpedia_14_transformeral_l10_m10_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9790142857142857, AUC 0.9970410466194153
Test Epoch0 layer2 Acc 0.9788285714285714, AUC 0.9956143498420715
Test Epoch0 layer3 Acc 0.9787714285714286, AUC 0.9946540594100952
Test Epoch0 layer4 Acc 0.9786571428571429, AUC 0.9937466382980347
Test Epoch0 layer5 Acc 0.9786428571428571, AUC 0.9931236505508423
Test Epoch0 layer6 Acc 0.9787428571428571, AUC 0.992489755153656
Test Epoch0 layer7 Acc 0.9787142857142858, AUC 0.9918383359909058
Test Epoch0 layer8 Acc 0.9787285714285714, AUC 0.9920818209648132
Test Epoch0 layer9 Acc 0.9786428571428571, AUC 0.9917777180671692
gc 0
Train Epoch1 Acc 0.9932839285714286 (556239/560000), AUC 0.9982851147651672
Test Epoch1 layer0 Acc 0.9731714285714286, AUC 0.998289942741394
Save ckpt to ./ckpt/mask10//dbpedia_14/dbpedia_14_transformeral_l10_m10_prefix.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9789428571428571, AUC 0.9972870945930481
Test Epoch1 layer2 Acc 0.9783, AUC 0.9958018064498901
Test Epoch1 layer3 Acc 0.9781571428571428, AUC 0.9946364760398865
Test Epoch1 layer4 Acc 0.9781714285714286, AUC 0.993890106678009
Test Epoch1 layer5 Acc 0.9781285714285715, AUC 0.9936434030532837
Test Epoch1 layer6 Acc 0.9780571428571428, AUC 0.9927178025245667
Test Epoch1 layer7 Acc 0.9781142857142857, AUC 0.9922247529029846
Test Epoch1 layer8 Acc 0.9780285714285715, AUC 0.9918235540390015
Test Epoch1 layer9 Acc 0.978, AUC 0.9919875264167786
gc 0
Train Epoch2 Acc 0.993575 (556402/560000), AUC 0.9983547329902649
Test Epoch2 layer0 Acc 0.9736285714285714, AUC 0.9982833862304688
Test Epoch2 layer1 Acc 0.9785285714285714, AUC 0.9971243739128113
Test Epoch2 layer2 Acc 0.9783285714285714, AUC 0.9956240057945251
Test Epoch2 layer3 Acc 0.9782571428571428, AUC 0.9943757057189941
Test Epoch2 layer4 Acc 0.9782714285714286, AUC 0.9938519597053528
Test Epoch2 layer5 Acc 0.9782428571428572, AUC 0.9928678870201111
Test Epoch2 layer6 Acc 0.9782857142857143, AUC 0.9923109412193298
Test Epoch2 layer7 Acc 0.9781428571428571, AUC 0.9918517470359802
Test Epoch2 layer8 Acc 0.9782285714285714, AUC 0.9917234778404236
Test Epoch2 layer9 Acc 0.9782428571428572, AUC 0.9920881390571594
gc 0
Train Epoch3 Acc 0.9936589285714286 (556449/560000), AUC 0.9983639717102051
Test Epoch3 layer0 Acc 0.9734, AUC 0.9982715845108032
Test Epoch3 layer1 Acc 0.9783857142857143, AUC 0.9970433115959167
Test Epoch3 layer2 Acc 0.9775285714285714, AUC 0.9951826930046082
Test Epoch3 layer3 Acc 0.9773, AUC 0.9942048192024231
Test Epoch3 layer4 Acc 0.9771857142857143, AUC 0.9934559464454651
Test Epoch3 layer5 Acc 0.9771714285714286, AUC 0.9926906228065491
Test Epoch3 layer6 Acc 0.9771857142857143, AUC 0.9921197295188904
Test Epoch3 layer7 Acc 0.9771285714285715, AUC 0.9917370676994324
Test Epoch3 layer8 Acc 0.9771428571428571, AUC 0.991263747215271
Test Epoch3 layer9 Acc 0.9771285714285715, AUC 0.9908468127250671
gc 0
Train Epoch4 Acc 0.993975 (556626/560000), AUC 0.998480498790741
Test Epoch4 layer0 Acc 0.9733428571428572, AUC 0.9982806444168091
Test Epoch4 layer1 Acc 0.9794142857142857, AUC 0.9970144629478455
Test Epoch4 layer2 Acc 0.9789857142857142, AUC 0.9953868985176086
Test Epoch4 layer3 Acc 0.9789, AUC 0.9942010641098022
Test Epoch4 layer4 Acc 0.9788857142857142, AUC 0.9933685064315796
Test Epoch4 layer5 Acc 0.9788428571428571, AUC 0.9930992722511292
Test Epoch4 layer6 Acc 0.9788, AUC 0.9925932288169861
Test Epoch4 layer7 Acc 0.9787571428571429, AUC 0.9920645356178284
Test Epoch4 layer8 Acc 0.9787285714285714, AUC 0.9915305972099304
Test Epoch4 layer9 Acc 0.9787571428571429, AUC 0.9919974207878113
gc 0
Train Epoch5 Acc 0.9944857142857143 (556912/560000), AUC 0.9985666871070862
Test Epoch5 layer0 Acc 0.9737857142857143, AUC 0.9982886910438538
Test Epoch5 layer1 Acc 0.9786571428571429, AUC 0.9970220327377319
Test Epoch5 layer2 Acc 0.9782428571428572, AUC 0.9950618743896484
Test Epoch5 layer3 Acc 0.9782571428571428, AUC 0.993687093257904
Test Epoch5 layer4 Acc 0.9781714285714286, AUC 0.9934243559837341
Test Epoch5 layer5 Acc 0.9782, AUC 0.9929018020629883
Test Epoch5 layer6 Acc 0.9781, AUC 0.9921712875366211
Test Epoch5 layer7 Acc 0.9781428571428571, AUC 0.991858184337616
Test Epoch5 layer8 Acc 0.9781142857142857, AUC 0.9912470579147339
Test Epoch5 layer9 Acc 0.9781142857142857, AUC 0.9918140172958374
gc 0
Train Epoch6 Acc 0.9950803571428571 (557245/560000), AUC 0.9987089037895203
Test Epoch6 layer0 Acc 0.9736, AUC 0.998290479183197
Save ckpt to ./ckpt/mask10//dbpedia_14/dbpedia_14_transformeral_l10_m10_prefix.pt  ,ep 6
Test Epoch6 layer1 Acc 0.9790428571428571, AUC 0.9969354271888733
Test Epoch6 layer2 Acc 0.9780428571428571, AUC 0.9948339462280273
Test Epoch6 layer3 Acc 0.978, AUC 0.993693470954895
Test Epoch6 layer4 Acc 0.9779142857142857, AUC 0.9929910898208618
Test Epoch6 layer5 Acc 0.9779142857142857, AUC 0.9924216866493225
Test Epoch6 layer6 Acc 0.9779571428571429, AUC 0.9918864965438843
Test Epoch6 layer7 Acc 0.9779285714285715, AUC 0.9914267659187317
Test Epoch6 layer8 Acc 0.9779285714285715, AUC 0.9908405542373657
Test Epoch6 layer9 Acc 0.9779285714285715, AUC 0.9908729195594788
gc 0
Train Epoch7 Acc 0.9953785714285714 (557412/560000), AUC 0.9987565279006958
Test Epoch7 layer0 Acc 0.9736142857142858, AUC 0.9982689619064331
Test Epoch7 layer1 Acc 0.9792142857142857, AUC 0.9970225691795349
Test Epoch7 layer2 Acc 0.9786857142857143, AUC 0.9947783350944519
Test Epoch7 layer3 Acc 0.9785428571428572, AUC 0.9935054183006287
Test Epoch7 layer4 Acc 0.9784571428571428, AUC 0.9928828477859497
Test Epoch7 layer5 Acc 0.9784857142857143, AUC 0.9924810528755188
Test Epoch7 layer6 Acc 0.9784714285714285, AUC 0.9922961592674255
Test Epoch7 layer7 Acc 0.9784857142857143, AUC 0.9916738867759705
Test Epoch7 layer8 Acc 0.9784428571428572, AUC 0.9910469055175781
Test Epoch7 layer9 Acc 0.9784571428571428, AUC 0.9913607835769653
gc 0
Train Epoch8 Acc 0.9954892857142857 (557474/560000), AUC 0.9987725019454956
Test Epoch8 layer0 Acc 0.9735142857142857, AUC 0.9982703328132629
Test Epoch8 layer1 Acc 0.9790285714285715, AUC 0.9969304800033569
Test Epoch8 layer2 Acc 0.9781428571428571, AUC 0.9947227835655212
Test Epoch8 layer3 Acc 0.9779142857142857, AUC 0.9934013485908508
Test Epoch8 layer4 Acc 0.9777714285714286, AUC 0.9927211403846741
Test Epoch8 layer5 Acc 0.9778142857142857, AUC 0.9921330809593201
Test Epoch8 layer6 Acc 0.9778, AUC 0.9916208386421204
Test Epoch8 layer7 Acc 0.9778571428571429, AUC 0.9912582039833069
Test Epoch8 layer8 Acc 0.9778142857142857, AUC 0.9907828569412231
Test Epoch8 layer9 Acc 0.9778, AUC 0.991544246673584
gc 0
Train Epoch9 Acc 0.9958107142857143 (557654/560000), AUC 0.9988180994987488
Test Epoch9 layer0 Acc 0.9736857142857143, AUC 0.9982919096946716
Save ckpt to ./ckpt/mask10//dbpedia_14/dbpedia_14_transformeral_l10_m10_prefix.pt  ,ep 9
Test Epoch9 layer1 Acc 0.9789571428571429, AUC 0.9969573020935059
Test Epoch9 layer2 Acc 0.9778714285714286, AUC 0.9945525527000427
Test Epoch9 layer3 Acc 0.9777571428571429, AUC 0.9935546517372131
Test Epoch9 layer4 Acc 0.9777142857142858, AUC 0.9927657246589661
Test Epoch9 layer5 Acc 0.9777142857142858, AUC 0.9921792149543762
Test Epoch9 layer6 Acc 0.9777142857142858, AUC 0.9914585947990417
Test Epoch9 layer7 Acc 0.9777142857142858, AUC 0.991078794002533
Test Epoch9 layer8 Acc 0.9777, AUC 0.990667998790741
Test Epoch9 layer9 Acc 0.9777, AUC 0.9911544919013977
Best AUC 0.9982919096946716
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask10//dbpedia_14/dbpedia_14_transformeral_l10_m10_prefix.pt
[[4701   40   21   14   11   67   41    8    4    6    4   21   19   43]
 [  37 4896    2    1    7    0   30    8    5    2    1    0    4    7]
 [  40   13 4603   18   52    1   11    4    5    0    1   85   20  147]
 [   4    1   30 4948   12    1    1    0    0    0    0    1    0    2]
 [  10   15   76   11 4853    9    6    2    2    1    0    2    3   10]
 [  36    2    3    4    1 4941    5    3    1    1    0    0    1    2]
 [  63   51    4    3   11   16 4792   38    9    5    1    1    4    2]
 [   0    1    0    0    2    0   12 4963   17    3    1    0    0    1]
 [   1    4    2    0    3    0    9   13 4968    0    0    0    0    0]
 [   1    0    0    2    1    0    0    8    0 4953   33    1    0    1]
 [  12    1    0    0    0    0    2    4    0   34 4946    1    0    0]
 [   6    0   36    2    0    0    0    0    0    1    1 4928   15   11]
 [   8    2   24    5    2    3    2    3    0    3    0   25 4875   48]
 [  34    4   75    8   13    3    3    9    1    5    5    6   43 4791]]
Figure(640x480)
[[4769   34   19    4   13   44   42    3    0    3    1    9   12   47]
 [  49 4896    2    1    9    1   30    0    1    1    1    1    1    7]
 [  36   11 4726    9   75    1    8    1    1    0    3   38   14   77]
 [   5    1   14 4961   13    0    0    0    1    0    0    1    2    2]
 [   8    8   66    8 4885    7    4    1    1    1    0    1    2    8]
 [  42    1    3    0    0 4944    4    1    1    0    0    1    1    2]
 [  66   34    3    1    7   12 4828   26    9    4    0    2    2    6]
 [   2    2    0    1    1    0   22 4957   11    4    0    0    0    0]
 [   1    1    1    0    4    0    8   12 4973    0    0    0    0    0]
 [   1    0    0    1    1    0    0    4    0 4967   25    0    0    1]
 [  13    1    0    0    0    2    1    1    0   19 4963    0    0    0]
 [   8    0   34    2    0    0    0    0    0    0    0 4940    8    8]
 [  13    1   13    1    0    0    0    0    0    0    0   23 4901   48]
 [  41    2   73    3    5    5    5    0    0    0    1    6   42 4817]]
Figure(640x480)
[[4777   35   19    2   14   36   46    3    0    3    2   11   10   42]
 [  62 4879    2    1   13    1   28    0    2    1    1    1    3    6]
 [  35    8 4723    9   80    3    9    2    1    0    2   37   18   73]
 [   5    1   14 4956   15    1    0    0    1    0    0    1    3    3]
 [   9    8   70   10 4877    7    4    1    2    1    0    1    2    8]
 [  53    1    3    0    0 4932    3    1    1    1    0    2    1    2]
 [  75   35    2    2    7   14 4814   27   10    3    0    2    2    7]
 [   4    1    0    1    1    1   22 4954   11    5    0    0    0    0]
 [   2    0    1    0    3    0    5   13 4976    0    0    0    0    0]
 [   2    0    0    1    2    0    0    3    0 4966   25    0    0    1]
 [  13    1    0    0    0    1    1    0    0   20 4964    0    0    0]
 [   9    0   38    1    0    2    0    0    0    0    0 4936    9    5]
 [  13    1   13    1    0    0    0    0    0    1    0   24 4895   52]
 [  50    4   82    2    4    6    4    0    0    0    1    8   37 4802]]
Figure(640x480)
[[4777   36   19    1   16   36   45    2    0    3    3   12    9   41]
 [  64 4877    2    1   13    1   28    0    2    1    1    1    3    6]
 [  35   10 4721   10   79    3    9    3    1    0    2   37   18   72]
 [   6    1   14 4955   15    1    0    0    1    0    0    1    3    3]
 [   9    8   68    9 4879    7    4    1    2    1    0    1    2    9]
 [  54    1    3    0    0 4933    2    1    1    1    0    1    1    2]
 [  77   36    2    2    9   14 4810   27    9    3    0    2    2    7]
 [   4    1    0    1    1    1   22 4953   12    5    0    0    0    0]
 [   2    0    1    0    3    0    5   12 4977    0    0    0    0    0]
 [   2    0    0    1    2    0    0    3    0 4966   25    0    0    1]
 [  13    1    0    0    1    1    1    0    0   19 4964    0    0    0]
 [   9    0   39    1    0    2    0    0    0    0    0 4935    9    5]
 [  14    1   13    1    0    0    0    0    0    1    0   24 4894   52]
 [  50    4   82    2    3    6    4    0    0    0    1    8   38 4802]]
Figure(640x480)
[[4779   35   19    1   16   36   45    1    0    3    3   12    9   41]
 [  64 4877    2    1   13    1   28    0    2    1    1    1    3    6]
 [  35   11 4721   10   79    3    9    3    1    0    2   37   17   72]
 [   5    1   14 4956   15    1    0    0    1    0    0    1    3    3]
 [   9    8   70    9 4878    7    4    1    2    1    0    1    2    8]
 [  55    1    3    0    0 4932    2    1    1    1    0    1    1    2]
 [  78   36    2    2    9   14 4809   27    9    3    0    2    2    7]
 [   4    1    0    1    1    1   22 4953   12    5    0    0    0    0]
 [   2    1    1    0    3    0    5   12 4976    0    0    0    0    0]
 [   2    0    0    1    2    0    0    3    0 4967   24    0    0    1]
 [  13    1    0    0    1    1    1    0    0   19 4964    0    0    0]
 [   9    0   39    1    0    2    0    0    0    0    0 4935    9    5]
 [  14    1   14    1    0    0    0    0    0    1    0   24 4893   52]
 [  50    4   82    2    4    6    4    0    0    0    1    8   39 4800]]
Figure(640x480)
[[4779   35   19    1   16   36   45    1    0    3    3   12    9   41]
 [  64 4877    2    1   13    1   28    0    2    1    1    1    3    6]
 [  35   11 4723    9   79    3    9    2    1    0    2   37   17   72]
 [   5    1   14 4956   15    1    0    0    1    0    0    1    3    3]
 [   9    8   70    9 4878    7    4    1    2    1    0    1    2    8]
 [  56    1    3    0    0 4931    2    1    1    1    0    1    1    2]
 [  78   36    2    2    9   14 4809   27    9    3    0    2    2    7]
 [   4    1    0    1    1    1   22 4953   12    5    0    0    0    0]
 [   2    1    1    0    3    0    5   12 4976    0    0    0    0    0]
 [   2    0    0    1    2    0    0    3    0 4966   25    0    0    1]
 [  13    1    0    0    1    1    1    0    0   19 4964    0    0    0]
 [   9    0   39    1    0    2    0    0    0    0    0 4935    9    5]
 [  14    1   14    1    0    0    0    0    0    1    0   24 4893   52]
 [  50    4   83    2    4    6    4    0    0    0    1    7   39 4800]]
Figure(640x480)
[[4780   35   19    1   15   36   45    1    0    3    3   12    9   41]
 [  64 4878    2    1   13    1   27    0    2    1    1    1    3    6]
 [  36   11 4722   10   79    2    9    2    1    0    2   37   17   72]
 [   5    1   14 4957   15    1    0    0    1    0    0    1    3    2]
 [   9    8   71    9 4877    7    4    1    2    1    0    1    2    8]
 [  56    1    3    0    0 4930    3    1    1    1    0    1    1    2]
 [  78   36    2    2    9   14 4809   27    9    3    0    2    2    7]
 [   4    1    0    1    1    1   22 4953   12    5    0    0    0    0]
 [   2    1    1    0    3    0    5   12 4976    0    0    0    0    0]
 [   2    0    0    1    2    0    0    3    0 4967   24    0    0    1]
 [  13    1    0    0    1    1    1    0    0   19 4964    0    0    0]
 [   9    0   40    1    0    2    0    0    0    0    0 4934    9    5]
 [  14    1   14    1    0    0    0    0    0    1    0   24 4893   52]
 [  50    4   83    2    4    6    4    0    0    0    1    7   39 4800]]
Figure(640x480)
[[4780   35   18    1   16   36   45    1    0    3    3   12    9   41]
 [  64 4878    2    1   13    1   27    0    2    1    1    1    3    6]
 [  36   11 4722   10   79    2    9    2    1    0    2   37   17   72]
 [   5    1   14 4957   15    1    0    0    1    0    0    1    3    2]
 [   9    8   70    9 4878    7    4    1    2    1    0    1    2    8]
 [  56    1    3    0    0 4930    3    1    1    1    0    1    1    2]
 [  78   36    2    2    9   14 4809   27    9    3    0    2    2    7]
 [   4    1    0    1    1    1   22 4953   12    5    0    0    0    0]
 [   2    1    1    0    3    0    5   12 4976    0    0    0    0    0]
 [   2    0    0    1    2    0    0    3    0 4966   25    0    0    1]
 [  13    1    0    0    1    1    1    0    0   19 4964    0    0    0]
 [   9    0   40    1    0    2    0    0    0    0    0 4934    9    5]
 [  14    1   14    1    0    0    0    0    0    1    0   24 4893   52]
 [  50    4   83    2    4    6    4    0    0    0    1    7   39 4800]]
Figure(640x480)
[[4781   35   18    1   15   36   45    1    0    3    3   12    9   41]
 [  64 4879    2    1   13    1   27    0    2    1    1    1    2    6]
 [  36   11 4722   10   79    2    9    2    1    0    2   37   17   72]
 [   5    1   14 4957   15    1    0    0    1    0    0    1    3    2]
 [  10    8   71    9 4877    6    4    1    2    1    0    1    2    8]
 [  57    1    3    0    0 4928    3    1    1    1    0    2    1    2]
 [  78   36    2    2    9   14 4809   27    9    3    0    2    2    7]
 [   4    1    0    1    1    1   22 4953   12    5    0    0    0    0]
 [   2    1    1    0    3    0    5   12 4976    0    0    0    0    0]
 [   2    0    0    1    2    0    0    3    0 4966   25    0    0    1]
 [  13    1    0    0    1    1    1    0    0   19 4964    0    0    0]
 [   9    0   40    1    0    2    0    0    0    0    0 4934    9    5]
 [  14    1   14    1    0    0    0    0    0    1    0   24 4893   52]
 [  50    4   83    2    4    6    4    0    0    0    1    7   39 4800]]
Figure(640x480)
[[4781   35   18    1   15   36   46    0    0    3    3   12    9   41]
 [  64 4879    2    1   13    1   27    0    2    1    1    1    2    6]
 [  36   11 4722   10   79    2    9    2    1    0    2   37   17   72]
 [   5    1   14 4957   15    1    0    0    1    0    0    1    3    2]
 [  10    8   71    9 4877    6    4    1    2    1    0    1    2    8]
 [  57    1    3    0    0 4929    3    1    1    1    0    1    1    2]
 [  78   36    2    2    9   14 4809   27    9    3    0    2    2    7]
 [   4    1    0    1    1    1   22 4952   13    5    0    0    0    0]
 [   2    1    1    0    3    0    5   12 4976    0    0    0    0    0]
 [   2    0    0    1    2    0    0    3    0 4966   25    0    0    1]
 [  13    1    0    0    1    1    1    0    0   19 4964    0    0    0]
 [   9    0   40    1    0    2    0    0    0    0    0 4934    9    5]
 [  14    1   14    1    0    0    0    0    0    1    0   24 4893   52]
 [  50    4   83    2    4    6    4    0    0    0    1    7   39 4800]]
Figure(640x480)
