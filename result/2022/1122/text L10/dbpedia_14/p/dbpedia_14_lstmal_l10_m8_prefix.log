total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask7//dbpedia_14/dbpedia_14_lstmal_l10_m7_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.07942142857142857 (44476/560000), AUC 0.5638607144355774
Test Epoch0 layer0 Acc 0.9734285714285714, AUC 0.9982985258102417
Save ckpt to ./ckpt/mask8//dbpedia_14/dbpedia_14_lstmal_l10_m8_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9859714285714286, AUC 0.9985231757164001
Save ckpt to ./ckpt/mask8//dbpedia_14/dbpedia_14_lstmal_l10_m8_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9859, AUC 0.998450756072998
Test Epoch0 layer3 Acc 0.9859714285714286, AUC 0.9974597096443176
Test Epoch0 layer4 Acc 0.9859714285714286, AUC 0.997717022895813
Test Epoch0 layer5 Acc 0.9859571428571429, AUC 0.9974156618118286
Test Epoch0 layer6 Acc 0.9858428571428571, AUC 0.9973338842391968
Test Epoch0 layer7 Acc 0.9857714285714285, AUC 0.9973491430282593
Test Epoch0 layer8 Acc 0.07658571428571428, AUC 0.5267148017883301
Test Epoch0 layer9 Acc 0.07252857142857143, AUC 0.5683029294013977
gc 0
Train Epoch1 Acc 0.07220535714285714 (40435/560000), AUC 0.5724784135818481
Test Epoch1 layer0 Acc 0.9740571428571428, AUC 0.9982867240905762
Test Epoch1 layer1 Acc 0.9851571428571428, AUC 0.9981260299682617
Test Epoch1 layer2 Acc 0.9850571428571429, AUC 0.9980958104133606
Test Epoch1 layer3 Acc 0.9850428571428571, AUC 0.9973217248916626
Test Epoch1 layer4 Acc 0.9850714285714286, AUC 0.9973136186599731
Test Epoch1 layer5 Acc 0.9850285714285715, AUC 0.9971938133239746
Test Epoch1 layer6 Acc 0.9848714285714286, AUC 0.9969960451126099
Test Epoch1 layer7 Acc 0.9848285714285714, AUC 0.997365415096283
Test Epoch1 layer8 Acc 0.07342857142857143, AUC 0.5030310750007629
Test Epoch1 layer9 Acc 0.07298571428571429, AUC 0.5770003199577332
gc 0
Train Epoch2 Acc 0.07235 (40516/560000), AUC 0.5791392922401428
Test Epoch2 layer0 Acc 0.9738142857142857, AUC 0.998270571231842
Test Epoch2 layer1 Acc 0.9857428571428571, AUC 0.9982331395149231
Test Epoch2 layer2 Acc 0.9858714285714286, AUC 0.9980097413063049
Test Epoch2 layer3 Acc 0.9858857142857143, AUC 0.9970933794975281
Test Epoch2 layer4 Acc 0.9858714285714286, AUC 0.9971071481704712
Test Epoch2 layer5 Acc 0.9858428571428571, AUC 0.9966683983802795
Test Epoch2 layer6 Acc 0.9858714285714286, AUC 0.996636688709259
Test Epoch2 layer7 Acc 0.9858428571428571, AUC 0.9970077276229858
Test Epoch2 layer8 Acc 0.07271428571428572, AUC 0.5064223408699036
Test Epoch2 layer9 Acc 0.07311428571428571, AUC 0.5787020325660706
gc 0
Train Epoch3 Acc 0.07229821428571429 (40487/560000), AUC 0.5875144600868225
Test Epoch3 layer0 Acc 0.9738857142857142, AUC 0.9982374906539917
Test Epoch3 layer1 Acc 0.9863428571428572, AUC 0.9980015754699707
Test Epoch3 layer2 Acc 0.9862571428571428, AUC 0.9976039528846741
Test Epoch3 layer3 Acc 0.9862, AUC 0.9969795942306519
Test Epoch3 layer4 Acc 0.9862, AUC 0.997015655040741
Test Epoch3 layer5 Acc 0.9862, AUC 0.9966263771057129
Test Epoch3 layer6 Acc 0.9861857142857143, AUC 0.9966492652893066
Test Epoch3 layer7 Acc 0.9861, AUC 0.9971330761909485
Test Epoch3 layer8 Acc 0.07241428571428571, AUC 0.4970071315765381
Test Epoch3 layer9 Acc 0.07252857142857143, AUC 0.5874764323234558
gc 0
Train Epoch4 Acc 0.072275 (40474/560000), AUC 0.5988712310791016
Test Epoch4 layer0 Acc 0.9737571428571429, AUC 0.9982678294181824
Test Epoch4 layer1 Acc 0.9855571428571429, AUC 0.9979179501533508
Test Epoch4 layer2 Acc 0.9855857142857143, AUC 0.9977280497550964
Test Epoch4 layer3 Acc 0.9855857142857143, AUC 0.9968451857566833
Test Epoch4 layer4 Acc 0.9855857142857143, AUC 0.9970577359199524
Test Epoch4 layer5 Acc 0.9855142857142857, AUC 0.9966556429862976
Test Epoch4 layer6 Acc 0.9855714285714285, AUC 0.9965915679931641
Test Epoch4 layer7 Acc 0.9855285714285714, AUC 0.9968148469924927
Test Epoch4 layer8 Acc 0.07258571428571428, AUC 0.49905022978782654
Test Epoch4 layer9 Acc 0.07267142857142857, AUC 0.6060801148414612
gc 0
Train Epoch5 Acc 0.07211607142857143 (40385/560000), AUC 0.6082234382629395
Test Epoch5 layer0 Acc 0.974, AUC 0.9982833862304688
Test Epoch5 layer1 Acc 0.9857, AUC 0.9978817701339722
Test Epoch5 layer2 Acc 0.9856142857142857, AUC 0.9976056218147278
Test Epoch5 layer3 Acc 0.9855, AUC 0.9967749714851379
Test Epoch5 layer4 Acc 0.9856142857142857, AUC 0.9967725872993469
Test Epoch5 layer5 Acc 0.9856, AUC 0.9965972304344177
Test Epoch5 layer6 Acc 0.9856, AUC 0.9961265325546265
Test Epoch5 layer7 Acc 0.9855714285714285, AUC 0.9967314600944519
Test Epoch5 layer8 Acc 0.07281428571428572, AUC 0.4928775429725647
Test Epoch5 layer9 Acc 0.07271428571428572, AUC 0.6115296483039856
gc 0
Train Epoch6 Acc 0.07203214285714286 (40338/560000), AUC 0.6124563217163086
Test Epoch6 layer0 Acc 0.9738285714285714, AUC 0.9982873797416687
Test Epoch6 layer1 Acc 0.9855428571428572, AUC 0.9978079199790955
Test Epoch6 layer2 Acc 0.9855285714285714, AUC 0.9974955916404724
Test Epoch6 layer3 Acc 0.9856142857142857, AUC 0.9966691732406616
Test Epoch6 layer4 Acc 0.9856571428571429, AUC 0.9966718554496765
Test Epoch6 layer5 Acc 0.9856714285714285, AUC 0.9963451027870178
Test Epoch6 layer6 Acc 0.9856428571428572, AUC 0.9962786436080933
Test Epoch6 layer7 Acc 0.9856, AUC 0.9965448379516602
Test Epoch6 layer8 Acc 0.07292857142857143, AUC 0.49492546916007996
Test Epoch6 layer9 Acc 0.07275714285714285, AUC 0.614847719669342
gc 0
Train Epoch7 Acc 0.07213035714285715 (40393/560000), AUC 0.6129055023193359
Test Epoch7 layer0 Acc 0.9737714285714286, AUC 0.998270571231842
Test Epoch7 layer1 Acc 0.9852857142857143, AUC 0.9976344108581543
Test Epoch7 layer2 Acc 0.9854285714285714, AUC 0.9972115159034729
Test Epoch7 layer3 Acc 0.9854142857142857, AUC 0.9964038729667664
Test Epoch7 layer4 Acc 0.9854571428571428, AUC 0.9964752197265625
Test Epoch7 layer5 Acc 0.9854, AUC 0.9961033463478088
Test Epoch7 layer6 Acc 0.9854428571428572, AUC 0.9956732988357544
Test Epoch7 layer7 Acc 0.9854, AUC 0.9963911771774292
Test Epoch7 layer8 Acc 0.07251428571428571, AUC 0.4977896809577942
Test Epoch7 layer9 Acc 0.07254285714285715, AUC 0.6125579476356506
gc 0
Train Epoch8 Acc 0.07216964285714286 (40415/560000), AUC 0.6154108047485352
Test Epoch8 layer0 Acc 0.9738428571428571, AUC 0.9982666969299316
Test Epoch8 layer1 Acc 0.9852285714285715, AUC 0.9974948167800903
Test Epoch8 layer2 Acc 0.9852857142857143, AUC 0.9970778822898865
Test Epoch8 layer3 Acc 0.9852714285714286, AUC 0.9963002800941467
Test Epoch8 layer4 Acc 0.9852714285714286, AUC 0.9962274432182312
Test Epoch8 layer5 Acc 0.9852714285714286, AUC 0.9958992600440979
Test Epoch8 layer6 Acc 0.9852714285714286, AUC 0.9956035614013672
Test Epoch8 layer7 Acc 0.9852857142857143, AUC 0.9960172772407532
Test Epoch8 layer8 Acc 0.07271428571428572, AUC 0.49721816182136536
Test Epoch8 layer9 Acc 0.07274285714285714, AUC 0.6205804944038391
gc 0
Train Epoch9 Acc 0.07209285714285714 (40372/560000), AUC 0.6175860166549683
Test Epoch9 layer0 Acc 0.9735285714285714, AUC 0.9983018040657043
Test Epoch9 layer1 Acc 0.9850428571428571, AUC 0.9974246621131897
Test Epoch9 layer2 Acc 0.9849714285714286, AUC 0.9971461296081543
Test Epoch9 layer3 Acc 0.9850142857142857, AUC 0.9962915182113647
Test Epoch9 layer4 Acc 0.9850142857142857, AUC 0.9963777661323547
Test Epoch9 layer5 Acc 0.9850142857142857, AUC 0.9960485100746155
Test Epoch9 layer6 Acc 0.9849285714285714, AUC 0.9957993626594543
Test Epoch9 layer7 Acc 0.9849285714285714, AUC 0.9961499571800232
Test Epoch9 layer8 Acc 0.07272857142857143, AUC 0.49500611424446106
Test Epoch9 layer9 Acc 0.0726, AUC 0.6180930733680725
Best AUC 0.9985231757164001
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask8//dbpedia_14/dbpedia_14_lstmal_l10_m8_prefix.pt
[[4681   43   26   14   11   64   44   10    4    7    5   22   19   50]
 [  37 4896    2    2    7    0   30    6    4    2    1    0    4    9]
 [  35   13 4628   19   48    1    8    2    5    0    1   80   21  139]
 [   3    1   29 4953   10    0    1    0    0    0    0    0    0    3]
 [   9   19   98   16 4824    9    6    1    2    1    0    0    3   12]
 [  38    2    3    5    1 4936    5    1    1    5    0    0    1    2]
 [  60   48    8    3   11   14 4796   35   11    5    1    1    4    3]
 [   0    1    0    0    2    0   12 4960   19    4    1    0    0    1]
 [   1    4    2    0    3    0   12   12 4966    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4962   26    0    0    1]
 [  13    1    1    0    0    0    1    3    0   36 4945    0    0    0]
 [   5    0   39    2    0    0    1    0    0    1    0 4925   15   12]
 [  10    2   28    7    1    1    1    3    0    4    0   23 4877   43]
 [  26    6   83    7   12    3    4    9    1    6    4    6   42 4791]]
Figure(640x480)
[[4812   35   10    4   11   24   51    2    0    1    0    6    6   38]
 [  35 4921    0    0    7    1   26    1    1    1    0    0    1    6]
 [  14    3 4850   11   68    1    3    0    0    1    0   11    5   33]
 [   2    1   15 4968   11    0    0    0    0    0    0    1    2    0]
 [   5    5   51   10 4915    2    5    0    0    1    0    0    3    3]
 [  32    0    1    0    1 4954    4    2    1    1    0    0    0    4]
 [  52   30    1    0    1   11 4880   12    6    2    0    0    3    2]
 [   2    0    0    0    0    2   19 4967    8    0    0    1    0    1]
 [   3    0    1    0    2    0    6    6 4982    0    0    0    0    0]
 [   3    0    0    2    0    1    1    2    0 4965   24    0    1    1]
 [  15    1    0    0    0    0    1    1    0   17 4963    0    0    2]
 [   3    0    7    1    0    0    0    0    0    0    0 4974   11    4]
 [   7    0    3    0    0    0    1    0    0    0    0   19 4942   28]
 [  24    1   13    1    3    1    3    0    0    0    1    6   22 4925]]
Figure(640x480)
[[4814   35   12    4   11   22   51    2    0    1    0    6    7   35]
 [  36 4921    2    0    5    1   26    1    1    1    0    0    1    5]
 [  15    3 4853   10   65    1    1    0    0    1    0   12    5   34]
 [   2    1   15 4968   11    0    0    0    0    0    0    1    2    0]
 [   5    3   57   10 4910    3    4    0    0    1    0    0    4    3]
 [  30    0    1    0    1 4956    4    2    1    1    0    0    0    4]
 [  51   30    1    0    1   11 4878   14    6    2    0    0    3    3]
 [   3    0    0    0    0    1   18 4968    8    0    0    1    0    1]
 [   3    0    1    0    2    0    6    6 4982    0    0    0    0    0]
 [   3    0    1    2    0    1    1    2    0 4964   24    0    1    1]
 [  15    1    0    0    1    0    1    0    0   20 4960    0    0    2]
 [   3    0    7    1    0    0    0    0    0    0    0 4974   11    4]
 [   6    0    3    0    0    0    1    0    0    0    0   20 4942   28]
 [  24    1   13    1    3    1    3    0    0    0    1    7   23 4923]]
Figure(640x480)
[[4813   35   12    4   11   23   49    2    0    1    0    6    7   37]
 [  34 4923    1    0    6    1   26    1    1    1    0    0    1    5]
 [  15    3 4854   10   65    1    1    0    0    1    0   11    5   34]
 [   1    1   16 4968   11    0    0    0    0    0    0    1    2    0]
 [   5    3   57   10 4910    2    4    0    0    1    0    0    5    3]
 [  30    0    1    0    1 4956    4    2    0    1    0    0    0    5]
 [  50   32    1    0    1   11 4877   14    6    2    0    0    3    3]
 [   2    0    0    0    0    2   18 4967    9    0    0    1    0    1]
 [   3    0    1    0    2    0    6    6 4982    0    0    0    0    0]
 [   2    0    0    1    0    1    1    1    0 4969   23    0    1    1]
 [  15    1    0    0    1    0    1    0    0   22 4958    0    0    2]
 [   3    0    7    1    0    0    0    0    0    0    0 4974   11    4]
 [   6    0    3    0    0    0    1    0    0    0    0   19 4943   28]
 [  24    1   13    1    3    1    3    0    0    0    1    6   23 4924]]
Figure(640x480)
[[4811   35   12    4   11   22   54    2    0    1    0    6    7   35]
 [  34 4923    1    0    6    1   26    1    1    1    0    0    1    5]
 [  14    3 4855   10   65    1    2    0    0    1    0   12    5   32]
 [   1    1   16 4968   11    0    0    0    0    0    0    1    2    0]
 [   5    3   56   10 4910    2    5    0    0    1    0    0    5    3]
 [  30    0    1    0    1 4956    4    2    1    1    0    0    0    4]
 [  49   32    1    0    1   11 4878   14    6    2    0    0    3    3]
 [   2    0    0    0    0    2   18 4968    8    0    0    1    0    1]
 [   2    1    1    0    2    0    6    6 4982    0    0    0    0    0]
 [   2    0    0    1    0    1    1    2    0 4968   23    0    1    1]
 [  15    1    0    0    1    0    1    0    0   23 4957    0    0    2]
 [   3    0    7    1    0    0    0    0    0    0    0 4974   11    4]
 [   4    0    3    0    0    0    1    0    0    0    0   20 4945   27]
 [  24    1   13    1    3    1    3    0    0    0    1    7   23 4923]]
Figure(640x480)
[[4811   35   12    4   11   22   52    2    1    1    0    6    7   36]
 [  34 4923    0    0    7    1   26    1    1    1    0    0    1    5]
 [  14    3 4854   10   67    1    2    0    0    1    0   11    5   32]
 [   1    1   16 4969   10    0    0    0    0    0    0    1    2    0]
 [   5    3   56   10 4910    2    5    0    0    1    0    0    5    3]
 [  30    0    1    0    1 4956    4    2    1    1    0    0    0    4]
 [  49   31    1    0    1   11 4879   14    6    2    0    0    3    3]
 [   3    0    0    0    0    1   18 4967    9    0    0    1    0    1]
 [   3    0    1    0    2    0    6    6 4982    0    0    0    0    0]
 [   2    0    0    1    0    1    1    2    0 4969   22    0    1    1]
 [  15    1    0    0    1    0    1    0    0   23 4957    0    0    2]
 [   3    0    7    1    0    0    0    0    0    0    0 4973   12    4]
 [   6    0    3    0    0    0    1    0    0    0    0   20 4943   27]
 [  24    1   13    0    3    1    3    0    0    0    1    7   23 4924]]
Figure(640x480)
[[4811   36   12    4   11   22   49    2    1    1    0    5    9   37]
 [  35 4923    2    0    4    1   26    1    1    1    0    1    0    5]
 [  15    3 4860   10   61    1    2    0    0    1    0   11    5   31]
 [   1    1   16 4969   10    0    0    0    0    0    0    1    2    0]
 [   5    4   60   10 4905    3    3    1    0    1    0    0    5    3]
 [  31    0    1    0    1 4955    4    2    1    1    0    0    0    4]
 [  50   34    1    0    1   10 4876   14    6    2    0    0    3    3]
 [   3    0    0    0    0    1   17 4968    9    0    0    1    0    1]
 [   2    1    1    0    2    0    7    6 4980    0    0    0    0    1]
 [   2    0    1    1    0    1    1    2    0 4966   24    0    1    1]
 [  15    1    0    0    1    0    1    0    0   23 4957    0    0    2]
 [   3    0    7    1    0    0    0    0    0    0    0 4972   13    4]
 [   6    0    3    0    0    0    1    0    0    0    0   20 4943   27]
 [  24    1   13    0    3    1    3    0    0    0    1    7   23 4924]]
Figure(640x480)
[[4808   37   11    4   10   23   51    2    1    1    0    5    9   38]
 [  36 4922    2    0    4    1   26    1    1    1    0    1    0    5]
 [  15    3 4860   10   59    1    2    0    0    1    0   12    5   32]
 [   3    1   15 4968   10    0    1    0    0    0    0    0    2    0]
 [   5    5   58   10 4906    3    3    1    0    1    0    0    5    3]
 [  32    0    1    0    1 4954    4    2    1    1    0    0    0    4]
 [  50   34    1    0    1   10 4878   14    5    1    0    0    3    3]
 [   3    0    0    0    0    1   19 4966    9    0    0    1    0    1]
 [   2    1    1    0    1    0    7    6 4981    0    0    0    0    1]
 [   2    0    1    1    0    1    1    2    0 4968   22    0    1    1]
 [  15    1    0    0    1    0    1    0    0   23 4957    0    0    2]
 [   3    0    7    1    0    0    0    0    0    0    0 4972   13    4]
 [   8    0    3    0    0    0    1    0    0    0    0   20 4941   27]
 [  24    0   13    0    4    1    4    0    0    0    1    7   23 4923]]
Figure(640x480)
[[   0 4754    0   13    1    0    0  153    1    0    0   54    0   24]
 [   0   33    0 4406    0    0    0  456   45    0    0   54    0    6]
 [   0   39    0    1    0    0    0   61    0    0    0 4898    0    1]
 [   0    0    0    1    0    0    0  935    0    0    0   23    0 4041]
 [   0    6    0    0    0    0    0 4904    0    0    0   89    0    1]
 [   0   25    0    0    0    0    0 4868   26    0    0   81    0    0]
 [   0   35    0    8    1    0    0 4884   59    0    0   10    0    3]
 [   0    1    0    0    0    0    0 4997    0    0    0    2    0    0]
 [   0    1    0    0    0    0    0 4908    0    0    0   91    0    0]
 [   0    8    0    3 4659    0    0   25    6  277    0   22    0    0]
 [   0   14    0    0   96    0    0 4880    3    0    0    7    0    0]
 [   0 4908    0    0    0    0   35    3    0    0    0   53    0    1]
 [   0   36    0    1    0    0    0    1    0    0    0 4962    0    0]
 [   0 4910    0    0    0    0    0    6    2    0    0   82    0    0]]
Figure(640x480)
[[   0 4349    0    0   80    0    0    0    1    0  111    7    0  452]
 [   0   11  103    0   27    0    0    0    0    0    1    1    0 4857]
 [   0    8    0    0 4851    0    0    0    0    0    3   37    0  101]
 [   0    0    0    0 3974    0    0    0    0    0    0 1018    0    8]
 [   0    0    0    0   73    0    0    0    0    0    3 4846    0   78]
 [   0   13    0    0 4957    0    0    0    2    0    0    0    0   28]
 [   0   15    0    0 3350    0    0    0    7    0    1    1    0 1626]
 [   0    0    0    0   18    0    0    0 1037    0    1 3831    0  113]
 [   0    0    0    0 4982    0    0    0    3    0    4    4    0    7]
 [   0    1    0    0  698    0    0    0 2240    0 2050   10    0    1]
 [   0   10    0    0 4973    0    0    0    6    0    5    0    0    6]
 [   0    0    0    0   25    0    0    0    0    0    0   28    0 4947]
 [   0    2    0    0 4925    0    0    0    0    0    0    6    0   67]
 [   0    6    0    0   32    0    0    0    0    0    2    3    0 4957]]
Figure(640x480)
