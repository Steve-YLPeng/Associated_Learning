total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask5//dbpedia_14/dbpedia_14_transformeral_l10_m5.pt
Start Training
gc 9
Train Epoch0 Acc 0.08312678571428571 (46551/560000), AUC 0.4833603501319885
Test Epoch0 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch0 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch0 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch0 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch0 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch0 layer5 Acc 0.9776142857142858, AUC 0.9978675246238708
Save ckpt to ./ckpt/mask6//dbpedia_14/dbpedia_14_transformeral_l10_m6.pt  ,ep 0
Test Epoch0 layer6 Acc 0.07142857142857142, AUC 0.47060975432395935
Test Epoch0 layer7 Acc 0.07208571428571428, AUC 0.4985266327857971
Test Epoch0 layer8 Acc 0.0037142857142857142, AUC 0.532479465007782
Test Epoch0 layer9 Acc 0.13582857142857144, AUC 0.4727229177951813
gc 0
Train Epoch1 Acc 0.1113 (62328/560000), AUC 0.492520272731781
Test Epoch1 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch1 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch1 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch1 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch1 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch1 layer5 Acc 0.9778, AUC 0.9978994131088257
Save ckpt to ./ckpt/mask6//dbpedia_14/dbpedia_14_transformeral_l10_m6.pt  ,ep 1
Test Epoch1 layer6 Acc 0.07168571428571428, AUC 0.3565036952495575
Test Epoch1 layer7 Acc 0.11567142857142858, AUC 0.47850775718688965
Test Epoch1 layer8 Acc 0.07225714285714285, AUC 0.5522816181182861
Test Epoch1 layer9 Acc 0.07097142857142857, AUC 0.5426270365715027
gc 0
Train Epoch2 Acc 0.07188571428571429 (40256/560000), AUC 0.553523600101471
Test Epoch2 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch2 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch2 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch2 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch2 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch2 layer5 Acc 0.9778857142857142, AUC 0.9978248476982117
Test Epoch2 layer6 Acc 0.07144285714285714, AUC 0.37685152888298035
Test Epoch2 layer7 Acc 0.07377142857142857, AUC 0.509556770324707
Test Epoch2 layer8 Acc 0.1722, AUC 0.5280777812004089
Test Epoch2 layer9 Acc 0.07094285714285714, AUC 0.5880576372146606
gc 0
Train Epoch3 Acc 0.07273928571428571 (40734/560000), AUC 0.5601845979690552
Test Epoch3 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch3 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch3 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch3 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch3 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch3 layer5 Acc 0.9778714285714286, AUC 0.9979328513145447
Save ckpt to ./ckpt/mask6//dbpedia_14/dbpedia_14_transformeral_l10_m6.pt  ,ep 3
Test Epoch3 layer6 Acc 0.07174285714285714, AUC 0.39327818155288696
Test Epoch3 layer7 Acc 0.07301428571428571, AUC 0.5139905214309692
Test Epoch3 layer8 Acc 0.11715714285714286, AUC 0.5081983208656311
Test Epoch3 layer9 Acc 0.071, AUC 0.5704742074012756
gc 0
Train Epoch4 Acc 0.07241428571428571 (40552/560000), AUC 0.564511239528656
Test Epoch4 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch4 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch4 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch4 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch4 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch4 layer5 Acc 0.9779285714285715, AUC 0.9977342486381531
Test Epoch4 layer6 Acc 0.0719, AUC 0.41213464736938477
Test Epoch4 layer7 Acc 0.0732, AUC 0.5290594100952148
Test Epoch4 layer8 Acc 0.12044285714285714, AUC 0.5021577477455139
Test Epoch4 layer9 Acc 0.07098571428571429, AUC 0.5808776617050171
gc 0
Train Epoch5 Acc 0.07149107142857143 (40035/560000), AUC 0.5670102834701538
Test Epoch5 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch5 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch5 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch5 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch5 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch5 layer5 Acc 0.9779714285714286, AUC 0.9977730512619019
Test Epoch5 layer6 Acc 0.07194285714285714, AUC 0.42454975843429565
Test Epoch5 layer7 Acc 0.07328571428571429, AUC 0.522236168384552
Test Epoch5 layer8 Acc 0.1358, AUC 0.5104942917823792
Test Epoch5 layer9 Acc 0.07097142857142857, AUC 0.5822626352310181
gc 0
Train Epoch6 Acc 0.07090535714285714 (39707/560000), AUC 0.5657161474227905
Test Epoch6 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch6 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch6 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch6 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch6 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch6 layer5 Acc 0.9779714285714286, AUC 0.9978142380714417
Test Epoch6 layer6 Acc 0.07192857142857143, AUC 0.42615094780921936
Test Epoch6 layer7 Acc 0.0734, AUC 0.521622359752655
Test Epoch6 layer8 Acc 0.13547142857142858, AUC 0.5050304532051086
Test Epoch6 layer9 Acc 0.07082857142857144, AUC 0.5827170014381409
gc 0
Train Epoch7 Acc 0.06919107142857144 (38747/560000), AUC 0.5648566484451294
Test Epoch7 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch7 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch7 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch7 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch7 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch7 layer5 Acc 0.9780428571428571, AUC 0.9977983832359314
Test Epoch7 layer6 Acc 0.07181428571428572, AUC 0.44507989287376404
Test Epoch7 layer7 Acc 0.07352857142857143, AUC 0.5227338671684265
Test Epoch7 layer8 Acc 0.1306, AUC 0.5123401284217834
Test Epoch7 layer9 Acc 0.0707, AUC 0.5779522657394409
gc 0
Train Epoch8 Acc 0.06613571428571428 (37036/560000), AUC 0.5632858872413635
Test Epoch8 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch8 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch8 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch8 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch8 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch8 layer5 Acc 0.9779714285714286, AUC 0.9977492690086365
Test Epoch8 layer6 Acc 0.07177142857142857, AUC 0.45232510566711426
Test Epoch8 layer7 Acc 0.07404285714285715, AUC 0.5199925303459167
Test Epoch8 layer8 Acc 0.09251428571428572, AUC 0.5112543702125549
Test Epoch8 layer9 Acc 0.06284285714285714, AUC 0.5744208693504333
gc 0
Train Epoch9 Acc 0.061910714285714284 (34670/560000), AUC 0.5612515211105347
Test Epoch9 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch9 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch9 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch9 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch9 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch9 layer5 Acc 0.9780714285714286, AUC 0.9978495240211487
Test Epoch9 layer6 Acc 0.07185714285714286, AUC 0.4524081349372864
Test Epoch9 layer7 Acc 0.07354285714285715, AUC 0.5192014575004578
Test Epoch9 layer8 Acc 0.13131428571428572, AUC 0.5133809447288513
Test Epoch9 layer9 Acc 0.06864285714285714, AUC 0.5776281952857971
Best AUC 0.9979328513145447
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask6//dbpedia_14/dbpedia_14_transformeral_l10_m6.pt
[[4690   45   22   14   12   71   40    8    4    6    7   20   19   42]
 [  29 4915    0    1    7    0   28    3    3    2    1    0    3    8]
 [  35   14 4612   19   58    2   11    5    5    0    1   79   20  139]
 [   2    2   26 4953   12    1    1    1    0    0    0    0    0    2]
 [   9   18   70   11 4857    9    6    3    2    1    0    0    3   11]
 [  31    1    3    3    1 4949    5    2    1    1    0    0    1    2]
 [  60   55    4    2   11   17 4792   36    9    5    1    1    4    3]
 [   0    1    0    0    2    0   13 4962   17    3    1    0    0    1]
 [   1    4    2    0    3    0   10   13 4966    1    0    0    0    0]
 [   1    0    1    2    0    0    0    6    0 4956   33    0    0    1]
 [  12    1    0    0    0    0    2    4    0   32 4949    0    0    0]
 [   6    0   40    2    0    0    1    0    0    1    1 4923   14   12]
 [   7    2   21    8    2    3    1    3    0    3    0   20 4883   47]
 [  33    7   81    8   14    3    3    9    2    4    5    6   46 4779]]
Figure(640x480)
[[4659   42   23   11   13   69   45    3    2    7    3   44   22   57]
 [  32 4904    3    2   11    1   25    1    2    1    1    0    9    8]
 [  31   13 4637   15   57    2   12    2    0    2    0   80   39  110]
 [   3    2   27 4955    9    1    1    0    0    0    0    0    0    2]
 [   6   12   69   17 4865    9    6    1    1    1    0    1    5    7]
 [  35    0    2    0    0 4949    6    2    1    1    0    1    3    0]
 [  61   43    3    3   16   15 4809   33    2    5    0    1    7    2]
 [   2    1    0    0    4    2   24 4949   10    4    2    0    1    1]
 [   1    3    4    0    6    0   16   16 4953    0    0    0    0    1]
 [   1    0    2    1    0    1    0    6    0 4963   24    0    0    2]
 [  12    2    0    0    0    1    0    2    0   36 4947    0    0    0]
 [   9    0   30    2    0    0    0    0    0    0    1 4931   16   11]
 [   5    1   15    2    0    1    0    0    0    2    0   18 4929   27]
 [  23    2   52    6   12    3    2    0    0    0    1   13   70 4816]]
Figure(640x480)
[[4718   45   28    7   14   57   43    3    3    5    3   24    9   41]
 [  32 4909    4    1   12    1   27    1    2    1    1    0    2    7]
 [  25   11 4725   10   63    1    9    1    0    2    0   45   19   89]
 [   2    2   28 4947   13    0    2    0    0    2    0    1    1    2]
 [   6   13   65   15 4870    7    7    1    1    2    0    2    1   10]
 [  43    0    3    0    0 4942    6    1    1    1    0    0    3    0]
 [  62   45    7    3   16   15 4803   29    5    5    0    1    7    2]
 [   3    1    0    0    4    0   25 4946   12    5    2    0    1    1]
 [   1    2    4    0    4    0   14   11 4963    0    0    0    0    1]
 [   1    0    2    1    0    1    0    3    0 4964   26    0    0    2]
 [  12    2    2    0    0    1    0    1    1   38 4942    0    0    1]
 [  12    0   44    2    0    0    0    0    0    0    0 4910   16   16]
 [  10    1   23    0    0    2    0    0    0    1    0   19 4908   36]
 [  32    3   70    3    8    1    2    0    0    0    1   10   47 4823]]
Figure(640x480)
[[4739   41   22    7   14   54   41    3    3    5    3   23    7   38]
 [  36 4902    4    1   11    1   31    1    1    1    1    0    2    8]
 [  28   10 4727   10   64    1   11    1    0    2    0   44   17   85]
 [   3    2   27 4948   13    0    0    1    0    2    0    1    1    2]
 [   6   12   65   14 4875    7    6    1    1    3    0    0    0   10]
 [  48    0    3    0    0 4936    7    1    1    1    0    0    3    0]
 [  65   37    9    3   16   14 4807   32    5    5    0    1    4    2]
 [   3    1    0    0    4    0   21 4950   12    5    2    0    1    1]
 [   1    3    4    0    5    0   14   11 4961    0    0    0    0    1]
 [   1    0    2    1    0    1    0    4    0 4965   24    0    0    2]
 [  13    2    2    0    0    0    0    3    1   41 4937    0    0    1]
 [  11    0   41    2    0    0    0    0    0    0    0 4915   15   16]
 [  12    2   28    0    1    1    0    0    0    1    0   20 4894   41]
 [  31    3   69    3    8    1    2    0    0    0    1   10   37 4835]]
Figure(640x480)
[[4747   39   23    7   13   54   40    5    2    5    2   21    7   35]
 [  39 4910    2    0    7    0   29    1    1    1    1    0    2    7]
 [  30    9 4740   10   63    1    6    1    0    2    0   39   19   80]
 [   3    2   25 4950   15    0    1    1    0    0    0    0    1    2]
 [   6   11   70   13 4871    7    7    0    1    4    1    1    1    7]
 [  46    0    2    0    0 4942    3    2    1    1    0    0    3    0]
 [  62   39    6    3   13   13 4815   30    7    5    0    1    3    3]
 [   2    1    0    0    3    0   24 4950   12    5    1    0    1    1]
 [   1    2    2    0    3    0   10   10 4971    0    0    0    0    1]
 [   1    0    2    1    0    1    0    4    0 4962   27    0    0    2]
 [  13    1    2    0    0    0    0    3    0   32 4949    0    0    0]
 [  11    0   49    2    0    0    0    0    0    0    0 4906   18   14]
 [  12    1   22    0    0    1    0    0    0    0    0   20 4904   40]
 [  31    2   82    3    6    1    2    0    0    0    1    8   40 4824]]
Figure(640x480)
[[4754   39   23    6   13   50   41    5    2    5    2   21    7   32]
 [  39 4910    2    0    7    0   29    1    1    1    1    0    2    7]
 [  29    9 4726   10   63    1    7    1    0    2    0   42   20   90]
 [   3    2   24 4950   14    0    2    0    0    1    0    1    1    2]
 [   6   11   65   13 4875    7    7    1    1    3    0    1    1    9]
 [  47    0    2    0    0 4940    4    2    1    1    0    0    3    0]
 [  57   38    5    3   10   13 4826   29    6    5    0    2    3    3]
 [   1    1    0    0    3    0   25 4950   12    5    1    0    1    1]
 [   1    2    2    0    4    0   10   10 4969    0    0    0    0    2]
 [   1    0    1    1    0    1    0    5    0 4962   27    0    0    2]
 [  13    1    2    0    0    0    0    3    0   32 4949    0    0    0]
 [  11    0   46    2    0    0    0    0    0    0    0 4910   17   14]
 [  12    1   20    0    0    1    0    0    0    0    0   20 4898   48]
 [  35    2   73    3    5    1    3    0    0    0    2    9   35 4832]]
Figure(640x480)
[[  32    0    0    0 4968    0    0    0    0    0    0    0    0    0]
 [   4    0    0    0 4995    0    0    1    0    0    0    0    0    0]
 [  83    1    0    0 4911    0    0    5    0    0    0    0    0    0]
 [   1    0    0    0  143    0    0 4856    0    0    0    0    0    0]
 [   5    0    0    0 4990    0    0    5    0    0    0    0    0    0]
 [   0    0    0    0 5000    0    0    0    0    0    0    0    0    0]
 [   3    0    0    0 4997    0    0    0    0    0    0    0    0    0]
 [   1    0    0    0 4999    0    0    0    0    0    0    0    0    0]
 [   0    0    0    0 5000    0    0    0    0    0    0    0    0    0]
 [   2 4536    0    0  462    0    0    0    0    0    0    0    0    0]
 [   0    5    0    0 4995    0    0    0    0    0    0    0    0    0]
 [4691    3   52    0  253    0    0    1    0    0    0    0    0    0]
 [  30    0    0    0 4970    0    0    0    0    0    0    0    0    0]
 [4749    2    0    0  246    0    0    3    0    0    0    0    0    0]]
Figure(640x480)
[[   0    0   48    9    0  200    0    0    0    0 4743    0    0    0]
 [   0    0   40    2    0   46    0    0    0    0 4912    0    0    0]
 [   0    0  101  201    0  104    0    0    0    0 4594    0    0    0]
 [   0    0 4949   40    0    1    0    0    0    0   10    0    0    0]
 [   0    0 4840   86    0   19    0    0    0    0   55    0    0    0]
 [   0    0    6    5    0 4956    0    0    0    0   33    0    0    0]
 [   0    0   52    3    0 4872    0    0    0    0   73    0    0    0]
 [   0    0 4970    5    0   25    0    0    0    0    0    0    0    0]
 [   0    0 4983    0    0   15    0    0    0    0    2    0    0    0]
 [   0    0  410   13    0    5    0    0    0    0 4572    0    0    0]
 [   0    0 4981    0    0    5    0    0    0    0   14    0    0    0]
 [   0    0   54  151    0 4766    0    0    0    0   29    0    0    0]
 [   0    0 4931    8    0   41    0    0    0    0   20    0    0    0]
 [   0    0  209   18    0 4690    0    0    0    0   83    0    0    0]]
Figure(640x480)
[[   0    0    0    9    0  101  194 4696    0    0    0    0    0    0]
 [   0    0    0    0    0    6 4965   29    0    0    0    0    0    0]
 [   0    0    0    1    0  262 4677   58    2    0    0    0    0    0]
 [   0    0    0    0    0   82   43  361 4514    0    0    0    0    0]
 [   0    0    0    0    0   10  316 4669    5    0    0    0    0    0]
 [   0    0    0 1818    0 3114   31   37    0    0    0    0    0    0]
 [   0    0    0    2    0   31 4918   49    0    0    0    0    0    0]
 [   0    0    0    0    0 4803  194    3    0    0    0    0    0    0]
 [   0    0    0    0    0 1545 3453    2    0    0    0    0    0    0]
 [   0    0    0    0    0    0   64 4934    2    0    0    0    0    0]
 [   0    0    0    0    0    2   55 4768    9    0  166    0    0    0]
 [   0    0    0    0    0 4956   17   26    1    0    0    0    0    0]
 [   0    0    0    0    0   78   34 4888    0    0    0    0    0    0]
 [   0    0    0    0    0 4710   84  206    0    0    0    0    0    0]]
Figure(640x480)
[[   0    0   67    0    0    0    0    0    0   16    0    0    0 4917]
 [   0    0 4918    0    0    0    0    0    0    2    0    0    0   80]
 [   0    0   24    0    0    0    0    0    0 4522    0    0    0  454]
 [   0    0    4    0    0    0    0    0    0    4    0    0    0 4992]
 [   0    0 3748    0    0    0    0    0    0   28    0    0    0 1224]
 [   0    0    3    0    0    0    0    0    0    3    0    0    0 4994]
 [   0    0 4806    0    0    0    0    0    0   67    0    0    0  127]
 [   0    0 2503    0    0    0    0    0    0 2447    0    0    0   50]
 [   0    0 4971    0    0    0    0    0    0    6    0    0    0   23]
 [   0    0   17    0    0    0    0    0    0    6    0    0    0 4977]
 [   0    0 4516    0    0    0    0    0    0  284    0    0    0  200]
 [   0    0    0    0    0    0    0    0    0   27    0    0    0 4973]
 [   0    0 1241    0    0    0    0    0    0 3625    0    0    0  134]
 [   0    0   29    0    0    0    0    0    0   31    0    0    0 4940]]
Figure(640x480)
