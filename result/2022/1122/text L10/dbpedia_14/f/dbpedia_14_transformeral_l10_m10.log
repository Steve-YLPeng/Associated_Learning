total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask9//dbpedia_14/dbpedia_14_transformeral_l10_m9.pt
Start Training
gc 9
Train Epoch0 Acc 0.9556535714285714 (535166/560000), AUC 0.9940605759620667
Test Epoch0 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch0 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch0 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch0 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch0 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch0 layer5 Acc 0.9778714285714286, AUC 0.9979328513145447
Test Epoch0 layer6 Acc 0.9779, AUC 0.9978066682815552
Test Epoch0 layer7 Acc 0.9779285714285715, AUC 0.9979664087295532
Test Epoch0 layer8 Acc 0.9780857142857143, AUC 0.9978055953979492
Test Epoch0 layer9 Acc 0.9778285714285714, AUC 0.9973346590995789
Save ckpt to ./ckpt/mask10//dbpedia_14/dbpedia_14_transformeral_l10_m10.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9841946428571429 (551149/560000), AUC 0.9984670877456665
Test Epoch1 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch1 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch1 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch1 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch1 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch1 layer5 Acc 0.9778714285714286, AUC 0.9979328513145447
Test Epoch1 layer6 Acc 0.9779, AUC 0.9978066682815552
Test Epoch1 layer7 Acc 0.9779285714285715, AUC 0.9979664087295532
Test Epoch1 layer8 Acc 0.9780857142857143, AUC 0.9978055953979492
Test Epoch1 layer9 Acc 0.9778571428571429, AUC 0.9974184036254883
Save ckpt to ./ckpt/mask10//dbpedia_14/dbpedia_14_transformeral_l10_m10.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.98415 (551124/560000), AUC 0.9986633658409119
Test Epoch2 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch2 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch2 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch2 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch2 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch2 layer5 Acc 0.9778714285714286, AUC 0.9979328513145447
Test Epoch2 layer6 Acc 0.9779, AUC 0.9978066682815552
Test Epoch2 layer7 Acc 0.9779285714285715, AUC 0.9979664087295532
Test Epoch2 layer8 Acc 0.9780857142857143, AUC 0.9978055953979492
Test Epoch2 layer9 Acc 0.9780142857142857, AUC 0.9977015852928162
Save ckpt to ./ckpt/mask10//dbpedia_14/dbpedia_14_transformeral_l10_m10.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9842 (551152/560000), AUC 0.998748242855072
Test Epoch3 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch3 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch3 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch3 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch3 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch3 layer5 Acc 0.9778714285714286, AUC 0.9979328513145447
Test Epoch3 layer6 Acc 0.9779, AUC 0.9978066682815552
Test Epoch3 layer7 Acc 0.9779285714285715, AUC 0.9979664087295532
Test Epoch3 layer8 Acc 0.9780857142857143, AUC 0.9978055953979492
Test Epoch3 layer9 Acc 0.978, AUC 0.9974938035011292
gc 0
Train Epoch4 Acc 0.9842160714285715 (551161/560000), AUC 0.9987473487854004
Test Epoch4 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch4 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch4 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch4 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch4 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch4 layer5 Acc 0.9778714285714286, AUC 0.9979328513145447
Test Epoch4 layer6 Acc 0.9779, AUC 0.9978066682815552
Test Epoch4 layer7 Acc 0.9779285714285715, AUC 0.9979664087295532
Test Epoch4 layer8 Acc 0.9780857142857143, AUC 0.9978055953979492
Test Epoch4 layer9 Acc 0.9779285714285715, AUC 0.9975715279579163
gc 0
Train Epoch5 Acc 0.9842107142857143 (551158/560000), AUC 0.9987568259239197
Test Epoch5 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch5 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch5 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch5 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch5 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch5 layer5 Acc 0.9778714285714286, AUC 0.9979328513145447
Test Epoch5 layer6 Acc 0.9779, AUC 0.9978066682815552
Test Epoch5 layer7 Acc 0.9779285714285715, AUC 0.9979664087295532
Test Epoch5 layer8 Acc 0.9780857142857143, AUC 0.9978055953979492
Test Epoch5 layer9 Acc 0.9779428571428571, AUC 0.997695803642273
gc 0
Train Epoch6 Acc 0.9842196428571428 (551163/560000), AUC 0.9987780451774597
Test Epoch6 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch6 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch6 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch6 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch6 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch6 layer5 Acc 0.9778714285714286, AUC 0.9979328513145447
Test Epoch6 layer6 Acc 0.9779, AUC 0.9978066682815552
Test Epoch6 layer7 Acc 0.9779285714285715, AUC 0.9979664087295532
Test Epoch6 layer8 Acc 0.9780857142857143, AUC 0.9978055953979492
Test Epoch6 layer9 Acc 0.9781, AUC 0.9976514577865601
gc 0
Train Epoch7 Acc 0.9841964285714285 (551150/560000), AUC 0.9987767338752747
Test Epoch7 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch7 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch7 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch7 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch7 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch7 layer5 Acc 0.9778714285714286, AUC 0.9979328513145447
Test Epoch7 layer6 Acc 0.9779, AUC 0.9978066682815552
Test Epoch7 layer7 Acc 0.9779285714285715, AUC 0.9979664087295532
Test Epoch7 layer8 Acc 0.9780857142857143, AUC 0.9978055953979492
Test Epoch7 layer9 Acc 0.9778857142857142, AUC 0.9977099299430847
Save ckpt to ./ckpt/mask10//dbpedia_14/dbpedia_14_transformeral_l10_m10.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9842553571428572 (551183/560000), AUC 0.9987544417381287
Test Epoch8 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch8 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch8 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch8 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch8 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch8 layer5 Acc 0.9778714285714286, AUC 0.9979328513145447
Test Epoch8 layer6 Acc 0.9779, AUC 0.9978066682815552
Test Epoch8 layer7 Acc 0.9779285714285715, AUC 0.9979664087295532
Test Epoch8 layer8 Acc 0.9780857142857143, AUC 0.9978055953979492
Test Epoch8 layer9 Acc 0.9779571428571429, AUC 0.9976676106452942
gc 0
Train Epoch9 Acc 0.9842392857142858 (551174/560000), AUC 0.9987823367118835
Test Epoch9 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch9 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch9 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch9 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Test Epoch9 layer4 Acc 0.9777285714285714, AUC 0.9979855418205261
Test Epoch9 layer5 Acc 0.9778714285714286, AUC 0.9979328513145447
Test Epoch9 layer6 Acc 0.9779, AUC 0.9978066682815552
Test Epoch9 layer7 Acc 0.9779285714285715, AUC 0.9979664087295532
Test Epoch9 layer8 Acc 0.9780857142857143, AUC 0.9978055953979492
Test Epoch9 layer9 Acc 0.9780142857142857, AUC 0.9976989030838013
Best AUC 0.9977099299430847
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask10//dbpedia_14/dbpedia_14_transformeral_l10_m10.pt
[[4690   45   22   14   12   71   40    8    4    6    7   20   19   42]
 [  29 4915    0    1    7    0   28    3    3    2    1    0    3    8]
 [  35   14 4612   19   58    2   11    5    5    0    1   79   20  139]
 [   2    2   26 4953   12    1    1    1    0    0    0    0    0    2]
 [   9   18   70   11 4857    9    6    3    2    1    0    0    3   11]
 [  31    1    3    3    1 4949    5    2    1    1    0    0    1    2]
 [  60   55    4    2   11   17 4792   36    9    5    1    1    4    3]
 [   0    1    0    0    2    0   13 4962   17    3    1    0    0    1]
 [   1    4    2    0    3    0   10   13 4966    1    0    0    0    0]
 [   1    0    1    2    0    0    0    6    0 4956   33    0    0    1]
 [  12    1    0    0    0    0    2    4    0   32 4949    0    0    0]
 [   6    0   40    2    0    0    1    0    0    1    1 4923   14   12]
 [   7    2   21    8    2    3    1    3    0    3    0   20 4883   47]
 [  33    7   81    8   14    3    3    9    2    4    5    6   46 4779]]
Figure(640x480)
[[4659   42   23   11   13   69   45    3    2    7    3   44   22   57]
 [  32 4904    3    2   11    1   25    1    2    1    1    0    9    8]
 [  31   13 4637   15   57    2   12    2    0    2    0   80   39  110]
 [   3    2   27 4955    9    1    1    0    0    0    0    0    0    2]
 [   6   12   69   17 4865    9    6    1    1    1    0    1    5    7]
 [  35    0    2    0    0 4949    6    2    1    1    0    1    3    0]
 [  61   43    3    3   16   15 4809   33    2    5    0    1    7    2]
 [   2    1    0    0    4    2   24 4949   10    4    2    0    1    1]
 [   1    3    4    0    6    0   16   16 4953    0    0    0    0    1]
 [   1    0    2    1    0    1    0    6    0 4963   24    0    0    2]
 [  12    2    0    0    0    1    0    2    0   36 4947    0    0    0]
 [   9    0   30    2    0    0    0    0    0    0    1 4931   16   11]
 [   5    1   15    2    0    1    0    0    0    2    0   18 4929   27]
 [  23    2   52    6   12    3    2    0    0    0    1   13   70 4816]]
Figure(640x480)
[[4718   45   28    7   14   57   43    3    3    5    3   24    9   41]
 [  32 4909    4    1   12    1   27    1    2    1    1    0    2    7]
 [  25   11 4725   10   63    1    9    1    0    2    0   45   19   89]
 [   2    2   28 4947   13    0    2    0    0    2    0    1    1    2]
 [   6   13   65   15 4870    7    7    1    1    2    0    2    1   10]
 [  43    0    3    0    0 4942    6    1    1    1    0    0    3    0]
 [  62   45    7    3   16   15 4803   29    5    5    0    1    7    2]
 [   3    1    0    0    4    0   25 4946   12    5    2    0    1    1]
 [   1    2    4    0    4    0   14   11 4963    0    0    0    0    1]
 [   1    0    2    1    0    1    0    3    0 4964   26    0    0    2]
 [  12    2    2    0    0    1    0    1    1   38 4942    0    0    1]
 [  12    0   44    2    0    0    0    0    0    0    0 4910   16   16]
 [  10    1   23    0    0    2    0    0    0    1    0   19 4908   36]
 [  32    3   70    3    8    1    2    0    0    0    1   10   47 4823]]
Figure(640x480)
[[4739   41   22    7   14   54   41    3    3    5    3   23    7   38]
 [  36 4902    4    1   11    1   31    1    1    1    1    0    2    8]
 [  28   10 4727   10   64    1   11    1    0    2    0   44   17   85]
 [   3    2   27 4948   13    0    0    1    0    2    0    1    1    2]
 [   6   12   65   14 4875    7    6    1    1    3    0    0    0   10]
 [  48    0    3    0    0 4936    7    1    1    1    0    0    3    0]
 [  65   37    9    3   16   14 4807   32    5    5    0    1    4    2]
 [   3    1    0    0    4    0   21 4950   12    5    2    0    1    1]
 [   1    3    4    0    5    0   14   11 4961    0    0    0    0    1]
 [   1    0    2    1    0    1    0    4    0 4965   24    0    0    2]
 [  13    2    2    0    0    0    0    3    1   41 4937    0    0    1]
 [  11    0   41    2    0    0    0    0    0    0    0 4915   15   16]
 [  12    2   28    0    1    1    0    0    0    1    0   20 4894   41]
 [  31    3   69    3    8    1    2    0    0    0    1   10   37 4835]]
Figure(640x480)
[[4747   39   23    7   13   54   40    5    2    5    2   21    7   35]
 [  39 4910    2    0    7    0   29    1    1    1    1    0    2    7]
 [  30    9 4740   10   63    1    6    1    0    2    0   39   19   80]
 [   3    2   25 4950   15    0    1    1    0    0    0    0    1    2]
 [   6   11   70   13 4871    7    7    0    1    4    1    1    1    7]
 [  46    0    2    0    0 4942    3    2    1    1    0    0    3    0]
 [  62   39    6    3   13   13 4815   30    7    5    0    1    3    3]
 [   2    1    0    0    3    0   24 4950   12    5    1    0    1    1]
 [   1    2    2    0    3    0   10   10 4971    0    0    0    0    1]
 [   1    0    2    1    0    1    0    4    0 4962   27    0    0    2]
 [  13    1    2    0    0    0    0    3    0   32 4949    0    0    0]
 [  11    0   49    2    0    0    0    0    0    0    0 4906   18   14]
 [  12    1   22    0    0    1    0    0    0    0    0   20 4904   40]
 [  31    2   82    3    6    1    2    0    0    0    1    8   40 4824]]
Figure(640x480)
[[4754   39   23    6   13   50   41    5    2    5    2   21    7   32]
 [  39 4910    2    0    7    0   29    1    1    1    1    0    2    7]
 [  29    9 4726   10   63    1    7    1    0    2    0   42   20   90]
 [   3    2   24 4950   14    0    2    0    0    1    0    1    1    2]
 [   6   11   65   13 4875    7    7    1    1    3    0    1    1    9]
 [  47    0    2    0    0 4940    4    2    1    1    0    0    3    0]
 [  57   38    5    3   10   13 4826   29    6    5    0    2    3    3]
 [   1    1    0    0    3    0   25 4950   12    5    1    0    1    1]
 [   1    2    2    0    4    0   10   10 4969    0    0    0    0    2]
 [   1    0    1    1    0    1    0    5    0 4962   27    0    0    2]
 [  13    1    2    0    0    0    0    3    0   32 4949    0    0    0]
 [  11    0   46    2    0    0    0    0    0    0    0 4910   17   14]
 [  12    1   20    0    0    1    0    0    0    0    0   20 4898   48]
 [  35    2   73    3    5    1    3    0    0    0    2    9   35 4832]]
Figure(640x480)
[[4748   40   25    6   13   51   42    4    2    5    2   20    8   34]
 [  39 4914    2    0    7    0   25    1    1    1    1    0    2    7]
 [  30    9 4728   11   63    1    6    1    0    2    0   41   20   88]
 [   3    2   24 4949   15    0    1    1    0    1    0    1    1    2]
 [   6   10   67   13 4876    7    7    0    1    4    0    1    0    8]
 [  43    0    2    0    0 4944    4    2    1    1    0    0    3    0]
 [  58   41    5    3   11   13 4820   30    6    5    0    2    3    3]
 [   1    1    0    0    3    0   25 4950   12    5    1    0    1    1]
 [   1    2    2    0    4    0   10   10 4969    0    0    0    0    2]
 [   1    0    1    1    0    1    0    5    0 4962   27    0    0    2]
 [  13    1    1    0    0    0    0    3    0   31 4951    0    0    0]
 [  11    0   44    2    0    0    0    0    0    0    0 4914   18   11]
 [  12    1   20    0    0    1    0    0    0    0    0   19 4904   43]
 [  37    3   72    3    7    1    3    0    0    0    1   10   39 4824]]
Figure(640x480)
[[4751   39   25    6   14   48   41    4    2    5    2   21    8   34]
 [  40 4912    3    0    7    0   25    1    1    1    1    0    2    7]
 [  30    9 4723   10   64    1    6    1    0    2    0   43   20   91]
 [   3    2   23 4949   16    0    1    1    0    1    0    1    1    2]
 [   6   10   64   13 4879    7    6    0    1    3    0    1    2    8]
 [  45    0    2    0    0 4942    4    2    1    1    0    0    3    0]
 [  59   41    5    3   12   13 4821   27    6    5    0    2    3    3]
 [   1    1    0    0    3    0   26 4949   12    5    1    0    1    1]
 [   1    2    2    0    3    0   11   10 4969    0    0    0    0    2]
 [   1    0    1    1    0    0    0    5    0 4963   27    0    0    2]
 [  13    1    2    0    0    0    0    3    0   32 4949    0    0    0]
 [  11    0   41    2    0    0    0    0    0    0    0 4918   17   11]
 [  11    1   20    0    0    1    0    0    0    0    0   20 4901   46]
 [  35    2   71    3    7    1    3    0    0    0    1   11   37 4829]]
Figure(640x480)
[[4758   40   20    6   13   45   42    4    2    5    2   21    8   34]
 [  40 4913    2    0    7    0   25    1    1    1    1    0    2    7]
 [  33    9 4713   13   67    1    6    2    0    2    0   44   20   90]
 [   3    2   22 4950   16    0    1    1    0    1    0    1    1    2]
 [   6   10   60   12 4885    7    6    0    1    4    0    1    0    8]
 [  49    0    2    0    0 4937    5    2    1    1    0    0    3    0]
 [  56   40    4    2   10   12 4828   29    6    5    0    2    3    3]
 [   1    1    0    0    3    0   26 4950   12    5    0    0    1    1]
 [   1    2    2    0    3    0   10   10 4970    0    0    0    0    2]
 [   1    0    1    1    0    0    0    5    0 4963   27    0    0    2]
 [  13    1    1    0    0    0    0    3    0   31 4951    0    0    0]
 [  11    0   41    2    0    0    0    0    0    0    0 4919   17   10]
 [  13    1   20    0    0    1    0    0    0    0    0   19 4898   48]
 [  39    2   69    3    7    1    3    0    0    0    1    9   35 4831]]
Figure(640x480)
[[4748   40   24    7   14   48   42    4    2    5    2   21    8   35]
 [  39 4912    3    0    7    0   26    1    1    1    1    0    2    7]
 [  32    9 4717   13   67    2    6    1    0    2    0   44   20   87]
 [   3    1   23 4951   16    0    1    1    0    0    0    1    1    2]
 [   6   10   62   12 4883    7    6    0    1    3    0    1    1    8]
 [  43    0    2    0    0 4942    5    3    1    1    0    0    3    0]
 [  57   40    4    1   12   13 4824   30    6    5    0    2    3    3]
 [   1    1    0    0    3    0   25 4950   12    5    1    0    1    1]
 [   1    2    2    0    3    0   10   10 4970    0    0    0    0    2]
 [   1    0    1    1    0    0    0    5    0 4964   26    0    0    2]
 [  13    1    1    0    0    0    0    3    0   33 4949    0    0    0]
 [  12    0   41    2    0    0    0    0    0    0    0 4919   17    9]
 [  12    1   20    0    0    1    0    0    0    0    0   20 4898   48]
 [  37    2   74    3    7    1    3    0    0    0    1   11   36 4825]]
Figure(640x480)
