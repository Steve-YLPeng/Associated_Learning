total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask1//ag_news/ag_news_transformeral_l5_m1_prefix.pt
Start Training
gc 9
[[319.63116461  16.87377868]
 [  2.92666402  31.78984293]
 [214.63214177 585.41178071]
 [178.84228407 492.86811575]
 [147.84559579 450.63312623]]
Train Epoch0 Acc 0.16825833333333334 (20191/120000), AUC 0.3565897047519684
Test Epoch0 layer0 Acc 0.9142105263157895, AUC 0.9813633561134338
Save ckpt to ./ckpt/mask2//ag_news/ag_news_transformeral_l5_m2_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.915, AUC 0.980443000793457
Test Epoch0 layer2 Acc 0.09618421052631579, AUC 0.41395488381385803
Test Epoch0 layer3 Acc 0.46828947368421053, AUC 0.7669624090194702
Test Epoch0 layer4 Acc 0.18144736842105263, AUC 0.32637283205986023
gc 0
[[3.19626435e+02 1.85626307e+01]
 [3.50772696e-07 1.70598188e+01]
 [2.34886999e+02 5.89356533e+02]
 [1.92767660e+02 4.93939652e+02]
 [1.55608826e+02 4.62833031e+02]]
Train Epoch1 Acc 0.12689166666666668 (15227/120000), AUC 0.3048214316368103
Test Epoch1 layer0 Acc 0.9135526315789474, AUC 0.9812746047973633
Test Epoch1 layer1 Acc 0.9147368421052632, AUC 0.9808091521263123
Test Epoch1 layer2 Acc 0.03263157894736842, AUC 0.3588753342628479
Test Epoch1 layer3 Acc 0.48605263157894735, AUC 0.7379448413848877
Test Epoch1 layer4 Acc 0.041973684210526316, AUC 0.3204686641693115
gc 0
[[3.19626248e+02 1.90637414e+01]
 [4.70757472e-08 1.40564677e+01]
 [2.43513706e+02 5.85913497e+02]
 [1.98350346e+02 4.93749174e+02]
 [1.58563574e+02 4.70249061e+02]]
Train Epoch2 Acc 0.03269166666666667 (3923/120000), AUC 0.30222684144973755
Test Epoch2 layer0 Acc 0.915, AUC 0.9807644486427307
Test Epoch2 layer1 Acc 0.9163157894736842, AUC 0.9798800349235535
Test Epoch2 layer2 Acc 0.023289473684210527, AUC 0.336355596780777
Test Epoch2 layer3 Acc 0.49315789473684213, AUC 0.7260112166404724
Test Epoch2 layer4 Acc 0.04697368421052631, AUC 0.30450963973999023
gc 0
[[3.19626248e+02 1.93953035e+01]
 [7.22184134e-08 1.22541120e+01]
 [2.49589117e+02 5.82243707e+02]
 [2.02280002e+02 4.93760800e+02]
 [1.60650850e+02 4.77415971e+02]]
Train Epoch3 Acc 0.028108333333333332 (3373/120000), AUC 0.2784850299358368
Test Epoch3 layer0 Acc 0.9130263157894737, AUC 0.9804555177688599
Test Epoch3 layer1 Acc 0.9147368421052632, AUC 0.9794069528579712
Test Epoch3 layer2 Acc 0.031710526315789474, AUC 0.32848480343818665
Test Epoch3 layer3 Acc 0.4986842105263158, AUC 0.6661401391029358
Test Epoch3 layer4 Acc 0.04776315789473684, AUC 0.28199657797813416
gc 0
[[3.19626248e+02 1.92985072e+01]
 [1.17759815e-04 1.11022773e+01]
 [2.53475648e+02 5.78157066e+02]
 [2.04556145e+02 4.94026455e+02]
 [1.62182639e+02 4.82139762e+02]]
Train Epoch4 Acc 0.029175 (3501/120000), AUC 0.2663964033126831
Test Epoch4 layer0 Acc 0.9118421052631579, AUC 0.9802250862121582
Test Epoch4 layer1 Acc 0.9152631578947369, AUC 0.9782263040542603
Test Epoch4 layer2 Acc 0.05026315789473684, AUC 0.3303304612636566
Test Epoch4 layer3 Acc 0.4971052631578947, AUC 0.5924220681190491
Test Epoch4 layer4 Acc 0.05092105263157895, AUC 0.28359824419021606
gc 0
[[3.19626248e+02 1.82057741e+01]
 [6.46380032e-04 9.73568378e+00]
 [2.53273662e+02 5.71456127e+02]
 [2.04468396e+02 4.93413130e+02]
 [1.62100786e+02 4.84615543e+02]]
Train Epoch5 Acc 0.029791666666666668 (3575/120000), AUC 0.2610248327255249
Test Epoch5 layer0 Acc 0.9117105263157895, AUC 0.9801900386810303
Test Epoch5 layer1 Acc 0.9113157894736842, AUC 0.977178692817688
Test Epoch5 layer2 Acc 0.10644736842105264, AUC 0.34799766540527344
Test Epoch5 layer3 Acc 0.4946052631578947, AUC 0.5471773147583008
Test Epoch5 layer4 Acc 0.053421052631578946, AUC 0.28176677227020264
gc 0
[[3.19626248e+02 1.80740977e+01]
 [5.91215981e-07 9.07053723e+00]
 [2.52965334e+02 5.65836219e+02]
 [2.04336352e+02 4.93366221e+02]
 [1.61999109e+02 4.86566620e+02]]
Train Epoch6 Acc 0.031108333333333335 (3733/120000), AUC 0.2582695484161377
Test Epoch6 layer0 Acc 0.9121052631578948, AUC 0.9798005223274231
Test Epoch6 layer1 Acc 0.910921052631579, AUC 0.976137638092041
Test Epoch6 layer2 Acc 0.15289473684210525, AUC 0.36821088194847107
Test Epoch6 layer3 Acc 0.4680263157894737, AUC 0.5172473192214966
Test Epoch6 layer4 Acc 0.05460526315789474, AUC 0.29048606753349304
gc 0
[[3.19626248e+02 1.80005380e+01]
 [1.08368630e-04 8.70761996e+00]
 [2.52939657e+02 5.61769722e+02]
 [2.04323203e+02 4.93911484e+02]
 [1.61986116e+02 4.87911821e+02]]
Train Epoch7 Acc 0.03065 (3678/120000), AUC 0.25676923990249634
Test Epoch7 layer0 Acc 0.9107894736842105, AUC 0.9794689416885376
Test Epoch7 layer1 Acc 0.9105263157894737, AUC 0.9752532243728638
Test Epoch7 layer2 Acc 0.18881578947368421, AUC 0.3842950463294983
Test Epoch7 layer3 Acc 0.41289473684210526, AUC 0.4920257031917572
Test Epoch7 layer4 Acc 0.057105263157894735, AUC 0.2824287414550781
gc 0
[[3.19626248e+02 1.79255326e+01]
 [3.67710737e-04 8.41070759e+00]
 [2.52674531e+02 5.57551529e+02]
 [2.04204808e+02 4.94486959e+02]
 [1.61894406e+02 4.89498174e+02]]
Train Epoch8 Acc 0.030558333333333333 (3667/120000), AUC 0.25281333923339844
Test Epoch8 layer0 Acc 0.9110526315789473, AUC 0.9795693159103394
Test Epoch8 layer1 Acc 0.9105263157894737, AUC 0.9756351113319397
Test Epoch8 layer2 Acc 0.2061842105263158, AUC 0.39816945791244507
Test Epoch8 layer3 Acc 0.32539473684210524, AUC 0.4632940888404846
Test Epoch8 layer4 Acc 0.0525, AUC 0.2838065028190613
gc 0
[[3.19626248e+02 1.73593837e+01]
 [3.19312134e-04 7.82895876e+00]
 [2.52273241e+02 5.53181053e+02]
 [2.04013964e+02 4.95175356e+02]
 [1.61750155e+02 4.91141695e+02]]
Train Epoch9 Acc 0.028983333333333333 (3478/120000), AUC 0.2497871369123459
Test Epoch9 layer0 Acc 0.9113157894736842, AUC 0.9792283773422241
Test Epoch9 layer1 Acc 0.9088157894736842, AUC 0.9747816324234009
Test Epoch9 layer2 Acc 0.2175, AUC 0.4272097945213318
Test Epoch9 layer3 Acc 0.23671052631578948, AUC 0.4314536452293396
Test Epoch9 layer4 Acc 0.05092105263157895, AUC 0.285058856010437
Best AUC 0.9813633561134338
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//ag_news/ag_news_transformeral_l5_m2_prefix.pt
[[1707   59   89   45]
 [  16 1864    9   11]
 [  47   19 1666  168]
 [  48   14  127 1711]]
Figure(640x480)
[[1707   63   81   49]
 [  11 1869   10   10]
 [  45   22 1651  182]
 [  42   17  114 1727]]
Figure(640x480)
[[  63  533    5 1299]
 [   1    1    0 1898]
 [ 752    9   12 1127]
 [1179   66    0  655]]
Figure(640x480)
[[   1 1848    0   51]
 [   0 1898    0    2]
 [   0 1742    0  158]
 [   0  240    0 1660]]
Figure(640x480)
[[   0 1851   49    0]
 [   0 1273  627    0]
 [   0 1794  106    0]
 [   0  519 1381    0]]
Figure(640x480)
