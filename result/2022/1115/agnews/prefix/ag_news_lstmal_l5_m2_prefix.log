total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask1//ag_news/ag_news_lstmal_l5_m1_prefix.pt
Start Training
gc 9
[[319.63093266  16.21638977]
 [ 15.76269431  24.83370351]
 [267.41418093 152.24117139]
 [200.89941049 102.62542658]
 [183.17121115  86.91395387]]
Train Epoch0 Acc 0.10719166666666667 (12863/120000), AUC 0.2464742362499237
Test Epoch0 layer0 Acc 0.9147368421052632, AUC 0.9816327095031738
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9132894736842105, AUC 0.9827778339385986
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.34078947368421053, AUC 0.6424831748008728
Test Epoch0 layer3 Acc 0.22302631578947368, AUC 0.14610818028450012
Test Epoch0 layer4 Acc 0.03328947368421053, AUC 0.20059874653816223
gc 0
[[3.19626424e+02 1.79047510e+01]
 [3.31645803e-05 1.44611275e+01]
 [3.00815719e+02 1.70167545e+02]
 [2.20892438e+02 1.10811450e+02]
 [1.98372454e+02 9.31781847e+01]]
Train Epoch1 Acc 0.013566666666666666 (1628/120000), AUC 0.18089750409126282
Test Epoch1 layer0 Acc 0.9144736842105263, AUC 0.9810110926628113
Test Epoch1 layer1 Acc 0.9138157894736842, AUC 0.9828226566314697
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2_prefix.pt  ,ep 1
Test Epoch1 layer2 Acc 0.38513157894736844, AUC 0.6602557897567749
Test Epoch1 layer3 Acc 0.24144736842105263, AUC 0.1580480933189392
Test Epoch1 layer4 Acc 0.012105263157894737, AUC 0.18794190883636475
gc 0
[[3.19626248e+02 1.84080200e+01]
 [4.01479457e-06 1.33747613e+01]
 [3.09336883e+02 1.74187176e+02]
 [2.25538037e+02 1.11809134e+02]
 [2.01923310e+02 9.47077264e+01]]
Train Epoch2 Acc 0.007991666666666666 (959/120000), AUC 0.16141968965530396
Test Epoch2 layer0 Acc 0.9136842105263158, AUC 0.9808714389801025
Test Epoch2 layer1 Acc 0.9126315789473685, AUC 0.9827914834022522
Test Epoch2 layer2 Acc 0.3751315789473684, AUC 0.6684167981147766
Test Epoch2 layer3 Acc 0.24526315789473685, AUC 0.15351295471191406
Test Epoch2 layer4 Acc 0.01631578947368421, AUC 0.1663447469472885
gc 0
[[3.19626248e+02 1.87431874e+01]
 [9.67740418e-07 1.27147634e+01]
 [3.15497920e+02 1.76943213e+02]
 [2.29055492e+02 1.12486599e+02]
 [2.04591742e+02 9.59049627e+01]]
Train Epoch3 Acc 0.00625 (750/120000), AUC 0.14675989747047424
Test Epoch3 layer0 Acc 0.9117105263157895, AUC 0.9806050062179565
Test Epoch3 layer1 Acc 0.9105263157894737, AUC 0.9820365905761719
Test Epoch3 layer2 Acc 0.3726315789473684, AUC 0.6698880195617676
Test Epoch3 layer3 Acc 0.24828947368421053, AUC 0.1545906960964203
Test Epoch3 layer4 Acc 0.012763157894736843, AUC 0.1575511395931244
gc 0
[[3.19626248e+02 1.86431292e+01]
 [1.55161843e-08 1.20737975e+01]
 [3.18642635e+02 1.78899800e+02]
 [2.31207517e+02 1.12915429e+02]
 [2.05944779e+02 9.66814582e+01]]
Train Epoch4 Acc 0.005216666666666666 (626/120000), AUC 0.13292264938354492
Test Epoch4 layer0 Acc 0.9122368421052631, AUC 0.9802807569503784
Test Epoch4 layer1 Acc 0.9105263157894737, AUC 0.9814940094947815
Test Epoch4 layer2 Acc 0.3531578947368421, AUC 0.6752798557281494
Test Epoch4 layer3 Acc 0.24907894736842107, AUC 0.14829261600971222
Test Epoch4 layer4 Acc 0.011447368421052631, AUC 0.1421000063419342
gc 0
[[3.19626248e+02 1.75809337e+01]
 [1.06559769e-12 1.07510512e+01]
 [3.18644712e+02 1.79676379e+02]
 [2.31210675e+02 1.12785453e+02]
 [2.05944591e+02 9.69016521e+01]]
Train Epoch5 Acc 0.004216666666666666 (506/120000), AUC 0.12123620510101318
Test Epoch5 layer0 Acc 0.911578947368421, AUC 0.9799004793167114
Test Epoch5 layer1 Acc 0.9102631578947369, AUC 0.981465756893158
Test Epoch5 layer2 Acc 0.34328947368421053, AUC 0.6719682216644287
Test Epoch5 layer3 Acc 0.24973684210526315, AUC 0.14102597534656525
Test Epoch5 layer4 Acc 0.012763157894736843, AUC 0.14018979668617249
gc 0
[[3.19626248e+02 1.74649447e+01]
 [1.35723277e-12 1.03873683e+01]
 [3.18644383e+02 1.80189541e+02]
 [2.31211021e+02 1.12751171e+02]
 [2.05945413e+02 9.69436443e+01]]
Train Epoch6 Acc 0.0039833333333333335 (478/120000), AUC 0.11515271663665771
Test Epoch6 layer0 Acc 0.9105263157894737, AUC 0.9797033071517944
Test Epoch6 layer1 Acc 0.9092105263157895, AUC 0.9813244342803955
Test Epoch6 layer2 Acc 0.3438157894736842, AUC 0.6729578971862793
Test Epoch6 layer3 Acc 0.2503947368421053, AUC 0.13857769966125488
Test Epoch6 layer4 Acc 0.012236842105263157, AUC 0.13537341356277466
gc 0
[[3.19626248e+02 1.73806764e+01]
 [1.92864670e-12 1.00866352e+01]
 [3.18643553e+02 1.80731679e+02]
 [2.31210653e+02 1.12851538e+02]
 [2.05944007e+02 9.70289144e+01]]
Train Epoch7 Acc 0.0038166666666666666 (458/120000), AUC 0.11083868145942688
Test Epoch7 layer0 Acc 0.9125, AUC 0.9793874025344849
Test Epoch7 layer1 Acc 0.9064473684210527, AUC 0.9809023141860962
Test Epoch7 layer2 Acc 0.3356578947368421, AUC 0.6703052520751953
Test Epoch7 layer3 Acc 0.2505263157894737, AUC 0.13522283732891083
Test Epoch7 layer4 Acc 0.013552631578947368, AUC 0.13216513395309448
gc 0
[[3.19626248e+02 1.73243490e+01]
 [3.28882996e-12 9.82116730e+00]
 [3.18647287e+02 1.80962263e+02]
 [2.31212115e+02 1.12964779e+02]
 [2.05948438e+02 9.70355383e+01]]
Train Epoch8 Acc 0.0037833333333333334 (454/120000), AUC 0.10643166303634644
Test Epoch8 layer0 Acc 0.91, AUC 0.9794692993164062
Test Epoch8 layer1 Acc 0.9072368421052631, AUC 0.9812355637550354
Test Epoch8 layer2 Acc 0.32539473684210524, AUC 0.669898271560669
Test Epoch8 layer3 Acc 0.2507894736842105, AUC 0.14356569945812225
Test Epoch8 layer4 Acc 0.012763157894736843, AUC 0.1305040419101715
gc 0
[[3.19626248e+02 1.67699818e+01]
 [2.47130523e-12 9.17298550e+00]
 [3.18642959e+02 1.81457505e+02]
 [2.31210399e+02 1.13171466e+02]
 [2.05947234e+02 9.70708735e+01]]
Train Epoch9 Acc 0.003275 (393/120000), AUC 0.10200302302837372
Test Epoch9 layer0 Acc 0.9102631578947369, AUC 0.9791394472122192
Test Epoch9 layer1 Acc 0.9053947368421053, AUC 0.9800432920455933
Test Epoch9 layer2 Acc 0.3281578947368421, AUC 0.6715356111526489
Test Epoch9 layer3 Acc 0.2513157894736842, AUC 0.13813656568527222
Test Epoch9 layer4 Acc 0.01263157894736842, AUC 0.1289088875055313
Best AUC 0.9828226566314697
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2_prefix.pt
[[1700   63   91   46]
 [  13 1868    8   11]
 [  44   19 1678  159]
 [  45   14  137 1704]]
Figure(640x480)
[[1703   63   77   57]
 [  13 1864   10   13]
 [  48   21 1652  179]
 [  43   15  116 1726]]
Figure(640x480)
[[   0  151    0 1749]
 [   0 1639    0  261]
 [   0 1607    5  288]
 [   0  617    0 1283]]
Figure(640x480)
[[   5  488    0 1407]
 [   2 1815    0   83]
 [  27 1856    0   17]
 [ 473 1412    0   15]]
Figure(640x480)
[[   0 1849   49    2]
 [   0   77 1822    1]
 [   0 1883   15    2]
 [   0 1885   15    0]]
Figure(640x480)
