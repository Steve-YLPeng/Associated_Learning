total count words 102019
vocab size 30000
found 26754 words in glove
Start Training
gc 0
[[372.86310366  11.85908319]
 [210.66850583 147.76183985]
 [173.31584203  91.64574214]
 [122.86351046  69.27071971]
 [141.20560317  67.70487064]]
Train Epoch0 Acc 0.246725 (29607/120000), AUC 0.503961980342865
Test Epoch0 layer0 Acc 0.9118421052631579, AUC 0.9801306128501892
Save ckpt to ./ckpt/mask1//ag_news/ag_news_lstmal_l5_m1_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.28092105263157896, AUC 0.5486228466033936
Test Epoch0 layer2 Acc 0.2593421052631579, AUC 0.5057322382926941
Test Epoch0 layer3 Acc 0.21973684210526315, AUC 0.43214407563209534
Test Epoch0 layer4 Acc 0.2413157894736842, AUC 0.5050956606864929
gc 0
[[320.48102722  10.62357277]
 [221.41101016 155.54230228]
 [185.00800751  99.30345014]
 [134.24822484  72.43306128]
 [144.1137394   69.08171631]]
Train Epoch1 Acc 0.2397 (28764/120000), AUC 0.5004788637161255
Test Epoch1 layer0 Acc 0.9157894736842105, AUC 0.9812921285629272
Save ckpt to ./ckpt/mask1//ag_news/ag_news_lstmal_l5_m1_prefix.pt  ,ep 1
Test Epoch1 layer1 Acc 0.28171052631578947, AUC 0.5493115186691284
Test Epoch1 layer2 Acc 0.2625, AUC 0.5074644088745117
Test Epoch1 layer3 Acc 0.22421052631578947, AUC 0.4302864968776703
Test Epoch1 layer4 Acc 0.2348684210526316, AUC 0.5027596950531006
gc 0
[[319.88859403  11.06960497]
 [229.19662781 159.17232436]
 [192.00349548 102.67178632]
 [140.18428449  74.31684947]
 [146.41099189  70.21662739]]
Train Epoch2 Acc 0.23720833333333333 (28465/120000), AUC 0.4992213249206543
Test Epoch2 layer0 Acc 0.9142105263157895, AUC 0.9815456867218018
Save ckpt to ./ckpt/mask1//ag_news/ag_news_lstmal_l5_m1_prefix.pt  ,ep 2
Test Epoch2 layer1 Acc 0.2819736842105263, AUC 0.5494301915168762
Test Epoch2 layer2 Acc 0.26276315789473687, AUC 0.5082223415374756
Test Epoch2 layer3 Acc 0.22539473684210526, AUC 0.43010464310646057
Test Epoch2 layer4 Acc 0.23236842105263159, AUC 0.5013977289199829
gc 0
[[319.74027002  11.49585394]
 [235.44972299 161.59826483]
 [197.34090085 104.96478762]
 [144.63010761  75.75633058]
 [148.28998494  71.14177766]]
Train Epoch3 Acc 0.23494166666666666 (28193/120000), AUC 0.49751773476600647
Test Epoch3 layer0 Acc 0.9152631578947369, AUC 0.9814949035644531
Test Epoch3 layer1 Acc 0.2818421052631579, AUC 0.5497873425483704
Test Epoch3 layer2 Acc 0.2636842105263158, AUC 0.5097544193267822
Test Epoch3 layer3 Acc 0.22723684210526315, AUC 0.4295021593570709
Test Epoch3 layer4 Acc 0.23328947368421052, AUC 0.5000610947608948
gc 0
[[319.68336937  11.93361409]
 [240.97340614 163.49656671]
 [201.91604069 106.79959148]
 [148.40157814  76.98582923]
 [149.96988048  71.95399589]]
Train Epoch4 Acc 0.23323333333333332 (27988/120000), AUC 0.4970638155937195
Test Epoch4 layer0 Acc 0.9117105263157895, AUC 0.9809488654136658
Test Epoch4 layer1 Acc 0.28171052631578947, AUC 0.5501263737678528
Test Epoch4 layer2 Acc 0.26460526315789473, AUC 0.5111470222473145
Test Epoch4 layer3 Acc 0.22697368421052633, AUC 0.4282129406929016
Test Epoch4 layer4 Acc 0.22842105263157894, AUC 0.4989575743675232
gc 0
[[319.65702856  12.35386148]
 [246.0956372  165.14517501]
 [206.04700117 108.34954742]
 [151.79084022  78.10605884]
 [151.52440037  72.69584555]]
Train Epoch5 Acc 0.23105 (27726/120000), AUC 0.49599552154541016
Test Epoch5 layer0 Acc 0.915, AUC 0.9806759357452393
Test Epoch5 layer1 Acc 0.2811842105263158, AUC 0.5501421689987183
Test Epoch5 layer2 Acc 0.26552631578947367, AUC 0.5124984979629517
Test Epoch5 layer3 Acc 0.22447368421052633, AUC 0.42650726437568665
Test Epoch5 layer4 Acc 0.22697368421052633, AUC 0.4973646402359009
gc 0
[[319.64354703  12.76015298]
 [251.00102195 166.74753159]
 [209.94127706 109.8201986 ]
 [154.96157932  79.1984748 ]
 [153.02733131  73.41623141]]
Train Epoch6 Acc 0.22941666666666666 (27530/120000), AUC 0.49421006441116333
Test Epoch6 layer0 Acc 0.9121052631578948, AUC 0.9806768298149109
Test Epoch6 layer1 Acc 0.2805263157894737, AUC 0.5509966611862183
Test Epoch6 layer2 Acc 0.2669736842105263, AUC 0.5136056542396545
Test Epoch6 layer3 Acc 0.2236842105263158, AUC 0.4254595935344696
Test Epoch6 layer4 Acc 0.22460526315789472, AUC 0.49613624811172485
gc 0
[[319.63744885  12.41832127]
 [254.68290171 168.10308264]
 [212.82243782 110.94333573]
 [157.29687448  79.99318118]
 [154.15371184  73.95912901]]
Train Epoch7 Acc 0.2287 (27444/120000), AUC 0.4936590790748596
Test Epoch7 layer0 Acc 0.9126315789473685, AUC 0.9805538058280945
Test Epoch7 layer1 Acc 0.2805263157894737, AUC 0.5504269003868103
Test Epoch7 layer2 Acc 0.2685526315789474, AUC 0.514195442199707
Test Epoch7 layer3 Acc 0.2231578947368421, AUC 0.4259977638721466
Test Epoch7 layer4 Acc 0.22605263157894737, AUC 0.49563831090927124
gc 0
[[319.63430968  12.64517016]
 [257.57275802 169.34788926]
 [215.047343   111.90092167]
 [159.10302275  80.65145119]
 [155.032206    74.38100918]]
Train Epoch8 Acc 0.22785833333333333 (27343/120000), AUC 0.49383336305618286
Test Epoch8 layer0 Acc 0.911578947368421, AUC 0.9804115891456604
Test Epoch8 layer1 Acc 0.2806578947368421, AUC 0.5502251982688904
Test Epoch8 layer2 Acc 0.26973684210526316, AUC 0.5146323442459106
Test Epoch8 layer3 Acc 0.22394736842105264, AUC 0.4265981614589691
Test Epoch8 layer4 Acc 0.2256578947368421, AUC 0.4953592121601105
gc 0
[[319.63177747  12.94059942]
 [260.92006421 170.77635586]
 [217.61168657 113.00573751]
 [161.17023982  81.39910156]
 [156.05604322  74.87018166]]
Train Epoch9 Acc 0.22774166666666668 (27329/120000), AUC 0.49324434995651245
Test Epoch9 layer0 Acc 0.910921052631579, AUC 0.9801510572433472
Test Epoch9 layer1 Acc 0.28171052631578947, AUC 0.5499497652053833
Test Epoch9 layer2 Acc 0.2706578947368421, AUC 0.515311598777771
Test Epoch9 layer3 Acc 0.22276315789473683, AUC 0.4271857738494873
Test Epoch9 layer4 Acc 0.22447368421052633, AUC 0.49525928497314453
Best AUC 0.9815456867218018
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//ag_news/ag_news_lstmal_l5_m1_prefix.pt
[[1704   56   89   51]
 [  16 1862    9   13]
 [  46   15 1678  161]
 [  52   15  129 1704]]
Figure(640x480)
[[ 426 1125   56  293]
 [ 342 1260   41  257]
 [ 302 1374   29  195]
 [ 350 1099   23  428]]
Figure(640x480)
[[   0 1543   51  306]
 [   4 1246  166  484]
 [   0 1167  137  596]
 [   0 1218   68  614]]
Figure(640x480)
[[   3  489    0 1408]
 [  12  684    0 1204]
 [  11 1053    0  836]
 [  12  862    0 1026]]
Figure(640x480)
[[   2  915    0  983]
 [   0 1264    0  636]
 [   1 1466    0  433]
 [   1 1399    0  500]]
Figure(640x480)
