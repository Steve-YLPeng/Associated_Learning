total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask4//ag_news/ag_news_linearal_l5_m4_prefix.pt
Start Training
gc 9
[[3.19626248e+02 1.86476442e+01]
 [1.34429518e-04 1.59205173e+01]
 [2.94051702e-04 1.26547646e+01]
 [5.45094462e-04 1.10231575e+01]
 [2.26252257e+01 1.84664597e+01]]
Train Epoch0 Acc 0.9144 (109728/120000), AUC 0.9838457107543945
Test Epoch0 layer0 Acc 0.9114473684210527, AUC 0.9796452522277832
Save ckpt to ./ckpt/mask5//ag_news/ag_news_linearal_l5_m5_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9110526315789473, AUC 0.979830265045166
Save ckpt to ./ckpt/mask5//ag_news/ag_news_linearal_l5_m5_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9119736842105263, AUC 0.9806395769119263
Save ckpt to ./ckpt/mask5//ag_news/ag_news_linearal_l5_m5_prefix.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9127631578947368, AUC 0.9782546758651733
Test Epoch0 layer4 Acc 0.9118421052631579, AUC 0.9803084135055542
gc 0
[[3.19626248e+02 1.85564395e+01]
 [5.17943679e-05 1.57224291e+01]
 [1.22435603e-04 1.21256217e+01]
 [2.25226302e-04 1.04944649e+01]
 [7.19583725e-05 1.09097858e+01]]
Train Epoch1 Acc 0.9513083333333333 (114157/120000), AUC 0.9936951994895935
Test Epoch1 layer0 Acc 0.9107894736842105, AUC 0.9796192646026611
Test Epoch1 layer1 Acc 0.9114473684210527, AUC 0.9796253442764282
Test Epoch1 layer2 Acc 0.9122368421052631, AUC 0.9799222946166992
Test Epoch1 layer3 Acc 0.9131578947368421, AUC 0.9785406589508057
Test Epoch1 layer4 Acc 0.9125, AUC 0.9796866774559021
gc 0
[[3.19626248e+02 1.84522437e+01]
 [6.50358818e-05 1.54977794e+01]
 [1.67089292e-04 1.15612133e+01]
 [3.43214067e-04 1.01363364e+01]
 [1.08935046e-04 1.01756071e+01]]
Train Epoch2 Acc 0.9526083333333333 (114313/120000), AUC 0.9934682846069336
Test Epoch2 layer0 Acc 0.9093421052631578, AUC 0.9791297316551208
Test Epoch2 layer1 Acc 0.9090789473684211, AUC 0.9794532060623169
Test Epoch2 layer2 Acc 0.9103947368421053, AUC 0.9790309071540833
Test Epoch2 layer3 Acc 0.9106578947368421, AUC 0.9768245816230774
Test Epoch2 layer4 Acc 0.9107894736842105, AUC 0.9771028161048889
gc 0
[[3.19626248e+02 1.83760283e+01]
 [6.40398286e-05 1.52817615e+01]
 [1.27749849e-04 1.10496168e+01]
 [2.09499880e-04 9.91108415e+00]
 [6.94206956e-05 9.87127580e+00]]
Train Epoch3 Acc 0.9526333333333333 (114316/120000), AUC 0.9935730695724487
Test Epoch3 layer0 Acc 0.9094736842105263, AUC 0.9793097972869873
Test Epoch3 layer1 Acc 0.9102631578947369, AUC 0.9796931147575378
Test Epoch3 layer2 Acc 0.910921052631579, AUC 0.9795641899108887
Test Epoch3 layer3 Acc 0.9114473684210527, AUC 0.9777753949165344
Test Epoch3 layer4 Acc 0.9113157894736842, AUC 0.9780694246292114
gc 0
[[3.19626248e+02 1.83122361e+01]
 [7.95506661e-05 1.50529249e+01]
 [1.95429954e-04 1.06216291e+01]
 [3.74397829e-04 9.75542143e+00]
 [1.23789789e-04 9.68708801e+00]]
Train Epoch4 Acc 0.9533416666666666 (114401/120000), AUC 0.9937267303466797
Test Epoch4 layer0 Acc 0.910921052631579, AUC 0.9793437123298645
Test Epoch4 layer1 Acc 0.9103947368421053, AUC 0.9797580242156982
Test Epoch4 layer2 Acc 0.9111842105263158, AUC 0.9793874025344849
Test Epoch4 layer3 Acc 0.911578947368421, AUC 0.9789708256721497
Test Epoch4 layer4 Acc 0.910921052631579, AUC 0.9793080687522888
gc 0
[[3.19626248e+02 1.74542387e+01]
 [5.84219294e-08 1.42112361e+01]
 [1.27598917e-07 9.72698363e+00]
 [1.28329506e-06 9.06514288e+00]
 [3.39440757e-07 8.91282188e+00]]
Train Epoch5 Acc 0.9554833333333334 (114658/120000), AUC 0.9945353269577026
Test Epoch5 layer0 Acc 0.9085526315789474, AUC 0.9790374040603638
Test Epoch5 layer1 Acc 0.9103947368421053, AUC 0.9794318675994873
Test Epoch5 layer2 Acc 0.9096052631578947, AUC 0.9790685176849365
Test Epoch5 layer3 Acc 0.9111842105263158, AUC 0.9775909185409546
Test Epoch5 layer4 Acc 0.91, AUC 0.9780627489089966
gc 0
[[3.19626248e+02 1.73985162e+01]
 [7.39316558e-06 1.40895341e+01]
 [1.43265864e-05 9.57486230e+00]
 [1.54893318e-04 8.97041009e+00]
 [4.26370633e-05 8.82745142e+00]]
Train Epoch6 Acc 0.9560333333333333 (114724/120000), AUC 0.9945216178894043
Test Epoch6 layer0 Acc 0.9089473684210526, AUC 0.9787519574165344
Test Epoch6 layer1 Acc 0.908157894736842, AUC 0.9794120788574219
Test Epoch6 layer2 Acc 0.9097368421052632, AUC 0.978611946105957
Test Epoch6 layer3 Acc 0.9094736842105263, AUC 0.9778871536254883
Test Epoch6 layer4 Acc 0.9093421052631578, AUC 0.9778341054916382
gc 0
[[3.19626248e+02 1.73726700e+01]
 [1.69214312e-05 1.39643402e+01]
 [3.85327288e-05 9.42671513e+00]
 [1.94590176e-04 8.86439731e+00]
 [5.88199867e-05 8.73090361e+00]]
Train Epoch7 Acc 0.9564166666666667 (114770/120000), AUC 0.9946918487548828
Test Epoch7 layer0 Acc 0.9090789473684211, AUC 0.9786766767501831
Test Epoch7 layer1 Acc 0.9092105263157895, AUC 0.9793182015419006
Test Epoch7 layer2 Acc 0.9097368421052632, AUC 0.9779131412506104
Test Epoch7 layer3 Acc 0.9098684210526315, AUC 0.9772777557373047
Test Epoch7 layer4 Acc 0.9097368421052632, AUC 0.9774619936943054
gc 0
[[3.19626248e+02 1.73350849e+01]
 [1.71313103e-05 1.38403880e+01]
 [3.72884798e-05 9.30555488e+00]
 [1.89334366e-04 8.79357744e+00]
 [6.69235992e-05 8.66283167e+00]]
Train Epoch8 Acc 0.9565583333333333 (114787/120000), AUC 0.9946970343589783
Test Epoch8 layer0 Acc 0.9077631578947368, AUC 0.9786518812179565
Test Epoch8 layer1 Acc 0.9089473684210526, AUC 0.9791620969772339
Test Epoch8 layer2 Acc 0.9084210526315789, AUC 0.9777426719665527
Test Epoch8 layer3 Acc 0.9086842105263158, AUC 0.9784219861030579
Test Epoch8 layer4 Acc 0.9089473684210526, AUC 0.9783183336257935
gc 0
[[3.19626248e+02 1.68870629e+01]
 [4.29766594e-11 1.33957494e+01]
 [2.14689218e-10 8.89529547e+00]
 [1.26630303e-09 8.37288783e+00]
 [4.88260943e-10 8.26911915e+00]]
Train Epoch9 Acc 0.9576583333333333 (114919/120000), AUC 0.9951063990592957
Test Epoch9 layer0 Acc 0.9072368421052631, AUC 0.9785475730895996
Test Epoch9 layer1 Acc 0.9078947368421053, AUC 0.9792006015777588
Test Epoch9 layer2 Acc 0.9088157894736842, AUC 0.9773157238960266
Test Epoch9 layer3 Acc 0.9082894736842105, AUC 0.9773768186569214
Test Epoch9 layer4 Acc 0.9082894736842105, AUC 0.9773557186126709
Best AUC 0.9806395769119263
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//ag_news/ag_news_linearal_l5_m5_prefix.pt
[[1703   58   89   50]
 [  19 1854   16   11]
 [  45   21 1668  166]
 [  54   15  129 1702]]
Figure(640x480)
[[1706   57   88   49]
 [  19 1855   15   11]
 [  48   23 1664  165]
 [  55   16  130 1699]]
Figure(640x480)
[[1710   58   80   52]
 [  21 1850   15   14]
 [  47   20 1657  176]
 [  49   14  123 1714]]
Figure(640x480)
[[1711   55   83   51]
 [  20 1849   17   14]
 [  45   20 1659  176]
 [  45   14  123 1718]]
Figure(640x480)
[[1711   57   82   50]
 [  21 1850   17   12]
 [  47   20 1661  172]
 [  52   14  126 1708]]
Figure(640x480)
