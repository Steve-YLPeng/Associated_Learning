total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask3//ag_news/ag_news_transformeral_l5_m3_prefix.pt
Start Training
gc 9
[[3.19626248e+02 1.96969167e+01]
 [4.41154319e-03 1.31230741e+01]
 [7.93323048e-03 1.21858559e+01]
 [2.96649744e+00 2.32745216e+01]
 [2.18262700e+02 5.14525452e+02]]
Train Epoch0 Acc 0.207425 (24891/120000), AUC 0.5731524229049683
Test Epoch0 layer0 Acc 0.9147368421052632, AUC 0.9809104204177856
Save ckpt to ./ckpt/mask4//ag_news/ag_news_transformeral_l5_m4_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9139473684210526, AUC 0.9790312647819519
Test Epoch0 layer2 Acc 0.9144736842105263, AUC 0.979608416557312
Test Epoch0 layer3 Acc 0.9144736842105263, AUC 0.9797245860099792
Test Epoch0 layer4 Acc 0.25092105263157893, AUC 0.5632657408714294
gc 0
[[3.19626248e+02 1.93282221e+01]
 [1.38564228e-03 1.16105617e+01]
 [2.87769630e-03 1.06517473e+01]
 [1.14382853e-03 1.10400404e+01]
 [2.18455522e+02 5.37995065e+02]]
Train Epoch1 Acc 0.243225 (29187/120000), AUC 0.6380953192710876
Test Epoch1 layer0 Acc 0.911578947368421, AUC 0.9805391430854797
Test Epoch1 layer1 Acc 0.9142105263157895, AUC 0.9779301881790161
Test Epoch1 layer2 Acc 0.9132894736842105, AUC 0.9786871671676636
Test Epoch1 layer3 Acc 0.9132894736842105, AUC 0.9783929586410522
Test Epoch1 layer4 Acc 0.25, AUC 0.6450625658035278
gc 0
[[3.19626248e+02 1.90537550e+01]
 [1.24012552e-03 1.06069068e+01]
 [2.58654108e-03 9.68842416e+00]
 [1.22488662e-03 9.90383217e+00]
 [2.15067607e+02 5.49370604e+02]]
Train Epoch2 Acc 0.2501083333333333 (30013/120000), AUC 0.6841021180152893
Test Epoch2 layer0 Acc 0.9122368421052631, AUC 0.9805450439453125
Test Epoch2 layer1 Acc 0.9128947368421053, AUC 0.9780254364013672
Test Epoch2 layer2 Acc 0.9135526315789474, AUC 0.9772409200668335
Test Epoch2 layer3 Acc 0.9135526315789474, AUC 0.9779300689697266
Test Epoch2 layer4 Acc 0.25, AUC 0.7099477052688599
gc 0
[[3.19626248e+02 1.88321156e+01]
 [1.75693422e-03 9.83146747e+00]
 [3.19621201e-03 8.95131944e+00]
 [1.97043374e-03 9.16829108e+00]
 [2.11392839e+02 5.51466464e+02]]
Train Epoch3 Acc 0.2512583333333333 (30151/120000), AUC 0.6765233278274536
Test Epoch3 layer0 Acc 0.9121052631578948, AUC 0.9796125292778015
Test Epoch3 layer1 Acc 0.9136842105263158, AUC 0.9751986861228943
Test Epoch3 layer2 Acc 0.9126315789473685, AUC 0.9732552766799927
Test Epoch3 layer3 Acc 0.9127631578947368, AUC 0.9737522006034851
Test Epoch3 layer4 Acc 0.25, AUC 0.5950223803520203
gc 0
[[3.19626248e+02 1.87015984e+01]
 [1.06268012e-03 9.18599037e+00]
 [1.80806001e-03 8.28060599e+00]
 [1.45954799e-03 8.45082770e+00]
 [2.07873274e+02 5.48562635e+02]]
Train Epoch4 Acc 0.254725 (30567/120000), AUC 0.6161731481552124
Test Epoch4 layer0 Acc 0.9113157894736842, AUC 0.9798285961151123
Test Epoch4 layer1 Acc 0.9111842105263158, AUC 0.9766695499420166
Test Epoch4 layer2 Acc 0.9106578947368421, AUC 0.974944531917572
Test Epoch4 layer3 Acc 0.9102631578947369, AUC 0.9762728214263916
Test Epoch4 layer4 Acc 0.2501315789473684, AUC 0.5883643627166748
gc 0
[[3.19626248e+02 1.76791832e+01]
 [7.27550186e-06 8.05217366e+00]
 [2.53444932e-05 7.12413816e+00]
 [2.53978732e-05 7.21776210e+00]
 [2.06475661e+02 5.45896251e+02]]
Train Epoch5 Acc 0.27565833333333334 (33079/120000), AUC 0.549906849861145
Test Epoch5 layer0 Acc 0.910921052631579, AUC 0.9795873761177063
Test Epoch5 layer1 Acc 0.9105263157894737, AUC 0.9758234024047852
Test Epoch5 layer2 Acc 0.9103947368421053, AUC 0.9746158719062805
Test Epoch5 layer3 Acc 0.9110526315789473, AUC 0.974719226360321
Test Epoch5 layer4 Acc 0.2481578947368421, AUC 0.508365273475647
gc 0
[[3.19626248e+02 1.75789429e+01]
 [2.04681829e-04 7.76404660e+00]
 [4.85997662e-04 6.80787669e+00]
 [5.75513172e-04 6.85253512e+00]
 [2.06263604e+02 5.46707245e+02]]
Train Epoch6 Acc 0.2642333333333333 (31708/120000), AUC 0.49423807859420776
Test Epoch6 layer0 Acc 0.9107894736842105, AUC 0.9795966744422913
Test Epoch6 layer1 Acc 0.9088157894736842, AUC 0.9749267101287842
Test Epoch6 layer2 Acc 0.9085526315789474, AUC 0.9739511609077454
Test Epoch6 layer3 Acc 0.9080263157894737, AUC 0.9738505482673645
Test Epoch6 layer4 Acc 0.23289473684210527, AUC 0.4706856608390808
gc 0
[[3.19626248e+02 1.75208547e+01]
 [3.53238758e-04 7.50696771e+00]
 [6.10365400e-04 6.49755465e+00]
 [8.21326386e-04 6.47875919e+00]
 [2.05078131e+02 5.51959289e+02]]
Train Epoch7 Acc 0.24355833333333332 (29227/120000), AUC 0.4501958191394806
Test Epoch7 layer0 Acc 0.9103947368421053, AUC 0.9794053435325623
Test Epoch7 layer1 Acc 0.91, AUC 0.9745804071426392
Test Epoch7 layer2 Acc 0.9093421052631578, AUC 0.9723383784294128
Test Epoch7 layer3 Acc 0.9097368421052632, AUC 0.9725362062454224
Test Epoch7 layer4 Acc 0.2325, AUC 0.4571433663368225
gc 0
[[3.19626248e+02 1.74739334e+01]
 [3.98330938e-04 7.25395252e+00]
 [7.06392910e-04 6.19278578e+00]
 [1.00952158e-03 6.11046093e+00]
 [2.03754237e+02 5.60627167e+02]]
Train Epoch8 Acc 0.24210833333333334 (29053/120000), AUC 0.42861640453338623
Test Epoch8 layer0 Acc 0.9097368421052632, AUC 0.9790787100791931
Test Epoch8 layer1 Acc 0.9096052631578947, AUC 0.973857045173645
Test Epoch8 layer2 Acc 0.9090789473684211, AUC 0.972063422203064
Test Epoch8 layer3 Acc 0.9094736842105263, AUC 0.970989465713501
Test Epoch8 layer4 Acc 0.2338157894736842, AUC 0.44188252091407776
gc 0
[[3.19626248e+02 1.69439394e+01]
 [5.70644044e-06 6.69865827e+00]
 [1.92359961e-05 5.59964047e+00]
 [4.21740977e-05 5.46078203e+00]
 [2.03019969e+02 5.66603140e+02]]
Train Epoch9 Acc 0.24286666666666668 (29144/120000), AUC 0.4280321002006531
Test Epoch9 layer0 Acc 0.9090789473684211, AUC 0.9791479110717773
Test Epoch9 layer1 Acc 0.9088157894736842, AUC 0.9741974472999573
Test Epoch9 layer2 Acc 0.908157894736842, AUC 0.9711217284202576
Test Epoch9 layer3 Acc 0.9077631578947368, AUC 0.9701090455055237
Test Epoch9 layer4 Acc 0.23394736842105263, AUC 0.43133679032325745
Best AUC 0.9809104204177856
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//ag_news/ag_news_transformeral_l5_m4_prefix.pt
[[1694   62   95   49]
 [  14 1864   10   12]
 [  40   21 1676  163]
 [  41   17  124 1718]]
Figure(640x480)
[[1713   55   72   60]
 [  19 1848   18   15]
 [  51   17 1663  169]
 [  43   14  121 1722]]
Figure(640x480)
[[1718   53   70   59]
 [  21 1845   20   14]
 [  51   14 1669  166]
 [  44   13  125 1718]]
Figure(640x480)
[[1716   53   73   58]
 [  21 1845   20   14]
 [  48   12 1678  162]
 [  44   13  132 1711]]
Figure(640x480)
[[   8 1892    0    0]
 [   1 1899    0    0]
 [ 792 1108    0    0]
 [  43 1857    0    0]]
Figure(640x480)
