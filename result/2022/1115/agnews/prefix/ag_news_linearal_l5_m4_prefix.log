total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3_prefix.pt
Start Training
gc 9
[[3.19626248e+02 1.91575197e+01]
 [1.65051325e-04 1.68153279e+01]
 [3.58217715e-04 1.53518894e+01]
 [2.11642152e+01 2.11960006e+01]
 [3.05474828e+02 2.21529750e+02]]
Train Epoch0 Acc 0.2534416666666667 (30413/120000), AUC 0.3871915638446808
Test Epoch0 layer0 Acc 0.9136842105263158, AUC 0.9802029132843018
Save ckpt to ./ckpt/mask4//ag_news/ag_news_linearal_l5_m4_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9121052631578948, AUC 0.9802454710006714
Save ckpt to ./ckpt/mask4//ag_news/ag_news_linearal_l5_m4_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9118421052631579, AUC 0.9806385040283203
Save ckpt to ./ckpt/mask4//ag_news/ag_news_linearal_l5_m4_prefix.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9113157894736842, AUC 0.9805774688720703
Test Epoch0 layer4 Acc 0.2538157894736842, AUC 0.3353995680809021
gc 0
[[3.19626248e+02 1.89960859e+01]
 [5.04871783e-05 1.65495124e+01]
 [1.14207074e-04 1.45789033e+01]
 [3.40761867e-05 1.45773840e+01]
 [3.21123971e+02 2.38780394e+02]]
Train Epoch1 Acc 0.24755833333333332 (29707/120000), AUC 0.30586883425712585
Test Epoch1 layer0 Acc 0.9105263157894737, AUC 0.9801022410392761
Test Epoch1 layer1 Acc 0.9106578947368421, AUC 0.9800078868865967
Test Epoch1 layer2 Acc 0.9111842105263158, AUC 0.9806548953056335
Save ckpt to ./ckpt/mask4//ag_news/ag_news_linearal_l5_m4_prefix.pt  ,ep 1
Test Epoch1 layer3 Acc 0.911578947368421, AUC 0.9806715846061707
Save ckpt to ./ckpt/mask4//ag_news/ag_news_linearal_l5_m4_prefix.pt  ,ep 1
Test Epoch1 layer4 Acc 0.24776315789473685, AUC 0.2931843400001526
gc 0
[[3.19626248e+02 1.88191002e+01]
 [7.10868559e-05 1.62885703e+01]
 [1.61431091e-04 1.38231784e+01]
 [4.69544118e-05 1.32451567e+01]
 [3.20977845e+02 2.54753937e+02]]
Train Epoch2 Acc 0.24206666666666668 (29048/120000), AUC 0.2797943353652954
Test Epoch2 layer0 Acc 0.9113157894736842, AUC 0.9797737002372742
Test Epoch2 layer1 Acc 0.9110526315789473, AUC 0.9797533750534058
Test Epoch2 layer2 Acc 0.9131578947368421, AUC 0.980649471282959
Test Epoch2 layer3 Acc 0.9118421052631579, AUC 0.9806163907051086
Test Epoch2 layer4 Acc 0.2338157894736842, AUC 0.285076379776001
gc 0
[[3.19626248e+02 1.86974454e+01]
 [6.88010752e-05 1.60818510e+01]
 [1.58048801e-04 1.31765233e+01]
 [4.67933106e-05 1.19685298e+01]
 [3.20787960e+02 2.82654091e+02]]
Train Epoch3 Acc 0.21485833333333335 (25783/120000), AUC 0.27171552181243896
Test Epoch3 layer0 Acc 0.9110526315789473, AUC 0.9796798229217529
Test Epoch3 layer1 Acc 0.9118421052631579, AUC 0.9798325300216675
Test Epoch3 layer2 Acc 0.9117105263157895, AUC 0.9807642102241516
Save ckpt to ./ckpt/mask4//ag_news/ag_news_linearal_l5_m4_prefix.pt  ,ep 3
Test Epoch3 layer3 Acc 0.9130263157894737, AUC 0.9801828861236572
Test Epoch3 layer4 Acc 0.20276315789473684, AUC 0.2635944187641144
gc 0
[[3.19626248e+02 1.85872350e+01]
 [7.09188747e-05 1.58679556e+01]
 [1.60515311e-04 1.25745591e+01]
 [4.85639239e-05 1.09451642e+01]
 [3.20603839e+02 3.14083889e+02]]
Train Epoch4 Acc 0.16706666666666667 (20048/120000), AUC 0.24312414228916168
Test Epoch4 layer0 Acc 0.91, AUC 0.9797487854957581
Test Epoch4 layer1 Acc 0.9117105263157895, AUC 0.9797859191894531
Test Epoch4 layer2 Acc 0.9111842105263158, AUC 0.9805002808570862
Test Epoch4 layer3 Acc 0.9122368421052631, AUC 0.9793704748153687
Test Epoch4 layer4 Acc 0.16736842105263158, AUC 0.24585461616516113
gc 0
[[3.19626248e+02 1.76674774e+01]
 [5.10821263e-07 1.50180919e+01]
 [3.59999343e-05 1.14592612e+01]
 [8.03108921e-06 9.78914760e+00]
 [3.20535972e+02 3.34759173e+02]]
Train Epoch5 Acc 0.13315833333333332 (15979/120000), AUC 0.22951439023017883
Test Epoch5 layer0 Acc 0.9111842105263158, AUC 0.9792118668556213
Test Epoch5 layer1 Acc 0.9113157894736842, AUC 0.9794648885726929
Test Epoch5 layer2 Acc 0.9117105263157895, AUC 0.9797409176826477
Test Epoch5 layer3 Acc 0.9119736842105263, AUC 0.9777049422264099
Test Epoch5 layer4 Acc 0.1351315789473684, AUC 0.2459893524646759
gc 0
[[3.19626248e+02 1.75969197e+01]
 [9.79266295e-06 1.49058783e+01]
 [1.11758556e-04 1.09708345e+01]
 [2.76182561e-05 9.53937135e+00]
 [3.20461655e+02 3.46918352e+02]]
Train Epoch6 Acc 0.12994166666666668 (15593/120000), AUC 0.2350224256515503
Test Epoch6 layer0 Acc 0.9086842105263158, AUC 0.9793638586997986
Test Epoch6 layer1 Acc 0.9096052631578947, AUC 0.9795259237289429
Test Epoch6 layer2 Acc 0.9089473684210526, AUC 0.979780375957489
Test Epoch6 layer3 Acc 0.9096052631578947, AUC 0.9774978160858154
Test Epoch6 layer4 Acc 0.14921052631578946, AUC 0.2565557658672333
gc 0
[[3.19626248e+02 1.75530935e+01]
 [1.49972219e-05 1.48154898e+01]
 [9.32088295e-05 1.05469719e+01]
 [2.66889042e-05 9.37889935e+00]
 [3.20299347e+02 3.56790125e+02]]
Train Epoch7 Acc 0.13070833333333334 (15685/120000), AUC 0.24589696526527405
Test Epoch7 layer0 Acc 0.9093421052631578, AUC 0.9791461825370789
Test Epoch7 layer1 Acc 0.9089473684210526, AUC 0.9793325662612915
Test Epoch7 layer2 Acc 0.9097368421052632, AUC 0.9800055027008057
Test Epoch7 layer3 Acc 0.9097368421052632, AUC 0.9784787893295288
Test Epoch7 layer4 Acc 0.14789473684210527, AUC 0.26562395691871643
gc 0
[[3.19626248e+02 1.75234462e+01]
 [1.80852239e-05 1.47237743e+01]
 [1.56452452e-05 1.01827653e+01]
 [7.83370876e-06 9.22444070e+00]
 [3.20239040e+02 3.62807324e+02]]
Train Epoch8 Acc 0.14215833333333333 (17059/120000), AUC 0.2545986771583557
Test Epoch8 layer0 Acc 0.9092105263157895, AUC 0.9789049625396729
Test Epoch8 layer1 Acc 0.9094736842105263, AUC 0.979249894618988
Test Epoch8 layer2 Acc 0.9102631578947369, AUC 0.9790022969245911
Test Epoch8 layer3 Acc 0.9113157894736842, AUC 0.9770405292510986
Test Epoch8 layer4 Acc 0.16013157894736843, AUC 0.2708330750465393
gc 0
[[3.19626248e+02 1.70229826e+01]
 [2.99149148e-11 1.42647744e+01]
 [3.13897986e-10 9.68039058e+00]
 [8.64491050e-11 8.80643805e+00]
 [3.20230620e+02 3.67478820e+02]]
Train Epoch9 Acc 0.14524166666666666 (17429/120000), AUC 0.258817195892334
Test Epoch9 layer0 Acc 0.908157894736842, AUC 0.9788092970848083
Test Epoch9 layer1 Acc 0.9088157894736842, AUC 0.9790975451469421
Test Epoch9 layer2 Acc 0.9098684210526315, AUC 0.9792220592498779
Test Epoch9 layer3 Acc 0.9093421052631578, AUC 0.9774317741394043
Test Epoch9 layer4 Acc 0.16473684210526315, AUC 0.2762366235256195
Best AUC 0.9807642102241516
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//ag_news/ag_news_linearal_l5_m4_prefix.pt
[[1709   55   90   46]
 [  21 1845   22   12]
 [  42   19 1689  150]
 [  55   16  148 1681]]
Figure(640x480)
[[1712   54   87   47]
 [  23 1848   19   10]
 [  44   21 1678  157]
 [  56   16  136 1692]]
Figure(640x480)
[[1716   55   81   48]
 [  23 1844   20   13]
 [  45   20 1673  162]
 [  54   16  134 1696]]
Figure(640x480)
[[1713   53   84   50]
 [  22 1844   21   13]
 [  41   18 1685  156]
 [  53   13  137 1697]]
Figure(640x480)
[[  53    0  150 1697]
 [1684    0  203   13]
 [ 348    0 1452  100]
 [  12    0 1852   36]]
Figure(640x480)
