total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l5_m4.pt
Start Training
gc 9
[[4.44061607e+03 8.14733422e+01]
 [1.54763593e-11 1.29914612e+01]
 [5.28888729e-04 9.99872935e+00]
 [1.62658970e-04 8.92035114e+00]
 [3.98545127e+01 1.45955040e+01]]
Train Epoch0 Acc 0.9667982142857143 (541407/560000), AUC 0.9972119927406311
Test Epoch0 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch0 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch0 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch0 layer3 Acc 0.9842857142857143, AUC 0.9977813959121704
Test Epoch0 layer4 Acc 0.9842, AUC 0.9971715807914734
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l5_m5.pt  ,ep 0
gc 0
[[4.44061607e+03 8.15186225e+01]
 [1.54763593e-11 1.29928480e+01]
 [5.28888729e-04 9.99875166e+00]
 [1.62658970e-04 8.92053442e+00]
 [1.61298613e-11 8.57433581e+00]]
Train Epoch1 Acc 0.9883267857142857 (553463/560000), AUC 0.9982870817184448
Test Epoch1 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch1 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch1 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch1 layer3 Acc 0.9842857142857143, AUC 0.9977813959121704
Test Epoch1 layer4 Acc 0.9843714285714286, AUC 0.9974619150161743
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l5_m5.pt  ,ep 1
gc 0
[[4.44061607e+03 8.14697234e+01]
 [1.54763593e-11 1.29922604e+01]
 [5.28888729e-04 1.00008551e+01]
 [1.62658970e-04 8.92243671e+00]
 [1.46200167e-04 8.49244253e+00]]
Train Epoch2 Acc 0.9883785714285714 (553492/560000), AUC 0.9984059929847717
Test Epoch2 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch2 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch2 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch2 layer3 Acc 0.9842857142857143, AUC 0.9977813959121704
Test Epoch2 layer4 Acc 0.9843571428571428, AUC 0.9974053502082825
gc 0
[[4.44061607e+03 8.14601647e+01]
 [1.54763593e-11 1.29930039e+01]
 [5.28888729e-04 1.00007533e+01]
 [1.62658970e-04 8.92230065e+00]
 [3.28265871e-04 8.45055984e+00]]
Train Epoch3 Acc 0.9884071428571428 (553508/560000), AUC 0.9984678626060486
Test Epoch3 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch3 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch3 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch3 layer3 Acc 0.9842857142857143, AUC 0.9977813959121704
Test Epoch3 layer4 Acc 0.9843, AUC 0.9974462389945984
gc 0
[[4.44061607e+03 8.14868171e+01]
 [1.54763593e-11 1.29928467e+01]
 [5.28888729e-04 1.00002063e+01]
 [1.62658970e-04 8.92190576e+00]
 [3.17950185e-04 8.42478096e+00]]
Train Epoch4 Acc 0.98845 (553532/560000), AUC 0.9985054731369019
Test Epoch4 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch4 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch4 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch4 layer3 Acc 0.9842857142857143, AUC 0.9977813959121704
Test Epoch4 layer4 Acc 0.9843142857142857, AUC 0.997482180595398
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l5_m5.pt  ,ep 4
gc 0
[[4.44061607e+03 8.15048627e+01]
 [1.54763593e-11 1.29940369e+01]
 [5.28888729e-04 9.99935018e+00]
 [1.62658970e-04 8.92076768e+00]
 [3.19245610e-04 8.40450663e+00]]
Train Epoch5 Acc 0.9884482142857143 (553531/560000), AUC 0.9985203146934509
Test Epoch5 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch5 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch5 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch5 layer3 Acc 0.9842857142857143, AUC 0.9977813959121704
Test Epoch5 layer4 Acc 0.9843857142857143, AUC 0.9975872039794922
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l5_m5.pt  ,ep 5
gc 0
[[4.44061607e+03 8.15301281e+01]
 [1.54763593e-11 1.29932334e+01]
 [5.28888729e-04 9.99950391e+00]
 [1.62658970e-04 8.92117988e+00]
 [3.12708677e-04 8.39496637e+00]]
Train Epoch6 Acc 0.9884446428571428 (553529/560000), AUC 0.998552680015564
Test Epoch6 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch6 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch6 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch6 layer3 Acc 0.9842857142857143, AUC 0.9977813959121704
Test Epoch6 layer4 Acc 0.9843714285714286, AUC 0.9975695013999939
gc 0
[[4.44061607e+03 8.14976081e+01]
 [1.54763593e-11 1.29913096e+01]
 [5.28888729e-04 9.99885918e+00]
 [1.62658970e-04 8.92052239e+00]
 [3.29803008e-04 8.38089758e+00]]
Train Epoch7 Acc 0.9884589285714286 (553537/560000), AUC 0.9985767602920532
Test Epoch7 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch7 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch7 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch7 layer3 Acc 0.9842857142857143, AUC 0.9977813959121704
Test Epoch7 layer4 Acc 0.9843714285714286, AUC 0.9976548552513123
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l5_m5.pt  ,ep 7
gc 0
[[4.44061607e+03 8.14966415e+01]
 [1.54763593e-11 1.29938990e+01]
 [5.28888729e-04 9.99938712e+00]
 [1.62658970e-04 8.92117280e+00]
 [3.06810832e-04 8.37196992e+00]]
Train Epoch8 Acc 0.9884767857142858 (553547/560000), AUC 0.9985749125480652
Test Epoch8 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch8 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch8 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch8 layer3 Acc 0.9842857142857143, AUC 0.9977813959121704
Test Epoch8 layer4 Acc 0.9844, AUC 0.9976596832275391
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l5_m5.pt  ,ep 8
gc 0
[[4.44061607e+03 8.14493767e+01]
 [1.54763593e-11 1.29911682e+01]
 [5.28888729e-04 9.99867302e+00]
 [1.62658970e-04 8.92035853e+00]
 [3.22898763e-04 8.36423088e+00]]
Train Epoch9 Acc 0.9884732142857143 (553545/560000), AUC 0.9986007809638977
Test Epoch9 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch9 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Test Epoch9 layer2 Acc 0.9842285714285715, AUC 0.9983829855918884
Test Epoch9 layer3 Acc 0.9842857142857143, AUC 0.9977813959121704
Test Epoch9 layer4 Acc 0.9844285714285714, AUC 0.9977043271064758
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l5_m5.pt  ,ep 9
Best AUC 0.9977043271064758
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l5_m5.pt
[[4674   46   25   15   11   80   42    9    4    6    4   20   21   43]
 [  32 4910    2    1    7    0   26    4    2    2    1    0    4    9]
 [  30   13 4634   18   51    1   10    3    6    0    1   74   21  138]
 [   3    2   31 4949   10    1    1    0    0    0    0    0    0    3]
 [   8   20   75   13 4849    8    6    2    2    1    0    1    3   12]
 [  30    1    3    3    1 4948    5    3    1    2    0    0    1    2]
 [  58   53    4    3   10   16 4792   41    9    5    1    1    4    3]
 [   0    1    0    0    2    0   12 4962   18    3    1    0    0    1]
 [   1    3    2    0    3    0   11   15 4964    1    0    0    0    0]
 [   1    0    1    2    0    0    0    8    0 4950   37    0    0    1]
 [  12    1    0    0    0    0    1    5    0   31 4950    0    0    0]
 [   5    0   45    2    0    0    1    1    0    1    0 4915   17   13]
 [   7    2   25    5    2    4    1    3    1    2    0   22 4880   46]
 [  30    5   87    8   12    3    4    9    1    4    3    5   40 4789]]
Figure(640x480)
[[4767   41   23    3   11   37   53    4    0    2    2   12    5   40]
 [  34 4912    5    0    6    0   34    1    1    0    0    1    0    6]
 [  16    4 4864    5   66    1    5    0    0    0    0   13    6   20]
 [   1    1   35 4940   18    2    1    0    0    0    0    2    0    0]
 [   5    4   65    5 4903    5    6    0    0    3    0    0    2    2]
 [  36    0    2    0    1 4952    4    2    0    0    0    0    1    2]
 [  46   30    5    0    6   12 4874   17    4    3    0    1    0    2]
 [   2    0    0    0    0    1   21 4966    7    0    0    1    1    1]
 [   1    1    1    0    3    0   10    7 4974    0    0    0    0    3]
 [   1    0    2    1    0    0    0    4    0 4963   27    0    1    1]
 [  13    1    1    0    0    0    1    1    0   26 4956    1    0    0]
 [   4    0   16    1    0    0    0    0    0    0    0 4963    9    7]
 [   4    1   22    0    1    2    2    0    0    0    0   22 4905   41]
 [  29    2   40    1    5    3    2    0    0    1    2    8   14 4893]]
Figure(640x480)
[[4789   39   19    5   11   32   49    2    0    2    2   10    6   34]
 [  39 4914    0    1    7    0   33    0    1    1    0    0    0    4]
 [  17    4 4855   13   58    1    6    0    0    0    0   12    8   26]
 [   1    1   15 4968   13    1    0    0    0    0    0    0    1    0]
 [   6    4   63    9 4901    5    5    0    0    3    0    0    2    2]
 [  41    0    2    0    1 4947    4    1    0    1    0    0    1    2]
 [  47   31    3    0    3   12 4875   18    4    3    0    1    1    2]
 [   2    0    1    0    0    0   17 4967   10    0    0    1    1    1]
 [   2    1    1    0    3    0    7    6 4977    0    0    0    0    3]
 [   1    0    0    1    0    0    0    4    0 4971   21    0    1    1]
 [  13    1    1    0    0    0    1    0    0   28 4956    0    0    0]
 [   6    0   14    1    0    0    0    0    0    0    0 4960   12    7]
 [   5    2   10    0    1    2    1    0    0    0    0   21 4922   36]
 [  31    2   34    1    5    3    2    0    0    1    2    7   18 4894]]
Figure(640x480)
[[4798   37   19    5   11   31   49    3    0    2    2    8    6   29]
 [  39 4916    0    1    7    0   31    0    1    1    0    0    0    4]
 [  16    4 4845   13   70    1    6    0    0    0    0   12    8   25]
 [   1    1   14 4968   14    1    0    0    0    0    0    0    1    0]
 [   6    4   57    8 4908    4    6    0    0    3    0    0    2    2]
 [  43    0    2    0    1 4945    4    1    0    1    0    0    1    2]
 [  48   33    2    0    3   12 4870   19    6    3    0    1    0    3]
 [   2    0    0    0    0    1   15 4969   10    0    0    1    1    1]
 [   0    1    1    0    3    0    7    6 4979    0    0    0    0    3]
 [   1    0    0    1    0    0    0    4    0 4968   24    0    1    1]
 [  13    1    0    0    1    0    1    0    0   27 4957    0    0    0]
 [   6    0   13    1    0    0    0    0    0    0    0 4960   12    8]
 [   5    2    9    0    1    2    1    0    0    0    0   20 4923   37]
 [  32    2   32    1    6    3    2    0    0    1    1    8   18 4894]]
Figure(640x480)
[[4803   35   18    5   11   31   48    3    0    2    2    8    6   28]
 [  39 4918    0    1    7    0   29    0    1    1    0    0    0    4]
 [  16    4 4851   13   63    1    6    0    0    0    0   12    8   26]
 [   1    1   15 4968   13    1    0    0    0    0    0    0    1    0]
 [   6    4   61    8 4904    4    6    0    0    3    0    0    2    2]
 [  42    0    2    0    1 4946    4    1    0    1    0    0    1    2]
 [  50   32    2    0    3   12 4868   20    6    3    0    1    0    3]
 [   2    0    0    0    0    1   15 4968   11    0    0    1    1    1]
 [   0    1    1    0    2    0    7    6 4980    0    0    0    0    3]
 [   1    0    0    1    0    0    0    4    0 4970   22    0    1    1]
 [  14    1    0    0    0    0    1    0    0   27 4957    0    0    0]
 [   7    0   12    1    0    0    0    0    0    0    0 4960   12    8]
 [   5    2    7    0    1    2    1    0    0    0    0   20 4923   39]
 [  33    2   33    1    3    3    2    1    0    1    1    8   18 4894]]
Figure(640x480)
