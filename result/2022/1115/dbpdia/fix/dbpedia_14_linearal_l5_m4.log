total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l5_m3.pt
Start Training
gc 9
[[4.44061607e+03 8.08383211e+01]
 [2.50137668e-04 5.09078462e+01]
 [4.19686802e-05 3.79094290e+01]
 [3.88757728e+01 4.97690229e+01]
 [1.36025990e+03 1.01372748e+03]]
Train Epoch0 Acc 0.06458214285714285 (36166/560000), AUC 0.5383566617965698
Test Epoch0 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch0 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch0 layer2 Acc 0.9750714285714286, AUC 0.9985889196395874
Test Epoch0 layer3 Acc 0.9753571428571428, AUC 0.998526930809021
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_linearal_l5_m4.pt  ,ep 0
Test Epoch0 layer4 Acc 0.07302857142857143, AUC 0.5498765110969543
gc 0
[[4.44061607e+03 8.08855992e+01]
 [2.50137667e-04 5.09278372e+01]
 [4.19686802e-05 3.79226470e+01]
 [1.47412785e-11 3.17605263e+01]
 [1.38173547e+03 1.10828873e+03]]
Train Epoch1 Acc 0.07634107142857142 (42751/560000), AUC 0.5626527070999146
Test Epoch1 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch1 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch1 layer2 Acc 0.9750714285714286, AUC 0.9985889196395874
Test Epoch1 layer3 Acc 0.9753857142857143, AUC 0.9984918236732483
Test Epoch1 layer4 Acc 0.08521428571428571, AUC 0.5841121077537537
gc 0
[[4.44061607e+03 8.08729893e+01]
 [2.50137668e-04 5.09255193e+01]
 [4.19686801e-05 3.79195794e+01]
 [1.49373478e-04 2.84949612e+01]
 [1.38153925e+03 1.24927052e+03]]
Train Epoch2 Acc 0.07493035714285715 (41961/560000), AUC 0.5963692665100098
Test Epoch2 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch2 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch2 layer2 Acc 0.9750714285714286, AUC 0.9985889196395874
Test Epoch2 layer3 Acc 0.9756, AUC 0.99842768907547
Test Epoch2 layer4 Acc 0.05332857142857143, AUC 0.6112374067306519
gc 0
[[4.44061607e+03 8.08648209e+01]
 [2.50137667e-04 5.09128932e+01]
 [4.19686801e-05 3.79153079e+01]
 [3.36479316e-04 2.60321118e+01]
 [1.37987141e+03 1.39164932e+03]]
Train Epoch3 Acc 0.052692857142857145 (29508/560000), AUC 0.6178190112113953
Test Epoch3 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch3 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch3 layer2 Acc 0.9750714285714286, AUC 0.9985889196395874
Test Epoch3 layer3 Acc 0.9758714285714286, AUC 0.9983324408531189
Test Epoch3 layer4 Acc 0.05135714285714286, AUC 0.6244720816612244
gc 0
[[4.44061607e+03 8.08962061e+01]
 [2.50137668e-04 5.09275825e+01]
 [4.19686802e-05 3.79252368e+01]
 [3.25095999e-04 2.40750833e+01]
 [1.37769569e+03 1.52137068e+03]]
Train Epoch4 Acc 0.05021071428571429 (28118/560000), AUC 0.626164436340332
Test Epoch4 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch4 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch4 layer2 Acc 0.9750714285714286, AUC 0.9985889196395874
Test Epoch4 layer3 Acc 0.9759142857142857, AUC 0.9981757998466492
Test Epoch4 layer4 Acc 0.047228571428571425, AUC 0.6285192370414734
gc 0
[[4.44061607e+03 8.08362323e+01]
 [2.50137668e-04 5.09199284e+01]
 [4.19686801e-05 3.79210196e+01]
 [5.29544870e-05 2.25959838e+01]
 [1.37646629e+03 1.61405527e+03]]
Train Epoch5 Acc 0.04662321428571429 (26109/560000), AUC 0.6295624375343323
Test Epoch5 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch5 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch5 layer2 Acc 0.9750714285714286, AUC 0.9985889196395874
Test Epoch5 layer3 Acc 0.9758857142857142, AUC 0.9982089400291443
Test Epoch5 layer4 Acc 0.04221428571428571, AUC 0.6306973695755005
gc 0
[[4.44061607e+03 8.08795961e+01]
 [2.50137667e-04 5.09193047e+01]
 [4.19686802e-05 3.79194723e+01]
 [8.01365081e-05 2.18457675e+01]
 [1.37595742e+03 1.67209045e+03]]
Train Epoch6 Acc 0.042007142857142854 (23524/560000), AUC 0.6308669447898865
Test Epoch6 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch6 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch6 layer2 Acc 0.9750714285714286, AUC 0.9985889196395874
Test Epoch6 layer3 Acc 0.9760571428571428, AUC 0.99821537733078
Test Epoch6 layer4 Acc 0.03857142857142857, AUC 0.6315279603004456
gc 0
[[4.44061607e+03 8.09127762e+01]
 [2.50137668e-04 5.09363218e+01]
 [4.19686801e-05 3.79303277e+01]
 [8.07205842e-05 2.11735766e+01]
 [1.37540950e+03 1.72252968e+03]]
Train Epoch7 Acc 0.03605357142857143 (20190/560000), AUC 0.6316606402397156
Test Epoch7 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch7 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch7 layer2 Acc 0.9750714285714286, AUC 0.9985889196395874
Test Epoch7 layer3 Acc 0.9762428571428572, AUC 0.9981297254562378
Test Epoch7 layer4 Acc 0.031471428571428574, AUC 0.633246898651123
gc 0
[[4.44061607e+03 8.08336788e+01]
 [2.50137667e-04 5.09183407e+01]
 [4.19686801e-05 3.79153204e+01]
 [8.36237264e-05 2.05648731e+01]
 [1.37484965e+03 1.76725526e+03]]
Train Epoch8 Acc 0.028167857142857144 (15774/560000), AUC 0.6334342360496521
Test Epoch8 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch8 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch8 layer2 Acc 0.9750714285714286, AUC 0.9985889196395874
Test Epoch8 layer3 Acc 0.9762428571428572, AUC 0.9981640577316284
Test Epoch8 layer4 Acc 0.024385714285714285, AUC 0.633150041103363
gc 0
[[4.44061607e+03 8.08444910e+01]
 [2.50137668e-04 5.09101720e+01]
 [4.19686801e-05 3.79128559e+01]
 [1.26044730e-05 2.00350053e+01]
 [1.37454805e+03 1.79929927e+03]]
Train Epoch9 Acc 0.021617857142857144 (12106/560000), AUC 0.6333476901054382
Test Epoch9 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch9 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch9 layer2 Acc 0.9750714285714286, AUC 0.9985889196395874
Test Epoch9 layer3 Acc 0.9764, AUC 0.9980786442756653
Test Epoch9 layer4 Acc 0.019328571428571428, AUC 0.6341031193733215
Best AUC 0.998526930809021
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//dbpedia_14/dbpedia_14_linearal_l5_m4.pt
[[4700   40   23   14   11   67   41    7    4    6    4   18   18   47]
 [  35 4894    1    1    8    0   35    8    3    2    1    1    3    8]
 [  38   13 4606   17   49    2   10    4    5    0    1   86   20  149]
 [   4    1   26 4952   12    1    1    0    0    0    0    1    0    2]
 [  13   14   79   13 4849    8    5    1    2    0    0    1    2   13]
 [  39    1    3    4    1 4939    5    3    1    1    0    0    1    2]
 [  62   42    4    2   10   16 4802   39    9    5    1    1    4    3]
 [   0    0    0    0    2    0   12 4966   15    3    1    0    0    1]
 [   2    3    2    0    4    0   12   13 4964    0    0    0    0    0]
 [   1    0    0    2    1    0    0    8    0 4955   31    1    0    1]
 [  12    1    0    0    0    0    2    5    0   32 4947    1    0    0]
 [   7    0   43    2    0    0    0    0    0    1    0 4920   13   14]
 [  11    2   26    8    1    3    1    3    1    3    0   23 4866   52]
 [  30    5   75    8   11    3    4    9    1    4    4    5   40 4801]]
Figure(640x480)
[[4678   45   20   14   11   65   44    7    2    5    4   34   22   49]
 [  33 4901    2    2    7    0   38    1    2    2    0    0    6    6]
 [  39   14 4554   20   64    2   11    2    4    0    1  124   38  127]
 [   5    2   24 4955   12    1    1    0    0    0    0    0    0    0]
 [   9   16   61   14 4871    9    7    0    2    2    0    0    2    7]
 [  38    1    2    3    1 4944    5    2    1    0    0    0    1    2]
 [  53   37    3    2   10   19 4827   30    5    5    1    1    6    1]
 [   1    1    0    0    2    0   14 4964   13    3    1    0    0    1]
 [   2    2    2    0    5    0   14   14 4961    0    0    0    0    0]
 [   1    0    1    3    0    0    0    6    0 4953   35    0    0    1]
 [  13    1    0    0    0    0    2    3    0   36 4945    0    0    0]
 [   7    0   22    2    0    0    2    0    0    0    0 4942   14   11]
 [   7    1   18    4    1    3    1    2    0    1    0   18 4906   38]
 [  26    4   69    7   11    3    4    4    1    2    2    7   59 4801]]
Figure(640x480)
[[4735   36   21   10   12   52   40    5    1    4    3   24   15   42]
 [  42 4893    3    2    7    0   36    1    2    1    0    0    7    6]
 [  38   13 4651   20   61    2    9    1    1    1    1   77   25  100]
 [   3    2   26 4953   12    1    1    0    0    2    0    0    0    0]
 [  10   10   63   17 4873   10    6    0    2    3    0    0    1    5]
 [  46    1    3    3    1 4935    5    2    1    0    0    0    1    2]
 [  63   41    6    2    9   20 4815   27    3    4    1    1    7    1]
 [   2    1    0    0    2    0   15 4959   13    3    4    0    0    1]
 [   2    3    2    0    5    0   15   15 4958    0    0    0    0    0]
 [   1    0    1    2    0    0    0    6    0 4958   31    0    0    1]
 [  13    1    0    0    0    0    2    1    0   54 4929    0    0    0]
 [   9    0   29    2    0    1    1    0    0    0    0 4934   14   10]
 [   7    1   19    4    0    3    1    2    0    1    0   20 4906   36]
 [  39    4   85    7   11    3    4    5    0    2    3    9   72 4756]]
Figure(640x480)
[[4729   40   22   10   11   53   38    6    1    3    3   24   12   48]
 [  38 4901    2    2    6    0   35    1    2    1    0    0    5    7]
 [  35   12 4674   16   53    2   10    1    1    4    1   72   23   96]
 [   4    2   31 4946   11    2    1    0    0    2    0    0    0    1]
 [   8   13   79   15 4853   10    7    0    2    4    0    0    1    8]
 [  47    1    3    3    1 4934    5    2    1    0    0    0    1    2]
 [  62   45    9    2    9   17 4820   23    3    4    1    1    3    1]
 [   3    1    1    0    2    0   18 4954   13    3    4    0    0    1]
 [   2    5    2    0    5    0   14   16 4954    1    0    0    0    1]
 [   1    0    1    2    0    0    0    6    0 4957   32    0    0    1]
 [  12    1    0    0    0    0    2    1    0   45 4939    0    0    0]
 [   6    0   32    2    0    0    1    0    0    0    0 4930   14   15]
 [  11    2   22    4    0    3    1    2    0    1    0   20 4891   43]
 [  29    2   92    6    8    3    4    4    0    1    2    9   47 4793]]
Figure(640x480)
[[  29    0    0    0    0 1881  657    0    0    0    0    4 2428    1]
 [   9    0    2    0    0    5    0    0    0    0    0    0 4981    3]
 [1623    0    0    0    0  154    6    0    0    0    0 2237  980    0]
 [   4    0    0    0    0    0    0    0    0    0    0    0 4996    0]
 [4709    0   10    1    0   29   43    0   19    0    0   14  160   15]
 [2813    0    0    0    0   18    2    0    0    0    0    0 2034  133]
 [3744    0    0    0    0    1   57    0    0   18    0    0 1179    1]
 [   8    0    1    0    0    0   24   43    0    0    0    0 4924    0]
 [   6    0  166    0    0   13 2383 1102    0    0    0    2 1300   28]
 [   0    0    0  677    0    0    6    0    0    0    0    0 4317    0]
 [   5    0    0    1    0    4 3677    0    0    0    0    0 1313    0]
 [   3    0    0    0    0    1    0    0    0    0    0    2 4994    0]
 [  11    0    0    0    0   11    8    0    0    0    0    3 4963    4]
 [3261    0    0    0    0 1276    0    1    0    0    0    1  461    0]]
Figure(640x480)
