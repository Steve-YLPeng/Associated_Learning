total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1.pt
Start Training
gc 9
[[4440.61607122   81.46910575]
 [  51.84742086   40.84121619]
 [1550.56046006  884.72612344]
 [1262.37926728  643.35823947]
 [1061.52692379  546.78968488]]
Train Epoch0 Acc 0.11133928571428571 (62350/560000), AUC 0.4958767890930176
Test Epoch0 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch0 layer1 Acc 0.9816571428571429, AUC 0.9984903335571289
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l5_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.029142857142857144, AUC 0.41483116149902344
Test Epoch0 layer3 Acc 0.07124285714285715, AUC 0.5604209303855896
Test Epoch0 layer4 Acc 0.11548571428571429, AUC 0.502918541431427
gc 0
[[4.44061607e+03 8.14487052e+01]
 [1.98031462e-11 1.45950943e+01]
 [1.56336951e+03 9.20974626e+02]
 [1.26295583e+03 6.48735545e+02]
 [1.06208588e+03 5.50064239e+02]]
Train Epoch1 Acc 0.11705535714285714 (65551/560000), AUC 0.5089011788368225
Test Epoch1 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch1 layer1 Acc 0.9833142857142857, AUC 0.998566210269928
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l5_m2.pt  ,ep 1
Test Epoch1 layer2 Acc 0.027571428571428573, AUC 0.40097755193710327
Test Epoch1 layer3 Acc 0.07144285714285714, AUC 0.5550304651260376
Test Epoch1 layer4 Acc 0.13121428571428573, AUC 0.5181850790977478
gc 0
[[4.44061607e+03 8.14708334e+01]
 [1.95080654e-04 1.23076060e+01]
 [1.56317922e+03 9.31933482e+02]
 [1.26284435e+03 6.49905503e+02]
 [1.06198962e+03 5.50085018e+02]]
Train Epoch2 Acc 0.13441071428571427 (75270/560000), AUC 0.5179843902587891
Test Epoch2 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch2 layer1 Acc 0.9842571428571428, AUC 0.9984774589538574
Test Epoch2 layer2 Acc 0.037157142857142854, AUC 0.40077129006385803
Test Epoch2 layer3 Acc 0.0696, AUC 0.5555674433708191
Test Epoch2 layer4 Acc 0.14668571428571428, AUC 0.518894612789154
gc 0
[[4.44061607e+03 8.14296485e+01]
 [4.09456548e-04 1.09541754e+01]
 [1.56145345e+03 9.35636593e+02]
 [1.26184811e+03 6.52155631e+02]
 [1.06118159e+03 5.49424548e+02]]
Train Epoch3 Acc 0.1591642857142857 (89132/560000), AUC 0.5215234160423279
Test Epoch3 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch3 layer1 Acc 0.9842285714285715, AUC 0.9984839558601379
Test Epoch3 layer2 Acc 0.05052857142857143, AUC 0.4047323167324066
Test Epoch3 layer3 Acc 0.06701428571428572, AUC 0.5541321635246277
Test Epoch3 layer4 Acc 0.19402857142857144, AUC 0.5190628170967102
gc 0
[[4.44061607e+03 8.15074929e+01]
 [4.19013583e-04 1.00037125e+01]
 [1.55898735e+03 9.37112336e+02]
 [1.26041670e+03 6.54698610e+02]
 [1.06002616e+03 5.48959487e+02]]
Train Epoch4 Acc 0.20924642857142858 (117178/560000), AUC 0.5217579007148743
Test Epoch4 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch4 layer1 Acc 0.9848, AUC 0.9984222650527954
Test Epoch4 layer2 Acc 0.04937142857142857, AUC 0.40044334530830383
Test Epoch4 layer3 Acc 0.06388571428571428, AUC 0.560210645198822
Test Epoch4 layer4 Acc 0.21527142857142856, AUC 0.5249341130256653
gc 0
[[4.44061607e+03 8.15188433e+01]
 [7.23127316e-05 8.92190987e+00]
 [1.55761056e+03 9.38372868e+02]
 [1.25960529e+03 6.56256479e+02]
 [1.05937659e+03 5.48827099e+02]]
Train Epoch5 Acc 0.21924464285714285 (122777/560000), AUC 0.5208967924118042
Test Epoch5 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch5 layer1 Acc 0.9854285714285714, AUC 0.9984397292137146
Test Epoch5 layer2 Acc 0.0555, AUC 0.4006943702697754
Test Epoch5 layer3 Acc 0.0559, AUC 0.5577338337898254
Test Epoch5 layer4 Acc 0.22035714285714286, AUC 0.5231152176856995
gc 0
[[4.44061607e+03 8.15016752e+01]
 [1.01340985e-04 8.46600141e+00]
 [1.55702165e+03 9.39449851e+02]
 [1.25926025e+03 6.57867480e+02]
 [1.05909781e+03 5.48600193e+02]]
Train Epoch6 Acc 0.2231517857142857 (124965/560000), AUC 0.5218809247016907
Test Epoch6 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch6 layer1 Acc 0.9851857142857143, AUC 0.9984116554260254
Test Epoch6 layer2 Acc 0.0576, AUC 0.40334317088127136
Test Epoch6 layer3 Acc 0.0571, AUC 0.5593735575675964
Test Epoch6 layer4 Acc 0.22958571428571428, AUC 0.5214383006095886
gc 0
[[4.44061607e+03 8.14695391e+01]
 [9.79034357e-05 8.06999597e+00]
 [1.55639874e+03 9.40650838e+02]
 [1.25889476e+03 6.59328991e+02]
 [1.05880418e+03 5.48188766e+02]]
Train Epoch7 Acc 0.23130535714285713 (129531/560000), AUC 0.5202718377113342
Test Epoch7 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch7 layer1 Acc 0.9849857142857142, AUC 0.9982730746269226
Test Epoch7 layer2 Acc 0.05715714285714286, AUC 0.4019400477409363
Test Epoch7 layer3 Acc 0.04907142857142857, AUC 0.556831955909729
Test Epoch7 layer4 Acc 0.2334857142857143, AUC 0.5220459699630737
gc 0
[[4.44061607e+03 8.14569700e+01]
 [1.01978829e-04 7.70349928e+00]
 [1.55578509e+03 9.41450730e+02]
 [1.25853583e+03 6.60775068e+02]
 [1.05851827e+03 5.48260781e+02]]
Train Epoch8 Acc 0.2340482142857143 (131067/560000), AUC 0.5210138559341431
Test Epoch8 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch8 layer1 Acc 0.9852285714285715, AUC 0.9982219934463501
Test Epoch8 layer2 Acc 0.06314285714285714, AUC 0.39992862939834595
Test Epoch8 layer3 Acc 0.0543, AUC 0.5599335432052612
Test Epoch8 layer4 Acc 0.23427142857142857, AUC 0.5207992196083069
gc 0
[[4.44061607e+03 8.14347016e+01]
 [1.84430426e-05 7.21330293e+00]
 [1.55544149e+03 9.42148115e+02]
 [1.25833444e+03 6.61659614e+02]
 [1.05835826e+03 5.48256320e+02]]
Train Epoch9 Acc 0.23529107142857142 (131763/560000), AUC 0.519292414188385
Test Epoch9 layer0 Acc 0.9738, AUC 0.9983609318733215
Test Epoch9 layer1 Acc 0.9850714285714286, AUC 0.9981660842895508
Test Epoch9 layer2 Acc 0.06301428571428572, AUC 0.40035152435302734
Test Epoch9 layer3 Acc 0.05331428571428572, AUC 0.5602079629898071
Test Epoch9 layer4 Acc 0.23388571428571428, AUC 0.5201863646507263
Best AUC 0.998566210269928
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l5_m2.pt
[[4674   46   25   15   11   80   42    9    4    6    4   20   21   43]
 [  32 4910    2    1    7    0   26    4    2    2    1    0    4    9]
 [  30   13 4634   18   51    1   10    3    6    0    1   74   21  138]
 [   3    2   31 4949   10    1    1    0    0    0    0    0    0    3]
 [   8   20   75   13 4849    8    6    2    2    1    0    1    3   12]
 [  30    1    3    3    1 4948    5    3    1    2    0    0    1    2]
 [  58   53    4    3   10   16 4792   41    9    5    1    1    4    3]
 [   0    1    0    0    2    0   12 4962   18    3    1    0    0    1]
 [   1    3    2    0    3    0   11   15 4964    1    0    0    0    0]
 [   1    0    1    2    0    0    0    8    0 4950   37    0    0    1]
 [  12    1    0    0    0    0    1    5    0   31 4950    0    0    0]
 [   5    0   45    2    0    0    1    1    0    1    0 4915   17   13]
 [   7    2   25    5    2    4    1    3    1    2    0   22 4880   46]
 [  30    5   87    8   12    3    4    9    1    4    3    5   40 4789]]
Figure(640x480)
[[4767   41   23    3   11   37   53    4    0    2    2   12    5   40]
 [  34 4912    5    0    6    0   34    1    1    0    0    1    0    6]
 [  16    4 4864    5   66    1    5    0    0    0    0   13    6   20]
 [   1    1   35 4940   18    2    1    0    0    0    0    2    0    0]
 [   5    4   65    5 4903    5    6    0    0    3    0    0    2    2]
 [  36    0    2    0    1 4952    4    2    0    0    0    0    1    2]
 [  46   30    5    0    6   12 4874   17    4    3    0    1    0    2]
 [   2    0    0    0    0    1   21 4966    7    0    0    1    1    1]
 [   1    1    1    0    3    0   10    7 4974    0    0    0    0    3]
 [   1    0    2    1    0    0    0    4    0 4963   27    0    1    1]
 [  13    1    1    0    0    0    1    1    0   26 4956    1    0    0]
 [   4    0   16    1    0    0    0    0    0    0    0 4963    9    7]
 [   4    1   22    0    1    2    2    0    0    0    0   22 4905   41]
 [  29    2   40    1    5    3    2    0    0    1    2    8   14 4893]]
Figure(640x480)
[[   6    1    0    0    3    0    0 4717    0   18  211    7    0   37]
 [  74    0    0    1    5    0    0   78    0   87   21    1    0 4733]
 [   2    0    0    0   10    0    0  158    0 4424    7  392    0    7]
 [   1    0    0    0    0    0    0 4975    0   23    0    0    0    1]
 [   2    0    0    0    0    0    0 4950    0   45    0    1    0    2]
 [   1    1    0    0    0    0    0 4970    0    4    0   23    0    1]
 [ 216    2    1    0   21    0    0 4699    0    3    5   22    0   31]
 [4957    0    0    0    0    0    0   27    0   10    5    0    0    1]
 [  12    0    0    0    0    0    0   35    0 4837    1    0  111    4]
 [   3    8    0    0    0    0    0 4978    0    3    0    8    0    0]
 [   6 3518    0    0    9    0    0 1199    0   73  117    0    0   78]
 [   0    0    0    0   12    0    0 3260    0    5    0 1723    0    0]
 [   0    0   11    0   19    0    0 4889    0    7   67    7    0    0]
 [   1    0    0    0    0    0    0 4886    0   34    4   21    0   54]]
Figure(640x480)
[[   0  177    0 3002    6   15    0  628   96  101  874   76   25    0]
 [   0   37    0    4    0    8    0    1    0    2  139   19 4790    0]
 [   2   22    0    5    4   63    0    0    0 3052  251   12 1589    0]
 [   1    4    0   12 2989   12    0   61    0    3 1868   27   23    0]
 [  93   60    0    4    1 4716    0    0    0   17   81   10   18    0]
 [   0    0    0 4005    0    0    0    1    0    0    8  986    0    0]
 [   1  135    0   11    0    4    0    0    0    4   40 4786   19    0]
 [   0    6    0    0    0    1    0    0    0    1 4770  222    0    0]
 [   0    3    0    0    0    2    0    0    0 4117  280  597    1    0]
 [   0    2    0    0    0    1    0 4896    0    9   60   10   22    0]
 [   0    9    0    8    0    0    0   61    0    1 4909    8    4    0]
 [   7   22    0    4 4176   12    0    0    0   87    4    0  688    0]
 [   1    7    0   18   10 4905    0    1    0    9   13    3   33    0]
 [   2   14    0  162    4  859    0    1    0   13 3930    1   14    0]]
Figure(640x480)
[[   0    0    0   14    0    0    0  283   19    3   18 4663    0    0]
 [   0    0    0  141    0    0    0   90 4627   19    0  123    0    0]
 [   0    0    0   77    0    0    0 1301    1    1    5 3615    0    0]
 [   0    2    0  264    0    0    0   76    0    3    0 4655    0    0]
 [   0    0    0 4883    0    0    0   25    4   11    2   75    0    0]
 [  12    0    0    2    0    0    0 4152    0    0  819   15    0    0]
 [   0    1    0    7    0    0    0 4890   18    2   21   55    6    0]
 [  13 2790    0   15    0    0    0 2036    0    0  137    9    0    0]
 [   0    1    0    2    0    0    0 4954   41    0    0    2    0    0]
 [   2    7    0   72    0    0    0   96    0 4802    0    8   13    0]
 [   9  518    0   12    0    0    0 4425    0    9    0   25    2    0]
 [   0    0    0   11    0    0    0 2914    0    4    0 2042   29    0]
 [   0    0    0 1120    0    0    0 3777    0    3    0  100    0    0]
 [   0    0    0    9    0    0    0 4942    0    0    2   47    0    0]]
Figure(640x480)
