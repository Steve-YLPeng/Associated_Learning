total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l5_m2.pt
Start Training
gc 9
[[4.44061607e+03 8.08663944e+01]
 [2.50137667e-04 5.09280079e+01]
 [4.48058974e+01 6.39226963e+01]
 [1.39651859e+03 1.08440907e+03]
 [1.10242067e+03 8.45005072e+02]]
Train Epoch0 Acc 0.04542857142857143 (25440/560000), AUC 0.5690227746963501
Test Epoch0 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch0 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch0 layer2 Acc 0.9747714285714286, AUC 0.9985327124595642
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l5_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.017785714285714287, AUC 0.45458731055259705
Test Epoch0 layer4 Acc 0.10298571428571429, AUC 0.5658066868782043
gc 0
[[4.44061607e+03 8.07953182e+01]
 [2.50137668e-04 5.08928529e+01]
 [1.79491108e-11 4.25360754e+01]
 [1.41662742e+03 1.16053428e+03]
 [1.11462641e+03 9.02671256e+02]]
Train Epoch1 Acc 0.10308928571428572 (57730/560000), AUC 0.5610309839248657
Test Epoch1 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch1 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch1 layer2 Acc 0.9748857142857142, AUC 0.9985345005989075
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l5_m3.pt  ,ep 1
Test Epoch1 layer3 Acc 0.04012857142857143, AUC 0.4343193471431732
Test Epoch1 layer4 Acc 0.10272857142857143, AUC 0.5704575181007385
gc 0
[[4.44061607e+03 8.08622926e+01]
 [2.50137668e-04 5.09271568e+01]
 [1.53800975e-04 3.90985271e+01]
 [1.41651867e+03 1.26772506e+03]
 [1.11453641e+03 9.75025081e+02]]
Train Epoch2 Acc 0.10123214285714285 (56690/560000), AUC 0.5710938572883606
Test Epoch2 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch2 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch2 layer2 Acc 0.9750714285714286, AUC 0.9985889196395874
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l5_m3.pt  ,ep 2
Test Epoch2 layer3 Acc 0.04282857142857143, AUC 0.4326849579811096
Test Epoch2 layer4 Acc 0.10011428571428571, AUC 0.57755047082901
gc 0
[[4.44061607e+03 8.08887515e+01]
 [2.50137668e-04 5.09365110e+01]
 [3.61165626e-04 3.63514163e+01]
 [1.41536295e+03 1.37790031e+03]
 [1.11372001e+03 1.05981377e+03]]
Train Epoch3 Acc 0.10314642857142857 (57762/560000), AUC 0.574474036693573
Test Epoch3 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch3 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch3 layer2 Acc 0.9754428571428572, AUC 0.9985048174858093
Test Epoch3 layer3 Acc 0.04474285714285714, AUC 0.43884992599487305
Test Epoch3 layer4 Acc 0.10757142857142857, AUC 0.5791453719139099
gc 0
[[4.44061607e+03 8.08687872e+01]
 [2.50137668e-04 5.09288115e+01]
 [3.53743796e-04 3.38773104e+01]
 [1.41366934e+03 1.47964776e+03]
 [1.11257385e+03 1.14180153e+03]]
Train Epoch4 Acc 0.107325 (60102/560000), AUC 0.5767887234687805
Test Epoch4 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch4 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch4 layer2 Acc 0.9757714285714286, AUC 0.9984895586967468
Test Epoch4 layer3 Acc 0.047228571428571425, AUC 0.44614195823669434
Test Epoch4 layer4 Acc 0.10597142857142858, AUC 0.5814372301101685
gc 0
[[4.44061607e+03 8.08458700e+01]
 [2.50137668e-04 5.09289958e+01]
 [6.26892143e-05 3.19000999e+01]
 [1.41275272e+03 1.55179507e+03]
 [1.11194096e+03 1.20137117e+03]]
Train Epoch5 Acc 0.10529107142857143 (58963/560000), AUC 0.578005313873291
Test Epoch5 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch5 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch5 layer2 Acc 0.9758714285714286, AUC 0.9985047578811646
Test Epoch5 layer3 Acc 0.04928571428571429, AUC 0.4500791132450104
Test Epoch5 layer4 Acc 0.1042, AUC 0.5811941027641296
gc 0
[[4.44061607e+03 8.08682050e+01]
 [2.50137667e-04 5.09299635e+01]
 [8.90114109e-05 3.07717841e+01]
 [1.41235800e+03 1.60185824e+03]
 [1.11166954e+03 1.24077648e+03]]
Train Epoch6 Acc 0.10421428571428572 (58360/560000), AUC 0.5782075524330139
Test Epoch6 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch6 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch6 layer2 Acc 0.9758857142857142, AUC 0.9984927177429199
Test Epoch6 layer3 Acc 0.051314285714285715, AUC 0.45240139961242676
Test Epoch6 layer4 Acc 0.10334285714285714, AUC 0.5812568664550781
gc 0
[[4.44061607e+03 8.08652778e+01]
 [2.50137667e-04 5.09321166e+01]
 [9.00545451e-05 2.97265144e+01]
 [1.41193895e+03 1.64636775e+03]
 [1.11138386e+03 1.27698755e+03]]
Train Epoch7 Acc 0.10357142857142858 (58000/560000), AUC 0.578341007232666
Test Epoch7 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch7 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch7 layer2 Acc 0.9761, AUC 0.9984608888626099
Test Epoch7 layer3 Acc 0.05341428571428571, AUC 0.4533102214336395
Test Epoch7 layer4 Acc 0.10275714285714285, AUC 0.5812174677848816
gc 0
[[4.44061607e+03 8.08550267e+01]
 [2.50137668e-04 5.09149746e+01]
 [9.03323486e-05 2.87481133e+01]
 [1.41150721e+03 1.68646182e+03]
 [1.11108928e+03 1.30998379e+03]]
Train Epoch8 Acc 0.10299107142857143 (57675/560000), AUC 0.578123927116394
Test Epoch8 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch8 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch8 layer2 Acc 0.9759714285714286, AUC 0.9984722137451172
Test Epoch8 layer3 Acc 0.054914285714285714, AUC 0.45239943265914917
Test Epoch8 layer4 Acc 0.10207142857142858, AUC 0.5812795758247375
gc 0
[[4.44061607e+03 8.08793360e+01]
 [2.50137668e-04 5.09375968e+01]
 [1.49472577e-05 2.79572089e+01]
 [1.41128643e+03 1.71460103e+03]
 [1.11093782e+03 1.33323229e+03]]
Train Epoch9 Acc 0.10260178571428571 (57457/560000), AUC 0.5780206918716431
Test Epoch9 layer0 Acc 0.9737285714285714, AUC 0.9982925653457642
Test Epoch9 layer1 Acc 0.9743142857142857, AUC 0.9985482096672058
Test Epoch9 layer2 Acc 0.9759714285714286, AUC 0.9984200596809387
Test Epoch9 layer3 Acc 0.055785714285714286, AUC 0.45245108008384705
Test Epoch9 layer4 Acc 0.10168571428571428, AUC 0.5805436968803406
Best AUC 0.9985889196395874
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l5_m3.pt
[[4700   40   23   14   11   67   41    7    4    6    4   18   18   47]
 [  35 4894    1    1    8    0   35    8    3    2    1    1    3    8]
 [  38   13 4606   17   49    2   10    4    5    0    1   86   20  149]
 [   4    1   26 4952   12    1    1    0    0    0    0    1    0    2]
 [  13   14   79   13 4849    8    5    1    2    0    0    1    2   13]
 [  39    1    3    4    1 4939    5    3    1    1    0    0    1    2]
 [  62   42    4    2   10   16 4802   39    9    5    1    1    4    3]
 [   0    0    0    0    2    0   12 4966   15    3    1    0    0    1]
 [   2    3    2    0    4    0   12   13 4964    0    0    0    0    0]
 [   1    0    0    2    1    0    0    8    0 4955   31    1    0    1]
 [  12    1    0    0    0    0    2    5    0   32 4947    1    0    0]
 [   7    0   43    2    0    0    0    0    0    1    0 4920   13   14]
 [  11    2   26    8    1    3    1    3    1    3    0   23 4866   52]
 [  30    5   75    8   11    3    4    9    1    4    4    5   40 4801]]
Figure(640x480)
[[4678   45   20   14   11   65   44    7    2    5    4   34   22   49]
 [  33 4901    2    2    7    0   38    1    2    2    0    0    6    6]
 [  39   14 4554   20   64    2   11    2    4    0    1  124   38  127]
 [   5    2   24 4955   12    1    1    0    0    0    0    0    0    0]
 [   9   16   61   14 4871    9    7    0    2    2    0    0    2    7]
 [  38    1    2    3    1 4944    5    2    1    0    0    0    1    2]
 [  53   37    3    2   10   19 4827   30    5    5    1    1    6    1]
 [   1    1    0    0    2    0   14 4964   13    3    1    0    0    1]
 [   2    2    2    0    5    0   14   14 4961    0    0    0    0    0]
 [   1    0    1    3    0    0    0    6    0 4953   35    0    0    1]
 [  13    1    0    0    0    0    2    3    0   36 4945    0    0    0]
 [   7    0   22    2    0    0    2    0    0    0    0 4942   14   11]
 [   7    1   18    4    1    3    1    2    0    1    0   18 4906   38]
 [  26    4   69    7   11    3    4    4    1    2    2    7   59 4801]]
Figure(640x480)
[[4735   36   21   10   12   52   40    5    1    4    3   24   15   42]
 [  42 4893    3    2    7    0   36    1    2    1    0    0    7    6]
 [  38   13 4651   20   61    2    9    1    1    1    1   77   25  100]
 [   3    2   26 4953   12    1    1    0    0    2    0    0    0    0]
 [  10   10   63   17 4873   10    6    0    2    3    0    0    1    5]
 [  46    1    3    3    1 4935    5    2    1    0    0    0    1    2]
 [  63   41    6    2    9   20 4815   27    3    4    1    1    7    1]
 [   2    1    0    0    2    0   15 4959   13    3    4    0    0    1]
 [   2    3    2    0    5    0   15   15 4958    0    0    0    0    0]
 [   1    0    1    2    0    0    0    6    0 4958   31    0    0    1]
 [  13    1    0    0    0    0    2    1    0   54 4929    0    0    0]
 [   9    0   29    2    0    1    1    0    0    0    0 4934   14   10]
 [   7    1   19    4    0    3    1    2    0    1    0   20 4906   36]
 [  39    4   85    7   11    3    4    5    0    2    3    9   72 4756]]
Figure(640x480)
[[   2    0    0    0    0   36    0 4674    0  259    0    0    0   29]
 [   0    0    0    0    3 2212    0   53    0 2711    0    0    0   21]
 [   0    0    0    6   12 2178  770  265    0 1767    0    0    0    2]
 [   0    0    0    0    0 4993    0    1    0    6    0    0    0    0]
 [   0    0    0    0    0 4831    1   16    0  151    0    0    0    1]
 [   0    0    0    0    0    9    0   20    0 4957    0    0    0   14]
 [   0    0    0    1    0  187    0   76    0  141    0    0    0 4595]
 [   0    0    0    0    0 4094    0    3    0  900    0    0    0    3]
 [   0    0    0    0    0   11    0 4877    0  103    0    0    0    9]
 [   0    0    7    0    0   73    0   12    0 2984    0    0 1924    0]
 [   0    0    0    0    0 2189    0   10    0 2800    0    0    0    1]
 [   0    0    0    0    0 4914    0   23    0   63    0    0    0    0]
 [   0    0    0    0    0 4757    0   27    0  214    0    0    0    2]
 [   0    0    0    0    0  108    0 3687    0 1205    0    0    0    0]]
Figure(640x480)
[[  46    0    1    4    0  653 4245    0   18    0    0    0    0   33]
 [   6    0    0  322    0 4194   13    0    0    0    7    0  443   15]
 [ 653    0    3    0    0  793 2905    0    0    8    0  636    2    0]
 [  35    0    1   11    0 1645   13    0    0    0    0    0  239 3056]
 [ 319    0    4    1    0 4625   40    0    0    0    0    1    0   10]
 [  70    0    0    0    0 4924    6    0    0    0    0    0    0    0]
 [ 416    0    0   15    0 2795 1771    1    0    0    0    0    1    1]
 [2203    0    0   17    0 2210  168  223    0  179    0    0    0    0]
 [  30    0  910    7    0 3940  102    8    2    0    0    1    0    0]
 [   9    0    0 3574    0 1244   35   68    0   27    0    0   43    0]
 [   4    0    0  119    0   15 4860    0    0    2    0    0    0    0]
 [  80    0    0    0    0 4095  816    0    0    0    0    1    7    1]
 [  61    0    0    1    0 4297  599    0    0    0    0    0    0   42]
 [1489    0    0    2    0 3482   22    0    5    0    0    0    0    0]]
Figure(640x480)
