total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l5_m4_prefix.pt
Start Training
gc 9
[[4.44061607e+03 8.35236794e+01]
 [5.25537862e-04 9.99804975e+00]
 [9.71853989e-04 8.83641139e+00]
 [1.72706867e-03 8.54394354e+00]
 [3.96096215e+01 1.31584645e+01]]
Train Epoch0 Acc 0.9683196428571429 (542259/560000), AUC 0.9974426031112671
Test Epoch0 layer0 Acc 0.9733571428571428, AUC 0.9983119368553162
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l5_m5_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9854428571428572, AUC 0.9985976815223694
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l5_m5_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9856, AUC 0.9985398054122925
Test Epoch0 layer3 Acc 0.9855285714285714, AUC 0.9978770017623901
Test Epoch0 layer4 Acc 0.9854285714285714, AUC 0.9975627064704895
gc 0
[[4.44061607e+03 8.34646006e+01]
 [4.25008399e-04 9.28123079e+00]
 [7.70415520e-04 8.21294806e+00]
 [1.31736131e-03 7.87480785e+00]
 [5.79603828e-04 7.41493889e+00]]
Train Epoch1 Acc 0.9909375 (554925/560000), AUC 0.998647153377533
Test Epoch1 layer0 Acc 0.9736857142857143, AUC 0.9982833862304688
Test Epoch1 layer1 Acc 0.9852, AUC 0.9983939528465271
Test Epoch1 layer2 Acc 0.9851428571428571, AUC 0.9982777833938599
Test Epoch1 layer3 Acc 0.9850857142857142, AUC 0.9977450966835022
Test Epoch1 layer4 Acc 0.9851142857142857, AUC 0.9976240992546082
gc 0
[[4.44061607e+03 8.33569083e+01]
 [4.23806746e-04 8.64745509e+00]
 [7.66489171e-04 7.66804797e+00]
 [1.29656521e-03 7.33279504e+00]
 [1.72872077e-03 6.85736846e+00]]
Train Epoch2 Acc 0.9916303571428572 (555313/560000), AUC 0.9988106489181519
Test Epoch2 layer0 Acc 0.9736571428571429, AUC 0.998299241065979
Test Epoch2 layer1 Acc 0.9856571428571429, AUC 0.9985136985778809
Test Epoch2 layer2 Acc 0.9855857142857143, AUC 0.9982987642288208
Test Epoch2 layer3 Acc 0.9855428571428572, AUC 0.9977070093154907
Test Epoch2 layer4 Acc 0.9855142857142857, AUC 0.997750461101532
gc 0
[[4.44061607e+03 8.33291931e+01]
 [4.17385746e-04 8.06618468e+00]
 [7.45346876e-04 7.15338461e+00]
 [1.25692263e-03 6.83426727e+00]
 [1.98273744e-03 6.37048937e+00]]
Train Epoch3 Acc 0.9924232142857143 (555757/560000), AUC 0.998898446559906
Test Epoch3 layer0 Acc 0.9737285714285714, AUC 0.9983333945274353
Test Epoch3 layer1 Acc 0.9850428571428571, AUC 0.998369038105011
Test Epoch3 layer2 Acc 0.9850142857142857, AUC 0.998261034488678
Test Epoch3 layer3 Acc 0.9849714285714286, AUC 0.997498631477356
Test Epoch3 layer4 Acc 0.9850142857142857, AUC 0.9976469278335571
gc 0
[[4.44061607e+03 8.31776984e+01]
 [4.16597769e-04 7.54923451e+00]
 [7.58418183e-04 6.69955162e+00]
 [1.28554152e-03 6.40535208e+00]
 [2.05839471e-03 5.96559078e+00]]
Train Epoch4 Acc 0.9929607142857143 (556058/560000), AUC 0.9989622831344604
Test Epoch4 layer0 Acc 0.9733285714285714, AUC 0.998286247253418
Test Epoch4 layer1 Acc 0.9855428571428572, AUC 0.9982742667198181
Test Epoch4 layer2 Acc 0.9854, AUC 0.9980219006538391
Test Epoch4 layer3 Acc 0.9853571428571428, AUC 0.997373104095459
Test Epoch4 layer4 Acc 0.9853714285714286, AUC 0.9976645708084106
gc 0
[[4.44061607e+03 8.17592603e+01]
 [6.73857831e-05 6.49174568e+00]
 [1.21582520e-04 5.70189026e+00]
 [2.06340290e-04 5.42378236e+00]
 [8.65982350e-04 5.06055735e+00]]
Train Epoch5 Acc 0.9939 (556584/560000), AUC 0.9990519285202026
Test Epoch5 layer0 Acc 0.9734, AUC 0.9983000755310059
Test Epoch5 layer1 Acc 0.9853428571428572, AUC 0.998270571231842
Test Epoch5 layer2 Acc 0.9853857142857143, AUC 0.9980550408363342
Test Epoch5 layer3 Acc 0.9853571428571428, AUC 0.9972674250602722
Test Epoch5 layer4 Acc 0.9853571428571428, AUC 0.9974226951599121
gc 0
[[4.44061607e+03 8.16546900e+01]
 [1.01970962e-04 6.16696339e+00]
 [1.86017963e-04 5.39674446e+00]
 [3.17169111e-04 5.13084583e+00]
 [1.14869104e-03 4.78266446e+00]]
Train Epoch6 Acc 0.9942660714285714 (556789/560000), AUC 0.9990448355674744
Test Epoch6 layer0 Acc 0.9733285714285714, AUC 0.9983105659484863
Test Epoch6 layer1 Acc 0.9852714285714286, AUC 0.9982419013977051
Test Epoch6 layer2 Acc 0.9854, AUC 0.998082160949707
Test Epoch6 layer3 Acc 0.9853571428571428, AUC 0.9972044229507446
Test Epoch6 layer4 Acc 0.9854571428571428, AUC 0.9974725842475891
gc 0
[[4.44061607e+03 8.16232685e+01]
 [1.02919880e-04 5.86764482e+00]
 [1.85603966e-04 5.11670623e+00]
 [3.14145391e-04 4.86019956e+00]
 [4.30854876e-04 4.48290247e+00]]
Train Epoch7 Acc 0.9946839285714286 (557023/560000), AUC 0.9990268349647522
Test Epoch7 layer0 Acc 0.9735142857142857, AUC 0.9982942938804626
Test Epoch7 layer1 Acc 0.9852428571428572, AUC 0.9980984926223755
Test Epoch7 layer2 Acc 0.9853428571428572, AUC 0.9978852272033691
Test Epoch7 layer3 Acc 0.9853, AUC 0.997042179107666
Test Epoch7 layer4 Acc 0.9852571428571428, AUC 0.9972614645957947
gc 0
[[4.44061607e+03 8.16224622e+01]
 [1.04252033e-04 5.58077993e+00]
 [1.92780010e-04 4.85709845e+00]
 [3.30238464e-04 4.61549387e+00]
 [5.22753639e-04 4.26141729e+00]]
Train Epoch8 Acc 0.994925 (557158/560000), AUC 0.9990115761756897
Test Epoch8 layer0 Acc 0.9735714285714285, AUC 0.9983221292495728
Test Epoch8 layer1 Acc 0.9851714285714286, AUC 0.9980577230453491
Test Epoch8 layer2 Acc 0.9853142857142857, AUC 0.9977512955665588
Test Epoch8 layer3 Acc 0.9853, AUC 0.9967766404151917
Test Epoch8 layer4 Acc 0.9853142857142857, AUC 0.9970442056655884
gc 0
[[4.44061607e+03 8.08718380e+01]
 [1.66088900e-05 5.07579184e+00]
 [3.04480220e-05 4.37864829e+00]
 [5.25441638e-05 4.14789992e+00]
 [2.26039331e-04 3.83783703e+00]]
Train Epoch9 Acc 0.9953678571428571 (557406/560000), AUC 0.9990280270576477
Test Epoch9 layer0 Acc 0.9737, AUC 0.998287558555603
Test Epoch9 layer1 Acc 0.9850428571428571, AUC 0.9980148673057556
Test Epoch9 layer2 Acc 0.9851428571428571, AUC 0.9976511001586914
Test Epoch9 layer3 Acc 0.9850714285714286, AUC 0.9966927170753479
Test Epoch9 layer4 Acc 0.9850714285714286, AUC 0.9970747232437134
Best AUC 0.9985976815223694
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l5_m5_prefix.pt
[[4696   42   22   14   12   67   42    7    4    6    4   22   19   43]
 [  36 4893    2    3    7    0   32    7    6    2    1    0    4    7]
 [  40   14 4598   18   52    1   12    4    7    0    1   92   23  138]
 [   2    2   29 4951   12    0    1    0    0    0    0    1    0    2]
 [  11   19   76   12 4847    9    7    1    2    1    0    2    2   11]
 [  38    2    3    4    1 4938    5    4    1    1    0    0    1    2]
 [  63   48    1    3   10   15 4794   41   11    5    1    1    5    2]
 [   0    0    0    0    2    0   11 4965   17    3    1    0    0    1]
 [   1    3    2    0    3    0   11   12 4967    1    0    0    0    0]
 [   1    0    1    2    1    0    0    7    0 4953   34    0    0    1]
 [  12    1    0    0    0    0    2    4    1   32 4947    1    0    0]
 [   4    0   37    2    0    0    0    0    0    1    0 4928   14   14]
 [   8    2   19    5    1    2    1    3    1    2    0   24 4883   49]
 [  33    7   80    8   13    3    4   11    2    5    4    8   47 4775]]
Figure(640x480)
[[4810   44   12    2   13   26   48    2    1    1    1    6    7   27]
 [  30 4927    0    0    8    0   27    1    1    1    0    0    0    5]
 [  20    5 4852    6   69    1    6    0    1    1    0   12    5   22]
 [   0    1   14 4966   13    2    2    0    0    0    0    1    0    1]
 [   5    4   57    7 4911    2    6    3    1    1    0    0    2    1]
 [  39    0    1    0    1 4948    4    2    1    1    0    0    2    1]
 [  46   33    1    0    1   13 4871   27    2    2    0    0    3    1]
 [   0    0    0    0    0    1   12 4979    7    0    0    0    0    1]
 [   2    1    1    0    1    0    5    7 4982    0    0    0    0    1]
 [   1    0    1    1    0    1    0    3    0 4973   20    0    0    0]
 [  14    1    0    0    0    0    1    1    0   21 4961    1    0    0]
 [   4    0   10    1    0    0    0    0    0    0    0 4966   12    7]
 [   4    0    6    0    0    0    0    0    0    0    0   18 4938   34]
 [  32    0   27    1    5    4    5    0    0    1    3    3   22 4897]]
Figure(640x480)
[[4811   43   12    2   13   25   49    2    2    1    1    6    7   26]
 [  28 4929    0    0    8    0   28    0    1    1    0    0    0    5]
 [  20    5 4855    7   71    1    5    0    1    1    0   12    4   18]
 [   1    1   12 4966   16    1    2    0    0    0    0    0    1    0]
 [   6    4   53    7 4916    2    5    3    1    0    0    0    2    1]
 [  40    0    1    0    1 4947    4    2    1    1    0    0    2    1]
 [  45   32    1    0    1   13 4875   25    2    2    0    0    2    2]
 [   0    0    0    0    0    1   14 4976    8    0    0    0    0    1]
 [   2    1    1    0    1    0    5    7 4982    0    0    0    0    1]
 [   1    0    1    1    0    1    0    3    0 4972   21    0    0    0]
 [  14    1    0    0    1    1    1    1    0   21 4960    0    0    0]
 [   4    0   10    1    0    0    0    0    0    0    0 4965   12    8]
 [   4    0    4    0    0    0    0    0    0    0    0   19 4941   32]
 [  32    1   27    1    4    4    5    1    0    0    2    3   23 4897]]
Figure(640x480)
[[4810   44   12    2   13   26   48    2    2    1    1    6    7   26]
 [  27 4931    0    0    8    0   27    0    2    1    0    0    0    4]
 [  20    5 4850    8   70    1    5    0    1    1    0   14    5   20]
 [   1    1   11 4966   17    1    2    0    0    0    0    0    1    0]
 [   6    5   54    8 4912    2    5    3    1    1    0    0    2    1]
 [  39    0    1    0    1 4948    4    2    1    1    0    0    2    1]
 [  47   32    1    0    1   13 4874   24    2    2    0    0    2    2]
 [   0    0    0    0    0    1   13 4977    8    0    0    0    0    1]
 [   2    1    1    0    1    0    4    7 4983    0    0    0    0    1]
 [   1    0    1    1    0    1    0    3    0 4972   21    0    0    0]
 [  14    1    0    0    1    1    1    1    0   21 4960    0    0    0]
 [   4    0   10    1    0    0    0    0    0    0    0 4966   11    8]
 [   4    0    4    0    0    0    0    0    0    0    0   20 4940   32]
 [  32    0   26    1    4    4    5    1    0    1    0    4   24 4898]]
Figure(640x480)
[[4810   46   12    2   12   27   46    2    2    1    1    6    8   25]
 [  25 4935    0    0    7    0   26    0    2    1    0    0    0    4]
 [  20    5 4853    6   71    1    5    0    0    1    0   14    5   19]
 [   0    1   11 4968   16    1    2    0    0    0    0    0    1    0]
 [   5    6   51    8 4914    2    5    3    1    2    0    0    2    1]
 [  41    0    1    0    1 4946    4    2    1    1    0    0    2    1]
 [  49   36    1    0    1   12 4869   24    2    2    0    0    3    1]
 [   0    0    0    0    0    1   13 4976    9    0    0    0    0    1]
 [   2    1    1    0    1    0    5    7 4982    0    0    0    0    1]
 [   2    0    1    1    0    1    0    3    0 4970   22    0    0    0]
 [  14    1    0    0    1    1    1    1    0   23 4958    0    0    0]
 [   4    0   10    1    0    0    0    0    0    0    0 4965   13    7]
 [   4    0    5    0    0    0    0    0    0    0    0   18 4941   32]
 [  32    1   28    1    4    4    5    0    0    1    2    3   26 4893]]
Figure(640x480)
