total count words 887880
vocab size 30000
found 28354 words in glove
Start Training
gc 0
[[4561.61167443   62.39745243]
 [1072.67672531  915.29235542]
 [ 866.92408844  558.35698794]
 [ 947.31702286  461.90923611]
 [ 797.27048168  428.48853564]]
Train Epoch0 Acc 0.0707625 (39627/560000), AUC 0.4716165363788605
Test Epoch0 layer0 Acc 0.9732571428571428, AUC 0.9980106949806213
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.11908571428571428, AUC 0.5349316596984863
Test Epoch0 layer2 Acc 0.0849, AUC 0.5158599615097046
Test Epoch0 layer3 Acc 0.03274285714285714, AUC 0.5025268793106079
Test Epoch0 layer4 Acc 0.07041428571428572, AUC 0.4733165204524994
gc 0
[[4440.79461908   66.65119033]
 [1419.22343752 1007.70390336]
 [1077.77915071  629.75916816]
 [1101.19857438  524.89876044]
 [ 903.89812605  476.24693478]]
Train Epoch1 Acc 0.07020714285714286 (39316/560000), AUC 0.4758053719997406
Test Epoch1 layer0 Acc 0.9732285714285714, AUC 0.9981173276901245
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1_prefix.pt  ,ep 1
Test Epoch1 layer1 Acc 0.10987142857142858, AUC 0.5286899209022522
Test Epoch1 layer2 Acc 0.09885714285714285, AUC 0.5153173804283142
Test Epoch1 layer3 Acc 0.03358571428571429, AUC 0.5014001131057739
Test Epoch1 layer4 Acc 0.06967142857142856, AUC 0.47763341665267944
gc 0
[[4440.63223183   74.10365531]
 [1620.38145918 1036.44905213]
 [1188.65919629  657.73465864]
 [1172.52685252  553.1463396 ]
 [ 952.53948936  496.76023523]]
Train Epoch2 Acc 0.06927857142857143 (38796/560000), AUC 0.47982874512672424
Test Epoch2 layer0 Acc 0.9735714285714285, AUC 0.9982021450996399
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1_prefix.pt  ,ep 2
Test Epoch2 layer1 Acc 0.09981428571428572, AUC 0.522955060005188
Test Epoch2 layer2 Acc 0.0961, AUC 0.5130871534347534
Test Epoch2 layer3 Acc 0.03787142857142857, AUC 0.5024763941764832
Test Epoch2 layer4 Acc 0.06852857142857142, AUC 0.48129841685295105
gc 0
[[4440.62059283   80.80955717]
 [1792.91647062 1051.31609084]
 [1278.56179348  677.77200375]
 [1227.48454884  574.54802212]
 [ 989.79354903  511.9465619 ]]
Train Epoch3 Acc 0.06751428571428572 (37808/560000), AUC 0.4839271605014801
Test Epoch3 layer0 Acc 0.9735571428571429, AUC 0.9982313513755798
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1_prefix.pt  ,ep 3
Test Epoch3 layer1 Acc 0.08332857142857143, AUC 0.5166887640953064
Test Epoch3 layer2 Acc 0.08872857142857143, AUC 0.5092846751213074
Test Epoch3 layer3 Acc 0.0426, AUC 0.5036780834197998
Test Epoch3 layer4 Acc 0.06624285714285714, AUC 0.4856395125389099
gc 0
[[4440.61732781   85.34648767]
 [1926.15484095 1050.71953711]
 [1344.73314589  690.34769142]
 [1268.38133234  589.7522248 ]
 [1017.02541409  523.22664659]]
Train Epoch4 Acc 0.06434821428571429 (36035/560000), AUC 0.48712870478630066
Test Epoch4 layer0 Acc 0.9735714285714285, AUC 0.998311460018158
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1_prefix.pt  ,ep 4
Test Epoch4 layer1 Acc 0.06685714285714285, AUC 0.5111926794052124
Test Epoch4 layer2 Acc 0.08315714285714286, AUC 0.505175769329071
Test Epoch4 layer3 Acc 0.04832857142857143, AUC 0.5039287209510803
Test Epoch4 layer4 Acc 0.06232857142857143, AUC 0.4878310561180115
gc 0
[[4440.61607122   85.20006722]
 [1945.80553183 1014.18554518]
 [1353.89927009  685.04387277]
 [1275.62801281  591.55216333]
 [1021.55892533  525.69336374]]
Train Epoch5 Acc 0.059946428571428574 (33570/560000), AUC 0.4882819652557373
Test Epoch5 layer0 Acc 0.9736, AUC 0.9982948899269104
Test Epoch5 layer1 Acc 0.05472857142857143, AUC 0.5079391598701477
Test Epoch5 layer2 Acc 0.07774285714285714, AUC 0.49948424100875854
Test Epoch5 layer3 Acc 0.051757142857142856, AUC 0.5046864748001099
Test Epoch5 layer4 Acc 0.05731428571428571, AUC 0.4895647466182709
gc 0
[[4440.61607122   84.79873397]
 [1945.80553022  974.27506427]
 [1353.89927012  680.47244692]
 [1275.62801102  590.37375766]
 [1021.55892532  526.3208373 ]]
Train Epoch6 Acc 0.055417857142857144 (31034/560000), AUC 0.4899769127368927
Test Epoch6 layer0 Acc 0.9738428571428571, AUC 0.9983004331588745
Test Epoch6 layer1 Acc 0.04997142857142857, AUC 0.5057536363601685
Test Epoch6 layer2 Acc 0.07361428571428572, AUC 0.4939136505126953
Test Epoch6 layer3 Acc 0.0525, AUC 0.503419041633606
Test Epoch6 layer4 Acc 0.05348571428571428, AUC 0.4905325472354889
gc 0
[[4440.61607122   84.46556105]
 [1945.80553198  942.64657381]
 [1353.89926907  680.23312996]
 [1275.62801033  588.8911829 ]
 [1021.55892509  527.13291641]]
Train Epoch7 Acc 0.05340535714285714 (29907/560000), AUC 0.49066027998924255
Test Epoch7 layer0 Acc 0.9734714285714285, AUC 0.9983147382736206
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1_prefix.pt  ,ep 7
Test Epoch7 layer1 Acc 0.05022857142857143, AUC 0.5045039057731628
Test Epoch7 layer2 Acc 0.0664, AUC 0.49106094241142273
Test Epoch7 layer3 Acc 0.054785714285714285, AUC 0.5008900165557861
Test Epoch7 layer4 Acc 0.0528, AUC 0.49165549874305725
gc 0
[[4440.61607122   82.62875227]
 [1945.80553019  927.72459716]
 [1353.89927158  680.94417875]
 [1275.62801141  587.99663083]
 [1021.55892441  527.58162977]]
Train Epoch8 Acc 0.05296785714285714 (29662/560000), AUC 0.4912565350532532
Test Epoch8 layer0 Acc 0.9737857142857143, AUC 0.9983218312263489
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1_prefix.pt  ,ep 8
Test Epoch8 layer1 Acc 0.050814285714285715, AUC 0.504625141620636
Test Epoch8 layer2 Acc 0.06462857142857142, AUC 0.49062302708625793
Test Epoch8 layer3 Acc 0.05614285714285714, AUC 0.5009379982948303
Test Epoch8 layer4 Acc 0.05317142857142857, AUC 0.4916049540042877
gc 0
[[4440.61607122   82.49536282]
 [1945.80553037  922.0697643 ]
 [1353.89927074  681.2128946 ]
 [1275.62801006  587.57513995]
 [1021.55892609  527.73880919]]
Train Epoch9 Acc 0.05353392857142857 (29979/560000), AUC 0.4914020001888275
Test Epoch9 layer0 Acc 0.9737, AUC 0.9983124136924744
Test Epoch9 layer1 Acc 0.05077142857142857, AUC 0.5045770406723022
Test Epoch9 layer2 Acc 0.06347142857142857, AUC 0.48962539434432983
Test Epoch9 layer3 Acc 0.0566, AUC 0.5003836750984192
Test Epoch9 layer4 Acc 0.05391428571428571, AUC 0.49141544103622437
Best AUC 0.9983218312263489
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1_prefix.pt
[[4703   43   23   14   11   68   39    7    4    6    4   19   19   40]
 [  35 4906    2    1    7    0   26    6    3    2    1    0    4    7]
 [  41   14 4591   19   58    1   10    4    5    0    1   91   21  144]
 [   3    2   27 4951   12    1    1    0    0    0    0    0    0    3]
 [  11   18   64   12 4865    9    5    0    2    1    0    0    3   10]
 [  35    2    3    3    1 4944    5    2    1    1    0    0    1    2]
 [  62   55    4    3   11   18 4784   39    9    5    1    1    5    3]
 [   0    1    0    0    2    0   11 4964   17    3    1    0    0    1]
 [   1    4    2    0    3    0   10   12 4968    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4952   36    0    0    1]
 [  14    1    0    0    0    0    2    4    0   30 4949    0    0    0]
 [   7    0   37    3    0    0    0    0    0    1    0 4926   13   13]
 [   9    2   21    5    2    4    1    3    1    2    0   22 4885   43]
 [  35    8   77    9   11    4    4    9    1    5    4    7   49 4777]]
Figure(640x480)
[[ 476   64   24   79 1573  388   42  177   45  337  180   52 1554    9]
 [ 945   60   15   95 1390  410   25  309  231  225  147   83 1064    1]
 [ 905   35  303  315  505 1800   51  166   36  184  175   52  469    4]
 [ 962   61  238  348  550 1688   49  148   30  206  220   54  442    4]
 [ 779   50  189  421  792 1391   47  419   44  182  275   53  357    1]
 [ 211   23   30   40  234  449  304   72   17  169  201  828 2419    3]
 [ 498  319   56   76 1669  630   46  366   10  488  396  143  301    2]
 [2126   13   33   52  654  294  105  132   10  273   43   72 1191    2]
 [1160   34   33    4 3003  157   34   26   28   54   10  100  353    4]
 [2050   66  270   10  603  463  108   24  437   54   21   23  864    7]
 [ 250  337   90    6 2027  682   70   32   61   84  150   11 1196    4]
 [1361   48   24  267  894  362   69  791   60  343  102   88  559   32]
 [ 862   67   46  246 1168  833  114  424   99  231  150  146  613    1]
 [ 804   40   70  158  366 1513  168  227   52  461  112  155  856   18]]
Figure(640x480)
[[  16  163    8    0 3070  104  456  182    0   61  634    1  196  109]
 [ 295   40   15    0 2543  115    7  234    0  197  909    7  566   72]
 [   1  121    3    0 3375  122   16  146    0  484  594    2   50   86]
 [   3  141    0    0 3471   98   25  114    0  400  632    4   69   43]
 [   8   65    4    0 3582  146   16  161    0  233  703    1   32   49]
 [   2   39    2    1 2165  118    4  221    0  287 2080    1   29   51]
 [  59   45    2    0 3632  221   21   75    0   63  416    2  130  334]
 [  23   24    1    0 3169  150    0   64    0  101  335  606  494   33]
 [   0   54   38    0 1646  228    0  247    0  384 1542    0  727  134]
 [   4   37    0    0 2290  122    2  843    0  251   90    1   48 1312]
 [   0  120   34    0 3012  361   21  974    0  137  136    2   58  145]
 [  18   56    6    3 4264   65    9   65    0  190  157    5  107   55]
 [  78   57    4    2 3366  195   15  256    0   93  703    2   98  131]
 [  17   53    5    3 3591  478   40  112    0  176  276   12   47  190]]
Figure(640x480)
[[   0    0    0    0   16    0 2782 2100    0   24    1    2   64   11]
 [   0    1    0    1  492    0 1401 2580    0    2    0    0  516    7]
 [   0    0    0    0    5    0  565 4278    0    1    4    1   84   62]
 [   0    0    0    0    3    0  489 4389    0   14    0    0   41   64]
 [   0    0    0    1    3    0  894 4017    0    2    0    0   34   49]
 [   0    0    0    0   29    0 1428 3433    0    2    0    0   86   22]
 [   0    0    0    0    6    0  984 3807    0    3    0    1   48  151]
 [   0    0    0    0 1655    0  287 2881    0    0   76    2   71   28]
 [   0    0    0    0    2    0 2301 2639    0    0    0    0   49    9]
 [   0    0    0    0    4    0  506 4470    0    1    0    1   18    0]
 [   0    0    0    0    2    0   61 4913    0    1    1    5   10    7]
 [   0    0    0    0   11    0 1603 3321    0    7    0    0   30   28]
 [   0    0    0    0    1    0 2045 2796    0    1    0    1   38  118]
 [   0    0    0    0    4    0  886 4024    0    1    0    0   64   21]]
Figure(640x480)
[[   0    0    0    0    8    0  543  826    0    0    0    0 3623    0]
 [   0    0    0    0    0    0   24   60    0    0    0    0 4916    0]
 [   0    0    0    0    8    0  527  945    0    0    0    0 3520    0]
 [   0    0    0    0    3    0  534  763    0    0    0    0 3700    0]
 [   0    0    0    0    4    0 1003  965    0    0    0    0 3028    0]
 [   0    0    0    0    1    0  548  613    0    0    0    0 3838    0]
 [   0    0    0    0    2    0  682 1813    0    0    0    0 2503    0]
 [   0    0    0    0    3    0  122   51    0    0    0    0 4824    0]
 [   0    0    0    0   30    0  133  545    0    0    0    0 4292    0]
 [   0    0    0    0   10    0   41   33    0    0    0    0 4916    0]
 [   0    0    0    0    9    0  282  294    0    0    0    0 4415    0]
 [   0    0    0    0    5    0  432  924    0    0    0    0 3639    0]
 [   0    0    0    0    8    0   63 1944    0    0    0    0 2985    0]
 [   0    0    0    0    7    0   51  790    0    0    1    0 4151    0]]
Figure(640x480)
