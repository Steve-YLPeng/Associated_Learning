total count words 887880
vocab size 30000
found 28354 words in glove
Start Training
gc 0
[[4561.21476722   63.21069137]
 [1009.65565242           nan]
 [ 742.03944663           nan]
 [ 688.06734586           nan]
 [ 601.0007473            nan]]
Train Epoch0 Acc 0.08363392857142857 (46835/560000), AUC 0.5810445547103882
Test Epoch0 layer0 Acc 0.9723571428571428, AUC 0.9979578852653503
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.1064, AUC 0.541532039642334
Test Epoch0 layer2 Acc 0.03347142857142857, AUC 0.41731444001197815
Test Epoch0 layer3 Acc 0.08684285714285714, AUC 0.5623133778572083
Test Epoch0 layer4 Acc 0.0809, AUC 0.5787011981010437
gc 0
[[4440.80072999   67.97478044]
 [1338.69366789           nan]
 [ 938.45681073           nan]
 [ 829.62027898           nan]
 [ 711.92836305           nan]]
Train Epoch1 Acc 0.07582321428571429 (42461/560000), AUC 0.5712048411369324
Test Epoch1 layer0 Acc 0.9734714285714285, AUC 0.998114287853241
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1_prefix.pt  ,ep 1
Test Epoch1 layer1 Acc 0.11444285714285714, AUC 0.5423144698143005
Test Epoch1 layer2 Acc 0.03192857142857143, AUC 0.41429266333580017
Test Epoch1 layer3 Acc 0.08938571428571429, AUC 0.5619480609893799
Test Epoch1 layer4 Acc 0.07192857142857143, AUC 0.5676751732826233
gc 0
[[4440.63269782   75.76226191]
 [1531.54957518           nan]
 [1046.19053242           nan]
 [ 902.42134374           nan]
 [ 767.16622365           nan]]
Train Epoch2 Acc 0.06724464285714286 (37657/560000), AUC 0.5605219006538391
Test Epoch2 layer0 Acc 0.9736285714285714, AUC 0.9981508851051331
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1_prefix.pt  ,ep 2
Test Epoch2 layer1 Acc 0.11944285714285714, AUC 0.5425837635993958
Test Epoch2 layer2 Acc 0.030357142857142857, AUC 0.4141435921192169
Test Epoch2 layer3 Acc 0.08904285714285715, AUC 0.5611118078231812
Test Epoch2 layer4 Acc 0.06271428571428571, AUC 0.5570579171180725
gc 0
[[4440.62062538   82.76539181]
 [1698.14120558           nan]
 [1134.88072953           nan]
 [ 960.96271272           nan]
 [ 810.46224749           nan]]
Train Epoch3 Acc 0.059314285714285715 (33216/560000), AUC 0.5505664944648743
Test Epoch3 layer0 Acc 0.9734571428571429, AUC 0.998201847076416
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1_prefix.pt  ,ep 3
Test Epoch3 layer1 Acc 0.1232, AUC 0.5417001843452454
Test Epoch3 layer2 Acc 0.029657142857142858, AUC 0.4151681065559387
Test Epoch3 layer3 Acc 0.08738571428571429, AUC 0.5586385130882263
Test Epoch3 layer4 Acc 0.0584, AUC 0.5476993918418884
gc 0
[[4440.6173991    87.53011458]
 [1827.82314399           nan]
 [1200.0284647            nan]
 [1003.52049214           nan]
 [ 840.74372274           nan]]
Train Epoch4 Acc 0.056619642857142854 (31707/560000), AUC 0.5430122017860413
Test Epoch4 layer0 Acc 0.9737857142857143, AUC 0.9982683062553406
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1_prefix.pt  ,ep 4
Test Epoch4 layer1 Acc 0.12592857142857142, AUC 0.541802167892456
Test Epoch4 layer2 Acc 0.03042857142857143, AUC 0.41653087735176086
Test Epoch4 layer3 Acc 0.0872, AUC 0.5541931390762329
Test Epoch4 layer4 Acc 0.05618571428571428, AUC 0.5420976877212524
gc 0
[[4440.61607122   87.41535923]
 [1848.35839078           nan]
 [1209.27315846           nan]
 [1009.5516254            nan]
 [ 844.52949177           nan]]
Train Epoch5 Acc 0.05544107142857143 (31047/560000), AUC 0.5393195152282715
Test Epoch5 layer0 Acc 0.9732, AUC 0.998301088809967
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1_prefix.pt  ,ep 5
Test Epoch5 layer1 Acc 0.12704285714285715, AUC 0.5434648394584656
Test Epoch5 layer2 Acc 0.031714285714285716, AUC 0.4164887070655823
Test Epoch5 layer3 Acc 0.0869, AUC 0.5502727627754211
Test Epoch5 layer4 Acc 0.0548, AUC 0.5390809178352356
gc 0
[[4440.61607122   86.94964756]
 [1848.35839215           nan]
 [1209.27315682           nan]
 [1009.55162613           nan]
 [ 844.52949214           nan]]
Train Epoch6 Acc 0.05442857142857143 (30480/560000), AUC 0.5369746088981628
Test Epoch6 layer0 Acc 0.9736142857142858, AUC 0.9982869029045105
Test Epoch6 layer1 Acc 0.1303, AUC 0.5445421934127808
Test Epoch6 layer2 Acc 0.03187142857142857, AUC 0.4170544147491455
Test Epoch6 layer3 Acc 0.0866, AUC 0.546566903591156
Test Epoch6 layer4 Acc 0.05455714285714286, AUC 0.5369420647621155
gc 0
[[4440.61607122   86.62825016]
 [1848.35839              nan]
 [1209.27315739           nan]
 [1009.55162528           nan]
 [ 844.52949125           nan]]
Train Epoch7 Acc 0.053510714285714286 (29966/560000), AUC 0.5348380208015442
Test Epoch7 layer0 Acc 0.9738142857142857, AUC 0.99828040599823
Test Epoch7 layer1 Acc 0.13178571428571428, AUC 0.5456071496009827
Test Epoch7 layer2 Acc 0.03181428571428571, AUC 0.41858914494514465
Test Epoch7 layer3 Acc 0.0858, AUC 0.5426127314567566
Test Epoch7 layer4 Acc 0.054285714285714284, AUC 0.5363578200340271
gc 0
[[4440.61607122   86.4234305 ]
 [1848.35839161           nan]
 [1209.27315679           nan]
 [1009.55162545           nan]
 [ 844.52949187           nan]]
Train Epoch8 Acc 0.05310892857142857 (29741/560000), AUC 0.5343266129493713
Test Epoch8 layer0 Acc 0.9736571428571429, AUC 0.9982922673225403
Test Epoch8 layer1 Acc 0.13252857142857144, AUC 0.5468364953994751
Test Epoch8 layer2 Acc 0.031471428571428574, AUC 0.4200386106967926
Test Epoch8 layer3 Acc 0.08451428571428571, AUC 0.540349543094635
Test Epoch8 layer4 Acc 0.054271428571428575, AUC 0.5358507633209229
gc 0
[[4440.61607122   84.63690298]
 [1848.35839304           nan]
 [1209.27315894           nan]
 [1009.55162583           nan]
 [ 844.52949262           nan]]
Train Epoch9 Acc 0.05284642857142857 (29594/560000), AUC 0.5343214273452759
Test Epoch9 layer0 Acc 0.9738571428571429, AUC 0.9982886910438538
Test Epoch9 layer1 Acc 0.13184285714285715, AUC 0.5461277365684509
Test Epoch9 layer2 Acc 0.031285714285714285, AUC 0.4195825159549713
Test Epoch9 layer3 Acc 0.08512857142857143, AUC 0.5394468903541565
Test Epoch9 layer4 Acc 0.05392857142857143, AUC 0.5359840393066406
Best AUC 0.998301088809967
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l5_m1_prefix.pt
[[4694   44   22   15   11   68   40   10    4    6    5   19   19   43]
 [  34 4905    1    2    8    0   26    8    4    2    1    0    4    5]
 [  36   13 4614   20   49    2   10    8    7    0    1   97   23  120]
 [   4    1   30 4949   11    1    1    2    0    1    0    0    0    0]
 [  11   17   93   12 4835    9    6    5    3    0    0    0    3    6]
 [  35    1    3    4    1 4942    5    3    1    3    0    0    1    1]
 [  64   51    3    3   11   17 4782   41   15    5    1    1    4    2]
 [   0    1    0    0    2    0   11 4963   18    3    1    0    0    1]
 [   1    4    2    0    3    0    8   12 4970    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4947   41    0    0    1]
 [  12    1    0    0    0    0    2    4    0   32 4949    0    0    0]
 [   6    0   33    2    0    0    0    0    0    0    1 4934   14   10]
 [   9    2   24    9    1    3    1    3    2    2    0   22 4881   41]
 [  34    7   96    8   12    3    5    9    3    5    4    7   48 4759]]
Figure(640x480)
[[ 163    9    6  793    5 1204 1317  160    5  759  241  313    2   23]
 [   3   19    0 3033   43  326  993  346    2    1  223    1    0   10]
 [  37    0    0  493    0 3620  367  234    0  167   56   21    0    5]
 [  19    4    0 3457    0  676  429   80    1    7  128  186    0   13]
 [ 477    0    0 1246    0 1418  843  942    4    5   21   41    2    1]
 [  22    8    0 2528   89   53 1836  275    3   85   23   67    1   10]
 [   4    0    0  382    1   57 4408   41    0    4   97    1    3    2]
 [ 230    3    0  828   37 1656  557  256    0   22 1335   53   20    3]
 [   8    0    5 1226    0  773 1992  175    2  716   19   84    0    0]
 [  78    0    1 1143    8  459  939  546    1  182  206   29  898  510]
 [   5   73    0  585    3 1072  274   60   94 2692   85   12   10   35]
 [  17    0    0  308    0 2242 2164  239    0    5    8    6   10    1]
 [  60   10    0 1889    4 1305 1090  129    0    3  154  149  204    3]
 [  94    7    7 3256    3  853  249  193   24   11  143  102    0   58]]
Figure(640x480)
[[   3   97  132  898    5  640    1 3110    1   11   66   13   22    1]
 [   0  329  245  274   47 1008    1 2971   28   19   23    1   54    0]
 [  11    5   83  512    2   48    0 4174    0   42   61   31   31    0]
 [   2   17   29  338    0 3134    0 1164    0    1  256    0   59    0]
 [   1   12    1  371    0  293    0 3559    0   13   70    2  676    2]
 [   0    9  444  151    5   40    2 4289    4   41   14    1    0    0]
 [  11    8    9  856   13 1931    1 2019    2   24   38   10   67   11]
 [   3    4   78  293  108  307   31 1398   57 2620    5    9   84    3]
 [   0   19  183  799    0  124    0 3756    0    3    1  110    5    0]
 [   2   55   20  856    0 1136    0 2271    0    2  279    3  376    0]
 [   3    3   14 1069    1 2471    0 1393    0    6    2   11   27    0]
 [   5   20  251   69   96  425    0 3818    0  177   45   12   82    0]
 [   1   66  116  455  126  642    0 3160    2  357   15    3   10   47]
 [  10   84   78 1599   17  530    0 2504    0    2   84   39   51    2]]
Figure(640x480)
[[4038    0    2  520    0  316   17    0    0   11    0   11   30   55]
 [2591    0    0  281    9 1188    1    2    0    7    0   32   53  836]
 [1594    0   27 2681  146  108   70    1    0   93    0    8  117  155]
 [2560    0   17  212  192 1298  309    0    0   14    0    4  159  235]
 [2910    2   13  566  459  217   20    0    0   24    0    1   25  763]
 [ 884    0    2 2746    2  767    4    0    0    0    0   56    2  537]
 [2929    0    1 1463    0  570    0    0    0    0    0    5    1   31]
 [1022    0    0  910    4  362   14    1    0    3    0  380   21 2283]
 [2881    0    6  675    0    1    1    0    0    4    0 1129    3  300]
 [1755    1    6  456   19   14   15    0    0  193    0 1229   61 1251]
 [2231    0    7 1415    5   17  821    3    0  273    0   84   10  134]
 [2479    0    0 2262    8   84   10    0    0    2    0   11    3  141]
 [ 777    0    3 2747   48   27   70    1    0   42    0   41   18 1226]
 [3203    0    1  722   66  394   11    1    0    5    0  152   88  357]]
Figure(640x480)
[[  31    4   66    0    3  811   14   13    0 1220    0   27 1153 1658]
 [ 267   41    6    0    0  299   13   56    0  195    0  401  315 3407]
 [   4  146    0    0    1   24    7    6    0  864    0  101  623 3224]
 [  16   29    0    0    0  156    6   51    0  240    0    0 1005 3497]
 [   6   71    0    0    0   14   17    4    0 1359    0   20  948 2561]
 [   3   18    1    0    0   31   88  789    0  360    1   65 3435  209]
 [  74   23   41    0    3   28   38  203    1 1299    0   33 2366  891]
 [  14    0   31    0    0   26  103  106    0  312    0   53 4246  109]
 [  44   53    0    0    0   18    0    4    0  205    0  320 3783  573]
 [   6    4    2    0    0    6  231    3    0  276    0    1 1555 2916]
 [   6    4   33    0    0  107  164    1    0  209    0    1 2785 1690]
 [   2   41   40    0    0   85    9   16    0 2676    0  154 1139  838]
 [  35  369    2    0    0   76   23 1032    0  429    0  186 2571  277]
 [  75   27    1    0    0   32   28  204    1  842    0    6 3196  588]]
Figure(640x480)
