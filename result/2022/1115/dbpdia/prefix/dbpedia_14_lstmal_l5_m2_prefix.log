total count words 887880
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l5_m1_prefix.pt
Start Training
gc 9
[[4440.61607122   84.1378933 ]
 [  54.08443572   41.87006284]
 [1587.31916967  884.08849502]
 [1329.96126527  663.56928299]
 [1093.53120643  590.70440257]]
Train Epoch0 Acc 0.07957857142857143 (44564/560000), AUC 0.4615442752838135
Test Epoch0 layer0 Acc 0.9735571428571429, AUC 0.9983022809028625
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l5_m2_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9822285714285715, AUC 0.9985941052436829
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l5_m2_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.011, AUC 0.49965915083885193
Test Epoch0 layer3 Acc 0.04297142857142857, AUC 0.5380821824073792
Test Epoch0 layer4 Acc 0.07634285714285714, AUC 0.4571223855018616
gc 0
[[4.44061607e+03 8.40367332e+01]
 [2.01050199e-11 1.55023293e+01]
 [1.60777957e+03 9.07820467e+02]
 [1.33936952e+03 6.76755146e+02]
 [1.10128364e+03 5.91894725e+02]]
Train Epoch1 Acc 0.07483214285714286 (41906/560000), AUC 0.4664861857891083
Test Epoch1 layer0 Acc 0.9734428571428572, AUC 0.9983163475990295
Test Epoch1 layer1 Acc 0.9836142857142857, AUC 0.9986791610717773
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l5_m2_prefix.pt  ,ep 1
Test Epoch1 layer2 Acc 0.04195714285714286, AUC 0.5100020170211792
Test Epoch1 layer3 Acc 0.04244285714285714, AUC 0.5445027351379395
Test Epoch1 layer4 Acc 0.07437142857142857, AUC 0.4721863269805908
gc 0
[[4.44061607e+03 8.38748555e+01]
 [1.82612959e-04 1.31282278e+01]
 [1.60765620e+03 9.12253710e+02]
 [1.33929036e+03 6.80177527e+02]
 [1.10122254e+03 5.90747696e+02]]
Train Epoch2 Acc 0.07507857142857143 (42044/560000), AUC 0.48125141859054565
Test Epoch2 layer0 Acc 0.9736428571428571, AUC 0.9983092546463013
Test Epoch2 layer1 Acc 0.9841285714285715, AUC 0.9985619187355042
Test Epoch2 layer2 Acc 0.0595, AUC 0.5187539458274841
Test Epoch2 layer3 Acc 0.038785714285714284, AUC 0.5486713647842407
Test Epoch2 layer4 Acc 0.07468571428571429, AUC 0.48851314187049866
gc 0
[[4.44061607e+03 8.36952160e+01]
 [4.24903434e-04 1.17689553e+01]
 [1.60653490e+03 9.15546086e+02]
 [1.33873189e+03 6.81199755e+02]
 [1.10076337e+03 5.90553516e+02]]
Train Epoch3 Acc 0.07500357142857143 (42002/560000), AUC 0.4954604208469391
Test Epoch3 layer0 Acc 0.9737, AUC 0.9983077049255371
Test Epoch3 layer1 Acc 0.9845285714285714, AUC 0.9984458088874817
Test Epoch3 layer2 Acc 0.07312857142857143, AUC 0.5213339328765869
Test Epoch3 layer3 Acc 0.03811428571428571, AUC 0.5514959096908569
Test Epoch3 layer4 Acc 0.07548571428571428, AUC 0.49988651275634766
gc 0
[[4.44061607e+03 8.36296685e+01]
 [4.33437744e-04 1.07641285e+01]
 [1.60487075e+03 9.18433947e+02]
 [1.33792989e+03 6.82048118e+02]
 [1.10009627e+03 5.89563238e+02]]
Train Epoch4 Acc 0.07737857142857144 (43332/560000), AUC 0.5014732480049133
Test Epoch4 layer0 Acc 0.9739142857142857, AUC 0.9983015656471252
Test Epoch4 layer1 Acc 0.9850857142857142, AUC 0.9985043406486511
Test Epoch4 layer2 Acc 0.08778571428571429, AUC 0.5202100872993469
Test Epoch4 layer3 Acc 0.03901428571428572, AUC 0.5573710799217224
Test Epoch4 layer4 Acc 0.07892857142857143, AUC 0.5063201189041138
gc 0
[[4.44061607e+03 8.20302625e+01]
 [7.53499531e-05 9.39441445e+00]
 [1.60393261e+03 9.21886751e+02]
 [1.33747740e+03 6.83021017e+02]
 [1.09971037e+03 5.89525327e+02]]
Train Epoch5 Acc 0.07855357142857143 (43990/560000), AUC 0.5106921792030334
Test Epoch5 layer0 Acc 0.9735571428571429, AUC 0.9982871413230896
Test Epoch5 layer1 Acc 0.9853, AUC 0.9985069632530212
Test Epoch5 layer2 Acc 0.09381428571428571, AUC 0.5136519074440002
Test Epoch5 layer3 Acc 0.041557142857142855, AUC 0.556308925151825
Test Epoch5 layer4 Acc 0.07704285714285715, AUC 0.5100810527801514
gc 0
[[4.44061607e+03 8.19461713e+01]
 [1.04577453e-04 8.90390659e+00]
 [1.60352893e+03 9.24078197e+02]
 [1.33728261e+03 6.84005161e+02]
 [1.09954975e+03 5.89885783e+02]]
Train Epoch6 Acc 0.07863571428571428 (44036/560000), AUC 0.5138117074966431
Test Epoch6 layer0 Acc 0.9734571428571429, AUC 0.9983057975769043
Test Epoch6 layer1 Acc 0.9851571428571428, AUC 0.9984318614006042
Test Epoch6 layer2 Acc 0.0899, AUC 0.5136803388595581
Test Epoch6 layer3 Acc 0.04692857142857143, AUC 0.554981529712677
Test Epoch6 layer4 Acc 0.0771, AUC 0.5147184729576111
gc 0
[[4.44061607e+03 8.18570222e+01]
 [1.07202582e-04 8.51433702e+00]
 [1.60311018e+03 9.26003273e+02]
 [1.33707241e+03 6.84806093e+02]
 [1.09937737e+03 5.90133033e+02]]
Train Epoch7 Acc 0.07866428571428571 (44052/560000), AUC 0.5170192122459412
Test Epoch7 layer0 Acc 0.9735, AUC 0.9982923269271851
Test Epoch7 layer1 Acc 0.9853571428571428, AUC 0.9983988404273987
Test Epoch7 layer2 Acc 0.0995, AUC 0.5098063945770264
Test Epoch7 layer3 Acc 0.04471428571428571, AUC 0.5599791407585144
Test Epoch7 layer4 Acc 0.08125714285714286, AUC 0.5163447260856628
gc 0
[[4.44061607e+03 8.18483248e+01]
 [1.01127532e-04 8.13420425e+00]
 [1.60269213e+03 9.27879695e+02]
 [1.33686740e+03 6.84964570e+02]
 [1.09920706e+03 5.90340462e+02]]
Train Epoch8 Acc 0.08002678571428572 (44815/560000), AUC 0.5161707401275635
Test Epoch8 layer0 Acc 0.9737285714285714, AUC 0.998313307762146
Test Epoch8 layer1 Acc 0.9852285714285715, AUC 0.9983873963356018
Test Epoch8 layer2 Acc 0.11574285714285715, AUC 0.5095894932746887
Test Epoch8 layer3 Acc 0.05227142857142857, AUC 0.5596144199371338
Test Epoch8 layer4 Acc 0.08317142857142858, AUC 0.5188000798225403
gc 0
[[4.44061607e+03 8.10275127e+01]
 [1.71052933e-05 7.46968604e+00]
 [1.60245667e+03 9.29948403e+02]
 [1.33675197e+03 6.85538595e+02]
 [1.09911284e+03 5.90603562e+02]]
Train Epoch9 Acc 0.08048214285714286 (45070/560000), AUC 0.5176824331283569
Test Epoch9 layer0 Acc 0.9737428571428571, AUC 0.998304545879364
Test Epoch9 layer1 Acc 0.9853285714285714, AUC 0.9983552694320679
Test Epoch9 layer2 Acc 0.1129, AUC 0.5110284090042114
Test Epoch9 layer3 Acc 0.0506, AUC 0.5570911765098572
Test Epoch9 layer4 Acc 0.07962857142857142, AUC 0.5171239972114563
Best AUC 0.9986791610717773
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l5_m2_prefix.pt
[[4694   40   24   14   11   70   38    8    4    6    4   22   20   45]
 [  37 4891    3    3    5    0   31    9    3    2    1    0    5   10]
 [  36   14 4617   17   46    1    9    3    5    0    1   89   24  138]
 [   4    1   30 4950   11    0    1    0    0    0    0    0    0    3]
 [  10   19   86   12 4836    9    5    1    2    0    0    1    3   16]
 [  36    1    3    3    1 4942    5    3    1    2    0    0    1    2]
 [  67   48    4    3   10   17 4787   42    9    5    1    1    5    1]
 [   0    1    0    0    2    0   12 4963   17    3    1    0    0    1]
 [   1    4    2    0    3    0   11   12 4967    0    0    0    0    0]
 [   1    0    1    2    0    0    0    7    0 4955   33    0    0    1]
 [  12    1    0    0    0    0    2    4    0   33 4947    0    0    1]
 [   5    0   36    2    0    0    0    0    0    1    0 4930   14   12]
 [   9    2   20    5    1    2    1    3    1    2    0   23 4886   45]
 [  33    7   77    9   12    3    4   10    2    5    4    8   50 4776]]
Figure(640x480)
[[4817   33   16    2   11   28   35    3    2    3    4    9    5   32]
 [  49 4899    1    0    8    0   29    3    1    1    0    0    4    5]
 [  19    4 4832   13   68    1    5    0    1    1    0   18    8   30]
 [   2    1   15 4963   15    0    0    0    0    2    1    0    0    1]
 [   5    4   64   10 4898    3    6    2    0    3    0    0    2    3]
 [  45    0    2    0    1 4941    5    2    1    0    0    0    2    1]
 [  57   36    3    0    6   14 4836   30    6    4    0    1    3    4]
 [   0    0    0    0    0    1    8 4979    9    0    0    1    2    0]
 [   3    0    1    0    3    0    6   11 4974    1    0    0    0    1]
 [   1    0    1    0    0    0    0    2    0 4971   23    0    0    2]
 [  13    1    0    0    0    0    1    3    0   30 4951    1    0    0]
 [   5    0   10    1    0    0    0    0    0    0    0 4968   11    5]
 [   6    0   14    0    0    0    1    0    0    0    0   19 4928   32]
 [  31    1   22    1    5    4    1    1    0    3    0   14   21 4896]]
Figure(640x480)
[[ 209    0    0    0    1    1   23   42    0   14 4470    0   21  219]
 [4766    1    1    0    1    1    1    5    0   22   40    0  150   12]
 [  44    4    6    0   11    0    1   56    0 1226 3598    0   50    4]
 [ 137  585    0    0    7    0    0 4011    0  227    7    0    4   22]
 [   8    2    0    0    9    0    0   12    0 4932   31    0    3    3]
 [2957    0    0    0   22    0    0    3    0    2   23    0   28 1965]
 [  50    0    1    0   81    4   16    5    0   40  131    0 2270 2402]
 [  30    0  128    0  119    7  224 2661    0    0  421  878  498   34]
 [   0    0    0    0    7    2    0    4   15    8    5    0   10 4949]
 [   0    0    0    0   13   67    0   12    0    0    1   53   84 4770]
 [   1    3    0    0    1    0    0    1    0    0   10   41    0 4943]
 [4552  201    0    0  195    1    3   35    0    1   11    0    1    0]
 [4943    1    0    0    0    0    0   43    0    5    6    0    2    0]
 [  48   27    3    0    2    1    2 4377    0  507   24    0    1    8]]
Figure(640x480)
[[   0    0    0    4    0    0  282 4290    0    1    0    1    2  420]
 [  66    0    0   62  364    0    8 3654    0    0  107    0    2  737]
 [   1    0    0    0    0    0  154 4798    0    0    0    0   25   22]
 [   0    0   16    0    0    0    1 4972    0    0    0    0    8    3]
 [   0    0    0    0    0    0    1  715    0    0    0    0 4213   71]
 [   0    0    0    0    1    0 4548  131    0    0    0    0    0  320]
 [   1    0    1   40    0    0 2512 2177    0    0    3    0    1  265]
 [   0    0    4 2877 1658    0    2  447    0    0    9    3    0    0]
 [   0    0  107    6    1    0    0 4222    0    0    1  663    0    0]
 [   0    0    0   18    0    0   43 4939    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 4998    0    0    0    0    0    2]
 [   0    0    1    0    0    0 3523   44    0    0    0    0    3 1429]
 [   1    0    0    0    0    0   11 4714    0    0    0    0    5  269]
 [   0    0    0    0    0    0   18 4974    0    0    0    0    1    7]]
Figure(640x480)
[[  12    0    0    0    3    0 4259  614    0    0    0    0  112    0]
 [  27    0    0    0    0    0   92 2772    0    0    0    0 2006  103]
 [   7    0    0    0    1    0   35 4912    0    0    0    0   45    0]
 [4881    0    0    0    0    0   40   35    0    0    0    0   44    0]
 [   6    0    0    0    0    0   30 4959    0    0    0    0    5    0]
 [ 101    0    0    0    0    0 1690 3197    0    0    0    0   12    0]
 [1724    0    0    0    0    0   33  717    0    0    0    0 2526    0]
 [4338    0    0    0    0    0    2  208    0    0    0    0  452    0]
 [   0    0    0    0    0    0    1 4998    0    0    0    0    1    0]
 [   0    0    0    2    0    0    0    4    0    0    0    0 4994    0]
 [   0    1    0  635    0    0   10  158    0    0    0    0 4196    0]
 [   0    0    0    0    0    0 2299  120    0    0    0    0 2581    0]
 [   0    0    0    0    0    0    8   39    0    0    0    0 4953    0]
 [   4    0    0    0    0    0   18 4899    0    0    0    0   79    0]]
Figure(640x480)
