total count words 887880
vocab size 30000
found 28354 words in glove
Start Training
gc 0
[[9.00285018e+03 1.37249988e+02]
 [9.30523663e+00 5.46838891e+01]
 [9.42594028e+00 3.66205495e+01]
 [8.56424152e+00 3.11456981e+01]
 [6.94553853e+00 2.87418487e+01]]
Train Epoch0 Acc 0.9349071428571428 (523548/560000), AUC 0.9934210181236267
Test Epoch0 layer0 Acc 0.9730285714285715, AUC 0.9981085062026978
Save ckpt to ./ckpt//dbpedia_14/dbpedia_14_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9823, AUC 0.9984654784202576
Save ckpt to ./ckpt//dbpedia_14/dbpedia_14_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9822714285714286, AUC 0.9983102083206177
Test Epoch0 layer3 Acc 0.9822714285714286, AUC 0.9977506995201111
Test Epoch0 layer4 Acc 0.9822285714285715, AUC 0.997736394405365
gc 0
[[8.88125532e+03 1.63077854e+02]
 [1.25231111e-03 2.79757108e+01]
 [2.42557648e-03 2.36546030e+01]
 [3.99529762e-03 2.15158649e+01]
 [6.27038474e-03 1.99908241e+01]]
Train Epoch1 Acc 0.9852571428571428 (551744/560000), AUC 0.997162938117981
Test Epoch1 layer0 Acc 0.9734, AUC 0.9982413649559021
Test Epoch1 layer1 Acc 0.9840714285714286, AUC 0.9985367059707642
Save ckpt to ./ckpt//dbpedia_14/dbpedia_14_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9842857142857143, AUC 0.9982079267501831
Test Epoch1 layer3 Acc 0.9843, AUC 0.9978564381599426
Test Epoch1 layer4 Acc 0.9843285714285714, AUC 0.9979447722434998
gc 0
[[8.88123367e+03 1.79635484e+02]
 [1.46807535e-03 2.59938189e+01]
 [2.80209885e-03 2.21773134e+01]
 [4.55831173e-03 2.00552005e+01]
 [6.94895685e-03 1.84711813e+01]]
Train Epoch2 Acc 0.9873535714285714 (552918/560000), AUC 0.9982566237449646
Test Epoch2 layer0 Acc 0.9734571428571429, AUC 0.9982882738113403
Test Epoch2 layer1 Acc 0.9852, AUC 0.9984697699546814
Test Epoch2 layer2 Acc 0.9853571428571428, AUC 0.9983246922492981
Test Epoch2 layer3 Acc 0.9852714285714286, AUC 0.997876763343811
Test Epoch2 layer4 Acc 0.9852571428571428, AUC 0.9977070689201355
gc 0
[[8.88123214e+03 1.77747228e+02]
 [1.47747392e-03 2.30186934e+01]
 [2.81309007e-03 1.99369119e+01]
 [4.55644937e-03 1.79591644e+01]
 [6.88306034e-03 1.64949009e+01]]
Train Epoch3 Acc 0.9886660714285714 (553653/560000), AUC 0.9985172152519226
Test Epoch3 layer0 Acc 0.9734428571428572, AUC 0.9982574582099915
Test Epoch3 layer1 Acc 0.9858428571428571, AUC 0.998498260974884
Test Epoch3 layer2 Acc 0.9858571428571429, AUC 0.9983763098716736
Test Epoch3 layer3 Acc 0.9858857142857143, AUC 0.9979225397109985
Test Epoch3 layer4 Acc 0.9858571428571429, AUC 0.9978703856468201
gc 0
[[8.88123214e+03 1.76269593e+02]
 [1.46748823e-03 2.09265316e+01]
 [2.81498798e-03 1.82381896e+01]
 [4.56476118e-03 1.64221899e+01]
 [6.90275666e-03 1.50705993e+01]]
Train Epoch4 Acc 0.9897321428571428 (554250/560000), AUC 0.9986287951469421
Test Epoch4 layer0 Acc 0.9735571428571429, AUC 0.9983115196228027
Test Epoch4 layer1 Acc 0.9856714285714285, AUC 0.998473584651947
Test Epoch4 layer2 Acc 0.9858142857142858, AUC 0.9983606338500977
Test Epoch4 layer3 Acc 0.9858571428571429, AUC 0.9978328347206116
Test Epoch4 layer4 Acc 0.9858714285714286, AUC 0.9978460669517517
gc 0
[[8.88123214e+03 1.75443706e+02]
 [1.37798691e-03 1.89411200e+01]
 [2.62179033e-03 1.65843064e+01]
 [4.27222866e-03 1.49285708e+01]
 [6.47580381e-03 1.36817776e+01]]
Train Epoch5 Acc 0.9907071428571429 (554796/560000), AUC 0.9986756443977356
Test Epoch5 layer0 Acc 0.9733428571428572, AUC 0.9982916116714478
Test Epoch5 layer1 Acc 0.9860285714285715, AUC 0.9985865950584412
Save ckpt to ./ckpt//dbpedia_14/dbpedia_14_lstmal_l5.pt  ,ep 5
Test Epoch5 layer2 Acc 0.9861142857142857, AUC 0.9984758496284485
Test Epoch5 layer3 Acc 0.9860285714285715, AUC 0.9979891180992126
Test Epoch5 layer4 Acc 0.9859571428571429, AUC 0.9980190992355347
gc 0
[[8.88123214e+03 1.74671317e+02]
 [1.44071295e-03 1.73476628e+01]
 [2.73368085e-03 1.52156588e+01]
 [4.41660268e-03 1.36636691e+01]
 [6.64657263e-03 1.24974974e+01]]
Train Epoch6 Acc 0.9916535714285715 (555326/560000), AUC 0.9987090826034546
Test Epoch6 layer0 Acc 0.9736857142857143, AUC 0.9982182383537292
Test Epoch6 layer1 Acc 0.9860857142857142, AUC 0.9984137415885925
Test Epoch6 layer2 Acc 0.9861714285714286, AUC 0.9983811974525452
Test Epoch6 layer3 Acc 0.9861, AUC 0.9977449178695679
Test Epoch6 layer4 Acc 0.9861, AUC 0.9977332353591919
gc 0
[[8.88123214e+03 1.74144683e+02]
 [1.34257481e-03 1.60290988e+01]
 [2.55179972e-03 1.40691236e+01]
 [4.16312740e-03 1.26105679e+01]
 [6.37466177e-03 1.15251612e+01]]
Train Epoch7 Acc 0.9923839285714285 (555735/560000), AUC 0.9987683892250061
Test Epoch7 layer0 Acc 0.9734142857142857, AUC 0.998238742351532
Test Epoch7 layer1 Acc 0.9855142857142857, AUC 0.998412013053894
Test Epoch7 layer2 Acc 0.9856285714285714, AUC 0.998363196849823
Test Epoch7 layer3 Acc 0.9855, AUC 0.9977934956550598
Test Epoch7 layer4 Acc 0.9854857142857143, AUC 0.9977591633796692
gc 0
[[8.88123214e+03 1.73644267e+02]
 [1.42686967e-03 1.47447830e+01]
 [2.70459367e-03 1.29114004e+01]
 [4.35357926e-03 1.15432721e+01]
 [6.43208270e-03 1.05252530e+01]]
Train Epoch8 Acc 0.9931339285714286 (556155/560000), AUC 0.9988126754760742
Test Epoch8 layer0 Acc 0.9732142857142857, AUC 0.9982995986938477
Test Epoch8 layer1 Acc 0.9860285714285715, AUC 0.9982028007507324
Test Epoch8 layer2 Acc 0.9858714285714286, AUC 0.9980531334877014
Test Epoch8 layer3 Acc 0.9859, AUC 0.9975793957710266
Test Epoch8 layer4 Acc 0.9859285714285714, AUC 0.9974473118782043
gc 0
[[8.88123214e+03 1.73256744e+02]
 [1.35576860e-03 1.35850888e+01]
 [2.59700224e-03 1.18395602e+01]
 [4.22455101e-03 1.05407407e+01]
 [6.34173837e-03 9.58062035e+00]]
Train Epoch9 Acc 0.9938482142857142 (556555/560000), AUC 0.9988342523574829
Test Epoch9 layer0 Acc 0.9734571428571429, AUC 0.9982961416244507
Test Epoch9 layer1 Acc 0.9855571428571429, AUC 0.9979730248451233
Test Epoch9 layer2 Acc 0.9856857142857143, AUC 0.99786376953125
Test Epoch9 layer3 Acc 0.9857857142857143, AUC 0.9972491264343262
Test Epoch9 layer4 Acc 0.9857428571428571, AUC 0.9971293807029724
gc 0
[[8.88123214e+03 1.72944711e+02]
 [1.38837556e-03 1.24711985e+01]
 [2.63220507e-03 1.07965311e+01]
 [4.23963988e-03 9.58798358e+00]
 [6.29938763e-03 8.70397241e+00]]
Train Epoch10 Acc 0.9944696428571429 (556903/560000), AUC 0.9988742470741272
Test Epoch10 layer0 Acc 0.9735285714285714, AUC 0.9983170628547668
Test Epoch10 layer1 Acc 0.9858714285714286, AUC 0.9979621171951294
Test Epoch10 layer2 Acc 0.9861, AUC 0.9977678656578064
Test Epoch10 layer3 Acc 0.9860571428571429, AUC 0.9970937967300415
Test Epoch10 layer4 Acc 0.9861, AUC 0.9970542192459106
gc 0
[[8.88123214e+03 1.72691679e+02]
 [1.37281996e-03 1.16203573e+01]
 [2.61271927e-03 9.99763109e+00]
 [4.24405817e-03 8.84334185e+00]
 [6.26992194e-03 8.00282446e+00]]
Train Epoch11 Acc 0.9949464285714286 (557170/560000), AUC 0.9989324808120728
Test Epoch11 layer0 Acc 0.9734428571428572, AUC 0.9982872009277344
Test Epoch11 layer1 Acc 0.9856142857142857, AUC 0.9976708292961121
Test Epoch11 layer2 Acc 0.9857857142857143, AUC 0.9975430369377136
Test Epoch11 layer3 Acc 0.9857285714285714, AUC 0.9968872666358948
Test Epoch11 layer4 Acc 0.9858142857142858, AUC 0.9970254898071289
gc 0
[[8.88123214e+03 1.72497934e+02]
 [1.30646244e-03 1.06811100e+01]
 [2.51600687e-03 9.14206049e+00]
 [4.06501923e-03 8.07548325e+00]
 [6.01858048e-03 7.28877785e+00]]
Train Epoch12 Acc 0.9954160714285715 (557433/560000), AUC 0.9989765286445618
Test Epoch12 layer0 Acc 0.9739142857142857, AUC 0.9982936978340149
Test Epoch12 layer1 Acc 0.9858428571428571, AUC 0.9975919127464294
Test Epoch12 layer2 Acc 0.9859142857142857, AUC 0.9974073767662048
Test Epoch12 layer3 Acc 0.9859857142857142, AUC 0.996730387210846
Test Epoch12 layer4 Acc 0.9859857142857142, AUC 0.9967049956321716
gc 0
[[8.88123214e+03 1.72263843e+02]
 [1.31937663e-03 1.00327823e+01]
 [2.51929103e-03 8.50873469e+00]
 [4.08428593e-03 7.48834664e+00]
 [5.98724359e-03 6.73935972e+00]]
Train Epoch13 Acc 0.9958303571428572 (557665/560000), AUC 0.999058723449707
Test Epoch13 layer0 Acc 0.9739571428571429, AUC 0.9983062148094177
Test Epoch13 layer1 Acc 0.9855285714285714, AUC 0.997509777545929
Test Epoch13 layer2 Acc 0.9855714285714285, AUC 0.9972742795944214
Test Epoch13 layer3 Acc 0.9854714285714286, AUC 0.9967074990272522
Test Epoch13 layer4 Acc 0.9854714285714286, AUC 0.9965606331825256
gc 0
[[8.88123214e+03 1.71991980e+02]
 [1.26612124e-03 9.38899746e+00]
 [2.43653468e-03 7.90567674e+00]
 [3.91820719e-03 6.90532827e+00]
 [5.76595139e-03 6.19074220e+00]]
Train Epoch14 Acc 0.9961285714285715 (557832/560000), AUC 0.9991185069084167
Test Epoch14 layer0 Acc 0.9738, AUC 0.9982613921165466
Test Epoch14 layer1 Acc 0.9855714285714285, AUC 0.9973002672195435
Test Epoch14 layer2 Acc 0.9856714285714285, AUC 0.9971386194229126
Test Epoch14 layer3 Acc 0.9857, AUC 0.9963205456733704
Test Epoch14 layer4 Acc 0.9857428571428571, AUC 0.9964553713798523
gc 0
[[8.88123214e+03 1.71842262e+02]
 [1.34000837e-03 8.72166758e+00]
 [2.56491654e-03 7.30778925e+00]
 [4.11363064e-03 6.37902520e+00]
 [5.99844842e-03 5.70047537e+00]]
Train Epoch15 Acc 0.9964392857142857 (558006/560000), AUC 0.9991286993026733
Test Epoch15 layer0 Acc 0.9736, AUC 0.998289942741394
Test Epoch15 layer1 Acc 0.9858142857142858, AUC 0.9973978400230408
Test Epoch15 layer2 Acc 0.9855857142857143, AUC 0.9970582127571106
Test Epoch15 layer3 Acc 0.9854714285714286, AUC 0.9962519407272339
Test Epoch15 layer4 Acc 0.9854857142857143, AUC 0.9962987303733826
gc 0
[[8.88123214e+03 1.71706504e+02]
 [1.30981695e-03 8.21928516e+00]
 [2.50899225e-03 6.85566313e+00]
 [4.02534398e-03 5.96160589e+00]
 [5.82323681e-03 5.30776491e+00]]
Train Epoch16 Acc 0.9967089285714286 (558157/560000), AUC 0.9991636276245117
Test Epoch16 layer0 Acc 0.9735714285714285, AUC 0.9982596039772034
Test Epoch16 layer1 Acc 0.9853857142857143, AUC 0.997300922870636
Test Epoch16 layer2 Acc 0.9855, AUC 0.9970751404762268
Test Epoch16 layer3 Acc 0.9855285714285714, AUC 0.9960408806800842
Test Epoch16 layer4 Acc 0.9855142857142857, AUC 0.9962353110313416
gc 0
[[8.88123214e+03 1.71521600e+02]
 [1.32945676e-03 7.70603740e+00]
 [2.52361627e-03 6.39477678e+00]
 [4.02568155e-03 5.55278809e+00]
 [5.81336606e-03 4.93008641e+00]]
Train Epoch17 Acc 0.9969196428571429 (558275/560000), AUC 0.9991879463195801
Test Epoch17 layer0 Acc 0.9736, AUC 0.9983028769493103
Test Epoch17 layer1 Acc 0.9853142857142857, AUC 0.9969897270202637
Test Epoch17 layer2 Acc 0.9851142857142857, AUC 0.996728777885437
Test Epoch17 layer3 Acc 0.9851142857142857, AUC 0.99569171667099
Test Epoch17 layer4 Acc 0.9851571428571428, AUC 0.9958304762840271
gc 0
[[8.88123214e+03 1.71304767e+02]
 [1.30207107e-03 7.39106475e+00]
 [2.47568985e-03 6.11760984e+00]
 [3.97384593e-03 5.30200277e+00]
 [5.72741715e-03 4.69133123e+00]]
Train Epoch18 Acc 0.9970375 (558341/560000), AUC 0.999206006526947
Test Epoch18 layer0 Acc 0.9735428571428572, AUC 0.9982832074165344
Test Epoch18 layer1 Acc 0.9853428571428572, AUC 0.9969975352287292
Test Epoch18 layer2 Acc 0.9854714285714286, AUC 0.9968337416648865
Test Epoch18 layer3 Acc 0.9855, AUC 0.9957488775253296
Test Epoch18 layer4 Acc 0.9855428571428572, AUC 0.9959226846694946
gc 0
[[8.88123214e+03 1.71296340e+02]
 [1.41205777e-03 6.97242503e+00]
 [2.69182908e-03 5.73683266e+00]
 [4.23734704e-03 4.95201542e+00]
 [6.07873715e-03 4.35690458e+00]]
Train Epoch19 Acc 0.9972553571428572 (558463/560000), AUC 0.999239981174469
Test Epoch19 layer0 Acc 0.9734714285714285, AUC 0.9982710480690002
Test Epoch19 layer1 Acc 0.9844428571428572, AUC 0.9969455599784851
Test Epoch19 layer2 Acc 0.9846714285714285, AUC 0.9967050552368164
Test Epoch19 layer3 Acc 0.9845857142857143, AUC 0.9954360127449036
Test Epoch19 layer4 Acc 0.9846, AUC 0.995505154132843
gc 0
[[8.88123214e+03 1.71207210e+02]
 [1.27516538e-03 6.67000442e+00]
 [2.44926714e-03 5.47155478e+00]
 [3.88454063e-03 4.70848207e+00]
 [5.53630158e-03 4.12315242e+00]]
Train Epoch20 Acc 0.9973678571428571 (558526/560000), AUC 0.9992647171020508
Test Epoch20 layer0 Acc 0.9731142857142857, AUC 0.9982799291610718
Test Epoch20 layer1 Acc 0.9853, AUC 0.9968294501304626
Test Epoch20 layer2 Acc 0.9853142857142857, AUC 0.9966745376586914
Test Epoch20 layer3 Acc 0.9852285714285715, AUC 0.9954339861869812
Test Epoch20 layer4 Acc 0.9852571428571428, AUC 0.9957725405693054
gc 0
[[8.88123214e+03 1.71157371e+02]
 [1.29069793e-03 6.37711812e+00]
 [2.44899025e-03 5.21097729e+00]
 [3.88007297e-03 4.46796416e+00]
 [5.49505483e-03 3.90147078e+00]]
Train Epoch21 Acc 0.9974696428571429 (558583/560000), AUC 0.9992914795875549
Test Epoch21 layer0 Acc 0.9732714285714286, AUC 0.9982801675796509
Test Epoch21 layer1 Acc 0.9850571428571429, AUC 0.9968520402908325
Test Epoch21 layer2 Acc 0.9849428571428571, AUC 0.996604323387146
Test Epoch21 layer3 Acc 0.9849142857142857, AUC 0.9953137040138245
Test Epoch21 layer4 Acc 0.9848714285714286, AUC 0.9954442977905273
gc 0
[[8.88123214e+03 1.70965002e+02]
 [1.23734256e-03 6.12252089e+00]
 [2.36978471e-03 4.97503126e+00]
 [3.74519844e-03 4.24117649e+00]
 [5.29060278e-03 3.69010004e+00]]
Train Epoch22 Acc 0.9976339285714285 (558675/560000), AUC 0.9992988705635071
Test Epoch22 layer0 Acc 0.9736142857142858, AUC 0.9982932806015015
Test Epoch22 layer1 Acc 0.9847857142857143, AUC 0.9968395829200745
Test Epoch22 layer2 Acc 0.9850714285714286, AUC 0.9966266751289368
Test Epoch22 layer3 Acc 0.9850714285714286, AUC 0.9952687621116638
Test Epoch22 layer4 Acc 0.9851142857142857, AUC 0.995524525642395
gc 0
[[8.88123214e+03 1.70892462e+02]
 [1.35277224e-03 5.95961742e+00]
 [2.53684237e-03 4.81894505e+00]
 [3.97417333e-03 4.10192857e+00]
 [5.54787992e-03 3.55232399e+00]]
Train Epoch23 Acc 0.9976964285714286 (558710/560000), AUC 0.9992983937263489
Test Epoch23 layer0 Acc 0.9737857142857143, AUC 0.9982727766036987
Test Epoch23 layer1 Acc 0.9852571428571428, AUC 0.9964405298233032
Test Epoch23 layer2 Acc 0.9854142857142857, AUC 0.9963424801826477
Test Epoch23 layer3 Acc 0.9853285714285714, AUC 0.9948286414146423
Test Epoch23 layer4 Acc 0.9853285714285714, AUC 0.9950156211853027
gc 0
[[8.88123214e+03 1.70739483e+02]
 [1.21031152e-03 5.73709063e+00]
 [2.33213553e-03 4.60337394e+00]
 [3.65609373e-03 3.89264281e+00]
 [5.08588039e-03 3.35657875e+00]]
Train Epoch24 Acc 0.9978178571428571 (558778/560000), AUC 0.9993231892585754
Test Epoch24 layer0 Acc 0.9732714285714286, AUC 0.9982753396034241
Test Epoch24 layer1 Acc 0.9855428571428572, AUC 0.996545672416687
Test Epoch24 layer2 Acc 0.9853857142857143, AUC 0.9961910247802734
Test Epoch24 layer3 Acc 0.9854714285714286, AUC 0.9950453639030457
Test Epoch24 layer4 Acc 0.9854428571428572, AUC 0.9953591227531433
gc 0
[[8.88123214e+03 1.70736736e+02]
 [1.32920447e-03 5.54586380e+00]
 [2.54867098e-03 4.43420022e+00]
 [3.92419178e-03 3.73688965e+00]
 [5.40594989e-03 3.21060489e+00]]
Train Epoch25 Acc 0.9978642857142858 (558804/560000), AUC 0.9993420243263245
Test Epoch25 layer0 Acc 0.9734857142857143, AUC 0.9982704520225525
Test Epoch25 layer1 Acc 0.9849142857142857, AUC 0.9964056611061096
Test Epoch25 layer2 Acc 0.9849857142857142, AUC 0.996053159236908
Test Epoch25 layer3 Acc 0.9848142857142858, AUC 0.9946662187576294
Test Epoch25 layer4 Acc 0.9848428571428571, AUC 0.9948209524154663
gc 0
[[8.88123214e+03 1.70673072e+02]
 [1.27025469e-03 5.41298435e+00]
 [2.40817743e-03 4.32222840e+00]
 [3.74056922e-03 3.63467876e+00]
 [5.15570078e-03 3.10969872e+00]]
Train Epoch26 Acc 0.9979375 (558845/560000), AUC 0.9993416666984558
Test Epoch26 layer0 Acc 0.9736571428571429, AUC 0.998275876045227
Test Epoch26 layer1 Acc 0.9851571428571428, AUC 0.9964472651481628
Test Epoch26 layer2 Acc 0.9850857142857142, AUC 0.996261715888977
Test Epoch26 layer3 Acc 0.9849857142857142, AUC 0.9951425790786743
Test Epoch26 layer4 Acc 0.9848571428571429, AUC 0.9951286315917969
gc 0
[[8.88123214e+03 1.70439187e+02]
 [1.23028055e-03 5.25857652e+00]
 [2.32576244e-03 4.16586069e+00]
 [3.58464955e-03 3.47875196e+00]
 [4.88822270e-03 2.95836839e+00]]
Train Epoch27 Acc 0.9980571428571429 (558912/560000), AUC 0.9993661642074585
Test Epoch27 layer0 Acc 0.9734142857142857, AUC 0.9982939958572388
Test Epoch27 layer1 Acc 0.9849142857142857, AUC 0.9964726567268372
Test Epoch27 layer2 Acc 0.9849571428571429, AUC 0.9962860941886902
Test Epoch27 layer3 Acc 0.9848857142857143, AUC 0.994993269443512
Test Epoch27 layer4 Acc 0.9849428571428571, AUC 0.9949406981468201
gc 0
[[8.88123214e+03 1.70441730e+02]
 [1.27476760e-03 5.67883513e+00]
 [2.41508963e-03 4.51945918e+00]
 [3.74266563e-03 3.75975392e+00]
 [5.09592470e-03 3.18614074e+00]]
Train Epoch28 Acc 0.9978910714285715 (558819/560000), AUC 0.9993658661842346
Test Epoch28 layer0 Acc 0.9733857142857143, AUC 0.998265266418457
Test Epoch28 layer1 Acc 0.985, AUC 0.9965381026268005
Test Epoch28 layer2 Acc 0.9850571428571429, AUC 0.9959918856620789
Test Epoch28 layer3 Acc 0.9850142857142857, AUC 0.9947418570518494
Test Epoch28 layer4 Acc 0.9849714285714286, AUC 0.9947361350059509
gc 0
[[8.88123214e+03 1.70326143e+02]
 [1.23104070e-03 5.02432096e+00]
 [2.35516622e-03 3.93127655e+00]
 [3.65429275e-03 3.25649656e+00]
 [4.94829308e-03 2.74554457e+00]]
Train Epoch29 Acc 0.9981303571428571 (558953/560000), AUC 0.9993769526481628
Test Epoch29 layer0 Acc 0.9734857142857143, AUC 0.9982830286026001
Test Epoch29 layer1 Acc 0.9850571428571429, AUC 0.9963757395744324
Test Epoch29 layer2 Acc 0.9853714285714286, AUC 0.9960573315620422
Test Epoch29 layer3 Acc 0.9853, AUC 0.9947468638420105
Test Epoch29 layer4 Acc 0.9853428571428572, AUC 0.9949864745140076
gc 0
[[8.88123214e+03 1.70300678e+02]
 [1.23377610e-03 4.88639025e+00]
 [2.34194506e-03 3.82265311e+00]
 [3.55874715e-03 3.15376201e+00]
 [4.77375209e-03 2.64660773e+00]]
Train Epoch30 Acc 0.9981732142857143 (558977/560000), AUC 0.999403178691864
Test Epoch30 layer0 Acc 0.9732142857142857, AUC 0.9983088374137878
Test Epoch30 layer1 Acc 0.9848428571428571, AUC 0.9964336156845093
Test Epoch30 layer2 Acc 0.9849428571428571, AUC 0.9960622191429138
Test Epoch30 layer3 Acc 0.9848285714285714, AUC 0.9949513673782349
Test Epoch30 layer4 Acc 0.9848714285714286, AUC 0.9952537417411804
gc 0
[[8.88123214e+03 1.70171612e+02]
 [1.25275832e-03 4.80741694e+00]
 [2.37188213e-03 3.71836726e+00]
 [3.62569282e-03 3.03640322e+00]
 [4.81646175e-03 2.52398085e+00]]
Train Epoch31 Acc 0.9982446428571429 (559017/560000), AUC 0.9994133114814758
Test Epoch31 layer0 Acc 0.9734857142857143, AUC 0.9982801079750061
Test Epoch31 layer1 Acc 0.9851571428571428, AUC 0.9963394403457642
Test Epoch31 layer2 Acc 0.9853571428571428, AUC 0.9959355592727661
Test Epoch31 layer3 Acc 0.9852142857142857, AUC 0.9948257803916931
Test Epoch31 layer4 Acc 0.9851714285714286, AUC 0.994833767414093
gc 0
[[8.88123214e+03 1.70242641e+02]
 [1.23416211e-03 4.61094996e+00]
 [2.34120769e-03 3.53982215e+00]
 [3.56227095e-03 2.88754765e+00]
 [4.70054152e-03 2.39324998e+00]]
Train Epoch32 Acc 0.9982964285714285 (559046/560000), AUC 0.9994169473648071
Test Epoch32 layer0 Acc 0.9733428571428572, AUC 0.9983123540878296
Test Epoch32 layer1 Acc 0.9850142857142857, AUC 0.9963654279708862
Test Epoch32 layer2 Acc 0.9850428571428571, AUC 0.995859682559967
Test Epoch32 layer3 Acc 0.9850285714285715, AUC 0.9944815039634705
Test Epoch32 layer4 Acc 0.9849285714285714, AUC 0.9946126341819763
gc 0
[[8.88123214e+03 1.70113222e+02]
 [1.24023862e-03 4.64554194e+00]
 [2.30904880e-03 3.56045658e+00]
 [3.46584275e-03 2.87111337e+00]
 [4.52710311e-03 2.36128870e+00]]
Train Epoch33 Acc 0.9983232142857142 (559061/560000), AUC 0.999390721321106
Test Epoch33 layer0 Acc 0.9737428571428571, AUC 0.9982797503471375
Test Epoch33 layer1 Acc 0.9849285714285714, AUC 0.9962995648384094
Test Epoch33 layer2 Acc 0.9850857142857142, AUC 0.9960569739341736
Test Epoch33 layer3 Acc 0.9850714285714286, AUC 0.9943042397499084
Test Epoch33 layer4 Acc 0.9849714285714286, AUC 0.9944375157356262
gc 0
[[8.88123214e+03 1.70037979e+02]
 [1.20706229e-03 4.63089707e+00]
 [2.28098787e-03 3.54914503e+00]
 [3.46241730e-03 2.85347445e+00]
 [4.50159364e-03 2.33912970e+00]]
Train Epoch34 Acc 0.9983285714285715 (559064/560000), AUC 0.9993820786476135
Test Epoch34 layer0 Acc 0.9734142857142857, AUC 0.9983087778091431
Test Epoch34 layer1 Acc 0.9849571428571429, AUC 0.9964696764945984
Test Epoch34 layer2 Acc 0.9850142857142857, AUC 0.9960070848464966
Test Epoch34 layer3 Acc 0.9849285714285714, AUC 0.994637668132782
Test Epoch34 layer4 Acc 0.9849142857142857, AUC 0.9945710301399231
gc 0
[[8.88123214e+03 1.70015181e+02]
 [1.23382969e-03 4.43215285e+00]
 [2.31809570e-03 3.38614340e+00]
 [3.48814703e-03 2.71361757e+00]
 [4.51927799e-03 2.21205396e+00]]
Train Epoch35 Acc 0.9983642857142857 (559084/560000), AUC 0.9993730783462524
Test Epoch35 layer0 Acc 0.9734857142857143, AUC 0.9982869029045105
Test Epoch35 layer1 Acc 0.9850857142857142, AUC 0.9960519075393677
Test Epoch35 layer2 Acc 0.9851714285714286, AUC 0.9958786964416504
Test Epoch35 layer3 Acc 0.9851, AUC 0.9945337176322937
Test Epoch35 layer4 Acc 0.9851428571428571, AUC 0.9938936829566956
gc 0
[[8.88123214e+03 1.69965256e+02]
 [1.19594503e-03 4.41278538e+00]
 [2.23579944e-03 3.36813298e+00]
 [3.35267901e-03 2.67774933e+00]
 [4.27319027e-03 2.17405670e+00]]
Train Epoch36 Acc 0.9984089285714286 (559109/560000), AUC 0.9993778467178345
Test Epoch36 layer0 Acc 0.9735142857142857, AUC 0.9982544779777527
Test Epoch36 layer1 Acc 0.9850285714285715, AUC 0.9962237477302551
Test Epoch36 layer2 Acc 0.9852, AUC 0.9958657026290894
Test Epoch36 layer3 Acc 0.9852285714285715, AUC 0.9948180913925171
Test Epoch36 layer4 Acc 0.9850857142857142, AUC 0.9938285946846008
gc 0
[[8.88123214e+03 1.69913229e+02]
 [1.23487795e-03 4.30758511e+00]
 [2.31199767e-03 3.28019794e+00]
 [3.44249903e-03 2.59610417e+00]
 [4.35688876e-03 2.09254703e+00]]
Train Epoch37 Acc 0.9984357142857143 (559124/560000), AUC 0.9993857145309448
Test Epoch37 layer0 Acc 0.9734714285714285, AUC 0.9983136057853699
Test Epoch37 layer1 Acc 0.9851571428571428, AUC 0.9961310029029846
Test Epoch37 layer2 Acc 0.9852571428571428, AUC 0.9956472516059875
Test Epoch37 layer3 Acc 0.9851857142857143, AUC 0.994674563407898
Test Epoch37 layer4 Acc 0.9850857142857142, AUC 0.994159996509552
gc 0
[[8.88123214e+03 1.69916881e+02]
 [1.23246686e-03 4.16618064e+00]
 [2.28375701e-03 3.17117761e+00]
 [3.38118726e-03 2.50778198e+00]
 [4.26286512e-03 2.01837342e+00]]
Train Epoch38 Acc 0.9984839285714285 (559151/560000), AUC 0.9994190335273743
Test Epoch38 layer0 Acc 0.9735428571428572, AUC 0.9982801675796509
Test Epoch38 layer1 Acc 0.9848714285714286, AUC 0.9961405396461487
Test Epoch38 layer2 Acc 0.9851, AUC 0.9956415891647339
Test Epoch38 layer3 Acc 0.9850285714285715, AUC 0.9945083260536194
Test Epoch38 layer4 Acc 0.9850142857142857, AUC 0.9941509366035461
gc 0
[[8.88123214e+03 1.69785996e+02]
 [1.17182274e-03 4.09603060e+00]
 [2.21066991e-03 3.09607114e+00]
 [3.28971463e-03 2.44630468e+00]
 [4.11968759e-03 1.96279124e+00]]
Train Epoch39 Acc 0.9985071428571428 (559164/560000), AUC 0.9994348883628845
Test Epoch39 layer0 Acc 0.9734857142857143, AUC 0.9982531666755676
Test Epoch39 layer1 Acc 0.9852285714285715, AUC 0.9962634444236755
Test Epoch39 layer2 Acc 0.9854142857142857, AUC 0.9957759976387024
Test Epoch39 layer3 Acc 0.9854428571428572, AUC 0.9945012331008911
Test Epoch39 layer4 Acc 0.9854428571428572, AUC 0.9943555593490601
gc 0
[[8.88123214e+03 1.69727347e+02]
 [1.16504222e-03 4.03736923e+00]
 [2.17834630e-03 3.04781254e+00]
 [3.19565903e-03 2.38980379e+00]
 [3.95462407e-03 1.90303055e+00]]
Train Epoch40 Acc 0.99855 (559188/560000), AUC 0.9994404911994934
Test Epoch40 layer0 Acc 0.9734428571428572, AUC 0.9982767701148987
Test Epoch40 layer1 Acc 0.9850285714285715, AUC 0.9960880279541016
Test Epoch40 layer2 Acc 0.9850285714285715, AUC 0.9959998726844788
Test Epoch40 layer3 Acc 0.9849142857142857, AUC 0.994505763053894
Test Epoch40 layer4 Acc 0.9848142857142858, AUC 0.9941887259483337
gc 0
[[8.88123214e+03 1.69762526e+02]
 [1.16724688e-03 3.89790252e+00]
 [2.18422993e-03 2.91441525e+00]
 [3.18978613e-03 2.27408632e+00]
 [3.93518114e-03 1.79849707e+00]]
Train Epoch41 Acc 0.9985857142857143 (559208/560000), AUC 0.9994524717330933
Test Epoch41 layer0 Acc 0.9733857142857143, AUC 0.9982835054397583
Test Epoch41 layer1 Acc 0.9851142857142857, AUC 0.9962525963783264
Test Epoch41 layer2 Acc 0.9853142857142857, AUC 0.9957672953605652
Test Epoch41 layer3 Acc 0.9852714285714286, AUC 0.9947152137756348
Test Epoch41 layer4 Acc 0.9851428571428571, AUC 0.9943739175796509
gc 0
[[8.88123214e+03 1.69713678e+02]
 [1.22157502e-03 3.89436550e+00]
 [2.27096829e-03 2.92647547e+00]
 [3.28489604e-03 2.27077537e+00]
 [4.01344432e-03 1.78819760e+00]]
Train Epoch42 Acc 0.9986142857142857 (559224/560000), AUC 0.999477744102478
Test Epoch42 layer0 Acc 0.9734142857142857, AUC 0.9982631802558899
Test Epoch42 layer1 Acc 0.9847714285714285, AUC 0.996096134185791
Test Epoch42 layer2 Acc 0.9847285714285714, AUC 0.9957795739173889
Test Epoch42 layer3 Acc 0.9847428571428571, AUC 0.9945974349975586
Test Epoch42 layer4 Acc 0.9848, AUC 0.9942029118537903
gc 0
[[8.88123214e+03 1.69647508e+02]
 [1.19218416e-03 3.83132313e+00]
 [2.20796926e-03 2.82899875e+00]
 [3.24592834e-03 2.17849273e+00]
 [3.93470607e-03 1.70343492e+00]]
Train Epoch43 Acc 0.9986321428571429 (559234/560000), AUC 0.9994587898254395
Test Epoch43 layer0 Acc 0.9734, AUC 0.9982506632804871
Test Epoch43 layer1 Acc 0.9847428571428571, AUC 0.9959897994995117
Test Epoch43 layer2 Acc 0.9848857142857143, AUC 0.9953411817550659
Test Epoch43 layer3 Acc 0.9847142857142858, AUC 0.9943538904190063
Test Epoch43 layer4 Acc 0.9848, AUC 0.9939537644386292
gc 0
[[8.88123214e+03 1.69585721e+02]
 [1.24826512e-03 3.70775611e+00]
 [2.25658094e-03 2.72457957e+00]
 [3.24217877e-03 2.09772873e+00]
 [3.88833330e-03 1.63621500e+00]]
Train Epoch44 Acc 0.9986517857142857 (559245/560000), AUC 0.9994980692863464
Test Epoch44 layer0 Acc 0.9735, AUC 0.998314380645752
Test Epoch44 layer1 Acc 0.9849428571428571, AUC 0.9961410164833069
Test Epoch44 layer2 Acc 0.9851714285714286, AUC 0.9956122636795044
Test Epoch44 layer3 Acc 0.9850857142857142, AUC 0.994216799736023
Test Epoch44 layer4 Acc 0.9850285714285715, AUC 0.9940984845161438
gc 0
[[8.88123214e+03 1.69645446e+02]
 [1.15258681e-03 3.69489772e+00]
 [2.11202386e-03 2.69920243e+00]
 [3.05052737e-03 2.06927117e+00]
 [3.65397588e-03 1.60575021e+00]]
Train Epoch45 Acc 0.9986696428571429 (559255/560000), AUC 0.9995177984237671
Test Epoch45 layer0 Acc 0.9735, AUC 0.9982706904411316
Test Epoch45 layer1 Acc 0.9848714285714286, AUC 0.9958716630935669
Test Epoch45 layer2 Acc 0.9851571428571428, AUC 0.9955588579177856
Test Epoch45 layer3 Acc 0.9852142857142857, AUC 0.9942212700843811
Test Epoch45 layer4 Acc 0.9851714285714286, AUC 0.9942931532859802
gc 0
[[8.88123214e+03 1.69540677e+02]
 [1.19473722e-03 3.66051075e+00]
 [2.20742178e-03 2.68078536e+00]
 [3.16947459e-03 2.05005037e+00]
 [3.75369306e-03 1.58523438e+00]]
Train Epoch46 Acc 0.9986821428571429 (559262/560000), AUC 0.9995540976524353
Test Epoch46 layer0 Acc 0.9735142857142857, AUC 0.9982762932777405
Test Epoch46 layer1 Acc 0.9848142857142858, AUC 0.9959894418716431
Test Epoch46 layer2 Acc 0.9849571428571429, AUC 0.9956583380699158
Test Epoch46 layer3 Acc 0.9848571428571429, AUC 0.9947487711906433
Test Epoch46 layer4 Acc 0.9849142857142857, AUC 0.9945835471153259
gc 0
[[8.88123214e+03 1.69400447e+02]
 [1.23847128e-03 3.58014565e+00]
 [2.25899773e-03 2.57593203e+00]
 [3.23986531e-03 1.95080497e+00]
 [3.81748486e-03 1.49516212e+00]]
Train Epoch47 Acc 0.9987232142857143 (559285/560000), AUC 0.999567449092865
Test Epoch47 layer0 Acc 0.9735142857142857, AUC 0.9982857704162598
Test Epoch47 layer1 Acc 0.985, AUC 0.9961286783218384
Test Epoch47 layer2 Acc 0.9850714285714286, AUC 0.9957275390625
Test Epoch47 layer3 Acc 0.9851285714285715, AUC 0.9946304559707642
Test Epoch47 layer4 Acc 0.9851285714285715, AUC 0.9944887161254883
gc 0
[[8.88123214e+03 1.69453129e+02]
 [1.18427758e-03 3.56122182e+00]
 [2.18500469e-03 2.57071401e+00]
 [3.13302735e-03 1.94448468e+00]
 [3.66044752e-03 1.48664742e+00]]
Train Epoch48 Acc 0.9987428571428572 (559296/560000), AUC 0.9995617866516113
Test Epoch48 layer0 Acc 0.9736285714285714, AUC 0.9982762932777405
Test Epoch48 layer1 Acc 0.9849285714285714, AUC 0.9960998892784119
Test Epoch48 layer2 Acc 0.9850142857142857, AUC 0.9958244562149048
Test Epoch48 layer3 Acc 0.9848857142857143, AUC 0.9944664239883423
Test Epoch48 layer4 Acc 0.9849142857142857, AUC 0.9945560097694397
gc 0
[[8.88123214e+03 1.69422422e+02]
 [1.16838321e-03 3.47496314e+00]
 [2.16353462e-03 2.47390955e+00]
 [3.03931951e-03 1.85768942e+00]
 [3.54181066e-03 1.41043322e+00]]
Train Epoch49 Acc 0.9987803571428572 (559317/560000), AUC 0.9995707273483276
Test Epoch49 layer0 Acc 0.9737142857142858, AUC 0.9982712864875793
Test Epoch49 layer1 Acc 0.9849428571428571, AUC 0.9960451126098633
Test Epoch49 layer2 Acc 0.9851, AUC 0.9955422282218933
Test Epoch49 layer3 Acc 0.9850714285714286, AUC 0.9944804906845093
Test Epoch49 layer4 Acc 0.9850285714285715, AUC 0.994338870048523
Best AUC 0.9985865950584412
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt//dbpedia_14/dbpedia_14_lstmal_l5.pt
[[4696   42   27   14   11   74   39    9    4    6    4   18   14   42]
 [  39 4883    5    2    8    0   35   10    4    2    1    0    4    7]
 [  37   12 4626   21   49    1    9    3    5    0    1   73   20  143]
 [   2    1   30 4951   12    0    1    0    0    0    0    1    0    2]
 [   8   16   82   14 4843    8    8    2    2    1    0    1    3   12]
 [  35    1    3    4    1 4942    5    3    1    3    0    0    1    1]
 [  64   41    8    3   12   18 4789   39   11    6    1    1    3    4]
 [   0    0    0    0    3    0   10 4966   16    3    1    0    0    1]
 [   2    3    2    0    4    0   10   13 4966    0    0    0    0    0]
 [   1    0    1    2    1    1    0    6    0 4957   30    0    0    1]
 [  11    1    0    0    0    1    2    5    0   37 4943    0    0    0]
 [   5    0   47    2    0    0    1    1    0    1    0 4918   15   10]
 [  11    2   26    8    1    5    1    3    0    4    0   21 4866   52]
 [  33    5   84    9   11    3    4    9    1    5    2    7   39 4788]]
Figure(640x480)
[[4857   28   11    2   12   21   32    2    1    2    2    5    5   20]
 [  47 4918    1    0    6    0   23    0    1    1    0    0    0    3]
 [  18    3 4857    9   68    2    2    0    0    2    0   12    3   24]
 [   2    1   10 4970   13    0    1    0    0    0    1    1    1    0]
 [   6    3   58    5 4918    3    4    0    0    0    0    0    2    1]
 [  38    0    0    0    1 4954    1    1    1    1    0    0    2    1]
 [  66   28    3    0    2   15 4854   21    3    2    0    0    2    4]
 [   3    0    0    0    0    2   13 4973    6    2    0    0    0    1]
 [   2    2    1    0    3    0    4    6 4981    0    0    0    0    1]
 [   2    0    1    0    1    0    0    3    0 4978   14    0    1    0]
 [  15    1    0    0    1    1    1    1    0   29 4951    0    0    0]
 [   4    0    8    1    0    0    0    0    0    0    0 4973   11    3]
 [   8    0    4    1    0    0    0    0    0    0    0   18 4935   34]
 [  34    1   23    2    3    3    3    0    0    0    2    9   17 4903]]
Figure(640x480)
[[4854   29   11    2   12   21   32    2    1    2    2    5    5   22]
 [  43 4921    1    0    6    0   24    0    1    1    0    1    0    2]
 [  18    3 4858    9   69    1    2    0    0    2    0   12    2   24]
 [   1    1   10 4971   15    0    1    0    0    0    0    0    0    1]
 [   6    3   55    5 4922    3    3    0    0    0    0    0    2    1]
 [  39    0    0    0    1 4953    1    1    1    1    0    0    2    1]
 [  68   26    3    1    2   14 4852   21    5    2    0    0    3    3]
 [   2    0    0    0    0    2   14 4973    6    2    0    0    0    1]
 [   2    2    1    0    3    0    4    7 4980    0    0    0    0    1]
 [   1    0    1    0    1    0    0    2    0 4985    9    0    1    0]
 [  15    1    0    0    1    1    1    3    0   33 4945    0    0    0]
 [   4    0    7    1    0    0    0    0    0    0    0 4973   11    4]
 [   8    0    3    1    0    0    0    0    0    0    0   17 4936   35]
 [  35    1   22    2    3    2    2    0    0    0    1   10   17 4905]]
Figure(640x480)
[[4858   28   11    2   12   20   32    2    1    2    1    4    5   22]
 [  47 4918    0    0    6    0   24    0    1    1    0    0    0    3]
 [  18    3 4855    9   71    1    2    0    0    2    0   12    2   25]
 [   2    1   10 4967   17    0    1    0    0    0    1    0    0    1]
 [   6    3   53    5 4924    3    3    0    0    0    0    0    2    1]
 [  41    0    0    0    1 4951    1    1    1    1    0    0    2    1]
 [  70   25    3    1    2   14 4852   21    4    2    0    0    3    3]
 [   2    0    0    0    0    2   12 4975    6    2    0    0    0    1]
 [   2    1    1    0    3    0    4    7 4980    0    0    0    0    2]
 [   2    0    1    0    1    0    0    2    0 4984    9    0    0    1]
 [  15    1    0    0    1    1    1    2    0   34 4945    0    0    0]
 [   4    0    6    1    0    0    0    0    0    0    0 4972   12    5]
 [   8    0    3    1    0    0    0    0    0    0    0   17 4936   35]
 [  35    1   22    2    3    2    2    0    0    0    1   10   17 4905]]
Figure(640x480)
[[4858   28   11    2   12   19   32    2    1    2    2    4    5   22]
 [  47 4918    0    0    6    0   24    0    1    1    0    0    0    3]
 [  18    3 4857    9   70    1    2    0    0    2    0   12    2   24]
 [   2    1   10 4968   17    0    1    0    0    0    0    0    0    1]
 [   6    3   55    5 4921    3    3    0    0    0    0    0    2    2]
 [  41    0    0    0    1 4951    1    1    1    1    0    0    2    1]
 [  71   25    3    0    3   13 4852   21    4    2    0    0    3    3]
 [   2    0    0    0    0    2   12 4975    6    2    0    0    0    1]
 [   2    1    1    0    3    0    4    8 4979    0    0    0    0    2]
 [   2    0    1    0    1    0    0    2    0 4984    9    0    0    1]
 [  15    1    0    0    1    1    1    2    0   37 4942    0    0    0]
 [   4    0    7    1    0    0    0    0    0    0    0 4972   11    5]
 [   8    0    3    1    0    0    0    0    0    0    0   17 4936   35]
 [  34    1   22    2    3    2    2    0    0    0    2   11   17 4904]]
Figure(640x480)
