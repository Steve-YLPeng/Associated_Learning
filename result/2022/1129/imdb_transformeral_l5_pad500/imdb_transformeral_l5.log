total count words 222751
vocab size 30000
found 27937 words in glove
Start Training
gc 0
Train Epoch0 Acc 0.48775 (19510/40000), AUC 0.48576241731643677
Test Epoch0 layer0 Acc 0.8103, AUC 0.8781518936157227
Save ckpt to ckpt/imdb_transformeral_l5_pad500//imdb_transformeral_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.783, AUC 0.8675096035003662
Test Epoch0 layer2 Acc 0.7614, AUC 0.864852786064148
Test Epoch0 layer3 Acc 0.5332, AUC 0.8217969536781311
Test Epoch0 layer4 Acc 0.4948, AUC 0.4863191246986389
gc 0
Train Epoch1 Acc 0.790325 (31613/40000), AUC 0.8818573951721191
Test Epoch1 layer0 Acc 0.8676, AUC 0.9425970911979675
Save ckpt to ckpt/imdb_transformeral_l5_pad500//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8846, AUC 0.9522442817687988
Save ckpt to ckpt/imdb_transformeral_l5_pad500//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8859, AUC 0.9532488584518433
Save ckpt to ckpt/imdb_transformeral_l5_pad500//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.8872, AUC 0.9532079696655273
Test Epoch1 layer4 Acc 0.887, AUC 0.9533447027206421
Save ckpt to ckpt/imdb_transformeral_l5_pad500//imdb_transformeral_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9037 (36148/40000), AUC 0.9623075723648071
Test Epoch2 layer0 Acc 0.8854, AUC 0.9535114765167236
Save ckpt to ckpt/imdb_transformeral_l5_pad500//imdb_transformeral_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8955, AUC 0.9595152139663696
Save ckpt to ckpt/imdb_transformeral_l5_pad500//imdb_transformeral_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8941, AUC 0.959185779094696
Test Epoch2 layer3 Acc 0.8929, AUC 0.9588181972503662
Test Epoch2 layer4 Acc 0.8948, AUC 0.958964467048645
gc 0
Train Epoch3 Acc 0.931425 (37257/40000), AUC 0.9765110611915588
Test Epoch3 layer0 Acc 0.8858, AUC 0.9554834365844727
Test Epoch3 layer1 Acc 0.895, AUC 0.9589501023292542
Test Epoch3 layer2 Acc 0.8947, AUC 0.9573636054992676
Test Epoch3 layer3 Acc 0.895, AUC 0.9594613909721375
Test Epoch3 layer4 Acc 0.8941, AUC 0.9593103528022766
gc 0
Train Epoch4 Acc 0.948875 (37955/40000), AUC 0.9840197563171387
Test Epoch4 layer0 Acc 0.8956, AUC 0.958592414855957
Test Epoch4 layer1 Acc 0.8838, AUC 0.955976128578186
Test Epoch4 layer2 Acc 0.8878, AUC 0.9542785882949829
Test Epoch4 layer3 Acc 0.8876, AUC 0.9563148021697998
Test Epoch4 layer4 Acc 0.8867, AUC 0.9564599990844727
gc 0
Train Epoch5 Acc 0.955625 (38225/40000), AUC 0.9867513179779053
Test Epoch5 layer0 Acc 0.8966, AUC 0.9586001634597778
Test Epoch5 layer1 Acc 0.8878, AUC 0.9520368576049805
Test Epoch5 layer2 Acc 0.8879, AUC 0.9554581642150879
Test Epoch5 layer3 Acc 0.8881, AUC 0.9559621810913086
Test Epoch5 layer4 Acc 0.8878, AUC 0.9559614658355713
gc 0
Train Epoch6 Acc 0.95975 (38390/40000), AUC 0.9878372550010681
Test Epoch6 layer0 Acc 0.8912, AUC 0.9573043584823608
Test Epoch6 layer1 Acc 0.8867, AUC 0.9486287832260132
Test Epoch6 layer2 Acc 0.8866, AUC 0.9545295238494873
Test Epoch6 layer3 Acc 0.8861, AUC 0.9543805122375488
Test Epoch6 layer4 Acc 0.886, AUC 0.954404354095459
gc 0
Train Epoch7 Acc 0.963825 (38553/40000), AUC 0.9897053241729736
Test Epoch7 layer0 Acc 0.8911, AUC 0.9559015035629272
Test Epoch7 layer1 Acc 0.8852, AUC 0.945830225944519
Test Epoch7 layer2 Acc 0.885, AUC 0.9527022242546082
Test Epoch7 layer3 Acc 0.8838, AUC 0.9526690244674683
Test Epoch7 layer4 Acc 0.8839, AUC 0.9527757167816162
gc 0
Train Epoch8 Acc 0.966275 (38651/40000), AUC 0.9911426305770874
Test Epoch8 layer0 Acc 0.8904, AUC 0.9547292590141296
Test Epoch8 layer1 Acc 0.8808, AUC 0.9432306289672852
Test Epoch8 layer2 Acc 0.8807, AUC 0.9504804015159607
Test Epoch8 layer3 Acc 0.8795, AUC 0.9507651329040527
Test Epoch8 layer4 Acc 0.8793, AUC 0.9510436654090881
gc 0
Train Epoch9 Acc 0.970225 (38809/40000), AUC 0.9918502569198608
Test Epoch9 layer0 Acc 0.8861, AUC 0.9536093473434448
Test Epoch9 layer1 Acc 0.8815, AUC 0.9401193857192993
Test Epoch9 layer2 Acc 0.882, AUC 0.9488576650619507
Test Epoch9 layer3 Acc 0.882, AUC 0.9494923949241638
Test Epoch9 layer4 Acc 0.8811, AUC 0.9498072862625122
gc 0
Train Epoch10 Acc 0.97165 (38866/40000), AUC 0.9926962852478027
Test Epoch10 layer0 Acc 0.8867, AUC 0.9526151418685913
Test Epoch10 layer1 Acc 0.8805, AUC 0.935765266418457
Test Epoch10 layer2 Acc 0.8802, AUC 0.9457098245620728
Test Epoch10 layer3 Acc 0.8802, AUC 0.9483202695846558
Test Epoch10 layer4 Acc 0.8805, AUC 0.9487905502319336
gc 0
Train Epoch11 Acc 0.97315 (38926/40000), AUC 0.9932174682617188
Test Epoch11 layer0 Acc 0.8853, AUC 0.9517967104911804
Test Epoch11 layer1 Acc 0.8795, AUC 0.9358968734741211
Test Epoch11 layer2 Acc 0.8789, AUC 0.9451476335525513
Test Epoch11 layer3 Acc 0.8784, AUC 0.9474757313728333
Test Epoch11 layer4 Acc 0.8791, AUC 0.9480992555618286
gc 0
Train Epoch12 Acc 0.974 (38960/40000), AUC 0.9936906099319458
Test Epoch12 layer0 Acc 0.8834, AUC 0.9506293535232544
Test Epoch12 layer1 Acc 0.8794, AUC 0.9339755773544312
Test Epoch12 layer2 Acc 0.8794, AUC 0.9428189992904663
Test Epoch12 layer3 Acc 0.8794, AUC 0.9461634755134583
Test Epoch12 layer4 Acc 0.8793, AUC 0.947078287601471
gc 0
Train Epoch13 Acc 0.97585 (39034/40000), AUC 0.9938482642173767
Test Epoch13 layer0 Acc 0.8855, AUC 0.9504751563072205
Test Epoch13 layer1 Acc 0.8768, AUC 0.9316911697387695
Test Epoch13 layer2 Acc 0.8765, AUC 0.939850926399231
Test Epoch13 layer3 Acc 0.8766, AUC 0.9444028735160828
Test Epoch13 layer4 Acc 0.8767, AUC 0.945791482925415
gc 0
Train Epoch14 Acc 0.97635 (39054/40000), AUC 0.9943056106567383
Test Epoch14 layer0 Acc 0.8841, AUC 0.9499256610870361
Test Epoch14 layer1 Acc 0.8774, AUC 0.9301295280456543
Test Epoch14 layer2 Acc 0.8765, AUC 0.9363466501235962
Test Epoch14 layer3 Acc 0.8773, AUC 0.9432746171951294
Test Epoch14 layer4 Acc 0.8767, AUC 0.9455997943878174
gc 0
Train Epoch15 Acc 0.977025 (39081/40000), AUC 0.9944173693656921
Test Epoch15 layer0 Acc 0.885, AUC 0.9493626356124878
Test Epoch15 layer1 Acc 0.876, AUC 0.9293347597122192
Test Epoch15 layer2 Acc 0.876, AUC 0.9360347986221313
Test Epoch15 layer3 Acc 0.876, AUC 0.9427993297576904
Test Epoch15 layer4 Acc 0.8757, AUC 0.9447857141494751
gc 0
Train Epoch16 Acc 0.977325 (39093/40000), AUC 0.9949812889099121
Test Epoch16 layer0 Acc 0.8833, AUC 0.9488412141799927
Test Epoch16 layer1 Acc 0.8761, AUC 0.9295933246612549
Test Epoch16 layer2 Acc 0.8762, AUC 0.936890721321106
Test Epoch16 layer3 Acc 0.8761, AUC 0.9427354335784912
Test Epoch16 layer4 Acc 0.8765, AUC 0.9448233842849731
gc 0
Train Epoch17 Acc 0.978175 (39127/40000), AUC 0.9952681064605713
Test Epoch17 layer0 Acc 0.883, AUC 0.9485660195350647
Test Epoch17 layer1 Acc 0.877, AUC 0.9287318587303162
Test Epoch17 layer2 Acc 0.8759, AUC 0.9349262714385986
Test Epoch17 layer3 Acc 0.8758, AUC 0.9414987564086914
Test Epoch17 layer4 Acc 0.8759, AUC 0.944322943687439
gc 0
Train Epoch18 Acc 0.9788 (39152/40000), AUC 0.99517822265625
Test Epoch18 layer0 Acc 0.8829, AUC 0.948227047920227
Test Epoch18 layer1 Acc 0.8758, AUC 0.928665041923523
Test Epoch18 layer2 Acc 0.8754, AUC 0.9340571165084839
Test Epoch18 layer3 Acc 0.8748, AUC 0.9404141306877136
Test Epoch18 layer4 Acc 0.8754, AUC 0.9436686038970947
gc 0
Train Epoch19 Acc 0.978325 (39133/40000), AUC 0.9953662157058716
Test Epoch19 layer0 Acc 0.8812, AUC 0.9479552507400513
Test Epoch19 layer1 Acc 0.875, AUC 0.9274548292160034
Test Epoch19 layer2 Acc 0.875, AUC 0.932673454284668
Test Epoch19 layer3 Acc 0.8753, AUC 0.9398876428604126
Test Epoch19 layer4 Acc 0.875, AUC 0.9435884952545166
gc 0
Train Epoch20 Acc 0.978925 (39157/40000), AUC 0.9955185651779175
Test Epoch20 layer0 Acc 0.8801, AUC 0.947640597820282
Test Epoch20 layer1 Acc 0.8751, AUC 0.926972508430481
Test Epoch20 layer2 Acc 0.875, AUC 0.9314504861831665
Test Epoch20 layer3 Acc 0.8753, AUC 0.9390493631362915
Test Epoch20 layer4 Acc 0.8752, AUC 0.9429938793182373
gc 0
Train Epoch21 Acc 0.979425 (39177/40000), AUC 0.9956550002098083
Test Epoch21 layer0 Acc 0.8805, AUC 0.9474456310272217
Test Epoch21 layer1 Acc 0.8753, AUC 0.9255682229995728
Test Epoch21 layer2 Acc 0.8739, AUC 0.9301045536994934
Test Epoch21 layer3 Acc 0.8737, AUC 0.9380141496658325
Test Epoch21 layer4 Acc 0.8738, AUC 0.9424631595611572
gc 0
Train Epoch22 Acc 0.9794 (39176/40000), AUC 0.9955525398254395
Test Epoch22 layer0 Acc 0.8819, AUC 0.9474689960479736
Test Epoch22 layer1 Acc 0.8745, AUC 0.9259389638900757
Test Epoch22 layer2 Acc 0.8744, AUC 0.9299649000167847
Test Epoch22 layer3 Acc 0.8749, AUC 0.9379414319992065
Test Epoch22 layer4 Acc 0.8747, AUC 0.9424365162849426
gc 0
Train Epoch23 Acc 0.97975 (39190/40000), AUC 0.9954472184181213
Test Epoch23 layer0 Acc 0.8817, AUC 0.9473713636398315
Test Epoch23 layer1 Acc 0.8748, AUC 0.9256545901298523
Test Epoch23 layer2 Acc 0.8739, AUC 0.9291810989379883
Test Epoch23 layer3 Acc 0.8738, AUC 0.9370783567428589
Test Epoch23 layer4 Acc 0.8732, AUC 0.9420172572135925
gc 0
Train Epoch24 Acc 0.97965 (39186/40000), AUC 0.995854377746582
Test Epoch24 layer0 Acc 0.8817, AUC 0.9472172260284424
Test Epoch24 layer1 Acc 0.8742, AUC 0.9255996346473694
Test Epoch24 layer2 Acc 0.8739, AUC 0.9288114309310913
Test Epoch24 layer3 Acc 0.8742, AUC 0.9366701245307922
Test Epoch24 layer4 Acc 0.8742, AUC 0.9417697191238403
gc 0
Train Epoch25 Acc 0.9798 (39192/40000), AUC 0.9957488179206848
Test Epoch25 layer0 Acc 0.8813, AUC 0.9471879601478577
Test Epoch25 layer1 Acc 0.8744, AUC 0.9243525862693787
Test Epoch25 layer2 Acc 0.8735, AUC 0.9270639419555664
Test Epoch25 layer3 Acc 0.8735, AUC 0.9355736970901489
Test Epoch25 layer4 Acc 0.8741, AUC 0.9413108825683594
gc 0
Train Epoch26 Acc 0.979775 (39191/40000), AUC 0.9958645105361938
Test Epoch26 layer0 Acc 0.882, AUC 0.9470798969268799
Test Epoch26 layer1 Acc 0.8745, AUC 0.9249030947685242
Test Epoch26 layer2 Acc 0.8743, AUC 0.9273563623428345
Test Epoch26 layer3 Acc 0.8746, AUC 0.9355901479721069
Test Epoch26 layer4 Acc 0.8744, AUC 0.9412970542907715
gc 0
Train Epoch27 Acc 0.98015 (39206/40000), AUC 0.9960423707962036
Test Epoch27 layer0 Acc 0.8811, AUC 0.9469638466835022
Test Epoch27 layer1 Acc 0.8738, AUC 0.9243716597557068
Test Epoch27 layer2 Acc 0.8725, AUC 0.9268550872802734
Test Epoch27 layer3 Acc 0.8727, AUC 0.9351023435592651
Test Epoch27 layer4 Acc 0.8726, AUC 0.9410295486450195
gc 0
Train Epoch28 Acc 0.980075 (39203/40000), AUC 0.995884895324707
Test Epoch28 layer0 Acc 0.8816, AUC 0.9470340013504028
Test Epoch28 layer1 Acc 0.8744, AUC 0.9245553016662598
Test Epoch28 layer2 Acc 0.8737, AUC 0.9269812107086182
Test Epoch28 layer3 Acc 0.8741, AUC 0.9352985620498657
Test Epoch28 layer4 Acc 0.8739, AUC 0.9411656260490417
gc 0
Train Epoch29 Acc 0.980075 (39203/40000), AUC 0.9959824085235596
Test Epoch29 layer0 Acc 0.8815, AUC 0.9469708204269409
Test Epoch29 layer1 Acc 0.874, AUC 0.9245484471321106
Test Epoch29 layer2 Acc 0.8732, AUC 0.9269354343414307
Test Epoch29 layer3 Acc 0.8736, AUC 0.9352221488952637
Test Epoch29 layer4 Acc 0.8738, AUC 0.941132128238678
Best AUC 0.9595152139663696
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_transformeral_l5_pad500//imdb_transformeral_l5.pt
[[4539  401]
 [ 745 4315]]
Figure(640x480)
[[4529  411]
 [ 634 4426]]
Figure(640x480)
[[4518  422]
 [ 637 4423]]
Figure(640x480)
[[4504  436]
 [ 635 4425]]
Figure(640x480)
[[4460  480]
 [ 572 4488]]
Figure(640x480)
