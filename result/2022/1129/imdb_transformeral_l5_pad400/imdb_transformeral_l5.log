total count words 222751
vocab size 30000
found 27937 words in glove
Start Training
gc 0
Train Epoch0 Acc 0.4956 (19824/40000), AUC 0.49731215834617615
Test Epoch0 layer0 Acc 0.819, AUC 0.8978399038314819
Save ckpt to ckpt/imdb_transformeral_l5_pad400//imdb_transformeral_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.761, AUC 0.8531628251075745
Test Epoch0 layer2 Acc 0.6181, AUC 0.6993470191955566
Test Epoch0 layer3 Acc 0.5002, AUC 0.494619220495224
Test Epoch0 layer4 Acc 0.5004, AUC 0.4495547413825989
gc 0
Train Epoch1 Acc 0.753025 (30121/40000), AUC 0.8459305167198181
Test Epoch1 layer0 Acc 0.8894, AUC 0.9513152837753296
Save ckpt to ckpt/imdb_transformeral_l5_pad400//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8925, AUC 0.9558142423629761
Save ckpt to ckpt/imdb_transformeral_l5_pad400//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8926, AUC 0.9554213881492615
Test Epoch1 layer3 Acc 0.883, AUC 0.9548139572143555
Test Epoch1 layer4 Acc 0.8895, AUC 0.9546471834182739
gc 0
Train Epoch2 Acc 0.891175 (35647/40000), AUC 0.9565536975860596
Test Epoch2 layer0 Acc 0.8905, AUC 0.9571493864059448
Save ckpt to ckpt/imdb_transformeral_l5_pad400//imdb_transformeral_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.9019, AUC 0.9597762823104858
Save ckpt to ckpt/imdb_transformeral_l5_pad400//imdb_transformeral_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8936, AUC 0.9592103958129883
Test Epoch2 layer3 Acc 0.89, AUC 0.9585562944412231
Test Epoch2 layer4 Acc 0.8756, AUC 0.958385705947876
gc 0
Train Epoch3 Acc 0.92875 (37150/40000), AUC 0.9772037267684937
Test Epoch3 layer0 Acc 0.8855, AUC 0.9581714272499084
Test Epoch3 layer1 Acc 0.8985, AUC 0.9586095213890076
Test Epoch3 layer2 Acc 0.8947, AUC 0.9572345018386841
Test Epoch3 layer3 Acc 0.8938, AUC 0.9574072360992432
Test Epoch3 layer4 Acc 0.8899, AUC 0.957273006439209
gc 0
Train Epoch4 Acc 0.9458 (37832/40000), AUC 0.9832988977432251
Test Epoch4 layer0 Acc 0.9004, AUC 0.9584637880325317
Test Epoch4 layer1 Acc 0.8884, AUC 0.9554888606071472
Test Epoch4 layer2 Acc 0.8895, AUC 0.9495318531990051
Test Epoch4 layer3 Acc 0.8883, AUC 0.9543495774269104
Test Epoch4 layer4 Acc 0.8887, AUC 0.9551949501037598
gc 0
Train Epoch5 Acc 0.9563 (38252/40000), AUC 0.9870223999023438
Test Epoch5 layer0 Acc 0.8976, AUC 0.9569233655929565
Test Epoch5 layer1 Acc 0.886, AUC 0.9515066146850586
Test Epoch5 layer2 Acc 0.8858, AUC 0.9493380784988403
Test Epoch5 layer3 Acc 0.8854, AUC 0.9499478340148926
Test Epoch5 layer4 Acc 0.8857, AUC 0.9515522718429565
gc 0
Train Epoch6 Acc 0.959975 (38399/40000), AUC 0.9889682531356812
Test Epoch6 layer0 Acc 0.8921, AUC 0.9553042650222778
Test Epoch6 layer1 Acc 0.8772, AUC 0.9435882568359375
Test Epoch6 layer2 Acc 0.8784, AUC 0.9481639862060547
Test Epoch6 layer3 Acc 0.8777, AUC 0.9492952227592468
Test Epoch6 layer4 Acc 0.8764, AUC 0.9496217966079712
gc 0
Train Epoch7 Acc 0.96495 (38598/40000), AUC 0.9910503625869751
Test Epoch7 layer0 Acc 0.8903, AUC 0.9534696340560913
Test Epoch7 layer1 Acc 0.8812, AUC 0.9427680969238281
Test Epoch7 layer2 Acc 0.8814, AUC 0.9479708075523376
Test Epoch7 layer3 Acc 0.8808, AUC 0.948424220085144
Test Epoch7 layer4 Acc 0.8811, AUC 0.9488847255706787
gc 0
Train Epoch8 Acc 0.967925 (38717/40000), AUC 0.9918954968452454
Test Epoch8 layer0 Acc 0.8859, AUC 0.9506313800811768
Test Epoch8 layer1 Acc 0.875, AUC 0.9358956813812256
Test Epoch8 layer2 Acc 0.8752, AUC 0.9434707164764404
Test Epoch8 layer3 Acc 0.875, AUC 0.94468092918396
Test Epoch8 layer4 Acc 0.8748, AUC 0.9455373883247375
gc 0
Train Epoch9 Acc 0.97215 (38886/40000), AUC 0.9929314851760864
Test Epoch9 layer0 Acc 0.8851, AUC 0.9498354196548462
Test Epoch9 layer1 Acc 0.8774, AUC 0.9340412616729736
Test Epoch9 layer2 Acc 0.8774, AUC 0.9402662515640259
Test Epoch9 layer3 Acc 0.8772, AUC 0.9436843395233154
Test Epoch9 layer4 Acc 0.8773, AUC 0.9449442625045776
gc 0
Train Epoch10 Acc 0.9733 (38932/40000), AUC 0.9932869672775269
Test Epoch10 layer0 Acc 0.8866, AUC 0.9483184218406677
Test Epoch10 layer1 Acc 0.8751, AUC 0.9320857524871826
Test Epoch10 layer2 Acc 0.8753, AUC 0.9406530857086182
Test Epoch10 layer3 Acc 0.8752, AUC 0.9432014226913452
Test Epoch10 layer4 Acc 0.8737, AUC 0.9445910453796387
gc 0
Train Epoch11 Acc 0.974825 (38993/40000), AUC 0.994275689125061
Test Epoch11 layer0 Acc 0.8814, AUC 0.9472138285636902
Test Epoch11 layer1 Acc 0.8725, AUC 0.930107593536377
Test Epoch11 layer2 Acc 0.8721, AUC 0.9376431703567505
Test Epoch11 layer3 Acc 0.872, AUC 0.9409207105636597
Test Epoch11 layer4 Acc 0.8721, AUC 0.9426881670951843
gc 0
Train Epoch12 Acc 0.97585 (39034/40000), AUC 0.9947002530097961
Test Epoch12 layer0 Acc 0.881, AUC 0.9456199407577515
Test Epoch12 layer1 Acc 0.8717, AUC 0.9279078245162964
Test Epoch12 layer2 Acc 0.8722, AUC 0.936011791229248
Test Epoch12 layer3 Acc 0.8727, AUC 0.9391745328903198
Test Epoch12 layer4 Acc 0.8729, AUC 0.9413840770721436
gc 0
Train Epoch13 Acc 0.977825 (39113/40000), AUC 0.9955741763114929
Test Epoch13 layer0 Acc 0.8796, AUC 0.9451874494552612
Test Epoch13 layer1 Acc 0.8711, AUC 0.9266897439956665
Test Epoch13 layer2 Acc 0.8708, AUC 0.934026837348938
Test Epoch13 layer3 Acc 0.8708, AUC 0.9372733235359192
Test Epoch13 layer4 Acc 0.8712, AUC 0.9398089647293091
gc 0
Train Epoch14 Acc 0.97775 (39110/40000), AUC 0.9951635599136353
Test Epoch14 layer0 Acc 0.8812, AUC 0.9443356394767761
Test Epoch14 layer1 Acc 0.8707, AUC 0.925256073474884
Test Epoch14 layer2 Acc 0.8697, AUC 0.9319944977760315
Test Epoch14 layer3 Acc 0.8697, AUC 0.9350961446762085
Test Epoch14 layer4 Acc 0.8697, AUC 0.938776433467865
gc 0
Train Epoch15 Acc 0.97845 (39138/40000), AUC 0.9955987930297852
Test Epoch15 layer0 Acc 0.8791, AUC 0.9438583254814148
Test Epoch15 layer1 Acc 0.8698, AUC 0.9238263964653015
Test Epoch15 layer2 Acc 0.8698, AUC 0.9308731555938721
Test Epoch15 layer3 Acc 0.8697, AUC 0.9341341853141785
Test Epoch15 layer4 Acc 0.8701, AUC 0.9380420446395874
gc 0
Train Epoch16 Acc 0.9789 (39156/40000), AUC 0.9958081245422363
Test Epoch16 layer0 Acc 0.8782, AUC 0.9430493116378784
Test Epoch16 layer1 Acc 0.8697, AUC 0.9234986901283264
Test Epoch16 layer2 Acc 0.8696, AUC 0.9302294254302979
Test Epoch16 layer3 Acc 0.8695, AUC 0.9332165718078613
Test Epoch16 layer4 Acc 0.87, AUC 0.9374182224273682
gc 0
Train Epoch17 Acc 0.9801 (39204/40000), AUC 0.9955657720565796
Test Epoch17 layer0 Acc 0.8789, AUC 0.9427711963653564
Test Epoch17 layer1 Acc 0.8692, AUC 0.9222590923309326
Test Epoch17 layer2 Acc 0.8694, AUC 0.9288488626480103
Test Epoch17 layer3 Acc 0.8696, AUC 0.9312957525253296
Test Epoch17 layer4 Acc 0.8692, AUC 0.9366090893745422
gc 0
Train Epoch18 Acc 0.980325 (39213/40000), AUC 0.9959269762039185
Test Epoch18 layer0 Acc 0.8775, AUC 0.9424062967300415
Test Epoch18 layer1 Acc 0.8687, AUC 0.9215259552001953
Test Epoch18 layer2 Acc 0.8687, AUC 0.9288366436958313
Test Epoch18 layer3 Acc 0.8689, AUC 0.9314181804656982
Test Epoch18 layer4 Acc 0.8699, AUC 0.9361215829849243
gc 0
Train Epoch19 Acc 0.980425 (39217/40000), AUC 0.996048629283905
Test Epoch19 layer0 Acc 0.878, AUC 0.9420090317726135
Test Epoch19 layer1 Acc 0.8687, AUC 0.9205322861671448
Test Epoch19 layer2 Acc 0.8691, AUC 0.9272656440734863
Test Epoch19 layer3 Acc 0.8693, AUC 0.9295213222503662
Test Epoch19 layer4 Acc 0.8691, AUC 0.9351348280906677
gc 0
Train Epoch20 Acc 0.980625 (39225/40000), AUC 0.9963804483413696
Test Epoch20 layer0 Acc 0.8762, AUC 0.9417243003845215
Test Epoch20 layer1 Acc 0.8685, AUC 0.9203468561172485
Test Epoch20 layer2 Acc 0.8697, AUC 0.9267117977142334
Test Epoch20 layer3 Acc 0.8695, AUC 0.9291409850120544
Test Epoch20 layer4 Acc 0.8695, AUC 0.9347575902938843
gc 0
Train Epoch21 Acc 0.98085 (39234/40000), AUC 0.9961221814155579
Test Epoch21 layer0 Acc 0.8767, AUC 0.9414864778518677
Test Epoch21 layer1 Acc 0.8671, AUC 0.920371949672699
Test Epoch21 layer2 Acc 0.8681, AUC 0.9262043833732605
Test Epoch21 layer3 Acc 0.8681, AUC 0.9286901950836182
Test Epoch21 layer4 Acc 0.8679, AUC 0.9342420697212219
gc 0
Train Epoch22 Acc 0.98175 (39270/40000), AUC 0.9963161945343018
Test Epoch22 layer0 Acc 0.8767, AUC 0.9414144158363342
Test Epoch22 layer1 Acc 0.868, AUC 0.9193905591964722
Test Epoch22 layer2 Acc 0.8679, AUC 0.9255541563034058
Test Epoch22 layer3 Acc 0.8682, AUC 0.9270554780960083
Test Epoch22 layer4 Acc 0.8681, AUC 0.9333769083023071
gc 0
Train Epoch23 Acc 0.981675 (39267/40000), AUC 0.9961838722229004
Test Epoch23 layer0 Acc 0.8758, AUC 0.9412462711334229
Test Epoch23 layer1 Acc 0.868, AUC 0.9189298152923584
Test Epoch23 layer2 Acc 0.8682, AUC 0.9253255128860474
Test Epoch23 layer3 Acc 0.8682, AUC 0.9267305731773376
Test Epoch23 layer4 Acc 0.868, AUC 0.933024525642395
gc 0
Train Epoch24 Acc 0.981525 (39261/40000), AUC 0.9960980415344238
Test Epoch24 layer0 Acc 0.8771, AUC 0.9410330653190613
Test Epoch24 layer1 Acc 0.8675, AUC 0.9191800355911255
Test Epoch24 layer2 Acc 0.8675, AUC 0.9257099628448486
Test Epoch24 layer3 Acc 0.8673, AUC 0.9272109866142273
Test Epoch24 layer4 Acc 0.8683, AUC 0.9329619407653809
gc 0
Train Epoch25 Acc 0.9816 (39264/40000), AUC 0.9965183734893799
Test Epoch25 layer0 Acc 0.8763, AUC 0.9410196542739868
Test Epoch25 layer1 Acc 0.8682, AUC 0.9187721014022827
Test Epoch25 layer2 Acc 0.8676, AUC 0.9253032207489014
Test Epoch25 layer3 Acc 0.8682, AUC 0.925883412361145
Test Epoch25 layer4 Acc 0.868, AUC 0.9327298998832703
gc 0
Train Epoch26 Acc 0.981225 (39249/40000), AUC 0.9963685274124146
Test Epoch26 layer0 Acc 0.8761, AUC 0.9409269690513611
Test Epoch26 layer1 Acc 0.8667, AUC 0.9186199903488159
Test Epoch26 layer2 Acc 0.8674, AUC 0.9249027967453003
Test Epoch26 layer3 Acc 0.8675, AUC 0.9262312054634094
Test Epoch26 layer4 Acc 0.8677, AUC 0.9319953918457031
gc 0
Train Epoch27 Acc 0.981575 (39263/40000), AUC 0.9966980218887329
Test Epoch27 layer0 Acc 0.8761, AUC 0.9408792853355408
Test Epoch27 layer1 Acc 0.8669, AUC 0.9185066223144531
Test Epoch27 layer2 Acc 0.8671, AUC 0.9247596263885498
Test Epoch27 layer3 Acc 0.8672, AUC 0.9255964756011963
Test Epoch27 layer4 Acc 0.8673, AUC 0.9318166971206665
gc 0
Train Epoch28 Acc 0.9816 (39264/40000), AUC 0.9966534376144409
Test Epoch28 layer0 Acc 0.8761, AUC 0.940809965133667
Test Epoch28 layer1 Acc 0.8663, AUC 0.9184845685958862
Test Epoch28 layer2 Acc 0.8672, AUC 0.9248225092887878
Test Epoch28 layer3 Acc 0.8671, AUC 0.9256266355514526
Test Epoch28 layer4 Acc 0.867, AUC 0.9317264556884766
gc 0
Train Epoch29 Acc 0.98195 (39278/40000), AUC 0.9963641166687012
Test Epoch29 layer0 Acc 0.8756, AUC 0.9407992362976074
Test Epoch29 layer1 Acc 0.8663, AUC 0.9183928370475769
Test Epoch29 layer2 Acc 0.8669, AUC 0.9247199892997742
Test Epoch29 layer3 Acc 0.8669, AUC 0.9252361059188843
Test Epoch29 layer4 Acc 0.8669, AUC 0.9315192699432373
Best AUC 0.9597762823104858
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_transformeral_l5_pad400//imdb_transformeral_l5.pt
[[4609  382]
 [ 713 4296]]
Figure(640x480)
[[4503  488]
 [ 493 4516]]
Figure(640x480)
[[4264  727]
 [ 337 4672]]
Figure(640x480)
[[4217  774]
 [ 326 4683]]
Figure(640x480)
[[3989 1002]
 [ 242 4767]]
Figure(640x480)
