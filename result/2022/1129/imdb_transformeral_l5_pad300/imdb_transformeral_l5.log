total count words 222751
vocab size 30000
found 27937 words in glove
Start Training
gc 0
Train Epoch0 Acc 0.5095 (20380/40000), AUC 0.508010745048523
Test Epoch0 layer0 Acc 0.8355, AUC 0.908852219581604
Save ckpt to ckpt/imdb_transformeral_l5_pad300//imdb_transformeral_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7731, AUC 0.8738499879837036
Test Epoch0 layer2 Acc 0.6244, AUC 0.8014671802520752
Test Epoch0 layer3 Acc 0.6925, AUC 0.7324760556221008
Test Epoch0 layer4 Acc 0.5246, AUC 0.7421400547027588
gc 0
Train Epoch1 Acc 0.8117 (32468/40000), AUC 0.8912454843521118
Test Epoch1 layer0 Acc 0.8838, AUC 0.9494576454162598
Save ckpt to ckpt/imdb_transformeral_l5_pad300//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8838, AUC 0.9529646039009094
Save ckpt to ckpt/imdb_transformeral_l5_pad300//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8877, AUC 0.9559828042984009
Save ckpt to ckpt/imdb_transformeral_l5_pad300//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.8804, AUC 0.956137478351593
Save ckpt to ckpt/imdb_transformeral_l5_pad300//imdb_transformeral_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.8804, AUC 0.955778956413269
gc 0
Train Epoch2 Acc 0.9038 (36152/40000), AUC 0.9643150568008423
Test Epoch2 layer0 Acc 0.8908, AUC 0.9558542370796204
Test Epoch2 layer1 Acc 0.8928, AUC 0.9581615924835205
Save ckpt to ckpt/imdb_transformeral_l5_pad300//imdb_transformeral_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8951, AUC 0.9585217833518982
Save ckpt to ckpt/imdb_transformeral_l5_pad300//imdb_transformeral_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8938, AUC 0.9587879180908203
Save ckpt to ckpt/imdb_transformeral_l5_pad300//imdb_transformeral_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.8942, AUC 0.958590030670166
gc 0
Train Epoch3 Acc 0.930175 (37207/40000), AUC 0.976673424243927
Test Epoch3 layer0 Acc 0.8936, AUC 0.9568518400192261
Test Epoch3 layer1 Acc 0.8905, AUC 0.9577680826187134
Test Epoch3 layer2 Acc 0.8857, AUC 0.9551384449005127
Test Epoch3 layer3 Acc 0.8839, AUC 0.9560056924819946
Test Epoch3 layer4 Acc 0.8838, AUC 0.9556642174720764
gc 0
Train Epoch4 Acc 0.9449 (37796/40000), AUC 0.9836209416389465
Test Epoch4 layer0 Acc 0.8962, AUC 0.9557319283485413
Test Epoch4 layer1 Acc 0.8862, AUC 0.9552162885665894
Test Epoch4 layer2 Acc 0.8859, AUC 0.9495545625686646
Test Epoch4 layer3 Acc 0.8856, AUC 0.951934814453125
Test Epoch4 layer4 Acc 0.886, AUC 0.952912449836731
gc 0
Train Epoch5 Acc 0.952725 (38109/40000), AUC 0.9862158894538879
Test Epoch5 layer0 Acc 0.8963, AUC 0.954827070236206
Test Epoch5 layer1 Acc 0.883, AUC 0.952751100063324
Test Epoch5 layer2 Acc 0.8809, AUC 0.9463557004928589
Test Epoch5 layer3 Acc 0.8778, AUC 0.9504480957984924
Test Epoch5 layer4 Acc 0.8773, AUC 0.9510741829872131
gc 0
Train Epoch6 Acc 0.958225 (38329/40000), AUC 0.9885020852088928
Test Epoch6 layer0 Acc 0.8893, AUC 0.9520354270935059
Test Epoch6 layer1 Acc 0.8857, AUC 0.9503406286239624
Test Epoch6 layer2 Acc 0.8831, AUC 0.9446529150009155
Test Epoch6 layer3 Acc 0.8823, AUC 0.9479992389678955
Test Epoch6 layer4 Acc 0.8823, AUC 0.9491240382194519
gc 0
Train Epoch7 Acc 0.96315 (38526/40000), AUC 0.9908918738365173
Test Epoch7 layer0 Acc 0.8902, AUC 0.950856626033783
Test Epoch7 layer1 Acc 0.8813, AUC 0.9485580921173096
Test Epoch7 layer2 Acc 0.881, AUC 0.9414203763008118
Test Epoch7 layer3 Acc 0.8797, AUC 0.9436337947845459
Test Epoch7 layer4 Acc 0.8806, AUC 0.9473093152046204
gc 0
Train Epoch8 Acc 0.968 (38720/40000), AUC 0.992328405380249
Test Epoch8 layer0 Acc 0.8889, AUC 0.949325680732727
Test Epoch8 layer1 Acc 0.8777, AUC 0.9460358619689941
Test Epoch8 layer2 Acc 0.8766, AUC 0.9340797662734985
Test Epoch8 layer3 Acc 0.8765, AUC 0.9364838600158691
Test Epoch8 layer4 Acc 0.8762, AUC 0.944925844669342
gc 0
Train Epoch9 Acc 0.96975 (38790/40000), AUC 0.9931197762489319
Test Epoch9 layer0 Acc 0.8859, AUC 0.9479923248291016
Test Epoch9 layer1 Acc 0.8761, AUC 0.944682776927948
Test Epoch9 layer2 Acc 0.8778, AUC 0.9370782375335693
Test Epoch9 layer3 Acc 0.8771, AUC 0.938427746295929
Test Epoch9 layer4 Acc 0.8773, AUC 0.9445711374282837
gc 0
Train Epoch10 Acc 0.971375 (38855/40000), AUC 0.9933679103851318
Test Epoch10 layer0 Acc 0.8834, AUC 0.9466108083724976
Test Epoch10 layer1 Acc 0.8722, AUC 0.9415346384048462
Test Epoch10 layer2 Acc 0.8715, AUC 0.9422682523727417
Test Epoch10 layer3 Acc 0.8706, AUC 0.9410240054130554
Test Epoch10 layer4 Acc 0.871, AUC 0.942866325378418
gc 0
Train Epoch11 Acc 0.974025 (38961/40000), AUC 0.994735598564148
Test Epoch11 layer0 Acc 0.8799, AUC 0.9451665282249451
Test Epoch11 layer1 Acc 0.8738, AUC 0.9393441081047058
Test Epoch11 layer2 Acc 0.8734, AUC 0.9424098134040833
Test Epoch11 layer3 Acc 0.8726, AUC 0.9411753416061401
Test Epoch11 layer4 Acc 0.873, AUC 0.9426748752593994
gc 0
Train Epoch12 Acc 0.97595 (39038/40000), AUC 0.9951014518737793
Test Epoch12 layer0 Acc 0.8827, AUC 0.9445642232894897
Test Epoch12 layer1 Acc 0.8755, AUC 0.9365267753601074
Test Epoch12 layer2 Acc 0.8767, AUC 0.9416636824607849
Test Epoch12 layer3 Acc 0.8756, AUC 0.9413759708404541
Test Epoch12 layer4 Acc 0.8762, AUC 0.9417043924331665
gc 0
Train Epoch13 Acc 0.976825 (39073/40000), AUC 0.9952520728111267
Test Epoch13 layer0 Acc 0.8825, AUC 0.9440385103225708
Test Epoch13 layer1 Acc 0.8768, AUC 0.9347575306892395
Test Epoch13 layer2 Acc 0.8768, AUC 0.9400379657745361
Test Epoch13 layer3 Acc 0.877, AUC 0.9400190114974976
Test Epoch13 layer4 Acc 0.877, AUC 0.9412990212440491
gc 0
Train Epoch14 Acc 0.9767 (39068/40000), AUC 0.9954456090927124
Test Epoch14 layer0 Acc 0.8813, AUC 0.9431333541870117
Test Epoch14 layer1 Acc 0.8728, AUC 0.9312065839767456
Test Epoch14 layer2 Acc 0.8743, AUC 0.9386496543884277
Test Epoch14 layer3 Acc 0.8738, AUC 0.9382933378219604
Test Epoch14 layer4 Acc 0.8739, AUC 0.9401900172233582
gc 0
Train Epoch15 Acc 0.978225 (39129/40000), AUC 0.9957246780395508
Test Epoch15 layer0 Acc 0.8801, AUC 0.9425371885299683
Test Epoch15 layer1 Acc 0.8746, AUC 0.9299737215042114
Test Epoch15 layer2 Acc 0.8735, AUC 0.9378764629364014
Test Epoch15 layer3 Acc 0.8739, AUC 0.937383770942688
Test Epoch15 layer4 Acc 0.874, AUC 0.9386212825775146
gc 0
Train Epoch16 Acc 0.979325 (39173/40000), AUC 0.9957119226455688
Test Epoch16 layer0 Acc 0.8798, AUC 0.9421449303627014
Test Epoch16 layer1 Acc 0.874, AUC 0.9290586113929749
Test Epoch16 layer2 Acc 0.8739, AUC 0.9378516674041748
Test Epoch16 layer3 Acc 0.8737, AUC 0.9372580647468567
Test Epoch16 layer4 Acc 0.8736, AUC 0.9383273124694824
gc 0
Train Epoch17 Acc 0.9797 (39188/40000), AUC 0.9959452152252197
Test Epoch17 layer0 Acc 0.8789, AUC 0.9417120814323425
Test Epoch17 layer1 Acc 0.8706, AUC 0.9271620512008667
Test Epoch17 layer2 Acc 0.8715, AUC 0.9374988079071045
Test Epoch17 layer3 Acc 0.8715, AUC 0.9368301630020142
Test Epoch17 layer4 Acc 0.8716, AUC 0.9371913075447083
gc 0
Train Epoch18 Acc 0.980175 (39207/40000), AUC 0.9959044456481934
Test Epoch18 layer0 Acc 0.8772, AUC 0.9412818551063538
Test Epoch18 layer1 Acc 0.8728, AUC 0.9268417954444885
Test Epoch18 layer2 Acc 0.874, AUC 0.9368917942047119
Test Epoch18 layer3 Acc 0.8731, AUC 0.9352430105209351
Test Epoch18 layer4 Acc 0.8733, AUC 0.936896026134491
gc 0
Train Epoch19 Acc 0.9808 (39232/40000), AUC 0.9959245920181274
Test Epoch19 layer0 Acc 0.8797, AUC 0.9410517811775208
Test Epoch19 layer1 Acc 0.8726, AUC 0.9258742332458496
Test Epoch19 layer2 Acc 0.8724, AUC 0.9364426136016846
Test Epoch19 layer3 Acc 0.8725, AUC 0.9360012412071228
Test Epoch19 layer4 Acc 0.8726, AUC 0.9365180730819702
gc 0
Train Epoch20 Acc 0.98075 (39230/40000), AUC 0.9962908029556274
Test Epoch20 layer0 Acc 0.8784, AUC 0.9408012628555298
Test Epoch20 layer1 Acc 0.871, AUC 0.9254152774810791
Test Epoch20 layer2 Acc 0.8723, AUC 0.9350655674934387
Test Epoch20 layer3 Acc 0.872, AUC 0.9340907335281372
Test Epoch20 layer4 Acc 0.8721, AUC 0.9358018636703491
gc 0
Train Epoch21 Acc 0.981125 (39245/40000), AUC 0.9960372447967529
Test Epoch21 layer0 Acc 0.8784, AUC 0.940679669380188
Test Epoch21 layer1 Acc 0.8721, AUC 0.9245414137840271
Test Epoch21 layer2 Acc 0.8722, AUC 0.9347419738769531
Test Epoch21 layer3 Acc 0.8719, AUC 0.9340399503707886
Test Epoch21 layer4 Acc 0.8719, AUC 0.9352364540100098
gc 0
Train Epoch22 Acc 0.981475 (39259/40000), AUC 0.996226966381073
Test Epoch22 layer0 Acc 0.8778, AUC 0.9404706358909607
Test Epoch22 layer1 Acc 0.8698, AUC 0.9236060380935669
Test Epoch22 layer2 Acc 0.8711, AUC 0.9338723421096802
Test Epoch22 layer3 Acc 0.8706, AUC 0.9322684407234192
Test Epoch22 layer4 Acc 0.8707, AUC 0.9347922801971436
gc 0
Train Epoch23 Acc 0.981225 (39249/40000), AUC 0.9964358806610107
Test Epoch23 layer0 Acc 0.878, AUC 0.9402973055839539
Test Epoch23 layer1 Acc 0.8713, AUC 0.9235512018203735
Test Epoch23 layer2 Acc 0.8717, AUC 0.9343113303184509
Test Epoch23 layer3 Acc 0.8715, AUC 0.9333409070968628
Test Epoch23 layer4 Acc 0.8714, AUC 0.9346882104873657
gc 0
Train Epoch24 Acc 0.981725 (39269/40000), AUC 0.9964665174484253
Test Epoch24 layer0 Acc 0.8761, AUC 0.9401070475578308
Test Epoch24 layer1 Acc 0.8701, AUC 0.9232804775238037
Test Epoch24 layer2 Acc 0.8702, AUC 0.9332557916641235
Test Epoch24 layer3 Acc 0.8701, AUC 0.9317351579666138
Test Epoch24 layer4 Acc 0.8703, AUC 0.9346470236778259
gc 0
Train Epoch25 Acc 0.981775 (39271/40000), AUC 0.9962233304977417
Test Epoch25 layer0 Acc 0.877, AUC 0.9400994181632996
Test Epoch25 layer1 Acc 0.8703, AUC 0.9230920076370239
Test Epoch25 layer2 Acc 0.8709, AUC 0.9332459568977356
Test Epoch25 layer3 Acc 0.8711, AUC 0.9317787885665894
Test Epoch25 layer4 Acc 0.8715, AUC 0.9344289302825928
gc 0
Train Epoch26 Acc 0.981925 (39277/40000), AUC 0.996626079082489
Test Epoch26 layer0 Acc 0.8777, AUC 0.9400863647460938
Test Epoch26 layer1 Acc 0.8703, AUC 0.9225954413414001
Test Epoch26 layer2 Acc 0.8711, AUC 0.9329996109008789
Test Epoch26 layer3 Acc 0.8711, AUC 0.931840181350708
Test Epoch26 layer4 Acc 0.8711, AUC 0.9339593648910522
gc 0
Train Epoch27 Acc 0.982075 (39283/40000), AUC 0.9963871240615845
Test Epoch27 layer0 Acc 0.8772, AUC 0.9400023221969604
Test Epoch27 layer1 Acc 0.871, AUC 0.9224391579627991
Test Epoch27 layer2 Acc 0.8712, AUC 0.9329950213432312
Test Epoch27 layer3 Acc 0.8708, AUC 0.9320664405822754
Test Epoch27 layer4 Acc 0.8708, AUC 0.9338356256484985
gc 0
Train Epoch28 Acc 0.9826 (39304/40000), AUC 0.996424674987793
Test Epoch28 layer0 Acc 0.877, AUC 0.9399360418319702
Test Epoch28 layer1 Acc 0.8706, AUC 0.9223071336746216
Test Epoch28 layer2 Acc 0.8708, AUC 0.9330088496208191
Test Epoch28 layer3 Acc 0.871, AUC 0.9322823286056519
Test Epoch28 layer4 Acc 0.8709, AUC 0.9335154294967651
gc 0
Train Epoch29 Acc 0.981975 (39279/40000), AUC 0.9966076016426086
Test Epoch29 layer0 Acc 0.8777, AUC 0.9399293661117554
Test Epoch29 layer1 Acc 0.8705, AUC 0.922318696975708
Test Epoch29 layer2 Acc 0.8709, AUC 0.9328089356422424
Test Epoch29 layer3 Acc 0.8706, AUC 0.9321368932723999
Test Epoch29 layer4 Acc 0.8706, AUC 0.9337117671966553
Best AUC 0.9587879180908203
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_transformeral_l5_pad300//imdb_transformeral_l5.pt
[[4291  659]
 [ 433 4617]]
Figure(640x480)
[[4563  387]
 [ 685 4365]]
Figure(640x480)
[[4475  475]
 [ 574 4476]]
Figure(640x480)
[[4516  434]
 [ 628 4422]]
Figure(640x480)
[[4540  410]
 [ 648 4402]]
Figure(640x480)
