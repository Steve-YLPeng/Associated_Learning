Load ckpt from ./ckpt/mask1//kdd99/kdd99_linearal_l10_m1.pt
layer_mask {1}
Start Training
gc 9
[[4.76674396e+03 2.90883654e+00]
 [3.11826303e+00 6.30153332e+00]
 [9.79762675e+02 8.03188562e+02]
 [7.67076979e+02 5.97664833e+02]
 [6.61004690e+02 4.65148648e+02]
 [4.86841988e+02 4.64706849e+02]
 [4.65526050e+02 3.54436758e+02]
 [3.97512809e+02 3.42072482e+02]
 [3.26694634e+02 3.66437241e+02]
 [3.49924441e+02 3.00847293e+02]]
Train Epoch0 Acc 0.17113929177107853 (67612/395070), AUC 0.5883422493934631
Test Epoch0 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch0 layer1 Acc 0.9961932531486656, AUC 0.981259286403656
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearal_l10_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.0005163406633458874, AUC 0.5898719429969788
Test Epoch0 layer3 Acc 0.18962863969546026, AUC 0.47730323672294617
Test Epoch0 layer4 Acc 0.5687948001457903, AUC 0.72579026222229
Test Epoch0 layer5 Acc 0.21877657635767223, AUC 0.3704010248184204
Test Epoch0 layer6 Acc 0.22008261450613534, AUC 0.5198748111724854
Test Epoch0 layer7 Acc 0.21795650589235815, AUC 0.6726817488670349
Test Epoch0 layer8 Acc 0.004464828088932086, AUC 0.36414527893066406
Test Epoch0 layer9 Acc 0.10072692665937714, AUC 0.6586310863494873
gc 0
[[4.76674402e+03 2.91103018e+00]
 [1.98219567e-02 1.83296932e+00]
 [9.51125002e+02 8.02503579e+02]
 [7.45151823e+02 5.89198455e+02]
 [6.47021708e+02 4.70966839e+02]
 [4.78650387e+02 4.69438412e+02]
 [4.63722129e+02 3.51888641e+02]
 [3.97442877e+02 3.57392235e+02]
 [3.26750657e+02 3.80620862e+02]
 [3.46692115e+02 3.03946098e+02]]
Train Epoch1 Acc 0.06382160123522414 (25214/395070), AUC 0.5632959604263306
Test Epoch1 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch1 layer1 Acc 0.9963957396833111, AUC 0.9936322569847107
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearal_l10_m2.pt  ,ep 1
Test Epoch1 layer2 Acc 0.021068723929858663, AUC 0.5552704334259033
Test Epoch1 layer3 Acc 0.19673591706151541, AUC 0.47242477536201477
Test Epoch1 layer4 Acc 0.5687036812051999, AUC 0.6138553023338318
Test Epoch1 layer5 Acc 0.21921192240715992, AUC 0.32748672366142273
Test Epoch1 layer6 Acc 0.22211760417932208, AUC 0.5050426721572876
Test Epoch1 layer7 Acc 0.21925241971408901, AUC 0.6921358704566956
Test Epoch1 layer8 Acc 0.004636941643380715, AUC 0.41400763392448425
Test Epoch1 layer9 Acc 0.011086137771838173, AUC 0.5321862101554871
gc 0
[[4.76674419e+03 2.90968738e+00]
 [2.05976184e-02 1.49214258e+00]
 [8.62150469e+02 7.79443695e+02]
 [6.95171451e+02 5.68099303e+02]
 [6.09977792e+02 4.67299431e+02]
 [4.53261054e+02 4.61188420e+02]
 [4.48543701e+02 3.55038334e+02]
 [3.87617904e+02 3.62398794e+02]
 [3.21149068e+02 3.67242529e+02]
 [3.43495322e+02 2.97637731e+02]]
Train Epoch2 Acc 0.013865897182777736 (5478/395070), AUC 0.5087459087371826
Test Epoch2 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch2 layer1 Acc 0.997175312841696, AUC 0.9937843084335327
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearal_l10_m2.pt  ,ep 2
Test Epoch2 layer2 Acc 0.12653383549993927, AUC 0.5487813353538513
Test Epoch2 layer3 Acc 0.19689790628923176, AUC 0.48863908648490906
Test Epoch2 layer4 Acc 0.5681468432349249, AUC 0.5992575287818909
Test Epoch2 layer5 Acc 0.21921192240715992, AUC 0.34774675965309143
Test Epoch2 layer6 Acc 0.22293767464463612, AUC 0.5299568772315979
Test Epoch2 layer7 Acc 0.21707568946665046, AUC 0.6980347037315369
Test Epoch2 layer8 Acc 0.004667314623577532, AUC 0.4507238566875458
Test Epoch2 layer9 Acc 0.008281699266998744, AUC 0.5210801959037781
gc 0
[[4.76674406e+03 2.90900043e+00]
 [1.80233470e-02 1.30771852e+00]
 [7.84621329e+02 7.50784614e+02]
 [6.47692699e+02 5.60467288e+02]
 [5.66568168e+02 4.68960483e+02]
 [4.25440385e+02 4.67906484e+02]
 [4.36671389e+02 3.66435643e+02]
 [3.77057018e+02 3.77068116e+02]
 [3.15319099e+02 3.73697029e+02]
 [3.41205071e+02 3.01143913e+02]]
Train Epoch3 Acc 0.006707672058116283 (2650/395070), AUC 0.5082715153694153
Test Epoch3 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch3 layer1 Acc 0.997246183128822, AUC 0.9945003390312195
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearal_l10_m2.pt  ,ep 3
Test Epoch3 layer2 Acc 0.12545053253958613, AUC 0.581606924533844
Test Epoch3 layer3 Acc 0.19689790628923176, AUC 0.5754150748252869
Test Epoch3 layer4 Acc 0.5694832543635848, AUC 0.6739357113838196
Test Epoch3 layer5 Acc 0.2176122787834609, AUC 0.3552221357822418
Test Epoch3 layer6 Acc 0.2913173773944033, AUC 0.5459613800048828
Test Epoch3 layer7 Acc 0.2169137002389341, AUC 0.6699041724205017
Test Epoch3 layer8 Acc 0.004515449722593447, AUC 0.4686167538166046
Test Epoch3 layer9 Acc 0.004515449722593447, AUC 0.519375205039978
gc 0
[[4.76674412e+03 2.91101354e+00]
 [1.52705671e-02 1.18137692e+00]
 [7.37552940e+02 7.33752387e+02]
 [6.12486875e+02 5.64298997e+02]
 [5.31483743e+02 4.66488139e+02]
 [4.05650302e+02 4.70285682e+02]
 [4.31102381e+02 3.75873691e+02]
 [3.70530739e+02 3.89542569e+02]
 [3.11114217e+02 3.84545724e+02]
 [3.40127161e+02 3.05172706e+02]]
Train Epoch4 Acc 0.008193484698914117 (3237/395070), AUC 0.49916326999664307
Test Epoch4 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch4 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearal_l10_m2.pt  ,ep 4
Test Epoch4 layer2 Acc 0.17393593326043819, AUC 0.6115625500679016
Test Epoch4 layer3 Acc 0.19691815494269632, AUC 0.5991160869598389
Test Epoch4 layer4 Acc 0.568784675819058, AUC 0.6758186221122742
Test Epoch4 layer5 Acc 0.21726805167456364, AUC 0.3580780327320099
Test Epoch4 layer6 Acc 0.28845219292917024, AUC 0.6348830461502075
Test Epoch4 layer7 Acc 0.7829749321670109, AUC 0.615767776966095
Test Epoch4 layer8 Acc 0.004535698376057992, AUC 0.4423433542251587
Test Epoch4 layer9 Acc 0.010296440286720934, AUC 0.5063856840133667
gc 0
[[4.76674396e+03 2.90907832e+00]
 [1.50078349e-02 1.11146941e+00]
 [7.15305296e+02 7.31546373e+02]
 [5.92151929e+02 5.77848637e+02]
 [5.13690767e+02 4.73755681e+02]
 [3.97877093e+02 4.77483448e+02]
 [4.28782056e+02 3.86754566e+02]
 [3.66416097e+02 3.96104497e+02]
 [3.07772564e+02 3.93766189e+02]
 [3.41608230e+02 3.12108555e+02]]
Train Epoch5 Acc 0.03895765307413876 (15391/395070), AUC 0.48224228620529175
Test Epoch5 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch5 layer1 Acc 0.9976106588911837, AUC 0.9946444034576416
Test Epoch5 layer2 Acc 0.18491070343822136, AUC 0.5772621631622314
Test Epoch5 layer3 Acc 0.19691815494269632, AUC 0.6350891590118408
Test Epoch5 layer4 Acc 0.5688049244725226, AUC 0.6758700013160706
Test Epoch5 layer5 Acc 0.21722755436763455, AUC 0.35355496406555176
Test Epoch5 layer6 Acc 0.221631636496173, AUC 0.67238849401474
Test Epoch5 layer7 Acc 0.7844125865629935, AUC 0.5971881747245789
Test Epoch5 layer8 Acc 0.004545822702790264, AUC 0.4473278224468231
Test Epoch5 layer9 Acc 0.06415785850240958, AUC 0.45964840054512024
gc 0
[[4.76674410e+03 2.90895999e+00]
 [1.39505130e-02 1.03517395e+00]
 [7.07927802e+02 7.31716579e+02]
 [5.78828126e+02 5.91416305e+02]
 [5.03290800e+02 4.79784172e+02]
 [3.95417880e+02 4.82170929e+02]
 [4.30776029e+02 3.97701783e+02]
 [3.65213686e+02 3.94800515e+02]
 [3.06803469e+02 3.99271227e+02]
 [3.44655816e+02 3.16062393e+02]]
Train Epoch6 Acc 0.07605740754802946 (30048/395070), AUC 0.46069690585136414
Test Epoch6 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch6 layer1 Acc 0.9976410318713805, AUC 0.9947822093963623
Test Epoch6 layer2 Acc 0.18783663386384805, AUC 0.573788583278656
Test Epoch6 layer3 Acc 0.19692827926942857, AUC 0.6679473519325256
Test Epoch6 layer4 Acc 0.5693415137893331, AUC 0.7061660289764404
Test Epoch6 layer5 Acc 0.21720730571417002, AUC 0.40340951085090637
Test Epoch6 layer6 Acc 0.3219535900862593, AUC 0.699852466583252
Test Epoch6 layer7 Acc 0.7872575223747621, AUC 0.6015769243240356
Test Epoch6 layer8 Acc 0.004728060583971166, AUC 0.43676528334617615
Test Epoch6 layer9 Acc 0.09787186652087636, AUC 0.4681968688964844
gc 0
[[4.76674401e+03 2.90967548e+00]
 [1.34627247e-02 9.49770376e-01]
 [7.10515597e+02 7.38620567e+02]
 [5.73244534e+02 5.97373830e+02]
 [4.98029728e+02 4.87700224e+02]
 [3.97684192e+02 4.87494585e+02]
 [4.36682746e+02 4.09856564e+02]
 [3.69651763e+02 4.01298503e+02]
 [3.09398860e+02 4.10166686e+02]
 [3.46347726e+02 3.23372210e+02]]
Train Epoch7 Acc 0.08045662793935252 (31786/395070), AUC 0.4335549473762512
Test Epoch7 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch7 layer1 Acc 0.9976106588911837, AUC 0.994761049747467
Test Epoch7 layer2 Acc 0.19511602478435183, AUC 0.5842301249504089
Test Epoch7 layer3 Acc 0.19692827926942857, AUC 0.6391111016273499
Test Epoch7 layer4 Acc 0.5708804114526383, AUC 0.7204903960227966
Test Epoch7 layer5 Acc 0.21721743004090227, AUC 0.4036729037761688
Test Epoch7 layer6 Acc 0.27132183209816546, AUC 0.7527244091033936
Test Epoch7 layer7 Acc 0.788705301097477, AUC 0.6245095729827881
Test Epoch7 layer8 Acc 0.004586320009719353, AUC 0.43672171235084534
Test Epoch7 layer9 Acc 0.0859049123233305, AUC 0.4489884376525879
gc 0
[[4.76674399e+03 2.90889782e+00]
 [1.46450056e-02 9.10009488e-01]
 [7.15933165e+02 7.40776435e+02]
 [5.72572143e+02 6.04608207e+02]
 [4.96863971e+02 4.90762535e+02]
 [4.03310919e+02 4.94304438e+02]
 [4.47388095e+02 4.19423028e+02]
 [3.79011955e+02 4.02772644e+02]
 [3.15707383e+02 4.14974890e+02]
 [3.48538665e+02 3.26440258e+02]]
Train Epoch8 Acc 0.0939327207836586 (37110/395070), AUC 0.41878682374954224
Test Epoch8 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch8 layer1 Acc 0.9978131454258292, AUC 0.9953241348266602
Test Epoch8 layer2 Acc 0.1877455149232576, AUC 0.5920175313949585
Test Epoch8 layer3 Acc 0.19693840359616085, AUC 0.666093647480011
Test Epoch8 layer4 Acc 0.571386627789252, AUC 0.7457902431488037
Test Epoch8 layer5 Acc 0.21719718138743774, AUC 0.3432547152042389
Test Epoch8 layer6 Acc 0.2207913173773944, AUC 0.738883376121521
Test Epoch8 layer7 Acc 0.7879662252460211, AUC 0.6084975600242615
Test Epoch8 layer8 Acc 0.004545822702790264, AUC 0.44692105054855347
Test Epoch8 layer9 Acc 0.11443526505487385, AUC 0.40996253490448
gc 0
[[4.76674405e+03 2.90888870e+00]
 [1.51485815e-03 7.78067883e-01]
 [7.20871934e+02 7.47698881e+02]
 [5.69083033e+02 6.08710984e+02]
 [4.96630038e+02 4.94215713e+02]
 [4.07233340e+02 4.99667317e+02]
 [4.53428411e+02 4.26401423e+02]
 [3.85285065e+02 4.05489039e+02]
 [3.19014496e+02 4.16966386e+02]
 [3.47986643e+02 3.27347185e+02]]
Train Epoch9 Acc 0.11145872883286506 (44034/395070), AUC 0.4017343819141388
Test Epoch9 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch9 layer1 Acc 0.9978536427327582, AUC 0.9954457879066467
Test Epoch9 layer2 Acc 0.19638156562588588, AUC 0.5928183794021606
Test Epoch9 layer3 Acc 0.19692827926942857, AUC 0.6516247391700745
Test Epoch9 layer4 Acc 0.5702020815615761, AUC 0.7215612530708313
Test Epoch9 layer5 Acc 0.21718705706070546, AUC 0.4013836979866028
Test Epoch9 layer6 Acc 0.24809662657433282, AUC 0.7374435067176819
Test Epoch9 layer7 Acc 0.7875713765034625, AUC 0.6214528679847717
Test Epoch9 layer8 Acc 0.004252217227554368, AUC 0.44663897156715393
Test Epoch9 layer9 Acc 0.10225569999595027, AUC 0.4151352047920227
Best AUC 0.9955844879150391
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//kdd99/kdd99_linearal_l10_m2.pt
[[56147     0    11     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19416    15     0     4     0     4     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    30     0     0   219     1     0     0     0     0]
 [    0    24    14     0     0     0   170     0     0     0     0]
 [    0     0   130     0     0     0     0    74     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    6     3    26     0     0    18     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19423     7     0     2     0     6     0     0     0]
 [    0     0    12   429     0     0     0     0     0     0     0]
 [    5     0    23     0   290     0     0     0     0     0     0]
 [    0     0    19     0     0   231     0     0     0     0     0]
 [    0     7     6     0     0     0   195     0     0     0     0]
 [    0     0    89     0     0     0     0   115     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [   21    20    11     0     0     0     0     1     0     0     0]
 [   15     1    28     0     0     3     0     0     0     0     0]]
Figure(640x480)
[[    0    70    36     0 56052     0     0     0     0     0     0]
 [    5     9 18997     0     0   113     0     0  2317     0     0]
 [ 2564    89 16793     4     2     4     0     0     0     0     0]
 [    1     0    64   376     0     0     0     0     0     0     0]
 [  276     5    37     0     0     0     0     0     0     0     0]
 [    1   221     9     0     0     0    19     0     0     0     0]
 [   20     0     9     5     0     1     0     0   173     0     0]
 [  193     0    11     0     0     0     0     0     0     0     0]
 [    0     0     1     0     0   195     0     0     0     0     0]
 [   11    20     6     0     0    16     0     0     0     0     0]
 [    0    24     5    16     0     0     0     0     0     0     2]]
Figure(640x480)
[[    0     0    38     0     0 56120     0     0     0     0     0]
 [    0     0 21441     0     0     0     0     0     0     0     0]
 [    0     1 19450     0     0     5     0     0     0     0     0]
 [    0     0   441     0     0     0     0     0     0     0     0]
 [    0     0   316     0     0     2     0     0     0     0     0]
 [    0     0   250     0     0     0     0     0     0     0     0]
 [    0     0    52    11   145     0     0     0     0     0     0]
 [    0     0   204     0     0     0     0     0     0     0     0]
 [    0     0     3     0     0   193     0     0     0     0     0]
 [    0     0    52     0     1     0     0     0     0     0     0]
 [    0     0    47     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56087     0     0     0     0     0     0    71     0     0     0]
 [    0     0     0     0     0     0    29 17350  4062     0     0]
 [    6     0     0    13     0    23     0 19403    11     0     0]
 [   22     0     0     0     0   411     0     2     0     6     0]
 [    0     0     0     0     0     0     0    40   278     0     0]
 [    0     0     0     0     0     0     0   245     5     0     0]
 [  156     0     0     0     0     0     0    36    16     0     0]
 [   12     0     0     5     0    25     0    93    69     0     0]
 [    0     0     0     0     0     3     0   193     0     0     0]
 [    0     0     0     0     0    16     0    34     3     0     0]
 [    0     0     0     0     0     1     0    46     0     0     0]]
Figure(640x480)
[[    0    40     0     0  3882 52236     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [    0 19414     0     9    31     2     0     0     0     0     0]
 [    0   441     0     0     0     0     0     0     0     0     0]
 [    0   299     0     0    19     0     0     0     0     0     0]
 [    0   250     0     0     0     0     0     0     0     0     0]
 [    0   202     0     0     6     0     0     0     0     0     0]
 [    0    75     0   129     0     0     0     0     0     0     0]
 [    3   193     0     0     0     0     0     0     0     0     0]
 [    0    53     0     0     0     0     0     0     0     0     0]
 [    0    28     0     0    19     0     0     0     0     0     0]]
Figure(640x480)
[[    0 10785     0 45373     0     0     0     0     0     0     0]
 [    0 21436     5     0     0     0     0     0     0     0     0]
 [    0 12515  6778     0    23     1     0     0     0   139     0]
 [    0   371    55     0    14     1     0     0     0     0     0]
 [    0    28    13     0   277     0     0     0     0     0     0]
 [    0    24    26     0   200     0     0     0     0     0     0]
 [    0   125    69     0     5     9     0     0     0     0     0]
 [    0   145    59     0     0     0     0     0     0     0     0]
 [    0   196     0     0     0     0     0     0     0     0     0]
 [    0    53     0     0     0     0     0     0     0     0     0]
 [    0    47     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[55914   244     0     0     0     0     0     0     0     0     0]
 [    0 21422     0    19     0     0     0     0     0     0     0]
 [    2 19447     0     4     0     3     0     0     0     0     0]
 [    0   441     0     0     0     0     0     0     0     0     0]
 [    0   318     0     0     0     0     0     0     0     0     0]
 [    0   250     0     0     0     0     0     0     0     0     0]
 [    0   208     0     0     0     0     0     0     0     0     0]
 [    0   182     0    13     0     9     0     0     0     0     0]
 [    0   194     0     1     0     1     0     0     0     0     0]
 [    0    43     0    10     0     0     0     0     0     0     0]
 [    0    31     0    16     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0 56124    34     0     0     0     0     0     0     0]
 [    0     0     0 21441     0     0     0     0     0     0     0]
 [    0     0     7 19448     1     0     0     0     0     0     0]
 [    0     0     0   441     0     0     0     0     0     0     0]
 [    0     0   273    45     0     0     0     0     0     0     0]
 [    0     0    10   240     0     0     0     0     0     0     0]
 [    0     0    47   161     0     0     0     0     0     0     0]
 [    0     0    54   149     0     1     0     0     0     0     0]
 [    0     0     0   196     0     0     0     0     0     0     0]
 [    0     0     0    53     0     0     0     0     0     0     0]
 [    0     0     0    47     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0 56059    25    74     0     0     0     0     0     0     0]
 [    0     0 21361    80     0     0     0     0     0     0     0]
 [    0     2  1009 18444     0     0     0     1     0     0     0]
 [    0     0   433     8     0     0     0     0     0     0     0]
 [    0     0    10   308     0     0     0     0     0     0     0]
 [    0     0     0   250     0     0     0     0     0     0     0]
 [    0     0   145    63     0     0     0     0     0     0     0]
 [    0     0     8   196     0     0     0     0     0     0     0]
 [    0     0   194     2     0     0     0     0     0     0     0]
 [    0     0    16    37     0     0     0     0     0     0     0]
 [    0     0    18    29     0     0     0     0     0     0     0]]
Figure(640x480)
