layer_mask {0}
Start Training
gc 0
[[4836.88844848    6.38424751]
 [ 999.95856851  731.19644451]
 [ 764.91820394  613.66004047]
 [ 681.04746054  438.7886797 ]
 [ 564.04026311  398.88553382]
 [ 437.06363252  315.1939096 ]
 [ 397.37135772  291.16761795]
 [ 365.54831636  259.34871911]
 [ 327.44586876  300.90407369]
 [ 288.1908338   266.7989672 ]]
Train Epoch0 Acc 0.0002607132913154631 (103/395070), AUC 0.42832037806510925
Test Epoch0 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Save ckpt to ./ckpt/mask1//kdd99/kdd99_linearal_l10_m1.pt  ,ep 0
Test Epoch0 layer1 Acc 0.054529623780018625, AUC 0.5911614894866943
Test Epoch0 layer2 Acc 0.002672822257319888, AUC 0.5876933932304382
Test Epoch0 layer3 Acc 0.17986878872554976, AUC 0.3402850925922394
Test Epoch0 layer4 Acc 0.5687036812051999, AUC 0.4234384596347809
Test Epoch0 layer5 Acc 0.0033714008018466773, AUC 0.30431002378463745
Test Epoch0 layer6 Acc 0.2256509942088851, AUC 0.6397387385368347
Test Epoch0 layer7 Acc 0.5715283683635038, AUC 0.5915628671646118
Test Epoch0 layer8 Acc 0.08527720406592962, AUC 0.7050978541374207
Test Epoch0 layer9 Acc 6.0745960393633824e-05, AUC 0.5200435519218445
gc 0
[[4.76629925e+03 2.82395350e+00]
 [1.27036690e+03 8.98189676e+02]
 [9.18480271e+02 7.53538375e+02]
 [8.05062078e+02 5.45546902e+02]
 [6.47776897e+02 4.75416288e+02]
 [4.96114188e+02 3.73121058e+02]
 [4.48841466e+02 3.40019152e+02]
 [4.17617911e+02 2.91037431e+02]
 [3.61909193e+02 3.25322530e+02]
 [3.20500737e+02 2.92105543e+02]]
Train Epoch1 Acc 0.00010631027412863543 (42/395070), AUC 0.5460160374641418
Test Epoch1 layer0 Acc 0.9966792208318147, AUC 0.9741292595863342
Test Epoch1 layer1 Acc 0.04654152998825578, AUC 0.5687897801399231
Test Epoch1 layer2 Acc 0.003219535900862593, AUC 0.6006624698638916
Test Epoch1 layer3 Acc 0.017423966306240636, AUC 0.28736093640327454
Test Epoch1 layer4 Acc 0.5683189567893735, AUC 0.4018765687942505
Test Epoch1 layer5 Acc 0.0016401409306281132, AUC 0.2774718999862671
Test Epoch1 layer6 Acc 0.21997124691208034, AUC 0.6491215229034424
Test Epoch1 layer7 Acc 0.5730672660268092, AUC 0.5262283682823181
Test Epoch1 layer8 Acc 0.1079455716194873, AUC 0.5988595485687256
Test Epoch1 layer9 Acc 0.00010124326732272303, AUC 0.5434808135032654
gc 0
[[4.76604780e+03 2.54954421e+00]
 [1.40054763e+03 9.83454519e+02]
 [9.85327866e+02 8.23941515e+02]
 [8.54035855e+02 6.01240647e+02]
 [6.78892008e+02 5.06584799e+02]
 [5.18330678e+02 3.98979768e+02]
 [4.69073330e+02 3.65057717e+02]
 [4.34906004e+02 3.04179313e+02]
 [3.73710407e+02 3.38661938e+02]
 [3.30953442e+02 3.00075632e+02]]
Train Epoch2 Acc 0.00010884147113169819 (43/395070), AUC 0.5560418963432312
Test Epoch2 layer0 Acc 0.9967804640991375, AUC 0.8950436115264893
Test Epoch2 layer1 Acc 0.02354918397926538, AUC 0.5023905038833618
Test Epoch2 layer2 Acc 0.0014174057425181226, AUC 0.5890377163887024
Test Epoch2 layer3 Acc 0.001366784108856761, AUC 0.2919420301914215
Test Epoch2 layer4 Acc 0.5681265945814603, AUC 0.47267580032348633
Test Epoch2 layer5 Acc 0.0020451139999190055, AUC 0.27307063341140747
Test Epoch2 layer6 Acc 0.20098813428906978, AUC 0.6625223755836487
Test Epoch2 layer7 Acc 0.5749706394524764, AUC 0.48919960856437683
Test Epoch2 layer8 Acc 0.12112744502490584, AUC 0.562649667263031
Test Epoch2 layer9 Acc 7.087028712590613e-05, AUC 0.5586678981781006
gc 0
[[4.76601876e+03 2.44983047e+00]
 [1.50897549e+03 1.04206039e+03]
 [1.03862723e+03 8.75883941e+02]
 [8.90988405e+02 6.35833809e+02]
 [7.01617184e+02 5.25802192e+02]
 [5.34737240e+02 4.15032053e+02]
 [4.84578438e+02 3.79493354e+02]
 [4.47464241e+02 3.17699438e+02]
 [3.82458250e+02 3.49956873e+02]
 [3.38674100e+02 3.07768026e+02]]
Train Epoch3 Acc 8.099830409800795e-05 (32/395070), AUC 0.5520036816596985
Test Epoch3 layer0 Acc 0.9974891669703965, AUC 0.8697891235351562
Test Epoch3 layer1 Acc 0.004545822702790264, AUC 0.48463326692581177
Test Epoch3 layer2 Acc 0.0020754869801158224, AUC 0.6023425459861755
Test Epoch3 layer3 Acc 0.0005163406633458874, AUC 0.2564435601234436
Test Epoch3 layer4 Acc 0.5680557242943344, AUC 0.5247656106948853
Test Epoch3 layer5 Acc 0.002834811485036245, AUC 0.3176060914993286
Test Epoch3 layer6 Acc 0.19713076580407404, AUC 0.6595785617828369
Test Epoch3 layer7 Acc 0.5749908881059409, AUC 0.4357730746269226
Test Epoch3 layer8 Acc 0.11577167618353379, AUC 0.6350452899932861
Test Epoch3 layer9 Acc 6.0745960393633824e-05, AUC 0.5668153166770935
gc 0
[[4.76600642e+03 2.41569202e+00]
 [1.60591402e+03 1.08831337e+03]
 [1.08461095e+03 9.28519893e+02]
 [9.21171103e+02 6.68307262e+02]
 [7.19835248e+02 5.41968848e+02]
 [5.48040025e+02 4.27022341e+02]
 [4.97270519e+02 3.94957830e+02]
 [4.57217197e+02 3.30397325e+02]
 [3.89414101e+02 3.58305558e+02]
 [3.44898773e+02 3.14205292e+02]]
Train Epoch4 Acc 5.062394006125497e-05 (20/395070), AUC 0.5600698590278625
Test Epoch4 layer0 Acc 0.9976106588911837, AUC 0.8616840243339539
Test Epoch4 layer1 Acc 0.004009233385979832, AUC 0.4865725338459015
Test Epoch4 layer2 Acc 0.0016502652573603855, AUC 0.6035640835762024
Test Epoch4 layer3 Acc 0.000566962297007249, AUC 0.27894628047943115
Test Epoch4 layer4 Acc 0.5680455999676022, AUC 0.5865178108215332
Test Epoch4 layer5 Acc 0.002753816871178067, AUC 0.29984763264656067
Test Epoch4 layer6 Acc 0.19917587980399304, AUC 0.6534162163734436
Test Epoch4 layer7 Acc 0.5750111367594055, AUC 0.42731955647468567
Test Epoch4 layer8 Acc 0.10722674442149598, AUC 0.6713769435882568
Test Epoch4 layer9 Acc 3.0372980196816912e-05, AUC 0.5688068866729736
gc 0
[[4.76601255e+03 2.14252459e+00]
 [1.67289706e+03 1.12122568e+03]
 [1.11520043e+03 9.65464079e+02]
 [9.40192227e+02 6.88555610e+02]
 [7.32476119e+02 5.51766823e+02]
 [5.57300877e+02 4.32661386e+02]
 [5.02972909e+02 4.03921672e+02]
 [4.59968265e+02 3.37703835e+02]
 [3.91110301e+02 3.62497613e+02]
 [3.46931568e+02 3.18383579e+02]]
Train Epoch5 Acc 2.5311970030627484e-05 (10/395070), AUC 0.5699053406715393
Test Epoch5 layer0 Acc 0.997884015712955, AUC 0.861212968826294
Test Epoch5 layer1 Acc 0.004353460494877091, AUC 0.47647425532341003
Test Epoch5 layer2 Acc 0.0018527517920058317, AUC 0.6176744103431702
Test Epoch5 layer3 Acc 0.0005568379702749767, AUC 0.28337419033050537
Test Epoch5 layer4 Acc 0.5680051026606731, AUC 0.6253171563148499
Test Epoch5 layer5 Acc 0.0028854331186976066, AUC 0.31582966446876526
Test Epoch5 layer6 Acc 0.19978333940792936, AUC 0.6568335890769958
Test Epoch5 layer7 Acc 0.5750111367594055, AUC 0.415609747171402
Test Epoch5 layer8 Acc 0.1059004576195683, AUC 0.6461273431777954
Test Epoch5 layer9 Acc 1.0124326732272304e-05, AUC 0.5703205466270447
gc 0
[[4.76600532e+03 2.08642791e+00]
 [1.72646278e+03 1.15322065e+03]
 [1.14052272e+03 9.99454423e+02]
 [9.55651968e+02 7.06564420e+02]
 [7.44262348e+02 5.61881598e+02]
 [5.65994586e+02 4.37717317e+02]
 [5.06064353e+02 4.10248908e+02]
 [4.60600801e+02 3.43528226e+02]
 [3.91400345e+02 3.65398387e+02]
 [3.48370334e+02 3.21485296e+02]]
Train Epoch6 Acc 1.2655985015313742e-05 (5/395070), AUC 0.5678789615631104
Test Epoch6 layer0 Acc 0.9979751346535456, AUC 0.857328474521637
Test Epoch6 layer1 Acc 0.004201595593893006, AUC 0.4695700407028198
Test Epoch6 layer2 Acc 0.0019539950593285547, AUC 0.6295671463012695
Test Epoch6 layer3 Acc 0.0005264649900781598, AUC 0.2885708510875702
Test Epoch6 layer4 Acc 0.5678633620864213, AUC 0.6365848183631897
Test Epoch6 layer5 Acc 0.002966427732555785, AUC 0.31266215443611145
Test Epoch6 layer6 Acc 0.1966245494674604, AUC 0.6661624312400818
Test Epoch6 layer7 Acc 0.5749605151257441, AUC 0.42750856280326843
Test Epoch6 layer8 Acc 0.09785161786741181, AUC 0.609926164150238
Test Epoch6 layer9 Acc 2.0248653464544608e-05, AUC 0.5658276081085205
gc 0
[[4.76600524e+03 2.03463169e+00]
 [1.77957026e+03 1.18518847e+03]
 [1.16580031e+03 1.02831658e+03]
 [9.70973827e+02 7.21282877e+02]
 [7.55751067e+02 5.72186596e+02]
 [5.74642789e+02 4.44161967e+02]
 [5.09308068e+02 4.16539470e+02]
 [4.61243415e+02 3.47453287e+02]
 [3.91924663e+02 3.67630597e+02]
 [3.49822929e+02 3.24612395e+02]]
Train Epoch7 Acc 2.0249576024501988e-05 (8/395070), AUC 0.5634548664093018
Test Epoch7 layer0 Acc 0.9979953833070101, AUC 0.8568346500396729
Test Epoch7 layer1 Acc 0.004343336168144818, AUC 0.4618637263774872
Test Epoch7 layer2 Acc 0.0021564815939740006, AUC 0.6382097601890564
Test Epoch7 layer3 Acc 0.000566962297007249, AUC 0.29290491342544556
Test Epoch7 layer4 Acc 0.567853237759689, AUC 0.6466382741928101
Test Epoch7 layer5 Acc 0.002865184465233062, AUC 0.30575981736183167
Test Epoch7 layer6 Acc 0.19860891750698578, AUC 0.6476479172706604
Test Epoch7 layer7 Acc 0.5750010124326732, AUC 0.4399927854537964
Test Epoch7 layer8 Acc 0.09415623861013242, AUC 0.6061598062515259
Test Epoch7 layer9 Acc 3.0372980196816912e-05, AUC 0.5575358867645264
gc 0
[[4.76600522e+03 1.96346848e+00]
 [1.82203554e+03 1.21198098e+03]
 [1.18651230e+03 1.05362392e+03]
 [9.83398984e+02 7.35785931e+02]
 [7.64814307e+02 5.80927200e+02]
 [5.81679156e+02 4.49899506e+02]
 [5.11874409e+02 4.22382697e+02]
 [4.61487313e+02 3.51962503e+02]
 [3.92271759e+02 3.70055263e+02]
 [3.50772671e+02 3.27572402e+02]]
Train Epoch8 Acc 3.037436403675298e-05 (12/395070), AUC 0.5606299042701721
Test Epoch8 layer0 Acc 0.9980055076337424, AUC 0.8602256178855896
Test Epoch8 layer1 Acc 0.0052342769205847815, AUC 0.46084263920783997
Test Epoch8 layer2 Acc 0.002531081683068076, AUC 0.6535982489585876
Test Epoch8 layer3 Acc 0.0006884542177945167, AUC 0.29442718625068665
Test Epoch8 layer4 Acc 0.5680557242943344, AUC 0.6483098864555359
Test Epoch8 layer5 Acc 0.00285506013850079, AUC 0.2862166464328766
Test Epoch8 layer6 Acc 0.195753857368485, AUC 0.6378768086433411
Test Epoch8 layer7 Acc 0.5749908881059409, AUC 0.4376941919326782
Test Epoch8 layer8 Acc 0.0921516219171425, AUC 0.6008776426315308
Test Epoch8 layer9 Acc 5.0621633661361516e-05, AUC 0.5642894506454468
gc 0
[[4.76600522e+03 1.81487517e+00]
 [1.84563816e+03 1.22903167e+03]
 [1.19814634e+03 1.06963261e+03]
 [9.90511112e+02 7.46018065e+02]
 [7.70042080e+02 5.86748437e+02]
 [5.85800483e+02 4.54739377e+02]
 [5.13584595e+02 4.26806464e+02]
 [4.61806232e+02 3.55005528e+02]
 [3.92721238e+02 3.71672647e+02]
 [3.51354671e+02 3.29443600e+02]]
Train Epoch9 Acc 5.5686334067380463e-05 (22/395070), AUC 0.5648732781410217
Test Epoch9 layer0 Acc 0.9980358806139392, AUC 0.8599288463592529
Test Epoch9 layer1 Acc 0.005284898554246143, AUC 0.45929306745529175
Test Epoch9 layer2 Acc 0.0029765520592880575, AUC 0.6559423804283142
Test Epoch9 layer3 Acc 0.0007593245049204228, AUC 0.3106851875782013
Test Epoch9 layer4 Acc 0.5681164702547281, AUC 0.638161301612854
Test Epoch9 layer5 Acc 0.002834811485036245, AUC 0.28052380681037903
Test Epoch9 layer6 Acc 0.19892277163568622, AUC 0.643585205078125
Test Epoch9 layer7 Acc 0.5750010124326732, AUC 0.44038182497024536
Test Epoch9 layer8 Acc 0.07971894868991213, AUC 0.6054401993751526
Test Epoch9 layer9 Acc 3.0372980196816912e-05, AUC 0.5638179183006287
Best AUC 0.9860839247703552
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//kdd99/kdd99_linearal_l10_m1.pt
[[56147     0    11     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19416    15     0     4     0     4     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    30     0     0   219     1     0     0     0     0]
 [    0    24    14     0     0     0   170     0     0     0     0]
 [    0     0   130     0     0     0     0    74     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    6     3    26     0     0    18     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0 56154     4     0     0     0     0     0     0     0]
 [   17    28    24    96  4077     0     0 17199     0     0     0]
 [ 1054     5  5346  5455  1427     1  5796    11    45   315     1]
 [    0     0     0     8   431     0     2     0     0     0     0]
 [  285     0     7    25     1     0     0     0     0     0     0]
 [    0     0    47    36   165     0     0     0     0     2     0]
 [   30     1     0   151    10    14     1     0     0     1     0]
 [    2     0   159    30     1     0    12     0     0     0     0]
 [   69     0   120     0     0     7     0     0     0     0     0]
 [    7     0    44     0     0     0     0     0     0     2     0]
 [   18     0     3     2    21     0     0     0     0     3     0]]
Figure(640x480)
[[  258     0 55876     0     0    24     0     0     0     0     0]
 [    0     0     0     6     0 21379     0     0     2     0    54]
 [ 5594  3427     1     3  5668   154  2353   136     1     0  2119]
 [   18     2     0     0   380    39     0     0     0     0     2]
 [   37   242     0    30     0     1     0     0     0     0     8]
 [  162    88     0     0     0     0     0     0     0     0     0]
 [   61    42     0     0     0    16     0    88     0     0     1]
 [    2   128     0     0    64     1     0     5     0     0     4]
 [    0     0     0     0    11   185     0     0     0     0     0]
 [    1    30     0     1    21     0     0     0     0     0     0]
 [   27     3     0    17     0     0     0     0     0     0     0]]
Figure(640x480)
[[    2     4     0     0     0 56152     0     0     0     0     0]
 [    0 17361     0     0     0     3     0  4077     0     0     0]
 [ 8450   486   346     0   393  9016     0   717    48     0     0]
 [    4   356     0     0     0    60     0    21     0     0     0]
 [    4     2     0     0     0   312     0     0     0     0     0]
 [    0     0   193     0     0    57     0     0     0     0     0]
 [    6     1    10    22     0   146     0    23     0     0     0]
 [    1     6     4     0    15   119     0     0    59     0     0]
 [    1     0   194     0     0     1     0     0     0     0     0]
 [    9     0    39     0     0     5     0     0     0     0     0]
 [    0     3     1     0     0    43     0     0     0     0     0]]
Figure(640x480)
[[56137     0     0     0     0     0    16     5     0     0     0]
 [ 4069     8     0     0     0  2891 14466     6     0     0     1]
 [ 1688    80     0    34  1428  3857    84 12257     3     4    21]
 [   42     0     0     0     3     1     1   393     0     0     1]
 [    5     0     0   243     1    19    37    11     1     1     0]
 [  202     0     0    18    20     3     0     6     0     1     0]
 [  200     0     0     0     0     1     4     3     0     0     0]
 [   18     0     0     3     0   104     8    19     0    52     0]
 [    0     0     0     0   142    54     0     0     0     0     0]
 [    0     0     0     0    40     8     0     5     0     0     0]
 [    0     0     0     0    14     1     0    31     0     1     0]]
Figure(640x480)
[[    0    10     0 56140     0     8     0     0     0     0     0]
 [15390     0  6047     0     0     4     0     0     0     0     0]
 [  593   516   126   366   867 16973     0     0    15     0     0]
 [    0     0     0     0     0   167     0     0   274     0     0]
 [    0   304     2     3     8     1     0     0     0     0     0]
 [    0     1    44     0     6   199     0     0     0     0     0]
 [   42    32     1   130     2     1     0     0     0     0     0]
 [   57     3     2    21     0   121     0     0     0     0     0]
 [    0     1     0     0     0   195     0     0     0     0     0]
 [    0     0     0     0     0    53     0     0     0     0     0]
 [    0     0     0     3    18    26     0     0     0     0     0]]
Figure(640x480)
[[    0    63     4     0     0     0     0 56091     0     0     0]
 [    0 21392     5     0     0     7     0    36     1     0     0]
 [    0  4440   592     0    11  4723     0   253  9421    16     0]
 [    0   437     0     0     0     3     0     0     1     0     0]
 [    0    41     0     0   276     1     0     0     0     0     0]
 [    0     7   180     0     0     0     0    19     0    44     0]
 [    3   194     1     0    10     0     0     0     0     0     0]
 [    0    77    89     0     0     9     0     0    29     0     0]
 [    0    14     0     0     0     0     0    53     0   129     0]
 [    0    16     2     0     0     0     0     7     0    28     0]
 [    0    23    23     0     0     0     0     1     0     0     0]]
Figure(640x480)
[[56152     6     0     0     0     0     0     0     0     0     0]
 [  249    34     0     0     0 21158     0     0     0     0     0]
 [  558 12005     6  5825     0    63     0   107   892     0     0]
 [    0    64     0   240     0   137     0     0     0     0     0]
 [    7    10     0    12     0   283     0     5     0     1     0]
 [  222     9     0     0     0    19     0     0     0     0     0]
 [  136    18     0     0     0    46     0     0     0     8     0]
 [   63   129     0     9     0     3     0     0     0     0     0]
 [    0     0     0   196     0     0     0     0     0     0     0]
 [    0     2     0    48     3     0     0     0     0     0     0]
 [   25    22     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[   30     0     0     1     0 56126     0     1     0     0     0]
 [ 2370     0     1 14992     1  4077     0     0     0     0     0]
 [ 3189     0  8351  7400     0   512     0     4     0     0     0]
 [    0     0   431     3     0     7     0     0     0     0     0]
 [    5     0     0   269    34     4     0     6     0     0     0]
 [    5     0     3   237     0     5     0     0     0     0     0]
 [    1     0     1     4     1   201     0     0     0     0     0]
 [    0     0    59   127     0    18     0     0     0     0     0]
 [    0     0     0   174     0    22     0     0     0     0     0]
 [    0     0     2    48     0     3     0     0     0     0     0]
 [   22     0     1    24     0     0     0     0     0     0     0]]
Figure(640x480)
[[    5     0     0 56153     0     0     0     0     0     0     0]
 [    6     0     0 21433     0     0     0     2     0     0     0]
 [18957     0     1   387     0    13     0    98     0     0     0]
 [  441     0     0     0     0     0     0     0     0     0     0]
 [   22     0     2   291     0     2     0     1     0     0     0]
 [  249     0     0     1     0     0     0     0     0     0     0]
 [   25     0     0   183     0     0     0     0     0     0     0]
 [  125     0     0    79     0     0     0     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [   46     0     0     1     0     0     0     0     0     0     0]]
Figure(640x480)
