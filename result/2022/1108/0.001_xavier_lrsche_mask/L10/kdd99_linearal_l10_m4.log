Load ckpt from ./ckpt/mask3//kdd99/kdd99_linearal_l10_m3.pt
layer_mask {3}
Start Training
gc 9
[[4.76674396e+03 2.90893202e+00]
 [2.42025417e-02 1.23382829e+00]
 [1.38261388e-02 7.74764311e-01]
 [8.42314477e-01 1.56831648e+00]
 [2.82523263e+02 2.12082856e+02]
 [2.58352793e+02 2.46470211e+02]
 [2.67576682e+02 2.30465211e+02]
 [2.48088395e+02 1.86403810e+02]
 [2.93994614e+02 2.48055632e+02]
 [3.23257052e+02 1.98676656e+02]]
Train Epoch0 Acc 0.21707039258865518 (85758/395070), AUC 0.530413031578064
Test Epoch0 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch0 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch0 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch0 layer3 Acc 0.9978941400396873, AUC 0.9934877753257751
Save ckpt to ./ckpt/mask4//kdd99/kdd99_linearal_l10_m4.pt  ,ep 0
Test Epoch0 layer4 Acc 0.864030291985583, AUC 0.4594775438308716
Test Epoch0 layer5 Acc 0.00206536265338355, AUC 0.35987454652786255
Test Epoch0 layer6 Acc 0.0020147410197221883, AUC 0.6305376291275024
Test Epoch0 layer7 Acc 0.0002227351881099907, AUC 0.5400785803794861
Test Epoch0 layer8 Acc 8.099461385817843e-05, AUC 0.1660735160112381
Test Epoch0 layer9 Acc 0.21707568946665046, AUC 0.5304116010665894
gc 0
[[4.76674405e+03 2.91008928e+00]
 [2.42027234e-02 1.23400512e+00]
 [1.38263905e-02 7.74829359e-01]
 [9.82836299e-03 5.79743619e-01]
 [2.74352057e+02 2.07391242e+02]
 [2.52663703e+02 2.40755734e+02]
 [2.62792315e+02 2.31819734e+02]
 [2.43037098e+02 1.87234637e+02]
 [2.89958263e+02 2.43917410e+02]
 [3.16242975e+02 1.98122866e+02]]
Train Epoch1 Acc 0.21710329814969498 (85771/395070), AUC 0.5644983649253845
Test Epoch1 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch1 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch1 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch1 layer3 Acc 0.9978738913862228, AUC 0.9933969378471375
Test Epoch1 layer4 Acc 0.8056939213542299, AUC 0.4831351339817047
Test Epoch1 layer5 Acc 0.001994492366257644, AUC 0.3466644287109375
Test Epoch1 layer6 Acc 0.002024865346454461, AUC 0.6494656801223755
Test Epoch1 layer7 Acc 0.0002632324950390799, AUC 0.5402831435203552
Test Epoch1 layer8 Acc 0.00017211355444862918, AUC 0.16399666666984558
Test Epoch1 layer9 Acc 0.2171060624468473, AUC 0.5839789509773254
gc 0
[[4.76674399e+03 2.90884268e+00]
 [2.42019563e-02 1.23379021e+00]
 [1.38278090e-02 7.74735764e-01]
 [1.01483034e-02 5.04379251e-01]
 [2.38639483e+02 1.82751298e+02]
 [2.27856995e+02 2.16979940e+02]
 [2.42662854e+02 2.10267333e+02]
 [2.22061164e+02 1.74454111e+02]
 [2.72100299e+02 2.24768509e+02]
 [2.89244395e+02 1.86553618e+02]]
Train Epoch2 Acc 0.20500417647505506 (80991/395070), AUC 0.5712672472000122
Test Epoch2 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch2 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch2 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch2 layer3 Acc 0.9978232697525614, AUC 0.9923204183578491
Test Epoch2 layer4 Acc 0.7673227230389179, AUC 0.566765308380127
Test Epoch2 layer5 Acc 0.17581905803264083, AUC 0.3278382122516632
Test Epoch2 layer6 Acc 0.5704653140566153, AUC 0.6086949706077576
Test Epoch2 layer7 Acc 5.0621633661361516e-05, AUC 0.5716066956520081
Test Epoch2 layer8 Acc 0.0002429838415745353, AUC 0.17609868943691254
Test Epoch2 layer9 Acc 0.04529623780018629, AUC 0.5609714388847351
gc 0
[[4.76674398e+03 2.90890639e+00]
 [2.42025779e-02 1.23379150e+00]
 [1.38264536e-02 7.74733399e-01]
 [1.13002138e-02 4.29151717e-01]
 [2.10812615e+02 1.65000141e+02]
 [2.10196527e+02 1.96871184e+02]
 [2.28636332e+02 1.90589439e+02]
 [2.07835811e+02 1.61145833e+02]
 [2.57562140e+02 2.10428264e+02]
 [2.71110730e+02 1.75989703e+02]]
Train Epoch3 Acc 0.07866960285519022 (31080/395070), AUC 0.5255386829376221
Test Epoch3 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch3 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch3 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch3 layer3 Acc 0.9976410318713805, AUC 0.9943923354148865
Save ckpt to ./ckpt/mask4//kdd99/kdd99_linearal_l10_m4.pt  ,ep 3
Test Epoch3 layer4 Acc 0.7650447495241567, AUC 0.5368466973304749
Test Epoch3 layer5 Acc 0.21679220831814686, AUC 0.3402409255504608
Test Epoch3 layer6 Acc 0.5690276596606326, AUC 0.6408305168151855
Test Epoch3 layer7 Acc 0.00016198922771635686, AUC 0.503892719745636
Test Epoch3 layer8 Acc 0.004687563277042076, AUC 0.2168446183204651
Test Epoch3 layer9 Acc 0.04561009192888673, AUC 0.5122578740119934
gc 0
[[4.76674405e+03 2.90891928e+00]
 [2.42033805e-02 1.23380445e+00]
 [1.38265341e-02 7.74750240e-01]
 [8.38096592e-03 3.87759231e-01]
 [1.99184966e+02 1.59363295e+02]
 [2.02606848e+02 1.84446357e+02]
 [2.25679604e+02 1.80949451e+02]
 [2.03850398e+02 1.55467524e+02]
 [2.54823440e+02 2.06069870e+02]
 [2.62335592e+02 1.70906709e+02]]
Train Epoch4 Acc 0.0876199154580201 (34616/395070), AUC 0.49796196818351746
Test Epoch4 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch4 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch4 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch4 layer3 Acc 0.9977625237921678, AUC 0.9927059412002563
Test Epoch4 layer4 Acc 0.6450613534199976, AUC 0.4852145314216614
Test Epoch4 layer5 Acc 7.087028712590613e-05, AUC 0.21580423414707184
Test Epoch4 layer6 Acc 0.568561940630948, AUC 0.6159009337425232
Test Epoch4 layer7 Acc 0.0038877414651925647, AUC 0.5505709648132324
Test Epoch4 layer8 Acc 0.004869801158222978, AUC 0.2585519254207611
Test Epoch4 layer9 Acc 0.21686307860527274, AUC 0.49917319416999817
gc 0
[[4.76675116e+03 2.90930672e+00]
 [2.42025983e-02 1.23384781e+00]
 [1.38294456e-02 7.74772920e-01]
 [6.88552552e-03 3.73262603e-01]
 [2.02080182e+02 1.62849500e+02]
 [2.08345314e+02 1.81691639e+02]
 [2.33815106e+02 1.81206976e+02]
 [2.09818355e+02 1.58178219e+02]
 [2.60620466e+02 2.05926831e+02]
 [2.63391940e+02 1.70699924e+02]]
Train Epoch5 Acc 0.327995038853874 (129581/395070), AUC 0.5554633140563965
Test Epoch5 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch5 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch5 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch5 layer3 Acc 0.9977726481189001, AUC 0.994940996170044
Save ckpt to ./ckpt/mask4//kdd99/kdd99_linearal_l10_m4.pt  ,ep 5
Test Epoch5 layer4 Acc 0.5798809379176285, AUC 0.504396378993988
Test Epoch5 layer5 Acc 0.0012452921880694934, AUC 0.19768886268138885
Test Epoch5 layer6 Acc 0.5685720649576803, AUC 0.7100972533226013
Test Epoch5 layer7 Acc 0.00023285951484226298, AUC 0.5108359456062317
Test Epoch5 layer8 Acc 0.0021159842870449117, AUC 0.1631622314453125
Test Epoch5 layer9 Acc 0.7813550398898473, AUC 0.6093201637268066
gc 0
[[4.76674405e+03 2.90892898e+00]
 [2.42023920e-02 1.23379933e+00]
 [1.38308902e-02 7.74751922e-01]
 [1.01532057e-02 3.73426292e-01]
 [2.05503827e+02 1.70900391e+02]
 [2.15322812e+02 1.86316764e+02]
 [2.37673694e+02 1.80728696e+02]
 [2.11137857e+02 1.61572567e+02]
 [2.60148369e+02 2.06990223e+02]
 [2.60624995e+02 1.70651118e+02]]
Train Epoch6 Acc 0.31461006910167816 (124293/395070), AUC 0.5778622031211853
Test Epoch6 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch6 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch6 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch6 layer3 Acc 0.9979751346535456, AUC 0.994585394859314
Test Epoch6 layer4 Acc 0.5685720649576803, AUC 0.5474162697792053
Test Epoch6 layer5 Acc 0.21040375815008303, AUC 0.2345634400844574
Test Epoch6 layer6 Acc 0.568561940630948, AUC 0.6514888405799866
Test Epoch6 layer7 Acc 0.06451220993803912, AUC 0.6671873927116394
Test Epoch6 layer8 Acc 0.5730470173733446, AUC 0.4903824031352997
Test Epoch6 layer9 Acc 0.21712631110031183, AUC 0.5770930647850037
gc 0
[[4.76674408e+03 2.90890312e+00]
 [2.42031301e-02 1.23380699e+00]
 [1.38276342e-02 7.74750041e-01]
 [6.59531667e-03 3.77638583e-01]
 [2.07624459e+02 1.75088059e+02]
 [2.17999727e+02 1.87428387e+02]
 [2.41256049e+02 1.79941674e+02]
 [2.13272386e+02 1.63228223e+02]
 [2.61846518e+02 2.05991443e+02]
 [2.59325151e+02 1.70239099e+02]]
Train Epoch7 Acc 0.3335257043055661 (131766/395070), AUC 0.613121509552002
Test Epoch7 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch7 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch7 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch7 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Save ckpt to ./ckpt/mask4//kdd99/kdd99_linearal_l10_m4.pt  ,ep 7
Test Epoch7 layer4 Acc 0.5685923136111448, AUC 0.568480908870697
Test Epoch7 layer5 Acc 7.087028712590613e-05, AUC 0.2609853744506836
Test Epoch7 layer6 Acc 0.568561940630948, AUC 0.6917989253997803
Test Epoch7 layer7 Acc 0.0003239784554327137, AUC 0.6504977941513062
Test Epoch7 layer8 Acc 0.5731887579475965, AUC 0.42390328645706177
Test Epoch7 layer9 Acc 0.7853743976025594, AUC 0.6023504137992859
gc 0
[[4.76674396e+03 2.90883762e+00]
 [2.42034193e-02 1.23378556e+00]
 [1.38259428e-02 7.74734228e-01]
 [6.18545208e-03 3.79866005e-01]
 [2.03336857e+02 1.71714136e+02]
 [2.13680600e+02 1.81812098e+02]
 [2.37989573e+02 1.74403588e+02]
 [2.10658927e+02 1.61645545e+02]
 [2.58227999e+02 2.01946250e+02]
 [2.53824240e+02 1.65914010e+02]]
Train Epoch8 Acc 0.7752600804920647 (306282/395070), AUC 0.6341220140457153
Test Epoch8 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch8 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch8 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch8 layer3 Acc 0.997954886000081, AUC 0.9944603443145752
Test Epoch8 layer4 Acc 0.5685113189972867, AUC 0.5147316455841064
Test Epoch8 layer5 Acc 7.087028712590613e-05, AUC 0.24612285196781158
Test Epoch8 layer6 Acc 0.5685720649576803, AUC 0.5938730239868164
Test Epoch8 layer7 Acc 0.0004758433564167983, AUC 0.6220691204071045
Test Epoch8 layer8 Acc 0.5730672660268092, AUC 0.39080867171287537
Test Epoch8 layer9 Acc 0.7853845219292918, AUC 0.656080961227417
gc 0
[[4.76674395e+03 2.90886771e+00]
 [2.42024197e-02 1.23378062e+00]
 [1.38261556e-02 7.74739564e-01]
 [4.95429304e-03 3.68144613e-01]
 [2.04152744e+02 1.75148186e+02]
 [2.16330797e+02 1.83677624e+02]
 [2.37402330e+02 1.76165226e+02]
 [2.10982832e+02 1.64005489e+02]
 [2.56292110e+02 2.03232114e+02]
 [2.50743301e+02 1.66629411e+02]]
Train Epoch9 Acc 0.778537980611031 (307577/395070), AUC 0.6329841017723083
Test Epoch9 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch9 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch9 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch9 layer3 Acc 0.9980156319604746, AUC 0.9943662881851196
Test Epoch9 layer4 Acc 0.5685113189972867, AUC 0.5694023370742798
Test Epoch9 layer5 Acc 8.099461385817843e-05, AUC 0.2980402708053589
Test Epoch9 layer6 Acc 0.568561940630948, AUC 0.6557084918022156
Test Epoch9 layer7 Acc 0.059338678977847975, AUC 0.5396444201469421
Test Epoch9 layer8 Acc 0.5690681569675616, AUC 0.337392121553421
Test Epoch9 layer9 Acc 0.7854553922164176, AUC 0.6001926064491272
Best AUC 0.9949607253074646
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//kdd99/kdd99_linearal_l10_m4.pt
[[56147     0    11     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19416    15     0     4     0     4     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    30     0     0   219     1     0     0     0     0]
 [    0    24    14     0     0     0   170     0     0     0     0]
 [    0     0   130     0     0     0     0    74     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    6     3    26     0     0    18     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19423     7     0     2     0     6     0     0     0]
 [    0     0    12   429     0     0     0     0     0     0     0]
 [    5     0    23     0   290     0     0     0     0     0     0]
 [    0     0    19     0     0   231     0     0     0     0     0]
 [    0     7     6     0     0     0   195     0     0     0     0]
 [    0     0    89     0     0     0     0   115     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [   21    20    11     0     0     0     0     1     0     0     0]
 [   15     1    28     0     0     3     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19420     6     0     2     0     9     0     0     0]
 [    0     0     7   434     0     0     0     0     0     0     0]
 [    5     0    19     0   294     0     0     0     0     0     0]
 [    0     0    12     0     0   238     0     0     0     0     0]
 [    0     5     4     0     0     0   199     0     0     0     0]
 [    0     0    19     0     0     0     0   185     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   49     0     4     0     0     0     0     0     0     0     0]
 [   15     3    28     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19420     5     0     2     0    10     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    2     0    16     0   300     0     0     0     0     0     0]
 [    0     0     9     0     0   241     0     0     0     0     0]
 [    0     2     4     0     0     0   202     0     0     0     0]
 [    0     0    17     0     0     0     0   187     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [    7    16    29     0     0     0     0     1     0     0     0]
 [    0     3    43     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56154     4     0     0     0     0     0     0     0     0     0]
 [21440     0     1     0     0     0     0     0     0     0     0]
 [   95 19354     7     0     0     0     0     0     0     0     0]
 [  436     4     1     0     0     0     0     0     0     0     0]
 [  315     3     0     0     0     0     0     0     0     0     0]
 [  247     3     0     0     0     0     0     0     0     0     0]
 [  206     2     0     0     0     0     0     0     0     0     0]
 [  193    11     0     0     0     0     0     0     0     0     0]
 [  194     2     0     0     0     0     0     0     0     0     0]
 [    0    40    13     0     0     0     0     0     0     0     0]
 [   40     7     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0 56158     0     0     0     0     0     0     0     0     0]
 [21436     5     0     0     0     0     0     0     0     0     0]
 [    0 19455     1     0     0     0     0     0     0     0     0]
 [    0   441     0     0     0     0     0     0     0     0     0]
 [  307    11     0     0     0     0     0     0     0     0     0]
 [    0   250     0     0     0     0     0     0     0     0     0]
 [    2     3     0    20     0     0     1   182     0     0     0]
 [    0   204     0     0     0     0     0     0     0     0     0]
 [  152    44     0     0     0     0     0     0     0     0     0]
 [    0    53     0     0     0     0     0     0     0     0     0]
 [   18    29     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [19455     0     0     0     0     0     1     0     0     0     0]
 [  441     0     0     0     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  208     0     0     0     0     0     0     0     0     0     0]
 [  194     0     0     0     0     0     0     0    10     0     0]
 [    3     0    82     0   111     0     0     0     0     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[   25 56133     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [19407    42     7     0     0     0     0     0     0     0     0]
 [  441     0     0     0     0     0     0     0     0     0     0]
 [  316     2     0     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [   28   180     0     0     0     0     0     0     0     0     0]
 [   11   193     0     0     0     0     0     0     0     0     0]
 [    3   193     0     0     0     0     0     0     0     0     0]
 [   51     2     0     0     0     0     0     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56156     0     2     0     0     0     0     0     0     0     0]
 [   27     0     0 21414     0     0     0     0     0     0     0]
 [19211     9    22   214     0     0     0     0     0     0     0]
 [    3     0     1   437     0     0     0     0     0     0     0]
 [   13     2     5   298     0     0     0     0     0     0     0]
 [   23     0     0   227     0     0     0     0     0     0     0]
 [   68   140     0     0     0     0     0     0     0     0     0]
 [   12     0   192     0     0     0     0     0     0     0     0]
 [    2     0     0     1   193     0     0     0     0     0     0]
 [   21     0     4    28     0     0     0     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56131    24     0     3     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   16   112     0 19328     0     0     0     0     0     0     0]
 [    0   440     0     1     0     0     0     0     0     0     0]
 [  306     3     0     9     0     0     0     0     0     0     0]
 [  242     4     0     4     0     0     0     0     0     0     0]
 [   56   150     0     2     0     0     0     0     0     0     0]
 [  176    17     0    11     0     0     0     0     0     0     0]
 [    3   193     0     0     0     0     0     0     0     0     0]
 [   51     0     0     2     0     0     0     0     0     0     0]
 [    1    40     0     6     0     0     0     0     0     0     0]]
Figure(640x480)
