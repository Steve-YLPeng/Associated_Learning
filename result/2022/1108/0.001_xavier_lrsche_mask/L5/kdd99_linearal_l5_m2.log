Load ckpt from ./ckpt/mask1//kdd99/kdd99_linearal_l5_m1.pt
layer_mask {1}
Start Training
gc 9
[[4.76678204e+03 3.06288868e+00]
 [2.80939230e+00 6.06667490e+00]
 [8.20020885e+02 6.80127382e+02]
 [6.13880935e+02 5.62028518e+02]
 [6.11293300e+02 4.51165435e+02]]
Train Epoch0 Acc 0.7621484800161996 (301102/395070), AUC 0.4510447680950165
Test Epoch0 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch0 layer1 Acc 0.9964058640100434, AUC 0.9829338192939758
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearal_l5_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.018335155712145144, AUC 0.6431834697723389
Test Epoch0 layer3 Acc 0.019003361276475114, AUC 0.18332605063915253
Test Epoch0 layer4 Acc 0.7593143805936905, AUC 0.4370039701461792
gc 0
[[4.76678209e+03 3.06316446e+00]
 [1.86852064e-02 1.72965127e+00]
 [8.04486424e+02 6.54823198e+02]
 [6.06033087e+02 5.62256796e+02]
 [6.09422714e+02 4.75374567e+02]]
Train Epoch1 Acc 0.7592376034626775 (299952/395070), AUC 0.3975963890552521
Test Epoch1 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch1 layer1 Acc 0.9969424533268537, AUC 0.9826552867889404
Test Epoch1 layer2 Acc 0.2176831490705868, AUC 0.6952512860298157
Test Epoch1 layer3 Acc 0.018213663791357873, AUC 0.10422098636627197
Test Epoch1 layer4 Acc 0.7617138460292391, AUC 0.39675629138946533
gc 0
[[4.76678205e+03 3.06363341e+00]
 [1.97308593e-02 1.38593030e+00]
 [7.41050378e+02 6.01832068e+02]
 [5.67728545e+02 5.44244126e+02]
 [5.68653604e+02 4.69290723e+02]]
Train Epoch2 Acc 0.7638418508112487 (301771/395070), AUC 0.3567688763141632
Test Epoch2 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch2 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearal_l5_m2.pt  ,ep 2
Test Epoch2 layer2 Acc 0.21807799781314544, AUC 0.6363596320152283
Test Epoch2 layer3 Acc 0.018649009840845585, AUC 0.11769308894872665
Test Epoch2 layer4 Acc 0.7644676629004171, AUC 0.31763777136802673
gc 0
[[4.76678205e+03 3.06298533e+00]
 [1.78711313e-02 1.20880304e+00]
 [6.79617743e+02 5.67773523e+02]
 [5.26643239e+02 5.33930685e+02]
 [5.25426539e+02 4.55124524e+02]]
Train Epoch3 Acc 0.7646720834282532 (302099/395070), AUC 0.3317928910255432
Test Epoch3 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch3 layer1 Acc 0.9973777993763415, AUC 0.9857690334320068
Test Epoch3 layer2 Acc 0.2183412303081845, AUC 0.4646644592285156
Test Epoch3 layer3 Acc 0.016664641801320212, AUC 0.11456535011529922
Test Epoch3 layer4 Acc 0.7647916413558499, AUC 0.3351139724254608
gc 0
[[4.76678204e+03 3.06297804e+00]
 [1.43690830e-02 1.08296374e+00]
 [6.46407314e+02 5.58966534e+02]
 [5.04873084e+02 5.28947707e+02]
 [4.96446344e+02 4.44947621e+02]]
Train Epoch4 Acc 0.7649277343255626 (302200/395070), AUC 0.39773738384246826
Test Epoch4 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch4 layer1 Acc 0.9974385453367351, AUC 0.9910069108009338
Test Epoch4 layer2 Acc 0.21844247357550722, AUC 0.49202996492385864
Test Epoch4 layer3 Acc 0.01837565301907423, AUC 0.1363035887479782
Test Epoch4 layer4 Acc 0.7649738792370308, AUC 0.4424399435520172
gc 0
[[4.76678215e+03 3.06294257e+00]
 [1.35567997e-02 1.01944373e+00]
 [6.28461132e+02 5.58949691e+02]
 [4.95746124e+02 5.27836865e+02]
 [4.77587112e+02 4.35074194e+02]]
Train Epoch5 Acc 0.7650745437517402 (302258/395070), AUC 0.4681183695793152
Test Epoch5 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch5 layer1 Acc 0.9974182966832705, AUC 0.9893238544464111
Test Epoch5 layer2 Acc 0.21843234924877494, AUC 0.5253958106040955
Test Epoch5 layer3 Acc 0.03928238772121654, AUC 0.19122132658958435
Test Epoch5 layer4 Acc 0.7650548738508889, AUC 0.4952826499938965
gc 0
[[4.76678208e+03 3.06316790e+00]
 [1.42500955e-02 9.46887624e-01]
 [6.24741971e+02 5.61340888e+02]
 [4.94758378e+02 5.35759333e+02]
 [4.65055475e+02 4.31349620e+02]]
Train Epoch6 Acc 0.7650720125547371 (302257/395070), AUC 0.5003514885902405
Test Epoch6 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch6 layer1 Acc 0.9976106588911837, AUC 0.9862964749336243
Test Epoch6 layer2 Acc 0.2185234681893654, AUC 0.5374440550804138
Test Epoch6 layer3 Acc 0.04633904345361033, AUC 0.2106422334909439
Test Epoch6 layer4 Acc 0.7650245008706921, AUC 0.5036202073097229
gc 0
[[4.76678211e+03 3.06301066e+00]
 [1.82928727e-03 8.18849573e-01]
 [6.24026260e+02 5.68776379e+02]
 [4.93457041e+02 5.43150594e+02]
 [4.58575574e+02 4.33295154e+02]]
Train Epoch7 Acc 0.7650745437517402 (302258/395070), AUC 0.5061008334159851
Test Epoch7 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch7 layer1 Acc 0.9974486696634673, AUC 0.9905673861503601
Test Epoch7 layer2 Acc 0.7481978698416555, AUC 0.5363312363624573
Test Epoch7 layer3 Acc 0.041195885473616, AUC 0.20654143393039703
Test Epoch7 layer4 Acc 0.7650548738508889, AUC 0.5068684220314026
gc 0
[[4.76678204e+03 3.06295920e+00]
 [3.32065301e-03 7.98826132e-01]
 [6.23644003e+02 5.77573830e+02]
 [4.92713372e+02 5.52331340e+02]
 [4.56281072e+02 4.34871556e+02]]
Train Epoch8 Acc 0.7650770749487432 (302259/395070), AUC 0.5058353543281555
Test Epoch8 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch8 layer1 Acc 0.9977220264852388, AUC 0.990260899066925
Test Epoch8 layer2 Acc 0.761379743247074, AUC 0.5443085432052612
Test Epoch8 layer3 Acc 0.030119872028510103, AUC 0.2021765261888504
Test Epoch8 layer4 Acc 0.7649738792370308, AUC 0.5144344568252563
gc 0
[[4.76678233e+03 3.06393454e+00]
 [3.21721517e-03 7.72628470e-01]
 [6.24364303e+02 5.86403920e+02]
 [4.92175415e+02 5.59500567e+02]
 [4.53516097e+02 4.37384255e+02]]
Train Epoch9 Acc 0.7650694813577341 (302256/395070), AUC 0.5205367803573608
Test Epoch9 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch9 layer1 Acc 0.9976511561981128, AUC 0.9914278388023376
Test Epoch9 layer2 Acc 0.780858947879966, AUC 0.5529721975326538
Test Epoch9 layer3 Acc 0.03295468351354635, AUC 0.1972307711839676
Test Epoch9 layer4 Acc 0.7650143765439599, AUC 0.5182877779006958
Best AUC 0.9939635992050171
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//kdd99/kdd99_linearal_l5_m2.pt
[[56149     0     9     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19419    15     0     3     0     2     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    38     0   275     0     0     0     0     0     0]
 [    0     0    48     0     0   201     1     0     0     0     0]
 [    0    24    18     0     0     0   166     0     0     0     0]
 [    0     0   133     2     0     0     0    69     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    1    23    29     0     0     0     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56152     0     6     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   18     1 19415     8     0     1     0    13     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    6     0    27     0   285     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0    11     8     0     0     0   189     0     0     0     0]
 [    0     0    33     0     0     0     0   171     0     0     0]
 [    1     0     2     0     0     0     0     0   193     0     0]
 [   26     9    17     0     0     0     0     1     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0    43    57     0     0     0 56058     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [    0 18236     3     0     0    17     3  1197     0     0     0]
 [    0   337     0     0     0    93     0    11     0     0     0]
 [    0    27     8     0     4     0     0   279     0     0     0]
 [    0    24     0     0     0     0     0   226     0     0     0]
 [  175     3    19     0     3     0     3     5     0     0     0]
 [    3   112     0     0     0     0     0    89     0     0     0]
 [   19     3     0     0     0   174     0     0     0     0     0]
 [    0    53     0     0     0     0     0     0     0     0     0]
 [    0    31    16     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    1     0 56157     0     0     0     0     0     0     0     0]
 [21440     1     0     0     0     0     0     0     0     0     0]
 [17599    17  1840     0     0     0     0     0     0     0     0]
 [   20   330    91     0     0     0     0     0     0     0     0]
 [   10    34   274     0     0     0     0     0     0     0     0]
 [  127     0   123     0     0     0     0     0     0     0     0]
 [   31     0   177     0     0     0     0     0     0     0     0]
 [  204     0     0     0     0     0     0     0     0     0     0]
 [  193     0     3     0     0     0     0     0     0     0     0]
 [   37     0    16     0     0     0     0     0     0     0     0]
 [   27     0    20     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56144     0    14     0     0     0     0     0     0     0     0]
 [21437     0     4     0     0     0     0     0     0     0     0]
 [   86     1 19364     0     3     0     0     2     0     0     0]
 [    0     0   100     0   341     0     0     0     0     0     0]
 [  305     0    13     0     0     0     0     0     0     0     0]
 [  165     0    41     0     0     0     0    44     0     0     0]
 [   41     0   167     0     0     0     0     0     0     0     0]
 [    0     0   201     0     3     0     0     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   51     0     2     0     0     0     0     0     0     0     0]
 [   28     0    19     0     0     0     0     0     0     0     0]]
Figure(640x480)
