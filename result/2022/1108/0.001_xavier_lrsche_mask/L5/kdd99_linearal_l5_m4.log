Load ckpt from ./ckpt/mask3//kdd99/kdd99_linearal_l5_m3.pt
layer_mask {3}
Start Training
gc 9
[[4.76678921e+03 3.06327916e+00]
 [4.52001052e-02 1.31429513e+00]
 [1.80405904e-02 7.03310591e-01]
 [9.33348738e-01 1.77900552e+00]
 [3.70769138e+02 2.83286350e+02]]
Train Epoch0 Acc 0.5684916597058749 (224594/395070), AUC 0.2328508347272873
Test Epoch0 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch0 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch0 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch0 layer3 Acc 0.9974992912971288, AUC 0.992022693157196
Save ckpt to ./ckpt/mask4//kdd99/kdd99_linearal_l5_m4.pt  ,ep 0
Test Epoch0 layer4 Acc 0.5685011946705544, AUC 0.2128133624792099
gc 0
[[4.76678211e+03 3.06494088e+00]
 [4.52000618e-02 1.31597266e+00]
 [1.80397426e-02 7.04759356e-01]
 [1.05570013e-02 6.27672538e-01]
 [3.60288272e+02 2.68550277e+02]]
Train Epoch1 Acc 0.5685043156908902 (224599/395070), AUC 0.2047678530216217
Test Epoch1 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch1 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch1 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch1 layer3 Acc 0.9975195399505933, AUC 0.9853060245513916
Test Epoch1 layer4 Acc 0.5684202000566962, AUC 0.2157917618751526
gc 0
[[4.76678203e+03 3.06622676e+00]
 [4.52008381e-02 1.31431199e+00]
 [1.80396299e-02 7.03288286e-01]
 [1.41077453e-02 5.32632127e-01]
 [3.16218124e+02 2.38046545e+02]]
Train Epoch2 Acc 0.5684410357658136 (224574/395070), AUC 0.24443024396896362
Test Epoch2 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch2 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch2 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch2 layer3 Acc 0.9973676750496092, AUC 0.9904807806015015
Test Epoch2 layer4 Acc 0.5682885838091767, AUC 0.24452157318592072
gc 0
[[4.76678208e+03 3.06299908e+00]
 [4.51997314e-02 1.31425206e+00]
 [1.80405986e-02 7.03283124e-01]
 [9.64873412e-03 4.52508319e-01]
 [2.74304862e+02 2.15572293e+02]]
Train Epoch3 Acc 0.5620219201660466 (222038/395070), AUC 0.2794536054134369
Test Epoch3 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch3 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch3 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch3 layer3 Acc 0.9975701615842546, AUC 0.9912359714508057
Test Epoch3 layer4 Acc 0.5683797027497671, AUC 0.2201402187347412
gc 0
[[4.76678208e+03 3.06295589e+00]
 [4.52003021e-02 1.31425804e+00]
 [1.80397276e-02 7.03280833e-01]
 [9.96344030e-03 4.16521468e-01]
 [2.59001759e+02 2.09376701e+02]]
Train Epoch4 Acc 0.5645252740020755 (223027/395070), AUC 0.26906752586364746
Test Epoch4 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch4 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch4 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch4 layer3 Acc 0.9976410318713805, AUC 0.9913628101348877
Test Epoch4 layer4 Acc 0.5684303243834286, AUC 0.3624557554721832
gc 0
[[4.76678205e+03 3.06298698e+00]
 [4.51996374e-02 1.31428871e+00]
 [1.80397680e-02 7.03284276e-01]
 [1.14081987e-03 3.85470417e-01]
 [2.58656341e+02 2.10257226e+02]]
Train Epoch5 Acc 0.5685068468878933 (224600/395070), AUC 0.3714718520641327
Test Epoch5 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch5 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch5 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch5 layer3 Acc 0.9975600372575224, AUC 0.9910098910331726
Test Epoch5 layer4 Acc 0.5684100757299639, AUC 0.370645135641098
gc 0
[[4.76678214e+03 3.06304997e+00]
 [4.51994584e-02 1.31428629e+00]
 [1.80404849e-02 7.03288498e-01]
 [3.04007455e-03 3.80980171e-01]
 [2.60753757e+02 2.13105781e+02]]
Train Epoch6 Acc 0.5685853139949882 (224631/395070), AUC 0.3556336462497711
Test Epoch6 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch6 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch6 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch6 layer3 Acc 0.9976612805248452, AUC 0.9909659028053284
Test Epoch6 layer4 Acc 0.5685315676507512, AUC 0.3523098826408386
gc 0
[[4.76678204e+03 3.06295312e+00]
 [4.52000974e-02 1.31426003e+00]
 [1.80396794e-02 7.03283061e-01]
 [2.08837771e-03 3.74873779e-01]
 [2.58661484e+02 2.13490224e+02]]
Train Epoch7 Acc 0.5596755005442073 (221111/395070), AUC 0.32223203778266907
Test Epoch7 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch7 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch7 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch7 layer3 Acc 0.9975600372575224, AUC 0.9911866784095764
Test Epoch7 layer4 Acc 0.0010428056534240472, AUC 0.27909553050994873
gc 0
[[4.76678212e+03 3.06303245e+00]
 [4.52000677e-02 1.31426279e+00]
 [1.80406328e-02 7.03286588e-01]
 [2.45007874e-03 3.70185689e-01]
 [2.59376438e+02 2.15652938e+02]]
Train Epoch8 Acc 0.5352722302376794 (211470/395070), AUC 0.30898505449295044
Test Epoch8 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch8 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch8 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch8 layer3 Acc 0.9975802859109869, AUC 0.9911705255508423
Test Epoch8 layer4 Acc 0.5685416919774835, AUC 0.3463638126850128
gc 0
[[4.76678203e+03 3.06293584e+00]
 [4.52001464e-02 1.31425004e+00]
 [1.80396446e-02 7.03276394e-01]
 [1.86211120e-04 3.53933782e-01]
 [2.59164119e+02 2.17724801e+02]]
Train Epoch9 Acc 0.5685929075859975 (224634/395070), AUC 0.3386133909225464
Test Epoch9 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch9 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch9 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch9 layer3 Acc 0.9976309075446482, AUC 0.9907512664794922
Test Epoch9 layer4 Acc 0.5685416919774835, AUC 0.3513715863227844
Best AUC 0.992022693157196
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//kdd99/kdd99_linearal_l5_m4.pt
[[56149     0     9     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19419    15     0     3     0     2     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    38     0   275     0     0     0     0     0     0]
 [    0     0    48     0     0   201     1     0     0     0     0]
 [    0    24    18     0     0     0   166     0     0     0     0]
 [    0     0   133     2     0     0     0    69     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    1    23    29     0     0     0     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56152     0     6     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   18     1 19415     8     0     1     0    13     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    6     0    27     0   285     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0    11     8     0     0     0   189     0     0     0     0]
 [    0     0    33     0     0     0     0   171     0     0     0]
 [    1     0     2     0     0     0     0     0   193     0     0]
 [   26     9    17     0     0     0     0     1     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56152     0     6     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     1 19424     7     0     1     0     6     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    19     0   294     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0     6     6     0     0     0   196     0     0     0     0]
 [    0     0    36     0     0     0     0   168     0     0     0]
 [    2     0     0     0     1     0     0     0   193     0     0]
 [   17     0    36     0     0     0     0     0     0     0     0]
 [    0     0    47     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56152     0     6     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19419     7     0     1     0    11     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    19     0   294     0     0     0     0     0     0]
 [    0     0    30     0     0   220     0     0     0     0     0]
 [    0     5     6     0     0     0   197     0     0     0     0]
 [    0     0    19     0     0     0     0   185     0     0     0]
 [    1     1     0     0     1     0     0     0   193     0     0]
 [   10     7    36     0     0     0     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56147     6     0     0     0     5     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [18606     0     0     0     5     1   844     0     0     0     0]
 [  441     0     0     0     0     0     0     0     0     0     0]
 [   97     0     0     0     0     0     1   220     0     0     0]
 [   19     0     0     0   231     0     0     0     0     0     0]
 [  198     5     0     0     0     0     5     0     0     0     0]
 [  204     0     0     0     0     0     0     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [   46     0     0     0     1     0     0     0     0     0     0]]
Figure(640x480)
