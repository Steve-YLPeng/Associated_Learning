Load ckpt from ./ckpt/mask2//kdd99/kdd99_linearalside_l5_m2.pt
layer_mask {2}
Start Training
gc 9
[[4.76600538e+03 3.31815673e+02]
 [3.22882494e-05 2.34362280e+02]
 [3.23838918e+01 4.11364376e+01]
 [1.26406871e+03 7.55948423e+02]
 [8.61640876e+02 7.34830496e+02]]
Train Epoch0 Acc 0.12631432404384033 (49903/395070), AUC 0.7188461422920227
Test Epoch0 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch0 layer1 Acc 0.7267140485157737, AUC 0.7890546321868896
Test Epoch0 layer2 Acc 0.9774733730206941, AUC 0.9345525503158569
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearalside_l5_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.00045559470295225367, AUC 0.31381598114967346
Test Epoch0 layer4 Acc 0.12694893289596243, AUC 0.7324069738388062
gc 0
[[4.76600539e+03 3.31820288e+02]
 [3.22882726e-05 2.34358453e+02]
 [1.30585711e-01 1.61838694e+01]
 [1.27961234e+03 7.66846569e+02]
 [8.72032881e+02 7.29266184e+02]]
Train Epoch1 Acc 0.11105120611537196 (43873/395070), AUC 0.7317401766777039
Test Epoch1 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch1 layer1 Acc 0.7267140485157737, AUC 0.7890546321868896
Test Epoch1 layer2 Acc 0.9782428218523468, AUC 0.883658230304718
Test Epoch1 layer3 Acc 0.0002936054752358968, AUC 0.3182826638221741
Test Epoch1 layer4 Acc 0.10049406714453489, AUC 0.7167662978172302
gc 0
[[4.76600539e+03 3.31830796e+02]
 [3.22882937e-05 2.34368777e+02]
 [2.39058243e-02 1.49799544e+01]
 [1.27828978e+03 7.76106143e+02]
 [8.69895337e+02 7.24397222e+02]]
Train Epoch2 Acc 0.08670615333991445 (34255/395070), AUC 0.7306085824966431
Test Epoch2 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch2 layer1 Acc 0.7267140485157737, AUC 0.7890546321868896
Test Epoch2 layer2 Acc 0.9782934434860082, AUC 0.8952785134315491
Test Epoch2 layer3 Acc 0.0025108330296035315, AUC 0.29826924204826355
Test Epoch2 layer4 Acc 0.0651804155023691, AUC 0.7182624936103821
gc 0
[[4.76600539e+03 3.31816716e+02]
 [3.22882307e-05 2.34356011e+02]
 [3.85767857e-03 1.39043722e+01]
 [1.27002347e+03 7.86008127e+02]
 [8.67135038e+02 7.26485673e+02]]
Train Epoch3 Acc 0.060920849469714225 (24068/395070), AUC 0.704854428768158
Test Epoch3 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch3 layer1 Acc 0.7267140485157737, AUC 0.7890546321868896
Test Epoch3 layer2 Acc 0.9886405054063905, AUC 0.8930866718292236
Test Epoch3 layer3 Acc 0.015480095573644354, AUC 0.3012782037258148
Test Epoch3 layer4 Acc 0.059075446482808894, AUC 0.6899729371070862
gc 0
[[4.76600539e+03 3.31807922e+02]
 [3.22882426e-05 2.34355720e+02]
 [5.54701889e-04 1.31144592e+01]
 [1.26306990e+03 7.98855516e+02]
 [8.65107107e+02 7.29164341e+02]]
Train Epoch4 Acc 0.05609132558787051 (22160/395070), AUC 0.6911531090736389
Test Epoch4 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch4 layer1 Acc 0.7267140485157737, AUC 0.7890546321868896
Test Epoch4 layer2 Acc 0.9886506297331228, AUC 0.8968029022216797
Test Epoch4 layer3 Acc 0.002034989673186733, AUC 0.29734858870506287
Test Epoch4 layer4 Acc 0.05425626695824728, AUC 0.6812624335289001
gc 0
[[4.76600539e+03 3.31820616e+02]
 [3.22882280e-05 2.34354641e+02]
 [4.93570594e-05 1.25400474e+01]
 [1.26164424e+03 8.10929039e+02]
 [8.64443189e+02 7.31243023e+02]]
Train Epoch5 Acc 0.051856633001746526 (20487/395070), AUC 0.6869831681251526
Test Epoch5 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch5 layer1 Acc 0.7267140485157737, AUC 0.7890546321868896
Test Epoch5 layer2 Acc 0.9887316243469809, AUC 0.8983265161514282
Test Epoch5 layer3 Acc 0.0005770866237395213, AUC 0.2953347861766815
Test Epoch5 layer4 Acc 0.05202891507714737, AUC 0.6811875104904175
gc 0
[[4.76600538e+03 3.31812939e+02]
 [3.22882022e-05 2.34357232e+02]
 [9.33246921e-05 1.21823859e+01]
 [1.26128505e+03 8.19471981e+02]
 [8.64222473e+02 7.34088556e+02]]
Train Epoch6 Acc 0.04707267066595793 (18597/395070), AUC 0.6876106858253479
Test Epoch6 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch6 layer1 Acc 0.7267140485157737, AUC 0.7890546321868896
Test Epoch6 layer2 Acc 0.9887215000202486, AUC 0.896501898765564
Test Epoch6 layer3 Acc 0.00020248653464544606, AUC 0.2961871922016144
Test Epoch6 layer4 Acc 0.044850767423966306, AUC 0.6822141408920288
gc 0
[[4.76600539e+03 3.31821837e+02]
 [3.22882406e-05 2.34359140e+02]
 [8.67369365e-05 1.17871804e+01]
 [1.26092442e+03 8.28928884e+02]
 [8.63987500e+02 7.38023548e+02]]
Train Epoch7 Acc 0.039157617637380716 (15470/395070), AUC 0.689254641532898
Test Epoch7 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch7 layer1 Acc 0.7267140485157737, AUC 0.7890546321868896
Test Epoch7 layer2 Acc 0.9887417486737132, AUC 0.8934116363525391
Test Epoch7 layer3 Acc 0.00020248653464544606, AUC 0.3011817932128906
Test Epoch7 layer4 Acc 0.03566800307779533, AUC 0.6816954612731934
gc 0
[[4.76600539e+03 3.31825245e+02]
 [3.22882968e-05 2.34364287e+02]
 [8.07650612e-05 1.13573691e+01]
 [1.26056686e+03 8.36976918e+02]
 [8.63745799e+02 7.42591378e+02]]
Train Epoch8 Acc 0.03370795048978662 (13317/395070), AUC 0.6887059807777405
Test Epoch8 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch8 layer1 Acc 0.7267140485157737, AUC 0.7890546321868896
Test Epoch8 layer2 Acc 0.9887417486737132, AUC 0.8907179236412048
Test Epoch8 layer3 Acc 0.0002227351881099907, AUC 0.3117465078830719
Test Epoch8 layer4 Acc 0.033096424087798164, AUC 0.6805778741836548
gc 0
[[4.76600539e+03 3.31827757e+02]
 [3.22883067e-05 2.34366430e+02]
 [1.07491597e-05 1.10164993e+01]
 [1.26037911e+03 8.41975350e+02]
 [8.63621447e+02 7.45733804e+02]]
Train Epoch9 Acc 0.03217151390892753 (12710/395070), AUC 0.6882719397544861
Test Epoch9 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch9 layer1 Acc 0.7267140485157737, AUC 0.7890546321868896
Test Epoch9 layer2 Acc 0.9886911270400518, AUC 0.886600911617279
Test Epoch9 layer3 Acc 0.00023285951484226298, AUC 0.31393784284591675
Test Epoch9 layer4 Acc 0.03217511035516138, AUC 0.6798763871192932
Best AUC 0.9345525503158569
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//kdd99/kdd99_linearalside_l5_m3.pt
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 9398     0  9988    65     0     0     0     5     0     0     0]
 [    1     0    12   428     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  194     0    13     0     0     0     1     0     0     0     0]
 [  125     0     5     2     0     0     0    72     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 4498     0 14917    33     0     0     0     8     0     0     0]
 [    0     0     4   437     0     0     0     0     0     0     0]
 [  317     0     1     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  194     0    14     0     0     0     0     0     0     0     0]
 [    0     0   130     0     0     0     0    74     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56115     0    43     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   21  1048 18359    28     0     0     0     0     0     0     0]
 [    0     0     2   439     0     0     0     0     0     0     0]
 [    0   279    39     0     0     0     0     0     0     0     0]
 [    0    24   226     0     0     0     0     0     0     0     0]
 [    0   205     3     0     0     0     0     0     0     0     0]
 [    0     0   192    12     0     0     0     0     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    0     0    53     0     0     0     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[   33 52322     0     0     0  3803     0     0     0     0     0]
 [17145     0  4077   218     1     0     0     0     0     0     0]
 [ 4888   117    10   724  7152  6512     4    49     0     0     0]
 [    0     0     1     0   438     2     0     0     0     0     0]
 [   35     9     0     0     2     0     0   272     0     0     0]
 [  118     0     0     0   131     0     0     1     0     0     0]
 [   77    24     2     2     2     0     0   101     0     0     0]
 [    6     1     9     5     3   180     0     0     0     0     0]
 [   41     0     0     0     0     0   155     0     0     0     0]
 [    3    17     0     0     7     2    15     9     0     0     0]
 [   42     0     0     0     5     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0 56138     0     6     0     0    14     0     0     0]
 [ 4077     0     0     0    41     0 17321     2     0     0     0]
 [ 1158    78 12006     3  5235    57   228   688     3     0     0]
 [    0     0     0     2   335     0     3   100     1     0     0]
 [   13     0    12     0   293     0     0     0     0     0     0]
 [    0     0    23    18     7   202     0     0     0     0     0]
 [   91     0     1     0   114     0     2     0     0     0     0]
 [    1    62    95     1     0    10     0    34     1     0     0]
 [    0   142     0     0    54     0     0     0     0     0     0]
 [    0    13     2     0     8    23     0     7     0     0     0]
 [    0     0    29     0    18     0     0     0     0     0     0]]
Figure(640x480)
