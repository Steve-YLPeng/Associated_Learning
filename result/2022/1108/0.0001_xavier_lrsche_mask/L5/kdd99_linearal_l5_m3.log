Load ckpt from ./ckpt/mask2//kdd99/kdd99_linearal_l5_m2.pt
layer_mask {2}
Start Training
gc 9
[[4.76842270e+03 3.15070500e+00]
 [5.30560778e-04 1.85351276e+00]
 [2.23546046e+01 2.19015530e+01]
 [9.72263485e+02 7.59029614e+02]
 [7.88583628e+02 6.27286571e+02]]
Train Epoch0 Acc 0.17999088769078897 (71109/395070), AUC 0.4620521664619446
Test Epoch0 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch0 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch0 layer2 Acc 0.9932774470497712, AUC 0.9940269589424133
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l5_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.0029158060988944234, AUC 0.664441704750061
Test Epoch0 layer4 Acc 0.1754343336168145, AUC 0.5587544441223145
gc 0
[[4.76841552e+03 3.15044546e+00]
 [5.30527644e-04 1.85350676e+00]
 [1.45838953e-01 2.31963591e+00]
 [9.86387667e+02 7.59774339e+02]
 [7.99183667e+02 6.22632846e+02]]
Train Epoch1 Acc 0.17696357607512592 (69913/395070), AUC 0.5563671588897705
Test Epoch1 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch1 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch1 layer2 Acc 0.9956465395051229, AUC 0.9948902130126953
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l5_m3.pt  ,ep 1
Test Epoch1 layer3 Acc 0.003563763009759851, AUC 0.6727433800697327
Test Epoch1 layer4 Acc 0.1770339772405135, AUC 0.5410686135292053
gc 0
[[4.76841569e+03 3.15029996e+00]
 [5.30532492e-04 1.85339706e+00]
 [1.45635050e-02 1.74654634e+00]
 [9.85698571e+02 7.49152056e+02]
 [8.02756049e+02 6.13699280e+02]]
Train Epoch2 Acc 0.17640671273445213 (69693/395070), AUC 0.5376244187355042
Test Epoch2 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch2 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch2 layer2 Acc 0.9959705179605556, AUC 0.9954877495765686
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l5_m3.pt  ,ep 2
Test Epoch2 layer3 Acc 0.003533390029563034, AUC 0.6764390468597412
Test Epoch2 layer4 Acc 0.17264001943870733, AUC 0.5183202028274536
gc 0
[[4.76841564e+03 3.15024652e+00]
 [5.30534547e-04 1.85338348e+00]
 [8.35324357e-04 1.52854253e+00]
 [9.82014385e+02 7.39736577e+02]
 [8.06220542e+02 6.07699525e+02]]
Train Epoch3 Acc 0.1596046270281216 (63055/395070), AUC 0.5077189803123474
Test Epoch3 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch3 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch3 layer2 Acc 0.9960008909407524, AUC 0.9949280023574829
Test Epoch3 layer3 Acc 0.0035131413760984896, AUC 0.6766963005065918
Test Epoch3 layer4 Acc 0.12627060300490017, AUC 0.4832392632961273
gc 0
[[4.76841568e+03 3.15050858e+00]
 [5.30536001e-04 1.85350126e+00]
 [2.72478784e-04 1.39523692e+00]
 [9.80282232e+02 7.34437338e+02]
 [8.05791909e+02 5.99843542e+02]]
Train Epoch4 Acc 0.12008251702229984 (47441/395070), AUC 0.48282644152641296
Test Epoch4 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch4 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch4 layer2 Acc 0.9962236261288624, AUC 0.9954826831817627
Test Epoch4 layer3 Acc 0.003503017049366217, AUC 0.6665148138999939
Test Epoch4 layer4 Acc 0.12838658729194508, AUC 0.47245141863822937
gc 0
[[4.76841603e+03 3.15097736e+00]
 [5.30533815e-04 1.85402363e+00]
 [2.57834640e-04 1.30219644e+00]
 [9.78669229e+02 7.32546899e+02]
 [8.04623625e+02 5.96497430e+02]]
Train Epoch5 Acc 0.13257903662642062 (52378/395070), AUC 0.4768255054950714
Test Epoch5 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch5 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch5 layer2 Acc 0.9963046207427206, AUC 0.9950408339500427
Test Epoch5 layer3 Acc 0.003533390029563034, AUC 0.6599106788635254
Test Epoch5 layer4 Acc 0.13625318916292067, AUC 0.4831918776035309
gc 0
[[4.76841551e+03 3.15035687e+00]
 [5.30530474e-04 1.85350934e+00]
 [2.58286733e-04 1.23341052e+00]
 [9.76995006e+02 7.32133219e+02]
 [8.03414548e+02 5.94968039e+02]]
Train Epoch6 Acc 0.15048219302908344 (59451/395070), AUC 0.48615437746047974
Test Epoch6 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch6 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch6 layer2 Acc 0.9964767342971692, AUC 0.9948375225067139
Test Epoch6 layer3 Acc 0.003503017049366217, AUC 0.6142289042472839
Test Epoch6 layer4 Acc 0.15142955493459684, AUC 0.4820394217967987
gc 0
[[4.76841582e+03 3.15046147e+00]
 [5.30536555e-04 1.85355459e+00]
 [3.36650306e-05 1.17293152e+00]
 [9.76134169e+02 7.35827953e+02]
 [8.02793411e+02 5.95669486e+02]]
Train Epoch7 Acc 0.15179588427367302 (59970/395070), AUC 0.4828183352947235
Test Epoch7 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch7 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch7 layer2 Acc 0.9964058640100434, AUC 0.9943721890449524
Test Epoch7 layer3 Acc 0.003503017049366217, AUC 0.603438138961792
Test Epoch7 layer4 Acc 0.15250273356821772, AUC 0.4798535108566284
gc 0
[[4.76841579e+03 3.15024775e+00]
 [5.30534195e-04 1.85338714e+00]
 [6.78368236e-05 1.14461406e+00]
 [9.75764824e+02 7.38451271e+02]
 [8.02527754e+02 5.96924947e+02]]
Train Epoch8 Acc 0.15348672387171894 (60638/395070), AUC 0.4830743968486786
Test Epoch8 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch8 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch8 layer2 Acc 0.9964058640100434, AUC 0.9938850402832031
Test Epoch8 layer3 Acc 0.003503017049366217, AUC 0.5790578722953796
Test Epoch8 layer4 Acc 0.14347183412303083, AUC 0.48373928666114807
gc 0
[[4.76842268e+03 3.15053272e+00]
 [5.30572435e-04 1.85355813e+00]
 [6.73768646e-05 1.11695138e+00]
 [9.75353921e+02 7.42582276e+02]
 [8.02234521e+02 5.98719233e+02]]
Train Epoch9 Acc 0.13504442250740376 (53352/395070), AUC 0.48223307728767395
Test Epoch9 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch9 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch9 layer2 Acc 0.9964261126635079, AUC 0.9939994215965271
Test Epoch9 layer3 Acc 0.003432146762240311, AUC 0.5788095593452454
Test Epoch9 layer4 Acc 0.12234236423277851, AUC 0.48069140315055847
Best AUC 0.9954877495765686
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//kdd99/kdd99_linearal_l5_m3.pt
[[56134     0    24     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     5 19417    12     0     9     0     7     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    0     0    43     0   275     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0    30    23     0    25     0   130     0     0     0     0]
 [    0     0   132    10     0     1     0    61     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    1     0    32     0     0    20     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56148     0    10     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     0 19430    10     0     5     0     5     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    33     0     0   217     0     0     0     0     0]
 [    0    24    19     0     0     0   165     0     0     0     0]
 [    0     0   132     4     0     1     0    67     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [   20     3    28     0     0     2     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56150     0     8     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     1 19428    10     0     5     0     6     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0    24    15     0     0     0   169     0     0     0     0]
 [    0     0   128     2     0     0     0    74     0     0     0]
 [    0     0     2     0     1     0     0     0   193     0     0]
 [   18     8    19     0     0     8     0     0     0     0     0]
 [    0    18    28     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[    0 56157     0     0     0     0     0     0     1     0     0]
 [    0     1 21430     0     0     0     0    10     0     0     0]
 [   10 19315    13     0    14    62     1    25     1     6     9]
 [    0    16     0     0     3     0     0     0     0     0   422]
 [    0    37   272     0     0     0     0     8     0     1     0]
 [    0    17   219     0     0     0     0     5     0     9     0]
 [    0     8    45     0    11     0   132    12     0     0     0]
 [    0   118     0     0    59     0     0     6    13     8     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    0     2     0     0     0     0     0     0    50     1     0]
 [    0     8    18     0     0     0     0     0     0    21     0]]
Figure(640x480)
[[    0     0 56153     1     0     0     0     4     0     0     0]
 [    3     0 21386     0    29    22     0     0     1     0     0]
 [  550    14 16776  2099     0     0     0     6     0     0    11]
 [    1     0   265   170     0     0     0     5     0     0     0]
 [    0     0    14   269    35     0     0     0     0     0     0]
 [    0     0   215    31     0     0     0     4     0     0     0]
 [   10     0     1   177    10     0     0     0    10     0     0]
 [    0     0   122    11     0     0     0    71     0     0     0]
 [    0     0     0     0     0     0     0   196     0     0     0]
 [    0     0     1     2     0     0     0    50     0     0     0]
 [    0     0    25     4     0     0     0    18     0     0     0]]
Figure(640x480)
