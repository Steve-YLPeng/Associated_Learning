Load ckpt from ./ckpt/mask1//kdd99/kdd99_linearalside_l5_m1.pt
layer_mask {0, 1}
Start Training
gc 9
[[4766.00921738  339.38959434]
 [  31.21763978  237.55222231]
 [1205.50076449  853.87317669]
 [ 986.32133238  845.13528448]
 [ 810.17705466  705.50136191]]
Train Epoch0 Acc 0.17699648163616574 (69926/395070), AUC 0.5538440346717834
Test Epoch0 layer0 Acc 0.6712226136961892, AUC 0.7974657416343689
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearalside_l5_m2.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7259041023771919, AUC 0.8158901333808899
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearalside_l5_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.1946199327744705, AUC 0.7117882370948792
Test Epoch0 layer3 Acc 0.004019357712712105, AUC 0.42931661009788513
Test Epoch0 layer4 Acc 0.17639614465638034, AUC 0.5462381839752197
gc 0
[[4.76600561e+03 3.62614745e+02]
 [1.46829931e-01 2.43677365e+02]
 [1.29556910e+03 8.92320739e+02]
 [1.06072740e+03 8.67570099e+02]
 [8.61208134e+02 7.19503557e+02]]
Train Epoch1 Acc 0.1756878527855823 (69409/395070), AUC 0.5452907681465149
Test Epoch1 layer0 Acc 0.6766087555177581, AUC 0.7957872748374939
Test Epoch1 layer1 Acc 0.7265824322682541, AUC 0.8714237213134766
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearalside_l5_m2.pt  ,ep 1
Test Epoch1 layer2 Acc 0.19404284615073097, AUC 0.7163984775543213
Test Epoch1 layer3 Acc 0.00285506013850079, AUC 0.4506998360157013
Test Epoch1 layer4 Acc 0.17540396063661767, AUC 0.5335755348205566
gc 0
[[4.76600536e+03 3.64683017e+02]
 [2.82968651e-02 2.46519712e+02]
 [1.33385974e+03 8.87860598e+02]
 [1.07496334e+03 8.63127030e+02]
 [8.67253015e+02 7.16788033e+02]]
Train Epoch2 Acc 0.17497658642772168 (69128/395070), AUC 0.5367507934570312
Test Epoch2 layer0 Acc 0.6802332644879115, AUC 0.7961360812187195
Test Epoch2 layer1 Acc 0.726501437654396, AUC 0.8596720099449158
Test Epoch2 layer2 Acc 0.19378973798242416, AUC 0.7189673781394958
Test Epoch2 layer3 Acc 0.0026222006236585266, AUC 0.44302213191986084
Test Epoch2 layer4 Acc 0.1745838901713036, AUC 0.5259311199188232
gc 0
[[4.76600531e+03 3.64058720e+02]
 [5.53022117e-03 2.48583199e+02]
 [1.34929257e+03 8.73762875e+02]
 [1.06951125e+03 8.51208986e+02]
 [8.66115093e+02 7.09689714e+02]]
Train Epoch3 Acc 0.1740172627635609 (68749/395070), AUC 0.5283803343772888
Test Epoch3 layer0 Acc 0.6832503138541287, AUC 0.7959230542182922
Test Epoch3 layer1 Acc 0.7266836755355769, AUC 0.7861567139625549
Test Epoch3 layer2 Acc 0.18198477301259466, AUC 0.719183087348938
Test Epoch3 layer3 Acc 0.002531081683068076, AUC 0.4270642399787903
Test Epoch3 layer4 Acc 0.17402705220102863, AUC 0.5185005068778992
gc 0
[[4.76600528e+03 3.62854680e+02]
 [1.10901838e-03 2.49397840e+02]
 [1.35207382e+03 8.57475141e+02]
 [1.06852604e+03 8.39081640e+02]
 [8.65558726e+02 7.01758110e+02]]
Train Epoch4 Acc 0.17424507049383653 (68839/395070), AUC 0.522084653377533
Test Epoch4 layer0 Acc 0.6912991536062851, AUC 0.7960743308067322
Test Epoch4 layer1 Acc 0.7267039241890414, AUC 0.7858768105506897
Test Epoch4 layer2 Acc 0.18096221601263515, AUC 0.7125642895698547
Test Epoch4 layer3 Acc 0.0025209573563358036, AUC 0.4008916914463043
Test Epoch4 layer4 Acc 0.1741181711416191, AUC 0.5179945230484009
gc 0
[[4.76600526e+03 3.61779654e+02]
 [4.94230729e-04 2.49564806e+02]
 [1.35403206e+03 8.44059416e+02]
 [1.06933736e+03 8.28753705e+02]
 [8.65926521e+02 6.95088324e+02]]
Train Epoch5 Acc 0.17348824258992077 (68540/395070), AUC 0.5221372246742249
Test Epoch5 layer0 Acc 0.6963410683189568, AUC 0.7972675561904907
Test Epoch5 layer1 Acc 0.7266836755355769, AUC 0.7885419726371765
Test Epoch5 layer2 Acc 0.15877981614222655, AUC 0.7056864500045776
Test Epoch5 layer3 Acc 0.0024095897622808085, AUC 0.39648735523223877
Test Epoch5 layer4 Acc 0.17359170615154093, AUC 0.5193512439727783
gc 0
[[4.76600524e+03 3.61069567e+02]
 [6.75296803e-05 2.49209437e+02]
 [1.35628670e+03 8.36976904e+02]
 [1.07072233e+03 8.22302193e+02]
 [8.66717636e+02 6.90959385e+02]]
Train Epoch6 Acc 0.16971675905535727 (67050/395070), AUC 0.5223591327667236
Test Epoch6 layer0 Acc 0.7081257846353217, AUC 0.7970072031021118
Test Epoch6 layer1 Acc 0.7267039241890414, AUC 0.7861707806587219
Test Epoch6 layer2 Acc 0.1497590410237719, AUC 0.6972034573554993
Test Epoch6 layer3 Acc 0.002369092455351719, AUC 0.39521118998527527
Test Epoch6 layer4 Acc 0.16817519134977524, AUC 0.5195848941802979
gc 0
[[4.76600524e+03 3.60471741e+02]
 [1.17152770e-04 2.48984823e+02]
 [1.35808939e+03 8.33959779e+02]
 [1.07185106e+03 8.19401867e+02]
 [8.67459128e+02 6.89455541e+02]]
Train Epoch7 Acc 0.16260915787075708 (64242/395070), AUC 0.5233436226844788
Test Epoch7 layer0 Acc 0.709806422872879, AUC 0.7974450588226318
Test Epoch7 layer1 Acc 0.7267747944761673, AUC 0.7869401574134827
Test Epoch7 layer2 Acc 0.14940468958814238, AUC 0.6909016966819763
Test Epoch7 layer3 Acc 0.0023387194751549024, AUC 0.39184656739234924
Test Epoch7 layer4 Acc 0.16194873040942778, AUC 0.5219703316688538
gc 0
[[4.76600523e+03 3.59934695e+02]
 [1.12306512e-04 2.48666881e+02]
 [1.35938825e+03 8.31744607e+02]
 [1.07272207e+03 8.17513634e+02]
 [8.68114504e+02 6.88558461e+02]]
Train Epoch8 Acc 0.15206419115599767 (60076/395070), AUC 0.5240418910980225
Test Epoch8 layer0 Acc 0.7126513586846475, AUC 0.796966016292572
Test Epoch8 layer1 Acc 0.7268659134167578, AUC 0.7861366868019104
Test Epoch8 layer2 Acc 0.14924270036042603, AUC 0.6942923069000244
Test Epoch8 layer3 Acc 0.002308346494958085, AUC 0.3837750256061554
Test Epoch8 layer4 Acc 0.1398574494796096, AUC 0.5217719674110413
gc 0
[[4.76600523e+03 3.59500392e+02]
 [1.14299750e-04 2.48183886e+02]
 [1.36038783e+03 8.29645807e+02]
 [1.07343126e+03 8.16315394e+02]
 [8.68603163e+02 6.88267187e+02]]
Train Epoch9 Acc 0.12642822790897815 (49948/395070), AUC 0.5237677693367004
Test Epoch9 layer0 Acc 0.7132385696351192, AUC 0.7977115511894226
Test Epoch9 layer1 Acc 0.726835540436561, AUC 0.788538932800293
Test Epoch9 layer2 Acc 0.1491414570931033, AUC 0.6950201392173767
Test Epoch9 layer3 Acc 0.002288097841493541, AUC 0.35692837834358215
Test Epoch9 layer4 Acc 0.11191430769853805, AUC 0.5220171809196472
Best AUC 0.8714237213134766
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//kdd99/kdd99_linearalside_l5_m2.pt
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 9410     0  9974    65     0     0     2     5     0     0     0]
 [    1     0    12   428     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  194     0    13     0     0     0     1     0     0     0     0]
 [  126     0     3     2     0     0     0    73     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    2     0     0     0     0     0     0     0    51     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 4511     0 14917    22     0     0     0     5     1     0     0]
 [    0     0     4   437     0     0     0     0     0     0     0]
 [  317     0     1     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  194     0    13     0     0     0     1     0     0     0     0]
 [    0     0   147     0     0     0     0    57     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    2     0     0     0     0     0     0     0    51     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0 55905    22   231     0     0     0     0     0     0     0]
 [    0     0   168 21273     0     0     0     0     0     0     0]
 [    2    81 19148   187     0    23     0     1    14     0     0]
 [    0     0     2    16     0     0     0     0   423     0     0]
 [    0     0    43   275     0     0     0     0     0     0     0]
 [    0     0   250     0     0     0     0     0     0     0     0]
 [    0     0   190    16     0     0     2     0     0     0     0]
 [    0     0   180    24     0     0     0     0     0     0     0]
 [    0     0     0     3     0   193     0     0     0     0     0]
 [    0     0     2    51     0     0     0     0     0     0     0]
 [    0     0    29    18     0     0     0     0     0     0     0]]
Figure(640x480)
[[    6     0     0     5 56146     0     1     0     0     0     0]
 [    0   189     0    46 12884  4077  4245     0     0     0     0]
 [ 6447   428     0  2895  7937  1036   181    48   484     0     0]
 [  435     3     0     0     0     0     0     0     3     0     0]
 [    9   284     0     1     1     0    23     0     0     0     0]
 [   14     0     0   211     1    24     0     0     0     0     0]
 [   90    54     0     1     0    63     0     0     0     0     0]
 [   15     1     0     4   121     0     1    62     0     0     0]
 [   54     0     0   142     0     0     0     0     0     0     0]
 [   19     0     0    34     0     0     0     0     0     0     0]
 [   17     0     0    28     2     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0     0    39     0    59     0 56060     0     0     0]
 [    2 17192     0  4106   141     0     0     0     0     0     0]
 [   92    70     4  2301 13943  3024     3    17     2     0     0]
 [    0     0    10   102   329     0     0     0     0     0     0]
 [    0     0     0     1     1   316     0     0     0     0     0]
 [  221     0     0     1     2    26     0     0     0     0     0]
 [    0     1     0     3     1   203     0     0     0     0     0]
 [   35    62     0     3   101     2     1     0     0     0     0]
 [    0     0     0    16     6    88     0    86     0     0     0]
 [   19     0     0    21     3    10     0     0     0     0     0]
 [   25     0     0     1     4    17     0     0     0     0     0]]
Figure(640x480)
