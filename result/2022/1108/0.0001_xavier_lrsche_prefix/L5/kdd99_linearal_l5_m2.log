Load ckpt from ./ckpt/mask1//kdd99/kdd99_linearal_l5_m1.pt
layer_mask {0, 1}
Start Training
gc 9
[[4.76909889e+03 3.65302848e+00]
 [1.75852930e+01 2.42796571e+01]
 [1.14849466e+03 7.45893801e+02]
 [8.48186049e+02 7.46494201e+02]
 [8.14857416e+02 5.90593445e+02]]
Train Epoch0 Acc 0.41527830511048675 (164064/395070), AUC 0.3466624915599823
Test Epoch0 layer0 Acc 0.9950087069209897, AUC 0.9884232878684998
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearal_l5_m2.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9944518689507148, AUC 0.9906134009361267
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearal_l5_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.5814603328878629, AUC 0.4690495431423187
Test Epoch0 layer3 Acc 0.12163366136151946, AUC 0.5268828868865967
Test Epoch0 layer4 Acc 0.5685923136111448, AUC 0.3536544144153595
gc 0
[[4.76628619e+03 3.77117249e+00]
 [1.00062176e-01 3.60173244e+00]
 [1.31934954e+03 8.34883116e+02]
 [9.47916869e+02 8.13746126e+02]
 [9.00498539e+02 6.32699935e+02]]
Train Epoch1 Acc 0.568937150378414 (224770/395070), AUC 0.3511239290237427
Test Epoch1 layer0 Acc 0.9956566638318551, AUC 0.9877876043319702
Test Epoch1 layer1 Acc 0.9954238043170129, AUC 0.9861579537391663
Test Epoch1 layer2 Acc 0.573431741789171, AUC 0.4517193138599396
Test Epoch1 layer3 Acc 0.036224841048070305, AUC 0.5531880855560303
Test Epoch1 layer4 Acc 0.569230146195278, AUC 0.3598686456680298
gc 0
[[4.76605403e+03 3.76474795e+00]
 [1.63546619e-02 2.96081624e+00]
 [1.40935507e+03 8.83647427e+02]
 [9.94783695e+02 8.50581104e+02]
 [9.32256601e+02 6.45677290e+02]]
Train Epoch2 Acc 0.5693952970359684 (224951/395070), AUC 0.3897063434123993
Test Epoch2 layer0 Acc 0.9958287773863038, AUC 0.9818372130393982
Test Epoch2 layer1 Acc 0.9959705179605556, AUC 0.976753830909729
Test Epoch2 layer2 Acc 0.5717004819179524, AUC 0.42493489384651184
Test Epoch2 layer3 Acc 0.020096788563560522, AUC 0.5499514937400818
Test Epoch2 layer4 Acc 0.5701818329081116, AUC 0.3966849446296692
gc 0
[[4.76601434e+03 3.72958039e+00]
 [2.80193569e-03 2.64901685e+00]
 [1.47667279e+03 9.25569902e+02]
 [1.02336608e+03 8.81611097e+02]
 [9.45402540e+02 6.58632846e+02]]
Train Epoch3 Acc 0.35337028880957805 (139606/395070), AUC 0.42550212144851685
Test Epoch3 layer0 Acc 0.9959705179605556, AUC 0.9508320093154907
Test Epoch3 layer1 Acc 0.9963957396833111, AUC 0.9151666164398193
Test Epoch3 layer2 Acc 0.5740088284129106, AUC 0.43602848052978516
Test Epoch3 layer3 Acc 0.014690398088527113, AUC 0.5325150489807129
Test Epoch3 layer4 Acc 0.024824849147531688, AUC 0.4387570321559906
gc 0
[[4.76600719e+03 3.70313167e+00]
 [5.64027915e-04 2.46295340e+00]
 [1.53591693e+03 9.63756805e+02]
 [1.04774158e+03 9.13656776e+02]
 [9.59431948e+02 6.79570286e+02]]
Train Epoch4 Acc 0.006376085250715063 (2519/395070), AUC 0.4411831796169281
Test Epoch4 layer0 Acc 0.9963046207427206, AUC 0.9139926433563232
Test Epoch4 layer1 Acc 0.9968715830397279, AUC 0.9063518047332764
Test Epoch4 layer2 Acc 0.5759020775118454, AUC 0.435426265001297
Test Epoch4 layer3 Acc 0.012422548900498117, AUC 0.4905164837837219
Test Epoch4 layer4 Acc 0.004312963187948001, AUC 0.43549835681915283
gc 0
[[4.76601286e+03 3.60910929e+00]
 [6.70741123e-05 2.28545028e+00]
 [1.58033115e+03 9.90745770e+02]
 [1.06657131e+03 9.39996821e+02]
 [9.73929758e+02 6.96637867e+02]]
Train Epoch5 Acc 0.004075227174931025 (1610/395070), AUC 0.44005918502807617
Test Epoch5 layer0 Acc 0.9964868586239015, AUC 0.9125056862831116
Test Epoch5 layer1 Acc 0.997023447940712, AUC 0.9093075394630432
Test Epoch5 layer2 Acc 0.5765702830761754, AUC 0.4423460066318512
Test Epoch5 layer3 Acc 0.011005143157979994, AUC 0.48959168791770935
Test Epoch5 layer4 Acc 0.0038269955047989307, AUC 0.4367987811565399
gc 0
[[4.76601254e+03 3.54782731e+00]
 [1.08698627e-04 2.19860966e+00]
 [1.60786120e+03 1.00729893e+03]
 [1.07870839e+03 9.57015521e+02]
 [9.83783280e+02 7.07715180e+02]]
Train Epoch6 Acc 0.0037790771255726834 (1493/395070), AUC 0.43901243805885315
Test Epoch6 layer0 Acc 0.9966893451585469, AUC 0.8967846035957336
Test Epoch6 layer1 Acc 0.9971854371684283, AUC 0.9113757610321045
Test Epoch6 layer2 Acc 0.5767221479771595, AUC 0.45096465945243835
Test Epoch6 layer3 Acc 0.010387559227311384, AUC 0.4743952751159668
Test Epoch6 layer4 Acc 0.003533390029563034, AUC 0.4365737736225128
gc 0
[[4.76600536e+03 3.47329924e+00]
 [1.10624017e-04 2.11667043e+00]
 [1.62816219e+03 1.02171602e+03]
 [1.08760739e+03 9.72118345e+02]
 [9.91266167e+02 7.17373698e+02]]
Train Epoch7 Acc 0.0033918039841040826 (1340/395070), AUC 0.43692415952682495
Test Epoch7 layer0 Acc 0.9968412100595311, AUC 0.8964044451713562
Test Epoch7 layer1 Acc 0.997286680435751, AUC 0.9192006587982178
Test Epoch7 layer2 Acc 0.5780079374721581, AUC 0.45323455333709717
Test Epoch7 layer3 Acc 0.008889158870935082, AUC 0.4907069206237793
Test Epoch7 layer4 Acc 0.0031891629206657755, AUC 0.4335222542285919
gc 0
[[4.76600533e+03 3.39157413e+00]
 [1.07160963e-04 2.04233242e+00]
 [1.64186438e+03 1.03424314e+03]
 [1.09349848e+03 9.83219847e+02]
 [9.96353728e+02 7.25072164e+02]]
Train Epoch8 Acc 0.0031842458298529373 (1258/395070), AUC 0.4350964426994324
Test Epoch8 layer0 Acc 0.9969222046733892, AUC 0.8942504525184631
Test Epoch8 layer1 Acc 0.9973271777426801, AUC 0.918370246887207
Test Epoch8 layer2 Acc 0.576701899323695, AUC 0.4568427801132202
Test Epoch8 layer3 Acc 0.009395375207548698, AUC 0.5049402713775635
Test Epoch8 layer4 Acc 0.0029866763860203296, AUC 0.4316435754299164
gc 0
[[4.76600530e+03 3.31022471e+00]
 [1.65395219e-05 1.96157648e+00]
 [1.64970208e+03 1.04311294e+03]
 [1.09687053e+03 9.91388786e+02]
 [9.99246159e+02 7.30763968e+02]]
Train Epoch9 Acc 0.0030652795707089885 (1211/395070), AUC 0.43295395374298096
Test Epoch9 layer0 Acc 0.9969019560199247, AUC 0.8937881588935852
Test Epoch9 layer1 Acc 0.9973170534159478, AUC 0.9178974032402039
Test Epoch9 layer2 Acc 0.5761754343336168, AUC 0.45915067195892334
Test Epoch9 layer3 Acc 0.009881342890697769, AUC 0.5294204950332642
Test Epoch9 layer4 Acc 0.0030069250394848743, AUC 0.4300498068332672
Best AUC 0.9906134009361267
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//kdd99/kdd99_linearal_l5_m2.pt
[[56130     0    28     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     1 19422    12     0     8     0     7     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    0     1    41     0   276     0     0     0     0     0     0]
 [    0     0    52     0     0   198     0     0     0     0     0]
 [    0    24    18     0    28     0   138     0     0     0     0]
 [    0     0   135    11     0     0     0    58     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    0     0    31     0     0    22     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56130     0    28     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     0 19431    10     0     3     0     6     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    0     1    42     0   275     0     0     0     0     0     0]
 [    0     0    53     0     0   197     0     0     0     0     0]
 [    0    75    31     0    25     0    77     0     0     0     0]
 [    4     0   132    11     0     0     0    57     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [   23     0    30     0     0     0     0     0     0     0     0]
 [    0    16    31     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [    5     3    15     0 21414     0     0     4     0     0     0]
 [17560   223  1237    12   360     1    24    39     0     0     0]
 [  431     8     2     0     0     0     0     0     0     0     0]
 [   13    10   261     0    34     0     0     0     0     0     0]
 [   24     0   226     0     0     0     0     0     0     0     0]
 [    4     0   100     0   104     0     0     0     0     0     0]
 [  121     4    19     0     1     0    59     0     0     0     0]
 [    2   194     0     0     0     0     0     0     0     0     0]
 [   41     5     7     0     0     0     0     0     0     0     0]
 [    8     0    39     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0    28     0     8     0 55857    13   252     0     0]
 [    0  3594 17363     0   483     0     0     1     0     0     0]
 [    0     4  8165     0   381     0     4 10897     5     0     0]
 [    0     0     5     0   423     0     0    13     0     0     0]
 [    0     0    64     0   242     0     0    12     0     0     0]
 [    0     0   219     0     0     0     0    31     0     0     0]
 [    0     3     4     0   184     0     0    17     0     0     0]
 [    0     0   181     0    10     0     0    13     0     0     0]
 [    0     0     0     1   193     0     0     2     0     0     0]
 [    0     0     2     9     1     0     0    41     0     0     0]
 [    0     0     7     0     0     0     0    40     0     0     0]]
Figure(640x480)
[[56143    15     0     0     0     0     0     0     0     0     0]
 [18070     0     0     0     0     0     0     0  3371     0     0]
 [13047  2141    18    15     3  4218     2     0    12     0     0]
 [  127     0    83     0     0     0   231     0     0     0     0]
 [  312     0     6     0     0     0     0     0     0     0     0]
 [  231     0    19     0     0     0     0     0     0     0     0]
 [  202     0     6     0     0     0     0     0     0     0     0]
 [  141     0    63     0     0     0     0     0     0     0     0]
 [    2     0     0     0     0     0   194     0     0     0     0]
 [   46     0     0     0     0     0     7     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
