Load ckpt from ./ckpt/mask2//kdd99/kdd99_linearal_l5_m2.pt
layer_mask {0, 1, 2}
Start Training
gc 9
[[4.76616165e+03 4.10584652e+00]
 [3.25423127e-02 3.61212358e+00]
 [2.68542281e+01 2.13791105e+01]
 [1.05474458e+03 9.45704322e+02]
 [9.20006581e+02 6.79740596e+02]]
Train Epoch0 Acc 0.5686055635710128 (224639/395070), AUC 0.4988471269607544
Test Epoch0 layer0 Acc 0.9956161665249261, AUC 0.984134316444397
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l5_m3.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9954643016239421, AUC 0.9825235605239868
Test Epoch0 layer2 Acc 0.9944417446239825, AUC 0.9766687154769897
Test Epoch0 layer3 Acc 0.003594135989956668, AUC 0.41001570224761963
Test Epoch0 layer4 Acc 0.5685821892844126, AUC 0.5678791403770447
gc 0
[[4.76601913e+03 4.19866705e+00]
 [1.62710327e-03 3.06215657e+00]
 [1.44343946e-01 3.04426143e+00]
 [1.15246909e+03 1.01196890e+03]
 [9.59703095e+02 7.31700563e+02]]
Train Epoch1 Acc 0.5686840306781077 (224670/395070), AUC 0.5762152075767517
Test Epoch1 layer0 Acc 0.9958591503665006, AUC 0.9661354422569275
Test Epoch1 layer1 Acc 0.9961122585348074, AUC 0.9632667899131775
Test Epoch1 layer2 Acc 0.9960515125744138, AUC 0.9266951084136963
Test Epoch1 layer3 Acc 0.003027173692949419, AUC 0.4455867111682892
Test Epoch1 layer4 Acc 0.5691694002348844, AUC 0.5690030455589294
gc 0
[[4.76600787e+03 4.11189092e+00]
 [4.84232809e-04 2.76003878e+00]
 [1.98062191e-02 2.30787602e+00]
 [1.20918734e+03 1.05340775e+03]
 [9.86834831e+02 7.65034340e+02]]
Train Epoch2 Acc 0.5701166881818412 (225236/395070), AUC 0.5702542662620544
Test Epoch2 layer0 Acc 0.9960110152674847, AUC 0.9315333962440491
Test Epoch2 layer1 Acc 0.9965678532377596, AUC 0.9137869477272034
Test Epoch2 layer2 Acc 0.9967197181387438, AUC 0.9133279323577881
Test Epoch2 layer3 Acc 0.004069979346373466, AUC 0.45426222681999207
Test Epoch2 layer4 Acc 0.5705058113635443, AUC 0.5959333777427673
gc 0
[[4.76600579e+03 3.96940580e+00]
 [4.71061072e-04 2.52220948e+00]
 [3.94375096e-03 1.95684697e+00]
 [1.24176814e+03 1.07645634e+03]
 [1.00376425e+03 7.84082740e+02]]
Train Epoch3 Acc 0.5705292732933405 (225399/395070), AUC 0.6125948429107666
Test Epoch3 layer0 Acc 0.9964159883367756, AUC 0.9194638729095459
Test Epoch3 layer1 Acc 0.9971145668813024, AUC 0.9146350622177124
Test Epoch3 layer2 Acc 0.9972360588020897, AUC 0.9124103784561157
Test Epoch3 layer3 Acc 0.0048090551978293445, AUC 0.5077796578407288
Test Epoch3 layer4 Acc 0.5704248167496861, AUC 0.607603132724762
gc 0
[[4.76600539e+03 3.77087363e+00]
 [4.39797281e-04 2.32005548e+00]
 [1.03781418e-03 1.73408186e+00]
 [1.25622269e+03 1.08891763e+03]
 [1.01295963e+03 7.93604483e+02]]
Train Epoch4 Acc 0.5705014301263067 (225388/395070), AUC 0.6000192761421204
Test Epoch4 layer0 Acc 0.9968108370793343, AUC 0.9122685790061951
Test Epoch4 layer1 Acc 0.9972158101486251, AUC 0.9180842041969299
Test Epoch4 layer2 Acc 0.9973069290892156, AUC 0.9142112731933594
Test Epoch4 layer3 Acc 0.005072287692868424, AUC 0.49348002672195435
Test Epoch4 layer4 Acc 0.5704956870368121, AUC 0.5887278914451599
gc 0
[[4.76600533e+03 3.59156825e+00]
 [6.54141412e-05 2.14452442e+00]
 [1.24067859e-04 1.56507455e+00]
 [1.26244314e+03 1.09600196e+03]
 [1.01764446e+03 7.98615034e+02]]
Train Epoch5 Acc 0.5704963677323006 (225386/395070), AUC 0.5912578701972961
Test Epoch5 layer0 Acc 0.9968209614060665, AUC 0.8959687948226929
Test Epoch5 layer1 Acc 0.9972664317822865, AUC 0.9183870553970337
Test Epoch5 layer2 Acc 0.997398048029806, AUC 0.9115263223648071
Test Epoch5 layer3 Acc 0.005092536346332969, AUC 0.45444896817207336
Test Epoch5 layer4 Acc 0.5704450654031507, AUC 0.5850991606712341
gc 0
[[4.76600531e+03 3.49888064e+00]
 [1.14274584e-04 2.06023149e+00]
 [2.04155032e-04 1.49139892e+00]
 [1.26537460e+03 1.10095418e+03]
 [1.01994492e+03 8.01213116e+02]]
Train Epoch6 Acc 0.5705014301263067 (225388/395070), AUC 0.5891035795211792
Test Epoch6 layer0 Acc 0.9969728263070505, AUC 0.8981835842132568
Test Epoch6 layer1 Acc 0.9973170534159478, AUC 0.9185531735420227
Test Epoch6 layer2 Acc 0.9974081723565383, AUC 0.9105066657066345
Test Epoch6 layer3 Acc 0.005102660673065241, AUC 0.41410791873931885
Test Epoch6 layer4 Acc 0.5704754383833475, AUC 0.5830488801002502
gc 0
[[4.76600529e+03 3.42078065e+00]
 [1.20011365e-04 1.99164342e+00]
 [2.11424169e-04 1.43307733e+00]
 [1.26746097e+03 1.10437121e+03]
 [1.02161181e+03 8.03190646e+02]]
Train Epoch7 Acc 0.5705242108993342 (225397/395070), AUC 0.5889831185340881
Test Epoch7 layer0 Acc 0.9970538209209088, AUC 0.8942981362342834
Test Epoch7 layer1 Acc 0.9973676750496092, AUC 0.9189803600311279
Test Epoch7 layer2 Acc 0.9974790426436642, AUC 0.9109974503517151
Test Epoch7 layer3 Acc 0.005102660673065241, AUC 0.42037972807884216
Test Epoch7 layer4 Acc 0.5704754383833475, AUC 0.5845085382461548
gc 0
[[4.76600527e+03 3.33273544e+00]
 [1.12962394e-04 1.91946832e+00]
 [1.97595644e-04 1.37414658e+00]
 [1.26916971e+03 1.10833275e+03]
 [1.02297034e+03 8.05778300e+02]]
Train Epoch8 Acc 0.5705166173083251 (225394/395070), AUC 0.5899305939674377
Test Epoch8 layer0 Acc 0.9971550641882315, AUC 0.8946484923362732
Test Epoch8 layer1 Acc 0.9975600372575224, AUC 0.9203670620918274
Test Epoch8 layer2 Acc 0.9977220264852388, AUC 0.9100503325462341
Test Epoch8 layer3 Acc 0.005102660673065241, AUC 0.39589110016822815
Test Epoch8 layer4 Acc 0.5704855627100798, AUC 0.5864697098731995
gc 0
[[4.76600527e+03 3.26073960e+00]
 [1.56482636e-05 1.85583833e+00]
 [2.68846071e-05 1.31815715e+00]
 [1.27026457e+03 1.11164928e+03]
 [1.02379941e+03 8.06802362e+02]]
Train Epoch9 Acc 0.5705267420963374 (225398/395070), AUC 0.5901345610618591
Test Epoch9 layer0 Acc 0.9971145668813024, AUC 0.893746018409729
Test Epoch9 layer1 Acc 0.9975195399505933, AUC 0.9188686013221741
Test Epoch9 layer2 Acc 0.9975195399505933, AUC 0.909414529800415
Test Epoch9 layer3 Acc 0.005102660673065241, AUC 0.38183557987213135
Test Epoch9 layer4 Acc 0.5705058113635443, AUC 0.584192156791687
Best AUC 0.984134316444397
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//kdd99/kdd99_linearal_l5_m3.pt
[[56136     0    22     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     1 19424    12     0     7     0     6     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    0     0    41     0   277     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0    24    17     0     4     0   163     0     0     0     0]
 [    0     0   136     5     0     0     0    63     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    1     0    30     0     0    22     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56137     0    21     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     1 19432    10     0     6     0     1     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    2     0    39     0   277     0     0     0     0     0     0]
 [    0     0    50     0     0   200     0     0     0     0     0]
 [    0    24    16     0     6     0   162     0     0     0     0]
 [    0     0   136     7     0     2     0    59     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    5     0    25     0     0    18     0     0     5     0     0]
 [    0    17    30     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56136     0    22     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     0 19433    10     0     7     0     0     0     0     0]
 [    0     0    15   426     0     0     0     0     0     0     0]
 [    1     0    40     0   277     0     0     0     0     0     0]
 [    0     0    50     0     0   200     0     0     0     0     0]
 [    0    37    23     0    29     0   119     0     0     0     0]
 [    0     0   184    12     0     8     0     0     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [   30     0    23     0     0     0     0     0     0     0     0]
 [    0    16    31     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0     0     0 56137     0     0    21     0     0     0]
 [    0     0     0     0 21440     0     0     1     0     0     0]
 [    0     3     0     0 12553     0     0  6899     1     0     0]
 [    0     0     0     0   107     0     0     0   334     0     0]
 [    0     0     0     0   288     0     0    30     0     0     0]
 [    0     0     0     0   225     0     0    25     0     0     0]
 [    0     0     0     0   190     0     0    18     0     0     0]
 [    0     0     0     0   137     0     0    67     0     0     0]
 [    0     0     0     0   196     0     0     0     0     0     0]
 [    0     0     0     0    50     0     0     3     0     0     0]
 [    0     0     0     0    16     0     0    31     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [19432    21     2     0     0     0     1     0     0     0     0]
 [  441     0     0     0     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  208     0     0     0     0     0     0     0     0     0     0]
 [  198     0     6     0     0     0     0     0     0     0     0]
 [   74     0     0     0     0     0   122     0     0     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
