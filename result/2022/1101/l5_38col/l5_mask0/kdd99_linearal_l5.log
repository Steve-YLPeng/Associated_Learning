Start Training
[[5372.06413507   27.15567567]
 [ 504.08426297  562.41113123]
 [ 429.49247125  540.40919112]
 [ 383.95307981  430.01017174]
 [ 401.14599395  401.48240136]]
Train Epoch0 Acc 0.0008783253600627737 (347/395070), AUC 0.4554615914821625
Test Epoch0 layer0 Acc 0.9818167091888389, AUC 0.9659661650657654
Save ckpt to ./ckpt/train_l0//kdd99/kdd99_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.20447090268497145, AUC 0.5120350122451782
Test Epoch0 layer2 Acc 0.5880715182440368, AUC 0.5368736386299133
Test Epoch0 layer3 Acc 0.17886648037905478, AUC 0.5003169775009155
Test Epoch0 layer4 Acc 0.0009516867128335966, AUC 0.44513437151908875
[[4.80600400e+03 3.82491176e+00]
 [8.02877083e+02 6.91766950e+02]
 [6.24311218e+02 6.43369890e+02]
 [5.21812470e+02 4.98377059e+02]
 [4.96090119e+02 4.36446037e+02]]
Train Epoch1 Acc 0.0009517300731515934 (376/395070), AUC 0.4431073069572449
Test Epoch1 layer0 Acc 0.9946543554853602, AUC 0.9931468963623047
Save ckpt to ./ckpt/train_l0//kdd99/kdd99_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.20418742153646782, AUC 0.4962187707424164
Test Epoch1 layer2 Acc 0.5803770299275098, AUC 0.5624196529388428
Test Epoch1 layer3 Acc 0.17882598307212572, AUC 0.5053792595863342
Test Epoch1 layer4 Acc 0.0012250435346049487, AUC 0.4597252905368805
[[4.77204959e+03 3.10124588e+00]
 [9.97496110e+02 7.77236253e+02]
 [7.31882037e+02 7.05178786e+02]
 [5.97566416e+02 5.35664700e+02]
 [5.39572291e+02 4.63345941e+02]]
Train Epoch2 Acc 0.0012099121674639937 (478/395070), AUC 0.4548284709453583
Test Epoch2 layer0 Acc 0.9952618150892966, AUC 0.9933536648750305
Save ckpt to ./ckpt/train_l0//kdd99/kdd99_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.20193982100190339, AUC 0.4978952407836914
Test Epoch2 layer2 Acc 0.579678451382983, AUC 0.6217756867408752
Test Epoch2 layer3 Acc 0.1787551127849998, AUC 0.44687414169311523
Test Epoch2 layer4 Acc 0.0013971570890535779, AUC 0.4623398780822754
[[4.76610479e+03 3.09985577e+00]
 [1.14716351e+03 8.51254894e+02]
 [8.06961937e+02 7.49696233e+02]
 [6.50229326e+02 5.59970493e+02]
 [5.65942440e+02 4.85263387e+02]]
Train Epoch3 Acc 0.0015971853089325942 (631/395070), AUC 0.4596823453903198
Test Epoch3 layer0 Acc 0.995909772000162, AUC 0.9932193756103516
Test Epoch3 layer1 Acc 0.19756611185356174, AUC 0.49863824248313904
Test Epoch3 layer2 Acc 0.5786457700562913, AUC 0.6228135824203491
Test Epoch3 layer3 Acc 0.178502004616693, AUC 0.4547589123249054
Test Epoch3 layer4 Acc 0.002105859960312639, AUC 0.4778623878955841
[[4.76490342e+03 3.15970347e+00]
 [1.29328426e+03 9.24572198e+02]
 [8.76653568e+02 7.92378171e+02]
 [6.98056168e+02 5.85983732e+02]
 [5.91283899e+02 5.09421119e+02]]
Train Epoch4 Acc 0.09560837319968613 (37772/395070), AUC 0.48264238238334656
Test Epoch4 layer0 Acc 0.9962337504555947, AUC 0.9921137094497681
Test Epoch4 layer1 Acc 0.19398210019033735, AUC 0.47017812728881836
Test Epoch4 layer2 Acc 0.5764589154821205, AUC 0.6152946352958679
Test Epoch4 layer3 Acc 0.007087028712590613, AUC 0.5005778670310974
Test Epoch4 layer4 Acc 0.17515085246831086, AUC 0.4915362298488617
[[4.76466174e+03 3.20498229e+00]
 [1.42795843e+03 9.92597635e+02]
 [9.38733602e+02 8.31538094e+02]
 [7.39445907e+02 6.11343194e+02]
 [6.13313180e+02 5.33209671e+02]]
Train Epoch5 Acc 0.17545498266130052 (69317/395070), AUC 0.4961303770542145
Test Epoch5 layer0 Acc 0.9964362369902402, AUC 0.982158899307251
Test Epoch5 layer1 Acc 0.19263556473494511, AUC 0.45861169695854187
Test Epoch5 layer2 Acc 0.5745555420564532, AUC 0.6181798577308655
Test Epoch5 layer3 Acc 0.004515449722593447, AUC 0.5043407082557678
Test Epoch5 layer4 Acc 0.17576843639897946, AUC 0.5018287897109985
[[4.76460914e+03 3.24683434e+00]
 [1.55255269e+03 1.05268073e+03]
 [9.93891308e+02 8.65591919e+02]
 [7.75230831e+02 6.34840248e+02]
 [6.32825311e+02 5.53637190e+02]]
Train Epoch6 Acc 0.17568532158857925 (69408/395070), AUC 0.5048003196716309
Test Epoch6 layer0 Acc 0.9967095938120115, AUC 0.9827179312705994
Test Epoch6 layer1 Acc 0.18297695703235733, AUC 0.4556427001953125
Test Epoch6 layer2 Acc 0.5741505689871623, AUC 0.6188373565673828
Test Epoch6 layer3 Acc 0.003776373871137569, AUC 0.5016686320304871
Test Epoch6 layer4 Acc 0.17591017697323127, AUC 0.5122659802436829
[[4.76459905e+03 3.27154358e+00]
 [1.66717526e+03 1.10660511e+03]
 [1.04296620e+03 8.96114705e+02]
 [8.06102101e+02 6.56524018e+02]
 [6.50498297e+02 5.71942269e+02]]
Train Epoch7 Acc 0.17573088313463436 (69426/395070), AUC 0.5258768200874329
Test Epoch7 layer0 Acc 0.9969222046733892, AUC 0.9772382974624634
Test Epoch7 layer1 Acc 0.17736808002267848, AUC 0.44517967104911804
Test Epoch7 layer2 Acc 0.573877212165391, AUC 0.593411386013031
Test Epoch7 layer3 Acc 0.0035435143562953064, AUC 0.46874701976776123
Test Epoch7 layer4 Acc 0.17593042562669584, AUC 0.5527592301368713
[[4.76459670e+03 3.22739075e+00]
 [1.75982754e+03 1.14894732e+03]
 [1.08033566e+03 9.20764412e+02]
 [8.29525082e+02 6.75992907e+02]
 [6.66602703e+02 5.87849228e+02]]
Train Epoch8 Acc 0.17573847672564355 (69429/395070), AUC 0.5500066876411438
Test Epoch8 layer0 Acc 0.9971348155347669, AUC 0.976630449295044
Test Epoch8 layer1 Acc 0.17624427975539628, AUC 0.4230215847492218
Test Epoch8 layer2 Acc 0.5739075851455878, AUC 0.5898564457893372
Test Epoch8 layer3 Acc 0.00360426031668894, AUC 0.45849740505218506
Test Epoch8 layer4 Acc 0.1759405499534281, AUC 0.5625786185264587
[[4.76459625e+03 3.12356866e+00]
 [1.82421944e+03 1.17826932e+03]
 [1.10621739e+03 9.37939310e+02]
 [8.45625641e+02 6.90591622e+02]
 [6.78713128e+02 5.99310425e+02]]
Train Epoch9 Acc 0.17574860151365582 (69433/395070), AUC 0.5624857544898987
Test Epoch9 layer0 Acc 0.9973373020694124, AUC 0.9779462218284607
Test Epoch9 layer1 Acc 0.17571781476531811, AUC 0.4203445315361023
Test Epoch9 layer2 Acc 0.573877212165391, AUC 0.5912963151931763
Test Epoch9 layer3 Acc 0.0034827683959016724, AUC 0.4626578390598297
Test Epoch9 layer4 Acc 0.1759405499534281, AUC 0.5683832764625549
Best AUC 0.9933536648750305
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/train_l0//kdd99/kdd99_linearal_l5.pt
[[56134     0    24     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     5 19421    12     0     7     0     5     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    0     1    43     0   274     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0    24    23     0    24     0   137     0     0     0     0]
 [    0     0   133     7     0     2     0    62     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    0     0    34     0     0    19     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0    21     0 56137     0     0     0     0     0     0]
 [    0 17338  4097     0     6     0     0     0     0     0     0]
 [   12   163  2607   630 15706     0    17   310    10     1     0]
 [    0    13     0     0   362     0     0    66     0     0     0]
 [    0   285    32     0     1     0     0     0     0     0     0]
 [    0     0     2    24   224     0     0     0     0     0     0]
 [    0    24    45   128    11     0     0     0     0     0     0]
 [   56     2     0     7   139     0     0     0     0     0     0]
 [    0     0     0   196     0     0     0     0     0     0     0]
 [    0     0     0    31    22     0     0     0     0     0     0]
 [    0     0     4    15    28     0     0     0     0     0     0]]
Figure(640x480)
[[56060    69     0     4     4     0     0    21     0     0     0]
 [    0     0     0     7 20299     0     0     0     0  1135     0]
 [    4    43   962   286 17356   722     0     0    15    18    50]
 [    0     0     0     0   441     0     0     0     0     0     0]
 [    0     5     3    76   234     0     0     0     0     0     0]
 [   51     0     0     0   199     0     0     0     0     0     0]
 [    0     0     4    18   177     3     0     0     0     6     0]
 [    4     0    21     1   120     0     0     0     0    58     0]
 [    0     0     0     0   196     0     0     0     0     0     0]
 [    0     0     0     0    53     0     0     0     0     0     0]
 [    0     0     0     0    47     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0     0     5     1     0     0     0  2013 54139     0]
 [ 4077 17351     0    13     0     0     0     0     0     0     0]
 [  960   561     4  6450   408     2   512    99 10459     1     0]
 [    0     0     0     0     0     0     7   153   281     0     0]
 [    0    19     0     0     0     0     0     0   299     0     0]
 [    5     2     0     4     0     0     0    18   221     0     0]
 [   50     5     0     1     0     0     0     0   152     0     0]
 [    0     8     0     0    58     0     1   105    32     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    0     0     0     7     0     0     0     0    46     0     0]
 [    0    24     0     3     0     0     0     0    20     0     0]]
Figure(640x480)
[[    0 53843     0  2315     0     0     0     0     0     0     0]
 [ 9332   136     0     0     0     0 11973     0     0     0     0]
 [   25  9439     0  8823     1    11   994     0    94    69     0]
 [   16   423     1     1     0     0     0     0     0     0     0]
 [    0     6     0   207     0     0     0     0   105     0     0]
 [    0     3     0   247     0     0     0     0     0     0     0]
 [    0    29     0   178     0     0     1     0     0     0     0]
 [    0    96     0    97     0     0    11     0     0     0     0]
 [    0     0     0   196     0     0     0     0     0     0     0]
 [    0     6     0    44     0     0     0     0     3     0     0]
 [    0     6     0    23     0     0     1     0    17     0     0]]
Figure(640x480)
