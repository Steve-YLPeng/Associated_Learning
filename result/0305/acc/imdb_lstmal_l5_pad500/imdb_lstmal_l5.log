total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 21.219311952590942
Start Training
gc 0
Train Epoch0 Acc 0.51575 (20630/40000), AUC 0.5246636867523193
ep0_train_time 78.90778636932373
Test Epoch0 layer0 Acc 0.8106, AUC 0.8872693777084351, avg_entr 0.559926450252533, f1 0.8105999231338501
ep0_l0_test_time 0.5601890087127686
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6118, AUC 0.6512213349342346, avg_entr 0.6575452089309692, f1 0.6118000149726868
ep0_l1_test_time 1.0581021308898926
Test Epoch0 layer2 Acc 0.6238, AUC 0.6847141981124878, avg_entr 0.643643856048584, f1 0.6237999796867371
ep0_l2_test_time 1.6738553047180176
Test Epoch0 layer3 Acc 0.6448, AUC 0.7029746770858765, avg_entr 0.675758957862854, f1 0.6448000073432922
ep0_l3_test_time 2.292842149734497
Test Epoch0 layer4 Acc 0.6522, AUC 0.7181419730186462, avg_entr 0.6664591431617737, f1 0.6521999835968018
ep0_l4_test_time 2.9290812015533447
gc 0
Train Epoch1 Acc 0.802425 (32097/40000), AUC 0.8635860085487366
ep1_train_time 79.29897427558899
Test Epoch1 layer0 Acc 0.8684, AUC 0.9453738331794739, avg_entr 0.28829455375671387, f1 0.868399977684021
ep1_l0_test_time 0.5623083114624023
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8338, AUC 0.9024689197540283, avg_entr 0.16028992831707, f1 0.8338000774383545
ep1_l1_test_time 1.0590016841888428
Test Epoch1 layer2 Acc 0.8346, AUC 0.9119828343391418, avg_entr 0.15331679582595825, f1 0.8345999717712402
ep1_l2_test_time 1.6594781875610352
Test Epoch1 layer3 Acc 0.8346, AUC 0.9115442037582397, avg_entr 0.1428908407688141, f1 0.8345999717712402
ep1_l3_test_time 2.269437789916992
Test Epoch1 layer4 Acc 0.8346, AUC 0.9108787775039673, avg_entr 0.13567863404750824, f1 0.8345999717712402
ep1_l4_test_time 2.883023977279663
gc 0
Train Epoch2 Acc 0.85525 (34210/40000), AUC 0.9212486743927002
ep2_train_time 79.30588269233704
Test Epoch2 layer0 Acc 0.8928, AUC 0.9553749561309814, avg_entr 0.23060861229896545, f1 0.892799973487854
ep2_l0_test_time 0.5597481727600098
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8532, AUC 0.9247738122940063, avg_entr 0.16000625491142273, f1 0.8532000184059143
ep2_l1_test_time 1.055417776107788
Test Epoch2 layer2 Acc 0.852, AUC 0.9325972199440002, avg_entr 0.17835964262485504, f1 0.8519999980926514
ep2_l2_test_time 1.6662700176239014
Test Epoch2 layer3 Acc 0.8534, AUC 0.9325934648513794, avg_entr 0.1941819041967392, f1 0.8533999919891357
ep2_l3_test_time 2.2764220237731934
Test Epoch2 layer4 Acc 0.8518, AUC 0.9329206943511963, avg_entr 0.2193637639284134, f1 0.8518000245094299
ep2_l4_test_time 2.888078212738037
gc 0
Train Epoch3 Acc 0.913 (36520/40000), AUC 0.9633761644363403
ep3_train_time 79.34546065330505
Test Epoch3 layer0 Acc 0.8934, AUC 0.9581472873687744, avg_entr 0.19592559337615967, f1 0.8934000134468079
ep3_l0_test_time 0.5613412857055664
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.887, AUC 0.948254406452179, avg_entr 0.07033266872167587, f1 0.8870000243186951
ep3_l1_test_time 1.0592107772827148
Test Epoch3 layer2 Acc 0.8892, AUC 0.9522340297698975, avg_entr 0.06846414506435394, f1 0.88919997215271
ep3_l2_test_time 1.661203384399414
Test Epoch3 layer3 Acc 0.889, AUC 0.9518298506736755, avg_entr 0.06454408168792725, f1 0.8889999985694885
ep3_l3_test_time 2.275686502456665
Test Epoch3 layer4 Acc 0.8888, AUC 0.9513829946517944, avg_entr 0.060607630759477615, f1 0.8888000249862671
ep3_l4_test_time 2.8903141021728516
gc 0
Train Epoch4 Acc 0.931625 (37265/40000), AUC 0.9743525981903076
ep4_train_time 79.41983246803284
Test Epoch4 layer0 Acc 0.898, AUC 0.9585270285606384, avg_entr 0.177484393119812, f1 0.8980000019073486
ep4_l0_test_time 0.5596060752868652
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8936, AUC 0.9483693838119507, avg_entr 0.04756750166416168, f1 0.8935999870300293
ep4_l1_test_time 1.0578737258911133
Test Epoch4 layer2 Acc 0.8938, AUC 0.9508812427520752, avg_entr 0.04062835872173309, f1 0.8938000202178955
ep4_l2_test_time 1.6678659915924072
Test Epoch4 layer3 Acc 0.8924, AUC 0.9503248929977417, avg_entr 0.03777972608804703, f1 0.8923999667167664
ep4_l3_test_time 2.267308235168457
Test Epoch4 layer4 Acc 0.8924, AUC 0.9500547051429749, avg_entr 0.03558336943387985, f1 0.8923999667167664
ep4_l4_test_time 2.892169952392578
gc 0
Train Epoch5 Acc 0.939775 (37591/40000), AUC 0.9801468849182129
ep5_train_time 79.37423872947693
Test Epoch5 layer0 Acc 0.8964, AUC 0.9583866596221924, avg_entr 0.16365762054920197, f1 0.896399974822998
ep5_l0_test_time 0.5747129917144775
Test Epoch5 layer1 Acc 0.8922, AUC 0.9480744004249573, avg_entr 0.04081261157989502, f1 0.8921999931335449
ep5_l1_test_time 1.0510945320129395
Test Epoch5 layer2 Acc 0.8916, AUC 0.9492620229721069, avg_entr 0.03292493894696236, f1 0.8916000127792358
ep5_l2_test_time 1.6723647117614746
Test Epoch5 layer3 Acc 0.8904, AUC 0.9487332105636597, avg_entr 0.031174469739198685, f1 0.8903999924659729
ep5_l3_test_time 2.284963846206665
Test Epoch5 layer4 Acc 0.8908, AUC 0.9483957290649414, avg_entr 0.0300464928150177, f1 0.8907999992370605
ep5_l4_test_time 2.923567056655884
gc 0
Train Epoch6 Acc 0.94715 (37886/40000), AUC 0.9842488765716553
ep6_train_time 79.26568055152893
Test Epoch6 layer0 Acc 0.8968, AUC 0.9573560953140259, avg_entr 0.15199057757854462, f1 0.8967999815940857
ep6_l0_test_time 0.5560534000396729
Test Epoch6 layer1 Acc 0.8876, AUC 0.9457740783691406, avg_entr 0.04103004187345505, f1 0.8876000046730042
ep6_l1_test_time 1.0510962009429932
Test Epoch6 layer2 Acc 0.887, AUC 0.9480690956115723, avg_entr 0.03627254068851471, f1 0.8870000243186951
ep6_l2_test_time 1.658128023147583
Test Epoch6 layer3 Acc 0.8872, AUC 0.9474142789840698, avg_entr 0.03560464456677437, f1 0.8871999979019165
ep6_l3_test_time 2.2589142322540283
Test Epoch6 layer4 Acc 0.8866, AUC 0.9472993612289429, avg_entr 0.03442530333995819, f1 0.8866000771522522
ep6_l4_test_time 2.8807294368743896
gc 0
Train Epoch7 Acc 0.954275 (38171/40000), AUC 0.9872024059295654
ep7_train_time 79.25782585144043
Test Epoch7 layer0 Acc 0.8928, AUC 0.9558990001678467, avg_entr 0.14738264679908752, f1 0.892799973487854
ep7_l0_test_time 0.555424690246582
Test Epoch7 layer1 Acc 0.8852, AUC 0.9460100531578064, avg_entr 0.04576573520898819, f1 0.8852000832557678
ep7_l1_test_time 1.0505774021148682
Test Epoch7 layer2 Acc 0.8848, AUC 0.9471098780632019, avg_entr 0.03560866788029671, f1 0.8848000168800354
ep7_l2_test_time 1.6681702136993408
Test Epoch7 layer3 Acc 0.885, AUC 0.9465360045433044, avg_entr 0.03344564512372017, f1 0.8849999904632568
ep7_l3_test_time 2.2608988285064697
Test Epoch7 layer4 Acc 0.8842, AUC 0.9463073015213013, avg_entr 0.03140256181359291, f1 0.8842000365257263
ep7_l4_test_time 2.8848681449890137
gc 0
Train Epoch8 Acc 0.959 (38360/40000), AUC 0.9894962906837463
ep8_train_time 79.26775527000427
Test Epoch8 layer0 Acc 0.8916, AUC 0.9536010026931763, avg_entr 0.1385224312543869, f1 0.8916000127792358
ep8_l0_test_time 0.5845546722412109
Test Epoch8 layer1 Acc 0.8788, AUC 0.9406728148460388, avg_entr 0.032022472470998764, f1 0.8787999749183655
ep8_l1_test_time 1.0566864013671875
Test Epoch8 layer2 Acc 0.8788, AUC 0.9424388408660889, avg_entr 0.02671687677502632, f1 0.8787999749183655
ep8_l2_test_time 1.6610713005065918
Test Epoch8 layer3 Acc 0.879, AUC 0.9416360855102539, avg_entr 0.027032623067498207, f1 0.8790000081062317
ep8_l3_test_time 2.2672479152679443
Test Epoch8 layer4 Acc 0.8776, AUC 0.9412901401519775, avg_entr 0.02678406611084938, f1 0.8776000142097473
ep8_l4_test_time 2.8897757530212402
gc 0
Train Epoch9 Acc 0.9638 (38552/40000), AUC 0.9916803240776062
ep9_train_time 79.18846368789673
Test Epoch9 layer0 Acc 0.8916, AUC 0.9529135227203369, avg_entr 0.1352912038564682, f1 0.8916000127792358
ep9_l0_test_time 0.5572509765625
Test Epoch9 layer1 Acc 0.8774, AUC 0.9403685331344604, avg_entr 0.03157976642251015, f1 0.8773999810218811
ep9_l1_test_time 1.0534753799438477
Test Epoch9 layer2 Acc 0.878, AUC 0.9412998557090759, avg_entr 0.02601064369082451, f1 0.878000020980835
ep9_l2_test_time 1.664273738861084
Test Epoch9 layer3 Acc 0.878, AUC 0.9405544996261597, avg_entr 0.025120368227362633, f1 0.878000020980835
ep9_l3_test_time 2.2766308784484863
Test Epoch9 layer4 Acc 0.8778, AUC 0.9401531219482422, avg_entr 0.024607840925455093, f1 0.8778000473976135
ep9_l4_test_time 2.896080732345581
gc 0
Train Epoch10 Acc 0.966475 (38659/40000), AUC 0.9926735758781433
ep10_train_time 79.1897041797638
Test Epoch10 layer0 Acc 0.887, AUC 0.9515441656112671, avg_entr 0.1307377964258194, f1 0.8870000243186951
ep10_l0_test_time 0.5639300346374512
Test Epoch10 layer1 Acc 0.8776, AUC 0.9388238787651062, avg_entr 0.03410651162266731, f1 0.8776000142097473
ep10_l1_test_time 1.0557730197906494
Test Epoch10 layer2 Acc 0.8786, AUC 0.9397790431976318, avg_entr 0.02653232030570507, f1 0.878600001335144
ep10_l2_test_time 1.6738336086273193
Test Epoch10 layer3 Acc 0.8774, AUC 0.9387086629867554, avg_entr 0.02573796734213829, f1 0.8773999810218811
ep10_l3_test_time 2.288893938064575
Test Epoch10 layer4 Acc 0.8782, AUC 0.938575029373169, avg_entr 0.025390412658452988, f1 0.8781999945640564
ep10_l4_test_time 2.9297549724578857
gc 0
Train Epoch11 Acc 0.96795 (38718/40000), AUC 0.9932185411453247
ep11_train_time 79.19687008857727
Test Epoch11 layer0 Acc 0.8852, AUC 0.950597882270813, avg_entr 0.13063807785511017, f1 0.8852000832557678
ep11_l0_test_time 0.5609805583953857
Test Epoch11 layer1 Acc 0.8756, AUC 0.9396417140960693, avg_entr 0.03273366764187813, f1 0.8756000399589539
ep11_l1_test_time 1.05153226852417
Test Epoch11 layer2 Acc 0.875, AUC 0.9401777982711792, avg_entr 0.025820989161729813, f1 0.875
ep11_l2_test_time 1.6615495681762695
Test Epoch11 layer3 Acc 0.873, AUC 0.9395037889480591, avg_entr 0.024889441207051277, f1 0.8730000257492065
ep11_l3_test_time 2.26049542427063
Test Epoch11 layer4 Acc 0.8738, AUC 0.9391916990280151, avg_entr 0.02488064579665661, f1 0.8737999796867371
ep11_l4_test_time 2.8815910816192627
gc 0
Train Epoch12 Acc 0.969125 (38765/40000), AUC 0.9940740466117859
ep12_train_time 79.16401696205139
Test Epoch12 layer0 Acc 0.8868, AUC 0.9493992328643799, avg_entr 0.12665636837482452, f1 0.8867999911308289
ep12_l0_test_time 0.5607142448425293
Test Epoch12 layer1 Acc 0.8774, AUC 0.9372700452804565, avg_entr 0.030192798003554344, f1 0.8773999810218811
ep12_l1_test_time 1.0591132640838623
Test Epoch12 layer2 Acc 0.8774, AUC 0.9381015300750732, avg_entr 0.023601798340678215, f1 0.8773999810218811
ep12_l2_test_time 1.6727049350738525
Test Epoch12 layer3 Acc 0.8764, AUC 0.937278687953949, avg_entr 0.022684961557388306, f1 0.8763999938964844
ep12_l3_test_time 2.275744915008545
Test Epoch12 layer4 Acc 0.8756, AUC 0.937084972858429, avg_entr 0.02234186790883541, f1 0.8756000399589539
ep12_l4_test_time 2.8866305351257324
gc 0
Train Epoch13 Acc 0.971325 (38853/40000), AUC 0.9949085712432861
ep13_train_time 79.31100726127625
Test Epoch13 layer0 Acc 0.8846, AUC 0.9486851096153259, avg_entr 0.1270361989736557, f1 0.8845999836921692
ep13_l0_test_time 0.5633161067962646
Test Epoch13 layer1 Acc 0.873, AUC 0.9356274604797363, avg_entr 0.027594491839408875, f1 0.8730000257492065
ep13_l1_test_time 1.049976110458374
Test Epoch13 layer2 Acc 0.8724, AUC 0.9365112781524658, avg_entr 0.021207623183727264, f1 0.8723999857902527
ep13_l2_test_time 1.6559185981750488
Test Epoch13 layer3 Acc 0.8726, AUC 0.9356951117515564, avg_entr 0.02078523486852646, f1 0.8726000189781189
ep13_l3_test_time 2.2763774394989014
Test Epoch13 layer4 Acc 0.8736, AUC 0.9353350400924683, avg_entr 0.02064458839595318, f1 0.8736000061035156
ep13_l4_test_time 2.892225980758667
gc 0
Train Epoch14 Acc 0.9723 (38892/40000), AUC 0.9949890971183777
ep14_train_time 79.22685503959656
Test Epoch14 layer0 Acc 0.8864, AUC 0.9481504559516907, avg_entr 0.1234537810087204, f1 0.8863999843597412
ep14_l0_test_time 0.5587332248687744
Test Epoch14 layer1 Acc 0.8746, AUC 0.93393874168396, avg_entr 0.024919820949435234, f1 0.8745999932289124
ep14_l1_test_time 1.051013469696045
Test Epoch14 layer2 Acc 0.8748, AUC 0.9347012639045715, avg_entr 0.018615439534187317, f1 0.8748000264167786
ep14_l2_test_time 1.6613152027130127
Test Epoch14 layer3 Acc 0.8754, AUC 0.9336056709289551, avg_entr 0.017300119623541832, f1 0.8754000067710876
ep14_l3_test_time 2.2737412452697754
Test Epoch14 layer4 Acc 0.8748, AUC 0.9332336783409119, avg_entr 0.01701359637081623, f1 0.8748000264167786
ep14_l4_test_time 2.8963940143585205
gc 0
Train Epoch15 Acc 0.972925 (38917/40000), AUC 0.9951996207237244
ep15_train_time 79.36420750617981
Test Epoch15 layer0 Acc 0.8836, AUC 0.9475501179695129, avg_entr 0.12299929559230804, f1 0.8835999965667725
ep15_l0_test_time 0.5747954845428467
Test Epoch15 layer1 Acc 0.875, AUC 0.9347228407859802, avg_entr 0.02727546915411949, f1 0.875
ep15_l1_test_time 1.055842638015747
Test Epoch15 layer2 Acc 0.8744, AUC 0.9356503486633301, avg_entr 0.020824216306209564, f1 0.8744000792503357
ep15_l2_test_time 1.6860332489013672
Test Epoch15 layer3 Acc 0.8734, AUC 0.9347782135009766, avg_entr 0.02014261484146118, f1 0.8733999729156494
ep15_l3_test_time 2.288640022277832
Test Epoch15 layer4 Acc 0.8734, AUC 0.9344048500061035, avg_entr 0.019461294636130333, f1 0.8733999729156494
ep15_l4_test_time 2.9284377098083496
gc 0
Train Epoch16 Acc 0.973525 (38941/40000), AUC 0.9953868389129639
ep16_train_time 79.25865912437439
Test Epoch16 layer0 Acc 0.8834, AUC 0.9468498229980469, avg_entr 0.12074983865022659, f1 0.8834000825881958
ep16_l0_test_time 0.562725305557251
Test Epoch16 layer1 Acc 0.8734, AUC 0.9317519664764404, avg_entr 0.023723522201180458, f1 0.8733999729156494
ep16_l1_test_time 1.0585076808929443
Test Epoch16 layer2 Acc 0.8732, AUC 0.9331311583518982, avg_entr 0.018392298370599747, f1 0.873199999332428
ep16_l2_test_time 1.6597440242767334
Test Epoch16 layer3 Acc 0.8732, AUC 0.931972861289978, avg_entr 0.01712232269346714, f1 0.873199999332428
ep16_l3_test_time 2.2677454948425293
Test Epoch16 layer4 Acc 0.8732, AUC 0.9314532279968262, avg_entr 0.017062785103917122, f1 0.873199999332428
ep16_l4_test_time 2.878981351852417
gc 0
Train Epoch17 Acc 0.974825 (38993/40000), AUC 0.9958676099777222
ep17_train_time 79.23146343231201
Test Epoch17 layer0 Acc 0.8822, AUC 0.9465599060058594, avg_entr 0.12066724896430969, f1 0.8822000026702881
ep17_l0_test_time 0.5655405521392822
Test Epoch17 layer1 Acc 0.8708, AUC 0.9350923299789429, avg_entr 0.027577770873904228, f1 0.8708000183105469
ep17_l1_test_time 1.0489497184753418
Test Epoch17 layer2 Acc 0.8704, AUC 0.9356298446655273, avg_entr 0.020907927304506302, f1 0.8704000115394592
ep17_l2_test_time 1.6651573181152344
Test Epoch17 layer3 Acc 0.87, AUC 0.9350139498710632, avg_entr 0.0201677568256855, f1 0.8700000047683716
ep17_l3_test_time 2.2714173793792725
Test Epoch17 layer4 Acc 0.8704, AUC 0.9346276521682739, avg_entr 0.01979726180434227, f1 0.8704000115394592
ep17_l4_test_time 2.8887834548950195
gc 0
Train Epoch18 Acc 0.9752 (39008/40000), AUC 0.9960001707077026
ep18_train_time 79.18908309936523
Test Epoch18 layer0 Acc 0.8822, AUC 0.9462621212005615, avg_entr 0.1202968880534172, f1 0.8822000026702881
ep18_l0_test_time 0.5540399551391602
Test Epoch18 layer1 Acc 0.8706, AUC 0.9341073632240295, avg_entr 0.026535360142588615, f1 0.8705999851226807
ep18_l1_test_time 1.046175241470337
Test Epoch18 layer2 Acc 0.8708, AUC 0.9349547624588013, avg_entr 0.019763758406043053, f1 0.8708000183105469
ep18_l2_test_time 1.6504390239715576
Test Epoch18 layer3 Acc 0.8694, AUC 0.9342054128646851, avg_entr 0.019161969423294067, f1 0.8694000244140625
ep18_l3_test_time 2.2650222778320312
Test Epoch18 layer4 Acc 0.8698, AUC 0.9338127374649048, avg_entr 0.018746480345726013, f1 0.8697999715805054
ep18_l4_test_time 2.888195514678955
gc 0
Train Epoch19 Acc 0.975675 (39027/40000), AUC 0.9959933757781982
ep19_train_time 79.1898934841156
Test Epoch19 layer0 Acc 0.8818, AUC 0.9458551406860352, avg_entr 0.11774050444364548, f1 0.8818000555038452
ep19_l0_test_time 0.5566384792327881
Test Epoch19 layer1 Acc 0.8724, AUC 0.9332906007766724, avg_entr 0.025007808580994606, f1 0.8723999857902527
ep19_l1_test_time 1.0569374561309814
Test Epoch19 layer2 Acc 0.8708, AUC 0.9340019226074219, avg_entr 0.018486792221665382, f1 0.8708000183105469
ep19_l2_test_time 1.6594057083129883
Test Epoch19 layer3 Acc 0.8712, AUC 0.933194637298584, avg_entr 0.017593827098608017, f1 0.8712000846862793
ep19_l3_test_time 2.2732367515563965
Test Epoch19 layer4 Acc 0.8706, AUC 0.932830274105072, avg_entr 0.01727275922894478, f1 0.8705999851226807
ep19_l4_test_time 2.888200283050537
gc 0
Train Epoch20 Acc 0.97585 (39034/40000), AUC 0.9960230588912964
ep20_train_time 79.17582702636719
Test Epoch20 layer0 Acc 0.8814, AUC 0.945623517036438, avg_entr 0.11781234294176102, f1 0.8813999891281128
ep20_l0_test_time 0.5583658218383789
Test Epoch20 layer1 Acc 0.873, AUC 0.9328122138977051, avg_entr 0.02484644390642643, f1 0.8730000257492065
ep20_l1_test_time 1.0495705604553223
Test Epoch20 layer2 Acc 0.8724, AUC 0.933684229850769, avg_entr 0.018388906493782997, f1 0.8723999857902527
ep20_l2_test_time 1.6801235675811768
Test Epoch20 layer3 Acc 0.8736, AUC 0.9328497648239136, avg_entr 0.01723533868789673, f1 0.8736000061035156
ep20_l3_test_time 2.290348768234253
Test Epoch20 layer4 Acc 0.8728, AUC 0.9322460293769836, avg_entr 0.01719299890100956, f1 0.8727999925613403
ep20_l4_test_time 2.921962261199951
gc 0
Train Epoch21 Acc 0.9766 (39064/40000), AUC 0.9962695837020874
ep21_train_time 79.15327024459839
Test Epoch21 layer0 Acc 0.8816, AUC 0.9454586505889893, avg_entr 0.11643435060977936, f1 0.881600022315979
ep21_l0_test_time 0.56215500831604
Test Epoch21 layer1 Acc 0.8726, AUC 0.9331220388412476, avg_entr 0.025983409956097603, f1 0.8726000189781189
ep21_l1_test_time 1.0536975860595703
Test Epoch21 layer2 Acc 0.8718, AUC 0.9339982271194458, avg_entr 0.019305039197206497, f1 0.8718000650405884
ep21_l2_test_time 1.6651275157928467
Test Epoch21 layer3 Acc 0.8716, AUC 0.9332296848297119, avg_entr 0.01811676286160946, f1 0.8715999722480774
ep21_l3_test_time 2.2692208290100098
Test Epoch21 layer4 Acc 0.8726, AUC 0.9326039552688599, avg_entr 0.018051760271191597, f1 0.8726000189781189
ep21_l4_test_time 2.880314588546753
gc 0
Train Epoch22 Acc 0.976625 (39065/40000), AUC 0.9962601065635681
ep22_train_time 79.17415809631348
Test Epoch22 layer0 Acc 0.8808, AUC 0.9453257322311401, avg_entr 0.11616278439760208, f1 0.8808000087738037
ep22_l0_test_time 0.5610861778259277
Test Epoch22 layer1 Acc 0.8728, AUC 0.9332468509674072, avg_entr 0.025273490697145462, f1 0.8727999925613403
ep22_l1_test_time 1.0474493503570557
Test Epoch22 layer2 Acc 0.8722, AUC 0.9341750144958496, avg_entr 0.019067222252488136, f1 0.872200071811676
ep22_l2_test_time 1.6630885601043701
Test Epoch22 layer3 Acc 0.8716, AUC 0.9334347248077393, avg_entr 0.018059052526950836, f1 0.8715999722480774
ep22_l3_test_time 2.2708683013916016
Test Epoch22 layer4 Acc 0.871, AUC 0.9328453540802002, avg_entr 0.01806168258190155, f1 0.8709999918937683
ep22_l4_test_time 2.888401508331299
gc 0
Train Epoch23 Acc 0.976725 (39069/40000), AUC 0.9963016510009766
ep23_train_time 79.17443871498108
Test Epoch23 layer0 Acc 0.8818, AUC 0.9452222585678101, avg_entr 0.11598886549472809, f1 0.8818000555038452
ep23_l0_test_time 0.5538430213928223
Test Epoch23 layer1 Acc 0.8722, AUC 0.9328786730766296, avg_entr 0.02525160275399685, f1 0.872200071811676
ep23_l1_test_time 1.0475175380706787
Test Epoch23 layer2 Acc 0.8716, AUC 0.9337815046310425, avg_entr 0.01887601986527443, f1 0.8715999722480774
ep23_l2_test_time 1.657485008239746
Test Epoch23 layer3 Acc 0.8714, AUC 0.9329909086227417, avg_entr 0.01783071644604206, f1 0.871399998664856
ep23_l3_test_time 2.2744100093841553
Test Epoch23 layer4 Acc 0.872, AUC 0.9323391914367676, avg_entr 0.017659107223153114, f1 0.871999979019165
ep23_l4_test_time 2.8859379291534424
gc 0
Train Epoch24 Acc 0.97705 (39082/40000), AUC 0.9964136481285095
ep24_train_time 79.16856408119202
Test Epoch24 layer0 Acc 0.8806, AUC 0.9450571537017822, avg_entr 0.11508575081825256, f1 0.8805999755859375
ep24_l0_test_time 0.5706315040588379
Test Epoch24 layer1 Acc 0.8726, AUC 0.9325090050697327, avg_entr 0.024730926379561424, f1 0.8726000189781189
ep24_l1_test_time 1.0531744956970215
Test Epoch24 layer2 Acc 0.8714, AUC 0.9334825873374939, avg_entr 0.01841328851878643, f1 0.871399998664856
ep24_l2_test_time 1.673983097076416
Test Epoch24 layer3 Acc 0.8716, AUC 0.9326808452606201, avg_entr 0.017255796119570732, f1 0.8715999722480774
ep24_l3_test_time 2.276014804840088
Test Epoch24 layer4 Acc 0.8718, AUC 0.9320290088653564, avg_entr 0.017192473635077477, f1 0.8718000650405884
ep24_l4_test_time 2.8909804821014404
gc 0
Train Epoch25 Acc 0.9771 (39084/40000), AUC 0.9965074062347412
ep25_train_time 79.16929936408997
Test Epoch25 layer0 Acc 0.879, AUC 0.9450216889381409, avg_entr 0.11571536958217621, f1 0.8790000081062317
ep25_l0_test_time 0.5724971294403076
Test Epoch25 layer1 Acc 0.8702, AUC 0.9329900145530701, avg_entr 0.02494060806930065, f1 0.870199978351593
ep25_l1_test_time 1.0547707080841064
Test Epoch25 layer2 Acc 0.8694, AUC 0.9337348341941833, avg_entr 0.018404819071292877, f1 0.8694000244140625
ep25_l2_test_time 1.6708543300628662
Test Epoch25 layer3 Acc 0.869, AUC 0.9330532550811768, avg_entr 0.017488345503807068, f1 0.8690000176429749
ep25_l3_test_time 2.2963225841522217
Test Epoch25 layer4 Acc 0.8696, AUC 0.9324902296066284, avg_entr 0.017240162938833237, f1 0.8695999383926392
ep25_l4_test_time 2.9233322143554688
gc 0
Train Epoch26 Acc 0.977325 (39093/40000), AUC 0.9965122938156128
ep26_train_time 79.17528867721558
Test Epoch26 layer0 Acc 0.881, AUC 0.9449442625045776, avg_entr 0.11463360488414764, f1 0.8809999823570251
ep26_l0_test_time 0.559004545211792
Test Epoch26 layer1 Acc 0.872, AUC 0.9324417114257812, avg_entr 0.023983340710401535, f1 0.871999979019165
ep26_l1_test_time 1.0496649742126465
Test Epoch26 layer2 Acc 0.8712, AUC 0.933283805847168, avg_entr 0.017781144008040428, f1 0.8712000846862793
ep26_l2_test_time 1.6600987911224365
Test Epoch26 layer3 Acc 0.871, AUC 0.9326076507568359, avg_entr 0.01681405119597912, f1 0.8709999918937683
ep26_l3_test_time 2.272052049636841
Test Epoch26 layer4 Acc 0.8708, AUC 0.9319571852684021, avg_entr 0.016582144424319267, f1 0.8708000183105469
ep26_l4_test_time 2.8833327293395996
gc 0
Train Epoch27 Acc 0.977375 (39095/40000), AUC 0.9964965581893921
ep27_train_time 79.24526643753052
Test Epoch27 layer0 Acc 0.8816, AUC 0.9448521137237549, avg_entr 0.11344833672046661, f1 0.881600022315979
ep27_l0_test_time 0.5757491588592529
Test Epoch27 layer1 Acc 0.8708, AUC 0.9324089884757996, avg_entr 0.024901805445551872, f1 0.8708000183105469
ep27_l1_test_time 1.0508391857147217
Test Epoch27 layer2 Acc 0.8706, AUC 0.9333752393722534, avg_entr 0.018728867173194885, f1 0.8705999851226807
ep27_l2_test_time 1.6625852584838867
Test Epoch27 layer3 Acc 0.8706, AUC 0.9325886964797974, avg_entr 0.017811451107263565, f1 0.8705999851226807
ep27_l3_test_time 2.2736473083496094
Test Epoch27 layer4 Acc 0.871, AUC 0.9318551421165466, avg_entr 0.01752859726548195, f1 0.8709999918937683
ep27_l4_test_time 2.885162115097046
gc 0
Train Epoch28 Acc 0.9775 (39100/40000), AUC 0.996575117111206
ep28_train_time 79.22975826263428
Test Epoch28 layer0 Acc 0.8808, AUC 0.9448212385177612, avg_entr 0.11382558941841125, f1 0.8808000087738037
ep28_l0_test_time 0.5575556755065918
Test Epoch28 layer1 Acc 0.8712, AUC 0.9323985576629639, avg_entr 0.02398037351667881, f1 0.8712000846862793
ep28_l1_test_time 1.0486478805541992
Test Epoch28 layer2 Acc 0.8706, AUC 0.9332234859466553, avg_entr 0.017801079899072647, f1 0.8705999851226807
ep28_l2_test_time 1.6538150310516357
Test Epoch28 layer3 Acc 0.8696, AUC 0.932592511177063, avg_entr 0.016855262219905853, f1 0.8695999383926392
ep28_l3_test_time 2.270423173904419
Test Epoch28 layer4 Acc 0.8696, AUC 0.9319339990615845, avg_entr 0.016482235863804817, f1 0.8695999383926392
ep28_l4_test_time 2.886580467224121
gc 0
Train Epoch29 Acc 0.977625 (39105/40000), AUC 0.9965704679489136
ep29_train_time 79.22511339187622
Test Epoch29 layer0 Acc 0.8804, AUC 0.944756269454956, avg_entr 0.11291374266147614, f1 0.8804000020027161
ep29_l0_test_time 0.5597977638244629
Test Epoch29 layer1 Acc 0.871, AUC 0.9324591159820557, avg_entr 0.024110998958349228, f1 0.8709999918937683
ep29_l1_test_time 1.0641655921936035
Test Epoch29 layer2 Acc 0.8706, AUC 0.9332828521728516, avg_entr 0.01782088540494442, f1 0.8705999851226807
ep29_l2_test_time 1.6584296226501465
Test Epoch29 layer3 Acc 0.8694, AUC 0.9326537847518921, avg_entr 0.01675916463136673, f1 0.8694000244140625
ep29_l3_test_time 2.268202543258667
Test Epoch29 layer4 Acc 0.8692, AUC 0.931982159614563, avg_entr 0.016456909477710724, f1 0.8691999912261963
ep29_l4_test_time 2.8884215354919434
Best AUC 0.898
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 2632.0689840316772
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8944, AUC 0.9553298950195312, avg_entr 0.17819000780582428, f1 0.8944000005722046
l0_test_time 0.5633449554443359
Test layer1 Acc 0.8882, AUC 0.9456931352615356, avg_entr 0.05393107980489731, f1 0.888200044631958
l1_test_time 1.0495855808258057
Test layer2 Acc 0.8876, AUC 0.9477183818817139, avg_entr 0.04714509844779968, f1 0.8876000046730042
l2_test_time 1.6576590538024902
Test layer3 Acc 0.8868, AUC 0.9480146169662476, avg_entr 0.043970610946416855, f1 0.8867999911308289
l3_test_time 2.2617030143737793
Test layer4 Acc 0.886, AUC 0.9478992819786072, avg_entr 0.04141750931739807, f1 0.8859999775886536
l4_test_time 2.90855073928833
