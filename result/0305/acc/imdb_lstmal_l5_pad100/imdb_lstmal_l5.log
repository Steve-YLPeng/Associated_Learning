total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 20.860815286636353
Start Training
gc 0
Train Epoch0 Acc 0.501675 (20067/40000), AUC 0.5055198669433594
ep0_train_time 17.85771870613098
Test Epoch0 layer0 Acc 0.799, AUC 0.8912739753723145, avg_entr 0.3965113162994385, f1 0.7990000247955322
ep0_l0_test_time 0.14029860496520996
Save ckpt to ckpt/imdb_lstmal_l5_pad100//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6172, AUC 0.6780635118484497, avg_entr 0.658624529838562, f1 0.6172000169754028
ep0_l1_test_time 0.23806071281433105
Test Epoch0 layer2 Acc 0.6026, AUC 0.6982895135879517, avg_entr 0.6711629629135132, f1 0.6025999784469604
ep0_l2_test_time 0.3534722328186035
Test Epoch0 layer3 Acc 0.5008, AUC 0.6905654668807983, avg_entr 0.6601036787033081, f1 0.5008000135421753
ep0_l3_test_time 0.4746112823486328
Test Epoch0 layer4 Acc 0.5, AUC 0.6203227043151855, avg_entr 0.6725062727928162, f1 0.5
ep0_l4_test_time 0.5948212146759033
gc 0
Train Epoch1 Acc 0.80535 (32214/40000), AUC 0.8835756778717041
ep1_train_time 17.77284574508667
Test Epoch1 layer0 Acc 0.835, AUC 0.9181760549545288, avg_entr 0.2593379318714142, f1 0.8349999785423279
ep1_l0_test_time 0.13933444023132324
Save ckpt to ckpt/imdb_lstmal_l5_pad100//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8254, AUC 0.8965034484863281, avg_entr 0.13495950400829315, f1 0.8253999948501587
ep1_l1_test_time 0.24015450477600098
Test Epoch1 layer2 Acc 0.8244, AUC 0.9025146961212158, avg_entr 0.13829198479652405, f1 0.8243999481201172
ep1_l2_test_time 0.3577289581298828
Test Epoch1 layer3 Acc 0.823, AUC 0.9023200273513794, avg_entr 0.12357010692358017, f1 0.8230000138282776
ep1_l3_test_time 0.4800429344177246
Test Epoch1 layer4 Acc 0.8218, AUC 0.9027632474899292, avg_entr 0.11732740700244904, f1 0.8218000531196594
ep1_l4_test_time 0.6044895648956299
gc 0
Train Epoch2 Acc 0.885875 (35435/40000), AUC 0.9484370946884155
ep2_train_time 17.795881986618042
Test Epoch2 layer0 Acc 0.8442, AUC 0.9200116395950317, avg_entr 0.21650034189224243, f1 0.8442000150680542
ep2_l0_test_time 0.13962769508361816
Save ckpt to ckpt/imdb_lstmal_l5_pad100//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8358, AUC 0.9091522693634033, avg_entr 0.11656955629587173, f1 0.8357999920845032
ep2_l1_test_time 0.24006247520446777
Test Epoch2 layer2 Acc 0.8368, AUC 0.9105589985847473, avg_entr 0.11219590902328491, f1 0.8368000388145447
ep2_l2_test_time 0.35695600509643555
Test Epoch2 layer3 Acc 0.8322, AUC 0.9095175862312317, avg_entr 0.11014211177825928, f1 0.8321999311447144
ep2_l3_test_time 0.4811978340148926
Test Epoch2 layer4 Acc 0.8322, AUC 0.9092445969581604, avg_entr 0.10778523236513138, f1 0.8321999311447144
ep2_l4_test_time 0.6048479080200195
gc 0
Train Epoch3 Acc 0.9115 (36460/40000), AUC 0.967078685760498
ep3_train_time 17.918961763381958
Test Epoch3 layer0 Acc 0.8406, AUC 0.9155337810516357, avg_entr 0.19308717548847198, f1 0.8405999541282654
ep3_l0_test_time 0.13791799545288086
Test Epoch3 layer1 Acc 0.8284, AUC 0.906639575958252, avg_entr 0.09371912479400635, f1 0.8284000158309937
ep3_l1_test_time 0.23705005645751953
Test Epoch3 layer2 Acc 0.8284, AUC 0.9062162637710571, avg_entr 0.0879211574792862, f1 0.8284000158309937
ep3_l2_test_time 0.36139750480651855
Test Epoch3 layer3 Acc 0.8288, AUC 0.9050713777542114, avg_entr 0.08798205852508545, f1 0.8288000226020813
ep3_l3_test_time 0.4829447269439697
Test Epoch3 layer4 Acc 0.8296, AUC 0.9048749804496765, avg_entr 0.08895663172006607, f1 0.8295999765396118
ep3_l4_test_time 0.6051127910614014
gc 0
Train Epoch4 Acc 0.925875 (37035/40000), AUC 0.9750921726226807
ep4_train_time 17.881187915802002
Test Epoch4 layer0 Acc 0.832, AUC 0.9107840061187744, avg_entr 0.17693284153938293, f1 0.8320000171661377
ep4_l0_test_time 0.13998770713806152
Test Epoch4 layer1 Acc 0.8276, AUC 0.9011886119842529, avg_entr 0.09789465367794037, f1 0.8276000022888184
ep4_l1_test_time 0.23595643043518066
Test Epoch4 layer2 Acc 0.8268, AUC 0.9012603759765625, avg_entr 0.08978603780269623, f1 0.8267999887466431
ep4_l2_test_time 0.35590577125549316
Test Epoch4 layer3 Acc 0.8252, AUC 0.9002748131752014, avg_entr 0.09096119552850723, f1 0.8252000212669373
ep4_l3_test_time 0.477092981338501
Test Epoch4 layer4 Acc 0.825, AUC 0.899909496307373, avg_entr 0.09263098239898682, f1 0.824999988079071
ep4_l4_test_time 0.5995562076568604
gc 0
Train Epoch5 Acc 0.939825 (37593/40000), AUC 0.9815813302993774
ep5_train_time 17.861381769180298
Test Epoch5 layer0 Acc 0.827, AUC 0.905720591545105, avg_entr 0.16406306624412537, f1 0.8270000219345093
ep5_l0_test_time 0.13854241371154785
Test Epoch5 layer1 Acc 0.8182, AUC 0.893797755241394, avg_entr 0.06791805475950241, f1 0.8181999921798706
ep5_l1_test_time 0.2347736358642578
Test Epoch5 layer2 Acc 0.8156, AUC 0.8938790559768677, avg_entr 0.055948223918676376, f1 0.8155999779701233
ep5_l2_test_time 0.35492587089538574
Test Epoch5 layer3 Acc 0.814, AUC 0.8928496241569519, avg_entr 0.05392749607563019, f1 0.8139999508857727
ep5_l3_test_time 0.4768099784851074
Test Epoch5 layer4 Acc 0.8138, AUC 0.8926827907562256, avg_entr 0.05404733866453171, f1 0.8137999773025513
ep5_l4_test_time 0.5991792678833008
gc 0
Train Epoch6 Acc 0.949325 (37973/40000), AUC 0.9865255355834961
ep6_train_time 17.862213134765625
Test Epoch6 layer0 Acc 0.8192, AUC 0.8981215953826904, avg_entr 0.15602514147758484, f1 0.8191999197006226
ep6_l0_test_time 0.13921451568603516
Test Epoch6 layer1 Acc 0.8154, AUC 0.8898746967315674, avg_entr 0.07034067064523697, f1 0.8154000043869019
ep6_l1_test_time 0.2378225326538086
Test Epoch6 layer2 Acc 0.8134, AUC 0.8894035220146179, avg_entr 0.05703108012676239, f1 0.8133999109268188
ep6_l2_test_time 0.359297513961792
Test Epoch6 layer3 Acc 0.8144, AUC 0.8883889317512512, avg_entr 0.05868956819176674, f1 0.8144000172615051
ep6_l3_test_time 0.4832422733306885
Test Epoch6 layer4 Acc 0.8138, AUC 0.8882415294647217, avg_entr 0.06041884794831276, f1 0.8137999773025513
ep6_l4_test_time 0.6049304008483887
gc 0
Train Epoch7 Acc 0.960275 (38411/40000), AUC 0.9912965893745422
ep7_train_time 17.84513211250305
Test Epoch7 layer0 Acc 0.8198, AUC 0.8972204923629761, avg_entr 0.15056347846984863, f1 0.8198000192642212
ep7_l0_test_time 0.13855838775634766
Test Epoch7 layer1 Acc 0.8112, AUC 0.8854405879974365, avg_entr 0.05479561164975166, f1 0.8112000226974487
ep7_l1_test_time 0.23779940605163574
Test Epoch7 layer2 Acc 0.8084, AUC 0.8849854469299316, avg_entr 0.04199519753456116, f1 0.8083999752998352
ep7_l2_test_time 0.35936927795410156
Test Epoch7 layer3 Acc 0.8098, AUC 0.8839278221130371, avg_entr 0.041890162974596024, f1 0.8098000288009644
ep7_l3_test_time 0.4833371639251709
Test Epoch7 layer4 Acc 0.811, AUC 0.8840149641036987, avg_entr 0.042172279208898544, f1 0.8109999895095825
ep7_l4_test_time 0.605217456817627
gc 0
Train Epoch8 Acc 0.96265 (38506/40000), AUC 0.9923171997070312
ep8_train_time 17.852118253707886
Test Epoch8 layer0 Acc 0.8132, AUC 0.8934136629104614, avg_entr 0.14484167098999023, f1 0.8131999969482422
ep8_l0_test_time 0.13858795166015625
Test Epoch8 layer1 Acc 0.8032, AUC 0.881834864616394, avg_entr 0.06190330162644386, f1 0.8032000660896301
ep8_l1_test_time 0.23586130142211914
Test Epoch8 layer2 Acc 0.8018, AUC 0.8820100426673889, avg_entr 0.04738236591219902, f1 0.801800012588501
ep8_l2_test_time 0.35710620880126953
Test Epoch8 layer3 Acc 0.7972, AUC 0.8810886144638062, avg_entr 0.0472627617418766, f1 0.7971999645233154
ep8_l3_test_time 0.48098039627075195
Test Epoch8 layer4 Acc 0.7976, AUC 0.8811744451522827, avg_entr 0.04763949662446976, f1 0.7976000308990479
ep8_l4_test_time 0.6067326068878174
gc 0
Train Epoch9 Acc 0.9642 (38568/40000), AUC 0.9924108386039734
ep9_train_time 17.840537071228027
Test Epoch9 layer0 Acc 0.8138, AUC 0.8904680609703064, avg_entr 0.14088016748428345, f1 0.8137999773025513
ep9_l0_test_time 0.13985943794250488
Test Epoch9 layer1 Acc 0.8056, AUC 0.8791838884353638, avg_entr 0.05383598804473877, f1 0.8055999875068665
ep9_l1_test_time 0.23488759994506836
Test Epoch9 layer2 Acc 0.804, AUC 0.8791088461875916, avg_entr 0.040173500776290894, f1 0.8040000200271606
ep9_l2_test_time 0.35428833961486816
Test Epoch9 layer3 Acc 0.803, AUC 0.8783965110778809, avg_entr 0.0424942746758461, f1 0.8029999732971191
ep9_l3_test_time 0.47576189041137695
Test Epoch9 layer4 Acc 0.8044, AUC 0.8781342506408691, avg_entr 0.043568097054958344, f1 0.8044000267982483
ep9_l4_test_time 0.5981900691986084
gc 0
Train Epoch10 Acc 0.96785 (38714/40000), AUC 0.993924617767334
ep10_train_time 17.85088086128235
Test Epoch10 layer0 Acc 0.81, AUC 0.886985182762146, avg_entr 0.137009397149086, f1 0.809999942779541
ep10_l0_test_time 0.1389608383178711
Test Epoch10 layer1 Acc 0.7996, AUC 0.8769478797912598, avg_entr 0.059800535440444946, f1 0.7996000051498413
ep10_l1_test_time 0.2354750633239746
Test Epoch10 layer2 Acc 0.7998, AUC 0.8769036531448364, avg_entr 0.04531870409846306, f1 0.7997999787330627
ep10_l2_test_time 0.3569965362548828
Test Epoch10 layer3 Acc 0.7984, AUC 0.876025915145874, avg_entr 0.04751022160053253, f1 0.7983999848365784
ep10_l3_test_time 0.47783541679382324
Test Epoch10 layer4 Acc 0.7982, AUC 0.8760861158370972, avg_entr 0.04871927946805954, f1 0.7982000708580017
ep10_l4_test_time 0.5987741947174072
gc 0
Train Epoch11 Acc 0.972025 (38881/40000), AUC 0.99537193775177
ep11_train_time 17.863080739974976
Test Epoch11 layer0 Acc 0.8104, AUC 0.885823130607605, avg_entr 0.13742595911026, f1 0.8104000091552734
ep11_l0_test_time 0.1397571563720703
Test Epoch11 layer1 Acc 0.7998, AUC 0.8762629628181458, avg_entr 0.0539403073489666, f1 0.7997999787330627
ep11_l1_test_time 0.2377157211303711
Test Epoch11 layer2 Acc 0.8, AUC 0.8754372000694275, avg_entr 0.03911065682768822, f1 0.8000000715255737
ep11_l2_test_time 0.3578300476074219
Test Epoch11 layer3 Acc 0.8006, AUC 0.8747971057891846, avg_entr 0.03797281160950661, f1 0.800599992275238
ep11_l3_test_time 0.48412418365478516
Test Epoch11 layer4 Acc 0.8008, AUC 0.8746758699417114, avg_entr 0.03867703303694725, f1 0.8007999658584595
ep11_l4_test_time 0.6050412654876709
gc 0
Train Epoch12 Acc 0.972625 (38905/40000), AUC 0.9955345988273621
ep12_train_time 17.841071605682373
Test Epoch12 layer0 Acc 0.8098, AUC 0.884247899055481, avg_entr 0.13449585437774658, f1 0.8098000288009644
ep12_l0_test_time 0.13759303092956543
Test Epoch12 layer1 Acc 0.801, AUC 0.8728609681129456, avg_entr 0.04382724314928055, f1 0.8010000586509705
ep12_l1_test_time 0.24038052558898926
Test Epoch12 layer2 Acc 0.8006, AUC 0.8722244501113892, avg_entr 0.032267432659864426, f1 0.800599992275238
ep12_l2_test_time 0.35948872566223145
Test Epoch12 layer3 Acc 0.7984, AUC 0.8716405630111694, avg_entr 0.032551359385252, f1 0.7983999848365784
ep12_l3_test_time 0.4820544719696045
Test Epoch12 layer4 Acc 0.8, AUC 0.8716151118278503, avg_entr 0.03192852810025215, f1 0.8000000715255737
ep12_l4_test_time 0.6065683364868164
gc 0
Train Epoch13 Acc 0.9735 (38940/40000), AUC 0.9957600831985474
ep13_train_time 17.851677894592285
Test Epoch13 layer0 Acc 0.81, AUC 0.8829558491706848, avg_entr 0.13233745098114014, f1 0.809999942779541
ep13_l0_test_time 0.14048218727111816
Test Epoch13 layer1 Acc 0.7998, AUC 0.8719813823699951, avg_entr 0.04302025958895683, f1 0.7997999787330627
ep13_l1_test_time 0.23694252967834473
Test Epoch13 layer2 Acc 0.7984, AUC 0.8713185787200928, avg_entr 0.030854705721139908, f1 0.7983999848365784
ep13_l2_test_time 0.35738277435302734
Test Epoch13 layer3 Acc 0.7988, AUC 0.8707072734832764, avg_entr 0.030613601207733154, f1 0.798799991607666
ep13_l3_test_time 0.48211121559143066
Test Epoch13 layer4 Acc 0.7994, AUC 0.8707675933837891, avg_entr 0.0303355660289526, f1 0.7993999123573303
ep13_l4_test_time 0.6057126522064209
gc 0
Train Epoch14 Acc 0.97445 (38978/40000), AUC 0.9960372447967529
ep14_train_time 17.865190505981445
Test Epoch14 layer0 Acc 0.807, AUC 0.8815807104110718, avg_entr 0.13019290566444397, f1 0.8069999814033508
ep14_l0_test_time 0.13767457008361816
Test Epoch14 layer1 Acc 0.7992, AUC 0.872329831123352, avg_entr 0.04680640995502472, f1 0.7991999983787537
ep14_l1_test_time 0.23466730117797852
Test Epoch14 layer2 Acc 0.7992, AUC 0.8715628981590271, avg_entr 0.034138914197683334, f1 0.7991999983787537
ep14_l2_test_time 0.3553032875061035
Test Epoch14 layer3 Acc 0.8006, AUC 0.8710048198699951, avg_entr 0.034458331763744354, f1 0.800599992275238
ep14_l3_test_time 0.4760904312133789
Test Epoch14 layer4 Acc 0.801, AUC 0.8709691762924194, avg_entr 0.03439179062843323, f1 0.8010000586509705
ep14_l4_test_time 0.5976865291595459
gc 0
Train Epoch15 Acc 0.9769 (39076/40000), AUC 0.9966423511505127
ep15_train_time 17.853368043899536
Test Epoch15 layer0 Acc 0.8082, AUC 0.8809710741043091, avg_entr 0.1290549486875534, f1 0.808199942111969
ep15_l0_test_time 0.1382601261138916
Test Epoch15 layer1 Acc 0.7966, AUC 0.8701943159103394, avg_entr 0.039832647889852524, f1 0.7965999841690063
ep15_l1_test_time 0.23430228233337402
Test Epoch15 layer2 Acc 0.7962, AUC 0.8694273233413696, avg_entr 0.028917551040649414, f1 0.7961999177932739
ep15_l2_test_time 0.35452842712402344
Test Epoch15 layer3 Acc 0.7966, AUC 0.8690439462661743, avg_entr 0.029503032565116882, f1 0.7965999841690063
ep15_l3_test_time 0.47699975967407227
Test Epoch15 layer4 Acc 0.7982, AUC 0.868887186050415, avg_entr 0.029706638306379318, f1 0.7982000708580017
ep15_l4_test_time 0.6001605987548828
gc 0
Train Epoch16 Acc 0.9771 (39084/40000), AUC 0.996738851070404
ep16_train_time 17.885600566864014
Test Epoch16 layer0 Acc 0.8076, AUC 0.8801814317703247, avg_entr 0.128175750374794, f1 0.8076000213623047
ep16_l0_test_time 0.13856148719787598
Test Epoch16 layer1 Acc 0.7982, AUC 0.8697910308837891, avg_entr 0.04011734202504158, f1 0.7982000708580017
ep16_l1_test_time 0.23623251914978027
Test Epoch16 layer2 Acc 0.7974, AUC 0.8690217733383179, avg_entr 0.028979049995541573, f1 0.7973999977111816
ep16_l2_test_time 0.3579978942871094
Test Epoch16 layer3 Acc 0.7978, AUC 0.8686916828155518, avg_entr 0.030485330149531364, f1 0.7978000044822693
ep16_l3_test_time 0.48174476623535156
Test Epoch16 layer4 Acc 0.7986, AUC 0.8684797286987305, avg_entr 0.030625494197010994, f1 0.7986000180244446
ep16_l4_test_time 0.6042976379394531
gc 0
Train Epoch17 Acc 0.977875 (39115/40000), AUC 0.9968879222869873
ep17_train_time 17.88634729385376
Test Epoch17 layer0 Acc 0.8072, AUC 0.8796356916427612, avg_entr 0.12700453400611877, f1 0.807200014591217
ep17_l0_test_time 0.13901114463806152
Test Epoch17 layer1 Acc 0.7962, AUC 0.8693385124206543, avg_entr 0.04036667197942734, f1 0.7961999177932739
ep17_l1_test_time 0.23752355575561523
Test Epoch17 layer2 Acc 0.797, AUC 0.8681087493896484, avg_entr 0.029367823153734207, f1 0.796999990940094
ep17_l2_test_time 0.35895609855651855
Test Epoch17 layer3 Acc 0.7992, AUC 0.8679696321487427, avg_entr 0.02860945649445057, f1 0.7991999983787537
ep17_l3_test_time 0.48354625701904297
Test Epoch17 layer4 Acc 0.7992, AUC 0.8677995800971985, avg_entr 0.028309686109423637, f1 0.7991999983787537
ep17_l4_test_time 0.6056499481201172
gc 0
Train Epoch18 Acc 0.978125 (39125/40000), AUC 0.9968990683555603
ep18_train_time 17.877683639526367
Test Epoch18 layer0 Acc 0.806, AUC 0.8789544701576233, avg_entr 0.1254172921180725, f1 0.8059999942779541
ep18_l0_test_time 0.13842439651489258
Test Epoch18 layer1 Acc 0.796, AUC 0.8688054084777832, avg_entr 0.03936762735247612, f1 0.796000063419342
ep18_l1_test_time 0.23702478408813477
Test Epoch18 layer2 Acc 0.7966, AUC 0.8674996495246887, avg_entr 0.028329117223620415, f1 0.7965999841690063
ep18_l2_test_time 0.35829734802246094
Test Epoch18 layer3 Acc 0.7968, AUC 0.8674347996711731, avg_entr 0.028722289949655533, f1 0.7968000173568726
ep18_l3_test_time 0.4840586185455322
Test Epoch18 layer4 Acc 0.7982, AUC 0.8671218752861023, avg_entr 0.028852568939328194, f1 0.7982000708580017
ep18_l4_test_time 0.6056463718414307
gc 0
Train Epoch19 Acc 0.978625 (39145/40000), AUC 0.9970584511756897
ep19_train_time 17.875430822372437
Test Epoch19 layer0 Acc 0.8048, AUC 0.8785332441329956, avg_entr 0.12518154084682465, f1 0.8047999739646912
ep19_l0_test_time 0.14111804962158203
Test Epoch19 layer1 Acc 0.7966, AUC 0.8683640956878662, avg_entr 0.039470795542001724, f1 0.7965999841690063
ep19_l1_test_time 0.23546457290649414
Test Epoch19 layer2 Acc 0.7964, AUC 0.8667809963226318, avg_entr 0.028895778581500053, f1 0.7964000105857849
ep19_l2_test_time 0.35490846633911133
Test Epoch19 layer3 Acc 0.7982, AUC 0.8669074773788452, avg_entr 0.028640851378440857, f1 0.7982000708580017
ep19_l3_test_time 0.47659850120544434
Test Epoch19 layer4 Acc 0.798, AUC 0.8665660619735718, avg_entr 0.028530718758702278, f1 0.7979999780654907
ep19_l4_test_time 0.6000895500183105
gc 0
Train Epoch20 Acc 0.97895 (39158/40000), AUC 0.9970674514770508
ep20_train_time 17.87379026412964
Test Epoch20 layer0 Acc 0.8048, AUC 0.8779886960983276, avg_entr 0.12413941323757172, f1 0.8047999739646912
ep20_l0_test_time 0.13923311233520508
Test Epoch20 layer1 Acc 0.797, AUC 0.8687218427658081, avg_entr 0.04211343824863434, f1 0.796999990940094
ep20_l1_test_time 0.23437905311584473
Test Epoch20 layer2 Acc 0.7954, AUC 0.867459774017334, avg_entr 0.030969372019171715, f1 0.795400083065033
ep20_l2_test_time 0.35453319549560547
Test Epoch20 layer3 Acc 0.7966, AUC 0.8673461079597473, avg_entr 0.03139321133494377, f1 0.7965999841690063
ep20_l3_test_time 0.47669219970703125
Test Epoch20 layer4 Acc 0.7984, AUC 0.8669621348381042, avg_entr 0.03129365295171738, f1 0.7983999848365784
ep20_l4_test_time 0.5998492240905762
gc 0
Train Epoch21 Acc 0.97925 (39170/40000), AUC 0.9972106218338013
ep21_train_time 17.87832236289978
Test Epoch21 layer0 Acc 0.8054, AUC 0.8777987957000732, avg_entr 0.12286780029535294, f1 0.805400013923645
ep21_l0_test_time 0.1384267807006836
Test Epoch21 layer1 Acc 0.7948, AUC 0.8681448698043823, avg_entr 0.03940431773662567, f1 0.7947999835014343
ep21_l1_test_time 0.23674750328063965
Test Epoch21 layer2 Acc 0.7948, AUC 0.8669170141220093, avg_entr 0.02837478369474411, f1 0.7947999835014343
ep21_l2_test_time 0.3599436283111572
Test Epoch21 layer3 Acc 0.7962, AUC 0.8667627573013306, avg_entr 0.02907007373869419, f1 0.7961999177932739
ep21_l3_test_time 0.4817991256713867
Test Epoch21 layer4 Acc 0.7966, AUC 0.8665235638618469, avg_entr 0.029190514236688614, f1 0.7965999841690063
ep21_l4_test_time 0.6050848960876465
gc 0
Train Epoch22 Acc 0.97965 (39186/40000), AUC 0.9971089959144592
ep22_train_time 17.896878480911255
Test Epoch22 layer0 Acc 0.8066, AUC 0.8775001764297485, avg_entr 0.12218355387449265, f1 0.8065999746322632
ep22_l0_test_time 0.13959622383117676
Test Epoch22 layer1 Acc 0.793, AUC 0.8667177557945251, avg_entr 0.03612177073955536, f1 0.7929999828338623
ep22_l1_test_time 0.23696494102478027
Test Epoch22 layer2 Acc 0.7928, AUC 0.8654561042785645, avg_entr 0.025571292266249657, f1 0.7928000092506409
ep22_l2_test_time 0.35909223556518555
Test Epoch22 layer3 Acc 0.7932, AUC 0.8651313185691833, avg_entr 0.02620471455156803, f1 0.7932000160217285
ep22_l3_test_time 0.48296022415161133
Test Epoch22 layer4 Acc 0.7936, AUC 0.8653087615966797, avg_entr 0.026232562959194183, f1 0.7936000227928162
ep22_l4_test_time 0.605243444442749
gc 0
Train Epoch23 Acc 0.9795 (39180/40000), AUC 0.9972482919692993
ep23_train_time 17.878201484680176
Test Epoch23 layer0 Acc 0.8056, AUC 0.8772366046905518, avg_entr 0.12195967882871628, f1 0.8055999875068665
ep23_l0_test_time 0.13869810104370117
Test Epoch23 layer1 Acc 0.7928, AUC 0.8663625717163086, avg_entr 0.03549071401357651, f1 0.7928000092506409
ep23_l1_test_time 0.2363581657409668
Test Epoch23 layer2 Acc 0.7936, AUC 0.8647685050964355, avg_entr 0.025306031107902527, f1 0.7936000227928162
ep23_l2_test_time 0.3574190139770508
Test Epoch23 layer3 Acc 0.7938, AUC 0.8647374510765076, avg_entr 0.025194665417075157, f1 0.7937999963760376
ep23_l3_test_time 0.4819314479827881
Test Epoch23 layer4 Acc 0.7938, AUC 0.8649412393569946, avg_entr 0.025350237265229225, f1 0.7937999963760376
ep23_l4_test_time 0.6062412261962891
gc 0
Train Epoch24 Acc 0.979875 (39195/40000), AUC 0.997302234172821
ep24_train_time 17.885699033737183
Test Epoch24 layer0 Acc 0.8044, AUC 0.8770816922187805, avg_entr 0.12172625958919525, f1 0.8044000267982483
ep24_l0_test_time 0.14096546173095703
Test Epoch24 layer1 Acc 0.795, AUC 0.8667638301849365, avg_entr 0.036649998277425766, f1 0.7950000166893005
ep24_l1_test_time 0.23554706573486328
Test Epoch24 layer2 Acc 0.7952, AUC 0.864954948425293, avg_entr 0.02661309577524662, f1 0.7952000498771667
ep24_l2_test_time 0.35580992698669434
Test Epoch24 layer3 Acc 0.7958, AUC 0.86516934633255, avg_entr 0.026022473350167274, f1 0.7958000302314758
ep24_l3_test_time 0.47576045989990234
Test Epoch24 layer4 Acc 0.7962, AUC 0.8651211261749268, avg_entr 0.02590881660580635, f1 0.7961999177932739
ep24_l4_test_time 0.5980813503265381
gc 0
Train Epoch25 Acc 0.9797 (39188/40000), AUC 0.997351884841919
ep25_train_time 17.861934661865234
Test Epoch25 layer0 Acc 0.804, AUC 0.8770228624343872, avg_entr 0.12112268060445786, f1 0.8040000200271606
ep25_l0_test_time 0.13829398155212402
Test Epoch25 layer1 Acc 0.7938, AUC 0.8660440444946289, avg_entr 0.03456271067261696, f1 0.7937999963760376
ep25_l1_test_time 0.23459196090698242
Test Epoch25 layer2 Acc 0.7936, AUC 0.863775908946991, avg_entr 0.02531040646135807, f1 0.7936000227928162
ep25_l2_test_time 0.355513334274292
Test Epoch25 layer3 Acc 0.797, AUC 0.8642456531524658, avg_entr 0.02569771185517311, f1 0.796999990940094
ep25_l3_test_time 0.47759318351745605
Test Epoch25 layer4 Acc 0.7976, AUC 0.8642250895500183, avg_entr 0.02554336190223694, f1 0.7976000308990479
ep25_l4_test_time 0.5988659858703613
gc 0
Train Epoch26 Acc 0.97995 (39198/40000), AUC 0.9973311424255371
ep26_train_time 17.860776662826538
Test Epoch26 layer0 Acc 0.8058, AUC 0.8768414855003357, avg_entr 0.1203293725848198, f1 0.8058000206947327
ep26_l0_test_time 0.13916683197021484
Test Epoch26 layer1 Acc 0.7952, AUC 0.866675853729248, avg_entr 0.036691464483737946, f1 0.7952000498771667
ep26_l1_test_time 0.2365715503692627
Test Epoch26 layer2 Acc 0.7948, AUC 0.8649270534515381, avg_entr 0.02645168825984001, f1 0.7947999835014343
ep26_l2_test_time 0.35801124572753906
Test Epoch26 layer3 Acc 0.7942, AUC 0.8650354146957397, avg_entr 0.02637883834540844, f1 0.7942000031471252
ep26_l3_test_time 0.48092055320739746
Test Epoch26 layer4 Acc 0.7956, AUC 0.8650714159011841, avg_entr 0.026555029675364494, f1 0.7955999970436096
ep26_l4_test_time 0.6055388450622559
gc 0
Train Epoch27 Acc 0.9804 (39216/40000), AUC 0.9973961114883423
ep27_train_time 17.859599590301514
Test Epoch27 layer0 Acc 0.805, AUC 0.8767762184143066, avg_entr 0.12012606114149094, f1 0.8050000667572021
ep27_l0_test_time 0.13855361938476562
Test Epoch27 layer1 Acc 0.7934, AUC 0.8663793802261353, avg_entr 0.03561711683869362, f1 0.79339998960495
ep27_l1_test_time 0.23668885231018066
Test Epoch27 layer2 Acc 0.795, AUC 0.8647072315216064, avg_entr 0.025473974645137787, f1 0.7950000166893005
ep27_l2_test_time 0.35768747329711914
Test Epoch27 layer3 Acc 0.7938, AUC 0.8646979928016663, avg_entr 0.02559596486389637, f1 0.7937999963760376
ep27_l3_test_time 0.4812192916870117
Test Epoch27 layer4 Acc 0.7944, AUC 0.8649289608001709, avg_entr 0.025765955448150635, f1 0.7943999767303467
ep27_l4_test_time 0.6058785915374756
gc 0
Train Epoch28 Acc 0.98005 (39202/40000), AUC 0.9974255561828613
ep28_train_time 17.88688635826111
Test Epoch28 layer0 Acc 0.8044, AUC 0.8766857385635376, avg_entr 0.1198384240269661, f1 0.8044000267982483
ep28_l0_test_time 0.13946270942687988
Test Epoch28 layer1 Acc 0.7932, AUC 0.8661003112792969, avg_entr 0.03506472706794739, f1 0.7932000160217285
ep28_l1_test_time 0.23624253273010254
Test Epoch28 layer2 Acc 0.7942, AUC 0.8642235994338989, avg_entr 0.025186486542224884, f1 0.7942000031471252
ep28_l2_test_time 0.3567013740539551
Test Epoch28 layer3 Acc 0.7944, AUC 0.8643463850021362, avg_entr 0.02473359741270542, f1 0.7943999767303467
ep28_l3_test_time 0.47939538955688477
Test Epoch28 layer4 Acc 0.7948, AUC 0.8646022081375122, avg_entr 0.024863610044121742, f1 0.7947999835014343
ep28_l4_test_time 0.6037297248840332
gc 0
Train Epoch29 Acc 0.98015 (39206/40000), AUC 0.9974074959754944
ep29_train_time 17.877209186553955
Test Epoch29 layer0 Acc 0.8036, AUC 0.8766427040100098, avg_entr 0.11959238350391388, f1 0.803600013256073
ep29_l0_test_time 0.1383223533630371
Test Epoch29 layer1 Acc 0.794, AUC 0.8661990165710449, avg_entr 0.03570473566651344, f1 0.7940000295639038
ep29_l1_test_time 0.23431968688964844
Test Epoch29 layer2 Acc 0.7944, AUC 0.8640680313110352, avg_entr 0.026039516553282738, f1 0.7943999767303467
ep29_l2_test_time 0.3549327850341797
Test Epoch29 layer3 Acc 0.7956, AUC 0.8644460439682007, avg_entr 0.02546968311071396, f1 0.7955999970436096
ep29_l3_test_time 0.4773733615875244
Test Epoch29 layer4 Acc 0.7962, AUC 0.8644475340843201, avg_entr 0.02529124915599823, f1 0.7961999177932739
ep29_l4_test_time 0.598381519317627
Best AUC 0.8442
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 591.8630993366241
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad100//imdb_lstmal_l5.pt
Test layer0 Acc 0.8458, AUC 0.9215965270996094, avg_entr 0.21754291653633118, f1 0.84579998254776
l0_test_time 0.14071226119995117
Test layer1 Acc 0.8354, AUC 0.9133238792419434, avg_entr 0.1178433820605278, f1 0.8353999853134155
l1_test_time 0.23487329483032227
Test layer2 Acc 0.8352, AUC 0.9133580923080444, avg_entr 0.11364124715328217, f1 0.8352000117301941
l2_test_time 0.3541426658630371
Test layer3 Acc 0.8328, AUC 0.9125291109085083, avg_entr 0.11086051166057587, f1 0.8327999711036682
l3_test_time 0.4770333766937256
Test layer4 Acc 0.8304, AUC 0.9115048050880432, avg_entr 0.10877668112516403, f1 0.8304000496864319
l4_test_time 0.5983808040618896
