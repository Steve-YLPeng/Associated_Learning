total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 20.849459171295166
Start Training
gc 0
Train Epoch0 Acc 0.498225 (19929/40000), AUC 0.5046307444572449
ep0_train_time 7.071322202682495
Test Epoch0 layer0 Acc 0.8222, AUC 0.8939436674118042, avg_entr 0.5378341674804688, f1 0.8221999406814575
ep0_l0_test_time 0.5498032569885254
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6466, AUC 0.8769161701202393, avg_entr 0.680164098739624, f1 0.6466000080108643
ep0_l1_test_time 0.5486528873443604
Test Epoch0 layer2 Acc 0.5238, AUC 0.8715754747390747, avg_entr 0.674048900604248, f1 0.5238000154495239
ep0_l2_test_time 0.5600500106811523
Test Epoch0 layer3 Acc 0.5004, AUC 0.7719132900238037, avg_entr 0.6805146932601929, f1 0.5004000067710876
ep0_l3_test_time 0.551934003829956
Test Epoch0 layer4 Acc 0.5052, AUC 0.8654378652572632, avg_entr 0.6832537651062012, f1 0.5052000284194946
ep0_l4_test_time 0.5604677200317383
gc 0
Train Epoch1 Acc 0.829525 (33181/40000), AUC 0.9095590114593506
ep1_train_time 6.6649696826934814
Test Epoch1 layer0 Acc 0.8792, AUC 0.9465025067329407, avg_entr 0.28289321064949036, f1 0.8791999816894531
ep1_l0_test_time 0.5470108985900879
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8788, AUC 0.9471231698989868, avg_entr 0.3350922465324402, f1 0.8787999749183655
ep1_l1_test_time 0.5494914054870605
Test Epoch1 layer2 Acc 0.8756, AUC 0.9475225806236267, avg_entr 0.22713345289230347, f1 0.8756000399589539
ep1_l2_test_time 0.5501124858856201
Test Epoch1 layer3 Acc 0.8724, AUC 0.9475531578063965, avg_entr 0.22582586109638214, f1 0.8723999857902527
ep1_l3_test_time 0.5531051158905029
Test Epoch1 layer4 Acc 0.8732, AUC 0.9475879669189453, avg_entr 0.2095947265625, f1 0.873199999332428
ep1_l4_test_time 0.5501222610473633
gc 0
Train Epoch2 Acc 0.90825 (36330/40000), AUC 0.9665851593017578
ep2_train_time 6.4913718700408936
Test Epoch2 layer0 Acc 0.8954, AUC 0.9557735919952393, avg_entr 0.2239041030406952, f1 0.8953999876976013
ep2_l0_test_time 0.5476126670837402
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8948, AUC 0.9562392234802246, avg_entr 0.20816265046596527, f1 0.8948000073432922
ep2_l1_test_time 0.6012206077575684
Test Epoch2 layer2 Acc 0.8958, AUC 0.9565009474754333, avg_entr 0.18128930032253265, f1 0.895799994468689
ep2_l2_test_time 0.5516881942749023
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8956, AUC 0.9566178321838379, avg_entr 0.17184336483478546, f1 0.8956000208854675
ep2_l3_test_time 0.5519015789031982
Test Epoch2 layer4 Acc 0.8954, AUC 0.9565664529800415, avg_entr 0.14597395062446594, f1 0.8953999876976013
ep2_l4_test_time 0.5669848918914795
gc 0
Train Epoch3 Acc 0.925 (37000/40000), AUC 0.976586103439331
ep3_train_time 6.524044036865234
Test Epoch3 layer0 Acc 0.8856, AUC 0.9584135413169861, avg_entr 0.19170889258384705, f1 0.8855999708175659
ep3_l0_test_time 0.5518093109130859
Test Epoch3 layer1 Acc 0.89, AUC 0.9587302803993225, avg_entr 0.16715581715106964, f1 0.8899999856948853
ep3_l1_test_time 0.549915075302124
Test Epoch3 layer2 Acc 0.8882, AUC 0.9589680433273315, avg_entr 0.15512284636497498, f1 0.888200044631958
ep3_l2_test_time 0.55246901512146
Test Epoch3 layer3 Acc 0.8864, AUC 0.9591149091720581, avg_entr 0.13965679705142975, f1 0.8863999843597412
ep3_l3_test_time 0.5494191646575928
Test Epoch3 layer4 Acc 0.8898, AUC 0.9591376781463623, avg_entr 0.11169913411140442, f1 0.8898000121116638
ep3_l4_test_time 0.5502557754516602
gc 0
Train Epoch4 Acc 0.935275 (37411/40000), AUC 0.9821343421936035
ep4_train_time 6.693575620651245
Test Epoch4 layer0 Acc 0.898, AUC 0.9585381150245667, avg_entr 0.1756703406572342, f1 0.8980000019073486
ep4_l0_test_time 0.55191969871521
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8996, AUC 0.9591416120529175, avg_entr 0.14826521277427673, f1 0.8996000289916992
ep4_l1_test_time 0.553743839263916
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8996, AUC 0.959647536277771, avg_entr 0.13880203664302826, f1 0.8996000289916992
ep4_l2_test_time 0.5515778064727783
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer3 Acc 0.8994, AUC 0.9600526690483093, avg_entr 0.11479414254426956, f1 0.8993999361991882
ep4_l3_test_time 0.5564696788787842
Test Epoch4 layer4 Acc 0.8994, AUC 0.9603016972541809, avg_entr 0.08218879252672195, f1 0.8993999361991882
ep4_l4_test_time 0.5506150722503662
gc 0
Train Epoch5 Acc 0.943475 (37739/40000), AUC 0.9856281280517578
ep5_train_time 6.537430763244629
Test Epoch5 layer0 Acc 0.8972, AUC 0.9577161073684692, avg_entr 0.16425377130508423, f1 0.8971999883651733
ep5_l0_test_time 0.5558736324310303
Test Epoch5 layer1 Acc 0.8982, AUC 0.958449125289917, avg_entr 0.13613207638263702, f1 0.8981999754905701
ep5_l1_test_time 0.5507683753967285
Test Epoch5 layer2 Acc 0.899, AUC 0.9586806297302246, avg_entr 0.12645237147808075, f1 0.8989999890327454
ep5_l2_test_time 0.5550045967102051
Test Epoch5 layer3 Acc 0.8992, AUC 0.9592889547348022, avg_entr 0.09379064291715622, f1 0.8992000222206116
ep5_l3_test_time 0.5683603286743164
Test Epoch5 layer4 Acc 0.8994, AUC 0.9594297409057617, avg_entr 0.06044292077422142, f1 0.8993999361991882
ep5_l4_test_time 0.5548608303070068
gc 0
Train Epoch6 Acc 0.948975 (37959/40000), AUC 0.987903356552124
ep6_train_time 6.57362961769104
Test Epoch6 layer0 Acc 0.8976, AUC 0.9572792053222656, avg_entr 0.15267597138881683, f1 0.897599995136261
ep6_l0_test_time 0.5488238334655762
Test Epoch6 layer1 Acc 0.8968, AUC 0.9580236673355103, avg_entr 0.12413482367992401, f1 0.8967999815940857
ep6_l1_test_time 0.5465967655181885
Test Epoch6 layer2 Acc 0.8992, AUC 0.9589260816574097, avg_entr 0.11079194396734238, f1 0.8992000222206116
ep6_l2_test_time 0.5588638782501221
Test Epoch6 layer3 Acc 0.8988, AUC 0.9596501588821411, avg_entr 0.07373588532209396, f1 0.8988000154495239
ep6_l3_test_time 0.5532081127166748
Test Epoch6 layer4 Acc 0.8992, AUC 0.9584715366363525, avg_entr 0.04611997678875923, f1 0.8992000222206116
ep6_l4_test_time 0.5544979572296143
gc 0
Train Epoch7 Acc 0.954525 (38181/40000), AUC 0.990060567855835
ep7_train_time 6.565077066421509
Test Epoch7 layer0 Acc 0.8924, AUC 0.9555835723876953, avg_entr 0.14635275304317474, f1 0.8923999667167664
ep7_l0_test_time 0.5561871528625488
Test Epoch7 layer1 Acc 0.8928, AUC 0.9565659165382385, avg_entr 0.1186680942773819, f1 0.892799973487854
ep7_l1_test_time 0.554764986038208
Test Epoch7 layer2 Acc 0.8942, AUC 0.9577216506004333, avg_entr 0.10505466163158417, f1 0.8942000269889832
ep7_l2_test_time 0.558814287185669
Test Epoch7 layer3 Acc 0.8952, AUC 0.9580687284469604, avg_entr 0.06407831609249115, f1 0.8952000141143799
ep7_l3_test_time 0.5670773983001709
Test Epoch7 layer4 Acc 0.8948, AUC 0.9563571214675903, avg_entr 0.04158296436071396, f1 0.8948000073432922
ep7_l4_test_time 0.5542404651641846
gc 0
Train Epoch8 Acc 0.959825 (38393/40000), AUC 0.9917011260986328
ep8_train_time 6.609527349472046
Test Epoch8 layer0 Acc 0.8908, AUC 0.9535417556762695, avg_entr 0.1382426917552948, f1 0.8907999992370605
ep8_l0_test_time 0.5571167469024658
Test Epoch8 layer1 Acc 0.893, AUC 0.9546124935150146, avg_entr 0.11150044202804565, f1 0.8930000066757202
ep8_l1_test_time 0.5490388870239258
Test Epoch8 layer2 Acc 0.8926, AUC 0.9556688070297241, avg_entr 0.09622875601053238, f1 0.8925999999046326
ep8_l2_test_time 0.548231840133667
Test Epoch8 layer3 Acc 0.8928, AUC 0.9547744989395142, avg_entr 0.05340338870882988, f1 0.892799973487854
ep8_l3_test_time 0.548619270324707
Test Epoch8 layer4 Acc 0.8926, AUC 0.9536296129226685, avg_entr 0.035101696848869324, f1 0.8925999999046326
ep8_l4_test_time 0.5487933158874512
gc 0
Train Epoch9 Acc 0.963775 (38551/40000), AUC 0.9929709434509277
ep9_train_time 6.52468729019165
Test Epoch9 layer0 Acc 0.8922, AUC 0.952583909034729, avg_entr 0.13447341322898865, f1 0.8921999931335449
ep9_l0_test_time 0.5543639659881592
Test Epoch9 layer1 Acc 0.8904, AUC 0.953722357749939, avg_entr 0.10822577029466629, f1 0.8903999924659729
ep9_l1_test_time 0.5453827381134033
Test Epoch9 layer2 Acc 0.8902, AUC 0.9548147916793823, avg_entr 0.0924488753080368, f1 0.8902000188827515
ep9_l2_test_time 0.5507011413574219
Test Epoch9 layer3 Acc 0.8902, AUC 0.9533581137657166, avg_entr 0.04861793667078018, f1 0.8902000188827515
ep9_l3_test_time 0.5510265827178955
Test Epoch9 layer4 Acc 0.8902, AUC 0.9532362222671509, avg_entr 0.03180504962801933, f1 0.8902000188827515
ep9_l4_test_time 0.5491604804992676
gc 0
Train Epoch10 Acc 0.965725 (38629/40000), AUC 0.9937564730644226
ep10_train_time 6.538365125656128
Test Epoch10 layer0 Acc 0.8884, AUC 0.9516928791999817, avg_entr 0.13152314722537994, f1 0.8884000182151794
ep10_l0_test_time 0.5518472194671631
Test Epoch10 layer1 Acc 0.8882, AUC 0.9528306722640991, avg_entr 0.10559610277414322, f1 0.888200044631958
ep10_l1_test_time 0.5455758571624756
Test Epoch10 layer2 Acc 0.887, AUC 0.9537894129753113, avg_entr 0.08872833102941513, f1 0.8870000243186951
ep10_l2_test_time 0.5470795631408691
Test Epoch10 layer3 Acc 0.887, AUC 0.9511663913726807, avg_entr 0.04674923047423363, f1 0.8870000243186951
ep10_l3_test_time 0.5512800216674805
Test Epoch10 layer4 Acc 0.8872, AUC 0.9520336389541626, avg_entr 0.030939392745494843, f1 0.8871999979019165
ep10_l4_test_time 0.5513195991516113
gc 0
Train Epoch11 Acc 0.966725 (38669/40000), AUC 0.9941447973251343
ep11_train_time 6.49832010269165
Test Epoch11 layer0 Acc 0.8872, AUC 0.9505269527435303, avg_entr 0.12831418216228485, f1 0.8871999979019165
ep11_l0_test_time 0.5553724765777588
Test Epoch11 layer1 Acc 0.8888, AUC 0.9517631530761719, avg_entr 0.10263296961784363, f1 0.8888000249862671
ep11_l1_test_time 0.5569791793823242
Test Epoch11 layer2 Acc 0.8878, AUC 0.9527048468589783, avg_entr 0.08505497127771378, f1 0.8877999782562256
ep11_l2_test_time 0.5627508163452148
Test Epoch11 layer3 Acc 0.8882, AUC 0.9502112865447998, avg_entr 0.04306795075535774, f1 0.888200044631958
ep11_l3_test_time 0.5497884750366211
Test Epoch11 layer4 Acc 0.8878, AUC 0.9515553712844849, avg_entr 0.0289628729224205, f1 0.8877999782562256
ep11_l4_test_time 0.5517420768737793
gc 0
Train Epoch12 Acc 0.968325 (38733/40000), AUC 0.9945787191390991
ep12_train_time 6.574563026428223
Test Epoch12 layer0 Acc 0.8876, AUC 0.94910728931427, avg_entr 0.1256490796804428, f1 0.8876000046730042
ep12_l0_test_time 0.549238920211792
Test Epoch12 layer1 Acc 0.8886, AUC 0.9504168033599854, avg_entr 0.10063084214925766, f1 0.8885999917984009
ep12_l1_test_time 0.5445692539215088
Test Epoch12 layer2 Acc 0.8864, AUC 0.9512204527854919, avg_entr 0.08241534978151321, f1 0.8863999843597412
ep12_l2_test_time 0.5487649440765381
Test Epoch12 layer3 Acc 0.8882, AUC 0.9481386542320251, avg_entr 0.040931057184934616, f1 0.888200044631958
ep12_l3_test_time 0.5525171756744385
Test Epoch12 layer4 Acc 0.8872, AUC 0.9504900574684143, avg_entr 0.02721484750509262, f1 0.8871999979019165
ep12_l4_test_time 0.5574655532836914
gc 0
Train Epoch13 Acc 0.970325 (38813/40000), AUC 0.9950828552246094
ep13_train_time 6.575429677963257
Test Epoch13 layer0 Acc 0.8864, AUC 0.9487429261207581, avg_entr 0.12374499440193176, f1 0.8863999843597412
ep13_l0_test_time 0.5487728118896484
Test Epoch13 layer1 Acc 0.8878, AUC 0.9499974846839905, avg_entr 0.09853748232126236, f1 0.8877999782562256
ep13_l1_test_time 0.5506598949432373
Test Epoch13 layer2 Acc 0.8864, AUC 0.950883150100708, avg_entr 0.07971537113189697, f1 0.8863999843597412
ep13_l2_test_time 0.5509617328643799
Test Epoch13 layer3 Acc 0.8864, AUC 0.9471135139465332, avg_entr 0.03973326459527016, f1 0.8863999843597412
ep13_l3_test_time 0.559962272644043
Test Epoch13 layer4 Acc 0.887, AUC 0.949448823928833, avg_entr 0.026174373924732208, f1 0.8870000243186951
ep13_l4_test_time 0.5512850284576416
gc 0
Train Epoch14 Acc 0.971075 (38843/40000), AUC 0.9953340291976929
ep14_train_time 6.570761442184448
Test Epoch14 layer0 Acc 0.8832, AUC 0.9481124877929688, avg_entr 0.12373615801334381, f1 0.8831999897956848
ep14_l0_test_time 0.5496735572814941
Test Epoch14 layer1 Acc 0.8832, AUC 0.9494023323059082, avg_entr 0.09889350831508636, f1 0.8831999897956848
ep14_l1_test_time 0.5479633808135986
Test Epoch14 layer2 Acc 0.8832, AUC 0.9503223896026611, avg_entr 0.08013641834259033, f1 0.8831999897956848
ep14_l2_test_time 0.5530908107757568
Test Epoch14 layer3 Acc 0.8838, AUC 0.9468556642532349, avg_entr 0.03888360410928726, f1 0.8838000297546387
ep14_l3_test_time 0.5493319034576416
Test Epoch14 layer4 Acc 0.8838, AUC 0.949375331401825, avg_entr 0.025725333020091057, f1 0.8838000297546387
ep14_l4_test_time 0.5505690574645996
gc 0
Train Epoch15 Acc 0.9718 (38872/40000), AUC 0.9953373670578003
ep15_train_time 6.446499586105347
Test Epoch15 layer0 Acc 0.8838, AUC 0.9475021958351135, avg_entr 0.12160612642765045, f1 0.8838000297546387
ep15_l0_test_time 0.5475387573242188
Test Epoch15 layer1 Acc 0.8838, AUC 0.9488391876220703, avg_entr 0.09713613986968994, f1 0.8838000297546387
ep15_l1_test_time 0.5510706901550293
Test Epoch15 layer2 Acc 0.8826, AUC 0.949703574180603, avg_entr 0.07751954346895218, f1 0.8826000094413757
ep15_l2_test_time 0.552375316619873
Test Epoch15 layer3 Acc 0.8824, AUC 0.9460002183914185, avg_entr 0.037727028131484985, f1 0.8823999762535095
ep15_l3_test_time 0.5520045757293701
Test Epoch15 layer4 Acc 0.8832, AUC 0.9477488994598389, avg_entr 0.025245944038033485, f1 0.8831999897956848
ep15_l4_test_time 0.5703895092010498
gc 0
Train Epoch16 Acc 0.97215 (38886/40000), AUC 0.9956696033477783
ep16_train_time 6.563773155212402
Test Epoch16 layer0 Acc 0.8828, AUC 0.9468991160392761, avg_entr 0.1203589215874672, f1 0.8827999830245972
ep16_l0_test_time 0.5534226894378662
Test Epoch16 layer1 Acc 0.8822, AUC 0.9482498168945312, avg_entr 0.09589940309524536, f1 0.8822000026702881
ep16_l1_test_time 0.5483675003051758
Test Epoch16 layer2 Acc 0.8814, AUC 0.9491426944732666, avg_entr 0.07652805745601654, f1 0.8813999891281128
ep16_l2_test_time 0.550518274307251
Test Epoch16 layer3 Acc 0.8814, AUC 0.9455137252807617, avg_entr 0.036604590713977814, f1 0.8813999891281128
ep16_l3_test_time 0.5505998134613037
Test Epoch16 layer4 Acc 0.882, AUC 0.9484388828277588, avg_entr 0.02433113195002079, f1 0.8820000290870667
ep16_l4_test_time 0.549401044845581
gc 0
Train Epoch17 Acc 0.9731 (38924/40000), AUC 0.9959224462509155
ep17_train_time 6.5085227489471436
Test Epoch17 layer0 Acc 0.8822, AUC 0.9464700222015381, avg_entr 0.11925797164440155, f1 0.8822000026702881
ep17_l0_test_time 0.5460739135742188
Test Epoch17 layer1 Acc 0.8826, AUC 0.9479377269744873, avg_entr 0.09489256888628006, f1 0.8826000094413757
ep17_l1_test_time 0.5458085536956787
Test Epoch17 layer2 Acc 0.881, AUC 0.9487451314926147, avg_entr 0.07509690523147583, f1 0.8809999823570251
ep17_l2_test_time 0.5455937385559082
Test Epoch17 layer3 Acc 0.882, AUC 0.9450790882110596, avg_entr 0.03586278483271599, f1 0.8820000290870667
ep17_l3_test_time 0.5491721630096436
Test Epoch17 layer4 Acc 0.8816, AUC 0.9475389719009399, avg_entr 0.023731239140033722, f1 0.881600022315979
ep17_l4_test_time 0.5494489669799805
gc 0
Train Epoch18 Acc 0.9733 (38932/40000), AUC 0.9960219860076904
ep18_train_time 6.490838050842285
Test Epoch18 layer0 Acc 0.8828, AUC 0.9462381601333618, avg_entr 0.11776215583086014, f1 0.8827999830245972
ep18_l0_test_time 0.5657594203948975
Test Epoch18 layer1 Acc 0.8836, AUC 0.947654128074646, avg_entr 0.09354100376367569, f1 0.8835999965667725
ep18_l1_test_time 0.5457267761230469
Test Epoch18 layer2 Acc 0.8836, AUC 0.9484769701957703, avg_entr 0.07332580536603928, f1 0.8835999965667725
ep18_l2_test_time 0.5504715442657471
Test Epoch18 layer3 Acc 0.8836, AUC 0.9445902705192566, avg_entr 0.034765537828207016, f1 0.8835999965667725
ep18_l3_test_time 0.5560157299041748
Test Epoch18 layer4 Acc 0.8832, AUC 0.9471616744995117, avg_entr 0.02323765493929386, f1 0.8831999897956848
ep18_l4_test_time 0.5490808486938477
gc 0
Train Epoch19 Acc 0.973825 (38953/40000), AUC 0.9960933923721313
ep19_train_time 6.633974313735962
Test Epoch19 layer0 Acc 0.8786, AUC 0.9459902048110962, avg_entr 0.1196499764919281, f1 0.878600001335144
ep19_l0_test_time 0.5499794483184814
Test Epoch19 layer1 Acc 0.8804, AUC 0.947409987449646, avg_entr 0.09510301798582077, f1 0.8804000020027161
ep19_l1_test_time 0.5598208904266357
Test Epoch19 layer2 Acc 0.8806, AUC 0.9482636451721191, avg_entr 0.07515732198953629, f1 0.8805999755859375
ep19_l2_test_time 0.5567770004272461
Test Epoch19 layer3 Acc 0.8802, AUC 0.9439182281494141, avg_entr 0.03556595742702484, f1 0.8802000284194946
ep19_l3_test_time 0.5558629035949707
Test Epoch19 layer4 Acc 0.8804, AUC 0.9470468759536743, avg_entr 0.023416107520461082, f1 0.8804000020027161
ep19_l4_test_time 0.5668559074401855
gc 0
Train Epoch20 Acc 0.9739 (38956/40000), AUC 0.9961721897125244
ep20_train_time 6.572285890579224
Test Epoch20 layer0 Acc 0.8806, AUC 0.9456936120986938, avg_entr 0.11704235523939133, f1 0.8805999755859375
ep20_l0_test_time 0.5527336597442627
Test Epoch20 layer1 Acc 0.881, AUC 0.9471582770347595, avg_entr 0.09271074086427689, f1 0.8809999823570251
ep20_l1_test_time 0.5463545322418213
Test Epoch20 layer2 Acc 0.8802, AUC 0.9479451179504395, avg_entr 0.0726623609662056, f1 0.8802000284194946
ep20_l2_test_time 0.5546941757202148
Test Epoch20 layer3 Acc 0.8804, AUC 0.9438341856002808, avg_entr 0.034215010702610016, f1 0.8804000020027161
ep20_l3_test_time 0.5482635498046875
Test Epoch20 layer4 Acc 0.88, AUC 0.9469524621963501, avg_entr 0.02280927076935768, f1 0.8799999952316284
ep20_l4_test_time 0.560521125793457
gc 0
Train Epoch21 Acc 0.974375 (38975/40000), AUC 0.9963277578353882
ep21_train_time 6.744483709335327
Test Epoch21 layer0 Acc 0.88, AUC 0.9455859661102295, avg_entr 0.11661246418952942, f1 0.8799999952316284
ep21_l0_test_time 0.5610096454620361
Test Epoch21 layer1 Acc 0.8806, AUC 0.9470036029815674, avg_entr 0.09233830869197845, f1 0.8805999755859375
ep21_l1_test_time 0.5584471225738525
Test Epoch21 layer2 Acc 0.88, AUC 0.947836697101593, avg_entr 0.07218945026397705, f1 0.8799999952316284
ep21_l2_test_time 0.5615921020507812
Test Epoch21 layer3 Acc 0.8792, AUC 0.943821907043457, avg_entr 0.03378806635737419, f1 0.8791999816894531
ep21_l3_test_time 0.5615260601043701
Test Epoch21 layer4 Acc 0.8802, AUC 0.9460387229919434, avg_entr 0.022668279707431793, f1 0.8802000284194946
ep21_l4_test_time 0.5643839836120605
gc 0
Train Epoch22 Acc 0.974475 (38979/40000), AUC 0.9963104724884033
ep22_train_time 7.101526498794556
Test Epoch22 layer0 Acc 0.881, AUC 0.9454231262207031, avg_entr 0.11568240821361542, f1 0.8809999823570251
ep22_l0_test_time 0.5665433406829834
Test Epoch22 layer1 Acc 0.8808, AUC 0.9468529224395752, avg_entr 0.09158793836832047, f1 0.8808000087738037
ep22_l1_test_time 0.5693235397338867
Test Epoch22 layer2 Acc 0.8796, AUC 0.9476704001426697, avg_entr 0.0713275671005249, f1 0.8795999884605408
ep22_l2_test_time 0.577284574508667
Test Epoch22 layer3 Acc 0.8806, AUC 0.9433863759040833, avg_entr 0.033416491001844406, f1 0.8805999755859375
ep22_l3_test_time 0.5859856605529785
Test Epoch22 layer4 Acc 0.8808, AUC 0.9455916881561279, avg_entr 0.02244090661406517, f1 0.8808000087738037
ep22_l4_test_time 0.5664389133453369
gc 0
Train Epoch23 Acc 0.97455 (38982/40000), AUC 0.9962624311447144
ep23_train_time 6.855283498764038
Test Epoch23 layer0 Acc 0.8792, AUC 0.9452865719795227, avg_entr 0.11538444459438324, f1 0.8791999816894531
ep23_l0_test_time 0.6545214653015137
Test Epoch23 layer1 Acc 0.8806, AUC 0.9467310309410095, avg_entr 0.09138689935207367, f1 0.8805999755859375
ep23_l1_test_time 0.7734799385070801
Test Epoch23 layer2 Acc 0.8798, AUC 0.9475432634353638, avg_entr 0.07138022780418396, f1 0.879800021648407
ep23_l2_test_time 0.7605710029602051
Test Epoch23 layer3 Acc 0.8796, AUC 0.9431126117706299, avg_entr 0.033331383019685745, f1 0.8795999884605408
ep23_l3_test_time 0.7551336288452148
Test Epoch23 layer4 Acc 0.8796, AUC 0.9455313682556152, avg_entr 0.0224759578704834, f1 0.8795999884605408
ep23_l4_test_time 0.7771313190460205
gc 0
Train Epoch24 Acc 0.97435 (38974/40000), AUC 0.9964859485626221
ep24_train_time 11.160962104797363
Test Epoch24 layer0 Acc 0.8806, AUC 0.9450585842132568, avg_entr 0.11379674077033997, f1 0.8805999755859375
ep24_l0_test_time 0.7699689865112305
Test Epoch24 layer1 Acc 0.8808, AUC 0.946546196937561, avg_entr 0.08980049192905426, f1 0.8808000087738037
ep24_l1_test_time 0.7943971157073975
Test Epoch24 layer2 Acc 0.8816, AUC 0.9472967386245728, avg_entr 0.06947975605726242, f1 0.881600022315979
ep24_l2_test_time 0.7754156589508057
Test Epoch24 layer3 Acc 0.881, AUC 0.9429473876953125, avg_entr 0.03222908452153206, f1 0.8809999823570251
ep24_l3_test_time 0.7827246189117432
Test Epoch24 layer4 Acc 0.8812, AUC 0.9453366994857788, avg_entr 0.021869663149118423, f1 0.8812000155448914
ep24_l4_test_time 0.7830095291137695
gc 0
Train Epoch25 Acc 0.9747 (38988/40000), AUC 0.9964638948440552
ep25_train_time 11.163691759109497
Test Epoch25 layer0 Acc 0.8794, AUC 0.9450700283050537, avg_entr 0.11460830271244049, f1 0.8794000148773193
ep25_l0_test_time 0.7843203544616699
Test Epoch25 layer1 Acc 0.8806, AUC 0.9465346336364746, avg_entr 0.09060140699148178, f1 0.8805999755859375
ep25_l1_test_time 0.774724006652832
Test Epoch25 layer2 Acc 0.8784, AUC 0.9473328590393066, avg_entr 0.0704268291592598, f1 0.8784000277519226
ep25_l2_test_time 0.7869985103607178
Test Epoch25 layer3 Acc 0.8784, AUC 0.9431321620941162, avg_entr 0.032769497483968735, f1 0.8784000277519226
ep25_l3_test_time 0.7791855335235596
Test Epoch25 layer4 Acc 0.8784, AUC 0.9456527829170227, avg_entr 0.02215435355901718, f1 0.8784000277519226
ep25_l4_test_time 0.7781064510345459
gc 0
Train Epoch26 Acc 0.97485 (38994/40000), AUC 0.9965354204177856
ep26_train_time 11.235514640808105
Test Epoch26 layer0 Acc 0.8792, AUC 0.9450080394744873, avg_entr 0.11407430469989777, f1 0.8791999816894531
ep26_l0_test_time 0.7601611614227295
Test Epoch26 layer1 Acc 0.8802, AUC 0.9464744329452515, avg_entr 0.09013339877128601, f1 0.8802000284194946
ep26_l1_test_time 0.7693190574645996
Test Epoch26 layer2 Acc 0.8784, AUC 0.9472634792327881, avg_entr 0.0699172243475914, f1 0.8784000277519226
ep26_l2_test_time 0.7698688507080078
Test Epoch26 layer3 Acc 0.8788, AUC 0.9430103302001953, avg_entr 0.03253239765763283, f1 0.8787999749183655
ep26_l3_test_time 0.7701756954193115
Test Epoch26 layer4 Acc 0.8788, AUC 0.9456861019134521, avg_entr 0.021947285160422325, f1 0.8787999749183655
ep26_l4_test_time 0.7692434787750244
gc 0
Train Epoch27 Acc 0.975 (39000/40000), AUC 0.9964848160743713
ep27_train_time 10.968600511550903
Test Epoch27 layer0 Acc 0.8802, AUC 0.9448937773704529, avg_entr 0.11306791752576828, f1 0.8802000284194946
ep27_l0_test_time 0.7768983840942383
Test Epoch27 layer1 Acc 0.8798, AUC 0.946407675743103, avg_entr 0.08933418989181519, f1 0.879800021648407
ep27_l1_test_time 0.7838213443756104
Test Epoch27 layer2 Acc 0.8794, AUC 0.9471583366394043, avg_entr 0.06922823190689087, f1 0.8794000148773193
ep27_l2_test_time 0.7695608139038086
Test Epoch27 layer3 Acc 0.8796, AUC 0.9427176713943481, avg_entr 0.03228777274489403, f1 0.8795999884605408
ep27_l3_test_time 0.7910840511322021
Test Epoch27 layer4 Acc 0.8794, AUC 0.9448692798614502, avg_entr 0.021850649267435074, f1 0.8794000148773193
ep27_l4_test_time 0.7682838439941406
gc 0
Train Epoch28 Acc 0.974975 (38999/40000), AUC 0.996584415435791
ep28_train_time 11.157296180725098
Test Epoch28 layer0 Acc 0.8804, AUC 0.9448215961456299, avg_entr 0.11239627748727798, f1 0.8804000020027161
ep28_l0_test_time 0.7613613605499268
Test Epoch28 layer1 Acc 0.88, AUC 0.9463256597518921, avg_entr 0.0886078029870987, f1 0.8799999952316284
ep28_l1_test_time 0.7778885364532471
Test Epoch28 layer2 Acc 0.8798, AUC 0.9470471143722534, avg_entr 0.06836500018835068, f1 0.879800021648407
ep28_l2_test_time 0.7784745693206787
Test Epoch28 layer3 Acc 0.8786, AUC 0.9427788853645325, avg_entr 0.031700633466243744, f1 0.878600001335144
ep28_l3_test_time 0.765373706817627
Test Epoch28 layer4 Acc 0.8794, AUC 0.945508599281311, avg_entr 0.021565746515989304, f1 0.8794000148773193
ep28_l4_test_time 0.769625186920166
gc 0
Train Epoch29 Acc 0.974925 (38997/40000), AUC 0.9965628385543823
ep29_train_time 11.202542304992676
Test Epoch29 layer0 Acc 0.8802, AUC 0.9448172450065613, avg_entr 0.1121695414185524, f1 0.8802000284194946
ep29_l0_test_time 0.7681910991668701
Test Epoch29 layer1 Acc 0.8796, AUC 0.9463104009628296, avg_entr 0.08840299397706985, f1 0.8795999884605408
ep29_l1_test_time 0.7663085460662842
Test Epoch29 layer2 Acc 0.8802, AUC 0.9470562934875488, avg_entr 0.0681455135345459, f1 0.8802000284194946
ep29_l2_test_time 0.7734699249267578
Test Epoch29 layer3 Acc 0.8794, AUC 0.9428195953369141, avg_entr 0.031599875539541245, f1 0.8794000148773193
ep29_l3_test_time 0.7791898250579834
Test Epoch29 layer4 Acc 0.8798, AUC 0.9457080960273743, avg_entr 0.021454384550452232, f1 0.879800021648407
ep29_l4_test_time 0.7749176025390625
Best AUC 0.8996
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 318.1953363418579
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.894, AUC 0.9554107189178467, avg_entr 0.1760450005531311, f1 0.8939999938011169
l0_test_time 0.7712781429290771
Test layer1 Acc 0.897, AUC 0.9559422135353088, avg_entr 0.15005278587341309, f1 0.8970000147819519
l1_test_time 0.7738902568817139
Test layer2 Acc 0.8952, AUC 0.956396222114563, avg_entr 0.1411401331424713, f1 0.8952000141143799
l2_test_time 0.7763304710388184
Test layer3 Acc 0.8964, AUC 0.9569447040557861, avg_entr 0.11784306913614273, f1 0.896399974822998
l3_test_time 0.7717781066894531
Test layer4 Acc 0.8968, AUC 0.957115650177002, avg_entr 0.0855146199464798, f1 0.8967999815940857
l4_test_time 0.7890164852142334
