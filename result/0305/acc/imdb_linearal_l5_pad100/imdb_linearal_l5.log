total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 20.39913320541382
Start Training
gc 0
Train Epoch0 Acc 0.51925 (20770/40000), AUC 0.5356426239013672
ep0_train_time 3.1212432384490967
Test Epoch0 layer0 Acc 0.808, AUC 0.891287088394165, avg_entr 0.4069287180900574, f1 0.8080000281333923
ep0_l0_test_time 0.13896799087524414
Save ckpt to ckpt/imdb_linearal_l5_pad100//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7992, AUC 0.880609393119812, avg_entr 0.6314811706542969, f1 0.7991999983787537
ep0_l1_test_time 0.1380906105041504
Test Epoch0 layer2 Acc 0.7888, AUC 0.8733279705047607, avg_entr 0.6584503054618835, f1 0.7888000011444092
ep0_l2_test_time 0.13759326934814453
Test Epoch0 layer3 Acc 0.7774, AUC 0.8771320581436157, avg_entr 0.6572887301445007, f1 0.777400016784668
ep0_l3_test_time 0.13890647888183594
Test Epoch0 layer4 Acc 0.767, AUC 0.859660267829895, avg_entr 0.6852178573608398, f1 0.7670000195503235
ep0_l4_test_time 0.14025068283081055
gc 0
Train Epoch1 Acc 0.84965 (33986/40000), AUC 0.9188582301139832
ep1_train_time 2.7104439735412598
Test Epoch1 layer0 Acc 0.8408, AUC 0.918871283531189, avg_entr 0.25980454683303833, f1 0.8408000469207764
ep1_l0_test_time 0.13843750953674316
Save ckpt to ckpt/imdb_linearal_l5_pad100//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8412, AUC 0.9184569120407104, avg_entr 0.2646452784538269, f1 0.8411999344825745
ep1_l1_test_time 0.13928937911987305
Save ckpt to ckpt/imdb_linearal_l5_pad100//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8402, AUC 0.9184552431106567, avg_entr 0.23747605085372925, f1 0.8402000069618225
ep1_l2_test_time 0.14123272895812988
Test Epoch1 layer3 Acc 0.8394, AUC 0.918456494808197, avg_entr 0.23262009024620056, f1 0.8393999934196472
ep1_l3_test_time 0.1392664909362793
Test Epoch1 layer4 Acc 0.839, AUC 0.9182060956954956, avg_entr 0.23024462163448334, f1 0.8389999866485596
ep1_l4_test_time 0.14055490493774414
gc 0
Train Epoch2 Acc 0.893875 (35755/40000), AUC 0.9594860076904297
ep2_train_time 2.701681137084961
Test Epoch2 layer0 Acc 0.8464, AUC 0.9202686548233032, avg_entr 0.2145071029663086, f1 0.8464000225067139
ep2_l0_test_time 0.13705801963806152
Save ckpt to ckpt/imdb_linearal_l5_pad100//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8452, AUC 0.9199433326721191, avg_entr 0.2084772288799286, f1 0.8452000021934509
ep2_l1_test_time 0.13818359375
Test Epoch2 layer2 Acc 0.8434, AUC 0.9198319911956787, avg_entr 0.19599714875221252, f1 0.8434000015258789
ep2_l2_test_time 0.13795161247253418
Test Epoch2 layer3 Acc 0.845, AUC 0.9199168682098389, avg_entr 0.1870746612548828, f1 0.8449999690055847
ep2_l3_test_time 0.13890743255615234
Test Epoch2 layer4 Acc 0.8448, AUC 0.9196784496307373, avg_entr 0.18303853273391724, f1 0.8447999358177185
ep2_l4_test_time 0.1411912441253662
gc 0
Train Epoch3 Acc 0.91605 (36642/40000), AUC 0.9727238416671753
ep3_train_time 2.744767189025879
Test Epoch3 layer0 Acc 0.8348, AUC 0.917039692401886, avg_entr 0.19130830466747284, f1 0.8348000049591064
ep3_l0_test_time 0.13782477378845215
Test Epoch3 layer1 Acc 0.835, AUC 0.9169158935546875, avg_entr 0.1843872368335724, f1 0.8349999785423279
ep3_l1_test_time 0.13575315475463867
Test Epoch3 layer2 Acc 0.8342, AUC 0.916498064994812, avg_entr 0.17303168773651123, f1 0.8341999650001526
ep3_l2_test_time 0.1377549171447754
Test Epoch3 layer3 Acc 0.8348, AUC 0.9164391160011292, avg_entr 0.15977489948272705, f1 0.8348000049591064
ep3_l3_test_time 0.13906216621398926
Test Epoch3 layer4 Acc 0.8346, AUC 0.916269063949585, avg_entr 0.15295015275478363, f1 0.8345999717712402
ep3_l4_test_time 0.13994193077087402
gc 0
Train Epoch4 Acc 0.930875 (37235/40000), AUC 0.9810276031494141
ep4_train_time 2.699863910675049
Test Epoch4 layer0 Acc 0.8336, AUC 0.9113590717315674, avg_entr 0.17614004015922546, f1 0.8335999846458435
ep4_l0_test_time 0.13759851455688477
Test Epoch4 layer1 Acc 0.8338, AUC 0.9114108085632324, avg_entr 0.16732893884181976, f1 0.8338000774383545
ep4_l1_test_time 0.13567638397216797
Test Epoch4 layer2 Acc 0.834, AUC 0.9109172224998474, avg_entr 0.15390445291996002, f1 0.8339999914169312
ep4_l2_test_time 0.1383676528930664
Test Epoch4 layer3 Acc 0.8314, AUC 0.910834789276123, avg_entr 0.1376436948776245, f1 0.8313999772071838
ep4_l3_test_time 0.13886594772338867
Test Epoch4 layer4 Acc 0.8322, AUC 0.910722017288208, avg_entr 0.12676136195659637, f1 0.8321999311447144
ep4_l4_test_time 0.14006710052490234
gc 0
Train Epoch5 Acc 0.942625 (37705/40000), AUC 0.9855442047119141
ep5_train_time 2.6719062328338623
Test Epoch5 layer0 Acc 0.828, AUC 0.9064507484436035, avg_entr 0.16553397476673126, f1 0.828000009059906
ep5_l0_test_time 0.1378626823425293
Test Epoch5 layer1 Acc 0.8262, AUC 0.9064345359802246, avg_entr 0.15628273785114288, f1 0.826200008392334
ep5_l1_test_time 0.13580989837646484
Test Epoch5 layer2 Acc 0.8252, AUC 0.9057689309120178, avg_entr 0.1431548148393631, f1 0.8252000212669373
ep5_l2_test_time 0.1374819278717041
Test Epoch5 layer3 Acc 0.8254, AUC 0.9056812524795532, avg_entr 0.12226126343011856, f1 0.8253999948501587
ep5_l3_test_time 0.14017224311828613
Test Epoch5 layer4 Acc 0.8254, AUC 0.9056658744812012, avg_entr 0.10025902837514877, f1 0.8253999948501587
ep5_l4_test_time 0.14044666290283203
gc 0
Train Epoch6 Acc 0.949525 (37981/40000), AUC 0.9889323711395264
ep6_train_time 2.7029621601104736
Test Epoch6 layer0 Acc 0.8228, AUC 0.9002678990364075, avg_entr 0.15540024638175964, f1 0.8227999806404114
ep6_l0_test_time 0.13689494132995605
Test Epoch6 layer1 Acc 0.8208, AUC 0.90019690990448, avg_entr 0.146299347281456, f1 0.8208000063896179
ep6_l1_test_time 0.1354970932006836
Test Epoch6 layer2 Acc 0.8228, AUC 0.8994796276092529, avg_entr 0.13333238661289215, f1 0.8227999806404114
ep6_l2_test_time 0.13706469535827637
Test Epoch6 layer3 Acc 0.8226, AUC 0.899503767490387, avg_entr 0.10382816195487976, f1 0.8226000070571899
ep6_l3_test_time 0.1386737823486328
Test Epoch6 layer4 Acc 0.8226, AUC 0.8976225256919861, avg_entr 0.07146276533603668, f1 0.8226000070571899
ep6_l4_test_time 0.13967394828796387
gc 0
Train Epoch7 Acc 0.96015 (38406/40000), AUC 0.9923539161682129
ep7_train_time 2.6842126846313477
Test Epoch7 layer0 Acc 0.8186, AUC 0.8971452713012695, avg_entr 0.15134792029857635, f1 0.8185999989509583
ep7_l0_test_time 0.13749098777770996
Test Epoch7 layer1 Acc 0.8196, AUC 0.897049605846405, avg_entr 0.1418377012014389, f1 0.8195999264717102
ep7_l1_test_time 0.13547110557556152
Test Epoch7 layer2 Acc 0.8168, AUC 0.8963184356689453, avg_entr 0.1273854672908783, f1 0.8167999982833862
ep7_l2_test_time 0.13728046417236328
Test Epoch7 layer3 Acc 0.8184, AUC 0.8963971138000488, avg_entr 0.09379106014966965, f1 0.8184000253677368
ep7_l3_test_time 0.13898706436157227
Test Epoch7 layer4 Acc 0.8176, AUC 0.889129638671875, avg_entr 0.06235073134303093, f1 0.8176000118255615
ep7_l4_test_time 0.14009332656860352
gc 0
Train Epoch8 Acc 0.962975 (38519/40000), AUC 0.992896556854248
ep8_train_time 2.674504518508911
Test Epoch8 layer0 Acc 0.819, AUC 0.8945609331130981, avg_entr 0.14488491415977478, f1 0.8190000057220459
ep8_l0_test_time 0.1372065544128418
Test Epoch8 layer1 Acc 0.818, AUC 0.89436936378479, avg_entr 0.13530924916267395, f1 0.8180000185966492
ep8_l1_test_time 0.1355738639831543
Test Epoch8 layer2 Acc 0.8186, AUC 0.8935712575912476, avg_entr 0.11997081339359283, f1 0.8185999989509583
ep8_l2_test_time 0.13885068893432617
Test Epoch8 layer3 Acc 0.817, AUC 0.8936059474945068, avg_entr 0.08203565329313278, f1 0.8169999718666077
ep8_l3_test_time 0.1393141746520996
Test Epoch8 layer4 Acc 0.8174, AUC 0.8815394043922424, avg_entr 0.05289355292916298, f1 0.8173999786376953
ep8_l4_test_time 0.13949966430664062
gc 0
Train Epoch9 Acc 0.965375 (38615/40000), AUC 0.9933529496192932
ep9_train_time 2.6821346282958984
Test Epoch9 layer0 Acc 0.8166, AUC 0.890990674495697, avg_entr 0.142479807138443, f1 0.8166000247001648
ep9_l0_test_time 0.13727188110351562
Test Epoch9 layer1 Acc 0.816, AUC 0.8907741904258728, avg_entr 0.13310453295707703, f1 0.8160000443458557
ep9_l1_test_time 0.13510990142822266
Test Epoch9 layer2 Acc 0.8132, AUC 0.8900454640388489, avg_entr 0.11858723312616348, f1 0.8131999969482422
ep9_l2_test_time 0.13693737983703613
Test Epoch9 layer3 Acc 0.8136, AUC 0.8895666003227234, avg_entr 0.07666739076375961, f1 0.8136000037193298
ep9_l3_test_time 0.13947582244873047
Test Epoch9 layer4 Acc 0.8132, AUC 0.8761229515075684, avg_entr 0.04942629858851433, f1 0.8131999969482422
ep9_l4_test_time 0.13954782485961914
gc 0
Train Epoch10 Acc 0.96805 (38722/40000), AUC 0.9940168261528015
ep10_train_time 2.6748523712158203
Test Epoch10 layer0 Acc 0.8114, AUC 0.8874210119247437, avg_entr 0.13852107524871826, f1 0.8113999962806702
ep10_l0_test_time 0.1378481388092041
Test Epoch10 layer1 Acc 0.8104, AUC 0.8871368765830994, avg_entr 0.12959785759449005, f1 0.8104000091552734
ep10_l1_test_time 0.1359093189239502
Test Epoch10 layer2 Acc 0.81, AUC 0.8864301443099976, avg_entr 0.1143341213464737, f1 0.809999942779541
ep10_l2_test_time 0.1389906406402588
Test Epoch10 layer3 Acc 0.8098, AUC 0.8845633268356323, avg_entr 0.0692928358912468, f1 0.8098000288009644
ep10_l3_test_time 0.1387333869934082
Test Epoch10 layer4 Acc 0.8108, AUC 0.8715208172798157, avg_entr 0.04623837396502495, f1 0.8108000159263611
ep10_l4_test_time 0.1388695240020752
gc 0
Train Epoch11 Acc 0.971125 (38845/40000), AUC 0.9950479865074158
ep11_train_time 2.684431314468384
Test Epoch11 layer0 Acc 0.8108, AUC 0.8862278461456299, avg_entr 0.1369798630475998, f1 0.8108000159263611
ep11_l0_test_time 0.137068510055542
Test Epoch11 layer1 Acc 0.811, AUC 0.8858617544174194, avg_entr 0.12757201492786407, f1 0.8109999895095825
ep11_l1_test_time 0.13517308235168457
Test Epoch11 layer2 Acc 0.8088, AUC 0.8851180672645569, avg_entr 0.1114031970500946, f1 0.8087999820709229
ep11_l2_test_time 0.13911867141723633
Test Epoch11 layer3 Acc 0.809, AUC 0.8821802139282227, avg_entr 0.06567826867103577, f1 0.8090000748634338
ep11_l3_test_time 0.13879895210266113
Test Epoch11 layer4 Acc 0.809, AUC 0.8685199618339539, avg_entr 0.044986724853515625, f1 0.8090000748634338
ep11_l4_test_time 0.14332008361816406
gc 0
Train Epoch12 Acc 0.9727 (38908/40000), AUC 0.9954657554626465
ep12_train_time 2.6658871173858643
Test Epoch12 layer0 Acc 0.8092, AUC 0.8847852945327759, avg_entr 0.1341373473405838, f1 0.8092000484466553
ep12_l0_test_time 0.13688993453979492
Test Epoch12 layer1 Acc 0.8086, AUC 0.8844202756881714, avg_entr 0.1250375658273697, f1 0.8086000084877014
ep12_l1_test_time 0.13541316986083984
Test Epoch12 layer2 Acc 0.8072, AUC 0.8836559057235718, avg_entr 0.10824144631624222, f1 0.807200014591217
ep12_l2_test_time 0.1372053623199463
Test Epoch12 layer3 Acc 0.8086, AUC 0.8788166046142578, avg_entr 0.06257615983486176, f1 0.8086000084877014
ep12_l3_test_time 0.139418363571167
Test Epoch12 layer4 Acc 0.8068, AUC 0.8660318851470947, avg_entr 0.04387945681810379, f1 0.8068000078201294
ep12_l4_test_time 0.1447288990020752
gc 0
Train Epoch13 Acc 0.97335 (38934/40000), AUC 0.9956709146499634
ep13_train_time 2.6841375827789307
Test Epoch13 layer0 Acc 0.8096, AUC 0.8834503293037415, avg_entr 0.1324688047170639, f1 0.8095999956130981
ep13_l0_test_time 0.13750076293945312
Test Epoch13 layer1 Acc 0.8072, AUC 0.8829448223114014, avg_entr 0.12319689989089966, f1 0.807200014591217
ep13_l1_test_time 0.13484835624694824
Test Epoch13 layer2 Acc 0.8074, AUC 0.8822003602981567, avg_entr 0.1059417575597763, f1 0.8073999881744385
ep13_l2_test_time 0.1372056007385254
Test Epoch13 layer3 Acc 0.8046, AUC 0.8756746053695679, avg_entr 0.06018450856208801, f1 0.8046000599861145
ep13_l3_test_time 0.1382918357849121
Test Epoch13 layer4 Acc 0.8064, AUC 0.8649049997329712, avg_entr 0.04215371608734131, f1 0.8064000010490417
ep13_l4_test_time 0.13953781127929688
gc 0
Train Epoch14 Acc 0.97385 (38954/40000), AUC 0.9959317445755005
ep14_train_time 2.689077377319336
Test Epoch14 layer0 Acc 0.8084, AUC 0.8819693326950073, avg_entr 0.1310756504535675, f1 0.8083999752998352
ep14_l0_test_time 0.13688349723815918
Test Epoch14 layer1 Acc 0.8066, AUC 0.8814101219177246, avg_entr 0.12187802791595459, f1 0.8065999746322632
ep14_l1_test_time 0.13664650917053223
Test Epoch14 layer2 Acc 0.8056, AUC 0.8806028366088867, avg_entr 0.10472381860017776, f1 0.8055999875068665
ep14_l2_test_time 0.13739752769470215
Test Epoch14 layer3 Acc 0.8056, AUC 0.8728647232055664, avg_entr 0.058166343718767166, f1 0.8055999875068665
ep14_l3_test_time 0.13875961303710938
Test Epoch14 layer4 Acc 0.8058, AUC 0.8643984198570251, avg_entr 0.040695130825042725, f1 0.8058000206947327
ep14_l4_test_time 0.13985776901245117
gc 0
Train Epoch15 Acc 0.975475 (39019/40000), AUC 0.9963344931602478
ep15_train_time 2.6855249404907227
Test Epoch15 layer0 Acc 0.8068, AUC 0.8812873363494873, avg_entr 0.12941096723079681, f1 0.8068000078201294
ep15_l0_test_time 0.13641715049743652
Test Epoch15 layer1 Acc 0.8056, AUC 0.8807401061058044, avg_entr 0.12025921791791916, f1 0.8055999875068665
ep15_l1_test_time 0.13593220710754395
Test Epoch15 layer2 Acc 0.8042, AUC 0.8799204230308533, avg_entr 0.1027347519993782, f1 0.8041999936103821
ep15_l2_test_time 0.13861918449401855
Test Epoch15 layer3 Acc 0.8042, AUC 0.8716262578964233, avg_entr 0.05623592063784599, f1 0.8041999936103821
ep15_l3_test_time 0.1390073299407959
Test Epoch15 layer4 Acc 0.8048, AUC 0.863794207572937, avg_entr 0.03974086046218872, f1 0.8047999739646912
ep15_l4_test_time 0.1395885944366455
gc 0
Train Epoch16 Acc 0.9762 (39048/40000), AUC 0.9964070320129395
ep16_train_time 2.690833568572998
Test Epoch16 layer0 Acc 0.806, AUC 0.8805820345878601, avg_entr 0.12856756150722504, f1 0.8059999942779541
ep16_l0_test_time 0.1371476650238037
Test Epoch16 layer1 Acc 0.8046, AUC 0.8800288438796997, avg_entr 0.11927828192710876, f1 0.8046000599861145
ep16_l1_test_time 0.13592767715454102
Test Epoch16 layer2 Acc 0.8046, AUC 0.8791742920875549, avg_entr 0.10103099793195724, f1 0.8046000599861145
ep16_l2_test_time 0.13774824142456055
Test Epoch16 layer3 Acc 0.8042, AUC 0.8697875142097473, avg_entr 0.05520222336053848, f1 0.8041999936103821
ep16_l3_test_time 0.13881158828735352
Test Epoch16 layer4 Acc 0.8032, AUC 0.8623715043067932, avg_entr 0.03892580047249794, f1 0.8032000660896301
ep16_l4_test_time 0.13975811004638672
gc 0
Train Epoch17 Acc 0.976175 (39047/40000), AUC 0.9964818358421326
ep17_train_time 2.6833724975585938
Test Epoch17 layer0 Acc 0.8076, AUC 0.8800510168075562, avg_entr 0.127119243144989, f1 0.8076000213623047
ep17_l0_test_time 0.13938379287719727
Test Epoch17 layer1 Acc 0.805, AUC 0.8794608116149902, avg_entr 0.11795113235712051, f1 0.8050000667572021
ep17_l1_test_time 0.13676857948303223
Test Epoch17 layer2 Acc 0.8022, AUC 0.8786293268203735, avg_entr 0.09964222460985184, f1 0.8022000193595886
ep17_l2_test_time 0.13838720321655273
Test Epoch17 layer3 Acc 0.8028, AUC 0.8686336278915405, avg_entr 0.05371328815817833, f1 0.8027999997138977
ep17_l3_test_time 0.13927483558654785
Test Epoch17 layer4 Acc 0.8038, AUC 0.8624654412269592, avg_entr 0.03781114146113396, f1 0.8037999868392944
ep17_l4_test_time 0.14093470573425293
gc 0
Train Epoch18 Acc 0.97645 (39058/40000), AUC 0.9965355396270752
ep18_train_time 2.686957597732544
Test Epoch18 layer0 Acc 0.8034, AUC 0.8790938258171082, avg_entr 0.1256750524044037, f1 0.8033999800682068
ep18_l0_test_time 0.1385176181793213
Test Epoch18 layer1 Acc 0.802, AUC 0.8784991502761841, avg_entr 0.11658603698015213, f1 0.8019999861717224
ep18_l1_test_time 0.1356661319732666
Test Epoch18 layer2 Acc 0.8012, AUC 0.8776336312294006, avg_entr 0.09843844920396805, f1 0.8011999726295471
ep18_l2_test_time 0.13719749450683594
Test Epoch18 layer3 Acc 0.8024, AUC 0.8667787313461304, avg_entr 0.05257642641663551, f1 0.8023999929428101
ep18_l3_test_time 0.13860654830932617
Test Epoch18 layer4 Acc 0.802, AUC 0.8613450527191162, avg_entr 0.03701134771108627, f1 0.8019999861717224
ep18_l4_test_time 0.13981866836547852
gc 0
Train Epoch19 Acc 0.97745 (39098/40000), AUC 0.9967907667160034
ep19_train_time 2.67667818069458
Test Epoch19 layer0 Acc 0.8024, AUC 0.8788105249404907, avg_entr 0.12545543909072876, f1 0.8023999929428101
ep19_l0_test_time 0.13996124267578125
Test Epoch19 layer1 Acc 0.8028, AUC 0.8782141804695129, avg_entr 0.11629758030176163, f1 0.8027999997138977
ep19_l1_test_time 0.1359856128692627
Test Epoch19 layer2 Acc 0.802, AUC 0.8773399591445923, avg_entr 0.09740393608808517, f1 0.8019999861717224
ep19_l2_test_time 0.13810324668884277
Test Epoch19 layer3 Acc 0.8004, AUC 0.8663915395736694, avg_entr 0.05148844048380852, f1 0.8004000186920166
ep19_l3_test_time 0.13915228843688965
Test Epoch19 layer4 Acc 0.8016, AUC 0.8613714575767517, avg_entr 0.035907015204429626, f1 0.8015999794006348
ep19_l4_test_time 0.1403036117553711
gc 0
Train Epoch20 Acc 0.977625 (39105/40000), AUC 0.9968314170837402
ep20_train_time 2.6947598457336426
Test Epoch20 layer0 Acc 0.803, AUC 0.8783917427062988, avg_entr 0.12398645281791687, f1 0.8029999732971191
ep20_l0_test_time 0.1382584571838379
Test Epoch20 layer1 Acc 0.8002, AUC 0.8777596354484558, avg_entr 0.11486928910017014, f1 0.8001999855041504
ep20_l1_test_time 0.1363379955291748
Test Epoch20 layer2 Acc 0.7998, AUC 0.8768949508666992, avg_entr 0.09619960188865662, f1 0.7997999787330627
ep20_l2_test_time 0.1378164291381836
Test Epoch20 layer3 Acc 0.801, AUC 0.8648972511291504, avg_entr 0.05154768005013466, f1 0.8010000586509705
ep20_l3_test_time 0.1388108730316162
Test Epoch20 layer4 Acc 0.8014, AUC 0.859966516494751, avg_entr 0.03639541566371918, f1 0.8014000058174133
ep20_l4_test_time 0.1403207778930664
gc 0
Train Epoch21 Acc 0.977775 (39111/40000), AUC 0.9968262910842896
ep21_train_time 2.7024004459381104
Test Epoch21 layer0 Acc 0.8014, AUC 0.8781473636627197, avg_entr 0.1236613392829895, f1 0.8014000058174133
ep21_l0_test_time 0.13718628883361816
Test Epoch21 layer1 Acc 0.8022, AUC 0.8774970173835754, avg_entr 0.11451885104179382, f1 0.8022000193595886
ep21_l1_test_time 0.13589692115783691
Test Epoch21 layer2 Acc 0.8006, AUC 0.8766270875930786, avg_entr 0.09558775275945663, f1 0.800599992275238
ep21_l2_test_time 0.13781213760375977
Test Epoch21 layer3 Acc 0.7996, AUC 0.8648440837860107, avg_entr 0.050327740609645844, f1 0.7996000051498413
ep21_l3_test_time 0.13854098320007324
Test Epoch21 layer4 Acc 0.8002, AUC 0.8602641820907593, avg_entr 0.03510082885622978, f1 0.8001999855041504
ep21_l4_test_time 0.14157438278198242
gc 0
Train Epoch22 Acc 0.977575 (39103/40000), AUC 0.9968844652175903
ep22_train_time 2.668692111968994
Test Epoch22 layer0 Acc 0.803, AUC 0.8778670430183411, avg_entr 0.12267360836267471, f1 0.8029999732971191
ep22_l0_test_time 0.1385328769683838
Test Epoch22 layer1 Acc 0.8008, AUC 0.877170205116272, avg_entr 0.11353179067373276, f1 0.8007999658584595
ep22_l1_test_time 0.13594746589660645
Test Epoch22 layer2 Acc 0.8004, AUC 0.8763248920440674, avg_entr 0.0948692187666893, f1 0.8004000186920166
ep22_l2_test_time 0.13823699951171875
Test Epoch22 layer3 Acc 0.8002, AUC 0.864106297492981, avg_entr 0.04998714476823807, f1 0.8001999855041504
ep22_l3_test_time 0.13925552368164062
Test Epoch22 layer4 Acc 0.8008, AUC 0.8599613904953003, avg_entr 0.03499917313456535, f1 0.8007999658584595
ep22_l4_test_time 0.13947296142578125
gc 0
Train Epoch23 Acc 0.9783 (39132/40000), AUC 0.9969486594200134
ep23_train_time 2.6927781105041504
Test Epoch23 layer0 Acc 0.8016, AUC 0.877632737159729, avg_entr 0.1219886839389801, f1 0.8015999794006348
ep23_l0_test_time 0.13702988624572754
Test Epoch23 layer1 Acc 0.7992, AUC 0.8769235610961914, avg_entr 0.1129188984632492, f1 0.7991999983787537
ep23_l1_test_time 0.1358795166015625
Test Epoch23 layer2 Acc 0.7998, AUC 0.8760626912117004, avg_entr 0.09429514408111572, f1 0.7997999787330627
ep23_l2_test_time 0.13824725151062012
Test Epoch23 layer3 Acc 0.7996, AUC 0.8631952404975891, avg_entr 0.04991576075553894, f1 0.7996000051498413
ep23_l3_test_time 0.13894939422607422
Test Epoch23 layer4 Acc 0.8, AUC 0.8589142560958862, avg_entr 0.03505050018429756, f1 0.8000000715255737
ep23_l4_test_time 0.1405961513519287
gc 0
Train Epoch24 Acc 0.97835 (39134/40000), AUC 0.9969618320465088
ep24_train_time 2.687739133834839
Test Epoch24 layer0 Acc 0.801, AUC 0.877482533454895, avg_entr 0.12200245261192322, f1 0.8010000586509705
ep24_l0_test_time 0.13743162155151367
Test Epoch24 layer1 Acc 0.8004, AUC 0.876792311668396, avg_entr 0.11282775551080704, f1 0.8004000186920166
ep24_l1_test_time 0.13586139678955078
Test Epoch24 layer2 Acc 0.7998, AUC 0.8759289979934692, avg_entr 0.09371314197778702, f1 0.7997999787330627
ep24_l2_test_time 0.1381540298461914
Test Epoch24 layer3 Acc 0.7992, AUC 0.8634808659553528, avg_entr 0.04871392995119095, f1 0.7991999983787537
ep24_l3_test_time 0.13965225219726562
Test Epoch24 layer4 Acc 0.7998, AUC 0.8594210147857666, avg_entr 0.0338105745613575, f1 0.7997999787330627
ep24_l4_test_time 0.14101243019104004
gc 0
Train Epoch25 Acc 0.978525 (39141/40000), AUC 0.997001588344574
ep25_train_time 2.719515562057495
Test Epoch25 layer0 Acc 0.801, AUC 0.877303957939148, avg_entr 0.12139512598514557, f1 0.8010000586509705
ep25_l0_test_time 0.13807106018066406
Test Epoch25 layer1 Acc 0.7994, AUC 0.8766193389892578, avg_entr 0.11224741488695145, f1 0.7993999123573303
ep25_l1_test_time 0.1356801986694336
Test Epoch25 layer2 Acc 0.8006, AUC 0.8757253289222717, avg_entr 0.09324651956558228, f1 0.800599992275238
ep25_l2_test_time 0.13733386993408203
Test Epoch25 layer3 Acc 0.799, AUC 0.8631564378738403, avg_entr 0.048466552048921585, f1 0.7990000247955322
ep25_l3_test_time 0.13908600807189941
Test Epoch25 layer4 Acc 0.7996, AUC 0.859929621219635, avg_entr 0.03355153650045395, f1 0.7996000051498413
ep25_l4_test_time 0.1396651268005371
gc 0
Train Epoch26 Acc 0.97835 (39134/40000), AUC 0.9970049262046814
ep26_train_time 2.7130444049835205
Test Epoch26 layer0 Acc 0.8006, AUC 0.8770976066589355, avg_entr 0.1207285150885582, f1 0.800599992275238
ep26_l0_test_time 0.14365720748901367
Test Epoch26 layer1 Acc 0.7992, AUC 0.8764074444770813, avg_entr 0.11155836284160614, f1 0.7991999983787537
ep26_l1_test_time 0.14018988609313965
Test Epoch26 layer2 Acc 0.799, AUC 0.8755448460578918, avg_entr 0.09244627505540848, f1 0.7990000247955322
ep26_l2_test_time 0.13841986656188965
Test Epoch26 layer3 Acc 0.7986, AUC 0.862634539604187, avg_entr 0.04808742552995682, f1 0.7986000180244446
ep26_l3_test_time 0.13907814025878906
Test Epoch26 layer4 Acc 0.7994, AUC 0.8591350317001343, avg_entr 0.03331534564495087, f1 0.7993999123573303
ep26_l4_test_time 0.13976454734802246
gc 0
Train Epoch27 Acc 0.9789 (39156/40000), AUC 0.9970382452011108
ep27_train_time 2.6649746894836426
Test Epoch27 layer0 Acc 0.801, AUC 0.8770385980606079, avg_entr 0.1203933134675026, f1 0.8010000586509705
ep27_l0_test_time 0.13814163208007812
Test Epoch27 layer1 Acc 0.799, AUC 0.8763467073440552, avg_entr 0.11123540997505188, f1 0.7990000247955322
ep27_l1_test_time 0.13605427742004395
Test Epoch27 layer2 Acc 0.799, AUC 0.875474214553833, avg_entr 0.09214728325605392, f1 0.7990000247955322
ep27_l2_test_time 0.13944363594055176
Test Epoch27 layer3 Acc 0.7984, AUC 0.8626164197921753, avg_entr 0.04784315079450607, f1 0.7983999848365784
ep27_l3_test_time 0.13880062103271484
Test Epoch27 layer4 Acc 0.7996, AUC 0.8590956330299377, avg_entr 0.0331435389816761, f1 0.7996000051498413
ep27_l4_test_time 0.13999700546264648
gc 0
Train Epoch28 Acc 0.97885 (39154/40000), AUC 0.9970672130584717
ep28_train_time 2.714709758758545
Test Epoch28 layer0 Acc 0.8008, AUC 0.8770086765289307, avg_entr 0.11999064683914185, f1 0.8007999658584595
ep28_l0_test_time 0.13829636573791504
Test Epoch28 layer1 Acc 0.7988, AUC 0.8762924075126648, avg_entr 0.11084611713886261, f1 0.798799991607666
ep28_l1_test_time 0.13623881340026855
Test Epoch28 layer2 Acc 0.7996, AUC 0.8754346966743469, avg_entr 0.09178570657968521, f1 0.7996000051498413
ep28_l2_test_time 0.13835644721984863
Test Epoch28 layer3 Acc 0.7982, AUC 0.8624264001846313, avg_entr 0.04766109585762024, f1 0.7982000708580017
ep28_l3_test_time 0.13928484916687012
Test Epoch28 layer4 Acc 0.7996, AUC 0.8590313196182251, avg_entr 0.03298517316579819, f1 0.7996000051498413
ep28_l4_test_time 0.14016485214233398
gc 0
Train Epoch29 Acc 0.978825 (39153/40000), AUC 0.9970860481262207
ep29_train_time 2.6715731620788574
Test Epoch29 layer0 Acc 0.8014, AUC 0.8770076632499695, avg_entr 0.11970361322164536, f1 0.8014000058174133
ep29_l0_test_time 0.14011478424072266
Test Epoch29 layer1 Acc 0.7982, AUC 0.876276969909668, avg_entr 0.11053439974784851, f1 0.7982000708580017
ep29_l1_test_time 0.13724017143249512
Test Epoch29 layer2 Acc 0.7998, AUC 0.8754113912582397, avg_entr 0.0913800448179245, f1 0.7997999787330627
ep29_l2_test_time 0.13811707496643066
Test Epoch29 layer3 Acc 0.7982, AUC 0.8626071214675903, avg_entr 0.04717523232102394, f1 0.7982000708580017
ep29_l3_test_time 0.13925385475158691
Test Epoch29 layer4 Acc 0.7996, AUC 0.8593082427978516, avg_entr 0.032633498311042786, f1 0.7996000051498413
ep29_l4_test_time 0.13973522186279297
Best AUC 0.8464
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 103.37317991256714
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad100//imdb_linearal_l5.pt
Test layer0 Acc 0.8404, AUC 0.9208611249923706, avg_entr 0.21518449485301971, f1 0.840399980545044
l0_test_time 0.13540911674499512
Test layer1 Acc 0.8398, AUC 0.920613706111908, avg_entr 0.20807228982448578, f1 0.8398000001907349
l1_test_time 0.13562679290771484
Test layer2 Acc 0.8392, AUC 0.9208167791366577, avg_entr 0.19507065415382385, f1 0.8392000198364258
l2_test_time 0.13764262199401855
Test layer3 Acc 0.8376, AUC 0.9207659959793091, avg_entr 0.18612903356552124, f1 0.8375999927520752
l3_test_time 0.13873791694641113
Test layer4 Acc 0.8382, AUC 0.9205336570739746, avg_entr 0.18207503855228424, f1 0.8381999731063843
l4_test_time 0.1394510269165039
