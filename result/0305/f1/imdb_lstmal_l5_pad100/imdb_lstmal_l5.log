total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 23.007145166397095
Start Training
gc 0
Train Epoch0 Acc 0.51625 (20650/40000), AUC 0.5190877318382263
ep0_train_time 35.729461669921875
Test Epoch0 layer0 Acc 0.8108, AUC 0.8953984379768372, avg_entr 0.3944243788719177, f1 0.8108000159263611
ep0_l0_test_time 0.3266737461090088
Save ckpt to ckpt/imdb_lstmal_l5_pad100//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.623, AUC 0.6769746541976929, avg_entr 0.6573963165283203, f1 0.6230000257492065
ep0_l1_test_time 0.4931509494781494
Test Epoch0 layer2 Acc 0.5928, AUC 0.6850413680076599, avg_entr 0.6770678758621216, f1 0.5928000211715698
ep0_l2_test_time 0.7145729064941406
Test Epoch0 layer3 Acc 0.6072, AUC 0.6977850794792175, avg_entr 0.6881218552589417, f1 0.607200026512146
ep0_l3_test_time 1.0101959705352783
Test Epoch0 layer4 Acc 0.5152, AUC 0.671722412109375, avg_entr 0.6715568900108337, f1 0.5152000188827515
ep0_l4_test_time 1.187964916229248
gc 0
Train Epoch1 Acc 0.802675 (32107/40000), AUC 0.8767327070236206
ep1_train_time 35.92306637763977
Test Epoch1 layer0 Acc 0.8394, AUC 0.9188449382781982, avg_entr 0.25830093026161194, f1 0.8393999934196472
ep1_l0_test_time 0.3093137741088867
Save ckpt to ckpt/imdb_lstmal_l5_pad100//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8298, AUC 0.8992937803268433, avg_entr 0.15532968938350677, f1 0.829800009727478
ep1_l1_test_time 0.5018701553344727
Test Epoch1 layer2 Acc 0.8264, AUC 0.9012442827224731, avg_entr 0.13503840565681458, f1 0.8263999819755554
ep1_l2_test_time 0.7154664993286133
Test Epoch1 layer3 Acc 0.8274, AUC 0.9021080732345581, avg_entr 0.1249985322356224, f1 0.8274000287055969
ep1_l3_test_time 1.015993356704712
Test Epoch1 layer4 Acc 0.8274, AUC 0.9020718336105347, avg_entr 0.1318921446800232, f1 0.8274000287055969
ep1_l4_test_time 1.182558298110962
gc 0
Train Epoch2 Acc 0.88775 (35510/40000), AUC 0.948749303817749
ep2_train_time 35.925111055374146
Test Epoch2 layer0 Acc 0.8402, AUC 0.9197816848754883, avg_entr 0.2153577357530594, f1 0.8402000069618225
ep2_l0_test_time 0.3266787528991699
Save ckpt to ckpt/imdb_lstmal_l5_pad100//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8336, AUC 0.9078108072280884, avg_entr 0.1314486861228943, f1 0.8335999846458435
ep2_l1_test_time 0.5093939304351807
Test Epoch2 layer2 Acc 0.8334, AUC 0.9085733890533447, avg_entr 0.12062796950340271, f1 0.8334000110626221
ep2_l2_test_time 0.7112681865692139
Test Epoch2 layer3 Acc 0.8318, AUC 0.9083055853843689, avg_entr 0.11108220368623734, f1 0.8317999839782715
ep2_l3_test_time 1.0031797885894775
Test Epoch2 layer4 Acc 0.8314, AUC 0.9081239104270935, avg_entr 0.11172082275152206, f1 0.8313999772071838
ep2_l4_test_time 1.2064826488494873
gc 0
Train Epoch3 Acc 0.91235 (36494/40000), AUC 0.9664881229400635
ep3_train_time 35.61945414543152
Test Epoch3 layer0 Acc 0.8394, AUC 0.9162837862968445, avg_entr 0.18926313519477844, f1 0.8393999934196472
ep3_l0_test_time 0.3202967643737793
Test Epoch3 layer1 Acc 0.8282, AUC 0.9045016169548035, avg_entr 0.09952713549137115, f1 0.8281999826431274
ep3_l1_test_time 0.5072054862976074
Test Epoch3 layer2 Acc 0.8264, AUC 0.9043545722961426, avg_entr 0.09459377080202103, f1 0.8263999819755554
ep3_l2_test_time 0.7158012390136719
Test Epoch3 layer3 Acc 0.8236, AUC 0.9039641618728638, avg_entr 0.09031051397323608, f1 0.8235999941825867
ep3_l3_test_time 0.9954347610473633
Test Epoch3 layer4 Acc 0.8262, AUC 0.9037026762962341, avg_entr 0.08720126003026962, f1 0.826200008392334
ep3_l4_test_time 1.203613042831421
gc 0
Train Epoch4 Acc 0.928475 (37139/40000), AUC 0.9758992195129395
ep4_train_time 35.889148235321045
Test Epoch4 layer0 Acc 0.8314, AUC 0.9109737873077393, avg_entr 0.17548176646232605, f1 0.8313999772071838
ep4_l0_test_time 0.3308134078979492
Test Epoch4 layer1 Acc 0.8224, AUC 0.9004218578338623, avg_entr 0.09475516527891159, f1 0.8223999738693237
ep4_l1_test_time 0.4951918125152588
Test Epoch4 layer2 Acc 0.8228, AUC 0.8999048471450806, avg_entr 0.0831289291381836, f1 0.8227999806404114
ep4_l2_test_time 0.7159380912780762
Test Epoch4 layer3 Acc 0.8192, AUC 0.899356484413147, avg_entr 0.07951253652572632, f1 0.8191999197006226
ep4_l3_test_time 1.0144848823547363
Test Epoch4 layer4 Acc 0.8194, AUC 0.8989613056182861, avg_entr 0.07526182383298874, f1 0.8194000124931335
ep4_l4_test_time 1.2033157348632812
gc 0
Train Epoch5 Acc 0.939875 (37595/40000), AUC 0.982384204864502
ep5_train_time 35.56758427619934
Test Epoch5 layer0 Acc 0.8248, AUC 0.9050464034080505, avg_entr 0.16449743509292603, f1 0.8248000144958496
ep5_l0_test_time 0.3120849132537842
Test Epoch5 layer1 Acc 0.8188, AUC 0.8930994272232056, avg_entr 0.07164058834314346, f1 0.8187999725341797
ep5_l1_test_time 0.49976038932800293
Test Epoch5 layer2 Acc 0.8172, AUC 0.8922727108001709, avg_entr 0.06080881506204605, f1 0.8172000050544739
ep5_l2_test_time 0.7135093212127686
Test Epoch5 layer3 Acc 0.818, AUC 0.8914179801940918, avg_entr 0.057596705853939056, f1 0.8180000185966492
ep5_l3_test_time 0.9896523952484131
Test Epoch5 layer4 Acc 0.8172, AUC 0.891255795955658, avg_entr 0.05662541463971138, f1 0.8172000050544739
ep5_l4_test_time 1.1873505115509033
gc 0
Train Epoch6 Acc 0.948725 (37949/40000), AUC 0.9856555461883545
ep6_train_time 35.8801064491272
Test Epoch6 layer0 Acc 0.823, AUC 0.8999267816543579, avg_entr 0.15526814758777618, f1 0.8230000138282776
ep6_l0_test_time 0.30913448333740234
Test Epoch6 layer1 Acc 0.8142, AUC 0.888541579246521, avg_entr 0.06831192970275879, f1 0.8141999840736389
ep6_l1_test_time 0.5022025108337402
Test Epoch6 layer2 Acc 0.813, AUC 0.8875274658203125, avg_entr 0.05379634350538254, f1 0.8130000233650208
ep6_l2_test_time 0.7185697555541992
Test Epoch6 layer3 Acc 0.8136, AUC 0.8869214653968811, avg_entr 0.049727749079465866, f1 0.8136000037193298
ep6_l3_test_time 0.9865267276763916
Test Epoch6 layer4 Acc 0.8112, AUC 0.8868945837020874, avg_entr 0.04829748719930649, f1 0.8112000226974487
ep6_l4_test_time 1.2054808139801025
gc 0
Train Epoch7 Acc 0.9601 (38404/40000), AUC 0.9911584854125977
ep7_train_time 35.793981075286865
Test Epoch7 layer0 Acc 0.8176, AUC 0.8968168497085571, avg_entr 0.1510814130306244, f1 0.8176000118255615
ep7_l0_test_time 0.2820463180541992
Test Epoch7 layer1 Acc 0.8064, AUC 0.8849072456359863, avg_entr 0.06307610869407654, f1 0.8064000010490417
ep7_l1_test_time 0.47379565238952637
Test Epoch7 layer2 Acc 0.8084, AUC 0.883948564529419, avg_entr 0.048366378992795944, f1 0.8083999752998352
ep7_l2_test_time 0.6780440807342529
Test Epoch7 layer3 Acc 0.8078, AUC 0.8833783864974976, avg_entr 0.0468955859541893, f1 0.8077999353408813
ep7_l3_test_time 0.9407978057861328
Test Epoch7 layer4 Acc 0.8074, AUC 0.883425772190094, avg_entr 0.04551152139902115, f1 0.8073999881744385
ep7_l4_test_time 1.1490299701690674
gc 0
Train Epoch8 Acc 0.9629 (38516/40000), AUC 0.9921795725822449
ep8_train_time 35.920339822769165
Test Epoch8 layer0 Acc 0.8184, AUC 0.8935368061065674, avg_entr 0.14518851041793823, f1 0.8184000253677368
ep8_l0_test_time 0.3278317451477051
Test Epoch8 layer1 Acc 0.807, AUC 0.8808165788650513, avg_entr 0.0585087351500988, f1 0.8069999814033508
ep8_l1_test_time 0.5008189678192139
Test Epoch8 layer2 Acc 0.807, AUC 0.8803713321685791, avg_entr 0.044750045984983444, f1 0.8069999814033508
ep8_l2_test_time 0.7248823642730713
Test Epoch8 layer3 Acc 0.804, AUC 0.8798745274543762, avg_entr 0.04348865523934364, f1 0.8040000200271606
ep8_l3_test_time 0.978461503982544
Test Epoch8 layer4 Acc 0.8068, AUC 0.8798664808273315, avg_entr 0.042640671133995056, f1 0.8068000078201294
ep8_l4_test_time 1.1947803497314453
gc 0
Train Epoch9 Acc 0.966 (38640/40000), AUC 0.9929599761962891
ep9_train_time 35.960121393203735
Test Epoch9 layer0 Acc 0.8152, AUC 0.8906762599945068, avg_entr 0.14242465794086456, f1 0.8152000308036804
ep9_l0_test_time 0.3224058151245117
Test Epoch9 layer1 Acc 0.8032, AUC 0.8776923418045044, avg_entr 0.051751408725976944, f1 0.8032000660896301
ep9_l1_test_time 0.5000729560852051
Test Epoch9 layer2 Acc 0.8018, AUC 0.8770157098770142, avg_entr 0.03815525770187378, f1 0.801800012588501
ep9_l2_test_time 0.7108910083770752
Test Epoch9 layer3 Acc 0.8036, AUC 0.8766729235649109, avg_entr 0.0376855731010437, f1 0.803600013256073
ep9_l3_test_time 0.9954001903533936
Test Epoch9 layer4 Acc 0.802, AUC 0.8768181204795837, avg_entr 0.03599300608038902, f1 0.8019999861717224
ep9_l4_test_time 1.2035410404205322
gc 0
Train Epoch10 Acc 0.9682 (38728/40000), AUC 0.9938738942146301
ep10_train_time 35.5946626663208
Test Epoch10 layer0 Acc 0.8132, AUC 0.8871078491210938, avg_entr 0.1395687311887741, f1 0.8131999969482422
ep10_l0_test_time 0.3002960681915283
Test Epoch10 layer1 Acc 0.8016, AUC 0.875446617603302, avg_entr 0.05329243838787079, f1 0.8015999794006348
ep10_l1_test_time 0.48645949363708496
Test Epoch10 layer2 Acc 0.7996, AUC 0.8748958110809326, avg_entr 0.04013428837060928, f1 0.7996000051498413
ep10_l2_test_time 0.713984489440918
Test Epoch10 layer3 Acc 0.8008, AUC 0.8747252821922302, avg_entr 0.040026258677244186, f1 0.8007999658584595
ep10_l3_test_time 0.9808545112609863
Test Epoch10 layer4 Acc 0.7994, AUC 0.8749655485153198, avg_entr 0.03878931328654289, f1 0.7993999123573303
ep10_l4_test_time 1.2145843505859375
gc 0
Train Epoch11 Acc 0.9724 (38896/40000), AUC 0.9949929714202881
ep11_train_time 35.824641704559326
Test Epoch11 layer0 Acc 0.8144, AUC 0.8861452341079712, avg_entr 0.1372479796409607, f1 0.8144000172615051
ep11_l0_test_time 0.31664013862609863
Test Epoch11 layer1 Acc 0.801, AUC 0.8733172416687012, avg_entr 0.05051245167851448, f1 0.8010000586509705
ep11_l1_test_time 0.49292755126953125
Test Epoch11 layer2 Acc 0.7992, AUC 0.8726240992546082, avg_entr 0.03736389800906181, f1 0.7991999983787537
ep11_l2_test_time 0.7226064205169678
Test Epoch11 layer3 Acc 0.7994, AUC 0.8726680278778076, avg_entr 0.03619550168514252, f1 0.7993999123573303
ep11_l3_test_time 0.9874434471130371
Test Epoch11 layer4 Acc 0.8, AUC 0.8729476928710938, avg_entr 0.03450065851211548, f1 0.8000000715255737
ep11_l4_test_time 1.2057716846466064
gc 0
Train Epoch12 Acc 0.9727 (38908/40000), AUC 0.9952991008758545
ep12_train_time 35.57796001434326
Test Epoch12 layer0 Acc 0.8134, AUC 0.8850220441818237, avg_entr 0.13428743183612823, f1 0.8133999109268188
ep12_l0_test_time 0.29754114151000977
Test Epoch12 layer1 Acc 0.7992, AUC 0.8722835779190063, avg_entr 0.049020446836948395, f1 0.7991999983787537
ep12_l1_test_time 0.5156879425048828
Test Epoch12 layer2 Acc 0.7992, AUC 0.871925413608551, avg_entr 0.03553936257958412, f1 0.7991999983787537
ep12_l2_test_time 0.7171714305877686
Test Epoch12 layer3 Acc 0.801, AUC 0.8721355199813843, avg_entr 0.03530535101890564, f1 0.8010000586509705
ep12_l3_test_time 0.9987797737121582
Test Epoch12 layer4 Acc 0.7996, AUC 0.8719207644462585, avg_entr 0.03429751470685005, f1 0.7996000051498413
ep12_l4_test_time 1.1817762851715088
gc 0
Train Epoch13 Acc 0.973775 (38951/40000), AUC 0.9955407381057739
ep13_train_time 35.89269256591797
Test Epoch13 layer0 Acc 0.8116, AUC 0.8833863735198975, avg_entr 0.13240617513656616, f1 0.8116000294685364
ep13_l0_test_time 0.3155834674835205
Test Epoch13 layer1 Acc 0.7972, AUC 0.869482159614563, avg_entr 0.04398956522345543, f1 0.7971999645233154
ep13_l1_test_time 0.5152621269226074
Test Epoch13 layer2 Acc 0.7972, AUC 0.8695845007896423, avg_entr 0.03183384984731674, f1 0.7971999645233154
ep13_l2_test_time 0.7080621719360352
Test Epoch13 layer3 Acc 0.7982, AUC 0.8699146509170532, avg_entr 0.03179056569933891, f1 0.7982000708580017
ep13_l3_test_time 0.9932873249053955
Test Epoch13 layer4 Acc 0.7972, AUC 0.869516909122467, avg_entr 0.03104439005255699, f1 0.7971999645233154
ep13_l4_test_time 1.1858007907867432
gc 0
Train Epoch14 Acc 0.9747 (38988/40000), AUC 0.9959836006164551
ep14_train_time 35.79823398590088
Test Epoch14 layer0 Acc 0.8098, AUC 0.8819457292556763, avg_entr 0.13007162511348724, f1 0.8098000288009644
ep14_l0_test_time 0.2878239154815674
Test Epoch14 layer1 Acc 0.7948, AUC 0.8673019409179688, avg_entr 0.04255039244890213, f1 0.7947999835014343
ep14_l1_test_time 0.49991679191589355
Test Epoch14 layer2 Acc 0.7938, AUC 0.8674454092979431, avg_entr 0.03131786361336708, f1 0.7937999963760376
ep14_l2_test_time 0.7272379398345947
Test Epoch14 layer3 Acc 0.7932, AUC 0.867987334728241, avg_entr 0.030906198546290398, f1 0.7932000160217285
ep14_l3_test_time 0.9859905242919922
Test Epoch14 layer4 Acc 0.7942, AUC 0.8674723505973816, avg_entr 0.029551861807703972, f1 0.7942000031471252
ep14_l4_test_time 1.195239543914795
gc 0
Train Epoch15 Acc 0.976875 (39075/40000), AUC 0.9964139461517334
ep15_train_time 35.63136100769043
Test Epoch15 layer0 Acc 0.809, AUC 0.8811235427856445, avg_entr 0.1291913539171219, f1 0.8090000748634338
ep15_l0_test_time 0.3145737648010254
Test Epoch15 layer1 Acc 0.7958, AUC 0.8684813976287842, avg_entr 0.04714240878820419, f1 0.7958000302314758
ep15_l1_test_time 0.501903772354126
Test Epoch15 layer2 Acc 0.7954, AUC 0.8682718873023987, avg_entr 0.034980665892362595, f1 0.795400083065033
ep15_l2_test_time 0.7208738327026367
Test Epoch15 layer3 Acc 0.7976, AUC 0.8687593936920166, avg_entr 0.0341109000146389, f1 0.7976000308990479
ep15_l3_test_time 1.0076696872711182
Test Epoch15 layer4 Acc 0.7972, AUC 0.8684110641479492, avg_entr 0.03237729147076607, f1 0.7971999645233154
ep15_l4_test_time 1.212317943572998
gc 0
Train Epoch16 Acc 0.976875 (39075/40000), AUC 0.9963392615318298
ep16_train_time 35.869831562042236
Test Epoch16 layer0 Acc 0.8072, AUC 0.8802076578140259, avg_entr 0.12825046479701996, f1 0.807200014591217
ep16_l0_test_time 0.3324277400970459
Test Epoch16 layer1 Acc 0.7942, AUC 0.866771936416626, avg_entr 0.04330633580684662, f1 0.7942000031471252
ep16_l1_test_time 0.49440956115722656
Test Epoch16 layer2 Acc 0.7938, AUC 0.8665072917938232, avg_entr 0.03200565278530121, f1 0.7937999963760376
ep16_l2_test_time 0.7062661647796631
Test Epoch16 layer3 Acc 0.795, AUC 0.8671170473098755, avg_entr 0.031102752313017845, f1 0.7950000166893005
ep16_l3_test_time 1.0020406246185303
Test Epoch16 layer4 Acc 0.7946, AUC 0.8668075799942017, avg_entr 0.03020508401095867, f1 0.7946000695228577
ep16_l4_test_time 1.2187163829803467
gc 0
Train Epoch17 Acc 0.977725 (39109/40000), AUC 0.9965908527374268
ep17_train_time 35.547518730163574
Test Epoch17 layer0 Acc 0.8052, AUC 0.8796603679656982, avg_entr 0.12701541185379028, f1 0.8051999807357788
ep17_l0_test_time 0.32637667655944824
Test Epoch17 layer1 Acc 0.7932, AUC 0.8652064800262451, avg_entr 0.03962269425392151, f1 0.7932000160217285
ep17_l1_test_time 0.48267173767089844
Test Epoch17 layer2 Acc 0.794, AUC 0.8652442693710327, avg_entr 0.02881888672709465, f1 0.7940000295639038
ep17_l2_test_time 0.7087504863739014
Test Epoch17 layer3 Acc 0.7946, AUC 0.865851640701294, avg_entr 0.02813846804201603, f1 0.7946000695228577
ep17_l3_test_time 0.9842379093170166
Test Epoch17 layer4 Acc 0.7946, AUC 0.8654865026473999, avg_entr 0.027205217629671097, f1 0.7946000695228577
ep17_l4_test_time 1.151911973953247
gc 0
Train Epoch18 Acc 0.9777 (39108/40000), AUC 0.9966993927955627
ep18_train_time 35.80635476112366
Test Epoch18 layer0 Acc 0.8048, AUC 0.8785240650177002, avg_entr 0.12610703706741333, f1 0.8047999739646912
ep18_l0_test_time 0.33048081398010254
Test Epoch18 layer1 Acc 0.7916, AUC 0.8653948307037354, avg_entr 0.04306700825691223, f1 0.7915999889373779
ep18_l1_test_time 0.5137896537780762
Test Epoch18 layer2 Acc 0.792, AUC 0.86534184217453, avg_entr 0.03221051022410393, f1 0.7920000553131104
ep18_l2_test_time 0.710956335067749
Test Epoch18 layer3 Acc 0.7952, AUC 0.8659402132034302, avg_entr 0.031130505725741386, f1 0.7952000498771667
ep18_l3_test_time 1.0034143924713135
Test Epoch18 layer4 Acc 0.7936, AUC 0.865536093711853, avg_entr 0.029642615467309952, f1 0.7936000227928162
ep18_l4_test_time 1.2062439918518066
gc 0
Train Epoch19 Acc 0.97905 (39162/40000), AUC 0.9969428777694702
ep19_train_time 35.78146409988403
Test Epoch19 layer0 Acc 0.8032, AUC 0.8781102299690247, avg_entr 0.1254197508096695, f1 0.8032000660896301
ep19_l0_test_time 0.2883939743041992
Test Epoch19 layer1 Acc 0.7924, AUC 0.8642227649688721, avg_entr 0.0412401482462883, f1 0.7923999428749084
ep19_l1_test_time 0.475480318069458
Test Epoch19 layer2 Acc 0.793, AUC 0.8642013072967529, avg_entr 0.030404413118958473, f1 0.7929999828338623
ep19_l2_test_time 0.6969804763793945
Test Epoch19 layer3 Acc 0.7936, AUC 0.8650467395782471, avg_entr 0.029428347945213318, f1 0.7936000227928162
ep19_l3_test_time 0.9277439117431641
Test Epoch19 layer4 Acc 0.7938, AUC 0.8645483255386353, avg_entr 0.0277258213609457, f1 0.7937999963760376
ep19_l4_test_time 1.147329330444336
gc 0
Train Epoch20 Acc 0.97915 (39166/40000), AUC 0.9969230890274048
ep20_train_time 35.86245131492615
Test Epoch20 layer0 Acc 0.8042, AUC 0.8779884576797485, avg_entr 0.12499316036701202, f1 0.8041999936103821
ep20_l0_test_time 0.3136746883392334
Test Epoch20 layer1 Acc 0.7908, AUC 0.8642919659614563, avg_entr 0.040299348533153534, f1 0.7907999753952026
ep20_l1_test_time 0.48963427543640137
Test Epoch20 layer2 Acc 0.7924, AUC 0.8642019629478455, avg_entr 0.029936306178569794, f1 0.7923999428749084
ep20_l2_test_time 0.7271220684051514
Test Epoch20 layer3 Acc 0.7934, AUC 0.8650748133659363, avg_entr 0.02866886928677559, f1 0.79339998960495
ep20_l3_test_time 0.990818977355957
Test Epoch20 layer4 Acc 0.7926, AUC 0.8645702600479126, avg_entr 0.02717130072414875, f1 0.7925999760627747
ep20_l4_test_time 1.2166471481323242
gc 0
Train Epoch21 Acc 0.979125 (39165/40000), AUC 0.9970307350158691
ep21_train_time 35.91137385368347
Test Epoch21 layer0 Acc 0.8026, AUC 0.877698540687561, avg_entr 0.124230295419693, f1 0.802600085735321
ep21_l0_test_time 0.3175344467163086
Test Epoch21 layer1 Acc 0.792, AUC 0.8634462952613831, avg_entr 0.03949487954378128, f1 0.7920000553131104
ep21_l1_test_time 0.5044591426849365
Test Epoch21 layer2 Acc 0.7924, AUC 0.8632794618606567, avg_entr 0.02903316728770733, f1 0.7923999428749084
ep21_l2_test_time 0.7119216918945312
Test Epoch21 layer3 Acc 0.7934, AUC 0.8643971681594849, avg_entr 0.027737276628613472, f1 0.79339998960495
ep21_l3_test_time 0.9929475784301758
Test Epoch21 layer4 Acc 0.7924, AUC 0.8638325333595276, avg_entr 0.026173250749707222, f1 0.7923999428749084
ep21_l4_test_time 1.2086198329925537
gc 0
Train Epoch22 Acc 0.979175 (39167/40000), AUC 0.996934175491333
ep22_train_time 35.5091757774353
Test Epoch22 layer0 Acc 0.8032, AUC 0.8772898316383362, avg_entr 0.12265515327453613, f1 0.8032000660896301
ep22_l0_test_time 0.2816429138183594
Test Epoch22 layer1 Acc 0.7912, AUC 0.8624386787414551, avg_entr 0.038934122771024704, f1 0.7911999821662903
ep22_l1_test_time 0.5204105377197266
Test Epoch22 layer2 Acc 0.7916, AUC 0.8624034523963928, avg_entr 0.028637047857046127, f1 0.7915999889373779
ep22_l2_test_time 0.7026212215423584
Test Epoch22 layer3 Acc 0.792, AUC 0.8634439706802368, avg_entr 0.027906829491257668, f1 0.7920000553131104
ep22_l3_test_time 0.9848685264587402
Test Epoch22 layer4 Acc 0.7936, AUC 0.8630053997039795, avg_entr 0.02586567960679531, f1 0.7936000227928162
ep22_l4_test_time 1.1993656158447266
gc 0
Train Epoch23 Acc 0.979975 (39199/40000), AUC 0.997115969657898
ep23_train_time 35.81704664230347
Test Epoch23 layer0 Acc 0.8038, AUC 0.8771952986717224, avg_entr 0.12268199771642685, f1 0.8037999868392944
ep23_l0_test_time 0.31796741485595703
Test Epoch23 layer1 Acc 0.7922, AUC 0.8628003597259521, avg_entr 0.03966238349676132, f1 0.7922000288963318
ep23_l1_test_time 0.4996805191040039
Test Epoch23 layer2 Acc 0.7912, AUC 0.862729012966156, avg_entr 0.02909281849861145, f1 0.7911999821662903
ep23_l2_test_time 0.7091410160064697
Test Epoch23 layer3 Acc 0.7916, AUC 0.8638017177581787, avg_entr 0.02825344167649746, f1 0.7915999889373779
ep23_l3_test_time 0.9998259544372559
Test Epoch23 layer4 Acc 0.7936, AUC 0.8633096218109131, avg_entr 0.026218347251415253, f1 0.7936000227928162
ep23_l4_test_time 1.194563627243042
gc 0
Train Epoch24 Acc 0.979875 (39195/40000), AUC 0.9971508979797363
ep24_train_time 35.614107608795166
Test Epoch24 layer0 Acc 0.8026, AUC 0.8769515752792358, avg_entr 0.12210008502006531, f1 0.802600085735321
ep24_l0_test_time 0.3289797306060791
Test Epoch24 layer1 Acc 0.7898, AUC 0.8626198172569275, avg_entr 0.03905198350548744, f1 0.7897999882698059
ep24_l1_test_time 0.5157155990600586
Test Epoch24 layer2 Acc 0.792, AUC 0.8625047206878662, avg_entr 0.02878480777144432, f1 0.7920000553131104
ep24_l2_test_time 0.7246928215026855
Test Epoch24 layer3 Acc 0.7934, AUC 0.8636515736579895, avg_entr 0.027678903192281723, f1 0.79339998960495
ep24_l3_test_time 1.0030629634857178
Test Epoch24 layer4 Acc 0.7922, AUC 0.8631751537322998, avg_entr 0.025886334478855133, f1 0.7922000288963318
ep24_l4_test_time 1.2106788158416748
gc 0
Train Epoch25 Acc 0.979825 (39193/40000), AUC 0.9971793293952942
ep25_train_time 35.90411639213562
Test Epoch25 layer0 Acc 0.8024, AUC 0.8768644332885742, avg_entr 0.12193942815065384, f1 0.8023999929428101
ep25_l0_test_time 0.32717227935791016
Test Epoch25 layer1 Acc 0.79, AUC 0.8622655868530273, avg_entr 0.037662334740161896, f1 0.7900000214576721
ep25_l1_test_time 0.505462646484375
Test Epoch25 layer2 Acc 0.7914, AUC 0.8620723485946655, avg_entr 0.027870602905750275, f1 0.7914000153541565
ep25_l2_test_time 0.7164661884307861
Test Epoch25 layer3 Acc 0.7922, AUC 0.8633593916893005, avg_entr 0.026479428634047508, f1 0.7922000288963318
ep25_l3_test_time 0.9982526302337646
Test Epoch25 layer4 Acc 0.7912, AUC 0.8628814220428467, avg_entr 0.02482895739376545, f1 0.7911999821662903
ep25_l4_test_time 1.194633960723877
gc 0
Train Epoch26 Acc 0.979875 (39195/40000), AUC 0.9971706867218018
ep26_train_time 35.86798620223999
Test Epoch26 layer0 Acc 0.8022, AUC 0.8767391443252563, avg_entr 0.12134469300508499, f1 0.8022000193595886
ep26_l0_test_time 0.32340526580810547
Test Epoch26 layer1 Acc 0.7904, AUC 0.8623181581497192, avg_entr 0.03815160691738129, f1 0.7904000282287598
ep26_l1_test_time 0.504497766494751
Test Epoch26 layer2 Acc 0.7908, AUC 0.8621280193328857, avg_entr 0.028332125395536423, f1 0.7907999753952026
ep26_l2_test_time 0.7027125358581543
Test Epoch26 layer3 Acc 0.7922, AUC 0.8633555173873901, avg_entr 0.027219250798225403, f1 0.7922000288963318
ep26_l3_test_time 1.018096923828125
Test Epoch26 layer4 Acc 0.791, AUC 0.8629032373428345, avg_entr 0.025390004739165306, f1 0.7910000681877136
ep26_l4_test_time 1.1948976516723633
gc 0
Train Epoch27 Acc 0.980025 (39201/40000), AUC 0.9972740411758423
ep27_train_time 35.5743453502655
Test Epoch27 layer0 Acc 0.802, AUC 0.876690149307251, avg_entr 0.1211099699139595, f1 0.8019999861717224
ep27_l0_test_time 0.3336927890777588
Test Epoch27 layer1 Acc 0.7898, AUC 0.8620551824569702, avg_entr 0.037145353853702545, f1 0.7897999882698059
ep27_l1_test_time 0.49190545082092285
Test Epoch27 layer2 Acc 0.7912, AUC 0.8618329167366028, avg_entr 0.027539409697055817, f1 0.7911999821662903
ep27_l2_test_time 0.7274520397186279
Test Epoch27 layer3 Acc 0.7918, AUC 0.8631291389465332, avg_entr 0.026138586923480034, f1 0.7918000221252441
ep27_l3_test_time 1.0074856281280518
Test Epoch27 layer4 Acc 0.7906, AUC 0.8627062439918518, avg_entr 0.02448190748691559, f1 0.7906000018119812
ep27_l4_test_time 1.1819775104522705
gc 0
Train Epoch28 Acc 0.980125 (39205/40000), AUC 0.9972650408744812
ep28_train_time 35.87518358230591
Test Epoch28 layer0 Acc 0.802, AUC 0.8766140937805176, avg_entr 0.12066782265901566, f1 0.8019999861717224
ep28_l0_test_time 0.33289504051208496
Test Epoch28 layer1 Acc 0.79, AUC 0.8624030351638794, avg_entr 0.037673696875572205, f1 0.7900000214576721
ep28_l1_test_time 0.5166020393371582
Test Epoch28 layer2 Acc 0.7904, AUC 0.8621693253517151, avg_entr 0.02811708301305771, f1 0.7904000282287598
ep28_l2_test_time 0.7133922576904297
Test Epoch28 layer3 Acc 0.7914, AUC 0.8634532690048218, avg_entr 0.02704600617289543, f1 0.7914000153541565
ep28_l3_test_time 0.9867219924926758
Test Epoch28 layer4 Acc 0.7918, AUC 0.8629781007766724, avg_entr 0.025116270408034325, f1 0.7918000221252441
ep28_l4_test_time 1.186227798461914
gc 0
Train Epoch29 Acc 0.98015 (39206/40000), AUC 0.9972862601280212
ep29_train_time 35.62269568443298
Test Epoch29 layer0 Acc 0.8014, AUC 0.8765536546707153, avg_entr 0.12014776468276978, f1 0.8014000058174133
ep29_l0_test_time 0.29558515548706055
Test Epoch29 layer1 Acc 0.7906, AUC 0.8619110584259033, avg_entr 0.03696134686470032, f1 0.7906000018119812
ep29_l1_test_time 0.5116653442382812
Test Epoch29 layer2 Acc 0.7908, AUC 0.8616711497306824, avg_entr 0.0274631530046463, f1 0.7907999753952026
ep29_l2_test_time 0.7156369686126709
Test Epoch29 layer3 Acc 0.7914, AUC 0.862973690032959, avg_entr 0.026187188923358917, f1 0.7914000153541565
ep29_l3_test_time 1.0143840312957764
Test Epoch29 layer4 Acc 0.7902, AUC 0.8625938296318054, avg_entr 0.024458931758999825, f1 0.7901999950408936
ep29_l4_test_time 1.1846585273742676
Best AUC tensor(0.8402)
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 1186.140204668045
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad100//imdb_lstmal_l5.pt
Test layer0 Acc 0.8328, AUC 0.9198411107063293, avg_entr 0.2131001204252243, f1 0.8327999711036682
l0_test_time 0.3041675090789795
Test layer1 Acc 0.829, AUC 0.9099060893058777, avg_entr 0.1288725584745407, f1 0.8289999961853027
l1_test_time 0.5164153575897217
Test layer2 Acc 0.8316, AUC 0.9107886552810669, avg_entr 0.11805488169193268, f1 0.83160001039505
l2_test_time 0.712878942489624
Test layer3 Acc 0.826, AUC 0.9101241827011108, avg_entr 0.1096353530883789, f1 0.8259999752044678
l3_test_time 0.9946038722991943
Test layer4 Acc 0.828, AUC 0.9097522497177124, avg_entr 0.109470434486866, f1 0.828000009059906
l4_test_time 1.1899726390838623
