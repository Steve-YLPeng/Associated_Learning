total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.836162090301514
Start Training
gc 0
Train Epoch0 Acc 0.500925 (20037/40000), AUC 0.5035209655761719
ep0_train_time 12.230743885040283
Test Epoch0 layer0 Acc 0.7948, AUC 0.8880324363708496, avg_entr 0.563098132610321, f1 0.7947999835014343
ep0_l0_test_time 0.764070987701416
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5696, AUC 0.859139084815979, avg_entr 0.6803115606307983, f1 0.569599986076355
ep0_l1_test_time 0.7926895618438721
Test Epoch0 layer2 Acc 0.5042, AUC 0.7982295751571655, avg_entr 0.6848715543746948, f1 0.5041999816894531
ep0_l2_test_time 0.7634499073028564
Test Epoch0 layer3 Acc 0.5046, AUC 0.8664183616638184, avg_entr 0.6836657524108887, f1 0.5045999884605408
ep0_l3_test_time 0.7872905731201172
Test Epoch0 layer4 Acc 0.5044, AUC 0.7000737190246582, avg_entr 0.684009850025177, f1 0.5044000148773193
ep0_l4_test_time 0.7703907489776611
gc 0
Train Epoch1 Acc 0.80095 (32038/40000), AUC 0.8843458294868469
ep1_train_time 11.191766262054443
Test Epoch1 layer0 Acc 0.8762, AUC 0.9452245235443115, avg_entr 0.2885389029979706, f1 0.8762000203132629
ep1_l0_test_time 0.7690141201019287
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8804, AUC 0.9455969333648682, avg_entr 0.36272117495536804, f1 0.8804000020027161
ep1_l1_test_time 0.7885334491729736
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8728, AUC 0.9455466270446777, avg_entr 0.23581933975219727, f1 0.8727999925613403
ep1_l2_test_time 0.7859070301055908
Test Epoch1 layer3 Acc 0.8736, AUC 0.9456620216369629, avg_entr 0.22872301936149597, f1 0.8736000061035156
ep1_l3_test_time 0.7690787315368652
Test Epoch1 layer4 Acc 0.8744, AUC 0.9458789825439453, avg_entr 0.23321674764156342, f1 0.8744000792503357
ep1_l4_test_time 0.7632150650024414
gc 0
Train Epoch2 Acc 0.90565 (36226/40000), AUC 0.9645921587944031
ep2_train_time 11.018079280853271
Test Epoch2 layer0 Acc 0.893, AUC 0.9554023742675781, avg_entr 0.22728876769542694, f1 0.8930000066757202
ep2_l0_test_time 0.7798764705657959
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.894, AUC 0.9558218121528625, avg_entr 0.21287451684474945, f1 0.8939999938011169
ep2_l1_test_time 0.776552677154541
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8948, AUC 0.9561203718185425, avg_entr 0.1854587346315384, f1 0.8948000073432922
ep2_l2_test_time 0.7698967456817627
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.893, AUC 0.9562066793441772, avg_entr 0.1730802059173584, f1 0.8930000066757202
ep2_l3_test_time 0.7942945957183838
Test Epoch2 layer4 Acc 0.8932, AUC 0.9562278389930725, avg_entr 0.16493676602840424, f1 0.8931999802589417
ep2_l4_test_time 0.7543489933013916
gc 0
Train Epoch3 Acc 0.923775 (36951/40000), AUC 0.9756883382797241
ep3_train_time 11.13073182106018
Test Epoch3 layer0 Acc 0.8968, AUC 0.9584743976593018, avg_entr 0.19809196889400482, f1 0.8967999815940857
ep3_l0_test_time 0.7601094245910645
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.898, AUC 0.9587146043777466, avg_entr 0.17370477318763733, f1 0.8980000019073486
ep3_l1_test_time 0.7800850868225098
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8974, AUC 0.9590467214584351, avg_entr 0.15720897912979126, f1 0.8974000215530396
ep3_l2_test_time 0.7779927253723145
Test Epoch3 layer3 Acc 0.8948, AUC 0.9591861963272095, avg_entr 0.13826139271259308, f1 0.8948000073432922
ep3_l3_test_time 0.7761890888214111
Test Epoch3 layer4 Acc 0.8974, AUC 0.9593315720558167, avg_entr 0.11814968287944794, f1 0.8974000215530396
ep3_l4_test_time 0.7834262847900391
gc 0
Train Epoch4 Acc 0.934675 (37387/40000), AUC 0.9814786314964294
ep4_train_time 11.147247076034546
Test Epoch4 layer0 Acc 0.8986, AUC 0.9592790007591248, avg_entr 0.17812730371952057, f1 0.8985999822616577
ep4_l0_test_time 0.7713322639465332
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8984, AUC 0.959574818611145, avg_entr 0.15278540551662445, f1 0.8984000086784363
ep4_l1_test_time 0.7656910419464111
Test Epoch4 layer2 Acc 0.8978, AUC 0.959965705871582, avg_entr 0.13727127015590668, f1 0.8978000283241272
ep4_l2_test_time 0.7821996212005615
Test Epoch4 layer3 Acc 0.8968, AUC 0.9603011012077332, avg_entr 0.1150587797164917, f1 0.8967999815940857
ep4_l3_test_time 0.7833943367004395
Test Epoch4 layer4 Acc 0.8972, AUC 0.9606915712356567, avg_entr 0.07862842082977295, f1 0.8971999883651733
ep4_l4_test_time 0.7606077194213867
gc 0
Train Epoch5 Acc 0.9427 (37708/40000), AUC 0.9852052927017212
ep5_train_time 11.122064590454102
Test Epoch5 layer0 Acc 0.8968, AUC 0.9588956832885742, avg_entr 0.16142085194587708, f1 0.8967999815940857
ep5_l0_test_time 0.7656378746032715
Test Epoch5 layer1 Acc 0.8974, AUC 0.9593284130096436, avg_entr 0.13576781749725342, f1 0.8974000215530396
ep5_l1_test_time 0.7779302597045898
Test Epoch5 layer2 Acc 0.8974, AUC 0.9598337411880493, avg_entr 0.12051881104707718, f1 0.8974000215530396
ep5_l2_test_time 0.7695164680480957
Test Epoch5 layer3 Acc 0.897, AUC 0.9602836966514587, avg_entr 0.0885610356926918, f1 0.8970000147819519
ep5_l3_test_time 0.755946159362793
Test Epoch5 layer4 Acc 0.8948, AUC 0.9601945877075195, avg_entr 0.05487067997455597, f1 0.8948000073432922
ep5_l4_test_time 0.7766828536987305
gc 0
Train Epoch6 Acc 0.950075 (38003/40000), AUC 0.9875620603561401
ep6_train_time 11.074788570404053
Test Epoch6 layer0 Acc 0.8988, AUC 0.957871675491333, avg_entr 0.1537279188632965, f1 0.8988000154495239
ep6_l0_test_time 0.7732760906219482
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 6
Test Epoch6 layer1 Acc 0.8982, AUC 0.9582701325416565, avg_entr 0.12806087732315063, f1 0.8981999754905701
ep6_l1_test_time 0.780085563659668
Test Epoch6 layer2 Acc 0.898, AUC 0.9588850736618042, avg_entr 0.1106315404176712, f1 0.8980000019073486
ep6_l2_test_time 0.7716374397277832
Test Epoch6 layer3 Acc 0.8984, AUC 0.9596892595291138, avg_entr 0.07352734357118607, f1 0.8984000086784363
ep6_l3_test_time 0.7698390483856201
Test Epoch6 layer4 Acc 0.8986, AUC 0.9579986333847046, avg_entr 0.0466536208987236, f1 0.8985999822616577
ep6_l4_test_time 0.7894141674041748
gc 0
Train Epoch7 Acc 0.9542 (38168/40000), AUC 0.9890737533569336
ep7_train_time 11.128604888916016
Test Epoch7 layer0 Acc 0.8922, AUC 0.9560596942901611, avg_entr 0.14841298758983612, f1 0.8921999931335449
ep7_l0_test_time 0.7788293361663818
Test Epoch7 layer1 Acc 0.8936, AUC 0.956657886505127, avg_entr 0.12296348810195923, f1 0.8935999870300293
ep7_l1_test_time 0.7686727046966553
Test Epoch7 layer2 Acc 0.8888, AUC 0.9573602676391602, avg_entr 0.10388340055942535, f1 0.8888000249862671
ep7_l2_test_time 0.7739064693450928
Test Epoch7 layer3 Acc 0.8912, AUC 0.9582215547561646, avg_entr 0.06220247969031334, f1 0.8912000060081482
ep7_l3_test_time 0.7704381942749023
Test Epoch7 layer4 Acc 0.8922, AUC 0.9552518129348755, avg_entr 0.04152258485555649, f1 0.8921999931335449
ep7_l4_test_time 0.7524378299713135
gc 0
Train Epoch8 Acc 0.95925 (38370/40000), AUC 0.9907475709915161
ep8_train_time 11.20198106765747
Test Epoch8 layer0 Acc 0.8914, AUC 0.9545927047729492, avg_entr 0.13720184564590454, f1 0.8913999795913696
ep8_l0_test_time 0.7745401859283447
Test Epoch8 layer1 Acc 0.8934, AUC 0.9553301334381104, avg_entr 0.11269083619117737, f1 0.8934000134468079
ep8_l1_test_time 0.7666585445404053
Test Epoch8 layer2 Acc 0.8936, AUC 0.9560874104499817, avg_entr 0.09139101952314377, f1 0.8935999870300293
ep8_l2_test_time 0.761476993560791
Test Epoch8 layer3 Acc 0.8932, AUC 0.9558022618293762, avg_entr 0.04909393563866615, f1 0.8931999802589417
ep8_l3_test_time 0.7908756732940674
Test Epoch8 layer4 Acc 0.8932, AUC 0.952843964099884, avg_entr 0.03217695280909538, f1 0.8931999802589417
ep8_l4_test_time 0.7760765552520752
gc 0
Train Epoch9 Acc 0.963425 (38537/40000), AUC 0.9924191832542419
ep9_train_time 11.160674571990967
Test Epoch9 layer0 Acc 0.893, AUC 0.953660249710083, avg_entr 0.1349809616804123, f1 0.8930000066757202
ep9_l0_test_time 0.7767343521118164
Test Epoch9 layer1 Acc 0.8922, AUC 0.9544312953948975, avg_entr 0.11104977130889893, f1 0.8921999931335449
ep9_l1_test_time 0.7919514179229736
Test Epoch9 layer2 Acc 0.8924, AUC 0.9550462961196899, avg_entr 0.0890275239944458, f1 0.8923999667167664
ep9_l2_test_time 0.7670011520385742
Test Epoch9 layer3 Acc 0.893, AUC 0.9547461271286011, avg_entr 0.04539365693926811, f1 0.8930000066757202
ep9_l3_test_time 0.7743158340454102
Test Epoch9 layer4 Acc 0.8936, AUC 0.9528783559799194, avg_entr 0.03065692074596882, f1 0.8935999870300293
ep9_l4_test_time 0.7545170783996582
gc 0
Train Epoch10 Acc 0.965675 (38627/40000), AUC 0.9932843446731567
ep10_train_time 11.09847617149353
Test Epoch10 layer0 Acc 0.8918, AUC 0.9527068734169006, avg_entr 0.1331922858953476, f1 0.8917999863624573
ep10_l0_test_time 0.7931663990020752
Test Epoch10 layer1 Acc 0.8914, AUC 0.9536117911338806, avg_entr 0.10929372906684875, f1 0.8913999795913696
ep10_l1_test_time 0.7698996067047119
Test Epoch10 layer2 Acc 0.8908, AUC 0.9542754888534546, avg_entr 0.0862961858510971, f1 0.8907999992370605
ep10_l2_test_time 0.7662827968597412
Test Epoch10 layer3 Acc 0.8912, AUC 0.9532442688941956, avg_entr 0.044268447905778885, f1 0.8912000060081482
ep10_l3_test_time 0.7988779544830322
Test Epoch10 layer4 Acc 0.8908, AUC 0.951187252998352, avg_entr 0.030521893873810768, f1 0.8907999992370605
ep10_l4_test_time 0.7748434543609619
gc 0
Train Epoch11 Acc 0.9669 (38676/40000), AUC 0.9936205744743347
ep11_train_time 11.210815668106079
Test Epoch11 layer0 Acc 0.8914, AUC 0.9516651630401611, avg_entr 0.12862008810043335, f1 0.8913999795913696
ep11_l0_test_time 0.7849445343017578
Test Epoch11 layer1 Acc 0.892, AUC 0.9526598453521729, avg_entr 0.1052737906575203, f1 0.8920000195503235
ep11_l1_test_time 0.7752318382263184
Test Epoch11 layer2 Acc 0.8914, AUC 0.953319251537323, avg_entr 0.08150207251310349, f1 0.8913999795913696
ep11_l2_test_time 0.8017237186431885
Test Epoch11 layer3 Acc 0.892, AUC 0.9514603614807129, avg_entr 0.04066373407840729, f1 0.8920000195503235
ep11_l3_test_time 0.7764537334442139
Test Epoch11 layer4 Acc 0.8916, AUC 0.948249340057373, avg_entr 0.02833469770848751, f1 0.8916000127792358
ep11_l4_test_time 0.7842144966125488
gc 0
Train Epoch12 Acc 0.967475 (38699/40000), AUC 0.9941529631614685
ep12_train_time 11.253730297088623
Test Epoch12 layer0 Acc 0.889, AUC 0.9505489468574524, avg_entr 0.1270928531885147, f1 0.8889999985694885
ep12_l0_test_time 0.7772505283355713
Test Epoch12 layer1 Acc 0.8876, AUC 0.9515615701675415, avg_entr 0.10371819138526917, f1 0.8876000046730042
ep12_l1_test_time 0.771571159362793
Test Epoch12 layer2 Acc 0.8884, AUC 0.9521136283874512, avg_entr 0.07938524335622787, f1 0.8884000182151794
ep12_l2_test_time 0.7766730785369873
Test Epoch12 layer3 Acc 0.8884, AUC 0.9500064849853516, avg_entr 0.039705317467451096, f1 0.8884000182151794
ep12_l3_test_time 0.7616117000579834
Test Epoch12 layer4 Acc 0.8884, AUC 0.9492565989494324, avg_entr 0.02778361551463604, f1 0.8884000182151794
ep12_l4_test_time 0.7781646251678467
gc 0
Train Epoch13 Acc 0.969375 (38775/40000), AUC 0.994802713394165
ep13_train_time 11.253909587860107
Test Epoch13 layer0 Acc 0.8876, AUC 0.949962854385376, avg_entr 0.12474068254232407, f1 0.8876000046730042
ep13_l0_test_time 0.7864785194396973
Test Epoch13 layer1 Acc 0.8886, AUC 0.9509901404380798, avg_entr 0.10177391022443771, f1 0.8885999917984009
ep13_l1_test_time 0.7773778438568115
Test Epoch13 layer2 Acc 0.8878, AUC 0.9514777064323425, avg_entr 0.07679533958435059, f1 0.8877999782562256
ep13_l2_test_time 0.7639682292938232
Test Epoch13 layer3 Acc 0.8884, AUC 0.9493362307548523, avg_entr 0.03775167837738991, f1 0.8884000182151794
ep13_l3_test_time 0.7706782817840576
Test Epoch13 layer4 Acc 0.8886, AUC 0.9493707418441772, avg_entr 0.02619205042719841, f1 0.8885999917984009
ep13_l4_test_time 0.7886710166931152
gc 0
Train Epoch14 Acc 0.9703 (38812/40000), AUC 0.9949642419815063
ep14_train_time 11.143383502960205
Test Epoch14 layer0 Acc 0.8846, AUC 0.9494707584381104, avg_entr 0.1258474588394165, f1 0.8845999836921692
ep14_l0_test_time 0.766571044921875
Test Epoch14 layer1 Acc 0.8846, AUC 0.9506003856658936, avg_entr 0.1029798686504364, f1 0.8845999836921692
ep14_l1_test_time 0.7681620121002197
Test Epoch14 layer2 Acc 0.884, AUC 0.951113224029541, avg_entr 0.07811813056468964, f1 0.8840000033378601
ep14_l2_test_time 0.7914016246795654
Test Epoch14 layer3 Acc 0.884, AUC 0.9488060474395752, avg_entr 0.038731224834918976, f1 0.8840000033378601
ep14_l3_test_time 0.7544960975646973
Test Epoch14 layer4 Acc 0.884, AUC 0.948347270488739, avg_entr 0.02691914327442646, f1 0.8840000033378601
ep14_l4_test_time 0.7820842266082764
gc 0
Train Epoch15 Acc 0.971425 (38857/40000), AUC 0.9952157735824585
ep15_train_time 11.11526083946228
Test Epoch15 layer0 Acc 0.8828, AUC 0.9487011432647705, avg_entr 0.12103741616010666, f1 0.8827999830245972
ep15_l0_test_time 0.7868683338165283
Test Epoch15 layer1 Acc 0.8842, AUC 0.9497738480567932, avg_entr 0.09845317155122757, f1 0.8842000365257263
ep15_l1_test_time 0.7852869033813477
Test Epoch15 layer2 Acc 0.8836, AUC 0.9501413106918335, avg_entr 0.0724378153681755, f1 0.8835999965667725
ep15_l2_test_time 0.7732148170471191
Test Epoch15 layer3 Acc 0.8838, AUC 0.947381854057312, avg_entr 0.033955950289964676, f1 0.8838000297546387
ep15_l3_test_time 0.759798526763916
Test Epoch15 layer4 Acc 0.8846, AUC 0.9477159976959229, avg_entr 0.02323792316019535, f1 0.8845999836921692
ep15_l4_test_time 0.7740342617034912
gc 0
Train Epoch16 Acc 0.970825 (38833/40000), AUC 0.9953184127807617
ep16_train_time 11.1687331199646
Test Epoch16 layer0 Acc 0.884, AUC 0.9482426047325134, avg_entr 0.12190090119838715, f1 0.8840000033378601
ep16_l0_test_time 0.7768368721008301
Test Epoch16 layer1 Acc 0.8838, AUC 0.9494684934616089, avg_entr 0.09961710125207901, f1 0.8838000297546387
ep16_l1_test_time 0.7706828117370605
Test Epoch16 layer2 Acc 0.8824, AUC 0.94990473985672, avg_entr 0.07391519099473953, f1 0.8823999762535095
ep16_l2_test_time 0.7851581573486328
Test Epoch16 layer3 Acc 0.8836, AUC 0.9471383094787598, avg_entr 0.036439940333366394, f1 0.8835999965667725
ep16_l3_test_time 0.7669787406921387
Test Epoch16 layer4 Acc 0.8838, AUC 0.947073221206665, avg_entr 0.025482799857854843, f1 0.8838000297546387
ep16_l4_test_time 0.7697386741638184
gc 0
Train Epoch17 Acc 0.9723 (38892/40000), AUC 0.9956398010253906
ep17_train_time 11.27869725227356
Test Epoch17 layer0 Acc 0.8842, AUC 0.94791579246521, avg_entr 0.11936520785093307, f1 0.8842000365257263
ep17_l0_test_time 0.7865011692047119
Test Epoch17 layer1 Acc 0.8844, AUC 0.9491329789161682, avg_entr 0.09730330854654312, f1 0.8844000101089478
ep17_l1_test_time 0.7946441173553467
Test Epoch17 layer2 Acc 0.884, AUC 0.9494942426681519, avg_entr 0.07112186402082443, f1 0.8840000033378601
ep17_l2_test_time 0.7660171985626221
Test Epoch17 layer3 Acc 0.8844, AUC 0.9466245174407959, avg_entr 0.03399786353111267, f1 0.8844000101089478
ep17_l3_test_time 0.7909188270568848
Test Epoch17 layer4 Acc 0.8838, AUC 0.9465932250022888, avg_entr 0.024209201335906982, f1 0.8838000297546387
ep17_l4_test_time 0.7756478786468506
gc 0
Train Epoch18 Acc 0.972625 (38905/40000), AUC 0.9957520961761475
ep18_train_time 11.213199377059937
Test Epoch18 layer0 Acc 0.8822, AUC 0.9475579261779785, avg_entr 0.12058044224977493, f1 0.8822000026702881
ep18_l0_test_time 0.7712521553039551
Test Epoch18 layer1 Acc 0.8842, AUC 0.9488157629966736, avg_entr 0.09823215752840042, f1 0.8842000365257263
ep18_l1_test_time 0.7822017669677734
Test Epoch18 layer2 Acc 0.8812, AUC 0.9492117762565613, avg_entr 0.07228109985589981, f1 0.8812000155448914
ep18_l2_test_time 0.7708804607391357
Test Epoch18 layer3 Acc 0.881, AUC 0.946704626083374, avg_entr 0.03517022356390953, f1 0.8809999823570251
ep18_l3_test_time 0.7620646953582764
Test Epoch18 layer4 Acc 0.8816, AUC 0.9470102787017822, avg_entr 0.025070367380976677, f1 0.881600022315979
ep18_l4_test_time 0.7724137306213379
gc 0
Train Epoch19 Acc 0.9728 (38912/40000), AUC 0.995833158493042
ep19_train_time 11.219500064849854
Test Epoch19 layer0 Acc 0.8834, AUC 0.9472839832305908, avg_entr 0.1178572028875351, f1 0.8834000825881958
ep19_l0_test_time 0.7976219654083252
Test Epoch19 layer1 Acc 0.8842, AUC 0.9484838843345642, avg_entr 0.09569815546274185, f1 0.8842000365257263
ep19_l1_test_time 0.7535648345947266
Test Epoch19 layer2 Acc 0.883, AUC 0.9488224983215332, avg_entr 0.06952469795942307, f1 0.8830000162124634
ep19_l2_test_time 0.7714583873748779
Test Epoch19 layer3 Acc 0.883, AUC 0.9457015991210938, avg_entr 0.033158402889966965, f1 0.8830000162124634
ep19_l3_test_time 0.781841516494751
Test Epoch19 layer4 Acc 0.8828, AUC 0.945144534111023, avg_entr 0.023705406114459038, f1 0.8827999830245972
ep19_l4_test_time 0.764615535736084
gc 0
Train Epoch20 Acc 0.973375 (38935/40000), AUC 0.9959214925765991
ep20_train_time 11.188077449798584
Test Epoch20 layer0 Acc 0.8794, AUC 0.9469744563102722, avg_entr 0.11855671554803848, f1 0.8794000148773193
ep20_l0_test_time 0.7694580554962158
Test Epoch20 layer1 Acc 0.8832, AUC 0.9482816457748413, avg_entr 0.0964115709066391, f1 0.8831999897956848
ep20_l1_test_time 0.7671680450439453
Test Epoch20 layer2 Acc 0.8808, AUC 0.9486331939697266, avg_entr 0.07015767693519592, f1 0.8808000087738037
ep20_l2_test_time 0.7738687992095947
Test Epoch20 layer3 Acc 0.8802, AUC 0.946052074432373, avg_entr 0.03404286876320839, f1 0.8802000284194946
ep20_l3_test_time 0.7730586528778076
Test Epoch20 layer4 Acc 0.8808, AUC 0.9466137886047363, avg_entr 0.024324487894773483, f1 0.8808000087738037
ep20_l4_test_time 0.7600753307342529
gc 0
Train Epoch21 Acc 0.973975 (38959/40000), AUC 0.9960533380508423
ep21_train_time 11.170153856277466
Test Epoch21 layer0 Acc 0.8812, AUC 0.9468492269515991, avg_entr 0.11711166054010391, f1 0.8812000155448914
ep21_l0_test_time 0.8011438846588135
Test Epoch21 layer1 Acc 0.8828, AUC 0.9481490850448608, avg_entr 0.09517154842615128, f1 0.8827999830245972
ep21_l1_test_time 0.7637150287628174
Test Epoch21 layer2 Acc 0.882, AUC 0.9484782218933105, avg_entr 0.0688871219754219, f1 0.8820000290870667
ep21_l2_test_time 0.7633929252624512
Test Epoch21 layer3 Acc 0.8824, AUC 0.9458110332489014, avg_entr 0.03332938998937607, f1 0.8823999762535095
ep21_l3_test_time 0.7751815319061279
Test Epoch21 layer4 Acc 0.8826, AUC 0.9469535946846008, avg_entr 0.024096200242638588, f1 0.8826000094413757
ep21_l4_test_time 0.7952373027801514
gc 0
Train Epoch22 Acc 0.9738 (38952/40000), AUC 0.9960569143295288
ep22_train_time 11.199156761169434
Test Epoch22 layer0 Acc 0.8798, AUC 0.9466960430145264, avg_entr 0.11711136251688004, f1 0.879800021648407
ep22_l0_test_time 0.7589714527130127
Test Epoch22 layer1 Acc 0.882, AUC 0.9480374455451965, avg_entr 0.09521757811307907, f1 0.8820000290870667
ep22_l1_test_time 0.7784864902496338
Test Epoch22 layer2 Acc 0.8814, AUC 0.9483668804168701, avg_entr 0.06901835650205612, f1 0.8813999891281128
ep22_l2_test_time 0.7619519233703613
Test Epoch22 layer3 Acc 0.8808, AUC 0.9455292224884033, avg_entr 0.03342711180448532, f1 0.8808000087738037
ep22_l3_test_time 0.7801671028137207
Test Epoch22 layer4 Acc 0.881, AUC 0.9465193152427673, avg_entr 0.02399471215903759, f1 0.8809999823570251
ep22_l4_test_time 0.7765464782714844
gc 0
Train Epoch23 Acc 0.973825 (38953/40000), AUC 0.9961433410644531
ep23_train_time 11.185159683227539
Test Epoch23 layer0 Acc 0.8806, AUC 0.9465764760971069, avg_entr 0.11600176990032196, f1 0.8805999755859375
ep23_l0_test_time 0.7811200618743896
Test Epoch23 layer1 Acc 0.8814, AUC 0.9478881359100342, avg_entr 0.09393927454948425, f1 0.8813999891281128
ep23_l1_test_time 0.7952041625976562
Test Epoch23 layer2 Acc 0.8818, AUC 0.9482027292251587, avg_entr 0.06759367138147354, f1 0.8818000555038452
ep23_l2_test_time 0.7948029041290283
Test Epoch23 layer3 Acc 0.8816, AUC 0.9455010890960693, avg_entr 0.03243793547153473, f1 0.881600022315979
ep23_l3_test_time 0.7810742855072021
Test Epoch23 layer4 Acc 0.8818, AUC 0.9460210800170898, avg_entr 0.023528600111603737, f1 0.8818000555038452
ep23_l4_test_time 0.7859735488891602
gc 0
Train Epoch24 Acc 0.974 (38960/40000), AUC 0.9961227178573608
ep24_train_time 11.168209791183472
Test Epoch24 layer0 Acc 0.8814, AUC 0.9464279413223267, avg_entr 0.11498644948005676, f1 0.8813999891281128
ep24_l0_test_time 0.7640089988708496
Test Epoch24 layer1 Acc 0.8822, AUC 0.9477241635322571, avg_entr 0.09299035370349884, f1 0.8822000026702881
ep24_l1_test_time 0.7799925804138184
Test Epoch24 layer2 Acc 0.8816, AUC 0.9480182528495789, avg_entr 0.06668537110090256, f1 0.881600022315979
ep24_l2_test_time 0.7802517414093018
Test Epoch24 layer3 Acc 0.8816, AUC 0.9451329708099365, avg_entr 0.03171418607234955, f1 0.881600022315979
ep24_l3_test_time 0.7625670433044434
Test Epoch24 layer4 Acc 0.8822, AUC 0.9453518390655518, avg_entr 0.022873586043715477, f1 0.8822000026702881
ep24_l4_test_time 0.7754461765289307
gc 0
Train Epoch25 Acc 0.9739 (38956/40000), AUC 0.9962102174758911
ep25_train_time 11.012166500091553
Test Epoch25 layer0 Acc 0.882, AUC 0.946351170539856, avg_entr 0.11441219598054886, f1 0.8820000290870667
ep25_l0_test_time 0.7782182693481445
Test Epoch25 layer1 Acc 0.8818, AUC 0.9476684331893921, avg_entr 0.09268217533826828, f1 0.8818000555038452
ep25_l1_test_time 0.7807800769805908
Test Epoch25 layer2 Acc 0.8812, AUC 0.9479484558105469, avg_entr 0.06636711955070496, f1 0.8812000155448914
ep25_l2_test_time 0.7897400856018066
Test Epoch25 layer3 Acc 0.8814, AUC 0.9446544647216797, avg_entr 0.03175562620162964, f1 0.8813999891281128
ep25_l3_test_time 0.7722642421722412
Test Epoch25 layer4 Acc 0.882, AUC 0.9446246027946472, avg_entr 0.02301611751317978, f1 0.8820000290870667
ep25_l4_test_time 0.7740607261657715
gc 0
Train Epoch26 Acc 0.97425 (38970/40000), AUC 0.9961982369422913
ep26_train_time 11.165618658065796
Test Epoch26 layer0 Acc 0.88, AUC 0.9462926387786865, avg_entr 0.11451611667871475, f1 0.8799999952316284
ep26_l0_test_time 0.7619118690490723
Test Epoch26 layer1 Acc 0.8812, AUC 0.9475970268249512, avg_entr 0.09270653128623962, f1 0.8812000155448914
ep26_l1_test_time 0.757004976272583
Test Epoch26 layer2 Acc 0.8802, AUC 0.9478877782821655, avg_entr 0.06646449863910675, f1 0.8802000284194946
ep26_l2_test_time 0.7740581035614014
Test Epoch26 layer3 Acc 0.881, AUC 0.9449367523193359, avg_entr 0.032000359147787094, f1 0.8809999823570251
ep26_l3_test_time 0.8006126880645752
Test Epoch26 layer4 Acc 0.8812, AUC 0.9453509449958801, avg_entr 0.02335559017956257, f1 0.8812000155448914
ep26_l4_test_time 0.7863097190856934
gc 0
Train Epoch27 Acc 0.974225 (38969/40000), AUC 0.9962114691734314
ep27_train_time 11.163882493972778
Test Epoch27 layer0 Acc 0.881, AUC 0.9462139010429382, avg_entr 0.11367549002170563, f1 0.8809999823570251
ep27_l0_test_time 0.7806084156036377
Test Epoch27 layer1 Acc 0.8814, AUC 0.9475275278091431, avg_entr 0.09196624904870987, f1 0.8813999891281128
ep27_l1_test_time 0.7867400646209717
Test Epoch27 layer2 Acc 0.8814, AUC 0.9478243589401245, avg_entr 0.06572222709655762, f1 0.8813999891281128
ep27_l2_test_time 0.7850539684295654
Test Epoch27 layer3 Acc 0.8816, AUC 0.9448665976524353, avg_entr 0.03128136321902275, f1 0.881600022315979
ep27_l3_test_time 0.7809340953826904
Test Epoch27 layer4 Acc 0.8818, AUC 0.9452669620513916, avg_entr 0.022683724761009216, f1 0.8818000555038452
ep27_l4_test_time 0.7816431522369385
gc 0
Train Epoch28 Acc 0.9744 (38976/40000), AUC 0.996314525604248
ep28_train_time 11.178542613983154
Test Epoch28 layer0 Acc 0.8812, AUC 0.9461551904678345, avg_entr 0.11309269070625305, f1 0.8812000155448914
ep28_l0_test_time 0.7786574363708496
Test Epoch28 layer1 Acc 0.8818, AUC 0.9474667310714722, avg_entr 0.09140388667583466, f1 0.8818000555038452
ep28_l1_test_time 0.7674801349639893
Test Epoch28 layer2 Acc 0.881, AUC 0.9477581977844238, avg_entr 0.06509335339069366, f1 0.8809999823570251
ep28_l2_test_time 0.7739863395690918
Test Epoch28 layer3 Acc 0.8814, AUC 0.944780170917511, avg_entr 0.030951503664255142, f1 0.8813999891281128
ep28_l3_test_time 0.7954096794128418
Test Epoch28 layer4 Acc 0.8814, AUC 0.9453796148300171, avg_entr 0.022378552705049515, f1 0.8813999891281128
ep28_l4_test_time 0.7682173252105713
gc 0
Train Epoch29 Acc 0.974425 (38977/40000), AUC 0.9963481426239014
ep29_train_time 11.0183687210083
Test Epoch29 layer0 Acc 0.8794, AUC 0.9461309909820557, avg_entr 0.11336009204387665, f1 0.8794000148773193
ep29_l0_test_time 0.7625722885131836
Test Epoch29 layer1 Acc 0.881, AUC 0.9474474191665649, avg_entr 0.09159520268440247, f1 0.8809999823570251
ep29_l1_test_time 0.7730007171630859
Test Epoch29 layer2 Acc 0.8808, AUC 0.9477406144142151, avg_entr 0.06534892320632935, f1 0.8808000087738037
ep29_l2_test_time 0.7946701049804688
Test Epoch29 layer3 Acc 0.8814, AUC 0.9448890686035156, avg_entr 0.031367283314466476, f1 0.8813999891281128
ep29_l3_test_time 0.7786076068878174
Test Epoch29 layer4 Acc 0.8814, AUC 0.9453244209289551, avg_entr 0.02286285161972046, f1 0.8813999891281128
ep29_l4_test_time 0.7835452556610107
Best AUC tensor(0.8988)
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 454.09803891181946
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8918, AUC 0.9533379673957825, avg_entr 0.15568582713603973, f1 0.8917999863624573
l0_test_time 0.7776648998260498
Test layer1 Acc 0.8914, AUC 0.9540086984634399, avg_entr 0.1313001662492752, f1 0.8913999795913696
l1_test_time 0.7761068344116211
Test layer2 Acc 0.8902, AUC 0.9547253847122192, avg_entr 0.11509782820940018, f1 0.8902000188827515
l2_test_time 0.7678067684173584
Test layer3 Acc 0.8914, AUC 0.9554429650306702, avg_entr 0.07805518060922623, f1 0.8913999795913696
l3_test_time 0.7781381607055664
Test layer4 Acc 0.8904, AUC 0.952629804611206, avg_entr 0.04998327046632767, f1 0.8903999924659729
l4_test_time 0.7838847637176514
