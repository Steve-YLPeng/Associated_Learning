total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.94244623184204
Start Training
gc 0
Train Epoch0 Acc 0.509975 (20399/40000), AUC 0.5158936977386475
ep0_train_time 153.73321104049683
Test Epoch0 layer0 Acc 0.8164, AUC 0.8965779542922974, avg_entr 0.5518574714660645, f1 0.8164000511169434
ep0_l0_test_time 0.7764389514923096
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6116, AUC 0.6669487953186035, avg_entr 0.6548354029655457, f1 0.6115999817848206
ep0_l1_test_time 1.7620973587036133
Test Epoch0 layer2 Acc 0.64, AUC 0.6950192451477051, avg_entr 0.6611484289169312, f1 0.6399999856948853
ep0_l2_test_time 2.9467501640319824
Test Epoch0 layer3 Acc 0.6092, AUC 0.7148778438568115, avg_entr 0.6635919213294983, f1 0.6092000007629395
ep0_l3_test_time 4.210249900817871
Test Epoch0 layer4 Acc 0.6276, AUC 0.7727224826812744, avg_entr 0.6488842964172363, f1 0.6276000142097473
ep0_l4_test_time 5.483163118362427
gc 0
Train Epoch1 Acc 0.808025 (32321/40000), AUC 0.8665469884872437
ep1_train_time 153.2471375465393
Test Epoch1 layer0 Acc 0.8808, AUC 0.9465535879135132, avg_entr 0.28687480092048645, f1 0.8808000087738037
ep1_l0_test_time 0.7673120498657227
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8324, AUC 0.8984214663505554, avg_entr 0.20381397008895874, f1 0.8324000239372253
ep1_l1_test_time 1.7636940479278564
Test Epoch1 layer2 Acc 0.842, AUC 0.9121103286743164, avg_entr 0.12261103838682175, f1 0.8420000076293945
ep1_l2_test_time 2.9353129863739014
Test Epoch1 layer3 Acc 0.8414, AUC 0.913318932056427, avg_entr 0.11369514465332031, f1 0.8414000272750854
ep1_l3_test_time 4.1409382820129395
Test Epoch1 layer4 Acc 0.843, AUC 0.9133882522583008, avg_entr 0.11372578144073486, f1 0.8429999947547913
ep1_l4_test_time 5.3333680629730225
gc 0
Train Epoch2 Acc 0.889125 (35565/40000), AUC 0.9402374029159546
ep2_train_time 153.5435070991516
Test Epoch2 layer0 Acc 0.8872, AUC 0.9556002616882324, avg_entr 0.2244509756565094, f1 0.8871999979019165
ep2_l0_test_time 0.760911226272583
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8654, AUC 0.9365663528442383, avg_entr 0.08475879579782486, f1 0.865399956703186
ep2_l1_test_time 1.760606288909912
Test Epoch2 layer2 Acc 0.8596, AUC 0.9383468627929688, avg_entr 0.0755421593785286, f1 0.8596000075340271
ep2_l2_test_time 2.874919891357422
Test Epoch2 layer3 Acc 0.8586, AUC 0.9394370317459106, avg_entr 0.06961371749639511, f1 0.8586000204086304
ep2_l3_test_time 4.053730010986328
Test Epoch2 layer4 Acc 0.8556, AUC 0.9394879341125488, avg_entr 0.07556761801242828, f1 0.8555999994277954
ep2_l4_test_time 4.682231903076172
gc 0
Train Epoch3 Acc 0.916925 (36677/40000), AUC 0.9630309343338013
ep3_train_time 136.21341514587402
Test Epoch3 layer0 Acc 0.8966, AUC 0.958297848701477, avg_entr 0.19693611562252045, f1 0.8966000080108643
ep3_l0_test_time 0.7593157291412354
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8848, AUC 0.9484065771102905, avg_entr 0.07469860464334488, f1 0.8848000168800354
ep3_l1_test_time 1.7677152156829834
Test Epoch3 layer2 Acc 0.8884, AUC 0.9494307041168213, avg_entr 0.05735431984066963, f1 0.8884000182151794
ep3_l2_test_time 2.899768590927124
Test Epoch3 layer3 Acc 0.886, AUC 0.9500217437744141, avg_entr 0.0540485605597496, f1 0.8859999775886536
ep3_l3_test_time 4.140209913253784
Test Epoch3 layer4 Acc 0.885, AUC 0.9493629336357117, avg_entr 0.055308252573013306, f1 0.8849999904632568
ep3_l4_test_time 5.35591983795166
gc 0
Train Epoch4 Acc 0.935075 (37403/40000), AUC 0.9757640957832336
ep4_train_time 153.8137662410736
Test Epoch4 layer0 Acc 0.8982, AUC 0.9590154886245728, avg_entr 0.18047618865966797, f1 0.8981999754905701
ep4_l0_test_time 0.7689833641052246
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8874, AUC 0.9478169679641724, avg_entr 0.0469682477414608, f1 0.8873999714851379
ep4_l1_test_time 1.7664132118225098
Test Epoch4 layer2 Acc 0.8898, AUC 0.9476381540298462, avg_entr 0.036852769553661346, f1 0.8898000121116638
ep4_l2_test_time 2.890747308731079
Test Epoch4 layer3 Acc 0.8892, AUC 0.9482487440109253, avg_entr 0.0353425033390522, f1 0.88919997215271
ep4_l3_test_time 4.175682544708252
Test Epoch4 layer4 Acc 0.8882, AUC 0.9475390315055847, avg_entr 0.039798565208911896, f1 0.888200044631958
ep4_l4_test_time 5.285016298294067
gc 0
Train Epoch5 Acc 0.938175 (37527/40000), AUC 0.978270411491394
ep5_train_time 153.62058472633362
Test Epoch5 layer0 Acc 0.8874, AUC 0.9581120610237122, avg_entr 0.16295871138572693, f1 0.8873999714851379
ep5_l0_test_time 0.7694253921508789
Test Epoch5 layer1 Acc 0.8856, AUC 0.9472777843475342, avg_entr 0.04689890891313553, f1 0.8855999708175659
ep5_l1_test_time 1.751988410949707
Test Epoch5 layer2 Acc 0.887, AUC 0.9470605850219727, avg_entr 0.0368669368326664, f1 0.8870000243186951
ep5_l2_test_time 2.910393714904785
Test Epoch5 layer3 Acc 0.8868, AUC 0.947415828704834, avg_entr 0.03449452295899391, f1 0.8867999911308289
ep5_l3_test_time 4.168773889541626
Test Epoch5 layer4 Acc 0.8866, AUC 0.9469136595726013, avg_entr 0.03592963516712189, f1 0.8866000771522522
ep5_l4_test_time 5.569742202758789
gc 0
Train Epoch6 Acc 0.95095 (38038/40000), AUC 0.986714243888855
ep6_train_time 153.16690349578857
Test Epoch6 layer0 Acc 0.888, AUC 0.9564240574836731, avg_entr 0.15108852088451385, f1 0.8880000114440918
ep6_l0_test_time 0.7872107028961182
Test Epoch6 layer1 Acc 0.8836, AUC 0.9466736316680908, avg_entr 0.04236876219511032, f1 0.8835999965667725
ep6_l1_test_time 1.7371904850006104
Test Epoch6 layer2 Acc 0.8844, AUC 0.9465476870536804, avg_entr 0.032290685921907425, f1 0.8844000101089478
ep6_l2_test_time 2.8973944187164307
Test Epoch6 layer3 Acc 0.8838, AUC 0.9471520185470581, avg_entr 0.03048466145992279, f1 0.8838000297546387
ep6_l3_test_time 4.138546943664551
Test Epoch6 layer4 Acc 0.8846, AUC 0.9468228816986084, avg_entr 0.031839899718761444, f1 0.8845999836921692
ep6_l4_test_time 5.297822713851929
gc 0
Train Epoch7 Acc 0.9561 (38244/40000), AUC 0.9887906312942505
ep7_train_time 153.60841631889343
Test Epoch7 layer0 Acc 0.8926, AUC 0.9552110433578491, avg_entr 0.14336003363132477, f1 0.8925999999046326
ep7_l0_test_time 0.776663064956665
Test Epoch7 layer1 Acc 0.881, AUC 0.9456024169921875, avg_entr 0.03887531906366348, f1 0.8809999823570251
ep7_l1_test_time 1.7614121437072754
Test Epoch7 layer2 Acc 0.8808, AUC 0.9453920125961304, avg_entr 0.030153198167681694, f1 0.8808000087738037
ep7_l2_test_time 2.9126064777374268
Test Epoch7 layer3 Acc 0.8814, AUC 0.9456345438957214, avg_entr 0.029096435755491257, f1 0.8813999891281128
ep7_l3_test_time 4.161767244338989
Test Epoch7 layer4 Acc 0.8824, AUC 0.945219874382019, avg_entr 0.032265178859233856, f1 0.8823999762535095
ep7_l4_test_time 5.365405559539795
gc 0
Train Epoch8 Acc 0.960775 (38431/40000), AUC 0.9913879632949829
ep8_train_time 153.44914031028748
Test Epoch8 layer0 Acc 0.891, AUC 0.9533467292785645, avg_entr 0.14022807776927948, f1 0.890999972820282
ep8_l0_test_time 0.7896728515625
Test Epoch8 layer1 Acc 0.8768, AUC 0.9427688121795654, avg_entr 0.03302453085780144, f1 0.876800000667572
ep8_l1_test_time 1.7440483570098877
Test Epoch8 layer2 Acc 0.8758, AUC 0.9422687888145447, avg_entr 0.025968581438064575, f1 0.8758000135421753
ep8_l2_test_time 2.936441659927368
Test Epoch8 layer3 Acc 0.875, AUC 0.9424374103546143, avg_entr 0.02520405501127243, f1 0.875
ep8_l3_test_time 4.161309719085693
Test Epoch8 layer4 Acc 0.8752, AUC 0.9418661594390869, avg_entr 0.026741620153188705, f1 0.8751999735832214
ep8_l4_test_time 5.378530502319336
gc 0
Train Epoch9 Acc 0.965325 (38613/40000), AUC 0.9926823377609253
ep9_train_time 153.4595911502838
Test Epoch9 layer0 Acc 0.8914, AUC 0.9523617029190063, avg_entr 0.13636000454425812, f1 0.8913999795913696
ep9_l0_test_time 0.7597932815551758
Test Epoch9 layer1 Acc 0.878, AUC 0.9410122632980347, avg_entr 0.036311689764261246, f1 0.878000020980835
ep9_l1_test_time 1.7518343925476074
Test Epoch9 layer2 Acc 0.876, AUC 0.9407919645309448, avg_entr 0.028203057125210762, f1 0.8760000467300415
ep9_l2_test_time 2.894869565963745
Test Epoch9 layer3 Acc 0.8768, AUC 0.9409487247467041, avg_entr 0.027252454310655594, f1 0.876800000667572
ep9_l3_test_time 4.133033514022827
Test Epoch9 layer4 Acc 0.8752, AUC 0.9405446648597717, avg_entr 0.028601299971342087, f1 0.8751999735832214
ep9_l4_test_time 5.332357406616211
gc 0
Train Epoch10 Acc 0.9671 (38684/40000), AUC 0.993606686592102
ep10_train_time 153.4347996711731
Test Epoch10 layer0 Acc 0.888, AUC 0.9509016275405884, avg_entr 0.1316285878419876, f1 0.8880000114440918
ep10_l0_test_time 0.7639286518096924
Test Epoch10 layer1 Acc 0.8738, AUC 0.9396164417266846, avg_entr 0.037245556712150574, f1 0.8737999796867371
ep10_l1_test_time 1.760171890258789
Test Epoch10 layer2 Acc 0.8744, AUC 0.9395062923431396, avg_entr 0.02779487892985344, f1 0.8744000792503357
ep10_l2_test_time 2.944175958633423
Test Epoch10 layer3 Acc 0.874, AUC 0.940106213092804, avg_entr 0.026483993977308273, f1 0.8740000128746033
ep10_l3_test_time 4.207086086273193
Test Epoch10 layer4 Acc 0.8726, AUC 0.9397886991500854, avg_entr 0.028399795293807983, f1 0.8726000189781189
ep10_l4_test_time 5.554480314254761
gc 0
Train Epoch11 Acc 0.967825 (38713/40000), AUC 0.9936392307281494
ep11_train_time 153.30135774612427
Test Epoch11 layer0 Acc 0.884, AUC 0.949953556060791, avg_entr 0.1288999319076538, f1 0.8840000033378601
ep11_l0_test_time 0.7726588249206543
Test Epoch11 layer1 Acc 0.8716, AUC 0.9379627704620361, avg_entr 0.035865601152181625, f1 0.8715999722480774
ep11_l1_test_time 1.7514145374298096
Test Epoch11 layer2 Acc 0.8722, AUC 0.9378100633621216, avg_entr 0.026887841522693634, f1 0.872200071811676
ep11_l2_test_time 2.9067063331604004
Test Epoch11 layer3 Acc 0.873, AUC 0.9386278390884399, avg_entr 0.025930022820830345, f1 0.8730000257492065
ep11_l3_test_time 4.1382598876953125
Test Epoch11 layer4 Acc 0.8718, AUC 0.9384734630584717, avg_entr 0.027369646355509758, f1 0.8718000650405884
ep11_l4_test_time 5.312068700790405
gc 0
Train Epoch12 Acc 0.9698 (38792/40000), AUC 0.9948093891143799
ep12_train_time 153.44040417671204
Test Epoch12 layer0 Acc 0.879, AUC 0.9488036632537842, avg_entr 0.12600256502628326, f1 0.8790000081062317
ep12_l0_test_time 0.7710826396942139
Test Epoch12 layer1 Acc 0.8748, AUC 0.9382063150405884, avg_entr 0.028046080842614174, f1 0.8748000264167786
ep12_l1_test_time 1.7505145072937012
Test Epoch12 layer2 Acc 0.8744, AUC 0.9379849433898926, avg_entr 0.021171852946281433, f1 0.8744000792503357
ep12_l2_test_time 2.8873937129974365
Test Epoch12 layer3 Acc 0.8758, AUC 0.9384883046150208, avg_entr 0.020629022270441055, f1 0.8758000135421753
ep12_l3_test_time 4.170676946640015
Test Epoch12 layer4 Acc 0.8754, AUC 0.9382566213607788, avg_entr 0.022046051919460297, f1 0.8754000067710876
ep12_l4_test_time 5.332350015640259
gc 0
Train Epoch13 Acc 0.971675 (38867/40000), AUC 0.9952989220619202
ep13_train_time 153.54769086837769
Test Epoch13 layer0 Acc 0.8846, AUC 0.9486060738563538, avg_entr 0.12755747139453888, f1 0.8845999836921692
ep13_l0_test_time 0.7679855823516846
Test Epoch13 layer1 Acc 0.8744, AUC 0.9375133514404297, avg_entr 0.026975542306900024, f1 0.8744000792503357
ep13_l1_test_time 1.7457032203674316
Test Epoch13 layer2 Acc 0.8734, AUC 0.9372894763946533, avg_entr 0.02009177766740322, f1 0.8733999729156494
ep13_l2_test_time 2.927851915359497
Test Epoch13 layer3 Acc 0.8738, AUC 0.9379432201385498, avg_entr 0.019409319385886192, f1 0.8737999796867371
ep13_l3_test_time 4.1735546588897705
Test Epoch13 layer4 Acc 0.8746, AUC 0.937842845916748, avg_entr 0.020584257319569588, f1 0.8745999932289124
ep13_l4_test_time 5.3316755294799805
gc 0
Train Epoch14 Acc 0.972425 (38897/40000), AUC 0.9954884052276611
ep14_train_time 153.200199842453
Test Epoch14 layer0 Acc 0.8842, AUC 0.9479697942733765, avg_entr 0.1262219399213791, f1 0.8842000365257263
ep14_l0_test_time 0.7512729167938232
Test Epoch14 layer1 Acc 0.8714, AUC 0.9351624250411987, avg_entr 0.024920154362916946, f1 0.871399998664856
ep14_l1_test_time 1.7719359397888184
Test Epoch14 layer2 Acc 0.8714, AUC 0.9350103139877319, avg_entr 0.017981400713324547, f1 0.871399998664856
ep14_l2_test_time 2.902848243713379
Test Epoch14 layer3 Acc 0.8708, AUC 0.9357995986938477, avg_entr 0.017325101420283318, f1 0.8708000183105469
ep14_l3_test_time 4.160767555236816
Test Epoch14 layer4 Acc 0.871, AUC 0.9356746077537537, avg_entr 0.018677784129977226, f1 0.8709999918937683
ep14_l4_test_time 5.3751068115234375
gc 0
Train Epoch15 Acc 0.973875 (38955/40000), AUC 0.9958049058914185
ep15_train_time 153.2032597064972
Test Epoch15 layer0 Acc 0.8834, AUC 0.9473510384559631, avg_entr 0.12438049167394638, f1 0.8834000825881958
ep15_l0_test_time 0.7575857639312744
Test Epoch15 layer1 Acc 0.8716, AUC 0.9340747594833374, avg_entr 0.02259873040020466, f1 0.8715999722480774
ep15_l1_test_time 1.7525312900543213
Test Epoch15 layer2 Acc 0.8716, AUC 0.9338859915733337, avg_entr 0.01661544479429722, f1 0.8715999722480774
ep15_l2_test_time 2.924826145172119
Test Epoch15 layer3 Acc 0.872, AUC 0.9348393082618713, avg_entr 0.016313867643475533, f1 0.871999979019165
ep15_l3_test_time 4.194849967956543
Test Epoch15 layer4 Acc 0.8716, AUC 0.9347444772720337, avg_entr 0.017694829031825066, f1 0.8715999722480774
ep15_l4_test_time 5.5352394580841064
gc 0
Train Epoch16 Acc 0.97425 (38970/40000), AUC 0.9960434436798096
ep16_train_time 153.45906519889832
Test Epoch16 layer0 Acc 0.8814, AUC 0.9466249346733093, avg_entr 0.12225058674812317, f1 0.8813999891281128
ep16_l0_test_time 0.7725911140441895
Test Epoch16 layer1 Acc 0.8698, AUC 0.9342256188392639, avg_entr 0.02538871578872204, f1 0.8697999715805054
ep16_l1_test_time 1.7460823059082031
Test Epoch16 layer2 Acc 0.8702, AUC 0.9339842796325684, avg_entr 0.018446145579218864, f1 0.870199978351593
ep16_l2_test_time 2.915087938308716
Test Epoch16 layer3 Acc 0.8704, AUC 0.934955358505249, avg_entr 0.017697317525744438, f1 0.8704000115394592
ep16_l3_test_time 4.167936325073242
Test Epoch16 layer4 Acc 0.8694, AUC 0.9347885847091675, avg_entr 0.01870780624449253, f1 0.8694000244140625
ep16_l4_test_time 5.323029518127441
gc 0
Train Epoch17 Acc 0.97535 (39014/40000), AUC 0.9963198900222778
ep17_train_time 153.0497531890869
Test Epoch17 layer0 Acc 0.8814, AUC 0.9463901519775391, avg_entr 0.1213957890868187, f1 0.8813999891281128
ep17_l0_test_time 0.7763826847076416
Test Epoch17 layer1 Acc 0.871, AUC 0.9356825351715088, avg_entr 0.02802906185388565, f1 0.8709999918937683
ep17_l1_test_time 1.779686689376831
Test Epoch17 layer2 Acc 0.8722, AUC 0.9354202747344971, avg_entr 0.02140411175787449, f1 0.872200071811676
ep17_l2_test_time 2.9156923294067383
Test Epoch17 layer3 Acc 0.8716, AUC 0.9361263513565063, avg_entr 0.021005934104323387, f1 0.8715999722480774
ep17_l3_test_time 4.133653402328491
Test Epoch17 layer4 Acc 0.8722, AUC 0.9359914064407349, avg_entr 0.022097760811448097, f1 0.872200071811676
ep17_l4_test_time 5.381261825561523
gc 0
Train Epoch18 Acc 0.975175 (39007/40000), AUC 0.9963634014129639
ep18_train_time 153.13218545913696
Test Epoch18 layer0 Acc 0.8812, AUC 0.9460526704788208, avg_entr 0.1198134794831276, f1 0.8812000155448914
ep18_l0_test_time 0.7565557956695557
Test Epoch18 layer1 Acc 0.8688, AUC 0.9330894351005554, avg_entr 0.025881076231598854, f1 0.8687999844551086
ep18_l1_test_time 1.7515029907226562
Test Epoch18 layer2 Acc 0.869, AUC 0.932823657989502, avg_entr 0.019566748291254044, f1 0.8690000176429749
ep18_l2_test_time 2.9051387310028076
Test Epoch18 layer3 Acc 0.8694, AUC 0.9341586828231812, avg_entr 0.019033918157219887, f1 0.8694000244140625
ep18_l3_test_time 4.159766435623169
Test Epoch18 layer4 Acc 0.8688, AUC 0.9339172840118408, avg_entr 0.020341189578175545, f1 0.8687999844551086
ep18_l4_test_time 5.384680986404419
gc 0
Train Epoch19 Acc 0.975925 (39037/40000), AUC 0.9963928461074829
ep19_train_time 153.4286334514618
Test Epoch19 layer0 Acc 0.8816, AUC 0.9457604885101318, avg_entr 0.11904000490903854, f1 0.881600022315979
ep19_l0_test_time 0.7637825012207031
Test Epoch19 layer1 Acc 0.8676, AUC 0.9336473941802979, avg_entr 0.02557193674147129, f1 0.8675999641418457
ep19_l1_test_time 1.7324473857879639
Test Epoch19 layer2 Acc 0.8692, AUC 0.9334867000579834, avg_entr 0.019282720983028412, f1 0.8691999912261963
ep19_l2_test_time 2.920210123062134
Test Epoch19 layer3 Acc 0.8692, AUC 0.9345263838768005, avg_entr 0.018750473856925964, f1 0.8691999912261963
ep19_l3_test_time 4.1689653396606445
Test Epoch19 layer4 Acc 0.869, AUC 0.9343841671943665, avg_entr 0.01986749656498432, f1 0.8690000176429749
ep19_l4_test_time 5.384321689605713
gc 0
Train Epoch20 Acc 0.97595 (39038/40000), AUC 0.9965988397598267
ep20_train_time 153.08830404281616
Test Epoch20 layer0 Acc 0.8802, AUC 0.945407509803772, avg_entr 0.11840181797742844, f1 0.8802000284194946
ep20_l0_test_time 0.7635421752929688
Test Epoch20 layer1 Acc 0.8688, AUC 0.9333382248878479, avg_entr 0.024436330422759056, f1 0.8687999844551086
ep20_l1_test_time 1.7541613578796387
Test Epoch20 layer2 Acc 0.87, AUC 0.9331348538398743, avg_entr 0.01777656562626362, f1 0.8700000047683716
ep20_l2_test_time 2.9022297859191895
Test Epoch20 layer3 Acc 0.8704, AUC 0.9341657161712646, avg_entr 0.017154131084680557, f1 0.8704000115394592
ep20_l3_test_time 4.197120904922485
Test Epoch20 layer4 Acc 0.869, AUC 0.9340404272079468, avg_entr 0.017871523275971413, f1 0.8690000176429749
ep20_l4_test_time 5.456135034561157
gc 0
Train Epoch21 Acc 0.9766 (39064/40000), AUC 0.9966427087783813
ep21_train_time 153.23791480064392
Test Epoch21 layer0 Acc 0.8798, AUC 0.9453845024108887, avg_entr 0.11866685748100281, f1 0.879800021648407
ep21_l0_test_time 0.7586619853973389
Test Epoch21 layer1 Acc 0.8676, AUC 0.9328610897064209, avg_entr 0.02460256591439247, f1 0.8675999641418457
ep21_l1_test_time 1.7478177547454834
Test Epoch21 layer2 Acc 0.8682, AUC 0.932642936706543, avg_entr 0.01859968528151512, f1 0.8682000041007996
ep21_l2_test_time 2.8919219970703125
Test Epoch21 layer3 Acc 0.8684, AUC 0.933901309967041, avg_entr 0.017878780141472816, f1 0.868399977684021
ep21_l3_test_time 4.160416603088379
Test Epoch21 layer4 Acc 0.8682, AUC 0.9337105751037598, avg_entr 0.01872839406132698, f1 0.8682000041007996
ep21_l4_test_time 5.358151197433472
gc 0
Train Epoch22 Acc 0.976875 (39075/40000), AUC 0.9967191815376282
ep22_train_time 153.45299744606018
Test Epoch22 layer0 Acc 0.8794, AUC 0.9452196359634399, avg_entr 0.11815029382705688, f1 0.8794000148773193
ep22_l0_test_time 0.7914021015167236
Test Epoch22 layer1 Acc 0.8678, AUC 0.9331269264221191, avg_entr 0.02418108470737934, f1 0.8677999973297119
ep22_l1_test_time 1.7529628276824951
Test Epoch22 layer2 Acc 0.8696, AUC 0.9329860806465149, avg_entr 0.017522308975458145, f1 0.8695999383926392
ep22_l2_test_time 2.8827505111694336
Test Epoch22 layer3 Acc 0.8694, AUC 0.9340900778770447, avg_entr 0.01698972098529339, f1 0.8694000244140625
ep22_l3_test_time 4.196952819824219
Test Epoch22 layer4 Acc 0.8696, AUC 0.9339876770973206, avg_entr 0.017962900921702385, f1 0.8695999383926392
ep22_l4_test_time 5.3671653270721436
gc 0
Train Epoch23 Acc 0.9767 (39068/40000), AUC 0.9967161417007446
ep23_train_time 153.2545382976532
Test Epoch23 layer0 Acc 0.8792, AUC 0.9450928568840027, avg_entr 0.11750942468643188, f1 0.8791999816894531
ep23_l0_test_time 0.7683160305023193
Test Epoch23 layer1 Acc 0.8684, AUC 0.9334436655044556, avg_entr 0.02504758909344673, f1 0.868399977684021
ep23_l1_test_time 1.7454373836517334
Test Epoch23 layer2 Acc 0.8698, AUC 0.9332104921340942, avg_entr 0.018635349348187447, f1 0.8697999715805054
ep23_l2_test_time 2.905010461807251
Test Epoch23 layer3 Acc 0.87, AUC 0.9342483282089233, avg_entr 0.017971457913517952, f1 0.8700000047683716
ep23_l3_test_time 4.172072887420654
Test Epoch23 layer4 Acc 0.8696, AUC 0.9341275095939636, avg_entr 0.018916219472885132, f1 0.8695999383926392
ep23_l4_test_time 5.395381927490234
gc 0
Train Epoch24 Acc 0.9768 (39072/40000), AUC 0.9967674016952515
ep24_train_time 153.24368691444397
Test Epoch24 layer0 Acc 0.8802, AUC 0.9449310302734375, avg_entr 0.11573775857686996, f1 0.8802000284194946
ep24_l0_test_time 0.7642979621887207
Test Epoch24 layer1 Acc 0.8684, AUC 0.9331907629966736, avg_entr 0.024500809609889984, f1 0.868399977684021
ep24_l1_test_time 1.7579994201660156
Test Epoch24 layer2 Acc 0.8688, AUC 0.9329774379730225, avg_entr 0.01812734454870224, f1 0.8687999844551086
ep24_l2_test_time 2.9206674098968506
Test Epoch24 layer3 Acc 0.869, AUC 0.9340810775756836, avg_entr 0.017672497779130936, f1 0.8690000176429749
ep24_l3_test_time 4.135355472564697
Test Epoch24 layer4 Acc 0.8692, AUC 0.933994710445404, avg_entr 0.018635299056768417, f1 0.8691999912261963
ep24_l4_test_time 5.386477708816528
gc 0
Train Epoch25 Acc 0.977 (39080/40000), AUC 0.9968651533126831
ep25_train_time 153.58352661132812
Test Epoch25 layer0 Acc 0.8786, AUC 0.9448699951171875, avg_entr 0.11624040454626083, f1 0.878600001335144
ep25_l0_test_time 0.7562322616577148
Test Epoch25 layer1 Acc 0.869, AUC 0.9330229759216309, avg_entr 0.02435535192489624, f1 0.8690000176429749
ep25_l1_test_time 1.7490451335906982
Test Epoch25 layer2 Acc 0.8686, AUC 0.9328248500823975, avg_entr 0.017881082370877266, f1 0.8686000108718872
ep25_l2_test_time 2.9198570251464844
Test Epoch25 layer3 Acc 0.8686, AUC 0.9339505434036255, avg_entr 0.01738080196082592, f1 0.8686000108718872
ep25_l3_test_time 4.1728551387786865
Test Epoch25 layer4 Acc 0.8692, AUC 0.9338495135307312, avg_entr 0.018237849697470665, f1 0.8691999912261963
ep25_l4_test_time 5.56147837638855
gc 0
Train Epoch26 Acc 0.977075 (39083/40000), AUC 0.9968377351760864
ep26_train_time 153.40970730781555
Test Epoch26 layer0 Acc 0.8794, AUC 0.9448103308677673, avg_entr 0.11571479588747025, f1 0.8794000148773193
ep26_l0_test_time 0.7587578296661377
Test Epoch26 layer1 Acc 0.8682, AUC 0.9328365325927734, avg_entr 0.023930294439196587, f1 0.8682000041007996
ep26_l1_test_time 1.7556743621826172
Test Epoch26 layer2 Acc 0.869, AUC 0.9326873421669006, avg_entr 0.01757422648370266, f1 0.8690000176429749
ep26_l2_test_time 2.8881843090057373
Test Epoch26 layer3 Acc 0.868, AUC 0.9338346123695374, avg_entr 0.017075523734092712, f1 0.8679999709129333
ep26_l3_test_time 4.108505725860596
Test Epoch26 layer4 Acc 0.8682, AUC 0.9337337017059326, avg_entr 0.01799841597676277, f1 0.8682000041007996
ep26_l4_test_time 5.368980169296265
gc 0
Train Epoch27 Acc 0.97705 (39082/40000), AUC 0.9968708753585815
ep27_train_time 153.23752427101135
Test Epoch27 layer0 Acc 0.8782, AUC 0.9447420239448547, avg_entr 0.11545813083648682, f1 0.8781999945640564
ep27_l0_test_time 0.7551124095916748
Test Epoch27 layer1 Acc 0.8678, AUC 0.9330141544342041, avg_entr 0.02375127747654915, f1 0.8677999973297119
ep27_l1_test_time 1.7563304901123047
Test Epoch27 layer2 Acc 0.8692, AUC 0.9327436685562134, avg_entr 0.017612256109714508, f1 0.8691999912261963
ep27_l2_test_time 2.9021739959716797
Test Epoch27 layer3 Acc 0.8688, AUC 0.9339345693588257, avg_entr 0.0170710701495409, f1 0.8687999844551086
ep27_l3_test_time 4.193030834197998
Test Epoch27 layer4 Acc 0.8692, AUC 0.9338259696960449, avg_entr 0.01802881807088852, f1 0.8691999912261963
ep27_l4_test_time 5.38988733291626
gc 0
Train Epoch28 Acc 0.97735 (39094/40000), AUC 0.9969141483306885
ep28_train_time 153.47193884849548
Test Epoch28 layer0 Acc 0.879, AUC 0.9446698427200317, avg_entr 0.11477194726467133, f1 0.8790000081062317
ep28_l0_test_time 0.7766375541687012
Test Epoch28 layer1 Acc 0.868, AUC 0.9329427480697632, avg_entr 0.02387409284710884, f1 0.8679999709129333
ep28_l1_test_time 1.7635481357574463
Test Epoch28 layer2 Acc 0.8688, AUC 0.9327476024627686, avg_entr 0.0176448542624712, f1 0.8687999844551086
ep28_l2_test_time 2.881624698638916
Test Epoch28 layer3 Acc 0.868, AUC 0.9338890314102173, avg_entr 0.01714577153325081, f1 0.8679999709129333
ep28_l3_test_time 4.133940696716309
Test Epoch28 layer4 Acc 0.8684, AUC 0.9338116645812988, avg_entr 0.017845503985881805, f1 0.868399977684021
ep28_l4_test_time 5.3304057121276855
gc 0
Train Epoch29 Acc 0.9775 (39100/40000), AUC 0.9969264268875122
ep29_train_time 153.21117687225342
Test Epoch29 layer0 Acc 0.879, AUC 0.9446444511413574, avg_entr 0.11457064002752304, f1 0.8790000081062317
ep29_l0_test_time 0.7684659957885742
Test Epoch29 layer1 Acc 0.8674, AUC 0.9327973127365112, avg_entr 0.02335595153272152, f1 0.8673999905586243
ep29_l1_test_time 1.7516324520111084
Test Epoch29 layer2 Acc 0.8688, AUC 0.9324727654457092, avg_entr 0.017392795532941818, f1 0.8687999844551086
ep29_l2_test_time 2.922271251678467
Test Epoch29 layer3 Acc 0.8686, AUC 0.9337531924247742, avg_entr 0.016802821308374405, f1 0.8686000108718872
ep29_l3_test_time 4.142688274383545
Test Epoch29 layer4 Acc 0.8686, AUC 0.9336179494857788, avg_entr 0.017755670472979546, f1 0.8686000108718872
ep29_l4_test_time 5.367660999298096
Best AUC tensor(0.8982)
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 5034.6836812496185
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8936, AUC 0.9560721516609192, avg_entr 0.1810368150472641, f1 0.8935999870300293
l0_test_time 0.7550575733184814
Test layer1 Acc 0.8834, AUC 0.9427685737609863, avg_entr 0.05059235543012619, f1 0.8834000825881958
l1_test_time 1.76810884475708
Test layer2 Acc 0.8838, AUC 0.9436761736869812, avg_entr 0.03975073993206024, f1 0.8838000297546387
l2_test_time 2.8952767848968506
Test layer3 Acc 0.884, AUC 0.9438413381576538, avg_entr 0.03814619407057762, f1 0.8840000033378601
l3_test_time 4.153686046600342
Test layer4 Acc 0.8842, AUC 0.9441009163856506, avg_entr 0.042570050805807114, f1 0.8842000365257263
l4_test_time 5.3856284618377686
