total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.68467402458191
Start Training
gc 0
Train Epoch0 Acc 0.551 (22040/40000), AUC 0.5777562856674194
ep0_train_time 8.287879943847656
Test Epoch0 layer0 Acc 0.8138, AUC 0.8946902751922607, avg_entr 0.40903350710868835, f1 0.8137999773025513
ep0_l0_test_time 0.3280956745147705
Save ckpt to ckpt/imdb_linearal_l5_pad100//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7836, AUC 0.8804617524147034, avg_entr 0.6485040783882141, f1 0.7835999727249146
ep0_l1_test_time 0.3199446201324463
Test Epoch0 layer2 Acc 0.7852, AUC 0.882331132888794, avg_entr 0.6261928677558899, f1 0.7851999998092651
ep0_l2_test_time 0.3133566379547119
Test Epoch0 layer3 Acc 0.799, AUC 0.8849589824676514, avg_entr 0.5873768329620361, f1 0.7990000247955322
ep0_l3_test_time 0.3302192687988281
Test Epoch0 layer4 Acc 0.787, AUC 0.8830808997154236, avg_entr 0.6008307337760925, f1 0.7870000600814819
ep0_l4_test_time 0.31500864028930664
gc 0
Train Epoch1 Acc 0.853 (34120/40000), AUC 0.9281269311904907
ep1_train_time 7.22108006477356
Test Epoch1 layer0 Acc 0.841, AUC 0.9195004105567932, avg_entr 0.26245731115341187, f1 0.8410000205039978
ep1_l0_test_time 0.3177947998046875
Save ckpt to ckpt/imdb_linearal_l5_pad100//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8392, AUC 0.9187695384025574, avg_entr 0.267993688583374, f1 0.8392000198364258
ep1_l1_test_time 0.3314821720123291
Test Epoch1 layer2 Acc 0.8378, AUC 0.918642520904541, avg_entr 0.24360617995262146, f1 0.8378000259399414
ep1_l2_test_time 0.3290131092071533
Test Epoch1 layer3 Acc 0.8384, AUC 0.9188261032104492, avg_entr 0.24334079027175903, f1 0.8384000658988953
ep1_l3_test_time 0.331221342086792
Test Epoch1 layer4 Acc 0.8366, AUC 0.9185454249382019, avg_entr 0.23436769843101501, f1 0.8366000056266785
ep1_l4_test_time 0.33219242095947266
gc 0
Train Epoch2 Acc 0.895475 (35819/40000), AUC 0.9601553678512573
ep2_train_time 7.233689546585083
Test Epoch2 layer0 Acc 0.8452, AUC 0.9189978837966919, avg_entr 0.21696843206882477, f1 0.8452000021934509
ep2_l0_test_time 0.3313326835632324
Save ckpt to ckpt/imdb_linearal_l5_pad100//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8462, AUC 0.9187241792678833, avg_entr 0.20702607929706573, f1 0.8461999893188477
ep2_l1_test_time 0.3317718505859375
Save ckpt to ckpt/imdb_linearal_l5_pad100//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.846, AUC 0.9186882972717285, avg_entr 0.19967731833457947, f1 0.8460000157356262
ep2_l2_test_time 0.33010172843933105
Test Epoch2 layer3 Acc 0.8408, AUC 0.918908953666687, avg_entr 0.1973196119070053, f1 0.8408000469207764
ep2_l3_test_time 0.31934046745300293
Test Epoch2 layer4 Acc 0.8368, AUC 0.9187842011451721, avg_entr 0.18612591922283173, f1 0.8368000388145447
ep2_l4_test_time 0.3280367851257324
gc 0
Train Epoch3 Acc 0.9169 (36676/40000), AUC 0.9730156660079956
ep3_train_time 7.236812353134155
Test Epoch3 layer0 Acc 0.8396, AUC 0.916865348815918, avg_entr 0.19045038521289825, f1 0.8396000266075134
ep3_l0_test_time 0.32419800758361816
Test Epoch3 layer1 Acc 0.8384, AUC 0.9165881872177124, avg_entr 0.17785991728305817, f1 0.8384000658988953
ep3_l1_test_time 0.3115499019622803
Test Epoch3 layer2 Acc 0.8398, AUC 0.9162535667419434, avg_entr 0.17600296437740326, f1 0.8398000001907349
ep3_l2_test_time 0.3156888484954834
Test Epoch3 layer3 Acc 0.842, AUC 0.9165174961090088, avg_entr 0.16988897323608398, f1 0.8420000076293945
ep3_l3_test_time 0.33041954040527344
Test Epoch3 layer4 Acc 0.8416, AUC 0.9164398908615112, avg_entr 0.1530298888683319, f1 0.8416000008583069
ep3_l4_test_time 0.3275320529937744
gc 0
Train Epoch4 Acc 0.929225 (37169/40000), AUC 0.9804846048355103
ep4_train_time 7.255453586578369
Test Epoch4 layer0 Acc 0.8334, AUC 0.9112370014190674, avg_entr 0.17645272612571716, f1 0.8334000110626221
ep4_l0_test_time 0.286196231842041
Test Epoch4 layer1 Acc 0.834, AUC 0.9109879732131958, avg_entr 0.16224220395088196, f1 0.8339999914169312
ep4_l1_test_time 0.32975292205810547
Test Epoch4 layer2 Acc 0.8334, AUC 0.9104414582252502, avg_entr 0.15681879222393036, f1 0.8334000110626221
ep4_l2_test_time 0.3306584358215332
Test Epoch4 layer3 Acc 0.8324, AUC 0.9108778834342957, avg_entr 0.13976575434207916, f1 0.8324000239372253
ep4_l3_test_time 0.32593464851379395
Test Epoch4 layer4 Acc 0.8312, AUC 0.9108753204345703, avg_entr 0.1120263934135437, f1 0.8312000632286072
ep4_l4_test_time 0.33289003372192383
gc 0
Train Epoch5 Acc 0.941825 (37673/40000), AUC 0.9853397011756897
ep5_train_time 6.939400911331177
Test Epoch5 layer0 Acc 0.827, AUC 0.9052667617797852, avg_entr 0.1633085459470749, f1 0.8270000219345093
ep5_l0_test_time 0.2891669273376465
Test Epoch5 layer1 Acc 0.8262, AUC 0.9052706956863403, avg_entr 0.14909012615680695, f1 0.826200008392334
ep5_l1_test_time 0.30347466468811035
Test Epoch5 layer2 Acc 0.823, AUC 0.9046563506126404, avg_entr 0.14576010406017303, f1 0.8230000138282776
ep5_l2_test_time 0.29835057258605957
Test Epoch5 layer3 Acc 0.8242, AUC 0.905104398727417, avg_entr 0.12111911922693253, f1 0.8241999745368958
ep5_l3_test_time 0.31453633308410645
Test Epoch5 layer4 Acc 0.8252, AUC 0.9049700498580933, avg_entr 0.08405481278896332, f1 0.8252000212669373
ep5_l4_test_time 0.32828521728515625
gc 0
Train Epoch6 Acc 0.953325 (38133/40000), AUC 0.9900198578834534
ep6_train_time 7.2229163646698
Test Epoch6 layer0 Acc 0.8238, AUC 0.9025505185127258, avg_entr 0.15862664580345154, f1 0.8238000273704529
ep6_l0_test_time 0.3124270439147949
Test Epoch6 layer1 Acc 0.8236, AUC 0.902498722076416, avg_entr 0.14404986798763275, f1 0.8235999941825867
ep6_l1_test_time 0.329958438873291
Test Epoch6 layer2 Acc 0.8214, AUC 0.9017149209976196, avg_entr 0.1395597755908966, f1 0.821399986743927
ep6_l2_test_time 0.3308906555175781
Test Epoch6 layer3 Acc 0.8224, AUC 0.9022217392921448, avg_entr 0.107685886323452, f1 0.8223999738693237
ep6_l3_test_time 0.3049805164337158
Test Epoch6 layer4 Acc 0.8216, AUC 0.8957440257072449, avg_entr 0.06512816995382309, f1 0.8216000199317932
ep6_l4_test_time 0.32938623428344727
gc 0
Train Epoch7 Acc 0.95725 (38290/40000), AUC 0.9912092685699463
ep7_train_time 7.186169147491455
Test Epoch7 layer0 Acc 0.822, AUC 0.8995314836502075, avg_entr 0.15334248542785645, f1 0.8220000267028809
ep7_l0_test_time 0.3232264518737793
Test Epoch7 layer1 Acc 0.8224, AUC 0.8995322585105896, avg_entr 0.13862013816833496, f1 0.8223999738693237
ep7_l1_test_time 0.31490302085876465
Test Epoch7 layer2 Acc 0.8206, AUC 0.8987381458282471, avg_entr 0.13414424657821655, f1 0.8205999732017517
ep7_l2_test_time 0.29582691192626953
Test Epoch7 layer3 Acc 0.8218, AUC 0.8992798328399658, avg_entr 0.09565427154302597, f1 0.8218000531196594
ep7_l3_test_time 0.316864013671875
Test Epoch7 layer4 Acc 0.8214, AUC 0.8889040946960449, avg_entr 0.05437944829463959, f1 0.821399986743927
ep7_l4_test_time 0.3265342712402344
gc 0
Train Epoch8 Acc 0.960125 (38405/40000), AUC 0.9916079640388489
ep8_train_time 7.257737874984741
Test Epoch8 layer0 Acc 0.8204, AUC 0.8959354162216187, avg_entr 0.150737926363945, f1 0.820400059223175
ep8_l0_test_time 0.3033452033996582
Test Epoch8 layer1 Acc 0.8196, AUC 0.896062433719635, avg_entr 0.13553979992866516, f1 0.8195999264717102
ep8_l1_test_time 0.30127644538879395
Test Epoch8 layer2 Acc 0.8182, AUC 0.8951753973960876, avg_entr 0.12831801176071167, f1 0.8181999921798706
ep8_l2_test_time 0.3322622776031494
Test Epoch8 layer3 Acc 0.8202, AUC 0.8957862854003906, avg_entr 0.08580350130796432, f1 0.8202000260353088
ep8_l3_test_time 0.30913639068603516
Test Epoch8 layer4 Acc 0.8202, AUC 0.8839232325553894, avg_entr 0.05081498250365257, f1 0.8202000260353088
ep8_l4_test_time 0.3250753879547119
gc 0
Train Epoch9 Acc 0.963225 (38529/40000), AUC 0.9925211668014526
ep9_train_time 7.234590530395508
Test Epoch9 layer0 Acc 0.8186, AUC 0.8929319381713867, avg_entr 0.14601074159145355, f1 0.8185999989509583
ep9_l0_test_time 0.3127317428588867
Test Epoch9 layer1 Acc 0.819, AUC 0.8930516242980957, avg_entr 0.13081344962120056, f1 0.8190000057220459
ep9_l1_test_time 0.3301403522491455
Test Epoch9 layer2 Acc 0.8174, AUC 0.8920835256576538, avg_entr 0.12410244345664978, f1 0.8173999786376953
ep9_l2_test_time 0.3298189640045166
Test Epoch9 layer3 Acc 0.8158, AUC 0.892349123954773, avg_entr 0.07595635950565338, f1 0.8158000111579895
ep9_l3_test_time 0.32089805603027344
Test Epoch9 layer4 Acc 0.8166, AUC 0.8802146911621094, avg_entr 0.04574834927916527, f1 0.8166000247001648
ep9_l4_test_time 0.32323670387268066
gc 0
Train Epoch10 Acc 0.967 (38680/40000), AUC 0.9940791130065918
ep10_train_time 7.248844861984253
Test Epoch10 layer0 Acc 0.8158, AUC 0.8909787535667419, avg_entr 0.14287807047367096, f1 0.8158000111579895
ep10_l0_test_time 0.3072521686553955
Test Epoch10 layer1 Acc 0.8168, AUC 0.8910835981369019, avg_entr 0.12782420217990875, f1 0.8167999982833862
ep10_l1_test_time 0.31805419921875
Test Epoch10 layer2 Acc 0.813, AUC 0.890042781829834, avg_entr 0.12075906991958618, f1 0.8130000233650208
ep10_l2_test_time 0.3133988380432129
Test Epoch10 layer3 Acc 0.8126, AUC 0.8895752429962158, avg_entr 0.07113668322563171, f1 0.8126000165939331
ep10_l3_test_time 0.3298027515411377
Test Epoch10 layer4 Acc 0.8132, AUC 0.8779372572898865, avg_entr 0.04350179433822632, f1 0.8131999969482422
ep10_l4_test_time 0.3279099464416504
gc 0
Train Epoch11 Acc 0.968175 (38727/40000), AUC 0.9944231510162354
ep11_train_time 7.185282230377197
Test Epoch11 layer0 Acc 0.816, AUC 0.8896615505218506, avg_entr 0.14026305079460144, f1 0.8160000443458557
ep11_l0_test_time 0.3334968090057373
Test Epoch11 layer1 Acc 0.8154, AUC 0.8897748589515686, avg_entr 0.125213161110878, f1 0.8154000043869019
ep11_l1_test_time 0.3109912872314453
Test Epoch11 layer2 Acc 0.8134, AUC 0.888739824295044, avg_entr 0.11784489452838898, f1 0.8133999109268188
ep11_l2_test_time 0.3263673782348633
Test Epoch11 layer3 Acc 0.8134, AUC 0.8867949843406677, avg_entr 0.06712492555379868, f1 0.8133999109268188
ep11_l3_test_time 0.30368971824645996
Test Epoch11 layer4 Acc 0.8136, AUC 0.875056266784668, avg_entr 0.04151744395494461, f1 0.8136000037193298
ep11_l4_test_time 0.2912778854370117
gc 0
Train Epoch12 Acc 0.96925 (38770/40000), AUC 0.9945888519287109
ep12_train_time 6.933020353317261
Test Epoch12 layer0 Acc 0.8142, AUC 0.8876391649246216, avg_entr 0.13818073272705078, f1 0.8141999840736389
ep12_l0_test_time 0.27208733558654785
Test Epoch12 layer1 Acc 0.8122, AUC 0.8878107070922852, avg_entr 0.12323695421218872, f1 0.8122000098228455
ep12_l1_test_time 0.28583574295043945
Test Epoch12 layer2 Acc 0.8102, AUC 0.8867442607879639, avg_entr 0.11486848443746567, f1 0.8101999759674072
ep12_l2_test_time 0.3082568645477295
Test Epoch12 layer3 Acc 0.8104, AUC 0.8830804824829102, avg_entr 0.06286066770553589, f1 0.8104000091552734
ep12_l3_test_time 0.3316962718963623
Test Epoch12 layer4 Acc 0.8104, AUC 0.8724985718727112, avg_entr 0.0394509993493557, f1 0.8104000091552734
ep12_l4_test_time 0.3309054374694824
gc 0
Train Epoch13 Acc 0.9704 (38816/40000), AUC 0.9947117567062378
ep13_train_time 7.2871413230896
Test Epoch13 layer0 Acc 0.811, AUC 0.8860937356948853, avg_entr 0.13720448315143585, f1 0.8109999895095825
ep13_l0_test_time 0.3216371536254883
Test Epoch13 layer1 Acc 0.814, AUC 0.8863004446029663, avg_entr 0.12224877625703812, f1 0.8139999508857727
ep13_l1_test_time 0.3095872402191162
Test Epoch13 layer2 Acc 0.811, AUC 0.8850990533828735, avg_entr 0.11360564827919006, f1 0.8109999895095825
ep13_l2_test_time 0.32664060592651367
Test Epoch13 layer3 Acc 0.8116, AUC 0.88013756275177, avg_entr 0.05981984734535217, f1 0.8116000294685364
ep13_l3_test_time 0.33411240577697754
Test Epoch13 layer4 Acc 0.8118, AUC 0.8739098310470581, avg_entr 0.03808172792196274, f1 0.8118000030517578
ep13_l4_test_time 0.3099384307861328
gc 0
Train Epoch14 Acc 0.972225 (38889/40000), AUC 0.9954217672348022
ep14_train_time 7.2262961864471436
Test Epoch14 layer0 Acc 0.812, AUC 0.8857207298278809, avg_entr 0.13526807725429535, f1 0.8119999766349792
ep14_l0_test_time 0.31859350204467773
Test Epoch14 layer1 Acc 0.8124, AUC 0.8858349323272705, avg_entr 0.11998452246189117, f1 0.8123999238014221
ep14_l1_test_time 0.30945634841918945
Test Epoch14 layer2 Acc 0.8112, AUC 0.8846737146377563, avg_entr 0.11043661832809448, f1 0.8112000226974487
ep14_l2_test_time 0.32630491256713867
Test Epoch14 layer3 Acc 0.811, AUC 0.8781846761703491, avg_entr 0.05778329446911812, f1 0.8109999895095825
ep14_l3_test_time 0.3099215030670166
Test Epoch14 layer4 Acc 0.8114, AUC 0.8742563128471375, avg_entr 0.036491356790065765, f1 0.8113999962806702
ep14_l4_test_time 0.31711554527282715
gc 0
Train Epoch15 Acc 0.97245 (38898/40000), AUC 0.9955446720123291
ep15_train_time 7.244027137756348
Test Epoch15 layer0 Acc 0.8122, AUC 0.8849673271179199, avg_entr 0.13366645574569702, f1 0.8122000098228455
ep15_l0_test_time 0.3194894790649414
Test Epoch15 layer1 Acc 0.8134, AUC 0.8850974440574646, avg_entr 0.11873703449964523, f1 0.8133999109268188
ep15_l1_test_time 0.3170022964477539
Test Epoch15 layer2 Acc 0.8124, AUC 0.8838679790496826, avg_entr 0.10879053920507431, f1 0.8123999238014221
ep15_l2_test_time 0.32970237731933594
Test Epoch15 layer3 Acc 0.8114, AUC 0.8762781620025635, avg_entr 0.05560116097331047, f1 0.8113999962806702
ep15_l3_test_time 0.3346226215362549
Test Epoch15 layer4 Acc 0.8118, AUC 0.8723491430282593, avg_entr 0.03514106571674347, f1 0.8118000030517578
ep15_l4_test_time 0.32747983932495117
gc 0
Train Epoch16 Acc 0.973025 (38921/40000), AUC 0.9956707954406738
ep16_train_time 7.225870847702026
Test Epoch16 layer0 Acc 0.8106, AUC 0.884102463722229, avg_entr 0.13297076523303986, f1 0.8105999231338501
ep16_l0_test_time 0.3145930767059326
Test Epoch16 layer1 Acc 0.8136, AUC 0.8842394351959229, avg_entr 0.11782624572515488, f1 0.8136000037193298
ep16_l1_test_time 0.3023555278778076
Test Epoch16 layer2 Acc 0.8114, AUC 0.8829914331436157, avg_entr 0.10783644765615463, f1 0.8113999962806702
ep16_l2_test_time 0.3285682201385498
Test Epoch16 layer3 Acc 0.8112, AUC 0.8744043111801147, avg_entr 0.05458556488156319, f1 0.8112000226974487
ep16_l3_test_time 0.32035279273986816
Test Epoch16 layer4 Acc 0.8116, AUC 0.8715927600860596, avg_entr 0.03468608111143112, f1 0.8116000294685364
ep16_l4_test_time 0.32231879234313965
gc 0
Train Epoch17 Acc 0.9734 (38936/40000), AUC 0.9958277940750122
ep17_train_time 7.251917362213135
Test Epoch17 layer0 Acc 0.8112, AUC 0.8834392428398132, avg_entr 0.13109154999256134, f1 0.8112000226974487
ep17_l0_test_time 0.3244922161102295
Test Epoch17 layer1 Acc 0.8124, AUC 0.8835896253585815, avg_entr 0.11621220409870148, f1 0.8123999238014221
ep17_l1_test_time 0.32364606857299805
Test Epoch17 layer2 Acc 0.8108, AUC 0.8823021650314331, avg_entr 0.10594721883535385, f1 0.8108000159263611
ep17_l2_test_time 0.3040924072265625
Test Epoch17 layer3 Acc 0.8098, AUC 0.872310221195221, avg_entr 0.05313458293676376, f1 0.8098000288009644
ep17_l3_test_time 0.32453012466430664
Test Epoch17 layer4 Acc 0.8098, AUC 0.8693796992301941, avg_entr 0.03410449996590614, f1 0.8098000288009644
ep17_l4_test_time 0.3324587345123291
gc 0
Train Epoch18 Acc 0.974425 (38977/40000), AUC 0.9959944486618042
ep18_train_time 7.258798837661743
Test Epoch18 layer0 Acc 0.81, AUC 0.8829092979431152, avg_entr 0.13048090040683746, f1 0.809999942779541
ep18_l0_test_time 0.32547950744628906
Test Epoch18 layer1 Acc 0.8112, AUC 0.8830355405807495, avg_entr 0.1156063824892044, f1 0.8112000226974487
ep18_l1_test_time 0.3310887813568115
Test Epoch18 layer2 Acc 0.8088, AUC 0.881747841835022, avg_entr 0.10516300052404404, f1 0.8087999820709229
ep18_l2_test_time 0.3252871036529541
Test Epoch18 layer3 Acc 0.8086, AUC 0.8713847994804382, avg_entr 0.05259734392166138, f1 0.8086000084877014
ep18_l3_test_time 0.29250240325927734
Test Epoch18 layer4 Acc 0.8102, AUC 0.869676947593689, avg_entr 0.03379025310277939, f1 0.8101999759674072
ep18_l4_test_time 0.30832982063293457
gc 0
Train Epoch19 Acc 0.974775 (38991/40000), AUC 0.9961164593696594
ep19_train_time 6.898367643356323
Test Epoch19 layer0 Acc 0.8096, AUC 0.8826398253440857, avg_entr 0.12944123148918152, f1 0.8095999956130981
ep19_l0_test_time 0.2815558910369873
Test Epoch19 layer1 Acc 0.8108, AUC 0.8827279806137085, avg_entr 0.11455325037240982, f1 0.8108000159263611
ep19_l1_test_time 0.3142430782318115
Test Epoch19 layer2 Acc 0.8088, AUC 0.8814620971679688, avg_entr 0.10344801098108292, f1 0.8087999820709229
ep19_l2_test_time 0.3042159080505371
Test Epoch19 layer3 Acc 0.8088, AUC 0.8708031177520752, avg_entr 0.05160966143012047, f1 0.8087999820709229
ep19_l3_test_time 0.3322484493255615
Test Epoch19 layer4 Acc 0.8096, AUC 0.8701438307762146, avg_entr 0.033260852098464966, f1 0.8095999956130981
ep19_l4_test_time 0.3080160617828369
gc 0
Train Epoch20 Acc 0.97495 (38998/40000), AUC 0.9961569309234619
ep20_train_time 7.2530357837677
Test Epoch20 layer0 Acc 0.8094, AUC 0.8821825981140137, avg_entr 0.12908469140529633, f1 0.8094000220298767
ep20_l0_test_time 0.29193711280822754
Test Epoch20 layer1 Acc 0.8108, AUC 0.8822394609451294, avg_entr 0.11418204009532928, f1 0.8108000159263611
ep20_l1_test_time 0.3264913558959961
Test Epoch20 layer2 Acc 0.8078, AUC 0.8809539079666138, avg_entr 0.10360799729824066, f1 0.8077999353408813
ep20_l2_test_time 0.3078885078430176
Test Epoch20 layer3 Acc 0.8088, AUC 0.8701406717300415, avg_entr 0.050997842103242874, f1 0.8087999820709229
ep20_l3_test_time 0.32225775718688965
Test Epoch20 layer4 Acc 0.809, AUC 0.8704777956008911, avg_entr 0.032678138464689255, f1 0.8090000748634338
ep20_l4_test_time 0.3112051486968994
gc 0
Train Epoch21 Acc 0.9747 (38988/40000), AUC 0.9961948394775391
ep21_train_time 7.277487516403198
Test Epoch21 layer0 Acc 0.8088, AUC 0.8819164633750916, avg_entr 0.12735874950885773, f1 0.8087999820709229
ep21_l0_test_time 0.30161499977111816
Test Epoch21 layer1 Acc 0.8084, AUC 0.8819851875305176, avg_entr 0.11263950169086456, f1 0.8083999752998352
ep21_l1_test_time 0.3274710178375244
Test Epoch21 layer2 Acc 0.8066, AUC 0.8806555271148682, avg_entr 0.10187587887048721, f1 0.8065999746322632
ep21_l2_test_time 0.3154728412628174
Test Epoch21 layer3 Acc 0.8072, AUC 0.8690985441207886, avg_entr 0.05011074244976044, f1 0.807200014591217
ep21_l3_test_time 0.33607029914855957
Test Epoch21 layer4 Acc 0.8078, AUC 0.8694053292274475, avg_entr 0.032507408410310745, f1 0.8077999353408813
ep21_l4_test_time 0.3242931365966797
gc 0
Train Epoch22 Acc 0.9754 (39016/40000), AUC 0.9962494373321533
ep22_train_time 7.284687757492065
Test Epoch22 layer0 Acc 0.8088, AUC 0.8817040920257568, avg_entr 0.12732331454753876, f1 0.8087999820709229
ep22_l0_test_time 0.31122565269470215
Test Epoch22 layer1 Acc 0.8098, AUC 0.881782591342926, avg_entr 0.11246467381715775, f1 0.8098000288009644
ep22_l1_test_time 0.329632043838501
Test Epoch22 layer2 Acc 0.8072, AUC 0.8804590106010437, avg_entr 0.10110172629356384, f1 0.807200014591217
ep22_l2_test_time 0.3313870429992676
Test Epoch22 layer3 Acc 0.8086, AUC 0.8686690330505371, avg_entr 0.04998096823692322, f1 0.8086000084877014
ep22_l3_test_time 0.32146430015563965
Test Epoch22 layer4 Acc 0.8094, AUC 0.8693063259124756, avg_entr 0.032246556133031845, f1 0.8094000220298767
ep22_l4_test_time 0.3157382011413574
gc 0
Train Epoch23 Acc 0.97535 (39014/40000), AUC 0.9963510632514954
ep23_train_time 7.23689603805542
Test Epoch23 layer0 Acc 0.8096, AUC 0.8815785050392151, avg_entr 0.1267293095588684, f1 0.8095999956130981
ep23_l0_test_time 0.3094906806945801
Test Epoch23 layer1 Acc 0.8086, AUC 0.8816494941711426, avg_entr 0.11190679669380188, f1 0.8086000084877014
ep23_l1_test_time 0.31743550300598145
Test Epoch23 layer2 Acc 0.808, AUC 0.8803143501281738, avg_entr 0.10081187635660172, f1 0.8080000281333923
ep23_l2_test_time 0.3299596309661865
Test Epoch23 layer3 Acc 0.8082, AUC 0.8685181140899658, avg_entr 0.04949328675866127, f1 0.808199942111969
ep23_l3_test_time 0.31884217262268066
Test Epoch23 layer4 Acc 0.8094, AUC 0.8697102069854736, avg_entr 0.0320299006998539, f1 0.8094000220298767
ep23_l4_test_time 0.3179447650909424
gc 0
Train Epoch24 Acc 0.9756 (39024/40000), AUC 0.996328592300415
ep24_train_time 7.2797887325286865
Test Epoch24 layer0 Acc 0.8086, AUC 0.8814640045166016, avg_entr 0.12632925808429718, f1 0.8086000084877014
ep24_l0_test_time 0.327805757522583
Test Epoch24 layer1 Acc 0.8096, AUC 0.8815167546272278, avg_entr 0.11143410950899124, f1 0.8095999956130981
ep24_l1_test_time 0.3310573101043701
Test Epoch24 layer2 Acc 0.8072, AUC 0.8801757097244263, avg_entr 0.10024793446063995, f1 0.807200014591217
ep24_l2_test_time 0.30860066413879395
Test Epoch24 layer3 Acc 0.8082, AUC 0.8681439161300659, avg_entr 0.04916370287537575, f1 0.808199942111969
ep24_l3_test_time 0.309359073638916
Test Epoch24 layer4 Acc 0.809, AUC 0.8696014285087585, avg_entr 0.03174716606736183, f1 0.8090000748634338
ep24_l4_test_time 0.3251676559448242
gc 0
Train Epoch25 Acc 0.9755 (39020/40000), AUC 0.9963068962097168
ep25_train_time 7.196985244750977
Test Epoch25 layer0 Acc 0.8076, AUC 0.8812589049339294, avg_entr 0.12532874941825867, f1 0.8076000213623047
ep25_l0_test_time 0.30526208877563477
Test Epoch25 layer1 Acc 0.8076, AUC 0.8813265562057495, avg_entr 0.110562264919281, f1 0.8076000213623047
ep25_l1_test_time 0.2978694438934326
Test Epoch25 layer2 Acc 0.8078, AUC 0.8799518346786499, avg_entr 0.09952864050865173, f1 0.8077999353408813
ep25_l2_test_time 0.32580041885375977
Test Epoch25 layer3 Acc 0.8058, AUC 0.8672991991043091, avg_entr 0.04877513274550438, f1 0.8058000206947327
ep25_l3_test_time 0.33571434020996094
Test Epoch25 layer4 Acc 0.8064, AUC 0.8681502938270569, avg_entr 0.03161275014281273, f1 0.8064000010490417
ep25_l4_test_time 0.31691694259643555
gc 0
Train Epoch26 Acc 0.9758 (39032/40000), AUC 0.9963746666908264
ep26_train_time 6.841846227645874
Test Epoch26 layer0 Acc 0.8084, AUC 0.8811914920806885, avg_entr 0.12515732645988464, f1 0.8083999752998352
ep26_l0_test_time 0.3146512508392334
Test Epoch26 layer1 Acc 0.8074, AUC 0.8812441825866699, avg_entr 0.11040200293064117, f1 0.8073999881744385
ep26_l1_test_time 0.32390332221984863
Test Epoch26 layer2 Acc 0.807, AUC 0.8798712491989136, avg_entr 0.09910409152507782, f1 0.8069999814033508
ep26_l2_test_time 0.30378293991088867
Test Epoch26 layer3 Acc 0.808, AUC 0.8675252199172974, avg_entr 0.04849514365196228, f1 0.8080000281333923
ep26_l3_test_time 0.3328366279602051
Test Epoch26 layer4 Acc 0.8082, AUC 0.8688086867332458, avg_entr 0.031389668583869934, f1 0.808199942111969
ep26_l4_test_time 0.3150773048400879
gc 0
Train Epoch27 Acc 0.975825 (39033/40000), AUC 0.9963964223861694
ep27_train_time 7.292190790176392
Test Epoch27 layer0 Acc 0.808, AUC 0.8811582326889038, avg_entr 0.12475302815437317, f1 0.8080000281333923
ep27_l0_test_time 0.3072693347930908
Test Epoch27 layer1 Acc 0.8078, AUC 0.8811957836151123, avg_entr 0.10996072739362717, f1 0.8077999353408813
ep27_l1_test_time 0.3296215534210205
Test Epoch27 layer2 Acc 0.8074, AUC 0.8798139095306396, avg_entr 0.09863565862178802, f1 0.8073999881744385
ep27_l2_test_time 0.2899169921875
Test Epoch27 layer3 Acc 0.8072, AUC 0.8673489093780518, avg_entr 0.04821343719959259, f1 0.807200014591217
ep27_l3_test_time 0.3017158508300781
Test Epoch27 layer4 Acc 0.8078, AUC 0.8690133094787598, avg_entr 0.031230157241225243, f1 0.8077999353408813
ep27_l4_test_time 0.31695008277893066
gc 0
Train Epoch28 Acc 0.9758 (39032/40000), AUC 0.9963634014129639
ep28_train_time 7.253642320632935
Test Epoch28 layer0 Acc 0.8082, AUC 0.8810681104660034, avg_entr 0.12459055334329605, f1 0.808199942111969
ep28_l0_test_time 0.3270537853240967
Test Epoch28 layer1 Acc 0.8084, AUC 0.881103515625, avg_entr 0.10975145548582077, f1 0.8083999752998352
ep28_l1_test_time 0.3112955093383789
Test Epoch28 layer2 Acc 0.8068, AUC 0.8797376155853271, avg_entr 0.09828861057758331, f1 0.8068000078201294
ep28_l2_test_time 0.31997227668762207
Test Epoch28 layer3 Acc 0.8074, AUC 0.867165207862854, avg_entr 0.04804572835564613, f1 0.8073999881744385
ep28_l3_test_time 0.3069167137145996
Test Epoch28 layer4 Acc 0.8086, AUC 0.8694372177124023, avg_entr 0.030982928350567818, f1 0.8086000084877014
ep28_l4_test_time 0.32191896438598633
gc 0
Train Epoch29 Acc 0.97605 (39042/40000), AUC 0.9964350461959839
ep29_train_time 7.244792461395264
Test Epoch29 layer0 Acc 0.8072, AUC 0.8809944987297058, avg_entr 0.12390092760324478, f1 0.807200014591217
ep29_l0_test_time 0.32109999656677246
Test Epoch29 layer1 Acc 0.807, AUC 0.8810145854949951, avg_entr 0.10907743871212006, f1 0.8069999814033508
ep29_l1_test_time 0.3078913688659668
Test Epoch29 layer2 Acc 0.8072, AUC 0.8796341419219971, avg_entr 0.0976245105266571, f1 0.807200014591217
ep29_l2_test_time 0.3303976058959961
Test Epoch29 layer3 Acc 0.8076, AUC 0.8670542240142822, avg_entr 0.047590769827365875, f1 0.8076000213623047
ep29_l3_test_time 0.332385778427124
Test Epoch29 layer4 Acc 0.8072, AUC 0.8694899082183838, avg_entr 0.030706875026226044, f1 0.807200014591217
ep29_l4_test_time 0.3247072696685791
Best AUC tensor(0.8462)
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 266.2325053215027
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad100//imdb_linearal_l5.pt
Test layer0 Acc 0.8404, AUC 0.9208483695983887, avg_entr 0.21877844631671906, f1 0.840399980545044
l0_test_time 0.32642269134521484
Test layer1 Acc 0.8408, AUC 0.9201472997665405, avg_entr 0.20893451571464539, f1 0.8408000469207764
l1_test_time 0.33073902130126953
Test layer2 Acc 0.8438, AUC 0.9203163385391235, avg_entr 0.20195573568344116, f1 0.8438000082969666
l2_test_time 0.3124697208404541
Test layer3 Acc 0.8418, AUC 0.9204384088516235, avg_entr 0.1995471715927124, f1 0.8418000340461731
l3_test_time 0.3339207172393799
Test layer4 Acc 0.8392, AUC 0.9205499887466431, avg_entr 0.18841691315174103, f1 0.8392000198364258
l4_test_time 0.325786828994751
