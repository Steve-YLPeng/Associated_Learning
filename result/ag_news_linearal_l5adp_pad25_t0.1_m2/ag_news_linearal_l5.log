total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.1_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.3470083333333333 (41641/120000), AUC 0.44985848665237427
ep0_train_time 4.901862382888794
Test Epoch0 threshold 0.1 Acc 0.9136513157894737, AUC 0.981453001499176, avg_entr 0.036097098141908646
ep0_t0.1_test_time 0.0841212272644043
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.1_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.400475 (48057/120000), AUC 0.43540436029434204
ep1_train_time 4.632745742797852
Test Epoch1 threshold 0.1 Acc 0.9129934210526316, AUC 0.9810974597930908, avg_entr 0.031236357986927032
ep1_t0.1_test_time 0.08133602142333984
gc 0
Train Epoch2 Acc 0.42333333333333334 (50800/120000), AUC 0.4325334429740906
ep2_train_time 4.640299558639526
Test Epoch2 threshold 0.1 Acc 0.9133223684210526, AUC 0.9802760481834412, avg_entr 0.028732355684041977
ep2_t0.1_test_time 0.0787804126739502
gc 0
Train Epoch3 Acc 0.43825833333333336 (52591/120000), AUC 0.429809033870697
ep3_train_time 4.355381011962891
Test Epoch3 threshold 0.1 Acc 0.9106907894736842, AUC 0.9805928468704224, avg_entr 0.028020156547427177
ep3_t0.1_test_time 0.07862305641174316
gc 0
Train Epoch4 Acc 0.44704166666666667 (53645/120000), AUC 0.4262810945510864
ep4_train_time 4.406949043273926
Test Epoch4 threshold 0.1 Acc 0.9111842105263158, AUC 0.9800179600715637, avg_entr 0.027493368834257126
ep4_t0.1_test_time 0.07931327819824219
gc 0
Train Epoch5 Acc 0.4529166666666667 (54350/120000), AUC 0.4245476722717285
ep5_train_time 4.354946613311768
Test Epoch5 threshold 0.1 Acc 0.9115131578947369, AUC 0.9799321889877319, avg_entr 0.026521839201450348
ep5_t0.1_test_time 0.07846736907958984
gc 0
Train Epoch6 Acc 0.45393333333333336 (54472/120000), AUC 0.42329639196395874
ep6_train_time 4.36016321182251
Test Epoch6 threshold 0.1 Acc 0.9101973684210526, AUC 0.9794772267341614, avg_entr 0.0261228010058403
ep6_t0.1_test_time 0.07933473587036133
gc 0
Train Epoch7 Acc 0.45534166666666664 (54641/120000), AUC 0.42179006338119507
ep7_train_time 4.393517971038818
Test Epoch7 threshold 0.1 Acc 0.9111842105263158, AUC 0.9796005487442017, avg_entr 0.0257087554782629
ep7_t0.1_test_time 0.0788869857788086
gc 0
Train Epoch8 Acc 0.456525 (54783/120000), AUC 0.4208153486251831
ep8_train_time 4.35075569152832
Test Epoch8 threshold 0.1 Acc 0.9105263157894737, AUC 0.9793673753738403, avg_entr 0.025469845160841942
ep8_t0.1_test_time 0.07888507843017578
gc 0
Train Epoch9 Acc 0.458475 (55017/120000), AUC 0.4204830527305603
ep9_train_time 4.38787317276001
Test Epoch9 threshold 0.1 Acc 0.9111842105263158, AUC 0.9791618585586548, avg_entr 0.025197910144925117
ep9_t0.1_test_time 0.07880353927612305
Best AUC 0.981453001499176
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.1_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9177631578947368, AUC 0.9857889413833618, avg_entr 0.03754793480038643
t0.1_test_time 0.020648956298828125
