total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.5207416666666667 (62489/120000), AUC 0.7239583730697632
ep0_train_time 10.035311698913574
Test Epoch0 threshold 0.2 Acc 0.9162828947368421, AUC 0.9805870056152344, avg_entr 0.02373724989593029
ep0_t0.2_test_time 0.2812626361846924
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.5154833333333333 (61858/120000), AUC 0.6879597306251526
ep1_train_time 9.80039358139038
Test Epoch1 threshold 0.2 Acc 0.9131578947368421, AUC 0.9804508090019226, avg_entr 0.022901585325598717
ep1_t0.2_test_time 0.28479743003845215
gc 0
Train Epoch2 Acc 0.4816 (57792/120000), AUC 0.6435630917549133
ep2_train_time 9.719003915786743
Test Epoch2 threshold 0.2 Acc 0.9154605263157894, AUC 0.9802348017692566, avg_entr 0.020847123116254807
ep2_t0.2_test_time 0.28495049476623535
gc 0
Train Epoch3 Acc 0.36205 (43446/120000), AUC 0.6597226858139038
ep3_train_time 9.699044942855835
Test Epoch3 threshold 0.2 Acc 0.9139802631578947, AUC 0.9802097082138062, avg_entr 0.019681787118315697
ep3_t0.2_test_time 0.282944917678833
gc 0
Train Epoch4 Acc 0.301675 (36201/120000), AUC 0.6438820958137512
ep4_train_time 9.766812562942505
Test Epoch4 threshold 0.2 Acc 0.9148026315789474, AUC 0.9799134731292725, avg_entr 0.018128354102373123
ep4_t0.2_test_time 0.2826251983642578
gc 0
Train Epoch5 Acc 0.28295 (33954/120000), AUC 0.5948125123977661
ep5_train_time 9.602269172668457
Test Epoch5 threshold 0.2 Acc 0.9133223684210526, AUC 0.9798150062561035, avg_entr 0.019151244312524796
ep5_t0.2_test_time 0.28231215476989746
gc 0
Train Epoch6 Acc 0.2769333333333333 (33232/120000), AUC 0.5694820284843445
ep6_train_time 9.67698073387146
Test Epoch6 threshold 0.2 Acc 0.9116776315789473, AUC 0.9797952771186829, avg_entr 0.01894487626850605
ep6_t0.2_test_time 0.2823209762573242
gc 0
Train Epoch7 Acc 0.27225 (32670/120000), AUC 0.5532798767089844
ep7_train_time 9.682814359664917
Test Epoch7 threshold 0.2 Acc 0.9120065789473685, AUC 0.9796167612075806, avg_entr 0.01814112812280655
ep7_t0.2_test_time 0.2817649841308594
gc 0
Train Epoch8 Acc 0.26690833333333336 (32029/120000), AUC 0.544333815574646
ep8_train_time 9.616645812988281
Test Epoch8 threshold 0.2 Acc 0.9126644736842106, AUC 0.9795233011245728, avg_entr 0.017826182767748833
ep8_t0.2_test_time 0.2819230556488037
gc 0
Train Epoch9 Acc 0.262225 (31467/120000), AUC 0.5426509380340576
ep9_train_time 9.63992691040039
Test Epoch9 threshold 0.2 Acc 0.9129934210526316, AUC 0.9794734120368958, avg_entr 0.017853323370218277
ep9_t0.2_test_time 0.2805042266845703
Best AUC 0.9805870056152344
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9230263157894737, AUC 0.986140251159668, avg_entr 0.02354448288679123
t0.2_test_time 0.07098245620727539
