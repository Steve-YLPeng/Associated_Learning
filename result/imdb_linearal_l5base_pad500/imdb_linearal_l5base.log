total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.598318099975586
Start Training
gc 0
Train Epoch0 Acc 0.51195 (20478/40000), AUC 0.5223093628883362
ep0_train_time 6.852228879928589
Test Epoch0 layer4 Acc 0.7544, AUC 0.8234479427337646, avg_entr 0.6911707520484924
ep0_l4_test_time 0.5451810359954834
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.818075 (32723/40000), AUC 0.9018247127532959
ep1_train_time 6.362674713134766
Test Epoch1 layer4 Acc 0.881, AUC 0.9473626613616943, avg_entr 0.25426986813545227
ep1_l4_test_time 0.5478000640869141
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.903825 (36153/40000), AUC 0.964643657207489
ep2_train_time 6.513790845870972
Test Epoch2 layer4 Acc 0.8928, AUC 0.9564283490180969, avg_entr 0.18120458722114563
ep2_l4_test_time 0.5443437099456787
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.92305 (36922/40000), AUC 0.9758232831954956
ep3_train_time 6.6153154373168945
Test Epoch3 layer4 Acc 0.8902, AUC 0.9594178199768066, avg_entr 0.14398135244846344
ep3_l4_test_time 0.6019275188446045
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.931875 (37275/40000), AUC 0.9808005094528198
ep4_train_time 6.357682466506958
Test Epoch4 layer4 Acc 0.894, AUC 0.9605350494384766, avg_entr 0.1072796881198883
ep4_l4_test_time 0.5454769134521484
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.942725 (37709/40000), AUC 0.9854651689529419
ep5_train_time 6.3858911991119385
Test Epoch5 layer4 Acc 0.8986, AUC 0.9603191018104553, avg_entr 0.06695890426635742
ep5_l4_test_time 0.5447831153869629
gc 0
Train Epoch6 Acc 0.948275 (37931/40000), AUC 0.9873692393302917
ep6_train_time 6.44539475440979
Test Epoch6 layer4 Acc 0.8972, AUC 0.9575077295303345, avg_entr 0.052501801401376724
ep6_l4_test_time 0.5503690242767334
gc 0
Train Epoch7 Acc 0.953975 (38159/40000), AUC 0.9888989925384521
ep7_train_time 6.487551689147949
Test Epoch7 layer4 Acc 0.895, AUC 0.954404354095459, avg_entr 0.04067752882838249
ep7_l4_test_time 0.5485196113586426
gc 0
Train Epoch8 Acc 0.959325 (38373/40000), AUC 0.9907495975494385
ep8_train_time 6.356574296951294
Test Epoch8 layer4 Acc 0.8844, AUC 0.9523646235466003, avg_entr 0.03625035658478737
ep8_l4_test_time 0.5472137928009033
gc 0
Train Epoch9 Acc 0.962025 (38481/40000), AUC 0.9921228289604187
ep9_train_time 6.379693269729614
Test Epoch9 layer4 Acc 0.8902, AUC 0.950018584728241, avg_entr 0.031069619581103325
ep9_l4_test_time 0.544144868850708
gc 0
Train Epoch10 Acc 0.966025 (38641/40000), AUC 0.9932416677474976
ep10_train_time 6.410190582275391
Test Epoch10 layer4 Acc 0.8874, AUC 0.9499595165252686, avg_entr 0.026829836890101433
ep10_l4_test_time 0.5426766872406006
gc 0
Train Epoch11 Acc 0.9681 (38724/40000), AUC 0.994049072265625
ep11_train_time 6.478532314300537
Test Epoch11 layer4 Acc 0.8832, AUC 0.9483490586280823, avg_entr 0.023385532200336456
ep11_l4_test_time 0.5425131320953369
gc 0
Train Epoch12 Acc 0.97015 (38806/40000), AUC 0.9948395490646362
ep12_train_time 6.537755012512207
Test Epoch12 layer4 Acc 0.8838, AUC 0.946739673614502, avg_entr 0.02375159040093422
ep12_l4_test_time 0.5443723201751709
gc 0
Train Epoch13 Acc 0.97295 (38918/40000), AUC 0.9953842163085938
ep13_train_time 6.476905822753906
Test Epoch13 layer4 Acc 0.8786, AUC 0.9451249837875366, avg_entr 0.02044433355331421
ep13_l4_test_time 0.5431208610534668
gc 0
Train Epoch14 Acc 0.9736 (38944/40000), AUC 0.9955246448516846
ep14_train_time 6.544543266296387
Test Epoch14 layer4 Acc 0.875, AUC 0.9442548155784607, avg_entr 0.0214886162430048
ep14_l4_test_time 0.5452849864959717
gc 0
Train Epoch15 Acc 0.976125 (39045/40000), AUC 0.996389627456665
ep15_train_time 6.396434545516968
Test Epoch15 layer4 Acc 0.8734, AUC 0.9411011934280396, avg_entr 0.020013878121972084
ep15_l4_test_time 0.544600248336792
gc 0
Train Epoch16 Acc 0.9778 (39112/40000), AUC 0.9966334104537964
ep16_train_time 6.451592206954956
Test Epoch16 layer4 Acc 0.8644, AUC 0.9339025020599365, avg_entr 0.020036038011312485
ep16_l4_test_time 0.5484113693237305
gc 0
Train Epoch17 Acc 0.979375 (39175/40000), AUC 0.9968651533126831
ep17_train_time 6.4581217765808105
Test Epoch17 layer4 Acc 0.864, AUC 0.935287356376648, avg_entr 0.016538381576538086
ep17_l4_test_time 0.5419566631317139
gc 0
Train Epoch18 Acc 0.980175 (39207/40000), AUC 0.9972007274627686
ep18_train_time 6.4268200397491455
Test Epoch18 layer4 Acc 0.862, AUC 0.9323825836181641, avg_entr 0.017229003831744194
ep18_l4_test_time 0.5458767414093018
gc 0
Train Epoch19 Acc 0.9816 (39264/40000), AUC 0.9973695278167725
ep19_train_time 6.564431190490723
Test Epoch19 layer4 Acc 0.8616, AUC 0.9290903210639954, avg_entr 0.01722567155957222
ep19_l4_test_time 0.5407264232635498
gc 0
Train Epoch20 Acc 0.982475 (39299/40000), AUC 0.9977445602416992
ep20_train_time 6.312780857086182
Test Epoch20 layer4 Acc 0.8594, AUC 0.9251181483268738, avg_entr 0.019528470933437347
ep20_l4_test_time 0.5451469421386719
gc 0
Train Epoch21 Acc 0.983575 (39343/40000), AUC 0.9980039596557617
ep21_train_time 6.501381874084473
Test Epoch21 layer4 Acc 0.8544, AUC 0.927592396736145, avg_entr 0.016099154949188232
ep21_l4_test_time 0.5440454483032227
gc 0
Train Epoch22 Acc 0.983125 (39325/40000), AUC 0.9979335069656372
ep22_train_time 6.416075944900513
Test Epoch22 layer4 Acc 0.8526, AUC 0.9245972633361816, avg_entr 0.014247705228626728
ep22_l4_test_time 0.542680025100708
gc 0
Train Epoch23 Acc 0.984925 (39397/40000), AUC 0.9983881711959839
ep23_train_time 6.43002986907959
Test Epoch23 layer4 Acc 0.8508, AUC 0.9233211278915405, avg_entr 0.014592180959880352
ep23_l4_test_time 0.5438117980957031
gc 0
Train Epoch24 Acc 0.98485 (39394/40000), AUC 0.9983791708946228
ep24_train_time 6.661636590957642
Test Epoch24 layer4 Acc 0.8488, AUC 0.9207433462142944, avg_entr 0.014976094476878643
ep24_l4_test_time 0.5451185703277588
gc 0
Train Epoch25 Acc 0.985825 (39433/40000), AUC 0.9986025094985962
ep25_train_time 6.428911447525024
Test Epoch25 layer4 Acc 0.85, AUC 0.9214781522750854, avg_entr 0.013511528261005878
ep25_l4_test_time 0.5434134006500244
gc 0
Train Epoch26 Acc 0.98645 (39458/40000), AUC 0.998609185218811
ep26_train_time 6.407070636749268
Test Epoch26 layer4 Acc 0.8436, AUC 0.9163863658905029, avg_entr 0.013411027379333973
ep26_l4_test_time 0.5491480827331543
gc 0
Train Epoch27 Acc 0.9878 (39512/40000), AUC 0.9988120794296265
ep27_train_time 6.529130697250366
Test Epoch27 layer4 Acc 0.844, AUC 0.917508602142334, avg_entr 0.013692355714738369
ep27_l4_test_time 0.5433790683746338
gc 0
Train Epoch28 Acc 0.9879 (39516/40000), AUC 0.9988124966621399
ep28_train_time 6.466272830963135
Test Epoch28 layer4 Acc 0.8384, AUC 0.9166140556335449, avg_entr 0.013732336461544037
ep28_l4_test_time 0.5623269081115723
gc 0
Train Epoch29 Acc 0.98825 (39530/40000), AUC 0.9988973140716553
ep29_train_time 6.392362594604492
Test Epoch29 layer4 Acc 0.8404, AUC 0.9146550297737122, avg_entr 0.012462189421057701
ep29_l4_test_time 0.5426702499389648
gc 0
Train Epoch30 Acc 0.988425 (39537/40000), AUC 0.9989030957221985
ep30_train_time 6.42079496383667
Test Epoch30 layer4 Acc 0.8404, AUC 0.912431001663208, avg_entr 0.012070168741047382
ep30_l4_test_time 0.5412688255310059
gc 0
Train Epoch31 Acc 0.9885 (39540/40000), AUC 0.9989944696426392
ep31_train_time 6.380767345428467
Test Epoch31 layer4 Acc 0.8372, AUC 0.9099607467651367, avg_entr 0.01329737063497305
ep31_l4_test_time 0.5445637702941895
gc 0
Train Epoch32 Acc 0.989075 (39563/40000), AUC 0.9990183115005493
ep32_train_time 6.372750997543335
Test Epoch32 layer4 Acc 0.836, AUC 0.9092209935188293, avg_entr 0.013198774307966232
ep32_l4_test_time 0.5432872772216797
gc 0
Train Epoch33 Acc 0.98975 (39590/40000), AUC 0.9990938901901245
ep33_train_time 6.37609076499939
Test Epoch33 layer4 Acc 0.8352, AUC 0.9076634645462036, avg_entr 0.011713548563420773
ep33_l4_test_time 0.5480406284332275
gc 0
Train Epoch34 Acc 0.989925 (39597/40000), AUC 0.9990230798721313
ep34_train_time 6.686307668685913
Test Epoch34 layer4 Acc 0.8344, AUC 0.905081570148468, avg_entr 0.011881239712238312
ep34_l4_test_time 0.5672717094421387
gc 0
Train Epoch35 Acc 0.9904 (39616/40000), AUC 0.9991686344146729
ep35_train_time 6.4381749629974365
Test Epoch35 layer4 Acc 0.8326, AUC 0.9048351645469666, avg_entr 0.011124325916171074
ep35_l4_test_time 0.5443472862243652
gc 0
Train Epoch36 Acc 0.990875 (39635/40000), AUC 0.9992380142211914
ep36_train_time 6.394400358200073
Test Epoch36 layer4 Acc 0.829, AUC 0.9025941491127014, avg_entr 0.011265243403613567
ep36_l4_test_time 0.5447628498077393
gc 0
Train Epoch37 Acc 0.991325 (39653/40000), AUC 0.9993652701377869
ep37_train_time 6.579187870025635
Test Epoch37 layer4 Acc 0.8294, AUC 0.9004749059677124, avg_entr 0.01181270182132721
ep37_l4_test_time 0.5512516498565674
gc 0
Train Epoch38 Acc 0.991075 (39643/40000), AUC 0.9992599487304688
ep38_train_time 6.421050548553467
Test Epoch38 layer4 Acc 0.825, AUC 0.9006093740463257, avg_entr 0.009904997423291206
ep38_l4_test_time 0.5439808368682861
gc 0
Train Epoch39 Acc 0.991775 (39671/40000), AUC 0.9993284940719604
ep39_train_time 6.353278398513794
Test Epoch39 layer4 Acc 0.8266, AUC 0.8973154425621033, avg_entr 0.01141742430627346
ep39_l4_test_time 0.5429708957672119
gc 0
Train Epoch40 Acc 0.9919 (39676/40000), AUC 0.9993875026702881
ep40_train_time 6.4595911502838135
Test Epoch40 layer4 Acc 0.824, AUC 0.8941136598587036, avg_entr 0.009372551925480366
ep40_l4_test_time 0.5430395603179932
gc 0
Train Epoch41 Acc 0.991925 (39677/40000), AUC 0.9993629455566406
ep41_train_time 6.531708002090454
Test Epoch41 layer4 Acc 0.8238, AUC 0.892573356628418, avg_entr 0.0114020686596632
ep41_l4_test_time 0.5452656745910645
gc 0
Train Epoch42 Acc 0.992075 (39683/40000), AUC 0.9995133876800537
ep42_train_time 6.382553577423096
Test Epoch42 layer4 Acc 0.8246, AUC 0.8940824270248413, avg_entr 0.008604112081229687
ep42_l4_test_time 0.5458624362945557
gc 0
Train Epoch43 Acc 0.992625 (39705/40000), AUC 0.9994909763336182
ep43_train_time 6.369436502456665
Test Epoch43 layer4 Acc 0.8206, AUC 0.8920230865478516, avg_entr 0.009853117167949677
ep43_l4_test_time 0.5430924892425537
gc 0
Train Epoch44 Acc 0.9928 (39712/40000), AUC 0.9995347261428833
ep44_train_time 6.4572131633758545
Test Epoch44 layer4 Acc 0.8216, AUC 0.8888435959815979, avg_entr 0.009251591749489307
ep44_l4_test_time 0.5444817543029785
gc 0
Train Epoch45 Acc 0.9933 (39732/40000), AUC 0.999512791633606
ep45_train_time 6.530846834182739
Test Epoch45 layer4 Acc 0.8204, AUC 0.8857624530792236, avg_entr 0.009897591546177864
ep45_l4_test_time 0.546708345413208
gc 0
Train Epoch46 Acc 0.993225 (39729/40000), AUC 0.9994738101959229
ep46_train_time 6.349340915679932
Test Epoch46 layer4 Acc 0.8176, AUC 0.8833900690078735, avg_entr 0.00943767186254263
ep46_l4_test_time 0.5524027347564697
gc 0
Train Epoch47 Acc 0.9934 (39736/40000), AUC 0.9994166493415833
ep47_train_time 6.448379755020142
Test Epoch47 layer4 Acc 0.816, AUC 0.8830970525741577, avg_entr 0.009606591425836086
ep47_l4_test_time 0.5433154106140137
gc 0
Train Epoch48 Acc 0.9937 (39748/40000), AUC 0.9994798898696899
ep48_train_time 6.429085731506348
Test Epoch48 layer4 Acc 0.8156, AUC 0.8827309608459473, avg_entr 0.008691261522471905
ep48_l4_test_time 0.5549969673156738
gc 0
Train Epoch49 Acc 0.993925 (39757/40000), AUC 0.9994822144508362
ep49_train_time 6.468795537948608
Test Epoch49 layer4 Acc 0.8164, AUC 0.881563663482666, avg_entr 0.008746675215661526
ep49_l4_test_time 0.5441505908966064
Best AUC 0.9605350494384766
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 352.83921790122986
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer4 Acc 0.8938, AUC 0.9572315216064453, avg_entr 0.1104089617729187
l4_test_time 0.551037073135376
