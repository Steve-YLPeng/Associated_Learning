total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.5_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.11818333333333333 (14182/120000), AUC 0.49505335092544556
ep0_train_time 5.842490911483765
Test Epoch0 threshold 0.5 Acc 0.9116776315789473, AUC 0.9805541038513184, avg_entr 0.02454392798244953
ep0_t0.5_test_time 0.07350444793701172
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.5_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.21603333333333333 (25924/120000), AUC 0.6081398129463196
ep1_train_time 5.369516372680664
Test Epoch1 threshold 0.5 Acc 0.9108552631578948, AUC 0.9800583720207214, avg_entr 0.02529294602572918
ep1_t0.5_test_time 0.07141590118408203
gc 0
Train Epoch2 Acc 0.26534166666666664 (31841/120000), AUC 0.6566683053970337
ep2_train_time 5.402309894561768
Test Epoch2 threshold 0.5 Acc 0.9111842105263158, AUC 0.9801949262619019, avg_entr 0.02482323721051216
ep2_t0.5_test_time 0.0724020004272461
gc 0
Train Epoch3 Acc 0.45425 (54510/120000), AUC 0.7208757400512695
ep3_train_time 5.363446235656738
Test Epoch3 threshold 0.5 Acc 0.9101973684210526, AUC 0.9794792532920837, avg_entr 0.025395845994353294
ep3_t0.5_test_time 0.072265625
gc 0
Train Epoch4 Acc 0.5067583333333333 (60811/120000), AUC 0.7444614171981812
ep4_train_time 5.6455628871917725
Test Epoch4 threshold 0.5 Acc 0.9110197368421052, AUC 0.9793017506599426, avg_entr 0.024488035589456558
ep4_t0.5_test_time 0.07370162010192871
gc 0
Train Epoch5 Acc 0.531975 (63837/120000), AUC 0.754667341709137
ep5_train_time 5.714554309844971
Test Epoch5 threshold 0.5 Acc 0.9113486842105263, AUC 0.9793176651000977, avg_entr 0.02492758259177208
ep5_t0.5_test_time 0.07455086708068848
gc 0
Train Epoch6 Acc 0.54765 (65718/120000), AUC 0.7566012740135193
ep6_train_time 5.823739767074585
Test Epoch6 threshold 0.5 Acc 0.9098684210526315, AUC 0.9790849685668945, avg_entr 0.025052091106772423
ep6_t0.5_test_time 0.07450628280639648
gc 0
Train Epoch7 Acc 0.5599083333333333 (67189/120000), AUC 0.7532123327255249
ep7_train_time 5.604547739028931
Test Epoch7 threshold 0.5 Acc 0.909375, AUC 0.9790090322494507, avg_entr 0.025335144251585007
ep7_t0.5_test_time 0.07258224487304688
gc 0
Train Epoch8 Acc 0.57485 (68982/120000), AUC 0.7499384880065918
ep8_train_time 5.576051712036133
Test Epoch8 threshold 0.5 Acc 0.9101973684210526, AUC 0.9787110090255737, avg_entr 0.02521384321153164
ep8_t0.5_test_time 0.07368946075439453
gc 0
Train Epoch9 Acc 0.579775 (69573/120000), AUC 0.7450350522994995
ep9_train_time 5.5147786140441895
Test Epoch9 threshold 0.5 Acc 0.9101973684210526, AUC 0.9784992933273315, avg_entr 0.02512362040579319
ep9_t0.5_test_time 0.07167530059814453
Best AUC 0.9805541038513184
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.5_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9223684210526316, AUC 0.9855397939682007, avg_entr 0.02632383070886135
t0.5_test_time 0.019420623779296875
