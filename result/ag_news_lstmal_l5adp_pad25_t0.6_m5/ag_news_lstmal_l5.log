total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad25_t0.6_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9219 (110628/120000), AUC 0.9852138757705688
ep0_train_time 18.39582324028015
Test Epoch0 threshold 0.6 Acc 0.9138157894736842, AUC 0.9799928069114685, avg_entr 0.023757778108119965
ep0_t0.6_test_time 0.07384920120239258
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad25_t0.6_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9563833333333334 (114766/120000), AUC 0.9933233857154846
ep1_train_time 18.19288396835327
Test Epoch1 threshold 0.6 Acc 0.9115131578947369, AUC 0.9798377156257629, avg_entr 0.02464144304394722
ep1_t0.6_test_time 0.07490348815917969
gc 0
Train Epoch2 Acc 0.9584666666666667 (115016/120000), AUC 0.9941647052764893
ep2_train_time 19.249749183654785
Test Epoch2 threshold 0.6 Acc 0.9103618421052632, AUC 0.9792834520339966, avg_entr 0.024627648293972015
ep2_t0.6_test_time 0.07153534889221191
gc 0
Train Epoch3 Acc 0.961475 (115377/120000), AUC 0.9947166442871094
ep3_train_time 18.39764928817749
Test Epoch3 threshold 0.6 Acc 0.9098684210526315, AUC 0.9794268012046814, avg_entr 0.024842659011483192
ep3_t0.6_test_time 0.07101678848266602
gc 0
Train Epoch4 Acc 0.96315 (115578/120000), AUC 0.9949356317520142
ep4_train_time 18.639686346054077
Test Epoch4 threshold 0.6 Acc 0.9103618421052632, AUC 0.9790441393852234, avg_entr 0.024702830240130424
ep4_t0.6_test_time 0.07213282585144043
gc 0
Train Epoch5 Acc 0.96685 (116022/120000), AUC 0.9959293007850647
ep5_train_time 18.59218716621399
Test Epoch5 threshold 0.6 Acc 0.909375, AUC 0.9789077043533325, avg_entr 0.025266049429774284
ep5_t0.6_test_time 0.07062268257141113
gc 0
Train Epoch6 Acc 0.9682083333333333 (116185/120000), AUC 0.9962250590324402
ep6_train_time 18.558699369430542
Test Epoch6 threshold 0.6 Acc 0.9080592105263158, AUC 0.9787288904190063, avg_entr 0.025477923452854156
ep6_t0.6_test_time 0.07203388214111328
gc 0
Train Epoch7 Acc 0.9694666666666667 (116336/120000), AUC 0.9961915016174316
ep7_train_time 19.620853424072266
Test Epoch7 threshold 0.6 Acc 0.9083881578947368, AUC 0.9786170721054077, avg_entr 0.025393955409526825
ep7_t0.6_test_time 0.07159566879272461
gc 0
Train Epoch8 Acc 0.9703083333333333 (116437/120000), AUC 0.9963200688362122
ep8_train_time 18.641704082489014
Test Epoch8 threshold 0.6 Acc 0.9085526315789474, AUC 0.9783446788787842, avg_entr 0.025417713448405266
ep8_t0.6_test_time 0.07107305526733398
gc 0
Train Epoch9 Acc 0.972625 (116715/120000), AUC 0.9967062473297119
ep9_train_time 18.399691581726074
Test Epoch9 threshold 0.6 Acc 0.9097039473684211, AUC 0.9783267378807068, avg_entr 0.02487928420305252
ep9_t0.6_test_time 0.07213735580444336
Best AUC 0.9799928069114685
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad25_t0.6_m5//ag_news_lstmal_l5_prefix.pt
Test threshold 0.6 Acc 0.9190789473684211, AUC 0.9847844839096069, avg_entr 0.027541078627109528
t0.6_test_time 0.018912792205810547
