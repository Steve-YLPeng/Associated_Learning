total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.502267599105835
ep0_train_time 8.34162712097168
Test Epoch0 threshold 0.9 Acc 0.8975328947368421, AUC 0.9737984538078308, avg_entr 0.18270176649093628
ep0_t0.9_test_time 0.2502620220184326
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.249975 (29997/120000), AUC 0.5207213759422302
ep1_train_time 7.9035069942474365
Test Epoch1 threshold 0.9 Acc 0.9106907894736842, AUC 0.9777969121932983, avg_entr 0.10773490369319916
ep1_t0.9_test_time 0.24895048141479492
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24983333333333332 (29980/120000), AUC 0.5248613357543945
ep2_train_time 8.050448894500732
Test Epoch2 threshold 0.9 Acc 0.9151315789473684, AUC 0.9795135259628296, avg_entr 0.0793057456612587
ep2_t0.9_test_time 0.24766039848327637
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24898333333333333 (29878/120000), AUC 0.5254311561584473
ep3_train_time 8.033656120300293
Test Epoch3 threshold 0.9 Acc 0.9115131578947369, AUC 0.9803340435028076, avg_entr 0.06776970624923706
ep3_t0.9_test_time 0.24820828437805176
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24808333333333332 (29770/120000), AUC 0.5252675414085388
ep4_train_time 7.954033374786377
Test Epoch4 threshold 0.9 Acc 0.9164473684210527, AUC 0.9806835055351257, avg_entr 0.05887535959482193
ep4_t0.9_test_time 0.24844050407409668
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24585833333333335 (29503/120000), AUC 0.5252933502197266
ep5_train_time 8.197908878326416
Test Epoch5 threshold 0.9 Acc 0.9143092105263158, AUC 0.9807042479515076, avg_entr 0.052653923630714417
ep5_t0.9_test_time 0.24858617782592773
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24098333333333333 (28918/120000), AUC 0.5248003005981445
ep6_train_time 7.898625135421753
Test Epoch6 threshold 0.9 Acc 0.9154605263157894, AUC 0.980629026889801, avg_entr 0.04834499955177307
ep6_t0.9_test_time 0.24878549575805664
gc 0
Train Epoch7 Acc 0.233075 (27969/120000), AUC 0.5245225429534912
ep7_train_time 7.984282732009888
Test Epoch7 threshold 0.9 Acc 0.9159539473684211, AUC 0.9805958867073059, avg_entr 0.045139379799366
ep7_t0.9_test_time 0.248518705368042
gc 0
Train Epoch8 Acc 0.22394166666666668 (26873/120000), AUC 0.5242408514022827
ep8_train_time 7.915467262268066
Test Epoch8 threshold 0.9 Acc 0.9164473684210527, AUC 0.9805719256401062, avg_entr 0.04290563240647316
ep8_t0.9_test_time 0.24765992164611816
gc 0
Train Epoch9 Acc 0.2228 (26736/120000), AUC 0.5241103768348694
ep9_train_time 8.246056318283081
Test Epoch9 threshold 0.9 Acc 0.9179276315789474, AUC 0.9804332852363586, avg_entr 0.04143200442194939
ep9_t0.9_test_time 0.25849127769470215
Best AUC 0.9807042479515076
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9263157894736842, AUC 0.9863773584365845, avg_entr 0.05363757535815239
t0.9_test_time 0.06458425521850586
