total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.16053333333333333 (19264/120000), AUC 0.432227224111557
ep0_train_time 9.303757905960083
Test Epoch0 threshold 0.7 Acc 0.9171052631578948, AUC 0.9808093905448914, avg_entr 0.025871047750115395
ep0_t0.7_test_time 0.25113892555236816
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.07856666666666667 (9428/120000), AUC 0.42616593837738037
ep1_train_time 8.96994948387146
Test Epoch1 threshold 0.7 Acc 0.9161184210526315, AUC 0.9807756543159485, avg_entr 0.025832965970039368
ep1_t0.7_test_time 0.2490828037261963
gc 0
Train Epoch2 Acc 0.12296666666666667 (14756/120000), AUC 0.4519609212875366
ep2_train_time 8.889538764953613
Test Epoch2 threshold 0.7 Acc 0.9169407894736842, AUC 0.9806140661239624, avg_entr 0.025993352755904198
ep2_t0.7_test_time 0.24920153617858887
gc 0
Train Epoch3 Acc 0.15969166666666668 (19163/120000), AUC 0.45601123571395874
ep3_train_time 9.21093201637268
Test Epoch3 threshold 0.7 Acc 0.9144736842105263, AUC 0.9804825186729431, avg_entr 0.026233606040477753
ep3_t0.7_test_time 0.2502434253692627
gc 0
Train Epoch4 Acc 0.20784166666666667 (24941/120000), AUC 0.46498072147369385
ep4_train_time 9.039774894714355
Test Epoch4 threshold 0.7 Acc 0.9154605263157894, AUC 0.980278491973877, avg_entr 0.027096662670373917
ep4_t0.7_test_time 0.2502765655517578
gc 0
Train Epoch5 Acc 0.257675 (30921/120000), AUC 0.44890785217285156
ep5_train_time 8.892271518707275
Test Epoch5 threshold 0.7 Acc 0.9151315789473684, AUC 0.9801840782165527, avg_entr 0.02637621946632862
ep5_t0.7_test_time 0.24866390228271484
gc 0
Train Epoch6 Acc 0.29045 (34854/120000), AUC 0.41686850786209106
ep6_train_time 8.937878608703613
Test Epoch6 threshold 0.7 Acc 0.9146381578947368, AUC 0.9800585508346558, avg_entr 0.026281096041202545
ep6_t0.7_test_time 0.24936842918395996
gc 0
Train Epoch7 Acc 0.32219166666666665 (38663/120000), AUC 0.3904693126678467
ep7_train_time 8.943938493728638
Test Epoch7 threshold 0.7 Acc 0.9136513157894737, AUC 0.9799296259880066, avg_entr 0.025938980281352997
ep7_t0.7_test_time 0.25002264976501465
gc 0
Train Epoch8 Acc 0.3460666666666667 (41528/120000), AUC 0.38417282700538635
ep8_train_time 9.01695990562439
Test Epoch8 threshold 0.7 Acc 0.9134868421052632, AUC 0.9798231720924377, avg_entr 0.026077738031744957
ep8_t0.7_test_time 0.24923014640808105
gc 0
Train Epoch9 Acc 0.353275 (42393/120000), AUC 0.38899919390678406
ep9_train_time 9.142571449279785
Test Epoch9 threshold 0.7 Acc 0.9143092105263158, AUC 0.9798374772071838, avg_entr 0.026113545522093773
ep9_t0.7_test_time 0.2585568428039551
Best AUC 0.9808093905448914
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.925, AUC 0.9866013526916504, avg_entr 0.025139527395367622
t0.7_test_time 0.06561827659606934
