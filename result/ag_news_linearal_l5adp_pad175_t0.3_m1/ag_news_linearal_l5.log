total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25028333333333336 (30034/120000), AUC 0.5494123101234436
ep0_train_time 8.811068773269653
Test Epoch0 threshold 0.3 Acc 0.8991776315789474, AUC 0.9743562936782837, avg_entr 0.1802414208650589
ep0_t0.3_test_time 0.2534043788909912
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.65735924243927
ep1_train_time 8.190804958343506
Test Epoch1 threshold 0.3 Acc 0.9088815789473684, AUC 0.9780659079551697, avg_entr 0.1052377000451088
ep1_t0.3_test_time 0.2530100345611572
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.6774152517318726
ep2_train_time 8.092570543289185
Test Epoch2 threshold 0.3 Acc 0.9116776315789473, AUC 0.979648232460022, avg_entr 0.08244241774082184
ep2_t0.3_test_time 0.2518801689147949
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.677970290184021
ep3_train_time 8.132679224014282
Test Epoch3 threshold 0.3 Acc 0.9151315789473684, AUC 0.9803915619850159, avg_entr 0.06665614992380142
ep3_t0.3_test_time 0.25301146507263184
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.6765798330307007
ep4_train_time 8.172991752624512
Test Epoch4 threshold 0.3 Acc 0.9166118421052631, AUC 0.9807856678962708, avg_entr 0.057959236204624176
ep4_t0.3_test_time 0.25250697135925293
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.6736745238304138
ep5_train_time 8.09500765800476
Test Epoch5 threshold 0.3 Acc 0.9144736842105263, AUC 0.9806909561157227, avg_entr 0.0528949573636055
ep5_t0.3_test_time 0.2530989646911621
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.6710667610168457
ep6_train_time 8.285897731781006
Test Epoch6 threshold 0.3 Acc 0.915625, AUC 0.9809367656707764, avg_entr 0.04978838935494423
ep6_t0.3_test_time 0.25176191329956055
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.6687111258506775
ep7_train_time 8.299583911895752
Test Epoch7 threshold 0.3 Acc 0.915296052631579, AUC 0.9807336330413818, avg_entr 0.04422565922141075
ep7_t0.3_test_time 0.2523345947265625
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.6665490865707397
ep8_train_time 8.118651866912842
Test Epoch8 threshold 0.3 Acc 0.9149671052631579, AUC 0.9807642102241516, avg_entr 0.04260464757680893
ep8_t0.3_test_time 0.2520287036895752
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.6647695302963257
ep9_train_time 8.155754566192627
Test Epoch9 threshold 0.3 Acc 0.9149671052631579, AUC 0.9806218147277832, avg_entr 0.03979361802339554
ep9_t0.3_test_time 0.2524080276489258
Best AUC 0.9809367656707764
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9223684210526316, AUC 0.9865642189979553, avg_entr 0.05175652727484703
t0.3_test_time 0.06377124786376953
