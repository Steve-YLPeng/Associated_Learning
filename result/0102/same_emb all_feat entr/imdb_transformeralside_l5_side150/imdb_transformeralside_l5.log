total count words 222751
vocab size 30000
found 27937 words in glove
model: TransformerALsideText(
  (layers): ModuleList(
    (0): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb): Embedding(30000, 300)
)
Start Training
gc 0
Train Epoch0 Acc 0.5075 (20300/40000), AUC 0.5041049718856812
Test Epoch0 layer0 Acc 0.526, AUC 0.5378042459487915, avg_entr 0.6904330253601074
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5573, AUC 0.5618317127227783, avg_entr 0.691602349281311
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.4981, AUC 0.49279552698135376, avg_entr 0.695135772228241
Test Epoch0 layer3 Acc 0.4999, AUC 0.5143672823905945, avg_entr 0.6919277310371399
Test Epoch0 layer4 Acc 0.5167, AUC 0.524407148361206, avg_entr 0.6970440149307251
gc 0
Train Epoch1 Acc 0.5395 (21580/40000), AUC 0.5475490093231201
Test Epoch1 layer0 Acc 0.5976, AUC 0.6335557699203491, avg_entr 0.6921498775482178
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.5804, AUC 0.6241461038589478, avg_entr 0.6929230690002441
Test Epoch1 layer2 Acc 0.563, AUC 0.5816159844398499, avg_entr 0.695976197719574
Test Epoch1 layer3 Acc 0.5148, AUC 0.5726995468139648, avg_entr 0.6931529641151428
Test Epoch1 layer4 Acc 0.5422, AUC 0.5927847623825073, avg_entr 0.6935944557189941
gc 0
Train Epoch2 Acc 0.569675 (22787/40000), AUC 0.5924277901649475
Test Epoch2 layer0 Acc 0.6253, AUC 0.7103489637374878, avg_entr 0.6488057374954224
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.6244, AUC 0.6953285932540894, avg_entr 0.6639511585235596
Test Epoch2 layer2 Acc 0.5472, AUC 0.6982048153877258, avg_entr 0.6760662794113159
Test Epoch2 layer3 Acc 0.5192, AUC 0.7018219232559204, avg_entr 0.6803622841835022
Test Epoch2 layer4 Acc 0.546, AUC 0.6517488360404968, avg_entr 0.68241286277771
gc 0
Train Epoch3 Acc 0.6139 (24556/40000), AUC 0.6627776026725769
Test Epoch3 layer0 Acc 0.6912, AUC 0.7684769630432129, avg_entr 0.6074131727218628
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.6843, AUC 0.7646297812461853, avg_entr 0.6140352487564087
Test Epoch3 layer2 Acc 0.6984, AUC 0.773389995098114, avg_entr 0.6075084805488586
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 3
Test Epoch3 layer3 Acc 0.7071, AUC 0.7844717502593994, avg_entr 0.599757969379425
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 3
Test Epoch3 layer4 Acc 0.6908, AUC 0.7785075306892395, avg_entr 0.575998067855835
gc 0
Train Epoch4 Acc 0.6975 (27900/40000), AUC 0.7711930274963379
Test Epoch4 layer0 Acc 0.7175, AUC 0.796495795249939, avg_entr 0.5405336618423462
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.709, AUC 0.8051812052726746, avg_entr 0.5256978869438171
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.7008, AUC 0.8143473863601685, avg_entr 0.4975687563419342
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 4
Test Epoch4 layer3 Acc 0.7072, AUC 0.8170482516288757, avg_entr 0.4914902448654175
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 4
Test Epoch4 layer4 Acc 0.7063, AUC 0.8165247440338135, avg_entr 0.4835243225097656
gc 0
Train Epoch5 Acc 0.738825 (29553/40000), AUC 0.8142420053482056
Test Epoch5 layer0 Acc 0.7408, AUC 0.8234786987304688, avg_entr 0.489046573638916
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.7322, AUC 0.8269513845443726, avg_entr 0.4709565043449402
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.7141, AUC 0.8349993228912354, avg_entr 0.44465264678001404
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 5
Test Epoch5 layer3 Acc 0.7127, AUC 0.8375167846679688, avg_entr 0.4311703145503998
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 5
Test Epoch5 layer4 Acc 0.6993, AUC 0.8365539908409119, avg_entr 0.412007212638855
gc 0
Train Epoch6 Acc 0.753525 (30141/40000), AUC 0.8319739103317261
Test Epoch6 layer0 Acc 0.7512, AUC 0.8377259373664856, avg_entr 0.44134002923965454
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.7493, AUC 0.8420557975769043, avg_entr 0.42245614528656006
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 6
Test Epoch6 layer2 Acc 0.7488, AUC 0.8483520150184631, avg_entr 0.3996337056159973
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 6
Test Epoch6 layer3 Acc 0.7424, AUC 0.8483844995498657, avg_entr 0.36024656891822815
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 6
Test Epoch6 layer4 Acc 0.745, AUC 0.8469454050064087, avg_entr 0.36018988490104675
gc 0
Train Epoch7 Acc 0.771425 (30857/40000), AUC 0.8526628017425537
Test Epoch7 layer0 Acc 0.7494, AUC 0.8515428304672241, avg_entr 0.3975650668144226
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 7
Test Epoch7 layer1 Acc 0.7582, AUC 0.8609695434570312, avg_entr 0.3808577060699463
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 7
Test Epoch7 layer2 Acc 0.7651, AUC 0.8642843961715698, avg_entr 0.36407557129859924
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 7
Test Epoch7 layer3 Acc 0.7718, AUC 0.8642585873603821, avg_entr 0.34536024928092957
Test Epoch7 layer4 Acc 0.7641, AUC 0.8630114793777466, avg_entr 0.3159926235675812
gc 0
Train Epoch8 Acc 0.778525 (31141/40000), AUC 0.8591970801353455
Test Epoch8 layer0 Acc 0.7624, AUC 0.8576945066452026, avg_entr 0.3802165687084198
Test Epoch8 layer1 Acc 0.776, AUC 0.8693647384643555, avg_entr 0.36657652258872986
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 8
Test Epoch8 layer2 Acc 0.7807, AUC 0.8719785213470459, avg_entr 0.3524990379810333
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 8
Test Epoch8 layer3 Acc 0.7834, AUC 0.8715552091598511, avg_entr 0.3282003402709961
Test Epoch8 layer4 Acc 0.7808, AUC 0.8704478740692139, avg_entr 0.31637945771217346
gc 0
Train Epoch9 Acc 0.791625 (31665/40000), AUC 0.8717032670974731
Test Epoch9 layer0 Acc 0.7717, AUC 0.8640878200531006, avg_entr 0.3564405143260956
Test Epoch9 layer1 Acc 0.783, AUC 0.8753513097763062, avg_entr 0.3330634534358978
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 9
Test Epoch9 layer2 Acc 0.7854, AUC 0.8772025108337402, avg_entr 0.3110225200653076
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 9
Test Epoch9 layer3 Acc 0.7904, AUC 0.8772112131118774, avg_entr 0.28528839349746704
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 9
Test Epoch9 layer4 Acc 0.7864, AUC 0.876121997833252, avg_entr 0.26334893703460693
gc 0
Train Epoch10 Acc 0.795025 (31801/40000), AUC 0.8747687935829163
Test Epoch10 layer0 Acc 0.7507, AUC 0.8679579496383667, avg_entr 0.30237483978271484
Test Epoch10 layer1 Acc 0.7624, AUC 0.879009485244751, avg_entr 0.282014399766922
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 10
Test Epoch10 layer2 Acc 0.7561, AUC 0.8810312747955322, avg_entr 0.25072115659713745
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 10
Test Epoch10 layer3 Acc 0.745, AUC 0.8816486597061157, avg_entr 0.21247141063213348
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 10
Test Epoch10 layer4 Acc 0.7452, AUC 0.8801519870758057, avg_entr 0.1907709687948227
gc 0
Train Epoch11 Acc 0.803175 (32127/40000), AUC 0.884529173374176
Test Epoch11 layer0 Acc 0.7884, AUC 0.8732033967971802, avg_entr 0.3063308894634247
Test Epoch11 layer1 Acc 0.8023, AUC 0.8853757977485657, avg_entr 0.27764376997947693
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 11
Test Epoch11 layer2 Acc 0.8036, AUC 0.8872894048690796, avg_entr 0.25475409626960754
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 11
Test Epoch11 layer3 Acc 0.802, AUC 0.8873553276062012, avg_entr 0.22978930175304413
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 11
Test Epoch11 layer4 Acc 0.8015, AUC 0.886406660079956, avg_entr 0.21220512688159943
gc 0
Train Epoch12 Acc 0.806475 (32259/40000), AUC 0.8877774477005005
Test Epoch12 layer0 Acc 0.7788, AUC 0.876532793045044, avg_entr 0.276564359664917
Test Epoch12 layer1 Acc 0.7872, AUC 0.889846682548523, avg_entr 0.2507268786430359
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 12
Test Epoch12 layer2 Acc 0.7897, AUC 0.8920755386352539, avg_entr 0.22730563580989838
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 12
Test Epoch12 layer3 Acc 0.7866, AUC 0.8924341201782227, avg_entr 0.20117983222007751
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 12
Test Epoch12 layer4 Acc 0.7884, AUC 0.891548752784729, avg_entr 0.18597085773944855
gc 0
Train Epoch13 Acc 0.8176 (32704/40000), AUC 0.8976006507873535
Test Epoch13 layer0 Acc 0.7912, AUC 0.880447268486023, avg_entr 0.28275585174560547
Test Epoch13 layer1 Acc 0.8042, AUC 0.8939650058746338, avg_entr 0.25257608294487
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 13
Test Epoch13 layer2 Acc 0.804, AUC 0.8957655429840088, avg_entr 0.21941399574279785
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 13
Test Epoch13 layer3 Acc 0.8024, AUC 0.8956155776977539, avg_entr 0.19397874176502228
Test Epoch13 layer4 Acc 0.7953, AUC 0.8952102065086365, avg_entr 0.1819516271352768
gc 0
Train Epoch14 Acc 0.821375 (32855/40000), AUC 0.9018367528915405
Test Epoch14 layer0 Acc 0.7924, AUC 0.8833412528038025, avg_entr 0.2642732858657837
Test Epoch14 layer1 Acc 0.8117, AUC 0.8965144157409668, avg_entr 0.23614685237407684
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 14
Test Epoch14 layer2 Acc 0.8147, AUC 0.8980768918991089, avg_entr 0.19947482645511627
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 14
Test Epoch14 layer3 Acc 0.8156, AUC 0.898277997970581, avg_entr 0.17433716356754303
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 14
Test Epoch14 layer4 Acc 0.8166, AUC 0.8980250358581543, avg_entr 0.16236218810081482
gc 0
Train Epoch15 Acc 0.823425 (32937/40000), AUC 0.9036746025085449
Test Epoch15 layer0 Acc 0.8006, AUC 0.8866637945175171, avg_entr 0.2511279881000519
Test Epoch15 layer1 Acc 0.8179, AUC 0.8981753587722778, avg_entr 0.21477800607681274
Test Epoch15 layer2 Acc 0.8181, AUC 0.8998849391937256, avg_entr 0.17513470351696014
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 15
Test Epoch15 layer3 Acc 0.8187, AUC 0.9004682898521423, avg_entr 0.1546836644411087
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 15
Test Epoch15 layer4 Acc 0.8188, AUC 0.9003105163574219, avg_entr 0.14490236341953278
gc 0
Train Epoch16 Acc 0.828875 (33155/40000), AUC 0.9079549312591553
Test Epoch16 layer0 Acc 0.7932, AUC 0.8895254135131836, avg_entr 0.24549727141857147
Test Epoch16 layer1 Acc 0.804, AUC 0.8995669484138489, avg_entr 0.21032895147800446
Test Epoch16 layer2 Acc 0.8039, AUC 0.9006476402282715, avg_entr 0.16210579872131348
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 16
Test Epoch16 layer3 Acc 0.8061, AUC 0.9015287160873413, avg_entr 0.14638571441173553
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 16
Test Epoch16 layer4 Acc 0.8051, AUC 0.9016762375831604, avg_entr 0.13568077981472015
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.832675 (33307/40000), AUC 0.9115819334983826
Test Epoch17 layer0 Acc 0.805, AUC 0.8921360969543457, avg_entr 0.2240324169397354
Test Epoch17 layer1 Acc 0.8145, AUC 0.9011682271957397, avg_entr 0.17911222577095032
Test Epoch17 layer2 Acc 0.8147, AUC 0.9021120071411133, avg_entr 0.13739661872386932
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 17
Test Epoch17 layer3 Acc 0.8162, AUC 0.9036271572113037, avg_entr 0.12466748058795929
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 17
Test Epoch17 layer4 Acc 0.813, AUC 0.9040194749832153, avg_entr 0.11983627080917358
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 17
gc 0
Train Epoch18 Acc 0.83875 (33550/40000), AUC 0.9167112112045288
Test Epoch18 layer0 Acc 0.8017, AUC 0.8938647508621216, avg_entr 0.21234770119190216
Test Epoch18 layer1 Acc 0.8128, AUC 0.9021989107131958, avg_entr 0.16093359887599945
Test Epoch18 layer2 Acc 0.8172, AUC 0.903640627861023, avg_entr 0.11788288503885269
Test Epoch18 layer3 Acc 0.8174, AUC 0.9054511189460754, avg_entr 0.10606179386377335
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 18
Test Epoch18 layer4 Acc 0.8136, AUC 0.9057937860488892, avg_entr 0.10077518224716187
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 18
gc 0
Train Epoch19 Acc 0.8405 (33620/40000), AUC 0.9180215001106262
Test Epoch19 layer0 Acc 0.812, AUC 0.8958591222763062, avg_entr 0.21244826912879944
Test Epoch19 layer1 Acc 0.823, AUC 0.9042613506317139, avg_entr 0.15293432772159576
Test Epoch19 layer2 Acc 0.8251, AUC 0.9055799841880798, avg_entr 0.12267261743545532
Test Epoch19 layer3 Acc 0.8257, AUC 0.9069534540176392, avg_entr 0.11909840255975723
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 19
Test Epoch19 layer4 Acc 0.8249, AUC 0.907343864440918, avg_entr 0.11581646651029587
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 19
gc 0
Train Epoch20 Acc 0.8451 (33804/40000), AUC 0.9223849773406982
Test Epoch20 layer0 Acc 0.8107, AUC 0.8968819379806519, avg_entr 0.20601218938827515
Test Epoch20 layer1 Acc 0.8199, AUC 0.90407395362854, avg_entr 0.13528884947299957
Test Epoch20 layer2 Acc 0.8238, AUC 0.9067127108573914, avg_entr 0.11127724498510361
Test Epoch20 layer3 Acc 0.825, AUC 0.9082780480384827, avg_entr 0.1050274446606636
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 20
Test Epoch20 layer4 Acc 0.8237, AUC 0.9086486101150513, avg_entr 0.09795819222927094
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 20
gc 0
Train Epoch21 Acc 0.848575 (33943/40000), AUC 0.9240325093269348
Test Epoch21 layer0 Acc 0.7944, AUC 0.8981671333312988, avg_entr 0.19773481786251068
Test Epoch21 layer1 Acc 0.8061, AUC 0.9052383899688721, avg_entr 0.12305764108896255
Test Epoch21 layer2 Acc 0.8088, AUC 0.907935619354248, avg_entr 0.10983980447053909
Test Epoch21 layer3 Acc 0.8113, AUC 0.9088572263717651, avg_entr 0.11084271222352982
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 21
Test Epoch21 layer4 Acc 0.8107, AUC 0.9095619916915894, avg_entr 0.10821010917425156
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 21
gc 0
Train Epoch22 Acc 0.853075 (34123/40000), AUC 0.9268794059753418
Test Epoch22 layer0 Acc 0.8119, AUC 0.8990587592124939, avg_entr 0.19577986001968384
Test Epoch22 layer1 Acc 0.8201, AUC 0.9062789678573608, avg_entr 0.11554168909788132
Test Epoch22 layer2 Acc 0.82, AUC 0.9092063903808594, avg_entr 0.10116151720285416
Test Epoch22 layer3 Acc 0.8244, AUC 0.9106168746948242, avg_entr 0.10453622788190842
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 22
Test Epoch22 layer4 Acc 0.8249, AUC 0.911462128162384, avg_entr 0.10143160074949265
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 22
gc 0
Train Epoch23 Acc 0.856575 (34263/40000), AUC 0.9301953315734863
Test Epoch23 layer0 Acc 0.8195, AUC 0.9002139568328857, avg_entr 0.175942063331604
Test Epoch23 layer1 Acc 0.8253, AUC 0.9070644974708557, avg_entr 0.09822836518287659
Test Epoch23 layer2 Acc 0.8297, AUC 0.9095768332481384, avg_entr 0.08870986104011536
Test Epoch23 layer3 Acc 0.8291, AUC 0.9102266430854797, avg_entr 0.08706977218389511
Test Epoch23 layer4 Acc 0.8291, AUC 0.9111335873603821, avg_entr 0.08729901164770126
gc 0
Train Epoch24 Acc 0.8605 (34420/40000), AUC 0.9338075518608093
Test Epoch24 layer0 Acc 0.8188, AUC 0.9006054997444153, avg_entr 0.17955425381660461
Test Epoch24 layer1 Acc 0.827, AUC 0.9072237014770508, avg_entr 0.09367653727531433
Test Epoch24 layer2 Acc 0.8296, AUC 0.9106506109237671, avg_entr 0.07988987863063812
Test Epoch24 layer3 Acc 0.8295, AUC 0.9112154841423035, avg_entr 0.07481158524751663
Test Epoch24 layer4 Acc 0.829, AUC 0.9120992422103882, avg_entr 0.07394132018089294
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 24
gc 0
Train Epoch25 Acc 0.863925 (34557/40000), AUC 0.9362956881523132
Test Epoch25 layer0 Acc 0.8123, AUC 0.9010417461395264, avg_entr 0.17204231023788452
Test Epoch25 layer1 Acc 0.8191, AUC 0.9069373607635498, avg_entr 0.09349262714385986
Test Epoch25 layer2 Acc 0.8193, AUC 0.9105592966079712, avg_entr 0.07935769855976105
Test Epoch25 layer3 Acc 0.8219, AUC 0.9107321500778198, avg_entr 0.07807987928390503
Test Epoch25 layer4 Acc 0.8223, AUC 0.912163257598877, avg_entr 0.08262886106967926
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 25
gc 0
Train Epoch26 Acc 0.8671 (34684/40000), AUC 0.9381794929504395
Test Epoch26 layer0 Acc 0.8201, AUC 0.9014897346496582, avg_entr 0.16471266746520996
Test Epoch26 layer1 Acc 0.8267, AUC 0.908373236656189, avg_entr 0.08533880859613419
Test Epoch26 layer2 Acc 0.8319, AUC 0.9109619855880737, avg_entr 0.07677830755710602
Test Epoch26 layer3 Acc 0.8309, AUC 0.9108275771141052, avg_entr 0.07274587452411652
Test Epoch26 layer4 Acc 0.8306, AUC 0.9120258688926697, avg_entr 0.07316624373197556
gc 0
Train Epoch27 Acc 0.870525 (34821/40000), AUC 0.941058874130249
Test Epoch27 layer0 Acc 0.8199, AUC 0.9020535945892334, avg_entr 0.1621786653995514
Test Epoch27 layer1 Acc 0.8268, AUC 0.9092914462089539, avg_entr 0.08147727698087692
Test Epoch27 layer2 Acc 0.8327, AUC 0.9118844866752625, avg_entr 0.0750044509768486
Test Epoch27 layer3 Acc 0.8329, AUC 0.9119781255722046, avg_entr 0.0747598335146904
Test Epoch27 layer4 Acc 0.8328, AUC 0.9130895137786865, avg_entr 0.074571393430233
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 27
gc 0
Train Epoch28 Acc 0.87465 (34986/40000), AUC 0.9424737095832825
Test Epoch28 layer0 Acc 0.8064, AUC 0.9010659456253052, avg_entr 0.1586267650127411
Test Epoch28 layer1 Acc 0.8068, AUC 0.9035985469818115, avg_entr 0.07975883036851883
Test Epoch28 layer2 Acc 0.8037, AUC 0.9099066257476807, avg_entr 0.0721227154135704
Test Epoch28 layer3 Acc 0.8112, AUC 0.9097728729248047, avg_entr 0.07466287910938263
Test Epoch28 layer4 Acc 0.8084, AUC 0.9112647771835327, avg_entr 0.0755196139216423
gc 0
Train Epoch29 Acc 0.875125 (35005/40000), AUC 0.9445774555206299
Test Epoch29 layer0 Acc 0.8171, AUC 0.9019949436187744, avg_entr 0.14416079223155975
Test Epoch29 layer1 Acc 0.8242, AUC 0.90827476978302, avg_entr 0.07230868190526962
Test Epoch29 layer2 Acc 0.8283, AUC 0.9117421507835388, avg_entr 0.06794480234384537
Test Epoch29 layer3 Acc 0.8271, AUC 0.9119399785995483, avg_entr 0.0665941834449768
Test Epoch29 layer4 Acc 0.8283, AUC 0.9132411479949951, avg_entr 0.0675901472568512
Save ckpt to ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt  ,ep 29
gc 0
Train Epoch30 Acc 0.877325 (35093/40000), AUC 0.9465090036392212
Test Epoch30 layer0 Acc 0.8172, AUC 0.9022132158279419, avg_entr 0.14486894011497498
Test Epoch30 layer1 Acc 0.8268, AUC 0.9069709777832031, avg_entr 0.06948735564947128
Test Epoch30 layer2 Acc 0.8276, AUC 0.9108313322067261, avg_entr 0.06320556998252869
Test Epoch30 layer3 Acc 0.8306, AUC 0.9107192754745483, avg_entr 0.0652269721031189
Test Epoch30 layer4 Acc 0.8297, AUC 0.911815881729126, avg_entr 0.06647336483001709
gc 0
Train Epoch31 Acc 0.880075 (35203/40000), AUC 0.9480665922164917
Test Epoch31 layer0 Acc 0.8194, AUC 0.9015182852745056, avg_entr 0.14449428021907806
Test Epoch31 layer1 Acc 0.8296, AUC 0.9076143503189087, avg_entr 0.0672278106212616
Test Epoch31 layer2 Acc 0.8305, AUC 0.9103538393974304, avg_entr 0.06014246866106987
Test Epoch31 layer3 Acc 0.8304, AUC 0.9105177521705627, avg_entr 0.06055242195725441
Test Epoch31 layer4 Acc 0.8315, AUC 0.911742091178894, avg_entr 0.057343922555446625
gc 0
Train Epoch32 Acc 0.889675 (35587/40000), AUC 0.9544167518615723
Test Epoch32 layer0 Acc 0.8217, AUC 0.9018964767456055, avg_entr 0.13426488637924194
Test Epoch32 layer1 Acc 0.831, AUC 0.9076507091522217, avg_entr 0.060865797102451324
Test Epoch32 layer2 Acc 0.8338, AUC 0.9094575643539429, avg_entr 0.05568503960967064
Test Epoch32 layer3 Acc 0.8334, AUC 0.9099570512771606, avg_entr 0.05633627995848656
Test Epoch32 layer4 Acc 0.8338, AUC 0.9111809134483337, avg_entr 0.05791378766298294
gc 0
Train Epoch33 Acc 0.889325 (35573/40000), AUC 0.9557504057884216
Test Epoch33 layer0 Acc 0.8227, AUC 0.9011245965957642, avg_entr 0.13698028028011322
Test Epoch33 layer1 Acc 0.8291, AUC 0.9073691368103027, avg_entr 0.06305918097496033
Test Epoch33 layer2 Acc 0.8325, AUC 0.9097388982772827, avg_entr 0.05915579944849014
Test Epoch33 layer3 Acc 0.8327, AUC 0.9103826284408569, avg_entr 0.06496359407901764
Test Epoch33 layer4 Acc 0.8347, AUC 0.9117311239242554, avg_entr 0.06260444968938828
gc 0
Train Epoch34 Acc 0.8948 (35792/40000), AUC 0.958795428276062
Test Epoch34 layer0 Acc 0.8162, AUC 0.9013364315032959, avg_entr 0.12101496756076813
Test Epoch34 layer1 Acc 0.8236, AUC 0.905979573726654, avg_entr 0.0566173754632473
Test Epoch34 layer2 Acc 0.8288, AUC 0.9084416627883911, avg_entr 0.049183089286088943
Test Epoch34 layer3 Acc 0.8285, AUC 0.9082381725311279, avg_entr 0.04880516231060028
Test Epoch34 layer4 Acc 0.8272, AUC 0.9100058078765869, avg_entr 0.047756705433130264
gc 0
Train Epoch35 Acc 0.89705 (35882/40000), AUC 0.9609353542327881
Test Epoch35 layer0 Acc 0.8214, AUC 0.900088369846344, avg_entr 0.12740978598594666
Test Epoch35 layer1 Acc 0.8266, AUC 0.9040969610214233, avg_entr 0.0557420589029789
Test Epoch35 layer2 Acc 0.8281, AUC 0.9061195850372314, avg_entr 0.04890064522624016
Test Epoch35 layer3 Acc 0.8282, AUC 0.9066933393478394, avg_entr 0.0501495897769928
Test Epoch35 layer4 Acc 0.8298, AUC 0.9085063934326172, avg_entr 0.05060422420501709
gc 0
Train Epoch36 Acc 0.90045 (36018/40000), AUC 0.9632680416107178
Test Epoch36 layer0 Acc 0.8202, AUC 0.8991109728813171, avg_entr 0.12716366350650787
Test Epoch36 layer1 Acc 0.8259, AUC 0.9033293128013611, avg_entr 0.05566047504544258
Test Epoch36 layer2 Acc 0.8292, AUC 0.9065837860107422, avg_entr 0.04684877768158913
Test Epoch36 layer3 Acc 0.8287, AUC 0.9070122838020325, avg_entr 0.04728654772043228
Test Epoch36 layer4 Acc 0.8305, AUC 0.908521831035614, avg_entr 0.0468423031270504
gc 0
Train Epoch37 Acc 0.903925 (36157/40000), AUC 0.9640544056892395
Test Epoch37 layer0 Acc 0.818, AUC 0.8995898365974426, avg_entr 0.1262197196483612
Test Epoch37 layer1 Acc 0.8221, AUC 0.9013302326202393, avg_entr 0.056391071528196335
Test Epoch37 layer2 Acc 0.8239, AUC 0.9052962064743042, avg_entr 0.04888419806957245
Test Epoch37 layer3 Acc 0.827, AUC 0.9060283899307251, avg_entr 0.048963405191898346
Test Epoch37 layer4 Acc 0.827, AUC 0.9073132872581482, avg_entr 0.052214525640010834
gc 0
Train Epoch38 Acc 0.9043 (36172/40000), AUC 0.9651311635971069
Test Epoch38 layer0 Acc 0.8202, AUC 0.8999441862106323, avg_entr 0.11909523606300354
Test Epoch38 layer1 Acc 0.8266, AUC 0.9024980068206787, avg_entr 0.05168076232075691
Test Epoch38 layer2 Acc 0.8286, AUC 0.9061574935913086, avg_entr 0.045347925275564194
Test Epoch38 layer3 Acc 0.8289, AUC 0.9061718583106995, avg_entr 0.04559420421719551
Test Epoch38 layer4 Acc 0.8296, AUC 0.9078546762466431, avg_entr 0.046297311782836914
gc 0
Train Epoch39 Acc 0.90635 (36254/40000), AUC 0.9659647941589355
Test Epoch39 layer0 Acc 0.8172, AUC 0.8990724086761475, avg_entr 0.11932849138975143
Test Epoch39 layer1 Acc 0.8236, AUC 0.9004563689231873, avg_entr 0.05250484496355057
Test Epoch39 layer2 Acc 0.8265, AUC 0.9042030572891235, avg_entr 0.04411213472485542
Test Epoch39 layer3 Acc 0.8292, AUC 0.9044579267501831, avg_entr 0.04421185702085495
Test Epoch39 layer4 Acc 0.8308, AUC 0.9061779975891113, avg_entr 0.044681794941425323
gc 0
Train Epoch40 Acc 0.90825 (36330/40000), AUC 0.9677759408950806
Test Epoch40 layer0 Acc 0.818, AUC 0.8988994359970093, avg_entr 0.11927834153175354
Test Epoch40 layer1 Acc 0.8258, AUC 0.9008059501647949, avg_entr 0.050372906029224396
Test Epoch40 layer2 Acc 0.8294, AUC 0.9049233198165894, avg_entr 0.04238663241267204
Test Epoch40 layer3 Acc 0.83, AUC 0.905200183391571, avg_entr 0.043077465146780014
Test Epoch40 layer4 Acc 0.8316, AUC 0.9067227840423584, avg_entr 0.04239540547132492
gc 0
Train Epoch41 Acc 0.9096 (36384/40000), AUC 0.9684831500053406
Test Epoch41 layer0 Acc 0.8176, AUC 0.8987734317779541, avg_entr 0.1187519058585167
Test Epoch41 layer1 Acc 0.8249, AUC 0.9002698659896851, avg_entr 0.04981343448162079
Test Epoch41 layer2 Acc 0.8289, AUC 0.9043774604797363, avg_entr 0.041307032108306885
Test Epoch41 layer3 Acc 0.8285, AUC 0.904636025428772, avg_entr 0.042413122951984406
Test Epoch41 layer4 Acc 0.8288, AUC 0.9064784049987793, avg_entr 0.0420512892305851
gc 0
Train Epoch42 Acc 0.910425 (36417/40000), AUC 0.9688701033592224
Test Epoch42 layer0 Acc 0.8208, AUC 0.897911012172699, avg_entr 0.11812421679496765
Test Epoch42 layer1 Acc 0.8245, AUC 0.8997457027435303, avg_entr 0.04842598736286163
Test Epoch42 layer2 Acc 0.8277, AUC 0.903569221496582, avg_entr 0.042914390563964844
Test Epoch42 layer3 Acc 0.8278, AUC 0.9039559364318848, avg_entr 0.04417902231216431
Test Epoch42 layer4 Acc 0.8293, AUC 0.905649721622467, avg_entr 0.04408925771713257
gc 0
Train Epoch43 Acc 0.9114 (36456/40000), AUC 0.9693443179130554
Test Epoch43 layer0 Acc 0.8193, AUC 0.8983851075172424, avg_entr 0.1148332878947258
Test Epoch43 layer1 Acc 0.8253, AUC 0.898747444152832, avg_entr 0.04756641760468483
Test Epoch43 layer2 Acc 0.8268, AUC 0.9031046628952026, avg_entr 0.04012530297040939
Test Epoch43 layer3 Acc 0.8261, AUC 0.9035651683807373, avg_entr 0.040990348905324936
Test Epoch43 layer4 Acc 0.8282, AUC 0.9050757884979248, avg_entr 0.04083726927638054
gc 0
Train Epoch44 Acc 0.912925 (36517/40000), AUC 0.9702255725860596
Test Epoch44 layer0 Acc 0.8173, AUC 0.8976930379867554, avg_entr 0.1131371557712555
Test Epoch44 layer1 Acc 0.8238, AUC 0.8984414935112, avg_entr 0.04695342853665352
Test Epoch44 layer2 Acc 0.8255, AUC 0.9025435447692871, avg_entr 0.040092583745718
Test Epoch44 layer3 Acc 0.8263, AUC 0.9029322862625122, avg_entr 0.04029511660337448
Test Epoch44 layer4 Acc 0.8271, AUC 0.9043527841567993, avg_entr 0.03821820765733719
gc 0
Train Epoch45 Acc 0.912925 (36517/40000), AUC 0.9705344438552856
Test Epoch45 layer0 Acc 0.8152, AUC 0.8973168730735779, avg_entr 0.11444515734910965
Test Epoch45 layer1 Acc 0.8208, AUC 0.8968014717102051, avg_entr 0.04650738090276718
Test Epoch45 layer2 Acc 0.8248, AUC 0.9013699889183044, avg_entr 0.04020700976252556
Test Epoch45 layer3 Acc 0.827, AUC 0.9020475149154663, avg_entr 0.04075087979435921
Test Epoch45 layer4 Acc 0.8263, AUC 0.9037482738494873, avg_entr 0.0401792973279953
gc 0
Train Epoch46 Acc 0.9132 (36528/40000), AUC 0.9704847931861877
Test Epoch46 layer0 Acc 0.8154, AUC 0.8980326652526855, avg_entr 0.11156455427408218
Test Epoch46 layer1 Acc 0.8246, AUC 0.897854208946228, avg_entr 0.04609421268105507
Test Epoch46 layer2 Acc 0.8253, AUC 0.9018377065658569, avg_entr 0.03931085765361786
Test Epoch46 layer3 Acc 0.8272, AUC 0.9023321866989136, avg_entr 0.038762547075748444
Test Epoch46 layer4 Acc 0.8271, AUC 0.9038299322128296, avg_entr 0.037284962832927704
gc 0
Train Epoch47 Acc 0.913825 (36553/40000), AUC 0.9712697267532349
Test Epoch47 layer0 Acc 0.8171, AUC 0.8974611759185791, avg_entr 0.1119844987988472
Test Epoch47 layer1 Acc 0.8245, AUC 0.8972585797309875, avg_entr 0.04623278230428696
Test Epoch47 layer2 Acc 0.8244, AUC 0.9011920690536499, avg_entr 0.039200205355882645
Test Epoch47 layer3 Acc 0.8258, AUC 0.901701807975769, avg_entr 0.03841596841812134
Test Epoch47 layer4 Acc 0.8279, AUC 0.9030641317367554, avg_entr 0.03691251948475838
gc 0
Train Epoch48 Acc 0.91545 (36618/40000), AUC 0.9715113639831543
Test Epoch48 layer0 Acc 0.8153, AUC 0.8971588611602783, avg_entr 0.11190711706876755
Test Epoch48 layer1 Acc 0.8243, AUC 0.896571934223175, avg_entr 0.046222105622291565
Test Epoch48 layer2 Acc 0.8237, AUC 0.9003840684890747, avg_entr 0.03964093700051308
Test Epoch48 layer3 Acc 0.8264, AUC 0.9009588956832886, avg_entr 0.03956728056073189
Test Epoch48 layer4 Acc 0.8264, AUC 0.9024343490600586, avg_entr 0.03894917294383049
gc 0
Train Epoch49 Acc 0.9148 (36592/40000), AUC 0.9714775085449219
Test Epoch49 layer0 Acc 0.8176, AUC 0.8974385261535645, avg_entr 0.1110052764415741
Test Epoch49 layer1 Acc 0.8249, AUC 0.8967235088348389, avg_entr 0.04562325403094292
Test Epoch49 layer2 Acc 0.8239, AUC 0.9005343317985535, avg_entr 0.037994664162397385
Test Epoch49 layer3 Acc 0.8262, AUC 0.9009689092636108, avg_entr 0.03695270046591759
Test Epoch49 layer4 Acc 0.826, AUC 0.902225136756897, avg_entr 0.03583201766014099
Best AUC 0.9132411479949951
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_transformeralside_l5_side150//imdb_transformeralside_l5_side.pt
[[4415  606]
 [1223 3756]]
Figure(640x480)
tensor([4.4569e-04, 4.0481e-05, 6.8549e-01,  ..., 7.4890e-04, 1.1974e-03,
        3.0782e-05])
[[4457  564]
 [1194 3785]]
Figure(640x480)
tensor([0.0017, 0.0010, 0.6840,  ..., 0.0016, 0.0034, 0.0013])
[[4426  595]
 [1122 3857]]
Figure(640x480)
tensor([0.0014, 0.0004, 0.2347,  ..., 0.0007, 0.0026, 0.0007])
[[4471  550]
 [1179 3800]]
Figure(640x480)
tensor([2.3361e-03, 3.0013e-04, 3.3932e-01,  ..., 5.4465e-04, 2.3361e-03,
        6.9307e-04])
[[4487  534]
 [1183 3796]]
Figure(640x480)
tensor([0.0048, 0.0006, 0.2615,  ..., 0.0008, 0.0019, 0.0009])
