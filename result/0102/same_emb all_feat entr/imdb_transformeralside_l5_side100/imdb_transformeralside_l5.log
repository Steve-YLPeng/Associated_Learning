total count words 222751
vocab size 30000
found 27937 words in glove
model: TransformerALsideText(
  (layers): ModuleList(
    (0): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb): Embedding(30000, 300)
)
Start Training
gc 0
Train Epoch0 Acc 0.49985 (19994/40000), AUC 0.49809694290161133
Test Epoch0 layer0 Acc 0.5482, AUC 0.5615208148956299, avg_entr 0.7060394287109375
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5243, AUC 0.5241066217422485, avg_entr 0.7097421288490295
Test Epoch0 layer2 Acc 0.5317, AUC 0.5303902626037598, avg_entr 0.7016843557357788
Test Epoch0 layer3 Acc 0.4797, AUC 0.4739302396774292, avg_entr 0.7038850784301758
Test Epoch0 layer4 Acc 0.5136, AUC 0.5243139863014221, avg_entr 0.7042572498321533
gc 0
Train Epoch1 Acc 0.531475 (21259/40000), AUC 0.5431208610534668
Test Epoch1 layer0 Acc 0.5794, AUC 0.6466196775436401, avg_entr 0.6925177574157715
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.607, AUC 0.6540020108222961, avg_entr 0.6945505142211914
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.5862, AUC 0.6258190870285034, avg_entr 0.688652753829956
Test Epoch1 layer3 Acc 0.5578, AUC 0.5735335350036621, avg_entr 0.6954922080039978
Test Epoch1 layer4 Acc 0.5496, AUC 0.6129706501960754, avg_entr 0.6895636916160583
gc 0
Train Epoch2 Acc 0.589375 (23575/40000), AUC 0.6283993721008301
Test Epoch2 layer0 Acc 0.6403, AUC 0.7050167918205261, avg_entr 0.6600895524024963
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.6209, AUC 0.6824078559875488, avg_entr 0.6593102216720581
Test Epoch2 layer2 Acc 0.6029, AUC 0.6820045709609985, avg_entr 0.6538111567497253
Test Epoch2 layer3 Acc 0.6171, AUC 0.6820681095123291, avg_entr 0.6649119853973389
Test Epoch2 layer4 Acc 0.5867, AUC 0.6811384558677673, avg_entr 0.663654088973999
gc 0
Train Epoch3 Acc 0.6188 (24752/40000), AUC 0.6704949140548706
Test Epoch3 layer0 Acc 0.6772, AUC 0.7399064898490906, avg_entr 0.6225329637527466
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.6616, AUC 0.7254617214202881, avg_entr 0.6192814707756042
Test Epoch3 layer2 Acc 0.6607, AUC 0.7326259016990662, avg_entr 0.6098718047142029
Test Epoch3 layer3 Acc 0.6656, AUC 0.7306482791900635, avg_entr 0.6240369081497192
Test Epoch3 layer4 Acc 0.6655, AUC 0.7267909049987793, avg_entr 0.6225550174713135
gc 0
Train Epoch4 Acc 0.6508 (26032/40000), AUC 0.7104833126068115
Test Epoch4 layer0 Acc 0.6926, AUC 0.760583758354187, avg_entr 0.5707263946533203
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.7004, AUC 0.7697303295135498, avg_entr 0.5616211891174316
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.7114, AUC 0.7774221897125244, avg_entr 0.5396519303321838
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 4
Test Epoch4 layer3 Acc 0.7162, AUC 0.7900859117507935, avg_entr 0.5210115313529968
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 4
Test Epoch4 layer4 Acc 0.7143, AUC 0.7874981164932251, avg_entr 0.5156797766685486
gc 0
Train Epoch5 Acc 0.692825 (27713/40000), AUC 0.7641152143478394
Test Epoch5 layer0 Acc 0.7131, AUC 0.7895389199256897, avg_entr 0.520577609539032
Test Epoch5 layer1 Acc 0.7018, AUC 0.7987884879112244, avg_entr 0.49922260642051697
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.7008, AUC 0.8104995489120483, avg_entr 0.48433738946914673
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 5
Test Epoch5 layer3 Acc 0.7061, AUC 0.8125172853469849, avg_entr 0.49307143688201904
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 5
Test Epoch5 layer4 Acc 0.7096, AUC 0.8098649978637695, avg_entr 0.498233437538147
gc 0
Train Epoch6 Acc 0.718825 (28753/40000), AUC 0.7944996356964111
Test Epoch6 layer0 Acc 0.719, AUC 0.8096737861633301, avg_entr 0.4733358323574066
Test Epoch6 layer1 Acc 0.6853, AUC 0.8188228607177734, avg_entr 0.44687193632125854
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 6
Test Epoch6 layer2 Acc 0.666, AUC 0.8299605250358582, avg_entr 0.4415088891983032
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 6
Test Epoch6 layer3 Acc 0.6328, AUC 0.8297179937362671, avg_entr 0.43515992164611816
Test Epoch6 layer4 Acc 0.5961, AUC 0.8270986080169678, avg_entr 0.42678603529930115
gc 0
Train Epoch7 Acc 0.734075 (29363/40000), AUC 0.8124607801437378
Test Epoch7 layer0 Acc 0.7358, AUC 0.8186563849449158, avg_entr 0.4397521913051605
Test Epoch7 layer1 Acc 0.7473, AUC 0.8284858465194702, avg_entr 0.432445228099823
Test Epoch7 layer2 Acc 0.7551, AUC 0.8392007350921631, avg_entr 0.4128526747226715
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 7
Test Epoch7 layer3 Acc 0.7503, AUC 0.8385962247848511, avg_entr 0.40683868527412415
Test Epoch7 layer4 Acc 0.7477, AUC 0.8368009328842163, avg_entr 0.40008050203323364
gc 0
Train Epoch8 Acc 0.7481 (29924/40000), AUC 0.8294382095336914
Test Epoch8 layer0 Acc 0.7429, AUC 0.8247374892234802, avg_entr 0.39782238006591797
Test Epoch8 layer1 Acc 0.7551, AUC 0.8361327648162842, avg_entr 0.38527584075927734
Test Epoch8 layer2 Acc 0.7644, AUC 0.8445720672607422, avg_entr 0.3684964179992676
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 8
Test Epoch8 layer3 Acc 0.7611, AUC 0.8435064554214478, avg_entr 0.3632785379886627
Test Epoch8 layer4 Acc 0.7592, AUC 0.842087984085083, avg_entr 0.35854288935661316
gc 0
Train Epoch9 Acc 0.7574 (30296/40000), AUC 0.8367825746536255
Test Epoch9 layer0 Acc 0.745, AUC 0.8311609625816345, avg_entr 0.3882538974285126
Test Epoch9 layer1 Acc 0.7468, AUC 0.8444483876228333, avg_entr 0.3629518449306488
Test Epoch9 layer2 Acc 0.7534, AUC 0.8534768223762512, avg_entr 0.3447948396205902
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 9
Test Epoch9 layer3 Acc 0.7452, AUC 0.8550021648406982, avg_entr 0.3426385819911957
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 9
Test Epoch9 layer4 Acc 0.7345, AUC 0.853853702545166, avg_entr 0.33213841915130615
gc 0
Train Epoch10 Acc 0.7622 (30488/40000), AUC 0.8451675176620483
Test Epoch10 layer0 Acc 0.7502, AUC 0.8377029895782471, avg_entr 0.3700152039527893
Test Epoch10 layer1 Acc 0.7578, AUC 0.850540280342102, avg_entr 0.3475174605846405
Test Epoch10 layer2 Acc 0.7711, AUC 0.859332263469696, avg_entr 0.32703897356987
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 10
Test Epoch10 layer3 Acc 0.7707, AUC 0.860532283782959, avg_entr 0.31414180994033813
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 10
Test Epoch10 layer4 Acc 0.7702, AUC 0.8593456745147705, avg_entr 0.29540252685546875
gc 0
Train Epoch11 Acc 0.771625 (30865/40000), AUC 0.8538882732391357
Test Epoch11 layer0 Acc 0.7567, AUC 0.8398485779762268, avg_entr 0.3361586034297943
Test Epoch11 layer1 Acc 0.773, AUC 0.854180634021759, avg_entr 0.3087941110134125
Test Epoch11 layer2 Acc 0.7771, AUC 0.8613840341567993, avg_entr 0.27954158186912537
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 11
Test Epoch11 layer3 Acc 0.7721, AUC 0.8627362251281738, avg_entr 0.26511436700820923
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 11
Test Epoch11 layer4 Acc 0.7705, AUC 0.8617655634880066, avg_entr 0.2498801201581955
gc 0
Train Epoch12 Acc 0.778275 (31131/40000), AUC 0.8619455099105835
Test Epoch12 layer0 Acc 0.7589, AUC 0.8434832096099854, avg_entr 0.3132033050060272
Test Epoch12 layer1 Acc 0.7675, AUC 0.8584734797477722, avg_entr 0.28150081634521484
Test Epoch12 layer2 Acc 0.7717, AUC 0.8651227951049805, avg_entr 0.25179174542427063
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 12
Test Epoch12 layer3 Acc 0.771, AUC 0.8663526773452759, avg_entr 0.22818239033222198
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 12
Test Epoch12 layer4 Acc 0.7705, AUC 0.8654698133468628, avg_entr 0.20835651457309723
gc 0
Train Epoch13 Acc 0.785075 (31403/40000), AUC 0.8674976825714111
Test Epoch13 layer0 Acc 0.7502, AUC 0.8466413021087646, avg_entr 0.29048267006874084
Test Epoch13 layer1 Acc 0.755, AUC 0.861073911190033, avg_entr 0.26314088702201843
Test Epoch13 layer2 Acc 0.7565, AUC 0.8672960996627808, avg_entr 0.22395454347133636
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 13
Test Epoch13 layer3 Acc 0.7583, AUC 0.8683599233627319, avg_entr 0.20279650390148163
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 13
Test Epoch13 layer4 Acc 0.7585, AUC 0.8670507669448853, avg_entr 0.18520043790340424
gc 0
Train Epoch14 Acc 0.78745 (31498/40000), AUC 0.8690072298049927
Test Epoch14 layer0 Acc 0.7648, AUC 0.8480563163757324, avg_entr 0.3164106607437134
Test Epoch14 layer1 Acc 0.7788, AUC 0.8630114793777466, avg_entr 0.28912046551704407
Test Epoch14 layer2 Acc 0.7847, AUC 0.8690699338912964, avg_entr 0.2697295844554901
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 14
Test Epoch14 layer3 Acc 0.7825, AUC 0.870203971862793, avg_entr 0.25371915102005005
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 14
Test Epoch14 layer4 Acc 0.7799, AUC 0.8692454695701599, avg_entr 0.24557112157344818
gc 0
Train Epoch15 Acc 0.7916 (31664/40000), AUC 0.8758358955383301
Test Epoch15 layer0 Acc 0.7712, AUC 0.8526064157485962, avg_entr 0.2845860719680786
Test Epoch15 layer1 Acc 0.7831, AUC 0.8668981790542603, avg_entr 0.24989470839500427
Test Epoch15 layer2 Acc 0.7934, AUC 0.8732901215553284, avg_entr 0.22136437892913818
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 15
Test Epoch15 layer3 Acc 0.7917, AUC 0.8745402097702026, avg_entr 0.19250352680683136
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 15
Test Epoch15 layer4 Acc 0.7911, AUC 0.874019980430603, avg_entr 0.17836228013038635
gc 0
Train Epoch16 Acc 0.79915 (31966/40000), AUC 0.8813279867172241
Test Epoch16 layer0 Acc 0.7742, AUC 0.8557218313217163, avg_entr 0.2807798683643341
Test Epoch16 layer1 Acc 0.7845, AUC 0.8701171875, avg_entr 0.25217530131340027
Test Epoch16 layer2 Acc 0.7924, AUC 0.8760503530502319, avg_entr 0.21368078887462616
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 16
Test Epoch16 layer3 Acc 0.7924, AUC 0.8778658509254456, avg_entr 0.1776074916124344
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 16
Test Epoch16 layer4 Acc 0.7926, AUC 0.877323567867279, avg_entr 0.17032207548618317
gc 0
Train Epoch17 Acc 0.803275 (32131/40000), AUC 0.8836235404014587
Test Epoch17 layer0 Acc 0.7704, AUC 0.8575576543807983, avg_entr 0.26428163051605225
Test Epoch17 layer1 Acc 0.7762, AUC 0.8714204430580139, avg_entr 0.2379634827375412
Test Epoch17 layer2 Acc 0.785, AUC 0.8773918747901917, avg_entr 0.20669665932655334
Test Epoch17 layer3 Acc 0.7821, AUC 0.8784199953079224, avg_entr 0.17540718615055084
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 17
Test Epoch17 layer4 Acc 0.7826, AUC 0.8779231309890747, avg_entr 0.17341528832912445
gc 0
Train Epoch18 Acc 0.80595 (32238/40000), AUC 0.8879066705703735
Test Epoch18 layer0 Acc 0.7766, AUC 0.8606961965560913, avg_entr 0.25734713673591614
Test Epoch18 layer1 Acc 0.7948, AUC 0.8742107152938843, avg_entr 0.22003278136253357
Test Epoch18 layer2 Acc 0.7975, AUC 0.8798654079437256, avg_entr 0.1777074784040451
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 18
Test Epoch18 layer3 Acc 0.7999, AUC 0.8816922903060913, avg_entr 0.14574429392814636
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 18
Test Epoch18 layer4 Acc 0.7992, AUC 0.8815087080001831, avg_entr 0.1357274204492569
gc 0
Train Epoch19 Acc 0.812225 (32489/40000), AUC 0.8931807279586792
Test Epoch19 layer0 Acc 0.7788, AUC 0.8635227680206299, avg_entr 0.24144390225410461
Test Epoch19 layer1 Acc 0.7892, AUC 0.8766102194786072, avg_entr 0.20275655388832092
Test Epoch19 layer2 Acc 0.7928, AUC 0.8813513517379761, avg_entr 0.16803576052188873
Test Epoch19 layer3 Acc 0.7933, AUC 0.8835371732711792, avg_entr 0.14838695526123047
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 19
Test Epoch19 layer4 Acc 0.7916, AUC 0.8835446834564209, avg_entr 0.15042218565940857
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 19
gc 0
Train Epoch20 Acc 0.81755 (32702/40000), AUC 0.8991354703903198
Test Epoch20 layer0 Acc 0.7779, AUC 0.865493893623352, avg_entr 0.23106299340724945
Test Epoch20 layer1 Acc 0.7833, AUC 0.8782517910003662, avg_entr 0.1930374652147293
Test Epoch20 layer2 Acc 0.7861, AUC 0.8826758861541748, avg_entr 0.15284866094589233
Test Epoch20 layer3 Acc 0.7866, AUC 0.8854035139083862, avg_entr 0.13658152520656586
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 20
Test Epoch20 layer4 Acc 0.7844, AUC 0.8853275775909424, avg_entr 0.13435867428779602
gc 0
Train Epoch21 Acc 0.822825 (32913/40000), AUC 0.9039515852928162
Test Epoch21 layer0 Acc 0.7838, AUC 0.8666735291481018, avg_entr 0.2251363843679428
Test Epoch21 layer1 Acc 0.795, AUC 0.8797078132629395, avg_entr 0.1762879639863968
Test Epoch21 layer2 Acc 0.8003, AUC 0.8844649791717529, avg_entr 0.1363302320241928
Test Epoch21 layer3 Acc 0.8011, AUC 0.8864376544952393, avg_entr 0.1220218613743782
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 21
Test Epoch21 layer4 Acc 0.8022, AUC 0.8866403698921204, avg_entr 0.1182691678404808
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 21
gc 0
Train Epoch22 Acc 0.82635 (33054/40000), AUC 0.9064947366714478
Test Epoch22 layer0 Acc 0.7878, AUC 0.869335412979126, avg_entr 0.2148362249135971
Test Epoch22 layer1 Acc 0.7995, AUC 0.8810656666755676, avg_entr 0.1507984697818756
Test Epoch22 layer2 Acc 0.803, AUC 0.8850185871124268, avg_entr 0.11311976611614227
Test Epoch22 layer3 Acc 0.8042, AUC 0.88735431432724, avg_entr 0.1022021621465683
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 22
Test Epoch22 layer4 Acc 0.8045, AUC 0.8876697421073914, avg_entr 0.0977824404835701
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 22
gc 0
Train Epoch23 Acc 0.828025 (33121/40000), AUC 0.9093749523162842
Test Epoch23 layer0 Acc 0.7914, AUC 0.871155858039856, avg_entr 0.20386652648448944
Test Epoch23 layer1 Acc 0.8028, AUC 0.882217288017273, avg_entr 0.14353536069393158
Test Epoch23 layer2 Acc 0.8049, AUC 0.8859483003616333, avg_entr 0.11975737661123276
Test Epoch23 layer3 Acc 0.8071, AUC 0.8883650302886963, avg_entr 0.12128156423568726
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 23
Test Epoch23 layer4 Acc 0.8078, AUC 0.8886247873306274, avg_entr 0.1223754733800888
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 23
gc 0
Train Epoch24 Acc 0.832475 (33299/40000), AUC 0.9108062982559204
Test Epoch24 layer0 Acc 0.7898, AUC 0.872246265411377, avg_entr 0.19459901750087738
Test Epoch24 layer1 Acc 0.7893, AUC 0.8837293982505798, avg_entr 0.12352532893419266
Test Epoch24 layer2 Acc 0.7991, AUC 0.8864858746528625, avg_entr 0.10176237672567368
Test Epoch24 layer3 Acc 0.7999, AUC 0.8880002498626709, avg_entr 0.09713497012853622
Test Epoch24 layer4 Acc 0.7996, AUC 0.888323187828064, avg_entr 0.09512153267860413
gc 0
Train Epoch25 Acc 0.834825 (33393/40000), AUC 0.9139696359634399
Test Epoch25 layer0 Acc 0.7855, AUC 0.8743424415588379, avg_entr 0.18893297016620636
Test Epoch25 layer1 Acc 0.7916, AUC 0.8850936889648438, avg_entr 0.11908244341611862
Test Epoch25 layer2 Acc 0.799, AUC 0.8883247375488281, avg_entr 0.10192865133285522
Test Epoch25 layer3 Acc 0.8002, AUC 0.8902827501296997, avg_entr 0.09764188528060913
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 25
Test Epoch25 layer4 Acc 0.7984, AUC 0.890466570854187, avg_entr 0.09421107918024063
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 25
gc 0
Train Epoch26 Acc 0.839375 (33575/40000), AUC 0.9182720184326172
Test Epoch26 layer0 Acc 0.7838, AUC 0.8750194907188416, avg_entr 0.19146709144115448
Test Epoch26 layer1 Acc 0.7845, AUC 0.883217453956604, avg_entr 0.12090971320867538
Test Epoch26 layer2 Acc 0.7835, AUC 0.8863567113876343, avg_entr 0.10138148069381714
Test Epoch26 layer3 Acc 0.7849, AUC 0.889244556427002, avg_entr 0.10071319341659546
Test Epoch26 layer4 Acc 0.7845, AUC 0.8892419934272766, avg_entr 0.09557738900184631
gc 0
Train Epoch27 Acc 0.843225 (33729/40000), AUC 0.9201502203941345
Test Epoch27 layer0 Acc 0.7977, AUC 0.8772891163825989, avg_entr 0.17517760396003723
Test Epoch27 layer1 Acc 0.8068, AUC 0.8866804242134094, avg_entr 0.10150772333145142
Test Epoch27 layer2 Acc 0.8067, AUC 0.8896993398666382, avg_entr 0.0853688195347786
Test Epoch27 layer3 Acc 0.8096, AUC 0.8925108313560486, avg_entr 0.08276449143886566
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 27
Test Epoch27 layer4 Acc 0.8095, AUC 0.8927359580993652, avg_entr 0.07876173406839371
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 27
gc 0
Train Epoch28 Acc 0.8418 (33672/40000), AUC 0.9189791679382324
Test Epoch28 layer0 Acc 0.791, AUC 0.8764721155166626, avg_entr 0.17465169727802277
Test Epoch28 layer1 Acc 0.7995, AUC 0.8863961696624756, avg_entr 0.10410375893115997
Test Epoch28 layer2 Acc 0.8052, AUC 0.8893505930900574, avg_entr 0.08979775756597519
Test Epoch28 layer3 Acc 0.804, AUC 0.8921055793762207, avg_entr 0.08469437807798386
Test Epoch28 layer4 Acc 0.802, AUC 0.8923721313476562, avg_entr 0.0840158760547638
gc 0
Train Epoch29 Acc 0.845575 (33823/40000), AUC 0.923276424407959
Test Epoch29 layer0 Acc 0.793, AUC 0.8773725628852844, avg_entr 0.16725334525108337
Test Epoch29 layer1 Acc 0.8028, AUC 0.8866091966629028, avg_entr 0.09611200541257858
Test Epoch29 layer2 Acc 0.8081, AUC 0.8895342350006104, avg_entr 0.08058905601501465
Test Epoch29 layer3 Acc 0.8088, AUC 0.8922202587127686, avg_entr 0.0797889307141304
Test Epoch29 layer4 Acc 0.8094, AUC 0.8924945592880249, avg_entr 0.07638021558523178
gc 0
Train Epoch30 Acc 0.84905 (33962/40000), AUC 0.9256582260131836
Test Epoch30 layer0 Acc 0.7915, AUC 0.8781538009643555, avg_entr 0.16759806871414185
Test Epoch30 layer1 Acc 0.7983, AUC 0.8871991634368896, avg_entr 0.09831103682518005
Test Epoch30 layer2 Acc 0.7984, AUC 0.8899630308151245, avg_entr 0.08469393849372864
Test Epoch30 layer3 Acc 0.798, AUC 0.8927427530288696, avg_entr 0.0830276608467102
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 30
Test Epoch30 layer4 Acc 0.7989, AUC 0.8928094506263733, avg_entr 0.08164036273956299
Save ckpt to ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt  ,ep 30
gc 0
Train Epoch31 Acc 0.854675 (34187/40000), AUC 0.9300855398178101
Test Epoch31 layer0 Acc 0.7933, AUC 0.8779914379119873, avg_entr 0.1621558666229248
Test Epoch31 layer1 Acc 0.7988, AUC 0.8832811117172241, avg_entr 0.087889663875103
Test Epoch31 layer2 Acc 0.8008, AUC 0.8871238827705383, avg_entr 0.07855410128831863
Test Epoch31 layer3 Acc 0.8053, AUC 0.8901636600494385, avg_entr 0.07830445468425751
Test Epoch31 layer4 Acc 0.8049, AUC 0.8901817798614502, avg_entr 0.0790843591094017
gc 0
Train Epoch32 Acc 0.859575 (34383/40000), AUC 0.9349671602249146
Test Epoch32 layer0 Acc 0.7967, AUC 0.87841796875, avg_entr 0.1563987135887146
Test Epoch32 layer1 Acc 0.8009, AUC 0.8864105939865112, avg_entr 0.08730249851942062
Test Epoch32 layer2 Acc 0.8031, AUC 0.8891078233718872, avg_entr 0.07316708564758301
Test Epoch32 layer3 Acc 0.8041, AUC 0.8915723562240601, avg_entr 0.0693959966301918
Test Epoch32 layer4 Acc 0.8055, AUC 0.8917860388755798, avg_entr 0.06880756467580795
gc 0
Train Epoch33 Acc 0.86115 (34446/40000), AUC 0.9364534616470337
Test Epoch33 layer0 Acc 0.7944, AUC 0.8767187595367432, avg_entr 0.15625974535942078
Test Epoch33 layer1 Acc 0.8031, AUC 0.8828645348548889, avg_entr 0.08124373853206635
Test Epoch33 layer2 Acc 0.8049, AUC 0.8863544464111328, avg_entr 0.06695310771465302
Test Epoch33 layer3 Acc 0.8071, AUC 0.8889468312263489, avg_entr 0.06200890988111496
Test Epoch33 layer4 Acc 0.8074, AUC 0.88880854845047, avg_entr 0.06002242490649223
gc 0
Train Epoch34 Acc 0.865375 (34615/40000), AUC 0.9394627809524536
Test Epoch34 layer0 Acc 0.779, AUC 0.8782851099967957, avg_entr 0.1394069641828537
Test Epoch34 layer1 Acc 0.7733, AUC 0.8798044919967651, avg_entr 0.07528211921453476
Test Epoch34 layer2 Acc 0.7725, AUC 0.8849214911460876, avg_entr 0.06797397136688232
Test Epoch34 layer3 Acc 0.7704, AUC 0.8864619731903076, avg_entr 0.06742510199546814
Test Epoch34 layer4 Acc 0.7711, AUC 0.8859556913375854, avg_entr 0.06635411828756332
gc 0
Train Epoch35 Acc 0.87155 (34862/40000), AUC 0.943385124206543
Test Epoch35 layer0 Acc 0.7957, AUC 0.8799518346786499, avg_entr 0.14439339935779572
Test Epoch35 layer1 Acc 0.8071, AUC 0.887223482131958, avg_entr 0.07530607283115387
Test Epoch35 layer2 Acc 0.8093, AUC 0.8903555870056152, avg_entr 0.06655055284500122
Test Epoch35 layer3 Acc 0.812, AUC 0.8925888538360596, avg_entr 0.06514587253332138
Test Epoch35 layer4 Acc 0.8128, AUC 0.8925561904907227, avg_entr 0.06504084169864655
gc 0
Train Epoch36 Acc 0.873725 (34949/40000), AUC 0.9464628100395203
Test Epoch36 layer0 Acc 0.791, AUC 0.8791037201881409, avg_entr 0.1419977843761444
Test Epoch36 layer1 Acc 0.8014, AUC 0.8851343393325806, avg_entr 0.07377324998378754
Test Epoch36 layer2 Acc 0.8049, AUC 0.8880417346954346, avg_entr 0.06348302960395813
Test Epoch36 layer3 Acc 0.8046, AUC 0.8899732828140259, avg_entr 0.06035224720835686
Test Epoch36 layer4 Acc 0.8051, AUC 0.8900606632232666, avg_entr 0.06073366850614548
gc 0
Train Epoch37 Acc 0.87635 (35054/40000), AUC 0.9475140571594238
Test Epoch37 layer0 Acc 0.7926, AUC 0.8782827854156494, avg_entr 0.1349724531173706
Test Epoch37 layer1 Acc 0.7954, AUC 0.882672905921936, avg_entr 0.07194675505161285
Test Epoch37 layer2 Acc 0.8, AUC 0.8876447677612305, avg_entr 0.0642225444316864
Test Epoch37 layer3 Acc 0.8004, AUC 0.889230489730835, avg_entr 0.06465265899896622
Test Epoch37 layer4 Acc 0.8014, AUC 0.8891084790229797, avg_entr 0.06583582609891891
gc 0
Train Epoch38 Acc 0.87895 (35158/40000), AUC 0.9488846063613892
Test Epoch38 layer0 Acc 0.791, AUC 0.8763230443000793, avg_entr 0.13757070899009705
Test Epoch38 layer1 Acc 0.7954, AUC 0.8819985389709473, avg_entr 0.07122409343719482
Test Epoch38 layer2 Acc 0.7947, AUC 0.8866029977798462, avg_entr 0.06170506775379181
Test Epoch38 layer3 Acc 0.7935, AUC 0.8877036571502686, avg_entr 0.06011124327778816
Test Epoch38 layer4 Acc 0.7938, AUC 0.8881387710571289, avg_entr 0.0619518868625164
gc 0
Train Epoch39 Acc 0.882775 (35311/40000), AUC 0.952092707157135
Test Epoch39 layer0 Acc 0.7969, AUC 0.8775818347930908, avg_entr 0.13290050625801086
Test Epoch39 layer1 Acc 0.8046, AUC 0.8837181925773621, avg_entr 0.06551459431648254
Test Epoch39 layer2 Acc 0.8086, AUC 0.8875137567520142, avg_entr 0.05304252356290817
Test Epoch39 layer3 Acc 0.8096, AUC 0.8895548582077026, avg_entr 0.050237350165843964
Test Epoch39 layer4 Acc 0.809, AUC 0.8894752264022827, avg_entr 0.05020442605018616
gc 0
Train Epoch40 Acc 0.8867 (35468/40000), AUC 0.9553351402282715
Test Epoch40 layer0 Acc 0.7901, AUC 0.8762965202331543, avg_entr 0.13323970139026642
Test Epoch40 layer1 Acc 0.7963, AUC 0.8801435232162476, avg_entr 0.06468304246664047
Test Epoch40 layer2 Acc 0.7972, AUC 0.8846864700317383, avg_entr 0.05472196638584137
Test Epoch40 layer3 Acc 0.7981, AUC 0.8862320184707642, avg_entr 0.052259571850299835
Test Epoch40 layer4 Acc 0.7983, AUC 0.8864464163780212, avg_entr 0.052778154611587524
gc 0
Train Epoch41 Acc 0.88985 (35594/40000), AUC 0.9558466076850891
Test Epoch41 layer0 Acc 0.7918, AUC 0.8763534426689148, avg_entr 0.1309688836336136
Test Epoch41 layer1 Acc 0.7978, AUC 0.8801381587982178, avg_entr 0.06364867091178894
Test Epoch41 layer2 Acc 0.8003, AUC 0.8838256597518921, avg_entr 0.052360087633132935
Test Epoch41 layer3 Acc 0.7997, AUC 0.8853994607925415, avg_entr 0.04915839806199074
Test Epoch41 layer4 Acc 0.8, AUC 0.8856150507926941, avg_entr 0.04923810064792633
gc 0
Train Epoch42 Acc 0.89165 (35666/40000), AUC 0.9574121832847595
Test Epoch42 layer0 Acc 0.7911, AUC 0.8762528896331787, avg_entr 0.12856069207191467
Test Epoch42 layer1 Acc 0.7981, AUC 0.8791495561599731, avg_entr 0.0616653636097908
Test Epoch42 layer2 Acc 0.8021, AUC 0.8832919001579285, avg_entr 0.050106629729270935
Test Epoch42 layer3 Acc 0.802, AUC 0.8852589130401611, avg_entr 0.04726904630661011
Test Epoch42 layer4 Acc 0.8041, AUC 0.8855253458023071, avg_entr 0.046975910663604736
gc 0
Train Epoch43 Acc 0.892825 (35713/40000), AUC 0.9584195613861084
Test Epoch43 layer0 Acc 0.7941, AUC 0.8754205107688904, avg_entr 0.12597320973873138
Test Epoch43 layer1 Acc 0.802, AUC 0.8789031505584717, avg_entr 0.0600004643201828
Test Epoch43 layer2 Acc 0.8047, AUC 0.8832136392593384, avg_entr 0.0502699539065361
Test Epoch43 layer3 Acc 0.8062, AUC 0.8850806951522827, avg_entr 0.04871385917067528
Test Epoch43 layer4 Acc 0.8058, AUC 0.8851844072341919, avg_entr 0.049495257437229156
gc 0
Train Epoch44 Acc 0.8959 (35836/40000), AUC 0.9600533246994019
Test Epoch44 layer0 Acc 0.793, AUC 0.8756242394447327, avg_entr 0.12321595102548599
Test Epoch44 layer1 Acc 0.8028, AUC 0.8789161443710327, avg_entr 0.05852150917053223
Test Epoch44 layer2 Acc 0.8046, AUC 0.8832420706748962, avg_entr 0.04930775985121727
Test Epoch44 layer3 Acc 0.8076, AUC 0.8848525285720825, avg_entr 0.048758797347545624
Test Epoch44 layer4 Acc 0.8068, AUC 0.885016918182373, avg_entr 0.04992266744375229
gc 0
Train Epoch45 Acc 0.898775 (35951/40000), AUC 0.9614927172660828
Test Epoch45 layer0 Acc 0.7967, AUC 0.8756809234619141, avg_entr 0.11981218308210373
Test Epoch45 layer1 Acc 0.8001, AUC 0.8782574534416199, avg_entr 0.055472344160079956
Test Epoch45 layer2 Acc 0.8028, AUC 0.8833692669868469, avg_entr 0.04679808020591736
Test Epoch45 layer3 Acc 0.8043, AUC 0.8854656219482422, avg_entr 0.04512050002813339
Test Epoch45 layer4 Acc 0.8048, AUC 0.8854144811630249, avg_entr 0.04532735049724579
gc 0
Train Epoch46 Acc 0.897625 (35905/40000), AUC 0.9618245363235474
Test Epoch46 layer0 Acc 0.7937, AUC 0.8753047585487366, avg_entr 0.12308912724256516
Test Epoch46 layer1 Acc 0.8026, AUC 0.878166675567627, avg_entr 0.05738844722509384
Test Epoch46 layer2 Acc 0.8015, AUC 0.8823500871658325, avg_entr 0.04744548350572586
Test Epoch46 layer3 Acc 0.806, AUC 0.8844616413116455, avg_entr 0.04638973996043205
Test Epoch46 layer4 Acc 0.8064, AUC 0.8845057487487793, avg_entr 0.04627592861652374
gc 0
Train Epoch47 Acc 0.8993 (35972/40000), AUC 0.9619830846786499
Test Epoch47 layer0 Acc 0.7915, AUC 0.8748565912246704, avg_entr 0.12174966186285019
Test Epoch47 layer1 Acc 0.7994, AUC 0.877228856086731, avg_entr 0.05575571209192276
Test Epoch47 layer2 Acc 0.8009, AUC 0.8821139335632324, avg_entr 0.04816961660981178
Test Epoch47 layer3 Acc 0.8016, AUC 0.8838963508605957, avg_entr 0.04680617153644562
Test Epoch47 layer4 Acc 0.802, AUC 0.8840334415435791, avg_entr 0.04831897094845772
gc 0
Train Epoch48 Acc 0.900425 (36017/40000), AUC 0.9633156061172485
Test Epoch48 layer0 Acc 0.792, AUC 0.8744770288467407, avg_entr 0.11803495138883591
Test Epoch48 layer1 Acc 0.7969, AUC 0.8762192726135254, avg_entr 0.05522521212697029
Test Epoch48 layer2 Acc 0.7998, AUC 0.8812180757522583, avg_entr 0.04388720542192459
Test Epoch48 layer3 Acc 0.8001, AUC 0.8831396102905273, avg_entr 0.040862202644348145
Test Epoch48 layer4 Acc 0.8009, AUC 0.8833949565887451, avg_entr 0.04058452323079109
gc 0
Train Epoch49 Acc 0.90235 (36094/40000), AUC 0.9636361598968506
Test Epoch49 layer0 Acc 0.794, AUC 0.8743802309036255, avg_entr 0.1189114972949028
Test Epoch49 layer1 Acc 0.8016, AUC 0.8760226964950562, avg_entr 0.05331108346581459
Test Epoch49 layer2 Acc 0.8033, AUC 0.8803523778915405, avg_entr 0.04307158663868904
Test Epoch49 layer3 Acc 0.8067, AUC 0.8826432228088379, avg_entr 0.041098613291978836
Test Epoch49 layer4 Acc 0.806, AUC 0.8826886415481567, avg_entr 0.04116373881697655
Best AUC 0.8928094506263733
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_transformeralside_l5_side100//imdb_transformeralside_l5_side.pt
[[3784 1257]
 [ 828 4131]]
Figure(640x480)
tensor([0.6701, 0.0830, 0.0550,  ..., 0.0119, 0.6771, 0.6793])
[[3754 1287]
 [ 730 4229]]
Figure(640x480)
tensor([0.6801, 0.0035, 0.0018,  ..., 0.0099, 0.5965, 0.4285])
[[3678 1363]
 [ 653 4306]]
Figure(640x480)
tensor([0.0125, 0.0022, 0.0031,  ..., 0.0076, 0.6283, 0.0809])
[[3646 1395]
 [ 625 4334]]
Figure(640x480)
tensor([0.0068, 0.0026, 0.0008,  ..., 0.0062, 0.4283, 0.0737])
[[3644 1397]
 [ 614 4345]]
Figure(640x480)
tensor([0.0039, 0.0018, 0.0007,  ..., 0.0072, 0.4170, 0.0722])
