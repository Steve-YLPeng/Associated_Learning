total count words 222751
vocab size 30000
found 27937 words in glove
model: LinearALsideText(
  (layers): ModuleList(
    (0): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb): Embedding(30000, 300)
)
Start Training
gc 0
Train Epoch0 Acc 0.496625 (19865/40000), AUC 0.4918895661830902
Test Epoch0 layer0 Acc 0.5026, AUC 0.4907474219799042, avg_entr 0.7005476951599121
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5037, AUC 0.4987538456916809, avg_entr 0.7019373774528503
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.5123, AUC 0.5096571445465088, avg_entr 0.7035045623779297
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer3 Acc 0.4944, AUC 0.4915827512741089, avg_entr 0.7038916349411011
Test Epoch0 layer4 Acc 0.4978, AUC 0.4929490089416504, avg_entr 0.7019718289375305
gc 0
Train Epoch1 Acc 0.507975 (20319/40000), AUC 0.5050724744796753
Test Epoch1 layer0 Acc 0.5093, AUC 0.5097486972808838, avg_entr 0.6919159293174744
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.5173, AUC 0.5218809843063354, avg_entr 0.6905965805053711
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.5212, AUC 0.5301722288131714, avg_entr 0.6909134984016418
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer3 Acc 0.5077, AUC 0.5087276101112366, avg_entr 0.6895337104797363
Test Epoch1 layer4 Acc 0.5137, AUC 0.5135501623153687, avg_entr 0.6920967102050781
gc 0
Train Epoch2 Acc 0.522075 (20883/40000), AUC 0.5295146703720093
Test Epoch2 layer0 Acc 0.534, AUC 0.5409840941429138, avg_entr 0.6931930184364319
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.5395, AUC 0.552577018737793, avg_entr 0.6888372302055359
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.5388, AUC 0.552468478679657, avg_entr 0.6895518898963928
Test Epoch2 layer3 Acc 0.528, AUC 0.5329134464263916, avg_entr 0.6908730268478394
Test Epoch2 layer4 Acc 0.5242, AUC 0.5330522060394287, avg_entr 0.689772367477417
gc 0
Train Epoch3 Acc 0.535375 (21415/40000), AUC 0.5492468476295471
Test Epoch3 layer0 Acc 0.5163, AUC 0.5748851299285889, avg_entr 0.6806802749633789
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.5296, AUC 0.5861623287200928, avg_entr 0.6775282025337219
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.5381, AUC 0.5783052444458008, avg_entr 0.6800487041473389
Test Epoch3 layer3 Acc 0.5232, AUC 0.5582575798034668, avg_entr 0.6807530522346497
Test Epoch3 layer4 Acc 0.531, AUC 0.5579021573066711, avg_entr 0.6787575483322144
gc 0
Train Epoch4 Acc 0.548675 (21947/40000), AUC 0.5666242837905884
Test Epoch4 layer0 Acc 0.5108, AUC 0.6039961576461792, avg_entr 0.6697806119918823
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.5237, AUC 0.611886739730835, avg_entr 0.66713947057724
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.5325, AUC 0.604093074798584, avg_entr 0.6682465076446533
Test Epoch4 layer3 Acc 0.5256, AUC 0.5845314264297485, avg_entr 0.6674742698669434
Test Epoch4 layer4 Acc 0.5266, AUC 0.5853162407875061, avg_entr 0.665553867816925
gc 0
Train Epoch5 Acc 0.562375 (22495/40000), AUC 0.5878095626831055
Test Epoch5 layer0 Acc 0.5894, AUC 0.6232067346572876, avg_entr 0.688643217086792
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.5904, AUC 0.629785418510437, avg_entr 0.682027280330658
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.5929, AUC 0.626213550567627, avg_entr 0.6809009909629822
Test Epoch5 layer3 Acc 0.5785, AUC 0.6074517965316772, avg_entr 0.6823550462722778
Test Epoch5 layer4 Acc 0.5755, AUC 0.6124710440635681, avg_entr 0.6814090609550476
gc 0
Train Epoch6 Acc 0.5837 (23348/40000), AUC 0.6153576970100403
Test Epoch6 layer0 Acc 0.5744, AUC 0.6396550536155701, avg_entr 0.6758642196655273
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.5808, AUC 0.6451940536499023, avg_entr 0.6690810322761536
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 6
Test Epoch6 layer2 Acc 0.5821, AUC 0.6421805620193481, avg_entr 0.6623960733413696
Test Epoch6 layer3 Acc 0.5763, AUC 0.6270811557769775, avg_entr 0.6706786155700684
Test Epoch6 layer4 Acc 0.5914, AUC 0.6335732340812683, avg_entr 0.6719666719436646
gc 0
Train Epoch7 Acc 0.5932 (23728/40000), AUC 0.6311286687850952
Test Epoch7 layer0 Acc 0.5913, AUC 0.6497297286987305, avg_entr 0.6679692268371582
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 7
Test Epoch7 layer1 Acc 0.5993, AUC 0.6554856300354004, avg_entr 0.6655616164207458
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 7
Test Epoch7 layer2 Acc 0.5957, AUC 0.6522549390792847, avg_entr 0.6582931876182556
Test Epoch7 layer3 Acc 0.5972, AUC 0.6414973735809326, avg_entr 0.6728790402412415
Test Epoch7 layer4 Acc 0.6019, AUC 0.6472294330596924, avg_entr 0.6650491952896118
gc 0
Train Epoch8 Acc 0.607425 (24297/40000), AUC 0.6482592821121216
Test Epoch8 layer0 Acc 0.6165, AUC 0.6585091352462769, avg_entr 0.6572599411010742
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 8
Test Epoch8 layer1 Acc 0.6205, AUC 0.6641145944595337, avg_entr 0.6557230353355408
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 8
Test Epoch8 layer2 Acc 0.6195, AUC 0.6606111526489258, avg_entr 0.6483919024467468
Test Epoch8 layer3 Acc 0.6098, AUC 0.653968334197998, avg_entr 0.6585307121276855
Test Epoch8 layer4 Acc 0.617, AUC 0.6576462984085083, avg_entr 0.6502769589424133
gc 0
Train Epoch9 Acc 0.614125 (24565/40000), AUC 0.6576564311981201
Test Epoch9 layer0 Acc 0.6226, AUC 0.6648021936416626, avg_entr 0.6431413292884827
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 9
Test Epoch9 layer1 Acc 0.6215, AUC 0.6702859401702881, avg_entr 0.6330152153968811
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 9
Test Epoch9 layer2 Acc 0.6215, AUC 0.6666225790977478, avg_entr 0.6257932782173157
Test Epoch9 layer3 Acc 0.6192, AUC 0.6631342172622681, avg_entr 0.642677366733551
Test Epoch9 layer4 Acc 0.6228, AUC 0.6657708883285522, avg_entr 0.6287451386451721
gc 0
Train Epoch10 Acc 0.62095 (24838/40000), AUC 0.6664811372756958
Test Epoch10 layer0 Acc 0.6137, AUC 0.6690016984939575, avg_entr 0.6121571063995361
Test Epoch10 layer1 Acc 0.6177, AUC 0.6742160320281982, avg_entr 0.6051285266876221
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 10
Test Epoch10 layer2 Acc 0.6122, AUC 0.6706026196479797, avg_entr 0.5959625840187073
Test Epoch10 layer3 Acc 0.6129, AUC 0.6690895557403564, avg_entr 0.6139573454856873
Test Epoch10 layer4 Acc 0.6182, AUC 0.6710745692253113, avg_entr 0.5987527370452881
gc 0
Train Epoch11 Acc 0.625825 (25033/40000), AUC 0.6745846271514893
Test Epoch11 layer0 Acc 0.5976, AUC 0.6737463474273682, avg_entr 0.5580981373786926
Test Epoch11 layer1 Acc 0.5991, AUC 0.6780760288238525, avg_entr 0.5516666173934937
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 11
Test Epoch11 layer2 Acc 0.6058, AUC 0.6749024987220764, avg_entr 0.5492098331451416
Test Epoch11 layer3 Acc 0.5961, AUC 0.6745479106903076, avg_entr 0.5594897270202637
Test Epoch11 layer4 Acc 0.6039, AUC 0.6762062311172485, avg_entr 0.5529745221138
gc 0
Train Epoch12 Acc 0.632325 (25293/40000), AUC 0.6808865666389465
Test Epoch12 layer0 Acc 0.5959, AUC 0.6770294904708862, avg_entr 0.5188015103340149
Test Epoch12 layer1 Acc 0.5998, AUC 0.6808134913444519, avg_entr 0.5214560627937317
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 12
Test Epoch12 layer2 Acc 0.6036, AUC 0.6780176162719727, avg_entr 0.5127022862434387
Test Epoch12 layer3 Acc 0.599, AUC 0.6781822443008423, avg_entr 0.5290088653564453
Test Epoch12 layer4 Acc 0.601, AUC 0.6795296669006348, avg_entr 0.5168259739875793
gc 0
Train Epoch13 Acc 0.629175 (25167/40000), AUC 0.678446888923645
Test Epoch13 layer0 Acc 0.6269, AUC 0.6793960332870483, avg_entr 0.5419671535491943
Test Epoch13 layer1 Acc 0.6263, AUC 0.6825429201126099, avg_entr 0.5363248586654663
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 13
Test Epoch13 layer2 Acc 0.6265, AUC 0.6802491545677185, avg_entr 0.5345708727836609
Test Epoch13 layer3 Acc 0.6267, AUC 0.6806502938270569, avg_entr 0.5479839444160461
Test Epoch13 layer4 Acc 0.628, AUC 0.6817967891693115, avg_entr 0.5323469638824463
gc 0
Train Epoch14 Acc 0.63645 (25458/40000), AUC 0.6897398829460144
Test Epoch14 layer0 Acc 0.6287, AUC 0.6817200779914856, avg_entr 0.5180067420005798
Test Epoch14 layer1 Acc 0.6311, AUC 0.6843764781951904, avg_entr 0.5154010653495789
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 14
Test Epoch14 layer2 Acc 0.6277, AUC 0.6823976039886475, avg_entr 0.5139889717102051
Test Epoch14 layer3 Acc 0.6307, AUC 0.6829584836959839, avg_entr 0.5241180062294006
Test Epoch14 layer4 Acc 0.6317, AUC 0.6839069724082947, avg_entr 0.5139769911766052
gc 0
Train Epoch15 Acc 0.638275 (25531/40000), AUC 0.6917924284934998
Test Epoch15 layer0 Acc 0.6111, AUC 0.6839241981506348, avg_entr 0.4687691330909729
Test Epoch15 layer1 Acc 0.6084, AUC 0.6860789656639099, avg_entr 0.46469029784202576
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 15
Test Epoch15 layer2 Acc 0.6109, AUC 0.6843374371528625, avg_entr 0.45792603492736816
Test Epoch15 layer3 Acc 0.6086, AUC 0.6850703358650208, avg_entr 0.46898388862609863
Test Epoch15 layer4 Acc 0.6126, AUC 0.685853123664856, avg_entr 0.46273350715637207
gc 0
Train Epoch16 Acc 0.640875 (25635/40000), AUC 0.6923269033432007
Test Epoch16 layer0 Acc 0.6254, AUC 0.6855584383010864, avg_entr 0.47659003734588623
Test Epoch16 layer1 Acc 0.6278, AUC 0.6872687935829163, avg_entr 0.4718969762325287
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 16
Test Epoch16 layer2 Acc 0.6308, AUC 0.6860151886940002, avg_entr 0.47479119896888733
Test Epoch16 layer3 Acc 0.6255, AUC 0.6865476369857788, avg_entr 0.47989848256111145
Test Epoch16 layer4 Acc 0.6265, AUC 0.6873437166213989, avg_entr 0.4721386730670929
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.642 (25680/40000), AUC 0.6956992149353027
Test Epoch17 layer0 Acc 0.632, AUC 0.6869461536407471, avg_entr 0.46527931094169617
Test Epoch17 layer1 Acc 0.6359, AUC 0.6883164644241333, avg_entr 0.46656620502471924
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 17
Test Epoch17 layer2 Acc 0.6267, AUC 0.687498152256012, avg_entr 0.46555691957473755
Test Epoch17 layer3 Acc 0.6373, AUC 0.6877545118331909, avg_entr 0.47012078762054443
Test Epoch17 layer4 Acc 0.6352, AUC 0.6885928511619568, avg_entr 0.4664244055747986
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 17
gc 0
Train Epoch18 Acc 0.643875 (25755/40000), AUC 0.6973820924758911
Test Epoch18 layer0 Acc 0.6285, AUC 0.688279926776886, avg_entr 0.4459018409252167
Test Epoch18 layer1 Acc 0.6316, AUC 0.6892443895339966, avg_entr 0.44844427704811096
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 18
Test Epoch18 layer2 Acc 0.6343, AUC 0.6887481212615967, avg_entr 0.4500579535961151
Test Epoch18 layer3 Acc 0.6296, AUC 0.688880205154419, avg_entr 0.4500073790550232
Test Epoch18 layer4 Acc 0.633, AUC 0.6897538304328918, avg_entr 0.44995155930519104
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 18
gc 0
Train Epoch19 Acc 0.646375 (25855/40000), AUC 0.7002003192901611
Test Epoch19 layer0 Acc 0.6343, AUC 0.6894161701202393, avg_entr 0.43773120641708374
Test Epoch19 layer1 Acc 0.6385, AUC 0.690054178237915, avg_entr 0.4390179216861725
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 19
Test Epoch19 layer2 Acc 0.6304, AUC 0.6898884177207947, avg_entr 0.4391283094882965
Test Epoch19 layer3 Acc 0.6371, AUC 0.6897373199462891, avg_entr 0.4420882761478424
Test Epoch19 layer4 Acc 0.6367, AUC 0.6907522678375244, avg_entr 0.43968665599823
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 19
gc 0
Train Epoch20 Acc 0.6488 (25952/40000), AUC 0.7007933855056763
Test Epoch20 layer0 Acc 0.6314, AUC 0.6904236674308777, avg_entr 0.42646026611328125
Test Epoch20 layer1 Acc 0.6351, AUC 0.6907612085342407, avg_entr 0.4267520010471344
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 20
Test Epoch20 layer2 Acc 0.637, AUC 0.6908611059188843, avg_entr 0.42644795775413513
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 20
Test Epoch20 layer3 Acc 0.6321, AUC 0.6906096935272217, avg_entr 0.4284839332103729
Test Epoch20 layer4 Acc 0.6335, AUC 0.6916356086730957, avg_entr 0.4274044930934906
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 20
gc 0
Train Epoch21 Acc 0.64905 (25962/40000), AUC 0.7031526565551758
Test Epoch21 layer0 Acc 0.6218, AUC 0.6913067102432251, avg_entr 0.39537540078163147
Test Epoch21 layer1 Acc 0.6218, AUC 0.6914224028587341, avg_entr 0.39668789505958557
Test Epoch21 layer2 Acc 0.6277, AUC 0.69170081615448, avg_entr 0.40114831924438477
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 21
Test Epoch21 layer3 Acc 0.6194, AUC 0.6913379430770874, avg_entr 0.39558953046798706
Test Epoch21 layer4 Acc 0.6261, AUC 0.692405104637146, avg_entr 0.4002326726913452
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 21
gc 0
Train Epoch22 Acc 0.648775 (25951/40000), AUC 0.7028436660766602
Test Epoch22 layer0 Acc 0.6339, AUC 0.6920880079269409, avg_entr 0.4066351056098938
Test Epoch22 layer1 Acc 0.6346, AUC 0.6919159889221191, avg_entr 0.4069547951221466
Test Epoch22 layer2 Acc 0.6351, AUC 0.6925220489501953, avg_entr 0.4081847369670868
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 22
Test Epoch22 layer3 Acc 0.6365, AUC 0.6919771432876587, avg_entr 0.40943285822868347
Test Epoch22 layer4 Acc 0.6366, AUC 0.6930860877037048, avg_entr 0.40790849924087524
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 22
gc 0
Train Epoch23 Acc 0.646775 (25871/40000), AUC 0.7027585506439209
Test Epoch23 layer0 Acc 0.6317, AUC 0.6927590370178223, avg_entr 0.3923819661140442
Test Epoch23 layer1 Acc 0.6294, AUC 0.6924174427986145, avg_entr 0.3933241069316864
Test Epoch23 layer2 Acc 0.6348, AUC 0.6932029724121094, avg_entr 0.3949202001094818
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 23
Test Epoch23 layer3 Acc 0.6326, AUC 0.6925852298736572, avg_entr 0.3956581652164459
Test Epoch23 layer4 Acc 0.6313, AUC 0.6936864852905273, avg_entr 0.3941580057144165
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 23
gc 0
Train Epoch24 Acc 0.64895 (25958/40000), AUC 0.7041949033737183
Test Epoch24 layer0 Acc 0.6344, AUC 0.693362295627594, avg_entr 0.38739126920700073
Test Epoch24 layer1 Acc 0.6367, AUC 0.6928967237472534, avg_entr 0.38771888613700867
Test Epoch24 layer2 Acc 0.6351, AUC 0.693786084651947, avg_entr 0.38741615414619446
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 24
Test Epoch24 layer3 Acc 0.6373, AUC 0.693034291267395, avg_entr 0.38821080327033997
Test Epoch24 layer4 Acc 0.6408, AUC 0.6942645311355591, avg_entr 0.3884149491786957
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 24
gc 0
Train Epoch25 Acc 0.65175 (26070/40000), AUC 0.7060854434967041
Test Epoch25 layer0 Acc 0.6369, AUC 0.6939023733139038, avg_entr 0.38117754459381104
Test Epoch25 layer1 Acc 0.6398, AUC 0.6932666301727295, avg_entr 0.3815615773200989
Test Epoch25 layer2 Acc 0.6381, AUC 0.6942602396011353, avg_entr 0.38163506984710693
Test Epoch25 layer3 Acc 0.6385, AUC 0.6935268044471741, avg_entr 0.38309910893440247
Test Epoch25 layer4 Acc 0.6421, AUC 0.6946941018104553, avg_entr 0.3802967071533203
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 25
gc 0
Train Epoch26 Acc 0.65005 (26002/40000), AUC 0.7056301236152649
Test Epoch26 layer0 Acc 0.6364, AUC 0.6943763494491577, avg_entr 0.3749951720237732
Test Epoch26 layer1 Acc 0.6344, AUC 0.6936506032943726, avg_entr 0.37505707144737244
Test Epoch26 layer2 Acc 0.637, AUC 0.6947249174118042, avg_entr 0.37500616908073425
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 26
Test Epoch26 layer3 Acc 0.6391, AUC 0.6940270662307739, avg_entr 0.37645551562309265
Test Epoch26 layer4 Acc 0.6372, AUC 0.6951466202735901, avg_entr 0.3749530017375946
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 26
gc 0
Train Epoch27 Acc 0.651 (26040/40000), AUC 0.7054458856582642
Test Epoch27 layer0 Acc 0.6327, AUC 0.6947799921035767, avg_entr 0.36443400382995605
Test Epoch27 layer1 Acc 0.6317, AUC 0.6940011978149414, avg_entr 0.36517107486724854
Test Epoch27 layer2 Acc 0.6328, AUC 0.6951428651809692, avg_entr 0.3643788695335388
Test Epoch27 layer3 Acc 0.636, AUC 0.6944983005523682, avg_entr 0.36668241024017334
Test Epoch27 layer4 Acc 0.6335, AUC 0.6955518126487732, avg_entr 0.3640020489692688
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 27
gc 0
Train Epoch28 Acc 0.65255 (26102/40000), AUC 0.7077524662017822
Test Epoch28 layer0 Acc 0.636, AUC 0.6951040029525757, avg_entr 0.36098700761795044
Test Epoch28 layer1 Acc 0.6358, AUC 0.6942442655563354, avg_entr 0.3603150248527527
Test Epoch28 layer2 Acc 0.6382, AUC 0.6954610347747803, avg_entr 0.36083993315696716
Test Epoch28 layer3 Acc 0.64, AUC 0.6948074698448181, avg_entr 0.36162495613098145
Test Epoch28 layer4 Acc 0.6374, AUC 0.695868730545044, avg_entr 0.3603528141975403
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 28
gc 0
Train Epoch29 Acc 0.651125 (26045/40000), AUC 0.7069973945617676
Test Epoch29 layer0 Acc 0.6344, AUC 0.6953169107437134, avg_entr 0.3376220762729645
Test Epoch29 layer1 Acc 0.6363, AUC 0.6943813562393188, avg_entr 0.34313255548477173
Test Epoch29 layer2 Acc 0.633, AUC 0.6957778930664062, avg_entr 0.3434915542602539
Test Epoch29 layer3 Acc 0.6348, AUC 0.6950550079345703, avg_entr 0.34188368916511536
Test Epoch29 layer4 Acc 0.6353, AUC 0.696122407913208, avg_entr 0.3432862162590027
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 29
gc 0
Train Epoch30 Acc 0.6502 (26008/40000), AUC 0.7071816325187683
Test Epoch30 layer0 Acc 0.6179, AUC 0.6954541206359863, avg_entr 0.29952365159988403
Test Epoch30 layer1 Acc 0.6197, AUC 0.6944088935852051, avg_entr 0.3030771017074585
Test Epoch30 layer2 Acc 0.6185, AUC 0.6960017681121826, avg_entr 0.30080288648605347
Test Epoch30 layer3 Acc 0.6211, AUC 0.6951991319656372, avg_entr 0.30684417486190796
Test Epoch30 layer4 Acc 0.6191, AUC 0.6962424516677856, avg_entr 0.3018265962600708
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 30
gc 0
Train Epoch31 Acc 0.65415 (26166/40000), AUC 0.7092655897140503
Test Epoch31 layer0 Acc 0.6211, AUC 0.6959191560745239, avg_entr 0.3127656579017639
Test Epoch31 layer1 Acc 0.6198, AUC 0.694868803024292, avg_entr 0.31456297636032104
Test Epoch31 layer2 Acc 0.6237, AUC 0.696231484413147, avg_entr 0.31690341234207153
Test Epoch31 layer3 Acc 0.6239, AUC 0.6958392858505249, avg_entr 0.3158401846885681
Test Epoch31 layer4 Acc 0.6264, AUC 0.6965727806091309, avg_entr 0.31892886757850647
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 31
gc 0
Train Epoch32 Acc 0.652975 (26119/40000), AUC 0.7081451416015625
Test Epoch32 layer0 Acc 0.6369, AUC 0.6961087584495544, avg_entr 0.33033356070518494
Test Epoch32 layer1 Acc 0.6382, AUC 0.694908857345581, avg_entr 0.33134159445762634
Test Epoch32 layer2 Acc 0.6357, AUC 0.696601390838623, avg_entr 0.32992592453956604
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 32
Test Epoch32 layer3 Acc 0.636, AUC 0.6959419250488281, avg_entr 0.3302929699420929
Test Epoch32 layer4 Acc 0.6383, AUC 0.6968050599098206, avg_entr 0.32979339361190796
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 32
gc 0
Train Epoch33 Acc 0.6526 (26104/40000), AUC 0.7073994278907776
Test Epoch33 layer0 Acc 0.6363, AUC 0.6963522434234619, avg_entr 0.33304405212402344
Test Epoch33 layer1 Acc 0.6368, AUC 0.695152997970581, avg_entr 0.33234402537345886
Test Epoch33 layer2 Acc 0.6397, AUC 0.6968340873718262, avg_entr 0.33197879791259766
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 33
Test Epoch33 layer3 Acc 0.64, AUC 0.6963170766830444, avg_entr 0.33289918303489685
Test Epoch33 layer4 Acc 0.6383, AUC 0.6970686912536621, avg_entr 0.3313535451889038
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 33
gc 0
Train Epoch34 Acc 0.65295 (26118/40000), AUC 0.7085107564926147
Test Epoch34 layer0 Acc 0.637, AUC 0.6965169906616211, avg_entr 0.32651931047439575
Test Epoch34 layer1 Acc 0.6396, AUC 0.6952818036079407, avg_entr 0.325863778591156
Test Epoch34 layer2 Acc 0.6382, AUC 0.6970359086990356, avg_entr 0.3254343569278717
Test Epoch34 layer3 Acc 0.638, AUC 0.6964726448059082, avg_entr 0.3261708617210388
Test Epoch34 layer4 Acc 0.6431, AUC 0.6972101330757141, avg_entr 0.32502686977386475
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 34
gc 0
Train Epoch35 Acc 0.65295 (26118/40000), AUC 0.7102820873260498
Test Epoch35 layer0 Acc 0.6323, AUC 0.6966773271560669, avg_entr 0.31374743580818176
Test Epoch35 layer1 Acc 0.63, AUC 0.6954152584075928, avg_entr 0.3140334486961365
Test Epoch35 layer2 Acc 0.6338, AUC 0.6971105933189392, avg_entr 0.3150422275066376
Test Epoch35 layer3 Acc 0.6343, AUC 0.696644127368927, avg_entr 0.31382960081100464
Test Epoch35 layer4 Acc 0.6338, AUC 0.6973069906234741, avg_entr 0.3152262568473816
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 35
gc 0
Train Epoch36 Acc 0.652575 (26103/40000), AUC 0.709183394908905
Test Epoch36 layer0 Acc 0.6327, AUC 0.6967649459838867, avg_entr 0.31100520491600037
Test Epoch36 layer1 Acc 0.6296, AUC 0.6954901218414307, avg_entr 0.30915939807891846
Test Epoch36 layer2 Acc 0.6325, AUC 0.6972552537918091, avg_entr 0.30777862668037415
Test Epoch36 layer3 Acc 0.6341, AUC 0.6967898607254028, avg_entr 0.30901074409484863
Test Epoch36 layer4 Acc 0.6316, AUC 0.6974294185638428, avg_entr 0.3082716464996338
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 36
gc 0
Train Epoch37 Acc 0.653925 (26157/40000), AUC 0.7112396359443665
Test Epoch37 layer0 Acc 0.6372, AUC 0.6968737840652466, avg_entr 0.30296415090560913
Test Epoch37 layer1 Acc 0.6385, AUC 0.695507287979126, avg_entr 0.30405133962631226
Test Epoch37 layer2 Acc 0.6383, AUC 0.6974146366119385, avg_entr 0.3036346733570099
Test Epoch37 layer3 Acc 0.6383, AUC 0.696837842464447, avg_entr 0.3029121458530426
Test Epoch37 layer4 Acc 0.6387, AUC 0.6975080370903015, avg_entr 0.30129924416542053
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 37
gc 0
Train Epoch38 Acc 0.65245 (26098/40000), AUC 0.7099579572677612
Test Epoch38 layer0 Acc 0.6374, AUC 0.6970016956329346, avg_entr 0.3068224787712097
Test Epoch38 layer1 Acc 0.6403, AUC 0.6956262588500977, avg_entr 0.30645865201950073
Test Epoch38 layer2 Acc 0.6386, AUC 0.6975206136703491, avg_entr 0.3045892119407654
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 38
Test Epoch38 layer3 Acc 0.6381, AUC 0.6969833374023438, avg_entr 0.30553358793258667
Test Epoch38 layer4 Acc 0.6433, AUC 0.6976521611213684, avg_entr 0.3046766519546509
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 38
gc 0
Train Epoch39 Acc 0.65515 (26206/40000), AUC 0.709781289100647
Test Epoch39 layer0 Acc 0.6374, AUC 0.6970891952514648, avg_entr 0.2975184917449951
Test Epoch39 layer1 Acc 0.6388, AUC 0.6956925392150879, avg_entr 0.29652756452560425
Test Epoch39 layer2 Acc 0.6394, AUC 0.6976470947265625, avg_entr 0.2976399064064026
Test Epoch39 layer3 Acc 0.6383, AUC 0.6970717906951904, avg_entr 0.2956664264202118
Test Epoch39 layer4 Acc 0.6416, AUC 0.6977511644363403, avg_entr 0.29570019245147705
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 39
gc 0
Train Epoch40 Acc 0.65285 (26114/40000), AUC 0.7084300518035889
Test Epoch40 layer0 Acc 0.639, AUC 0.6972626447677612, avg_entr 0.30214202404022217
Test Epoch40 layer1 Acc 0.64, AUC 0.6958811283111572, avg_entr 0.3006167411804199
Test Epoch40 layer2 Acc 0.6406, AUC 0.6977735757827759, avg_entr 0.29949355125427246
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 40
Test Epoch40 layer3 Acc 0.6383, AUC 0.6973129510879517, avg_entr 0.30019107460975647
Test Epoch40 layer4 Acc 0.6414, AUC 0.6979497671127319, avg_entr 0.2988281846046448
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 40
gc 0
Train Epoch41 Acc 0.652375 (26095/40000), AUC 0.7110990285873413
Test Epoch41 layer0 Acc 0.6365, AUC 0.6972740888595581, avg_entr 0.2809978127479553
Test Epoch41 layer1 Acc 0.6338, AUC 0.6958717107772827, avg_entr 0.281353622674942
Test Epoch41 layer2 Acc 0.6374, AUC 0.6978561878204346, avg_entr 0.2812766432762146
Test Epoch41 layer3 Acc 0.6364, AUC 0.6972533464431763, avg_entr 0.2806772291660309
Test Epoch41 layer4 Acc 0.6354, AUC 0.6979384422302246, avg_entr 0.2804333567619324
gc 0
Train Epoch42 Acc 0.6555 (26220/40000), AUC 0.7119558453559875
Test Epoch42 layer0 Acc 0.6388, AUC 0.6974628567695618, avg_entr 0.2905087172985077
Test Epoch42 layer1 Acc 0.6361, AUC 0.6960693001747131, avg_entr 0.2891903817653656
Test Epoch42 layer2 Acc 0.6401, AUC 0.6979561448097229, avg_entr 0.2881591320037842
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 42
Test Epoch42 layer3 Acc 0.6394, AUC 0.6974469423294067, avg_entr 0.288249671459198
Test Epoch42 layer4 Acc 0.6396, AUC 0.6980466842651367, avg_entr 0.2875062823295593
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 42
gc 0
Train Epoch43 Acc 0.6535 (26140/40000), AUC 0.7107318639755249
Test Epoch43 layer0 Acc 0.6382, AUC 0.6974913477897644, avg_entr 0.28739529848098755
Test Epoch43 layer1 Acc 0.6394, AUC 0.6960667371749878, avg_entr 0.28595513105392456
Test Epoch43 layer2 Acc 0.641, AUC 0.6980137825012207, avg_entr 0.2855314016342163
Test Epoch43 layer3 Acc 0.6387, AUC 0.6975021362304688, avg_entr 0.28476929664611816
Test Epoch43 layer4 Acc 0.64, AUC 0.6981341242790222, avg_entr 0.2842334806919098
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 43
gc 0
Train Epoch44 Acc 0.655875 (26235/40000), AUC 0.7125317454338074
Test Epoch44 layer0 Acc 0.6383, AUC 0.6973893642425537, avg_entr 0.2784787714481354
Test Epoch44 layer1 Acc 0.6385, AUC 0.695899248123169, avg_entr 0.2761910855770111
Test Epoch44 layer2 Acc 0.6371, AUC 0.6979700922966003, avg_entr 0.27611300349235535
Test Epoch44 layer3 Acc 0.6394, AUC 0.6973662376403809, avg_entr 0.2757120728492737
Test Epoch44 layer4 Acc 0.6431, AUC 0.6979689002037048, avg_entr 0.27448567748069763
gc 0
Train Epoch45 Acc 0.6533 (26132/40000), AUC 0.7125428915023804
Test Epoch45 layer0 Acc 0.6288, AUC 0.6976673007011414, avg_entr 0.26212096214294434
Test Epoch45 layer1 Acc 0.6265, AUC 0.696259081363678, avg_entr 0.26058468222618103
Test Epoch45 layer2 Acc 0.6284, AUC 0.6981550455093384, avg_entr 0.26158982515335083
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 45
Test Epoch45 layer3 Acc 0.6305, AUC 0.6977168917655945, avg_entr 0.26163429021835327
Test Epoch45 layer4 Acc 0.63, AUC 0.6982555389404297, avg_entr 0.2603352665901184
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 45
gc 0
Train Epoch46 Acc 0.6553 (26212/40000), AUC 0.7126145958900452
Test Epoch46 layer0 Acc 0.6361, AUC 0.697596549987793, avg_entr 0.26051807403564453
Test Epoch46 layer1 Acc 0.6335, AUC 0.6961220502853394, avg_entr 0.25490906834602356
Test Epoch46 layer2 Acc 0.6347, AUC 0.6981174945831299, avg_entr 0.2559582591056824
Test Epoch46 layer3 Acc 0.6364, AUC 0.6975669264793396, avg_entr 0.2581421732902527
Test Epoch46 layer4 Acc 0.6351, AUC 0.698190450668335, avg_entr 0.25636935234069824
gc 0
Train Epoch47 Acc 0.65445 (26178/40000), AUC 0.7112962007522583
Test Epoch47 layer0 Acc 0.6387, AUC 0.6978094577789307, avg_entr 0.27283528447151184
Test Epoch47 layer1 Acc 0.6398, AUC 0.6964253187179565, avg_entr 0.2710924744606018
Test Epoch47 layer2 Acc 0.6397, AUC 0.6983665227890015, avg_entr 0.26957306265830994
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 47
Test Epoch47 layer3 Acc 0.6386, AUC 0.6978302001953125, avg_entr 0.2694125473499298
Test Epoch47 layer4 Acc 0.6417, AUC 0.69837886095047, avg_entr 0.2683877646923065
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 47
gc 0
Train Epoch48 Acc 0.653975 (26159/40000), AUC 0.7119020223617554
Test Epoch48 layer0 Acc 0.6394, AUC 0.6978977918624878, avg_entr 0.2674146592617035
Test Epoch48 layer1 Acc 0.6406, AUC 0.6965208053588867, avg_entr 0.26551583409309387
Test Epoch48 layer2 Acc 0.6379, AUC 0.6984620094299316, avg_entr 0.26404088735580444
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 48
Test Epoch48 layer3 Acc 0.6397, AUC 0.6979119181632996, avg_entr 0.26312369108200073
Test Epoch48 layer4 Acc 0.643, AUC 0.6984627842903137, avg_entr 0.26330482959747314
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 48
gc 0
Train Epoch49 Acc 0.6556 (26224/40000), AUC 0.7120307683944702
Test Epoch49 layer0 Acc 0.6376, AUC 0.6979730129241943, avg_entr 0.25740787386894226
Test Epoch49 layer1 Acc 0.6366, AUC 0.6965948343276978, avg_entr 0.25540438294410706
Test Epoch49 layer2 Acc 0.6394, AUC 0.6984890103340149, avg_entr 0.2543623149394989
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 49
Test Epoch49 layer3 Acc 0.6399, AUC 0.6979708671569824, avg_entr 0.25431883335113525
Test Epoch49 layer4 Acc 0.6388, AUC 0.6985251903533936, avg_entr 0.25388777256011963
Save ckpt to ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt  ,ep 49
Best AUC 0.6985251903533936
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_linearalside_l5_side750//imdb_linearalside_l5_side.pt
[[3702 1260]
 [2364 2674]]
Figure(640x480)
tensor([0.0148, 0.6882, 0.4212,  ..., 0.4674, 0.4197, 0.0158])
[[3680 1282]
 [2352 2686]]
Figure(640x480)
tensor([0.0178, 0.6491, 0.5326,  ..., 0.5567, 0.3406, 0.0097])
[[3681 1281]
 [2325 2713]]
Figure(640x480)
tensor([0.0316, 0.6942, 0.5583,  ..., 0.5036, 0.3238, 0.0126])
[[3701 1261]
 [2340 2698]]
Figure(640x480)
tensor([0.0104, 0.6800, 0.5469,  ..., 0.4886, 0.2995, 0.0143])
[[3688 1274]
 [2338 2700]]
Figure(640x480)
tensor([0.0125, 0.5805, 0.5205,  ..., 0.2827, 0.2928, 0.0094])
