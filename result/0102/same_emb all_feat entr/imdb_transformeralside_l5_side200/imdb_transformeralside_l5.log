total count words 222751
vocab size 30000
found 27937 words in glove
model: TransformerALsideText(
  (layers): ModuleList(
    (0): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): TransLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): TransformerEncoder(
          (multi_headed_attention): MultiHeadAttention(
            (linears): ModuleList(
              (0): Linear(in_features=300, out_features=300, bias=True)
              (1): Linear(in_features=300, out_features=300, bias=True)
              (2): Linear(in_features=300, out_features=300, bias=True)
              (3): Linear(in_features=300, out_features=300, bias=True)
            )
            (sdpa): ScaledDotProductAttention()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (feed_forward): FeedForward(
            (w_1): Linear(in_features=300, out_features=300, bias=True)
            (w_2): Linear(in_features=300, out_features=300, bias=True)
            (relu): ReLU()
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (encoder_layer): EncoderLayer(
            (self_attn): MultiHeadAttention(
              (linears): ModuleList(
                (0): Linear(in_features=300, out_features=300, bias=True)
                (1): Linear(in_features=300, out_features=300, bias=True)
                (2): Linear(in_features=300, out_features=300, bias=True)
                (3): Linear(in_features=300, out_features=300, bias=True)
              )
              (sdpa): ScaledDotProductAttention()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (feed_forward): FeedForward(
              (w_1): Linear(in_features=300, out_features=300, bias=True)
              (w_2): Linear(in_features=300, out_features=300, bias=True)
              (relu): ReLU()
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (sublayer): ModuleList(
              (0): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (1): SublayerConnection(
                (norm): LayerNorm()
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
          (encoder): Encoder(
            (layers): ModuleList(
              (0): EncoderLayer(
                (self_attn): MultiHeadAttention(
                  (linears): ModuleList(
                    (0): Linear(in_features=300, out_features=300, bias=True)
                    (1): Linear(in_features=300, out_features=300, bias=True)
                    (2): Linear(in_features=300, out_features=300, bias=True)
                    (3): Linear(in_features=300, out_features=300, bias=True)
                  )
                  (sdpa): ScaledDotProductAttention()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (feed_forward): FeedForward(
                  (w_1): Linear(in_features=300, out_features=300, bias=True)
                  (w_2): Linear(in_features=300, out_features=300, bias=True)
                  (relu): ReLU()
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (sublayer): ModuleList(
                  (0): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                  (1): SublayerConnection(
                    (norm): LayerNorm()
                    (dropout): Dropout(p=0.1, inplace=False)
                  )
                )
              )
            )
            (norm): LayerNorm()
          )
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb): Embedding(30000, 300)
)
Start Training
gc 0
Train Epoch0 Acc 0.5013 (20052/40000), AUC 0.4988599717617035
Test Epoch0 layer0 Acc 0.5252, AUC 0.5514694452285767, avg_entr 0.6895167231559753
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5345, AUC 0.5813112258911133, avg_entr 0.6915017366409302
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.5168, AUC 0.547601044178009, avg_entr 0.6944250464439392
Test Epoch0 layer3 Acc 0.4983, AUC 0.5120424032211304, avg_entr 0.6919135451316833
Test Epoch0 layer4 Acc 0.5205, AUC 0.5277659893035889, avg_entr 0.6945701241493225
gc 0
Train Epoch1 Acc 0.52845 (21138/40000), AUC 0.5399287939071655
Test Epoch1 layer0 Acc 0.5164, AUC 0.6324766278266907, avg_entr 0.6836657524108887
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.6088, AUC 0.6923201084136963, avg_entr 0.6779012084007263
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.5012, AUC 0.6810933351516724, avg_entr 0.6883901357650757
Test Epoch1 layer3 Acc 0.5461, AUC 0.6404718160629272, avg_entr 0.6944574117660522
Test Epoch1 layer4 Acc 0.5187, AUC 0.6503610610961914, avg_entr 0.6954026222229004
gc 0
Train Epoch2 Acc 0.60545 (24218/40000), AUC 0.6419477462768555
Test Epoch2 layer0 Acc 0.6456, AUC 0.7003155946731567, avg_entr 0.6668736934661865
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.66, AUC 0.7250450849533081, avg_entr 0.6503909230232239
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.6763, AUC 0.7405383586883545, avg_entr 0.650444746017456
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 2
Test Epoch2 layer3 Acc 0.6636, AUC 0.7388335466384888, avg_entr 0.6551868915557861
Test Epoch2 layer4 Acc 0.6446, AUC 0.7271026968955994, avg_entr 0.6683676838874817
gc 0
Train Epoch3 Acc 0.680075 (27203/40000), AUC 0.7422295808792114
Test Epoch3 layer0 Acc 0.6817, AUC 0.7881249189376831, avg_entr 0.5758265852928162
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.6633, AUC 0.8090699911117554, avg_entr 0.5427815318107605
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.6494, AUC 0.8290262222290039, avg_entr 0.5029111504554749
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 3
Test Epoch3 layer3 Acc 0.6471, AUC 0.8288894891738892, avg_entr 0.4800102412700653
Test Epoch3 layer4 Acc 0.6232, AUC 0.8284081220626831, avg_entr 0.4560869634151459
gc 0
Train Epoch4 Acc 0.730425 (29217/40000), AUC 0.8081003427505493
Test Epoch4 layer0 Acc 0.7365, AUC 0.8152785301208496, avg_entr 0.5172309279441833
Test Epoch4 layer1 Acc 0.7714, AUC 0.8578141331672668, avg_entr 0.47314825654029846
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.7735, AUC 0.8626220226287842, avg_entr 0.45075753331184387
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 4
Test Epoch4 layer3 Acc 0.7753, AUC 0.8622075319290161, avg_entr 0.4254100024700165
Test Epoch4 layer4 Acc 0.7739, AUC 0.8616161942481995, avg_entr 0.4153435528278351
gc 0
Train Epoch5 Acc 0.765375 (30615/40000), AUC 0.844930112361908
Test Epoch5 layer0 Acc 0.7565, AUC 0.8403412103652954, avg_entr 0.4638742208480835
Test Epoch5 layer1 Acc 0.7811, AUC 0.8705219030380249, avg_entr 0.43308213353157043
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.7856, AUC 0.874077558517456, avg_entr 0.4189209043979645
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 5
Test Epoch5 layer3 Acc 0.7874, AUC 0.8735618591308594, avg_entr 0.39838486909866333
Test Epoch5 layer4 Acc 0.7863, AUC 0.872784435749054, avg_entr 0.4022768437862396
gc 0
Train Epoch6 Acc 0.78055 (31222/40000), AUC 0.8620203137397766
Test Epoch6 layer0 Acc 0.7676, AUC 0.856874942779541, avg_entr 0.4141756296157837
Test Epoch6 layer1 Acc 0.7816, AUC 0.878494381904602, avg_entr 0.37786543369293213
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 6
Test Epoch6 layer2 Acc 0.7853, AUC 0.8822258710861206, avg_entr 0.35102784633636475
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 6
Test Epoch6 layer3 Acc 0.7881, AUC 0.8828921318054199, avg_entr 0.32758307456970215
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 6
Test Epoch6 layer4 Acc 0.7839, AUC 0.8824406862258911, avg_entr 0.31725752353668213
gc 0
Train Epoch7 Acc 0.79505 (31802/40000), AUC 0.8769245147705078
Test Epoch7 layer0 Acc 0.7772, AUC 0.8659664392471313, avg_entr 0.3918208181858063
Test Epoch7 layer1 Acc 0.7985, AUC 0.8858860731124878, avg_entr 0.35079047083854675
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 7
Test Epoch7 layer2 Acc 0.802, AUC 0.8888702392578125, avg_entr 0.3354127109050751
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 7
Test Epoch7 layer3 Acc 0.8035, AUC 0.8896726369857788, avg_entr 0.30652299523353577
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 7
Test Epoch7 layer4 Acc 0.8015, AUC 0.8894065618515015, avg_entr 0.30246466398239136
gc 0
Train Epoch8 Acc 0.803225 (32129/40000), AUC 0.8836833238601685
Test Epoch8 layer0 Acc 0.7787, AUC 0.8706518411636353, avg_entr 0.3658647835254669
Test Epoch8 layer1 Acc 0.7924, AUC 0.8910163640975952, avg_entr 0.3258120119571686
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 8
Test Epoch8 layer2 Acc 0.8003, AUC 0.8945804834365845, avg_entr 0.298160195350647
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 8
Test Epoch8 layer3 Acc 0.8032, AUC 0.8949524164199829, avg_entr 0.2680511474609375
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 8
Test Epoch8 layer4 Acc 0.8022, AUC 0.8948510885238647, avg_entr 0.2508748471736908
gc 0
Train Epoch9 Acc 0.810225 (32409/40000), AUC 0.8915027976036072
Test Epoch9 layer0 Acc 0.7634, AUC 0.8764320611953735, avg_entr 0.333146870136261
Test Epoch9 layer1 Acc 0.7744, AUC 0.8960225582122803, avg_entr 0.291349858045578
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 9
Test Epoch9 layer2 Acc 0.777, AUC 0.8989237546920776, avg_entr 0.27048489451408386
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 9
Test Epoch9 layer3 Acc 0.7802, AUC 0.8993849754333496, avg_entr 0.24475932121276855
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 9
Test Epoch9 layer4 Acc 0.7657, AUC 0.8995752334594727, avg_entr 0.23130984604358673
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.81825 (32730/40000), AUC 0.8962473273277283
Test Epoch10 layer0 Acc 0.7734, AUC 0.8821878433227539, avg_entr 0.30432623624801636
Test Epoch10 layer1 Acc 0.8094, AUC 0.9010410308837891, avg_entr 0.2726038992404938
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 10
Test Epoch10 layer2 Acc 0.8009, AUC 0.9041423797607422, avg_entr 0.24437390267848969
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 10
Test Epoch10 layer3 Acc 0.8009, AUC 0.9046247601509094, avg_entr 0.2180178165435791
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 10
Test Epoch10 layer4 Acc 0.8011, AUC 0.904282808303833, avg_entr 0.2099514901638031
gc 0
Train Epoch11 Acc 0.825925 (33037/40000), AUC 0.9045488834381104
Test Epoch11 layer0 Acc 0.8001, AUC 0.886609673500061, avg_entr 0.2984125316143036
Test Epoch11 layer1 Acc 0.8194, AUC 0.9040625095367432, avg_entr 0.2532423734664917
Test Epoch11 layer2 Acc 0.8262, AUC 0.9074397087097168, avg_entr 0.22989943623542786
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 11
Test Epoch11 layer3 Acc 0.8284, AUC 0.9077965617179871, avg_entr 0.19983108341693878
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 11
Test Epoch11 layer4 Acc 0.8259, AUC 0.9079116582870483, avg_entr 0.18151713907718658
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.832075 (33283/40000), AUC 0.9107969999313354
Test Epoch12 layer0 Acc 0.8006, AUC 0.8903566002845764, avg_entr 0.28788304328918457
Test Epoch12 layer1 Acc 0.8184, AUC 0.9074658751487732, avg_entr 0.2457679957151413
Test Epoch12 layer2 Acc 0.8234, AUC 0.9102906584739685, avg_entr 0.2183321714401245
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 12
Test Epoch12 layer3 Acc 0.8222, AUC 0.911524772644043, avg_entr 0.1916075050830841
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 12
Test Epoch12 layer4 Acc 0.8224, AUC 0.911746621131897, avg_entr 0.17585164308547974
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.838 (33520/40000), AUC 0.9158685207366943
Test Epoch13 layer0 Acc 0.8098, AUC 0.8934924006462097, avg_entr 0.2668980360031128
Test Epoch13 layer1 Acc 0.8283, AUC 0.9103039503097534, avg_entr 0.2246856689453125
Test Epoch13 layer2 Acc 0.8339, AUC 0.9128012657165527, avg_entr 0.1854143887758255
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 13
Test Epoch13 layer3 Acc 0.8361, AUC 0.9136990308761597, avg_entr 0.1601816713809967
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 13
Test Epoch13 layer4 Acc 0.8344, AUC 0.9138376712799072, avg_entr 0.14782851934432983
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.83925 (33570/40000), AUC 0.9153178930282593
Test Epoch14 layer0 Acc 0.801, AUC 0.8954653143882751, avg_entr 0.25685080885887146
Test Epoch14 layer1 Acc 0.8167, AUC 0.9117881655693054, avg_entr 0.21242234110832214
Test Epoch14 layer2 Acc 0.8221, AUC 0.9131391644477844, avg_entr 0.16534516215324402
Test Epoch14 layer3 Acc 0.8256, AUC 0.913338303565979, avg_entr 0.13922160863876343
Test Epoch14 layer4 Acc 0.8237, AUC 0.9133864045143127, avg_entr 0.12252664566040039
gc 0
Train Epoch15 Acc 0.846425 (33857/40000), AUC 0.9206045269966125
Test Epoch15 layer0 Acc 0.8123, AUC 0.8979666829109192, avg_entr 0.23720180988311768
Test Epoch15 layer1 Acc 0.8353, AUC 0.9132557511329651, avg_entr 0.1966267079114914
Test Epoch15 layer2 Acc 0.8387, AUC 0.9147052764892578, avg_entr 0.14769339561462402
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 15
Test Epoch15 layer3 Acc 0.8378, AUC 0.914985179901123, avg_entr 0.1283034235239029
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 15
Test Epoch15 layer4 Acc 0.839, AUC 0.9151558876037598, avg_entr 0.1203744113445282
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.848325 (33933/40000), AUC 0.9227493405342102
Test Epoch16 layer0 Acc 0.7977, AUC 0.900105357170105, avg_entr 0.22952798008918762
Test Epoch16 layer1 Acc 0.8104, AUC 0.9134665131568909, avg_entr 0.17595961689949036
Test Epoch16 layer2 Acc 0.8141, AUC 0.9145437479019165, avg_entr 0.12467619776725769
Test Epoch16 layer3 Acc 0.8168, AUC 0.91560298204422, avg_entr 0.10909393429756165
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 16
Test Epoch16 layer4 Acc 0.8148, AUC 0.9155455827713013, avg_entr 0.0999339371919632
gc 0
Train Epoch17 Acc 0.853625 (34145/40000), AUC 0.9258317351341248
Test Epoch17 layer0 Acc 0.8162, AUC 0.9015613794326782, avg_entr 0.22288818657398224
Test Epoch17 layer1 Acc 0.835, AUC 0.91529780626297, avg_entr 0.1684417724609375
Test Epoch17 layer2 Acc 0.8399, AUC 0.9174922108650208, avg_entr 0.12433113902807236
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 17
Test Epoch17 layer3 Acc 0.8407, AUC 0.9185154438018799, avg_entr 0.1125030368566513
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 17
Test Epoch17 layer4 Acc 0.8399, AUC 0.9181782007217407, avg_entr 0.1037081778049469
gc 0
Train Epoch18 Acc 0.85645 (34258/40000), AUC 0.9300045967102051
Test Epoch18 layer0 Acc 0.8179, AUC 0.9032634496688843, avg_entr 0.21249160170555115
Test Epoch18 layer1 Acc 0.8351, AUC 0.9157174825668335, avg_entr 0.14572130143642426
Test Epoch18 layer2 Acc 0.84, AUC 0.9183549880981445, avg_entr 0.11586577445268631
Test Epoch18 layer3 Acc 0.8377, AUC 0.9195231199264526, avg_entr 0.10400152951478958
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 18
Test Epoch18 layer4 Acc 0.8381, AUC 0.9193689823150635, avg_entr 0.1001569926738739
gc 0
Train Epoch19 Acc 0.85615 (34246/40000), AUC 0.9292360544204712
Test Epoch19 layer0 Acc 0.8016, AUC 0.903597354888916, avg_entr 0.20680341124534607
Test Epoch19 layer1 Acc 0.8109, AUC 0.9147785902023315, avg_entr 0.13120652735233307
Test Epoch19 layer2 Acc 0.811, AUC 0.9171181917190552, avg_entr 0.10406800359487534
Test Epoch19 layer3 Acc 0.8145, AUC 0.9187923669815063, avg_entr 0.08915819227695465
Test Epoch19 layer4 Acc 0.8118, AUC 0.9185307025909424, avg_entr 0.09076021611690521
gc 0
Train Epoch20 Acc 0.857425 (34297/40000), AUC 0.9302170276641846
Test Epoch20 layer0 Acc 0.8207, AUC 0.904470682144165, avg_entr 0.20083683729171753
Test Epoch20 layer1 Acc 0.8306, AUC 0.9160274267196655, avg_entr 0.11843514442443848
Test Epoch20 layer2 Acc 0.8384, AUC 0.9198852777481079, avg_entr 0.09704694151878357
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 20
Test Epoch20 layer3 Acc 0.8362, AUC 0.9209088683128357, avg_entr 0.08891399204730988
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 20
Test Epoch20 layer4 Acc 0.8375, AUC 0.9209312796592712, avg_entr 0.08522940427064896
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 20
gc 0
Train Epoch21 Acc 0.862275 (34491/40000), AUC 0.9357900023460388
Test Epoch21 layer0 Acc 0.8153, AUC 0.9049497842788696, avg_entr 0.19460925459861755
Test Epoch21 layer1 Acc 0.8209, AUC 0.9144095778465271, avg_entr 0.11780282855033875
Test Epoch21 layer2 Acc 0.823, AUC 0.9192622303962708, avg_entr 0.1035248413681984
Test Epoch21 layer3 Acc 0.8184, AUC 0.9205131530761719, avg_entr 0.09817776083946228
Test Epoch21 layer4 Acc 0.8165, AUC 0.9203996658325195, avg_entr 0.09900262951850891
gc 0
Train Epoch22 Acc 0.8662 (34648/40000), AUC 0.9370150566101074
Test Epoch22 layer0 Acc 0.8127, AUC 0.9060509204864502, avg_entr 0.1866922676563263
Test Epoch22 layer1 Acc 0.8209, AUC 0.9153046607971191, avg_entr 0.10618653893470764
Test Epoch22 layer2 Acc 0.8264, AUC 0.9201907515525818, avg_entr 0.08606915175914764
Test Epoch22 layer3 Acc 0.827, AUC 0.9211108684539795, avg_entr 0.07711466401815414
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 22
Test Epoch22 layer4 Acc 0.8281, AUC 0.9209906458854675, avg_entr 0.0721510723233223
gc 0
Train Epoch23 Acc 0.8691 (34764/40000), AUC 0.9401882290840149
Test Epoch23 layer0 Acc 0.8099, AUC 0.9060769081115723, avg_entr 0.17952637374401093
Test Epoch23 layer1 Acc 0.8192, AUC 0.9141185879707336, avg_entr 0.09599413722753525
Test Epoch23 layer2 Acc 0.8319, AUC 0.9194934368133545, avg_entr 0.08462236076593399
Test Epoch23 layer3 Acc 0.8328, AUC 0.9202628135681152, avg_entr 0.07472068071365356
Test Epoch23 layer4 Acc 0.8339, AUC 0.9201899766921997, avg_entr 0.07074923068284988
gc 0
Train Epoch24 Acc 0.871025 (34841/40000), AUC 0.9415292739868164
Test Epoch24 layer0 Acc 0.8234, AUC 0.9076205492019653, avg_entr 0.17771853506565094
Test Epoch24 layer1 Acc 0.8335, AUC 0.9170447587966919, avg_entr 0.0962676852941513
Test Epoch24 layer2 Acc 0.8381, AUC 0.9217337965965271, avg_entr 0.08015112578868866
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 24
Test Epoch24 layer3 Acc 0.8398, AUC 0.922401487827301, avg_entr 0.0720055103302002
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 24
Test Epoch24 layer4 Acc 0.8402, AUC 0.9222071170806885, avg_entr 0.06873033940792084
gc 0
Train Epoch25 Acc 0.872425 (34897/40000), AUC 0.9421521425247192
Test Epoch25 layer0 Acc 0.8299, AUC 0.909386157989502, avg_entr 0.16367271542549133
Test Epoch25 layer1 Acc 0.8401, AUC 0.9187222719192505, avg_entr 0.08678889274597168
Test Epoch25 layer2 Acc 0.8465, AUC 0.9228271842002869, avg_entr 0.06850092858076096
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 25
Test Epoch25 layer3 Acc 0.8454, AUC 0.9234117865562439, avg_entr 0.06380968540906906
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 25
Test Epoch25 layer4 Acc 0.8454, AUC 0.9231954216957092, avg_entr 0.060519251972436905
gc 0
Train Epoch26 Acc 0.8718 (34872/40000), AUC 0.9418034553527832
Test Epoch26 layer0 Acc 0.8258, AUC 0.9090092182159424, avg_entr 0.16329967975616455
Test Epoch26 layer1 Acc 0.8388, AUC 0.9184756278991699, avg_entr 0.0916447639465332
Test Epoch26 layer2 Acc 0.8414, AUC 0.9229614734649658, avg_entr 0.08455970138311386
Test Epoch26 layer3 Acc 0.8405, AUC 0.9234235286712646, avg_entr 0.08464900404214859
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 26
Test Epoch26 layer4 Acc 0.8416, AUC 0.9233850240707397, avg_entr 0.08618597686290741
gc 0
Train Epoch27 Acc 0.87785 (35114/40000), AUC 0.9471105933189392
Test Epoch27 layer0 Acc 0.8318, AUC 0.9105671644210815, avg_entr 0.1580035239458084
Test Epoch27 layer1 Acc 0.84, AUC 0.9191498756408691, avg_entr 0.08128020167350769
Test Epoch27 layer2 Acc 0.8435, AUC 0.9237626791000366, avg_entr 0.0728210061788559
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 27
Test Epoch27 layer3 Acc 0.8441, AUC 0.9239730834960938, avg_entr 0.06956098973751068
Save ckpt to ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt  ,ep 27
Test Epoch27 layer4 Acc 0.844, AUC 0.9237484931945801, avg_entr 0.06888817995786667
gc 0
Train Epoch28 Acc 0.879525 (35181/40000), AUC 0.9492097496986389
Test Epoch28 layer0 Acc 0.7988, AUC 0.9100508689880371, avg_entr 0.15378648042678833
Test Epoch28 layer1 Acc 0.791, AUC 0.9131971597671509, avg_entr 0.08552385121583939
Test Epoch28 layer2 Acc 0.7949, AUC 0.9220490455627441, avg_entr 0.07270662486553192
Test Epoch28 layer3 Acc 0.7917, AUC 0.9210150241851807, avg_entr 0.07572685182094574
Test Epoch28 layer4 Acc 0.7882, AUC 0.9206441640853882, avg_entr 0.07663977891206741
gc 0
Train Epoch29 Acc 0.88405 (35362/40000), AUC 0.9514580965042114
Test Epoch29 layer0 Acc 0.8143, AUC 0.9108152985572815, avg_entr 0.1515379548072815
Test Epoch29 layer1 Acc 0.82, AUC 0.9153754711151123, avg_entr 0.07788843661546707
Test Epoch29 layer2 Acc 0.8262, AUC 0.9224791526794434, avg_entr 0.06927540153265
Test Epoch29 layer3 Acc 0.8248, AUC 0.921983003616333, avg_entr 0.07456144690513611
Test Epoch29 layer4 Acc 0.8254, AUC 0.9217761754989624, avg_entr 0.07368899881839752
gc 0
Train Epoch30 Acc 0.88515 (35406/40000), AUC 0.952472448348999
Test Epoch30 layer0 Acc 0.8216, AUC 0.9113807678222656, avg_entr 0.14559373259544373
Test Epoch30 layer1 Acc 0.8187, AUC 0.9159621000289917, avg_entr 0.07643463462591171
Test Epoch30 layer2 Acc 0.822, AUC 0.9229861497879028, avg_entr 0.06500878185033798
Test Epoch30 layer3 Acc 0.8187, AUC 0.9220925569534302, avg_entr 0.06525515019893646
Test Epoch30 layer4 Acc 0.8165, AUC 0.9217342734336853, avg_entr 0.06769587099552155
gc 0
Train Epoch31 Acc 0.890175 (35607/40000), AUC 0.9540846943855286
Test Epoch31 layer0 Acc 0.8311, AUC 0.9123438596725464, avg_entr 0.13976767659187317
Test Epoch31 layer1 Acc 0.8396, AUC 0.918338418006897, avg_entr 0.0699012503027916
Test Epoch31 layer2 Acc 0.8463, AUC 0.9227440357208252, avg_entr 0.062258027493953705
Test Epoch31 layer3 Acc 0.8475, AUC 0.9232380390167236, avg_entr 0.05272548645734787
Test Epoch31 layer4 Acc 0.8475, AUC 0.9229333400726318, avg_entr 0.053440533578395844
gc 0
Train Epoch32 Acc 0.89385 (35754/40000), AUC 0.9592118263244629
Test Epoch32 layer0 Acc 0.8255, AUC 0.9110597372055054, avg_entr 0.13761135935783386
Test Epoch32 layer1 Acc 0.8281, AUC 0.9156791567802429, avg_entr 0.06713011115789413
Test Epoch32 layer2 Acc 0.8345, AUC 0.9211657047271729, avg_entr 0.06026235222816467
Test Epoch32 layer3 Acc 0.8325, AUC 0.920851469039917, avg_entr 0.05569087341427803
Test Epoch32 layer4 Acc 0.8331, AUC 0.920718789100647, avg_entr 0.05639541149139404
gc 0
Train Epoch33 Acc 0.897075 (35883/40000), AUC 0.9599932432174683
Test Epoch33 layer0 Acc 0.832, AUC 0.9109159708023071, avg_entr 0.13457222282886505
Test Epoch33 layer1 Acc 0.8393, AUC 0.9171655178070068, avg_entr 0.06643355637788773
Test Epoch33 layer2 Acc 0.8445, AUC 0.9213767051696777, avg_entr 0.05701877549290657
Test Epoch33 layer3 Acc 0.8439, AUC 0.921521782875061, avg_entr 0.05246743932366371
Test Epoch33 layer4 Acc 0.844, AUC 0.9212911128997803, avg_entr 0.05304664373397827
gc 0
Train Epoch34 Acc 0.898975 (35959/40000), AUC 0.9611794948577881
Test Epoch34 layer0 Acc 0.8346, AUC 0.9119925498962402, avg_entr 0.13164253532886505
Test Epoch34 layer1 Acc 0.8394, AUC 0.9161045551300049, avg_entr 0.06263615936040878
Test Epoch34 layer2 Acc 0.8448, AUC 0.9218697547912598, avg_entr 0.05333300679922104
Test Epoch34 layer3 Acc 0.847, AUC 0.9224575161933899, avg_entr 0.05139044672250748
Test Epoch34 layer4 Acc 0.8465, AUC 0.9223418235778809, avg_entr 0.050738655030727386
gc 0
Train Epoch35 Acc 0.9007 (36028/40000), AUC 0.9624765515327454
Test Epoch35 layer0 Acc 0.8329, AUC 0.9116402864456177, avg_entr 0.12575297057628632
Test Epoch35 layer1 Acc 0.8386, AUC 0.9158501625061035, avg_entr 0.05929180234670639
Test Epoch35 layer2 Acc 0.8461, AUC 0.9215782880783081, avg_entr 0.0483580082654953
Test Epoch35 layer3 Acc 0.8458, AUC 0.9219033718109131, avg_entr 0.044660333544015884
Test Epoch35 layer4 Acc 0.846, AUC 0.9216351509094238, avg_entr 0.044992707669734955
gc 0
Train Epoch36 Acc 0.906925 (36277/40000), AUC 0.9662580490112305
Test Epoch36 layer0 Acc 0.8203, AUC 0.911055326461792, avg_entr 0.1273096352815628
Test Epoch36 layer1 Acc 0.816, AUC 0.9096617698669434, avg_entr 0.057536859065294266
Test Epoch36 layer2 Acc 0.8232, AUC 0.9183263778686523, avg_entr 0.046621959656476974
Test Epoch36 layer3 Acc 0.8231, AUC 0.9186645746231079, avg_entr 0.045150402933359146
Test Epoch36 layer4 Acc 0.8229, AUC 0.918378472328186, avg_entr 0.04566797614097595
gc 0
Train Epoch37 Acc 0.907275 (36291/40000), AUC 0.966982901096344
Test Epoch37 layer0 Acc 0.8296, AUC 0.9110055565834045, avg_entr 0.12287118285894394
Test Epoch37 layer1 Acc 0.8326, AUC 0.9126784205436707, avg_entr 0.05636009946465492
Test Epoch37 layer2 Acc 0.8358, AUC 0.9190428256988525, avg_entr 0.04696403816342354
Test Epoch37 layer3 Acc 0.8352, AUC 0.9196019768714905, avg_entr 0.04620788246393204
Test Epoch37 layer4 Acc 0.8351, AUC 0.9195380806922913, avg_entr 0.04659546539187431
gc 0
Train Epoch38 Acc 0.908125 (36325/40000), AUC 0.9672880172729492
Test Epoch38 layer0 Acc 0.8352, AUC 0.9111011624336243, avg_entr 0.11885073035955429
Test Epoch38 layer1 Acc 0.8413, AUC 0.9143942594528198, avg_entr 0.05467765033245087
Test Epoch38 layer2 Acc 0.8451, AUC 0.9200195074081421, avg_entr 0.04731904715299606
Test Epoch38 layer3 Acc 0.8465, AUC 0.9207537174224854, avg_entr 0.045450348407030106
Test Epoch38 layer4 Acc 0.8452, AUC 0.9205867052078247, avg_entr 0.0455559641122818
gc 0
Train Epoch39 Acc 0.91145 (36458/40000), AUC 0.968858003616333
Test Epoch39 layer0 Acc 0.8342, AUC 0.9121615886688232, avg_entr 0.11487644910812378
Test Epoch39 layer1 Acc 0.8412, AUC 0.9140267372131348, avg_entr 0.05039036273956299
Test Epoch39 layer2 Acc 0.8451, AUC 0.919431209564209, avg_entr 0.04181559011340141
Test Epoch39 layer3 Acc 0.847, AUC 0.9206730127334595, avg_entr 0.03992003947496414
Test Epoch39 layer4 Acc 0.8458, AUC 0.9205496311187744, avg_entr 0.03894342854619026
gc 0
Train Epoch40 Acc 0.913225 (36529/40000), AUC 0.9704151153564453
Test Epoch40 layer0 Acc 0.8322, AUC 0.911346435546875, avg_entr 0.11555375903844833
Test Epoch40 layer1 Acc 0.8351, AUC 0.9130759239196777, avg_entr 0.052528563886880875
Test Epoch40 layer2 Acc 0.8391, AUC 0.9189472794532776, avg_entr 0.04220325127243996
Test Epoch40 layer3 Acc 0.8386, AUC 0.9198160171508789, avg_entr 0.04003593698143959
Test Epoch40 layer4 Acc 0.8382, AUC 0.9196807146072388, avg_entr 0.03920625522732735
gc 0
Train Epoch41 Acc 0.913425 (36537/40000), AUC 0.970940887928009
Test Epoch41 layer0 Acc 0.8266, AUC 0.9105290174484253, avg_entr 0.11840124428272247
Test Epoch41 layer1 Acc 0.8282, AUC 0.9103422164916992, avg_entr 0.05235643312335014
Test Epoch41 layer2 Acc 0.8349, AUC 0.916930079460144, avg_entr 0.04091828688979149
Test Epoch41 layer3 Acc 0.8333, AUC 0.918045163154602, avg_entr 0.038281526416540146
Test Epoch41 layer4 Acc 0.8345, AUC 0.9179298877716064, avg_entr 0.0381314679980278
gc 0
Train Epoch42 Acc 0.914175 (36567/40000), AUC 0.9710817337036133
Test Epoch42 layer0 Acc 0.8313, AUC 0.9105314016342163, avg_entr 0.1162649542093277
Test Epoch42 layer1 Acc 0.8323, AUC 0.911369800567627, avg_entr 0.05274362117052078
Test Epoch42 layer2 Acc 0.8377, AUC 0.9176101684570312, avg_entr 0.04210136830806732
Test Epoch42 layer3 Acc 0.8363, AUC 0.9185232520103455, avg_entr 0.03914425149559975
Test Epoch42 layer4 Acc 0.8362, AUC 0.9185019731521606, avg_entr 0.0389915332198143
gc 0
Train Epoch43 Acc 0.91555 (36622/40000), AUC 0.9719290733337402
Test Epoch43 layer0 Acc 0.8316, AUC 0.9104717373847961, avg_entr 0.11562548577785492
Test Epoch43 layer1 Acc 0.8364, AUC 0.9116604328155518, avg_entr 0.051432978361845016
Test Epoch43 layer2 Acc 0.8418, AUC 0.9176263809204102, avg_entr 0.04203246906399727
Test Epoch43 layer3 Acc 0.8413, AUC 0.918626606464386, avg_entr 0.04030261188745499
Test Epoch43 layer4 Acc 0.8412, AUC 0.9185277223587036, avg_entr 0.039446838200092316
gc 0
Train Epoch44 Acc 0.918025 (36721/40000), AUC 0.9724891185760498
Test Epoch44 layer0 Acc 0.8303, AUC 0.9105134010314941, avg_entr 0.11478862166404724
Test Epoch44 layer1 Acc 0.8333, AUC 0.9106022119522095, avg_entr 0.05100731551647186
Test Epoch44 layer2 Acc 0.8371, AUC 0.9166581034660339, avg_entr 0.04076181724667549
Test Epoch44 layer3 Acc 0.8357, AUC 0.9179149866104126, avg_entr 0.03830594941973686
Test Epoch44 layer4 Acc 0.8347, AUC 0.9178937673568726, avg_entr 0.03776567801833153
gc 0
Train Epoch45 Acc 0.9175 (36700/40000), AUC 0.9727996587753296
Test Epoch45 layer0 Acc 0.8305, AUC 0.9101330041885376, avg_entr 0.11465521156787872
Test Epoch45 layer1 Acc 0.8342, AUC 0.9099815487861633, avg_entr 0.05061599984765053
Test Epoch45 layer2 Acc 0.8391, AUC 0.9165141582489014, avg_entr 0.04235611483454704
Test Epoch45 layer3 Acc 0.8382, AUC 0.9176362752914429, avg_entr 0.04085557162761688
Test Epoch45 layer4 Acc 0.8383, AUC 0.9176812171936035, avg_entr 0.04076163470745087
gc 0
Train Epoch46 Acc 0.9195 (36780/40000), AUC 0.9735078811645508
Test Epoch46 layer0 Acc 0.8304, AUC 0.9106169939041138, avg_entr 0.11191125214099884
Test Epoch46 layer1 Acc 0.8372, AUC 0.9111844301223755, avg_entr 0.04840723052620888
Test Epoch46 layer2 Acc 0.8418, AUC 0.9173270463943481, avg_entr 0.041042521595954895
Test Epoch46 layer3 Acc 0.8424, AUC 0.9184545874595642, avg_entr 0.039001017808914185
Test Epoch46 layer4 Acc 0.8427, AUC 0.9185284376144409, avg_entr 0.03852499648928642
gc 0
Train Epoch47 Acc 0.919975 (36799/40000), AUC 0.9736392498016357
Test Epoch47 layer0 Acc 0.8318, AUC 0.9103456735610962, avg_entr 0.11221590638160706
Test Epoch47 layer1 Acc 0.8368, AUC 0.9104771614074707, avg_entr 0.04885313659906387
Test Epoch47 layer2 Acc 0.8417, AUC 0.9167345762252808, avg_entr 0.04121990501880646
Test Epoch47 layer3 Acc 0.8421, AUC 0.917888879776001, avg_entr 0.037927787750959396
Test Epoch47 layer4 Acc 0.8411, AUC 0.9179306030273438, avg_entr 0.03757145255804062
gc 0
Train Epoch48 Acc 0.919725 (36789/40000), AUC 0.9737849831581116
Test Epoch48 layer0 Acc 0.833, AUC 0.9103572368621826, avg_entr 0.11107438802719116
Test Epoch48 layer1 Acc 0.8369, AUC 0.9105454087257385, avg_entr 0.0483824759721756
Test Epoch48 layer2 Acc 0.8426, AUC 0.9167563319206238, avg_entr 0.040026284754276276
Test Epoch48 layer3 Acc 0.842, AUC 0.9179507493972778, avg_entr 0.03689129650592804
Test Epoch48 layer4 Acc 0.842, AUC 0.9179918766021729, avg_entr 0.03644214943051338
gc 0
Train Epoch49 Acc 0.91895 (36758/40000), AUC 0.9740215539932251
Test Epoch49 layer0 Acc 0.8305, AUC 0.9101014137268066, avg_entr 0.11029500514268875
Test Epoch49 layer1 Acc 0.8352, AUC 0.9100139141082764, avg_entr 0.0479147769510746
Test Epoch49 layer2 Acc 0.8393, AUC 0.9163269996643066, avg_entr 0.03960232809185982
Test Epoch49 layer3 Acc 0.8388, AUC 0.9174892902374268, avg_entr 0.0373881496489048
Test Epoch49 layer4 Acc 0.8388, AUC 0.9175410866737366, avg_entr 0.036779291927814484
Best AUC 0.9239730834960938
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_transformeralside_l5_side200//imdb_transformeralside_l5_side.pt
[[4136  856]
 [ 826 4182]]
Figure(640x480)
tensor([4.7694e-03, 5.4011e-01, 1.6431e-02,  ..., 2.6286e-01, 2.3004e-01,
        2.3042e-04])
[[4093  899]
 [ 701 4307]]
Figure(640x480)
tensor([0.0008, 0.4026, 0.0159,  ..., 0.0040, 0.0960, 0.0009])
[[4099  893]
 [ 672 4336]]
Figure(640x480)
tensor([0.0014, 0.5297, 0.0018,  ..., 0.0032, 0.1071, 0.0008])
[[4084  908]
 [ 651 4357]]
Figure(640x480)
tensor([0.0016, 0.4872, 0.0037,  ..., 0.0037, 0.1187, 0.0010])
[[4069  923]
 [ 637 4371]]
Figure(640x480)
tensor([0.0021, 0.4777, 0.0041,  ..., 0.0032, 0.1297, 0.0011])
