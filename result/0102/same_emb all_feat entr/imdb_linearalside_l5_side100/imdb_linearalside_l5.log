total count words 222751
vocab size 30000
found 27937 words in glove
model: LinearALsideText(
  (layers): ModuleList(
    (0): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb): Embedding(30000, 300)
)
Start Training
gc 0
Train Epoch0 Acc 0.49145 (19658/40000), AUC 0.4910627007484436
Test Epoch0 layer0 Acc 0.5158, AUC 0.5121077299118042, avg_entr 0.726335346698761
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5218, AUC 0.5244534611701965, avg_entr 0.7251511216163635
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.5233, AUC 0.5238052606582642, avg_entr 0.726847231388092
Test Epoch0 layer3 Acc 0.5091, AUC 0.5120406150817871, avg_entr 0.726801872253418
Test Epoch0 layer4 Acc 0.4888, AUC 0.492745578289032, avg_entr 0.7256369590759277
gc 0
Train Epoch1 Acc 0.49465 (19786/40000), AUC 0.49554914236068726
Test Epoch1 layer0 Acc 0.5243, AUC 0.5302159786224365, avg_entr 0.7013350129127502
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.5247, AUC 0.5325757265090942, avg_entr 0.6984525918960571
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.534, AUC 0.5362415313720703, avg_entr 0.6998762488365173
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer3 Acc 0.5139, AUC 0.5204190015792847, avg_entr 0.6991798281669617
Test Epoch1 layer4 Acc 0.5077, AUC 0.5066319704055786, avg_entr 0.6981306672096252
gc 0
Train Epoch2 Acc 0.51095 (20438/40000), AUC 0.5132260918617249
Test Epoch2 layer0 Acc 0.5408, AUC 0.5536333322525024, avg_entr 0.6948674321174622
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.5406, AUC 0.548751950263977, avg_entr 0.6903672218322754
Test Epoch2 layer2 Acc 0.5366, AUC 0.549314022064209, avg_entr 0.6930632591247559
Test Epoch2 layer3 Acc 0.5216, AUC 0.5337690114974976, avg_entr 0.6934362053871155
Test Epoch2 layer4 Acc 0.52, AUC 0.5244758129119873, avg_entr 0.6900802850723267
gc 0
Train Epoch3 Acc 0.5217 (20868/40000), AUC 0.5333771109580994
Test Epoch3 layer0 Acc 0.5643, AUC 0.5757278800010681, avg_entr 0.6909515261650085
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.5546, AUC 0.5705177783966064, avg_entr 0.6920467615127563
Test Epoch3 layer2 Acc 0.5478, AUC 0.5647037625312805, avg_entr 0.6898560523986816
Test Epoch3 layer3 Acc 0.535, AUC 0.5519114136695862, avg_entr 0.689958393573761
Test Epoch3 layer4 Acc 0.5343, AUC 0.5411380529403687, avg_entr 0.6887776255607605
gc 0
Train Epoch4 Acc 0.53465 (21386/40000), AUC 0.5489110946655273
Test Epoch4 layer0 Acc 0.5259, AUC 0.5951288938522339, avg_entr 0.6837279200553894
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.5355, AUC 0.5910263657569885, avg_entr 0.6805204749107361
Test Epoch4 layer2 Acc 0.5309, AUC 0.5796282291412354, avg_entr 0.6804544925689697
Test Epoch4 layer3 Acc 0.5228, AUC 0.5709266662597656, avg_entr 0.6813344955444336
Test Epoch4 layer4 Acc 0.5206, AUC 0.5579315423965454, avg_entr 0.675618588924408
gc 0
Train Epoch5 Acc 0.54835 (21934/40000), AUC 0.5653993487358093
Test Epoch5 layer0 Acc 0.5182, AUC 0.6058832406997681, avg_entr 0.6586730480194092
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.5256, AUC 0.6026849746704102, avg_entr 0.6652857661247253
Test Epoch5 layer2 Acc 0.5332, AUC 0.5910189151763916, avg_entr 0.6632843017578125
Test Epoch5 layer3 Acc 0.5283, AUC 0.5879019498825073, avg_entr 0.6668035984039307
Test Epoch5 layer4 Acc 0.5267, AUC 0.5743976831436157, avg_entr 0.6651037335395813
gc 0
Train Epoch6 Acc 0.55985 (22394/40000), AUC 0.5821556448936462
Test Epoch6 layer0 Acc 0.5534, AUC 0.618502140045166, avg_entr 0.6750552654266357
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.5584, AUC 0.6161922216415405, avg_entr 0.6719831824302673
Test Epoch6 layer2 Acc 0.5463, AUC 0.6045705080032349, avg_entr 0.6656098365783691
Test Epoch6 layer3 Acc 0.5393, AUC 0.6033232808113098, avg_entr 0.673443078994751
Test Epoch6 layer4 Acc 0.5419, AUC 0.5919334888458252, avg_entr 0.6692116260528564
gc 0
Train Epoch7 Acc 0.56835 (22734/40000), AUC 0.5937498807907104
Test Epoch7 layer0 Acc 0.5811, AUC 0.6252230405807495, avg_entr 0.6645185351371765
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 7
Test Epoch7 layer1 Acc 0.5795, AUC 0.6233457326889038, avg_entr 0.6708723902702332
Test Epoch7 layer2 Acc 0.5737, AUC 0.6134583950042725, avg_entr 0.6643849611282349
Test Epoch7 layer3 Acc 0.5724, AUC 0.6136635541915894, avg_entr 0.671180248260498
Test Epoch7 layer4 Acc 0.5704, AUC 0.6055983304977417, avg_entr 0.6688859462738037
gc 0
Train Epoch8 Acc 0.5769 (23076/40000), AUC 0.610645055770874
Test Epoch8 layer0 Acc 0.5935, AUC 0.6325433254241943, avg_entr 0.6628356575965881
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 8
Test Epoch8 layer1 Acc 0.5877, AUC 0.6299906969070435, avg_entr 0.6644780039787292
Test Epoch8 layer2 Acc 0.5907, AUC 0.6220946907997131, avg_entr 0.6575802564620972
Test Epoch8 layer3 Acc 0.592, AUC 0.6227487921714783, avg_entr 0.6686529517173767
Test Epoch8 layer4 Acc 0.5862, AUC 0.6178403496742249, avg_entr 0.6665042042732239
gc 0
Train Epoch9 Acc 0.59055 (23622/40000), AUC 0.6230987310409546
Test Epoch9 layer0 Acc 0.5972, AUC 0.6377722024917603, avg_entr 0.6433989405632019
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 9
Test Epoch9 layer1 Acc 0.59, AUC 0.6351925134658813, avg_entr 0.6451108455657959
Test Epoch9 layer2 Acc 0.5866, AUC 0.6281032562255859, avg_entr 0.6400811672210693
Test Epoch9 layer3 Acc 0.5869, AUC 0.6291502714157104, avg_entr 0.6474350690841675
Test Epoch9 layer4 Acc 0.585, AUC 0.6266868114471436, avg_entr 0.6460159420967102
gc 0
Train Epoch10 Acc 0.59145 (23658/40000), AUC 0.6272304654121399
Test Epoch10 layer0 Acc 0.5923, AUC 0.6420332193374634, avg_entr 0.6078417301177979
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 10
Test Epoch10 layer1 Acc 0.5905, AUC 0.6394786834716797, avg_entr 0.6260309219360352
Test Epoch10 layer2 Acc 0.5875, AUC 0.6332541704177856, avg_entr 0.612588107585907
Test Epoch10 layer3 Acc 0.5899, AUC 0.634636640548706, avg_entr 0.6294980645179749
Test Epoch10 layer4 Acc 0.592, AUC 0.6334836483001709, avg_entr 0.6297098398208618
gc 0
Train Epoch11 Acc 0.5975 (23900/40000), AUC 0.63750159740448
Test Epoch11 layer0 Acc 0.6025, AUC 0.6463338136672974, avg_entr 0.6152069568634033
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 11
Test Epoch11 layer1 Acc 0.5998, AUC 0.6431118249893188, avg_entr 0.6193048357963562
Test Epoch11 layer2 Acc 0.5989, AUC 0.6379843950271606, avg_entr 0.6131821274757385
Test Epoch11 layer3 Acc 0.6012, AUC 0.6390938758850098, avg_entr 0.6249988675117493
Test Epoch11 layer4 Acc 0.6032, AUC 0.6393886804580688, avg_entr 0.626143753528595
gc 0
Train Epoch12 Acc 0.60345 (24138/40000), AUC 0.6450015306472778
Test Epoch12 layer0 Acc 0.6021, AUC 0.6496471762657166, avg_entr 0.5944743156433105
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 12
Test Epoch12 layer1 Acc 0.5986, AUC 0.646283745765686, avg_entr 0.5961175560951233
Test Epoch12 layer2 Acc 0.5936, AUC 0.6418750286102295, avg_entr 0.5898429751396179
Test Epoch12 layer3 Acc 0.5952, AUC 0.6429421901702881, avg_entr 0.6032560467720032
Test Epoch12 layer4 Acc 0.5987, AUC 0.6439216136932373, avg_entr 0.6040948629379272
gc 0
Train Epoch13 Acc 0.60555 (24222/40000), AUC 0.6498355865478516
Test Epoch13 layer0 Acc 0.6057, AUC 0.6516886353492737, avg_entr 0.5647082924842834
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 13
Test Epoch13 layer1 Acc 0.6004, AUC 0.6481621861457825, avg_entr 0.5745699405670166
Test Epoch13 layer2 Acc 0.6057, AUC 0.6442348957061768, avg_entr 0.5711812376976013
Test Epoch13 layer3 Acc 0.6059, AUC 0.6451699137687683, avg_entr 0.5846306681632996
Test Epoch13 layer4 Acc 0.6031, AUC 0.6465446949005127, avg_entr 0.5810889601707458
gc 0
Train Epoch14 Acc 0.610825 (24433/40000), AUC 0.6538973450660706
Test Epoch14 layer0 Acc 0.6092, AUC 0.6536914706230164, avg_entr 0.5518329739570618
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 14
Test Epoch14 layer1 Acc 0.6025, AUC 0.6499197483062744, avg_entr 0.5551944375038147
Test Epoch14 layer2 Acc 0.6062, AUC 0.646574079990387, avg_entr 0.55491042137146
Test Epoch14 layer3 Acc 0.6086, AUC 0.6471538543701172, avg_entr 0.5644689202308655
Test Epoch14 layer4 Acc 0.6112, AUC 0.6489976644515991, avg_entr 0.5646176338195801
gc 0
Train Epoch15 Acc 0.610075 (24403/40000), AUC 0.654190719127655
Test Epoch15 layer0 Acc 0.6003, AUC 0.6554206609725952, avg_entr 0.5301701426506042
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 15
Test Epoch15 layer1 Acc 0.6029, AUC 0.6515743732452393, avg_entr 0.5381882786750793
Test Epoch15 layer2 Acc 0.6003, AUC 0.6489901542663574, avg_entr 0.5387863516807556
Test Epoch15 layer3 Acc 0.5988, AUC 0.6489609479904175, avg_entr 0.5439635515213013
Test Epoch15 layer4 Acc 0.5966, AUC 0.6511310338973999, avg_entr 0.5439223647117615
gc 0
Train Epoch16 Acc 0.6093 (24372/40000), AUC 0.654485821723938
Test Epoch16 layer0 Acc 0.606, AUC 0.6559205055236816, avg_entr 0.4963368773460388
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 16
Test Epoch16 layer1 Acc 0.6027, AUC 0.6519639492034912, avg_entr 0.5068424344062805
Test Epoch16 layer2 Acc 0.6031, AUC 0.6499183177947998, avg_entr 0.5064522624015808
Test Epoch16 layer3 Acc 0.6025, AUC 0.6496665477752686, avg_entr 0.5175080299377441
Test Epoch16 layer4 Acc 0.6038, AUC 0.6516997814178467, avg_entr 0.5173308849334717
gc 0
Train Epoch17 Acc 0.61625 (24650/40000), AUC 0.6616560816764832
Test Epoch17 layer0 Acc 0.6036, AUC 0.6573444604873657, avg_entr 0.5002915263175964
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 17
Test Epoch17 layer1 Acc 0.6023, AUC 0.6534951329231262, avg_entr 0.5075761675834656
Test Epoch17 layer2 Acc 0.5989, AUC 0.6520859599113464, avg_entr 0.5042943954467773
Test Epoch17 layer3 Acc 0.5992, AUC 0.6510164141654968, avg_entr 0.5123418569564819
Test Epoch17 layer4 Acc 0.5988, AUC 0.6533771753311157, avg_entr 0.5143157839775085
gc 0
Train Epoch18 Acc 0.616125 (24645/40000), AUC 0.6619775891304016
Test Epoch18 layer0 Acc 0.6144, AUC 0.6578750014305115, avg_entr 0.48222193121910095
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 18
Test Epoch18 layer1 Acc 0.6062, AUC 0.6538882255554199, avg_entr 0.4942372441291809
Test Epoch18 layer2 Acc 0.6088, AUC 0.6528739929199219, avg_entr 0.4892421364784241
Test Epoch18 layer3 Acc 0.6081, AUC 0.6516595482826233, avg_entr 0.49417176842689514
Test Epoch18 layer4 Acc 0.6096, AUC 0.6539199352264404, avg_entr 0.49386122822761536
gc 0
Train Epoch19 Acc 0.614325 (24573/40000), AUC 0.6616389155387878
Test Epoch19 layer0 Acc 0.5923, AUC 0.6582317352294922, avg_entr 0.4120475649833679
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 19
Test Epoch19 layer1 Acc 0.5875, AUC 0.654197096824646, avg_entr 0.4266872704029083
Test Epoch19 layer2 Acc 0.5931, AUC 0.6536128520965576, avg_entr 0.42650049924850464
Test Epoch19 layer3 Acc 0.5863, AUC 0.6522181034088135, avg_entr 0.43003204464912415
Test Epoch19 layer4 Acc 0.5844, AUC 0.6544373035430908, avg_entr 0.41964682936668396
gc 0
Train Epoch20 Acc 0.618675 (24747/40000), AUC 0.6651116609573364
Test Epoch20 layer0 Acc 0.6139, AUC 0.65912926197052, avg_entr 0.46792393922805786
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 20
Test Epoch20 layer1 Acc 0.6072, AUC 0.6552547216415405, avg_entr 0.47834041714668274
Test Epoch20 layer2 Acc 0.6119, AUC 0.6550765037536621, avg_entr 0.47405195236206055
Test Epoch20 layer3 Acc 0.6101, AUC 0.6530038118362427, avg_entr 0.4782007336616516
Test Epoch20 layer4 Acc 0.6161, AUC 0.6555221676826477, avg_entr 0.4791497588157654
gc 0
Train Epoch21 Acc 0.62045 (24818/40000), AUC 0.6685965657234192
Test Epoch21 layer0 Acc 0.6111, AUC 0.6597357988357544, avg_entr 0.4596606492996216
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 21
Test Epoch21 layer1 Acc 0.6098, AUC 0.6559783220291138, avg_entr 0.4696570336818695
Test Epoch21 layer2 Acc 0.6159, AUC 0.6560837030410767, avg_entr 0.46650776267051697
Test Epoch21 layer3 Acc 0.6107, AUC 0.6537749767303467, avg_entr 0.4720326066017151
Test Epoch21 layer4 Acc 0.6108, AUC 0.6563215255737305, avg_entr 0.47196805477142334
gc 0
Train Epoch22 Acc 0.618475 (24739/40000), AUC 0.6678888201713562
Test Epoch22 layer0 Acc 0.6133, AUC 0.6599314212799072, avg_entr 0.4366726577281952
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 22
Test Epoch22 layer1 Acc 0.6104, AUC 0.6562416553497314, avg_entr 0.44829365611076355
Test Epoch22 layer2 Acc 0.6116, AUC 0.6565773487091064, avg_entr 0.4437445402145386
Test Epoch22 layer3 Acc 0.6091, AUC 0.6541894674301147, avg_entr 0.4478813111782074
Test Epoch22 layer4 Acc 0.6129, AUC 0.6566099524497986, avg_entr 0.44484761357307434
gc 0
Train Epoch23 Acc 0.6215 (24860/40000), AUC 0.6690670251846313
Test Epoch23 layer0 Acc 0.6, AUC 0.6601173877716064, avg_entr 0.38715437054634094
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 23
Test Epoch23 layer1 Acc 0.5967, AUC 0.6564429998397827, avg_entr 0.4019751250743866
Test Epoch23 layer2 Acc 0.6037, AUC 0.6571140885353088, avg_entr 0.4015413224697113
Test Epoch23 layer3 Acc 0.5997, AUC 0.6546626091003418, avg_entr 0.4090019762516022
Test Epoch23 layer4 Acc 0.6036, AUC 0.656947135925293, avg_entr 0.4023396372795105
gc 0
Train Epoch24 Acc 0.621625 (24865/40000), AUC 0.6700090169906616
Test Epoch24 layer0 Acc 0.6149, AUC 0.66060471534729, avg_entr 0.4211699366569519
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 24
Test Epoch24 layer1 Acc 0.6107, AUC 0.6570645570755005, avg_entr 0.43056946992874146
Test Epoch24 layer2 Acc 0.6109, AUC 0.6580058336257935, avg_entr 0.42838382720947266
Test Epoch24 layer3 Acc 0.6122, AUC 0.6552876234054565, avg_entr 0.4330669343471527
Test Epoch24 layer4 Acc 0.6163, AUC 0.6575695872306824, avg_entr 0.4329686462879181
gc 0
Train Epoch25 Acc 0.621325 (24853/40000), AUC 0.6687613725662231
Test Epoch25 layer0 Acc 0.6108, AUC 0.6609525680541992, avg_entr 0.42488497495651245
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 25
Test Epoch25 layer1 Acc 0.6087, AUC 0.6576305031776428, avg_entr 0.4340159595012665
Test Epoch25 layer2 Acc 0.617, AUC 0.6587038040161133, avg_entr 0.4298485815525055
Test Epoch25 layer3 Acc 0.6121, AUC 0.6558040380477905, avg_entr 0.4342210590839386
Test Epoch25 layer4 Acc 0.6101, AUC 0.6580225229263306, avg_entr 0.4340870678424835
gc 0
Train Epoch26 Acc 0.62175 (24870/40000), AUC 0.6709558963775635
Test Epoch26 layer0 Acc 0.6109, AUC 0.6611249446868896, avg_entr 0.4138354957103729
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 26
Test Epoch26 layer1 Acc 0.6096, AUC 0.6579467058181763, avg_entr 0.4242493510246277
Test Epoch26 layer2 Acc 0.6149, AUC 0.6591447591781616, avg_entr 0.42007988691329956
Test Epoch26 layer3 Acc 0.6115, AUC 0.6561969518661499, avg_entr 0.42409205436706543
Test Epoch26 layer4 Acc 0.6066, AUC 0.6583104729652405, avg_entr 0.42176172137260437
gc 0
Train Epoch27 Acc 0.6221 (24884/40000), AUC 0.6703318357467651
Test Epoch27 layer0 Acc 0.6152, AUC 0.6612352132797241, avg_entr 0.4093828499317169
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 27
Test Epoch27 layer1 Acc 0.6121, AUC 0.6581759452819824, avg_entr 0.41797083616256714
Test Epoch27 layer2 Acc 0.6173, AUC 0.6595349311828613, avg_entr 0.4135831594467163
Test Epoch27 layer3 Acc 0.614, AUC 0.656552791595459, avg_entr 0.41704535484313965
Test Epoch27 layer4 Acc 0.6135, AUC 0.6585849523544312, avg_entr 0.41821572184562683
gc 0
Train Epoch28 Acc 0.623425 (24937/40000), AUC 0.6719640493392944
Test Epoch28 layer0 Acc 0.6156, AUC 0.6614328622817993, avg_entr 0.4022537171840668
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 28
Test Epoch28 layer1 Acc 0.6137, AUC 0.6585177183151245, avg_entr 0.4108158349990845
Test Epoch28 layer2 Acc 0.6182, AUC 0.6599529981613159, avg_entr 0.40577542781829834
Test Epoch28 layer3 Acc 0.6142, AUC 0.6570162773132324, avg_entr 0.40931782126426697
Test Epoch28 layer4 Acc 0.6134, AUC 0.6588957905769348, avg_entr 0.41030511260032654
gc 0
Train Epoch29 Acc 0.625475 (25019/40000), AUC 0.6736323833465576
Test Epoch29 layer0 Acc 0.6154, AUC 0.6615920662879944, avg_entr 0.3914530873298645
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 29
Test Epoch29 layer1 Acc 0.6119, AUC 0.6587216854095459, avg_entr 0.3997792899608612
Test Epoch29 layer2 Acc 0.6151, AUC 0.6603323221206665, avg_entr 0.39628180861473083
Test Epoch29 layer3 Acc 0.6141, AUC 0.6574245691299438, avg_entr 0.39993494749069214
Test Epoch29 layer4 Acc 0.618, AUC 0.6591070890426636, avg_entr 0.39928489923477173
gc 0
Train Epoch30 Acc 0.62415 (24966/40000), AUC 0.6725695133209229
Test Epoch30 layer0 Acc 0.6093, AUC 0.661807119846344, avg_entr 0.3837064802646637
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 30
Test Epoch30 layer1 Acc 0.6079, AUC 0.659127414226532, avg_entr 0.39041611552238464
Test Epoch30 layer2 Acc 0.6071, AUC 0.6606956720352173, avg_entr 0.3857043385505676
Test Epoch30 layer3 Acc 0.6077, AUC 0.6578173637390137, avg_entr 0.39039891958236694
Test Epoch30 layer4 Acc 0.6043, AUC 0.6594188213348389, avg_entr 0.3906497359275818
gc 0
Train Epoch31 Acc 0.620775 (24831/40000), AUC 0.6693645715713501
Test Epoch31 layer0 Acc 0.6156, AUC 0.6617559194564819, avg_entr 0.3872997462749481
Test Epoch31 layer1 Acc 0.6141, AUC 0.6590828895568848, avg_entr 0.39418166875839233
Test Epoch31 layer2 Acc 0.6176, AUC 0.660895586013794, avg_entr 0.38868772983551025
Test Epoch31 layer3 Acc 0.6147, AUC 0.6580747961997986, avg_entr 0.39177829027175903
Test Epoch31 layer4 Acc 0.6165, AUC 0.659462034702301, avg_entr 0.39390480518341064
gc 0
Train Epoch32 Acc 0.6237 (24948/40000), AUC 0.6727815270423889
Test Epoch32 layer0 Acc 0.5948, AUC 0.661971390247345, avg_entr 0.3536149263381958
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 32
Test Epoch32 layer1 Acc 0.6003, AUC 0.6594182252883911, avg_entr 0.3635326325893402
Test Epoch32 layer2 Acc 0.6021, AUC 0.6612493991851807, avg_entr 0.3612698018550873
Test Epoch32 layer3 Acc 0.5985, AUC 0.6584206223487854, avg_entr 0.3639205992221832
Test Epoch32 layer4 Acc 0.5918, AUC 0.6597884297370911, avg_entr 0.35731181502342224
gc 0
Train Epoch33 Acc 0.62385 (24954/40000), AUC 0.6730059385299683
Test Epoch33 layer0 Acc 0.6108, AUC 0.6619041562080383, avg_entr 0.37602078914642334
Test Epoch33 layer1 Acc 0.6112, AUC 0.6593987941741943, avg_entr 0.38164642453193665
Test Epoch33 layer2 Acc 0.6156, AUC 0.6612908840179443, avg_entr 0.375306099653244
Test Epoch33 layer3 Acc 0.6124, AUC 0.6586414575576782, avg_entr 0.3779344856739044
Test Epoch33 layer4 Acc 0.6102, AUC 0.6597297191619873, avg_entr 0.38169169425964355
gc 0
Train Epoch34 Acc 0.62345 (24938/40000), AUC 0.6744256019592285
Test Epoch34 layer0 Acc 0.6138, AUC 0.6619074940681458, avg_entr 0.3684723675251007
Test Epoch34 layer1 Acc 0.6135, AUC 0.6594830751419067, avg_entr 0.3744499683380127
Test Epoch34 layer2 Acc 0.6179, AUC 0.6613937616348267, avg_entr 0.36800602078437805
Test Epoch34 layer3 Acc 0.6146, AUC 0.6588504314422607, avg_entr 0.37103158235549927
Test Epoch34 layer4 Acc 0.6136, AUC 0.6597888469696045, avg_entr 0.37367764115333557
gc 0
Train Epoch35 Acc 0.624775 (24991/40000), AUC 0.6749458909034729
Test Epoch35 layer0 Acc 0.6145, AUC 0.6619652509689331, avg_entr 0.3590323328971863
Test Epoch35 layer1 Acc 0.613, AUC 0.6596295833587646, avg_entr 0.3630903661251068
Test Epoch35 layer2 Acc 0.6169, AUC 0.6616241931915283, avg_entr 0.35813432931900024
Test Epoch35 layer3 Acc 0.6147, AUC 0.6590912938117981, avg_entr 0.35895872116088867
Test Epoch35 layer4 Acc 0.6174, AUC 0.6599481701850891, avg_entr 0.3616379499435425
gc 0
Train Epoch36 Acc 0.625575 (25023/40000), AUC 0.6745316386222839
Test Epoch36 layer0 Acc 0.6163, AUC 0.6620333194732666, avg_entr 0.35644179582595825
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 36
Test Epoch36 layer1 Acc 0.6128, AUC 0.6597920656204224, avg_entr 0.36183878779411316
Test Epoch36 layer2 Acc 0.6166, AUC 0.661790132522583, avg_entr 0.35595381259918213
Test Epoch36 layer3 Acc 0.6148, AUC 0.659367024898529, avg_entr 0.35918253660202026
Test Epoch36 layer4 Acc 0.6144, AUC 0.6601349115371704, avg_entr 0.3624346852302551
gc 0
Train Epoch37 Acc 0.623325 (24933/40000), AUC 0.6722546219825745
Test Epoch37 layer0 Acc 0.6111, AUC 0.6620774865150452, avg_entr 0.3532828390598297
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 37
Test Epoch37 layer1 Acc 0.609, AUC 0.6599688529968262, avg_entr 0.3516753315925598
Test Epoch37 layer2 Acc 0.6047, AUC 0.6620062589645386, avg_entr 0.3451588451862335
Test Epoch37 layer3 Acc 0.606, AUC 0.6596183776855469, avg_entr 0.34991827607154846
Test Epoch37 layer4 Acc 0.6032, AUC 0.6603240966796875, avg_entr 0.3512994647026062
gc 0
Train Epoch38 Acc 0.628625 (25145/40000), AUC 0.676456093788147
Test Epoch38 layer0 Acc 0.6162, AUC 0.6620213985443115, avg_entr 0.3448489010334015
Test Epoch38 layer1 Acc 0.6066, AUC 0.6600515246391296, avg_entr 0.3452005982398987
Test Epoch38 layer2 Acc 0.6052, AUC 0.6620771884918213, avg_entr 0.33846515417099
Test Epoch38 layer3 Acc 0.6037, AUC 0.6598223447799683, avg_entr 0.3408336639404297
Test Epoch38 layer4 Acc 0.5982, AUC 0.6604284048080444, avg_entr 0.33833566308021545
gc 0
Train Epoch39 Acc 0.62595 (25038/40000), AUC 0.6754392385482788
Test Epoch39 layer0 Acc 0.6094, AUC 0.662186861038208, avg_entr 0.340095192193985
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 39
Test Epoch39 layer1 Acc 0.6139, AUC 0.6602070331573486, avg_entr 0.3528960049152374
Test Epoch39 layer2 Acc 0.6169, AUC 0.6621535420417786, avg_entr 0.3472885191440582
Test Epoch39 layer3 Acc 0.6123, AUC 0.6600068807601929, avg_entr 0.3495844900608063
Test Epoch39 layer4 Acc 0.6105, AUC 0.6604365110397339, avg_entr 0.3531494736671448
gc 0
Train Epoch40 Acc 0.62515 (25006/40000), AUC 0.6753283739089966
Test Epoch40 layer0 Acc 0.6127, AUC 0.6621334552764893, avg_entr 0.3458958864212036
Test Epoch40 layer1 Acc 0.6137, AUC 0.660220742225647, avg_entr 0.3465096354484558
Test Epoch40 layer2 Acc 0.6174, AUC 0.6621817350387573, avg_entr 0.34304091334342957
Test Epoch40 layer3 Acc 0.6161, AUC 0.660137414932251, avg_entr 0.3446495234966278
Test Epoch40 layer4 Acc 0.6151, AUC 0.6605150699615479, avg_entr 0.3502083718776703
gc 0
Train Epoch41 Acc 0.623825 (24953/40000), AUC 0.6740704774856567
Test Epoch41 layer0 Acc 0.6132, AUC 0.6621952056884766, avg_entr 0.3412148058414459
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 41
Test Epoch41 layer1 Acc 0.614, AUC 0.6603420376777649, avg_entr 0.3472954034805298
Test Epoch41 layer2 Acc 0.6177, AUC 0.6623052358627319, avg_entr 0.34203851222991943
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 41
Test Epoch41 layer3 Acc 0.6184, AUC 0.6603022813796997, avg_entr 0.341986745595932
Test Epoch41 layer4 Acc 0.6177, AUC 0.660609245300293, avg_entr 0.3464011549949646
gc 0
Train Epoch42 Acc 0.626125 (25045/40000), AUC 0.6757745742797852
Test Epoch42 layer0 Acc 0.6101, AUC 0.6622374653816223, avg_entr 0.3323802053928375
Test Epoch42 layer1 Acc 0.6092, AUC 0.6604650020599365, avg_entr 0.3409353494644165
Test Epoch42 layer2 Acc 0.6119, AUC 0.662447452545166, avg_entr 0.3359878361225128
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 42
Test Epoch42 layer3 Acc 0.6114, AUC 0.6604926586151123, avg_entr 0.33854910731315613
Test Epoch42 layer4 Acc 0.6088, AUC 0.6607146263122559, avg_entr 0.3420417904853821
gc 0
Train Epoch43 Acc 0.627175 (25087/40000), AUC 0.6758618354797363
Test Epoch43 layer0 Acc 0.6127, AUC 0.6622087359428406, avg_entr 0.3349384665489197
Test Epoch43 layer1 Acc 0.6104, AUC 0.6604865789413452, avg_entr 0.3382606506347656
Test Epoch43 layer2 Acc 0.6148, AUC 0.662400484085083, avg_entr 0.33452439308166504
Test Epoch43 layer3 Acc 0.6121, AUC 0.6605758666992188, avg_entr 0.3364839255809784
Test Epoch43 layer4 Acc 0.6095, AUC 0.6607471704483032, avg_entr 0.3403749167919159
gc 0
Train Epoch44 Acc 0.626075 (25043/40000), AUC 0.6744649410247803
Test Epoch44 layer0 Acc 0.6165, AUC 0.6621263027191162, avg_entr 0.32788822054862976
Test Epoch44 layer1 Acc 0.6139, AUC 0.6605148315429688, avg_entr 0.33768531680107117
Test Epoch44 layer2 Acc 0.6169, AUC 0.6624374389648438, avg_entr 0.333499550819397
Test Epoch44 layer3 Acc 0.6169, AUC 0.6607198715209961, avg_entr 0.33472108840942383
Test Epoch44 layer4 Acc 0.617, AUC 0.6608272790908813, avg_entr 0.3384028375148773
gc 0
Train Epoch45 Acc 0.625825 (25033/40000), AUC 0.6744801998138428
Test Epoch45 layer0 Acc 0.6067, AUC 0.662259042263031, avg_entr 0.3215562403202057
Test Epoch45 layer1 Acc 0.6146, AUC 0.6606078743934631, avg_entr 0.3354279398918152
Test Epoch45 layer2 Acc 0.6165, AUC 0.6624546647071838, avg_entr 0.331574022769928
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 45
Test Epoch45 layer3 Acc 0.6158, AUC 0.6608299612998962, avg_entr 0.3322761356830597
Test Epoch45 layer4 Acc 0.6165, AUC 0.6608339548110962, avg_entr 0.33699285984039307
gc 0
Train Epoch46 Acc 0.627475 (25099/40000), AUC 0.6759809255599976
Test Epoch46 layer0 Acc 0.6153, AUC 0.6621768474578857, avg_entr 0.32744383811950684
Test Epoch46 layer1 Acc 0.6154, AUC 0.6606996059417725, avg_entr 0.3333158791065216
Test Epoch46 layer2 Acc 0.6159, AUC 0.6625510454177856, avg_entr 0.32945436239242554
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 46
Test Epoch46 layer3 Acc 0.6132, AUC 0.6609551310539246, avg_entr 0.3308919668197632
Test Epoch46 layer4 Acc 0.6129, AUC 0.6610064506530762, avg_entr 0.33504024147987366
gc 0
Train Epoch47 Acc 0.6254 (25016/40000), AUC 0.6758968830108643
Test Epoch47 layer0 Acc 0.6131, AUC 0.6622262597084045, avg_entr 0.32767602801322937
Test Epoch47 layer1 Acc 0.6143, AUC 0.6607280969619751, avg_entr 0.3306596577167511
Test Epoch47 layer2 Acc 0.6153, AUC 0.6625728607177734, avg_entr 0.32765790820121765
Save ckpt to ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt  ,ep 47
Test Epoch47 layer3 Acc 0.6133, AUC 0.661022424697876, avg_entr 0.32932451367378235
Test Epoch47 layer4 Acc 0.6153, AUC 0.6610190868377686, avg_entr 0.3333020806312561
gc 0
Train Epoch48 Acc 0.624825 (24993/40000), AUC 0.6747130155563354
Test Epoch48 layer0 Acc 0.6127, AUC 0.6622516512870789, avg_entr 0.3243306279182434
Test Epoch48 layer1 Acc 0.6122, AUC 0.6607449054718018, avg_entr 0.32061967253685
Test Epoch48 layer2 Acc 0.616, AUC 0.6625148057937622, avg_entr 0.3158547878265381
Test Epoch48 layer3 Acc 0.6147, AUC 0.6610716581344604, avg_entr 0.3137147128582001
Test Epoch48 layer4 Acc 0.6143, AUC 0.6609293222427368, avg_entr 0.31624871492385864
gc 0
Train Epoch49 Acc 0.626875 (25075/40000), AUC 0.6770468950271606
Test Epoch49 layer0 Acc 0.6155, AUC 0.6622142195701599, avg_entr 0.3226819932460785
Test Epoch49 layer1 Acc 0.6083, AUC 0.6607118248939514, avg_entr 0.29498106241226196
Test Epoch49 layer2 Acc 0.6126, AUC 0.6624793410301208, avg_entr 0.2959630489349365
Test Epoch49 layer3 Acc 0.6065, AUC 0.6610994338989258, avg_entr 0.29288941621780396
Test Epoch49 layer4 Acc 0.6063, AUC 0.6608545184135437, avg_entr 0.29358476400375366
Best AUC 0.6625728607177734
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_linearalside_l5_side100//imdb_linearalside_l5_side.pt
[[3013 2024]
 [1845 3118]]
Figure(640x480)
tensor([0.4930, 0.4114, 0.1809,  ..., 0.4531, 0.5779, 0.5894])
[[2917 2120]
 [1737 3226]]
Figure(640x480)
tensor([0.5098, 0.4713, 0.3196,  ..., 0.6944, 0.3592, 0.6979])
[[3013 2024]
 [1823 3140]]
Figure(640x480)
tensor([0.4781, 0.4027, 0.2361,  ..., 0.5478, 0.5489, 0.6807])
[[3081 1956]
 [1911 3052]]
Figure(640x480)
tensor([0.4092, 0.5726, 0.2004,  ..., 0.4534, 0.6800, 0.5213])
[[3093 1944]
 [1903 3060]]
Figure(640x480)
tensor([0.3676, 0.6960, 0.2308,  ..., 0.5373, 0.5335, 0.5585])
