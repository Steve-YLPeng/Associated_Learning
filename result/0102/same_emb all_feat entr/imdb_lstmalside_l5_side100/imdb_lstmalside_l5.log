total count words 222751
vocab size 30000
found 27937 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb): Embedding(30000, 300)
)
Start Training
gc 0
Train Epoch0 Acc 0.497925 (19917/40000), AUC 0.49416765570640564
Test Epoch0 layer0 Acc 0.5018, AUC 0.5094653964042664, avg_entr 0.6692209243774414
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5006, AUC 0.5040888786315918, avg_entr 0.6684207320213318
Test Epoch0 layer2 Acc 0.5066, AUC 0.5143405199050903, avg_entr 0.6757278442382812
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer3 Acc 0.5052, AUC 0.5040918588638306, avg_entr 0.6746324896812439
Test Epoch0 layer4 Acc 0.4968, AUC 0.4915868043899536, avg_entr 0.6783114075660706
gc 0
Train Epoch1 Acc 0.5059 (20236/40000), AUC 0.5008339881896973
Test Epoch1 layer0 Acc 0.5159, AUC 0.5358232855796814, avg_entr 0.6888660192489624
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.51, AUC 0.528244137763977, avg_entr 0.6883025169372559
Test Epoch1 layer2 Acc 0.5192, AUC 0.531230092048645, avg_entr 0.6944586634635925
Test Epoch1 layer3 Acc 0.5153, AUC 0.5228940844535828, avg_entr 0.6970090866088867
Test Epoch1 layer4 Acc 0.4989, AUC 0.5081238746643066, avg_entr 0.6937103271484375
gc 0
Train Epoch2 Acc 0.512575 (20503/40000), AUC 0.518729031085968
Test Epoch2 layer0 Acc 0.5414, AUC 0.5573610067367554, avg_entr 0.6897937059402466
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.5279, AUC 0.54141765832901, avg_entr 0.6906977295875549
Test Epoch2 layer2 Acc 0.5297, AUC 0.5412493944168091, avg_entr 0.6942006945610046
Test Epoch2 layer3 Acc 0.522, AUC 0.5313470959663391, avg_entr 0.6988959312438965
Test Epoch2 layer4 Acc 0.5029, AUC 0.5195268392562866, avg_entr 0.6954212188720703
gc 0
Train Epoch3 Acc 0.514775 (20591/40000), AUC 0.5318260192871094
Test Epoch3 layer0 Acc 0.5483, AUC 0.5703465938568115, avg_entr 0.6878790855407715
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.5279, AUC 0.548691987991333, avg_entr 0.6890458464622498
Test Epoch3 layer2 Acc 0.5228, AUC 0.5470929741859436, avg_entr 0.6909645795822144
Test Epoch3 layer3 Acc 0.5251, AUC 0.5382071733474731, avg_entr 0.6990888118743896
Test Epoch3 layer4 Acc 0.5146, AUC 0.5283507108688354, avg_entr 0.6954317092895508
gc 0
Train Epoch4 Acc 0.516725 (20669/40000), AUC 0.5390219688415527
Test Epoch4 layer0 Acc 0.5489, AUC 0.5822513699531555, avg_entr 0.6829614639282227
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.529, AUC 0.5532007813453674, avg_entr 0.6869597434997559
Test Epoch4 layer2 Acc 0.522, AUC 0.5518392324447632, avg_entr 0.6853867769241333
Test Epoch4 layer3 Acc 0.5264, AUC 0.5421230792999268, avg_entr 0.6974586844444275
Test Epoch4 layer4 Acc 0.5276, AUC 0.5343883633613586, avg_entr 0.6951608657836914
gc 0
Train Epoch5 Acc 0.523225 (20929/40000), AUC 0.5472714900970459
Test Epoch5 layer0 Acc 0.5635, AUC 0.6001764535903931, avg_entr 0.6720909476280212
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.5361, AUC 0.5580050945281982, avg_entr 0.6826273798942566
Test Epoch5 layer2 Acc 0.5405, AUC 0.5564697980880737, avg_entr 0.6891821026802063
Test Epoch5 layer3 Acc 0.5162, AUC 0.5477486252784729, avg_entr 0.690471351146698
Test Epoch5 layer4 Acc 0.5027, AUC 0.5410891771316528, avg_entr 0.6825327277183533
gc 0
Train Epoch6 Acc 0.527425 (21097/40000), AUC 0.553544819355011
Test Epoch6 layer0 Acc 0.6337, AUC 0.6791399717330933, avg_entr 0.6061673760414124
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.5278, AUC 0.5617890357971191, avg_entr 0.6781652569770813
Test Epoch6 layer2 Acc 0.5159, AUC 0.5603941679000854, avg_entr 0.669701099395752
Test Epoch6 layer3 Acc 0.5315, AUC 0.5510618686676025, avg_entr 0.6952980756759644
Test Epoch6 layer4 Acc 0.525, AUC 0.5448155403137207, avg_entr 0.688799262046814
gc 0
Train Epoch7 Acc 0.5251 (21004/40000), AUC 0.5597391128540039
Test Epoch7 layer0 Acc 0.6566, AUC 0.7248636484146118, avg_entr 0.5225143432617188
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer1 Acc 0.5414, AUC 0.5655834674835205, avg_entr 0.6744690537452698
Test Epoch7 layer2 Acc 0.5264, AUC 0.5630840063095093, avg_entr 0.6581012606620789
Test Epoch7 layer3 Acc 0.5396, AUC 0.553878128528595, avg_entr 0.6882063746452332
Test Epoch7 layer4 Acc 0.5308, AUC 0.5520460605621338, avg_entr 0.6831611394882202
gc 0
Train Epoch8 Acc 0.535025 (21401/40000), AUC 0.5698158144950867
Test Epoch8 layer0 Acc 0.683, AUC 0.7525169849395752, avg_entr 0.46825820207595825
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer1 Acc 0.5343, AUC 0.5733017921447754, avg_entr 0.6589338183403015
Test Epoch8 layer2 Acc 0.5254, AUC 0.5716477036476135, avg_entr 0.6362483501434326
Test Epoch8 layer3 Acc 0.5424, AUC 0.5602949857711792, avg_entr 0.6853943467140198
Test Epoch8 layer4 Acc 0.5419, AUC 0.5616270303726196, avg_entr 0.6738185882568359
gc 0
Train Epoch9 Acc 0.553525 (22141/40000), AUC 0.5985838770866394
Test Epoch9 layer0 Acc 0.6958, AUC 0.7695976495742798, avg_entr 0.4252989888191223
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer1 Acc 0.581, AUC 0.6174945831298828, avg_entr 0.627096951007843
Test Epoch9 layer2 Acc 0.5537, AUC 0.6065479516983032, avg_entr 0.6132993102073669
Test Epoch9 layer3 Acc 0.5407, AUC 0.5695449113845825, avg_entr 0.6640872359275818
Test Epoch9 layer4 Acc 0.584, AUC 0.6315082907676697, avg_entr 0.5971094369888306
gc 0
Train Epoch10 Acc 0.60665 (24266/40000), AUC 0.6569386720657349
Test Epoch10 layer0 Acc 0.7044, AUC 0.7852724194526672, avg_entr 0.40584349632263184
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer1 Acc 0.6236, AUC 0.664340615272522, avg_entr 0.5440971851348877
Test Epoch10 layer2 Acc 0.6381, AUC 0.6878281235694885, avg_entr 0.5206791758537292
Test Epoch10 layer3 Acc 0.5252, AUC 0.5886490345001221, avg_entr 0.6142044067382812
Test Epoch10 layer4 Acc 0.616, AUC 0.683323860168457, avg_entr 0.49394360184669495
gc 0
Train Epoch11 Acc 0.6511 (26044/40000), AUC 0.7132399082183838
Test Epoch11 layer0 Acc 0.721, AUC 0.7996388077735901, avg_entr 0.35694438219070435
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer1 Acc 0.6485, AUC 0.7027623653411865, avg_entr 0.46971890330314636
Test Epoch11 layer2 Acc 0.6643, AUC 0.7271595001220703, avg_entr 0.43741700053215027
Test Epoch11 layer3 Acc 0.5844, AUC 0.6603042483329773, avg_entr 0.5007311701774597
Test Epoch11 layer4 Acc 0.6632, AUC 0.727043628692627, avg_entr 0.43703946471214294
gc 0
Train Epoch12 Acc 0.666775 (26671/40000), AUC 0.740458071231842
Test Epoch12 layer0 Acc 0.7106, AUC 0.8109427094459534, avg_entr 0.3277205526828766
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 12
Test Epoch12 layer1 Acc 0.682, AUC 0.7471559047698975, avg_entr 0.37857356667518616
Test Epoch12 layer2 Acc 0.6756, AUC 0.757127583026886, avg_entr 0.37867000699043274
Test Epoch12 layer3 Acc 0.6507, AUC 0.7099902629852295, avg_entr 0.43420302867889404
Test Epoch12 layer4 Acc 0.6798, AUC 0.7469415664672852, avg_entr 0.40887564420700073
gc 0
Train Epoch13 Acc 0.688825 (27553/40000), AUC 0.7724446058273315
Test Epoch13 layer0 Acc 0.7411, AUC 0.8243216276168823, avg_entr 0.3030250370502472
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer1 Acc 0.6699, AUC 0.7428938150405884, avg_entr 0.3531361520290375
Test Epoch13 layer2 Acc 0.7032, AUC 0.777848482131958, avg_entr 0.3540422022342682
Test Epoch13 layer3 Acc 0.693, AUC 0.7567219734191895, avg_entr 0.35047420859336853
Test Epoch13 layer4 Acc 0.6913, AUC 0.7719605565071106, avg_entr 0.35374003648757935
gc 0
Train Epoch14 Acc 0.70345 (28138/40000), AUC 0.7878482341766357
Test Epoch14 layer0 Acc 0.746, AUC 0.8319742679595947, avg_entr 0.2811483144760132
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 14
Test Epoch14 layer1 Acc 0.6844, AUC 0.7565562725067139, avg_entr 0.3510073125362396
Test Epoch14 layer2 Acc 0.713, AUC 0.7894670963287354, avg_entr 0.31784024834632874
Test Epoch14 layer3 Acc 0.7025, AUC 0.7774185538291931, avg_entr 0.29485955834388733
Test Epoch14 layer4 Acc 0.7059, AUC 0.7856724858283997, avg_entr 0.3249960243701935
gc 0
Train Epoch15 Acc 0.71655 (28662/40000), AUC 0.8083696365356445
Test Epoch15 layer0 Acc 0.757, AUC 0.8413617610931396, avg_entr 0.27508923411369324
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 15
Test Epoch15 layer1 Acc 0.7067, AUC 0.7823389768600464, avg_entr 0.28739988803863525
Test Epoch15 layer2 Acc 0.7134, AUC 0.8004371523857117, avg_entr 0.28645384311676025
Test Epoch15 layer3 Acc 0.7218, AUC 0.7959156632423401, avg_entr 0.2933689057826996
Test Epoch15 layer4 Acc 0.6949, AUC 0.798747718334198, avg_entr 0.2669251561164856
gc 0
Train Epoch16 Acc 0.7254 (29016/40000), AUC 0.8174612522125244
Test Epoch16 layer0 Acc 0.7268, AUC 0.842366099357605, avg_entr 0.2820345163345337
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 16
Test Epoch16 layer1 Acc 0.726, AUC 0.8082995414733887, avg_entr 0.24925018846988678
Test Epoch16 layer2 Acc 0.7363, AUC 0.8152379989624023, avg_entr 0.26603779196739197
Test Epoch16 layer3 Acc 0.7354, AUC 0.808638334274292, avg_entr 0.27565672993659973
Test Epoch16 layer4 Acc 0.7317, AUC 0.8080139756202698, avg_entr 0.30202019214630127
gc 0
Train Epoch17 Acc 0.7346 (29384/40000), AUC 0.826249361038208
Test Epoch17 layer0 Acc 0.7653, AUC 0.8530300855636597, avg_entr 0.21848700940608978
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 17
Test Epoch17 layer1 Acc 0.7306, AUC 0.8086528778076172, avg_entr 0.22595204412937164
Test Epoch17 layer2 Acc 0.7439, AUC 0.8235747814178467, avg_entr 0.2278367429971695
Test Epoch17 layer3 Acc 0.7421, AUC 0.8177193999290466, avg_entr 0.22035346925258636
Test Epoch17 layer4 Acc 0.7334, AUC 0.8154557943344116, avg_entr 0.24560114741325378
gc 0
Train Epoch18 Acc 0.7417 (29668/40000), AUC 0.8349428176879883
Test Epoch18 layer0 Acc 0.7632, AUC 0.8575916886329651, avg_entr 0.21622106432914734
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 18
Test Epoch18 layer1 Acc 0.7626, AUC 0.8362886905670166, avg_entr 0.18830236792564392
Test Epoch18 layer2 Acc 0.7483, AUC 0.8306384086608887, avg_entr 0.24547497928142548
Test Epoch18 layer3 Acc 0.7307, AUC 0.8275176286697388, avg_entr 0.23706957697868347
Test Epoch18 layer4 Acc 0.7095, AUC 0.8222694396972656, avg_entr 0.2288728803396225
gc 0
Train Epoch19 Acc 0.749475 (29979/40000), AUC 0.8439006209373474
Test Epoch19 layer0 Acc 0.7711, AUC 0.8599884510040283, avg_entr 0.19774016737937927
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 19
Test Epoch19 layer1 Acc 0.7579, AUC 0.8381567001342773, avg_entr 0.15332169830799103
Test Epoch19 layer2 Acc 0.7475, AUC 0.8358502388000488, avg_entr 0.22372084856033325
Test Epoch19 layer3 Acc 0.7461, AUC 0.8350464105606079, avg_entr 0.23492157459259033
Test Epoch19 layer4 Acc 0.7501, AUC 0.827797532081604, avg_entr 0.2527153789997101
gc 0
Train Epoch20 Acc 0.7569 (30276/40000), AUC 0.8535852432250977
Test Epoch20 layer0 Acc 0.7622, AUC 0.8628772497177124, avg_entr 0.15935350954532623
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 20
Test Epoch20 layer1 Acc 0.7462, AUC 0.8386720418930054, avg_entr 0.10541655123233795
Test Epoch20 layer2 Acc 0.7529, AUC 0.8437346816062927, avg_entr 0.18903495371341705
Test Epoch20 layer3 Acc 0.7549, AUC 0.8417730331420898, avg_entr 0.20805412530899048
Test Epoch20 layer4 Acc 0.7319, AUC 0.8335235118865967, avg_entr 0.20575134456157684
gc 0
Train Epoch21 Acc 0.764625 (30585/40000), AUC 0.8613681793212891
Test Epoch21 layer0 Acc 0.7643, AUC 0.8648504018783569, avg_entr 0.16800139844417572
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 21
Test Epoch21 layer1 Acc 0.7648, AUC 0.8532634973526001, avg_entr 0.13831724226474762
Test Epoch21 layer2 Acc 0.7607, AUC 0.8521684408187866, avg_entr 0.19545131921768188
Test Epoch21 layer3 Acc 0.7458, AUC 0.84743332862854, avg_entr 0.18306651711463928
Test Epoch21 layer4 Acc 0.7518, AUC 0.8403376340866089, avg_entr 0.21248000860214233
gc 0
Train Epoch22 Acc 0.7755 (31020/40000), AUC 0.8706591129302979
Test Epoch22 layer0 Acc 0.7692, AUC 0.8694090843200684, avg_entr 0.18226215243339539
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 22
Test Epoch22 layer1 Acc 0.7636, AUC 0.856303334236145, avg_entr 0.13715972006320953
Test Epoch22 layer2 Acc 0.7759, AUC 0.8584082126617432, avg_entr 0.21088771522045135
Test Epoch22 layer3 Acc 0.7679, AUC 0.8491453528404236, avg_entr 0.21730585396289825
Test Epoch22 layer4 Acc 0.7588, AUC 0.8458635210990906, avg_entr 0.21780723333358765
gc 0
Train Epoch23 Acc 0.77875 (31150/40000), AUC 0.8746587038040161
Test Epoch23 layer0 Acc 0.7853, AUC 0.8723729252815247, avg_entr 0.16758063435554504
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 23
Test Epoch23 layer1 Acc 0.7766, AUC 0.8617045879364014, avg_entr 0.13404853641986847
Test Epoch23 layer2 Acc 0.7658, AUC 0.8607154488563538, avg_entr 0.18594223260879517
Test Epoch23 layer3 Acc 0.7396, AUC 0.8570501804351807, avg_entr 0.17658573389053345
Test Epoch23 layer4 Acc 0.7345, AUC 0.8514783382415771, avg_entr 0.18948790431022644
gc 0
Train Epoch24 Acc 0.78435 (31374/40000), AUC 0.8823334574699402
Test Epoch24 layer0 Acc 0.7802, AUC 0.8733593225479126, avg_entr 0.14724820852279663
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 24
Test Epoch24 layer1 Acc 0.778, AUC 0.8644324541091919, avg_entr 0.10762792080640793
Test Epoch24 layer2 Acc 0.7763, AUC 0.8642406463623047, avg_entr 0.14207281172275543
Test Epoch24 layer3 Acc 0.74, AUC 0.8601827621459961, avg_entr 0.1446702778339386
Test Epoch24 layer4 Acc 0.7498, AUC 0.8555562496185303, avg_entr 0.1646525263786316
gc 0
Train Epoch25 Acc 0.792825 (31713/40000), AUC 0.8887308835983276
Test Epoch25 layer0 Acc 0.7902, AUC 0.8760477304458618, avg_entr 0.15667827427387238
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 25
Test Epoch25 layer1 Acc 0.7833, AUC 0.8687962293624878, avg_entr 0.11015338450670242
Test Epoch25 layer2 Acc 0.7851, AUC 0.8650544881820679, avg_entr 0.13072462379932404
Test Epoch25 layer3 Acc 0.7815, AUC 0.8630419969558716, avg_entr 0.14254260063171387
Test Epoch25 layer4 Acc 0.7738, AUC 0.8603873252868652, avg_entr 0.155919149518013
gc 0
Train Epoch26 Acc 0.7958 (31832/40000), AUC 0.8920875787734985
Test Epoch26 layer0 Acc 0.7961, AUC 0.8786120414733887, avg_entr 0.14220872521400452
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 26
Test Epoch26 layer1 Acc 0.7938, AUC 0.8745365142822266, avg_entr 0.11052550375461578
Test Epoch26 layer2 Acc 0.7891, AUC 0.872315526008606, avg_entr 0.12749557197093964
Test Epoch26 layer3 Acc 0.77, AUC 0.8685259819030762, avg_entr 0.14700554311275482
Test Epoch26 layer4 Acc 0.7683, AUC 0.8641197681427002, avg_entr 0.15550903975963593
gc 0
Train Epoch27 Acc 0.803425 (32137/40000), AUC 0.8985217809677124
Test Epoch27 layer0 Acc 0.794, AUC 0.8778510689735413, avg_entr 0.15173541009426117
Test Epoch27 layer1 Acc 0.7954, AUC 0.8759530186653137, avg_entr 0.11783536523580551
Test Epoch27 layer2 Acc 0.7915, AUC 0.8737246990203857, avg_entr 0.12753280997276306
Test Epoch27 layer3 Acc 0.7494, AUC 0.8707382678985596, avg_entr 0.1353457272052765
Test Epoch27 layer4 Acc 0.7627, AUC 0.8672624826431274, avg_entr 0.14762158691883087
gc 0
Train Epoch28 Acc 0.80725 (32290/40000), AUC 0.9016875624656677
Test Epoch28 layer0 Acc 0.7656, AUC 0.8738632798194885, avg_entr 0.11205605417490005
Test Epoch28 layer1 Acc 0.7609, AUC 0.8675376176834106, avg_entr 0.07537353783845901
Test Epoch28 layer2 Acc 0.7831, AUC 0.8769669532775879, avg_entr 0.14727480709552765
Test Epoch28 layer3 Acc 0.745, AUC 0.873551607131958, avg_entr 0.13080617785453796
Test Epoch28 layer4 Acc 0.7575, AUC 0.8698949813842773, avg_entr 0.134280264377594
gc 0
Train Epoch29 Acc 0.812475 (32499/40000), AUC 0.9034484624862671
Test Epoch29 layer0 Acc 0.7849, AUC 0.8774632215499878, avg_entr 0.11667759716510773
Test Epoch29 layer1 Acc 0.7795, AUC 0.8739898204803467, avg_entr 0.08801927417516708
Test Epoch29 layer2 Acc 0.7954, AUC 0.8762900829315186, avg_entr 0.10633767396211624
Test Epoch29 layer3 Acc 0.7513, AUC 0.8746705651283264, avg_entr 0.12335162609815598
Test Epoch29 layer4 Acc 0.7808, AUC 0.8713861703872681, avg_entr 0.12066323310136795
gc 0
Train Epoch30 Acc 0.8181 (32724/40000), AUC 0.9095864295959473
Test Epoch30 layer0 Acc 0.7991, AUC 0.8796859979629517, avg_entr 0.12406713515520096
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 30
Test Epoch30 layer1 Acc 0.793, AUC 0.8792354464530945, avg_entr 0.0955645889043808
Test Epoch30 layer2 Acc 0.7894, AUC 0.8786107897758484, avg_entr 0.10543771088123322
Test Epoch30 layer3 Acc 0.7911, AUC 0.8739776015281677, avg_entr 0.13783176243305206
Test Epoch30 layer4 Acc 0.7864, AUC 0.8724042177200317, avg_entr 0.12761881947517395
gc 0
Train Epoch31 Acc 0.823125 (32925/40000), AUC 0.9130568504333496
Test Epoch31 layer0 Acc 0.7852, AUC 0.8779980540275574, avg_entr 0.10829579830169678
Test Epoch31 layer1 Acc 0.7778, AUC 0.8767164945602417, avg_entr 0.06813715398311615
Test Epoch31 layer2 Acc 0.7941, AUC 0.8815243244171143, avg_entr 0.11563368141651154
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 31
Test Epoch31 layer3 Acc 0.7911, AUC 0.8795101046562195, avg_entr 0.11916720867156982
Test Epoch31 layer4 Acc 0.7924, AUC 0.8759917616844177, avg_entr 0.11776839941740036
gc 0
Train Epoch32 Acc 0.8279 (33116/40000), AUC 0.9164827466011047
Test Epoch32 layer0 Acc 0.7983, AUC 0.8788681030273438, avg_entr 0.12285390496253967
Test Epoch32 layer1 Acc 0.7958, AUC 0.8798918724060059, avg_entr 0.08751291036605835
Test Epoch32 layer2 Acc 0.7814, AUC 0.8793556690216064, avg_entr 0.1081438809633255
Test Epoch32 layer3 Acc 0.7855, AUC 0.8814873099327087, avg_entr 0.11744969338178635
Test Epoch32 layer4 Acc 0.7233, AUC 0.8747221231460571, avg_entr 0.11614569276571274
gc 0
Train Epoch33 Acc 0.833075 (33323/40000), AUC 0.9207465052604675
Test Epoch33 layer0 Acc 0.7964, AUC 0.8785756826400757, avg_entr 0.10692919045686722
Test Epoch33 layer1 Acc 0.7925, AUC 0.8774523735046387, avg_entr 0.07241892069578171
Test Epoch33 layer2 Acc 0.7974, AUC 0.8829374313354492, avg_entr 0.08623585850000381
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 33
Test Epoch33 layer3 Acc 0.7856, AUC 0.8818270564079285, avg_entr 0.1002565324306488
Test Epoch33 layer4 Acc 0.7767, AUC 0.8797691464424133, avg_entr 0.10108426213264465
gc 0
Train Epoch34 Acc 0.841075 (33643/40000), AUC 0.9241279363632202
Test Epoch34 layer0 Acc 0.8027, AUC 0.8800686597824097, avg_entr 0.09597303718328476
Test Epoch34 layer1 Acc 0.8023, AUC 0.8799734115600586, avg_entr 0.05361732095479965
Test Epoch34 layer2 Acc 0.7852, AUC 0.880482017993927, avg_entr 0.05998619273304939
Test Epoch34 layer3 Acc 0.7868, AUC 0.8843230605125427, avg_entr 0.09064124524593353
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 34
Test Epoch34 layer4 Acc 0.7861, AUC 0.8816572427749634, avg_entr 0.09042814373970032
gc 0
Train Epoch35 Acc 0.8445 (33780/40000), AUC 0.9271019697189331
Test Epoch35 layer0 Acc 0.7941, AUC 0.8767542243003845, avg_entr 0.10246850550174713
Test Epoch35 layer1 Acc 0.7742, AUC 0.8745774030685425, avg_entr 0.06595032662153244
Test Epoch35 layer2 Acc 0.8043, AUC 0.8854626417160034, avg_entr 0.09232980012893677
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 35
Test Epoch35 layer3 Acc 0.8019, AUC 0.8835282325744629, avg_entr 0.11783844977617264
Test Epoch35 layer4 Acc 0.8003, AUC 0.8821331858634949, avg_entr 0.11511882394552231
gc 0
Train Epoch36 Acc 0.845425 (33817/40000), AUC 0.9262115359306335
Test Epoch36 layer0 Acc 0.8028, AUC 0.8762789964675903, avg_entr 0.08555004745721817
Test Epoch36 layer1 Acc 0.7995, AUC 0.8769136071205139, avg_entr 0.05604859068989754
Test Epoch36 layer2 Acc 0.8054, AUC 0.886561393737793, avg_entr 0.07980272173881531
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 36
Test Epoch36 layer3 Acc 0.7946, AUC 0.885921835899353, avg_entr 0.08676866441965103
Test Epoch36 layer4 Acc 0.8013, AUC 0.8842974901199341, avg_entr 0.0959487110376358
gc 0
Train Epoch37 Acc 0.85705 (34282/40000), AUC 0.9352517127990723
Test Epoch37 layer0 Acc 0.7974, AUC 0.8749407529830933, avg_entr 0.08640860766172409
Test Epoch37 layer1 Acc 0.7928, AUC 0.8732954263687134, avg_entr 0.056519072502851486
Test Epoch37 layer2 Acc 0.8048, AUC 0.8853902816772461, avg_entr 0.07876128703355789
Test Epoch37 layer3 Acc 0.7872, AUC 0.8866755962371826, avg_entr 0.08598246425390244
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 37
Test Epoch37 layer4 Acc 0.7917, AUC 0.885439932346344, avg_entr 0.09396757930517197
gc 0
Train Epoch38 Acc 0.8613 (34452/40000), AUC 0.938178300857544
Test Epoch38 layer0 Acc 0.7966, AUC 0.8761554956436157, avg_entr 0.08959376066923141
Test Epoch38 layer1 Acc 0.7911, AUC 0.8712680339813232, avg_entr 0.05555371195077896
Test Epoch38 layer2 Acc 0.8053, AUC 0.8850498795509338, avg_entr 0.06532685458660126
Test Epoch38 layer3 Acc 0.7943, AUC 0.8873782157897949, avg_entr 0.07756233215332031
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 38
Test Epoch38 layer4 Acc 0.7886, AUC 0.884329080581665, avg_entr 0.07857481390237808
gc 0
Train Epoch39 Acc 0.86705 (34682/40000), AUC 0.9403934478759766
Test Epoch39 layer0 Acc 0.8016, AUC 0.8754088282585144, avg_entr 0.07974004000425339
Test Epoch39 layer1 Acc 0.7929, AUC 0.8699791431427002, avg_entr 0.04540489614009857
Test Epoch39 layer2 Acc 0.8032, AUC 0.8839866518974304, avg_entr 0.060609154403209686
Test Epoch39 layer3 Acc 0.8034, AUC 0.8877623081207275, avg_entr 0.08092880994081497
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 39
Test Epoch39 layer4 Acc 0.8026, AUC 0.8827765583992004, avg_entr 0.09294555336236954
gc 0
Train Epoch40 Acc 0.872075 (34883/40000), AUC 0.9438067674636841
Test Epoch40 layer0 Acc 0.7981, AUC 0.8710401654243469, avg_entr 0.07592502236366272
Test Epoch40 layer1 Acc 0.7871, AUC 0.8676835298538208, avg_entr 0.04241504520177841
Test Epoch40 layer2 Acc 0.7974, AUC 0.882182240486145, avg_entr 0.06710086762905121
Test Epoch40 layer3 Acc 0.8064, AUC 0.8854738473892212, avg_entr 0.08192004263401031
Test Epoch40 layer4 Acc 0.7935, AUC 0.878689169883728, avg_entr 0.07708185911178589
gc 0
Train Epoch41 Acc 0.87335 (34934/40000), AUC 0.944402813911438
Test Epoch41 layer0 Acc 0.7976, AUC 0.8722697496414185, avg_entr 0.07719390839338303
Test Epoch41 layer1 Acc 0.7913, AUC 0.8660004734992981, avg_entr 0.040487512946128845
Test Epoch41 layer2 Acc 0.7994, AUC 0.8834488391876221, avg_entr 0.05152155086398125
Test Epoch41 layer3 Acc 0.7816, AUC 0.8886745572090149, avg_entr 0.07788669317960739
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 41
Test Epoch41 layer4 Acc 0.742, AUC 0.873945951461792, avg_entr 0.06963572651147842
gc 0
Train Epoch42 Acc 0.882 (35280/40000), AUC 0.9497181177139282
Test Epoch42 layer0 Acc 0.8007, AUC 0.8717565536499023, avg_entr 0.0740312933921814
Test Epoch42 layer1 Acc 0.7922, AUC 0.8667365908622742, avg_entr 0.04132845252752304
Test Epoch42 layer2 Acc 0.8041, AUC 0.8844922780990601, avg_entr 0.055189069360494614
Test Epoch42 layer3 Acc 0.7745, AUC 0.887190580368042, avg_entr 0.06683328747749329
Test Epoch42 layer4 Acc 0.8078, AUC 0.8861860036849976, avg_entr 0.07539117336273193
gc 0
Train Epoch43 Acc 0.88575 (35430/40000), AUC 0.9520924091339111
Test Epoch43 layer0 Acc 0.8015, AUC 0.8723812103271484, avg_entr 0.07030047476291656
Test Epoch43 layer1 Acc 0.7912, AUC 0.8628445267677307, avg_entr 0.032355695962905884
Test Epoch43 layer2 Acc 0.8071, AUC 0.8852009773254395, avg_entr 0.04863618686795235
Test Epoch43 layer3 Acc 0.7973, AUC 0.8907804489135742, avg_entr 0.0745180994272232
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 43
Test Epoch43 layer4 Acc 0.8057, AUC 0.885619044303894, avg_entr 0.06354301422834396
gc 0
Train Epoch44 Acc 0.89 (35600/40000), AUC 0.9531884789466858
Test Epoch44 layer0 Acc 0.798, AUC 0.8704092502593994, avg_entr 0.07401452958583832
Test Epoch44 layer1 Acc 0.7824, AUC 0.8636342287063599, avg_entr 0.038396161049604416
Test Epoch44 layer2 Acc 0.8083, AUC 0.883857011795044, avg_entr 0.05089055746793747
Test Epoch44 layer3 Acc 0.807, AUC 0.8880866765975952, avg_entr 0.06952445954084396
Test Epoch44 layer4 Acc 0.8055, AUC 0.886702299118042, avg_entr 0.06818770617246628
gc 0
Train Epoch45 Acc 0.887725 (35509/40000), AUC 0.9524639844894409
Test Epoch45 layer0 Acc 0.8042, AUC 0.8717309832572937, avg_entr 0.07003147900104523
Test Epoch45 layer1 Acc 0.7945, AUC 0.8651638031005859, avg_entr 0.031222717836499214
Test Epoch45 layer2 Acc 0.8089, AUC 0.8838452696800232, avg_entr 0.050557225942611694
Test Epoch45 layer3 Acc 0.8065, AUC 0.8892964124679565, avg_entr 0.0694400891661644
Test Epoch45 layer4 Acc 0.8079, AUC 0.8873171806335449, avg_entr 0.0694899931550026
gc 0
Train Epoch46 Acc 0.8923 (35692/40000), AUC 0.9552669525146484
Test Epoch46 layer0 Acc 0.8016, AUC 0.8701367974281311, avg_entr 0.06868166476488113
Test Epoch46 layer1 Acc 0.7908, AUC 0.8626761436462402, avg_entr 0.03227286785840988
Test Epoch46 layer2 Acc 0.8083, AUC 0.8829388618469238, avg_entr 0.048894766718149185
Test Epoch46 layer3 Acc 0.7489, AUC 0.8839480876922607, avg_entr 0.06528478860855103
Test Epoch46 layer4 Acc 0.7904, AUC 0.8833349943161011, avg_entr 0.05960315465927124
gc 0
Train Epoch47 Acc 0.893275 (35731/40000), AUC 0.9562264680862427
Test Epoch47 layer0 Acc 0.8041, AUC 0.871012270450592, avg_entr 0.06741943210363388
Test Epoch47 layer1 Acc 0.793, AUC 0.8624789118766785, avg_entr 0.029893917962908745
Test Epoch47 layer2 Acc 0.8047, AUC 0.8828545808792114, avg_entr 0.05155862867832184
Test Epoch47 layer3 Acc 0.7911, AUC 0.8889068365097046, avg_entr 0.06139926612377167
Test Epoch47 layer4 Acc 0.8085, AUC 0.885784387588501, avg_entr 0.05859045311808586
gc 0
Train Epoch48 Acc 0.89515 (35806/40000), AUC 0.9571261405944824
Test Epoch48 layer0 Acc 0.8033, AUC 0.8712140321731567, avg_entr 0.06851421296596527
Test Epoch48 layer1 Acc 0.7921, AUC 0.8619099855422974, avg_entr 0.03146376833319664
Test Epoch48 layer2 Acc 0.8092, AUC 0.8829725980758667, avg_entr 0.04957212135195732
Test Epoch48 layer3 Acc 0.8033, AUC 0.8882037401199341, avg_entr 0.0618123784661293
Test Epoch48 layer4 Acc 0.809, AUC 0.8854491114616394, avg_entr 0.06207536160945892
gc 0
Train Epoch49 Acc 0.896 (35840/40000), AUC 0.9583820104598999
Test Epoch49 layer0 Acc 0.8034, AUC 0.8715513944625854, avg_entr 0.06772316992282867
Test Epoch49 layer1 Acc 0.7932, AUC 0.8619107007980347, avg_entr 0.028369342908263206
Test Epoch49 layer2 Acc 0.809, AUC 0.882754921913147, avg_entr 0.0454854853451252
Test Epoch49 layer3 Acc 0.8102, AUC 0.8883258700370789, avg_entr 0.06362767517566681
Test Epoch49 layer4 Acc 0.8106, AUC 0.8836979269981384, avg_entr 0.06348162144422531
Best AUC 0.8907804489135742
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt
[[4229  759]
 [1226 3786]]
Figure(640x480)
tensor([1.2142e-04, 1.9147e-04, 1.5398e-04,  ..., 1.6375e-04, 1.8430e-03,
        5.9497e-01])
[[4119  869]
 [1219 3793]]
Figure(640x480)
tensor([0.0002, 0.0002, 0.0004,  ..., 0.0002, 0.0005, 0.0071])
[[4228  760]
 [1169 3843]]
Figure(640x480)
tensor([7.4611e-04, 3.3566e-04, 1.5298e-03,  ..., 3.7378e-05, 2.5552e-02,
        3.2310e-01])
[[4490  498]
 [1529 3483]]
Figure(640x480)
tensor([1.7360e-05, 1.3940e-03, 1.2811e-04,  ..., 6.8997e-06, 2.6442e-03,
        1.4129e-03])
[[4249  739]
 [1204 3808]]
Figure(640x480)
tensor([2.9178e-05, 2.4350e-04, 1.5734e-04,  ..., 3.9060e-05, 2.7704e-04,
        4.2734e-03])
