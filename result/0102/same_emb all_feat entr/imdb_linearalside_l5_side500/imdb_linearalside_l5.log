total count words 222751
vocab size 30000
found 27937 words in glove
model: LinearALsideText(
  (layers): ModuleList(
    (0): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb): Embedding(30000, 300)
)
Start Training
gc 0
Train Epoch0 Acc 0.49625 (19850/40000), AUC 0.49419456720352173
Test Epoch0 layer0 Acc 0.5145, AUC 0.5254268050193787, avg_entr 0.6886405944824219
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.4941, AUC 0.4945441484451294, avg_entr 0.6873197555541992
Test Epoch0 layer2 Acc 0.4955, AUC 0.4903632700443268, avg_entr 0.6874405741691589
Test Epoch0 layer3 Acc 0.477, AUC 0.4723798632621765, avg_entr 0.6891682744026184
Test Epoch0 layer4 Acc 0.5035, AUC 0.5053848028182983, avg_entr 0.6843978762626648
gc 0
Train Epoch1 Acc 0.5103 (20412/40000), AUC 0.5132759213447571
Test Epoch1 layer0 Acc 0.5282, AUC 0.542618989944458, avg_entr 0.689476490020752
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.5, AUC 0.5107249021530151, avg_entr 0.6893479824066162
Test Epoch1 layer2 Acc 0.4973, AUC 0.49310386180877686, avg_entr 0.6871671080589294
Test Epoch1 layer3 Acc 0.4905, AUC 0.48363447189331055, avg_entr 0.686295211315155
Test Epoch1 layer4 Acc 0.5214, AUC 0.5268318057060242, avg_entr 0.6878499984741211
gc 0
Train Epoch2 Acc 0.522925 (20917/40000), AUC 0.5312495231628418
Test Epoch2 layer0 Acc 0.5548, AUC 0.5731165409088135, avg_entr 0.6898618340492249
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.53, AUC 0.5352373123168945, avg_entr 0.6888490319252014
Test Epoch2 layer2 Acc 0.5078, AUC 0.5115518569946289, avg_entr 0.6842884421348572
Test Epoch2 layer3 Acc 0.5021, AUC 0.5004056692123413, avg_entr 0.6846970915794373
Test Epoch2 layer4 Acc 0.532, AUC 0.5452579259872437, avg_entr 0.6840376853942871
gc 0
Train Epoch3 Acc 0.53775 (21510/40000), AUC 0.5500247478485107
Test Epoch3 layer0 Acc 0.567, AUC 0.6010401248931885, avg_entr 0.6863695979118347
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.5307, AUC 0.5591585636138916, avg_entr 0.6852627992630005
Test Epoch3 layer2 Acc 0.5257, AUC 0.5327824354171753, avg_entr 0.6847441792488098
Test Epoch3 layer3 Acc 0.5057, AUC 0.5228333473205566, avg_entr 0.6814241409301758
Test Epoch3 layer4 Acc 0.552, AUC 0.5684640407562256, avg_entr 0.6804220080375671
gc 0
Train Epoch4 Acc 0.5507 (22028/40000), AUC 0.5711713433265686
Test Epoch4 layer0 Acc 0.5661, AUC 0.6233015060424805, avg_entr 0.6794829368591309
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.5516, AUC 0.5854846239089966, avg_entr 0.6864063739776611
Test Epoch4 layer2 Acc 0.5355, AUC 0.5601668357849121, avg_entr 0.6797685623168945
Test Epoch4 layer3 Acc 0.5367, AUC 0.5527279376983643, avg_entr 0.6797406077384949
Test Epoch4 layer4 Acc 0.5521, AUC 0.5909475088119507, avg_entr 0.6709488034248352
gc 0
Train Epoch5 Acc 0.566325 (22653/40000), AUC 0.5921264886856079
Test Epoch5 layer0 Acc 0.535, AUC 0.6393519639968872, avg_entr 0.6520978808403015
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.5233, AUC 0.6078623533248901, avg_entr 0.6639819145202637
Test Epoch5 layer2 Acc 0.523, AUC 0.5876734852790833, avg_entr 0.660971999168396
Test Epoch5 layer3 Acc 0.5272, AUC 0.5796775221824646, avg_entr 0.6595971584320068
Test Epoch5 layer4 Acc 0.5438, AUC 0.6111246347427368, avg_entr 0.6552398204803467
gc 0
Train Epoch6 Acc 0.579 (23160/40000), AUC 0.6066831350326538
Test Epoch6 layer0 Acc 0.5656, AUC 0.651653528213501, avg_entr 0.6491227746009827
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.5859, AUC 0.6264182329177856, avg_entr 0.6832085251808167
Test Epoch6 layer2 Acc 0.5735, AUC 0.6117385625839233, avg_entr 0.6712175011634827
Test Epoch6 layer3 Acc 0.5698, AUC 0.6045644283294678, avg_entr 0.6781289577484131
Test Epoch6 layer4 Acc 0.579, AUC 0.6296411156654358, avg_entr 0.6570630073547363
gc 0
Train Epoch7 Acc 0.592075 (23683/40000), AUC 0.62721848487854
Test Epoch7 layer0 Acc 0.6142, AUC 0.6605894565582275, avg_entr 0.6543206572532654
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 7
Test Epoch7 layer1 Acc 0.5964, AUC 0.6421562433242798, avg_entr 0.6735206246376038
Test Epoch7 layer2 Acc 0.5957, AUC 0.6327855587005615, avg_entr 0.6693283319473267
Test Epoch7 layer3 Acc 0.5913, AUC 0.6276547908782959, avg_entr 0.6694588661193848
Test Epoch7 layer4 Acc 0.6038, AUC 0.6453642845153809, avg_entr 0.6599006056785583
gc 0
Train Epoch8 Acc 0.6004 (24016/40000), AUC 0.6362801790237427
Test Epoch8 layer0 Acc 0.6168, AUC 0.666836678981781, avg_entr 0.6413043737411499
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 8
Test Epoch8 layer1 Acc 0.6068, AUC 0.6540535688400269, avg_entr 0.6638987064361572
Test Epoch8 layer2 Acc 0.6056, AUC 0.6483395099639893, avg_entr 0.6629295945167542
Test Epoch8 layer3 Acc 0.6015, AUC 0.6457949280738831, avg_entr 0.6630822420120239
Test Epoch8 layer4 Acc 0.6135, AUC 0.656540036201477, avg_entr 0.6468846797943115
gc 0
Train Epoch9 Acc 0.60265 (24106/40000), AUC 0.6439110040664673
Test Epoch9 layer0 Acc 0.5635, AUC 0.6710172891616821, avg_entr 0.5618398189544678
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 9
Test Epoch9 layer1 Acc 0.5267, AUC 0.6613905429840088, avg_entr 0.5718819499015808
Test Epoch9 layer2 Acc 0.5284, AUC 0.6581811904907227, avg_entr 0.567505955696106
Test Epoch9 layer3 Acc 0.5303, AUC 0.6574186086654663, avg_entr 0.570233166217804
Test Epoch9 layer4 Acc 0.5562, AUC 0.6638481616973877, avg_entr 0.5713415741920471
gc 0
Train Epoch10 Acc 0.614725 (24589/40000), AUC 0.6566662192344666
Test Epoch10 layer0 Acc 0.6214, AUC 0.6751987934112549, avg_entr 0.5881044864654541
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 10
Test Epoch10 layer1 Acc 0.6078, AUC 0.6676927804946899, avg_entr 0.6222608685493469
Test Epoch10 layer2 Acc 0.6126, AUC 0.6667696237564087, avg_entr 0.6241244673728943
Test Epoch10 layer3 Acc 0.6091, AUC 0.6672576665878296, avg_entr 0.6193015575408936
Test Epoch10 layer4 Acc 0.6185, AUC 0.670505940914154, avg_entr 0.6048173308372498
gc 0
Train Epoch11 Acc 0.615075 (24603/40000), AUC 0.6604169607162476
Test Epoch11 layer0 Acc 0.6136, AUC 0.6782938241958618, avg_entr 0.5668871998786926
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 11
Test Epoch11 layer1 Acc 0.6172, AUC 0.6716098189353943, avg_entr 0.6060274243354797
Test Epoch11 layer2 Acc 0.6233, AUC 0.6725709438323975, avg_entr 0.611423909664154
Test Epoch11 layer3 Acc 0.6204, AUC 0.6733696460723877, avg_entr 0.6062570810317993
Test Epoch11 layer4 Acc 0.617, AUC 0.6749202609062195, avg_entr 0.5839933156967163
gc 0
Train Epoch12 Acc 0.620275 (24811/40000), AUC 0.667883574962616
Test Epoch12 layer0 Acc 0.6209, AUC 0.6813591718673706, avg_entr 0.5352193117141724
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 12
Test Epoch12 layer1 Acc 0.6099, AUC 0.6757239103317261, avg_entr 0.5684460401535034
Test Epoch12 layer2 Acc 0.605, AUC 0.6770814657211304, avg_entr 0.5540285110473633
Test Epoch12 layer3 Acc 0.609, AUC 0.6782403588294983, avg_entr 0.5630387663841248
Test Epoch12 layer4 Acc 0.6115, AUC 0.678862452507019, avg_entr 0.5439271926879883
gc 0
Train Epoch13 Acc 0.624825 (24993/40000), AUC 0.6734482645988464
Test Epoch13 layer0 Acc 0.6028, AUC 0.6837817430496216, avg_entr 0.4774860739707947
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 13
Test Epoch13 layer1 Acc 0.5933, AUC 0.6791266798973083, avg_entr 0.5050889849662781
Test Epoch13 layer2 Acc 0.5995, AUC 0.6805074214935303, avg_entr 0.5129175186157227
Test Epoch13 layer3 Acc 0.5893, AUC 0.6816326379776001, avg_entr 0.4984126091003418
Test Epoch13 layer4 Acc 0.5928, AUC 0.6818660497665405, avg_entr 0.48599380254745483
gc 0
Train Epoch14 Acc 0.629375 (25175/40000), AUC 0.6764291524887085
Test Epoch14 layer0 Acc 0.6306, AUC 0.6857987642288208, avg_entr 0.5048083066940308
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 14
Test Epoch14 layer1 Acc 0.6296, AUC 0.6817506551742554, avg_entr 0.5362511277198792
Test Epoch14 layer2 Acc 0.6289, AUC 0.6830735206604004, avg_entr 0.5368413925170898
Test Epoch14 layer3 Acc 0.6263, AUC 0.6840231418609619, avg_entr 0.5281177163124084
Test Epoch14 layer4 Acc 0.6321, AUC 0.6841552257537842, avg_entr 0.5243521332740784
gc 0
Train Epoch15 Acc 0.628075 (25123/40000), AUC 0.6783443093299866
Test Epoch15 layer0 Acc 0.6057, AUC 0.6865388751029968, avg_entr 0.46548905968666077
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 15
Test Epoch15 layer1 Acc 0.6034, AUC 0.6825025081634521, avg_entr 0.4874500036239624
Test Epoch15 layer2 Acc 0.6042, AUC 0.6843433380126953, avg_entr 0.4866690933704376
Test Epoch15 layer3 Acc 0.6062, AUC 0.6850943565368652, avg_entr 0.487087219953537
Test Epoch15 layer4 Acc 0.6073, AUC 0.6847096681594849, avg_entr 0.4800787568092346
gc 0
Train Epoch16 Acc 0.6324 (25296/40000), AUC 0.6835243105888367
Test Epoch16 layer0 Acc 0.6241, AUC 0.6890057325363159, avg_entr 0.45301464200019836
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 16
Test Epoch16 layer1 Acc 0.6189, AUC 0.6856294870376587, avg_entr 0.48151031136512756
Test Epoch16 layer2 Acc 0.6171, AUC 0.6871556043624878, avg_entr 0.4700484275817871
Test Epoch16 layer3 Acc 0.6183, AUC 0.6876809597015381, avg_entr 0.47262367606163025
Test Epoch16 layer4 Acc 0.6203, AUC 0.6875723600387573, avg_entr 0.4686429798603058
gc 0
Train Epoch17 Acc 0.638275 (25531/40000), AUC 0.6881852746009827
Test Epoch17 layer0 Acc 0.6309, AUC 0.689957857131958, avg_entr 0.46673208475112915
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 17
Test Epoch17 layer1 Acc 0.6319, AUC 0.6866434216499329, avg_entr 0.4844008684158325
Test Epoch17 layer2 Acc 0.6326, AUC 0.6882967948913574, avg_entr 0.4818613827228546
Test Epoch17 layer3 Acc 0.6308, AUC 0.6886203289031982, avg_entr 0.4810657799243927
Test Epoch17 layer4 Acc 0.6334, AUC 0.6883254051208496, avg_entr 0.47819796204566956
gc 0
Train Epoch18 Acc 0.6353 (25412/40000), AUC 0.6879762411117554
Test Epoch18 layer0 Acc 0.6278, AUC 0.6911577582359314, avg_entr 0.4480960965156555
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 18
Test Epoch18 layer1 Acc 0.6337, AUC 0.6882021427154541, avg_entr 0.46631065011024475
Test Epoch18 layer2 Acc 0.6258, AUC 0.6896822452545166, avg_entr 0.45796269178390503
Test Epoch18 layer3 Acc 0.63, AUC 0.6898722052574158, avg_entr 0.4634261131286621
Test Epoch18 layer4 Acc 0.629, AUC 0.6895384788513184, avg_entr 0.4606403708457947
gc 0
Train Epoch19 Acc 0.639325 (25573/40000), AUC 0.6920689344406128
Test Epoch19 layer0 Acc 0.6353, AUC 0.6918654441833496, avg_entr 0.44163593649864197
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 19
Test Epoch19 layer1 Acc 0.6334, AUC 0.6889503598213196, avg_entr 0.4534299373626709
Test Epoch19 layer2 Acc 0.6341, AUC 0.6907691955566406, avg_entr 0.45397910475730896
Test Epoch19 layer3 Acc 0.6348, AUC 0.6905207633972168, avg_entr 0.4545576274394989
Test Epoch19 layer4 Acc 0.6353, AUC 0.6901624202728271, avg_entr 0.4509996175765991
gc 0
Train Epoch20 Acc 0.6362 (25448/40000), AUC 0.6898567080497742
Test Epoch20 layer0 Acc 0.6199, AUC 0.692853569984436, avg_entr 0.4139934182167053
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 20
Test Epoch20 layer1 Acc 0.6244, AUC 0.690147876739502, avg_entr 0.4284937083721161
Test Epoch20 layer2 Acc 0.6261, AUC 0.6917757987976074, avg_entr 0.43005669116973877
Test Epoch20 layer3 Acc 0.6203, AUC 0.6912261247634888, avg_entr 0.42358100414276123
Test Epoch20 layer4 Acc 0.6194, AUC 0.6910685300827026, avg_entr 0.4235932230949402
gc 0
Train Epoch21 Acc 0.64155 (25662/40000), AUC 0.694842517375946
Test Epoch21 layer0 Acc 0.6372, AUC 0.6937792301177979, avg_entr 0.4202320873737335
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 21
Test Epoch21 layer1 Acc 0.6372, AUC 0.6911839246749878, avg_entr 0.4323994517326355
Test Epoch21 layer2 Acc 0.6375, AUC 0.6928756237030029, avg_entr 0.431485652923584
Test Epoch21 layer3 Acc 0.6363, AUC 0.6922146081924438, avg_entr 0.43236562609672546
Test Epoch21 layer4 Acc 0.6371, AUC 0.6920850276947021, avg_entr 0.4308128356933594
gc 0
Train Epoch22 Acc 0.64155 (25662/40000), AUC 0.6951777935028076
Test Epoch22 layer0 Acc 0.6381, AUC 0.6945183873176575, avg_entr 0.41202226281166077
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 22
Test Epoch22 layer1 Acc 0.6412, AUC 0.6920463442802429, avg_entr 0.42311957478523254
Test Epoch22 layer2 Acc 0.6395, AUC 0.6937400102615356, avg_entr 0.419603556394577
Test Epoch22 layer3 Acc 0.6415, AUC 0.693003237247467, avg_entr 0.4236223101615906
Test Epoch22 layer4 Acc 0.642, AUC 0.692909836769104, avg_entr 0.42090511322021484
gc 0
Train Epoch23 Acc 0.64105 (25642/40000), AUC 0.695655882358551
Test Epoch23 layer0 Acc 0.6123, AUC 0.6946119070053101, avg_entr 0.3692554533481598
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 23
Test Epoch23 layer1 Acc 0.613, AUC 0.692049503326416, avg_entr 0.3799705505371094
Test Epoch23 layer2 Acc 0.6245, AUC 0.6939100027084351, avg_entr 0.38760271668434143
Test Epoch23 layer3 Acc 0.616, AUC 0.6929564476013184, avg_entr 0.38122281432151794
Test Epoch23 layer4 Acc 0.6182, AUC 0.692753255367279, avg_entr 0.38194307684898376
gc 0
Train Epoch24 Acc 0.640325 (25613/40000), AUC 0.6951402425765991
Test Epoch24 layer0 Acc 0.6401, AUC 0.6957600116729736, avg_entr 0.39004752039909363
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 24
Test Epoch24 layer1 Acc 0.6404, AUC 0.6935184001922607, avg_entr 0.4001402258872986
Test Epoch24 layer2 Acc 0.6428, AUC 0.695121169090271, avg_entr 0.39668941497802734
Test Epoch24 layer3 Acc 0.6368, AUC 0.6942396759986877, avg_entr 0.3990905284881592
Test Epoch24 layer4 Acc 0.6391, AUC 0.6940945386886597, avg_entr 0.39607885479927063
gc 0
Train Epoch25 Acc 0.643425 (25737/40000), AUC 0.6954473257064819
Test Epoch25 layer0 Acc 0.6401, AUC 0.696114182472229, avg_entr 0.389068603515625
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 25
Test Epoch25 layer1 Acc 0.6422, AUC 0.6939102411270142, avg_entr 0.39725950360298157
Test Epoch25 layer2 Acc 0.6427, AUC 0.6955347657203674, avg_entr 0.3922966718673706
Test Epoch25 layer3 Acc 0.6423, AUC 0.6945664882659912, avg_entr 0.3981618285179138
Test Epoch25 layer4 Acc 0.6409, AUC 0.6943686008453369, avg_entr 0.39697420597076416
gc 0
Train Epoch26 Acc 0.643625 (25745/40000), AUC 0.6987919211387634
Test Epoch26 layer0 Acc 0.6381, AUC 0.6960132122039795, avg_entr 0.3767412006855011
Test Epoch26 layer1 Acc 0.6356, AUC 0.6937572360038757, avg_entr 0.3848859369754791
Test Epoch26 layer2 Acc 0.637, AUC 0.6955378651618958, avg_entr 0.38152289390563965
Test Epoch26 layer3 Acc 0.6364, AUC 0.6945253014564514, avg_entr 0.38432326912879944
Test Epoch26 layer4 Acc 0.6349, AUC 0.694148063659668, avg_entr 0.38331836462020874
gc 0
Train Epoch27 Acc 0.644025 (25761/40000), AUC 0.6967909932136536
Test Epoch27 layer0 Acc 0.6211, AUC 0.6964424848556519, avg_entr 0.35228607058525085
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 27
Test Epoch27 layer1 Acc 0.617, AUC 0.6942046880722046, avg_entr 0.35517555475234985
Test Epoch27 layer2 Acc 0.6211, AUC 0.6958390474319458, avg_entr 0.3513142466545105
Test Epoch27 layer3 Acc 0.6226, AUC 0.6948370337486267, avg_entr 0.3588762581348419
Test Epoch27 layer4 Acc 0.621, AUC 0.6945294141769409, avg_entr 0.3579789400100708
gc 0
Train Epoch28 Acc 0.644925 (25797/40000), AUC 0.6987890005111694
Test Epoch28 layer0 Acc 0.6102, AUC 0.6964622735977173, avg_entr 0.3243831694126129
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 28
Test Epoch28 layer1 Acc 0.6117, AUC 0.6943219900131226, avg_entr 0.3341538906097412
Test Epoch28 layer2 Acc 0.6123, AUC 0.6960790753364563, avg_entr 0.3299783170223236
Test Epoch28 layer3 Acc 0.6084, AUC 0.6949254274368286, avg_entr 0.3277101516723633
Test Epoch28 layer4 Acc 0.6071, AUC 0.6944730281829834, avg_entr 0.3263278305530548
gc 0
Train Epoch29 Acc 0.647925 (25917/40000), AUC 0.7014071941375732
Test Epoch29 layer0 Acc 0.641, AUC 0.6975017786026001, avg_entr 0.3609381914138794
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 29
Test Epoch29 layer1 Acc 0.6443, AUC 0.6956723928451538, avg_entr 0.36667540669441223
Test Epoch29 layer2 Acc 0.6439, AUC 0.6972091197967529, avg_entr 0.36099696159362793
Test Epoch29 layer3 Acc 0.6422, AUC 0.6961591243743896, avg_entr 0.366201251745224
Test Epoch29 layer4 Acc 0.6435, AUC 0.6957947015762329, avg_entr 0.3648589849472046
gc 0
Train Epoch30 Acc 0.64705 (25882/40000), AUC 0.7010469436645508
Test Epoch30 layer0 Acc 0.6357, AUC 0.6979961395263672, avg_entr 0.3311411738395691
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 30
Test Epoch30 layer1 Acc 0.6349, AUC 0.6964004039764404, avg_entr 0.3368028998374939
Test Epoch30 layer2 Acc 0.6375, AUC 0.6977421641349792, avg_entr 0.3346245586872101
Test Epoch30 layer3 Acc 0.6335, AUC 0.696738600730896, avg_entr 0.33743560314178467
Test Epoch30 layer4 Acc 0.636, AUC 0.6964223384857178, avg_entr 0.3354929983615875
gc 0
Train Epoch31 Acc 0.64755 (25902/40000), AUC 0.7019015550613403
Test Epoch31 layer0 Acc 0.6412, AUC 0.6978751420974731, avg_entr 0.3480812609195709
Test Epoch31 layer1 Acc 0.6414, AUC 0.6961660981178284, avg_entr 0.3532019555568695
Test Epoch31 layer2 Acc 0.6426, AUC 0.6976542472839355, avg_entr 0.3474774956703186
Test Epoch31 layer3 Acc 0.6422, AUC 0.6965928077697754, avg_entr 0.35191473364830017
Test Epoch31 layer4 Acc 0.6414, AUC 0.6961742639541626, avg_entr 0.3515399098396301
gc 0
Train Epoch32 Acc 0.6478 (25912/40000), AUC 0.70282381772995
Test Epoch32 layer0 Acc 0.6379, AUC 0.697980523109436, avg_entr 0.3380224406719208
Test Epoch32 layer1 Acc 0.6407, AUC 0.6963378190994263, avg_entr 0.3441077172756195
Test Epoch32 layer2 Acc 0.6378, AUC 0.6978104114532471, avg_entr 0.33792027831077576
Test Epoch32 layer3 Acc 0.6408, AUC 0.6967623233795166, avg_entr 0.3420775830745697
Test Epoch32 layer4 Acc 0.638, AUC 0.696337103843689, avg_entr 0.3414226472377777
gc 0
Train Epoch33 Acc 0.64495 (25798/40000), AUC 0.7011151909828186
Test Epoch33 layer0 Acc 0.637, AUC 0.6981407403945923, avg_entr 0.33243462443351746
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 33
Test Epoch33 layer1 Acc 0.6353, AUC 0.6965557932853699, avg_entr 0.3367401361465454
Test Epoch33 layer2 Acc 0.6315, AUC 0.6979892253875732, avg_entr 0.3293827474117279
Test Epoch33 layer3 Acc 0.6341, AUC 0.6969530582427979, avg_entr 0.33351749181747437
Test Epoch33 layer4 Acc 0.6316, AUC 0.6965018510818481, avg_entr 0.3333938419818878
gc 0
Train Epoch34 Acc 0.646575 (25863/40000), AUC 0.7017279863357544
Test Epoch34 layer0 Acc 0.6372, AUC 0.6981310844421387, avg_entr 0.3288975954055786
Test Epoch34 layer1 Acc 0.6376, AUC 0.6965941190719604, avg_entr 0.3335407078266144
Test Epoch34 layer2 Acc 0.6366, AUC 0.6980195045471191, avg_entr 0.3280225694179535
Test Epoch34 layer3 Acc 0.6358, AUC 0.6970001459121704, avg_entr 0.32969900965690613
Test Epoch34 layer4 Acc 0.6381, AUC 0.6966269016265869, avg_entr 0.33252987265586853
gc 0
Train Epoch35 Acc 0.6471 (25884/40000), AUC 0.7019212245941162
Test Epoch35 layer0 Acc 0.6407, AUC 0.6987859010696411, avg_entr 0.3196074068546295
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 35
Test Epoch35 layer1 Acc 0.6413, AUC 0.6974794864654541, avg_entr 0.32111290097236633
Test Epoch35 layer2 Acc 0.6421, AUC 0.6987053155899048, avg_entr 0.31526651978492737
Test Epoch35 layer3 Acc 0.6408, AUC 0.6978094577789307, avg_entr 0.32236191630363464
Test Epoch35 layer4 Acc 0.6411, AUC 0.6975703239440918, avg_entr 0.32164427638053894
gc 0
Train Epoch36 Acc 0.646825 (25873/40000), AUC 0.7046787738800049
Test Epoch36 layer0 Acc 0.6394, AUC 0.6987264156341553, avg_entr 0.3198663294315338
Test Epoch36 layer1 Acc 0.6411, AUC 0.6974048018455505, avg_entr 0.3233720362186432
Test Epoch36 layer2 Acc 0.6408, AUC 0.6987103223800659, avg_entr 0.3187476694583893
Test Epoch36 layer3 Acc 0.6404, AUC 0.6977473497390747, avg_entr 0.32202088832855225
Test Epoch36 layer4 Acc 0.6408, AUC 0.697439432144165, avg_entr 0.3213174641132355
gc 0
Train Epoch37 Acc 0.6461 (25844/40000), AUC 0.7009847164154053
Test Epoch37 layer0 Acc 0.6428, AUC 0.6989749073982239, avg_entr 0.31973350048065186
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 37
Test Epoch37 layer1 Acc 0.6415, AUC 0.6976903080940247, avg_entr 0.32153353095054626
Test Epoch37 layer2 Acc 0.6421, AUC 0.6989607810974121, avg_entr 0.31638064980506897
Test Epoch37 layer3 Acc 0.6432, AUC 0.6980258226394653, avg_entr 0.3207186460494995
Test Epoch37 layer4 Acc 0.6414, AUC 0.6978132724761963, avg_entr 0.3201983869075775
gc 0
Train Epoch38 Acc 0.64915 (25966/40000), AUC 0.7042054533958435
Test Epoch38 layer0 Acc 0.6421, AUC 0.6991254091262817, avg_entr 0.31307974457740784
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 38
Test Epoch38 layer1 Acc 0.644, AUC 0.6979326009750366, avg_entr 0.31474751234054565
Test Epoch38 layer2 Acc 0.6467, AUC 0.6991366744041443, avg_entr 0.3102263808250427
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 38
Test Epoch38 layer3 Acc 0.6442, AUC 0.6982836723327637, avg_entr 0.3133247196674347
Test Epoch38 layer4 Acc 0.6418, AUC 0.6980429887771606, avg_entr 0.3131047785282135
gc 0
Train Epoch39 Acc 0.64805 (25922/40000), AUC 0.704552412033081
Test Epoch39 layer0 Acc 0.6425, AUC 0.6994553208351135, avg_entr 0.29649436473846436
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 39
Test Epoch39 layer1 Acc 0.6411, AUC 0.6983840465545654, avg_entr 0.29804515838623047
Test Epoch39 layer2 Acc 0.6432, AUC 0.6995536088943481, avg_entr 0.29620814323425293
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 39
Test Epoch39 layer3 Acc 0.6387, AUC 0.6986566781997681, avg_entr 0.2952463924884796
Test Epoch39 layer4 Acc 0.6419, AUC 0.6985388994216919, avg_entr 0.29719078540802
gc 0
Train Epoch40 Acc 0.647 (25880/40000), AUC 0.7050020694732666
Test Epoch40 layer0 Acc 0.6419, AUC 0.6994985938072205, avg_entr 0.28912538290023804
Test Epoch40 layer1 Acc 0.6389, AUC 0.6984966993331909, avg_entr 0.28975915908813477
Test Epoch40 layer2 Acc 0.6412, AUC 0.6996655464172363, avg_entr 0.2866770029067993
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 40
Test Epoch40 layer3 Acc 0.6385, AUC 0.6988150477409363, avg_entr 0.28860411047935486
Test Epoch40 layer4 Acc 0.6413, AUC 0.6986615061759949, avg_entr 0.28713807463645935
gc 0
Train Epoch41 Acc 0.648625 (25945/40000), AUC 0.7049046754837036
Test Epoch41 layer0 Acc 0.6312, AUC 0.6996874809265137, avg_entr 0.2658809423446655
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 41
Test Epoch41 layer1 Acc 0.6293, AUC 0.6987760066986084, avg_entr 0.26717451214790344
Test Epoch41 layer2 Acc 0.632, AUC 0.6998680830001831, avg_entr 0.26766395568847656
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 41
Test Epoch41 layer3 Acc 0.6292, AUC 0.6989730596542358, avg_entr 0.2679651081562042
Test Epoch41 layer4 Acc 0.63, AUC 0.6989620923995972, avg_entr 0.2655769884586334
gc 0
Train Epoch42 Acc 0.648 (25920/40000), AUC 0.7049120664596558
Test Epoch42 layer0 Acc 0.6389, AUC 0.6996604204177856, avg_entr 0.2795836925506592
Test Epoch42 layer1 Acc 0.6387, AUC 0.6986966133117676, avg_entr 0.2812511622905731
Test Epoch42 layer2 Acc 0.6414, AUC 0.6999139785766602, avg_entr 0.27885687351226807
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 42
Test Epoch42 layer3 Acc 0.6387, AUC 0.6989648342132568, avg_entr 0.28247401118278503
Test Epoch42 layer4 Acc 0.6427, AUC 0.6989020705223083, avg_entr 0.2811678349971771
gc 0
Train Epoch43 Acc 0.648675 (25947/40000), AUC 0.7053864002227783
Test Epoch43 layer0 Acc 0.6422, AUC 0.6996419429779053, avg_entr 0.28202444314956665
Test Epoch43 layer1 Acc 0.642, AUC 0.6987007856369019, avg_entr 0.2817822992801666
Test Epoch43 layer2 Acc 0.6434, AUC 0.6999258995056152, avg_entr 0.2807910144329071
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 43
Test Epoch43 layer3 Acc 0.6396, AUC 0.6990560293197632, avg_entr 0.27948808670043945
Test Epoch43 layer4 Acc 0.6434, AUC 0.6989947557449341, avg_entr 0.2790064215660095
gc 0
Train Epoch44 Acc 0.648175 (25927/40000), AUC 0.7049683928489685
Test Epoch44 layer0 Acc 0.6418, AUC 0.6996329426765442, avg_entr 0.28753724694252014
Test Epoch44 layer1 Acc 0.6416, AUC 0.6986308097839355, avg_entr 0.2873108983039856
Test Epoch44 layer2 Acc 0.6433, AUC 0.7000139355659485, avg_entr 0.2835066318511963
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 44
Test Epoch44 layer3 Acc 0.6435, AUC 0.6990237236022949, avg_entr 0.28716176748275757
Test Epoch44 layer4 Acc 0.6431, AUC 0.6989772319793701, avg_entr 0.28590041399002075
gc 0
Train Epoch45 Acc 0.648975 (25959/40000), AUC 0.7049559354782104
Test Epoch45 layer0 Acc 0.6326, AUC 0.6990388631820679, avg_entr 0.2755599319934845
Test Epoch45 layer1 Acc 0.6336, AUC 0.6980305314064026, avg_entr 0.2768246829509735
Test Epoch45 layer2 Acc 0.6364, AUC 0.699607789516449, avg_entr 0.27702388167381287
Test Epoch45 layer3 Acc 0.6346, AUC 0.6984771490097046, avg_entr 0.2744959890842438
Test Epoch45 layer4 Acc 0.6317, AUC 0.6984158754348755, avg_entr 0.27383705973625183
gc 0
Train Epoch46 Acc 0.650825 (26033/40000), AUC 0.7070955038070679
Test Epoch46 layer0 Acc 0.6374, AUC 0.6992933750152588, avg_entr 0.27598047256469727
Test Epoch46 layer1 Acc 0.6358, AUC 0.6982464790344238, avg_entr 0.2764890491962433
Test Epoch46 layer2 Acc 0.6466, AUC 0.7001894116401672, avg_entr 0.2726507782936096
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 46
Test Epoch46 layer3 Acc 0.6399, AUC 0.6992624998092651, avg_entr 0.273422509431839
Test Epoch46 layer4 Acc 0.6382, AUC 0.6987184882164001, avg_entr 0.27575284242630005
gc 0
Train Epoch47 Acc 0.650325 (26013/40000), AUC 0.7069612741470337
Test Epoch47 layer0 Acc 0.6427, AUC 0.6997693181037903, avg_entr 0.2778596580028534
Test Epoch47 layer1 Acc 0.6442, AUC 0.6988300085067749, avg_entr 0.2778410017490387
Test Epoch47 layer2 Acc 0.6377, AUC 0.7004472613334656, avg_entr 0.25693127512931824
Save ckpt to ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt  ,ep 47
Test Epoch47 layer3 Acc 0.6349, AUC 0.6995513439178467, avg_entr 0.25840672850608826
Test Epoch47 layer4 Acc 0.6423, AUC 0.6992285251617432, avg_entr 0.2754390239715576
gc 0
Train Epoch48 Acc 0.650475 (26019/40000), AUC 0.7064331769943237
Test Epoch48 layer0 Acc 0.6428, AUC 0.6999187469482422, avg_entr 0.26936793327331543
Test Epoch48 layer1 Acc 0.6435, AUC 0.699034571647644, avg_entr 0.26883819699287415
Test Epoch48 layer2 Acc 0.6444, AUC 0.7004120349884033, avg_entr 0.26798832416534424
Test Epoch48 layer3 Acc 0.6405, AUC 0.6995499134063721, avg_entr 0.2693299949169159
Test Epoch48 layer4 Acc 0.6427, AUC 0.6994175910949707, avg_entr 0.2671152353286743
gc 0
Train Epoch49 Acc 0.65145 (26058/40000), AUC 0.7079927921295166
Test Epoch49 layer0 Acc 0.6418, AUC 0.6997003555297852, avg_entr 0.27235057950019836
Test Epoch49 layer1 Acc 0.6408, AUC 0.6987794041633606, avg_entr 0.27197325229644775
Test Epoch49 layer2 Acc 0.6392, AUC 0.7002633810043335, avg_entr 0.26904118061065674
Test Epoch49 layer3 Acc 0.6428, AUC 0.699447751045227, avg_entr 0.27364522218704224
Test Epoch49 layer4 Acc 0.6432, AUC 0.6992186307907104, avg_entr 0.27063965797424316
Best AUC 0.7004472613334656
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_linearalside_l5_side500//imdb_linearalside_l5_side.pt
[[3380 1647]
 [1926 3047]]
Figure(640x480)
tensor([0.5060, 0.0135, 0.0084,  ..., 0.0093, 0.0207, 0.1149])
[[3367 1660]
 [1898 3075]]
Figure(640x480)
tensor([0.3878, 0.0157, 0.0069,  ..., 0.0036, 0.0162, 0.0522])
[[3988 1039]
 [2584 2389]]
Figure(640x480)
tensor([0.1116, 0.0343, 0.0252,  ..., 0.0214, 0.0595, 0.0341])
[[4032  995]
 [2656 2317]]
Figure(640x480)
tensor([0.1226, 0.0336, 0.0212,  ..., 0.0342, 0.0909, 0.0510])
[[3437 1590]
 [1987 2986]]
Figure(640x480)
tensor([0.2999, 0.0158, 0.0068,  ..., 0.0083, 0.0183, 0.1287])
