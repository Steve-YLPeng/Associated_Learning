total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25000833333333333 (30001/120000), AUC 0.4782232344150543
ep0_train_time 8.758385181427002
Test Epoch0 threshold 0.6 Acc 0.8973684210526316, AUC 0.9736257195472717, avg_entr 0.18468262255191803
ep0_t0.6_test_time 0.2595512866973877
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.44574928283691406
ep1_train_time 8.35922884941101
Test Epoch1 threshold 0.6 Acc 0.9108552631578948, AUC 0.977574348449707, avg_entr 0.10537465661764145
ep1_t0.6_test_time 0.25751328468322754
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.447523832321167
ep2_train_time 8.288556098937988
Test Epoch2 threshold 0.6 Acc 0.9157894736842105, AUC 0.979172945022583, avg_entr 0.08127713203430176
ep2_t0.6_test_time 0.2582674026489258
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.4551408290863037
ep3_train_time 8.261890172958374
Test Epoch3 threshold 0.6 Acc 0.9164473684210527, AUC 0.9799748659133911, avg_entr 0.06612198054790497
ep3_t0.6_test_time 0.26511383056640625
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.4632546901702881
ep4_train_time 8.25473427772522
Test Epoch4 threshold 0.6 Acc 0.9157894736842105, AUC 0.9803630709648132, avg_entr 0.058700405061244965
ep4_t0.6_test_time 0.25911474227905273
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.4706524610519409
ep5_train_time 8.304968118667603
Test Epoch5 threshold 0.6 Acc 0.9164473684210527, AUC 0.9805325865745544, avg_entr 0.05322928726673126
ep5_t0.6_test_time 0.25838255882263184
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.477061927318573
ep6_train_time 8.280508756637573
Test Epoch6 threshold 0.6 Acc 0.9167763157894737, AUC 0.9805692434310913, avg_entr 0.05014640837907791
ep6_t0.6_test_time 0.2584078311920166
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.48320484161376953
ep7_train_time 8.400233030319214
Test Epoch7 threshold 0.6 Acc 0.9169407894736842, AUC 0.9805432558059692, avg_entr 0.04556368291378021
ep7_t0.6_test_time 0.25846409797668457
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.48837941884994507
ep8_train_time 8.482232570648193
Test Epoch8 threshold 0.6 Acc 0.9143092105263158, AUC 0.9805102944374084, avg_entr 0.043885402381420135
ep8_t0.6_test_time 0.2573513984680176
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.49293315410614014
ep9_train_time 8.139014959335327
Test Epoch9 threshold 0.6 Acc 0.9151315789473684, AUC 0.9803583025932312, avg_entr 0.0410614088177681
ep9_t0.6_test_time 0.2620244026184082
Best AUC 0.9805692434310913
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt
[[1360   53   75   44]
 [  10 1479    5   13]
 [  34   12 1326  128]
 [  30   13   89 1409]]
Figure(640x480)
tensor([0.0269, 0.0005, 0.0126,  ..., 0.0005, 0.0026, 0.0360])
[[   0 1532    0    0]
 [   0 1507    0    0]
 [   0 1500    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([1.1765, 1.2228, 1.2034,  ..., 1.1907, 1.2225, 1.2250])
[[   0 1532    0    0]
 [   0 1507    0    0]
 [   0 1500    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([0.8831, 0.9575, 0.9312,  ..., 0.9224, 0.9517, 0.9498])
[[   0    0    0 1532]
 [   0    0    1 1506]
 [   0    0    1 1499]
 [   0    0    4 1537]]
Figure(640x480)
tensor([1.1465, 1.1793, 1.1837,  ..., 1.1621, 1.1713, 1.1774])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([1.2024, 1.2607, 1.2441,  ..., 1.2146, 1.2369, 1.1962])
