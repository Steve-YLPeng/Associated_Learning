total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.2571 (30852/120000), AUC 0.523155689239502
ep0_train_time 77.62539005279541
Test Epoch0 threshold 0.3 Acc 0.9131578947368421, AUC 0.9799860715866089, avg_entr 0.02175435982644558
ep0_t0.3_test_time 0.38969850540161133
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.27000833333333335 (32401/120000), AUC 0.5086344480514526
ep1_train_time 77.5851845741272
Test Epoch1 threshold 0.3 Acc 0.9139802631578947, AUC 0.9798405766487122, avg_entr 0.023100608959794044
ep1_t0.3_test_time 0.3679039478302002
gc 0
Train Epoch2 Acc 0.29580833333333334 (35497/120000), AUC 0.49741649627685547
ep2_train_time 77.66790223121643
Test Epoch2 threshold 0.3 Acc 0.9136513157894737, AUC 0.9794880151748657, avg_entr 0.02327817678451538
ep2_t0.3_test_time 0.3479487895965576
gc 0
Train Epoch3 Acc 0.314975 (37797/120000), AUC 0.49466270208358765
ep3_train_time 77.54082369804382
Test Epoch3 threshold 0.3 Acc 0.9129934210526316, AUC 0.9794808030128479, avg_entr 0.023205365985631943
ep3_t0.3_test_time 0.353424072265625
gc 0
Train Epoch4 Acc 0.32886666666666664 (39464/120000), AUC 0.49497824907302856
ep4_train_time 77.56323099136353
Test Epoch4 threshold 0.3 Acc 0.9118421052631579, AUC 0.9791812300682068, avg_entr 0.02219969406723976
ep4_t0.3_test_time 0.37081027030944824
gc 0
Train Epoch5 Acc 0.3752 (45024/120000), AUC 0.4949759840965271
ep5_train_time 77.68864607810974
Test Epoch5 threshold 0.3 Acc 0.9121710526315789, AUC 0.9792656898498535, avg_entr 0.0233797375112772
ep5_t0.3_test_time 0.3377995491027832
gc 0
Train Epoch6 Acc 0.38259166666666666 (45911/120000), AUC 0.49499833583831787
ep6_train_time 77.6392285823822
Test Epoch6 threshold 0.3 Acc 0.912828947368421, AUC 0.9791415333747864, avg_entr 0.023891746997833252
ep6_t0.3_test_time 0.33998537063598633
gc 0
Train Epoch7 Acc 0.3847 (46164/120000), AUC 0.49505186080932617
ep7_train_time 77.69800305366516
Test Epoch7 threshold 0.3 Acc 0.9113486842105263, AUC 0.9789716601371765, avg_entr 0.024097176268696785
ep7_t0.3_test_time 0.32810235023498535
gc 0
Train Epoch8 Acc 0.41885 (50262/120000), AUC 0.4951218068599701
ep8_train_time 77.85541200637817
Test Epoch8 threshold 0.3 Acc 0.9116776315789473, AUC 0.9785694479942322, avg_entr 0.023522522300481796
ep8_t0.3_test_time 0.3395974636077881
gc 0
Train Epoch9 Acc 0.42830833333333335 (51397/120000), AUC 0.49565255641937256
ep9_train_time 77.73643946647644
Test Epoch9 threshold 0.3 Acc 0.9120065789473685, AUC 0.9786989688873291, avg_entr 0.022962577641010284
ep9_t0.3_test_time 0.3211843967437744
Best AUC 0.9799860715866089
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m4//ag_news_lstmal_l5_prefix.pt
[[1369   52   81   30]
 [  10 1480   11    6]
 [  31   12 1354  103]
 [  36   16  135 1354]]
Figure(640x480)
tensor([5.0957e-04, 1.0552e-07, 6.3110e-04,  ..., 2.6738e-08, 1.1827e-05,
        9.3967e-05])
[[1381   47   60   44]
 [  16 1475   11    5]
 [  43   19 1337  101]
 [  37   22  138 1344]]
Figure(640x480)
tensor([1.7364e-06, 2.0191e-07, 3.8684e-07,  ..., 7.5978e-08, 5.9567e-07,
        3.6855e-07])
[[1382   47   61   42]
 [  15 1475   12    5]
 [  43   19 1335  103]
 [  38   22  142 1339]]
Figure(640x480)
tensor([8.9589e-07, 2.0977e-07, 4.9553e-07,  ..., 2.2572e-07, 6.2945e-07,
        4.0836e-07])
[[1377   48   65   42]
 [  19 1472   12    4]
 [  41   18 1340  101]
 [  39   21  145 1336]]
Figure(640x480)
tensor([4.2470e-07, 3.1108e-07, 7.2090e-07,  ..., 3.9284e-07, 1.0019e-06,
        2.8327e-07])
[[ 131   88    0 1313]
 [  48 1443    0   16]
 [1319  150    0   31]
 [ 106 1393    0   42]]
Figure(640x480)
tensor([0.9543, 0.6907, 0.6321,  ..., 1.2134, 0.6806, 0.9677])
