total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.49735021591186523
ep0_train_time 8.602735757827759
Test Epoch0 threshold 0.8 Acc 0.9006578947368421, AUC 0.9740451574325562, avg_entr 0.18132156133651733
ep0_t0.8_test_time 0.25775742530822754
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.4694628119468689
ep1_train_time 8.145971059799194
Test Epoch1 threshold 0.8 Acc 0.9123355263157895, AUC 0.9781098365783691, avg_entr 0.10490452498197556
ep1_t0.8_test_time 0.2596726417541504
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.4560387134552002
ep2_train_time 8.192038774490356
Test Epoch2 threshold 0.8 Acc 0.9149671052631579, AUC 0.9796605110168457, avg_entr 0.0813114270567894
ep2_t0.8_test_time 0.25485706329345703
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.4550640881061554
ep3_train_time 8.226148843765259
Test Epoch3 threshold 0.8 Acc 0.9169407894736842, AUC 0.9803574681282043, avg_entr 0.06658278405666351
ep3_t0.8_test_time 0.25633859634399414
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.455973356962204
ep4_train_time 8.21503496170044
Test Epoch4 threshold 0.8 Acc 0.9177631578947368, AUC 0.9806903004646301, avg_entr 0.05779736116528511
ep4_t0.8_test_time 0.2548983097076416
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.458048939704895
ep5_train_time 8.141876935958862
Test Epoch5 threshold 0.8 Acc 0.9179276315789474, AUC 0.980742335319519, avg_entr 0.05276501923799515
ep5_t0.8_test_time 0.25423121452331543
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.46013134717941284
ep6_train_time 8.213755130767822
Test Epoch6 threshold 0.8 Acc 0.9167763157894737, AUC 0.9806736707687378, avg_entr 0.04884744808077812
ep6_t0.8_test_time 0.255664587020874
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.46255266666412354
ep7_train_time 8.26447081565857
Test Epoch7 threshold 0.8 Acc 0.915296052631579, AUC 0.9806564450263977, avg_entr 0.048012834042310715
ep7_t0.8_test_time 0.25502467155456543
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.46472132205963135
ep8_train_time 8.144146203994751
Test Epoch8 threshold 0.8 Acc 0.915625, AUC 0.9805896282196045, avg_entr 0.04377671703696251
ep8_t0.8_test_time 0.2532351016998291
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.466104656457901
ep9_train_time 8.1817946434021
Test Epoch9 threshold 0.8 Acc 0.9164473684210527, AUC 0.9804813861846924, avg_entr 0.041708458214998245
ep9_t0.8_test_time 0.2573418617248535
Best AUC 0.980742335319519
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt
[[1374   54   72   32]
 [  10 1489    2    6]
 [  38   19 1322  121]
 [  38   17   90 1396]]
Figure(640x480)
tensor([0.0572, 0.0013, 0.0281,  ..., 0.0006, 0.0021, 0.0390])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([1.4198, 1.4287, 1.4294,  ..., 1.4066, 1.4303, 1.4144])
[[  35    0 1497    0]
 [   8    0 1499    0]
 [  12    0 1488    0]
 [  25    0 1516    0]]
Figure(640x480)
tensor([1.3741, 1.3481, 1.3505,  ..., 1.3629, 1.3669, 1.3652])
[[   0    0    0 1532]
 [   0    0    0 1507]
 [   0    0    0 1500]
 [   0    0    0 1541]]
Figure(640x480)
tensor([1.3191, 1.3614, 1.3349,  ..., 1.3408, 1.3575, 1.3708])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([1.1703, 1.1755, 1.1697,  ..., 1.1954, 1.1685, 1.1898])
