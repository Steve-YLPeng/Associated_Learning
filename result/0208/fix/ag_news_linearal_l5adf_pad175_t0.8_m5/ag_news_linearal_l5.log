total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9049166666666667 (108590/120000), AUC 0.9834272861480713
ep0_train_time 10.58893871307373
Test Epoch0 threshold 0.8 Acc 0.9167763157894737, AUC 0.9807313680648804, avg_entr 0.025421923026442528
ep0_t0.8_test_time 0.25052833557128906
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9483166666666667 (113798/120000), AUC 0.9926554560661316
ep1_train_time 10.17717981338501
Test Epoch1 threshold 0.8 Acc 0.9166118421052631, AUC 0.9805740118026733, avg_entr 0.025942757725715637
ep1_t0.8_test_time 0.2492516040802002
gc 0
Train Epoch2 Acc 0.9497583333333334 (113971/120000), AUC 0.9929684996604919
ep2_train_time 10.152578830718994
Test Epoch2 threshold 0.8 Acc 0.9157894736842105, AUC 0.9804291725158691, avg_entr 0.026158152148127556
ep2_t0.8_test_time 0.24956226348876953
gc 0
Train Epoch3 Acc 0.9512666666666667 (114152/120000), AUC 0.9929913282394409
ep3_train_time 10.167256355285645
Test Epoch3 threshold 0.8 Acc 0.9134868421052632, AUC 0.9800915718078613, avg_entr 0.024852657690644264
ep3_t0.8_test_time 0.25094175338745117
gc 0
Train Epoch4 Acc 0.9525083333333333 (114301/120000), AUC 0.9934335947036743
ep4_train_time 10.158947467803955
Test Epoch4 threshold 0.8 Acc 0.9159539473684211, AUC 0.9800878763198853, avg_entr 0.02566858008503914
ep4_t0.8_test_time 0.24933362007141113
gc 0
Train Epoch5 Acc 0.9542666666666667 (114512/120000), AUC 0.9941419363021851
ep5_train_time 10.143746852874756
Test Epoch5 threshold 0.8 Acc 0.9141447368421053, AUC 0.979956865310669, avg_entr 0.026463327929377556
ep5_t0.8_test_time 0.2486588954925537
gc 0
Train Epoch6 Acc 0.954625 (114555/120000), AUC 0.9942920207977295
ep6_train_time 10.210149765014648
Test Epoch6 threshold 0.8 Acc 0.9138157894736842, AUC 0.9798069000244141, avg_entr 0.02595055289566517
ep6_t0.8_test_time 0.24899721145629883
gc 0
Train Epoch7 Acc 0.9549416666666667 (114593/120000), AUC 0.9944621324539185
ep7_train_time 10.160712242126465
Test Epoch7 threshold 0.8 Acc 0.9149671052631579, AUC 0.97979336977005, avg_entr 0.02559673972427845
ep7_t0.8_test_time 0.24961543083190918
gc 0
Train Epoch8 Acc 0.955525 (114663/120000), AUC 0.9947091341018677
ep8_train_time 10.157581329345703
Test Epoch8 threshold 0.8 Acc 0.9149671052631579, AUC 0.9796668291091919, avg_entr 0.025736432522535324
ep8_t0.8_test_time 0.2488090991973877
gc 0
Train Epoch9 Acc 0.9566416666666666 (114797/120000), AUC 0.9950093030929565
ep9_train_time 10.164488315582275
Test Epoch9 threshold 0.8 Acc 0.9126644736842106, AUC 0.979562520980835, avg_entr 0.025412535294890404
ep9_t0.8_test_time 0.24911952018737793
Best AUC 0.9807313680648804
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5_prefix.pt
[[1382   50   62   38]
 [  13 1479    4   11]
 [  42   16 1297  145]
 [  34   13   78 1416]]
Figure(640x480)
tensor([8.2646e-03, 4.9043e-08, 4.9543e-05,  ..., 6.0943e-08, 4.5140e-07,
        7.4129e-04])
[[1381   50   62   39]
 [  13 1478    5   11]
 [  38   15 1296  151]
 [  34   13   71 1423]]
Figure(640x480)
tensor([4.5150e-03, 1.6690e-07, 4.4732e-05,  ..., 1.7748e-07, 5.4189e-07,
        1.1579e-03])
[[1383   50   60   39]
 [  13 1479    3   12]
 [  41   16 1291  152]
 [  36   13   70 1422]]
Figure(640x480)
tensor([3.7893e-03, 8.6106e-08, 2.5531e-05,  ..., 9.3603e-08, 2.5733e-07,
        8.8843e-04])
[[1384   50   57   41]
 [  15 1477    2   13]
 [  44   17 1278  161]
 [  34   13   65 1429]]
Figure(640x480)
tensor([3.0019e-03, 3.4625e-08, 9.1531e-06,  ..., 7.3552e-08, 3.6926e-07,
        5.8335e-04])
[[1384   50   59   39]
 [  14 1478    3   12]
 [  46   17 1284  153]
 [  37   13   67 1424]]
Figure(640x480)
tensor([2.5595e-03, 6.9697e-08, 9.6013e-06,  ..., 1.0535e-07, 2.8078e-07,
        3.6031e-04])
