total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.23901666666666666 (28682/120000), AUC 0.36991411447525024
ep0_train_time 9.4969162940979
Test Epoch0 threshold 0.7 Acc 0.9179276315789474, AUC 0.9809671640396118, avg_entr 0.02609909698367119
ep0_t0.7_test_time 0.2539100646972656
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2483 (29796/120000), AUC 0.33412912487983704
ep1_train_time 8.933075904846191
Test Epoch1 threshold 0.7 Acc 0.9138157894736842, AUC 0.980740487575531, avg_entr 0.025834878906607628
ep1_t0.7_test_time 0.25232362747192383
gc 0
Train Epoch2 Acc 0.24755 (29706/120000), AUC 0.3358912467956543
ep2_train_time 8.951688766479492
Test Epoch2 threshold 0.7 Acc 0.9125, AUC 0.9806994199752808, avg_entr 0.025651903823018074
ep2_t0.7_test_time 0.2520449161529541
gc 0
Train Epoch3 Acc 0.24634166666666665 (29561/120000), AUC 0.3505055606365204
ep3_train_time 8.872381925582886
Test Epoch3 threshold 0.7 Acc 0.9141447368421053, AUC 0.9803128242492676, avg_entr 0.025496860966086388
ep3_t0.7_test_time 0.2517104148864746
gc 0
Train Epoch4 Acc 0.24503333333333333 (29404/120000), AUC 0.36222898960113525
ep4_train_time 8.96748399734497
Test Epoch4 threshold 0.7 Acc 0.9111842105263158, AUC 0.9799467325210571, avg_entr 0.0265777837485075
ep4_t0.7_test_time 0.25139617919921875
gc 0
Train Epoch5 Acc 0.24485 (29382/120000), AUC 0.36245113611221313
ep5_train_time 8.982678174972534
Test Epoch5 threshold 0.7 Acc 0.9141447368421053, AUC 0.980036735534668, avg_entr 0.02700621262192726
ep5_t0.7_test_time 0.25109028816223145
gc 0
Train Epoch6 Acc 0.24476666666666666 (29372/120000), AUC 0.3735336661338806
ep6_train_time 8.930246353149414
Test Epoch6 threshold 0.7 Acc 0.9129934210526316, AUC 0.9799758791923523, avg_entr 0.026639237999916077
ep6_t0.7_test_time 0.2502450942993164
gc 0
Train Epoch7 Acc 0.243975 (29277/120000), AUC 0.3860297203063965
ep7_train_time 9.048320293426514
Test Epoch7 threshold 0.7 Acc 0.9138157894736842, AUC 0.9798975586891174, avg_entr 0.026161620393395424
ep7_t0.7_test_time 0.2515134811401367
gc 0
Train Epoch8 Acc 0.24303333333333332 (29164/120000), AUC 0.3962503671646118
ep8_train_time 9.063472986221313
Test Epoch8 threshold 0.7 Acc 0.9138157894736842, AUC 0.9797830581665039, avg_entr 0.02697923593223095
ep8_t0.7_test_time 0.25163960456848145
gc 0
Train Epoch9 Acc 0.2422 (29064/120000), AUC 0.40056300163269043
ep9_train_time 8.9390230178833
Test Epoch9 threshold 0.7 Acc 0.9115131578947369, AUC 0.979686975479126, avg_entr 0.02533993311226368
ep9_t0.7_test_time 0.2517843246459961
Best AUC 0.9809671640396118
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt
[[1382   51   65   34]
 [  11 1481    5   10]
 [  40   18 1315  127]
 [  36   18   84 1403]]
Figure(640x480)
tensor([4.4072e-03, 3.0665e-07, 1.1705e-04,  ..., 9.5618e-08, 1.7830e-06,
        6.1253e-04])
[[1380   52   65   35]
 [  13 1479    4   11]
 [  38   21 1311  130]
 [  38   19   85 1399]]
Figure(640x480)
tensor([7.4745e-03, 1.1645e-06, 1.8460e-04,  ..., 1.8746e-07, 2.6791e-06,
        2.5043e-03])
[[1379   52   66   35]
 [  13 1479    4   11]
 [  36   21 1312  131]
 [  37   18   82 1404]]
Figure(640x480)
tensor([4.2175e-03, 1.1163e-06, 1.0983e-04,  ..., 1.7525e-07, 2.4361e-06,
        2.0960e-03])
[[   0    0 1525    7]
 [   0    0 1157  350]
 [   0    0 1499    1]
 [   0    0 1522   19]]
Figure(640x480)
tensor([0.7741, 0.6963, 0.8002,  ..., 0.5803, 0.9584, 0.7590])
[[   0 1225  307    0]
 [   0    0 1507    0]
 [   0   16 1484    0]
 [   0   19 1522    0]]
Figure(640x480)
tensor([0.5102, 0.9891, 0.8542,  ..., 1.0546, 0.8826, 0.8199])
