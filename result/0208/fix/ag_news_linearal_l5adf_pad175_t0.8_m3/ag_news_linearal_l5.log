total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.25016666666666665 (30020/120000), AUC 0.3398298919200897
ep0_train_time 9.652658224105835
Test Epoch0 threshold 0.8 Acc 0.9177631578947368, AUC 0.9809374213218689, avg_entr 0.026173505932092667
ep0_t0.8_test_time 0.25049519538879395
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2501833333333333 (30022/120000), AUC 0.27052757143974304
ep1_train_time 9.163273811340332
Test Epoch1 threshold 0.8 Acc 0.9139802631578947, AUC 0.9807489514350891, avg_entr 0.025377856567502022
ep1_t0.8_test_time 0.24876952171325684
gc 0
Train Epoch2 Acc 0.25030833333333335 (30037/120000), AUC 0.25135788321495056
ep2_train_time 9.115832567214966
Test Epoch2 threshold 0.8 Acc 0.9157894736842105, AUC 0.980700671672821, avg_entr 0.02556951902806759
ep2_t0.8_test_time 0.2520887851715088
gc 0
Train Epoch3 Acc 0.250425 (30051/120000), AUC 0.24161529541015625
ep3_train_time 9.238075733184814
Test Epoch3 threshold 0.8 Acc 0.9164473684210527, AUC 0.9805582761764526, avg_entr 0.02593943104147911
ep3_t0.8_test_time 0.24944853782653809
gc 0
Train Epoch4 Acc 0.2507666666666667 (30092/120000), AUC 0.23377028107643127
ep4_train_time 9.175757884979248
Test Epoch4 threshold 0.8 Acc 0.9161184210526315, AUC 0.9805268049240112, avg_entr 0.026540879160165787
ep4_t0.8_test_time 0.2499256134033203
gc 0
Train Epoch5 Acc 0.25104166666666666 (30125/120000), AUC 0.23281975090503693
ep5_train_time 9.161362171173096
Test Epoch5 threshold 0.8 Acc 0.915296052631579, AUC 0.9803184270858765, avg_entr 0.026450462639331818
ep5_t0.8_test_time 0.2490394115447998
gc 0
Train Epoch6 Acc 0.25095 (30114/120000), AUC 0.23984256386756897
ep6_train_time 9.140390634536743
Test Epoch6 threshold 0.8 Acc 0.9136513157894737, AUC 0.980172872543335, avg_entr 0.02516802027821541
ep6_t0.8_test_time 0.24889254570007324
gc 0
Train Epoch7 Acc 0.2500833333333333 (30010/120000), AUC 0.2517752945423126
ep7_train_time 9.161940336227417
Test Epoch7 threshold 0.8 Acc 0.9148026315789474, AUC 0.9799767136573792, avg_entr 0.02586357295513153
ep7_t0.8_test_time 0.24939870834350586
gc 0
Train Epoch8 Acc 0.24869166666666667 (29843/120000), AUC 0.26703941822052
ep8_train_time 9.189237356185913
Test Epoch8 threshold 0.8 Acc 0.9138157894736842, AUC 0.9799551963806152, avg_entr 0.02648044377565384
ep8_t0.8_test_time 0.24981999397277832
gc 0
Train Epoch9 Acc 0.24651666666666666 (29582/120000), AUC 0.2783085107803345
ep9_train_time 9.176114320755005
Test Epoch9 threshold 0.8 Acc 0.9129934210526316, AUC 0.9798043966293335, avg_entr 0.02570725977420807
ep9_t0.8_test_time 0.24911189079284668
Best AUC 0.9809374213218689
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt
[[1381   51   70   30]
 [  13 1482    4    8]
 [  41   15 1333  111]
 [  40   15  102 1384]]
Figure(640x480)
tensor([3.0289e-03, 1.6181e-07, 5.3799e-04,  ..., 9.1328e-08, 4.4228e-06,
        1.5012e-04])
[[1377   51   71   33]
 [  11 1482    6    8]
 [  38   15 1332  115]
 [  40   14   99 1388]]
Figure(640x480)
tensor([2.5468e-03, 4.7281e-07, 4.7732e-04,  ..., 1.6074e-07, 6.0226e-06,
        2.1145e-04])
[[1378   53   71   30]
 [  11 1483    6    7]
 [  38   15 1333  114]
 [  43   14  101 1383]]
Figure(640x480)
tensor([2.2015e-03, 3.1963e-07, 4.0301e-04,  ..., 1.3537e-07, 3.8334e-06,
        2.4597e-04])
[[ 473 1058    1    0]
 [1455   50    2    0]
 [1488   12    0    0]
 [1533    8    0    0]]
Figure(640x480)
tensor([1.2219, 0.6895, 0.9511,  ..., 1.0238, 0.8968, 0.9680])
[[   1    0 1531    0]
 [ 191    0 1313    3]
 [   1    0 1499    0]
 [   1    0 1540    0]]
Figure(640x480)
tensor([0.6801, 0.7933, 0.6734,  ..., 1.1153, 0.5319, 0.8503])
