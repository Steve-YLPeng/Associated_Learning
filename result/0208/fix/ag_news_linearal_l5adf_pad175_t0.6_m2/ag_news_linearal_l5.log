total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.26048333333333334 (31258/120000), AUC 0.5901763439178467
ep0_train_time 9.134485483169556
Test Epoch0 threshold 0.6 Acc 0.9143092105263158, AUC 0.981007993221283, avg_entr 0.02946246974170208
ep0_t0.6_test_time 0.25797104835510254
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.29641666666666666 (35570/120000), AUC 0.5928909778594971
ep1_train_time 8.65373945236206
Test Epoch1 threshold 0.6 Acc 0.915625, AUC 0.9807724952697754, avg_entr 0.027297481894493103
ep1_t0.6_test_time 0.25603199005126953
gc 0
Train Epoch2 Acc 0.2917 (35004/120000), AUC 0.6110320091247559
ep2_train_time 8.83737063407898
Test Epoch2 threshold 0.6 Acc 0.9167763157894737, AUC 0.9807493686676025, avg_entr 0.02731269784271717
ep2_t0.6_test_time 0.25540614128112793
gc 0
Train Epoch3 Acc 0.31483333333333335 (37780/120000), AUC 0.6300541758537292
ep3_train_time 8.95826005935669
Test Epoch3 threshold 0.6 Acc 0.9164473684210527, AUC 0.9806976318359375, avg_entr 0.026088006794452667
ep3_t0.6_test_time 0.2559492588043213
gc 0
Train Epoch4 Acc 0.322075 (38649/120000), AUC 0.6393837332725525
ep4_train_time 8.755691289901733
Test Epoch4 threshold 0.6 Acc 0.9116776315789473, AUC 0.980318009853363, avg_entr 0.026447175070643425
ep4_t0.6_test_time 0.2655513286590576
gc 0
Train Epoch5 Acc 0.32824166666666665 (39389/120000), AUC 0.6427329182624817
ep5_train_time 8.802765130996704
Test Epoch5 threshold 0.6 Acc 0.9148026315789474, AUC 0.9802513122558594, avg_entr 0.02587282843887806
ep5_t0.6_test_time 0.2554004192352295
gc 0
Train Epoch6 Acc 0.33745833333333336 (40495/120000), AUC 0.6435642838478088
ep6_train_time 8.623265504837036
Test Epoch6 threshold 0.6 Acc 0.9138157894736842, AUC 0.9801475405693054, avg_entr 0.026375366374850273
ep6_t0.6_test_time 0.25547361373901367
gc 0
Train Epoch7 Acc 0.3464 (41568/120000), AUC 0.6438701152801514
ep7_train_time 8.567281723022461
Test Epoch7 threshold 0.6 Acc 0.9143092105263158, AUC 0.9800556898117065, avg_entr 0.026609888300299644
ep7_t0.6_test_time 0.2547001838684082
gc 0
Train Epoch8 Acc 0.3574333333333333 (42892/120000), AUC 0.6435878872871399
ep8_train_time 9.100411415100098
Test Epoch8 threshold 0.6 Acc 0.9154605263157894, AUC 0.9799968004226685, avg_entr 0.025787780061364174
ep8_t0.6_test_time 0.2559843063354492
gc 0
Train Epoch9 Acc 0.366925 (44031/120000), AUC 0.6434251070022583
ep9_train_time 8.668321132659912
Test Epoch9 threshold 0.6 Acc 0.9139802631578947, AUC 0.9799641370773315, avg_entr 0.026110343635082245
ep9_t0.6_test_time 0.2549128532409668
Best AUC 0.981007993221283
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt
[[1371   51   78   32]
 [   9 1479   11    8]
 [  33   13 1347  107]
 [  41   12  126 1362]]
Figure(640x480)
tensor([1.8939e-03, 2.6465e-06, 9.5346e-04,  ..., 1.1196e-06, 8.4077e-05,
        5.1691e-04])
[[1374   50   77   31]
 [  12 1481    5    9]
 [  36   14 1342  108]
 [  43   15  111 1372]]
Figure(640x480)
tensor([3.9140e-03, 2.8837e-05, 2.2967e-03,  ..., 4.7009e-06, 8.6606e-04,
        1.0599e-03])
[[   0    2  110 1420]
 [   0    0    1 1506]
 [   0    5    0 1495]
 [   0  143    0 1398]]
Figure(640x480)
tensor([0.7567, 0.7771, 0.7805,  ..., 0.6705, 0.8435, 0.8217])
[[   0    0    0 1532]
 [   0    0    0 1507]
 [   0    0    0 1500]
 [   0    0    0 1541]]
Figure(640x480)
tensor([0.8942, 0.9436, 0.9219,  ..., 0.9506, 0.9051, 0.9677])
[[1507    0    4   21]
 [ 503    0  197  807]
 [1027    0    1  472]
 [1241    0    1  299]]
Figure(640x480)
tensor([0.9708, 0.9500, 0.9990,  ..., 1.0756, 0.9578, 0.9334])
