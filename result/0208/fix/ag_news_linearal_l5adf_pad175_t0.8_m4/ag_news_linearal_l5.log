total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.07380833333333334 (8857/120000), AUC 0.26707494258880615
ep0_train_time 10.252548933029175
Test Epoch0 threshold 0.8 Acc 0.9136513157894737, AUC 0.9808648824691772, avg_entr 0.025629693642258644
ep0_t0.8_test_time 0.25496459007263184
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.05631666666666667 (6758/120000), AUC 0.22812813520431519
ep1_train_time 9.750008344650269
Test Epoch1 threshold 0.8 Acc 0.9162828947368421, AUC 0.9806557297706604, avg_entr 0.025412116199731827
ep1_t0.8_test_time 0.25583958625793457
gc 0
Train Epoch2 Acc 0.05076666666666667 (6092/120000), AUC 0.2552424669265747
ep2_train_time 9.711222887039185
Test Epoch2 threshold 0.8 Acc 0.9120065789473685, AUC 0.9805560111999512, avg_entr 0.025066955015063286
ep2_t0.8_test_time 0.2542734146118164
gc 0
Train Epoch3 Acc 0.04036666666666667 (4844/120000), AUC 0.36706864833831787
ep3_train_time 9.831573486328125
Test Epoch3 threshold 0.8 Acc 0.9146381578947368, AUC 0.9804003238677979, avg_entr 0.02494717203080654
ep3_t0.8_test_time 0.25460362434387207
gc 0
Train Epoch4 Acc 0.0384 (4608/120000), AUC 0.431446373462677
ep4_train_time 9.762893199920654
Test Epoch4 threshold 0.8 Acc 0.9144736842105263, AUC 0.9800719022750854, avg_entr 0.0257235299795866
ep4_t0.8_test_time 0.2573378086090088
gc 0
Train Epoch5 Acc 0.038975 (4677/120000), AUC 0.4486464262008667
ep5_train_time 9.77043628692627
Test Epoch5 threshold 0.8 Acc 0.9149671052631579, AUC 0.9800252914428711, avg_entr 0.025483226403594017
ep5_t0.8_test_time 0.25554656982421875
gc 0
Train Epoch6 Acc 0.041225 (4947/120000), AUC 0.4504011571407318
ep6_train_time 9.774864435195923
Test Epoch6 threshold 0.8 Acc 0.9146381578947368, AUC 0.9799439907073975, avg_entr 0.026084790006279945
ep6_t0.8_test_time 0.2537264823913574
gc 0
Train Epoch7 Acc 0.04295 (5154/120000), AUC 0.4460122883319855
ep7_train_time 9.811674356460571
Test Epoch7 threshold 0.8 Acc 0.9138157894736842, AUC 0.9798870086669922, avg_entr 0.025588372722268105
ep7_t0.8_test_time 0.2568376064300537
gc 0
Train Epoch8 Acc 0.044583333333333336 (5350/120000), AUC 0.4408518671989441
ep8_train_time 9.721168994903564
Test Epoch8 threshold 0.8 Acc 0.9116776315789473, AUC 0.9797288179397583, avg_entr 0.026280345395207405
ep8_t0.8_test_time 0.25443220138549805
gc 0
Train Epoch9 Acc 0.045525 (5463/120000), AUC 0.43637925386428833
ep9_train_time 9.819126605987549
Test Epoch9 threshold 0.8 Acc 0.9143092105263158, AUC 0.97970050573349, avg_entr 0.026480110362172127
ep9_t0.8_test_time 0.2543494701385498
Best AUC 0.9808648824691772
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt
[[1375   51   77   29]
 [   9 1481   11    6]
 [  38   13 1342  107]
 [  45   16  123 1357]]
Figure(640x480)
tensor([1.5598e-03, 7.6174e-08, 9.3652e-04,  ..., 3.5218e-08, 5.0895e-06,
        4.0016e-05])
[[1376   52   74   30]
 [  10 1481    9    7]
 [  37   15 1341  107]
 [  42   16  118 1365]]
Figure(640x480)
tensor([1.1440e-03, 2.1341e-07, 6.9400e-04,  ..., 5.8038e-08, 4.4925e-06,
        5.7058e-05])
[[1374   53   75   30]
 [  10 1482    9    6]
 [  35   15 1345  105]
 [  43   17  125 1356]]
Figure(640x480)
tensor([8.4167e-04, 9.6174e-08, 4.0046e-04,  ..., 5.3767e-08, 2.5527e-06,
        3.7389e-05])
[[1376   52   74   30]
 [  10 1481   10    6]
 [  36   15 1344  105]
 [  44   18  122 1357]]
Figure(640x480)
tensor([5.5363e-04, 1.3700e-07, 2.8370e-04,  ..., 5.2556e-08, 3.1027e-06,
        4.5520e-05])
[[  17    0 1471   44]
 [ 677    0  441  389]
 [   1    0  335 1164]
 [   1    0 1509   31]]
Figure(640x480)
tensor([0.7633, 0.2793, 0.8216,  ..., 0.8141, 0.5555, 0.8194])
