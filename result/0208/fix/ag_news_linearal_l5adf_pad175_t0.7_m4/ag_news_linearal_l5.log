total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.162825 (19539/120000), AUC 0.5674508810043335
ep0_train_time 9.8967604637146
Test Epoch0 threshold 0.7 Acc 0.9166118421052631, AUC 0.9808295965194702, avg_entr 0.025889333337545395
ep0_t0.7_test_time 0.2532947063446045
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2642333333333333 (31708/120000), AUC 0.6637582778930664
ep1_train_time 9.668713808059692
Test Epoch1 threshold 0.7 Acc 0.9126644736842106, AUC 0.9807990193367004, avg_entr 0.026409626007080078
ep1_t0.7_test_time 0.25197792053222656
gc 0
Train Epoch2 Acc 0.4700916666666667 (56411/120000), AUC 0.7492212057113647
ep2_train_time 9.607040405273438
Test Epoch2 threshold 0.7 Acc 0.9146381578947368, AUC 0.980502188205719, avg_entr 0.026379864662885666
ep2_t0.7_test_time 0.251434326171875
gc 0
Train Epoch3 Acc 0.5017083333333333 (60205/120000), AUC 0.7648693323135376
ep3_train_time 9.589107990264893
Test Epoch3 threshold 0.7 Acc 0.9144736842105263, AUC 0.9803923964500427, avg_entr 0.025011833757162094
ep3_t0.7_test_time 0.2520003318786621
gc 0
Train Epoch4 Acc 0.5145083333333333 (61741/120000), AUC 0.737383246421814
ep4_train_time 9.49494218826294
Test Epoch4 threshold 0.7 Acc 0.9138157894736842, AUC 0.980021595954895, avg_entr 0.025225428864359856
ep4_t0.7_test_time 0.2525002956390381
gc 0
Train Epoch5 Acc 0.5036583333333333 (60439/120000), AUC 0.7084848284721375
ep5_train_time 9.591849327087402
Test Epoch5 threshold 0.7 Acc 0.9134868421052632, AUC 0.9798866510391235, avg_entr 0.025540700182318687
ep5_t0.7_test_time 0.2514808177947998
gc 0
Train Epoch6 Acc 0.49320833333333336 (59185/120000), AUC 0.6894388198852539
ep6_train_time 9.594745874404907
Test Epoch6 threshold 0.7 Acc 0.9120065789473685, AUC 0.9798778891563416, avg_entr 0.026288654655218124
ep6_t0.7_test_time 0.25178003311157227
gc 0
Train Epoch7 Acc 0.4842916666666667 (58115/120000), AUC 0.6717007160186768
ep7_train_time 9.508431196212769
Test Epoch7 threshold 0.7 Acc 0.9118421052631579, AUC 0.9798131585121155, avg_entr 0.02592511475086212
ep7_t0.7_test_time 0.25089550018310547
gc 0
Train Epoch8 Acc 0.472775 (56733/120000), AUC 0.6581428050994873
ep8_train_time 9.501829147338867
Test Epoch8 threshold 0.7 Acc 0.9118421052631579, AUC 0.9797186851501465, avg_entr 0.025809865444898605
ep8_t0.7_test_time 0.25123095512390137
gc 0
Train Epoch9 Acc 0.4584666666666667 (55016/120000), AUC 0.6498763561248779
ep9_train_time 9.490912199020386
Test Epoch9 threshold 0.7 Acc 0.9134868421052632, AUC 0.9796182513237, avg_entr 0.02612621895968914
ep9_t0.7_test_time 0.2508366107940674
Best AUC 0.9808295965194702
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt
[[1371   51   73   37]
 [  11 1478    9    9]
 [  36   13 1337  114]
 [  33   14  107 1387]]
Figure(640x480)
tensor([2.9210e-03, 9.5064e-08, 2.0005e-04,  ..., 3.8986e-08, 2.5397e-06,
        2.4294e-04])
[[1375   50   71   36]
 [  10 1478    9   10]
 [  35   14 1332  119]
 [  33   14  105 1389]]
Figure(640x480)
tensor([2.7455e-03, 3.3717e-07, 2.8906e-04,  ..., 8.2568e-08, 3.8535e-06,
        1.0672e-03])
[[1373   51   72   36]
 [  10 1477    8   12]
 [  35   14 1336  115]
 [  33   13  110 1385]]
Figure(640x480)
tensor([1.2730e-03, 1.6200e-07, 1.5433e-04,  ..., 6.9311e-08, 4.7619e-06,
        2.8893e-04])
[[1374   50   70   38]
 [  10 1478    9   10]
 [  35   14 1335  116]
 [  33   13  105 1390]]
Figure(640x480)
tensor([1.2370e-03, 1.1004e-07, 1.1799e-04,  ..., 7.0244e-08, 3.0879e-06,
        1.9717e-04])
[[  44 1338  141    9]
 [   0  237 1270    0]
 [   0  166  738  596]
 [   0 1452   77   12]]
Figure(640x480)
tensor([0.8964, 0.7113, 0.7653,  ..., 0.9255, 0.6647, 0.8031])
