total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.441125 (52935/120000), AUC 0.743707537651062
ep0_train_time 77.80436253547668
Test Epoch0 threshold 0.7 Acc 0.9161184210526315, AUC 0.9807311296463013, avg_entr 0.025203999131917953
ep0_t0.7_test_time 0.25077176094055176
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.32976666666666665 (39572/120000), AUC 0.685093343257904
ep1_train_time 77.76003980636597
Test Epoch1 threshold 0.7 Acc 0.9167763157894737, AUC 0.9805375337600708, avg_entr 0.025669680908322334
ep1_t0.7_test_time 0.2487485408782959
gc 0
Train Epoch2 Acc 0.18901666666666667 (22682/120000), AUC 0.6550368070602417
ep2_train_time 77.83463025093079
Test Epoch2 threshold 0.7 Acc 0.9148026315789474, AUC 0.9804715514183044, avg_entr 0.026318803429603577
ep2_t0.7_test_time 0.24792098999023438
gc 0
Train Epoch3 Acc 0.14816666666666667 (17780/120000), AUC 0.6421657800674438
ep3_train_time 78.05586504936218
Test Epoch3 threshold 0.7 Acc 0.9151315789473684, AUC 0.9802019596099854, avg_entr 0.024719635024666786
ep3_t0.7_test_time 0.24831891059875488
gc 0
Train Epoch4 Acc 0.13756666666666667 (16508/120000), AUC 0.6332951784133911
ep4_train_time 77.6281669139862
Test Epoch4 threshold 0.7 Acc 0.9134868421052632, AUC 0.980033278465271, avg_entr 0.02558900974690914
ep4_t0.7_test_time 0.24795937538146973
gc 0
Train Epoch5 Acc 0.14581666666666668 (17498/120000), AUC 0.6407822966575623
ep5_train_time 77.69335889816284
Test Epoch5 threshold 0.7 Acc 0.9149671052631579, AUC 0.980021595954895, avg_entr 0.025914806872606277
ep5_t0.7_test_time 0.24844598770141602
gc 0
Train Epoch6 Acc 0.12458333333333334 (14950/120000), AUC 0.6338196396827698
ep6_train_time 77.79697823524475
Test Epoch6 threshold 0.7 Acc 0.9151315789473684, AUC 0.9799149632453918, avg_entr 0.02583477459847927
ep6_t0.7_test_time 0.24858999252319336
gc 0
Train Epoch7 Acc 0.120125 (14415/120000), AUC 0.632439136505127
ep7_train_time 77.61434864997864
Test Epoch7 threshold 0.7 Acc 0.9136513157894737, AUC 0.9798316359519958, avg_entr 0.026680434122681618
ep7_t0.7_test_time 0.24776053428649902
gc 0
Train Epoch8 Acc 0.13763333333333333 (16516/120000), AUC 0.6297245025634766
ep8_train_time 77.76708674430847
Test Epoch8 threshold 0.7 Acc 0.912828947368421, AUC 0.9796262979507446, avg_entr 0.0256844162940979
ep8_t0.7_test_time 0.24941563606262207
gc 0
Train Epoch9 Acc 0.12840833333333335 (15409/120000), AUC 0.6284406781196594
ep9_train_time 77.75360465049744
Test Epoch9 threshold 0.7 Acc 0.912828947368421, AUC 0.9796236157417297, avg_entr 0.025999581441283226
ep9_t0.7_test_time 0.24826383590698242
Best AUC 0.9807311296463013
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m4//ag_news_lstmal_l5_prefix.pt
[[1370   52   76   34]
 [   9 1481    9    8]
 [  34   17 1334  115]
 [  33   13  110 1385]]
Figure(640x480)
tensor([7.9033e-04, 2.6972e-07, 1.9710e-04,  ..., 4.0942e-08, 3.5029e-06,
        1.2559e-04])
[[1394   45   51   42]
 [  27 1461    9   10]
 [  52    8 1315  125]
 [  39   12  103 1387]]
Figure(640x480)
tensor([1.0012e-05, 1.4369e-07, 2.8086e-07,  ..., 2.2992e-07, 2.9928e-07,
        8.1447e-07])
[[1396   44   49   43]
 [  28 1460   10    9]
 [  52    8 1312  128]
 [  39   15  101 1386]]
Figure(640x480)
tensor([6.2653e-06, 2.9891e-07, 4.3854e-07,  ..., 2.5847e-07, 3.1670e-07,
        1.0782e-06])
[[1389   46   51   46]
 [  29 1459   12    7]
 [  51   11 1312  126]
 [  41   16  103 1381]]
Figure(640x480)
tensor([4.2094e-06, 4.1700e-07, 4.7035e-07,  ..., 1.8189e-07, 4.7445e-07,
        3.6797e-07])
[[1354   86   50   42]
 [  83   78 1346    0]
 [ 267  202 1026    5]
 [  37 1454   44    6]]
Figure(640x480)
tensor([1.3067, 0.6814, 0.6617,  ..., 1.1511, 0.6796, 1.1577])
