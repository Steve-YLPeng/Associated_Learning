total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.477775 (57333/120000), AUC 0.4115535616874695
ep0_train_time 9.927399158477783
Test Epoch0 threshold 0.6 Acc 0.915296052631579, AUC 0.9805097579956055, avg_entr 0.026050589978694916
ep0_t0.6_test_time 0.2508411407470703
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.476975 (57237/120000), AUC 0.3525349497795105
ep1_train_time 9.386111974716187
Test Epoch1 threshold 0.6 Acc 0.9149671052631579, AUC 0.9803762435913086, avg_entr 0.02596282958984375
ep1_t0.6_test_time 0.24929213523864746
gc 0
Train Epoch2 Acc 0.4695916666666667 (56351/120000), AUC 0.2772757112979889
ep2_train_time 9.401845693588257
Test Epoch2 threshold 0.6 Acc 0.9141447368421053, AUC 0.9802206754684448, avg_entr 0.02499745786190033
ep2_t0.6_test_time 0.24902987480163574
gc 0
Train Epoch3 Acc 0.40163333333333334 (48196/120000), AUC 0.26351478695869446
ep3_train_time 9.388740539550781
Test Epoch3 threshold 0.6 Acc 0.9149671052631579, AUC 0.980171799659729, avg_entr 0.025356506928801537
ep3_t0.6_test_time 0.24817132949829102
gc 0
Train Epoch4 Acc 0.31353333333333333 (37624/120000), AUC 0.26463356614112854
ep4_train_time 9.378405332565308
Test Epoch4 threshold 0.6 Acc 0.912828947368421, AUC 0.9800606966018677, avg_entr 0.02628549002110958
ep4_t0.6_test_time 0.24866151809692383
gc 0
Train Epoch5 Acc 0.2942666666666667 (35312/120000), AUC 0.2657608687877655
ep5_train_time 9.553531885147095
Test Epoch5 threshold 0.6 Acc 0.9141447368421053, AUC 0.9798911213874817, avg_entr 0.025937875732779503
ep5_t0.6_test_time 0.2598247528076172
gc 0
Train Epoch6 Acc 0.286375 (34365/120000), AUC 0.2665666937828064
ep6_train_time 9.509849786758423
Test Epoch6 threshold 0.6 Acc 0.9139802631578947, AUC 0.9797893762588501, avg_entr 0.025973360985517502
ep6_t0.6_test_time 0.2517428398132324
gc 0
Train Epoch7 Acc 0.279475 (33537/120000), AUC 0.26713305711746216
ep7_train_time 9.4266836643219
Test Epoch7 threshold 0.6 Acc 0.9129934210526316, AUC 0.9796583652496338, avg_entr 0.025577010586857796
ep7_t0.6_test_time 0.24870800971984863
gc 0
Train Epoch8 Acc 0.27253333333333335 (32704/120000), AUC 0.267673134803772
ep8_train_time 9.440796852111816
Test Epoch8 threshold 0.6 Acc 0.9133223684210526, AUC 0.9795674085617065, avg_entr 0.02646060474216938
ep8_t0.6_test_time 0.24921417236328125
gc 0
Train Epoch9 Acc 0.270525 (32463/120000), AUC 0.26764094829559326
ep9_train_time 9.47524642944336
Test Epoch9 threshold 0.6 Acc 0.9120065789473685, AUC 0.9794782400131226, avg_entr 0.025939784944057465
ep9_t0.6_test_time 0.248870849609375
Best AUC 0.9805097579956055
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt
[[1374   51   74   33]
 [  15 1477    6    9]
 [  37   12 1336  115]
 [  38   14  111 1378]]
Figure(640x480)
tensor([2.2089e-03, 1.0671e-07, 2.5568e-04,  ..., 2.6957e-08, 4.0947e-06,
        3.6311e-05])
[[1375   51   73   33]
 [  14 1478    7    8]
 [  37   13 1336  114]
 [  37   16  105 1383]]
Figure(640x480)
tensor([7.1017e-04, 1.4662e-06, 2.5311e-04,  ..., 5.9509e-08, 4.3842e-06,
        4.7372e-05])
[[1376   51   73   32]
 [  13 1478    7    9]
 [  37   16 1333  114]
 [  39   15  105 1382]]
Figure(640x480)
tensor([6.1195e-04, 7.0500e-07, 1.5276e-04,  ..., 5.0379e-08, 4.4597e-06,
        4.0515e-05])
[[1377   51   71   33]
 [  13 1478    7    9]
 [  37   13 1336  114]
 [  38   15  106 1382]]
Figure(640x480)
tensor([6.4129e-04, 5.2831e-07, 1.2075e-04,  ..., 5.7579e-08, 2.4282e-06,
        2.5631e-05])
[[1420    0    0  112]
 [  14    0    0 1493]
 [ 168   44    0 1288]
 [  76    0    0 1465]]
Figure(640x480)
tensor([0.8913, 0.3336, 0.3979,  ..., 0.2731, 0.4662, 0.7333])
