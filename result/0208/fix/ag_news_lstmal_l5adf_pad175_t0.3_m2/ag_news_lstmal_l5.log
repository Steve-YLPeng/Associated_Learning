total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.49315 (59178/120000), AUC 0.5085999965667725
ep0_train_time 56.03842806816101
Test Epoch0 threshold 0.3 Acc 0.9169407894736842, AUC 0.9802393913269043, avg_entr 0.023145467042922974
ep0_t0.3_test_time 0.3537418842315674
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m2//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.548 (65760/120000), AUC 0.5440977811813354
ep1_train_time 55.984023332595825
Test Epoch1 threshold 0.3 Acc 0.9146381578947368, AUC 0.9800851941108704, avg_entr 0.023158565163612366
ep1_t0.3_test_time 0.35294079780578613
gc 0
Train Epoch2 Acc 0.533175 (63981/120000), AUC 0.5423285961151123
ep2_train_time 56.066768646240234
Test Epoch2 threshold 0.3 Acc 0.9120065789473685, AUC 0.9802923798561096, avg_entr 0.023371294140815735
ep2_t0.3_test_time 0.34754371643066406
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m2//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.5285 (63420/120000), AUC 0.5323586463928223
ep3_train_time 56.10196089744568
Test Epoch3 threshold 0.3 Acc 0.9154605263157894, AUC 0.9800042510032654, avg_entr 0.02296026423573494
ep3_t0.3_test_time 0.3360598087310791
gc 0
Train Epoch4 Acc 0.5227916666666667 (62735/120000), AUC 0.5166133046150208
ep4_train_time 56.05084300041199
Test Epoch4 threshold 0.3 Acc 0.9120065789473685, AUC 0.97981196641922, avg_entr 0.023487618193030357
ep4_t0.3_test_time 0.332291841506958
gc 0
Train Epoch5 Acc 0.5195083333333333 (62341/120000), AUC 0.5055698156356812
ep5_train_time 56.23395133018494
Test Epoch5 threshold 0.3 Acc 0.915625, AUC 0.9797740578651428, avg_entr 0.023334452882409096
ep5_t0.3_test_time 0.3281846046447754
gc 0
Train Epoch6 Acc 0.5173833333333333 (62086/120000), AUC 0.49869319796562195
ep6_train_time 56.06844758987427
Test Epoch6 threshold 0.3 Acc 0.9131578947368421, AUC 0.9797857999801636, avg_entr 0.02397553250193596
ep6_t0.3_test_time 0.32703518867492676
gc 0
Train Epoch7 Acc 0.5082666666666666 (60992/120000), AUC 0.4912792444229126
ep7_train_time 56.05699896812439
Test Epoch7 threshold 0.3 Acc 0.9133223684210526, AUC 0.9798514246940613, avg_entr 0.024064188823103905
ep7_t0.3_test_time 0.32395434379577637
gc 0
Train Epoch8 Acc 0.4992666666666667 (59912/120000), AUC 0.48219454288482666
ep8_train_time 56.08288502693176
Test Epoch8 threshold 0.3 Acc 0.9129934210526316, AUC 0.9794550538063049, avg_entr 0.023720119148492813
ep8_t0.3_test_time 0.32090139389038086
gc 0
Train Epoch9 Acc 0.49143333333333333 (58972/120000), AUC 0.4776307940483093
ep9_train_time 56.082414627075195
Test Epoch9 threshold 0.3 Acc 0.9131578947368421, AUC 0.9795567989349365, avg_entr 0.02391166239976883
ep9_t0.3_test_time 0.31447696685791016
Best AUC 0.9802923798561096
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m2//ag_news_lstmal_l5_prefix.pt
[[1368   50   85   29]
 [  12 1473   16    6]
 [  32    9 1357  102]
 [  40   14  143 1344]]
Figure(640x480)
tensor([8.7171e-04, 2.2451e-07, 1.2838e-03,  ..., 9.1978e-08, 4.2175e-05,
        1.2425e-04])
[[1374   47   66   45]
 [  16 1466   13   12]
 [  40   11 1327  122]
 [  35   15  118 1373]]
Figure(640x480)
tensor([3.3976e-06, 5.9379e-07, 1.2664e-06,  ..., 2.9893e-07, 1.6786e-06,
        8.2900e-07])
[[  63  430 1039    0]
 [   1   42 1464    0]
 [1053  327  120    0]
 [  63  254 1224    0]]
Figure(640x480)
tensor([1.0454, 1.0167, 1.2751,  ..., 0.7138, 0.9819, 1.0423])
[[   0    0   35 1497]
 [ 127    0 1267  113]
 [   0    0    6 1494]
 [   0    0    3 1538]]
Figure(640x480)
tensor([1.0676, 1.1352, 1.0766,  ..., 1.0378, 1.1280, 1.0283])
[[1340   61    0  131]
 [1017  406    0   84]
 [  38  724    0  738]
 [  34   36    0 1471]]
Figure(640x480)
tensor([1.1865, 1.2562, 1.2922,  ..., 1.4471, 1.2744, 1.1595])
