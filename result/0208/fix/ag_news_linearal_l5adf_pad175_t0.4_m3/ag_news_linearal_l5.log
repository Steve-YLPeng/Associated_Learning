total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.07370833333333333 (8845/120000), AUC 0.2972011864185333
ep0_train_time 9.464709997177124
Test Epoch0 threshold 0.4 Acc 0.9144736842105263, AUC 0.9805476665496826, avg_entr 0.026811674237251282
ep0_t0.4_test_time 0.25594067573547363
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.038783333333333336 (4654/120000), AUC 0.2585279941558838
ep1_train_time 8.93169116973877
Test Epoch1 threshold 0.4 Acc 0.9157894736842105, AUC 0.9805607199668884, avg_entr 0.025881340727210045
ep1_t0.4_test_time 0.2534921169281006
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.02415 (2898/120000), AUC 0.2352806180715561
ep2_train_time 8.930917501449585
Test Epoch2 threshold 0.4 Acc 0.9157894736842105, AUC 0.9804757833480835, avg_entr 0.0258084274828434
ep2_t0.4_test_time 0.2537567615509033
gc 0
Train Epoch3 Acc 0.014658333333333334 (1759/120000), AUC 0.21158885955810547
ep3_train_time 8.928743600845337
Test Epoch3 threshold 0.4 Acc 0.915296052631579, AUC 0.9802026748657227, avg_entr 0.02532161958515644
ep3_t0.4_test_time 0.253753662109375
gc 0
Train Epoch4 Acc 0.008608333333333334 (1033/120000), AUC 0.19495265185832977
ep4_train_time 9.15185832977295
Test Epoch4 threshold 0.4 Acc 0.9148026315789474, AUC 0.9800821542739868, avg_entr 0.026057453826069832
ep4_t0.4_test_time 0.25226759910583496
gc 0
Train Epoch5 Acc 0.005691666666666667 (683/120000), AUC 0.1892663985490799
ep5_train_time 8.925838708877563
Test Epoch5 threshold 0.4 Acc 0.9141447368421053, AUC 0.9799023270606995, avg_entr 0.025921178981661797
ep5_t0.4_test_time 0.2524890899658203
gc 0
Train Epoch6 Acc 0.005266666666666667 (632/120000), AUC 0.183847576379776
ep6_train_time 8.81116771697998
Test Epoch6 threshold 0.4 Acc 0.9126644736842106, AUC 0.9797441363334656, avg_entr 0.025506198406219482
ep6_t0.4_test_time 0.25319337844848633
gc 0
Train Epoch7 Acc 0.004933333333333333 (592/120000), AUC 0.17644713819026947
ep7_train_time 8.841562271118164
Test Epoch7 threshold 0.4 Acc 0.9108552631578948, AUC 0.9796707630157471, avg_entr 0.025631390511989594
ep7_t0.4_test_time 0.25318098068237305
gc 0
Train Epoch8 Acc 0.005175 (621/120000), AUC 0.17330370843410492
ep8_train_time 8.835020542144775
Test Epoch8 threshold 0.4 Acc 0.9141447368421053, AUC 0.979587733745575, avg_entr 0.026332326233386993
ep8_t0.4_test_time 0.25409436225891113
gc 0
Train Epoch9 Acc 0.005033333333333333 (604/120000), AUC 0.1736864596605301
ep9_train_time 8.789144277572632
Test Epoch9 threshold 0.4 Acc 0.9118421052631579, AUC 0.9795070886611938, avg_entr 0.026516465470194817
ep9_t0.4_test_time 0.2525622844696045
Best AUC 0.9805607199668884
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt
[[1383   50   67   32]
 [  16 1477    6    8]
 [  39   14 1333  114]
 [  47   14  108 1372]]
Figure(640x480)
tensor([2.2550e-03, 7.6437e-08, 2.3213e-04,  ..., 4.2436e-08, 5.1433e-06,
        5.0777e-05])
[[1385   50   65   32]
 [  15 1477    6    9]
 [  40   13 1334  113]
 [  43   14  110 1374]]
Figure(640x480)
tensor([3.0279e-03, 1.2002e-06, 4.5764e-04,  ..., 8.6155e-08, 1.1779e-05,
        4.5217e-05])
[[1384   50   66   32]
 [  16 1477    5    9]
 [  41   14 1334  111]
 [  44   16  110 1371]]
Figure(640x480)
tensor([3.1523e-03, 6.1104e-07, 4.9115e-04,  ..., 5.4221e-08, 1.8639e-05,
        3.8184e-05])
[[   0   34 1373  125]
 [   0  654  158  695]
 [   0  982  167  351]
 [   0   13   24 1504]]
Figure(640x480)
tensor([1.2202, 0.3354, 0.6677,  ..., 1.2804, 0.5573, 1.2255])
[[   2   36    0 1494]
 [   2    2    0 1503]
 [   4   64    0 1432]
 [  73 1172    0  296]]
Figure(640x480)
tensor([0.8769, 0.4910, 1.1301,  ..., 0.6029, 1.0120, 1.0308])
