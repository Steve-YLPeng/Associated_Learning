total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.19591666666666666 (23510/120000), AUC 0.5806454420089722
ep0_train_time 9.060868978500366
Test Epoch0 threshold 0.7 Acc 0.9171052631578948, AUC 0.9810245633125305, avg_entr 0.027431923896074295
ep0_t0.7_test_time 0.2553527355194092
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.125225 (15027/120000), AUC 0.6101657748222351
ep1_train_time 8.698793172836304
Test Epoch1 threshold 0.7 Acc 0.9164473684210527, AUC 0.980966329574585, avg_entr 0.02671176753938198
ep1_t0.7_test_time 0.2531921863555908
gc 0
Train Epoch2 Acc 0.11288333333333334 (13546/120000), AUC 0.6192893981933594
ep2_train_time 8.689175844192505
Test Epoch2 threshold 0.7 Acc 0.9166118421052631, AUC 0.9806643724441528, avg_entr 0.02611779235303402
ep2_t0.7_test_time 0.25404858589172363
gc 0
Train Epoch3 Acc 0.1426 (17112/120000), AUC 0.6189408898353577
ep3_train_time 8.577331781387329
Test Epoch3 threshold 0.7 Acc 0.9126644736842106, AUC 0.9803483486175537, avg_entr 0.027127539739012718
ep3_t0.7_test_time 0.25342249870300293
gc 0
Train Epoch4 Acc 0.17315 (20778/120000), AUC 0.6180378794670105
ep4_train_time 8.641426801681519
Test Epoch4 threshold 0.7 Acc 0.9148026315789474, AUC 0.9803880453109741, avg_entr 0.026314718648791313
ep4_t0.7_test_time 0.25313448905944824
gc 0
Train Epoch5 Acc 0.184875 (22185/120000), AUC 0.6197313070297241
ep5_train_time 8.595180034637451
Test Epoch5 threshold 0.7 Acc 0.9144736842105263, AUC 0.9802307486534119, avg_entr 0.025836512446403503
ep5_t0.7_test_time 0.2533881664276123
gc 0
Train Epoch6 Acc 0.19025 (22830/120000), AUC 0.6201386451721191
ep6_train_time 8.78011155128479
Test Epoch6 threshold 0.7 Acc 0.9141447368421053, AUC 0.9800829887390137, avg_entr 0.026502059772610664
ep6_t0.7_test_time 0.25304198265075684
gc 0
Train Epoch7 Acc 0.19446666666666668 (23336/120000), AUC 0.6197967529296875
ep7_train_time 8.587596893310547
Test Epoch7 threshold 0.7 Acc 0.9126644736842106, AUC 0.9800419211387634, avg_entr 0.0272824689745903
ep7_t0.7_test_time 0.2542083263397217
gc 0
Train Epoch8 Acc 0.19935 (23922/120000), AUC 0.6194248199462891
ep8_train_time 8.619128465652466
Test Epoch8 threshold 0.7 Acc 0.9136513157894737, AUC 0.9798920154571533, avg_entr 0.026407400146126747
ep8_t0.7_test_time 0.25368213653564453
gc 0
Train Epoch9 Acc 0.20283333333333334 (24340/120000), AUC 0.6189515590667725
ep9_train_time 8.60782766342163
Test Epoch9 threshold 0.7 Acc 0.9113486842105263, AUC 0.9798025488853455, avg_entr 0.026405248790979385
ep9_t0.7_test_time 0.2536773681640625
Best AUC 0.9810245633125305
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt
[[1364   53   78   37]
 [   8 1480   10    9]
 [  34   15 1334  117]
 [  29   15   99 1398]]
Figure(640x480)
tensor([1.8791e-03, 2.0948e-06, 2.4288e-04,  ..., 7.6039e-07, 1.4552e-05,
        1.7718e-03])
[[1369   53   74   36]
 [   7 1480    9   11]
 [  33   16 1334  117]
 [  34   18  102 1387]]
Figure(640x480)
tensor([1.9878e-02, 8.9025e-06, 1.9109e-03,  ..., 2.8064e-06, 3.0378e-04,
        1.4077e-02])
[[   0    0 1532    0]
 [   0    0 1507    0]
 [   0    0 1500    0]
 [   0    0 1541    0]]
Figure(640x480)
tensor([0.8031, 1.0607, 0.9441,  ..., 0.8967, 0.9641, 0.8691])
[[   0    0 1520   12]
 [   0    0  832  675]
 [   0    0 1499    1]
 [   0    0 1540    1]]
Figure(640x480)
tensor([0.7266, 0.6405, 0.6984,  ..., 0.7810, 0.6808, 0.7255])
[[   4  497 1031    0]
 [   0  255 1252    0]
 [  14  998  488    0]
 [ 368 1106   67    0]]
Figure(640x480)
tensor([1.1130, 1.3404, 1.2621,  ..., 1.2735, 1.2620, 1.1205])
