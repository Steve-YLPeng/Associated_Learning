total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.9_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.21216666666666667 (25460/120000), AUC 0.4444134831428528
ep0_train_time 67.00974631309509
Test Epoch0 threshold 0.9 Acc 0.9185855263157895, AUC 0.9809435606002808, avg_entr 0.025391781702637672
ep0_t0.9_test_time 0.25710463523864746
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.9_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2008 (24096/120000), AUC 0.42916202545166016
ep1_train_time 67.06456589698792
Test Epoch1 threshold 0.9 Acc 0.9115131578947369, AUC 0.9807819128036499, avg_entr 0.026162803173065186
ep1_t0.9_test_time 0.2566807270050049
gc 0
Train Epoch2 Acc 0.16666666666666666 (20000/120000), AUC 0.43162617087364197
ep2_train_time 67.0962564945221
Test Epoch2 threshold 0.9 Acc 0.9143092105263158, AUC 0.9805787205696106, avg_entr 0.0249931663274765
ep2_t0.9_test_time 0.2559182643890381
gc 0
Train Epoch3 Acc 0.14710833333333334 (17653/120000), AUC 0.4678139388561249
ep3_train_time 67.12546038627625
Test Epoch3 threshold 0.9 Acc 0.9134868421052632, AUC 0.9804702997207642, avg_entr 0.02590823359787464
ep3_t0.9_test_time 0.2550649642944336
gc 0
Train Epoch4 Acc 0.09428333333333333 (11314/120000), AUC 0.5234899520874023
ep4_train_time 67.14388728141785
Test Epoch4 threshold 0.9 Acc 0.9146381578947368, AUC 0.9802156090736389, avg_entr 0.025610044598579407
ep4_t0.9_test_time 0.2547135353088379
gc 0
Train Epoch5 Acc 0.086675 (10401/120000), AUC 0.5562766790390015
ep5_train_time 67.10026621818542
Test Epoch5 threshold 0.9 Acc 0.9141447368421053, AUC 0.9802006483078003, avg_entr 0.02579553797841072
ep5_t0.9_test_time 0.25539326667785645
gc 0
Train Epoch6 Acc 0.08305833333333333 (9967/120000), AUC 0.5803521275520325
ep6_train_time 67.11117696762085
Test Epoch6 threshold 0.9 Acc 0.9134868421052632, AUC 0.9800589680671692, avg_entr 0.025065315887331963
ep6_t0.9_test_time 0.256131649017334
gc 0
Train Epoch7 Acc 0.08363333333333334 (10036/120000), AUC 0.5984797477722168
ep7_train_time 67.1087896823883
Test Epoch7 threshold 0.9 Acc 0.9133223684210526, AUC 0.9799697399139404, avg_entr 0.02566814422607422
ep7_t0.9_test_time 0.25862717628479004
gc 0
Train Epoch8 Acc 0.0972 (11664/120000), AUC 0.6132324934005737
ep8_train_time 67.1335289478302
Test Epoch8 threshold 0.9 Acc 0.9129934210526316, AUC 0.9798188805580139, avg_entr 0.025765955448150635
ep8_t0.9_test_time 0.25516366958618164
gc 0
Train Epoch9 Acc 0.089825 (10779/120000), AUC 0.6179264783859253
ep9_train_time 67.1900806427002
Test Epoch9 threshold 0.9 Acc 0.9146381578947368, AUC 0.979816198348999, avg_entr 0.026024652644991875
ep9_t0.9_test_time 0.2554924488067627
Best AUC 0.9809435606002808
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.9_m3//ag_news_lstmal_l5_prefix.pt
[[1387   50   63   32]
 [  12 1485    2    8]
 [  40   17 1313  130]
 [  38   16   87 1400]]
Figure(640x480)
tensor([2.8858e-03, 1.2789e-07, 9.2600e-05,  ..., 8.8242e-08, 2.1403e-06,
        1.9733e-04])
[[1356   44   83   49]
 [  13 1471   12   11]
 [  31    9 1337  123]
 [  30   14  114 1383]]
Figure(640x480)
tensor([3.6060e-07, 3.5111e-07, 5.0663e-07,  ..., 1.5711e-07, 6.8982e-07,
        8.5028e-07])
[[1350   45   85   52]
 [  14 1466   17   10]
 [  31    9 1339  121]
 [  28   14  121 1378]]
Figure(640x480)
tensor([5.8964e-07, 3.5876e-07, 7.9540e-07,  ..., 1.8752e-07, 5.1111e-07,
        8.9423e-07])
[[   0 1487    0   45]
 [   7 1161    0  339]
 [   4  864    0  632]
 [  17 1225    0  299]]
Figure(640x480)
tensor([0.6874, 1.2951, 1.2753,  ..., 0.9504, 1.2633, 0.7984])
[[  10  190    0 1332]
 [ 280 1219    0    8]
 [   0 1474    0   26]
 [   3 1453    0   85]]
Figure(640x480)
tensor([1.0087, 0.9767, 1.0101,  ..., 1.4304, 1.0357, 1.0793])
