total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.24765 (29718/120000), AUC 0.4596615433692932
ep0_train_time 8.886625528335571
Test Epoch0 threshold 0.1 Acc 0.9162828947368421, AUC 0.98080974817276, avg_entr 0.026162242516875267
ep0_t0.1_test_time 0.26070213317871094
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24578333333333333 (29494/120000), AUC 0.42188143730163574
ep1_train_time 8.36100697517395
Test Epoch1 threshold 0.1 Acc 0.912828947368421, AUC 0.9807369112968445, avg_entr 0.02583833411335945
ep1_t0.1_test_time 0.2587471008300781
gc 0
Train Epoch2 Acc 0.24760833333333335 (29713/120000), AUC 0.4249710738658905
ep2_train_time 8.480065107345581
Test Epoch2 threshold 0.1 Acc 0.9133223684210526, AUC 0.9807377457618713, avg_entr 0.025241484865546227
ep2_t0.1_test_time 0.2564883232116699
gc 0
Train Epoch3 Acc 0.248525 (29823/120000), AUC 0.42968717217445374
ep3_train_time 8.52423906326294
Test Epoch3 threshold 0.1 Acc 0.9148026315789474, AUC 0.9805585145950317, avg_entr 0.025959672406315804
ep3_t0.1_test_time 0.257094144821167
gc 0
Train Epoch4 Acc 0.2501 (30012/120000), AUC 0.4310644268989563
ep4_train_time 8.484233379364014
Test Epoch4 threshold 0.1 Acc 0.9138157894736842, AUC 0.9804437756538391, avg_entr 0.024792704731225967
ep4_t0.1_test_time 0.2570493221282959
gc 0
Train Epoch5 Acc 0.251475 (30177/120000), AUC 0.43188023567199707
ep5_train_time 8.436185359954834
Test Epoch5 threshold 0.1 Acc 0.9154605263157894, AUC 0.9803919196128845, avg_entr 0.025556063279509544
ep5_t0.1_test_time 0.2573401927947998
gc 0
Train Epoch6 Acc 0.2541833333333333 (30502/120000), AUC 0.4317697584629059
ep6_train_time 8.579450845718384
Test Epoch6 threshold 0.1 Acc 0.9113486842105263, AUC 0.980272650718689, avg_entr 0.02508697472512722
ep6_t0.1_test_time 0.2569122314453125
gc 0
Train Epoch7 Acc 0.2592083333333333 (31105/120000), AUC 0.43171826004981995
ep7_train_time 8.372007369995117
Test Epoch7 threshold 0.1 Acc 0.9151315789473684, AUC 0.9801430702209473, avg_entr 0.024743448942899704
ep7_t0.1_test_time 0.2566673755645752
gc 0
Train Epoch8 Acc 0.26511666666666667 (31814/120000), AUC 0.43136781454086304
ep8_train_time 8.681913137435913
Test Epoch8 threshold 0.1 Acc 0.9141447368421053, AUC 0.9800912141799927, avg_entr 0.0250035859644413
ep8_t0.1_test_time 0.25665736198425293
gc 0
Train Epoch9 Acc 0.2658333333333333 (31900/120000), AUC 0.4312412738800049
ep9_train_time 8.54076337814331
Test Epoch9 threshold 0.1 Acc 0.9143092105263158, AUC 0.9800108671188354, avg_entr 0.025793546810746193
ep9_t0.1_test_time 0.2561984062194824
Best AUC 0.98080974817276
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt
[[1372   54   72   34]
 [  10 1484    5    8]
 [  37   15 1332  116]
 [  40   16   91 1394]]
Figure(640x480)
tensor([3.8850e-03, 3.4189e-06, 6.7847e-04,  ..., 1.4789e-06, 1.0285e-05,
        1.8134e-03])
[[1373   53   71   35]
 [  12 1481    3   11]
 [  38   16 1322  124]
 [  42   16   95 1388]]
Figure(640x480)
tensor([2.6460e-02, 1.6409e-05, 2.0841e-03,  ..., 3.9827e-06, 1.0301e-04,
        4.8281e-03])
[[  44    0    0 1488]
 [1050    0    0  457]
 [ 900    0    0  600]
 [ 115    0    0 1426]]
Figure(640x480)
tensor([0.9407, 1.0909, 1.0274,  ..., 1.1692, 1.0348, 0.9273])
[[   0    0    2 1530]
 [   0    0    1 1506]
 [   0    0   29 1471]
 [   0    0  735  806]]
Figure(640x480)
tensor([1.1356, 1.3671, 1.3287,  ..., 1.3818, 1.2900, 1.2144])
[[1481    0    0   51]
 [  71    0    0 1436]
 [1495    1    0    4]
 [1530    6    0    5]]
Figure(640x480)
tensor([0.8854, 1.0002, 1.0823,  ..., 1.2456, 1.0066, 0.8650])
