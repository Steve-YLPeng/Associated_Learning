total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.29375833333333334 (35251/120000), AUC 0.8500871062278748
ep0_train_time 66.85103297233582
Test Epoch0 threshold 0.7 Acc 0.9164473684210527, AUC 0.9808464050292969, avg_entr 0.026315147057175636
ep0_t0.7_test_time 0.25162339210510254
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2786 (33432/120000), AUC 0.8225202560424805
ep1_train_time 66.9119234085083
Test Epoch1 threshold 0.7 Acc 0.9184210526315789, AUC 0.9806724786758423, avg_entr 0.025922127068042755
ep1_t0.7_test_time 0.24979066848754883
gc 0
Train Epoch2 Acc 0.287325 (34479/120000), AUC 0.7807145118713379
ep2_train_time 66.90890693664551
Test Epoch2 threshold 0.7 Acc 0.9154605263157894, AUC 0.9806992411613464, avg_entr 0.02507227286696434
ep2_t0.7_test_time 0.251192569732666
gc 0
Train Epoch3 Acc 0.29155 (34986/120000), AUC 0.7538003921508789
ep3_train_time 66.97877764701843
Test Epoch3 threshold 0.7 Acc 0.9154605263157894, AUC 0.980462372303009, avg_entr 0.026158669963479042
ep3_t0.7_test_time 0.25009584426879883
gc 0
Train Epoch4 Acc 0.3123 (37476/120000), AUC 0.7389888763427734
ep4_train_time 66.93494486808777
Test Epoch4 threshold 0.7 Acc 0.9151315789473684, AUC 0.9804078936576843, avg_entr 0.025870906189084053
ep4_t0.7_test_time 0.24974489212036133
gc 0
Train Epoch5 Acc 0.33140833333333336 (39769/120000), AUC 0.7211059927940369
ep5_train_time 66.98225593566895
Test Epoch5 threshold 0.7 Acc 0.9154605263157894, AUC 0.9801986217498779, avg_entr 0.026126088574528694
ep5_t0.7_test_time 0.250225305557251
gc 0
Train Epoch6 Acc 0.33295833333333336 (39955/120000), AUC 0.7023831009864807
ep6_train_time 66.920485496521
Test Epoch6 threshold 0.7 Acc 0.9146381578947368, AUC 0.9800307750701904, avg_entr 0.02628619596362114
ep6_t0.7_test_time 0.2494678497314453
gc 0
Train Epoch7 Acc 0.34336666666666665 (41204/120000), AUC 0.694665789604187
ep7_train_time 66.91066265106201
Test Epoch7 threshold 0.7 Acc 0.9120065789473685, AUC 0.9799553155899048, avg_entr 0.025874456390738487
ep7_t0.7_test_time 0.2503495216369629
gc 0
Train Epoch8 Acc 0.3594833333333333 (43138/120000), AUC 0.6890260577201843
ep8_train_time 66.9072015285492
Test Epoch8 threshold 0.7 Acc 0.9148026315789474, AUC 0.9798479676246643, avg_entr 0.025862600654363632
ep8_t0.7_test_time 0.2507157325744629
gc 0
Train Epoch9 Acc 0.3729166666666667 (44750/120000), AUC 0.682059645652771
ep9_train_time 67.27948045730591
Test Epoch9 threshold 0.7 Acc 0.9138157894736842, AUC 0.9797686338424683, avg_entr 0.025801053270697594
ep9_t0.7_test_time 0.25045132637023926
Best AUC 0.9808464050292969
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m3//ag_news_lstmal_l5_prefix.pt
[[1368   50   81   33]
 [  10 1477    9   11]
 [  33    9 1349  109]
 [  38   11  114 1378]]
Figure(640x480)
tensor([5.5123e-04, 2.5869e-07, 2.1244e-04,  ..., 1.1511e-07, 8.8887e-06,
        1.4128e-04])
[[1364   49   78   41]
 [  13 1470   14   10]
 [  33    7 1337  123]
 [  37   13  117 1374]]
Figure(640x480)
tensor([7.7979e-07, 5.5001e-07, 9.5651e-07,  ..., 2.1099e-07, 1.1693e-06,
        7.8808e-07])
[[1365   49   77   41]
 [  16 1466   15   10]
 [  32    7 1339  122]
 [  36   14  125 1366]]
Figure(640x480)
tensor([7.2335e-07, 7.8364e-07, 1.2137e-06,  ..., 2.0066e-07, 9.4845e-07,
        6.4113e-07])
[[1439    0   78   15]
 [  21    0 1478    8]
 [1354    0   64   82]
 [ 390    0 1147    4]]
Figure(640x480)
tensor([1.1944, 0.7985, 0.8357,  ..., 0.4837, 0.7755, 1.1772])
[[   0 1115    0  417]
 [   0 1505    0    2]
 [   0 1310  162   28]
 [   0 1536    3    2]]
Figure(640x480)
tensor([1.2361, 0.7496, 0.7815,  ..., 1.1260, 0.7885, 1.1640])
