total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.023366666666666668 (2804/120000), AUC 0.21834757924079895
ep0_train_time 9.782596826553345
Test Epoch0 threshold 0.4 Acc 0.9157894736842105, AUC 0.9803019762039185, avg_entr 0.02560730278491974
ep0_t0.4_test_time 0.25646018981933594
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.018133333333333335 (2176/120000), AUC 0.12765012681484222
ep1_train_time 9.393344640731812
Test Epoch1 threshold 0.4 Acc 0.9141447368421053, AUC 0.9801900386810303, avg_entr 0.025073666125535965
ep1_t0.4_test_time 0.2550215721130371
gc 0
Train Epoch2 Acc 0.016633333333333333 (1996/120000), AUC 0.21873442828655243
ep2_train_time 9.372890710830688
Test Epoch2 threshold 0.4 Acc 0.9151315789473684, AUC 0.9800342917442322, avg_entr 0.02552826702594757
ep2_t0.4_test_time 0.25458717346191406
gc 0
Train Epoch3 Acc 0.017841666666666665 (2141/120000), AUC 0.3635101914405823
ep3_train_time 9.412129640579224
Test Epoch3 threshold 0.4 Acc 0.9125, AUC 0.9798999428749084, avg_entr 0.025283822789788246
ep3_t0.4_test_time 0.2558634281158447
gc 0
Train Epoch4 Acc 0.016966666666666668 (2036/120000), AUC 0.39012402296066284
ep4_train_time 9.518311977386475
Test Epoch4 threshold 0.4 Acc 0.9131578947368421, AUC 0.9797396659851074, avg_entr 0.025737551972270012
ep4_t0.4_test_time 0.25324201583862305
gc 0
Train Epoch5 Acc 0.013991666666666666 (1679/120000), AUC 0.34916606545448303
ep5_train_time 9.502380132675171
Test Epoch5 threshold 0.4 Acc 0.9113486842105263, AUC 0.9795865416526794, avg_entr 0.025945214554667473
ep5_t0.4_test_time 0.2538115978240967
gc 0
Train Epoch6 Acc 0.01345 (1614/120000), AUC 0.3260984420776367
ep6_train_time 9.43005084991455
Test Epoch6 threshold 0.4 Acc 0.9113486842105263, AUC 0.9794788956642151, avg_entr 0.025283312425017357
ep6_t0.4_test_time 0.25208187103271484
gc 0
Train Epoch7 Acc 0.012875 (1545/120000), AUC 0.31378641724586487
ep7_train_time 9.38559365272522
Test Epoch7 threshold 0.4 Acc 0.9136513157894737, AUC 0.9794483184814453, avg_entr 0.02571866475045681
ep7_t0.4_test_time 0.2537119388580322
gc 0
Train Epoch8 Acc 0.012458333333333333 (1495/120000), AUC 0.30638930201530457
ep8_train_time 9.453976392745972
Test Epoch8 threshold 0.4 Acc 0.9110197368421052, AUC 0.9793453216552734, avg_entr 0.025972718372941017
ep8_t0.4_test_time 0.2520737648010254
gc 0
Train Epoch9 Acc 0.011991666666666666 (1439/120000), AUC 0.3034406304359436
ep9_train_time 9.456771612167358
Test Epoch9 threshold 0.4 Acc 0.9113486842105263, AUC 0.979259729385376, avg_entr 0.025860676541924477
ep9_t0.4_test_time 0.2515530586242676
Best AUC 0.9803019762039185
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt
[[1375   51   72   34]
 [  13 1477    8    9]
 [  35   13 1337  115]
 [  36   14  108 1383]]
Figure(640x480)
tensor([1.5824e-03, 7.1078e-08, 1.0216e-04,  ..., 2.4281e-08, 6.6942e-06,
        7.0758e-05])
[[1375   51   71   35]
 [  12 1478    8    9]
 [  34   15 1332  119]
 [  37   13  107 1384]]
Figure(640x480)
tensor([1.7000e-03, 9.5740e-07, 1.5527e-04,  ..., 4.3054e-08, 1.2536e-05,
        7.2023e-05])
[[1371   52   72   37]
 [  12 1478    7   10]
 [  33   14 1329  124]
 [  34   14   99 1394]]
Figure(640x480)
tensor([1.5301e-03, 2.3522e-07, 6.6588e-05,  ..., 3.1379e-08, 8.5469e-06,
        7.9390e-05])
[[1374   51   72   35]
 [  15 1475    6   11]
 [  35   13 1328  124]
 [  36   13  102 1390]]
Figure(640x480)
tensor([2.1900e-03, 1.7689e-07, 3.3225e-05,  ..., 3.8101e-08, 6.1921e-06,
        7.3992e-05])
[[  98    0    0 1434]
 [ 904    0    0  603]
 [ 152    0    0 1348]
 [1436    0    0  105]]
Figure(640x480)
tensor([0.7071, 0.4495, 0.7128,  ..., 0.2938, 0.6751, 0.8404])
