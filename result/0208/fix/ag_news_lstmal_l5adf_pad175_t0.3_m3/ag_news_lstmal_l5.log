total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.076175 (9141/120000), AUC 0.39743298292160034
ep0_train_time 66.7646312713623
Test Epoch0 threshold 0.3 Acc 0.9151315789473684, AUC 0.9801145195960999, avg_entr 0.022883841767907143
ep0_t0.3_test_time 0.347245454788208
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.08358333333333333 (10030/120000), AUC 0.3917541801929474
ep1_train_time 66.80532956123352
Test Epoch1 threshold 0.3 Acc 0.9161184210526315, AUC 0.9800070524215698, avg_entr 0.022807851433753967
ep1_t0.3_test_time 0.34710264205932617
gc 0
Train Epoch2 Acc 0.04624166666666667 (5549/120000), AUC 0.3559821546077728
ep2_train_time 67.00137543678284
Test Epoch2 threshold 0.3 Acc 0.9159539473684211, AUC 0.9797677397727966, avg_entr 0.022621992975473404
ep2_t0.3_test_time 0.3484001159667969
gc 0
Train Epoch3 Acc 0.025558333333333332 (3067/120000), AUC 0.36470794677734375
ep3_train_time 66.85953998565674
Test Epoch3 threshold 0.3 Acc 0.912828947368421, AUC 0.9796832799911499, avg_entr 0.022804005071520805
ep3_t0.3_test_time 0.34836316108703613
gc 0
Train Epoch4 Acc 0.017141666666666666 (2057/120000), AUC 0.34932568669319153
ep4_train_time 66.76051497459412
Test Epoch4 threshold 0.3 Acc 0.9139802631578947, AUC 0.9795690774917603, avg_entr 0.022809315472841263
ep4_t0.3_test_time 0.3292715549468994
gc 0
Train Epoch5 Acc 0.015466666666666667 (1856/120000), AUC 0.3299449682235718
ep5_train_time 66.76216053962708
Test Epoch5 threshold 0.3 Acc 0.9133223684210526, AUC 0.9795700907707214, avg_entr 0.023119859397411346
ep5_t0.3_test_time 0.3229207992553711
gc 0
Train Epoch6 Acc 0.015575 (1869/120000), AUC 0.32503771781921387
ep6_train_time 66.83920288085938
Test Epoch6 threshold 0.3 Acc 0.9125, AUC 0.9792525172233582, avg_entr 0.023015301674604416
ep6_t0.3_test_time 0.32441020011901855
gc 0
Train Epoch7 Acc 0.015358333333333333 (1843/120000), AUC 0.32013773918151855
ep7_train_time 66.82804918289185
Test Epoch7 threshold 0.3 Acc 0.9118421052631579, AUC 0.9790307283401489, avg_entr 0.022891249507665634
ep7_t0.3_test_time 0.3383622169494629
gc 0
Train Epoch8 Acc 0.016233333333333332 (1948/120000), AUC 0.31370237469673157
ep8_train_time 66.79549098014832
Test Epoch8 threshold 0.3 Acc 0.9121710526315789, AUC 0.9790486097335815, avg_entr 0.02310003712773323
ep8_t0.3_test_time 0.31841111183166504
gc 0
Train Epoch9 Acc 0.016833333333333332 (2020/120000), AUC 0.30626827478408813
ep9_train_time 66.83564686775208
Test Epoch9 threshold 0.3 Acc 0.9110197368421052, AUC 0.9789208769798279, avg_entr 0.023188238963484764
ep9_t0.3_test_time 0.3225092887878418
Best AUC 0.9801145195960999
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m3//ag_news_lstmal_l5_prefix.pt
[[1380   51   71   30]
 [  12 1480    8    7]
 [  38   17 1334  111]
 [  42   19  109 1371]]
Figure(640x480)
tensor([1.6451e-03, 1.5059e-07, 5.3294e-04,  ..., 2.6276e-08, 8.0667e-06,
        1.9270e-04])
[[1377   47   67   41]
 [  18 1469   12    8]
 [  43   12 1338  107]
 [  38   15  131 1357]]
Figure(640x480)
tensor([1.7353e-06, 3.9706e-07, 1.1331e-06,  ..., 1.2262e-07, 1.3705e-06,
        4.1568e-07])
[[1377   47   66   42]
 [  18 1466   15    8]
 [  41   11 1337  111]
 [  43   14  124 1360]]
Figure(640x480)
tensor([7.5372e-07, 6.6003e-07, 1.7707e-06,  ..., 1.3362e-07, 1.4914e-06,
        4.7251e-07])
[[1315    0    9  208]
 [1111    0  329   67]
 [  19    0    5 1476]
 [  20    0    1 1520]]
Figure(640x480)
tensor([0.8050, 0.7231, 0.7617,  ..., 0.9117, 0.7792, 0.8987])
[[  38   41    0 1453]
 [  52  381    0 1074]
 [1020  114    0  366]
 [  51 1332    0  158]]
Figure(640x480)
tensor([1.3263, 0.9677, 0.9635,  ..., 1.4221, 0.9736, 1.2983])
