total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9275333333333333 (111304/120000), AUC 0.9876483678817749
ep0_train_time 10.431895732879639
Test Epoch0 threshold 0.3 Acc 0.9136513157894737, AUC 0.9805739521980286, avg_entr 0.024783460423350334
ep0_t0.3_test_time 0.266282320022583
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9504666666666667 (114056/120000), AUC 0.9934556484222412
ep1_train_time 9.864740133285522
Test Epoch1 threshold 0.3 Acc 0.9143092105263158, AUC 0.9804872870445251, avg_entr 0.023842737078666687
ep1_t0.3_test_time 0.26313018798828125
gc 0
Train Epoch2 Acc 0.9516333333333333 (114196/120000), AUC 0.9935467839241028
ep2_train_time 9.84627890586853
Test Epoch2 threshold 0.3 Acc 0.9131578947368421, AUC 0.9800833463668823, avg_entr 0.024338679388165474
ep2_t0.3_test_time 0.26340246200561523
gc 0
Train Epoch3 Acc 0.9527166666666667 (114326/120000), AUC 0.9937037229537964
ep3_train_time 9.95050048828125
Test Epoch3 threshold 0.3 Acc 0.912828947368421, AUC 0.980079174041748, avg_entr 0.024470770731568336
ep3_t0.3_test_time 0.2632291316986084
gc 0
Train Epoch4 Acc 0.9536583333333334 (114439/120000), AUC 0.9940481185913086
ep4_train_time 9.839946508407593
Test Epoch4 threshold 0.3 Acc 0.9105263157894737, AUC 0.979887843132019, avg_entr 0.025889206677675247
ep4_t0.3_test_time 0.26148056983947754
gc 0
Train Epoch5 Acc 0.9552666666666667 (114632/120000), AUC 0.9946210384368896
ep5_train_time 9.941486597061157
Test Epoch5 threshold 0.3 Acc 0.9123355263157895, AUC 0.9798884391784668, avg_entr 0.02508332021534443
ep5_t0.3_test_time 0.26265406608581543
gc 0
Train Epoch6 Acc 0.956125 (114735/120000), AUC 0.9946970343589783
ep6_train_time 9.908473253250122
Test Epoch6 threshold 0.3 Acc 0.9113486842105263, AUC 0.9797366857528687, avg_entr 0.02531563863158226
ep6_t0.3_test_time 0.2619001865386963
gc 0
Train Epoch7 Acc 0.9562166666666667 (114746/120000), AUC 0.9948123693466187
ep7_train_time 9.927846193313599
Test Epoch7 threshold 0.3 Acc 0.9105263157894737, AUC 0.9796884655952454, avg_entr 0.02451077476143837
ep7_t0.3_test_time 0.2619328498840332
gc 0
Train Epoch8 Acc 0.9568583333333334 (114823/120000), AUC 0.9949353337287903
ep8_train_time 9.878519058227539
Test Epoch8 threshold 0.3 Acc 0.9129934210526316, AUC 0.9796202182769775, avg_entr 0.02527078241109848
ep8_t0.3_test_time 0.2618257999420166
gc 0
Train Epoch9 Acc 0.9575666666666667 (114908/120000), AUC 0.995204508304596
ep9_train_time 10.132830142974854
Test Epoch9 threshold 0.3 Acc 0.9106907894736842, AUC 0.9795033931732178, avg_entr 0.02492598444223404
ep9_t0.3_test_time 0.2612624168395996
Best AUC 0.9805739521980286
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m5//ag_news_linearal_l5_prefix.pt
[[1376   51   75   30]
 [  12 1478   10    7]
 [  34   14 1343  109]
 [  38   16  124 1363]]
Figure(640x480)
tensor([8.3203e-04, 6.5071e-08, 2.9400e-04,  ..., 2.1574e-08, 1.1943e-05,
        3.8912e-05])
[[1376   51   73   32]
 [  11 1479   10    7]
 [  35   13 1342  110]
 [  39   16  121 1365]]
Figure(640x480)
tensor([9.9993e-04, 8.0106e-07, 3.8694e-04,  ..., 3.3816e-08, 1.5781e-05,
        1.2086e-04])
[[1377   51   71   33]
 [  12 1478   10    7]
 [  36   13 1341  110]
 [  35   17  116 1373]]
Figure(640x480)
tensor([4.1008e-04, 6.0660e-07, 1.0109e-04,  ..., 1.7528e-08, 4.3450e-06,
        4.3174e-05])
[[1377   51   72   32]
 [  15 1476   10    6]
 [  34   15 1341  110]
 [  36   16  123 1366]]
Figure(640x480)
tensor([7.7872e-05, 2.7488e-08, 3.5645e-05,  ..., 2.0317e-08, 1.8152e-06,
        1.7452e-06])
[[1377   51   71   33]
 [  15 1477    9    6]
 [  35   13 1343  109]
 [  36   17  122 1366]]
Figure(640x480)
tensor([7.4830e-05, 4.7004e-08, 4.0456e-05,  ..., 2.6650e-08, 2.6419e-06,
        2.7875e-06])
