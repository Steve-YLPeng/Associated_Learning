total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.8_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9288 (111456/120000), AUC 0.9850621819496155
ep0_train_time 88.46848940849304
Test Epoch0 threshold 0.8 Acc 0.9159539473684211, AUC 0.9804008603096008, avg_entr 0.025217829272150993
ep0_t0.8_test_time 0.2513234615325928
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.8_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9565166666666667 (114782/120000), AUC 0.9921460151672363
ep1_train_time 88.33364939689636
Test Epoch1 threshold 0.8 Acc 0.9129934210526316, AUC 0.9802914261817932, avg_entr 0.02503718063235283
ep1_t0.8_test_time 0.2500641345977783
gc 0
Train Epoch2 Acc 0.9594166666666667 (115130/120000), AUC 0.9924362301826477
ep2_train_time 88.32704520225525
Test Epoch2 threshold 0.8 Acc 0.9143092105263158, AUC 0.9801332354545593, avg_entr 0.02618609182536602
ep2_t0.8_test_time 0.25053977966308594
gc 0
Train Epoch3 Acc 0.9615666666666667 (115388/120000), AUC 0.9928296208381653
ep3_train_time 88.32185220718384
Test Epoch3 threshold 0.8 Acc 0.9144736842105263, AUC 0.9800016283988953, avg_entr 0.026229610666632652
ep3_t0.8_test_time 0.24966025352478027
gc 0
Train Epoch4 Acc 0.9634166666666667 (115610/120000), AUC 0.9931835532188416
ep4_train_time 88.44607949256897
Test Epoch4 threshold 0.8 Acc 0.9138157894736842, AUC 0.9800333976745605, avg_entr 0.02644231729209423
ep4_t0.8_test_time 0.24972796440124512
gc 0
Train Epoch5 Acc 0.9669833333333333 (116038/120000), AUC 0.9939504265785217
ep5_train_time 88.33580923080444
Test Epoch5 threshold 0.8 Acc 0.9136513157894737, AUC 0.9797984957695007, avg_entr 0.025788264349102974
ep5_t0.8_test_time 0.2490677833557129
gc 0
Train Epoch6 Acc 0.968325 (116199/120000), AUC 0.994056761264801
ep6_train_time 88.32001829147339
Test Epoch6 threshold 0.8 Acc 0.9131578947368421, AUC 0.9796476364135742, avg_entr 0.02599075436592102
ep6_t0.8_test_time 0.2540433406829834
gc 0
Train Epoch7 Acc 0.9692666666666667 (116312/120000), AUC 0.994120717048645
ep7_train_time 88.47853136062622
Test Epoch7 threshold 0.8 Acc 0.9123355263157895, AUC 0.9795396327972412, avg_entr 0.025747189298272133
ep7_t0.8_test_time 0.2493302822113037
gc 0
Train Epoch8 Acc 0.9704333333333334 (116452/120000), AUC 0.9942572116851807
ep8_train_time 88.38933157920837
Test Epoch8 threshold 0.8 Acc 0.912828947368421, AUC 0.9794262647628784, avg_entr 0.02629661373794079
ep8_t0.8_test_time 0.24975061416625977
gc 0
Train Epoch9 Acc 0.9722416666666667 (116669/120000), AUC 0.9944955706596375
ep9_train_time 88.51882696151733
Test Epoch9 threshold 0.8 Acc 0.9131578947368421, AUC 0.9793615341186523, avg_entr 0.025302410125732422
ep9_t0.8_test_time 0.24936676025390625
Best AUC 0.9804008603096008
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.8_m5//ag_news_lstmal_l5_prefix.pt
[[1366   50   76   40]
 [  12 1475    9   11]
 [  33   11 1336  120]
 [  34   11  104 1392]]
Figure(640x480)
tensor([5.5181e-04, 4.3739e-08, 2.4751e-04,  ..., 2.0304e-08, 1.2299e-06,
        1.8997e-04])
[[1390   46   60   36]
 [  15 1463   19   10]
 [  47    9 1339  105]
 [  48   11  141 1341]]
Figure(640x480)
tensor([6.4334e-07, 2.2141e-07, 3.1263e-07,  ..., 5.2380e-08, 6.3071e-07,
        3.3011e-07])
[[1390   44   59   39]
 [  16 1461   21    9]
 [  50    8 1340  102]
 [  49   12  146 1334]]
Figure(640x480)
tensor([6.7054e-07, 1.8725e-07, 4.5546e-07,  ..., 5.5379e-08, 3.7543e-07,
        3.2237e-07])
[[1379   46   67   40]
 [  15 1462   21    9]
 [  45    8 1348   99]
 [  47   12  152 1330]]
Figure(640x480)
tensor([5.0025e-07, 4.3555e-07, 6.5336e-07,  ..., 2.2678e-07, 4.0548e-07,
        2.5909e-07])
[[1383   46   65   38]
 [  18 1459   20   10]
 [  47    9 1335  109]
 [  47   12  147 1335]]
Figure(640x480)
tensor([2.4316e-06, 3.8470e-07, 7.2342e-07,  ..., 2.7208e-07, 4.5521e-07,
        8.7787e-07])
