total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.6_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.31285664439201355
ep0_train_time 77.39920973777771
Test Epoch0 threshold 0.6 Acc 0.9151315789473684, AUC 0.9803614020347595, avg_entr 0.025861553847789764
ep0_t0.6_test_time 0.25177979469299316
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.6_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25000833333333333 (30001/120000), AUC 0.3194728493690491
ep1_train_time 77.3807463645935
Test Epoch1 threshold 0.6 Acc 0.9146381578947368, AUC 0.9801600575447083, avg_entr 0.025494789704680443
ep1_t0.6_test_time 0.24927091598510742
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.32569923996925354
ep2_train_time 77.44000339508057
Test Epoch2 threshold 0.6 Acc 0.912828947368421, AUC 0.9800739884376526, avg_entr 0.025739170610904694
ep2_t0.6_test_time 0.24909687042236328
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.3359907865524292
ep3_train_time 77.53830814361572
Test Epoch3 threshold 0.6 Acc 0.9126644736842106, AUC 0.9799047708511353, avg_entr 0.025702759623527527
ep3_t0.6_test_time 0.24926066398620605
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.34874269366264343
ep4_train_time 77.46777772903442
Test Epoch4 threshold 0.6 Acc 0.9143092105263158, AUC 0.9797691702842712, avg_entr 0.025110727176070213
ep4_t0.6_test_time 0.2492661476135254
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.3618963658809662
ep5_train_time 77.37336850166321
Test Epoch5 threshold 0.6 Acc 0.9143092105263158, AUC 0.9796642661094666, avg_entr 0.025527197867631912
ep5_t0.6_test_time 0.24951171875
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.36515048146247864
ep6_train_time 77.45813202857971
Test Epoch6 threshold 0.6 Acc 0.9138157894736842, AUC 0.9795066118240356, avg_entr 0.02606051042675972
ep6_t0.6_test_time 0.2497265338897705
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.3704639971256256
ep7_train_time 77.51226019859314
Test Epoch7 threshold 0.6 Acc 0.9134868421052632, AUC 0.9795193672180176, avg_entr 0.026206161826848984
ep7_t0.6_test_time 0.24920344352722168
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.3738914430141449
ep8_train_time 77.4319896697998
Test Epoch8 threshold 0.6 Acc 0.912828947368421, AUC 0.9792884588241577, avg_entr 0.026133481413125992
ep8_t0.6_test_time 0.25006103515625
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.3780521750450134
ep9_train_time 77.52770614624023
Test Epoch9 threshold 0.6 Acc 0.9120065789473685, AUC 0.9792670607566833, avg_entr 0.026045536622405052
ep9_t0.6_test_time 0.24939227104187012
Best AUC 0.9803614020347595
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.6_m4//ag_news_lstmal_l5_prefix.pt
[[1384   51   63   34]
 [  19 1472    4   12]
 [  39   14 1312  135]
 [  39   13   93 1396]]
Figure(640x480)
tensor([6.7363e-03, 9.3148e-08, 1.0666e-04,  ..., 2.3499e-08, 1.4122e-06,
        2.4980e-04])
[[1374   48   62   48]
 [  20 1466   13    8]
 [  43    9 1323  125]
 [  38   13  113 1377]]
Figure(640x480)
tensor([2.5406e-06, 8.2298e-08, 6.0501e-07,  ..., 6.7079e-08, 8.8424e-07,
        3.2721e-07])
[[1374   47   62   49]
 [  23 1460   16    8]
 [  44   10 1321  125]
 [  39   15  114 1373]]
Figure(640x480)
tensor([2.9387e-06, 2.2695e-07, 5.0997e-07,  ..., 7.1637e-08, 5.2266e-07,
        5.0273e-07])
[[1376   46   60   50]
 [  22 1459   17    9]
 [  44   11 1311  134]
 [  39   15  108 1379]]
Figure(640x480)
tensor([2.9440e-06, 4.8888e-07, 1.1121e-06,  ..., 3.4264e-07, 9.0896e-07,
        1.4709e-06])
[[   0 1532    0    0]
 [   0 1507    0    0]
 [   0 1500    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([0.6358, 0.3598, 0.3665,  ..., 0.7633, 0.3499, 0.6684])
