total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.4205333333333333 (50464/120000), AUC 0.5278951525688171
ep0_train_time 9.37813663482666
Test Epoch0 threshold 0.6 Acc 0.9129934210526316, AUC 0.9806798100471497, avg_entr 0.02726682275533676
ep0_t0.6_test_time 0.2504568099975586
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4565 (54780/120000), AUC 0.5127671957015991
ep1_train_time 8.962070226669312
Test Epoch1 threshold 0.6 Acc 0.915625, AUC 0.980735182762146, avg_entr 0.026426633819937706
ep1_t0.6_test_time 0.24963974952697754
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.47028333333333333 (56434/120000), AUC 0.5267249345779419
ep2_train_time 9.007259607315063
Test Epoch2 threshold 0.6 Acc 0.9171052631578948, AUC 0.9805669188499451, avg_entr 0.026703450828790665
ep2_t0.6_test_time 0.2489633560180664
gc 0
Train Epoch3 Acc 0.47425833333333334 (56911/120000), AUC 0.5359287261962891
ep3_train_time 8.953559875488281
Test Epoch3 threshold 0.6 Acc 0.9138157894736842, AUC 0.9803831577301025, avg_entr 0.025110691785812378
ep3_t0.6_test_time 0.24967741966247559
gc 0
Train Epoch4 Acc 0.474775 (56973/120000), AUC 0.5417637228965759
ep4_train_time 8.91620683670044
Test Epoch4 threshold 0.6 Acc 0.9159539473684211, AUC 0.9803661704063416, avg_entr 0.02561822161078453
ep4_t0.6_test_time 0.2496337890625
gc 0
Train Epoch5 Acc 0.47613333333333335 (57136/120000), AUC 0.5515799522399902
ep5_train_time 9.124749898910522
Test Epoch5 threshold 0.6 Acc 0.9149671052631579, AUC 0.9801872968673706, avg_entr 0.026555227115750313
ep5_t0.6_test_time 0.24837183952331543
gc 0
Train Epoch6 Acc 0.4767166666666667 (57206/120000), AUC 0.5572366118431091
ep6_train_time 9.043092489242554
Test Epoch6 threshold 0.6 Acc 0.9113486842105263, AUC 0.9800841808319092, avg_entr 0.026503553614020348
ep6_t0.6_test_time 0.2487781047821045
gc 0
Train Epoch7 Acc 0.476975 (57237/120000), AUC 0.5621147751808167
ep7_train_time 8.874273538589478
Test Epoch7 threshold 0.6 Acc 0.9144736842105263, AUC 0.9799636602401733, avg_entr 0.02658887952566147
ep7_t0.6_test_time 0.24885201454162598
gc 0
Train Epoch8 Acc 0.4769 (57228/120000), AUC 0.5653417110443115
ep8_train_time 8.859032154083252
Test Epoch8 threshold 0.6 Acc 0.9138157894736842, AUC 0.9798272848129272, avg_entr 0.026263093575835228
ep8_t0.6_test_time 0.24896883964538574
gc 0
Train Epoch9 Acc 0.4767 (57204/120000), AUC 0.5660924315452576
ep9_train_time 8.830053806304932
Test Epoch9 threshold 0.6 Acc 0.9146381578947368, AUC 0.9798294305801392, avg_entr 0.026146000251173973
ep9_t0.6_test_time 0.2485218048095703
Best AUC 0.980735182762146
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt
[[1367   50   80   35]
 [  11 1476    9   11]
 [  33   12 1345  110]
 [  35   11  116 1379]]
Figure(640x480)
tensor([5.3765e-04, 1.3025e-07, 5.1608e-04,  ..., 4.1723e-08, 6.3434e-06,
        8.0621e-05])
[[1371   50   77   34]
 [  12 1477    8   10]
 [  32   13 1344  111]
 [  35   14  110 1382]]
Figure(640x480)
tensor([2.3644e-04, 1.9070e-06, 4.5428e-04,  ..., 9.2012e-08, 4.3311e-06,
        1.1509e-04])
[[1369   51   78   34]
 [  12 1476    9   10]
 [  32   13 1345  110]
 [  36   12  113 1380]]
Figure(640x480)
tensor([2.2300e-04, 1.0808e-06, 3.8908e-04,  ..., 1.0247e-07, 7.0206e-06,
        1.3406e-04])
[[   1    1    1 1529]
 [   0    0    0 1507]
 [   0    0   26 1474]
 [  20    0  313 1208]]
Figure(640x480)
tensor([0.7781, 0.7256, 1.0013,  ..., 0.6368, 1.0949, 0.8846])
[[1275    0    0  257]
 [   0    0    0 1507]
 [  16    0    0 1484]
 [  32    0    0 1509]]
Figure(640x480)
tensor([0.6860, 0.5206, 0.5619,  ..., 0.5944, 0.6279, 0.4729])
