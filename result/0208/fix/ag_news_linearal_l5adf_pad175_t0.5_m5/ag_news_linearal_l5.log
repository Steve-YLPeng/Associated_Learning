total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9056583333333333 (108679/120000), AUC 0.9834418892860413
ep0_train_time 10.356661796569824
Test Epoch0 threshold 0.5 Acc 0.915625, AUC 0.9804664254188538, avg_entr 0.024833325296640396
ep0_t0.5_test_time 0.25406813621520996
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9487416666666667 (113849/120000), AUC 0.992982029914856
ep1_train_time 9.9222993850708
Test Epoch1 threshold 0.5 Acc 0.9148026315789474, AUC 0.9803578853607178, avg_entr 0.025812877342104912
ep1_t0.5_test_time 0.2510251998901367
gc 0
Train Epoch2 Acc 0.9508416666666667 (114101/120000), AUC 0.9931046962738037
ep2_train_time 9.834628343582153
Test Epoch2 threshold 0.5 Acc 0.9146381578947368, AUC 0.9804258346557617, avg_entr 0.026588106527924538
ep2_t0.5_test_time 0.2512071132659912
gc 0
Train Epoch3 Acc 0.9517583333333334 (114211/120000), AUC 0.9930667877197266
ep3_train_time 9.935529470443726
Test Epoch3 threshold 0.5 Acc 0.9134868421052632, AUC 0.9801818132400513, avg_entr 0.026093993335962296
ep3_t0.5_test_time 0.250028133392334
gc 0
Train Epoch4 Acc 0.9528416666666667 (114341/120000), AUC 0.9936279058456421
ep4_train_time 9.91578221321106
Test Epoch4 threshold 0.5 Acc 0.9123355263157895, AUC 0.9799030423164368, avg_entr 0.025921083986759186
ep4_t0.5_test_time 0.25999975204467773
gc 0
Train Epoch5 Acc 0.9547 (114564/120000), AUC 0.994403600692749
ep5_train_time 10.051316976547241
Test Epoch5 threshold 0.5 Acc 0.9136513157894737, AUC 0.9798166751861572, avg_entr 0.025907935574650764
ep5_t0.5_test_time 0.2534902095794678
gc 0
Train Epoch6 Acc 0.955325 (114639/120000), AUC 0.994484007358551
ep6_train_time 9.846927642822266
Test Epoch6 threshold 0.5 Acc 0.9123355263157895, AUC 0.9797095656394958, avg_entr 0.025188235566020012
ep6_t0.5_test_time 0.2500145435333252
gc 0
Train Epoch7 Acc 0.9555166666666667 (114662/120000), AUC 0.994669497013092
ep7_train_time 9.958792448043823
Test Epoch7 threshold 0.5 Acc 0.9113486842105263, AUC 0.979594886302948, avg_entr 0.025711126625537872
ep7_t0.5_test_time 0.24966931343078613
gc 0
Train Epoch8 Acc 0.956325 (114759/120000), AUC 0.9948084950447083
ep8_train_time 9.919720888137817
Test Epoch8 threshold 0.5 Acc 0.9120065789473685, AUC 0.9795151948928833, avg_entr 0.024456342682242393
ep8_t0.5_test_time 0.25212931632995605
gc 0
Train Epoch9 Acc 0.9569916666666667 (114839/120000), AUC 0.9951692819595337
ep9_train_time 9.98074460029602
Test Epoch9 threshold 0.5 Acc 0.9116776315789473, AUC 0.9794265627861023, avg_entr 0.025992799550294876
ep9_t0.5_test_time 0.24971652030944824
Best AUC 0.9804664254188538
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m5//ag_news_linearal_l5_prefix.pt
[[1370   51   73   38]
 [  10 1480    6   11]
 [  36   15 1323  126]
 [  32   17   97 1395]]
Figure(640x480)
tensor([1.3532e-03, 1.7449e-07, 1.3795e-04,  ..., 2.6873e-08, 8.2109e-07,
        3.3594e-04])
[[1368   53   75   36]
 [  12 1482    5    8]
 [  36   14 1321  129]
 [  35   15   94 1397]]
Figure(640x480)
tensor([1.3709e-03, 1.3657e-06, 1.5048e-04,  ..., 3.6449e-08, 6.6053e-07,
        1.9085e-04])
[[1367   54   73   38]
 [   9 1484    5    9]
 [  36   18 1321  125]
 [  34   16   95 1396]]
Figure(640x480)
tensor([1.0502e-03, 8.3296e-07, 8.4003e-05,  ..., 2.5538e-08, 4.0713e-07,
        9.5692e-05])
[[1367   56   70   39]
 [   8 1488    3    8]
 [  38   19 1312  131]
 [  34   18   90 1399]]
Figure(640x480)
tensor([6.2478e-04, 6.3662e-08, 3.0117e-05,  ..., 2.1792e-08, 2.2314e-07,
        2.5851e-05])
[[1365   57   72   38]
 [   8 1488    3    8]
 [  37   20 1314  129]
 [  32   19   94 1396]]
Figure(640x480)
tensor([5.8667e-04, 6.9529e-08, 2.5314e-05,  ..., 3.6414e-08, 2.2168e-07,
        1.7477e-05])
