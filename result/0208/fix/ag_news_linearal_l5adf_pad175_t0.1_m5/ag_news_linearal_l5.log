total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9285916666666667 (111431/120000), AUC 0.9856172800064087
ep0_train_time 10.35923147201538
Test Epoch0 threshold 0.1 Acc 0.9169407894736842, AUC 0.9806270599365234, avg_entr 0.020567523315548897
ep0_t0.1_test_time 0.2810676097869873
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9490083333333333 (113881/120000), AUC 0.9929231405258179
ep1_train_time 9.859641551971436
Test Epoch1 threshold 0.1 Acc 0.9166118421052631, AUC 0.9803341627120972, avg_entr 0.01626693457365036
ep1_t0.1_test_time 0.2797985076904297
gc 0
Train Epoch2 Acc 0.950725 (114087/120000), AUC 0.9930614233016968
ep2_train_time 9.983485698699951
Test Epoch2 threshold 0.1 Acc 0.9148026315789474, AUC 0.9801751971244812, avg_entr 0.013429617509245872
ep2_t0.1_test_time 0.2833099365234375
gc 0
Train Epoch3 Acc 0.9518833333333333 (114226/120000), AUC 0.9931453466415405
ep3_train_time 9.908437252044678
Test Epoch3 threshold 0.1 Acc 0.9113486842105263, AUC 0.9800004959106445, avg_entr 0.012182813137769699
ep3_t0.1_test_time 0.2785675525665283
gc 0
Train Epoch4 Acc 0.953275 (114393/120000), AUC 0.9937382936477661
ep4_train_time 9.926790475845337
Test Epoch4 threshold 0.1 Acc 0.9139802631578947, AUC 0.9798116087913513, avg_entr 0.012360827997326851
ep4_t0.1_test_time 0.2778034210205078
gc 0
Train Epoch5 Acc 0.9549916666666667 (114599/120000), AUC 0.9944655895233154
ep5_train_time 9.778997421264648
Test Epoch5 threshold 0.1 Acc 0.9133223684210526, AUC 0.9796475172042847, avg_entr 0.011385994032025337
ep5_t0.1_test_time 0.2774937152862549
gc 0
Train Epoch6 Acc 0.9555416666666666 (114665/120000), AUC 0.9947470426559448
ep6_train_time 9.88602900505066
Test Epoch6 threshold 0.1 Acc 0.9136513157894737, AUC 0.9795512557029724, avg_entr 0.011435406282544136
ep6_t0.1_test_time 0.27778053283691406
gc 0
Train Epoch7 Acc 0.9559833333333333 (114718/120000), AUC 0.9948763251304626
ep7_train_time 9.907016038894653
Test Epoch7 threshold 0.1 Acc 0.9129934210526316, AUC 0.9794759154319763, avg_entr 0.011074633337557316
ep7_t0.1_test_time 0.27805519104003906
gc 0
Train Epoch8 Acc 0.9564166666666667 (114770/120000), AUC 0.9949514865875244
ep8_train_time 10.018154621124268
Test Epoch8 threshold 0.1 Acc 0.9126644736842106, AUC 0.9794469475746155, avg_entr 0.010377463884651661
ep8_t0.1_test_time 0.2776455879211426
gc 0
Train Epoch9 Acc 0.9575416666666666 (114905/120000), AUC 0.9952495098114014
ep9_train_time 9.885585069656372
Test Epoch9 threshold 0.1 Acc 0.9136513157894737, AUC 0.9792842864990234, avg_entr 0.010302450507879257
ep9_t0.1_test_time 0.27842259407043457
Best AUC 0.9806270599365234
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m5//ag_news_linearal_l5_prefix.pt
[[1368   55   71   38]
 [  10 1477    8   12]
 [  34   15 1322  129]
 [  32   14   91 1404]]
Figure(640x480)
tensor([1.5724e-03, 1.2400e-07, 1.9722e-04,  ..., 3.5408e-08, 1.6150e-06,
        4.5842e-04])
[[1370   53   73   36]
 [  10 1477    7   13]
 [  36   16 1322  126]
 [  35   14   95 1397]]
Figure(640x480)
tensor([2.2235e-03, 6.6530e-07, 2.6092e-04,  ..., 5.1429e-08, 2.3463e-06,
        9.5869e-04])
[[1372   54   69   37]
 [  10 1477    8   12]
 [  35   16 1316  133]
 [  34   13   87 1407]]
Figure(640x480)
tensor([1.0731e-03, 3.2282e-07, 7.3570e-05,  ..., 4.0097e-08, 1.2871e-06,
        5.8141e-04])
[[1373   54   67   38]
 [  11 1478    6   12]
 [  34   17 1314  135]
 [  31   13   89 1408]]
Figure(640x480)
tensor([6.3481e-04, 1.4351e-07, 4.8846e-05,  ..., 3.9330e-08, 1.0589e-06,
        9.4421e-05])
[[1371   54   70   37]
 [   9 1479    7   12]
 [  33   16 1318  133]
 [  32   13   87 1409]]
Figure(640x480)
tensor([3.6446e-04, 1.9787e-07, 5.3608e-05,  ..., 4.8965e-08, 9.8180e-07,
        7.5114e-05])
