total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.4372 (52464/120000), AUC 0.7104102373123169
ep0_train_time 56.09691786766052
Test Epoch0 threshold 0.2 Acc 0.9151315789473684, AUC 0.9798848032951355, avg_entr 0.016175050288438797
ep0_t0.2_test_time 0.3816566467285156
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.2_m2//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4527583333333333 (54331/120000), AUC 0.7016477584838867
ep1_train_time 56.0302848815918
Test Epoch1 threshold 0.2 Acc 0.9133223684210526, AUC 0.9793625473976135, avg_entr 0.01447934377938509
ep1_t0.2_test_time 0.3806462287902832
gc 0
Train Epoch2 Acc 0.35799166666666665 (42959/120000), AUC 0.680884838104248
ep2_train_time 56.09725904464722
Test Epoch2 threshold 0.2 Acc 0.915625, AUC 0.9792419672012329, avg_entr 0.013646326959133148
ep2_t0.2_test_time 0.3681313991546631
gc 0
Train Epoch3 Acc 0.31054166666666666 (37265/120000), AUC 0.6685283184051514
ep3_train_time 55.979249000549316
Test Epoch3 threshold 0.2 Acc 0.9116776315789473, AUC 0.9795883297920227, avg_entr 0.014179023914039135
ep3_t0.2_test_time 0.3681192398071289
gc 0
Train Epoch4 Acc 0.28131666666666666 (33758/120000), AUC 0.6592020988464355
ep4_train_time 56.01750135421753
Test Epoch4 threshold 0.2 Acc 0.915625, AUC 0.9792690277099609, avg_entr 0.013630562461912632
ep4_t0.2_test_time 0.3684079647064209
gc 0
Train Epoch5 Acc 0.28110833333333335 (33733/120000), AUC 0.6573272347450256
ep5_train_time 56.012510776519775
Test Epoch5 threshold 0.2 Acc 0.9141447368421053, AUC 0.9789231419563293, avg_entr 0.01382484845817089
ep5_t0.2_test_time 0.3807342052459717
gc 0
Train Epoch6 Acc 0.28299166666666664 (33959/120000), AUC 0.6502631306648254
ep6_train_time 55.98395872116089
Test Epoch6 threshold 0.2 Acc 0.9149671052631579, AUC 0.9787834882736206, avg_entr 0.01315523311495781
ep6_t0.2_test_time 0.37852907180786133
gc 0
Train Epoch7 Acc 0.2874 (34488/120000), AUC 0.6487997174263
ep7_train_time 56.140814542770386
Test Epoch7 threshold 0.2 Acc 0.9139802631578947, AUC 0.9786403775215149, avg_entr 0.01416691206395626
ep7_t0.2_test_time 0.3682436943054199
gc 0
Train Epoch8 Acc 0.288925 (34671/120000), AUC 0.6456661224365234
ep8_train_time 56.0554096698761
Test Epoch8 threshold 0.2 Acc 0.9143092105263158, AUC 0.9784464836120605, avg_entr 0.013688611797988415
ep8_t0.2_test_time 0.36767148971557617
gc 0
Train Epoch9 Acc 0.3006333333333333 (36076/120000), AUC 0.6442331075668335
ep9_train_time 56.0001757144928
Test Epoch9 threshold 0.2 Acc 0.9138157894736842, AUC 0.9779890179634094, avg_entr 0.013212218880653381
ep9_t0.2_test_time 0.3720059394836426
Best AUC 0.9798848032951355
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.2_m2//ag_news_lstmal_l5_prefix.pt
[[1370   53   74   35]
 [  12 1483    2   10]
 [  38   15 1324  123]
 [  38   15   93 1395]]
Figure(640x480)
tensor([5.3514e-03, 5.9970e-06, 3.9272e-04,  ..., 4.2686e-06, 3.4243e-05,
        2.2889e-03])
[[1381   48   59   44]
 [  21 1467    8   11]
 [  47    6 1323  124]
 [  37   14  104 1386]]
Figure(640x480)
tensor([5.3628e-05, 1.3162e-05, 1.6496e-05,  ..., 3.5657e-06, 8.2604e-06,
        1.3307e-05])
[[   0   35   17 1480]
 [   0    6  575  926]
 [   0   94    2 1404]
 [   0 1316    2  223]]
Figure(640x480)
tensor([0.9361, 0.9463, 1.0091,  ..., 0.6221, 0.9321, 0.9473])
[[  33  128    0 1371]
 [   2 1482    0   23]
 [ 110 1084    4  302]
 [1241  141   31  128]]
Figure(640x480)
tensor([1.3795, 1.4012, 1.3774,  ..., 1.1364, 1.4048, 1.3380])
[[1164   14  271   83]
 [   6  269 1216   16]
 [  69   12   58 1361]
 [  57  261   47 1176]]
Figure(640x480)
tensor([1.3765, 1.3554, 1.3625,  ..., 1.3769, 1.3759, 1.3689])
