total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.172825 (20739/120000), AUC 0.46973100304603577
ep0_train_time 9.312997579574585
Test Epoch0 threshold 0.8 Acc 0.9162828947368421, AUC 0.9809542894363403, avg_entr 0.02897101268172264
ep0_t0.8_test_time 0.2585427761077881
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24666666666666667 (29600/120000), AUC 0.47593626379966736
ep1_train_time 8.81561541557312
Test Epoch1 threshold 0.8 Acc 0.9184210526315789, AUC 0.9808681011199951, avg_entr 0.027991680428385735
ep1_t0.8_test_time 0.2566225528717041
gc 0
Train Epoch2 Acc 0.251125 (30135/120000), AUC 0.4789068400859833
ep2_train_time 8.849219560623169
Test Epoch2 threshold 0.8 Acc 0.9164473684210527, AUC 0.9808107614517212, avg_entr 0.026431240141391754
ep2_t0.8_test_time 0.25687599182128906
gc 0
Train Epoch3 Acc 0.25046666666666667 (30056/120000), AUC 0.48320528864860535
ep3_train_time 8.899261951446533
Test Epoch3 threshold 0.8 Acc 0.9175986842105263, AUC 0.9806910157203674, avg_entr 0.02637772634625435
ep3_t0.8_test_time 0.2571859359741211
gc 0
Train Epoch4 Acc 0.2501333333333333 (30016/120000), AUC 0.48890233039855957
ep4_train_time 8.85487961769104
Test Epoch4 threshold 0.8 Acc 0.9151315789473684, AUC 0.9804513454437256, avg_entr 0.02587144263088703
ep4_t0.8_test_time 0.25679659843444824
gc 0
Train Epoch5 Acc 0.2500583333333333 (30007/120000), AUC 0.49296849966049194
ep5_train_time 8.862429141998291
Test Epoch5 threshold 0.8 Acc 0.9154605263157894, AUC 0.9804315567016602, avg_entr 0.025998124852776527
ep5_t0.8_test_time 0.25746917724609375
gc 0
Train Epoch6 Acc 0.2500583333333333 (30007/120000), AUC 0.4960748553276062
ep6_train_time 8.846169233322144
Test Epoch6 threshold 0.8 Acc 0.9148026315789474, AUC 0.9803208112716675, avg_entr 0.026285191997885704
ep6_t0.8_test_time 0.2577047348022461
gc 0
Train Epoch7 Acc 0.25005 (30006/120000), AUC 0.49926596879959106
ep7_train_time 8.950656175613403
Test Epoch7 threshold 0.8 Acc 0.9159539473684211, AUC 0.9802144765853882, avg_entr 0.026079367846250534
ep7_t0.8_test_time 0.2574467658996582
gc 0
Train Epoch8 Acc 0.25004166666666666 (30005/120000), AUC 0.5025702714920044
ep8_train_time 8.82059121131897
Test Epoch8 threshold 0.8 Acc 0.9151315789473684, AUC 0.9800722599029541, avg_entr 0.02543884888291359
ep8_t0.8_test_time 0.25619006156921387
gc 0
Train Epoch9 Acc 0.250025 (30003/120000), AUC 0.5050573945045471
ep9_train_time 8.766902923583984
Test Epoch9 threshold 0.8 Acc 0.9148026315789474, AUC 0.9800348281860352, avg_entr 0.025975530967116356
ep9_t0.8_test_time 0.25845909118652344
Best AUC 0.9809542894363403
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt
[[1372   53   70   37]
 [  14 1480    2   11]
 [  40   14 1310  136]
 [  35   14   83 1409]]
Figure(640x480)
tensor([6.7661e-03, 2.7540e-06, 3.4473e-04,  ..., 4.3354e-06, 1.4380e-05,
        4.8644e-03])
[[1374   53   69   36]
 [  12 1482    2   11]
 [  38   13 1311  138]
 [  35   13   83 1410]]
Figure(640x480)
tensor([1.6480e-02, 8.1719e-06, 9.2949e-04,  ..., 1.5153e-05, 1.7905e-04,
        9.2903e-03])
[[   3 1529    0    0]
 [  33 1474    0    0]
 [   1 1499    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([1.1776, 1.2773, 1.2853,  ..., 1.1835, 1.2856, 1.1566])
[[  13    0  399 1120]
 [   0    0    0 1507]
 [  71    0  923  506]
 [ 881    0   28  632]]
Figure(640x480)
tensor([1.2464, 1.0981, 1.2553,  ..., 1.3355, 1.2082, 1.2353])
[[  47    0 1485    0]
 [1452    0   55    0]
 [ 262    0 1238    0]
 [ 141    0 1400    0]]
Figure(640x480)
tensor([0.7968, 0.8553, 0.8508,  ..., 0.9944, 0.8163, 0.7925])
