total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24095833333333333 (28915/120000), AUC 0.44881877303123474
ep0_train_time 46.97326326370239
Test Epoch0 threshold 0.7 Acc 0.9006578947368421, AUC 0.9738426208496094, avg_entr 0.1802753210067749
ep0_t0.7_test_time 0.2528414726257324
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m1//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.22071666666666667 (26486/120000), AUC 0.4275292754173279
ep1_train_time 47.21524667739868
Test Epoch1 threshold 0.7 Acc 0.9123355263157895, AUC 0.977830171585083, avg_entr 0.10470269620418549
ep1_t0.7_test_time 0.2508115768432617
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m1//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.21694166666666667 (26033/120000), AUC 0.429982990026474
ep2_train_time 47.14665079116821
Test Epoch2 threshold 0.7 Acc 0.915625, AUC 0.9794051647186279, avg_entr 0.08069784939289093
ep2_t0.7_test_time 0.25045275688171387
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m1//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.21725833333333333 (26071/120000), AUC 0.4325137436389923
ep3_train_time 47.192644119262695
Test Epoch3 threshold 0.7 Acc 0.9172697368421052, AUC 0.9801337122917175, avg_entr 0.06585822999477386
ep3_t0.7_test_time 0.2514479160308838
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m1//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.21760833333333332 (26113/120000), AUC 0.4345991611480713
ep4_train_time 47.212517499923706
Test Epoch4 threshold 0.7 Acc 0.9161184210526315, AUC 0.9805583357810974, avg_entr 0.05821157619357109
ep4_t0.7_test_time 0.25096774101257324
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m1//ag_news_lstmal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.21905833333333333 (26287/120000), AUC 0.43567442893981934
ep5_train_time 47.23123621940613
Test Epoch5 threshold 0.7 Acc 0.9174342105263158, AUC 0.9805776476860046, avg_entr 0.05257248133420944
ep5_t0.7_test_time 0.25076937675476074
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m1//ag_news_lstmal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.221525 (26583/120000), AUC 0.4370577335357666
ep6_train_time 47.14507079124451
Test Epoch6 threshold 0.7 Acc 0.9161184210526315, AUC 0.9807059168815613, avg_entr 0.04998696595430374
ep6_t0.7_test_time 0.2514455318450928
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m1//ag_news_lstmal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.22465 (26958/120000), AUC 0.4379163086414337
ep7_train_time 47.20952391624451
Test Epoch7 threshold 0.7 Acc 0.9146381578947368, AUC 0.9805242419242859, avg_entr 0.04656878858804703
ep7_t0.7_test_time 0.25055932998657227
gc 0
Train Epoch8 Acc 0.22709166666666666 (27251/120000), AUC 0.43865931034088135
ep8_train_time 47.25148057937622
Test Epoch8 threshold 0.7 Acc 0.9164473684210527, AUC 0.9806560277938843, avg_entr 0.04195427522063255
ep8_t0.7_test_time 0.2517218589782715
gc 0
Train Epoch9 Acc 0.22965833333333333 (27559/120000), AUC 0.43911367654800415
ep9_train_time 47.1676459312439
Test Epoch9 threshold 0.7 Acc 0.9169407894736842, AUC 0.9803796410560608, avg_entr 0.039646923542022705
ep9_t0.7_test_time 0.24989724159240723
Best AUC 0.9807059168815613
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m1//ag_news_lstmal_l5_prefix.pt
[[1384   50   68   30]
 [  18 1475    4   10]
 [  41   12 1337  110]
 [  45   13  109 1374]]
Figure(640x480)
tensor([0.0765, 0.0005, 0.0141,  ..., 0.0004, 0.0049, 0.0130])
[[1167  246   18  101]
 [1301   66   10  130]
 [1131  202   20  147]
 [ 945  143  109  344]]
Figure(640x480)
tensor([0.9878, 1.2192, 1.1770,  ..., 1.1507, 1.2438, 1.2605])
[[   8    0    0 1524]
 [  13    0    1 1493]
 [  19    0    2 1479]
 [   4    0    1 1536]]
Figure(640x480)
tensor([1.3596, 1.3260, 1.2922,  ..., 1.4160, 1.3229, 1.3155])
[[1046    0  472   14]
 [1021    0  486    0]
 [1328    4  168    0]
 [ 910    0  631    0]]
Figure(640x480)
tensor([1.4295, 1.2022, 1.3804,  ..., 1.2747, 1.4111, 1.3693])
[[   0    1 1431  100]
 [   0    1  975  531]
 [   0    0  977  523]
 [   0    0 1174  367]]
Figure(640x480)
tensor([1.3908, 1.3933, 1.3981,  ..., 1.3647, 1.3806, 1.3698])
