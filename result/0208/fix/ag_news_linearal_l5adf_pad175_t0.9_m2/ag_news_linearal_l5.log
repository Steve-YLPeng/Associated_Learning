total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.27625 (33150/120000), AUC 0.4913122355937958
ep0_train_time 9.382084131240845
Test Epoch0 threshold 0.9 Acc 0.9159539473684211, AUC 0.9807497262954712, avg_entr 0.02897939644753933
ep0_t0.9_test_time 0.26224637031555176
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.252825 (30339/120000), AUC 0.4629316031932831
ep1_train_time 8.995036125183105
Test Epoch1 threshold 0.9 Acc 0.9139802631578947, AUC 0.9805118441581726, avg_entr 0.028423527255654335
ep1_t0.9_test_time 0.2613952159881592
gc 0
Train Epoch2 Acc 0.25156666666666666 (30188/120000), AUC 0.46058163046836853
ep2_train_time 8.989458560943604
Test Epoch2 threshold 0.9 Acc 0.9159539473684211, AUC 0.980364203453064, avg_entr 0.02713065594434738
ep2_t0.9_test_time 0.2629270553588867
gc 0
Train Epoch3 Acc 0.25048333333333334 (30058/120000), AUC 0.4608309864997864
ep3_train_time 9.082522869110107
Test Epoch3 threshold 0.9 Acc 0.9161184210526315, AUC 0.9803173542022705, avg_entr 0.026052266359329224
ep3_t0.9_test_time 0.2610514163970947
gc 0
Train Epoch4 Acc 0.25106666666666666 (30128/120000), AUC 0.46031421422958374
ep4_train_time 8.942434787750244
Test Epoch4 threshold 0.9 Acc 0.9151315789473684, AUC 0.9802252650260925, avg_entr 0.02571801096200943
ep4_t0.9_test_time 0.26180291175842285
gc 0
Train Epoch5 Acc 0.254 (30480/120000), AUC 0.4616381525993347
ep5_train_time 9.039040565490723
Test Epoch5 threshold 0.9 Acc 0.9148026315789474, AUC 0.9801621437072754, avg_entr 0.0261369701474905
ep5_t0.9_test_time 0.261155366897583
gc 0
Train Epoch6 Acc 0.26355 (31626/120000), AUC 0.4631659984588623
ep6_train_time 8.958730220794678
Test Epoch6 threshold 0.9 Acc 0.9144736842105263, AUC 0.9800021648406982, avg_entr 0.025932690128684044
ep6_t0.9_test_time 0.26145386695861816
gc 0
Train Epoch7 Acc 0.286375 (34365/120000), AUC 0.4647596478462219
ep7_train_time 9.020578861236572
Test Epoch7 threshold 0.9 Acc 0.9134868421052632, AUC 0.9798492193222046, avg_entr 0.026355987414717674
ep7_t0.9_test_time 0.2617948055267334
gc 0
Train Epoch8 Acc 0.314275 (37713/120000), AUC 0.46587640047073364
ep8_train_time 8.981658935546875
Test Epoch8 threshold 0.9 Acc 0.9139802631578947, AUC 0.9798223376274109, avg_entr 0.02690037339925766
ep8_t0.9_test_time 0.26424169540405273
gc 0
Train Epoch9 Acc 0.331225 (39747/120000), AUC 0.4662051200866699
ep9_train_time 9.027849435806274
Test Epoch9 threshold 0.9 Acc 0.9141447368421053, AUC 0.9797512888908386, avg_entr 0.026444585993885994
ep9_t0.9_test_time 0.26220130920410156
Best AUC 0.9807497262954712
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt
[[1389   49   64   30]
 [  16 1481    4    6]
 [  45   15 1332  108]
 [  53   15  106 1367]]
Figure(640x480)
tensor([1.1281e-02, 3.4291e-06, 1.8379e-03,  ..., 1.1320e-06, 2.6967e-05,
        5.6872e-04])
[[1381   50   72   29]
 [  16 1479    3    9]
 [  43   15 1334  108]
 [  49   19  104 1369]]
Figure(640x480)
tensor([1.2876e-02, 1.7287e-05, 3.7934e-03,  ..., 2.3827e-06, 3.4960e-04,
        5.2316e-04])
[[  13    0 1467   52]
 [ 438    0   21 1048]
 [ 131    0 1326   43]
 [   6    0  949  586]]
Figure(640x480)
tensor([1.0384, 0.8145, 0.8729,  ..., 0.8261, 0.8376, 1.2014])
[[1463    0   68    1]
 [ 618    0  889    0]
 [ 170    0 1329    1]
 [ 769    0  763    9]]
Figure(640x480)
tensor([1.3500, 1.3715, 1.3633,  ..., 1.1200, 1.3801, 1.2443])
[[   0 1478    0   54]
 [   0 1507    0    0]
 [   0  293    0 1207]
 [   0 1488    0   53]]
Figure(640x480)
tensor([1.1474, 1.0923, 1.1273,  ..., 1.0468, 1.1277, 1.1965])
