total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.19894166666666666 (23873/120000), AUC 0.42315879464149475
ep0_train_time 46.99578094482422
Test Epoch0 threshold 0.3 Acc 0.8990131578947368, AUC 0.9737023711204529, avg_entr 0.18529058992862701
ep0_t0.3_test_time 0.25247693061828613
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.16388333333333333 (19666/120000), AUC 0.37902241945266724
ep1_train_time 47.29074454307556
Test Epoch1 threshold 0.3 Acc 0.9070723684210527, AUC 0.9775617122650146, avg_entr 0.10770781338214874
ep1_t0.3_test_time 0.2563176155090332
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.16149166666666667 (19379/120000), AUC 0.37776511907577515
ep2_train_time 47.06465554237366
Test Epoch2 threshold 0.3 Acc 0.9164473684210527, AUC 0.9793674349784851, avg_entr 0.07855495810508728
ep2_t0.3_test_time 0.2491590976715088
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.16286666666666666 (19544/120000), AUC 0.3795073926448822
ep3_train_time 47.08418273925781
Test Epoch3 threshold 0.3 Acc 0.9148026315789474, AUC 0.9802547693252563, avg_entr 0.0706353709101677
ep3_t0.3_test_time 0.24904465675354004
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.16624166666666668 (19949/120000), AUC 0.3815500736236572
ep4_train_time 47.09224319458008
Test Epoch4 threshold 0.3 Acc 0.9175986842105263, AUC 0.9804866313934326, avg_entr 0.05884329602122307
ep4_t0.3_test_time 0.24846577644348145
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.16965833333333333 (20359/120000), AUC 0.38393309712409973
ep5_train_time 47.13853311538696
Test Epoch5 threshold 0.3 Acc 0.9144736842105263, AUC 0.9806032180786133, avg_entr 0.053735245019197464
ep5_t0.3_test_time 0.24909734725952148
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.17351666666666668 (20822/120000), AUC 0.38637465238571167
ep6_train_time 47.05162072181702
Test Epoch6 threshold 0.3 Acc 0.9144736842105263, AUC 0.9805349111557007, avg_entr 0.05117446556687355
ep6_t0.3_test_time 0.24839067459106445
gc 0
Train Epoch7 Acc 0.176625 (21195/120000), AUC 0.3883633017539978
ep7_train_time 47.14569163322449
Test Epoch7 threshold 0.3 Acc 0.9154605263157894, AUC 0.9806793928146362, avg_entr 0.046510353684425354
ep7_t0.3_test_time 0.24852776527404785
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.18025833333333333 (21631/120000), AUC 0.39050453901290894
ep8_train_time 47.0769202709198
Test Epoch8 threshold 0.3 Acc 0.9169407894736842, AUC 0.9804882407188416, avg_entr 0.04272531345486641
ep8_t0.3_test_time 0.24915385246276855
gc 0
Train Epoch9 Acc 0.18335 (22002/120000), AUC 0.39264172315597534
ep9_train_time 47.01716470718384
Test Epoch9 threshold 0.3 Acc 0.9162828947368421, AUC 0.9805074334144592, avg_entr 0.04080504551529884
ep9_t0.3_test_time 0.24874234199523926
Best AUC 0.9806793928146362
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt
[[1380   51   69   32]
 [  17 1476    4   10]
 [  40   15 1332  113]
 [  45   15  103 1378]]
Figure(640x480)
tensor([0.0640, 0.0003, 0.0058,  ..., 0.0003, 0.0015, 0.0202])
[[  85   59  219 1169]
 [ 216   13   57 1221]
 [ 219   23  138 1120]
 [ 732   30  246  533]]
Figure(640x480)
tensor([1.3071, 1.3828, 1.3836,  ..., 1.2075, 1.2361, 1.3367])
[[179 986 189 178]
 [ 36 454 795 222]
 [394 608 212 286]
 [540 624 156 221]]
Figure(640x480)
tensor([1.4435, 1.4162, 1.4160,  ..., 1.4268, 1.4087, 1.4124])
[[   0    2    0 1530]
 [   0    0    0 1507]
 [   3    0    1 1496]
 [   9    0    0 1532]]
Figure(640x480)
tensor([1.3292, 1.2750, 1.2379,  ..., 1.3308, 1.2802, 1.3116])
[[ 404    1    0 1127]
 [ 913    0    0  594]
 [ 795   14    0  691]
 [ 832    9    0  700]]
Figure(640x480)
tensor([1.3009, 1.3435, 1.3192,  ..., 1.3848, 1.3241, 1.3044])
