total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.25000833333333333 (30001/120000), AUC 0.26827195286750793
ep0_train_time 9.775331735610962
Test Epoch0 threshold 0.9 Acc 0.9164473684210527, AUC 0.9807848930358887, avg_entr 0.025070732459425926
ep0_t0.9_test_time 0.2543916702270508
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.26330241560935974
ep1_train_time 9.222267627716064
Test Epoch1 threshold 0.9 Acc 0.9151315789473684, AUC 0.9806481003761292, avg_entr 0.025762533769011497
ep1_t0.9_test_time 0.25272464752197266
gc 0
Train Epoch2 Acc 0.25165 (30198/120000), AUC 0.31294795870780945
ep2_train_time 9.240208625793457
Test Epoch2 threshold 0.9 Acc 0.9166118421052631, AUC 0.9804458022117615, avg_entr 0.02580689638853073
ep2_t0.9_test_time 0.2556917667388916
gc 0
Train Epoch3 Acc 0.27505 (33006/120000), AUC 0.3416712284088135
ep3_train_time 9.406223773956299
Test Epoch3 threshold 0.9 Acc 0.9151315789473684, AUC 0.9802533388137817, avg_entr 0.026098961010575294
ep3_t0.9_test_time 0.25371718406677246
gc 0
Train Epoch4 Acc 0.33040833333333336 (39649/120000), AUC 0.3550504744052887
ep4_train_time 9.302490711212158
Test Epoch4 threshold 0.9 Acc 0.9154605263157894, AUC 0.9801616668701172, avg_entr 0.026199180632829666
ep4_t0.9_test_time 0.2516312599182129
gc 0
Train Epoch5 Acc 0.37575833333333336 (45091/120000), AUC 0.35506290197372437
ep5_train_time 9.237834215164185
Test Epoch5 threshold 0.9 Acc 0.9151315789473684, AUC 0.9800320863723755, avg_entr 0.026180896908044815
ep5_t0.9_test_time 0.25171804428100586
gc 0
Train Epoch6 Acc 0.3965166666666667 (47582/120000), AUC 0.3518643379211426
ep6_train_time 9.292242050170898
Test Epoch6 threshold 0.9 Acc 0.9131578947368421, AUC 0.979880154132843, avg_entr 0.02644948475062847
ep6_t0.9_test_time 0.2534494400024414
gc 0
Train Epoch7 Acc 0.41131666666666666 (49358/120000), AUC 0.3606078028678894
ep7_train_time 9.283817052841187
Test Epoch7 threshold 0.9 Acc 0.9141447368421053, AUC 0.9798294901847839, avg_entr 0.026498716324567795
ep7_t0.9_test_time 0.25432562828063965
gc 0
Train Epoch8 Acc 0.42130833333333334 (50557/120000), AUC 0.3862100839614868
ep8_train_time 9.36062741279602
Test Epoch8 threshold 0.9 Acc 0.9136513157894737, AUC 0.9796350002288818, avg_entr 0.026178430765867233
ep8_t0.9_test_time 0.25263476371765137
gc 0
Train Epoch9 Acc 0.4265 (51180/120000), AUC 0.4183296859264374
ep9_train_time 9.222691535949707
Test Epoch9 threshold 0.9 Acc 0.9125, AUC 0.9796264171600342, avg_entr 0.025859594345092773
ep9_t0.9_test_time 0.25284290313720703
Best AUC 0.9807848930358887
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5_prefix.pt
[[1369   53   71   39]
 [  11 1483    3   10]
 [  38   18 1303  141]
 [  32   13   79 1417]]
Figure(640x480)
tensor([3.1013e-03, 4.8252e-07, 1.2756e-04,  ..., 2.5029e-07, 1.4183e-06,
        4.8400e-04])
[[1373   51   69   39]
 [  12 1481    4   10]
 [  36   17 1299  148]
 [  35   14   76 1416]]
Figure(640x480)
tensor([3.1883e-03, 4.3339e-06, 8.0910e-05,  ..., 4.4978e-07, 1.9168e-06,
        6.7060e-04])
[[1370   51   70   41]
 [  12 1483    2   10]
 [  36   18 1301  145]
 [  30   14   77 1420]]
Figure(640x480)
tensor([4.1738e-03, 1.1793e-05, 9.0638e-05,  ..., 5.7016e-07, 1.8281e-06,
        3.9222e-04])
[[1401    0    0  131]
 [1500    0    1    6]
 [  63    0    0 1437]
 [ 819    0    0  722]]
Figure(640x480)
tensor([0.8162, 0.4401, 0.6034,  ..., 0.7846, 0.5393, 0.8279])
[[   0 1532    0    0]
 [   0 1507    0    0]
 [   0 1483    0   17]
 [   0 1541    0    0]]
Figure(640x480)
tensor([0.6009, 0.4738, 0.5452,  ..., 0.6450, 0.5819, 0.8588])
