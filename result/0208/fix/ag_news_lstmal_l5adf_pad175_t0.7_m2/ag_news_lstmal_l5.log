total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m1//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.2614 (31368/120000), AUC 0.7179725170135498
ep0_train_time 55.98995351791382
Test Epoch0 threshold 0.7 Acc 0.9146381578947368, AUC 0.9808300733566284, avg_entr 0.02768472395837307
ep0_t0.7_test_time 0.24956297874450684
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m2//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.23965833333333333 (28759/120000), AUC 0.7591240406036377
ep1_train_time 55.951887130737305
Test Epoch1 threshold 0.7 Acc 0.9166118421052631, AUC 0.9807814359664917, avg_entr 0.026824085041880608
ep1_t0.7_test_time 0.24886322021484375
gc 0
Train Epoch2 Acc 0.252875 (30345/120000), AUC 0.7614625096321106
ep2_train_time 56.026644706726074
Test Epoch2 threshold 0.7 Acc 0.9143092105263158, AUC 0.9806829690933228, avg_entr 0.026300877332687378
ep2_t0.7_test_time 0.2487015724182129
gc 0
Train Epoch3 Acc 0.28075833333333333 (33691/120000), AUC 0.7735005617141724
ep3_train_time 56.07234001159668
Test Epoch3 threshold 0.7 Acc 0.9169407894736842, AUC 0.9806220531463623, avg_entr 0.02629716508090496
ep3_t0.7_test_time 0.24851322174072266
gc 0
Train Epoch4 Acc 0.2753 (33036/120000), AUC 0.7812755703926086
ep4_train_time 55.984543323516846
Test Epoch4 threshold 0.7 Acc 0.9167763157894737, AUC 0.9803812503814697, avg_entr 0.026758931577205658
ep4_t0.7_test_time 0.24884486198425293
gc 0
Train Epoch5 Acc 0.2614 (31368/120000), AUC 0.7899408936500549
ep5_train_time 56.021735429763794
Test Epoch5 threshold 0.7 Acc 0.9149671052631579, AUC 0.9802757501602173, avg_entr 0.02645973488688469
ep5_t0.7_test_time 0.24845457077026367
gc 0
Train Epoch6 Acc 0.257675 (30921/120000), AUC 0.7973356246948242
ep6_train_time 56.025026082992554
Test Epoch6 threshold 0.7 Acc 0.9151315789473684, AUC 0.9801824688911438, avg_entr 0.026350166648626328
ep6_t0.7_test_time 0.2488999366760254
gc 0
Train Epoch7 Acc 0.2571333333333333 (30856/120000), AUC 0.8022466897964478
ep7_train_time 56.02278709411621
Test Epoch7 threshold 0.7 Acc 0.9133223684210526, AUC 0.9799416661262512, avg_entr 0.025919988751411438
ep7_t0.7_test_time 0.24820470809936523
gc 0
Train Epoch8 Acc 0.24345833333333333 (29215/120000), AUC 0.8021422028541565
ep8_train_time 56.063029766082764
Test Epoch8 threshold 0.7 Acc 0.9144736842105263, AUC 0.9799036979675293, avg_entr 0.025042779743671417
ep8_t0.7_test_time 0.2480483055114746
gc 0
Train Epoch9 Acc 0.250075 (30009/120000), AUC 0.8068572282791138
ep9_train_time 55.973023414611816
Test Epoch9 threshold 0.7 Acc 0.9123355263157895, AUC 0.9798926115036011, avg_entr 0.026164192706346512
ep9_t0.7_test_time 0.2495729923248291
Best AUC 0.9808300733566284
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.7_m2//ag_news_lstmal_l5_prefix.pt
[[1362   56   81   33]
 [   8 1486    7    6]
 [  32   17 1340  111]
 [  39   20  109 1373]]
Figure(640x480)
tensor([1.9693e-03, 6.5725e-06, 6.3197e-04,  ..., 1.2967e-06, 3.3673e-05,
        3.9221e-04])
[[1362   50   81   39]
 [  10 1478    9   10]
 [  31   12 1328  129]
 [  33   16  115 1377]]
Figure(640x480)
tensor([1.0469e-05, 6.6613e-06, 8.4198e-06,  ..., 3.2384e-06, 7.6228e-06,
        5.2697e-06])
[[  38    1    5 1488]
 [1227   33  159   88]
 [   8   32  207 1253]
 [   6    1   17 1517]]
Figure(640x480)
tensor([1.1811, 0.9106, 0.9154,  ..., 1.1809, 0.8621, 1.2431])
[[ 354    7 1142   29]
 [  22    0 1485    0]
 [1480    0   20    0]
 [1498    0   43    0]]
Figure(640x480)
tensor([1.1830, 1.1598, 1.2139,  ..., 1.1476, 1.1609, 1.0484])
[[   0   49   63 1420]
 [   0  204   85 1218]
 [   0  133 1177  190]
 [   0 1312   48  181]]
Figure(640x480)
tensor([1.3204, 1.1751, 1.1565,  ..., 1.3063, 1.2120, 1.2787])
