total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.48904550075531006
ep0_train_time 8.851516246795654
Test Epoch0 threshold 0.1 Acc 0.8995065789473684, AUC 0.9741471409797668, avg_entr 0.1822512000799179
ep0_t0.1_test_time 0.2557032108306885
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.46518534421920776
ep1_train_time 8.072619676589966
Test Epoch1 threshold 0.1 Acc 0.9110197368421052, AUC 0.9780001640319824, avg_entr 0.10583580285310745
ep1_t0.1_test_time 0.25438594818115234
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.45087671279907227
ep2_train_time 8.0819091796875
Test Epoch2 threshold 0.1 Acc 0.9146381578947368, AUC 0.979399561882019, avg_entr 0.08088181912899017
ep2_t0.1_test_time 0.25354909896850586
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.4438874423503876
ep3_train_time 8.090032577514648
Test Epoch3 threshold 0.1 Acc 0.9146381578947368, AUC 0.9803034067153931, avg_entr 0.06668127328157425
ep3_t0.1_test_time 0.2546107769012451
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.438920259475708
ep4_train_time 8.13036823272705
Test Epoch4 threshold 0.1 Acc 0.9154605263157894, AUC 0.9807053208351135, avg_entr 0.060344189405441284
ep4_t0.1_test_time 0.25367021560668945
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.4344683289527893
ep5_train_time 8.155790328979492
Test Epoch5 threshold 0.1 Acc 0.915625, AUC 0.9808411002159119, avg_entr 0.05288323760032654
ep5_t0.1_test_time 0.2541966438293457
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.43117010593414307
ep6_train_time 8.09116792678833
Test Epoch6 threshold 0.1 Acc 0.9174342105263158, AUC 0.9809380769729614, avg_entr 0.048739779740571976
ep6_t0.1_test_time 0.25397825241088867
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.4280574321746826
ep7_train_time 8.22367525100708
Test Epoch7 threshold 0.1 Acc 0.9166118421052631, AUC 0.9808031320571899, avg_entr 0.04650314897298813
ep7_t0.1_test_time 0.25430750846862793
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.4258030951023102
ep8_train_time 8.093047618865967
Test Epoch8 threshold 0.1 Acc 0.9174342105263158, AUC 0.9807882905006409, avg_entr 0.04376973956823349
ep8_t0.1_test_time 0.2535686492919922
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.42369818687438965
ep9_train_time 8.06445050239563
Test Epoch9 threshold 0.1 Acc 0.9157894736842105, AUC 0.9805799722671509, avg_entr 0.040715355426073074
ep9_t0.1_test_time 0.2534472942352295
Best AUC 0.9809380769729614
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt
[[1376   53   69   34]
 [  14 1479    2   12]
 [  39   13 1327  121]
 [  38   15   92 1396]]
Figure(640x480)
tensor([0.0435, 0.0004, 0.0138,  ..., 0.0004, 0.0018, 0.0232])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([1.1214, 1.1432, 1.1369,  ..., 1.1301, 1.1507, 1.1649])
[[   0 1532    0    0]
 [   0 1507    0    0]
 [   0 1500    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([1.3834, 1.3888, 1.3863,  ..., 1.3718, 1.3806, 1.3881])
[[1479   53    0    0]
 [1491   16    0    0]
 [1366  118   16    0]
 [ 766  771    4    0]]
Figure(640x480)
tensor([1.4540, 1.4574, 1.4523,  ..., 1.4510, 1.4573, 1.4608])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([1.1486, 1.1466, 1.1659,  ..., 1.1817, 1.1615, 1.1657])
