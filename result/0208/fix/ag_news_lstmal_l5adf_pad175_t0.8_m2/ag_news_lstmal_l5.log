total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.8_m1//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.2500833333333333 (30010/120000), AUC 0.600612998008728
ep0_train_time 56.51951313018799
Test Epoch0 threshold 0.8 Acc 0.9141447368421053, AUC 0.9809088110923767, avg_entr 0.030266884714365005
ep0_t0.8_test_time 0.25475144386291504
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.8_m2//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25014166666666665 (30017/120000), AUC 0.6056758165359497
ep1_train_time 56.49520564079285
Test Epoch1 threshold 0.8 Acc 0.9162828947368421, AUC 0.9807286858558655, avg_entr 0.02689483016729355
ep1_t0.8_test_time 0.2606167793273926
gc 0
Train Epoch2 Acc 0.2500833333333333 (30010/120000), AUC 0.5922120809555054
ep2_train_time 56.482181787490845
Test Epoch2 threshold 0.8 Acc 0.9151315789473684, AUC 0.980789840221405, avg_entr 0.02670793980360031
ep2_t0.8_test_time 0.2549428939819336
gc 0
Train Epoch3 Acc 0.25005 (30006/120000), AUC 0.5825750231742859
ep3_train_time 56.49612593650818
Test Epoch3 threshold 0.8 Acc 0.9164473684210527, AUC 0.980717658996582, avg_entr 0.026068730279803276
ep3_t0.8_test_time 0.2528202533721924
gc 0
Train Epoch4 Acc 0.2500583333333333 (30007/120000), AUC 0.5747591257095337
ep4_train_time 56.540146350860596
Test Epoch4 threshold 0.8 Acc 0.9134868421052632, AUC 0.9805089831352234, avg_entr 0.02680874429643154
ep4_t0.8_test_time 0.26372194290161133
gc 0
Train Epoch5 Acc 0.25005 (30006/120000), AUC 0.5691713690757751
ep5_train_time 56.542450189590454
Test Epoch5 threshold 0.8 Acc 0.9139802631578947, AUC 0.980324923992157, avg_entr 0.025578413158655167
ep5_t0.8_test_time 0.25168442726135254
gc 0
Train Epoch6 Acc 0.25005 (30006/120000), AUC 0.5673878192901611
ep6_train_time 56.512248277664185
Test Epoch6 threshold 0.8 Acc 0.9138157894736842, AUC 0.9802330732345581, avg_entr 0.026409994810819626
ep6_t0.8_test_time 0.2537965774536133
gc 0
Train Epoch7 Acc 0.25006666666666666 (30008/120000), AUC 0.5652682185173035
ep7_train_time 56.49393272399902
Test Epoch7 threshold 0.8 Acc 0.9144736842105263, AUC 0.9800804257392883, avg_entr 0.026164259761571884
ep7_t0.8_test_time 0.25586748123168945
gc 0
Train Epoch8 Acc 0.2500583333333333 (30007/120000), AUC 0.5638568997383118
ep8_train_time 56.43984508514404
Test Epoch8 threshold 0.8 Acc 0.9138157894736842, AUC 0.9800261855125427, avg_entr 0.02503788284957409
ep8_t0.8_test_time 0.2649819850921631
gc 0
Train Epoch9 Acc 0.25006666666666666 (30008/120000), AUC 0.5629751682281494
ep9_train_time 56.4469940662384
Test Epoch9 threshold 0.8 Acc 0.9141447368421053, AUC 0.9799421429634094, avg_entr 0.02543914131820202
ep9_t0.8_test_time 0.25171422958374023
Best AUC 0.9809088110923767
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.8_m2//ag_news_lstmal_l5_prefix.pt
[[1385   49   69   29]
 [  19 1481    3    4]
 [  43   13 1340  104]
 [  54   15  120 1352]]
Figure(640x480)
tensor([1.4887e-02, 2.5238e-06, 2.6156e-03,  ..., 3.1997e-06, 3.5165e-05,
        5.5704e-04])
[[1388   48   57   39]
 [  15 1480    7    5]
 [  47   13 1320  120]
 [  43   17  101 1380]]
Figure(640x480)
tensor([1.7060e-05, 2.2424e-05, 1.5626e-05,  ..., 5.6863e-06, 1.4173e-05,
        2.6478e-05])
[[1376  120   36    0]
 [  32 1473    2    0]
 [ 165  564  771    0]
 [ 110 1034  397    0]]
Figure(640x480)
tensor([1.1122, 1.0367, 1.0155,  ..., 0.5919, 0.9718, 1.1830])
[[ 170 1167  195    0]
 [  36   14 1457    0]
 [1420   20   40   20]
 [1439   87   15    0]]
Figure(640x480)
tensor([1.3023, 0.9899, 1.1827,  ..., 0.9416, 1.1677, 1.2172])
[[   3 1529    0    0]
 [   0 1507    0    0]
 [   3 1497    0    0]
 [  87 1454    0    0]]
Figure(640x480)
tensor([0.9484, 0.7909, 0.8162,  ..., 0.7081, 0.8663, 0.9861])
