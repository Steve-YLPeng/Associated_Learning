total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.494723916053772
ep0_train_time 8.516417264938354
Test Epoch0 threshold 0.4 Acc 0.8995065789473684, AUC 0.9739779233932495, avg_entr 0.1837339848279953
ep0_t0.4_test_time 0.256000280380249
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.4974660873413086
ep1_train_time 8.076324462890625
Test Epoch1 threshold 0.4 Acc 0.9116776315789473, AUC 0.9779666662216187, avg_entr 0.10490766167640686
ep1_t0.4_test_time 0.25505805015563965
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.49572792649269104
ep2_train_time 8.173097133636475
Test Epoch2 threshold 0.4 Acc 0.9154605263157894, AUC 0.9795360565185547, avg_entr 0.08056845515966415
ep2_t0.4_test_time 0.25439977645874023
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.492927610874176
ep3_train_time 8.053389549255371
Test Epoch3 threshold 0.4 Acc 0.9134868421052632, AUC 0.9800880551338196, avg_entr 0.06973934173583984
ep3_t0.4_test_time 0.25482916831970215
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.48962563276290894
ep4_train_time 8.403605461120605
Test Epoch4 threshold 0.4 Acc 0.9175986842105263, AUC 0.9803697466850281, avg_entr 0.058657463639974594
ep4_t0.4_test_time 0.25414204597473145
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.4879060387611389
ep5_train_time 8.109415292739868
Test Epoch5 threshold 0.4 Acc 0.9177631578947368, AUC 0.9805989265441895, avg_entr 0.053752586245536804
ep5_t0.4_test_time 0.2543761730194092
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.4867439270019531
ep6_train_time 8.121465682983398
Test Epoch6 threshold 0.4 Acc 0.9161184210526315, AUC 0.9806593656539917, avg_entr 0.04956931248307228
ep6_t0.4_test_time 0.2545607089996338
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.4863723814487457
ep7_train_time 8.000483989715576
Test Epoch7 threshold 0.4 Acc 0.9143092105263158, AUC 0.980787456035614, avg_entr 0.04615910351276398
ep7_t0.4_test_time 0.2540152072906494
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.48577916622161865
ep8_train_time 8.12690281867981
Test Epoch8 threshold 0.4 Acc 0.9157894736842105, AUC 0.9804142713546753, avg_entr 0.04311119392514229
ep8_t0.4_test_time 0.25414228439331055
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.48590904474258423
ep9_train_time 8.27328896522522
Test Epoch9 threshold 0.4 Acc 0.9157894736842105, AUC 0.9803813099861145, avg_entr 0.04053653031587601
ep9_t0.4_test_time 0.25382304191589355
Best AUC 0.980787456035614
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt
[[1369   54   79   30]
 [  10 1484    7    6]
 [  34   14 1344  108]
 [  44   19  116 1362]]
Figure(640x480)
tensor([0.0263, 0.0004, 0.0117,  ..., 0.0002, 0.0031, 0.0099])
[[   0    0   11 1521]
 [   0    0    2 1505]
 [   0    0    1 1499]
 [   0    0    0 1541]]
Figure(640x480)
tensor([1.1552, 1.2037, 1.1889,  ..., 1.2055, 1.1786, 1.2281])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([1.1803, 1.1994, 1.2062,  ..., 1.2464, 1.1810, 1.2046])
[[1166  366    0    0]
 [ 450 1057    0    0]
 [ 946  554    0    0]
 [1273  268    0    0]]
Figure(640x480)
tensor([1.2188, 1.2407, 1.2322,  ..., 1.2259, 1.2560, 1.2589])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([1.2223, 1.2522, 1.2592,  ..., 1.2442, 1.2566, 1.2564])
