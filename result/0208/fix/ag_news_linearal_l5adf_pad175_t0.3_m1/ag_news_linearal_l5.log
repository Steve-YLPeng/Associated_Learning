total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2507916666666667 (30095/120000), AUC 0.476479172706604
ep0_train_time 8.845596313476562
Test Epoch0 threshold 0.3 Acc 0.9008223684210527, AUC 0.9738394021987915, avg_entr 0.18457145988941193
ep0_t0.3_test_time 0.2566063404083252
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.250175 (30021/120000), AUC 0.4589548110961914
ep1_train_time 8.082966804504395
Test Epoch1 threshold 0.3 Acc 0.9120065789473685, AUC 0.9777055978775024, avg_entr 0.10686241835355759
ep1_t0.3_test_time 0.2544703483581543
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2501 (30012/120000), AUC 0.4615612030029297
ep2_train_time 8.054301261901855
Test Epoch2 threshold 0.3 Acc 0.9154605263157894, AUC 0.9794455766677856, avg_entr 0.0815977230668068
ep2_t0.3_test_time 0.2558298110961914
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25006666666666666 (30008/120000), AUC 0.4643707573413849
ep3_train_time 8.22650957107544
Test Epoch3 threshold 0.3 Acc 0.9139802631578947, AUC 0.9801018834114075, avg_entr 0.06719668954610825
ep3_t0.3_test_time 0.25518059730529785
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25004166666666666 (30005/120000), AUC 0.4671546518802643
ep4_train_time 8.107349872589111
Test Epoch4 threshold 0.3 Acc 0.9169407894736842, AUC 0.9805506467819214, avg_entr 0.05928350239992142
ep4_t0.3_test_time 0.25531792640686035
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.250025 (30003/120000), AUC 0.469506174325943
ep5_train_time 8.09878158569336
Test Epoch5 threshold 0.3 Acc 0.915296052631579, AUC 0.9807809591293335, avg_entr 0.053683314472436905
ep5_t0.3_test_time 0.25487232208251953
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.4717799723148346
ep6_train_time 8.265578269958496
Test Epoch6 threshold 0.3 Acc 0.9148026315789474, AUC 0.9808496236801147, avg_entr 0.05107118561863899
ep6_t0.3_test_time 0.25530219078063965
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25000833333333333 (30001/120000), AUC 0.4733138680458069
ep7_train_time 8.197227716445923
Test Epoch7 threshold 0.3 Acc 0.9157894736842105, AUC 0.9807700514793396, avg_entr 0.04555439203977585
ep7_t0.3_test_time 0.254833459854126
gc 0
Train Epoch8 Acc 0.25000833333333333 (30001/120000), AUC 0.47486740350723267
ep8_train_time 8.367221593856812
Test Epoch8 threshold 0.3 Acc 0.9159539473684211, AUC 0.9806522130966187, avg_entr 0.04267362877726555
ep8_t0.3_test_time 0.2548708915710449
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.4762785732746124
ep9_train_time 8.119900465011597
Test Epoch9 threshold 0.3 Acc 0.9151315789473684, AUC 0.9806517362594604, avg_entr 0.040622368454933167
ep9_t0.3_test_time 0.25421833992004395
Best AUC 0.9808496236801147
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt
[[1369   52   80   31]
 [  12 1476    9   10]
 [  33   12 1348  107]
 [  42   12  118 1369]]
Figure(640x480)
tensor([0.0560, 0.0004, 0.0141,  ..., 0.0004, 0.0043, 0.0252])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([1.2001, 1.2627, 1.2555,  ..., 1.2246, 1.2484, 1.2590])
[[   0 1532    0    0]
 [   0 1507    0    0]
 [   0 1500    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([1.2044, 1.2747, 1.2394,  ..., 1.2205, 1.2509, 1.2420])
[[  93    0 1439    0]
 [ 443    0 1064    0]
 [ 872    0  628    0]
 [1045    0  496    0]]
Figure(640x480)
tensor([1.3042, 1.3505, 1.3369,  ..., 1.3226, 1.3307, 1.3328])
[[   0 1532    0    0]
 [   0 1507    0    0]
 [   0 1500    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([1.2856, 1.3200, 1.3163,  ..., 1.2842, 1.3189, 1.2801])
