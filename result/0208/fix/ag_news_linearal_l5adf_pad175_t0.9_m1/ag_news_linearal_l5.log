total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24878333333333333 (29854/120000), AUC 0.5240769982337952
ep0_train_time 8.5911386013031
Test Epoch0 threshold 0.9 Acc 0.9003289473684211, AUC 0.9735099077224731, avg_entr 0.18420052528381348
ep0_t0.9_test_time 0.2539854049682617
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.248875 (29865/120000), AUC 0.545494794845581
ep1_train_time 8.206790208816528
Test Epoch1 threshold 0.9 Acc 0.9111842105263158, AUC 0.9776235818862915, avg_entr 0.10766486823558807
ep1_t0.9_test_time 0.2516946792602539
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25011666666666665 (30014/120000), AUC 0.5520616173744202
ep2_train_time 8.135112524032593
Test Epoch2 threshold 0.9 Acc 0.9149671052631579, AUC 0.9792891144752502, avg_entr 0.08135378360748291
ep2_t0.9_test_time 0.2510526180267334
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25506666666666666 (30608/120000), AUC 0.5567982196807861
ep3_train_time 8.167171001434326
Test Epoch3 threshold 0.9 Acc 0.9157894736842105, AUC 0.9800682663917542, avg_entr 0.07113663107156754
ep3_t0.9_test_time 0.2519652843475342
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.274275 (32913/120000), AUC 0.5610090494155884
ep4_train_time 8.173693656921387
Test Epoch4 threshold 0.9 Acc 0.9167763157894737, AUC 0.9804875254631042, avg_entr 0.058335646986961365
ep4_t0.9_test_time 0.25493383407592773
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.31564166666666665 (37877/120000), AUC 0.5639445781707764
ep5_train_time 8.273835182189941
Test Epoch5 threshold 0.9 Acc 0.9167763157894737, AUC 0.980560839176178, avg_entr 0.05312957242131233
ep5_t0.9_test_time 0.2516939640045166
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.35838333333333333 (43006/120000), AUC 0.5665389895439148
ep6_train_time 8.30348825454712
Test Epoch6 threshold 0.9 Acc 0.9154605263157894, AUC 0.9807513952255249, avg_entr 0.048587601631879807
ep6_t0.9_test_time 0.25220513343811035
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.358275 (42993/120000), AUC 0.5689737200737
ep7_train_time 8.160686016082764
Test Epoch7 threshold 0.9 Acc 0.9146381578947368, AUC 0.9805017709732056, avg_entr 0.046685781329870224
ep7_t0.9_test_time 0.2514381408691406
gc 0
Train Epoch8 Acc 0.3109 (37308/120000), AUC 0.570888102054596
ep8_train_time 8.14593768119812
Test Epoch8 threshold 0.9 Acc 0.9157894736842105, AUC 0.9802999496459961, avg_entr 0.042832184582948685
ep8_t0.9_test_time 0.25248169898986816
gc 0
Train Epoch9 Acc 0.26718333333333333 (32062/120000), AUC 0.5732432007789612
ep9_train_time 8.189404249191284
Test Epoch9 threshold 0.9 Acc 0.9151315789473684, AUC 0.980383038520813, avg_entr 0.039696965366601944
ep9_t0.9_test_time 0.25466156005859375
Best AUC 0.9807513952255249
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt
[[1364   56   75   37]
 [   9 1484    4   10]
 [  37   17 1323  123]
 [  38   17   91 1395]]
Figure(640x480)
tensor([0.0331, 0.0009, 0.0160,  ..., 0.0004, 0.0017, 0.0307])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([1.3063, 1.3580, 1.3631,  ..., 1.3197, 1.3367, 1.3479])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([1.1425, 1.1454, 1.1416,  ..., 1.1094, 1.1405, 1.1534])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([1.2257, 1.2416, 1.2291,  ..., 1.2266, 1.2225, 1.2383])
[[   0 1048    0  484]
 [   0 1194    0  313]
 [   0  806    0  694]
 [   0  521    2 1018]]
Figure(640x480)
tensor([1.0414, 1.1437, 1.1002,  ..., 1.0989, 1.0795, 1.0912])
