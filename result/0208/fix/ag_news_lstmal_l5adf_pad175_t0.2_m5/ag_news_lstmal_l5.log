total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.2_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9322916666666666 (111875/120000), AUC 0.9855816960334778
ep0_train_time 88.28655934333801
Test Epoch0 threshold 0.2 Acc 0.912828947368421, AUC 0.9794421792030334, avg_entr 0.012601116672158241
ep0_t0.2_test_time 0.5394876003265381
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.2_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9563916666666666 (114767/120000), AUC 0.9922506809234619
ep1_train_time 88.14567255973816
Test Epoch1 threshold 0.2 Acc 0.9126644736842106, AUC 0.9791034460067749, avg_entr 0.013114615343511105
ep1_t0.2_test_time 0.5800981521606445
gc 0
Train Epoch2 Acc 0.9589416666666667 (115073/120000), AUC 0.992864191532135
ep2_train_time 88.19841933250427
Test Epoch2 threshold 0.2 Acc 0.9134868421052632, AUC 0.9787412881851196, avg_entr 0.01316882949322462
ep2_t0.2_test_time 0.5470225811004639
gc 0
Train Epoch3 Acc 0.9615833333333333 (115390/120000), AUC 0.9932770133018494
ep3_train_time 88.18134784698486
Test Epoch3 threshold 0.2 Acc 0.9148026315789474, AUC 0.9783802032470703, avg_entr 0.012379243038594723
ep3_t0.2_test_time 0.5468800067901611
gc 0
Train Epoch4 Acc 0.9633333333333334 (115600/120000), AUC 0.993860125541687
ep4_train_time 88.18244409561157
Test Epoch4 threshold 0.2 Acc 0.9129934210526316, AUC 0.9783426523208618, avg_entr 0.012342232279479504
ep4_t0.2_test_time 0.5134263038635254
gc 0
Train Epoch5 Acc 0.9670833333333333 (116050/120000), AUC 0.9944829940795898
ep5_train_time 88.17527151107788
Test Epoch5 threshold 0.2 Acc 0.9111842105263158, AUC 0.9774008989334106, avg_entr 0.012610096484422684
ep5_t0.2_test_time 0.514747142791748
gc 0
Train Epoch6 Acc 0.9682666666666667 (116192/120000), AUC 0.9945223331451416
ep6_train_time 88.25751900672913
Test Epoch6 threshold 0.2 Acc 0.9123355263157895, AUC 0.9774017333984375, avg_entr 0.01210663840174675
ep6_t0.2_test_time 0.4793570041656494
gc 0
Train Epoch7 Acc 0.9692583333333333 (116311/120000), AUC 0.9946248531341553
ep7_train_time 88.20283842086792
Test Epoch7 threshold 0.2 Acc 0.909375, AUC 0.9769348502159119, avg_entr 0.012736044824123383
ep7_t0.2_test_time 0.5749013423919678
gc 0
Train Epoch8 Acc 0.970075 (116409/120000), AUC 0.9949028491973877
ep8_train_time 88.16659665107727
Test Epoch8 threshold 0.2 Acc 0.9116776315789473, AUC 0.9766730070114136, avg_entr 0.011876954697072506
ep8_t0.2_test_time 0.5088906288146973
gc 0
Train Epoch9 Acc 0.9718916666666667 (116627/120000), AUC 0.9949666261672974
ep9_train_time 88.09449934959412
Test Epoch9 threshold 0.2 Acc 0.9101973684210526, AUC 0.9761368036270142, avg_entr 0.011816538870334625
ep9_t0.2_test_time 0.502347469329834
Best AUC 0.9794421792030334
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.2_m5//ag_news_lstmal_l5_prefix.pt
[[1368   50   76   38]
 [  10 1476    8   13]
 [  32   11 1334  123]
 [  34   12  103 1392]]
Figure(640x480)
tensor([1.4631e-03, 4.3459e-08, 1.0323e-04,  ..., 3.3006e-08, 1.6408e-06,
        1.4710e-04])
[[1356   50   81   45]
 [  13 1474   13    7]
 [  39   13 1329  119]
 [  31   18  114 1378]]
Figure(640x480)
tensor([8.3518e-07, 1.9531e-07, 3.1747e-07,  ..., 1.7513e-07, 1.9238e-07,
        3.3149e-07])
[[1359   49   83   41]
 [  13 1474   14    6]
 [  38   13 1327  122]
 [  34   20  115 1372]]
Figure(640x480)
tensor([1.2883e-06, 1.8568e-07, 3.3564e-07,  ..., 1.8407e-07, 1.9824e-07,
        4.4618e-07])
[[1356   49   86   41]
 [  14 1473   14    6]
 [  43   11 1323  123]
 [  36   21  117 1367]]
Figure(640x480)
tensor([1.7006e-06, 3.4748e-07, 5.7440e-07,  ..., 3.1198e-07, 4.0263e-07,
        4.9183e-07])
[[1351   51   82   48]
 [  18 1468   16    5]
 [  36   13 1317  134]
 [  34   21  111 1375]]
Figure(640x480)
tensor([1.4671e-06, 1.2067e-07, 2.5350e-07,  ..., 4.8337e-07, 2.2180e-07,
        1.0119e-06])
