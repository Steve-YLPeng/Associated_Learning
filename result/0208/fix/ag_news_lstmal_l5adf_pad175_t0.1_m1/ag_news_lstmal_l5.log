total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24319166666666667 (29183/120000), AUC 0.5037878155708313
ep0_train_time 46.48823881149292
Test Epoch0 threshold 0.1 Acc 0.8995065789473684, AUC 0.9736779928207397, avg_entr 0.18241114914417267
ep0_t0.1_test_time 0.25590944290161133
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m1//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.22950833333333334 (27541/120000), AUC 0.5008304715156555
ep1_train_time 46.82281804084778
Test Epoch1 threshold 0.1 Acc 0.9111842105263158, AUC 0.9777244329452515, avg_entr 0.10622652620077133
ep1_t0.1_test_time 0.2538275718688965
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m1//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.22746666666666668 (27296/120000), AUC 0.49935534596443176
ep2_train_time 46.850536823272705
Test Epoch2 threshold 0.1 Acc 0.9149671052631579, AUC 0.9794395565986633, avg_entr 0.07903159409761429
ep2_t0.1_test_time 0.25346851348876953
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m1//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.22603333333333334 (27124/120000), AUC 0.4981245696544647
ep3_train_time 46.87951183319092
Test Epoch3 threshold 0.1 Acc 0.9180921052631579, AUC 0.9802868366241455, avg_entr 0.06805696338415146
ep3_t0.1_test_time 0.2541680335998535
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m1//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.22586666666666666 (27104/120000), AUC 0.4976806938648224
ep4_train_time 47.06027436256409
Test Epoch4 threshold 0.1 Acc 0.9154605263157894, AUC 0.9805376529693604, avg_entr 0.05863910913467407
ep4_t0.1_test_time 0.2545914649963379
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m1//ag_news_lstmal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.22616666666666665 (27140/120000), AUC 0.4974200427532196
ep5_train_time 47.12131857872009
Test Epoch5 threshold 0.1 Acc 0.9179276315789474, AUC 0.9807546138763428, avg_entr 0.05317379906773567
ep5_t0.1_test_time 0.25333356857299805
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m1//ag_news_lstmal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.22583333333333333 (27100/120000), AUC 0.4963684678077698
ep6_train_time 47.046247243881226
Test Epoch6 threshold 0.1 Acc 0.9144736842105263, AUC 0.9808676242828369, avg_entr 0.05061766132712364
ep6_t0.1_test_time 0.2536160945892334
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m1//ag_news_lstmal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.226525 (27183/120000), AUC 0.49596071243286133
ep7_train_time 47.10307812690735
Test Epoch7 threshold 0.1 Acc 0.9171052631578948, AUC 0.9807400703430176, avg_entr 0.04546255245804787
ep7_t0.1_test_time 0.255401611328125
gc 0
Train Epoch8 Acc 0.227075 (27249/120000), AUC 0.49535414576530457
ep8_train_time 47.15877938270569
Test Epoch8 threshold 0.1 Acc 0.9164473684210527, AUC 0.9806591868400574, avg_entr 0.04242592304944992
ep8_t0.1_test_time 0.2541694641113281
gc 0
Train Epoch9 Acc 0.22774166666666668 (27329/120000), AUC 0.4946121573448181
ep9_train_time 47.27156376838684
Test Epoch9 threshold 0.1 Acc 0.9162828947368421, AUC 0.980687141418457, avg_entr 0.040556054562330246
ep9_t0.1_test_time 0.25354862213134766
Best AUC 0.9808676242828369
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m1//ag_news_lstmal_l5_prefix.pt
[[1369   52   80   31]
 [  11 1481   10    5]
 [  34   10 1352  104]
 [  44   12  127 1358]]
Figure(640x480)
tensor([0.0501, 0.0004, 0.0188,  ..., 0.0004, 0.0041, 0.0119])
[[1444   76    8    4]
 [1489   10    5    3]
 [1415   50   34    1]
 [1532    6    2    1]]
Figure(640x480)
tensor([1.2241, 1.3215, 1.2085,  ..., 1.0732, 0.9904, 1.2571])
[[1209    0    1  322]
 [1089    0    0  418]
 [1182    0    0  318]
 [1278    0    0  263]]
Figure(640x480)
tensor([1.2598, 1.1804, 1.2531,  ..., 1.2834, 1.2031, 1.2161])
[[ 276    1    1 1254]
 [ 893   42    0  572]
 [ 215    3    0 1282]
 [ 301    5    0 1235]]
Figure(640x480)
tensor([1.3831, 1.4037, 1.4130,  ..., 1.3845, 1.3989, 1.3892])
[[1156  131  241    4]
 [ 659   32  792   24]
 [1317    5  163   15]
 [ 675   16  803   47]]
Figure(640x480)
tensor([1.4014, 1.4329, 1.4018,  ..., 1.4037, 1.3824, 1.3696])
