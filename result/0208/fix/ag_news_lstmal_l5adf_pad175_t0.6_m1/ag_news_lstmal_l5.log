total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24585833333333335 (29503/120000), AUC 0.4939490854740143
ep0_train_time 46.8913733959198
Test Epoch0 threshold 0.6 Acc 0.8988486842105263, AUC 0.9738160371780396, avg_entr 0.18417485058307648
ep0_t0.6_test_time 0.2526721954345703
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.23736666666666667 (28484/120000), AUC 0.5030410885810852
ep1_train_time 47.06887245178223
Test Epoch1 threshold 0.6 Acc 0.9097039473684211, AUC 0.9778093099594116, avg_entr 0.10596723854541779
ep1_t0.6_test_time 0.25183677673339844
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.23798333333333332 (28558/120000), AUC 0.5048069953918457
ep2_train_time 47.02692222595215
Test Epoch2 threshold 0.6 Acc 0.9126644736842106, AUC 0.9792980551719666, avg_entr 0.08092139661312103
ep2_t0.6_test_time 0.2514615058898926
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.23963333333333334 (28756/120000), AUC 0.5064599514007568
ep3_train_time 47.013415813446045
Test Epoch3 threshold 0.6 Acc 0.9154605263157894, AUC 0.97998046875, avg_entr 0.06676096469163895
ep3_t0.6_test_time 0.251812219619751
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.23993333333333333 (28792/120000), AUC 0.5071746110916138
ep4_train_time 47.12652277946472
Test Epoch4 threshold 0.6 Acc 0.9162828947368421, AUC 0.9805653095245361, avg_entr 0.06132756173610687
ep4_t0.6_test_time 0.2510249614715576
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24039166666666667 (28847/120000), AUC 0.5076760053634644
ep5_train_time 47.098907709121704
Test Epoch5 threshold 0.6 Acc 0.9161184210526315, AUC 0.980748176574707, avg_entr 0.053423840552568436
ep5_t0.6_test_time 0.2525455951690674
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24111666666666667 (28934/120000), AUC 0.5080916881561279
ep6_train_time 47.05286955833435
Test Epoch6 threshold 0.6 Acc 0.915625, AUC 0.9806960821151733, avg_entr 0.049469806253910065
ep6_t0.6_test_time 0.2506704330444336
gc 0
Train Epoch7 Acc 0.24165833333333334 (28999/120000), AUC 0.5085406303405762
ep7_train_time 47.20992398262024
Test Epoch7 threshold 0.6 Acc 0.9166118421052631, AUC 0.980647623538971, avg_entr 0.045480869710445404
ep7_t0.6_test_time 0.25489211082458496
gc 0
Train Epoch8 Acc 0.24178333333333332 (29014/120000), AUC 0.5085418224334717
ep8_train_time 47.23388671875
Test Epoch8 threshold 0.6 Acc 0.9172697368421052, AUC 0.9805960655212402, avg_entr 0.042950037866830826
ep8_t0.6_test_time 0.2519106864929199
gc 0
Train Epoch9 Acc 0.24254166666666666 (29105/120000), AUC 0.5087288618087769
ep9_train_time 47.19220495223999
Test Epoch9 threshold 0.6 Acc 0.9157894736842105, AUC 0.9803984761238098, avg_entr 0.041023749858140945
ep9_t0.6_test_time 0.25170350074768066
Best AUC 0.980748176574707
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt
[[1361   55   78   38]
 [   9 1482    5   11]
 [  34   14 1320  132]
 [  28   15   91 1407]]
Figure(640x480)
tensor([0.0236, 0.0010, 0.0173,  ..., 0.0009, 0.0027, 0.0374])
[[   5  818   74  635]
 [   7 1181   28  291]
 [  10 1034   31  425]
 [   9  813   10  709]]
Figure(640x480)
tensor([1.1609, 1.2909, 1.2989,  ..., 1.3143, 1.0896, 1.1232])
[[1465    2   41   24]
 [1363    1   36  107]
 [1268    4  177   51]
 [1478    7   38   18]]
Figure(640x480)
tensor([1.3734, 1.2476, 1.3807,  ..., 1.4029, 1.3353, 1.4131])
[[  72    4    0 1456]
 [ 168    0    0 1339]
 [  62    2    0 1436]
 [ 215    2    0 1324]]
Figure(640x480)
tensor([1.3334, 1.3794, 1.3901,  ..., 1.3537, 1.3281, 1.2704])
[[1172  359    0    1]
 [1177  328    2    0]
 [1163  337    0    0]
 [ 825  716    0    0]]
Figure(640x480)
tensor([1.4186, 1.3885, 1.4121,  ..., 1.4361, 1.4305, 1.4110])
