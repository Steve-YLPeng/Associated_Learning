total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.25146666666666667 (30176/120000), AUC 0.31565576791763306
ep0_train_time 9.093015432357788
Test Epoch0 threshold 0.3 Acc 0.9171052631578948, AUC 0.9811074733734131, avg_entr 0.02749403938651085
ep0_t0.3_test_time 0.26346778869628906
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24998333333333334 (29998/120000), AUC 0.06154853105545044
ep1_train_time 8.63774037361145
Test Epoch1 threshold 0.3 Acc 0.9151315789473684, AUC 0.9808260202407837, avg_entr 0.026266254484653473
ep1_t0.3_test_time 0.26111626625061035
gc 0
Train Epoch2 Acc 0.24994166666666667 (29993/120000), AUC 0.06258885562419891
ep2_train_time 8.661276817321777
Test Epoch2 threshold 0.3 Acc 0.9164473684210527, AUC 0.9807111024856567, avg_entr 0.02642524056136608
ep2_t0.3_test_time 0.2641286849975586
gc 0
Train Epoch3 Acc 0.24988333333333335 (29986/120000), AUC 0.062348201870918274
ep3_train_time 8.491859197616577
Test Epoch3 threshold 0.3 Acc 0.915296052631579, AUC 0.9807267189025879, avg_entr 0.02626633457839489
ep3_t0.3_test_time 0.26041483879089355
gc 0
Train Epoch4 Acc 0.24983333333333332 (29980/120000), AUC 0.06395326554775238
ep4_train_time 8.627422332763672
Test Epoch4 threshold 0.3 Acc 0.9164473684210527, AUC 0.9804778099060059, avg_entr 0.0248334351927042
ep4_t0.3_test_time 0.2617366313934326
gc 0
Train Epoch5 Acc 0.24978333333333333 (29974/120000), AUC 0.06273695826530457
ep5_train_time 8.681648254394531
Test Epoch5 threshold 0.3 Acc 0.9148026315789474, AUC 0.9804610013961792, avg_entr 0.025105750188231468
ep5_t0.3_test_time 0.26195693016052246
gc 0
Train Epoch6 Acc 0.24973333333333333 (29968/120000), AUC 0.06370846182107925
ep6_train_time 8.588007688522339
Test Epoch6 threshold 0.3 Acc 0.9159539473684211, AUC 0.9802682399749756, avg_entr 0.024988718330860138
ep6_t0.3_test_time 0.26079511642456055
gc 0
Train Epoch7 Acc 0.24966666666666668 (29960/120000), AUC 0.06459440290927887
ep7_train_time 8.644243240356445
Test Epoch7 threshold 0.3 Acc 0.9154605263157894, AUC 0.9801727533340454, avg_entr 0.02556433714926243
ep7_t0.3_test_time 0.25986313819885254
gc 0
Train Epoch8 Acc 0.24954166666666666 (29945/120000), AUC 0.0652649775147438
ep8_train_time 8.58781886100769
Test Epoch8 threshold 0.3 Acc 0.9151315789473684, AUC 0.9801772832870483, avg_entr 0.025737661868333817
ep8_t0.3_test_time 0.2626974582672119
gc 0
Train Epoch9 Acc 0.24948333333333333 (29938/120000), AUC 0.06483753025531769
ep9_train_time 8.726948261260986
Test Epoch9 threshold 0.3 Acc 0.9141447368421053, AUC 0.9799993634223938, avg_entr 0.02537478879094124
ep9_t0.3_test_time 0.2617619037628174
Best AUC 0.9811074733734131
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt
[[1361   53   80   38]
 [   9 1479    5   14]
 [  31   14 1332  123]
 [  30   13   95 1403]]
Figure(640x480)
tensor([1.3592e-03, 2.2893e-06, 2.5661e-04,  ..., 2.5303e-06, 3.0899e-05,
        3.4038e-03])
[[1365   54   74   39]
 [  10 1478    7   12]
 [  34   12 1325  129]
 [  32   13   96 1400]]
Figure(640x480)
tensor([8.9113e-03, 7.1184e-05, 8.4268e-04,  ..., 6.4323e-06, 3.6895e-04,
        8.6770e-03])
[[  45 1487    0    0]
 [1334  173    0    0]
 [   5 1495    0    0]
 [  54 1487    0    0]]
Figure(640x480)
tensor([1.2317, 1.0824, 1.0991,  ..., 0.7010, 1.1924, 1.2633])
[[   0    0 1532    0]
 [   0    0 1501    6]
 [   0    0 1499    1]
 [   0    1 1515   25]]
Figure(640x480)
tensor([0.9958, 1.2199, 1.2020,  ..., 1.1461, 1.1813, 1.0486])
[[   0    0    0 1532]
 [   0    0    0 1507]
 [   0    0    0 1500]
 [   0    0    1 1540]]
Figure(640x480)
tensor([0.9563, 1.0905, 0.9783,  ..., 0.8379, 1.0579, 0.9943])
