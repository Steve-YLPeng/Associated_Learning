total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m1//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.42728333333333335 (51274/120000), AUC 0.6741185784339905
ep0_train_time 56.030458211898804
Test Epoch0 threshold 0.1 Acc 0.9136513157894737, AUC 0.9788225889205933, avg_entr 0.011091182939708233
ep0_t0.1_test_time 0.39224863052368164
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m2//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.47613333333333335 (57136/120000), AUC 0.7075549364089966
ep1_train_time 55.95986270904541
Test Epoch1 threshold 0.1 Acc 0.9143092105263158, AUC 0.9793623089790344, avg_entr 0.010406414978206158
ep1_t0.1_test_time 0.3915517330169678
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m2//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.4836 (58032/120000), AUC 0.7130467891693115
ep2_train_time 55.97292113304138
Test Epoch2 threshold 0.1 Acc 0.9139802631578947, AUC 0.9784117937088013, avg_entr 0.009302128106355667
ep2_t0.1_test_time 0.3768730163574219
gc 0
Train Epoch3 Acc 0.4867666666666667 (58412/120000), AUC 0.7124283313751221
ep3_train_time 56.01156401634216
Test Epoch3 threshold 0.1 Acc 0.9138157894736842, AUC 0.978590726852417, avg_entr 0.009492368437349796
ep3_t0.1_test_time 0.376950740814209
gc 0
Train Epoch4 Acc 0.48883333333333334 (58660/120000), AUC 0.7146515846252441
ep4_train_time 55.9616641998291
Test Epoch4 threshold 0.1 Acc 0.9123355263157895, AUC 0.9779281616210938, avg_entr 0.009375052526593208
ep4_t0.1_test_time 0.37764620780944824
gc 0
Train Epoch5 Acc 0.489425 (58731/120000), AUC 0.7153910398483276
ep5_train_time 55.93955039978027
Test Epoch5 threshold 0.1 Acc 0.9108552631578948, AUC 0.977360188961029, avg_entr 0.009054739028215408
ep5_t0.1_test_time 0.38732218742370605
gc 0
Train Epoch6 Acc 0.49064166666666664 (58877/120000), AUC 0.7219980359077454
ep6_train_time 55.967934370040894
Test Epoch6 threshold 0.1 Acc 0.9120065789473685, AUC 0.9774429202079773, avg_entr 0.009252293035387993
ep6_t0.1_test_time 0.3885457515716553
gc 0
Train Epoch7 Acc 0.48999166666666666 (58799/120000), AUC 0.7186705470085144
ep7_train_time 55.97386932373047
Test Epoch7 threshold 0.1 Acc 0.9095394736842105, AUC 0.9770394563674927, avg_entr 0.008596534840762615
ep7_t0.1_test_time 0.37744593620300293
gc 0
Train Epoch8 Acc 0.4896583333333333 (58759/120000), AUC 0.7164632678031921
ep8_train_time 56.13377046585083
Test Epoch8 threshold 0.1 Acc 0.9101973684210526, AUC 0.9768456220626831, avg_entr 0.008463718928396702
ep8_t0.1_test_time 0.3771548271179199
gc 0
Train Epoch9 Acc 0.489525 (58743/120000), AUC 0.7142409086227417
ep9_train_time 56.1898992061615
Test Epoch9 threshold 0.1 Acc 0.9088815789473684, AUC 0.9762952923774719, avg_entr 0.007835768163204193
ep9_t0.1_test_time 0.3775138854980469
Best AUC 0.9793623089790344
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m2//ag_news_lstmal_l5_prefix.pt
[[1374   51   74   33]
 [  11 1479    8    9]
 [  37   14 1335  114]
 [  40   13  105 1383]]
Figure(640x480)
tensor([1.9509e-03, 9.7155e-07, 3.5197e-04,  ..., 3.5665e-07, 1.2880e-05,
        2.3418e-04])
[[1382   47   58   45]
 [  18 1474    6    9]
 [  47   13 1322  118]
 [  37   20  114 1370]]
Figure(640x480)
tensor([6.7073e-06, 9.2762e-07, 2.3477e-06,  ..., 9.6777e-07, 4.4227e-06,
        2.7370e-06])
[[1527    5    0    0]
 [1505    2    0    0]
 [1446   54    0    0]
 [ 768  773    0    0]]
Figure(640x480)
tensor([0.9477, 1.0899, 0.9322,  ..., 0.8101, 1.0708, 0.8467])
[[ 726    0    0  806]
 [  72    0    0 1435]
 [   2    0    0 1498]
 [  10    0    0 1531]]
Figure(640x480)
tensor([1.3017, 1.0952, 1.1317,  ..., 0.8671, 1.1706, 1.2270])
[[  30 1474    0   28]
 [   2 1501    0    4]
 [1033  281    0  186]
 [  84  136    0 1321]]
Figure(640x480)
tensor([1.1627, 1.2264, 1.1852,  ..., 1.2278, 1.1400, 1.2626])
