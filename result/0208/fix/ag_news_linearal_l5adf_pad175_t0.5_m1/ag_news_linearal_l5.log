total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24826666666666666 (29792/120000), AUC 0.4785892367362976
ep0_train_time 8.67595887184143
Test Epoch0 threshold 0.5 Acc 0.9009868421052631, AUC 0.9736723899841309, avg_entr 0.18497894704341888
ep0_t0.5_test_time 0.25000810623168945
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24929166666666666 (29915/120000), AUC 0.39958655834198
ep1_train_time 7.955263376235962
Test Epoch1 threshold 0.5 Acc 0.9113486842105263, AUC 0.9775828123092651, avg_entr 0.10549621284008026
ep1_t0.5_test_time 0.24991512298583984
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24926666666666666 (29912/120000), AUC 0.3981841206550598
ep2_train_time 7.9592437744140625
Test Epoch2 threshold 0.5 Acc 0.9144736842105263, AUC 0.9795044660568237, avg_entr 0.08071385324001312
ep2_t0.5_test_time 0.24874114990234375
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24915 (29898/120000), AUC 0.4002602696418762
ep3_train_time 8.21009111404419
Test Epoch3 threshold 0.5 Acc 0.9151315789473684, AUC 0.9801449775695801, avg_entr 0.06799418479204178
ep3_t0.5_test_time 0.24972820281982422
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24905833333333333 (29887/120000), AUC 0.4014278054237366
ep4_train_time 8.066641569137573
Test Epoch4 threshold 0.5 Acc 0.915296052631579, AUC 0.980420708656311, avg_entr 0.059618860483169556
ep4_t0.5_test_time 0.25043225288391113
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24898333333333333 (29878/120000), AUC 0.4029655456542969
ep5_train_time 8.020068168640137
Test Epoch5 threshold 0.5 Acc 0.9139802631578947, AUC 0.9806370139122009, avg_entr 0.05494633689522743
ep5_t0.5_test_time 0.24947667121887207
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24891666666666667 (29870/120000), AUC 0.4039420485496521
ep6_train_time 8.09693956375122
Test Epoch6 threshold 0.5 Acc 0.9148026315789474, AUC 0.9806539416313171, avg_entr 0.0490044504404068
ep6_t0.5_test_time 0.24971842765808105
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.248825 (29859/120000), AUC 0.40436625480651855
ep7_train_time 7.9453558921813965
Test Epoch7 threshold 0.5 Acc 0.9154605263157894, AUC 0.9806225299835205, avg_entr 0.045793116092681885
ep7_t0.5_test_time 0.24956917762756348
gc 0
Train Epoch8 Acc 0.24871666666666667 (29846/120000), AUC 0.40524357557296753
ep8_train_time 8.146678686141968
Test Epoch8 threshold 0.5 Acc 0.9161184210526315, AUC 0.9803491830825806, avg_entr 0.043217770755290985
ep8_t0.5_test_time 0.24937987327575684
gc 0
Train Epoch9 Acc 0.24854166666666666 (29825/120000), AUC 0.405626505613327
ep9_train_time 7.900219678878784
Test Epoch9 threshold 0.5 Acc 0.9154605263157894, AUC 0.9804855585098267, avg_entr 0.0416930615901947
ep9_t0.5_test_time 0.24899673461914062
Best AUC 0.9806539416313171
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt
[[1366   54   72   40]
 [  11 1482    3   11]
 [  38   16 1319  127]
 [  37   18   91 1395]]
Figure(640x480)
tensor([0.0308, 0.0009, 0.0160,  ..., 0.0005, 0.0017, 0.0387])
[[   0    0    0 1532]
 [   0    0    0 1507]
 [   1    0    0 1499]
 [   4    0    0 1537]]
Figure(640x480)
tensor([1.0119, 1.0845, 1.0492,  ..., 1.0306, 1.0629, 1.1092])
[[   0 1532    0    0]
 [   0 1507    0    0]
 [   0 1500    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([1.2455, 1.2243, 1.2353,  ..., 1.2489, 1.2317, 1.2607])
[[   0 1532    0    0]
 [   0 1507    0    0]
 [   0 1500    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([1.1475, 1.1922, 1.1486,  ..., 1.1804, 1.1607, 1.1919])
[[   0    0    2 1530]
 [   0    0    0 1507]
 [   0    0    1 1499]
 [   0    0   11 1530]]
Figure(640x480)
tensor([1.3024, 1.3337, 1.3216,  ..., 1.3295, 1.3339, 1.3107])
