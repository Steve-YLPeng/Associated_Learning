total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.23110833333333333 (27733/120000), AUC 0.5241420269012451
ep0_train_time 9.956549644470215
Test Epoch0 threshold 0.3 Acc 0.9166118421052631, AUC 0.9806485176086426, avg_entr 0.025427943095564842
ep0_t0.3_test_time 0.2649977207183838
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25333333333333335 (30400/120000), AUC 0.5209933519363403
ep1_train_time 9.466545343399048
Test Epoch1 threshold 0.3 Acc 0.9121710526315789, AUC 0.9808369874954224, avg_entr 0.025925420224666595
ep1_t0.3_test_time 0.2654273509979248
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2559416666666667 (30713/120000), AUC 0.5536735653877258
ep2_train_time 9.478106260299683
Test Epoch2 threshold 0.3 Acc 0.9139802631578947, AUC 0.9806555509567261, avg_entr 0.024648522958159447
ep2_t0.3_test_time 0.263242244720459
gc 0
Train Epoch3 Acc 0.2656 (31872/120000), AUC 0.5355021357536316
ep3_train_time 9.44556212425232
Test Epoch3 threshold 0.3 Acc 0.9138157894736842, AUC 0.9805379509925842, avg_entr 0.025505708530545235
ep3_t0.3_test_time 0.26809191703796387
gc 0
Train Epoch4 Acc 0.35820833333333335 (42985/120000), AUC 0.4720580279827118
ep4_train_time 9.419082403182983
Test Epoch4 threshold 0.3 Acc 0.9144736842105263, AUC 0.9803846478462219, avg_entr 0.024469325318932533
ep4_t0.3_test_time 0.26120734214782715
gc 0
Train Epoch5 Acc 0.396025 (47523/120000), AUC 0.45668327808380127
ep5_train_time 9.376742601394653
Test Epoch5 threshold 0.3 Acc 0.9123355263157895, AUC 0.9801952838897705, avg_entr 0.02402643859386444
ep5_t0.3_test_time 0.26081061363220215
gc 0
Train Epoch6 Acc 0.38235833333333336 (45883/120000), AUC 0.4570976793766022
ep6_train_time 9.606994867324829
Test Epoch6 threshold 0.3 Acc 0.9146381578947368, AUC 0.9799432158470154, avg_entr 0.02500898391008377
ep6_t0.3_test_time 0.25961828231811523
gc 0
Train Epoch7 Acc 0.35956666666666665 (43148/120000), AUC 0.4589313268661499
ep7_train_time 9.5062575340271
Test Epoch7 threshold 0.3 Acc 0.9139802631578947, AUC 0.9799125790596008, avg_entr 0.024660658091306686
ep7_t0.3_test_time 0.2613801956176758
gc 0
Train Epoch8 Acc 0.33770833333333333 (40525/120000), AUC 0.46184489130973816
ep8_train_time 9.354580163955688
Test Epoch8 threshold 0.3 Acc 0.9115131578947369, AUC 0.9798009991645813, avg_entr 0.0254052821546793
ep8_t0.3_test_time 0.25836753845214844
gc 0
Train Epoch9 Acc 0.32464166666666666 (38957/120000), AUC 0.4631555676460266
ep9_train_time 9.530696392059326
Test Epoch9 threshold 0.3 Acc 0.9110197368421052, AUC 0.9796944856643677, avg_entr 0.02516195923089981
ep9_t0.3_test_time 0.260239839553833
Best AUC 0.9808369874954224
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt
[[1374   50   79   29]
 [  15 1472   13    7]
 [  34   11 1348  107]
 [  40   13  131 1357]]
Figure(640x480)
tensor([8.4852e-04, 5.1848e-08, 6.7673e-04,  ..., 3.2137e-08, 1.5888e-05,
        3.9989e-05])
[[1375   50   77   30]
 [  14 1471   13    9]
 [  33   10 1349  108]
 [  39   14  130 1358]]
Figure(640x480)
tensor([1.5722e-03, 5.8305e-07, 8.6314e-04,  ..., 5.9531e-08, 2.0391e-05,
        1.0911e-04])
[[1375   50   76   31]
 [  15 1469   13   10]
 [  36   10 1349  105]
 [  37   13  132 1359]]
Figure(640x480)
tensor([5.4690e-04, 7.2969e-07, 3.2438e-04,  ..., 3.5335e-08, 1.0631e-05,
        4.5323e-05])
[[1375   50   78   29]
 [  15 1470   14    8]
 [  35   10 1354  101]
 [  41   14  132 1354]]
Figure(640x480)
tensor([3.9945e-04, 1.6316e-07, 1.7739e-04,  ..., 3.8504e-08, 7.9972e-06,
        7.0019e-06])
[[  39    0 1493    0]
 [1304    2  196    5]
 [   3    0 1497    0]
 [   2    1 1538    0]]
Figure(640x480)
tensor([0.4564, 0.2276, 0.4938,  ..., 0.5831, 0.4204, 0.5384])
