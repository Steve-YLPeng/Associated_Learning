total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.07491666666666667 (8990/120000), AUC 0.2258872091770172
ep0_train_time 9.064398527145386
Test Epoch0 threshold 0.5 Acc 0.9171052631578948, AUC 0.9809228181838989, avg_entr 0.028463777154684067
ep0_t0.5_test_time 0.252871036529541
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.00885 (1062/120000), AUC 0.147579625248909
ep1_train_time 8.507786273956299
Test Epoch1 threshold 0.5 Acc 0.9146381578947368, AUC 0.9807928800582886, avg_entr 0.02722453884780407
ep1_t0.5_test_time 0.25192785263061523
gc 0
Train Epoch2 Acc 0.008925 (1071/120000), AUC 0.1462479531764984
ep2_train_time 8.531180143356323
Test Epoch2 threshold 0.5 Acc 0.9169407894736842, AUC 0.9806601405143738, avg_entr 0.027134528383612633
ep2_t0.5_test_time 0.2521347999572754
gc 0
Train Epoch3 Acc 0.009941666666666666 (1193/120000), AUC 0.14629453420639038
ep3_train_time 8.662307500839233
Test Epoch3 threshold 0.5 Acc 0.9157894736842105, AUC 0.980588436126709, avg_entr 0.026245804503560066
ep3_t0.5_test_time 0.25124192237854004
gc 0
Train Epoch4 Acc 0.010791666666666666 (1295/120000), AUC 0.14614781737327576
ep4_train_time 8.565124750137329
Test Epoch4 threshold 0.5 Acc 0.915625, AUC 0.9804226160049438, avg_entr 0.026574501767754555
ep4_t0.5_test_time 0.2516014575958252
gc 0
Train Epoch5 Acc 0.011041666666666667 (1325/120000), AUC 0.1448182761669159
ep5_train_time 8.406835079193115
Test Epoch5 threshold 0.5 Acc 0.9138157894736842, AUC 0.9802727699279785, avg_entr 0.026516471058130264
ep5_t0.5_test_time 0.2523329257965088
gc 0
Train Epoch6 Acc 0.01105 (1326/120000), AUC 0.1447536051273346
ep6_train_time 8.489765405654907
Test Epoch6 threshold 0.5 Acc 0.9151315789473684, AUC 0.9802083969116211, avg_entr 0.026318464428186417
ep6_t0.5_test_time 0.25203442573547363
gc 0
Train Epoch7 Acc 0.011316666666666666 (1358/120000), AUC 0.14439436793327332
ep7_train_time 8.54315733909607
Test Epoch7 threshold 0.5 Acc 0.9148026315789474, AUC 0.9800147414207458, avg_entr 0.02629985101521015
ep7_t0.5_test_time 0.2509281635284424
gc 0
Train Epoch8 Acc 0.011575 (1389/120000), AUC 0.14419570565223694
ep8_train_time 8.469387292861938
Test Epoch8 threshold 0.5 Acc 0.9141447368421053, AUC 0.9799496531486511, avg_entr 0.026158588007092476
ep8_t0.5_test_time 0.25098514556884766
gc 0
Train Epoch9 Acc 0.011666666666666667 (1400/120000), AUC 0.1435743123292923
ep9_train_time 8.564178943634033
Test Epoch9 threshold 0.5 Acc 0.9144736842105263, AUC 0.9799180626869202, avg_entr 0.026548903435468674
ep9_t0.5_test_time 0.2515997886657715
Best AUC 0.9809228181838989
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt
[[1382   50   69   31]
 [  15 1478    4   10]
 [  40   15 1331  114]
 [  42   15   99 1385]]
Figure(640x480)
tensor([3.5327e-03, 2.7276e-06, 6.2034e-04,  ..., 1.4509e-06, 2.8448e-05,
        3.0589e-03])
[[1374   53   72   33]
 [  15 1481    3    8]
 [  39   15 1323  123]
 [  47   16   93 1385]]
Figure(640x480)
tensor([1.2251e-02, 1.5042e-05, 2.2706e-03,  ..., 2.6389e-06, 4.9012e-04,
        2.0958e-03])
[[   0 1532    0    0]
 [  14 1493    0    0]
 [   0 1500    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([0.8538, 0.9963, 0.9214,  ..., 0.8419, 0.9484, 0.8188])
[[ 231    0 1301    0]
 [1243    0  264    0]
 [1480    0   20    0]
 [1465    0   76    0]]
Figure(640x480)
tensor([1.1263, 1.0695, 1.1408,  ..., 1.0207, 1.1072, 1.0990])
[[   0 1047  397   88]
 [   0   24    1 1482]
 [   0 1449   43    8]
 [   0  490 1018   33]]
Figure(640x480)
tensor([1.0317, 1.3126, 1.2230,  ..., 1.1850, 1.2412, 1.1082])
