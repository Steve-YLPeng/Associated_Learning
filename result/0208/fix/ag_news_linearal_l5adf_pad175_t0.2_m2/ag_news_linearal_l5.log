total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.254775 (30573/120000), AUC 0.5484996438026428
ep0_train_time 9.259159803390503
Test Epoch0 threshold 0.2 Acc 0.9166118421052631, AUC 0.9809589385986328, avg_entr 0.02462390623986721
ep0_t0.2_test_time 0.2622342109680176
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.249375 (29925/120000), AUC 0.6145781874656677
ep1_train_time 8.656055212020874
Test Epoch1 threshold 0.2 Acc 0.9148026315789474, AUC 0.980636477470398, avg_entr 0.02478848583996296
ep1_t0.2_test_time 0.2602367401123047
gc 0
Train Epoch2 Acc 0.249825 (29979/120000), AUC 0.6221261620521545
ep2_train_time 8.598078727722168
Test Epoch2 threshold 0.2 Acc 0.9157894736842105, AUC 0.9806348085403442, avg_entr 0.026332393288612366
ep2_t0.2_test_time 0.25913548469543457
gc 0
Train Epoch3 Acc 0.24984166666666666 (29981/120000), AUC 0.6255263090133667
ep3_train_time 8.52113389968872
Test Epoch3 threshold 0.2 Acc 0.9159539473684211, AUC 0.9804114699363708, avg_entr 0.025355547666549683
ep3_t0.2_test_time 0.26019978523254395
gc 0
Train Epoch4 Acc 0.24975833333333333 (29971/120000), AUC 0.6269873380661011
ep4_train_time 8.48207974433899
Test Epoch4 threshold 0.2 Acc 0.9143092105263158, AUC 0.9803872108459473, avg_entr 0.024606183171272278
ep4_t0.2_test_time 0.26047825813293457
gc 0
Train Epoch5 Acc 0.24966666666666668 (29960/120000), AUC 0.6277710199356079
ep5_train_time 8.615020036697388
Test Epoch5 threshold 0.2 Acc 0.9151315789473684, AUC 0.9802175164222717, avg_entr 0.025210987776517868
ep5_t0.2_test_time 0.26196789741516113
gc 0
Train Epoch6 Acc 0.249525 (29943/120000), AUC 0.6290097236633301
ep6_train_time 8.714591264724731
Test Epoch6 threshold 0.2 Acc 0.9138157894736842, AUC 0.9801540374755859, avg_entr 0.024467846378684044
ep6_t0.2_test_time 0.25985264778137207
gc 0
Train Epoch7 Acc 0.24933333333333332 (29920/120000), AUC 0.6305544376373291
ep7_train_time 8.596112489700317
Test Epoch7 threshold 0.2 Acc 0.9146381578947368, AUC 0.9801449179649353, avg_entr 0.025977294892072678
ep7_t0.2_test_time 0.26073741912841797
gc 0
Train Epoch8 Acc 0.24909166666666666 (29891/120000), AUC 0.632171630859375
ep8_train_time 8.627532005310059
Test Epoch8 threshold 0.2 Acc 0.9136513157894737, AUC 0.980040431022644, avg_entr 0.024544233456254005
ep8_t0.2_test_time 0.26671791076660156
gc 0
Train Epoch9 Acc 0.248925 (29871/120000), AUC 0.6334561109542847
ep9_train_time 8.761870384216309
Test Epoch9 threshold 0.2 Acc 0.9143092105263158, AUC 0.9799895882606506, avg_entr 0.025777623057365417
ep9_t0.2_test_time 0.26019811630249023
Best AUC 0.9809589385986328
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt
[[1379   53   67   33]
 [  13 1483    3    8]
 [  39   17 1320  124]
 [  40   17   90 1394]]
Figure(640x480)
tensor([5.0712e-03, 4.8430e-06, 3.5288e-04,  ..., 1.6582e-06, 1.2761e-05,
        3.0301e-03])
[[1379   54   67   32]
 [  12 1484    3    8]
 [  40   19 1324  117]
 [  42   20   96 1383]]
Figure(640x480)
tensor([2.4188e-02, 8.0834e-06, 2.8459e-03,  ..., 6.9578e-06, 6.4397e-04,
        1.4600e-02])
[[1270    0  262    0]
 [   1    0 1506    0]
 [ 250    0 1250    0]
 [ 908    0  633    0]]
Figure(640x480)
tensor([0.9495, 0.7340, 0.8079,  ..., 0.8664, 0.7904, 0.8117])
[[1532    0    0    0]
 [1507    0    0    0]
 [1499    0    0    1]
 [1536    3    0    2]]
Figure(640x480)
tensor([0.6799, 1.0179, 0.8853,  ..., 0.9305, 0.9024, 0.7131])
[[1512    0   20    0]
 [ 710    0  797    0]
 [1482    0    1   17]
 [1540    0    1    0]]
Figure(640x480)
tensor([1.1676, 1.0720, 1.1318,  ..., 1.2310, 1.1158, 1.1171])
