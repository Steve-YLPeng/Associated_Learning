total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.5_m1//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.340525 (40863/120000), AUC 0.4933195412158966
ep0_train_time 55.920875787734985
Test Epoch0 threshold 0.5 Acc 0.9154605263157894, AUC 0.9808876514434814, avg_entr 0.028438474982976913
ep0_t0.5_test_time 0.2606360912322998
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.5_m2//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3691583333333333 (44299/120000), AUC 0.48577064275741577
ep1_train_time 56.00723099708557
Test Epoch1 threshold 0.5 Acc 0.9171052631578948, AUC 0.98111492395401, avg_entr 0.026984769850969315
ep1_t0.5_test_time 0.26117920875549316
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.5_m2//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.36615 (43938/120000), AUC 0.4600065052509308
ep2_train_time 55.94168400764465
Test Epoch2 threshold 0.5 Acc 0.9162828947368421, AUC 0.98105788230896, avg_entr 0.026708833873271942
ep2_t0.5_test_time 0.2564997673034668
gc 0
Train Epoch3 Acc 0.373375 (44805/120000), AUC 0.4440634548664093
ep3_train_time 55.92887258529663
Test Epoch3 threshold 0.5 Acc 0.9159539473684211, AUC 0.9809179306030273, avg_entr 0.02510390244424343
ep3_t0.5_test_time 0.271700382232666
gc 0
Train Epoch4 Acc 0.36785 (44142/120000), AUC 0.4400617182254791
ep4_train_time 55.81796884536743
Test Epoch4 threshold 0.5 Acc 0.9167763157894737, AUC 0.9806283712387085, avg_entr 0.026318592950701714
ep4_t0.5_test_time 0.2597219944000244
gc 0
Train Epoch5 Acc 0.3495 (41940/120000), AUC 0.43908485770225525
ep5_train_time 55.91011929512024
Test Epoch5 threshold 0.5 Acc 0.915625, AUC 0.98053377866745, avg_entr 0.026342643424868584
ep5_t0.5_test_time 0.2613985538482666
gc 0
Train Epoch6 Acc 0.3466166666666667 (41594/120000), AUC 0.4391023516654968
ep6_train_time 55.86936140060425
Test Epoch6 threshold 0.5 Acc 0.9141447368421053, AUC 0.9805421233177185, avg_entr 0.025567639619112015
ep6_t0.5_test_time 0.2618708610534668
gc 0
Train Epoch7 Acc 0.34824166666666667 (41789/120000), AUC 0.4423918128013611
ep7_train_time 55.995023250579834
Test Epoch7 threshold 0.5 Acc 0.9162828947368421, AUC 0.9803194999694824, avg_entr 0.025565583258867264
ep7_t0.5_test_time 0.25736093521118164
gc 0
Train Epoch8 Acc 0.34135 (40962/120000), AUC 0.44567227363586426
ep8_train_time 55.91721248626709
Test Epoch8 threshold 0.5 Acc 0.9148026315789474, AUC 0.9802875518798828, avg_entr 0.025884266942739487
ep8_t0.5_test_time 0.25505518913269043
gc 0
Train Epoch9 Acc 0.3329916666666667 (39959/120000), AUC 0.4453285038471222
ep9_train_time 55.94806241989136
Test Epoch9 threshold 0.5 Acc 0.9136513157894737, AUC 0.98021399974823, avg_entr 0.026869457215070724
ep9_t0.5_test_time 0.25767040252685547
Best AUC 0.98111492395401
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.5_m2//ag_news_lstmal_l5_prefix.pt
[[1374   50   71   37]
 [  12 1478    5   12]
 [  38   12 1319  131]
 [  38   13   85 1405]]
Figure(640x480)
tensor([1.8636e-03, 6.8219e-07, 1.1295e-04,  ..., 7.9843e-07, 8.3611e-06,
        1.1442e-03])
[[1387   46   56   43]
 [  15 1473    8   11]
 [  51    8 1322  119]
 [  36   15  117 1373]]
Figure(640x480)
tensor([1.7128e-05, 2.5292e-06, 2.3737e-06,  ..., 1.2061e-06, 2.5791e-06,
        4.7945e-06])
[[   0 1322   25  185]
 [   0  630  876    1]
 [   0 1498    1    1]
 [   0 1538    1    2]]
Figure(640x480)
tensor([0.7803, 0.6730, 0.7837,  ..., 0.6091, 0.8887, 0.6853])
[[   0    0 1532    0]
 [   0    0 1507    0]
 [   0    0 1500    0]
 [   0    0 1541    0]]
Figure(640x480)
tensor([0.7958, 0.7743, 0.8552,  ..., 1.1813, 0.7630, 0.7818])
[[   0 1031  501    0]
 [   0  698  809    0]
 [   0   57 1443    0]
 [   0  857  684    0]]
Figure(640x480)
tensor([0.9199, 1.2248, 1.2171,  ..., 1.0044, 1.1811, 0.9174])
