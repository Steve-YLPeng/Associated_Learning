total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.8_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.24999166666666667 (29999/120000), AUC 0.5566349625587463
ep0_train_time 77.98549580574036
Test Epoch0 threshold 0.8 Acc 0.9148026315789474, AUC 0.9805862903594971, avg_entr 0.025024855509400368
ep0_t0.8_test_time 0.2592015266418457
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.8_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24990833333333334 (29989/120000), AUC 0.5320740938186646
ep1_train_time 78.05059218406677
Test Epoch1 threshold 0.8 Acc 0.9161184210526315, AUC 0.9802678823471069, avg_entr 0.025683170184493065
ep1_t0.8_test_time 0.2570228576660156
gc 0
Train Epoch2 Acc 0.24949166666666667 (29939/120000), AUC 0.4750233292579651
ep2_train_time 77.87930798530579
Test Epoch2 threshold 0.8 Acc 0.9141447368421053, AUC 0.980273425579071, avg_entr 0.024840399622917175
ep2_t0.8_test_time 0.25155115127563477
gc 0
Train Epoch3 Acc 0.24908333333333332 (29890/120000), AUC 0.44667884707450867
ep3_train_time 77.73943853378296
Test Epoch3 threshold 0.8 Acc 0.9136513157894737, AUC 0.9801511764526367, avg_entr 0.025737125426530838
ep3_t0.8_test_time 0.25174808502197266
gc 0
Train Epoch4 Acc 0.24806666666666666 (29768/120000), AUC 0.43387484550476074
ep4_train_time 77.70985102653503
Test Epoch4 threshold 0.8 Acc 0.9146381578947368, AUC 0.9799116849899292, avg_entr 0.026065101847052574
ep4_t0.8_test_time 0.25115513801574707
gc 0
Train Epoch5 Acc 0.24794166666666667 (29753/120000), AUC 0.42825183272361755
ep5_train_time 77.68072891235352
Test Epoch5 threshold 0.8 Acc 0.9136513157894737, AUC 0.9798617959022522, avg_entr 0.025416525080800056
ep5_t0.8_test_time 0.2550039291381836
gc 0
Train Epoch6 Acc 0.24540833333333334 (29449/120000), AUC 0.42687276005744934
ep6_train_time 77.66492986679077
Test Epoch6 threshold 0.8 Acc 0.9139802631578947, AUC 0.9797734618186951, avg_entr 0.025840144604444504
ep6_t0.8_test_time 0.2514834403991699
gc 0
Train Epoch7 Acc 0.24610833333333335 (29533/120000), AUC 0.4230879247188568
ep7_train_time 77.64058041572571
Test Epoch7 threshold 0.8 Acc 0.9126644736842106, AUC 0.9796628355979919, avg_entr 0.025841157883405685
ep7_t0.8_test_time 0.2525060176849365
gc 0
Train Epoch8 Acc 0.24375 (29250/120000), AUC 0.41650018095970154
ep8_train_time 77.63462090492249
Test Epoch8 threshold 0.8 Acc 0.9125, AUC 0.979573667049408, avg_entr 0.026021555066108704
ep8_t0.8_test_time 0.25326108932495117
gc 0
Train Epoch9 Acc 0.24343333333333333 (29212/120000), AUC 0.4091743230819702
ep9_train_time 77.84105014801025
Test Epoch9 threshold 0.8 Acc 0.9134868421052632, AUC 0.979547917842865, avg_entr 0.025746382772922516
ep9_t0.8_test_time 0.2527773380279541
Best AUC 0.9805862903594971
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.8_m4//ag_news_lstmal_l5_prefix.pt
[[1368   52   78   34]
 [  10 1481   10    6]
 [  29   12 1349  110]
 [  35   17  125 1364]]
Figure(640x480)
tensor([2.9953e-04, 6.8363e-08, 5.7314e-04,  ..., 2.8773e-08, 2.2421e-06,
        5.6653e-05])
[[1375   50   56   51]
 [  11 1479   11    6]
 [  48   14 1309  129]
 [  38   16  102 1385]]
Figure(640x480)
tensor([5.7475e-07, 2.6997e-07, 2.0602e-07,  ..., 1.0399e-07, 3.6810e-07,
        2.5232e-07])
[[1375   50   56   51]
 [  11 1479   11    6]
 [  50   14 1307  129]
 [  38   18   94 1391]]
Figure(640x480)
tensor([6.5720e-07, 2.1719e-07, 6.2041e-07,  ..., 9.0196e-08, 3.7822e-07,
        2.3084e-07])
[[1373   51   59   49]
 [  13 1478   11    5]
 [  47   14 1305  134]
 [  38   20   98 1385]]
Figure(640x480)
tensor([4.4434e-07, 8.8143e-07, 1.5017e-06,  ..., 4.8174e-07, 6.0871e-07,
        1.4107e-07])
[[   0 1532    0    0]
 [   2 1505    0    0]
 [   0 1500    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([0.7956, 0.6755, 0.6869,  ..., 0.9302, 0.7195, 0.8432])
