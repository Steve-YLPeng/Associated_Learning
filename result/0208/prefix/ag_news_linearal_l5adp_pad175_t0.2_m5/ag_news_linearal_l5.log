total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9104416666666667 (109253/120000), AUC 0.9857127070426941
ep0_train_time 10.566359043121338
Test Epoch0 threshold 0.2 Acc 0.9126644736842106, AUC 0.9803369045257568, avg_entr 0.022278863936662674
ep0_t0.2_test_time 0.2915680408477783
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9496416666666667 (113957/120000), AUC 0.9933136701583862
ep1_train_time 10.122987031936646
Test Epoch1 threshold 0.2 Acc 0.9134868421052632, AUC 0.9802698493003845, avg_entr 0.021569127216935158
ep1_t0.2_test_time 0.28705739974975586
gc 0
Train Epoch2 Acc 0.9514 (114168/120000), AUC 0.9935162663459778
ep2_train_time 10.096519231796265
Test Epoch2 threshold 0.2 Acc 0.9126644736842106, AUC 0.9801891446113586, avg_entr 0.018700746819376945
ep2_t0.2_test_time 0.2919316291809082
gc 0
Train Epoch3 Acc 0.9521583333333333 (114259/120000), AUC 0.9934536814689636
ep3_train_time 10.075594663619995
Test Epoch3 threshold 0.2 Acc 0.9141447368421053, AUC 0.9797587394714355, avg_entr 0.01840784400701523
ep3_t0.2_test_time 0.28644490242004395
gc 0
Train Epoch4 Acc 0.9533083333333333 (114397/120000), AUC 0.9937459826469421
ep4_train_time 10.168660402297974
Test Epoch4 threshold 0.2 Acc 0.912828947368421, AUC 0.9797956347465515, avg_entr 0.018615813925862312
ep4_t0.2_test_time 0.2868201732635498
gc 0
Train Epoch5 Acc 0.9546416666666667 (114557/120000), AUC 0.9944671392440796
ep5_train_time 10.146292448043823
Test Epoch5 threshold 0.2 Acc 0.9111842105263158, AUC 0.9796530604362488, avg_entr 0.018027158454060555
ep5_t0.2_test_time 0.28484439849853516
gc 0
Train Epoch6 Acc 0.955275 (114633/120000), AUC 0.9945845603942871
ep6_train_time 10.050361394882202
Test Epoch6 threshold 0.2 Acc 0.9129934210526316, AUC 0.9795924425125122, avg_entr 0.017843259498476982
ep6_t0.2_test_time 0.2857816219329834
gc 0
Train Epoch7 Acc 0.955825 (114699/120000), AUC 0.9947735071182251
ep7_train_time 10.174461126327515
Test Epoch7 threshold 0.2 Acc 0.9105263157894737, AUC 0.9794603586196899, avg_entr 0.01775945909321308
ep7_t0.2_test_time 0.289658784866333
gc 0
Train Epoch8 Acc 0.9563666666666667 (114764/120000), AUC 0.9949184656143188
ep8_train_time 10.231231689453125
Test Epoch8 threshold 0.2 Acc 0.9115131578947369, AUC 0.9794464707374573, avg_entr 0.01642242819070816
ep8_t0.2_test_time 0.28319334983825684
gc 0
Train Epoch9 Acc 0.9573833333333334 (114886/120000), AUC 0.995216965675354
ep9_train_time 10.109763383865356
Test Epoch9 threshold 0.2 Acc 0.9131578947368421, AUC 0.9793475866317749, avg_entr 0.01651618629693985
ep9_t0.2_test_time 0.2821197509765625
Best AUC 0.9803369045257568
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.2_m5//ag_news_linearal_l5_prefix.pt
[[1381   51   69   31]
 [  12 1480    8    7]
 [  38   17 1336  109]
 [  46   21  119 1355]]
Figure(640x480)
tensor([2.2730e-03, 7.5563e-08, 2.6717e-04,  ..., 2.5128e-08, 2.6401e-05,
        2.2006e-05])
[[1376   51   72   33]
 [  14 1479    7    7]
 [  36   15 1341  108]
 [  44   22  118 1357]]
Figure(640x480)
tensor([1.9417e-03, 9.2214e-07, 1.8117e-04,  ..., 2.9963e-08, 2.7524e-05,
        4.0708e-05])
[[1382   50   69   31]
 [  14 1479    8    6]
 [  38   18 1335  109]
 [  48   22  112 1359]]
Figure(640x480)
tensor([1.3552e-03, 2.1341e-07, 9.9588e-05,  ..., 2.4258e-08, 1.3434e-05,
        4.0088e-05])
[[1387   51   63   31]
 [  14 1482    5    6]
 [  43   19 1331  107]
 [  47   23  115 1356]]
Figure(640x480)
tensor([1.0816e-03, 4.0752e-08, 7.9385e-05,  ..., 1.9344e-08, 8.4382e-06,
        9.7568e-06])
[[1386   51   63   32]
 [  16 1478    6    7]
 [  40   18 1335  107]
 [  45   20  120 1356]]
Figure(640x480)
tensor([1.1491e-03, 8.7981e-08, 5.5193e-05,  ..., 2.0269e-08, 6.0925e-06,
        6.9331e-06])
