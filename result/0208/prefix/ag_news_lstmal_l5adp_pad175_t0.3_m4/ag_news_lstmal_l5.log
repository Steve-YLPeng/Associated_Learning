total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.35413333333333336 (42496/120000), AUC 0.36372312903404236
ep0_train_time 80.25092124938965
Test Epoch0 threshold 0.3 Acc 0.9169407894736842, AUC 0.9804565906524658, avg_entr 0.02264426089823246
ep0_t0.3_test_time 0.6436398029327393
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.47880833333333334 (57457/120000), AUC 0.3878343105316162
ep1_train_time 80.88878774642944
Test Epoch1 threshold 0.3 Acc 0.9167763157894737, AUC 0.9802904725074768, avg_entr 0.02300294116139412
ep1_t0.3_test_time 0.4230823516845703
gc 0
Train Epoch2 Acc 0.4816166666666667 (57794/120000), AUC 0.4478946328163147
ep2_train_time 79.12554121017456
Test Epoch2 threshold 0.3 Acc 0.9148026315789474, AUC 0.9801204204559326, avg_entr 0.023702332749962807
ep2_t0.3_test_time 0.40941762924194336
gc 0
Train Epoch3 Acc 0.48301666666666665 (57962/120000), AUC 0.4827163517475128
ep3_train_time 79.8324818611145
Test Epoch3 threshold 0.3 Acc 0.9136513157894737, AUC 0.980069637298584, avg_entr 0.023448091000318527
ep3_t0.3_test_time 0.4744551181793213
gc 0
Train Epoch4 Acc 0.48365 (58038/120000), AUC 0.5097948312759399
ep4_train_time 79.95415592193604
Test Epoch4 threshold 0.3 Acc 0.9138157894736842, AUC 0.9797376394271851, avg_entr 0.023125147446990013
ep4_t0.3_test_time 0.34371137619018555
gc 0
Train Epoch5 Acc 0.48456666666666665 (58148/120000), AUC 0.5203529000282288
ep5_train_time 77.7269515991211
Test Epoch5 threshold 0.3 Acc 0.9141447368421053, AUC 0.9794960021972656, avg_entr 0.022773463279008865
ep5_t0.3_test_time 0.32788586616516113
gc 0
Train Epoch6 Acc 0.48490833333333333 (58189/120000), AUC 0.5326030254364014
ep6_train_time 77.65333485603333
Test Epoch6 threshold 0.3 Acc 0.9123355263157895, AUC 0.9793519377708435, avg_entr 0.02354953996837139
ep6_t0.3_test_time 0.33167004585266113
gc 0
Train Epoch7 Acc 0.484975 (58197/120000), AUC 0.5401468276977539
ep7_train_time 77.61428093910217
Test Epoch7 threshold 0.3 Acc 0.9125, AUC 0.979293942451477, avg_entr 0.023471811786293983
ep7_t0.3_test_time 0.3457326889038086
gc 0
Train Epoch8 Acc 0.4846083333333333 (58153/120000), AUC 0.542808473110199
ep8_train_time 77.76267123222351
Test Epoch8 threshold 0.3 Acc 0.9111842105263158, AUC 0.9792819023132324, avg_entr 0.023369237780570984
ep8_t0.3_test_time 0.3319375514984131
gc 0
Train Epoch9 Acc 0.48534166666666667 (58241/120000), AUC 0.5398955345153809
ep9_train_time 77.6987853050232
Test Epoch9 threshold 0.3 Acc 0.9121710526315789, AUC 0.9790781736373901, avg_entr 0.02370499260723591
ep9_t0.3_test_time 0.32886648178100586
Best AUC 0.9804565906524658
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m4//ag_news_lstmal_l5_prefix.pt
[[1379   51   65   37]
 [  13 1478    5   11]
 [  37   17 1310  136]
 [  36   15   82 1408]]
Figure(640x480)
tensor([4.4070e-03, 1.1823e-07, 3.3919e-05,  ..., 3.5313e-08, 5.4609e-07,
        3.7308e-04])
[[1381   46   56   49]
 [  26 1455   15   11]
 [  48   10 1319  123]
 [  40   12  107 1382]]
Figure(640x480)
tensor([1.8349e-06, 1.0228e-07, 3.4334e-07,  ..., 1.2076e-07, 3.9634e-07,
        4.2520e-07])
[[1381   46   58   47]
 [  25 1458   16    8]
 [  47   10 1318  125]
 [  36   12  108 1385]]
Figure(640x480)
tensor([1.0958e-06, 2.5073e-07, 4.0805e-07,  ..., 2.4171e-07, 3.9519e-07,
        5.2620e-07])
[[1379   48   57   48]
 [  28 1456   15    8]
 [  48   10 1309  133]
 [  37   13  106 1385]]
Figure(640x480)
tensor([1.0113e-06, 6.0693e-07, 1.0388e-06,  ..., 3.6653e-07, 8.6599e-07,
        6.8058e-07])
[[1363   17  152    0]
 [  23    0 1484    0]
 [  67   20 1413    0]
 [ 500    7 1034    0]]
Figure(640x480)
tensor([0.8566, 1.1466, 1.1171,  ..., 0.6232, 1.1330, 0.9848])
