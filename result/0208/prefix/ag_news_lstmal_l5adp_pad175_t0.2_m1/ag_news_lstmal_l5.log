total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.17808333333333334 (21370/120000), AUC 0.40785104036331177
ep0_train_time 46.813612937927246
Test Epoch0 threshold 0.2 Acc 0.9003289473684211, AUC 0.9744479656219482, avg_entr 0.1796221286058426
ep0_t0.2_test_time 0.25090813636779785
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.13213333333333332 (15856/120000), AUC 0.35788097977638245
ep1_train_time 47.02339148521423
Test Epoch1 threshold 0.2 Acc 0.9101973684210526, AUC 0.9781212210655212, avg_entr 0.10345230251550674
ep1_t0.2_test_time 0.25116848945617676
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.12308333333333334 (14770/120000), AUC 0.3546603322029114
ep2_train_time 46.98629331588745
Test Epoch2 threshold 0.2 Acc 0.9101973684210526, AUC 0.9794933795928955, avg_entr 0.07881825417280197
ep2_t0.2_test_time 0.24870729446411133
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.11895833333333333 (14275/120000), AUC 0.3541387915611267
ep3_train_time 46.92176103591919
Test Epoch3 threshold 0.2 Acc 0.9136513157894737, AUC 0.9802855253219604, avg_entr 0.06568987667560577
ep3_t0.2_test_time 0.24951696395874023
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.11734166666666666 (14081/120000), AUC 0.35397058725357056
ep4_train_time 46.91114330291748
Test Epoch4 threshold 0.2 Acc 0.9151315789473684, AUC 0.9806201457977295, avg_entr 0.05910049378871918
ep4_t0.2_test_time 0.24975824356079102
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.11585 (13902/120000), AUC 0.3539600968360901
ep5_train_time 46.89675545692444
Test Epoch5 threshold 0.2 Acc 0.9166118421052631, AUC 0.980803906917572, avg_entr 0.05255606397986412
ep5_t0.2_test_time 0.24992728233337402
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.11576666666666667 (13892/120000), AUC 0.3545580804347992
ep6_train_time 46.81369757652283
Test Epoch6 threshold 0.2 Acc 0.9167763157894737, AUC 0.980612576007843, avg_entr 0.048874642699956894
ep6_t0.2_test_time 0.24942731857299805
gc 0
Train Epoch7 Acc 0.11555833333333333 (13867/120000), AUC 0.35472482442855835
ep7_train_time 46.883700132369995
Test Epoch7 threshold 0.2 Acc 0.9179276315789474, AUC 0.9807615280151367, avg_entr 0.04576368257403374
ep7_t0.2_test_time 0.24815797805786133
gc 0
Train Epoch8 Acc 0.11608333333333333 (13930/120000), AUC 0.3552094101905823
ep8_train_time 46.91661238670349
Test Epoch8 threshold 0.2 Acc 0.9143092105263158, AUC 0.9806196689605713, avg_entr 0.043034158647060394
ep8_t0.2_test_time 0.24881458282470703
gc 0
Train Epoch9 Acc 0.116375 (13965/120000), AUC 0.35546401143074036
ep9_train_time 46.937793493270874
Test Epoch9 threshold 0.2 Acc 0.9159539473684211, AUC 0.9804918766021729, avg_entr 0.04053433984518051
ep9_t0.2_test_time 0.24824213981628418
Best AUC 0.980803906917572
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m1//ag_news_lstmal_l5_prefix.pt
[[1362   55   77   38]
 [   8 1484    5   10]
 [  33   16 1327  124]
 [  32   15   94 1400]]
Figure(640x480)
tensor([0.0301, 0.0010, 0.0201,  ..., 0.0010, 0.0033, 0.0409])
[[  50  996  432   54]
 [  55 1326  123    3]
 [ 150 1166  158   26]
 [  13 1363  149   16]]
Figure(640x480)
tensor([1.1804, 1.0384, 1.0648,  ..., 0.9491, 1.1733, 1.2149])
[[  84  244  171 1033]
 [  52  517  236  702]
 [ 148  420  130  802]
 [ 108  170   44 1219]]
Figure(640x480)
tensor([1.4149, 1.4535, 1.4595,  ..., 1.4477, 1.4112, 1.4253])
[[ 235    0    0 1297]
 [ 413    0    0 1094]
 [ 210    0    0 1290]
 [  28    0    0 1513]]
Figure(640x480)
tensor([1.2440, 1.3120, 1.2852,  ..., 1.3760, 1.3010, 1.3224])
[[ 326    0   21 1185]
 [ 519    0   39  949]
 [1166    0    6  328]
 [1085    0   42  414]]
Figure(640x480)
tensor([1.3366, 1.3751, 1.3748,  ..., 1.4162, 1.3833, 1.3742])
