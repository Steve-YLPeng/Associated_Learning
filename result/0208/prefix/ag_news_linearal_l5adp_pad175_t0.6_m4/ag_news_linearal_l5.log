total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.286025 (34323/120000), AUC 0.6631348133087158
ep0_train_time 9.987529039382935
Test Epoch0 threshold 0.6 Acc 0.9144736842105263, AUC 0.9806420803070068, avg_entr 0.024808088317513466
ep0_t0.6_test_time 0.254849910736084
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3776583333333333 (45319/120000), AUC 0.7275475859642029
ep1_train_time 9.640554428100586
Test Epoch1 threshold 0.6 Acc 0.9151315789473684, AUC 0.980465829372406, avg_entr 0.024792959913611412
ep1_t0.6_test_time 0.2538464069366455
gc 0
Train Epoch2 Acc 0.45395833333333335 (54475/120000), AUC 0.8204007148742676
ep2_train_time 9.579395532608032
Test Epoch2 threshold 0.6 Acc 0.9144736842105263, AUC 0.9803155660629272, avg_entr 0.025400662794709206
ep2_t0.6_test_time 0.2535557746887207
gc 0
Train Epoch3 Acc 0.5202416666666667 (62429/120000), AUC 0.8574249744415283
ep3_train_time 9.450332403182983
Test Epoch3 threshold 0.6 Acc 0.9121710526315789, AUC 0.9802363514900208, avg_entr 0.02537141926586628
ep3_t0.6_test_time 0.2536013126373291
gc 0
Train Epoch4 Acc 0.5887083333333333 (70645/120000), AUC 0.8592895269393921
ep4_train_time 9.544885396957397
Test Epoch4 threshold 0.6 Acc 0.9115131578947369, AUC 0.9799278378486633, avg_entr 0.02474241703748703
ep4_t0.6_test_time 0.2530636787414551
gc 0
Train Epoch5 Acc 0.6005833333333334 (72070/120000), AUC 0.8564718961715698
ep5_train_time 9.48982858657837
Test Epoch5 threshold 0.6 Acc 0.9125, AUC 0.9798862934112549, avg_entr 0.02531540021300316
ep5_t0.6_test_time 0.2530477046966553
gc 0
Train Epoch6 Acc 0.6022916666666667 (72275/120000), AUC 0.8542431592941284
ep6_train_time 9.581372737884521
Test Epoch6 threshold 0.6 Acc 0.9108552631578948, AUC 0.9797492027282715, avg_entr 0.025052309036254883
ep6_t0.6_test_time 0.2539858818054199
gc 0
Train Epoch7 Acc 0.5954583333333333 (71455/120000), AUC 0.8507491946220398
ep7_train_time 9.523474931716919
Test Epoch7 threshold 0.6 Acc 0.9110197368421052, AUC 0.9796642065048218, avg_entr 0.02594693750143051
ep7_t0.6_test_time 0.25240635871887207
gc 0
Train Epoch8 Acc 0.5663083333333333 (67957/120000), AUC 0.8468083143234253
ep8_train_time 9.539661169052124
Test Epoch8 threshold 0.6 Acc 0.9118421052631579, AUC 0.979580819606781, avg_entr 0.025139939039945602
ep8_t0.6_test_time 0.2530224323272705
gc 0
Train Epoch9 Acc 0.5211916666666667 (62543/120000), AUC 0.8436739444732666
ep9_train_time 9.640913486480713
Test Epoch9 threshold 0.6 Acc 0.9123355263157895, AUC 0.9795379638671875, avg_entr 0.024839524179697037
ep9_t0.6_test_time 0.2529001235961914
Best AUC 0.9806420803070068
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt
[[325   7  19  17]
 [  0 389   3   1]
 [  5   4 361  30]
 [  3   1  28 327]]
Figure(640x480)
tensor([6.1867e-05, 1.8284e-03, 3.4901e-02,  ..., 1.9017e-02, 9.9445e-08,
        1.4207e-04])
[[326   8  17  17]
 [  0 388   4   1]
 [  5   4 357  34]
 [  3   1  24 331]]
Figure(640x480)
tensor([5.9786e-05, 1.5105e-03, 1.9801e-02,  ..., 5.1968e-02, 1.0101e-07,
        9.7325e-04])
[[327   8  16  17]
 [  0 388   4   1]
 [  5   4 357  34]
 [  3   1  25 330]]
Figure(640x480)
tensor([5.2440e-05, 9.6046e-04, 2.0731e-02,  ..., 3.6381e-02, 1.2978e-07,
        3.6281e-04])
[[327   8  16  17]
 [  0 389   3   1]
 [  5   5 358  32]
 [  4   1  24 330]]
Figure(640x480)
tensor([7.8282e-05, 1.3484e-03, 2.3319e-02,  ..., 1.5251e-02, 8.8255e-08,
        4.0258e-04])
[[ 32 332   1   3]
 [150 231   8   4]
 [  0 393   0   7]
 [  0 122   1 236]]
Figure(640x480)
tensor([0.9641, 0.9668, 0.7536,  ..., 1.0976, 0.5423, 0.5129])
