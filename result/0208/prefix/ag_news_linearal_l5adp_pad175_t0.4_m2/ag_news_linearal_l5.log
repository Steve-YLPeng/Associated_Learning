total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.20954166666666665 (25145/120000), AUC 0.45925024151802063
ep0_train_time 9.34333848953247
Test Epoch0 threshold 0.4 Acc 0.9148026315789474, AUC 0.9808902740478516, avg_entr 0.02780606597661972
ep0_t0.4_test_time 0.2673764228820801
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.09220833333333334 (11065/120000), AUC 0.3945499062538147
ep1_train_time 9.079262971878052
Test Epoch1 threshold 0.4 Acc 0.9171052631578948, AUC 0.9807089567184448, avg_entr 0.02661794424057007
ep1_t0.4_test_time 0.25914597511291504
gc 0
Train Epoch2 Acc 0.15993333333333334 (19192/120000), AUC 0.38677355647087097
ep2_train_time 8.799721717834473
Test Epoch2 threshold 0.4 Acc 0.9167763157894737, AUC 0.9806210994720459, avg_entr 0.026376064866781235
ep2_t0.4_test_time 0.26155972480773926
gc 0
Train Epoch3 Acc 0.18789166666666668 (22547/120000), AUC 0.38330525159835815
ep3_train_time 8.798925638198853
Test Epoch3 threshold 0.4 Acc 0.9149671052631579, AUC 0.9805060029029846, avg_entr 0.026293162256479263
ep3_t0.4_test_time 0.2593851089477539
gc 0
Train Epoch4 Acc 0.19699166666666668 (23639/120000), AUC 0.38094422221183777
ep4_train_time 8.655523538589478
Test Epoch4 threshold 0.4 Acc 0.9157894736842105, AUC 0.9803392887115479, avg_entr 0.02637520246207714
ep4_t0.4_test_time 0.25570249557495117
gc 0
Train Epoch5 Acc 0.20184166666666667 (24221/120000), AUC 0.3783800005912781
ep5_train_time 8.753040075302124
Test Epoch5 threshold 0.4 Acc 0.9146381578947368, AUC 0.9802178144454956, avg_entr 0.026202043518424034
ep5_t0.4_test_time 0.2564878463745117
gc 0
Train Epoch6 Acc 0.20641666666666666 (24770/120000), AUC 0.3778519928455353
ep6_train_time 8.57950496673584
Test Epoch6 threshold 0.4 Acc 0.9148026315789474, AUC 0.9801722764968872, avg_entr 0.02567771077156067
ep6_t0.4_test_time 0.25567173957824707
gc 0
Train Epoch7 Acc 0.20971666666666666 (25166/120000), AUC 0.376960426568985
ep7_train_time 8.624803066253662
Test Epoch7 threshold 0.4 Acc 0.9131578947368421, AUC 0.9800747632980347, avg_entr 0.02616492286324501
ep7_t0.4_test_time 0.25366878509521484
gc 0
Train Epoch8 Acc 0.21115833333333334 (25339/120000), AUC 0.376257985830307
ep8_train_time 8.662045240402222
Test Epoch8 threshold 0.4 Acc 0.9146381578947368, AUC 0.9799344539642334, avg_entr 0.026986995711922646
ep8_t0.4_test_time 0.2540161609649658
gc 0
Train Epoch9 Acc 0.21281666666666665 (25538/120000), AUC 0.3753308951854706
ep9_train_time 8.606571674346924
Test Epoch9 threshold 0.4 Acc 0.9146381578947368, AUC 0.979873538017273, avg_entr 0.02632385864853859
ep9_t0.4_test_time 0.2544269561767578
Best AUC 0.9808902740478516
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt
[[1375   53   73   31]
 [  12 1487    3    5]
 [  39   15 1337  109]
 [  48   22  108 1363]]
Figure(640x480)
tensor([6.7522e-03, 3.4031e-06, 1.3749e-03,  ..., 1.0033e-06, 1.2673e-05,
        4.3594e-04])
[[1377   52   72   31]
 [  10 1489    3    5]
 [  37   17 1339  107]
 [  48   22  106 1365]]
Figure(640x480)
tensor([1.5436e-02, 3.0197e-05, 3.2852e-03,  ..., 2.0514e-06, 1.5109e-04,
        3.4631e-03])
[[   0    0 1532    0]
 [   0    0 1507    0]
 [   0    0 1500    0]
 [   0    0 1541    0]]
Figure(640x480)
tensor([0.7092, 0.5745, 0.5963,  ..., 0.6982, 0.6181, 0.7954])
[[1381    0    0  151]
 [   5    0    0 1502]
 [1119    0    0  381]
 [1424    0    0  117]]
Figure(640x480)
tensor([0.7151, 0.5308, 0.5925,  ..., 0.6080, 0.5785, 0.6979])
[[   0   22 1464   46]
 [   0   94 1412    1]
 [   0  228  229 1043]
 [   2 1359   96   84]]
Figure(640x480)
tensor([0.9466, 1.1131, 1.0537,  ..., 1.0653, 1.0615, 1.0136])
