total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.29004166666666664 (34805/120000), AUC 0.5301995277404785
ep0_train_time 46.65730834007263
Test Epoch0 threshold 0.6 Acc 0.9018092105263158, AUC 0.9738746881484985, avg_entr 0.18520291149616241
ep0_t0.6_test_time 0.2523658275604248
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.327275 (39273/120000), AUC 0.5753268003463745
ep1_train_time 46.776588678359985
Test Epoch1 threshold 0.6 Acc 0.9118421052631579, AUC 0.9776841402053833, avg_entr 0.10708025097846985
ep1_t0.6_test_time 0.25054240226745605
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.33694166666666664 (40433/120000), AUC 0.5854470729827881
ep2_train_time 46.89380669593811
Test Epoch2 threshold 0.6 Acc 0.9159539473684211, AUC 0.9791918992996216, avg_entr 0.08065052330493927
ep2_t0.6_test_time 0.25031089782714844
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.3406166666666667 (40874/120000), AUC 0.590690553188324
ep3_train_time 46.8772075176239
Test Epoch3 threshold 0.6 Acc 0.9166118421052631, AUC 0.9801573157310486, avg_entr 0.06898485124111176
ep3_t0.6_test_time 0.2502720355987549
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.34155 (40986/120000), AUC 0.5937672853469849
ep4_train_time 46.86246418952942
Test Epoch4 threshold 0.6 Acc 0.9174342105263158, AUC 0.9805753231048584, avg_entr 0.060077276080846786
ep4_t0.6_test_time 0.25003600120544434
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.34058333333333335 (40870/120000), AUC 0.596367359161377
ep5_train_time 46.87648630142212
Test Epoch5 threshold 0.6 Acc 0.9143092105263158, AUC 0.9807289242744446, avg_entr 0.05566573888063431
ep5_t0.6_test_time 0.2498941421508789
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.33889166666666665 (40667/120000), AUC 0.5983266234397888
ep6_train_time 46.89846992492676
Test Epoch6 threshold 0.6 Acc 0.9143092105263158, AUC 0.9807386994361877, avg_entr 0.05029398947954178
ep6_t0.6_test_time 0.25014567375183105
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.3374 (40488/120000), AUC 0.5999045372009277
ep7_train_time 46.96756553649902
Test Epoch7 threshold 0.6 Acc 0.9162828947368421, AUC 0.9805850982666016, avg_entr 0.04529837891459465
ep7_t0.6_test_time 0.25049424171447754
gc 0
Train Epoch8 Acc 0.3356166666666667 (40274/120000), AUC 0.6013262867927551
ep8_train_time 46.90209746360779
Test Epoch8 threshold 0.6 Acc 0.915296052631579, AUC 0.9805378913879395, avg_entr 0.04325177147984505
ep8_t0.6_test_time 0.2516610622406006
gc 0
Train Epoch9 Acc 0.3330416666666667 (39965/120000), AUC 0.6025333404541016
ep9_train_time 46.947648763656616
Test Epoch9 threshold 0.6 Acc 0.9157894736842105, AUC 0.9802172183990479, avg_entr 0.04011360555887222
ep9_t0.6_test_time 0.24973630905151367
Best AUC 0.9807386994361877
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt
[[327   7  18  16]
 [  0 388   4   1]
 [  5   4 364  27]
 [  3   0  33 323]]
Figure(640x480)
tensor([0.0235, 0.0218, 0.2314,  ..., 0.0556, 0.0007, 0.0208])
[[107 106 107  48]
 [234  57  85  17]
 [211  44 129  16]
 [ 60  84 159  56]]
Figure(640x480)
tensor([1.3287, 1.4305, 1.3370,  ..., 1.3878, 1.4517, 1.3745])
[[  6   1   4 357]
 [  2   3   2 386]
 [  8   3  44 345]
 [  4   1  29 325]]
Figure(640x480)
tensor([1.3647, 1.3801, 1.4077,  ..., 1.3610, 1.3920, 1.3824])
[[  0 365   0   3]
 [  0 393   0   0]
 [  0 400   0   0]
 [  0 359   0   0]]
Figure(640x480)
tensor([1.3101, 1.3510, 1.3563,  ..., 1.3432, 1.3201, 1.3396])
[[  0  97 271   0]
 [  0 213 178   2]
 [  0  71 329   0]
 [  0  68 291   0]]
Figure(640x480)
tensor([1.3896, 1.3813, 1.3951,  ..., 1.4064, 1.3789, 1.4077])
