total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.1_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.031775 (3813/120000), AUC 0.3806530833244324
ep0_train_time 10.04584002494812
Test Epoch0 threshold 0.1 Acc 0.9159539473684211, AUC 0.980390191078186, avg_entr 0.02369689755141735
ep0_t0.1_test_time 0.2801053524017334
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.021975 (2637/120000), AUC 0.3785092830657959
ep1_train_time 9.563738822937012
Test Epoch1 threshold 0.1 Acc 0.9161184210526315, AUC 0.9803589582443237, avg_entr 0.022259598597884178
ep1_t0.1_test_time 0.27903270721435547
gc 0
Train Epoch2 Acc 0.021533333333333335 (2584/120000), AUC 0.3455052077770233
ep2_train_time 9.60707950592041
Test Epoch2 threshold 0.1 Acc 0.9161184210526315, AUC 0.9802637696266174, avg_entr 0.019707441329956055
ep2_t0.1_test_time 0.27933359146118164
gc 0
Train Epoch3 Acc 0.03811666666666667 (4574/120000), AUC 0.32144591212272644
ep3_train_time 9.492755651473999
Test Epoch3 threshold 0.1 Acc 0.9154605263157894, AUC 0.9800971746444702, avg_entr 0.016660908237099648
ep3_t0.1_test_time 0.27830982208251953
gc 0
Train Epoch4 Acc 0.08058333333333334 (9670/120000), AUC 0.31637826561927795
ep4_train_time 9.675450801849365
Test Epoch4 threshold 0.1 Acc 0.9120065789473685, AUC 0.979790449142456, avg_entr 0.013582244515419006
ep4_t0.1_test_time 0.27838683128356934
gc 0
Train Epoch5 Acc 0.10235833333333333 (12283/120000), AUC 0.3291947841644287
ep5_train_time 9.61601972579956
Test Epoch5 threshold 0.1 Acc 0.9121710526315789, AUC 0.9795559048652649, avg_entr 0.01306118443608284
ep5_t0.1_test_time 0.2784414291381836
gc 0
Train Epoch6 Acc 0.11393333333333333 (13672/120000), AUC 0.33895403146743774
ep6_train_time 9.530704259872437
Test Epoch6 threshold 0.1 Acc 0.9126644736842106, AUC 0.9794056415557861, avg_entr 0.013025396503508091
ep6_t0.1_test_time 0.2792489528656006
gc 0
Train Epoch7 Acc 0.12295 (14754/120000), AUC 0.345925509929657
ep7_train_time 9.617582321166992
Test Epoch7 threshold 0.1 Acc 0.9126644736842106, AUC 0.9795400500297546, avg_entr 0.012158303521573544
ep7_t0.1_test_time 0.2794301509857178
gc 0
Train Epoch8 Acc 0.12189166666666666 (14627/120000), AUC 0.35248926281929016
ep8_train_time 9.51412558555603
Test Epoch8 threshold 0.1 Acc 0.9098684210526315, AUC 0.9791721105575562, avg_entr 0.012740456499159336
ep8_t0.1_test_time 0.2782249450683594
gc 0
Train Epoch9 Acc 0.119575 (14349/120000), AUC 0.35422205924987793
ep9_train_time 9.591930866241455
Test Epoch9 threshold 0.1 Acc 0.9129934210526316, AUC 0.9792182445526123, avg_entr 0.011742050759494305
ep9_t0.1_test_time 0.2779676914215088
Best AUC 0.980390191078186
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt
[[1382   51   67   32]
 [  15 1479    5    8]
 [  39   17 1329  115]
 [  43   16  103 1379]]
Figure(640x480)
tensor([3.1595e-03, 1.2308e-07, 2.6605e-04,  ..., 3.4941e-08, 4.4444e-06,
        7.5459e-05])
[[1385   51   66   30]
 [  13 1481    5    8]
 [  40   17 1329  114]
 [  49   20  104 1368]]
Figure(640x480)
tensor([1.6652e-03, 1.5720e-06, 3.0286e-04,  ..., 5.1833e-08, 4.9712e-06,
        9.2754e-05])
[[1386   51   63   32]
 [  17 1478    4    8]
 [  43   16 1322  119]
 [  42   19  104 1376]]
Figure(640x480)
tensor([1.9364e-03, 7.0101e-07, 1.9631e-04,  ..., 4.0637e-08, 3.9418e-06,
        7.7563e-05])
[[1390   51   59   32]
 [  16 1478    5    8]
 [  46   18 1319  117]
 [  43   19  104 1375]]
Figure(640x480)
tensor([2.3732e-03, 7.4047e-07, 1.0860e-04,  ..., 4.5125e-08, 2.2958e-06,
        4.1361e-05])
[[ 107 1252  173    0]
 [ 339    8 1160    0]
 [1386   12  102    0]
 [ 171   20 1350    0]]
Figure(640x480)
tensor([0.8012, 0.2787, 0.6977,  ..., 1.1571, 0.5761, 0.6438])
