total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.05388333333333333 (6466/120000), AUC 0.4951630234718323
ep0_train_time 9.478711366653442
Test Epoch0 threshold 0.5 Acc 0.915625, AUC 0.9806729555130005, avg_entr 0.02625231444835663
ep0_t0.5_test_time 0.2540857791900635
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.05846666666666667 (7016/120000), AUC 0.5562887191772461
ep1_train_time 9.051196575164795
Test Epoch1 threshold 0.5 Acc 0.9146381578947368, AUC 0.9805659651756287, avg_entr 0.02655482478439808
ep1_t0.5_test_time 0.2502903938293457
gc 0
Train Epoch2 Acc 0.051825 (6219/120000), AUC 0.5543964505195618
ep2_train_time 9.183633089065552
Test Epoch2 threshold 0.5 Acc 0.9134868421052632, AUC 0.9803656339645386, avg_entr 0.02622360922396183
ep2_t0.5_test_time 0.2503478527069092
gc 0
Train Epoch3 Acc 0.056108333333333336 (6733/120000), AUC 0.545630693435669
ep3_train_time 9.010404825210571
Test Epoch3 threshold 0.5 Acc 0.9110197368421052, AUC 0.9802796840667725, avg_entr 0.025408005341887474
ep3_t0.5_test_time 0.24912428855895996
gc 0
Train Epoch4 Acc 0.06696666666666666 (8036/120000), AUC 0.5272268056869507
ep4_train_time 9.006755113601685
Test Epoch4 threshold 0.5 Acc 0.9123355263157895, AUC 0.9800451397895813, avg_entr 0.02525118738412857
ep4_t0.5_test_time 0.24988985061645508
gc 0
Train Epoch5 Acc 0.07211666666666666 (8654/120000), AUC 0.5168440341949463
ep5_train_time 9.01478910446167
Test Epoch5 threshold 0.5 Acc 0.9133223684210526, AUC 0.9799561500549316, avg_entr 0.02640567347407341
ep5_t0.5_test_time 0.250136137008667
gc 0
Train Epoch6 Acc 0.07935833333333334 (9523/120000), AUC 0.5155003666877747
ep6_train_time 8.953484773635864
Test Epoch6 threshold 0.5 Acc 0.9139802631578947, AUC 0.979902446269989, avg_entr 0.025689905509352684
ep6_t0.5_test_time 0.2502615451812744
gc 0
Train Epoch7 Acc 0.09644166666666666 (11573/120000), AUC 0.5143482685089111
ep7_train_time 9.149489402770996
Test Epoch7 threshold 0.5 Acc 0.9115131578947369, AUC 0.9797806739807129, avg_entr 0.024754798039793968
ep7_t0.5_test_time 0.25153374671936035
gc 0
Train Epoch8 Acc 0.12055833333333334 (14467/120000), AUC 0.518674910068512
ep8_train_time 8.969761848449707
Test Epoch8 threshold 0.5 Acc 0.9126644736842106, AUC 0.9796561598777771, avg_entr 0.027266552671790123
ep8_t0.5_test_time 0.24989938735961914
gc 0
Train Epoch9 Acc 0.133875 (16065/120000), AUC 0.525629997253418
ep9_train_time 8.99646806716919
Test Epoch9 threshold 0.5 Acc 0.912828947368421, AUC 0.9796620607376099, avg_entr 0.026304194703698158
ep9_t0.5_test_time 0.2508513927459717
Best AUC 0.9806729555130005
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt
[[1386   50   65   31]
 [  16 1479    4    8]
 [  41   15 1330  114]
 [  46   17  106 1372]]
Figure(640x480)
tensor([4.1637e-03, 1.0351e-07, 2.2250e-04,  ..., 7.1064e-08, 3.7579e-06,
        1.1028e-04])
[[1381   50   70   31]
 [  17 1478    5    7]
 [  38   17 1330  115]
 [  46   18  104 1373]]
Figure(640x480)
tensor([1.8517e-03, 7.8849e-07, 1.9688e-04,  ..., 1.4821e-07, 5.3301e-06,
        2.6647e-04])
[[1385   50   66   31]
 [  16 1480    5    6]
 [  40   16 1330  114]
 [  45   20  106 1370]]
Figure(640x480)
tensor([1.5132e-03, 5.0623e-07, 1.8823e-04,  ..., 1.8072e-07, 3.0694e-06,
        2.4090e-04])
[[ 735    0  797    0]
 [1507    0    0    0]
 [1497    0    3    0]
 [1537    0    4    0]]
Figure(640x480)
tensor([1.0860, 0.3819, 0.5718,  ..., 0.8522, 0.5066, 0.9227])
[[  33 1222  239   38]
 [  46  498    0  963]
 [ 178 1316    5    1]
 [1421   95   20    5]]
Figure(640x480)
tensor([0.7789, 0.8976, 1.2375,  ..., 0.9819, 1.0513, 0.7007])
