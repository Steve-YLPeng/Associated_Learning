total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24998333333333334 (29998/120000), AUC 0.551581859588623
ep0_train_time 8.460818529129028
Test Epoch0 threshold 0.3 Acc 0.9003289473684211, AUC 0.9737060070037842, avg_entr 0.18425646424293518
ep0_t0.3_test_time 0.2532675266265869
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24995 (29994/120000), AUC 0.5952466726303101
ep1_train_time 8.012018203735352
Test Epoch1 threshold 0.3 Acc 0.9083881578947368, AUC 0.9777016639709473, avg_entr 0.10626453906297684
ep1_t0.3_test_time 0.2521951198577881
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24991666666666668 (29990/120000), AUC 0.5985715985298157
ep2_train_time 8.220704078674316
Test Epoch2 threshold 0.3 Acc 0.9120065789473685, AUC 0.9793872237205505, avg_entr 0.08153694868087769
ep2_t0.3_test_time 0.252392053604126
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.2499 (29988/120000), AUC 0.5974323153495789
ep3_train_time 8.065635919570923
Test Epoch3 threshold 0.3 Acc 0.9169407894736842, AUC 0.9801390767097473, avg_entr 0.06730270385742188
ep3_t0.3_test_time 0.2526078224182129
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24989166666666668 (29987/120000), AUC 0.5961285829544067
ep4_train_time 8.174153089523315
Test Epoch4 threshold 0.3 Acc 0.9164473684210527, AUC 0.980617880821228, avg_entr 0.05864844471216202
ep4_t0.3_test_time 0.25183677673339844
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24989166666666668 (29987/120000), AUC 0.5939409732818604
ep5_train_time 8.15815281867981
Test Epoch5 threshold 0.3 Acc 0.9134868421052632, AUC 0.9807094931602478, avg_entr 0.05455278977751732
ep5_t0.3_test_time 0.2519087791442871
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24989166666666668 (29987/120000), AUC 0.5918577909469604
ep6_train_time 8.214637279510498
Test Epoch6 threshold 0.3 Acc 0.9171052631578948, AUC 0.9809292554855347, avg_entr 0.04964059963822365
ep6_t0.3_test_time 0.25232648849487305
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.249875 (29985/120000), AUC 0.5891900062561035
ep7_train_time 8.03032398223877
Test Epoch7 threshold 0.3 Acc 0.9133223684210526, AUC 0.9807745218276978, avg_entr 0.04605983942747116
ep7_t0.3_test_time 0.2518198490142822
gc 0
Train Epoch8 Acc 0.249875 (29985/120000), AUC 0.586745023727417
ep8_train_time 8.057138681411743
Test Epoch8 threshold 0.3 Acc 0.915296052631579, AUC 0.9806710481643677, avg_entr 0.04255243018269539
ep8_t0.3_test_time 0.2519817352294922
gc 0
Train Epoch9 Acc 0.24985833333333332 (29983/120000), AUC 0.5843850374221802
ep9_train_time 8.099916934967041
Test Epoch9 threshold 0.3 Acc 0.9136513157894737, AUC 0.980467677116394, avg_entr 0.04071963578462601
ep9_t0.3_test_time 0.2514989376068115
Best AUC 0.9809292554855347
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt
[[1376   52   73   31]
 [  13 1480    4   10]
 [  38   13 1335  114]
 [  43   15   98 1385]]
Figure(640x480)
tensor([0.0445, 0.0006, 0.0103,  ..., 0.0004, 0.0025, 0.0140])
[[   0    0 1532    0]
 [   0    0 1507    0]
 [   0    0 1500    0]
 [   0    0 1541    0]]
Figure(640x480)
tensor([1.1483, 1.1707, 1.1591,  ..., 1.1278, 1.1570, 1.1751])
[[   0    0    0 1532]
 [   0    0    0 1507]
 [   0    0    0 1500]
 [   0    0    0 1541]]
Figure(640x480)
tensor([1.2337, 1.2824, 1.2642,  ..., 1.2171, 1.2750, 1.2663])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1540    0    1    0]]
Figure(640x480)
tensor([1.2460, 1.2492, 1.2294,  ..., 1.2478, 1.2359, 1.2571])
[[   0    0    0 1532]
 [   0    0    0 1507]
 [   0    0    0 1500]
 [   0    0    0 1541]]
Figure(640x480)
tensor([1.2856, 1.3218, 1.3191,  ..., 1.3285, 1.3221, 1.3066])
