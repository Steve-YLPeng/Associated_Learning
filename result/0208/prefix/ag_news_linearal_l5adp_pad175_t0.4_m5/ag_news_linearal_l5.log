total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.916825 (110019/120000), AUC 0.9865269064903259
ep0_train_time 13.287418603897095
Test Epoch0 threshold 0.4 Acc 0.9139802631578947, AUC 0.9802117347717285, avg_entr 0.024832261726260185
ep0_t0.4_test_time 0.30945253372192383
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.950675 (114081/120000), AUC 0.9931315183639526
ep1_train_time 12.918277502059937
Test Epoch1 threshold 0.4 Acc 0.9148026315789474, AUC 0.9802129864692688, avg_entr 0.02610963024199009
ep1_t0.4_test_time 0.30687546730041504
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m5//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9517 (114204/120000), AUC 0.9932476878166199
ep2_train_time 13.85689663887024
Test Epoch2 threshold 0.4 Acc 0.9131578947368421, AUC 0.9800972938537598, avg_entr 0.024715149775147438
ep2_t0.4_test_time 0.4092216491699219
gc 0
Train Epoch3 Acc 0.9527666666666667 (114332/120000), AUC 0.9934528470039368
ep3_train_time 13.860535621643066
Test Epoch3 threshold 0.4 Acc 0.9138157894736842, AUC 0.9798886775970459, avg_entr 0.02526722475886345
ep3_t0.4_test_time 0.42958831787109375
gc 0
Train Epoch4 Acc 0.9537916666666667 (114455/120000), AUC 0.9937832355499268
ep4_train_time 14.212062358856201
Test Epoch4 threshold 0.4 Acc 0.9123355263157895, AUC 0.9799425601959229, avg_entr 0.025331534445285797
ep4_t0.4_test_time 0.3055403232574463
gc 0
Train Epoch5 Acc 0.9556833333333333 (114682/120000), AUC 0.9945440292358398
ep5_train_time 12.215556859970093
Test Epoch5 threshold 0.4 Acc 0.9106907894736842, AUC 0.9796421527862549, avg_entr 0.025795845314860344
ep5_t0.4_test_time 0.3182826042175293
gc 0
Train Epoch6 Acc 0.9561333333333333 (114736/120000), AUC 0.9946965575218201
ep6_train_time 12.684906005859375
Test Epoch6 threshold 0.4 Acc 0.9106907894736842, AUC 0.979624330997467, avg_entr 0.026189420372247696
ep6_t0.4_test_time 0.32805347442626953
gc 0
Train Epoch7 Acc 0.9568416666666667 (114821/120000), AUC 0.9947532415390015
ep7_train_time 10.321147441864014
Test Epoch7 threshold 0.4 Acc 0.9125, AUC 0.9794690012931824, avg_entr 0.025558223947882652
ep7_t0.4_test_time 0.2551705837249756
gc 0
Train Epoch8 Acc 0.9569666666666666 (114836/120000), AUC 0.9948686361312866
ep8_train_time 9.894989013671875
Test Epoch8 threshold 0.4 Acc 0.9116776315789473, AUC 0.97943514585495, avg_entr 0.025479966774582863
ep8_t0.4_test_time 0.25663328170776367
gc 0
Train Epoch9 Acc 0.9578333333333333 (114940/120000), AUC 0.9951944351196289
ep9_train_time 11.51162838935852
Test Epoch9 threshold 0.4 Acc 0.9110197368421052, AUC 0.9793552160263062, avg_entr 0.02581501007080078
ep9_t0.4_test_time 0.4283740520477295
Best AUC 0.9802129864692688
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.4_m5//ag_news_linearal_l5_prefix.pt
[[1375   50   72   35]
 [  14 1476    9    8]
 [  34   12 1338  116]
 [  40   12  112 1377]]
Figure(640x480)
tensor([1.7715e-03, 2.7227e-08, 9.3982e-05,  ..., 1.8886e-08, 7.9868e-06,
        8.1532e-05])
[[1379   51   71   31]
 [  14 1477    8    8]
 [  34   12 1338  116]
 [  39   15  113 1374]]
Figure(640x480)
tensor([1.9617e-03, 1.5286e-07, 1.3158e-04,  ..., 2.2862e-08, 1.1300e-05,
        3.0480e-04])
[[1380   51   70   31]
 [  16 1475    8    8]
 [  38   14 1329  119]
 [  39   14  112 1376]]
Figure(640x480)
tensor([8.0868e-04, 9.9206e-08, 2.9374e-05,  ..., 1.6767e-08, 2.4530e-06,
        4.7821e-05])
[[1380   50   67   35]
 [  18 1472    8    9]
 [  38   12 1331  119]
 [  34   10  110 1387]]
Figure(640x480)
tensor([1.8345e-04, 5.9211e-09, 4.4818e-06,  ..., 1.6056e-08, 6.1119e-07,
        1.5659e-06])
[[1375   50   71   36]
 [  19 1465   10   13]
 [  35   10 1335  120]
 [  33   10  111 1387]]
Figure(640x480)
tensor([5.3617e-05, 9.7047e-09, 6.4396e-07,  ..., 1.6930e-08, 1.8847e-07,
        2.6393e-07])
