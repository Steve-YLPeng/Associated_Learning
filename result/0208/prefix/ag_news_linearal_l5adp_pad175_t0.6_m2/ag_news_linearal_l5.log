total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.26848333333333335 (32218/120000), AUC 0.6064110994338989
ep0_train_time 9.028289794921875
Test Epoch0 threshold 0.6 Acc 0.9136513157894737, AUC 0.9808438420295715, avg_entr 0.02650059200823307
ep0_t0.6_test_time 0.2540891170501709
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.34350833333333336 (41221/120000), AUC 0.7798128724098206
ep1_train_time 8.450057983398438
Test Epoch1 threshold 0.6 Acc 0.9138157894736842, AUC 0.9807636141777039, avg_entr 0.025591202080249786
ep1_t0.6_test_time 0.2517123222351074
gc 0
Train Epoch2 Acc 0.38374166666666665 (46049/120000), AUC 0.7818788290023804
ep2_train_time 8.531420469284058
Test Epoch2 threshold 0.6 Acc 0.9154605263157894, AUC 0.9807386994361877, avg_entr 0.025634411722421646
ep2_t0.6_test_time 0.2536900043487549
gc 0
Train Epoch3 Acc 0.4358 (52296/120000), AUC 0.7888029217720032
ep3_train_time 8.49004077911377
Test Epoch3 threshold 0.6 Acc 0.9149671052631579, AUC 0.9803169369697571, avg_entr 0.02572232484817505
ep3_t0.6_test_time 0.2522592544555664
gc 0
Train Epoch4 Acc 0.4745083333333333 (56941/120000), AUC 0.7912652492523193
ep4_train_time 8.539226531982422
Test Epoch4 threshold 0.6 Acc 0.9143092105263158, AUC 0.9803811311721802, avg_entr 0.026150120422244072
ep4_t0.6_test_time 0.2520592212677002
gc 0
Train Epoch5 Acc 0.492825 (59139/120000), AUC 0.7921338081359863
ep5_train_time 8.497584819793701
Test Epoch5 threshold 0.6 Acc 0.9139802631578947, AUC 0.9802334904670715, avg_entr 0.025653216987848282
ep5_t0.6_test_time 0.2511568069458008
gc 0
Train Epoch6 Acc 0.5031416666666667 (60377/120000), AUC 0.7926750779151917
ep6_train_time 8.481559991836548
Test Epoch6 threshold 0.6 Acc 0.9141447368421053, AUC 0.9802082777023315, avg_entr 0.02587464265525341
ep6_t0.6_test_time 0.2509765625
gc 0
Train Epoch7 Acc 0.5153416666666667 (61841/120000), AUC 0.793374240398407
ep7_train_time 8.590219497680664
Test Epoch7 threshold 0.6 Acc 0.9125, AUC 0.9799700975418091, avg_entr 0.026061341166496277
ep7_t0.6_test_time 0.2519810199737549
gc 0
Train Epoch8 Acc 0.528125 (63375/120000), AUC 0.7946026921272278
ep8_train_time 8.651116132736206
Test Epoch8 threshold 0.6 Acc 0.9125, AUC 0.9798548817634583, avg_entr 0.025088893249630928
ep8_t0.6_test_time 0.2519550323486328
gc 0
Train Epoch9 Acc 0.5356916666666667 (64283/120000), AUC 0.7945245504379272
ep9_train_time 8.50955867767334
Test Epoch9 threshold 0.6 Acc 0.9129934210526316, AUC 0.9798239469528198, avg_entr 0.02582651749253273
ep9_t0.6_test_time 0.2512795925140381
Best AUC 0.9808438420295715
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt
[[331   7  17  13]
 [  0 389   3   1]
 [  5   4 367  24]
 [  5   1  31 322]]
Figure(640x480)
tensor([3.5282e-04, 4.8430e-03, 1.8057e-01,  ..., 7.1273e-03, 1.1565e-06,
        3.9309e-04])
[[327   8  18  15]
 [  0 390   3   0]
 [  5   4 364  27]
 [  2   3  29 325]]
Figure(640x480)
tensor([6.3807e-03, 4.1140e-02, 3.6722e-01,  ..., 5.7694e-02, 2.3001e-06,
        7.7122e-02])
[[306  62   0   0]
 [  0 209   0 184]
 [ 24 368   0   8]
 [ 25 334   0   0]]
Figure(640x480)
tensor([0.9445, 0.9946, 0.9883,  ..., 1.0971, 1.1369, 1.0671])
[[  3 365   0   0]
 [  0 393   0   0]
 [166 234   0   0]
 [  4 355   0   0]]
Figure(640x480)
tensor([0.7761, 0.8474, 0.8571,  ..., 0.8356, 0.9147, 0.8885])
[[368   0   0   0]
 [254 139   0   0]
 [397   3   0   0]
 [354   2   0   3]]
Figure(640x480)
tensor([0.9527, 0.9753, 0.9400,  ..., 0.9374, 0.8286, 0.8579])
