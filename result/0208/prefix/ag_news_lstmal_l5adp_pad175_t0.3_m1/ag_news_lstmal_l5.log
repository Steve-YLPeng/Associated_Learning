total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25679166666666664 (30815/120000), AUC 0.5165591239929199
ep0_train_time 46.91980242729187
Test Epoch0 threshold 0.3 Acc 0.9001644736842105, AUC 0.9738951921463013, avg_entr 0.1824975311756134
ep0_t0.3_test_time 0.2564098834991455
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.26711666666666667 (32054/120000), AUC 0.5409225225448608
ep1_train_time 46.97829461097717
Test Epoch1 threshold 0.3 Acc 0.9120065789473685, AUC 0.9779031276702881, avg_entr 0.10906963050365448
ep1_t0.3_test_time 0.25617241859436035
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.26984166666666665 (32381/120000), AUC 0.5415660738945007
ep2_train_time 46.996663093566895
Test Epoch2 threshold 0.3 Acc 0.9136513157894737, AUC 0.9793844819068909, avg_entr 0.08105187863111496
ep2_t0.3_test_time 0.2548661231994629
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.2720666666666667 (32648/120000), AUC 0.5420024394989014
ep3_train_time 46.90351915359497
Test Epoch3 threshold 0.3 Acc 0.9167763157894737, AUC 0.9802348017692566, avg_entr 0.06648435443639755
ep3_t0.3_test_time 0.2528083324432373
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.27413333333333334 (32896/120000), AUC 0.5414656400680542
ep4_train_time 46.97984719276428
Test Epoch4 threshold 0.3 Acc 0.9154605263157894, AUC 0.9805114269256592, avg_entr 0.05960458889603615
ep4_t0.3_test_time 0.2559053897857666
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.27613333333333334 (33136/120000), AUC 0.5409708023071289
ep5_train_time 46.95006465911865
Test Epoch5 threshold 0.3 Acc 0.9123355263157895, AUC 0.9808571338653564, avg_entr 0.05592887103557587
ep5_t0.3_test_time 0.25516390800476074
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.2776416666666667 (33317/120000), AUC 0.5401979684829712
ep6_train_time 46.88346576690674
Test Epoch6 threshold 0.3 Acc 0.9159539473684211, AUC 0.9808370471000671, avg_entr 0.04896090552210808
ep6_t0.3_test_time 0.25327134132385254
gc 0
Train Epoch7 Acc 0.2795916666666667 (33551/120000), AUC 0.5394554138183594
ep7_train_time 47.03816795349121
Test Epoch7 threshold 0.3 Acc 0.9151315789473684, AUC 0.98078453540802, avg_entr 0.0460880845785141
ep7_t0.3_test_time 0.25337839126586914
gc 0
Train Epoch8 Acc 0.28129166666666666 (33755/120000), AUC 0.538843035697937
ep8_train_time 46.80314826965332
Test Epoch8 threshold 0.3 Acc 0.9151315789473684, AUC 0.9806927442550659, avg_entr 0.04294994845986366
ep8_t0.3_test_time 0.25241971015930176
gc 0
Train Epoch9 Acc 0.2825416666666667 (33905/120000), AUC 0.538056492805481
ep9_train_time 46.88634490966797
Test Epoch9 threshold 0.3 Acc 0.9157894736842105, AUC 0.9805029630661011, avg_entr 0.041061777621507645
ep9_t0.3_test_time 0.2534627914428711
Best AUC 0.9808571338653564
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m1//ag_news_lstmal_l5_prefix.pt
[[1362   54   87   29]
 [   7 1486   10    4]
 [  30   10 1363   97]
 [  44   16  145 1336]]
Figure(640x480)
tensor([0.0299, 0.0012, 0.0315,  ..., 0.0006, 0.0054, 0.0135])
[[  40  135  508  849]
 [ 260  179  194  874]
 [  40   81  167 1212]
 [  44  137  331 1029]]
Figure(640x480)
tensor([1.2765, 1.1622, 1.3171,  ..., 1.3226, 1.2155, 1.1860])
[[1242   21  108  161]
 [1405   37   49   16]
 [1377   12   65   46]
 [1480    8   38   15]]
Figure(640x480)
tensor([1.3399, 1.2981, 1.3366,  ..., 1.4043, 1.3471, 1.3214])
[[ 210  736  546   40]
 [ 538  623  344    2]
 [ 303 1020  173    4]
 [ 203  860  477    1]]
Figure(640x480)
tensor([1.4436, 1.3997, 1.4200,  ..., 1.4350, 1.3896, 1.4118])
[[1326    0  202    4]
 [ 786    0  719    2]
 [1168    0  331    1]
 [1302    0  239    0]]
Figure(640x480)
tensor([1.4357, 1.3843, 1.3805,  ..., 1.4289, 1.4040, 1.3757])
