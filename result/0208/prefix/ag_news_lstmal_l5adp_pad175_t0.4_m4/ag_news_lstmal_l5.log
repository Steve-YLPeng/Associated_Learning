total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.47641666666666665 (57170/120000), AUC 0.5712763667106628
ep0_train_time 77.31166863441467
Test Epoch0 threshold 0.4 Acc 0.9161184210526315, AUC 0.9804721474647522, avg_entr 0.024222126230597496
ep0_t0.4_test_time 0.29131603240966797
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4811166666666667 (57734/120000), AUC 0.5706521272659302
ep1_train_time 77.28311586380005
Test Epoch1 threshold 0.4 Acc 0.9139802631578947, AUC 0.980134904384613, avg_entr 0.024546565487980843
ep1_t0.4_test_time 0.2918872833251953
gc 0
Train Epoch2 Acc 0.482875 (57945/120000), AUC 0.5710883140563965
ep2_train_time 77.29118490219116
Test Epoch2 threshold 0.4 Acc 0.9148026315789474, AUC 0.9802882075309753, avg_entr 0.0244279857724905
ep2_t0.4_test_time 0.29035258293151855
gc 0
Train Epoch3 Acc 0.48333333333333334 (58000/120000), AUC 0.5720312595367432
ep3_train_time 77.32105827331543
Test Epoch3 threshold 0.4 Acc 0.9138157894736842, AUC 0.9800387024879456, avg_entr 0.02479741722345352
ep3_t0.4_test_time 0.30004024505615234
gc 0
Train Epoch4 Acc 0.48385 (58062/120000), AUC 0.5725808143615723
ep4_train_time 77.28511810302734
Test Epoch4 threshold 0.4 Acc 0.9106907894736842, AUC 0.9798187017440796, avg_entr 0.024417784065008163
ep4_t0.4_test_time 0.3070375919342041
gc 0
Train Epoch5 Acc 0.4851 (58212/120000), AUC 0.5737515687942505
ep5_train_time 77.3419246673584
Test Epoch5 threshold 0.4 Acc 0.9126644736842106, AUC 0.9797840118408203, avg_entr 0.02453187108039856
ep5_t0.4_test_time 0.2821941375732422
gc 0
Train Epoch6 Acc 0.4854833333333333 (58258/120000), AUC 0.5739777088165283
ep6_train_time 77.35489439964294
Test Epoch6 threshold 0.4 Acc 0.9134868421052632, AUC 0.9796915054321289, avg_entr 0.02437569946050644
ep6_t0.4_test_time 0.2874722480773926
gc 0
Train Epoch7 Acc 0.4860583333333333 (58327/120000), AUC 0.5742127895355225
ep7_train_time 77.33722019195557
Test Epoch7 threshold 0.4 Acc 0.9139802631578947, AUC 0.97957843542099, avg_entr 0.024885443970561028
ep7_t0.4_test_time 0.28937697410583496
gc 0
Train Epoch8 Acc 0.4864 (58368/120000), AUC 0.5742552280426025
ep8_train_time 77.2927656173706
Test Epoch8 threshold 0.4 Acc 0.9126644736842106, AUC 0.9795095324516296, avg_entr 0.024170152842998505
ep8_t0.4_test_time 0.2908008098602295
gc 0
Train Epoch9 Acc 0.48740833333333333 (58489/120000), AUC 0.5749015808105469
ep9_train_time 77.33879971504211
Test Epoch9 threshold 0.4 Acc 0.9131578947368421, AUC 0.9793657660484314, avg_entr 0.025212788954377174
ep9_t0.4_test_time 0.29712533950805664
Best AUC 0.9804721474647522
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m4//ag_news_lstmal_l5_prefix.pt
[[1378   50   71   33]
 [  13 1478    7    9]
 [  37   15 1333  115]
 [  39   13  114 1375]]
Figure(640x480)
tensor([1.6334e-03, 8.0517e-08, 1.9654e-04,  ..., 3.7479e-08, 6.5147e-06,
        1.9727e-04])
[[1388   45   58   41]
 [  21 1467    9   10]
 [  45   11 1338  106]
 [  38   12  128 1363]]
Figure(640x480)
tensor([9.7066e-07, 1.2202e-07, 2.6422e-07,  ..., 1.1605e-07, 7.3610e-07,
        7.8342e-07])
[[1387   44   59   42]
 [  22 1465   11    9]
 [  48   10 1337  105]
 [  36   12  128 1365]]
Figure(640x480)
tensor([1.1446e-06, 2.7683e-07, 5.5341e-07,  ..., 1.0183e-07, 5.5668e-07,
        9.0787e-07])
[[1389   45   58   40]
 [  26 1463   11    7]
 [  49   11 1331  109]
 [  39   13  130 1359]]
Figure(640x480)
tensor([3.8285e-06, 3.6516e-07, 6.4545e-07,  ..., 5.4093e-08, 9.5924e-07,
        1.4000e-06])
[[1408    0  124    0]
 [  18    0 1489    0]
 [ 101    0 1399    0]
 [1260    0  281    0]]
Figure(640x480)
tensor([0.5409, 1.0705, 1.0547,  ..., 0.4784, 1.0689, 0.5131])
