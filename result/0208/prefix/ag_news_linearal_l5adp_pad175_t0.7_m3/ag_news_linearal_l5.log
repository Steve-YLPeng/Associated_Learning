total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.5894333333333334 (70732/120000), AUC 0.8804827332496643
ep0_train_time 9.622488498687744
Test Epoch0 threshold 0.7 Acc 0.9157894736842105, AUC 0.980758011341095, avg_entr 0.02628200128674507
ep0_t0.7_test_time 0.25765299797058105
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.6405083333333333 (76861/120000), AUC 0.9274197816848755
ep1_train_time 9.11980676651001
Test Epoch1 threshold 0.7 Acc 0.9154605263157894, AUC 0.9806556701660156, avg_entr 0.025428885594010353
ep1_t0.7_test_time 0.25705957412719727
gc 0
Train Epoch2 Acc 0.6504083333333334 (78049/120000), AUC 0.9427095651626587
ep2_train_time 9.14914846420288
Test Epoch2 threshold 0.7 Acc 0.9136513157894737, AUC 0.980496883392334, avg_entr 0.02614559605717659
ep2_t0.7_test_time 0.2562565803527832
gc 0
Train Epoch3 Acc 0.6683583333333334 (80203/120000), AUC 0.9134897589683533
ep3_train_time 9.155065774917603
Test Epoch3 threshold 0.7 Acc 0.9126644736842106, AUC 0.9804718494415283, avg_entr 0.026027895510196686
ep3_t0.7_test_time 0.2558412551879883
gc 0
Train Epoch4 Acc 0.68265 (81918/120000), AUC 0.8592244982719421
ep4_train_time 9.184754610061646
Test Epoch4 threshold 0.7 Acc 0.9146381578947368, AUC 0.980250895023346, avg_entr 0.026125013828277588
ep4_t0.7_test_time 0.25438594818115234
gc 0
Train Epoch5 Acc 0.6752916666666666 (81035/120000), AUC 0.8205820322036743
ep5_train_time 9.125068187713623
Test Epoch5 threshold 0.7 Acc 0.9151315789473684, AUC 0.9802219867706299, avg_entr 0.02603699453175068
ep5_t0.7_test_time 0.2544527053833008
gc 0
Train Epoch6 Acc 0.605225 (72627/120000), AUC 0.7900499105453491
ep6_train_time 9.081804752349854
Test Epoch6 threshold 0.7 Acc 0.9144736842105263, AUC 0.9800323247909546, avg_entr 0.026038767769932747
ep6_t0.7_test_time 0.2550475597381592
gc 0
Train Epoch7 Acc 0.47754166666666664 (57305/120000), AUC 0.7541270852088928
ep7_train_time 9.198944807052612
Test Epoch7 threshold 0.7 Acc 0.9138157894736842, AUC 0.9798297882080078, avg_entr 0.025382598862051964
ep7_t0.7_test_time 0.25699305534362793
gc 0
Train Epoch8 Acc 0.4355833333333333 (52270/120000), AUC 0.7171374559402466
ep8_train_time 9.234005689620972
Test Epoch8 threshold 0.7 Acc 0.9118421052631579, AUC 0.9797486066818237, avg_entr 0.02533002570271492
ep8_t0.7_test_time 0.25647401809692383
gc 0
Train Epoch9 Acc 0.427925 (51351/120000), AUC 0.6885616183280945
ep9_train_time 9.122956991195679
Test Epoch9 threshold 0.7 Acc 0.9129934210526316, AUC 0.9797382354736328, avg_entr 0.02551833912730217
ep9_t0.7_test_time 0.25731754302978516
Best AUC 0.980758011341095
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt
[[335   7  14  12]
 [  0 389   3   1]
 [  9   5 359  27]
 [  6   1  25 327]]
Figure(640x480)
tensor([3.0481e-04, 1.7378e-03, 9.1327e-02,  ..., 3.4230e-02, 2.9448e-07,
        3.9399e-04])
[[336   6  14  12]
 [  0 389   3   1]
 [  7   5 358  30]
 [  6   1  26 326]]
Figure(640x480)
tensor([5.2491e-04, 7.1361e-04, 9.2968e-02,  ..., 3.2242e-02, 3.6653e-07,
        1.1068e-03])
[[334   7  14  13]
 [  0 389   3   1]
 [  8   5 360  27]
 [  6   1  25 327]]
Figure(640x480)
tensor([7.8757e-04, 7.9208e-04, 9.2186e-02,  ..., 2.6563e-02, 3.7557e-07,
        1.5159e-03])
[[ 41 321   0   6]
 [  0 393   0   0]
 [  0 400   0   0]
 [  0 359   0   0]]
Figure(640x480)
tensor([0.3203, 0.3080, 0.2898,  ..., 0.5898, 0.4425, 0.3998])
[[  0  25   0 343]
 [  0 393   0   0]
 [  0  98 176 126]
 [  0   7   3 349]]
Figure(640x480)
tensor([0.9981, 0.9954, 1.0346,  ..., 0.9676, 1.0658, 1.3034])
