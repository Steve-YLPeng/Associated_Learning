total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.25000833333333333 (30001/120000), AUC 0.5854387879371643
ep0_train_time 8.998332977294922
Test Epoch0 threshold 0.7 Acc 0.9146381578947368, AUC 0.9807239770889282, avg_entr 0.02941512130200863
ep0_t0.7_test_time 0.2513561248779297
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.250025 (30003/120000), AUC 0.5256718993186951
ep1_train_time 8.554603576660156
Test Epoch1 threshold 0.7 Acc 0.9161184210526315, AUC 0.9809297919273376, avg_entr 0.027270860970020294
ep1_t0.7_test_time 0.24928689002990723
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25003333333333333 (30004/120000), AUC 0.5265337228775024
ep2_train_time 8.54032826423645
Test Epoch2 threshold 0.7 Acc 0.915296052631579, AUC 0.9807071089744568, avg_entr 0.026407690718770027
ep2_t0.7_test_time 0.24996614456176758
gc 0
Train Epoch3 Acc 0.250025 (30003/120000), AUC 0.5320718288421631
ep3_train_time 8.584343671798706
Test Epoch3 threshold 0.7 Acc 0.9166118421052631, AUC 0.9805759191513062, avg_entr 0.026502175256609917
ep3_t0.7_test_time 0.249664306640625
gc 0
Train Epoch4 Acc 0.25000833333333333 (30001/120000), AUC 0.5365170836448669
ep4_train_time 8.602482795715332
Test Epoch4 threshold 0.7 Acc 0.9151315789473684, AUC 0.980442464351654, avg_entr 0.0255254115909338
ep4_t0.7_test_time 0.24955248832702637
gc 0
Train Epoch5 Acc 0.25001666666666666 (30002/120000), AUC 0.5418630838394165
ep5_train_time 8.617595434188843
Test Epoch5 threshold 0.7 Acc 0.9134868421052632, AUC 0.980425238609314, avg_entr 0.027239792048931122
ep5_t0.7_test_time 0.24873638153076172
gc 0
Train Epoch6 Acc 0.25000833333333333 (30001/120000), AUC 0.5452877283096313
ep6_train_time 8.451243877410889
Test Epoch6 threshold 0.7 Acc 0.9136513157894737, AUC 0.9802659153938293, avg_entr 0.02578718774020672
ep6_t0.7_test_time 0.249161958694458
gc 0
Train Epoch7 Acc 0.25000833333333333 (30001/120000), AUC 0.5481239557266235
ep7_train_time 8.673351049423218
Test Epoch7 threshold 0.7 Acc 0.9141447368421053, AUC 0.9801602363586426, avg_entr 0.02614082768559456
ep7_t0.7_test_time 0.2500171661376953
gc 0
Train Epoch8 Acc 0.25000833333333333 (30001/120000), AUC 0.5505870580673218
ep8_train_time 8.601411581039429
Test Epoch8 threshold 0.7 Acc 0.9134868421052632, AUC 0.979995608329773, avg_entr 0.025984304025769234
ep8_t0.7_test_time 0.2492971420288086
gc 0
Train Epoch9 Acc 0.25000833333333333 (30001/120000), AUC 0.5534204244613647
ep9_train_time 8.472063779830933
Test Epoch9 threshold 0.7 Acc 0.9133223684210526, AUC 0.9799221754074097, avg_entr 0.02628295123577118
ep9_t0.7_test_time 0.2491755485534668
Best AUC 0.9809297919273376
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt
[[331   7  15  15]
 [  0 389   3   1]
 [  5   5 360  30]
 [  4   0  26 329]]
Figure(640x480)
tensor([2.9172e-04, 1.3799e-03, 1.9608e-02,  ..., 1.4070e-02, 2.0759e-06,
        4.5130e-04])
[[332   7  15  14]
 [  0 389   3   1]
 [  6   5 358  31]
 [  5   1  23 330]]
Figure(640x480)
tensor([7.0373e-04, 8.8948e-04, 4.7979e-02,  ..., 1.4570e-02, 2.2556e-06,
        3.1339e-03])
[[368   0   0   0]
 [391   0   2   0]
 [287   0 113   0]
 [356   0   3   0]]
Figure(640x480)
tensor([0.7789, 0.7573, 0.8682,  ..., 0.7615, 0.9543, 0.9329])
[[  0   1 322  45]
 [  0 241 152   0]
 [  0   1 399   0]
 [  0  53 306   0]]
Figure(640x480)
tensor([1.0069, 0.9767, 0.9670,  ..., 1.0394, 0.7684, 0.8871])
[[  0 368   0   0]
 [  0 393   0   0]
 [  0 400   0   0]
 [  0 359   0   0]]
Figure(640x480)
tensor([1.0108, 1.0530, 1.0514,  ..., 1.0215, 1.0110, 1.0330])
