total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.936675 (112401/120000), AUC 0.9870526790618896
ep0_train_time 88.14476728439331
Test Epoch0 threshold 0.3 Acc 0.9154605263157894, AUC 0.9801510572433472, avg_entr 0.023049375042319298
ep0_t0.3_test_time 0.3485531806945801
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9585166666666667 (115022/120000), AUC 0.9936245083808899
ep1_train_time 88.15865445137024
Test Epoch1 threshold 0.3 Acc 0.9166118421052631, AUC 0.9802167415618896, avg_entr 0.023226605728268623
ep1_t0.3_test_time 0.3436925411224365
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m5//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.961125 (115335/120000), AUC 0.9941850304603577
ep2_train_time 88.31166172027588
Test Epoch2 threshold 0.3 Acc 0.9129934210526316, AUC 0.9800218343734741, avg_entr 0.023007314652204514
ep2_t0.3_test_time 0.3584270477294922
gc 0
Train Epoch3 Acc 0.963525 (115623/120000), AUC 0.9944283366203308
ep3_train_time 88.383474111557
Test Epoch3 threshold 0.3 Acc 0.9138157894736842, AUC 0.9799288511276245, avg_entr 0.02265034429728985
ep3_t0.3_test_time 0.3391573429107666
gc 0
Train Epoch4 Acc 0.965175 (115821/120000), AUC 0.9944931268692017
ep4_train_time 88.80633926391602
Test Epoch4 threshold 0.3 Acc 0.9143092105263158, AUC 0.9796103835105896, avg_entr 0.022073788568377495
ep4_t0.3_test_time 0.35408544540405273
gc 0
Train Epoch5 Acc 0.9691166666666666 (116294/120000), AUC 0.9951303601264954
ep5_train_time 88.26610660552979
Test Epoch5 threshold 0.3 Acc 0.9131578947368421, AUC 0.9795635342597961, avg_entr 0.023045744746923447
ep5_t0.3_test_time 0.3219032287597656
gc 0
Train Epoch6 Acc 0.9698 (116376/120000), AUC 0.9950997829437256
ep6_train_time 88.16466665267944
Test Epoch6 threshold 0.3 Acc 0.9134868421052632, AUC 0.9793403148651123, avg_entr 0.022866709157824516
ep6_t0.3_test_time 0.31540942192077637
gc 0
Train Epoch7 Acc 0.9709583333333334 (116515/120000), AUC 0.9951194524765015
ep7_train_time 88.27596735954285
Test Epoch7 threshold 0.3 Acc 0.9111842105263158, AUC 0.9792191982269287, avg_entr 0.0229352917522192
ep7_t0.3_test_time 0.31382083892822266
gc 0
Train Epoch8 Acc 0.972075 (116649/120000), AUC 0.9950803518295288
ep8_train_time 88.2597324848175
Test Epoch8 threshold 0.3 Acc 0.9126644736842106, AUC 0.9789496660232544, avg_entr 0.02328444831073284
ep8_t0.3_test_time 0.33159899711608887
gc 0
Train Epoch9 Acc 0.974075 (116889/120000), AUC 0.995383620262146
ep9_train_time 88.23367214202881
Test Epoch9 threshold 0.3 Acc 0.9115131578947369, AUC 0.9789441823959351, avg_entr 0.023027576506137848
ep9_t0.3_test_time 0.3154129981994629
Best AUC 0.9802167415618896
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m5//ag_news_lstmal_l5_prefix.pt
[[1376   51   70   35]
 [  14 1474    8   11]
 [  36   13 1328  123]
 [  35   12  100 1394]]
Figure(640x480)
tensor([3.8956e-03, 4.6334e-08, 2.6690e-05,  ..., 1.7870e-08, 2.8486e-06,
        1.8247e-04])
[[1370   53   60   49]
 [  16 1469   15    7]
 [  43   12 1334  111]
 [  40   15  128 1358]]
Figure(640x480)
tensor([2.2629e-06, 4.9910e-08, 1.7428e-07,  ..., 5.3046e-08, 6.5052e-07,
        1.9429e-07])
[[1368   53   61   50]
 [  15 1469   16    7]
 [  44   13 1334  109]
 [  36   15  129 1361]]
Figure(640x480)
tensor([1.6349e-06, 1.7516e-07, 3.2735e-07,  ..., 1.7807e-07, 6.7153e-07,
        3.1498e-07])
[[1369   52   59   52]
 [  18 1466   16    7]
 [  45   13 1330  112]
 [  36   16  122 1367]]
Figure(640x480)
tensor([4.5031e-06, 2.4519e-07, 7.2984e-07,  ..., 1.5822e-07, 1.5891e-06,
        5.9527e-07])
[[1370   51   59   52]
 [  21 1464   16    6]
 [  48   13 1327  112]
 [  36   16  129 1360]]
Figure(640x480)
tensor([1.0863e-06, 3.3332e-07, 9.8062e-07,  ..., 1.9027e-07, 1.5745e-06,
        3.9268e-07])
