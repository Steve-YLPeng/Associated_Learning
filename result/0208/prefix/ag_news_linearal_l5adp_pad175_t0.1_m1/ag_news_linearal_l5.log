total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25045 (30054/120000), AUC 0.5621681213378906
ep0_train_time 8.32094144821167
Test Epoch0 threshold 0.1 Acc 0.9016447368421052, AUC 0.9738032817840576, avg_entr 0.1806344836950302
ep0_t0.1_test_time 0.25057268142700195
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.6242727637290955
ep1_train_time 7.900306701660156
Test Epoch1 threshold 0.1 Acc 0.9110197368421052, AUC 0.9779035449028015, avg_entr 0.10360092669725418
ep1_t0.1_test_time 0.24910449981689453
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.6166278719902039
ep2_train_time 7.904919385910034
Test Epoch2 threshold 0.1 Acc 0.9134868421052632, AUC 0.9793453216552734, avg_entr 0.08107583224773407
ep2_t0.1_test_time 0.24953770637512207
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.6091297268867493
ep3_train_time 7.9951090812683105
Test Epoch3 threshold 0.1 Acc 0.9154605263157894, AUC 0.9800944924354553, avg_entr 0.0670805349946022
ep3_t0.1_test_time 0.24884295463562012
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.602165699005127
ep4_train_time 7.920895576477051
Test Epoch4 threshold 0.1 Acc 0.9157894736842105, AUC 0.9804158210754395, avg_entr 0.05965111404657364
ep4_t0.1_test_time 0.2489149570465088
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.5965771079063416
ep5_train_time 8.012371063232422
Test Epoch5 threshold 0.1 Acc 0.9162828947368421, AUC 0.9805741310119629, avg_entr 0.0555160790681839
ep5_t0.1_test_time 0.249406099319458
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.5918609499931335
ep6_train_time 7.954556465148926
Test Epoch6 threshold 0.1 Acc 0.9171052631578948, AUC 0.9804686307907104, avg_entr 0.04870256036520004
ep6_t0.1_test_time 0.24940180778503418
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.587736964225769
ep7_train_time 8.012073040008545
Test Epoch7 threshold 0.1 Acc 0.9175986842105263, AUC 0.980687141418457, avg_entr 0.04661843553185463
ep7_t0.1_test_time 0.24912047386169434
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.58387291431427
ep8_train_time 8.03044581413269
Test Epoch8 threshold 0.1 Acc 0.9166118421052631, AUC 0.9805007576942444, avg_entr 0.04305383935570717
ep8_t0.1_test_time 0.2500166893005371
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.5804862380027771
ep9_train_time 7.986028432846069
Test Epoch9 threshold 0.1 Acc 0.9159539473684211, AUC 0.9803168773651123, avg_entr 0.04066958278417587
ep9_t0.1_test_time 0.24990200996398926
Best AUC 0.980687141418457
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt
[[1386   51   62   33]
 [  18 1474    2   13]
 [  41   14 1317  128]
 [  41   11   87 1402]]
Figure(640x480)
tensor([0.0563, 0.0001, 0.0043,  ..., 0.0004, 0.0012, 0.0232])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([1.3387, 1.3850, 1.3605,  ..., 1.3120, 1.3567, 1.3459])
[[1517    0    0   15]
 [1490    0    0   17]
 [1233    0    0  267]
 [1533    0    0    8]]
Figure(640x480)
tensor([1.4076, 1.4205, 1.4214,  ..., 1.4086, 1.4240, 1.4151])
[[   0    0 1532    0]
 [   0    0 1507    0]
 [   0    0 1500    0]
 [   0    0 1541    0]]
Figure(640x480)
tensor([1.2204, 1.2280, 1.2196,  ..., 1.2197, 1.2129, 1.2225])
[[   0    0 1532    0]
 [   0    0 1507    0]
 [   0    0 1500    0]
 [   0    0 1541    0]]
Figure(640x480)
tensor([1.1948, 1.2294, 1.2176,  ..., 1.2191, 1.2294, 1.2098])
