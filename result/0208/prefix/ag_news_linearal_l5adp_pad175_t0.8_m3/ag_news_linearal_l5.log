total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.040225 (4827/120000), AUC 0.3635265529155731
ep0_train_time 9.53114366531372
Test Epoch0 threshold 0.8 Acc 0.9161184210526315, AUC 0.9809884428977966, avg_entr 0.02548866532742977
ep0_t0.8_test_time 0.2533445358276367
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.06441666666666666 (7730/120000), AUC 0.3853122591972351
ep1_train_time 9.065226078033447
Test Epoch1 threshold 0.8 Acc 0.915625, AUC 0.9807360768318176, avg_entr 0.025864405557513237
ep1_t0.8_test_time 0.2512233257293701
gc 0
Train Epoch2 Acc 0.09799166666666667 (11759/120000), AUC 0.4354458153247833
ep2_train_time 9.079185962677002
Test Epoch2 threshold 0.8 Acc 0.9146381578947368, AUC 0.9806300401687622, avg_entr 0.025697767734527588
ep2_t0.8_test_time 0.2521934509277344
gc 0
Train Epoch3 Acc 0.07476666666666666 (8972/120000), AUC 0.4651004374027252
ep3_train_time 9.065997838973999
Test Epoch3 threshold 0.8 Acc 0.9154605263157894, AUC 0.9804568290710449, avg_entr 0.02609788440167904
ep3_t0.8_test_time 0.251584529876709
gc 0
Train Epoch4 Acc 0.05131666666666666 (6158/120000), AUC 0.46793240308761597
ep4_train_time 9.124000310897827
Test Epoch4 threshold 0.8 Acc 0.9151315789473684, AUC 0.980406641960144, avg_entr 0.026372043415904045
ep4_t0.8_test_time 0.25139832496643066
gc 0
Train Epoch5 Acc 0.04065833333333333 (4879/120000), AUC 0.4552614390850067
ep5_train_time 9.118740558624268
Test Epoch5 threshold 0.8 Acc 0.9138157894736842, AUC 0.9802224636077881, avg_entr 0.025630589574575424
ep5_t0.8_test_time 0.25150275230407715
gc 0
Train Epoch6 Acc 0.03675833333333333 (4411/120000), AUC 0.4480036795139313
ep6_train_time 9.18492078781128
Test Epoch6 threshold 0.8 Acc 0.9139802631578947, AUC 0.9800900220870972, avg_entr 0.025555791333317757
ep6_t0.8_test_time 0.25093841552734375
gc 0
Train Epoch7 Acc 0.0359 (4308/120000), AUC 0.44699302315711975
ep7_train_time 9.166789054870605
Test Epoch7 threshold 0.8 Acc 0.9146381578947368, AUC 0.9800142049789429, avg_entr 0.0258465763181448
ep7_t0.8_test_time 0.2592334747314453
gc 0
Train Epoch8 Acc 0.034883333333333336 (4186/120000), AUC 0.45196086168289185
ep8_train_time 9.186448812484741
Test Epoch8 threshold 0.8 Acc 0.9134868421052632, AUC 0.9798650145530701, avg_entr 0.02648087590932846
ep8_t0.8_test_time 0.2514653205871582
gc 0
Train Epoch9 Acc 0.034458333333333334 (4135/120000), AUC 0.45688265562057495
ep9_train_time 9.146231412887573
Test Epoch9 threshold 0.8 Acc 0.9139802631578947, AUC 0.9798228740692139, avg_entr 0.026143237948417664
ep9_t0.8_test_time 0.25174427032470703
Best AUC 0.9809884428977966
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt
[[328   7  17  16]
 [  0 388   4   1]
 [  5   5 362  28]
 [  3   1  26 329]]
Figure(640x480)
tensor([5.8839e-04, 8.6157e-04, 6.4235e-02,  ..., 2.0712e-02, 3.6266e-07,
        4.9842e-04])
[[329   7  16  16]
 [  0 388   4   1]
 [  5   4 362  29]
 [  3   1  27 328]]
Figure(640x480)
tensor([2.2969e-04, 4.6264e-04, 2.3387e-02,  ..., 4.1452e-02, 4.4949e-07,
        6.9681e-04])
[[327   7  18  16]
 [  0 388   4   1]
 [  5   4 364  27]
 [  3   1  31 324]]
Figure(640x480)
tensor([2.9954e-04, 5.0587e-04, 4.1780e-02,  ..., 3.8765e-02, 6.9572e-07,
        7.6927e-04])
[[  0   0 368   0]
 [  0   0 393   0]
 [  0   0 400   0]
 [  3   0 356   0]]
Figure(640x480)
tensor([0.8328, 0.8271, 0.7476,  ..., 0.6082, 0.6503, 0.6706])
[[  0 345  23   0]
 [  0   1 392   0]
 [  0 316  84   0]
 [  0  15 344   0]]
Figure(640x480)
tensor([0.5544, 0.5035, 0.6226,  ..., 0.5219, 1.1521, 0.9202])
