total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9189083333333333 (110269/120000), AUC 0.9857451915740967
ep0_train_time 10.366596460342407
Test Epoch0 threshold 0.1 Acc 0.9161184210526315, AUC 0.9803707599639893, avg_entr 0.020626302808523178
ep0_t0.1_test_time 0.2821822166442871
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9502 (114024/120000), AUC 0.9932389259338379
ep1_train_time 9.917272806167603
Test Epoch1 threshold 0.1 Acc 0.9125, AUC 0.9802262187004089, avg_entr 0.016304465010762215
ep1_t0.1_test_time 0.2818267345428467
gc 0
Train Epoch2 Acc 0.95215 (114258/120000), AUC 0.9934326410293579
ep2_train_time 9.942256689071655
Test Epoch2 threshold 0.1 Acc 0.9151315789473684, AUC 0.9799612760543823, avg_entr 0.013885771855711937
ep2_t0.1_test_time 0.2804734706878662
gc 0
Train Epoch3 Acc 0.9530166666666666 (114362/120000), AUC 0.9935119152069092
ep3_train_time 9.95947265625
Test Epoch3 threshold 0.1 Acc 0.9136513157894737, AUC 0.9797728657722473, avg_entr 0.012226607650518417
ep3_t0.1_test_time 0.2810094356536865
gc 0
Train Epoch4 Acc 0.9541416666666667 (114497/120000), AUC 0.9938471913337708
ep4_train_time 9.999307870864868
Test Epoch4 threshold 0.1 Acc 0.9136513157894737, AUC 0.9795454740524292, avg_entr 0.011638998053967953
ep4_t0.1_test_time 0.2813985347747803
gc 0
Train Epoch5 Acc 0.9555083333333333 (114661/120000), AUC 0.9945158958435059
ep5_train_time 9.986215829849243
Test Epoch5 threshold 0.1 Acc 0.9133223684210526, AUC 0.9794126152992249, avg_entr 0.011433246545493603
ep5_t0.1_test_time 0.28069472312927246
gc 0
Train Epoch6 Acc 0.9562166666666667 (114746/120000), AUC 0.9946494102478027
ep6_train_time 9.933221578598022
Test Epoch6 threshold 0.1 Acc 0.9126644736842106, AUC 0.9794022440910339, avg_entr 0.011046175844967365
ep6_t0.1_test_time 0.2809720039367676
gc 0
Train Epoch7 Acc 0.956375 (114765/120000), AUC 0.9947878122329712
ep7_train_time 10.079448223114014
Test Epoch7 threshold 0.1 Acc 0.9123355263157895, AUC 0.9792447090148926, avg_entr 0.011216146871447563
ep7_t0.1_test_time 0.2801985740661621
gc 0
Train Epoch8 Acc 0.9569 (114828/120000), AUC 0.9948683381080627
ep8_train_time 10.02468490600586
Test Epoch8 threshold 0.1 Acc 0.9105263157894737, AUC 0.9790918231010437, avg_entr 0.011275974102318287
ep8_t0.1_test_time 0.28084278106689453
gc 0
Train Epoch9 Acc 0.957925 (114951/120000), AUC 0.9952087998390198
ep9_train_time 9.884455442428589
Test Epoch9 threshold 0.1 Acc 0.912828947368421, AUC 0.979094922542572, avg_entr 0.010731036774814129
ep9_t0.1_test_time 0.2831094264984131
Best AUC 0.9803707599639893
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.1_m5//ag_news_linearal_l5_prefix.pt
[[1367   51   76   38]
 [  12 1478    8    9]
 [  33   12 1338  117]
 [  34   12  109 1386]]
Figure(640x480)
tensor([7.8006e-04, 1.0193e-07, 4.8086e-05,  ..., 2.8666e-08, 5.0530e-06,
        1.2980e-04])
[[1373   51   72   36]
 [  10 1481    8    8]
 [  37   15 1332  116]
 [  34   13  105 1389]]
Figure(640x480)
tensor([4.7999e-04, 1.1488e-06, 4.5686e-05,  ..., 4.9838e-08, 5.2409e-06,
        1.9602e-04])
[[1373   51   71   37]
 [  12 1476    9   10]
 [  36   15 1332  117]
 [  34   13  105 1389]]
Figure(640x480)
tensor([3.1552e-04, 2.7110e-07, 2.8086e-05,  ..., 3.6872e-08, 4.0111e-06,
        1.1457e-04])
[[1372   51   70   39]
 [  11 1479    8    9]
 [  34   16 1332  118]
 [  34   14  103 1390]]
Figure(640x480)
tensor([1.9706e-04, 6.7490e-08, 1.7780e-05,  ..., 2.7971e-08, 3.1791e-06,
        1.7523e-05])
[[1375   51   69   37]
 [  13 1475    8   11]
 [  36   15 1329  120]
 [  34   12  103 1392]]
Figure(640x480)
tensor([1.0159e-04, 1.1918e-07, 1.0654e-05,  ..., 3.4219e-08, 2.0744e-06,
        2.8606e-05])
