total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.127525 (15303/120000), AUC 0.30968552827835083
ep0_train_time 10.270816564559937
Test Epoch0 threshold 0.8 Acc 0.915625, AUC 0.9808421730995178, avg_entr 0.025966327637434006
ep0_t0.8_test_time 0.2665832042694092
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.06544166666666666 (7853/120000), AUC 0.292797714471817
ep1_train_time 9.926805973052979
Test Epoch1 threshold 0.8 Acc 0.9166118421052631, AUC 0.9808156490325928, avg_entr 0.02604585513472557
ep1_t0.8_test_time 0.2652320861816406
gc 0
Train Epoch2 Acc 0.0478 (5736/120000), AUC 0.2954541742801666
ep2_train_time 9.851418495178223
Test Epoch2 threshold 0.8 Acc 0.915625, AUC 0.9803704619407654, avg_entr 0.02541721984744072
ep2_t0.8_test_time 0.2653310298919678
gc 0
Train Epoch3 Acc 0.044983333333333334 (5398/120000), AUC 0.34296470880508423
ep3_train_time 9.800943613052368
Test Epoch3 threshold 0.8 Acc 0.915296052631579, AUC 0.9803608655929565, avg_entr 0.02521389350295067
ep3_t0.8_test_time 0.2640416622161865
gc 0
Train Epoch4 Acc 0.04865 (5838/120000), AUC 0.38025176525115967
ep4_train_time 9.94822382926941
Test Epoch4 threshold 0.8 Acc 0.9131578947368421, AUC 0.9801586866378784, avg_entr 0.02512110210955143
ep4_t0.8_test_time 0.26491570472717285
gc 0
Train Epoch5 Acc 0.045283333333333335 (5434/120000), AUC 0.40951162576675415
ep5_train_time 9.918277263641357
Test Epoch5 threshold 0.8 Acc 0.9133223684210526, AUC 0.9801563620567322, avg_entr 0.025875018909573555
ep5_t0.8_test_time 0.2643859386444092
gc 0
Train Epoch6 Acc 0.04323333333333333 (5188/120000), AUC 0.4213715195655823
ep6_train_time 9.834479808807373
Test Epoch6 threshold 0.8 Acc 0.9151315789473684, AUC 0.9800359010696411, avg_entr 0.02532137557864189
ep6_t0.8_test_time 0.26462411880493164
gc 0
Train Epoch7 Acc 0.041791666666666664 (5015/120000), AUC 0.4301357865333557
ep7_train_time 9.851183891296387
Test Epoch7 threshold 0.8 Acc 0.9144736842105263, AUC 0.9799028635025024, avg_entr 0.026498043909668922
ep7_t0.8_test_time 0.26389384269714355
gc 0
Train Epoch8 Acc 0.041008333333333334 (4921/120000), AUC 0.43397241830825806
ep8_train_time 9.902267932891846
Test Epoch8 threshold 0.8 Acc 0.9136513157894737, AUC 0.9798001050949097, avg_entr 0.025851670652627945
ep8_t0.8_test_time 0.2653365135192871
gc 0
Train Epoch9 Acc 0.04019166666666667 (4823/120000), AUC 0.4362630546092987
ep9_train_time 9.930188417434692
Test Epoch9 threshold 0.8 Acc 0.9133223684210526, AUC 0.9797236919403076, avg_entr 0.026562634855508804
ep9_t0.8_test_time 0.26438355445861816
Best AUC 0.9808421730995178
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt
[[327   7  18  16]
 [  0 388   4   1]
 [  5   4 363  28]
 [  3   1  28 327]]
Figure(640x480)
tensor([5.3969e-04, 5.0905e-04, 9.9314e-02,  ..., 7.4024e-02, 1.0824e-07,
        1.5546e-04])
[[328   7  17  16]
 [  0 388   4   1]
 [  5   4 364  27]
 [  3   1  28 327]]
Figure(640x480)
tensor([2.1480e-04, 3.3034e-04, 4.5838e-02,  ..., 9.1070e-02, 1.5302e-07,
        1.9278e-04])
[[328   7  17  16]
 [  0 388   4   1]
 [  5   4 365  26]
 [  4   0  29 326]]
Figure(640x480)
tensor([2.1649e-04, 2.2336e-04, 5.1090e-02,  ..., 5.8968e-02, 1.7378e-07,
        1.8487e-04])
[[328   7  17  16]
 [  0 388   4   1]
 [  5   4 363  28]
 [  3   1  28 327]]
Figure(640x480)
tensor([1.6260e-04, 1.8621e-04, 3.5336e-02,  ..., 3.2322e-02, 8.6311e-08,
        1.5240e-04])
[[  0 326   2  40]
 [  0   0   4 389]
 [  0   2   6 392]
 [  0   8 205 146]]
Figure(640x480)
tensor([0.6846, 0.5998, 0.9633,  ..., 0.3360, 0.5818, 0.7231])
