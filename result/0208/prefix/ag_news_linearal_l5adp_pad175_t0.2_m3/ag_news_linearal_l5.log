total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.16081666666666666 (19298/120000), AUC 0.4652131497859955
ep0_train_time 9.550326108932495
Test Epoch0 threshold 0.2 Acc 0.9157894736842105, AUC 0.9805365800857544, avg_entr 0.02513515017926693
ep0_t0.2_test_time 0.2722737789154053
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.10724166666666667 (12869/120000), AUC 0.4681263864040375
ep1_train_time 9.09984803199768
Test Epoch1 threshold 0.2 Acc 0.9167763157894737, AUC 0.9804417490959167, avg_entr 0.02444087527692318
ep1_t0.2_test_time 0.2680792808532715
gc 0
Train Epoch2 Acc 0.09963333333333334 (11956/120000), AUC 0.46023809909820557
ep2_train_time 9.005521297454834
Test Epoch2 threshold 0.2 Acc 0.915625, AUC 0.9803498983383179, avg_entr 0.02438344992697239
ep2_t0.2_test_time 0.27197885513305664
gc 0
Train Epoch3 Acc 0.11264166666666667 (13517/120000), AUC 0.46931391954421997
ep3_train_time 9.114033699035645
Test Epoch3 threshold 0.2 Acc 0.9161184210526315, AUC 0.980238139629364, avg_entr 0.02508016861975193
ep3_t0.2_test_time 0.26941609382629395
gc 0
Train Epoch4 Acc 0.2608666666666667 (31304/120000), AUC 0.5455855131149292
ep4_train_time 9.056414365768433
Test Epoch4 threshold 0.2 Acc 0.9146381578947368, AUC 0.9801662564277649, avg_entr 0.022737639024853706
ep4_t0.2_test_time 0.268204927444458
gc 0
Train Epoch5 Acc 0.365475 (43857/120000), AUC 0.6370779275894165
ep5_train_time 9.094884157180786
Test Epoch5 threshold 0.2 Acc 0.9120065789473685, AUC 0.9799339771270752, avg_entr 0.02309841848909855
ep5_t0.2_test_time 0.2693471908569336
gc 0
Train Epoch6 Acc 0.37745 (45294/120000), AUC 0.6562771201133728
ep6_train_time 9.219639539718628
Test Epoch6 threshold 0.2 Acc 0.9159539473684211, AUC 0.9799765944480896, avg_entr 0.022442201152443886
ep6_t0.2_test_time 0.2689700126647949
gc 0
Train Epoch7 Acc 0.3799166666666667 (45590/120000), AUC 0.6711755394935608
ep7_train_time 9.035087585449219
Test Epoch7 threshold 0.2 Acc 0.9141447368421053, AUC 0.9797789454460144, avg_entr 0.022413674741983414
ep7_t0.2_test_time 0.2687556743621826
gc 0
Train Epoch8 Acc 0.3808666666666667 (45704/120000), AUC 0.68663489818573
ep8_train_time 9.08557653427124
Test Epoch8 threshold 0.2 Acc 0.9149671052631579, AUC 0.9798077940940857, avg_entr 0.021036596968770027
ep8_t0.2_test_time 0.26750993728637695
gc 0
Train Epoch9 Acc 0.37855833333333333 (45427/120000), AUC 0.6978616714477539
ep9_train_time 9.15133547782898
Test Epoch9 threshold 0.2 Acc 0.912828947368421, AUC 0.9796454906463623, avg_entr 0.02123313769698143
ep9_t0.2_test_time 0.2680492401123047
Best AUC 0.9805365800857544
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt
[[1372   50   76   34]
 [  10 1477   11    9]
 [  35   10 1344  111]
 [  38   11  113 1379]]
Figure(640x480)
tensor([1.2873e-03, 9.2381e-08, 1.4606e-04,  ..., 7.8399e-08, 9.5687e-06,
        1.3331e-04])
[[1373   50   75   34]
 [  12 1476    9   10]
 [  33   10 1343  114]
 [  38   12  118 1373]]
Figure(640x480)
tensor([2.0749e-03, 8.2773e-07, 1.1251e-04,  ..., 1.2041e-07, 1.2349e-05,
        2.8760e-04])
[[1371   50   77   34]
 [  13 1472   11   11]
 [  33   10 1345  112]
 [  38   11  113 1379]]
Figure(640x480)
tensor([1.9561e-03, 1.2559e-06, 7.8559e-05,  ..., 9.9167e-08, 1.5226e-05,
        4.2964e-04])
[[ 176   21    0 1335]
 [   0    0    0 1507]
 [   0    0    0 1500]
 [   0    0    0 1541]]
Figure(640x480)
tensor([0.7991, 0.4759, 0.6103,  ..., 0.7602, 0.6098, 0.7220])
[[   0    0    5 1527]
 [   0    0    1 1506]
 [   0    0   25 1475]
 [   0    0  733  808]]
Figure(640x480)
tensor([0.7374, 0.7182, 0.8512,  ..., 0.7252, 0.8246, 0.6583])
