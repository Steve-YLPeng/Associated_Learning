total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9262166666666667 (111146/120000), AUC 0.9868627786636353
ep0_train_time 10.465020656585693
Test Epoch0 threshold 0.7 Acc 0.9138157894736842, AUC 0.9803880453109741, avg_entr 0.02546834945678711
ep0_t0.7_test_time 0.2513003349304199
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9494416666666666 (113933/120000), AUC 0.9930391311645508
ep1_train_time 9.955246686935425
Test Epoch1 threshold 0.7 Acc 0.9144736842105263, AUC 0.9803476333618164, avg_entr 0.02626381628215313
ep1_t0.7_test_time 0.250443696975708
gc 0
Train Epoch2 Acc 0.9507916666666667 (114095/120000), AUC 0.9932751655578613
ep2_train_time 9.92179012298584
Test Epoch2 threshold 0.7 Acc 0.915296052631579, AUC 0.9802742004394531, avg_entr 0.025483526289463043
ep2_t0.7_test_time 0.25015830993652344
gc 0
Train Epoch3 Acc 0.9521166666666666 (114254/120000), AUC 0.9934186339378357
ep3_train_time 9.91049337387085
Test Epoch3 threshold 0.7 Acc 0.9116776315789473, AUC 0.9801720976829529, avg_entr 0.025277523323893547
ep3_t0.7_test_time 0.24903464317321777
gc 0
Train Epoch4 Acc 0.95345 (114414/120000), AUC 0.9938375949859619
ep4_train_time 9.943750619888306
Test Epoch4 threshold 0.7 Acc 0.9126644736842106, AUC 0.9800543785095215, avg_entr 0.025838106870651245
ep4_t0.7_test_time 0.24867987632751465
gc 0
Train Epoch5 Acc 0.9550833333333333 (114610/120000), AUC 0.9945468306541443
ep5_train_time 10.031944990158081
Test Epoch5 threshold 0.7 Acc 0.9133223684210526, AUC 0.9799489378929138, avg_entr 0.027207626029849052
ep5_t0.7_test_time 0.24967527389526367
gc 0
Train Epoch6 Acc 0.955575 (114669/120000), AUC 0.9947508573532104
ep6_train_time 10.040719747543335
Test Epoch6 threshold 0.7 Acc 0.9131578947368421, AUC 0.9798105955123901, avg_entr 0.02627740241587162
ep6_t0.7_test_time 0.24941253662109375
gc 0
Train Epoch7 Acc 0.9560333333333333 (114724/120000), AUC 0.9948548078536987
ep7_train_time 10.062817096710205
Test Epoch7 threshold 0.7 Acc 0.9113486842105263, AUC 0.97967129945755, avg_entr 0.02583673596382141
ep7_t0.7_test_time 0.25006580352783203
gc 0
Train Epoch8 Acc 0.9565333333333333 (114784/120000), AUC 0.9950277209281921
ep8_train_time 10.031497955322266
Test Epoch8 threshold 0.7 Acc 0.9121710526315789, AUC 0.9795846343040466, avg_entr 0.025872640311717987
ep8_t0.7_test_time 0.25016021728515625
gc 0
Train Epoch9 Acc 0.9575916666666666 (114911/120000), AUC 0.9952828288078308
ep9_train_time 10.081357479095459
Test Epoch9 threshold 0.7 Acc 0.9120065789473685, AUC 0.9795188903808594, avg_entr 0.02576012909412384
ep9_t0.7_test_time 0.24996018409729004
Best AUC 0.9803880453109741
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.7_m5//ag_news_linearal_l5_prefix.pt
[[329   7  18  14]
 [  0 388   4   1]
 [  5   4 366  25]
 [  3   1  35 320]]
Figure(640x480)
tensor([2.0181e-04, 3.0944e-03, 2.3331e-01,  ..., 9.8863e-02, 5.1349e-08,
        3.1340e-05])
[[329   7  18  14]
 [  0 388   4   1]
 [  5   4 368  23]
 [  3   1  34 321]]
Figure(640x480)
tensor([1.8339e-04, 1.1957e-03, 1.6534e-01,  ..., 8.7541e-02, 7.4842e-08,
        7.7457e-05])
[[331   7  16  14]
 [  0 388   4   1]
 [  5   4 366  25]
 [  3   1  33 322]]
Figure(640x480)
tensor([2.5123e-04, 8.3864e-04, 1.1262e-01,  ..., 4.5185e-02, 4.5449e-08,
        2.7882e-05])
[[330   7  17  14]
 [  0 388   4   1]
 [  5   4 367  24]
 [  3   1  34 321]]
Figure(640x480)
tensor([1.2318e-04, 4.4360e-04, 1.4393e-01,  ..., 1.1435e-02, 3.3210e-08,
        1.3861e-05])
[[330   7  16  15]
 [  0 388   4   1]
 [  5   4 366  25]
 [  3   1  34 321]]
Figure(640x480)
tensor([1.7526e-04, 4.8827e-04, 1.1994e-01,  ..., 1.5534e-02, 2.8738e-08,
        1.2223e-05])
