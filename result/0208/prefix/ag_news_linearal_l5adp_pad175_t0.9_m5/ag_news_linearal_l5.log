total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.9_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.91455 (109746/120000), AUC 0.9841726422309875
ep0_train_time 10.458799123764038
Test Epoch0 threshold 0.9 Acc 0.9144736842105263, AUC 0.9807909727096558, avg_entr 0.025527823716402054
ep0_t0.9_test_time 0.25196003913879395
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9484 (113808/120000), AUC 0.9924453496932983
ep1_train_time 10.003624439239502
Test Epoch1 threshold 0.9 Acc 0.9175986842105263, AUC 0.9806433320045471, avg_entr 0.025668257847428322
ep1_t0.9_test_time 0.2503981590270996
gc 0
Train Epoch2 Acc 0.9497416666666667 (113969/120000), AUC 0.992621898651123
ep2_train_time 10.320298910140991
Test Epoch2 threshold 0.9 Acc 0.9157894736842105, AUC 0.9805959463119507, avg_entr 0.02668984979391098
ep2_t0.9_test_time 0.2506859302520752
gc 0
Train Epoch3 Acc 0.951275 (114153/120000), AUC 0.9928287267684937
ep3_train_time 10.106602430343628
Test Epoch3 threshold 0.9 Acc 0.9157894736842105, AUC 0.9803118109703064, avg_entr 0.026366109028458595
ep3_t0.9_test_time 0.2500190734863281
gc 0
Train Epoch4 Acc 0.952075 (114249/120000), AUC 0.9933366775512695
ep4_train_time 10.067873001098633
Test Epoch4 threshold 0.9 Acc 0.9146381578947368, AUC 0.9801212549209595, avg_entr 0.025458145886659622
ep4_t0.9_test_time 0.25072193145751953
gc 0
Train Epoch5 Acc 0.9542916666666666 (114515/120000), AUC 0.9941450357437134
ep5_train_time 10.164016723632812
Test Epoch5 threshold 0.9 Acc 0.9154605263157894, AUC 0.9801478385925293, avg_entr 0.025372719392180443
ep5_t0.9_test_time 0.2512986660003662
gc 0
Train Epoch6 Acc 0.955175 (114621/120000), AUC 0.9943060278892517
ep6_train_time 10.082883358001709
Test Epoch6 threshold 0.9 Acc 0.9131578947368421, AUC 0.979968786239624, avg_entr 0.025939755141735077
ep6_t0.9_test_time 0.2505757808685303
gc 0
Train Epoch7 Acc 0.9552583333333333 (114631/120000), AUC 0.9944839477539062
ep7_train_time 10.01854395866394
Test Epoch7 threshold 0.9 Acc 0.912828947368421, AUC 0.9798335433006287, avg_entr 0.026033682748675346
ep7_t0.9_test_time 0.24989914894104004
gc 0
Train Epoch8 Acc 0.95595 (114714/120000), AUC 0.9946897029876709
ep8_train_time 9.905972957611084
Test Epoch8 threshold 0.9 Acc 0.9133223684210526, AUC 0.979770839214325, avg_entr 0.025926992297172546
ep8_t0.9_test_time 0.2500932216644287
gc 0
Train Epoch9 Acc 0.9567416666666667 (114809/120000), AUC 0.9949578642845154
ep9_train_time 10.037209272384644
Test Epoch9 threshold 0.9 Acc 0.9125, AUC 0.9797543287277222, avg_entr 0.025600135326385498
ep9_t0.9_test_time 0.24928808212280273
Best AUC 0.9807909727096558
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.9_m5//ag_news_linearal_l5_prefix.pt
[[331   6  18  13]
 [  0 388   4   1]
 [  5   4 366  25]
 [  3   1  35 320]]
Figure(640x480)
tensor([4.3732e-04, 4.2658e-03, 8.1065e-02,  ..., 7.2326e-02, 6.2366e-08,
        1.2885e-04])
[[332   6  18  12]
 [  0 388   4   1]
 [  5   4 368  23]
 [  3   1  36 319]]
Figure(640x480)
tensor([1.0031e-03, 1.0855e-02, 1.6856e-01,  ..., 2.7296e-02, 1.7873e-07,
        1.5432e-04])
[[335   5  16  12]
 [  0 388   4   1]
 [  5   5 366  24]
 [  3   1  35 320]]
Figure(640x480)
tensor([7.0208e-04, 9.2829e-03, 1.1134e-01,  ..., 1.1582e-02, 6.4152e-08,
        1.1046e-04])
[[335   5  16  12]
 [  0 388   4   1]
 [  5   5 366  24]
 [  3   1  36 319]]
Figure(640x480)
tensor([2.2429e-04, 1.7353e-03, 5.2748e-02,  ..., 2.9620e-03, 2.6334e-08,
        3.3532e-05])
[[335   5  16  12]
 [  0 388   4   1]
 [  6   5 365  24]
 [  3   1  36 319]]
Figure(640x480)
tensor([1.6710e-04, 1.4028e-03, 3.4539e-02,  ..., 5.7097e-03, 3.3491e-08,
        2.8599e-05])
