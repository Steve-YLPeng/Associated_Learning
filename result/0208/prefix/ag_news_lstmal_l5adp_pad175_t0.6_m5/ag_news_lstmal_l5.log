total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9324083333333333 (111889/120000), AUC 0.9857546091079712
ep0_train_time 88.31101131439209
Test Epoch0 threshold 0.6 Acc 0.9143092105263158, AUC 0.9803096652030945, avg_entr 0.025427384302020073
ep0_t0.6_test_time 0.2527148723602295
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.95705 (114846/120000), AUC 0.9934200048446655
ep1_train_time 88.3148365020752
Test Epoch1 threshold 0.6 Acc 0.9161184210526315, AUC 0.9802616238594055, avg_entr 0.026191849261522293
ep1_t0.6_test_time 0.25115346908569336
gc 0
Train Epoch2 Acc 0.95935 (115122/120000), AUC 0.9941115379333496
ep2_train_time 88.32723712921143
Test Epoch2 threshold 0.6 Acc 0.9149671052631579, AUC 0.9799909591674805, avg_entr 0.024826539680361748
ep2_t0.6_test_time 0.2509803771972656
gc 0
Train Epoch3 Acc 0.9616416666666666 (115397/120000), AUC 0.9946251511573792
ep3_train_time 88.2549135684967
Test Epoch3 threshold 0.6 Acc 0.9143092105263158, AUC 0.9798583984375, avg_entr 0.026044592261314392
ep3_t0.6_test_time 0.25142335891723633
gc 0
Train Epoch4 Acc 0.96395 (115674/120000), AUC 0.994981050491333
ep4_train_time 88.40305709838867
Test Epoch4 threshold 0.6 Acc 0.9139802631578947, AUC 0.979711651802063, avg_entr 0.025901345536112785
ep4_t0.6_test_time 0.25423693656921387
gc 0
Train Epoch5 Acc 0.9673666666666667 (116084/120000), AUC 0.9955803751945496
ep5_train_time 88.26955533027649
Test Epoch5 threshold 0.6 Acc 0.9138157894736842, AUC 0.97971111536026, avg_entr 0.025728650391101837
ep5_t0.6_test_time 0.2505471706390381
gc 0
Train Epoch6 Acc 0.9684 (116208/120000), AUC 0.9956783056259155
ep6_train_time 88.45905184745789
Test Epoch6 threshold 0.6 Acc 0.912828947368421, AUC 0.979575514793396, avg_entr 0.026493331417441368
ep6_t0.6_test_time 0.25075554847717285
gc 0
Train Epoch7 Acc 0.969525 (116343/120000), AUC 0.9957374334335327
ep7_train_time 88.4512984752655
Test Epoch7 threshold 0.6 Acc 0.9134868421052632, AUC 0.9794738292694092, avg_entr 0.025820357725024223
ep7_t0.6_test_time 0.253645658493042
gc 0
Train Epoch8 Acc 0.9706833333333333 (116482/120000), AUC 0.9956738948822021
ep8_train_time 88.42577314376831
Test Epoch8 threshold 0.6 Acc 0.912828947368421, AUC 0.9794028997421265, avg_entr 0.026413224637508392
ep8_t0.6_test_time 0.2507655620574951
gc 0
Train Epoch9 Acc 0.9725666666666667 (116708/120000), AUC 0.9959682822227478
ep9_train_time 88.35689902305603
Test Epoch9 threshold 0.6 Acc 0.9118421052631579, AUC 0.9793030619621277, avg_entr 0.02602819912135601
ep9_t0.6_test_time 0.2512326240539551
Best AUC 0.9803096652030945
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m5//ag_news_lstmal_l5_prefix.pt
[[329   7  17  15]
 [  0 388   4   1]
 [  6   4 365  25]
 [  4   1  32 322]]
Figure(640x480)
tensor([1.1378e-04, 4.3457e-03, 1.5826e-01,  ..., 2.8744e-02, 7.2247e-08,
        2.3517e-04])
[[336   5  12  15]
 [  1 387   4   1]
 [  6   3 362  29]
 [  6   1  27 325]]
Figure(640x480)
tensor([3.3137e-07, 1.1763e-05, 8.7939e-05,  ..., 2.0918e-07, 6.2854e-08,
        6.9781e-07])
[[335   5  13  15]
 [  1 387   4   1]
 [  6   3 363  28]
 [  6   1  27 325]]
Figure(640x480)
tensor([2.1059e-07, 6.1899e-06, 4.3090e-05,  ..., 2.0480e-07, 5.9000e-08,
        3.9582e-07])
[[337   5  12  14]
 [  1 388   4   0]
 [  7   3 362  28]
 [  8   0  28 323]]
Figure(640x480)
tensor([3.4552e-07, 1.4163e-05, 1.3219e-04,  ..., 2.3288e-07, 3.2697e-07,
        3.9420e-07])
[[337   5  12  14]
 [  1 388   4   0]
 [  7   2 362  29]
 [  8   0  27 324]]
Figure(640x480)
tensor([6.1824e-07, 7.5968e-06, 1.6165e-05,  ..., 2.7398e-07, 2.7197e-07,
        2.6782e-07])
