total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.37101666666666666 (44522/120000), AUC 0.5848538875579834
ep0_train_time 46.958701848983765
Test Epoch0 threshold 0.9 Acc 0.9021381578947368, AUC 0.9742815494537354, avg_entr 0.18150699138641357
ep0_t0.9_test_time 0.25025320053100586
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m1//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.434425 (52131/120000), AUC 0.6237066388130188
ep1_train_time 47.03783583641052
Test Epoch1 threshold 0.9 Acc 0.9111842105263158, AUC 0.9781213998794556, avg_entr 0.1067337617278099
ep1_t0.9_test_time 0.2503387928009033
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m1//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.43895 (52674/120000), AUC 0.6267542839050293
ep2_train_time 47.06717014312744
Test Epoch2 threshold 0.9 Acc 0.9129934210526316, AUC 0.9796150922775269, avg_entr 0.07919886708259583
ep2_t0.9_test_time 0.249983549118042
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m1//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.438675 (52641/120000), AUC 0.6276810169219971
ep3_train_time 47.146331787109375
Test Epoch3 threshold 0.9 Acc 0.9149671052631579, AUC 0.9801805019378662, avg_entr 0.06777793914079666
ep3_t0.9_test_time 0.2485675811767578
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m1//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.437075 (52449/120000), AUC 0.6273736357688904
ep4_train_time 47.09951329231262
Test Epoch4 threshold 0.9 Acc 0.9174342105263158, AUC 0.9808260202407837, avg_entr 0.05881523713469505
ep4_t0.9_test_time 0.24855709075927734
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m1//ag_news_lstmal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.43521666666666664 (52226/120000), AUC 0.6271172165870667
ep5_train_time 47.11311721801758
Test Epoch5 threshold 0.9 Acc 0.9161184210526315, AUC 0.9808201789855957, avg_entr 0.05352179706096649
ep5_t0.9_test_time 0.24965524673461914
gc 0
Train Epoch6 Acc 0.4328 (51936/120000), AUC 0.6265151500701904
ep6_train_time 47.12007451057434
Test Epoch6 threshold 0.9 Acc 0.9115131578947369, AUC 0.9808460474014282, avg_entr 0.050752557814121246
ep6_t0.9_test_time 0.24970650672912598
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m1//ag_news_lstmal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.4311333333333333 (51736/120000), AUC 0.6255843043327332
ep7_train_time 47.26960206031799
Test Epoch7 threshold 0.9 Acc 0.9171052631578948, AUC 0.980931282043457, avg_entr 0.04467962682247162
ep7_t0.9_test_time 0.2520618438720703
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m1//ag_news_lstmal_l5_prefix.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.42846666666666666 (51416/120000), AUC 0.6249401569366455
ep8_train_time 47.163371562957764
Test Epoch8 threshold 0.9 Acc 0.9154605263157894, AUC 0.9808022975921631, avg_entr 0.043061867356300354
ep8_t0.9_test_time 0.2493906021118164
gc 0
Train Epoch9 Acc 0.425375 (51045/120000), AUC 0.6240924596786499
ep9_train_time 47.08362865447998
Test Epoch9 threshold 0.9 Acc 0.915625, AUC 0.9805247783660889, avg_entr 0.03991368040442467
ep9_t0.9_test_time 0.2496025562286377
Best AUC 0.980931282043457
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m1//ag_news_lstmal_l5_prefix.pt
[[328   7  16  17]
 [  0 389   3   1]
 [  5   6 352  37]
 [  3   1  24 331]]
Figure(640x480)
tensor([0.0138, 0.0468, 0.0824,  ..., 0.0301, 0.0004, 0.0151])
[[117 167  64  20]
 [ 55 197 120  21]
 [ 30 157 127  86]
 [ 59  74 178  48]]
Figure(640x480)
tensor([1.4498, 1.3529, 1.1433,  ..., 1.3882, 1.3543, 1.3550])
[[  5  29 331   3]
 [  7  42 315  29]
 [  4  17 370   9]
 [  2  31 322   4]]
Figure(640x480)
tensor([1.1794, 1.2159, 1.3333,  ..., 1.2485, 1.3347, 1.2959])
[[  0 279  26  63]
 [  0 290  32  71]
 [  0 380   2  18]
 [  0 340   1  18]]
Figure(640x480)
tensor([1.2586, 1.1657, 1.2478,  ..., 1.2227, 1.2837, 1.2845])
[[ 59 102  52 155]
 [ 49 282   5  57]
 [ 36 157   3 204]
 [ 16  41  24 278]]
Figure(640x480)
tensor([1.4383, 1.4401, 1.4258,  ..., 1.4407, 1.4288, 1.4134])
