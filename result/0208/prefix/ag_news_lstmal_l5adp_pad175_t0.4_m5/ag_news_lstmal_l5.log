total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9249333333333334 (110992/120000), AUC 0.984099268913269
ep0_train_time 88.32601404190063
Test Epoch0 threshold 0.4 Acc 0.9159539473684211, AUC 0.980266809463501, avg_entr 0.024205759167671204
ep0_t0.4_test_time 0.29920053482055664
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9571416666666667 (114857/120000), AUC 0.9918709993362427
ep1_train_time 88.39587616920471
Test Epoch1 threshold 0.4 Acc 0.9157894736842105, AUC 0.9802215099334717, avg_entr 0.024281049147248268
ep1_t0.4_test_time 0.3022637367248535
gc 0
Train Epoch2 Acc 0.9595 (115140/120000), AUC 0.9926503300666809
ep2_train_time 88.37492179870605
Test Epoch2 threshold 0.4 Acc 0.9157894736842105, AUC 0.9801004528999329, avg_entr 0.025186192244291306
ep2_t0.4_test_time 0.28839921951293945
gc 0
Train Epoch3 Acc 0.9618916666666667 (115427/120000), AUC 0.9931192398071289
ep3_train_time 88.33638048171997
Test Epoch3 threshold 0.4 Acc 0.9129934210526316, AUC 0.9800055623054504, avg_entr 0.024866387248039246
ep3_t0.4_test_time 0.29703688621520996
gc 0
Train Epoch4 Acc 0.964 (115680/120000), AUC 0.9935942888259888
ep4_train_time 88.29923748970032
Test Epoch4 threshold 0.4 Acc 0.9144736842105263, AUC 0.9798409938812256, avg_entr 0.02411377616226673
ep4_t0.4_test_time 0.29380226135253906
gc 0
Train Epoch5 Acc 0.9674333333333334 (116092/120000), AUC 0.9943945407867432
ep5_train_time 88.45354151725769
Test Epoch5 threshold 0.4 Acc 0.9134868421052632, AUC 0.9797421097755432, avg_entr 0.024606067687273026
ep5_t0.4_test_time 0.2884094715118408
gc 0
Train Epoch6 Acc 0.9685916666666666 (116231/120000), AUC 0.994519054889679
ep6_train_time 88.29567456245422
Test Epoch6 threshold 0.4 Acc 0.9138157894736842, AUC 0.9795548915863037, avg_entr 0.024625005200505257
ep6_t0.4_test_time 0.29147958755493164
gc 0
Train Epoch7 Acc 0.9695 (116340/120000), AUC 0.9947523474693298
ep7_train_time 88.43237447738647
Test Epoch7 threshold 0.4 Acc 0.9136513157894737, AUC 0.979365885257721, avg_entr 0.024099089205265045
ep7_t0.4_test_time 0.29529285430908203
gc 0
Train Epoch8 Acc 0.97095 (116514/120000), AUC 0.9948968291282654
ep8_train_time 88.32838225364685
Test Epoch8 threshold 0.4 Acc 0.9136513157894737, AUC 0.9793652892112732, avg_entr 0.024716826155781746
ep8_t0.4_test_time 0.3029592037200928
gc 0
Train Epoch9 Acc 0.9725416666666666 (116705/120000), AUC 0.9952681064605713
ep9_train_time 88.52377367019653
Test Epoch9 threshold 0.4 Acc 0.9134868421052632, AUC 0.9793254733085632, avg_entr 0.024943072348833084
ep9_t0.4_test_time 0.29892444610595703
Best AUC 0.980266809463501
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m5//ag_news_lstmal_l5_prefix.pt
[[1380   52   67   33]
 [  16 1476    6    9]
 [  37   14 1327  122]
 [  38   13  107 1383]]
Figure(640x480)
tensor([3.5076e-03, 8.5566e-08, 1.0100e-04,  ..., 2.1163e-08, 1.2475e-06,
        1.6286e-04])
[[1374   44   60   54]
 [  28 1457   10   12]
 [  41    8 1320  131]
 [  34   10   96 1401]]
Figure(640x480)
tensor([5.5831e-07, 6.1021e-08, 2.0212e-07,  ..., 1.9183e-07, 2.1714e-07,
        3.9362e-07])
[[1375   42   58   57]
 [  26 1458   11   12]
 [  43    9 1313  135]
 [  31   10   98 1402]]
Figure(640x480)
tensor([5.3869e-07, 1.9569e-07, 3.3430e-07,  ..., 1.8835e-07, 2.0341e-07,
        3.7349e-07])
[[1378   42   54   58]
 [  28 1455   12   12]
 [  46    9 1305  140]
 [  32   10   96 1403]]
Figure(640x480)
tensor([1.5516e-06, 3.0030e-07, 4.2497e-07,  ..., 1.7377e-07, 3.6512e-07,
        6.2504e-07])
[[1374   44   55   59]
 [  32 1452   11   12]
 [  45    9 1302  144]
 [  32   10   95 1404]]
Figure(640x480)
tensor([9.0049e-07, 6.3628e-07, 7.1299e-07,  ..., 3.9506e-07, 4.7923e-07,
        4.7770e-07])
