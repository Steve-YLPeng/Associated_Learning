total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.03596666666666667 (4316/120000), AUC 0.40344929695129395
ep0_train_time 9.677005767822266
Test Epoch0 threshold 0.9 Acc 0.9174342105263158, AUC 0.9810006618499756, avg_entr 0.025953251868486404
ep0_t0.9_test_time 0.2552475929260254
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.02015 (2418/120000), AUC 0.41846686601638794
ep1_train_time 9.15012788772583
Test Epoch1 threshold 0.9 Acc 0.9172697368421052, AUC 0.9807997345924377, avg_entr 0.025345686823129654
ep1_t0.9_test_time 0.2534961700439453
gc 0
Train Epoch2 Acc 0.020016666666666665 (2402/120000), AUC 0.4172859787940979
ep2_train_time 9.162791967391968
Test Epoch2 threshold 0.9 Acc 0.915625, AUC 0.9807416200637817, avg_entr 0.025570016354322433
ep2_t0.9_test_time 0.2525637149810791
gc 0
Train Epoch3 Acc 0.026275 (3153/120000), AUC 0.42194533348083496
ep3_train_time 9.127893924713135
Test Epoch3 threshold 0.9 Acc 0.9166118421052631, AUC 0.9805673360824585, avg_entr 0.025404848158359528
ep3_t0.9_test_time 0.2529613971710205
gc 0
Train Epoch4 Acc 0.041475 (4977/120000), AUC 0.4443674683570862
ep4_train_time 9.199657917022705
Test Epoch4 threshold 0.9 Acc 0.9148026315789474, AUC 0.9804516434669495, avg_entr 0.025980588048696518
ep4_t0.9_test_time 0.25226402282714844
gc 0
Train Epoch5 Acc 0.06799166666666667 (8159/120000), AUC 0.4705865979194641
ep5_train_time 9.17328143119812
Test Epoch5 threshold 0.9 Acc 0.9162828947368421, AUC 0.9804137945175171, avg_entr 0.025863410905003548
ep5_t0.9_test_time 0.2536904811859131
gc 0
Train Epoch6 Acc 0.0951 (11412/120000), AUC 0.4842550754547119
ep6_train_time 9.197304964065552
Test Epoch6 threshold 0.9 Acc 0.9141447368421053, AUC 0.9802044034004211, avg_entr 0.025946587324142456
ep6_t0.9_test_time 0.2524256706237793
gc 0
Train Epoch7 Acc 0.12389166666666666 (14867/120000), AUC 0.4921603798866272
ep7_train_time 9.194973945617676
Test Epoch7 threshold 0.9 Acc 0.9133223684210526, AUC 0.9801297187805176, avg_entr 0.026337074115872383
ep7_t0.9_test_time 0.25432658195495605
gc 0
Train Epoch8 Acc 0.14661666666666667 (17594/120000), AUC 0.4982289671897888
ep8_train_time 9.090685367584229
Test Epoch8 threshold 0.9 Acc 0.9139802631578947, AUC 0.9800521731376648, avg_entr 0.025836773216724396
ep8_t0.9_test_time 0.25392651557922363
gc 0
Train Epoch9 Acc 0.16180833333333333 (19417/120000), AUC 0.5047861337661743
ep9_train_time 9.170922994613647
Test Epoch9 threshold 0.9 Acc 0.9144736842105263, AUC 0.9800457954406738, avg_entr 0.025982121005654335
ep9_t0.9_test_time 0.25427937507629395
Best AUC 0.9810006618499756
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.9_m3//ag_news_linearal_l5_prefix.pt
[[333   6  14  15]
 [  0 389   3   1]
 [  7   6 349  38]
 [  5   1  21 332]]
Figure(640x480)
tensor([8.3469e-05, 6.4063e-04, 7.6086e-03,  ..., 5.7588e-02, 2.8366e-07,
        5.4956e-03])
[[333   6  14  15]
 [  0 389   3   1]
 [  5   6 353  36]
 [  5   0  23 331]]
Figure(640x480)
tensor([2.8916e-04, 1.8693e-03, 2.0448e-02,  ..., 2.1084e-02, 5.5089e-07,
        8.7372e-03])
[[334   6  13  15]
 [  0 389   3   1]
 [  6   6 352  36]
 [  5   0  23 331]]
Figure(640x480)
tensor([3.0939e-04, 2.1319e-03, 1.8895e-02,  ..., 1.8001e-02, 3.8513e-07,
        1.4241e-02])
[[  1 367   0   0]
 [  0 393   0   0]
 [ 46 354   0   0]
 [189 170   0   0]]
Figure(640x480)
tensor([0.7606, 0.8204, 0.7130,  ..., 0.9089, 0.9216, 0.8810])
[[  2  10 356   0]
 [  0   4 389   0]
 [ 70 284  46   0]
 [  0  42 317   0]]
Figure(640x480)
tensor([1.0009, 1.0501, 1.0692,  ..., 0.9670, 0.7454, 0.9719])
