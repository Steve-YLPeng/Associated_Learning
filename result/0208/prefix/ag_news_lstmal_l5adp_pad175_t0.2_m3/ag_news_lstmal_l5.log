total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.209075 (25089/120000), AUC 0.3094502091407776
ep0_train_time 67.0093104839325
Test Epoch0 threshold 0.2 Acc 0.9149671052631579, AUC 0.9795116186141968, avg_entr 0.01272959541529417
ep0_t0.2_test_time 0.43964648246765137
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24499166666666666 (29399/120000), AUC 0.2611544132232666
ep1_train_time 66.91996932029724
Test Epoch1 threshold 0.2 Acc 0.9148026315789474, AUC 0.9800851345062256, avg_entr 0.012877156026661396
ep1_t0.2_test_time 0.42982935905456543
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m3//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.242925 (29151/120000), AUC 0.2542847990989685
ep2_train_time 66.74713516235352
Test Epoch2 threshold 0.2 Acc 0.915625, AUC 0.9798194766044617, avg_entr 0.013030004687607288
ep2_t0.2_test_time 0.43683862686157227
gc 0
Train Epoch3 Acc 0.23438333333333333 (28126/120000), AUC 0.2522493898868561
ep3_train_time 66.80852484703064
Test Epoch3 threshold 0.2 Acc 0.915625, AUC 0.9793308973312378, avg_entr 0.01290078368037939
ep3_t0.2_test_time 0.43615078926086426
gc 0
Train Epoch4 Acc 0.19816666666666666 (23780/120000), AUC 0.2517920136451721
ep4_train_time 66.96234178543091
Test Epoch4 threshold 0.2 Acc 0.9108552631578948, AUC 0.9788113832473755, avg_entr 0.013374052941799164
ep4_t0.2_test_time 0.44212770462036133
gc 0
Train Epoch5 Acc 0.18076666666666666 (21692/120000), AUC 0.25208213925361633
ep5_train_time 66.8691611289978
Test Epoch5 threshold 0.2 Acc 0.9126644736842106, AUC 0.9786337614059448, avg_entr 0.013456749729812145
ep5_t0.2_test_time 0.4321787357330322
gc 0
Train Epoch6 Acc 0.1608 (19296/120000), AUC 0.2540974020957947
ep6_train_time 66.92739963531494
Test Epoch6 threshold 0.2 Acc 0.9136513157894737, AUC 0.9782737493515015, avg_entr 0.01331154815852642
ep6_t0.2_test_time 0.44508886337280273
gc 0
Train Epoch7 Acc 0.1686 (20232/120000), AUC 0.25805941224098206
ep7_train_time 66.91782736778259
Test Epoch7 threshold 0.2 Acc 0.9134868421052632, AUC 0.9781354665756226, avg_entr 0.012895935215055943
ep7_t0.2_test_time 0.43470239639282227
gc 0
Train Epoch8 Acc 0.16025833333333334 (19231/120000), AUC 0.26168206334114075
ep8_train_time 66.87395691871643
Test Epoch8 threshold 0.2 Acc 0.9138157894736842, AUC 0.9779183864593506, avg_entr 0.013354036957025528
ep8_t0.2_test_time 0.442950963973999
gc 0
Train Epoch9 Acc 0.16845 (20214/120000), AUC 0.2655790448188782
ep9_train_time 66.87046241760254
Test Epoch9 threshold 0.2 Acc 0.9123355263157895, AUC 0.9777473211288452, avg_entr 0.012767444364726543
ep9_t0.2_test_time 0.4401969909667969
Best AUC 0.9800851345062256
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.2_m3//ag_news_lstmal_l5_prefix.pt
[[1370   51   75   36]
 [  11 1477    7   12]
 [  35   13 1329  123]
 [  35   13   93 1400]]
Figure(640x480)
tensor([9.3985e-04, 1.1396e-07, 4.0792e-04,  ..., 5.4825e-08, 1.0965e-06,
        2.0924e-04])
[[1390   47   54   41]
 [  20 1469    9    9]
 [  50   10 1320  120]
 [  44   15  105 1377]]
Figure(640x480)
tensor([9.3763e-06, 3.8503e-07, 8.8593e-07,  ..., 1.1082e-07, 5.5740e-07,
        1.0141e-06])
[[1391   47   53   41]
 [  19 1468   11    9]
 [  49   10 1323  118]
 [  44   16  109 1372]]
Figure(640x480)
tensor([4.1878e-06, 4.3400e-07, 2.3411e-06,  ..., 1.1590e-07, 9.1745e-07,
        8.5996e-07])
[[   0   18   15 1499]
 [   0  786    1  720]
 [   0    0    1 1499]
 [   0    1    0 1540]]
Figure(640x480)
tensor([1.2145, 0.7973, 0.9146,  ..., 1.0820, 0.9269, 1.1585])
[[1489    0    0   43]
 [ 111    0    0 1396]
 [1497    0    0    3]
 [1537    0    0    4]]
Figure(640x480)
tensor([0.7126, 0.7201, 0.7414,  ..., 0.9942, 0.7368, 0.6139])
