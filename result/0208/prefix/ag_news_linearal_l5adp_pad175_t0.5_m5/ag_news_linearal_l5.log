total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.5_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9118333333333334 (109420/120000), AUC 0.9852088689804077
ep0_train_time 10.306176900863647
Test Epoch0 threshold 0.5 Acc 0.9157894736842105, AUC 0.9803953766822815, avg_entr 0.0257107000797987
ep0_t0.5_test_time 0.2510862350463867
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9492166666666667 (113906/120000), AUC 0.9930843114852905
ep1_train_time 10.101787567138672
Test Epoch1 threshold 0.5 Acc 0.9154605263157894, AUC 0.9803628325462341, avg_entr 0.025999559089541435
ep1_t0.5_test_time 0.24921417236328125
gc 0
Train Epoch2 Acc 0.9505166666666667 (114062/120000), AUC 0.9933942556381226
ep2_train_time 9.92068338394165
Test Epoch2 threshold 0.5 Acc 0.9151315789473684, AUC 0.9801317453384399, avg_entr 0.025372250005602837
ep2_t0.5_test_time 0.2502932548522949
gc 0
Train Epoch3 Acc 0.9516583333333334 (114199/120000), AUC 0.9934532642364502
ep3_train_time 9.960977792739868
Test Epoch3 threshold 0.5 Acc 0.9139802631578947, AUC 0.9799885749816895, avg_entr 0.025418702512979507
ep3_t0.5_test_time 0.24883151054382324
gc 0
Train Epoch4 Acc 0.9520666666666666 (114248/120000), AUC 0.9937593936920166
ep4_train_time 9.923961639404297
Test Epoch4 threshold 0.5 Acc 0.9141447368421053, AUC 0.9797536730766296, avg_entr 0.025686033070087433
ep4_t0.5_test_time 0.2490406036376953
gc 0
Train Epoch5 Acc 0.954525 (114543/120000), AUC 0.9944165945053101
ep5_train_time 9.878383874893188
Test Epoch5 threshold 0.5 Acc 0.9126644736842106, AUC 0.9796489477157593, avg_entr 0.02631714753806591
ep5_t0.5_test_time 0.24916434288024902
gc 0
Train Epoch6 Acc 0.9550833333333333 (114610/120000), AUC 0.994591474533081
ep6_train_time 9.86890435218811
Test Epoch6 threshold 0.5 Acc 0.9121710526315789, AUC 0.9795479774475098, avg_entr 0.02587859518826008
ep6_t0.5_test_time 0.25030040740966797
gc 0
Train Epoch7 Acc 0.9558583333333334 (114703/120000), AUC 0.9946908950805664
ep7_train_time 10.110432624816895
Test Epoch7 threshold 0.5 Acc 0.912828947368421, AUC 0.9795705080032349, avg_entr 0.025921950116753578
ep7_t0.5_test_time 0.24891018867492676
gc 0
Train Epoch8 Acc 0.9555916666666666 (114671/120000), AUC 0.994878888130188
ep8_train_time 9.877289056777954
Test Epoch8 threshold 0.5 Acc 0.9115131578947369, AUC 0.9793440103530884, avg_entr 0.025431735441088676
ep8_t0.5_test_time 0.24911212921142578
gc 0
Train Epoch9 Acc 0.9568583333333334 (114823/120000), AUC 0.9951049089431763
ep9_train_time 9.826681852340698
Test Epoch9 threshold 0.5 Acc 0.9115131578947369, AUC 0.9793172478675842, avg_entr 0.02583136595785618
ep9_t0.5_test_time 0.24862337112426758
Best AUC 0.9803953766822815
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.5_m5//ag_news_linearal_l5_prefix.pt
[[1376   51   73   32]
 [  12 1477    9    9]
 [  38   13 1329  120]
 [  40   14  101 1386]]
Figure(640x480)
tensor([3.4978e-03, 3.6996e-08, 1.3952e-04,  ..., 2.4879e-08, 5.1069e-06,
        1.4881e-04])
[[1372   52   73   35]
 [  12 1480    7    8]
 [  36   17 1329  118]
 [  40   17  101 1383]]
Figure(640x480)
tensor([1.3814e-03, 3.1669e-07, 1.4004e-04,  ..., 3.4673e-08, 6.9403e-06,
        3.0476e-04])
[[1380   51   68   33]
 [  13 1480    6    8]
 [  37   17 1323  123]
 [  40   16   95 1390]]
Figure(640x480)
tensor([1.1821e-03, 1.3293e-07, 7.4926e-05,  ..., 2.7649e-08, 1.9814e-06,
        2.5345e-04])
[[1383   51   63   35]
 [  13 1478    7    9]
 [  39   18 1320  123]
 [  40   14   96 1391]]
Figure(640x480)
tensor([8.7879e-04, 5.6657e-08, 1.6614e-05,  ..., 2.7720e-08, 1.1624e-06,
        3.9220e-05])
[[1384   51   63   34]
 [  16 1477    7    7]
 [  39   17 1323  121]
 [  41   14   99 1387]]
Figure(640x480)
tensor([3.6344e-04, 4.5950e-08, 1.7991e-05,  ..., 2.8185e-08, 1.4538e-06,
        2.4686e-05])
