total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.21076666666666666 (25292/120000), AUC 0.4150387644767761
ep0_train_time 9.508444786071777
Test Epoch0 threshold 0.1 Acc 0.9141447368421053, AUC 0.9806925058364868, avg_entr 0.024048399180173874
ep0_t0.1_test_time 0.2701385021209717
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.15155 (18186/120000), AUC 0.4007609486579895
ep1_train_time 9.108624935150146
Test Epoch1 threshold 0.1 Acc 0.9161184210526315, AUC 0.9803561568260193, avg_entr 0.02525598369538784
ep1_t0.1_test_time 0.26942014694213867
gc 0
Train Epoch2 Acc 0.09235833333333333 (11083/120000), AUC 0.41408610343933105
ep2_train_time 9.070504903793335
Test Epoch2 threshold 0.1 Acc 0.9164473684210527, AUC 0.9803783297538757, avg_entr 0.02437431365251541
ep2_t0.1_test_time 0.27002573013305664
gc 0
Train Epoch3 Acc 0.059583333333333335 (7150/120000), AUC 0.4238450527191162
ep3_train_time 9.02561330795288
Test Epoch3 threshold 0.1 Acc 0.915625, AUC 0.980126142501831, avg_entr 0.024051649495959282
ep3_t0.1_test_time 0.2691507339477539
gc 0
Train Epoch4 Acc 0.039433333333333334 (4732/120000), AUC 0.4336093068122864
ep4_train_time 9.010573625564575
Test Epoch4 threshold 0.1 Acc 0.9129934210526316, AUC 0.980033278465271, avg_entr 0.02382148616015911
ep4_t0.1_test_time 0.2688443660736084
gc 0
Train Epoch5 Acc 0.033183333333333336 (3982/120000), AUC 0.44831106066703796
ep5_train_time 9.089180946350098
Test Epoch5 threshold 0.1 Acc 0.9143092105263158, AUC 0.9799762964248657, avg_entr 0.02228671684861183
ep5_t0.1_test_time 0.26874351501464844
gc 0
Train Epoch6 Acc 0.059325 (7119/120000), AUC 0.46700647473335266
ep6_train_time 9.108792066574097
Test Epoch6 threshold 0.1 Acc 0.9146381578947368, AUC 0.9798358678817749, avg_entr 0.021577760577201843
ep6_t0.1_test_time 0.2683711051940918
gc 0
Train Epoch7 Acc 0.14485 (17382/120000), AUC 0.4965820908546448
ep7_train_time 9.03251338005066
Test Epoch7 threshold 0.1 Acc 0.9121710526315789, AUC 0.9798552989959717, avg_entr 0.021043840795755386
ep7_t0.1_test_time 0.2699570655822754
gc 0
Train Epoch8 Acc 0.221425 (26571/120000), AUC 0.536737322807312
ep8_train_time 9.057094097137451
Test Epoch8 threshold 0.1 Acc 0.9129934210526316, AUC 0.9797569513320923, avg_entr 0.020248595625162125
ep8_t0.1_test_time 0.26938772201538086
gc 0
Train Epoch9 Acc 0.24096666666666666 (28916/120000), AUC 0.5703397393226624
ep9_train_time 9.010211706161499
Test Epoch9 threshold 0.1 Acc 0.9131578947368421, AUC 0.979599118232727, avg_entr 0.019630299881100655
ep9_t0.1_test_time 0.2694053649902344
Best AUC 0.9806925058364868
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.1_m3//ag_news_linearal_l5_prefix.pt
[[1361   54   80   37]
 [   9 1480    9    9]
 [  31   13 1341  115]
 [  34   13  113 1381]]
Figure(640x480)
tensor([5.6443e-04, 2.8430e-07, 2.0384e-04,  ..., 9.0584e-08, 8.2109e-06,
        9.9761e-05])
[[1370   53   77   32]
 [  11 1480    7    9]
 [  35   14 1337  114]
 [  36   16  115 1374]]
Figure(640x480)
tensor([4.2523e-04, 2.8315e-06, 1.9884e-04,  ..., 1.6428e-07, 1.4999e-05,
        1.3599e-04])
[[1370   51   76   35]
 [  12 1480    7    8]
 [  35   14 1339  112]
 [  33   16  115 1377]]
Figure(640x480)
tensor([4.2297e-04, 1.2592e-06, 3.0512e-04,  ..., 1.4989e-07, 2.0649e-05,
        1.3717e-04])
[[   2    0 1530    0]
 [  24    0 1483    0]
 [   0    0 1500    0]
 [   0    0 1541    0]]
Figure(640x480)
tensor([0.5313, 0.2991, 0.4742,  ..., 0.4837, 0.4428, 0.4969])
[[   5    0 1527    0]
 [   0    0 1507    0]
 [ 468    0 1032    0]
 [   4    0 1537    0]]
Figure(640x480)
tensor([0.5626, 0.4676, 0.5657,  ..., 1.0659, 0.5135, 0.4051])
