total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.45557233691215515
ep0_train_time 8.409431457519531
Test Epoch0 threshold 0.5 Acc 0.9004934210526315, AUC 0.973729133605957, avg_entr 0.18151631951332092
ep0_t0.5_test_time 0.2502739429473877
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.39768439531326294
ep1_train_time 8.057332992553711
Test Epoch1 threshold 0.5 Acc 0.9098684210526315, AUC 0.9776977896690369, avg_entr 0.1056213453412056
ep1_t0.5_test_time 0.2492680549621582
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.3889971077442169
ep2_train_time 7.956592321395874
Test Epoch2 threshold 0.5 Acc 0.915625, AUC 0.979269802570343, avg_entr 0.07886043190956116
ep2_t0.5_test_time 0.24816560745239258
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.38726040720939636
ep3_train_time 8.112247705459595
Test Epoch3 threshold 0.5 Acc 0.9149671052631579, AUC 0.9800053834915161, avg_entr 0.06831176578998566
ep3_t0.5_test_time 0.24851393699645996
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.3865918517112732
ep4_train_time 8.016705751419067
Test Epoch4 threshold 0.5 Acc 0.9164473684210527, AUC 0.9803467392921448, avg_entr 0.06065751239657402
ep4_t0.5_test_time 0.2485501766204834
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.3856528401374817
ep5_train_time 8.041369915008545
Test Epoch5 threshold 0.5 Acc 0.915296052631579, AUC 0.98055100440979, avg_entr 0.05331508815288544
ep5_t0.5_test_time 0.24992990493774414
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.38514232635498047
ep6_train_time 8.177359819412231
Test Epoch6 threshold 0.5 Acc 0.915296052631579, AUC 0.9807165861129761, avg_entr 0.04961428791284561
ep6_t0.5_test_time 0.24885892868041992
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.38417044281959534
ep7_train_time 7.876408815383911
Test Epoch7 threshold 0.5 Acc 0.9144736842105263, AUC 0.9805288314819336, avg_entr 0.045403677970170975
ep7_t0.5_test_time 0.24922800064086914
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.3834390640258789
ep8_train_time 7.990266561508179
Test Epoch8 threshold 0.5 Acc 0.9162828947368421, AUC 0.9804743528366089, avg_entr 0.04358355700969696
ep8_t0.5_test_time 0.24804997444152832
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.38260096311569214
ep9_train_time 7.9346702098846436
Test Epoch9 threshold 0.5 Acc 0.915296052631579, AUC 0.9801893830299377, avg_entr 0.04024697467684746
ep9_t0.5_test_time 0.24819040298461914
Best AUC 0.9807165861129761
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt
[[1360   53   81   38]
 [   8 1479    9   11]
 [  33   13 1336  118]
 [  34   14  103 1390]]
Figure(640x480)
tensor([0.0289, 0.0004, 0.0120,  ..., 0.0004, 0.0030, 0.0306])
[[   0 1532    0    0]
 [   0 1507    0    0]
 [   0 1500    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([1.0312, 1.0592, 1.0700,  ..., 1.0676, 1.0780, 1.0856])
[[1528    0    0    4]
 [1507    0    0    0]
 [1500    0    0    0]
 [1532    0    0    9]]
Figure(640x480)
tensor([1.1611, 1.1956, 1.1912,  ..., 1.1595, 1.1940, 1.2024])
[[1532    0    0    0]
 [1507    0    0    0]
 [1500    0    0    0]
 [1541    0    0    0]]
Figure(640x480)
tensor([0.9268, 0.9804, 0.9769,  ..., 0.9445, 0.9649, 0.9991])
[[   0    0    0 1532]
 [   0    0    0 1507]
 [   0    0    0 1500]
 [   0    0    0 1541]]
Figure(640x480)
tensor([1.2744, 1.3049, 1.2888,  ..., 1.2707, 1.2938, 1.3001])
