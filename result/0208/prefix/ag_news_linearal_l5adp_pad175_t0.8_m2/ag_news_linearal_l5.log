total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.24974166666666667 (29969/120000), AUC 0.6177079677581787
ep0_train_time 9.08610725402832
Test Epoch0 threshold 0.8 Acc 0.9161184210526315, AUC 0.9809703826904297, avg_entr 0.028797395527362823
ep0_t0.8_test_time 0.254016637802124
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.7314693927764893
ep1_train_time 8.590300798416138
Test Epoch1 threshold 0.8 Acc 0.9172697368421052, AUC 0.9811466932296753, avg_entr 0.026559550315141678
ep1_t0.8_test_time 0.25398921966552734
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.7241885662078857
ep2_train_time 8.635152101516724
Test Epoch2 threshold 0.8 Acc 0.9172697368421052, AUC 0.980939507484436, avg_entr 0.027003208175301552
ep2_t0.8_test_time 0.2535407543182373
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.7195413708686829
ep3_train_time 8.570274114608765
Test Epoch3 threshold 0.8 Acc 0.915625, AUC 0.9807335734367371, avg_entr 0.026452621445059776
ep3_t0.8_test_time 0.2528982162475586
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.7156463265419006
ep4_train_time 8.610974550247192
Test Epoch4 threshold 0.8 Acc 0.9105263157894737, AUC 0.9807398915290833, avg_entr 0.026656921952962875
ep4_t0.8_test_time 0.2530250549316406
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.7139596343040466
ep5_train_time 8.66458249092102
Test Epoch5 threshold 0.8 Acc 0.915296052631579, AUC 0.9803669452667236, avg_entr 0.02678360417485237
ep5_t0.8_test_time 0.2538883686065674
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.713986873626709
ep6_train_time 8.667866230010986
Test Epoch6 threshold 0.8 Acc 0.9136513157894737, AUC 0.9803580641746521, avg_entr 0.0256298016756773
ep6_t0.8_test_time 0.25435733795166016
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.7127139568328857
ep7_train_time 8.678220510482788
Test Epoch7 threshold 0.8 Acc 0.9149671052631579, AUC 0.9802474975585938, avg_entr 0.02604607120156288
ep7_t0.8_test_time 0.25492191314697266
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.7116698026657104
ep8_train_time 8.687071561813354
Test Epoch8 threshold 0.8 Acc 0.9138157894736842, AUC 0.9801379442214966, avg_entr 0.02614353597164154
ep8_t0.8_test_time 0.25324559211730957
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.7112851142883301
ep9_train_time 8.641013860702515
Test Epoch9 threshold 0.8 Acc 0.9149671052631579, AUC 0.9800048470497131, avg_entr 0.025588421151041985
ep9_t0.8_test_time 0.2538440227508545
Best AUC 0.9811466932296753
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.8_m2//ag_news_linearal_l5_prefix.pt
[[328   7  16  17]
 [  0 389   3   1]
 [  5   6 354  35]
 [  2   2  23 332]]
Figure(640x480)
tensor([7.9169e-04, 8.2741e-04, 2.1320e-02,  ..., 9.2821e-03, 3.3021e-06,
        2.3598e-03])
[[328   7  16  17]
 [  0 389   3   1]
 [  4   6 352  38]
 [  2   2  22 333]]
Figure(640x480)
tensor([2.7138e-04, 6.1655e-04, 9.3573e-03,  ..., 2.3551e-02, 3.2949e-06,
        1.0684e-02])
[[325   2   0  41]
 [  0   0   0 393]
 [ 29   1   0 370]
 [  4  41   0 314]]
Figure(640x480)
tensor([0.8713, 0.8652, 0.8858,  ..., 0.8139, 0.9420, 0.9293])
[[  0   0 365   3]
 [  0   0 393   0]
 [  0   0 399   1]
 [  0   0 355   4]]
Figure(640x480)
tensor([0.8757, 0.8986, 0.9611,  ..., 0.7247, 0.8625, 0.8368])
[[  0 368   0   0]
 [  0 393   0   0]
 [  0 400   0   0]
 [  0 359   0   0]]
Figure(640x480)
tensor([0.9296, 0.9222, 0.9220,  ..., 0.9485, 1.0465, 0.9864])
