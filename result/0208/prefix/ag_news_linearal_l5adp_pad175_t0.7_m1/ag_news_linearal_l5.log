total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.48100051283836365
ep0_train_time 8.55592942237854
Test Epoch0 threshold 0.7 Acc 0.9, AUC 0.9739499688148499, avg_entr 0.18217648565769196
ep0_t0.7_test_time 0.2589147090911865
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.5172424912452698
ep1_train_time 8.243045330047607
Test Epoch1 threshold 0.7 Acc 0.9103618421052632, AUC 0.977783739566803, avg_entr 0.10541721433401108
ep1_t0.7_test_time 0.25780248641967773
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.5239861011505127
ep2_train_time 8.229722499847412
Test Epoch2 threshold 0.7 Acc 0.9108552631578948, AUC 0.9794623851776123, avg_entr 0.08332373201847076
ep2_t0.7_test_time 0.2579071521759033
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5282237529754639
ep3_train_time 8.201582670211792
Test Epoch3 threshold 0.7 Acc 0.9149671052631579, AUC 0.9802144765853882, avg_entr 0.06679997593164444
ep3_t0.7_test_time 0.2589836120605469
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.531428873538971
ep4_train_time 8.16157078742981
Test Epoch4 threshold 0.7 Acc 0.9149671052631579, AUC 0.9805623292922974, avg_entr 0.06020794063806534
ep4_t0.7_test_time 0.257720947265625
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.534635066986084
ep5_train_time 8.166192054748535
Test Epoch5 threshold 0.7 Acc 0.9174342105263158, AUC 0.9806119203567505, avg_entr 0.0550621934235096
ep5_t0.7_test_time 0.2576601505279541
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.5373673439025879
ep6_train_time 8.144885540008545
Test Epoch6 threshold 0.7 Acc 0.9166118421052631, AUC 0.9806009531021118, avg_entr 0.05078655481338501
ep6_t0.7_test_time 0.2581748962402344
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.5399799346923828
ep7_train_time 8.292041301727295
Test Epoch7 threshold 0.7 Acc 0.9162828947368421, AUC 0.9805765748023987, avg_entr 0.04519322142004967
ep7_t0.7_test_time 0.25755858421325684
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.5427237749099731
ep8_train_time 8.19269847869873
Test Epoch8 threshold 0.7 Acc 0.9162828947368421, AUC 0.9805336594581604, avg_entr 0.04391472414135933
ep8_t0.7_test_time 0.25684309005737305
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.5445055961608887
ep9_train_time 8.2077956199646
Test Epoch9 threshold 0.7 Acc 0.9146381578947368, AUC 0.9804794192314148, avg_entr 0.0411091148853302
ep9_t0.7_test_time 0.257373571395874
Best AUC 0.9806119203567505
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt
[[331   6  15  16]
 [  0 388   4   1]
 [  5   5 354  36]
 [  4   0  23 332]]
Figure(640x480)
tensor([0.0247, 0.0193, 0.1328,  ..., 0.1252, 0.0015, 0.0326])
[[  0   0 368   0]
 [  0   0 393   0]
 [  0   0 400   0]
 [  0   0 359   0]]
Figure(640x480)
tensor([1.3160, 1.3124, 1.3003,  ..., 1.3256, 1.3106, 1.3102])
[[  0   0 368   0]
 [  0   0 393   0]
 [  0   0 400   0]
 [  0   0 359   0]]
Figure(640x480)
tensor([1.2232, 1.2295, 1.2278,  ..., 1.2302, 1.2285, 1.2218])
[[  0   0 260 108]
 [  0   0  50 343]
 [  0   0 390  10]
 [  0   0 344  15]]
Figure(640x480)
tensor([1.3091, 1.3426, 1.3339,  ..., 1.3338, 1.3386, 1.3180])
[[  0 368   0   0]
 [  0 393   0   0]
 [  0 400   0   0]
 [  0 359   0   0]]
Figure(640x480)
tensor([1.1805, 1.2068, 1.1844,  ..., 1.1849, 1.2072, 1.1874])
