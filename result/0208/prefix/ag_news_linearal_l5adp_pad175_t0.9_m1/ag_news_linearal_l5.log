total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24946666666666667 (29936/120000), AUC 0.4151323437690735
ep0_train_time 8.592252254486084
Test Epoch0 threshold 0.9 Acc 0.8986842105263158, AUC 0.9736288785934448, avg_entr 0.18549871444702148
ep0_t0.9_test_time 0.2564828395843506
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.34987306594848633
ep1_train_time 8.380656242370605
Test Epoch1 threshold 0.9 Acc 0.9111842105263158, AUC 0.9776520729064941, avg_entr 0.10684308409690857
ep1_t0.9_test_time 0.25913548469543457
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.3464354872703552
ep2_train_time 8.3357515335083
Test Epoch2 threshold 0.9 Acc 0.9136513157894737, AUC 0.9794471859931946, avg_entr 0.08093743026256561
ep2_t0.9_test_time 0.255659818649292
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.3463393449783325
ep3_train_time 8.200501441955566
Test Epoch3 threshold 0.9 Acc 0.9157894736842105, AUC 0.9802172183990479, avg_entr 0.06755974888801575
ep3_t0.9_test_time 0.2559018135070801
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.3468583822250366
ep4_train_time 8.211167573928833
Test Epoch4 threshold 0.9 Acc 0.9154605263157894, AUC 0.9805673360824585, avg_entr 0.06001562997698784
ep4_t0.9_test_time 0.2554197311401367
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.3475964069366455
ep5_train_time 8.184382915496826
Test Epoch5 threshold 0.9 Acc 0.9149671052631579, AUC 0.9806972146034241, avg_entr 0.05577603355050087
ep5_t0.9_test_time 0.2565186023712158
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.3482118248939514
ep6_train_time 8.33909821510315
Test Epoch6 threshold 0.9 Acc 0.9162828947368421, AUC 0.9806188344955444, avg_entr 0.04983863979578018
ep6_t0.9_test_time 0.25547003746032715
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.34864217042922974
ep7_train_time 8.320333480834961
Test Epoch7 threshold 0.9 Acc 0.9172697368421052, AUC 0.9804966449737549, avg_entr 0.045462824404239655
ep7_t0.9_test_time 0.2557847499847412
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.34904295206069946
ep8_train_time 8.265882730484009
Test Epoch8 threshold 0.9 Acc 0.9167763157894737, AUC 0.9805542826652527, avg_entr 0.042854875326156616
ep8_t0.9_test_time 0.25609922409057617
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.34911036491394043
ep9_train_time 8.249825239181519
Test Epoch9 threshold 0.9 Acc 0.9171052631578948, AUC 0.9803609848022461, avg_entr 0.0402967594563961
ep9_t0.9_test_time 0.25633978843688965
Best AUC 0.9806972146034241
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt
[[335   5  15  13]
 [  0 389   3   1]
 [  5   5 361  29]
 [  8   0  28 323]]
Figure(640x480)
tensor([0.0275, 0.0339, 0.1173,  ..., 0.1357, 0.0013, 0.0383])
[[  0   0   0 368]
 [  0   0   0 393]
 [  1   0   0 399]
 [  3   0   0 356]]
Figure(640x480)
tensor([1.3734, 1.3825, 1.3848,  ..., 1.3861, 1.3530, 1.3646])
[[361   0   7   0]
 [393   0   0   0]
 [400   0   0   0]
 [359   0   0   0]]
Figure(640x480)
tensor([1.0853, 1.1188, 1.1150,  ..., 1.1010, 1.0957, 1.0995])
[[  0 368   0   0]
 [  0 393   0   0]
 [  0 400   0   0]
 [  0 359   0   0]]
Figure(640x480)
tensor([1.2396, 1.2632, 1.2447,  ..., 1.2608, 1.2714, 1.2744])
[[368   0   0   0]
 [393   0   0   0]
 [400   0   0   0]
 [359   0   0   0]]
Figure(640x480)
tensor([1.1742, 1.1803, 1.1985,  ..., 1.1701, 1.1879, 1.1680])
