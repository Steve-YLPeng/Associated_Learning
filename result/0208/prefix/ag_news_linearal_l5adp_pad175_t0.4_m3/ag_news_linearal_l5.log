total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.058925 (7071/120000), AUC 0.42680102586746216
ep0_train_time 9.519087314605713
Test Epoch0 threshold 0.4 Acc 0.9171052631578948, AUC 0.9806762337684631, avg_entr 0.025601431727409363
ep0_t0.4_test_time 0.2585725784301758
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.0279 (3348/120000), AUC 0.45109447836875916
ep1_train_time 8.978288412094116
Test Epoch1 threshold 0.4 Acc 0.9162828947368421, AUC 0.9808014035224915, avg_entr 0.025570161640644073
ep1_t0.4_test_time 0.2557339668273926
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.023708333333333335 (2845/120000), AUC 0.4693520963191986
ep2_train_time 9.110091209411621
Test Epoch2 threshold 0.4 Acc 0.9151315789473684, AUC 0.9804256558418274, avg_entr 0.026806795969605446
ep2_t0.4_test_time 0.2578268051147461
gc 0
Train Epoch3 Acc 0.024633333333333333 (2956/120000), AUC 0.46457821130752563
ep3_train_time 8.951765298843384
Test Epoch3 threshold 0.4 Acc 0.9151315789473684, AUC 0.9803927540779114, avg_entr 0.02582813985645771
ep3_t0.4_test_time 0.2575662136077881
gc 0
Train Epoch4 Acc 0.025 (3000/120000), AUC 0.4170509874820709
ep4_train_time 8.996022701263428
Test Epoch4 threshold 0.4 Acc 0.9131578947368421, AUC 0.9801149368286133, avg_entr 0.0259992778301239
ep4_t0.4_test_time 0.25635623931884766
gc 0
Train Epoch5 Acc 0.020108333333333332 (2413/120000), AUC 0.34275269508361816
ep5_train_time 9.043851852416992
Test Epoch5 threshold 0.4 Acc 0.912828947368421, AUC 0.9800024032592773, avg_entr 0.02641262672841549
ep5_t0.4_test_time 0.25539469718933105
gc 0
Train Epoch6 Acc 0.017291666666666667 (2075/120000), AUC 0.2989450693130493
ep6_train_time 9.107892751693726
Test Epoch6 threshold 0.4 Acc 0.9136513157894737, AUC 0.9799476861953735, avg_entr 0.025577504187822342
ep6_t0.4_test_time 0.2588653564453125
gc 0
Train Epoch7 Acc 0.016291666666666666 (1955/120000), AUC 0.2746860980987549
ep7_train_time 9.076111555099487
Test Epoch7 threshold 0.4 Acc 0.9138157894736842, AUC 0.9798184037208557, avg_entr 0.02570210210978985
ep7_t0.4_test_time 0.25771117210388184
gc 0
Train Epoch8 Acc 0.016091666666666667 (1931/120000), AUC 0.2520236372947693
ep8_train_time 9.009770393371582
Test Epoch8 threshold 0.4 Acc 0.9134868421052632, AUC 0.9796653389930725, avg_entr 0.02550932765007019
ep8_t0.4_test_time 0.2572062015533447
gc 0
Train Epoch9 Acc 0.016366666666666668 (1964/120000), AUC 0.23013044893741608
ep9_train_time 8.992977619171143
Test Epoch9 threshold 0.4 Acc 0.9115131578947369, AUC 0.9796634912490845, avg_entr 0.026770727708935738
ep9_t0.4_test_time 0.2569401264190674
Best AUC 0.9808014035224915
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt
[[1362   52   81   37]
 [   9 1480   10    8]
 [  31   13 1346  110]
 [  31   13  117 1380]]
Figure(640x480)
tensor([5.5281e-04, 1.0402e-07, 1.6327e-04,  ..., 4.2416e-08, 5.8290e-06,
        1.3092e-04])
[[1368   50   80   34]
 [  10 1480    9    8]
 [  32   13 1345  110]
 [  33   14  115 1379]]
Figure(640x480)
tensor([5.7362e-04, 8.3402e-07, 1.5312e-04,  ..., 6.3331e-08, 5.3951e-06,
        6.9407e-04])
[[1365   50   83   34]
 [   9 1479   10    9]
 [  28   12 1347  113]
 [  34   13  113 1381]]
Figure(640x480)
tensor([3.2611e-04, 1.2088e-06, 7.4274e-05,  ..., 4.6609e-08, 3.1929e-06,
        7.0578e-04])
[[1498    0    0   34]
 [ 353    0    0 1154]
 [1498    0    0    2]
 [1540    0    0    1]]
Figure(640x480)
tensor([0.3162, 0.4036, 0.3754,  ..., 0.4947, 0.2638, 0.1277])
[[ 105 1420    7    0]
 [1361  146    0    0]
 [1169  331    0    0]
 [  23 1518    0    0]]
Figure(640x480)
tensor([1.0591, 0.4828, 0.6039,  ..., 0.6236, 0.6115, 1.0378])
