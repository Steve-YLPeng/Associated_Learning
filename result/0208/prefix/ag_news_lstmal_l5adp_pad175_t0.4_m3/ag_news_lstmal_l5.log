total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.46910833333333335 (56293/120000), AUC 0.5931617617607117
ep0_train_time 67.00495886802673
Test Epoch0 threshold 0.4 Acc 0.9159539473684211, AUC 0.9804927110671997, avg_entr 0.02477865479886532
ep0_t0.4_test_time 0.30650997161865234
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4765 (57180/120000), AUC 0.5414688587188721
ep1_train_time 67.02079772949219
Test Epoch1 threshold 0.4 Acc 0.9144736842105263, AUC 0.9804014563560486, avg_entr 0.023785807192325592
ep1_t0.4_test_time 0.29285597801208496
gc 0
Train Epoch2 Acc 0.477875 (57345/120000), AUC 0.5327850580215454
ep2_train_time 67.00196623802185
Test Epoch2 threshold 0.4 Acc 0.9129934210526316, AUC 0.9802513122558594, avg_entr 0.023861167952418327
ep2_t0.4_test_time 0.2985396385192871
gc 0
Train Epoch3 Acc 0.4794083333333333 (57529/120000), AUC 0.5307819247245789
ep3_train_time 67.03607177734375
Test Epoch3 threshold 0.4 Acc 0.9131578947368421, AUC 0.9800384044647217, avg_entr 0.025358106940984726
ep3_t0.4_test_time 0.2954378128051758
gc 0
Train Epoch4 Acc 0.48088333333333333 (57706/120000), AUC 0.5394935011863708
ep4_train_time 67.22785425186157
Test Epoch4 threshold 0.4 Acc 0.9118421052631579, AUC 0.9798464775085449, avg_entr 0.026163319125771523
ep4_t0.4_test_time 0.3080871105194092
gc 0
Train Epoch5 Acc 0.48275 (57930/120000), AUC 0.5472158789634705
ep5_train_time 67.07492804527283
Test Epoch5 threshold 0.4 Acc 0.9138157894736842, AUC 0.9798593521118164, avg_entr 0.025070734322071075
ep5_t0.4_test_time 0.29827260971069336
gc 0
Train Epoch6 Acc 0.4830833333333333 (57970/120000), AUC 0.5508790016174316
ep6_train_time 67.09741306304932
Test Epoch6 threshold 0.4 Acc 0.9129934210526316, AUC 0.9798194169998169, avg_entr 0.024615975096821785
ep6_t0.4_test_time 0.28904247283935547
gc 0
Train Epoch7 Acc 0.48385833333333333 (58063/120000), AUC 0.5564798712730408
ep7_train_time 67.0747971534729
Test Epoch7 threshold 0.4 Acc 0.9118421052631579, AUC 0.9795463681221008, avg_entr 0.025485847145318985
ep7_t0.4_test_time 0.2833125591278076
gc 0
Train Epoch8 Acc 0.48391666666666666 (58070/120000), AUC 0.5575939416885376
ep8_train_time 67.0823245048523
Test Epoch8 threshold 0.4 Acc 0.9133223684210526, AUC 0.9796432256698608, avg_entr 0.025358380749821663
ep8_t0.4_test_time 0.29252171516418457
gc 0
Train Epoch9 Acc 0.48325 (57990/120000), AUC 0.5572881698608398
ep9_train_time 67.12545895576477
Test Epoch9 threshold 0.4 Acc 0.9144736842105263, AUC 0.9795289039611816, avg_entr 0.024789173156023026
ep9_t0.4_test_time 0.29036951065063477
Best AUC 0.9804927110671997
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.4_m3//ag_news_lstmal_l5_prefix.pt
[[1383   50   67   32]
 [  15 1479    5    8]
 [  42   12 1336  110]
 [  43   14  112 1372]]
Figure(640x480)
tensor([2.6618e-03, 1.7026e-07, 7.1793e-04,  ..., 6.7338e-08, 5.7013e-06,
        1.3641e-04])
[[1383   48   63   38]
 [  19 1466   11   11]
 [  43   10 1342  105]
 [  36   12  124 1369]]
Figure(640x480)
tensor([1.0056e-06, 2.1337e-07, 6.7417e-07,  ..., 3.5689e-07, 7.5125e-07,
        8.3507e-07])
[[1381   47   62   42]
 [  21 1467   10    9]
 [  42   10 1339  109]
 [  35   14  124 1368]]
Figure(640x480)
tensor([1.0131e-06, 5.3951e-07, 9.4493e-07,  ..., 3.1753e-07, 6.6377e-07,
        7.5826e-07])
[[ 111    1 1377   43]
 [   4    2   45 1456]
 [   2    0 1489    9]
 [   8    0 1518   15]]
Figure(640x480)
tensor([0.6058, 1.0996, 1.1632,  ..., 0.8030, 1.1438, 0.6059])
[[1428    0  104    0]
 [  29    0 1478    0]
 [ 134    8 1358    0]
 [1321   19  201    0]]
Figure(640x480)
tensor([1.1393, 1.2443, 1.2431,  ..., 0.6684, 1.2915, 1.1316])
