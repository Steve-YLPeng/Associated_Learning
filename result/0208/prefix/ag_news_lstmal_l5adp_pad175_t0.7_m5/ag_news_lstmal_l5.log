total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.93715 (112458/120000), AUC 0.9878190159797668
ep0_train_time 88.35032057762146
Test Epoch0 threshold 0.7 Acc 0.9136513157894737, AUC 0.9803756475448608, avg_entr 0.025792691856622696
ep0_t0.7_test_time 0.2539832592010498
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9582583333333333 (114991/120000), AUC 0.9938545823097229
ep1_train_time 88.31846880912781
Test Epoch1 threshold 0.7 Acc 0.9146381578947368, AUC 0.9804875254631042, avg_entr 0.0258562620729208
ep1_t0.7_test_time 0.2528390884399414
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m5//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9611833333333333 (115342/120000), AUC 0.9943824410438538
ep2_train_time 88.26943612098694
Test Epoch2 threshold 0.7 Acc 0.9129934210526316, AUC 0.9801384210586548, avg_entr 0.025236476212739944
ep2_t0.7_test_time 0.2516622543334961
gc 0
Train Epoch3 Acc 0.9635083333333333 (115621/120000), AUC 0.9946904182434082
ep3_train_time 88.22319483757019
Test Epoch3 threshold 0.7 Acc 0.9139802631578947, AUC 0.9800357222557068, avg_entr 0.025841277092695236
ep3_t0.7_test_time 0.2519247531890869
gc 0
Train Epoch4 Acc 0.9652083333333333 (115825/120000), AUC 0.9950852990150452
ep4_train_time 88.15353727340698
Test Epoch4 threshold 0.7 Acc 0.9123355263157895, AUC 0.9798091650009155, avg_entr 0.026160450652241707
ep4_t0.7_test_time 0.2550234794616699
gc 0
Train Epoch5 Acc 0.9671916666666667 (116063/120000), AUC 0.9953562617301941
ep5_train_time 88.23438715934753
Test Epoch5 threshold 0.7 Acc 0.9133223684210526, AUC 0.9797153472900391, avg_entr 0.02634013257920742
ep5_t0.7_test_time 0.2519383430480957
gc 0
Train Epoch6 Acc 0.970425 (116451/120000), AUC 0.9958164691925049
ep6_train_time 88.28500866889954
Test Epoch6 threshold 0.7 Acc 0.9123355263157895, AUC 0.9795565605163574, avg_entr 0.025202728807926178
ep6_t0.7_test_time 0.251697301864624
gc 0
Train Epoch7 Acc 0.9717083333333333 (116605/120000), AUC 0.9958230257034302
ep7_train_time 88.21305251121521
Test Epoch7 threshold 0.7 Acc 0.9120065789473685, AUC 0.9794502258300781, avg_entr 0.025219319388270378
ep7_t0.7_test_time 0.2512052059173584
gc 0
Train Epoch8 Acc 0.9724333333333334 (116692/120000), AUC 0.9959457516670227
ep8_train_time 88.29643440246582
Test Epoch8 threshold 0.7 Acc 0.9125, AUC 0.9793680906295776, avg_entr 0.02550901286303997
ep8_t0.7_test_time 0.2520768642425537
gc 0
Train Epoch9 Acc 0.9733583333333333 (116803/120000), AUC 0.9960740804672241
ep9_train_time 88.17100858688354
Test Epoch9 threshold 0.7 Acc 0.9106907894736842, AUC 0.9793034791946411, avg_entr 0.02536417357623577
ep9_t0.7_test_time 0.255842924118042
Best AUC 0.9804875254631042
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m5//ag_news_lstmal_l5_prefix.pt
[[328   6  17  17]
 [  0 388   4   1]
 [  6   4 363  27]
 [  4   1  27 327]]
Figure(640x480)
tensor([1.2875e-05, 9.4614e-04, 4.4483e-02,  ..., 1.3839e-01, 3.5882e-08,
        8.8489e-05])
[[331   6  13  18]
 [  0 389   3   1]
 [  8   2 360  30]
 [  8   1  23 327]]
Figure(640x480)
tensor([1.6702e-07, 3.3757e-07, 2.7143e-05,  ..., 1.8216e-07, 1.6694e-07,
        4.1911e-07])
[[332   6  12  18]
 [  0 389   4   0]
 [  7   3 358  32]
 [  5   1  24 329]]
Figure(640x480)
tensor([1.7183e-07, 7.0038e-07, 1.7143e-05,  ..., 1.7530e-07, 1.7656e-07,
        5.6355e-07])
[[331   6  13  18]
 [  0 389   4   0]
 [  7   3 358  32]
 [  6   1  25 327]]
Figure(640x480)
tensor([2.7799e-07, 1.2718e-06, 2.0691e-05,  ..., 1.9796e-07, 1.0124e-07,
        9.4915e-07])
[[330   7  13  18]
 [  0 389   4   0]
 [  7   2 361  30]
 [  6   0  28 325]]
Figure(640x480)
tensor([1.2292e-06, 3.7803e-06, 8.3897e-05,  ..., 3.2401e-07, 2.0763e-08,
        1.5629e-07])
