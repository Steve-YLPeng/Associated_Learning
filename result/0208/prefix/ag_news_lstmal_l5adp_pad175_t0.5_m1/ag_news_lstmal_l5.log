total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.21304166666666666 (25565/120000), AUC 0.48121893405914307
ep0_train_time 47.01386857032776
Test Epoch0 threshold 0.5 Acc 0.8980263157894737, AUC 0.9737048745155334, avg_entr 0.18099847435951233
ep0_t0.5_test_time 0.25847911834716797
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.5_m1//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.19969166666666666 (23963/120000), AUC 0.4815540015697479
ep1_train_time 47.16812491416931
Test Epoch1 threshold 0.5 Acc 0.9125, AUC 0.9777896404266357, avg_entr 0.10605152696371078
ep1_t0.5_test_time 0.2570343017578125
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.5_m1//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.20345833333333332 (24415/120000), AUC 0.48245587944984436
ep2_train_time 47.30874252319336
Test Epoch2 threshold 0.5 Acc 0.9136513157894737, AUC 0.9793468713760376, avg_entr 0.07946997880935669
ep2_t0.5_test_time 0.2575089931488037
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.5_m1//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.2088 (25056/120000), AUC 0.48368728160858154
ep3_train_time 47.166911363601685
Test Epoch3 threshold 0.5 Acc 0.9129934210526316, AUC 0.9800283908843994, avg_entr 0.06782373785972595
ep3_t0.5_test_time 0.257892370223999
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.5_m1//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.21376666666666666 (25652/120000), AUC 0.484436571598053
ep4_train_time 47.12560844421387
Test Epoch4 threshold 0.5 Acc 0.9143092105263158, AUC 0.9806152582168579, avg_entr 0.060313962399959564
ep4_t0.5_test_time 0.2600879669189453
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.5_m1//ag_news_lstmal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.21805 (26166/120000), AUC 0.484971821308136
ep5_train_time 47.19066143035889
Test Epoch5 threshold 0.5 Acc 0.9123355263157895, AUC 0.9806782603263855, avg_entr 0.05765865743160248
ep5_t0.5_test_time 0.25675535202026367
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.5_m1//ag_news_lstmal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.22196666666666667 (26636/120000), AUC 0.4857020974159241
ep6_train_time 47.10461354255676
Test Epoch6 threshold 0.5 Acc 0.9151315789473684, AUC 0.9808412194252014, avg_entr 0.05037842318415642
ep6_t0.5_test_time 0.256986141204834
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.5_m1//ag_news_lstmal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.22473333333333334 (26968/120000), AUC 0.4856584370136261
ep7_train_time 47.08608365058899
Test Epoch7 threshold 0.5 Acc 0.9164473684210527, AUC 0.9807887673377991, avg_entr 0.046294935047626495
ep7_t0.5_test_time 0.2567329406738281
gc 0
Train Epoch8 Acc 0.22713333333333333 (27256/120000), AUC 0.4862053394317627
ep8_train_time 47.175169944763184
Test Epoch8 threshold 0.5 Acc 0.9169407894736842, AUC 0.980695366859436, avg_entr 0.04364447668194771
ep8_t0.5_test_time 0.2569260597229004
gc 0
Train Epoch9 Acc 0.22905 (27486/120000), AUC 0.4862293303012848
ep9_train_time 47.07554268836975
Test Epoch9 threshold 0.5 Acc 0.9167763157894737, AUC 0.9806013703346252, avg_entr 0.040962304919958115
ep9_t0.5_test_time 0.25746822357177734
Best AUC 0.9808412194252014
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.5_m1//ag_news_lstmal_l5_prefix.pt
[[1362   53   82   35]
 [   8 1481   10    8]
 [  30   11 1350  109]
 [  37   12  121 1371]]
Figure(640x480)
tensor([0.0247, 0.0004, 0.0108,  ..., 0.0004, 0.0036, 0.0116])
[[ 216   17 1059  240]
 [  70  101  983  353]
 [ 135   19 1050  296]
 [  55   10 1266  210]]
Figure(640x480)
tensor([1.2086, 1.2474, 0.9554,  ..., 1.2123, 1.0730, 0.8523])
[[ 903   22  603    4]
 [ 739   38  707   23]
 [1131  117  199   53]
 [ 884   60  587   10]]
Figure(640x480)
tensor([1.4273, 1.3876, 1.4297,  ..., 1.3495, 1.4289, 1.3983])
[[  40  101  105 1286]
 [  15  147  268 1077]
 [ 113  291   95 1001]
 [  29  477  238  797]]
Figure(640x480)
tensor([1.4468, 1.4561, 1.4316,  ..., 1.4269, 1.4442, 1.4574])
[[   0    0  252 1280]
 [   0    0  643  864]
 [   0    0   79 1421]
 [   0    0  276 1265]]
Figure(640x480)
tensor([1.4087, 1.4307, 1.4320,  ..., 1.4027, 1.4053, 1.4325])
