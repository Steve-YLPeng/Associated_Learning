total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.443575 (53229/120000), AUC 0.42709606885910034
ep0_train_time 77.65327072143555
Test Epoch0 threshold 0.9 Acc 0.915625, AUC 0.9805382490158081, avg_entr 0.025537332519888878
ep0_t0.9_test_time 0.2505452632904053
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.31365 (37638/120000), AUC 0.4112916886806488
ep1_train_time 77.4923689365387
Test Epoch1 threshold 0.9 Acc 0.9171052631578948, AUC 0.9806144833564758, avg_entr 0.025894785299897194
ep1_t0.9_test_time 0.24855685234069824
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m4//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.339375 (40725/120000), AUC 0.3934177756309509
ep2_train_time 77.63809299468994
Test Epoch2 threshold 0.9 Acc 0.9161184210526315, AUC 0.9804105758666992, avg_entr 0.026124382391572
ep2_t0.9_test_time 0.24857783317565918
gc 0
Train Epoch3 Acc 0.35646666666666665 (42776/120000), AUC 0.3701755404472351
ep3_train_time 77.52638816833496
Test Epoch3 threshold 0.9 Acc 0.9138157894736842, AUC 0.9802581071853638, avg_entr 0.025452908128499985
ep3_t0.9_test_time 0.24986600875854492
gc 0
Train Epoch4 Acc 0.40928333333333333 (49114/120000), AUC 0.3624224066734314
ep4_train_time 77.61104893684387
Test Epoch4 threshold 0.9 Acc 0.9143092105263158, AUC 0.9801019430160522, avg_entr 0.0258651003241539
ep4_t0.9_test_time 0.24928069114685059
gc 0
Train Epoch5 Acc 0.40905833333333336 (49087/120000), AUC 0.353052020072937
ep5_train_time 77.54898929595947
Test Epoch5 threshold 0.9 Acc 0.9138157894736842, AUC 0.9798486828804016, avg_entr 0.025932779535651207
ep5_t0.9_test_time 0.24898672103881836
gc 0
Train Epoch6 Acc 0.427675 (51321/120000), AUC 0.3561074137687683
ep6_train_time 77.59874534606934
Test Epoch6 threshold 0.9 Acc 0.9139802631578947, AUC 0.9798523187637329, avg_entr 0.02639905735850334
ep6_t0.9_test_time 0.24892735481262207
gc 0
Train Epoch7 Acc 0.43244166666666667 (51893/120000), AUC 0.3577159345149994
ep7_train_time 77.69805884361267
Test Epoch7 threshold 0.9 Acc 0.9134868421052632, AUC 0.9797006845474243, avg_entr 0.02559029869735241
ep7_t0.9_test_time 0.24911141395568848
gc 0
Train Epoch8 Acc 0.421925 (50631/120000), AUC 0.35912832617759705
ep8_train_time 77.48327088356018
Test Epoch8 threshold 0.9 Acc 0.9123355263157895, AUC 0.9795842170715332, avg_entr 0.026383766904473305
ep8_t0.9_test_time 0.2492201328277588
gc 0
Train Epoch9 Acc 0.4149333333333333 (49792/120000), AUC 0.35764414072036743
ep9_train_time 77.52373218536377
Test Epoch9 threshold 0.9 Acc 0.9129934210526316, AUC 0.9795674085617065, avg_entr 0.025813505053520203
ep9_t0.9_test_time 0.24949073791503906
Best AUC 0.9806144833564758
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m4//ag_news_lstmal_l5_prefix.pt
[[330   6  14  18]
 [  0 389   3   1]
 [ 10   7 341  42]
 [  3   1  17 338]]
Figure(640x480)
tensor([1.8176e-05, 5.7402e-04, 7.0415e-03,  ..., 7.9404e-02, 7.6091e-08,
        8.7781e-04])
[[335   5  13  15]
 [  1 387   4   1]
 [ 14   1 354  31]
 [  7   1  24 327]]
Figure(640x480)
tensor([2.0359e-07, 1.3057e-06, 1.9778e-06,  ..., 2.1927e-07, 1.9508e-07,
        1.7282e-06])
[[335   4  13  16]
 [  1 387   4   1]
 [ 12   1 356  31]
 [  7   1  24 327]]
Figure(640x480)
tensor([1.8588e-07, 7.1891e-07, 1.6792e-06,  ..., 2.1824e-07, 2.1105e-07,
        2.8354e-06])
[[334   4  13  17]
 [  1 388   4   0]
 [ 13   1 355  31]
 [  8   0  26 325]]
Figure(640x480)
tensor([1.5876e-07, 4.3362e-07, 1.2549e-06,  ..., 3.8345e-07, 2.8619e-07,
        1.6961e-06])
[[113   0 234  21]
 [  5   0   0 388]
 [372   0   2  26]
 [ 43   0   0 316]]
Figure(640x480)
tensor([0.8654, 0.9497, 0.9467,  ..., 0.7022, 0.9693, 1.1331])
