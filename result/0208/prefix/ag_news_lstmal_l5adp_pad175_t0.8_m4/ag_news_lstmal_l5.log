total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.8_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.61865 (74238/120000), AUC 0.7719935774803162
ep0_train_time 77.5578966140747
Test Epoch0 threshold 0.8 Acc 0.9157894736842105, AUC 0.9804099798202515, avg_entr 0.025785060599446297
ep0_t0.8_test_time 0.2525458335876465
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.8_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.6900916666666667 (82811/120000), AUC 0.7608717679977417
ep1_train_time 77.6404139995575
Test Epoch1 threshold 0.8 Acc 0.915296052631579, AUC 0.9803534746170044, avg_entr 0.025989126414060593
ep1_t0.8_test_time 0.2513256072998047
gc 0
Train Epoch2 Acc 0.700175 (84021/120000), AUC 0.7644606828689575
ep2_train_time 77.70856928825378
Test Epoch2 threshold 0.8 Acc 0.9143092105263158, AUC 0.9801667928695679, avg_entr 0.025212643668055534
ep2_t0.8_test_time 0.2511920928955078
gc 0
Train Epoch3 Acc 0.6766166666666666 (81194/120000), AUC 0.7708632946014404
ep3_train_time 77.71238350868225
Test Epoch3 threshold 0.8 Acc 0.9116776315789473, AUC 0.9799435138702393, avg_entr 0.025520194321870804
ep3_t0.8_test_time 0.25118541717529297
gc 0
Train Epoch4 Acc 0.6281916666666667 (75383/120000), AUC 0.773615300655365
ep4_train_time 77.7670350074768
Test Epoch4 threshold 0.8 Acc 0.9139802631578947, AUC 0.9800407290458679, avg_entr 0.025911496952176094
ep4_t0.8_test_time 0.251450777053833
gc 0
Train Epoch5 Acc 0.58845 (70614/120000), AUC 0.7728487849235535
ep5_train_time 77.7969720363617
Test Epoch5 threshold 0.8 Acc 0.9126644736842106, AUC 0.9798591732978821, avg_entr 0.02571113407611847
ep5_t0.8_test_time 0.2511110305786133
gc 0
Train Epoch6 Acc 0.5403166666666667 (64838/120000), AUC 0.768095850944519
ep6_train_time 77.63924050331116
Test Epoch6 threshold 0.8 Acc 0.9146381578947368, AUC 0.9798247814178467, avg_entr 0.026189329102635384
ep6_t0.8_test_time 0.25049543380737305
gc 0
Train Epoch7 Acc 0.52015 (62418/120000), AUC 0.7639886140823364
ep7_train_time 77.64514207839966
Test Epoch7 threshold 0.8 Acc 0.9118421052631579, AUC 0.9796661138534546, avg_entr 0.026946978643536568
ep7_t0.8_test_time 0.2521817684173584
gc 0
Train Epoch8 Acc 0.5065666666666667 (60788/120000), AUC 0.7634308338165283
ep8_train_time 77.73595809936523
Test Epoch8 threshold 0.8 Acc 0.9136513157894737, AUC 0.9795516729354858, avg_entr 0.02626088075339794
ep8_t0.8_test_time 0.2510948181152344
gc 0
Train Epoch9 Acc 0.49755 (59706/120000), AUC 0.7600880265235901
ep9_train_time 77.64791488647461
Test Epoch9 threshold 0.8 Acc 0.912828947368421, AUC 0.9794843792915344, avg_entr 0.02561371959745884
ep9_t0.8_test_time 0.2521402835845947
Best AUC 0.9804099798202515
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.8_m4//ag_news_lstmal_l5_prefix.pt
[[332   7  15  14]
 [  0 389   3   1]
 [  8   5 356  31]
 [  4   1  24 330]]
Figure(640x480)
tensor([6.9647e-05, 1.7755e-03, 9.8033e-02,  ..., 3.7756e-02, 9.5667e-08,
        6.7589e-04])
[[333   4  14  17]
 [  1 386   5   1]
 [  6   2 364  28]
 [  4   1  27 327]]
Figure(640x480)
tensor([7.2173e-07, 1.2491e-06, 4.4219e-05,  ..., 4.1144e-07, 9.1163e-08,
        4.6872e-07])
[[335   4  13  16]
 [  1 386   5   1]
 [  6   2 363  29]
 [  4   0  26 329]]
Figure(640x480)
tensor([2.6580e-07, 7.2230e-07, 2.0720e-05,  ..., 3.8286e-07, 1.0115e-07,
        7.5270e-07])
[[332   4  14  18]
 [  1 384   7   1]
 [  7   1 361  31]
 [  4   0  25 330]]
Figure(640x480)
tensor([5.8089e-07, 1.1912e-06, 1.3644e-05,  ..., 2.7906e-07, 7.8229e-07,
        3.1915e-06])
[[263   3 102   0]
 [  0 373  20   0]
 [  3   1 396   0]
 [  1   0 329  29]]
Figure(640x480)
tensor([0.5400, 0.6315, 0.6355,  ..., 1.0885, 0.9247, 0.9541])
