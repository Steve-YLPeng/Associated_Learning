total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m1//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.263525 (31623/120000), AUC 0.6928879022598267
ep0_train_time 56.02241134643555
Test Epoch0 threshold 0.6 Acc 0.9134868421052632, AUC 0.980730414390564, avg_entr 0.028493568301200867
ep0_t0.6_test_time 0.2541060447692871
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m2//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.268875 (32265/120000), AUC 0.7452009916305542
ep1_train_time 56.102110385894775
Test Epoch1 threshold 0.6 Acc 0.9149671052631579, AUC 0.9808124899864197, avg_entr 0.02654561586678028
ep1_t0.6_test_time 0.25242114067077637
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m2//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2881416666666667 (34577/120000), AUC 0.7545503377914429
ep2_train_time 56.060527086257935
Test Epoch2 threshold 0.6 Acc 0.9171052631578948, AUC 0.9807730913162231, avg_entr 0.026208842173218727
ep2_t0.6_test_time 0.25162434577941895
gc 0
Train Epoch3 Acc 0.31958333333333333 (38350/120000), AUC 0.7606316208839417
ep3_train_time 56.060343742370605
Test Epoch3 threshold 0.6 Acc 0.9164473684210527, AUC 0.9803982377052307, avg_entr 0.026502452790737152
ep3_t0.6_test_time 0.2518301010131836
gc 0
Train Epoch4 Acc 0.34003333333333335 (40804/120000), AUC 0.7564774751663208
ep4_train_time 56.04333806037903
Test Epoch4 threshold 0.6 Acc 0.9133223684210526, AUC 0.9802600145339966, avg_entr 0.027359483763575554
ep4_t0.6_test_time 0.251706600189209
gc 0
Train Epoch5 Acc 0.3453333333333333 (41440/120000), AUC 0.7552474141120911
ep5_train_time 56.12690782546997
Test Epoch5 threshold 0.6 Acc 0.915296052631579, AUC 0.9801645278930664, avg_entr 0.02576976828277111
ep5_t0.6_test_time 0.25170111656188965
gc 0
Train Epoch6 Acc 0.3575 (42900/120000), AUC 0.7525371313095093
ep6_train_time 56.230555295944214
Test Epoch6 threshold 0.6 Acc 0.9141447368421053, AUC 0.9800907373428345, avg_entr 0.025693675503134727
ep6_t0.6_test_time 0.25198841094970703
gc 0
Train Epoch7 Acc 0.36044166666666666 (43253/120000), AUC 0.7504493594169617
ep7_train_time 56.20419526100159
Test Epoch7 threshold 0.6 Acc 0.9129934210526316, AUC 0.979957103729248, avg_entr 0.026544706895947456
ep7_t0.6_test_time 0.25247907638549805
gc 0
Train Epoch8 Acc 0.3635083333333333 (43621/120000), AUC 0.7478229403495789
ep8_train_time 56.24081540107727
Test Epoch8 threshold 0.6 Acc 0.9111842105263158, AUC 0.9798688292503357, avg_entr 0.025789743289351463
ep8_t0.6_test_time 0.2518496513366699
gc 0
Train Epoch9 Acc 0.376525 (45183/120000), AUC 0.7477178573608398
ep9_train_time 56.20947456359863
Test Epoch9 threshold 0.6 Acc 0.9151315789473684, AUC 0.9798576235771179, avg_entr 0.025998225435614586
ep9_t0.6_test_time 0.25148820877075195
Best AUC 0.9808124899864197
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m2//ag_news_lstmal_l5_prefix.pt
[[326   7  19  16]
 [  0 389   3   1]
 [  5   6 359  30]
 [  3   1  28 327]]
Figure(640x480)
tensor([3.3273e-04, 1.4580e-03, 6.4166e-02,  ..., 8.4091e-03, 1.6459e-06,
        7.8380e-04])
[[333   6  12  17]
 [  1 388   3   1]
 [  7   3 357  33]
 [  3   2  27 327]]
Figure(640x480)
tensor([1.3239e-06, 4.9157e-04, 1.7883e-04,  ..., 1.4740e-06, 8.2769e-07,
        7.0279e-06])
[[  0  67   0 301]
 [  0   3   0 390]
 [  0 371   0  29]
 [  0  40   0 319]]
Figure(640x480)
tensor([0.7342, 0.7696, 0.6755,  ..., 0.7462, 0.8945, 0.8838])
[[  0 314   2  52]
 [ 39  28 322   4]
 [  0  13   0 387]
 [  0   9   0 350]]
Figure(640x480)
tensor([1.1644, 1.2169, 1.1449,  ..., 1.2440, 1.0112, 1.1476])
[[  0 368   0   0]
 [  0 393   0   0]
 [  0 352  48   0]
 [  0 336  23   0]]
Figure(640x480)
tensor([1.0631, 0.9902, 1.0161,  ..., 0.9922, 1.0045, 1.0331])
