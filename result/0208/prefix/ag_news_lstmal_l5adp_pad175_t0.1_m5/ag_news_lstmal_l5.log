total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.1_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9163666666666667 (109964/120000), AUC 0.9840546250343323
ep0_train_time 88.31627321243286
Test Epoch0 threshold 0.1 Acc 0.9118421052631579, AUC 0.9791139364242554, avg_entr 0.007040994241833687
ep0_t0.1_test_time 0.661919355392456
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.1_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.953925 (114471/120000), AUC 0.9929208755493164
ep1_train_time 88.23301935195923
Test Epoch1 threshold 0.1 Acc 0.9125, AUC 0.9782177209854126, avg_entr 0.007277513388544321
ep1_t0.1_test_time 0.6465535163879395
gc 0
Train Epoch2 Acc 0.9567666666666667 (114812/120000), AUC 0.9935512542724609
ep2_train_time 88.22013592720032
Test Epoch2 threshold 0.1 Acc 0.9126644736842106, AUC 0.9779857397079468, avg_entr 0.007256309036165476
ep2_t0.1_test_time 0.652677059173584
gc 0
Train Epoch3 Acc 0.9596416666666666 (115157/120000), AUC 0.9939773082733154
ep3_train_time 88.11641049385071
Test Epoch3 threshold 0.1 Acc 0.9139802631578947, AUC 0.977489709854126, avg_entr 0.006845207419246435
ep3_t0.1_test_time 0.6462669372558594
gc 0
Train Epoch4 Acc 0.9618083333333334 (115417/120000), AUC 0.994318962097168
ep4_train_time 88.19746565818787
Test Epoch4 threshold 0.1 Acc 0.9110197368421052, AUC 0.9768441915512085, avg_entr 0.006893495563417673
ep4_t0.1_test_time 0.658646821975708
gc 0
Train Epoch5 Acc 0.9657666666666667 (115892/120000), AUC 0.9950169324874878
ep5_train_time 87.99074339866638
Test Epoch5 threshold 0.1 Acc 0.9131578947368421, AUC 0.9767181873321533, avg_entr 0.007051536347717047
ep5_t0.1_test_time 0.6676230430603027
gc 0
Train Epoch6 Acc 0.966725 (116007/120000), AUC 0.9950926303863525
ep6_train_time 88.01744866371155
Test Epoch6 threshold 0.1 Acc 0.9103618421052632, AUC 0.9758626222610474, avg_entr 0.006793253589421511
ep6_t0.1_test_time 0.6506681442260742
gc 0
Train Epoch7 Acc 0.968075 (116169/120000), AUC 0.9951832294464111
ep7_train_time 88.01302814483643
Test Epoch7 threshold 0.1 Acc 0.909375, AUC 0.9751678705215454, avg_entr 0.006520670838654041
ep7_t0.1_test_time 0.6540718078613281
gc 0
Train Epoch8 Acc 0.9695 (116340/120000), AUC 0.9952079653739929
ep8_train_time 88.03270292282104
Test Epoch8 threshold 0.1 Acc 0.9101973684210526, AUC 0.9758079648017883, avg_entr 0.006723662372678518
ep8_t0.1_test_time 0.6659910678863525
gc 0
Train Epoch9 Acc 0.971175 (116541/120000), AUC 0.9955364465713501
ep9_train_time 88.04516172409058
Test Epoch9 threshold 0.1 Acc 0.9092105263157895, AUC 0.9750851988792419, avg_entr 0.0064948489889502525
ep9_t0.1_test_time 0.6529660224914551
Best AUC 0.9791139364242554
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.1_m5//ag_news_lstmal_l5_prefix.pt
[[1379   50   73   30]
 [  12 1481    8    6]
 [  39   13 1339  109]
 [  47   19  119 1356]]
Figure(640x480)
tensor([5.9372e-04, 7.2354e-08, 1.2974e-03,  ..., 3.7104e-08, 1.0249e-05,
        2.6089e-05])
[[1379   44   70   39]
 [  17 1463   16   11]
 [  44    6 1343  107]
 [  39   13  139 1350]]
Figure(640x480)
tensor([1.2137e-06, 7.3476e-08, 3.6984e-07,  ..., 9.8232e-08, 2.4905e-06,
        2.1334e-07])
[[1380   44   68   40]
 [  21 1460   16   10]
 [  45    6 1343  106]
 [  40   13  141 1347]]
Figure(640x480)
tensor([7.9433e-07, 8.9269e-08, 3.6926e-07,  ..., 2.2082e-07, 1.1851e-06,
        2.1039e-07])
[[1377   45   68   42]
 [  22 1458   17   10]
 [  41    8 1345  106]
 [  38   14  138 1351]]
Figure(640x480)
tensor([2.5785e-07, 7.2621e-08, 2.0322e-07,  ..., 1.3381e-06, 4.3603e-07,
        1.3988e-07])
[[1382   43   68   39]
 [  26 1454   17   10]
 [  42    9 1347  102]
 [  41   12  146 1342]]
Figure(640x480)
tensor([3.4276e-07, 3.4209e-07, 6.7104e-07,  ..., 1.2250e-06, 2.1259e-06,
        8.7685e-08])
