total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.249975 (29997/120000), AUC 0.443223774433136
ep0_train_time 8.551278352737427
Test Epoch0 threshold 0.4 Acc 0.9008223684210527, AUC 0.9739695191383362, avg_entr 0.17812392115592957
ep0_t0.4_test_time 0.2519569396972656
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.3594161868095398
ep1_train_time 8.037879467010498
Test Epoch1 threshold 0.4 Acc 0.9139802631578947, AUC 0.9779005646705627, avg_entr 0.10255420207977295
ep1_t0.4_test_time 0.2545962333679199
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.34566447138786316
ep2_train_time 8.024224281311035
Test Epoch2 threshold 0.4 Acc 0.9146381578947368, AUC 0.9794924855232239, avg_entr 0.07937349379062653
ep2_t0.4_test_time 0.2537508010864258
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.34294331073760986
ep3_train_time 8.14879822731018
Test Epoch3 threshold 0.4 Acc 0.9148026315789474, AUC 0.9802443385124207, avg_entr 0.06799145042896271
ep3_t0.4_test_time 0.25031208992004395
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24999166666666667 (29999/120000), AUC 0.3422326445579529
ep4_train_time 8.123980045318604
Test Epoch4 threshold 0.4 Acc 0.9164473684210527, AUC 0.980498194694519, avg_entr 0.05832865834236145
ep4_t0.4_test_time 0.24989104270935059
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24999166666666667 (29999/120000), AUC 0.3429090976715088
ep5_train_time 8.196444988250732
Test Epoch5 threshold 0.4 Acc 0.9149671052631579, AUC 0.9806646704673767, avg_entr 0.053184229880571365
ep5_t0.4_test_time 0.25763869285583496
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24995833333333334 (29995/120000), AUC 0.3445381224155426
ep6_train_time 8.21147108078003
Test Epoch6 threshold 0.4 Acc 0.9167763157894737, AUC 0.9807146191596985, avg_entr 0.04827657341957092
ep6_t0.4_test_time 0.2533838748931885
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.24995833333333334 (29995/120000), AUC 0.3452819585800171
ep7_train_time 8.107074975967407
Test Epoch7 threshold 0.4 Acc 0.9164473684210527, AUC 0.9806960821151733, avg_entr 0.04582737758755684
ep7_t0.4_test_time 0.24947762489318848
gc 0
Train Epoch8 Acc 0.249975 (29997/120000), AUC 0.34675249457359314
ep8_train_time 8.152798414230347
Test Epoch8 threshold 0.4 Acc 0.9162828947368421, AUC 0.9805731773376465, avg_entr 0.04313445836305618
ep8_t0.4_test_time 0.2502925395965576
gc 0
Train Epoch9 Acc 0.249975 (29997/120000), AUC 0.3478139638900757
ep9_train_time 8.116498231887817
Test Epoch9 threshold 0.4 Acc 0.9159539473684211, AUC 0.9804292917251587, avg_entr 0.03980065509676933
ep9_t0.4_test_time 0.25072813034057617
Best AUC 0.9807146191596985
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt
[[1363   54   77   38]
 [  10 1480    5   12]
 [  36   12 1325  127]
 [  35   11   89 1406]]
Figure(640x480)
tensor([0.0408, 0.0004, 0.0084,  ..., 0.0005, 0.0018, 0.0330])
[[   0    0    0 1532]
 [   0    0    0 1507]
 [   0    0    0 1500]
 [   0    0    0 1541]]
Figure(640x480)
tensor([0.9519, 1.0291, 1.0136,  ..., 0.9849, 0.9996, 1.0431])
[[   0    0 1532    0]
 [   0    0 1507    0]
 [   0    0 1500    0]
 [   0    0 1541    0]]
Figure(640x480)
tensor([1.1794, 1.1625, 1.1656,  ..., 1.1885, 1.2007, 1.1971])
[[   0    0 1532    0]
 [   0    0 1507    0]
 [   0    0 1500    0]
 [   0    0 1541    0]]
Figure(640x480)
tensor([1.1526, 1.1354, 1.1414,  ..., 1.1551, 1.1264, 1.1477])
[[   0 1526    6    0]
 [   0 1507    0    0]
 [   0 1500    0    0]
 [   0 1541    0    0]]
Figure(640x480)
tensor([1.3659, 1.3739, 1.3750,  ..., 1.3854, 1.3765, 1.3905])
