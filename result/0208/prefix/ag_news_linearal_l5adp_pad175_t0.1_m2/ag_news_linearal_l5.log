total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.25105833333333333 (30127/120000), AUC 0.5380624532699585
ep0_train_time 9.05871868133545
Test Epoch0 threshold 0.1 Acc 0.9162828947368421, AUC 0.9806333780288696, avg_entr 0.02653573453426361
ep0_t0.1_test_time 0.2682626247406006
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.5552047491073608
ep1_train_time 8.671924591064453
Test Epoch1 threshold 0.1 Acc 0.9162828947368421, AUC 0.9806311726570129, avg_entr 0.025177383795380592
ep1_t0.1_test_time 0.2662942409515381
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.5488990545272827
ep2_train_time 8.63266634941101
Test Epoch2 threshold 0.1 Acc 0.9149671052631579, AUC 0.9803999066352844, avg_entr 0.025214185938239098
ep2_t0.1_test_time 0.2651958465576172
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5504330396652222
ep3_train_time 8.685792922973633
Test Epoch3 threshold 0.1 Acc 0.9159539473684211, AUC 0.9802990555763245, avg_entr 0.025159670040011406
ep3_t0.1_test_time 0.2658534049987793
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.5513285398483276
ep4_train_time 8.789782762527466
Test Epoch4 threshold 0.1 Acc 0.9134868421052632, AUC 0.9801340103149414, avg_entr 0.024631904438138008
ep4_t0.1_test_time 0.2664675712585449
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.5513627529144287
ep5_train_time 8.668104887008667
Test Epoch5 threshold 0.1 Acc 0.9143092105263158, AUC 0.9800078868865967, avg_entr 0.02492479793727398
ep5_t0.1_test_time 0.26560187339782715
gc 0
Train Epoch6 Acc 0.24999166666666667 (29999/120000), AUC 0.5512943267822266
ep6_train_time 8.871602773666382
Test Epoch6 threshold 0.1 Acc 0.9133223684210526, AUC 0.9799287915229797, avg_entr 0.025329530239105225
ep6_t0.1_test_time 0.2659580707550049
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.5516610145568848
ep7_train_time 8.56730604171753
Test Epoch7 threshold 0.1 Acc 0.9120065789473685, AUC 0.979868471622467, avg_entr 0.02466006763279438
ep7_t0.1_test_time 0.2662923336029053
gc 0
Train Epoch8 Acc 0.24999166666666667 (29999/120000), AUC 0.5524582862854004
ep8_train_time 8.662556409835815
Test Epoch8 threshold 0.1 Acc 0.9129934210526316, AUC 0.979743480682373, avg_entr 0.025039009749889374
ep8_t0.1_test_time 0.2664453983306885
gc 0
Train Epoch9 Acc 0.24999166666666667 (29999/120000), AUC 0.5529524087905884
ep9_train_time 8.825196266174316
Test Epoch9 threshold 0.1 Acc 0.9126644736842106, AUC 0.9796543121337891, avg_entr 0.02534184418618679
ep9_t0.1_test_time 0.26667094230651855
Best AUC 0.9806333780288696
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt
[[1375   51   66   40]
 [  15 1476    3   13]
 [  38   14 1309  139]
 [  34   12   79 1416]]
Figure(640x480)
tensor([2.9432e-03, 1.3754e-06, 6.1143e-05,  ..., 2.4764e-06, 7.9718e-06,
        2.6025e-03])
[[1381   51   64   36]
 [  14 1477    2   14]
 [  41   14 1300  145]
 [  37   14   76 1414]]
Figure(640x480)
tensor([1.8912e-02, 9.4067e-06, 3.0022e-04,  ..., 3.2201e-06, 1.8182e-04,
        4.1484e-03])
[[   0 1522    0   10]
 [   0 1105    0  402]
 [   0 1499    0    1]
 [   0 1540    0    1]]
Figure(640x480)
tensor([1.0890, 1.2154, 1.1618,  ..., 1.2835, 1.1003, 1.1165])
[[   0    0 1532    0]
 [   0    0 1507    0]
 [   0    0 1500    0]
 [   0    0 1541    0]]
Figure(640x480)
tensor([0.9828, 0.9372, 0.9893,  ..., 1.0713, 0.9862, 0.8558])
[[   0    0 1532    0]
 [   0    0 1507    0]
 [   0    0 1500    0]
 [   0    0 1541    0]]
Figure(640x480)
tensor([0.8885, 0.9942, 0.9767,  ..., 0.9979, 0.9698, 0.8165])
