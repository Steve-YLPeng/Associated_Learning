total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.22318333333333334 (26782/120000), AUC 0.4211222529411316
ep0_train_time 8.40095043182373
Test Epoch0 threshold 0.8 Acc 0.8960526315789473, AUC 0.9738511443138123, avg_entr 0.19004279375076294
ep0_t0.8_test_time 0.2510054111480713
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.217 (26040/120000), AUC 0.3567955791950226
ep1_train_time 7.976946830749512
Test Epoch1 threshold 0.8 Acc 0.9085526315789474, AUC 0.978111207485199, avg_entr 0.10922734439373016
ep1_t0.8_test_time 0.2502868175506592
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.22594166666666668 (27113/120000), AUC 0.36604613065719604
ep2_train_time 7.982441186904907
Test Epoch2 threshold 0.8 Acc 0.9123355263157895, AUC 0.9795196056365967, avg_entr 0.08301320672035217
ep2_t0.8_test_time 0.2489933967590332
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.228175 (27381/120000), AUC 0.3742295801639557
ep3_train_time 8.024275064468384
Test Epoch3 threshold 0.8 Acc 0.9139802631578947, AUC 0.9801748991012573, avg_entr 0.06805092841386795
ep3_t0.8_test_time 0.24969720840454102
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.22863333333333333 (27436/120000), AUC 0.38160640001296997
ep4_train_time 8.005869388580322
Test Epoch4 threshold 0.8 Acc 0.9159539473684211, AUC 0.980667233467102, avg_entr 0.05892903730273247
ep4_t0.8_test_time 0.24959993362426758
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.22783333333333333 (27340/120000), AUC 0.38794878125190735
ep5_train_time 8.02664566040039
Test Epoch5 threshold 0.8 Acc 0.9149671052631579, AUC 0.9807411432266235, avg_entr 0.05345747992396355
ep5_t0.8_test_time 0.24901771545410156
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.226075 (27129/120000), AUC 0.3932795822620392
ep6_train_time 8.005414485931396
Test Epoch6 threshold 0.8 Acc 0.9133223684210526, AUC 0.980647623538971, avg_entr 0.05043232440948486
ep6_t0.8_test_time 0.24964451789855957
gc 0
Train Epoch7 Acc 0.22435833333333333 (26923/120000), AUC 0.3981308043003082
ep7_train_time 8.065077066421509
Test Epoch7 threshold 0.8 Acc 0.9154605263157894, AUC 0.9806308150291443, avg_entr 0.04732059687376022
ep7_t0.8_test_time 0.24917149543762207
gc 0
Train Epoch8 Acc 0.22184166666666666 (26621/120000), AUC 0.40254396200180054
ep8_train_time 7.944880247116089
Test Epoch8 threshold 0.8 Acc 0.9154605263157894, AUC 0.9805936813354492, avg_entr 0.043148383498191833
ep8_t0.8_test_time 0.25012636184692383
gc 0
Train Epoch9 Acc 0.220475 (26457/120000), AUC 0.4054891765117645
ep9_train_time 8.0683753490448
Test Epoch9 threshold 0.8 Acc 0.9157894736842105, AUC 0.9805359840393066, avg_entr 0.04131060466170311
ep9_t0.8_test_time 0.2492074966430664
Best AUC 0.9807411432266235
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt
[[331   7  15  15]
 [  0 389   3   1]
 [  5   5 358  32]
 [  3   1  25 330]]
Figure(640x480)
tensor([0.0561, 0.0300, 0.2780,  ..., 0.0468, 0.0014, 0.0475])
[[368   0   0   0]
 [393   0   0   0]
 [400   0   0   0]
 [356   3   0   0]]
Figure(640x480)
tensor([1.1900, 1.2057, 1.1893,  ..., 1.1917, 1.2097, 1.2107])
[[  0 352   0  16]
 [  0  46   0 347]
 [  0 398   0   2]
 [  0 359   0   0]]
Figure(640x480)
tensor([1.3198, 1.3304, 1.3334,  ..., 1.3316, 1.3094, 1.3187])
[[  0   0 368   0]
 [  0   0 393   0]
 [  0   0 400   0]
 [  0   0 359   0]]
Figure(640x480)
tensor([1.2080, 1.2192, 1.2183,  ..., 1.2150, 1.2228, 1.2195])
[[  0 204   0 164]
 [  0  10   0 383]
 [  0  73   0 327]
 [  0  53   0 306]]
Figure(640x480)
tensor([1.3532, 1.3538, 1.3395,  ..., 1.3570, 1.3467, 1.3490])
