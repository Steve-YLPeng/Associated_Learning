total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.47684166666666666 (57221/120000), AUC 0.45455265045166016
ep0_train_time 67.02183651924133
Test Epoch0 threshold 0.9 Acc 0.9133223684210526, AUC 0.9807112216949463, avg_entr 0.025789761915802956
ep0_t0.9_test_time 0.2522745132446289
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.47649166666666665 (57179/120000), AUC 0.4175105690956116
ep1_train_time 66.91104292869568
Test Epoch1 threshold 0.9 Acc 0.9162828947368421, AUC 0.9806085228919983, avg_entr 0.02553842030465603
ep1_t0.9_test_time 0.25174474716186523
gc 0
Train Epoch2 Acc 0.47649166666666665 (57179/120000), AUC 0.4087173342704773
ep2_train_time 66.92669129371643
Test Epoch2 threshold 0.9 Acc 0.9141447368421053, AUC 0.9805192351341248, avg_entr 0.0254519060254097
ep2_t0.9_test_time 0.25023865699768066
gc 0
Train Epoch3 Acc 0.47623333333333334 (57148/120000), AUC 0.3902304470539093
ep3_train_time 67.0526282787323
Test Epoch3 threshold 0.9 Acc 0.9129934210526316, AUC 0.980374276638031, avg_entr 0.02542295679450035
ep3_t0.9_test_time 0.2512226104736328
gc 0
Train Epoch4 Acc 0.4766916666666667 (57203/120000), AUC 0.3766915202140808
ep4_train_time 66.9681224822998
Test Epoch4 threshold 0.9 Acc 0.9149671052631579, AUC 0.9801105260848999, avg_entr 0.025409912690520287
ep4_t0.9_test_time 0.25025177001953125
gc 0
Train Epoch5 Acc 0.4779 (57348/120000), AUC 0.37793904542922974
ep5_train_time 66.92798233032227
Test Epoch5 threshold 0.9 Acc 0.9151315789473684, AUC 0.9801009893417358, avg_entr 0.02572058141231537
ep5_t0.9_test_time 0.25026798248291016
gc 0
Train Epoch6 Acc 0.47829166666666667 (57395/120000), AUC 0.3800978362560272
ep6_train_time 67.05203032493591
Test Epoch6 threshold 0.9 Acc 0.9143092105263158, AUC 0.9800509214401245, avg_entr 0.025833673775196075
ep6_t0.9_test_time 0.24970602989196777
gc 0
Train Epoch7 Acc 0.479275 (57513/120000), AUC 0.3873625099658966
ep7_train_time 66.96984100341797
Test Epoch7 threshold 0.9 Acc 0.9126644736842106, AUC 0.9798736572265625, avg_entr 0.026346394792199135
ep7_t0.9_test_time 0.25042009353637695
gc 0
Train Epoch8 Acc 0.4796 (57552/120000), AUC 0.39841076731681824
ep8_train_time 67.08390426635742
Test Epoch8 threshold 0.9 Acc 0.9116776315789473, AUC 0.9797722101211548, avg_entr 0.025384915992617607
ep8_t0.9_test_time 0.24978041648864746
gc 0
Train Epoch9 Acc 0.480525 (57663/120000), AUC 0.40290069580078125
ep9_train_time 66.9985511302948
Test Epoch9 threshold 0.9 Acc 0.9125, AUC 0.9796688556671143, avg_entr 0.025684956461191177
ep9_t0.9_test_time 0.2510397434234619
Best AUC 0.9807112216949463
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.9_m3//ag_news_lstmal_l5_prefix.pt
[[329   7  18  14]
 [  0 388   4   1]
 [  5   5 367  23]
 [  3   1  33 322]]
Figure(640x480)
tensor([9.5206e-04, 6.0140e-03, 1.4610e-01,  ..., 2.3462e-02, 2.4816e-07,
        9.5969e-05])
[[335   6   9  18]
 [  1 387   4   1]
 [ 13   1 350  36]
 [  5   0  23 331]]
Figure(640x480)
tensor([8.0240e-07, 3.2948e-06, 8.1839e-06,  ..., 5.4242e-07, 2.0729e-07,
        8.1352e-06])
[[333   6  12  17]
 [  1 387   4   1]
 [ 12   1 350  37]
 [  6   0  22 331]]
Figure(640x480)
tensor([6.8662e-07, 3.1549e-06, 1.1133e-05,  ..., 6.0996e-07, 2.7757e-07,
        7.0635e-06])
[[  0   1 344  23]
 [ 13   0 370  10]
 [  0  10  21 369]
 [  0   1   9 349]]
Figure(640x480)
tensor([1.3588, 1.2387, 1.2870,  ..., 1.0443, 1.1399, 1.3057])
[[342   0   0  26]
 [  5   0   0 388]
 [361   0   0  39]
 [ 27   0   0 332]]
Figure(640x480)
tensor([0.9021, 1.0458, 1.0006,  ..., 0.9026, 0.8392, 1.0121])
