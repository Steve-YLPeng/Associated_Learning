total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m1//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.23800833333333332 (28561/120000), AUC 0.6829113364219666
ep0_train_time 56.20980381965637
Test Epoch0 threshold 0.7 Acc 0.9167763157894737, AUC 0.9810454249382019, avg_entr 0.02876112423837185
ep0_t0.7_test_time 0.2540566921234131
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m2//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.37925 (45510/120000), AUC 0.7503256797790527
ep1_train_time 56.00976061820984
Test Epoch1 threshold 0.7 Acc 0.9159539473684211, AUC 0.9810742139816284, avg_entr 0.027529768645763397
ep1_t0.7_test_time 0.25304388999938965
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m2//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.42249166666666665 (50699/120000), AUC 0.7479584217071533
ep2_train_time 56.057528495788574
Test Epoch2 threshold 0.7 Acc 0.9159539473684211, AUC 0.9808241128921509, avg_entr 0.026112819090485573
ep2_t0.7_test_time 0.25264739990234375
gc 0
Train Epoch3 Acc 0.438225 (52587/120000), AUC 0.7286490201950073
ep3_train_time 56.10917401313782
Test Epoch3 threshold 0.7 Acc 0.915625, AUC 0.9807347059249878, avg_entr 0.026211535558104515
ep3_t0.7_test_time 0.25270676612854004
gc 0
Train Epoch4 Acc 0.43365 (52038/120000), AUC 0.713122546672821
ep4_train_time 56.034788370132446
Test Epoch4 threshold 0.7 Acc 0.915625, AUC 0.9806308746337891, avg_entr 0.026308298110961914
ep4_t0.7_test_time 0.2520761489868164
gc 0
Train Epoch5 Acc 0.43695833333333334 (52435/120000), AUC 0.7059265375137329
ep5_train_time 55.995551109313965
Test Epoch5 threshold 0.7 Acc 0.9157894736842105, AUC 0.9805353879928589, avg_entr 0.026447586715221405
ep5_t0.7_test_time 0.25235772132873535
gc 0
Train Epoch6 Acc 0.43638333333333335 (52366/120000), AUC 0.6996461749076843
ep6_train_time 56.020753383636475
Test Epoch6 threshold 0.7 Acc 0.9148026315789474, AUC 0.9804184436798096, avg_entr 0.025490546599030495
ep6_t0.7_test_time 0.252697229385376
gc 0
Train Epoch7 Acc 0.4381 (52572/120000), AUC 0.695366621017456
ep7_train_time 55.96106028556824
Test Epoch7 threshold 0.7 Acc 0.9148026315789474, AUC 0.9803297519683838, avg_entr 0.02603803016245365
ep7_t0.7_test_time 0.2516331672668457
gc 0
Train Epoch8 Acc 0.43711666666666665 (52454/120000), AUC 0.6918361186981201
ep8_train_time 56.02138066291809
Test Epoch8 threshold 0.7 Acc 0.915296052631579, AUC 0.9802238345146179, avg_entr 0.025869786739349365
ep8_t0.7_test_time 0.25211048126220703
gc 0
Train Epoch9 Acc 0.43400833333333333 (52081/120000), AUC 0.6881823539733887
ep9_train_time 56.02867794036865
Test Epoch9 threshold 0.7 Acc 0.915296052631579, AUC 0.9801382422447205, avg_entr 0.026160869747400284
ep9_t0.7_test_time 0.2522439956665039
Best AUC 0.9810742139816284
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m2//ag_news_lstmal_l5_prefix.pt
[[334   7  15  12]
 [  0 389   3   1]
 [  6   6 356  32]
 [  5   0  25 329]]
Figure(640x480)
tensor([3.1362e-04, 1.8491e-03, 3.1671e-02,  ..., 1.8070e-02, 1.9951e-06,
        1.3900e-03])
[[340   3  10  15]
 [  2 385   5   1]
 [ 10   2 356  32]
 [  5   1  30 323]]
Figure(640x480)
tensor([1.6939e-06, 2.2990e-05, 1.1764e-04,  ..., 2.2474e-06, 1.5800e-06,
        2.4056e-05])
[[ 11   0   1 356]
 [  2  59 289  43]
 [ 27   1  10 362]
 [310   2  10  37]]
Figure(640x480)
tensor([0.7761, 0.7678, 0.8071,  ..., 1.2592, 1.0701, 1.1523])
[[  1 327  40   0]
 [225 146  22   0]
 [  2 390   8   0]
 [  0 339  20   0]]
Figure(640x480)
tensor([1.0784, 1.0811, 1.2364,  ..., 1.3205, 1.2210, 1.2652])
[[254  93  16   5]
 [  0 323  70   0]
 [  4 336  47  13]
 [  0  21 335   3]]
Figure(640x480)
tensor([1.3190, 1.3787, 1.3461,  ..., 1.1868, 1.4013, 1.4007])
