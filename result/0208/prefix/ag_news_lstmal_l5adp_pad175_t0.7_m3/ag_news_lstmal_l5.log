total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.451625 (54195/120000), AUC 0.7510829567909241
ep0_train_time 66.77134323120117
Test Epoch0 threshold 0.7 Acc 0.9164473684210527, AUC 0.9807842969894409, avg_entr 0.02650018408894539
ep0_t0.7_test_time 0.25091028213500977
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.480525 (57663/120000), AUC 0.7884581089019775
ep1_train_time 66.84042096138
Test Epoch1 threshold 0.7 Acc 0.9148026315789474, AUC 0.9808483719825745, avg_entr 0.02572696842253208
ep1_t0.7_test_time 0.24868416786193848
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m3//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.48215 (57858/120000), AUC 0.7714200019836426
ep2_train_time 66.81482696533203
Test Epoch2 threshold 0.7 Acc 0.915296052631579, AUC 0.9806690812110901, avg_entr 0.02562209591269493
ep2_t0.7_test_time 0.24971485137939453
gc 0
Train Epoch3 Acc 0.485825 (58299/120000), AUC 0.7549895644187927
ep3_train_time 66.98092341423035
Test Epoch3 threshold 0.7 Acc 0.9136513157894737, AUC 0.9805129766464233, avg_entr 0.02527133747935295
ep3_t0.7_test_time 0.24906539916992188
gc 0
Train Epoch4 Acc 0.49659166666666665 (59591/120000), AUC 0.735396146774292
ep4_train_time 66.90967798233032
Test Epoch4 threshold 0.7 Acc 0.9146381578947368, AUC 0.9803117513656616, avg_entr 0.02544446475803852
ep4_t0.7_test_time 0.24927830696105957
gc 0
Train Epoch5 Acc 0.5063833333333333 (60766/120000), AUC 0.7256606817245483
ep5_train_time 66.86818075180054
Test Epoch5 threshold 0.7 Acc 0.9141447368421053, AUC 0.9802528023719788, avg_entr 0.025573035702109337
ep5_t0.7_test_time 0.2499096393585205
gc 0
Train Epoch6 Acc 0.5138916666666666 (61667/120000), AUC 0.7201354503631592
ep6_train_time 66.8227117061615
Test Epoch6 threshold 0.7 Acc 0.9151315789473684, AUC 0.9801034927368164, avg_entr 0.026233244687318802
ep6_t0.7_test_time 0.2499699592590332
gc 0
Train Epoch7 Acc 0.505525 (60663/120000), AUC 0.7127176523208618
ep7_train_time 66.86598610877991
Test Epoch7 threshold 0.7 Acc 0.9131578947368421, AUC 0.9800047874450684, avg_entr 0.026317063719034195
ep7_t0.7_test_time 0.24903440475463867
gc 0
Train Epoch8 Acc 0.5117166666666667 (61406/120000), AUC 0.707687258720398
ep8_train_time 66.8449547290802
Test Epoch8 threshold 0.7 Acc 0.9136513157894737, AUC 0.979849100112915, avg_entr 0.02598886750638485
ep8_t0.7_test_time 0.24980854988098145
gc 0
Train Epoch9 Acc 0.516525 (61983/120000), AUC 0.7071728706359863
ep9_train_time 66.8803722858429
Test Epoch9 threshold 0.7 Acc 0.9139802631578947, AUC 0.9798368811607361, avg_entr 0.026658447459340096
ep9_t0.7_test_time 0.2481529712677002
Best AUC 0.9808483719825745
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.7_m3//ag_news_lstmal_l5_prefix.pt
[[333   7  15  13]
 [  0 388   4   1]
 [  5   5 366  24]
 [  5   0  30 324]]
Figure(640x480)
tensor([2.0665e-04, 3.7714e-03, 9.6739e-02,  ..., 3.9414e-02, 1.2522e-07,
        2.6413e-04])
[[337   4  11  16]
 [  1 387   4   1]
 [ 10   2 359  29]
 [  6   1  34 318]]
Figure(640x480)
tensor([4.0207e-07, 7.5095e-06, 1.3870e-04,  ..., 4.1698e-07, 1.0233e-07,
        3.8824e-07])
[[338   4  11  15]
 [  1 388   4   0]
 [ 13   2 358  27]
 [  6   1  33 319]]
Figure(640x480)
tensor([3.9874e-07, 1.4394e-05, 1.1364e-04,  ..., 4.3578e-07, 1.4347e-07,
        6.9833e-07])
[[  0   8 343  17]
 [  0  13  10 370]
 [  0   1 367  32]
 [  0   1  38 320]]
Figure(640x480)
tensor([0.9500, 0.9069, 0.9844,  ..., 1.2032, 0.9492, 0.8515])
[[338   6  24   0]
 [ 25   1 367   0]
 [  9   7 384   0]
 [  6   0 353   0]]
Figure(640x480)
tensor([0.8232, 0.8749, 0.8464,  ..., 0.9250, 0.6774, 0.6884])
