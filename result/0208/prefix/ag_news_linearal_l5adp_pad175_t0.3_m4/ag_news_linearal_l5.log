total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.054641666666666665 (6557/120000), AUC 0.5128708481788635
ep0_train_time 9.831329107284546
Test Epoch0 threshold 0.3 Acc 0.9154605263157894, AUC 0.9807635545730591, avg_entr 0.025486880913376808
ep0_t0.3_test_time 0.26744627952575684
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.07625 (9150/120000), AUC 0.5419811606407166
ep1_train_time 9.475811243057251
Test Epoch1 threshold 0.3 Acc 0.915625, AUC 0.9809015393257141, avg_entr 0.025377238169312477
ep1_t0.3_test_time 0.26648736000061035
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.13721666666666665 (16466/120000), AUC 0.6295173168182373
ep2_train_time 9.540219068527222
Test Epoch2 threshold 0.3 Acc 0.9121710526315789, AUC 0.9807335138320923, avg_entr 0.02581099234521389
ep2_t0.3_test_time 0.26615405082702637
gc 0
Train Epoch3 Acc 0.1273 (15276/120000), AUC 0.6583163738250732
ep3_train_time 9.480309963226318
Test Epoch3 threshold 0.3 Acc 0.9139802631578947, AUC 0.9805848598480225, avg_entr 0.024873312562704086
ep3_t0.3_test_time 0.26219606399536133
gc 0
Train Epoch4 Acc 0.08825 (10590/120000), AUC 0.6528629064559937
ep4_train_time 9.493395805358887
Test Epoch4 threshold 0.3 Acc 0.9123355263157895, AUC 0.9803098440170288, avg_entr 0.02567206881940365
ep4_t0.3_test_time 0.2638864517211914
gc 0
Train Epoch5 Acc 0.09218333333333334 (11062/120000), AUC 0.6559375524520874
ep5_train_time 9.518181562423706
Test Epoch5 threshold 0.3 Acc 0.9129934210526316, AUC 0.980211079120636, avg_entr 0.024817168712615967
ep5_t0.3_test_time 0.2631235122680664
gc 0
Train Epoch6 Acc 0.101625 (12195/120000), AUC 0.6526393890380859
ep6_train_time 9.526459455490112
Test Epoch6 threshold 0.3 Acc 0.9133223684210526, AUC 0.9801146984100342, avg_entr 0.02527630515396595
ep6_t0.3_test_time 0.26284337043762207
gc 0
Train Epoch7 Acc 0.10581666666666667 (12698/120000), AUC 0.6474212408065796
ep7_train_time 9.470824003219604
Test Epoch7 threshold 0.3 Acc 0.9138157894736842, AUC 0.9800287485122681, avg_entr 0.025210635736584663
ep7_t0.3_test_time 0.2615020275115967
gc 0
Train Epoch8 Acc 0.11185 (13422/120000), AUC 0.6438567638397217
ep8_train_time 9.470628499984741
Test Epoch8 threshold 0.3 Acc 0.9116776315789473, AUC 0.9798034429550171, avg_entr 0.026024717837572098
ep8_t0.3_test_time 0.26213979721069336
gc 0
Train Epoch9 Acc 0.11709166666666666 (14051/120000), AUC 0.6399707198143005
ep9_train_time 9.451404094696045
Test Epoch9 threshold 0.3 Acc 0.9115131578947369, AUC 0.9798116683959961, avg_entr 0.024844523519277573
ep9_t0.3_test_time 0.26026201248168945
Best AUC 0.9809015393257141
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt
[[1369   52   74   37]
 [  11 1476    9   11]
 [  35   13 1333  119]
 [  34   13  106 1388]]
Figure(640x480)
tensor([1.1814e-03, 7.5010e-08, 6.0720e-05,  ..., 3.3170e-08, 3.8893e-06,
        1.2033e-04])
[[1368   52   74   38]
 [  12 1476    8   11]
 [  33   14 1334  119]
 [  34   13  105 1389]]
Figure(640x480)
tensor([7.1733e-04, 1.2733e-06, 1.3647e-04,  ..., 4.0912e-08, 3.2318e-06,
        4.2021e-04])
[[1368   52   74   38]
 [  11 1477    8   11]
 [  34   14 1334  118]
 [  33   13  110 1385]]
Figure(640x480)
tensor([6.4158e-04, 6.1451e-07, 5.9747e-05,  ..., 4.2303e-08, 2.6968e-06,
        6.1321e-05])
[[1370   52   71   39]
 [  11 1477    8   11]
 [  32   14 1326  128]
 [  33   12   97 1399]]
Figure(640x480)
tensor([3.0647e-04, 6.0952e-08, 3.4630e-05,  ..., 4.9386e-08, 1.4911e-06,
        1.5289e-04])
[[ 163   95 1143  131]
 [ 672  667  166    2]
 [   1  247   19 1233]
 [   2 1477   17   45]]
Figure(640x480)
tensor([0.6515, 0.5154, 0.6444,  ..., 0.7853, 0.6994, 0.4492])
