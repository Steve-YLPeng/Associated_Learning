total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.24830833333333333 (29797/120000), AUC 0.5778939127922058
ep0_train_time 77.38837027549744
Test Epoch0 threshold 0.6 Acc 0.9159539473684211, AUC 0.9805247187614441, avg_entr 0.025169413536787033
ep0_t0.6_test_time 0.25128769874572754
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24645833333333333 (29575/120000), AUC 0.4529024660587311
ep1_train_time 77.47387361526489
Test Epoch1 threshold 0.6 Acc 0.9154605263157894, AUC 0.9802824258804321, avg_entr 0.025516653433442116
ep1_t0.6_test_time 0.2493727207183838
gc 0
Train Epoch2 Acc 0.24668333333333334 (29602/120000), AUC 0.43171244859695435
ep2_train_time 77.49838924407959
Test Epoch2 threshold 0.6 Acc 0.9151315789473684, AUC 0.9801777601242065, avg_entr 0.025506475940346718
ep2_t0.6_test_time 0.24955320358276367
gc 0
Train Epoch3 Acc 0.24655 (29586/120000), AUC 0.42702749371528625
ep3_train_time 77.48738884925842
Test Epoch3 threshold 0.6 Acc 0.9154605263157894, AUC 0.9800244569778442, avg_entr 0.024952366948127747
ep3_t0.6_test_time 0.24955439567565918
gc 0
Train Epoch4 Acc 0.246425 (29571/120000), AUC 0.42639535665512085
ep4_train_time 77.39115166664124
Test Epoch4 threshold 0.6 Acc 0.9121710526315789, AUC 0.979830801486969, avg_entr 0.026808831840753555
ep4_t0.6_test_time 0.2495863437652588
gc 0
Train Epoch5 Acc 0.246075 (29529/120000), AUC 0.40843480825424194
ep5_train_time 77.50791358947754
Test Epoch5 threshold 0.6 Acc 0.9143092105263158, AUC 0.9797935485839844, avg_entr 0.0255372766405344
ep5_t0.6_test_time 0.24913287162780762
gc 0
Train Epoch6 Acc 0.24616666666666667 (29540/120000), AUC 0.39366012811660767
ep6_train_time 77.61135983467102
Test Epoch6 threshold 0.6 Acc 0.9116776315789473, AUC 0.979641318321228, avg_entr 0.025095783174037933
ep6_t0.6_test_time 0.2497851848602295
gc 0
Train Epoch7 Acc 0.24549166666666666 (29459/120000), AUC 0.38525837659835815
ep7_train_time 77.5607967376709
Test Epoch7 threshold 0.6 Acc 0.912828947368421, AUC 0.9796341061592102, avg_entr 0.02617533504962921
ep7_t0.6_test_time 0.24982166290283203
gc 0
Train Epoch8 Acc 0.24526666666666666 (29432/120000), AUC 0.3747095465660095
ep8_train_time 77.63719892501831
Test Epoch8 threshold 0.6 Acc 0.9133223684210526, AUC 0.9795512557029724, avg_entr 0.025426575914025307
ep8_t0.6_test_time 0.24860119819641113
gc 0
Train Epoch9 Acc 0.242875 (29145/120000), AUC 0.35814762115478516
ep9_train_time 77.47734379768372
Test Epoch9 threshold 0.6 Acc 0.912828947368421, AUC 0.979455828666687, avg_entr 0.02628919668495655
ep9_t0.6_test_time 0.24872779846191406
Best AUC 0.9805247187614441
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.6_m4//ag_news_lstmal_l5_prefix.pt
[[328   7  17  16]
 [  0 389   3   1]
 [  8   7 357  28]
 [  4   1  28 326]]
Figure(640x480)
tensor([7.5561e-05, 1.2281e-03, 8.5845e-02,  ..., 1.0872e-02, 1.5348e-07,
        6.2187e-04])
[[334   5  12  17]
 [  1 388   3   1]
 [  7   3 359  31]
 [  5   1  29 324]]
Figure(640x480)
tensor([2.8068e-07, 1.4007e-04, 3.2928e-05,  ..., 5.4027e-07, 2.4439e-07,
        1.3593e-06])
[[333   5  12  18]
 [  1 389   3   0]
 [  7   2 362  29]
 [  5   1  29 324]]
Figure(640x480)
tensor([3.6961e-07, 6.1292e-05, 2.0637e-05,  ..., 4.4612e-07, 2.6901e-07,
        1.5668e-06])
[[332   7  12  17]
 [  1 389   3   0]
 [  7   2 362  29]
 [  6   0  30 323]]
Figure(640x480)
tensor([5.0500e-07, 1.8663e-04, 3.5516e-05,  ..., 4.4238e-07, 9.8403e-07,
        1.6693e-06])
[[  0 325  43   0]
 [  0   0 223 170]
 [  0   7 393   0]
 [  0   2 357   0]]
Figure(640x480)
tensor([0.9913, 0.9047, 0.9557,  ..., 0.8924, 0.8248, 0.8433])
