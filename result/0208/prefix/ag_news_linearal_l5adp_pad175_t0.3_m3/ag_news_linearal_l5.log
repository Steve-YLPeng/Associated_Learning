total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.2614 (31368/120000), AUC 0.4644731879234314
ep0_train_time 9.535462617874146
Test Epoch0 threshold 0.3 Acc 0.9161184210526315, AUC 0.9811232089996338, avg_entr 0.02617458626627922
ep0_t0.3_test_time 0.2632789611816406
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.15684166666666666 (18821/120000), AUC 0.4279162585735321
ep1_train_time 8.985408782958984
Test Epoch1 threshold 0.3 Acc 0.915625, AUC 0.9811132550239563, avg_entr 0.02685801312327385
ep1_t0.3_test_time 0.26078200340270996
gc 0
Train Epoch2 Acc 0.107825 (12939/120000), AUC 0.3991982936859131
ep2_train_time 9.051355600357056
Test Epoch2 threshold 0.3 Acc 0.9154605263157894, AUC 0.9808196425437927, avg_entr 0.026920223608613014
ep2_t0.3_test_time 0.25959157943725586
gc 0
Train Epoch3 Acc 0.07499166666666666 (8999/120000), AUC 0.3580975830554962
ep3_train_time 9.009185314178467
Test Epoch3 threshold 0.3 Acc 0.9144736842105263, AUC 0.9806671142578125, avg_entr 0.02609255351126194
ep3_t0.3_test_time 0.25971198081970215
gc 0
Train Epoch4 Acc 0.0454 (5448/120000), AUC 0.297197550535202
ep4_train_time 9.039558410644531
Test Epoch4 threshold 0.3 Acc 0.9103618421052632, AUC 0.9805049896240234, avg_entr 0.025146635249257088
ep4_t0.3_test_time 0.25889039039611816
gc 0
Train Epoch5 Acc 0.036708333333333336 (4405/120000), AUC 0.2440607249736786
ep5_train_time 9.002005100250244
Test Epoch5 threshold 0.3 Acc 0.9148026315789474, AUC 0.9804445505142212, avg_entr 0.025729402899742126
ep5_t0.3_test_time 0.25838565826416016
gc 0
Train Epoch6 Acc 0.038675 (4641/120000), AUC 0.21820324659347534
ep6_train_time 9.01164174079895
Test Epoch6 threshold 0.3 Acc 0.9125, AUC 0.9802048206329346, avg_entr 0.02573488838970661
ep6_t0.3_test_time 0.25794124603271484
gc 0
Train Epoch7 Acc 0.042366666666666664 (5084/120000), AUC 0.19629457592964172
ep7_train_time 9.063998699188232
Test Epoch7 threshold 0.3 Acc 0.9144736842105263, AUC 0.9801953434944153, avg_entr 0.025101864710450172
ep7_t0.3_test_time 0.2586205005645752
gc 0
Train Epoch8 Acc 0.04214166666666667 (5057/120000), AUC 0.16876190900802612
ep8_train_time 9.107593536376953
Test Epoch8 threshold 0.3 Acc 0.9123355263157895, AUC 0.9800297021865845, avg_entr 0.026616491377353668
ep8_t0.3_test_time 0.25644898414611816
gc 0
Train Epoch9 Acc 0.037575 (4509/120000), AUC 0.14390268921852112
ep9_train_time 9.11733865737915
Test Epoch9 threshold 0.3 Acc 0.9131578947368421, AUC 0.9799891114234924, avg_entr 0.02615407481789589
ep9_t0.3_test_time 0.26101064682006836
Best AUC 0.9811232089996338
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt
[[1380   50   68   34]
 [  18 1473    3   13]
 [  40   14 1316  130]
 [  40   13   86 1402]]
Figure(640x480)
tensor([2.9437e-03, 2.2341e-07, 3.5693e-05,  ..., 1.6012e-07, 5.0909e-06,
        1.8112e-04])
[[1380   50   70   32]
 [  15 1477    3   12]
 [  41   13 1318  128]
 [  41   14   89 1397]]
Figure(640x480)
tensor([2.8097e-03, 3.3805e-06, 6.8751e-05,  ..., 2.0156e-07, 4.3829e-06,
        5.7480e-04])
[[1382   50   66   34]
 [  16 1477    2   12]
 [  40   13 1321  126]
 [  39   14   94 1394]]
Figure(640x480)
tensor([3.7236e-03, 3.1911e-06, 5.3440e-05,  ..., 2.1343e-07, 3.6039e-06,
        1.7240e-04])
[[   1  192 1339    0]
 [  14    0 1493    0]
 [  30   21 1449    0]
 [   0    0 1541    0]]
Figure(640x480)
tensor([0.5035, 0.1008, 0.2116,  ..., 0.4405, 0.0962, 0.6015])
[[   0 1457   69    6]
 [   0  676  831    0]
 [   0  230  713  557]
 [   0 1453   83    5]]
Figure(640x480)
tensor([1.2134, 0.1439, 0.2455,  ..., 0.3134, 0.2880, 1.0265])
