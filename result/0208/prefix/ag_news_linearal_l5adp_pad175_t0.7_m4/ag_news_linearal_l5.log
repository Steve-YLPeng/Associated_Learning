total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.12308333333333334 (14770/120000), AUC 0.5984025001525879
ep0_train_time 10.081657886505127
Test Epoch0 threshold 0.7 Acc 0.9146381578947368, AUC 0.9805774688720703, avg_entr 0.02580440416932106
ep0_t0.7_test_time 0.25608325004577637
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.176825 (21219/120000), AUC 0.5205394625663757
ep1_train_time 9.519876718521118
Test Epoch1 threshold 0.7 Acc 0.9129934210526316, AUC 0.9804580211639404, avg_entr 0.025336619466543198
ep1_t0.7_test_time 0.25731945037841797
gc 0
Train Epoch2 Acc 0.206075 (24729/120000), AUC 0.428331583738327
ep2_train_time 9.506820440292358
Test Epoch2 threshold 0.7 Acc 0.9144736842105263, AUC 0.9803717136383057, avg_entr 0.026270011439919472
ep2_t0.7_test_time 0.2534604072570801
gc 0
Train Epoch3 Acc 0.195125 (23415/120000), AUC 0.3826568126678467
ep3_train_time 9.548050165176392
Test Epoch3 threshold 0.7 Acc 0.9133223684210526, AUC 0.9802960157394409, avg_entr 0.02610664628446102
ep3_t0.7_test_time 0.2533681392669678
gc 0
Train Epoch4 Acc 0.18990833333333335 (22789/120000), AUC 0.3454570770263672
ep4_train_time 9.467166423797607
Test Epoch4 threshold 0.7 Acc 0.912828947368421, AUC 0.9800633788108826, avg_entr 0.024552082642912865
ep4_t0.7_test_time 0.25412845611572266
gc 0
Train Epoch5 Acc 0.198275 (23793/120000), AUC 0.33293959498405457
ep5_train_time 9.54410457611084
Test Epoch5 threshold 0.7 Acc 0.9134868421052632, AUC 0.980039119720459, avg_entr 0.02587030827999115
ep5_t0.7_test_time 0.2539398670196533
gc 0
Train Epoch6 Acc 0.20161666666666667 (24194/120000), AUC 0.3284979462623596
ep6_train_time 9.571378231048584
Test Epoch6 threshold 0.7 Acc 0.9141447368421053, AUC 0.9799511432647705, avg_entr 0.025696879252791405
ep6_t0.7_test_time 0.254427433013916
gc 0
Train Epoch7 Acc 0.20254166666666668 (24305/120000), AUC 0.32368203997612
ep7_train_time 9.539064645767212
Test Epoch7 threshold 0.7 Acc 0.9125, AUC 0.979877769947052, avg_entr 0.026046087965369225
ep7_t0.7_test_time 0.25536131858825684
gc 0
Train Epoch8 Acc 0.20068333333333332 (24082/120000), AUC 0.3183154761791229
ep8_train_time 9.58985185623169
Test Epoch8 threshold 0.7 Acc 0.9118421052631579, AUC 0.9796748161315918, avg_entr 0.02599729225039482
ep8_t0.7_test_time 0.25459885597229004
gc 0
Train Epoch9 Acc 0.199 (23880/120000), AUC 0.3141592741012573
ep9_train_time 9.543959140777588
Test Epoch9 threshold 0.7 Acc 0.9106907894736842, AUC 0.9796122908592224, avg_entr 0.025796297937631607
ep9_t0.7_test_time 0.2540102005004883
Best AUC 0.9805774688720703
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt
[[333   6  15  14]
 [  0 389   3   1]
 [  7   5 362  26]
 [  4   1  27 327]]
Figure(640x480)
tensor([1.6303e-04, 1.9810e-03, 1.2740e-01,  ..., 7.2975e-02, 1.1330e-07,
        1.1613e-04])
[[334   6  14  14]
 [  0 389   3   1]
 [  6   5 363  26]
 [  5   1  27 326]]
Figure(640x480)
tensor([1.5922e-04, 6.4057e-04, 7.7722e-02,  ..., 6.8068e-02, 1.6321e-07,
        2.5822e-04])
[[335   5  14  14]
 [  0 389   3   1]
 [  7   5 362  26]
 [  5   1  25 328]]
Figure(640x480)
tensor([1.3034e-04, 4.4707e-04, 4.1752e-02,  ..., 4.3297e-02, 1.2170e-07,
        1.7090e-04])
[[335   5  14  14]
 [  0 389   3   1]
 [  6   5 363  26]
 [  5   1  25 328]]
Figure(640x480)
tensor([1.1291e-04, 4.2345e-04, 5.2149e-02,  ..., 2.9720e-02, 1.8168e-07,
        1.5913e-04])
[[  0 368   0   0]
 [  2  41 350   0]
 [  0 248 152   0]
 [  0 356   3   0]]
Figure(640x480)
tensor([0.8543, 0.9783, 0.8290,  ..., 0.7741, 0.7321, 1.1128])
