total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.245425 (29451/120000), AUC 0.5420317649841309
ep0_train_time 8.616411685943604
Test Epoch0 threshold 0.6 Acc 0.8955592105263158, AUC 0.9740873575210571, avg_entr 0.18138845264911652
ep0_t0.6_test_time 0.2522850036621094
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24995 (29994/120000), AUC 0.5985081791877747
ep1_train_time 7.969696283340454
Test Epoch1 threshold 0.6 Acc 0.9103618421052632, AUC 0.9779024124145508, avg_entr 0.10451308637857437
ep1_t0.6_test_time 0.2496650218963623
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24998333333333334 (29998/120000), AUC 0.5970987677574158
ep2_train_time 8.039941549301147
Test Epoch2 threshold 0.6 Acc 0.915625, AUC 0.9794902801513672, avg_entr 0.078521728515625
ep2_t0.6_test_time 0.2500953674316406
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5947129726409912
ep3_train_time 8.146027326583862
Test Epoch3 threshold 0.6 Acc 0.9136513157894737, AUC 0.9803155064582825, avg_entr 0.06815917044878006
ep3_t0.6_test_time 0.24945998191833496
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.5924264192581177
ep4_train_time 7.928769111633301
Test Epoch4 threshold 0.6 Acc 0.9154605263157894, AUC 0.9805904626846313, avg_entr 0.05934152007102966
ep4_t0.6_test_time 0.24965476989746094
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24999166666666667 (29999/120000), AUC 0.5910002589225769
ep5_train_time 7.99273681640625
Test Epoch5 threshold 0.6 Acc 0.9169407894736842, AUC 0.9806802272796631, avg_entr 0.05307630077004433
ep5_t0.6_test_time 0.2496802806854248
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24999166666666667 (29999/120000), AUC 0.5887770652770996
ep6_train_time 7.956032037734985
Test Epoch6 threshold 0.6 Acc 0.9162828947368421, AUC 0.9807806015014648, avg_entr 0.05014413967728615
ep6_t0.6_test_time 0.24908924102783203
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.24998333333333334 (29998/120000), AUC 0.5879335403442383
ep7_train_time 7.977290153503418
Test Epoch7 threshold 0.6 Acc 0.9164473684210527, AUC 0.980718195438385, avg_entr 0.045051854103803635
ep7_t0.6_test_time 0.2491295337677002
gc 0
Train Epoch8 Acc 0.24998333333333334 (29998/120000), AUC 0.5868421196937561
ep8_train_time 7.9911134243011475
Test Epoch8 threshold 0.6 Acc 0.9167763157894737, AUC 0.9808029532432556, avg_entr 0.04334072396159172
ep8_t0.6_test_time 0.24960017204284668
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.24999166666666667 (29999/120000), AUC 0.5865203142166138
ep9_train_time 8.028318643569946
Test Epoch9 threshold 0.6 Acc 0.915625, AUC 0.9805375933647156, avg_entr 0.03933677077293396
ep9_t0.6_test_time 0.24943923950195312
Best AUC 0.9808029532432556
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt
[[330   5  18  15]
 [  0 388   4   1]
 [  5   4 361  30]
 [  3   1  28 327]]
Figure(640x480)
tensor([0.0042, 0.0123, 0.1755,  ..., 0.0810, 0.0002, 0.0038])
[[  0   0 368   0]
 [  0   0 393   0]
 [  0   0 400   0]
 [  0   0 358   1]]
Figure(640x480)
tensor([0.8979, 0.9335, 0.9096,  ..., 0.9461, 0.9030, 0.9118])
[[ 16   0   0 352]
 [  0   0   0 393]
 [  5   0   0 395]
 [ 18   0   2 339]]
Figure(640x480)
tensor([1.4424, 1.4478, 1.4451,  ..., 1.4440, 1.4357, 1.4426])
[[368   0   0   0]
 [393   0   0   0]
 [400   0   0   0]
 [359   0   0   0]]
Figure(640x480)
tensor([1.3016, 1.3100, 1.3179,  ..., 1.3156, 1.2691, 1.2920])
[[  0   0 368   0]
 [  0   0 393   0]
 [  0   0 400   0]
 [  0   0 359   0]]
Figure(640x480)
tensor([1.3636, 1.3527, 1.3421,  ..., 1.3626, 1.3031, 1.3403])
