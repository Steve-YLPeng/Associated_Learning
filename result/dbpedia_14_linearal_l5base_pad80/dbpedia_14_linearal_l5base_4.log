total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 56.82371115684509
Start Training
gc 0
Train Epoch0 Acc 0.8750910714285715 (490051/560000), AUC 0.9857063889503479
ep0_train_time 109.84897446632385
Test Epoch0 layer4 Acc 0.9737142857142858, AUC 0.998543918132782, avg_entr 0.06253837049007416, f1 0.973714292049408
ep0_l4_test_time 2.363967180252075
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9776964285714286 (547510/560000), AUC 0.9987159371376038
ep1_train_time 106.29346060752869
Test Epoch1 layer4 Acc 0.9754571428571429, AUC 0.9985748529434204, avg_entr 0.022610962390899658, f1 0.9754571318626404
ep1_l4_test_time 2.344972610473633
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9796107142857143 (548582/560000), AUC 0.9986335039138794
ep2_train_time 106.88429403305054
Test Epoch2 layer4 Acc 0.9759714285714286, AUC 0.9981440901756287, avg_entr 0.01172175258398056, f1 0.9759714007377625
ep2_l4_test_time 2.3111419677734375
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9804910714285714 (549075/560000), AUC 0.9986030459403992
ep3_train_time 106.2726538181305
Test Epoch3 layer4 Acc 0.9765428571428572, AUC 0.9981456995010376, avg_entr 0.008168200962245464, f1 0.9765428304672241
ep3_l4_test_time 2.3598856925964355
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9812089285714286 (549477/560000), AUC 0.9986805319786072
ep4_train_time 106.47280478477478
Test Epoch4 layer4 Acc 0.9766, AUC 0.9979233145713806, avg_entr 0.006837894208729267, f1 0.9765999913215637
ep4_l4_test_time 2.320683717727661
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9815910714285714 (549691/560000), AUC 0.9987881779670715
ep5_train_time 106.88118267059326
Test Epoch5 layer4 Acc 0.977, AUC 0.9980726838111877, avg_entr 0.0059409476816654205, f1 0.9769999980926514
ep5_l4_test_time 2.3551294803619385
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9819803571428571 (549909/560000), AUC 0.9988840222358704
ep6_train_time 106.23949837684631
Test Epoch6 layer4 Acc 0.9774571428571428, AUC 0.9980546236038208, avg_entr 0.0054691266268491745, f1 0.9774571657180786
ep6_l4_test_time 2.3235557079315186
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9824 (550144/560000), AUC 0.9989274740219116
ep7_train_time 107.00833082199097
Test Epoch7 layer4 Acc 0.9775428571428572, AUC 0.9979720711708069, avg_entr 0.005179932340979576, f1 0.9775428771972656
ep7_l4_test_time 2.288652181625366
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.982775 (550354/560000), AUC 0.9990032911300659
ep8_train_time 106.42788124084473
Test Epoch8 layer4 Acc 0.9776857142857143, AUC 0.9979726672172546, avg_entr 0.004820660222321749, f1 0.9776856899261475
ep8_l4_test_time 2.363600254058838
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9830946428571429 (550533/560000), AUC 0.9989787936210632
ep9_train_time 106.14106321334839
Test Epoch9 layer4 Acc 0.9776285714285714, AUC 0.9979766011238098, avg_entr 0.004495649132877588, f1 0.9776285886764526
ep9_l4_test_time 2.3306679725646973
gc 0
Train Epoch10 Acc 0.9833767857142857 (550691/560000), AUC 0.9990218281745911
ep10_train_time 106.58697009086609
Test Epoch10 layer4 Acc 0.9778571428571429, AUC 0.9979730844497681, avg_entr 0.004263566341251135, f1 0.9778571724891663
ep10_l4_test_time 2.3747787475585938
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9836321428571428 (550834/560000), AUC 0.9990118741989136
ep11_train_time 106.25125885009766
Test Epoch11 layer4 Acc 0.9778285714285714, AUC 0.9979268908500671, avg_entr 0.004387561697512865, f1 0.9778285622596741
ep11_l4_test_time 2.3419106006622314
gc 0
Train Epoch12 Acc 0.9837928571428571 (550924/560000), AUC 0.999035656452179
ep12_train_time 106.21528649330139
Test Epoch12 layer4 Acc 0.9776857142857143, AUC 0.9980276823043823, avg_entr 0.003996637184172869, f1 0.9776856899261475
ep12_l4_test_time 2.311922311782837
gc 0
Train Epoch13 Acc 0.9839285714285714 (551000/560000), AUC 0.9990085363388062
ep13_train_time 106.8266122341156
Test Epoch13 layer4 Acc 0.9777714285714286, AUC 0.9980248212814331, avg_entr 0.0038422811776399612, f1 0.9777714014053345
ep13_l4_test_time 2.355462074279785
gc 0
Train Epoch14 Acc 0.9841517857142857 (551125/560000), AUC 0.9990291595458984
ep14_train_time 106.32416343688965
Test Epoch14 layer4 Acc 0.978, AUC 0.9979059100151062, avg_entr 0.003791620722040534, f1 0.9779999852180481
ep14_l4_test_time 2.3420534133911133
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.984275 (551194/560000), AUC 0.9990608096122742
ep15_train_time 76.27723860740662
Test Epoch15 layer4 Acc 0.9778, AUC 0.9979971647262573, avg_entr 0.003724323818460107, f1 0.9778000116348267
ep15_l4_test_time 2.3152575492858887
gc 0
Train Epoch16 Acc 0.9845517857142857 (551349/560000), AUC 0.9990512728691101
ep16_train_time 106.7700252532959
Test Epoch16 layer4 Acc 0.9776857142857143, AUC 0.997954249382019, avg_entr 0.003674690378829837, f1 0.9776856899261475
ep16_l4_test_time 2.3631770610809326
gc 0
Train Epoch17 Acc 0.9845607142857142 (551354/560000), AUC 0.9990326166152954
ep17_train_time 106.20606684684753
Test Epoch17 layer4 Acc 0.9778, AUC 0.9979888200759888, avg_entr 0.0035655242390930653, f1 0.9778000116348267
ep17_l4_test_time 2.3551833629608154
gc 0
Train Epoch18 Acc 0.9847839285714286 (551479/560000), AUC 0.9990406632423401
ep18_train_time 106.17814683914185
Test Epoch18 layer4 Acc 0.9779428571428571, AUC 0.9979920983314514, avg_entr 0.0035570464096963406, f1 0.9779428839683533
ep18_l4_test_time 2.3490688800811768
gc 0
Train Epoch19 Acc 0.9848053571428571 (551491/560000), AUC 0.9990507364273071
ep19_train_time 106.65771842002869
Test Epoch19 layer4 Acc 0.9776571428571429, AUC 0.9979614615440369, avg_entr 0.0035839437041431665, f1 0.9776571393013
ep19_l4_test_time 2.3172006607055664
gc 0
Train Epoch20 Acc 0.9849642857142857 (551580/560000), AUC 0.9990585446357727
ep20_train_time 106.01991891860962
Test Epoch20 layer4 Acc 0.9779142857142857, AUC 0.9979170560836792, avg_entr 0.0034826502669602633, f1 0.9779142737388611
ep20_l4_test_time 2.362945318222046
gc 0
Train Epoch21 Acc 0.9849946428571429 (551597/560000), AUC 0.9990577101707458
ep21_train_time 106.55724668502808
Test Epoch21 layer4 Acc 0.9779428571428571, AUC 0.9978761672973633, avg_entr 0.0035201096907258034, f1 0.9779428839683533
ep21_l4_test_time 2.2253172397613525
gc 0
Train Epoch22 Acc 0.985125 (551670/560000), AUC 0.9990615844726562
ep22_train_time 106.35860013961792
Test Epoch22 layer4 Acc 0.9778285714285714, AUC 0.9978570342063904, avg_entr 0.0033166324719786644, f1 0.9778285622596741
ep22_l4_test_time 2.3525946140289307
gc 0
Train Epoch23 Acc 0.98525 (551740/560000), AUC 0.9990512728691101
ep23_train_time 105.93316149711609
Test Epoch23 layer4 Acc 0.9780571428571428, AUC 0.9979057908058167, avg_entr 0.0034797154366970062, f1 0.9780571460723877
ep23_l4_test_time 2.348856210708618
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 23
gc 0
Train Epoch24 Acc 0.9853303571428571 (551785/560000), AUC 0.9990619421005249
ep24_train_time 106.68649291992188
Test Epoch24 layer4 Acc 0.9779428571428571, AUC 0.9977158308029175, avg_entr 0.0035247928462922573, f1 0.9779428839683533
ep24_l4_test_time 2.3475658893585205
gc 0
Train Epoch25 Acc 0.9853964285714286 (551822/560000), AUC 0.9990472197532654
ep25_train_time 106.18608546257019
Test Epoch25 layer4 Acc 0.9777714285714286, AUC 0.9977560043334961, avg_entr 0.003438021056354046, f1 0.9777714014053345
ep25_l4_test_time 2.365237236022949
gc 0
Train Epoch26 Acc 0.9854857142857143 (551872/560000), AUC 0.9990520477294922
ep26_train_time 106.37970471382141
Test Epoch26 layer4 Acc 0.9781142857142857, AUC 0.997697651386261, avg_entr 0.0033452995121479034, f1 0.9781143069267273
ep26_l4_test_time 2.345445156097412
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 26
gc 0
Train Epoch27 Acc 0.9855767857142858 (551923/560000), AUC 0.9990517497062683
ep27_train_time 106.72726249694824
Test Epoch27 layer4 Acc 0.9782571428571428, AUC 0.9977046847343445, avg_entr 0.0031635314226150513, f1 0.9782571196556091
ep27_l4_test_time 2.3509092330932617
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 27
gc 0
Train Epoch28 Acc 0.9856178571428571 (551946/560000), AUC 0.9990422129631042
ep28_train_time 106.25752687454224
Test Epoch28 layer4 Acc 0.9777714285714286, AUC 0.9977079629898071, avg_entr 0.0033657688181847334, f1 0.9777714014053345
ep28_l4_test_time 2.3225748538970947
gc 0
Train Epoch29 Acc 0.9857107142857143 (551998/560000), AUC 0.9990283250808716
ep29_train_time 106.6303060054779
Test Epoch29 layer4 Acc 0.9780857142857143, AUC 0.997814953327179, avg_entr 0.0030919192358851433, f1 0.9780856966972351
ep29_l4_test_time 2.141911268234253
Best AUC tensor(0.9783) 27
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 3238.8602759838104
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt
Test layer0 Acc 0.9744, AUC 0.9983693361282349, avg_entr 0.022329583764076233, f1 0.974399983882904
l0_test_time 1.9592921733856201
Test layer1 Acc 0.9784857142857143, AUC 0.9985156059265137, avg_entr 0.008589321747422218, f1 0.9784857034683228
l1_test_time 2.2385666370391846
Test layer2 Acc 0.9788285714285714, AUC 0.9981842637062073, avg_entr 0.004794752690941095, f1 0.9788285493850708
l2_test_time 2.3339898586273193
Test layer3 Acc 0.9789428571428571, AUC 0.9981814622879028, avg_entr 0.0038978420197963715, f1 0.97894287109375
l3_test_time 2.343480348587036
Test layer4 Acc 0.9789142857142857, AUC 0.9979406595230103, avg_entr 0.003297041868790984, f1 0.9789142608642578
l4_test_time 2.331658124923706
