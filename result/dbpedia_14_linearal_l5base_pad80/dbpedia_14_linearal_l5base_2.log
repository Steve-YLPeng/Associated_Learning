total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.27246689796448
Start Training
gc 0
Train Epoch0 Acc 0.8692428571428571 (486776/560000), AUC 0.9848470687866211
ep0_train_time 105.2039999961853
Test Epoch0 layer4 Acc 0.9730571428571428, AUC 0.9985770583152771, avg_entr 0.06258641928434372, f1 0.9730571508407593
ep0_l4_test_time 2.156630516052246
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9778732142857143 (547609/560000), AUC 0.9986886382102966
ep1_train_time 102.46159482002258
Test Epoch1 layer4 Acc 0.9750285714285715, AUC 0.9984654784202576, avg_entr 0.02257520891726017, f1 0.9750285744667053
ep1_l4_test_time 2.156125783920288
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9796589285714286 (548609/560000), AUC 0.9985911250114441
ep2_train_time 102.65140175819397
Test Epoch2 layer4 Acc 0.9757142857142858, AUC 0.9980489611625671, avg_entr 0.011685511097311974, f1 0.9757142663002014
ep2_l4_test_time 2.162743330001831
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9806339285714286 (549155/560000), AUC 0.9985350966453552
ep3_train_time 102.77437353134155
Test Epoch3 layer4 Acc 0.9763142857142857, AUC 0.9980764389038086, avg_entr 0.008300713263452053, f1 0.9763143062591553
ep3_l4_test_time 2.165888547897339
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9813196428571429 (549539/560000), AUC 0.9985572099685669
ep4_train_time 103.63468885421753
Test Epoch4 layer4 Acc 0.9767142857142858, AUC 0.9978668093681335, avg_entr 0.006849073339253664, f1 0.9767143130302429
ep4_l4_test_time 2.1483712196350098
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9817964285714286 (549806/560000), AUC 0.9986854791641235
ep5_train_time 102.97973608970642
Test Epoch5 layer4 Acc 0.9765428571428572, AUC 0.997918963432312, avg_entr 0.005939506459981203, f1 0.9765428304672241
ep5_l4_test_time 2.113558530807495
gc 0
Train Epoch6 Acc 0.9821946428571429 (550029/560000), AUC 0.9987474083900452
ep6_train_time 102.23206877708435
Test Epoch6 layer4 Acc 0.9773428571428572, AUC 0.9977980852127075, avg_entr 0.005554093047976494, f1 0.9773428440093994
ep6_l4_test_time 2.1543967723846436
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9824892857142857 (550194/560000), AUC 0.9988203048706055
ep7_train_time 102.90919518470764
Test Epoch7 layer4 Acc 0.9773714285714286, AUC 0.9979940056800842, avg_entr 0.004910387098789215, f1 0.9773714542388916
ep7_l4_test_time 2.1566221714019775
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9828803571428572 (550413/560000), AUC 0.9989115595817566
ep8_train_time 102.7214708328247
Test Epoch8 layer4 Acc 0.9777142857142858, AUC 0.9978243708610535, avg_entr 0.0045598954893648624, f1 0.9777143001556396
ep8_l4_test_time 2.1716368198394775
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9831607142857143 (550570/560000), AUC 0.9988765716552734
ep9_train_time 103.83325457572937
Test Epoch9 layer4 Acc 0.9774571428571428, AUC 0.9978525042533875, avg_entr 0.004510529804974794, f1 0.9774571657180786
ep9_l4_test_time 2.0783727169036865
gc 0
Train Epoch10 Acc 0.9834839285714285 (550751/560000), AUC 0.9988718032836914
ep10_train_time 102.85934519767761
Test Epoch10 layer4 Acc 0.9774857142857143, AUC 0.9977560639381409, avg_entr 0.004257785622030497, f1 0.977485716342926
ep10_l4_test_time 2.185166597366333
gc 0
Train Epoch11 Acc 0.9835517857142857 (550789/560000), AUC 0.9989172220230103
ep11_train_time 102.7831289768219
Test Epoch11 layer4 Acc 0.9782, AUC 0.9978352785110474, avg_entr 0.004105058964341879, f1 0.9782000184059143
ep11_l4_test_time 2.214817523956299
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9837982142857142 (550927/560000), AUC 0.9989337921142578
ep12_train_time 102.7251045703888
Test Epoch12 layer4 Acc 0.9780857142857143, AUC 0.9980397820472717, avg_entr 0.003935825079679489, f1 0.9780856966972351
ep12_l4_test_time 2.1890928745269775
gc 0
Train Epoch13 Acc 0.9840125 (551047/560000), AUC 0.9989347457885742
ep13_train_time 102.74789071083069
Test Epoch13 layer4 Acc 0.9781428571428571, AUC 0.9979501366615295, avg_entr 0.003779443446546793, f1 0.9781428575515747
ep13_l4_test_time 2.1771469116210938
gc 0
Train Epoch14 Acc 0.9842696428571429 (551191/560000), AUC 0.9989402890205383
ep14_train_time 103.38199782371521
Test Epoch14 layer4 Acc 0.9778285714285714, AUC 0.9979890584945679, avg_entr 0.0037852684035897255, f1 0.9778285622596741
ep14_l4_test_time 2.0691452026367188
gc 0
Train Epoch15 Acc 0.9842857142857143 (551200/560000), AUC 0.9989679455757141
ep15_train_time 102.4648187160492
Test Epoch15 layer4 Acc 0.9782, AUC 0.9978818297386169, avg_entr 0.0036940821446478367, f1 0.9782000184059143
ep15_l4_test_time 2.136044502258301
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.9844178571428571 (551274/560000), AUC 0.9989916086196899
ep16_train_time 102.72103643417358
Test Epoch16 layer4 Acc 0.9784285714285714, AUC 0.9978931546211243, avg_entr 0.0036252664867788553, f1 0.9784285426139832
ep16_l4_test_time 2.1375460624694824
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.9845785714285714 (551364/560000), AUC 0.9989835619926453
ep17_train_time 102.91865253448486
Test Epoch17 layer4 Acc 0.9780857142857143, AUC 0.9978728890419006, avg_entr 0.0034990624990314245, f1 0.9780856966972351
ep17_l4_test_time 2.216172218322754
gc 0
Train Epoch18 Acc 0.9846142857142857 (551384/560000), AUC 0.9990050196647644
ep18_train_time 102.59505486488342
Test Epoch18 layer4 Acc 0.9778, AUC 0.9980283379554749, avg_entr 0.0036061624996364117, f1 0.9778000116348267
ep18_l4_test_time 2.1519904136657715
gc 0
Train Epoch19 Acc 0.9847964285714286 (551486/560000), AUC 0.9989957809448242
ep19_train_time 103.7426507472992
Test Epoch19 layer4 Acc 0.9784857142857143, AUC 0.9981602430343628, avg_entr 0.003631776198744774, f1 0.9784857034683228
ep19_l4_test_time 2.0866425037384033
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 19
gc 0
Train Epoch20 Acc 0.9849 (551544/560000), AUC 0.9990124106407166
ep20_train_time 102.51965641975403
Test Epoch20 layer4 Acc 0.9782857142857143, AUC 0.998088538646698, avg_entr 0.0035031067673116922, f1 0.9782857298851013
ep20_l4_test_time 2.2185308933258057
gc 0
Train Epoch21 Acc 0.9850589285714285 (551633/560000), AUC 0.9990002512931824
ep21_train_time 102.65247654914856
Test Epoch21 layer4 Acc 0.9787142857142858, AUC 0.9981802105903625, avg_entr 0.0035925789270550013, f1 0.9787142872810364
ep21_l4_test_time 2.1301493644714355
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 21
gc 0
Train Epoch22 Acc 0.9850785714285715 (551644/560000), AUC 0.9990110397338867
ep22_train_time 102.96541976928711
Test Epoch22 layer4 Acc 0.9783714285714286, AUC 0.9981620907783508, avg_entr 0.003380270441994071, f1 0.9783714413642883
ep22_l4_test_time 2.1392674446105957
gc 0
Train Epoch23 Acc 0.9852017857142857 (551713/560000), AUC 0.9990311861038208
ep23_train_time 102.61637878417969
Test Epoch23 layer4 Acc 0.9784285714285714, AUC 0.9981229901313782, avg_entr 0.0034053241834044456, f1 0.9784285426139832
ep23_l4_test_time 2.215341806411743
gc 0
Train Epoch24 Acc 0.9852553571428572 (551743/560000), AUC 0.9990245699882507
ep24_train_time 103.77912378311157
Test Epoch24 layer4 Acc 0.9782571428571428, AUC 0.9980884790420532, avg_entr 0.0035076241474598646, f1 0.9782571196556091
ep24_l4_test_time 2.0991013050079346
gc 0
Train Epoch25 Acc 0.9853696428571429 (551807/560000), AUC 0.9990450143814087
ep25_train_time 102.5149278640747
Test Epoch25 layer4 Acc 0.9781142857142857, AUC 0.9981222748756409, avg_entr 0.00343317654915154, f1 0.9781143069267273
ep25_l4_test_time 2.1556692123413086
gc 0
Train Epoch26 Acc 0.9853946428571428 (551821/560000), AUC 0.9990354180335999
ep26_train_time 102.66837906837463
Test Epoch26 layer4 Acc 0.9784285714285714, AUC 0.9981128573417664, avg_entr 0.0032801085617393255, f1 0.9784285426139832
ep26_l4_test_time 2.1838998794555664
gc 0
Train Epoch27 Acc 0.9854839285714285 (551871/560000), AUC 0.9990482330322266
ep27_train_time 102.60045552253723
Test Epoch27 layer4 Acc 0.9784571428571428, AUC 0.9982056617736816, avg_entr 0.0034437028225511312, f1 0.9784571528434753
ep27_l4_test_time 2.161463975906372
gc 0
Train Epoch28 Acc 0.9855553571428571 (551911/560000), AUC 0.9990359544754028
ep28_train_time 102.58825469017029
Test Epoch28 layer4 Acc 0.9782571428571428, AUC 0.9982113838195801, avg_entr 0.003319774055853486, f1 0.9782571196556091
ep28_l4_test_time 2.1477620601654053
gc 0
Train Epoch29 Acc 0.9856446428571428 (551961/560000), AUC 0.9990379214286804
ep29_train_time 103.59859466552734
Test Epoch29 layer4 Acc 0.9782285714285714, AUC 0.9981298446655273, avg_entr 0.0033982605673372746, f1 0.9782285690307617
ep29_l4_test_time 2.129390001296997
Best AUC tensor(0.9787) 21
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 3156.027266740799
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt
Test layer0 Acc 0.9744571428571429, AUC 0.9983300566673279, avg_entr 0.022948043420910835, f1 0.9744571447372437
l0_test_time 1.7741355895996094
Test layer1 Acc 0.9787428571428571, AUC 0.998345673084259, avg_entr 0.009722692891955376, f1 0.9787428379058838
l1_test_time 1.8591079711914062
Test layer2 Acc 0.9788285714285714, AUC 0.9982913136482239, avg_entr 0.005503520369529724, f1 0.9788285493850708
l2_test_time 2.1141037940979004
Test layer3 Acc 0.9788285714285714, AUC 0.9982582330703735, avg_entr 0.004263239447027445, f1 0.9788285493850708
l3_test_time 2.2206807136535645
Test layer4 Acc 0.9787714285714286, AUC 0.9982036352157593, avg_entr 0.0036886718589812517, f1 0.978771448135376
l4_test_time 2.1504857540130615
