total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.51722073554993
Start Training
gc 0
Train Epoch0 Acc 0.8663553571428572 (485159/560000), AUC 0.9846518635749817
ep0_train_time 103.44704413414001
Test Epoch0 layer4 Acc 0.9739142857142857, AUC 0.9984772801399231, avg_entr 0.06413306295871735, f1 0.9739142656326294
ep0_l4_test_time 2.109872579574585
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9778321428571428 (547586/560000), AUC 0.9987310171127319
ep1_train_time 100.43578791618347
Test Epoch1 layer4 Acc 0.9754857142857143, AUC 0.9985156059265137, avg_entr 0.023003574460744858, f1 0.9754857420921326
ep1_l4_test_time 2.1098785400390625
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9797035714285715 (548634/560000), AUC 0.9986522793769836
ep2_train_time 101.33482098579407
Test Epoch2 layer4 Acc 0.9762571428571428, AUC 0.998085081577301, avg_entr 0.011790549382567406, f1 0.9762571454048157
ep2_l4_test_time 2.1647229194641113
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9803946428571428 (549021/560000), AUC 0.9985395669937134
ep3_train_time 100.59849762916565
Test Epoch3 layer4 Acc 0.9762, AUC 0.997933566570282, avg_entr 0.008333900943398476, f1 0.9761999845504761
ep3_l4_test_time 2.1186904907226562
gc 0
Train Epoch4 Acc 0.9811642857142857 (549452/560000), AUC 0.9985946416854858
ep4_train_time 100.25677061080933
Test Epoch4 layer4 Acc 0.9761714285714286, AUC 0.9978408813476562, avg_entr 0.0071576982736587524, f1 0.9761714339256287
ep4_l4_test_time 2.1501522064208984
gc 0
Train Epoch5 Acc 0.9816642857142858 (549732/560000), AUC 0.9986695051193237
ep5_train_time 100.32759213447571
Test Epoch5 layer4 Acc 0.977, AUC 0.9977352023124695, avg_entr 0.006012726575136185, f1 0.9769999980926514
ep5_l4_test_time 2.1099295616149902
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9819803571428571 (549909/560000), AUC 0.9987620115280151
ep6_train_time 100.41725635528564
Test Epoch6 layer4 Acc 0.9770285714285715, AUC 0.9978384375572205, avg_entr 0.005540660582482815, f1 0.9770285487174988
ep6_l4_test_time 2.1195068359375
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9824928571428572 (550196/560000), AUC 0.9988254904747009
ep7_train_time 101.38531494140625
Test Epoch7 layer4 Acc 0.9772285714285714, AUC 0.9977339506149292, avg_entr 0.005192641634494066, f1 0.977228581905365
ep7_l4_test_time 2.1293935775756836
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9826892857142857 (550306/560000), AUC 0.9988641738891602
ep8_train_time 100.19597029685974
Test Epoch8 layer4 Acc 0.9773714285714286, AUC 0.9976862668991089, avg_entr 0.004872447345405817, f1 0.9773714542388916
ep8_l4_test_time 2.149125814437866
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9830517857142858 (550509/560000), AUC 0.9988347291946411
ep9_train_time 100.57263422012329
Test Epoch9 layer4 Acc 0.9778285714285714, AUC 0.9977256059646606, avg_entr 0.004537585657089949, f1 0.9778285622596741
ep9_l4_test_time 2.13389253616333
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9833392857142857 (550670/560000), AUC 0.9988486170768738
ep10_train_time 100.2303774356842
Test Epoch10 layer4 Acc 0.9774, AUC 0.9977685809135437, avg_entr 0.004250034224241972, f1 0.977400004863739
ep10_l4_test_time 2.0956459045410156
gc 0
Train Epoch11 Acc 0.9835232142857143 (550773/560000), AUC 0.9988812804222107
ep11_train_time 100.65512466430664
Test Epoch11 layer4 Acc 0.9776857142857143, AUC 0.9976783990859985, avg_entr 0.004043740686029196, f1 0.9776856899261475
ep11_l4_test_time 2.1138410568237305
gc 0
Train Epoch12 Acc 0.9837107142857143 (550878/560000), AUC 0.998889148235321
ep12_train_time 101.30979466438293
Test Epoch12 layer4 Acc 0.9779142857142857, AUC 0.9977908730506897, avg_entr 0.003999222069978714, f1 0.9779142737388611
ep12_l4_test_time 2.0924909114837646
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.983925 (550998/560000), AUC 0.9988951683044434
ep13_train_time 100.70467710494995
Test Epoch13 layer4 Acc 0.9780857142857143, AUC 0.9978238344192505, avg_entr 0.003912042360752821, f1 0.9780856966972351
ep13_l4_test_time 2.1051385402679443
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.9839964285714285 (551038/560000), AUC 0.9989188313484192
ep14_train_time 100.24266743659973
Test Epoch14 layer4 Acc 0.9778, AUC 0.9977845549583435, avg_entr 0.003775153076276183, f1 0.9778000116348267
ep14_l4_test_time 2.1294026374816895
gc 0
Train Epoch15 Acc 0.9843 (551208/560000), AUC 0.9989299774169922
ep15_train_time 100.38430833816528
Test Epoch15 layer4 Acc 0.9782, AUC 0.9977132678031921, avg_entr 0.003620452480390668, f1 0.9782000184059143
ep15_l4_test_time 2.068556308746338
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.98445 (551292/560000), AUC 0.9989333748817444
ep16_train_time 100.73370146751404
Test Epoch16 layer4 Acc 0.978, AUC 0.9977622628211975, avg_entr 0.0037457114085555077, f1 0.9779999852180481
ep16_l4_test_time 2.087905168533325
gc 0
Train Epoch17 Acc 0.9846535714285715 (551406/560000), AUC 0.998932421207428
ep17_train_time 101.27620100975037
Test Epoch17 layer4 Acc 0.9781714285714286, AUC 0.9978481531143188, avg_entr 0.00353272445499897, f1 0.9781714081764221
ep17_l4_test_time 2.0758190155029297
gc 0
Train Epoch18 Acc 0.9847196428571429 (551443/560000), AUC 0.9989553689956665
ep18_train_time 100.4565076828003
Test Epoch18 layer4 Acc 0.9780571428571428, AUC 0.997742235660553, avg_entr 0.0034724571742117405, f1 0.9780571460723877
ep18_l4_test_time 2.1369993686676025
gc 0
Train Epoch19 Acc 0.9848964285714286 (551542/560000), AUC 0.9989453554153442
ep19_train_time 100.82845091819763
Test Epoch19 layer4 Acc 0.9782285714285714, AUC 0.997794508934021, avg_entr 0.0035908452700823545, f1 0.9782285690307617
ep19_l4_test_time 2.1010868549346924
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 19
gc 0
Train Epoch20 Acc 0.9849660714285714 (551581/560000), AUC 0.9989598393440247
ep20_train_time 100.42790246009827
Test Epoch20 layer4 Acc 0.9782857142857143, AUC 0.9977909326553345, avg_entr 0.0034792826045304537, f1 0.9782857298851013
ep20_l4_test_time 2.156212091445923
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 20
gc 0
Train Epoch21 Acc 0.9851267857142857 (551671/560000), AUC 0.9989427328109741
ep21_train_time 100.96257615089417
Test Epoch21 layer4 Acc 0.9780571428571428, AUC 0.9976953864097595, avg_entr 0.0034163438249379396, f1 0.9780571460723877
ep21_l4_test_time 2.1788618564605713
gc 0
Train Epoch22 Acc 0.9852017857142857 (551713/560000), AUC 0.9989422559738159
ep22_train_time 101.37843728065491
Test Epoch22 layer4 Acc 0.9785714285714285, AUC 0.9976564049720764, avg_entr 0.003428264055401087, f1 0.9785714149475098
ep22_l4_test_time 2.118805408477783
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 22
gc 0
Train Epoch23 Acc 0.9852446428571429 (551737/560000), AUC 0.9989231824874878
ep23_train_time 100.51419830322266
Test Epoch23 layer4 Acc 0.9782857142857143, AUC 0.9976667165756226, avg_entr 0.003350472077727318, f1 0.9782857298851013
ep23_l4_test_time 2.1194515228271484
gc 0
Train Epoch24 Acc 0.9854017857142857 (551825/560000), AUC 0.9989471435546875
ep24_train_time 100.53925466537476
Test Epoch24 layer4 Acc 0.9783714285714286, AUC 0.9976221919059753, avg_entr 0.0032223425805568695, f1 0.9783714413642883
ep24_l4_test_time 2.1415088176727295
gc 0
Train Epoch25 Acc 0.9854035714285714 (551826/560000), AUC 0.9989195466041565
ep25_train_time 100.54987072944641
Test Epoch25 layer4 Acc 0.9784857142857143, AUC 0.9975691437721252, avg_entr 0.0033186047803610563, f1 0.9784857034683228
ep25_l4_test_time 2.1552157402038574
gc 0
Train Epoch26 Acc 0.9854607142857142 (551858/560000), AUC 0.9989351034164429
ep26_train_time 100.7366189956665
Test Epoch26 layer4 Acc 0.9783714285714286, AUC 0.9976726174354553, avg_entr 0.003258585697039962, f1 0.9783714413642883
ep26_l4_test_time 2.097137451171875
gc 0
Train Epoch27 Acc 0.9856267857142857 (551951/560000), AUC 0.9989400506019592
ep27_train_time 101.51295828819275
Test Epoch27 layer4 Acc 0.9781714285714286, AUC 0.9976186752319336, avg_entr 0.0033927438780665398, f1 0.9781714081764221
ep27_l4_test_time 2.135281562805176
gc 0
Train Epoch28 Acc 0.9856267857142857 (551951/560000), AUC 0.9989445805549622
ep28_train_time 100.2680401802063
Test Epoch28 layer4 Acc 0.9785714285714285, AUC 0.9974683523178101, avg_entr 0.0033210227265954018, f1 0.9785714149475098
ep28_l4_test_time 2.1632351875305176
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 28
gc 0
Train Epoch29 Acc 0.9856625 (551971/560000), AUC 0.9989491105079651
ep29_train_time 100.54297280311584
Test Epoch29 layer4 Acc 0.9784857142857143, AUC 0.9975331425666809, avg_entr 0.0032410314306616783, f1 0.9784857034683228
ep29_l4_test_time 2.1213295459747314
Best AUC tensor(0.9786) 28
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 3089.619918823242
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt
Test layer0 Acc 0.9740857142857143, AUC 0.998374879360199, avg_entr 0.022632038220763206, f1 0.9740856885910034
l0_test_time 2.0405452251434326
Test layer1 Acc 0.9784857142857143, AUC 0.9983612895011902, avg_entr 0.00815310887992382, f1 0.9784857034683228
l1_test_time 2.068880558013916
Test layer2 Acc 0.9788285714285714, AUC 0.9983963370323181, avg_entr 0.004866946022957563, f1 0.9788285493850708
l2_test_time 2.0985753536224365
Test layer3 Acc 0.9789142857142857, AUC 0.9980944395065308, avg_entr 0.0037958920001983643, f1 0.9789142608642578
l3_test_time 2.125194549560547
Test layer4 Acc 0.9791714285714286, AUC 0.9979299902915955, avg_entr 0.0032448701094835997, f1 0.9791714549064636
l4_test_time 2.1040310859680176
