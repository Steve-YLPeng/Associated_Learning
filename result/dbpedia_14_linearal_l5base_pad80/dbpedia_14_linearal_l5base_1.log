total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.280362129211426
Start Training
gc 0
Train Epoch0 Acc 0.8653375 (484589/560000), AUC 0.9847234487533569
ep0_train_time 103.39767026901245
Test Epoch0 layer4 Acc 0.9735428571428572, AUC 0.998506486415863, avg_entr 0.06403905153274536, f1 0.9735428690910339
ep0_l4_test_time 2.0423264503479004
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9776857142857143 (547504/560000), AUC 0.9987295866012573
ep1_train_time 101.28957343101501
Test Epoch1 layer4 Acc 0.9745142857142857, AUC 0.998627245426178, avg_entr 0.024406835436820984, f1 0.9745143055915833
ep1_l4_test_time 2.137648820877075
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9795964285714286 (548574/560000), AUC 0.9986587166786194
ep2_train_time 98.0230040550232
Test Epoch2 layer4 Acc 0.9756571428571429, AUC 0.9982042908668518, avg_entr 0.01223929412662983, f1 0.9756571650505066
ep2_l4_test_time 0.9140565395355225
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9804267857142858 (549039/560000), AUC 0.9985628724098206
ep3_train_time 77.4865653514862
Test Epoch3 layer4 Acc 0.9764, AUC 0.997964084148407, avg_entr 0.008226018399000168, f1 0.9764000177383423
ep3_l4_test_time 2.117947578430176
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9812928571428572 (549524/560000), AUC 0.9986275434494019
ep4_train_time 101.1220543384552
Test Epoch4 layer4 Acc 0.9767714285714286, AUC 0.9981474876403809, avg_entr 0.006898184772580862, f1 0.9767714142799377
ep4_l4_test_time 2.126955270767212
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9817678571428572 (549790/560000), AUC 0.9987818598747253
ep5_train_time 101.13114786148071
Test Epoch5 layer4 Acc 0.9769428571428571, AUC 0.99808269739151, avg_entr 0.005919233430176973, f1 0.9769428372383118
ep5_l4_test_time 2.0933992862701416
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9821267857142857 (549991/560000), AUC 0.9988028407096863
ep6_train_time 101.00705742835999
Test Epoch6 layer4 Acc 0.9776, AUC 0.9980106949806213, avg_entr 0.005516586359590292, f1 0.9775999784469604
ep6_l4_test_time 2.117642641067505
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9824196428571429 (550155/560000), AUC 0.9988259077072144
ep7_train_time 101.36023807525635
Test Epoch7 layer4 Acc 0.9772857142857143, AUC 0.9979648590087891, avg_entr 0.004978761076927185, f1 0.9772857427597046
ep7_l4_test_time 2.1249802112579346
gc 0
Train Epoch8 Acc 0.9827785714285714 (550356/560000), AUC 0.9988468289375305
ep8_train_time 100.87189674377441
Test Epoch8 layer4 Acc 0.9773714285714286, AUC 0.9979168772697449, avg_entr 0.0046547213569283485, f1 0.9773714542388916
ep8_l4_test_time 2.132540225982666
gc 0
Train Epoch9 Acc 0.9831535714285714 (550566/560000), AUC 0.9989389777183533
ep9_train_time 101.44537019729614
Test Epoch9 layer4 Acc 0.9776571428571429, AUC 0.9979122877120972, avg_entr 0.004321029409766197, f1 0.9776571393013
ep9_l4_test_time 2.0574822425842285
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9833553571428572 (550679/560000), AUC 0.9989319443702698
ep10_train_time 101.45219421386719
Test Epoch10 layer4 Acc 0.9776285714285714, AUC 0.9979901909828186, avg_entr 0.0040163081139326096, f1 0.9776285886764526
ep10_l4_test_time 2.1154680252075195
gc 0
Train Epoch11 Acc 0.9835767857142858 (550803/560000), AUC 0.9989187121391296
ep11_train_time 101.54293870925903
Test Epoch11 layer4 Acc 0.9779142857142857, AUC 0.9979037046432495, avg_entr 0.0040205479599535465, f1 0.9779142737388611
ep11_l4_test_time 2.112356424331665
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9839267857142857 (550999/560000), AUC 0.9989672303199768
ep12_train_time 101.52016758918762
Test Epoch12 layer4 Acc 0.9775142857142857, AUC 0.9979122877120972, avg_entr 0.003635099157691002, f1 0.9775142669677734
ep12_l4_test_time 2.0420329570770264
gc 0
Train Epoch13 Acc 0.9840910714285714 (551091/560000), AUC 0.9989873170852661
ep13_train_time 101.4520571231842
Test Epoch13 layer4 Acc 0.9779714285714286, AUC 0.9979039430618286, avg_entr 0.0036199563182890415, f1 0.9779714345932007
ep13_l4_test_time 2.1258559226989746
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.9842625 (551187/560000), AUC 0.9989888072013855
ep14_train_time 72.79734563827515
Test Epoch14 layer4 Acc 0.9780285714285715, AUC 0.9978843331336975, avg_entr 0.0035246757324784994, f1 0.9780285954475403
ep14_l4_test_time 2.1087658405303955
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.9843964285714286 (551262/560000), AUC 0.9989959001541138
ep15_train_time 101.04877638816833
Test Epoch15 layer4 Acc 0.9784285714285714, AUC 0.997909426689148, avg_entr 0.0035714118275791407, f1 0.9784285426139832
ep15_l4_test_time 2.1097412109375
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.9844875 (551313/560000), AUC 0.9990054965019226
ep16_train_time 101.12355947494507
Test Epoch16 layer4 Acc 0.9779428571428571, AUC 0.9978943467140198, avg_entr 0.0032998535316437483, f1 0.9779428839683533
ep16_l4_test_time 2.1214852333068848
gc 0
Train Epoch17 Acc 0.9846232142857143 (551389/560000), AUC 0.9990404844284058
ep17_train_time 101.18578672409058
Test Epoch17 layer4 Acc 0.9778, AUC 0.9980307817459106, avg_entr 0.0033835701178759336, f1 0.9778000116348267
ep17_l4_test_time 2.0953876972198486
gc 0
Train Epoch18 Acc 0.9847696428571429 (551471/560000), AUC 0.9990213513374329
ep18_train_time 101.22593450546265
Test Epoch18 layer4 Acc 0.9781428571428571, AUC 0.997835636138916, avg_entr 0.003385301446542144, f1 0.9781428575515747
ep18_l4_test_time 2.0421080589294434
gc 0
Train Epoch19 Acc 0.9848839285714286 (551535/560000), AUC 0.9990297555923462
ep19_train_time 101.37347435951233
Test Epoch19 layer4 Acc 0.9781714285714286, AUC 0.9979795217514038, avg_entr 0.0032834287267178297, f1 0.9781714081764221
ep19_l4_test_time 2.1203136444091797
gc 0
Train Epoch20 Acc 0.9849482142857143 (551571/560000), AUC 0.9990610480308533
ep20_train_time 101.19821381568909
Test Epoch20 layer4 Acc 0.9781428571428571, AUC 0.9979759454727173, avg_entr 0.0031130544375628233, f1 0.9781428575515747
ep20_l4_test_time 2.117008686065674
gc 0
Train Epoch21 Acc 0.9850785714285715 (551644/560000), AUC 0.9990488886833191
ep21_train_time 101.15047478675842
Test Epoch21 layer4 Acc 0.9779142857142857, AUC 0.9979768395423889, avg_entr 0.003283489029854536, f1 0.9779142737388611
ep21_l4_test_time 2.0352330207824707
gc 0
Train Epoch22 Acc 0.9851946428571429 (551709/560000), AUC 0.9990559816360474
ep22_train_time 100.93234610557556
Test Epoch22 layer4 Acc 0.978, AUC 0.9979863166809082, avg_entr 0.0034893378615379333, f1 0.9779999852180481
ep22_l4_test_time 2.11179518699646
gc 0
Train Epoch23 Acc 0.9852535714285714 (551742/560000), AUC 0.999048113822937
ep23_train_time 101.17638850212097
Test Epoch23 layer4 Acc 0.9780857142857143, AUC 0.9980183243751526, avg_entr 0.003344882745295763, f1 0.9780856966972351
ep23_l4_test_time 2.097604513168335
gc 0
Train Epoch24 Acc 0.9854196428571429 (551835/560000), AUC 0.9990615844726562
ep24_train_time 101.30894446372986
Test Epoch24 layer4 Acc 0.9785142857142857, AUC 0.9978765845298767, avg_entr 0.003293657209724188, f1 0.9785143136978149
ep24_l4_test_time 2.0342867374420166
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 24
gc 0
Train Epoch25 Acc 0.9853392857142858 (551790/560000), AUC 0.9990445375442505
ep25_train_time 73.992360830307
Test Epoch25 layer4 Acc 0.9779714285714286, AUC 0.9979577660560608, avg_entr 0.00317028583958745, f1 0.9779714345932007
ep25_l4_test_time 2.1043286323547363
gc 0
Train Epoch26 Acc 0.9854660714285715 (551861/560000), AUC 0.9990444779396057
ep26_train_time 100.87559843063354
Test Epoch26 layer4 Acc 0.9784285714285714, AUC 0.9979549646377563, avg_entr 0.0030828299932181835, f1 0.9784285426139832
ep26_l4_test_time 2.0987296104431152
gc 0
Train Epoch27 Acc 0.9855928571428572 (551932/560000), AUC 0.999036431312561
ep27_train_time 101.13818573951721
Test Epoch27 layer4 Acc 0.9782571428571428, AUC 0.9979065656661987, avg_entr 0.002964986488223076, f1 0.9782571196556091
ep27_l4_test_time 2.105750322341919
gc 0
Train Epoch28 Acc 0.9856071428571429 (551940/560000), AUC 0.9990389943122864
ep28_train_time 101.3056046962738
Test Epoch28 layer4 Acc 0.9784, AUC 0.997920572757721, avg_entr 0.0032500012312084436, f1 0.9783999919891357
ep28_l4_test_time 2.1168372631073
gc 0
Train Epoch29 Acc 0.9856767857142857 (551979/560000), AUC 0.9990493655204773
ep29_train_time 101.31404662132263
Test Epoch29 layer4 Acc 0.9785714285714285, AUC 0.9977865815162659, avg_entr 0.003260763129219413, f1 0.9785714149475098
ep29_l4_test_time 2.129824161529541
Save ckpt to ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt  ,ep 29
Best AUC tensor(0.9786) 29
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 3020.7265689373016
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base_pad80//dbpedia_14_linearal_l5.pt
Test layer0 Acc 0.9745142857142857, AUC 0.9983057975769043, avg_entr 0.02251233346760273, f1 0.9745143055915833
l0_test_time 1.9852454662322998
Test layer1 Acc 0.9789428571428571, AUC 0.9984648823738098, avg_entr 0.008115836419165134, f1 0.97894287109375
l1_test_time 2.041647434234619
Test layer2 Acc 0.979, AUC 0.9985485672950745, avg_entr 0.004769346211105585, f1 0.9789999723434448
l2_test_time 2.066646099090576
Test layer3 Acc 0.9792285714285714, AUC 0.9983817934989929, avg_entr 0.003653460182249546, f1 0.9792285561561584
l3_test_time 2.105394124984741
Test layer4 Acc 0.9790571428571428, AUC 0.9979048371315002, avg_entr 0.0032484005205333233, f1 0.9790571331977844
l4_test_time 2.1001269817352295
