total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.23225833333333334 (27871/120000), AUC 0.3980362117290497
ep0_train_time 8.921230554580688
Test Epoch0 threshold 0.4 Acc 0.915296052631579, AUC 0.9809784293174744, avg_entr 0.02823019213974476
ep0_t0.4_test_time 0.2593374252319336
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25866666666666666 (31040/120000), AUC 0.29506051540374756
ep1_train_time 8.530298948287964
Test Epoch1 threshold 0.4 Acc 0.9167763157894737, AUC 0.9809309840202332, avg_entr 0.026821011677384377
ep1_t0.4_test_time 0.25667476654052734
gc 0
Train Epoch2 Acc 0.269875 (32385/120000), AUC 0.2849801182746887
ep2_train_time 8.566174983978271
Test Epoch2 threshold 0.4 Acc 0.9169407894736842, AUC 0.980678141117096, avg_entr 0.026705177500844002
ep2_t0.4_test_time 0.25690293312072754
gc 0
Train Epoch3 Acc 0.24753333333333333 (29704/120000), AUC 0.27567756175994873
ep3_train_time 8.58604121208191
Test Epoch3 threshold 0.4 Acc 0.9149671052631579, AUC 0.9806362390518188, avg_entr 0.026149820536375046
ep3_t0.4_test_time 0.25603175163269043
gc 0
Train Epoch4 Acc 0.24891666666666667 (29870/120000), AUC 0.26617351174354553
ep4_train_time 8.863930940628052
Test Epoch4 threshold 0.4 Acc 0.915296052631579, AUC 0.9807258248329163, avg_entr 0.026191283017396927
ep4_t0.4_test_time 0.2570681571960449
gc 0
Train Epoch5 Acc 0.24935833333333332 (29923/120000), AUC 0.25763577222824097
ep5_train_time 8.512417554855347
Test Epoch5 threshold 0.4 Acc 0.9151315789473684, AUC 0.9804602861404419, avg_entr 0.026301803067326546
ep5_t0.4_test_time 0.2551693916320801
gc 0
Train Epoch6 Acc 0.24969166666666667 (29963/120000), AUC 0.2534700930118561
ep6_train_time 8.546415090560913
Test Epoch6 threshold 0.4 Acc 0.9149671052631579, AUC 0.9803199172019958, avg_entr 0.025691023096442223
ep6_t0.4_test_time 0.25485920906066895
gc 0
Train Epoch7 Acc 0.24980833333333333 (29977/120000), AUC 0.24974611401557922
ep7_train_time 8.477242231369019
Test Epoch7 threshold 0.4 Acc 0.9159539473684211, AUC 0.9802635312080383, avg_entr 0.02565867267549038
ep7_t0.4_test_time 0.255573034286499
gc 0
Train Epoch8 Acc 0.24983333333333332 (29980/120000), AUC 0.24724964797496796
ep8_train_time 8.66746973991394
Test Epoch8 threshold 0.4 Acc 0.9139802631578947, AUC 0.9801813364028931, avg_entr 0.02627340890467167
ep8_t0.4_test_time 0.25684332847595215
gc 0
Train Epoch9 Acc 0.24979166666666666 (29975/120000), AUC 0.24616825580596924
ep9_train_time 8.585511445999146
Test Epoch9 threshold 0.4 Acc 0.9133223684210526, AUC 0.980043888092041, avg_entr 0.025537578389048576
ep9_t0.4_test_time 0.2555699348449707
Best AUC 0.9809784293174744
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9302631578947368, AUC 0.9866635799407959, avg_entr 0.02730724960565567
t0.4_test_time 0.06650328636169434
