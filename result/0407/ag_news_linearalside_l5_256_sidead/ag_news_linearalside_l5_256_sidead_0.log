total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearALsideText(
  (layers): ModuleList(
    (0): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.0.weight 90000
layers.0.enc.f.0.bias 300
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 45777392
init_time 15.025586654
Start Training
gc 0
Train Epoch0 Acc 0.2845916666666667 (34151/120000), AUC 0.5157659649848938
ep0_train_time 4.873682187
Test Epoch0 layer0 Acc 0.42078947368421055, AUC 0.6881996393203735, avg_entr 1.219122052192688, f1 0.420789510011673
ep0_l0_test_time 0.06213445200000223
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.36236842105263156, AUC 0.6531320810317993, avg_entr 1.2252341508865356, f1 0.3623684346675873
ep0_l1_test_time 0.06551336000000063
Test Epoch0 layer2 Acc 0.32710526315789473, AUC 0.6124329566955566, avg_entr 1.2057673931121826, f1 0.32710525393486023
ep0_l2_test_time 0.06001999899999788
Test Epoch0 layer3 Acc 0.32921052631578945, AUC 0.5933597087860107, avg_entr 1.2156091928482056, f1 0.3292105197906494
ep0_l3_test_time 0.060671608999999904
Test Epoch0 layer4 Acc 0.31526315789473686, AUC 0.5831723213195801, avg_entr 1.2318207025527954, f1 0.31526315212249756
ep0_l4_test_time 0.061797786000003185
gc 0
Train Epoch1 Acc 0.3429833333333333 (41158/120000), AUC 0.5991190671920776
ep1_train_time 4.578588894999999
Test Epoch1 layer0 Acc 0.47368421052631576, AUC 0.7335981130599976, avg_entr 0.8520753979682922, f1 0.4736842215061188
ep1_l0_test_time 0.060871290000001466
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.455, AUC 0.7244551777839661, avg_entr 0.8833274245262146, f1 0.45500001311302185
ep1_l1_test_time 0.0687709269999992
Test Epoch1 layer2 Acc 0.395, AUC 0.6747739911079407, avg_entr 0.8750990033149719, f1 0.39500001072883606
ep1_l2_test_time 0.06034466899999913
Test Epoch1 layer3 Acc 0.38184210526315787, AUC 0.6508285403251648, avg_entr 0.891619861125946, f1 0.38184210658073425
ep1_l3_test_time 0.061041496999997946
Test Epoch1 layer4 Acc 0.3626315789473684, AUC 0.634650707244873, avg_entr 0.886810302734375, f1 0.36263158917427063
ep1_l4_test_time 0.0622658900000026
gc 0
Train Epoch2 Acc 0.4100083333333333 (49201/120000), AUC 0.6657063364982605
ep2_train_time 4.439949824999999
Test Epoch2 layer0 Acc 0.4971052631578947, AUC 0.7421166896820068, avg_entr 0.7062197923660278, f1 0.49710527062416077
ep2_l0_test_time 0.060585857999999604
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.48473684210526313, AUC 0.741848349571228, avg_entr 0.710696280002594, f1 0.484736829996109
ep2_l1_test_time 0.06448145399999916
Test Epoch2 layer2 Acc 0.4473684210526316, AUC 0.7054325342178345, avg_entr 0.7103533744812012, f1 0.44736841320991516
ep2_l2_test_time 0.059907638999998625
Test Epoch2 layer3 Acc 0.4321052631578947, AUC 0.689947783946991, avg_entr 0.7260270714759827, f1 0.43210527300834656
ep2_l3_test_time 0.060639101999996115
Test Epoch2 layer4 Acc 0.4263157894736842, AUC 0.6851411461830139, avg_entr 0.726597011089325, f1 0.4263157844543457
ep2_l4_test_time 0.06172790899999825
gc 0
Train Epoch3 Acc 0.439475 (52737/120000), AUC 0.6918466687202454
ep3_train_time 4.4673607810000036
Test Epoch3 layer0 Acc 0.4789473684210526, AUC 0.7453794479370117, avg_entr 0.6108244061470032, f1 0.47894737124443054
ep3_l0_test_time 0.06046077599999933
Test Epoch3 layer1 Acc 0.4918421052631579, AUC 0.7480705380439758, avg_entr 0.6264572739601135, f1 0.4918420910835266
ep3_l1_test_time 0.05921316300000257
Test Epoch3 layer2 Acc 0.45421052631578945, AUC 0.7162717580795288, avg_entr 0.6237369179725647, f1 0.4542105197906494
ep3_l2_test_time 0.060284588999998334
Test Epoch3 layer3 Acc 0.4305263157894737, AUC 0.697265625, avg_entr 0.6367918252944946, f1 0.4305263161659241
ep3_l3_test_time 0.061073268999997765
Test Epoch3 layer4 Acc 0.42210526315789476, AUC 0.6925124526023865, avg_entr 0.629760205745697, f1 0.42210525274276733
ep3_l4_test_time 0.06204442299999613
gc 0
Train Epoch4 Acc 0.45129166666666665 (54155/120000), AUC 0.7014160752296448
ep4_train_time 4.458479910000001
Test Epoch4 layer0 Acc 0.5013157894736842, AUC 0.7470793724060059, avg_entr 0.5565815567970276, f1 0.5013157725334167
ep4_l0_test_time 0.060381172999996124
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.5071052631578947, AUC 0.7495092153549194, avg_entr 0.5729460120201111, f1 0.50710529088974
ep4_l1_test_time 0.07294165500000105
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.4655263157894737, AUC 0.7186629772186279, avg_entr 0.5688676238059998, f1 0.4655263423919678
ep4_l2_test_time 0.06821425900000122
Test Epoch4 layer3 Acc 0.4465789473684211, AUC 0.7046648263931274, avg_entr 0.5758823156356812, f1 0.4465789496898651
ep4_l3_test_time 0.06132404599999575
Test Epoch4 layer4 Acc 0.43842105263157893, AUC 0.7009155750274658, avg_entr 0.5634517669677734, f1 0.4384210407733917
ep4_l4_test_time 0.06229382500000469
gc 0
Train Epoch5 Acc 0.4593083333333333 (55117/120000), AUC 0.7094063758850098
ep5_train_time 4.4576793829999986
Test Epoch5 layer0 Acc 0.5007894736842106, AUC 0.7480422258377075, avg_entr 0.5193110108375549, f1 0.50078946352005
ep5_l0_test_time 0.06038586599999718
Test Epoch5 layer1 Acc 0.5086842105263157, AUC 0.750863790512085, avg_entr 0.5365028977394104, f1 0.5086842179298401
ep5_l1_test_time 0.059400611999997466
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.4776315789473684, AUC 0.7207525968551636, avg_entr 0.5343242883682251, f1 0.4776315689086914
ep5_l2_test_time 0.06506753900000461
Test Epoch5 layer3 Acc 0.45789473684210524, AUC 0.7092413902282715, avg_entr 0.5298237204551697, f1 0.4578947424888611
ep5_l3_test_time 0.061687659999996924
Test Epoch5 layer4 Acc 0.455, AUC 0.7057321667671204, avg_entr 0.508132815361023, f1 0.45500001311302185
ep5_l4_test_time 0.06227691699999838
gc 0
Train Epoch6 Acc 0.4593833333333333 (55126/120000), AUC 0.7109968662261963
ep6_train_time 4.455096781999998
Test Epoch6 layer0 Acc 0.4971052631578947, AUC 0.7491746544837952, avg_entr 0.488432377576828, f1 0.49710527062416077
ep6_l0_test_time 0.06083990300000153
Test Epoch6 layer1 Acc 0.4934210526315789, AUC 0.7509109377861023, avg_entr 0.4991919696331024, f1 0.4934210479259491
ep6_l1_test_time 0.05977295600000332
Test Epoch6 layer2 Acc 0.46578947368421053, AUC 0.7249720096588135, avg_entr 0.5083854794502258, f1 0.46578946709632874
ep6_l2_test_time 0.05992866499999394
Test Epoch6 layer3 Acc 0.4515789473684211, AUC 0.7068191766738892, avg_entr 0.5089959502220154, f1 0.45157894492149353
ep6_l3_test_time 0.06183767699999976
Test Epoch6 layer4 Acc 0.45, AUC 0.7069221138954163, avg_entr 0.4967062473297119, f1 0.44999998807907104
ep6_l4_test_time 0.062332900000001246
gc 0
Train Epoch7 Acc 0.460525 (55263/120000), AUC 0.7128943204879761
ep7_train_time 4.538503358
Test Epoch7 layer0 Acc 0.4978947368421053, AUC 0.7500089406967163, avg_entr 0.4488734006881714, f1 0.4978947341442108
ep7_l0_test_time 0.06042976199999828
Test Epoch7 layer1 Acc 0.5036842105263157, AUC 0.7498290538787842, avg_entr 0.4605148732662201, f1 0.5036842226982117
ep7_l1_test_time 0.059508448000002545
Test Epoch7 layer2 Acc 0.46842105263157896, AUC 0.7254579067230225, avg_entr 0.4631754457950592, f1 0.4684210419654846
ep7_l2_test_time 0.06014955599999894
Test Epoch7 layer3 Acc 0.45842105263157895, AUC 0.711131751537323, avg_entr 0.4586084187030792, f1 0.4584210515022278
ep7_l3_test_time 0.060987988000000826
Test Epoch7 layer4 Acc 0.4544736842105263, AUC 0.7124682664871216, avg_entr 0.4438224732875824, f1 0.45447367429733276
ep7_l4_test_time 0.06198368999999815
gc 0
Train Epoch8 Acc 0.4625916666666667 (55511/120000), AUC 0.71442049741745
ep8_train_time 4.480696737999999
Test Epoch8 layer0 Acc 0.49447368421052634, AUC 0.7513768076896667, avg_entr 0.4286290109157562, f1 0.4944736957550049
ep8_l0_test_time 0.06076934300000403
Test Epoch8 layer1 Acc 0.5039473684210526, AUC 0.7494667172431946, avg_entr 0.4432345926761627, f1 0.503947377204895
ep8_l1_test_time 0.05928223800000154
Test Epoch8 layer2 Acc 0.4792105263157895, AUC 0.7276445031166077, avg_entr 0.4491075575351715, f1 0.4792105257511139
ep8_l2_test_time 0.05973670200000214
Test Epoch8 layer3 Acc 0.4607894736842105, AUC 0.7145165205001831, avg_entr 0.4318090081214905, f1 0.4607894718647003
ep8_l3_test_time 0.06139921700000173
Test Epoch8 layer4 Acc 0.45263157894736844, AUC 0.7138904929161072, avg_entr 0.423805832862854, f1 0.4526315927505493
ep8_l4_test_time 0.061759196000004124
gc 0
Train Epoch9 Acc 0.46495 (55794/120000), AUC 0.7158212661743164
ep9_train_time 4.460042621000007
Test Epoch9 layer0 Acc 0.501578947368421, AUC 0.7521094679832458, avg_entr 0.40222543478012085, f1 0.5015789270401001
ep9_l0_test_time 0.06066961400000537
Test Epoch9 layer1 Acc 0.506578947368421, AUC 0.748742401599884, avg_entr 0.4228442311286926, f1 0.5065789222717285
ep9_l1_test_time 0.05949587899999642
Test Epoch9 layer2 Acc 0.4744736842105263, AUC 0.7255019545555115, avg_entr 0.43471747636795044, f1 0.4744736850261688
ep9_l2_test_time 0.06015587699999969
Test Epoch9 layer3 Acc 0.45921052631578946, AUC 0.7100179195404053, avg_entr 0.4130241572856903, f1 0.4592105448246002
ep9_l3_test_time 0.06109662299999741
Test Epoch9 layer4 Acc 0.45973684210526317, AUC 0.71222984790802, avg_entr 0.4039340019226074, f1 0.4597368538379669
ep9_l4_test_time 0.06204305999999349
gc 0
Train Epoch10 Acc 0.4629916666666667 (55559/120000), AUC 0.7157446146011353
ep10_train_time 4.474283029000006
Test Epoch10 layer0 Acc 0.49736842105263157, AUC 0.753199577331543, avg_entr 0.38985520601272583, f1 0.4973684251308441
ep10_l0_test_time 0.060874670000004016
Test Epoch10 layer1 Acc 0.5023684210526316, AUC 0.7471828460693359, avg_entr 0.39284101128578186, f1 0.5023684501647949
ep10_l1_test_time 0.059552368000012734
Test Epoch10 layer2 Acc 0.45631578947368423, AUC 0.7274231910705566, avg_entr 0.4001506567001343, f1 0.4563157856464386
ep10_l2_test_time 0.06131134499999291
Test Epoch10 layer3 Acc 0.4531578947368421, AUC 0.7132688760757446, avg_entr 0.37826669216156006, f1 0.453157901763916
ep10_l3_test_time 0.061775148000009494
Test Epoch10 layer4 Acc 0.45394736842105265, AUC 0.7162464261054993, avg_entr 0.34571847319602966, f1 0.45394739508628845
ep10_l4_test_time 0.061973973999997156
gc 0
Train Epoch11 Acc 0.465 (55800/120000), AUC 0.7184314727783203
ep11_train_time 4.466716289999994
Test Epoch11 layer0 Acc 0.5126315789473684, AUC 0.7536615133285522, avg_entr 0.3643076717853546, f1 0.5126315951347351
ep11_l0_test_time 0.0604358709999957
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 11
Test Epoch11 layer1 Acc 0.5123684210526316, AUC 0.7463098168373108, avg_entr 0.37905359268188477, f1 0.5123684406280518
ep11_l1_test_time 0.06430524900000023
Test Epoch11 layer2 Acc 0.48157894736842105, AUC 0.7293775677680969, avg_entr 0.3801771402359009, f1 0.4815789461135864
ep11_l2_test_time 0.06048768300000518
Test Epoch11 layer3 Acc 0.46289473684210525, AUC 0.715543270111084, avg_entr 0.36327457427978516, f1 0.4628947675228119
ep11_l3_test_time 0.061192387999994935
Test Epoch11 layer4 Acc 0.45973684210526317, AUC 0.7149932384490967, avg_entr 0.34136292338371277, f1 0.4597368538379669
ep11_l4_test_time 0.062154731999996216
gc 0
Train Epoch12 Acc 0.466275 (55953/120000), AUC 0.7201597690582275
ep12_train_time 4.508654708000009
Test Epoch12 layer0 Acc 0.5089473684210526, AUC 0.7554004192352295, avg_entr 0.35332536697387695, f1 0.5089473724365234
ep12_l0_test_time 0.06091191400000184
Test Epoch12 layer1 Acc 0.5039473684210526, AUC 0.7464635372161865, avg_entr 0.3607935309410095, f1 0.503947377204895
ep12_l1_test_time 0.05935207999999648
Test Epoch12 layer2 Acc 0.4913157894736842, AUC 0.73201984167099, avg_entr 0.3644165098667145, f1 0.4913157820701599
ep12_l2_test_time 0.06018460399999981
Test Epoch12 layer3 Acc 0.4718421052631579, AUC 0.7176720499992371, avg_entr 0.3415676951408386, f1 0.47184211015701294
ep12_l3_test_time 0.060958495000008384
Test Epoch12 layer4 Acc 0.46842105263157896, AUC 0.7174659967422485, avg_entr 0.32276585698127747, f1 0.4684210419654846
ep12_l4_test_time 0.062053413000001
gc 0
Train Epoch13 Acc 0.46655 (55986/120000), AUC 0.7201948761940002
ep13_train_time 4.476418221000003
Test Epoch13 layer0 Acc 0.48736842105263156, AUC 0.7567065358161926, avg_entr 0.34240180253982544, f1 0.4873684346675873
ep13_l0_test_time 0.06046713700000339
Test Epoch13 layer1 Acc 0.5060526315789474, AUC 0.7463943362236023, avg_entr 0.3591289818286896, f1 0.5060526132583618
ep13_l1_test_time 0.05917767600000445
Test Epoch13 layer2 Acc 0.46789473684210525, AUC 0.7286572456359863, avg_entr 0.3515530228614807, f1 0.4678947329521179
ep13_l2_test_time 0.059945506000005366
Test Epoch13 layer3 Acc 0.4626315789473684, AUC 0.7166572213172913, avg_entr 0.3284473419189453, f1 0.46263158321380615
ep13_l3_test_time 0.061095553000001246
Test Epoch13 layer4 Acc 0.46578947368421053, AUC 0.7168504595756531, avg_entr 0.3205403983592987, f1 0.46578946709632874
ep13_l4_test_time 0.06164520099999038
gc 0
Train Epoch14 Acc 0.46726666666666666 (56072/120000), AUC 0.7206702828407288
ep14_train_time 4.513320188000009
Test Epoch14 layer0 Acc 0.48105263157894734, AUC 0.757273256778717, avg_entr 0.31681036949157715, f1 0.4810526371002197
ep14_l0_test_time 0.06031234099999949
Test Epoch14 layer1 Acc 0.5052631578947369, AUC 0.744770884513855, avg_entr 0.3373276889324188, f1 0.5052631497383118
ep14_l1_test_time 0.05926677300000449
Test Epoch14 layer2 Acc 0.4710526315789474, AUC 0.732930064201355, avg_entr 0.329900324344635, f1 0.4710526168346405
ep14_l2_test_time 0.05982991500000878
Test Epoch14 layer3 Acc 0.46210526315789474, AUC 0.719545841217041, avg_entr 0.30483630299568176, f1 0.46210527420043945
ep14_l3_test_time 0.06097691899999802
Test Epoch14 layer4 Acc 0.4586842105263158, AUC 0.7195093035697937, avg_entr 0.2766627073287964, f1 0.45868417620658875
ep14_l4_test_time 0.061720549000000346
gc 0
Train Epoch15 Acc 0.46849166666666664 (56219/120000), AUC 0.7225919961929321
ep15_train_time 4.45140846000001
Test Epoch15 layer0 Acc 0.501578947368421, AUC 0.7589293122291565, avg_entr 0.3157157301902771, f1 0.5015789270401001
ep15_l0_test_time 0.06064945199999272
Test Epoch15 layer1 Acc 0.5039473684210526, AUC 0.7453977465629578, avg_entr 0.32681167125701904, f1 0.503947377204895
ep15_l1_test_time 0.060726681000005556
Test Epoch15 layer2 Acc 0.48105263157894734, AUC 0.7300558090209961, avg_entr 0.3404693603515625, f1 0.4810526371002197
ep15_l2_test_time 0.060766660999988176
Test Epoch15 layer3 Acc 0.4636842105263158, AUC 0.7165164947509766, avg_entr 0.3147944211959839, f1 0.46368420124053955
ep15_l3_test_time 0.06156358299999454
Test Epoch15 layer4 Acc 0.45657894736842103, AUC 0.7152748703956604, avg_entr 0.28776615858078003, f1 0.45657894015312195
ep15_l4_test_time 0.062041789000005565
gc 0
Train Epoch16 Acc 0.4685666666666667 (56228/120000), AUC 0.7231477499008179
ep16_train_time 4.454450596000001
Test Epoch16 layer0 Acc 0.5184210526315789, AUC 0.7606699466705322, avg_entr 0.29625433683395386, f1 0.5184210538864136
ep16_l0_test_time 0.061556666000001314
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 16
Test Epoch16 layer1 Acc 0.5023684210526316, AUC 0.7452617883682251, avg_entr 0.3209161162376404, f1 0.5023684501647949
ep16_l1_test_time 0.06595751800000471
Test Epoch16 layer2 Acc 0.48578947368421055, AUC 0.7338972091674805, avg_entr 0.305411696434021, f1 0.4857894778251648
ep16_l2_test_time 0.0605674120000117
Test Epoch16 layer3 Acc 0.45763157894736844, AUC 0.7180986404418945, avg_entr 0.30186644196510315, f1 0.45763158798217773
ep16_l3_test_time 0.06067786200000569
Test Epoch16 layer4 Acc 0.4444736842105263, AUC 0.7200517654418945, avg_entr 0.2713284492492676, f1 0.4444736838340759
ep16_l4_test_time 0.06203573100000881
gc 0
Train Epoch17 Acc 0.470225 (56427/120000), AUC 0.724194347858429
ep17_train_time 4.4936651830000045
Test Epoch17 layer0 Acc 0.5089473684210526, AUC 0.7620734572410583, avg_entr 0.30030953884124756, f1 0.5089473724365234
ep17_l0_test_time 0.060857479000006265
Test Epoch17 layer1 Acc 0.5042105263157894, AUC 0.7456938028335571, avg_entr 0.30138328671455383, f1 0.5042105317115784
ep17_l1_test_time 0.05938658399999497
Test Epoch17 layer2 Acc 0.48, AUC 0.7339445948600769, avg_entr 0.31413790583610535, f1 0.47999998927116394
ep17_l2_test_time 0.060255279999992695
Test Epoch17 layer3 Acc 0.4655263157894737, AUC 0.7187042832374573, avg_entr 0.27751490473747253, f1 0.4655263423919678
ep17_l3_test_time 0.06390371799999173
Test Epoch17 layer4 Acc 0.45552631578947367, AUC 0.720230758190155, avg_entr 0.25011011958122253, f1 0.45552632212638855
ep17_l4_test_time 0.06770300999998824
gc 0
Train Epoch18 Acc 0.470175 (56421/120000), AUC 0.7248479127883911
ep18_train_time 4.470445088999995
Test Epoch18 layer0 Acc 0.5192105263157895, AUC 0.7643424272537231, avg_entr 0.2730441093444824, f1 0.5192105174064636
ep18_l0_test_time 0.06024965400000326
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 18
Test Epoch18 layer1 Acc 0.5055263157894737, AUC 0.7459551095962524, avg_entr 0.2926691770553589, f1 0.5055263042449951
ep18_l1_test_time 0.06777957900000331
Test Epoch18 layer2 Acc 0.48526315789473684, AUC 0.7356967926025391, avg_entr 0.2969053387641907, f1 0.4852631688117981
ep18_l2_test_time 0.060437507000003166
Test Epoch18 layer3 Acc 0.4655263157894737, AUC 0.7213780879974365, avg_entr 0.26797929406166077, f1 0.4655263423919678
ep18_l3_test_time 0.06112774999999715
Test Epoch18 layer4 Acc 0.4618421052631579, AUC 0.7207139134407043, avg_entr 0.2564999461174011, f1 0.4618421196937561
ep18_l4_test_time 0.06241544799999588
gc 0
Train Epoch19 Acc 0.472625 (56715/120000), AUC 0.7263532876968384
ep19_train_time 4.4935598320000025
Test Epoch19 layer0 Acc 0.5236842105263158, AUC 0.7659372687339783, avg_entr 0.27105996012687683, f1 0.5236842036247253
ep19_l0_test_time 0.0608624040000052
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 19
Test Epoch19 layer1 Acc 0.5094736842105263, AUC 0.7460407614707947, avg_entr 0.2846984267234802, f1 0.5094736814498901
ep19_l1_test_time 0.06848456200000896
Test Epoch19 layer2 Acc 0.4892105263157895, AUC 0.7389553189277649, avg_entr 0.28046202659606934, f1 0.4892105162143707
ep19_l2_test_time 0.06081855300000427
Test Epoch19 layer3 Acc 0.46342105263157896, AUC 0.7236601710319519, avg_entr 0.25229698419570923, f1 0.4634210467338562
ep19_l3_test_time 0.06116987299999721
Test Epoch19 layer4 Acc 0.45526315789473687, AUC 0.7238226532936096, avg_entr 0.2354794591665268, f1 0.4552631676197052
ep19_l4_test_time 0.06241580400001112
Best AUC tensor(0.5237) 19 0
train_as_loss [[4.55340284e+02 3.56548304e+02 3.51070961e+02 3.49841312e+02
  3.49372377e+02 3.49145770e+02 3.49020399e+02 3.48944734e+02
  3.48896265e+02 3.48863843e+02 3.48841457e+02 3.48825623e+02
  3.48814212e+02 3.48805874e+02 3.48799707e+02 3.48795109e+02
  3.48791652e+02 3.48789035e+02 3.48787050e+02 3.48785555e+02]
 [1.81857112e+00 1.15356116e-05 8.04256442e-07 1.61603892e-07
  4.92867839e-08 1.90027643e-08 1.98511544e-06 4.56125876e-05
  1.33599512e-04 1.67266088e-04 7.50109253e-07 1.82892332e-09
  3.90339251e-09 1.03524312e-04 1.07606684e-08 1.17881260e-09
  3.84247427e-08 3.35145915e-05 1.55745883e-07 8.20511529e-10]
 [1.46622084e+00 9.17719494e-06 7.25412119e-07 1.62473175e-07
  5.86002934e-08 5.98494547e-07 4.46489379e-06 1.04987298e-04
  3.79486255e-04 5.11114143e-04 2.14175934e-05 3.83781687e-04
  3.75620115e-04 1.16512654e-03 4.16592685e-04 6.15295965e-04
  4.48164537e-04 8.49893315e-04 3.85295467e-04 8.29369571e-04]
 [1.57310669e+00 9.32332378e-06 8.53392682e-07 2.24838196e-07
  1.10729624e-07 9.74397282e-08 4.71953659e-06 1.56597758e-04
  5.74189814e-04 7.91554361e-04 1.02102272e-04 8.15877738e-04
  6.04443335e-04 2.10813141e-03 7.58893352e-04 1.22427991e-03
  7.23257745e-04 1.61845203e-03 6.52557164e-04 1.44524134e-03]
 [1.67554907e+00 1.13966776e-05 1.29782509e-06 4.34531696e-07
  3.09008959e-07 2.32023058e-07 5.15565181e-06 2.08287486e-04
  8.11567208e-04 1.09712047e-03 3.97133103e-04 1.12489048e-03
  8.07342161e-04 2.96870720e-03 9.67961876e-04 1.87550830e-03
  9.05275123e-04 2.38481783e-03 8.90452083e-04 1.78990979e-03]]
train_ae_loss [[17.48229523 24.33965468 28.67857573 31.63099471 34.13996053 36.05652246
  37.87620509 39.33277696 40.82201095 42.1130779  43.44019569 44.38742821
  45.53497507 46.67823946 47.75788057 48.65081641 49.59291224 50.5019554
  51.41021256 52.19635366]
 [18.98421181 26.21484195 29.96114664 32.43911883 34.59423424 36.11174369
  37.77335425 38.98036446 40.31115846 41.38682125 42.19494976 43.14064986
  44.07997769 45.04395325 45.72614046 46.53564031 47.30265103 48.04920086
  48.66414493 49.35877313]
 [18.37896064 25.82785687 29.18931667 31.21213308 32.86913917 34.03170858
  35.30914351 36.29170302 37.22768501 38.06507529 38.90529861 39.45181807
  40.02577585 40.64725315 41.15287907 41.48181342 41.97834597 42.38663478
  42.78031058 43.04107594]
 [15.42021309 24.13423401 27.23162114 28.90443148 30.26321444 31.24477599
  32.20393539 33.02885485 33.76166117 34.47528633 35.07118096 35.54325663
  35.9657493  36.32280149 36.73225425 36.74578684 37.088081   37.3198055
  37.39794209 37.40267199]
 [12.93665195 22.31683028 25.09369144 26.42404135 27.49024814 28.23062961
  28.99409902 29.62652392 30.18347809 30.65608241 31.11147028 31.41100831
  31.67590429 31.79289989 32.02944807 31.83002677 31.99241974 32.01033585
  31.83412033 31.65470477]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 99.36060069700001
Start Testing
Load ckpt at ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt
gc 10
Test layer0 Acc 0.5144736842105263, AUC 0.7622883915901184, avg_entr 0.26886823773384094, f1 0.5144736766815186
l0_test_time 0.05946512200000598
gc 0
Test layer1 Acc 0.4918421052631579, AUC 0.7337865233421326, avg_entr 0.2850511372089386, f1 0.4918420910835266
l1_test_time 0.06084041100000093
gc 0
Test layer2 Acc 0.48789473684210527, AUC 0.7367190718650818, avg_entr 0.2796951234340668, f1 0.487894743680954
l2_test_time 0.061738645000005477
gc 0
Test layer3 Acc 0.4618421052631579, AUC 0.7209522724151611, avg_entr 0.25134870409965515, f1 0.4618421196937561
l3_test_time 0.062876825999993
gc 0
Test layer4 Acc 0.45342105263157895, AUC 0.7210041284561157, avg_entr 0.23394253849983215, f1 0.45342105627059937
l4_test_time 0.06362081899999339
gc 0
Test threshold 0.1 Acc 0.515, AUC 0.7600672245025635, avg_entr 0.12032149732112885, f1 0.5149999856948853
t0.1_test_time 0.11405776899999864
gc 0
Test threshold 0.2 Acc 0.5113157894736842, AUC 0.7530457377433777, avg_entr 0.1203174963593483, f1 0.5113157629966736
t0.2_test_time 0.09840607900000009
gc 0
Test threshold 0.3 Acc 0.5139473684210526, AUC 0.7554988861083984, avg_entr 0.16192393004894257, f1 0.5139473676681519
t0.3_test_time 0.08719216900000504
gc 0
Test threshold 0.4 Acc 0.5142105263157895, AUC 0.7584226131439209, avg_entr 0.18174852430820465, f1 0.5142105221748352
t0.4_test_time 0.07919276900000227
gc 0
Test threshold 0.5 Acc 0.5157894736842106, AUC 0.7623315453529358, avg_entr 0.1915736198425293, f1 0.5157894492149353
t0.5_test_time 0.0759004009999984
gc 0
Test threshold 0.6 Acc 0.5144736842105263, AUC 0.7622429728507996, avg_entr 0.19383087754249573, f1 0.5144736766815186
t0.6_test_time 0.07246783799999434
gc 0
Test threshold 0.7 Acc 0.5144736842105263, AUC 0.7622883915901184, avg_entr 0.193947434425354, f1 0.5144736766815186
t0.7_test_time 0.072462110999993
gc 0
Test threshold 0.8 Acc 0.5144736842105263, AUC 0.7622883915901184, avg_entr 0.193947434425354, f1 0.5144736766815186
t0.8_test_time 0.07247686300000566
gc 0
Test threshold 0.9 Acc 0.5144736842105263, AUC 0.7622883915901184, avg_entr 0.193947434425354, f1 0.5144736766815186
t0.9_test_time 0.07208065100000738
