total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearALsideText(
  (layers): ModuleList(
    (0): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.0.weight 90000
layers.0.enc.f.0.bias 300
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 45777392
init_time 15.030938225999998
Start Training
gc 0
Train Epoch0 Acc 0.27926666666666666 (33512/120000), AUC 0.5149974226951599
ep0_train_time 4.831636088
Test Epoch0 layer0 Acc 0.3389473684210526, AUC 0.6887337565422058, avg_entr 1.206068992614746, f1 0.3389473557472229
ep0_l0_test_time 0.06121766499999737
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.33157894736842103, AUC 0.6497121453285217, avg_entr 1.2245736122131348, f1 0.33157894015312195
ep0_l1_test_time 0.06599203500000073
Test Epoch0 layer2 Acc 0.3352631578947368, AUC 0.609380841255188, avg_entr 1.229760766029358, f1 0.3352631628513336
ep0_l2_test_time 0.05960285999999826
Test Epoch0 layer3 Acc 0.3078947368421053, AUC 0.5869358777999878, avg_entr 1.228014349937439, f1 0.3078947365283966
ep0_l3_test_time 0.06043177500000141
Test Epoch0 layer4 Acc 0.2968421052631579, AUC 0.5851399898529053, avg_entr 1.2301785945892334, f1 0.296842098236084
ep0_l4_test_time 0.06107446400000072
gc 0
Train Epoch1 Acc 0.3475083333333333 (41701/120000), AUC 0.6016824841499329
ep1_train_time 4.480114368999999
Test Epoch1 layer0 Acc 0.47368421052631576, AUC 0.7336788773536682, avg_entr 0.8644574880599976, f1 0.4736842215061188
ep1_l0_test_time 0.05983700900000244
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.4457894736842105, AUC 0.7121348977088928, avg_entr 0.8777396082878113, f1 0.44578948616981506
ep1_l1_test_time 0.06685883900000178
Test Epoch1 layer2 Acc 0.4139473684210526, AUC 0.6666750311851501, avg_entr 0.8899969458580017, f1 0.41394737362861633
ep1_l2_test_time 0.05969170399999868
Test Epoch1 layer3 Acc 0.37605263157894736, AUC 0.6465954184532166, avg_entr 0.892196774482727, f1 0.3760526180267334
ep1_l3_test_time 0.06059717799999831
Test Epoch1 layer4 Acc 0.36947368421052634, AUC 0.6416962742805481, avg_entr 0.901631772518158, f1 0.36947372555732727
ep1_l4_test_time 0.06164617099999958
gc 0
Train Epoch2 Acc 0.40194166666666664 (48233/120000), AUC 0.6586101055145264
ep2_train_time 4.3947719979999995
Test Epoch2 layer0 Acc 0.4905263157894737, AUC 0.743232786655426, avg_entr 0.7118929624557495, f1 0.49052631855010986
ep2_l0_test_time 0.06034112000000036
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.48210526315789476, AUC 0.7317579984664917, avg_entr 0.7333383560180664, f1 0.4821052551269531
ep2_l1_test_time 0.0668973820000005
Test Epoch2 layer2 Acc 0.4342105263157895, AUC 0.6909506320953369, avg_entr 0.7272356748580933, f1 0.43421053886413574
ep2_l2_test_time 0.060284928000001514
Test Epoch2 layer3 Acc 0.4139473684210526, AUC 0.6729124784469604, avg_entr 0.7330169081687927, f1 0.41394737362861633
ep2_l3_test_time 0.060292723999999964
Test Epoch2 layer4 Acc 0.4086842105263158, AUC 0.6696786284446716, avg_entr 0.7297855615615845, f1 0.40868422389030457
ep2_l4_test_time 0.06124661700000189
gc 0
Train Epoch3 Acc 0.4252166666666667 (51026/120000), AUC 0.6797388195991516
ep3_train_time 4.393149430999998
Test Epoch3 layer0 Acc 0.4818421052631579, AUC 0.7460190653800964, avg_entr 0.6191302537918091, f1 0.4818421006202698
ep3_l0_test_time 0.06001046600000137
Test Epoch3 layer1 Acc 0.46657894736842104, AUC 0.7374110221862793, avg_entr 0.632495641708374, f1 0.46657896041870117
ep3_l1_test_time 0.05858615200000372
Test Epoch3 layer2 Acc 0.4465789473684211, AUC 0.7048299908638, avg_entr 0.6430342197418213, f1 0.4465789496898651
ep3_l2_test_time 0.05924006100000412
Test Epoch3 layer3 Acc 0.43105263157894735, AUC 0.6855229139328003, avg_entr 0.6476112008094788, f1 0.43105262517929077
ep3_l3_test_time 0.060288735000000315
Test Epoch3 layer4 Acc 0.42605263157894735, AUC 0.6849952936172485, avg_entr 0.6408995985984802, f1 0.42605262994766235
ep3_l4_test_time 0.06145776599999664
gc 0
Train Epoch4 Acc 0.438725 (52647/120000), AUC 0.6908230185508728
ep4_train_time 4.408743431000005
Test Epoch4 layer0 Acc 0.495, AUC 0.7474218606948853, avg_entr 0.5649889707565308, f1 0.4950000047683716
ep4_l0_test_time 0.06012840200000369
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.49315789473684213, AUC 0.7377249002456665, avg_entr 0.5858290791511536, f1 0.49315789341926575
ep4_l1_test_time 0.06805027500000449
Test Epoch4 layer2 Acc 0.4473684210526316, AUC 0.704590916633606, avg_entr 0.5960485339164734, f1 0.44736841320991516
ep4_l2_test_time 0.060013809000004414
Test Epoch4 layer3 Acc 0.4392105263157895, AUC 0.68680739402771, avg_entr 0.5937827825546265, f1 0.43921053409576416
ep4_l3_test_time 0.06131889800000323
Test Epoch4 layer4 Acc 0.4286842105263158, AUC 0.6847820281982422, avg_entr 0.5894507765769958, f1 0.42868420481681824
ep4_l4_test_time 0.06232054400000209
gc 0
Train Epoch5 Acc 0.444925 (53391/120000), AUC 0.6982499957084656
ep5_train_time 4.4021289110000055
Test Epoch5 layer0 Acc 0.475, AUC 0.7478717565536499, avg_entr 0.5083755850791931, f1 0.4749999940395355
ep5_l0_test_time 0.059956821000000105
Test Epoch5 layer1 Acc 0.48736842105263156, AUC 0.7384591698646545, avg_entr 0.534284770488739, f1 0.4873684346675873
ep5_l1_test_time 0.058801929000004804
Test Epoch5 layer2 Acc 0.44526315789473686, AUC 0.7093580961227417, avg_entr 0.538729727268219, f1 0.445263147354126
ep5_l2_test_time 0.059644459999994126
Test Epoch5 layer3 Acc 0.4336842105263158, AUC 0.6910338997840881, avg_entr 0.5443301200866699, f1 0.43368420004844666
ep5_l3_test_time 0.060690547999996625
Test Epoch5 layer4 Acc 0.4313157894736842, AUC 0.6892451047897339, avg_entr 0.5262312293052673, f1 0.4313158094882965
ep5_l4_test_time 0.06136283800000086
gc 0
Train Epoch6 Acc 0.45095 (54114/120000), AUC 0.7024192810058594
ep6_train_time 4.408947556999998
Test Epoch6 layer0 Acc 0.49605263157894736, AUC 0.7499762177467346, avg_entr 0.4870990216732025, f1 0.496052622795105
ep6_l0_test_time 0.05955279900000221
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.485, AUC 0.7396991848945618, avg_entr 0.49402567744255066, f1 0.48500001430511475
ep6_l1_test_time 0.06774158700000044
Test Epoch6 layer2 Acc 0.4660526315789474, AUC 0.7128599882125854, avg_entr 0.5096286535263062, f1 0.4660526216030121
ep6_l2_test_time 0.06006545700000032
Test Epoch6 layer3 Acc 0.45263157894736844, AUC 0.6974354386329651, avg_entr 0.5071906447410583, f1 0.4526315927505493
ep6_l3_test_time 0.06039400400000261
Test Epoch6 layer4 Acc 0.44342105263157894, AUC 0.6962542533874512, avg_entr 0.4977009892463684, f1 0.44342106580734253
ep6_l4_test_time 0.061510278000000085
gc 0
Train Epoch7 Acc 0.45495 (54594/120000), AUC 0.7076785564422607
ep7_train_time 4.4572700280000035
Test Epoch7 layer0 Acc 0.4994736842105263, AUC 0.7505943179130554, avg_entr 0.4546370208263397, f1 0.4994736909866333
ep7_l0_test_time 0.059828334000002314
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 7
Test Epoch7 layer1 Acc 0.48105263157894734, AUC 0.740946888923645, avg_entr 0.4653351902961731, f1 0.4810526371002197
ep7_l1_test_time 0.0675015069999958
Test Epoch7 layer2 Acc 0.4618421052631579, AUC 0.7184532880783081, avg_entr 0.4729361832141876, f1 0.4618421196937561
ep7_l2_test_time 0.059969483000003265
Test Epoch7 layer3 Acc 0.4457894736842105, AUC 0.7028319239616394, avg_entr 0.46836188435554504, f1 0.44578948616981506
ep7_l3_test_time 0.06063060800000386
Test Epoch7 layer4 Acc 0.4363157894736842, AUC 0.702691376209259, avg_entr 0.45430299639701843, f1 0.43631577491760254
ep7_l4_test_time 0.06196525500000405
gc 0
Train Epoch8 Acc 0.45693333333333336 (54832/120000), AUC 0.7102428078651428
ep8_train_time 4.464256701000004
Test Epoch8 layer0 Acc 0.49657894736842106, AUC 0.7516494989395142, avg_entr 0.4338729679584503, f1 0.49657896161079407
ep8_l0_test_time 0.05998867000000274
Test Epoch8 layer1 Acc 0.48973684210526314, AUC 0.7408192157745361, avg_entr 0.43662476539611816, f1 0.4897368550300598
ep8_l1_test_time 0.05884575999999697
Test Epoch8 layer2 Acc 0.4610526315789474, AUC 0.7189877033233643, avg_entr 0.45197594165802, f1 0.46105262637138367
ep8_l2_test_time 0.05956536600000106
Test Epoch8 layer3 Acc 0.45052631578947366, AUC 0.7020589113235474, avg_entr 0.44320836663246155, f1 0.45052632689476013
ep8_l3_test_time 0.06116072999999744
Test Epoch8 layer4 Acc 0.445, AUC 0.7035549879074097, avg_entr 0.42195752263069153, f1 0.4449999928474426
ep8_l4_test_time 0.06132517700000051
gc 0
Train Epoch9 Acc 0.458825 (55059/120000), AUC 0.7132673859596252
ep9_train_time 4.450202214999997
Test Epoch9 layer0 Acc 0.49473684210526314, AUC 0.752855658531189, avg_entr 0.41890785098075867, f1 0.49473685026168823
ep9_l0_test_time 0.06044785100000638
Test Epoch9 layer1 Acc 0.4681578947368421, AUC 0.739125669002533, avg_entr 0.44440633058547974, f1 0.46815788745880127
ep9_l1_test_time 0.05977932499999383
Test Epoch9 layer2 Acc 0.4573684210526316, AUC 0.7157799601554871, avg_entr 0.4417871832847595, f1 0.4573684334754944
ep9_l2_test_time 0.059516951999995626
Test Epoch9 layer3 Acc 0.4355263157894737, AUC 0.6959553956985474, avg_entr 0.435764342546463, f1 0.4355263113975525
ep9_l3_test_time 0.06053039300000762
Test Epoch9 layer4 Acc 0.425, AUC 0.6965410113334656, avg_entr 0.41385015845298767, f1 0.42500001192092896
ep9_l4_test_time 0.061064596000008464
gc 0
Train Epoch10 Acc 0.45960833333333334 (55153/120000), AUC 0.7125067114830017
ep10_train_time 4.418793893
Test Epoch10 layer0 Acc 0.5028947368421053, AUC 0.75337153673172, avg_entr 0.38399362564086914, f1 0.5028947591781616
ep10_l0_test_time 0.060269558000001666
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 10
Test Epoch10 layer1 Acc 0.48657894736842106, AUC 0.7405208945274353, avg_entr 0.3948751986026764, f1 0.48657894134521484
ep10_l1_test_time 0.06338929700000051
Test Epoch10 layer2 Acc 0.4705263157894737, AUC 0.7193140387535095, avg_entr 0.4098680317401886, f1 0.4705263078212738
ep10_l2_test_time 0.05972189599999922
Test Epoch10 layer3 Acc 0.4463157894736842, AUC 0.7003989219665527, avg_entr 0.3947484493255615, f1 0.44631579518318176
ep10_l3_test_time 0.06050824700000135
Test Epoch10 layer4 Acc 0.45263157894736844, AUC 0.7049211263656616, avg_entr 0.3723241686820984, f1 0.4526315927505493
ep10_l4_test_time 0.061554518999997754
gc 0
Train Epoch11 Acc 0.458275 (54993/120000), AUC 0.714255690574646
ep11_train_time 4.409659242999993
Test Epoch11 layer0 Acc 0.4881578947368421, AUC 0.7546766996383667, avg_entr 0.3742595911026001, f1 0.48815789818763733
ep11_l0_test_time 0.06018232499999954
Test Epoch11 layer1 Acc 0.48473684210526313, AUC 0.7410933375358582, avg_entr 0.3669089674949646, f1 0.484736829996109
ep11_l1_test_time 0.05871884099998681
Test Epoch11 layer2 Acc 0.4705263157894737, AUC 0.7183171510696411, avg_entr 0.3762362003326416, f1 0.4705263078212738
ep11_l2_test_time 0.05934343900000272
Test Epoch11 layer3 Acc 0.45342105263157895, AUC 0.7019795775413513, avg_entr 0.373788446187973, f1 0.45342105627059937
ep11_l3_test_time 0.06068687800001271
Test Epoch11 layer4 Acc 0.45263157894736844, AUC 0.7054144144058228, avg_entr 0.33960840106010437, f1 0.4526315927505493
ep11_l4_test_time 0.061190579000012235
gc 0
Train Epoch12 Acc 0.461275 (55353/120000), AUC 0.7166857719421387
ep12_train_time 4.510779039000013
Test Epoch12 layer0 Acc 0.5055263157894737, AUC 0.7558248043060303, avg_entr 0.3479248583316803, f1 0.5055263042449951
ep12_l0_test_time 0.060660408999993365
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 12
Test Epoch12 layer1 Acc 0.48710526315789476, AUC 0.7407268285751343, avg_entr 0.3559052050113678, f1 0.48710522055625916
ep12_l1_test_time 0.06756456899999819
Test Epoch12 layer2 Acc 0.45763157894736844, AUC 0.7204818725585938, avg_entr 0.37210261821746826, f1 0.45763158798217773
ep12_l2_test_time 0.05996787600000175
Test Epoch12 layer3 Acc 0.4536842105263158, AUC 0.7023768424987793, avg_entr 0.35238024592399597, f1 0.4536842107772827
ep12_l3_test_time 0.06043392700000538
Test Epoch12 layer4 Acc 0.45710526315789474, AUC 0.7057790756225586, avg_entr 0.33155524730682373, f1 0.45710524916648865
ep12_l4_test_time 0.062086011000005215
gc 0
Train Epoch13 Acc 0.46135 (55362/120000), AUC 0.7177177667617798
ep13_train_time 4.534064490000006
Test Epoch13 layer0 Acc 0.5021052631578947, AUC 0.7572200894355774, avg_entr 0.34093907475471497, f1 0.5021052360534668
ep13_l0_test_time 0.06076681599999745
Test Epoch13 layer1 Acc 0.4942105263157895, AUC 0.7409487962722778, avg_entr 0.3465016484260559, f1 0.49421051144599915
ep13_l1_test_time 0.059569132999996555
Test Epoch13 layer2 Acc 0.46157894736842103, AUC 0.7165002822875977, avg_entr 0.3536187410354614, f1 0.46157893538475037
ep13_l2_test_time 0.0600831750000026
Test Epoch13 layer3 Acc 0.44921052631578945, AUC 0.6994914412498474, avg_entr 0.33479043841362, f1 0.449210524559021
ep13_l3_test_time 0.06128895999999884
Test Epoch13 layer4 Acc 0.45263157894736844, AUC 0.7018203735351562, avg_entr 0.3156660199165344, f1 0.4526315927505493
ep13_l4_test_time 0.06196252700000571
gc 0
Train Epoch14 Acc 0.46145833333333336 (55375/120000), AUC 0.7174829244613647
ep14_train_time 4.522714629999996
Test Epoch14 layer0 Acc 0.5081578947368421, AUC 0.7582166194915771, avg_entr 0.3260798752307892, f1 0.5081579089164734
ep14_l0_test_time 0.06007455900000025
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 14
Test Epoch14 layer1 Acc 0.4905263157894737, AUC 0.7405281662940979, avg_entr 0.32527121901512146, f1 0.49052631855010986
ep14_l1_test_time 0.0806963730000092
Test Epoch14 layer2 Acc 0.45657894736842103, AUC 0.7184141278266907, avg_entr 0.34679070115089417, f1 0.45657894015312195
ep14_l2_test_time 0.05950745799999879
Test Epoch14 layer3 Acc 0.4457894736842105, AUC 0.7008168697357178, avg_entr 0.32172468304634094, f1 0.44578948616981506
ep14_l3_test_time 0.06012102200000413
Test Epoch14 layer4 Acc 0.4463157894736842, AUC 0.7040966153144836, avg_entr 0.29322415590286255, f1 0.44631579518318176
ep14_l4_test_time 0.06179904200000408
gc 0
Train Epoch15 Acc 0.46071666666666666 (55286/120000), AUC 0.7168262004852295
ep15_train_time 4.507647582999994
Test Epoch15 layer0 Acc 0.49473684210526314, AUC 0.7594389319419861, avg_entr 0.30583104491233826, f1 0.49473685026168823
ep15_l0_test_time 0.06028426499999284
Test Epoch15 layer1 Acc 0.48026315789473684, AUC 0.7415249347686768, avg_entr 0.31471750140190125, f1 0.4802631437778473
ep15_l1_test_time 0.0588567960000006
Test Epoch15 layer2 Acc 0.45552631578947367, AUC 0.7185571789741516, avg_entr 0.33737102150917053, f1 0.45552632212638855
ep15_l2_test_time 0.059259629999999675
Test Epoch15 layer3 Acc 0.45210526315789473, AUC 0.7029329538345337, avg_entr 0.32065072655677795, f1 0.45210522413253784
ep15_l3_test_time 0.06050529099999835
Test Epoch15 layer4 Acc 0.4463157894736842, AUC 0.7043076157569885, avg_entr 0.3046363592147827, f1 0.44631579518318176
ep15_l4_test_time 0.06128159500001118
gc 0
Train Epoch16 Acc 0.461225 (55347/120000), AUC 0.716960072517395
ep16_train_time 4.587476360000011
Test Epoch16 layer0 Acc 0.5063157894736842, AUC 0.7612255215644836, avg_entr 0.2959877550601959, f1 0.5063157677650452
ep16_l0_test_time 0.05979604300000574
Test Epoch16 layer1 Acc 0.49447368421052634, AUC 0.7417052984237671, avg_entr 0.3004330098628998, f1 0.4944736957550049
ep16_l1_test_time 0.058811869999999544
Test Epoch16 layer2 Acc 0.44710526315789473, AUC 0.7192909717559814, avg_entr 0.3104706108570099, f1 0.4471052587032318
ep16_l2_test_time 0.05968238399999848
Test Epoch16 layer3 Acc 0.44552631578947366, AUC 0.6993348002433777, avg_entr 0.3007791042327881, f1 0.4455263018608093
ep16_l3_test_time 0.061205471999997485
Test Epoch16 layer4 Acc 0.4473684210526316, AUC 0.7023729681968689, avg_entr 0.2762320339679718, f1 0.44736841320991516
ep16_l4_test_time 0.0615011770000109
gc 0
Train Epoch17 Acc 0.4623583333333333 (55483/120000), AUC 0.7192897796630859
ep17_train_time 4.459620399000002
Test Epoch17 layer0 Acc 0.5071052631578947, AUC 0.763202428817749, avg_entr 0.2861844003200531, f1 0.50710529088974
ep17_l0_test_time 0.060115584999991256
Test Epoch17 layer1 Acc 0.4818421052631579, AUC 0.7434642314910889, avg_entr 0.29368045926094055, f1 0.4818421006202698
ep17_l1_test_time 0.059227599999999825
Test Epoch17 layer2 Acc 0.46789473684210525, AUC 0.7188891172409058, avg_entr 0.30278387665748596, f1 0.4678947329521179
ep17_l2_test_time 0.05995656400000371
Test Epoch17 layer3 Acc 0.4486842105263158, AUC 0.6998288631439209, avg_entr 0.28264927864074707, f1 0.4486842155456543
ep17_l3_test_time 0.060839028000003736
Test Epoch17 layer4 Acc 0.44394736842105265, AUC 0.7020371556282043, avg_entr 0.25916898250579834, f1 0.44394737482070923
ep17_l4_test_time 0.061616592999996556
gc 0
Train Epoch18 Acc 0.46295 (55554/120000), AUC 0.7206244468688965
ep18_train_time 4.462540950999994
Test Epoch18 layer0 Acc 0.5102631578947369, AUC 0.7649272680282593, avg_entr 0.27583298087120056, f1 0.5102631449699402
ep18_l0_test_time 0.05992267000000595
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 18
Test Epoch18 layer1 Acc 0.48657894736842106, AUC 0.7452161312103271, avg_entr 0.2819989025592804, f1 0.48657894134521484
ep18_l1_test_time 0.06614504499999896
Test Epoch18 layer2 Acc 0.45789473684210524, AUC 0.7195285558700562, avg_entr 0.2928514778614044, f1 0.4578947424888611
ep18_l2_test_time 0.06021262900000579
Test Epoch18 layer3 Acc 0.4363157894736842, AUC 0.7016447186470032, avg_entr 0.27553054690361023, f1 0.43631577491760254
ep18_l3_test_time 0.06070833399999742
Test Epoch18 layer4 Acc 0.4423684210526316, AUC 0.7045756578445435, avg_entr 0.25626927614212036, f1 0.44236841797828674
ep18_l4_test_time 0.06195963599999743
gc 0
Train Epoch19 Acc 0.46434166666666665 (55721/120000), AUC 0.7214218378067017
ep19_train_time 4.488083129000003
Test Epoch19 layer0 Acc 0.5152631578947369, AUC 0.7672336101531982, avg_entr 0.26592448353767395, f1 0.5152631402015686
ep19_l0_test_time 0.06059783900001037
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 19
Test Epoch19 layer1 Acc 0.49736842105263157, AUC 0.7464244365692139, avg_entr 0.2686556875705719, f1 0.4973684251308441
ep19_l1_test_time 0.06820121699999504
Test Epoch19 layer2 Acc 0.465, AUC 0.721660315990448, avg_entr 0.28039872646331787, f1 0.4650000035762787
ep19_l2_test_time 0.06034390099999598
Test Epoch19 layer3 Acc 0.4507894736842105, AUC 0.7050200700759888, avg_entr 0.26626601815223694, f1 0.4507894814014435
ep19_l3_test_time 0.060607398999991346
Test Epoch19 layer4 Acc 0.4481578947368421, AUC 0.7077435255050659, avg_entr 0.2521551251411438, f1 0.4481579065322876
ep19_l4_test_time 0.06244306399999289
Best AUC tensor(0.5153) 19 0
train_as_loss [[4.57399458e+02 3.57064438e+02 3.51229419e+02 3.49914075e+02
  3.49412375e+02 3.49170044e+02 3.49036075e+02 3.48955290e+02
  3.48903576e+02 3.48869019e+02 3.48845179e+02 3.48828332e+02
  3.48816199e+02 3.48807345e+02 3.48800795e+02 3.48795931e+02
  3.48792246e+02 3.48789500e+02 3.48787395e+02 3.48785803e+02]
 [1.49956764e+00 1.39010294e-05 1.05418022e-06 2.12732254e-07
  6.46367088e-08 2.47985928e-08 7.98522267e-07 1.38047042e-05
  6.02308887e-05 1.51053759e-04 2.69265135e-04 3.07403250e-04
  4.96330901e-04 4.18102173e-04 5.72355346e-04 5.05380330e-04
  7.21251017e-04 8.30446513e-04 4.84962631e-04 6.98079853e-04]
 [1.71941799e+00 1.09947508e-05 8.54461397e-07 1.84876013e-07
  6.27050446e-08 2.82258073e-08 6.07674878e-07 2.21049838e-05
  1.40985129e-04 3.27634127e-04 5.52020062e-04 6.22127685e-04
  1.00024847e-03 7.91762351e-04 1.02412931e-03 9.00046516e-04
  1.21733327e-03 3.91891703e-04 2.63834902e-04 4.32079138e-04]
 [1.41571985e+00 1.04945282e-05 9.45443882e-07 2.43096868e-07
  1.05279517e-07 6.39472619e-08 9.39674706e-07 4.72564699e-05
  3.70954756e-04 7.53885786e-04 1.10366296e-03 1.10807513e-03
  5.84389682e-04 4.95825295e-04 6.71480297e-04 5.84975492e-04
  8.40224052e-04 4.50360128e-04 3.47298670e-04 5.35005496e-04]
 [1.58407593e+00 1.31724493e-05 1.40314471e-06 4.91686727e-07
  2.87980920e-07 2.34197473e-07 1.09923338e-06 7.97948923e-05
  6.80125180e-04 1.22498042e-03 1.56088406e-03 1.51569101e-03
  1.03950456e-03 1.01920883e-03 1.36219364e-03 1.33827622e-03
  1.63886064e-03 3.42630908e-04 3.03248709e-04 5.45853557e-04]]
train_ae_loss [[16.72541276 23.01223223 27.18227144 30.34113991 32.67617531 34.6338006
  36.42065997 37.86039709 39.40159099 40.6537452  42.00332776 43.13366165
  44.23344845 45.20463613 46.29582097 47.29651566 48.29809972 49.21416371
  50.0136577  50.79757742]
 [15.77775664 21.57222112 24.8040349  27.12098421 28.89500212 30.34469352
  31.69988912 32.7399896  33.90419027 34.81082793 35.81158692 36.66132466
  37.38575619 38.09049821 38.85687189 39.5699857  40.22124432 40.75559512
  41.23953105 41.69573409]
 [16.04793886 22.22419036 25.33658494 27.29091006 28.72364977 29.86256369
  30.86017191 31.62031358 32.52137338 33.18472007 34.02591374 34.68549495
  35.22485391 35.76552247 36.32728306 36.85783897 37.34647299 37.47048805
  37.92333292 38.34486498]
 [13.73007892 20.57390254 23.28303451 24.90453841 26.05325064 26.95017474
  27.7095977  28.30941615 28.9486772  29.43157566 30.03017269 30.4747254
  30.72275158 31.16907831 31.59828699 32.03065275 32.40547709 32.70564665
  32.97653189 33.30004378]
 [11.31951658 19.42723488 21.91732211 23.28756234 24.20863251 24.92587878
  25.5213105  25.99392757 26.46185661 26.76266575 27.16196211 27.40291939
  27.59134416 27.89169252 28.14698556 28.37334598 28.54414371 28.60101511
  28.82147395 29.06010829]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 99.13688592400001
Start Testing
Load ckpt at ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt
gc 10
Test layer0 Acc 0.5226315789473684, AUC 0.7635893225669861, avg_entr 0.26389625668525696, f1 0.5226315855979919
l0_test_time 0.05870674999999892
gc 0
Test layer1 Acc 0.48105263157894734, AUC 0.7356045842170715, avg_entr 0.26776617765426636, f1 0.4810526371002197
l1_test_time 0.05977157399999555
gc 0
Test layer2 Acc 0.46157894736842103, AUC 0.7217831611633301, avg_entr 0.27549341320991516, f1 0.46157893538475037
l2_test_time 0.060697988000001146
gc 0
Test layer3 Acc 0.4536842105263158, AUC 0.7128620147705078, avg_entr 0.26236268877983093, f1 0.4536842107772827
l3_test_time 0.06174470300000223
gc 0
Test layer4 Acc 0.44842105263157894, AUC 0.7120618224143982, avg_entr 0.24849653244018555, f1 0.44842109084129333
l4_test_time 0.06368854199999419
gc 0
Test threshold 0.1 Acc 0.5057894736842106, AUC 0.7586017847061157, avg_entr 0.12328121066093445, f1 0.5057894587516785
t0.1_test_time 0.11136915199999464
gc 0
Test threshold 0.2 Acc 0.516578947368421, AUC 0.759284257888794, avg_entr 0.11940022557973862, f1 0.5165789723396301
t0.2_test_time 0.09619501499999217
gc 0
Test threshold 0.3 Acc 0.5231578947368422, AUC 0.7609752416610718, avg_entr 0.15938739478588104, f1 0.5231578946113586
t0.3_test_time 0.08411018900000045
gc 0
Test threshold 0.4 Acc 0.5257894736842105, AUC 0.7629928588867188, avg_entr 0.17976021766662598, f1 0.5257894992828369
t0.4_test_time 0.07631958499999314
gc 0
Test threshold 0.5 Acc 0.5236842105263158, AUC 0.7634091377258301, avg_entr 0.1879366636276245, f1 0.5236842036247253
t0.5_test_time 0.07512065000000234
gc 0
Test threshold 0.6 Acc 0.5226315789473684, AUC 0.7635893225669861, avg_entr 0.190360888838768, f1 0.5226315855979919
t0.6_test_time 0.07112394499999652
gc 0
Test threshold 0.7 Acc 0.5226315789473684, AUC 0.7635893225669861, avg_entr 0.190360888838768, f1 0.5226315855979919
t0.7_test_time 0.07183201200000155
gc 0
Test threshold 0.8 Acc 0.5226315789473684, AUC 0.7635893225669861, avg_entr 0.190360888838768, f1 0.5226315855979919
t0.8_test_time 0.07128938099999971
gc 0
Test threshold 0.9 Acc 0.5226315789473684, AUC 0.7635893225669861, avg_entr 0.190360888838768, f1 0.5226315855979919
t0.9_test_time 0.07157400100000189
