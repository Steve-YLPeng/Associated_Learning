total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 48937892
init_time 15.701172160999999
Start Training
gc 0
Train Epoch0 Acc 0.2537 (30444/120000), AUC 0.501380205154419
ep0_train_time 12.792711612000002
Test Epoch0 layer0 Acc 0.7131578947368421, AUC 0.9032479524612427, avg_entr 0.8345485925674438, f1 0.7131578326225281
ep0_l0_test_time 0.06561618799999991
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.695, AUC 0.8960318565368652, avg_entr 0.8191044926643372, f1 0.6949999928474426
ep0_l1_test_time 0.07555748199999712
Test Epoch0 layer2 Acc 0.6371052631578947, AUC 0.8570764064788818, avg_entr 0.8946148753166199, f1 0.6371052861213684
ep0_l2_test_time 0.08077244799999761
Test Epoch0 layer3 Acc 0.44342105263157894, AUC 0.6958330273628235, avg_entr 1.2293206453323364, f1 0.44342106580734253
ep0_l3_test_time 0.09555843900000127
Test Epoch0 layer4 Acc 0.25, AUC 0.48457470536231995, avg_entr 1.2435084581375122, f1 0.25
ep0_l4_test_time 0.11402093099999888
gc 0
Train Epoch1 Acc 0.6675333333333333 (80104/120000), AUC 0.8769832849502563
ep1_train_time 12.490541039
Test Epoch1 layer0 Acc 0.8039473684210526, AUC 0.9518985748291016, avg_entr 0.38832131028175354, f1 0.8039474487304688
ep1_l0_test_time 0.0637555739999982
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8134210526315789, AUC 0.9557874202728271, avg_entr 0.32928580045700073, f1 0.8134210705757141
ep1_l1_test_time 0.0749671040000024
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8155263157894737, AUC 0.953677773475647, avg_entr 0.31674644351005554, f1 0.8155263066291809
ep1_l2_test_time 0.0848330560000008
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer3 Acc 0.8094736842105263, AUC 0.9493545889854431, avg_entr 0.28731900453567505, f1 0.8094737529754639
ep1_l3_test_time 0.10420536800000235
Test Epoch1 layer4 Acc 0.8084210526315789, AUC 0.9460687041282654, avg_entr 0.26499512791633606, f1 0.8084211349487305
ep1_l4_test_time 0.11499472000000566
gc 0
Train Epoch2 Acc 0.866875 (104025/120000), AUC 0.958625078201294
ep2_train_time 12.612389837000002
Test Epoch2 layer0 Acc 0.8336842105263158, AUC 0.9593140482902527, avg_entr 0.23160488903522491, f1 0.8336842060089111
ep2_l0_test_time 0.06442335100000207
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8481578947368421, AUC 0.964529275894165, avg_entr 0.18037457764148712, f1 0.8481578826904297
ep2_l1_test_time 0.07833704299999766
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8489473684210527, AUC 0.9588170647621155, avg_entr 0.16841357946395874, f1 0.8489473462104797
ep2_l2_test_time 0.08682409599999374
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8478947368421053, AUC 0.9544445276260376, avg_entr 0.16431128978729248, f1 0.8478947281837463
ep2_l3_test_time 0.1022248980000029
Test Epoch2 layer4 Acc 0.8460526315789474, AUC 0.9520458579063416, avg_entr 0.15878334641456604, f1 0.8460525870323181
ep2_l4_test_time 0.11528451200000234
gc 0
Train Epoch3 Acc 0.8949083333333333 (107389/120000), AUC 0.97107994556427
ep3_train_time 12.661040635999996
Test Epoch3 layer0 Acc 0.8515789473684211, AUC 0.9648359417915344, avg_entr 0.1603461354970932, f1 0.851578950881958
ep3_l0_test_time 0.06376462400000094
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8697368421052631, AUC 0.9702327251434326, avg_entr 0.12990567088127136, f1 0.8697368502616882
ep3_l1_test_time 0.08283586700000001
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8718421052631579, AUC 0.9700981974601746, avg_entr 0.1293489933013916, f1 0.8718421459197998
ep3_l2_test_time 0.08789125299999512
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer3 Acc 0.8692105263157894, AUC 0.9674713611602783, avg_entr 0.12914080917835236, f1 0.8692105412483215
ep3_l3_test_time 0.10147447999999315
Test Epoch3 layer4 Acc 0.8694736842105263, AUC 0.9660972356796265, avg_entr 0.12842312455177307, f1 0.8694736957550049
ep3_l4_test_time 0.11563588200000652
gc 0
Train Epoch4 Acc 0.9118666666666667 (109424/120000), AUC 0.9770727157592773
ep4_train_time 12.563225416999998
Test Epoch4 layer0 Acc 0.8578947368421053, AUC 0.9652557373046875, avg_entr 0.12634210288524628, f1 0.8578947186470032
ep4_l0_test_time 0.06412079899999412
Test Epoch4 layer1 Acc 0.8736842105263158, AUC 0.9713011384010315, avg_entr 0.09183534979820251, f1 0.8736842274665833
ep4_l1_test_time 0.06991897500000732
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.876578947368421, AUC 0.9703828692436218, avg_entr 0.08532655984163284, f1 0.8765789270401001
ep4_l2_test_time 0.08676432299999703
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer3 Acc 0.8763157894736842, AUC 0.9685561656951904, avg_entr 0.0864013209939003, f1 0.8763157725334167
ep4_l3_test_time 0.10267765600001155
Test Epoch4 layer4 Acc 0.8755263157894737, AUC 0.9684802889823914, avg_entr 0.08420954644680023, f1 0.8755263090133667
ep4_l4_test_time 0.115670496000007
gc 0
Train Epoch5 Acc 0.925575 (111069/120000), AUC 0.9815083742141724
ep5_train_time 12.601978619999997
Test Epoch5 layer0 Acc 0.8526315789473684, AUC 0.9642895460128784, avg_entr 0.09744194895029068, f1 0.8526315689086914
ep5_l0_test_time 0.06416697199999533
Test Epoch5 layer1 Acc 0.8718421052631579, AUC 0.9703496098518372, avg_entr 0.07544118911027908, f1 0.8718421459197998
ep5_l1_test_time 0.0698244439999911
Test Epoch5 layer2 Acc 0.8736842105263158, AUC 0.9696798920631409, avg_entr 0.06977827847003937, f1 0.8736842274665833
ep5_l2_test_time 0.08119515699999624
Test Epoch5 layer3 Acc 0.873421052631579, AUC 0.9689757823944092, avg_entr 0.06904227286577225, f1 0.8734210729598999
ep5_l3_test_time 0.09658153200000186
Test Epoch5 layer4 Acc 0.8731578947368421, AUC 0.9680265188217163, avg_entr 0.06791315227746964, f1 0.8731579184532166
ep5_l4_test_time 0.11585957500000177
gc 0
Train Epoch6 Acc 0.9370916666666667 (112451/120000), AUC 0.9845538139343262
ep6_train_time 12.749253781999997
Test Epoch6 layer0 Acc 0.8560526315789474, AUC 0.9633264541625977, avg_entr 0.07692313194274902, f1 0.8560526371002197
ep6_l0_test_time 0.06451112599999931
Test Epoch6 layer1 Acc 0.8731578947368421, AUC 0.9694980978965759, avg_entr 0.05990783870220184, f1 0.8731579184532166
ep6_l1_test_time 0.069913267000004
Test Epoch6 layer2 Acc 0.873421052631579, AUC 0.9681963324546814, avg_entr 0.05745071917772293, f1 0.8734210729598999
ep6_l2_test_time 0.08122848800000781
Test Epoch6 layer3 Acc 0.8726315789473684, AUC 0.9674743413925171, avg_entr 0.05826761573553085, f1 0.8726315498352051
ep6_l3_test_time 0.09638499000000422
Test Epoch6 layer4 Acc 0.8726315789473684, AUC 0.9634307026863098, avg_entr 0.05612417683005333, f1 0.8726315498352051
ep6_l4_test_time 0.11537844299999733
gc 0
Train Epoch7 Acc 0.9457416666666667 (113489/120000), AUC 0.9862117767333984
ep7_train_time 12.842349683999998
Test Epoch7 layer0 Acc 0.8594736842105263, AUC 0.9660555124282837, avg_entr 0.06672948598861694, f1 0.859473705291748
ep7_l0_test_time 0.06406795699999179
Test Epoch7 layer1 Acc 0.878421052631579, AUC 0.9715714454650879, avg_entr 0.045666005462408066, f1 0.8784210681915283
ep7_l1_test_time 0.06982964499999866
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer2 Acc 0.8794736842105263, AUC 0.9715490341186523, avg_entr 0.043096765875816345, f1 0.8794736862182617
ep7_l2_test_time 0.08687931400000082
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer3 Acc 0.8794736842105263, AUC 0.9707526564598083, avg_entr 0.04382679611444473, f1 0.8794736862182617
ep7_l3_test_time 0.10306102399999872
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer4 Acc 0.8797368421052632, AUC 0.9689112901687622, avg_entr 0.041604381054639816, f1 0.8797368407249451
ep7_l4_test_time 0.12090987299998801
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9537833333333333 (114454/120000), AUC 0.9885062575340271
ep8_train_time 12.785624861000002
Test Epoch8 layer0 Acc 0.8473684210526315, AUC 0.9612364768981934, avg_entr 0.06058040261268616, f1 0.8473684191703796
ep8_l0_test_time 0.06405420199999412
Test Epoch8 layer1 Acc 0.8631578947368421, AUC 0.9685636162757874, avg_entr 0.04465261474251747, f1 0.8631578683853149
ep8_l1_test_time 0.0701174769999966
Test Epoch8 layer2 Acc 0.865, AUC 0.9695964455604553, avg_entr 0.04300706461071968, f1 0.8650000095367432
ep8_l2_test_time 0.08107037999999989
Test Epoch8 layer3 Acc 0.8655263157894737, AUC 0.9676467180252075, avg_entr 0.04371912404894829, f1 0.8655263185501099
ep8_l3_test_time 0.096158513000006
Test Epoch8 layer4 Acc 0.8644736842105263, AUC 0.9661727547645569, avg_entr 0.041702672839164734, f1 0.8644736409187317
ep8_l4_test_time 0.1155181389999882
gc 0
Train Epoch9 Acc 0.9593 (115116/120000), AUC 0.9896649718284607
ep9_train_time 12.647818751999978
Test Epoch9 layer0 Acc 0.8578947368421053, AUC 0.9621036052703857, avg_entr 0.05041990429162979, f1 0.8578947186470032
ep9_l0_test_time 0.06407901599999377
Test Epoch9 layer1 Acc 0.88, AUC 0.9686719179153442, avg_entr 0.03326474130153656, f1 0.8799999952316284
ep9_l1_test_time 0.06967304599999125
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer2 Acc 0.8778947368421053, AUC 0.9674914479255676, avg_entr 0.032112885266542435, f1 0.8778947591781616
ep9_l2_test_time 0.0879225030000157
Test Epoch9 layer3 Acc 0.8792105263157894, AUC 0.9672331809997559, avg_entr 0.030768824741244316, f1 0.8792105317115784
ep9_l3_test_time 0.09635406900000021
Test Epoch9 layer4 Acc 0.878421052631579, AUC 0.9661267399787903, avg_entr 0.027625253424048424, f1 0.8784210681915283
ep9_l4_test_time 0.11523268799999187
gc 0
Train Epoch10 Acc 0.9639416666666667 (115673/120000), AUC 0.9905577898025513
ep10_train_time 12.595775026000013
Test Epoch10 layer0 Acc 0.8555263157894737, AUC 0.9594593048095703, avg_entr 0.04466480761766434, f1 0.855526328086853
ep10_l0_test_time 0.06419799400001125
Test Epoch10 layer1 Acc 0.8702631578947368, AUC 0.9664110541343689, avg_entr 0.033526066690683365, f1 0.8702631592750549
ep10_l1_test_time 0.0697730560000025
Test Epoch10 layer2 Acc 0.8736842105263158, AUC 0.9660628437995911, avg_entr 0.030540673062205315, f1 0.8736842274665833
ep10_l2_test_time 0.08111093899998423
Test Epoch10 layer3 Acc 0.8728947368421053, AUC 0.9636079668998718, avg_entr 0.03109809011220932, f1 0.8728947639465332
ep10_l3_test_time 0.09625350199999616
Test Epoch10 layer4 Acc 0.8731578947368421, AUC 0.9630325436592102, avg_entr 0.03068617917597294, f1 0.8731579184532166
ep10_l4_test_time 0.11547039500001688
gc 0
Train Epoch11 Acc 0.9685666666666667 (116228/120000), AUC 0.9914827346801758
ep11_train_time 12.78016785600002
Test Epoch11 layer0 Acc 0.8544736842105263, AUC 0.9573165774345398, avg_entr 0.0454823262989521, f1 0.8544737100601196
ep11_l0_test_time 0.06431743900000697
Test Epoch11 layer1 Acc 0.8739473684210526, AUC 0.9641404747962952, avg_entr 0.030037567019462585, f1 0.8739473819732666
ep11_l1_test_time 0.06934188999997559
Test Epoch11 layer2 Acc 0.8773684210526316, AUC 0.9637842178344727, avg_entr 0.02544908970594406, f1 0.8773684501647949
ep11_l2_test_time 0.08093858199998749
Test Epoch11 layer3 Acc 0.8773684210526316, AUC 0.9637532234191895, avg_entr 0.02544066496193409, f1 0.8773684501647949
ep11_l3_test_time 0.09646712599999319
Test Epoch11 layer4 Acc 0.8778947368421053, AUC 0.9601977467536926, avg_entr 0.023536959663033485, f1 0.8778947591781616
ep11_l4_test_time 0.11502158599998324
gc 0
Train Epoch12 Acc 0.975975 (117117/120000), AUC 0.9936175346374512
ep12_train_time 12.606817515999978
Test Epoch12 layer0 Acc 0.861578947368421, AUC 0.9563547968864441, avg_entr 0.037182390689849854, f1 0.8615789413452148
ep12_l0_test_time 0.06421086699998568
Test Epoch12 layer1 Acc 0.8755263157894737, AUC 0.963161289691925, avg_entr 0.02339116483926773, f1 0.8755263090133667
ep12_l1_test_time 0.07006312599997955
Test Epoch12 layer2 Acc 0.8776315789473684, AUC 0.9607197046279907, avg_entr 0.019319526851177216, f1 0.8776316046714783
ep12_l2_test_time 0.08128646500000514
Test Epoch12 layer3 Acc 0.8792105263157894, AUC 0.9601994752883911, avg_entr 0.018697461113333702, f1 0.8792105317115784
ep12_l3_test_time 0.09600924800000143
Test Epoch12 layer4 Acc 0.8794736842105263, AUC 0.9583649635314941, avg_entr 0.016550177708268166, f1 0.8794736862182617
ep12_l4_test_time 0.11519218399999431
gc 0
Train Epoch13 Acc 0.978725 (117447/120000), AUC 0.9940621852874756
ep13_train_time 12.772807451999995
Test Epoch13 layer0 Acc 0.8589473684210527, AUC 0.9554761052131653, avg_entr 0.032396137714385986, f1 0.8589473962783813
ep13_l0_test_time 0.06384407400000214
Test Epoch13 layer1 Acc 0.8739473684210526, AUC 0.9579563140869141, avg_entr 0.01663963869214058, f1 0.8739473819732666
ep13_l1_test_time 0.06972921100000917
Test Epoch13 layer2 Acc 0.8768421052631579, AUC 0.9569313526153564, avg_entr 0.013716937974095345, f1 0.8768420815467834
ep13_l2_test_time 0.08088974400001803
Test Epoch13 layer3 Acc 0.8757894736842106, AUC 0.9589468836784363, avg_entr 0.012278452515602112, f1 0.87578946352005
ep13_l3_test_time 0.0960860069999967
Test Epoch13 layer4 Acc 0.8760526315789474, AUC 0.9575864672660828, avg_entr 0.010693253949284554, f1 0.8760526180267334
ep13_l4_test_time 0.11537420700000212
gc 0
Train Epoch14 Acc 0.9814166666666667 (117770/120000), AUC 0.9947399497032166
ep14_train_time 12.772219401000001
Test Epoch14 layer0 Acc 0.8521052631578947, AUC 0.952399492263794, avg_entr 0.03048030287027359, f1 0.8521052598953247
ep14_l0_test_time 0.06376523999998085
Test Epoch14 layer1 Acc 0.8671052631578947, AUC 0.9552940726280212, avg_entr 0.016746988520026207, f1 0.86710524559021
ep14_l1_test_time 0.07014779700000418
Test Epoch14 layer2 Acc 0.87, AUC 0.9554792046546936, avg_entr 0.013641662895679474, f1 0.8700000047683716
ep14_l2_test_time 0.08094853000000057
Test Epoch14 layer3 Acc 0.8697368421052631, AUC 0.9592823386192322, avg_entr 0.014427545480430126, f1 0.8697368502616882
ep14_l3_test_time 0.09628258800000822
Test Epoch14 layer4 Acc 0.8702631578947368, AUC 0.9594477415084839, avg_entr 0.01280051190406084, f1 0.8702631592750549
ep14_l4_test_time 0.1152266539999971
gc 0
Train Epoch15 Acc 0.9824666666666667 (117896/120000), AUC 0.994881272315979
ep15_train_time 12.601129232999995
Test Epoch15 layer0 Acc 0.8610526315789474, AUC 0.9528475403785706, avg_entr 0.025321800261735916, f1 0.8610526323318481
ep15_l0_test_time 0.06445984999999155
Test Epoch15 layer1 Acc 0.875, AUC 0.9563330411911011, avg_entr 0.01916404813528061, f1 0.875
ep15_l1_test_time 0.06938136900001268
Test Epoch15 layer2 Acc 0.8776315789473684, AUC 0.9568406343460083, avg_entr 0.013792105950415134, f1 0.8776316046714783
ep15_l2_test_time 0.08114496900000745
Test Epoch15 layer3 Acc 0.8763157894736842, AUC 0.9601848125457764, avg_entr 0.013371819630265236, f1 0.8763157725334167
ep15_l3_test_time 0.09609698799999933
Test Epoch15 layer4 Acc 0.8760526315789474, AUC 0.9580374956130981, avg_entr 0.01255221851170063, f1 0.8760526180267334
ep15_l4_test_time 0.11567390499999419
gc 0
Train Epoch16 Acc 0.9847666666666667 (118172/120000), AUC 0.9957147836685181
ep16_train_time 12.676682590000013
Test Epoch16 layer0 Acc 0.861578947368421, AUC 0.951453447341919, avg_entr 0.026233991608023643, f1 0.8615789413452148
ep16_l0_test_time 0.06402377699998851
Test Epoch16 layer1 Acc 0.871578947368421, AUC 0.9522058963775635, avg_entr 0.01424457784742117, f1 0.8715789318084717
ep16_l1_test_time 0.0696916230000113
Test Epoch16 layer2 Acc 0.8731578947368421, AUC 0.9543982744216919, avg_entr 0.012670968659222126, f1 0.8731579184532166
ep16_l2_test_time 0.08114161000000308
Test Epoch16 layer3 Acc 0.8721052631578947, AUC 0.9543114900588989, avg_entr 0.01157000008970499, f1 0.8721052408218384
ep16_l3_test_time 0.09632321600000182
Test Epoch16 layer4 Acc 0.8718421052631579, AUC 0.9534738063812256, avg_entr 0.010406391695141792, f1 0.8718421459197998
ep16_l4_test_time 0.11512546000000157
gc 0
Train Epoch17 Acc 0.9860416666666667 (118325/120000), AUC 0.9957882761955261
ep17_train_time 12.738329511000018
Test Epoch17 layer0 Acc 0.8594736842105263, AUC 0.9514402151107788, avg_entr 0.025979306548833847, f1 0.859473705291748
ep17_l0_test_time 0.06397121500003777
Test Epoch17 layer1 Acc 0.8723684210526316, AUC 0.953496515750885, avg_entr 0.015878824517130852, f1 0.8723683953285217
ep17_l1_test_time 0.07021041799998784
Test Epoch17 layer2 Acc 0.8723684210526316, AUC 0.9542409777641296, avg_entr 0.013039164245128632, f1 0.8723683953285217
ep17_l2_test_time 0.08121979499998133
Test Epoch17 layer3 Acc 0.8731578947368421, AUC 0.9544002413749695, avg_entr 0.012135474942624569, f1 0.8731579184532166
ep17_l3_test_time 0.09617263299998058
Test Epoch17 layer4 Acc 0.8728947368421053, AUC 0.9533085823059082, avg_entr 0.01124740019440651, f1 0.8728947639465332
ep17_l4_test_time 0.11550949700000501
gc 0
Train Epoch18 Acc 0.9867166666666667 (118406/120000), AUC 0.995940089225769
ep18_train_time 12.998331594999968
Test Epoch18 layer0 Acc 0.8568421052631578, AUC 0.9513177871704102, avg_entr 0.02596670389175415, f1 0.8568421006202698
ep18_l0_test_time 0.0641408459999866
Test Epoch18 layer1 Acc 0.8705263157894737, AUC 0.9515702724456787, avg_entr 0.013953794725239277, f1 0.8705263137817383
ep18_l1_test_time 0.0700771369999984
Test Epoch18 layer2 Acc 0.871578947368421, AUC 0.951278805732727, avg_entr 0.009878412820398808, f1 0.8715789318084717
ep18_l2_test_time 0.08127831199999491
Test Epoch18 layer3 Acc 0.871578947368421, AUC 0.9515629410743713, avg_entr 0.009769761934876442, f1 0.8715789318084717
ep18_l3_test_time 0.09643533400003435
Test Epoch18 layer4 Acc 0.8721052631578947, AUC 0.952798068523407, avg_entr 0.00883879978209734, f1 0.8721052408218384
ep18_l4_test_time 0.11548322100003361
gc 0
Train Epoch19 Acc 0.9871416666666667 (118457/120000), AUC 0.9961700439453125
ep19_train_time 12.737776746999998
Test Epoch19 layer0 Acc 0.8576315789473684, AUC 0.9487855434417725, avg_entr 0.021568356081843376, f1 0.8576316237449646
ep19_l0_test_time 0.06427721199997904
Test Epoch19 layer1 Acc 0.8660526315789474, AUC 0.9506821632385254, avg_entr 0.014128277078270912, f1 0.8660526275634766
ep19_l1_test_time 0.06994484099999454
Test Epoch19 layer2 Acc 0.8660526315789474, AUC 0.947644054889679, avg_entr 0.011382854543626308, f1 0.8660526275634766
ep19_l2_test_time 0.08118767000001981
Test Epoch19 layer3 Acc 0.8663157894736843, AUC 0.9490971565246582, avg_entr 0.010961665771901608, f1 0.8663158416748047
ep19_l3_test_time 0.09771376899999495
Test Epoch19 layer4 Acc 0.866578947368421, AUC 0.9467308521270752, avg_entr 0.010046006180346012, f1 0.8665789365768433
ep19_l4_test_time 0.11555499000002101
Best AUC tensor(0.8800) 9 1
train_as_loss [[4.62038339e+02 3.57065264e+02 3.51183426e+02 3.49885563e+02
  3.49394666e+02 3.49158576e+02 3.49028369e+02 3.48949969e+02
  3.48899824e+02 3.48866338e+02 3.48843235e+02 3.48826910e+02
  3.48817545e+02 3.48812068e+02 3.48807028e+02 3.48802511e+02
  3.48799440e+02 3.48797403e+02 3.48795366e+02 3.48793389e+02]
 [1.57939294e+00 1.47396060e-05 9.96319033e-07 1.96040879e-07
  2.96040181e-07 6.33058096e-07 1.91059172e-06 2.18814990e-05
  4.09336365e-05 2.00506483e-04 1.97590834e-04 3.89116788e-04
  4.92442920e-06 4.87322753e-10 6.39836541e-10 1.11920428e-04
  7.33044541e-08 2.26190656e-10 7.59786446e-10 3.33668402e-05]
 [1.76961089e+00 1.59616601e-05 1.02409842e-06 2.04045070e-07
  6.98024571e-08 7.12459004e-08 3.86121676e-07 3.67861958e-05
  1.11432688e-04 5.68225360e-04 4.42089133e-04 8.91980955e-04
  9.47309342e-06 1.45130690e-09 2.39730531e-09 2.13645272e-04
  2.62438828e-07 7.06443818e-10 1.93511527e-09 7.03642493e-05]
 [1.67068399e+00 1.30848371e-05 1.01249295e-06 2.50408027e-07
  1.03784117e-07 1.10018516e-07 5.25055373e-07 8.10428130e-05
  2.11309904e-04 9.54608459e-04 7.00425674e-04 1.40770967e-03
  1.41657504e-05 5.26779231e-09 9.52955260e-09 3.19049312e-04
  5.98114534e-07 2.67424717e-09 6.06150611e-09 1.01014719e-04]
 [1.70906118e+00 1.05247283e-05 1.22600516e-06 4.56947790e-07
  2.42566327e-07 2.69558578e-07 9.05118452e-07 1.52361414e-04
  4.22363940e-04 1.53490585e-03 1.13819152e-03 2.10920162e-03
  2.05113783e-05 1.81785178e-08 3.60058354e-08 4.70671887e-04
  1.31330338e-06 9.43987062e-09 1.96115636e-08 1.37827304e-04]]
train_ae_loss [[10.96373169 11.30115979 10.34164008  9.62279827  9.03422144  8.466649
   7.84992882  7.34263414  6.84888182  6.44498692  6.11785693  5.74044952
   4.56309709  4.19677606  4.05098268  3.90978176  3.49940128  3.32448956
   3.25441585  3.20038984]
 [11.06234609 10.01986666  8.86619422  8.09846599  7.52367902  6.92512986
   6.2829887   5.80865753  5.27804573  4.87416747  4.5344208   4.13466249
   3.08210005  2.7663738   2.61335818  2.48451044  2.08426823  1.95786844
   1.87211479  1.79783216]
 [10.75421517  9.17566293  7.57556061  6.79355801  6.24089966  5.69124899
   5.09528609  4.68946829  4.22622274  3.88118104  3.59813699  3.24267072
   2.38376583  2.11941457  1.98573633  1.88825998  1.5587926   1.45113402
   1.38034963  1.3186364 ]
 [10.62677503 10.03086885  7.2563474   6.39214618  5.79555167  5.23596135
   4.63676751  4.24192247  3.78947736  3.46178497  3.19362998  2.86080781
   2.06030332  1.82765438  1.70375168  1.61261326  1.31014362  1.22045716
   1.16070646  1.1053831 ]
 [10.15970385 11.54065846  6.96604436  6.04013431  5.43434848  4.88264663
   4.29722796  3.91691686  3.48735689  3.17705662  2.9216823   2.60772045
   1.85694634  1.64415882  1.53228331  1.45152228  1.1745379   1.09297742
   1.0368946   0.98715536]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 267.571594961
Start Testing
Load ckpt at ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt
gc 10
Test layer0 Acc 0.8413157894736842, AUC 0.9558625817298889, avg_entr 0.05200466513633728, f1 0.8413158059120178
l0_test_time 0.06283072500002618
gc 0
Test layer1 Acc 0.86, AUC 0.9650651216506958, avg_entr 0.03456748276948929, f1 0.8600000143051147
l1_test_time 0.07092802699997947
gc 0
Test layer2 Acc 0.8631578947368421, AUC 0.9611566066741943, avg_entr 0.03392169997096062, f1 0.8631578683853149
l2_test_time 0.08274013199996944
gc 0
Test layer3 Acc 0.8628947368421053, AUC 0.9632552266120911, avg_entr 0.03282621502876282, f1 0.8628947138786316
l3_test_time 0.09749980399999458
gc 0
Test layer4 Acc 0.8623684210526316, AUC 0.9630425572395325, avg_entr 0.028095316141843796, f1 0.8623684048652649
l4_test_time 0.11685316199998397
gc 0
Test threshold 0.1 Acc 0.8552631578947368, AUC 0.9571405053138733, avg_entr 0.01803954876959324, f1 0.8552631735801697
t0.1_test_time 0.1198812979999957
gc 0
Test threshold 0.2 Acc 0.8531578947368421, AUC 0.9567461013793945, avg_entr 0.01988920196890831, f1 0.8531579375267029
t0.2_test_time 0.11669795500000646
gc 0
Test threshold 0.3 Acc 0.8507894736842105, AUC 0.9566614031791687, avg_entr 0.024132248014211655, f1 0.850789487361908
t0.3_test_time 0.10846691799997643
gc 0
Test threshold 0.4 Acc 0.8444736842105263, AUC 0.9562464356422424, avg_entr 0.031688492745161057, f1 0.844473659992218
t0.4_test_time 0.09092313899998317
gc 0
Test threshold 0.5 Acc 0.841842105263158, AUC 0.9558238983154297, avg_entr 0.036695268005132675, f1 0.8418421149253845
t0.5_test_time 0.07923998400002574
gc 0
Test threshold 0.6 Acc 0.8413157894736842, AUC 0.9558625817298889, avg_entr 0.037513431161642075, f1 0.8413158059120178
t0.6_test_time 0.07574726999996528
gc 0
Test threshold 0.7 Acc 0.8413157894736842, AUC 0.9558625817298889, avg_entr 0.037513431161642075, f1 0.8413158059120178
t0.7_test_time 0.07554117800003723
gc 0
Test threshold 0.8 Acc 0.8413157894736842, AUC 0.9558625817298889, avg_entr 0.037513431161642075, f1 0.8413158059120178
t0.8_test_time 0.07589131899999302
gc 0
Test threshold 0.9 Acc 0.8413157894736842, AUC 0.9558625817298889, avg_entr 0.037513431161642075, f1 0.8413158059120178
t0.9_test_time 0.0766909349999878
