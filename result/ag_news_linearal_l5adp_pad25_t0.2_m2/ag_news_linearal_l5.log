total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.2_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.24815833333333334 (29779/120000), AUC 0.33338505029678345
ep0_train_time 4.8168394565582275
Test Epoch0 threshold 0.2 Acc 0.9138157894736842, AUC 0.9805592894554138, avg_entr 0.031214337795972824
ep0_t0.2_test_time 0.08013772964477539
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.2_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24365833333333334 (29239/120000), AUC 0.2886817753314972
ep1_train_time 4.316439390182495
Test Epoch1 threshold 0.2 Acc 0.9111842105263158, AUC 0.9804774522781372, avg_entr 0.029522830620408058
ep1_t0.2_test_time 0.07880043983459473
gc 0
Train Epoch2 Acc 0.229225 (27507/120000), AUC 0.2804262042045593
ep2_train_time 4.409245491027832
Test Epoch2 threshold 0.2 Acc 0.9105263157894737, AUC 0.9803062081336975, avg_entr 0.02756660431623459
ep2_t0.2_test_time 0.07963705062866211
gc 0
Train Epoch3 Acc 0.1964 (23568/120000), AUC 0.2767278552055359
ep3_train_time 4.348958253860474
Test Epoch3 threshold 0.2 Acc 0.9126644736842106, AUC 0.9799679517745972, avg_entr 0.026488836854696274
ep3_t0.2_test_time 0.07846927642822266
gc 0
Train Epoch4 Acc 0.15155 (18186/120000), AUC 0.2732910215854645
ep4_train_time 4.368634462356567
Test Epoch4 threshold 0.2 Acc 0.9101973684210526, AUC 0.9798755049705505, avg_entr 0.025503773242235184
ep4_t0.2_test_time 0.07798004150390625
gc 0
Train Epoch5 Acc 0.11705833333333333 (14047/120000), AUC 0.26913100481033325
ep5_train_time 4.382880210876465
Test Epoch5 threshold 0.2 Acc 0.9100328947368421, AUC 0.979567289352417, avg_entr 0.02562692202627659
ep5_t0.2_test_time 0.07928204536437988
gc 0
Train Epoch6 Acc 0.10023333333333333 (12028/120000), AUC 0.2674148678779602
ep6_train_time 4.450819969177246
Test Epoch6 threshold 0.2 Acc 0.9100328947368421, AUC 0.9792229533195496, avg_entr 0.025976089760661125
ep6_t0.2_test_time 0.08384513854980469
gc 0
Train Epoch7 Acc 0.086575 (10389/120000), AUC 0.2644137442111969
ep7_train_time 4.604506492614746
Test Epoch7 threshold 0.2 Acc 0.9110197368421052, AUC 0.9790337681770325, avg_entr 0.025954974815249443
ep7_t0.2_test_time 0.08195209503173828
gc 0
Train Epoch8 Acc 0.07655 (9186/120000), AUC 0.26076459884643555
ep8_train_time 4.623931407928467
Test Epoch8 threshold 0.2 Acc 0.9095394736842105, AUC 0.9789105653762817, avg_entr 0.025353047996759415
ep8_t0.2_test_time 0.08080291748046875
gc 0
Train Epoch9 Acc 0.06975833333333334 (8371/120000), AUC 0.2572408616542816
ep9_train_time 4.576101064682007
Test Epoch9 threshold 0.2 Acc 0.9085526315789474, AUC 0.9787834882736206, avg_entr 0.025555962696671486
ep9_t0.2_test_time 0.07857394218444824
Best AUC 0.9805592894554138
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.2_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9210526315789473, AUC 0.9847584366798401, avg_entr 0.03243960812687874
t0.2_test_time 0.020617008209228516
