total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.23569166666666666 (28283/120000), AUC 0.5192885398864746
ep0_train_time 9.40282678604126
Test Epoch0 threshold 0.9 Acc 0.9164473684210527, AUC 0.9808860421180725, avg_entr 0.02552160993218422
ep0_t0.9_test_time 0.2503957748413086
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24921666666666667 (29906/120000), AUC 0.5525415539741516
ep1_train_time 8.863927125930786
Test Epoch1 threshold 0.9 Acc 0.9151315789473684, AUC 0.9808553457260132, avg_entr 0.02511213906109333
ep1_t0.9_test_time 0.24892854690551758
gc 0
Train Epoch2 Acc 0.24901666666666666 (29882/120000), AUC 0.5533254146575928
ep2_train_time 8.850387573242188
Test Epoch2 threshold 0.9 Acc 0.9162828947368421, AUC 0.9807597994804382, avg_entr 0.026186011731624603
ep2_t0.9_test_time 0.24908852577209473
gc 0
Train Epoch3 Acc 0.2496 (29952/120000), AUC 0.5522521734237671
ep3_train_time 8.988797664642334
Test Epoch3 threshold 0.9 Acc 0.9167763157894737, AUC 0.9806222915649414, avg_entr 0.026158226653933525
ep3_t0.9_test_time 0.24920272827148438
gc 0
Train Epoch4 Acc 0.2531833333333333 (30382/120000), AUC 0.5526376962661743
ep4_train_time 9.172440528869629
Test Epoch4 threshold 0.9 Acc 0.9138157894736842, AUC 0.9803670644760132, avg_entr 0.02529759146273136
ep4_t0.9_test_time 0.2559781074523926
gc 0
Train Epoch5 Acc 0.2569916666666667 (30839/120000), AUC 0.556664228439331
ep5_train_time 9.143161535263062
Test Epoch5 threshold 0.9 Acc 0.912828947368421, AUC 0.9802436828613281, avg_entr 0.026637230068445206
ep5_t0.9_test_time 0.24864721298217773
gc 0
Train Epoch6 Acc 0.25559166666666666 (30671/120000), AUC 0.5635254383087158
ep6_train_time 8.935986995697021
Test Epoch6 threshold 0.9 Acc 0.9138157894736842, AUC 0.9801849126815796, avg_entr 0.026440683752298355
ep6_t0.9_test_time 0.2488269805908203
gc 0
Train Epoch7 Acc 0.2530833333333333 (30370/120000), AUC 0.5740392208099365
ep7_train_time 8.891972780227661
Test Epoch7 threshold 0.9 Acc 0.9139802631578947, AUC 0.9800740480422974, avg_entr 0.025983044877648354
ep7_t0.9_test_time 0.24844074249267578
gc 0
Train Epoch8 Acc 0.25215 (30258/120000), AUC 0.5882080793380737
ep8_train_time 8.87024188041687
Test Epoch8 threshold 0.9 Acc 0.9138157894736842, AUC 0.9800148606300354, avg_entr 0.026193002238869667
ep8_t0.9_test_time 0.2485644817352295
gc 0
Train Epoch9 Acc 0.25188333333333335 (30226/120000), AUC 0.5978020429611206
ep9_train_time 8.945026636123657
Test Epoch9 threshold 0.9 Acc 0.9144736842105263, AUC 0.9799623489379883, avg_entr 0.025700777769088745
ep9_t0.9_test_time 0.24810004234313965
Best AUC 0.9808860421180725
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.9_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9217105263157894, AUC 0.9863178133964539, avg_entr 0.024601900950074196
t0.9_test_time 0.06302571296691895
