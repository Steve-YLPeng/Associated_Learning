total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.4_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.51015 (61218/120000), AUC 0.7754815816879272
ep0_train_time 5.435798168182373
Test Epoch0 threshold 0.4 Acc 0.9141447368421053, AUC 0.981216549873352, avg_entr 0.02478794753551483
ep0_t0.4_test_time 0.08579397201538086
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.4_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.37449166666666667 (44939/120000), AUC 0.6884801387786865
ep1_train_time 5.177184104919434
Test Epoch1 threshold 0.4 Acc 0.9115131578947369, AUC 0.9805840253829956, avg_entr 0.025245876982808113
ep1_t0.4_test_time 0.07816553115844727
gc 0
Train Epoch2 Acc 0.3097916666666667 (37175/120000), AUC 0.6072437167167664
ep2_train_time 5.185084104537964
Test Epoch2 threshold 0.4 Acc 0.9143092105263158, AUC 0.9799479842185974, avg_entr 0.02493228204548359
ep2_t0.4_test_time 0.07944011688232422
gc 0
Train Epoch3 Acc 0.24875 (29850/120000), AUC 0.5265253186225891
ep3_train_time 5.057908296585083
Test Epoch3 threshold 0.4 Acc 0.9092105263157895, AUC 0.9799253940582275, avg_entr 0.024181783199310303
ep3_t0.4_test_time 0.07562661170959473
gc 0
Train Epoch4 Acc 0.18830833333333333 (22597/120000), AUC 0.47238853573799133
ep4_train_time 4.912321090698242
Test Epoch4 threshold 0.4 Acc 0.9123355263157895, AUC 0.9797584414482117, avg_entr 0.024129338562488556
ep4_t0.4_test_time 0.07567691802978516
gc 0
Train Epoch5 Acc 0.13955833333333334 (16747/120000), AUC 0.4516100585460663
ep5_train_time 4.929407596588135
Test Epoch5 threshold 0.4 Acc 0.9092105263157895, AUC 0.9795055389404297, avg_entr 0.024641942232847214
ep5_t0.4_test_time 0.07504916191101074
gc 0
Train Epoch6 Acc 0.11274166666666667 (13529/120000), AUC 0.44539976119995117
ep6_train_time 4.888823509216309
Test Epoch6 threshold 0.4 Acc 0.9115131578947369, AUC 0.9792361259460449, avg_entr 0.02458307147026062
ep6_t0.4_test_time 0.07806706428527832
gc 0
Train Epoch7 Acc 0.09269166666666667 (11123/120000), AUC 0.44215095043182373
ep7_train_time 4.908246278762817
Test Epoch7 threshold 0.4 Acc 0.9106907894736842, AUC 0.9789739847183228, avg_entr 0.024931244552135468
ep7_t0.4_test_time 0.07550930976867676
gc 0
Train Epoch8 Acc 0.08251666666666667 (9902/120000), AUC 0.4396725594997406
ep8_train_time 4.882169246673584
Test Epoch8 threshold 0.4 Acc 0.9097039473684211, AUC 0.9786466956138611, avg_entr 0.024746069684624672
ep8_t0.4_test_time 0.0754384994506836
gc 0
Train Epoch9 Acc 0.083325 (9999/120000), AUC 0.4380457103252411
ep9_train_time 4.916382312774658
Test Epoch9 threshold 0.4 Acc 0.9098684210526315, AUC 0.9786847829818726, avg_entr 0.025087082758545876
ep9_t0.4_test_time 0.07576394081115723
Best AUC 0.981216549873352
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.4_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9223684210526316, AUC 0.9861243963241577, avg_entr 0.0261820238083601
t0.4_test_time 0.021569252014160156
