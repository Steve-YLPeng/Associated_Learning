total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 24.436751125
Start Training
gc 0
Train Epoch0 Acc 0.542075 (21683/40000), AUC 0.5704838037490845
ep0_train_time 78.327254569
Test Epoch0 layer4 Acc 0.7148, AUC 0.8230793476104736, avg_entr 0.4135139584541321, f1 0.7148000597953796
ep0_l4_test_time 2.8974747759999957
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.805025 (32201/40000), AUC 0.8646202087402344
ep1_train_time 78.87838409299998
Test Epoch1 layer4 Acc 0.8398, AUC 0.9090471863746643, avg_entr 0.19421322643756866, f1 0.8398000001907349
ep1_l4_test_time 2.856315316000007
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.807125 (32285/40000), AUC 0.8880501985549927
ep2_train_time 78.85956225200002
Test Epoch2 layer4 Acc 0.814, AUC 0.8954330682754517, avg_entr 0.10383068770170212, f1 0.8139999508857727
ep2_l4_test_time 2.866548580999961
gc 0
Train Epoch3 Acc 0.868 (34720/40000), AUC 0.9302019476890564
ep3_train_time 78.85055244099999
Test Epoch3 layer4 Acc 0.8694, AUC 0.9319435954093933, avg_entr 0.056226037442684174, f1 0.8694000244140625
ep3_l4_test_time 2.8747466969999778
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.861975 (34479/40000), AUC 0.9349546432495117
ep4_train_time 78.89131806799998
Test Epoch4 layer4 Acc 0.8758, AUC 0.932806134223938, avg_entr 0.03779010474681854, f1 0.8758000135421753
ep4_l4_test_time 2.875509878999992
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.918325 (36733/40000), AUC 0.9642215967178345
ep5_train_time 78.87301485100005
Test Epoch5 layer4 Acc 0.8798, AUC 0.9356743097305298, avg_entr 0.035526469349861145, f1 0.879800021648407
ep5_l4_test_time 2.895530199999939
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.924425 (36977/40000), AUC 0.968993067741394
ep6_train_time 78.97600457599992
Test Epoch6 layer4 Acc 0.7824, AUC 0.8893831968307495, avg_entr 0.05205009877681732, f1 0.7824000120162964
ep6_l4_test_time 2.8590652670000054
gc 0
Train Epoch7 Acc 0.90325 (36130/40000), AUC 0.9630603790283203
ep7_train_time 78.95830437899997
Test Epoch7 layer4 Acc 0.8382, AUC 0.9030554294586182, avg_entr 0.06808008998632431, f1 0.8381999731063843
ep7_l4_test_time 2.8699978979999514
gc 0
Train Epoch8 Acc 0.94455 (37782/40000), AUC 0.9788326025009155
ep8_train_time 78.90913702099999
Test Epoch8 layer4 Acc 0.8722, AUC 0.9288952350616455, avg_entr 0.022494766861200333, f1 0.872200071811676
ep8_l4_test_time 2.8760158930000443
gc 0
Train Epoch9 Acc 0.902825 (36113/40000), AUC 0.9561303853988647
ep9_train_time 78.93557784999996
Test Epoch9 layer4 Acc 0.851, AUC 0.9185669422149658, avg_entr 0.043103624135255814, f1 0.8510000109672546
ep9_l4_test_time 2.880840121999995
gc 0
Train Epoch10 Acc 0.9384 (37536/40000), AUC 0.9794858694076538
ep10_train_time 88.89259548799998
Test Epoch10 layer4 Acc 0.87, AUC 0.9330447912216187, avg_entr 0.030715957283973694, f1 0.8700000047683716
ep10_l4_test_time 2.900593231000016
gc 0
Train Epoch11 Acc 0.95795 (38318/40000), AUC 0.988868236541748
ep11_train_time 79.86429810499999
Test Epoch11 layer4 Acc 0.8698, AUC 0.9308023452758789, avg_entr 0.03645544499158859, f1 0.8697999715805054
ep11_l4_test_time 2.866136183000094
gc 0
Train Epoch12 Acc 0.96305 (38522/40000), AUC 0.99046790599823
ep12_train_time 129.746645252
Test Epoch12 layer4 Acc 0.8706, AUC 0.9254798889160156, avg_entr 0.018934229388833046, f1 0.8705999851226807
ep12_l4_test_time 2.877324332999933
gc 0
Train Epoch13 Acc 0.964575 (38583/40000), AUC 0.9914757013320923
ep13_train_time 80.24943454900017
Test Epoch13 layer4 Acc 0.8646, AUC 0.9262365102767944, avg_entr 0.02165605127811432, f1 0.8646000027656555
ep13_l4_test_time 2.9137374549998185
gc 0
Train Epoch14 Acc 0.961 (38440/40000), AUC 0.9914586544036865
ep14_train_time 126.84561266300011
Test Epoch14 layer4 Acc 0.8642, AUC 0.9288461208343506, avg_entr 0.022551102563738823, f1 0.8641999959945679
ep14_l4_test_time 5.453163353000036
gc 0
Train Epoch15 Acc 0.96845 (38738/40000), AUC 0.9934060573577881
ep15_train_time 154.60930575199995
Test Epoch15 layer4 Acc 0.8626, AUC 0.9238959550857544, avg_entr 0.020234793424606323, f1 0.8626000285148621
ep15_l4_test_time 5.4361870370000815
gc 0
Train Epoch16 Acc 0.9739 (38956/40000), AUC 0.9954745769500732
ep16_train_time 154.5297351659999
Test Epoch16 layer4 Acc 0.8602, AUC 0.9168719053268433, avg_entr 0.013223198242485523, f1 0.8601999878883362
ep16_l4_test_time 5.355028631000096
gc 0
Train Epoch17 Acc 0.975525 (39021/40000), AUC 0.996124267578125
ep17_train_time 154.7019590120001
Test Epoch17 layer4 Acc 0.861, AUC 0.9205888509750366, avg_entr 0.016147295013070107, f1 0.8610000014305115
ep17_l4_test_time 5.344357667000168
gc 0
Train Epoch18 Acc 0.97695 (39078/40000), AUC 0.9964119791984558
ep18_train_time 154.6795739669999
Test Epoch18 layer4 Acc 0.856, AUC 0.9169615507125854, avg_entr 0.014042692258954048, f1 0.8560000061988831
ep18_l4_test_time 5.421849454000039
gc 0
Train Epoch19 Acc 0.977125 (39085/40000), AUC 0.9965221881866455
ep19_train_time 154.58704773900013
Test Epoch19 layer4 Acc 0.8494, AUC 0.9162886142730713, avg_entr 0.015960896387696266, f1 0.849399983882904
ep19_l4_test_time 5.388770332999684
gc 0
Train Epoch20 Acc 0.9801 (39204/40000), AUC 0.9972587823867798
ep20_train_time 154.58424233100004
Test Epoch20 layer4 Acc 0.8524, AUC 0.9166135191917419, avg_entr 0.016451098024845123, f1 0.852400004863739
ep20_l4_test_time 5.484231847000046
gc 0
Train Epoch21 Acc 0.9808 (39232/40000), AUC 0.9973864555358887
ep21_train_time 154.9962516149999
Test Epoch21 layer4 Acc 0.8424, AUC 0.9072682857513428, avg_entr 0.01601577177643776, f1 0.8424000144004822
ep21_l4_test_time 5.384854350000296
gc 0
Train Epoch22 Acc 0.9795 (39180/40000), AUC 0.9967886209487915
ep22_train_time 154.6220107590002
Test Epoch22 layer4 Acc 0.8468, AUC 0.911871612071991, avg_entr 0.014075817540287971, f1 0.8468000292778015
ep22_l4_test_time 5.324320375999832
gc 0
Train Epoch23 Acc 0.98265 (39306/40000), AUC 0.9976640343666077
ep23_train_time 136.44443020100016
Test Epoch23 layer4 Acc 0.8276, AUC 0.9031717777252197, avg_entr 0.01583034358918667, f1 0.8276000022888184
ep23_l4_test_time 5.498612643000342
gc 0
Train Epoch24 Acc 0.98375 (39350/40000), AUC 0.9979924559593201
ep24_train_time 154.5683214999999
Test Epoch24 layer4 Acc 0.8384, AUC 0.9072271585464478, avg_entr 0.013783144764602184, f1 0.8384000658988953
ep24_l4_test_time 5.382529195999723
gc 0
Train Epoch25 Acc 0.984025 (39361/40000), AUC 0.9980146288871765
ep25_train_time 154.61867787200026
Test Epoch25 layer4 Acc 0.8444, AUC 0.9104698896408081, avg_entr 0.013134266249835491, f1 0.8443999886512756
ep25_l4_test_time 5.4340008139997735
gc 0
Train Epoch26 Acc 0.984175 (39367/40000), AUC 0.9976394176483154
ep26_train_time 154.45628921499974
Test Epoch26 layer4 Acc 0.8442, AUC 0.9086824655532837, avg_entr 0.01337436493486166, f1 0.8442000150680542
ep26_l4_test_time 5.435396588000003
gc 0
Train Epoch27 Acc 0.9863 (39452/40000), AUC 0.9984571933746338
ep27_train_time 154.60202550400027
Test Epoch27 layer4 Acc 0.8368, AUC 0.9012914896011353, avg_entr 0.008823801763355732, f1 0.8368000388145447
ep27_l4_test_time 5.435033676999865
gc 0
Train Epoch28 Acc 0.986975 (39479/40000), AUC 0.9986087083816528
ep28_train_time 154.5347646829996
Test Epoch28 layer4 Acc 0.8408, AUC 0.902748167514801, avg_entr 0.011032568290829659, f1 0.8408000469207764
ep28_l4_test_time 5.397751903999961
gc 0
Train Epoch29 Acc 0.987425 (39497/40000), AUC 0.9985027313232422
ep29_train_time 154.49074162899979
Test Epoch29 layer4 Acc 0.8342, AUC 0.9021248817443848, avg_entr 0.012209712527692318, f1 0.8341999650001526
ep29_l4_test_time 5.487269907999689
Best AUC tensor(0.8798) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 3723.704426215
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8944, AUC 0.9541244506835938, avg_entr 0.16516061127185822, f1 0.8944000005722046
l0_test_time 0.7450534639997386
Test layer1 Acc 0.8712, AUC 0.9274381995201111, avg_entr 0.04421320930123329, f1 0.8712000846862793
l1_test_time 1.7494939180000983
Test layer2 Acc 0.8686, AUC 0.9295799732208252, avg_entr 0.03663845360279083, f1 0.8686000108718872
l2_test_time 2.954920656000013
Test layer3 Acc 0.8706, AUC 0.9298608303070068, avg_entr 0.02966398559510708, f1 0.8705999851226807
l3_test_time 4.14767190800012
Test layer4 Acc 0.8694, AUC 0.9278895258903503, avg_entr 0.03650948777794838, f1 0.8694000244140625
l4_test_time 5.348178984999777
