total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 23.705850872
Start Training
gc 0
Train Epoch0 Acc 0.500925 (20037/40000), AUC 0.5100809335708618
ep0_train_time 155.82798673300002
Test Epoch0 layer4 Acc 0.6692, AUC 0.7316965460777283, avg_entr 0.6854195594787598, f1 0.6692000031471252
ep0_l4_test_time 5.653937427999978
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.8041 (32164/40000), AUC 0.8667861223220825
ep1_train_time 155.976895624
Test Epoch1 layer4 Acc 0.829, AUC 0.9010273814201355, avg_entr 0.14607533812522888, f1 0.8289999961853027
ep1_l4_test_time 5.464441940000029
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.839025 (33561/40000), AUC 0.9086536169052124
ep2_train_time 155.98018682400004
Test Epoch2 layer4 Acc 0.7588, AUC 0.8427485227584839, avg_entr 0.32417911291122437, f1 0.7588000297546387
ep2_l4_test_time 5.525489826000012
gc 0
Train Epoch3 Acc 0.854525 (34181/40000), AUC 0.9235210418701172
ep3_train_time 138.450054318
Test Epoch3 layer4 Acc 0.852, AUC 0.9219295382499695, avg_entr 0.06927832961082458, f1 0.8519999980926514
ep3_l4_test_time 5.547676074000037
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.8962 (35848/40000), AUC 0.9543259143829346
ep4_train_time 156.26850781099995
Test Epoch4 layer4 Acc 0.8552, AUC 0.9283829927444458, avg_entr 0.08250212669372559, f1 0.8551999926567078
ep4_l4_test_time 5.532957634000013
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.908175 (36327/40000), AUC 0.9638027548789978
ep5_train_time 156.43533770499994
Test Epoch5 layer4 Acc 0.8666, AUC 0.9277094602584839, avg_entr 0.052360523492097855, f1 0.866599977016449
ep5_l4_test_time 5.5851509530000385
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.929475 (37179/40000), AUC 0.9750301241874695
ep6_train_time 156.420625437
Test Epoch6 layer4 Acc 0.877, AUC 0.943608820438385, avg_entr 0.04903104156255722, f1 0.8769999742507935
ep6_l4_test_time 5.5111036680000325
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9413 (37652/40000), AUC 0.9799495935440063
ep7_train_time 156.341170551
Test Epoch7 layer4 Acc 0.8806, AUC 0.9390289783477783, avg_entr 0.031139196828007698, f1 0.8805999755859375
ep7_l4_test_time 5.556310975000088
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.952025 (38081/40000), AUC 0.9866698980331421
ep8_train_time 156.22125103500002
Test Epoch8 layer4 Acc 0.8796, AUC 0.9433193206787109, avg_entr 0.037393175065517426, f1 0.8795999884605408
ep8_l4_test_time 5.543985533000068
gc 0
Train Epoch9 Acc 0.956075 (38243/40000), AUC 0.9872394800186157
ep9_train_time 156.37951912500012
Test Epoch9 layer4 Acc 0.8742, AUC 0.9372308254241943, avg_entr 0.025454415008425713, f1 0.8741999864578247
ep9_l4_test_time 5.456418356999848
gc 0
Train Epoch10 Acc 0.960175 (38407/40000), AUC 0.9903151392936707
ep10_train_time 156.3755954369999
Test Epoch10 layer4 Acc 0.8716, AUC 0.935502827167511, avg_entr 0.024604257196187973, f1 0.8715999722480774
ep10_l4_test_time 5.612206196999978
gc 0
Train Epoch11 Acc 0.957625 (38305/40000), AUC 0.9883021712303162
ep11_train_time 156.16047906400013
Test Epoch11 layer4 Acc 0.8704, AUC 0.9320845007896423, avg_entr 0.026260869577527046, f1 0.8704000115394592
ep11_l4_test_time 5.551365512000075
gc 0
Train Epoch12 Acc 0.965475 (38619/40000), AUC 0.9922041296958923
ep12_train_time 156.20648314500022
Test Epoch12 layer4 Acc 0.8698, AUC 0.9331812858581543, avg_entr 0.02164136804640293, f1 0.8697999715805054
ep12_l4_test_time 5.490779007999663
gc 0
Train Epoch13 Acc 0.96875 (38750/40000), AUC 0.993736743927002
ep13_train_time 156.31071500500002
Test Epoch13 layer4 Acc 0.866, AUC 0.9315787553787231, avg_entr 0.019069992005825043, f1 0.8659999966621399
ep13_l4_test_time 5.485670274000313
gc 0
Train Epoch14 Acc 0.97165 (38866/40000), AUC 0.9944422841072083
ep14_train_time 133.22290479699996
Test Epoch14 layer4 Acc 0.8532, AUC 0.9283379316329956, avg_entr 0.026068100705742836, f1 0.8532000184059143
ep14_l4_test_time 5.5589363059998504
gc 0
Train Epoch15 Acc 0.973625 (38945/40000), AUC 0.9954813718795776
ep15_train_time 157.6204136219999
Test Epoch15 layer4 Acc 0.8632, AUC 0.9254680275917053, avg_entr 0.01809953711926937, f1 0.8632000088691711
ep15_l4_test_time 5.594302304999928
gc 0
Train Epoch16 Acc 0.975625 (39025/40000), AUC 0.9958431124687195
ep16_train_time 157.5917581030003
Test Epoch16 layer4 Acc 0.8582, AUC 0.9233587980270386, avg_entr 0.015047567896544933, f1 0.858199954032898
ep16_l4_test_time 5.578073440000026
gc 0
Train Epoch17 Acc 0.9767 (39068/40000), AUC 0.9963405132293701
ep17_train_time 157.40784039000027
Test Epoch17 layer4 Acc 0.8502, AUC 0.9262394905090332, avg_entr 0.023785678669810295, f1 0.8501999974250793
ep17_l4_test_time 5.597602735000237
gc 0
Train Epoch18 Acc 0.978225 (39129/40000), AUC 0.9964108467102051
ep18_train_time 157.61075276599968
Test Epoch18 layer4 Acc 0.8572, AUC 0.9210405349731445, avg_entr 0.015074316412210464, f1 0.857200026512146
ep18_l4_test_time 5.532860846999938
gc 0
Train Epoch19 Acc 0.980325 (39213/40000), AUC 0.9973595142364502
ep19_train_time 157.5778732079998
Test Epoch19 layer4 Acc 0.8512, AUC 0.9224898815155029, avg_entr 0.014440122991800308, f1 0.8511999845504761
ep19_l4_test_time 5.602644298000087
gc 0
Train Epoch20 Acc 0.98145 (39258/40000), AUC 0.9972575902938843
ep20_train_time 157.410494407
Test Epoch20 layer4 Acc 0.8536, AUC 0.9180868268013, avg_entr 0.014995395205914974, f1 0.853600025177002
ep20_l4_test_time 5.711523252999996
gc 0
Train Epoch21 Acc 0.980875 (39235/40000), AUC 0.9975394010543823
ep21_train_time 157.52337671700025
Test Epoch21 layer4 Acc 0.835, AUC 0.9143924713134766, avg_entr 0.015198098495602608, f1 0.8349999785423279
ep21_l4_test_time 5.527861459999713
gc 0
Train Epoch22 Acc 0.98145 (39258/40000), AUC 0.9976019859313965
ep22_train_time 157.52254424000012
Test Epoch22 layer4 Acc 0.8506, AUC 0.9117212295532227, avg_entr 0.011949625797569752, f1 0.8505999445915222
ep22_l4_test_time 5.513876176999929
gc 0
Train Epoch23 Acc 0.982875 (39315/40000), AUC 0.9976745247840881
ep23_train_time 157.58620150199977
Test Epoch23 layer4 Acc 0.8506, AUC 0.9179919958114624, avg_entr 0.014760538004338741, f1 0.8505999445915222
ep23_l4_test_time 5.529973603000144
gc 0
Train Epoch24 Acc 0.9853 (39412/40000), AUC 0.998262882232666
ep24_train_time 157.5348044960001
Test Epoch24 layer4 Acc 0.8476, AUC 0.9116520285606384, avg_entr 0.01218977477401495, f1 0.847599983215332
ep24_l4_test_time 5.5032296209997185
gc 0
Train Epoch25 Acc 0.9858 (39432/40000), AUC 0.998546838760376
ep25_train_time 138.39964652599974
Test Epoch25 layer4 Acc 0.847, AUC 0.91386878490448, avg_entr 0.01305419486016035, f1 0.847000002861023
ep25_l4_test_time 5.6214655980002135
gc 0
Train Epoch26 Acc 0.987525 (39501/40000), AUC 0.9987694025039673
ep26_train_time 156.913116017
Test Epoch26 layer4 Acc 0.8418, AUC 0.9028445482254028, avg_entr 0.012965005822479725, f1 0.8418000340461731
ep26_l4_test_time 5.579163166999933
gc 0
Train Epoch27 Acc 0.987525 (39501/40000), AUC 0.9986896514892578
ep27_train_time 156.9228482360004
Test Epoch27 layer4 Acc 0.8422, AUC 0.9048540592193604, avg_entr 0.010629217140376568, f1 0.842199981212616
ep27_l4_test_time 5.582678862000648
gc 0
Train Epoch28 Acc 0.987375 (39495/40000), AUC 0.9984923601150513
ep28_train_time 156.9968999949997
Test Epoch28 layer4 Acc 0.8448, AUC 0.9102861881256104, avg_entr 0.01572265662252903, f1 0.8447999358177185
ep28_l4_test_time 5.533501948999401
gc 0
Train Epoch29 Acc 0.989125 (39565/40000), AUC 0.9988941550254822
ep29_train_time 156.87942592699983
Test Epoch29 layer4 Acc 0.8364, AUC 0.9066005945205688, avg_entr 0.011659126728773117, f1 0.8363999724388123
ep29_l4_test_time 5.596484968999903
Best AUC tensor(0.8806) 7
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 4812.503931027
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.876, AUC 0.9517725706100464, avg_entr 0.13916780054569244, f1 0.8760000467300415
l0_test_time 0.7431638420002855
Test layer1 Acc 0.8722, AUC 0.932531476020813, avg_entr 0.03733890503644943, f1 0.872200071811676
l1_test_time 1.797929940999893
Test layer2 Acc 0.873, AUC 0.933163046836853, avg_entr 0.03106004372239113, f1 0.8730000257492065
l2_test_time 3.0776223390002997
Test layer3 Acc 0.8736, AUC 0.9325911998748779, avg_entr 0.03286590427160263, f1 0.8736000061035156
l3_test_time 4.3121018710007775
Test layer4 Acc 0.8734, AUC 0.9331767559051514, avg_entr 0.0326850600540638, f1 0.8733999729156494
l4_test_time 5.556363145000432
