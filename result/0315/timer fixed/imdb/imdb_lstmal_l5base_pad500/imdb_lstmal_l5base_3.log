total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 23.470508548
Start Training
gc 0
Train Epoch0 Acc 0.511975 (20479/40000), AUC 0.5075468420982361
ep0_train_time 137.403350537
Test Epoch0 layer4 Acc 0.551, AUC 0.734714150428772, avg_entr 0.6840156316757202, f1 0.5509999990463257
ep0_l4_test_time 5.453240339000018
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.8214 (32856/40000), AUC 0.8735154271125793
ep1_train_time 154.578449195
Test Epoch1 layer4 Acc 0.8652, AUC 0.9217984676361084, avg_entr 0.10829414427280426, f1 0.8652000427246094
ep1_l4_test_time 5.497299018999968
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.89 (35600/40000), AUC 0.9345930814743042
ep2_train_time 154.53154494899997
Test Epoch2 layer4 Acc 0.8734, AUC 0.9370880126953125, avg_entr 0.07386680692434311, f1 0.8733999729156494
ep2_l4_test_time 5.363526777000004
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.917975 (36719/40000), AUC 0.9616100788116455
ep3_train_time 154.69957257400006
Test Epoch3 layer4 Acc 0.8858, AUC 0.9475789070129395, avg_entr 0.06608197093009949, f1 0.8858000040054321
ep3_l4_test_time 5.342568657000015
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.93385 (37354/40000), AUC 0.9743688702583313
ep4_train_time 154.75185344299996
Test Epoch4 layer4 Acc 0.8916, AUC 0.9505221843719482, avg_entr 0.04308755323290825, f1 0.8916000127792358
ep4_l4_test_time 5.449596283000005
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.943725 (37749/40000), AUC 0.9818148612976074
ep5_train_time 154.587349508
Test Epoch5 layer4 Acc 0.8856, AUC 0.9505629539489746, avg_entr 0.038468703627586365, f1 0.8855999708175659
ep5_l4_test_time 5.461213983999983
gc 0
Train Epoch6 Acc 0.951275 (38051/40000), AUC 0.986342191696167
ep6_train_time 154.60979071500003
Test Epoch6 layer4 Acc 0.884, AUC 0.9475117921829224, avg_entr 0.03675953298807144, f1 0.8840000033378601
ep6_l4_test_time 5.418255799000008
gc 0
Train Epoch7 Acc 0.955075 (38203/40000), AUC 0.9877852201461792
ep7_train_time 154.679784897
Test Epoch7 layer4 Acc 0.88, AUC 0.947250247001648, avg_entr 0.029730143025517464, f1 0.8799999952316284
ep7_l4_test_time 5.494344963999993
gc 0
Train Epoch8 Acc 0.959475 (38379/40000), AUC 0.9896641373634338
ep8_train_time 154.51277676000018
Test Epoch8 layer4 Acc 0.878, AUC 0.9422160983085632, avg_entr 0.02141769975423813, f1 0.878000020980835
ep8_l4_test_time 5.450969888999907
gc 0
Train Epoch9 Acc 0.9603 (38412/40000), AUC 0.9904040098190308
ep9_train_time 154.4650612219998
Test Epoch9 layer4 Acc 0.8788, AUC 0.9430139660835266, avg_entr 0.02581804245710373, f1 0.8787999749183655
ep9_l4_test_time 5.4373110760000145
gc 0
Train Epoch10 Acc 0.96685 (38674/40000), AUC 0.9929811954498291
ep10_train_time 136.86578583799997
Test Epoch10 layer4 Acc 0.8708, AUC 0.9390225410461426, avg_entr 0.024761265143752098, f1 0.8708000183105469
ep10_l4_test_time 5.56630922699992
gc 0
Train Epoch11 Acc 0.9695 (38780/40000), AUC 0.9943453669548035
ep11_train_time 154.4831439689999
Test Epoch11 layer4 Acc 0.8748, AUC 0.9391207695007324, avg_entr 0.02490011230111122, f1 0.8748000264167786
ep11_l4_test_time 5.504971434000026
gc 0
Train Epoch12 Acc 0.9708 (38832/40000), AUC 0.9946129322052002
ep12_train_time 154.59154171699993
Test Epoch12 layer4 Acc 0.8684, AUC 0.9339847564697266, avg_entr 0.022586612030863762, f1 0.868399977684021
ep12_l4_test_time 5.3372822679998535
gc 0
Train Epoch13 Acc 0.972675 (38907/40000), AUC 0.9951797723770142
ep13_train_time 154.346350582
Test Epoch13 layer4 Acc 0.8664, AUC 0.9349309206008911, avg_entr 0.021068990230560303, f1 0.8664000034332275
ep13_l4_test_time 5.516136964999987
gc 0
Train Epoch14 Acc 0.97575 (39030/40000), AUC 0.9961913824081421
ep14_train_time 154.53430009299973
Test Epoch14 layer4 Acc 0.8652, AUC 0.9307079315185547, avg_entr 0.01855732686817646, f1 0.8652000427246094
ep14_l4_test_time 5.4957515520000015
gc 0
Train Epoch15 Acc 0.977175 (39087/40000), AUC 0.9964008927345276
ep15_train_time 154.3820824329996
Test Epoch15 layer4 Acc 0.8584, AUC 0.9305938482284546, avg_entr 0.022216089069843292, f1 0.8583999872207642
ep15_l4_test_time 5.48987097700001
gc 0
Train Epoch16 Acc 0.979375 (39175/40000), AUC 0.9970612525939941
ep16_train_time 154.53242206599998
Test Epoch16 layer4 Acc 0.8576, AUC 0.9307775497436523, avg_entr 0.017181945964694023, f1 0.8575999140739441
ep16_l4_test_time 5.507873020000261
gc 0
Train Epoch17 Acc 0.9809 (39236/40000), AUC 0.9972729086875916
ep17_train_time 154.3292514169998
Test Epoch17 layer4 Acc 0.8578, AUC 0.9277321696281433, avg_entr 0.01734703779220581, f1 0.8578000068664551
ep17_l4_test_time 5.47135007199995
gc 0
Train Epoch18 Acc 0.981825 (39273/40000), AUC 0.9975969791412354
ep18_train_time 154.52554934200043
Test Epoch18 layer4 Acc 0.857, AUC 0.9225168228149414, avg_entr 0.0179454293102026, f1 0.8569999933242798
ep18_l4_test_time 5.322526154000116
gc 0
Train Epoch19 Acc 0.981525 (39261/40000), AUC 0.9973711967468262
ep19_train_time 138.14589494999973
Test Epoch19 layer4 Acc 0.8486, AUC 0.9236472845077515, avg_entr 0.01493285782635212, f1 0.8485999703407288
ep19_l4_test_time 5.044435284999963
gc 0
Train Epoch20 Acc 0.983575 (39343/40000), AUC 0.9980309009552002
ep20_train_time 154.72026128900006
Test Epoch20 layer4 Acc 0.8556, AUC 0.9234959483146667, avg_entr 0.015619195997714996, f1 0.8555999994277954
ep20_l4_test_time 5.513748061000115
gc 0
Train Epoch21 Acc 0.984575 (39383/40000), AUC 0.9982930421829224
ep21_train_time 154.49770429599994
Test Epoch21 layer4 Acc 0.8522, AUC 0.9212380051612854, avg_entr 0.01695963181555271, f1 0.8521999716758728
ep21_l4_test_time 5.427956816000005
gc 0
Train Epoch22 Acc 0.985175 (39407/40000), AUC 0.9981437921524048
ep22_train_time 154.37406668599988
Test Epoch22 layer4 Acc 0.8466, AUC 0.9184062480926514, avg_entr 0.02700059488415718, f1 0.8465999960899353
ep22_l4_test_time 5.479818830000113
gc 0
Train Epoch23 Acc 0.986375 (39455/40000), AUC 0.9985758066177368
ep23_train_time 154.46437362400002
Test Epoch23 layer4 Acc 0.8424, AUC 0.9179670810699463, avg_entr 0.019023630768060684, f1 0.8424000144004822
ep23_l4_test_time 5.477416422999795
gc 0
Train Epoch24 Acc 0.9868 (39472/40000), AUC 0.9986225366592407
ep24_train_time 154.50544075300013
Test Epoch24 layer4 Acc 0.8472, AUC 0.9181417226791382, avg_entr 0.012542852200567722, f1 0.8471999764442444
ep24_l4_test_time 5.449518902000364
gc 0
Train Epoch25 Acc 0.98615 (39446/40000), AUC 0.998429000377655
ep25_train_time 154.42487062599957
Test Epoch25 layer4 Acc 0.8464, AUC 0.9180450439453125, avg_entr 0.016177935525774956, f1 0.8464000225067139
ep25_l4_test_time 5.542815482000151
gc 0
Train Epoch26 Acc 0.9882 (39528/40000), AUC 0.9988081455230713
ep26_train_time 154.51732299200012
Test Epoch26 layer4 Acc 0.8358, AUC 0.911521315574646, avg_entr 0.01730528473854065, f1 0.8357999920845032
ep26_l4_test_time 5.4671646150000015
gc 0
Train Epoch27 Acc 0.989025 (39561/40000), AUC 0.9990270137786865
ep27_train_time 154.57065615600004
Test Epoch27 layer4 Acc 0.8386, AUC 0.9122971296310425, avg_entr 0.0141362976282835, f1 0.8385999798774719
ep27_l4_test_time 5.354069365000214
gc 0
Train Epoch28 Acc 0.98955 (39582/40000), AUC 0.9988977909088135
ep28_train_time 154.52252300300006
Test Epoch28 layer4 Acc 0.842, AUC 0.9104676246643066, avg_entr 0.012729587033390999, f1 0.8420000076293945
ep28_l4_test_time 5.4568753439998545
gc 0
Train Epoch29 Acc 0.98955 (39582/40000), AUC 0.9990448355674744
ep29_train_time 131.8145496219995
Test Epoch29 layer4 Acc 0.8344, AUC 0.9108597636222839, avg_entr 0.011856373399496078, f1 0.8343999981880188
ep29_l4_test_time 5.543480039999849
Best AUC tensor(0.8916) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 4726.965438005
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8828, AUC 0.9549038410186768, avg_entr 0.17566080391407013, f1 0.8827999830245972
l0_test_time 0.7390902389997791
Test layer1 Acc 0.8862, AUC 0.9448803663253784, avg_entr 0.061509180814027786, f1 0.8862000107765198
l1_test_time 1.7408744280000974
Test layer2 Acc 0.887, AUC 0.9458504915237427, avg_entr 0.04703032225370407, f1 0.8870000243186951
l2_test_time 2.986650916000144
Test layer3 Acc 0.8858, AUC 0.9457671642303467, avg_entr 0.04392775893211365, f1 0.8858000040054321
l3_test_time 4.217422232999525
Test layer4 Acc 0.887, AUC 0.9456952214241028, avg_entr 0.04291068762540817, f1 0.8870000243186951
l4_test_time 5.548867579999751
