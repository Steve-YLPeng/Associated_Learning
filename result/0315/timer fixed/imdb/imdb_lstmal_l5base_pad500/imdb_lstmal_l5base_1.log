total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.491883131
Start Training
gc 0
Train Epoch0 Acc 0.501525 (20061/40000), AUC 0.511877179145813
ep0_train_time 78.29451462099999
Test Epoch0 layer4 Acc 0.6396, AUC 0.6970903277397156, avg_entr 0.7026957273483276, f1 0.6395999789237976
ep0_l4_test_time 2.8591558530000043
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.80955 (32382/40000), AUC 0.8699044585227966
ep1_train_time 78.643537772
Test Epoch1 layer4 Acc 0.8318, AUC 0.9158962368965149, avg_entr 0.12898500263690948, f1 0.8317999839782715
ep1_l4_test_time 2.8348618219999935
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.89795 (35918/40000), AUC 0.9473606944084167
ep2_train_time 78.86408697899998
Test Epoch2 layer4 Acc 0.8764, AUC 0.9415853023529053, avg_entr 0.06918474286794662, f1 0.8763999938964844
ep2_l4_test_time 2.848750313000039
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.918775 (36751/40000), AUC 0.9662322998046875
ep3_train_time 78.864437807
Test Epoch3 layer4 Acc 0.8802, AUC 0.9507573843002319, avg_entr 0.055097319185733795, f1 0.8802000284194946
ep3_l4_test_time 2.861820200000011
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9325 (37300/40000), AUC 0.9767956733703613
ep4_train_time 78.87333460899998
Test Epoch4 layer4 Acc 0.8914, AUC 0.9489409923553467, avg_entr 0.03075072355568409, f1 0.8913999795913696
ep4_l4_test_time 2.839049520000003
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.943175 (37727/40000), AUC 0.9824746251106262
ep5_train_time 78.96550964500005
Test Epoch5 layer4 Acc 0.891, AUC 0.9498887062072754, avg_entr 0.0384746752679348, f1 0.890999972820282
ep5_l4_test_time 2.871767048000038
gc 0
Train Epoch6 Acc 0.94935 (37974/40000), AUC 0.9850380420684814
ep6_train_time 78.89249604700001
Test Epoch6 layer4 Acc 0.883, AUC 0.948968768119812, avg_entr 0.036527086049318314, f1 0.8830000162124634
ep6_l4_test_time 2.8344534860000294
gc 0
Train Epoch7 Acc 0.954375 (38175/40000), AUC 0.9876134395599365
ep7_train_time 78.914144437
Test Epoch7 layer4 Acc 0.8832, AUC 0.9443360567092896, avg_entr 0.028922967612743378, f1 0.8831999897956848
ep7_l4_test_time 2.851131247000012
gc 0
Train Epoch8 Acc 0.959175 (38367/40000), AUC 0.9905222654342651
ep8_train_time 79.031151766
Test Epoch8 layer4 Acc 0.8796, AUC 0.9427498579025269, avg_entr 0.025687120854854584, f1 0.8795999884605408
ep8_l4_test_time 2.8671900909999977
gc 0
Train Epoch9 Acc 0.963425 (38537/40000), AUC 0.992210865020752
ep9_train_time 78.88279243900001
Test Epoch9 layer4 Acc 0.8788, AUC 0.941510796546936, avg_entr 0.02422177419066429, f1 0.8787999749183655
ep9_l4_test_time 2.8334343880000006
gc 0
Train Epoch10 Acc 0.9656 (38624/40000), AUC 0.9928063750267029
ep10_train_time 78.863151797
Test Epoch10 layer4 Acc 0.8722, AUC 0.9383761882781982, avg_entr 0.02213006280362606, f1 0.872200071811676
ep10_l4_test_time 2.8721244229999456
gc 0
Train Epoch11 Acc 0.968425 (38737/40000), AUC 0.9936671853065491
ep11_train_time 78.89768487999993
Test Epoch11 layer4 Acc 0.8724, AUC 0.9378502368927002, avg_entr 0.02493438869714737, f1 0.8723999857902527
ep11_l4_test_time 2.8313848959999177
gc 0
Train Epoch12 Acc 0.9724 (38896/40000), AUC 0.9949398636817932
ep12_train_time 78.84446265600013
Test Epoch12 layer4 Acc 0.8688, AUC 0.9365733861923218, avg_entr 0.023112084716558456, f1 0.8687999844551086
ep12_l4_test_time 2.850174874000004
gc 0
Train Epoch13 Acc 0.972925 (38917/40000), AUC 0.9955856800079346
ep13_train_time 78.8532458090001
Test Epoch13 layer4 Acc 0.8662, AUC 0.9342872500419617, avg_entr 0.02377515286207199, f1 0.8661999702453613
ep13_l4_test_time 2.862687765000146
gc 0
Train Epoch14 Acc 0.97515 (39006/40000), AUC 0.9960249662399292
ep14_train_time 79.01766981100013
Test Epoch14 layer4 Acc 0.855, AUC 0.9307591319084167, avg_entr 0.025129592046141624, f1 0.8550000190734863
ep14_l4_test_time 2.8385970980000366
gc 0
Train Epoch15 Acc 0.977325 (39093/40000), AUC 0.9965303540229797
ep15_train_time 78.92935843600003
Test Epoch15 layer4 Acc 0.8606, AUC 0.9306363463401794, avg_entr 0.018935972824692726, f1 0.8605999946594238
ep15_l4_test_time 2.8732602820000466
gc 0
Train Epoch16 Acc 0.97985 (39194/40000), AUC 0.9971338510513306
ep16_train_time 78.89266304900002
Test Epoch16 layer4 Acc 0.858, AUC 0.9274651408195496, avg_entr 0.018758801743388176, f1 0.8579999804496765
ep16_l4_test_time 2.8290076079999835
gc 0
Train Epoch17 Acc 0.98005 (39202/40000), AUC 0.9972907900810242
ep17_train_time 78.85083038000016
Test Epoch17 layer4 Acc 0.8582, AUC 0.9273531436920166, avg_entr 0.01750265620648861, f1 0.858199954032898
ep17_l4_test_time 2.8571659270000964
gc 0
Train Epoch18 Acc 0.98205 (39282/40000), AUC 0.9976023435592651
ep18_train_time 78.84492828900011
Test Epoch18 layer4 Acc 0.8534, AUC 0.9254637956619263, avg_entr 0.0162285678088665, f1 0.8533999919891357
ep18_l4_test_time 2.867335525000044
gc 0
Train Epoch19 Acc 0.98245 (39298/40000), AUC 0.9978052377700806
ep19_train_time 78.98990591500001
Test Epoch19 layer4 Acc 0.8526, AUC 0.9249305725097656, avg_entr 0.01588229276239872, f1 0.8525999784469604
ep19_l4_test_time 2.833595427000091
gc 0
Train Epoch20 Acc 0.9846 (39384/40000), AUC 0.998099684715271
ep20_train_time 78.93428895400007
Test Epoch20 layer4 Acc 0.8536, AUC 0.9201629757881165, avg_entr 0.013521930202841759, f1 0.853600025177002
ep20_l4_test_time 2.8761252599999807
gc 0
Train Epoch21 Acc 0.985425 (39417/40000), AUC 0.9983168840408325
ep21_train_time 78.82841073500003
Test Epoch21 layer4 Acc 0.8534, AUC 0.9215214252471924, avg_entr 0.015579541213810444, f1 0.8533999919891357
ep21_l4_test_time 2.834960201000058
gc 0
Train Epoch22 Acc 0.986125 (39445/40000), AUC 0.9985971450805664
ep22_train_time 78.828585686
Test Epoch22 layer4 Acc 0.8516, AUC 0.9156332015991211, avg_entr 0.010059582069516182, f1 0.8515999913215637
ep22_l4_test_time 2.8507741239998268
gc 0
Train Epoch23 Acc 0.986975 (39479/40000), AUC 0.9985861778259277
ep23_train_time 78.86742817300001
Test Epoch23 layer4 Acc 0.8474, AUC 0.916437029838562, avg_entr 0.01386021263897419, f1 0.8474000096321106
ep23_l4_test_time 2.864342335999936
gc 0
Train Epoch24 Acc 0.987125 (39485/40000), AUC 0.9987266063690186
ep24_train_time 78.87697943299986
Test Epoch24 layer4 Acc 0.848, AUC 0.9132478833198547, avg_entr 0.012173350900411606, f1 0.8479999899864197
ep24_l4_test_time 2.8347874190003495
gc 0
Train Epoch25 Acc 0.98845 (39538/40000), AUC 0.9988956451416016
ep25_train_time 78.88958759399975
Test Epoch25 layer4 Acc 0.8464, AUC 0.9132803082466125, avg_entr 0.012779495678842068, f1 0.8464000225067139
ep25_l4_test_time 2.871864860000187
gc 0
Train Epoch26 Acc 0.98895 (39558/40000), AUC 0.9989221096038818
ep26_train_time 78.93265377599982
Test Epoch26 layer4 Acc 0.8456, AUC 0.907394289970398, avg_entr 0.011057710275053978, f1 0.8456000089645386
ep26_l4_test_time 2.831547629000397
gc 0
Train Epoch27 Acc 0.9892 (39568/40000), AUC 0.9990274906158447
ep27_train_time 78.89829472700012
Test Epoch27 layer4 Acc 0.8416, AUC 0.9077668190002441, avg_entr 0.011358971707522869, f1 0.8416000008583069
ep27_l4_test_time 2.850450416000058
gc 0
Train Epoch28 Acc 0.990025 (39601/40000), AUC 0.9991083145141602
ep28_train_time 78.9350896650003
Test Epoch28 layer4 Acc 0.842, AUC 0.9072843790054321, avg_entr 0.011596777476370335, f1 0.8420000076293945
ep28_l4_test_time 2.8585686700002952
gc 0
Train Epoch29 Acc 0.9907 (39628/40000), AUC 0.9991016387939453
ep29_train_time 78.94616657799997
Test Epoch29 layer4 Acc 0.8396, AUC 0.9075754880905151, avg_entr 0.011208934709429741, f1 0.8396000266075134
ep29_l4_test_time 2.8344609309997395
Best AUC tensor(0.8914) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 2453.2636689299998
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.895, AUC 0.956021785736084, avg_entr 0.18099135160446167, f1 0.8949999809265137
l0_test_time 0.5492991010000878
Test layer1 Acc 0.8846, AUC 0.941892147064209, avg_entr 0.043772339820861816, f1 0.8845999836921692
l1_test_time 1.0314816719996998
Test layer2 Acc 0.8862, AUC 0.9444383978843689, avg_entr 0.034005627036094666, f1 0.8862000107765198
l2_test_time 1.6262728830001834
Test layer3 Acc 0.8854, AUC 0.9444543123245239, avg_entr 0.03554863482713699, f1 0.8853999972343445
l3_test_time 2.224850293000145
Test layer4 Acc 0.886, AUC 0.9447847008705139, avg_entr 0.0332714281976223, f1 0.8859999775886536
l4_test_time 2.823839597999722
