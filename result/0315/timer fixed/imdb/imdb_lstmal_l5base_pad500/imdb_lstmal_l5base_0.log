total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 23.236229705
Start Training
gc 0
Train Epoch0 Acc 0.506675 (20267/40000), AUC 0.5100346803665161
ep0_train_time 78.270636975
Test Epoch0 layer4 Acc 0.6006, AUC 0.6740058660507202, avg_entr 0.6897595524787903, f1 0.600600004196167
ep0_l4_test_time 2.8728692490000043
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.77365 (30946/40000), AUC 0.8362139463424683
ep1_train_time 78.642919499
Test Epoch1 layer4 Acc 0.8312, AUC 0.9121125340461731, avg_entr 0.20621977746486664, f1 0.8312000632286072
ep1_l4_test_time 2.836772295000003
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.88295 (35318/40000), AUC 0.9363036155700684
ep2_train_time 78.662657687
Test Epoch2 layer4 Acc 0.8422, AUC 0.9189609289169312, avg_entr 0.0940442606806755, f1 0.842199981212616
ep2_l4_test_time 2.8473749309999903
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9073 (36292/40000), AUC 0.9548940658569336
ep3_train_time 78.58494488300005
Test Epoch3 layer4 Acc 0.8894, AUC 0.9452757239341736, avg_entr 0.04716016724705696, f1 0.8894000053405762
ep3_l4_test_time 2.861421660000019
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.92275 (36910/40000), AUC 0.9684537053108215
ep4_train_time 78.547011924
Test Epoch4 layer4 Acc 0.888, AUC 0.9458569288253784, avg_entr 0.04714871570467949, f1 0.8880000114440918
ep4_l4_test_time 2.8461037669999882
gc 0
Train Epoch5 Acc 0.930625 (37225/40000), AUC 0.9719494581222534
ep5_train_time 78.596667937
Test Epoch5 layer4 Acc 0.8888, AUC 0.9386398792266846, avg_entr 0.02911420911550522, f1 0.8888000249862671
ep5_l4_test_time 2.8743286299999795
gc 0
Train Epoch6 Acc 0.9432 (37728/40000), AUC 0.9805455207824707
ep6_train_time 78.57946064700002
Test Epoch6 layer4 Acc 0.8902, AUC 0.9382792115211487, avg_entr 0.03228943794965744, f1 0.8902000188827515
ep6_l4_test_time 2.8412873529999843
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.950975 (38039/40000), AUC 0.9850107431411743
ep7_train_time 78.57447015499997
Test Epoch7 layer4 Acc 0.8736, AUC 0.9388366341590881, avg_entr 0.02873341739177704, f1 0.8736000061035156
ep7_l4_test_time 2.843878031000031
gc 0
Train Epoch8 Acc 0.956775 (38271/40000), AUC 0.987859308719635
ep8_train_time 78.642310372
Test Epoch8 layer4 Acc 0.8834, AUC 0.9395288825035095, avg_entr 0.02216477319598198, f1 0.8834000825881958
ep8_l4_test_time 2.863482911999995
gc 0
Train Epoch9 Acc 0.9602 (38408/40000), AUC 0.9905924797058105
ep9_train_time 78.58944719099998
Test Epoch9 layer4 Acc 0.8792, AUC 0.9408713579177856, avg_entr 0.029734643176198006, f1 0.8791999816894531
ep9_l4_test_time 2.844532650000019
gc 0
Train Epoch10 Acc 0.96035 (38414/40000), AUC 0.9895933866500854
ep10_train_time 78.67125154099995
Test Epoch10 layer4 Acc 0.8786, AUC 0.9370189905166626, avg_entr 0.020680634304881096, f1 0.878600001335144
ep10_l4_test_time 2.8778054619999693
gc 0
Train Epoch11 Acc 0.965925 (38637/40000), AUC 0.9928464293479919
ep11_train_time 78.58441453299997
Test Epoch11 layer4 Acc 0.8724, AUC 0.9381965398788452, avg_entr 0.024238694459199905, f1 0.8723999857902527
ep11_l4_test_time 2.836024097999939
gc 0
Train Epoch12 Acc 0.970075 (38803/40000), AUC 0.9941612482070923
ep12_train_time 78.53895297500003
Test Epoch12 layer4 Acc 0.875, AUC 0.9358892440795898, avg_entr 0.022507796064019203, f1 0.875
ep12_l4_test_time 2.8467997609998292
gc 0
Train Epoch13 Acc 0.97135 (38854/40000), AUC 0.9949910640716553
ep13_train_time 78.66218136499992
Test Epoch13 layer4 Acc 0.8684, AUC 0.9354212284088135, avg_entr 0.025896120816469193, f1 0.868399977684021
ep13_l4_test_time 2.8598384659999283
gc 0
Train Epoch14 Acc 0.97355 (38942/40000), AUC 0.9955834746360779
ep14_train_time 78.73127257500005
Test Epoch14 layer4 Acc 0.8706, AUC 0.9323639869689941, avg_entr 0.018144940957427025, f1 0.8705999851226807
ep14_l4_test_time 2.8449613669999962
gc 0
Train Epoch15 Acc 0.975375 (39015/40000), AUC 0.9959326982498169
ep15_train_time 78.60901934000003
Test Epoch15 layer4 Acc 0.861, AUC 0.9259564876556396, avg_entr 0.01375523954629898, f1 0.8610000014305115
ep15_l4_test_time 2.871917532999987
gc 0
Train Epoch16 Acc 0.9774 (39096/40000), AUC 0.9963680505752563
ep16_train_time 78.51059462600006
Test Epoch16 layer4 Acc 0.864, AUC 0.9302607774734497, avg_entr 0.01875983737409115, f1 0.8640000224113464
ep16_l4_test_time 2.8350904799999626
gc 0
Train Epoch17 Acc 0.978825 (39153/40000), AUC 0.9969041347503662
ep17_train_time 78.5363766559999
Test Epoch17 layer4 Acc 0.8604, AUC 0.9256595373153687, avg_entr 0.016560319811105728, f1 0.8604000210762024
ep17_l4_test_time 2.845426519000057
gc 0
Train Epoch18 Acc 0.98045 (39218/40000), AUC 0.9974297285079956
ep18_train_time 78.56846832600013
Test Epoch18 layer4 Acc 0.8578, AUC 0.9264754056930542, avg_entr 0.01622043550014496, f1 0.8578000068664551
ep18_l4_test_time 2.862619257999995
gc 0
Train Epoch19 Acc 0.981025 (39241/40000), AUC 0.9972586631774902
ep19_train_time 78.59192859399991
Test Epoch19 layer4 Acc 0.8552, AUC 0.9253294467926025, avg_entr 0.017660923302173615, f1 0.8551999926567078
ep19_l4_test_time 2.8479998989998876
gc 0
Train Epoch20 Acc 0.982175 (39287/40000), AUC 0.9977066516876221
ep20_train_time 78.58738199999993
Test Epoch20 layer4 Acc 0.8552, AUC 0.9223260879516602, avg_entr 0.01464561466127634, f1 0.8551999926567078
ep20_l4_test_time 2.8710219829999915
gc 0
Train Epoch21 Acc 0.9831 (39324/40000), AUC 0.9977972507476807
ep21_train_time 78.57755815500013
Test Epoch21 layer4 Acc 0.8534, AUC 0.9231282472610474, avg_entr 0.013786406256258488, f1 0.8533999919891357
ep21_l4_test_time 2.831981356999904
gc 0
Train Epoch22 Acc 0.9842 (39368/40000), AUC 0.998052716255188
ep22_train_time 78.639921748
Test Epoch22 layer4 Acc 0.8536, AUC 0.9160432815551758, avg_entr 0.012127136811614037, f1 0.853600025177002
ep22_l4_test_time 2.8495943079999506
gc 0
Train Epoch23 Acc 0.985475 (39419/40000), AUC 0.9983265399932861
ep23_train_time 78.68277629099998
Test Epoch23 layer4 Acc 0.8468, AUC 0.915529191493988, avg_entr 0.01761106587946415, f1 0.8468000292778015
ep23_l4_test_time 2.8619004970000788
gc 0
Train Epoch24 Acc 0.98595 (39438/40000), AUC 0.998417854309082
ep24_train_time 78.66606358099966
Test Epoch24 layer4 Acc 0.846, AUC 0.9161133170127869, avg_entr 0.01716318354010582, f1 0.8460000157356262
ep24_l4_test_time 2.8455590190001203
gc 0
Train Epoch25 Acc 0.987325 (39493/40000), AUC 0.9986160397529602
ep25_train_time 78.55354354100018
Test Epoch25 layer4 Acc 0.839, AUC 0.9077450037002563, avg_entr 0.014706283807754517, f1 0.8389999866485596
ep25_l4_test_time 2.871833284999866
gc 0
Train Epoch26 Acc 0.98625 (39450/40000), AUC 0.9982607364654541
ep26_train_time 78.53189334900026
Test Epoch26 layer4 Acc 0.8472, AUC 0.9095011353492737, avg_entr 0.012734893709421158, f1 0.8471999764442444
ep26_l4_test_time 2.8349180959999103
gc 0
Train Epoch27 Acc 0.9884 (39536/40000), AUC 0.9987044930458069
ep27_train_time 78.55920394899977
Test Epoch27 layer4 Acc 0.8436, AUC 0.9104854464530945, avg_entr 0.013284547254443169, f1 0.8435999751091003
ep27_l4_test_time 2.849213618000249
gc 0
Train Epoch28 Acc 0.988975 (39559/40000), AUC 0.9989989995956421
ep28_train_time 78.56094281100013
Test Epoch28 layer4 Acc 0.8398, AUC 0.9099858999252319, avg_entr 0.01289251446723938, f1 0.8398000001907349
ep28_l4_test_time 2.8600021620000007
gc 0
Train Epoch29 Acc 0.989275 (39571/40000), AUC 0.998884916305542
ep29_train_time 78.53459603700003
Test Epoch29 layer4 Acc 0.8386, AUC 0.9090179204940796, avg_entr 0.013595616444945335, f1 0.8385999798774719
ep29_l4_test_time 2.8401263270002346
Best AUC tensor(0.8902) 6
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 2444.753136541
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8562, AUC 0.9531316161155701, avg_entr 0.15057529509067535, f1 0.8561999797821045
l0_test_time 0.5415726340002038
Test layer1 Acc 0.876, AUC 0.9350130558013916, avg_entr 0.03947615623474121, f1 0.8760000467300415
l1_test_time 1.0381751640002221
Test layer2 Acc 0.8778, AUC 0.9365315437316895, avg_entr 0.031531766057014465, f1 0.8778000473976135
l2_test_time 1.6391813190002722
Test layer3 Acc 0.8762, AUC 0.9374387264251709, avg_entr 0.03485540673136711, f1 0.8762000203132629
l3_test_time 2.246987388999969
Test layer4 Acc 0.8776, AUC 0.9373836517333984, avg_entr 0.03328744322061539, f1 0.8776000142097473
l4_test_time 2.8441969450000215
