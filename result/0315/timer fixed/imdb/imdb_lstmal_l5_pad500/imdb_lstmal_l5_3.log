total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.292490433
Start Training
gc 0
Train Epoch0 Acc 0.50665 (20266/40000), AUC 0.5105066299438477
ep0_train_time 78.50883034
Test Epoch0 layer0 Acc 0.7554, AUC 0.8913650512695312, avg_entr 0.5536611080169678, f1 0.7554000020027161
ep0_l0_test_time 0.5497030570000021
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5804, AUC 0.6494101285934448, avg_entr 0.6562089920043945, f1 0.5803999900817871
ep0_l1_test_time 1.0375093809999925
Test Epoch0 layer2 Acc 0.5924, AUC 0.6874821186065674, avg_entr 0.6627114415168762, f1 0.5924000144004822
ep0_l2_test_time 1.6615693459999932
Test Epoch0 layer3 Acc 0.5284, AUC 0.6943699717521667, avg_entr 0.6758637428283691, f1 0.5284000039100647
ep0_l3_test_time 2.269128026000004
Test Epoch0 layer4 Acc 0.5182, AUC 0.7022347450256348, avg_entr 0.6858860850334167, f1 0.5181999802589417
ep0_l4_test_time 2.8869828119999994
gc 0
Train Epoch1 Acc 0.777725 (31109/40000), AUC 0.8426142930984497
ep1_train_time 78.90793141099999
Test Epoch1 layer0 Acc 0.8814, AUC 0.9462722539901733, avg_entr 0.29313385486602783, f1 0.8813999891281128
ep1_l0_test_time 0.5511170609999851
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.7974, AUC 0.8679064512252808, avg_entr 0.24528931081295013, f1 0.7973999977111816
ep1_l1_test_time 1.0439291980000007
Test Epoch1 layer2 Acc 0.8222, AUC 0.8916066884994507, avg_entr 0.13892823457717896, f1 0.8221999406814575
ep1_l2_test_time 1.6445593580000093
Test Epoch1 layer3 Acc 0.822, AUC 0.8931059241294861, avg_entr 0.13029691576957703, f1 0.8220000267028809
ep1_l3_test_time 2.247646277000001
Test Epoch1 layer4 Acc 0.8232, AUC 0.89310622215271, avg_entr 0.12270009517669678, f1 0.823199987411499
ep1_l4_test_time 2.8543776859999923
gc 0
Train Epoch2 Acc 0.872875 (34915/40000), AUC 0.9265334010124207
ep2_train_time 78.90711240600001
Test Epoch2 layer0 Acc 0.881, AUC 0.9551907777786255, avg_entr 0.22665956616401672, f1 0.8809999823570251
ep2_l0_test_time 0.5464911400000005
Test Epoch2 layer1 Acc 0.8728, AUC 0.9293832778930664, avg_entr 0.06574743986129761, f1 0.8727999925613403
ep2_l1_test_time 1.0518948179999938
Test Epoch2 layer2 Acc 0.87, AUC 0.9316465854644775, avg_entr 0.058003980666399, f1 0.8700000047683716
ep2_l2_test_time 1.6624551390000306
Test Epoch2 layer3 Acc 0.869, AUC 0.9329692721366882, avg_entr 0.0590241439640522, f1 0.8690000176429749
ep2_l3_test_time 2.258143469999993
Test Epoch2 layer4 Acc 0.8686, AUC 0.9328861832618713, avg_entr 0.05456915125250816, f1 0.8686000108718872
ep2_l4_test_time 2.872231487000022
gc 0
Train Epoch3 Acc 0.9081 (36324/40000), AUC 0.9528861045837402
ep3_train_time 78.93517107299999
Test Epoch3 layer0 Acc 0.8954, AUC 0.9579761028289795, avg_entr 0.20093593001365662, f1 0.8953999876976013
ep3_l0_test_time 0.5621398399999862
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8768, AUC 0.9379788637161255, avg_entr 0.10114064812660217, f1 0.876800000667572
ep3_l1_test_time 1.0512101209999969
Test Epoch3 layer2 Acc 0.8828, AUC 0.9452003240585327, avg_entr 0.10612499713897705, f1 0.8827999830245972
ep3_l2_test_time 1.6617394650000392
Test Epoch3 layer3 Acc 0.8838, AUC 0.945214033126831, avg_entr 0.12980994582176208, f1 0.8838000297546387
ep3_l3_test_time 2.264978957999972
Test Epoch3 layer4 Acc 0.8842, AUC 0.9449278116226196, avg_entr 0.1327044814825058, f1 0.8842000365257263
ep3_l4_test_time 2.87892145699999
gc 0
Train Epoch4 Acc 0.92545 (37018/40000), AUC 0.9684717655181885
ep4_train_time 88.66363531899998
Test Epoch4 layer0 Acc 0.8994, AUC 0.9590795040130615, avg_entr 0.1804921180009842, f1 0.8993999361991882
ep4_l0_test_time 0.805238739999993
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8904, AUC 0.9460504055023193, avg_entr 0.055799804627895355, f1 0.8903999924659729
ep4_l1_test_time 1.2232354360000386
Test Epoch4 layer2 Acc 0.8898, AUC 0.9486621618270874, avg_entr 0.048517387360334396, f1 0.8898000121116638
ep4_l2_test_time 2.0618892319999986
Test Epoch4 layer3 Acc 0.89, AUC 0.9489322900772095, avg_entr 0.04642684385180473, f1 0.8899999856948853
ep4_l3_test_time 2.760530686999971
Test Epoch4 layer4 Acc 0.89, AUC 0.9488159418106079, avg_entr 0.04454796388745308, f1 0.8899999856948853
ep4_l4_test_time 3.644706073000009
gc 0
Train Epoch5 Acc 0.9385 (37540/40000), AUC 0.9783768057823181
ep5_train_time 98.61281674100002
Test Epoch5 layer0 Acc 0.8954, AUC 0.9577754139900208, avg_entr 0.16528119146823883, f1 0.8953999876976013
ep5_l0_test_time 0.5585123920000115
Test Epoch5 layer1 Acc 0.891, AUC 0.9474499225616455, avg_entr 0.04944940283894539, f1 0.890999972820282
ep5_l1_test_time 1.0519924950000359
Test Epoch5 layer2 Acc 0.8932, AUC 0.9487777948379517, avg_entr 0.04076115041971207, f1 0.8931999802589417
ep5_l2_test_time 1.6788201900000104
Test Epoch5 layer3 Acc 0.8908, AUC 0.9490453004837036, avg_entr 0.03829091787338257, f1 0.8907999992370605
ep5_l3_test_time 2.526215546000003
Test Epoch5 layer4 Acc 0.8904, AUC 0.9489016532897949, avg_entr 0.03487120196223259, f1 0.8903999924659729
ep5_l4_test_time 3.2855243819999487
gc 0
Train Epoch6 Acc 0.94375 (37750/40000), AUC 0.9807828664779663
ep6_train_time 99.52597992699998
Test Epoch6 layer0 Acc 0.8872, AUC 0.9576898217201233, avg_entr 0.15199290215969086, f1 0.8871999979019165
ep6_l0_test_time 0.6294963130000042
Test Epoch6 layer1 Acc 0.881, AUC 0.9406993389129639, avg_entr 0.043662697076797485, f1 0.8809999823570251
ep6_l1_test_time 1.2868157699999756
Test Epoch6 layer2 Acc 0.8822, AUC 0.9435739517211914, avg_entr 0.036510054022073746, f1 0.8822000026702881
ep6_l2_test_time 2.082357287000036
Test Epoch6 layer3 Acc 0.8834, AUC 0.9435418844223022, avg_entr 0.03513236343860626, f1 0.8834000825881958
ep6_l3_test_time 2.7446887290000177
Test Epoch6 layer4 Acc 0.8844, AUC 0.9435613751411438, avg_entr 0.033394765108823776, f1 0.8844000101089478
ep6_l4_test_time 3.6412707150000188
gc 0
Train Epoch7 Acc 0.935725 (37429/40000), AUC 0.9782419204711914
ep7_train_time 91.99773168800004
Test Epoch7 layer0 Acc 0.8968, AUC 0.9562072157859802, avg_entr 0.14717058837413788, f1 0.8967999815940857
ep7_l0_test_time 0.6244862129999547
Test Epoch7 layer1 Acc 0.8566, AUC 0.9360560178756714, avg_entr 0.06420785188674927, f1 0.8565999865531921
ep7_l1_test_time 1.2804783300000508
Test Epoch7 layer2 Acc 0.849, AUC 0.9356372356414795, avg_entr 0.060147974640131, f1 0.8489999771118164
ep7_l2_test_time 2.0748939430000064
Test Epoch7 layer3 Acc 0.8526, AUC 0.9350451231002808, avg_entr 0.06231136992573738, f1 0.8525999784469604
ep7_l3_test_time 2.812282130999961
Test Epoch7 layer4 Acc 0.8536, AUC 0.9345998167991638, avg_entr 0.053444501012563705, f1 0.853600025177002
ep7_l4_test_time 3.626766126000007
gc 0
Train Epoch8 Acc 0.9529 (38116/40000), AUC 0.9863982200622559
ep8_train_time 99.16222558499999
Test Epoch8 layer0 Acc 0.8936, AUC 0.9546831846237183, avg_entr 0.1405262053012848, f1 0.8935999870300293
ep8_l0_test_time 0.5588246920000302
Test Epoch8 layer1 Acc 0.881, AUC 0.943096399307251, avg_entr 0.03586895018815994, f1 0.8809999823570251
ep8_l1_test_time 1.053989085000012
Test Epoch8 layer2 Acc 0.8824, AUC 0.9430227279663086, avg_entr 0.027045970782637596, f1 0.8823999762535095
ep8_l2_test_time 1.6655166399999644
Test Epoch8 layer3 Acc 0.8818, AUC 0.9425950050354004, avg_entr 0.025351688265800476, f1 0.8818000555038452
ep8_l3_test_time 2.3112809830000742
Test Epoch8 layer4 Acc 0.8816, AUC 0.9424533843994141, avg_entr 0.02379107102751732, f1 0.881600022315979
ep8_l4_test_time 3.2819755299999542
gc 0
Train Epoch9 Acc 0.96265 (38506/40000), AUC 0.9915255308151245
ep9_train_time 98.96196870000006
Test Epoch9 layer0 Acc 0.8916, AUC 0.9534021615982056, avg_entr 0.13486623764038086, f1 0.8916000127792358
ep9_l0_test_time 0.6270012799999449
Test Epoch9 layer1 Acc 0.8776, AUC 0.9399067759513855, avg_entr 0.0295160673558712, f1 0.8776000142097473
ep9_l1_test_time 1.2930875660000538
Test Epoch9 layer2 Acc 0.8796, AUC 0.9401350021362305, avg_entr 0.02413307875394821, f1 0.8795999884605408
ep9_l2_test_time 2.091874824999991
Test Epoch9 layer3 Acc 0.8784, AUC 0.9397420883178711, avg_entr 0.02341562882065773, f1 0.8784000277519226
ep9_l3_test_time 2.767375347999973
Test Epoch9 layer4 Acc 0.8776, AUC 0.9399977922439575, avg_entr 0.022476116195321083, f1 0.8776000142097473
ep9_l4_test_time 3.642113743999971
gc 0
Train Epoch10 Acc 0.9645 (38580/40000), AUC 0.9928244948387146
ep10_train_time 92.17444093799998
Test Epoch10 layer0 Acc 0.8858, AUC 0.9524227380752563, avg_entr 0.13050667941570282, f1 0.8858000040054321
ep10_l0_test_time 0.6342363070000374
Test Epoch10 layer1 Acc 0.8764, AUC 0.9400362372398376, avg_entr 0.03204885125160217, f1 0.8763999938964844
ep10_l1_test_time 1.2708494019998398
Test Epoch10 layer2 Acc 0.8756, AUC 0.9403853416442871, avg_entr 0.0253017395734787, f1 0.8756000399589539
ep10_l2_test_time 2.1178778340001827
Test Epoch10 layer3 Acc 0.8752, AUC 0.9402026534080505, avg_entr 0.024023616686463356, f1 0.8751999735832214
ep10_l3_test_time 2.8023610220000137
Test Epoch10 layer4 Acc 0.8752, AUC 0.9404405951499939, avg_entr 0.022999607026576996, f1 0.8751999735832214
ep10_l4_test_time 3.666884687999982
gc 0
Train Epoch11 Acc 0.965825 (38633/40000), AUC 0.9932209253311157
ep11_train_time 99.40475308400005
Test Epoch11 layer0 Acc 0.8886, AUC 0.9513819217681885, avg_entr 0.13070541620254517, f1 0.8885999917984009
ep11_l0_test_time 0.5578092250000282
Test Epoch11 layer1 Acc 0.8748, AUC 0.9398186206817627, avg_entr 0.034301530569791794, f1 0.8748000264167786
ep11_l1_test_time 1.047038202000067
Test Epoch11 layer2 Acc 0.875, AUC 0.9402698278427124, avg_entr 0.02669222094118595, f1 0.875
ep11_l2_test_time 1.6504049620000387
Test Epoch11 layer3 Acc 0.8742, AUC 0.9403003454208374, avg_entr 0.02525947615504265, f1 0.8741999864578247
ep11_l3_test_time 2.261683689000165
Test Epoch11 layer4 Acc 0.8746, AUC 0.9404952526092529, avg_entr 0.02415752038359642, f1 0.8745999932289124
ep11_l4_test_time 3.1883620950000022
gc 0
Train Epoch12 Acc 0.96805 (38722/40000), AUC 0.993989109992981
ep12_train_time 93.20569149599987
Test Epoch12 layer0 Acc 0.8878, AUC 0.9501652717590332, avg_entr 0.12745288014411926, f1 0.8877999782562256
ep12_l0_test_time 0.5598073490000388
Test Epoch12 layer1 Acc 0.8748, AUC 0.937221348285675, avg_entr 0.026945974677801132, f1 0.8748000264167786
ep12_l1_test_time 1.0644914569998036
Test Epoch12 layer2 Acc 0.8748, AUC 0.9373528957366943, avg_entr 0.02092546969652176, f1 0.8748000264167786
ep12_l2_test_time 1.6647122719998606
Test Epoch12 layer3 Acc 0.874, AUC 0.9372498989105225, avg_entr 0.020054489374160767, f1 0.8740000128746033
ep12_l3_test_time 2.256771623999839
Test Epoch12 layer4 Acc 0.8736, AUC 0.9375848770141602, avg_entr 0.019898291677236557, f1 0.8736000061035156
ep12_l4_test_time 2.8615007560001686
gc 0
Train Epoch13 Acc 0.9693 (38772/40000), AUC 0.9943438768386841
ep13_train_time 78.9403260470001
Test Epoch13 layer0 Acc 0.8862, AUC 0.9495457410812378, avg_entr 0.12720099091529846, f1 0.8862000107765198
ep13_l0_test_time 0.5558796059999622
Test Epoch13 layer1 Acc 0.8728, AUC 0.9370437860488892, avg_entr 0.02806795947253704, f1 0.8727999925613403
ep13_l1_test_time 1.0488799190000009
Test Epoch13 layer2 Acc 0.8728, AUC 0.9369463920593262, avg_entr 0.021859506145119667, f1 0.8727999925613403
ep13_l2_test_time 1.6586093000000801
Test Epoch13 layer3 Acc 0.8728, AUC 0.936819314956665, avg_entr 0.020971791818737984, f1 0.8727999925613403
ep13_l3_test_time 2.260262539999985
Test Epoch13 layer4 Acc 0.8724, AUC 0.9373094439506531, avg_entr 0.02070545218884945, f1 0.8723999857902527
ep13_l4_test_time 2.872014082000078
gc 0
Train Epoch14 Acc 0.97025 (38810/40000), AUC 0.9947541952133179
ep14_train_time 78.77790190500014
Test Epoch14 layer0 Acc 0.885, AUC 0.9488797187805176, avg_entr 0.12529022991657257, f1 0.8849999904632568
ep14_l0_test_time 0.5485531389999778
Test Epoch14 layer1 Acc 0.8704, AUC 0.9379172921180725, avg_entr 0.03298434615135193, f1 0.8704000115394592
ep14_l1_test_time 1.0312380860000303
Test Epoch14 layer2 Acc 0.8722, AUC 0.9381325244903564, avg_entr 0.025979919359087944, f1 0.872200071811676
ep14_l2_test_time 1.6363104929998826
Test Epoch14 layer3 Acc 0.872, AUC 0.9380207061767578, avg_entr 0.02391495183110237, f1 0.871999979019165
ep14_l3_test_time 2.243863182000041
Test Epoch14 layer4 Acc 0.8718, AUC 0.9384020566940308, avg_entr 0.023416021838784218, f1 0.8718000650405884
ep14_l4_test_time 2.850800079999999
gc 0
Train Epoch15 Acc 0.9716 (38864/40000), AUC 0.9948924779891968
ep15_train_time 78.74743398999999
Test Epoch15 layer0 Acc 0.8848, AUC 0.9483098387718201, avg_entr 0.1245337650179863, f1 0.8848000168800354
ep15_l0_test_time 0.5517222840001068
Test Epoch15 layer1 Acc 0.8728, AUC 0.9347498416900635, avg_entr 0.02521783672273159, f1 0.8727999925613403
ep15_l1_test_time 1.0328411279999727
Test Epoch15 layer2 Acc 0.8722, AUC 0.9349311590194702, avg_entr 0.019597601145505905, f1 0.872200071811676
ep15_l2_test_time 1.6493606270000782
Test Epoch15 layer3 Acc 0.8728, AUC 0.934638261795044, avg_entr 0.01873590610921383, f1 0.8727999925613403
ep15_l3_test_time 2.265187678000075
Test Epoch15 layer4 Acc 0.8724, AUC 0.9354667663574219, avg_entr 0.018984824419021606, f1 0.8723999857902527
ep15_l4_test_time 2.886654292000003
gc 0
Train Epoch16 Acc 0.972175 (38887/40000), AUC 0.9951541423797607
ep16_train_time 78.7885236699999
Test Epoch16 layer0 Acc 0.883, AUC 0.9478102326393127, avg_entr 0.12354114651679993, f1 0.8830000162124634
ep16_l0_test_time 0.5485903269998289
Test Epoch16 layer1 Acc 0.8716, AUC 0.9340721368789673, avg_entr 0.02770143747329712, f1 0.8715999722480774
ep16_l1_test_time 1.031599136000068
Test Epoch16 layer2 Acc 0.8716, AUC 0.9341990947723389, avg_entr 0.021060505881905556, f1 0.8715999722480774
ep16_l2_test_time 1.635721588000024
Test Epoch16 layer3 Acc 0.8712, AUC 0.9344447255134583, avg_entr 0.020243262872099876, f1 0.8712000846862793
ep16_l3_test_time 2.2337164680000114
Test Epoch16 layer4 Acc 0.8712, AUC 0.9348059892654419, avg_entr 0.020547019317746162, f1 0.8712000846862793
ep16_l4_test_time 2.8443708380000317
gc 0
Train Epoch17 Acc 0.972725 (38909/40000), AUC 0.9955342411994934
ep17_train_time 78.75259151900013
Test Epoch17 layer0 Acc 0.8818, AUC 0.947415828704834, avg_entr 0.12222812324762344, f1 0.8818000555038452
ep17_l0_test_time 0.5477810229999704
Test Epoch17 layer1 Acc 0.8714, AUC 0.9345792531967163, avg_entr 0.025082292035222054, f1 0.871399998664856
ep17_l1_test_time 1.0392388150000897
Test Epoch17 layer2 Acc 0.8722, AUC 0.9346441030502319, avg_entr 0.01921640709042549, f1 0.872200071811676
ep17_l2_test_time 1.6444203650000873
Test Epoch17 layer3 Acc 0.8716, AUC 0.9347277879714966, avg_entr 0.018227241933345795, f1 0.8715999722480774
ep17_l3_test_time 2.249130758999854
Test Epoch17 layer4 Acc 0.8714, AUC 0.9352315664291382, avg_entr 0.018592266365885735, f1 0.871399998664856
ep17_l4_test_time 2.8620213530000456
gc 0
Train Epoch18 Acc 0.9732 (38928/40000), AUC 0.9957417249679565
ep18_train_time 78.79604413599986
Test Epoch18 layer0 Acc 0.883, AUC 0.9470933675765991, avg_entr 0.12041927129030228, f1 0.8830000162124634
ep18_l0_test_time 0.5465035160000298
Test Epoch18 layer1 Acc 0.8706, AUC 0.9347101449966431, avg_entr 0.02731042541563511, f1 0.8705999851226807
ep18_l1_test_time 1.0405516790001457
Test Epoch18 layer2 Acc 0.8714, AUC 0.9348564743995667, avg_entr 0.021804550662636757, f1 0.871399998664856
ep18_l2_test_time 1.6466771270002027
Test Epoch18 layer3 Acc 0.8704, AUC 0.9345906972885132, avg_entr 0.02063515968620777, f1 0.8704000115394592
ep18_l3_test_time 2.2640430139999808
Test Epoch18 layer4 Acc 0.8708, AUC 0.9353681802749634, avg_entr 0.02062976360321045, f1 0.8708000183105469
ep18_l4_test_time 2.8729278769999382
gc 0
Train Epoch19 Acc 0.973975 (38959/40000), AUC 0.9959852695465088
ep19_train_time 78.82656910900005
Test Epoch19 layer0 Acc 0.8814, AUC 0.9468448162078857, avg_entr 0.12005303800106049, f1 0.8813999891281128
ep19_l0_test_time 0.5594689770000514
Test Epoch19 layer1 Acc 0.8698, AUC 0.9340729117393494, avg_entr 0.026844561100006104, f1 0.8697999715805054
ep19_l1_test_time 1.035214576000044
Test Epoch19 layer2 Acc 0.8702, AUC 0.9342684149742126, avg_entr 0.02098301611840725, f1 0.870199978351593
ep19_l2_test_time 1.6372492590001002
Test Epoch19 layer3 Acc 0.8696, AUC 0.9342972040176392, avg_entr 0.02015620656311512, f1 0.8695999383926392
ep19_l3_test_time 2.2583435599999575
Test Epoch19 layer4 Acc 0.8692, AUC 0.9349246025085449, avg_entr 0.02033030427992344, f1 0.8691999912261963
ep19_l4_test_time 2.8489175490001344
gc 0
Train Epoch20 Acc 0.97465 (38986/40000), AUC 0.9960135221481323
ep20_train_time 78.92215666099992
Test Epoch20 layer0 Acc 0.8824, AUC 0.946453869342804, avg_entr 0.11861614137887955, f1 0.8823999762535095
ep20_l0_test_time 0.5857737129999805
Test Epoch20 layer1 Acc 0.8708, AUC 0.9338123798370361, avg_entr 0.026816509664058685, f1 0.8708000183105469
ep20_l1_test_time 1.0422267639999063
Test Epoch20 layer2 Acc 0.871, AUC 0.9340095520019531, avg_entr 0.0212062019854784, f1 0.8709999918937683
ep20_l2_test_time 1.6460191460000715
Test Epoch20 layer3 Acc 0.8702, AUC 0.9341220855712891, avg_entr 0.020376473665237427, f1 0.870199978351593
ep20_l3_test_time 2.272864115999937
Test Epoch20 layer4 Acc 0.8706, AUC 0.9346423745155334, avg_entr 0.020655406638979912, f1 0.8705999851226807
ep20_l4_test_time 2.888199020000002
gc 0
Train Epoch21 Acc 0.9745 (38980/40000), AUC 0.9962260723114014
ep21_train_time 78.77030239500004
Test Epoch21 layer0 Acc 0.8824, AUC 0.9463763236999512, avg_entr 0.11817947030067444, f1 0.8823999762535095
ep21_l0_test_time 0.5568439610001406
Test Epoch21 layer1 Acc 0.8692, AUC 0.9340247511863708, avg_entr 0.0270121730864048, f1 0.8691999912261963
ep21_l1_test_time 1.034268425999926
Test Epoch21 layer2 Acc 0.8698, AUC 0.9340580701828003, avg_entr 0.021232618018984795, f1 0.8697999715805054
ep21_l2_test_time 1.6399096889999782
Test Epoch21 layer3 Acc 0.8692, AUC 0.934039831161499, avg_entr 0.02021084353327751, f1 0.8691999912261963
ep21_l3_test_time 2.2448380239998187
Test Epoch21 layer4 Acc 0.8694, AUC 0.9346667528152466, avg_entr 0.02029743604362011, f1 0.8694000244140625
ep21_l4_test_time 2.846734165000271
gc 0
Train Epoch22 Acc 0.975575 (39023/40000), AUC 0.9962962865829468
ep22_train_time 78.80085269599977
Test Epoch22 layer0 Acc 0.8826, AUC 0.9462075233459473, avg_entr 0.11744661629199982, f1 0.8826000094413757
ep22_l0_test_time 0.5459182529998543
Test Epoch22 layer1 Acc 0.8692, AUC 0.9337688684463501, avg_entr 0.026365332305431366, f1 0.8691999912261963
ep22_l1_test_time 1.04004168199981
Test Epoch22 layer2 Acc 0.8702, AUC 0.9338034987449646, avg_entr 0.02098018303513527, f1 0.870199978351593
ep22_l2_test_time 1.6478124989998832
Test Epoch22 layer3 Acc 0.8694, AUC 0.9335317611694336, avg_entr 0.02009440027177334, f1 0.8694000244140625
ep22_l3_test_time 2.258593122000093
Test Epoch22 layer4 Acc 0.8692, AUC 0.9344613552093506, avg_entr 0.020270805805921555, f1 0.8691999912261963
ep22_l4_test_time 2.8700542550000137
gc 0
Train Epoch23 Acc 0.975625 (39025/40000), AUC 0.9963266849517822
ep23_train_time 78.78572046999989
Test Epoch23 layer0 Acc 0.8804, AUC 0.9461356401443481, avg_entr 0.11762849241495132, f1 0.8804000020027161
ep23_l0_test_time 0.5519170699999449
Test Epoch23 layer1 Acc 0.8676, AUC 0.934207558631897, avg_entr 0.026208020746707916, f1 0.8675999641418457
ep23_l1_test_time 1.0441421709997485
Test Epoch23 layer2 Acc 0.8686, AUC 0.934127688407898, avg_entr 0.020206686109304428, f1 0.8686000108718872
ep23_l2_test_time 1.649578358999861
Test Epoch23 layer3 Acc 0.868, AUC 0.9340646266937256, avg_entr 0.019383659586310387, f1 0.8679999709129333
ep23_l3_test_time 2.255263482999908
Test Epoch23 layer4 Acc 0.8676, AUC 0.9346593618392944, avg_entr 0.019619284197688103, f1 0.8675999641418457
ep23_l4_test_time 2.872511202000169
gc 0
Train Epoch24 Acc 0.975725 (39029/40000), AUC 0.99631667137146
ep24_train_time 78.88060045700013
Test Epoch24 layer0 Acc 0.8814, AUC 0.9459584951400757, avg_entr 0.11575184017419815, f1 0.8813999891281128
ep24_l0_test_time 0.5475056989998848
Test Epoch24 layer1 Acc 0.8686, AUC 0.9341073036193848, avg_entr 0.026182278990745544, f1 0.8686000108718872
ep24_l1_test_time 1.0339871009996386
Test Epoch24 layer2 Acc 0.869, AUC 0.9340803623199463, avg_entr 0.01989671215415001, f1 0.8690000176429749
ep24_l2_test_time 1.6368966400000318
Test Epoch24 layer3 Acc 0.8682, AUC 0.9337413311004639, avg_entr 0.01888277754187584, f1 0.8682000041007996
ep24_l3_test_time 2.2462586430001465
Test Epoch24 layer4 Acc 0.8684, AUC 0.9346691370010376, avg_entr 0.019229115918278694, f1 0.868399977684021
ep24_l4_test_time 2.857548205999592
gc 0
Train Epoch25 Acc 0.9756 (39024/40000), AUC 0.9964219331741333
ep25_train_time 78.88091233200021
Test Epoch25 layer0 Acc 0.8812, AUC 0.9459048509597778, avg_entr 0.11604339629411697, f1 0.8812000155448914
ep25_l0_test_time 0.5576185929999156
Test Epoch25 layer1 Acc 0.8686, AUC 0.9335681200027466, avg_entr 0.02579229697585106, f1 0.8686000108718872
ep25_l1_test_time 1.0519648690001304
Test Epoch25 layer2 Acc 0.8688, AUC 0.933548092842102, avg_entr 0.019962096586823463, f1 0.8687999844551086
ep25_l2_test_time 1.6504310239997722
Test Epoch25 layer3 Acc 0.8688, AUC 0.9332146644592285, avg_entr 0.019153732806444168, f1 0.8687999844551086
ep25_l3_test_time 2.2667494960001022
Test Epoch25 layer4 Acc 0.8682, AUC 0.9342009425163269, avg_entr 0.019387679174542427, f1 0.8682000041007996
ep25_l4_test_time 2.889451472000019
gc 0
Train Epoch26 Acc 0.97605 (39042/40000), AUC 0.9965372085571289
ep26_train_time 78.86513462199991
Test Epoch26 layer0 Acc 0.8818, AUC 0.9458307027816772, avg_entr 0.11536596715450287, f1 0.8818000555038452
ep26_l0_test_time 0.5462066869999944
Test Epoch26 layer1 Acc 0.8688, AUC 0.9331520199775696, avg_entr 0.025351643562316895, f1 0.8687999844551086
ep26_l1_test_time 1.0351952500000152
Test Epoch26 layer2 Acc 0.8686, AUC 0.933199942111969, avg_entr 0.019765829667448997, f1 0.8686000108718872
ep26_l2_test_time 1.6340958709997722
Test Epoch26 layer3 Acc 0.869, AUC 0.9328733682632446, avg_entr 0.019063690677285194, f1 0.8690000176429749
ep26_l3_test_time 2.246076315999744
Test Epoch26 layer4 Acc 0.868, AUC 0.9339388608932495, avg_entr 0.01912873238325119, f1 0.8679999709129333
ep26_l4_test_time 2.8450979680001183
gc 0
Train Epoch27 Acc 0.97605 (39042/40000), AUC 0.9965177178382874
ep27_train_time 78.86150335000002
Test Epoch27 layer0 Acc 0.8818, AUC 0.9457486867904663, avg_entr 0.11484049260616302, f1 0.8818000555038452
ep27_l0_test_time 0.5626476449997426
Test Epoch27 layer1 Acc 0.8684, AUC 0.9331444501876831, avg_entr 0.025532489642500877, f1 0.868399977684021
ep27_l1_test_time 1.040716970000176
Test Epoch27 layer2 Acc 0.8692, AUC 0.933197557926178, avg_entr 0.019830549135804176, f1 0.8691999912261963
ep27_l2_test_time 1.652251533999788
Test Epoch27 layer3 Acc 0.869, AUC 0.9331709146499634, avg_entr 0.019038930535316467, f1 0.8690000176429749
ep27_l3_test_time 2.26029182100001
Test Epoch27 layer4 Acc 0.8678, AUC 0.9339437484741211, avg_entr 0.019278353080153465, f1 0.8677999973297119
ep27_l4_test_time 2.864366839000013
gc 0
Train Epoch28 Acc 0.975725 (39029/40000), AUC 0.9965840578079224
ep28_train_time 78.80369543300003
Test Epoch28 layer0 Acc 0.882, AUC 0.945682168006897, avg_entr 0.11434919387102127, f1 0.8820000290870667
ep28_l0_test_time 0.5489146459999574
Test Epoch28 layer1 Acc 0.8678, AUC 0.9334596395492554, avg_entr 0.025382235646247864, f1 0.8677999973297119
ep28_l1_test_time 1.0408008069998687
Test Epoch28 layer2 Acc 0.8692, AUC 0.9333939552307129, avg_entr 0.01966738887131214, f1 0.8691999912261963
ep28_l2_test_time 1.650097919000018
Test Epoch28 layer3 Acc 0.8686, AUC 0.9332782030105591, avg_entr 0.01887792907655239, f1 0.8686000108718872
ep28_l3_test_time 2.2629948900003
Test Epoch28 layer4 Acc 0.8678, AUC 0.9340903759002686, avg_entr 0.019104735925793648, f1 0.8677999973297119
ep28_l4_test_time 2.873493776000032
gc 0
Train Epoch29 Acc 0.9762 (39048/40000), AUC 0.9965431094169617
ep29_train_time 78.89787815099999
Test Epoch29 layer0 Acc 0.8814, AUC 0.9456479549407959, avg_entr 0.11393623054027557, f1 0.8813999891281128
ep29_l0_test_time 0.5526969969996571
Test Epoch29 layer1 Acc 0.8678, AUC 0.9335627555847168, avg_entr 0.02531011588871479, f1 0.8677999973297119
ep29_l1_test_time 1.0358902389998548
Test Epoch29 layer2 Acc 0.869, AUC 0.933464527130127, avg_entr 0.019489891827106476, f1 0.8690000176429749
ep29_l2_test_time 1.637780136999936
Test Epoch29 layer3 Acc 0.869, AUC 0.9333112239837646, avg_entr 0.018527314066886902, f1 0.8690000176429749
ep29_l3_test_time 2.254143802999806
Test Epoch29 layer4 Acc 0.8678, AUC 0.9341839551925659, avg_entr 0.018876967951655388, f1 0.8677999973297119
ep29_l4_test_time 2.8547802120001506
Best AUC tensor(0.8994) 4 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 2781.7477441869996
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.8962, AUC 0.9558935761451721, avg_entr 0.1815718710422516, f1 0.8962000012397766
l0_test_time 0.546799842999917
Test layer1 Acc 0.8876, AUC 0.943204402923584, avg_entr 0.05966096371412277, f1 0.8876000046730042
l1_test_time 1.0389511760004098
Test layer2 Acc 0.8862, AUC 0.9448120594024658, avg_entr 0.05129929259419441, f1 0.8862000107765198
l2_test_time 1.6390502790000028
Test layer3 Acc 0.8848, AUC 0.9451206922531128, avg_entr 0.04927409440279007, f1 0.8848000168800354
l3_test_time 2.2450822730002074
Test layer4 Acc 0.8848, AUC 0.9445680379867554, avg_entr 0.04761737585067749, f1 0.8848000168800354
l4_test_time 2.8531677070000114
