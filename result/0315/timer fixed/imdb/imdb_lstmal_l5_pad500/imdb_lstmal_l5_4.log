total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.271539721
Start Training
gc 0
Train Epoch0 Acc 0.510175 (20407/40000), AUC 0.5132460594177246
ep0_train_time 78.58702189300001
Test Epoch0 layer0 Acc 0.7546, AUC 0.8814345002174377, avg_entr 0.5660678744316101, f1 0.7546000480651855
ep0_l0_test_time 0.559081128999992
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6072, AUC 0.6500982046127319, avg_entr 0.6626726388931274, f1 0.607200026512146
ep0_l1_test_time 1.0509288110000057
Test Epoch0 layer2 Acc 0.6106, AUC 0.6710488200187683, avg_entr 0.669781506061554, f1 0.6105999946594238
ep0_l2_test_time 1.6623753009999973
Test Epoch0 layer3 Acc 0.5258, AUC 0.6805919408798218, avg_entr 0.6382827758789062, f1 0.5257999897003174
ep0_l3_test_time 2.273767019999994
Test Epoch0 layer4 Acc 0.5288, AUC 0.6778031587600708, avg_entr 0.6888598203659058, f1 0.5288000106811523
ep0_l4_test_time 2.90573212999999
gc 0
Train Epoch1 Acc 0.792075 (31683/40000), AUC 0.8581849932670593
ep1_train_time 79.118692829
Test Epoch1 layer0 Acc 0.8802, AUC 0.9444150328636169, avg_entr 0.29286178946495056, f1 0.8802000284194946
ep1_l0_test_time 0.579945672000008
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8604, AUC 0.9170605540275574, avg_entr 0.09651631116867065, f1 0.8604000210762024
ep1_l1_test_time 1.0637692869999853
Test Epoch1 layer2 Acc 0.8628, AUC 0.9188877940177917, avg_entr 0.09238560497760773, f1 0.8628000020980835
ep1_l2_test_time 1.6538926730000014
Test Epoch1 layer3 Acc 0.8628, AUC 0.918974757194519, avg_entr 0.1028544157743454, f1 0.8628000020980835
ep1_l3_test_time 2.267569936000001
Test Epoch1 layer4 Acc 0.8634, AUC 0.9201620817184448, avg_entr 0.08468346297740936, f1 0.8634000420570374
ep1_l4_test_time 2.8817383559999996
gc 0
Train Epoch2 Acc 0.889625 (35585/40000), AUC 0.9401106238365173
ep2_train_time 79.08968712400002
Test Epoch2 layer0 Acc 0.895, AUC 0.9550113081932068, avg_entr 0.2301146239042282, f1 0.8949999809265137
ep2_l0_test_time 0.5767258829999946
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.869, AUC 0.9394899606704712, avg_entr 0.07656733691692352, f1 0.8690000176429749
ep2_l1_test_time 1.059669829000029
Test Epoch2 layer2 Acc 0.8716, AUC 0.9407115578651428, avg_entr 0.06371849030256271, f1 0.8715999722480774
ep2_l2_test_time 1.6628290010000342
Test Epoch2 layer3 Acc 0.866, AUC 0.9400926828384399, avg_entr 0.07276013493537903, f1 0.8659999966621399
ep2_l3_test_time 2.2714035660000036
Test Epoch2 layer4 Acc 0.8704, AUC 0.9407602548599243, avg_entr 0.0566718690097332, f1 0.8704000115394592
ep2_l4_test_time 2.88864431799999
gc 0
Train Epoch3 Acc 0.915075 (36603/40000), AUC 0.9593102931976318
ep3_train_time 79.05359122499999
Test Epoch3 layer0 Acc 0.897, AUC 0.9582619667053223, avg_entr 0.20064575970172882, f1 0.8970000147819519
ep3_l0_test_time 0.5650603149999824
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.884, AUC 0.9458533525466919, avg_entr 0.06346146762371063, f1 0.8840000033378601
ep3_l1_test_time 1.0711237579999988
Test Epoch3 layer2 Acc 0.8852, AUC 0.9475408792495728, avg_entr 0.05328168347477913, f1 0.8852000832557678
ep3_l2_test_time 1.6650009250000153
Test Epoch3 layer3 Acc 0.884, AUC 0.9476462006568909, avg_entr 0.053925927728414536, f1 0.8840000033378601
ep3_l3_test_time 2.2703286220000223
Test Epoch3 layer4 Acc 0.8856, AUC 0.9476668238639832, avg_entr 0.047947127372026443, f1 0.8855999708175659
ep3_l4_test_time 2.9049389879999694
gc 0
Train Epoch4 Acc 0.932825 (37313/40000), AUC 0.975387454032898
ep4_train_time 79.06380921499999
Test Epoch4 layer0 Acc 0.8958, AUC 0.9590374231338501, avg_entr 0.17677177488803864, f1 0.895799994468689
ep4_l0_test_time 0.5576761590000388
Test Epoch4 layer1 Acc 0.8868, AUC 0.951374351978302, avg_entr 0.07117322087287903, f1 0.8867999911308289
ep4_l1_test_time 1.0496166220000305
Test Epoch4 layer2 Acc 0.8868, AUC 0.9523798823356628, avg_entr 0.06436536461114883, f1 0.8867999911308289
ep4_l2_test_time 1.6553895460000376
Test Epoch4 layer3 Acc 0.8804, AUC 0.9523286819458008, avg_entr 0.06942182779312134, f1 0.8804000020027161
ep4_l3_test_time 2.263781193
Test Epoch4 layer4 Acc 0.8854, AUC 0.9521385431289673, avg_entr 0.05929979309439659, f1 0.8853999972343445
ep4_l4_test_time 2.8863202439999895
gc 0
Train Epoch5 Acc 0.918125 (36725/40000), AUC 0.9656579494476318
ep5_train_time 79.09056362199999
Test Epoch5 layer0 Acc 0.8764, AUC 0.9587053060531616, avg_entr 0.16265635192394257, f1 0.8763999938964844
ep5_l0_test_time 0.560025286000041
Test Epoch5 layer1 Acc 0.8718, AUC 0.9274671077728271, avg_entr 0.055451273918151855, f1 0.8718000650405884
ep5_l1_test_time 1.048588291000101
Test Epoch5 layer2 Acc 0.874, AUC 0.9324419498443604, avg_entr 0.04289558157324791, f1 0.8740000128746033
ep5_l2_test_time 1.6613047700000152
Test Epoch5 layer3 Acc 0.8728, AUC 0.9318780899047852, avg_entr 0.04794633015990257, f1 0.8727999925613403
ep5_l3_test_time 2.28418715600003
Test Epoch5 layer4 Acc 0.8726, AUC 0.9326236248016357, avg_entr 0.03372327983379364, f1 0.8726000189781189
ep5_l4_test_time 2.909286020999957
gc 0
Train Epoch6 Acc 0.9385 (37540/40000), AUC 0.9794679880142212
ep6_train_time 79.08057575499993
Test Epoch6 layer0 Acc 0.8982, AUC 0.9578084945678711, avg_entr 0.15636120736598969, f1 0.8981999754905701
ep6_l0_test_time 0.5553204999999934
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 6
Test Epoch6 layer1 Acc 0.8872, AUC 0.9435073137283325, avg_entr 0.04997478798031807, f1 0.8871999979019165
ep6_l1_test_time 1.0545738690000235
Test Epoch6 layer2 Acc 0.8882, AUC 0.9466347694396973, avg_entr 0.040895674377679825, f1 0.888200044631958
ep6_l2_test_time 1.654590575000043
Test Epoch6 layer3 Acc 0.8828, AUC 0.9463076591491699, avg_entr 0.04004440829157829, f1 0.8827999830245972
ep6_l3_test_time 2.2650674449999997
Test Epoch6 layer4 Acc 0.8878, AUC 0.9465258717536926, avg_entr 0.03417855128645897, f1 0.8877999782562256
ep6_l4_test_time 2.882925618999934
gc 0
Train Epoch7 Acc 0.950275 (38011/40000), AUC 0.9850032329559326
ep7_train_time 79.01603237500001
Test Epoch7 layer0 Acc 0.8786, AUC 0.955879271030426, avg_entr 0.144439697265625, f1 0.878600001335144
ep7_l0_test_time 0.5586691510000037
Test Epoch7 layer1 Acc 0.8846, AUC 0.9414628744125366, avg_entr 0.04313149303197861, f1 0.8845999836921692
ep7_l1_test_time 1.0630181720000564
Test Epoch7 layer2 Acc 0.887, AUC 0.9452438354492188, avg_entr 0.034934721887111664, f1 0.8870000243186951
ep7_l2_test_time 1.6670909560000382
Test Epoch7 layer3 Acc 0.8844, AUC 0.9446483850479126, avg_entr 0.035845398902893066, f1 0.8844000101089478
ep7_l3_test_time 2.268976651999992
Test Epoch7 layer4 Acc 0.8862, AUC 0.9450138807296753, avg_entr 0.029785986989736557, f1 0.8862000107765198
ep7_l4_test_time 2.8922930090000136
gc 0
Train Epoch8 Acc 0.956525 (38261/40000), AUC 0.9886293411254883
ep8_train_time 78.95582112399995
Test Epoch8 layer0 Acc 0.8872, AUC 0.9545997977256775, avg_entr 0.1373995542526245, f1 0.8871999979019165
ep8_l0_test_time 0.5637717129999373
Test Epoch8 layer1 Acc 0.8828, AUC 0.9380072951316833, avg_entr 0.03401186689734459, f1 0.8827999830245972
ep8_l1_test_time 1.0550140729999384
Test Epoch8 layer2 Acc 0.882, AUC 0.9405839443206787, avg_entr 0.026274634525179863, f1 0.8820000290870667
ep8_l2_test_time 1.6636626909998995
Test Epoch8 layer3 Acc 0.8818, AUC 0.9396243095397949, avg_entr 0.027326183393597603, f1 0.8818000555038452
ep8_l3_test_time 2.269179869000027
Test Epoch8 layer4 Acc 0.8808, AUC 0.9407392144203186, avg_entr 0.024100881069898605, f1 0.8808000087738037
ep8_l4_test_time 2.879342943000097
gc 0
Train Epoch9 Acc 0.96135 (38454/40000), AUC 0.9914723634719849
ep9_train_time 78.93523520399992
Test Epoch9 layer0 Acc 0.8926, AUC 0.9536335468292236, avg_entr 0.13600963354110718, f1 0.8925999999046326
ep9_l0_test_time 0.5567662600000176
Test Epoch9 layer1 Acc 0.8792, AUC 0.94090735912323, avg_entr 0.0420323982834816, f1 0.8791999816894531
ep9_l1_test_time 1.0484297650000372
Test Epoch9 layer2 Acc 0.878, AUC 0.943171501159668, avg_entr 0.030960991978645325, f1 0.878000020980835
ep9_l2_test_time 1.652564591999976
Test Epoch9 layer3 Acc 0.877, AUC 0.9425796270370483, avg_entr 0.030721161514520645, f1 0.8769999742507935
ep9_l3_test_time 2.2607178389999945
Test Epoch9 layer4 Acc 0.8778, AUC 0.9430325031280518, avg_entr 0.027573009952902794, f1 0.8778000473976135
ep9_l4_test_time 2.865261632000056
gc 0
Train Epoch10 Acc 0.9639 (38556/40000), AUC 0.9923487901687622
ep10_train_time 78.91451146199995
Test Epoch10 layer0 Acc 0.886, AUC 0.9525312781333923, avg_entr 0.13132460415363312, f1 0.8859999775886536
ep10_l0_test_time 0.5545247229999859
Test Epoch10 layer1 Acc 0.8782, AUC 0.9392127990722656, avg_entr 0.03703648969531059, f1 0.8781999945640564
ep10_l1_test_time 1.0476747669999895
Test Epoch10 layer2 Acc 0.8774, AUC 0.9425778985023499, avg_entr 0.027902521193027496, f1 0.8773999810218811
ep10_l2_test_time 1.6593365490000451
Test Epoch10 layer3 Acc 0.878, AUC 0.9418395161628723, avg_entr 0.030774466693401337, f1 0.878000020980835
ep10_l3_test_time 2.2725771570000006
Test Epoch10 layer4 Acc 0.8782, AUC 0.9426072835922241, avg_entr 0.02570176310837269, f1 0.8781999945640564
ep10_l4_test_time 2.8945498189999626
gc 0
Train Epoch11 Acc 0.96525 (38610/40000), AUC 0.9929088354110718
ep11_train_time 78.90706619799994
Test Epoch11 layer0 Acc 0.889, AUC 0.9512174725532532, avg_entr 0.13052959740161896, f1 0.8889999985694885
ep11_l0_test_time 0.5545944140001211
Test Epoch11 layer1 Acc 0.8782, AUC 0.9387249946594238, avg_entr 0.03686352074146271, f1 0.8781999945640564
ep11_l1_test_time 1.0470727710001029
Test Epoch11 layer2 Acc 0.8774, AUC 0.9408990144729614, avg_entr 0.02775760181248188, f1 0.8773999810218811
ep11_l2_test_time 1.6518217739999272
Test Epoch11 layer3 Acc 0.8764, AUC 0.9400011301040649, avg_entr 0.027858611196279526, f1 0.8763999938964844
ep11_l3_test_time 2.2552201839998816
Test Epoch11 layer4 Acc 0.8772, AUC 0.9408314228057861, avg_entr 0.02621733769774437, f1 0.8772000074386597
ep11_l4_test_time 2.8669657149998784
gc 0
Train Epoch12 Acc 0.967225 (38689/40000), AUC 0.9937633872032166
ep12_train_time 78.952719721
Test Epoch12 layer0 Acc 0.8858, AUC 0.9503303170204163, avg_entr 0.12628069519996643, f1 0.8858000040054321
ep12_l0_test_time 0.5613691450000715
Test Epoch12 layer1 Acc 0.876, AUC 0.9379074573516846, avg_entr 0.033932264894247055, f1 0.8760000467300415
ep12_l1_test_time 1.0695863850000933
Test Epoch12 layer2 Acc 0.8758, AUC 0.9402472972869873, avg_entr 0.025968478992581367, f1 0.8758000135421753
ep12_l2_test_time 1.6679833580001286
Test Epoch12 layer3 Acc 0.8738, AUC 0.939206600189209, avg_entr 0.026598168537020683, f1 0.8737999796867371
ep12_l3_test_time 2.266015798999888
Test Epoch12 layer4 Acc 0.8748, AUC 0.9402768611907959, avg_entr 0.023830806836485863, f1 0.8748000264167786
ep12_l4_test_time 2.8786664589999873
gc 0
Train Epoch13 Acc 0.969525 (38781/40000), AUC 0.9946320652961731
ep13_train_time 78.98496250000017
Test Epoch13 layer0 Acc 0.8874, AUC 0.9497494697570801, avg_entr 0.12521210312843323, f1 0.8873999714851379
ep13_l0_test_time 0.5565908940000099
Test Epoch13 layer1 Acc 0.8736, AUC 0.9378857612609863, avg_entr 0.03408924862742424, f1 0.8736000061035156
ep13_l1_test_time 1.0595083999999133
Test Epoch13 layer2 Acc 0.8754, AUC 0.9401125311851501, avg_entr 0.024543164297938347, f1 0.8754000067710876
ep13_l2_test_time 1.674683739000102
Test Epoch13 layer3 Acc 0.8746, AUC 0.9389362335205078, avg_entr 0.025189904496073723, f1 0.8745999932289124
ep13_l3_test_time 2.2684769570000753
Test Epoch13 layer4 Acc 0.8754, AUC 0.940131425857544, avg_entr 0.022080985829234123, f1 0.8754000067710876
ep13_l4_test_time 2.8906707459998415
gc 0
Train Epoch14 Acc 0.970625 (38825/40000), AUC 0.9947779178619385
ep14_train_time 79.02759558499997
Test Epoch14 layer0 Acc 0.888, AUC 0.94911789894104, avg_entr 0.12486116588115692, f1 0.8880000114440918
ep14_l0_test_time 0.5558723399999508
Test Epoch14 layer1 Acc 0.8692, AUC 0.935308575630188, avg_entr 0.0311810951679945, f1 0.8691999912261963
ep14_l1_test_time 1.0541107840001587
Test Epoch14 layer2 Acc 0.8702, AUC 0.9382764101028442, avg_entr 0.023607628419995308, f1 0.870199978351593
ep14_l2_test_time 1.661350615999936
Test Epoch14 layer3 Acc 0.8708, AUC 0.9373739957809448, avg_entr 0.025390734896063805, f1 0.8708000183105469
ep14_l3_test_time 2.265602374999844
Test Epoch14 layer4 Acc 0.8706, AUC 0.9385272860527039, avg_entr 0.022252269089221954, f1 0.8705999851226807
ep14_l4_test_time 2.8712917650000236
gc 0
Train Epoch15 Acc 0.971075 (38843/40000), AUC 0.9949666261672974
ep15_train_time 79.11359661100005
Test Epoch15 layer0 Acc 0.8848, AUC 0.9485008716583252, avg_entr 0.12392468005418777, f1 0.8848000168800354
ep15_l0_test_time 0.5576297070001601
Test Epoch15 layer1 Acc 0.8738, AUC 0.9364850521087646, avg_entr 0.031100787222385406, f1 0.8737999796867371
ep15_l1_test_time 1.0542681060001087
Test Epoch15 layer2 Acc 0.8752, AUC 0.939146876335144, avg_entr 0.02326025627553463, f1 0.8751999735832214
ep15_l2_test_time 1.6623762840001746
Test Epoch15 layer3 Acc 0.8722, AUC 0.9379098415374756, avg_entr 0.024511247873306274, f1 0.872200071811676
ep15_l3_test_time 2.273828526999978
Test Epoch15 layer4 Acc 0.874, AUC 0.9392766952514648, avg_entr 0.021766604855656624, f1 0.8740000128746033
ep15_l4_test_time 2.9050411300001997
gc 0
Train Epoch16 Acc 0.972375 (38895/40000), AUC 0.9953732490539551
ep16_train_time 79.01854877400001
Test Epoch16 layer0 Acc 0.8844, AUC 0.9479908347129822, avg_entr 0.12286921590566635, f1 0.8844000101089478
ep16_l0_test_time 0.5539556439998705
Test Epoch16 layer1 Acc 0.874, AUC 0.9368078708648682, avg_entr 0.02994246780872345, f1 0.8740000128746033
ep16_l1_test_time 1.0543848289999005
Test Epoch16 layer2 Acc 0.873, AUC 0.9385358095169067, avg_entr 0.021682748571038246, f1 0.8730000257492065
ep16_l2_test_time 1.6534913929999675
Test Epoch16 layer3 Acc 0.8728, AUC 0.9373239278793335, avg_entr 0.022684434428811073, f1 0.8727999925613403
ep16_l3_test_time 2.2578512729999147
Test Epoch16 layer4 Acc 0.873, AUC 0.9387818574905396, avg_entr 0.020381268113851547, f1 0.8730000257492065
ep16_l4_test_time 2.867099552000127
gc 0
Train Epoch17 Acc 0.972975 (38919/40000), AUC 0.9957219362258911
ep17_train_time 79.1354918510001
Test Epoch17 layer0 Acc 0.8846, AUC 0.9476554989814758, avg_entr 0.12099521607160568, f1 0.8845999836921692
ep17_l0_test_time 0.5539708769999834
Test Epoch17 layer1 Acc 0.874, AUC 0.9354501962661743, avg_entr 0.02890428528189659, f1 0.8740000128746033
ep17_l1_test_time 1.0655970360000993
Test Epoch17 layer2 Acc 0.8748, AUC 0.9377474784851074, avg_entr 0.021049482747912407, f1 0.8748000264167786
ep17_l2_test_time 1.6673735720000877
Test Epoch17 layer3 Acc 0.873, AUC 0.9361798763275146, avg_entr 0.022493280470371246, f1 0.8730000257492065
ep17_l3_test_time 2.2622457329998724
Test Epoch17 layer4 Acc 0.8744, AUC 0.9379688501358032, avg_entr 0.019692065194249153, f1 0.8744000792503357
ep17_l4_test_time 2.8788582619999943
gc 0
Train Epoch18 Acc 0.973375 (38935/40000), AUC 0.9956342577934265
ep18_train_time 79.04022826100004
Test Epoch18 layer0 Acc 0.8836, AUC 0.9473894834518433, avg_entr 0.12038622051477432, f1 0.8835999965667725
ep18_l0_test_time 0.5572720990001017
Test Epoch18 layer1 Acc 0.8744, AUC 0.935003399848938, avg_entr 0.028402872383594513, f1 0.8744000792503357
ep18_l1_test_time 1.056342543000028
Test Epoch18 layer2 Acc 0.874, AUC 0.9370184540748596, avg_entr 0.02142811007797718, f1 0.8740000128746033
ep18_l2_test_time 1.6650350820000313
Test Epoch18 layer3 Acc 0.8718, AUC 0.9353392124176025, avg_entr 0.022883756086230278, f1 0.8718000650405884
ep18_l3_test_time 2.2714349259999835
Test Epoch18 layer4 Acc 0.874, AUC 0.9373267889022827, avg_entr 0.020274287089705467, f1 0.8740000128746033
ep18_l4_test_time 2.8832394260000456
gc 0
Train Epoch19 Acc 0.974275 (38971/40000), AUC 0.9958623647689819
ep19_train_time 79.02917836200004
Test Epoch19 layer0 Acc 0.8846, AUC 0.9470609426498413, avg_entr 0.11880426108837128, f1 0.8845999836921692
ep19_l0_test_time 0.6068813219999356
Test Epoch19 layer1 Acc 0.8722, AUC 0.9334585666656494, avg_entr 0.026209255680441856, f1 0.872200071811676
ep19_l1_test_time 1.0523867229999269
Test Epoch19 layer2 Acc 0.8728, AUC 0.9353501796722412, avg_entr 0.01895223557949066, f1 0.8727999925613403
ep19_l2_test_time 1.6581719440000597
Test Epoch19 layer3 Acc 0.8736, AUC 0.9335165023803711, avg_entr 0.020054517313838005, f1 0.8736000061035156
ep19_l3_test_time 2.2600934649999544
Test Epoch19 layer4 Acc 0.8724, AUC 0.9358364343643188, avg_entr 0.01798134855926037, f1 0.8723999857902527
ep19_l4_test_time 2.8695441969998683
gc 0
Train Epoch20 Acc 0.9742 (38968/40000), AUC 0.9959843754768372
ep20_train_time 78.99110496000003
Test Epoch20 layer0 Acc 0.8844, AUC 0.9467607736587524, avg_entr 0.1174481213092804, f1 0.8844000101089478
ep20_l0_test_time 0.5561512769997989
Test Epoch20 layer1 Acc 0.8704, AUC 0.9335777759552002, avg_entr 0.025620263069868088, f1 0.8704000115394592
ep20_l1_test_time 1.052703269000176
Test Epoch20 layer2 Acc 0.8688, AUC 0.9353036284446716, avg_entr 0.018641123548150063, f1 0.8687999844551086
ep20_l2_test_time 1.658423325000058
Test Epoch20 layer3 Acc 0.8704, AUC 0.933828592300415, avg_entr 0.01833578757941723, f1 0.8704000115394592
ep20_l3_test_time 2.274024122000128
Test Epoch20 layer4 Acc 0.869, AUC 0.9359359741210938, avg_entr 0.017878444865345955, f1 0.8690000176429749
ep20_l4_test_time 2.8951521579999735
gc 0
Train Epoch21 Acc 0.975 (39000/40000), AUC 0.9961248636245728
ep21_train_time 79.00986097999998
Test Epoch21 layer0 Acc 0.8838, AUC 0.9466050863265991, avg_entr 0.11704026162624359, f1 0.8838000297546387
ep21_l0_test_time 0.5625523370001702
Test Epoch21 layer1 Acc 0.8724, AUC 0.9337304830551147, avg_entr 0.025315655395388603, f1 0.8723999857902527
ep21_l1_test_time 1.0549872789999881
Test Epoch21 layer2 Acc 0.8724, AUC 0.9358645677566528, avg_entr 0.01787879317998886, f1 0.8723999857902527
ep21_l2_test_time 1.6519004639999366
Test Epoch21 layer3 Acc 0.8722, AUC 0.9341732859611511, avg_entr 0.019022250548005104, f1 0.872200071811676
ep21_l3_test_time 2.257749037000167
Test Epoch21 layer4 Acc 0.8728, AUC 0.9363294839859009, avg_entr 0.016766943037509918, f1 0.8727999925613403
ep21_l4_test_time 2.8675585910000336
gc 0
Train Epoch22 Acc 0.9752 (39008/40000), AUC 0.9961370229721069
ep22_train_time 79.01816216099996
Test Epoch22 layer0 Acc 0.8828, AUC 0.9464800357818604, avg_entr 0.1180734634399414, f1 0.8827999830245972
ep22_l0_test_time 0.5587943369998811
Test Epoch22 layer1 Acc 0.8712, AUC 0.9347665309906006, avg_entr 0.027072470635175705, f1 0.8712000846862793
ep22_l1_test_time 1.0677998050000497
Test Epoch22 layer2 Acc 0.8712, AUC 0.9369785785675049, avg_entr 0.019100265577435493, f1 0.8712000846862793
ep22_l2_test_time 1.6723563989999093
Test Epoch22 layer3 Acc 0.871, AUC 0.9354345202445984, avg_entr 0.020202700048685074, f1 0.8709999918937683
ep22_l3_test_time 2.2654119799999535
Test Epoch22 layer4 Acc 0.8718, AUC 0.9372543096542358, avg_entr 0.017951954156160355, f1 0.8718000650405884
ep22_l4_test_time 2.8839951469999505
gc 0
Train Epoch23 Acc 0.975275 (39011/40000), AUC 0.9962574243545532
ep23_train_time 79.01214568700016
Test Epoch23 layer0 Acc 0.883, AUC 0.9463400840759277, avg_entr 0.11634650826454163, f1 0.8830000162124634
ep23_l0_test_time 0.5744723510001677
Test Epoch23 layer1 Acc 0.8724, AUC 0.9341520071029663, avg_entr 0.025441156700253487, f1 0.8723999857902527
ep23_l1_test_time 1.0562692260000404
Test Epoch23 layer2 Acc 0.8722, AUC 0.936240553855896, avg_entr 0.017704296857118607, f1 0.872200071811676
ep23_l2_test_time 1.6760750250000456
Test Epoch23 layer3 Acc 0.8714, AUC 0.9345893263816833, avg_entr 0.018472032621502876, f1 0.871399998664856
ep23_l3_test_time 2.2811152579997724
Test Epoch23 layer4 Acc 0.8716, AUC 0.9366751909255981, avg_entr 0.016589364036917686, f1 0.8715999722480774
ep23_l4_test_time 2.8846186719997604
gc 0
Train Epoch24 Acc 0.9757 (39028/40000), AUC 0.9963524341583252
ep24_train_time 79.11828886100011
Test Epoch24 layer0 Acc 0.8836, AUC 0.9462143182754517, avg_entr 0.11557763814926147, f1 0.8835999965667725
ep24_l0_test_time 0.5637510500000644
Test Epoch24 layer1 Acc 0.8688, AUC 0.9339666366577148, avg_entr 0.02648257464170456, f1 0.8687999844551086
ep24_l1_test_time 1.0607242510000106
Test Epoch24 layer2 Acc 0.8688, AUC 0.9359786510467529, avg_entr 0.018978683277964592, f1 0.8687999844551086
ep24_l2_test_time 1.6570881849997932
Test Epoch24 layer3 Acc 0.871, AUC 0.9346480369567871, avg_entr 0.018605059012770653, f1 0.8709999918937683
ep24_l3_test_time 2.266298081000059
Test Epoch24 layer4 Acc 0.8684, AUC 0.9365469217300415, avg_entr 0.017866332083940506, f1 0.868399977684021
ep24_l4_test_time 2.8698128430000907
gc 0
Train Epoch25 Acc 0.976 (39040/40000), AUC 0.9963743686676025
ep25_train_time 79.01821324799994
Test Epoch25 layer0 Acc 0.8828, AUC 0.9461580514907837, avg_entr 0.11558060348033905, f1 0.8827999830245972
ep25_l0_test_time 0.5572059409996655
Test Epoch25 layer1 Acc 0.8702, AUC 0.933459997177124, avg_entr 0.024499325081706047, f1 0.870199978351593
ep25_l1_test_time 1.0514328669996758
Test Epoch25 layer2 Acc 0.8708, AUC 0.9354767799377441, avg_entr 0.017336007207632065, f1 0.8708000183105469
ep25_l2_test_time 1.6613228999999592
Test Epoch25 layer3 Acc 0.8716, AUC 0.9338487386703491, avg_entr 0.0174968671053648, f1 0.8715999722480774
ep25_l3_test_time 2.27459934000035
Test Epoch25 layer4 Acc 0.8706, AUC 0.9360971450805664, avg_entr 0.016252955421805382, f1 0.8705999851226807
ep25_l4_test_time 2.894234598999901
gc 0
Train Epoch26 Acc 0.975825 (39033/40000), AUC 0.9963929653167725
ep26_train_time 79.09327296899983
Test Epoch26 layer0 Acc 0.883, AUC 0.9460612535476685, avg_entr 0.11482720822095871, f1 0.8830000162124634
ep26_l0_test_time 0.5582305779998933
Test Epoch26 layer1 Acc 0.8702, AUC 0.9336316585540771, avg_entr 0.02482503652572632, f1 0.870199978351593
ep26_l1_test_time 1.0548791690002872
Test Epoch26 layer2 Acc 0.8706, AUC 0.9358740448951721, avg_entr 0.017758499830961227, f1 0.8705999851226807
ep26_l2_test_time 1.657457990000239
Test Epoch26 layer3 Acc 0.8716, AUC 0.934259295463562, avg_entr 0.017741316929459572, f1 0.8715999722480774
ep26_l3_test_time 2.259343666999939
Test Epoch26 layer4 Acc 0.8702, AUC 0.9363721609115601, avg_entr 0.016664840281009674, f1 0.870199978351593
ep26_l4_test_time 2.8683848149998994
gc 0
Train Epoch27 Acc 0.976025 (39041/40000), AUC 0.996477484703064
ep27_train_time 79.077428263
Test Epoch27 layer0 Acc 0.883, AUC 0.9459978938102722, avg_entr 0.11431369930505753, f1 0.8830000162124634
ep27_l0_test_time 0.5606621779998022
Test Epoch27 layer1 Acc 0.8692, AUC 0.9334457516670227, avg_entr 0.024658359587192535, f1 0.8691999912261963
ep27_l1_test_time 1.0593855289998828
Test Epoch27 layer2 Acc 0.871, AUC 0.9356541633605957, avg_entr 0.017649436369538307, f1 0.8709999918937683
ep27_l2_test_time 1.6654771799999253
Test Epoch27 layer3 Acc 0.8716, AUC 0.9340422749519348, avg_entr 0.01750035211443901, f1 0.8715999722480774
ep27_l3_test_time 2.2696113780002634
Test Epoch27 layer4 Acc 0.8704, AUC 0.9361957311630249, avg_entr 0.016616567969322205, f1 0.8704000115394592
ep27_l4_test_time 2.8792743740000333
gc 0
Train Epoch28 Acc 0.97585 (39034/40000), AUC 0.9964524507522583
ep28_train_time 79.033462289
Test Epoch28 layer0 Acc 0.8824, AUC 0.9459477066993713, avg_entr 0.11409122496843338, f1 0.8823999762535095
ep28_l0_test_time 0.5554380199996558
Test Epoch28 layer1 Acc 0.8716, AUC 0.9336206912994385, avg_entr 0.023407673463225365, f1 0.8715999722480774
ep28_l1_test_time 1.0601331469997604
Test Epoch28 layer2 Acc 0.8714, AUC 0.9357503056526184, avg_entr 0.01663370430469513, f1 0.871399998664856
ep28_l2_test_time 1.666144624000026
Test Epoch28 layer3 Acc 0.8708, AUC 0.9339802861213684, avg_entr 0.018256433308124542, f1 0.8708000183105469
ep28_l3_test_time 2.2717593590000433
Test Epoch28 layer4 Acc 0.8706, AUC 0.9362627267837524, avg_entr 0.015541981905698776, f1 0.8705999851226807
ep28_l4_test_time 2.8845273069996438
gc 0
Train Epoch29 Acc 0.9765 (39060/40000), AUC 0.9964779615402222
ep29_train_time 79.06080981200012
Test Epoch29 layer0 Acc 0.8838, AUC 0.9458942413330078, avg_entr 0.11342117935419083, f1 0.8838000297546387
ep29_l0_test_time 0.5616185129997575
Test Epoch29 layer1 Acc 0.8716, AUC 0.9329701662063599, avg_entr 0.022656718268990517, f1 0.8715999722480774
ep29_l1_test_time 1.0604761480003617
Test Epoch29 layer2 Acc 0.872, AUC 0.9351259469985962, avg_entr 0.016004793345928192, f1 0.871999979019165
ep29_l2_test_time 1.6623784769999475
Test Epoch29 layer3 Acc 0.8706, AUC 0.9333256483078003, avg_entr 0.01713661290705204, f1 0.8705999851226807
ep29_l3_test_time 2.2730776739999783
Test Epoch29 layer4 Acc 0.8708, AUC 0.9357302188873291, avg_entr 0.014948711730539799, f1 0.8708000183105469
ep29_l4_test_time 2.873366684999837
Best AUC tensor(0.8982) 6 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 2625.089779087
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.889, AUC 0.95340895652771, avg_entr 0.15873239934444427, f1 0.8889999985694885
l0_test_time 0.554022199999963
Test layer1 Acc 0.8798, AUC 0.9397587776184082, avg_entr 0.05249874293804169, f1 0.879800021648407
l1_test_time 1.0531264490000467
Test layer2 Acc 0.8782, AUC 0.9422503113746643, avg_entr 0.043149471282958984, f1 0.8781999945640564
l2_test_time 1.6558218949999173
Test layer3 Acc 0.8736, AUC 0.9419891834259033, avg_entr 0.04142213240265846, f1 0.8736000061035156
l3_test_time 2.2599605230002453
Test layer4 Acc 0.8748, AUC 0.9418742060661316, avg_entr 0.036174193024635315, f1 0.8748000264167786
l4_test_time 2.8683863819996986
