total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.758342677
Start Training
gc 0
Train Epoch0 Acc 0.513575 (20543/40000), AUC 0.5233673453330994
ep0_train_time 78.876302046
Test Epoch0 layer0 Acc 0.8096, AUC 0.8898541927337646, avg_entr 0.5350683331489563, f1 0.8095999956130981
ep0_l0_test_time 0.5779765409999982
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6238, AUC 0.6617347598075867, avg_entr 0.6436496376991272, f1 0.6237999796867371
ep0_l1_test_time 1.0827552380000043
Test Epoch0 layer2 Acc 0.653, AUC 0.7055386900901794, avg_entr 0.6381471753120422, f1 0.652999997138977
ep0_l2_test_time 1.6974551260000084
Test Epoch0 layer3 Acc 0.6542, AUC 0.7321715354919434, avg_entr 0.6255186200141907, f1 0.65420001745224
ep0_l3_test_time 2.3134476480000075
Test Epoch0 layer4 Acc 0.6596, AUC 0.7441571950912476, avg_entr 0.67242431640625, f1 0.659600019454956
ep0_l4_test_time 2.930954763999992
gc 0
Train Epoch1 Acc 0.796525 (31861/40000), AUC 0.8668363094329834
ep1_train_time 79.10584504599998
Test Epoch1 layer0 Acc 0.8816, AUC 0.9469804763793945, avg_entr 0.28462478518486023, f1 0.881600022315979
ep1_l0_test_time 0.570330939999991
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.6478, AUC 0.736045241355896, avg_entr 0.6019034385681152, f1 0.6478000283241272
ep1_l1_test_time 1.0835939019999898
Test Epoch1 layer2 Acc 0.6874, AUC 0.7585145235061646, avg_entr 0.6268903613090515, f1 0.6873999834060669
ep1_l2_test_time 1.6844701330000191
Test Epoch1 layer3 Acc 0.6796, AUC 0.7645800709724426, avg_entr 0.6491939425468445, f1 0.6796000003814697
ep1_l3_test_time 2.2895494240000005
Test Epoch1 layer4 Acc 0.6942, AUC 0.7703487277030945, avg_entr 0.6764036417007446, f1 0.6941999793052673
ep1_l4_test_time 2.892676284999993
gc 0
Train Epoch2 Acc 0.8632 (34528/40000), AUC 0.9182692766189575
ep2_train_time 79.20318282100001
Test Epoch2 layer0 Acc 0.8932, AUC 0.9556654691696167, avg_entr 0.225385382771492, f1 0.8931999802589417
ep2_l0_test_time 0.5702458029999775
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8774, AUC 0.9293932914733887, avg_entr 0.05653909221291542, f1 0.8773999810218811
ep2_l1_test_time 1.0945696850000104
Test Epoch2 layer2 Acc 0.879, AUC 0.9313315153121948, avg_entr 0.045049890875816345, f1 0.8790000081062317
ep2_l2_test_time 1.6931164420000187
Test Epoch2 layer3 Acc 0.8782, AUC 0.932842493057251, avg_entr 0.04850045591592789, f1 0.8781999945640564
ep2_l3_test_time 2.2922817809999856
Test Epoch2 layer4 Acc 0.878, AUC 0.9333532452583313, avg_entr 0.05829528346657753, f1 0.878000020980835
ep2_l4_test_time 2.9008603730000004
gc 0
Train Epoch3 Acc 0.905 (36200/40000), AUC 0.9501985311508179
ep3_train_time 79.44361932999999
Test Epoch3 layer0 Acc 0.8942, AUC 0.958449125289917, avg_entr 0.20043379068374634, f1 0.8942000269889832
ep3_l0_test_time 0.569475366000006
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8774, AUC 0.9367153644561768, avg_entr 0.06082512065768242, f1 0.8773999810218811
ep3_l1_test_time 1.0845193739999672
Test Epoch3 layer2 Acc 0.8782, AUC 0.9419573545455933, avg_entr 0.05729956552386284, f1 0.8781999945640564
ep3_l2_test_time 1.6889589429999887
Test Epoch3 layer3 Acc 0.879, AUC 0.9427523612976074, avg_entr 0.054286498576402664, f1 0.8790000081062317
ep3_l3_test_time 2.2984230800000205
Test Epoch3 layer4 Acc 0.8796, AUC 0.9433571696281433, avg_entr 0.05322521924972534, f1 0.8795999884605408
ep3_l4_test_time 2.9187879520000024
gc 0
Train Epoch4 Acc 0.92575 (37030/40000), AUC 0.9698895812034607
ep4_train_time 79.374512982
Test Epoch4 layer0 Acc 0.8958, AUC 0.9586611390113831, avg_entr 0.1746368706226349, f1 0.895799994468689
ep4_l0_test_time 0.569382461000032
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8828, AUC 0.9410155415534973, avg_entr 0.04817299172282219, f1 0.8827999830245972
ep4_l1_test_time 1.08218442499998
Test Epoch4 layer2 Acc 0.8816, AUC 0.9440287947654724, avg_entr 0.042859893292188644, f1 0.881600022315979
ep4_l2_test_time 1.6931978860000072
Test Epoch4 layer3 Acc 0.882, AUC 0.9441671371459961, avg_entr 0.04268140345811844, f1 0.8820000290870667
ep4_l3_test_time 2.2942740009999625
Test Epoch4 layer4 Acc 0.8822, AUC 0.9443174600601196, avg_entr 0.044008854776620865, f1 0.8822000026702881
ep4_l4_test_time 2.9061913009999785
gc 0
Train Epoch5 Acc 0.935325 (37413/40000), AUC 0.9763898849487305
ep5_train_time 79.47444305800002
Test Epoch5 layer0 Acc 0.8906, AUC 0.958180844783783, avg_entr 0.1604994833469391, f1 0.8906000256538391
ep5_l0_test_time 0.5705345119999947
Test Epoch5 layer1 Acc 0.8862, AUC 0.9445914030075073, avg_entr 0.06111981347203255, f1 0.8862000107765198
ep5_l1_test_time 1.082794702000001
Test Epoch5 layer2 Acc 0.887, AUC 0.9473936557769775, avg_entr 0.056020405143499374, f1 0.8870000243186951
ep5_l2_test_time 1.698043574000053
Test Epoch5 layer3 Acc 0.887, AUC 0.9473756551742554, avg_entr 0.05422881990671158, f1 0.8870000243186951
ep5_l3_test_time 2.311924944999987
Test Epoch5 layer4 Acc 0.8872, AUC 0.9475235342979431, avg_entr 0.052714403718709946, f1 0.8871999979019165
ep5_l4_test_time 2.9408176450000383
gc 0
Train Epoch6 Acc 0.942175 (37687/40000), AUC 0.9809955358505249
ep6_train_time 79.48403930899997
Test Epoch6 layer0 Acc 0.8964, AUC 0.9568508267402649, avg_entr 0.15546534955501556, f1 0.896399974822998
ep6_l0_test_time 0.5725060440000789
Save ckpt to ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt  ,ep 6
Test Epoch6 layer1 Acc 0.839, AUC 0.9375278949737549, avg_entr 0.07833883911371231, f1 0.8389999866485596
ep6_l1_test_time 1.0900554419999935
Test Epoch6 layer2 Acc 0.8396, AUC 0.9398453235626221, avg_entr 0.06601200997829437, f1 0.8396000266075134
ep6_l2_test_time 1.6893627980000474
Test Epoch6 layer3 Acc 0.8442, AUC 0.9394994378089905, avg_entr 0.0638122409582138, f1 0.8442000150680542
ep6_l3_test_time 2.292217710999921
Test Epoch6 layer4 Acc 0.845, AUC 0.9386898279190063, avg_entr 0.06290420144796371, f1 0.8449999690055847
ep6_l4_test_time 2.900778821999893
gc 0
Train Epoch7 Acc 0.944 (37760/40000), AUC 0.9820137023925781
ep7_train_time 79.445780829
Test Epoch7 layer0 Acc 0.8854, AUC 0.9549397230148315, avg_entr 0.14406777918338776, f1 0.8853999972343445
ep7_l0_test_time 0.5704920199999606
Test Epoch7 layer1 Acc 0.8696, AUC 0.937839686870575, avg_entr 0.05128967761993408, f1 0.8695999383926392
ep7_l1_test_time 1.1047951809999859
Test Epoch7 layer2 Acc 0.866, AUC 0.9411215782165527, avg_entr 0.04628659039735794, f1 0.8659999966621399
ep7_l2_test_time 1.6941670769999746
Test Epoch7 layer3 Acc 0.866, AUC 0.940329909324646, avg_entr 0.04438015818595886, f1 0.8659999966621399
ep7_l3_test_time 2.2985986379999304
Test Epoch7 layer4 Acc 0.8654, AUC 0.9415632486343384, avg_entr 0.044869691133499146, f1 0.865399956703186
ep7_l4_test_time 2.9162645010000006
gc 0
Train Epoch8 Acc 0.955825 (38233/40000), AUC 0.9886626601219177
ep8_train_time 79.38283644499995
Test Epoch8 layer0 Acc 0.8842, AUC 0.9534589052200317, avg_entr 0.1366555243730545, f1 0.8842000365257263
ep8_l0_test_time 0.5760978140000361
Test Epoch8 layer1 Acc 0.881, AUC 0.937780499458313, avg_entr 0.02923128381371498, f1 0.8809999823570251
ep8_l1_test_time 1.0851974639999753
Test Epoch8 layer2 Acc 0.8816, AUC 0.9391468167304993, avg_entr 0.02337382547557354, f1 0.881600022315979
ep8_l2_test_time 1.6922000119999439
Test Epoch8 layer3 Acc 0.8812, AUC 0.9381240010261536, avg_entr 0.02180309407413006, f1 0.8812000155448914
ep8_l3_test_time 2.3048895379999976
Test Epoch8 layer4 Acc 0.8812, AUC 0.9387280941009521, avg_entr 0.02133689634501934, f1 0.8812000155448914
ep8_l4_test_time 2.922857410000006
gc 0
Train Epoch9 Acc 0.9614 (38456/40000), AUC 0.9903988838195801
ep9_train_time 79.32637648100001
Test Epoch9 layer0 Acc 0.8906, AUC 0.9521903991699219, avg_entr 0.1352492868900299, f1 0.8906000256538391
ep9_l0_test_time 0.5691116259999944
Test Epoch9 layer1 Acc 0.8652, AUC 0.9375044107437134, avg_entr 0.03772367164492607, f1 0.8652000427246094
ep9_l1_test_time 1.0845289140000887
Test Epoch9 layer2 Acc 0.8672, AUC 0.9384995102882385, avg_entr 0.032202333211898804, f1 0.8672000169754028
ep9_l2_test_time 1.6894804820000218
Test Epoch9 layer3 Acc 0.8668, AUC 0.9377902150154114, avg_entr 0.031431205570697784, f1 0.8668000102043152
ep9_l3_test_time 2.301626392000003
Test Epoch9 layer4 Acc 0.8668, AUC 0.938174307346344, avg_entr 0.031873669475317, f1 0.8668000102043152
ep9_l4_test_time 2.906652751000024
gc 0
Train Epoch10 Acc 0.965375 (38615/40000), AUC 0.9927937388420105
ep10_train_time 79.43819015099996
Test Epoch10 layer0 Acc 0.8878, AUC 0.951270580291748, avg_entr 0.13340570032596588, f1 0.8877999782562256
ep10_l0_test_time 0.5717874040000197
Test Epoch10 layer1 Acc 0.8748, AUC 0.9393208026885986, avg_entr 0.04181725159287453, f1 0.8748000264167786
ep10_l1_test_time 1.080725713999982
Test Epoch10 layer2 Acc 0.8752, AUC 0.9406036138534546, avg_entr 0.03168199956417084, f1 0.8751999735832214
ep10_l2_test_time 1.7007493450000766
Test Epoch10 layer3 Acc 0.8742, AUC 0.9403858184814453, avg_entr 0.030391866341233253, f1 0.8741999864578247
ep10_l3_test_time 2.320740631000035
Test Epoch10 layer4 Acc 0.8748, AUC 0.940813422203064, avg_entr 0.030172958970069885, f1 0.8748000264167786
ep10_l4_test_time 2.9408457340000496
gc 0
Train Epoch11 Acc 0.96725 (38690/40000), AUC 0.9933101534843445
ep11_train_time 79.42066036000006
Test Epoch11 layer0 Acc 0.8896, AUC 0.950065016746521, avg_entr 0.12953712046146393, f1 0.8895999193191528
ep11_l0_test_time 0.5741873330000544
Test Epoch11 layer1 Acc 0.8752, AUC 0.9371406435966492, avg_entr 0.03037983365356922, f1 0.8751999735832214
ep11_l1_test_time 1.0854321649999292
Test Epoch11 layer2 Acc 0.8766, AUC 0.9390057325363159, avg_entr 0.02243521809577942, f1 0.8766000270843506
ep11_l2_test_time 1.684966766000116
Test Epoch11 layer3 Acc 0.876, AUC 0.9382523894309998, avg_entr 0.02136026695370674, f1 0.8760000467300415
ep11_l3_test_time 2.297848940999984
Test Epoch11 layer4 Acc 0.8756, AUC 0.9391198754310608, avg_entr 0.02123120240867138, f1 0.8756000399589539
ep11_l4_test_time 2.901753799999824
gc 0
Train Epoch12 Acc 0.9685 (38740/40000), AUC 0.9939455986022949
ep12_train_time 79.3502798070001
Test Epoch12 layer0 Acc 0.887, AUC 0.948983907699585, avg_entr 0.12640263140201569, f1 0.8870000243186951
ep12_l0_test_time 0.5780323829999361
Test Epoch12 layer1 Acc 0.8744, AUC 0.9370298385620117, avg_entr 0.03419378772377968, f1 0.8744000792503357
ep12_l1_test_time 1.0904476929999873
Test Epoch12 layer2 Acc 0.8748, AUC 0.9389231204986572, avg_entr 0.02574956603348255, f1 0.8748000264167786
ep12_l2_test_time 1.6947420650001277
Test Epoch12 layer3 Acc 0.8746, AUC 0.9385160207748413, avg_entr 0.024768657982349396, f1 0.8745999932289124
ep12_l3_test_time 2.303566350999972
Test Epoch12 layer4 Acc 0.874, AUC 0.9392597675323486, avg_entr 0.024678967893123627, f1 0.8740000128746033
ep12_l4_test_time 2.9146765810000943
gc 0
Train Epoch13 Acc 0.97115 (38846/40000), AUC 0.9948126077651978
ep13_train_time 79.39608152000005
Test Epoch13 layer0 Acc 0.8858, AUC 0.9483997821807861, avg_entr 0.12556242942810059, f1 0.8858000040054321
ep13_l0_test_time 0.5700223979999919
Test Epoch13 layer1 Acc 0.8712, AUC 0.9315980672836304, avg_entr 0.02551969327032566, f1 0.8712000846862793
ep13_l1_test_time 1.0874627210000654
Test Epoch13 layer2 Acc 0.8722, AUC 0.9341458678245544, avg_entr 0.018726738169789314, f1 0.872200071811676
ep13_l2_test_time 1.6925486709999404
Test Epoch13 layer3 Acc 0.8722, AUC 0.9326978921890259, avg_entr 0.017839258536696434, f1 0.872200071811676
ep13_l3_test_time 2.3042308710000725
Test Epoch13 layer4 Acc 0.8724, AUC 0.934414803981781, avg_entr 0.017521141096949577, f1 0.8723999857902527
ep13_l4_test_time 2.9243949210001574
gc 0
Train Epoch14 Acc 0.97275 (38910/40000), AUC 0.9951742887496948
ep14_train_time 79.35455923000018
Test Epoch14 layer0 Acc 0.8832, AUC 0.9476912617683411, avg_entr 0.12579336762428284, f1 0.8831999897956848
ep14_l0_test_time 0.5712396950000311
Test Epoch14 layer1 Acc 0.8718, AUC 0.9344431757926941, avg_entr 0.03089614026248455, f1 0.8718000650405884
ep14_l1_test_time 1.0841581199999837
Test Epoch14 layer2 Acc 0.8716, AUC 0.9368804097175598, avg_entr 0.023282110691070557, f1 0.8715999722480774
ep14_l2_test_time 1.6917614540000159
Test Epoch14 layer3 Acc 0.8716, AUC 0.9360982179641724, avg_entr 0.022519061341881752, f1 0.8715999722480774
ep14_l3_test_time 2.3015842119998524
Test Epoch14 layer4 Acc 0.8724, AUC 0.9371259212493896, avg_entr 0.02227739244699478, f1 0.8723999857902527
ep14_l4_test_time 2.90689431099986
gc 0
Train Epoch15 Acc 0.972825 (38913/40000), AUC 0.9951560497283936
ep15_train_time 79.36318719499991
Test Epoch15 layer0 Acc 0.8836, AUC 0.9470760822296143, avg_entr 0.12316364794969559, f1 0.8835999965667725
ep15_l0_test_time 0.5722681760000796
Test Epoch15 layer1 Acc 0.8728, AUC 0.9345446825027466, avg_entr 0.029843423515558243, f1 0.8727999925613403
ep15_l1_test_time 1.0819656930000292
Test Epoch15 layer2 Acc 0.8724, AUC 0.9367272853851318, avg_entr 0.022716738283634186, f1 0.8723999857902527
ep15_l2_test_time 1.698603741999932
Test Epoch15 layer3 Acc 0.8724, AUC 0.9365295171737671, avg_entr 0.022336138412356377, f1 0.8723999857902527
ep15_l3_test_time 2.3177808170000844
Test Epoch15 layer4 Acc 0.872, AUC 0.9374102354049683, avg_entr 0.02235131897032261, f1 0.871999979019165
ep15_l4_test_time 2.9435169700000188
gc 0
Train Epoch16 Acc 0.973075 (38923/40000), AUC 0.9954947829246521
ep16_train_time 79.43446514199991
Test Epoch16 layer0 Acc 0.8798, AUC 0.9463207721710205, avg_entr 0.12044444680213928, f1 0.879800021648407
ep16_l0_test_time 0.5722790479999276
Test Epoch16 layer1 Acc 0.8688, AUC 0.9325833916664124, avg_entr 0.03125908225774765, f1 0.8687999844551086
ep16_l1_test_time 1.082027270000026
Test Epoch16 layer2 Acc 0.8692, AUC 0.935192883014679, avg_entr 0.0234637763351202, f1 0.8691999912261963
ep16_l2_test_time 1.686050952999949
Test Epoch16 layer3 Acc 0.869, AUC 0.9343593716621399, avg_entr 0.023035958409309387, f1 0.8690000176429749
ep16_l3_test_time 2.2960484789998645
Test Epoch16 layer4 Acc 0.869, AUC 0.9355592727661133, avg_entr 0.02310340292751789, f1 0.8690000176429749
ep16_l4_test_time 2.896729707000077
gc 0
Train Epoch17 Acc 0.9747 (38988/40000), AUC 0.995810866355896
ep17_train_time 79.26305630800016
Test Epoch17 layer0 Acc 0.8822, AUC 0.9460746049880981, avg_entr 0.1206900030374527, f1 0.8822000026702881
ep17_l0_test_time 0.5471028609999848
Test Epoch17 layer1 Acc 0.8742, AUC 0.933448851108551, avg_entr 0.027961043640971184, f1 0.8741999864578247
ep17_l1_test_time 1.0467365040001368
Test Epoch17 layer2 Acc 0.8724, AUC 0.9353763461112976, avg_entr 0.020569775253534317, f1 0.8723999857902527
ep17_l2_test_time 1.648511138999993
Test Epoch17 layer3 Acc 0.8724, AUC 0.9346562623977661, avg_entr 0.020003557205200195, f1 0.8723999857902527
ep17_l3_test_time 2.2576945160001287
Test Epoch17 layer4 Acc 0.8726, AUC 0.9358415603637695, avg_entr 0.019809702411293983, f1 0.8726000189781189
ep17_l4_test_time 2.8703417930000796
gc 0
Train Epoch18 Acc 0.97515 (39006/40000), AUC 0.9960157871246338
ep18_train_time 78.89015842200001
Test Epoch18 layer0 Acc 0.881, AUC 0.9459019899368286, avg_entr 0.12043557316064835, f1 0.8809999823570251
ep18_l0_test_time 0.5413886469998488
Test Epoch18 layer1 Acc 0.8704, AUC 0.9319756627082825, avg_entr 0.02622821368277073, f1 0.8704000115394592
ep18_l1_test_time 1.0437342079999326
Test Epoch18 layer2 Acc 0.8708, AUC 0.9343987107276917, avg_entr 0.019385991618037224, f1 0.8708000183105469
ep18_l2_test_time 1.6490738900001816
Test Epoch18 layer3 Acc 0.8706, AUC 0.9338870048522949, avg_entr 0.0190319512039423, f1 0.8705999851226807
ep18_l3_test_time 2.253048884000009
Test Epoch18 layer4 Acc 0.8702, AUC 0.9350685477256775, avg_entr 0.01904672011733055, f1 0.870199978351593
ep18_l4_test_time 2.873090028999968
gc 0
Train Epoch19 Acc 0.97565 (39026/40000), AUC 0.9960832595825195
ep19_train_time 78.79924441100002
Test Epoch19 layer0 Acc 0.881, AUC 0.9456319808959961, avg_entr 0.12012447416782379, f1 0.8809999823570251
ep19_l0_test_time 0.5499234429998978
Test Epoch19 layer1 Acc 0.87, AUC 0.9321897029876709, avg_entr 0.026290731504559517, f1 0.8700000047683716
ep19_l1_test_time 1.0491076180001073
Test Epoch19 layer2 Acc 0.8706, AUC 0.9341663122177124, avg_entr 0.01920478604733944, f1 0.8705999851226807
ep19_l2_test_time 1.6514713939998273
Test Epoch19 layer3 Acc 0.8704, AUC 0.9334908723831177, avg_entr 0.018912818282842636, f1 0.8704000115394592
ep19_l3_test_time 2.248211764999951
Test Epoch19 layer4 Acc 0.8696, AUC 0.9347422122955322, avg_entr 0.018807262182235718, f1 0.8695999383926392
ep19_l4_test_time 2.862390131999973
gc 0
Train Epoch20 Acc 0.9759 (39036/40000), AUC 0.9961588978767395
ep20_train_time 78.85652441100001
Test Epoch20 layer0 Acc 0.878, AUC 0.9452207088470459, avg_entr 0.11669633537530899, f1 0.878000020980835
ep20_l0_test_time 0.5422258240000701
Test Epoch20 layer1 Acc 0.8686, AUC 0.9308658838272095, avg_entr 0.027869533747434616, f1 0.8686000108718872
ep20_l1_test_time 1.0439502320000429
Test Epoch20 layer2 Acc 0.8696, AUC 0.933596134185791, avg_entr 0.020883504301309586, f1 0.8695999383926392
ep20_l2_test_time 1.6519031630000427
Test Epoch20 layer3 Acc 0.8696, AUC 0.9325843453407288, avg_entr 0.02024836651980877, f1 0.8695999383926392
ep20_l3_test_time 2.275908995000009
Test Epoch20 layer4 Acc 0.8692, AUC 0.9341573715209961, avg_entr 0.020152434706687927, f1 0.8691999912261963
ep20_l4_test_time 2.893546801000184
gc 0
Train Epoch21 Acc 0.976625 (39065/40000), AUC 0.9961909055709839
ep21_train_time 78.76329938399999
Test Epoch21 layer0 Acc 0.8806, AUC 0.94512939453125, avg_entr 0.11820606887340546, f1 0.8805999755859375
ep21_l0_test_time 0.5443005519998678
Test Epoch21 layer1 Acc 0.8682, AUC 0.9322850704193115, avg_entr 0.028495516628026962, f1 0.8682000041007996
ep21_l1_test_time 1.0440543469999284
Test Epoch21 layer2 Acc 0.869, AUC 0.9342465996742249, avg_entr 0.021173816174268723, f1 0.8690000176429749
ep21_l2_test_time 1.6437746050000897
Test Epoch21 layer3 Acc 0.869, AUC 0.9338199496269226, avg_entr 0.020446360111236572, f1 0.8690000176429749
ep21_l3_test_time 2.2498977879999984
Test Epoch21 layer4 Acc 0.869, AUC 0.9349097013473511, avg_entr 0.01998872309923172, f1 0.8690000176429749
ep21_l4_test_time 2.8511177510001744
gc 0
Train Epoch22 Acc 0.976925 (39077/40000), AUC 0.9963241815567017
ep22_train_time 78.78800245699995
Test Epoch22 layer0 Acc 0.8806, AUC 0.944974422454834, avg_entr 0.11786934733390808, f1 0.8805999755859375
ep22_l0_test_time 0.5422697020001124
Test Epoch22 layer1 Acc 0.8688, AUC 0.9309861063957214, avg_entr 0.02556621842086315, f1 0.8687999844551086
ep22_l1_test_time 1.049700423000104
Test Epoch22 layer2 Acc 0.8696, AUC 0.9329526424407959, avg_entr 0.0195511132478714, f1 0.8695999383926392
ep22_l2_test_time 1.6498152310000478
Test Epoch22 layer3 Acc 0.8704, AUC 0.9324123859405518, avg_entr 0.019328175112605095, f1 0.8704000115394592
ep22_l3_test_time 2.2573924159999024
Test Epoch22 layer4 Acc 0.8702, AUC 0.9336668848991394, avg_entr 0.019313473254442215, f1 0.870199978351593
ep22_l4_test_time 2.862185284999896
gc 0
Train Epoch23 Acc 0.977175 (39087/40000), AUC 0.9964210987091064
ep23_train_time 78.87444273300002
Test Epoch23 layer0 Acc 0.88, AUC 0.9448027610778809, avg_entr 0.11617739498615265, f1 0.8799999952316284
ep23_l0_test_time 0.5759158310002022
Test Epoch23 layer1 Acc 0.8706, AUC 0.9314020872116089, avg_entr 0.0254213809967041, f1 0.8705999851226807
ep23_l1_test_time 1.0473614269999416
Test Epoch23 layer2 Acc 0.8704, AUC 0.9333796501159668, avg_entr 0.01845388300716877, f1 0.8704000115394592
ep23_l2_test_time 1.6485638560002371
Test Epoch23 layer3 Acc 0.8712, AUC 0.9329625368118286, avg_entr 0.018151473253965378, f1 0.8712000846862793
ep23_l3_test_time 2.2707100509996963
Test Epoch23 layer4 Acc 0.8706, AUC 0.9340407848358154, avg_entr 0.018082622438669205, f1 0.8705999851226807
ep23_l4_test_time 2.8725482780000675
gc 0
Train Epoch24 Acc 0.977525 (39101/40000), AUC 0.9965062141418457
ep24_train_time 78.80667768700005
Test Epoch24 layer0 Acc 0.8792, AUC 0.9446669816970825, avg_entr 0.11591516435146332, f1 0.8791999816894531
ep24_l0_test_time 0.5431190260001131
Test Epoch24 layer1 Acc 0.8698, AUC 0.9318201541900635, avg_entr 0.025838779285550117, f1 0.8697999715805054
ep24_l1_test_time 1.0471840299996984
Test Epoch24 layer2 Acc 0.8704, AUC 0.9335823059082031, avg_entr 0.019053000956773758, f1 0.8704000115394592
ep24_l2_test_time 1.6466577770002004
Test Epoch24 layer3 Acc 0.8704, AUC 0.9329040050506592, avg_entr 0.018855586647987366, f1 0.8704000115394592
ep24_l3_test_time 2.253999074999683
Test Epoch24 layer4 Acc 0.87, AUC 0.934120774269104, avg_entr 0.018769489601254463, f1 0.8700000047683716
ep24_l4_test_time 2.861010247000195
gc 0
Train Epoch25 Acc 0.977225 (39089/40000), AUC 0.9964635372161865
ep25_train_time 78.89594540799999
Test Epoch25 layer0 Acc 0.8794, AUC 0.9446064829826355, avg_entr 0.11508645117282867, f1 0.8794000148773193
ep25_l0_test_time 0.5448909239999011
Test Epoch25 layer1 Acc 0.8696, AUC 0.9307945966720581, avg_entr 0.024543872103095055, f1 0.8695999383926392
ep25_l1_test_time 1.0413247270003012
Test Epoch25 layer2 Acc 0.8702, AUC 0.9328402280807495, avg_entr 0.018083179369568825, f1 0.870199978351593
ep25_l2_test_time 1.6525861410000289
Test Epoch25 layer3 Acc 0.8702, AUC 0.9323558807373047, avg_entr 0.017773840576410294, f1 0.870199978351593
ep25_l3_test_time 2.269559217999813
Test Epoch25 layer4 Acc 0.8696, AUC 0.9335354566574097, avg_entr 0.017757192254066467, f1 0.8695999383926392
ep25_l4_test_time 2.894033154999761
gc 0
Train Epoch26 Acc 0.977575 (39103/40000), AUC 0.9964849948883057
ep26_train_time 78.8086382319998
Test Epoch26 layer0 Acc 0.8796, AUC 0.9445130228996277, avg_entr 0.11471768468618393, f1 0.8795999884605408
ep26_l0_test_time 0.5452471950002291
Test Epoch26 layer1 Acc 0.868, AUC 0.9302635192871094, avg_entr 0.023832162842154503, f1 0.8679999709129333
ep26_l1_test_time 1.0411852490001365
Test Epoch26 layer2 Acc 0.8698, AUC 0.9322605729103088, avg_entr 0.017513228580355644, f1 0.8697999715805054
ep26_l2_test_time 1.6423941439998089
Test Epoch26 layer3 Acc 0.8702, AUC 0.9317523241043091, avg_entr 0.01692802459001541, f1 0.870199978351593
ep26_l3_test_time 2.2515833929996916
Test Epoch26 layer4 Acc 0.8704, AUC 0.9330865144729614, avg_entr 0.01687123067677021, f1 0.8704000115394592
ep26_l4_test_time 2.8532605559998956
gc 0
Train Epoch27 Acc 0.977625 (39105/40000), AUC 0.9966102838516235
ep27_train_time 78.883435405
Test Epoch27 layer0 Acc 0.8788, AUC 0.9444793462753296, avg_entr 0.11453957855701447, f1 0.8787999749183655
ep27_l0_test_time 0.5519146930000716
Test Epoch27 layer1 Acc 0.8706, AUC 0.9307731986045837, avg_entr 0.024402622133493423, f1 0.8705999851226807
ep27_l1_test_time 1.054023490000418
Test Epoch27 layer2 Acc 0.8696, AUC 0.9328149557113647, avg_entr 0.017887158319354057, f1 0.8695999383926392
ep27_l2_test_time 1.6539122859999225
Test Epoch27 layer3 Acc 0.8706, AUC 0.9323269128799438, avg_entr 0.017622075974941254, f1 0.8705999851226807
ep27_l3_test_time 2.255223283000305
Test Epoch27 layer4 Acc 0.8696, AUC 0.9334921836853027, avg_entr 0.017589449882507324, f1 0.8695999383926392
ep27_l4_test_time 2.8660416600000644
gc 0
Train Epoch28 Acc 0.977775 (39111/40000), AUC 0.996658205986023
ep28_train_time 79.0495439020001
Test Epoch28 layer0 Acc 0.8782, AUC 0.944358766078949, avg_entr 0.11341673880815506, f1 0.8781999945640564
ep28_l0_test_time 0.5639350410001498
Test Epoch28 layer1 Acc 0.8698, AUC 0.9307957887649536, avg_entr 0.024062413722276688, f1 0.8697999715805054
ep28_l1_test_time 1.0479847689998678
Test Epoch28 layer2 Acc 0.8694, AUC 0.9327183961868286, avg_entr 0.017425473779439926, f1 0.8694000244140625
ep28_l2_test_time 1.6488210600000457
Test Epoch28 layer3 Acc 0.8702, AUC 0.9322243332862854, avg_entr 0.017128491774201393, f1 0.870199978351593
ep28_l3_test_time 2.267385204999755
Test Epoch28 layer4 Acc 0.8696, AUC 0.9334673285484314, avg_entr 0.017166614532470703, f1 0.8695999383926392
ep28_l4_test_time 2.876432277999811
gc 0
Train Epoch29 Acc 0.977925 (39117/40000), AUC 0.9965898990631104
ep29_train_time 78.81714612900032
Test Epoch29 layer0 Acc 0.8796, AUC 0.9443612098693848, avg_entr 0.1135418564081192, f1 0.8795999884605408
ep29_l0_test_time 0.5423120049999852
Test Epoch29 layer1 Acc 0.8694, AUC 0.9305911064147949, avg_entr 0.024008309468626976, f1 0.8694000244140625
ep29_l1_test_time 1.042106911999781
Test Epoch29 layer2 Acc 0.87, AUC 0.9326416850090027, avg_entr 0.018056239932775497, f1 0.8700000047683716
ep29_l2_test_time 1.6423142389999157
Test Epoch29 layer3 Acc 0.8698, AUC 0.9321789741516113, avg_entr 0.01780913770198822, f1 0.8697999715805054
ep29_l3_test_time 2.253235676999793
Test Epoch29 layer4 Acc 0.8696, AUC 0.9333740472793579, avg_entr 0.017745405435562134, f1 0.8695999383926392
ep29_l4_test_time 2.857576872000209
Best AUC tensor(0.8964) 6 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 2630.585668772
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5_pad500//imdb_lstmal_l5.pt
Test layer0 Acc 0.892, AUC 0.9525818824768066, avg_entr 0.15827861428260803, f1 0.8920000195503235
l0_test_time 0.5416669169999295
Test layer1 Acc 0.8372, AUC 0.9335918426513672, avg_entr 0.07923326641321182, f1 0.8371999859809875
l1_test_time 1.0436346420001428
Test layer2 Acc 0.8386, AUC 0.9348766803741455, avg_entr 0.06838107854127884, f1 0.8385999798774719
l2_test_time 1.6448892240000532
Test layer3 Acc 0.8424, AUC 0.9346010684967041, avg_entr 0.06645936518907547, f1 0.8424000144004822
l3_test_time 2.2512563000000227
Test layer4 Acc 0.8422, AUC 0.9341952204704285, avg_entr 0.06557163596153259, f1 0.842199981212616
l4_test_time 2.8626371830000608
