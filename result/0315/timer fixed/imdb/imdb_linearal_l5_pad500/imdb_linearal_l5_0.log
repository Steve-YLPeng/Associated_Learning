total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.979132492
Start Training
gc 0
Train Epoch0 Acc 0.518175 (20727/40000), AUC 0.517547607421875
ep0_train_time 7.252835876999999
Test Epoch0 layer0 Acc 0.798, AUC 0.8803356885910034, avg_entr 0.5846970081329346, f1 0.7979999780654907
ep0_l0_test_time 0.570601197000002
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6492, AUC 0.855423629283905, avg_entr 0.6832401156425476, f1 0.6492000222206116
ep0_l1_test_time 0.5675391990000023
Test Epoch0 layer2 Acc 0.5434, AUC 0.819088339805603, avg_entr 0.6896408796310425, f1 0.54339998960495
ep0_l2_test_time 0.5694946779999981
Test Epoch0 layer3 Acc 0.5316, AUC 0.8260375261306763, avg_entr 0.6903277039527893, f1 0.5315999984741211
ep0_l3_test_time 0.567022565000002
Test Epoch0 layer4 Acc 0.5576, AUC 0.8354967832565308, avg_entr 0.6910671591758728, f1 0.5576000213623047
ep0_l4_test_time 0.5822080780000007
gc 0
Train Epoch1 Acc 0.8223 (32892/40000), AUC 0.8956330418586731
ep1_train_time 6.798180218000006
Test Epoch1 layer0 Acc 0.8726, AUC 0.9452584981918335, avg_entr 0.29636210203170776, f1 0.8726000189781189
ep1_l0_test_time 0.5678607730000067
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8732, AUC 0.946122407913208, avg_entr 0.31662556529045105, f1 0.873199999332428
ep1_l1_test_time 0.5688163589999959
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8738, AUC 0.9463925361633301, avg_entr 0.24256262183189392, f1 0.8737999796867371
ep1_l2_test_time 0.5694665720000032
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.876, AUC 0.9464231729507446, avg_entr 0.23434565961360931, f1 0.8760000467300415
ep1_l3_test_time 0.5713979219999956
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.879, AUC 0.9463945627212524, avg_entr 0.21764743328094482, f1 0.8790000081062317
ep1_l4_test_time 0.5735356189999976
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.90415 (36166/40000), AUC 0.9644255042076111
ep2_train_time 6.862767812000001
Test Epoch2 layer0 Acc 0.8928, AUC 0.9556161165237427, avg_entr 0.22988510131835938, f1 0.892799973487854
ep2_l0_test_time 0.5686506090000023
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8936, AUC 0.9561740159988403, avg_entr 0.2088732123374939, f1 0.8935999870300293
ep2_l1_test_time 0.5794946569999979
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.894, AUC 0.9563491344451904, avg_entr 0.19148783385753632, f1 0.8939999938011169
ep2_l2_test_time 0.5765667439999973
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8958, AUC 0.9564628601074219, avg_entr 0.1791025698184967, f1 0.895799994468689
ep2_l3_test_time 0.5699565030000002
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.895, AUC 0.9563988447189331, avg_entr 0.15500736236572266, f1 0.8949999809265137
ep2_l4_test_time 0.5824714000000029
gc 0
Train Epoch3 Acc 0.922475 (36899/40000), AUC 0.975770115852356
ep3_train_time 6.810167298000003
Test Epoch3 layer0 Acc 0.8972, AUC 0.9586532115936279, avg_entr 0.19819360971450806, f1 0.8971999883651733
ep3_l0_test_time 0.5675929200000027
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8954, AUC 0.9590564966201782, avg_entr 0.1740296483039856, f1 0.8953999876976013
ep3_l1_test_time 0.5705431119999957
Test Epoch3 layer2 Acc 0.897, AUC 0.9593578577041626, avg_entr 0.16005100309848785, f1 0.8970000147819519
ep3_l2_test_time 0.5680752060000032
Test Epoch3 layer3 Acc 0.8978, AUC 0.9595962762832642, avg_entr 0.1401297152042389, f1 0.8978000283241272
ep3_l3_test_time 0.5680604799999998
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.8978, AUC 0.9595930576324463, avg_entr 0.11281806975603104, f1 0.8978000283241272
ep3_l4_test_time 0.569474802000002
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.93295 (37318/40000), AUC 0.9813212156295776
ep4_train_time 6.785301302000001
Test Epoch4 layer0 Acc 0.8938, AUC 0.958958625793457, avg_entr 0.17582254111766815, f1 0.8938000202178955
ep4_l0_test_time 0.5703992620000093
Test Epoch4 layer1 Acc 0.8964, AUC 0.9594521522521973, avg_entr 0.15244604647159576, f1 0.896399974822998
ep4_l1_test_time 0.5739367629999919
Test Epoch4 layer2 Acc 0.8962, AUC 0.9596887826919556, avg_entr 0.13950654864311218, f1 0.8962000012397766
ep4_l2_test_time 0.5852547639999983
Test Epoch4 layer3 Acc 0.8964, AUC 0.9600856304168701, avg_entr 0.10856102406978607, f1 0.896399974822998
ep4_l3_test_time 0.5891765280000101
Test Epoch4 layer4 Acc 0.896, AUC 0.9603609442710876, avg_entr 0.07460632920265198, f1 0.8960000276565552
ep4_l4_test_time 0.5715861019999977
gc 0
Train Epoch5 Acc 0.9412 (37648/40000), AUC 0.9848905801773071
ep5_train_time 6.813829955999992
Test Epoch5 layer0 Acc 0.8968, AUC 0.9579962491989136, avg_entr 0.16233369708061218, f1 0.8967999815940857
ep5_l0_test_time 0.576591288000003
Test Epoch5 layer1 Acc 0.8966, AUC 0.958590567111969, avg_entr 0.13831818103790283, f1 0.8966000080108643
ep5_l1_test_time 0.5685629049999932
Test Epoch5 layer2 Acc 0.8978, AUC 0.9587546586990356, avg_entr 0.12466833740472794, f1 0.8978000283241272
ep5_l2_test_time 0.5751735799999977
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 5
Test Epoch5 layer3 Acc 0.8982, AUC 0.9593581557273865, avg_entr 0.08993154764175415, f1 0.8981999754905701
ep5_l3_test_time 0.5808111780000047
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 5
Test Epoch5 layer4 Acc 0.8978, AUC 0.9592995643615723, avg_entr 0.05540949106216431, f1 0.8978000283241272
ep5_l4_test_time 0.5723868870000075
gc 0
Train Epoch6 Acc 0.94765 (37906/40000), AUC 0.987293004989624
ep6_train_time 6.813250210000007
Test Epoch6 layer0 Acc 0.8954, AUC 0.9576471447944641, avg_entr 0.15369373559951782, f1 0.8953999876976013
ep6_l0_test_time 0.5853337479999965
Test Epoch6 layer1 Acc 0.8962, AUC 0.9581321477890015, avg_entr 0.12970371544361115, f1 0.8962000012397766
ep6_l1_test_time 0.5665323040000061
Test Epoch6 layer2 Acc 0.8968, AUC 0.9588141441345215, avg_entr 0.11423429101705551, f1 0.8967999815940857
ep6_l2_test_time 0.583803274999994
Test Epoch6 layer3 Acc 0.8972, AUC 0.959306001663208, avg_entr 0.07445891946554184, f1 0.8971999883651733
ep6_l3_test_time 0.5704623549999894
Test Epoch6 layer4 Acc 0.8978, AUC 0.9574370384216309, avg_entr 0.04528263956308365, f1 0.8978000283241272
ep6_l4_test_time 0.5687943209999986
gc 0
Train Epoch7 Acc 0.95315 (38126/40000), AUC 0.9891343712806702
ep7_train_time 6.807612802000008
Test Epoch7 layer0 Acc 0.8944, AUC 0.956175684928894, avg_entr 0.1451198309659958, f1 0.8944000005722046
ep7_l0_test_time 0.5765589140000031
Test Epoch7 layer1 Acc 0.8958, AUC 0.9568741321563721, avg_entr 0.12196574360132217, f1 0.895799994468689
ep7_l1_test_time 0.5682337749999959
Test Epoch7 layer2 Acc 0.8976, AUC 0.9579381942749023, avg_entr 0.10565227270126343, f1 0.897599995136261
ep7_l2_test_time 0.5903444699999909
Test Epoch7 layer3 Acc 0.896, AUC 0.9582198858261108, avg_entr 0.060141462832689285, f1 0.8960000276565552
ep7_l3_test_time 0.6109217630000074
Test Epoch7 layer4 Acc 0.8974, AUC 0.9556846022605896, avg_entr 0.035770125687122345, f1 0.8974000215530396
ep7_l4_test_time 0.5711093190000014
gc 0
Train Epoch8 Acc 0.9596 (38384/40000), AUC 0.9907909631729126
ep8_train_time 6.812663373000007
Test Epoch8 layer0 Acc 0.8932, AUC 0.9546220302581787, avg_entr 0.13733437657356262, f1 0.8931999802589417
ep8_l0_test_time 0.5676002640000064
Test Epoch8 layer1 Acc 0.8928, AUC 0.955417275428772, avg_entr 0.11388047784566879, f1 0.892799973487854
ep8_l1_test_time 0.5789538690000029
Test Epoch8 layer2 Acc 0.8936, AUC 0.9565138816833496, avg_entr 0.09555167704820633, f1 0.8935999870300293
ep8_l2_test_time 0.5679768549999977
Test Epoch8 layer3 Acc 0.8926, AUC 0.9564775824546814, avg_entr 0.04911718890070915, f1 0.8925999999046326
ep8_l3_test_time 0.5680420480000095
Test Epoch8 layer4 Acc 0.8924, AUC 0.9538993835449219, avg_entr 0.02971840463578701, f1 0.8923999667167664
ep8_l4_test_time 0.5725518120000004
gc 0
Train Epoch9 Acc 0.962725 (38509/40000), AUC 0.9926034212112427
ep9_train_time 6.81012259500001
Test Epoch9 layer0 Acc 0.8902, AUC 0.9533681869506836, avg_entr 0.13377897441387177, f1 0.8902000188827515
ep9_l0_test_time 0.5656527630000028
Test Epoch9 layer1 Acc 0.8912, AUC 0.9543164968490601, avg_entr 0.11087636649608612, f1 0.8912000060081482
ep9_l1_test_time 0.5975968690000002
Test Epoch9 layer2 Acc 0.8916, AUC 0.9553688764572144, avg_entr 0.09068156033754349, f1 0.8916000127792358
ep9_l2_test_time 0.5755971850000066
Test Epoch9 layer3 Acc 0.8914, AUC 0.9548225402832031, avg_entr 0.04605872556567192, f1 0.8913999795913696
ep9_l3_test_time 0.5680080010000097
Test Epoch9 layer4 Acc 0.8916, AUC 0.9511213302612305, avg_entr 0.028543395921587944, f1 0.8916000127792358
ep9_l4_test_time 0.5706940190000012
gc 0
Train Epoch10 Acc 0.96535 (38614/40000), AUC 0.9930901527404785
ep10_train_time 6.821478847999998
Test Epoch10 layer0 Acc 0.8914, AUC 0.9522737860679626, avg_entr 0.1326204389333725, f1 0.8913999795913696
ep10_l0_test_time 0.5683744479999859
Test Epoch10 layer1 Acc 0.8922, AUC 0.9532782435417175, avg_entr 0.11025633662939072, f1 0.8921999931335449
ep10_l1_test_time 0.5686187449999807
Test Epoch10 layer2 Acc 0.8914, AUC 0.954330325126648, avg_entr 0.08860831707715988, f1 0.8913999795913696
ep10_l2_test_time 0.5683406750000017
Test Epoch10 layer3 Acc 0.8912, AUC 0.953389585018158, avg_entr 0.04270273447036743, f1 0.8912000060081482
ep10_l3_test_time 0.5693738659999781
Test Epoch10 layer4 Acc 0.891, AUC 0.9520978927612305, avg_entr 0.02690880186855793, f1 0.890999972820282
ep10_l4_test_time 0.5731207880000113
gc 0
Train Epoch11 Acc 0.9665 (38660/40000), AUC 0.9936535358428955
ep11_train_time 6.798090486000007
Test Epoch11 layer0 Acc 0.8886, AUC 0.9510844945907593, avg_entr 0.1283913105726242, f1 0.8885999917984009
ep11_l0_test_time 0.5672144389999971
Test Epoch11 layer1 Acc 0.8892, AUC 0.9521546363830566, avg_entr 0.10673131048679352, f1 0.88919997215271
ep11_l1_test_time 0.5673111670000139
Test Epoch11 layer2 Acc 0.889, AUC 0.9530715942382812, avg_entr 0.08477038145065308, f1 0.8889999985694885
ep11_l2_test_time 0.5682056060000207
Test Epoch11 layer3 Acc 0.889, AUC 0.9511200189590454, avg_entr 0.04025113582611084, f1 0.8889999985694885
ep11_l3_test_time 0.5683248130000038
Test Epoch11 layer4 Acc 0.8892, AUC 0.9497217535972595, avg_entr 0.025893181562423706, f1 0.88919997215271
ep11_l4_test_time 0.5814030070000058
gc 0
Train Epoch12 Acc 0.968125 (38725/40000), AUC 0.9943145513534546
ep12_train_time 6.829415777000008
Test Epoch12 layer0 Acc 0.888, AUC 0.9503170251846313, avg_entr 0.12720802426338196, f1 0.8880000114440918
ep12_l0_test_time 0.5666573529999823
Test Epoch12 layer1 Acc 0.8882, AUC 0.9514559507369995, avg_entr 0.10558734089136124, f1 0.888200044631958
ep12_l1_test_time 0.5657397610000032
Test Epoch12 layer2 Acc 0.8886, AUC 0.9523724913597107, avg_entr 0.08311659842729568, f1 0.8885999917984009
ep12_l2_test_time 0.5682392999999877
Test Epoch12 layer3 Acc 0.8882, AUC 0.9503121376037598, avg_entr 0.038036275655031204, f1 0.888200044631958
ep12_l3_test_time 0.5768068419999963
Test Epoch12 layer4 Acc 0.8888, AUC 0.9509363770484924, avg_entr 0.024679575115442276, f1 0.8888000249862671
ep12_l4_test_time 0.5723785209999903
gc 0
Train Epoch13 Acc 0.9691 (38764/40000), AUC 0.9948617219924927
ep13_train_time 6.790285734000008
Test Epoch13 layer0 Acc 0.885, AUC 0.9495857954025269, avg_entr 0.1250520497560501, f1 0.8849999904632568
ep13_l0_test_time 0.6077530340000123
Test Epoch13 layer1 Acc 0.888, AUC 0.9507970809936523, avg_entr 0.10394344478845596, f1 0.8880000114440918
ep13_l1_test_time 0.5697674820000032
Test Epoch13 layer2 Acc 0.8878, AUC 0.9516448974609375, avg_entr 0.08088880032300949, f1 0.8877999782562256
ep13_l2_test_time 0.5667641489999937
Test Epoch13 layer3 Acc 0.8872, AUC 0.9493883848190308, avg_entr 0.03645804524421692, f1 0.8871999979019165
ep13_l3_test_time 0.6008058460000143
Test Epoch13 layer4 Acc 0.888, AUC 0.9504523873329163, avg_entr 0.023743925616145134, f1 0.8880000114440918
ep13_l4_test_time 0.5802154350000137
gc 0
Train Epoch14 Acc 0.97035 (38814/40000), AUC 0.9950901865959167
ep14_train_time 6.7926763119999976
Test Epoch14 layer0 Acc 0.886, AUC 0.9490315318107605, avg_entr 0.12432563304901123, f1 0.8859999775886536
ep14_l0_test_time 0.5704041390000043
Test Epoch14 layer1 Acc 0.8864, AUC 0.9502443075180054, avg_entr 0.10307759791612625, f1 0.8863999843597412
ep14_l1_test_time 0.5701229290000072
Test Epoch14 layer2 Acc 0.8856, AUC 0.9511635303497314, avg_entr 0.07928799092769623, f1 0.8855999708175659
ep14_l2_test_time 0.5716339580000067
Test Epoch14 layer3 Acc 0.8874, AUC 0.948313295841217, avg_entr 0.03546634688973427, f1 0.8873999714851379
ep14_l3_test_time 0.572298442999994
Test Epoch14 layer4 Acc 0.8882, AUC 0.9497319459915161, avg_entr 0.023443356156349182, f1 0.888200044631958
ep14_l4_test_time 0.5706168119999973
gc 0
Train Epoch15 Acc 0.97045 (38818/40000), AUC 0.9952414035797119
ep15_train_time 6.788436235000006
Test Epoch15 layer0 Acc 0.8856, AUC 0.9485228061676025, avg_entr 0.12232885509729385, f1 0.8855999708175659
ep15_l0_test_time 0.5668314269999826
Test Epoch15 layer1 Acc 0.8868, AUC 0.9497837424278259, avg_entr 0.10145731270313263, f1 0.8867999911308289
ep15_l1_test_time 0.5663432249999971
Test Epoch15 layer2 Acc 0.8856, AUC 0.950584352016449, avg_entr 0.07751792669296265, f1 0.8855999708175659
ep15_l2_test_time 0.566813642999989
Test Epoch15 layer3 Acc 0.8866, AUC 0.947281002998352, avg_entr 0.03465966135263443, f1 0.8866000771522522
ep15_l3_test_time 0.5673284470000226
Test Epoch15 layer4 Acc 0.8862, AUC 0.9491103887557983, avg_entr 0.0230959951877594, f1 0.8862000107765198
ep15_l4_test_time 0.5692329919999963
gc 0
Train Epoch16 Acc 0.97115 (38846/40000), AUC 0.9952826499938965
ep16_train_time 6.805917387999983
Test Epoch16 layer0 Acc 0.8844, AUC 0.9478391408920288, avg_entr 0.12012554705142975, f1 0.8844000101089478
ep16_l0_test_time 0.5676163129999736
Test Epoch16 layer1 Acc 0.8842, AUC 0.9491546154022217, avg_entr 0.09957891702651978, f1 0.8842000365257263
ep16_l1_test_time 0.5734822579999843
Test Epoch16 layer2 Acc 0.8838, AUC 0.9499484896659851, avg_entr 0.07558846473693848, f1 0.8838000297546387
ep16_l2_test_time 0.5718092290000243
Test Epoch16 layer3 Acc 0.8844, AUC 0.9461954832077026, avg_entr 0.03288988769054413, f1 0.8844000101089478
ep16_l3_test_time 0.5723880429999895
Test Epoch16 layer4 Acc 0.8844, AUC 0.948050320148468, avg_entr 0.021746251732110977, f1 0.8844000101089478
ep16_l4_test_time 0.5724570140000083
gc 0
Train Epoch17 Acc 0.972275 (38891/40000), AUC 0.9957009553909302
ep17_train_time 6.816904665999999
Test Epoch17 layer0 Acc 0.8832, AUC 0.9475152492523193, avg_entr 0.1195695772767067, f1 0.8831999897956848
ep17_l0_test_time 0.569738416000007
Test Epoch17 layer1 Acc 0.883, AUC 0.9488507509231567, avg_entr 0.09921703487634659, f1 0.8830000162124634
ep17_l1_test_time 0.5685631249999972
Test Epoch17 layer2 Acc 0.883, AUC 0.94965660572052, avg_entr 0.0747508704662323, f1 0.8830000162124634
ep17_l2_test_time 0.5689358589999927
Test Epoch17 layer3 Acc 0.8832, AUC 0.9462865591049194, avg_entr 0.03258941322565079, f1 0.8831999897956848
ep17_l3_test_time 0.5685823190000008
Test Epoch17 layer4 Acc 0.884, AUC 0.9489064812660217, avg_entr 0.021864287555217743, f1 0.8840000033378601
ep17_l4_test_time 0.5693803480000099
gc 0
Train Epoch18 Acc 0.972425 (38897/40000), AUC 0.9957014322280884
ep18_train_time 6.883807483999988
Test Epoch18 layer0 Acc 0.8818, AUC 0.9471405744552612, avg_entr 0.11832347512245178, f1 0.8818000555038452
ep18_l0_test_time 0.5666247220000002
Test Epoch18 layer1 Acc 0.883, AUC 0.948491096496582, avg_entr 0.09797006845474243, f1 0.8830000162124634
ep18_l1_test_time 0.5689718339999956
Test Epoch18 layer2 Acc 0.8838, AUC 0.9492120146751404, avg_entr 0.07311507314443588, f1 0.8838000297546387
ep18_l2_test_time 0.5813257429999794
Test Epoch18 layer3 Acc 0.8846, AUC 0.9442049264907837, avg_entr 0.03253557160496712, f1 0.8845999836921692
ep18_l3_test_time 0.5702568629999973
Test Epoch18 layer4 Acc 0.8846, AUC 0.9448639154434204, avg_entr 0.022158604115247726, f1 0.8845999836921692
ep18_l4_test_time 0.5700001460000124
gc 0
Train Epoch19 Acc 0.9727 (38908/40000), AUC 0.9958094954490662
ep19_train_time 6.7853425379999806
Test Epoch19 layer0 Acc 0.8824, AUC 0.9468375444412231, avg_entr 0.11783886700868607, f1 0.8823999762535095
ep19_l0_test_time 0.56850876499999
Test Epoch19 layer1 Acc 0.8828, AUC 0.9482171535491943, avg_entr 0.09764107316732407, f1 0.8827999830245972
ep19_l1_test_time 0.5691137180000112
Test Epoch19 layer2 Acc 0.8818, AUC 0.9490015506744385, avg_entr 0.07273918390274048, f1 0.8818000555038452
ep19_l2_test_time 0.5782971790000033
Test Epoch19 layer3 Acc 0.882, AUC 0.9447664022445679, avg_entr 0.03154510632157326, f1 0.8820000290870667
ep19_l3_test_time 0.5683569199999852
Test Epoch19 layer4 Acc 0.8814, AUC 0.9463187456130981, avg_entr 0.021193377673625946, f1 0.8813999891281128
ep19_l4_test_time 0.5685036810000099
gc 0
Train Epoch20 Acc 0.97285 (38914/40000), AUC 0.9958279132843018
ep20_train_time 6.795035890999998
Test Epoch20 layer0 Acc 0.8818, AUC 0.9465742111206055, avg_entr 0.11689090728759766, f1 0.8818000555038452
ep20_l0_test_time 0.5706317389999924
Test Epoch20 layer1 Acc 0.8814, AUC 0.9479665160179138, avg_entr 0.09675798565149307, f1 0.8813999891281128
ep20_l1_test_time 0.5676117779999856
Test Epoch20 layer2 Acc 0.8816, AUC 0.9487177729606628, avg_entr 0.07163486629724503, f1 0.881600022315979
ep20_l2_test_time 0.5695474999999988
Test Epoch20 layer3 Acc 0.8814, AUC 0.9447247982025146, avg_entr 0.03118542768061161, f1 0.8813999891281128
ep20_l3_test_time 0.579673841999977
Test Epoch20 layer4 Acc 0.8822, AUC 0.948043704032898, avg_entr 0.02115018293261528, f1 0.8822000026702881
ep20_l4_test_time 0.5708066629999848
gc 0
Train Epoch21 Acc 0.973375 (38935/40000), AUC 0.9960240125656128
ep21_train_time 6.821892012999996
Test Epoch21 layer0 Acc 0.8806, AUC 0.9464371204376221, avg_entr 0.11671368777751923, f1 0.8805999755859375
ep21_l0_test_time 0.5676786960000015
Test Epoch21 layer1 Acc 0.8814, AUC 0.9478477239608765, avg_entr 0.09656684845685959, f1 0.8813999891281128
ep21_l1_test_time 0.5644815619999974
Test Epoch21 layer2 Acc 0.8808, AUC 0.9486043453216553, avg_entr 0.07176107913255692, f1 0.8808000087738037
ep21_l2_test_time 0.565566543999978
Test Epoch21 layer3 Acc 0.8816, AUC 0.9446021318435669, avg_entr 0.031120583415031433, f1 0.881600022315979
ep21_l3_test_time 0.5675102280000033
Test Epoch21 layer4 Acc 0.8816, AUC 0.9473973512649536, avg_entr 0.02127639390528202, f1 0.881600022315979
ep21_l4_test_time 0.5702494180000031
gc 0
Train Epoch22 Acc 0.973625 (38945/40000), AUC 0.9961137771606445
ep22_train_time 6.739817286999994
Test Epoch22 layer0 Acc 0.8804, AUC 0.9462931752204895, avg_entr 0.11610899865627289, f1 0.8804000020027161
ep22_l0_test_time 0.5659885240000051
Test Epoch22 layer1 Acc 0.8802, AUC 0.9477090835571289, avg_entr 0.09606241434812546, f1 0.8802000284194946
ep22_l1_test_time 0.5656012700000019
Test Epoch22 layer2 Acc 0.8806, AUC 0.9484360218048096, avg_entr 0.07091415673494339, f1 0.8805999755859375
ep22_l2_test_time 0.5667610350000132
Test Epoch22 layer3 Acc 0.8816, AUC 0.9444159269332886, avg_entr 0.03090793825685978, f1 0.881600022315979
ep22_l3_test_time 0.5670505790000107
Test Epoch22 layer4 Acc 0.8828, AUC 0.9470654726028442, avg_entr 0.021246938034892082, f1 0.8827999830245972
ep22_l4_test_time 0.5709715350000124
gc 0
Train Epoch23 Acc 0.97365 (38946/40000), AUC 0.9961037039756775
ep23_train_time 6.8283792240000025
Test Epoch23 layer0 Acc 0.882, AUC 0.9461351633071899, avg_entr 0.11498845368623734, f1 0.8820000290870667
ep23_l0_test_time 0.5687798430000157
Test Epoch23 layer1 Acc 0.8828, AUC 0.9475663900375366, avg_entr 0.09502912312746048, f1 0.8827999830245972
ep23_l1_test_time 0.5717714210000224
Test Epoch23 layer2 Acc 0.8818, AUC 0.9482619762420654, avg_entr 0.06977912038564682, f1 0.8818000555038452
ep23_l2_test_time 0.5688512759999753
Test Epoch23 layer3 Acc 0.8822, AUC 0.9437181949615479, avg_entr 0.030133875086903572, f1 0.8822000026702881
ep23_l3_test_time 0.5697313240000312
Test Epoch23 layer4 Acc 0.8824, AUC 0.9463558197021484, avg_entr 0.020615698769688606, f1 0.8823999762535095
ep23_l4_test_time 0.569927674999974
gc 0
Train Epoch24 Acc 0.974025 (38961/40000), AUC 0.9960769414901733
ep24_train_time 6.783158154999967
Test Epoch24 layer0 Acc 0.8802, AUC 0.9459969997406006, avg_entr 0.11510607600212097, f1 0.8802000284194946
ep24_l0_test_time 0.5686867560000337
Test Epoch24 layer1 Acc 0.8804, AUC 0.947429358959198, avg_entr 0.09517800807952881, f1 0.8804000020027161
ep24_l1_test_time 0.5678214750000166
Test Epoch24 layer2 Acc 0.8808, AUC 0.9481375217437744, avg_entr 0.07010601460933685, f1 0.8808000087738037
ep24_l2_test_time 0.5667045719999919
Test Epoch24 layer3 Acc 0.8812, AUC 0.9442986249923706, avg_entr 0.03081517294049263, f1 0.8812000155448914
ep24_l3_test_time 0.5674893639999823
Test Epoch24 layer4 Acc 0.8816, AUC 0.9470436573028564, avg_entr 0.021333351731300354, f1 0.881600022315979
ep24_l4_test_time 0.5711558630000013
gc 0
Train Epoch25 Acc 0.97425 (38970/40000), AUC 0.9962493181228638
ep25_train_time 6.78092553099998
Test Epoch25 layer0 Acc 0.8806, AUC 0.9459335803985596, avg_entr 0.11496645212173462, f1 0.8805999755859375
ep25_l0_test_time 0.5684259989999987
Test Epoch25 layer1 Acc 0.8796, AUC 0.9473721981048584, avg_entr 0.09494727849960327, f1 0.8795999884605408
ep25_l1_test_time 0.5808536629999708
Test Epoch25 layer2 Acc 0.8802, AUC 0.9480700492858887, avg_entr 0.0698896273970604, f1 0.8802000284194946
ep25_l2_test_time 0.5740990660000307
Test Epoch25 layer3 Acc 0.8816, AUC 0.9440220594406128, avg_entr 0.030701901763677597, f1 0.881600022315979
ep25_l3_test_time 0.5804042949999939
Test Epoch25 layer4 Acc 0.8816, AUC 0.9469503164291382, avg_entr 0.02120584435760975, f1 0.881600022315979
ep25_l4_test_time 0.5684720389999711
gc 0
Train Epoch26 Acc 0.973975 (38959/40000), AUC 0.996199905872345
ep26_train_time 6.7721728590000225
Test Epoch26 layer0 Acc 0.88, AUC 0.945861279964447, avg_entr 0.11433488875627518, f1 0.8799999952316284
ep26_l0_test_time 0.5678851939999845
Test Epoch26 layer1 Acc 0.8804, AUC 0.9473081827163696, avg_entr 0.09439719468355179, f1 0.8804000020027161
ep26_l1_test_time 0.565613452999969
Test Epoch26 layer2 Acc 0.88, AUC 0.9479963779449463, avg_entr 0.06939806789159775, f1 0.8799999952316284
ep26_l2_test_time 0.5679541089999702
Test Epoch26 layer3 Acc 0.8816, AUC 0.9439424276351929, avg_entr 0.030260268598794937, f1 0.881600022315979
ep26_l3_test_time 0.5695044809999672
Test Epoch26 layer4 Acc 0.8816, AUC 0.9470608234405518, avg_entr 0.020975204184651375, f1 0.881600022315979
ep26_l4_test_time 0.5701377750000347
gc 0
Train Epoch27 Acc 0.97405 (38962/40000), AUC 0.9962579607963562
ep27_train_time 6.820042763999993
Test Epoch27 layer0 Acc 0.8796, AUC 0.9457708597183228, avg_entr 0.11379775404930115, f1 0.8795999884605408
ep27_l0_test_time 0.5689291660000322
Test Epoch27 layer1 Acc 0.8804, AUC 0.9472110271453857, avg_entr 0.09387322515249252, f1 0.8804000020027161
ep27_l1_test_time 0.5645838070000195
Test Epoch27 layer2 Acc 0.8808, AUC 0.9478967189788818, avg_entr 0.06877830624580383, f1 0.8808000087738037
ep27_l2_test_time 0.5705064120000429
Test Epoch27 layer3 Acc 0.8808, AUC 0.9435569643974304, avg_entr 0.030147066339850426, f1 0.8808000087738037
ep27_l3_test_time 0.5758114930000033
Test Epoch27 layer4 Acc 0.881, AUC 0.9465262293815613, avg_entr 0.020893247798085213, f1 0.8809999823570251
ep27_l4_test_time 0.5872992479999652
gc 0
Train Epoch28 Acc 0.97415 (38966/40000), AUC 0.996249794960022
ep28_train_time 6.824370695000027
Test Epoch28 layer0 Acc 0.8804, AUC 0.945723295211792, avg_entr 0.1132533922791481, f1 0.8804000020027161
ep28_l0_test_time 0.5713680679999698
Test Epoch28 layer1 Acc 0.88, AUC 0.9471877813339233, avg_entr 0.09347214549779892, f1 0.8799999952316284
ep28_l1_test_time 0.5660126559999981
Test Epoch28 layer2 Acc 0.8806, AUC 0.9478700160980225, avg_entr 0.0683325007557869, f1 0.8805999755859375
ep28_l2_test_time 0.5681126000000063
Test Epoch28 layer3 Acc 0.881, AUC 0.9437892436981201, avg_entr 0.029963549226522446, f1 0.8809999823570251
ep28_l3_test_time 0.5800194110000234
Test Epoch28 layer4 Acc 0.8812, AUC 0.9473234415054321, avg_entr 0.020800167694687843, f1 0.8812000155448914
ep28_l4_test_time 0.5693008759999998
gc 0
Train Epoch29 Acc 0.97395 (38958/40000), AUC 0.9963170886039734
ep29_train_time 6.7720085980000135
Test Epoch29 layer0 Acc 0.8804, AUC 0.9457079172134399, avg_entr 0.1132454127073288, f1 0.8804000020027161
ep29_l0_test_time 0.5668419550000294
Test Epoch29 layer1 Acc 0.879, AUC 0.9471656084060669, avg_entr 0.09340864419937134, f1 0.8790000081062317
ep29_l1_test_time 0.5653253940000127
Test Epoch29 layer2 Acc 0.8796, AUC 0.9478508830070496, avg_entr 0.06826884299516678, f1 0.8795999884605408
ep29_l2_test_time 0.5839275970000131
Test Epoch29 layer3 Acc 0.8816, AUC 0.9439525008201599, avg_entr 0.029980767518281937, f1 0.881600022315979
ep29_l3_test_time 0.5719929619999675
Test Epoch29 layer4 Acc 0.8816, AUC 0.9471278190612793, avg_entr 0.020807873457670212, f1 0.881600022315979
ep29_l4_test_time 0.5691168889999858
Best AUC tensor(0.8982) 5 3
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 292.483493984
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8878, AUC 0.9539253115653992, avg_entr 0.16131991147994995, f1 0.8877999782562256
l0_test_time 0.5659137279999982
Test layer1 Acc 0.89, AUC 0.9545896053314209, avg_entr 0.1388033628463745, f1 0.8899999856948853
l1_test_time 0.567924440000013
Test layer2 Acc 0.89, AUC 0.9548311233520508, avg_entr 0.12591427564620972, f1 0.8899999856948853
l2_test_time 0.5827148729999863
Test layer3 Acc 0.8906, AUC 0.9555351734161377, avg_entr 0.09191282838582993, f1 0.8906000256538391
l3_test_time 0.5940511750000042
Test layer4 Acc 0.8904, AUC 0.9546084403991699, avg_entr 0.05677461624145508, f1 0.8903999924659729
l4_test_time 0.5747073019999789
