total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.550055124
Start Training
gc 0
Train Epoch0 Acc 0.510975 (20439/40000), AUC 0.507247805595398
ep0_train_time 6.957835791999997
Test Epoch0 layer0 Acc 0.8128, AUC 0.890101969242096, avg_entr 0.5608762502670288, f1 0.8127999901771545
ep0_l0_test_time 0.5451317330000016
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6356, AUC 0.8921780586242676, avg_entr 0.6823840141296387, f1 0.6355999708175659
ep0_l1_test_time 0.5490746660000028
Test Epoch0 layer2 Acc 0.556, AUC 0.8134186863899231, avg_entr 0.6839484572410583, f1 0.5559999942779541
ep0_l2_test_time 0.5525392079999989
Test Epoch0 layer3 Acc 0.5562, AUC 0.8633832931518555, avg_entr 0.6848944425582886, f1 0.5562000274658203
ep0_l3_test_time 0.5597206459999988
Test Epoch0 layer4 Acc 0.5346, AUC 0.8622080087661743, avg_entr 0.686159610748291, f1 0.534600019454956
ep0_l4_test_time 0.5542738059999976
gc 0
Train Epoch1 Acc 0.82945 (33178/40000), AUC 0.9044715166091919
ep1_train_time 6.471098017999999
Test Epoch1 layer0 Acc 0.8774, AUC 0.9455487728118896, avg_entr 0.28862911462783813, f1 0.8773999810218811
ep1_l0_test_time 0.5488578390000001
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8776, AUC 0.9460189342498779, avg_entr 0.3355708122253418, f1 0.8776000142097473
ep1_l1_test_time 0.5535153780000002
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8804, AUC 0.9461226463317871, avg_entr 0.2404969036579132, f1 0.8804000020027161
ep1_l2_test_time 0.5492757370000021
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.8802, AUC 0.946073591709137, avg_entr 0.23995891213417053, f1 0.8802000284194946
ep1_l3_test_time 0.5531966449999999
Test Epoch1 layer4 Acc 0.8804, AUC 0.9461368322372437, avg_entr 0.23093174397945404, f1 0.8804000020027161
ep1_l4_test_time 0.5498695930000039
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.905475 (36219/40000), AUC 0.9643226861953735
ep2_train_time 6.447029954999998
Test Epoch2 layer0 Acc 0.8734, AUC 0.955075740814209, avg_entr 0.22167490422725677, f1 0.8733999729156494
ep2_l0_test_time 0.5444389439999995
Test Epoch2 layer1 Acc 0.8796, AUC 0.9553613662719727, avg_entr 0.20768354833126068, f1 0.8795999884605408
ep2_l1_test_time 0.546261193999996
Test Epoch2 layer2 Acc 0.8704, AUC 0.9555254578590393, avg_entr 0.1891123205423355, f1 0.8704000115394592
ep2_l2_test_time 0.5463858049999999
Test Epoch2 layer3 Acc 0.8678, AUC 0.9555031061172485, avg_entr 0.1789989322423935, f1 0.8677999973297119
ep2_l3_test_time 0.5470270049999968
Test Epoch2 layer4 Acc 0.869, AUC 0.9556142091751099, avg_entr 0.16214582324028015, f1 0.8690000176429749
ep2_l4_test_time 0.5468693109999947
gc 0
Train Epoch3 Acc 0.922875 (36915/40000), AUC 0.9755016565322876
ep3_train_time 6.355832092
Test Epoch3 layer0 Acc 0.8956, AUC 0.9581347703933716, avg_entr 0.19451433420181274, f1 0.8956000208854675
ep3_l0_test_time 0.5459249799999952
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.896, AUC 0.9584299921989441, avg_entr 0.1748807430267334, f1 0.8960000276565552
ep3_l1_test_time 0.5469556540000013
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8948, AUC 0.9587255716323853, avg_entr 0.16321459412574768, f1 0.8948000073432922
ep3_l2_test_time 0.5574052870000017
Test Epoch3 layer3 Acc 0.8952, AUC 0.9586670398712158, avg_entr 0.1458863466978073, f1 0.8952000141143799
ep3_l3_test_time 0.5580235649999992
Test Epoch3 layer4 Acc 0.8944, AUC 0.9589264392852783, avg_entr 0.12468086928129196, f1 0.8944000005722046
ep3_l4_test_time 0.5538102140000021
gc 0
Train Epoch4 Acc 0.934275 (37371/40000), AUC 0.9815758466720581
ep4_train_time 6.398634842999996
Test Epoch4 layer0 Acc 0.8976, AUC 0.958969235420227, avg_entr 0.17814227938652039, f1 0.897599995136261
ep4_l0_test_time 0.5502249939999899
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.899, AUC 0.9593569040298462, avg_entr 0.15913288295269012, f1 0.8989999890327454
ep4_l1_test_time 0.5499659800000103
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.899, AUC 0.9597540497779846, avg_entr 0.14913153648376465, f1 0.8989999890327454
ep4_l2_test_time 0.5534611400000102
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer3 Acc 0.902, AUC 0.9598870873451233, avg_entr 0.11993469297885895, f1 0.9020000100135803
ep4_l3_test_time 0.5506513769999941
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer4 Acc 0.9006, AUC 0.960319459438324, avg_entr 0.08917700499296188, f1 0.900600016117096
ep4_l4_test_time 0.5488561629999964
gc 0
Train Epoch5 Acc 0.942575 (37703/40000), AUC 0.9852463603019714
ep5_train_time 6.456013932999994
Test Epoch5 layer0 Acc 0.8906, AUC 0.9586742520332336, avg_entr 0.16919386386871338, f1 0.8906000256538391
ep5_l0_test_time 0.5438772129999876
Test Epoch5 layer1 Acc 0.8922, AUC 0.9592469930648804, avg_entr 0.14967773854732513, f1 0.8921999931335449
ep5_l1_test_time 0.5471762879999886
Test Epoch5 layer2 Acc 0.8908, AUC 0.9597585201263428, avg_entr 0.13742856681346893, f1 0.8907999992370605
ep5_l2_test_time 0.5487166270000046
Test Epoch5 layer3 Acc 0.89, AUC 0.9600754976272583, avg_entr 0.10174248367547989, f1 0.8899999856948853
ep5_l3_test_time 0.5485308129999993
Test Epoch5 layer4 Acc 0.8906, AUC 0.9596883654594421, avg_entr 0.07021820545196533, f1 0.8906000256538391
ep5_l4_test_time 0.5475874790000006
gc 0
Train Epoch6 Acc 0.948275 (37931/40000), AUC 0.987426221370697
ep6_train_time 6.4584662789999925
Test Epoch6 layer0 Acc 0.894, AUC 0.9575954675674438, avg_entr 0.15696756541728973, f1 0.8939999938011169
ep6_l0_test_time 0.5453785450000055
Test Epoch6 layer1 Acc 0.8954, AUC 0.9581985473632812, avg_entr 0.1373690813779831, f1 0.8953999876976013
ep6_l1_test_time 0.5438821730000001
Test Epoch6 layer2 Acc 0.892, AUC 0.9589676856994629, avg_entr 0.12367267906665802, f1 0.8920000195503235
ep6_l2_test_time 0.546955471000004
Test Epoch6 layer3 Acc 0.892, AUC 0.9593960046768188, avg_entr 0.0804966390132904, f1 0.8920000195503235
ep6_l3_test_time 0.546772916000009
Test Epoch6 layer4 Acc 0.8942, AUC 0.9576936364173889, avg_entr 0.05126931890845299, f1 0.8942000269889832
ep6_l4_test_time 0.5494341100000071
gc 0
Train Epoch7 Acc 0.954975 (38199/40000), AUC 0.9889203906059265
ep7_train_time 6.483856274000004
Test Epoch7 layer0 Acc 0.8958, AUC 0.9561926126480103, avg_entr 0.14777280390262604, f1 0.895799994468689
ep7_l0_test_time 0.547105411000004
Test Epoch7 layer1 Acc 0.8956, AUC 0.9568551778793335, avg_entr 0.12929315865039825, f1 0.8956000208854675
ep7_l1_test_time 0.5441301439999933
Test Epoch7 layer2 Acc 0.8956, AUC 0.9578655958175659, avg_entr 0.11363580077886581, f1 0.8956000208854675
ep7_l2_test_time 0.5459262269999954
Test Epoch7 layer3 Acc 0.8946, AUC 0.9582085609436035, avg_entr 0.06762927770614624, f1 0.894599974155426
ep7_l3_test_time 0.5469959249999903
Test Epoch7 layer4 Acc 0.895, AUC 0.9544491767883301, avg_entr 0.04340292513370514, f1 0.8949999809265137
ep7_l4_test_time 0.5493032540000087
gc 0
Train Epoch8 Acc 0.9588 (38352/40000), AUC 0.9906531572341919
ep8_train_time 6.42578958
Test Epoch8 layer0 Acc 0.8952, AUC 0.9543576240539551, avg_entr 0.13940156996250153, f1 0.8952000141143799
ep8_l0_test_time 0.5453648750000042
Test Epoch8 layer1 Acc 0.894, AUC 0.9550439119338989, avg_entr 0.12170632183551788, f1 0.8939999938011169
ep8_l1_test_time 0.5431554949999935
Test Epoch8 layer2 Acc 0.894, AUC 0.9560848474502563, avg_entr 0.10373076051473618, f1 0.8939999938011169
ep8_l2_test_time 0.5475762459999913
Test Epoch8 layer3 Acc 0.8944, AUC 0.9559206366539001, avg_entr 0.05534220486879349, f1 0.8944000005722046
ep8_l3_test_time 0.5579295760000065
Test Epoch8 layer4 Acc 0.894, AUC 0.9522511959075928, avg_entr 0.03602597117424011, f1 0.8939999938011169
ep8_l4_test_time 0.5465764770000021
gc 0
Train Epoch9 Acc 0.963075 (38523/40000), AUC 0.9925521612167358
ep9_train_time 6.40383095
Test Epoch9 layer0 Acc 0.893, AUC 0.9534227848052979, avg_entr 0.13528770208358765, f1 0.8930000066757202
ep9_l0_test_time 0.5431224050000054
Test Epoch9 layer1 Acc 0.8932, AUC 0.9542615413665771, avg_entr 0.11681750416755676, f1 0.8931999802589417
ep9_l1_test_time 0.5445480129999964
Test Epoch9 layer2 Acc 0.8934, AUC 0.955329179763794, avg_entr 0.09635958075523376, f1 0.8934000134468079
ep9_l2_test_time 0.5484051650000055
Test Epoch9 layer3 Acc 0.8924, AUC 0.9542891979217529, avg_entr 0.048745863139629364, f1 0.8923999667167664
ep9_l3_test_time 0.5474697749999962
Test Epoch9 layer4 Acc 0.8924, AUC 0.9505285024642944, avg_entr 0.03141007199883461, f1 0.8923999667167664
ep9_l4_test_time 0.5550723579999897
gc 0
Train Epoch10 Acc 0.9655 (38620/40000), AUC 0.9929648041725159
ep10_train_time 6.452378230000008
Test Epoch10 layer0 Acc 0.8904, AUC 0.9525464773178101, avg_entr 0.1318342536687851, f1 0.8903999924659729
ep10_l0_test_time 0.5473427919999949
Test Epoch10 layer1 Acc 0.8918, AUC 0.9533410668373108, avg_entr 0.11442495137453079, f1 0.8917999863624573
ep10_l1_test_time 0.5447145170000027
Test Epoch10 layer2 Acc 0.8922, AUC 0.9544806480407715, avg_entr 0.09399007260799408, f1 0.8921999931335449
ep10_l2_test_time 0.5453208819999986
Test Epoch10 layer3 Acc 0.8916, AUC 0.95316481590271, avg_entr 0.045732103288173676, f1 0.8916000127792358
ep10_l3_test_time 0.5449197740000074
Test Epoch10 layer4 Acc 0.8912, AUC 0.9509955048561096, avg_entr 0.030136171728372574, f1 0.8912000060081482
ep10_l4_test_time 0.547274415000004
gc 0
Train Epoch11 Acc 0.96665 (38666/40000), AUC 0.9938013553619385
ep11_train_time 6.438486622999989
Test Epoch11 layer0 Acc 0.89, AUC 0.9512062072753906, avg_entr 0.12967590987682343, f1 0.8899999856948853
ep11_l0_test_time 0.5441254530000208
Test Epoch11 layer1 Acc 0.889, AUC 0.9520976543426514, avg_entr 0.1121625006198883, f1 0.8889999985694885
ep11_l1_test_time 0.5452961800000082
Test Epoch11 layer2 Acc 0.8894, AUC 0.9531909227371216, avg_entr 0.09022566676139832, f1 0.8894000053405762
ep11_l2_test_time 0.5455679030000056
Test Epoch11 layer3 Acc 0.8892, AUC 0.951337456703186, avg_entr 0.04295353218913078, f1 0.88919997215271
ep11_l3_test_time 0.5479175740000244
Test Epoch11 layer4 Acc 0.8898, AUC 0.9496846199035645, avg_entr 0.02821977809071541, f1 0.8898000121116638
ep11_l4_test_time 0.5464619600000162
gc 0
Train Epoch12 Acc 0.96805 (38722/40000), AUC 0.9941415786743164
ep12_train_time 6.448667871999987
Test Epoch12 layer0 Acc 0.8876, AUC 0.9504220485687256, avg_entr 0.12593446671962738, f1 0.8876000046730042
ep12_l0_test_time 0.5592950850000022
Test Epoch12 layer1 Acc 0.888, AUC 0.9514345526695251, avg_entr 0.10867349803447723, f1 0.8880000114440918
ep12_l1_test_time 0.5420234769999865
Test Epoch12 layer2 Acc 0.8892, AUC 0.9524405598640442, avg_entr 0.08480001240968704, f1 0.88919997215271
ep12_l2_test_time 0.5428994009999997
Test Epoch12 layer3 Acc 0.8888, AUC 0.949876070022583, avg_entr 0.04009867087006569, f1 0.8888000249862671
ep12_l3_test_time 0.5446260569999879
Test Epoch12 layer4 Acc 0.8882, AUC 0.9486282467842102, avg_entr 0.026888683438301086, f1 0.888200044631958
ep12_l4_test_time 0.5477991870000096
gc 0
Train Epoch13 Acc 0.969925 (38797/40000), AUC 0.9946877956390381
ep13_train_time 6.409767189999997
Test Epoch13 layer0 Acc 0.8834, AUC 0.9496067762374878, avg_entr 0.1244666650891304, f1 0.8834000825881958
ep13_l0_test_time 0.5419148409999934
Test Epoch13 layer1 Acc 0.8878, AUC 0.9505598545074463, avg_entr 0.1072656512260437, f1 0.8877999782562256
ep13_l1_test_time 0.5403951259999928
Test Epoch13 layer2 Acc 0.8878, AUC 0.9515435695648193, avg_entr 0.08322586864233017, f1 0.8877999782562256
ep13_l2_test_time 0.588731805000009
Test Epoch13 layer3 Acc 0.8858, AUC 0.9479373693466187, avg_entr 0.038881976157426834, f1 0.8858000040054321
ep13_l3_test_time 0.5533409459999916
Test Epoch13 layer4 Acc 0.8866, AUC 0.9455037117004395, avg_entr 0.02655050903558731, f1 0.8866000771522522
ep13_l4_test_time 0.5471873129999949
gc 0
Train Epoch14 Acc 0.970625 (38825/40000), AUC 0.9949126839637756
ep14_train_time 6.382007288000011
Test Epoch14 layer0 Acc 0.8842, AUC 0.9490100145339966, avg_entr 0.1231304332613945, f1 0.8842000365257263
ep14_l0_test_time 0.5443297889999883
Test Epoch14 layer1 Acc 0.8872, AUC 0.9499872326850891, avg_entr 0.10623052716255188, f1 0.8871999979019165
ep14_l1_test_time 0.5490283450000106
Test Epoch14 layer2 Acc 0.8874, AUC 0.9510159492492676, avg_entr 0.08224033564329147, f1 0.8873999714851379
ep14_l2_test_time 0.5451024719999964
Test Epoch14 layer3 Acc 0.8866, AUC 0.9477254152297974, avg_entr 0.037674255669116974, f1 0.8866000771522522
ep14_l3_test_time 0.5497623610000062
Test Epoch14 layer4 Acc 0.8868, AUC 0.946527361869812, avg_entr 0.025484267622232437, f1 0.8867999911308289
ep14_l4_test_time 0.5488061549999941
gc 0
Train Epoch15 Acc 0.970825 (38833/40000), AUC 0.9949866533279419
ep15_train_time 6.455475164999996
Test Epoch15 layer0 Acc 0.884, AUC 0.9486877918243408, avg_entr 0.12211272120475769, f1 0.8840000033378601
ep15_l0_test_time 0.546569121999994
Test Epoch15 layer1 Acc 0.8852, AUC 0.9498715400695801, avg_entr 0.10544899851083755, f1 0.8852000832557678
ep15_l1_test_time 0.5454736419999904
Test Epoch15 layer2 Acc 0.8858, AUC 0.9508482217788696, avg_entr 0.08069022744894028, f1 0.8858000040054321
ep15_l2_test_time 0.5449609159999795
Test Epoch15 layer3 Acc 0.8854, AUC 0.9480799436569214, avg_entr 0.03613106906414032, f1 0.8853999972343445
ep15_l3_test_time 0.5484853029999783
Test Epoch15 layer4 Acc 0.8852, AUC 0.9470664262771606, avg_entr 0.024454159662127495, f1 0.8852000832557678
ep15_l4_test_time 0.5493887240000106
gc 0
Train Epoch16 Acc 0.9717 (38868/40000), AUC 0.995045006275177
ep16_train_time 6.630557717000016
Test Epoch16 layer0 Acc 0.8852, AUC 0.9479736089706421, avg_entr 0.12082362174987793, f1 0.8852000832557678
ep16_l0_test_time 0.5432929810000076
Test Epoch16 layer1 Acc 0.8836, AUC 0.949151337146759, avg_entr 0.10401320457458496, f1 0.8835999965667725
ep16_l1_test_time 0.5434001780000131
Test Epoch16 layer2 Acc 0.885, AUC 0.9501396417617798, avg_entr 0.07913803309202194, f1 0.8849999904632568
ep16_l2_test_time 0.5508304150000072
Test Epoch16 layer3 Acc 0.885, AUC 0.9472417831420898, avg_entr 0.03472549468278885, f1 0.8849999904632568
ep16_l3_test_time 0.5467716280000161
Test Epoch16 layer4 Acc 0.8846, AUC 0.9477418661117554, avg_entr 0.023263735696673393, f1 0.8845999836921692
ep16_l4_test_time 0.5443187210000247
gc 0
Train Epoch17 Acc 0.9724 (38896/40000), AUC 0.9953491687774658
ep17_train_time 6.402516574999993
Test Epoch17 layer0 Acc 0.8844, AUC 0.9476654529571533, avg_entr 0.12039050459861755, f1 0.8844000101089478
ep17_l0_test_time 0.5475565000000131
Test Epoch17 layer1 Acc 0.8842, AUC 0.9489113092422485, avg_entr 0.1035807877779007, f1 0.8842000365257263
ep17_l1_test_time 0.5421041669999909
Test Epoch17 layer2 Acc 0.8838, AUC 0.9498835206031799, avg_entr 0.0783335268497467, f1 0.8838000297546387
ep17_l2_test_time 0.5462033679999934
Test Epoch17 layer3 Acc 0.885, AUC 0.9465770721435547, avg_entr 0.03447774797677994, f1 0.8849999904632568
ep17_l3_test_time 0.5463791290000017
Test Epoch17 layer4 Acc 0.8848, AUC 0.9462292194366455, avg_entr 0.02318033203482628, f1 0.8848000168800354
ep17_l4_test_time 0.546872828000005
gc 0
Train Epoch18 Acc 0.97265 (38906/40000), AUC 0.9957572221755981
ep18_train_time 6.33713709700001
Test Epoch18 layer0 Acc 0.884, AUC 0.9473809599876404, avg_entr 0.11930462718009949, f1 0.8840000033378601
ep18_l0_test_time 0.544050814000002
Test Epoch18 layer1 Acc 0.8836, AUC 0.9486604332923889, avg_entr 0.10272612422704697, f1 0.8835999965667725
ep18_l1_test_time 0.556605798000021
Test Epoch18 layer2 Acc 0.8838, AUC 0.9496253132820129, avg_entr 0.07706122100353241, f1 0.8838000297546387
ep18_l2_test_time 0.5533357609999996
Test Epoch18 layer3 Acc 0.8838, AUC 0.9464539289474487, avg_entr 0.033749546855688095, f1 0.8838000297546387
ep18_l3_test_time 0.5482945939999979
Test Epoch18 layer4 Acc 0.8838, AUC 0.9469336867332458, avg_entr 0.022821474820375443, f1 0.8838000297546387
ep18_l4_test_time 0.5495555009999862
gc 0
Train Epoch19 Acc 0.9732 (38928/40000), AUC 0.9957178235054016
ep19_train_time 6.434406341999988
Test Epoch19 layer0 Acc 0.8814, AUC 0.9469425678253174, avg_entr 0.1179732158780098, f1 0.8813999891281128
ep19_l0_test_time 0.5448313589999998
Test Epoch19 layer1 Acc 0.884, AUC 0.9481637477874756, avg_entr 0.10144534707069397, f1 0.8840000033378601
ep19_l1_test_time 0.5437419409999791
Test Epoch19 layer2 Acc 0.8836, AUC 0.9490697383880615, avg_entr 0.07606320083141327, f1 0.8835999965667725
ep19_l2_test_time 0.5462631249999959
Test Epoch19 layer3 Acc 0.8844, AUC 0.9455656409263611, avg_entr 0.03307955339550972, f1 0.8844000101089478
ep19_l3_test_time 0.5525241259999802
Test Epoch19 layer4 Acc 0.8852, AUC 0.9463257789611816, avg_entr 0.022530723363161087, f1 0.8852000832557678
ep19_l4_test_time 0.5530903439999975
gc 0
Train Epoch20 Acc 0.973425 (38937/40000), AUC 0.9956740140914917
ep20_train_time 6.416425056999998
Test Epoch20 layer0 Acc 0.8818, AUC 0.946770429611206, avg_entr 0.11698039621114731, f1 0.8818000555038452
ep20_l0_test_time 0.5435609530000249
Test Epoch20 layer1 Acc 0.8832, AUC 0.9480307102203369, avg_entr 0.100305937230587, f1 0.8831999897956848
ep20_l1_test_time 0.5450120330000061
Test Epoch20 layer2 Acc 0.8832, AUC 0.9489221572875977, avg_entr 0.07455158978700638, f1 0.8831999897956848
ep20_l2_test_time 0.5466235890000064
Test Epoch20 layer3 Acc 0.8828, AUC 0.9451671838760376, avg_entr 0.03230712562799454, f1 0.8827999830245972
ep20_l3_test_time 0.5476770399999964
Test Epoch20 layer4 Acc 0.8838, AUC 0.9461847543716431, avg_entr 0.022072311490774155, f1 0.8838000297546387
ep20_l4_test_time 0.5475867490000041
gc 0
Train Epoch21 Acc 0.973725 (38949/40000), AUC 0.9958882331848145
ep21_train_time 6.460088746999986
Test Epoch21 layer0 Acc 0.8814, AUC 0.9466478228569031, avg_entr 0.11833831667900085, f1 0.8813999891281128
ep21_l0_test_time 0.5452021069999944
Test Epoch21 layer1 Acc 0.8804, AUC 0.9480034112930298, avg_entr 0.10152217000722885, f1 0.8804000020027161
ep21_l1_test_time 0.5426788409999972
Test Epoch21 layer2 Acc 0.8812, AUC 0.948922336101532, avg_entr 0.07591864466667175, f1 0.8812000155448914
ep21_l2_test_time 0.5472407230000158
Test Epoch21 layer3 Acc 0.8816, AUC 0.9453617930412292, avg_entr 0.032900962978601456, f1 0.881600022315979
ep21_l3_test_time 0.5463202370000033
Test Epoch21 layer4 Acc 0.8818, AUC 0.945845365524292, avg_entr 0.021906308829784393, f1 0.8818000555038452
ep21_l4_test_time 0.5467012510000018
gc 0
Train Epoch22 Acc 0.97335 (38934/40000), AUC 0.9958547353744507
ep22_train_time 6.557182590999986
Test Epoch22 layer0 Acc 0.8814, AUC 0.9464876651763916, avg_entr 0.11693494021892548, f1 0.8813999891281128
ep22_l0_test_time 0.5457535500000006
Test Epoch22 layer1 Acc 0.8814, AUC 0.9478706121444702, avg_entr 0.10041413456201553, f1 0.8813999891281128
ep22_l1_test_time 0.5441183900000226
Test Epoch22 layer2 Acc 0.8808, AUC 0.9487568140029907, avg_entr 0.07436036318540573, f1 0.8808000087738037
ep22_l2_test_time 0.5448924819999945
Test Epoch22 layer3 Acc 0.8818, AUC 0.9456321001052856, avg_entr 0.031652163714170456, f1 0.8818000555038452
ep22_l3_test_time 0.5467995029999884
Test Epoch22 layer4 Acc 0.8822, AUC 0.9465172290802002, avg_entr 0.02129150927066803, f1 0.8822000026702881
ep22_l4_test_time 0.5481226099999787
gc 0
Train Epoch23 Acc 0.97375 (38950/40000), AUC 0.995944619178772
ep23_train_time 6.444686805999993
Test Epoch23 layer0 Acc 0.881, AUC 0.9462447166442871, avg_entr 0.11476361006498337, f1 0.8809999823570251
ep23_l0_test_time 0.5865892129999963
Test Epoch23 layer1 Acc 0.8824, AUC 0.9475208520889282, avg_entr 0.0983448252081871, f1 0.8823999762535095
ep23_l1_test_time 0.5644888419999745
Test Epoch23 layer2 Acc 0.8824, AUC 0.9484341144561768, avg_entr 0.07243867218494415, f1 0.8823999762535095
ep23_l2_test_time 0.5464334199999996
Test Epoch23 layer3 Acc 0.8824, AUC 0.9443433284759521, avg_entr 0.03130519762635231, f1 0.8823999762535095
ep23_l3_test_time 0.5451740359999917
Test Epoch23 layer4 Acc 0.8828, AUC 0.9450821876525879, avg_entr 0.02151062712073326, f1 0.8827999830245972
ep23_l4_test_time 0.5466730789999872
gc 0
Train Epoch24 Acc 0.974075 (38963/40000), AUC 0.9960523843765259
ep24_train_time 6.459270987999986
Test Epoch24 layer0 Acc 0.8812, AUC 0.9461851119995117, avg_entr 0.11542293429374695, f1 0.8812000155448914
ep24_l0_test_time 0.5604702899999836
Test Epoch24 layer1 Acc 0.8808, AUC 0.9475104212760925, avg_entr 0.09885331988334656, f1 0.8808000087738037
ep24_l1_test_time 0.5813255150000032
Test Epoch24 layer2 Acc 0.881, AUC 0.9484118223190308, avg_entr 0.07288005948066711, f1 0.8809999823570251
ep24_l2_test_time 0.5472891039999865
Test Epoch24 layer3 Acc 0.8812, AUC 0.9447917342185974, avg_entr 0.031151678413152695, f1 0.8812000155448914
ep24_l3_test_time 0.5477948129999959
Test Epoch24 layer4 Acc 0.8812, AUC 0.945885181427002, avg_entr 0.021006539463996887, f1 0.8812000155448914
ep24_l4_test_time 0.5471091889999968
gc 0
Train Epoch25 Acc 0.9743 (38972/40000), AUC 0.9961124062538147
ep25_train_time 6.440475808000002
Test Epoch25 layer0 Acc 0.881, AUC 0.9461092948913574, avg_entr 0.11419723182916641, f1 0.8809999823570251
ep25_l0_test_time 0.5465474169999993
Test Epoch25 layer1 Acc 0.8824, AUC 0.9474263787269592, avg_entr 0.0977364107966423, f1 0.8823999762535095
ep25_l1_test_time 0.543217889999994
Test Epoch25 layer2 Acc 0.8826, AUC 0.9483286142349243, avg_entr 0.07173366099596024, f1 0.8826000094413757
ep25_l2_test_time 0.5456016649999924
Test Epoch25 layer3 Acc 0.8812, AUC 0.9440921545028687, avg_entr 0.030636493116617203, f1 0.8812000155448914
ep25_l3_test_time 0.5480724070000065
Test Epoch25 layer4 Acc 0.8814, AUC 0.9445230960845947, avg_entr 0.021046007052063942, f1 0.8813999891281128
ep25_l4_test_time 0.5547698299999979
gc 0
Train Epoch26 Acc 0.974475 (38979/40000), AUC 0.9961704015731812
ep26_train_time 6.434141391999958
Test Epoch26 layer0 Acc 0.8806, AUC 0.9460674524307251, avg_entr 0.11491478234529495, f1 0.8805999755859375
ep26_l0_test_time 0.5436162349999449
Test Epoch26 layer1 Acc 0.8804, AUC 0.9474602937698364, avg_entr 0.09845446795225143, f1 0.8804000020027161
ep26_l1_test_time 0.5434014200000092
Test Epoch26 layer2 Acc 0.8798, AUC 0.9483513832092285, avg_entr 0.07236311584711075, f1 0.879800021648407
ep26_l2_test_time 0.5484409729999697
Test Epoch26 layer3 Acc 0.8812, AUC 0.9448286890983582, avg_entr 0.030703485012054443, f1 0.8812000155448914
ep26_l3_test_time 0.5447568029999843
Test Epoch26 layer4 Acc 0.8818, AUC 0.945654034614563, avg_entr 0.020743414759635925, f1 0.8818000555038452
ep26_l4_test_time 0.5473338799999965
gc 0
Train Epoch27 Acc 0.9744 (38976/40000), AUC 0.9960669279098511
ep27_train_time 6.387062177000018
Test Epoch27 layer0 Acc 0.8816, AUC 0.945949912071228, avg_entr 0.1135522797703743, f1 0.881600022315979
ep27_l0_test_time 0.5461680430000229
Test Epoch27 layer1 Acc 0.8816, AUC 0.9473068714141846, avg_entr 0.09715379774570465, f1 0.881600022315979
ep27_l1_test_time 0.5416005629999745
Test Epoch27 layer2 Acc 0.8818, AUC 0.9482055902481079, avg_entr 0.07122766226530075, f1 0.8818000555038452
ep27_l2_test_time 0.5693379639999989
Test Epoch27 layer3 Acc 0.882, AUC 0.9443789720535278, avg_entr 0.030247380957007408, f1 0.8820000290870667
ep27_l3_test_time 0.6005517030000078
Test Epoch27 layer4 Acc 0.8822, AUC 0.9455728530883789, avg_entr 0.02075343392789364, f1 0.8822000026702881
ep27_l4_test_time 0.5470541710000134
gc 0
Train Epoch28 Acc 0.974 (38960/40000), AUC 0.9961274862289429
ep28_train_time 6.4413614559999814
Test Epoch28 layer0 Acc 0.8818, AUC 0.9458860158920288, avg_entr 0.1131008192896843, f1 0.8818000555038452
ep28_l0_test_time 0.5625898170000028
Test Epoch28 layer1 Acc 0.8802, AUC 0.9472334980964661, avg_entr 0.09675177931785583, f1 0.8802000284194946
ep28_l1_test_time 0.5460039879999954
Test Epoch28 layer2 Acc 0.8814, AUC 0.9481205940246582, avg_entr 0.07073081284761429, f1 0.8813999891281128
ep28_l2_test_time 0.5468483800000286
Test Epoch28 layer3 Acc 0.8814, AUC 0.9444715976715088, avg_entr 0.030078936368227005, f1 0.8813999891281128
ep28_l3_test_time 0.5486924420000037
Test Epoch28 layer4 Acc 0.8816, AUC 0.9457337856292725, avg_entr 0.0205882228910923, f1 0.881600022315979
ep28_l4_test_time 0.5491255899999601
gc 0
Train Epoch29 Acc 0.97435 (38974/40000), AUC 0.9961727857589722
ep29_train_time 6.4526977030000126
Test Epoch29 layer0 Acc 0.8818, AUC 0.945857584476471, avg_entr 0.11273132264614105, f1 0.8818000555038452
ep29_l0_test_time 0.5468412700000158
Test Epoch29 layer1 Acc 0.8816, AUC 0.9471989870071411, avg_entr 0.09633604437112808, f1 0.881600022315979
ep29_l1_test_time 0.5423285910000004
Test Epoch29 layer2 Acc 0.8814, AUC 0.9480847120285034, avg_entr 0.07038073986768723, f1 0.8813999891281128
ep29_l2_test_time 0.5460707199999888
Test Epoch29 layer3 Acc 0.8816, AUC 0.9441355466842651, avg_entr 0.029903119429945946, f1 0.881600022315979
ep29_l3_test_time 0.5460916050000151
Test Epoch29 layer4 Acc 0.8828, AUC 0.9454507827758789, avg_entr 0.020539242774248123, f1 0.8827999830245972
ep29_l4_test_time 0.5461552219999817
Best AUC tensor(0.9020) 4 3
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 277.86735655399997
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8958, AUC 0.9558150768280029, avg_entr 0.17823339998722076, f1 0.895799994468689
l0_test_time 0.548225317999993
Test layer1 Acc 0.8972, AUC 0.9559915065765381, avg_entr 0.15979643166065216, f1 0.8971999883651733
l1_test_time 0.5494646839999859
Test layer2 Acc 0.8976, AUC 0.9564079642295837, avg_entr 0.15059669315814972, f1 0.897599995136261
l2_test_time 0.550098448999961
Test layer3 Acc 0.8982, AUC 0.9565697908401489, avg_entr 0.12242837250232697, f1 0.8981999754905701
l3_test_time 0.5502381079999736
Test layer4 Acc 0.8974, AUC 0.9568464756011963, avg_entr 0.09255565702915192, f1 0.8974000215530396
l4_test_time 0.5508492250000359
