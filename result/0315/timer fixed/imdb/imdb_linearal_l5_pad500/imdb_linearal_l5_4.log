total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.548259432000002
Start Training
gc 0
Train Epoch0 Acc 0.49885 (19954/40000), AUC 0.4906107783317566
ep0_train_time 6.788739593999999
Test Epoch0 layer0 Acc 0.8176, AUC 0.8903397917747498, avg_entr 0.579032301902771, f1 0.8176000118255615
ep0_l0_test_time 0.5460155899999997
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.771, AUC 0.8726718425750732, avg_entr 0.6893736720085144, f1 0.7710000276565552
ep0_l1_test_time 0.5445120579999987
Test Epoch0 layer2 Acc 0.6786, AUC 0.8149191737174988, avg_entr 0.6918721795082092, f1 0.678600013256073
ep0_l2_test_time 0.5457839829999998
Test Epoch0 layer3 Acc 0.6674, AUC 0.8274227380752563, avg_entr 0.6903114914894104, f1 0.6674000024795532
ep0_l3_test_time 0.5456401460000002
Test Epoch0 layer4 Acc 0.5352, AUC 0.7897513508796692, avg_entr 0.6909586191177368, f1 0.5351999998092651
ep0_l4_test_time 0.5468934789999977
gc 0
Train Epoch1 Acc 0.803925 (32157/40000), AUC 0.8831861615180969
ep1_train_time 6.360212468
Test Epoch1 layer0 Acc 0.8818, AUC 0.9454967975616455, avg_entr 0.2962920069694519, f1 0.8818000555038452
ep1_l0_test_time 0.5467807879999995
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.882, AUC 0.9459789991378784, avg_entr 0.3522251844406128, f1 0.8820000290870667
ep1_l1_test_time 0.5465717989999987
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8802, AUC 0.9463231563568115, avg_entr 0.24001815915107727, f1 0.8802000284194946
ep1_l2_test_time 0.547390753000002
Test Epoch1 layer3 Acc 0.882, AUC 0.946509599685669, avg_entr 0.2477881908416748, f1 0.8820000290870667
ep1_l3_test_time 0.5466648129999996
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.8798, AUC 0.9464228749275208, avg_entr 0.24453769624233246, f1 0.879800021648407
ep1_l4_test_time 0.5494276109999987
gc 0
Train Epoch2 Acc 0.9051 (36204/40000), AUC 0.9643258452415466
ep2_train_time 6.3342332199999944
Test Epoch2 layer0 Acc 0.8688, AUC 0.9548038840293884, avg_entr 0.22332429885864258, f1 0.8687999844551086
ep2_l0_test_time 0.5435508010000021
Test Epoch2 layer1 Acc 0.88, AUC 0.956034779548645, avg_entr 0.21641284227371216, f1 0.8799999952316284
ep2_l1_test_time 0.549351503000004
Test Epoch2 layer2 Acc 0.8794, AUC 0.9560930132865906, avg_entr 0.17883962392807007, f1 0.8794000148773193
ep2_l2_test_time 0.54388668
Test Epoch2 layer3 Acc 0.8772, AUC 0.9561257362365723, avg_entr 0.18288202583789825, f1 0.8772000074386597
ep2_l3_test_time 0.5442433070000021
Test Epoch2 layer4 Acc 0.88, AUC 0.9558578729629517, avg_entr 0.16762761771678925, f1 0.8799999952316284
ep2_l4_test_time 0.5454881960000009
gc 0
Train Epoch3 Acc 0.9225 (36900/40000), AUC 0.9751004576683044
ep3_train_time 6.43820848
Test Epoch3 layer0 Acc 0.8898, AUC 0.9583171606063843, avg_entr 0.1953546106815338, f1 0.8898000121116638
ep3_l0_test_time 0.5453570049999996
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.895, AUC 0.9591277837753296, avg_entr 0.18198208510875702, f1 0.8949999809265137
ep3_l1_test_time 0.5467519799999963
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8964, AUC 0.959274411201477, avg_entr 0.15160098671913147, f1 0.896399974822998
ep3_l2_test_time 0.549079221999996
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.899, AUC 0.9594607949256897, avg_entr 0.14693506062030792, f1 0.8989999890327454
ep3_l3_test_time 0.5495894749999977
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.9, AUC 0.9593751430511475, avg_entr 0.12000472098588943, f1 0.8999999761581421
ep3_l4_test_time 0.5505343239999974
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.93475 (37390/40000), AUC 0.9816204905509949
ep4_train_time 6.410394171000007
Test Epoch4 layer0 Acc 0.9002, AUC 0.9591530561447144, avg_entr 0.17883537709712982, f1 0.9002000093460083
ep4_l0_test_time 0.5452073179999957
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.9004, AUC 0.9598696827888489, avg_entr 0.16320662200450897, f1 0.9003999829292297
ep4_l1_test_time 0.5525551639999975
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8992, AUC 0.9600775241851807, avg_entr 0.13266314566135406, f1 0.8992000222206116
ep4_l2_test_time 0.5581962480000016
Test Epoch4 layer3 Acc 0.8972, AUC 0.9605011343955994, avg_entr 0.11828728020191193, f1 0.8971999883651733
ep4_l3_test_time 0.5556257840000001
Test Epoch4 layer4 Acc 0.8972, AUC 0.9607925415039062, avg_entr 0.08713225275278091, f1 0.8971999883651733
ep4_l4_test_time 0.549943730999999
gc 0
Train Epoch5 Acc 0.94395 (37758/40000), AUC 0.9853142499923706
ep5_train_time 6.447274532999998
Test Epoch5 layer0 Acc 0.8982, AUC 0.958458423614502, avg_entr 0.16383500397205353, f1 0.8981999754905701
ep5_l0_test_time 0.5457333090000134
Test Epoch5 layer1 Acc 0.899, AUC 0.9592818021774292, avg_entr 0.14826516807079315, f1 0.8989999890327454
ep5_l1_test_time 0.5462707779999931
Test Epoch5 layer2 Acc 0.8972, AUC 0.9597500562667847, avg_entr 0.11914337426424026, f1 0.8971999883651733
ep5_l2_test_time 0.5455780209999972
Test Epoch5 layer3 Acc 0.8964, AUC 0.9605382680892944, avg_entr 0.09656514972448349, f1 0.896399974822998
ep5_l3_test_time 0.5458328090000037
Test Epoch5 layer4 Acc 0.8966, AUC 0.960740327835083, avg_entr 0.06106812134385109, f1 0.8966000080108643
ep5_l4_test_time 0.5531187349999982
gc 0
Train Epoch6 Acc 0.949175 (37967/40000), AUC 0.9876301288604736
ep6_train_time 6.4070809870000005
Test Epoch6 layer0 Acc 0.8926, AUC 0.9571388959884644, avg_entr 0.15739068388938904, f1 0.8925999999046326
ep6_l0_test_time 0.5447743120000013
Test Epoch6 layer1 Acc 0.892, AUC 0.9578729867935181, avg_entr 0.14317955076694489, f1 0.8920000195503235
ep6_l1_test_time 0.5431108019999868
Test Epoch6 layer2 Acc 0.892, AUC 0.9588711261749268, avg_entr 0.11541540175676346, f1 0.8920000195503235
ep6_l2_test_time 0.5443825590000131
Test Epoch6 layer3 Acc 0.8912, AUC 0.9595043659210205, avg_entr 0.08365434408187866, f1 0.8912000060081482
ep6_l3_test_time 0.5492806250000086
Test Epoch6 layer4 Acc 0.8916, AUC 0.9582997560501099, avg_entr 0.05345005542039871, f1 0.8916000127792358
ep6_l4_test_time 0.5462085880000132
gc 0
Train Epoch7 Acc 0.953825 (38153/40000), AUC 0.9892607927322388
ep7_train_time 6.375811701999993
Test Epoch7 layer0 Acc 0.8966, AUC 0.9556268453598022, avg_entr 0.14385953545570374, f1 0.8966000080108643
ep7_l0_test_time 0.5444955069999935
Test Epoch7 layer1 Acc 0.8952, AUC 0.9568264484405518, avg_entr 0.13008692860603333, f1 0.8952000141143799
ep7_l1_test_time 0.5455433119999924
Test Epoch7 layer2 Acc 0.8956, AUC 0.9572945833206177, avg_entr 0.09994963556528091, f1 0.8956000208854675
ep7_l2_test_time 0.5456579780000084
Test Epoch7 layer3 Acc 0.897, AUC 0.9579387307167053, avg_entr 0.06441986560821533, f1 0.8970000147819519
ep7_l3_test_time 0.5560141739999978
Test Epoch7 layer4 Acc 0.8966, AUC 0.9544556140899658, avg_entr 0.040001243352890015, f1 0.8966000080108643
ep7_l4_test_time 0.5493431929999986
gc 0
Train Epoch8 Acc 0.95895 (38358/40000), AUC 0.9910238981246948
ep8_train_time 6.382079273000002
Test Epoch8 layer0 Acc 0.8884, AUC 0.9542398452758789, avg_entr 0.13692185282707214, f1 0.8884000182151794
ep8_l0_test_time 0.5437962620000008
Test Epoch8 layer1 Acc 0.8912, AUC 0.95543372631073, avg_entr 0.12310449033975601, f1 0.8912000060081482
ep8_l1_test_time 0.5415948410000055
Test Epoch8 layer2 Acc 0.8884, AUC 0.9562751054763794, avg_entr 0.0928770899772644, f1 0.8884000182151794
ep8_l2_test_time 0.5640455750000086
Test Epoch8 layer3 Acc 0.8898, AUC 0.9562827348709106, avg_entr 0.05427337810397148, f1 0.8898000121116638
ep8_l3_test_time 0.5457026999999925
Test Epoch8 layer4 Acc 0.8894, AUC 0.9510834217071533, avg_entr 0.03551938012242317, f1 0.8894000053405762
ep8_l4_test_time 0.5469019930000059
gc 0
Train Epoch9 Acc 0.964275 (38571/40000), AUC 0.992609977722168
ep9_train_time 6.392552984000005
Test Epoch9 layer0 Acc 0.8924, AUC 0.9533851742744446, avg_entr 0.13407732546329498, f1 0.8923999667167664
ep9_l0_test_time 0.5488426590000017
Test Epoch9 layer1 Acc 0.892, AUC 0.9546375274658203, avg_entr 0.11935960501432419, f1 0.8920000195503235
ep9_l1_test_time 0.5453501389999929
Test Epoch9 layer2 Acc 0.8922, AUC 0.9555677175521851, avg_entr 0.08942129462957382, f1 0.8921999931335449
ep9_l2_test_time 0.5446062759999961
Test Epoch9 layer3 Acc 0.8922, AUC 0.9552242159843445, avg_entr 0.04997870326042175, f1 0.8921999931335449
ep9_l3_test_time 0.5444476559999885
Test Epoch9 layer4 Acc 0.8918, AUC 0.9510493278503418, avg_entr 0.03112749569118023, f1 0.8917999863624573
ep9_l4_test_time 0.547512943000001
gc 0
Train Epoch10 Acc 0.965325 (38613/40000), AUC 0.9933063983917236
ep10_train_time 6.378534173999995
Test Epoch10 layer0 Acc 0.8904, AUC 0.9522615075111389, avg_entr 0.13172130286693573, f1 0.8903999924659729
ep10_l0_test_time 0.5447238520000042
Test Epoch10 layer1 Acc 0.8904, AUC 0.9536265134811401, avg_entr 0.1174636110663414, f1 0.8903999924659729
ep10_l1_test_time 0.5723105299999958
Test Epoch10 layer2 Acc 0.8906, AUC 0.9545042514801025, avg_entr 0.08755634725093842, f1 0.8906000256538391
ep10_l2_test_time 0.5488806480000079
Test Epoch10 layer3 Acc 0.8908, AUC 0.9537418484687805, avg_entr 0.04760138690471649, f1 0.8907999992370605
ep10_l3_test_time 0.5453399919999953
Test Epoch10 layer4 Acc 0.891, AUC 0.9516687393188477, avg_entr 0.029771115630865097, f1 0.890999972820282
ep10_l4_test_time 0.5454028750000077
gc 0
Train Epoch11 Acc 0.966825 (38673/40000), AUC 0.9937597513198853
ep11_train_time 6.389092475000012
Test Epoch11 layer0 Acc 0.8894, AUC 0.9512306451797485, avg_entr 0.12740394473075867, f1 0.8894000053405762
ep11_l0_test_time 0.5440098330000183
Test Epoch11 layer1 Acc 0.888, AUC 0.9526046514511108, avg_entr 0.11353890597820282, f1 0.8880000114440918
ep11_l1_test_time 0.5424529729999961
Test Epoch11 layer2 Acc 0.888, AUC 0.9535441994667053, avg_entr 0.08395685255527496, f1 0.8880000114440918
ep11_l2_test_time 0.5429305819999968
Test Epoch11 layer3 Acc 0.889, AUC 0.9522620439529419, avg_entr 0.04369030147790909, f1 0.8889999985694885
ep11_l3_test_time 0.5459825990000127
Test Epoch11 layer4 Acc 0.8888, AUC 0.9499378204345703, avg_entr 0.027898674830794334, f1 0.8888000249862671
ep11_l4_test_time 0.5453923009999926
gc 0
Train Epoch12 Acc 0.9688 (38752/40000), AUC 0.9943333864212036
ep12_train_time 6.36305049500001
Test Epoch12 layer0 Acc 0.8876, AUC 0.9499311447143555, avg_entr 0.12606649100780487, f1 0.8876000046730042
ep12_l0_test_time 0.5449155580000138
Test Epoch12 layer1 Acc 0.8886, AUC 0.9514379501342773, avg_entr 0.11252684146165848, f1 0.8885999917984009
ep12_l1_test_time 0.5443783370000119
Test Epoch12 layer2 Acc 0.8884, AUC 0.95223069190979, avg_entr 0.08224736899137497, f1 0.8884000182151794
ep12_l2_test_time 0.5452227089999724
Test Epoch12 layer3 Acc 0.8888, AUC 0.9499607682228088, avg_entr 0.043139830231666565, f1 0.8888000249862671
ep12_l3_test_time 0.5452343620000022
Test Epoch12 layer4 Acc 0.8896, AUC 0.946172833442688, avg_entr 0.027237683534622192, f1 0.8895999193191528
ep12_l4_test_time 0.5463234519999958
gc 0
Train Epoch13 Acc 0.9697 (38788/40000), AUC 0.9947280883789062
ep13_train_time 6.294130042000006
Test Epoch13 layer0 Acc 0.8864, AUC 0.9494791030883789, avg_entr 0.12521480023860931, f1 0.8863999843597412
ep13_l0_test_time 0.5433892430000071
Test Epoch13 layer1 Acc 0.887, AUC 0.950962483882904, avg_entr 0.1112343892455101, f1 0.8870000243186951
ep13_l1_test_time 0.5409710480000172
Test Epoch13 layer2 Acc 0.8872, AUC 0.951862096786499, avg_entr 0.08141595125198364, f1 0.8871999979019165
ep13_l2_test_time 0.5447972209999818
Test Epoch13 layer3 Acc 0.8884, AUC 0.9497336745262146, avg_entr 0.04096761345863342, f1 0.8884000182151794
ep13_l3_test_time 0.5464272920000042
Test Epoch13 layer4 Acc 0.8884, AUC 0.9475417137145996, avg_entr 0.02573329769074917, f1 0.8884000182151794
ep13_l4_test_time 0.5472007719999965
gc 0
Train Epoch14 Acc 0.970675 (38827/40000), AUC 0.9949870109558105
ep14_train_time 6.396265070999988
Test Epoch14 layer0 Acc 0.8862, AUC 0.9489235281944275, avg_entr 0.12381606549024582, f1 0.8862000107765198
ep14_l0_test_time 0.5444268850000071
Test Epoch14 layer1 Acc 0.8866, AUC 0.950419545173645, avg_entr 0.11006750166416168, f1 0.8866000771522522
ep14_l1_test_time 0.5588947529999757
Test Epoch14 layer2 Acc 0.8854, AUC 0.9513660669326782, avg_entr 0.08089247345924377, f1 0.8853999972343445
ep14_l2_test_time 0.5488766309999846
Test Epoch14 layer3 Acc 0.8862, AUC 0.949435830116272, avg_entr 0.040208302438259125, f1 0.8862000107765198
ep14_l3_test_time 0.560515903999999
Test Epoch14 layer4 Acc 0.8866, AUC 0.9486651420593262, avg_entr 0.025771869346499443, f1 0.8866000771522522
ep14_l4_test_time 0.5863716290000127
gc 0
Train Epoch15 Acc 0.971525 (38861/40000), AUC 0.995098352432251
ep15_train_time 6.3931843480000055
Test Epoch15 layer0 Acc 0.8844, AUC 0.9484044313430786, avg_entr 0.12229755520820618, f1 0.8844000101089478
ep15_l0_test_time 0.5505977580000092
Test Epoch15 layer1 Acc 0.8856, AUC 0.9499472975730896, avg_entr 0.10867734253406525, f1 0.8855999708175659
ep15_l1_test_time 0.5467502919999845
Test Epoch15 layer2 Acc 0.8838, AUC 0.9508298635482788, avg_entr 0.07920575886964798, f1 0.8838000297546387
ep15_l2_test_time 0.5483676689999868
Test Epoch15 layer3 Acc 0.8844, AUC 0.9484936594963074, avg_entr 0.0388866625726223, f1 0.8844000101089478
ep15_l3_test_time 0.5446933449999847
Test Epoch15 layer4 Acc 0.8846, AUC 0.9460363388061523, avg_entr 0.025064947083592415, f1 0.8845999836921692
ep15_l4_test_time 0.5459845330000235
gc 0
Train Epoch16 Acc 0.972075 (38883/40000), AUC 0.9953875541687012
ep16_train_time 6.389651256999997
Test Epoch16 layer0 Acc 0.8836, AUC 0.9476666450500488, avg_entr 0.1209910660982132, f1 0.8835999965667725
ep16_l0_test_time 0.5447034740000163
Test Epoch16 layer1 Acc 0.884, AUC 0.9492610096931458, avg_entr 0.10745801776647568, f1 0.8840000033378601
ep16_l1_test_time 0.5402985890000025
Test Epoch16 layer2 Acc 0.8826, AUC 0.9500815868377686, avg_entr 0.07752157002687454, f1 0.8826000094413757
ep16_l2_test_time 0.5446823709999933
Test Epoch16 layer3 Acc 0.8828, AUC 0.9473519325256348, avg_entr 0.03837736323475838, f1 0.8827999830245972
ep16_l3_test_time 0.5449738179999883
Test Epoch16 layer4 Acc 0.884, AUC 0.9462755918502808, avg_entr 0.024687182158231735, f1 0.8840000033378601
ep16_l4_test_time 0.5475556510000104
gc 0
Train Epoch17 Acc 0.97255 (38902/40000), AUC 0.9956883192062378
ep17_train_time 6.400177444999997
Test Epoch17 layer0 Acc 0.8848, AUC 0.9473972320556641, avg_entr 0.11880140751600266, f1 0.8848000168800354
ep17_l0_test_time 0.542613676000002
Test Epoch17 layer1 Acc 0.884, AUC 0.9489971399307251, avg_entr 0.10557912290096283, f1 0.8840000033378601
ep17_l1_test_time 0.5415921940000032
Test Epoch17 layer2 Acc 0.8844, AUC 0.9498341083526611, avg_entr 0.07493498176336288, f1 0.8844000101089478
ep17_l2_test_time 0.5789438480000229
Test Epoch17 layer3 Acc 0.884, AUC 0.9473429918289185, avg_entr 0.03553464636206627, f1 0.8840000033378601
ep17_l3_test_time 0.5451884800000073
Test Epoch17 layer4 Acc 0.8836, AUC 0.945568859577179, avg_entr 0.022595705464482307, f1 0.8835999965667725
ep17_l4_test_time 0.5450979119999886
gc 0
Train Epoch18 Acc 0.972975 (38919/40000), AUC 0.9956722259521484
ep18_train_time 6.387998621999998
Test Epoch18 layer0 Acc 0.8814, AUC 0.9471018314361572, avg_entr 0.12003819644451141, f1 0.8813999891281128
ep18_l0_test_time 0.5577265839999939
Test Epoch18 layer1 Acc 0.8838, AUC 0.9486595392227173, avg_entr 0.10641572624444962, f1 0.8838000297546387
ep18_l1_test_time 0.554113985000015
Test Epoch18 layer2 Acc 0.8834, AUC 0.9496155977249146, avg_entr 0.07660894840955734, f1 0.8834000825881958
ep18_l2_test_time 0.5446637340000109
Test Epoch18 layer3 Acc 0.8832, AUC 0.9473141431808472, avg_entr 0.03648087754845619, f1 0.8831999897956848
ep18_l3_test_time 0.5461985359999915
Test Epoch18 layer4 Acc 0.8834, AUC 0.9463375806808472, avg_entr 0.02365201525390148, f1 0.8834000825881958
ep18_l4_test_time 0.5530831760000012
gc 0
Train Epoch19 Acc 0.973475 (38939/40000), AUC 0.9957927465438843
ep19_train_time 6.36541756699998
Test Epoch19 layer0 Acc 0.8832, AUC 0.9468169212341309, avg_entr 0.11783646047115326, f1 0.8831999897956848
ep19_l0_test_time 0.548001346999996
Test Epoch19 layer1 Acc 0.882, AUC 0.9484257698059082, avg_entr 0.10455633699893951, f1 0.8820000290870667
ep19_l1_test_time 0.5453894649999995
Test Epoch19 layer2 Acc 0.883, AUC 0.9492861032485962, avg_entr 0.07449308782815933, f1 0.8830000162124634
ep19_l2_test_time 0.5449056520000113
Test Epoch19 layer3 Acc 0.8832, AUC 0.9471279382705688, avg_entr 0.03467797115445137, f1 0.8831999897956848
ep19_l3_test_time 0.5447174960000041
Test Epoch19 layer4 Acc 0.8832, AUC 0.946275532245636, avg_entr 0.02221369557082653, f1 0.8831999897956848
ep19_l4_test_time 0.5462844159999918
gc 0
Train Epoch20 Acc 0.97365 (38946/40000), AUC 0.995897650718689
ep20_train_time 6.4209662519999995
Test Epoch20 layer0 Acc 0.8818, AUC 0.9465455412864685, avg_entr 0.11792577803134918, f1 0.8818000555038452
ep20_l0_test_time 0.5549787390000063
Test Epoch20 layer1 Acc 0.882, AUC 0.9481167793273926, avg_entr 0.1046355813741684, f1 0.8820000290870667
ep20_l1_test_time 0.553542431000011
Test Epoch20 layer2 Acc 0.882, AUC 0.9490189552307129, avg_entr 0.07470210641622543, f1 0.8820000290870667
ep20_l2_test_time 0.5470524349999835
Test Epoch20 layer3 Acc 0.8826, AUC 0.9465645551681519, avg_entr 0.035390712320804596, f1 0.8826000094413757
ep20_l3_test_time 0.5464927510000166
Test Epoch20 layer4 Acc 0.8832, AUC 0.9463150501251221, avg_entr 0.0231944527477026, f1 0.8831999897956848
ep20_l4_test_time 0.5472691540000199
gc 0
Train Epoch21 Acc 0.9741 (38964/40000), AUC 0.995998203754425
ep21_train_time 6.460065273999987
Test Epoch21 layer0 Acc 0.8824, AUC 0.9463266134262085, avg_entr 0.1154542937874794, f1 0.8823999762535095
ep21_l0_test_time 0.5474457249999887
Test Epoch21 layer1 Acc 0.8822, AUC 0.9479730129241943, avg_entr 0.10235045105218887, f1 0.8822000026702881
ep21_l1_test_time 0.5489554350000105
Test Epoch21 layer2 Acc 0.8826, AUC 0.9486886262893677, avg_entr 0.0719611719250679, f1 0.8826000094413757
ep21_l2_test_time 0.543151641999998
Test Epoch21 layer3 Acc 0.8822, AUC 0.9461942911148071, avg_entr 0.032843396067619324, f1 0.8822000026702881
ep21_l3_test_time 0.545090206999987
Test Epoch21 layer4 Acc 0.8824, AUC 0.9452521204948425, avg_entr 0.020861277356743813, f1 0.8823999762535095
ep21_l4_test_time 0.5491998960000046
gc 0
Train Epoch22 Acc 0.974175 (38967/40000), AUC 0.9960950613021851
ep22_train_time 6.451311378000014
Test Epoch22 layer0 Acc 0.8832, AUC 0.9462213516235352, avg_entr 0.11461462080478668, f1 0.8831999897956848
ep22_l0_test_time 0.5447846970000114
Test Epoch22 layer1 Acc 0.8822, AUC 0.9478499889373779, avg_entr 0.10160703957080841, f1 0.8822000026702881
ep22_l1_test_time 0.544773020000008
Test Epoch22 layer2 Acc 0.882, AUC 0.9485726356506348, avg_entr 0.07109399139881134, f1 0.8820000290870667
ep22_l2_test_time 0.5474996819999944
Test Epoch22 layer3 Acc 0.8832, AUC 0.9458885192871094, avg_entr 0.03225073963403702, f1 0.8831999897956848
ep22_l3_test_time 0.5483591520000175
Test Epoch22 layer4 Acc 0.883, AUC 0.9450479745864868, avg_entr 0.020651813596487045, f1 0.8830000162124634
ep22_l4_test_time 0.5488747590000003
gc 0
Train Epoch23 Acc 0.974225 (38969/40000), AUC 0.9960603713989258
ep23_train_time 6.480304720999982
Test Epoch23 layer0 Acc 0.8808, AUC 0.9461344480514526, avg_entr 0.11523802578449249, f1 0.8808000087738037
ep23_l0_test_time 0.5561223789999872
Test Epoch23 layer1 Acc 0.8824, AUC 0.947742223739624, avg_entr 0.10202665627002716, f1 0.8823999762535095
ep23_l1_test_time 0.5446308559999977
Test Epoch23 layer2 Acc 0.8812, AUC 0.94853675365448, avg_entr 0.07217370718717575, f1 0.8812000155448914
ep23_l2_test_time 0.5447156059999827
Test Epoch23 layer3 Acc 0.882, AUC 0.9457788467407227, avg_entr 0.033525798469781876, f1 0.8820000290870667
ep23_l3_test_time 0.5469364630000086
Test Epoch23 layer4 Acc 0.8826, AUC 0.9440478086471558, avg_entr 0.021647512912750244, f1 0.8826000094413757
ep23_l4_test_time 0.5450400969999976
gc 0
Train Epoch24 Acc 0.9744 (38976/40000), AUC 0.9961159229278564
ep24_train_time 6.409151465999997
Test Epoch24 layer0 Acc 0.8806, AUC 0.9459314346313477, avg_entr 0.11449531465768814, f1 0.8805999755859375
ep24_l0_test_time 0.5517515370000012
Test Epoch24 layer1 Acc 0.8818, AUC 0.9475423097610474, avg_entr 0.10140623152256012, f1 0.8818000555038452
ep24_l1_test_time 0.5541344780000088
Test Epoch24 layer2 Acc 0.8808, AUC 0.9483135938644409, avg_entr 0.07147277891635895, f1 0.8808000087738037
ep24_l2_test_time 0.5453866779999998
Test Epoch24 layer3 Acc 0.8824, AUC 0.9456228613853455, avg_entr 0.032771263271570206, f1 0.8823999762535095
ep24_l3_test_time 0.5501686690000156
Test Epoch24 layer4 Acc 0.8818, AUC 0.944575309753418, avg_entr 0.021052736788988113, f1 0.8818000555038452
ep24_l4_test_time 0.5473066650000078
gc 0
Train Epoch25 Acc 0.974925 (38997/40000), AUC 0.9961824417114258
ep25_train_time 6.4156326269999795
Test Epoch25 layer0 Acc 0.8818, AUC 0.9458819627761841, avg_entr 0.11348188668489456, f1 0.8818000555038452
ep25_l0_test_time 0.5423978870000496
Test Epoch25 layer1 Acc 0.881, AUC 0.9474995136260986, avg_entr 0.1004880964756012, f1 0.8809999823570251
ep25_l1_test_time 0.5598355550000065
Test Epoch25 layer2 Acc 0.8814, AUC 0.9482729434967041, avg_entr 0.07019615918397903, f1 0.8813999891281128
ep25_l2_test_time 0.5497959349999633
Test Epoch25 layer3 Acc 0.882, AUC 0.945762038230896, avg_entr 0.03168725222349167, f1 0.8820000290870667
ep25_l3_test_time 0.5451803459999951
Test Epoch25 layer4 Acc 0.8822, AUC 0.9458178877830505, avg_entr 0.020252667367458344, f1 0.8822000026702881
ep25_l4_test_time 0.5444951780000338
gc 0
Train Epoch26 Acc 0.974775 (38991/40000), AUC 0.9962523579597473
ep26_train_time 6.388999516000013
Test Epoch26 layer0 Acc 0.8822, AUC 0.945807158946991, avg_entr 0.11288532614707947, f1 0.8822000026702881
ep26_l0_test_time 0.5461871389999828
Test Epoch26 layer1 Acc 0.8812, AUC 0.9474287033081055, avg_entr 0.09990318864583969, f1 0.8812000155448914
ep26_l1_test_time 0.5449517719999903
Test Epoch26 layer2 Acc 0.882, AUC 0.9481785297393799, avg_entr 0.06966663151979446, f1 0.8820000290870667
ep26_l2_test_time 0.5443926610000176
Test Epoch26 layer3 Acc 0.8822, AUC 0.9455236196517944, avg_entr 0.03130221739411354, f1 0.8822000026702881
ep26_l3_test_time 0.5450175069999545
Test Epoch26 layer4 Acc 0.8824, AUC 0.9442387819290161, avg_entr 0.02012001723051071, f1 0.8823999762535095
ep26_l4_test_time 0.547416032000001
gc 0
Train Epoch27 Acc 0.974775 (38991/40000), AUC 0.9962426424026489
ep27_train_time 6.3534137719999535
Test Epoch27 layer0 Acc 0.8816, AUC 0.9457160234451294, avg_entr 0.11229244619607925, f1 0.881600022315979
ep27_l0_test_time 0.5437328780000144
Test Epoch27 layer1 Acc 0.8816, AUC 0.9473516941070557, avg_entr 0.09939532727003098, f1 0.881600022315979
ep27_l1_test_time 0.5439091100000155
Test Epoch27 layer2 Acc 0.8814, AUC 0.9480559229850769, avg_entr 0.06928425282239914, f1 0.8813999891281128
ep27_l2_test_time 0.5474320009999474
Test Epoch27 layer3 Acc 0.8822, AUC 0.9453083276748657, avg_entr 0.031113434582948685, f1 0.8822000026702881
ep27_l3_test_time 0.5473737930000198
Test Epoch27 layer4 Acc 0.8822, AUC 0.943612813949585, avg_entr 0.02010960318148136, f1 0.8822000026702881
ep27_l4_test_time 0.5625154469999529
gc 0
Train Epoch28 Acc 0.974825 (38993/40000), AUC 0.9962767362594604
ep28_train_time 6.365484675999994
Test Epoch28 layer0 Acc 0.8818, AUC 0.9456815123558044, avg_entr 0.11176455020904541, f1 0.8818000555038452
ep28_l0_test_time 0.5538215760000185
Test Epoch28 layer1 Acc 0.882, AUC 0.9473010301589966, avg_entr 0.098783478140831, f1 0.8820000290870667
ep28_l1_test_time 0.5519404130000112
Test Epoch28 layer2 Acc 0.8814, AUC 0.9480308890342712, avg_entr 0.06847304105758667, f1 0.8813999891281128
ep28_l2_test_time 0.5486627910000266
Test Epoch28 layer3 Acc 0.882, AUC 0.9450597763061523, avg_entr 0.030755402520298958, f1 0.8820000290870667
ep28_l3_test_time 0.5469585710000047
Test Epoch28 layer4 Acc 0.8814, AUC 0.9424192309379578, avg_entr 0.01994752325117588, f1 0.8813999891281128
ep28_l4_test_time 0.5511045889999764
gc 0
Train Epoch29 Acc 0.975025 (39001/40000), AUC 0.9963371753692627
ep29_train_time 6.374192433000019
Test Epoch29 layer0 Acc 0.8814, AUC 0.9456852674484253, avg_entr 0.11202562600374222, f1 0.8813999891281128
ep29_l0_test_time 0.5443959339999651
Test Epoch29 layer1 Acc 0.8814, AUC 0.9473026990890503, avg_entr 0.09901315718889236, f1 0.8813999891281128
ep29_l1_test_time 0.5469547469999725
Test Epoch29 layer2 Acc 0.881, AUC 0.9480527639389038, avg_entr 0.06896170228719711, f1 0.8809999823570251
ep29_l2_test_time 0.5456464420000202
Test Epoch29 layer3 Acc 0.882, AUC 0.9455372095108032, avg_entr 0.03114083595573902, f1 0.8820000290870667
ep29_l3_test_time 0.554347220000011
Test Epoch29 layer4 Acc 0.8824, AUC 0.9446769952774048, avg_entr 0.020009757950901985, f1 0.8823999762535095
ep29_l4_test_time 0.5477732759999867
Best AUC tensor(0.9004) 4 1
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 276.19087450800004
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8952, AUC 0.955810010433197, avg_entr 0.17962802946567535, f1 0.8952000141143799
l0_test_time 0.543288331000042
Test layer1 Acc 0.8972, AUC 0.9562369585037231, avg_entr 0.1649237722158432, f1 0.8971999883651733
l1_test_time 0.5395561099999782
Test layer2 Acc 0.8964, AUC 0.9564924240112305, avg_entr 0.13566938042640686, f1 0.896399974822998
l2_test_time 0.5515441719999785
Test layer3 Acc 0.8938, AUC 0.9570039510726929, avg_entr 0.12196024507284164, f1 0.8938000202178955
l3_test_time 0.5409760279999887
Test layer4 Acc 0.8924, AUC 0.9572044014930725, avg_entr 0.09150062501430511, f1 0.8923999667167664
l4_test_time 0.5621613510000429
