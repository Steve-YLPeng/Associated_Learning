total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.740033176
Start Training
gc 0
Train Epoch0 Acc 0.4932 (19728/40000), AUC 0.49525579810142517
ep0_train_time 6.764287106000001
Test Epoch0 layer4 Acc 0.5652, AUC 0.6854566335678101, avg_entr 0.6929929852485657, f1 0.5651999711990356
ep0_l4_test_time 0.5519699679999981
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.821625 (32865/40000), AUC 0.8968855738639832
ep1_train_time 6.4300431670000044
Test Epoch1 layer4 Acc 0.8786, AUC 0.945712685585022, avg_entr 0.2312174141407013, f1 0.878600001335144
ep1_l4_test_time 0.5538971359999962
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.90525 (36210/40000), AUC 0.9644432067871094
ep2_train_time 6.375427903000002
Test Epoch2 layer4 Acc 0.8894, AUC 0.9560121297836304, avg_entr 0.17441311478614807, f1 0.8894000053405762
ep2_l4_test_time 0.5513542489999992
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.92175 (36870/40000), AUC 0.9752708673477173
ep3_train_time 6.5105425890000035
Test Epoch3 layer4 Acc 0.8992, AUC 0.9590771794319153, avg_entr 0.13269880414009094, f1 0.8992000222206116
ep3_l4_test_time 0.5543403909999967
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.93445 (37378/40000), AUC 0.9813054800033569
ep4_train_time 6.428532238999999
Test Epoch4 layer4 Acc 0.893, AUC 0.9600416421890259, avg_entr 0.09358428418636322, f1 0.8930000066757202
ep4_l4_test_time 0.5685791549999948
gc 0
Train Epoch5 Acc 0.940975 (37639/40000), AUC 0.984598696231842
ep5_train_time 6.4758094820000025
Test Epoch5 layer4 Acc 0.8918, AUC 0.9600741863250732, avg_entr 0.0728224515914917, f1 0.8917999863624573
ep5_l4_test_time 0.5514817580000084
gc 0
Train Epoch6 Acc 0.94835 (37934/40000), AUC 0.9874972105026245
ep6_train_time 6.469008403000004
Test Epoch6 layer4 Acc 0.8892, AUC 0.9582592248916626, avg_entr 0.05763190984725952, f1 0.88919997215271
ep6_l4_test_time 0.564918813999995
gc 0
Train Epoch7 Acc 0.95435 (38174/40000), AUC 0.9894450902938843
ep7_train_time 6.457062808999993
Test Epoch7 layer4 Acc 0.8852, AUC 0.9554610252380371, avg_entr 0.043867841362953186, f1 0.8852000832557678
ep7_l4_test_time 0.5545371340000003
gc 0
Train Epoch8 Acc 0.9583 (38332/40000), AUC 0.9908554553985596
ep8_train_time 6.431444667000008
Test Epoch8 layer4 Acc 0.8922, AUC 0.9530342817306519, avg_entr 0.03826139494776726, f1 0.8921999931335449
ep8_l4_test_time 0.5642693089999966
gc 0
Train Epoch9 Acc 0.96285 (38514/40000), AUC 0.9924979209899902
ep9_train_time 6.442155464999999
Test Epoch9 layer4 Acc 0.8914, AUC 0.9504599571228027, avg_entr 0.03061232902109623, f1 0.8913999795913696
ep9_l4_test_time 0.5628925499999866
gc 0
Train Epoch10 Acc 0.96605 (38642/40000), AUC 0.9935550689697266
ep10_train_time 6.415088139000005
Test Epoch10 layer4 Acc 0.8888, AUC 0.9484062194824219, avg_entr 0.029366418719291687, f1 0.8888000249862671
ep10_l4_test_time 0.5543561039999929
gc 0
Train Epoch11 Acc 0.96965 (38786/40000), AUC 0.9943299293518066
ep11_train_time 6.379345645000001
Test Epoch11 layer4 Acc 0.8858, AUC 0.9436152577400208, avg_entr 0.02657957188785076, f1 0.8858000040054321
ep11_l4_test_time 0.5523482019999904
gc 0
Train Epoch12 Acc 0.971075 (38843/40000), AUC 0.9947631359100342
ep12_train_time 6.386751833000005
Test Epoch12 layer4 Acc 0.8808, AUC 0.947645902633667, avg_entr 0.025613559409976006, f1 0.8808000087738037
ep12_l4_test_time 0.5525470949999942
gc 0
Train Epoch13 Acc 0.972225 (38889/40000), AUC 0.9956312775611877
ep13_train_time 6.41360134
Test Epoch13 layer4 Acc 0.8786, AUC 0.943085789680481, avg_entr 0.022871173918247223, f1 0.878600001335144
ep13_l4_test_time 0.5501359959999945
gc 0
Train Epoch14 Acc 0.9749 (38996/40000), AUC 0.9960905909538269
ep14_train_time 6.458004001999996
Test Epoch14 layer4 Acc 0.8776, AUC 0.9388548135757446, avg_entr 0.020338071510195732, f1 0.8776000142097473
ep14_l4_test_time 0.5528219920000197
gc 0
Train Epoch15 Acc 0.976525 (39061/40000), AUC 0.9966665506362915
ep15_train_time 6.372756678999991
Test Epoch15 layer4 Acc 0.8714, AUC 0.9392852783203125, avg_entr 0.02019159495830536, f1 0.871399998664856
ep15_l4_test_time 0.5503740759999971
gc 0
Train Epoch16 Acc 0.978175 (39127/40000), AUC 0.9971048831939697
ep16_train_time 6.412285386999997
Test Epoch16 layer4 Acc 0.8694, AUC 0.9359636306762695, avg_entr 0.018761010840535164, f1 0.8694000244140625
ep16_l4_test_time 0.5537015040000028
gc 0
Train Epoch17 Acc 0.979275 (39171/40000), AUC 0.997157633304596
ep17_train_time 6.411864506000001
Test Epoch17 layer4 Acc 0.8676, AUC 0.9353393316268921, avg_entr 0.017582189291715622, f1 0.8675999641418457
ep17_l4_test_time 0.5521834850000005
gc 0
Train Epoch18 Acc 0.980525 (39221/40000), AUC 0.9975537061691284
ep18_train_time 6.459726186000012
Test Epoch18 layer4 Acc 0.8578, AUC 0.9334538578987122, avg_entr 0.020697176456451416, f1 0.8578000068664551
ep18_l4_test_time 0.5514300680000019
gc 0
Train Epoch19 Acc 0.981175 (39247/40000), AUC 0.9978294372558594
ep19_train_time 6.394687507000015
Test Epoch19 layer4 Acc 0.8592, AUC 0.9327423572540283, avg_entr 0.017845207825303078, f1 0.8592000007629395
ep19_l4_test_time 0.5533814570000004
gc 0
Train Epoch20 Acc 0.982925 (39317/40000), AUC 0.997860312461853
ep20_train_time 6.505678297000003
Test Epoch20 layer4 Acc 0.8552, AUC 0.9296749830245972, avg_entr 0.017758825793862343, f1 0.8551999926567078
ep20_l4_test_time 0.5526656529999912
gc 0
Train Epoch21 Acc 0.983925 (39357/40000), AUC 0.9982250928878784
ep21_train_time 6.4128035949999855
Test Epoch21 layer4 Acc 0.8574, AUC 0.928942859172821, avg_entr 0.014360437169671059, f1 0.8574000000953674
ep21_l4_test_time 0.5546905960000004
gc 0
Train Epoch22 Acc 0.9848 (39392/40000), AUC 0.998304545879364
ep22_train_time 6.448880271000007
Test Epoch22 layer4 Acc 0.8504, AUC 0.9269247651100159, avg_entr 0.01688983291387558, f1 0.8503999710083008
ep22_l4_test_time 0.5538014079999982
gc 0
Train Epoch23 Acc 0.9847 (39388/40000), AUC 0.9983700513839722
ep23_train_time 6.4000980440000035
Test Epoch23 layer4 Acc 0.8554, AUC 0.9239949584007263, avg_entr 0.015372439287602901, f1 0.855400025844574
ep23_l4_test_time 0.5546690259999991
gc 0
Train Epoch24 Acc 0.985325 (39413/40000), AUC 0.9983986616134644
ep24_train_time 6.489328160000014
Test Epoch24 layer4 Acc 0.8506, AUC 0.9238647222518921, avg_entr 0.01493239775300026, f1 0.8505999445915222
ep24_l4_test_time 0.5513229500000136
gc 0
Train Epoch25 Acc 0.986175 (39447/40000), AUC 0.998526394367218
ep25_train_time 6.420496071000002
Test Epoch25 layer4 Acc 0.8516, AUC 0.9229612946510315, avg_entr 0.014647230505943298, f1 0.8515999913215637
ep25_l4_test_time 0.5570828049999932
gc 0
Train Epoch26 Acc 0.987025 (39481/40000), AUC 0.9987861514091492
ep26_train_time 6.37527774199998
Test Epoch26 layer4 Acc 0.8484, AUC 0.9200122356414795, avg_entr 0.014542020857334137, f1 0.8483999967575073
ep26_l4_test_time 0.5546785669999963
gc 0
Train Epoch27 Acc 0.98755 (39502/40000), AUC 0.9988254308700562
ep27_train_time 6.455402501999998
Test Epoch27 layer4 Acc 0.8474, AUC 0.9191121459007263, avg_entr 0.013351861387491226, f1 0.8474000096321106
ep27_l4_test_time 0.5636608630000239
gc 0
Train Epoch28 Acc 0.98765 (39506/40000), AUC 0.998945951461792
ep28_train_time 6.405564948999995
Test Epoch28 layer4 Acc 0.8434, AUC 0.9183154106140137, avg_entr 0.014513250440359116, f1 0.8434000015258789
ep28_l4_test_time 0.5525960269999928
gc 0
Train Epoch29 Acc 0.9881 (39524/40000), AUC 0.99897301197052
ep29_train_time 6.449377086999988
Test Epoch29 layer4 Acc 0.843, AUC 0.9164998531341553, avg_entr 0.011634920723736286, f1 0.8429999947547913
ep29_l4_test_time 0.5520986580000056
Best AUC tensor(0.8992) 3
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 211.319415731
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8852, AUC 0.955730676651001, avg_entr 0.18837764859199524, f1 0.8852000832557678
l0_test_time 0.5462437649999856
Test layer1 Acc 0.89, AUC 0.9562174677848816, avg_entr 0.17142681777477264, f1 0.8899999856948853
l1_test_time 0.545215713999994
Test layer2 Acc 0.8912, AUC 0.95633864402771, avg_entr 0.15743876993656158, f1 0.8912000060081482
l2_test_time 0.5477851059999921
Test layer3 Acc 0.8934, AUC 0.956536054611206, avg_entr 0.14825455844402313, f1 0.8934000134468079
l3_test_time 0.5595774620000213
Test layer4 Acc 0.8916, AUC 0.9563952684402466, avg_entr 0.13262659311294556, f1 0.8916000127792358
l4_test_time 0.5495799139999917
