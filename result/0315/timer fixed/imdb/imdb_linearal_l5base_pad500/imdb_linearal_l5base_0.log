total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.545042085000002
Start Training
gc 0
Train Epoch0 Acc 0.49955 (19982/40000), AUC 0.4947632849216461
ep0_train_time 6.823048425
Test Epoch0 layer4 Acc 0.5448, AUC 0.783527135848999, avg_entr 0.6910794973373413, f1 0.5447999835014343
ep0_l4_test_time 0.547109589999998
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.791175 (31647/40000), AUC 0.8781803846359253
ep1_train_time 6.369919253999996
Test Epoch1 layer4 Acc 0.876, AUC 0.9441601634025574, avg_entr 0.24200773239135742, f1 0.8760000467300415
ep1_l4_test_time 0.5475266580000024
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9012 (36048/40000), AUC 0.9617207050323486
ep2_train_time 6.325573634000001
Test Epoch2 layer4 Acc 0.8914, AUC 0.9542032480239868, avg_entr 0.16905970871448517, f1 0.8913999795913696
ep2_l4_test_time 0.5455952010000047
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.92185 (36874/40000), AUC 0.9752426147460938
ep3_train_time 6.508562456
Test Epoch3 layer4 Acc 0.8966, AUC 0.9586008787155151, avg_entr 0.1382836252450943, f1 0.8966000080108643
ep3_l4_test_time 0.5458013289999997
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.933625 (37345/40000), AUC 0.9808741807937622
ep4_train_time 6.371982545000002
Test Epoch4 layer4 Acc 0.8966, AUC 0.9598199725151062, avg_entr 0.10417260974645615, f1 0.8966000080108643
ep4_l4_test_time 0.5457799150000042
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.94165 (37666/40000), AUC 0.9847368597984314
ep5_train_time 6.368045604999999
Test Epoch5 layer4 Acc 0.8986, AUC 0.96040940284729, avg_entr 0.07664456963539124, f1 0.8985999822616577
ep5_l4_test_time 0.548725215999994
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9471 (37884/40000), AUC 0.987307071685791
ep6_train_time 6.434342060999995
Test Epoch6 layer4 Acc 0.8972, AUC 0.9596149921417236, avg_entr 0.05345963314175606, f1 0.8971999883651733
ep6_l4_test_time 0.5456066189999973
gc 0
Train Epoch7 Acc 0.952525 (38101/40000), AUC 0.9891351461410522
ep7_train_time 6.363139340000004
Test Epoch7 layer4 Acc 0.8898, AUC 0.9562929272651672, avg_entr 0.05029929801821709, f1 0.8898000121116638
ep7_l4_test_time 0.5510980099999898
gc 0
Train Epoch8 Acc 0.95795 (38318/40000), AUC 0.9906835556030273
ep8_train_time 6.312770016000002
Test Epoch8 layer4 Acc 0.895, AUC 0.9534716606140137, avg_entr 0.03466787561774254, f1 0.8949999809265137
ep8_l4_test_time 0.5473198480000008
gc 0
Train Epoch9 Acc 0.9616 (38464/40000), AUC 0.9921197891235352
ep9_train_time 6.3704540640000005
Test Epoch9 layer4 Acc 0.8902, AUC 0.9511153697967529, avg_entr 0.031376034021377563, f1 0.8902000188827515
ep9_l4_test_time 0.5504367239999937
gc 0
Train Epoch10 Acc 0.96595 (38638/40000), AUC 0.993116021156311
ep10_train_time 6.409162542999994
Test Epoch10 layer4 Acc 0.886, AUC 0.9472582340240479, avg_entr 0.030131524428725243, f1 0.8859999775886536
ep10_l4_test_time 0.5496685269999944
gc 0
Train Epoch11 Acc 0.96655 (38662/40000), AUC 0.9941082000732422
ep11_train_time 6.329987485000004
Test Epoch11 layer4 Acc 0.8844, AUC 0.9450161457061768, avg_entr 0.02827790006995201, f1 0.8844000101089478
ep11_l4_test_time 0.5474760459999999
gc 0
Train Epoch12 Acc 0.969425 (38777/40000), AUC 0.9945648908615112
ep12_train_time 6.364462335999988
Test Epoch12 layer4 Acc 0.8806, AUC 0.9447118639945984, avg_entr 0.026230135932564735, f1 0.8805999755859375
ep12_l4_test_time 0.5460581399999995
gc 0
Train Epoch13 Acc 0.971875 (38875/40000), AUC 0.9952998161315918
ep13_train_time 6.438509586999999
Test Epoch13 layer4 Acc 0.8782, AUC 0.9426965713500977, avg_entr 0.023739857599139214, f1 0.8781999945640564
ep13_l4_test_time 0.5465453230000037
gc 0
Train Epoch14 Acc 0.97405 (38962/40000), AUC 0.9960218667984009
ep14_train_time 6.441277064999994
Test Epoch14 layer4 Acc 0.8772, AUC 0.9408808350563049, avg_entr 0.020536325871944427, f1 0.8772000074386597
ep14_l4_test_time 0.5434880759999885
gc 0
Train Epoch15 Acc 0.975 (39000/40000), AUC 0.9963034391403198
ep15_train_time 6.425507309000011
Test Epoch15 layer4 Acc 0.8728, AUC 0.9368345737457275, avg_entr 0.01926279067993164, f1 0.8727999925613403
ep15_l4_test_time 0.5452585280000051
gc 0
Train Epoch16 Acc 0.97685 (39074/40000), AUC 0.9968206882476807
ep16_train_time 6.333553421999994
Test Epoch16 layer4 Acc 0.8708, AUC 0.9367784857749939, avg_entr 0.020506449043750763, f1 0.8708000183105469
ep16_l4_test_time 0.5455246120000083
gc 0
Train Epoch17 Acc 0.977975 (39119/40000), AUC 0.9970372319221497
ep17_train_time 6.401027950000014
Test Epoch17 layer4 Acc 0.8586, AUC 0.9323946237564087, avg_entr 0.018794415518641472, f1 0.8586000204086304
ep17_l4_test_time 0.5478436649999878
gc 0
Train Epoch18 Acc 0.97995 (39198/40000), AUC 0.9971902370452881
ep18_train_time 6.4672310880000055
Test Epoch18 layer4 Acc 0.8614, AUC 0.9316015839576721, avg_entr 0.01585223898291588, f1 0.8614000082015991
ep18_l4_test_time 0.5469976249999888
gc 0
Train Epoch19 Acc 0.980375 (39215/40000), AUC 0.9976550340652466
ep19_train_time 6.374467656000007
Test Epoch19 layer4 Acc 0.8584, AUC 0.9272300601005554, avg_entr 0.015568154864013195, f1 0.8583999872207642
ep19_l4_test_time 0.5510701270000027
gc 0
Train Epoch20 Acc 0.982175 (39287/40000), AUC 0.9978546500205994
ep20_train_time 6.446850490000003
Test Epoch20 layer4 Acc 0.8576, AUC 0.9255548119544983, avg_entr 0.014826535247266293, f1 0.8575999140739441
ep20_l4_test_time 0.547337223999989
gc 0
Train Epoch21 Acc 0.98195 (39278/40000), AUC 0.9980589151382446
ep21_train_time 6.322955087999986
Test Epoch21 layer4 Acc 0.8568, AUC 0.9250185489654541, avg_entr 0.015114148147404194, f1 0.8568000793457031
ep21_l4_test_time 0.5483902890000252
gc 0
Train Epoch22 Acc 0.983475 (39339/40000), AUC 0.9982279539108276
ep22_train_time 6.415741252000004
Test Epoch22 layer4 Acc 0.8536, AUC 0.9208952784538269, avg_entr 0.014553865417838097, f1 0.853600025177002
ep22_l4_test_time 0.5446090119999951
gc 0
Train Epoch23 Acc 0.9841 (39364/40000), AUC 0.9982984066009521
ep23_train_time 6.396500833000005
Test Epoch23 layer4 Acc 0.854, AUC 0.9201592206954956, avg_entr 0.015285962261259556, f1 0.8539999723434448
ep23_l4_test_time 0.5467880129999969
gc 0
Train Epoch24 Acc 0.984075 (39363/40000), AUC 0.9985669255256653
ep24_train_time 6.355114237999999
Test Epoch24 layer4 Acc 0.8474, AUC 0.9151715636253357, avg_entr 0.013412413187325, f1 0.8474000096321106
ep24_l4_test_time 0.545965080000002
gc 0
Train Epoch25 Acc 0.9854 (39416/40000), AUC 0.9985822439193726
ep25_train_time 6.3725761139999975
Test Epoch25 layer4 Acc 0.8508, AUC 0.915086030960083, avg_entr 0.014235840179026127, f1 0.8507999777793884
ep25_l4_test_time 0.5471496979999984
gc 0
Train Epoch26 Acc 0.985675 (39427/40000), AUC 0.9987854957580566
ep26_train_time 6.307717034999996
Test Epoch26 layer4 Acc 0.846, AUC 0.9123953580856323, avg_entr 0.012632912956178188, f1 0.8460000157356262
ep26_l4_test_time 0.5469228879999832
gc 0
Train Epoch27 Acc 0.986275 (39451/40000), AUC 0.9987932443618774
ep27_train_time 6.387196756999998
Test Epoch27 layer4 Acc 0.8458, AUC 0.9109236001968384, avg_entr 0.012043352238833904, f1 0.84579998254776
ep27_l4_test_time 0.5477076080000245
gc 0
Train Epoch28 Acc 0.987125 (39485/40000), AUC 0.9989588260650635
ep28_train_time 6.362096562000005
Test Epoch28 layer4 Acc 0.8424, AUC 0.908141016960144, avg_entr 0.012209143489599228, f1 0.8424000144004822
ep28_l4_test_time 0.5470682419999946
gc 0
Train Epoch29 Acc 0.987575 (39503/40000), AUC 0.9990278482437134
ep29_train_time 6.351537413000017
Test Epoch29 layer4 Acc 0.8428, AUC 0.907261073589325, avg_entr 0.011464928276836872, f1 0.8428000211715698
ep29_l4_test_time 0.5464265889999922
Best AUC tensor(0.8986) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 209.875151088
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8936, AUC 0.9551308751106262, avg_entr 0.16565805673599243, f1 0.8935999870300293
l0_test_time 0.5414054089999922
Test layer1 Acc 0.8924, AUC 0.9555283188819885, avg_entr 0.15075471997261047, f1 0.8923999667167664
l1_test_time 0.5398692469999844
Test layer2 Acc 0.8922, AUC 0.9564527273178101, avg_entr 0.14327391982078552, f1 0.8921999931335449
l2_test_time 0.5430972790000226
Test layer3 Acc 0.8924, AUC 0.9569300413131714, avg_entr 0.11321744322776794, f1 0.8923999667167664
l3_test_time 0.546032877000016
Test layer4 Acc 0.8914, AUC 0.9568381309509277, avg_entr 0.0826154574751854, f1 0.8913999795913696
l4_test_time 0.5457224989999929
