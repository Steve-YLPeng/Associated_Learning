total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.928001674
Start Training
gc 0
Train Epoch0 Acc 0.5035 (20140/40000), AUC 0.5036181211471558
ep0_train_time 6.784260164999999
Test Epoch0 layer4 Acc 0.6116, AUC 0.7892379760742188, avg_entr 0.6939498782157898, f1 0.6115999817848206
ep0_l4_test_time 0.5506351640000027
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.821325 (32853/40000), AUC 0.9013549089431763
ep1_train_time 6.389749402
Test Epoch1 layer4 Acc 0.8374, AUC 0.9458713531494141, avg_entr 0.21615412831306458, f1 0.8374000191688538
ep1_l4_test_time 0.5525792689999989
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.905225 (36209/40000), AUC 0.9649612307548523
ep2_train_time 6.340620102999999
Test Epoch2 layer4 Acc 0.8896, AUC 0.9562082290649414, avg_entr 0.15805843472480774, f1 0.8895999193191528
ep2_l4_test_time 0.5497961550000028
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.92315 (36926/40000), AUC 0.9758833646774292
ep3_train_time 6.373848000999999
Test Epoch3 layer4 Acc 0.8952, AUC 0.9594367146492004, avg_entr 0.12416130304336548, f1 0.8952000141143799
ep3_l4_test_time 0.550090468999997
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.934275 (37371/40000), AUC 0.9816898107528687
ep4_train_time 6.294674495999999
Test Epoch4 layer4 Acc 0.8976, AUC 0.9610080718994141, avg_entr 0.09133656322956085, f1 0.897599995136261
ep4_l4_test_time 0.5517110350000038
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9434 (37736/40000), AUC 0.9854967594146729
ep5_train_time 6.330687370000007
Test Epoch5 layer4 Acc 0.8976, AUC 0.9609452486038208, avg_entr 0.06922364234924316, f1 0.897599995136261
ep5_l4_test_time 0.5500495670000021
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.948725 (37949/40000), AUC 0.9879642724990845
ep6_train_time 6.461703501000002
Test Epoch6 layer4 Acc 0.8964, AUC 0.9596339464187622, avg_entr 0.05516945943236351, f1 0.896399974822998
ep6_l4_test_time 0.5485275590000072
gc 0
Train Epoch7 Acc 0.954375 (38175/40000), AUC 0.9895146489143372
ep7_train_time 6.23421862299999
Test Epoch7 layer4 Acc 0.8952, AUC 0.9563010931015015, avg_entr 0.04469437897205353, f1 0.8952000141143799
ep7_l4_test_time 0.5491854060000065
gc 0
Train Epoch8 Acc 0.958675 (38347/40000), AUC 0.9912173748016357
ep8_train_time 6.350928994
Test Epoch8 layer4 Acc 0.8944, AUC 0.9537048935890198, avg_entr 0.03907385468482971, f1 0.8944000005722046
ep8_l4_test_time 0.5509022250000015
gc 0
Train Epoch9 Acc 0.962275 (38491/40000), AUC 0.9919512271881104
ep9_train_time 6.372475021
Test Epoch9 layer4 Acc 0.891, AUC 0.9513222575187683, avg_entr 0.0331864058971405, f1 0.890999972820282
ep9_l4_test_time 0.5499007039999952
gc 0
Train Epoch10 Acc 0.96535 (38614/40000), AUC 0.993431568145752
ep10_train_time 6.3575477629999995
Test Epoch10 layer4 Acc 0.8878, AUC 0.9502105712890625, avg_entr 0.030420392751693726, f1 0.8877999782562256
ep10_l4_test_time 0.5611413849999991
gc 0
Train Epoch11 Acc 0.967625 (38705/40000), AUC 0.9943370223045349
ep11_train_time 6.489267883000011
Test Epoch11 layer4 Acc 0.8852, AUC 0.9484522342681885, avg_entr 0.02750573493540287, f1 0.8852000832557678
ep11_l4_test_time 0.5496748980000064
gc 0
Train Epoch12 Acc 0.9699 (38796/40000), AUC 0.9950195550918579
ep12_train_time 6.402886361
Test Epoch12 layer4 Acc 0.8826, AUC 0.9470871090888977, avg_entr 0.02526530809700489, f1 0.8826000094413757
ep12_l4_test_time 0.550734122999998
gc 0
Train Epoch13 Acc 0.97195 (38878/40000), AUC 0.9955546855926514
ep13_train_time 6.400844305999996
Test Epoch13 layer4 Acc 0.8782, AUC 0.9449103474617004, avg_entr 0.02150070108473301, f1 0.8781999945640564
ep13_l4_test_time 0.5510457259999981
gc 0
Train Epoch14 Acc 0.973975 (38959/40000), AUC 0.9960808157920837
ep14_train_time 6.342449325000004
Test Epoch14 layer4 Acc 0.8744, AUC 0.9425376057624817, avg_entr 0.023705409839749336, f1 0.8744000792503357
ep14_l4_test_time 0.5550564430000122
gc 0
Train Epoch15 Acc 0.975025 (39001/40000), AUC 0.9964195489883423
ep15_train_time 6.336198763999988
Test Epoch15 layer4 Acc 0.8744, AUC 0.9400224089622498, avg_entr 0.018306702375411987, f1 0.8744000792503357
ep15_l4_test_time 0.5495612870000173
gc 0
Train Epoch16 Acc 0.97675 (39070/40000), AUC 0.9967551827430725
ep16_train_time 6.4938129390000086
Test Epoch16 layer4 Acc 0.8646, AUC 0.9381598234176636, avg_entr 0.02280065231025219, f1 0.8646000027656555
ep16_l4_test_time 0.5493123219999916
gc 0
Train Epoch17 Acc 0.978225 (39129/40000), AUC 0.9971765875816345
ep17_train_time 6.358511921000002
Test Epoch17 layer4 Acc 0.8688, AUC 0.9360826015472412, avg_entr 0.01821185275912285, f1 0.8687999844551086
ep17_l4_test_time 0.565269566000012
gc 0
Train Epoch18 Acc 0.979225 (39169/40000), AUC 0.9972611665725708
ep18_train_time 6.340508368000002
Test Epoch18 layer4 Acc 0.8656, AUC 0.9353634715080261, avg_entr 0.01751876063644886, f1 0.8655999898910522
ep18_l4_test_time 0.5527608639999926
gc 0
Train Epoch19 Acc 0.98035 (39214/40000), AUC 0.9975524544715881
ep19_train_time 6.471750313000001
Test Epoch19 layer4 Acc 0.8558, AUC 0.9331356287002563, avg_entr 0.018124910071492195, f1 0.8558000326156616
ep19_l4_test_time 0.5559582569999861
gc 0
Train Epoch20 Acc 0.981225 (39249/40000), AUC 0.9977253675460815
ep20_train_time 6.361957372999996
Test Epoch20 layer4 Acc 0.8598, AUC 0.9318145513534546, avg_entr 0.016455208882689476, f1 0.8597999811172485
ep20_l4_test_time 0.5569929330000036
gc 0
Train Epoch21 Acc 0.98205 (39282/40000), AUC 0.997786283493042
ep21_train_time 6.352595162
Test Epoch21 layer4 Acc 0.8566, AUC 0.9293055534362793, avg_entr 0.01563172973692417, f1 0.8565999865531921
ep21_l4_test_time 0.5487823329999912
gc 0
Train Epoch22 Acc 0.982975 (39319/40000), AUC 0.9980795979499817
ep22_train_time 6.370213576999987
Test Epoch22 layer4 Acc 0.8536, AUC 0.9279126524925232, avg_entr 0.013856335543096066, f1 0.853600025177002
ep22_l4_test_time 0.5485997830000144
gc 0
Train Epoch23 Acc 0.98345 (39338/40000), AUC 0.9981889724731445
ep23_train_time 6.311662394999985
Test Epoch23 layer4 Acc 0.852, AUC 0.9265061020851135, avg_entr 0.015354858711361885, f1 0.8519999980926514
ep23_l4_test_time 0.5481074419999743
gc 0
Train Epoch24 Acc 0.9842 (39368/40000), AUC 0.9982403516769409
ep24_train_time 6.4475646250000125
Test Epoch24 layer4 Acc 0.8518, AUC 0.9238345623016357, avg_entr 0.013953120447695255, f1 0.8518000245094299
ep24_l4_test_time 0.5587417790000018
gc 0
Train Epoch25 Acc 0.984925 (39397/40000), AUC 0.9983471632003784
ep25_train_time 6.325374184999987
Test Epoch25 layer4 Acc 0.8446, AUC 0.922078013420105, avg_entr 0.014680281281471252, f1 0.8446000814437866
ep25_l4_test_time 0.5477203540000062
gc 0
Train Epoch26 Acc 0.9854 (39416/40000), AUC 0.9984946846961975
ep26_train_time 6.336632426000023
Test Epoch26 layer4 Acc 0.8448, AUC 0.9210108518600464, avg_entr 0.014675355516374111, f1 0.8447999358177185
ep26_l4_test_time 0.5509124760000077
gc 0
Train Epoch27 Acc 0.98595 (39438/40000), AUC 0.9985967874526978
ep27_train_time 6.368604591999997
Test Epoch27 layer4 Acc 0.8408, AUC 0.9204870462417603, avg_entr 0.014009950682520866, f1 0.8408000469207764
ep27_l4_test_time 0.5526813949999791
gc 0
Train Epoch28 Acc 0.987 (39480/40000), AUC 0.9987825751304626
ep28_train_time 6.3722174049999865
Test Epoch28 layer4 Acc 0.8446, AUC 0.9180855751037598, avg_entr 0.01338918786495924, f1 0.8446000814437866
ep28_l4_test_time 0.5464276779999864
gc 0
Train Epoch29 Acc 0.987175 (39487/40000), AUC 0.9987055063247681
ep29_train_time 6.360322494000002
Test Epoch29 layer4 Acc 0.8392, AUC 0.914529025554657, avg_entr 0.01331908255815506, f1 0.8392000198364258
ep29_l4_test_time 0.5504575080000222
Best AUC tensor(0.8976) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 209.60799165400002
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8942, AUC 0.9545297622680664, avg_entr 0.16478994488716125, f1 0.8942000269889832
l0_test_time 0.5498150399999986
Test layer1 Acc 0.8942, AUC 0.9552507996559143, avg_entr 0.1487845480442047, f1 0.8942000269889832
l1_test_time 0.5481567140000152
Test layer2 Acc 0.8946, AUC 0.956118106842041, avg_entr 0.13513080775737762, f1 0.894599974155426
l2_test_time 0.5412325720000126
Test layer3 Acc 0.8936, AUC 0.9568177461624146, avg_entr 0.10463016480207443, f1 0.8935999870300293
l3_test_time 0.5488949340000033
Test layer4 Acc 0.8946, AUC 0.9568170309066772, avg_entr 0.07446885854005814, f1 0.894599974155426
l4_test_time 0.5445140100000003
