total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.083318219
Start Training
gc 0
Train Epoch0 Acc 0.505825 (20233/40000), AUC 0.5056108832359314
ep0_train_time 11.626241428
Test Epoch0 layer4 Acc 0.7736, AUC 0.8506008386611938, avg_entr 0.6934810876846313, f1 0.7735999822616577
ep0_l4_test_time 0.7673490799999954
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.831275 (33251/40000), AUC 0.9071471691131592
ep1_train_time 10.859002260000004
Test Epoch1 layer4 Acc 0.8816, AUC 0.9467374086380005, avg_entr 0.22927211225032806, f1 0.881600022315979
ep1_l4_test_time 0.7819771750000015
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.90645 (36258/40000), AUC 0.965387225151062
ep2_train_time 10.791053349999999
Test Epoch2 layer4 Acc 0.8784, AUC 0.9559047818183899, avg_entr 0.16535337269306183, f1 0.8784000277519226
ep2_l4_test_time 0.7608534610000035
gc 0
Train Epoch3 Acc 0.923925 (36957/40000), AUC 0.9761215448379517
ep3_train_time 10.765116190000008
Test Epoch3 layer4 Acc 0.894, AUC 0.9593830108642578, avg_entr 0.12189532816410065, f1 0.8939999938011169
ep3_l4_test_time 0.7465147120000069
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.93445 (37378/40000), AUC 0.9815084934234619
ep4_train_time 10.863596813000001
Test Epoch4 layer4 Acc 0.897, AUC 0.9604671001434326, avg_entr 0.0817650780081749, f1 0.8970000147819519
ep4_l4_test_time 0.7436709779999973
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.943375 (37735/40000), AUC 0.985495924949646
ep5_train_time 10.735549297999995
Test Epoch5 layer4 Acc 0.8976, AUC 0.9597808122634888, avg_entr 0.057974956929683685, f1 0.897599995136261
ep5_l4_test_time 0.7272813259999964
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.949775 (37991/40000), AUC 0.9878624081611633
ep6_train_time 10.831790408000003
Test Epoch6 layer4 Acc 0.8954, AUC 0.957910418510437, avg_entr 0.04741766303777695, f1 0.8953999876976013
ep6_l4_test_time 0.7609816380000041
gc 0
Train Epoch7 Acc 0.9556 (38224/40000), AUC 0.989761471748352
ep7_train_time 10.727052332
Test Epoch7 layer4 Acc 0.8908, AUC 0.9541689157485962, avg_entr 0.04158824309706688, f1 0.8907999992370605
ep7_l4_test_time 0.7536993420000044
gc 0
Train Epoch8 Acc 0.958275 (38331/40000), AUC 0.9910423755645752
ep8_train_time 10.710477556
Test Epoch8 layer4 Acc 0.8922, AUC 0.9524419903755188, avg_entr 0.03664151579141617, f1 0.8921999931335449
ep8_l4_test_time 0.7651512719999971
gc 0
Train Epoch9 Acc 0.961875 (38475/40000), AUC 0.9924126863479614
ep9_train_time 10.775921471999993
Test Epoch9 layer4 Acc 0.8884, AUC 0.9515895843505859, avg_entr 0.031155196949839592, f1 0.8884000182151794
ep9_l4_test_time 0.7560210549999908
gc 0
Train Epoch10 Acc 0.9654 (38616/40000), AUC 0.9936169981956482
ep10_train_time 10.678118560000001
Test Epoch10 layer4 Acc 0.8862, AUC 0.9494947195053101, avg_entr 0.028822852298617363, f1 0.8862000107765198
ep10_l4_test_time 0.7602797620000104
gc 0
Train Epoch11 Acc 0.967625 (38705/40000), AUC 0.994392454624176
ep11_train_time 10.799276229000014
Test Epoch11 layer4 Acc 0.8864, AUC 0.9480624794960022, avg_entr 0.024816982448101044, f1 0.8863999843597412
ep11_l4_test_time 0.747388744999995
gc 0
Train Epoch12 Acc 0.969575 (38783/40000), AUC 0.9950312376022339
ep12_train_time 10.774676096000007
Test Epoch12 layer4 Acc 0.878, AUC 0.9455546140670776, avg_entr 0.02669009380042553, f1 0.878000020980835
ep12_l4_test_time 0.7365006949999895
gc 0
Train Epoch13 Acc 0.971625 (38865/40000), AUC 0.9955711364746094
ep13_train_time 10.818560329999997
Test Epoch13 layer4 Acc 0.8786, AUC 0.9455569982528687, avg_entr 0.0214812271296978, f1 0.878600001335144
ep13_l4_test_time 0.7739433710000014
gc 0
Train Epoch14 Acc 0.9737 (38948/40000), AUC 0.9961267709732056
ep14_train_time 10.787441449
Test Epoch14 layer4 Acc 0.876, AUC 0.9422551393508911, avg_entr 0.020333707332611084, f1 0.8760000467300415
ep14_l4_test_time 0.7636761430000263
gc 0
Train Epoch15 Acc 0.9754 (39016/40000), AUC 0.9966511726379395
ep15_train_time 10.839487392999985
Test Epoch15 layer4 Acc 0.8712, AUC 0.9412071704864502, avg_entr 0.020000780001282692, f1 0.8712000846862793
ep15_l4_test_time 0.7627663579999933
gc 0
Train Epoch16 Acc 0.977175 (39087/40000), AUC 0.9970145225524902
ep16_train_time 10.798843204000008
Test Epoch16 layer4 Acc 0.8704, AUC 0.9380022287368774, avg_entr 0.01802697964012623, f1 0.8704000115394592
ep16_l4_test_time 0.7652719579999996
gc 0
Train Epoch17 Acc 0.979125 (39165/40000), AUC 0.9972681999206543
ep17_train_time 10.761726858000003
Test Epoch17 layer4 Acc 0.8642, AUC 0.9368114471435547, avg_entr 0.017594479024410248, f1 0.8641999959945679
ep17_l4_test_time 0.7504381569999907
gc 0
Train Epoch18 Acc 0.9799 (39196/40000), AUC 0.9975693225860596
ep18_train_time 10.832859875999986
Test Epoch18 layer4 Acc 0.8644, AUC 0.9342969655990601, avg_entr 0.016099510714411736, f1 0.8644000291824341
ep18_l4_test_time 0.7544482349999839
gc 0
Train Epoch19 Acc 0.97995 (39198/40000), AUC 0.9976661205291748
ep19_train_time 10.671525006999985
Test Epoch19 layer4 Acc 0.8578, AUC 0.9329068660736084, avg_entr 0.01736581139266491, f1 0.8578000068664551
ep19_l4_test_time 0.7612278140000228
gc 0
Train Epoch20 Acc 0.982 (39280/40000), AUC 0.9979618787765503
ep20_train_time 10.876443620999964
Test Epoch20 layer4 Acc 0.859, AUC 0.9300702810287476, avg_entr 0.016308005899190903, f1 0.859000027179718
ep20_l4_test_time 0.7827815360000159
gc 0
Train Epoch21 Acc 0.982325 (39293/40000), AUC 0.9981358051300049
ep21_train_time 10.769562511999993
Test Epoch21 layer4 Acc 0.8572, AUC 0.9284137487411499, avg_entr 0.01764078438282013, f1 0.857200026512146
ep21_l4_test_time 0.7599091739999722
gc 0
Train Epoch22 Acc 0.98355 (39342/40000), AUC 0.9983477592468262
ep22_train_time 10.826711346000025
Test Epoch22 layer4 Acc 0.8562, AUC 0.9263492226600647, avg_entr 0.01804468035697937, f1 0.8561999797821045
ep22_l4_test_time 0.7385519619999741
gc 0
Train Epoch23 Acc 0.984375 (39375/40000), AUC 0.9984413981437683
ep23_train_time 10.817928913999992
Test Epoch23 layer4 Acc 0.8514, AUC 0.925787627696991, avg_entr 0.014452062547206879, f1 0.8514000177383423
ep23_l4_test_time 0.7345661830000267
gc 0
Train Epoch24 Acc 0.98405 (39362/40000), AUC 0.9984686374664307
ep24_train_time 10.739992745000052
Test Epoch24 layer4 Acc 0.8522, AUC 0.9230208396911621, avg_entr 0.01325540617108345, f1 0.8521999716758728
ep24_l4_test_time 0.744978457000002
gc 0
Train Epoch25 Acc 0.984475 (39379/40000), AUC 0.998664379119873
ep25_train_time 10.801172419000011
Test Epoch25 layer4 Acc 0.85, AUC 0.9216058850288391, avg_entr 0.0143973920494318, f1 0.8500000238418579
ep25_l4_test_time 0.7388580880000291
gc 0
Train Epoch26 Acc 0.986075 (39443/40000), AUC 0.9987730979919434
ep26_train_time 10.721327416000008
Test Epoch26 layer4 Acc 0.847, AUC 0.9187710285186768, avg_entr 0.01468636468052864, f1 0.847000002861023
ep26_l4_test_time 0.7594992159999947
gc 0
Train Epoch27 Acc 0.9864 (39456/40000), AUC 0.9988143444061279
ep27_train_time 10.81995150299997
Test Epoch27 layer4 Acc 0.8438, AUC 0.9168330430984497, avg_entr 0.01375129260122776, f1 0.8438000082969666
ep27_l4_test_time 0.7556959309999911
gc 0
Train Epoch28 Acc 0.987075 (39483/40000), AUC 0.9989537000656128
ep28_train_time 10.825258266999981
Test Epoch28 layer4 Acc 0.84, AUC 0.9154059290885925, avg_entr 0.014374678023159504, f1 0.8399999737739563
ep28_l4_test_time 0.7518441649999659
gc 0
Train Epoch29 Acc 0.987175 (39487/40000), AUC 0.9989681243896484
ep29_train_time 10.74075005100002
Test Epoch29 layer4 Acc 0.843, AUC 0.9134706258773804, avg_entr 0.012859239242970943, f1 0.8429999947547913
ep29_l4_test_time 0.7712781239999913
Best AUC tensor(0.8976) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 348.568906892
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.893, AUC 0.9542685747146606, avg_entr 0.16496428847312927, f1 0.8930000066757202
l0_test_time 0.7721741540000266
Test layer1 Acc 0.8908, AUC 0.9547246098518372, avg_entr 0.1439056694507599, f1 0.8907999992370605
l1_test_time 0.7518168189999983
Test layer2 Acc 0.8908, AUC 0.9553742408752441, avg_entr 0.1367911398410797, f1 0.8907999992370605
l2_test_time 0.7496159290000151
Test layer3 Acc 0.892, AUC 0.956048846244812, avg_entr 0.09870068728923798, f1 0.8920000195503235
l3_test_time 0.739647964000028
Test layer4 Acc 0.8912, AUC 0.9554345607757568, avg_entr 0.06282159686088562, f1 0.8912000060081482
l4_test_time 0.733722795999995
