total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.329556659999998
Start Training
gc 0
Train Epoch0 Acc 0.51125 (20450/40000), AUC 0.5190470218658447
ep0_train_time 11.672616067
Test Epoch0 layer4 Acc 0.6226, AUC 0.8130918741226196, avg_entr 0.6895016431808472, f1 0.6226000189781189
ep0_l4_test_time 0.748159053000002
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.82935 (33174/40000), AUC 0.9043334722518921
ep1_train_time 10.689184017999999
Test Epoch1 layer4 Acc 0.8814, AUC 0.9465674161911011, avg_entr 0.23182174563407898, f1 0.8813999891281128
ep1_l4_test_time 0.7564798559999986
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.90645 (36258/40000), AUC 0.964940071105957
ep2_train_time 10.698090739000001
Test Epoch2 layer4 Acc 0.888, AUC 0.9564120769500732, avg_entr 0.16423135995864868, f1 0.8880000114440918
ep2_l4_test_time 0.7499904820000012
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9235 (36940/40000), AUC 0.9758861660957336
ep3_train_time 10.652346148
Test Epoch3 layer4 Acc 0.8966, AUC 0.9596794843673706, avg_entr 0.12668362259864807, f1 0.8966000080108643
ep3_l4_test_time 0.7685937789999997
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.933475 (37339/40000), AUC 0.9812840819358826
ep4_train_time 10.632402928999994
Test Epoch4 layer4 Acc 0.8948, AUC 0.9609919786453247, avg_entr 0.10170590877532959, f1 0.8948000073432922
ep4_l4_test_time 0.736985685999997
gc 0
Train Epoch5 Acc 0.9416 (37664/40000), AUC 0.9850044846534729
ep5_train_time 10.706830091
Test Epoch5 layer4 Acc 0.8996, AUC 0.9606322050094604, avg_entr 0.060437414795160294, f1 0.8996000289916992
ep5_l4_test_time 0.7489888100000002
Save ckpt to ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.948925 (37957/40000), AUC 0.9875552654266357
ep6_train_time 10.697160376999989
Test Epoch6 layer4 Acc 0.8938, AUC 0.957176923751831, avg_entr 0.04719388857483864, f1 0.8938000202178955
ep6_l4_test_time 0.770506822999991
gc 0
Train Epoch7 Acc 0.9538 (38152/40000), AUC 0.9888682961463928
ep7_train_time 10.854962321000002
Test Epoch7 layer4 Acc 0.8958, AUC 0.9556190371513367, avg_entr 0.041882000863552094, f1 0.895799994468689
ep7_l4_test_time 0.7397679240000059
gc 0
Train Epoch8 Acc 0.958625 (38345/40000), AUC 0.990942120552063
ep8_train_time 10.836719959999996
Test Epoch8 layer4 Acc 0.8908, AUC 0.9510924816131592, avg_entr 0.03297528624534607, f1 0.8907999992370605
ep8_l4_test_time 0.7564508090000146
gc 0
Train Epoch9 Acc 0.9621 (38484/40000), AUC 0.9922593832015991
ep9_train_time 10.56836037299999
Test Epoch9 layer4 Acc 0.8888, AUC 0.9491831064224243, avg_entr 0.029269665479660034, f1 0.8888000249862671
ep9_l4_test_time 0.7927537479999955
gc 0
Train Epoch10 Acc 0.9647 (38588/40000), AUC 0.9933253526687622
ep10_train_time 10.769853826000002
Test Epoch10 layer4 Acc 0.882, AUC 0.9491416215896606, avg_entr 0.029458990320563316, f1 0.8820000290870667
ep10_l4_test_time 0.751649609999987
gc 0
Train Epoch11 Acc 0.9669 (38676/40000), AUC 0.9937878847122192
ep11_train_time 10.666148272000015
Test Epoch11 layer4 Acc 0.8854, AUC 0.9446296095848083, avg_entr 0.023969752714037895, f1 0.8853999972343445
ep11_l4_test_time 0.7620771919999925
gc 0
Train Epoch12 Acc 0.96985 (38794/40000), AUC 0.9943534135818481
ep12_train_time 10.583048119000011
Test Epoch12 layer4 Acc 0.8804, AUC 0.9454667568206787, avg_entr 0.02502422221004963, f1 0.8804000020027161
ep12_l4_test_time 0.7503708510000138
gc 0
Train Epoch13 Acc 0.9717 (38868/40000), AUC 0.9955943822860718
ep13_train_time 10.704342436000019
Test Epoch13 layer4 Acc 0.8794, AUC 0.9400944709777832, avg_entr 0.020877134054899216, f1 0.8794000148773193
ep13_l4_test_time 0.7433216539999989
gc 0
Train Epoch14 Acc 0.9732 (38928/40000), AUC 0.9958654642105103
ep14_train_time 10.695499430000012
Test Epoch14 layer4 Acc 0.8778, AUC 0.9398447275161743, avg_entr 0.02050764299929142, f1 0.8778000473976135
ep14_l4_test_time 0.7561019630000203
gc 0
Train Epoch15 Acc 0.97565 (39026/40000), AUC 0.996633768081665
ep15_train_time 10.728496925999991
Test Epoch15 layer4 Acc 0.8716, AUC 0.9360361099243164, avg_entr 0.02195243164896965, f1 0.8715999722480774
ep15_l4_test_time 0.7524054579999984
gc 0
Train Epoch16 Acc 0.976775 (39071/40000), AUC 0.9967538118362427
ep16_train_time 10.718978089999979
Test Epoch16 layer4 Acc 0.8682, AUC 0.93374103307724, avg_entr 0.020142342895269394, f1 0.8682000041007996
ep16_l4_test_time 0.7537345000000073
gc 0
Train Epoch17 Acc 0.97835 (39134/40000), AUC 0.997058093547821
ep17_train_time 10.675996214000008
Test Epoch17 layer4 Acc 0.8646, AUC 0.931171178817749, avg_entr 0.018950404599308968, f1 0.8646000027656555
ep17_l4_test_time 0.7514867480000191
gc 0
Train Epoch18 Acc 0.97955 (39182/40000), AUC 0.9971528053283691
ep18_train_time 10.670447854999992
Test Epoch18 layer4 Acc 0.8648, AUC 0.9287389516830444, avg_entr 0.017707442864775658, f1 0.8648000359535217
ep18_l4_test_time 0.750600205000012
gc 0
Train Epoch19 Acc 0.980675 (39227/40000), AUC 0.9975407123565674
ep19_train_time 10.744978895999992
Test Epoch19 layer4 Acc 0.8584, AUC 0.9254924058914185, avg_entr 0.016520196571946144, f1 0.8583999872207642
ep19_l4_test_time 0.7553606660000014
gc 0
Train Epoch20 Acc 0.9815 (39260/40000), AUC 0.9978561401367188
ep20_train_time 10.676636909999985
Test Epoch20 layer4 Acc 0.8572, AUC 0.9248883724212646, avg_entr 0.016372578218579292, f1 0.857200026512146
ep20_l4_test_time 0.7433790949999661
gc 0
Train Epoch21 Acc 0.982475 (39299/40000), AUC 0.9979921579360962
ep21_train_time 10.722534143000019
Test Epoch21 layer4 Acc 0.8568, AUC 0.9231736660003662, avg_entr 0.014316406100988388, f1 0.8568000793457031
ep21_l4_test_time 0.7543227240000192
gc 0
Train Epoch22 Acc 0.98295 (39318/40000), AUC 0.9981397986412048
ep22_train_time 10.65049510099999
Test Epoch22 layer4 Acc 0.8528, AUC 0.9205955862998962, avg_entr 0.01361977867782116, f1 0.8528000116348267
ep22_l4_test_time 0.7679891210000278
gc 0
Train Epoch23 Acc 0.983975 (39359/40000), AUC 0.9982932806015015
ep23_train_time 10.600284369000008
Test Epoch23 layer4 Acc 0.853, AUC 0.9188524484634399, avg_entr 0.013913125731050968, f1 0.8529999852180481
ep23_l4_test_time 0.7567525800000112
gc 0
Train Epoch24 Acc 0.985275 (39411/40000), AUC 0.9982891082763672
ep24_train_time 10.760791220999977
Test Epoch24 layer4 Acc 0.8514, AUC 0.9169402122497559, avg_entr 0.013537057675421238, f1 0.8514000177383423
ep24_l4_test_time 0.7551872200000389
gc 0
Train Epoch25 Acc 0.986075 (39443/40000), AUC 0.9985834360122681
ep25_train_time 10.656691927999987
Test Epoch25 layer4 Acc 0.848, AUC 0.9151556491851807, avg_entr 0.01206143293529749, f1 0.8479999899864197
ep25_l4_test_time 0.7517742730000236
gc 0
Train Epoch26 Acc 0.986 (39440/40000), AUC 0.9984869956970215
ep26_train_time 10.526644271999999
Test Epoch26 layer4 Acc 0.8474, AUC 0.91130131483078, avg_entr 0.014143659733235836, f1 0.8474000096321106
ep26_l4_test_time 0.7500241930000016
gc 0
Train Epoch27 Acc 0.98655 (39462/40000), AUC 0.9987441301345825
ep27_train_time 10.715058174999967
Test Epoch27 layer4 Acc 0.829, AUC 0.9069395661354065, avg_entr 0.012907393276691437, f1 0.8289999961853027
ep27_l4_test_time 0.7572651090000022
gc 0
Train Epoch28 Acc 0.9871 (39484/40000), AUC 0.9987428188323975
ep28_train_time 10.690308588999983
Test Epoch28 layer4 Acc 0.8428, AUC 0.9077524542808533, avg_entr 0.012606298550963402, f1 0.8428000211715698
ep28_l4_test_time 0.7591869199999906
gc 0
Train Epoch29 Acc 0.987475 (39499/40000), AUC 0.9989862442016602
ep29_train_time 10.576082375999988
Test Epoch29 layer4 Acc 0.8438, AUC 0.9069894552230835, avg_entr 0.012346731498837471, f1 0.8438000082969666
ep29_l4_test_time 0.7599495750000074
Best AUC tensor(0.8996) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 345.741852896
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8896, AUC 0.9549779295921326, avg_entr 0.1577095240354538, f1 0.8895999193191528
l0_test_time 0.7460169990000054
Test layer1 Acc 0.8904, AUC 0.9556211829185486, avg_entr 0.14359277486801147, f1 0.8903999924659729
l1_test_time 0.7332018729999845
Test layer2 Acc 0.8896, AUC 0.9562079906463623, avg_entr 0.1271650344133377, f1 0.8895999193191528
l2_test_time 0.7516052320000313
Test layer3 Acc 0.894, AUC 0.956906259059906, avg_entr 0.0995846837759018, f1 0.8939999938011169
l3_test_time 0.7609833340000023
Test layer4 Acc 0.8922, AUC 0.9564599990844727, avg_entr 0.06383369863033295, f1 0.8921999931335449
l4_test_time 0.7566864949999967
