total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 22.190816640853882
Start Training
gc 0
Train Epoch0 Acc 0.499775 (19991/40000), AUC 0.5009187459945679
ep0_train_time 78.83459234237671
Test Epoch0 layer4 Acc 0.5696, AUC 0.6037640571594238, avg_entr 0.693678617477417
ep0_l4_test_time 2.9183566570281982
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.78135 (31254/40000), AUC 0.8512028455734253
ep1_train_time 79.19451951980591
Test Epoch1 layer4 Acc 0.847, AUC 0.9180192351341248, avg_entr 0.10983149707317352
ep1_l4_test_time 2.873579978942871
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.887975 (35519/40000), AUC 0.9402927160263062
ep2_train_time 79.18477821350098
Test Epoch2 layer4 Acc 0.8856, AUC 0.9464737772941589, avg_entr 0.06114884093403816
ep2_l4_test_time 2.8874101638793945
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.918425 (36737/40000), AUC 0.9642044305801392
ep3_train_time 79.18741059303284
Test Epoch3 layer4 Acc 0.8934, AUC 0.950476348400116, avg_entr 0.05420456454157829
ep3_l4_test_time 2.8968305587768555
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.931275 (37251/40000), AUC 0.9735368490219116
ep4_train_time 79.17507266998291
Test Epoch4 layer4 Acc 0.8908, AUC 0.9536800384521484, avg_entr 0.059689149260520935
ep4_l4_test_time 2.8800899982452393
Save ckpt to ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.943 (37720/40000), AUC 0.9816296100616455
ep5_train_time 79.16467452049255
Test Epoch5 layer4 Acc 0.896, AUC 0.9497565031051636, avg_entr 0.03586651012301445
ep5_l4_test_time 2.9144833087921143
gc 0
Train Epoch6 Acc 0.9475 (37900/40000), AUC 0.9841911792755127
ep6_train_time 79.13560271263123
Test Epoch6 layer4 Acc 0.8902, AUC 0.9423638582229614, avg_entr 0.028386639431118965
ep6_l4_test_time 2.871792793273926
gc 0
Train Epoch7 Acc 0.954925 (38197/40000), AUC 0.9876695871353149
ep7_train_time 79.1684467792511
Test Epoch7 layer4 Acc 0.882, AUC 0.9442970752716064, avg_entr 0.03281092271208763
ep7_l4_test_time 2.889484405517578
gc 0
Train Epoch8 Acc 0.959325 (38373/40000), AUC 0.9900970458984375
ep8_train_time 79.23475742340088
Test Epoch8 layer4 Acc 0.8804, AUC 0.9438703060150146, avg_entr 0.03071916289627552
ep8_l4_test_time 2.8944263458251953
gc 0
Train Epoch9 Acc 0.96155 (38462/40000), AUC 0.990946888923645
ep9_train_time 79.27425479888916
Test Epoch9 layer4 Acc 0.885, AUC 0.9432840943336487, avg_entr 0.030635327100753784
ep9_l4_test_time 2.881579637527466
gc 0
Train Epoch10 Acc 0.96535 (38614/40000), AUC 0.9928275346755981
ep10_train_time 79.21998763084412
Test Epoch10 layer4 Acc 0.8798, AUC 0.9394001960754395, avg_entr 0.023399200290441513
ep10_l4_test_time 2.920197010040283
gc 0
Train Epoch11 Acc 0.9677 (38708/40000), AUC 0.9932374954223633
ep11_train_time 79.36909556388855
Test Epoch11 layer4 Acc 0.8644, AUC 0.9337977170944214, avg_entr 0.02454223670065403
ep11_l4_test_time 2.8752946853637695
gc 0
Train Epoch12 Acc 0.971225 (38849/40000), AUC 0.9945439696311951
ep12_train_time 79.17407965660095
Test Epoch12 layer4 Acc 0.8728, AUC 0.9356876611709595, avg_entr 0.024353399872779846
ep12_l4_test_time 2.8876311779022217
gc 0
Train Epoch13 Acc 0.9725 (38900/40000), AUC 0.9951603412628174
ep13_train_time 79.1388647556305
Test Epoch13 layer4 Acc 0.8704, AUC 0.9309438467025757, avg_entr 0.01701086387038231
ep13_l4_test_time 2.882266044616699
gc 0
Train Epoch14 Acc 0.975275 (39011/40000), AUC 0.9960253238677979
ep14_train_time 79.28399682044983
Test Epoch14 layer4 Acc 0.867, AUC 0.9308267831802368, avg_entr 0.02151809073984623
ep14_l4_test_time 2.8803532123565674
gc 0
Train Epoch15 Acc 0.976775 (39071/40000), AUC 0.9964385032653809
ep15_train_time 79.17676091194153
Test Epoch15 layer4 Acc 0.86, AUC 0.9287112951278687, avg_entr 0.017134930938482285
ep15_l4_test_time 2.912412405014038
gc 0
Train Epoch16 Acc 0.977925 (39117/40000), AUC 0.9966042041778564
ep16_train_time 79.22365999221802
Test Epoch16 layer4 Acc 0.8598, AUC 0.9286046028137207, avg_entr 0.021808337420225143
ep16_l4_test_time 2.8735556602478027
gc 0
Train Epoch17 Acc 0.980225 (39209/40000), AUC 0.9973257184028625
ep17_train_time 79.12557411193848
Test Epoch17 layer4 Acc 0.8608, AUC 0.926302969455719, avg_entr 0.016181612387299538
ep17_l4_test_time 2.893794536590576
gc 0
Train Epoch18 Acc 0.981775 (39271/40000), AUC 0.9976897239685059
ep18_train_time 79.2163872718811
Test Epoch18 layer4 Acc 0.8586, AUC 0.9257382154464722, avg_entr 0.02095227688550949
ep18_l4_test_time 2.889263153076172
gc 0
Train Epoch19 Acc 0.981675 (39267/40000), AUC 0.9975233674049377
ep19_train_time 79.35151672363281
Test Epoch19 layer4 Acc 0.857, AUC 0.9232079982757568, avg_entr 0.01582716405391693
ep19_l4_test_time 2.8841264247894287
gc 0
Train Epoch20 Acc 0.983525 (39341/40000), AUC 0.997890830039978
ep20_train_time 79.27820158004761
Test Epoch20 layer4 Acc 0.8504, AUC 0.9208042621612549, avg_entr 0.01628318801522255
ep20_l4_test_time 2.9153921604156494
gc 0
Train Epoch21 Acc 0.984075 (39363/40000), AUC 0.9980835914611816
ep21_train_time 79.14535522460938
Test Epoch21 layer4 Acc 0.854, AUC 0.9203661680221558, avg_entr 0.01369155291467905
ep21_l4_test_time 2.8693766593933105
gc 0
Train Epoch22 Acc 0.9852 (39408/40000), AUC 0.9984697103500366
ep22_train_time 79.1298496723175
Test Epoch22 layer4 Acc 0.8478, AUC 0.9178948998451233, avg_entr 0.012774113565683365
ep22_l4_test_time 2.8849759101867676
gc 0
Train Epoch23 Acc 0.986325 (39453/40000), AUC 0.9985266923904419
ep23_train_time 79.1747260093689
Test Epoch23 layer4 Acc 0.8492, AUC 0.9183650016784668, avg_entr 0.014803446829319
ep23_l4_test_time 2.888162851333618
gc 0
Train Epoch24 Acc 0.987325 (39493/40000), AUC 0.998688817024231
ep24_train_time 79.22664713859558
Test Epoch24 layer4 Acc 0.8474, AUC 0.9150984287261963, avg_entr 0.014983839355409145
ep24_l4_test_time 2.8796393871307373
gc 0
Train Epoch25 Acc 0.98795 (39518/40000), AUC 0.9986269474029541
ep25_train_time 79.13919687271118
Test Epoch25 layer4 Acc 0.8472, AUC 0.9149916768074036, avg_entr 0.011303326115012169
ep25_l4_test_time 2.9150474071502686
gc 0
Train Epoch26 Acc 0.988275 (39531/40000), AUC 0.9987143278121948
ep26_train_time 79.16109681129456
Test Epoch26 layer4 Acc 0.8468, AUC 0.9117069840431213, avg_entr 0.015354696661233902
ep26_l4_test_time 2.8761610984802246
gc 0
Train Epoch27 Acc 0.98855 (39542/40000), AUC 0.9988443851470947
ep27_train_time 79.15440678596497
Test Epoch27 layer4 Acc 0.8468, AUC 0.9102243185043335, avg_entr 0.012741361744701862
ep27_l4_test_time 2.891972064971924
gc 0
Train Epoch28 Acc 0.9892 (39568/40000), AUC 0.9990957975387573
ep28_train_time 79.29167866706848
Test Epoch28 layer4 Acc 0.844, AUC 0.9086097478866577, avg_entr 0.01309346966445446
ep28_l4_test_time 2.88299822807312
gc 0
Train Epoch29 Acc 0.9896 (39584/40000), AUC 0.9989856481552124
ep29_train_time 79.16435194015503
Test Epoch29 layer4 Acc 0.8394, AUC 0.9075860977172852, avg_entr 0.011714717373251915
ep29_l4_test_time 2.8811326026916504
gc 0
Train Epoch30 Acc 0.9901 (39604/40000), AUC 0.9991152882575989
ep30_train_time 79.12836170196533
Test Epoch30 layer4 Acc 0.8428, AUC 0.9094278812408447, avg_entr 0.010967678390443325
ep30_l4_test_time 2.9121882915496826
gc 0
Train Epoch31 Acc 0.99075 (39630/40000), AUC 0.99916672706604
ep31_train_time 79.17677760124207
Test Epoch31 layer4 Acc 0.8386, AUC 0.9013612270355225, avg_entr 0.012411585077643394
ep31_l4_test_time 2.867079257965088
gc 0
Train Epoch32 Acc 0.991475 (39659/40000), AUC 0.9992777109146118
ep32_train_time 79.15047335624695
Test Epoch32 layer4 Acc 0.8368, AUC 0.8982903957366943, avg_entr 0.007624270860105753
ep32_l4_test_time 2.884687900543213
gc 0
Train Epoch33 Acc 0.99135 (39654/40000), AUC 0.9992971420288086
ep33_train_time 79.1730420589447
Test Epoch33 layer4 Acc 0.831, AUC 0.8931460976600647, avg_entr 0.007634032983332872
ep33_l4_test_time 2.884977102279663
gc 0
Train Epoch34 Acc 0.991125 (39645/40000), AUC 0.9989314079284668
ep34_train_time 79.13830351829529
Test Epoch34 layer4 Acc 0.8356, AUC 0.8999525904655457, avg_entr 0.009706157259643078
ep34_l4_test_time 2.8769407272338867
gc 0
Train Epoch35 Acc 0.991875 (39675/40000), AUC 0.9993610382080078
ep35_train_time 79.09238195419312
Test Epoch35 layer4 Acc 0.8288, AUC 0.8946357369422913, avg_entr 0.013180728070437908
ep35_l4_test_time 2.911329984664917
gc 0
Train Epoch36 Acc 0.992725 (39709/40000), AUC 0.9994335174560547
ep36_train_time 79.16565680503845
Test Epoch36 layer4 Acc 0.8344, AUC 0.8962714672088623, avg_entr 0.010229561477899551
ep36_l4_test_time 2.869767904281616
gc 0
Train Epoch37 Acc 0.99355 (39742/40000), AUC 0.9994425177574158
ep37_train_time 79.26061487197876
Test Epoch37 layer4 Acc 0.831, AUC 0.8906977772712708, avg_entr 0.00960975605994463
ep37_l4_test_time 2.8993759155273438
gc 0
Train Epoch38 Acc 0.99255 (39702/40000), AUC 0.9993164539337158
ep38_train_time 79.17317628860474
Test Epoch38 layer4 Acc 0.8298, AUC 0.8903166055679321, avg_entr 0.009473410435020924
ep38_l4_test_time 2.884821891784668
gc 0
Train Epoch39 Acc 0.993625 (39745/40000), AUC 0.9995226263999939
ep39_train_time 79.18101286888123
Test Epoch39 layer4 Acc 0.8298, AUC 0.8888876438140869, avg_entr 0.009312039241194725
ep39_l4_test_time 2.879920721054077
gc 0
Train Epoch40 Acc 0.9924 (39696/40000), AUC 0.9993984699249268
ep40_train_time 79.14097023010254
Test Epoch40 layer4 Acc 0.827, AUC 0.8833467960357666, avg_entr 0.008880035020411015
ep40_l4_test_time 2.9119668006896973
gc 0
Train Epoch41 Acc 0.994575 (39783/40000), AUC 0.9995765686035156
ep41_train_time 79.14674997329712
Test Epoch41 layer4 Acc 0.8306, AUC 0.8850816488265991, avg_entr 0.008099920116364956
ep41_l4_test_time 2.8676185607910156
gc 0
Train Epoch42 Acc 0.994125 (39765/40000), AUC 0.9995054006576538
ep42_train_time 79.12207102775574
Test Epoch42 layer4 Acc 0.8206, AUC 0.8829683065414429, avg_entr 0.013070959597826004
ep42_l4_test_time 2.885956048965454
gc 0
Train Epoch43 Acc 0.99475 (39790/40000), AUC 0.999523401260376
ep43_train_time 79.14800477027893
Test Epoch43 layer4 Acc 0.8234, AUC 0.8809854984283447, avg_entr 0.008759934455156326
ep43_l4_test_time 2.8918631076812744
gc 0
Train Epoch44 Acc 0.994825 (39793/40000), AUC 0.9995830059051514
ep44_train_time 79.15921759605408
Test Epoch44 layer4 Acc 0.824, AUC 0.8832440376281738, avg_entr 0.008831877261400223
ep44_l4_test_time 2.8789219856262207
gc 0
Train Epoch45 Acc 0.994775 (39791/40000), AUC 0.9994968175888062
ep45_train_time 79.22306799888611
Test Epoch45 layer4 Acc 0.8214, AUC 0.885417103767395, avg_entr 0.009056948125362396
ep45_l4_test_time 2.9134747982025146
gc 0
Train Epoch46 Acc 0.995475 (39819/40000), AUC 0.9996562600135803
ep46_train_time 79.1897406578064
Test Epoch46 layer4 Acc 0.825, AUC 0.8854314088821411, avg_entr 0.008102118037641048
ep46_l4_test_time 2.8702964782714844
gc 0
Train Epoch47 Acc 0.996075 (39843/40000), AUC 0.9997462034225464
ep47_train_time 79.1741316318512
Test Epoch47 layer4 Acc 0.8148, AUC 0.8722050189971924, avg_entr 0.00692495284602046
ep47_l4_test_time 2.887092113494873
gc 0
Train Epoch48 Acc 0.9953 (39812/40000), AUC 0.9995317459106445
ep48_train_time 79.16540050506592
Test Epoch48 layer4 Acc 0.8188, AUC 0.8737547397613525, avg_entr 0.0074372244998812675
ep48_l4_test_time 2.8924269676208496
gc 0
Train Epoch49 Acc 0.996375 (39855/40000), AUC 0.9996800422668457
ep49_train_time 79.2391631603241
Test Epoch49 layer4 Acc 0.8166, AUC 0.8701404333114624, avg_entr 0.006878955755382776
ep49_l4_test_time 2.877441883087158
Best AUC 0.9536800384521484
train_loss (2, 5, 50)
valid_acc (1, 50)
valid_AUC (1, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
total_train+valid_time 4106.234996795654
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base_pad500//imdb_lstmal_l5.pt
Test layer4 Acc 0.8808, AUC 0.9490456581115723, avg_entr 0.05930172652006149
l4_test_time 2.8805344104766846
