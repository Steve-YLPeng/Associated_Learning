total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
gc 0
Train Epoch0 Acc 0.6433666666666666 (77204/120000), AUC 0.859618604183197
Test Epoch0 layer0 Acc 0.9025, AUC 0.9760474562644958, avg_entr 0.2542056739330292
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9026315789473685, AUC 0.9761722087860107, avg_entr 0.25729900598526
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9036842105263158, AUC 0.9761010408401489, avg_entr 0.2340877205133438
Test Epoch0 layer3 Acc 0.9018421052631579, AUC 0.9763044714927673, avg_entr 0.2298833578824997
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer4 Acc 0.9032894736842105, AUC 0.9766745567321777, avg_entr 0.22872430086135864
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.918625 (110235/120000), AUC 0.9822164177894592
Test Epoch1 layer0 Acc 0.9138157894736842, AUC 0.9795897603034973, avg_entr 0.14620649814605713
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.915, AUC 0.9795781970024109, avg_entr 0.14027096331119537
Test Epoch1 layer2 Acc 0.9144736842105263, AUC 0.9794961810112, avg_entr 0.1358882039785385
Test Epoch1 layer3 Acc 0.9144736842105263, AUC 0.9796265363693237, avg_entr 0.12969040870666504
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.9143421052631578, AUC 0.9798585176467896, avg_entr 0.12176726013422012
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9285333333333333 (111424/120000), AUC 0.9863239526748657
Test Epoch2 layer0 Acc 0.9173684210526316, AUC 0.9810469150543213, avg_entr 0.11013273894786835
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.9178947368421052, AUC 0.9809789657592773, avg_entr 0.10564704984426498
Test Epoch2 layer2 Acc 0.9180263157894737, AUC 0.9809813499450684, avg_entr 0.10118388384580612
Test Epoch2 layer3 Acc 0.9189473684210526, AUC 0.9812194108963013, avg_entr 0.09309745579957962
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.9184210526315789, AUC 0.9810478091239929, avg_entr 0.08036203682422638
gc 0
Train Epoch3 Acc 0.934075 (112089/120000), AUC 0.9887436032295227
Test Epoch3 layer0 Acc 0.915921052631579, AUC 0.981425404548645, avg_entr 0.09297054260969162
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.916578947368421, AUC 0.9812324047088623, avg_entr 0.08799424767494202
Test Epoch3 layer2 Acc 0.9164473684210527, AUC 0.9814013242721558, avg_entr 0.08440182358026505
Test Epoch3 layer3 Acc 0.916578947368421, AUC 0.9819024801254272, avg_entr 0.07438470423221588
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.9161842105263158, AUC 0.9821498394012451, avg_entr 0.057659272104501724
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9380583333333333 (112567/120000), AUC 0.9901151657104492
Test Epoch4 layer0 Acc 0.9180263157894737, AUC 0.9819588661193848, avg_entr 0.08451665937900543
Test Epoch4 layer1 Acc 0.9181578947368421, AUC 0.981721818447113, avg_entr 0.08045527338981628
Test Epoch4 layer2 Acc 0.9186842105263158, AUC 0.9820780754089355, avg_entr 0.07426102459430695
Test Epoch4 layer3 Acc 0.9185526315789474, AUC 0.9826043844223022, avg_entr 0.057708512991666794
Save ckpt to ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt  ,ep 4
Test Epoch4 layer4 Acc 0.9176315789473685, AUC 0.9820088744163513, avg_entr 0.04053793102502823
gc 0
Train Epoch5 Acc 0.9410583333333333 (112927/120000), AUC 0.9908407926559448
Test Epoch5 layer0 Acc 0.9182894736842105, AUC 0.9817321300506592, avg_entr 0.07421103864908218
Test Epoch5 layer1 Acc 0.9180263157894737, AUC 0.9814338684082031, avg_entr 0.07063232362270355
Test Epoch5 layer2 Acc 0.9172368421052631, AUC 0.9819523692131042, avg_entr 0.06329964101314545
Test Epoch5 layer3 Acc 0.9188157894736843, AUC 0.9825432896614075, avg_entr 0.04450659453868866
Test Epoch5 layer4 Acc 0.9177631578947368, AUC 0.9813740253448486, avg_entr 0.0331435464322567
gc 0
Train Epoch6 Acc 0.9436833333333333 (113242/120000), AUC 0.9914216995239258
Test Epoch6 layer0 Acc 0.9203947368421053, AUC 0.9818801283836365, avg_entr 0.07029250264167786
Test Epoch6 layer1 Acc 0.9198684210526316, AUC 0.9815447330474854, avg_entr 0.06723260879516602
Test Epoch6 layer2 Acc 0.9192105263157895, AUC 0.9822699427604675, avg_entr 0.05827640742063522
Test Epoch6 layer3 Acc 0.9193421052631578, AUC 0.9813416004180908, avg_entr 0.03714930638670921
Test Epoch6 layer4 Acc 0.9188157894736843, AUC 0.9797167778015137, avg_entr 0.029403461143374443
gc 0
Train Epoch7 Acc 0.9455833333333333 (113470/120000), AUC 0.9921219944953918
Test Epoch7 layer0 Acc 0.9167105263157894, AUC 0.9815583229064941, avg_entr 0.06525933742523193
Test Epoch7 layer1 Acc 0.9172368421052631, AUC 0.981155514717102, avg_entr 0.06220809370279312
Test Epoch7 layer2 Acc 0.9164473684210527, AUC 0.9822950959205627, avg_entr 0.050507526844739914
Test Epoch7 layer3 Acc 0.9169736842105263, AUC 0.9811496734619141, avg_entr 0.03178970143198967
Test Epoch7 layer4 Acc 0.9163157894736842, AUC 0.9801194667816162, avg_entr 0.02587704174220562
gc 0
Train Epoch8 Acc 0.9473166666666667 (113678/120000), AUC 0.992692232131958
Test Epoch8 layer0 Acc 0.9176315789473685, AUC 0.9814704656600952, avg_entr 0.06032389774918556
Test Epoch8 layer1 Acc 0.9172368421052631, AUC 0.9810870885848999, avg_entr 0.05811570957303047
Test Epoch8 layer2 Acc 0.9167105263157894, AUC 0.9823907613754272, avg_entr 0.043611425906419754
Test Epoch8 layer3 Acc 0.9160526315789473, AUC 0.9813951253890991, avg_entr 0.027856605127453804
Test Epoch8 layer4 Acc 0.9161842105263158, AUC 0.9810175895690918, avg_entr 0.023437675088644028
gc 0
Train Epoch9 Acc 0.9500333333333333 (114004/120000), AUC 0.9934217929840088
Test Epoch9 layer0 Acc 0.9172368421052631, AUC 0.9814396500587463, avg_entr 0.05722061172127724
Test Epoch9 layer1 Acc 0.916578947368421, AUC 0.9810331463813782, avg_entr 0.05516168475151062
Test Epoch9 layer2 Acc 0.9167105263157894, AUC 0.9824374318122864, avg_entr 0.037908636033535004
Test Epoch9 layer3 Acc 0.915921052631579, AUC 0.9808955192565918, avg_entr 0.02432704158127308
Test Epoch9 layer4 Acc 0.9161842105263158, AUC 0.980391263961792, avg_entr 0.020977305248379707
gc 0
Train Epoch10 Acc 0.951025 (114123/120000), AUC 0.9936673045158386
Test Epoch10 layer0 Acc 0.9177631578947368, AUC 0.9813874959945679, avg_entr 0.05511414632201195
Test Epoch10 layer1 Acc 0.9164473684210527, AUC 0.9809912443161011, avg_entr 0.053327031433582306
Test Epoch10 layer2 Acc 0.9167105263157894, AUC 0.9819447994232178, avg_entr 0.034779440611600876
Test Epoch10 layer3 Acc 0.9161842105263158, AUC 0.9811702370643616, avg_entr 0.023115910589694977
Test Epoch10 layer4 Acc 0.9163157894736842, AUC 0.9814077615737915, avg_entr 0.020419053733348846
gc 0
Train Epoch11 Acc 0.951475 (114177/120000), AUC 0.9938755631446838
Test Epoch11 layer0 Acc 0.916578947368421, AUC 0.9812442064285278, avg_entr 0.05229368805885315
Test Epoch11 layer1 Acc 0.9160526315789473, AUC 0.9807865023612976, avg_entr 0.05064288154244423
Test Epoch11 layer2 Acc 0.9168421052631579, AUC 0.9823189973831177, avg_entr 0.03180120512843132
Test Epoch11 layer3 Acc 0.9161842105263158, AUC 0.9813600182533264, avg_entr 0.021366935223340988
Test Epoch11 layer4 Acc 0.9168421052631579, AUC 0.9807222485542297, avg_entr 0.018507719039916992
gc 0
Train Epoch12 Acc 0.9521916666666667 (114263/120000), AUC 0.9939923882484436
Test Epoch12 layer0 Acc 0.9172368421052631, AUC 0.9811528921127319, avg_entr 0.050306160002946854
Test Epoch12 layer1 Acc 0.9173684210526316, AUC 0.980684757232666, avg_entr 0.0487661175429821
Test Epoch12 layer2 Acc 0.9164473684210527, AUC 0.9823043346405029, avg_entr 0.030156373977661133
Test Epoch12 layer3 Acc 0.916578947368421, AUC 0.9807111620903015, avg_entr 0.021280815824866295
Test Epoch12 layer4 Acc 0.9171052631578948, AUC 0.9808269739151001, avg_entr 0.018804114311933517
gc 0
Train Epoch13 Acc 0.9532416666666667 (114389/120000), AUC 0.9943475723266602
Test Epoch13 layer0 Acc 0.9171052631578948, AUC 0.9810848236083984, avg_entr 0.04963148012757301
Test Epoch13 layer1 Acc 0.9167105263157894, AUC 0.9806218147277832, avg_entr 0.047889165580272675
Test Epoch13 layer2 Acc 0.9152631578947369, AUC 0.9814789891242981, avg_entr 0.0295199416577816
Test Epoch13 layer3 Acc 0.9155263157894736, AUC 0.9804102778434753, avg_entr 0.021776583045721054
Test Epoch13 layer4 Acc 0.9155263157894736, AUC 0.9803451299667358, avg_entr 0.01971914991736412
gc 0
Train Epoch14 Acc 0.9536166666666667 (114434/120000), AUC 0.9943805932998657
Test Epoch14 layer0 Acc 0.9155263157894736, AUC 0.9810429811477661, avg_entr 0.04843082278966904
Test Epoch14 layer1 Acc 0.915921052631579, AUC 0.9805281162261963, avg_entr 0.046697843819856644
Test Epoch14 layer2 Acc 0.9139473684210526, AUC 0.9819450378417969, avg_entr 0.02752385474741459
Test Epoch14 layer3 Acc 0.9139473684210526, AUC 0.9804728627204895, avg_entr 0.020398464053869247
Test Epoch14 layer4 Acc 0.9146052631578947, AUC 0.9805644154548645, avg_entr 0.01839016191661358
gc 0
Train Epoch15 Acc 0.95365 (114438/120000), AUC 0.9944431185722351
Test Epoch15 layer0 Acc 0.915921052631579, AUC 0.9810166954994202, avg_entr 0.04666673019528389
Test Epoch15 layer1 Acc 0.9163157894736842, AUC 0.9804955720901489, avg_entr 0.04526757448911667
Test Epoch15 layer2 Acc 0.9144736842105263, AUC 0.981235146522522, avg_entr 0.026195742189884186
Test Epoch15 layer3 Acc 0.9155263157894736, AUC 0.9801133871078491, avg_entr 0.019859779626131058
Test Epoch15 layer4 Acc 0.9152631578947369, AUC 0.9798769354820251, avg_entr 0.017881428822875023
gc 0
Train Epoch16 Acc 0.953975 (114477/120000), AUC 0.9945404529571533
Test Epoch16 layer0 Acc 0.9156578947368421, AUC 0.980991542339325, avg_entr 0.04503164812922478
Test Epoch16 layer1 Acc 0.9155263157894736, AUC 0.9804644584655762, avg_entr 0.04355836659669876
Test Epoch16 layer2 Acc 0.915, AUC 0.9816147089004517, avg_entr 0.024577058851718903
Test Epoch16 layer3 Acc 0.9160526315789473, AUC 0.9803997278213501, avg_entr 0.01826280541718006
Test Epoch16 layer4 Acc 0.915921052631579, AUC 0.9803725481033325, avg_entr 0.01631995104253292
gc 0
Train Epoch17 Acc 0.9547416666666667 (114569/120000), AUC 0.9947088956832886
Test Epoch17 layer0 Acc 0.9155263157894736, AUC 0.9809451699256897, avg_entr 0.0438142865896225
Test Epoch17 layer1 Acc 0.9153947368421053, AUC 0.9804093837738037, avg_entr 0.04249567165970802
Test Epoch17 layer2 Acc 0.915, AUC 0.9814197421073914, avg_entr 0.024022554978728294
Test Epoch17 layer3 Acc 0.9156578947368421, AUC 0.9802612066268921, avg_entr 0.018267417326569557
Test Epoch17 layer4 Acc 0.9160526315789473, AUC 0.9798966646194458, avg_entr 0.016332758590579033
gc 0
Train Epoch18 Acc 0.954725 (114567/120000), AUC 0.9946964979171753
Test Epoch18 layer0 Acc 0.9155263157894736, AUC 0.9809225797653198, avg_entr 0.04326184093952179
Test Epoch18 layer1 Acc 0.9157894736842105, AUC 0.9803653955459595, avg_entr 0.04187639802694321
Test Epoch18 layer2 Acc 0.9139473684210526, AUC 0.9812500476837158, avg_entr 0.02352692373096943
Test Epoch18 layer3 Acc 0.9153947368421053, AUC 0.9803757071495056, avg_entr 0.018174270167946815
Test Epoch18 layer4 Acc 0.9153947368421053, AUC 0.980459988117218, avg_entr 0.01634669117629528
gc 0
Train Epoch19 Acc 0.9547333333333333 (114568/120000), AUC 0.9947590827941895
Test Epoch19 layer0 Acc 0.9155263157894736, AUC 0.9809035062789917, avg_entr 0.041987091302871704
Test Epoch19 layer1 Acc 0.915921052631579, AUC 0.980337917804718, avg_entr 0.04073832556605339
Test Epoch19 layer2 Acc 0.9134210526315789, AUC 0.9813767671585083, avg_entr 0.02279343083500862
Test Epoch19 layer3 Acc 0.9146052631578947, AUC 0.9805260896682739, avg_entr 0.01790361851453781
Test Epoch19 layer4 Acc 0.9142105263157895, AUC 0.9807069897651672, avg_entr 0.016172334551811218
gc 0
Train Epoch20 Acc 0.95515 (114618/120000), AUC 0.9947216510772705
Test Epoch20 layer0 Acc 0.9160526315789473, AUC 0.9809683561325073, avg_entr 0.04045015200972557
Test Epoch20 layer1 Acc 0.9156578947368421, AUC 0.9804311394691467, avg_entr 0.03938401862978935
Test Epoch20 layer2 Acc 0.9147368421052632, AUC 0.9808124303817749, avg_entr 0.021964384242892265
Test Epoch20 layer3 Acc 0.9156578947368421, AUC 0.9798458814620972, avg_entr 0.01679159514605999
Test Epoch20 layer4 Acc 0.915921052631579, AUC 0.9795084595680237, avg_entr 0.014977734535932541
gc 0
Train Epoch21 Acc 0.9552833333333334 (114634/120000), AUC 0.9948636889457703
Test Epoch21 layer0 Acc 0.915921052631579, AUC 0.9809619188308716, avg_entr 0.039847105741500854
Test Epoch21 layer1 Acc 0.9156578947368421, AUC 0.9803892374038696, avg_entr 0.03873400017619133
Test Epoch21 layer2 Acc 0.9142105263157895, AUC 0.9809669256210327, avg_entr 0.021461715921759605
Test Epoch21 layer3 Acc 0.9160526315789473, AUC 0.9802922606468201, avg_entr 0.016293654218316078
Test Epoch21 layer4 Acc 0.915921052631579, AUC 0.9802516102790833, avg_entr 0.014570091851055622
gc 0
Train Epoch22 Acc 0.9554916666666666 (114659/120000), AUC 0.9949206113815308
Test Epoch22 layer0 Acc 0.9156578947368421, AUC 0.9809442758560181, avg_entr 0.039297472685575485
Test Epoch22 layer1 Acc 0.9157894736842105, AUC 0.9803855419158936, avg_entr 0.038152020424604416
Test Epoch22 layer2 Acc 0.9144736842105263, AUC 0.9809423089027405, avg_entr 0.021038776263594627
Test Epoch22 layer3 Acc 0.9157894736842105, AUC 0.9800183176994324, avg_entr 0.016163231804966927
Test Epoch22 layer4 Acc 0.9152631578947369, AUC 0.9794887900352478, avg_entr 0.014453434385359287
gc 0
Train Epoch23 Acc 0.9555166666666667 (114662/120000), AUC 0.9948695302009583
Test Epoch23 layer0 Acc 0.9155263157894736, AUC 0.9809271693229675, avg_entr 0.03909296169877052
Test Epoch23 layer1 Acc 0.9152631578947369, AUC 0.9803446531295776, avg_entr 0.03783917427062988
Test Epoch23 layer2 Acc 0.9134210526315789, AUC 0.9809746146202087, avg_entr 0.020943118259310722
Test Epoch23 layer3 Acc 0.9155263157894736, AUC 0.9799914956092834, avg_entr 0.01679498888552189
Test Epoch23 layer4 Acc 0.9142105263157895, AUC 0.9799626469612122, avg_entr 0.015147211961448193
gc 0
Train Epoch24 Acc 0.9555916666666666 (114671/120000), AUC 0.9949220418930054
Test Epoch24 layer0 Acc 0.9155263157894736, AUC 0.9809342622756958, avg_entr 0.03823615238070488
Test Epoch24 layer1 Acc 0.9153947368421053, AUC 0.9803491234779358, avg_entr 0.037042874842882156
Test Epoch24 layer2 Acc 0.9134210526315789, AUC 0.9810036420822144, avg_entr 0.020229222252964973
Test Epoch24 layer3 Acc 0.9155263157894736, AUC 0.980156660079956, avg_entr 0.015616443008184433
Test Epoch24 layer4 Acc 0.915, AUC 0.9800912737846375, avg_entr 0.013966361992061138
gc 0
Train Epoch25 Acc 0.95575 (114690/120000), AUC 0.9949671626091003
Test Epoch25 layer0 Acc 0.9152631578947369, AUC 0.9809262752532959, avg_entr 0.03805553540587425
Test Epoch25 layer1 Acc 0.9157894736842105, AUC 0.9803388118743896, avg_entr 0.036757323890924454
Test Epoch25 layer2 Acc 0.9143421052631578, AUC 0.9808021783828735, avg_entr 0.020237324759364128
Test Epoch25 layer3 Acc 0.9152631578947369, AUC 0.9799916744232178, avg_entr 0.015933465212583542
Test Epoch25 layer4 Acc 0.9156578947368421, AUC 0.9797410368919373, avg_entr 0.014168227091431618
gc 0
Train Epoch26 Acc 0.9559333333333333 (114712/120000), AUC 0.9949392676353455
Test Epoch26 layer0 Acc 0.9153947368421053, AUC 0.9809303879737854, avg_entr 0.038030870258808136
Test Epoch26 layer1 Acc 0.9156578947368421, AUC 0.9803467988967896, avg_entr 0.036655474454164505
Test Epoch26 layer2 Acc 0.9144736842105263, AUC 0.980857253074646, avg_entr 0.020179733633995056
Test Epoch26 layer3 Acc 0.9152631578947369, AUC 0.9800291657447815, avg_entr 0.01599717326462269
Test Epoch26 layer4 Acc 0.9155263157894736, AUC 0.9798856973648071, avg_entr 0.014316266402602196
gc 0
Train Epoch27 Acc 0.955975 (114717/120000), AUC 0.9949885606765747
Test Epoch27 layer0 Acc 0.9151315789473684, AUC 0.9809228181838989, avg_entr 0.037911705672740936
Test Epoch27 layer1 Acc 0.9156578947368421, AUC 0.9803493022918701, avg_entr 0.036480121314525604
Test Epoch27 layer2 Acc 0.9143421052631578, AUC 0.9810259342193604, avg_entr 0.020050110295414925
Test Epoch27 layer3 Acc 0.9156578947368421, AUC 0.9804781675338745, avg_entr 0.015907591208815575
Test Epoch27 layer4 Acc 0.9153947368421053, AUC 0.9805976152420044, avg_entr 0.014314224012196064
gc 0
Train Epoch28 Acc 0.9558416666666667 (114701/120000), AUC 0.9949994087219238
Test Epoch28 layer0 Acc 0.9146052631578947, AUC 0.980923056602478, avg_entr 0.03756843879818916
Test Epoch28 layer1 Acc 0.9156578947368421, AUC 0.9803346991539001, avg_entr 0.03624764457345009
Test Epoch28 layer2 Acc 0.9140789473684211, AUC 0.9811302423477173, avg_entr 0.019525250419974327
Test Epoch28 layer3 Acc 0.915, AUC 0.9804327487945557, avg_entr 0.014974290505051613
Test Epoch28 layer4 Acc 0.915, AUC 0.9803395867347717, avg_entr 0.013497821986675262
gc 0
Train Epoch29 Acc 0.9559083333333334 (114709/120000), AUC 0.9950152635574341
Test Epoch29 layer0 Acc 0.9155263157894736, AUC 0.9809464812278748, avg_entr 0.03757304325699806
Test Epoch29 layer1 Acc 0.9151315789473684, AUC 0.9803450107574463, avg_entr 0.03619574382901192
Test Epoch29 layer2 Acc 0.9138157894736842, AUC 0.9809298515319824, avg_entr 0.01961931772530079
Test Epoch29 layer3 Acc 0.9155263157894736, AUC 0.9802933931350708, avg_entr 0.015289559960365295
Test Epoch29 layer4 Acc 0.9155263157894736, AUC 0.9801969528198242, avg_entr 0.013706211932003498
Best AUC 0.9826043844223022
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5_pad150//ag_news_linearal_l5.pt
[[1686   61  102   51]
 [   9 1867   13   11]
 [  37   10 1713  140]
 [  38   11  140 1711]]
Figure(640x480)
tensor([0.0284, 0.0008, 0.0190,  ..., 0.1094, 0.0023, 0.0755])
[[1685   61  105   49]
 [   7 1869   13   11]
 [  35   14 1709  142]
 [  35   12  138 1715]]
Figure(640x480)
tensor([0.0212, 0.0014, 0.0172,  ..., 0.0618, 0.0024, 0.0537])
[[1687   60  103   50]
 [   7 1871   11   11]
 [  34   17 1709  140]
 [  35   15  135 1715]]
Figure(640x480)
tensor([0.0146, 0.0015, 0.0137,  ..., 0.0333, 0.0017, 0.0452])
[[1687   60  100   53]
 [  10 1865   15   10]
 [  34   11 1706  149]
 [  31   11  135 1723]]
Figure(640x480)
tensor([0.0064, 0.0011, 0.0092,  ..., 0.0161, 0.0012, 0.0230])
[[1676   61  108   55]
 [  13 1863   14   10]
 [  30   12 1720  138]
 [  29    9  147 1715]]
Figure(640x480)
tensor([0.0030, 0.0027, 0.0038,  ..., 0.0056, 0.0013, 0.0051])
