total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
gc 0
Train Epoch0 Acc 0.7337416666666666 (88049/120000), AUC 0.9157021045684814
Test Epoch0 layer0 Acc 0.8968421052631579, AUC 0.9736321568489075, avg_entr 0.2798881232738495
Save ckpt to ckpt/ag_news_lstmal_l5_pad250//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9007894736842105, AUC 0.9791638851165771, avg_entr 0.11192617565393448
Save ckpt to ckpt/ag_news_lstmal_l5_pad250//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.8989473684210526, AUC 0.9790084362030029, avg_entr 0.10942645370960236
Test Epoch0 layer3 Acc 0.8986842105263158, AUC 0.9779855012893677, avg_entr 0.12313969433307648
Test Epoch0 layer4 Acc 0.8977631578947368, AUC 0.9782664775848389, avg_entr 0.12144732475280762
gc 0
Train Epoch1 Acc 0.9172833333333333 (110074/120000), AUC 0.9812910556793213
Test Epoch1 layer0 Acc 0.9113157894736842, AUC 0.9781795740127563, avg_entr 0.15501421689987183
Test Epoch1 layer1 Acc 0.9136842105263158, AUC 0.9832876920700073, avg_entr 0.06043272837996483
Save ckpt to ckpt/ag_news_lstmal_l5_pad250//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9142105263157895, AUC 0.9834092855453491, avg_entr 0.055794332176446915
Save ckpt to ckpt/ag_news_lstmal_l5_pad250//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9144736842105263, AUC 0.9825708866119385, avg_entr 0.05915588513016701
Test Epoch1 layer4 Acc 0.9148684210526316, AUC 0.9808962345123291, avg_entr 0.05618546903133392
gc 0
Train Epoch2 Acc 0.930025 (111603/120000), AUC 0.9859271049499512
Test Epoch2 layer0 Acc 0.9127631578947368, AUC 0.9799911975860596, avg_entr 0.11447029560804367
Test Epoch2 layer1 Acc 0.9172368421052631, AUC 0.9837313890457153, avg_entr 0.04156232252717018
Save ckpt to ckpt/ag_news_lstmal_l5_pad250//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.9177631578947368, AUC 0.983579158782959, avg_entr 0.0370657779276371
Test Epoch2 layer3 Acc 0.9194736842105263, AUC 0.9836403131484985, avg_entr 0.038562797009944916
Test Epoch2 layer4 Acc 0.9182894736842105, AUC 0.9836680889129639, avg_entr 0.03854313865303993
gc 0
Train Epoch3 Acc 0.937075 (112449/120000), AUC 0.988552451133728
Test Epoch3 layer0 Acc 0.9172368421052631, AUC 0.980981707572937, avg_entr 0.09597036987543106
Test Epoch3 layer1 Acc 0.9182894736842105, AUC 0.9841347336769104, avg_entr 0.03282556310296059
Save ckpt to ckpt/ag_news_lstmal_l5_pad250//ag_news_lstmal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.9193421052631578, AUC 0.9843158721923828, avg_entr 0.02886069566011429
Save ckpt to ckpt/ag_news_lstmal_l5_pad250//ag_news_lstmal_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.9184210526315789, AUC 0.9833835363388062, avg_entr 0.030347898602485657
Test Epoch3 layer4 Acc 0.9184210526315789, AUC 0.9829192757606506, avg_entr 0.030636943876743317
gc 0
Train Epoch4 Acc 0.9419666666666666 (113036/120000), AUC 0.9903870820999146
Test Epoch4 layer0 Acc 0.9176315789473685, AUC 0.9814690351486206, avg_entr 0.08166556805372238
Test Epoch4 layer1 Acc 0.9160526315789473, AUC 0.9842963814735413, avg_entr 0.028155405074357986
Test Epoch4 layer2 Acc 0.9160526315789473, AUC 0.9842945337295532, avg_entr 0.02479627914726734
Test Epoch4 layer3 Acc 0.9167105263157894, AUC 0.9840585589408875, avg_entr 0.025468051433563232
Test Epoch4 layer4 Acc 0.9168421052631579, AUC 0.9835611581802368, avg_entr 0.025180188938975334
gc 0
Train Epoch5 Acc 0.9459583333333333 (113515/120000), AUC 0.9914132356643677
Test Epoch5 layer0 Acc 0.9167105263157894, AUC 0.981913685798645, avg_entr 0.07845285534858704
Test Epoch5 layer1 Acc 0.915921052631579, AUC 0.9836479425430298, avg_entr 0.026918919757008553
Test Epoch5 layer2 Acc 0.9156578947368421, AUC 0.9836336970329285, avg_entr 0.02324845641851425
Test Epoch5 layer3 Acc 0.9157894736842105, AUC 0.9835022687911987, avg_entr 0.023228676989674568
Test Epoch5 layer4 Acc 0.915921052631579, AUC 0.9825770854949951, avg_entr 0.02344798669219017
gc 0
Train Epoch6 Acc 0.949125 (113895/120000), AUC 0.9924886226654053
Test Epoch6 layer0 Acc 0.9173684210526316, AUC 0.9818893074989319, avg_entr 0.06836826354265213
Test Epoch6 layer1 Acc 0.9156578947368421, AUC 0.9839663505554199, avg_entr 0.024094460532069206
Test Epoch6 layer2 Acc 0.9156578947368421, AUC 0.9842190742492676, avg_entr 0.020690901204943657
Test Epoch6 layer3 Acc 0.9163157894736842, AUC 0.9834275841712952, avg_entr 0.020259110257029533
Test Epoch6 layer4 Acc 0.916578947368421, AUC 0.9823780655860901, avg_entr 0.01994631625711918
gc 0
Train Epoch7 Acc 0.9523666666666667 (114284/120000), AUC 0.9930974245071411
Test Epoch7 layer0 Acc 0.9172368421052631, AUC 0.982050359249115, avg_entr 0.06312733888626099
Test Epoch7 layer1 Acc 0.9164473684210527, AUC 0.983553409576416, avg_entr 0.02429228648543358
Test Epoch7 layer2 Acc 0.9173684210526316, AUC 0.9839062690734863, avg_entr 0.02056671306490898
Test Epoch7 layer3 Acc 0.9181578947368421, AUC 0.983436644077301, avg_entr 0.02075156383216381
Test Epoch7 layer4 Acc 0.9182894736842105, AUC 0.9823620319366455, avg_entr 0.020837828516960144
gc 0
Train Epoch8 Acc 0.954875 (114585/120000), AUC 0.9936989545822144
Test Epoch8 layer0 Acc 0.9157894736842105, AUC 0.9819933176040649, avg_entr 0.05977125093340874
Test Epoch8 layer1 Acc 0.9146052631578947, AUC 0.9832419157028198, avg_entr 0.02108481526374817
Test Epoch8 layer2 Acc 0.9155263157894736, AUC 0.9834036827087402, avg_entr 0.018652480095624924
Test Epoch8 layer3 Acc 0.915921052631579, AUC 0.9830800890922546, avg_entr 0.01844128780066967
Test Epoch8 layer4 Acc 0.9161842105263158, AUC 0.982523500919342, avg_entr 0.018821580335497856
gc 0
Train Epoch9 Acc 0.957325 (114879/120000), AUC 0.9940468072891235
Test Epoch9 layer0 Acc 0.9172368421052631, AUC 0.9819467663764954, avg_entr 0.05543411150574684
Test Epoch9 layer1 Acc 0.9148684210526316, AUC 0.9827825427055359, avg_entr 0.02053416334092617
Test Epoch9 layer2 Acc 0.915, AUC 0.9831140637397766, avg_entr 0.017578599974513054
Test Epoch9 layer3 Acc 0.9160526315789473, AUC 0.9826606512069702, avg_entr 0.01760539971292019
Test Epoch9 layer4 Acc 0.9152631578947369, AUC 0.9812703132629395, avg_entr 0.01773432269692421
gc 0
Train Epoch10 Acc 0.9587583333333334 (115051/120000), AUC 0.9943972826004028
Test Epoch10 layer0 Acc 0.9178947368421052, AUC 0.9818580746650696, avg_entr 0.053407199680805206
Test Epoch10 layer1 Acc 0.9143421052631578, AUC 0.9824039340019226, avg_entr 0.019580598920583725
Test Epoch10 layer2 Acc 0.9160526315789473, AUC 0.9827575087547302, avg_entr 0.01671288162469864
Test Epoch10 layer3 Acc 0.916578947368421, AUC 0.9822219014167786, avg_entr 0.017355503514409065
Test Epoch10 layer4 Acc 0.915921052631579, AUC 0.981347918510437, avg_entr 0.0181436724960804
gc 0
Train Epoch11 Acc 0.9603083333333333 (115237/120000), AUC 0.9947987794876099
Test Epoch11 layer0 Acc 0.9180263157894737, AUC 0.9817357063293457, avg_entr 0.05053352937102318
Test Epoch11 layer1 Acc 0.9143421052631578, AUC 0.9824101328849792, avg_entr 0.018429070711135864
Test Epoch11 layer2 Acc 0.9151315789473684, AUC 0.9826716184616089, avg_entr 0.016209304332733154
Test Epoch11 layer3 Acc 0.9168421052631579, AUC 0.982081413269043, avg_entr 0.01648690737783909
Test Epoch11 layer4 Acc 0.9163157894736842, AUC 0.9805845022201538, avg_entr 0.01689130999147892
gc 0
Train Epoch12 Acc 0.962775 (115533/120000), AUC 0.9953294992446899
Test Epoch12 layer0 Acc 0.9177631578947368, AUC 0.9816311001777649, avg_entr 0.047849707305431366
Test Epoch12 layer1 Acc 0.9123684210526316, AUC 0.9819090962409973, avg_entr 0.018338613212108612
Test Epoch12 layer2 Acc 0.9144736842105263, AUC 0.9825965762138367, avg_entr 0.016093000769615173
Test Epoch12 layer3 Acc 0.915, AUC 0.981623649597168, avg_entr 0.01575114019215107
Test Epoch12 layer4 Acc 0.9163157894736842, AUC 0.9804470539093018, avg_entr 0.01628156378865242
gc 0
Train Epoch13 Acc 0.9640666666666666 (115688/120000), AUC 0.9954178333282471
Test Epoch13 layer0 Acc 0.915921052631579, AUC 0.9815983176231384, avg_entr 0.0470818467438221
Test Epoch13 layer1 Acc 0.9119736842105263, AUC 0.9816981554031372, avg_entr 0.017459776252508163
Test Epoch13 layer2 Acc 0.9134210526315789, AUC 0.9821340441703796, avg_entr 0.014837444759905338
Test Epoch13 layer3 Acc 0.9138157894736842, AUC 0.9814132452011108, avg_entr 0.015007601119577885
Test Epoch13 layer4 Acc 0.9153947368421053, AUC 0.9792952537536621, avg_entr 0.015540610067546368
gc 0
Train Epoch14 Acc 0.964725 (115767/120000), AUC 0.9955378174781799
Test Epoch14 layer0 Acc 0.9173684210526316, AUC 0.9815456867218018, avg_entr 0.04510971158742905
Test Epoch14 layer1 Acc 0.911578947368421, AUC 0.9811403751373291, avg_entr 0.016899272799491882
Test Epoch14 layer2 Acc 0.9122368421052631, AUC 0.9817334413528442, avg_entr 0.014425046741962433
Test Epoch14 layer3 Acc 0.9131578947368421, AUC 0.980789065361023, avg_entr 0.014432793483138084
Test Epoch14 layer4 Acc 0.9139473684210526, AUC 0.9794101715087891, avg_entr 0.014863215386867523
gc 0
Train Epoch15 Acc 0.965625 (115875/120000), AUC 0.9956107139587402
Test Epoch15 layer0 Acc 0.9172368421052631, AUC 0.9813944101333618, avg_entr 0.044073231518268585
Test Epoch15 layer1 Acc 0.9107894736842105, AUC 0.9810590744018555, avg_entr 0.01614079438149929
Test Epoch15 layer2 Acc 0.9123684210526316, AUC 0.9812240600585938, avg_entr 0.013147275894880295
Test Epoch15 layer3 Acc 0.9135526315789474, AUC 0.9800887107849121, avg_entr 0.01264365017414093
Test Epoch15 layer4 Acc 0.9135526315789474, AUC 0.9780950546264648, avg_entr 0.012982821092009544
gc 0
Train Epoch16 Acc 0.96665 (115998/120000), AUC 0.9958261847496033
Test Epoch16 layer0 Acc 0.9168421052631579, AUC 0.9813684225082397, avg_entr 0.04251931980252266
Test Epoch16 layer1 Acc 0.9106578947368421, AUC 0.9810750484466553, avg_entr 0.016222644597291946
Test Epoch16 layer2 Acc 0.9106578947368421, AUC 0.9816317558288574, avg_entr 0.014038477092981339
Test Epoch16 layer3 Acc 0.9119736842105263, AUC 0.9802713394165039, avg_entr 0.01363891176879406
Test Epoch16 layer4 Acc 0.9121052631578948, AUC 0.979374349117279, avg_entr 0.014291725121438503
gc 0
Train Epoch17 Acc 0.967575 (116109/120000), AUC 0.9959163665771484
Test Epoch17 layer0 Acc 0.9172368421052631, AUC 0.9813649654388428, avg_entr 0.04166557639837265
Test Epoch17 layer1 Acc 0.9106578947368421, AUC 0.9807919263839722, avg_entr 0.015847017988562584
Test Epoch17 layer2 Acc 0.911578947368421, AUC 0.9811570048332214, avg_entr 0.01317518763244152
Test Epoch17 layer3 Acc 0.9113157894736842, AUC 0.9798374772071838, avg_entr 0.012952188029885292
Test Epoch17 layer4 Acc 0.9125, AUC 0.9782353639602661, avg_entr 0.013065727427601814
gc 0
Train Epoch18 Acc 0.9680416666666667 (116165/120000), AUC 0.9958946704864502
Test Epoch18 layer0 Acc 0.9177631578947368, AUC 0.98134446144104, avg_entr 0.040669843554496765
Test Epoch18 layer1 Acc 0.91, AUC 0.9805476665496826, avg_entr 0.015244518406689167
Test Epoch18 layer2 Acc 0.9103947368421053, AUC 0.9807551503181458, avg_entr 0.012807547114789486
Test Epoch18 layer3 Acc 0.9111842105263158, AUC 0.9797271490097046, avg_entr 0.012254560366272926
Test Epoch18 layer4 Acc 0.9122368421052631, AUC 0.9780626893043518, avg_entr 0.012475952506065369
gc 0
Train Epoch19 Acc 0.968225 (116187/120000), AUC 0.9959138631820679
Test Epoch19 layer0 Acc 0.9175, AUC 0.9813327789306641, avg_entr 0.03934212028980255
Test Epoch19 layer1 Acc 0.91, AUC 0.9804465770721436, avg_entr 0.014809783548116684
Test Epoch19 layer2 Acc 0.9093421052631578, AUC 0.9809128046035767, avg_entr 0.012366929091513157
Test Epoch19 layer3 Acc 0.910921052631579, AUC 0.9799073934555054, avg_entr 0.011829265393316746
Test Epoch19 layer4 Acc 0.910921052631579, AUC 0.9785130023956299, avg_entr 0.012107246555387974
gc 0
Train Epoch20 Acc 0.9691083333333333 (116293/120000), AUC 0.9960060119628906
Test Epoch20 layer0 Acc 0.9168421052631579, AUC 0.9812448620796204, avg_entr 0.039333879947662354
Test Epoch20 layer1 Acc 0.9089473684210526, AUC 0.9804539084434509, avg_entr 0.01427431683987379
Test Epoch20 layer2 Acc 0.9094736842105263, AUC 0.9807155132293701, avg_entr 0.011949929408729076
Test Epoch20 layer3 Acc 0.9102631578947369, AUC 0.9797621369361877, avg_entr 0.011075897142291069
Test Epoch20 layer4 Acc 0.9102631578947369, AUC 0.9782410860061646, avg_entr 0.011371545493602753
gc 0
Train Epoch21 Acc 0.9693916666666667 (116327/120000), AUC 0.9960299134254456
Test Epoch21 layer0 Acc 0.9169736842105263, AUC 0.9812416434288025, avg_entr 0.03804264962673187
Test Epoch21 layer1 Acc 0.9092105263157895, AUC 0.9802953004837036, avg_entr 0.014161919243633747
Test Epoch21 layer2 Acc 0.9086842105263158, AUC 0.9805238842964172, avg_entr 0.011632817797362804
Test Epoch21 layer3 Acc 0.9110526315789473, AUC 0.9792889952659607, avg_entr 0.011158994399011135
Test Epoch21 layer4 Acc 0.9113157894736842, AUC 0.977917492389679, avg_entr 0.011346656829118729
gc 0
Train Epoch22 Acc 0.9696333333333333 (116356/120000), AUC 0.9960582852363586
Test Epoch22 layer0 Acc 0.9172368421052631, AUC 0.9812026619911194, avg_entr 0.03804782032966614
Test Epoch22 layer1 Acc 0.9093421052631578, AUC 0.9801198840141296, avg_entr 0.013803018257021904
Test Epoch22 layer2 Acc 0.9086842105263158, AUC 0.9804272055625916, avg_entr 0.011270510032773018
Test Epoch22 layer3 Acc 0.910921052631579, AUC 0.9791069626808167, avg_entr 0.010696329176425934
Test Epoch22 layer4 Acc 0.9102631578947369, AUC 0.9778324365615845, avg_entr 0.011117959395051003
gc 0
Train Epoch23 Acc 0.9698166666666667 (116378/120000), AUC 0.9960280656814575
Test Epoch23 layer0 Acc 0.9172368421052631, AUC 0.9811819791793823, avg_entr 0.037448421120643616
Test Epoch23 layer1 Acc 0.9090789473684211, AUC 0.979948878288269, avg_entr 0.013767894357442856
Test Epoch23 layer2 Acc 0.91, AUC 0.980154275894165, avg_entr 0.010959182865917683
Test Epoch23 layer3 Acc 0.9106578947368421, AUC 0.9789601564407349, avg_entr 0.010661361739039421
Test Epoch23 layer4 Acc 0.9113157894736842, AUC 0.9774113893508911, avg_entr 0.010719089768826962
gc 0
Train Epoch24 Acc 0.969975 (116397/120000), AUC 0.9961069822311401
Test Epoch24 layer0 Acc 0.9163157894736842, AUC 0.9811850190162659, avg_entr 0.037329431623220444
Test Epoch24 layer1 Acc 0.9090789473684211, AUC 0.9801190495491028, avg_entr 0.013519443571567535
Test Epoch24 layer2 Acc 0.9084210526315789, AUC 0.9803747534751892, avg_entr 0.011005353182554245
Test Epoch24 layer3 Acc 0.91, AUC 0.9788539409637451, avg_entr 0.010465102270245552
Test Epoch24 layer4 Acc 0.9098684210526315, AUC 0.9776131510734558, avg_entr 0.01087251678109169
gc 0
Train Epoch25 Acc 0.9701833333333333 (116422/120000), AUC 0.9961113929748535
Test Epoch25 layer0 Acc 0.9173684210526316, AUC 0.981175422668457, avg_entr 0.03710339218378067
Test Epoch25 layer1 Acc 0.9090789473684211, AUC 0.9799998998641968, avg_entr 0.013376479037106037
Test Epoch25 layer2 Acc 0.9084210526315789, AUC 0.9802799224853516, avg_entr 0.01088107842952013
Test Epoch25 layer3 Acc 0.9103947368421053, AUC 0.9785999655723572, avg_entr 0.01041126437485218
Test Epoch25 layer4 Acc 0.9101315789473684, AUC 0.9773319363594055, avg_entr 0.010642929933965206
gc 0
Train Epoch26 Acc 0.9702083333333333 (116425/120000), AUC 0.9961171746253967
Test Epoch26 layer0 Acc 0.9167105263157894, AUC 0.9811713695526123, avg_entr 0.03677027300000191
Test Epoch26 layer1 Acc 0.9088157894736842, AUC 0.979975700378418, avg_entr 0.01331840269267559
Test Epoch26 layer2 Acc 0.9085526315789474, AUC 0.9801234006881714, avg_entr 0.010595055297017097
Test Epoch26 layer3 Acc 0.9096052631578947, AUC 0.9784729480743408, avg_entr 0.00985597912222147
Test Epoch26 layer4 Acc 0.9097368421052632, AUC 0.9772282242774963, avg_entr 0.01033821888267994
gc 0
Train Epoch27 Acc 0.97045 (116454/120000), AUC 0.9961225986480713
Test Epoch27 layer0 Acc 0.915921052631579, AUC 0.981184720993042, avg_entr 0.03694571182131767
Test Epoch27 layer1 Acc 0.9086842105263158, AUC 0.9798800945281982, avg_entr 0.013178747147321701
Test Epoch27 layer2 Acc 0.9085526315789474, AUC 0.9800030589103699, avg_entr 0.010503520257771015
Test Epoch27 layer3 Acc 0.9097368421052632, AUC 0.9783874154090881, avg_entr 0.009936586022377014
Test Epoch27 layer4 Acc 0.9103947368421053, AUC 0.9770323038101196, avg_entr 0.01028644572943449
gc 0
Train Epoch28 Acc 0.97055 (116466/120000), AUC 0.9961469173431396
Test Epoch28 layer0 Acc 0.9167105263157894, AUC 0.9811697602272034, avg_entr 0.03659090772271156
Test Epoch28 layer1 Acc 0.9092105263157895, AUC 0.979831874370575, avg_entr 0.01294394675642252
Test Epoch28 layer2 Acc 0.9086842105263158, AUC 0.9800543189048767, avg_entr 0.010313887149095535
Test Epoch28 layer3 Acc 0.9102631578947369, AUC 0.9781982898712158, avg_entr 0.009845816530287266
Test Epoch28 layer4 Acc 0.9105263157894737, AUC 0.9769588708877563, avg_entr 0.010111227631568909
gc 0
Train Epoch29 Acc 0.970675 (116481/120000), AUC 0.9961540102958679
Test Epoch29 layer0 Acc 0.916578947368421, AUC 0.9811595678329468, avg_entr 0.036370471119880676
Test Epoch29 layer1 Acc 0.9088157894736842, AUC 0.9798325300216675, avg_entr 0.013052824884653091
Test Epoch29 layer2 Acc 0.9086842105263158, AUC 0.9800515174865723, avg_entr 0.010568853467702866
Test Epoch29 layer3 Acc 0.9103947368421053, AUC 0.9783141016960144, avg_entr 0.010101811960339546
Test Epoch29 layer4 Acc 0.9098684210526315, AUC 0.9769494533538818, avg_entr 0.010183372534811497
Best AUC 0.9843158721923828
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5_pad250//ag_news_lstmal_l5.pt
[[1693   65   96   46]
 [   7 1876    9    8]
 [  37   18 1689  156]
 [  43   16  128 1713]]
Figure(640x480)
tensor([0.0468, 0.0012, 0.0497,  ..., 0.0435, 0.0067, 0.4396])
[[1709   52   73   66]
 [  17 1857   14   12]
 [  50   11 1680  159]
 [  34   11  122 1733]]
Figure(640x480)
tensor([0.0081, 0.0031, 0.0036,  ..., 0.0032, 0.0043, 0.0181])
[[1714   52   70   64]
 [  17 1858   14   11]
 [  49    9 1684  158]
 [  35   11  123 1731]]
Figure(640x480)
tensor([0.0060, 0.0033, 0.0042,  ..., 0.0029, 0.0043, 0.0161])
[[1712   51   70   67]
 [  17 1853   14   16]
 [  49   10 1671  170]
 [  31   10  115 1744]]
Figure(640x480)
tensor([0.0096, 0.0033, 0.0046,  ..., 0.0030, 0.0071, 0.0249])
[[1714   51   69   66]
 [  17 1856   14   13]
 [  51   12 1670  167]
 [  34   10  116 1740]]
Figure(640x480)
tensor([0.0098, 0.0037, 0.0048,  ..., 0.0024, 0.0070, 0.0189])
