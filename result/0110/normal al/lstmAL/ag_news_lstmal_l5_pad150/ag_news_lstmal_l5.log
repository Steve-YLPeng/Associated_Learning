total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
gc 0
Train Epoch0 Acc 0.7118583333333334 (85423/120000), AUC 0.9065475463867188
Test Epoch0 layer0 Acc 0.9023684210526316, AUC 0.9760146737098694, avg_entr 0.2592891454696655
Save ckpt to ckpt/ag_news_lstmal_l5_pad150//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9042105263157895, AUC 0.9791856408119202, avg_entr 0.11532983928918839
Save ckpt to ckpt/ag_news_lstmal_l5_pad150//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9026315789473685, AUC 0.9801846742630005, avg_entr 0.1082673892378807
Save ckpt to ckpt/ag_news_lstmal_l5_pad150//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9028947368421053, AUC 0.9769967198371887, avg_entr 0.10731621086597443
Test Epoch0 layer4 Acc 0.9021052631578947, AUC 0.9775741696357727, avg_entr 0.11284463107585907
gc 0
Train Epoch1 Acc 0.9212333333333333 (110548/120000), AUC 0.9816713333129883
Test Epoch1 layer0 Acc 0.9136842105263158, AUC 0.9795289635658264, avg_entr 0.15319235622882843
Test Epoch1 layer1 Acc 0.9177631578947368, AUC 0.9829241633415222, avg_entr 0.05537579208612442
Save ckpt to ckpt/ag_news_lstmal_l5_pad150//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9169736842105263, AUC 0.9833353757858276, avg_entr 0.050826892256736755
Save ckpt to ckpt/ag_news_lstmal_l5_pad150//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9167105263157894, AUC 0.9802589416503906, avg_entr 0.04996856302022934
Test Epoch1 layer4 Acc 0.9155263157894736, AUC 0.9812047481536865, avg_entr 0.052330583333969116
gc 0
Train Epoch2 Acc 0.9326416666666667 (111917/120000), AUC 0.986545205116272
Test Epoch2 layer0 Acc 0.9153947368421053, AUC 0.9807762503623962, avg_entr 0.1140083372592926
Test Epoch2 layer1 Acc 0.9196052631578947, AUC 0.9838339686393738, avg_entr 0.04149211570620537
Save ckpt to ckpt/ag_news_lstmal_l5_pad150//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.9197368421052632, AUC 0.9843929409980774, avg_entr 0.03820842504501343
Save ckpt to ckpt/ag_news_lstmal_l5_pad150//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.9193421052631578, AUC 0.9815316200256348, avg_entr 0.03659572824835777
Test Epoch2 layer4 Acc 0.9194736842105263, AUC 0.9827067852020264, avg_entr 0.03783765062689781
gc 0
Train Epoch3 Acc 0.9399333333333333 (112792/120000), AUC 0.9891802072525024
Test Epoch3 layer0 Acc 0.9178947368421052, AUC 0.9813476204872131, avg_entr 0.09359537065029144
Test Epoch3 layer1 Acc 0.9168421052631579, AUC 0.9838550090789795, avg_entr 0.033410631120204926
Test Epoch3 layer2 Acc 0.9160526315789473, AUC 0.9840385317802429, avg_entr 0.03050464577972889
Test Epoch3 layer3 Acc 0.915, AUC 0.9812040328979492, avg_entr 0.029308779165148735
Test Epoch3 layer4 Acc 0.9152631578947369, AUC 0.9826310873031616, avg_entr 0.030995583161711693
gc 0
Train Epoch4 Acc 0.9447833333333333 (113374/120000), AUC 0.9905869364738464
Test Epoch4 layer0 Acc 0.9177631578947368, AUC 0.981772780418396, avg_entr 0.08444462716579437
Test Epoch4 layer1 Acc 0.9156578947368421, AUC 0.9839483499526978, avg_entr 0.03062557801604271
Test Epoch4 layer2 Acc 0.9167105263157894, AUC 0.9838889241218567, avg_entr 0.02740486152470112
Test Epoch4 layer3 Acc 0.916578947368421, AUC 0.9813584089279175, avg_entr 0.02563566528260708
Test Epoch4 layer4 Acc 0.9161842105263158, AUC 0.983450174331665, avg_entr 0.026362774893641472
gc 0
Train Epoch5 Acc 0.94835 (113802/120000), AUC 0.9916784167289734
Test Epoch5 layer0 Acc 0.9173684210526316, AUC 0.9816828370094299, avg_entr 0.0740140825510025
Test Epoch5 layer1 Acc 0.9167105263157894, AUC 0.9841233491897583, avg_entr 0.02758943848311901
Test Epoch5 layer2 Acc 0.9181578947368421, AUC 0.9842383861541748, avg_entr 0.023794114589691162
Test Epoch5 layer3 Acc 0.9182894736842105, AUC 0.982282817363739, avg_entr 0.022559043020009995
Test Epoch5 layer4 Acc 0.9175, AUC 0.9829277992248535, avg_entr 0.02356201410293579
gc 0
Train Epoch6 Acc 0.9515666666666667 (114188/120000), AUC 0.9924894571304321
Test Epoch6 layer0 Acc 0.916578947368421, AUC 0.9815099239349365, avg_entr 0.06902198493480682
Test Epoch6 layer1 Acc 0.915, AUC 0.9835610389709473, avg_entr 0.02563490904867649
Test Epoch6 layer2 Acc 0.9163157894736842, AUC 0.9836593270301819, avg_entr 0.022987719625234604
Test Epoch6 layer3 Acc 0.9151315789473684, AUC 0.9807026982307434, avg_entr 0.0214996300637722
Test Epoch6 layer4 Acc 0.9144736842105263, AUC 0.9821491837501526, avg_entr 0.022342847660183907
gc 0
Train Epoch7 Acc 0.954475 (114537/120000), AUC 0.9930219650268555
Test Epoch7 layer0 Acc 0.9178947368421052, AUC 0.9814927577972412, avg_entr 0.06434595584869385
Test Epoch7 layer1 Acc 0.9134210526315789, AUC 0.9835132956504822, avg_entr 0.025320492684841156
Test Epoch7 layer2 Acc 0.915, AUC 0.9834191799163818, avg_entr 0.022562464699149132
Test Epoch7 layer3 Acc 0.9140789473684211, AUC 0.9810876846313477, avg_entr 0.021206727251410484
Test Epoch7 layer4 Acc 0.9136842105263158, AUC 0.9822190999984741, avg_entr 0.02164321579039097
gc 0
Train Epoch8 Acc 0.95675 (114810/120000), AUC 0.9937078952789307
Test Epoch8 layer0 Acc 0.9185526315789474, AUC 0.9813776612281799, avg_entr 0.060485728085041046
Test Epoch8 layer1 Acc 0.9139473684210526, AUC 0.9831441044807434, avg_entr 0.021571699529886246
Test Epoch8 layer2 Acc 0.9142105263157895, AUC 0.982903003692627, avg_entr 0.01920824684202671
Test Epoch8 layer3 Acc 0.9135526315789474, AUC 0.9791525602340698, avg_entr 0.01773522049188614
Test Epoch8 layer4 Acc 0.9135526315789474, AUC 0.9807593822479248, avg_entr 0.018032457679510117
gc 0
Train Epoch9 Acc 0.9605833333333333 (115270/120000), AUC 0.9944800138473511
Test Epoch9 layer0 Acc 0.9180263157894737, AUC 0.9813019037246704, avg_entr 0.05836587771773338
Test Epoch9 layer1 Acc 0.9092105263157895, AUC 0.9827038049697876, avg_entr 0.019930997863411903
Test Epoch9 layer2 Acc 0.9107894736842105, AUC 0.9827197194099426, avg_entr 0.017992638051509857
Test Epoch9 layer3 Acc 0.9102631578947369, AUC 0.9800424575805664, avg_entr 0.016757162287831306
Test Epoch9 layer4 Acc 0.9097368421052632, AUC 0.9805396795272827, avg_entr 0.017242534086108208
gc 0
Train Epoch10 Acc 0.9622 (115464/120000), AUC 0.9948245286941528
Test Epoch10 layer0 Acc 0.9163157894736842, AUC 0.9812452793121338, avg_entr 0.0563865527510643
Test Epoch10 layer1 Acc 0.910921052631579, AUC 0.9820739030838013, avg_entr 0.0213463194668293
Test Epoch10 layer2 Acc 0.9107894736842105, AUC 0.9818423986434937, avg_entr 0.018969669938087463
Test Epoch10 layer3 Acc 0.910921052631579, AUC 0.9787271022796631, avg_entr 0.017853019759058952
Test Epoch10 layer4 Acc 0.9103947368421053, AUC 0.9806865453720093, avg_entr 0.017989128828048706
gc 0
Train Epoch11 Acc 0.9634916666666666 (115619/120000), AUC 0.9949371218681335
Test Epoch11 layer0 Acc 0.916578947368421, AUC 0.9811030030250549, avg_entr 0.05304889753460884
Test Epoch11 layer1 Acc 0.9096052631578947, AUC 0.9813793301582336, avg_entr 0.01937762461602688
Test Epoch11 layer2 Acc 0.9090789473684211, AUC 0.9811291098594666, avg_entr 0.016618192195892334
Test Epoch11 layer3 Acc 0.9101315789473684, AUC 0.9776536226272583, avg_entr 0.015356305055320263
Test Epoch11 layer4 Acc 0.9106578947368421, AUC 0.9798624515533447, avg_entr 0.015293597243726254
gc 0
Train Epoch12 Acc 0.96455 (115746/120000), AUC 0.9951603412628174
Test Epoch12 layer0 Acc 0.9172368421052631, AUC 0.9810236692428589, avg_entr 0.05093010887503624
Test Epoch12 layer1 Acc 0.9092105263157895, AUC 0.9813346862792969, avg_entr 0.01813044585287571
Test Epoch12 layer2 Acc 0.9094736842105263, AUC 0.981387197971344, avg_entr 0.015660451725125313
Test Epoch12 layer3 Acc 0.9093421052631578, AUC 0.9776082038879395, avg_entr 0.014395065605640411
Test Epoch12 layer4 Acc 0.9097368421052632, AUC 0.9792534112930298, avg_entr 0.013997518457472324
gc 0
Train Epoch13 Acc 0.9665916666666666 (115991/120000), AUC 0.9953948259353638
Test Epoch13 layer0 Acc 0.9167105263157894, AUC 0.9810007810592651, avg_entr 0.049823299050331116
Test Epoch13 layer1 Acc 0.9093421052631578, AUC 0.9798668026924133, avg_entr 0.01784692145884037
Test Epoch13 layer2 Acc 0.9102631578947369, AUC 0.9799277186393738, avg_entr 0.014656493440270424
Test Epoch13 layer3 Acc 0.9110526315789473, AUC 0.9758989810943604, avg_entr 0.013100999407470226
Test Epoch13 layer4 Acc 0.9113157894736842, AUC 0.9785970449447632, avg_entr 0.013157672248780727
gc 0
Train Epoch14 Acc 0.9676333333333333 (116116/120000), AUC 0.9955940246582031
Test Epoch14 layer0 Acc 0.9169736842105263, AUC 0.9809508919715881, avg_entr 0.04862979054450989
Test Epoch14 layer1 Acc 0.9097368421052632, AUC 0.980398952960968, avg_entr 0.016823017969727516
Test Epoch14 layer2 Acc 0.9098684210526315, AUC 0.9805457592010498, avg_entr 0.013894055038690567
Test Epoch14 layer3 Acc 0.9101315789473684, AUC 0.9765121340751648, avg_entr 0.013066700659692287
Test Epoch14 layer4 Acc 0.9103947368421053, AUC 0.97804856300354, avg_entr 0.01263565942645073
gc 0
Train Epoch15 Acc 0.9683916666666667 (116207/120000), AUC 0.9956051707267761
Test Epoch15 layer0 Acc 0.9163157894736842, AUC 0.9809004068374634, avg_entr 0.047180481255054474
Test Epoch15 layer1 Acc 0.9096052631578947, AUC 0.9799967408180237, avg_entr 0.016238469630479813
Test Epoch15 layer2 Acc 0.9094736842105263, AUC 0.9802914261817932, avg_entr 0.013981649652123451
Test Epoch15 layer3 Acc 0.9101315789473684, AUC 0.9765006899833679, avg_entr 0.01248198188841343
Test Epoch15 layer4 Acc 0.91, AUC 0.9779858589172363, avg_entr 0.01169741339981556
gc 0
Train Epoch16 Acc 0.968975 (116277/120000), AUC 0.9956576824188232
Test Epoch16 layer0 Acc 0.9151315789473684, AUC 0.9808801412582397, avg_entr 0.04529851675033569
Test Epoch16 layer1 Acc 0.9078947368421053, AUC 0.97990882396698, avg_entr 0.014532874338328838
Test Epoch16 layer2 Acc 0.9089473684210526, AUC 0.979780375957489, avg_entr 0.012212580069899559
Test Epoch16 layer3 Acc 0.9096052631578947, AUC 0.9749115109443665, avg_entr 0.010414522141218185
Test Epoch16 layer4 Acc 0.9094736842105263, AUC 0.9771676659584045, avg_entr 0.010333615355193615
gc 0
Train Epoch17 Acc 0.9701416666666667 (116417/120000), AUC 0.9958764314651489
Test Epoch17 layer0 Acc 0.916578947368421, AUC 0.980861246585846, avg_entr 0.04429841786623001
Test Epoch17 layer1 Acc 0.9077631578947368, AUC 0.9789267778396606, avg_entr 0.01556053664535284
Test Epoch17 layer2 Acc 0.9076315789473685, AUC 0.9791936278343201, avg_entr 0.012475385330617428
Test Epoch17 layer3 Acc 0.9077631578947368, AUC 0.9746263027191162, avg_entr 0.010434851981699467
Test Epoch17 layer4 Acc 0.9082894736842105, AUC 0.9773911237716675, avg_entr 0.010840176604688168
gc 0
Train Epoch18 Acc 0.970825 (116499/120000), AUC 0.995855450630188
Test Epoch18 layer0 Acc 0.915921052631579, AUC 0.980823278427124, avg_entr 0.04360693693161011
Test Epoch18 layer1 Acc 0.9086842105263158, AUC 0.9793311357498169, avg_entr 0.014545961283147335
Test Epoch18 layer2 Acc 0.9084210526315789, AUC 0.9792386293411255, avg_entr 0.01126587949693203
Test Epoch18 layer3 Acc 0.9088157894736842, AUC 0.9749447703361511, avg_entr 0.009530054405331612
Test Epoch18 layer4 Acc 0.9096052631578947, AUC 0.9771416783332825, avg_entr 0.00972273200750351
gc 0
Train Epoch19 Acc 0.9712666666666666 (116552/120000), AUC 0.9959182739257812
Test Epoch19 layer0 Acc 0.9153947368421053, AUC 0.9808288216590881, avg_entr 0.0422566682100296
Test Epoch19 layer1 Acc 0.9086842105263158, AUC 0.9791527986526489, avg_entr 0.013305997475981712
Test Epoch19 layer2 Acc 0.9080263157894737, AUC 0.9790171384811401, avg_entr 0.010971948504447937
Test Epoch19 layer3 Acc 0.9094736842105263, AUC 0.9744937419891357, avg_entr 0.009647940285503864
Test Epoch19 layer4 Acc 0.9097368421052632, AUC 0.9768995046615601, avg_entr 0.009243941865861416
gc 0
Train Epoch20 Acc 0.9715916666666666 (116591/120000), AUC 0.995902955532074
Test Epoch20 layer0 Acc 0.9151315789473684, AUC 0.980832576751709, avg_entr 0.04091744124889374
Test Epoch20 layer1 Acc 0.9077631578947368, AUC 0.9791643619537354, avg_entr 0.012594006955623627
Test Epoch20 layer2 Acc 0.9084210526315789, AUC 0.9790387153625488, avg_entr 0.010422925464808941
Test Epoch20 layer3 Acc 0.9088157894736842, AUC 0.9743608236312866, avg_entr 0.009151543490588665
Test Epoch20 layer4 Acc 0.9086842105263158, AUC 0.9766025543212891, avg_entr 0.009154605679214
gc 0
Train Epoch21 Acc 0.9719583333333334 (116635/120000), AUC 0.996005654335022
Test Epoch21 layer0 Acc 0.9155263157894736, AUC 0.9808275699615479, avg_entr 0.040419213473796844
Test Epoch21 layer1 Acc 0.9077631578947368, AUC 0.9785524606704712, avg_entr 0.012979218736290932
Test Epoch21 layer2 Acc 0.9080263157894737, AUC 0.9786296486854553, avg_entr 0.010461810976266861
Test Epoch21 layer3 Acc 0.9090789473684211, AUC 0.9742777347564697, avg_entr 0.009512829594314098
Test Epoch21 layer4 Acc 0.9093421052631578, AUC 0.9763101935386658, avg_entr 0.009472951292991638
gc 0
Train Epoch22 Acc 0.9724083333333333 (116689/120000), AUC 0.9959794282913208
Test Epoch22 layer0 Acc 0.9153947368421053, AUC 0.9808175563812256, avg_entr 0.03979024291038513
Test Epoch22 layer1 Acc 0.9077631578947368, AUC 0.9787484407424927, avg_entr 0.012770207598805428
Test Epoch22 layer2 Acc 0.9088157894736842, AUC 0.9786392450332642, avg_entr 0.009758936241269112
Test Epoch22 layer3 Acc 0.9088157894736842, AUC 0.9744079113006592, avg_entr 0.008273584768176079
Test Epoch22 layer4 Acc 0.9092105263157895, AUC 0.9766782522201538, avg_entr 0.008692160248756409
gc 0
Train Epoch23 Acc 0.972575 (116709/120000), AUC 0.9959965944290161
Test Epoch23 layer0 Acc 0.9156578947368421, AUC 0.9808241724967957, avg_entr 0.03949049860239029
Test Epoch23 layer1 Acc 0.9078947368421053, AUC 0.9788365364074707, avg_entr 0.012203586287796497
Test Epoch23 layer2 Acc 0.908157894736842, AUC 0.9785265922546387, avg_entr 0.009405167773365974
Test Epoch23 layer3 Acc 0.908157894736842, AUC 0.9740601181983948, avg_entr 0.008041447959840298
Test Epoch23 layer4 Acc 0.9090789473684211, AUC 0.9764379262924194, avg_entr 0.008346203714609146
gc 0
Train Epoch24 Acc 0.972625 (116715/120000), AUC 0.9959853291511536
Test Epoch24 layer0 Acc 0.9156578947368421, AUC 0.9808058738708496, avg_entr 0.03867026045918465
Test Epoch24 layer1 Acc 0.9075, AUC 0.9786799550056458, avg_entr 0.011733496561646461
Test Epoch24 layer2 Acc 0.9075, AUC 0.9785186052322388, avg_entr 0.00939471460878849
Test Epoch24 layer3 Acc 0.9082894736842105, AUC 0.9739802479743958, avg_entr 0.008578304201364517
Test Epoch24 layer4 Acc 0.9085526315789474, AUC 0.9763329029083252, avg_entr 0.008444050326943398
gc 0
Train Epoch25 Acc 0.97285 (116742/120000), AUC 0.9960794448852539
Test Epoch25 layer0 Acc 0.9153947368421053, AUC 0.9807985424995422, avg_entr 0.038658905774354935
Test Epoch25 layer1 Acc 0.9075, AUC 0.9785805940628052, avg_entr 0.011779766529798508
Test Epoch25 layer2 Acc 0.9069736842105263, AUC 0.9784361720085144, avg_entr 0.009310968220233917
Test Epoch25 layer3 Acc 0.9076315789473685, AUC 0.9739659428596497, avg_entr 0.008474200032651424
Test Epoch25 layer4 Acc 0.9084210526315789, AUC 0.9763522744178772, avg_entr 0.008366699330508709
gc 0
Train Epoch26 Acc 0.9729833333333333 (116758/120000), AUC 0.9960886836051941
Test Epoch26 layer0 Acc 0.9157894736842105, AUC 0.9808089733123779, avg_entr 0.038568537682294846
Test Epoch26 layer1 Acc 0.9069736842105263, AUC 0.9785118699073792, avg_entr 0.011916087009012699
Test Epoch26 layer2 Acc 0.9073684210526316, AUC 0.9783669710159302, avg_entr 0.009410914033651352
Test Epoch26 layer3 Acc 0.9080263157894737, AUC 0.9737620949745178, avg_entr 0.00816263072192669
Test Epoch26 layer4 Acc 0.9078947368421053, AUC 0.9761377573013306, avg_entr 0.008065651170909405
gc 0
Train Epoch27 Acc 0.97315 (116778/120000), AUC 0.9960839748382568
Test Epoch27 layer0 Acc 0.9155263157894736, AUC 0.9808061122894287, avg_entr 0.03823849558830261
Test Epoch27 layer1 Acc 0.9076315789473685, AUC 0.9785090684890747, avg_entr 0.01150693278759718
Test Epoch27 layer2 Acc 0.9072368421052631, AUC 0.9783779382705688, avg_entr 0.00907759740948677
Test Epoch27 layer3 Acc 0.9077631578947368, AUC 0.9738764762878418, avg_entr 0.008120184764266014
Test Epoch27 layer4 Acc 0.908157894736842, AUC 0.9762985706329346, avg_entr 0.008141707628965378
gc 0
Train Epoch28 Acc 0.9732 (116784/120000), AUC 0.9961209297180176
Test Epoch28 layer0 Acc 0.9155263157894736, AUC 0.9807997941970825, avg_entr 0.03803158923983574
Test Epoch28 layer1 Acc 0.9068421052631579, AUC 0.9785719513893127, avg_entr 0.011755247600376606
Test Epoch28 layer2 Acc 0.9072368421052631, AUC 0.9783403277397156, avg_entr 0.009120123460888863
Test Epoch28 layer3 Acc 0.908157894736842, AUC 0.973821759223938, avg_entr 0.00790664553642273
Test Epoch28 layer4 Acc 0.9085526315789474, AUC 0.976314902305603, avg_entr 0.007915378548204899
gc 0
Train Epoch29 Acc 0.9732666666666666 (116792/120000), AUC 0.996146559715271
Test Epoch29 layer0 Acc 0.9153947368421053, AUC 0.9807968735694885, avg_entr 0.03787742555141449
Test Epoch29 layer1 Acc 0.9069736842105263, AUC 0.9783241152763367, avg_entr 0.011855188757181168
Test Epoch29 layer2 Acc 0.9076315789473685, AUC 0.9781959652900696, avg_entr 0.009298299439251423
Test Epoch29 layer3 Acc 0.9088157894736842, AUC 0.973718523979187, avg_entr 0.008057585917413235
Test Epoch29 layer4 Acc 0.9088157894736842, AUC 0.9762868881225586, avg_entr 0.007944643497467041
Best AUC 0.9843929409980774
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5_pad150//ag_news_lstmal_l5.pt
[[1692   64  103   41]
 [   7 1880    9    4]
 [  36   17 1717  130]
 [  47   19  166 1668]]
Figure(640x480)
tensor([0.0590, 0.0058, 0.1216,  ..., 0.0844, 0.0127, 0.3341])
[[1702   56   85   57]
 [  11 1873    9    7]
 [  41   14 1697  148]
 [  32   15  136 1717]]
Figure(640x480)
tensor([0.0113, 0.0080, 0.0114,  ..., 0.0076, 0.0063, 0.0588])
[[1705   55   84   56]
 [  11 1871   11    7]
 [  40   14 1695  151]
 [  31   14  136 1719]]
Figure(640x480)
tensor([0.0089, 0.0086, 0.0126,  ..., 0.0081, 0.0075, 0.0391])
[[1706   54   85   55]
 [  10 1868   15    7]
 [  39   15 1698  148]
 [  34   15  136 1715]]
Figure(640x480)
tensor([0.0091, 0.0078, 0.0102,  ..., 0.0087, 0.0070, 0.0208])
[[1706   53   86   55]
 [  11 1868   14    7]
 [  39   15 1697  149]
 [  32   14  137 1717]]
Figure(640x480)
tensor([0.0068, 0.0148, 0.0190,  ..., 0.0062, 0.0065, 0.0350])
