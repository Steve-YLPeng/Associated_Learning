total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
gc 0
Train Epoch0 Acc 0.7390416666666667 (88685/120000), AUC 0.9198689460754395
Test Epoch0 layer0 Acc 0.9051315789473684, AUC 0.9773440957069397, avg_entr 0.23666083812713623
Save ckpt to ckpt/ag_news_lstmal_l5_pad100//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9086842105263158, AUC 0.9801269769668579, avg_entr 0.11378572136163712
Save ckpt to ckpt/ag_news_lstmal_l5_pad100//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9094736842105263, AUC 0.9814513921737671, avg_entr 0.1067061573266983
Save ckpt to ckpt/ag_news_lstmal_l5_pad100//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9085526315789474, AUC 0.9814019203186035, avg_entr 0.1151539757847786
Test Epoch0 layer4 Acc 0.9080263157894737, AUC 0.9799747467041016, avg_entr 0.12638558447360992
gc 0
Train Epoch1 Acc 0.9225666666666666 (110708/120000), AUC 0.9826451539993286
Test Epoch1 layer0 Acc 0.9167105263157894, AUC 0.9804732799530029, avg_entr 0.13908296823501587
Test Epoch1 layer1 Acc 0.915921052631579, AUC 0.9834039211273193, avg_entr 0.05697491765022278
Save ckpt to ckpt/ag_news_lstmal_l5_pad100//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9152631578947369, AUC 0.9843778610229492, avg_entr 0.05190473794937134
Save ckpt to ckpt/ag_news_lstmal_l5_pad100//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9144736842105263, AUC 0.9837630987167358, avg_entr 0.0571298785507679
Test Epoch1 layer4 Acc 0.9132894736842105, AUC 0.9832515716552734, avg_entr 0.061200596392154694
gc 0
Train Epoch2 Acc 0.9345666666666667 (112148/120000), AUC 0.9873989820480347
Test Epoch2 layer0 Acc 0.9160526315789473, AUC 0.9815971255302429, avg_entr 0.11357778310775757
Test Epoch2 layer1 Acc 0.9161842105263158, AUC 0.9839942455291748, avg_entr 0.04075640067458153
Test Epoch2 layer2 Acc 0.9156578947368421, AUC 0.9845811724662781, avg_entr 0.0355059988796711
Save ckpt to ckpt/ag_news_lstmal_l5_pad100//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.915, AUC 0.9836224913597107, avg_entr 0.03644678369164467
Test Epoch2 layer4 Acc 0.9152631578947369, AUC 0.9823502898216248, avg_entr 0.041772082448005676
gc 0
Train Epoch3 Acc 0.9413416666666666 (112961/120000), AUC 0.9898226261138916
Test Epoch3 layer0 Acc 0.9171052631578948, AUC 0.9816821813583374, avg_entr 0.09463085234165192
Test Epoch3 layer1 Acc 0.9153947368421053, AUC 0.9840186238288879, avg_entr 0.03576089069247246
Test Epoch3 layer2 Acc 0.9168421052631579, AUC 0.9847418069839478, avg_entr 0.03191260248422623
Save ckpt to ckpt/ag_news_lstmal_l5_pad100//ag_news_lstmal_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.9152631578947369, AUC 0.9843173623085022, avg_entr 0.03278495371341705
Test Epoch3 layer4 Acc 0.9147368421052632, AUC 0.9833309650421143, avg_entr 0.0362137071788311
gc 0
Train Epoch4 Acc 0.9464083333333333 (113569/120000), AUC 0.991121232509613
Test Epoch4 layer0 Acc 0.9173684210526316, AUC 0.9815757870674133, avg_entr 0.08268843591213226
Test Epoch4 layer1 Acc 0.9168421052631579, AUC 0.9834627509117126, avg_entr 0.0324169285595417
Test Epoch4 layer2 Acc 0.9172368421052631, AUC 0.9841464757919312, avg_entr 0.027302753180265427
Test Epoch4 layer3 Acc 0.9169736842105263, AUC 0.9831770062446594, avg_entr 0.028131362050771713
Test Epoch4 layer4 Acc 0.915921052631579, AUC 0.982719361782074, avg_entr 0.029575631022453308
gc 0
Train Epoch5 Acc 0.95015 (114018/120000), AUC 0.9922284483909607
Test Epoch5 layer0 Acc 0.9160526315789473, AUC 0.9815380573272705, avg_entr 0.0743025466799736
Test Epoch5 layer1 Acc 0.9164473684210527, AUC 0.9832495450973511, avg_entr 0.02693409100174904
Test Epoch5 layer2 Acc 0.916578947368421, AUC 0.9836394190788269, avg_entr 0.023264575749635696
Test Epoch5 layer3 Acc 0.9160526315789473, AUC 0.9832669496536255, avg_entr 0.023285584524273872
Test Epoch5 layer4 Acc 0.9156578947368421, AUC 0.9824047088623047, avg_entr 0.024277104064822197
gc 0
Train Epoch6 Acc 0.9528416666666667 (114341/120000), AUC 0.992892324924469
Test Epoch6 layer0 Acc 0.9152631578947369, AUC 0.9815276861190796, avg_entr 0.06733710318803787
Test Epoch6 layer1 Acc 0.9157894736842105, AUC 0.9826829433441162, avg_entr 0.02383999712765217
Test Epoch6 layer2 Acc 0.9152631578947369, AUC 0.9835033416748047, avg_entr 0.020387334749102592
Test Epoch6 layer3 Acc 0.9157894736842105, AUC 0.9832316637039185, avg_entr 0.02094174176454544
Test Epoch6 layer4 Acc 0.915921052631579, AUC 0.9820146560668945, avg_entr 0.021884163841605186
gc 0
Train Epoch7 Acc 0.9571583333333333 (114859/120000), AUC 0.993990421295166
Test Epoch7 layer0 Acc 0.9173684210526316, AUC 0.9812928438186646, avg_entr 0.06536389142274857
Test Epoch7 layer1 Acc 0.9136842105263158, AUC 0.9816833138465881, avg_entr 0.02360191009938717
Test Epoch7 layer2 Acc 0.9140789473684211, AUC 0.9826174974441528, avg_entr 0.019518347457051277
Test Epoch7 layer3 Acc 0.9140789473684211, AUC 0.9817039370536804, avg_entr 0.019908271729946136
Test Epoch7 layer4 Acc 0.9134210526315789, AUC 0.9816213250160217, avg_entr 0.020828885957598686
gc 0
Train Epoch8 Acc 0.9586166666666667 (115034/120000), AUC 0.9942502379417419
Test Epoch8 layer0 Acc 0.9160526315789473, AUC 0.9811205863952637, avg_entr 0.06322160363197327
Test Epoch8 layer1 Acc 0.9113157894736842, AUC 0.9816194772720337, avg_entr 0.023717811331152916
Test Epoch8 layer2 Acc 0.9130263157894737, AUC 0.9826012849807739, avg_entr 0.019996264949440956
Test Epoch8 layer3 Acc 0.9131578947368421, AUC 0.981864869594574, avg_entr 0.020696450024843216
Test Epoch8 layer4 Acc 0.9136842105263158, AUC 0.981286883354187, avg_entr 0.02082369662821293
gc 0
Train Epoch9 Acc 0.9599583333333334 (115195/120000), AUC 0.9944908022880554
Test Epoch9 layer0 Acc 0.9152631578947369, AUC 0.9810439348220825, avg_entr 0.06028365716338158
Test Epoch9 layer1 Acc 0.9131578947368421, AUC 0.9814518690109253, avg_entr 0.020975081250071526
Test Epoch9 layer2 Acc 0.9148684210526316, AUC 0.9822625517845154, avg_entr 0.018037451431155205
Test Epoch9 layer3 Acc 0.915, AUC 0.980695366859436, avg_entr 0.01800377666950226
Test Epoch9 layer4 Acc 0.9146052631578947, AUC 0.9806356430053711, avg_entr 0.018703067675232887
gc 0
Train Epoch10 Acc 0.9612 (115344/120000), AUC 0.9947415590286255
Test Epoch10 layer0 Acc 0.9172368421052631, AUC 0.9809868931770325, avg_entr 0.05773136019706726
Test Epoch10 layer1 Acc 0.9106578947368421, AUC 0.980722963809967, avg_entr 0.019884472712874413
Test Epoch10 layer2 Acc 0.9111842105263158, AUC 0.9813288450241089, avg_entr 0.01644941419363022
Test Epoch10 layer3 Acc 0.9121052631578948, AUC 0.979943037033081, avg_entr 0.0159969013184309
Test Epoch10 layer4 Acc 0.9118421052631579, AUC 0.9802230596542358, avg_entr 0.016155162826180458
gc 0
Train Epoch11 Acc 0.96305 (115566/120000), AUC 0.9952253103256226
Test Epoch11 layer0 Acc 0.9132894736842105, AUC 0.9808887243270874, avg_entr 0.05689741671085358
Test Epoch11 layer1 Acc 0.9106578947368421, AUC 0.980660080909729, avg_entr 0.02007468044757843
Test Epoch11 layer2 Acc 0.910921052631579, AUC 0.9815136790275574, avg_entr 0.016415951773524284
Test Epoch11 layer3 Acc 0.9117105263157895, AUC 0.9804299473762512, avg_entr 0.016092674806714058
Test Epoch11 layer4 Acc 0.9114473684210527, AUC 0.9797186851501465, avg_entr 0.015911929309368134
gc 0
Train Epoch12 Acc 0.963975 (115677/120000), AUC 0.9953208565711975
Test Epoch12 layer0 Acc 0.9164473684210527, AUC 0.9808009266853333, avg_entr 0.05372636765241623
Test Epoch12 layer1 Acc 0.9101315789473684, AUC 0.9800699353218079, avg_entr 0.019214002415537834
Test Epoch12 layer2 Acc 0.9111842105263158, AUC 0.9809853434562683, avg_entr 0.015438266098499298
Test Epoch12 layer3 Acc 0.9123684210526316, AUC 0.9789278507232666, avg_entr 0.015058565884828568
Test Epoch12 layer4 Acc 0.9113157894736842, AUC 0.9794568419456482, avg_entr 0.015152939595282078
gc 0
Train Epoch13 Acc 0.9647166666666667 (115766/120000), AUC 0.9953423738479614
Test Epoch13 layer0 Acc 0.9152631578947369, AUC 0.980722188949585, avg_entr 0.05157589539885521
Test Epoch13 layer1 Acc 0.9090789473684211, AUC 0.979711651802063, avg_entr 0.018569216132164
Test Epoch13 layer2 Acc 0.9106578947368421, AUC 0.9803110361099243, avg_entr 0.015033988282084465
Test Epoch13 layer3 Acc 0.9117105263157895, AUC 0.9779695868492126, avg_entr 0.01492228638380766
Test Epoch13 layer4 Acc 0.9111842105263158, AUC 0.9790008068084717, avg_entr 0.014778180979192257
gc 0
Train Epoch14 Acc 0.9656416666666666 (115877/120000), AUC 0.995484471321106
Test Epoch14 layer0 Acc 0.9144736842105263, AUC 0.9806694984436035, avg_entr 0.049791812896728516
Test Epoch14 layer1 Acc 0.9088157894736842, AUC 0.9798803329467773, avg_entr 0.018846286460757256
Test Epoch14 layer2 Acc 0.9103947368421053, AUC 0.9802295565605164, avg_entr 0.01545962505042553
Test Epoch14 layer3 Acc 0.9101315789473684, AUC 0.9782960414886475, avg_entr 0.015095849521458149
Test Epoch14 layer4 Acc 0.9102631578947369, AUC 0.9792124032974243, avg_entr 0.014767789281904697
gc 0
Train Epoch15 Acc 0.966425 (115971/120000), AUC 0.9956885576248169
Test Epoch15 layer0 Acc 0.9151315789473684, AUC 0.9806832075119019, avg_entr 0.04857591167092323
Test Epoch15 layer1 Acc 0.9084210526315789, AUC 0.9797585010528564, avg_entr 0.017922602593898773
Test Epoch15 layer2 Acc 0.9090789473684211, AUC 0.980292797088623, avg_entr 0.014137472957372665
Test Epoch15 layer3 Acc 0.9096052631578947, AUC 0.9784968495368958, avg_entr 0.01385316252708435
Test Epoch15 layer4 Acc 0.9105263157894737, AUC 0.9788578748703003, avg_entr 0.013809587806463242
gc 0
Train Epoch16 Acc 0.96695 (116034/120000), AUC 0.9957789182662964
Test Epoch16 layer0 Acc 0.9155263157894736, AUC 0.9806797504425049, avg_entr 0.04770202562212944
Test Epoch16 layer1 Acc 0.9077631578947368, AUC 0.9794818162918091, avg_entr 0.016724178567528725
Test Epoch16 layer2 Acc 0.9101315789473684, AUC 0.9799752235412598, avg_entr 0.013663108460605145
Test Epoch16 layer3 Acc 0.91, AUC 0.9781643152236938, avg_entr 0.012881193310022354
Test Epoch16 layer4 Acc 0.9097368421052632, AUC 0.9781995415687561, avg_entr 0.012543441727757454
gc 0
Train Epoch17 Acc 0.967275 (116073/120000), AUC 0.9956961870193481
Test Epoch17 layer0 Acc 0.9147368421052632, AUC 0.9806466102600098, avg_entr 0.046291008591651917
Test Epoch17 layer1 Acc 0.9090789473684211, AUC 0.9793577194213867, avg_entr 0.016597818583250046
Test Epoch17 layer2 Acc 0.9096052631578947, AUC 0.9795668125152588, avg_entr 0.01369448285549879
Test Epoch17 layer3 Acc 0.9094736842105263, AUC 0.9774699211120605, avg_entr 0.013578157871961594
Test Epoch17 layer4 Acc 0.9097368421052632, AUC 0.9779495596885681, avg_entr 0.013552355580031872
gc 0
Train Epoch18 Acc 0.9677333333333333 (116128/120000), AUC 0.9957577586174011
Test Epoch18 layer0 Acc 0.9152631578947369, AUC 0.9806389212608337, avg_entr 0.04433984309434891
Test Epoch18 layer1 Acc 0.9092105263157895, AUC 0.9794331192970276, avg_entr 0.01613708771765232
Test Epoch18 layer2 Acc 0.9093421052631578, AUC 0.9798418879508972, avg_entr 0.013461113907396793
Test Epoch18 layer3 Acc 0.9098684210526315, AUC 0.978055477142334, avg_entr 0.01371125690639019
Test Epoch18 layer4 Acc 0.9102631578947369, AUC 0.9779001474380493, avg_entr 0.013831730000674725
gc 0
Train Epoch19 Acc 0.9681583333333333 (116179/120000), AUC 0.9958744049072266
Test Epoch19 layer0 Acc 0.9147368421052632, AUC 0.9806161522865295, avg_entr 0.0439513735473156
Test Epoch19 layer1 Acc 0.9078947368421053, AUC 0.9793715476989746, avg_entr 0.015820235013961792
Test Epoch19 layer2 Acc 0.9096052631578947, AUC 0.979512095451355, avg_entr 0.01306261494755745
Test Epoch19 layer3 Acc 0.9089473684210526, AUC 0.9770299196243286, avg_entr 0.012690108269453049
Test Epoch19 layer4 Acc 0.9092105263157895, AUC 0.9775075912475586, avg_entr 0.01288631372153759
gc 0
Train Epoch20 Acc 0.968375 (116205/120000), AUC 0.9959022998809814
Test Epoch20 layer0 Acc 0.9142105263157895, AUC 0.9806092977523804, avg_entr 0.0431382916867733
Test Epoch20 layer1 Acc 0.9076315789473685, AUC 0.9791894555091858, avg_entr 0.01573648676276207
Test Epoch20 layer2 Acc 0.908157894736842, AUC 0.9793773889541626, avg_entr 0.012561202049255371
Test Epoch20 layer3 Acc 0.9088157894736842, AUC 0.9774908423423767, avg_entr 0.011896292679011822
Test Epoch20 layer4 Acc 0.9089473684210526, AUC 0.9775015115737915, avg_entr 0.011774410493671894
gc 0
Train Epoch21 Acc 0.9685666666666667 (116228/120000), AUC 0.99583500623703
Test Epoch21 layer0 Acc 0.9151315789473684, AUC 0.9806557893753052, avg_entr 0.041963156312704086
Test Epoch21 layer1 Acc 0.9078947368421053, AUC 0.9790592193603516, avg_entr 0.015217023901641369
Test Epoch21 layer2 Acc 0.9088157894736842, AUC 0.9790975451469421, avg_entr 0.012311754748225212
Test Epoch21 layer3 Acc 0.9085526315789474, AUC 0.9772356748580933, avg_entr 0.011793626472353935
Test Epoch21 layer4 Acc 0.9085526315789474, AUC 0.9773002862930298, avg_entr 0.01136983372271061
gc 0
Train Epoch22 Acc 0.9687 (116244/120000), AUC 0.995829164981842
Test Epoch22 layer0 Acc 0.9147368421052632, AUC 0.980646014213562, avg_entr 0.04070938378572464
Test Epoch22 layer1 Acc 0.908157894736842, AUC 0.9789687395095825, avg_entr 0.015074236318469048
Test Epoch22 layer2 Acc 0.9092105263157895, AUC 0.9789227843284607, avg_entr 0.011824451386928558
Test Epoch22 layer3 Acc 0.9088157894736842, AUC 0.977213442325592, avg_entr 0.011472285725176334
Test Epoch22 layer4 Acc 0.9092105263157895, AUC 0.9771084189414978, avg_entr 0.011209234595298767
gc 0
Train Epoch23 Acc 0.9689916666666667 (116279/120000), AUC 0.995871901512146
Test Epoch23 layer0 Acc 0.9151315789473684, AUC 0.9806281328201294, avg_entr 0.04016624391078949
Test Epoch23 layer1 Acc 0.9072368421052631, AUC 0.9789249897003174, avg_entr 0.014851657673716545
Test Epoch23 layer2 Acc 0.9086842105263158, AUC 0.9789486527442932, avg_entr 0.011876559816300869
Test Epoch23 layer3 Acc 0.9080263157894737, AUC 0.9773538708686829, avg_entr 0.011245083063840866
Test Epoch23 layer4 Acc 0.9084210526315789, AUC 0.97715163230896, avg_entr 0.010790403932332993
gc 0
Train Epoch24 Acc 0.9691833333333333 (116302/120000), AUC 0.9958987236022949
Test Epoch24 layer0 Acc 0.915, AUC 0.9806278944015503, avg_entr 0.03991974517703056
Test Epoch24 layer1 Acc 0.906578947368421, AUC 0.978837788105011, avg_entr 0.014687757007777691
Test Epoch24 layer2 Acc 0.9082894736842105, AUC 0.9789230227470398, avg_entr 0.011679324321448803
Test Epoch24 layer3 Acc 0.9085526315789474, AUC 0.9771555066108704, avg_entr 0.01090177334845066
Test Epoch24 layer4 Acc 0.9082894736842105, AUC 0.9770697951316833, avg_entr 0.010506156831979752
gc 0
Train Epoch25 Acc 0.9692416666666667 (116309/120000), AUC 0.9958943724632263
Test Epoch25 layer0 Acc 0.915, AUC 0.9806258678436279, avg_entr 0.03936105966567993
Test Epoch25 layer1 Acc 0.9082894736842105, AUC 0.9788196086883545, avg_entr 0.014440733008086681
Test Epoch25 layer2 Acc 0.9086842105263158, AUC 0.9788815379142761, avg_entr 0.011706506833434105
Test Epoch25 layer3 Acc 0.9089473684210526, AUC 0.976901113986969, avg_entr 0.011216958053410053
Test Epoch25 layer4 Acc 0.9082894736842105, AUC 0.9769947528839111, avg_entr 0.0112763661891222
gc 0
Train Epoch26 Acc 0.969325 (116319/120000), AUC 0.995913565158844
Test Epoch26 layer0 Acc 0.9144736842105263, AUC 0.9806228876113892, avg_entr 0.038891714066267014
Test Epoch26 layer1 Acc 0.9080263157894737, AUC 0.9788274168968201, avg_entr 0.014405257999897003
Test Epoch26 layer2 Acc 0.9082894736842105, AUC 0.9788435101509094, avg_entr 0.011614575050771236
Test Epoch26 layer3 Acc 0.908157894736842, AUC 0.9770392775535583, avg_entr 0.010960876010358334
Test Epoch26 layer4 Acc 0.9080263157894737, AUC 0.9769121408462524, avg_entr 0.010732602328062057
gc 0
Train Epoch27 Acc 0.9693916666666667 (116327/120000), AUC 0.9959259033203125
Test Epoch27 layer0 Acc 0.915, AUC 0.9806134700775146, avg_entr 0.038891810923814774
Test Epoch27 layer1 Acc 0.9071052631578947, AUC 0.9787094593048096, avg_entr 0.014183211140334606
Test Epoch27 layer2 Acc 0.9088157894736842, AUC 0.9787728190422058, avg_entr 0.011595378629863262
Test Epoch27 layer3 Acc 0.9085526315789474, AUC 0.9769792556762695, avg_entr 0.010764122940599918
Test Epoch27 layer4 Acc 0.9084210526315789, AUC 0.976864755153656, avg_entr 0.010439497418701649
gc 0
Train Epoch28 Acc 0.969575 (116349/120000), AUC 0.9959057569503784
Test Epoch28 layer0 Acc 0.9148684210526316, AUC 0.9805991649627686, avg_entr 0.03879702091217041
Test Epoch28 layer1 Acc 0.9067105263157895, AUC 0.9786714911460876, avg_entr 0.014239582233130932
Test Epoch28 layer2 Acc 0.9082894736842105, AUC 0.9787063002586365, avg_entr 0.01141372974961996
Test Epoch28 layer3 Acc 0.9080263157894737, AUC 0.9769582748413086, avg_entr 0.01057850569486618
Test Epoch28 layer4 Acc 0.9086842105263158, AUC 0.976851224899292, avg_entr 0.010160259902477264
gc 0
Train Epoch29 Acc 0.9694333333333334 (116332/120000), AUC 0.9959225654602051
Test Epoch29 layer0 Acc 0.9151315789473684, AUC 0.980607271194458, avg_entr 0.0385906957089901
Test Epoch29 layer1 Acc 0.9073684210526316, AUC 0.978671133518219, avg_entr 0.014215300790965557
Test Epoch29 layer2 Acc 0.9086842105263158, AUC 0.9785881638526917, avg_entr 0.011285856366157532
Test Epoch29 layer3 Acc 0.908157894736842, AUC 0.9768208265304565, avg_entr 0.010545153170824051
Test Epoch29 layer4 Acc 0.9084210526315789, AUC 0.9767184257507324, avg_entr 0.010147585533559322
Best AUC 0.9847418069839478
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5_pad100//ag_news_lstmal_l5.pt
[[1715   56   85   44]
 [  16 1866    7   11]
 [  47   18 1692  143]
 [  53   17  133 1697]]
Figure(640x480)
tensor([0.1093, 0.0018, 0.0358,  ..., 0.0834, 0.0041, 0.0492])
[[1715   55   82   48]
 [  13 1864   15    8]
 [  51   13 1693  143]
 [  47   14  154 1685]]
Figure(640x480)
tensor([0.0064, 0.0040, 0.0061,  ..., 0.0032, 0.0029, 0.0097])
[[1719   56   79   46]
 [  16 1864   12    8]
 [  51   14 1697  138]
 [  43   16  153 1688]]
Figure(640x480)
tensor([0.0053, 0.0044, 0.0059,  ..., 0.0034, 0.0032, 0.0082])
[[1714   56   81   49]
 [  15 1863   13    9]
 [  50   13 1694  143]
 [  43   17  155 1685]]
Figure(640x480)
tensor([0.0067, 0.0049, 0.0068,  ..., 0.0044, 0.0046, 0.0126])
[[1716   55   82   47]
 [  19 1861   12    8]
 [  51   13 1705  131]
 [  47   16  167 1670]]
Figure(640x480)
tensor([0.0093, 0.0083, 0.0126,  ..., 0.0058, 0.0059, 0.0130])
