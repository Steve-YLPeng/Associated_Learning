total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
gc 0
Train Epoch0 Acc 0.7326666666666667 (87920/120000), AUC 0.9176504015922546
Test Epoch0 layer0 Acc 0.8960526315789473, AUC 0.9748022556304932, avg_entr 0.26458534598350525
Save ckpt to ckpt/ag_news_lstmal_l5_pad200//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9019736842105263, AUC 0.9788557887077332, avg_entr 0.11030881106853485
Save ckpt to ckpt/ag_news_lstmal_l5_pad200//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9014473684210527, AUC 0.9797289371490479, avg_entr 0.10401704162359238
Save ckpt to ckpt/ag_news_lstmal_l5_pad200//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9007894736842105, AUC 0.9778618216514587, avg_entr 0.10651829838752747
Test Epoch0 layer4 Acc 0.9014473684210527, AUC 0.9783945083618164, avg_entr 0.10676246881484985
gc 0
Train Epoch1 Acc 0.9193416666666666 (110321/120000), AUC 0.9818482995033264
Test Epoch1 layer0 Acc 0.9122368421052631, AUC 0.9789127111434937, avg_entr 0.1482025533914566
Test Epoch1 layer1 Acc 0.9146052631578947, AUC 0.9828011989593506, avg_entr 0.056358639150857925
Save ckpt to ckpt/ag_news_lstmal_l5_pad200//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9132894736842105, AUC 0.9832103848457336, avg_entr 0.05207942798733711
Save ckpt to ckpt/ag_news_lstmal_l5_pad200//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9131578947368421, AUC 0.9816274642944336, avg_entr 0.05114336684346199
Test Epoch1 layer4 Acc 0.9125, AUC 0.9819982647895813, avg_entr 0.05247647315263748
gc 0
Train Epoch2 Acc 0.931425 (111771/120000), AUC 0.9866088628768921
Test Epoch2 layer0 Acc 0.9181578947368421, AUC 0.9805158972740173, avg_entr 0.11565461754798889
Test Epoch2 layer1 Acc 0.9163157894736842, AUC 0.9835024476051331, avg_entr 0.039127275347709656
Save ckpt to ckpt/ag_news_lstmal_l5_pad200//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.9164473684210527, AUC 0.9839575886726379, avg_entr 0.03615185618400574
Save ckpt to ckpt/ag_news_lstmal_l5_pad200//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.9155263157894736, AUC 0.9822072386741638, avg_entr 0.03727961331605911
Test Epoch2 layer4 Acc 0.9156578947368421, AUC 0.9831215739250183, avg_entr 0.039663322269916534
gc 0
Train Epoch3 Acc 0.938425 (112611/120000), AUC 0.9888342618942261
Test Epoch3 layer0 Acc 0.9155263157894736, AUC 0.9812930822372437, avg_entr 0.09692274034023285
Test Epoch3 layer1 Acc 0.9171052631578948, AUC 0.9836525917053223, avg_entr 0.03311633691191673
Test Epoch3 layer2 Acc 0.9161842105263158, AUC 0.9838974475860596, avg_entr 0.02875838428735733
Test Epoch3 layer3 Acc 0.9156578947368421, AUC 0.9827097654342651, avg_entr 0.02842826023697853
Test Epoch3 layer4 Acc 0.9169736842105263, AUC 0.9828827381134033, avg_entr 0.029416846111416817
gc 0
Train Epoch4 Acc 0.9435583333333334 (113227/120000), AUC 0.9905548095703125
Test Epoch4 layer0 Acc 0.9188157894736843, AUC 0.9815749526023865, avg_entr 0.08090195059776306
Test Epoch4 layer1 Acc 0.9161842105263158, AUC 0.9833550453186035, avg_entr 0.028749655932188034
Test Epoch4 layer2 Acc 0.9156578947368421, AUC 0.9839178323745728, avg_entr 0.026303673163056374
Test Epoch4 layer3 Acc 0.9157894736842105, AUC 0.9828632473945618, avg_entr 0.025785477831959724
Test Epoch4 layer4 Acc 0.915921052631579, AUC 0.9830421805381775, avg_entr 0.02763223461806774
gc 0
Train Epoch5 Acc 0.9471083333333333 (113653/120000), AUC 0.9918293952941895
Test Epoch5 layer0 Acc 0.916578947368421, AUC 0.9817159175872803, avg_entr 0.07427384704351425
Test Epoch5 layer1 Acc 0.9153947368421053, AUC 0.9827759265899658, avg_entr 0.025565853342413902
Test Epoch5 layer2 Acc 0.9160526315789473, AUC 0.9826889038085938, avg_entr 0.021492974832654
Test Epoch5 layer3 Acc 0.9153947368421053, AUC 0.9805023670196533, avg_entr 0.02085459791123867
Test Epoch5 layer4 Acc 0.9155263157894736, AUC 0.9816815853118896, avg_entr 0.02165849320590496
gc 0
Train Epoch6 Acc 0.9508916666666667 (114107/120000), AUC 0.9925032258033752
Test Epoch6 layer0 Acc 0.9171052631578948, AUC 0.9817515015602112, avg_entr 0.06715364754199982
Test Epoch6 layer1 Acc 0.9151315789473684, AUC 0.9832041263580322, avg_entr 0.025056498125195503
Test Epoch6 layer2 Acc 0.9163157894736842, AUC 0.982978880405426, avg_entr 0.021789690479636192
Test Epoch6 layer3 Acc 0.9160526315789473, AUC 0.9815261363983154, avg_entr 0.02139217220246792
Test Epoch6 layer4 Acc 0.9155263157894736, AUC 0.9826267957687378, avg_entr 0.02250748500227928
gc 0
Train Epoch7 Acc 0.9537833333333333 (114454/120000), AUC 0.9933333396911621
Test Epoch7 layer0 Acc 0.9178947368421052, AUC 0.9816741943359375, avg_entr 0.06395529955625534
Test Epoch7 layer1 Acc 0.9147368421052632, AUC 0.982636570930481, avg_entr 0.0221227016299963
Test Epoch7 layer2 Acc 0.9148684210526316, AUC 0.9823556542396545, avg_entr 0.019039059057831764
Test Epoch7 layer3 Acc 0.9164473684210527, AUC 0.9805190563201904, avg_entr 0.018714159727096558
Test Epoch7 layer4 Acc 0.9164473684210527, AUC 0.9819231033325195, avg_entr 0.01964079588651657
gc 0
Train Epoch8 Acc 0.9560416666666667 (114725/120000), AUC 0.9938579201698303
Test Epoch8 layer0 Acc 0.9168421052631579, AUC 0.9814400672912598, avg_entr 0.05850806459784508
Test Epoch8 layer1 Acc 0.9134210526315789, AUC 0.9820786118507385, avg_entr 0.020869871601462364
Test Epoch8 layer2 Acc 0.9152631578947369, AUC 0.9822663068771362, avg_entr 0.01807292550802231
Test Epoch8 layer3 Acc 0.9155263157894736, AUC 0.9805914759635925, avg_entr 0.017650507390499115
Test Epoch8 layer4 Acc 0.9160526315789473, AUC 0.9813219308853149, avg_entr 0.01903611235320568
gc 0
Train Epoch9 Acc 0.9579083333333334 (114949/120000), AUC 0.9941993355751038
Test Epoch9 layer0 Acc 0.9184210526315789, AUC 0.9815933704376221, avg_entr 0.057507164776325226
Test Epoch9 layer1 Acc 0.9132894736842105, AUC 0.9819157123565674, avg_entr 0.02002704329788685
Test Epoch9 layer2 Acc 0.9152631578947369, AUC 0.981823205947876, avg_entr 0.01726514846086502
Test Epoch9 layer3 Acc 0.9134210526315789, AUC 0.9797770977020264, avg_entr 0.017147311940789223
Test Epoch9 layer4 Acc 0.9134210526315789, AUC 0.9811010956764221, avg_entr 0.017797933891415596
gc 0
Train Epoch10 Acc 0.9607083333333334 (115285/120000), AUC 0.9947858452796936
Test Epoch10 layer0 Acc 0.9180263157894737, AUC 0.981416642665863, avg_entr 0.05452430993318558
Test Epoch10 layer1 Acc 0.9127631578947368, AUC 0.9807299971580505, avg_entr 0.018948720768094063
Test Epoch10 layer2 Acc 0.9126315789473685, AUC 0.9806621670722961, avg_entr 0.016412904486060143
Test Epoch10 layer3 Acc 0.9130263157894737, AUC 0.9788702130317688, avg_entr 0.015920022502541542
Test Epoch10 layer4 Acc 0.9134210526315789, AUC 0.9793583750724792, avg_entr 0.01625525765120983
gc 0
Train Epoch11 Acc 0.9619916666666667 (115439/120000), AUC 0.9949136972427368
Test Epoch11 layer0 Acc 0.9176315789473685, AUC 0.9813513159751892, avg_entr 0.05439269170165062
Test Epoch11 layer1 Acc 0.9122368421052631, AUC 0.9811603426933289, avg_entr 0.017076177522540092
Test Epoch11 layer2 Acc 0.9128947368421053, AUC 0.9813783764839172, avg_entr 0.014305127784609795
Test Epoch11 layer3 Acc 0.9139473684210526, AUC 0.9786578416824341, avg_entr 0.01338491216301918
Test Epoch11 layer4 Acc 0.9142105263157895, AUC 0.979790449142456, avg_entr 0.013870902359485626
gc 0
Train Epoch12 Acc 0.9630916666666667 (115571/120000), AUC 0.9949925541877747
Test Epoch12 layer0 Acc 0.9147368421052632, AUC 0.9812557697296143, avg_entr 0.05128968134522438
Test Epoch12 layer1 Acc 0.9113157894736842, AUC 0.9807696342468262, avg_entr 0.01763533614575863
Test Epoch12 layer2 Acc 0.9126315789473685, AUC 0.9806616902351379, avg_entr 0.014943977817893028
Test Epoch12 layer3 Acc 0.9134210526315789, AUC 0.9793130159378052, avg_entr 0.014300227165222168
Test Epoch12 layer4 Acc 0.9132894736842105, AUC 0.9797888398170471, avg_entr 0.014843052253127098
gc 0
Train Epoch13 Acc 0.9640916666666667 (115691/120000), AUC 0.9950963258743286
Test Epoch13 layer0 Acc 0.916578947368421, AUC 0.9811975955963135, avg_entr 0.047449469566345215
Test Epoch13 layer1 Acc 0.9106578947368421, AUC 0.9804680347442627, avg_entr 0.01733238250017166
Test Epoch13 layer2 Acc 0.9122368421052631, AUC 0.9805193543434143, avg_entr 0.014489307068288326
Test Epoch13 layer3 Acc 0.9122368421052631, AUC 0.9781983494758606, avg_entr 0.01376763079315424
Test Epoch13 layer4 Acc 0.9119736842105263, AUC 0.9787461757659912, avg_entr 0.014438665471971035
gc 0
Train Epoch14 Acc 0.9654083333333333 (115849/120000), AUC 0.9953489303588867
Test Epoch14 layer0 Acc 0.9173684210526316, AUC 0.9811364412307739, avg_entr 0.04670899361371994
Test Epoch14 layer1 Acc 0.9105263157894737, AUC 0.9806151986122131, avg_entr 0.016080016270279884
Test Epoch14 layer2 Acc 0.9118421052631579, AUC 0.9809201955795288, avg_entr 0.012929421849548817
Test Epoch14 layer3 Acc 0.910921052631579, AUC 0.9779617786407471, avg_entr 0.012098842300474644
Test Epoch14 layer4 Acc 0.9121052631578948, AUC 0.9792141318321228, avg_entr 0.01286441832780838
gc 0
Train Epoch15 Acc 0.966225 (115947/120000), AUC 0.9954763650894165
Test Epoch15 layer0 Acc 0.9171052631578948, AUC 0.9810669422149658, avg_entr 0.045085661113262177
Test Epoch15 layer1 Acc 0.91, AUC 0.9797271490097046, avg_entr 0.015442145057022572
Test Epoch15 layer2 Acc 0.9119736842105263, AUC 0.9799934029579163, avg_entr 0.013324105180799961
Test Epoch15 layer3 Acc 0.9107894736842105, AUC 0.9773827195167542, avg_entr 0.0124363349750638
Test Epoch15 layer4 Acc 0.9113157894736842, AUC 0.9781174063682556, avg_entr 0.013055335730314255
gc 0
Train Epoch16 Acc 0.9665 (115980/120000), AUC 0.9954120516777039
Test Epoch16 layer0 Acc 0.915921052631579, AUC 0.9810535907745361, avg_entr 0.04380561038851738
Test Epoch16 layer1 Acc 0.9097368421052632, AUC 0.9802118539810181, avg_entr 0.015429719351232052
Test Epoch16 layer2 Acc 0.9117105263157895, AUC 0.980292558670044, avg_entr 0.012504073791205883
Test Epoch16 layer3 Acc 0.9117105263157895, AUC 0.977063775062561, avg_entr 0.011585312895476818
Test Epoch16 layer4 Acc 0.9110526315789473, AUC 0.9782918691635132, avg_entr 0.012127610854804516
gc 0
Train Epoch17 Acc 0.967075 (116049/120000), AUC 0.9954817295074463
Test Epoch17 layer0 Acc 0.9169736842105263, AUC 0.9810672402381897, avg_entr 0.04286442697048187
Test Epoch17 layer1 Acc 0.9084210526315789, AUC 0.9800640344619751, avg_entr 0.015077573247253895
Test Epoch17 layer2 Acc 0.9098684210526315, AUC 0.980146050453186, avg_entr 0.01202031783759594
Test Epoch17 layer3 Acc 0.9093421052631578, AUC 0.9766499996185303, avg_entr 0.011677548289299011
Test Epoch17 layer4 Acc 0.9090789473684211, AUC 0.9779905080795288, avg_entr 0.012417011894285679
gc 0
Train Epoch18 Acc 0.9677916666666667 (116135/120000), AUC 0.9955413341522217
Test Epoch18 layer0 Acc 0.9163157894736842, AUC 0.9810358881950378, avg_entr 0.04169916361570358
Test Epoch18 layer1 Acc 0.9096052631578947, AUC 0.980043351650238, avg_entr 0.014811775647103786
Test Epoch18 layer2 Acc 0.9105263157894737, AUC 0.9801514744758606, avg_entr 0.012234671972692013
Test Epoch18 layer3 Acc 0.9105263157894737, AUC 0.9766786694526672, avg_entr 0.01147397793829441
Test Epoch18 layer4 Acc 0.9107894736842105, AUC 0.9779065251350403, avg_entr 0.011854095384478569
gc 0
Train Epoch19 Acc 0.9681833333333333 (116182/120000), AUC 0.9955042600631714
Test Epoch19 layer0 Acc 0.9172368421052631, AUC 0.9810357689857483, avg_entr 0.0408267080783844
Test Epoch19 layer1 Acc 0.9097368421052632, AUC 0.980021059513092, avg_entr 0.014417233876883984
Test Epoch19 layer2 Acc 0.9114473684210527, AUC 0.9799216985702515, avg_entr 0.011888351291418076
Test Epoch19 layer3 Acc 0.910921052631579, AUC 0.9769078493118286, avg_entr 0.010907521471381187
Test Epoch19 layer4 Acc 0.9114473684210527, AUC 0.9779173135757446, avg_entr 0.0112001933157444
gc 0
Train Epoch20 Acc 0.9683416666666667 (116201/120000), AUC 0.9955480098724365
Test Epoch20 layer0 Acc 0.9153947368421053, AUC 0.9809990525245667, avg_entr 0.03998194634914398
Test Epoch20 layer1 Acc 0.9088157894736842, AUC 0.9798150062561035, avg_entr 0.014059930108487606
Test Epoch20 layer2 Acc 0.9111842105263158, AUC 0.9796983003616333, avg_entr 0.011747832410037518
Test Epoch20 layer3 Acc 0.9102631578947369, AUC 0.97611403465271, avg_entr 0.010857965797185898
Test Epoch20 layer4 Acc 0.9103947368421053, AUC 0.9772211909294128, avg_entr 0.011107268743216991
gc 0
Train Epoch21 Acc 0.9686166666666667 (116234/120000), AUC 0.9955614805221558
Test Epoch21 layer0 Acc 0.9167105263157894, AUC 0.9809959530830383, avg_entr 0.038787174969911575
Test Epoch21 layer1 Acc 0.9089473684210526, AUC 0.9798089265823364, avg_entr 0.013987704180181026
Test Epoch21 layer2 Acc 0.9113157894736842, AUC 0.9797061681747437, avg_entr 0.011467643082141876
Test Epoch21 layer3 Acc 0.9096052631578947, AUC 0.9761133193969727, avg_entr 0.010601467452943325
Test Epoch21 layer4 Acc 0.9103947368421053, AUC 0.9771062731742859, avg_entr 0.010760060511529446
gc 0
Train Epoch22 Acc 0.96915 (116298/120000), AUC 0.9955981969833374
Test Epoch22 layer0 Acc 0.916578947368421, AUC 0.9810139536857605, avg_entr 0.038790829479694366
Test Epoch22 layer1 Acc 0.9086842105263158, AUC 0.9795308709144592, avg_entr 0.014063435606658459
Test Epoch22 layer2 Acc 0.9107894736842105, AUC 0.9794648885726929, avg_entr 0.011789894662797451
Test Epoch22 layer3 Acc 0.9102631578947369, AUC 0.9760555624961853, avg_entr 0.010434137657284737
Test Epoch22 layer4 Acc 0.9107894736842105, AUC 0.9772055149078369, avg_entr 0.010749509558081627
gc 0
Train Epoch23 Acc 0.969375 (116325/120000), AUC 0.9956209659576416
Test Epoch23 layer0 Acc 0.916578947368421, AUC 0.9809927940368652, avg_entr 0.03826947510242462
Test Epoch23 layer1 Acc 0.9092105263157895, AUC 0.9795897603034973, avg_entr 0.013410227373242378
Test Epoch23 layer2 Acc 0.9107894736842105, AUC 0.9793455004692078, avg_entr 0.01120150089263916
Test Epoch23 layer3 Acc 0.9098684210526315, AUC 0.9756320714950562, avg_entr 0.010122510604560375
Test Epoch23 layer4 Acc 0.91, AUC 0.976913571357727, avg_entr 0.00997207872569561
gc 0
Train Epoch24 Acc 0.9694083333333333 (116329/120000), AUC 0.995617151260376
Test Epoch24 layer0 Acc 0.916578947368421, AUC 0.981005072593689, avg_entr 0.03783426806330681
Test Epoch24 layer1 Acc 0.9090789473684211, AUC 0.9795329570770264, avg_entr 0.01344252098351717
Test Epoch24 layer2 Acc 0.9110526315789473, AUC 0.9794729351997375, avg_entr 0.011363149620592594
Test Epoch24 layer3 Acc 0.9101315789473684, AUC 0.9760071635246277, avg_entr 0.00992667581886053
Test Epoch24 layer4 Acc 0.9098684210526315, AUC 0.9769538640975952, avg_entr 0.00992862693965435
gc 0
Train Epoch25 Acc 0.9695416666666666 (116345/120000), AUC 0.9956324100494385
Test Epoch25 layer0 Acc 0.916578947368421, AUC 0.9810121059417725, avg_entr 0.037557363510131836
Test Epoch25 layer1 Acc 0.9086842105263158, AUC 0.9795117378234863, avg_entr 0.013659095391631126
Test Epoch25 layer2 Acc 0.9102631578947369, AUC 0.9793986082077026, avg_entr 0.011383337900042534
Test Epoch25 layer3 Acc 0.9098684210526315, AUC 0.9758220314979553, avg_entr 0.009970306418836117
Test Epoch25 layer4 Acc 0.9101315789473684, AUC 0.9767035245895386, avg_entr 0.010212874040007591
gc 0
Train Epoch26 Acc 0.96965 (116358/120000), AUC 0.995669424533844
Test Epoch26 layer0 Acc 0.9164473684210527, AUC 0.9809964895248413, avg_entr 0.037528518587350845
Test Epoch26 layer1 Acc 0.9086842105263158, AUC 0.9794981479644775, avg_entr 0.01327139139175415
Test Epoch26 layer2 Acc 0.9103947368421053, AUC 0.9792007207870483, avg_entr 0.011070183478295803
Test Epoch26 layer3 Acc 0.9098684210526315, AUC 0.975498616695404, avg_entr 0.010066495276987553
Test Epoch26 layer4 Acc 0.91, AUC 0.9766153693199158, avg_entr 0.009831603616476059
gc 0
Train Epoch27 Acc 0.9697333333333333 (116368/120000), AUC 0.9956527352333069
Test Epoch27 layer0 Acc 0.9168421052631579, AUC 0.9809956550598145, avg_entr 0.03708704933524132
Test Epoch27 layer1 Acc 0.9085526315789474, AUC 0.9795868992805481, avg_entr 0.013444008305668831
Test Epoch27 layer2 Acc 0.9096052631578947, AUC 0.9794798493385315, avg_entr 0.010808257386088371
Test Epoch27 layer3 Acc 0.9094736842105263, AUC 0.975699245929718, avg_entr 0.010014292784035206
Test Epoch27 layer4 Acc 0.9097368421052632, AUC 0.9766231179237366, avg_entr 0.009833849966526031
gc 0
Train Epoch28 Acc 0.9698166666666667 (116378/120000), AUC 0.9956930875778198
Test Epoch28 layer0 Acc 0.9169736842105263, AUC 0.9809979796409607, avg_entr 0.03692631423473358
Test Epoch28 layer1 Acc 0.9085526315789474, AUC 0.9794851541519165, avg_entr 0.013341370970010757
Test Epoch28 layer2 Acc 0.9101315789473684, AUC 0.9793216586112976, avg_entr 0.010996191762387753
Test Epoch28 layer3 Acc 0.9098684210526315, AUC 0.9756256937980652, avg_entr 0.009582591243088245
Test Epoch28 layer4 Acc 0.9097368421052632, AUC 0.9764977693557739, avg_entr 0.009618918411433697
gc 0
Train Epoch29 Acc 0.9699916666666667 (116399/120000), AUC 0.995693564414978
Test Epoch29 layer0 Acc 0.916578947368421, AUC 0.980971097946167, avg_entr 0.03680606186389923
Test Epoch29 layer1 Acc 0.9082894736842105, AUC 0.9794521927833557, avg_entr 0.013321259059011936
Test Epoch29 layer2 Acc 0.9103947368421053, AUC 0.9792941808700562, avg_entr 0.010950579307973385
Test Epoch29 layer3 Acc 0.9093421052631578, AUC 0.9755983352661133, avg_entr 0.009432796388864517
Test Epoch29 layer4 Acc 0.9097368421052632, AUC 0.9764704704284668, avg_entr 0.009485970251262188
Best AUC 0.9839575886726379
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5_pad200//ag_news_lstmal_l5.pt
[[1704   56   92   48]
 [  10 1872   11    7]
 [  46   11 1682  161]
 [  44   12  124 1720]]
Figure(640x480)
tensor([0.0826, 0.0033, 0.0544,  ..., 0.1468, 0.0181, 0.5420])
[[1706   53   73   68]
 [  17 1862    9   12]
 [  52   16 1667  165]
 [  37   14  120 1729]]
Figure(640x480)
tensor([0.0120, 0.0081, 0.0099,  ..., 0.0069, 0.0068, 0.0534])
[[1708   51   76   65]
 [  22 1857   11   10]
 [  48   16 1674  162]
 [  37   15  122 1726]]
Figure(640x480)
tensor([0.0088, 0.0078, 0.0093,  ..., 0.0069, 0.0066, 0.0807])
[[1710   52   73   65]
 [  23 1854   11   12]
 [  54   15 1673  158]
 [  41   15  123 1721]]
Figure(640x480)
tensor([0.0127, 0.0136, 0.0126,  ..., 0.0086, 0.0089, 0.0365])
[[1708   50   75   67]
 [  24 1854   11   11]
 [  48   14 1675  163]
 [  40   13  125 1722]]
Figure(640x480)
tensor([0.0133, 0.0090, 0.0143,  ..., 0.0079, 0.0103, 0.0694])
