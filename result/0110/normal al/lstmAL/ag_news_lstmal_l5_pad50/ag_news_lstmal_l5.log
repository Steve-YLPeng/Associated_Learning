total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
gc 0
Train Epoch0 Acc 0.7247083333333333 (86965/120000), AUC 0.9141536951065063
Test Epoch0 layer0 Acc 0.9093421052631578, AUC 0.9791867733001709, avg_entr 0.22661282122135162
Save ckpt to ckpt/ag_news_lstmal_l5_pad50//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9092105263157895, AUC 0.9813430309295654, avg_entr 0.11582472920417786
Save ckpt to ckpt/ag_news_lstmal_l5_pad50//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9084210526315789, AUC 0.9820533990859985, avg_entr 0.10862207412719727
Save ckpt to ckpt/ag_news_lstmal_l5_pad50//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9071052631578947, AUC 0.9794425964355469, avg_entr 0.10150489956140518
Test Epoch0 layer4 Acc 0.9063157894736842, AUC 0.9793550968170166, avg_entr 0.10418565571308136
gc 0
Train Epoch1 Acc 0.9268 (111216/120000), AUC 0.9826453328132629
Test Epoch1 layer0 Acc 0.9180263157894737, AUC 0.9812078475952148, avg_entr 0.13700540363788605
Test Epoch1 layer1 Acc 0.9152631578947369, AUC 0.9834460020065308, avg_entr 0.05824800580739975
Save ckpt to ckpt/ag_news_lstmal_l5_pad50//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9151315789473684, AUC 0.9839320778846741, avg_entr 0.052112653851509094
Save ckpt to ckpt/ag_news_lstmal_l5_pad50//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9157894736842105, AUC 0.9810317754745483, avg_entr 0.04913607984781265
Test Epoch1 layer4 Acc 0.9147368421052632, AUC 0.9807985424995422, avg_entr 0.047328971326351166
gc 0
Train Epoch2 Acc 0.9376583333333334 (112519/120000), AUC 0.986980140209198
Test Epoch2 layer0 Acc 0.9163157894736842, AUC 0.981493353843689, avg_entr 0.11013954132795334
Test Epoch2 layer1 Acc 0.9156578947368421, AUC 0.9835081100463867, avg_entr 0.04032203555107117
Test Epoch2 layer2 Acc 0.9153947368421053, AUC 0.9837091565132141, avg_entr 0.03633026033639908
Test Epoch2 layer3 Acc 0.9153947368421053, AUC 0.9809764623641968, avg_entr 0.035593338310718536
Test Epoch2 layer4 Acc 0.9147368421052632, AUC 0.9799783229827881, avg_entr 0.03459674492478371
gc 0
Train Epoch3 Acc 0.943325 (113199/120000), AUC 0.9895395040512085
Test Epoch3 layer0 Acc 0.9175, AUC 0.9813178181648254, avg_entr 0.09325159341096878
Test Epoch3 layer1 Acc 0.9142105263157895, AUC 0.9832209944725037, avg_entr 0.03488650172948837
Test Epoch3 layer2 Acc 0.9135526315789474, AUC 0.9835875034332275, avg_entr 0.030471915379166603
Test Epoch3 layer3 Acc 0.9155263157894736, AUC 0.981805682182312, avg_entr 0.02845446579158306
Test Epoch3 layer4 Acc 0.9130263157894737, AUC 0.9813923835754395, avg_entr 0.027924172580242157
gc 0
Train Epoch4 Acc 0.947675 (113721/120000), AUC 0.991060733795166
Test Epoch4 layer0 Acc 0.9171052631578948, AUC 0.9811526536941528, avg_entr 0.08127231150865555
Test Epoch4 layer1 Acc 0.9175, AUC 0.9835623502731323, avg_entr 0.02985471673309803
Test Epoch4 layer2 Acc 0.9175, AUC 0.9835375547409058, avg_entr 0.025741806253790855
Test Epoch4 layer3 Acc 0.9180263157894737, AUC 0.9815545082092285, avg_entr 0.02462690882384777
Test Epoch4 layer4 Acc 0.9176315789473685, AUC 0.9815813302993774, avg_entr 0.023762790486216545
gc 0
Train Epoch5 Acc 0.9511333333333334 (114136/120000), AUC 0.9922266602516174
Test Epoch5 layer0 Acc 0.9173684210526316, AUC 0.9811620712280273, avg_entr 0.07589562982320786
Test Epoch5 layer1 Acc 0.9157894736842105, AUC 0.9837726950645447, avg_entr 0.027002952992916107
Test Epoch5 layer2 Acc 0.9155263157894736, AUC 0.9834229946136475, avg_entr 0.023323312401771545
Test Epoch5 layer3 Acc 0.9160526315789473, AUC 0.9814533591270447, avg_entr 0.0219118632376194
Test Epoch5 layer4 Acc 0.915, AUC 0.9804975390434265, avg_entr 0.021737555041909218
gc 0
Train Epoch6 Acc 0.9540583333333333 (114487/120000), AUC 0.9930920004844666
Test Epoch6 layer0 Acc 0.9146052631578947, AUC 0.9808609485626221, avg_entr 0.07004313915967941
Test Epoch6 layer1 Acc 0.9136842105263158, AUC 0.9827762842178345, avg_entr 0.024210125207901
Test Epoch6 layer2 Acc 0.9138157894736842, AUC 0.9827569127082825, avg_entr 0.020577745512127876
Test Epoch6 layer3 Acc 0.9131578947368421, AUC 0.9806663990020752, avg_entr 0.019428234547376633
Test Epoch6 layer4 Acc 0.9136842105263158, AUC 0.9811714291572571, avg_entr 0.01921052858233452
gc 0
Train Epoch7 Acc 0.9584666666666667 (115016/120000), AUC 0.9941375851631165
Test Epoch7 layer0 Acc 0.9148684210526316, AUC 0.9809370636940002, avg_entr 0.067184679210186
Test Epoch7 layer1 Acc 0.9132894736842105, AUC 0.983168363571167, avg_entr 0.023947902023792267
Test Epoch7 layer2 Acc 0.9131578947368421, AUC 0.9827597141265869, avg_entr 0.02041337639093399
Test Epoch7 layer3 Acc 0.915, AUC 0.9816134572029114, avg_entr 0.018712790682911873
Test Epoch7 layer4 Acc 0.9132894736842105, AUC 0.9823935031890869, avg_entr 0.018517252057790756
gc 0
Train Epoch8 Acc 0.9603833333333334 (115246/120000), AUC 0.9945411086082458
Test Epoch8 layer0 Acc 0.9153947368421053, AUC 0.9808194041252136, avg_entr 0.06645878404378891
Test Epoch8 layer1 Acc 0.9114473684210527, AUC 0.9825459122657776, avg_entr 0.02236192487180233
Test Epoch8 layer2 Acc 0.9126315789473685, AUC 0.982304036617279, avg_entr 0.01907062903046608
Test Epoch8 layer3 Acc 0.9117105263157895, AUC 0.9804211258888245, avg_entr 0.018290046602487564
Test Epoch8 layer4 Acc 0.9125, AUC 0.9791780710220337, avg_entr 0.017328457906842232
gc 0
Train Epoch9 Acc 0.9624416666666666 (115493/120000), AUC 0.9947934150695801
Test Epoch9 layer0 Acc 0.9138157894736842, AUC 0.9805958271026611, avg_entr 0.06187412515282631
Test Epoch9 layer1 Acc 0.9118421052631579, AUC 0.9820240139961243, avg_entr 0.021170323714613914
Test Epoch9 layer2 Acc 0.9117105263157895, AUC 0.9819647669792175, avg_entr 0.01840905100107193
Test Epoch9 layer3 Acc 0.9130263157894737, AUC 0.9804469347000122, avg_entr 0.016632361337542534
Test Epoch9 layer4 Acc 0.9110526315789473, AUC 0.9803436398506165, avg_entr 0.016698820516467094
gc 0
Train Epoch10 Acc 0.96415 (115698/120000), AUC 0.9950882196426392
Test Epoch10 layer0 Acc 0.9134210526315789, AUC 0.980438232421875, avg_entr 0.05918025225400925
Test Epoch10 layer1 Acc 0.9114473684210527, AUC 0.9813181161880493, avg_entr 0.019588539376854897
Test Epoch10 layer2 Acc 0.9110526315789473, AUC 0.9813928604125977, avg_entr 0.0167233906686306
Test Epoch10 layer3 Acc 0.9105263157894737, AUC 0.978935956954956, avg_entr 0.015529048629105091
Test Epoch10 layer4 Acc 0.9107894736842105, AUC 0.9775705337524414, avg_entr 0.014701830223202705
gc 0
Train Epoch11 Acc 0.9664583333333333 (115975/120000), AUC 0.995496392250061
Test Epoch11 layer0 Acc 0.9134210526315789, AUC 0.9803578853607178, avg_entr 0.057457633316516876
Test Epoch11 layer1 Acc 0.9085526315789474, AUC 0.9806435108184814, avg_entr 0.018520476296544075
Test Epoch11 layer2 Acc 0.9088157894736842, AUC 0.9810483455657959, avg_entr 0.015712877735495567
Test Epoch11 layer3 Acc 0.9086842105263158, AUC 0.9787447452545166, avg_entr 0.013726208359003067
Test Epoch11 layer4 Acc 0.9092105263157895, AUC 0.979339063167572, avg_entr 0.013734712265431881
gc 0
Train Epoch12 Acc 0.9674166666666667 (116090/120000), AUC 0.995685338973999
Test Epoch12 layer0 Acc 0.9128947368421053, AUC 0.9802948236465454, avg_entr 0.055691882967948914
Test Epoch12 layer1 Acc 0.9071052631578947, AUC 0.9797324538230896, avg_entr 0.017131902277469635
Test Epoch12 layer2 Acc 0.9085526315789474, AUC 0.9800773859024048, avg_entr 0.014597725123167038
Test Epoch12 layer3 Acc 0.9090789473684211, AUC 0.977397620677948, avg_entr 0.01246401946991682
Test Epoch12 layer4 Acc 0.9085526315789474, AUC 0.9777917861938477, avg_entr 0.012665324844419956
gc 0
Train Epoch13 Acc 0.9684583333333333 (116215/120000), AUC 0.9957831501960754
Test Epoch13 layer0 Acc 0.9130263157894737, AUC 0.9801615476608276, avg_entr 0.053844988346099854
Test Epoch13 layer1 Acc 0.9088157894736842, AUC 0.9801418781280518, avg_entr 0.01664864271879196
Test Epoch13 layer2 Acc 0.9093421052631578, AUC 0.9806197881698608, avg_entr 0.013959387317299843
Test Epoch13 layer3 Acc 0.9092105263157895, AUC 0.9780089259147644, avg_entr 0.012736673466861248
Test Epoch13 layer4 Acc 0.9092105263157895, AUC 0.9791266918182373, avg_entr 0.012240123003721237
gc 0
Train Epoch14 Acc 0.9697 (116364/120000), AUC 0.9958906173706055
Test Epoch14 layer0 Acc 0.9130263157894737, AUC 0.9801480770111084, avg_entr 0.05175010859966278
Test Epoch14 layer1 Acc 0.9048684210526315, AUC 0.9797171354293823, avg_entr 0.01622266322374344
Test Epoch14 layer2 Acc 0.9055263157894737, AUC 0.9798813462257385, avg_entr 0.013201898895204067
Test Epoch14 layer3 Acc 0.9067105263157895, AUC 0.9763472080230713, avg_entr 0.011989984661340714
Test Epoch14 layer4 Acc 0.9071052631578947, AUC 0.9776948094367981, avg_entr 0.011305771768093109
gc 0
Train Epoch15 Acc 0.9705083333333333 (116461/120000), AUC 0.9960157871246338
Test Epoch15 layer0 Acc 0.9126315789473685, AUC 0.9800482988357544, avg_entr 0.05054931342601776
Test Epoch15 layer1 Acc 0.9068421052631579, AUC 0.9793508052825928, avg_entr 0.016007453203201294
Test Epoch15 layer2 Acc 0.9072368421052631, AUC 0.9797542095184326, avg_entr 0.01356467790901661
Test Epoch15 layer3 Acc 0.9072368421052631, AUC 0.9761464595794678, avg_entr 0.011648296378552914
Test Epoch15 layer4 Acc 0.9072368421052631, AUC 0.977393627166748, avg_entr 0.010994255542755127
gc 0
Train Epoch16 Acc 0.97145 (116574/120000), AUC 0.9961599111557007
Test Epoch16 layer0 Acc 0.9132894736842105, AUC 0.98005211353302, avg_entr 0.04897164925932884
Test Epoch16 layer1 Acc 0.9056578947368421, AUC 0.9787651896476746, avg_entr 0.015594655647873878
Test Epoch16 layer2 Acc 0.9046052631578947, AUC 0.9793407917022705, avg_entr 0.012879233807325363
Test Epoch16 layer3 Acc 0.9051315789473684, AUC 0.9762865304946899, avg_entr 0.011372435837984085
Test Epoch16 layer4 Acc 0.9057894736842105, AUC 0.9771163463592529, avg_entr 0.01092845480889082
gc 0
Train Epoch17 Acc 0.9718666666666667 (116624/120000), AUC 0.9961785078048706
Test Epoch17 layer0 Acc 0.9127631578947368, AUC 0.9799754619598389, avg_entr 0.04756554961204529
Test Epoch17 layer1 Acc 0.9063157894736842, AUC 0.97884202003479, avg_entr 0.015323752537369728
Test Epoch17 layer2 Acc 0.9067105263157895, AUC 0.9791586995124817, avg_entr 0.01273950282484293
Test Epoch17 layer3 Acc 0.9068421052631579, AUC 0.9756314158439636, avg_entr 0.011364579200744629
Test Epoch17 layer4 Acc 0.9075, AUC 0.9769998788833618, avg_entr 0.010933157987892628
gc 0
Train Epoch18 Acc 0.972375 (116685/120000), AUC 0.9962261915206909
Test Epoch18 layer0 Acc 0.9130263157894737, AUC 0.9799832701683044, avg_entr 0.046186663210392
Test Epoch18 layer1 Acc 0.9060526315789473, AUC 0.9788027405738831, avg_entr 0.014558526687324047
Test Epoch18 layer2 Acc 0.9063157894736842, AUC 0.9791628122329712, avg_entr 0.011960708536207676
Test Epoch18 layer3 Acc 0.905921052631579, AUC 0.9754399061203003, avg_entr 0.011217653751373291
Test Epoch18 layer4 Acc 0.9072368421052631, AUC 0.9762721657752991, avg_entr 0.010578183457255363
gc 0
Train Epoch19 Acc 0.972925 (116751/120000), AUC 0.99628746509552
Test Epoch19 layer0 Acc 0.9132894736842105, AUC 0.9799436926841736, avg_entr 0.04517334699630737
Test Epoch19 layer1 Acc 0.9057894736842105, AUC 0.9789818525314331, avg_entr 0.014495555311441422
Test Epoch19 layer2 Acc 0.9055263157894737, AUC 0.9793609976768494, avg_entr 0.012097446247935295
Test Epoch19 layer3 Acc 0.9056578947368421, AUC 0.9758884310722351, avg_entr 0.010784462094306946
Test Epoch19 layer4 Acc 0.9068421052631579, AUC 0.9771614670753479, avg_entr 0.009846759960055351
gc 0
Train Epoch20 Acc 0.9733 (116796/120000), AUC 0.996332585811615
Test Epoch20 layer0 Acc 0.9118421052631579, AUC 0.979911744594574, avg_entr 0.04453272745013237
Test Epoch20 layer1 Acc 0.9048684210526315, AUC 0.9782190918922424, avg_entr 0.013910096138715744
Test Epoch20 layer2 Acc 0.9052631578947369, AUC 0.9787676334381104, avg_entr 0.011511114425957203
Test Epoch20 layer3 Acc 0.9057894736842105, AUC 0.9748173952102661, avg_entr 0.010749789886176586
Test Epoch20 layer4 Acc 0.9061842105263158, AUC 0.9760030508041382, avg_entr 0.010099880397319794
gc 0
Train Epoch21 Acc 0.973675 (116841/120000), AUC 0.9962862730026245
Test Epoch21 layer0 Acc 0.9126315789473685, AUC 0.9799818396568298, avg_entr 0.04302160069346428
Test Epoch21 layer1 Acc 0.9060526315789473, AUC 0.9779050350189209, avg_entr 0.013264871202409267
Test Epoch21 layer2 Acc 0.9051315789473684, AUC 0.9779824018478394, avg_entr 0.010561986826360226
Test Epoch21 layer3 Acc 0.9053947368421053, AUC 0.9746181964874268, avg_entr 0.009342288598418236
Test Epoch21 layer4 Acc 0.9055263157894737, AUC 0.9754898548126221, avg_entr 0.008754226379096508
gc 0
Train Epoch22 Acc 0.974025 (116883/120000), AUC 0.9962507486343384
Test Epoch22 layer0 Acc 0.9125, AUC 0.979948878288269, avg_entr 0.04195181280374527
Test Epoch22 layer1 Acc 0.9047368421052632, AUC 0.9779410362243652, avg_entr 0.012979136779904366
Test Epoch22 layer2 Acc 0.9040789473684211, AUC 0.9781783819198608, avg_entr 0.010580277070403099
Test Epoch22 layer3 Acc 0.9044736842105263, AUC 0.9743666648864746, avg_entr 0.009617510251700878
Test Epoch22 layer4 Acc 0.9060526315789473, AUC 0.9756411910057068, avg_entr 0.009082389995455742
gc 0
Train Epoch23 Acc 0.9744333333333334 (116932/120000), AUC 0.9963576197624207
Test Epoch23 layer0 Acc 0.9125, AUC 0.9799785614013672, avg_entr 0.04141934961080551
Test Epoch23 layer1 Acc 0.9047368421052632, AUC 0.9777566194534302, avg_entr 0.013384955003857613
Test Epoch23 layer2 Acc 0.9047368421052632, AUC 0.9781074523925781, avg_entr 0.01061874907463789
Test Epoch23 layer3 Acc 0.9051315789473684, AUC 0.9746127128601074, avg_entr 0.009489145129919052
Test Epoch23 layer4 Acc 0.905, AUC 0.9753490090370178, avg_entr 0.008884815499186516
gc 0
Train Epoch24 Acc 0.9746083333333333 (116953/120000), AUC 0.9963128566741943
Test Epoch24 layer0 Acc 0.9123684210526316, AUC 0.9799542427062988, avg_entr 0.04106927290558815
Test Epoch24 layer1 Acc 0.9047368421052632, AUC 0.9778821468353271, avg_entr 0.012743848375976086
Test Epoch24 layer2 Acc 0.9048684210526315, AUC 0.9782012701034546, avg_entr 0.010653674602508545
Test Epoch24 layer3 Acc 0.9056578947368421, AUC 0.9741425514221191, avg_entr 0.009502892382442951
Test Epoch24 layer4 Acc 0.9072368421052631, AUC 0.9753194451332092, avg_entr 0.008868060074746609
gc 0
Train Epoch25 Acc 0.974575 (116949/120000), AUC 0.996303379535675
Test Epoch25 layer0 Acc 0.9123684210526316, AUC 0.979947030544281, avg_entr 0.04054931551218033
Test Epoch25 layer1 Acc 0.9048684210526315, AUC 0.9777382016181946, avg_entr 0.0125920120626688
Test Epoch25 layer2 Acc 0.9051315789473684, AUC 0.9781752824783325, avg_entr 0.010113746859133244
Test Epoch25 layer3 Acc 0.9046052631578947, AUC 0.9743281006813049, avg_entr 0.009484603069722652
Test Epoch25 layer4 Acc 0.9063157894736842, AUC 0.9754983186721802, avg_entr 0.008597906678915024
gc 0
Train Epoch26 Acc 0.9748083333333334 (116977/120000), AUC 0.9963376522064209
Test Epoch26 layer0 Acc 0.9125, AUC 0.9799126982688904, avg_entr 0.04042016342282295
Test Epoch26 layer1 Acc 0.9047368421052632, AUC 0.9775477647781372, avg_entr 0.012465368025004864
Test Epoch26 layer2 Acc 0.9046052631578947, AUC 0.9779723882675171, avg_entr 0.01014238316565752
Test Epoch26 layer3 Acc 0.9048684210526315, AUC 0.9735468626022339, avg_entr 0.009502839297056198
Test Epoch26 layer4 Acc 0.9068421052631579, AUC 0.9742519855499268, avg_entr 0.008467506617307663
gc 0
Train Epoch27 Acc 0.9749833333333333 (116998/120000), AUC 0.9963449239730835
Test Epoch27 layer0 Acc 0.9122368421052631, AUC 0.9799280762672424, avg_entr 0.04007967188954353
Test Epoch27 layer1 Acc 0.9038157894736842, AUC 0.9774826169013977, avg_entr 0.012541580945253372
Test Epoch27 layer2 Acc 0.9051315789473684, AUC 0.9778928160667419, avg_entr 0.009979874826967716
Test Epoch27 layer3 Acc 0.9042105263157895, AUC 0.9738489389419556, avg_entr 0.00925068836659193
Test Epoch27 layer4 Acc 0.905921052631579, AUC 0.9746205806732178, avg_entr 0.008600951172411442
gc 0
Train Epoch28 Acc 0.975175 (117021/120000), AUC 0.996329128742218
Test Epoch28 layer0 Acc 0.9119736842105263, AUC 0.9799139499664307, avg_entr 0.03971756622195244
Test Epoch28 layer1 Acc 0.904342105263158, AUC 0.9773992300033569, avg_entr 0.012411367148160934
Test Epoch28 layer2 Acc 0.904342105263158, AUC 0.9778302907943726, avg_entr 0.01007087342441082
Test Epoch28 layer3 Acc 0.9046052631578947, AUC 0.9736573696136475, avg_entr 0.009180734865367413
Test Epoch28 layer4 Acc 0.905921052631579, AUC 0.9749056696891785, avg_entr 0.008712290786206722
gc 0
Train Epoch29 Acc 0.9751583333333333 (117019/120000), AUC 0.9963443279266357
Test Epoch29 layer0 Acc 0.9123684210526316, AUC 0.9799041748046875, avg_entr 0.039703432470560074
Test Epoch29 layer1 Acc 0.9046052631578947, AUC 0.9773858785629272, avg_entr 0.012056267820298672
Test Epoch29 layer2 Acc 0.9034210526315789, AUC 0.9777538776397705, avg_entr 0.009938601404428482
Test Epoch29 layer3 Acc 0.9042105263157895, AUC 0.9736748337745667, avg_entr 0.009026499465107918
Test Epoch29 layer4 Acc 0.9055263157894737, AUC 0.9744423627853394, avg_entr 0.008418040350079536
Best AUC 0.9839320778846741
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5_pad50//ag_news_lstmal_l5.pt
[[1684   63   98   55]
 [   6 1873   10   11]
 [  34   17 1698  151]
 [  31   17  130 1722]]
Figure(640x480)
tensor([0.1164, 0.0112, 0.1747,  ..., 0.1470, 0.0320, 0.3976])
[[1712   58   83   47]
 [  14 1868   11    7]
 [  56   13 1702  129]
 [  56   14  156 1674]]
Figure(640x480)
tensor([0.0245, 0.0263, 0.0293,  ..., 0.0165, 0.0143, 0.1767])
[[1714   59   81   46]
 [  17 1867   12    4]
 [  56   13 1702  129]
 [  55   18  155 1672]]
Figure(640x480)
tensor([0.0199, 0.0216, 0.0258,  ..., 0.0157, 0.0160, 0.1182])
[[1724   59   73   44]
 [  16 1871    9    4]
 [  61   14 1685  140]
 [  61   20  139 1680]]
Figure(640x480)
tensor([0.0233, 0.0148, 0.0168,  ..., 0.0161, 0.0180, 0.1084])
[[1720   59   78   43]
 [  15 1865   15    5]
 [  59   13 1699  129]
 [  58   19  155 1668]]
Figure(640x480)
tensor([0.0180, 0.0159, 0.0199,  ..., 0.0153, 0.0123, 0.0554])
