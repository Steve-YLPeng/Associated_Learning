total count words 222751
vocab size 30000
found 27937 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList()
  (emb): Embedding(30000, 300)
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb.weight 9000000
Total Trainable Params: 12937378
Start Training
gc 0
Train Epoch0 Acc 0.498775 (19951/40000), AUC 0.4989195168018341
Test Epoch0 layer0 Acc 0.5062, AUC 0.5038515329360962, avg_entr 0.6773818135261536
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5061, AUC 0.5086044073104858, avg_entr 0.677089273929596
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.5033, AUC 0.5038726925849915, avg_entr 0.6777982711791992
Test Epoch0 layer3 Acc 0.4975, AUC 0.48790812492370605, avg_entr 0.6775979995727539
Test Epoch0 layer4 Acc 0.4982, AUC 0.4960660934448242, avg_entr 0.6781858205795288
gc 0
Train Epoch1 Acc 0.5009 (20036/40000), AUC 0.5024393796920776
Test Epoch1 layer0 Acc 0.5128, AUC 0.5121804475784302, avg_entr 0.6901667714118958
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.5267, AUC 0.5292487144470215, avg_entr 0.6887768507003784
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.5174, AUC 0.5210558176040649, avg_entr 0.6887657642364502
Test Epoch1 layer3 Acc 0.5058, AUC 0.5010552406311035, avg_entr 0.6886157989501953
Test Epoch1 layer4 Acc 0.4945, AUC 0.4946027398109436, avg_entr 0.6890589594841003
gc 0
Train Epoch2 Acc 0.5064 (20256/40000), AUC 0.5113965272903442
Test Epoch2 layer0 Acc 0.5115, AUC 0.5219486951828003, avg_entr 0.6913820505142212
Test Epoch2 layer1 Acc 0.5072, AUC 0.5372107028961182, avg_entr 0.6907868385314941
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.5141, AUC 0.5298997163772583, avg_entr 0.6906354427337646
Test Epoch2 layer3 Acc 0.5061, AUC 0.5113399624824524, avg_entr 0.6913390755653381
Test Epoch2 layer4 Acc 0.4998, AUC 0.5007297992706299, avg_entr 0.69098299741745
gc 0
Train Epoch3 Acc 0.51055 (20422/40000), AUC 0.5148911476135254
Test Epoch3 layer0 Acc 0.5206, AUC 0.5270193815231323, avg_entr 0.6917420625686646
Test Epoch3 layer1 Acc 0.5202, AUC 0.5414682030677795, avg_entr 0.690788984298706
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.5203, AUC 0.5340632200241089, avg_entr 0.6901798248291016
Test Epoch3 layer3 Acc 0.5087, AUC 0.5126042366027832, avg_entr 0.6913594007492065
Test Epoch3 layer4 Acc 0.5025, AUC 0.50368332862854, avg_entr 0.69134521484375
gc 0
Train Epoch4 Acc 0.50855 (20342/40000), AUC 0.5144554376602173
Test Epoch4 layer0 Acc 0.513, AUC 0.5285094380378723, avg_entr 0.6913469433784485
Test Epoch4 layer1 Acc 0.5226, AUC 0.5435887575149536, avg_entr 0.6900092959403992
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.5196, AUC 0.536483645439148, avg_entr 0.689903974533081
Test Epoch4 layer3 Acc 0.5076, AUC 0.5179548263549805, avg_entr 0.6920074224472046
Test Epoch4 layer4 Acc 0.5031, AUC 0.5013331770896912, avg_entr 0.6912749409675598
gc 0
Train Epoch5 Acc 0.511225 (20449/40000), AUC 0.5177723169326782
Test Epoch5 layer0 Acc 0.5041, AUC 0.5314661860466003, avg_entr 0.6860804557800293
Test Epoch5 layer1 Acc 0.5153, AUC 0.5465490818023682, avg_entr 0.686410665512085
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.5153, AUC 0.5390136241912842, avg_entr 0.6872416138648987
Test Epoch5 layer3 Acc 0.5013, AUC 0.5190573930740356, avg_entr 0.6881821155548096
Test Epoch5 layer4 Acc 0.5048, AUC 0.50148606300354, avg_entr 0.6895828247070312
gc 0
Train Epoch6 Acc 0.517 (20680/40000), AUC 0.5234923958778381
Test Epoch6 layer0 Acc 0.5263, AUC 0.5335696339607239, avg_entr 0.6913787722587585
Test Epoch6 layer1 Acc 0.5337, AUC 0.5501314401626587, avg_entr 0.6871843934059143
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer2 Acc 0.525, AUC 0.5415078401565552, avg_entr 0.6871837973594666
Test Epoch6 layer3 Acc 0.5109, AUC 0.5228955745697021, avg_entr 0.691672682762146
Test Epoch6 layer4 Acc 0.5065, AUC 0.5077875852584839, avg_entr 0.6907859444618225
gc 0
Train Epoch7 Acc 0.515775 (20631/40000), AUC 0.5232088565826416
Test Epoch7 layer0 Acc 0.5288, AUC 0.5390180349349976, avg_entr 0.6890543103218079
Test Epoch7 layer1 Acc 0.5569, AUC 0.5760206580162048, avg_entr 0.6808633804321289
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer2 Acc 0.5297, AUC 0.5449038147926331, avg_entr 0.6870899200439453
Test Epoch7 layer3 Acc 0.5087, AUC 0.5238175988197327, avg_entr 0.690312385559082
Test Epoch7 layer4 Acc 0.5077, AUC 0.5087900161743164, avg_entr 0.6908918023109436
gc 0
Train Epoch8 Acc 0.517 (20680/40000), AUC 0.5279141664505005
Test Epoch8 layer0 Acc 0.5607, AUC 0.5955256223678589, avg_entr 0.6710084676742554
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer1 Acc 0.5719, AUC 0.602609395980835, avg_entr 0.6450880169868469
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer2 Acc 0.5529, AUC 0.565791130065918, avg_entr 0.6815963387489319
Test Epoch8 layer3 Acc 0.514, AUC 0.5277770757675171, avg_entr 0.6910374164581299
Test Epoch8 layer4 Acc 0.5071, AUC 0.509769082069397, avg_entr 0.6911430954933167
gc 0
Train Epoch9 Acc 0.516825 (20673/40000), AUC 0.5274409055709839
Test Epoch9 layer0 Acc 0.5777, AUC 0.6415766477584839, avg_entr 0.5771726965904236
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer1 Acc 0.5957, AUC 0.6516206860542297, avg_entr 0.5837252736091614
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer2 Acc 0.6171, AUC 0.6578981876373291, avg_entr 0.5998732447624207
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer3 Acc 0.5061, AUC 0.5432981848716736, avg_entr 0.6790362000465393
Test Epoch9 layer4 Acc 0.5072, AUC 0.5083522796630859, avg_entr 0.6843486428260803
gc 0
Train Epoch10 Acc 0.529025 (21161/40000), AUC 0.5440706610679626
Test Epoch10 layer0 Acc 0.6289, AUC 0.6838757395744324, avg_entr 0.5133006572723389
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer1 Acc 0.6417, AUC 0.707427978515625, avg_entr 0.4582556188106537
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer2 Acc 0.6425, AUC 0.7096726894378662, avg_entr 0.44162261486053467
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer3 Acc 0.6428, AUC 0.7007601261138916, avg_entr 0.458023339509964
Test Epoch10 layer4 Acc 0.5244, AUC 0.5758830308914185, avg_entr 0.6837093830108643
gc 0
Train Epoch11 Acc 0.60395 (24158/40000), AUC 0.6374317407608032
Test Epoch11 layer0 Acc 0.6461, AUC 0.7054973840713501, avg_entr 0.48195067048072815
Test Epoch11 layer1 Acc 0.6574, AUC 0.7327353954315186, avg_entr 0.4247188866138458
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer2 Acc 0.6557, AUC 0.7370696663856506, avg_entr 0.4024610221385956
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer3 Acc 0.6511, AUC 0.7295644283294678, avg_entr 0.44130873680114746
Test Epoch11 layer4 Acc 0.6649, AUC 0.7068861722946167, avg_entr 0.6301844716072083
gc 0
Train Epoch12 Acc 0.6744 (26976/40000), AUC 0.716984748840332
Test Epoch12 layer0 Acc 0.6608, AUC 0.7231976985931396, avg_entr 0.417710542678833
Test Epoch12 layer1 Acc 0.6752, AUC 0.7533649206161499, avg_entr 0.3651908338069916
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 12
Test Epoch12 layer2 Acc 0.6786, AUC 0.7597675323486328, avg_entr 0.34957149624824524
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 12
Test Epoch12 layer3 Acc 0.6737, AUC 0.7532204985618591, avg_entr 0.3386455476284027
Test Epoch12 layer4 Acc 0.6749, AUC 0.7410179972648621, avg_entr 0.3563690781593323
gc 0
Train Epoch13 Acc 0.70125 (28050/40000), AUC 0.7617220282554626
Test Epoch13 layer0 Acc 0.6703, AUC 0.7371525764465332, avg_entr 0.4072882831096649
Test Epoch13 layer1 Acc 0.69, AUC 0.768635630607605, avg_entr 0.35256335139274597
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer2 Acc 0.699, AUC 0.7787814140319824, avg_entr 0.31615549325942993
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer3 Acc 0.695, AUC 0.7726320028305054, avg_entr 0.2803533673286438
Test Epoch13 layer4 Acc 0.6923, AUC 0.7662742137908936, avg_entr 0.25926417112350464
gc 0
Train Epoch14 Acc 0.719575 (28783/40000), AUC 0.788200855255127
Test Epoch14 layer0 Acc 0.679, AUC 0.7496166229248047, avg_entr 0.3896999657154083
Test Epoch14 layer1 Acc 0.7051, AUC 0.7808997631072998, avg_entr 0.33538344502449036
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 14
Test Epoch14 layer2 Acc 0.7133, AUC 0.7932096719741821, avg_entr 0.32363244891166687
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 14
Test Epoch14 layer3 Acc 0.7139, AUC 0.7905286550521851, avg_entr 0.31976595520973206
Test Epoch14 layer4 Acc 0.7043, AUC 0.7885479927062988, avg_entr 0.31945618987083435
gc 0
Train Epoch15 Acc 0.738775 (29551/40000), AUC 0.8094161748886108
Test Epoch15 layer0 Acc 0.6898, AUC 0.760054886341095, avg_entr 0.36461931467056274
Test Epoch15 layer1 Acc 0.7142, AUC 0.7903631925582886, avg_entr 0.3031209707260132
Test Epoch15 layer2 Acc 0.7219, AUC 0.8032591342926025, avg_entr 0.29100051522254944
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 15
Test Epoch15 layer3 Acc 0.7223, AUC 0.8011319637298584, avg_entr 0.2815355956554413
Test Epoch15 layer4 Acc 0.72, AUC 0.7998851537704468, avg_entr 0.2932651937007904
gc 0
Train Epoch16 Acc 0.74605 (29842/40000), AUC 0.8212860822677612
Test Epoch16 layer0 Acc 0.6865, AUC 0.7684819102287292, avg_entr 0.3373669385910034
Test Epoch16 layer1 Acc 0.7098, AUC 0.7972161173820496, avg_entr 0.2874486446380615
Test Epoch16 layer2 Acc 0.7227, AUC 0.8105537295341492, avg_entr 0.2644712030887604
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 16
Test Epoch16 layer3 Acc 0.7143, AUC 0.8075875043869019, avg_entr 0.25044378638267517
Test Epoch16 layer4 Acc 0.7096, AUC 0.8056501746177673, avg_entr 0.26438355445861816
gc 0
Train Epoch17 Acc 0.76405 (30562/40000), AUC 0.8393877148628235
Test Epoch17 layer0 Acc 0.6771, AUC 0.7740843296051025, avg_entr 0.26379287242889404
Test Epoch17 layer1 Acc 0.6821, AUC 0.8047187328338623, avg_entr 0.18768325448036194
Test Epoch17 layer2 Acc 0.6873, AUC 0.8151525259017944, avg_entr 0.16652527451515198
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 17
Test Epoch17 layer3 Acc 0.6849, AUC 0.8107887506484985, avg_entr 0.15873651206493378
Test Epoch17 layer4 Acc 0.6816, AUC 0.8016120195388794, avg_entr 0.16393785178661346
gc 0
Train Epoch18 Acc 0.7658 (30632/40000), AUC 0.8438543081283569
Test Epoch18 layer0 Acc 0.7048, AUC 0.7795002460479736, avg_entr 0.32416415214538574
Test Epoch18 layer1 Acc 0.7228, AUC 0.8092420697212219, avg_entr 0.2681410610675812
Test Epoch18 layer2 Acc 0.7307, AUC 0.8219332695007324, avg_entr 0.23248615860939026
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 18
Test Epoch18 layer3 Acc 0.7267, AUC 0.8216671943664551, avg_entr 0.21334372460842133
Test Epoch18 layer4 Acc 0.726, AUC 0.8200026750564575, avg_entr 0.21503564715385437
gc 0
Train Epoch19 Acc 0.77735 (31094/40000), AUC 0.8575863838195801
Test Epoch19 layer0 Acc 0.7033, AUC 0.782289981842041, avg_entr 0.26329556107521057
Test Epoch19 layer1 Acc 0.7288, AUC 0.8141636848449707, avg_entr 0.20920781791210175
Test Epoch19 layer2 Acc 0.7405, AUC 0.8273264169692993, avg_entr 0.20187561213970184
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 19
Test Epoch19 layer3 Acc 0.7386, AUC 0.8272924423217773, avg_entr 0.2090764194726944
Test Epoch19 layer4 Acc 0.7398, AUC 0.8255398273468018, avg_entr 0.21764150261878967
gc 0
Train Epoch20 Acc 0.795125 (31805/40000), AUC 0.8721204996109009
Test Epoch20 layer0 Acc 0.7046, AUC 0.7885293960571289, avg_entr 0.259480744600296
Test Epoch20 layer1 Acc 0.7293, AUC 0.8192467093467712, avg_entr 0.2005622386932373
Test Epoch20 layer2 Acc 0.7408, AUC 0.8304777145385742, avg_entr 0.18653011322021484
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 20
Test Epoch20 layer3 Acc 0.7432, AUC 0.8311330080032349, avg_entr 0.18831586837768555
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 20
Test Epoch20 layer4 Acc 0.7376, AUC 0.830162525177002, avg_entr 0.19752371311187744
gc 0
Train Epoch21 Acc 0.80015 (32006/40000), AUC 0.8783586025238037
Test Epoch21 layer0 Acc 0.7094, AUC 0.7914419174194336, avg_entr 0.24478237330913544
Test Epoch21 layer1 Acc 0.7353, AUC 0.8233886957168579, avg_entr 0.21068596839904785
Test Epoch21 layer2 Acc 0.7404, AUC 0.8354016542434692, avg_entr 0.2024564892053604
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 21
Test Epoch21 layer3 Acc 0.739, AUC 0.8367184400558472, avg_entr 0.19184419512748718
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 21
Test Epoch21 layer4 Acc 0.7368, AUC 0.8363125324249268, avg_entr 0.1904779076576233
gc 0
Train Epoch22 Acc 0.8156 (32624/40000), AUC 0.8912610411643982
Test Epoch22 layer0 Acc 0.6931, AUC 0.7936544418334961, avg_entr 0.21429431438446045
Test Epoch22 layer1 Acc 0.7092, AUC 0.8234047889709473, avg_entr 0.16472138464450836
Test Epoch22 layer2 Acc 0.7089, AUC 0.8327475786209106, avg_entr 0.14998723566532135
Test Epoch22 layer3 Acc 0.7037, AUC 0.8305139541625977, avg_entr 0.14446601271629333
Test Epoch22 layer4 Acc 0.6975, AUC 0.8294916152954102, avg_entr 0.14609457552433014
gc 0
Train Epoch23 Acc 0.814975 (32599/40000), AUC 0.8904135227203369
Test Epoch23 layer0 Acc 0.7067, AUC 0.7945234179496765, avg_entr 0.21053317189216614
Test Epoch23 layer1 Acc 0.715, AUC 0.8264322280883789, avg_entr 0.16846191883087158
Test Epoch23 layer2 Acc 0.7224, AUC 0.8376529812812805, avg_entr 0.1612502634525299
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 23
Test Epoch23 layer3 Acc 0.724, AUC 0.8379712104797363, avg_entr 0.1582104116678238
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 23
Test Epoch23 layer4 Acc 0.7246, AUC 0.836250364780426, avg_entr 0.1639994978904724
gc 0
Train Epoch24 Acc 0.83145 (33258/40000), AUC 0.9076218008995056
Test Epoch24 layer0 Acc 0.7174, AUC 0.7972999811172485, avg_entr 0.20369207859039307
Test Epoch24 layer1 Acc 0.7462, AUC 0.8298453092575073, avg_entr 0.16199861466884613
Test Epoch24 layer2 Acc 0.7609, AUC 0.8419255018234253, avg_entr 0.1395847201347351
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 24
Test Epoch24 layer3 Acc 0.7658, AUC 0.8425367474555969, avg_entr 0.12304798513650894
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 24
Test Epoch24 layer4 Acc 0.7625, AUC 0.8412824273109436, avg_entr 0.1166091039776802
gc 0
Train Epoch25 Acc 0.84 (33600/40000), AUC 0.9142996072769165
Test Epoch25 layer0 Acc 0.7202, AUC 0.7994944453239441, avg_entr 0.20830495655536652
Test Epoch25 layer1 Acc 0.7531, AUC 0.8316834568977356, avg_entr 0.14905381202697754
Test Epoch25 layer2 Acc 0.7612, AUC 0.8422932624816895, avg_entr 0.12057613581418991
Test Epoch25 layer3 Acc 0.7616, AUC 0.8413439989089966, avg_entr 0.10544542223215103
Test Epoch25 layer4 Acc 0.7594, AUC 0.8388561606407166, avg_entr 0.10443930327892303
gc 0
Train Epoch26 Acc 0.84775 (33910/40000), AUC 0.9210665225982666
Test Epoch26 layer0 Acc 0.7111, AUC 0.7985005378723145, avg_entr 0.18249838054180145
Test Epoch26 layer1 Acc 0.7347, AUC 0.8312147855758667, avg_entr 0.1547985076904297
Test Epoch26 layer2 Acc 0.726, AUC 0.8414101004600525, avg_entr 0.15089568495750427
Test Epoch26 layer3 Acc 0.7083, AUC 0.8411476612091064, avg_entr 0.1529138684272766
Test Epoch26 layer4 Acc 0.6983, AUC 0.8409326672554016, avg_entr 0.16377153992652893
gc 0
Train Epoch27 Acc 0.847775 (33911/40000), AUC 0.920071005821228
Test Epoch27 layer0 Acc 0.7177, AUC 0.7981580495834351, avg_entr 0.1577972173690796
Test Epoch27 layer1 Acc 0.7406, AUC 0.8286688327789307, avg_entr 0.11370273679494858
Test Epoch27 layer2 Acc 0.7482, AUC 0.8392713069915771, avg_entr 0.10283207893371582
Test Epoch27 layer3 Acc 0.7467, AUC 0.8389986157417297, avg_entr 0.09774922579526901
Test Epoch27 layer4 Acc 0.7453, AUC 0.8378020524978638, avg_entr 0.10019146651029587
gc 0
Train Epoch28 Acc 0.86335 (34534/40000), AUC 0.9328497648239136
Test Epoch28 layer0 Acc 0.7259, AUC 0.8029042482376099, avg_entr 0.1771731823682785
Test Epoch28 layer1 Acc 0.7466, AUC 0.8316702842712402, avg_entr 0.13858886063098907
Test Epoch28 layer2 Acc 0.7496, AUC 0.8421761989593506, avg_entr 0.12340671569108963
Test Epoch28 layer3 Acc 0.7484, AUC 0.8437285423278809, avg_entr 0.12055090069770813
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 28
Test Epoch28 layer4 Acc 0.7487, AUC 0.8433152437210083, avg_entr 0.13375048339366913
gc 0
Train Epoch29 Acc 0.8704 (34816/40000), AUC 0.9371498823165894
Test Epoch29 layer0 Acc 0.7248, AUC 0.8013818264007568, avg_entr 0.17166952788829803
Test Epoch29 layer1 Acc 0.7498, AUC 0.8333088755607605, avg_entr 0.12756912410259247
Test Epoch29 layer2 Acc 0.7627, AUC 0.8439995646476746, avg_entr 0.10519479960203171
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 29
Test Epoch29 layer3 Acc 0.7622, AUC 0.8447936773300171, avg_entr 0.09248794615268707
Save ckpt to ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt  ,ep 29
Test Epoch29 layer4 Acc 0.7615, AUC 0.8430168032646179, avg_entr 0.08611070364713669
gc 0
Train Epoch30 Acc 0.877325 (35093/40000), AUC 0.9399250745773315
Test Epoch30 layer0 Acc 0.7211, AUC 0.8012890219688416, avg_entr 0.1298384666442871
Test Epoch30 layer1 Acc 0.7495, AUC 0.8323944807052612, avg_entr 0.08633832633495331
Test Epoch30 layer2 Acc 0.7573, AUC 0.8398874998092651, avg_entr 0.07031256705522537
Test Epoch30 layer3 Acc 0.7582, AUC 0.8396773338317871, avg_entr 0.06391932815313339
Test Epoch30 layer4 Acc 0.7576, AUC 0.8375451564788818, avg_entr 0.06460940092802048
gc 0
Train Epoch31 Acc 0.88355 (35342/40000), AUC 0.9464215040206909
Test Epoch31 layer0 Acc 0.6948, AUC 0.7985007762908936, avg_entr 0.11310212314128876
Test Epoch31 layer1 Acc 0.7161, AUC 0.8307549953460693, avg_entr 0.08990530669689178
Test Epoch31 layer2 Acc 0.7258, AUC 0.8367377519607544, avg_entr 0.08154012262821198
Test Epoch31 layer3 Acc 0.7295, AUC 0.840363621711731, avg_entr 0.07861337810754776
Test Epoch31 layer4 Acc 0.7279, AUC 0.8368488550186157, avg_entr 0.07857164740562439
gc 0
Train Epoch32 Acc 0.886525 (35461/40000), AUC 0.9492802619934082
Test Epoch32 layer0 Acc 0.7231, AUC 0.8011568784713745, avg_entr 0.11994618922472
Test Epoch32 layer1 Acc 0.7503, AUC 0.8312016725540161, avg_entr 0.0796758234500885
Test Epoch32 layer2 Acc 0.7596, AUC 0.8394999504089355, avg_entr 0.06362171471118927
Test Epoch32 layer3 Acc 0.7618, AUC 0.8389611840248108, avg_entr 0.05887964367866516
Test Epoch32 layer4 Acc 0.7597, AUC 0.8376361131668091, avg_entr 0.06245582923293114
gc 0
Train Epoch33 Acc 0.89595 (35838/40000), AUC 0.9550357460975647
Test Epoch33 layer0 Acc 0.7219, AUC 0.8018696904182434, avg_entr 0.11868469417095184
Test Epoch33 layer1 Acc 0.7454, AUC 0.8319635987281799, avg_entr 0.07724042981863022
Test Epoch33 layer2 Acc 0.7586, AUC 0.8404300212860107, avg_entr 0.06795985996723175
Test Epoch33 layer3 Acc 0.7583, AUC 0.8386737108230591, avg_entr 0.059411756694316864
Test Epoch33 layer4 Acc 0.7575, AUC 0.8382651805877686, avg_entr 0.058804746717214584
gc 0
Train Epoch34 Acc 0.9108 (36432/40000), AUC 0.9653509259223938
Test Epoch34 layer0 Acc 0.7128, AUC 0.7988404035568237, avg_entr 0.10038044303655624
Test Epoch34 layer1 Acc 0.7406, AUC 0.8272421956062317, avg_entr 0.06661145389080048
Test Epoch34 layer2 Acc 0.7538, AUC 0.833735466003418, avg_entr 0.05832281336188316
Test Epoch34 layer3 Acc 0.7544, AUC 0.8352426886558533, avg_entr 0.051244139671325684
Test Epoch34 layer4 Acc 0.7552, AUC 0.8340973854064941, avg_entr 0.05016455054283142
gc 0
Train Epoch35 Acc 0.91255 (36502/40000), AUC 0.9660776853561401
Test Epoch35 layer0 Acc 0.7169, AUC 0.798190712928772, avg_entr 0.10245268791913986
Test Epoch35 layer1 Acc 0.741, AUC 0.8263725638389587, avg_entr 0.06394147127866745
Test Epoch35 layer2 Acc 0.751, AUC 0.8344383239746094, avg_entr 0.04890550673007965
Test Epoch35 layer3 Acc 0.7538, AUC 0.8348863124847412, avg_entr 0.04336242377758026
Test Epoch35 layer4 Acc 0.7525, AUC 0.8337743282318115, avg_entr 0.04394327476620674
gc 0
Train Epoch36 Acc 0.918475 (36739/40000), AUC 0.9683272838592529
Test Epoch36 layer0 Acc 0.7159, AUC 0.7975467443466187, avg_entr 0.09010671824216843
Test Epoch36 layer1 Acc 0.7453, AUC 0.8262137174606323, avg_entr 0.06548700481653214
Test Epoch36 layer2 Acc 0.7527, AUC 0.8351597785949707, avg_entr 0.061028867959976196
Test Epoch36 layer3 Acc 0.7539, AUC 0.8378840684890747, avg_entr 0.05860045924782753
Test Epoch36 layer4 Acc 0.7544, AUC 0.8371847867965698, avg_entr 0.061500854790210724
gc 0
Train Epoch37 Acc 0.920775 (36831/40000), AUC 0.9700899124145508
Test Epoch37 layer0 Acc 0.7223, AUC 0.7995181083679199, avg_entr 0.0894675999879837
Test Epoch37 layer1 Acc 0.7437, AUC 0.8260926008224487, avg_entr 0.06129429489374161
Test Epoch37 layer2 Acc 0.7533, AUC 0.8322479724884033, avg_entr 0.05617285147309303
Test Epoch37 layer3 Acc 0.7531, AUC 0.8337920308113098, avg_entr 0.05647303909063339
Test Epoch37 layer4 Acc 0.7534, AUC 0.8326517343521118, avg_entr 0.059223487973213196
gc 0
Train Epoch38 Acc 0.93095 (37238/40000), AUC 0.9747562408447266
Test Epoch38 layer0 Acc 0.7196, AUC 0.7967814207077026, avg_entr 0.0856398418545723
Test Epoch38 layer1 Acc 0.7436, AUC 0.82341468334198, avg_entr 0.05310862883925438
Test Epoch38 layer2 Acc 0.7535, AUC 0.8283165097236633, avg_entr 0.043878648430109024
Test Epoch38 layer3 Acc 0.7532, AUC 0.8302605152130127, avg_entr 0.04071526974439621
Test Epoch38 layer4 Acc 0.7526, AUC 0.829036295413971, avg_entr 0.040726207196712494
gc 0
Train Epoch39 Acc 0.933 (37320/40000), AUC 0.9754148125648499
Test Epoch39 layer0 Acc 0.7224, AUC 0.7988098859786987, avg_entr 0.08621146529912949
Test Epoch39 layer1 Acc 0.7487, AUC 0.8244709968566895, avg_entr 0.05523449182510376
Test Epoch39 layer2 Acc 0.755, AUC 0.8296633362770081, avg_entr 0.04842638596892357
Test Epoch39 layer3 Acc 0.7553, AUC 0.8328191041946411, avg_entr 0.04609883204102516
Test Epoch39 layer4 Acc 0.7551, AUC 0.8315689563751221, avg_entr 0.048228926956653595
gc 0
Train Epoch40 Acc 0.93305 (37322/40000), AUC 0.9761345386505127
Test Epoch40 layer0 Acc 0.7191, AUC 0.7984112501144409, avg_entr 0.08503852784633636
Test Epoch40 layer1 Acc 0.7473, AUC 0.8250641822814941, avg_entr 0.05590213090181351
Test Epoch40 layer2 Acc 0.7574, AUC 0.8310238122940063, avg_entr 0.042583856731653214
Test Epoch40 layer3 Acc 0.7598, AUC 0.8330448865890503, avg_entr 0.04081720858812332
Test Epoch40 layer4 Acc 0.7584, AUC 0.8306906223297119, avg_entr 0.040027864277362823
gc 0
Train Epoch41 Acc 0.93635 (37454/40000), AUC 0.9771487712860107
Test Epoch41 layer0 Acc 0.719, AUC 0.7964878082275391, avg_entr 0.07845817506313324
Test Epoch41 layer1 Acc 0.7445, AUC 0.8229387402534485, avg_entr 0.05027026683092117
Test Epoch41 layer2 Acc 0.7536, AUC 0.8278871178627014, avg_entr 0.04182180389761925
Test Epoch41 layer3 Acc 0.7559, AUC 0.8302912712097168, avg_entr 0.03982451930642128
Test Epoch41 layer4 Acc 0.7558, AUC 0.8299910426139832, avg_entr 0.04122145101428032
gc 0
Train Epoch42 Acc 0.9397 (37588/40000), AUC 0.979137659072876
Test Epoch42 layer0 Acc 0.7192, AUC 0.7965474128723145, avg_entr 0.07684172689914703
Test Epoch42 layer1 Acc 0.7459, AUC 0.8213984966278076, avg_entr 0.050210945308208466
Test Epoch42 layer2 Acc 0.7532, AUC 0.8249959945678711, avg_entr 0.03951722010970116
Test Epoch42 layer3 Acc 0.7557, AUC 0.8281501531600952, avg_entr 0.03731705993413925
Test Epoch42 layer4 Acc 0.755, AUC 0.8273413181304932, avg_entr 0.03827590495347977
gc 0
Train Epoch43 Acc 0.94305 (37722/40000), AUC 0.979934811592102
Test Epoch43 layer0 Acc 0.7152, AUC 0.7955048084259033, avg_entr 0.07212629169225693
Test Epoch43 layer1 Acc 0.7418, AUC 0.8195044994354248, avg_entr 0.04700484126806259
Test Epoch43 layer2 Acc 0.7493, AUC 0.8238071203231812, avg_entr 0.038872599601745605
Test Epoch43 layer3 Acc 0.7501, AUC 0.8255908489227295, avg_entr 0.03497586399316788
Test Epoch43 layer4 Acc 0.75, AUC 0.8257026076316833, avg_entr 0.034951452165842056
gc 0
Train Epoch44 Acc 0.9428 (37712/40000), AUC 0.9799267053604126
Test Epoch44 layer0 Acc 0.7163, AUC 0.7951643466949463, avg_entr 0.07231606543064117
Test Epoch44 layer1 Acc 0.7422, AUC 0.8194184303283691, avg_entr 0.04703018069267273
Test Epoch44 layer2 Acc 0.7488, AUC 0.822895348072052, avg_entr 0.03793404996395111
Test Epoch44 layer3 Acc 0.7498, AUC 0.825019359588623, avg_entr 0.03342709317803383
Test Epoch44 layer4 Acc 0.7501, AUC 0.8249343633651733, avg_entr 0.03480962663888931
gc 0
Train Epoch45 Acc 0.944075 (37763/40000), AUC 0.9805045127868652
Test Epoch45 layer0 Acc 0.7197, AUC 0.7947483062744141, avg_entr 0.07091682404279709
Test Epoch45 layer1 Acc 0.7431, AUC 0.818681001663208, avg_entr 0.04339401051402092
Test Epoch45 layer2 Acc 0.75, AUC 0.8199705481529236, avg_entr 0.032805997878313065
Test Epoch45 layer3 Acc 0.7534, AUC 0.8240349888801575, avg_entr 0.029583459720015526
Test Epoch45 layer4 Acc 0.7529, AUC 0.8227577209472656, avg_entr 0.029869472607970238
gc 0
Train Epoch46 Acc 0.946 (37840/40000), AUC 0.9811453819274902
Test Epoch46 layer0 Acc 0.7152, AUC 0.7954028248786926, avg_entr 0.06866087764501572
Test Epoch46 layer1 Acc 0.7404, AUC 0.8185080289840698, avg_entr 0.042642563581466675
Test Epoch46 layer2 Acc 0.7476, AUC 0.8218374252319336, avg_entr 0.03366154059767723
Test Epoch46 layer3 Acc 0.751, AUC 0.8255990743637085, avg_entr 0.031093712896108627
Test Epoch46 layer4 Acc 0.7491, AUC 0.8246684074401855, avg_entr 0.031027313321828842
gc 0
Train Epoch47 Acc 0.9465 (37860/40000), AUC 0.9815585017204285
Test Epoch47 layer0 Acc 0.7162, AUC 0.7944353818893433, avg_entr 0.0700751468539238
Test Epoch47 layer1 Acc 0.7447, AUC 0.8185312151908875, avg_entr 0.04416448622941971
Test Epoch47 layer2 Acc 0.7499, AUC 0.8216425776481628, avg_entr 0.03501048684120178
Test Epoch47 layer3 Acc 0.753, AUC 0.8256338834762573, avg_entr 0.03165961429476738
Test Epoch47 layer4 Acc 0.7532, AUC 0.8249828815460205, avg_entr 0.0320110060274601
gc 0
Train Epoch48 Acc 0.94775 (37910/40000), AUC 0.981805682182312
Test Epoch48 layer0 Acc 0.7145, AUC 0.7946437001228333, avg_entr 0.06718640774488449
Test Epoch48 layer1 Acc 0.7403, AUC 0.8180710077285767, avg_entr 0.040937818586826324
Test Epoch48 layer2 Acc 0.7461, AUC 0.8203120231628418, avg_entr 0.03168913349509239
Test Epoch48 layer3 Acc 0.7469, AUC 0.8242809176445007, avg_entr 0.028691288083791733
Test Epoch48 layer4 Acc 0.7461, AUC 0.8239026069641113, avg_entr 0.028071459382772446
gc 0
Train Epoch49 Acc 0.948125 (37925/40000), AUC 0.9821343421936035
Test Epoch49 layer0 Acc 0.7175, AUC 0.7943524122238159, avg_entr 0.06731986254453659
Test Epoch49 layer1 Acc 0.7426, AUC 0.8177791833877563, avg_entr 0.03956235200166702
Test Epoch49 layer2 Acc 0.7521, AUC 0.8188796043395996, avg_entr 0.029947778210043907
Test Epoch49 layer3 Acc 0.7538, AUC 0.8229944705963135, avg_entr 0.0277575496584177
Test Epoch49 layer4 Acc 0.7541, AUC 0.8224350214004517, avg_entr 0.028508197516202927
Best AUC 0.8447936773300171
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_lstmalside_l5_side200//imdb_lstmalside_l5_side.pt
[[3692 1331]
 [1421 3556]]
Figure(640x480)
tensor([0.5724, 0.3600, 0.1024,  ..., 0.0505, 0.1090, 0.0241])
[[3971 1052]
 [1450 3527]]
Figure(640x480)
tensor([0.0297, 0.6142, 0.1698,  ..., 0.0066, 0.0318, 0.0505])
[[4022 1001]
 [1372 3605]]
Figure(640x480)
tensor([0.0141, 0.4706, 0.6203,  ..., 0.0213, 0.0176, 0.0595])
[[4046  977]
 [1401 3576]]
Figure(640x480)
tensor([0.0213, 0.3602, 0.4971,  ..., 0.0041, 0.0127, 0.0443])
[[4073  950]
 [1435 3542]]
Figure(640x480)
tensor([0.1519, 0.3544, 0.5680,  ..., 0.0025, 0.0074, 0.0133])
