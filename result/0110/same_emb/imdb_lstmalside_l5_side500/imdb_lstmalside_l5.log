total count words 222751
vocab size 30000
found 27937 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList()
  (emb): Embedding(30000, 300)
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb.weight 9000000
Total Trainable Params: 12937378
Start Training
gc 0
Train Epoch0 Acc 0.499725 (19989/40000), AUC 0.5001195073127747
Test Epoch0 layer0 Acc 0.4962, AUC 0.509012758731842, avg_entr 0.6853811740875244
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.4988, AUC 0.5058944225311279, avg_entr 0.6864656805992126
Test Epoch0 layer2 Acc 0.4976, AUC 0.5028282999992371, avg_entr 0.685285747051239
Test Epoch0 layer3 Acc 0.4967, AUC 0.49966275691986084, avg_entr 0.6856018304824829
Test Epoch0 layer4 Acc 0.5, AUC 0.5090106725692749, avg_entr 0.6852045655250549
gc 0
Train Epoch1 Acc 0.502725 (20109/40000), AUC 0.5052952766418457
Test Epoch1 layer0 Acc 0.5019, AUC 0.5163505673408508, avg_entr 0.6921582818031311
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.5034, AUC 0.5089441537857056, avg_entr 0.6922281980514526
Test Epoch1 layer2 Acc 0.4997, AUC 0.5062949657440186, avg_entr 0.6915475130081177
Test Epoch1 layer3 Acc 0.4982, AUC 0.5063669085502625, avg_entr 0.6919962167739868
Test Epoch1 layer4 Acc 0.5069, AUC 0.5096145868301392, avg_entr 0.6921833753585815
gc 0
Train Epoch2 Acc 0.50835 (20334/40000), AUC 0.5127320289611816
Test Epoch2 layer0 Acc 0.5093, AUC 0.5199698209762573, avg_entr 0.6920190453529358
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.5049, AUC 0.5129866600036621, avg_entr 0.6920446157455444
Test Epoch2 layer2 Acc 0.5025, AUC 0.5022841095924377, avg_entr 0.6920881271362305
Test Epoch2 layer3 Acc 0.507, AUC 0.5084960460662842, avg_entr 0.6921542882919312
Test Epoch2 layer4 Acc 0.5061, AUC 0.5031967163085938, avg_entr 0.6924145817756653
gc 0
Train Epoch3 Acc 0.5063 (20252/40000), AUC 0.5140397548675537
Test Epoch3 layer0 Acc 0.5196, AUC 0.5224625468254089, avg_entr 0.6911846399307251
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.5036, AUC 0.5008406043052673, avg_entr 0.6932657957077026
Test Epoch3 layer2 Acc 0.5073, AUC 0.5127221345901489, avg_entr 0.6906231641769409
Test Epoch3 layer3 Acc 0.5073, AUC 0.5057797431945801, avg_entr 0.6919102668762207
Test Epoch3 layer4 Acc 0.507, AUC 0.5071220397949219, avg_entr 0.6917712092399597
gc 0
Train Epoch4 Acc 0.509825 (20393/40000), AUC 0.5154874324798584
Test Epoch4 layer0 Acc 0.511, AUC 0.5249340534210205, avg_entr 0.6911922097206116
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.5053, AUC 0.5167911052703857, avg_entr 0.6924434304237366
Test Epoch4 layer2 Acc 0.5058, AUC 0.5092559456825256, avg_entr 0.6922338008880615
Test Epoch4 layer3 Acc 0.4967, AUC 0.5073286294937134, avg_entr 0.6916926503181458
Test Epoch4 layer4 Acc 0.4974, AUC 0.5044630765914917, avg_entr 0.691585898399353
gc 0
Train Epoch5 Acc 0.50585 (20234/40000), AUC 0.512951135635376
Test Epoch5 layer0 Acc 0.5092, AUC 0.5253499746322632, avg_entr 0.6902644038200378
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.4992, AUC 0.5130128860473633, avg_entr 0.6921572089195251
Test Epoch5 layer2 Acc 0.5006, AUC 0.5128110647201538, avg_entr 0.6906782388687134
Test Epoch5 layer3 Acc 0.4971, AUC 0.5036231279373169, avg_entr 0.6910660266876221
Test Epoch5 layer4 Acc 0.4968, AUC 0.505466639995575, avg_entr 0.6909880042076111
gc 0
Train Epoch6 Acc 0.50885 (20354/40000), AUC 0.5132921934127808
Test Epoch6 layer0 Acc 0.5105, AUC 0.5298724174499512, avg_entr 0.6859856843948364
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.4977, AUC 0.5127749443054199, avg_entr 0.6891852617263794
Test Epoch6 layer2 Acc 0.4984, AUC 0.5114446878433228, avg_entr 0.6898748278617859
Test Epoch6 layer3 Acc 0.4966, AUC 0.504326581954956, avg_entr 0.6883981227874756
Test Epoch6 layer4 Acc 0.4969, AUC 0.5040277242660522, avg_entr 0.6910591125488281
gc 0
Train Epoch7 Acc 0.509875 (20395/40000), AUC 0.5144391059875488
Test Epoch7 layer0 Acc 0.5135, AUC 0.5331194400787354, avg_entr 0.6807032227516174
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer1 Acc 0.5011, AUC 0.5262012481689453, avg_entr 0.6878751516342163
Test Epoch7 layer2 Acc 0.499, AUC 0.5133410692214966, avg_entr 0.6878580451011658
Test Epoch7 layer3 Acc 0.4968, AUC 0.5065175294876099, avg_entr 0.6895861625671387
Test Epoch7 layer4 Acc 0.4967, AUC 0.5041987299919128, avg_entr 0.6895532608032227
gc 0
Train Epoch8 Acc 0.5074 (20296/40000), AUC 0.5144475698471069
Test Epoch8 layer0 Acc 0.5771, AUC 0.6014441251754761, avg_entr 0.6579565405845642
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer1 Acc 0.5096, AUC 0.5189653038978577, avg_entr 0.6912630796432495
Test Epoch8 layer2 Acc 0.5033, AUC 0.5165632367134094, avg_entr 0.6925718188285828
Test Epoch8 layer3 Acc 0.5061, AUC 0.5063189268112183, avg_entr 0.6911155581474304
Test Epoch8 layer4 Acc 0.4972, AUC 0.5014770030975342, avg_entr 0.6908215284347534
gc 0
Train Epoch9 Acc 0.5054 (20216/40000), AUC 0.5096110105514526
Test Epoch9 layer0 Acc 0.5931, AUC 0.6434992551803589, avg_entr 0.5826602578163147
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer1 Acc 0.5041, AUC 0.5162699222564697, avg_entr 0.6922135949134827
Test Epoch9 layer2 Acc 0.51, AUC 0.5128824710845947, avg_entr 0.6914758682250977
Test Epoch9 layer3 Acc 0.5075, AUC 0.507765531539917, avg_entr 0.6904649138450623
Test Epoch9 layer4 Acc 0.5054, AUC 0.5040829181671143, avg_entr 0.6903533339500427
gc 0
Train Epoch10 Acc 0.50635 (20254/40000), AUC 0.5118167400360107
Test Epoch10 layer0 Acc 0.6348, AUC 0.688707709312439, avg_entr 0.5309044718742371
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer1 Acc 0.5111, AUC 0.5289822816848755, avg_entr 0.6886368989944458
Test Epoch10 layer2 Acc 0.5102, AUC 0.5114961266517639, avg_entr 0.6890710592269897
Test Epoch10 layer3 Acc 0.5063, AUC 0.5063750743865967, avg_entr 0.6899470686912537
Test Epoch10 layer4 Acc 0.5052, AUC 0.5014374852180481, avg_entr 0.6903219223022461
gc 0
Train Epoch11 Acc 0.5069 (20276/40000), AUC 0.5133688449859619
Test Epoch11 layer0 Acc 0.6682, AUC 0.7301245927810669, avg_entr 0.4064300060272217
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer1 Acc 0.668, AUC 0.7286996841430664, avg_entr 0.42372411489486694
Test Epoch11 layer2 Acc 0.5101, AUC 0.5127804279327393, avg_entr 0.6893073320388794
Test Epoch11 layer3 Acc 0.4978, AUC 0.5066956281661987, avg_entr 0.6880534887313843
Test Epoch11 layer4 Acc 0.4968, AUC 0.5039067268371582, avg_entr 0.6879271864891052
gc 0
Train Epoch12 Acc 0.5102 (20408/40000), AUC 0.5126827955245972
Test Epoch12 layer0 Acc 0.648, AUC 0.7642996311187744, avg_entr 0.36824992299079895
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 12
Test Epoch12 layer1 Acc 0.6437, AUC 0.7589048743247986, avg_entr 0.3759118318557739
Test Epoch12 layer2 Acc 0.5007, AUC 0.5098056793212891, avg_entr 0.6829893589019775
Test Epoch12 layer3 Acc 0.4973, AUC 0.507306694984436, avg_entr 0.6861938834190369
Test Epoch12 layer4 Acc 0.4964, AUC 0.5056383609771729, avg_entr 0.6859012842178345
gc 0
Train Epoch13 Acc 0.5071 (20284/40000), AUC 0.5095462799072266
Test Epoch13 layer0 Acc 0.7065, AUC 0.7830938100814819, avg_entr 0.35168173909187317
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer1 Acc 0.7138, AUC 0.7880080342292786, avg_entr 0.31713631749153137
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer2 Acc 0.5096, AUC 0.5174187421798706, avg_entr 0.6890677809715271
Test Epoch13 layer3 Acc 0.5061, AUC 0.5076479911804199, avg_entr 0.6895463466644287
Test Epoch13 layer4 Acc 0.5049, AUC 0.5004388093948364, avg_entr 0.6895688772201538
gc 0
Train Epoch14 Acc 0.50675 (20270/40000), AUC 0.5113856792449951
Test Epoch14 layer0 Acc 0.7141, AUC 0.794772744178772, avg_entr 0.3091987371444702
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 14
Test Epoch14 layer1 Acc 0.7181, AUC 0.8000063896179199, avg_entr 0.30702176690101624
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 14
Test Epoch14 layer2 Acc 0.5029, AUC 0.5161439180374146, avg_entr 0.6865482330322266
Test Epoch14 layer3 Acc 0.4973, AUC 0.506839394569397, avg_entr 0.6888842582702637
Test Epoch14 layer4 Acc 0.4971, AUC 0.5007563829421997, avg_entr 0.689086377620697
gc 0
Train Epoch15 Acc 0.50085 (20034/40000), AUC 0.506278395652771
Test Epoch15 layer0 Acc 0.7082, AUC 0.8042305707931519, avg_entr 0.29806482791900635
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 15
Test Epoch15 layer1 Acc 0.7107, AUC 0.8054282069206238, avg_entr 0.27126920223236084
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 15
Test Epoch15 layer2 Acc 0.5088, AUC 0.48174840211868286, avg_entr 0.683068037033081
Test Epoch15 layer3 Acc 0.5068, AUC 0.50861656665802, avg_entr 0.6880598068237305
Test Epoch15 layer4 Acc 0.5048, AUC 0.5045545101165771, avg_entr 0.6876277327537537
gc 0
Train Epoch16 Acc 0.504425 (20177/40000), AUC 0.5075596570968628
Test Epoch16 layer0 Acc 0.7284, AUC 0.8157575726509094, avg_entr 0.28740912675857544
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 16
Test Epoch16 layer1 Acc 0.7397, AUC 0.8216089010238647, avg_entr 0.24632737040519714
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 16
Test Epoch16 layer2 Acc 0.5086, AUC 0.43268996477127075, avg_entr 0.685757577419281
Test Epoch16 layer3 Acc 0.4973, AUC 0.5075820684432983, avg_entr 0.6876261234283447
Test Epoch16 layer4 Acc 0.4967, AUC 0.5046724081039429, avg_entr 0.6876356601715088
gc 0
Train Epoch17 Acc 0.507675 (20307/40000), AUC 0.5127794742584229
Test Epoch17 layer0 Acc 0.7324, AUC 0.822084903717041, avg_entr 0.23256456851959229
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 17
Test Epoch17 layer1 Acc 0.743, AUC 0.8268523216247559, avg_entr 0.20162296295166016
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 17
Test Epoch17 layer2 Acc 0.508, AUC 0.5129048824310303, avg_entr 0.6594511270523071
Test Epoch17 layer3 Acc 0.5064, AUC 0.5101833939552307, avg_entr 0.6839251518249512
Test Epoch17 layer4 Acc 0.506, AUC 0.500556468963623, avg_entr 0.6832243204116821
gc 0
Train Epoch18 Acc 0.50755 (20302/40000), AUC 0.5120867490768433
Test Epoch18 layer0 Acc 0.7452, AUC 0.8287351131439209, avg_entr 0.23181723058223724
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 18
Test Epoch18 layer1 Acc 0.753, AUC 0.8343148231506348, avg_entr 0.1808796226978302
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 18
Test Epoch18 layer2 Acc 0.5085, AUC 0.5192036628723145, avg_entr 0.6852571368217468
Test Epoch18 layer3 Acc 0.5068, AUC 0.508247971534729, avg_entr 0.6882333159446716
Test Epoch18 layer4 Acc 0.5051, AUC 0.5010514855384827, avg_entr 0.6885711550712585
gc 0
Train Epoch19 Acc 0.506975 (20279/40000), AUC 0.5127224922180176
Test Epoch19 layer0 Acc 0.7422, AUC 0.8349684476852417, avg_entr 0.24398083984851837
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 19
Test Epoch19 layer1 Acc 0.7439, AUC 0.8412920236587524, avg_entr 0.22294478118419647
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 19
Test Epoch19 layer2 Acc 0.503, AUC 0.490376353263855, avg_entr 0.6757849454879761
Test Epoch19 layer3 Acc 0.4978, AUC 0.5074571371078491, avg_entr 0.684330403804779
Test Epoch19 layer4 Acc 0.4972, AUC 0.5028824806213379, avg_entr 0.6876085996627808
gc 0
Train Epoch20 Acc 0.5055 (20220/40000), AUC 0.5087480545043945
Test Epoch20 layer0 Acc 0.751, AUC 0.839946448802948, avg_entr 0.20313672721385956
Test Epoch20 layer1 Acc 0.7573, AUC 0.8463939428329468, avg_entr 0.18822543323040009
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 20
Test Epoch20 layer2 Acc 0.5037, AUC 0.5162089467048645, avg_entr 0.6774759292602539
Test Epoch20 layer3 Acc 0.4976, AUC 0.5078655481338501, avg_entr 0.6869525909423828
Test Epoch20 layer4 Acc 0.5048, AUC 0.5043313503265381, avg_entr 0.6881251931190491
gc 0
Train Epoch21 Acc 0.5076 (20304/40000), AUC 0.5089427828788757
Test Epoch21 layer0 Acc 0.7577, AUC 0.8450757265090942, avg_entr 0.21628843247890472
Test Epoch21 layer1 Acc 0.7614, AUC 0.8520734310150146, avg_entr 0.21887405216693878
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 21
Test Epoch21 layer2 Acc 0.5017, AUC 0.5138503313064575, avg_entr 0.6765621304512024
Test Epoch21 layer3 Acc 0.4975, AUC 0.5109374523162842, avg_entr 0.6870392560958862
Test Epoch21 layer4 Acc 0.5049, AUC 0.5029656291007996, avg_entr 0.6881437301635742
gc 0
Train Epoch22 Acc 0.506925 (20277/40000), AUC 0.5089853405952454
Test Epoch22 layer0 Acc 0.7672, AUC 0.8499257564544678, avg_entr 0.2028936892747879
Test Epoch22 layer1 Acc 0.7769, AUC 0.8569320440292358, avg_entr 0.17890745401382446
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 22
Test Epoch22 layer2 Acc 0.5011, AUC 0.3966103792190552, avg_entr 0.6771697998046875
Test Epoch22 layer3 Acc 0.4976, AUC 0.5083843469619751, avg_entr 0.683983564376831
Test Epoch22 layer4 Acc 0.4972, AUC 0.5057070255279541, avg_entr 0.6876167058944702
gc 0
Train Epoch23 Acc 0.505775 (20231/40000), AUC 0.5093856453895569
Test Epoch23 layer0 Acc 0.7654, AUC 0.8494815230369568, avg_entr 0.14772914350032806
Test Epoch23 layer1 Acc 0.7742, AUC 0.855137050151825, avg_entr 0.11728005111217499
Test Epoch23 layer2 Acc 0.5096, AUC 0.5132574439048767, avg_entr 0.6758671402931213
Test Epoch23 layer3 Acc 0.5076, AUC 0.5097309350967407, avg_entr 0.6833239197731018
Test Epoch23 layer4 Acc 0.5048, AUC 0.5014538764953613, avg_entr 0.6871325373649597
gc 0
Train Epoch24 Acc 0.506725 (20269/40000), AUC 0.5072060823440552
Test Epoch24 layer0 Acc 0.7216, AUC 0.8497079014778137, avg_entr 0.1325400024652481
Test Epoch24 layer1 Acc 0.7219, AUC 0.8547148704528809, avg_entr 0.12880383431911469
Test Epoch24 layer2 Acc 0.5093, AUC 0.4076186716556549, avg_entr 0.676720917224884
Test Epoch24 layer3 Acc 0.5075, AUC 0.5083960294723511, avg_entr 0.684639036655426
Test Epoch24 layer4 Acc 0.5048, AUC 0.5042248964309692, avg_entr 0.6868115067481995
gc 0
Train Epoch25 Acc 0.509175 (20367/40000), AUC 0.5113690495491028
Test Epoch25 layer0 Acc 0.7681, AUC 0.8552759885787964, avg_entr 0.16297629475593567
Test Epoch25 layer1 Acc 0.7764, AUC 0.8622792959213257, avg_entr 0.15353168547153473
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 25
Test Epoch25 layer2 Acc 0.502, AUC 0.5071749687194824, avg_entr 0.6677979230880737
Test Epoch25 layer3 Acc 0.4975, AUC 0.503662109375, avg_entr 0.6786965727806091
Test Epoch25 layer4 Acc 0.497, AUC 0.505821943283081, avg_entr 0.686694860458374
gc 0
Train Epoch26 Acc 0.507025 (20281/40000), AUC 0.5134967565536499
Test Epoch26 layer0 Acc 0.7719, AUC 0.8570811152458191, avg_entr 0.13126839697360992
Test Epoch26 layer1 Acc 0.781, AUC 0.8644613027572632, avg_entr 0.11630765348672867
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 26
Test Epoch26 layer2 Acc 0.508, AUC 0.5039507150650024, avg_entr 0.6765148043632507
Test Epoch26 layer3 Acc 0.5069, AUC 0.5062898397445679, avg_entr 0.6859232187271118
Test Epoch26 layer4 Acc 0.5051, AUC 0.5021822452545166, avg_entr 0.687106192111969
gc 0
Train Epoch27 Acc 0.507125 (20285/40000), AUC 0.5070090293884277
Test Epoch27 layer0 Acc 0.7742, AUC 0.8578447103500366, avg_entr 0.12373059242963791
Test Epoch27 layer1 Acc 0.7833, AUC 0.8655831813812256, avg_entr 0.11124573647975922
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 27
Test Epoch27 layer2 Acc 0.5091, AUC 0.5864619612693787, avg_entr 0.6753226518630981
Test Epoch27 layer3 Acc 0.5063, AUC 0.5095014572143555, avg_entr 0.685853123664856
Test Epoch27 layer4 Acc 0.505, AUC 0.503182590007782, avg_entr 0.6869667768478394
gc 0
Train Epoch28 Acc 0.5084 (20336/40000), AUC 0.509384274482727
Test Epoch28 layer0 Acc 0.779, AUC 0.860945463180542, avg_entr 0.11707824468612671
Test Epoch28 layer1 Acc 0.788, AUC 0.8689289093017578, avg_entr 0.10186111181974411
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 28
Test Epoch28 layer2 Acc 0.5102, AUC 0.5157893896102905, avg_entr 0.6737357974052429
Test Epoch28 layer3 Acc 0.5074, AUC 0.5069369077682495, avg_entr 0.6843592524528503
Test Epoch28 layer4 Acc 0.5049, AUC 0.5013607144355774, avg_entr 0.6867886781692505
gc 0
Train Epoch29 Acc 0.508475 (20339/40000), AUC 0.5076165199279785
Test Epoch29 layer0 Acc 0.7586, AUC 0.8610410690307617, avg_entr 0.11779788881540298
Test Epoch29 layer1 Acc 0.7608, AUC 0.8692675828933716, avg_entr 0.10576736181974411
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 29
Test Epoch29 layer2 Acc 0.5087, AUC 0.5118223428726196, avg_entr 0.6739441752433777
Test Epoch29 layer3 Acc 0.5061, AUC 0.5097150802612305, avg_entr 0.68520587682724
Test Epoch29 layer4 Acc 0.505, AUC 0.504705548286438, avg_entr 0.6866444945335388
gc 0
Train Epoch30 Acc 0.5084 (20336/40000), AUC 0.5114458799362183
Test Epoch30 layer0 Acc 0.7805, AUC 0.8623780012130737, avg_entr 0.10648627579212189
Test Epoch30 layer1 Acc 0.7898, AUC 0.870130181312561, avg_entr 0.09198695421218872
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 30
Test Epoch30 layer2 Acc 0.5015, AUC 0.4497966170310974, avg_entr 0.6722043752670288
Test Epoch30 layer3 Acc 0.4973, AUC 0.5074901580810547, avg_entr 0.6843714118003845
Test Epoch30 layer4 Acc 0.5047, AUC 0.5024512410163879, avg_entr 0.68654865026474
gc 0
Train Epoch31 Acc 0.5083 (20332/40000), AUC 0.5079293251037598
Test Epoch31 layer0 Acc 0.775, AUC 0.8630586266517639, avg_entr 0.09655950963497162
Test Epoch31 layer1 Acc 0.7858, AUC 0.8689793348312378, avg_entr 0.0877171978354454
Test Epoch31 layer2 Acc 0.5086, AUC 0.38230061531066895, avg_entr 0.6724781394004822
Test Epoch31 layer3 Acc 0.5066, AUC 0.5109065771102905, avg_entr 0.6849393844604492
Test Epoch31 layer4 Acc 0.505, AUC 0.503105640411377, avg_entr 0.6864126920700073
gc 0
Train Epoch32 Acc 0.5084 (20336/40000), AUC 0.5087279081344604
Test Epoch32 layer0 Acc 0.774, AUC 0.863511323928833, avg_entr 0.09523594379425049
Test Epoch32 layer1 Acc 0.7794, AUC 0.8720299601554871, avg_entr 0.08310849964618683
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 32
Test Epoch32 layer2 Acc 0.5032, AUC 0.5167937278747559, avg_entr 0.671652615070343
Test Epoch32 layer3 Acc 0.5065, AUC 0.5078275799751282, avg_entr 0.6845409870147705
Test Epoch32 layer4 Acc 0.505, AUC 0.5057398080825806, avg_entr 0.6862636208534241
gc 0
Train Epoch33 Acc 0.5083 (20332/40000), AUC 0.5109944939613342
Test Epoch33 layer0 Acc 0.7657, AUC 0.8632346391677856, avg_entr 0.09061634540557861
Test Epoch33 layer1 Acc 0.769, AUC 0.8711719512939453, avg_entr 0.07484984397888184
Test Epoch33 layer2 Acc 0.5076, AUC 0.5095459222793579, avg_entr 0.6712023615837097
Test Epoch33 layer3 Acc 0.5064, AUC 0.508945643901825, avg_entr 0.6843792200088501
Test Epoch33 layer4 Acc 0.5049, AUC 0.5023206472396851, avg_entr 0.6860953569412231
gc 0
Train Epoch34 Acc 0.50845 (20338/40000), AUC 0.508463978767395
Test Epoch34 layer0 Acc 0.7721, AUC 0.8618497848510742, avg_entr 0.0927773043513298
Test Epoch34 layer1 Acc 0.7765, AUC 0.8703198432922363, avg_entr 0.08524257689714432
Test Epoch34 layer2 Acc 0.508, AUC 0.49419641494750977, avg_entr 0.6706187725067139
Test Epoch34 layer3 Acc 0.5065, AUC 0.5050100088119507, avg_entr 0.6841527223587036
Test Epoch34 layer4 Acc 0.505, AUC 0.5009979009628296, avg_entr 0.6859376430511475
gc 0
Train Epoch35 Acc 0.50845 (20338/40000), AUC 0.5074321031570435
Test Epoch35 layer0 Acc 0.7819, AUC 0.8635212182998657, avg_entr 0.0831645131111145
Test Epoch35 layer1 Acc 0.7904, AUC 0.8724715113639832, avg_entr 0.07073516398668289
Save ckpt to ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt  ,ep 35
Test Epoch35 layer2 Acc 0.508, AUC 0.5187723636627197, avg_entr 0.6699420809745789
Test Epoch35 layer3 Acc 0.5065, AUC 0.5079027414321899, avg_entr 0.6838976740837097
Test Epoch35 layer4 Acc 0.505, AUC 0.5017522573471069, avg_entr 0.6857675909996033
gc 0
Train Epoch36 Acc 0.508425 (20337/40000), AUC 0.5079474449157715
Test Epoch36 layer0 Acc 0.7801, AUC 0.8630167245864868, avg_entr 0.07407431304454803
Test Epoch36 layer1 Acc 0.7902, AUC 0.8713191747665405, avg_entr 0.06297090649604797
Test Epoch36 layer2 Acc 0.5084, AUC 0.5168875455856323, avg_entr 0.6694208383560181
Test Epoch36 layer3 Acc 0.5063, AUC 0.5079004764556885, avg_entr 0.6837344169616699
Test Epoch36 layer4 Acc 0.505, AUC 0.5027726888656616, avg_entr 0.6856061816215515
gc 0
Train Epoch37 Acc 0.508375 (20335/40000), AUC 0.5082722902297974
Test Epoch37 layer0 Acc 0.7822, AUC 0.8627350926399231, avg_entr 0.06650125980377197
Test Epoch37 layer1 Acc 0.7913, AUC 0.8696523904800415, avg_entr 0.047579556703567505
Test Epoch37 layer2 Acc 0.5074, AUC 0.5067863464355469, avg_entr 0.669007420539856
Test Epoch37 layer3 Acc 0.5066, AUC 0.5109047293663025, avg_entr 0.6835896968841553
Test Epoch37 layer4 Acc 0.5049, AUC 0.5013131499290466, avg_entr 0.6855326294898987
gc 0
Train Epoch38 Acc 0.508425 (20337/40000), AUC 0.5087184906005859
Test Epoch38 layer0 Acc 0.7822, AUC 0.8632062673568726, avg_entr 0.06683441996574402
Test Epoch38 layer1 Acc 0.7916, AUC 0.8721375465393066, avg_entr 0.05495079234242439
Test Epoch38 layer2 Acc 0.5095, AUC 0.5120324492454529, avg_entr 0.6685088276863098
Test Epoch38 layer3 Acc 0.5065, AUC 0.5085599422454834, avg_entr 0.6834770441055298
Test Epoch38 layer4 Acc 0.505, AUC 0.5048913955688477, avg_entr 0.6854670643806458
gc 0
Train Epoch39 Acc 0.508425 (20337/40000), AUC 0.5087299346923828
Test Epoch39 layer0 Acc 0.7816, AUC 0.8624460101127625, avg_entr 0.062037792056798935
Test Epoch39 layer1 Acc 0.7917, AUC 0.8694478869438171, avg_entr 0.046375107020139694
Test Epoch39 layer2 Acc 0.5028, AUC 0.5412625074386597, avg_entr 0.6680440306663513
Test Epoch39 layer3 Acc 0.5066, AUC 0.507529616355896, avg_entr 0.6832911372184753
Test Epoch39 layer4 Acc 0.5049, AUC 0.5016219019889832, avg_entr 0.6853713989257812
gc 0
Train Epoch40 Acc 0.508425 (20337/40000), AUC 0.5076699256896973
Test Epoch40 layer0 Acc 0.783, AUC 0.8619123697280884, avg_entr 0.05891432613134384
Test Epoch40 layer1 Acc 0.7919, AUC 0.868844747543335, avg_entr 0.046375248581171036
Test Epoch40 layer2 Acc 0.5075, AUC 0.49759185314178467, avg_entr 0.6679483652114868
Test Epoch40 layer3 Acc 0.5066, AUC 0.5065693855285645, avg_entr 0.68318772315979
Test Epoch40 layer4 Acc 0.505, AUC 0.5033634901046753, avg_entr 0.6852656602859497
gc 0
Train Epoch41 Acc 0.508325 (20333/40000), AUC 0.5085775852203369
Test Epoch41 layer0 Acc 0.7805, AUC 0.8610613346099854, avg_entr 0.05433329567313194
Test Epoch41 layer1 Acc 0.7903, AUC 0.8664368391036987, avg_entr 0.04000668600201607
Test Epoch41 layer2 Acc 0.5079, AUC 0.3921964168548584, avg_entr 0.667779266834259
Test Epoch41 layer3 Acc 0.5065, AUC 0.5063523054122925, avg_entr 0.6830977201461792
Test Epoch41 layer4 Acc 0.5049, AUC 0.5040110349655151, avg_entr 0.6851928234100342
gc 0
Train Epoch42 Acc 0.5084 (20336/40000), AUC 0.5065327882766724
Test Epoch42 layer0 Acc 0.7826, AUC 0.8616002798080444, avg_entr 0.05442878603935242
Test Epoch42 layer1 Acc 0.7907, AUC 0.8700144290924072, avg_entr 0.042767707258462906
Test Epoch42 layer2 Acc 0.5079, AUC 0.5159142017364502, avg_entr 0.6675607562065125
Test Epoch42 layer3 Acc 0.5065, AUC 0.5088105201721191, avg_entr 0.6830089092254639
Test Epoch42 layer4 Acc 0.5049, AUC 0.5007869005203247, avg_entr 0.6851391792297363
gc 0
Train Epoch43 Acc 0.50835 (20334/40000), AUC 0.5081698298454285
Test Epoch43 layer0 Acc 0.7839, AUC 0.8621678352355957, avg_entr 0.054932255297899246
Test Epoch43 layer1 Acc 0.7877, AUC 0.870410680770874, avg_entr 0.043359894305467606
Test Epoch43 layer2 Acc 0.509, AUC 0.4986175298690796, avg_entr 0.6672688722610474
Test Epoch43 layer3 Acc 0.5065, AUC 0.5076329708099365, avg_entr 0.6829333305358887
Test Epoch43 layer4 Acc 0.5049, AUC 0.49919432401657104, avg_entr 0.685084342956543
gc 0
Train Epoch44 Acc 0.5084 (20336/40000), AUC 0.5062344074249268
Test Epoch44 layer0 Acc 0.7815, AUC 0.8611335754394531, avg_entr 0.052214354276657104
Test Epoch44 layer1 Acc 0.7918, AUC 0.868832528591156, avg_entr 0.04259876161813736
Test Epoch44 layer2 Acc 0.5081, AUC 0.5651605129241943, avg_entr 0.6671350002288818
Test Epoch44 layer3 Acc 0.5065, AUC 0.506706714630127, avg_entr 0.6828235983848572
Test Epoch44 layer4 Acc 0.5049, AUC 0.5045223236083984, avg_entr 0.6850197911262512
gc 0
Train Epoch45 Acc 0.508425 (20337/40000), AUC 0.5061708688735962
Test Epoch45 layer0 Acc 0.783, AUC 0.8608223795890808, avg_entr 0.0521506667137146
Test Epoch45 layer1 Acc 0.7906, AUC 0.8692331314086914, avg_entr 0.0426044799387455
Test Epoch45 layer2 Acc 0.5078, AUC 0.4717912971973419, avg_entr 0.6669832468032837
Test Epoch45 layer3 Acc 0.5065, AUC 0.5102143287658691, avg_entr 0.682775616645813
Test Epoch45 layer4 Acc 0.5049, AUC 0.5051039457321167, avg_entr 0.6849672794342041
gc 0
Train Epoch46 Acc 0.5084 (20336/40000), AUC 0.5076819062232971
Test Epoch46 layer0 Acc 0.7824, AUC 0.8593435287475586, avg_entr 0.04719432070851326
Test Epoch46 layer1 Acc 0.7905, AUC 0.8655612468719482, avg_entr 0.039421021938323975
Test Epoch46 layer2 Acc 0.5076, AUC 0.5148115158081055, avg_entr 0.666824460029602
Test Epoch46 layer3 Acc 0.5065, AUC 0.5062155723571777, avg_entr 0.6827236413955688
Test Epoch46 layer4 Acc 0.5049, AUC 0.5055794715881348, avg_entr 0.6849339604377747
gc 0
Train Epoch47 Acc 0.508425 (20337/40000), AUC 0.5088123083114624
Test Epoch47 layer0 Acc 0.7833, AUC 0.8595374822616577, avg_entr 0.04627715051174164
Test Epoch47 layer1 Acc 0.7937, AUC 0.8670637011528015, avg_entr 0.037850163877010345
Test Epoch47 layer2 Acc 0.5077, AUC 0.4527062177658081, avg_entr 0.6666796803474426
Test Epoch47 layer3 Acc 0.5066, AUC 0.5086177587509155, avg_entr 0.6826595067977905
Test Epoch47 layer4 Acc 0.5049, AUC 0.5050168633460999, avg_entr 0.6848861575126648
gc 0
Train Epoch48 Acc 0.508425 (20337/40000), AUC 0.5065187215805054
Test Epoch48 layer0 Acc 0.782, AUC 0.8581751585006714, avg_entr 0.045849550515413284
Test Epoch48 layer1 Acc 0.7909, AUC 0.8648506999015808, avg_entr 0.03763723745942116
Test Epoch48 layer2 Acc 0.5078, AUC 0.48766595125198364, avg_entr 0.6665399670600891
Test Epoch48 layer3 Acc 0.5065, AUC 0.5078854560852051, avg_entr 0.6825929284095764
Test Epoch48 layer4 Acc 0.5049, AUC 0.5021933317184448, avg_entr 0.684841513633728
gc 0
Train Epoch49 Acc 0.508425 (20337/40000), AUC 0.5068157911300659
Test Epoch49 layer0 Acc 0.7803, AUC 0.8588984608650208, avg_entr 0.04500238969922066
Test Epoch49 layer1 Acc 0.7911, AUC 0.8659015893936157, avg_entr 0.035707518458366394
Test Epoch49 layer2 Acc 0.5078, AUC 0.38517218828201294, avg_entr 0.6664496660232544
Test Epoch49 layer3 Acc 0.5065, AUC 0.5096871256828308, avg_entr 0.6825452446937561
Test Epoch49 layer4 Acc 0.5049, AUC 0.504667341709137, avg_entr 0.684807300567627
Best AUC 0.8724715113639832
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_lstmalside_l5_side500//imdb_lstmalside_l5_side.pt
[[4027  937]
 [1244 3792]]
Figure(640x480)
tensor([0.5362, 0.0617, 0.0013,  ..., 0.6142, 0.0029, 0.0021])
[[4083  881]
 [1215 3821]]
Figure(640x480)
tensor([0.3911, 0.2619, 0.0012,  ..., 0.6552, 0.0017, 0.0017])
[[ 664 4300]
 [ 620 4416]]
Figure(640x480)
tensor([0.6940, 0.6940, 0.6940,  ..., 0.4634, 0.6940, 0.6940])
[[ 559 4405]
 [ 530 4506]]
Figure(640x480)
tensor([0.6934, 0.6934, 0.6934,  ..., 0.6141, 0.6934, 0.6934])
[[ 352 4612]
 [ 338 4698]]
Figure(640x480)
tensor([0.6937, 0.6937, 0.6937,  ..., 0.5326, 0.6937, 0.6937])
