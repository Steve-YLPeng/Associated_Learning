total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList()
  (emb): Embedding(30000, 300)
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb.weight 9000000
Total Trainable Params: 12937892
Start Training
gc 0
Train Epoch0 Acc 0.2518416666666667 (30221/120000), AUC 0.500575840473175
Test Epoch0 layer0 Acc 0.3311842105263158, AUC 0.6287225484848022, avg_entr 1.465207576751709
Save ckpt to ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.25276315789473686, AUC 0.5570708513259888, avg_entr 1.466900110244751
Test Epoch0 layer2 Acc 0.25184210526315787, AUC 0.47891294956207275, avg_entr 1.4684123992919922
Test Epoch0 layer3 Acc 0.25026315789473685, AUC 0.49778783321380615, avg_entr 1.46817147731781
Test Epoch0 layer4 Acc 0.25, AUC 0.5054014921188354, avg_entr 1.4683811664581299
gc 0
Train Epoch1 Acc 0.25515 (30618/120000), AUC 0.502835750579834
Test Epoch1 layer0 Acc 0.6734210526315789, AUC 0.8767644762992859, avg_entr 1.0495941638946533
Save ckpt to ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.4630263157894737, AUC 0.7397067546844482, avg_entr 1.1311192512512207
Test Epoch1 layer2 Acc 0.2523684210526316, AUC 0.5308276414871216, avg_entr 1.3495827913284302
Test Epoch1 layer3 Acc 0.2501315789473684, AUC 0.5094214081764221, avg_entr 1.3503869771957397
Test Epoch1 layer4 Acc 0.25, AUC 0.5138545036315918, avg_entr 1.3498389720916748
gc 0
Train Epoch2 Acc 0.2542833333333333 (30514/120000), AUC 0.5033525228500366
Test Epoch2 layer0 Acc 0.7910526315789473, AUC 0.9396997690200806, avg_entr 0.6277839541435242
Save ckpt to ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.7772368421052631, AUC 0.9347728490829468, avg_entr 0.5606183409690857
Test Epoch2 layer2 Acc 0.7693421052631579, AUC 0.9257451295852661, avg_entr 0.555543839931488
Test Epoch2 layer3 Acc 0.25, AUC 0.49979132413864136, avg_entr 1.1546924114227295
Test Epoch2 layer4 Acc 0.25, AUC 0.5054130554199219, avg_entr 1.1534572839736938
gc 0
Train Epoch3 Acc 0.503025 (60363/120000), AUC 0.7760463953018188
Test Epoch3 layer0 Acc 0.83, AUC 0.9555256962776184, avg_entr 0.37454456090927124
Save ckpt to ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.825921052631579, AUC 0.9542631506919861, avg_entr 0.3241290748119354
Test Epoch3 layer2 Acc 0.8221052631578948, AUC 0.9508424401283264, avg_entr 0.3226216733455658
Test Epoch3 layer3 Acc 0.8184210526315789, AUC 0.9452223777770996, avg_entr 0.32473236322402954
Test Epoch3 layer4 Acc 0.8214473684210526, AUC 0.9380079507827759, avg_entr 0.3236423134803772
gc 0
Train Epoch4 Acc 0.8538333333333333 (102460/120000), AUC 0.9501587748527527
Test Epoch4 layer0 Acc 0.8453947368421053, AUC 0.960570216178894, avg_entr 0.25324028730392456
Save ckpt to ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.85, AUC 0.9611305594444275, avg_entr 0.21530809998512268
Save ckpt to ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8498684210526316, AUC 0.9587204456329346, avg_entr 0.22063101828098297
Test Epoch4 layer3 Acc 0.8494736842105263, AUC 0.9574428200721741, avg_entr 0.22766537964344025
Test Epoch4 layer4 Acc 0.8488157894736842, AUC 0.9555394649505615, avg_entr 0.23440265655517578
gc 0
Train Epoch5 Acc 0.877175 (105261/120000), AUC 0.9634606838226318
Test Epoch5 layer0 Acc 0.8544736842105263, AUC 0.9643512964248657, avg_entr 0.1758148968219757
Save ckpt to ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.8577631578947369, AUC 0.9652748107910156, avg_entr 0.14963801205158234
Save ckpt to ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.859078947368421, AUC 0.9622186422348022, avg_entr 0.1433558166027069
Test Epoch5 layer3 Acc 0.8575, AUC 0.9565656781196594, avg_entr 0.14291149377822876
Test Epoch5 layer4 Acc 0.8569736842105263, AUC 0.9546019434928894, avg_entr 0.14078842103481293
gc 0
Train Epoch6 Acc 0.8903333333333333 (106840/120000), AUC 0.9686757326126099
Test Epoch6 layer0 Acc 0.8642105263157894, AUC 0.9664595723152161, avg_entr 0.13474322855472565
Save ckpt to ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.8667105263157895, AUC 0.9681589007377625, avg_entr 0.1134183406829834
Save ckpt to ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer2 Acc 0.8676315789473684, AUC 0.9668890833854675, avg_entr 0.11722525954246521
Test Epoch6 layer3 Acc 0.8668421052631579, AUC 0.9653974771499634, avg_entr 0.12259216606616974
Test Epoch6 layer4 Acc 0.8661842105263158, AUC 0.9645849466323853, avg_entr 0.12986718118190765
gc 0
Train Epoch7 Acc 0.9019333333333334 (108232/120000), AUC 0.9730204939842224
Test Epoch7 layer0 Acc 0.8668421052631579, AUC 0.9667513370513916, avg_entr 0.10339883714914322
Test Epoch7 layer1 Acc 0.8675, AUC 0.9694557189941406, avg_entr 0.08031579852104187
Save ckpt to ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer2 Acc 0.8678947368421053, AUC 0.9673876762390137, avg_entr 0.0784362256526947
Test Epoch7 layer3 Acc 0.8681578947368421, AUC 0.9657068252563477, avg_entr 0.07651273906230927
Test Epoch7 layer4 Acc 0.8681578947368421, AUC 0.9651422500610352, avg_entr 0.07587046921253204
gc 0
Train Epoch8 Acc 0.9117833333333333 (109414/120000), AUC 0.9762384295463562
Test Epoch8 layer0 Acc 0.8663157894736843, AUC 0.9674813747406006, avg_entr 0.07876118272542953
Test Epoch8 layer1 Acc 0.8668421052631579, AUC 0.9680187106132507, avg_entr 0.06428798288106918
Test Epoch8 layer2 Acc 0.8659210526315789, AUC 0.9668397903442383, avg_entr 0.06332742422819138
Test Epoch8 layer3 Acc 0.8657894736842106, AUC 0.9652057886123657, avg_entr 0.06021741032600403
Test Epoch8 layer4 Acc 0.8643421052631579, AUC 0.9631780385971069, avg_entr 0.060684219002723694
gc 0
Train Epoch9 Acc 0.9182 (110184/120000), AUC 0.9785328507423401
Test Epoch9 layer0 Acc 0.8725, AUC 0.9685803055763245, avg_entr 0.06066172569990158
Test Epoch9 layer1 Acc 0.8773684210526316, AUC 0.9707244634628296, avg_entr 0.05292563885450363
Save ckpt to ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer2 Acc 0.8772368421052632, AUC 0.9687324166297913, avg_entr 0.05696067586541176
Test Epoch9 layer3 Acc 0.8761842105263158, AUC 0.9670166969299316, avg_entr 0.06075306981801987
Test Epoch9 layer4 Acc 0.8727631578947368, AUC 0.9666807651519775, avg_entr 0.0635199025273323
gc 0
Train Epoch10 Acc 0.9248833333333333 (110986/120000), AUC 0.9801715016365051
Test Epoch10 layer0 Acc 0.8663157894736843, AUC 0.9685941338539124, avg_entr 0.053384929895401
Test Epoch10 layer1 Acc 0.8703947368421052, AUC 0.9686630964279175, avg_entr 0.042444296181201935
Test Epoch10 layer2 Acc 0.8714473684210526, AUC 0.9656547904014587, avg_entr 0.03938804194331169
Test Epoch10 layer3 Acc 0.8707894736842106, AUC 0.963186502456665, avg_entr 0.038239751011133194
Test Epoch10 layer4 Acc 0.8710526315789474, AUC 0.9625444412231445, avg_entr 0.03837504982948303
gc 0
Train Epoch11 Acc 0.9316916666666667 (111803/120000), AUC 0.9820848107337952
Test Epoch11 layer0 Acc 0.8738157894736842, AUC 0.9693770408630371, avg_entr 0.04191206395626068
Test Epoch11 layer1 Acc 0.8778947368421053, AUC 0.9701271057128906, avg_entr 0.03348000347614288
Test Epoch11 layer2 Acc 0.8776315789473684, AUC 0.9676440954208374, avg_entr 0.03535833582282066
Test Epoch11 layer3 Acc 0.8773684210526316, AUC 0.9664317965507507, avg_entr 0.0363004170358181
Test Epoch11 layer4 Acc 0.8771052631578947, AUC 0.9654598236083984, avg_entr 0.03614186495542526
gc 0
Train Epoch12 Acc 0.9355166666666667 (112262/120000), AUC 0.982658863067627
Test Epoch12 layer0 Acc 0.8718421052631579, AUC 0.968085765838623, avg_entr 0.036545850336551666
Test Epoch12 layer1 Acc 0.8761842105263158, AUC 0.9693266749382019, avg_entr 0.02995767816901207
Test Epoch12 layer2 Acc 0.8746052631578948, AUC 0.9683545827865601, avg_entr 0.028942599892616272
Test Epoch12 layer3 Acc 0.8739473684210526, AUC 0.9652537107467651, avg_entr 0.028083201497793198
Test Epoch12 layer4 Acc 0.8732894736842105, AUC 0.9644086956977844, avg_entr 0.02728930674493313
gc 0
Train Epoch13 Acc 0.940875 (112905/120000), AUC 0.9838954210281372
Test Epoch13 layer0 Acc 0.8719736842105263, AUC 0.9679262042045593, avg_entr 0.03241744637489319
Test Epoch13 layer1 Acc 0.8771052631578947, AUC 0.9681675434112549, avg_entr 0.025358861312270164
Test Epoch13 layer2 Acc 0.8773684210526316, AUC 0.9657273888587952, avg_entr 0.024566059932112694
Test Epoch13 layer3 Acc 0.8773684210526316, AUC 0.964054524898529, avg_entr 0.025047868490219116
Test Epoch13 layer4 Acc 0.8775, AUC 0.9623046517372131, avg_entr 0.025390606373548508
gc 0
Train Epoch14 Acc 0.9452666666666667 (113432/120000), AUC 0.9857653975486755
Test Epoch14 layer0 Acc 0.8719736842105263, AUC 0.9675673246383667, avg_entr 0.029456570744514465
Test Epoch14 layer1 Acc 0.8788157894736842, AUC 0.9701436758041382, avg_entr 0.02434373088181019
Test Epoch14 layer2 Acc 0.8789473684210526, AUC 0.9692624807357788, avg_entr 0.02324090339243412
Test Epoch14 layer3 Acc 0.8793421052631579, AUC 0.9689357280731201, avg_entr 0.023247290402650833
Test Epoch14 layer4 Acc 0.8781578947368421, AUC 0.969031572341919, avg_entr 0.0232890285551548
gc 0
Train Epoch15 Acc 0.94885 (113862/120000), AUC 0.9865972399711609
Test Epoch15 layer0 Acc 0.871578947368421, AUC 0.9671493172645569, avg_entr 0.026002924889326096
Test Epoch15 layer1 Acc 0.8757894736842106, AUC 0.9703198075294495, avg_entr 0.021131057292222977
Test Epoch15 layer2 Acc 0.8752631578947369, AUC 0.9695042371749878, avg_entr 0.01927747204899788
Test Epoch15 layer3 Acc 0.8752631578947369, AUC 0.9689100384712219, avg_entr 0.019220462068915367
Test Epoch15 layer4 Acc 0.875, AUC 0.9677696228027344, avg_entr 0.019011259078979492
gc 0
Train Epoch16 Acc 0.9542666666666667 (114512/120000), AUC 0.9877878427505493
Test Epoch16 layer0 Acc 0.8740789473684211, AUC 0.967228889465332, avg_entr 0.022678768262267113
Test Epoch16 layer1 Acc 0.8768421052631579, AUC 0.9698166847229004, avg_entr 0.017150714993476868
Test Epoch16 layer2 Acc 0.8759210526315789, AUC 0.9694092273712158, avg_entr 0.01799243688583374
Test Epoch16 layer3 Acc 0.8751315789473684, AUC 0.9694162607192993, avg_entr 0.01937989518046379
Test Epoch16 layer4 Acc 0.8753947368421052, AUC 0.9684712886810303, avg_entr 0.02014467865228653
gc 0
Train Epoch17 Acc 0.9562916666666667 (114755/120000), AUC 0.9881541728973389
Test Epoch17 layer0 Acc 0.8761842105263158, AUC 0.9668193459510803, avg_entr 0.02099786140024662
Test Epoch17 layer1 Acc 0.8817105263157895, AUC 0.9699123501777649, avg_entr 0.015354828909039497
Test Epoch17 layer2 Acc 0.8828947368421053, AUC 0.968532145023346, avg_entr 0.015182077884674072
Test Epoch17 layer3 Acc 0.8823684210526316, AUC 0.9682852029800415, avg_entr 0.015524500049650669
Test Epoch17 layer4 Acc 0.8822368421052632, AUC 0.9669444561004639, avg_entr 0.0156321432441473
gc 0
Train Epoch18 Acc 0.958825 (115059/120000), AUC 0.988551139831543
Test Epoch18 layer0 Acc 0.8702631578947368, AUC 0.9665746688842773, avg_entr 0.018251700326800346
Test Epoch18 layer1 Acc 0.8776315789473684, AUC 0.968693733215332, avg_entr 0.015057781711220741
Test Epoch18 layer2 Acc 0.8773684210526316, AUC 0.9671679735183716, avg_entr 0.015001300722360611
Test Epoch18 layer3 Acc 0.8775, AUC 0.9661194682121277, avg_entr 0.015724217519164085
Test Epoch18 layer4 Acc 0.8769736842105263, AUC 0.9657063484191895, avg_entr 0.016103914007544518
gc 0
Train Epoch19 Acc 0.9607166666666667 (115286/120000), AUC 0.9890327453613281
Test Epoch19 layer0 Acc 0.8740789473684211, AUC 0.9658833742141724, avg_entr 0.01756417192518711
Test Epoch19 layer1 Acc 0.8814473684210526, AUC 0.9687073230743408, avg_entr 0.01335547398775816
Test Epoch19 layer2 Acc 0.8813157894736842, AUC 0.9680960774421692, avg_entr 0.012640582397580147
Test Epoch19 layer3 Acc 0.8814473684210526, AUC 0.9681442975997925, avg_entr 0.012779200449585915
Test Epoch19 layer4 Acc 0.8814473684210526, AUC 0.9677338004112244, avg_entr 0.01281646452844143
gc 0
Train Epoch20 Acc 0.9634166666666667 (115610/120000), AUC 0.989784836769104
Test Epoch20 layer0 Acc 0.8753947368421052, AUC 0.966447114944458, avg_entr 0.015602190047502518
Test Epoch20 layer1 Acc 0.8813157894736842, AUC 0.9684786200523376, avg_entr 0.011672744527459145
Test Epoch20 layer2 Acc 0.8806578947368421, AUC 0.9676474928855896, avg_entr 0.010552455671131611
Test Epoch20 layer3 Acc 0.8805263157894737, AUC 0.9670761227607727, avg_entr 0.010340775363147259
Test Epoch20 layer4 Acc 0.8802631578947369, AUC 0.9666868448257446, avg_entr 0.010381286963820457
gc 0
Train Epoch21 Acc 0.9648083333333334 (115777/120000), AUC 0.9900603294372559
Test Epoch21 layer0 Acc 0.8723684210526316, AUC 0.9651957154273987, avg_entr 0.014354076236486435
Test Epoch21 layer1 Acc 0.8764473684210526, AUC 0.9663905501365662, avg_entr 0.01058318093419075
Test Epoch21 layer2 Acc 0.8768421052631579, AUC 0.9646447896957397, avg_entr 0.010059271939098835
Test Epoch21 layer3 Acc 0.8769736842105263, AUC 0.9650150537490845, avg_entr 0.010298402979969978
Test Epoch21 layer4 Acc 0.876578947368421, AUC 0.9650110006332397, avg_entr 0.010485927574336529
gc 0
Train Epoch22 Acc 0.9660083333333334 (115921/120000), AUC 0.9903337359428406
Test Epoch22 layer0 Acc 0.8740789473684211, AUC 0.9650554656982422, avg_entr 0.014692201279103756
Test Epoch22 layer1 Acc 0.8801315789473684, AUC 0.9667420387268066, avg_entr 0.010124950669705868
Test Epoch22 layer2 Acc 0.8801315789473684, AUC 0.9655077457427979, avg_entr 0.010147618129849434
Test Epoch22 layer3 Acc 0.88, AUC 0.9655301570892334, avg_entr 0.010390040464699268
Test Epoch22 layer4 Acc 0.8792105263157894, AUC 0.9649375081062317, avg_entr 0.010390606708824635
gc 0
Train Epoch23 Acc 0.9666166666666667 (115994/120000), AUC 0.9904286861419678
Test Epoch23 layer0 Acc 0.8735526315789474, AUC 0.9647985100746155, avg_entr 0.012501123361289501
Test Epoch23 layer1 Acc 0.8778947368421053, AUC 0.966867208480835, avg_entr 0.010017046704888344
Test Epoch23 layer2 Acc 0.8780263157894737, AUC 0.9662253260612488, avg_entr 0.009785241447389126
Test Epoch23 layer3 Acc 0.8778947368421053, AUC 0.9660970568656921, avg_entr 0.010014189407229424
Test Epoch23 layer4 Acc 0.8777631578947368, AUC 0.9661979675292969, avg_entr 0.010185308754444122
gc 0
Train Epoch24 Acc 0.9683166666666667 (116198/120000), AUC 0.9908377528190613
Test Epoch24 layer0 Acc 0.8747368421052631, AUC 0.9640436172485352, avg_entr 0.013135842978954315
Test Epoch24 layer1 Acc 0.8790789473684211, AUC 0.9664181470870972, avg_entr 0.008884362876415253
Test Epoch24 layer2 Acc 0.878421052631579, AUC 0.9652439951896667, avg_entr 0.008006010204553604
Test Epoch24 layer3 Acc 0.8782894736842105, AUC 0.9646449089050293, avg_entr 0.00791262648999691
Test Epoch24 layer4 Acc 0.8780263157894737, AUC 0.9646822214126587, avg_entr 0.007788198068737984
gc 0
Train Epoch25 Acc 0.9688416666666667 (116261/120000), AUC 0.9910051822662354
Test Epoch25 layer0 Acc 0.8744736842105263, AUC 0.9640058279037476, avg_entr 0.012294074520468712
Test Epoch25 layer1 Acc 0.8797368421052632, AUC 0.9655013084411621, avg_entr 0.009400484152138233
Test Epoch25 layer2 Acc 0.8793421052631579, AUC 0.9639716744422913, avg_entr 0.0083523103967309
Test Epoch25 layer3 Acc 0.8792105263157894, AUC 0.9639542698860168, avg_entr 0.008242828771471977
Test Epoch25 layer4 Acc 0.8790789473684211, AUC 0.9633162021636963, avg_entr 0.008182676509022713
gc 0
Train Epoch26 Acc 0.9692833333333334 (116314/120000), AUC 0.9910073280334473
Test Epoch26 layer0 Acc 0.8725, AUC 0.963325560092926, avg_entr 0.011594347655773163
Test Epoch26 layer1 Acc 0.8771052631578947, AUC 0.965303897857666, avg_entr 0.007546776439994574
Test Epoch26 layer2 Acc 0.8761842105263158, AUC 0.9634525179862976, avg_entr 0.007304344791918993
Test Epoch26 layer3 Acc 0.8761842105263158, AUC 0.9638376235961914, avg_entr 0.007041885983198881
Test Epoch26 layer4 Acc 0.8764473684210526, AUC 0.9637473821640015, avg_entr 0.006830665748566389
gc 0
Train Epoch27 Acc 0.9697416666666666 (116369/120000), AUC 0.9911983013153076
Test Epoch27 layer0 Acc 0.8707894736842106, AUC 0.9635528326034546, avg_entr 0.010345067828893661
Test Epoch27 layer1 Acc 0.8751315789473684, AUC 0.9648994207382202, avg_entr 0.007791589479893446
Test Epoch27 layer2 Acc 0.8744736842105263, AUC 0.9638830423355103, avg_entr 0.007293911185115576
Test Epoch27 layer3 Acc 0.8744736842105263, AUC 0.9634735584259033, avg_entr 0.007241653278470039
Test Epoch27 layer4 Acc 0.8740789473684211, AUC 0.9637597799301147, avg_entr 0.007136236410588026
gc 0
Train Epoch28 Acc 0.9703333333333334 (116440/120000), AUC 0.9914129972457886
Test Epoch28 layer0 Acc 0.871578947368421, AUC 0.9632582068443298, avg_entr 0.011044460348784924
Test Epoch28 layer1 Acc 0.876578947368421, AUC 0.9644304513931274, avg_entr 0.007318579126149416
Test Epoch28 layer2 Acc 0.8763157894736842, AUC 0.9628722667694092, avg_entr 0.007254255004227161
Test Epoch28 layer3 Acc 0.8760526315789474, AUC 0.9626402854919434, avg_entr 0.007217297796159983
Test Epoch28 layer4 Acc 0.8760526315789474, AUC 0.9629062414169312, avg_entr 0.006999703124165535
gc 0
Train Epoch29 Acc 0.9707 (116484/120000), AUC 0.9914857745170593
Test Epoch29 layer0 Acc 0.8710526315789474, AUC 0.9629596471786499, avg_entr 0.009946751408278942
Test Epoch29 layer1 Acc 0.8753947368421052, AUC 0.9633406400680542, avg_entr 0.007522439118474722
Test Epoch29 layer2 Acc 0.8748684210526316, AUC 0.9619056582450867, avg_entr 0.0068532139994204044
Test Epoch29 layer3 Acc 0.8748684210526316, AUC 0.9618026614189148, avg_entr 0.0068654525093734264
Test Epoch29 layer4 Acc 0.8747368421052631, AUC 0.9618360996246338, avg_entr 0.006788419559597969
gc 0
Train Epoch30 Acc 0.9709916666666667 (116519/120000), AUC 0.9915040731430054
Test Epoch30 layer0 Acc 0.8721052631578947, AUC 0.9627103805541992, avg_entr 0.009768566116690636
Test Epoch30 layer1 Acc 0.875, AUC 0.9629951119422913, avg_entr 0.007653486914932728
Test Epoch30 layer2 Acc 0.8744736842105263, AUC 0.9619285464286804, avg_entr 0.007088697515428066
Test Epoch30 layer3 Acc 0.8744736842105263, AUC 0.9612915515899658, avg_entr 0.006975454743951559
Test Epoch30 layer4 Acc 0.8744736842105263, AUC 0.961200475692749, avg_entr 0.006801965646445751
gc 0
Train Epoch31 Acc 0.9712833333333334 (116554/120000), AUC 0.9915310144424438
Test Epoch31 layer0 Acc 0.8706578947368421, AUC 0.9623668193817139, avg_entr 0.010303802788257599
Test Epoch31 layer1 Acc 0.8760526315789474, AUC 0.962678849697113, avg_entr 0.007594916503876448
Test Epoch31 layer2 Acc 0.8757894736842106, AUC 0.9613428115844727, avg_entr 0.007191637996584177
Test Epoch31 layer3 Acc 0.8756578947368421, AUC 0.960979700088501, avg_entr 0.007015177980065346
Test Epoch31 layer4 Acc 0.8757894736842106, AUC 0.9613187909126282, avg_entr 0.006670809350907803
gc 0
Train Epoch32 Acc 0.971425 (116571/120000), AUC 0.9916144609451294
Test Epoch32 layer0 Acc 0.8702631578947368, AUC 0.9621938467025757, avg_entr 0.009558983147144318
Test Epoch32 layer1 Acc 0.8748684210526316, AUC 0.9626498818397522, avg_entr 0.007378885056823492
Test Epoch32 layer2 Acc 0.8752631578947369, AUC 0.961253821849823, avg_entr 0.006837471388280392
Test Epoch32 layer3 Acc 0.8751315789473684, AUC 0.9616947770118713, avg_entr 0.006704636849462986
Test Epoch32 layer4 Acc 0.8748684210526316, AUC 0.9618067741394043, avg_entr 0.00651773065328598
gc 0
Train Epoch33 Acc 0.97175 (116610/120000), AUC 0.9916754961013794
Test Epoch33 layer0 Acc 0.8702631578947368, AUC 0.9621618986129761, avg_entr 0.009130836464464664
Test Epoch33 layer1 Acc 0.8740789473684211, AUC 0.962814450263977, avg_entr 0.007550109177827835
Test Epoch33 layer2 Acc 0.8742105263157894, AUC 0.9613583087921143, avg_entr 0.0070794872008264065
Test Epoch33 layer3 Acc 0.8738157894736842, AUC 0.9615693092346191, avg_entr 0.0070966798812150955
Test Epoch33 layer4 Acc 0.8738157894736842, AUC 0.9617068767547607, avg_entr 0.006881543900817633
gc 0
Train Epoch34 Acc 0.971975 (116637/120000), AUC 0.9916869401931763
Test Epoch34 layer0 Acc 0.8689473684210526, AUC 0.9619991779327393, avg_entr 0.009103886783123016
Test Epoch34 layer1 Acc 0.8742105263157894, AUC 0.9622011184692383, avg_entr 0.006980487611144781
Test Epoch34 layer2 Acc 0.8735526315789474, AUC 0.9613258242607117, avg_entr 0.00600511534139514
Test Epoch34 layer3 Acc 0.8736842105263158, AUC 0.9615713357925415, avg_entr 0.005910705775022507
Test Epoch34 layer4 Acc 0.873421052631579, AUC 0.9615782499313354, avg_entr 0.00567990355193615
gc 0
Train Epoch35 Acc 0.972025 (116643/120000), AUC 0.9917680621147156
Test Epoch35 layer0 Acc 0.8698684210526316, AUC 0.9616295099258423, avg_entr 0.0087954793125391
Test Epoch35 layer1 Acc 0.8743421052631579, AUC 0.9619061350822449, avg_entr 0.007022663950920105
Test Epoch35 layer2 Acc 0.8747368421052631, AUC 0.9609057903289795, avg_entr 0.006508026272058487
Test Epoch35 layer3 Acc 0.8747368421052631, AUC 0.9612935781478882, avg_entr 0.006607063580304384
Test Epoch35 layer4 Acc 0.8746052631578948, AUC 0.9612860679626465, avg_entr 0.0063169109635055065
gc 0
Train Epoch36 Acc 0.9722833333333334 (116674/120000), AUC 0.9917831420898438
Test Epoch36 layer0 Acc 0.8694736842105263, AUC 0.961539626121521, avg_entr 0.00906840804964304
Test Epoch36 layer1 Acc 0.8744736842105263, AUC 0.9612634181976318, avg_entr 0.007136489264667034
Test Epoch36 layer2 Acc 0.8743421052631579, AUC 0.9601567387580872, avg_entr 0.006656027864664793
Test Epoch36 layer3 Acc 0.8738157894736842, AUC 0.9604898691177368, avg_entr 0.00625737477093935
Test Epoch36 layer4 Acc 0.8736842105263158, AUC 0.9608081579208374, avg_entr 0.005924648605287075
gc 0
Train Epoch37 Acc 0.9723083333333333 (116677/120000), AUC 0.9917570352554321
Test Epoch37 layer0 Acc 0.8696052631578948, AUC 0.9615030288696289, avg_entr 0.008870765566825867
Test Epoch37 layer1 Acc 0.8743421052631579, AUC 0.9611480832099915, avg_entr 0.006974776275455952
Test Epoch37 layer2 Acc 0.8738157894736842, AUC 0.9599683284759521, avg_entr 0.006156780291348696
Test Epoch37 layer3 Acc 0.8736842105263158, AUC 0.9604619145393372, avg_entr 0.006160496734082699
Test Epoch37 layer4 Acc 0.8735526315789474, AUC 0.9607226252555847, avg_entr 0.006020319182425737
gc 0
Train Epoch38 Acc 0.9724083333333333 (116689/120000), AUC 0.9917025566101074
Test Epoch38 layer0 Acc 0.8697368421052631, AUC 0.9613045454025269, avg_entr 0.008674930781126022
Test Epoch38 layer1 Acc 0.8739473684210526, AUC 0.9610047340393066, avg_entr 0.006954715121537447
Test Epoch38 layer2 Acc 0.8743421052631579, AUC 0.959740400314331, avg_entr 0.006096771452575922
Test Epoch38 layer3 Acc 0.8743421052631579, AUC 0.9602752923965454, avg_entr 0.005941662937402725
Test Epoch38 layer4 Acc 0.8743421052631579, AUC 0.9603509902954102, avg_entr 0.005683403927832842
gc 0
Train Epoch39 Acc 0.9724166666666667 (116690/120000), AUC 0.9917615056037903
Test Epoch39 layer0 Acc 0.8696052631578948, AUC 0.961249589920044, avg_entr 0.008756921626627445
Test Epoch39 layer1 Acc 0.8736842105263158, AUC 0.9606592059135437, avg_entr 0.00697204889729619
Test Epoch39 layer2 Acc 0.8739473684210526, AUC 0.9591615200042725, avg_entr 0.006302051246166229
Test Epoch39 layer3 Acc 0.8735526315789474, AUC 0.9595632553100586, avg_entr 0.0062584527768194675
Test Epoch39 layer4 Acc 0.8738157894736842, AUC 0.9600098133087158, avg_entr 0.0060470569878816605
gc 0
Train Epoch40 Acc 0.972475 (116697/120000), AUC 0.9917133450508118
Test Epoch40 layer0 Acc 0.8692105263157894, AUC 0.9612021446228027, avg_entr 0.008663090877234936
Test Epoch40 layer1 Acc 0.8739473684210526, AUC 0.9600954055786133, avg_entr 0.006640946958214045
Test Epoch40 layer2 Acc 0.8732894736842105, AUC 0.9588378071784973, avg_entr 0.006212515290826559
Test Epoch40 layer3 Acc 0.8730263157894737, AUC 0.9588432908058167, avg_entr 0.006087633781135082
Test Epoch40 layer4 Acc 0.8730263157894737, AUC 0.9593284130096436, avg_entr 0.005843982566148043
gc 0
Train Epoch41 Acc 0.9726083333333333 (116713/120000), AUC 0.9916848540306091
Test Epoch41 layer0 Acc 0.8689473684210526, AUC 0.9612494111061096, avg_entr 0.00853298231959343
Test Epoch41 layer1 Acc 0.873421052631579, AUC 0.9600955247879028, avg_entr 0.006688056513667107
Test Epoch41 layer2 Acc 0.8730263157894737, AUC 0.9589194059371948, avg_entr 0.006225534714758396
Test Epoch41 layer3 Acc 0.8730263157894737, AUC 0.9592610597610474, avg_entr 0.006419088691473007
Test Epoch41 layer4 Acc 0.8731578947368421, AUC 0.9594981074333191, avg_entr 0.006272219121456146
gc 0
Train Epoch42 Acc 0.9726166666666667 (116714/120000), AUC 0.9916573762893677
Test Epoch42 layer0 Acc 0.8690789473684211, AUC 0.9612460136413574, avg_entr 0.008362187072634697
Test Epoch42 layer1 Acc 0.873421052631579, AUC 0.9599611759185791, avg_entr 0.006662548985332251
Test Epoch42 layer2 Acc 0.8739473684210526, AUC 0.9588898420333862, avg_entr 0.006050238851457834
Test Epoch42 layer3 Acc 0.8735526315789474, AUC 0.9592885971069336, avg_entr 0.006193923763930798
Test Epoch42 layer4 Acc 0.8735526315789474, AUC 0.9596443176269531, avg_entr 0.0060636200942099094
gc 0
Train Epoch43 Acc 0.97265 (116718/120000), AUC 0.9917444586753845
Test Epoch43 layer0 Acc 0.8693421052631579, AUC 0.9611274003982544, avg_entr 0.008215751498937607
Test Epoch43 layer1 Acc 0.8735526315789474, AUC 0.9601467251777649, avg_entr 0.006874311715364456
Test Epoch43 layer2 Acc 0.8732894736842105, AUC 0.9589996337890625, avg_entr 0.006186129059642553
Test Epoch43 layer3 Acc 0.8735526315789474, AUC 0.9591612815856934, avg_entr 0.006431777495890856
Test Epoch43 layer4 Acc 0.8735526315789474, AUC 0.9594910740852356, avg_entr 0.0063231876119971275
gc 0
Train Epoch44 Acc 0.9726916666666666 (116723/120000), AUC 0.9916894435882568
Test Epoch44 layer0 Acc 0.8692105263157894, AUC 0.9610967636108398, avg_entr 0.008413773961365223
Test Epoch44 layer1 Acc 0.8736842105263158, AUC 0.9599596858024597, avg_entr 0.0065210615284740925
Test Epoch44 layer2 Acc 0.8728947368421053, AUC 0.9588503837585449, avg_entr 0.006031378637999296
Test Epoch44 layer3 Acc 0.8730263157894737, AUC 0.9589693546295166, avg_entr 0.0060969688929617405
Test Epoch44 layer4 Acc 0.8730263157894737, AUC 0.9592492580413818, avg_entr 0.005950577091425657
gc 0
Train Epoch45 Acc 0.9726833333333333 (116722/120000), AUC 0.9917092323303223
Test Epoch45 layer0 Acc 0.8689473684210526, AUC 0.9610520601272583, avg_entr 0.00841022003442049
Test Epoch45 layer1 Acc 0.8736842105263158, AUC 0.9599206447601318, avg_entr 0.006981766317039728
Test Epoch45 layer2 Acc 0.8735526315789474, AUC 0.9587801098823547, avg_entr 0.006336216349154711
Test Epoch45 layer3 Acc 0.8738157894736842, AUC 0.9588892459869385, avg_entr 0.00629242742434144
Test Epoch45 layer4 Acc 0.8735526315789474, AUC 0.9592234492301941, avg_entr 0.00611454900354147
gc 0
Train Epoch46 Acc 0.9727666666666667 (116732/120000), AUC 0.9916986227035522
Test Epoch46 layer0 Acc 0.8693421052631579, AUC 0.9610555171966553, avg_entr 0.008426300249993801
Test Epoch46 layer1 Acc 0.873421052631579, AUC 0.9598451852798462, avg_entr 0.0064400010742247105
Test Epoch46 layer2 Acc 0.8730263157894737, AUC 0.9586697816848755, avg_entr 0.00595384556800127
Test Epoch46 layer3 Acc 0.8732894736842105, AUC 0.9587692618370056, avg_entr 0.005991026759147644
Test Epoch46 layer4 Acc 0.8730263157894737, AUC 0.9591520428657532, avg_entr 0.0058446056209504604
gc 0
Train Epoch47 Acc 0.97275 (116730/120000), AUC 0.9916725754737854
Test Epoch47 layer0 Acc 0.8686842105263158, AUC 0.9609508514404297, avg_entr 0.008338374085724354
Test Epoch47 layer1 Acc 0.8732894736842105, AUC 0.9596315622329712, avg_entr 0.006851627957075834
Test Epoch47 layer2 Acc 0.8731578947368421, AUC 0.9584610462188721, avg_entr 0.006413594353944063
Test Epoch47 layer3 Acc 0.8730263157894737, AUC 0.9586101174354553, avg_entr 0.00626733573153615
Test Epoch47 layer4 Acc 0.8728947368421053, AUC 0.9589834213256836, avg_entr 0.006033353973180056
gc 0
Train Epoch48 Acc 0.9728083333333334 (116737/120000), AUC 0.9916690587997437
Test Epoch48 layer0 Acc 0.8696052631578948, AUC 0.9609457850456238, avg_entr 0.0083084087818861
Test Epoch48 layer1 Acc 0.8732894736842105, AUC 0.9597863554954529, avg_entr 0.006587297189980745
Test Epoch48 layer2 Acc 0.8735526315789474, AUC 0.9585604667663574, avg_entr 0.005958544090390205
Test Epoch48 layer3 Acc 0.873421052631579, AUC 0.9586723446846008, avg_entr 0.006077466066926718
Test Epoch48 layer4 Acc 0.873421052631579, AUC 0.9590333104133606, avg_entr 0.005922890268266201
gc 0
Train Epoch49 Acc 0.972775 (116733/120000), AUC 0.9916778802871704
Test Epoch49 layer0 Acc 0.8686842105263158, AUC 0.9609013199806213, avg_entr 0.00828596018254757
Test Epoch49 layer1 Acc 0.8732894736842105, AUC 0.9596506357192993, avg_entr 0.006891884841024876
Test Epoch49 layer2 Acc 0.873421052631579, AUC 0.9585172533988953, avg_entr 0.006261488422751427
Test Epoch49 layer3 Acc 0.8732894736842105, AUC 0.9586426615715027, avg_entr 0.0062600853852927685
Test Epoch49 layer4 Acc 0.8730263157894737, AUC 0.9589616656303406, avg_entr 0.0060580093413591385
Best AUC 0.9707244634628296
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmalside_l5_side100//ag_news_lstmalside_l5_side.pt
[[1626   84   91   99]
 [  26 1799   34   41]
 [  79   35 1550  236]
 [  63   44  137 1656]]
Figure(640x480)
tensor([0.0266, 0.3838, 0.0152,  ..., 0.0100, 0.4630, 0.4308])
[[1612   95   83  110]
 [  17 1824   25   34]
 [  82   34 1550  234]
 [  54   42  122 1682]]
Figure(640x480)
tensor([0.0155, 0.0376, 0.0177,  ..., 0.0098, 0.0889, 0.4530])
[[1606  103   84  107]
 [  15 1825   26   34]
 [  78   36 1558  228]
 [  50   44  128 1678]]
Figure(640x480)
tensor([0.0124, 0.0367, 0.0143,  ..., 0.0103, 0.1012, 0.4778])
[[1592  111   86  111]
 [  12 1828   28   32]
 [  74   36 1567  223]
 [  46   46  136 1672]]
Figure(640x480)
tensor([0.0109, 0.0346, 0.0135,  ..., 0.0099, 0.0990, 0.4538])
[[1562  131   85  122]
 [  12 1828   28   32]
 [  69   39 1565  227]
 [  42   48  132 1678]]
Figure(640x480)
tensor([0.0111, 0.0314, 0.0128,  ..., 0.0094, 0.1136, 0.5080])
