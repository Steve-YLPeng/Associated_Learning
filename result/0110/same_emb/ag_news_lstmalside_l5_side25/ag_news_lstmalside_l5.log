total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList()
  (emb): Embedding(30000, 300)
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb.weight 9000000
Total Trainable Params: 12937892
Start Training
gc 0
Train Epoch0 Acc 0.27579166666666666 (33095/120000), AUC 0.5097243189811707
Test Epoch0 layer0 Acc 0.3882894736842105, AUC 0.6504002809524536, avg_entr 1.4626903533935547
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.4, AUC 0.6555169820785522, avg_entr 1.4619958400726318
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.33907894736842104, AUC 0.6087781190872192, avg_entr 1.4656065702438354
Test Epoch0 layer3 Acc 0.3451315789473684, AUC 0.6071929335594177, avg_entr 1.4647914171218872
Test Epoch0 layer4 Acc 0.305, AUC 0.575944185256958, avg_entr 1.4657214879989624
gc 0
Train Epoch1 Acc 0.369175 (44301/120000), AUC 0.6163808107376099
Test Epoch1 layer0 Acc 0.5756578947368421, AUC 0.8036999106407166, avg_entr 1.1483302116394043
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.605, AUC 0.8401241302490234, avg_entr 1.077903389930725
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.6042105263157894, AUC 0.8401942253112793, avg_entr 1.0572381019592285
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer3 Acc 0.5972368421052632, AUC 0.8379625678062439, avg_entr 1.0835022926330566
Test Epoch1 layer4 Acc 0.5428947368421052, AUC 0.7992488741874695, avg_entr 1.1226879358291626
gc 0
Train Epoch2 Acc 0.663775 (79653/120000), AUC 0.865251362323761
Test Epoch2 layer0 Acc 0.6811842105263158, AUC 0.8786099553108215, avg_entr 0.8038696646690369
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.7005263157894737, AUC 0.8993881940841675, avg_entr 0.7210844159126282
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.7026315789473684, AUC 0.9039875268936157, avg_entr 0.6663549542427063
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer3 Acc 0.7011842105263157, AUC 0.9054034948348999, avg_entr 0.6493903994560242
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer4 Acc 0.6961842105263157, AUC 0.901144802570343, avg_entr 0.6245132088661194
gc 0
Train Epoch3 Acc 0.75345 (90414/120000), AUC 0.9191001653671265
Test Epoch3 layer0 Acc 0.7289473684210527, AUC 0.9072417616844177, avg_entr 0.5965227484703064
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.7486842105263158, AUC 0.9222685694694519, avg_entr 0.4787505865097046
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.7573684210526316, AUC 0.9271607398986816, avg_entr 0.4186150133609772
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer3 Acc 0.7617105263157895, AUC 0.9305000305175781, avg_entr 0.4029664099216461
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer4 Acc 0.7613157894736842, AUC 0.9275107383728027, avg_entr 0.38311275839805603
gc 0
Train Epoch4 Acc 0.7966833333333333 (95602/120000), AUC 0.9407902359962463
Test Epoch4 layer0 Acc 0.7509210526315789, AUC 0.9195932149887085, avg_entr 0.4705045819282532
Test Epoch4 layer1 Acc 0.7636842105263157, AUC 0.9325178861618042, avg_entr 0.34344181418418884
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.7627631578947368, AUC 0.9369672536849976, avg_entr 0.2973816990852356
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer3 Acc 0.7638157894736842, AUC 0.9383821487426758, avg_entr 0.2782677710056305
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer4 Acc 0.7642105263157895, AUC 0.9355123043060303, avg_entr 0.26192912459373474
gc 0
Train Epoch5 Acc 0.822 (98640/120000), AUC 0.9518885612487793
Test Epoch5 layer0 Acc 0.7732894736842105, AUC 0.9272927045822144, avg_entr 0.38507139682769775
Test Epoch5 layer1 Acc 0.7856578947368421, AUC 0.9405563473701477, avg_entr 0.2566660940647125
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.7960526315789473, AUC 0.945513904094696, avg_entr 0.22210712730884552
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer3 Acc 0.8011842105263158, AUC 0.9487737417221069, avg_entr 0.20738442242145538
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer4 Acc 0.8007894736842105, AUC 0.9469603896141052, avg_entr 0.19291314482688904
gc 0
Train Epoch6 Acc 0.8426583333333333 (101119/120000), AUC 0.9600174427032471
Test Epoch6 layer0 Acc 0.7817105263157895, AUC 0.9311631321907043, avg_entr 0.32155731320381165
Test Epoch6 layer1 Acc 0.8025, AUC 0.945642352104187, avg_entr 0.19495712220668793
Test Epoch6 layer2 Acc 0.8106578947368421, AUC 0.9503012299537659, avg_entr 0.16727301478385925
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer3 Acc 0.8163157894736842, AUC 0.9531205892562866, avg_entr 0.15252052247524261
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer4 Acc 0.814078947368421, AUC 0.9510478377342224, avg_entr 0.13937446475028992
gc 0
Train Epoch7 Acc 0.8567416666666666 (102809/120000), AUC 0.964819073677063
Test Epoch7 layer0 Acc 0.7881578947368421, AUC 0.9349209666252136, avg_entr 0.2748616635799408
Test Epoch7 layer1 Acc 0.8028947368421052, AUC 0.9477291703224182, avg_entr 0.15159733593463898
Test Epoch7 layer2 Acc 0.8096052631578947, AUC 0.9517621994018555, avg_entr 0.12942616641521454
Test Epoch7 layer3 Acc 0.8103947368421053, AUC 0.9542945027351379, avg_entr 0.12226324528455734
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer4 Acc 0.8063157894736842, AUC 0.9511234760284424, avg_entr 0.11427567899227142
gc 0
Train Epoch8 Acc 0.8698166666666667 (104378/120000), AUC 0.9695699214935303
Test Epoch8 layer0 Acc 0.7944736842105263, AUC 0.9383189678192139, avg_entr 0.24058930575847626
Test Epoch8 layer1 Acc 0.8123684210526316, AUC 0.9507185220718384, avg_entr 0.12743528187274933
Test Epoch8 layer2 Acc 0.8196052631578947, AUC 0.9547958970069885, avg_entr 0.11037430912256241
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer3 Acc 0.8252631578947368, AUC 0.9577341079711914, avg_entr 0.09980184584856033
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer4 Acc 0.8246052631578947, AUC 0.955866813659668, avg_entr 0.0927068442106247
gc 0
Train Epoch9 Acc 0.8785333333333334 (105424/120000), AUC 0.9720706939697266
Test Epoch9 layer0 Acc 0.7985526315789474, AUC 0.9400931596755981, avg_entr 0.21079720556735992
Test Epoch9 layer1 Acc 0.8228947368421052, AUC 0.952759861946106, avg_entr 0.10227807611227036
Test Epoch9 layer2 Acc 0.8293421052631579, AUC 0.9574979543685913, avg_entr 0.08342687040567398
Test Epoch9 layer3 Acc 0.8355263157894737, AUC 0.9593900442123413, avg_entr 0.0775008425116539
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer4 Acc 0.8365789473684211, AUC 0.9559791088104248, avg_entr 0.07243101298809052
gc 0
Train Epoch10 Acc 0.8885583333333333 (106627/120000), AUC 0.975308358669281
Test Epoch10 layer0 Acc 0.7994736842105263, AUC 0.9413453340530396, avg_entr 0.18947342038154602
Test Epoch10 layer1 Acc 0.8197368421052632, AUC 0.9523372650146484, avg_entr 0.09019789099693298
Test Epoch10 layer2 Acc 0.828421052631579, AUC 0.9559552669525146, avg_entr 0.07712523639202118
Test Epoch10 layer3 Acc 0.8348684210526316, AUC 0.9588660001754761, avg_entr 0.07202579081058502
Test Epoch10 layer4 Acc 0.8372368421052632, AUC 0.954940676689148, avg_entr 0.06547732651233673
gc 0
Train Epoch11 Acc 0.894225 (107307/120000), AUC 0.9771414995193481
Test Epoch11 layer0 Acc 0.8068421052631579, AUC 0.9433968663215637, avg_entr 0.1695551872253418
Test Epoch11 layer1 Acc 0.8288157894736842, AUC 0.9554314613342285, avg_entr 0.07581162452697754
Test Epoch11 layer2 Acc 0.8392105263157895, AUC 0.9603402614593506, avg_entr 0.061264768242836
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer3 Acc 0.8452631578947368, AUC 0.9617758989334106, avg_entr 0.05621173977851868
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer4 Acc 0.8435526315789473, AUC 0.9572281837463379, avg_entr 0.05269550159573555
gc 0
Train Epoch12 Acc 0.9005166666666666 (108062/120000), AUC 0.9786967635154724
Test Epoch12 layer0 Acc 0.8110526315789474, AUC 0.9443328380584717, avg_entr 0.15637226402759552
Test Epoch12 layer1 Acc 0.8327631578947369, AUC 0.9561529159545898, avg_entr 0.07324287295341492
Test Epoch12 layer2 Acc 0.8428947368421053, AUC 0.9607470035552979, avg_entr 0.06026304513216019
Test Epoch12 layer3 Acc 0.8475, AUC 0.9636766910552979, avg_entr 0.05823061987757683
Save ckpt to ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt  ,ep 12
Test Epoch12 layer4 Acc 0.8493421052631579, AUC 0.9607231020927429, avg_entr 0.05624059960246086
gc 0
Train Epoch13 Acc 0.9023666666666667 (108284/120000), AUC 0.9784122705459595
Test Epoch13 layer0 Acc 0.8132894736842106, AUC 0.944745659828186, avg_entr 0.14122025668621063
Test Epoch13 layer1 Acc 0.8325, AUC 0.9567203521728516, avg_entr 0.06185091659426689
Test Epoch13 layer2 Acc 0.8442105263157895, AUC 0.9615160226821899, avg_entr 0.05178719758987427
Test Epoch13 layer3 Acc 0.848421052631579, AUC 0.9617379307746887, avg_entr 0.05118574947118759
Test Epoch13 layer4 Acc 0.8438157894736842, AUC 0.957082986831665, avg_entr 0.05208811163902283
gc 0
Train Epoch14 Acc 0.906225 (108747/120000), AUC 0.9795546531677246
Test Epoch14 layer0 Acc 0.8148684210526316, AUC 0.9456758499145508, avg_entr 0.13174569606781006
Test Epoch14 layer1 Acc 0.8343421052631579, AUC 0.9568146467208862, avg_entr 0.05263793095946312
Test Epoch14 layer2 Acc 0.8432894736842105, AUC 0.9612802267074585, avg_entr 0.04312729462981224
Test Epoch14 layer3 Acc 0.8471052631578947, AUC 0.959426999092102, avg_entr 0.04527865722775459
Test Epoch14 layer4 Acc 0.8427631578947369, AUC 0.953429102897644, avg_entr 0.047577276825904846
gc 0
Train Epoch15 Acc 0.9098833333333334 (109186/120000), AUC 0.9806135892868042
Test Epoch15 layer0 Acc 0.8134210526315789, AUC 0.9461695551872253, avg_entr 0.12264124304056168
Test Epoch15 layer1 Acc 0.8344736842105264, AUC 0.9558080434799194, avg_entr 0.05366076901555061
Test Epoch15 layer2 Acc 0.8453947368421053, AUC 0.9604167938232422, avg_entr 0.044699281454086304
Test Epoch15 layer3 Acc 0.8511842105263158, AUC 0.9603424668312073, avg_entr 0.047842543572187424
Test Epoch15 layer4 Acc 0.8467105263157895, AUC 0.9558045268058777, avg_entr 0.050914693623781204
gc 0
Train Epoch16 Acc 0.9099583333333333 (109195/120000), AUC 0.980863630771637
Test Epoch16 layer0 Acc 0.8142105263157895, AUC 0.94732666015625, avg_entr 0.11540328711271286
Test Epoch16 layer1 Acc 0.8348684210526316, AUC 0.9565973281860352, avg_entr 0.04940146580338478
Test Epoch16 layer2 Acc 0.8460526315789474, AUC 0.9617956876754761, avg_entr 0.03802445903420448
Test Epoch16 layer3 Acc 0.85, AUC 0.9590437412261963, avg_entr 0.04503811150789261
Test Epoch16 layer4 Acc 0.8455263157894737, AUC 0.9532103538513184, avg_entr 0.04792232811450958
gc 0
Train Epoch17 Acc 0.9123916666666667 (109487/120000), AUC 0.9823198318481445
Test Epoch17 layer0 Acc 0.8172368421052632, AUC 0.947441041469574, avg_entr 0.1063990592956543
Test Epoch17 layer1 Acc 0.8313157894736842, AUC 0.9558829069137573, avg_entr 0.043609023094177246
Test Epoch17 layer2 Acc 0.84, AUC 0.9612537622451782, avg_entr 0.03375772014260292
Test Epoch17 layer3 Acc 0.8473684210526315, AUC 0.9560014009475708, avg_entr 0.04759398475289345
Test Epoch17 layer4 Acc 0.8410526315789474, AUC 0.9495726823806763, avg_entr 0.05368991568684578
gc 0
Train Epoch18 Acc 0.91175 (109410/120000), AUC 0.983135998249054
Test Epoch18 layer0 Acc 0.8201315789473684, AUC 0.9477759003639221, avg_entr 0.10149940103292465
Test Epoch18 layer1 Acc 0.8293421052631579, AUC 0.9537948369979858, avg_entr 0.046232372522354126
Test Epoch18 layer2 Acc 0.8409210526315789, AUC 0.9595376253128052, avg_entr 0.03504924476146698
Test Epoch18 layer3 Acc 0.8438157894736842, AUC 0.9544196724891663, avg_entr 0.058860864490270615
Test Epoch18 layer4 Acc 0.8289473684210527, AUC 0.9486702680587769, avg_entr 0.06503468006849289
gc 0
Train Epoch19 Acc 0.9092333333333333 (109108/120000), AUC 0.9825751781463623
Test Epoch19 layer0 Acc 0.819078947368421, AUC 0.9475595951080322, avg_entr 0.09597122669219971
Test Epoch19 layer1 Acc 0.8242105263157895, AUC 0.95085209608078, avg_entr 0.04715029150247574
Test Epoch19 layer2 Acc 0.8389473684210527, AUC 0.9582715630531311, avg_entr 0.037695735692977905
Test Epoch19 layer3 Acc 0.8394736842105263, AUC 0.9545481204986572, avg_entr 0.05533862113952637
Test Epoch19 layer4 Acc 0.8269736842105263, AUC 0.9501069784164429, avg_entr 0.0566558875143528
gc 0
Train Epoch20 Acc 0.90685 (108822/120000), AUC 0.9828239679336548
Test Epoch20 layer0 Acc 0.8225, AUC 0.9479882121086121, avg_entr 0.0907367542386055
Test Epoch20 layer1 Acc 0.8264473684210526, AUC 0.9518281817436218, avg_entr 0.04337304085493088
Test Epoch20 layer2 Acc 0.8371052631578947, AUC 0.9578858613967896, avg_entr 0.029503468424081802
Test Epoch20 layer3 Acc 0.8388157894736842, AUC 0.9505994319915771, avg_entr 0.05505227670073509
Test Epoch20 layer4 Acc 0.8247368421052632, AUC 0.9458649158477783, avg_entr 0.06190810352563858
gc 0
Train Epoch21 Acc 0.9066833333333333 (108802/120000), AUC 0.9834998846054077
Test Epoch21 layer0 Acc 0.8226315789473684, AUC 0.9480345249176025, avg_entr 0.08348610252141953
Test Epoch21 layer1 Acc 0.8252631578947368, AUC 0.9502010941505432, avg_entr 0.040459226816892624
Test Epoch21 layer2 Acc 0.8359210526315789, AUC 0.9558776021003723, avg_entr 0.030525507405400276
Test Epoch21 layer3 Acc 0.8352631578947368, AUC 0.9491851329803467, avg_entr 0.04704022780060768
Test Epoch21 layer4 Acc 0.8180263157894737, AUC 0.9463242292404175, avg_entr 0.051671866327524185
gc 0
Train Epoch22 Acc 0.9112416666666666 (109349/120000), AUC 0.9844329357147217
Test Epoch22 layer0 Acc 0.8169736842105263, AUC 0.9479901790618896, avg_entr 0.07950636744499207
Test Epoch22 layer1 Acc 0.8213157894736842, AUC 0.9490487575531006, avg_entr 0.039489008486270905
Test Epoch22 layer2 Acc 0.8347368421052631, AUC 0.9547984600067139, avg_entr 0.029028935357928276
Test Epoch22 layer3 Acc 0.8371052631578947, AUC 0.9472793340682983, avg_entr 0.048028308898210526
Test Epoch22 layer4 Acc 0.8188157894736842, AUC 0.9424183964729309, avg_entr 0.0530928298830986
gc 0
Train Epoch23 Acc 0.9091083333333333 (109093/120000), AUC 0.9841729998588562
Test Epoch23 layer0 Acc 0.8203947368421053, AUC 0.9480066299438477, avg_entr 0.0779365599155426
Test Epoch23 layer1 Acc 0.815, AUC 0.9456626176834106, avg_entr 0.03995417803525925
Test Epoch23 layer2 Acc 0.8278947368421052, AUC 0.9537162184715271, avg_entr 0.02790224552154541
Test Epoch23 layer3 Acc 0.8351315789473684, AUC 0.9471260905265808, avg_entr 0.05297507718205452
Test Epoch23 layer4 Acc 0.8177631578947369, AUC 0.9424301385879517, avg_entr 0.06113076210021973
gc 0
Train Epoch24 Acc 0.907975 (108957/120000), AUC 0.9844122529029846
Test Epoch24 layer0 Acc 0.815921052631579, AUC 0.9483232498168945, avg_entr 0.07458063960075378
Test Epoch24 layer1 Acc 0.8101315789473684, AUC 0.9447758793830872, avg_entr 0.040801890194416046
Test Epoch24 layer2 Acc 0.8192105263157895, AUC 0.9526205062866211, avg_entr 0.028514765202999115
Test Epoch24 layer3 Acc 0.8301315789473684, AUC 0.944847822189331, avg_entr 0.05532965436577797
Test Epoch24 layer4 Acc 0.8110526315789474, AUC 0.9400015473365784, avg_entr 0.06253833323717117
gc 0
Train Epoch25 Acc 0.9049083333333333 (108589/120000), AUC 0.984313428401947
Test Epoch25 layer0 Acc 0.8189473684210526, AUC 0.9487200975418091, avg_entr 0.06913591921329498
Test Epoch25 layer1 Acc 0.815921052631579, AUC 0.9465951323509216, avg_entr 0.03751298040151596
Test Epoch25 layer2 Acc 0.8275, AUC 0.9545544385910034, avg_entr 0.027419693768024445
Test Epoch25 layer3 Acc 0.8353947368421053, AUC 0.9476760029792786, avg_entr 0.04723230004310608
Test Epoch25 layer4 Acc 0.8173684210526316, AUC 0.9426431059837341, avg_entr 0.05371829494833946
gc 0
Train Epoch26 Acc 0.9084583333333334 (109015/120000), AUC 0.9848174452781677
Test Epoch26 layer0 Acc 0.8214473684210526, AUC 0.947809100151062, avg_entr 0.06385834515094757
Test Epoch26 layer1 Acc 0.8139473684210526, AUC 0.9450984597206116, avg_entr 0.03509625792503357
Test Epoch26 layer2 Acc 0.8293421052631579, AUC 0.9523106217384338, avg_entr 0.024006515741348267
Test Epoch26 layer3 Acc 0.8338157894736842, AUC 0.9448925256729126, avg_entr 0.04537992924451828
Test Epoch26 layer4 Acc 0.8138157894736842, AUC 0.9399929046630859, avg_entr 0.05210293456912041
gc 0
Train Epoch27 Acc 0.9058583333333333 (108703/120000), AUC 0.9847168922424316
Test Epoch27 layer0 Acc 0.8196052631578947, AUC 0.9474090337753296, avg_entr 0.06126993149518967
Test Epoch27 layer1 Acc 0.8075, AUC 0.9423547387123108, avg_entr 0.037207458168268204
Test Epoch27 layer2 Acc 0.8217105263157894, AUC 0.9493545889854431, avg_entr 0.028162337839603424
Test Epoch27 layer3 Acc 0.8253947368421053, AUC 0.9437819719314575, avg_entr 0.045549578964710236
Test Epoch27 layer4 Acc 0.7994736842105263, AUC 0.9385800957679749, avg_entr 0.05338168144226074
gc 0
Train Epoch28 Acc 0.9038333333333334 (108460/120000), AUC 0.9847326278686523
Test Epoch28 layer0 Acc 0.8177631578947369, AUC 0.947011411190033, avg_entr 0.06234746053814888
Test Epoch28 layer1 Acc 0.7986842105263158, AUC 0.9400374889373779, avg_entr 0.037966612726449966
Test Epoch28 layer2 Acc 0.8135526315789474, AUC 0.9488645195960999, avg_entr 0.026479437947273254
Test Epoch28 layer3 Acc 0.8275, AUC 0.942569375038147, avg_entr 0.046420592814683914
Test Epoch28 layer4 Acc 0.8093421052631579, AUC 0.9370040893554688, avg_entr 0.05567815154790878
gc 0
Train Epoch29 Acc 0.9022166666666667 (108266/120000), AUC 0.9847965240478516
Test Epoch29 layer0 Acc 0.8128947368421052, AUC 0.9464372396469116, avg_entr 0.06053168326616287
Test Epoch29 layer1 Acc 0.7938157894736843, AUC 0.9368571639060974, avg_entr 0.04012605920433998
Test Epoch29 layer2 Acc 0.8123684210526316, AUC 0.9457780122756958, avg_entr 0.02742944471538067
Test Epoch29 layer3 Acc 0.8182894736842106, AUC 0.9402524828910828, avg_entr 0.049944955855607986
Test Epoch29 layer4 Acc 0.7917105263157894, AUC 0.9350441098213196, avg_entr 0.060106076300144196
gc 0
Train Epoch30 Acc 0.90315 (108378/120000), AUC 0.9854177236557007
Test Epoch30 layer0 Acc 0.8164473684210526, AUC 0.9478414058685303, avg_entr 0.05662764608860016
Test Epoch30 layer1 Acc 0.7985526315789474, AUC 0.939427375793457, avg_entr 0.0381755456328392
Test Epoch30 layer2 Acc 0.8164473684210526, AUC 0.9469786286354065, avg_entr 0.024722110480070114
Test Epoch30 layer3 Acc 0.8238157894736842, AUC 0.940926194190979, avg_entr 0.04598613455891609
Test Epoch30 layer4 Acc 0.7996052631578947, AUC 0.9358636736869812, avg_entr 0.0558774508535862
gc 0
Train Epoch31 Acc 0.9008833333333334 (108106/120000), AUC 0.9852754473686218
Test Epoch31 layer0 Acc 0.8193421052631579, AUC 0.9472311735153198, avg_entr 0.05425408110022545
Test Epoch31 layer1 Acc 0.8011842105263158, AUC 0.9390421509742737, avg_entr 0.036505091935396194
Test Epoch31 layer2 Acc 0.8143421052631579, AUC 0.9465420246124268, avg_entr 0.023925600573420525
Test Epoch31 layer3 Acc 0.8268421052631579, AUC 0.9404501914978027, avg_entr 0.04342609643936157
Test Epoch31 layer4 Acc 0.8048684210526316, AUC 0.9359601140022278, avg_entr 0.05374474450945854
gc 0
Train Epoch32 Acc 0.9024666666666666 (108296/120000), AUC 0.9855318665504456
Test Epoch32 layer0 Acc 0.8194736842105264, AUC 0.9468538761138916, avg_entr 0.0537758432328701
Test Epoch32 layer1 Acc 0.7997368421052632, AUC 0.9373080134391785, avg_entr 0.03947651386260986
Test Epoch32 layer2 Acc 0.8122368421052631, AUC 0.9457229375839233, avg_entr 0.0242446456104517
Test Epoch32 layer3 Acc 0.8218421052631579, AUC 0.9398488402366638, avg_entr 0.044770825654268265
Test Epoch32 layer4 Acc 0.7943421052631578, AUC 0.9352370500564575, avg_entr 0.056557055562734604
gc 0
Train Epoch33 Acc 0.9027166666666666 (108326/120000), AUC 0.9853982329368591
Test Epoch33 layer0 Acc 0.8192105263157895, AUC 0.946777880191803, avg_entr 0.05373163893818855
Test Epoch33 layer1 Acc 0.7973684210526316, AUC 0.93816739320755, avg_entr 0.03641432523727417
Test Epoch33 layer2 Acc 0.8123684210526316, AUC 0.9456629753112793, avg_entr 0.024705689400434494
Test Epoch33 layer3 Acc 0.8242105263157895, AUC 0.9403679966926575, avg_entr 0.04208207502961159
Test Epoch33 layer4 Acc 0.8032894736842106, AUC 0.9349324107170105, avg_entr 0.053373269736766815
gc 0
Train Epoch34 Acc 0.9054833333333333 (108658/120000), AUC 0.9859996438026428
Test Epoch34 layer0 Acc 0.8193421052631579, AUC 0.9469815492630005, avg_entr 0.05251872539520264
Test Epoch34 layer1 Acc 0.7975, AUC 0.9376455545425415, avg_entr 0.036109186708927155
Test Epoch34 layer2 Acc 0.8117105263157894, AUC 0.945228099822998, avg_entr 0.02422420121729374
Test Epoch34 layer3 Acc 0.8235526315789473, AUC 0.93921959400177, avg_entr 0.040710095316171646
Test Epoch34 layer4 Acc 0.8017105263157894, AUC 0.9337830543518066, avg_entr 0.05257419869303703
gc 0
Train Epoch35 Acc 0.9055833333333333 (108670/120000), AUC 0.9858829379081726
Test Epoch35 layer0 Acc 0.8207894736842105, AUC 0.9464932680130005, avg_entr 0.05276865139603615
Test Epoch35 layer1 Acc 0.795, AUC 0.9364461898803711, avg_entr 0.03636045753955841
Test Epoch35 layer2 Acc 0.8072368421052631, AUC 0.944309413433075, avg_entr 0.024856511503458023
Test Epoch35 layer3 Acc 0.8219736842105263, AUC 0.9385359883308411, avg_entr 0.0428866371512413
Test Epoch35 layer4 Acc 0.8013157894736842, AUC 0.9334079623222351, avg_entr 0.05378666892647743
gc 0
Train Epoch36 Acc 0.9037416666666667 (108449/120000), AUC 0.9858962297439575
Test Epoch36 layer0 Acc 0.8206578947368421, AUC 0.9466515779495239, avg_entr 0.05142460763454437
Test Epoch36 layer1 Acc 0.796578947368421, AUC 0.9371068477630615, avg_entr 0.034345682710409164
Test Epoch36 layer2 Acc 0.8118421052631579, AUC 0.9441506266593933, avg_entr 0.02255219966173172
Test Epoch36 layer3 Acc 0.8226315789473684, AUC 0.9386561512947083, avg_entr 0.03986923769116402
Test Epoch36 layer4 Acc 0.8015789473684211, AUC 0.9333410263061523, avg_entr 0.05107412114739418
gc 0
Train Epoch37 Acc 0.90505 (108606/120000), AUC 0.9859857559204102
Test Epoch37 layer0 Acc 0.8210526315789474, AUC 0.9461976885795593, avg_entr 0.05240680277347565
Test Epoch37 layer1 Acc 0.796578947368421, AUC 0.9362648129463196, avg_entr 0.03520991653203964
Test Epoch37 layer2 Acc 0.8098684210526316, AUC 0.9436760544776917, avg_entr 0.023248640820384026
Test Epoch37 layer3 Acc 0.8217105263157894, AUC 0.937972903251648, avg_entr 0.040506962686777115
Test Epoch37 layer4 Acc 0.7998684210526316, AUC 0.9324729442596436, avg_entr 0.05182735249400139
gc 0
Train Epoch38 Acc 0.9062916666666667 (108755/120000), AUC 0.9862637519836426
Test Epoch38 layer0 Acc 0.8197368421052632, AUC 0.9461978077888489, avg_entr 0.05075875297188759
Test Epoch38 layer1 Acc 0.7947368421052632, AUC 0.9362325072288513, avg_entr 0.03510334715247154
Test Epoch38 layer2 Acc 0.809078947368421, AUC 0.9433438777923584, avg_entr 0.02269573323428631
Test Epoch38 layer3 Acc 0.8214473684210526, AUC 0.9371501207351685, avg_entr 0.03828642517328262
Test Epoch38 layer4 Acc 0.7996052631578947, AUC 0.9320088624954224, avg_entr 0.05009572580456734
gc 0
Train Epoch39 Acc 0.9061083333333333 (108733/120000), AUC 0.9861533641815186
Test Epoch39 layer0 Acc 0.8213157894736842, AUC 0.945996105670929, avg_entr 0.05088144168257713
Test Epoch39 layer1 Acc 0.7919736842105263, AUC 0.9351258277893066, avg_entr 0.03625308722257614
Test Epoch39 layer2 Acc 0.8065789473684211, AUC 0.9428715705871582, avg_entr 0.023358920589089394
Test Epoch39 layer3 Acc 0.82, AUC 0.936957836151123, avg_entr 0.040954627096652985
Test Epoch39 layer4 Acc 0.7972368421052631, AUC 0.9317542314529419, avg_entr 0.05246367305517197
gc 0
Train Epoch40 Acc 0.9059833333333334 (108718/120000), AUC 0.9860988259315491
Test Epoch40 layer0 Acc 0.8188157894736842, AUC 0.9456672072410583, avg_entr 0.04999717324972153
Test Epoch40 layer1 Acc 0.7919736842105263, AUC 0.9348082542419434, avg_entr 0.03607799857854843
Test Epoch40 layer2 Acc 0.8075, AUC 0.9429416060447693, avg_entr 0.023220954462885857
Test Epoch40 layer3 Acc 0.8202631578947368, AUC 0.9365421533584595, avg_entr 0.04074608534574509
Test Epoch40 layer4 Acc 0.7978947368421052, AUC 0.9315844774246216, avg_entr 0.05170896649360657
gc 0
Train Epoch41 Acc 0.905125 (108615/120000), AUC 0.9860657453536987
Test Epoch41 layer0 Acc 0.8185526315789474, AUC 0.9459030628204346, avg_entr 0.050504010170698166
Test Epoch41 layer1 Acc 0.7928947368421052, AUC 0.9349403977394104, avg_entr 0.035919830203056335
Test Epoch41 layer2 Acc 0.8063157894736842, AUC 0.9423759579658508, avg_entr 0.022389933466911316
Test Epoch41 layer3 Acc 0.8211842105263157, AUC 0.9369231462478638, avg_entr 0.04055727645754814
Test Epoch41 layer4 Acc 0.7984210526315789, AUC 0.9317271113395691, avg_entr 0.05271139740943909
gc 0
Train Epoch42 Acc 0.9077416666666667 (108929/120000), AUC 0.9863917827606201
Test Epoch42 layer0 Acc 0.8185526315789474, AUC 0.9459534287452698, avg_entr 0.049972329288721085
Test Epoch42 layer1 Acc 0.7925, AUC 0.9348464012145996, avg_entr 0.036224283277988434
Test Epoch42 layer2 Acc 0.8071052631578948, AUC 0.9425219893455505, avg_entr 0.023006591945886612
Test Epoch42 layer3 Acc 0.819078947368421, AUC 0.9364446401596069, avg_entr 0.04004471376538277
Test Epoch42 layer4 Acc 0.7968421052631579, AUC 0.9314926266670227, avg_entr 0.05258943513035774
gc 0
Train Epoch43 Acc 0.9062083333333333 (108745/120000), AUC 0.9862131476402283
Test Epoch43 layer0 Acc 0.8175, AUC 0.9457447528839111, avg_entr 0.04994208738207817
Test Epoch43 layer1 Acc 0.7913157894736842, AUC 0.9347845315933228, avg_entr 0.03586389869451523
Test Epoch43 layer2 Acc 0.8088157894736843, AUC 0.9423093795776367, avg_entr 0.022609785199165344
Test Epoch43 layer3 Acc 0.8197368421052632, AUC 0.936554491519928, avg_entr 0.039437152445316315
Test Epoch43 layer4 Acc 0.7964473684210527, AUC 0.9320499897003174, avg_entr 0.05138795077800751
gc 0
Train Epoch44 Acc 0.9067916666666667 (108815/120000), AUC 0.9862617254257202
Test Epoch44 layer0 Acc 0.8188157894736842, AUC 0.9457597732543945, avg_entr 0.05026521533727646
Test Epoch44 layer1 Acc 0.7923684210526316, AUC 0.9346094131469727, avg_entr 0.03605055436491966
Test Epoch44 layer2 Acc 0.8069736842105263, AUC 0.9421699047088623, avg_entr 0.02300386317074299
Test Epoch44 layer3 Acc 0.8178947368421052, AUC 0.9363190531730652, avg_entr 0.039974987506866455
Test Epoch44 layer4 Acc 0.7964473684210527, AUC 0.9310683608055115, avg_entr 0.05176444724202156
gc 0
Train Epoch45 Acc 0.9071333333333333 (108856/120000), AUC 0.9863717555999756
Test Epoch45 layer0 Acc 0.8196052631578947, AUC 0.9457018375396729, avg_entr 0.049969691783189774
Test Epoch45 layer1 Acc 0.7917105263157894, AUC 0.9346134066581726, avg_entr 0.035560812801122665
Test Epoch45 layer2 Acc 0.8073684210526316, AUC 0.9421446919441223, avg_entr 0.022222967818379402
Test Epoch45 layer3 Acc 0.8193421052631579, AUC 0.9361656904220581, avg_entr 0.03955715894699097
Test Epoch45 layer4 Acc 0.7969736842105263, AUC 0.9313747882843018, avg_entr 0.05074334889650345
gc 0
Train Epoch46 Acc 0.9068 (108816/120000), AUC 0.9863404035568237
Test Epoch46 layer0 Acc 0.819078947368421, AUC 0.9458044767379761, avg_entr 0.04959174990653992
Test Epoch46 layer1 Acc 0.7918421052631579, AUC 0.9347214698791504, avg_entr 0.03548048064112663
Test Epoch46 layer2 Acc 0.8071052631578948, AUC 0.9422814249992371, avg_entr 0.022832904011011124
Test Epoch46 layer3 Acc 0.8196052631578947, AUC 0.9363807439804077, avg_entr 0.039191290736198425
Test Epoch46 layer4 Acc 0.799078947368421, AUC 0.9315499067306519, avg_entr 0.05139299854636192
gc 0
Train Epoch47 Acc 0.9074 (108888/120000), AUC 0.9864200353622437
Test Epoch47 layer0 Acc 0.8189473684210526, AUC 0.9457376599311829, avg_entr 0.049796294420957565
Test Epoch47 layer1 Acc 0.7918421052631579, AUC 0.9345500469207764, avg_entr 0.03534845635294914
Test Epoch47 layer2 Acc 0.8067105263157894, AUC 0.9419776201248169, avg_entr 0.021981997415423393
Test Epoch47 layer3 Acc 0.819078947368421, AUC 0.9361453056335449, avg_entr 0.0393017902970314
Test Epoch47 layer4 Acc 0.7975, AUC 0.9312705993652344, avg_entr 0.05090852081775665
gc 0
Train Epoch48 Acc 0.907475 (108897/120000), AUC 0.9864264726638794
Test Epoch48 layer0 Acc 0.8189473684210526, AUC 0.9456665515899658, avg_entr 0.04946186766028404
Test Epoch48 layer1 Acc 0.7907894736842105, AUC 0.9343065023422241, avg_entr 0.035577140748500824
Test Epoch48 layer2 Acc 0.8076315789473684, AUC 0.941910982131958, avg_entr 0.022015806287527084
Test Epoch48 layer3 Acc 0.8189473684210526, AUC 0.9362099766731262, avg_entr 0.03943959251046181
Test Epoch48 layer4 Acc 0.796578947368421, AUC 0.9311740398406982, avg_entr 0.051213983446359634
gc 0
Train Epoch49 Acc 0.9073416666666667 (108881/120000), AUC 0.9863463640213013
Test Epoch49 layer0 Acc 0.8186842105263158, AUC 0.945652961730957, avg_entr 0.049724094569683075
Test Epoch49 layer1 Acc 0.7901315789473684, AUC 0.9341598749160767, avg_entr 0.036057449877262115
Test Epoch49 layer2 Acc 0.8068421052631579, AUC 0.941909670829773, avg_entr 0.022985100746154785
Test Epoch49 layer3 Acc 0.8188157894736842, AUC 0.9360659122467041, avg_entr 0.03934059664607048
Test Epoch49 layer4 Acc 0.7967105263157894, AUC 0.9311773180961609, avg_entr 0.051667455583810806
Best AUC 0.9636766910552979
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmalside_l5_side25//ag_news_lstmalside_l5_side.pt
[[1581   93  143   83]
 [  97 1628  102   73]
 [ 140   66 1463  231]
 [ 120  100  188 1492]]
Figure(640x480)
tensor([0.6663, 0.0503, 0.4564,  ..., 0.3907, 0.2176, 0.2990])
[[1598   81  124   97]
 [  61 1703   76   60]
 [  99   74 1506  221]
 [  95   94  189 1522]]
Figure(640x480)
tensor([0.2240, 0.0238, 0.0133,  ..., 0.0982, 0.0701, 0.0114])
[[1597   81  122  100]
 [  49 1737   58   56]
 [  84   69 1525  222]
 [  83   91  179 1547]]
Figure(640x480)
tensor([0.0091, 0.0196, 0.0130,  ..., 0.2864, 0.0104, 0.0064])
[[1596   74  124  106]
 [  39 1754   52   55]
 [  77   69 1521  233]
 [  75   84  171 1570]]
Figure(640x480)
tensor([0.0322, 0.0523, 0.0113,  ..., 0.3915, 0.0062, 0.0035])
[[1614   74  108  104]
 [  42 1752   46   60]
 [  88   61 1511  240]
 [  81   77  164 1578]]
Figure(640x480)
tensor([0.0392, 0.0755, 0.0087,  ..., 0.1247, 0.0061, 0.0039])
