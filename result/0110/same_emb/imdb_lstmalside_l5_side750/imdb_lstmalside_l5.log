total count words 222751
vocab size 30000
found 27937 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList()
  (emb): Embedding(30000, 300)
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb.weight 9000000
Total Trainable Params: 12937378
Start Training
gc 0
Train Epoch0 Acc 0.5018 (20072/40000), AUC 0.5020120143890381
Test Epoch0 layer0 Acc 0.5007, AUC 0.5090233087539673, avg_entr 0.7081130146980286
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5017, AUC 0.5106572508811951, avg_entr 0.7092637419700623
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.4996, AUC 0.498049795627594, avg_entr 0.7086011171340942
Test Epoch0 layer3 Acc 0.4992, AUC 0.5000180006027222, avg_entr 0.7087112069129944
Test Epoch0 layer4 Acc 0.5003, AUC 0.5001623034477234, avg_entr 0.7088829874992371
gc 0
Train Epoch1 Acc 0.50005 (20002/40000), AUC 0.5024572610855103
Test Epoch1 layer0 Acc 0.5003, AUC 0.5178012847900391, avg_entr 0.6942723393440247
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.5012, AUC 0.5049743056297302, avg_entr 0.6947940587997437
Test Epoch1 layer2 Acc 0.5016, AUC 0.5043385028839111, avg_entr 0.6946455836296082
Test Epoch1 layer3 Acc 0.5011, AUC 0.4989033341407776, avg_entr 0.6944584846496582
Test Epoch1 layer4 Acc 0.4993, AUC 0.5002505779266357, avg_entr 0.6954192519187927
gc 0
Train Epoch2 Acc 0.5048 (20192/40000), AUC 0.5083203315734863
Test Epoch2 layer0 Acc 0.5032, AUC 0.5258901119232178, avg_entr 0.6935418844223022
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.5029, AUC 0.5133068561553955, avg_entr 0.6928364038467407
Test Epoch2 layer2 Acc 0.5036, AUC 0.5076152086257935, avg_entr 0.6925690770149231
Test Epoch2 layer3 Acc 0.5019, AUC 0.49854031205177307, avg_entr 0.6927742958068848
Test Epoch2 layer4 Acc 0.4997, AUC 0.5029083490371704, avg_entr 0.6935080885887146
gc 0
Train Epoch3 Acc 0.505175 (20207/40000), AUC 0.5073121786117554
Test Epoch3 layer0 Acc 0.5069, AUC 0.524706244468689, avg_entr 0.692909300327301
Test Epoch3 layer1 Acc 0.5067, AUC 0.5070861577987671, avg_entr 0.6935060620307922
Test Epoch3 layer2 Acc 0.5063, AUC 0.507595419883728, avg_entr 0.6930810809135437
Test Epoch3 layer3 Acc 0.503, AUC 0.5044132471084595, avg_entr 0.6931988596916199
Test Epoch3 layer4 Acc 0.5017, AUC 0.5019998550415039, avg_entr 0.6937673091888428
gc 0
Train Epoch4 Acc 0.50735 (20294/40000), AUC 0.5086856484413147
Test Epoch4 layer0 Acc 0.5015, AUC 0.5279660224914551, avg_entr 0.6877872347831726
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.4998, AUC 0.5178625583648682, avg_entr 0.6891053318977356
Test Epoch4 layer2 Acc 0.5005, AUC 0.506665825843811, avg_entr 0.6887354850769043
Test Epoch4 layer3 Acc 0.5008, AUC 0.5015595555305481, avg_entr 0.6895015835762024
Test Epoch4 layer4 Acc 0.5008, AUC 0.5024265050888062, avg_entr 0.6899471879005432
gc 0
Train Epoch5 Acc 0.50555 (20222/40000), AUC 0.5074790120124817
Test Epoch5 layer0 Acc 0.5004, AUC 0.5316909551620483, avg_entr 0.6855907440185547
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.5033, AUC 0.5157502889633179, avg_entr 0.6861814260482788
Test Epoch5 layer2 Acc 0.5036, AUC 0.5100332498550415, avg_entr 0.6877747178077698
Test Epoch5 layer3 Acc 0.5032, AUC 0.505497932434082, avg_entr 0.688377857208252
Test Epoch5 layer4 Acc 0.5013, AUC 0.5021536946296692, avg_entr 0.690777063369751
gc 0
Train Epoch6 Acc 0.507375 (20295/40000), AUC 0.5076346397399902
Test Epoch6 layer0 Acc 0.5106, AUC 0.5328519344329834, avg_entr 0.6916317343711853
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.5073, AUC 0.5159072875976562, avg_entr 0.6925354599952698
Test Epoch6 layer2 Acc 0.5064, AUC 0.5098626017570496, avg_entr 0.6928327083587646
Test Epoch6 layer3 Acc 0.5037, AUC 0.5008542537689209, avg_entr 0.6930944323539734
Test Epoch6 layer4 Acc 0.5014, AUC 0.5031622052192688, avg_entr 0.6940768361091614
gc 0
Train Epoch7 Acc 0.50305 (20122/40000), AUC 0.5029551982879639
Test Epoch7 layer0 Acc 0.515, AUC 0.5366310477256775, avg_entr 0.6921515464782715
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer1 Acc 0.5075, AUC 0.5143848657608032, avg_entr 0.6936728358268738
Test Epoch7 layer2 Acc 0.5076, AUC 0.507808268070221, avg_entr 0.692818284034729
Test Epoch7 layer3 Acc 0.5035, AUC 0.5048123598098755, avg_entr 0.6932728886604309
Test Epoch7 layer4 Acc 0.5013, AUC 0.5035545825958252, avg_entr 0.6937616467475891
gc 0
Train Epoch8 Acc 0.502325 (20093/40000), AUC 0.505660891532898
Test Epoch8 layer0 Acc 0.5242, AUC 0.5392497181892395, avg_entr 0.6917095184326172
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer1 Acc 0.5097, AUC 0.5156220197677612, avg_entr 0.6937687993049622
Test Epoch8 layer2 Acc 0.5075, AUC 0.5075390338897705, avg_entr 0.6924675703048706
Test Epoch8 layer3 Acc 0.504, AUC 0.5013152956962585, avg_entr 0.6935683488845825
Test Epoch8 layer4 Acc 0.5011, AUC 0.5035704374313354, avg_entr 0.6940681338310242
gc 0
Train Epoch9 Acc 0.5055 (20220/40000), AUC 0.5087522864341736
Test Epoch9 layer0 Acc 0.5092, AUC 0.542061448097229, avg_entr 0.6784255504608154
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer1 Acc 0.5101, AUC 0.5192449688911438, avg_entr 0.6932380795478821
Test Epoch9 layer2 Acc 0.5057, AUC 0.510520339012146, avg_entr 0.6910675764083862
Test Epoch9 layer3 Acc 0.5037, AUC 0.5047739744186401, avg_entr 0.6914003491401672
Test Epoch9 layer4 Acc 0.5011, AUC 0.5031187534332275, avg_entr 0.6942840218544006
gc 0
Train Epoch10 Acc 0.50165 (20066/40000), AUC 0.50473952293396
Test Epoch10 layer0 Acc 0.5252, AUC 0.5609230995178223, avg_entr 0.6757229566574097
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer1 Acc 0.505, AUC 0.5162233114242554, avg_entr 0.6802650094032288
Test Epoch10 layer2 Acc 0.5045, AUC 0.5108675360679626, avg_entr 0.6774994730949402
Test Epoch10 layer3 Acc 0.5045, AUC 0.501091718673706, avg_entr 0.6820586919784546
Test Epoch10 layer4 Acc 0.5008, AUC 0.503673791885376, avg_entr 0.6777043342590332
gc 0
Train Epoch11 Acc 0.509375 (20375/40000), AUC 0.5116537809371948
Test Epoch11 layer0 Acc 0.6192, AUC 0.6742435693740845, avg_entr 0.4704979956150055
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer1 Acc 0.5019, AUC 0.5189327597618103, avg_entr 0.6855514049530029
Test Epoch11 layer2 Acc 0.5011, AUC 0.509756326675415, avg_entr 0.68764328956604
Test Epoch11 layer3 Acc 0.5005, AUC 0.5054075717926025, avg_entr 0.6859981417655945
Test Epoch11 layer4 Acc 0.5011, AUC 0.5033915638923645, avg_entr 0.6878577470779419
gc 0
Train Epoch12 Acc 0.50855 (20342/40000), AUC 0.5106993913650513
Test Epoch12 layer0 Acc 0.6474, AUC 0.7119735479354858, avg_entr 0.46353471279144287
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 12
Test Epoch12 layer1 Acc 0.5091, AUC 0.518696665763855, avg_entr 0.6894209980964661
Test Epoch12 layer2 Acc 0.5059, AUC 0.5102559924125671, avg_entr 0.6871674060821533
Test Epoch12 layer3 Acc 0.5044, AUC 0.5047388076782227, avg_entr 0.6915326118469238
Test Epoch12 layer4 Acc 0.5008, AUC 0.50146484375, avg_entr 0.6897832751274109
gc 0
Train Epoch13 Acc 0.5049 (20196/40000), AUC 0.507919430732727
Test Epoch13 layer0 Acc 0.6878, AUC 0.762066125869751, avg_entr 0.3719308078289032
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer1 Acc 0.5109, AUC 0.5170016884803772, avg_entr 0.6890228390693665
Test Epoch13 layer2 Acc 0.5068, AUC 0.5097254514694214, avg_entr 0.6868494153022766
Test Epoch13 layer3 Acc 0.5039, AUC 0.5074329972267151, avg_entr 0.691274106502533
Test Epoch13 layer4 Acc 0.5008, AUC 0.5033575892448425, avg_entr 0.6914091110229492
gc 0
Train Epoch14 Acc 0.50115 (20046/40000), AUC 0.5065038800239563
Test Epoch14 layer0 Acc 0.7071, AUC 0.7891384363174438, avg_entr 0.2979583144187927
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 14
Test Epoch14 layer1 Acc 0.5094, AUC 0.5191642045974731, avg_entr 0.6872990131378174
Test Epoch14 layer2 Acc 0.5061, AUC 0.509229302406311, avg_entr 0.6887800693511963
Test Epoch14 layer3 Acc 0.5043, AUC 0.5057228803634644, avg_entr 0.6871012449264526
Test Epoch14 layer4 Acc 0.5009, AUC 0.5035895109176636, avg_entr 0.6894227862358093
gc 0
Train Epoch15 Acc 0.502625 (20105/40000), AUC 0.5043917894363403
Test Epoch15 layer0 Acc 0.7341, AUC 0.8151284456253052, avg_entr 0.2870008647441864
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 15
Test Epoch15 layer1 Acc 0.5066, AUC 0.5728540420532227, avg_entr 0.6903530359268188
Test Epoch15 layer2 Acc 0.5017, AUC 0.5121721029281616, avg_entr 0.6883950233459473
Test Epoch15 layer3 Acc 0.5003, AUC 0.5060455799102783, avg_entr 0.6908324360847473
Test Epoch15 layer4 Acc 0.5009, AUC 0.5042998790740967, avg_entr 0.6932049989700317
gc 0
Train Epoch16 Acc 0.500675 (20027/40000), AUC 0.5037262439727783
Test Epoch16 layer0 Acc 0.7464, AUC 0.8272596597671509, avg_entr 0.2687288224697113
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 16
Test Epoch16 layer1 Acc 0.5117, AUC 0.5211766958236694, avg_entr 0.6903182864189148
Test Epoch16 layer2 Acc 0.5058, AUC 0.5109658241271973, avg_entr 0.6885096430778503
Test Epoch16 layer3 Acc 0.5037, AUC 0.5032179951667786, avg_entr 0.6912476420402527
Test Epoch16 layer4 Acc 0.5018, AUC 0.5028690099716187, avg_entr 0.6938298344612122
gc 0
Train Epoch17 Acc 0.50625 (20250/40000), AUC 0.508355438709259
Test Epoch17 layer0 Acc 0.7552, AUC 0.83990079164505, avg_entr 0.24916701018810272
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 17
Test Epoch17 layer1 Acc 0.5053, AUC 0.5220886468887329, avg_entr 0.688915491104126
Test Epoch17 layer2 Acc 0.5021, AUC 0.5117657780647278, avg_entr 0.6846831440925598
Test Epoch17 layer3 Acc 0.5007, AUC 0.5063750147819519, avg_entr 0.6898927092552185
Test Epoch17 layer4 Acc 0.5006, AUC 0.50245201587677, avg_entr 0.6926810145378113
gc 0
Train Epoch18 Acc 0.501925 (20077/40000), AUC 0.505484938621521
Test Epoch18 layer0 Acc 0.7649, AUC 0.8498741984367371, avg_entr 0.22628264129161835
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 18
Test Epoch18 layer1 Acc 0.5075, AUC 0.5179736018180847, avg_entr 0.6896612048149109
Test Epoch18 layer2 Acc 0.5, AUC 0.506445586681366, avg_entr 0.6868498921394348
Test Epoch18 layer3 Acc 0.5038, AUC 0.5072619915008545, avg_entr 0.6909576058387756
Test Epoch18 layer4 Acc 0.5003, AUC 0.501568078994751, avg_entr 0.693589448928833
gc 0
Train Epoch19 Acc 0.5059 (20236/40000), AUC 0.5108948945999146
Test Epoch19 layer0 Acc 0.7676, AUC 0.8565460443496704, avg_entr 0.19130507111549377
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 19
Test Epoch19 layer1 Acc 0.5134, AUC 0.5242156982421875, avg_entr 0.6881104707717896
Test Epoch19 layer2 Acc 0.5055, AUC 0.5087140798568726, avg_entr 0.681212842464447
Test Epoch19 layer3 Acc 0.5045, AUC 0.5051555037498474, avg_entr 0.6906272172927856
Test Epoch19 layer4 Acc 0.5013, AUC 0.5010836124420166, avg_entr 0.6930000185966492
gc 0
Train Epoch20 Acc 0.508 (20320/40000), AUC 0.5115519762039185
Test Epoch20 layer0 Acc 0.765, AUC 0.8605256080627441, avg_entr 0.1910904198884964
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 20
Test Epoch20 layer1 Acc 0.5131, AUC 0.524686336517334, avg_entr 0.687824010848999
Test Epoch20 layer2 Acc 0.5058, AUC 0.5061781406402588, avg_entr 0.6832751035690308
Test Epoch20 layer3 Acc 0.5043, AUC 0.5067667961120605, avg_entr 0.6905041933059692
Test Epoch20 layer4 Acc 0.501, AUC 0.5023147463798523, avg_entr 0.6926696300506592
gc 0
Train Epoch21 Acc 0.506725 (20269/40000), AUC 0.5116337537765503
Test Epoch21 layer0 Acc 0.7771, AUC 0.863608181476593, avg_entr 0.17063261568546295
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 21
Test Epoch21 layer1 Acc 0.5051, AUC 0.5238167643547058, avg_entr 0.6781163811683655
Test Epoch21 layer2 Acc 0.5021, AUC 0.5071429014205933, avg_entr 0.6571946740150452
Test Epoch21 layer3 Acc 0.5007, AUC 0.5078846216201782, avg_entr 0.6698912978172302
Test Epoch21 layer4 Acc 0.5002, AUC 0.501677393913269, avg_entr 0.6788731217384338
gc 0
Train Epoch22 Acc 0.50605 (20242/40000), AUC 0.510402500629425
Test Epoch22 layer0 Acc 0.7793, AUC 0.8680905699729919, avg_entr 0.1495797485113144
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 22
Test Epoch22 layer1 Acc 0.5069, AUC 0.5092203617095947, avg_entr 0.6871135234832764
Test Epoch22 layer2 Acc 0.5068, AUC 0.5063321590423584, avg_entr 0.6811513900756836
Test Epoch22 layer3 Acc 0.5013, AUC 0.5088551044464111, avg_entr 0.6899874806404114
Test Epoch22 layer4 Acc 0.5004, AUC 0.5026087164878845, avg_entr 0.6925145983695984
gc 0
Train Epoch23 Acc 0.50675 (20270/40000), AUC 0.5097471475601196
Test Epoch23 layer0 Acc 0.7837, AUC 0.8736078143119812, avg_entr 0.15594539046287537
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 23
Test Epoch23 layer1 Acc 0.5124, AUC 0.517517626285553, avg_entr 0.6849843859672546
Test Epoch23 layer2 Acc 0.5055, AUC 0.5073654651641846, avg_entr 0.6754924058914185
Test Epoch23 layer3 Acc 0.504, AUC 0.5045065879821777, avg_entr 0.686378538608551
Test Epoch23 layer4 Acc 0.5005, AUC 0.5003106594085693, avg_entr 0.6907301545143127
gc 0
Train Epoch24 Acc 0.509125 (20365/40000), AUC 0.5136685371398926
Test Epoch24 layer0 Acc 0.7857, AUC 0.8759247064590454, avg_entr 0.12605275213718414
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 24
Test Epoch24 layer1 Acc 0.511, AUC 0.5196727514266968, avg_entr 0.683036208152771
Test Epoch24 layer2 Acc 0.5056, AUC 0.508978009223938, avg_entr 0.6743296980857849
Test Epoch24 layer3 Acc 0.5041, AUC 0.5071488618850708, avg_entr 0.6849943399429321
Test Epoch24 layer4 Acc 0.5003, AUC 0.5014466047286987, avg_entr 0.6887768507003784
gc 0
Train Epoch25 Acc 0.504775 (20191/40000), AUC 0.5043357610702515
Test Epoch25 layer0 Acc 0.7896, AUC 0.8788763284683228, avg_entr 0.12384358048439026
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 25
Test Epoch25 layer1 Acc 0.5122, AUC 0.5249494314193726, avg_entr 0.6854228377342224
Test Epoch25 layer2 Acc 0.506, AUC 0.5087203979492188, avg_entr 0.6775136590003967
Test Epoch25 layer3 Acc 0.5041, AUC 0.5062076449394226, avg_entr 0.6887016892433167
Test Epoch25 layer4 Acc 0.5004, AUC 0.5027251243591309, avg_entr 0.6918092966079712
gc 0
Train Epoch26 Acc 0.501825 (20073/40000), AUC 0.5050759315490723
Test Epoch26 layer0 Acc 0.796, AUC 0.8813893795013428, avg_entr 0.12708137929439545
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 26
Test Epoch26 layer1 Acc 0.5071, AUC 0.5225554704666138, avg_entr 0.6853052973747253
Test Epoch26 layer2 Acc 0.4997, AUC 0.5027726888656616, avg_entr 0.6779183745384216
Test Epoch26 layer3 Acc 0.5012, AUC 0.502709686756134, avg_entr 0.6871212720870972
Test Epoch26 layer4 Acc 0.5004, AUC 0.5022460222244263, avg_entr 0.6916420459747314
gc 0
Train Epoch27 Acc 0.505525 (20221/40000), AUC 0.5081552267074585
Test Epoch27 layer0 Acc 0.7653, AUC 0.8825444579124451, avg_entr 0.11099448055028915
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 27
Test Epoch27 layer1 Acc 0.5084, AUC 0.5193361043930054, avg_entr 0.6849655508995056
Test Epoch27 layer2 Acc 0.5068, AUC 0.5027036666870117, avg_entr 0.6782425045967102
Test Epoch27 layer3 Acc 0.504, AUC 0.5076467990875244, avg_entr 0.6884583234786987
Test Epoch27 layer4 Acc 0.4999, AUC 0.502672553062439, avg_entr 0.6920672655105591
gc 0
Train Epoch28 Acc 0.50185 (20074/40000), AUC 0.5039716958999634
Test Epoch28 layer0 Acc 0.7864, AUC 0.8829162120819092, avg_entr 0.11039586365222931
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 28
Test Epoch28 layer1 Acc 0.5127, AUC 0.4989621043205261, avg_entr 0.6846809983253479
Test Epoch28 layer2 Acc 0.5069, AUC 0.5075653195381165, avg_entr 0.6763415336608887
Test Epoch28 layer3 Acc 0.5036, AUC 0.5088006854057312, avg_entr 0.6875242590904236
Test Epoch28 layer4 Acc 0.5004, AUC 0.5004192590713501, avg_entr 0.6919479370117188
gc 0
Train Epoch29 Acc 0.50405 (20162/40000), AUC 0.5093029737472534
Test Epoch29 layer0 Acc 0.7769, AUC 0.8846052885055542, avg_entr 0.09920203685760498
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 29
Test Epoch29 layer1 Acc 0.5129, AUC 0.49762988090515137, avg_entr 0.684482991695404
Test Epoch29 layer2 Acc 0.5069, AUC 0.5077486038208008, avg_entr 0.6757365465164185
Test Epoch29 layer3 Acc 0.5038, AUC 0.5028641223907471, avg_entr 0.6879552602767944
Test Epoch29 layer4 Acc 0.5005, AUC 0.501099705696106, avg_entr 0.6919624209403992
gc 0
Train Epoch30 Acc 0.50155 (20062/40000), AUC 0.5057882070541382
Test Epoch30 layer0 Acc 0.7996, AUC 0.8883652091026306, avg_entr 0.08890289068222046
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 30
Test Epoch30 layer1 Acc 0.5123, AUC 0.49608033895492554, avg_entr 0.6838504672050476
Test Epoch30 layer2 Acc 0.5077, AUC 0.5065010786056519, avg_entr 0.6739816665649414
Test Epoch30 layer3 Acc 0.5037, AUC 0.5026453733444214, avg_entr 0.6878393292427063
Test Epoch30 layer4 Acc 0.5004, AUC 0.502831220626831, avg_entr 0.6915506720542908
gc 0
Train Epoch31 Acc 0.50275 (20110/40000), AUC 0.5042378902435303
Test Epoch31 layer0 Acc 0.8052, AUC 0.8908514380455017, avg_entr 0.0872090682387352
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 31
Test Epoch31 layer1 Acc 0.5121, AUC 0.5151066184043884, avg_entr 0.683314859867096
Test Epoch31 layer2 Acc 0.5071, AUC 0.5103496313095093, avg_entr 0.6721093058586121
Test Epoch31 layer3 Acc 0.504, AUC 0.5039752721786499, avg_entr 0.6864075660705566
Test Epoch31 layer4 Acc 0.5004, AUC 0.50211501121521, avg_entr 0.6913479566574097
gc 0
Train Epoch32 Acc 0.504675 (20187/40000), AUC 0.5063716173171997
Test Epoch32 layer0 Acc 0.8008, AUC 0.8886810541152954, avg_entr 0.07718072831630707
Test Epoch32 layer1 Acc 0.5128, AUC 0.5335716605186462, avg_entr 0.6834177374839783
Test Epoch32 layer2 Acc 0.5073, AUC 0.5101744532585144, avg_entr 0.6731533408164978
Test Epoch32 layer3 Acc 0.5037, AUC 0.5053830146789551, avg_entr 0.6870203018188477
Test Epoch32 layer4 Acc 0.5004, AUC 0.5008775591850281, avg_entr 0.6915987133979797
gc 0
Train Epoch33 Acc 0.503175 (20127/40000), AUC 0.5072720646858215
Test Epoch33 layer0 Acc 0.8091, AUC 0.8925354480743408, avg_entr 0.08338906615972519
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 33
Test Epoch33 layer1 Acc 0.5126, AUC 0.5097631812095642, avg_entr 0.6831010580062866
Test Epoch33 layer2 Acc 0.5073, AUC 0.5125195980072021, avg_entr 0.6724979281425476
Test Epoch33 layer3 Acc 0.5036, AUC 0.5079346895217896, avg_entr 0.6868574023246765
Test Epoch33 layer4 Acc 0.5005, AUC 0.5025634169578552, avg_entr 0.6915000081062317
gc 0
Train Epoch34 Acc 0.50415 (20166/40000), AUC 0.5056084394454956
Test Epoch34 layer0 Acc 0.8031, AUC 0.8913956880569458, avg_entr 0.0680704414844513
Test Epoch34 layer1 Acc 0.5132, AUC 0.621717095375061, avg_entr 0.6828397512435913
Test Epoch34 layer2 Acc 0.5072, AUC 0.5074186325073242, avg_entr 0.6720582842826843
Test Epoch34 layer3 Acc 0.504, AUC 0.5088276863098145, avg_entr 0.6863842606544495
Test Epoch34 layer4 Acc 0.5007, AUC 0.5016255378723145, avg_entr 0.6914268136024475
gc 0
Train Epoch35 Acc 0.505975 (20239/40000), AUC 0.5097304582595825
Test Epoch35 layer0 Acc 0.8064, AUC 0.8928890228271484, avg_entr 0.07011783123016357
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 35
Test Epoch35 layer1 Acc 0.5132, AUC 0.5230517387390137, avg_entr 0.6826152801513672
Test Epoch35 layer2 Acc 0.5079, AUC 0.5100859999656677, avg_entr 0.6717833280563354
Test Epoch35 layer3 Acc 0.5042, AUC 0.5054367184638977, avg_entr 0.686537504196167
Test Epoch35 layer4 Acc 0.4999, AUC 0.5020776987075806, avg_entr 0.6913455128669739
gc 0
Train Epoch36 Acc 0.5037 (20148/40000), AUC 0.506686270236969
Test Epoch36 layer0 Acc 0.7934, AUC 0.892298698425293, avg_entr 0.07744846493005753
Test Epoch36 layer1 Acc 0.5131, AUC 0.5253987312316895, avg_entr 0.6822201013565063
Test Epoch36 layer2 Acc 0.5073, AUC 0.5106712579727173, avg_entr 0.6709288358688354
Test Epoch36 layer3 Acc 0.5039, AUC 0.5075170993804932, avg_entr 0.6861814260482788
Test Epoch36 layer4 Acc 0.501, AUC 0.5033004283905029, avg_entr 0.6912952661514282
gc 0
Train Epoch37 Acc 0.504975 (20199/40000), AUC 0.5064117312431335
Test Epoch37 layer0 Acc 0.807, AUC 0.891400933265686, avg_entr 0.05586712062358856
Test Epoch37 layer1 Acc 0.5131, AUC 0.5257855653762817, avg_entr 0.6818848848342896
Test Epoch37 layer2 Acc 0.5077, AUC 0.5102936029434204, avg_entr 0.6702755689620972
Test Epoch37 layer3 Acc 0.5039, AUC 0.5060850977897644, avg_entr 0.6860338449478149
Test Epoch37 layer4 Acc 0.5006, AUC 0.5024219751358032, avg_entr 0.6911658048629761
gc 0
Train Epoch38 Acc 0.50475 (20190/40000), AUC 0.5079050064086914
Test Epoch38 layer0 Acc 0.8087, AUC 0.8922706842422485, avg_entr 0.05835665389895439
Test Epoch38 layer1 Acc 0.5128, AUC 0.519365131855011, avg_entr 0.6815470457077026
Test Epoch38 layer2 Acc 0.5073, AUC 0.508402943611145, avg_entr 0.6695353984832764
Test Epoch38 layer3 Acc 0.5038, AUC 0.5093697905540466, avg_entr 0.6857743263244629
Test Epoch38 layer4 Acc 0.5005, AUC 0.5014172792434692, avg_entr 0.6910639405250549
gc 0
Train Epoch39 Acc 0.50525 (20210/40000), AUC 0.5041362047195435
Test Epoch39 layer0 Acc 0.8112, AUC 0.8925292491912842, avg_entr 0.06139781326055527
Test Epoch39 layer1 Acc 0.5119, AUC 0.5005329847335815, avg_entr 0.6810668110847473
Test Epoch39 layer2 Acc 0.5076, AUC 0.5102733373641968, avg_entr 0.6684094667434692
Test Epoch39 layer3 Acc 0.5041, AUC 0.5062687397003174, avg_entr 0.6841917037963867
Test Epoch39 layer4 Acc 0.5007, AUC 0.4994610846042633, avg_entr 0.6907703280448914
gc 0
Train Epoch40 Acc 0.505325 (20213/40000), AUC 0.5033783912658691
Test Epoch40 layer0 Acc 0.8098, AUC 0.8922598361968994, avg_entr 0.0479385070502758
Test Epoch40 layer1 Acc 0.5118, AUC 0.5235844850540161, avg_entr 0.6809329986572266
Test Epoch40 layer2 Acc 0.5077, AUC 0.5087345838546753, avg_entr 0.6683637499809265
Test Epoch40 layer3 Acc 0.5041, AUC 0.506598949432373, avg_entr 0.6846228241920471
Test Epoch40 layer4 Acc 0.5006, AUC 0.5026010274887085, avg_entr 0.690803587436676
gc 0
Train Epoch41 Acc 0.50535 (20214/40000), AUC 0.5036404132843018
Test Epoch41 layer0 Acc 0.8135, AUC 0.895058274269104, avg_entr 0.05517560988664627
Save ckpt to ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt  ,ep 41
Test Epoch41 layer1 Acc 0.5129, AUC 0.5191559791564941, avg_entr 0.6808654069900513
Test Epoch41 layer2 Acc 0.5073, AUC 0.5104117393493652, avg_entr 0.6686099171638489
Test Epoch41 layer3 Acc 0.5041, AUC 0.5085182189941406, avg_entr 0.6852359175682068
Test Epoch41 layer4 Acc 0.5006, AUC 0.5037034749984741, avg_entr 0.6908490061759949
gc 0
Train Epoch42 Acc 0.50535 (20214/40000), AUC 0.5034855604171753
Test Epoch42 layer0 Acc 0.8116, AUC 0.8916533589363098, avg_entr 0.05015067383646965
Test Epoch42 layer1 Acc 0.5122, AUC 0.5198713541030884, avg_entr 0.6805700063705444
Test Epoch42 layer2 Acc 0.5074, AUC 0.507588803768158, avg_entr 0.6680726408958435
Test Epoch42 layer3 Acc 0.5041, AUC 0.5026293992996216, avg_entr 0.6845275163650513
Test Epoch42 layer4 Acc 0.5006, AUC 0.5018681287765503, avg_entr 0.6907626986503601
gc 0
Train Epoch43 Acc 0.5053 (20212/40000), AUC 0.5057898759841919
Test Epoch43 layer0 Acc 0.8072, AUC 0.8904237747192383, avg_entr 0.04375407099723816
Test Epoch43 layer1 Acc 0.5121, AUC 0.5251644253730774, avg_entr 0.6804125308990479
Test Epoch43 layer2 Acc 0.5077, AUC 0.5096798539161682, avg_entr 0.6677355170249939
Test Epoch43 layer3 Acc 0.5041, AUC 0.50565105676651, avg_entr 0.6844716668128967
Test Epoch43 layer4 Acc 0.5006, AUC 0.502580463886261, avg_entr 0.690697431564331
gc 0
Train Epoch44 Acc 0.50535 (20214/40000), AUC 0.5058398842811584
Test Epoch44 layer0 Acc 0.8055, AUC 0.8906288146972656, avg_entr 0.04560314118862152
Test Epoch44 layer1 Acc 0.5126, AUC 0.5164468288421631, avg_entr 0.680273711681366
Test Epoch44 layer2 Acc 0.5075, AUC 0.5080375671386719, avg_entr 0.6676294207572937
Test Epoch44 layer3 Acc 0.504, AUC 0.5054150819778442, avg_entr 0.6846514940261841
Test Epoch44 layer4 Acc 0.5006, AUC 0.5007046461105347, avg_entr 0.6906638741493225
gc 0
Train Epoch45 Acc 0.50535 (20214/40000), AUC 0.506710410118103
Test Epoch45 layer0 Acc 0.8181, AUC 0.8949189186096191, avg_entr 0.05059080943465233
Test Epoch45 layer1 Acc 0.5128, AUC 0.4909670054912567, avg_entr 0.6801234483718872
Test Epoch45 layer2 Acc 0.5074, AUC 0.5063176155090332, avg_entr 0.6675536036491394
Test Epoch45 layer3 Acc 0.5039, AUC 0.5023306012153625, avg_entr 0.6847249269485474
Test Epoch45 layer4 Acc 0.5006, AUC 0.5001273155212402, avg_entr 0.6906424760818481
gc 0
Train Epoch46 Acc 0.50535 (20214/40000), AUC 0.5036557912826538
Test Epoch46 layer0 Acc 0.807, AUC 0.889388918876648, avg_entr 0.03702537715435028
Test Epoch46 layer1 Acc 0.5126, AUC 0.5225611925125122, avg_entr 0.6799182891845703
Test Epoch46 layer2 Acc 0.5076, AUC 0.5094563364982605, avg_entr 0.6671740412712097
Test Epoch46 layer3 Acc 0.5041, AUC 0.5088096857070923, avg_entr 0.6841893792152405
Test Epoch46 layer4 Acc 0.5006, AUC 0.5031200051307678, avg_entr 0.6905800104141235
gc 0
Train Epoch47 Acc 0.505325 (20213/40000), AUC 0.5035017728805542
Test Epoch47 layer0 Acc 0.8054, AUC 0.8889084458351135, avg_entr 0.03791579604148865
Test Epoch47 layer1 Acc 0.5124, AUC 0.5254735946655273, avg_entr 0.6798118948936462
Test Epoch47 layer2 Acc 0.5076, AUC 0.5142159461975098, avg_entr 0.66695636510849
Test Epoch47 layer3 Acc 0.504, AUC 0.50780189037323, avg_entr 0.6841692924499512
Test Epoch47 layer4 Acc 0.5006, AUC 0.5011755228042603, avg_entr 0.6905404329299927
gc 0
Train Epoch48 Acc 0.50535 (20214/40000), AUC 0.5022716522216797
Test Epoch48 layer0 Acc 0.8106, AUC 0.8887920379638672, avg_entr 0.03760755434632301
Test Epoch48 layer1 Acc 0.5124, AUC 0.5252357721328735, avg_entr 0.6796858906745911
Test Epoch48 layer2 Acc 0.5075, AUC 0.5114068984985352, avg_entr 0.6667643785476685
Test Epoch48 layer3 Acc 0.504, AUC 0.5040897130966187, avg_entr 0.6841133236885071
Test Epoch48 layer4 Acc 0.5006, AUC 0.5000225901603699, avg_entr 0.690498948097229
gc 0
Train Epoch49 Acc 0.50535 (20214/40000), AUC 0.5048922300338745
Test Epoch49 layer0 Acc 0.8092, AUC 0.8884422779083252, avg_entr 0.033179596066474915
Test Epoch49 layer1 Acc 0.5126, AUC 0.521315336227417, avg_entr 0.6795617341995239
Test Epoch49 layer2 Acc 0.5076, AUC 0.5083738565444946, avg_entr 0.6665799617767334
Test Epoch49 layer3 Acc 0.504, AUC 0.5087293386459351, avg_entr 0.6841681599617004
Test Epoch49 layer4 Acc 0.5006, AUC 0.5019669532775879, avg_entr 0.6904609203338623
Best AUC 0.895058274269104
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_lstmalside_l5_side750//imdb_lstmalside_l5_side.pt
[[4046  962]
 [ 903 4089]]
Figure(640x480)
tensor([0.1330, 0.0003, 0.0015,  ..., 0.0010, 0.0040, 0.0007])
[[ 727 4281]
 [ 590 4402]]
Figure(640x480)
tensor([0.6944, 0.6944, 0.6944,  ..., 0.6944, 0.6944, 0.6944])
[[ 367 4641]
 [ 286 4706]]
Figure(640x480)
tensor([0.6937, 0.6937, 0.6937,  ..., 0.6937, 0.6937, 0.6937])
[[ 200 4808]
 [ 151 4841]]
Figure(640x480)
tensor([0.6945, 0.6945, 0.6945,  ..., 0.6945, 0.6945, 0.6945])
[[  85 4923]
 [  71 4921]]
Figure(640x480)
tensor([0.6947, 0.6947, 0.6947,  ..., 0.6947, 0.6947, 0.6947])
