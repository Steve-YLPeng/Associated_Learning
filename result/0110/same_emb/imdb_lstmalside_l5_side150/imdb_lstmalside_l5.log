total count words 222751
vocab size 30000
found 27937 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList()
  (emb): Embedding(30000, 300)
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb.weight 9000000
Total Trainable Params: 12937378
Start Training
gc 0
Train Epoch0 Acc 0.5029 (20116/40000), AUC 0.5051214694976807
Test Epoch0 layer0 Acc 0.4962, AUC 0.5083318948745728, avg_entr 0.6943937540054321
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.4966, AUC 0.5084312558174133, avg_entr 0.6948819160461426
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.4966, AUC 0.5100319385528564, avg_entr 0.6941021680831909
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer3 Acc 0.4965, AUC 0.4931625723838806, avg_entr 0.6950757503509521
Test Epoch0 layer4 Acc 0.4959, AUC 0.4995819628238678, avg_entr 0.6944852471351624
gc 0
Train Epoch1 Acc 0.499975 (19999/40000), AUC 0.5050991773605347
Test Epoch1 layer0 Acc 0.4997, AUC 0.513522744178772, avg_entr 0.691490888595581
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.5066, AUC 0.5183959603309631, avg_entr 0.6919859647750854
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.5108, AUC 0.5189809799194336, avg_entr 0.6918671131134033
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer3 Acc 0.501, AUC 0.5155460834503174, avg_entr 0.6918797492980957
Test Epoch1 layer4 Acc 0.4984, AUC 0.5054571032524109, avg_entr 0.6918799877166748
gc 0
Train Epoch2 Acc 0.51195 (20478/40000), AUC 0.515756368637085
Test Epoch2 layer0 Acc 0.5092, AUC 0.5190279483795166, avg_entr 0.6932381391525269
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.5129, AUC 0.5272079706192017, avg_entr 0.6927337646484375
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.5079, AUC 0.5252326130867004, avg_entr 0.6933721899986267
Test Epoch2 layer3 Acc 0.5128, AUC 0.5245543718338013, avg_entr 0.6923412680625916
Test Epoch2 layer4 Acc 0.5098, AUC 0.5152628421783447, avg_entr 0.6925457119941711
gc 0
Train Epoch3 Acc 0.51405 (20562/40000), AUC 0.5216960906982422
Test Epoch3 layer0 Acc 0.5105, AUC 0.5235506296157837, avg_entr 0.6911478042602539
Test Epoch3 layer1 Acc 0.5178, AUC 0.5319328308105469, avg_entr 0.6911898851394653
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.5193, AUC 0.5299724340438843, avg_entr 0.6925621032714844
Test Epoch3 layer3 Acc 0.5185, AUC 0.5289919376373291, avg_entr 0.6916387677192688
Test Epoch3 layer4 Acc 0.5025, AUC 0.5156662464141846, avg_entr 0.6919305324554443
gc 0
Train Epoch4 Acc 0.517525 (20701/40000), AUC 0.5273726582527161
Test Epoch4 layer0 Acc 0.5129, AUC 0.526315450668335, avg_entr 0.6895601749420166
Test Epoch4 layer1 Acc 0.516, AUC 0.5344132781028748, avg_entr 0.6895474195480347
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.5165, AUC 0.5325620174407959, avg_entr 0.6890788078308105
Test Epoch4 layer3 Acc 0.52, AUC 0.5315704941749573, avg_entr 0.6891946792602539
Test Epoch4 layer4 Acc 0.5158, AUC 0.518606424331665, avg_entr 0.6902978420257568
gc 0
Train Epoch5 Acc 0.519125 (20765/40000), AUC 0.5276976823806763
Test Epoch5 layer0 Acc 0.5182, AUC 0.5288628339767456, avg_entr 0.6894288659095764
Test Epoch5 layer1 Acc 0.5274, AUC 0.5364053249359131, avg_entr 0.688807487487793
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.5189, AUC 0.5358226299285889, avg_entr 0.6872872114181519
Test Epoch5 layer3 Acc 0.5206, AUC 0.533684253692627, avg_entr 0.6878699660301208
Test Epoch5 layer4 Acc 0.5037, AUC 0.5233879089355469, avg_entr 0.6897084712982178
gc 0
Train Epoch6 Acc 0.521625 (20865/40000), AUC 0.5323216915130615
Test Epoch6 layer0 Acc 0.5221, AUC 0.5343859791755676, avg_entr 0.6875401139259338
Test Epoch6 layer1 Acc 0.5287, AUC 0.5449678897857666, avg_entr 0.6851243376731873
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer2 Acc 0.526, AUC 0.5396100282669067, avg_entr 0.684807300567627
Test Epoch6 layer3 Acc 0.5222, AUC 0.5362188816070557, avg_entr 0.6859058737754822
Test Epoch6 layer4 Acc 0.5171, AUC 0.5225154757499695, avg_entr 0.6901231408119202
gc 0
Train Epoch7 Acc 0.525875 (21035/40000), AUC 0.5387674570083618
Test Epoch7 layer0 Acc 0.5673, AUC 0.5950802564620972, avg_entr 0.670266330242157
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer1 Acc 0.5653, AUC 0.595223605632782, avg_entr 0.6551811099052429
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer2 Acc 0.5529, AUC 0.5697747468948364, avg_entr 0.6771475076675415
Test Epoch7 layer3 Acc 0.5244, AUC 0.5397209525108337, avg_entr 0.6828382611274719
Test Epoch7 layer4 Acc 0.5062, AUC 0.5282866954803467, avg_entr 0.6882232427597046
gc 0
Train Epoch8 Acc 0.52675 (21070/40000), AUC 0.5407122373580933
Test Epoch8 layer0 Acc 0.5963, AUC 0.6379221677780151, avg_entr 0.6063030958175659
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer1 Acc 0.617, AUC 0.6586828231811523, avg_entr 0.5812625288963318
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer2 Acc 0.6187, AUC 0.6606185436248779, avg_entr 0.5788319110870361
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer3 Acc 0.5357, AUC 0.5513870716094971, avg_entr 0.6764729619026184
Test Epoch8 layer4 Acc 0.5195, AUC 0.5303838849067688, avg_entr 0.6879659295082092
gc 0
Train Epoch9 Acc 0.529425 (21177/40000), AUC 0.5451101064682007
Test Epoch9 layer0 Acc 0.6232, AUC 0.6679105758666992, avg_entr 0.5670129656791687
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer1 Acc 0.629, AUC 0.6883804202079773, avg_entr 0.524042546749115
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer2 Acc 0.617, AUC 0.6916133165359497, avg_entr 0.4863685667514801
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer3 Acc 0.5821, AUC 0.643798828125, avg_entr 0.508293092250824
Test Epoch9 layer4 Acc 0.5206, AUC 0.5451172590255737, avg_entr 0.6848307847976685
gc 0
Train Epoch10 Acc 0.60105 (24042/40000), AUC 0.643048107624054
Test Epoch10 layer0 Acc 0.6178, AUC 0.6932268142700195, avg_entr 0.4889754354953766
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer1 Acc 0.6261, AUC 0.7115495204925537, avg_entr 0.44854936003685
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer2 Acc 0.6286, AUC 0.716575026512146, avg_entr 0.4413306713104248
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer3 Acc 0.6319, AUC 0.7053850889205933, avg_entr 0.4571481943130493
Test Epoch10 layer4 Acc 0.6241, AUC 0.688905656337738, avg_entr 0.501487672328949
gc 0
Train Epoch11 Acc 0.670225 (26809/40000), AUC 0.7255179286003113
Test Epoch11 layer0 Acc 0.6539, AUC 0.7153192758560181, avg_entr 0.45774713158607483
Test Epoch11 layer1 Acc 0.6762, AUC 0.7387946844100952, avg_entr 0.40862616896629333
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer2 Acc 0.6807, AUC 0.7489770650863647, avg_entr 0.39011314511299133
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer3 Acc 0.6849, AUC 0.7472419738769531, avg_entr 0.38517481088638306
Test Epoch11 layer4 Acc 0.6818, AUC 0.743104100227356, avg_entr 0.4205470681190491
gc 0
Train Epoch12 Acc 0.692325 (27693/40000), AUC 0.7594161629676819
Test Epoch12 layer0 Acc 0.6356, AUC 0.7259944677352905, avg_entr 0.4101128876209259
Test Epoch12 layer1 Acc 0.6207, AUC 0.7484551072120667, avg_entr 0.32129091024398804
Test Epoch12 layer2 Acc 0.611, AUC 0.7567188739776611, avg_entr 0.27789488434791565
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 12
Test Epoch12 layer3 Acc 0.5937, AUC 0.7506173849105835, avg_entr 0.2539837062358856
Test Epoch12 layer4 Acc 0.5833, AUC 0.7410634756088257, avg_entr 0.25457558035850525
gc 0
Train Epoch13 Acc 0.7155 (28620/40000), AUC 0.7837085723876953
Test Epoch13 layer0 Acc 0.6678, AUC 0.7390769720077515, avg_entr 0.4153337776660919
Test Epoch13 layer1 Acc 0.6851, AUC 0.7619414329528809, avg_entr 0.38237830996513367
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer2 Acc 0.6908, AUC 0.7749537229537964, avg_entr 0.3706464171409607
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer3 Acc 0.6903, AUC 0.778220534324646, avg_entr 0.36258724331855774
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer4 Acc 0.6939, AUC 0.7785234451293945, avg_entr 0.3618008494377136
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.726875 (29075/40000), AUC 0.8009256720542908
Test Epoch14 layer0 Acc 0.6546, AUC 0.7465298175811768, avg_entr 0.3405171036720276
Test Epoch14 layer1 Acc 0.6763, AUC 0.7727895975112915, avg_entr 0.27831390500068665
Test Epoch14 layer2 Acc 0.6851, AUC 0.784546971321106, avg_entr 0.25894808769226074
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 14
Test Epoch14 layer3 Acc 0.6914, AUC 0.7863579988479614, avg_entr 0.23992197215557098
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 14
Test Epoch14 layer4 Acc 0.6912, AUC 0.783220648765564, avg_entr 0.2453608363866806
gc 0
Train Epoch15 Acc 0.729225 (29169/40000), AUC 0.807694673538208
Test Epoch15 layer0 Acc 0.6799, AUC 0.7524955868721008, avg_entr 0.3450755774974823
Test Epoch15 layer1 Acc 0.7019, AUC 0.7793916463851929, avg_entr 0.303035169839859
Test Epoch15 layer2 Acc 0.7103, AUC 0.7929607629776001, avg_entr 0.2760281264781952
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 15
Test Epoch15 layer3 Acc 0.7159, AUC 0.7980566024780273, avg_entr 0.23868972063064575
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 15
Test Epoch15 layer4 Acc 0.7049, AUC 0.7901761531829834, avg_entr 0.23971587419509888
gc 0
Train Epoch16 Acc 0.740025 (29601/40000), AUC 0.8210130929946899
Test Epoch16 layer0 Acc 0.686, AUC 0.7614176273345947, avg_entr 0.3271952271461487
Test Epoch16 layer1 Acc 0.7092, AUC 0.7881685495376587, avg_entr 0.2936062812805176
Test Epoch16 layer2 Acc 0.7237, AUC 0.8026111125946045, avg_entr 0.2631204128265381
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 16
Test Epoch16 layer3 Acc 0.7273, AUC 0.808550238609314, avg_entr 0.23371601104736328
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 16
Test Epoch16 layer4 Acc 0.7124, AUC 0.793458104133606, avg_entr 0.24544845521450043
gc 0
Train Epoch17 Acc 0.759375 (30375/40000), AUC 0.8435008525848389
Test Epoch17 layer0 Acc 0.6961, AUC 0.7671611309051514, avg_entr 0.30606234073638916
Test Epoch17 layer1 Acc 0.7184, AUC 0.7946619987487793, avg_entr 0.2573651373386383
Test Epoch17 layer2 Acc 0.7282, AUC 0.8082908391952515, avg_entr 0.24008017778396606
Test Epoch17 layer3 Acc 0.7311, AUC 0.813855767250061, avg_entr 0.22214697301387787
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 17
Test Epoch17 layer4 Acc 0.7168, AUC 0.798783540725708, avg_entr 0.23630204796791077
gc 0
Train Epoch18 Acc 0.772075 (30883/40000), AUC 0.8548368215560913
Test Epoch18 layer0 Acc 0.6915, AUC 0.7711226940155029, avg_entr 0.2903798818588257
Test Epoch18 layer1 Acc 0.722, AUC 0.8000820279121399, avg_entr 0.22371767461299896
Test Epoch18 layer2 Acc 0.734, AUC 0.8131765127182007, avg_entr 0.18993954360485077
Test Epoch18 layer3 Acc 0.737, AUC 0.8173149824142456, avg_entr 0.16333884000778198
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 18
Test Epoch18 layer4 Acc 0.7144, AUC 0.7978062629699707, avg_entr 0.1906827688217163
gc 0
Train Epoch19 Acc 0.783275 (31331/40000), AUC 0.8664065599441528
Test Epoch19 layer0 Acc 0.6983, AUC 0.7766076326370239, avg_entr 0.2575012445449829
Test Epoch19 layer1 Acc 0.7283, AUC 0.8059095144271851, avg_entr 0.21134719252586365
Test Epoch19 layer2 Acc 0.7375, AUC 0.818734884262085, avg_entr 0.18835918605327606
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 19
Test Epoch19 layer3 Acc 0.7442, AUC 0.8243980407714844, avg_entr 0.1784297078847885
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 19
Test Epoch19 layer4 Acc 0.7385, AUC 0.8203079700469971, avg_entr 0.18381470441818237
gc 0
Train Epoch20 Acc 0.79775 (31910/40000), AUC 0.8787519931793213
Test Epoch20 layer0 Acc 0.6862, AUC 0.7783349752426147, avg_entr 0.22618044912815094
Test Epoch20 layer1 Acc 0.6952, AUC 0.8061081171035767, avg_entr 0.16885018348693848
Test Epoch20 layer2 Acc 0.6995, AUC 0.8184176683425903, avg_entr 0.14250193536281586
Test Epoch20 layer3 Acc 0.7029, AUC 0.8193269371986389, avg_entr 0.13438290357589722
Test Epoch20 layer4 Acc 0.6959, AUC 0.7791941165924072, avg_entr 0.16531850397586823
gc 0
Train Epoch21 Acc 0.809575 (32383/40000), AUC 0.886766791343689
Test Epoch21 layer0 Acc 0.6997, AUC 0.7819087505340576, avg_entr 0.23964202404022217
Test Epoch21 layer1 Acc 0.7225, AUC 0.8096787929534912, avg_entr 0.21688103675842285
Test Epoch21 layer2 Acc 0.7327, AUC 0.8216639161109924, avg_entr 0.1989542692899704
Test Epoch21 layer3 Acc 0.7358, AUC 0.8273933529853821, avg_entr 0.19920320808887482
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 21
Test Epoch21 layer4 Acc 0.7321, AUC 0.8277156949043274, avg_entr 0.19912703335285187
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 21
gc 0
Train Epoch22 Acc 0.823125 (32925/40000), AUC 0.8995360732078552
Test Epoch22 layer0 Acc 0.7068, AUC 0.7850813865661621, avg_entr 0.2154274433851242
Test Epoch22 layer1 Acc 0.7315, AUC 0.814084529876709, avg_entr 0.1743929386138916
Test Epoch22 layer2 Acc 0.7464, AUC 0.8257260322570801, avg_entr 0.15254801511764526
Test Epoch22 layer3 Acc 0.7492, AUC 0.8313601016998291, avg_entr 0.14644873142242432
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 22
Test Epoch22 layer4 Acc 0.7503, AUC 0.8311881422996521, avg_entr 0.14462818205356598
gc 0
Train Epoch23 Acc 0.83305 (33322/40000), AUC 0.908467710018158
Test Epoch23 layer0 Acc 0.7063, AUC 0.7834367752075195, avg_entr 0.18757127225399017
Test Epoch23 layer1 Acc 0.7261, AUC 0.8106793761253357, avg_entr 0.14463166892528534
Test Epoch23 layer2 Acc 0.7385, AUC 0.82140052318573, avg_entr 0.12408040463924408
Test Epoch23 layer3 Acc 0.7411, AUC 0.8258143663406372, avg_entr 0.123112253844738
Test Epoch23 layer4 Acc 0.7376, AUC 0.8248769640922546, avg_entr 0.12079194188117981
gc 0
Train Epoch24 Acc 0.836875 (33475/40000), AUC 0.9129872918128967
Test Epoch24 layer0 Acc 0.7105, AUC 0.7860209941864014, avg_entr 0.19557739794254303
Test Epoch24 layer1 Acc 0.7357, AUC 0.8151311278343201, avg_entr 0.15139080584049225
Test Epoch24 layer2 Acc 0.7458, AUC 0.8274948000907898, avg_entr 0.13614673912525177
Test Epoch24 layer3 Acc 0.7511, AUC 0.8320029377937317, avg_entr 0.1266300082206726
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 24
Test Epoch24 layer4 Acc 0.7483, AUC 0.8306258320808411, avg_entr 0.12184201925992966
gc 0
Train Epoch25 Acc 0.850675 (34027/40000), AUC 0.9230375289916992
Test Epoch25 layer0 Acc 0.7101, AUC 0.786966860294342, avg_entr 0.18355779349803925
Test Epoch25 layer1 Acc 0.7358, AUC 0.815769374370575, avg_entr 0.14158995449543
Test Epoch25 layer2 Acc 0.7469, AUC 0.8276944756507874, avg_entr 0.120619997382164
Test Epoch25 layer3 Acc 0.7491, AUC 0.8336480855941772, avg_entr 0.11852448433637619
Save ckpt to ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt  ,ep 25
Test Epoch25 layer4 Acc 0.7515, AUC 0.8334132432937622, avg_entr 0.11587623506784439
gc 0
Train Epoch26 Acc 0.851775 (34071/40000), AUC 0.9244722127914429
Test Epoch26 layer0 Acc 0.7145, AUC 0.7868849635124207, avg_entr 0.17481662333011627
Test Epoch26 layer1 Acc 0.7366, AUC 0.815317690372467, avg_entr 0.11795733869075775
Test Epoch26 layer2 Acc 0.7472, AUC 0.8252185583114624, avg_entr 0.09600076824426651
Test Epoch26 layer3 Acc 0.7518, AUC 0.8296153545379639, avg_entr 0.08496285229921341
Test Epoch26 layer4 Acc 0.7498, AUC 0.8292720317840576, avg_entr 0.07892076671123505
gc 0
Train Epoch27 Acc 0.86455 (34582/40000), AUC 0.9330528974533081
Test Epoch27 layer0 Acc 0.7129, AUC 0.7891652584075928, avg_entr 0.16236759722232819
Test Epoch27 layer1 Acc 0.7405, AUC 0.816550612449646, avg_entr 0.11429057270288467
Test Epoch27 layer2 Acc 0.7499, AUC 0.8283530473709106, avg_entr 0.09569282084703445
Test Epoch27 layer3 Acc 0.7564, AUC 0.8318147659301758, avg_entr 0.0812392607331276
Test Epoch27 layer4 Acc 0.7549, AUC 0.8303039073944092, avg_entr 0.07537396252155304
gc 0
Train Epoch28 Acc 0.86725 (34690/40000), AUC 0.9357534646987915
Test Epoch28 layer0 Acc 0.711, AUC 0.787980318069458, avg_entr 0.14606040716171265
Test Epoch28 layer1 Acc 0.7359, AUC 0.8161851167678833, avg_entr 0.09635042399168015
Test Epoch28 layer2 Acc 0.7463, AUC 0.8265712857246399, avg_entr 0.08078751713037491
Test Epoch28 layer3 Acc 0.7496, AUC 0.8287707567214966, avg_entr 0.06787335127592087
Test Epoch28 layer4 Acc 0.7499, AUC 0.8267747163772583, avg_entr 0.05884109064936638
gc 0
Train Epoch29 Acc 0.86845 (34738/40000), AUC 0.9376844167709351
Test Epoch29 layer0 Acc 0.708, AUC 0.7874149680137634, avg_entr 0.14394274353981018
Test Epoch29 layer1 Acc 0.7337, AUC 0.8153105974197388, avg_entr 0.09417401999235153
Test Epoch29 layer2 Acc 0.7428, AUC 0.8247584700584412, avg_entr 0.07500521838665009
Test Epoch29 layer3 Acc 0.7479, AUC 0.8228296637535095, avg_entr 0.06452973186969757
Test Epoch29 layer4 Acc 0.7467, AUC 0.8213804960250854, avg_entr 0.05705346539616585
gc 0
Train Epoch30 Acc 0.88585 (35434/40000), AUC 0.9502427577972412
Test Epoch30 layer0 Acc 0.7119, AUC 0.7874965667724609, avg_entr 0.12766380608081818
Test Epoch30 layer1 Acc 0.7357, AUC 0.8143327832221985, avg_entr 0.0847412571310997
Test Epoch30 layer2 Acc 0.7484, AUC 0.8264720439910889, avg_entr 0.07695744931697845
Test Epoch30 layer3 Acc 0.7538, AUC 0.8322104215621948, avg_entr 0.07654961198568344
Test Epoch30 layer4 Acc 0.7523, AUC 0.8309670090675354, avg_entr 0.07257075607776642
gc 0
Train Epoch31 Acc 0.89265 (35706/40000), AUC 0.9559764862060547
Test Epoch31 layer0 Acc 0.7131, AUC 0.7835216522216797, avg_entr 0.12021946907043457
Test Epoch31 layer1 Acc 0.733, AUC 0.8113605976104736, avg_entr 0.08581747859716415
Test Epoch31 layer2 Acc 0.7383, AUC 0.821427583694458, avg_entr 0.07790135592222214
Test Epoch31 layer3 Acc 0.7408, AUC 0.8257623910903931, avg_entr 0.07506358623504639
Test Epoch31 layer4 Acc 0.7399, AUC 0.8269129395484924, avg_entr 0.06952106952667236
gc 0
Train Epoch32 Acc 0.90825 (36330/40000), AUC 0.9640712738037109
Test Epoch32 layer0 Acc 0.7103, AUC 0.7860129475593567, avg_entr 0.10872175544500351
Test Epoch32 layer1 Acc 0.7374, AUC 0.812400221824646, avg_entr 0.08292874693870544
Test Epoch32 layer2 Acc 0.7494, AUC 0.8239426016807556, avg_entr 0.0683073177933693
Test Epoch32 layer3 Acc 0.7536, AUC 0.8277463316917419, avg_entr 0.060152001678943634
Test Epoch32 layer4 Acc 0.7547, AUC 0.8275825381278992, avg_entr 0.05497477948665619
gc 0
Train Epoch33 Acc 0.909725 (36389/40000), AUC 0.9661808013916016
Test Epoch33 layer0 Acc 0.7134, AUC 0.784645676612854, avg_entr 0.10694791376590729
Test Epoch33 layer1 Acc 0.7347, AUC 0.8092430233955383, avg_entr 0.0805138498544693
Test Epoch33 layer2 Acc 0.7447, AUC 0.8206138610839844, avg_entr 0.07109999656677246
Test Epoch33 layer3 Acc 0.7512, AUC 0.8253085613250732, avg_entr 0.06574486941099167
Test Epoch33 layer4 Acc 0.7495, AUC 0.8257126808166504, avg_entr 0.06250278651714325
gc 0
Train Epoch34 Acc 0.916125 (36645/40000), AUC 0.968522310256958
Test Epoch34 layer0 Acc 0.7116, AUC 0.7830829620361328, avg_entr 0.10239975899457932
Test Epoch34 layer1 Acc 0.7364, AUC 0.8086622953414917, avg_entr 0.07348091155290604
Test Epoch34 layer2 Acc 0.7467, AUC 0.8196709752082825, avg_entr 0.06585416197776794
Test Epoch34 layer3 Acc 0.7547, AUC 0.8254315853118896, avg_entr 0.06519876420497894
Test Epoch34 layer4 Acc 0.7545, AUC 0.8266875743865967, avg_entr 0.05905546247959137
gc 0
Train Epoch35 Acc 0.9191 (36764/40000), AUC 0.9715025424957275
Test Epoch35 layer0 Acc 0.7125, AUC 0.782478928565979, avg_entr 0.09433829039335251
Test Epoch35 layer1 Acc 0.7354, AUC 0.8072724342346191, avg_entr 0.07414478063583374
Test Epoch35 layer2 Acc 0.7458, AUC 0.8192718625068665, avg_entr 0.0676640048623085
Test Epoch35 layer3 Acc 0.7499, AUC 0.8255940675735474, avg_entr 0.06736044585704803
Test Epoch35 layer4 Acc 0.7525, AUC 0.8265936374664307, avg_entr 0.06222463399171829
gc 0
Train Epoch36 Acc 0.926675 (37067/40000), AUC 0.9750078916549683
Test Epoch36 layer0 Acc 0.7123, AUC 0.7824257016181946, avg_entr 0.0868646651506424
Test Epoch36 layer1 Acc 0.7322, AUC 0.80613112449646, avg_entr 0.059220775961875916
Test Epoch36 layer2 Acc 0.7415, AUC 0.8177133798599243, avg_entr 0.049926795065402985
Test Epoch36 layer3 Acc 0.7476, AUC 0.8208099603652954, avg_entr 0.04715702310204506
Test Epoch36 layer4 Acc 0.7483, AUC 0.8209848999977112, avg_entr 0.04324963688850403
gc 0
Train Epoch37 Acc 0.928875 (37155/40000), AUC 0.9757441282272339
Test Epoch37 layer0 Acc 0.7088, AUC 0.7799831628799438, avg_entr 0.08885606378316879
Test Epoch37 layer1 Acc 0.7294, AUC 0.8027636408805847, avg_entr 0.06126415356993675
Test Epoch37 layer2 Acc 0.7418, AUC 0.8123651742935181, avg_entr 0.05477593466639519
Test Epoch37 layer3 Acc 0.7484, AUC 0.8180195689201355, avg_entr 0.052120257169008255
Test Epoch37 layer4 Acc 0.7499, AUC 0.8190737962722778, avg_entr 0.04665017127990723
gc 0
Train Epoch38 Acc 0.93145 (37258/40000), AUC 0.9768003225326538
Test Epoch38 layer0 Acc 0.7119, AUC 0.7807024717330933, avg_entr 0.08410818129777908
Test Epoch38 layer1 Acc 0.7322, AUC 0.8038471937179565, avg_entr 0.0626550242304802
Test Epoch38 layer2 Acc 0.7431, AUC 0.8154764175415039, avg_entr 0.05412298068404198
Test Epoch38 layer3 Acc 0.7504, AUC 0.8202306628227234, avg_entr 0.05124109983444214
Test Epoch38 layer4 Acc 0.7514, AUC 0.8214231729507446, avg_entr 0.04487387835979462
gc 0
Train Epoch39 Acc 0.9315 (37260/40000), AUC 0.9776144027709961
Test Epoch39 layer0 Acc 0.7104, AUC 0.7798693180084229, avg_entr 0.07983673363924026
Test Epoch39 layer1 Acc 0.732, AUC 0.8020941019058228, avg_entr 0.05091177299618721
Test Epoch39 layer2 Acc 0.7407, AUC 0.8126766681671143, avg_entr 0.04542038217186928
Test Epoch39 layer3 Acc 0.7491, AUC 0.817460298538208, avg_entr 0.044481098651885986
Test Epoch39 layer4 Acc 0.7494, AUC 0.8189606666564941, avg_entr 0.0395558699965477
gc 0
Train Epoch40 Acc 0.936775 (37471/40000), AUC 0.9794254302978516
Test Epoch40 layer0 Acc 0.7096, AUC 0.77864670753479, avg_entr 0.07657145708799362
Test Epoch40 layer1 Acc 0.7295, AUC 0.8005293607711792, avg_entr 0.05464177206158638
Test Epoch40 layer2 Acc 0.7406, AUC 0.809847891330719, avg_entr 0.047061044722795486
Test Epoch40 layer3 Acc 0.7416, AUC 0.814948320388794, avg_entr 0.044106416404247284
Test Epoch40 layer4 Acc 0.7427, AUC 0.8165192604064941, avg_entr 0.039660170674324036
gc 0
Train Epoch41 Acc 0.93815 (37526/40000), AUC 0.9799883365631104
Test Epoch41 layer0 Acc 0.7111, AUC 0.7788619995117188, avg_entr 0.07747243344783783
Test Epoch41 layer1 Acc 0.7318, AUC 0.8005201816558838, avg_entr 0.050908513367176056
Test Epoch41 layer2 Acc 0.7405, AUC 0.810067355632782, avg_entr 0.04107934236526489
Test Epoch41 layer3 Acc 0.7474, AUC 0.8146189451217651, avg_entr 0.0403716005384922
Test Epoch41 layer4 Acc 0.7477, AUC 0.8163450956344604, avg_entr 0.03542861342430115
gc 0
Train Epoch42 Acc 0.939675 (37587/40000), AUC 0.9809259176254272
Test Epoch42 layer0 Acc 0.7085, AUC 0.7787113189697266, avg_entr 0.07264265418052673
Test Epoch42 layer1 Acc 0.7302, AUC 0.7995564937591553, avg_entr 0.04830130189657211
Test Epoch42 layer2 Acc 0.7412, AUC 0.8102723360061646, avg_entr 0.039434149861335754
Test Epoch42 layer3 Acc 0.7474, AUC 0.8143497705459595, avg_entr 0.03775864467024803
Test Epoch42 layer4 Acc 0.747, AUC 0.8158682584762573, avg_entr 0.03308272734284401
gc 0
Train Epoch43 Acc 0.9403 (37612/40000), AUC 0.980832576751709
Test Epoch43 layer0 Acc 0.7092, AUC 0.7777422070503235, avg_entr 0.07549991458654404
Test Epoch43 layer1 Acc 0.7303, AUC 0.799149751663208, avg_entr 0.05045530945062637
Test Epoch43 layer2 Acc 0.7394, AUC 0.8098074197769165, avg_entr 0.04417239502072334
Test Epoch43 layer3 Acc 0.7478, AUC 0.8149168491363525, avg_entr 0.0432170070707798
Test Epoch43 layer4 Acc 0.7487, AUC 0.8164932131767273, avg_entr 0.03796150162816048
gc 0
Train Epoch44 Acc 0.9432 (37728/40000), AUC 0.9817623496055603
Test Epoch44 layer0 Acc 0.7094, AUC 0.7780590057373047, avg_entr 0.0712130218744278
Test Epoch44 layer1 Acc 0.7305, AUC 0.7989064455032349, avg_entr 0.0468762144446373
Test Epoch44 layer2 Acc 0.7389, AUC 0.8085631132125854, avg_entr 0.038479033857584
Test Epoch44 layer3 Acc 0.7449, AUC 0.8128721714019775, avg_entr 0.03545220196247101
Test Epoch44 layer4 Acc 0.7458, AUC 0.8149552345275879, avg_entr 0.031567398458719254
gc 0
Train Epoch45 Acc 0.943225 (37729/40000), AUC 0.9822107553482056
Test Epoch45 layer0 Acc 0.7093, AUC 0.7764900326728821, avg_entr 0.07047528028488159
Test Epoch45 layer1 Acc 0.73, AUC 0.7971190214157104, avg_entr 0.047169238328933716
Test Epoch45 layer2 Acc 0.7377, AUC 0.8072237968444824, avg_entr 0.03765324503183365
Test Epoch45 layer3 Acc 0.7459, AUC 0.8115766048431396, avg_entr 0.03587333858013153
Test Epoch45 layer4 Acc 0.7467, AUC 0.8133218288421631, avg_entr 0.03050839900970459
gc 0
Train Epoch46 Acc 0.94465 (37786/40000), AUC 0.9822348356246948
Test Epoch46 layer0 Acc 0.7081, AUC 0.7763546705245972, avg_entr 0.06817179173231125
Test Epoch46 layer1 Acc 0.729, AUC 0.7969306707382202, avg_entr 0.046475913375616074
Test Epoch46 layer2 Acc 0.7401, AUC 0.8077230453491211, avg_entr 0.038297779858112335
Test Epoch46 layer3 Acc 0.7454, AUC 0.8120659589767456, avg_entr 0.035980913788080215
Test Epoch46 layer4 Acc 0.7451, AUC 0.8136652708053589, avg_entr 0.03166006878018379
gc 0
Train Epoch47 Acc 0.94405 (37762/40000), AUC 0.9823623895645142
Test Epoch47 layer0 Acc 0.7085, AUC 0.7767444252967834, avg_entr 0.06843996047973633
Test Epoch47 layer1 Acc 0.7272, AUC 0.7968899011611938, avg_entr 0.0460081472992897
Test Epoch47 layer2 Acc 0.7372, AUC 0.8063483834266663, avg_entr 0.03846001252532005
Test Epoch47 layer3 Acc 0.7438, AUC 0.8112534880638123, avg_entr 0.03595268726348877
Test Epoch47 layer4 Acc 0.7434, AUC 0.8128833174705505, avg_entr 0.0305523369461298
gc 0
Train Epoch48 Acc 0.946825 (37873/40000), AUC 0.9829915761947632
Test Epoch48 layer0 Acc 0.7086, AUC 0.776336133480072, avg_entr 0.06749417632818222
Test Epoch48 layer1 Acc 0.7294, AUC 0.7966021299362183, avg_entr 0.044409386813640594
Test Epoch48 layer2 Acc 0.7378, AUC 0.8059077858924866, avg_entr 0.03535179793834686
Test Epoch48 layer3 Acc 0.7445, AUC 0.8104612827301025, avg_entr 0.03347232937812805
Test Epoch48 layer4 Acc 0.7434, AUC 0.8123987913131714, avg_entr 0.028672082349658012
gc 0
Train Epoch49 Acc 0.94595 (37838/40000), AUC 0.9829831123352051
Test Epoch49 layer0 Acc 0.7071, AUC 0.7760584950447083, avg_entr 0.06735092401504517
Test Epoch49 layer1 Acc 0.7297, AUC 0.7962645888328552, avg_entr 0.04424978792667389
Test Epoch49 layer2 Acc 0.7359, AUC 0.8060495853424072, avg_entr 0.03586775064468384
Test Epoch49 layer3 Acc 0.7431, AUC 0.8104598522186279, avg_entr 0.03407149761915207
Test Epoch49 layer4 Acc 0.7445, AUC 0.8123939037322998, avg_entr 0.029548918828368187
Best AUC 0.8336480855941772
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_lstmalside_l5_side150//imdb_lstmalside_l5_side.pt
[[3603 1431]
 [1468 3498]]
Figure(640x480)
tensor([0.1551, 0.0611, 0.0931,  ..., 0.6009, 0.0736, 0.0187])
[[3578 1456]
 [1186 3780]]
Figure(640x480)
tensor([0.2156, 0.3486, 0.0282,  ..., 0.1892, 0.0336, 0.0038])
[[3640 1394]
 [1137 3829]]
Figure(640x480)
tensor([0.0307, 0.2013, 0.0080,  ..., 0.1565, 0.0139, 0.0032])
[[3530 1504]
 [1005 3961]]
Figure(640x480)
tensor([0.0676, 0.1555, 0.0065,  ..., 0.0423, 0.0104, 0.0044])
[[3505 1529]
 [ 956 4010]]
Figure(640x480)
tensor([0.0801, 0.0982, 0.0060,  ..., 0.0683, 0.0084, 0.0037])
