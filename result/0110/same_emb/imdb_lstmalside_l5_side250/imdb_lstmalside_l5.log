total count words 222751
vocab size 30000
found 27937 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList()
  (emb): Embedding(30000, 300)
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb.weight 9000000
Total Trainable Params: 12937378
Start Training
gc 0
Train Epoch0 Acc 0.5017 (20068/40000), AUC 0.49971604347229004
Test Epoch0 layer0 Acc 0.499, AUC 0.49579066038131714, avg_entr 0.6895506381988525
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.4983, AUC 0.503269374370575, avg_entr 0.6889931559562683
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.4999, AUC 0.5018478631973267, avg_entr 0.6882265210151672
Test Epoch0 layer3 Acc 0.5012, AUC 0.5084254741668701, avg_entr 0.6888478994369507
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer4 Acc 0.4976, AUC 0.49622687697410583, avg_entr 0.6884264945983887
gc 0
Train Epoch1 Acc 0.503775 (20151/40000), AUC 0.5046068429946899
Test Epoch1 layer0 Acc 0.5052, AUC 0.5075852274894714, avg_entr 0.6904387474060059
Test Epoch1 layer1 Acc 0.513, AUC 0.5156829357147217, avg_entr 0.6898753643035889
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.5044, AUC 0.5077815055847168, avg_entr 0.6911202669143677
Test Epoch1 layer3 Acc 0.5049, AUC 0.5027830600738525, avg_entr 0.689872145652771
Test Epoch1 layer4 Acc 0.4966, AUC 0.4995208978652954, avg_entr 0.6908006072044373
gc 0
Train Epoch2 Acc 0.511975 (20479/40000), AUC 0.5145921111106873
Test Epoch2 layer0 Acc 0.5095, AUC 0.5162370204925537, avg_entr 0.690985381603241
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.5166, AUC 0.5228478908538818, avg_entr 0.6908922791481018
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.5099, AUC 0.5116658210754395, avg_entr 0.6915618777275085
Test Epoch2 layer3 Acc 0.5044, AUC 0.5062195062637329, avg_entr 0.691453218460083
Test Epoch2 layer4 Acc 0.5001, AUC 0.49345797300338745, avg_entr 0.6912270784378052
gc 0
Train Epoch3 Acc 0.507625 (20305/40000), AUC 0.5135542154312134
Test Epoch3 layer0 Acc 0.5065, AUC 0.5226099491119385, avg_entr 0.6894262433052063
Test Epoch3 layer1 Acc 0.5163, AUC 0.526915431022644, avg_entr 0.6894017457962036
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.5117, AUC 0.5122091770172119, avg_entr 0.6896094083786011
Test Epoch3 layer3 Acc 0.508, AUC 0.5056368112564087, avg_entr 0.6904398202896118
Test Epoch3 layer4 Acc 0.5007, AUC 0.4981828033924103, avg_entr 0.6898426413536072
gc 0
Train Epoch4 Acc 0.509525 (20381/40000), AUC 0.5142116546630859
Test Epoch4 layer0 Acc 0.502, AUC 0.5264809131622314, avg_entr 0.6829763650894165
Test Epoch4 layer1 Acc 0.5065, AUC 0.5288517475128174, avg_entr 0.6867779493331909
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.5057, AUC 0.5149275660514832, avg_entr 0.6862086653709412
Test Epoch4 layer3 Acc 0.507, AUC 0.5062291622161865, avg_entr 0.6875842809677124
Test Epoch4 layer4 Acc 0.5033, AUC 0.4978918731212616, avg_entr 0.6855545043945312
gc 0
Train Epoch5 Acc 0.510625 (20425/40000), AUC 0.5180504322052002
Test Epoch5 layer0 Acc 0.5109, AUC 0.529416561126709, avg_entr 0.6903632283210754
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.5195, AUC 0.5306165218353271, avg_entr 0.6892185807228088
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.5092, AUC 0.5172902941703796, avg_entr 0.6905922889709473
Test Epoch5 layer3 Acc 0.5014, AUC 0.5067552328109741, avg_entr 0.691120445728302
Test Epoch5 layer4 Acc 0.5012, AUC 0.50211501121521, avg_entr 0.6910884976387024
gc 0
Train Epoch6 Acc 0.513225 (20529/40000), AUC 0.5196959376335144
Test Epoch6 layer0 Acc 0.5161, AUC 0.5332379937171936, avg_entr 0.6870649456977844
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.5206, AUC 0.5318260192871094, avg_entr 0.6874933838844299
Test Epoch6 layer2 Acc 0.5111, AUC 0.5186761617660522, avg_entr 0.6887322068214417
Test Epoch6 layer3 Acc 0.5017, AUC 0.507626473903656, avg_entr 0.6896201968193054
Test Epoch6 layer4 Acc 0.5035, AUC 0.5054483413696289, avg_entr 0.689657986164093
gc 0
Train Epoch7 Acc 0.512925 (20517/40000), AUC 0.5202841758728027
Test Epoch7 layer0 Acc 0.5264, AUC 0.535947859287262, avg_entr 0.68760746717453
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer1 Acc 0.531, AUC 0.5401977896690369, avg_entr 0.685947597026825
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer2 Acc 0.5103, AUC 0.5201810002326965, avg_entr 0.6883661150932312
Test Epoch7 layer3 Acc 0.5025, AUC 0.5105648636817932, avg_entr 0.689826488494873
Test Epoch7 layer4 Acc 0.5055, AUC 0.5063163042068481, avg_entr 0.6897643804550171
gc 0
Train Epoch8 Acc 0.515275 (20611/40000), AUC 0.5239604711532593
Test Epoch8 layer0 Acc 0.5244, AUC 0.5402747392654419, avg_entr 0.6829503178596497
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer1 Acc 0.5653, AUC 0.5866211652755737, avg_entr 0.6600063443183899
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer2 Acc 0.5126, AUC 0.5215984582901001, avg_entr 0.682077944278717
Test Epoch8 layer3 Acc 0.5089, AUC 0.5131135582923889, avg_entr 0.6875917911529541
Test Epoch8 layer4 Acc 0.506, AUC 0.5067538619041443, avg_entr 0.6862072944641113
gc 0
Train Epoch9 Acc 0.51505 (20602/40000), AUC 0.5238037109375
Test Epoch9 layer0 Acc 0.528, AUC 0.5560992360115051, avg_entr 0.6777021288871765
Test Epoch9 layer1 Acc 0.5783, AUC 0.6061753034591675, avg_entr 0.6217325925827026
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer2 Acc 0.5096, AUC 0.5234425067901611, avg_entr 0.6841251254081726
Test Epoch9 layer3 Acc 0.503, AUC 0.5158067941665649, avg_entr 0.6889148354530334
Test Epoch9 layer4 Acc 0.5029, AUC 0.5060220956802368, avg_entr 0.6886781454086304
gc 0
Train Epoch10 Acc 0.5159 (20636/40000), AUC 0.527320921421051
Test Epoch10 layer0 Acc 0.5417, AUC 0.6130892038345337, avg_entr 0.5548086166381836
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer1 Acc 0.6172, AUC 0.6616103053092957, avg_entr 0.5555750131607056
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer2 Acc 0.5142, AUC 0.5247285962104797, avg_entr 0.6822412014007568
Test Epoch10 layer3 Acc 0.5082, AUC 0.5289484262466431, avg_entr 0.687781810760498
Test Epoch10 layer4 Acc 0.5064, AUC 0.5094431638717651, avg_entr 0.6885679960250854
gc 0
Train Epoch11 Acc 0.51905 (20762/40000), AUC 0.5314847826957703
Test Epoch11 layer0 Acc 0.6272, AUC 0.6759275197982788, avg_entr 0.5177725553512573
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer1 Acc 0.6526, AUC 0.7099901437759399, avg_entr 0.4716264307498932
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer2 Acc 0.5221, AUC 0.5455499887466431, avg_entr 0.6754823327064514
Test Epoch11 layer3 Acc 0.5035, AUC 0.5334041118621826, avg_entr 0.6860807538032532
Test Epoch11 layer4 Acc 0.508, AUC 0.5138493776321411, avg_entr 0.6859315037727356
gc 0
Train Epoch12 Acc 0.523675 (20947/40000), AUC 0.5358250737190247
Test Epoch12 layer0 Acc 0.6496, AUC 0.7099217772483826, avg_entr 0.4561138153076172
Test Epoch12 layer1 Acc 0.6793, AUC 0.7460030913352966, avg_entr 0.40872421860694885
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 12
Test Epoch12 layer2 Acc 0.6792, AUC 0.7390055656433105, avg_entr 0.4347921907901764
Test Epoch12 layer3 Acc 0.5075, AUC 0.5606131553649902, avg_entr 0.6828134655952454
Test Epoch12 layer4 Acc 0.508, AUC 0.5173923373222351, avg_entr 0.6810895800590515
gc 0
Train Epoch13 Acc 0.5226 (20904/40000), AUC 0.5377721786499023
Test Epoch13 layer0 Acc 0.6298, AUC 0.7273419499397278, avg_entr 0.4108971059322357
Test Epoch13 layer1 Acc 0.6349, AUC 0.760593056678772, avg_entr 0.36186811327934265
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer2 Acc 0.6174, AUC 0.7540481090545654, avg_entr 0.33096450567245483
Test Epoch13 layer3 Acc 0.5061, AUC 0.5625805854797363, avg_entr 0.685501217842102
Test Epoch13 layer4 Acc 0.5088, AUC 0.5246059894561768, avg_entr 0.673439621925354
gc 0
Train Epoch14 Acc 0.5257 (21028/40000), AUC 0.5427277088165283
Test Epoch14 layer0 Acc 0.6663, AUC 0.7406829595565796, avg_entr 0.3357257544994354
Test Epoch14 layer1 Acc 0.6862, AUC 0.7736759185791016, avg_entr 0.250784695148468
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 14
Test Epoch14 layer2 Acc 0.6797, AUC 0.7709227800369263, avg_entr 0.21900059282779694
Test Epoch14 layer3 Acc 0.5083, AUC 0.574755072593689, avg_entr 0.683252215385437
Test Epoch14 layer4 Acc 0.5178, AUC 0.5304152369499207, avg_entr 0.656194806098938
gc 0
Train Epoch15 Acc 0.54905 (21962/40000), AUC 0.5781012177467346
Test Epoch15 layer0 Acc 0.6834, AUC 0.7533490657806396, avg_entr 0.3689606785774231
Test Epoch15 layer1 Acc 0.7107, AUC 0.7878223657608032, avg_entr 0.28417596220970154
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 15
Test Epoch15 layer2 Acc 0.7077, AUC 0.7913755178451538, avg_entr 0.24016118049621582
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 15
Test Epoch15 layer3 Acc 0.5101, AUC 0.5339277982711792, avg_entr 0.6795575022697449
Test Epoch15 layer4 Acc 0.7063, AUC 0.7712620496749878, avg_entr 0.5147185325622559
gc 0
Train Epoch16 Acc 0.73775 (29510/40000), AUC 0.7910932302474976
Test Epoch16 layer0 Acc 0.6823, AUC 0.7612724304199219, avg_entr 0.32330381870269775
Test Epoch16 layer1 Acc 0.7184, AUC 0.795563280582428, avg_entr 0.2476104199886322
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 16
Test Epoch16 layer2 Acc 0.7262, AUC 0.8004905581474304, avg_entr 0.23426929116249084
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 16
Test Epoch16 layer3 Acc 0.5067, AUC 0.5633162260055542, avg_entr 0.6797510385513306
Test Epoch16 layer4 Acc 0.7212, AUC 0.796736478805542, avg_entr 0.23542746901512146
gc 0
Train Epoch17 Acc 0.7524 (30096/40000), AUC 0.8201776742935181
Test Epoch17 layer0 Acc 0.695, AUC 0.7684823274612427, avg_entr 0.32458192110061646
Test Epoch17 layer1 Acc 0.7231, AUC 0.8017563819885254, avg_entr 0.25855374336242676
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 17
Test Epoch17 layer2 Acc 0.7268, AUC 0.8064267635345459, avg_entr 0.2337023913860321
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 17
Test Epoch17 layer3 Acc 0.5104, AUC 0.5207592844963074, avg_entr 0.6773651242256165
Test Epoch17 layer4 Acc 0.7265, AUC 0.8046706318855286, avg_entr 0.21565580368041992
gc 0
Train Epoch18 Acc 0.762025 (30481/40000), AUC 0.8378968238830566
Test Epoch18 layer0 Acc 0.7029, AUC 0.7773734331130981, avg_entr 0.30519136786460876
Test Epoch18 layer1 Acc 0.7252, AUC 0.8098029494285583, avg_entr 0.23157595098018646
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 18
Test Epoch18 layer2 Acc 0.733, AUC 0.8143212795257568, avg_entr 0.20913054049015045
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 18
Test Epoch18 layer3 Acc 0.5126, AUC 0.5688074827194214, avg_entr 0.6642048954963684
Test Epoch18 layer4 Acc 0.722, AUC 0.8128484487533569, avg_entr 0.22684167325496674
gc 0
Train Epoch19 Acc 0.780875 (31235/40000), AUC 0.8569555282592773
Test Epoch19 layer0 Acc 0.7083, AUC 0.7846684455871582, avg_entr 0.27952083945274353
Test Epoch19 layer1 Acc 0.7315, AUC 0.8171024322509766, avg_entr 0.22840790450572968
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 19
Test Epoch19 layer2 Acc 0.7402, AUC 0.823153018951416, avg_entr 0.20489101111888885
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 19
Test Epoch19 layer3 Acc 0.5112, AUC 0.451499879360199, avg_entr 0.6688916683197021
Test Epoch19 layer4 Acc 0.7362, AUC 0.8226696252822876, avg_entr 0.18469713628292084
gc 0
Train Epoch20 Acc 0.785175 (31407/40000), AUC 0.8638770580291748
Test Epoch20 layer0 Acc 0.7071, AUC 0.7882735133171082, avg_entr 0.310951292514801
Test Epoch20 layer1 Acc 0.7167, AUC 0.8152793645858765, avg_entr 0.2406156212091446
Test Epoch20 layer2 Acc 0.7094, AUC 0.8166481256484985, avg_entr 0.21308903396129608
Test Epoch20 layer3 Acc 0.512, AUC 0.45830094814300537, avg_entr 0.6641747355461121
Test Epoch20 layer4 Acc 0.7039, AUC 0.8168171644210815, avg_entr 0.19611448049545288
gc 0
Train Epoch21 Acc 0.799075 (31963/40000), AUC 0.876721978187561
Test Epoch21 layer0 Acc 0.7123, AUC 0.7930885553359985, avg_entr 0.24714939296245575
Test Epoch21 layer1 Acc 0.7409, AUC 0.8249155282974243, avg_entr 0.18568049371242523
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 21
Test Epoch21 layer2 Acc 0.7481, AUC 0.8306699991226196, avg_entr 0.16684146225452423
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 21
Test Epoch21 layer3 Acc 0.5156, AUC 0.46740925312042236, avg_entr 0.6622210144996643
Test Epoch21 layer4 Acc 0.7473, AUC 0.8294490575790405, avg_entr 0.1696326583623886
gc 0
Train Epoch22 Acc 0.806725 (32269/40000), AUC 0.883705735206604
Test Epoch22 layer0 Acc 0.7117, AUC 0.7964820265769958, avg_entr 0.22384704649448395
Test Epoch22 layer1 Acc 0.7365, AUC 0.8279053568840027, avg_entr 0.16080497205257416
Test Epoch22 layer2 Acc 0.7462, AUC 0.8329372406005859, avg_entr 0.14151839911937714
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 22
Test Epoch22 layer3 Acc 0.5191, AUC 0.6078015565872192, avg_entr 0.6549476981163025
Test Epoch22 layer4 Acc 0.7476, AUC 0.8302478790283203, avg_entr 0.13986384868621826
gc 0
Train Epoch23 Acc 0.813825 (32553/40000), AUC 0.8878145217895508
Test Epoch23 layer0 Acc 0.7189, AUC 0.7996289730072021, avg_entr 0.21307343244552612
Test Epoch23 layer1 Acc 0.7431, AUC 0.8317767381668091, avg_entr 0.15009742975234985
Test Epoch23 layer2 Acc 0.7516, AUC 0.8367786407470703, avg_entr 0.13591741025447845
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 23
Test Epoch23 layer3 Acc 0.7536, AUC 0.826003909111023, avg_entr 0.13139359652996063
Test Epoch23 layer4 Acc 0.7523, AUC 0.8357793092727661, avg_entr 0.12247195094823837
gc 0
Train Epoch24 Acc 0.818775 (32751/40000), AUC 0.8977844715118408
Test Epoch24 layer0 Acc 0.7182, AUC 0.8045361042022705, avg_entr 0.22428523004055023
Test Epoch24 layer1 Acc 0.7451, AUC 0.8357607126235962, avg_entr 0.1548427790403366
Test Epoch24 layer2 Acc 0.7475, AUC 0.8408830165863037, avg_entr 0.14966724812984467
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 24
Test Epoch24 layer3 Acc 0.7455, AUC 0.8334419131278992, avg_entr 0.1547340750694275
Test Epoch24 layer4 Acc 0.7427, AUC 0.8391481041908264, avg_entr 0.14248774945735931
gc 0
Train Epoch25 Acc 0.8315 (33260/40000), AUC 0.9063434600830078
Test Epoch25 layer0 Acc 0.7298, AUC 0.8059298992156982, avg_entr 0.19834506511688232
Test Epoch25 layer1 Acc 0.7605, AUC 0.8365464210510254, avg_entr 0.14622141420841217
Test Epoch25 layer2 Acc 0.7653, AUC 0.8414026498794556, avg_entr 0.13101314008235931
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 25
Test Epoch25 layer3 Acc 0.7652, AUC 0.8374439477920532, avg_entr 0.13294999301433563
Test Epoch25 layer4 Acc 0.7623, AUC 0.8417940139770508, avg_entr 0.12294316291809082
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 25
gc 0
Train Epoch26 Acc 0.842525 (33701/40000), AUC 0.9157791137695312
Test Epoch26 layer0 Acc 0.711, AUC 0.8048654794692993, avg_entr 0.16739188134670258
Test Epoch26 layer1 Acc 0.7413, AUC 0.8357511758804321, avg_entr 0.1371014267206192
Test Epoch26 layer2 Acc 0.7497, AUC 0.8423212766647339, avg_entr 0.14139439165592194
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 26
Test Epoch26 layer3 Acc 0.7439, AUC 0.8390392661094666, avg_entr 0.13882771134376526
Test Epoch26 layer4 Acc 0.7485, AUC 0.8437062501907349, avg_entr 0.14506085216999054
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 26
gc 0
Train Epoch27 Acc 0.8493 (33972/40000), AUC 0.9194681644439697
Test Epoch27 layer0 Acc 0.715, AUC 0.8069462180137634, avg_entr 0.15478426218032837
Test Epoch27 layer1 Acc 0.7344, AUC 0.8343361616134644, avg_entr 0.1004292368888855
Test Epoch27 layer2 Acc 0.7373, AUC 0.8367836475372314, avg_entr 0.08065188676118851
Test Epoch27 layer3 Acc 0.735, AUC 0.8258906602859497, avg_entr 0.08065412938594818
Test Epoch27 layer4 Acc 0.7345, AUC 0.8346102237701416, avg_entr 0.06932058185338974
gc 0
Train Epoch28 Acc 0.8548 (34192/40000), AUC 0.9266360998153687
Test Epoch28 layer0 Acc 0.7259, AUC 0.8064067363739014, avg_entr 0.17037178575992584
Test Epoch28 layer1 Acc 0.7476, AUC 0.8365049362182617, avg_entr 0.1277189403772354
Test Epoch28 layer2 Acc 0.7552, AUC 0.842530369758606, avg_entr 0.13302183151245117
Test Epoch28 layer3 Acc 0.7539, AUC 0.8408505916595459, avg_entr 0.1373101770877838
Test Epoch28 layer4 Acc 0.7531, AUC 0.8435320258140564, avg_entr 0.14373545348644257
gc 0
Train Epoch29 Acc 0.863 (34520/40000), AUC 0.9314239025115967
Test Epoch29 layer0 Acc 0.7285, AUC 0.8073523640632629, avg_entr 0.14567239582538605
Test Epoch29 layer1 Acc 0.7613, AUC 0.8369100093841553, avg_entr 0.09743502736091614
Test Epoch29 layer2 Acc 0.7691, AUC 0.843187689781189, avg_entr 0.09855282306671143
Test Epoch29 layer3 Acc 0.768, AUC 0.8426408171653748, avg_entr 0.09583378583192825
Test Epoch29 layer4 Acc 0.7679, AUC 0.8440813422203064, avg_entr 0.09361188113689423
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 29
gc 0
Train Epoch30 Acc 0.870625 (34825/40000), AUC 0.9389702081680298
Test Epoch30 layer0 Acc 0.7235, AUC 0.8098755478858948, avg_entr 0.14592383801937103
Test Epoch30 layer1 Acc 0.7368, AUC 0.8380955457687378, avg_entr 0.10078299790620804
Test Epoch30 layer2 Acc 0.7388, AUC 0.8428763151168823, avg_entr 0.08880690485239029
Test Epoch30 layer3 Acc 0.7377, AUC 0.8354926705360413, avg_entr 0.08503491431474686
Test Epoch30 layer4 Acc 0.7319, AUC 0.8397601842880249, avg_entr 0.07637165486812592
gc 0
Train Epoch31 Acc 0.8749 (34996/40000), AUC 0.9415944218635559
Test Epoch31 layer0 Acc 0.6843, AUC 0.8073670864105225, avg_entr 0.12820445001125336
Test Epoch31 layer1 Acc 0.6748, AUC 0.8292900919914246, avg_entr 0.10290832817554474
Test Epoch31 layer2 Acc 0.6767, AUC 0.8310647010803223, avg_entr 0.10981123149394989
Test Epoch31 layer3 Acc 0.6667, AUC 0.8265646696090698, avg_entr 0.11058784276247025
Test Epoch31 layer4 Acc 0.6556, AUC 0.8330421447753906, avg_entr 0.10256315767765045
gc 0
Train Epoch32 Acc 0.883875 (35355/40000), AUC 0.9455606341362
Test Epoch32 layer0 Acc 0.7182, AUC 0.8108000755310059, avg_entr 0.12509553134441376
Test Epoch32 layer1 Acc 0.7292, AUC 0.8332982659339905, avg_entr 0.07798849046230316
Test Epoch32 layer2 Acc 0.7353, AUC 0.8377951383590698, avg_entr 0.07240869104862213
Test Epoch32 layer3 Acc 0.7367, AUC 0.8313767313957214, avg_entr 0.072331003844738
Test Epoch32 layer4 Acc 0.7384, AUC 0.8373512029647827, avg_entr 0.07043595612049103
gc 0
Train Epoch33 Acc 0.88785 (35514/40000), AUC 0.9476689100265503
Test Epoch33 layer0 Acc 0.7335, AUC 0.8125834465026855, avg_entr 0.1234835684299469
Test Epoch33 layer1 Acc 0.7579, AUC 0.8383467197418213, avg_entr 0.06574484705924988
Test Epoch33 layer2 Acc 0.7588, AUC 0.8442481756210327, avg_entr 0.06045129895210266
Save ckpt to ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt  ,ep 33
Test Epoch33 layer3 Acc 0.7581, AUC 0.8407868146896362, avg_entr 0.06117705628275871
Test Epoch33 layer4 Acc 0.7593, AUC 0.8432310819625854, avg_entr 0.059415269643068314
gc 0
Train Epoch34 Acc 0.895 (35800/40000), AUC 0.9537124633789062
Test Epoch34 layer0 Acc 0.7204, AUC 0.8088483810424805, avg_entr 0.11451269686222076
Test Epoch34 layer1 Acc 0.7497, AUC 0.836158037185669, avg_entr 0.07508110255002975
Test Epoch34 layer2 Acc 0.7557, AUC 0.8418529033660889, avg_entr 0.07064472883939743
Test Epoch34 layer3 Acc 0.7544, AUC 0.8396120071411133, avg_entr 0.06731079518795013
Test Epoch34 layer4 Acc 0.7561, AUC 0.8419464826583862, avg_entr 0.06760456413030624
gc 0
Train Epoch35 Acc 0.90405 (36162/40000), AUC 0.9596002101898193
Test Epoch35 layer0 Acc 0.7335, AUC 0.8137209415435791, avg_entr 0.1042284145951271
Test Epoch35 layer1 Acc 0.7554, AUC 0.837350070476532, avg_entr 0.059841401875019073
Test Epoch35 layer2 Acc 0.7608, AUC 0.8435683250427246, avg_entr 0.057485584169626236
Test Epoch35 layer3 Acc 0.7588, AUC 0.8409315347671509, avg_entr 0.0534534677863121
Test Epoch35 layer4 Acc 0.7628, AUC 0.8427094221115112, avg_entr 0.05043817311525345
gc 0
Train Epoch36 Acc 0.9095 (36380/40000), AUC 0.9614068269729614
Test Epoch36 layer0 Acc 0.728, AUC 0.8123246431350708, avg_entr 0.0907461941242218
Test Epoch36 layer1 Acc 0.7548, AUC 0.8338829874992371, avg_entr 0.045942313969135284
Test Epoch36 layer2 Acc 0.7588, AUC 0.8385874032974243, avg_entr 0.04162102937698364
Test Epoch36 layer3 Acc 0.7587, AUC 0.8352060914039612, avg_entr 0.040025271475315094
Test Epoch36 layer4 Acc 0.7582, AUC 0.838767409324646, avg_entr 0.03854232653975487
gc 0
Train Epoch37 Acc 0.910625 (36425/40000), AUC 0.9630001783370972
Test Epoch37 layer0 Acc 0.7259, AUC 0.8140485286712646, avg_entr 0.09724702686071396
Test Epoch37 layer1 Acc 0.7575, AUC 0.838239312171936, avg_entr 0.05413762107491493
Test Epoch37 layer2 Acc 0.7655, AUC 0.8434765934944153, avg_entr 0.05100724473595619
Test Epoch37 layer3 Acc 0.7631, AUC 0.8432958126068115, avg_entr 0.051108166575431824
Test Epoch37 layer4 Acc 0.7645, AUC 0.8441404700279236, avg_entr 0.049494776874780655
gc 0
Train Epoch38 Acc 0.92345 (36938/40000), AUC 0.9700945019721985
Test Epoch38 layer0 Acc 0.7339, AUC 0.8118522763252258, avg_entr 0.07918103784322739
Test Epoch38 layer1 Acc 0.7586, AUC 0.8341703414916992, avg_entr 0.0451546311378479
Test Epoch38 layer2 Acc 0.7673, AUC 0.8390458822250366, avg_entr 0.037725966423749924
Test Epoch38 layer3 Acc 0.7689, AUC 0.8357709646224976, avg_entr 0.03511674329638481
Test Epoch38 layer4 Acc 0.7689, AUC 0.839073121547699, avg_entr 0.035761650651693344
gc 0
Train Epoch39 Acc 0.92685 (37074/40000), AUC 0.9719094038009644
Test Epoch39 layer0 Acc 0.7323, AUC 0.8107434511184692, avg_entr 0.08437685668468475
Test Epoch39 layer1 Acc 0.759, AUC 0.8326848745346069, avg_entr 0.04492766410112381
Test Epoch39 layer2 Acc 0.7645, AUC 0.8367178440093994, avg_entr 0.039531413465738297
Test Epoch39 layer3 Acc 0.7643, AUC 0.8349380493164062, avg_entr 0.03692711517214775
Test Epoch39 layer4 Acc 0.7657, AUC 0.837583065032959, avg_entr 0.03551794961094856
gc 0
Train Epoch40 Acc 0.92975 (37190/40000), AUC 0.9737273454666138
Test Epoch40 layer0 Acc 0.7295, AUC 0.810276448726654, avg_entr 0.07992571592330933
Test Epoch40 layer1 Acc 0.7559, AUC 0.83139967918396, avg_entr 0.040593501180410385
Test Epoch40 layer2 Acc 0.7628, AUC 0.8341999053955078, avg_entr 0.033476583659648895
Test Epoch40 layer3 Acc 0.763, AUC 0.8330570459365845, avg_entr 0.030259866267442703
Test Epoch40 layer4 Acc 0.7632, AUC 0.8364616632461548, avg_entr 0.031063733622431755
gc 0
Train Epoch41 Acc 0.934325 (37373/40000), AUC 0.9754562377929688
Test Epoch41 layer0 Acc 0.7326, AUC 0.8114063143730164, avg_entr 0.07878833264112473
Test Epoch41 layer1 Acc 0.7515, AUC 0.8315391540527344, avg_entr 0.042265623807907104
Test Epoch41 layer2 Acc 0.7583, AUC 0.8349699974060059, avg_entr 0.036291349679231644
Test Epoch41 layer3 Acc 0.7563, AUC 0.8336634635925293, avg_entr 0.03499477356672287
Test Epoch41 layer4 Acc 0.7582, AUC 0.8371962904930115, avg_entr 0.03371317312121391
gc 0
Train Epoch42 Acc 0.945175 (37807/40000), AUC 0.9799350500106812
Test Epoch42 layer0 Acc 0.7305, AUC 0.8120145797729492, avg_entr 0.06669972836971283
Test Epoch42 layer1 Acc 0.7564, AUC 0.8297383189201355, avg_entr 0.04009221866726875
Test Epoch42 layer2 Acc 0.7651, AUC 0.8336416482925415, avg_entr 0.038884297013282776
Test Epoch42 layer3 Acc 0.7632, AUC 0.8333016633987427, avg_entr 0.03644460067152977
Test Epoch42 layer4 Acc 0.7645, AUC 0.8360916376113892, avg_entr 0.03442865610122681
gc 0
Train Epoch43 Acc 0.945275 (37811/40000), AUC 0.9804239869117737
Test Epoch43 layer0 Acc 0.725, AUC 0.8091340661048889, avg_entr 0.06080866605043411
Test Epoch43 layer1 Acc 0.7511, AUC 0.8273465633392334, avg_entr 0.03574954718351364
Test Epoch43 layer2 Acc 0.7575, AUC 0.8316524028778076, avg_entr 0.03297364339232445
Test Epoch43 layer3 Acc 0.7588, AUC 0.8318741321563721, avg_entr 0.03129948303103447
Test Epoch43 layer4 Acc 0.7589, AUC 0.8347144722938538, avg_entr 0.029777823016047478
gc 0
Train Epoch44 Acc 0.947625 (37905/40000), AUC 0.9812740087509155
Test Epoch44 layer0 Acc 0.7235, AUC 0.8055714964866638, avg_entr 0.05779016762971878
Test Epoch44 layer1 Acc 0.754, AUC 0.825223445892334, avg_entr 0.030856506898999214
Test Epoch44 layer2 Acc 0.7593, AUC 0.8304981589317322, avg_entr 0.02819948084652424
Test Epoch44 layer3 Acc 0.7585, AUC 0.8274396657943726, avg_entr 0.025431104004383087
Test Epoch44 layer4 Acc 0.7582, AUC 0.8327755928039551, avg_entr 0.024548694491386414
gc 0
Train Epoch45 Acc 0.94775 (37910/40000), AUC 0.9815758466720581
Test Epoch45 layer0 Acc 0.7307, AUC 0.8084635734558105, avg_entr 0.055634092539548874
Test Epoch45 layer1 Acc 0.7546, AUC 0.8277325630187988, avg_entr 0.030737105756998062
Test Epoch45 layer2 Acc 0.7628, AUC 0.8316896557807922, avg_entr 0.02986838109791279
Test Epoch45 layer3 Acc 0.7628, AUC 0.8324568867683411, avg_entr 0.02749496139585972
Test Epoch45 layer4 Acc 0.765, AUC 0.8353253602981567, avg_entr 0.02731420285999775
gc 0
Train Epoch46 Acc 0.95435 (38174/40000), AUC 0.9838204383850098
Test Epoch46 layer0 Acc 0.7315, AUC 0.806910514831543, avg_entr 0.05455700680613518
Test Epoch46 layer1 Acc 0.7558, AUC 0.825297474861145, avg_entr 0.029443660750985146
Test Epoch46 layer2 Acc 0.7629, AUC 0.8289247751235962, avg_entr 0.025172287598252296
Test Epoch46 layer3 Acc 0.7612, AUC 0.8265985250473022, avg_entr 0.02266399748623371
Test Epoch46 layer4 Acc 0.7622, AUC 0.8319920897483826, avg_entr 0.021866876631975174
gc 0
Train Epoch47 Acc 0.954375 (38175/40000), AUC 0.9839088916778564
Test Epoch47 layer0 Acc 0.7302, AUC 0.8068351149559021, avg_entr 0.05421162769198418
Test Epoch47 layer1 Acc 0.755, AUC 0.8247895240783691, avg_entr 0.027061786502599716
Test Epoch47 layer2 Acc 0.7597, AUC 0.8284741640090942, avg_entr 0.024604778736829758
Test Epoch47 layer3 Acc 0.7615, AUC 0.8268377780914307, avg_entr 0.021878117695450783
Test Epoch47 layer4 Acc 0.7618, AUC 0.8313090801239014, avg_entr 0.021974289789795876
gc 0
Train Epoch48 Acc 0.955475 (38219/40000), AUC 0.9843881130218506
Test Epoch48 layer0 Acc 0.7265, AUC 0.8073388338088989, avg_entr 0.04960712417960167
Test Epoch48 layer1 Acc 0.7499, AUC 0.8236976861953735, avg_entr 0.029343750327825546
Test Epoch48 layer2 Acc 0.7587, AUC 0.8272112607955933, avg_entr 0.02696043625473976
Test Epoch48 layer3 Acc 0.7589, AUC 0.8266744613647461, avg_entr 0.024339523166418076
Test Epoch48 layer4 Acc 0.7605, AUC 0.8309189081192017, avg_entr 0.022746074944734573
gc 0
Train Epoch49 Acc 0.957075 (38283/40000), AUC 0.984424352645874
Test Epoch49 layer0 Acc 0.7264, AUC 0.8062961101531982, avg_entr 0.049225952476263046
Test Epoch49 layer1 Acc 0.7478, AUC 0.8226562738418579, avg_entr 0.028582464903593063
Test Epoch49 layer2 Acc 0.7544, AUC 0.8261685371398926, avg_entr 0.027048498392105103
Test Epoch49 layer3 Acc 0.7545, AUC 0.8262208700180054, avg_entr 0.025365369394421577
Test Epoch49 layer4 Acc 0.7539, AUC 0.8298675417900085, avg_entr 0.023162340745329857
Best AUC 0.8442481756210327
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_lstmalside_l5_side250//imdb_lstmalside_l5_side.pt
[[3680 1342]
 [1323 3655]]
Figure(640x480)
tensor([0.0321, 0.6781, 0.0008,  ..., 0.0008, 0.0162, 0.0009])
[[4139  883]
 [1538 3440]]
Figure(640x480)
tensor([0.0097, 0.0823, 0.0003,  ..., 0.0003, 0.0238, 0.0007])
[[4248  774]
 [1638 3340]]
Figure(640x480)
tensor([0.0081, 0.0341, 0.0011,  ..., 0.0006, 0.0182, 0.0004])
[[4278  744]
 [1675 3303]]
Figure(640x480)
tensor([0.0542, 0.0225, 0.0013,  ..., 0.0009, 0.0284, 0.0009])
[[4302  720]
 [1687 3291]]
Figure(640x480)
tensor([0.0486, 0.0157, 0.0014,  ..., 0.0007, 0.0215, 0.0007])
