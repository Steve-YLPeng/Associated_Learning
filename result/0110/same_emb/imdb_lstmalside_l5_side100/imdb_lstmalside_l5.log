total count words 222751
vocab size 30000
found 27937 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList()
  (emb): Embedding(30000, 300)
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb.weight 9000000
Total Trainable Params: 12937378
Start Training
gc 0
Train Epoch0 Acc 0.495025 (19801/40000), AUC 0.49653422832489014
Test Epoch0 layer0 Acc 0.5061, AUC 0.5056503415107727, avg_entr 0.6768806576728821
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.4984, AUC 0.5011245012283325, avg_entr 0.6758164763450623
Test Epoch0 layer2 Acc 0.4952, AUC 0.49877113103866577, avg_entr 0.6761676073074341
Test Epoch0 layer3 Acc 0.5019, AUC 0.5056356191635132, avg_entr 0.6763468384742737
Test Epoch0 layer4 Acc 0.4957, AUC 0.4940378665924072, avg_entr 0.6764280200004578
gc 0
Train Epoch1 Acc 0.498975 (19959/40000), AUC 0.5011721253395081
Test Epoch1 layer0 Acc 0.5075, AUC 0.5135276317596436, avg_entr 0.6878206133842468
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.5091, AUC 0.5116041898727417, avg_entr 0.6896909475326538
Test Epoch1 layer2 Acc 0.5113, AUC 0.5135435461997986, avg_entr 0.6886544227600098
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer3 Acc 0.5133, AUC 0.5130857229232788, avg_entr 0.6889002323150635
Test Epoch1 layer4 Acc 0.515, AUC 0.517098069190979, avg_entr 0.6886950731277466
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.5116 (20464/40000), AUC 0.51904296875
Test Epoch2 layer0 Acc 0.512, AUC 0.5231401324272156, avg_entr 0.6898486614227295
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.5064, AUC 0.5191471576690674, avg_entr 0.6894309520721436
Test Epoch2 layer2 Acc 0.5126, AUC 0.5282594561576843, avg_entr 0.6898151636123657
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer3 Acc 0.5095, AUC 0.5242634415626526, avg_entr 0.6892535090446472
Test Epoch2 layer4 Acc 0.5203, AUC 0.5267786979675293, avg_entr 0.6891307830810547
gc 0
Train Epoch3 Acc 0.517175 (20687/40000), AUC 0.5243633985519409
Test Epoch3 layer0 Acc 0.5227, AUC 0.5268222093582153, avg_entr 0.6885798573493958
Test Epoch3 layer1 Acc 0.5195, AUC 0.5239837765693665, avg_entr 0.6906875967979431
Test Epoch3 layer2 Acc 0.5184, AUC 0.5369868278503418, avg_entr 0.6891043186187744
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer3 Acc 0.5132, AUC 0.5296773910522461, avg_entr 0.6890802979469299
Test Epoch3 layer4 Acc 0.5256, AUC 0.531125009059906, avg_entr 0.6896689534187317
gc 0
Train Epoch4 Acc 0.52065 (20826/40000), AUC 0.530049204826355
Test Epoch4 layer0 Acc 0.5229, AUC 0.5272701978683472, avg_entr 0.6900122761726379
Test Epoch4 layer1 Acc 0.5217, AUC 0.5312151908874512, avg_entr 0.6894578337669373
Test Epoch4 layer2 Acc 0.5243, AUC 0.5401692390441895, avg_entr 0.6900092959403992
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer3 Acc 0.5172, AUC 0.5339265465736389, avg_entr 0.6893514394760132
Test Epoch4 layer4 Acc 0.523, AUC 0.5331775546073914, avg_entr 0.6888855695724487
gc 0
Train Epoch5 Acc 0.52125 (20850/40000), AUC 0.5342755913734436
Test Epoch5 layer0 Acc 0.523, AUC 0.5297411680221558, avg_entr 0.6901658177375793
Test Epoch5 layer1 Acc 0.537, AUC 0.5532037019729614, avg_entr 0.6858311891555786
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.5309, AUC 0.5414443016052246, avg_entr 0.689115583896637
Test Epoch5 layer3 Acc 0.5251, AUC 0.5378056764602661, avg_entr 0.6881539225578308
Test Epoch5 layer4 Acc 0.524, AUC 0.5369638204574585, avg_entr 0.687252938747406
gc 0
Train Epoch6 Acc 0.5295 (21180/40000), AUC 0.5411173105239868
Test Epoch6 layer0 Acc 0.5125, AUC 0.5323473215103149, avg_entr 0.6870272755622864
Test Epoch6 layer1 Acc 0.5488, AUC 0.5723021030426025, avg_entr 0.6764009594917297
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer2 Acc 0.5221, AUC 0.5443350076675415, avg_entr 0.6858945488929749
Test Epoch6 layer3 Acc 0.5329, AUC 0.5432485342025757, avg_entr 0.6853922605514526
Test Epoch6 layer4 Acc 0.5255, AUC 0.5407158136367798, avg_entr 0.6851794123649597
gc 0
Train Epoch7 Acc 0.53355 (21342/40000), AUC 0.5448286533355713
Test Epoch7 layer0 Acc 0.5271, AUC 0.53738933801651, avg_entr 0.6858632564544678
Test Epoch7 layer1 Acc 0.5602, AUC 0.5831242799758911, avg_entr 0.6635547280311584
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer2 Acc 0.5201, AUC 0.5465986728668213, avg_entr 0.6835739016532898
Test Epoch7 layer3 Acc 0.5145, AUC 0.5464906692504883, avg_entr 0.6818771362304688
Test Epoch7 layer4 Acc 0.5281, AUC 0.5451627969741821, avg_entr 0.6836433410644531
gc 0
Train Epoch8 Acc 0.54125 (21650/40000), AUC 0.5569614171981812
Test Epoch8 layer0 Acc 0.5178, AUC 0.5481686592102051, avg_entr 0.6729246973991394
Test Epoch8 layer1 Acc 0.5676, AUC 0.5949866771697998, avg_entr 0.6432186961174011
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer2 Acc 0.5184, AUC 0.5525264739990234, avg_entr 0.6760295629501343
Test Epoch8 layer3 Acc 0.5169, AUC 0.5587797164916992, avg_entr 0.6700779795646667
Test Epoch8 layer4 Acc 0.5289, AUC 0.5569006204605103, avg_entr 0.6732651591300964
gc 0
Train Epoch9 Acc 0.5537 (22148/40000), AUC 0.573909342288971
Test Epoch9 layer0 Acc 0.5579, AUC 0.5856749415397644, avg_entr 0.6573286652565002
Test Epoch9 layer1 Acc 0.5786, AUC 0.615683913230896, avg_entr 0.6100343465805054
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer2 Acc 0.5568, AUC 0.5824894905090332, avg_entr 0.6683655977249146
Test Epoch9 layer3 Acc 0.5566, AUC 0.5785735249519348, avg_entr 0.6482773423194885
Test Epoch9 layer4 Acc 0.5594, AUC 0.5850853323936462, avg_entr 0.65140700340271
gc 0
Train Epoch10 Acc 0.592325 (23693/40000), AUC 0.6260376572608948
Test Epoch10 layer0 Acc 0.5894, AUC 0.6373298168182373, avg_entr 0.5639110803604126
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer1 Acc 0.6163, AUC 0.6707499027252197, avg_entr 0.5179154872894287
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer2 Acc 0.622, AUC 0.6721681356430054, avg_entr 0.5231950283050537
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer3 Acc 0.6276, AUC 0.6730954647064209, avg_entr 0.5230129957199097
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer4 Acc 0.6265, AUC 0.6687211990356445, avg_entr 0.5364931225776672
gc 0
Train Epoch11 Acc 0.635025 (25401/40000), AUC 0.6752734184265137
Test Epoch11 layer0 Acc 0.6047, AUC 0.6621445417404175, avg_entr 0.5228858590126038
Test Epoch11 layer1 Acc 0.6108, AUC 0.6874606609344482, avg_entr 0.4821969270706177
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer2 Acc 0.6135, AUC 0.6889958381652832, avg_entr 0.48873773217201233
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer3 Acc 0.6224, AUC 0.690875768661499, avg_entr 0.49437597393989563
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer4 Acc 0.6268, AUC 0.6905875205993652, avg_entr 0.5153241157531738
gc 0
Train Epoch12 Acc 0.6533 (26132/40000), AUC 0.7014893889427185
Test Epoch12 layer0 Acc 0.6209, AUC 0.6798259019851685, avg_entr 0.4785670042037964
Test Epoch12 layer1 Acc 0.6492, AUC 0.7073970437049866, avg_entr 0.4509228467941284
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 12
Test Epoch12 layer2 Acc 0.6545, AUC 0.7146390676498413, avg_entr 0.4372624158859253
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 12
Test Epoch12 layer3 Acc 0.6623, AUC 0.7200549840927124, avg_entr 0.4106530249118805
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 12
Test Epoch12 layer4 Acc 0.6649, AUC 0.7210056185722351, avg_entr 0.40474337339401245
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.69145 (27658/40000), AUC 0.7527990937232971
Test Epoch13 layer0 Acc 0.6347, AUC 0.6955361366271973, avg_entr 0.4179992079734802
Test Epoch13 layer1 Acc 0.6545, AUC 0.7227602005004883, avg_entr 0.3785216212272644
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer2 Acc 0.6628, AUC 0.7307666540145874, avg_entr 0.3817947506904602
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer3 Acc 0.6648, AUC 0.7391738295555115, avg_entr 0.36448055505752563
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 13
Test Epoch13 layer4 Acc 0.6703, AUC 0.743068516254425, avg_entr 0.36633044481277466
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.70395 (28158/40000), AUC 0.7740311622619629
Test Epoch14 layer0 Acc 0.6422, AUC 0.7068027257919312, avg_entr 0.4364457130432129
Test Epoch14 layer1 Acc 0.6646, AUC 0.7333752512931824, avg_entr 0.39259788393974304
Test Epoch14 layer2 Acc 0.6717, AUC 0.7427973747253418, avg_entr 0.3554892838001251
Test Epoch14 layer3 Acc 0.6784, AUC 0.7531604170799255, avg_entr 0.3257601857185364
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 14
Test Epoch14 layer4 Acc 0.6809, AUC 0.7561724781990051, avg_entr 0.3059399724006653
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.723325 (28933/40000), AUC 0.7954703569412231
Test Epoch15 layer0 Acc 0.6476, AUC 0.7198724150657654, avg_entr 0.39118334650993347
Test Epoch15 layer1 Acc 0.6703, AUC 0.7457302808761597, avg_entr 0.3696656823158264
Test Epoch15 layer2 Acc 0.6763, AUC 0.7546343803405762, avg_entr 0.3501686751842499
Test Epoch15 layer3 Acc 0.6829, AUC 0.7659376263618469, avg_entr 0.31112536787986755
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 15
Test Epoch15 layer4 Acc 0.6924, AUC 0.7704794406890869, avg_entr 0.28104767203330994
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.729775 (29191/40000), AUC 0.8056100606918335
Test Epoch16 layer0 Acc 0.6587, AUC 0.7274720668792725, avg_entr 0.37808871269226074
Test Epoch16 layer1 Acc 0.6793, AUC 0.7528476715087891, avg_entr 0.33377957344055176
Test Epoch16 layer2 Acc 0.6889, AUC 0.7632466554641724, avg_entr 0.3347123861312866
Test Epoch16 layer3 Acc 0.6968, AUC 0.7737261652946472, avg_entr 0.3452005982398987
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 16
Test Epoch16 layer4 Acc 0.7027, AUC 0.7785685658454895, avg_entr 0.3473386764526367
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.75 (30000/40000), AUC 0.830609917640686
Test Epoch17 layer0 Acc 0.666, AUC 0.7365078330039978, avg_entr 0.3548957407474518
Test Epoch17 layer1 Acc 0.6887, AUC 0.7628129720687866, avg_entr 0.2927525043487549
Test Epoch17 layer2 Acc 0.7006, AUC 0.7738547325134277, avg_entr 0.2753113806247711
Test Epoch17 layer3 Acc 0.7097, AUC 0.7847786545753479, avg_entr 0.2422979176044464
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 17
Test Epoch17 layer4 Acc 0.7136, AUC 0.7883299589157104, avg_entr 0.22438117861747742
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 17
gc 0
Train Epoch18 Acc 0.767525 (30701/40000), AUC 0.8471957445144653
Test Epoch18 layer0 Acc 0.6578, AUC 0.7405129671096802, avg_entr 0.29448091983795166
Test Epoch18 layer1 Acc 0.677, AUC 0.7663534879684448, avg_entr 0.2378993183374405
Test Epoch18 layer2 Acc 0.6832, AUC 0.777118444442749, avg_entr 0.22933794558048248
Test Epoch18 layer3 Acc 0.6836, AUC 0.7861552834510803, avg_entr 0.20966403186321259
Test Epoch18 layer4 Acc 0.687, AUC 0.789151668548584, avg_entr 0.20000474154949188
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 18
gc 0
Train Epoch19 Acc 0.772625 (30905/40000), AUC 0.8508979082107544
Test Epoch19 layer0 Acc 0.6637, AUC 0.7459582090377808, avg_entr 0.28188127279281616
Test Epoch19 layer1 Acc 0.6848, AUC 0.7714947462081909, avg_entr 0.2149595469236374
Test Epoch19 layer2 Acc 0.6982, AUC 0.7817046642303467, avg_entr 0.20276570320129395
Test Epoch19 layer3 Acc 0.7035, AUC 0.7910364866256714, avg_entr 0.20981533825397491
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 19
Test Epoch19 layer4 Acc 0.7125, AUC 0.793829083442688, avg_entr 0.2126871794462204
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 19
gc 0
Train Epoch20 Acc 0.7869 (31476/40000), AUC 0.8678005933761597
Test Epoch20 layer0 Acc 0.6698, AUC 0.7472164034843445, avg_entr 0.27413269877433777
Test Epoch20 layer1 Acc 0.6914, AUC 0.7730363607406616, avg_entr 0.2032095193862915
Test Epoch20 layer2 Acc 0.6919, AUC 0.7847104668617249, avg_entr 0.18166427314281464
Test Epoch20 layer3 Acc 0.6922, AUC 0.7921881675720215, avg_entr 0.1589580774307251
Test Epoch20 layer4 Acc 0.6973, AUC 0.79017174243927, avg_entr 0.14514805376529694
gc 0
Train Epoch21 Acc 0.796025 (31841/40000), AUC 0.8779489994049072
Test Epoch21 layer0 Acc 0.673, AUC 0.7488976716995239, avg_entr 0.2794300317764282
Test Epoch21 layer1 Acc 0.6966, AUC 0.7758834362030029, avg_entr 0.22215254604816437
Test Epoch21 layer2 Acc 0.7078, AUC 0.7883375883102417, avg_entr 0.20955640077590942
Test Epoch21 layer3 Acc 0.7177, AUC 0.7994391918182373, avg_entr 0.20178090035915375
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 21
Test Epoch21 layer4 Acc 0.7191, AUC 0.8022525310516357, avg_entr 0.17548945546150208
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 21
gc 0
Train Epoch22 Acc 0.810475 (32419/40000), AUC 0.892122745513916
Test Epoch22 layer0 Acc 0.6787, AUC 0.7532476186752319, avg_entr 0.25644439458847046
Test Epoch22 layer1 Acc 0.7059, AUC 0.7799015045166016, avg_entr 0.18283861875534058
Test Epoch22 layer2 Acc 0.7208, AUC 0.7927219271659851, avg_entr 0.17747123539447784
Test Epoch22 layer3 Acc 0.7299, AUC 0.8031007647514343, avg_entr 0.17098918557167053
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 22
Test Epoch22 layer4 Acc 0.7363, AUC 0.8072710037231445, avg_entr 0.158058300614357
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 22
gc 0
Train Epoch23 Acc 0.823875 (32955/40000), AUC 0.9015258550643921
Test Epoch23 layer0 Acc 0.6779, AUC 0.753184974193573, avg_entr 0.24224384129047394
Test Epoch23 layer1 Acc 0.6919, AUC 0.7811399698257446, avg_entr 0.16421431303024292
Test Epoch23 layer2 Acc 0.6971, AUC 0.7922049164772034, avg_entr 0.14239120483398438
Test Epoch23 layer3 Acc 0.7051, AUC 0.8013495206832886, avg_entr 0.12259287387132645
Test Epoch23 layer4 Acc 0.7012, AUC 0.7997397184371948, avg_entr 0.1007615327835083
gc 0
Train Epoch24 Acc 0.832525 (33301/40000), AUC 0.910088300704956
Test Epoch24 layer0 Acc 0.6714, AUC 0.7521113753318787, avg_entr 0.2353186011314392
Test Epoch24 layer1 Acc 0.6851, AUC 0.7795103192329407, avg_entr 0.187811478972435
Test Epoch24 layer2 Acc 0.7001, AUC 0.7925669550895691, avg_entr 0.16584740579128265
Test Epoch24 layer3 Acc 0.7099, AUC 0.8043054342269897, avg_entr 0.15718980133533478
Test Epoch24 layer4 Acc 0.7075, AUC 0.8075894117355347, avg_entr 0.14484335482120514
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 24
gc 0
Train Epoch25 Acc 0.837725 (33509/40000), AUC 0.9126248955726624
Test Epoch25 layer0 Acc 0.6823, AUC 0.7545069456100464, avg_entr 0.20990782976150513
Test Epoch25 layer1 Acc 0.7031, AUC 0.7808132171630859, avg_entr 0.1396702229976654
Test Epoch25 layer2 Acc 0.7147, AUC 0.7920966744422913, avg_entr 0.11349926888942719
Test Epoch25 layer3 Acc 0.7265, AUC 0.7982864379882812, avg_entr 0.09807442128658295
Test Epoch25 layer4 Acc 0.7288, AUC 0.7977240085601807, avg_entr 0.0846603661775589
gc 0
Train Epoch26 Acc 0.8502 (34008/40000), AUC 0.9223344326019287
Test Epoch26 layer0 Acc 0.6792, AUC 0.7549304962158203, avg_entr 0.20861494541168213
Test Epoch26 layer1 Acc 0.6929, AUC 0.7792667150497437, avg_entr 0.14067575335502625
Test Epoch26 layer2 Acc 0.7026, AUC 0.7925784587860107, avg_entr 0.1349489688873291
Test Epoch26 layer3 Acc 0.7051, AUC 0.8016953468322754, avg_entr 0.13137145340442657
Test Epoch26 layer4 Acc 0.7156, AUC 0.8040997982025146, avg_entr 0.11952293664216995
gc 0
Train Epoch27 Acc 0.8593 (34372/40000), AUC 0.9334374666213989
Test Epoch27 layer0 Acc 0.6802, AUC 0.7563086748123169, avg_entr 0.20120640099048615
Test Epoch27 layer1 Acc 0.6894, AUC 0.7831604480743408, avg_entr 0.13837136328220367
Test Epoch27 layer2 Acc 0.6955, AUC 0.795695424079895, avg_entr 0.12338239699602127
Test Epoch27 layer3 Acc 0.7022, AUC 0.8053367137908936, avg_entr 0.11445089429616928
Test Epoch27 layer4 Acc 0.6947, AUC 0.80718994140625, avg_entr 0.09448439627885818
gc 0
Train Epoch28 Acc 0.867025 (34681/40000), AUC 0.937434732913971
Test Epoch28 layer0 Acc 0.6809, AUC 0.7570613622665405, avg_entr 0.18019570410251617
Test Epoch28 layer1 Acc 0.7118, AUC 0.7836464643478394, avg_entr 0.12124189734458923
Test Epoch28 layer2 Acc 0.7262, AUC 0.7968910932540894, avg_entr 0.10889077186584473
Test Epoch28 layer3 Acc 0.7346, AUC 0.8060002326965332, avg_entr 0.09200507402420044
Test Epoch28 layer4 Acc 0.7393, AUC 0.8080185651779175, avg_entr 0.08249571919441223
Save ckpt to ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt  ,ep 28
gc 0
Train Epoch29 Acc 0.878325 (35133/40000), AUC 0.9431516528129578
Test Epoch29 layer0 Acc 0.686, AUC 0.7572904229164124, avg_entr 0.18133507668972015
Test Epoch29 layer1 Acc 0.7066, AUC 0.7821069359779358, avg_entr 0.1202116310596466
Test Epoch29 layer2 Acc 0.721, AUC 0.7959958910942078, avg_entr 0.10937871038913727
Test Epoch29 layer3 Acc 0.7341, AUC 0.8059696555137634, avg_entr 0.09905710071325302
Test Epoch29 layer4 Acc 0.7405, AUC 0.8056507110595703, avg_entr 0.087445467710495
gc 0
Train Epoch30 Acc 0.88225 (35290/40000), AUC 0.9458802938461304
Test Epoch30 layer0 Acc 0.6795, AUC 0.7527886629104614, avg_entr 0.16113018989562988
Test Epoch30 layer1 Acc 0.705, AUC 0.7793728113174438, avg_entr 0.10454306751489639
Test Epoch30 layer2 Acc 0.7186, AUC 0.7924942970275879, avg_entr 0.0946672260761261
Test Epoch30 layer3 Acc 0.729, AUC 0.8017466068267822, avg_entr 0.08423511683940887
Test Epoch30 layer4 Acc 0.7329, AUC 0.8026268482208252, avg_entr 0.0692456066608429
gc 0
Train Epoch31 Acc 0.89105 (35642/40000), AUC 0.9527802467346191
Test Epoch31 layer0 Acc 0.6843, AUC 0.7550081014633179, avg_entr 0.14373120665550232
Test Epoch31 layer1 Acc 0.7083, AUC 0.779352068901062, avg_entr 0.08514340966939926
Test Epoch31 layer2 Acc 0.7177, AUC 0.7905069589614868, avg_entr 0.07220911979675293
Test Epoch31 layer3 Acc 0.7301, AUC 0.7977907657623291, avg_entr 0.06556098908185959
Test Epoch31 layer4 Acc 0.734, AUC 0.7967830896377563, avg_entr 0.05765361338853836
gc 0
Train Epoch32 Acc 0.89815 (35926/40000), AUC 0.9564157724380493
Test Epoch32 layer0 Acc 0.679, AUC 0.7526882886886597, avg_entr 0.16585403680801392
Test Epoch32 layer1 Acc 0.6994, AUC 0.7758471369743347, avg_entr 0.1036326065659523
Test Epoch32 layer2 Acc 0.7154, AUC 0.7900581359863281, avg_entr 0.09762109071016312
Test Epoch32 layer3 Acc 0.726, AUC 0.7997267246246338, avg_entr 0.08554472029209137
Test Epoch32 layer4 Acc 0.7228, AUC 0.79355388879776, avg_entr 0.07941323518753052
gc 0
Train Epoch33 Acc 0.912475 (36499/40000), AUC 0.9661821126937866
Test Epoch33 layer0 Acc 0.6816, AUC 0.7542173862457275, avg_entr 0.12927654385566711
Test Epoch33 layer1 Acc 0.6966, AUC 0.7775992155075073, avg_entr 0.06861314177513123
Test Epoch33 layer2 Acc 0.6991, AUC 0.7862695455551147, avg_entr 0.056189775466918945
Test Epoch33 layer3 Acc 0.7053, AUC 0.7914413213729858, avg_entr 0.044245101511478424
Test Epoch33 layer4 Acc 0.7104, AUC 0.7886377573013306, avg_entr 0.0414150170981884
gc 0
Train Epoch34 Acc 0.9145 (36580/40000), AUC 0.9680354595184326
Test Epoch34 layer0 Acc 0.6872, AUC 0.757362961769104, avg_entr 0.1233205571770668
Test Epoch34 layer1 Acc 0.7091, AUC 0.7788547277450562, avg_entr 0.0815817341208458
Test Epoch34 layer2 Acc 0.7198, AUC 0.7902970910072327, avg_entr 0.06757019460201263
Test Epoch34 layer3 Acc 0.7329, AUC 0.7984532117843628, avg_entr 0.061477210372686386
Test Epoch34 layer4 Acc 0.7326, AUC 0.798187792301178, avg_entr 0.060550231486558914
gc 0
Train Epoch35 Acc 0.923525 (36941/40000), AUC 0.9721343517303467
Test Epoch35 layer0 Acc 0.687, AUC 0.7572140693664551, avg_entr 0.12745888531208038
Test Epoch35 layer1 Acc 0.7095, AUC 0.7803512215614319, avg_entr 0.070020891726017
Test Epoch35 layer2 Acc 0.719, AUC 0.7900619506835938, avg_entr 0.05622326582670212
Test Epoch35 layer3 Acc 0.7298, AUC 0.796311616897583, avg_entr 0.04438118264079094
Test Epoch35 layer4 Acc 0.733, AUC 0.7932170629501343, avg_entr 0.043187446892261505
gc 0
Train Epoch36 Acc 0.922975 (36919/40000), AUC 0.9725656509399414
Test Epoch36 layer0 Acc 0.6897, AUC 0.7580243349075317, avg_entr 0.1218629851937294
Test Epoch36 layer1 Acc 0.7119, AUC 0.7793910503387451, avg_entr 0.07701475918292999
Test Epoch36 layer2 Acc 0.7209, AUC 0.789728045463562, avg_entr 0.06140546873211861
Test Epoch36 layer3 Acc 0.7336, AUC 0.7970997095108032, avg_entr 0.049270305782556534
Test Epoch36 layer4 Acc 0.7366, AUC 0.7949333190917969, avg_entr 0.04724019020795822
gc 0
Train Epoch37 Acc 0.934625 (37385/40000), AUC 0.9784091711044312
Test Epoch37 layer0 Acc 0.6896, AUC 0.7562810182571411, avg_entr 0.11427591741085052
Test Epoch37 layer1 Acc 0.7095, AUC 0.7756408452987671, avg_entr 0.07629399746656418
Test Epoch37 layer2 Acc 0.7189, AUC 0.7870070934295654, avg_entr 0.06196616217494011
Test Epoch37 layer3 Acc 0.7298, AUC 0.7951909899711609, avg_entr 0.05214637517929077
Test Epoch37 layer4 Acc 0.7344, AUC 0.7932420969009399, avg_entr 0.050626154989004135
gc 0
Train Epoch38 Acc 0.935625 (37425/40000), AUC 0.9788570404052734
Test Epoch38 layer0 Acc 0.6837, AUC 0.7552516460418701, avg_entr 0.10438235849142075
Test Epoch38 layer1 Acc 0.7009, AUC 0.7753735780715942, avg_entr 0.061761267483234406
Test Epoch38 layer2 Acc 0.7089, AUC 0.7843540906906128, avg_entr 0.04696139693260193
Test Epoch38 layer3 Acc 0.7198, AUC 0.7900851964950562, avg_entr 0.038539472967386246
Test Epoch38 layer4 Acc 0.7233, AUC 0.7900103330612183, avg_entr 0.040474388748407364
gc 0
Train Epoch39 Acc 0.937875 (37515/40000), AUC 0.980320394039154
Test Epoch39 layer0 Acc 0.6841, AUC 0.7519032955169678, avg_entr 0.10054639726877213
Test Epoch39 layer1 Acc 0.7012, AUC 0.7732127904891968, avg_entr 0.058075010776519775
Test Epoch39 layer2 Acc 0.7084, AUC 0.7833203673362732, avg_entr 0.04589596390724182
Test Epoch39 layer3 Acc 0.7182, AUC 0.7883280515670776, avg_entr 0.03921298682689667
Test Epoch39 layer4 Acc 0.7246, AUC 0.7901507019996643, avg_entr 0.046541936695575714
gc 0
Train Epoch40 Acc 0.93895 (37558/40000), AUC 0.9803074598312378
Test Epoch40 layer0 Acc 0.6839, AUC 0.7529293298721313, avg_entr 0.09811770915985107
Test Epoch40 layer1 Acc 0.7063, AUC 0.7731211185455322, avg_entr 0.05934537947177887
Test Epoch40 layer2 Acc 0.7159, AUC 0.7835618257522583, avg_entr 0.0480358861386776
Test Epoch40 layer3 Acc 0.7246, AUC 0.7911199331283569, avg_entr 0.041499536484479904
Test Epoch40 layer4 Acc 0.7264, AUC 0.7871153354644775, avg_entr 0.0510934516787529
gc 0
Train Epoch41 Acc 0.946625 (37865/40000), AUC 0.9835741519927979
Test Epoch41 layer0 Acc 0.6886, AUC 0.7542335987091064, avg_entr 0.09332428127527237
Test Epoch41 layer1 Acc 0.7112, AUC 0.7735711336135864, avg_entr 0.05592365562915802
Test Epoch41 layer2 Acc 0.7187, AUC 0.7834055423736572, avg_entr 0.04438827931880951
Test Epoch41 layer3 Acc 0.7266, AUC 0.7900564670562744, avg_entr 0.03700033575296402
Test Epoch41 layer4 Acc 0.7311, AUC 0.7888929843902588, avg_entr 0.04535677656531334
gc 0
Train Epoch42 Acc 0.94805 (37922/40000), AUC 0.9839438199996948
Test Epoch42 layer0 Acc 0.6856, AUC 0.7534077167510986, avg_entr 0.08897744119167328
Test Epoch42 layer1 Acc 0.7062, AUC 0.7736016511917114, avg_entr 0.05260876938700676
Test Epoch42 layer2 Acc 0.7128, AUC 0.7833029627799988, avg_entr 0.04081756994128227
Test Epoch42 layer3 Acc 0.7222, AUC 0.7883641719818115, avg_entr 0.035591598600149155
Test Epoch42 layer4 Acc 0.726, AUC 0.789082407951355, avg_entr 0.04381740838289261
gc 0
Train Epoch43 Acc 0.949825 (37993/40000), AUC 0.9845819473266602
Test Epoch43 layer0 Acc 0.6877, AUC 0.7514193058013916, avg_entr 0.08545839786529541
Test Epoch43 layer1 Acc 0.7082, AUC 0.7708829045295715, avg_entr 0.04911430925130844
Test Epoch43 layer2 Acc 0.7146, AUC 0.7802592515945435, avg_entr 0.03713484853506088
Test Epoch43 layer3 Acc 0.7222, AUC 0.786769449710846, avg_entr 0.032021135091781616
Test Epoch43 layer4 Acc 0.7253, AUC 0.7835593223571777, avg_entr 0.040147148072719574
gc 0
Train Epoch44 Acc 0.95005 (38002/40000), AUC 0.9852104187011719
Test Epoch44 layer0 Acc 0.6882, AUC 0.7508611679077148, avg_entr 0.08465172350406647
Test Epoch44 layer1 Acc 0.7085, AUC 0.7692042589187622, avg_entr 0.051722437143325806
Test Epoch44 layer2 Acc 0.7143, AUC 0.7794866561889648, avg_entr 0.03952973708510399
Test Epoch44 layer3 Acc 0.7194, AUC 0.7860411405563354, avg_entr 0.03283139318227768
Test Epoch44 layer4 Acc 0.725, AUC 0.7837820053100586, avg_entr 0.04031190648674965
gc 0
Train Epoch45 Acc 0.952875 (38115/40000), AUC 0.9860953092575073
Test Epoch45 layer0 Acc 0.6896, AUC 0.7515145540237427, avg_entr 0.08181197196245193
Test Epoch45 layer1 Acc 0.708, AUC 0.7709240913391113, avg_entr 0.048120222985744476
Test Epoch45 layer2 Acc 0.7154, AUC 0.7806397676467896, avg_entr 0.036236897110939026
Test Epoch45 layer3 Acc 0.7238, AUC 0.7867448925971985, avg_entr 0.031191645190119743
Test Epoch45 layer4 Acc 0.727, AUC 0.784792959690094, avg_entr 0.0370018407702446
gc 0
Train Epoch46 Acc 0.95275 (38110/40000), AUC 0.986261785030365
Test Epoch46 layer0 Acc 0.6888, AUC 0.7516235113143921, avg_entr 0.08082401007413864
Test Epoch46 layer1 Acc 0.7077, AUC 0.771324872970581, avg_entr 0.04566437005996704
Test Epoch46 layer2 Acc 0.7145, AUC 0.7807430028915405, avg_entr 0.033795371651649475
Test Epoch46 layer3 Acc 0.7241, AUC 0.7868390083312988, avg_entr 0.030340122058987617
Test Epoch46 layer4 Acc 0.729, AUC 0.7852572798728943, avg_entr 0.03651051968336105
gc 0
Train Epoch47 Acc 0.953825 (38153/40000), AUC 0.9865678548812866
Test Epoch47 layer0 Acc 0.6864, AUC 0.7496640086174011, avg_entr 0.07906366139650345
Test Epoch47 layer1 Acc 0.7056, AUC 0.7691652178764343, avg_entr 0.043995071202516556
Test Epoch47 layer2 Acc 0.716, AUC 0.7787765264511108, avg_entr 0.03264768049120903
Test Epoch47 layer3 Acc 0.7209, AUC 0.7844787240028381, avg_entr 0.029126198962330818
Test Epoch47 layer4 Acc 0.724, AUC 0.7827492952346802, avg_entr 0.03343046084046364
gc 0
Train Epoch48 Acc 0.95435 (38174/40000), AUC 0.9867435693740845
Test Epoch48 layer0 Acc 0.6876, AUC 0.7503138184547424, avg_entr 0.07889749109745026
Test Epoch48 layer1 Acc 0.7065, AUC 0.769545316696167, avg_entr 0.04483320564031601
Test Epoch48 layer2 Acc 0.7132, AUC 0.7796194553375244, avg_entr 0.03483438864350319
Test Epoch48 layer3 Acc 0.7214, AUC 0.7856037020683289, avg_entr 0.031220318749547005
Test Epoch48 layer4 Acc 0.7243, AUC 0.7854804992675781, avg_entr 0.036716654896736145
gc 0
Train Epoch49 Acc 0.955475 (38219/40000), AUC 0.9872657060623169
Test Epoch49 layer0 Acc 0.685, AUC 0.7500661611557007, avg_entr 0.07658486813306808
Test Epoch49 layer1 Acc 0.7075, AUC 0.769616961479187, avg_entr 0.04460807517170906
Test Epoch49 layer2 Acc 0.7136, AUC 0.7794553637504578, avg_entr 0.033031146973371506
Test Epoch49 layer3 Acc 0.721, AUC 0.7846778631210327, avg_entr 0.029358522966504097
Test Epoch49 layer4 Acc 0.7253, AUC 0.7843713760375977, avg_entr 0.03423139080405235
Best AUC 0.8080185651779175
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/imdb_lstmalside_l5_side100//imdb_lstmalside_l5_side.pt
[[3272 1727]
 [1464 3537]]
Figure(640x480)
tensor([0.6581, 0.0205, 0.0212,  ..., 0.0737, 0.0017, 0.5244])
[[3436 1563]
 [1319 3682]]
Figure(640x480)
tensor([0.4523, 0.0141, 0.2183,  ..., 0.0207, 0.0021, 0.0428])
[[3645 1354]
 [1384 3617]]
Figure(640x480)
tensor([0.2447, 0.0007, 0.2105,  ..., 0.0408, 0.0011, 0.0979])
[[3708 1291]
 [1363 3638]]
Figure(640x480)
tensor([0.0351, 0.0050, 0.3607,  ..., 0.0199, 0.0014, 0.0451])
[[3771 1228]
 [1379 3622]]
Figure(640x480)
tensor([0.0464, 0.0028, 0.2550,  ..., 0.0279, 0.0067, 0.2301])
