total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad25_t0.8_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.24445833333333333 (29335/120000), AUC 0.3923947215080261
ep0_train_time 14.606855630874634
Test Epoch0 threshold 0.8 Acc 0.9146381578947368, AUC 0.9807274341583252, avg_entr 0.02659717947244644
ep0_t0.8_test_time 0.07509088516235352
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad25_t0.8_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3204416666666667 (38453/120000), AUC 0.3876491189002991
ep1_train_time 14.370482683181763
Test Epoch1 threshold 0.8 Acc 0.9125, AUC 0.9806615710258484, avg_entr 0.0256376750767231
ep1_t0.8_test_time 0.07210731506347656
gc 0
Train Epoch2 Acc 0.32705 (39246/120000), AUC 0.38231655955314636
ep2_train_time 14.236751556396484
Test Epoch2 threshold 0.8 Acc 0.9105263157894737, AUC 0.9798222780227661, avg_entr 0.024521302431821823
ep2_t0.8_test_time 0.07197999954223633
gc 0
Train Epoch3 Acc 0.3201583333333333 (38419/120000), AUC 0.38672152161598206
ep3_train_time 14.275943756103516
Test Epoch3 threshold 0.8 Acc 0.9098684210526315, AUC 0.9798638820648193, avg_entr 0.02510097436606884
ep3_t0.8_test_time 0.07281970977783203
gc 0
Train Epoch4 Acc 0.3181583333333333 (38179/120000), AUC 0.39851462841033936
ep4_train_time 14.382016897201538
Test Epoch4 threshold 0.8 Acc 0.909375, AUC 0.9797269105911255, avg_entr 0.025985928252339363
ep4_t0.8_test_time 0.07178473472595215
gc 0
Train Epoch5 Acc 0.31309166666666666 (37571/120000), AUC 0.4059848189353943
ep5_train_time 14.096713304519653
Test Epoch5 threshold 0.8 Acc 0.9118421052631579, AUC 0.9794116020202637, avg_entr 0.025284109637141228
ep5_t0.8_test_time 0.0718851089477539
gc 0
Train Epoch6 Acc 0.3157083333333333 (37885/120000), AUC 0.413352906703949
ep6_train_time 14.375176191329956
Test Epoch6 threshold 0.8 Acc 0.9100328947368421, AUC 0.9791830778121948, avg_entr 0.025254957377910614
ep6_t0.8_test_time 0.07161974906921387
gc 0
Train Epoch7 Acc 0.3260166666666667 (39122/120000), AUC 0.4194431006908417
ep7_train_time 14.504068613052368
Test Epoch7 threshold 0.8 Acc 0.909375, AUC 0.9791051149368286, avg_entr 0.025784969329833984
ep7_t0.8_test_time 0.07155227661132812
gc 0
Train Epoch8 Acc 0.3210166666666667 (38522/120000), AUC 0.4229445457458496
ep8_train_time 14.205141067504883
Test Epoch8 threshold 0.8 Acc 0.9103618421052632, AUC 0.9788855910301208, avg_entr 0.025311114266514778
ep8_t0.8_test_time 0.07249093055725098
gc 0
Train Epoch9 Acc 0.320075 (38409/120000), AUC 0.42541033029556274
ep9_train_time 14.549697160720825
Test Epoch9 threshold 0.8 Acc 0.9097039473684211, AUC 0.9786842465400696, avg_entr 0.025524774566292763
ep9_t0.8_test_time 0.07160806655883789
Best AUC 0.9807274341583252
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad25_t0.8_m3//ag_news_lstmal_l5_prefix.pt
Test threshold 0.8 Acc 0.9184210526315789, AUC 0.9860216975212097, avg_entr 0.026790214702486992
t0.8_test_time 0.01884746551513672
