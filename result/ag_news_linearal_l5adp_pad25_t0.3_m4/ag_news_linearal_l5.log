total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.3_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.3395916666666667 (40751/120000), AUC 0.6885699033737183
ep0_train_time 5.8113603591918945
Test Epoch0 threshold 0.3 Acc 0.9133223684210526, AUC 0.9804565906524658, avg_entr 0.025413542985916138
ep0_t0.3_test_time 0.08910965919494629
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.3_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.1868 (22416/120000), AUC 0.6332180500030518
ep1_train_time 5.414550542831421
Test Epoch1 threshold 0.3 Acc 0.9129934210526316, AUC 0.9802401065826416, avg_entr 0.02420142851769924
ep1_t0.3_test_time 0.08733916282653809
gc 0
Train Epoch2 Acc 0.19788333333333333 (23746/120000), AUC 0.6429163813591003
ep2_train_time 5.415280103683472
Test Epoch2 threshold 0.3 Acc 0.9105263157894737, AUC 0.9799474477767944, avg_entr 0.02474488876760006
ep2_t0.3_test_time 0.08440160751342773
gc 0
Train Epoch3 Acc 0.22234166666666666 (26681/120000), AUC 0.6906723976135254
ep3_train_time 5.411213636398315
Test Epoch3 threshold 0.3 Acc 0.912828947368421, AUC 0.9796593189239502, avg_entr 0.024158479645848274
ep3_t0.3_test_time 0.0827341079711914
gc 0
Train Epoch4 Acc 0.244925 (29391/120000), AUC 0.703167736530304
ep4_train_time 5.419118642807007
Test Epoch4 threshold 0.3 Acc 0.9121710526315789, AUC 0.9795453548431396, avg_entr 0.02488691359758377
ep4_t0.3_test_time 0.08473968505859375
gc 0
Train Epoch5 Acc 0.2905083333333333 (34861/120000), AUC 0.7144831418991089
ep5_train_time 5.627300500869751
Test Epoch5 threshold 0.3 Acc 0.9105263157894737, AUC 0.9793078899383545, avg_entr 0.02420119009912014
ep5_t0.3_test_time 0.08755993843078613
gc 0
Train Epoch6 Acc 0.3204916666666667 (38459/120000), AUC 0.718564510345459
ep6_train_time 5.792311668395996
Test Epoch6 threshold 0.3 Acc 0.9100328947368421, AUC 0.9790539145469666, avg_entr 0.024095995351672173
ep6_t0.3_test_time 0.0879662036895752
gc 0
Train Epoch7 Acc 0.36389166666666667 (43667/120000), AUC 0.7223109602928162
ep7_train_time 5.532183885574341
Test Epoch7 threshold 0.3 Acc 0.9095394736842105, AUC 0.9788989424705505, avg_entr 0.02430379018187523
ep7_t0.3_test_time 0.08320188522338867
gc 0
Train Epoch8 Acc 0.39260833333333334 (47113/120000), AUC 0.7247679829597473
ep8_train_time 5.413695573806763
Test Epoch8 threshold 0.3 Acc 0.9087171052631579, AUC 0.9786733388900757, avg_entr 0.024420903995633125
ep8_t0.3_test_time 0.0831441879272461
gc 0
Train Epoch9 Acc 0.4162416666666667 (49949/120000), AUC 0.7263354063034058
ep9_train_time 5.383487224578857
Test Epoch9 threshold 0.3 Acc 0.9092105263157895, AUC 0.9784461259841919, avg_entr 0.02437971532344818
ep9_t0.3_test_time 0.08399081230163574
Best AUC 0.9804565906524658
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.3_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9190789473684211, AUC 0.9854064583778381, avg_entr 0.026105539873242378
t0.3_test_time 0.022703170776367188
