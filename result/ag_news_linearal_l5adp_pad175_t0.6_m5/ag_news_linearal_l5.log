total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.908375 (109005/120000), AUC 0.9841486811637878
ep0_train_time 10.670486450195312
Test Epoch0 threshold 0.6 Acc 0.9162828947368421, AUC 0.9806581735610962, avg_entr 0.025335412472486496
ep0_t0.6_test_time 0.2517130374908447
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9496916666666667 (113963/120000), AUC 0.9930924773216248
ep1_train_time 9.951714277267456
Test Epoch1 threshold 0.6 Acc 0.9167763157894737, AUC 0.9804081320762634, avg_entr 0.02554537169635296
ep1_t0.6_test_time 0.2508547306060791
gc 0
Train Epoch2 Acc 0.9511416666666667 (114137/120000), AUC 0.9933083653450012
ep2_train_time 9.940682172775269
Test Epoch2 threshold 0.6 Acc 0.9146381578947368, AUC 0.980345606803894, avg_entr 0.025649966672062874
ep2_t0.6_test_time 0.2501547336578369
gc 0
Train Epoch3 Acc 0.9522916666666666 (114275/120000), AUC 0.9932957887649536
ep3_train_time 10.052462100982666
Test Epoch3 threshold 0.6 Acc 0.9148026315789474, AUC 0.9801102876663208, avg_entr 0.02556409128010273
ep3_t0.6_test_time 0.25110363960266113
gc 0
Train Epoch4 Acc 0.9530833333333333 (114370/120000), AUC 0.9937158823013306
ep4_train_time 9.93374752998352
Test Epoch4 threshold 0.6 Acc 0.912828947368421, AUC 0.9798334240913391, avg_entr 0.026052866131067276
ep4_t0.6_test_time 0.24970674514770508
gc 0
Train Epoch5 Acc 0.9548583333333334 (114583/120000), AUC 0.994426965713501
ep5_train_time 10.192811727523804
Test Epoch5 threshold 0.6 Acc 0.9131578947368421, AUC 0.9798877239227295, avg_entr 0.0262564979493618
ep5_t0.6_test_time 0.2580883502960205
gc 0
Train Epoch6 Acc 0.9553416666666666 (114641/120000), AUC 0.9944925308227539
ep6_train_time 10.04806900024414
Test Epoch6 threshold 0.6 Acc 0.9120065789473685, AUC 0.9797563552856445, avg_entr 0.026225782930850983
ep6_t0.6_test_time 0.2512032985687256
gc 0
Train Epoch7 Acc 0.9559666666666666 (114716/120000), AUC 0.9947364330291748
ep7_train_time 9.910193681716919
Test Epoch7 threshold 0.6 Acc 0.9118421052631579, AUC 0.9796400666236877, avg_entr 0.02646457776427269
ep7_t0.6_test_time 0.252105712890625
gc 0
Train Epoch8 Acc 0.9562833333333334 (114754/120000), AUC 0.9948325157165527
ep8_train_time 10.040287733078003
Test Epoch8 threshold 0.6 Acc 0.9125, AUC 0.9796311259269714, avg_entr 0.026520583778619766
ep8_t0.6_test_time 0.2513306140899658
gc 0
Train Epoch9 Acc 0.957475 (114897/120000), AUC 0.9951897859573364
ep9_train_time 9.979654550552368
Test Epoch9 threshold 0.6 Acc 0.9129934210526316, AUC 0.979532778263092, avg_entr 0.02602194994688034
ep9_t0.6_test_time 0.25126051902770996
Best AUC 0.9806581735610962
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.6_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9236842105263158, AUC 0.9862426519393921, avg_entr 0.023871246725320816
t0.6_test_time 0.06361055374145508
