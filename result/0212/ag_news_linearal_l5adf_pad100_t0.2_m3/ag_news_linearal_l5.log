total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.2_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.25011666666666665 (30014/120000), AUC 0.5073978900909424
ep0_train_time 7.339253902435303
Test Epoch0 threshold 0.2 Acc 0.9159539473684211, AUC 0.9806675910949707, avg_entr 0.02445283718407154
ep0_t0.2_test_time 0.17783188819885254
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.2_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25011666666666665 (30014/120000), AUC 0.4970282018184662
ep1_train_time 7.6046881675720215
Test Epoch1 threshold 0.2 Acc 0.9151315789473684, AUC 0.9805768728256226, avg_entr 0.024653282016515732
ep1_t0.2_test_time 0.1889972686767578
gc 0
Train Epoch2 Acc 0.25015 (30018/120000), AUC 0.5019190311431885
ep2_train_time 7.906398773193359
Test Epoch2 threshold 0.2 Acc 0.9164473684210527, AUC 0.9803569912910461, avg_entr 0.024427784606814384
ep2_t0.2_test_time 0.18779277801513672
gc 0
Train Epoch3 Acc 0.2502333333333333 (30028/120000), AUC 0.49815186858177185
ep3_train_time 7.149071931838989
Test Epoch3 threshold 0.2 Acc 0.9136513157894737, AUC 0.979965090751648, avg_entr 0.0239388607442379
ep3_t0.2_test_time 0.17705607414245605
gc 0
Train Epoch4 Acc 0.25064166666666665 (30077/120000), AUC 0.46325069665908813
ep4_train_time 6.921621799468994
Test Epoch4 threshold 0.2 Acc 0.9149671052631579, AUC 0.9800575971603394, avg_entr 0.022931372746825218
ep4_t0.2_test_time 0.17693734169006348
gc 0
Train Epoch5 Acc 0.250725 (30087/120000), AUC 0.45508891344070435
ep5_train_time 6.960810661315918
Test Epoch5 threshold 0.2 Acc 0.9139802631578947, AUC 0.9798026084899902, avg_entr 0.023113371804356575
ep5_t0.2_test_time 0.17735719680786133
gc 0
Train Epoch6 Acc 0.25080833333333336 (30097/120000), AUC 0.4386889338493347
ep6_train_time 6.936424255371094
Test Epoch6 threshold 0.2 Acc 0.9121710526315789, AUC 0.9796724915504456, avg_entr 0.021178586408495903
ep6_t0.2_test_time 0.1769707202911377
gc 0
Train Epoch7 Acc 0.25080833333333336 (30097/120000), AUC 0.4211135506629944
ep7_train_time 6.893157005310059
Test Epoch7 threshold 0.2 Acc 0.9115131578947369, AUC 0.9795425534248352, avg_entr 0.021311039105057716
ep7_t0.2_test_time 0.17694377899169922
gc 0
Train Epoch8 Acc 0.25080833333333336 (30097/120000), AUC 0.4111923575401306
ep8_train_time 6.9731926918029785
Test Epoch8 threshold 0.2 Acc 0.9125, AUC 0.9793523550033569, avg_entr 0.020322654396295547
ep8_t0.2_test_time 0.1771085262298584
gc 0
Train Epoch9 Acc 0.25071666666666664 (30086/120000), AUC 0.40669959783554077
ep9_train_time 7.423340320587158
Test Epoch9 threshold 0.2 Acc 0.9106907894736842, AUC 0.9794100522994995, avg_entr 0.019768670201301575
ep9_t0.2_test_time 0.1845254898071289
Best AUC 0.9806675910949707
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.2_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9243421052631579, AUC 0.9862024784088135, avg_entr 0.023584237322211266
t0.2_test_time 0.04932403564453125
