total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.3364333333333333 (40372/120000), AUC 0.5618721842765808
ep0_train_time 7.014080762863159
Test Epoch0 threshold 0.1 Acc 0.9036184210526316, AUC 0.9749242067337036, avg_entr 0.17511123418807983
ep0_t0.1_test_time 0.19282245635986328
Save ckpt to ckpt/ag_news_linearal_l5adf_pad125_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.31475 (37770/120000), AUC 0.639687180519104
ep1_train_time 6.605834007263184
Test Epoch1 threshold 0.1 Acc 0.9146381578947368, AUC 0.9784402847290039, avg_entr 0.10205109417438507
ep1_t0.1_test_time 0.19170761108398438
Save ckpt to ckpt/ag_news_linearal_l5adf_pad125_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.27846666666666664 (33416/120000), AUC 0.639930784702301
ep2_train_time 6.595442533493042
Test Epoch2 threshold 0.1 Acc 0.9146381578947368, AUC 0.9799872636795044, avg_entr 0.07764595746994019
ep2_t0.1_test_time 0.19131875038146973
Save ckpt to ckpt/ag_news_linearal_l5adf_pad125_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.273125 (32775/120000), AUC 0.635927677154541
ep3_train_time 6.578662395477295
Test Epoch3 threshold 0.1 Acc 0.9133223684210526, AUC 0.9804700016975403, avg_entr 0.06742768734693527
ep3_t0.1_test_time 0.1911463737487793
Save ckpt to ckpt/ag_news_linearal_l5adf_pad125_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.272975 (32757/120000), AUC 0.631861686706543
ep4_train_time 6.6150596141815186
Test Epoch4 threshold 0.1 Acc 0.9162828947368421, AUC 0.9805120229721069, avg_entr 0.058413319289684296
ep4_t0.1_test_time 0.19226551055908203
Save ckpt to ckpt/ag_news_linearal_l5adf_pad125_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.2718833333333333 (32626/120000), AUC 0.6271798014640808
ep5_train_time 6.630645751953125
Test Epoch5 threshold 0.1 Acc 0.9144736842105263, AUC 0.9804868698120117, avg_entr 0.05319144204258919
ep5_t0.1_test_time 0.1920452117919922
gc 0
Train Epoch6 Acc 0.2687333333333333 (32248/120000), AUC 0.6228911876678467
ep6_train_time 6.641892671585083
Test Epoch6 threshold 0.1 Acc 0.9154605263157894, AUC 0.980423629283905, avg_entr 0.04876260831952095
ep6_t0.1_test_time 0.19195055961608887
gc 0
