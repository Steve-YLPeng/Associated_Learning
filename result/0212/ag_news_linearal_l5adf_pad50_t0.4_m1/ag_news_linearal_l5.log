total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.23453333333333334 (28144/120000), AUC 0.5002186894416809
ep0_train_time 4.961016893386841
Test Epoch0 threshold 0.4 Acc 0.9118421052631579, AUC 0.9774143695831299, avg_entr 0.15915484726428986
ep0_t0.4_test_time 0.10224699974060059
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.23074166666666668 (27689/120000), AUC 0.5066851377487183
ep1_train_time 4.475450277328491
Test Epoch1 threshold 0.4 Acc 0.9159539473684211, AUC 0.9798731207847595, avg_entr 0.09588070213794708
ep1_t0.4_test_time 0.10726189613342285
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.22571666666666668 (27086/120000), AUC 0.5055726170539856
ep2_train_time 4.881069183349609
Test Epoch2 threshold 0.4 Acc 0.9167763157894737, AUC 0.9802745580673218, avg_entr 0.07678515464067459
ep2_t0.4_test_time 0.10392951965332031
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.22365833333333332 (26839/120000), AUC 0.5042251944541931
ep3_train_time 4.561703443527222
Test Epoch3 threshold 0.4 Acc 0.9162828947368421, AUC 0.980319082736969, avg_entr 0.06496874988079071
ep3_t0.4_test_time 0.10097122192382812
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.22175833333333334 (26611/120000), AUC 0.5032616853713989
ep4_train_time 4.514598846435547
Test Epoch4 threshold 0.4 Acc 0.9166118421052631, AUC 0.9800312519073486, avg_entr 0.061140187084674835
ep4_t0.4_test_time 0.10093951225280762
gc 0
Train Epoch5 Acc 0.21998333333333334 (26398/120000), AUC 0.5025745630264282
ep5_train_time 4.484768629074097
Test Epoch5 threshold 0.4 Acc 0.9120065789473685, AUC 0.9797041416168213, avg_entr 0.05573077127337456
ep5_t0.4_test_time 0.10050010681152344
gc 0
Train Epoch6 Acc 0.217775 (26133/120000), AUC 0.5017670392990112
ep6_train_time 4.547881364822388
Test Epoch6 threshold 0.4 Acc 0.9123355263157895, AUC 0.9796740412712097, avg_entr 0.050036314874887466
ep6_t0.4_test_time 0.1013178825378418
gc 0
Train Epoch7 Acc 0.2162 (25944/120000), AUC 0.501427173614502
ep7_train_time 4.539106369018555
Test Epoch7 threshold 0.4 Acc 0.9126644736842106, AUC 0.9797003269195557, avg_entr 0.04803067818284035
ep7_t0.4_test_time 0.10058093070983887
gc 0
Train Epoch8 Acc 0.21508333333333332 (25810/120000), AUC 0.5008262395858765
ep8_train_time 4.525617837905884
Test Epoch8 threshold 0.4 Acc 0.9133223684210526, AUC 0.9797147512435913, avg_entr 0.045728348195552826
ep8_t0.4_test_time 0.10070037841796875
gc 0
Train Epoch9 Acc 0.21345833333333333 (25615/120000), AUC 0.5002641677856445
ep9_train_time 4.514563322067261
Test Epoch9 threshold 0.4 Acc 0.9141447368421053, AUC 0.9794561266899109, avg_entr 0.04384572431445122
ep9_t0.4_test_time 0.10053420066833496
Best AUC 0.980319082736969
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.4_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.925, AUC 0.986000657081604, avg_entr 0.06794903427362442
t0.4_test_time 0.02617955207824707
