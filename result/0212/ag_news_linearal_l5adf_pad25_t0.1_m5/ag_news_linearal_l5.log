total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.1_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.8908416666666666 (106901/120000), AUC 0.9801404476165771
ep0_train_time 6.319897890090942
Test Epoch0 threshold 0.1 Acc 0.9136513157894737, AUC 0.9800077676773071, avg_entr 0.019471345469355583
ep0_t0.1_test_time 0.1031339168548584
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.1_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9486583333333334 (113839/120000), AUC 0.9929077625274658
ep1_train_time 5.845180511474609
Test Epoch1 threshold 0.1 Acc 0.9144736842105263, AUC 0.9799504280090332, avg_entr 0.015241170302033424
ep1_t0.1_test_time 0.101226806640625
gc 0
Train Epoch2 Acc 0.9504833333333333 (114058/120000), AUC 0.9931259155273438
ep2_train_time 5.8232691287994385
Test Epoch2 threshold 0.1 Acc 0.9141447368421053, AUC 0.9798225164413452, avg_entr 0.01293933019042015
ep2_t0.1_test_time 0.10096549987792969
gc 0
Train Epoch3 Acc 0.95205 (114246/120000), AUC 0.9932723045349121
ep3_train_time 5.812059164047241
Test Epoch3 threshold 0.1 Acc 0.9098684210526315, AUC 0.9793041348457336, avg_entr 0.012466633692383766
ep3_t0.1_test_time 0.10119986534118652
gc 0
Train Epoch4 Acc 0.9532166666666667 (114386/120000), AUC 0.9935475587844849
ep4_train_time 5.7709572315216064
Test Epoch4 threshold 0.1 Acc 0.9115131578947369, AUC 0.9791733026504517, avg_entr 0.01195209939032793
ep4_t0.1_test_time 0.10018563270568848
gc 0
Train Epoch5 Acc 0.9557083333333334 (114685/120000), AUC 0.9945229291915894
ep5_train_time 5.9073309898376465
Test Epoch5 threshold 0.1 Acc 0.9103618421052632, AUC 0.978748619556427, avg_entr 0.011819148436188698
ep5_t0.1_test_time 0.10041117668151855
gc 0
Train Epoch6 Acc 0.9565083333333333 (114781/120000), AUC 0.9946814775466919
ep6_train_time 5.898776292800903
Test Epoch6 threshold 0.1 Acc 0.9105263157894737, AUC 0.9785544872283936, avg_entr 0.010983575135469437
ep6_t0.1_test_time 0.09912681579589844
gc 0
Train Epoch7 Acc 0.95705 (114846/120000), AUC 0.9948568344116211
ep7_train_time 5.970820903778076
Test Epoch7 threshold 0.1 Acc 0.9110197368421052, AUC 0.9783549308776855, avg_entr 0.010961762629449368
ep7_t0.1_test_time 0.10060000419616699
gc 0
Train Epoch8 Acc 0.9572916666666667 (114875/120000), AUC 0.994956910610199
ep8_train_time 6.111772060394287
Test Epoch8 threshold 0.1 Acc 0.9103618421052632, AUC 0.9782784581184387, avg_entr 0.010977072641253471
ep8_t0.1_test_time 0.10346078872680664
gc 0
Train Epoch9 Acc 0.9586583333333333 (115039/120000), AUC 0.9953981637954712
ep9_train_time 6.266713857650757
Test Epoch9 threshold 0.1 Acc 0.9098684210526315, AUC 0.9781069755554199, avg_entr 0.01087416335940361
ep9_t0.1_test_time 0.10242581367492676
Best AUC 0.9800077676773071
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.1_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9217105263157894, AUC 0.9851876497268677, avg_entr 0.0217340849339962
t0.1_test_time 0.02700066566467285
