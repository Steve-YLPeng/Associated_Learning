total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.6_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.20303333333333334 (24364/120000), AUC 0.6470211744308472
ep0_train_time 6.227545499801636
Test Epoch0 threshold 0.6 Acc 0.9120065789473685, AUC 0.9799098372459412, avg_entr 0.024665923789143562
ep0_t0.6_test_time 0.07356476783752441
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.6_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.27513333333333334 (33016/120000), AUC 0.6572195291519165
ep1_train_time 5.467965364456177
Test Epoch1 threshold 0.6 Acc 0.9111842105263158, AUC 0.980124831199646, avg_entr 0.023827066645026207
ep1_t0.6_test_time 0.07188868522644043
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.6_m4//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.28836666666666666 (34604/120000), AUC 0.6278206706047058
ep2_train_time 5.454225778579712
Test Epoch2 threshold 0.6 Acc 0.9092105263157895, AUC 0.979584813117981, avg_entr 0.02479112520813942
ep2_t0.6_test_time 0.07229471206665039
gc 0
Train Epoch3 Acc 0.30340833333333334 (36409/120000), AUC 0.5760718584060669
ep3_train_time 5.40887188911438
Test Epoch3 threshold 0.6 Acc 0.9098684210526315, AUC 0.979633629322052, avg_entr 0.025236843153834343
ep3_t0.6_test_time 0.07219386100769043
gc 0
Train Epoch4 Acc 0.28785 (34542/120000), AUC 0.55772864818573
ep4_train_time 5.431373119354248
Test Epoch4 threshold 0.6 Acc 0.909375, AUC 0.9793187379837036, avg_entr 0.02477322891354561
ep4_t0.6_test_time 0.0711219310760498
gc 0
Train Epoch5 Acc 0.2769 (33228/120000), AUC 0.5392637848854065
ep5_train_time 5.444730758666992
Test Epoch5 threshold 0.6 Acc 0.909375, AUC 0.9792848229408264, avg_entr 0.025199074298143387
ep5_t0.6_test_time 0.0717768669128418
gc 0
Train Epoch6 Acc 0.276475 (33177/120000), AUC 0.5227699279785156
ep6_train_time 5.422804117202759
Test Epoch6 threshold 0.6 Acc 0.9095394736842105, AUC 0.9789673686027527, avg_entr 0.024893105030059814
ep6_t0.6_test_time 0.0709238052368164
gc 0
Train Epoch7 Acc 0.27875 (33450/120000), AUC 0.5154038667678833
ep7_train_time 5.419625520706177
Test Epoch7 threshold 0.6 Acc 0.9087171052631579, AUC 0.9787792563438416, avg_entr 0.02513076551258564
ep7_t0.6_test_time 0.07160258293151855
gc 0
Train Epoch8 Acc 0.2785 (33420/120000), AUC 0.5103824138641357
ep8_train_time 5.432700872421265
Test Epoch8 threshold 0.6 Acc 0.909375, AUC 0.9785794019699097, avg_entr 0.024954702705144882
ep8_t0.6_test_time 0.07222104072570801
gc 0
Train Epoch9 Acc 0.276125 (33135/120000), AUC 0.5065855383872986
ep9_train_time 5.782240629196167
Test Epoch9 threshold 0.6 Acc 0.9078947368421053, AUC 0.9785187840461731, avg_entr 0.024893926456570625
ep9_t0.6_test_time 0.07336568832397461
Best AUC 0.980124831199646
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.6_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9184210526315789, AUC 0.9849427342414856, avg_entr 0.026942584663629532
t0.6_test_time 0.01912689208984375
