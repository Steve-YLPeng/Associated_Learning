total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.1_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.2504166666666667 (30050/120000), AUC 0.46495169401168823
ep0_train_time 4.998855352401733
Test Epoch0 threshold 0.1 Acc 0.9136513157894737, AUC 0.9809441566467285, avg_entr 0.03250735253095627
ep0_t0.1_test_time 0.08293390274047852
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.1_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2503416666666667 (30041/120000), AUC 0.43954920768737793
ep1_train_time 4.535754919052124
Test Epoch1 threshold 0.1 Acc 0.9134868421052632, AUC 0.9806199073791504, avg_entr 0.029307248070836067
ep1_t0.1_test_time 0.07900547981262207
gc 0
Train Epoch2 Acc 0.24976666666666666 (29972/120000), AUC 0.42177918553352356
ep2_train_time 4.540513277053833
Test Epoch2 threshold 0.1 Acc 0.9129934210526316, AUC 0.9804434180259705, avg_entr 0.02745790034532547
ep2_t0.1_test_time 0.08283090591430664
gc 0
Train Epoch3 Acc 0.24925 (29910/120000), AUC 0.40545231103897095
ep3_train_time 4.565991640090942
Test Epoch3 threshold 0.1 Acc 0.9113486842105263, AUC 0.9804683923721313, avg_entr 0.02683749422430992
ep3_t0.1_test_time 0.07988500595092773
gc 0
Train Epoch4 Acc 0.24876666666666666 (29852/120000), AUC 0.3895413279533386
ep4_train_time 4.5423264503479
Test Epoch4 threshold 0.1 Acc 0.9126644736842106, AUC 0.9797369241714478, avg_entr 0.025810573250055313
ep4_t0.1_test_time 0.08225369453430176
gc 0
Train Epoch5 Acc 0.24846666666666667 (29816/120000), AUC 0.37681686878204346
ep5_train_time 4.54115104675293
Test Epoch5 threshold 0.1 Acc 0.9118421052631579, AUC 0.97963547706604, avg_entr 0.02556099370121956
ep5_t0.1_test_time 0.07938194274902344
gc 0
Train Epoch6 Acc 0.2482 (29784/120000), AUC 0.3707348704338074
ep6_train_time 4.534624099731445
Test Epoch6 threshold 0.1 Acc 0.9100328947368421, AUC 0.9793263673782349, avg_entr 0.025576137006282806
ep6_t0.1_test_time 0.07922863960266113
gc 0
Train Epoch7 Acc 0.247525 (29703/120000), AUC 0.3639019727706909
ep7_train_time 4.55755877494812
Test Epoch7 threshold 0.1 Acc 0.9108552631578948, AUC 0.9789998531341553, avg_entr 0.024690359830856323
ep7_t0.1_test_time 0.07951164245605469
gc 0
Train Epoch8 Acc 0.24695 (29634/120000), AUC 0.356893390417099
ep8_train_time 4.526342153549194
Test Epoch8 threshold 0.1 Acc 0.9098684210526315, AUC 0.9789742827415466, avg_entr 0.024977242574095726
ep8_t0.1_test_time 0.07884025573730469
gc 0
Train Epoch9 Acc 0.246 (29520/120000), AUC 0.3510437607765198
ep9_train_time 4.51436972618103
Test Epoch9 threshold 0.1 Acc 0.9092105263157895, AUC 0.9787147045135498, avg_entr 0.0248198714107275
ep9_t0.1_test_time 0.07950568199157715
Best AUC 0.9809441566467285
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.1_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9236842105263158, AUC 0.9856131672859192, avg_entr 0.03447980806231499
t0.1_test_time 0.020612239837646484
