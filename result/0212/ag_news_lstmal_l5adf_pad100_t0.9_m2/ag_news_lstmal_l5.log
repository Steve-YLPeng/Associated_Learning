total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad100_t0.9_m1//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.25255 (30306/120000), AUC 0.3806876540184021
ep0_train_time 33.9986298084259
Test Epoch0 threshold 0.9 Acc 0.915625, AUC 0.980738639831543, avg_entr 0.0298478826880455
ep0_t0.9_test_time 0.1665351390838623
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad100_t0.9_m2//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25280833333333336 (30337/120000), AUC 0.3843151926994324
ep1_train_time 33.921924352645874
Test Epoch1 threshold 0.9 Acc 0.9164473684210527, AUC 0.9807956218719482, avg_entr 0.027810120955109596
ep1_t0.9_test_time 0.1625378131866455
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad100_t0.9_m2//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25193333333333334 (30232/120000), AUC 0.3762088716030121
ep2_train_time 33.93895673751831
Test Epoch2 threshold 0.9 Acc 0.9151315789473684, AUC 0.9804469347000122, avg_entr 0.026802726089954376
ep2_t0.9_test_time 0.16383934020996094
gc 0
Train Epoch3 Acc 0.2514166666666667 (30170/120000), AUC 0.3674212098121643
ep3_train_time 33.96441459655762
Test Epoch3 threshold 0.9 Acc 0.9157894736842105, AUC 0.980355441570282, avg_entr 0.02649622969329357
ep3_t0.9_test_time 0.1636824607849121
gc 0
Train Epoch4 Acc 0.250825 (30099/120000), AUC 0.36191368103027344
ep4_train_time 33.946528673172
Test Epoch4 threshold 0.9 Acc 0.9126644736842106, AUC 0.9801529049873352, avg_entr 0.026824351400136948
ep4_t0.9_test_time 0.1645650863647461
gc 0
Train Epoch5 Acc 0.25051666666666667 (30062/120000), AUC 0.36071068048477173
ep5_train_time 33.98484945297241
Test Epoch5 threshold 0.9 Acc 0.9133223684210526, AUC 0.9799651503562927, avg_entr 0.02648381143808365
ep5_t0.9_test_time 0.16376376152038574
gc 0
Train Epoch6 Acc 0.25054166666666666 (30065/120000), AUC 0.35936111211776733
ep6_train_time 34.03015995025635
Test Epoch6 threshold 0.9 Acc 0.9131578947368421, AUC 0.9798738956451416, avg_entr 0.026347089558839798
ep6_t0.9_test_time 0.1633164882659912
gc 0
Train Epoch7 Acc 0.250475 (30057/120000), AUC 0.3584257662296295
ep7_train_time 34.02748370170593
Test Epoch7 threshold 0.9 Acc 0.9123355263157895, AUC 0.9797055125236511, avg_entr 0.026658939197659492
ep7_t0.9_test_time 0.16639924049377441
gc 0
Train Epoch8 Acc 0.25038333333333335 (30046/120000), AUC 0.35671931505203247
ep8_train_time 33.95944356918335
Test Epoch8 threshold 0.9 Acc 0.9115131578947369, AUC 0.9794542789459229, avg_entr 0.02658582665026188
ep8_t0.9_test_time 0.16402244567871094
gc 0
Train Epoch9 Acc 0.25025 (30030/120000), AUC 0.3556661903858185
ep9_train_time 34.06299686431885
Test Epoch9 threshold 0.9 Acc 0.9126644736842106, AUC 0.9795158505439758, avg_entr 0.026755686849355698
ep9_t0.9_test_time 0.1643362045288086
Best AUC 0.9807956218719482
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad100_t0.9_m2//ag_news_lstmal_l5_prefix.pt
Test threshold 0.9 Acc 0.9217105263157894, AUC 0.98592209815979, avg_entr 0.026633579283952713
t0.9_test_time 0.041562557220458984
