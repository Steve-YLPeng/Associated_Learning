total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.14569166666666666 (17483/120000), AUC 0.4318338632583618
ep0_train_time 4.955127000808716
Test Epoch0 threshold 0.7 Acc 0.9105263157894737, AUC 0.9781297445297241, avg_entr 0.15976232290267944
ep0_t0.7_test_time 0.10340499877929688
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.123575 (14829/120000), AUC 0.41827547550201416
ep1_train_time 4.503279447555542
Test Epoch1 threshold 0.7 Acc 0.9134868421052632, AUC 0.9800975918769836, avg_entr 0.09926420450210571
ep1_t0.7_test_time 0.10122919082641602
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.122425 (14691/120000), AUC 0.42028695344924927
ep2_train_time 4.503290414810181
Test Epoch2 threshold 0.7 Acc 0.9166118421052631, AUC 0.9808634519577026, avg_entr 0.07999084889888763
ep2_t0.7_test_time 0.10127043724060059
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.12041666666666667 (14450/120000), AUC 0.4212976098060608
ep3_train_time 4.489682912826538
Test Epoch3 threshold 0.7 Acc 0.9164473684210527, AUC 0.9802379608154297, avg_entr 0.06674056500196457
ep3_t0.7_test_time 0.10149192810058594
gc 0
Train Epoch4 Acc 0.11980833333333334 (14377/120000), AUC 0.4212166666984558
ep4_train_time 4.47944712638855
Test Epoch4 threshold 0.7 Acc 0.915625, AUC 0.9805270433425903, avg_entr 0.05920800566673279
ep4_t0.7_test_time 0.10135436058044434
gc 0
Train Epoch5 Acc 0.11968333333333334 (14362/120000), AUC 0.42062056064605713
ep5_train_time 4.623830318450928
Test Epoch5 threshold 0.7 Acc 0.9120065789473685, AUC 0.9800736904144287, avg_entr 0.05526027828454971
ep5_t0.7_test_time 0.10839462280273438
gc 0
Train Epoch6 Acc 0.12000833333333333 (14401/120000), AUC 0.41993239521980286
ep6_train_time 4.8186235427856445
Test Epoch6 threshold 0.7 Acc 0.9129934210526316, AUC 0.9798652529716492, avg_entr 0.05185595899820328
ep6_t0.7_test_time 0.10530757904052734
gc 0
Train Epoch7 Acc 0.12031666666666667 (14438/120000), AUC 0.41918373107910156
ep7_train_time 4.677084684371948
Test Epoch7 threshold 0.7 Acc 0.9138157894736842, AUC 0.9798246622085571, avg_entr 0.04851266369223595
ep7_t0.7_test_time 0.10128164291381836
gc 0
Train Epoch8 Acc 0.12200833333333333 (14641/120000), AUC 0.4204115569591522
ep8_train_time 4.559159278869629
Test Epoch8 threshold 0.7 Acc 0.9141447368421053, AUC 0.9796056747436523, avg_entr 0.046578895300626755
ep8_t0.7_test_time 0.10166001319885254
gc 0
Train Epoch9 Acc 0.123225 (14787/120000), AUC 0.42104193568229675
ep9_train_time 4.529092073440552
Test Epoch9 threshold 0.7 Acc 0.9123355263157895, AUC 0.9793885946273804, avg_entr 0.045204102993011475
ep9_t0.7_test_time 0.10136580467224121
Best AUC 0.9808634519577026
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.7_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9269736842105263, AUC 0.9862569570541382, avg_entr 0.08296266198158264
t0.7_test_time 0.026293039321899414
