total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.08831666666666667 (10598/120000), AUC 0.39812618494033813
ep0_train_time 9.59236764907837
Test Epoch0 threshold 0.6 Acc 0.9174342105263158, AUC 0.9809428453445435, avg_entr 0.025925353169441223
ep0_t0.6_test_time 0.2571535110473633
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.048666666666666664 (5840/120000), AUC 0.40372413396835327
ep1_train_time 8.960935592651367
Test Epoch1 threshold 0.6 Acc 0.9167763157894737, AUC 0.9807928204536438, avg_entr 0.026563093066215515
ep1_t0.6_test_time 0.2569577693939209
gc 0
Train Epoch2 Acc 0.020591666666666668 (2471/120000), AUC 0.37539607286453247
ep2_train_time 8.91892385482788
Test Epoch2 threshold 0.6 Acc 0.9154605263157894, AUC 0.9806839227676392, avg_entr 0.025681043043732643
ep2_t0.6_test_time 0.25500011444091797
gc 0
Train Epoch3 Acc 0.016916666666666667 (2030/120000), AUC 0.36315983533859253
ep3_train_time 8.962949514389038
Test Epoch3 threshold 0.6 Acc 0.9166118421052631, AUC 0.9805656671524048, avg_entr 0.026555262506008148
ep3_t0.6_test_time 0.25728559494018555
gc 0
Train Epoch4 Acc 0.023558333333333334 (2827/120000), AUC 0.3528449535369873
ep4_train_time 9.098316192626953
Test Epoch4 threshold 0.6 Acc 0.9159539473684211, AUC 0.980392575263977, avg_entr 0.026075327768921852
ep4_t0.6_test_time 0.2550690174102783
gc 0
Train Epoch5 Acc 0.04443333333333333 (5332/120000), AUC 0.32910794019699097
ep5_train_time 9.175238847732544
Test Epoch5 threshold 0.6 Acc 0.9138157894736842, AUC 0.9802278280258179, avg_entr 0.024918369948863983
ep5_t0.6_test_time 0.2667675018310547
gc 0
Train Epoch6 Acc 0.07746666666666667 (9296/120000), AUC 0.3107290267944336
ep6_train_time 9.271505117416382
Test Epoch6 threshold 0.6 Acc 0.9106907894736842, AUC 0.9800976514816284, avg_entr 0.02569861337542534
ep6_t0.6_test_time 0.2561228275299072
gc 0
Train Epoch7 Acc 0.11680833333333333 (14017/120000), AUC 0.29895004630088806
ep7_train_time 9.01974105834961
Test Epoch7 threshold 0.6 Acc 0.9148026315789474, AUC 0.9800201058387756, avg_entr 0.02628929913043976
ep7_t0.6_test_time 0.2538869380950928
gc 0
Train Epoch8 Acc 0.15174166666666666 (18209/120000), AUC 0.2934115529060364
ep8_train_time 8.936839818954468
Test Epoch8 threshold 0.6 Acc 0.9146381578947368, AUC 0.9798730611801147, avg_entr 0.0254710353910923
ep8_t0.6_test_time 0.2541830539703369
gc 0
Train Epoch9 Acc 0.17123333333333332 (20548/120000), AUC 0.29295799136161804
ep9_train_time 9.01426386833191
Test Epoch9 threshold 0.6 Acc 0.9131578947368421, AUC 0.9797978401184082, avg_entr 0.025838280096650124
ep9_t0.6_test_time 0.2538022994995117
Best AUC 0.9809428453445435
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9223684210526316, AUC 0.9865740537643433, avg_entr 0.025241795927286148
t0.6_test_time 0.06370115280151367
