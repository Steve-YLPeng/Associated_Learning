total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.7_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9169916666666666 (110039/120000), AUC 0.9852444529533386
ep0_train_time 6.328089475631714
Test Epoch0 threshold 0.7 Acc 0.9116776315789473, AUC 0.9797985553741455, avg_entr 0.024171119555830956
ep0_t0.7_test_time 0.07209563255310059
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.7_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9500916666666667 (114011/120000), AUC 0.9932197332382202
ep1_train_time 5.973247766494751
Test Epoch1 threshold 0.7 Acc 0.9113486842105263, AUC 0.9797906279563904, avg_entr 0.025194132700562477
ep1_t0.7_test_time 0.07096171379089355
gc 0
Train Epoch2 Acc 0.9516833333333333 (114202/120000), AUC 0.9933303594589233
ep2_train_time 5.967138767242432
Test Epoch2 threshold 0.7 Acc 0.9111842105263158, AUC 0.9797618389129639, avg_entr 0.024644138291478157
ep2_t0.7_test_time 0.07085418701171875
gc 0
Train Epoch3 Acc 0.9529416666666667 (114353/120000), AUC 0.9936279058456421
ep3_train_time 5.908761739730835
Test Epoch3 threshold 0.7 Acc 0.9120065789473685, AUC 0.9792065024375916, avg_entr 0.02488058991730213
ep3_t0.7_test_time 0.07152175903320312
gc 0
Train Epoch4 Acc 0.9537166666666667 (114446/120000), AUC 0.9938791394233704
ep4_train_time 5.902708053588867
Test Epoch4 threshold 0.7 Acc 0.9101973684210526, AUC 0.9792110323905945, avg_entr 0.0247495174407959
ep4_t0.7_test_time 0.07145094871520996
gc 0
Train Epoch5 Acc 0.9566833333333333 (114802/120000), AUC 0.994716465473175
ep5_train_time 5.914993762969971
Test Epoch5 threshold 0.7 Acc 0.9097039473684211, AUC 0.9790048003196716, avg_entr 0.024980392307043076
ep5_t0.7_test_time 0.07120084762573242
gc 0
Train Epoch6 Acc 0.9570083333333333 (114841/120000), AUC 0.9948307275772095
ep6_train_time 5.90667724609375
Test Epoch6 threshold 0.7 Acc 0.9092105263157895, AUC 0.9786839485168457, avg_entr 0.025162912905216217
ep6_t0.7_test_time 0.07040166854858398
gc 0
Train Epoch7 Acc 0.957475 (114897/120000), AUC 0.9949636459350586
ep7_train_time 6.2350852489471436
Test Epoch7 threshold 0.7 Acc 0.9100328947368421, AUC 0.9785734415054321, avg_entr 0.02457350678741932
ep7_t0.7_test_time 0.07311463356018066
gc 0
Train Epoch8 Acc 0.9579666666666666 (114956/120000), AUC 0.9951429963111877
ep8_train_time 6.38109278678894
Test Epoch8 threshold 0.7 Acc 0.9088815789473684, AUC 0.978405773639679, avg_entr 0.024939818307757378
ep8_t0.7_test_time 0.07336902618408203
gc 0
Train Epoch9 Acc 0.95915 (115098/120000), AUC 0.9955476522445679
ep9_train_time 6.123116493225098
Test Epoch9 threshold 0.7 Acc 0.9088815789473684, AUC 0.9784026145935059, avg_entr 0.025228530168533325
ep9_t0.7_test_time 0.07118797302246094
Best AUC 0.9797985553741455
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.7_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9190789473684211, AUC 0.985448956489563, avg_entr 0.025709277018904686
t0.7_test_time 0.01867842674255371
