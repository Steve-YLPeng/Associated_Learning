total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.1_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.091525 (10983/120000), AUC 0.33326029777526855
ep0_train_time 6.7387800216674805
Test Epoch0 threshold 0.1 Acc 0.9167763157894737, AUC 0.980245053768158, avg_entr 0.02226155996322632
ep0_t0.1_test_time 0.12696290016174316
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.1_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.08010833333333334 (9613/120000), AUC 0.36085084080696106
ep1_train_time 6.238121032714844
Test Epoch1 threshold 0.1 Acc 0.9149671052631579, AUC 0.9797927737236023, avg_entr 0.02133481204509735
ep1_t0.1_test_time 0.12564921379089355
gc 0
Train Epoch2 Acc 0.025175 (3021/120000), AUC 0.37151286005973816
ep2_train_time 6.29145073890686
Test Epoch2 threshold 0.1 Acc 0.9139802631578947, AUC 0.9796449542045593, avg_entr 0.018868964165449142
ep2_t0.1_test_time 0.1258559226989746
gc 0
Train Epoch3 Acc 0.0251 (3012/120000), AUC 0.3842512369155884
ep3_train_time 6.24067497253418
Test Epoch3 threshold 0.1 Acc 0.9120065789473685, AUC 0.9794132113456726, avg_entr 0.015429739840328693
ep3_t0.1_test_time 0.1248159408569336
gc 0
Train Epoch4 Acc 0.06906666666666667 (8288/120000), AUC 0.3939981460571289
ep4_train_time 6.295713186264038
Test Epoch4 threshold 0.1 Acc 0.9101973684210526, AUC 0.9790003895759583, avg_entr 0.01438169740140438
ep4_t0.1_test_time 0.12686419486999512
gc 0
Train Epoch5 Acc 0.11953333333333334 (14344/120000), AUC 0.3973458409309387
ep5_train_time 6.247925281524658
Test Epoch5 threshold 0.1 Acc 0.9118421052631579, AUC 0.978937029838562, avg_entr 0.013057423755526543
ep5_t0.1_test_time 0.12544035911560059
gc 0
Train Epoch6 Acc 0.1384 (16608/120000), AUC 0.3976917862892151
ep6_train_time 6.259921073913574
Test Epoch6 threshold 0.1 Acc 0.9110197368421052, AUC 0.9787786602973938, avg_entr 0.012563399039208889
ep6_t0.1_test_time 0.12496423721313477
gc 0
Train Epoch7 Acc 0.1405 (16860/120000), AUC 0.39672237634658813
ep7_train_time 6.263920545578003
Test Epoch7 threshold 0.1 Acc 0.9113486842105263, AUC 0.9784354567527771, avg_entr 0.011590312235057354
ep7_t0.1_test_time 0.12468814849853516
gc 0
Train Epoch8 Acc 0.13599166666666668 (16319/120000), AUC 0.3953039348125458
ep8_train_time 6.284708023071289
Test Epoch8 threshold 0.1 Acc 0.9111842105263158, AUC 0.9784479141235352, avg_entr 0.01161582674831152
ep8_t0.1_test_time 0.12343430519104004
gc 0
Train Epoch9 Acc 0.12744166666666668 (15293/120000), AUC 0.39386919140815735
ep9_train_time 6.2675769329071045
Test Epoch9 threshold 0.1 Acc 0.9098684210526315, AUC 0.9782434701919556, avg_entr 0.012061349116265774
ep9_t0.1_test_time 0.1233673095703125
Best AUC 0.980245053768158
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.1_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9256578947368421, AUC 0.9860066175460815, avg_entr 0.021972937509417534
t0.1_test_time 0.03169965744018555
