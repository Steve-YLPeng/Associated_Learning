total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad75_t0.3_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.28723333333333334 (34468/120000), AUC 0.6083762049674988
ep0_train_time 37.19674038887024
Test Epoch0 threshold 0.3 Acc 0.9159539473684211, AUC 0.9804928302764893, avg_entr 0.023429349064826965
ep0_t0.3_test_time 0.1876378059387207
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad75_t0.3_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.44515 (53418/120000), AUC 0.591895580291748
ep1_train_time 37.198423624038696
Test Epoch1 threshold 0.3 Acc 0.915625, AUC 0.9802423715591431, avg_entr 0.022931834682822227
ep1_t0.3_test_time 0.19665884971618652
gc 0
Train Epoch2 Acc 0.49075 (58890/120000), AUC 0.5922011137008667
ep2_train_time 36.81149387359619
Test Epoch2 threshold 0.3 Acc 0.9138157894736842, AUC 0.9800275564193726, avg_entr 0.02359471656382084
ep2_t0.3_test_time 0.17563843727111816
gc 0
Train Epoch3 Acc 0.489925 (58791/120000), AUC 0.5905486345291138
ep3_train_time 37.08021116256714
Test Epoch3 threshold 0.3 Acc 0.9144736842105263, AUC 0.9800420999526978, avg_entr 0.023445120081305504
ep3_t0.3_test_time 0.18557977676391602
gc 0
Train Epoch4 Acc 0.4881666666666667 (58580/120000), AUC 0.5901217460632324
ep4_train_time 36.83719515800476
Test Epoch4 threshold 0.3 Acc 0.9136513157894737, AUC 0.9795910120010376, avg_entr 0.023340696468949318
ep4_t0.3_test_time 0.17669129371643066
gc 0
Train Epoch5 Acc 0.48725 (58470/120000), AUC 0.5877716541290283
ep5_train_time 37.11707019805908
Test Epoch5 threshold 0.3 Acc 0.9134868421052632, AUC 0.9794386625289917, avg_entr 0.023023972287774086
ep5_t0.3_test_time 0.1751697063446045
gc 0
Train Epoch6 Acc 0.485375 (58245/120000), AUC 0.5866152048110962
ep6_train_time 37.23357176780701
Test Epoch6 threshold 0.3 Acc 0.9126644736842106, AUC 0.9793776273727417, avg_entr 0.023214729502797127
ep6_t0.3_test_time 0.16854619979858398
gc 0
Train Epoch7 Acc 0.478375 (57405/120000), AUC 0.585759162902832
ep7_train_time 36.97745609283447
Test Epoch7 threshold 0.3 Acc 0.912828947368421, AUC 0.979183554649353, avg_entr 0.023806238546967506
ep7_t0.3_test_time 0.18079900741577148
gc 0
Train Epoch8 Acc 0.455975 (54717/120000), AUC 0.585289478302002
ep8_train_time 37.103195667266846
Test Epoch8 threshold 0.3 Acc 0.9113486842105263, AUC 0.9791073203086853, avg_entr 0.023917609825730324
ep8_t0.3_test_time 0.1678781509399414
gc 0
Train Epoch9 Acc 0.429025 (51483/120000), AUC 0.5851156711578369
ep9_train_time 37.232741594314575
Test Epoch9 threshold 0.3 Acc 0.9115131578947369, AUC 0.9789116978645325, avg_entr 0.024280166253447533
ep9_t0.3_test_time 0.1867208480834961
Best AUC 0.9804928302764893
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad75_t0.3_m4//ag_news_lstmal_l5_prefix.pt
Test threshold 0.3 Acc 0.9243421052631579, AUC 0.9856849908828735, avg_entr 0.02293943427503109
t0.3_test_time 0.04890108108520508
