total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2592583333333333 (31111/120000), AUC 0.47172811627388
ep0_train_time 4.9245851039886475
Test Epoch0 threshold 0.9 Acc 0.9125, AUC 0.977651834487915, avg_entr 0.15636365115642548
ep0_t0.9_test_time 0.11049294471740723
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25879166666666664 (31055/120000), AUC 0.45542240142822266
ep1_train_time 4.478520154953003
Test Epoch1 threshold 0.9 Acc 0.9110197368421052, AUC 0.9800400733947754, avg_entr 0.09856276959180832
ep1_t0.9_test_time 0.10136008262634277
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2558666666666667 (30704/120000), AUC 0.45667606592178345
ep2_train_time 4.5707666873931885
Test Epoch2 threshold 0.9 Acc 0.9161184210526315, AUC 0.9802249073982239, avg_entr 0.07681632041931152
ep2_t0.9_test_time 0.10096263885498047
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.253675 (30441/120000), AUC 0.45745956897735596
ep3_train_time 4.519747018814087
Test Epoch3 threshold 0.9 Acc 0.9100328947368421, AUC 0.9804006814956665, avg_entr 0.06989218294620514
ep3_t0.9_test_time 0.10055875778198242
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.252675 (30321/120000), AUC 0.4577382802963257
ep4_train_time 4.5100579261779785
Test Epoch4 threshold 0.9 Acc 0.9172697368421052, AUC 0.9802721738815308, avg_entr 0.05935429036617279
ep4_t0.9_test_time 0.1010289192199707
gc 0
Train Epoch5 Acc 0.25188333333333335 (30226/120000), AUC 0.45785656571388245
ep5_train_time 4.492682456970215
Test Epoch5 threshold 0.9 Acc 0.9138157894736842, AUC 0.9799109697341919, avg_entr 0.05392340570688248
ep5_t0.9_test_time 0.10437822341918945
gc 0
Train Epoch6 Acc 0.2514 (30168/120000), AUC 0.45796090364456177
ep6_train_time 4.522434234619141
Test Epoch6 threshold 0.9 Acc 0.9129934210526316, AUC 0.9797972440719604, avg_entr 0.04992838576436043
ep6_t0.9_test_time 0.10102558135986328
gc 0
Train Epoch7 Acc 0.25111666666666665 (30134/120000), AUC 0.4575694799423218
ep7_train_time 4.511335611343384
Test Epoch7 threshold 0.9 Acc 0.9111842105263158, AUC 0.9795839786529541, avg_entr 0.04812423139810562
ep7_t0.9_test_time 0.1011514663696289
gc 0
Train Epoch8 Acc 0.25088333333333335 (30106/120000), AUC 0.4577452540397644
ep8_train_time 4.501463890075684
Test Epoch8 threshold 0.9 Acc 0.9120065789473685, AUC 0.979497492313385, avg_entr 0.04517083242535591
ep8_t0.9_test_time 0.10091519355773926
gc 0
Train Epoch9 Acc 0.250725 (30087/120000), AUC 0.45831501483917236
ep9_train_time 4.527172803878784
Test Epoch9 threshold 0.9 Acc 0.9111842105263158, AUC 0.9792865514755249, avg_entr 0.04362709820270538
ep9_t0.9_test_time 0.10076069831848145
Best AUC 0.9804006814956665
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.9_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9243421052631579, AUC 0.9859002232551575, avg_entr 0.0708746537566185
t0.9_test_time 0.025964975357055664
