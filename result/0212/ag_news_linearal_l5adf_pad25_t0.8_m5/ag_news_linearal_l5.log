total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.8_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9231166666666667 (110774/120000), AUC 0.9861916899681091
ep0_train_time 6.499121904373169
Test Epoch0 threshold 0.8 Acc 0.912828947368421, AUC 0.9804171323776245, avg_entr 0.025656387209892273
ep0_t0.8_test_time 0.0728158950805664
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.8_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9495583333333333 (113947/120000), AUC 0.9932225942611694
ep1_train_time 6.1132190227508545
Test Epoch1 threshold 0.8 Acc 0.9101973684210526, AUC 0.9796189665794373, avg_entr 0.025716787204146385
ep1_t0.8_test_time 0.07246947288513184
gc 0
Train Epoch2 Acc 0.9518166666666666 (114218/120000), AUC 0.9932670593261719
ep2_train_time 6.061453580856323
Test Epoch2 threshold 0.8 Acc 0.9118421052631579, AUC 0.9795255064964294, avg_entr 0.025554325431585312
ep2_t0.8_test_time 0.07172656059265137
gc 0
Train Epoch3 Acc 0.9532416666666667 (114389/120000), AUC 0.9934465885162354
ep3_train_time 6.05699896812439
Test Epoch3 threshold 0.8 Acc 0.9101973684210526, AUC 0.9795854091644287, avg_entr 0.024437664076685905
ep3_t0.8_test_time 0.07166528701782227
gc 0
Train Epoch4 Acc 0.954175 (114501/120000), AUC 0.9938651323318481
ep4_train_time 6.119011878967285
Test Epoch4 threshold 0.8 Acc 0.9088815789473684, AUC 0.9791668057441711, avg_entr 0.02543385699391365
ep4_t0.8_test_time 0.07176613807678223
gc 0
Train Epoch5 Acc 0.9563333333333334 (114760/120000), AUC 0.9946510791778564
ep5_train_time 6.018123626708984
Test Epoch5 threshold 0.8 Acc 0.909375, AUC 0.9790534973144531, avg_entr 0.02523707039654255
ep5_t0.8_test_time 0.07240700721740723
gc 0
Train Epoch6 Acc 0.9574583333333333 (114895/120000), AUC 0.994850754737854
ep6_train_time 6.073611497879028
Test Epoch6 threshold 0.8 Acc 0.909375, AUC 0.9787622690200806, avg_entr 0.025554900988936424
ep6_t0.8_test_time 0.07193279266357422
gc 0
Train Epoch7 Acc 0.9577333333333333 (114928/120000), AUC 0.9949761629104614
ep7_train_time 6.093492746353149
Test Epoch7 threshold 0.8 Acc 0.909375, AUC 0.9787243604660034, avg_entr 0.025737415999174118
ep7_t0.8_test_time 0.0712747573852539
gc 0
Train Epoch8 Acc 0.9581916666666667 (114983/120000), AUC 0.995162308216095
ep8_train_time 6.05823016166687
Test Epoch8 threshold 0.8 Acc 0.909375, AUC 0.9784402251243591, avg_entr 0.025690218433737755
ep8_t0.8_test_time 0.07079076766967773
gc 0
Train Epoch9 Acc 0.9596333333333333 (115156/120000), AUC 0.9955762624740601
ep9_train_time 5.951312303543091
Test Epoch9 threshold 0.8 Acc 0.9083881578947368, AUC 0.9784801602363586, avg_entr 0.025687750428915024
ep9_t0.8_test_time 0.07136869430541992
Best AUC 0.9804171323776245
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.8_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9164473684210527, AUC 0.9847580194473267, avg_entr 0.025345416739583015
t0.8_test_time 0.018793582916259766
