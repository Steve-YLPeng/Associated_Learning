total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2501583333333333 (30019/120000), AUC 0.5400340557098389
ep0_train_time 7.123089551925659
Test Epoch0 threshold 0.1 Acc 0.9052631578947369, AUC 0.9757636785507202, avg_entr 0.17020872235298157
ep0_t0.1_test_time 0.16786718368530273
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25053333333333333 (30064/120000), AUC 0.5588934421539307
ep1_train_time 6.67008376121521
Test Epoch1 threshold 0.1 Acc 0.9148026315789474, AUC 0.9787262678146362, avg_entr 0.10153171420097351
ep1_t0.1_test_time 0.17403769493103027
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.250725 (30087/120000), AUC 0.5581498146057129
ep2_train_time 6.180716514587402
Test Epoch2 threshold 0.1 Acc 0.9149671052631579, AUC 0.9797345995903015, avg_entr 0.07868024706840515
ep2_t0.1_test_time 0.16387057304382324
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.2509 (30108/120000), AUC 0.5564765334129333
ep3_train_time 6.144493818283081
Test Epoch3 threshold 0.1 Acc 0.9175986842105263, AUC 0.9802004098892212, avg_entr 0.0672452449798584
ep3_t0.1_test_time 0.17142200469970703
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25145 (30174/120000), AUC 0.5542691946029663
ep4_train_time 6.153398275375366
Test Epoch4 threshold 0.1 Acc 0.9151315789473684, AUC 0.9804069995880127, avg_entr 0.059218261390924454
ep4_t0.1_test_time 0.1636793613433838
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25201666666666667 (30242/120000), AUC 0.552437424659729
ep5_train_time 6.199925899505615
Test Epoch5 threshold 0.1 Acc 0.9159539473684211, AUC 0.9801774621009827, avg_entr 0.05406425893306732
ep5_t0.1_test_time 0.16233611106872559
gc 0
Train Epoch6 Acc 0.252675 (30321/120000), AUC 0.5502337217330933
ep6_train_time 6.251451730728149
Test Epoch6 threshold 0.1 Acc 0.9157894736842105, AUC 0.9801576733589172, avg_entr 0.05043739080429077
ep6_t0.1_test_time 0.16342663764953613
gc 0
Train Epoch7 Acc 0.25361666666666666 (30434/120000), AUC 0.5487203001976013
ep7_train_time 6.181056022644043
Test Epoch7 threshold 0.1 Acc 0.9159539473684211, AUC 0.9799078702926636, avg_entr 0.046780165284872055
ep7_t0.1_test_time 0.162872314453125
gc 0
Train Epoch8 Acc 0.2551333333333333 (30616/120000), AUC 0.5467129945755005
ep8_train_time 6.101850986480713
Test Epoch8 threshold 0.1 Acc 0.9146381578947368, AUC 0.9797705411911011, avg_entr 0.0446808896958828
ep8_t0.1_test_time 0.16315507888793945
gc 0
Train Epoch9 Acc 0.2567333333333333 (30808/120000), AUC 0.5450832843780518
ep9_train_time 5.87091588973999
Test Epoch9 threshold 0.1 Acc 0.9121710526315789, AUC 0.9796352982521057, avg_entr 0.0435451976954937
ep9_t0.1_test_time 0.16016221046447754
Best AUC 0.9804069995880127
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.1_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.925, AUC 0.9860947728157043, avg_entr 0.06055460125207901
t0.1_test_time 0.04103350639343262
