total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.9_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9194083333333334 (110329/120000), AUC 0.9851117730140686
ep0_train_time 7.996320724487305
Test Epoch0 threshold 0.9 Acc 0.9151315789473684, AUC 0.9800046682357788, avg_entr 0.025575999170541763
ep0_t0.9_test_time 0.13399410247802734
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.9_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9507 (114084/120000), AUC 0.9933217763900757
ep1_train_time 7.6261255741119385
Test Epoch1 threshold 0.9 Acc 0.9143092105263158, AUC 0.9798320531845093, avg_entr 0.026020832359790802
ep1_t0.9_test_time 0.13246512413024902
gc 0
Train Epoch2 Acc 0.9521666666666667 (114260/120000), AUC 0.9935142993927002
ep2_train_time 7.607192754745483
Test Epoch2 threshold 0.9 Acc 0.9133223684210526, AUC 0.9797644019126892, avg_entr 0.026603739708662033
ep2_t0.9_test_time 0.13263845443725586
gc 0
Train Epoch3 Acc 0.9532 (114384/120000), AUC 0.9935179948806763
ep3_train_time 7.6004767417907715
Test Epoch3 threshold 0.9 Acc 0.9126644736842106, AUC 0.9796819090843201, avg_entr 0.026379520073533058
ep3_t0.9_test_time 0.13325738906860352
gc 0
Train Epoch4 Acc 0.9545916666666666 (114551/120000), AUC 0.993970513343811
ep4_train_time 7.6431427001953125
Test Epoch4 threshold 0.9 Acc 0.9116776315789473, AUC 0.9794884324073792, avg_entr 0.026061484590172768
ep4_t0.9_test_time 0.13418292999267578
gc 0
Train Epoch5 Acc 0.956675 (114801/120000), AUC 0.9946768879890442
ep5_train_time 7.600476264953613
Test Epoch5 threshold 0.9 Acc 0.9100328947368421, AUC 0.9790970087051392, avg_entr 0.02688964270055294
ep5_t0.9_test_time 0.13352036476135254
gc 0
Train Epoch6 Acc 0.9572 (114864/120000), AUC 0.9948409199714661
ep6_train_time 7.5791544914245605
Test Epoch6 threshold 0.9 Acc 0.9113486842105263, AUC 0.9791079759597778, avg_entr 0.026310188695788383
ep6_t0.9_test_time 0.13294363021850586
gc 0
Train Epoch7 Acc 0.9573083333333333 (114877/120000), AUC 0.9949886798858643
ep7_train_time 7.653745889663696
Test Epoch7 threshold 0.9 Acc 0.9083881578947368, AUC 0.9787541627883911, avg_entr 0.026561088860034943
ep7_t0.9_test_time 0.13468670845031738
gc 0
Train Epoch8 Acc 0.9579 (114948/120000), AUC 0.9951189160346985
ep8_train_time 7.650205373764038
Test Epoch8 threshold 0.9 Acc 0.9095394736842105, AUC 0.9787097573280334, avg_entr 0.027048254385590553
ep8_t0.9_test_time 0.1327955722808838
gc 0
Train Epoch9 Acc 0.9593083333333333 (115117/120000), AUC 0.9955489635467529
ep9_train_time 7.6245105266571045
Test Epoch9 threshold 0.9 Acc 0.9082236842105263, AUC 0.9787030220031738, avg_entr 0.025986555963754654
ep9_t0.9_test_time 0.13220500946044922
Best AUC 0.9800046682357788
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.9_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9230263157894737, AUC 0.9857691526412964, avg_entr 0.025475962087512016
t0.9_test_time 0.03428936004638672
