total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.7_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.29746666666666666 (35696/120000), AUC 0.40414997935295105
ep0_train_time 8.325030326843262
Test Epoch0 threshold 0.7 Acc 0.9159539473684211, AUC 0.980756402015686, avg_entr 0.02666725032031536
ep0_t0.7_test_time 0.16782045364379883
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.7_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.23878333333333332 (28654/120000), AUC 0.3055162727832794
ep1_train_time 7.7981719970703125
Test Epoch1 threshold 0.7 Acc 0.9161184210526315, AUC 0.9804128408432007, avg_entr 0.025889333337545395
ep1_t0.7_test_time 0.16781878471374512
gc 0
Train Epoch2 Acc 0.23821666666666666 (28586/120000), AUC 0.32664501667022705
ep2_train_time 7.838579893112183
Test Epoch2 threshold 0.7 Acc 0.9138157894736842, AUC 0.9801774024963379, avg_entr 0.026325920596718788
ep2_t0.7_test_time 0.17575669288635254
gc 0
Train Epoch3 Acc 0.24410833333333334 (29293/120000), AUC 0.39664769172668457
ep3_train_time 7.905441761016846
Test Epoch3 threshold 0.7 Acc 0.9131578947368421, AUC 0.98018479347229, avg_entr 0.02674347534775734
ep3_t0.7_test_time 0.16594815254211426
gc 0
Train Epoch4 Acc 0.24968333333333334 (29962/120000), AUC 0.42725738883018494
ep4_train_time 7.845034599304199
Test Epoch4 threshold 0.7 Acc 0.9141447368421053, AUC 0.9800793528556824, avg_entr 0.025989115238189697
ep4_t0.7_test_time 0.1661231517791748
gc 0
Train Epoch5 Acc 0.25174166666666664 (30209/120000), AUC 0.44013074040412903
ep5_train_time 8.000479459762573
Test Epoch5 threshold 0.7 Acc 0.912828947368421, AUC 0.979820191860199, avg_entr 0.02506912872195244
ep5_t0.7_test_time 0.17218637466430664
gc 0
Train Epoch6 Acc 0.2522583333333333 (30271/120000), AUC 0.44334927201271057
ep6_train_time 7.840933561325073
Test Epoch6 threshold 0.7 Acc 0.912828947368421, AUC 0.9797043204307556, avg_entr 0.025184379890561104
ep6_t0.7_test_time 0.1674809455871582
gc 0
Train Epoch7 Acc 0.25266666666666665 (30320/120000), AUC 0.4426702857017517
ep7_train_time 7.813089370727539
Test Epoch7 threshold 0.7 Acc 0.9120065789473685, AUC 0.9795384407043457, avg_entr 0.02577984519302845
ep7_t0.7_test_time 0.16661667823791504
gc 0
Train Epoch8 Acc 0.252925 (30351/120000), AUC 0.43892258405685425
ep8_train_time 7.828913688659668
Test Epoch8 threshold 0.7 Acc 0.9118421052631579, AUC 0.9794755578041077, avg_entr 0.025379333645105362
ep8_t0.7_test_time 0.16590452194213867
gc 0
Train Epoch9 Acc 0.2529416666666667 (30353/120000), AUC 0.4349391460418701
ep9_train_time 7.983506441116333
Test Epoch9 threshold 0.7 Acc 0.9123355263157895, AUC 0.9793846607208252, avg_entr 0.025509266182780266
ep9_t0.7_test_time 0.16546058654785156
Best AUC 0.980756402015686
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.7_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9276315789473685, AUC 0.986494779586792, avg_entr 0.02611544542014599
t0.7_test_time 0.041973114013671875
