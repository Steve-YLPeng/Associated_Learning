total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2635 (31620/120000), AUC 0.5599353313446045
ep0_train_time 5.093665838241577
Test Epoch0 threshold 0.1 Acc 0.9110197368421052, AUC 0.9777532815933228, avg_entr 0.15949894487857819
ep0_t0.1_test_time 0.10315203666687012
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2807 (33684/120000), AUC 0.5687198638916016
ep1_train_time 4.467028856277466
Test Epoch1 threshold 0.1 Acc 0.9141447368421053, AUC 0.9802024364471436, avg_entr 0.09576532244682312
ep1_t0.1_test_time 0.10119390487670898
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.28296666666666664 (33956/120000), AUC 0.5653433203697205
ep2_train_time 4.496825933456421
Test Epoch2 threshold 0.1 Acc 0.9139802631578947, AUC 0.9804182648658752, avg_entr 0.0785299614071846
ep2_t0.1_test_time 0.10168147087097168
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.28308333333333335 (33970/120000), AUC 0.5632901787757874
ep3_train_time 4.462513208389282
Test Epoch3 threshold 0.1 Acc 0.9154605263157894, AUC 0.9804933667182922, avg_entr 0.06535807251930237
ep3_t0.1_test_time 0.10091757774353027
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.2811416666666667 (33737/120000), AUC 0.5617060661315918
ep4_train_time 4.487828016281128
Test Epoch4 threshold 0.1 Acc 0.9141447368421053, AUC 0.9802287220954895, avg_entr 0.05959595739841461
ep4_t0.1_test_time 0.10091972351074219
gc 0
Train Epoch5 Acc 0.2802 (33624/120000), AUC 0.5607959032058716
ep5_train_time 4.476275205612183
Test Epoch5 threshold 0.1 Acc 0.9110197368421052, AUC 0.9795565605163574, avg_entr 0.05528960004448891
ep5_t0.1_test_time 0.10102391242980957
gc 0
Train Epoch6 Acc 0.2795666666666667 (33548/120000), AUC 0.5603097081184387
ep6_train_time 4.481889724731445
Test Epoch6 threshold 0.1 Acc 0.9139802631578947, AUC 0.9794974327087402, avg_entr 0.05097213014960289
ep6_t0.1_test_time 0.10050606727600098
gc 0
Train Epoch7 Acc 0.2800916666666667 (33611/120000), AUC 0.5599520206451416
ep7_train_time 4.487759351730347
Test Epoch7 threshold 0.1 Acc 0.9143092105263158, AUC 0.9796261787414551, avg_entr 0.048448145389556885
ep7_t0.1_test_time 0.10077834129333496
gc 0
Train Epoch8 Acc 0.27974166666666667 (33569/120000), AUC 0.5585057139396667
ep8_train_time 4.473491430282593
Test Epoch8 threshold 0.1 Acc 0.9134868421052632, AUC 0.9794310331344604, avg_entr 0.04632241651415825
ep8_t0.1_test_time 0.10080599784851074
gc 0
Train Epoch9 Acc 0.27979166666666666 (33575/120000), AUC 0.5572817921638489
ep9_train_time 4.5434582233428955
Test Epoch9 threshold 0.1 Acc 0.9125, AUC 0.9793764352798462, avg_entr 0.04371471330523491
ep9_t0.1_test_time 0.10161662101745605
Best AUC 0.9804933667182922
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.1_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9243421052631579, AUC 0.9864237308502197, avg_entr 0.06770626455545425
t0.1_test_time 0.026302337646484375
