total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.24788333333333334 (29746/120000), AUC 0.2140885591506958
ep0_train_time 9.3550705909729
Test Epoch0 threshold 0.1 Acc 0.9146381578947368, AUC 0.980816662311554, avg_entr 0.025603845715522766
ep0_t0.1_test_time 0.26551055908203125
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.247 (29640/120000), AUC 0.19632115960121155
ep1_train_time 8.888697862625122
Test Epoch1 threshold 0.1 Acc 0.9161184210526315, AUC 0.9806865453720093, avg_entr 0.025282736867666245
ep1_t0.1_test_time 0.2641892433166504
gc 0
Train Epoch2 Acc 0.23886666666666667 (28664/120000), AUC 0.2066120058298111
ep2_train_time 8.996744394302368
Test Epoch2 threshold 0.1 Acc 0.9154605263157894, AUC 0.9805800914764404, avg_entr 0.024571411311626434
ep2_t0.1_test_time 0.2632014751434326
gc 0
Train Epoch3 Acc 0.2279 (27348/120000), AUC 0.2167636752128601
ep3_train_time 8.900732278823853
Test Epoch3 threshold 0.1 Acc 0.9148026315789474, AUC 0.9802857041358948, avg_entr 0.02341119386255741
ep3_t0.1_test_time 0.2638857364654541
gc 0
Train Epoch4 Acc 0.23230833333333334 (27877/120000), AUC 0.22760902345180511
ep4_train_time 8.957911729812622
Test Epoch4 threshold 0.1 Acc 0.9151315789473684, AUC 0.9802414178848267, avg_entr 0.023649265989661217
ep4_t0.1_test_time 0.2637593746185303
gc 0
Train Epoch5 Acc 0.2362 (28344/120000), AUC 0.23436003923416138
ep5_train_time 8.97346568107605
Test Epoch5 threshold 0.1 Acc 0.9125, AUC 0.9801614880561829, avg_entr 0.02373955212533474
ep5_t0.1_test_time 0.26373291015625
gc 0
Train Epoch6 Acc 0.23814166666666667 (28577/120000), AUC 0.23851710557937622
ep6_train_time 8.961382865905762
Test Epoch6 threshold 0.1 Acc 0.9136513157894737, AUC 0.980009138584137, avg_entr 0.023126430809497833
ep6_t0.1_test_time 0.2633078098297119
gc 0
Train Epoch7 Acc 0.23736666666666667 (28484/120000), AUC 0.23995161056518555
ep7_train_time 8.90832257270813
Test Epoch7 threshold 0.1 Acc 0.9151315789473684, AUC 0.9799287915229797, avg_entr 0.020795535296201706
ep7_t0.1_test_time 0.26308488845825195
gc 0
Train Epoch8 Acc 0.23253333333333334 (27904/120000), AUC 0.2391410768032074
ep8_train_time 8.910409450531006
Test Epoch8 threshold 0.1 Acc 0.9133223684210526, AUC 0.9798690676689148, avg_entr 0.020664433017373085
ep8_t0.1_test_time 0.26343488693237305
gc 0
Train Epoch9 Acc 0.2276 (27312/120000), AUC 0.23843641579151154
ep9_train_time 8.932659149169922
Test Epoch9 threshold 0.1 Acc 0.9129934210526316, AUC 0.9797797203063965, avg_entr 0.019483434036374092
ep9_t0.1_test_time 0.26340198516845703
Best AUC 0.980816662311554
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.925, AUC 0.9863625764846802, avg_entr 0.024792077019810677
t0.1_test_time 0.06644892692565918
