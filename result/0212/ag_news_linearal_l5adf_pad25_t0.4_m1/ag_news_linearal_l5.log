total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.221175 (26541/120000), AUC 0.47045260667800903
ep0_train_time 4.2808051109313965
Test Epoch0 threshold 0.4 Acc 0.9095394736842105, AUC 0.9791593551635742, avg_entr 0.15176159143447876
ep0_t0.4_test_time 0.07306742668151855
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.21940833333333334 (26329/120000), AUC 0.4508553743362427
ep1_train_time 3.8393919467926025
Test Epoch1 threshold 0.4 Acc 0.9134868421052632, AUC 0.9808566570281982, avg_entr 0.0947895422577858
ep1_t0.4_test_time 0.0714256763458252
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.22086666666666666 (26504/120000), AUC 0.448332279920578
ep2_train_time 3.824281930923462
Test Epoch2 threshold 0.4 Acc 0.9141447368421053, AUC 0.9811435341835022, avg_entr 0.07544218003749847
ep2_t0.4_test_time 0.07082962989807129
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.22165 (26598/120000), AUC 0.4469245672225952
ep3_train_time 3.795668601989746
Test Epoch3 threshold 0.4 Acc 0.9125, AUC 0.9808804392814636, avg_entr 0.06472919136285782
ep3_t0.4_test_time 0.07128524780273438
gc 0
Train Epoch4 Acc 0.22170833333333334 (26605/120000), AUC 0.44578588008880615
ep4_train_time 3.8495237827301025
Test Epoch4 threshold 0.4 Acc 0.9113486842105263, AUC 0.9806413650512695, avg_entr 0.05872923880815506
ep4_t0.4_test_time 0.07142829895019531
gc 0
Train Epoch5 Acc 0.221875 (26625/120000), AUC 0.44436657428741455
ep5_train_time 3.825199842453003
Test Epoch5 threshold 0.4 Acc 0.9136513157894737, AUC 0.980463445186615, avg_entr 0.05445830523967743
ep5_t0.4_test_time 0.07090449333190918
gc 0
Train Epoch6 Acc 0.222925 (26751/120000), AUC 0.4434460997581482
ep6_train_time 3.8090381622314453
Test Epoch6 threshold 0.4 Acc 0.9113486842105263, AUC 0.9797770977020264, avg_entr 0.04955558106303215
ep6_t0.4_test_time 0.07094717025756836
gc 0
Train Epoch7 Acc 0.22375 (26850/120000), AUC 0.4431176483631134
ep7_train_time 4.011847972869873
Test Epoch7 threshold 0.4 Acc 0.9118421052631579, AUC 0.979851245880127, avg_entr 0.0472077913582325
ep7_t0.4_test_time 0.07361531257629395
gc 0
Train Epoch8 Acc 0.2239 (26868/120000), AUC 0.44378361105918884
ep8_train_time 4.009875535964966
Test Epoch8 threshold 0.4 Acc 0.9110197368421052, AUC 0.9796268939971924, avg_entr 0.04538310319185257
ep8_t0.4_test_time 0.07318496704101562
gc 0
Train Epoch9 Acc 0.2239 (26868/120000), AUC 0.4437176585197449
ep9_train_time 3.8663036823272705
Test Epoch9 threshold 0.4 Acc 0.9098684210526315, AUC 0.9793106317520142, avg_entr 0.04363027215003967
ep9_t0.4_test_time 0.0710744857788086
Best AUC 0.9811435341835022
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.4_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9171052631578948, AUC 0.9850677251815796, avg_entr 0.08005505055189133
t0.4_test_time 0.018772602081298828
