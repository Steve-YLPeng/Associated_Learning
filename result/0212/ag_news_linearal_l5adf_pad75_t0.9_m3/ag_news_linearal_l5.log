total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.9_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.25259166666666666 (30311/120000), AUC 0.6562082767486572
ep0_train_time 6.963653087615967
Test Epoch0 threshold 0.9 Acc 0.915625, AUC 0.9803274869918823, avg_entr 0.02651878632605076
ep0_t0.9_test_time 0.135101318359375
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.9_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2527 (30324/120000), AUC 0.6884077787399292
ep1_train_time 6.522559881210327
Test Epoch1 threshold 0.9 Acc 0.915625, AUC 0.9801475405693054, avg_entr 0.02558578923344612
ep1_t0.9_test_time 0.1318202018737793
gc 0
Train Epoch2 Acc 0.2558916666666667 (30707/120000), AUC 0.7054665684700012
ep2_train_time 6.477675914764404
Test Epoch2 threshold 0.9 Acc 0.9148026315789474, AUC 0.9800691604614258, avg_entr 0.027037477120757103
ep2_t0.9_test_time 0.13260984420776367
gc 0
Train Epoch3 Acc 0.256525 (30783/120000), AUC 0.6856536865234375
ep3_train_time 6.536753416061401
Test Epoch3 threshold 0.9 Acc 0.9133223684210526, AUC 0.9800187945365906, avg_entr 0.02600502036511898
ep3_t0.9_test_time 0.13196396827697754
gc 0
Train Epoch4 Acc 0.26011666666666666 (31214/120000), AUC 0.6592301726341248
ep4_train_time 6.46784520149231
Test Epoch4 threshold 0.9 Acc 0.9110197368421052, AUC 0.9795622229576111, avg_entr 0.026637019589543343
ep4_t0.9_test_time 0.13329601287841797
gc 0
Train Epoch5 Acc 0.26931666666666665 (32318/120000), AUC 0.6331366300582886
ep5_train_time 6.5587780475616455
Test Epoch5 threshold 0.9 Acc 0.9120065789473685, AUC 0.9794064164161682, avg_entr 0.025992240756750107
ep5_t0.9_test_time 0.13312220573425293
gc 0
Train Epoch6 Acc 0.28036666666666665 (33644/120000), AUC 0.6152544021606445
ep6_train_time 6.480788230895996
Test Epoch6 threshold 0.9 Acc 0.9108552631578948, AUC 0.9792540669441223, avg_entr 0.026133283972740173
ep6_t0.9_test_time 0.13176178932189941
gc 0
Train Epoch7 Acc 0.29289166666666666 (35147/120000), AUC 0.5999878644943237
ep7_train_time 6.546453475952148
Test Epoch7 threshold 0.9 Acc 0.9111842105263158, AUC 0.9790142178535461, avg_entr 0.02605528011918068
ep7_t0.9_test_time 0.13294363021850586
gc 0
Train Epoch8 Acc 0.3007916666666667 (36095/120000), AUC 0.5896810293197632
ep8_train_time 6.486053466796875
Test Epoch8 threshold 0.9 Acc 0.9098684210526315, AUC 0.9789956212043762, avg_entr 0.026047440245747566
ep8_t0.9_test_time 0.1324315071105957
gc 0
Train Epoch9 Acc 0.30411666666666665 (36494/120000), AUC 0.5828856229782104
ep9_train_time 6.482276916503906
Test Epoch9 threshold 0.9 Acc 0.9095394736842105, AUC 0.9789291620254517, avg_entr 0.026431864127516747
ep9_t0.9_test_time 0.13285422325134277
Best AUC 0.9803274869918823
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.9_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9230263157894737, AUC 0.9864444732666016, avg_entr 0.026432884857058525
t0.9_test_time 0.03377795219421387
