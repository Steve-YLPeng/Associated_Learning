total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.8_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.27065 (32478/120000), AUC 0.6072587966918945
ep0_train_time 4.835511684417725
Test Epoch0 threshold 0.8 Acc 0.912828947368421, AUC 0.980850100517273, avg_entr 0.03133784234523773
ep0_t0.8_test_time 0.07390451431274414
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.27395 (32874/120000), AUC 0.6148542165756226
ep1_train_time 4.374286651611328
Test Epoch1 threshold 0.8 Acc 0.9123355263157895, AUC 0.9801664352416992, avg_entr 0.02825048565864563
ep1_t0.8_test_time 0.07106137275695801
gc 0
Train Epoch2 Acc 0.27168333333333333 (32602/120000), AUC 0.6197246313095093
ep2_train_time 4.368713855743408
Test Epoch2 threshold 0.8 Acc 0.9103618421052632, AUC 0.9801794290542603, avg_entr 0.02790153957903385
ep2_t0.8_test_time 0.07145380973815918
gc 0
Train Epoch3 Acc 0.27014166666666667 (32417/120000), AUC 0.6235517263412476
ep3_train_time 4.399006128311157
Test Epoch3 threshold 0.8 Acc 0.9106907894736842, AUC 0.9798496961593628, avg_entr 0.026453174650669098
ep3_t0.8_test_time 0.07145452499389648
gc 0
Train Epoch4 Acc 0.267425 (32091/120000), AUC 0.6259560585021973
ep4_train_time 4.392519235610962
Test Epoch4 threshold 0.8 Acc 0.9106907894736842, AUC 0.9796586036682129, avg_entr 0.026685887947678566
ep4_t0.8_test_time 0.0708303451538086
gc 0
Train Epoch5 Acc 0.2643333333333333 (31720/120000), AUC 0.6273232698440552
ep5_train_time 4.357662200927734
Test Epoch5 threshold 0.8 Acc 0.9098684210526315, AUC 0.9793394804000854, avg_entr 0.026162277907133102
ep5_t0.8_test_time 0.07156872749328613
gc 0
Train Epoch6 Acc 0.26214166666666666 (31457/120000), AUC 0.6262067556381226
ep6_train_time 4.376748561859131
Test Epoch6 threshold 0.8 Acc 0.9103618421052632, AUC 0.9793302416801453, avg_entr 0.02645041234791279
ep6_t0.8_test_time 0.07172751426696777
gc 0
Train Epoch7 Acc 0.2601833333333333 (31222/120000), AUC 0.6239503622055054
ep7_train_time 4.38695216178894
Test Epoch7 threshold 0.8 Acc 0.9082236842105263, AUC 0.9791102409362793, avg_entr 0.02618347480893135
ep7_t0.8_test_time 0.07279562950134277
gc 0
Train Epoch8 Acc 0.2581333333333333 (30976/120000), AUC 0.6208139657974243
ep8_train_time 4.3714540004730225
Test Epoch8 threshold 0.8 Acc 0.909375, AUC 0.9789342880249023, avg_entr 0.026425432413816452
ep8_t0.8_test_time 0.07052063941955566
gc 0
Train Epoch9 Acc 0.257 (30840/120000), AUC 0.6191675662994385
ep9_train_time 4.384852409362793
Test Epoch9 threshold 0.8 Acc 0.9105263157894737, AUC 0.9787188768386841, avg_entr 0.025719814002513885
ep9_t0.8_test_time 0.07361841201782227
Best AUC 0.980850100517273
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.8_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9177631578947368, AUC 0.9854731559753418, avg_entr 0.03451050817966461
t0.8_test_time 0.019426822662353516
