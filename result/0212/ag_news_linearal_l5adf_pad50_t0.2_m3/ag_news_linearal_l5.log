total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.2_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.42833333333333334 (51400/120000), AUC 0.7586972713470459
ep0_train_time 6.1234729290008545
Test Epoch0 threshold 0.2 Acc 0.9149671052631579, AUC 0.9804199934005737, avg_entr 0.024729730561375618
ep0_t0.2_test_time 0.12497687339782715
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.2_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.42725 (51270/120000), AUC 0.7437912225723267
ep1_train_time 5.703338861465454
Test Epoch1 threshold 0.2 Acc 0.9138157894736842, AUC 0.9801100492477417, avg_entr 0.025166332721710205
ep1_t0.2_test_time 0.1184084415435791
gc 0
Train Epoch2 Acc 0.4807166666666667 (57686/120000), AUC 0.7483822107315063
ep2_train_time 5.645154714584351
Test Epoch2 threshold 0.2 Acc 0.9143092105263158, AUC 0.9797611236572266, avg_entr 0.024705495685338974
ep2_t0.2_test_time 0.11825871467590332
gc 0
Train Epoch3 Acc 0.58465 (70158/120000), AUC 0.7671201825141907
ep3_train_time 5.641807556152344
Test Epoch3 threshold 0.2 Acc 0.9138157894736842, AUC 0.9798098802566528, avg_entr 0.023135486990213394
ep3_t0.2_test_time 0.11664438247680664
gc 0
Train Epoch4 Acc 0.6288166666666667 (75458/120000), AUC 0.7786841988563538
ep4_train_time 5.711569547653198
Test Epoch4 threshold 0.2 Acc 0.909375, AUC 0.9796833395957947, avg_entr 0.022168511524796486
ep4_t0.2_test_time 0.11708831787109375
gc 0
Train Epoch5 Acc 0.6412416666666667 (76949/120000), AUC 0.7869172096252441
ep5_train_time 5.698921203613281
Test Epoch5 threshold 0.2 Acc 0.9115131578947369, AUC 0.9793063402175903, avg_entr 0.021658694371581078
ep5_t0.2_test_time 0.11906719207763672
gc 0
Train Epoch6 Acc 0.659225 (79107/120000), AUC 0.7948001623153687
ep6_train_time 5.740760326385498
Test Epoch6 threshold 0.2 Acc 0.9123355263157895, AUC 0.9792866706848145, avg_entr 0.02136080712080002
ep6_t0.2_test_time 0.11753535270690918
gc 0
Train Epoch7 Acc 0.6875166666666667 (82502/120000), AUC 0.79889976978302
ep7_train_time 5.729660511016846
Test Epoch7 threshold 0.2 Acc 0.9115131578947369, AUC 0.9791490435600281, avg_entr 0.021194104105234146
ep7_t0.2_test_time 0.11803603172302246
gc 0
Train Epoch8 Acc 0.7254416666666667 (87053/120000), AUC 0.7952778339385986
ep8_train_time 5.743222713470459
Test Epoch8 threshold 0.2 Acc 0.9116776315789473, AUC 0.9789510369300842, avg_entr 0.020885569974780083
ep8_t0.2_test_time 0.11737060546875
gc 0
Train Epoch9 Acc 0.7555833333333334 (90670/120000), AUC 0.7892953157424927
ep9_train_time 5.746548175811768
Test Epoch9 threshold 0.2 Acc 0.9108552631578948, AUC 0.9789011478424072, avg_entr 0.020617574453353882
ep9_t0.2_test_time 0.11799335479736328
Best AUC 0.9804199934005737
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.2_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.925, AUC 0.9861000776290894, avg_entr 0.023314932361245155
t0.2_test_time 0.030214548110961914
