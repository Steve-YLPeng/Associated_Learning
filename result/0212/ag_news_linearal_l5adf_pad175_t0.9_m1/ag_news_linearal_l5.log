total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.5556243658065796
ep0_train_time 8.55172848701477
Test Epoch0 threshold 0.9 Acc 0.8970394736842106, AUC 0.9740133285522461, avg_entr 0.18172293901443481
ep0_t0.9_test_time 0.25768423080444336
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.6497074365615845
ep1_train_time 8.06208086013794
Test Epoch1 threshold 0.9 Acc 0.9125, AUC 0.9779320955276489, avg_entr 0.10465527325868607
ep1_t0.9_test_time 0.2552826404571533
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.658804714679718
ep2_train_time 8.125988483428955
Test Epoch2 threshold 0.9 Acc 0.9113486842105263, AUC 0.9793610572814941, avg_entr 0.08253388106822968
ep2_t0.9_test_time 0.2581596374511719
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.6570510864257812
ep3_train_time 8.115569353103638
Test Epoch3 threshold 0.9 Acc 0.9126644736842106, AUC 0.980301022529602, avg_entr 0.0688556507229805
ep3_t0.9_test_time 0.2600269317626953
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.6533925533294678
ep4_train_time 8.308112144470215
Test Epoch4 threshold 0.9 Acc 0.9144736842105263, AUC 0.9806703329086304, avg_entr 0.05977152660489082
ep4_t0.9_test_time 0.2568070888519287
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.6493195295333862
ep5_train_time 8.508601665496826
Test Epoch5 threshold 0.9 Acc 0.9169407894736842, AUC 0.9807730913162231, avg_entr 0.05401251092553139
ep5_t0.9_test_time 0.2671244144439697
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.6454898118972778
ep6_train_time 8.339839696884155
Test Epoch6 threshold 0.9 Acc 0.9174342105263158, AUC 0.9809012413024902, avg_entr 0.048735301941633224
ep6_t0.9_test_time 0.2569916248321533
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.6419141292572021
ep7_train_time 8.190590143203735
Test Epoch7 threshold 0.9 Acc 0.9159539473684211, AUC 0.980656623840332, avg_entr 0.04573794826865196
ep7_t0.9_test_time 0.25860047340393066
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.6387012004852295
ep8_train_time 8.054637908935547
Test Epoch8 threshold 0.9 Acc 0.9151315789473684, AUC 0.980682373046875, avg_entr 0.043045662343502045
ep8_t0.9_test_time 0.2563045024871826
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.6355689764022827
ep9_train_time 8.019683599472046
Test Epoch9 threshold 0.9 Acc 0.9138157894736842, AUC 0.9805374145507812, avg_entr 0.042280953377485275
ep9_t0.9_test_time 0.2561464309692383
Best AUC 0.9809012413024902
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9223684210526316, AUC 0.9861550331115723, avg_entr 0.0494668073952198
t0.9_test_time 0.06453418731689453
