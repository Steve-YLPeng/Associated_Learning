total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.23986666666666667 (28784/120000), AUC 0.4327200651168823
ep0_train_time 8.526790618896484
Test Epoch0 threshold 0.8 Acc 0.9, AUC 0.9740327596664429, avg_entr 0.17668583989143372
ep0_t0.8_test_time 0.2536439895629883
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24441666666666667 (29330/120000), AUC 0.3936171531677246
ep1_train_time 8.018701791763306
Test Epoch1 threshold 0.8 Acc 0.9103618421052632, AUC 0.9779928922653198, avg_entr 0.10534075647592545
ep1_t0.8_test_time 0.2522542476654053
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24606666666666666 (29528/120000), AUC 0.4000612497329712
ep2_train_time 8.006854057312012
Test Epoch2 threshold 0.8 Acc 0.9146381578947368, AUC 0.9794943332672119, avg_entr 0.07798202335834503
ep2_t0.8_test_time 0.25275468826293945
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24721666666666667 (29666/120000), AUC 0.4036519229412079
ep3_train_time 7.995773077011108
Test Epoch3 threshold 0.8 Acc 0.9162828947368421, AUC 0.9802478551864624, avg_entr 0.06559643894433975
ep3_t0.8_test_time 0.2523972988128662
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24788333333333334 (29746/120000), AUC 0.4053458869457245
ep4_train_time 8.169286251068115
Test Epoch4 threshold 0.8 Acc 0.9138157894736842, AUC 0.9805957078933716, avg_entr 0.05968024581670761
ep4_t0.8_test_time 0.25975823402404785
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24841666666666667 (29810/120000), AUC 0.40718674659729004
ep5_train_time 8.213634729385376
Test Epoch5 threshold 0.8 Acc 0.9148026315789474, AUC 0.9807030558586121, avg_entr 0.053423862904310226
ep5_t0.8_test_time 0.25178027153015137
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.248675 (29841/120000), AUC 0.40928080677986145
ep6_train_time 8.052621126174927
Test Epoch6 threshold 0.8 Acc 0.9149671052631579, AUC 0.9809374213218689, avg_entr 0.04965437203645706
ep6_t0.8_test_time 0.25171327590942383
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.24890833333333334 (29869/120000), AUC 0.41149771213531494
ep7_train_time 8.062170028686523
Test Epoch7 threshold 0.8 Acc 0.9149671052631579, AUC 0.9807841181755066, avg_entr 0.045034077018499374
ep7_t0.8_test_time 0.25170207023620605
gc 0
Train Epoch8 Acc 0.24910833333333332 (29893/120000), AUC 0.4137154221534729
ep8_train_time 8.151149034500122
Test Epoch8 threshold 0.8 Acc 0.915625, AUC 0.9806187748908997, avg_entr 0.04215463995933533
ep8_t0.8_test_time 0.25125932693481445
gc 0
Train Epoch9 Acc 0.24919166666666667 (29903/120000), AUC 0.41562238335609436
ep9_train_time 8.267460346221924
Test Epoch9 threshold 0.8 Acc 0.9159539473684211, AUC 0.9805988073348999, avg_entr 0.04063152149319649
ep9_t0.8_test_time 0.2513856887817383
Best AUC 0.9809374213218689
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9282894736842106, AUC 0.986566424369812, avg_entr 0.05106991156935692
t0.8_test_time 0.06334519386291504
