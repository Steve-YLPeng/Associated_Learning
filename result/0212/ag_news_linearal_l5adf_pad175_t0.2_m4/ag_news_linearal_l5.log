total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.20723333333333332 (24868/120000), AUC 0.20080707967281342
ep0_train_time 9.828736305236816
Test Epoch0 threshold 0.2 Acc 0.9154605263157894, AUC 0.9803956747055054, avg_entr 0.023555461317300797
ep0_t0.2_test_time 0.2729804515838623
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.14285 (17142/120000), AUC 0.24717938899993896
ep1_train_time 9.355212688446045
Test Epoch1 threshold 0.2 Acc 0.9141447368421053, AUC 0.9805206656455994, avg_entr 0.024181703105568886
ep1_t0.2_test_time 0.27161407470703125
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.06470833333333334 (7765/120000), AUC 0.2865505516529083
ep2_train_time 9.49218201637268
Test Epoch2 threshold 0.2 Acc 0.9144736842105263, AUC 0.9801231622695923, avg_entr 0.02244366519153118
ep2_t0.2_test_time 0.27152132987976074
gc 0
Train Epoch3 Acc 0.031041666666666665 (3725/120000), AUC 0.32118818163871765
ep3_train_time 9.314864158630371
Test Epoch3 threshold 0.2 Acc 0.9106907894736842, AUC 0.9799268245697021, avg_entr 0.019972268491983414
ep3_t0.2_test_time 0.2705526351928711
gc 0
Train Epoch4 Acc 0.018075 (2169/120000), AUC 0.3217962980270386
ep4_train_time 9.272239923477173
Test Epoch4 threshold 0.2 Acc 0.9136513157894737, AUC 0.9799010753631592, avg_entr 0.018513448536396027
ep4_t0.2_test_time 0.2711031436920166
gc 0
Train Epoch5 Acc 0.013025 (1563/120000), AUC 0.3050423860549927
ep5_train_time 9.451470613479614
Test Epoch5 threshold 0.2 Acc 0.9123355263157895, AUC 0.9796430468559265, avg_entr 0.017748354002833366
ep5_t0.2_test_time 0.2696523666381836
gc 0
Train Epoch6 Acc 0.011275 (1353/120000), AUC 0.29454970359802246
ep6_train_time 9.34717607498169
Test Epoch6 threshold 0.2 Acc 0.912828947368421, AUC 0.9796043634414673, avg_entr 0.01795261539518833
ep6_t0.2_test_time 0.27004384994506836
gc 0
Train Epoch7 Acc 0.011808333333333334 (1417/120000), AUC 0.28715279698371887
ep7_train_time 9.302251815795898
Test Epoch7 threshold 0.2 Acc 0.9113486842105263, AUC 0.9796234369277954, avg_entr 0.018021773546934128
ep7_t0.2_test_time 0.27002763748168945
gc 0
Train Epoch8 Acc 0.011808333333333334 (1417/120000), AUC 0.2807140052318573
ep8_train_time 9.506556749343872
Test Epoch8 threshold 0.2 Acc 0.9101973684210526, AUC 0.979383111000061, avg_entr 0.017783090472221375
ep8_t0.2_test_time 0.2695443630218506
gc 0
Train Epoch9 Acc 0.012641666666666667 (1517/120000), AUC 0.27889907360076904
ep9_train_time 9.413532257080078
Test Epoch9 threshold 0.2 Acc 0.9100328947368421, AUC 0.9792835712432861, avg_entr 0.017132095992565155
ep9_t0.2_test_time 0.269561767578125
Best AUC 0.9805206656455994
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9256578947368421, AUC 0.9858626127243042, avg_entr 0.022745132446289062
t0.2_test_time 0.06879615783691406
