total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.6_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.2547083333333333 (30565/120000), AUC 0.6628204584121704
ep0_train_time 5.430051326751709
Test Epoch0 threshold 0.6 Acc 0.9139802631578947, AUC 0.980101466178894, avg_entr 0.024570293724536896
ep0_t0.6_test_time 0.0779726505279541
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.6_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.16789166666666666 (20147/120000), AUC 0.6509408950805664
ep1_train_time 5.193375825881958
Test Epoch1 threshold 0.6 Acc 0.9123355263157895, AUC 0.9800770282745361, avg_entr 0.02508249320089817
ep1_t0.6_test_time 0.0734872817993164
gc 0
Train Epoch2 Acc 0.11446666666666666 (13736/120000), AUC 0.6196523904800415
ep2_train_time 5.149425029754639
Test Epoch2 threshold 0.6 Acc 0.9110197368421052, AUC 0.9798328876495361, avg_entr 0.02451307699084282
ep2_t0.6_test_time 0.07367992401123047
gc 0
Train Epoch3 Acc 0.07566666666666666 (9080/120000), AUC 0.59583979845047
ep3_train_time 5.118353366851807
Test Epoch3 threshold 0.6 Acc 0.9105263157894737, AUC 0.9796088337898254, avg_entr 0.024864336475729942
ep3_t0.6_test_time 0.07134675979614258
gc 0
Train Epoch4 Acc 0.04605833333333333 (5527/120000), AUC 0.580542266368866
ep4_train_time 4.948005676269531
Test Epoch4 threshold 0.6 Acc 0.9100328947368421, AUC 0.9794701933860779, avg_entr 0.024524739012122154
ep4_t0.6_test_time 0.07198929786682129
gc 0
Train Epoch5 Acc 0.03745833333333334 (4495/120000), AUC 0.5596266388893127
ep5_train_time 4.931532859802246
Test Epoch5 threshold 0.6 Acc 0.9090460526315789, AUC 0.9790275692939758, avg_entr 0.0251303743571043
ep5_t0.6_test_time 0.0719003677368164
gc 0
Train Epoch6 Acc 0.03589166666666667 (4307/120000), AUC 0.5390897989273071
ep6_train_time 4.90476393699646
Test Epoch6 threshold 0.6 Acc 0.9100328947368421, AUC 0.9789741039276123, avg_entr 0.02522541768848896
ep6_t0.6_test_time 0.07172155380249023
gc 0
Train Epoch7 Acc 0.035866666666666665 (4304/120000), AUC 0.5131924748420715
ep7_train_time 4.923389434814453
Test Epoch7 threshold 0.6 Acc 0.9090460526315789, AUC 0.978791356086731, avg_entr 0.025538891553878784
ep7_t0.6_test_time 0.07178759574890137
gc 0
Train Epoch8 Acc 0.03568333333333333 (4282/120000), AUC 0.4853884279727936
ep8_train_time 4.908340692520142
Test Epoch8 threshold 0.6 Acc 0.9085526315789474, AUC 0.9786282181739807, avg_entr 0.025256164371967316
ep8_t0.6_test_time 0.07180571556091309
gc 0
Train Epoch9 Acc 0.03528333333333333 (4234/120000), AUC 0.46617022156715393
ep9_train_time 4.924325704574585
Test Epoch9 threshold 0.6 Acc 0.9088815789473684, AUC 0.9785602688789368, avg_entr 0.02542770281434059
ep9_t0.6_test_time 0.07120442390441895
Best AUC 0.980101466178894
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.6_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9171052631578948, AUC 0.985083818435669, avg_entr 0.027221253141760826
t0.6_test_time 0.01870417594909668
