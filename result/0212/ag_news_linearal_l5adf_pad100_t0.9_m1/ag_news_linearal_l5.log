total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25000833333333333 (30001/120000), AUC 0.42207732796669006
ep0_train_time 6.380477428436279
Test Epoch0 threshold 0.9 Acc 0.9064144736842106, AUC 0.9759489893913269, avg_entr 0.16956911981105804
ep0_t0.9_test_time 0.16378426551818848
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25000833333333333 (30001/120000), AUC 0.3392254710197449
ep1_train_time 5.862626314163208
Test Epoch1 threshold 0.9 Acc 0.9139802631578947, AUC 0.97905433177948, avg_entr 0.10109055042266846
ep1_t0.9_test_time 0.16243433952331543
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25000833333333333 (30001/120000), AUC 0.34351247549057007
ep2_train_time 5.8569910526275635
Test Epoch2 threshold 0.9 Acc 0.9149671052631579, AUC 0.979995608329773, avg_entr 0.07883242517709732
ep2_t0.9_test_time 0.16162514686584473
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25000833333333333 (30001/120000), AUC 0.3520171642303467
ep3_train_time 5.990819692611694
Test Epoch3 threshold 0.9 Acc 0.9162828947368421, AUC 0.9805594682693481, avg_entr 0.06598888337612152
ep3_t0.9_test_time 0.16238188743591309
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.35947126150131226
ep4_train_time 5.884083986282349
Test Epoch4 threshold 0.9 Acc 0.9162828947368421, AUC 0.9805264472961426, avg_entr 0.058850981295108795
ep4_t0.9_test_time 0.16130423545837402
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.366345077753067
ep5_train_time 5.856125354766846
Test Epoch5 threshold 0.9 Acc 0.915625, AUC 0.9802194833755493, avg_entr 0.05441707745194435
ep5_t0.9_test_time 0.16218304634094238
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.3718247413635254
ep6_train_time 5.88353705406189
Test Epoch6 threshold 0.9 Acc 0.9164473684210527, AUC 0.980178952217102, avg_entr 0.0488932766020298
ep6_t0.9_test_time 0.1622316837310791
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.37642544507980347
ep7_train_time 5.885265350341797
Test Epoch7 threshold 0.9 Acc 0.9146381578947368, AUC 0.9801783561706543, avg_entr 0.047907549887895584
ep7_t0.9_test_time 0.16207575798034668
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.37908217310905457
ep8_train_time 5.8691089153289795
Test Epoch8 threshold 0.9 Acc 0.9149671052631579, AUC 0.9800344109535217, avg_entr 0.04419877380132675
ep8_t0.9_test_time 0.16160821914672852
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.3823990821838379
ep9_train_time 5.901191234588623
Test Epoch9 threshold 0.9 Acc 0.9151315789473684, AUC 0.9798659086227417, avg_entr 0.04285210743546486
ep9_t0.9_test_time 0.16184687614440918
Best AUC 0.9805594682693481
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.9_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9243421052631579, AUC 0.9862962961196899, avg_entr 0.06849095225334167
t0.9_test_time 0.041337013244628906
