total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.1_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.30111666666666664 (36134/120000), AUC 0.5636559128761292
ep0_train_time 6.989351272583008
Test Epoch0 threshold 0.1 Acc 0.9164473684210527, AUC 0.9804098606109619, avg_entr 0.029107553884387016
ep0_t0.1_test_time 0.17718005180358887
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.1_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.27036666666666664 (32444/120000), AUC 0.6042603254318237
ep1_train_time 6.498760223388672
Test Epoch1 threshold 0.1 Acc 0.9123355263157895, AUC 0.9803885221481323, avg_entr 0.027308810502290726
ep1_t0.1_test_time 0.1745922565460205
gc 0
Train Epoch2 Acc 0.2729416666666667 (32753/120000), AUC 0.5941731929779053
ep2_train_time 6.555666446685791
Test Epoch2 threshold 0.1 Acc 0.9136513157894737, AUC 0.9801417589187622, avg_entr 0.028003687039017677
ep2_t0.1_test_time 0.17492127418518066
gc 0
Train Epoch3 Acc 0.2854333333333333 (34252/120000), AUC 0.5863643884658813
ep3_train_time 6.703801870346069
Test Epoch3 threshold 0.1 Acc 0.9154605263157894, AUC 0.9800887703895569, avg_entr 0.02601839043200016
ep3_t0.1_test_time 0.17410993576049805
gc 0
Train Epoch4 Acc 0.3179916666666667 (38159/120000), AUC 0.5810285210609436
ep4_train_time 6.774622201919556
Test Epoch4 threshold 0.1 Acc 0.9139802631578947, AUC 0.9796987771987915, avg_entr 0.02577098272740841
ep4_t0.1_test_time 0.1831057071685791
gc 0
Train Epoch5 Acc 0.343625 (41235/120000), AUC 0.5782495737075806
ep5_train_time 7.599100828170776
Test Epoch5 threshold 0.1 Acc 0.9143092105263158, AUC 0.9796232581138611, avg_entr 0.02598186768591404
ep5_t0.1_test_time 0.18791413307189941
gc 0
Train Epoch6 Acc 0.35656666666666664 (42788/120000), AUC 0.576810896396637
ep6_train_time 6.9737324714660645
Test Epoch6 threshold 0.1 Acc 0.9144736842105263, AUC 0.9795019626617432, avg_entr 0.02607347071170807
ep6_t0.1_test_time 0.17392563819885254
gc 0
Train Epoch7 Acc 0.373525 (44823/120000), AUC 0.5745933651924133
ep7_train_time 6.621221303939819
Test Epoch7 threshold 0.1 Acc 0.9143092105263158, AUC 0.9794789552688599, avg_entr 0.02618098258972168
ep7_t0.1_test_time 0.17383670806884766
gc 0
Train Epoch8 Acc 0.39145 (46974/120000), AUC 0.5729166865348816
ep8_train_time 6.5211427211761475
Test Epoch8 threshold 0.1 Acc 0.912828947368421, AUC 0.9792826175689697, avg_entr 0.02586791105568409
ep8_t0.1_test_time 0.17492914199829102
gc 0
Train Epoch9 Acc 0.403425 (48411/120000), AUC 0.5717169046401978
ep9_train_time 6.552283763885498
Test Epoch9 threshold 0.1 Acc 0.9123355263157895, AUC 0.9791989922523499, avg_entr 0.02600705996155739
ep9_t0.1_test_time 0.1746513843536377
Best AUC 0.9804098606109619
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.1_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9243421052631579, AUC 0.9863348007202148, avg_entr 0.027658844366669655
t0.1_test_time 0.045069217681884766
