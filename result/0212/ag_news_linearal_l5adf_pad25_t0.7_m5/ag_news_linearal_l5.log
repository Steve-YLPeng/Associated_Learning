total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.7_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.8956583333333333 (107479/120000), AUC 0.9842824339866638
ep0_train_time 6.516837120056152
Test Epoch0 threshold 0.7 Acc 0.9105263157894737, AUC 0.9795889258384705, avg_entr 0.02553187683224678
ep0_t0.7_test_time 0.07377004623413086
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.7_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9513083333333333 (114157/120000), AUC 0.9934951066970825
ep1_train_time 6.1183881759643555
Test Epoch1 threshold 0.7 Acc 0.9113486842105263, AUC 0.979093611240387, avg_entr 0.02456703409552574
ep1_t0.7_test_time 0.07116055488586426
gc 0
Train Epoch2 Acc 0.953 (114360/120000), AUC 0.9936370253562927
ep2_train_time 6.039812803268433
Test Epoch2 threshold 0.7 Acc 0.9105263157894737, AUC 0.9792238473892212, avg_entr 0.02507871575653553
ep2_t0.7_test_time 0.07504415512084961
gc 0
Train Epoch3 Acc 0.9537416666666667 (114449/120000), AUC 0.9938547611236572
ep3_train_time 6.061379671096802
Test Epoch3 threshold 0.7 Acc 0.909375, AUC 0.9792647957801819, avg_entr 0.02572030946612358
ep3_t0.7_test_time 0.07208561897277832
gc 0
Train Epoch4 Acc 0.954875 (114585/120000), AUC 0.9941832423210144
ep4_train_time 6.013152599334717
Test Epoch4 threshold 0.7 Acc 0.9103618421052632, AUC 0.978966236114502, avg_entr 0.0248884204775095
ep4_t0.7_test_time 0.07053661346435547
gc 0
Train Epoch5 Acc 0.957175 (114861/120000), AUC 0.9949262142181396
ep5_train_time 6.155488729476929
Test Epoch5 threshold 0.7 Acc 0.9098684210526315, AUC 0.9786633849143982, avg_entr 0.02563612163066864
ep5_t0.7_test_time 0.0712590217590332
gc 0
Train Epoch6 Acc 0.9577 (114924/120000), AUC 0.9951049089431763
ep6_train_time 6.074098110198975
Test Epoch6 threshold 0.7 Acc 0.9097039473684211, AUC 0.9786367416381836, avg_entr 0.025607381016016006
ep6_t0.7_test_time 0.07062530517578125
gc 0
Train Epoch7 Acc 0.9579916666666667 (114959/120000), AUC 0.9951938390731812
ep7_train_time 6.0486979484558105
Test Epoch7 threshold 0.7 Acc 0.9077302631578947, AUC 0.9782647490501404, avg_entr 0.02616947330534458
ep7_t0.7_test_time 0.07486343383789062
gc 0
Train Epoch8 Acc 0.9584666666666667 (115016/120000), AUC 0.9953129887580872
ep8_train_time 6.055438995361328
Test Epoch8 threshold 0.7 Acc 0.9090460526315789, AUC 0.9782727956771851, avg_entr 0.02543957531452179
ep8_t0.7_test_time 0.07667231559753418
gc 0
Train Epoch9 Acc 0.9600666666666666 (115208/120000), AUC 0.9957144260406494
ep9_train_time 6.109650373458862
Test Epoch9 threshold 0.7 Acc 0.9085526315789474, AUC 0.9781320095062256, avg_entr 0.025697601959109306
ep9_t0.7_test_time 0.07518506050109863
Best AUC 0.9795889258384705
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.7_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9171052631578948, AUC 0.9842303991317749, avg_entr 0.026343151926994324
t0.7_test_time 0.018969297409057617
