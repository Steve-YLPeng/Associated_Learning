total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.29375 (35250/120000), AUC 0.5039860606193542
ep0_train_time 8.484623908996582
Test Epoch0 threshold 0.5 Acc 0.8998355263157894, AUC 0.9739854335784912, avg_entr 0.1794772446155548
ep0_t0.5_test_time 0.2562861442565918
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.255625 (30675/120000), AUC 0.48209822177886963
ep1_train_time 8.115334510803223
Test Epoch1 threshold 0.5 Acc 0.9111842105263158, AUC 0.9778804779052734, avg_entr 0.10579200834035873
ep1_t0.5_test_time 0.2544727325439453
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.249325 (29919/120000), AUC 0.4784298539161682
ep2_train_time 8.034630298614502
Test Epoch2 threshold 0.5 Acc 0.9133223684210526, AUC 0.9793602824211121, avg_entr 0.07938364893198013
ep2_t0.5_test_time 0.25447607040405273
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24919166666666667 (29903/120000), AUC 0.4772751033306122
ep3_train_time 8.239485263824463
Test Epoch3 threshold 0.5 Acc 0.9139802631578947, AUC 0.9801431894302368, avg_entr 0.06607259064912796
ep3_t0.5_test_time 0.2541522979736328
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24906666666666666 (29888/120000), AUC 0.47725552320480347
ep4_train_time 8.213376998901367
Test Epoch4 threshold 0.5 Acc 0.9157894736842105, AUC 0.9806495308876038, avg_entr 0.05826588720083237
ep4_t0.5_test_time 0.25494885444641113
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24895 (29874/120000), AUC 0.47707656025886536
ep5_train_time 7.978426933288574
Test Epoch5 threshold 0.5 Acc 0.9144736842105263, AUC 0.9808615446090698, avg_entr 0.05367976799607277
ep5_t0.5_test_time 0.25435590744018555
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.24889166666666668 (29867/120000), AUC 0.47757840156555176
ep6_train_time 8.100450038909912
Test Epoch6 threshold 0.5 Acc 0.9164473684210527, AUC 0.9808170795440674, avg_entr 0.048233989626169205
ep6_t0.5_test_time 0.25501251220703125
gc 0
Train Epoch7 Acc 0.24875 (29850/120000), AUC 0.4779496490955353
ep7_train_time 8.014031887054443
Test Epoch7 threshold 0.5 Acc 0.9179276315789474, AUC 0.9808300733566284, avg_entr 0.045481156557798386
ep7_t0.5_test_time 0.2544984817504883
gc 0
Train Epoch8 Acc 0.248575 (29829/120000), AUC 0.47855550050735474
ep8_train_time 8.278475046157837
Test Epoch8 threshold 0.5 Acc 0.9131578947368421, AUC 0.9806063175201416, avg_entr 0.042843256145715714
ep8_t0.5_test_time 0.2546854019165039
gc 0
Train Epoch9 Acc 0.24851666666666666 (29822/120000), AUC 0.47977498173713684
ep9_train_time 8.06875729560852
Test Epoch9 threshold 0.5 Acc 0.9167763157894737, AUC 0.9804927110671997, avg_entr 0.03987637907266617
ep9_t0.5_test_time 0.25495076179504395
Best AUC 0.9808615446090698
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9236842105263158, AUC 0.9865356683731079, avg_entr 0.05509959161281586
t0.5_test_time 0.06435322761535645
