total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.9_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9108583333333333 (109303/120000), AUC 0.9852513670921326
ep0_train_time 8.263954401016235
Test Epoch0 threshold 0.9 Acc 0.9115131578947369, AUC 0.9800055027008057, avg_entr 0.026472635567188263
ep0_t0.9_test_time 0.16231322288513184
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.9_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9508 (114096/120000), AUC 0.9934382438659668
ep1_train_time 7.886707782745361
Test Epoch1 threshold 0.9 Acc 0.9151315789473684, AUC 0.9801938533782959, avg_entr 0.025294451043009758
ep1_t0.9_test_time 0.1598649024963379
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.9_m5//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9520916666666667 (114251/120000), AUC 0.9934459328651428
ep2_train_time 7.910618543624878
Test Epoch2 threshold 0.9 Acc 0.9133223684210526, AUC 0.979765772819519, avg_entr 0.02617374248802662
ep2_t0.9_test_time 0.16025757789611816
gc 0
Train Epoch3 Acc 0.953475 (114417/120000), AUC 0.9937006831169128
ep3_train_time 7.97495698928833
Test Epoch3 threshold 0.9 Acc 0.912828947368421, AUC 0.9797182083129883, avg_entr 0.025509467348456383
ep3_t0.9_test_time 0.16074371337890625
gc 0
Train Epoch4 Acc 0.954175 (114501/120000), AUC 0.9940396547317505
ep4_train_time 7.859346389770508
Test Epoch4 threshold 0.9 Acc 0.9125, AUC 0.9795181751251221, avg_entr 0.024783074855804443
ep4_t0.9_test_time 0.15985512733459473
gc 0
Train Epoch5 Acc 0.9551166666666666 (114614/120000), AUC 0.9943150281906128
ep5_train_time 8.078820705413818
Test Epoch5 threshold 0.9 Acc 0.9100328947368421, AUC 0.979302704334259, avg_entr 0.02734682522714138
ep5_t0.9_test_time 0.16117215156555176
gc 0
Train Epoch6 Acc 0.9569166666666666 (114830/120000), AUC 0.9949768781661987
ep6_train_time 7.99493145942688
Test Epoch6 threshold 0.9 Acc 0.9111842105263158, AUC 0.9792899489402771, avg_entr 0.026131168007850647
ep6_t0.9_test_time 0.1602776050567627
gc 0
Train Epoch7 Acc 0.9575083333333333 (114901/120000), AUC 0.9950278997421265
ep7_train_time 7.956685304641724
Test Epoch7 threshold 0.9 Acc 0.9110197368421052, AUC 0.9790338277816772, avg_entr 0.026148341596126556
ep7_t0.9_test_time 0.16062211990356445
gc 0
Train Epoch8 Acc 0.9578416666666667 (114941/120000), AUC 0.9950807094573975
ep8_train_time 7.888318300247192
Test Epoch8 threshold 0.9 Acc 0.9088815789473684, AUC 0.9790171384811401, avg_entr 0.026591353118419647
ep8_t0.9_test_time 0.16010284423828125
gc 0
Train Epoch9 Acc 0.9583916666666666 (115007/120000), AUC 0.9952549934387207
ep9_train_time 7.934568881988525
Test Epoch9 threshold 0.9 Acc 0.9103618421052632, AUC 0.9788477420806885, avg_entr 0.026355979964137077
ep9_t0.9_test_time 0.16067266464233398
Best AUC 0.9801938533782959
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.9_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9210526315789473, AUC 0.9851104617118835, avg_entr 0.024372484534978867
t0.9_test_time 0.040850162506103516
