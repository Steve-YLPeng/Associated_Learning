total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.18728333333333333 (22474/120000), AUC 0.3146554231643677
ep0_train_time 9.907289505004883
Test Epoch0 threshold 0.1 Acc 0.9157894736842105, AUC 0.980614960193634, avg_entr 0.023649923503398895
ep0_t0.1_test_time 0.27526211738586426
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.14926666666666666 (17912/120000), AUC 0.3397376537322998
ep1_train_time 9.48665976524353
Test Epoch1 threshold 0.1 Acc 0.9143092105263158, AUC 0.9805117845535278, avg_entr 0.021706221625208855
ep1_t0.1_test_time 0.2737874984741211
gc 0
Train Epoch2 Acc 0.08279166666666667 (9935/120000), AUC 0.3984617292881012
ep2_train_time 9.5022611618042
Test Epoch2 threshold 0.1 Acc 0.9159539473684211, AUC 0.9804561138153076, avg_entr 0.019550712779164314
ep2_t0.1_test_time 0.27485203742980957
gc 0
Train Epoch3 Acc 0.0394 (4728/120000), AUC 0.41779088973999023
ep3_train_time 9.53067684173584
Test Epoch3 threshold 0.1 Acc 0.915296052631579, AUC 0.9802752733230591, avg_entr 0.016170049086213112
ep3_t0.1_test_time 0.27352190017700195
gc 0
Train Epoch4 Acc 0.036475 (4377/120000), AUC 0.40398430824279785
ep4_train_time 9.497909545898438
Test Epoch4 threshold 0.1 Acc 0.9120065789473685, AUC 0.9800689220428467, avg_entr 0.013476064428687096
ep4_t0.1_test_time 0.2745397090911865
gc 0
Train Epoch5 Acc 0.05080833333333333 (6097/120000), AUC 0.4057512581348419
ep5_train_time 9.51212739944458
Test Epoch5 threshold 0.1 Acc 0.9139802631578947, AUC 0.9799065589904785, avg_entr 0.01245432160794735
ep5_t0.1_test_time 0.27372193336486816
gc 0
Train Epoch6 Acc 0.061408333333333336 (7369/120000), AUC 0.40906503796577454
ep6_train_time 9.474084615707397
Test Epoch6 threshold 0.1 Acc 0.9143092105263158, AUC 0.9797137975692749, avg_entr 0.012361004017293453
ep6_t0.1_test_time 0.27335309982299805
gc 0
Train Epoch7 Acc 0.06848333333333333 (8218/120000), AUC 0.40885841846466064
ep7_train_time 9.443814992904663
Test Epoch7 threshold 0.1 Acc 0.9141447368421053, AUC 0.9795724153518677, avg_entr 0.01216377504169941
ep7_t0.1_test_time 0.2739236354827881
gc 0
Train Epoch8 Acc 0.073975 (8877/120000), AUC 0.40596485137939453
ep8_train_time 9.429110288619995
Test Epoch8 threshold 0.1 Acc 0.9125, AUC 0.9795148968696594, avg_entr 0.011452226899564266
ep8_t0.1_test_time 0.27334022521972656
gc 0
Train Epoch9 Acc 0.079025 (9483/120000), AUC 0.4029727280139923
ep9_train_time 9.440361738204956
Test Epoch9 threshold 0.1 Acc 0.9141447368421053, AUC 0.9794059991836548, avg_entr 0.011747951619327068
ep9_t0.1_test_time 0.2733426094055176
Best AUC 0.980614960193634
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9236842105263158, AUC 0.986095130443573, avg_entr 0.02221115492284298
t0.1_test_time 0.06916236877441406
