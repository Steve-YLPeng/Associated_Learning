total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9231166666666667 (110774/120000), AUC 0.9843158721923828
ep0_train_time 10.435253143310547
Test Epoch0 threshold 0.9 Acc 0.9164473684210527, AUC 0.9805147647857666, avg_entr 0.025353336706757545
ep0_t0.9_test_time 0.24981236457824707
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9490916666666667 (113891/120000), AUC 0.9927607178688049
ep1_train_time 10.136155128479004
Test Epoch1 threshold 0.9 Acc 0.9143092105263158, AUC 0.9803791046142578, avg_entr 0.026937905699014664
ep1_t0.9_test_time 0.24820828437805176
gc 0
Train Epoch2 Acc 0.950325 (114039/120000), AUC 0.9930506348609924
ep2_train_time 9.867869853973389
Test Epoch2 threshold 0.9 Acc 0.9139802631578947, AUC 0.9802711009979248, avg_entr 0.025401121005415916
ep2_t0.9_test_time 0.24844884872436523
gc 0
Train Epoch3 Acc 0.9515833333333333 (114190/120000), AUC 0.9930895566940308
ep3_train_time 9.943704605102539
Test Epoch3 threshold 0.9 Acc 0.915296052631579, AUC 0.9802000522613525, avg_entr 0.025714049115777016
ep3_t0.9_test_time 0.24864864349365234
gc 0
Train Epoch4 Acc 0.9526 (114312/120000), AUC 0.9936048984527588
ep4_train_time 9.823976755142212
Test Epoch4 threshold 0.9 Acc 0.912828947368421, AUC 0.9800119996070862, avg_entr 0.026061318814754486
ep4_t0.9_test_time 0.24916887283325195
gc 0
Train Epoch5 Acc 0.95455 (114546/120000), AUC 0.9943572878837585
ep5_train_time 10.002753734588623
Test Epoch5 threshold 0.9 Acc 0.9126644736842106, AUC 0.9798731803894043, avg_entr 0.026076242327690125
ep5_t0.9_test_time 0.24889111518859863
gc 0
Train Epoch6 Acc 0.9549916666666667 (114599/120000), AUC 0.9944800138473511
ep6_train_time 9.988067388534546
Test Epoch6 threshold 0.9 Acc 0.9136513157894737, AUC 0.9798189401626587, avg_entr 0.02542819455265999
ep6_t0.9_test_time 0.25859689712524414
gc 0
Train Epoch7 Acc 0.9557333333333333 (114688/120000), AUC 0.9946353435516357
ep7_train_time 10.238301515579224
Test Epoch7 threshold 0.9 Acc 0.9136513157894737, AUC 0.9797078967094421, avg_entr 0.025808896869421005
ep7_t0.9_test_time 0.24921154975891113
gc 0
Train Epoch8 Acc 0.9560416666666667 (114725/120000), AUC 0.9947951436042786
ep8_train_time 9.913949489593506
Test Epoch8 threshold 0.9 Acc 0.9111842105263158, AUC 0.9796020984649658, avg_entr 0.02653752826154232
ep8_t0.9_test_time 0.2491300106048584
gc 0
Train Epoch9 Acc 0.9570333333333333 (114844/120000), AUC 0.9951117038726807
ep9_train_time 9.854729652404785
Test Epoch9 threshold 0.9 Acc 0.912828947368421, AUC 0.9795477390289307, avg_entr 0.02629515528678894
ep9_t0.9_test_time 0.24808311462402344
Best AUC 0.9805147647857666
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9217105263157894, AUC 0.9859512448310852, avg_entr 0.025701001286506653
t0.9_test_time 0.0629117488861084
