total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.2511583333333333 (30139/120000), AUC 0.3616984188556671
ep0_train_time 9.69894814491272
Test Epoch0 threshold 0.7 Acc 0.9175986842105263, AUC 0.9808235168457031, avg_entr 0.025819649919867516
ep0_t0.7_test_time 0.2541987895965576
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25455 (30546/120000), AUC 0.32164883613586426
ep1_train_time 8.968217611312866
Test Epoch1 threshold 0.7 Acc 0.9157894736842105, AUC 0.9809607267379761, avg_entr 0.02652084454894066
ep1_t0.7_test_time 0.25328803062438965
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2606583333333333 (31279/120000), AUC 0.3000655174255371
ep2_train_time 9.144631385803223
Test Epoch2 threshold 0.7 Acc 0.9164473684210527, AUC 0.9807552099227905, avg_entr 0.026218866929411888
ep2_t0.7_test_time 0.2537567615509033
gc 0
Train Epoch3 Acc 0.25969166666666665 (31163/120000), AUC 0.2930881381034851
ep3_train_time 9.089331150054932
Test Epoch3 threshold 0.7 Acc 0.9164473684210527, AUC 0.9806067943572998, avg_entr 0.026277773082256317
ep3_t0.7_test_time 0.25284361839294434
gc 0
Train Epoch4 Acc 0.25735833333333336 (30883/120000), AUC 0.3109288811683655
ep4_train_time 9.338228464126587
Test Epoch4 threshold 0.7 Acc 0.915296052631579, AUC 0.9804372787475586, avg_entr 0.02546362578868866
ep4_t0.7_test_time 0.2579312324523926
gc 0
Train Epoch5 Acc 0.25740833333333335 (30889/120000), AUC 0.32484516501426697
ep5_train_time 9.37196159362793
Test Epoch5 threshold 0.7 Acc 0.9154605263157894, AUC 0.9802963733673096, avg_entr 0.02541258931159973
ep5_t0.7_test_time 0.25335025787353516
gc 0
Train Epoch6 Acc 0.257275 (30873/120000), AUC 0.3292490839958191
ep6_train_time 9.108360767364502
Test Epoch6 threshold 0.7 Acc 0.9133223684210526, AUC 0.9802116751670837, avg_entr 0.02538704127073288
ep6_t0.7_test_time 0.2533233165740967
gc 0
Train Epoch7 Acc 0.25675 (30810/120000), AUC 0.3321710526943207
ep7_train_time 9.02494764328003
Test Epoch7 threshold 0.7 Acc 0.9139802631578947, AUC 0.9800074100494385, avg_entr 0.026261495426297188
ep7_t0.7_test_time 0.25475096702575684
gc 0
Train Epoch8 Acc 0.2561833333333333 (30742/120000), AUC 0.335418164730072
ep8_train_time 9.03546690940857
Test Epoch8 threshold 0.7 Acc 0.9154605263157894, AUC 0.9800313711166382, avg_entr 0.025830594822764397
ep8_t0.7_test_time 0.2523307800292969
gc 0
Train Epoch9 Acc 0.25615 (30738/120000), AUC 0.3385637700557709
ep9_train_time 9.198778867721558
Test Epoch9 threshold 0.7 Acc 0.9151315789473684, AUC 0.9799259901046753, avg_entr 0.025532720610499382
ep9_t0.7_test_time 0.25232839584350586
Best AUC 0.9809607267379761
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9276315789473685, AUC 0.986672043800354, avg_entr 0.025790147483348846
t0.7_test_time 0.06442093849182129
