total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2528916666666667 (30347/120000), AUC 0.5360055565834045
ep0_train_time 4.957671642303467
Test Epoch0 threshold 0.1 Acc 0.9105263157894737, AUC 0.9779108762741089, avg_entr 0.1583406776189804
ep0_t0.1_test_time 0.10340547561645508
Save ckpt to ckpt/ag_news_linearal_l5adp_pad50_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25430833333333336 (30517/120000), AUC 0.554054856300354
ep1_train_time 4.530569314956665
Test Epoch1 threshold 0.1 Acc 0.9162828947368421, AUC 0.9799214601516724, avg_entr 0.09799033403396606
ep1_t0.1_test_time 0.10140299797058105
Save ckpt to ckpt/ag_news_linearal_l5adp_pad50_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.254125 (30495/120000), AUC 0.5530025959014893
ep2_train_time 4.522350311279297
Test Epoch2 threshold 0.1 Acc 0.9159539473684211, AUC 0.9802621603012085, avg_entr 0.07893995940685272
ep2_t0.1_test_time 0.10185003280639648
Save ckpt to ckpt/ag_news_linearal_l5adp_pad50_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25380833333333336 (30457/120000), AUC 0.5520057082176208
ep3_train_time 4.5035271644592285
Test Epoch3 threshold 0.1 Acc 0.9164473684210527, AUC 0.9809298515319824, avg_entr 0.06670302152633667
ep3_t0.1_test_time 0.1011357307434082
Save ckpt to ckpt/ag_news_linearal_l5adp_pad50_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25365 (30438/120000), AUC 0.5516922473907471
ep4_train_time 4.490819215774536
Test Epoch4 threshold 0.1 Acc 0.9159539473684211, AUC 0.9803661108016968, avg_entr 0.05816921591758728
ep4_t0.1_test_time 0.10162687301635742
gc 0
Train Epoch5 Acc 0.2533 (30396/120000), AUC 0.551034688949585
ep5_train_time 4.521432399749756
Test Epoch5 threshold 0.1 Acc 0.9151315789473684, AUC 0.9799661636352539, avg_entr 0.05678887665271759
ep5_t0.1_test_time 0.10213208198547363
gc 0
Train Epoch6 Acc 0.2531 (30372/120000), AUC 0.5509078502655029
ep6_train_time 4.495185375213623
Test Epoch6 threshold 0.1 Acc 0.9139802631578947, AUC 0.9799046516418457, avg_entr 0.05017638951539993
ep6_t0.1_test_time 0.10144424438476562
gc 0
Train Epoch7 Acc 0.25274166666666664 (30329/120000), AUC 0.5507702231407166
ep7_train_time 4.520647764205933
Test Epoch7 threshold 0.1 Acc 0.9134868421052632, AUC 0.9795630574226379, avg_entr 0.04718225449323654
ep7_t0.1_test_time 0.10152292251586914
gc 0
Train Epoch8 Acc 0.2524 (30288/120000), AUC 0.5506508350372314
ep8_train_time 4.586860656738281
Test Epoch8 threshold 0.1 Acc 0.9111842105263158, AUC 0.9794344305992126, avg_entr 0.045975539833307266
ep8_t0.1_test_time 0.10488581657409668
gc 0
Train Epoch9 Acc 0.25230833333333336 (30277/120000), AUC 0.549927830696106
ep9_train_time 4.734133958816528
Test Epoch9 threshold 0.1 Acc 0.9133223684210526, AUC 0.9795387983322144, avg_entr 0.043574392795562744
ep9_t0.1_test_time 0.10479402542114258
Best AUC 0.9809298515319824
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad50_t0.1_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9243421052631579, AUC 0.9860833883285522, avg_entr 0.06858251988887787
t0.1_test_time 0.026979923248291016
