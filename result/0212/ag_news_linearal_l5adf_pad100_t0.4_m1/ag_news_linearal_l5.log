total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25201666666666667 (30242/120000), AUC 0.5449614524841309
ep0_train_time 6.255246877670288
Test Epoch0 threshold 0.4 Acc 0.906578947368421, AUC 0.9762554168701172, avg_entr 0.16875693202018738
ep0_t0.4_test_time 0.16170644760131836
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25330833333333336 (30397/120000), AUC 0.60816890001297
ep1_train_time 6.31294846534729
Test Epoch1 threshold 0.4 Acc 0.9131578947368421, AUC 0.9792935848236084, avg_entr 0.10221795737743378
ep1_t0.4_test_time 0.1723461151123047
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25524166666666664 (30629/120000), AUC 0.61189866065979
ep2_train_time 6.6948699951171875
Test Epoch2 threshold 0.4 Acc 0.9141447368421053, AUC 0.9801937937736511, avg_entr 0.07937624305486679
ep2_t0.4_test_time 0.16659116744995117
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.2592 (31104/120000), AUC 0.612332820892334
ep3_train_time 6.528284072875977
Test Epoch3 threshold 0.4 Acc 0.9154605263157894, AUC 0.9805775880813599, avg_entr 0.06558102369308472
ep3_t0.4_test_time 0.1630687713623047
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.266775 (32013/120000), AUC 0.6125723123550415
ep4_train_time 6.1698219776153564
Test Epoch4 threshold 0.4 Acc 0.9162828947368421, AUC 0.9806441068649292, avg_entr 0.058056559413671494
ep4_t0.4_test_time 0.1628870964050293
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.27946666666666664 (33536/120000), AUC 0.6132012009620667
ep5_train_time 6.104403734207153
Test Epoch5 threshold 0.4 Acc 0.9161184210526315, AUC 0.9805777072906494, avg_entr 0.05347728729248047
ep5_t0.4_test_time 0.16266155242919922
gc 0
Train Epoch6 Acc 0.29586666666666667 (35504/120000), AUC 0.6138216257095337
ep6_train_time 6.119517087936401
Test Epoch6 threshold 0.4 Acc 0.9151315789473684, AUC 0.9804246425628662, avg_entr 0.050424300134181976
ep6_t0.4_test_time 0.1614980697631836
gc 0
Train Epoch7 Acc 0.31915 (38298/120000), AUC 0.6142076849937439
ep7_train_time 6.120232820510864
Test Epoch7 threshold 0.4 Acc 0.9162828947368421, AUC 0.9802627563476562, avg_entr 0.0459408201277256
ep7_t0.4_test_time 0.16225886344909668
gc 0
Train Epoch8 Acc 0.33735 (40482/120000), AUC 0.6154968738555908
ep8_train_time 6.1165807247161865
Test Epoch8 threshold 0.4 Acc 0.9143092105263158, AUC 0.9801520109176636, avg_entr 0.04519215598702431
ep8_t0.4_test_time 0.16287565231323242
gc 0
Train Epoch9 Acc 0.34374166666666667 (41249/120000), AUC 0.6153478622436523
ep9_train_time 6.123064279556274
Test Epoch9 threshold 0.4 Acc 0.9136513157894737, AUC 0.9801373481750488, avg_entr 0.04288981482386589
ep9_t0.4_test_time 0.1627187728881836
Best AUC 0.9806441068649292
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.4_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9236842105263158, AUC 0.986079752445221, avg_entr 0.05945925787091255
t0.4_test_time 0.041243791580200195
