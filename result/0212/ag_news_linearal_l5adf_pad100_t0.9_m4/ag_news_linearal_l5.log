total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.9_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.25900833333333334 (31081/120000), AUC 0.4070062041282654
ep0_train_time 7.814694404602051
Test Epoch0 threshold 0.9 Acc 0.9169407894736842, AUC 0.9802658557891846, avg_entr 0.026045314967632294
ep0_t0.9_test_time 0.1605370044708252
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.9_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.39005 (46806/120000), AUC 0.43629440665245056
ep1_train_time 7.308586597442627
Test Epoch1 threshold 0.9 Acc 0.9157894736842105, AUC 0.9803548455238342, avg_entr 0.026610098779201508
ep1_t0.9_test_time 0.15929007530212402
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.9_m4//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.3767333333333333 (45208/120000), AUC 0.4448799788951874
ep2_train_time 7.265135288238525
Test Epoch2 threshold 0.9 Acc 0.9151315789473684, AUC 0.9801121950149536, avg_entr 0.025866568088531494
ep2_t0.9_test_time 0.15976643562316895
gc 0
Train Epoch3 Acc 0.28296666666666664 (33956/120000), AUC 0.47015249729156494
ep3_train_time 7.415520668029785
Test Epoch3 threshold 0.9 Acc 0.912828947368421, AUC 0.9799471497535706, avg_entr 0.026290884241461754
ep3_t0.9_test_time 0.15970587730407715
gc 0
Train Epoch4 Acc 0.15076666666666666 (18092/120000), AUC 0.4638092815876007
ep4_train_time 7.440164089202881
Test Epoch4 threshold 0.9 Acc 0.9121710526315789, AUC 0.97962886095047, avg_entr 0.02562202885746956
ep4_t0.9_test_time 0.1593644618988037
gc 0
Train Epoch5 Acc 0.08355833333333333 (10027/120000), AUC 0.4262048006057739
ep5_train_time 7.455964803695679
Test Epoch5 threshold 0.9 Acc 0.9113486842105263, AUC 0.9795553684234619, avg_entr 0.025342365726828575
ep5_t0.9_test_time 0.15988683700561523
gc 0
Train Epoch6 Acc 0.09103333333333333 (10924/120000), AUC 0.38852840662002563
ep6_train_time 7.505454063415527
Test Epoch6 threshold 0.9 Acc 0.9115131578947369, AUC 0.9794130325317383, avg_entr 0.025647394359111786
ep6_t0.9_test_time 0.15987396240234375
gc 0
Train Epoch7 Acc 0.09545 (11454/120000), AUC 0.36485129594802856
ep7_train_time 7.431163787841797
Test Epoch7 threshold 0.9 Acc 0.9126644736842106, AUC 0.9793474674224854, avg_entr 0.026814093813300133
ep7_t0.9_test_time 0.16082525253295898
gc 0
Train Epoch8 Acc 0.10535 (12642/120000), AUC 0.351912260055542
ep8_train_time 7.409908056259155
Test Epoch8 threshold 0.9 Acc 0.9111842105263158, AUC 0.979221522808075, avg_entr 0.025805892422795296
ep8_t0.9_test_time 0.15981554985046387
gc 0
Train Epoch9 Acc 0.11174166666666667 (13409/120000), AUC 0.3462255299091339
ep9_train_time 7.3537163734436035
Test Epoch9 threshold 0.9 Acc 0.9121710526315789, AUC 0.9791103601455688, avg_entr 0.026051873341202736
ep9_t0.9_test_time 0.15957331657409668
Best AUC 0.9803548455238342
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.9_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9256578947368421, AUC 0.9857617616653442, avg_entr 0.02530861087143421
t0.9_test_time 0.0408473014831543
