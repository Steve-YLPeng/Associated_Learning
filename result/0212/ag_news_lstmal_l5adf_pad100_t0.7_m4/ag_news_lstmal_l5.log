total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad100_t0.7_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.20965 (25158/120000), AUC 0.5256717205047607
ep0_train_time 47.17469930648804
Test Epoch0 threshold 0.7 Acc 0.9139802631578947, AUC 0.9804535508155823, avg_entr 0.025589553639292717
ep0_t0.7_test_time 0.16914153099060059
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad100_t0.7_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.20923333333333333 (25108/120000), AUC 0.5402645468711853
ep1_train_time 47.54691290855408
Test Epoch1 threshold 0.7 Acc 0.9159539473684211, AUC 0.9802395105361938, avg_entr 0.02591232769191265
ep1_t0.7_test_time 0.16217637062072754
gc 0
Train Epoch2 Acc 0.20506666666666667 (24608/120000), AUC 0.529622495174408
ep2_train_time 47.58603501319885
Test Epoch2 threshold 0.7 Acc 0.9139802631578947, AUC 0.979974627494812, avg_entr 0.024724503979086876
ep2_t0.7_test_time 0.16198396682739258
gc 0
Train Epoch3 Acc 0.18989166666666665 (22787/120000), AUC 0.5218406319618225
ep3_train_time 47.73277831077576
Test Epoch3 threshold 0.7 Acc 0.9134868421052632, AUC 0.979886531829834, avg_entr 0.02644096501171589
ep3_t0.7_test_time 0.16115188598632812
gc 0
Train Epoch4 Acc 0.20923333333333333 (25108/120000), AUC 0.5191614627838135
ep4_train_time 47.5143563747406
Test Epoch4 threshold 0.7 Acc 0.9141447368421053, AUC 0.9796871542930603, avg_entr 0.026538901031017303
ep4_t0.7_test_time 0.16997289657592773
gc 0
Train Epoch5 Acc 0.21131666666666668 (25358/120000), AUC 0.5075067281723022
ep5_train_time 47.323647260665894
Test Epoch5 threshold 0.7 Acc 0.9131578947368421, AUC 0.9795635938644409, avg_entr 0.025908133015036583
ep5_t0.7_test_time 0.1616053581237793
gc 0
Train Epoch6 Acc 0.21805 (26166/120000), AUC 0.5016795992851257
ep6_train_time 47.743109941482544
Test Epoch6 threshold 0.7 Acc 0.9125, AUC 0.9795020818710327, avg_entr 0.02599168010056019
ep6_t0.7_test_time 0.16224145889282227
gc 0
Train Epoch7 Acc 0.234025 (28083/120000), AUC 0.4985085427761078
ep7_train_time 47.725489377975464
Test Epoch7 threshold 0.7 Acc 0.9126644736842106, AUC 0.9794952869415283, avg_entr 0.026326796039938927
ep7_t0.7_test_time 0.16490650177001953
gc 0
Train Epoch8 Acc 0.28379166666666666 (34055/120000), AUC 0.49760857224464417
ep8_train_time 47.70660662651062
Test Epoch8 threshold 0.7 Acc 0.9120065789473685, AUC 0.9793661832809448, avg_entr 0.026004420593380928
ep8_t0.7_test_time 0.1774897575378418
gc 0
Train Epoch9 Acc 0.30406666666666665 (36488/120000), AUC 0.49807512760162354
ep9_train_time 47.38407874107361
Test Epoch9 threshold 0.7 Acc 0.9115131578947369, AUC 0.9792401194572449, avg_entr 0.026073919609189034
ep9_t0.7_test_time 0.16812610626220703
Best AUC 0.9804535508155823
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad100_t0.7_m4//ag_news_lstmal_l5_prefix.pt
Test threshold 0.7 Acc 0.9217105263157894, AUC 0.9858977794647217, avg_entr 0.024802278727293015
t0.7_test_time 0.046404361724853516
