total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24998333333333334 (29998/120000), AUC 0.5563568472862244
ep0_train_time 6.769127607345581
Test Epoch0 threshold 0.5 Acc 0.9044407894736842, AUC 0.9764200448989868, avg_entr 0.17722691595554352
ep0_t0.5_test_time 0.16996049880981445
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.6069194674491882
ep1_train_time 6.303860664367676
Test Epoch1 threshold 0.5 Acc 0.9162828947368421, AUC 0.9793625473976135, avg_entr 0.10243932902812958
ep1_t0.5_test_time 0.16788983345031738
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.6076366901397705
ep2_train_time 6.32688045501709
Test Epoch2 threshold 0.5 Acc 0.9141447368421053, AUC 0.9802272915840149, avg_entr 0.08074032515287399
ep2_t0.5_test_time 0.16756463050842285
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.6045079231262207
ep3_train_time 6.255001068115234
Test Epoch3 threshold 0.5 Acc 0.9151315789473684, AUC 0.9803368449211121, avg_entr 0.06805810332298279
ep3_t0.5_test_time 0.1684715747833252
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.601547360420227
ep4_train_time 6.277958154678345
Test Epoch4 threshold 0.5 Acc 0.915625, AUC 0.9806809425354004, avg_entr 0.06066880375146866
ep4_t0.5_test_time 0.1737518310546875
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.5992358326911926
ep5_train_time 6.192620038986206
Test Epoch5 threshold 0.5 Acc 0.9159539473684211, AUC 0.9804666042327881, avg_entr 0.05379261076450348
ep5_t0.5_test_time 0.16536688804626465
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.5974650382995605
ep6_train_time 6.130345582962036
Test Epoch6 threshold 0.5 Acc 0.9166118421052631, AUC 0.9802934527397156, avg_entr 0.04985310882329941
ep6_t0.5_test_time 0.16531109809875488
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.5957955121994019
ep7_train_time 6.13347053527832
Test Epoch7 threshold 0.5 Acc 0.9144736842105263, AUC 0.9803050756454468, avg_entr 0.046583130955696106
ep7_t0.5_test_time 0.18077611923217773
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.5943845510482788
ep8_train_time 6.3304126262664795
Test Epoch8 threshold 0.5 Acc 0.9139802631578947, AUC 0.9800777435302734, avg_entr 0.043673329055309296
ep8_t0.5_test_time 0.16972708702087402
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.5936762690544128
ep9_train_time 6.273477792739868
Test Epoch9 threshold 0.5 Acc 0.9134868421052632, AUC 0.9800128936767578, avg_entr 0.04250935837626457
ep9_t0.5_test_time 0.17553973197937012
Best AUC 0.9806809425354004
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.5_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9203947368421053, AUC 0.9860653877258301, avg_entr 0.06269814074039459
t0.5_test_time 0.04224967956542969
