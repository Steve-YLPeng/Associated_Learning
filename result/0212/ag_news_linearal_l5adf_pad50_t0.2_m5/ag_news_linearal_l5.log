total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.2_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9258166666666666 (111098/120000), AUC 0.9867312908172607
ep0_train_time 7.261176824569702
Test Epoch0 threshold 0.2 Acc 0.9136513157894737, AUC 0.9803553819656372, avg_entr 0.021780837327241898
ep0_t0.2_test_time 0.13449883460998535
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.2_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9517583333333334 (114211/120000), AUC 0.9937068819999695
ep1_train_time 6.854871511459351
Test Epoch1 threshold 0.2 Acc 0.9121710526315789, AUC 0.9795586466789246, avg_entr 0.01935730315744877
ep1_t0.2_test_time 0.1323990821838379
gc 0
Train Epoch2 Acc 0.952825 (114339/120000), AUC 0.9936727285385132
ep2_train_time 6.893645524978638
Test Epoch2 threshold 0.2 Acc 0.9113486842105263, AUC 0.9792963266372681, avg_entr 0.01828460954129696
ep2_t0.2_test_time 0.1304764747619629
gc 0
Train Epoch3 Acc 0.9539583333333334 (114475/120000), AUC 0.9938746690750122
ep3_train_time 6.827664136886597
Test Epoch3 threshold 0.2 Acc 0.9110197368421052, AUC 0.9794337749481201, avg_entr 0.018942488357424736
ep3_t0.2_test_time 0.13209915161132812
gc 0
Train Epoch4 Acc 0.955125 (114615/120000), AUC 0.9941980838775635
ep4_train_time 6.935972452163696
Test Epoch4 threshold 0.2 Acc 0.9103618421052632, AUC 0.9793285131454468, avg_entr 0.018438871949911118
ep4_t0.2_test_time 0.12956500053405762
gc 0
Train Epoch5 Acc 0.957375 (114885/120000), AUC 0.9949535131454468
ep5_train_time 6.837194919586182
Test Epoch5 threshold 0.2 Acc 0.9100328947368421, AUC 0.979103147983551, avg_entr 0.017906922847032547
ep5_t0.2_test_time 0.1280655860900879
gc 0
Train Epoch6 Acc 0.9579833333333333 (114958/120000), AUC 0.9950879812240601
ep6_train_time 6.835602283477783
Test Epoch6 threshold 0.2 Acc 0.9088815789473684, AUC 0.9785110950469971, avg_entr 0.0176974069327116
ep6_t0.2_test_time 0.12789011001586914
gc 0
Train Epoch7 Acc 0.9586166666666667 (115034/120000), AUC 0.9952150583267212
ep7_train_time 6.752752780914307
Test Epoch7 threshold 0.2 Acc 0.9087171052631579, AUC 0.9786092638969421, avg_entr 0.017290879040956497
ep7_t0.2_test_time 0.1290264129638672
gc 0
Train Epoch8 Acc 0.9589 (115068/120000), AUC 0.9953012466430664
ep8_train_time 6.791726589202881
Test Epoch8 threshold 0.2 Acc 0.9092105263157895, AUC 0.9786458015441895, avg_entr 0.01691380701959133
ep8_t0.2_test_time 0.12991690635681152
gc 0
Train Epoch9 Acc 0.9601083333333333 (115213/120000), AUC 0.995684802532196
ep9_train_time 6.849544525146484
Test Epoch9 threshold 0.2 Acc 0.9087171052631579, AUC 0.9784175753593445, avg_entr 0.01748887076973915
ep9_t0.2_test_time 0.1304187774658203
Best AUC 0.9803553819656372
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.2_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9217105263157894, AUC 0.9857561588287354, avg_entr 0.021693548187613487
t0.2_test_time 0.033507585525512695
