total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.3_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.050116666666666664 (6014/120000), AUC 0.33357885479927063
ep0_train_time 6.078721046447754
Test Epoch0 threshold 0.3 Acc 0.9159539473684211, AUC 0.9806836843490601, avg_entr 0.02557719685137272
ep0_t0.3_test_time 0.11321139335632324
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.3_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.045191666666666665 (5423/120000), AUC 0.3533627986907959
ep1_train_time 5.761139392852783
Test Epoch1 threshold 0.3 Acc 0.9151315789473684, AUC 0.9805468320846558, avg_entr 0.02557840384542942
ep1_t0.3_test_time 0.11360836029052734
gc 0
Train Epoch2 Acc 0.056875 (6825/120000), AUC 0.3960188031196594
ep2_train_time 5.796628475189209
Test Epoch2 threshold 0.3 Acc 0.9157894736842105, AUC 0.9802410006523132, avg_entr 0.025812458246946335
ep2_t0.3_test_time 0.11429047584533691
gc 0
Train Epoch3 Acc 0.07785 (9342/120000), AUC 0.44718608260154724
ep3_train_time 5.621769189834595
Test Epoch3 threshold 0.3 Acc 0.9138157894736842, AUC 0.9798797965049744, avg_entr 0.02487671561539173
ep3_t0.3_test_time 0.1099555492401123
gc 0
Train Epoch4 Acc 0.12718333333333334 (15262/120000), AUC 0.46731433272361755
ep4_train_time 5.523794174194336
Test Epoch4 threshold 0.3 Acc 0.9125, AUC 0.9802188277244568, avg_entr 0.024858351796865463
ep4_t0.3_test_time 0.10876226425170898
gc 0
Train Epoch5 Acc 0.18120833333333333 (21745/120000), AUC 0.47518327832221985
ep5_train_time 5.550267457962036
Test Epoch5 threshold 0.3 Acc 0.912828947368421, AUC 0.9796969890594482, avg_entr 0.024595558643341064
ep5_t0.3_test_time 0.10916471481323242
gc 0
Train Epoch6 Acc 0.21285833333333334 (25543/120000), AUC 0.47943928837776184
ep6_train_time 5.51297402381897
Test Epoch6 threshold 0.3 Acc 0.9118421052631579, AUC 0.9794161915779114, avg_entr 0.02481016330420971
ep6_t0.3_test_time 0.10740900039672852
gc 0
Train Epoch7 Acc 0.239125 (28695/120000), AUC 0.482987642288208
ep7_train_time 5.54369592666626
Test Epoch7 threshold 0.3 Acc 0.9111842105263158, AUC 0.9793346524238586, avg_entr 0.025069309398531914
ep7_t0.3_test_time 0.10877585411071777
gc 0
Train Epoch8 Acc 0.25648333333333334 (30778/120000), AUC 0.4865284562110901
ep8_train_time 5.544126033782959
Test Epoch8 threshold 0.3 Acc 0.9123355263157895, AUC 0.9793030023574829, avg_entr 0.02395961619913578
ep8_t0.3_test_time 0.10892128944396973
gc 0
Train Epoch9 Acc 0.26538333333333336 (31846/120000), AUC 0.48899418115615845
ep9_train_time 5.470718860626221
Test Epoch9 threshold 0.3 Acc 0.9106907894736842, AUC 0.9790908098220825, avg_entr 0.02518344111740589
ep9_t0.3_test_time 0.10865020751953125
Best AUC 0.9806836843490601
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.3_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9217105263157894, AUC 0.9865070581436157, avg_entr 0.025520281866192818
t0.3_test_time 0.028475046157836914
