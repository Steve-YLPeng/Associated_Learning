total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad25_t0.8_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.29144166666666665 (34973/120000), AUC 0.4898815155029297
ep0_train_time 14.372809171676636
Test Epoch0 threshold 0.8 Acc 0.9144736842105263, AUC 0.9811175465583801, avg_entr 0.02547428198158741
ep0_t0.8_test_time 0.07341861724853516
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad25_t0.8_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.35489166666666666 (42587/120000), AUC 0.5140976309776306
ep1_train_time 14.212568759918213
Test Epoch1 threshold 0.8 Acc 0.9113486842105263, AUC 0.9808609485626221, avg_entr 0.02557508274912834
ep1_t0.8_test_time 0.07316732406616211
gc 0
Train Epoch2 Acc 0.39184166666666664 (47021/120000), AUC 0.5135589838027954
ep2_train_time 13.893630981445312
Test Epoch2 threshold 0.8 Acc 0.9121710526315789, AUC 0.9804926514625549, avg_entr 0.02554093487560749
ep2_t0.8_test_time 0.07154440879821777
gc 0
Train Epoch3 Acc 0.42145 (50574/120000), AUC 0.5202713012695312
ep3_train_time 14.651259899139404
Test Epoch3 threshold 0.8 Acc 0.9120065789473685, AUC 0.9804200530052185, avg_entr 0.025198929011821747
ep3_t0.8_test_time 0.07171845436096191
gc 0
Train Epoch4 Acc 0.43625833333333336 (52351/120000), AUC 0.5210480690002441
ep4_train_time 14.458282232284546
Test Epoch4 threshold 0.8 Acc 0.9120065789473685, AUC 0.9798242449760437, avg_entr 0.024655528366565704
ep4_t0.8_test_time 0.07119512557983398
gc 0
Train Epoch5 Acc 0.43488333333333334 (52186/120000), AUC 0.5237924456596375
ep5_train_time 14.27510404586792
Test Epoch5 threshold 0.8 Acc 0.9125, AUC 0.9796774387359619, avg_entr 0.02495736815035343
ep5_t0.8_test_time 0.07352876663208008
gc 0
Train Epoch6 Acc 0.4376833333333333 (52522/120000), AUC 0.5259236693382263
ep6_train_time 14.181598901748657
Test Epoch6 threshold 0.8 Acc 0.9098684210526315, AUC 0.9794079661369324, avg_entr 0.025633852928876877
ep6_t0.8_test_time 0.07237529754638672
gc 0
Train Epoch7 Acc 0.42783333333333334 (51340/120000), AUC 0.5229635238647461
ep7_train_time 14.488959789276123
Test Epoch7 threshold 0.8 Acc 0.9113486842105263, AUC 0.9792614579200745, avg_entr 0.025762513279914856
ep7_t0.8_test_time 0.0712895393371582
gc 0
Train Epoch8 Acc 0.42961666666666665 (51554/120000), AUC 0.526684045791626
ep8_train_time 14.080124855041504
Test Epoch8 threshold 0.8 Acc 0.9092105263157895, AUC 0.9789663553237915, avg_entr 0.025551963597536087
ep8_t0.8_test_time 0.0725257396697998
gc 0
Train Epoch9 Acc 0.428475 (51417/120000), AUC 0.5262438654899597
ep9_train_time 14.35289192199707
Test Epoch9 threshold 0.8 Acc 0.9108552631578948, AUC 0.9788714051246643, avg_entr 0.025823287665843964
ep9_t0.8_test_time 0.07535123825073242
Best AUC 0.9811175465583801
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad25_t0.8_m3//ag_news_lstmal_l5_prefix.pt
Test threshold 0.8 Acc 0.9230263157894737, AUC 0.9855641722679138, avg_entr 0.027161242440342903
t0.8_test_time 0.01955890655517578
