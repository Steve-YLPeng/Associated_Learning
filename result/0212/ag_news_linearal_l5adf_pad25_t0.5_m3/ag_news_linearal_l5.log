total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.5_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.3194166666666667 (38330/120000), AUC 0.47714322805404663
ep0_train_time 5.315905570983887
Test Epoch0 threshold 0.5 Acc 0.9141447368421053, AUC 0.9803875684738159, avg_entr 0.02510087564587593
ep0_t0.5_test_time 0.07541131973266602
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.5_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.27769166666666667 (33323/120000), AUC 0.5207696557044983
ep1_train_time 4.939991474151611
Test Epoch1 threshold 0.5 Acc 0.9115131578947369, AUC 0.9801682233810425, avg_entr 0.0252773966640234
ep1_t0.5_test_time 0.07279753684997559
gc 0
Train Epoch2 Acc 0.2634166666666667 (31610/120000), AUC 0.5558781027793884
ep2_train_time 4.870977401733398
Test Epoch2 threshold 0.5 Acc 0.9110197368421052, AUC 0.9798365831375122, avg_entr 0.02583272010087967
ep2_t0.5_test_time 0.07144737243652344
gc 0
Train Epoch3 Acc 0.25606666666666666 (30728/120000), AUC 0.5518712997436523
ep3_train_time 4.906773805618286
Test Epoch3 threshold 0.5 Acc 0.9106907894736842, AUC 0.9799888134002686, avg_entr 0.0249116700142622
ep3_t0.5_test_time 0.07245874404907227
gc 0
Train Epoch4 Acc 0.2489 (29868/120000), AUC 0.5420685410499573
ep4_train_time 4.860152959823608
Test Epoch4 threshold 0.5 Acc 0.912828947368421, AUC 0.9794317483901978, avg_entr 0.024802979081869125
ep4_t0.5_test_time 0.07174348831176758
gc 0
Train Epoch5 Acc 0.24044166666666666 (28853/120000), AUC 0.5355708599090576
ep5_train_time 4.8729164600372314
Test Epoch5 threshold 0.5 Acc 0.9121710526315789, AUC 0.9792467355728149, avg_entr 0.02527579292654991
ep5_t0.5_test_time 0.0718526840209961
gc 0
Train Epoch6 Acc 0.23085 (27702/120000), AUC 0.5316101312637329
ep6_train_time 4.893512725830078
Test Epoch6 threshold 0.5 Acc 0.9105263157894737, AUC 0.9791676998138428, avg_entr 0.025427093729376793
ep6_t0.5_test_time 0.07182765007019043
gc 0
Train Epoch7 Acc 0.207475 (24897/120000), AUC 0.5284925699234009
ep7_train_time 4.907367467880249
Test Epoch7 threshold 0.5 Acc 0.9101973684210526, AUC 0.9790334701538086, avg_entr 0.025663701817393303
ep7_t0.5_test_time 0.07251501083374023
gc 0
Train Epoch8 Acc 0.16150833333333334 (19381/120000), AUC 0.5258691906929016
ep8_train_time 4.988567113876343
Test Epoch8 threshold 0.5 Acc 0.9100328947368421, AUC 0.9787991642951965, avg_entr 0.02508760802447796
ep8_t0.5_test_time 0.07405424118041992
gc 0
Train Epoch9 Acc 0.12510833333333332 (15013/120000), AUC 0.5259018540382385
ep9_train_time 5.264534950256348
Test Epoch9 threshold 0.5 Acc 0.9105263157894737, AUC 0.9786636829376221, avg_entr 0.025638559833168983
ep9_t0.5_test_time 0.07339358329772949
Best AUC 0.9803875684738159
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.5_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9210526315789473, AUC 0.9852318167686462, avg_entr 0.02750491164624691
t0.5_test_time 0.01958322525024414
