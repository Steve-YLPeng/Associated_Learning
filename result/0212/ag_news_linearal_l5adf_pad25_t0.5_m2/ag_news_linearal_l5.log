total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.5_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.357175 (42861/120000), AUC 0.5811572074890137
ep0_train_time 5.0716941356658936
Test Epoch0 threshold 0.5 Acc 0.9133223684210526, AUC 0.9807059168815613, avg_entr 0.03395262360572815
ep0_t0.5_test_time 0.07682275772094727
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.37895833333333334 (45475/120000), AUC 0.5728880167007446
ep1_train_time 4.365432262420654
Test Epoch1 threshold 0.5 Acc 0.9123355263157895, AUC 0.9807548522949219, avg_entr 0.030374843627214432
ep1_t0.5_test_time 0.07350611686706543
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.378 (45360/120000), AUC 0.573286771774292
ep2_train_time 4.414604425430298
Test Epoch2 threshold 0.5 Acc 0.9148026315789474, AUC 0.98050856590271, avg_entr 0.02794158086180687
ep2_t0.5_test_time 0.07271814346313477
gc 0
Train Epoch3 Acc 0.37693333333333334 (45232/120000), AUC 0.569353461265564
ep3_train_time 4.379790306091309
Test Epoch3 threshold 0.5 Acc 0.9126644736842106, AUC 0.9803195595741272, avg_entr 0.02757813036441803
ep3_t0.5_test_time 0.07374238967895508
gc 0
Train Epoch4 Acc 0.37528333333333336 (45034/120000), AUC 0.5639914870262146
ep4_train_time 4.369876861572266
Test Epoch4 threshold 0.5 Acc 0.9103618421052632, AUC 0.979794979095459, avg_entr 0.026414168998599052
ep4_t0.5_test_time 0.0730443000793457
gc 0
Train Epoch5 Acc 0.37269166666666664 (44723/120000), AUC 0.5600016117095947
ep5_train_time 4.4057488441467285
Test Epoch5 threshold 0.5 Acc 0.9123355263157895, AUC 0.9794632196426392, avg_entr 0.026598041877150536
ep5_t0.5_test_time 0.07344698905944824
gc 0
Train Epoch6 Acc 0.36830833333333335 (44197/120000), AUC 0.556634783744812
ep6_train_time 4.414248943328857
Test Epoch6 threshold 0.5 Acc 0.9113486842105263, AUC 0.9793371558189392, avg_entr 0.026350362226366997
ep6_t0.5_test_time 0.0728311538696289
gc 0
Train Epoch7 Acc 0.36449166666666666 (43739/120000), AUC 0.5537083148956299
ep7_train_time 4.40756630897522
Test Epoch7 threshold 0.5 Acc 0.9100328947368421, AUC 0.9791184067726135, avg_entr 0.026667529717087746
ep7_t0.5_test_time 0.07285714149475098
gc 0
Train Epoch8 Acc 0.36034166666666667 (43241/120000), AUC 0.5506864786148071
ep8_train_time 4.402289152145386
Test Epoch8 threshold 0.5 Acc 0.9106907894736842, AUC 0.9791480302810669, avg_entr 0.026294996961951256
ep8_t0.5_test_time 0.07284116744995117
gc 0
Train Epoch9 Acc 0.3572 (42864/120000), AUC 0.5486071109771729
ep9_train_time 4.344156265258789
Test Epoch9 threshold 0.5 Acc 0.9103618421052632, AUC 0.9788505434989929, avg_entr 0.026340767741203308
ep9_t0.5_test_time 0.07214570045471191
Best AUC 0.9807548522949219
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.5_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9210526315789473, AUC 0.985425591468811, avg_entr 0.033100541681051254
t0.5_test_time 0.019542694091796875
