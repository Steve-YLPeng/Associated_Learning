total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.6_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.04156666666666667 (4988/120000), AUC 0.2419929951429367
ep0_train_time 6.6128644943237305
Test Epoch0 threshold 0.6 Acc 0.9129934210526316, AUC 0.9800010919570923, avg_entr 0.026712896302342415
ep0_t0.6_test_time 0.10413026809692383
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.6_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.028175 (3381/120000), AUC 0.30643466114997864
ep1_train_time 6.298875093460083
Test Epoch1 threshold 0.6 Acc 0.9125, AUC 0.9797417521476746, avg_entr 0.026702741160988808
ep1_t0.6_test_time 0.10158705711364746
gc 0
Train Epoch2 Acc 0.027375 (3285/120000), AUC 0.35388845205307007
ep2_train_time 6.221989393234253
Test Epoch2 threshold 0.6 Acc 0.9138157894736842, AUC 0.9795819520950317, avg_entr 0.02531241811811924
ep2_t0.6_test_time 0.10208463668823242
gc 0
Train Epoch3 Acc 0.027433333333333334 (3292/120000), AUC 0.43672245740890503
ep3_train_time 6.202242136001587
Test Epoch3 threshold 0.6 Acc 0.9103618421052632, AUC 0.9793680310249329, avg_entr 0.026235658675432205
ep3_t0.6_test_time 0.10515713691711426
gc 0
Train Epoch4 Acc 0.034208333333333334 (4105/120000), AUC 0.5144165754318237
ep4_train_time 6.449190378189087
Test Epoch4 threshold 0.6 Acc 0.909375, AUC 0.9792359471321106, avg_entr 0.025956932455301285
ep4_t0.6_test_time 0.10366582870483398
gc 0
Train Epoch5 Acc 0.04133333333333333 (4960/120000), AUC 0.5258307456970215
ep5_train_time 6.297065496444702
Test Epoch5 threshold 0.6 Acc 0.9101973684210526, AUC 0.9788740873336792, avg_entr 0.026480624452233315
ep5_t0.6_test_time 0.10288596153259277
gc 0
Train Epoch6 Acc 0.045316666666666665 (5438/120000), AUC 0.5263505578041077
ep6_train_time 6.228755950927734
Test Epoch6 threshold 0.6 Acc 0.909375, AUC 0.9789008498191833, avg_entr 0.026286311447620392
ep6_t0.6_test_time 0.10318684577941895
gc 0
Train Epoch7 Acc 0.04969166666666667 (5963/120000), AUC 0.5245829820632935
ep7_train_time 6.327316045761108
Test Epoch7 threshold 0.6 Acc 0.9097039473684211, AUC 0.9788485169410706, avg_entr 0.025639452040195465
ep7_t0.6_test_time 0.10283851623535156
gc 0
Train Epoch8 Acc 0.05503333333333333 (6604/120000), AUC 0.5209931135177612
ep8_train_time 6.294665813446045
Test Epoch8 threshold 0.6 Acc 0.9090460526315789, AUC 0.9786959290504456, avg_entr 0.026242703199386597
ep8_t0.6_test_time 0.10325098037719727
gc 0
Train Epoch9 Acc 0.05828333333333333 (6994/120000), AUC 0.517114520072937
ep9_train_time 6.375218629837036
Test Epoch9 threshold 0.6 Acc 0.9070723684210527, AUC 0.9785295724868774, avg_entr 0.02647293731570244
ep9_t0.6_test_time 0.10385417938232422
Best AUC 0.9800010919570923
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.6_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9243421052631579, AUC 0.9858081340789795, avg_entr 0.025968460366129875
t0.6_test_time 0.02762913703918457
