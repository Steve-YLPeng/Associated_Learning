total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.5_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9130083333333333 (109561/120000), AUC 0.9840621948242188
ep0_train_time 7.258977174758911
Test Epoch0 threshold 0.5 Acc 0.9131578947368421, AUC 0.9796426296234131, avg_entr 0.025295523926615715
ep0_t0.5_test_time 0.10491180419921875
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.5_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.951225 (114147/120000), AUC 0.9936727285385132
ep1_train_time 6.831323862075806
Test Epoch1 threshold 0.5 Acc 0.9123355263157895, AUC 0.9793863296508789, avg_entr 0.025560865178704262
ep1_t0.5_test_time 0.10327506065368652
gc 0
Train Epoch2 Acc 0.9528833333333333 (114346/120000), AUC 0.993680477142334
ep2_train_time 6.778012037277222
Test Epoch2 threshold 0.5 Acc 0.9113486842105263, AUC 0.9796394109725952, avg_entr 0.026340967044234276
ep2_t0.5_test_time 0.10293865203857422
gc 0
Train Epoch3 Acc 0.9539166666666666 (114470/120000), AUC 0.9936648011207581
ep3_train_time 6.799966096878052
Test Epoch3 threshold 0.5 Acc 0.9116776315789473, AUC 0.9794425964355469, avg_entr 0.02606162242591381
ep3_t0.5_test_time 0.1034703254699707
gc 0
Train Epoch4 Acc 0.9547333333333333 (114568/120000), AUC 0.9940863251686096
ep4_train_time 6.8073015213012695
Test Epoch4 threshold 0.5 Acc 0.909375, AUC 0.9791852235794067, avg_entr 0.025532113388180733
ep4_t0.5_test_time 0.10218024253845215
gc 0
Train Epoch5 Acc 0.9571333333333333 (114856/120000), AUC 0.9948297739028931
ep5_train_time 6.778622388839722
Test Epoch5 threshold 0.5 Acc 0.9111842105263158, AUC 0.9790919423103333, avg_entr 0.02561447210609913
ep5_t0.5_test_time 0.10294389724731445
gc 0
Train Epoch6 Acc 0.9575666666666667 (114908/120000), AUC 0.9949798583984375
ep6_train_time 6.777986764907837
Test Epoch6 threshold 0.5 Acc 0.9103618421052632, AUC 0.9791232347488403, avg_entr 0.026079917326569557
ep6_t0.5_test_time 0.10201668739318848
gc 0
Train Epoch7 Acc 0.9580666666666666 (114968/120000), AUC 0.9950829744338989
ep7_train_time 6.807996988296509
Test Epoch7 threshold 0.5 Acc 0.9090460526315789, AUC 0.9788743257522583, avg_entr 0.026105770841240883
ep7_t0.5_test_time 0.10173797607421875
gc 0
Train Epoch8 Acc 0.9586833333333333 (115042/120000), AUC 0.9952897429466248
ep8_train_time 6.858035326004028
Test Epoch8 threshold 0.5 Acc 0.9088815789473684, AUC 0.9787185788154602, avg_entr 0.025805406272411346
ep8_t0.5_test_time 0.1026608943939209
gc 0
Train Epoch9 Acc 0.9597916666666667 (115175/120000), AUC 0.9956762194633484
ep9_train_time 6.794391632080078
Test Epoch9 threshold 0.5 Acc 0.9087171052631579, AUC 0.9784636497497559, avg_entr 0.02612222172319889
ep9_t0.5_test_time 0.10205268859863281
Best AUC 0.9796426296234131
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.5_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9210526315789473, AUC 0.9856635332107544, avg_entr 0.02622145600616932
t0.5_test_time 0.026224136352539062
