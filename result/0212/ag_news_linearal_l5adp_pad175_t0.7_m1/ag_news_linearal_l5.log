total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2498 (29976/120000), AUC 0.4851224720478058
ep0_train_time 8.754983186721802
Test Epoch0 threshold 0.7 Acc 0.8985197368421053, AUC 0.9741711616516113, avg_entr 0.18514597415924072
ep0_t0.7_test_time 0.26612138748168945
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.249775 (29973/120000), AUC 0.4457945227622986
ep1_train_time 7.9618425369262695
Test Epoch1 threshold 0.7 Acc 0.9118421052631579, AUC 0.9779460430145264, avg_entr 0.10476953536272049
ep1_t0.7_test_time 0.25054097175598145
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24985833333333332 (29983/120000), AUC 0.43231672048568726
ep2_train_time 8.196963548660278
Test Epoch2 threshold 0.7 Acc 0.9143092105263158, AUC 0.9794737696647644, avg_entr 0.07937121391296387
ep2_t0.7_test_time 0.25180983543395996
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.249875 (29985/120000), AUC 0.4271094799041748
ep3_train_time 8.046523571014404
Test Epoch3 threshold 0.7 Acc 0.9154605263157894, AUC 0.9803690910339355, avg_entr 0.06612501293420792
ep3_t0.7_test_time 0.2507638931274414
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24986666666666665 (29984/120000), AUC 0.4253960847854614
ep4_train_time 8.098441362380981
Test Epoch4 threshold 0.7 Acc 0.9175986842105263, AUC 0.9805637001991272, avg_entr 0.05836730822920799
ep4_t0.7_test_time 0.2517693042755127
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24985833333333332 (29983/120000), AUC 0.4238530099391937
ep5_train_time 8.254499197006226
Test Epoch5 threshold 0.7 Acc 0.9166118421052631, AUC 0.9807480573654175, avg_entr 0.05251728743314743
ep5_t0.7_test_time 0.25092220306396484
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.249825 (29979/120000), AUC 0.4234169125556946
ep6_train_time 7.882805109024048
Test Epoch6 threshold 0.7 Acc 0.9159539473684211, AUC 0.980981707572937, avg_entr 0.04845742508769035
ep6_t0.7_test_time 0.25143980979919434
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.2498 (29976/120000), AUC 0.4234156608581543
ep7_train_time 8.159101486206055
Test Epoch7 threshold 0.7 Acc 0.9161184210526315, AUC 0.9806620478630066, avg_entr 0.04682980105280876
ep7_t0.7_test_time 0.2510709762573242
gc 0
Train Epoch8 Acc 0.24979166666666666 (29975/120000), AUC 0.42402517795562744
ep8_train_time 8.307733535766602
Test Epoch8 threshold 0.7 Acc 0.9175986842105263, AUC 0.9806318283081055, avg_entr 0.04309523105621338
ep8_t0.7_test_time 0.2526974678039551
gc 0
Train Epoch9 Acc 0.24976666666666666 (29972/120000), AUC 0.4243238568305969
ep9_train_time 8.181979417800903
Test Epoch9 threshold 0.7 Acc 0.9166118421052631, AUC 0.9803764820098877, avg_entr 0.04017088562250137
ep9_t0.7_test_time 0.25175929069519043
Best AUC 0.980981707572937
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9210526315789473, AUC 0.9864814281463623, avg_entr 0.04976809769868851
t0.7_test_time 0.06365680694580078
