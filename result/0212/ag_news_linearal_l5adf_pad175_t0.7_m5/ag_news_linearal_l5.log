total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9311083333333333 (111733/120000), AUC 0.9873260259628296
ep0_train_time 10.351913928985596
Test Epoch0 threshold 0.7 Acc 0.9157894736842105, AUC 0.980573296546936, avg_entr 0.025963835418224335
ep0_t0.7_test_time 0.2532997131347656
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9496416666666667 (113957/120000), AUC 0.9930153489112854
ep1_train_time 9.930197477340698
Test Epoch1 threshold 0.7 Acc 0.9166118421052631, AUC 0.9804770946502686, avg_entr 0.026616480201482773
ep1_t0.7_test_time 0.2524285316467285
gc 0
Train Epoch2 Acc 0.9509083333333334 (114109/120000), AUC 0.9932593107223511
ep2_train_time 9.956345558166504
Test Epoch2 threshold 0.7 Acc 0.9148026315789474, AUC 0.9803150296211243, avg_entr 0.026328423991799355
ep2_t0.7_test_time 0.25273680686950684
gc 0
Train Epoch3 Acc 0.9524333333333334 (114292/120000), AUC 0.9933019876480103
ep3_train_time 9.919252395629883
Test Epoch3 threshold 0.7 Acc 0.9141447368421053, AUC 0.9802611470222473, avg_entr 0.024780122563242912
ep3_t0.7_test_time 0.2526884078979492
gc 0
Train Epoch4 Acc 0.9528333333333333 (114340/120000), AUC 0.993732750415802
ep4_train_time 10.006875276565552
Test Epoch4 threshold 0.7 Acc 0.9123355263157895, AUC 0.9802358746528625, avg_entr 0.02658184990286827
ep4_t0.7_test_time 0.2591276168823242
gc 0
Train Epoch5 Acc 0.9547916666666667 (114575/120000), AUC 0.9945285320281982
ep5_train_time 10.196385622024536
Test Epoch5 threshold 0.7 Acc 0.9148026315789474, AUC 0.9799780249595642, avg_entr 0.026240183040499687
ep5_t0.7_test_time 0.25299501419067383
gc 0
Train Epoch6 Acc 0.9554083333333333 (114649/120000), AUC 0.9946599006652832
ep6_train_time 9.901759147644043
Test Epoch6 threshold 0.7 Acc 0.9141447368421053, AUC 0.9798923134803772, avg_entr 0.026362642645835876
ep6_t0.7_test_time 0.252671480178833
gc 0
Train Epoch7 Acc 0.9558416666666667 (114701/120000), AUC 0.9946929812431335
ep7_train_time 10.031517028808594
Test Epoch7 threshold 0.7 Acc 0.9126644736842106, AUC 0.9797289967536926, avg_entr 0.02576368674635887
ep7_t0.7_test_time 0.25289154052734375
gc 0
Train Epoch8 Acc 0.9562333333333334 (114748/120000), AUC 0.9949361085891724
ep8_train_time 10.019529819488525
Test Epoch8 threshold 0.7 Acc 0.9125, AUC 0.9795963764190674, avg_entr 0.024419760331511497
ep8_t0.7_test_time 0.2522439956665039
gc 0
Train Epoch9 Acc 0.9569916666666667 (114839/120000), AUC 0.9951744079589844
ep9_train_time 9.976654767990112
Test Epoch9 threshold 0.7 Acc 0.9120065789473685, AUC 0.979576826095581, avg_entr 0.026161404326558113
ep9_t0.7_test_time 0.25249338150024414
Best AUC 0.980573296546936
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9269736842105263, AUC 0.9862299561500549, avg_entr 0.024972837418317795
t0.7_test_time 0.0642709732055664
