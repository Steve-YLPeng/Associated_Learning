total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9338583333333333 (112063/120000), AUC 0.986457347869873
ep0_train_time 88.28385543823242
Test Epoch0 threshold 0.3 Acc 0.915625, AUC 0.9799132347106934, avg_entr 0.023844894021749496
ep0_t0.3_test_time 0.3556966781616211
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9579 (114948/120000), AUC 0.9935196042060852
ep1_train_time 88.49369502067566
Test Epoch1 threshold 0.3 Acc 0.9143092105263158, AUC 0.9797605276107788, avg_entr 0.023113274946808815
ep1_t0.3_test_time 0.33888959884643555
gc 0
Train Epoch2 Acc 0.9604416666666666 (115253/120000), AUC 0.9940311908721924
ep2_train_time 88.33607959747314
Test Epoch2 threshold 0.3 Acc 0.9148026315789474, AUC 0.9799085259437561, avg_entr 0.023590780794620514
ep2_t0.3_test_time 0.35674524307250977
gc 0
Train Epoch3 Acc 0.9627166666666667 (115526/120000), AUC 0.9945528507232666
ep3_train_time 88.30217123031616
Test Epoch3 threshold 0.3 Acc 0.9129934210526316, AUC 0.9798749685287476, avg_entr 0.024108480662107468
ep3_t0.3_test_time 0.35058069229125977
gc 0
Train Epoch4 Acc 0.9649333333333333 (115792/120000), AUC 0.9949091672897339
ep4_train_time 88.4092218875885
Test Epoch4 threshold 0.3 Acc 0.9129934210526316, AUC 0.9796311855316162, avg_entr 0.02392633818089962
ep4_t0.3_test_time 0.3463170528411865
gc 0
Train Epoch5 Acc 0.9681916666666667 (116183/120000), AUC 0.9954419136047363
ep5_train_time 88.38800430297852
Test Epoch5 threshold 0.3 Acc 0.9144736842105263, AUC 0.979479968547821, avg_entr 0.024029452353715897
ep5_t0.3_test_time 0.3381059169769287
gc 0
Train Epoch6 Acc 0.9694083333333333 (116329/120000), AUC 0.9955772161483765
ep6_train_time 88.32212543487549
Test Epoch6 threshold 0.3 Acc 0.9141447368421053, AUC 0.9793360829353333, avg_entr 0.02312590181827545
ep6_t0.3_test_time 0.3301568031311035
gc 0
Train Epoch7 Acc 0.9702083333333333 (116425/120000), AUC 0.9957447052001953
ep7_train_time 88.46551585197449
Test Epoch7 threshold 0.3 Acc 0.9131578947368421, AUC 0.979254961013794, avg_entr 0.023452874273061752
ep7_t0.3_test_time 0.3344755172729492
gc 0
Train Epoch8 Acc 0.9714083333333333 (116569/120000), AUC 0.9956866502761841
ep8_train_time 88.24045062065125
Test Epoch8 threshold 0.3 Acc 0.9129934210526316, AUC 0.9791263937950134, avg_entr 0.02363838441669941
ep8_t0.3_test_time 0.3129615783691406
gc 0
Train Epoch9 Acc 0.9731583333333333 (116779/120000), AUC 0.9961073994636536
ep9_train_time 88.22917890548706
Test Epoch9 threshold 0.3 Acc 0.9125, AUC 0.9791780710220337, avg_entr 0.023680593818426132
ep9_t0.3_test_time 0.31231212615966797
Best AUC 0.9799132347106934
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad175_t0.3_m5//ag_news_lstmal_l5_prefix.pt
Test threshold 0.3 Acc 0.9276315789473685, AUC 0.9858075380325317, avg_entr 0.022576240822672844
t0.3_test_time 0.10375690460205078
