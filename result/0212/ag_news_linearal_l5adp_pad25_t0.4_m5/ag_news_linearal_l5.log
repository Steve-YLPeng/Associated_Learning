total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.4_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.932925 (111951/120000), AUC 0.9875462055206299
ep0_train_time 6.319558620452881
Test Epoch0 threshold 0.4 Acc 0.9116776315789473, AUC 0.9797324538230896, avg_entr 0.024364709854125977
ep0_t0.4_test_time 0.08043813705444336
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.4_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.951725 (114207/120000), AUC 0.9936702847480774
ep1_train_time 5.900051593780518
Test Epoch1 threshold 0.4 Acc 0.9108552631578948, AUC 0.9795730113983154, avg_entr 0.025104455649852753
ep1_t0.4_test_time 0.07975316047668457
gc 0
Train Epoch2 Acc 0.9532666666666667 (114392/120000), AUC 0.9936635494232178
ep2_train_time 5.916540622711182
Test Epoch2 threshold 0.4 Acc 0.9106907894736842, AUC 0.9795125722885132, avg_entr 0.025209100916981697
ep2_t0.4_test_time 0.0776979923248291
gc 0
Train Epoch3 Acc 0.9538583333333334 (114463/120000), AUC 0.9939285516738892
ep3_train_time 5.907742977142334
Test Epoch3 threshold 0.4 Acc 0.9092105263157895, AUC 0.9793227314949036, avg_entr 0.02518988400697708
ep3_t0.4_test_time 0.07757782936096191
gc 0
Train Epoch4 Acc 0.9546916666666667 (114563/120000), AUC 0.9941824674606323
ep4_train_time 5.8614349365234375
Test Epoch4 threshold 0.4 Acc 0.9100328947368421, AUC 0.9790780544281006, avg_entr 0.024884773418307304
ep4_t0.4_test_time 0.07870960235595703
gc 0
Train Epoch5 Acc 0.9569833333333333 (114838/120000), AUC 0.9950510859489441
ep5_train_time 6.14008355140686
Test Epoch5 threshold 0.4 Acc 0.9092105263157895, AUC 0.979003369808197, avg_entr 0.024837354198098183
ep5_t0.4_test_time 0.08090043067932129
gc 0
Train Epoch6 Acc 0.9579333333333333 (114952/120000), AUC 0.9951093196868896
ep6_train_time 6.348534107208252
Test Epoch6 threshold 0.4 Acc 0.909375, AUC 0.9787922501564026, avg_entr 0.024601705372333527
ep6_t0.4_test_time 0.08439111709594727
gc 0
Train Epoch7 Acc 0.9582166666666667 (114986/120000), AUC 0.9952943325042725
ep7_train_time 6.189070701599121
Test Epoch7 threshold 0.4 Acc 0.9090460526315789, AUC 0.9784128665924072, avg_entr 0.024916231632232666
ep7_t0.4_test_time 0.07667112350463867
gc 0
Train Epoch8 Acc 0.9586083333333333 (115033/120000), AUC 0.9952854514122009
ep8_train_time 5.8936240673065186
Test Epoch8 threshold 0.4 Acc 0.9090460526315789, AUC 0.9785057902336121, avg_entr 0.02443980984389782
ep8_t0.4_test_time 0.07769060134887695
gc 0
Train Epoch9 Acc 0.95985 (115182/120000), AUC 0.9957625865936279
ep9_train_time 5.896324634552002
Test Epoch9 threshold 0.4 Acc 0.9083881578947368, AUC 0.9782106280326843, avg_entr 0.024819647893309593
ep9_t0.4_test_time 0.07828640937805176
Best AUC 0.9797324538230896
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.4_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9197368421052632, AUC 0.9848973155021667, avg_entr 0.025498291477560997
t0.4_test_time 0.02088475227355957
