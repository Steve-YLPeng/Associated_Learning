total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.7_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.08293333333333333 (9952/120000), AUC 0.34201785922050476
ep0_train_time 6.699389934539795
Test Epoch0 threshold 0.7 Acc 0.9166118421052631, AUC 0.9806851744651794, avg_entr 0.02669898048043251
ep0_t0.7_test_time 0.14246368408203125
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.7_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.145775 (17493/120000), AUC 0.3596561551094055
ep1_train_time 6.2610085010528564
Test Epoch1 threshold 0.7 Acc 0.915625, AUC 0.9805626273155212, avg_entr 0.025747889652848244
ep1_t0.7_test_time 0.13249897956848145
gc 0
Train Epoch2 Acc 0.20275833333333335 (24331/120000), AUC 0.3556164503097534
ep2_train_time 6.269002437591553
Test Epoch2 threshold 0.7 Acc 0.9148026315789474, AUC 0.980252742767334, avg_entr 0.0262101199477911
ep2_t0.7_test_time 0.13240623474121094
gc 0
Train Epoch3 Acc 0.21914166666666668 (26297/120000), AUC 0.3631478548049927
ep3_train_time 6.261770963668823
Test Epoch3 threshold 0.7 Acc 0.9129934210526316, AUC 0.9801198244094849, avg_entr 0.0264633446931839
ep3_t0.7_test_time 0.1311037540435791
gc 0
Train Epoch4 Acc 0.229775 (27573/120000), AUC 0.37296998500823975
ep4_train_time 6.25550651550293
Test Epoch4 threshold 0.7 Acc 0.9097039473684211, AUC 0.9798149466514587, avg_entr 0.027351344004273415
ep4_t0.7_test_time 0.1320950984954834
gc 0
Train Epoch5 Acc 0.23345833333333332 (28015/120000), AUC 0.3668610155582428
ep5_train_time 6.251734972000122
Test Epoch5 threshold 0.7 Acc 0.9111842105263158, AUC 0.979726254940033, avg_entr 0.026187919080257416
ep5_t0.7_test_time 0.1314399242401123
gc 0
Train Epoch6 Acc 0.23343333333333333 (28012/120000), AUC 0.3606880009174347
ep6_train_time 6.287546634674072
Test Epoch6 threshold 0.7 Acc 0.9108552631578948, AUC 0.9795274138450623, avg_entr 0.027473963797092438
ep6_t0.7_test_time 0.1325385570526123
gc 0
Train Epoch7 Acc 0.23224166666666668 (27869/120000), AUC 0.3580687344074249
ep7_train_time 6.73886775970459
Test Epoch7 threshold 0.7 Acc 0.9105263157894737, AUC 0.9791780710220337, avg_entr 0.02692224644124508
ep7_t0.7_test_time 0.13717293739318848
gc 0
Train Epoch8 Acc 0.22680833333333333 (27217/120000), AUC 0.3593883216381073
ep8_train_time 6.785122632980347
Test Epoch8 threshold 0.7 Acc 0.9105263157894737, AUC 0.9792199730873108, avg_entr 0.026353372260928154
ep8_t0.7_test_time 0.1367335319519043
gc 0
Train Epoch9 Acc 0.21476666666666666 (25772/120000), AUC 0.3637933135032654
ep9_train_time 6.4520790576934814
Test Epoch9 threshold 0.7 Acc 0.9103618421052632, AUC 0.979159414768219, avg_entr 0.026456141844391823
ep9_t0.7_test_time 0.13249921798706055
Best AUC 0.9806851744651794
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.7_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9256578947368421, AUC 0.9860876798629761, avg_entr 0.02610909380018711
t0.7_test_time 0.03382277488708496
