total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.5_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.29751666666666665 (35702/120000), AUC 0.6677197217941284
ep0_train_time 6.17622971534729
Test Epoch0 threshold 0.5 Acc 0.9167763157894737, AUC 0.98090660572052, avg_entr 0.03157408535480499
ep0_t0.5_test_time 0.1347959041595459
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.29736666666666667 (35684/120000), AUC 0.7129451036453247
ep1_train_time 5.742915868759155
Test Epoch1 threshold 0.5 Acc 0.915296052631579, AUC 0.9806922674179077, avg_entr 0.028530441224575043
ep1_t0.5_test_time 0.13356971740722656
gc 0
Train Epoch2 Acc 0.2999 (35988/120000), AUC 0.7137449383735657
ep2_train_time 5.744677782058716
Test Epoch2 threshold 0.5 Acc 0.9151315789473684, AUC 0.98045414686203, avg_entr 0.026744941249489784
ep2_t0.5_test_time 0.13346171379089355
gc 0
Train Epoch3 Acc 0.30496666666666666 (36596/120000), AUC 0.714996337890625
ep3_train_time 5.949339389801025
Test Epoch3 threshold 0.5 Acc 0.9146381578947368, AUC 0.980095624923706, avg_entr 0.027460873126983643
ep3_t0.5_test_time 0.13747406005859375
gc 0
Train Epoch4 Acc 0.30670833333333336 (36805/120000), AUC 0.7160426378250122
ep4_train_time 6.107074975967407
Test Epoch4 threshold 0.5 Acc 0.9151315789473684, AUC 0.9800748825073242, avg_entr 0.027001699432730675
ep4_t0.5_test_time 0.13672757148742676
gc 0
Train Epoch5 Acc 0.3138 (37656/120000), AUC 0.716687798500061
ep5_train_time 6.048690557479858
Test Epoch5 threshold 0.5 Acc 0.9141447368421053, AUC 0.9800275564193726, avg_entr 0.027181459590792656
ep5_t0.5_test_time 0.13246798515319824
gc 0
Train Epoch6 Acc 0.31838333333333335 (38206/120000), AUC 0.7167996168136597
ep6_train_time 5.74600887298584
Test Epoch6 threshold 0.5 Acc 0.9141447368421053, AUC 0.9798242449760437, avg_entr 0.02608243003487587
ep6_t0.5_test_time 0.13294577598571777
gc 0
Train Epoch7 Acc 0.324925 (38991/120000), AUC 0.7169428467750549
ep7_train_time 5.7927820682525635
Test Epoch7 threshold 0.5 Acc 0.9134868421052632, AUC 0.9796696305274963, avg_entr 0.026862453669309616
ep7_t0.5_test_time 0.1328270435333252
gc 0
Train Epoch8 Acc 0.33093333333333336 (39712/120000), AUC 0.7168960571289062
ep8_train_time 5.748335123062134
Test Epoch8 threshold 0.5 Acc 0.9120065789473685, AUC 0.9795933961868286, avg_entr 0.02646050974726677
ep8_t0.5_test_time 0.1337292194366455
gc 0
Train Epoch9 Acc 0.336525 (40383/120000), AUC 0.717160701751709
ep9_train_time 5.757575511932373
Test Epoch9 threshold 0.5 Acc 0.9125, AUC 0.9794169664382935, avg_entr 0.026297740638256073
ep9_t0.5_test_time 0.1325078010559082
Best AUC 0.98090660572052
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.5_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9230263157894737, AUC 0.9863989353179932, avg_entr 0.03160709887742996
t0.5_test_time 0.03458547592163086
