total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.3_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.24335 (29202/120000), AUC 0.37824180722236633
ep0_train_time 6.826153755187988
Test Epoch0 threshold 0.3 Acc 0.9157894736842105, AUC 0.9807099103927612, avg_entr 0.025261271744966507
ep0_t0.3_test_time 0.14573121070861816
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.3_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24320833333333333 (29185/120000), AUC 0.39183309674263
ep1_train_time 6.4389097690582275
Test Epoch1 threshold 0.3 Acc 0.9149671052631579, AUC 0.9801351428031921, avg_entr 0.02531449683010578
ep1_t0.3_test_time 0.1437067985534668
gc 0
Train Epoch2 Acc 0.2259 (27108/120000), AUC 0.43821826577186584
ep2_train_time 6.4383227825164795
Test Epoch2 threshold 0.3 Acc 0.9136513157894737, AUC 0.9800548553466797, avg_entr 0.02550148032605648
ep2_t0.3_test_time 0.141373872756958
gc 0
Train Epoch3 Acc 0.18128333333333332 (21754/120000), AUC 0.49507296085357666
ep3_train_time 6.417451620101929
Test Epoch3 threshold 0.3 Acc 0.915625, AUC 0.9799581170082092, avg_entr 0.025689370930194855
ep3_t0.3_test_time 0.14419960975646973
gc 0
Train Epoch4 Acc 0.12175 (14610/120000), AUC 0.5002062320709229
ep4_train_time 6.4062659740448
Test Epoch4 threshold 0.3 Acc 0.9134868421052632, AUC 0.9799395799636841, avg_entr 0.025594431906938553
ep4_t0.3_test_time 0.144028902053833
gc 0
Train Epoch5 Acc 0.0845 (10140/120000), AUC 0.4942598342895508
ep5_train_time 6.484159708023071
Test Epoch5 threshold 0.3 Acc 0.9125, AUC 0.9795433282852173, avg_entr 0.02516135759651661
ep5_t0.3_test_time 0.1412491798400879
gc 0
Train Epoch6 Acc 0.06893333333333333 (8272/120000), AUC 0.5005594491958618
ep6_train_time 6.414124250411987
Test Epoch6 threshold 0.3 Acc 0.9126644736842106, AUC 0.9793663620948792, avg_entr 0.025409257039427757
ep6_t0.3_test_time 0.14188194274902344
gc 0
Train Epoch7 Acc 0.061575 (7389/120000), AUC 0.512492835521698
ep7_train_time 6.381877422332764
Test Epoch7 threshold 0.3 Acc 0.9116776315789473, AUC 0.9793121814727783, avg_entr 0.024921562522649765
ep7_t0.3_test_time 0.1397557258605957
gc 0
Train Epoch8 Acc 0.06304166666666666 (7565/120000), AUC 0.5256981253623962
ep8_train_time 6.4162561893463135
Test Epoch8 threshold 0.3 Acc 0.9090460526315789, AUC 0.9789944291114807, avg_entr 0.02503049746155739
ep8_t0.3_test_time 0.13909196853637695
gc 0
Train Epoch9 Acc 0.06873333333333333 (8248/120000), AUC 0.5337512493133545
ep9_train_time 6.451537609100342
Test Epoch9 threshold 0.3 Acc 0.9105263157894737, AUC 0.9790014028549194, avg_entr 0.025714369490742683
ep9_t0.3_test_time 0.14130949974060059
Best AUC 0.9807099103927612
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.3_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.925, AUC 0.986022412776947, avg_entr 0.025405021384358406
t0.3_test_time 0.03613400459289551
