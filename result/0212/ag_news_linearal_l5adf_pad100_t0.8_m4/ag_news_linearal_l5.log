total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.8_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.04276666666666667 (5132/120000), AUC 0.27532780170440674
ep0_train_time 7.881937503814697
Test Epoch0 threshold 0.8 Acc 0.9159539473684211, AUC 0.9805951118469238, avg_entr 0.02564152702689171
ep0_t0.8_test_time 0.16156339645385742
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.8_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.139025 (16683/120000), AUC 0.36929553747177124
ep1_train_time 7.3836989402771
Test Epoch1 threshold 0.8 Acc 0.9144736842105263, AUC 0.9805833101272583, avg_entr 0.02476956695318222
ep1_t0.8_test_time 0.1607069969177246
gc 0
Train Epoch2 Acc 0.21598333333333333 (25918/120000), AUC 0.44982147216796875
ep2_train_time 7.428618669509888
Test Epoch2 threshold 0.8 Acc 0.9164473684210527, AUC 0.9803093075752258, avg_entr 0.025621328502893448
ep2_t0.8_test_time 0.16167283058166504
gc 0
Train Epoch3 Acc 0.22298333333333334 (26758/120000), AUC 0.4789159595966339
ep3_train_time 7.322078704833984
Test Epoch3 threshold 0.8 Acc 0.9123355263157895, AUC 0.9799709320068359, avg_entr 0.025255825370550156
ep3_t0.8_test_time 0.16071510314941406
gc 0
Train Epoch4 Acc 0.22130833333333333 (26557/120000), AUC 0.46975505352020264
ep4_train_time 7.463888168334961
Test Epoch4 threshold 0.8 Acc 0.912828947368421, AUC 0.9799244999885559, avg_entr 0.02597820572555065
ep4_t0.8_test_time 0.16083908081054688
gc 0
Train Epoch5 Acc 0.21966666666666668 (26360/120000), AUC 0.45903241634368896
ep5_train_time 7.38582181930542
Test Epoch5 threshold 0.8 Acc 0.9141447368421053, AUC 0.9797988533973694, avg_entr 0.025950808078050613
ep5_t0.8_test_time 0.16084861755371094
gc 0
Train Epoch6 Acc 0.217075 (26049/120000), AUC 0.45724934339523315
ep6_train_time 7.519632339477539
Test Epoch6 threshold 0.8 Acc 0.9143092105263158, AUC 0.9797454476356506, avg_entr 0.026395825669169426
ep6_t0.8_test_time 0.16013503074645996
gc 0
Train Epoch7 Acc 0.21595833333333334 (25915/120000), AUC 0.46134090423583984
ep7_train_time 7.584844589233398
Test Epoch7 threshold 0.8 Acc 0.9126644736842106, AUC 0.9795129895210266, avg_entr 0.026237493380904198
ep7_t0.8_test_time 0.16153669357299805
gc 0
Train Epoch8 Acc 0.21270833333333333 (25525/120000), AUC 0.47030168771743774
ep8_train_time 7.34596586227417
Test Epoch8 threshold 0.8 Acc 0.9134868421052632, AUC 0.9795212745666504, avg_entr 0.025872396305203438
ep8_t0.8_test_time 0.16105055809020996
gc 0
Train Epoch9 Acc 0.21488333333333334 (25786/120000), AUC 0.47695133090019226
ep9_train_time 7.441025257110596
Test Epoch9 threshold 0.8 Acc 0.9134868421052632, AUC 0.9793268442153931, avg_entr 0.02632470428943634
ep9_t0.8_test_time 0.15990042686462402
Best AUC 0.9805951118469238
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.8_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.925, AUC 0.9859564304351807, avg_entr 0.024159111082553864
t0.8_test_time 0.04107236862182617
