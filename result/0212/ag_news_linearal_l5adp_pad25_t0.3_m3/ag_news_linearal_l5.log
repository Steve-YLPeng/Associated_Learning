total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.3_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.3889 (46668/120000), AUC 0.6039009094238281
ep0_train_time 5.351523399353027
Test Epoch0 threshold 0.3 Acc 0.9143092105263158, AUC 0.9806891083717346, avg_entr 0.025059405714273453
ep0_t0.3_test_time 0.08641266822814941
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.3_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3524833333333333 (42298/120000), AUC 0.6097996234893799
ep1_train_time 4.935129880905151
Test Epoch1 threshold 0.3 Acc 0.9126644736842106, AUC 0.9801995754241943, avg_entr 0.024762876331806183
ep1_t0.3_test_time 0.08238410949707031
gc 0
Train Epoch2 Acc 0.27915 (33498/120000), AUC 0.6257059574127197
ep2_train_time 4.881103754043579
Test Epoch2 threshold 0.3 Acc 0.9134868421052632, AUC 0.9804614782333374, avg_entr 0.02502564713358879
ep2_t0.3_test_time 0.0821526050567627
gc 0
Train Epoch3 Acc 0.25259166666666666 (30311/120000), AUC 0.6193535327911377
ep3_train_time 4.839974641799927
Test Epoch3 threshold 0.3 Acc 0.9120065789473685, AUC 0.9798637628555298, avg_entr 0.024741865694522858
ep3_t0.3_test_time 0.08188390731811523
gc 0
Train Epoch4 Acc 0.25116666666666665 (30140/120000), AUC 0.5974050760269165
ep4_train_time 4.872241258621216
Test Epoch4 threshold 0.3 Acc 0.9113486842105263, AUC 0.979613184928894, avg_entr 0.023110736161470413
ep4_t0.3_test_time 0.07995748519897461
gc 0
Train Epoch5 Acc 0.2513666666666667 (30164/120000), AUC 0.5869818925857544
ep5_train_time 4.860223293304443
Test Epoch5 threshold 0.3 Acc 0.9118421052631579, AUC 0.9794874787330627, avg_entr 0.024419400840997696
ep5_t0.3_test_time 0.08273935317993164
gc 0
Train Epoch6 Acc 0.25750833333333334 (30901/120000), AUC 0.5860459804534912
ep6_train_time 4.883123874664307
Test Epoch6 threshold 0.3 Acc 0.9110197368421052, AUC 0.9790480732917786, avg_entr 0.024955451488494873
ep6_t0.3_test_time 0.08159375190734863
gc 0
Train Epoch7 Acc 0.2787 (33444/120000), AUC 0.5873854756355286
ep7_train_time 4.903090000152588
Test Epoch7 threshold 0.3 Acc 0.9088815789473684, AUC 0.9790967702865601, avg_entr 0.024677066132426262
ep7_t0.3_test_time 0.08126378059387207
gc 0
Train Epoch8 Acc 0.31011666666666665 (37214/120000), AUC 0.5890963077545166
ep8_train_time 5.079679727554321
Test Epoch8 threshold 0.3 Acc 0.9092105263157895, AUC 0.9789313077926636, avg_entr 0.024976229295134544
ep8_t0.3_test_time 0.0836949348449707
gc 0
Train Epoch9 Acc 0.330025 (39603/120000), AUC 0.5915300846099854
ep9_train_time 5.2018492221832275
Test Epoch9 threshold 0.3 Acc 0.9092105263157895, AUC 0.9787002801895142, avg_entr 0.024767190217971802
ep9_t0.3_test_time 0.08476877212524414
Best AUC 0.9806891083717346
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.3_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9171052631578948, AUC 0.9850683212280273, avg_entr 0.025981735438108444
t0.3_test_time 0.022551774978637695
