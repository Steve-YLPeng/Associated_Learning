total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.8_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.09834166666666666 (11801/120000), AUC 0.400808721780777
ep0_train_time 5.660397052764893
Test Epoch0 threshold 0.8 Acc 0.9138157894736842, AUC 0.9804127216339111, avg_entr 0.03306881710886955
ep0_t0.8_test_time 0.10260295867919922
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.13303333333333334 (15964/120000), AUC 0.38786911964416504
ep1_train_time 5.184529066085815
Test Epoch1 threshold 0.8 Acc 0.9164473684210527, AUC 0.9803475737571716, avg_entr 0.030170122161507607
ep1_t0.8_test_time 0.10116720199584961
gc 0
Train Epoch2 Acc 0.16819166666666666 (20183/120000), AUC 0.3863217830657959
ep2_train_time 5.149233818054199
Test Epoch2 threshold 0.8 Acc 0.9134868421052632, AUC 0.9800983667373657, avg_entr 0.028721259906888008
ep2_t0.8_test_time 0.10158395767211914
gc 0
Train Epoch3 Acc 0.184925 (22191/120000), AUC 0.3877147436141968
ep3_train_time 5.179471492767334
Test Epoch3 threshold 0.8 Acc 0.9115131578947369, AUC 0.980057954788208, avg_entr 0.028275957331061363
ep3_t0.8_test_time 0.10131192207336426
gc 0
Train Epoch4 Acc 0.19650833333333334 (23581/120000), AUC 0.3902705907821655
ep4_train_time 5.178781032562256
Test Epoch4 threshold 0.8 Acc 0.9126644736842106, AUC 0.979739785194397, avg_entr 0.02770596742630005
ep4_t0.8_test_time 0.10188961029052734
gc 0
Train Epoch5 Acc 0.202025 (24243/120000), AUC 0.3927432596683502
ep5_train_time 5.184885501861572
Test Epoch5 threshold 0.8 Acc 0.9116776315789473, AUC 0.9795897006988525, avg_entr 0.027462787926197052
ep5_t0.8_test_time 0.10290312767028809
gc 0
Train Epoch6 Acc 0.20430833333333334 (24517/120000), AUC 0.3937131464481354
ep6_train_time 5.18656063079834
Test Epoch6 threshold 0.8 Acc 0.9131578947368421, AUC 0.979512095451355, avg_entr 0.02688525803387165
ep6_t0.8_test_time 0.10127663612365723
gc 0
Train Epoch7 Acc 0.20605 (24726/120000), AUC 0.39481890201568604
ep7_train_time 5.180829763412476
Test Epoch7 threshold 0.8 Acc 0.9116776315789473, AUC 0.9792976379394531, avg_entr 0.027367476373910904
ep7_t0.8_test_time 0.10176491737365723
gc 0
Train Epoch8 Acc 0.207175 (24861/120000), AUC 0.39632487297058105
ep8_train_time 5.1903369426727295
Test Epoch8 threshold 0.8 Acc 0.9126644736842106, AUC 0.9790753722190857, avg_entr 0.026965610682964325
ep8_t0.8_test_time 0.10255885124206543
gc 0
Train Epoch9 Acc 0.20800833333333332 (24961/120000), AUC 0.3973603844642639
ep9_train_time 5.148665904998779
Test Epoch9 threshold 0.8 Acc 0.9108552631578948, AUC 0.9790201783180237, avg_entr 0.02703073062002659
ep9_t0.8_test_time 0.1009221076965332
Best AUC 0.9804127216339111
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.8_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9296052631578947, AUC 0.9866538643836975, avg_entr 0.033927951008081436
t0.8_test_time 0.026482105255126953
