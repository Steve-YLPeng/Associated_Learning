total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.2674916666666667 (32099/120000), AUC 0.6880885362625122
ep0_train_time 9.436916828155518
Test Epoch0 threshold 0.6 Acc 0.9169407894736842, AUC 0.9807853698730469, avg_entr 0.025839272886514664
ep0_t0.6_test_time 0.25270581245422363
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.330025 (39603/120000), AUC 0.7136021852493286
ep1_train_time 9.153636932373047
Test Epoch1 threshold 0.6 Acc 0.9136513157894737, AUC 0.9807658791542053, avg_entr 0.025265583768486977
ep1_t0.6_test_time 0.2509918212890625
gc 0
Train Epoch2 Acc 0.33795 (40554/120000), AUC 0.7638844847679138
ep2_train_time 8.93254041671753
Test Epoch2 threshold 0.6 Acc 0.9134868421052632, AUC 0.9804530739784241, avg_entr 0.025099828839302063
ep2_t0.6_test_time 0.2516465187072754
gc 0
Train Epoch3 Acc 0.3385 (40620/120000), AUC 0.7736868858337402
ep3_train_time 9.047883749008179
Test Epoch3 threshold 0.6 Acc 0.9131578947368421, AUC 0.9804234504699707, avg_entr 0.02637728862464428
ep3_t0.6_test_time 0.2500169277191162
gc 0
Train Epoch4 Acc 0.34044166666666664 (40853/120000), AUC 0.7757375240325928
ep4_train_time 8.997865676879883
Test Epoch4 threshold 0.6 Acc 0.9129934210526316, AUC 0.9802671670913696, avg_entr 0.024673860520124435
ep4_t0.6_test_time 0.25084567070007324
gc 0
Train Epoch5 Acc 0.34618333333333334 (41542/120000), AUC 0.7746010422706604
ep5_train_time 8.935580253601074
Test Epoch5 threshold 0.6 Acc 0.9148026315789474, AUC 0.9800711870193481, avg_entr 0.025655046105384827
ep5_t0.6_test_time 0.25059962272644043
gc 0
Train Epoch6 Acc 0.366675 (44001/120000), AUC 0.7752928733825684
ep6_train_time 8.869455575942993
Test Epoch6 threshold 0.6 Acc 0.9138157894736842, AUC 0.9799994826316833, avg_entr 0.026318233460187912
ep6_t0.6_test_time 0.25133633613586426
gc 0
Train Epoch7 Acc 0.39103333333333334 (46924/120000), AUC 0.7753527760505676
ep7_train_time 9.095931768417358
Test Epoch7 threshold 0.6 Acc 0.9118421052631579, AUC 0.9799225330352783, avg_entr 0.02673180401325226
ep7_t0.6_test_time 0.26140499114990234
gc 0
Train Epoch8 Acc 0.409375 (49125/120000), AUC 0.7722371816635132
ep8_train_time 9.480897665023804
Test Epoch8 threshold 0.6 Acc 0.9133223684210526, AUC 0.9797922372817993, avg_entr 0.025966500863432884
ep8_t0.6_test_time 0.25098538398742676
gc 0
Train Epoch9 Acc 0.42068333333333335 (50482/120000), AUC 0.7692676186561584
ep9_train_time 9.197673082351685
Test Epoch9 threshold 0.6 Acc 0.9141447368421053, AUC 0.9797488451004028, avg_entr 0.025748087093234062
ep9_t0.6_test_time 0.2508411407470703
Best AUC 0.9807853698730469
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.925, AUC 0.9860972762107849, avg_entr 0.024511972442269325
t0.6_test_time 0.06379032135009766
