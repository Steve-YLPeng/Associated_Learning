total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.8_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9256833333333333 (111082/120000), AUC 0.9865260124206543
ep0_train_time 7.2336671352386475
Test Epoch0 threshold 0.8 Acc 0.9129934210526316, AUC 0.9802144765853882, avg_entr 0.025683902204036713
ep0_t0.8_test_time 0.10399389266967773
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.8_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9490083333333333 (113881/120000), AUC 0.9932029247283936
ep1_train_time 6.763890504837036
Test Epoch1 threshold 0.8 Acc 0.9154605263157894, AUC 0.9798915386199951, avg_entr 0.026574430987238884
ep1_t0.8_test_time 0.10188436508178711
gc 0
Train Epoch2 Acc 0.9509333333333333 (114112/120000), AUC 0.9934759736061096
ep2_train_time 6.717852830886841
Test Epoch2 threshold 0.8 Acc 0.9134868421052632, AUC 0.9791815876960754, avg_entr 0.025400299578905106
ep2_t0.8_test_time 0.10231184959411621
gc 0
Train Epoch3 Acc 0.9526416666666667 (114317/120000), AUC 0.9933608174324036
ep3_train_time 6.763291597366333
Test Epoch3 threshold 0.8 Acc 0.9101973684210526, AUC 0.9791280627250671, avg_entr 0.02599109150469303
ep3_t0.8_test_time 0.10169553756713867
gc 0
Train Epoch4 Acc 0.9536666666666667 (114440/120000), AUC 0.9938657283782959
ep4_train_time 6.758572816848755
Test Epoch4 threshold 0.8 Acc 0.9115131578947369, AUC 0.9791091084480286, avg_entr 0.026166236028075218
ep4_t0.8_test_time 0.10224676132202148
gc 0
Train Epoch5 Acc 0.9564166666666667 (114770/120000), AUC 0.9947605729103088
ep5_train_time 6.759961366653442
Test Epoch5 threshold 0.8 Acc 0.9113486842105263, AUC 0.9792448282241821, avg_entr 0.02593958005309105
ep5_t0.8_test_time 0.10678863525390625
gc 0
Train Epoch6 Acc 0.9566 (114792/120000), AUC 0.9949039816856384
ep6_train_time 6.7493250370025635
Test Epoch6 threshold 0.8 Acc 0.9095394736842105, AUC 0.9790251851081848, avg_entr 0.02624344639480114
ep6_t0.8_test_time 0.10020256042480469
gc 0
Train Epoch7 Acc 0.9574416666666666 (114893/120000), AUC 0.9950234889984131
ep7_train_time 6.942869186401367
Test Epoch7 threshold 0.8 Acc 0.9095394736842105, AUC 0.9789527654647827, avg_entr 0.02496272325515747
ep7_t0.8_test_time 0.10294914245605469
gc 0
Train Epoch8 Acc 0.9579833333333333 (114958/120000), AUC 0.9951650500297546
ep8_train_time 6.841152667999268
Test Epoch8 threshold 0.8 Acc 0.9075657894736842, AUC 0.9783965349197388, avg_entr 0.027164893224835396
ep8_t0.8_test_time 0.1010599136352539
gc 0
Train Epoch9 Acc 0.959175 (115101/120000), AUC 0.9955433011054993
ep9_train_time 6.735119342803955
Test Epoch9 threshold 0.8 Acc 0.9082236842105263, AUC 0.9785462021827698, avg_entr 0.025772666558623314
ep9_t0.8_test_time 0.10185670852661133
Best AUC 0.9802144765853882
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.8_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9217105263157894, AUC 0.9862483739852905, avg_entr 0.025094829499721527
t0.8_test_time 0.026426315307617188
