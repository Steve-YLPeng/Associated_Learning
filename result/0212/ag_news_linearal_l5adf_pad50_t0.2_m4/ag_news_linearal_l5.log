total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.2_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.24728333333333333 (29674/120000), AUC 0.6006147265434265
ep0_train_time 6.7202537059783936
Test Epoch0 threshold 0.2 Acc 0.9136513157894737, AUC 0.9801314473152161, avg_entr 0.024437949061393738
ep0_t0.2_test_time 0.1253514289855957
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.2_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.395625 (47475/120000), AUC 0.5989371538162231
ep1_train_time 6.185596704483032
Test Epoch1 threshold 0.2 Acc 0.915625, AUC 0.9801399111747742, avg_entr 0.02264529839158058
ep1_t0.2_test_time 0.12236404418945312
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.2_m4//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.631825 (75819/120000), AUC 0.6493513584136963
ep2_train_time 6.288505554199219
Test Epoch2 threshold 0.2 Acc 0.9134868421052632, AUC 0.979805588722229, avg_entr 0.021091561764478683
ep2_t0.2_test_time 0.1233370304107666
gc 0
Train Epoch3 Acc 0.707475 (84897/120000), AUC 0.7313624024391174
ep3_train_time 6.241692066192627
Test Epoch3 threshold 0.2 Acc 0.9111842105263158, AUC 0.9796620607376099, avg_entr 0.019723933190107346
ep3_t0.2_test_time 0.12365555763244629
gc 0
Train Epoch4 Acc 0.71635 (85962/120000), AUC 0.7822426557540894
ep4_train_time 6.235775470733643
Test Epoch4 threshold 0.2 Acc 0.9100328947368421, AUC 0.9795042872428894, avg_entr 0.018464824184775352
ep4_t0.2_test_time 0.12409377098083496
gc 0
Train Epoch5 Acc 0.7184166666666667 (86210/120000), AUC 0.7911799550056458
ep5_train_time 6.272138595581055
Test Epoch5 threshold 0.2 Acc 0.9106907894736842, AUC 0.9791961908340454, avg_entr 0.018535038456320763
ep5_t0.2_test_time 0.12314558029174805
gc 0
Train Epoch6 Acc 0.719075 (86289/120000), AUC 0.7936034202575684
ep6_train_time 6.23190450668335
Test Epoch6 threshold 0.2 Acc 0.9105263157894737, AUC 0.9791887998580933, avg_entr 0.018425455316901207
ep6_t0.2_test_time 0.12334132194519043
gc 0
Train Epoch7 Acc 0.7192833333333334 (86314/120000), AUC 0.7953237891197205
ep7_train_time 6.263827562332153
Test Epoch7 threshold 0.2 Acc 0.9110197368421052, AUC 0.9789949655532837, avg_entr 0.01841670833528042
ep7_t0.2_test_time 0.12339115142822266
gc 0
Train Epoch8 Acc 0.7194333333333334 (86332/120000), AUC 0.7965853214263916
ep8_train_time 6.268789291381836
Test Epoch8 threshold 0.2 Acc 0.9111842105263158, AUC 0.9788030385971069, avg_entr 0.017772506922483444
ep8_t0.2_test_time 0.1235504150390625
gc 0
Train Epoch9 Acc 0.7199833333333333 (86398/120000), AUC 0.798335075378418
ep9_train_time 6.269244909286499
Test Epoch9 threshold 0.2 Acc 0.9088815789473684, AUC 0.9786465764045715, avg_entr 0.018084939569234848
ep9_t0.2_test_time 0.1219475269317627
Best AUC 0.9801399111747742
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.2_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9243421052631579, AUC 0.9857783317565918, avg_entr 0.022915009409189224
t0.2_test_time 0.0318446159362793
