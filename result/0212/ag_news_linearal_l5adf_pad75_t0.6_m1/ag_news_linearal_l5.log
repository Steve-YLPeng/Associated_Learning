total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2492 (29904/120000), AUC 0.49541693925857544
ep0_train_time 5.8863983154296875
Test Epoch0 threshold 0.6 Acc 0.9087171052631579, AUC 0.9764161109924316, avg_entr 0.1627621352672577
ep0_t0.6_test_time 0.13439583778381348
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25003333333333333 (30004/120000), AUC 0.5047103762626648
ep1_train_time 5.378467559814453
Test Epoch1 threshold 0.6 Acc 0.9105263157894737, AUC 0.9795933365821838, avg_entr 0.10257773846387863
ep1_t0.6_test_time 0.1330277919769287
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.250075 (30009/120000), AUC 0.5102694630622864
ep2_train_time 5.443450927734375
Test Epoch2 threshold 0.6 Acc 0.9179276315789474, AUC 0.980428159236908, avg_entr 0.07674072682857513
ep2_t0.6_test_time 0.13276386260986328
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.2500833333333333 (30010/120000), AUC 0.5129711031913757
ep3_train_time 5.366793155670166
Test Epoch3 threshold 0.6 Acc 0.9144736842105263, AUC 0.980613112449646, avg_entr 0.06491393595933914
ep3_t0.6_test_time 0.13263750076293945
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25011666666666665 (30014/120000), AUC 0.5151387453079224
ep4_train_time 5.416626691818237
Test Epoch4 threshold 0.6 Acc 0.9161184210526315, AUC 0.9804090261459351, avg_entr 0.05702323839068413
ep4_t0.6_test_time 0.13365554809570312
gc 0
Train Epoch5 Acc 0.2501333333333333 (30016/120000), AUC 0.5158253312110901
ep5_train_time 5.431023597717285
Test Epoch5 threshold 0.6 Acc 0.9151315789473684, AUC 0.9805659055709839, avg_entr 0.05387876555323601
ep5_t0.6_test_time 0.1318662166595459
gc 0
Train Epoch6 Acc 0.25015 (30018/120000), AUC 0.5167276859283447
ep6_train_time 5.412576675415039
Test Epoch6 threshold 0.6 Acc 0.912828947368421, AUC 0.9804568886756897, avg_entr 0.04943310096859932
ep6_t0.6_test_time 0.13355159759521484
gc 0
Train Epoch7 Acc 0.25015 (30018/120000), AUC 0.5172280669212341
ep7_train_time 5.405838251113892
Test Epoch7 threshold 0.6 Acc 0.9133223684210526, AUC 0.9801391363143921, avg_entr 0.046253591775894165
ep7_t0.6_test_time 0.13256239891052246
gc 0
Train Epoch8 Acc 0.2501583333333333 (30019/120000), AUC 0.5173346400260925
ep8_train_time 5.410202264785767
Test Epoch8 threshold 0.6 Acc 0.9144736842105263, AUC 0.9800153374671936, avg_entr 0.04415767639875412
ep8_t0.6_test_time 0.1337738037109375
gc 0
Train Epoch9 Acc 0.2501583333333333 (30019/120000), AUC 0.5176846385002136
ep9_train_time 5.413905382156372
Test Epoch9 threshold 0.6 Acc 0.9110197368421052, AUC 0.9798426628112793, avg_entr 0.04358915984630585
ep9_t0.6_test_time 0.13179254531860352
Best AUC 0.980613112449646
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.6_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9243421052631579, AUC 0.9860689043998718, avg_entr 0.06748785823583603
t0.6_test_time 0.03403329849243164
