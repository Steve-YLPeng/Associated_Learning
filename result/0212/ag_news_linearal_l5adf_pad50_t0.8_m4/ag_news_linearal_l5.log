total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.8_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.241075 (28929/120000), AUC 0.6315959692001343
ep0_train_time 6.696731328964233
Test Epoch0 threshold 0.8 Acc 0.9143092105263158, AUC 0.9805489778518677, avg_entr 0.02629362978041172
ep0_t0.8_test_time 0.10546231269836426
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.8_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2676 (32112/120000), AUC 0.7204865217208862
ep1_train_time 6.309357404708862
Test Epoch1 threshold 0.8 Acc 0.9144736842105263, AUC 0.9797300696372986, avg_entr 0.026580309495329857
ep1_t0.8_test_time 0.10434746742248535
gc 0
Train Epoch2 Acc 0.36588333333333334 (43906/120000), AUC 0.7510603070259094
ep2_train_time 6.255082368850708
Test Epoch2 threshold 0.8 Acc 0.9144736842105263, AUC 0.979948878288269, avg_entr 0.026674285531044006
ep2_t0.8_test_time 0.102325439453125
gc 0
Train Epoch3 Acc 0.45269166666666666 (54323/120000), AUC 0.7299971580505371
ep3_train_time 6.364066123962402
Test Epoch3 threshold 0.8 Acc 0.9125, AUC 0.9794439077377319, avg_entr 0.026873864233493805
ep3_t0.8_test_time 0.10236787796020508
gc 0
Train Epoch4 Acc 0.5503333333333333 (66040/120000), AUC 0.7004920244216919
ep4_train_time 6.2775349617004395
Test Epoch4 threshold 0.8 Acc 0.9123355263157895, AUC 0.9794227480888367, avg_entr 0.025886686518788338
ep4_t0.8_test_time 0.1032106876373291
gc 0
Train Epoch5 Acc 0.5246666666666666 (62960/120000), AUC 0.6857344508171082
ep5_train_time 6.305582523345947
Test Epoch5 threshold 0.8 Acc 0.9125, AUC 0.9794889688491821, avg_entr 0.026053354144096375
ep5_t0.8_test_time 0.1083369255065918
gc 0
Train Epoch6 Acc 0.492875 (59145/120000), AUC 0.6775709986686707
ep6_train_time 6.281398773193359
Test Epoch6 threshold 0.8 Acc 0.9121710526315789, AUC 0.9791703224182129, avg_entr 0.025994597002863884
ep6_t0.8_test_time 0.10393714904785156
gc 0
Train Epoch7 Acc 0.47545 (57054/120000), AUC 0.6714459657669067
ep7_train_time 6.310008764266968
Test Epoch7 threshold 0.8 Acc 0.9123355263157895, AUC 0.9789981245994568, avg_entr 0.02627221681177616
ep7_t0.8_test_time 0.10386013984680176
gc 0
Train Epoch8 Acc 0.46391666666666664 (55670/120000), AUC 0.6662612557411194
ep8_train_time 6.344913482666016
Test Epoch8 threshold 0.8 Acc 0.9092105263157895, AUC 0.9788841009140015, avg_entr 0.025867659598588943
ep8_t0.8_test_time 0.1040647029876709
gc 0
Train Epoch9 Acc 0.45466666666666666 (54560/120000), AUC 0.6630922555923462
ep9_train_time 6.330661058425903
Test Epoch9 threshold 0.8 Acc 0.9101973684210526, AUC 0.9786783456802368, avg_entr 0.026455720886588097
ep9_t0.8_test_time 0.10315608978271484
Best AUC 0.9805489778518677
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.8_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9263157894736842, AUC 0.9864751100540161, avg_entr 0.026027662679553032
t0.8_test_time 0.026445865631103516
