total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.8_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.22086666666666666 (26504/120000), AUC 0.19072562456130981
ep0_train_time 7.458975315093994
Test Epoch0 threshold 0.8 Acc 0.9169407894736842, AUC 0.9806094765663147, avg_entr 0.026746448129415512
ep0_t0.8_test_time 0.13634157180786133
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.8_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.15386666666666668 (18464/120000), AUC 0.2238234281539917
ep1_train_time 7.041276454925537
Test Epoch1 threshold 0.8 Acc 0.9134868421052632, AUC 0.9801622629165649, avg_entr 0.02653651311993599
ep1_t0.8_test_time 0.13259077072143555
gc 0
Train Epoch2 Acc 0.09215833333333333 (11059/120000), AUC 0.2651139497756958
ep2_train_time 7.050786256790161
Test Epoch2 threshold 0.8 Acc 0.9148026315789474, AUC 0.9802101850509644, avg_entr 0.025396613404154778
ep2_t0.8_test_time 0.13309741020202637
gc 0
Train Epoch3 Acc 0.076275 (9153/120000), AUC 0.2519758939743042
ep3_train_time 7.046304941177368
Test Epoch3 threshold 0.8 Acc 0.9134868421052632, AUC 0.980031430721283, avg_entr 0.026117824018001556
ep3_t0.8_test_time 0.13222193717956543
gc 0
Train Epoch4 Acc 0.05744166666666667 (6893/120000), AUC 0.20878049731254578
ep4_train_time 7.064145088195801
Test Epoch4 threshold 0.8 Acc 0.9105263157894737, AUC 0.9795385003089905, avg_entr 0.026357825845479965
ep4_t0.8_test_time 0.13286066055297852
gc 0
Train Epoch5 Acc 0.045366666666666666 (5444/120000), AUC 0.1942022144794464
ep5_train_time 7.014108657836914
Test Epoch5 threshold 0.8 Acc 0.9113486842105263, AUC 0.9796496629714966, avg_entr 0.025177158415317535
ep5_t0.8_test_time 0.13265585899353027
gc 0
Train Epoch6 Acc 0.04058333333333333 (4870/120000), AUC 0.1888262927532196
ep6_train_time 7.036386013031006
Test Epoch6 threshold 0.8 Acc 0.9105263157894737, AUC 0.979259192943573, avg_entr 0.02609189599752426
ep6_t0.8_test_time 0.1321876049041748
gc 0
Train Epoch7 Acc 0.037083333333333336 (4450/120000), AUC 0.18444791436195374
ep7_train_time 7.066806793212891
Test Epoch7 threshold 0.8 Acc 0.9110197368421052, AUC 0.979306697845459, avg_entr 0.025568999350070953
ep7_t0.8_test_time 0.13335537910461426
gc 0
Train Epoch8 Acc 0.03546666666666667 (4256/120000), AUC 0.18276454508304596
ep8_train_time 7.033456802368164
Test Epoch8 threshold 0.8 Acc 0.9101973684210526, AUC 0.979120671749115, avg_entr 0.02640397474169731
ep8_t0.8_test_time 0.1330552101135254
gc 0
Train Epoch9 Acc 0.033416666666666664 (4010/120000), AUC 0.18150979280471802
ep9_train_time 7.026928901672363
Test Epoch9 threshold 0.8 Acc 0.9097039473684211, AUC 0.9790313243865967, avg_entr 0.026034347712993622
ep9_t0.8_test_time 0.1323108673095703
Best AUC 0.9806094765663147
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.8_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9276315789473685, AUC 0.9862571954727173, avg_entr 0.02565089240670204
t0.8_test_time 0.033956289291381836
