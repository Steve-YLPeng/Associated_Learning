total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.22255833333333333 (26707/120000), AUC 0.28204041719436646
ep0_train_time 9.631929159164429
Test Epoch0 threshold 0.5 Acc 0.9136513157894737, AUC 0.9807770848274231, avg_entr 0.02524864301085472
ep0_t0.5_test_time 0.2554662227630615
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25529166666666664 (30635/120000), AUC 0.2989671230316162
ep1_train_time 9.08281922340393
Test Epoch1 threshold 0.5 Acc 0.9157894736842105, AUC 0.980731189250946, avg_entr 0.02463139407336712
ep1_t0.5_test_time 0.2531163692474365
gc 0
Train Epoch2 Acc 0.36966666666666664 (44360/120000), AUC 0.34008312225341797
ep2_train_time 8.984148263931274
Test Epoch2 threshold 0.5 Acc 0.9139802631578947, AUC 0.9803633093833923, avg_entr 0.025182992219924927
ep2_t0.5_test_time 0.25257205963134766
gc 0
Train Epoch3 Acc 0.4573583333333333 (54883/120000), AUC 0.3685252070426941
ep3_train_time 8.998828411102295
Test Epoch3 threshold 0.5 Acc 0.9133223684210526, AUC 0.9803587794303894, avg_entr 0.026388876140117645
ep3_t0.5_test_time 0.25204038619995117
gc 0
Train Epoch4 Acc 0.47731666666666667 (57278/120000), AUC 0.37296566367149353
ep4_train_time 9.136733293533325
Test Epoch4 threshold 0.5 Acc 0.9139802631578947, AUC 0.980262815952301, avg_entr 0.02565118670463562
ep4_t0.5_test_time 0.2518773078918457
gc 0
Train Epoch5 Acc 0.47854166666666664 (57425/120000), AUC 0.3663862347602844
ep5_train_time 9.194730520248413
Test Epoch5 threshold 0.5 Acc 0.9149671052631579, AUC 0.9801281094551086, avg_entr 0.026256777346134186
ep5_t0.5_test_time 0.25275301933288574
gc 0
Train Epoch6 Acc 0.44774166666666665 (53729/120000), AUC 0.3621550500392914
ep6_train_time 9.08353304862976
Test Epoch6 threshold 0.5 Acc 0.9136513157894737, AUC 0.9799503087997437, avg_entr 0.026216581463813782
ep6_t0.5_test_time 0.2522139549255371
gc 0
Train Epoch7 Acc 0.35911666666666664 (43094/120000), AUC 0.35904067754745483
ep7_train_time 9.044825315475464
Test Epoch7 threshold 0.5 Acc 0.9143092105263158, AUC 0.979893684387207, avg_entr 0.02523117884993553
ep7_t0.5_test_time 0.2536327838897705
gc 0
Train Epoch8 Acc 0.29699166666666665 (35639/120000), AUC 0.35596880316734314
ep8_train_time 8.942486763000488
Test Epoch8 threshold 0.5 Acc 0.9101973684210526, AUC 0.9797104597091675, avg_entr 0.025422997772693634
ep8_t0.5_test_time 0.25251007080078125
gc 0
Train Epoch9 Acc 0.2780416666666667 (33365/120000), AUC 0.3532140254974365
ep9_train_time 9.133025407791138
Test Epoch9 threshold 0.5 Acc 0.9126644736842106, AUC 0.9796003103256226, avg_entr 0.02578330971300602
ep9_t0.5_test_time 0.252727746963501
Best AUC 0.9807770848274231
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9263157894736842, AUC 0.9862803220748901, avg_entr 0.024143151938915253
t0.5_test_time 0.06422162055969238
