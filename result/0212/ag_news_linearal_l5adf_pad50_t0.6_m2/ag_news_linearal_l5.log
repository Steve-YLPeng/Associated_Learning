total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.6_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.23809166666666667 (28571/120000), AUC 0.5068166255950928
ep0_train_time 5.4695656299591064
Test Epoch0 threshold 0.6 Acc 0.9151315789473684, AUC 0.9800397157669067, avg_entr 0.02993822656571865
ep0_t0.6_test_time 0.10336899757385254
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.18699166666666667 (22439/120000), AUC 0.4611678719520569
ep1_train_time 5.016152620315552
Test Epoch1 threshold 0.6 Acc 0.9129934210526316, AUC 0.9799772500991821, avg_entr 0.02835792303085327
ep1_t0.6_test_time 0.10030889511108398
gc 0
Train Epoch2 Acc 0.13384166666666666 (16061/120000), AUC 0.4471572935581207
ep2_train_time 5.016453504562378
Test Epoch2 threshold 0.6 Acc 0.9123355263157895, AUC 0.9794745445251465, avg_entr 0.0268972497433424
ep2_t0.6_test_time 0.10095024108886719
gc 0
Train Epoch3 Acc 0.101475 (12177/120000), AUC 0.44066789746284485
ep3_train_time 5.001344680786133
Test Epoch3 threshold 0.6 Acc 0.9123355263157895, AUC 0.9797514081001282, avg_entr 0.0264871995896101
ep3_t0.6_test_time 0.10134768486022949
gc 0
Train Epoch4 Acc 0.08295833333333333 (9955/120000), AUC 0.4367270767688751
ep4_train_time 5.019084692001343
Test Epoch4 threshold 0.6 Acc 0.9103618421052632, AUC 0.9795888662338257, avg_entr 0.027034007012844086
ep4_t0.6_test_time 0.10059618949890137
gc 0
Train Epoch5 Acc 0.07441666666666667 (8930/120000), AUC 0.4335721731185913
ep5_train_time 5.013345718383789
Test Epoch5 threshold 0.6 Acc 0.912828947368421, AUC 0.9794973134994507, avg_entr 0.02674209140241146
ep5_t0.6_test_time 0.10058283805847168
gc 0
Train Epoch6 Acc 0.07156666666666667 (8588/120000), AUC 0.4319932460784912
ep6_train_time 5.296030044555664
Test Epoch6 threshold 0.6 Acc 0.9100328947368421, AUC 0.9792886972427368, avg_entr 0.026445157825946808
ep6_t0.6_test_time 0.10468506813049316
gc 0
Train Epoch7 Acc 0.0701 (8412/120000), AUC 0.42982494831085205
ep7_train_time 5.357945203781128
Test Epoch7 threshold 0.6 Acc 0.9098684210526315, AUC 0.9788524508476257, avg_entr 0.02684379182755947
ep7_t0.6_test_time 0.1083064079284668
gc 0
Train Epoch8 Acc 0.070575 (8469/120000), AUC 0.42731425166130066
ep8_train_time 5.31522274017334
Test Epoch8 threshold 0.6 Acc 0.9100328947368421, AUC 0.9787899255752563, avg_entr 0.026369689032435417
ep8_t0.6_test_time 0.10093307495117188
gc 0
Train Epoch9 Acc 0.06971666666666666 (8366/120000), AUC 0.42512160539627075
ep9_train_time 5.023916959762573
Test Epoch9 threshold 0.6 Acc 0.909375, AUC 0.9788153171539307, avg_entr 0.026178600266575813
ep9_t0.6_test_time 0.10066556930541992
Best AUC 0.9800397157669067
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.6_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9282894736842106, AUC 0.9855877161026001, avg_entr 0.030487393960356712
t0.6_test_time 0.026140213012695312
