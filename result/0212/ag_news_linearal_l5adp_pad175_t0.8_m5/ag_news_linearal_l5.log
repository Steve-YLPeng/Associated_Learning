total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9063 (108756/120000), AUC 0.9840766191482544
ep0_train_time 10.571549654006958
Test Epoch0 threshold 0.8 Acc 0.9159539473684211, AUC 0.9805687069892883, avg_entr 0.02592155523598194
ep0_t0.8_test_time 0.25982046127319336
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.8_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.949375 (113925/120000), AUC 0.9929678440093994
ep1_train_time 9.95665979385376
Test Epoch1 threshold 0.8 Acc 0.9154605263157894, AUC 0.9804097414016724, avg_entr 0.02480054832994938
ep1_t0.8_test_time 0.2482771873474121
gc 0
Train Epoch2 Acc 0.9507333333333333 (114088/120000), AUC 0.9933785200119019
ep2_train_time 9.82101559638977
Test Epoch2 threshold 0.8 Acc 0.9151315789473684, AUC 0.9803284406661987, avg_entr 0.025578385218977928
ep2_t0.8_test_time 0.24834990501403809
gc 0
Train Epoch3 Acc 0.951875 (114225/120000), AUC 0.9933446049690247
ep3_train_time 9.84850549697876
Test Epoch3 threshold 0.8 Acc 0.9126644736842106, AUC 0.9801483154296875, avg_entr 0.026755059137940407
ep3_t0.8_test_time 0.24795317649841309
gc 0
Train Epoch4 Acc 0.9526833333333333 (114322/120000), AUC 0.993747889995575
ep4_train_time 9.990608215332031
Test Epoch4 threshold 0.8 Acc 0.9116776315789473, AUC 0.9799611568450928, avg_entr 0.025432053953409195
ep4_t0.8_test_time 0.2490077018737793
gc 0
Train Epoch5 Acc 0.9544333333333334 (114532/120000), AUC 0.9945405125617981
ep5_train_time 9.915073871612549
Test Epoch5 threshold 0.8 Acc 0.9134868421052632, AUC 0.9798298478126526, avg_entr 0.02578379400074482
ep5_t0.8_test_time 0.24911165237426758
gc 0
Train Epoch6 Acc 0.955225 (114627/120000), AUC 0.9946677088737488
ep6_train_time 10.1606285572052
Test Epoch6 threshold 0.8 Acc 0.9134868421052632, AUC 0.9797725081443787, avg_entr 0.025176841765642166
ep6_t0.8_test_time 0.25894618034362793
gc 0
Train Epoch7 Acc 0.9555583333333333 (114667/120000), AUC 0.9947265386581421
ep7_train_time 9.952021598815918
Test Epoch7 threshold 0.8 Acc 0.9113486842105263, AUC 0.9796262979507446, avg_entr 0.02565228007733822
ep7_t0.8_test_time 0.24862265586853027
gc 0
Train Epoch8 Acc 0.9562333333333334 (114748/120000), AUC 0.9948830604553223
ep8_train_time 9.968217134475708
Test Epoch8 threshold 0.8 Acc 0.9118421052631579, AUC 0.979539692401886, avg_entr 0.02593027427792549
ep8_t0.8_test_time 0.24805665016174316
gc 0
Train Epoch9 Acc 0.9570333333333333 (114844/120000), AUC 0.9951597452163696
ep9_train_time 9.906395196914673
Test Epoch9 threshold 0.8 Acc 0.9115131578947369, AUC 0.9794676303863525, avg_entr 0.025350548326969147
ep9_t0.8_test_time 0.2490553855895996
Best AUC 0.9805687069892883
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.8_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9230263157894737, AUC 0.9862000346183777, avg_entr 0.02615700103342533
t0.8_test_time 0.0629572868347168
