total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.2_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.28323333333333334 (33988/120000), AUC 0.4694264531135559
ep0_train_time 5.374565362930298
Test Epoch0 threshold 0.2 Acc 0.9141447368421053, AUC 0.9809197783470154, avg_entr 0.023858891800045967
ep0_t0.2_test_time 0.08726263046264648
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.2_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.33325 (39990/120000), AUC 0.5013922452926636
ep1_train_time 4.917904615402222
Test Epoch1 threshold 0.2 Acc 0.9146381578947368, AUC 0.9804109930992126, avg_entr 0.02360393851995468
ep1_t0.2_test_time 0.08582830429077148
gc 0
Train Epoch2 Acc 0.287825 (34539/120000), AUC 0.5305860042572021
ep2_train_time 4.869644403457642
Test Epoch2 threshold 0.2 Acc 0.9113486842105263, AUC 0.9801526069641113, avg_entr 0.02413470670580864
ep2_t0.2_test_time 0.08538198471069336
gc 0
Train Epoch3 Acc 0.21564166666666668 (25877/120000), AUC 0.5683892965316772
ep3_train_time 4.908436298370361
Test Epoch3 threshold 0.2 Acc 0.9108552631578948, AUC 0.9801573157310486, avg_entr 0.022619716823101044
ep3_t0.2_test_time 0.08497309684753418
gc 0
Train Epoch4 Acc 0.25011666666666665 (30014/120000), AUC 0.6069561243057251
ep4_train_time 4.897077322006226
Test Epoch4 threshold 0.2 Acc 0.9105263157894737, AUC 0.9796723127365112, avg_entr 0.020642278715968132
ep4_t0.2_test_time 0.08556962013244629
gc 0
Train Epoch5 Acc 0.33623333333333333 (40348/120000), AUC 0.6350831985473633
ep5_train_time 4.876566171646118
Test Epoch5 threshold 0.2 Acc 0.9113486842105263, AUC 0.9796265959739685, avg_entr 0.021380655467510223
ep5_t0.2_test_time 0.08584952354431152
gc 0
Train Epoch6 Acc 0.3988333333333333 (47860/120000), AUC 0.6501561403274536
ep6_train_time 4.964299917221069
Test Epoch6 threshold 0.2 Acc 0.9098684210526315, AUC 0.9792128801345825, avg_entr 0.02049199678003788
ep6_t0.2_test_time 0.08802556991577148
gc 0
Train Epoch7 Acc 0.4463916666666667 (53567/120000), AUC 0.6662064790725708
ep7_train_time 5.238387823104858
Test Epoch7 threshold 0.2 Acc 0.9116776315789473, AUC 0.9791483879089355, avg_entr 0.019946815446019173
ep7_t0.2_test_time 0.08844971656799316
gc 0
Train Epoch8 Acc 0.476675 (57201/120000), AUC 0.6880796551704407
ep8_train_time 5.136133193969727
Test Epoch8 threshold 0.2 Acc 0.9111842105263158, AUC 0.979001522064209, avg_entr 0.01989314891397953
ep8_t0.2_test_time 0.08507847785949707
gc 0
Train Epoch9 Acc 0.4996583333333333 (59959/120000), AUC 0.7077036499977112
ep9_train_time 4.886218547821045
Test Epoch9 threshold 0.2 Acc 0.9106907894736842, AUC 0.9788155555725098, avg_entr 0.019438859075307846
ep9_t0.2_test_time 0.08512091636657715
Best AUC 0.9809197783470154
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.2_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9223684210526316, AUC 0.9849929809570312, avg_entr 0.023713428527116776
t0.2_test_time 0.02218770980834961
