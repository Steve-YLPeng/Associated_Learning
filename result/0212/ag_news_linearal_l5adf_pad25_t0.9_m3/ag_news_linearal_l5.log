total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.9_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.4454916666666667 (53459/120000), AUC 0.7069127559661865
ep0_train_time 5.451475620269775
Test Epoch0 threshold 0.9 Acc 0.9108552631578948, AUC 0.9811906814575195, avg_entr 0.02641339972615242
ep0_t0.9_test_time 0.07376575469970703
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.9_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4403 (52836/120000), AUC 0.7197034955024719
ep1_train_time 5.0287110805511475
Test Epoch1 threshold 0.9 Acc 0.9118421052631579, AUC 0.9809818267822266, avg_entr 0.026076873764395714
ep1_t0.9_test_time 0.07152223587036133
gc 0
Train Epoch2 Acc 0.3605583333333333 (43267/120000), AUC 0.7000921368598938
ep2_train_time 5.065796852111816
Test Epoch2 threshold 0.9 Acc 0.9129934210526316, AUC 0.9806094169616699, avg_entr 0.025037510320544243
ep2_t0.9_test_time 0.07181429862976074
gc 0
Train Epoch3 Acc 0.33698333333333336 (40438/120000), AUC 0.6593074798583984
ep3_train_time 5.046436309814453
Test Epoch3 threshold 0.9 Acc 0.9125, AUC 0.9799878597259521, avg_entr 0.025764351710677147
ep3_t0.9_test_time 0.07205033302307129
gc 0
Train Epoch4 Acc 0.36725833333333335 (44071/120000), AUC 0.6328935027122498
ep4_train_time 5.0461790561676025
Test Epoch4 threshold 0.9 Acc 0.9118421052631579, AUC 0.9799107909202576, avg_entr 0.02486276812851429
ep4_t0.9_test_time 0.07262277603149414
gc 0
Train Epoch5 Acc 0.40744166666666665 (48893/120000), AUC 0.61833655834198
ep5_train_time 5.012091398239136
Test Epoch5 threshold 0.9 Acc 0.9113486842105263, AUC 0.9798305034637451, avg_entr 0.024689337238669395
ep5_t0.9_test_time 0.07207798957824707
gc 0
Train Epoch6 Acc 0.4228166666666667 (50738/120000), AUC 0.6052511930465698
ep6_train_time 5.036783456802368
Test Epoch6 threshold 0.9 Acc 0.9125, AUC 0.9792342185974121, avg_entr 0.025114314630627632
ep6_t0.9_test_time 0.07119226455688477
gc 0
Train Epoch7 Acc 0.412425 (49491/120000), AUC 0.5906744003295898
ep7_train_time 5.022918462753296
Test Epoch7 threshold 0.9 Acc 0.9108552631578948, AUC 0.9790685176849365, avg_entr 0.025584619492292404
ep7_t0.9_test_time 0.07387256622314453
gc 0
Train Epoch8 Acc 0.381825 (45819/120000), AUC 0.5734008550643921
ep8_train_time 5.077901124954224
Test Epoch8 threshold 0.9 Acc 0.9111842105263158, AUC 0.9790376424789429, avg_entr 0.025430988520383835
ep8_t0.9_test_time 0.0721888542175293
gc 0
Train Epoch9 Acc 0.35305 (42366/120000), AUC 0.5583169460296631
ep9_train_time 5.064726829528809
Test Epoch9 threshold 0.9 Acc 0.9111842105263158, AUC 0.9788881540298462, avg_entr 0.025452420115470886
ep9_t0.9_test_time 0.0735788345336914
Best AUC 0.9811906814575195
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.9_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9190789473684211, AUC 0.9863873720169067, avg_entr 0.027109768241643906
t0.9_test_time 0.019185781478881836
