total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.25651666666666667 (30782/120000), AUC 0.4774182140827179
ep0_train_time 9.342577934265137
Test Epoch0 threshold 0.3 Acc 0.9161184210526315, AUC 0.9807499051094055, avg_entr 0.025920143350958824
ep0_t0.3_test_time 0.26351332664489746
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25810833333333333 (30973/120000), AUC 0.557164192199707
ep1_train_time 9.119189023971558
Test Epoch1 threshold 0.3 Acc 0.9157894736842105, AUC 0.9808204770088196, avg_entr 0.024495072662830353
ep1_t0.3_test_time 0.2615792751312256
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2557333333333333 (30688/120000), AUC 0.6012063026428223
ep2_train_time 8.910035371780396
Test Epoch2 threshold 0.3 Acc 0.9146381578947368, AUC 0.9805867671966553, avg_entr 0.025013931095600128
ep2_t0.3_test_time 0.2598598003387451
gc 0
Train Epoch3 Acc 0.25353333333333333 (30424/120000), AUC 0.6175446510314941
ep3_train_time 9.018694639205933
Test Epoch3 threshold 0.3 Acc 0.915625, AUC 0.9802145957946777, avg_entr 0.026139914989471436
ep3_t0.3_test_time 0.2626988887786865
gc 0
Train Epoch4 Acc 0.25195833333333334 (30235/120000), AUC 0.6194674968719482
ep4_train_time 8.927744626998901
Test Epoch4 threshold 0.3 Acc 0.9121710526315789, AUC 0.9803044199943542, avg_entr 0.024483075365424156
ep4_t0.3_test_time 0.26104307174682617
gc 0
Train Epoch5 Acc 0.251325 (30159/120000), AUC 0.6153687238693237
ep5_train_time 9.165956735610962
Test Epoch5 threshold 0.3 Acc 0.9139802631578947, AUC 0.9801665544509888, avg_entr 0.025455793365836143
ep5_t0.3_test_time 0.26253414154052734
gc 0
Train Epoch6 Acc 0.250975 (30117/120000), AUC 0.5901609659194946
ep6_train_time 8.97288966178894
Test Epoch6 threshold 0.3 Acc 0.9123355263157895, AUC 0.9799525141716003, avg_entr 0.02607276849448681
ep6_t0.3_test_time 0.26270461082458496
gc 0
Train Epoch7 Acc 0.25075833333333336 (30091/120000), AUC 0.5531820058822632
ep7_train_time 9.013422012329102
Test Epoch7 threshold 0.3 Acc 0.9120065789473685, AUC 0.9798917770385742, avg_entr 0.024835165590047836
ep7_t0.3_test_time 0.25989460945129395
gc 0
Train Epoch8 Acc 0.25095 (30114/120000), AUC 0.5322026014328003
ep8_train_time 8.9717698097229
Test Epoch8 threshold 0.3 Acc 0.9125, AUC 0.9797744154930115, avg_entr 0.024905717000365257
ep8_t0.3_test_time 0.2571249008178711
gc 0
Train Epoch9 Acc 0.251075 (30129/120000), AUC 0.5221916437149048
ep9_train_time 9.019402503967285
Test Epoch9 threshold 0.3 Acc 0.9120065789473685, AUC 0.9797552227973938, avg_entr 0.02530217356979847
ep9_t0.3_test_time 0.25769853591918945
Best AUC 0.9808204770088196
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9236842105263158, AUC 0.9857205152511597, avg_entr 0.02423459105193615
t0.3_test_time 0.06655335426330566
