total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9357 (112284/120000), AUC 0.9879997968673706
ep0_train_time 10.352830410003662
Test Epoch0 threshold 0.4 Acc 0.9154605263157894, AUC 0.9805862903594971, avg_entr 0.0250055193901062
ep0_t0.4_test_time 0.256911039352417
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.94945 (113934/120000), AUC 0.9930580854415894
ep1_train_time 9.910305261611938
Test Epoch1 threshold 0.4 Acc 0.9151315789473684, AUC 0.980384111404419, avg_entr 0.024959752336144447
ep1_t0.4_test_time 0.2548370361328125
gc 0
Train Epoch2 Acc 0.9508083333333334 (114097/120000), AUC 0.9933478832244873
ep2_train_time 10.065722942352295
Test Epoch2 threshold 0.4 Acc 0.9134868421052632, AUC 0.9803004264831543, avg_entr 0.024561580270528793
ep2_t0.4_test_time 0.2552652359008789
gc 0
Train Epoch3 Acc 0.9518083333333334 (114217/120000), AUC 0.9934893250465393
ep3_train_time 9.985535383224487
Test Epoch3 threshold 0.4 Acc 0.9146381578947368, AUC 0.9802585244178772, avg_entr 0.02530326321721077
ep3_t0.4_test_time 0.2563014030456543
gc 0
Train Epoch4 Acc 0.9531 (114372/120000), AUC 0.9939720630645752
ep4_train_time 9.816532135009766
Test Epoch4 threshold 0.4 Acc 0.9111842105263158, AUC 0.9800000786781311, avg_entr 0.025128742679953575
ep4_t0.4_test_time 0.25428199768066406
gc 0
Train Epoch5 Acc 0.9547583333333334 (114571/120000), AUC 0.9946167469024658
ep5_train_time 10.005624055862427
Test Epoch5 threshold 0.4 Acc 0.9139802631578947, AUC 0.9800286293029785, avg_entr 0.02567654848098755
ep5_t0.4_test_time 0.25525498390197754
gc 0
Train Epoch6 Acc 0.9555416666666666 (114665/120000), AUC 0.9947869777679443
ep6_train_time 9.941070318222046
Test Epoch6 threshold 0.4 Acc 0.9113486842105263, AUC 0.9799207448959351, avg_entr 0.02558666281402111
ep6_t0.4_test_time 0.25464534759521484
gc 0
Train Epoch7 Acc 0.9559 (114708/120000), AUC 0.9949490427970886
ep7_train_time 9.857298851013184
Test Epoch7 threshold 0.4 Acc 0.9131578947368421, AUC 0.9797917604446411, avg_entr 0.02552417293190956
ep7_t0.4_test_time 0.2524740695953369
gc 0
Train Epoch8 Acc 0.9563833333333334 (114766/120000), AUC 0.9950437545776367
ep8_train_time 9.99254322052002
Test Epoch8 threshold 0.4 Acc 0.9118421052631579, AUC 0.9796923398971558, avg_entr 0.026126399636268616
ep8_t0.4_test_time 0.253368616104126
gc 0
Train Epoch9 Acc 0.9571666666666667 (114860/120000), AUC 0.9952244758605957
ep9_train_time 9.897192239761353
Test Epoch9 threshold 0.4 Acc 0.9125, AUC 0.9795820713043213, avg_entr 0.02543291263282299
ep9_t0.4_test_time 0.25322532653808594
Best AUC 0.9805862903594971
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9230263157894737, AUC 0.9862744808197021, avg_entr 0.02422676607966423
t0.4_test_time 0.06751346588134766
