total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2512333333333333 (30148/120000), AUC 0.5426765084266663
ep0_train_time 5.879154205322266
Test Epoch0 threshold 0.9 Acc 0.9074013157894737, AUC 0.976801335811615, avg_entr 0.16122594475746155
ep0_t0.9_test_time 0.13390898704528809
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.250625 (30075/120000), AUC 0.5463889241218567
ep1_train_time 5.446041822433472
Test Epoch1 threshold 0.9 Acc 0.9148026315789474, AUC 0.9794578552246094, avg_entr 0.09664665162563324
ep1_t0.9_test_time 0.13210535049438477
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25024166666666664 (30029/120000), AUC 0.5458251237869263
ep2_train_time 5.577031373977661
Test Epoch2 threshold 0.9 Acc 0.9164473684210527, AUC 0.9804967641830444, avg_entr 0.076075978577137
ep2_t0.9_test_time 0.13269829750061035
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24996666666666667 (29996/120000), AUC 0.5447286367416382
ep3_train_time 5.400424957275391
Test Epoch3 threshold 0.9 Acc 0.9141447368421053, AUC 0.9806046485900879, avg_entr 0.0666508823633194
ep3_t0.9_test_time 0.13243961334228516
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.5450136661529541
ep4_train_time 5.421861410140991
Test Epoch4 threshold 0.9 Acc 0.9164473684210527, AUC 0.98037189245224, avg_entr 0.05799652263522148
ep4_t0.9_test_time 0.13211655616760254
gc 0
Train Epoch5 Acc 0.24981666666666666 (29978/120000), AUC 0.5452165007591248
ep5_train_time 5.422393560409546
Test Epoch5 threshold 0.9 Acc 0.9171052631578948, AUC 0.9803318977355957, avg_entr 0.05335209518671036
ep5_t0.9_test_time 0.13242769241333008
gc 0
Train Epoch6 Acc 0.24985833333333332 (29983/120000), AUC 0.5459014773368835
ep6_train_time 5.459252595901489
Test Epoch6 threshold 0.9 Acc 0.912828947368421, AUC 0.9800047874450684, avg_entr 0.04987937584519386
ep6_t0.9_test_time 0.1386425495147705
gc 0
Train Epoch7 Acc 0.24985 (29982/120000), AUC 0.5466599464416504
ep7_train_time 5.469445466995239
Test Epoch7 threshold 0.9 Acc 0.9144736842105263, AUC 0.9799791574478149, avg_entr 0.046558283269405365
ep7_t0.9_test_time 0.1322188377380371
gc 0
Train Epoch8 Acc 0.2498 (29976/120000), AUC 0.5477497577667236
ep8_train_time 5.476816177368164
Test Epoch8 threshold 0.9 Acc 0.9134868421052632, AUC 0.9797999858856201, avg_entr 0.04436161741614342
ep8_t0.9_test_time 0.13196754455566406
gc 0
Train Epoch9 Acc 0.24986666666666665 (29984/120000), AUC 0.5470138788223267
ep9_train_time 5.523742198944092
Test Epoch9 threshold 0.9 Acc 0.9143092105263158, AUC 0.9796724915504456, avg_entr 0.043142493814229965
ep9_t0.9_test_time 0.13170361518859863
Best AUC 0.9806046485900879
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.9_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9276315789473685, AUC 0.9862465858459473, avg_entr 0.06915201246738434
t0.9_test_time 0.034264326095581055
