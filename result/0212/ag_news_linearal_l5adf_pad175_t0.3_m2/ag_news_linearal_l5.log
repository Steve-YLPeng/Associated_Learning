total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.2505 (30060/120000), AUC 0.4414560794830322
ep0_train_time 8.973651647567749
Test Epoch0 threshold 0.3 Acc 0.9180921052631579, AUC 0.9809519052505493, avg_entr 0.026690872386097908
ep0_t0.3_test_time 0.25789356231689453
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25004166666666666 (30005/120000), AUC 0.3803127110004425
ep1_train_time 8.597489595413208
Test Epoch1 threshold 0.3 Acc 0.9169407894736842, AUC 0.9808023571968079, avg_entr 0.025545215234160423
ep1_t0.3_test_time 0.2555234432220459
gc 0
Train Epoch2 Acc 0.25006666666666666 (30008/120000), AUC 0.37557196617126465
ep2_train_time 8.493992328643799
Test Epoch2 threshold 0.3 Acc 0.9167763157894737, AUC 0.9807204008102417, avg_entr 0.025424698367714882
ep2_t0.3_test_time 0.2554168701171875
gc 0
Train Epoch3 Acc 0.25003333333333333 (30004/120000), AUC 0.3711133301258087
ep3_train_time 8.648698806762695
Test Epoch3 threshold 0.3 Acc 0.9151315789473684, AUC 0.9804911613464355, avg_entr 0.025869281962513924
ep3_t0.3_test_time 0.25424671173095703
gc 0
Train Epoch4 Acc 0.249975 (29997/120000), AUC 0.37248024344444275
ep4_train_time 8.71023154258728
Test Epoch4 threshold 0.3 Acc 0.9116776315789473, AUC 0.9804491996765137, avg_entr 0.025260427966713905
ep4_t0.3_test_time 0.25588464736938477
gc 0
Train Epoch5 Acc 0.250125 (30015/120000), AUC 0.37321504950523376
ep5_train_time 8.489540100097656
Test Epoch5 threshold 0.3 Acc 0.9148026315789474, AUC 0.9801965355873108, avg_entr 0.025523072108626366
ep5_t0.3_test_time 0.25413036346435547
gc 0
Train Epoch6 Acc 0.24976666666666666 (29972/120000), AUC 0.3736814260482788
ep6_train_time 8.56488037109375
Test Epoch6 threshold 0.3 Acc 0.9139802631578947, AUC 0.9801516532897949, avg_entr 0.025695590302348137
ep6_t0.3_test_time 0.2543196678161621
gc 0
Train Epoch7 Acc 0.24943333333333334 (29932/120000), AUC 0.37434542179107666
ep7_train_time 8.499253749847412
Test Epoch7 threshold 0.3 Acc 0.9129934210526316, AUC 0.9799851179122925, avg_entr 0.025565950199961662
ep7_t0.3_test_time 0.25370049476623535
gc 0
Train Epoch8 Acc 0.248525 (29823/120000), AUC 0.37531009316444397
ep8_train_time 8.524833679199219
Test Epoch8 threshold 0.3 Acc 0.9139802631578947, AUC 0.9799530506134033, avg_entr 0.026306888088583946
ep8_t0.3_test_time 0.25394248962402344
gc 0
Train Epoch9 Acc 0.24765833333333334 (29719/120000), AUC 0.37546876072883606
ep9_train_time 8.458064317703247
Test Epoch9 threshold 0.3 Acc 0.9136513157894737, AUC 0.9798860549926758, avg_entr 0.025580348446965218
ep9_t0.3_test_time 0.25549936294555664
Best AUC 0.9809519052505493
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9269736842105263, AUC 0.9861419796943665, avg_entr 0.0265274066478014
t0.3_test_time 0.06482696533203125
