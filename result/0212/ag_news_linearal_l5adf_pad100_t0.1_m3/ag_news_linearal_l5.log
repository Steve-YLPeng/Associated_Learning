total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.1_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.4672 (56064/120000), AUC 0.5918188095092773
ep0_train_time 8.302479267120361
Test Epoch0 threshold 0.1 Acc 0.9174342105263158, AUC 0.9804852604866028, avg_entr 0.025653338059782982
ep0_t0.1_test_time 0.19126319885253906
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.1_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3893666666666667 (46724/120000), AUC 0.6275149583816528
ep1_train_time 7.61848258972168
Test Epoch1 threshold 0.1 Acc 0.9134868421052632, AUC 0.9803171753883362, avg_entr 0.024336373433470726
ep1_t0.1_test_time 0.17695164680480957
gc 0
Train Epoch2 Acc 0.344925 (41391/120000), AUC 0.6658394932746887
ep2_train_time 6.898431777954102
Test Epoch2 threshold 0.1 Acc 0.9131578947368421, AUC 0.9801046252250671, avg_entr 0.024019284173846245
ep2_t0.1_test_time 0.1762077808380127
gc 0
Train Epoch3 Acc 0.36589166666666667 (43907/120000), AUC 0.6638388633728027
ep3_train_time 6.935616493225098
Test Epoch3 threshold 0.1 Acc 0.9120065789473685, AUC 0.9796385765075684, avg_entr 0.02482171729207039
ep3_t0.1_test_time 0.17686033248901367
gc 0
Train Epoch4 Acc 0.432525 (51903/120000), AUC 0.6099194288253784
ep4_train_time 6.875093936920166
Test Epoch4 threshold 0.1 Acc 0.9123355263157895, AUC 0.9795928001403809, avg_entr 0.021982284262776375
ep4_t0.1_test_time 0.1765134334564209
gc 0
Train Epoch5 Acc 0.4665 (55980/120000), AUC 0.5952706336975098
ep5_train_time 6.8405609130859375
Test Epoch5 threshold 0.1 Acc 0.9134868421052632, AUC 0.9795701503753662, avg_entr 0.022604232653975487
ep5_t0.1_test_time 0.17714333534240723
gc 0
Train Epoch6 Acc 0.47345 (56814/120000), AUC 0.5919842720031738
ep6_train_time 6.836933612823486
Test Epoch6 threshold 0.1 Acc 0.9138157894736842, AUC 0.9794856309890747, avg_entr 0.02152591198682785
ep6_t0.1_test_time 0.1774282455444336
gc 0
Train Epoch7 Acc 0.478975 (57477/120000), AUC 0.5841480493545532
ep7_train_time 6.869795799255371
Test Epoch7 threshold 0.1 Acc 0.9134868421052632, AUC 0.9792971014976501, avg_entr 0.020691996440291405
ep7_t0.1_test_time 0.17730998992919922
gc 0
Train Epoch8 Acc 0.4820583333333333 (57847/120000), AUC 0.5742786526679993
ep8_train_time 7.663808107376099
Test Epoch8 threshold 0.1 Acc 0.9123355263157895, AUC 0.979215145111084, avg_entr 0.019693482667207718
ep8_t0.1_test_time 0.188370943069458
gc 0
Train Epoch9 Acc 0.4834 (58008/120000), AUC 0.5671876668930054
ep9_train_time 7.806634187698364
Test Epoch9 threshold 0.1 Acc 0.912828947368421, AUC 0.9791426062583923, avg_entr 0.01917997933924198
ep9_t0.1_test_time 0.17706918716430664
Best AUC 0.9804852604866028
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.1_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9223684210526316, AUC 0.9861713647842407, avg_entr 0.026140769943594933
t0.1_test_time 0.04553675651550293
