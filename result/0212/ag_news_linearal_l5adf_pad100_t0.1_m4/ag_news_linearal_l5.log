total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.1_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.23396666666666666 (28076/120000), AUC 0.5981355905532837
ep0_train_time 7.771026849746704
Test Epoch0 threshold 0.1 Acc 0.9139802631578947, AUC 0.9803500771522522, avg_entr 0.02410351112484932
ep0_t0.1_test_time 0.18482327461242676
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.1_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.152675 (18321/120000), AUC 0.4962024986743927
ep1_train_time 7.38856840133667
Test Epoch1 threshold 0.1 Acc 0.9159539473684211, AUC 0.9802282452583313, avg_entr 0.022961493581533432
ep1_t0.1_test_time 0.18299269676208496
gc 0
Train Epoch2 Acc 0.16788333333333333 (20146/120000), AUC 0.3853282332420349
ep2_train_time 7.408935785293579
Test Epoch2 threshold 0.1 Acc 0.9148026315789474, AUC 0.9799289703369141, avg_entr 0.01975417695939541
ep2_t0.1_test_time 0.1828455924987793
gc 0
Train Epoch3 Acc 0.29738333333333333 (35686/120000), AUC 0.3497454822063446
ep3_train_time 8.406271696090698
Test Epoch3 threshold 0.1 Acc 0.9121710526315789, AUC 0.979949951171875, avg_entr 0.016621321439743042
ep3_t0.1_test_time 0.19657444953918457
gc 0
Train Epoch4 Acc 0.2977666666666667 (35732/120000), AUC 0.3984526991844177
ep4_train_time 8.093500852584839
Test Epoch4 threshold 0.1 Acc 0.9120065789473685, AUC 0.9795420169830322, avg_entr 0.013163850642740726
ep4_t0.1_test_time 0.1827406883239746
gc 0
Train Epoch5 Acc 0.2976 (35712/120000), AUC 0.41193512082099915
ep5_train_time 7.349423885345459
Test Epoch5 threshold 0.1 Acc 0.9129934210526316, AUC 0.9791887402534485, avg_entr 0.012415150180459023
ep5_t0.1_test_time 0.18326330184936523
gc 0
Train Epoch6 Acc 0.2966666666666667 (35600/120000), AUC 0.4116833806037903
ep6_train_time 7.375989675521851
Test Epoch6 threshold 0.1 Acc 0.912828947368421, AUC 0.9790107607841492, avg_entr 0.012354236096143723
ep6_t0.1_test_time 0.1835646629333496
gc 0
Train Epoch7 Acc 0.2956166666666667 (35474/120000), AUC 0.4121706783771515
ep7_train_time 7.470284461975098
Test Epoch7 threshold 0.1 Acc 0.9115131578947369, AUC 0.978915274143219, avg_entr 0.012243696488440037
ep7_t0.1_test_time 0.18416714668273926
gc 0
Train Epoch8 Acc 0.29465 (35358/120000), AUC 0.4125833511352539
ep8_train_time 7.4363789558410645
Test Epoch8 threshold 0.1 Acc 0.9118421052631579, AUC 0.9788978099822998, avg_entr 0.011901983059942722
ep8_t0.1_test_time 0.18308448791503906
gc 0
Train Epoch9 Acc 0.29385 (35262/120000), AUC 0.4128963053226471
ep9_train_time 7.442788362503052
Test Epoch9 threshold 0.1 Acc 0.9121710526315789, AUC 0.9787526726722717, avg_entr 0.011534251272678375
ep9_t0.1_test_time 0.18322968482971191
Best AUC 0.9803500771522522
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.1_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9236842105263158, AUC 0.9858315587043762, avg_entr 0.02385503612458706
t0.1_test_time 0.04662013053894043
