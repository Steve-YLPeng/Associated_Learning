total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.3_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.198325 (23799/120000), AUC 0.44439956545829773
ep0_train_time 6.342686176300049
Test Epoch0 threshold 0.3 Acc 0.915296052631579, AUC 0.9807313084602356, avg_entr 0.030990375205874443
ep0_t0.3_test_time 0.1428835391998291
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.3_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.208725 (25047/120000), AUC 0.3753495216369629
ep1_train_time 5.899231672286987
Test Epoch1 threshold 0.3 Acc 0.9139802631578947, AUC 0.980290412902832, avg_entr 0.027985231950879097
ep1_t0.3_test_time 0.14014077186584473
gc 0
Train Epoch2 Acc 0.21649166666666667 (25979/120000), AUC 0.3668501675128937
ep2_train_time 5.891862869262695
Test Epoch2 threshold 0.3 Acc 0.9141447368421053, AUC 0.9801135063171387, avg_entr 0.02582773193717003
ep2_t0.3_test_time 0.1414046287536621
gc 0
Train Epoch3 Acc 0.230675 (27681/120000), AUC 0.3626111149787903
ep3_train_time 5.89323091506958
Test Epoch3 threshold 0.3 Acc 0.9149671052631579, AUC 0.9800214171409607, avg_entr 0.02594047412276268
ep3_t0.3_test_time 0.13917851448059082
gc 0
Train Epoch4 Acc 0.25585 (30702/120000), AUC 0.3612937331199646
ep4_train_time 5.910565614700317
Test Epoch4 threshold 0.3 Acc 0.9131578947368421, AUC 0.9796890020370483, avg_entr 0.026273909956216812
ep4_t0.3_test_time 0.13848352432250977
gc 0
Train Epoch5 Acc 0.2798583333333333 (33583/120000), AUC 0.36134064197540283
ep5_train_time 5.911316871643066
Test Epoch5 threshold 0.3 Acc 0.9131578947368421, AUC 0.9798597097396851, avg_entr 0.025928156450390816
ep5_t0.3_test_time 0.13935089111328125
gc 0
Train Epoch6 Acc 0.2927 (35124/120000), AUC 0.36298608779907227
ep6_train_time 5.926973581314087
Test Epoch6 threshold 0.3 Acc 0.9113486842105263, AUC 0.9796605110168457, avg_entr 0.026395687833428383
ep6_t0.3_test_time 0.13770031929016113
gc 0
Train Epoch7 Acc 0.30295 (36354/120000), AUC 0.3649813234806061
ep7_train_time 5.888646602630615
Test Epoch7 threshold 0.3 Acc 0.9105263157894737, AUC 0.9793397188186646, avg_entr 0.02609827369451523
ep7_t0.3_test_time 0.13878703117370605
gc 0
Train Epoch8 Acc 0.3123166666666667 (37478/120000), AUC 0.36762621998786926
ep8_train_time 5.909665107727051
Test Epoch8 threshold 0.3 Acc 0.9105263157894737, AUC 0.979225754737854, avg_entr 0.026096738874912262
ep8_t0.3_test_time 0.13694334030151367
gc 0
Train Epoch9 Acc 0.31795 (38154/120000), AUC 0.3691505193710327
ep9_train_time 5.897146224975586
Test Epoch9 threshold 0.3 Acc 0.9111842105263158, AUC 0.9791398048400879, avg_entr 0.026260290294885635
ep9_t0.3_test_time 0.13907241821289062
Best AUC 0.9807313084602356
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.3_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.925, AUC 0.9862529039382935, avg_entr 0.031940262764692307
t0.3_test_time 0.035791635513305664
