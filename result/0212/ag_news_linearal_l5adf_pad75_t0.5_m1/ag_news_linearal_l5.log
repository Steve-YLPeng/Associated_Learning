total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.3002666666666667 (36032/120000), AUC 0.5311902165412903
ep0_train_time 5.618849992752075
Test Epoch0 threshold 0.5 Acc 0.9077302631578947, AUC 0.9766913652420044, avg_entr 0.1627875119447708
ep0_t0.5_test_time 0.13377737998962402
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3127 (37524/120000), AUC 0.5673863887786865
ep1_train_time 5.209157228469849
Test Epoch1 threshold 0.5 Acc 0.9143092105263158, AUC 0.9795709252357483, avg_entr 0.09882921725511551
ep1_t0.5_test_time 0.1331770420074463
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.311 (37320/120000), AUC 0.5698955059051514
ep2_train_time 5.2205259799957275
Test Epoch2 threshold 0.5 Acc 0.9144736842105263, AUC 0.9803415536880493, avg_entr 0.07750362902879715
ep2_t0.5_test_time 0.13278865814208984
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.3054 (36648/120000), AUC 0.5690147280693054
ep3_train_time 5.188191652297974
Test Epoch3 threshold 0.5 Acc 0.915625, AUC 0.9808051586151123, avg_entr 0.06918711960315704
ep3_t0.5_test_time 0.13195586204528809
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.2986083333333333 (35833/120000), AUC 0.5675138235092163
ep4_train_time 5.230884790420532
Test Epoch4 threshold 0.5 Acc 0.9148026315789474, AUC 0.9805579781532288, avg_entr 0.05842098966240883
ep4_t0.5_test_time 0.13246726989746094
gc 0
Train Epoch5 Acc 0.28933333333333333 (34720/120000), AUC 0.5660678148269653
ep5_train_time 5.227294921875
Test Epoch5 threshold 0.5 Acc 0.9159539473684211, AUC 0.9805194735527039, avg_entr 0.05338325351476669
ep5_t0.5_test_time 0.13235688209533691
gc 0
Train Epoch6 Acc 0.27934166666666665 (33521/120000), AUC 0.5650705099105835
ep6_train_time 5.310732364654541
Test Epoch6 threshold 0.5 Acc 0.9149671052631579, AUC 0.98033207654953, avg_entr 0.05069909989833832
ep6_t0.5_test_time 0.13464879989624023
gc 0
Train Epoch7 Acc 0.2702333333333333 (32428/120000), AUC 0.5642581582069397
ep7_train_time 5.558618545532227
Test Epoch7 threshold 0.5 Acc 0.9141447368421053, AUC 0.9801057577133179, avg_entr 0.0456811860203743
ep7_t0.5_test_time 0.1377100944519043
gc 0
Train Epoch8 Acc 0.26576666666666665 (31892/120000), AUC 0.563787043094635
ep8_train_time 5.529686212539673
Test Epoch8 threshold 0.5 Acc 0.9136513157894737, AUC 0.9798625111579895, avg_entr 0.04430180415511131
ep8_t0.5_test_time 0.1324770450592041
gc 0
Train Epoch9 Acc 0.26335833333333336 (31603/120000), AUC 0.5628089904785156
ep9_train_time 5.188839673995972
Test Epoch9 threshold 0.5 Acc 0.9138157894736842, AUC 0.9796872138977051, avg_entr 0.04295607656240463
ep9_t0.5_test_time 0.13254976272583008
Best AUC 0.9808051586151123
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.5_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9276315789473685, AUC 0.9863904118537903, avg_entr 0.07252994179725647
t0.5_test_time 0.033832550048828125
