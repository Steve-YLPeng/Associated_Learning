total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2598 (31176/120000), AUC 0.5075852870941162
ep0_train_time 4.3370749950408936
Test Epoch0 threshold 0.8 Acc 0.9087171052631579, AUC 0.9793407917022705, avg_entr 0.1494356244802475
ep0_t0.8_test_time 0.08121967315673828
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2569666666666667 (30836/120000), AUC 0.509259819984436
ep1_train_time 3.8622729778289795
Test Epoch1 threshold 0.8 Acc 0.9123355263157895, AUC 0.9807631373405457, avg_entr 0.09381115436553955
ep1_t0.8_test_time 0.07224655151367188
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25543333333333335 (30652/120000), AUC 0.5082573294639587
ep2_train_time 3.8624117374420166
Test Epoch2 threshold 0.8 Acc 0.9118421052631579, AUC 0.9808130860328674, avg_entr 0.07591879367828369
ep2_t0.8_test_time 0.07197356224060059
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25430833333333336 (30517/120000), AUC 0.5075656771659851
ep3_train_time 3.8868942260742188
Test Epoch3 threshold 0.8 Acc 0.9111842105263158, AUC 0.9810599684715271, avg_entr 0.06541851162910461
ep3_t0.8_test_time 0.07227182388305664
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25356666666666666 (30428/120000), AUC 0.506989598274231
ep4_train_time 3.8180813789367676
Test Epoch4 threshold 0.8 Acc 0.9116776315789473, AUC 0.9803944230079651, avg_entr 0.05902553349733353
ep4_t0.8_test_time 0.07173681259155273
gc 0
Train Epoch5 Acc 0.2526583333333333 (30319/120000), AUC 0.5062481760978699
ep5_train_time 3.840771436691284
Test Epoch5 threshold 0.8 Acc 0.9110197368421052, AUC 0.9803640842437744, avg_entr 0.053138814866542816
ep5_t0.8_test_time 0.07237696647644043
gc 0
Train Epoch6 Acc 0.25204166666666666 (30245/120000), AUC 0.5052852630615234
ep6_train_time 3.8648812770843506
Test Epoch6 threshold 0.8 Acc 0.9113486842105263, AUC 0.9801578521728516, avg_entr 0.0496499203145504
ep6_t0.8_test_time 0.0734550952911377
gc 0
Train Epoch7 Acc 0.251225 (30147/120000), AUC 0.5042192935943604
ep7_train_time 3.840698003768921
Test Epoch7 threshold 0.8 Acc 0.9115131578947369, AUC 0.9800594449043274, avg_entr 0.04629033803939819
ep7_t0.8_test_time 0.07184100151062012
gc 0
Train Epoch8 Acc 0.250675 (30081/120000), AUC 0.5038771629333496
ep8_train_time 3.864690065383911
Test Epoch8 threshold 0.8 Acc 0.9101973684210526, AUC 0.9794156551361084, avg_entr 0.04441721737384796
ep8_t0.8_test_time 0.07345294952392578
gc 0
Train Epoch9 Acc 0.250175 (30021/120000), AUC 0.5039685964584351
ep9_train_time 3.872695207595825
Test Epoch9 threshold 0.8 Acc 0.9097039473684211, AUC 0.9796760678291321, avg_entr 0.0428382083773613
ep9_t0.8_test_time 0.07184696197509766
Best AUC 0.9810599684715271
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.8_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9184210526315789, AUC 0.9852309823036194, avg_entr 0.06897008419036865
t0.8_test_time 0.018846511840820312
