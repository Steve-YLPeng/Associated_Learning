total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.188475 (22617/120000), AUC 0.3763577342033386
ep0_train_time 6.500133991241455
Test Epoch0 threshold 0.8 Acc 0.9055921052631579, AUC 0.9758899211883545, avg_entr 0.16790993511676788
ep0_t0.8_test_time 0.16613388061523438
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.16225 (19470/120000), AUC 0.3316792845726013
ep1_train_time 5.940029621124268
Test Epoch1 threshold 0.8 Acc 0.9138157894736842, AUC 0.9791355729103088, avg_entr 0.10111872106790543
ep1_t0.8_test_time 0.1651461124420166
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.15998333333333334 (19198/120000), AUC 0.3316827118396759
ep2_train_time 5.987368822097778
Test Epoch2 threshold 0.8 Acc 0.9166118421052631, AUC 0.9801357984542847, avg_entr 0.07733465731143951
ep2_t0.8_test_time 0.16412734985351562
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.15448333333333333 (18538/120000), AUC 0.33327120542526245
ep3_train_time 5.907858610153198
Test Epoch3 threshold 0.8 Acc 0.9161184210526315, AUC 0.9805903434753418, avg_entr 0.06607602536678314
ep3_t0.8_test_time 0.16381335258483887
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.14685 (17622/120000), AUC 0.3349027633666992
ep4_train_time 5.9158995151519775
Test Epoch4 threshold 0.8 Acc 0.9159539473684211, AUC 0.9805576205253601, avg_entr 0.05955890193581581
ep4_t0.8_test_time 0.1654675006866455
gc 0
Train Epoch5 Acc 0.13960833333333333 (16753/120000), AUC 0.3362874984741211
ep5_train_time 5.859435796737671
Test Epoch5 threshold 0.8 Acc 0.9144736842105263, AUC 0.9805777668952942, avg_entr 0.05440306290984154
ep5_t0.8_test_time 0.16506528854370117
gc 0
Train Epoch6 Acc 0.13213333333333332 (15856/120000), AUC 0.3373374342918396
ep6_train_time 5.914847373962402
Test Epoch6 threshold 0.8 Acc 0.9162828947368421, AUC 0.9805008172988892, avg_entr 0.04947083443403244
ep6_t0.8_test_time 0.1649024486541748
gc 0
Train Epoch7 Acc 0.125975 (15117/120000), AUC 0.3380734920501709
ep7_train_time 5.854726076126099
Test Epoch7 threshold 0.8 Acc 0.9149671052631579, AUC 0.9802226424217224, avg_entr 0.04643191397190094
ep7_t0.8_test_time 0.16656756401062012
gc 0
Train Epoch8 Acc 0.12284166666666667 (14741/120000), AUC 0.33843034505844116
ep8_train_time 5.900768041610718
Test Epoch8 threshold 0.8 Acc 0.9149671052631579, AUC 0.9800911545753479, avg_entr 0.044443532824516296
ep8_t0.8_test_time 0.1651313304901123
gc 0
Train Epoch9 Acc 0.122025 (14643/120000), AUC 0.33910682797431946
ep9_train_time 6.02827000617981
Test Epoch9 threshold 0.8 Acc 0.9134868421052632, AUC 0.9799478650093079, avg_entr 0.043010491877794266
ep9_t0.8_test_time 0.16463303565979004
Best AUC 0.9805903434753418
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.8_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9243421052631579, AUC 0.9866498708724976, avg_entr 0.06914399564266205
t0.8_test_time 0.0430147647857666
