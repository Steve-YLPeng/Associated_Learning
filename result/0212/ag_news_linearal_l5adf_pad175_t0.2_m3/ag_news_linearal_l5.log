total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.07691666666666666 (9230/120000), AUC 0.45444533228874207
ep0_train_time 9.357769012451172
Test Epoch0 threshold 0.2 Acc 0.9166118421052631, AUC 0.9806661605834961, avg_entr 0.024239234626293182
ep0_t0.2_test_time 0.26537299156188965
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.053908333333333336 (6469/120000), AUC 0.4858006238937378
ep1_train_time 8.969464302062988
Test Epoch1 threshold 0.2 Acc 0.9159539473684211, AUC 0.9804463386535645, avg_entr 0.024950429797172546
ep1_t0.2_test_time 0.26340556144714355
gc 0
Train Epoch2 Acc 0.055808333333333335 (6697/120000), AUC 0.5096710920333862
ep2_train_time 9.02297306060791
Test Epoch2 threshold 0.2 Acc 0.9154605263157894, AUC 0.9803320169448853, avg_entr 0.024065831676125526
ep2_t0.2_test_time 0.2637932300567627
gc 0
Train Epoch3 Acc 0.060608333333333334 (7273/120000), AUC 0.5275301337242126
ep3_train_time 8.93472671508789
Test Epoch3 threshold 0.2 Acc 0.9141447368421053, AUC 0.9803328514099121, avg_entr 0.02367807738482952
ep3_t0.2_test_time 0.26380443572998047
gc 0
Train Epoch4 Acc 0.06363333333333333 (7636/120000), AUC 0.5380616188049316
ep4_train_time 8.968404054641724
Test Epoch4 threshold 0.2 Acc 0.9134868421052632, AUC 0.9800647497177124, avg_entr 0.02405320480465889
ep4_t0.2_test_time 0.26363444328308105
gc 0
Train Epoch5 Acc 0.0633 (7596/120000), AUC 0.541504442691803
ep5_train_time 9.01019024848938
Test Epoch5 threshold 0.2 Acc 0.9136513157894737, AUC 0.9799405336380005, avg_entr 0.022747598588466644
ep5_t0.2_test_time 0.2631337642669678
gc 0
Train Epoch6 Acc 0.06895 (8274/120000), AUC 0.5453805327415466
ep6_train_time 9.183019638061523
Test Epoch6 threshold 0.2 Acc 0.9123355263157895, AUC 0.9798723459243774, avg_entr 0.022472243756055832
ep6_t0.2_test_time 0.2639749050140381
gc 0
Train Epoch7 Acc 0.08340833333333333 (10009/120000), AUC 0.559302031993866
ep7_train_time 9.067935705184937
Test Epoch7 threshold 0.2 Acc 0.912828947368421, AUC 0.9797932505607605, avg_entr 0.021209577098488808
ep7_t0.2_test_time 0.2641932964324951
gc 0
Train Epoch8 Acc 0.1141 (13692/120000), AUC 0.5925812125205994
ep8_train_time 9.08247184753418
Test Epoch8 threshold 0.2 Acc 0.912828947368421, AUC 0.9796357750892639, avg_entr 0.020817343145608902
ep8_t0.2_test_time 0.2631111145019531
gc 0
Train Epoch9 Acc 0.13626666666666667 (16352/120000), AUC 0.6273478269577026
ep9_train_time 8.987806797027588
Test Epoch9 threshold 0.2 Acc 0.9123355263157895, AUC 0.9796501398086548, avg_entr 0.02018670178949833
ep9_t0.2_test_time 0.26385021209716797
Best AUC 0.9806661605834961
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9243421052631579, AUC 0.9861904382705688, avg_entr 0.024065900593996048
t0.2_test_time 0.06663918495178223
