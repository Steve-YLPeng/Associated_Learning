total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.6_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9240583333333333 (110887/120000), AUC 0.9857039451599121
ep0_train_time 7.889719724655151
Test Epoch0 threshold 0.6 Acc 0.9141447368421053, AUC 0.98044753074646, avg_entr 0.025297202169895172
ep0_t0.6_test_time 0.1408700942993164
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.6_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9494583333333333 (113935/120000), AUC 0.9929800033569336
ep1_train_time 7.417356491088867
Test Epoch1 threshold 0.6 Acc 0.9120065789473685, AUC 0.9801837205886841, avg_entr 0.025353090837597847
ep1_t0.6_test_time 0.13119888305664062
gc 0
Train Epoch2 Acc 0.9509916666666667 (114119/120000), AUC 0.9932537078857422
ep2_train_time 7.492768287658691
Test Epoch2 threshold 0.6 Acc 0.9131578947368421, AUC 0.9800941944122314, avg_entr 0.025679191574454308
ep2_t0.6_test_time 0.13160133361816406
gc 0
Train Epoch3 Acc 0.9521166666666666 (114254/120000), AUC 0.9933631420135498
ep3_train_time 7.48248815536499
Test Epoch3 threshold 0.6 Acc 0.9113486842105263, AUC 0.9796503782272339, avg_entr 0.026072219014167786
ep3_t0.6_test_time 0.13113808631896973
gc 0
Train Epoch4 Acc 0.9534333333333334 (114412/120000), AUC 0.9936717748641968
ep4_train_time 7.403238296508789
Test Epoch4 threshold 0.6 Acc 0.9111842105263158, AUC 0.9797601699829102, avg_entr 0.025516489520668983
ep4_t0.6_test_time 0.1316547393798828
gc 0
Train Epoch5 Acc 0.9557666666666667 (114692/120000), AUC 0.9946243762969971
ep5_train_time 7.429834842681885
Test Epoch5 threshold 0.6 Acc 0.9105263157894737, AUC 0.9795253276824951, avg_entr 0.02584201842546463
ep5_t0.6_test_time 0.13149142265319824
gc 0
Train Epoch6 Acc 0.9563916666666666 (114767/120000), AUC 0.9947402477264404
ep6_train_time 7.473621368408203
Test Epoch6 threshold 0.6 Acc 0.9106907894736842, AUC 0.9793897867202759, avg_entr 0.0264170840382576
ep6_t0.6_test_time 0.13037776947021484
gc 0
Train Epoch7 Acc 0.9572166666666667 (114866/120000), AUC 0.9949347972869873
ep7_train_time 7.477651834487915
Test Epoch7 threshold 0.6 Acc 0.9105263157894737, AUC 0.9792126417160034, avg_entr 0.025440068915486336
ep7_t0.6_test_time 0.13122248649597168
gc 0
Train Epoch8 Acc 0.957575 (114909/120000), AUC 0.9950684309005737
ep8_train_time 7.414031744003296
Test Epoch8 threshold 0.6 Acc 0.9103618421052632, AUC 0.9791180491447449, avg_entr 0.025313319638371468
ep8_t0.6_test_time 0.13121652603149414
gc 0
Train Epoch9 Acc 0.958775 (115053/120000), AUC 0.9954370856285095
ep9_train_time 7.400412559509277
Test Epoch9 threshold 0.6 Acc 0.9103618421052632, AUC 0.9788978099822998, avg_entr 0.026107316836714745
ep9_t0.6_test_time 0.13132548332214355
Best AUC 0.98044753074646
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.6_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9236842105263158, AUC 0.986100435256958, avg_entr 0.02520960010588169
t0.6_test_time 0.034010887145996094
