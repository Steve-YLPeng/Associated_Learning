total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.16279166666666667 (19535/120000), AUC 0.3680768609046936
ep0_train_time 10.064137697219849
Test Epoch0 threshold 0.9 Acc 0.9172697368421052, AUC 0.9806074500083923, avg_entr 0.026401575654745102
ep0_t0.9_test_time 0.25605106353759766
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2803 (33636/120000), AUC 0.40778008103370667
ep1_train_time 9.897294521331787
Test Epoch1 threshold 0.9 Acc 0.9146381578947368, AUC 0.9805583357810974, avg_entr 0.026591848582029343
ep1_t0.9_test_time 0.2552511692047119
gc 0
Train Epoch2 Acc 0.37161666666666665 (44594/120000), AUC 0.47359785437583923
ep2_train_time 9.562233686447144
Test Epoch2 threshold 0.9 Acc 0.9149671052631579, AUC 0.9804189801216125, avg_entr 0.02540776878595352
ep2_t0.9_test_time 0.25437068939208984
gc 0
Train Epoch3 Acc 0.4716166666666667 (56594/120000), AUC 0.5487948060035706
ep3_train_time 9.51141357421875
Test Epoch3 threshold 0.9 Acc 0.9123355263157895, AUC 0.98033207654953, avg_entr 0.026198098435997963
ep3_t0.9_test_time 0.2546505928039551
gc 0
Train Epoch4 Acc 0.48625833333333335 (58351/120000), AUC 0.565748929977417
ep4_train_time 9.502806901931763
Test Epoch4 threshold 0.9 Acc 0.9133223684210526, AUC 0.9800826907157898, avg_entr 0.02541045844554901
ep4_t0.9_test_time 0.254986047744751
gc 0
Train Epoch5 Acc 0.4877666666666667 (58532/120000), AUC 0.5645111799240112
ep5_train_time 9.623654842376709
Test Epoch5 threshold 0.9 Acc 0.9143092105263158, AUC 0.9800304174423218, avg_entr 0.025560930371284485
ep5_t0.9_test_time 0.25580787658691406
gc 0
Train Epoch6 Acc 0.48795 (58554/120000), AUC 0.5583228468894958
ep6_train_time 9.521477222442627
Test Epoch6 threshold 0.9 Acc 0.9129934210526316, AUC 0.9799349308013916, avg_entr 0.02577001228928566
ep6_t0.9_test_time 0.25438523292541504
gc 0
Train Epoch7 Acc 0.48751666666666665 (58502/120000), AUC 0.5430798530578613
ep7_train_time 9.964446783065796
Test Epoch7 threshold 0.9 Acc 0.9131578947368421, AUC 0.97986900806427, avg_entr 0.02718312293291092
ep7_t0.9_test_time 0.2546234130859375
gc 0
Train Epoch8 Acc 0.48646666666666666 (58376/120000), AUC 0.5253055095672607
ep8_train_time 9.509901762008667
Test Epoch8 threshold 0.9 Acc 0.9115131578947369, AUC 0.979692816734314, avg_entr 0.025885850191116333
ep8_t0.9_test_time 0.2552475929260254
gc 0
Train Epoch9 Acc 0.4851 (58212/120000), AUC 0.513812243938446
ep9_train_time 9.585976600646973
Test Epoch9 threshold 0.9 Acc 0.9143092105263158, AUC 0.9796633720397949, avg_entr 0.026381902396678925
ep9_t0.9_test_time 0.2545785903930664
Best AUC 0.9806074500083923
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9243421052631579, AUC 0.9862045049667358, avg_entr 0.02577074244618416
t0.9_test_time 0.0649871826171875
