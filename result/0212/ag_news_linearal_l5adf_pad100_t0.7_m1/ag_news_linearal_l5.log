total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.5094079375267029
ep0_train_time 6.59485936164856
Test Epoch0 threshold 0.7 Acc 0.9070723684210527, AUC 0.9759697914123535, avg_entr 0.17050781846046448
ep0_t0.7_test_time 0.1641066074371338
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.45444777607917786
ep1_train_time 6.10914421081543
Test Epoch1 threshold 0.7 Acc 0.9118421052631579, AUC 0.9792214632034302, avg_entr 0.10085935145616531
ep1_t0.7_test_time 0.16244745254516602
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.4467428922653198
ep2_train_time 6.132123947143555
Test Epoch2 threshold 0.7 Acc 0.915625, AUC 0.9800353050231934, avg_entr 0.07673216611146927
ep2_t0.7_test_time 0.1630260944366455
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.44641953706741333
ep3_train_time 6.1555304527282715
Test Epoch3 threshold 0.7 Acc 0.9157894736842105, AUC 0.9806474447250366, avg_entr 0.06471050530672073
ep3_t0.7_test_time 0.1611466407775879
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.4472459554672241
ep4_train_time 6.030764579772949
Test Epoch4 threshold 0.7 Acc 0.9154605263157894, AUC 0.9805837273597717, avg_entr 0.05939119681715965
ep4_t0.7_test_time 0.15961575508117676
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.4483851492404938
ep5_train_time 6.125012636184692
Test Epoch5 threshold 0.7 Acc 0.9126644736842106, AUC 0.980494499206543, avg_entr 0.054414764046669006
ep5_t0.7_test_time 0.16109204292297363
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.4496055543422699
ep6_train_time 6.201996088027954
Test Epoch6 threshold 0.7 Acc 0.9144736842105263, AUC 0.9803614616394043, avg_entr 0.04945219308137894
ep6_t0.7_test_time 0.1619734764099121
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.4505983591079712
ep7_train_time 6.17516016960144
Test Epoch7 threshold 0.7 Acc 0.9146381578947368, AUC 0.9801162481307983, avg_entr 0.04717044159770012
ep7_t0.7_test_time 0.1629500389099121
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.45101091265678406
ep8_train_time 6.126310348510742
Test Epoch8 threshold 0.7 Acc 0.9141447368421053, AUC 0.9800731539726257, avg_entr 0.044284891337156296
ep8_t0.7_test_time 0.16242599487304688
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.4516353905200958
ep9_train_time 6.159285068511963
Test Epoch9 threshold 0.7 Acc 0.9143092105263158, AUC 0.9799143075942993, avg_entr 0.042498499155044556
ep9_t0.7_test_time 0.162855863571167
Best AUC 0.9806474447250366
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.7_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9243421052631579, AUC 0.9864321947097778, avg_entr 0.06744291633367538
t0.7_test_time 0.04120659828186035
