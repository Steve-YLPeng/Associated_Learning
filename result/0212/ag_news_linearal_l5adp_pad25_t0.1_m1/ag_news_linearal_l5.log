total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.22885833333333333 (27463/120000), AUC 0.4443633556365967
ep0_train_time 4.331899881362915
Test Epoch0 threshold 0.1 Acc 0.9126644736842106, AUC 0.9796357154846191, avg_entr 0.15063579380512238
ep0_t0.1_test_time 0.07355666160583496
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.22183333333333333 (26620/120000), AUC 0.44076210260391235
ep1_train_time 4.061519622802734
Test Epoch1 threshold 0.1 Acc 0.915625, AUC 0.9813781976699829, avg_entr 0.09597846865653992
ep1_t0.1_test_time 0.07397031784057617
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.21901666666666667 (26282/120000), AUC 0.4411975145339966
ep2_train_time 3.8412327766418457
Test Epoch2 threshold 0.1 Acc 0.9138157894736842, AUC 0.9812014698982239, avg_entr 0.07490368187427521
ep2_t0.1_test_time 0.07103705406188965
gc 0
Train Epoch3 Acc 0.21695 (26034/120000), AUC 0.4412490725517273
ep3_train_time 3.84220552444458
Test Epoch3 threshold 0.1 Acc 0.9138157894736842, AUC 0.9813084602355957, avg_entr 0.06675286591053009
ep3_t0.1_test_time 0.07180428504943848
gc 0
Train Epoch4 Acc 0.21501666666666666 (25802/120000), AUC 0.4412304162979126
ep4_train_time 3.8588368892669678
Test Epoch4 threshold 0.1 Acc 0.9134868421052632, AUC 0.9804949760437012, avg_entr 0.060405902564525604
ep4_t0.1_test_time 0.07114505767822266
gc 0
Train Epoch5 Acc 0.21346666666666667 (25616/120000), AUC 0.4410557746887207
ep5_train_time 3.8247203826904297
Test Epoch5 threshold 0.1 Acc 0.9134868421052632, AUC 0.9802689552307129, avg_entr 0.0534629225730896
ep5_t0.1_test_time 0.07143306732177734
gc 0
Train Epoch6 Acc 0.21320833333333333 (25585/120000), AUC 0.44122985005378723
ep6_train_time 3.841083288192749
Test Epoch6 threshold 0.1 Acc 0.912828947368421, AUC 0.9801033735275269, avg_entr 0.05134555324912071
ep6_t0.1_test_time 0.07206869125366211
gc 0
Train Epoch7 Acc 0.21290833333333334 (25549/120000), AUC 0.4414548873901367
ep7_train_time 3.8484325408935547
Test Epoch7 threshold 0.1 Acc 0.9115131578947369, AUC 0.9797347784042358, avg_entr 0.0491071417927742
ep7_t0.1_test_time 0.07147979736328125
gc 0
Train Epoch8 Acc 0.21291666666666667 (25550/120000), AUC 0.44173407554626465
ep8_train_time 3.832505464553833
Test Epoch8 threshold 0.1 Acc 0.9113486842105263, AUC 0.9795773029327393, avg_entr 0.0468767024576664
ep8_t0.1_test_time 0.07113480567932129
gc 0
Train Epoch9 Acc 0.21270833333333333 (25525/120000), AUC 0.4420394003391266
ep9_train_time 3.833261013031006
Test Epoch9 threshold 0.1 Acc 0.9110197368421052, AUC 0.979401707649231, avg_entr 0.04397328570485115
ep9_t0.1_test_time 0.07082104682922363
Best AUC 0.9813781976699829
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.1_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9230263157894737, AUC 0.9858154654502869, avg_entr 0.10306023061275482
t0.1_test_time 0.018934249877929688
