total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.2_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.2500833333333333 (30010/120000), AUC 0.4975857138633728
ep0_train_time 6.822873115539551
Test Epoch0 threshold 0.2 Acc 0.9174342105263158, AUC 0.9807927012443542, avg_entr 0.027610858902335167
ep0_t0.2_test_time 0.16960668563842773
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.2_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25005 (30006/120000), AUC 0.4927414059638977
ep1_train_time 6.4351489543914795
Test Epoch1 threshold 0.2 Acc 0.9174342105263158, AUC 0.9805498719215393, avg_entr 0.02622050978243351
ep1_t0.2_test_time 0.1682884693145752
gc 0
Train Epoch2 Acc 0.250025 (30003/120000), AUC 0.49156254529953003
ep2_train_time 6.37468409538269
Test Epoch2 threshold 0.2 Acc 0.9148026315789474, AUC 0.9805516600608826, avg_entr 0.0258905291557312
ep2_t0.2_test_time 0.16873526573181152
gc 0
Train Epoch3 Acc 0.250025 (30003/120000), AUC 0.49450522661209106
ep3_train_time 6.40653395652771
Test Epoch3 threshold 0.2 Acc 0.9149671052631579, AUC 0.9803023338317871, avg_entr 0.02560734935104847
ep3_t0.2_test_time 0.16909241676330566
gc 0
Train Epoch4 Acc 0.250025 (30003/120000), AUC 0.49447792768478394
ep4_train_time 6.412401914596558
Test Epoch4 threshold 0.2 Acc 0.9123355263157895, AUC 0.980270504951477, avg_entr 0.025466710329055786
ep4_t0.2_test_time 0.16876721382141113
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.4902018904685974
ep5_train_time 6.469892740249634
Test Epoch5 threshold 0.2 Acc 0.9134868421052632, AUC 0.9800483584403992, avg_entr 0.02583938091993332
ep5_t0.2_test_time 0.169264554977417
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.48587849736213684
ep6_train_time 7.059720754623413
Test Epoch6 threshold 0.2 Acc 0.9139802631578947, AUC 0.9798264503479004, avg_entr 0.025651095435023308
ep6_t0.2_test_time 0.18068814277648926
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.48114490509033203
ep7_train_time 7.4310221672058105
Test Epoch7 threshold 0.2 Acc 0.9118421052631579, AUC 0.9797693490982056, avg_entr 0.025359826162457466
ep7_t0.2_test_time 0.1811368465423584
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.4768686592578888
ep8_train_time 6.776878595352173
Test Epoch8 threshold 0.2 Acc 0.9123355263157895, AUC 0.9796059131622314, avg_entr 0.02547677978873253
ep8_t0.2_test_time 0.1695115566253662
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.47322338819503784
ep9_train_time 6.409332275390625
Test Epoch9 threshold 0.2 Acc 0.9120065789473685, AUC 0.9794922471046448, avg_entr 0.025582576170563698
ep9_t0.2_test_time 0.16881012916564941
Best AUC 0.9807927012443542
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.2_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9217105263157894, AUC 0.9866429567337036, avg_entr 0.02824201062321663
t0.2_test_time 0.0429990291595459
