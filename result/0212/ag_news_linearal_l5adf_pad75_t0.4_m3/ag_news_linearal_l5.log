total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.4_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.17623333333333333 (21148/120000), AUC 0.27342841029167175
ep0_train_time 6.606726884841919
Test Epoch0 threshold 0.4 Acc 0.9139802631578947, AUC 0.9805498123168945, avg_entr 0.024926695972681046
ep0_t0.4_test_time 0.13857293128967285
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.4_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.17175 (20610/120000), AUC 0.24395199120044708
ep1_train_time 6.377065420150757
Test Epoch1 threshold 0.4 Acc 0.9139802631578947, AUC 0.9803934097290039, avg_entr 0.02672489359974861
ep1_t0.4_test_time 0.1439366340637207
gc 0
Train Epoch2 Acc 0.09684166666666667 (11621/120000), AUC 0.2793916165828705
ep2_train_time 6.675592422485352
Test Epoch2 threshold 0.4 Acc 0.9148026315789474, AUC 0.9799210429191589, avg_entr 0.025283465161919594
ep2_t0.4_test_time 0.14138507843017578
gc 0
Train Epoch3 Acc 0.08021666666666667 (9626/120000), AUC 0.3360528349876404
ep3_train_time 6.64939284324646
Test Epoch3 threshold 0.4 Acc 0.9123355263157895, AUC 0.9799036979675293, avg_entr 0.026749588549137115
ep3_t0.4_test_time 0.14240241050720215
gc 0
Train Epoch4 Acc 0.18666666666666668 (22400/120000), AUC 0.39668092131614685
ep4_train_time 6.5452375411987305
Test Epoch4 threshold 0.4 Acc 0.9116776315789473, AUC 0.9798692464828491, avg_entr 0.025857996195554733
ep4_t0.4_test_time 0.13833093643188477
gc 0
Train Epoch5 Acc 0.241725 (29007/120000), AUC 0.4087577760219574
ep5_train_time 6.461682319641113
Test Epoch5 threshold 0.4 Acc 0.9123355263157895, AUC 0.9796180725097656, avg_entr 0.025898242369294167
ep5_t0.4_test_time 0.13672971725463867
gc 0
Train Epoch6 Acc 0.25475 (30570/120000), AUC 0.4054814279079437
ep6_train_time 6.394493818283081
Test Epoch6 threshold 0.4 Acc 0.9138157894736842, AUC 0.9794092178344727, avg_entr 0.02599167823791504
ep6_t0.4_test_time 0.13919925689697266
gc 0
Train Epoch7 Acc 0.2619416666666667 (31433/120000), AUC 0.4019879102706909
ep7_train_time 6.436821222305298
Test Epoch7 threshold 0.4 Acc 0.9116776315789473, AUC 0.9792264699935913, avg_entr 0.025689255446195602
ep7_t0.4_test_time 0.13840317726135254
gc 0
Train Epoch8 Acc 0.2643083333333333 (31717/120000), AUC 0.4004020690917969
ep8_train_time 6.439867973327637
Test Epoch8 threshold 0.4 Acc 0.9108552631578948, AUC 0.9791338443756104, avg_entr 0.026369251310825348
ep8_t0.4_test_time 0.13968253135681152
gc 0
Train Epoch9 Acc 0.26465833333333333 (31759/120000), AUC 0.40155816078186035
ep9_train_time 6.370281219482422
Test Epoch9 threshold 0.4 Acc 0.9111842105263158, AUC 0.9790812730789185, avg_entr 0.02645220048725605
ep9_t0.4_test_time 0.13817524909973145
Best AUC 0.9805498123168945
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.4_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9263157894736842, AUC 0.9861471652984619, avg_entr 0.024076933041214943
t0.4_test_time 0.03557562828063965
