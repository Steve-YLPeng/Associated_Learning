total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.3_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.2512666666666667 (30152/120000), AUC 0.42039889097213745
ep0_train_time 6.493645668029785
Test Epoch0 threshold 0.3 Acc 0.9148026315789474, AUC 0.9804108738899231, avg_entr 0.025794824585318565
ep0_t0.3_test_time 0.12619423866271973
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.3_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.298525 (35823/120000), AUC 0.4670947194099426
ep1_train_time 6.077400207519531
Test Epoch1 threshold 0.3 Acc 0.9157894736842105, AUC 0.9805244207382202, avg_entr 0.025176409631967545
ep1_t0.3_test_time 0.11414504051208496
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.3_m4//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.323175 (38781/120000), AUC 0.5206990242004395
ep2_train_time 6.072897434234619
Test Epoch2 threshold 0.3 Acc 0.9123355263157895, AUC 0.9800657033920288, avg_entr 0.025216666981577873
ep2_t0.3_test_time 0.11712527275085449
gc 0
Train Epoch3 Acc 0.3183166666666667 (38198/120000), AUC 0.6031714081764221
ep3_train_time 6.035910606384277
Test Epoch3 threshold 0.3 Acc 0.9120065789473685, AUC 0.9799208641052246, avg_entr 0.02486318349838257
ep3_t0.3_test_time 0.11281585693359375
gc 0
Train Epoch4 Acc 0.31445833333333334 (37735/120000), AUC 0.636237621307373
ep4_train_time 6.0507142543792725
Test Epoch4 threshold 0.3 Acc 0.912828947368421, AUC 0.9796993136405945, avg_entr 0.025378409773111343
ep4_t0.3_test_time 0.11461663246154785
gc 0
Train Epoch5 Acc 0.331125 (39735/120000), AUC 0.6459952592849731
ep5_train_time 6.036851167678833
Test Epoch5 threshold 0.3 Acc 0.9116776315789473, AUC 0.9794068336486816, avg_entr 0.024967094883322716
ep5_t0.3_test_time 0.11359095573425293
gc 0
Train Epoch6 Acc 0.33631666666666665 (40358/120000), AUC 0.6465178728103638
ep6_train_time 6.283499240875244
Test Epoch6 threshold 0.3 Acc 0.9108552631578948, AUC 0.9792977571487427, avg_entr 0.02494720183312893
ep6_t0.3_test_time 0.1211397647857666
gc 0
Train Epoch7 Acc 0.3384 (40608/120000), AUC 0.6444795727729797
ep7_train_time 6.3769800662994385
Test Epoch7 threshold 0.3 Acc 0.9101973684210526, AUC 0.9792178869247437, avg_entr 0.02511024661362171
ep7_t0.3_test_time 0.11794567108154297
gc 0
Train Epoch8 Acc 0.3415166666666667 (40982/120000), AUC 0.6419957876205444
ep8_train_time 6.1645519733428955
Test Epoch8 threshold 0.3 Acc 0.9106907894736842, AUC 0.9791020750999451, avg_entr 0.02529134787619114
ep8_t0.3_test_time 0.11085295677185059
gc 0
Train Epoch9 Acc 0.3423583333333333 (41083/120000), AUC 0.6386911273002625
ep9_train_time 6.084057807922363
Test Epoch9 threshold 0.3 Acc 0.9095394736842105, AUC 0.9788559079170227, avg_entr 0.024909714236855507
ep9_t0.3_test_time 0.10991072654724121
Best AUC 0.9805244207382202
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.3_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9230263157894737, AUC 0.9858644008636475, avg_entr 0.025399113073945045
t0.3_test_time 0.03015589714050293
