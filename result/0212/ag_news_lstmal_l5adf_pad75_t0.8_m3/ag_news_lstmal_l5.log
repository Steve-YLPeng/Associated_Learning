total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad75_t0.8_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.035575 (4269/120000), AUC 0.2933863699436188
ep0_train_time 32.33405637741089
Test Epoch0 threshold 0.8 Acc 0.9164473684210527, AUC 0.9807466268539429, avg_entr 0.02634323574602604
ep0_t0.8_test_time 0.1348423957824707
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad75_t0.8_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.034083333333333334 (4090/120000), AUC 0.32859545946121216
ep1_train_time 32.16434407234192
Test Epoch1 threshold 0.8 Acc 0.915296052631579, AUC 0.980593204498291, avg_entr 0.02559593692421913
ep1_t0.8_test_time 0.13332486152648926
gc 0
Train Epoch2 Acc 0.040341666666666665 (4841/120000), AUC 0.3262421786785126
ep2_train_time 32.195377826690674
Test Epoch2 threshold 0.8 Acc 0.9138157894736842, AUC 0.980483889579773, avg_entr 0.0258738212287426
ep2_t0.8_test_time 0.13214945793151855
gc 0
Train Epoch3 Acc 0.04659166666666667 (5591/120000), AUC 0.3235653042793274
ep3_train_time 32.22100853919983
Test Epoch3 threshold 0.8 Acc 0.9141447368421053, AUC 0.9803591966629028, avg_entr 0.025548480451107025
ep3_t0.8_test_time 0.13273906707763672
gc 0
Train Epoch4 Acc 0.045241666666666666 (5429/120000), AUC 0.31553006172180176
ep4_train_time 32.339942932128906
Test Epoch4 threshold 0.8 Acc 0.9123355263157895, AUC 0.9801868200302124, avg_entr 0.025827500969171524
ep4_t0.8_test_time 0.13230323791503906
gc 0
Train Epoch5 Acc 0.048591666666666665 (5831/120000), AUC 0.3226219117641449
ep5_train_time 32.33557343482971
Test Epoch5 threshold 0.8 Acc 0.9126644736842106, AUC 0.9797555804252625, avg_entr 0.025404082611203194
ep5_t0.8_test_time 0.1314535140991211
gc 0
Train Epoch6 Acc 0.047775 (5733/120000), AUC 0.323862224817276
ep6_train_time 32.35053777694702
Test Epoch6 threshold 0.8 Acc 0.9115131578947369, AUC 0.9795747399330139, avg_entr 0.025946659967303276
ep6_t0.8_test_time 0.13360595703125
gc 0
Train Epoch7 Acc 0.0408 (4896/120000), AUC 0.34133702516555786
ep7_train_time 32.358577728271484
Test Epoch7 threshold 0.8 Acc 0.9118421052631579, AUC 0.9793965816497803, avg_entr 0.02535535953938961
ep7_t0.8_test_time 0.13242864608764648
gc 0
Train Epoch8 Acc 0.03975833333333333 (4771/120000), AUC 0.34947577118873596
ep8_train_time 32.300424337387085
Test Epoch8 threshold 0.8 Acc 0.9123355263157895, AUC 0.9793216586112976, avg_entr 0.025809569284319878
ep8_t0.8_test_time 0.13320064544677734
gc 0
Train Epoch9 Acc 0.03328333333333333 (3994/120000), AUC 0.354287713766098
ep9_train_time 32.3262779712677
Test Epoch9 threshold 0.8 Acc 0.9111842105263158, AUC 0.9791836738586426, avg_entr 0.025943467393517494
ep9_t0.8_test_time 0.13231205940246582
Best AUC 0.9807466268539429
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad75_t0.8_m3//ag_news_lstmal_l5_prefix.pt
Test threshold 0.8 Acc 0.9230263157894737, AUC 0.9860602021217346, avg_entr 0.026286965236067772
t0.8_test_time 0.0340266227722168
