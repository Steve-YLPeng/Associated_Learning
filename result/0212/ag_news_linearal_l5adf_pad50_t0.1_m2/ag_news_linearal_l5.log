total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.1_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.16360833333333333 (19633/120000), AUC 0.4592735767364502
ep0_train_time 5.787392854690552
Test Epoch0 threshold 0.1 Acc 0.9139802631578947, AUC 0.9803935289382935, avg_entr 0.03065447136759758
ep0_t0.1_test_time 0.11186504364013672
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.1_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.15314166666666668 (18377/120000), AUC 0.46908503770828247
ep1_train_time 5.210854530334473
Test Epoch1 threshold 0.1 Acc 0.9162828947368421, AUC 0.9803352952003479, avg_entr 0.02772623300552368
ep1_t0.1_test_time 0.1101992130279541
gc 0
Train Epoch2 Acc 0.17255 (20706/120000), AUC 0.4705427885055542
ep2_train_time 5.2234227657318115
Test Epoch2 threshold 0.1 Acc 0.9148026315789474, AUC 0.9798741340637207, avg_entr 0.026957837864756584
ep2_t0.1_test_time 0.10879206657409668
gc 0
Train Epoch3 Acc 0.1849 (22188/120000), AUC 0.4680418372154236
ep3_train_time 5.175339460372925
Test Epoch3 threshold 0.1 Acc 0.9151315789473684, AUC 0.9799884557723999, avg_entr 0.02606516145169735
ep3_t0.1_test_time 0.10928511619567871
gc 0
Train Epoch4 Acc 0.19235833333333333 (23083/120000), AUC 0.46188244223594666
ep4_train_time 5.215994596481323
Test Epoch4 threshold 0.1 Acc 0.9120065789473685, AUC 0.9796583652496338, avg_entr 0.02629021555185318
ep4_t0.1_test_time 0.10861587524414062
gc 0
Train Epoch5 Acc 0.19803333333333334 (23764/120000), AUC 0.4556178152561188
ep5_train_time 5.1986377239227295
Test Epoch5 threshold 0.1 Acc 0.9118421052631579, AUC 0.9794781804084778, avg_entr 0.0266412366181612
ep5_t0.1_test_time 0.10776042938232422
gc 0
Train Epoch6 Acc 0.2012 (24144/120000), AUC 0.45118916034698486
ep6_train_time 5.154682159423828
Test Epoch6 threshold 0.1 Acc 0.912828947368421, AUC 0.9793487787246704, avg_entr 0.026287706568837166
ep6_t0.1_test_time 0.1103367805480957
gc 0
Train Epoch7 Acc 0.204275 (24513/120000), AUC 0.4466656446456909
ep7_train_time 5.237262725830078
Test Epoch7 threshold 0.1 Acc 0.9120065789473685, AUC 0.9792187213897705, avg_entr 0.02568066492676735
ep7_t0.1_test_time 0.10953259468078613
gc 0
Train Epoch8 Acc 0.20708333333333334 (24850/120000), AUC 0.44135183095932007
ep8_train_time 5.235265731811523
Test Epoch8 threshold 0.1 Acc 0.9108552631578948, AUC 0.9789606332778931, avg_entr 0.025536315515637398
ep8_t0.1_test_time 0.10790157318115234
gc 0
Train Epoch9 Acc 0.20914166666666667 (25097/120000), AUC 0.43760043382644653
ep9_train_time 5.188376426696777
Test Epoch9 threshold 0.1 Acc 0.9108552631578948, AUC 0.9790052771568298, avg_entr 0.02533349208533764
ep9_t0.1_test_time 0.10934209823608398
Best AUC 0.9803935289382935
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.1_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.925, AUC 0.9864605069160461, avg_entr 0.032045960426330566
t0.1_test_time 0.02815103530883789
