total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad25_t0.6_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.20428333333333334 (24514/120000), AUC 0.4623352289199829
ep0_train_time 14.437757968902588
Test Epoch0 threshold 0.6 Acc 0.9116776315789473, AUC 0.9807106256484985, avg_entr 0.025438295677304268
ep0_t0.6_test_time 0.07346630096435547
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad25_t0.6_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.246725 (29607/120000), AUC 0.514256477355957
ep1_train_time 14.151629447937012
Test Epoch1 threshold 0.6 Acc 0.9125, AUC 0.9808608889579773, avg_entr 0.024705154821276665
ep1_t0.6_test_time 0.07299685478210449
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad25_t0.6_m3//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24860833333333332 (29833/120000), AUC 0.5506081581115723
ep2_train_time 14.23483395576477
Test Epoch2 threshold 0.6 Acc 0.9134868421052632, AUC 0.9804508686065674, avg_entr 0.024931631982326508
ep2_t0.6_test_time 0.07641720771789551
gc 0
Train Epoch3 Acc 0.24831666666666666 (29798/120000), AUC 0.5665624737739563
ep3_train_time 14.436559677124023
Test Epoch3 threshold 0.6 Acc 0.9125, AUC 0.9803777933120728, avg_entr 0.0254240483045578
ep3_t0.6_test_time 0.07477426528930664
gc 0
Train Epoch4 Acc 0.24831666666666666 (29798/120000), AUC 0.5727136135101318
ep4_train_time 14.17155647277832
Test Epoch4 threshold 0.6 Acc 0.9088815789473684, AUC 0.9797819256782532, avg_entr 0.025504471734166145
ep4_t0.6_test_time 0.07111263275146484
gc 0
Train Epoch5 Acc 0.248575 (29829/120000), AUC 0.580862820148468
ep5_train_time 14.205610513687134
Test Epoch5 threshold 0.6 Acc 0.9108552631578948, AUC 0.9796487092971802, avg_entr 0.0257294662296772
ep5_t0.6_test_time 0.07171630859375
gc 0
Train Epoch6 Acc 0.24889166666666668 (29867/120000), AUC 0.5859388113021851
ep6_train_time 14.496636867523193
Test Epoch6 threshold 0.6 Acc 0.9085526315789474, AUC 0.979464054107666, avg_entr 0.02538330852985382
ep6_t0.6_test_time 0.0719289779663086
gc 0
Train Epoch7 Acc 0.248925 (29871/120000), AUC 0.588468611240387
ep7_train_time 14.712987661361694
Test Epoch7 threshold 0.6 Acc 0.9105263157894737, AUC 0.9793660640716553, avg_entr 0.02523123100399971
ep7_t0.6_test_time 0.0715024471282959
gc 0
Train Epoch8 Acc 0.249125 (29895/120000), AUC 0.5928127765655518
ep8_train_time 14.519063234329224
Test Epoch8 threshold 0.6 Acc 0.9111842105263158, AUC 0.9790102243423462, avg_entr 0.025097599253058434
ep8_t0.6_test_time 0.0714104175567627
gc 0
Train Epoch9 Acc 0.24925833333333333 (29911/120000), AUC 0.5948180556297302
ep9_train_time 14.396376132965088
Test Epoch9 threshold 0.6 Acc 0.9095394736842105, AUC 0.9789713621139526, avg_entr 0.025595001876354218
ep9_t0.6_test_time 0.07148933410644531
Best AUC 0.9808608889579773
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad25_t0.6_m3//ag_news_lstmal_l5_prefix.pt
Test threshold 0.6 Acc 0.925, AUC 0.9854154586791992, avg_entr 0.02738020569086075
t0.6_test_time 0.018762826919555664
