total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.15768333333333334 (18922/120000), AUC 0.375655859708786
ep0_train_time 9.048565149307251
Test Epoch0 threshold 0.6 Acc 0.9171052631578948, AUC 0.9809772968292236, avg_entr 0.027612756937742233
ep0_t0.6_test_time 0.25136804580688477
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.042383333333333335 (5086/120000), AUC 0.28274673223495483
ep1_train_time 8.436454057693481
Test Epoch1 threshold 0.6 Acc 0.9154605263157894, AUC 0.9808871746063232, avg_entr 0.02698267623782158
ep1_t0.6_test_time 0.24820852279663086
gc 0
Train Epoch2 Acc 0.074375 (8925/120000), AUC 0.28152915835380554
ep2_train_time 8.393205404281616
Test Epoch2 threshold 0.6 Acc 0.9162828947368421, AUC 0.9806208610534668, avg_entr 0.026127027347683907
ep2_t0.6_test_time 0.24855327606201172
gc 0
Train Epoch3 Acc 0.1168 (14016/120000), AUC 0.281110942363739
ep3_train_time 8.367304563522339
Test Epoch3 threshold 0.6 Acc 0.9159539473684211, AUC 0.9806191921234131, avg_entr 0.026562126353383064
ep3_t0.6_test_time 0.2486567497253418
gc 0
Train Epoch4 Acc 0.1246 (14952/120000), AUC 0.2808036208152771
ep4_train_time 8.578919172286987
Test Epoch4 threshold 0.6 Acc 0.9154605263157894, AUC 0.9804284572601318, avg_entr 0.02624361589550972
ep4_t0.6_test_time 0.25995302200317383
gc 0
Train Epoch5 Acc 0.10974166666666667 (13169/120000), AUC 0.2801097631454468
ep5_train_time 8.736235857009888
Test Epoch5 threshold 0.6 Acc 0.9141447368421053, AUC 0.9801746606826782, avg_entr 0.026089243590831757
ep5_t0.6_test_time 0.24943113327026367
gc 0
Train Epoch6 Acc 0.0936 (11232/120000), AUC 0.2802550494670868
ep6_train_time 8.438292741775513
Test Epoch6 threshold 0.6 Acc 0.9151315789473684, AUC 0.9802131056785583, avg_entr 0.026045864447951317
ep6_t0.6_test_time 0.24878668785095215
gc 0
Train Epoch7 Acc 0.07353333333333334 (8824/120000), AUC 0.28069764375686646
ep7_train_time 8.425679922103882
Test Epoch7 threshold 0.6 Acc 0.9139802631578947, AUC 0.9800702929496765, avg_entr 0.025965841487050056
ep7_t0.6_test_time 0.24870872497558594
gc 0
Train Epoch8 Acc 0.06100833333333333 (7321/120000), AUC 0.28085005283355713
ep8_train_time 8.590922117233276
Test Epoch8 threshold 0.6 Acc 0.9141447368421053, AUC 0.9800118207931519, avg_entr 0.025539584457874298
ep8_t0.6_test_time 0.24823427200317383
gc 0
Train Epoch9 Acc 0.059691666666666664 (7163/120000), AUC 0.2809666693210602
ep9_train_time 8.458526134490967
Test Epoch9 threshold 0.6 Acc 0.9141447368421053, AUC 0.9799085855484009, avg_entr 0.02604314312338829
ep9_t0.6_test_time 0.24954843521118164
Best AUC 0.9809772968292236
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9223684210526316, AUC 0.9864269495010376, avg_entr 0.02679201401770115
t0.6_test_time 0.06279468536376953
