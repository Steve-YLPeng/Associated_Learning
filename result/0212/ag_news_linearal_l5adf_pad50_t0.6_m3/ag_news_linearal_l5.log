total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.6_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.20628333333333335 (24754/120000), AUC 0.2837948799133301
ep0_train_time 6.01907205581665
Test Epoch0 threshold 0.6 Acc 0.915625, AUC 0.9801374673843384, avg_entr 0.027018439024686813
ep0_t0.6_test_time 0.10228776931762695
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.6_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.15334166666666665 (18401/120000), AUC 0.26003098487854004
ep1_train_time 5.552560806274414
Test Epoch1 threshold 0.6 Acc 0.9129934210526316, AUC 0.9800599813461304, avg_entr 0.025596119463443756
ep1_t0.6_test_time 0.10071277618408203
gc 0
Train Epoch2 Acc 0.08114166666666667 (9737/120000), AUC 0.25375938415527344
ep2_train_time 5.562642812728882
Test Epoch2 threshold 0.6 Acc 0.915296052631579, AUC 0.9799418449401855, avg_entr 0.026326395571231842
ep2_t0.6_test_time 0.09974980354309082
gc 0
Train Epoch3 Acc 0.051041666666666666 (6125/120000), AUC 0.24659490585327148
ep3_train_time 5.744682550430298
Test Epoch3 threshold 0.6 Acc 0.912828947368421, AUC 0.9797223806381226, avg_entr 0.025536349043250084
ep3_t0.6_test_time 0.10398030281066895
gc 0
Train Epoch4 Acc 0.040508333333333334 (4861/120000), AUC 0.2493501752614975
ep4_train_time 5.840045213699341
Test Epoch4 threshold 0.6 Acc 0.9111842105263158, AUC 0.9795092344284058, avg_entr 0.025193287059664726
ep4_t0.6_test_time 0.10413765907287598
gc 0
Train Epoch5 Acc 0.03515833333333333 (4219/120000), AUC 0.25805750489234924
ep5_train_time 5.890147686004639
Test Epoch5 threshold 0.6 Acc 0.9111842105263158, AUC 0.979358971118927, avg_entr 0.025363480672240257
ep5_t0.6_test_time 0.10432052612304688
gc 0
Train Epoch6 Acc 0.03295833333333333 (3955/120000), AUC 0.2667151987552643
ep6_train_time 5.708304166793823
Test Epoch6 threshold 0.6 Acc 0.9106907894736842, AUC 0.9790692925453186, avg_entr 0.025932706892490387
ep6_t0.6_test_time 0.10039615631103516
gc 0
Train Epoch7 Acc 0.0316 (3792/120000), AUC 0.27482903003692627
ep7_train_time 5.717649936676025
Test Epoch7 threshold 0.6 Acc 0.9095394736842105, AUC 0.9787479639053345, avg_entr 0.025981822982430458
ep7_t0.6_test_time 0.1008453369140625
gc 0
Train Epoch8 Acc 0.031025 (3723/120000), AUC 0.2812955975532532
ep8_train_time 5.70654559135437
Test Epoch8 threshold 0.6 Acc 0.9088815789473684, AUC 0.9787107706069946, avg_entr 0.026240047067403793
ep8_t0.6_test_time 0.10242652893066406
gc 0
Train Epoch9 Acc 0.030041666666666668 (3605/120000), AUC 0.2842494249343872
ep9_train_time 5.712453126907349
Test Epoch9 threshold 0.6 Acc 0.9085526315789474, AUC 0.9785891771316528, avg_entr 0.025877144187688828
ep9_t0.6_test_time 0.10250568389892578
Best AUC 0.9801374673843384
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.6_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9256578947368421, AUC 0.9857562184333801, avg_entr 0.02598978579044342
t0.6_test_time 0.026021242141723633
