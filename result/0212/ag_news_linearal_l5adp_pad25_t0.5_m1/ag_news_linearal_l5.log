total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.1333 (15996/120000), AUC 0.37530994415283203
ep0_train_time 4.281404733657837
Test Epoch0 threshold 0.5 Acc 0.9116776315789473, AUC 0.9792153835296631, avg_entr 0.14923706650733948
ep0_t0.5_test_time 0.07288432121276855
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.105375 (12645/120000), AUC 0.34111297130584717
ep1_train_time 3.807671546936035
Test Epoch1 threshold 0.5 Acc 0.9116776315789473, AUC 0.9803309440612793, avg_entr 0.09143614768981934
ep1_t0.5_test_time 0.07160210609436035
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.10440833333333334 (12529/120000), AUC 0.33775436878204346
ep2_train_time 3.828381061553955
Test Epoch2 threshold 0.5 Acc 0.9123355263157895, AUC 0.9807811379432678, avg_entr 0.07334738969802856
ep2_t0.5_test_time 0.07090902328491211
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.10386666666666666 (12464/120000), AUC 0.3355940580368042
ep3_train_time 3.8345465660095215
Test Epoch3 threshold 0.5 Acc 0.9113486842105263, AUC 0.9802004098892212, avg_entr 0.06384153664112091
ep3_t0.5_test_time 0.07081317901611328
gc 0
Train Epoch4 Acc 0.10395833333333333 (12475/120000), AUC 0.3340602517127991
ep4_train_time 3.8253085613250732
Test Epoch4 threshold 0.5 Acc 0.912828947368421, AUC 0.9802668690681458, avg_entr 0.05773622542619705
ep4_t0.5_test_time 0.07117009162902832
gc 0
Train Epoch5 Acc 0.10486666666666666 (12584/120000), AUC 0.3320530652999878
ep5_train_time 3.816014289855957
Test Epoch5 threshold 0.5 Acc 0.9125, AUC 0.9798728823661804, avg_entr 0.05346141755580902
ep5_t0.5_test_time 0.07118821144104004
gc 0
Train Epoch6 Acc 0.105125 (12615/120000), AUC 0.3301467299461365
ep6_train_time 3.8204596042633057
Test Epoch6 threshold 0.5 Acc 0.9123355263157895, AUC 0.9801223874092102, avg_entr 0.04917432740330696
ep6_t0.5_test_time 0.07042264938354492
gc 0
Train Epoch7 Acc 0.10515833333333334 (12619/120000), AUC 0.3289690613746643
ep7_train_time 3.838132858276367
Test Epoch7 threshold 0.5 Acc 0.912828947368421, AUC 0.9797313213348389, avg_entr 0.047389302402734756
ep7_t0.5_test_time 0.07108426094055176
gc 0
Train Epoch8 Acc 0.10571666666666667 (12686/120000), AUC 0.32947155833244324
ep8_train_time 3.833268880844116
Test Epoch8 threshold 0.5 Acc 0.9108552631578948, AUC 0.9796223044395447, avg_entr 0.0454276017844677
ep8_t0.5_test_time 0.07028913497924805
gc 0
Train Epoch9 Acc 0.10585 (12702/120000), AUC 0.3294786810874939
ep9_train_time 3.833075523376465
Test Epoch9 threshold 0.5 Acc 0.9111842105263158, AUC 0.9795551300048828, avg_entr 0.0437115915119648
ep9_t0.5_test_time 0.0711362361907959
Best AUC 0.9807811379432678
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.5_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9217105263157894, AUC 0.9851465225219727, avg_entr 0.07682924717664719
t0.5_test_time 0.01872706413269043
