total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.252125 (30255/120000), AUC 0.4510291516780853
ep0_train_time 4.319451808929443
Test Epoch0 threshold 0.9 Acc 0.9080592105263158, AUC 0.9794166088104248, avg_entr 0.1507209837436676
ep0_t0.9_test_time 0.07370567321777344
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2516833333333333 (30202/120000), AUC 0.42031383514404297
ep1_train_time 3.823803663253784
Test Epoch1 threshold 0.9 Acc 0.9136513157894737, AUC 0.981019139289856, avg_entr 0.0948614850640297
ep1_t0.9_test_time 0.07160305976867676
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2508 (30096/120000), AUC 0.41637349128723145
ep2_train_time 3.818025827407837
Test Epoch2 threshold 0.9 Acc 0.9123355263157895, AUC 0.980791449546814, avg_entr 0.07573796063661575
ep2_t0.9_test_time 0.07162714004516602
gc 0
Train Epoch3 Acc 0.2504 (30048/120000), AUC 0.41413602232933044
ep3_train_time 3.795543670654297
Test Epoch3 threshold 0.9 Acc 0.9123355263157895, AUC 0.9805723428726196, avg_entr 0.06656020134687424
ep3_t0.9_test_time 0.07144713401794434
gc 0
Train Epoch4 Acc 0.24991666666666668 (29990/120000), AUC 0.41130146384239197
ep4_train_time 3.8294904232025146
Test Epoch4 threshold 0.9 Acc 0.9123355263157895, AUC 0.9803495407104492, avg_entr 0.05871116742491722
ep4_t0.9_test_time 0.07172131538391113
gc 0
Train Epoch5 Acc 0.24959166666666666 (29951/120000), AUC 0.408877432346344
ep5_train_time 4.078052043914795
Test Epoch5 threshold 0.9 Acc 0.9138157894736842, AUC 0.9805647134780884, avg_entr 0.055551715195178986
ep5_t0.9_test_time 0.07425045967102051
gc 0
Train Epoch6 Acc 0.24921666666666667 (29906/120000), AUC 0.4071764051914215
ep6_train_time 4.0090155601501465
Test Epoch6 threshold 0.9 Acc 0.9126644736842106, AUC 0.9800844192504883, avg_entr 0.051067743450403214
ep6_t0.9_test_time 0.07338523864746094
gc 0
Train Epoch7 Acc 0.249025 (29883/120000), AUC 0.40768295526504517
ep7_train_time 3.9578332901000977
Test Epoch7 threshold 0.9 Acc 0.9115131578947369, AUC 0.9797796010971069, avg_entr 0.049389827996492386
ep7_t0.9_test_time 0.07212066650390625
gc 0
Train Epoch8 Acc 0.24900833333333333 (29881/120000), AUC 0.4077114760875702
ep8_train_time 3.940277338027954
Test Epoch8 threshold 0.9 Acc 0.9111842105263158, AUC 0.9794737100601196, avg_entr 0.04654772952198982
ep8_t0.9_test_time 0.07222604751586914
gc 0
Train Epoch9 Acc 0.249025 (29883/120000), AUC 0.40754732489585876
ep9_train_time 3.938333034515381
Test Epoch9 threshold 0.9 Acc 0.9088815789473684, AUC 0.9793254733085632, avg_entr 0.04429817572236061
ep9_t0.9_test_time 0.07216215133666992
Best AUC 0.981019139289856
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.9_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9203947368421053, AUC 0.9847844839096069, avg_entr 0.10224253684282303
t0.9_test_time 0.018857717514038086
