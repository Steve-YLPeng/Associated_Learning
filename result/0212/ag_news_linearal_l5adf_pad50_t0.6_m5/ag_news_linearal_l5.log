total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.6_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9043666666666667 (108524/120000), AUC 0.9825983047485352
ep0_train_time 7.111799478530884
Test Epoch0 threshold 0.6 Acc 0.9123355263157895, AUC 0.9796615839004517, avg_entr 0.025707658380270004
ep0_t0.6_test_time 0.10286116600036621
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.6_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9511 (114132/120000), AUC 0.993698000907898
ep1_train_time 6.723431825637817
Test Epoch1 threshold 0.6 Acc 0.9118421052631579, AUC 0.97951340675354, avg_entr 0.025880984961986542
ep1_t0.6_test_time 0.10012221336364746
gc 0
Train Epoch2 Acc 0.9528833333333333 (114346/120000), AUC 0.9938157796859741
ep2_train_time 6.638030052185059
Test Epoch2 threshold 0.6 Acc 0.9121710526315789, AUC 0.9794968962669373, avg_entr 0.025879282504320145
ep2_t0.6_test_time 0.1009061336517334
gc 0
Train Epoch3 Acc 0.9538 (114456/120000), AUC 0.993889331817627
ep3_train_time 6.704094409942627
Test Epoch3 threshold 0.6 Acc 0.9098684210526315, AUC 0.9795873761177063, avg_entr 0.025979062542319298
ep3_t0.6_test_time 0.10487532615661621
gc 0
Train Epoch4 Acc 0.9545166666666667 (114542/120000), AUC 0.9941335916519165
ep4_train_time 6.716545343399048
Test Epoch4 threshold 0.6 Acc 0.9108552631578948, AUC 0.979163646697998, avg_entr 0.025612512603402138
ep4_t0.6_test_time 0.10182309150695801
gc 0
Train Epoch5 Acc 0.9570916666666667 (114851/120000), AUC 0.9949153065681458
ep5_train_time 6.809025049209595
Test Epoch5 threshold 0.6 Acc 0.9090460526315789, AUC 0.9788894057273865, avg_entr 0.0255244430154562
ep5_t0.6_test_time 0.10155749320983887
gc 0
Train Epoch6 Acc 0.9581083333333333 (114973/120000), AUC 0.9950295686721802
ep6_train_time 6.756927013397217
Test Epoch6 threshold 0.6 Acc 0.9098684210526315, AUC 0.9788182973861694, avg_entr 0.02594830095767975
ep6_t0.6_test_time 0.1020359992980957
gc 0
Train Epoch7 Acc 0.9580833333333333 (114970/120000), AUC 0.9952229261398315
ep7_train_time 6.74358868598938
Test Epoch7 threshold 0.6 Acc 0.9080592105263158, AUC 0.9785112142562866, avg_entr 0.02652091532945633
ep7_t0.6_test_time 0.1023707389831543
gc 0
Train Epoch8 Acc 0.9586166666666667 (115034/120000), AUC 0.9953399300575256
ep8_train_time 6.769704103469849
Test Epoch8 threshold 0.6 Acc 0.9095394736842105, AUC 0.9786791205406189, avg_entr 0.025299634784460068
ep8_t0.6_test_time 0.10248947143554688
gc 0
Train Epoch9 Acc 0.9598 (115176/120000), AUC 0.9957605600357056
ep9_train_time 6.74317479133606
Test Epoch9 threshold 0.6 Acc 0.9075657894736842, AUC 0.9784044027328491, avg_entr 0.02559368498623371
ep9_t0.6_test_time 0.1016988754272461
Best AUC 0.9796615839004517
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.6_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.925, AUC 0.9854791164398193, avg_entr 0.025766251608729362
t0.6_test_time 0.027055025100708008
