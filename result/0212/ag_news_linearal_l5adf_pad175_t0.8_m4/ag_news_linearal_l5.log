total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.19668333333333332 (23602/120000), AUC 0.35671466588974
ep0_train_time 9.94560956954956
Test Epoch0 threshold 0.8 Acc 0.912828947368421, AUC 0.98066246509552, avg_entr 0.025297632440924644
ep0_t0.8_test_time 0.25072550773620605
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.19036666666666666 (22844/120000), AUC 0.1909777820110321
ep1_train_time 9.489575386047363
Test Epoch1 threshold 0.8 Acc 0.9141447368421053, AUC 0.9805215001106262, avg_entr 0.026817884296178818
ep1_t0.8_test_time 0.2489914894104004
gc 0
Train Epoch2 Acc 0.16881666666666667 (20258/120000), AUC 0.15590858459472656
ep2_train_time 9.46058177947998
Test Epoch2 threshold 0.8 Acc 0.915296052631579, AUC 0.9803102016448975, avg_entr 0.025597285479307175
ep2_t0.8_test_time 0.24886560440063477
gc 0
Train Epoch3 Acc 0.04518333333333333 (5422/120000), AUC 0.2295994907617569
ep3_train_time 9.83129334449768
Test Epoch3 threshold 0.8 Acc 0.9144736842105263, AUC 0.9802520275115967, avg_entr 0.025413282215595245
ep3_t0.8_test_time 0.2485189437866211
gc 0
Train Epoch4 Acc 0.07138333333333333 (8566/120000), AUC 0.3524341881275177
ep4_train_time 9.454349517822266
Test Epoch4 threshold 0.8 Acc 0.9139802631578947, AUC 0.9802284240722656, avg_entr 0.02616947889328003
ep4_t0.8_test_time 0.24880051612854004
gc 0
Train Epoch5 Acc 0.13923333333333332 (16708/120000), AUC 0.4248025119304657
ep5_train_time 9.489466428756714
Test Epoch5 threshold 0.8 Acc 0.9125, AUC 0.9800047874450684, avg_entr 0.02540545165538788
ep5_t0.8_test_time 0.2492055892944336
gc 0
Train Epoch6 Acc 0.1628 (19536/120000), AUC 0.45944321155548096
ep6_train_time 9.483250617980957
Test Epoch6 threshold 0.8 Acc 0.912828947368421, AUC 0.9797484874725342, avg_entr 0.02573237009346485
ep6_t0.8_test_time 0.2501707077026367
gc 0
Train Epoch7 Acc 0.176 (21120/120000), AUC 0.48703911900520325
ep7_train_time 9.48006534576416
Test Epoch7 threshold 0.8 Acc 0.9123355263157895, AUC 0.9797405004501343, avg_entr 0.026640012860298157
ep7_t0.8_test_time 0.24930787086486816
gc 0
Train Epoch8 Acc 0.18231666666666665 (21878/120000), AUC 0.5075179934501648
ep8_train_time 9.44837760925293
Test Epoch8 threshold 0.8 Acc 0.9115131578947369, AUC 0.9796344637870789, avg_entr 0.02583559975028038
ep8_t0.8_test_time 0.24913763999938965
gc 0
Train Epoch9 Acc 0.18580833333333333 (22297/120000), AUC 0.5230638980865479
ep9_train_time 9.826204538345337
Test Epoch9 threshold 0.8 Acc 0.9116776315789473, AUC 0.9796286821365356, avg_entr 0.025565460324287415
ep9_t0.8_test_time 0.24920058250427246
Best AUC 0.98066246509552
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9230263157894737, AUC 0.9861183762550354, avg_entr 0.02421892248094082
t0.8_test_time 0.06274795532226562
