total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.5_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.2609916666666667 (31319/120000), AUC 0.4598715305328369
ep0_train_time 6.66306471824646
Test Epoch0 threshold 0.5 Acc 0.912828947368421, AUC 0.9800429940223694, avg_entr 0.025813493877649307
ep0_t0.5_test_time 0.10525369644165039
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.5_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.170625 (20475/120000), AUC 0.5358589291572571
ep1_train_time 6.2289512157440186
Test Epoch1 threshold 0.5 Acc 0.9121710526315789, AUC 0.979905366897583, avg_entr 0.02637825347483158
ep1_t0.5_test_time 0.10375475883483887
gc 0
Train Epoch2 Acc 0.0843 (10116/120000), AUC 0.5666623115539551
ep2_train_time 6.19457221031189
Test Epoch2 threshold 0.5 Acc 0.9134868421052632, AUC 0.9799329042434692, avg_entr 0.025287535041570663
ep2_t0.5_test_time 0.1035466194152832
gc 0
Train Epoch3 Acc 0.16158333333333333 (19390/120000), AUC 0.6260596513748169
ep3_train_time 6.259586334228516
Test Epoch3 threshold 0.5 Acc 0.9123355263157895, AUC 0.9793787598609924, avg_entr 0.026021134108304977
ep3_t0.5_test_time 0.10306406021118164
gc 0
Train Epoch4 Acc 0.249825 (29979/120000), AUC 0.596069872379303
ep4_train_time 6.216913461685181
Test Epoch4 threshold 0.5 Acc 0.9106907894736842, AUC 0.9792860150337219, avg_entr 0.025781864300370216
ep4_t0.5_test_time 0.10305356979370117
gc 0
Train Epoch5 Acc 0.274925 (32991/120000), AUC 0.5477050542831421
ep5_train_time 6.288015604019165
Test Epoch5 threshold 0.5 Acc 0.9113486842105263, AUC 0.979148268699646, avg_entr 0.026240603998303413
ep5_t0.5_test_time 0.10357904434204102
gc 0
Train Epoch6 Acc 0.29420833333333335 (35305/120000), AUC 0.5379071235656738
ep6_train_time 6.241002082824707
Test Epoch6 threshold 0.5 Acc 0.9113486842105263, AUC 0.9790551662445068, avg_entr 0.025796638801693916
ep6_t0.5_test_time 0.10277533531188965
gc 0
Train Epoch7 Acc 0.324125 (38895/120000), AUC 0.5388968586921692
ep7_train_time 6.227426528930664
Test Epoch7 threshold 0.5 Acc 0.9097039473684211, AUC 0.9790123105049133, avg_entr 0.02560981921851635
ep7_t0.5_test_time 0.10267210006713867
gc 0
Train Epoch8 Acc 0.365825 (43899/120000), AUC 0.5480952262878418
ep8_train_time 6.229924917221069
Test Epoch8 threshold 0.5 Acc 0.9106907894736842, AUC 0.9787884950637817, avg_entr 0.0262644924223423
ep8_t0.5_test_time 0.10177206993103027
gc 0
Train Epoch9 Acc 0.39025 (46830/120000), AUC 0.5591082572937012
ep9_train_time 6.2909629344940186
Test Epoch9 threshold 0.5 Acc 0.9085526315789474, AUC 0.9785981774330139, avg_entr 0.02609509974718094
ep9_t0.5_test_time 0.10241556167602539
Best AUC 0.9800429940223694
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.5_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.925, AUC 0.985904335975647, avg_entr 0.025659389793872833
t0.5_test_time 0.026898622512817383
