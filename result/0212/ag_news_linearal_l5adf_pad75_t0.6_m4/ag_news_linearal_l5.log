total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.6_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.0774 (9288/120000), AUC 0.32890814542770386
ep0_train_time 7.295555114746094
Test Epoch0 threshold 0.6 Acc 0.9139802631578947, AUC 0.9805353879928589, avg_entr 0.025576604530215263
ep0_t0.6_test_time 0.13462328910827637
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.6_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.06780833333333333 (8137/120000), AUC 0.33494266867637634
ep1_train_time 6.872286796569824
Test Epoch1 threshold 0.6 Acc 0.9148026315789474, AUC 0.9804609417915344, avg_entr 0.026268886402249336
ep1_t0.6_test_time 0.1307539939880371
gc 0
Train Epoch2 Acc 0.117225 (14067/120000), AUC 0.35154998302459717
ep2_train_time 6.959129571914673
Test Epoch2 threshold 0.6 Acc 0.9143092105263158, AUC 0.980240523815155, avg_entr 0.02509365603327751
ep2_t0.6_test_time 0.1303846836090088
gc 0
Train Epoch3 Acc 0.22653333333333334 (27184/120000), AUC 0.36732566356658936
ep3_train_time 6.957770109176636
Test Epoch3 threshold 0.6 Acc 0.9134868421052632, AUC 0.979880690574646, avg_entr 0.026204092428088188
ep3_t0.6_test_time 0.12957382202148438
gc 0
Train Epoch4 Acc 0.25600833333333334 (30721/120000), AUC 0.3794780969619751
ep4_train_time 6.850395202636719
Test Epoch4 threshold 0.6 Acc 0.9108552631578948, AUC 0.9798693060874939, avg_entr 0.025329045951366425
ep4_t0.6_test_time 0.13199830055236816
gc 0
Train Epoch5 Acc 0.24315833333333334 (29179/120000), AUC 0.384317547082901
ep5_train_time 6.892428636550903
Test Epoch5 threshold 0.6 Acc 0.9118421052631579, AUC 0.9799161553382874, avg_entr 0.02500436268746853
ep5_t0.6_test_time 0.13127589225769043
gc 0
Train Epoch6 Acc 0.23614166666666667 (28337/120000), AUC 0.38575997948646545
ep6_train_time 6.9265358448028564
Test Epoch6 threshold 0.6 Acc 0.9121710526315789, AUC 0.9795879125595093, avg_entr 0.025454649701714516
ep6_t0.6_test_time 0.13058137893676758
gc 0
Train Epoch7 Acc 0.228325 (27399/120000), AUC 0.38697558641433716
ep7_train_time 6.87336277961731
Test Epoch7 threshold 0.6 Acc 0.9116776315789473, AUC 0.9793722033500671, avg_entr 0.027020052075386047
ep7_t0.6_test_time 0.13159966468811035
gc 0
Train Epoch8 Acc 0.21994166666666667 (26393/120000), AUC 0.38724905252456665
ep8_train_time 6.947835922241211
Test Epoch8 threshold 0.6 Acc 0.9100328947368421, AUC 0.9791852235794067, avg_entr 0.025825651362538338
ep8_t0.6_test_time 0.131439208984375
gc 0
Train Epoch9 Acc 0.21395833333333333 (25675/120000), AUC 0.38770827651023865
ep9_train_time 6.885259389877319
Test Epoch9 threshold 0.6 Acc 0.9105263157894737, AUC 0.9790589809417725, avg_entr 0.026359668001532555
ep9_t0.6_test_time 0.13177013397216797
Best AUC 0.9805353879928589
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.6_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9276315789473685, AUC 0.9860553741455078, avg_entr 0.0250774584710598
t0.6_test_time 0.03409528732299805
