total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.3_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.189425 (22731/120000), AUC 0.32305479049682617
ep0_train_time 5.8623387813568115
Test Epoch0 threshold 0.3 Acc 0.9125, AUC 0.9801018238067627, avg_entr 0.02435924857854843
ep0_t0.3_test_time 0.08548831939697266
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.3_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.193825 (23259/120000), AUC 0.25028878450393677
ep1_train_time 5.357258081436157
Test Epoch1 threshold 0.3 Acc 0.9129934210526316, AUC 0.9800897836685181, avg_entr 0.02410370670258999
ep1_t0.3_test_time 0.08559012413024902
gc 0
Train Epoch2 Acc 0.14423333333333332 (17308/120000), AUC 0.25138354301452637
ep2_train_time 5.429057836532593
Test Epoch2 threshold 0.3 Acc 0.9126644736842106, AUC 0.9798070192337036, avg_entr 0.024523252621293068
ep2_t0.3_test_time 0.08447790145874023
gc 0
Train Epoch3 Acc 0.176225 (21147/120000), AUC 0.3122142255306244
ep3_train_time 5.414958715438843
Test Epoch3 threshold 0.3 Acc 0.9138157894736842, AUC 0.9798458814620972, avg_entr 0.02442873641848564
ep3_t0.3_test_time 0.08539390563964844
gc 0
Train Epoch4 Acc 0.24178333333333332 (29014/120000), AUC 0.33198124170303345
ep4_train_time 5.423623561859131
Test Epoch4 threshold 0.3 Acc 0.9113486842105263, AUC 0.9795912504196167, avg_entr 0.023781994357705116
ep4_t0.3_test_time 0.08267378807067871
gc 0
Train Epoch5 Acc 0.251825 (30219/120000), AUC 0.3442801237106323
ep5_train_time 5.448953151702881
Test Epoch5 threshold 0.3 Acc 0.9116776315789473, AUC 0.9792444705963135, avg_entr 0.023920845240354538
ep5_t0.3_test_time 0.08447051048278809
gc 0
Train Epoch6 Acc 0.257525 (30903/120000), AUC 0.3554399907588959
ep6_train_time 5.405679225921631
Test Epoch6 threshold 0.3 Acc 0.9113486842105263, AUC 0.9790531992912292, avg_entr 0.023956451565027237
ep6_t0.3_test_time 0.08353972434997559
gc 0
Train Epoch7 Acc 0.26350833333333334 (31621/120000), AUC 0.3651794195175171
ep7_train_time 5.396702766418457
Test Epoch7 threshold 0.3 Acc 0.9088815789473684, AUC 0.9789025783538818, avg_entr 0.02426753379404545
ep7_t0.3_test_time 0.08415436744689941
gc 0
Train Epoch8 Acc 0.26818333333333333 (32182/120000), AUC 0.37409257888793945
ep8_train_time 5.793619632720947
Test Epoch8 threshold 0.3 Acc 0.9095394736842105, AUC 0.9786905646324158, avg_entr 0.02458917908370495
ep8_t0.3_test_time 0.08563518524169922
gc 0
Train Epoch9 Acc 0.2719916666666667 (32639/120000), AUC 0.3805440366268158
ep9_train_time 5.735398292541504
Test Epoch9 threshold 0.3 Acc 0.9106907894736842, AUC 0.9784507155418396, avg_entr 0.024186816066503525
ep9_t0.3_test_time 0.08583950996398926
Best AUC 0.9801018238067627
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.3_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9217105263157894, AUC 0.9851576089859009, avg_entr 0.02531743049621582
t0.3_test_time 0.023235559463500977
