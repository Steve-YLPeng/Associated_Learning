total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad50_t0.9_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9179916666666667 (110159/120000), AUC 0.9852935075759888
ep0_train_time 31.36851978302002
Test Epoch0 threshold 0.9 Acc 0.9146381578947368, AUC 0.9797956347465515, avg_entr 0.025767043232917786
ep0_t0.9_test_time 0.10726761817932129
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad50_t0.9_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9555416666666666 (114665/120000), AUC 0.992800772190094
ep1_train_time 31.177552700042725
Test Epoch1 threshold 0.9 Acc 0.9144736842105263, AUC 0.9799213409423828, avg_entr 0.02556188963353634
ep1_t0.9_test_time 0.10132598876953125
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad50_t0.9_m5//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9584083333333333 (115009/120000), AUC 0.9932940006256104
ep2_train_time 31.415353298187256
Test Epoch2 threshold 0.9 Acc 0.9118421052631579, AUC 0.9798703193664551, avg_entr 0.02712477184832096
ep2_t0.9_test_time 0.10499334335327148
gc 0
Train Epoch3 Acc 0.9607083333333334 (115285/120000), AUC 0.9938113689422607
ep3_train_time 30.830843925476074
Test Epoch3 threshold 0.9 Acc 0.9113486842105263, AUC 0.9796539545059204, avg_entr 0.025783037766814232
ep3_t0.9_test_time 0.10198640823364258
gc 0
Train Epoch4 Acc 0.9629583333333334 (115555/120000), AUC 0.9942952394485474
ep4_train_time 31.006667375564575
Test Epoch4 threshold 0.9 Acc 0.9100328947368421, AUC 0.97913658618927, avg_entr 0.026407748460769653
ep4_t0.9_test_time 0.10762929916381836
gc 0
Train Epoch5 Acc 0.964575 (115749/120000), AUC 0.994528591632843
ep5_train_time 30.886552095413208
Test Epoch5 threshold 0.9 Acc 0.9087171052631579, AUC 0.9792864322662354, avg_entr 0.025750650092959404
ep5_t0.9_test_time 0.10198426246643066
gc 0
Train Epoch6 Acc 0.9687083333333333 (116245/120000), AUC 0.995506763458252
ep6_train_time 31.091285228729248
Test Epoch6 threshold 0.9 Acc 0.9087171052631579, AUC 0.9789677858352661, avg_entr 0.025647951290011406
ep6_t0.9_test_time 0.10137534141540527
gc 0
Train Epoch7 Acc 0.9699666666666666 (116396/120000), AUC 0.9955899119377136
ep7_train_time 31.274943351745605
Test Epoch7 threshold 0.9 Acc 0.9100328947368421, AUC 0.9788627624511719, avg_entr 0.026430578902363777
ep7_t0.9_test_time 0.10185098648071289
gc 0
Train Epoch8 Acc 0.9709666666666666 (116516/120000), AUC 0.9956987500190735
ep8_train_time 31.237925052642822
Test Epoch8 threshold 0.9 Acc 0.9095394736842105, AUC 0.9788278341293335, avg_entr 0.026458531618118286
ep8_t0.9_test_time 0.10107278823852539
gc 0
Train Epoch9 Acc 0.9723166666666667 (116678/120000), AUC 0.9958655834197998
ep9_train_time 31.088388681411743
Test Epoch9 threshold 0.9 Acc 0.9090460526315789, AUC 0.9784388542175293, avg_entr 0.025891344994306564
ep9_t0.9_test_time 0.10362124443054199
Best AUC 0.9799213409423828
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad50_t0.9_m5//ag_news_lstmal_l5_prefix.pt
Test threshold 0.9 Acc 0.9230263157894737, AUC 0.985787570476532, avg_entr 0.025278206914663315
t0.9_test_time 0.026602745056152344
