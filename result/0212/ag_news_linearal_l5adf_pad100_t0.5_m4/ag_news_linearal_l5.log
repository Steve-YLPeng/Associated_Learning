total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.5_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.058275 (6993/120000), AUC 0.37466973066329956
ep0_train_time 8.274858713150024
Test Epoch0 threshold 0.5 Acc 0.915296052631579, AUC 0.9804188013076782, avg_entr 0.025339841842651367
ep0_t0.5_test_time 0.17354035377502441
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.5_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.126425 (15171/120000), AUC 0.40860986709594727
ep1_train_time 7.805946111679077
Test Epoch1 threshold 0.5 Acc 0.915296052631579, AUC 0.9803231954574585, avg_entr 0.02552197128534317
ep1_t0.5_test_time 0.16573119163513184
gc 0
Train Epoch2 Acc 0.28486666666666666 (34184/120000), AUC 0.4903508126735687
ep2_train_time 7.7949378490448
Test Epoch2 threshold 0.5 Acc 0.9154605263157894, AUC 0.9802463054656982, avg_entr 0.02539709582924843
ep2_t0.5_test_time 0.16536402702331543
gc 0
Train Epoch3 Acc 0.35788333333333333 (42946/120000), AUC 0.5581541657447815
ep3_train_time 7.711286544799805
Test Epoch3 threshold 0.5 Acc 0.9133223684210526, AUC 0.980013370513916, avg_entr 0.024839557707309723
ep3_t0.5_test_time 0.16240549087524414
gc 0
Train Epoch4 Acc 0.3093666666666667 (37124/120000), AUC 0.6059860587120056
ep4_train_time 7.375063896179199
Test Epoch4 threshold 0.5 Acc 0.9134868421052632, AUC 0.9797790050506592, avg_entr 0.025696856901049614
ep4_t0.5_test_time 0.16251039505004883
gc 0
Train Epoch5 Acc 0.2735 (32820/120000), AUC 0.6213939785957336
ep5_train_time 7.42200231552124
Test Epoch5 threshold 0.5 Acc 0.912828947368421, AUC 0.979554295539856, avg_entr 0.02551122196018696
ep5_t0.5_test_time 0.16242647171020508
gc 0
Train Epoch6 Acc 0.25979166666666664 (31175/120000), AUC 0.6305301189422607
ep6_train_time 7.4821107387542725
Test Epoch6 threshold 0.5 Acc 0.9118421052631579, AUC 0.9794668555259705, avg_entr 0.025790417566895485
ep6_t0.5_test_time 0.1614518165588379
gc 0
Train Epoch7 Acc 0.25171666666666664 (30206/120000), AUC 0.6395655274391174
ep7_train_time 7.406843185424805
Test Epoch7 threshold 0.5 Acc 0.9120065789473685, AUC 0.979387104511261, avg_entr 0.026377607136964798
ep7_t0.5_test_time 0.16215825080871582
gc 0
Train Epoch8 Acc 0.247325 (29679/120000), AUC 0.6497488021850586
ep8_train_time 7.530944108963013
Test Epoch8 threshold 0.5 Acc 0.9111842105263158, AUC 0.9792994856834412, avg_entr 0.026242000982165337
ep8_t0.5_test_time 0.16315150260925293
gc 0
Train Epoch9 Acc 0.24526666666666666 (29432/120000), AUC 0.6559850573539734
ep9_train_time 7.399060487747192
Test Epoch9 threshold 0.5 Acc 0.9106907894736842, AUC 0.979210615158081, avg_entr 0.026370013132691383
ep9_t0.5_test_time 0.16286993026733398
Best AUC 0.9804188013076782
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.5_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9256578947368421, AUC 0.9861615300178528, avg_entr 0.02522829733788967
t0.5_test_time 0.0423736572265625
