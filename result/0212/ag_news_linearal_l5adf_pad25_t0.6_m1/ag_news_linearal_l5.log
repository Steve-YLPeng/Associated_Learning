total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2367 (28404/120000), AUC 0.47821658849716187
ep0_train_time 4.289024114608765
Test Epoch0 threshold 0.6 Acc 0.9101973684210526, AUC 0.9789049029350281, avg_entr 0.1499515175819397
ep0_t0.6_test_time 0.07166004180908203
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.23010833333333333 (27613/120000), AUC 0.46992921829223633
ep1_train_time 3.8000452518463135
Test Epoch1 threshold 0.6 Acc 0.9129934210526316, AUC 0.9807783961296082, avg_entr 0.09425058960914612
ep1_t0.6_test_time 0.0709233283996582
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.22840833333333332 (27409/120000), AUC 0.472691148519516
ep2_train_time 3.8087592124938965
Test Epoch2 threshold 0.6 Acc 0.9136513157894737, AUC 0.9807314872741699, avg_entr 0.07462351024150848
ep2_t0.6_test_time 0.07071924209594727
gc 0
Train Epoch3 Acc 0.22738333333333333 (27286/120000), AUC 0.4748225808143616
ep3_train_time 3.958097457885742
Test Epoch3 threshold 0.6 Acc 0.9131578947368421, AUC 0.9810268878936768, avg_entr 0.06523001939058304
ep3_t0.6_test_time 0.07261347770690918
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.22586666666666666 (27104/120000), AUC 0.47608286142349243
ep4_train_time 4.071789979934692
Test Epoch4 threshold 0.6 Acc 0.912828947368421, AUC 0.9801719188690186, avg_entr 0.058476246893405914
ep4_t0.6_test_time 0.07331681251525879
gc 0
Train Epoch5 Acc 0.22473333333333334 (26968/120000), AUC 0.47718095779418945
ep5_train_time 3.8563690185546875
Test Epoch5 threshold 0.6 Acc 0.9136513157894737, AUC 0.9803035259246826, avg_entr 0.053677741438150406
ep5_t0.6_test_time 0.07095670700073242
gc 0
Train Epoch6 Acc 0.223625 (26835/120000), AUC 0.4782688021659851
ep6_train_time 3.8916947841644287
Test Epoch6 threshold 0.6 Acc 0.9116776315789473, AUC 0.9799940586090088, avg_entr 0.04964614659547806
ep6_t0.6_test_time 0.07091736793518066
gc 0
Train Epoch7 Acc 0.222775 (26733/120000), AUC 0.47945454716682434
ep7_train_time 3.849378824234009
Test Epoch7 threshold 0.6 Acc 0.9110197368421052, AUC 0.9794525504112244, avg_entr 0.04633006080985069
ep7_t0.6_test_time 0.07040715217590332
gc 0
Train Epoch8 Acc 0.22184166666666666 (26621/120000), AUC 0.4804040193557739
ep8_train_time 3.865483045578003
Test Epoch8 threshold 0.6 Acc 0.9118421052631579, AUC 0.9793398380279541, avg_entr 0.04408515244722366
ep8_t0.6_test_time 0.07073521614074707
gc 0
Train Epoch9 Acc 0.22195 (26634/120000), AUC 0.48133426904678345
ep9_train_time 3.8012728691101074
Test Epoch9 threshold 0.6 Acc 0.9115131578947369, AUC 0.9794176816940308, avg_entr 0.042778901755809784
ep9_t0.6_test_time 0.07086420059204102
Best AUC 0.9810268878936768
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.6_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9171052631578948, AUC 0.9859850406646729, avg_entr 0.06922145932912827
t0.6_test_time 0.01863884925842285
