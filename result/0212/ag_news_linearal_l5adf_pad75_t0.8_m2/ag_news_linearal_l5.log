total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.8_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.24856666666666666 (29828/120000), AUC 0.3314301371574402
ep0_train_time 6.443676471710205
Test Epoch0 threshold 0.8 Acc 0.9154605263157894, AUC 0.9807145595550537, avg_entr 0.0341641828417778
ep0_t0.8_test_time 0.13344526290893555
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24973333333333333 (29968/120000), AUC 0.26966115832328796
ep1_train_time 6.000173330307007
Test Epoch1 threshold 0.8 Acc 0.915625, AUC 0.9808589816093445, avg_entr 0.030322855338454247
ep1_t0.8_test_time 0.1320188045501709
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24970833333333334 (29965/120000), AUC 0.2732451558113098
ep2_train_time 5.968128442764282
Test Epoch2 threshold 0.8 Acc 0.9161184210526315, AUC 0.9806884527206421, avg_entr 0.028397569432854652
ep2_t0.8_test_time 0.13219857215881348
gc 0
Train Epoch3 Acc 0.24960833333333332 (29953/120000), AUC 0.2763948440551758
ep3_train_time 6.047821760177612
Test Epoch3 threshold 0.8 Acc 0.9136513157894737, AUC 0.9806516170501709, avg_entr 0.02943807654082775
ep3_t0.8_test_time 0.13210225105285645
gc 0
Train Epoch4 Acc 0.24940833333333334 (29929/120000), AUC 0.2781693637371063
ep4_train_time 5.98711371421814
Test Epoch4 threshold 0.8 Acc 0.9138157894736842, AUC 0.9801915884017944, avg_entr 0.027822522446513176
ep4_t0.8_test_time 0.13267898559570312
gc 0
Train Epoch5 Acc 0.249125 (29895/120000), AUC 0.2792033553123474
ep5_train_time 5.971097707748413
Test Epoch5 threshold 0.8 Acc 0.9141447368421053, AUC 0.9798441529273987, avg_entr 0.02683567814528942
ep5_t0.8_test_time 0.13253474235534668
gc 0
Train Epoch6 Acc 0.2489 (29868/120000), AUC 0.27850884199142456
ep6_train_time 5.994784116744995
Test Epoch6 threshold 0.8 Acc 0.9138157894736842, AUC 0.9800512790679932, avg_entr 0.02685004100203514
ep6_t0.8_test_time 0.13173985481262207
gc 0
Train Epoch7 Acc 0.24869166666666667 (29843/120000), AUC 0.27878567576408386
ep7_train_time 5.948647737503052
Test Epoch7 threshold 0.8 Acc 0.9121710526315789, AUC 0.9797409772872925, avg_entr 0.027732718735933304
ep7_t0.8_test_time 0.13333892822265625
gc 0
Train Epoch8 Acc 0.24845 (29814/120000), AUC 0.2790115773677826
ep8_train_time 5.968517303466797
Test Epoch8 threshold 0.8 Acc 0.9139802631578947, AUC 0.9795940518379211, avg_entr 0.02694089338183403
ep8_t0.8_test_time 0.13042068481445312
gc 0
Train Epoch9 Acc 0.24830833333333333 (29797/120000), AUC 0.2793654799461365
ep9_train_time 5.956330060958862
Test Epoch9 threshold 0.8 Acc 0.9125, AUC 0.9795821905136108, avg_entr 0.026110468432307243
ep9_t0.8_test_time 0.13310885429382324
Best AUC 0.9808589816093445
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.8_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.925, AUC 0.9867229461669922, avg_entr 0.02982839196920395
t0.8_test_time 0.03358030319213867
