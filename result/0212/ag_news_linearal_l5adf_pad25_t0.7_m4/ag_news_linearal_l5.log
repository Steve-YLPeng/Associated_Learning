total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.7_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.09213333333333333 (11056/120000), AUC 0.44972726702690125
ep0_train_time 6.041468620300293
Test Epoch0 threshold 0.7 Acc 0.9106907894736842, AUC 0.9797031283378601, avg_entr 0.025654220953583717
ep0_t0.7_test_time 0.07366299629211426
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.7_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.046325 (5559/120000), AUC 0.3926275968551636
ep1_train_time 5.601926803588867
Test Epoch1 threshold 0.7 Acc 0.9126644736842106, AUC 0.9798964262008667, avg_entr 0.025529198348522186
ep1_t0.7_test_time 0.07221317291259766
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.7_m4//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.04468333333333333 (5362/120000), AUC 0.3978487253189087
ep2_train_time 5.64438533782959
Test Epoch2 threshold 0.7 Acc 0.9106907894736842, AUC 0.9795600175857544, avg_entr 0.025542737916111946
ep2_t0.7_test_time 0.07201910018920898
gc 0
Train Epoch3 Acc 0.024033333333333334 (2884/120000), AUC 0.43031707406044006
ep3_train_time 5.553444147109985
Test Epoch3 threshold 0.7 Acc 0.9106907894736842, AUC 0.9793364405632019, avg_entr 0.02528773434460163
ep3_t0.7_test_time 0.07082295417785645
gc 0
Train Epoch4 Acc 0.008833333333333334 (1060/120000), AUC 0.4360600709915161
ep4_train_time 5.478874683380127
Test Epoch4 threshold 0.7 Acc 0.9090460526315789, AUC 0.9789642691612244, avg_entr 0.025805767625570297
ep4_t0.7_test_time 0.0714879035949707
gc 0
Train Epoch5 Acc 0.007733333333333333 (928/120000), AUC 0.4342311918735504
ep5_train_time 5.56921648979187
Test Epoch5 threshold 0.7 Acc 0.909375, AUC 0.9791540503501892, avg_entr 0.0255933478474617
ep5_t0.7_test_time 0.07152509689331055
gc 0
Train Epoch6 Acc 0.0076166666666666666 (914/120000), AUC 0.4305606484413147
ep6_train_time 5.527009963989258
Test Epoch6 threshold 0.7 Acc 0.9108552631578948, AUC 0.978693962097168, avg_entr 0.02574521116912365
ep6_t0.7_test_time 0.07199668884277344
gc 0
Train Epoch7 Acc 0.007716666666666667 (926/120000), AUC 0.42785215377807617
ep7_train_time 5.557693243026733
Test Epoch7 threshold 0.7 Acc 0.9085526315789474, AUC 0.9784770011901855, avg_entr 0.02491375058889389
ep7_t0.7_test_time 0.072967529296875
gc 0
Train Epoch8 Acc 0.008566666666666667 (1028/120000), AUC 0.42555946111679077
ep8_train_time 5.627904891967773
Test Epoch8 threshold 0.7 Acc 0.9100328947368421, AUC 0.9784085154533386, avg_entr 0.02588713727891445
ep8_t0.7_test_time 0.07253408432006836
gc 0
Train Epoch9 Acc 0.009633333333333334 (1156/120000), AUC 0.42391958832740784
ep9_train_time 5.613870143890381
Test Epoch9 threshold 0.7 Acc 0.9092105263157895, AUC 0.9783110022544861, avg_entr 0.02555183134973049
ep9_t0.7_test_time 0.07286810874938965
Best AUC 0.9798964262008667
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.7_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9164473684210527, AUC 0.9845404028892517, avg_entr 0.026564065366983414
t0.7_test_time 0.01891803741455078
