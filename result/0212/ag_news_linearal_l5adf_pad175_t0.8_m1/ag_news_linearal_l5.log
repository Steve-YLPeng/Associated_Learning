total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2503 (30036/120000), AUC 0.537276029586792
ep0_train_time 8.837477922439575
Test Epoch0 threshold 0.8 Acc 0.9011513157894737, AUC 0.9738388061523438, avg_entr 0.18381105363368988
ep0_t0.8_test_time 0.2640252113342285
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.6093035936355591
ep1_train_time 8.150078058242798
Test Epoch1 threshold 0.8 Acc 0.9111842105263158, AUC 0.9778053760528564, avg_entr 0.10545536875724792
ep1_t0.8_test_time 0.25376319885253906
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.6185401082038879
ep2_train_time 8.190028667449951
Test Epoch2 threshold 0.8 Acc 0.9139802631578947, AUC 0.9794816970825195, avg_entr 0.0782601535320282
ep2_t0.8_test_time 0.25347042083740234
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.6199174523353577
ep3_train_time 8.064332008361816
Test Epoch3 threshold 0.8 Acc 0.9134868421052632, AUC 0.9802504777908325, avg_entr 0.07041378319263458
ep3_t0.8_test_time 0.25406718254089355
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.6194028854370117
ep4_train_time 8.049026489257812
Test Epoch4 threshold 0.8 Acc 0.9179276315789474, AUC 0.9805930852890015, avg_entr 0.05890940502285957
ep4_t0.8_test_time 0.2546687126159668
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.6186326146125793
ep5_train_time 8.261028528213501
Test Epoch5 threshold 0.8 Acc 0.9141447368421053, AUC 0.9807260632514954, avg_entr 0.05438391864299774
ep5_t0.8_test_time 0.2546086311340332
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.6181573867797852
ep6_train_time 8.140905618667603
Test Epoch6 threshold 0.8 Acc 0.9161184210526315, AUC 0.9809075593948364, avg_entr 0.049141865223646164
ep6_t0.8_test_time 0.2531118392944336
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.61766117811203
ep7_train_time 8.069993495941162
Test Epoch7 threshold 0.8 Acc 0.9146381578947368, AUC 0.9808540344238281, avg_entr 0.04674527421593666
ep7_t0.8_test_time 0.26425862312316895
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.6173369884490967
ep8_train_time 8.339072704315186
Test Epoch8 threshold 0.8 Acc 0.9167763157894737, AUC 0.980528712272644, avg_entr 0.04339602217078209
ep8_t0.8_test_time 0.25360608100891113
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.616794764995575
ep9_train_time 8.213350296020508
Test Epoch9 threshold 0.8 Acc 0.9154605263157894, AUC 0.9806227684020996, avg_entr 0.0408044159412384
ep9_t0.8_test_time 0.2532503604888916
Best AUC 0.9809075593948364
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9223684210526316, AUC 0.9864419102668762, avg_entr 0.051128361374139786
t0.8_test_time 0.06417346000671387
