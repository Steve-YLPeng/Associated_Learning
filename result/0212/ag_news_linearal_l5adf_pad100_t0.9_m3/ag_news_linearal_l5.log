total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.9_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.2554666666666667 (30656/120000), AUC 0.44299420714378357
ep0_train_time 7.3220131397247314
Test Epoch0 threshold 0.9 Acc 0.9172697368421052, AUC 0.9806238412857056, avg_entr 0.02560214325785637
ep0_t0.9_test_time 0.16251778602600098
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.9_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2526 (30312/120000), AUC 0.4509059190750122
ep1_train_time 6.931379079818726
Test Epoch1 threshold 0.9 Acc 0.9162828947368421, AUC 0.9803749322891235, avg_entr 0.02661716565489769
ep1_t0.9_test_time 0.16058135032653809
gc 0
Train Epoch2 Acc 0.2572583333333333 (30871/120000), AUC 0.47152504324913025
ep2_train_time 6.926836967468262
Test Epoch2 threshold 0.9 Acc 0.9162828947368421, AUC 0.9805747270584106, avg_entr 0.026471685618162155
ep2_t0.9_test_time 0.16025400161743164
gc 0
Train Epoch3 Acc 0.27250833333333335 (32701/120000), AUC 0.5046380758285522
ep3_train_time 6.932701826095581
Test Epoch3 threshold 0.9 Acc 0.9138157894736842, AUC 0.9802106022834778, avg_entr 0.02558242343366146
ep3_t0.9_test_time 0.1600806713104248
gc 0
Train Epoch4 Acc 0.290625 (34875/120000), AUC 0.5306264162063599
ep4_train_time 6.9860310554504395
Test Epoch4 threshold 0.9 Acc 0.9148026315789474, AUC 0.9800136089324951, avg_entr 0.02548033744096756
ep4_t0.9_test_time 0.160170316696167
gc 0
Train Epoch5 Acc 0.30390833333333334 (36469/120000), AUC 0.5405520796775818
ep5_train_time 6.855704069137573
Test Epoch5 threshold 0.9 Acc 0.9146381578947368, AUC 0.9798325896263123, avg_entr 0.02606104500591755
ep5_t0.9_test_time 0.16019058227539062
gc 0
Train Epoch6 Acc 0.306375 (36765/120000), AUC 0.5370612144470215
ep6_train_time 6.874517202377319
Test Epoch6 threshold 0.9 Acc 0.9139802631578947, AUC 0.9795905947685242, avg_entr 0.02567208744585514
ep6_t0.9_test_time 0.15962767601013184
gc 0
Train Epoch7 Acc 0.29555 (35466/120000), AUC 0.530012845993042
ep7_train_time 6.864192485809326
Test Epoch7 threshold 0.9 Acc 0.912828947368421, AUC 0.9795165657997131, avg_entr 0.025989368557929993
ep7_t0.9_test_time 0.15968060493469238
gc 0
Train Epoch8 Acc 0.28378333333333333 (34054/120000), AUC 0.5220853090286255
ep8_train_time 6.865840435028076
Test Epoch8 threshold 0.9 Acc 0.9121710526315789, AUC 0.979408860206604, avg_entr 0.026599697768688202
ep8_t0.9_test_time 0.16019797325134277
gc 0
Train Epoch9 Acc 0.27439166666666664 (32927/120000), AUC 0.5139878988265991
ep9_train_time 6.855335474014282
Test Epoch9 threshold 0.9 Acc 0.9116776315789473, AUC 0.9793784022331238, avg_entr 0.025883935391902924
ep9_t0.9_test_time 0.1623847484588623
Best AUC 0.9806238412857056
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.9_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9236842105263158, AUC 0.9863588213920593, avg_entr 0.02497408352792263
t0.9_test_time 0.040770769119262695
