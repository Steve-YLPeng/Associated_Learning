total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.250025 (30003/120000), AUC 0.5320875644683838
ep0_train_time 5.953086853027344
Test Epoch0 threshold 0.2 Acc 0.9072368421052631, AUC 0.9768863320350647, avg_entr 0.16148175299167633
ep0_t0.2_test_time 0.1428213119506836
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.250075 (30009/120000), AUC 0.553685188293457
ep1_train_time 5.423368453979492
Test Epoch1 threshold 0.2 Acc 0.9162828947368421, AUC 0.9797252416610718, avg_entr 0.09722486883401871
ep1_t0.2_test_time 0.12952232360839844
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2500583333333333 (30007/120000), AUC 0.5548663139343262
ep2_train_time 5.168509006500244
Test Epoch2 threshold 0.2 Acc 0.9161184210526315, AUC 0.9803590178489685, avg_entr 0.07414623349905014
ep2_t0.2_test_time 0.13017892837524414
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25006666666666666 (30008/120000), AUC 0.5557593107223511
ep3_train_time 5.235564708709717
Test Epoch3 threshold 0.2 Acc 0.9171052631578948, AUC 0.9806082248687744, avg_entr 0.06756629049777985
ep3_t0.2_test_time 0.1303262710571289
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25006666666666666 (30008/120000), AUC 0.5559514164924622
ep4_train_time 5.208201169967651
Test Epoch4 threshold 0.2 Acc 0.9169407894736842, AUC 0.980634868144989, avg_entr 0.05882023647427559
ep4_t0.2_test_time 0.12992286682128906
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.250075 (30009/120000), AUC 0.5556336045265198
ep5_train_time 5.178841590881348
Test Epoch5 threshold 0.2 Acc 0.915296052631579, AUC 0.9804844856262207, avg_entr 0.054529160261154175
ep5_t0.2_test_time 0.1298680305480957
gc 0
Train Epoch6 Acc 0.2500583333333333 (30007/120000), AUC 0.5554028153419495
ep6_train_time 5.204019546508789
Test Epoch6 threshold 0.2 Acc 0.9148026315789474, AUC 0.9802404642105103, avg_entr 0.049077436327934265
ep6_t0.2_test_time 0.12961673736572266
gc 0
Train Epoch7 Acc 0.2500583333333333 (30007/120000), AUC 0.5548566579818726
ep7_train_time 5.250425338745117
Test Epoch7 threshold 0.2 Acc 0.9151315789473684, AUC 0.9802500009536743, avg_entr 0.04643767327070236
ep7_t0.2_test_time 0.12919020652770996
gc 0
Train Epoch8 Acc 0.2500583333333333 (30007/120000), AUC 0.554222822189331
ep8_train_time 5.266531229019165
Test Epoch8 threshold 0.2 Acc 0.9143092105263158, AUC 0.9799957275390625, avg_entr 0.04385143145918846
ep8_t0.2_test_time 0.12945151329040527
gc 0
Train Epoch9 Acc 0.25005 (30006/120000), AUC 0.5543938279151917
ep9_train_time 5.242103576660156
Test Epoch9 threshold 0.2 Acc 0.9146381578947368, AUC 0.9800052642822266, avg_entr 0.04198940098285675
ep9_t0.2_test_time 0.13007712364196777
Best AUC 0.980634868144989
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.2_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9282894736842106, AUC 0.9861337542533875, avg_entr 0.06082238629460335
t0.2_test_time 0.03376913070678711
