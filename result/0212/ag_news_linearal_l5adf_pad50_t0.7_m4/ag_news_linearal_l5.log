total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.7_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.16786666666666666 (20144/120000), AUC 0.5101744532585144
ep0_train_time 6.565727233886719
Test Epoch0 threshold 0.7 Acc 0.9146381578947368, AUC 0.980217456817627, avg_entr 0.026263166218996048
ep0_t0.7_test_time 0.10311245918273926
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.7_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.22043333333333334 (26452/120000), AUC 0.5438464283943176
ep1_train_time 6.004637241363525
Test Epoch1 threshold 0.7 Acc 0.9148026315789474, AUC 0.9800360202789307, avg_entr 0.025482134893536568
ep1_t0.7_test_time 0.1002347469329834
gc 0
Train Epoch2 Acc 0.24110833333333334 (28933/120000), AUC 0.5403061509132385
ep2_train_time 6.2870774269104
Test Epoch2 threshold 0.7 Acc 0.9129934210526316, AUC 0.9799067378044128, avg_entr 0.026035433635115623
ep2_t0.7_test_time 0.10534501075744629
gc 0
Train Epoch3 Acc 0.16299166666666667 (19559/120000), AUC 0.5480934381484985
ep3_train_time 6.36342716217041
Test Epoch3 threshold 0.7 Acc 0.9131578947368421, AUC 0.979731023311615, avg_entr 0.026058470830321312
ep3_t0.7_test_time 0.1016242504119873
gc 0
Train Epoch4 Acc 0.10571666666666667 (12686/120000), AUC 0.5581879615783691
ep4_train_time 6.048717975616455
Test Epoch4 threshold 0.7 Acc 0.9105263157894737, AUC 0.979579508304596, avg_entr 0.02620801515877247
ep4_t0.7_test_time 0.10101437568664551
gc 0
Train Epoch5 Acc 0.09946666666666666 (11936/120000), AUC 0.5585337281227112
ep5_train_time 6.078506231307983
Test Epoch5 threshold 0.7 Acc 0.9113486842105263, AUC 0.9793801307678223, avg_entr 0.026313962414860725
ep5_t0.7_test_time 0.10130834579467773
gc 0
Train Epoch6 Acc 0.11199166666666667 (13439/120000), AUC 0.5559338331222534
ep6_train_time 6.097497463226318
Test Epoch6 threshold 0.7 Acc 0.9105263157894737, AUC 0.979128897190094, avg_entr 0.026150543242692947
ep6_t0.7_test_time 0.1006929874420166
gc 0
Train Epoch7 Acc 0.13878333333333334 (16654/120000), AUC 0.5522687435150146
ep7_train_time 6.215147256851196
Test Epoch7 threshold 0.7 Acc 0.9097039473684211, AUC 0.9789855480194092, avg_entr 0.02665877155959606
ep7_t0.7_test_time 0.10475969314575195
gc 0
Train Epoch8 Acc 0.19191666666666668 (23030/120000), AUC 0.5524793863296509
ep8_train_time 6.345462083816528
Test Epoch8 threshold 0.7 Acc 0.9100328947368421, AUC 0.9790376424789429, avg_entr 0.025776170194149017
ep8_t0.7_test_time 0.10460710525512695
gc 0
Train Epoch9 Acc 0.23404166666666668 (28085/120000), AUC 0.5535743832588196
ep9_train_time 6.459190607070923
Test Epoch9 threshold 0.7 Acc 0.9100328947368421, AUC 0.9786902070045471, avg_entr 0.0255891066044569
ep9_t0.7_test_time 0.10492968559265137
Best AUC 0.980217456817627
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.7_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.925, AUC 0.9859703183174133, avg_entr 0.024763282388448715
t0.7_test_time 0.026021957397460938
