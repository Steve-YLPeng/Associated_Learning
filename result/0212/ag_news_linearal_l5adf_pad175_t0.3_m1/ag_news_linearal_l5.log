total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25304166666666666 (30365/120000), AUC 0.4420744776725769
ep0_train_time 8.416497707366943
Test Epoch0 threshold 0.3 Acc 0.8998355263157894, AUC 0.9738094806671143, avg_entr 0.18166664242744446
ep0_t0.3_test_time 0.2501661777496338
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25100833333333333 (30121/120000), AUC 0.38523322343826294
ep1_train_time 8.022728681564331
Test Epoch1 threshold 0.3 Acc 0.9116776315789473, AUC 0.9778081178665161, avg_entr 0.10698385536670685
ep1_t0.3_test_time 0.24897527694702148
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2509166666666667 (30110/120000), AUC 0.38717472553253174
ep2_train_time 7.901787996292114
Test Epoch2 threshold 0.3 Acc 0.9095394736842105, AUC 0.9793367981910706, avg_entr 0.08208046108484268
ep2_t0.3_test_time 0.24900460243225098
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25124166666666664 (30149/120000), AUC 0.39443638920783997
ep3_train_time 8.281503438949585
Test Epoch3 threshold 0.3 Acc 0.9149671052631579, AUC 0.9801759719848633, avg_entr 0.06650988012552261
ep3_t0.3_test_time 0.24848461151123047
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25169166666666665 (30203/120000), AUC 0.4022577404975891
ep4_train_time 7.994613170623779
Test Epoch4 threshold 0.3 Acc 0.9149671052631579, AUC 0.9806188344955444, avg_entr 0.059814032167196274
ep4_t0.3_test_time 0.2486562728881836
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25269166666666665 (30323/120000), AUC 0.408897340297699
ep5_train_time 7.90045952796936
Test Epoch5 threshold 0.3 Acc 0.9157894736842105, AUC 0.9807926416397095, avg_entr 0.05319336801767349
ep5_t0.3_test_time 0.2492814064025879
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.2539166666666667 (30470/120000), AUC 0.41515129804611206
ep6_train_time 8.017810583114624
Test Epoch6 threshold 0.3 Acc 0.9175986842105263, AUC 0.9807456135749817, avg_entr 0.04870135337114334
ep6_t0.3_test_time 0.2485361099243164
gc 0
Train Epoch7 Acc 0.25608333333333333 (30730/120000), AUC 0.42091166973114014
ep7_train_time 8.053293228149414
Test Epoch7 threshold 0.3 Acc 0.9167763157894737, AUC 0.9808089733123779, avg_entr 0.04545270651578903
ep7_t0.3_test_time 0.2489171028137207
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.25903333333333334 (31084/120000), AUC 0.4255775809288025
ep8_train_time 7.991546630859375
Test Epoch8 threshold 0.3 Acc 0.9148026315789474, AUC 0.9807831048965454, avg_entr 0.043264444917440414
ep8_t0.3_test_time 0.24871015548706055
gc 0
Train Epoch9 Acc 0.2619666666666667 (31436/120000), AUC 0.4302068054676056
ep9_train_time 7.937847137451172
Test Epoch9 threshold 0.3 Acc 0.9157894736842105, AUC 0.9805581569671631, avg_entr 0.040374159812927246
ep9_t0.3_test_time 0.24850106239318848
Best AUC 0.9808089733123779
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9230263157894737, AUC 0.9859743118286133, avg_entr 0.04599883779883385
t0.3_test_time 0.0631723403930664
