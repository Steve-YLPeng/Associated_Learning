total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.2_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.25000833333333333 (30001/120000), AUC 0.45843368768692017
ep0_train_time 7.859049081802368
Test Epoch0 threshold 0.2 Acc 0.9146381578947368, AUC 0.9803963303565979, avg_entr 0.0232674703001976
ep0_t0.2_test_time 0.18416523933410645
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.2_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.44107508659362793
ep1_train_time 7.440817356109619
Test Epoch1 threshold 0.2 Acc 0.9149671052631579, AUC 0.980286180973053, avg_entr 0.02305787056684494
ep1_t0.2_test_time 0.18371105194091797
gc 0
Train Epoch2 Acc 0.24998333333333334 (29998/120000), AUC 0.41655921936035156
ep2_train_time 7.391072750091553
Test Epoch2 threshold 0.2 Acc 0.9133223684210526, AUC 0.9802637100219727, avg_entr 0.021698877215385437
ep2_t0.2_test_time 0.1829216480255127
gc 0
Train Epoch3 Acc 0.24995833333333334 (29995/120000), AUC 0.30116328597068787
ep3_train_time 7.441328287124634
Test Epoch3 threshold 0.2 Acc 0.9141447368421053, AUC 0.9800399541854858, avg_entr 0.018927130848169327
ep3_t0.2_test_time 0.18314909934997559
gc 0
Train Epoch4 Acc 0.24935833333333332 (29923/120000), AUC 0.23522132635116577
ep4_train_time 7.987586975097656
Test Epoch4 threshold 0.2 Acc 0.9113486842105263, AUC 0.9798890948295593, avg_entr 0.018487513065338135
ep4_t0.2_test_time 0.2013263702392578
gc 0
Train Epoch5 Acc 0.24946666666666667 (29936/120000), AUC 0.22565189003944397
ep5_train_time 8.651752948760986
Test Epoch5 threshold 0.2 Acc 0.9131578947368421, AUC 0.9798351526260376, avg_entr 0.018139898777008057
ep5_t0.2_test_time 0.19373321533203125
gc 0
Train Epoch6 Acc 0.24954166666666666 (29945/120000), AUC 0.23303107917308807
ep6_train_time 7.669693231582642
Test Epoch6 threshold 0.2 Acc 0.9113486842105263, AUC 0.9795518517494202, avg_entr 0.018049418926239014
ep6_t0.2_test_time 0.18217802047729492
gc 0
Train Epoch7 Acc 0.24940833333333334 (29929/120000), AUC 0.23704874515533447
ep7_train_time 7.430871486663818
Test Epoch7 threshold 0.2 Acc 0.9111842105263158, AUC 0.9794317483901978, avg_entr 0.017322272062301636
ep7_t0.2_test_time 0.18219876289367676
gc 0
Train Epoch8 Acc 0.249525 (29943/120000), AUC 0.24162174761295319
ep8_train_time 7.446402549743652
Test Epoch8 threshold 0.2 Acc 0.9116776315789473, AUC 0.9792687892913818, avg_entr 0.016573818400502205
ep8_t0.2_test_time 0.18247437477111816
gc 0
Train Epoch9 Acc 0.249425 (29931/120000), AUC 0.24297043681144714
ep9_train_time 7.461751461029053
Test Epoch9 threshold 0.2 Acc 0.9113486842105263, AUC 0.9792051911354065, avg_entr 0.017080044373869896
ep9_t0.2_test_time 0.18330144882202148
Best AUC 0.9803963303565979
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.2_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.925, AUC 0.9860793352127075, avg_entr 0.02346518076956272
t0.2_test_time 0.047740936279296875
