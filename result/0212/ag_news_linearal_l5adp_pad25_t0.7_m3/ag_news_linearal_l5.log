total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.7_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.38614166666666666 (46337/120000), AUC 0.5169256925582886
ep0_train_time 5.336758375167847
Test Epoch0 threshold 0.7 Acc 0.9131578947368421, AUC 0.9806702733039856, avg_entr 0.025195633992552757
ep0_t0.7_test_time 0.07253694534301758
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.7_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.41129166666666667 (49355/120000), AUC 0.5227441191673279
ep1_train_time 4.862213850021362
Test Epoch1 threshold 0.7 Acc 0.9141447368421053, AUC 0.9804919362068176, avg_entr 0.02423631213605404
ep1_t0.7_test_time 0.07102465629577637
gc 0
Train Epoch2 Acc 0.4441833333333333 (53302/120000), AUC 0.5935851335525513
ep2_train_time 4.827224493026733
Test Epoch2 threshold 0.7 Acc 0.9125, AUC 0.9803520441055298, avg_entr 0.02510799653828144
ep2_t0.7_test_time 0.0704345703125
gc 0
Train Epoch3 Acc 0.4331083333333333 (51973/120000), AUC 0.6117198467254639
ep3_train_time 5.073912143707275
Test Epoch3 threshold 0.7 Acc 0.9129934210526316, AUC 0.9802050590515137, avg_entr 0.0247998908162117
ep3_t0.7_test_time 0.07279729843139648
gc 0
Train Epoch4 Acc 0.35546666666666665 (42656/120000), AUC 0.5700821280479431
ep4_train_time 5.096369981765747
Test Epoch4 threshold 0.7 Acc 0.9105263157894737, AUC 0.9796862006187439, avg_entr 0.025234585627913475
ep4_t0.7_test_time 0.07352447509765625
gc 0
Train Epoch5 Acc 0.26181666666666664 (31418/120000), AUC 0.5120993256568909
ep5_train_time 5.1141273975372314
Test Epoch5 threshold 0.7 Acc 0.9105263157894737, AUC 0.9794456958770752, avg_entr 0.02534891851246357
ep5_t0.7_test_time 0.07053995132446289
gc 0
Train Epoch6 Acc 0.21599166666666667 (25919/120000), AUC 0.46314457058906555
ep6_train_time 4.857402324676514
Test Epoch6 threshold 0.7 Acc 0.9097039473684211, AUC 0.979079008102417, avg_entr 0.024886613711714745
ep6_t0.7_test_time 0.07011842727661133
gc 0
Train Epoch7 Acc 0.17499166666666666 (20999/120000), AUC 0.4162369966506958
ep7_train_time 4.885364294052124
Test Epoch7 threshold 0.7 Acc 0.9095394736842105, AUC 0.9789818525314331, avg_entr 0.025406446307897568
ep7_t0.7_test_time 0.07085418701171875
gc 0
Train Epoch8 Acc 0.13155 (15786/120000), AUC 0.372985303401947
ep8_train_time 4.850320100784302
Test Epoch8 threshold 0.7 Acc 0.9105263157894737, AUC 0.9788399934768677, avg_entr 0.025205085054039955
ep8_t0.7_test_time 0.07021284103393555
gc 0
Train Epoch9 Acc 0.09795833333333333 (11755/120000), AUC 0.3401806354522705
ep9_train_time 4.850780725479126
Test Epoch9 threshold 0.7 Acc 0.9101973684210526, AUC 0.978739321231842, avg_entr 0.02497757412493229
ep9_t0.7_test_time 0.07105016708374023
Best AUC 0.9806702733039856
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.7_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9197368421052632, AUC 0.9860138893127441, avg_entr 0.02603345736861229
t0.7_test_time 0.01859736442565918
