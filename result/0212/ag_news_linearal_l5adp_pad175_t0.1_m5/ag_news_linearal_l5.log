total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9191333333333334 (110296/120000), AUC 0.9861915111541748
ep0_train_time 10.459786415100098
Test Epoch0 threshold 0.1 Acc 0.9136513157894737, AUC 0.9801474809646606, avg_entr 0.019187835976481438
ep0_t0.1_test_time 0.2909739017486572
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9513333333333334 (114160/120000), AUC 0.9935660362243652
ep1_train_time 10.086927890777588
Test Epoch1 threshold 0.1 Acc 0.9144736842105263, AUC 0.9801017045974731, avg_entr 0.013367065228521824
ep1_t0.1_test_time 0.28785276412963867
gc 0
Train Epoch2 Acc 0.952025 (114243/120000), AUC 0.9937074780464172
ep2_train_time 9.993940353393555
Test Epoch2 threshold 0.1 Acc 0.9115131578947369, AUC 0.9798669815063477, avg_entr 0.012782147154211998
ep2_t0.1_test_time 0.2881889343261719
gc 0
Train Epoch3 Acc 0.9531 (114372/120000), AUC 0.9937005639076233
ep3_train_time 10.057666778564453
Test Epoch3 threshold 0.1 Acc 0.9110197368421052, AUC 0.979631781578064, avg_entr 0.011212261393666267
ep3_t0.1_test_time 0.28783130645751953
gc 0
Train Epoch4 Acc 0.95395 (114474/120000), AUC 0.9940134286880493
ep4_train_time 10.075043678283691
Test Epoch4 threshold 0.1 Acc 0.912828947368421, AUC 0.9798579216003418, avg_entr 0.011780653148889542
ep4_t0.1_test_time 0.28763294219970703
gc 0
Train Epoch5 Acc 0.95565 (114678/120000), AUC 0.9946596026420593
ep5_train_time 9.995445013046265
Test Epoch5 threshold 0.1 Acc 0.9116776315789473, AUC 0.9794758558273315, avg_entr 0.011496644467115402
ep5_t0.1_test_time 0.28763747215270996
gc 0
Train Epoch6 Acc 0.9563083333333333 (114757/120000), AUC 0.994695246219635
ep6_train_time 10.136291027069092
Test Epoch6 threshold 0.1 Acc 0.9118421052631579, AUC 0.9794992804527283, avg_entr 0.010992838069796562
ep6_t0.1_test_time 0.28806185722351074
gc 0
Train Epoch7 Acc 0.95665 (114798/120000), AUC 0.9948805570602417
ep7_train_time 10.104369878768921
Test Epoch7 threshold 0.1 Acc 0.9087171052631579, AUC 0.9790040850639343, avg_entr 0.01173725351691246
ep7_t0.1_test_time 0.2893345355987549
gc 0
Train Epoch8 Acc 0.957125 (114855/120000), AUC 0.9949967265129089
ep8_train_time 10.063327074050903
Test Epoch8 threshold 0.1 Acc 0.9113486842105263, AUC 0.9791830778121948, avg_entr 0.010485709644854069
ep8_t0.1_test_time 0.2873108386993408
gc 0
Train Epoch9 Acc 0.9580083333333334 (114961/120000), AUC 0.9952906370162964
ep9_train_time 10.133717775344849
Test Epoch9 threshold 0.1 Acc 0.9113486842105263, AUC 0.9790774583816528, avg_entr 0.010917470790445805
ep9_t0.1_test_time 0.28820180892944336
Best AUC 0.9801474809646606
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.1_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9210526315789473, AUC 0.9855713844299316, avg_entr 0.01927489973604679
t0.1_test_time 0.07293343544006348
