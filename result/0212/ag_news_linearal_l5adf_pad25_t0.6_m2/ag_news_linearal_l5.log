total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.6_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.2569666666666667 (30836/120000), AUC 0.5455957055091858
ep0_train_time 4.811690807342529
Test Epoch0 threshold 0.6 Acc 0.9134868421052632, AUC 0.9807455539703369, avg_entr 0.030642518773674965
ep0_t0.6_test_time 0.07218337059020996
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24678333333333333 (29614/120000), AUC 0.54368656873703
ep1_train_time 4.3390209674835205
Test Epoch1 threshold 0.6 Acc 0.9126644736842106, AUC 0.9807512760162354, avg_entr 0.02835487574338913
ep1_t0.6_test_time 0.07117009162902832
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.23775 (28530/120000), AUC 0.5435452461242676
ep2_train_time 4.494849443435669
Test Epoch2 threshold 0.6 Acc 0.9126644736842106, AUC 0.9802995324134827, avg_entr 0.027091147378087044
ep2_t0.6_test_time 0.07265233993530273
gc 0
Train Epoch3 Acc 0.2339 (28068/120000), AUC 0.538962721824646
ep3_train_time 4.5897510051727295
Test Epoch3 threshold 0.6 Acc 0.9111842105263158, AUC 0.9794151782989502, avg_entr 0.02719317004084587
ep3_t0.6_test_time 0.07226753234863281
gc 0
Train Epoch4 Acc 0.22895 (27474/120000), AUC 0.5313958525657654
ep4_train_time 4.590374708175659
Test Epoch4 threshold 0.6 Acc 0.9103618421052632, AUC 0.9794788360595703, avg_entr 0.025942472741007805
ep4_t0.6_test_time 0.07336640357971191
gc 0
Train Epoch5 Acc 0.22174166666666667 (26609/120000), AUC 0.5231370329856873
ep5_train_time 4.52702260017395
Test Epoch5 threshold 0.6 Acc 0.9111842105263158, AUC 0.9794664978981018, avg_entr 0.026060502976179123
ep5_t0.6_test_time 0.0712740421295166
gc 0
Train Epoch6 Acc 0.21555833333333332 (25867/120000), AUC 0.5169577598571777
ep6_train_time 4.3478147983551025
Test Epoch6 threshold 0.6 Acc 0.9105263157894737, AUC 0.979218602180481, avg_entr 0.025704121217131615
ep6_t0.6_test_time 0.07092666625976562
gc 0
Train Epoch7 Acc 0.208975 (25077/120000), AUC 0.5109049081802368
ep7_train_time 4.362115859985352
Test Epoch7 threshold 0.6 Acc 0.9106907894736842, AUC 0.9790979623794556, avg_entr 0.025306476280093193
ep7_t0.6_test_time 0.0706644058227539
gc 0
Train Epoch8 Acc 0.20129166666666667 (24155/120000), AUC 0.5045648217201233
ep8_train_time 4.389159917831421
Test Epoch8 threshold 0.6 Acc 0.9098684210526315, AUC 0.9789336323738098, avg_entr 0.02551589533686638
ep8_t0.6_test_time 0.07106351852416992
gc 0
Train Epoch9 Acc 0.19565 (23478/120000), AUC 0.499961793422699
ep9_train_time 4.434215068817139
Test Epoch9 threshold 0.6 Acc 0.9095394736842105, AUC 0.9786576628684998, avg_entr 0.025648485869169235
ep9_t0.6_test_time 0.07136964797973633
Best AUC 0.9807512760162354
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.6_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9171052631578948, AUC 0.9852924346923828, avg_entr 0.030885420739650726
t0.6_test_time 0.018584012985229492
