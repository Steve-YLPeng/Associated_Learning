total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.3_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.201675 (24201/120000), AUC 0.3936685621738434
ep0_train_time 4.87707781791687
Test Epoch0 threshold 0.3 Acc 0.9134868421052632, AUC 0.9811691045761108, avg_entr 0.036135416477918625
ep0_t0.3_test_time 0.08090758323669434
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.3_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.193475 (23217/120000), AUC 0.3536257743835449
ep1_train_time 4.690761089324951
Test Epoch1 threshold 0.3 Acc 0.9141447368421053, AUC 0.9811747074127197, avg_entr 0.03301497921347618
ep1_t0.3_test_time 0.08166885375976562
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.3_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.16665833333333332 (19999/120000), AUC 0.35098689794540405
ep2_train_time 4.646279573440552
Test Epoch2 threshold 0.3 Acc 0.9121710526315789, AUC 0.9805337190628052, avg_entr 0.029650773853063583
ep2_t0.3_test_time 0.08151769638061523
gc 0
Train Epoch3 Acc 0.15088333333333334 (18106/120000), AUC 0.35402634739875793
ep3_train_time 4.626416444778442
Test Epoch3 threshold 0.3 Acc 0.9121710526315789, AUC 0.9802265763282776, avg_entr 0.0287852194160223
ep3_t0.3_test_time 0.07871842384338379
gc 0
Train Epoch4 Acc 0.14815833333333334 (17779/120000), AUC 0.3623046576976776
ep4_train_time 4.377110719680786
Test Epoch4 threshold 0.3 Acc 0.9115131578947369, AUC 0.9801011681556702, avg_entr 0.027293341234326363
ep4_t0.3_test_time 0.07776832580566406
gc 0
Train Epoch5 Acc 0.14829166666666665 (17795/120000), AUC 0.36880308389663696
ep5_train_time 4.390593528747559
Test Epoch5 threshold 0.3 Acc 0.9121710526315789, AUC 0.9800000786781311, avg_entr 0.02755429595708847
ep5_t0.3_test_time 0.07819414138793945
gc 0
Train Epoch6 Acc 0.150125 (18015/120000), AUC 0.37537866830825806
ep6_train_time 4.3904712200164795
Test Epoch6 threshold 0.3 Acc 0.9115131578947369, AUC 0.979598343372345, avg_entr 0.027216723188757896
ep6_t0.3_test_time 0.07954668998718262
gc 0
Train Epoch7 Acc 0.15393333333333334 (18472/120000), AUC 0.3818679451942444
ep7_train_time 4.362632513046265
Test Epoch7 threshold 0.3 Acc 0.9108552631578948, AUC 0.9792977571487427, avg_entr 0.026717757806181908
ep7_t0.3_test_time 0.07848596572875977
gc 0
Train Epoch8 Acc 0.15593333333333334 (18712/120000), AUC 0.38877081871032715
ep8_train_time 4.357044219970703
Test Epoch8 threshold 0.3 Acc 0.9113486842105263, AUC 0.9793081283569336, avg_entr 0.026503562927246094
ep8_t0.3_test_time 0.0784142017364502
gc 0
Train Epoch9 Acc 0.15759166666666666 (18911/120000), AUC 0.39355435967445374
ep9_train_time 4.366795778274536
Test Epoch9 threshold 0.3 Acc 0.9110197368421052, AUC 0.9790964126586914, avg_entr 0.026301680132746696
ep9_t0.3_test_time 0.0780031681060791
Best AUC 0.9811747074127197
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.3_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.925, AUC 0.9856588840484619, avg_entr 0.03445708751678467
t0.3_test_time 0.02054142951965332
