total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25006666666666666 (30008/120000), AUC 0.546463131904602
ep0_train_time 8.508845329284668
Test Epoch0 threshold 0.5 Acc 0.9009868421052631, AUC 0.9739166498184204, avg_entr 0.1839870810508728
ep0_t0.5_test_time 0.258267879486084
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.5593223571777344
ep1_train_time 8.211684226989746
Test Epoch1 threshold 0.5 Acc 0.9098684210526315, AUC 0.9778239130973816, avg_entr 0.10515832155942917
ep1_t0.5_test_time 0.2558634281158447
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.5519704818725586
ep2_train_time 8.045907258987427
Test Epoch2 threshold 0.5 Acc 0.9166118421052631, AUC 0.9795783758163452, avg_entr 0.08121456205844879
ep2_t0.5_test_time 0.25351405143737793
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25001666666666666 (30002/120000), AUC 0.5523930788040161
ep3_train_time 8.19289779663086
Test Epoch3 threshold 0.5 Acc 0.9126644736842106, AUC 0.9801756143569946, avg_entr 0.0688064768910408
ep3_t0.5_test_time 0.25352025032043457
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.2500583333333333 (30007/120000), AUC 0.553918719291687
ep4_train_time 8.065325736999512
Test Epoch4 threshold 0.5 Acc 0.9159539473684211, AUC 0.9807701706886292, avg_entr 0.058540474623441696
ep4_t0.5_test_time 0.2530078887939453
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25014166666666665 (30017/120000), AUC 0.5560672283172607
ep5_train_time 8.013635396957397
Test Epoch5 threshold 0.5 Acc 0.9148026315789474, AUC 0.9806593656539917, avg_entr 0.054171446710824966
ep5_t0.5_test_time 0.2544741630554199
gc 0
Train Epoch6 Acc 0.25028333333333336 (30034/120000), AUC 0.557437539100647
ep6_train_time 8.266109228134155
Test Epoch6 threshold 0.5 Acc 0.9159539473684211, AUC 0.9806324243545532, avg_entr 0.050482895225286484
ep6_t0.5_test_time 0.2634239196777344
gc 0
Train Epoch7 Acc 0.250875 (30105/120000), AUC 0.5591728687286377
ep7_train_time 8.272148609161377
Test Epoch7 threshold 0.5 Acc 0.9161184210526315, AUC 0.9806318879127502, avg_entr 0.04604898765683174
ep7_t0.5_test_time 0.2539801597595215
gc 0
Train Epoch8 Acc 0.25303333333333333 (30364/120000), AUC 0.5603137016296387
ep8_train_time 8.151769161224365
Test Epoch8 threshold 0.5 Acc 0.9143092105263158, AUC 0.9806550741195679, avg_entr 0.04360606521368027
ep8_t0.5_test_time 0.2543799877166748
gc 0
Train Epoch9 Acc 0.2568 (30816/120000), AUC 0.561579167842865
ep9_train_time 8.106049537658691
Test Epoch9 threshold 0.5 Acc 0.915296052631579, AUC 0.9805577397346497, avg_entr 0.04202719032764435
ep9_t0.5_test_time 0.2555248737335205
Best AUC 0.9807701706886292
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9236842105263158, AUC 0.9865196943283081, avg_entr 0.06098823621869087
t0.5_test_time 0.06469106674194336
