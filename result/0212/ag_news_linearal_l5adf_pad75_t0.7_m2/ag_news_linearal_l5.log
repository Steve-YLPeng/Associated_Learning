total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.7_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.15169166666666667 (18203/120000), AUC 0.2889007031917572
ep0_train_time 6.917474746704102
Test Epoch0 threshold 0.7 Acc 0.9157894736842105, AUC 0.9808739423751831, avg_entr 0.032019101083278656
ep0_t0.7_test_time 0.13900256156921387
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.7_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.09855 (11826/120000), AUC 0.24701564013957977
ep1_train_time 6.367629766464233
Test Epoch1 threshold 0.7 Acc 0.9162828947368421, AUC 0.9806722402572632, avg_entr 0.02843058481812477
ep1_t0.7_test_time 0.12987852096557617
gc 0
Train Epoch2 Acc 0.047125 (5655/120000), AUC 0.24768070876598358
ep2_train_time 5.737133502960205
Test Epoch2 threshold 0.7 Acc 0.9146381578947368, AUC 0.9804670810699463, avg_entr 0.02817458100616932
ep2_t0.7_test_time 0.12958812713623047
gc 0
Train Epoch3 Acc 0.025708333333333333 (3085/120000), AUC 0.24941986799240112
ep3_train_time 5.756816864013672
Test Epoch3 threshold 0.7 Acc 0.9138157894736842, AUC 0.980320394039154, avg_entr 0.027591409161686897
ep3_t0.7_test_time 0.13030719757080078
gc 0
Train Epoch4 Acc 0.0164 (1968/120000), AUC 0.2523127794265747
ep4_train_time 5.68975305557251
Test Epoch4 threshold 0.7 Acc 0.9139802631578947, AUC 0.9800390601158142, avg_entr 0.027052555233240128
ep4_t0.7_test_time 0.13087797164916992
gc 0
Train Epoch5 Acc 0.012616666666666667 (1514/120000), AUC 0.25407445430755615
ep5_train_time 5.699438095092773
Test Epoch5 threshold 0.7 Acc 0.9121710526315789, AUC 0.979809582233429, avg_entr 0.026713566854596138
ep5_t0.7_test_time 0.13045310974121094
gc 0
Train Epoch6 Acc 0.011766666666666667 (1412/120000), AUC 0.2559293210506439
ep6_train_time 5.702846050262451
Test Epoch6 threshold 0.7 Acc 0.9120065789473685, AUC 0.9795981645584106, avg_entr 0.02703641913831234
ep6_t0.7_test_time 0.13042521476745605
gc 0
Train Epoch7 Acc 0.0126 (1512/120000), AUC 0.25816479325294495
ep7_train_time 5.699531078338623
Test Epoch7 threshold 0.7 Acc 0.912828947368421, AUC 0.9795008897781372, avg_entr 0.026354072615504265
ep7_t0.7_test_time 0.13042426109313965
gc 0
Train Epoch8 Acc 0.0148 (1776/120000), AUC 0.2605694830417633
ep8_train_time 5.682908058166504
Test Epoch8 threshold 0.7 Acc 0.9121710526315789, AUC 0.9793059825897217, avg_entr 0.02661621756851673
ep8_t0.7_test_time 0.1294112205505371
gc 0
Train Epoch9 Acc 0.016741666666666665 (2009/120000), AUC 0.26190993189811707
ep9_train_time 5.732455253601074
Test Epoch9 threshold 0.7 Acc 0.9116776315789473, AUC 0.979267418384552, avg_entr 0.02678227424621582
ep9_t0.7_test_time 0.13799357414245605
Best AUC 0.9808739423751831
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.7_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9263157894736842, AUC 0.9861789345741272, avg_entr 0.03169497102499008
t0.7_test_time 0.03452110290527344
