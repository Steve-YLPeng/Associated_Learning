total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24770833333333334 (29725/120000), AUC 0.4952544867992401
ep0_train_time 6.449727296829224
Test Epoch0 threshold 0.2 Acc 0.9026315789473685, AUC 0.976026177406311, avg_entr 0.16798649728298187
ep0_t0.2_test_time 0.16367173194885254
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.249975 (29997/120000), AUC 0.51507568359375
ep1_train_time 6.537910461425781
Test Epoch1 threshold 0.2 Acc 0.9138157894736842, AUC 0.9791252017021179, avg_entr 0.09965401887893677
ep1_t0.2_test_time 0.17371153831481934
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24999166666666667 (29999/120000), AUC 0.5215159058570862
ep2_train_time 6.703389406204224
Test Epoch2 threshold 0.2 Acc 0.9138157894736842, AUC 0.9802167415618896, avg_entr 0.07868141680955887
ep2_t0.2_test_time 0.16933441162109375
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5255211591720581
ep3_train_time 6.495882511138916
Test Epoch3 threshold 0.2 Acc 0.9166118421052631, AUC 0.9804297089576721, avg_entr 0.06599031388759613
ep3_t0.2_test_time 0.16485166549682617
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.5281480550765991
ep4_train_time 6.237022399902344
Test Epoch4 threshold 0.2 Acc 0.9169407894736842, AUC 0.9806808233261108, avg_entr 0.05737808719277382
ep4_t0.2_test_time 0.16771602630615234
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25000833333333333 (30001/120000), AUC 0.5298817157745361
ep5_train_time 6.259848594665527
Test Epoch5 threshold 0.2 Acc 0.9143092105263158, AUC 0.9805527329444885, avg_entr 0.05548534542322159
ep5_t0.2_test_time 0.1682262420654297
gc 0
Train Epoch6 Acc 0.25001666666666666 (30002/120000), AUC 0.5310232043266296
ep6_train_time 6.180133819580078
Test Epoch6 threshold 0.2 Acc 0.9161184210526315, AUC 0.9803496599197388, avg_entr 0.04936639964580536
ep6_t0.2_test_time 0.16428184509277344
gc 0
Train Epoch7 Acc 0.25001666666666666 (30002/120000), AUC 0.5318738222122192
ep7_train_time 6.215774774551392
Test Epoch7 threshold 0.2 Acc 0.9139802631578947, AUC 0.9801106452941895, avg_entr 0.04617995768785477
ep7_t0.2_test_time 0.17182660102844238
gc 0
Train Epoch8 Acc 0.25001666666666666 (30002/120000), AUC 0.5323184728622437
ep8_train_time 6.235290765762329
Test Epoch8 threshold 0.2 Acc 0.9126644736842106, AUC 0.9800681471824646, avg_entr 0.043379586189985275
ep8_t0.2_test_time 0.16431188583374023
gc 0
Train Epoch9 Acc 0.25001666666666666 (30002/120000), AUC 0.5327730774879456
ep9_train_time 6.319956064224243
Test Epoch9 threshold 0.2 Acc 0.9149671052631579, AUC 0.9800072312355042, avg_entr 0.042164064943790436
ep9_t0.2_test_time 0.16721296310424805
Best AUC 0.9806808233261108
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.2_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9223684210526316, AUC 0.9862596988677979, avg_entr 0.05844387784600258
t0.2_test_time 0.042258262634277344
