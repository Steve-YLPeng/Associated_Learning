total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.5_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.24085833333333334 (28903/120000), AUC 0.44164609909057617
ep0_train_time 5.71898627281189
Test Epoch0 threshold 0.5 Acc 0.9157894736842105, AUC 0.9804983139038086, avg_entr 0.033920273184776306
ep0_t0.5_test_time 0.10763835906982422
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.232875 (27945/120000), AUC 0.3882877826690674
ep1_train_time 5.084619522094727
Test Epoch1 threshold 0.5 Acc 0.9151315789473684, AUC 0.9804038405418396, avg_entr 0.029911674559116364
ep1_t0.5_test_time 0.10374760627746582
gc 0
Train Epoch2 Acc 0.20485833333333334 (24583/120000), AUC 0.39397144317626953
ep2_train_time 5.021945238113403
Test Epoch2 threshold 0.5 Acc 0.9131578947368421, AUC 0.9805325269699097, avg_entr 0.02875843085348606
ep2_t0.5_test_time 0.10400938987731934
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.15859166666666666 (19031/120000), AUC 0.39688143134117126
ep3_train_time 5.039936304092407
Test Epoch3 threshold 0.5 Acc 0.9123355263157895, AUC 0.9799495935440063, avg_entr 0.028661444783210754
ep3_t0.5_test_time 0.10547685623168945
gc 0
Train Epoch4 Acc 0.11671666666666666 (14006/120000), AUC 0.39812082052230835
ep4_train_time 5.0275726318359375
Test Epoch4 threshold 0.5 Acc 0.9139802631578947, AUC 0.9796871542930603, avg_entr 0.02786806784570217
ep4_t0.5_test_time 0.10499429702758789
gc 0
Train Epoch5 Acc 0.09521666666666667 (11426/120000), AUC 0.39812788367271423
ep5_train_time 5.057477951049805
Test Epoch5 threshold 0.5 Acc 0.9134868421052632, AUC 0.9796000719070435, avg_entr 0.027634337544441223
ep5_t0.5_test_time 0.10335087776184082
gc 0
Train Epoch6 Acc 0.08785833333333333 (10543/120000), AUC 0.3994247615337372
ep6_train_time 5.048344850540161
Test Epoch6 threshold 0.5 Acc 0.9110197368421052, AUC 0.9795132279396057, avg_entr 0.027021925896406174
ep6_t0.5_test_time 0.1034388542175293
gc 0
Train Epoch7 Acc 0.08275 (9930/120000), AUC 0.4002808928489685
ep7_train_time 5.026027202606201
Test Epoch7 threshold 0.5 Acc 0.9116776315789473, AUC 0.9793635606765747, avg_entr 0.0269318800419569
ep7_t0.5_test_time 0.10424065589904785
gc 0
Train Epoch8 Acc 0.0794 (9528/120000), AUC 0.4009821116924286
ep8_train_time 5.026653051376343
Test Epoch8 threshold 0.5 Acc 0.9115131578947369, AUC 0.9794341921806335, avg_entr 0.02632591314613819
ep8_t0.5_test_time 0.10348320007324219
gc 0
Train Epoch9 Acc 0.07740833333333333 (9289/120000), AUC 0.40101850032806396
ep9_train_time 5.124680757522583
Test Epoch9 threshold 0.5 Acc 0.9108552631578948, AUC 0.9791974425315857, avg_entr 0.026717647910118103
ep9_t0.5_test_time 0.10391116142272949
Best AUC 0.9805325269699097
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.5_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9217105263157894, AUC 0.9861608743667603, avg_entr 0.030594859272241592
t0.5_test_time 0.02731800079345703
