total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.5_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.45595 (54714/120000), AUC 0.40773358941078186
ep0_train_time 6.310822486877441
Test Epoch0 threshold 0.5 Acc 0.9154605263157894, AUC 0.9801853895187378, avg_entr 0.0263370294123888
ep0_t0.5_test_time 0.1080935001373291
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.5_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.477525 (57303/120000), AUC 0.3984944522380829
ep1_train_time 5.777821779251099
Test Epoch1 threshold 0.5 Acc 0.9129934210526316, AUC 0.9799096584320068, avg_entr 0.02686162292957306
ep1_t0.5_test_time 0.10343456268310547
gc 0
Train Epoch2 Acc 0.4671 (56052/120000), AUC 0.4067201316356659
ep2_train_time 5.68120813369751
Test Epoch2 threshold 0.5 Acc 0.9146381578947368, AUC 0.9797314405441284, avg_entr 0.0257050059735775
ep2_t0.5_test_time 0.10427474975585938
gc 0
Train Epoch3 Acc 0.45763333333333334 (54916/120000), AUC 0.4147569239139557
ep3_train_time 5.722008466720581
Test Epoch3 threshold 0.5 Acc 0.9116776315789473, AUC 0.97954922914505, avg_entr 0.025631757453083992
ep3_t0.5_test_time 0.10256314277648926
gc 0
Train Epoch4 Acc 0.4453416666666667 (53441/120000), AUC 0.41811704635620117
ep4_train_time 5.697255373001099
Test Epoch4 threshold 0.5 Acc 0.9120065789473685, AUC 0.9793654680252075, avg_entr 0.026427047327160835
ep4_t0.5_test_time 0.10498332977294922
gc 0
Train Epoch5 Acc 0.42715 (51258/120000), AUC 0.4218471050262451
ep5_train_time 5.709759950637817
Test Epoch5 threshold 0.5 Acc 0.9100328947368421, AUC 0.9792740345001221, avg_entr 0.026636144146323204
ep5_t0.5_test_time 0.10299110412597656
gc 0
Train Epoch6 Acc 0.4075416666666667 (48905/120000), AUC 0.42378705739974976
ep6_train_time 5.730508089065552
Test Epoch6 threshold 0.5 Acc 0.909375, AUC 0.9792584180831909, avg_entr 0.02626950293779373
ep6_t0.5_test_time 0.10331153869628906
gc 0
Train Epoch7 Acc 0.38975 (46770/120000), AUC 0.4247092306613922
ep7_train_time 5.748208999633789
Test Epoch7 threshold 0.5 Acc 0.9100328947368421, AUC 0.9789679646492004, avg_entr 0.02605826035141945
ep7_t0.5_test_time 0.10395622253417969
gc 0
Train Epoch8 Acc 0.376375 (45165/120000), AUC 0.42374545335769653
ep8_train_time 5.734078884124756
Test Epoch8 threshold 0.5 Acc 0.9098684210526315, AUC 0.9789174795150757, avg_entr 0.026392074301838875
ep8_t0.5_test_time 0.10332131385803223
gc 0
Train Epoch9 Acc 0.3644 (43728/120000), AUC 0.42295438051223755
ep9_train_time 5.72057843208313
Test Epoch9 threshold 0.5 Acc 0.9090460526315789, AUC 0.9788780808448792, avg_entr 0.026026848703622818
ep9_t0.5_test_time 0.10271763801574707
Best AUC 0.9801853895187378
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.5_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9243421052631579, AUC 0.9861651659011841, avg_entr 0.026470620185136795
t0.5_test_time 0.026477336883544922
