total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.4_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9218333333333333 (110620/120000), AUC 0.9869171380996704
ep0_train_time 7.122791528701782
Test Epoch0 threshold 0.4 Acc 0.9125, AUC 0.9798812866210938, avg_entr 0.025311289355158806
ep0_t0.4_test_time 0.11702275276184082
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.4_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9505666666666667 (114068/120000), AUC 0.9932951927185059
ep1_train_time 6.814636945724487
Test Epoch1 threshold 0.4 Acc 0.9120065789473685, AUC 0.9798010587692261, avg_entr 0.026039879769086838
ep1_t0.4_test_time 0.11210227012634277
gc 0
Train Epoch2 Acc 0.9523 (114276/120000), AUC 0.9935011863708496
ep2_train_time 6.893298149108887
Test Epoch2 threshold 0.4 Acc 0.9115131578947369, AUC 0.9798232316970825, avg_entr 0.025508131831884384
ep2_t0.4_test_time 0.11252808570861816
gc 0
Train Epoch3 Acc 0.9532666666666667 (114392/120000), AUC 0.9936348795890808
ep3_train_time 6.7032952308654785
Test Epoch3 threshold 0.4 Acc 0.9111842105263158, AUC 0.9796028137207031, avg_entr 0.025855498388409615
ep3_t0.4_test_time 0.10685491561889648
gc 0
Train Epoch4 Acc 0.95465 (114558/120000), AUC 0.9941368103027344
ep4_train_time 6.753066301345825
Test Epoch4 threshold 0.4 Acc 0.9100328947368421, AUC 0.9792375564575195, avg_entr 0.02590484544634819
ep4_t0.4_test_time 0.10718226432800293
gc 0
Train Epoch5 Acc 0.9570583333333333 (114847/120000), AUC 0.994901716709137
ep5_train_time 6.668167591094971
Test Epoch5 threshold 0.4 Acc 0.9123355263157895, AUC 0.979161262512207, avg_entr 0.02571573667228222
ep5_t0.4_test_time 0.10719966888427734
gc 0
Train Epoch6 Acc 0.9577 (114924/120000), AUC 0.9950661659240723
ep6_train_time 6.656393527984619
Test Epoch6 threshold 0.4 Acc 0.9088815789473684, AUC 0.9789872169494629, avg_entr 0.026301417499780655
ep6_t0.4_test_time 0.10670852661132812
gc 0
Train Epoch7 Acc 0.9582833333333334 (114994/120000), AUC 0.995205283164978
ep7_train_time 6.687769651412964
Test Epoch7 threshold 0.4 Acc 0.9101973684210526, AUC 0.978842556476593, avg_entr 0.025486266240477562
ep7_t0.4_test_time 0.10684990882873535
gc 0
Train Epoch8 Acc 0.9585333333333333 (115024/120000), AUC 0.9952389001846313
ep8_train_time 6.659445285797119
Test Epoch8 threshold 0.4 Acc 0.9087171052631579, AUC 0.9787372946739197, avg_entr 0.025938736274838448
ep8_t0.4_test_time 0.10908913612365723
gc 0
Train Epoch9 Acc 0.9598333333333333 (115180/120000), AUC 0.9957095384597778
ep9_train_time 6.99254298210144
Test Epoch9 threshold 0.4 Acc 0.9083881578947368, AUC 0.9787667989730835, avg_entr 0.025289226323366165
ep9_t0.4_test_time 0.11048507690429688
Best AUC 0.9798812866210938
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.4_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9269736842105263, AUC 0.9856332540512085, avg_entr 0.024701178073883057
t0.4_test_time 0.02845454216003418
