total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.2_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.907175 (108861/120000), AUC 0.9841288328170776
ep0_train_time 10.486014604568481
Test Epoch0 threshold 0.2 Acc 0.9154605263157894, AUC 0.9803162217140198, avg_entr 0.021499570459127426
ep0_t0.2_test_time 0.28429460525512695
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9515416666666666 (114185/120000), AUC 0.993621826171875
ep1_train_time 10.021183490753174
Test Epoch1 threshold 0.2 Acc 0.9134868421052632, AUC 0.9800440669059753, avg_entr 0.01897098310291767
ep1_t0.2_test_time 0.28304290771484375
gc 0
Train Epoch2 Acc 0.9525666666666667 (114308/120000), AUC 0.9936563968658447
ep2_train_time 10.262671709060669
Test Epoch2 threshold 0.2 Acc 0.9139802631578947, AUC 0.9799895286560059, avg_entr 0.0180375874042511
ep2_t0.2_test_time 0.2810189723968506
gc 0
Train Epoch3 Acc 0.9536833333333333 (114442/120000), AUC 0.9940270781517029
ep3_train_time 10.080681562423706
Test Epoch3 threshold 0.2 Acc 0.9116776315789473, AUC 0.9797897338867188, avg_entr 0.018469342961907387
ep3_t0.2_test_time 0.27991724014282227
gc 0
Train Epoch4 Acc 0.9542833333333334 (114514/120000), AUC 0.9942814707756042
ep4_train_time 10.074580669403076
Test Epoch4 threshold 0.2 Acc 0.9106907894736842, AUC 0.9797171354293823, avg_entr 0.01769970916211605
ep4_t0.2_test_time 0.2805054187774658
gc 0
Train Epoch5 Acc 0.9562833333333334 (114754/120000), AUC 0.9948713183403015
ep5_train_time 10.163166761398315
Test Epoch5 threshold 0.2 Acc 0.9133223684210526, AUC 0.979427695274353, avg_entr 0.017757434397935867
ep5_t0.2_test_time 0.2821195125579834
gc 0
Train Epoch6 Acc 0.956675 (114801/120000), AUC 0.9950337409973145
ep6_train_time 10.111002683639526
Test Epoch6 threshold 0.2 Acc 0.9110197368421052, AUC 0.9793769717216492, avg_entr 0.0167932640761137
ep6_t0.2_test_time 0.2794985771179199
gc 0
Train Epoch7 Acc 0.956975 (114837/120000), AUC 0.9950563311576843
ep7_train_time 10.019393920898438
Test Epoch7 threshold 0.2 Acc 0.9123355263157895, AUC 0.9794510006904602, avg_entr 0.016208043321967125
ep7_t0.2_test_time 0.27898573875427246
gc 0
Train Epoch8 Acc 0.957525 (114903/120000), AUC 0.9951549172401428
ep8_train_time 10.156891107559204
Test Epoch8 threshold 0.2 Acc 0.9098684210526315, AUC 0.979184627532959, avg_entr 0.016722984611988068
ep8_t0.2_test_time 0.27916765213012695
gc 0
Train Epoch9 Acc 0.9585083333333333 (115021/120000), AUC 0.9954980611801147
ep9_train_time 10.083587408065796
Test Epoch9 threshold 0.2 Acc 0.9106907894736842, AUC 0.9791303277015686, avg_entr 0.01603294350206852
ep9_t0.2_test_time 0.2786870002746582
Best AUC 0.9803162217140198
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9217105263157894, AUC 0.985740602016449, avg_entr 0.022613534703850746
t0.2_test_time 0.0723414421081543
