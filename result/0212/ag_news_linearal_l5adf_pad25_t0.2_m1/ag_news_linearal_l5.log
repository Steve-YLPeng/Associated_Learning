total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24980833333333333 (29977/120000), AUC 0.5448393821716309
ep0_train_time 4.293201446533203
Test Epoch0 threshold 0.2 Acc 0.9115131578947369, AUC 0.9793458580970764, avg_entr 0.15198224782943726
ep0_t0.2_test_time 0.07274770736694336
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24793333333333334 (29752/120000), AUC 0.5448412895202637
ep1_train_time 3.8155765533447266
Test Epoch1 threshold 0.2 Acc 0.9129934210526316, AUC 0.9801856875419617, avg_entr 0.09418588876724243
ep1_t0.2_test_time 0.07120132446289062
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24626666666666666 (29552/120000), AUC 0.5391886234283447
ep2_train_time 3.843346118927002
Test Epoch2 threshold 0.2 Acc 0.9125, AUC 0.9809408187866211, avg_entr 0.07528224587440491
ep2_t0.2_test_time 0.07081389427185059
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24481666666666665 (29378/120000), AUC 0.5352879166603088
ep3_train_time 3.8418569564819336
Test Epoch3 threshold 0.2 Acc 0.9126644736842106, AUC 0.9807143211364746, avg_entr 0.06523265689611435
ep3_t0.2_test_time 0.07178044319152832
gc 0
Train Epoch4 Acc 0.24376666666666666 (29252/120000), AUC 0.5321427583694458
ep4_train_time 3.818763256072998
Test Epoch4 threshold 0.2 Acc 0.9133223684210526, AUC 0.9804660081863403, avg_entr 0.058207206428050995
ep4_t0.2_test_time 0.07092475891113281
gc 0
Train Epoch5 Acc 0.24280833333333332 (29137/120000), AUC 0.5293606519699097
ep5_train_time 3.7895348072052
Test Epoch5 threshold 0.2 Acc 0.9121710526315789, AUC 0.9804804921150208, avg_entr 0.05230652540922165
ep5_t0.2_test_time 0.07140374183654785
gc 0
Train Epoch6 Acc 0.241525 (28983/120000), AUC 0.5269945859909058
ep6_train_time 3.8339157104492188
Test Epoch6 threshold 0.2 Acc 0.9110197368421052, AUC 0.9800292253494263, avg_entr 0.05018065497279167
ep6_t0.2_test_time 0.07148241996765137
gc 0
Train Epoch7 Acc 0.24135 (28962/120000), AUC 0.5254859924316406
ep7_train_time 3.8434157371520996
Test Epoch7 threshold 0.2 Acc 0.9118421052631579, AUC 0.9797596335411072, avg_entr 0.047100041061639786
ep7_t0.2_test_time 0.07186365127563477
gc 0
Train Epoch8 Acc 0.24068333333333333 (28882/120000), AUC 0.5239958167076111
ep8_train_time 3.8297998905181885
Test Epoch8 threshold 0.2 Acc 0.9111842105263158, AUC 0.9794661998748779, avg_entr 0.04500015825033188
ep8_t0.2_test_time 0.07189702987670898
gc 0
Train Epoch9 Acc 0.24009166666666668 (28811/120000), AUC 0.5225521922111511
ep9_train_time 3.807577610015869
Test Epoch9 threshold 0.2 Acc 0.9095394736842105, AUC 0.9795452952384949, avg_entr 0.04329447075724602
ep9_t0.2_test_time 0.07123661041259766
Best AUC 0.9809408187866211
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.2_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9217105263157894, AUC 0.9857764840126038, avg_entr 0.08039455860853195
t0.2_test_time 0.01880931854248047
