total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.43967530131340027
ep0_train_time 8.642102718353271
Test Epoch0 threshold 0.2 Acc 0.9001644736842105, AUC 0.9742226600646973, avg_entr 0.18010494112968445
ep0_t0.2_test_time 0.25159311294555664
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.34232088923454285
ep1_train_time 8.254767417907715
Test Epoch1 threshold 0.2 Acc 0.9083881578947368, AUC 0.9780350923538208, avg_entr 0.10985004901885986
ep1_t0.2_test_time 0.2509777545928955
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.3293365240097046
ep2_train_time 8.034050941467285
Test Epoch2 threshold 0.2 Acc 0.912828947368421, AUC 0.9796134233474731, avg_entr 0.08001501113176346
ep2_t0.2_test_time 0.25083065032958984
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.32705235481262207
ep3_train_time 8.089552402496338
Test Epoch3 threshold 0.2 Acc 0.9161184210526315, AUC 0.9804036617279053, avg_entr 0.06664755940437317
ep3_t0.2_test_time 0.25050854682922363
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.32738617062568665
ep4_train_time 7.990191459655762
Test Epoch4 threshold 0.2 Acc 0.9149671052631579, AUC 0.9806764125823975, avg_entr 0.06097555160522461
ep4_t0.2_test_time 0.2506678104400635
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.327747642993927
ep5_train_time 7.9734132289886475
Test Epoch5 threshold 0.2 Acc 0.9144736842105263, AUC 0.9809127449989319, avg_entr 0.05403163284063339
ep5_t0.2_test_time 0.2505826950073242
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.32954391837120056
ep6_train_time 7.968127250671387
Test Epoch6 threshold 0.2 Acc 0.9129934210526316, AUC 0.9808506965637207, avg_entr 0.05124587565660477
ep6_t0.2_test_time 0.25934338569641113
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.3308182954788208
ep7_train_time 8.060853719711304
Test Epoch7 threshold 0.2 Acc 0.9154605263157894, AUC 0.9807234406471252, avg_entr 0.04631863534450531
ep7_t0.2_test_time 0.25103068351745605
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.33227795362472534
ep8_train_time 8.189407110214233
Test Epoch8 threshold 0.2 Acc 0.9151315789473684, AUC 0.9806347489356995, avg_entr 0.04268123582005501
ep8_t0.2_test_time 0.25224781036376953
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.33403080701828003
ep9_train_time 8.114535570144653
Test Epoch9 threshold 0.2 Acc 0.915296052631579, AUC 0.9805412888526917, avg_entr 0.0401909239590168
ep9_t0.2_test_time 0.25174570083618164
Best AUC 0.9809127449989319
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9217105263157894, AUC 0.9861812591552734, avg_entr 0.05645311251282692
t0.2_test_time 0.063720703125
