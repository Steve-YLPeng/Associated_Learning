total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.27663333333333334 (33196/120000), AUC 0.5032018423080444
ep0_train_time 6.591739654541016
Test Epoch0 threshold 0.3 Acc 0.9052631578947369, AUC 0.9756516218185425, avg_entr 0.17173893749713898
ep0_t0.3_test_time 0.16428518295288086
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.29951666666666665 (35942/120000), AUC 0.5435867309570312
ep1_train_time 6.047055006027222
Test Epoch1 threshold 0.3 Acc 0.9113486842105263, AUC 0.9790797233581543, avg_entr 0.10205996781587601
ep1_t0.3_test_time 0.15982866287231445
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.3042166666666667 (36506/120000), AUC 0.5450764894485474
ep2_train_time 5.863723516464233
Test Epoch2 threshold 0.3 Acc 0.9149671052631579, AUC 0.9802944660186768, avg_entr 0.07855889946222305
ep2_t0.3_test_time 0.16013813018798828
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.30698333333333333 (36838/120000), AUC 0.5443698763847351
ep3_train_time 5.841933965682983
Test Epoch3 threshold 0.3 Acc 0.9151315789473684, AUC 0.9804957509040833, avg_entr 0.0667182207107544
ep3_t0.3_test_time 0.16000151634216309
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.30901666666666666 (37082/120000), AUC 0.5431469082832336
ep4_train_time 5.851250171661377
Test Epoch4 threshold 0.3 Acc 0.9154605263157894, AUC 0.9807514548301697, avg_entr 0.0607791393995285
ep4_t0.3_test_time 0.15982437133789062
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.3112916666666667 (37355/120000), AUC 0.5420773029327393
ep5_train_time 5.829493522644043
Test Epoch5 threshold 0.3 Acc 0.9167763157894737, AUC 0.9806674718856812, avg_entr 0.054269708693027496
ep5_t0.3_test_time 0.16029930114746094
gc 0
Train Epoch6 Acc 0.3134 (37608/120000), AUC 0.5413201451301575
ep6_train_time 5.94814395904541
Test Epoch6 threshold 0.3 Acc 0.9129934210526316, AUC 0.9805367588996887, avg_entr 0.05052054673433304
ep6_t0.3_test_time 0.1599562168121338
gc 0
Train Epoch7 Acc 0.315625 (37875/120000), AUC 0.5408210754394531
ep7_train_time 5.878363609313965
Test Epoch7 threshold 0.3 Acc 0.9123355263157895, AUC 0.9803848266601562, avg_entr 0.04749210178852081
ep7_t0.3_test_time 0.15996527671813965
gc 0
Train Epoch8 Acc 0.31776666666666664 (38132/120000), AUC 0.5403265953063965
ep8_train_time 5.842895269393921
Test Epoch8 threshold 0.3 Acc 0.9103618421052632, AUC 0.9799932837486267, avg_entr 0.044957004487514496
ep8_t0.3_test_time 0.16019463539123535
gc 0
Train Epoch9 Acc 0.31895833333333334 (38275/120000), AUC 0.53986656665802
ep9_train_time 5.845913887023926
Test Epoch9 threshold 0.3 Acc 0.9148026315789474, AUC 0.9798930287361145, avg_entr 0.041708026081323624
ep9_t0.3_test_time 0.16029071807861328
Best AUC 0.9807514548301697
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.3_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9263157894736842, AUC 0.9862518906593323, avg_entr 0.06169353425502777
t0.3_test_time 0.04128909111022949
