total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.2_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.30780833333333335 (36937/120000), AUC 0.49147433042526245
ep0_train_time 9.060813426971436
Test Epoch0 threshold 0.2 Acc 0.9167763157894737, AUC 0.9809309244155884, avg_entr 0.026467278599739075
ep0_t0.2_test_time 0.2634718418121338
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4080666666666667 (48968/120000), AUC 0.5415907502174377
ep1_train_time 8.597893714904785
Test Epoch1 threshold 0.2 Acc 0.9157894736842105, AUC 0.9809309244155884, avg_entr 0.025275815278291702
ep1_t0.2_test_time 0.2599172592163086
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.435425 (52251/120000), AUC 0.5445743799209595
ep2_train_time 8.455578565597534
Test Epoch2 threshold 0.2 Acc 0.9169407894736842, AUC 0.9809654355049133, avg_entr 0.025527803227305412
ep2_t0.2_test_time 0.25973010063171387
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.414975 (49797/120000), AUC 0.5448962450027466
ep3_train_time 8.525000810623169
Test Epoch3 threshold 0.2 Acc 0.915296052631579, AUC 0.9807085990905762, avg_entr 0.02534456178545952
ep3_t0.2_test_time 0.25987863540649414
gc 0
Train Epoch4 Acc 0.3864666666666667 (46376/120000), AUC 0.5439649820327759
ep4_train_time 8.735510349273682
Test Epoch4 threshold 0.2 Acc 0.915625, AUC 0.9804685711860657, avg_entr 0.02482285536825657
ep4_t0.2_test_time 0.2604358196258545
gc 0
Train Epoch5 Acc 0.36435833333333334 (43723/120000), AUC 0.5429063439369202
ep5_train_time 8.85605788230896
Test Epoch5 threshold 0.2 Acc 0.9164473684210527, AUC 0.9803820848464966, avg_entr 0.02546379156410694
ep5_t0.2_test_time 0.259005069732666
gc 0
Train Epoch6 Acc 0.34844166666666665 (41813/120000), AUC 0.5422104597091675
ep6_train_time 8.677432775497437
Test Epoch6 threshold 0.2 Acc 0.915625, AUC 0.9804058074951172, avg_entr 0.02497781254351139
ep6_t0.2_test_time 0.2599015235900879
gc 0
Train Epoch7 Acc 0.3389 (40668/120000), AUC 0.5419498682022095
ep7_train_time 8.539382934570312
Test Epoch7 threshold 0.2 Acc 0.912828947368421, AUC 0.9802247285842896, avg_entr 0.025748074054718018
ep7_t0.2_test_time 0.2598271369934082
gc 0
Train Epoch8 Acc 0.3339916666666667 (40079/120000), AUC 0.5414892435073853
ep8_train_time 8.668193578720093
Test Epoch8 threshold 0.2 Acc 0.9151315789473684, AUC 0.980122983455658, avg_entr 0.024986308068037033
ep8_t0.2_test_time 0.26012349128723145
gc 0
Train Epoch9 Acc 0.330225 (39627/120000), AUC 0.5413750410079956
ep9_train_time 8.603996276855469
Test Epoch9 threshold 0.2 Acc 0.9138157894736842, AUC 0.9800430536270142, avg_entr 0.025600427761673927
ep9_t0.2_test_time 0.25958681106567383
Best AUC 0.9809654355049133
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.2_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.925, AUC 0.9862699508666992, avg_entr 0.024735400453209877
t0.2_test_time 0.06543707847595215
