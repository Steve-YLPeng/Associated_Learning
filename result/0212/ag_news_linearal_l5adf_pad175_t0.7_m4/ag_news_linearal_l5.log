total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.2589166666666667 (31070/120000), AUC 0.6719822883605957
ep0_train_time 9.774560451507568
Test Epoch0 threshold 0.7 Acc 0.9167763157894737, AUC 0.9807968735694885, avg_entr 0.02563721500337124
ep0_t0.7_test_time 0.25060367584228516
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24925 (29910/120000), AUC 0.568988561630249
ep1_train_time 9.425234079360962
Test Epoch1 threshold 0.7 Acc 0.9151315789473684, AUC 0.9807029962539673, avg_entr 0.025434469804167747
ep1_t0.7_test_time 0.24959039688110352
gc 0
Train Epoch2 Acc 0.19269166666666668 (23123/120000), AUC 0.4352911114692688
ep2_train_time 9.420512199401855
Test Epoch2 threshold 0.7 Acc 0.9118421052631579, AUC 0.9805305004119873, avg_entr 0.02560945600271225
ep2_t0.7_test_time 0.2493746280670166
gc 0
Train Epoch3 Acc 0.07731666666666667 (9278/120000), AUC 0.39617252349853516
ep3_train_time 9.328047752380371
Test Epoch3 threshold 0.7 Acc 0.9141447368421053, AUC 0.980307400226593, avg_entr 0.0252576544880867
ep3_t0.7_test_time 0.2487044334411621
gc 0
Train Epoch4 Acc 0.10238333333333334 (12286/120000), AUC 0.40879207849502563
ep4_train_time 9.47362208366394
Test Epoch4 threshold 0.7 Acc 0.9143092105263158, AUC 0.9801196455955505, avg_entr 0.02514943853020668
ep4_t0.7_test_time 0.24932456016540527
gc 0
Train Epoch5 Acc 0.17161666666666667 (20594/120000), AUC 0.43160587549209595
ep5_train_time 9.70044231414795
Test Epoch5 threshold 0.7 Acc 0.9146381578947368, AUC 0.9801167249679565, avg_entr 0.025992073118686676
ep5_t0.7_test_time 0.2488570213317871
gc 0
Train Epoch6 Acc 0.20914166666666667 (25097/120000), AUC 0.4405328631401062
ep6_train_time 9.413416862487793
Test Epoch6 threshold 0.7 Acc 0.9133223684210526, AUC 0.9799509644508362, avg_entr 0.02634618617594242
ep6_t0.7_test_time 0.24944114685058594
gc 0
Train Epoch7 Acc 0.22476666666666667 (26972/120000), AUC 0.4436265230178833
ep7_train_time 9.456703662872314
Test Epoch7 threshold 0.7 Acc 0.9120065789473685, AUC 0.979856550693512, avg_entr 0.025959385558962822
ep7_t0.7_test_time 0.24936342239379883
gc 0
Train Epoch8 Acc 0.23236666666666667 (27884/120000), AUC 0.4413912892341614
ep8_train_time 9.460907936096191
Test Epoch8 threshold 0.7 Acc 0.9115131578947369, AUC 0.9796901941299438, avg_entr 0.025437798351049423
ep8_t0.7_test_time 0.24910545349121094
gc 0
Train Epoch9 Acc 0.23065833333333333 (27679/120000), AUC 0.43729478120803833
ep9_train_time 9.411849737167358
Test Epoch9 threshold 0.7 Acc 0.9120065789473685, AUC 0.9796653985977173, avg_entr 0.025954682379961014
ep9_t0.7_test_time 0.24959683418273926
Best AUC 0.9807968735694885
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9230263157894737, AUC 0.9862914085388184, avg_entr 0.024476440623402596
t0.7_test_time 0.06372499465942383
