total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.5502668023109436
ep0_train_time 8.49664044380188
Test Epoch0 threshold 0.6 Acc 0.8970394736842106, AUC 0.9741665124893188, avg_entr 0.18228588998317719
ep0_t0.6_test_time 0.25120091438293457
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.6043108105659485
ep1_train_time 7.878645181655884
Test Epoch1 threshold 0.6 Acc 0.9087171052631579, AUC 0.9780979156494141, avg_entr 0.10372582823038101
ep1_t0.6_test_time 0.24900364875793457
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.6059973239898682
ep2_train_time 8.013471364974976
Test Epoch2 threshold 0.6 Acc 0.9106907894736842, AUC 0.9795992970466614, avg_entr 0.08034157007932663
ep2_t0.6_test_time 0.24884414672851562
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.6046059131622314
ep3_train_time 8.068326711654663
Test Epoch3 threshold 0.6 Acc 0.9154605263157894, AUC 0.980402946472168, avg_entr 0.06529563665390015
ep3_t0.6_test_time 0.24849796295166016
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.6025469303131104
ep4_train_time 8.003789186477661
Test Epoch4 threshold 0.6 Acc 0.9129934210526316, AUC 0.9807710647583008, avg_entr 0.06055614724755287
ep4_t0.6_test_time 0.24956917762756348
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.6008297204971313
ep5_train_time 8.04945182800293
Test Epoch5 threshold 0.6 Acc 0.9167763157894737, AUC 0.9807968139648438, avg_entr 0.052932336926460266
ep5_t0.6_test_time 0.25821518898010254
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.5985562801361084
ep6_train_time 8.107344150543213
Test Epoch6 threshold 0.6 Acc 0.9166118421052631, AUC 0.980927586555481, avg_entr 0.04870982468128204
ep6_t0.6_test_time 0.24913311004638672
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.5966963768005371
ep7_train_time 8.156927347183228
Test Epoch7 threshold 0.6 Acc 0.9157894736842105, AUC 0.9807877540588379, avg_entr 0.04528331384062767
ep7_t0.6_test_time 0.2500128746032715
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.5948517322540283
ep8_train_time 8.075289726257324
Test Epoch8 threshold 0.6 Acc 0.9151315789473684, AUC 0.9806625843048096, avg_entr 0.042545754462480545
ep8_t0.6_test_time 0.2499988079071045
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.5922722816467285
ep9_train_time 7.987663984298706
Test Epoch9 threshold 0.6 Acc 0.9164473684210527, AUC 0.9806026816368103, avg_entr 0.04121578112244606
ep9_t0.6_test_time 0.24855279922485352
Best AUC 0.980927586555481
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9223684210526316, AUC 0.986195981502533, avg_entr 0.05026344582438469
t0.6_test_time 0.06323671340942383
