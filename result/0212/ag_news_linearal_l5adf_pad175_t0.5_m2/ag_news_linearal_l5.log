total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.244325 (29319/120000), AUC 0.4649841785430908
ep0_train_time 9.198270320892334
Test Epoch0 threshold 0.5 Acc 0.9159539473684211, AUC 0.9808222651481628, avg_entr 0.02817091904580593
ep0_t0.5_test_time 0.26290369033813477
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.23898333333333333 (28678/120000), AUC 0.46266424655914307
ep1_train_time 8.758522987365723
Test Epoch1 threshold 0.5 Acc 0.9159539473684211, AUC 0.9809368252754211, avg_entr 0.02731718309223652
ep1_t0.5_test_time 0.25995707511901855
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.21995 (26394/120000), AUC 0.45761382579803467
ep2_train_time 8.770869255065918
Test Epoch2 threshold 0.5 Acc 0.9159539473684211, AUC 0.9810336828231812, avg_entr 0.02713511884212494
ep2_t0.5_test_time 0.2602081298828125
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.214575 (25749/120000), AUC 0.45025667548179626
ep3_train_time 8.780730724334717
Test Epoch3 threshold 0.5 Acc 0.9172697368421052, AUC 0.9807197451591492, avg_entr 0.026249907910823822
ep3_t0.5_test_time 0.2603435516357422
gc 0
Train Epoch4 Acc 0.217775 (26133/120000), AUC 0.44415363669395447
ep4_train_time 8.865322828292847
Test Epoch4 threshold 0.5 Acc 0.9144736842105263, AUC 0.9805397987365723, avg_entr 0.02592645213007927
ep4_t0.5_test_time 0.26021361351013184
gc 0
Train Epoch5 Acc 0.22124166666666667 (26549/120000), AUC 0.44050657749176025
ep5_train_time 8.961087226867676
Test Epoch5 threshold 0.5 Acc 0.9159539473684211, AUC 0.9804894328117371, avg_entr 0.02585241198539734
ep5_t0.5_test_time 0.2618851661682129
gc 0
Train Epoch6 Acc 0.22491666666666665 (26990/120000), AUC 0.43755534291267395
ep6_train_time 8.673664093017578
Test Epoch6 threshold 0.5 Acc 0.9161184210526315, AUC 0.9804144501686096, avg_entr 0.025971388444304466
ep6_t0.5_test_time 0.25965285301208496
gc 0
Train Epoch7 Acc 0.22599166666666667 (27119/120000), AUC 0.4359123706817627
ep7_train_time 8.651012897491455
Test Epoch7 threshold 0.5 Acc 0.915296052631579, AUC 0.9802984595298767, avg_entr 0.025193555280566216
ep7_t0.5_test_time 0.25919008255004883
gc 0
Train Epoch8 Acc 0.22299166666666667 (26759/120000), AUC 0.4341094195842743
ep8_train_time 8.863159656524658
Test Epoch8 threshold 0.5 Acc 0.9149671052631579, AUC 0.9801326990127563, avg_entr 0.02554277330636978
ep8_t0.5_test_time 0.2601790428161621
gc 0
Train Epoch9 Acc 0.21683333333333332 (26020/120000), AUC 0.4319016933441162
ep9_train_time 8.627121925354004
Test Epoch9 threshold 0.5 Acc 0.9133223684210526, AUC 0.9799858927726746, avg_entr 0.026182791218161583
ep9_t0.5_test_time 0.25994038581848145
Best AUC 0.9810336828231812
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9282894736842106, AUC 0.9864294528961182, avg_entr 0.02553563378751278
t0.5_test_time 0.06592726707458496
