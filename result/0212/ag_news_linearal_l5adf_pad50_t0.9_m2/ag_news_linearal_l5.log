total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.9_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.2389 (28668/120000), AUC 0.34136292338371277
ep0_train_time 5.493346452713013
Test Epoch0 threshold 0.9 Acc 0.9184210526315789, AUC 0.9807312488555908, avg_entr 0.03174116834998131
ep0_t0.9_test_time 0.10273480415344238
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.9_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.23565 (28278/120000), AUC 0.3241562843322754
ep1_train_time 5.031466245651245
Test Epoch1 threshold 0.9 Acc 0.9139802631578947, AUC 0.9802852869033813, avg_entr 0.02847689390182495
ep1_t0.9_test_time 0.10070610046386719
gc 0
Train Epoch2 Acc 0.23908333333333334 (28690/120000), AUC 0.32439476251602173
ep2_train_time 5.008296728134155
Test Epoch2 threshold 0.9 Acc 0.9106907894736842, AUC 0.9799351692199707, avg_entr 0.028611700981855392
ep2_t0.9_test_time 0.10114932060241699
gc 0
Train Epoch3 Acc 0.247375 (29685/120000), AUC 0.3282020688056946
ep3_train_time 5.008221626281738
Test Epoch3 threshold 0.9 Acc 0.9126644736842106, AUC 0.980049729347229, avg_entr 0.028072241693735123
ep3_t0.9_test_time 0.10076355934143066
gc 0
Train Epoch4 Acc 0.25521666666666665 (30626/120000), AUC 0.3354637622833252
ep4_train_time 5.000608921051025
Test Epoch4 threshold 0.9 Acc 0.9121710526315789, AUC 0.9797253608703613, avg_entr 0.027190497145056725
ep4_t0.9_test_time 0.10106611251831055
gc 0
Train Epoch5 Acc 0.2547916666666667 (30575/120000), AUC 0.341634601354599
ep5_train_time 5.047389268875122
Test Epoch5 threshold 0.9 Acc 0.9116776315789473, AUC 0.9795773029327393, avg_entr 0.02700689807534218
ep5_t0.9_test_time 0.10111498832702637
gc 0
Train Epoch6 Acc 0.2508166666666667 (30098/120000), AUC 0.34638655185699463
ep6_train_time 5.00254487991333
Test Epoch6 threshold 0.9 Acc 0.9101973684210526, AUC 0.9793795347213745, avg_entr 0.02695094421505928
ep6_t0.9_test_time 0.10106873512268066
gc 0
Train Epoch7 Acc 0.24581666666666666 (29498/120000), AUC 0.3511873483657837
ep7_train_time 5.036068916320801
Test Epoch7 threshold 0.9 Acc 0.9103618421052632, AUC 0.97906494140625, avg_entr 0.02742614410817623
ep7_t0.9_test_time 0.1013941764831543
gc 0
Train Epoch8 Acc 0.23911666666666667 (28694/120000), AUC 0.355890154838562
ep8_train_time 5.2694385051727295
Test Epoch8 threshold 0.9 Acc 0.9098684210526315, AUC 0.9789634943008423, avg_entr 0.027630604803562164
ep8_t0.9_test_time 0.10448122024536133
gc 0
Train Epoch9 Acc 0.235675 (28281/120000), AUC 0.3584980368614197
ep9_train_time 5.458694934844971
Test Epoch9 threshold 0.9 Acc 0.9095394736842105, AUC 0.9789800047874451, avg_entr 0.027043357491493225
ep9_t0.9_test_time 0.10383486747741699
Best AUC 0.9807312488555908
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.9_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9282894736842106, AUC 0.9862509965896606, avg_entr 0.03219108656048775
t0.9_test_time 0.02705526351928711
