total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.7_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.33629166666666666 (40355/120000), AUC 0.6512062549591064
ep0_train_time 5.31239652633667
Test Epoch0 threshold 0.7 Acc 0.9121710526315789, AUC 0.9803147315979004, avg_entr 0.025783440098166466
ep0_t0.7_test_time 0.07311511039733887
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.7_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.332 (39840/120000), AUC 0.6761513948440552
ep1_train_time 4.94588303565979
Test Epoch1 threshold 0.7 Acc 0.9125, AUC 0.9800910949707031, avg_entr 0.025309257209300995
ep1_t0.7_test_time 0.07174110412597656
gc 0
Train Epoch2 Acc 0.3238333333333333 (38860/120000), AUC 0.6896175146102905
ep2_train_time 4.876441955566406
Test Epoch2 threshold 0.7 Acc 0.9111842105263158, AUC 0.9796016812324524, avg_entr 0.02580871246755123
ep2_t0.7_test_time 0.07144618034362793
gc 0
Train Epoch3 Acc 0.3317833333333333 (39814/120000), AUC 0.7062811851501465
ep3_train_time 4.923654079437256
Test Epoch3 threshold 0.7 Acc 0.9106907894736842, AUC 0.9793775081634521, avg_entr 0.025890696793794632
ep3_t0.7_test_time 0.0713043212890625
gc 0
Train Epoch4 Acc 0.3357833333333333 (40294/120000), AUC 0.7300011515617371
ep4_train_time 4.878408908843994
Test Epoch4 threshold 0.7 Acc 0.9110197368421052, AUC 0.9790420532226562, avg_entr 0.025734534487128258
ep4_t0.7_test_time 0.07119321823120117
gc 0
Train Epoch5 Acc 0.3469 (41628/120000), AUC 0.7403982281684875
ep5_train_time 4.892882347106934
Test Epoch5 threshold 0.7 Acc 0.9101973684210526, AUC 0.9791219234466553, avg_entr 0.02539459988474846
ep5_t0.7_test_time 0.07187414169311523
gc 0
Train Epoch6 Acc 0.3954166666666667 (47450/120000), AUC 0.7439483404159546
ep6_train_time 5.212236166000366
Test Epoch6 threshold 0.7 Acc 0.9111842105263158, AUC 0.9788433909416199, avg_entr 0.025233745574951172
ep6_t0.7_test_time 0.07300472259521484
gc 0
Train Epoch7 Acc 0.42190833333333333 (50629/120000), AUC 0.7457616925239563
ep7_train_time 5.190692186355591
Test Epoch7 threshold 0.7 Acc 0.9100328947368421, AUC 0.9787066578865051, avg_entr 0.025866253301501274
ep7_t0.7_test_time 0.07357954978942871
gc 0
Train Epoch8 Acc 0.42695 (51234/120000), AUC 0.7461807727813721
ep8_train_time 5.157373666763306
Test Epoch8 threshold 0.7 Acc 0.9105263157894737, AUC 0.9786455631256104, avg_entr 0.025174127891659737
ep8_t0.7_test_time 0.07370877265930176
gc 0
Train Epoch9 Acc 0.43038333333333334 (51646/120000), AUC 0.7465295791625977
ep9_train_time 5.180709362030029
Test Epoch9 threshold 0.7 Acc 0.9088815789473684, AUC 0.9783378839492798, avg_entr 0.02571754716336727
ep9_t0.7_test_time 0.07226014137268066
Best AUC 0.9803147315979004
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.7_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9197368421052632, AUC 0.9856799840927124, avg_entr 0.02605859376490116
t0.7_test_time 0.018734455108642578
