total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.6_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.246425 (29571/120000), AUC 0.4278014302253723
ep0_train_time 7.9897778034210205
Test Epoch0 threshold 0.6 Acc 0.9171052631578948, AUC 0.9804335832595825, avg_entr 0.02579893358051777
ep0_t0.6_test_time 0.16119146347045898
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.6_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24563333333333334 (29476/120000), AUC 0.4580383896827698
ep1_train_time 7.470299959182739
Test Epoch1 threshold 0.6 Acc 0.9146381578947368, AUC 0.9803663492202759, avg_entr 0.025698205456137657
ep1_t0.6_test_time 0.16022753715515137
gc 0
Train Epoch2 Acc 0.24095833333333333 (28915/120000), AUC 0.3850977122783661
ep2_train_time 7.433148145675659
Test Epoch2 threshold 0.6 Acc 0.9141447368421053, AUC 0.9802555441856384, avg_entr 0.025163529440760612
ep2_t0.6_test_time 0.15958142280578613
gc 0
Train Epoch3 Acc 0.23374166666666665 (28049/120000), AUC 0.3154125511646271
ep3_train_time 7.678725004196167
Test Epoch3 threshold 0.6 Acc 0.9138157894736842, AUC 0.9799517393112183, avg_entr 0.02617630548775196
ep3_t0.6_test_time 0.17470908164978027
gc 0
Train Epoch4 Acc 0.23099166666666668 (27719/120000), AUC 0.30607542395591736
ep4_train_time 8.726222276687622
Test Epoch4 threshold 0.6 Acc 0.9120065789473685, AUC 0.979637622833252, avg_entr 0.026081828400492668
ep4_t0.6_test_time 0.17537140846252441
gc 0
Train Epoch5 Acc 0.23075 (27690/120000), AUC 0.3059619963169098
ep5_train_time 7.842722654342651
Test Epoch5 threshold 0.6 Acc 0.9144736842105263, AUC 0.9796501994132996, avg_entr 0.02608257159590721
ep5_t0.6_test_time 0.16016697883605957
gc 0
Train Epoch6 Acc 0.22795 (27354/120000), AUC 0.3018890619277954
ep6_train_time 7.509936094284058
Test Epoch6 threshold 0.6 Acc 0.9118421052631579, AUC 0.9796517491340637, avg_entr 0.02532108686864376
ep6_t0.6_test_time 0.15988492965698242
gc 0
Train Epoch7 Acc 0.22366666666666668 (26840/120000), AUC 0.2965628504753113
ep7_train_time 7.429013013839722
Test Epoch7 threshold 0.6 Acc 0.9125, AUC 0.9794694185256958, avg_entr 0.025936923921108246
ep7_t0.6_test_time 0.15953779220581055
gc 0
Train Epoch8 Acc 0.217725 (26127/120000), AUC 0.2880992889404297
ep8_train_time 7.457468509674072
Test Epoch8 threshold 0.6 Acc 0.9111842105263158, AUC 0.9793347120285034, avg_entr 0.025865687057375908
ep8_t0.6_test_time 0.1593785285949707
gc 0
Train Epoch9 Acc 0.21125833333333333 (25351/120000), AUC 0.28180453181266785
ep9_train_time 7.443907976150513
Test Epoch9 threshold 0.6 Acc 0.9126644736842106, AUC 0.9792656302452087, avg_entr 0.02562258392572403
ep9_t0.6_test_time 0.15987229347229004
Best AUC 0.9804335832595825
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.6_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9190789473684211, AUC 0.9863064289093018, avg_entr 0.025954080745577812
t0.6_test_time 0.041094064712524414
