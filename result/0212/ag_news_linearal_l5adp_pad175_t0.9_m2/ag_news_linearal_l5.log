total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.24999166666666667 (29999/120000), AUC 0.43330103158950806
ep0_train_time 8.951956510543823
Test Epoch0 threshold 0.9 Acc 0.9161184210526315, AUC 0.981024980545044, avg_entr 0.029193399474024773
ep0_t0.9_test_time 0.25121021270751953
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25000833333333333 (30001/120000), AUC 0.3430999517440796
ep1_train_time 8.704920530319214
Test Epoch1 threshold 0.9 Acc 0.9161184210526315, AUC 0.9809290170669556, avg_entr 0.02703353762626648
ep1_t0.9_test_time 0.2493126392364502
gc 0
Train Epoch2 Acc 0.25004166666666666 (30005/120000), AUC 0.3085733652114868
ep2_train_time 8.352238178253174
Test Epoch2 threshold 0.9 Acc 0.9161184210526315, AUC 0.9808298945426941, avg_entr 0.026856455951929092
ep2_t0.9_test_time 0.25005674362182617
gc 0
Train Epoch3 Acc 0.25019166666666665 (30023/120000), AUC 0.3041708171367645
ep3_train_time 8.706148386001587
Test Epoch3 threshold 0.9 Acc 0.9166118421052631, AUC 0.9807483553886414, avg_entr 0.026154179126024246
ep3_t0.9_test_time 0.259066104888916
gc 0
Train Epoch4 Acc 0.2504 (30048/120000), AUC 0.3063878118991852
ep4_train_time 8.755489587783813
Test Epoch4 threshold 0.9 Acc 0.9151315789473684, AUC 0.9805988073348999, avg_entr 0.026827337220311165
ep4_t0.9_test_time 0.2592172622680664
gc 0
Train Epoch5 Acc 0.250475 (30057/120000), AUC 0.30595070123672485
ep5_train_time 8.458264350891113
Test Epoch5 threshold 0.9 Acc 0.9148026315789474, AUC 0.9805101156234741, avg_entr 0.02640877291560173
ep5_t0.9_test_time 0.24878549575805664
gc 0
Train Epoch6 Acc 0.25050833333333333 (30061/120000), AUC 0.30594807863235474
ep6_train_time 8.598076820373535
Test Epoch6 threshold 0.9 Acc 0.9154605263157894, AUC 0.9803950786590576, avg_entr 0.025787916034460068
ep6_t0.9_test_time 0.25844287872314453
gc 0
Train Epoch7 Acc 0.25048333333333334 (30058/120000), AUC 0.3053126037120819
ep7_train_time 8.436319828033447
Test Epoch7 threshold 0.9 Acc 0.9151315789473684, AUC 0.9803115129470825, avg_entr 0.02625141851603985
ep7_t0.9_test_time 0.25763487815856934
gc 0
Train Epoch8 Acc 0.250425 (30051/120000), AUC 0.3044959604740143
ep8_train_time 8.50365686416626
Test Epoch8 threshold 0.9 Acc 0.9138157894736842, AUC 0.9801825881004333, avg_entr 0.02617780864238739
ep8_t0.9_test_time 0.24969696998596191
gc 0
Train Epoch9 Acc 0.250425 (30051/120000), AUC 0.30343082547187805
ep9_train_time 8.58286452293396
Test Epoch9 threshold 0.9 Acc 0.9143092105263158, AUC 0.9800910353660583, avg_entr 0.026067404076457024
ep9_t0.9_test_time 0.24829840660095215
Best AUC 0.981024980545044
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.925, AUC 0.9863427877426147, avg_entr 0.0295491274446249
t0.9_test_time 0.06312155723571777
