total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.2_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.915775 (109893/120000), AUC 0.9852492809295654
ep0_train_time 7.793302536010742
Test Epoch0 threshold 0.2 Acc 0.9141447368421053, AUC 0.9799920320510864, avg_entr 0.022470366209745407
ep0_t0.2_test_time 0.16902875900268555
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.2_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9501416666666667 (114017/120000), AUC 0.9933038949966431
ep1_train_time 7.346143960952759
Test Epoch1 threshold 0.2 Acc 0.9139802631578947, AUC 0.9798660278320312, avg_entr 0.019493507221341133
ep1_t0.2_test_time 0.16015172004699707
gc 0
Train Epoch2 Acc 0.9522 (114264/120000), AUC 0.9935061931610107
ep2_train_time 7.507603406906128
Test Epoch2 threshold 0.2 Acc 0.9139802631578947, AUC 0.9798734188079834, avg_entr 0.01883603073656559
ep2_t0.2_test_time 0.1642923355102539
gc 0
Train Epoch3 Acc 0.953225 (114387/120000), AUC 0.9936336278915405
ep3_train_time 7.281384229660034
Test Epoch3 threshold 0.2 Acc 0.9131578947368421, AUC 0.9796547889709473, avg_entr 0.018283329904079437
ep3_t0.2_test_time 0.1616511344909668
gc 0
Train Epoch4 Acc 0.9542666666666667 (114512/120000), AUC 0.9940065145492554
ep4_train_time 7.558230638504028
Test Epoch4 threshold 0.2 Acc 0.9113486842105263, AUC 0.9793782234191895, avg_entr 0.017657596617937088
ep4_t0.2_test_time 0.15834975242614746
gc 0
Train Epoch5 Acc 0.9566416666666666 (114797/120000), AUC 0.9948135614395142
ep5_train_time 7.4390363693237305
Test Epoch5 threshold 0.2 Acc 0.9118421052631579, AUC 0.9793877601623535, avg_entr 0.017904004082083702
ep5_t0.2_test_time 0.15707826614379883
gc 0
Train Epoch6 Acc 0.9574083333333333 (114889/120000), AUC 0.9949953556060791
ep6_train_time 7.435675859451294
Test Epoch6 threshold 0.2 Acc 0.9092105263157895, AUC 0.9789426922798157, avg_entr 0.017759613692760468
ep6_t0.2_test_time 0.15944337844848633
gc 0
Train Epoch7 Acc 0.9577333333333333 (114928/120000), AUC 0.9950859546661377
ep7_train_time 7.48004674911499
Test Epoch7 threshold 0.2 Acc 0.9101973684210526, AUC 0.9788937568664551, avg_entr 0.017013709992170334
ep7_t0.2_test_time 0.15970420837402344
gc 0
Train Epoch8 Acc 0.9580666666666666 (114968/120000), AUC 0.9952762126922607
ep8_train_time 7.494431972503662
Test Epoch8 threshold 0.2 Acc 0.9111842105263158, AUC 0.9788591861724854, avg_entr 0.017330637201666832
ep8_t0.2_test_time 0.1589360237121582
gc 0
Train Epoch9 Acc 0.9592083333333333 (115105/120000), AUC 0.9955889582633972
ep9_train_time 7.454718828201294
Test Epoch9 threshold 0.2 Acc 0.9105263157894737, AUC 0.9785511493682861, avg_entr 0.016929689794778824
ep9_t0.2_test_time 0.15718650817871094
Best AUC 0.9799920320510864
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.2_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9282894736842106, AUC 0.9860144257545471, avg_entr 0.02087402157485485
t0.2_test_time 0.041083335876464844
