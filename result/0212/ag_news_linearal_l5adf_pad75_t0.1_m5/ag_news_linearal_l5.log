total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.1_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.911825 (109419/120000), AUC 0.9859281778335571
ep0_train_time 7.859063386917114
Test Epoch0 threshold 0.1 Acc 0.9144736842105263, AUC 0.9798679351806641, avg_entr 0.020501699298620224
ep0_t0.1_test_time 0.16494393348693848
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.1_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.951025 (114123/120000), AUC 0.9935666918754578
ep1_train_time 7.238681077957153
Test Epoch1 threshold 0.1 Acc 0.9123355263157895, AUC 0.979590654373169, avg_entr 0.015584121458232403
ep1_t0.1_test_time 0.16280293464660645
gc 0
Train Epoch2 Acc 0.9527416666666667 (114329/120000), AUC 0.9936199188232422
ep2_train_time 12.09189748764038
Test Epoch2 threshold 0.1 Acc 0.9125, AUC 0.9793479442596436, avg_entr 0.012848174199461937
ep2_t0.1_test_time 0.16626667976379395
gc 0
Train Epoch3 Acc 0.954025 (114483/120000), AUC 0.9936944246292114
ep3_train_time 7.599381685256958
Test Epoch3 threshold 0.1 Acc 0.9110197368421052, AUC 0.9791417121887207, avg_entr 0.012200713157653809
ep3_t0.1_test_time 0.1634376049041748
gc 0
Train Epoch4 Acc 0.9548833333333333 (114586/120000), AUC 0.9941699504852295
ep4_train_time 7.773889780044556
Test Epoch4 threshold 0.1 Acc 0.9115131578947369, AUC 0.9790650606155396, avg_entr 0.011727900244295597
ep4_t0.1_test_time 0.16931891441345215
gc 0
Train Epoch5 Acc 0.9572083333333333 (114865/120000), AUC 0.9948928356170654
ep5_train_time 8.222660064697266
Test Epoch5 threshold 0.1 Acc 0.9095394736842105, AUC 0.9788994789123535, avg_entr 0.01168073620647192
ep5_t0.1_test_time 0.16961264610290527
gc 0
Train Epoch6 Acc 0.95755 (114906/120000), AUC 0.9950343370437622
ep6_train_time 8.00156569480896
Test Epoch6 threshold 0.1 Acc 0.9105263157894737, AUC 0.9786596298217773, avg_entr 0.011613037437200546
ep6_t0.1_test_time 0.16400790214538574
gc 0
Train Epoch7 Acc 0.9580083333333334 (114961/120000), AUC 0.9952155351638794
ep7_train_time 7.748966932296753
Test Epoch7 threshold 0.1 Acc 0.9085526315789474, AUC 0.9783748388290405, avg_entr 0.010944569483399391
ep7_t0.1_test_time 0.16560888290405273
gc 0
Train Epoch8 Acc 0.95825 (114990/120000), AUC 0.9952675104141235
ep8_train_time 7.662665605545044
Test Epoch8 threshold 0.1 Acc 0.9097039473684211, AUC 0.9783381223678589, avg_entr 0.011227802373468876
ep8_t0.1_test_time 0.16524696350097656
gc 0
Train Epoch9 Acc 0.9594833333333334 (115138/120000), AUC 0.9956034421920776
ep9_train_time 7.407329797744751
Test Epoch9 threshold 0.1 Acc 0.909375, AUC 0.9782624244689941, avg_entr 0.010963370092213154
ep9_t0.1_test_time 0.15993666648864746
Best AUC 0.9798679351806641
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.1_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9223684210526316, AUC 0.9852840900421143, avg_entr 0.020289326086640358
t0.1_test_time 0.04131150245666504
