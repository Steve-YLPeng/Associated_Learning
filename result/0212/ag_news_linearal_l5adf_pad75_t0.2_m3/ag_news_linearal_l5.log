total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.2_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.4429166666666667 (53150/120000), AUC 0.683830976486206
ep0_train_time 6.654907464981079
Test Epoch0 threshold 0.2 Acc 0.9134868421052632, AUC 0.9802355766296387, avg_entr 0.02537119761109352
ep0_t0.2_test_time 0.14757084846496582
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.2_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.462925 (55551/120000), AUC 0.6989513039588928
ep1_train_time 6.219979524612427
Test Epoch1 threshold 0.2 Acc 0.9139802631578947, AUC 0.9802190065383911, avg_entr 0.024762962013483047
ep1_t0.2_test_time 0.14652562141418457
gc 0
Train Epoch2 Acc 0.46035 (55242/120000), AUC 0.6533734202384949
ep2_train_time 6.269368886947632
Test Epoch2 threshold 0.2 Acc 0.9129934210526316, AUC 0.9799970388412476, avg_entr 0.02525659091770649
ep2_t0.2_test_time 0.146226167678833
gc 0
Train Epoch3 Acc 0.47326666666666667 (56792/120000), AUC 0.5488835573196411
ep3_train_time 6.41633415222168
Test Epoch3 threshold 0.2 Acc 0.9136513157894737, AUC 0.9799914956092834, avg_entr 0.02313978783786297
ep3_t0.2_test_time 0.1507723331451416
gc 0
Train Epoch4 Acc 0.478775 (57453/120000), AUC 0.4662623703479767
ep4_train_time 6.739932298660278
Test Epoch4 threshold 0.2 Acc 0.9136513157894737, AUC 0.9798233509063721, avg_entr 0.02254335954785347
ep4_t0.2_test_time 0.15079927444458008
gc 0
Train Epoch5 Acc 0.48188333333333333 (57826/120000), AUC 0.45571669936180115
ep5_train_time 6.426852226257324
Test Epoch5 threshold 0.2 Acc 0.9116776315789473, AUC 0.9796491265296936, avg_entr 0.022639427334070206
ep5_t0.2_test_time 0.1457061767578125
gc 0
Train Epoch6 Acc 0.4815583333333333 (57787/120000), AUC 0.45562416315078735
ep6_train_time 6.315295219421387
Test Epoch6 threshold 0.2 Acc 0.9125, AUC 0.9795027375221252, avg_entr 0.021571677178144455
ep6_t0.2_test_time 0.147050142288208
gc 0
Train Epoch7 Acc 0.47829166666666667 (57395/120000), AUC 0.4538358151912689
ep7_train_time 6.314993619918823
Test Epoch7 threshold 0.2 Acc 0.9113486842105263, AUC 0.9792565107345581, avg_entr 0.0207963939756155
ep7_t0.2_test_time 0.14687609672546387
gc 0
Train Epoch8 Acc 0.47396666666666665 (56876/120000), AUC 0.449288934469223
ep8_train_time 6.229223728179932
Test Epoch8 threshold 0.2 Acc 0.9123355263157895, AUC 0.9791156053543091, avg_entr 0.020126106217503548
ep8_t0.2_test_time 0.1463778018951416
gc 0
Train Epoch9 Acc 0.4719583333333333 (56635/120000), AUC 0.44522517919540405
ep9_train_time 6.245825529098511
Test Epoch9 threshold 0.2 Acc 0.9108552631578948, AUC 0.9789929389953613, avg_entr 0.01979421265423298
ep9_t0.2_test_time 0.14782023429870605
Best AUC 0.9802355766296387
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.2_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9269736842105263, AUC 0.9858028888702393, avg_entr 0.023950224742293358
t0.2_test_time 0.037882328033447266
