total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adp_pad25_t0.4_m3//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.24959166666666666 (29951/120000), AUC 0.40963834524154663
ep0_train_time 17.289317846298218
Test Epoch0 threshold 0.4 Acc 0.9118421052631579, AUC 0.9802476167678833, avg_entr 0.02310255914926529
ep0_t0.4_test_time 0.08595418930053711
Save ckpt to ckpt/ag_news_lstmal_l5adp_pad25_t0.4_m4//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.18098333333333333 (21718/120000), AUC 0.389693021774292
ep1_train_time 16.70605182647705
Test Epoch1 threshold 0.4 Acc 0.9110197368421052, AUC 0.9799532890319824, avg_entr 0.02458357624709606
ep1_t0.4_test_time 0.08194661140441895
gc 0
Train Epoch2 Acc 0.101725 (12207/120000), AUC 0.3740730583667755
ep2_train_time 16.25611448287964
Test Epoch2 threshold 0.4 Acc 0.9120065789473685, AUC 0.9794527888298035, avg_entr 0.024207526817917824
ep2_t0.4_test_time 0.08181095123291016
gc 0
Train Epoch3 Acc 0.18229166666666666 (21875/120000), AUC 0.35613641142845154
ep3_train_time 16.686200618743896
Test Epoch3 threshold 0.4 Acc 0.9113486842105263, AUC 0.9794430732727051, avg_entr 0.02399096079170704
ep3_t0.4_test_time 0.07989835739135742
gc 0
Train Epoch4 Acc 0.212375 (25485/120000), AUC 0.35143670439720154
ep4_train_time 17.002782344818115
Test Epoch4 threshold 0.4 Acc 0.9098684210526315, AUC 0.9790601134300232, avg_entr 0.02359243854880333
ep4_t0.4_test_time 0.08171749114990234
gc 0
Train Epoch5 Acc 0.21928333333333333 (26314/120000), AUC 0.34829843044281006
ep5_train_time 16.865047693252563
Test Epoch5 threshold 0.4 Acc 0.9108552631578948, AUC 0.9787862300872803, avg_entr 0.023492110893130302
ep5_t0.4_test_time 0.08018898963928223
gc 0
Train Epoch6 Acc 0.229275 (27513/120000), AUC 0.3446054458618164
ep6_train_time 16.46292543411255
Test Epoch6 threshold 0.4 Acc 0.9110197368421052, AUC 0.9785521626472473, avg_entr 0.02411911077797413
ep6_t0.4_test_time 0.08092904090881348
gc 0
Train Epoch7 Acc 0.23076666666666668 (27692/120000), AUC 0.3378448486328125
ep7_train_time 16.512163639068604
Test Epoch7 threshold 0.4 Acc 0.9097039473684211, AUC 0.9784049987792969, avg_entr 0.02424381487071514
ep7_t0.4_test_time 0.08132219314575195
gc 0
Train Epoch8 Acc 0.233875 (28065/120000), AUC 0.33411943912506104
ep8_train_time 16.44749355316162
Test Epoch8 threshold 0.4 Acc 0.9097039473684211, AUC 0.9781679511070251, avg_entr 0.023741843178868294
ep8_t0.4_test_time 0.08030223846435547
gc 0
Train Epoch9 Acc 0.23248333333333332 (27898/120000), AUC 0.33064407110214233
ep9_train_time 16.739985466003418
Test Epoch9 threshold 0.4 Acc 0.9083881578947368, AUC 0.9780789017677307, avg_entr 0.024014586582779884
ep9_t0.4_test_time 0.08196496963500977
Best AUC 0.9802476167678833
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adp_pad25_t0.4_m4//ag_news_lstmal_l5_prefix.pt
Test threshold 0.4 Acc 0.9203947368421053, AUC 0.9851535558700562, avg_entr 0.024333467707037926
t0.4_test_time 0.02117323875427246
