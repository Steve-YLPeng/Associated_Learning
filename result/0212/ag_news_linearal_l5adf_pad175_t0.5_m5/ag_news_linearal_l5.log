total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.924825 (110979/120000), AUC 0.9855278730392456
ep0_train_time 10.367442607879639
Test Epoch0 threshold 0.5 Acc 0.9159539473684211, AUC 0.9805420637130737, avg_entr 0.026173382997512817
ep0_t0.5_test_time 0.2514171600341797
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9504833333333333 (114058/120000), AUC 0.9932828545570374
ep1_train_time 10.054638147354126
Test Epoch1 threshold 0.5 Acc 0.9139802631578947, AUC 0.9803556203842163, avg_entr 0.02485554851591587
ep1_t0.5_test_time 0.250014066696167
gc 0
Train Epoch2 Acc 0.9514583333333333 (114175/120000), AUC 0.9935306906700134
ep2_train_time 9.893463373184204
Test Epoch2 threshold 0.5 Acc 0.9138157894736842, AUC 0.9801493883132935, avg_entr 0.025130322203040123
ep2_t0.5_test_time 0.24987483024597168
gc 0
Train Epoch3 Acc 0.9529666666666666 (114356/120000), AUC 0.9935089349746704
ep3_train_time 9.909991264343262
Test Epoch3 threshold 0.5 Acc 0.9125, AUC 0.9801095128059387, avg_entr 0.024586129933595657
ep3_t0.5_test_time 0.249772310256958
gc 0
Train Epoch4 Acc 0.953825 (114459/120000), AUC 0.9941219091415405
ep4_train_time 9.959086894989014
Test Epoch4 threshold 0.5 Acc 0.9136513157894737, AUC 0.9799113273620605, avg_entr 0.026215892285108566
ep4_t0.5_test_time 0.2504439353942871
gc 0
Train Epoch5 Acc 0.955575 (114669/120000), AUC 0.9946684837341309
ep5_train_time 10.14610505104065
Test Epoch5 threshold 0.5 Acc 0.9115131578947369, AUC 0.9797940254211426, avg_entr 0.024902714416384697
ep5_t0.5_test_time 0.2504746913909912
gc 0
Train Epoch6 Acc 0.9559583333333334 (114715/120000), AUC 0.994766891002655
ep6_train_time 9.917052030563354
Test Epoch6 threshold 0.5 Acc 0.9121710526315789, AUC 0.9796581268310547, avg_entr 0.02479103021323681
ep6_t0.5_test_time 0.24953079223632812
gc 0
Train Epoch7 Acc 0.956675 (114801/120000), AUC 0.9949285387992859
ep7_train_time 9.858991146087646
Test Epoch7 threshold 0.5 Acc 0.9120065789473685, AUC 0.9795502424240112, avg_entr 0.026694076135754585
ep7_t0.5_test_time 0.25055503845214844
gc 0
Train Epoch8 Acc 0.9572 (114864/120000), AUC 0.9951188564300537
ep8_train_time 9.978999376296997
Test Epoch8 threshold 0.5 Acc 0.9120065789473685, AUC 0.9795328378677368, avg_entr 0.026315337046980858
ep8_t0.5_test_time 0.2502748966217041
gc 0
Train Epoch9 Acc 0.9580666666666666 (114968/120000), AUC 0.99531489610672
ep9_train_time 9.872622966766357
Test Epoch9 threshold 0.5 Acc 0.9110197368421052, AUC 0.9794898629188538, avg_entr 0.026421425864100456
ep9_t0.5_test_time 0.2499101161956787
Best AUC 0.9805420637130737
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9282894736842106, AUC 0.9861694574356079, avg_entr 0.02494088001549244
t0.5_test_time 0.06443524360656738
