total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.7_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.2003 (24036/120000), AUC 0.45059633255004883
ep0_train_time 6.147512435913086
Test Epoch0 threshold 0.7 Acc 0.9144736842105263, AUC 0.9805037379264832, avg_entr 0.02636164426803589
ep0_t0.7_test_time 0.10599422454833984
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.7_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.12578333333333333 (15094/120000), AUC 0.422968327999115
ep1_train_time 5.9456422328948975
Test Epoch1 threshold 0.7 Acc 0.9141447368421053, AUC 0.9800028800964355, avg_entr 0.026732327416539192
ep1_t0.7_test_time 0.10362625122070312
gc 0
Train Epoch2 Acc 0.12431666666666667 (14918/120000), AUC 0.4191584885120392
ep2_train_time 5.7794029712677
Test Epoch2 threshold 0.7 Acc 0.9134868421052632, AUC 0.9804180860519409, avg_entr 0.026690157130360603
ep2_t0.7_test_time 0.10064387321472168
gc 0
Train Epoch3 Acc 0.12736666666666666 (15284/120000), AUC 0.42902883887290955
ep3_train_time 5.537136793136597
Test Epoch3 threshold 0.7 Acc 0.9115131578947369, AUC 0.9798835515975952, avg_entr 0.02585834264755249
ep3_t0.7_test_time 0.10199308395385742
gc 0
Train Epoch4 Acc 0.129875 (15585/120000), AUC 0.45616549253463745
ep4_train_time 5.532588005065918
Test Epoch4 threshold 0.7 Acc 0.9105263157894737, AUC 0.9795098304748535, avg_entr 0.026531385257840157
ep4_t0.7_test_time 0.10037994384765625
gc 0
Train Epoch5 Acc 0.12541666666666668 (15050/120000), AUC 0.47486448287963867
ep5_train_time 5.561160087585449
Test Epoch5 threshold 0.7 Acc 0.9095394736842105, AUC 0.9791381359100342, avg_entr 0.027059653773903847
ep5_t0.7_test_time 0.09969806671142578
gc 0
Train Epoch6 Acc 0.12195833333333334 (14635/120000), AUC 0.48740124702453613
ep6_train_time 5.4920876026153564
Test Epoch6 threshold 0.7 Acc 0.9116776315789473, AUC 0.9791298508644104, avg_entr 0.0266307033598423
ep6_t0.7_test_time 0.10142326354980469
gc 0
Train Epoch7 Acc 0.11675833333333334 (14011/120000), AUC 0.500390887260437
ep7_train_time 5.5556066036224365
Test Epoch7 threshold 0.7 Acc 0.9110197368421052, AUC 0.9792640209197998, avg_entr 0.025899047031998634
ep7_t0.7_test_time 0.10039091110229492
gc 0
Train Epoch8 Acc 0.1221 (14652/120000), AUC 0.5117218494415283
ep8_train_time 5.5569822788238525
Test Epoch8 threshold 0.7 Acc 0.9106907894736842, AUC 0.9789568781852722, avg_entr 0.02651153691112995
ep8_t0.7_test_time 0.10101532936096191
gc 0
Train Epoch9 Acc 0.136875 (16425/120000), AUC 0.5183207392692566
ep9_train_time 5.607280492782593
Test Epoch9 threshold 0.7 Acc 0.9103618421052632, AUC 0.9787873029708862, avg_entr 0.02669636160135269
ep9_t0.7_test_time 0.10371971130371094
Best AUC 0.9805037379264832
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.7_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9269736842105263, AUC 0.9861060380935669, avg_entr 0.025887712836265564
t0.7_test_time 0.025983810424804688
