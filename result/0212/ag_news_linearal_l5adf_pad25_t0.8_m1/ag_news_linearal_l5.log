total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24234166666666668 (29081/120000), AUC 0.4883018732070923
ep0_train_time 4.426802396774292
Test Epoch0 threshold 0.8 Acc 0.9113486842105263, AUC 0.9795138835906982, avg_entr 0.1543450653553009
ep0_t0.8_test_time 0.0741724967956543
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24369166666666667 (29243/120000), AUC 0.4962858557701111
ep1_train_time 3.8366239070892334
Test Epoch1 threshold 0.8 Acc 0.9138157894736842, AUC 0.9807521104812622, avg_entr 0.09497959911823273
ep1_t0.8_test_time 0.07270479202270508
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24533333333333332 (29440/120000), AUC 0.4980638921260834
ep2_train_time 3.8575847148895264
Test Epoch2 threshold 0.8 Acc 0.9143092105263158, AUC 0.9809215068817139, avg_entr 0.07630288600921631
ep2_t0.8_test_time 0.07301974296569824
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24606666666666666 (29528/120000), AUC 0.4993366003036499
ep3_train_time 3.829420804977417
Test Epoch3 threshold 0.8 Acc 0.9123355263157895, AUC 0.9806122779846191, avg_entr 0.06520956754684448
ep3_t0.8_test_time 0.07217168807983398
gc 0
Train Epoch4 Acc 0.24756666666666666 (29708/120000), AUC 0.500495433807373
ep4_train_time 3.8283708095550537
Test Epoch4 threshold 0.8 Acc 0.9133223684210526, AUC 0.9803882837295532, avg_entr 0.059230271726846695
ep4_t0.8_test_time 0.0722205638885498
gc 0
Train Epoch5 Acc 0.24891666666666667 (29870/120000), AUC 0.5011002421379089
ep5_train_time 3.8525071144104004
Test Epoch5 threshold 0.8 Acc 0.9136513157894737, AUC 0.98067307472229, avg_entr 0.05451696366071701
ep5_t0.8_test_time 0.07134842872619629
gc 0
Train Epoch6 Acc 0.25025833333333336 (30031/120000), AUC 0.5014147758483887
ep6_train_time 3.821204662322998
Test Epoch6 threshold 0.8 Acc 0.9115131578947369, AUC 0.9799973964691162, avg_entr 0.04984824359416962
ep6_t0.8_test_time 0.07076382637023926
gc 0
Train Epoch7 Acc 0.25114166666666665 (30137/120000), AUC 0.5019844174385071
ep7_train_time 3.817485809326172
Test Epoch7 threshold 0.8 Acc 0.9111842105263158, AUC 0.9796217083930969, avg_entr 0.048341184854507446
ep7_t0.8_test_time 0.07175850868225098
gc 0
Train Epoch8 Acc 0.2519416666666667 (30233/120000), AUC 0.5027056932449341
ep8_train_time 3.8284194469451904
Test Epoch8 threshold 0.8 Acc 0.9123355263157895, AUC 0.9796133637428284, avg_entr 0.045984163880348206
ep8_t0.8_test_time 0.0718390941619873
gc 0
Train Epoch9 Acc 0.2523166666666667 (30278/120000), AUC 0.5031766891479492
ep9_train_time 3.845355272293091
Test Epoch9 threshold 0.8 Acc 0.9123355263157895, AUC 0.9792858362197876, avg_entr 0.0437060222029686
ep9_t0.8_test_time 0.07278800010681152
Best AUC 0.9809215068817139
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.8_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9217105263157894, AUC 0.986133337020874, avg_entr 0.08095340430736542
t0.8_test_time 0.018664121627807617
