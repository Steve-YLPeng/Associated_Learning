total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.8_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.256825 (30819/120000), AUC 0.4729059338569641
ep0_train_time 5.066472291946411
Test Epoch0 threshold 0.8 Acc 0.9149671052631579, AUC 0.9807525873184204, avg_entr 0.032952312380075455
ep0_t0.8_test_time 0.07573962211608887
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25879166666666664 (31055/120000), AUC 0.45329585671424866
ep1_train_time 4.470187187194824
Test Epoch1 threshold 0.8 Acc 0.9136513157894737, AUC 0.9807796478271484, avg_entr 0.03037325292825699
ep1_t0.8_test_time 0.07126784324645996
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.8_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.26415 (31698/120000), AUC 0.45029914379119873
ep2_train_time 4.380728006362915
Test Epoch2 threshold 0.8 Acc 0.9141447368421053, AUC 0.98045414686203, avg_entr 0.028827346861362457
ep2_t0.8_test_time 0.07105350494384766
gc 0
Train Epoch3 Acc 0.2632 (31584/120000), AUC 0.44947725534439087
ep3_train_time 4.332899808883667
Test Epoch3 threshold 0.8 Acc 0.9115131578947369, AUC 0.9805002808570862, avg_entr 0.028058787807822227
ep3_t0.8_test_time 0.07075023651123047
gc 0
Train Epoch4 Acc 0.25924166666666665 (31109/120000), AUC 0.4507179260253906
ep4_train_time 4.373975038528442
Test Epoch4 threshold 0.8 Acc 0.9106907894736842, AUC 0.9800846576690674, avg_entr 0.02822428196668625
ep4_t0.8_test_time 0.07132267951965332
gc 0
Train Epoch5 Acc 0.25566666666666665 (30680/120000), AUC 0.4521413743495941
ep5_train_time 4.3571648597717285
Test Epoch5 threshold 0.8 Acc 0.9116776315789473, AUC 0.9799081087112427, avg_entr 0.026714250445365906
ep5_t0.8_test_time 0.07152462005615234
gc 0
Train Epoch6 Acc 0.2537 (30444/120000), AUC 0.4553108215332031
ep6_train_time 4.3640735149383545
Test Epoch6 threshold 0.8 Acc 0.9126644736842106, AUC 0.9795630574226379, avg_entr 0.026638397946953773
ep6_t0.8_test_time 0.07086443901062012
gc 0
Train Epoch7 Acc 0.25161666666666666 (30194/120000), AUC 0.45885393023490906
ep7_train_time 4.334340572357178
Test Epoch7 threshold 0.8 Acc 0.9110197368421052, AUC 0.9792231321334839, avg_entr 0.026781871914863586
ep7_t0.8_test_time 0.07100486755371094
gc 0
Train Epoch8 Acc 0.24943333333333334 (29932/120000), AUC 0.4633859395980835
ep8_train_time 4.354243755340576
Test Epoch8 threshold 0.8 Acc 0.9105263157894737, AUC 0.9792485237121582, avg_entr 0.02696716971695423
ep8_t0.8_test_time 0.07075023651123047
gc 0
Train Epoch9 Acc 0.24758333333333332 (29710/120000), AUC 0.4662078619003296
ep9_train_time 4.352048635482788
Test Epoch9 threshold 0.8 Acc 0.9101973684210526, AUC 0.9789301753044128, avg_entr 0.026619838550686836
ep9_t0.8_test_time 0.07066822052001953
Best AUC 0.9807796478271484
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.8_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9236842105263158, AUC 0.9858176708221436, avg_entr 0.03191649541258812
t0.8_test_time 0.019165515899658203
