total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.20619166666666666 (24743/120000), AUC 0.4560454487800598
ep0_train_time 8.46859359741211
Test Epoch0 threshold 0.7 Acc 0.8983552631578947, AUC 0.9737133979797363, avg_entr 0.1832733303308487
ep0_t0.7_test_time 0.25275135040283203
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2501833333333333 (30022/120000), AUC 0.42316314578056335
ep1_train_time 8.13784384727478
Test Epoch1 threshold 0.7 Acc 0.9111842105263158, AUC 0.9776084423065186, avg_entr 0.10694147646427155
ep1_t0.7_test_time 0.2516627311706543
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2507 (30084/120000), AUC 0.427388459444046
ep2_train_time 8.059760570526123
Test Epoch2 threshold 0.7 Acc 0.9154605263157894, AUC 0.9794027805328369, avg_entr 0.0780567079782486
ep2_t0.7_test_time 0.25781893730163574
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.250675 (30081/120000), AUC 0.4335210919380188
ep3_train_time 8.264304399490356
Test Epoch3 threshold 0.7 Acc 0.915625, AUC 0.9801120758056641, avg_entr 0.06566597521305084
ep3_t0.7_test_time 0.2519810199737549
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.2506083333333333 (30073/120000), AUC 0.4392279386520386
ep4_train_time 8.087957620620728
Test Epoch4 threshold 0.7 Acc 0.9144736842105263, AUC 0.9805091023445129, avg_entr 0.05823931470513344
ep4_t0.7_test_time 0.2509908676147461
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25064166666666665 (30077/120000), AUC 0.4452933669090271
ep5_train_time 8.118210315704346
Test Epoch5 threshold 0.7 Acc 0.9161184210526315, AUC 0.9807326197624207, avg_entr 0.05263978987932205
ep5_t0.7_test_time 0.2522006034851074
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.250675 (30081/120000), AUC 0.4505423903465271
ep6_train_time 7.99238395690918
Test Epoch6 threshold 0.7 Acc 0.9161184210526315, AUC 0.980713963508606, avg_entr 0.048388510942459106
ep6_t0.7_test_time 0.2513163089752197
gc 0
Train Epoch7 Acc 0.25069166666666665 (30083/120000), AUC 0.45499369502067566
ep7_train_time 7.9753077030181885
Test Epoch7 threshold 0.7 Acc 0.9166118421052631, AUC 0.9806898832321167, avg_entr 0.045151665806770325
ep7_t0.7_test_time 0.25073671340942383
gc 0
Train Epoch8 Acc 0.2507083333333333 (30085/120000), AUC 0.4593085050582886
ep8_train_time 8.011590957641602
Test Epoch8 threshold 0.7 Acc 0.9175986842105263, AUC 0.9805022478103638, avg_entr 0.04193475469946861
ep8_t0.7_test_time 0.24918198585510254
gc 0
Train Epoch9 Acc 0.25071666666666664 (30086/120000), AUC 0.4628234803676605
ep9_train_time 8.182427883148193
Test Epoch9 threshold 0.7 Acc 0.9159539473684211, AUC 0.9802651405334473, avg_entr 0.0395108237862587
ep9_t0.7_test_time 0.2619016170501709
Best AUC 0.9807326197624207
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9230263157894737, AUC 0.9863893389701843, avg_entr 0.054714806377887726
t0.7_test_time 0.06475949287414551
