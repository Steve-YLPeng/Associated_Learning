total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.3_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.25016666666666665 (30020/120000), AUC 0.5835883617401123
ep0_train_time 7.766496896743774
Test Epoch0 threshold 0.3 Acc 0.9138157894736842, AUC 0.9806626439094543, avg_entr 0.026078902184963226
ep0_t0.3_test_time 0.18468046188354492
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.3_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2703833333333333 (32446/120000), AUC 0.5873935222625732
ep1_train_time 7.172919988632202
Test Epoch1 threshold 0.3 Acc 0.915625, AUC 0.9802725315093994, avg_entr 0.025271249935030937
ep1_t0.3_test_time 0.1724529266357422
gc 0
Train Epoch2 Acc 0.40234166666666665 (48281/120000), AUC 0.6153041124343872
ep2_train_time 7.239396810531616
Test Epoch2 threshold 0.3 Acc 0.9166118421052631, AUC 0.9801585078239441, avg_entr 0.026061436161398888
ep2_t0.3_test_time 0.17206263542175293
gc 0
Train Epoch3 Acc 0.4318666666666667 (51824/120000), AUC 0.6480283737182617
ep3_train_time 7.360760450363159
Test Epoch3 threshold 0.3 Acc 0.9123355263157895, AUC 0.9799776673316956, avg_entr 0.02464132569730282
ep3_t0.3_test_time 0.17268896102905273
gc 0
Train Epoch4 Acc 0.3360166666666667 (40322/120000), AUC 0.6774978041648865
ep4_train_time 7.243058204650879
Test Epoch4 threshold 0.3 Acc 0.9141447368421053, AUC 0.9799293279647827, avg_entr 0.02502433955669403
ep4_t0.3_test_time 0.17843985557556152
gc 0
Train Epoch5 Acc 0.404375 (48525/120000), AUC 0.694041907787323
ep5_train_time 7.2586870193481445
Test Epoch5 threshold 0.3 Acc 0.9139802631578947, AUC 0.9797061085700989, avg_entr 0.025573499500751495
ep5_t0.3_test_time 0.17038941383361816
gc 0
Train Epoch6 Acc 0.44338333333333335 (53206/120000), AUC 0.7011969089508057
ep6_train_time 7.2296106815338135
Test Epoch6 threshold 0.3 Acc 0.9115131578947369, AUC 0.979459285736084, avg_entr 0.025287499651312828
ep6_t0.3_test_time 0.1706399917602539
gc 0
Train Epoch7 Acc 0.45569166666666666 (54683/120000), AUC 0.7068295478820801
ep7_train_time 7.266329050064087
Test Epoch7 threshold 0.3 Acc 0.9126644736842106, AUC 0.9793930053710938, avg_entr 0.02560366317629814
ep7_t0.3_test_time 0.1730515956878662
gc 0
Train Epoch8 Acc 0.45668333333333333 (54802/120000), AUC 0.7109816670417786
ep8_train_time 7.294474124908447
Test Epoch8 threshold 0.3 Acc 0.9118421052631579, AUC 0.979313850402832, avg_entr 0.02601884864270687
ep8_t0.3_test_time 0.17021560668945312
gc 0
Train Epoch9 Acc 0.4524 (54288/120000), AUC 0.7126465439796448
ep9_train_time 7.259313583374023
Test Epoch9 threshold 0.3 Acc 0.9118421052631579, AUC 0.9791975021362305, avg_entr 0.025446636602282524
ep9_t0.3_test_time 0.17685246467590332
Best AUC 0.9806626439094543
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.3_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9223684210526316, AUC 0.9859414100646973, avg_entr 0.025446496903896332
t0.3_test_time 0.044988393783569336
