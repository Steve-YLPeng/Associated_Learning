total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.229125 (27495/120000), AUC 0.46426719427108765
ep0_train_time 4.424453973770142
Test Epoch0 threshold 0.3 Acc 0.9075657894736842, AUC 0.97934490442276, avg_entr 0.15123489499092102
ep0_t0.3_test_time 0.07357120513916016
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.22111666666666666 (26534/120000), AUC 0.4426949620246887
ep1_train_time 3.9281673431396484
Test Epoch1 threshold 0.3 Acc 0.9125, AUC 0.9806583523750305, avg_entr 0.09509167075157166
ep1_t0.3_test_time 0.0746774673461914
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.21849166666666667 (26219/120000), AUC 0.4416542649269104
ep2_train_time 4.060603141784668
Test Epoch2 threshold 0.3 Acc 0.9151315789473684, AUC 0.980278730392456, avg_entr 0.07599480450153351
ep2_t0.3_test_time 0.07219219207763672
gc 0
Train Epoch3 Acc 0.21653333333333333 (25984/120000), AUC 0.44127073884010315
ep3_train_time 3.833805561065674
Test Epoch3 threshold 0.3 Acc 0.912828947368421, AUC 0.9806474447250366, avg_entr 0.06560880690813065
ep3_t0.3_test_time 0.0719907283782959
gc 0
Train Epoch4 Acc 0.21444166666666667 (25733/120000), AUC 0.44071266055107117
ep4_train_time 3.8609137535095215
Test Epoch4 threshold 0.3 Acc 0.9125, AUC 0.9802900552749634, avg_entr 0.0592501126229763
ep4_t0.3_test_time 0.07143974304199219
gc 0
Train Epoch5 Acc 0.21245 (25494/120000), AUC 0.4398421049118042
ep5_train_time 3.869375228881836
Test Epoch5 threshold 0.3 Acc 0.9111842105263158, AUC 0.9802420139312744, avg_entr 0.05398545041680336
ep5_t0.3_test_time 0.07259774208068848
gc 0
Train Epoch6 Acc 0.21113333333333334 (25336/120000), AUC 0.4389159679412842
ep6_train_time 3.8265440464019775
Test Epoch6 threshold 0.3 Acc 0.9120065789473685, AUC 0.9799240827560425, avg_entr 0.051760900765657425
ep6_t0.3_test_time 0.07190799713134766
gc 0
Train Epoch7 Acc 0.21045 (25254/120000), AUC 0.43845808506011963
ep7_train_time 3.8628289699554443
Test Epoch7 threshold 0.3 Acc 0.912828947368421, AUC 0.9796277284622192, avg_entr 0.049316681921482086
ep7_t0.3_test_time 0.07258844375610352
gc 0
Train Epoch8 Acc 0.20971666666666666 (25166/120000), AUC 0.4384191334247589
ep8_train_time 3.851893663406372
Test Epoch8 threshold 0.3 Acc 0.9110197368421052, AUC 0.9794777631759644, avg_entr 0.046943023800849915
ep8_t0.3_test_time 0.07233715057373047
gc 0
Train Epoch9 Acc 0.20863333333333334 (25036/120000), AUC 0.4379885196685791
ep9_train_time 3.8641555309295654
Test Epoch9 threshold 0.3 Acc 0.9106907894736842, AUC 0.9795615673065186, avg_entr 0.04509320110082626
ep9_t0.3_test_time 0.07270193099975586
Best AUC 0.9806583523750305
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.3_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9210526315789473, AUC 0.9854506850242615, avg_entr 0.10041134804487228
t0.3_test_time 0.018821001052856445
