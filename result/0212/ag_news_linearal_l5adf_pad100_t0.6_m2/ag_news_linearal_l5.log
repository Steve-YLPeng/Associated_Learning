total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.6_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.24740833333333334 (29689/120000), AUC 0.36948442459106445
ep0_train_time 7.179339170455933
Test Epoch0 threshold 0.6 Acc 0.9166118421052631, AUC 0.9807589054107666, avg_entr 0.02974839136004448
ep0_t0.6_test_time 0.17125964164733887
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.23715833333333333 (28459/120000), AUC 0.29283156991004944
ep1_train_time 6.70162034034729
Test Epoch1 threshold 0.6 Acc 0.9171052631578948, AUC 0.980626106262207, avg_entr 0.02804495207965374
ep1_t0.6_test_time 0.17032289505004883
gc 0
Train Epoch2 Acc 0.23614166666666667 (28337/120000), AUC 0.2924702763557434
ep2_train_time 6.727025032043457
Test Epoch2 threshold 0.6 Acc 0.9151315789473684, AUC 0.9804763793945312, avg_entr 0.027909738942980766
ep2_t0.6_test_time 0.1721181869506836
gc 0
Train Epoch3 Acc 0.23684166666666667 (28421/120000), AUC 0.2914939224720001
ep3_train_time 6.727893114089966
Test Epoch3 threshold 0.6 Acc 0.9143092105263158, AUC 0.9799601435661316, avg_entr 0.027964824810624123
ep3_t0.6_test_time 0.1647624969482422
gc 0
Train Epoch4 Acc 0.23039166666666666 (27647/120000), AUC 0.28905409574508667
ep4_train_time 6.713579416275024
Test Epoch4 threshold 0.6 Acc 0.915296052631579, AUC 0.9803124666213989, avg_entr 0.02630033902823925
ep4_t0.6_test_time 0.16360855102539062
gc 0
Train Epoch5 Acc 0.22196666666666667 (26636/120000), AUC 0.28703081607818604
ep5_train_time 6.421569347381592
Test Epoch5 threshold 0.6 Acc 0.915296052631579, AUC 0.9800786972045898, avg_entr 0.026285402476787567
ep5_t0.6_test_time 0.16156339645385742
gc 0
Train Epoch6 Acc 0.21461666666666668 (25754/120000), AUC 0.28554219007492065
ep6_train_time 6.4636147022247314
Test Epoch6 threshold 0.6 Acc 0.9141447368421053, AUC 0.9799822568893433, avg_entr 0.02598363719880581
ep6_t0.6_test_time 0.1610255241394043
gc 0
Train Epoch7 Acc 0.20550833333333332 (24661/120000), AUC 0.2834237813949585
ep7_train_time 6.4335010051727295
Test Epoch7 threshold 0.6 Acc 0.9134868421052632, AUC 0.9798036813735962, avg_entr 0.025804100558161736
ep7_t0.6_test_time 0.1613004207611084
gc 0
Train Epoch8 Acc 0.19605 (23526/120000), AUC 0.281644344329834
ep8_train_time 6.341498136520386
Test Epoch8 threshold 0.6 Acc 0.912828947368421, AUC 0.9796656370162964, avg_entr 0.02593286707997322
ep8_t0.6_test_time 0.1608574390411377
gc 0
Train Epoch9 Acc 0.18821666666666667 (22586/120000), AUC 0.2802068591117859
ep9_train_time 6.3634257316589355
Test Epoch9 threshold 0.6 Acc 0.9131578947368421, AUC 0.9795870780944824, avg_entr 0.02654903754591942
ep9_t0.6_test_time 0.16025781631469727
Best AUC 0.9807589054107666
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.6_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9256578947368421, AUC 0.9862943887710571, avg_entr 0.029750743880867958
t0.6_test_time 0.04109001159667969
