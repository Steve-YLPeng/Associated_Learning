total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24998333333333334 (29998/120000), AUC 0.5081128478050232
ep0_train_time 5.637572765350342
Test Epoch0 threshold 0.7 Acc 0.9069078947368421, AUC 0.9764647483825684, avg_entr 0.16446302831172943
ep0_t0.7_test_time 0.13196873664855957
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24995 (29994/120000), AUC 0.5198626518249512
ep1_train_time 5.239221811294556
Test Epoch1 threshold 0.7 Acc 0.9154605263157894, AUC 0.979557991027832, avg_entr 0.1006559357047081
ep1_t0.7_test_time 0.13076066970825195
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24994166666666667 (29993/120000), AUC 0.5221501588821411
ep2_train_time 5.202783823013306
Test Epoch2 threshold 0.7 Acc 0.9162828947368421, AUC 0.9799366593360901, avg_entr 0.07812611758708954
ep2_t0.7_test_time 0.13094234466552734
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24994166666666667 (29993/120000), AUC 0.5227482318878174
ep3_train_time 5.76633095741272
Test Epoch3 threshold 0.7 Acc 0.9157894736842105, AUC 0.9806076288223267, avg_entr 0.06529258191585541
ep3_t0.7_test_time 0.14066410064697266
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.7_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24993333333333334 (29992/120000), AUC 0.5222737789154053
ep4_train_time 5.8143510818481445
Test Epoch4 threshold 0.7 Acc 0.9159539473684211, AUC 0.9803650379180908, avg_entr 0.05829884856939316
ep4_t0.7_test_time 0.14003825187683105
gc 0
Train Epoch5 Acc 0.24996666666666667 (29996/120000), AUC 0.5220822095870972
ep5_train_time 5.4180731773376465
Test Epoch5 threshold 0.7 Acc 0.9161184210526315, AUC 0.9802485704421997, avg_entr 0.05373949930071831
ep5_t0.7_test_time 0.1310596466064453
gc 0
Train Epoch6 Acc 0.24994166666666667 (29993/120000), AUC 0.5218021273612976
ep6_train_time 5.268714189529419
Test Epoch6 threshold 0.7 Acc 0.9154605263157894, AUC 0.9803561568260193, avg_entr 0.05009321868419647
ep6_t0.7_test_time 0.13094639778137207
gc 0
Train Epoch7 Acc 0.24996666666666667 (29996/120000), AUC 0.5209336280822754
ep7_train_time 5.240337371826172
Test Epoch7 threshold 0.7 Acc 0.9139802631578947, AUC 0.9798119068145752, avg_entr 0.04703790321946144
ep7_t0.7_test_time 0.13088130950927734
gc 0
Train Epoch8 Acc 0.24993333333333334 (29992/120000), AUC 0.5206208825111389
ep8_train_time 5.196032762527466
Test Epoch8 threshold 0.7 Acc 0.9138157894736842, AUC 0.9796994924545288, avg_entr 0.0446670837700367
ep8_t0.7_test_time 0.13076496124267578
gc 0
Train Epoch9 Acc 0.2499 (29988/120000), AUC 0.5206905603408813
ep9_train_time 5.352530479431152
Test Epoch9 threshold 0.7 Acc 0.9123355263157895, AUC 0.9794155955314636, avg_entr 0.04301511496305466
ep9_t0.7_test_time 0.1320343017578125
Best AUC 0.9806076288223267
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.7_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9230263157894737, AUC 0.9861984252929688, avg_entr 0.06788495928049088
t0.7_test_time 0.03377819061279297
