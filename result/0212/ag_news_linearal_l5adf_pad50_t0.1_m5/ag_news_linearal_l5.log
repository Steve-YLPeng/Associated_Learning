total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.1_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9136833333333333 (109642/120000), AUC 0.9847042560577393
ep0_train_time 7.2313313484191895
Test Epoch0 threshold 0.1 Acc 0.9131578947368421, AUC 0.9799272418022156, avg_entr 0.020578494295477867
ep0_t0.1_test_time 0.1342167854309082
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.1_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.94995 (113994/120000), AUC 0.9932909607887268
ep1_train_time 6.7975664138793945
Test Epoch1 threshold 0.1 Acc 0.9134868421052632, AUC 0.9796990752220154, avg_entr 0.016033444553613663
ep1_t0.1_test_time 0.13375210762023926
gc 0
Train Epoch2 Acc 0.9519166666666666 (114230/120000), AUC 0.9934637546539307
ep2_train_time 6.842078924179077
Test Epoch2 threshold 0.1 Acc 0.9120065789473685, AUC 0.9794436693191528, avg_entr 0.013723121024668217
ep2_t0.1_test_time 0.13228440284729004
gc 0
Train Epoch3 Acc 0.9534333333333334 (114412/120000), AUC 0.9935622811317444
ep3_train_time 6.793514728546143
Test Epoch3 threshold 0.1 Acc 0.9125, AUC 0.9791581630706787, avg_entr 0.012070020660758018
ep3_t0.1_test_time 0.1334056854248047
gc 0
Train Epoch4 Acc 0.9547166666666667 (114566/120000), AUC 0.9938198328018188
ep4_train_time 6.787714242935181
Test Epoch4 threshold 0.1 Acc 0.9108552631578948, AUC 0.9790226221084595, avg_entr 0.01308936532586813
ep4_t0.1_test_time 0.1331627368927002
gc 0
Train Epoch5 Acc 0.9571583333333333 (114859/120000), AUC 0.9946702718734741
ep5_train_time 6.7950599193573
Test Epoch5 threshold 0.1 Acc 0.9115131578947369, AUC 0.978737473487854, avg_entr 0.011203087866306305
ep5_t0.1_test_time 0.13291621208190918
gc 0
Train Epoch6 Acc 0.957525 (114903/120000), AUC 0.9948540925979614
ep6_train_time 6.83505654335022
Test Epoch6 threshold 0.1 Acc 0.9111842105263158, AUC 0.9783540964126587, avg_entr 0.011069598607718945
ep6_t0.1_test_time 0.13306212425231934
gc 0
Train Epoch7 Acc 0.958025 (114963/120000), AUC 0.9950229525566101
ep7_train_time 6.828655481338501
Test Epoch7 threshold 0.1 Acc 0.9098684210526315, AUC 0.9781936407089233, avg_entr 0.01110898982733488
ep7_t0.1_test_time 0.13198399543762207
gc 0
Train Epoch8 Acc 0.958675 (115041/120000), AUC 0.9951572418212891
ep8_train_time 6.869094371795654
Test Epoch8 threshold 0.1 Acc 0.9101973684210526, AUC 0.9781075716018677, avg_entr 0.010958582162857056
ep8_t0.1_test_time 0.13266205787658691
gc 0
Train Epoch9 Acc 0.9598666666666666 (115184/120000), AUC 0.9955332279205322
ep9_train_time 6.882852792739868
Test Epoch9 threshold 0.1 Acc 0.9092105263157895, AUC 0.9780339598655701, avg_entr 0.010954015888273716
ep9_t0.1_test_time 0.13109493255615234
Best AUC 0.9799272418022156
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.1_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9236842105263158, AUC 0.9857261180877686, avg_entr 0.01977355405688286
t0.1_test_time 0.03435206413269043
