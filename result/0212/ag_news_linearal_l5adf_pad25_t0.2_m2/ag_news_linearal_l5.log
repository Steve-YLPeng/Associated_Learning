total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.2_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.15796666666666667 (18956/120000), AUC 0.3380239009857178
ep0_train_time 4.844062328338623
Test Epoch0 threshold 0.2 Acc 0.9131578947368421, AUC 0.9806961417198181, avg_entr 0.03117009624838829
ep0_t0.2_test_time 0.08038759231567383
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.2_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.14358333333333334 (17230/120000), AUC 0.2803965210914612
ep1_train_time 4.34597635269165
Test Epoch1 threshold 0.2 Acc 0.9136513157894737, AUC 0.9804631471633911, avg_entr 0.028585132211446762
ep1_t0.2_test_time 0.07938075065612793
gc 0
Train Epoch2 Acc 0.14663333333333334 (17596/120000), AUC 0.2862616181373596
ep2_train_time 4.3694658279418945
Test Epoch2 threshold 0.2 Acc 0.9129934210526316, AUC 0.9802497029304504, avg_entr 0.027081375941634178
ep2_t0.2_test_time 0.07851147651672363
gc 0
Train Epoch3 Acc 0.1487 (17844/120000), AUC 0.29486900568008423
ep3_train_time 4.334256172180176
Test Epoch3 threshold 0.2 Acc 0.9131578947368421, AUC 0.9798792600631714, avg_entr 0.026448221877217293
ep3_t0.2_test_time 0.07931733131408691
gc 0
Train Epoch4 Acc 0.14890833333333334 (17869/120000), AUC 0.3008117079734802
ep4_train_time 4.3510425090789795
Test Epoch4 threshold 0.2 Acc 0.9118421052631579, AUC 0.9799773693084717, avg_entr 0.02586694434285164
ep4_t0.2_test_time 0.07875990867614746
gc 0
Train Epoch5 Acc 0.14876666666666666 (17852/120000), AUC 0.30465760827064514
ep5_train_time 4.3704633712768555
Test Epoch5 threshold 0.2 Acc 0.9111842105263158, AUC 0.9797414541244507, avg_entr 0.026167884469032288
ep5_t0.2_test_time 0.07828950881958008
gc 0
Train Epoch6 Acc 0.15075 (18090/120000), AUC 0.3078310787677765
ep6_train_time 4.365253925323486
Test Epoch6 threshold 0.2 Acc 0.9125, AUC 0.9794639348983765, avg_entr 0.02568245679140091
ep6_t0.2_test_time 0.07801985740661621
gc 0
Train Epoch7 Acc 0.15226666666666666 (18272/120000), AUC 0.3109486699104309
ep7_train_time 4.3416712284088135
Test Epoch7 threshold 0.2 Acc 0.9118421052631579, AUC 0.9792084693908691, avg_entr 0.026014594361186028
ep7_t0.2_test_time 0.0787057876586914
gc 0
Train Epoch8 Acc 0.15435833333333332 (18523/120000), AUC 0.31365516781806946
ep8_train_time 4.355496406555176
Test Epoch8 threshold 0.2 Acc 0.9101973684210526, AUC 0.979027509689331, avg_entr 0.025263503193855286
ep8_t0.2_test_time 0.07828187942504883
gc 0
Train Epoch9 Acc 0.15629166666666666 (18755/120000), AUC 0.3157270550727844
ep9_train_time 4.566040992736816
Test Epoch9 threshold 0.2 Acc 0.9103618421052632, AUC 0.9788194298744202, avg_entr 0.025135869160294533
ep9_t0.2_test_time 0.08056473731994629
Best AUC 0.9806961417198181
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.2_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9236842105263158, AUC 0.9855313301086426, avg_entr 0.03356883302330971
t0.2_test_time 0.0213010311126709
