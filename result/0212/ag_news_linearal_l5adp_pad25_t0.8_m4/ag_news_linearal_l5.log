total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.8_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.2600166666666667 (31202/120000), AUC 0.5861583948135376
ep0_train_time 5.943148612976074
Test Epoch0 threshold 0.8 Acc 0.9120065789473685, AUC 0.9805148839950562, avg_entr 0.02488483302295208
ep0_t0.8_test_time 0.07324576377868652
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.8_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.271175 (32541/120000), AUC 0.6283419728279114
ep1_train_time 5.395918130874634
Test Epoch1 threshold 0.8 Acc 0.9129934210526316, AUC 0.9801506400108337, avg_entr 0.02444535493850708
ep1_t0.8_test_time 0.07173752784729004
gc 0
Train Epoch2 Acc 0.337425 (40491/120000), AUC 0.7176420092582703
ep2_train_time 5.3852903842926025
Test Epoch2 threshold 0.8 Acc 0.9108552631578948, AUC 0.9797202944755554, avg_entr 0.02459745481610298
ep2_t0.8_test_time 0.07155370712280273
gc 0
Train Epoch3 Acc 0.48489166666666667 (58187/120000), AUC 0.7380616664886475
ep3_train_time 5.407045364379883
Test Epoch3 threshold 0.8 Acc 0.9115131578947369, AUC 0.9796723127365112, avg_entr 0.025072500109672546
ep3_t0.8_test_time 0.07178187370300293
gc 0
Train Epoch4 Acc 0.4686416666666667 (56237/120000), AUC 0.7598124146461487
ep4_train_time 5.608538627624512
Test Epoch4 threshold 0.8 Acc 0.9108552631578948, AUC 0.9794631600379944, avg_entr 0.024793460965156555
ep4_t0.8_test_time 0.0745704174041748
gc 0
Train Epoch5 Acc 0.4429416666666667 (53153/120000), AUC 0.7860862612724304
ep5_train_time 5.789071798324585
Test Epoch5 threshold 0.8 Acc 0.9103618421052632, AUC 0.979201078414917, avg_entr 0.02503986656665802
ep5_t0.8_test_time 0.07378554344177246
gc 0
Train Epoch6 Acc 0.457825 (54939/120000), AUC 0.8186112642288208
ep6_train_time 5.723211765289307
Test Epoch6 threshold 0.8 Acc 0.9101973684210526, AUC 0.9791584014892578, avg_entr 0.02564552240073681
ep6_t0.8_test_time 0.07154154777526855
gc 0
Train Epoch7 Acc 0.486025 (58323/120000), AUC 0.8492987155914307
ep7_train_time 5.37226676940918
Test Epoch7 threshold 0.8 Acc 0.9103618421052632, AUC 0.978724479675293, avg_entr 0.025314446538686752
ep7_t0.8_test_time 0.07149672508239746
gc 0
Train Epoch8 Acc 0.50025 (60030/120000), AUC 0.868168294429779
ep8_train_time 5.4779953956604
Test Epoch8 threshold 0.8 Acc 0.9106907894736842, AUC 0.9787180423736572, avg_entr 0.025157319381833076
ep8_t0.8_test_time 0.07217836380004883
gc 0
Train Epoch9 Acc 0.5105583333333333 (61267/120000), AUC 0.8768279552459717
ep9_train_time 5.434748411178589
Test Epoch9 threshold 0.8 Acc 0.9097039473684211, AUC 0.978584349155426, avg_entr 0.025645677000284195
ep9_t0.8_test_time 0.07152533531188965
Best AUC 0.9805148839950562
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.8_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9203947368421053, AUC 0.9852356910705566, avg_entr 0.027426112443208694
t0.8_test_time 0.01881718635559082
