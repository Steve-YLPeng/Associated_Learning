total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.5_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9130333333333334 (109564/120000), AUC 0.9838889837265015
ep0_train_time 8.51837706565857
Test Epoch0 threshold 0.5 Acc 0.9138157894736842, AUC 0.9803364872932434, avg_entr 0.025879448279738426
ep0_t0.5_test_time 0.1640172004699707
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.5_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9496 (113952/120000), AUC 0.9929428696632385
ep1_train_time 8.025404691696167
Test Epoch1 threshold 0.5 Acc 0.9157894736842105, AUC 0.9801205396652222, avg_entr 0.0262322798371315
ep1_t0.5_test_time 0.16194748878479004
gc 0
Train Epoch2 Acc 0.950925 (114111/120000), AUC 0.9930670261383057
ep2_train_time 7.9302897453308105
Test Epoch2 threshold 0.5 Acc 0.9134868421052632, AUC 0.980063259601593, avg_entr 0.026319684460759163
ep2_t0.5_test_time 0.16328191757202148
gc 0
Train Epoch3 Acc 0.952225 (114267/120000), AUC 0.9933447241783142
ep3_train_time 7.893233299255371
Test Epoch3 threshold 0.5 Acc 0.9110197368421052, AUC 0.9799591302871704, avg_entr 0.02543993666768074
ep3_t0.5_test_time 0.1621694564819336
gc 0
Train Epoch4 Acc 0.9529333333333333 (114352/120000), AUC 0.9938085079193115
ep4_train_time 7.970973014831543
Test Epoch4 threshold 0.5 Acc 0.9131578947368421, AUC 0.9795653223991394, avg_entr 0.026744721457362175
ep4_t0.5_test_time 0.1619739532470703
gc 0
Train Epoch5 Acc 0.9552083333333333 (114625/120000), AUC 0.9945582747459412
ep5_train_time 8.349065065383911
Test Epoch5 threshold 0.5 Acc 0.9115131578947369, AUC 0.9794924259185791, avg_entr 0.025324106216430664
ep5_t0.5_test_time 0.17528247833251953
gc 0
Train Epoch6 Acc 0.956075 (114729/120000), AUC 0.9946885108947754
ep6_train_time 9.254206657409668
Test Epoch6 threshold 0.5 Acc 0.9121710526315789, AUC 0.9793778657913208, avg_entr 0.026704614982008934
ep6_t0.5_test_time 0.1727006435394287
gc 0
Train Epoch7 Acc 0.9565583333333333 (114787/120000), AUC 0.9947865009307861
ep7_train_time 8.120188474655151
Test Epoch7 threshold 0.5 Acc 0.9113486842105263, AUC 0.9792461395263672, avg_entr 0.027048341929912567
ep7_t0.5_test_time 0.16221094131469727
gc 0
Train Epoch8 Acc 0.957125 (114855/120000), AUC 0.994881272315979
ep8_train_time 7.903240203857422
Test Epoch8 threshold 0.5 Acc 0.9116776315789473, AUC 0.9791489839553833, avg_entr 0.026037178933620453
ep8_t0.5_test_time 0.1615591049194336
gc 0
Train Epoch9 Acc 0.9579416666666667 (114953/120000), AUC 0.9952542781829834
ep9_train_time 7.948922395706177
Test Epoch9 threshold 0.5 Acc 0.9100328947368421, AUC 0.9790717959403992, avg_entr 0.025964442640542984
ep9_t0.5_test_time 0.16163945198059082
Best AUC 0.9803364872932434
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.5_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9243421052631579, AUC 0.9857971668243408, avg_entr 0.025861037895083427
t0.5_test_time 0.041135311126708984
