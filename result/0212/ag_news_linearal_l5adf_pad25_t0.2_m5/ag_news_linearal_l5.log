total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.2_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.93385 (112062/120000), AUC 0.9858471155166626
ep0_train_time 6.521029710769653
Test Epoch0 threshold 0.2 Acc 0.9113486842105263, AUC 0.9800797700881958, avg_entr 0.0198901928961277
ep0_t0.2_test_time 0.10457134246826172
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.2_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9498166666666666 (113978/120000), AUC 0.9932330846786499
ep1_train_time 6.34870982170105
Test Epoch1 threshold 0.2 Acc 0.9100328947368421, AUC 0.9795666933059692, avg_entr 0.01848532073199749
ep1_t0.2_test_time 0.10218620300292969
gc 0
Train Epoch2 Acc 0.9513916666666666 (114167/120000), AUC 0.993353009223938
ep2_train_time 5.9159300327301025
Test Epoch2 threshold 0.2 Acc 0.9103618421052632, AUC 0.9792858958244324, avg_entr 0.01771107316017151
ep2_t0.2_test_time 0.10058450698852539
gc 0
Train Epoch3 Acc 0.952975 (114357/120000), AUC 0.9936069250106812
ep3_train_time 5.90378475189209
Test Epoch3 threshold 0.2 Acc 0.9100328947368421, AUC 0.9792221188545227, avg_entr 0.01717732660472393
ep3_t0.2_test_time 0.09819340705871582
gc 0
Train Epoch4 Acc 0.953725 (114447/120000), AUC 0.993935763835907
ep4_train_time 5.834733247756958
Test Epoch4 threshold 0.2 Acc 0.9111842105263158, AUC 0.9792987704277039, avg_entr 0.017514856532216072
ep4_t0.2_test_time 0.09916329383850098
gc 0
Train Epoch5 Acc 0.956175 (114741/120000), AUC 0.9946938753128052
ep5_train_time 5.923921585083008
Test Epoch5 threshold 0.2 Acc 0.9101973684210526, AUC 0.9790445566177368, avg_entr 0.017079275101423264
ep5_t0.2_test_time 0.0995025634765625
gc 0
Train Epoch6 Acc 0.957325 (114879/120000), AUC 0.9949182868003845
ep6_train_time 5.862626791000366
Test Epoch6 threshold 0.2 Acc 0.9090460526315789, AUC 0.9785006642341614, avg_entr 0.016578394919633865
ep6_t0.2_test_time 0.0988302230834961
gc 0
Train Epoch7 Acc 0.95725 (114870/120000), AUC 0.9950578212738037
ep7_train_time 5.868844032287598
Test Epoch7 threshold 0.2 Acc 0.9097039473684211, AUC 0.9783717393875122, avg_entr 0.016447577625513077
ep7_t0.2_test_time 0.0980997085571289
gc 0
Train Epoch8 Acc 0.9578666666666666 (114944/120000), AUC 0.9950727820396423
ep8_train_time 5.839999198913574
Test Epoch8 threshold 0.2 Acc 0.9080592105263158, AUC 0.9782568216323853, avg_entr 0.016907108947634697
ep8_t0.2_test_time 0.09940385818481445
gc 0
Train Epoch9 Acc 0.959 (115080/120000), AUC 0.9956008195877075
ep9_train_time 5.914174556732178
Test Epoch9 threshold 0.2 Acc 0.9082236842105263, AUC 0.978122353553772, avg_entr 0.016492201015353203
ep9_t0.2_test_time 0.09855055809020996
Best AUC 0.9800797700881958
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.2_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9210526315789473, AUC 0.9849172830581665, avg_entr 0.022262711077928543
t0.2_test_time 0.0261385440826416
