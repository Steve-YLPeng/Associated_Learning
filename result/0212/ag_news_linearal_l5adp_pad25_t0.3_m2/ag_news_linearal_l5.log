total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.3_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.33343333333333336 (40012/120000), AUC 0.682731032371521
ep0_train_time 4.80333137512207
Test Epoch0 threshold 0.3 Acc 0.9126644736842106, AUC 0.98052978515625, avg_entr 0.03601255267858505
ep0_t0.3_test_time 0.0804448127746582
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.3_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.32466666666666666 (38960/120000), AUC 0.7224159240722656
ep1_train_time 4.375748634338379
Test Epoch1 threshold 0.3 Acc 0.9144736842105263, AUC 0.9808108806610107, avg_entr 0.03124074637889862
ep1_t0.3_test_time 0.07918715476989746
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.3_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.29939166666666667 (35927/120000), AUC 0.7038873434066772
ep2_train_time 4.36601996421814
Test Epoch2 threshold 0.3 Acc 0.912828947368421, AUC 0.9806693196296692, avg_entr 0.030533168464899063
ep2_t0.3_test_time 0.07860922813415527
gc 0
Train Epoch3 Acc 0.29089166666666666 (34907/120000), AUC 0.6849969029426575
ep3_train_time 4.380818843841553
Test Epoch3 threshold 0.3 Acc 0.9136513157894737, AUC 0.9801914095878601, avg_entr 0.028206385672092438
ep3_t0.3_test_time 0.07810401916503906
gc 0
Train Epoch4 Acc 0.2871666666666667 (34460/120000), AUC 0.667332649230957
ep4_train_time 4.377772808074951
Test Epoch4 threshold 0.3 Acc 0.9133223684210526, AUC 0.9803861975669861, avg_entr 0.027548372745513916
ep4_t0.3_test_time 0.07752251625061035
gc 0
Train Epoch5 Acc 0.28725833333333334 (34471/120000), AUC 0.6511697769165039
ep5_train_time 4.367776155471802
Test Epoch5 threshold 0.3 Acc 0.912828947368421, AUC 0.9796082973480225, avg_entr 0.0274669099599123
ep5_t0.3_test_time 0.07861685752868652
gc 0
Train Epoch6 Acc 0.2868 (34416/120000), AUC 0.6404045820236206
ep6_train_time 4.377362966537476
Test Epoch6 threshold 0.3 Acc 0.9113486842105263, AUC 0.9794966578483582, avg_entr 0.026658929884433746
ep6_t0.3_test_time 0.0778510570526123
gc 0
Train Epoch7 Acc 0.2861 (34332/120000), AUC 0.6334318518638611
ep7_train_time 4.371352434158325
Test Epoch7 threshold 0.3 Acc 0.9118421052631579, AUC 0.979404091835022, avg_entr 0.026762567460536957
ep7_t0.3_test_time 0.0780792236328125
gc 0
Train Epoch8 Acc 0.28476666666666667 (34172/120000), AUC 0.6268911361694336
ep8_train_time 4.372155666351318
Test Epoch8 threshold 0.3 Acc 0.9101973684210526, AUC 0.9792385101318359, avg_entr 0.02643006481230259
ep8_t0.3_test_time 0.07808685302734375
gc 0
Train Epoch9 Acc 0.2844333333333333 (34132/120000), AUC 0.621103048324585
ep9_train_time 4.336225509643555
Test Epoch9 threshold 0.3 Acc 0.9098684210526315, AUC 0.9788696765899658, avg_entr 0.02663177251815796
ep9_t0.3_test_time 0.07825040817260742
Best AUC 0.9808108806610107
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.3_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9203947368421053, AUC 0.985951840877533, avg_entr 0.03322143480181694
t0.3_test_time 0.020146608352661133
