total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.8_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.90355 (108426/120000), AUC 0.9828307032585144
ep0_train_time 7.953894853591919
Test Epoch0 threshold 0.8 Acc 0.9133223684210526, AUC 0.9802899360656738, avg_entr 0.02656548097729683
ep0_t0.8_test_time 0.1344289779663086
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.8_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9493 (113916/120000), AUC 0.9930093884468079
ep1_train_time 7.4794604778289795
Test Epoch1 threshold 0.8 Acc 0.9144736842105263, AUC 0.9802901744842529, avg_entr 0.025965800508856773
ep1_t0.8_test_time 0.1318492889404297
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.8_m5//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9510166666666666 (114122/120000), AUC 0.9931681752204895
ep2_train_time 7.433507442474365
Test Epoch2 threshold 0.8 Acc 0.9149671052631579, AUC 0.9797874689102173, avg_entr 0.02635631524026394
ep2_t0.8_test_time 0.13124990463256836
gc 0
Train Epoch3 Acc 0.9524333333333334 (114292/120000), AUC 0.993372917175293
ep3_train_time 7.569253444671631
Test Epoch3 threshold 0.8 Acc 0.9123355263157895, AUC 0.9796302318572998, avg_entr 0.026085160672664642
ep3_t0.8_test_time 0.13147354125976562
gc 0
Train Epoch4 Acc 0.953425 (114411/120000), AUC 0.9938095808029175
ep4_train_time 7.499760866165161
Test Epoch4 threshold 0.8 Acc 0.9120065789473685, AUC 0.9795575141906738, avg_entr 0.02551770955324173
ep4_t0.8_test_time 0.13180303573608398
gc 0
Train Epoch5 Acc 0.9558916666666667 (114707/120000), AUC 0.9947154521942139
ep5_train_time 7.412700176239014
Test Epoch5 threshold 0.8 Acc 0.9120065789473685, AUC 0.9794080257415771, avg_entr 0.025807563215494156
ep5_t0.8_test_time 0.13196182250976562
gc 0
Train Epoch6 Acc 0.956375 (114765/120000), AUC 0.9948119521141052
ep6_train_time 7.427427768707275
Test Epoch6 threshold 0.8 Acc 0.9105263157894737, AUC 0.9791514873504639, avg_entr 0.026293639093637466
ep6_t0.8_test_time 0.1321239471435547
gc 0
Train Epoch7 Acc 0.9569333333333333 (114832/120000), AUC 0.9949989914894104
ep7_train_time 7.481422424316406
Test Epoch7 threshold 0.8 Acc 0.9105263157894737, AUC 0.9791326522827148, avg_entr 0.026383429765701294
ep7_t0.8_test_time 0.13184618949890137
gc 0
Train Epoch8 Acc 0.9570083333333333 (114841/120000), AUC 0.9950960874557495
ep8_train_time 7.5177953243255615
Test Epoch8 threshold 0.8 Acc 0.9103618421052632, AUC 0.9790647625923157, avg_entr 0.02603425458073616
ep8_t0.8_test_time 0.13263511657714844
gc 0
Train Epoch9 Acc 0.95875 (115050/120000), AUC 0.995475172996521
ep9_train_time 7.517906188964844
Test Epoch9 threshold 0.8 Acc 0.9101973684210526, AUC 0.9789388179779053, avg_entr 0.025487156584858894
ep9_t0.8_test_time 0.1317424774169922
Best AUC 0.9802901744842529
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.8_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9230263157894737, AUC 0.985533595085144, avg_entr 0.025444721803069115
t0.8_test_time 0.03403782844543457
