total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.4968877136707306
ep0_train_time 8.48406171798706
Test Epoch0 threshold 0.4 Acc 0.9018092105263158, AUC 0.9743328094482422, avg_entr 0.17899790406227112
ep0_t0.4_test_time 0.25449299812316895
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.49020126461982727
ep1_train_time 8.0277578830719
Test Epoch1 threshold 0.4 Acc 0.9131578947368421, AUC 0.9779725670814514, avg_entr 0.10469736158847809
ep1_t0.4_test_time 0.2523488998413086
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.4926895797252655
ep2_train_time 8.065999984741211
Test Epoch2 threshold 0.4 Acc 0.9151315789473684, AUC 0.9797391891479492, avg_entr 0.0799127146601677
ep2_t0.4_test_time 0.2533755302429199
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.49529576301574707
ep3_train_time 8.065929889678955
Test Epoch3 threshold 0.4 Acc 0.9141447368421053, AUC 0.9802365303039551, avg_entr 0.06720780581235886
ep3_t0.4_test_time 0.25311970710754395
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.4986996054649353
ep4_train_time 8.209248304367065
Test Epoch4 threshold 0.4 Acc 0.9169407894736842, AUC 0.980654776096344, avg_entr 0.05780283734202385
ep4_t0.4_test_time 0.25275754928588867
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.5004899501800537
ep5_train_time 8.163229942321777
Test Epoch5 threshold 0.4 Acc 0.9157894736842105, AUC 0.9807094931602478, avg_entr 0.052884574979543686
ep5_t0.4_test_time 0.2527601718902588
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.5026533603668213
ep6_train_time 8.13210153579712
Test Epoch6 threshold 0.4 Acc 0.9172697368421052, AUC 0.9808059930801392, avg_entr 0.04932974651455879
ep6_t0.4_test_time 0.2610037326812744
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.5043776035308838
ep7_train_time 8.187976360321045
Test Epoch7 threshold 0.4 Acc 0.9171052631578948, AUC 0.9807289838790894, avg_entr 0.04540376737713814
ep7_t0.4_test_time 0.2525458335876465
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.5063800811767578
ep8_train_time 8.044930696487427
Test Epoch8 threshold 0.4 Acc 0.9172697368421052, AUC 0.9807423949241638, avg_entr 0.042550329118967056
ep8_t0.4_test_time 0.253176212310791
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.5081695318222046
ep9_train_time 8.074745893478394
Test Epoch9 threshold 0.4 Acc 0.9139802631578947, AUC 0.9807040691375732, avg_entr 0.04054519906640053
ep9_t0.4_test_time 0.25286245346069336
Best AUC 0.9808059930801392
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9217105263157894, AUC 0.9867185950279236, avg_entr 0.05153007060289383
t0.4_test_time 0.06359720230102539
