total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.6_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.924975 (110997/120000), AUC 0.9860420227050781
ep0_train_time 8.732171058654785
Test Epoch0 threshold 0.6 Acc 0.9164473684210527, AUC 0.9803928136825562, avg_entr 0.02492457628250122
ep0_t0.6_test_time 0.1626744270324707
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.6_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9497416666666667 (113969/120000), AUC 0.9930106401443481
ep1_train_time 7.924808502197266
Test Epoch1 threshold 0.6 Acc 0.9146381578947368, AUC 0.9801595211029053, avg_entr 0.02598300762474537
ep1_t0.6_test_time 0.16049981117248535
gc 0
Train Epoch2 Acc 0.95075 (114090/120000), AUC 0.993361234664917
ep2_train_time 8.013391256332397
Test Epoch2 threshold 0.6 Acc 0.9143092105263158, AUC 0.9800373911857605, avg_entr 0.02564297989010811
ep2_t0.6_test_time 0.1613156795501709
gc 0
Train Epoch3 Acc 0.9521166666666666 (114254/120000), AUC 0.9934767484664917
ep3_train_time 8.00360655784607
Test Epoch3 threshold 0.6 Acc 0.9108552631578948, AUC 0.9798859357833862, avg_entr 0.02654196508228779
ep3_t0.6_test_time 0.16150832176208496
gc 0
Train Epoch4 Acc 0.9529916666666667 (114359/120000), AUC 0.9939897060394287
ep4_train_time 8.032167434692383
Test Epoch4 threshold 0.6 Acc 0.9143092105263158, AUC 0.979693591594696, avg_entr 0.025550726801156998
ep4_t0.6_test_time 0.16052508354187012
gc 0
Train Epoch5 Acc 0.9552583333333333 (114631/120000), AUC 0.9945931434631348
ep5_train_time 8.22523021697998
Test Epoch5 threshold 0.6 Acc 0.9126644736842106, AUC 0.9795238971710205, avg_entr 0.02638641931116581
ep5_t0.6_test_time 0.16754460334777832
gc 0
Train Epoch6 Acc 0.9560166666666666 (114722/120000), AUC 0.9947437644004822
ep6_train_time 9.368966102600098
Test Epoch6 threshold 0.6 Acc 0.9126644736842106, AUC 0.9794245362281799, avg_entr 0.0259713064879179
ep6_t0.6_test_time 0.168623685836792
gc 0
Train Epoch7 Acc 0.9563583333333333 (114763/120000), AUC 0.9948675632476807
ep7_train_time 8.444223880767822
Test Epoch7 threshold 0.6 Acc 0.9121710526315789, AUC 0.9792845845222473, avg_entr 0.025716884061694145
ep7_t0.6_test_time 0.1606884002685547
gc 0
Train Epoch8 Acc 0.9569666666666666 (114836/120000), AUC 0.9949911236763
ep8_train_time 8.140832662582397
Test Epoch8 threshold 0.6 Acc 0.9118421052631579, AUC 0.9791889190673828, avg_entr 0.025540633127093315
ep8_t0.6_test_time 0.16146087646484375
gc 0
Train Epoch9 Acc 0.95795 (114954/120000), AUC 0.9953297972679138
ep9_train_time 7.920737981796265
Test Epoch9 threshold 0.6 Acc 0.9113486842105263, AUC 0.9790914058685303, avg_entr 0.02657570317387581
ep9_t0.6_test_time 0.16044116020202637
Best AUC 0.9803928136825562
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.6_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.925, AUC 0.9860589504241943, avg_entr 0.02483833208680153
t0.6_test_time 0.04136776924133301
