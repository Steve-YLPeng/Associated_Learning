total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.4_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.2509166666666667 (30110/120000), AUC 0.6094199419021606
ep0_train_time 6.785492181777954
Test Epoch0 threshold 0.4 Acc 0.9179276315789474, AUC 0.9808006882667542, avg_entr 0.02933107689023018
ep0_t0.4_test_time 0.16589665412902832
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.4_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24981666666666666 (29978/120000), AUC 0.6053988933563232
ep1_train_time 6.370583772659302
Test Epoch1 threshold 0.4 Acc 0.9120065789473685, AUC 0.9804253578186035, avg_entr 0.028286462649703026
ep1_t0.4_test_time 0.16508841514587402
gc 0
Train Epoch2 Acc 0.24976666666666666 (29972/120000), AUC 0.6003857254981995
ep2_train_time 6.4109063148498535
Test Epoch2 threshold 0.4 Acc 0.9141447368421053, AUC 0.9805601239204407, avg_entr 0.0273984856903553
ep2_t0.4_test_time 0.16443300247192383
gc 0
Train Epoch3 Acc 0.24958333333333332 (29950/120000), AUC 0.5979849100112915
ep3_train_time 6.376866340637207
Test Epoch3 threshold 0.4 Acc 0.9138157894736842, AUC 0.980294942855835, avg_entr 0.026410942897200584
ep3_t0.4_test_time 0.16278314590454102
gc 0
Train Epoch4 Acc 0.24970833333333334 (29965/120000), AUC 0.5946938991546631
ep4_train_time 6.358587741851807
Test Epoch4 threshold 0.4 Acc 0.9148026315789474, AUC 0.9801734089851379, avg_entr 0.02619737759232521
ep4_t0.4_test_time 0.16245460510253906
gc 0
Train Epoch5 Acc 0.24978333333333333 (29974/120000), AUC 0.5910719037055969
ep5_train_time 6.3039209842681885
Test Epoch5 threshold 0.4 Acc 0.9144736842105263, AUC 0.9799038171768188, avg_entr 0.02633333019912243
ep5_t0.4_test_time 0.16257190704345703
gc 0
Train Epoch6 Acc 0.24979166666666666 (29975/120000), AUC 0.5875528454780579
ep6_train_time 6.991347551345825
Test Epoch6 threshold 0.4 Acc 0.9125, AUC 0.9798061847686768, avg_entr 0.026408977806568146
ep6_t0.4_test_time 0.17704224586486816
gc 0
Train Epoch7 Acc 0.24985 (29982/120000), AUC 0.5837445259094238
ep7_train_time 7.464534521102905
Test Epoch7 threshold 0.4 Acc 0.9118421052631579, AUC 0.9797154068946838, avg_entr 0.026504572480916977
ep7_t0.4_test_time 0.1755223274230957
gc 0
Train Epoch8 Acc 0.24990833333333334 (29989/120000), AUC 0.5809088349342346
ep8_train_time 6.414279937744141
Test Epoch8 threshold 0.4 Acc 0.9120065789473685, AUC 0.979564905166626, avg_entr 0.026093879714608192
ep8_t0.4_test_time 0.16295480728149414
gc 0
Train Epoch9 Acc 0.249925 (29991/120000), AUC 0.5786030292510986
ep9_train_time 6.409180402755737
Test Epoch9 threshold 0.4 Acc 0.9121710526315789, AUC 0.9794602394104004, avg_entr 0.025975340977311134
ep9_t0.4_test_time 0.16279172897338867
Best AUC 0.9808006882667542
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.4_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9223684210526316, AUC 0.9861060380935669, avg_entr 0.030063990503549576
t0.4_test_time 0.04249882698059082
