total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.9_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9140166666666667 (109682/120000), AUC 0.9860770106315613
ep0_train_time 7.036174297332764
Test Epoch0 threshold 0.9 Acc 0.9108552631578948, AUC 0.9797632098197937, avg_entr 0.02564559504389763
ep0_t0.9_test_time 0.10157656669616699
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.9_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9516 (114192/120000), AUC 0.993708074092865
ep1_train_time 6.5487048625946045
Test Epoch1 threshold 0.9 Acc 0.912828947368421, AUC 0.9795375466346741, avg_entr 0.025291429832577705
ep1_t0.9_test_time 0.09965276718139648
gc 0
Train Epoch2 Acc 0.9531833333333334 (114382/120000), AUC 0.9937785863876343
ep2_train_time 6.625100135803223
Test Epoch2 threshold 0.9 Acc 0.9125, AUC 0.9793952703475952, avg_entr 0.025865545496344566
ep2_t0.9_test_time 0.10058164596557617
gc 0
Train Epoch3 Acc 0.9538416666666667 (114461/120000), AUC 0.9939217567443848
ep3_train_time 6.494259357452393
Test Epoch3 threshold 0.9 Acc 0.9100328947368421, AUC 0.9792153835296631, avg_entr 0.02622140385210514
ep3_t0.9_test_time 0.1001427173614502
gc 0
Train Epoch4 Acc 0.9546833333333333 (114562/120000), AUC 0.9942516088485718
ep4_train_time 6.557955026626587
Test Epoch4 threshold 0.9 Acc 0.9101973684210526, AUC 0.9790853261947632, avg_entr 0.026198357343673706
ep4_t0.9_test_time 0.09978961944580078
gc 0
Train Epoch5 Acc 0.9572083333333333 (114865/120000), AUC 0.9950159192085266
ep5_train_time 6.486301422119141
Test Epoch5 threshold 0.9 Acc 0.9092105263157895, AUC 0.9788771271705627, avg_entr 0.026757333427667618
ep5_t0.9_test_time 0.10010123252868652
gc 0
Train Epoch6 Acc 0.95805 (114966/120000), AUC 0.9951430559158325
ep6_train_time 6.54910683631897
Test Epoch6 threshold 0.9 Acc 0.909375, AUC 0.9787998795509338, avg_entr 0.026459382846951485
ep6_t0.9_test_time 0.1003868579864502
gc 0
Train Epoch7 Acc 0.9583333333333334 (115000/120000), AUC 0.9951357841491699
ep7_train_time 6.788171291351318
Test Epoch7 threshold 0.9 Acc 0.9087171052631579, AUC 0.9786567687988281, avg_entr 0.026385705918073654
ep7_t0.9_test_time 0.10442924499511719
gc 0
Train Epoch8 Acc 0.9586916666666667 (115043/120000), AUC 0.9953082799911499
ep8_train_time 7.0812389850616455
Test Epoch8 threshold 0.9 Acc 0.9077302631578947, AUC 0.9783574938774109, avg_entr 0.026367411017417908
ep8_t0.9_test_time 0.10418009757995605
gc 0
Train Epoch9 Acc 0.9600333333333333 (115204/120000), AUC 0.9957085251808167
ep9_train_time 6.970421314239502
Test Epoch9 threshold 0.9 Acc 0.9074013157894737, AUC 0.9783968329429626, avg_entr 0.025980111211538315
ep9_t0.9_test_time 0.10377717018127441
Best AUC 0.9797632098197937
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.9_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9236842105263158, AUC 0.9856396913528442, avg_entr 0.02475562132894993
t0.9_test_time 0.026538610458374023
