total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.3_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.423825 (50859/120000), AUC 0.5397984981536865
ep0_train_time 9.415914058685303
Test Epoch0 threshold 0.3 Acc 0.9166118421052631, AUC 0.9807573556900024, avg_entr 0.025172103196382523
ep0_t0.3_test_time 0.2660861015319824
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.37816666666666665 (45380/120000), AUC 0.5001192092895508
ep1_train_time 9.03617548942566
Test Epoch1 threshold 0.3 Acc 0.9146381578947368, AUC 0.980804443359375, avg_entr 0.025138061493635178
ep1_t0.3_test_time 0.263761043548584
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.3253 (39036/120000), AUC 0.475597083568573
ep2_train_time 8.888490200042725
Test Epoch2 threshold 0.3 Acc 0.9149671052631579, AUC 0.9804390668869019, avg_entr 0.024973556399345398
ep2_t0.3_test_time 0.2629585266113281
gc 0
Train Epoch3 Acc 0.3131083333333333 (37573/120000), AUC 0.4999478757381439
ep3_train_time 8.969779014587402
Test Epoch3 threshold 0.3 Acc 0.9148026315789474, AUC 0.9803397059440613, avg_entr 0.025810973718762398
ep3_t0.3_test_time 0.26210904121398926
gc 0
Train Epoch4 Acc 0.3161083333333333 (37933/120000), AUC 0.5285043716430664
ep4_train_time 8.952223062515259
Test Epoch4 threshold 0.3 Acc 0.9146381578947368, AUC 0.9802790880203247, avg_entr 0.02526763640344143
ep4_t0.3_test_time 0.26351141929626465
gc 0
Train Epoch5 Acc 0.30239166666666667 (36287/120000), AUC 0.5280566215515137
ep5_train_time 9.08296251296997
Test Epoch5 threshold 0.3 Acc 0.9141447368421053, AUC 0.980090320110321, avg_entr 0.025421958416700363
ep5_t0.3_test_time 0.2612020969390869
gc 0
Train Epoch6 Acc 0.28070833333333334 (33685/120000), AUC 0.5167272090911865
ep6_train_time 9.066059827804565
Test Epoch6 threshold 0.3 Acc 0.9139802631578947, AUC 0.9800158739089966, avg_entr 0.02521379292011261
ep6_t0.3_test_time 0.2626814842224121
gc 0
Train Epoch7 Acc 0.26295 (31554/120000), AUC 0.5058460831642151
ep7_train_time 9.053378343582153
Test Epoch7 threshold 0.3 Acc 0.9115131578947369, AUC 0.979906439781189, avg_entr 0.02420879155397415
ep7_t0.3_test_time 0.2728457450866699
gc 0
Train Epoch8 Acc 0.25195833333333334 (30235/120000), AUC 0.4987947344779968
ep8_train_time 9.053990840911865
Test Epoch8 threshold 0.3 Acc 0.9131578947368421, AUC 0.9798164367675781, avg_entr 0.024889735504984856
ep8_t0.3_test_time 0.2607576847076416
gc 0
Train Epoch9 Acc 0.24605 (29526/120000), AUC 0.4968242347240448
ep9_train_time 9.056490421295166
Test Epoch9 threshold 0.3 Acc 0.9138157894736842, AUC 0.9797732830047607, avg_entr 0.025854958221316338
ep9_t0.3_test_time 0.2605123519897461
Best AUC 0.980804443359375
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.3_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9210526315789473, AUC 0.9863475561141968, avg_entr 0.02366030402481556
t0.3_test_time 0.06730222702026367
