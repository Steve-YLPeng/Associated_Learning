total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.3_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.914225 (109707/120000), AUC 0.9845148921012878
ep0_train_time 7.042264223098755
Test Epoch0 threshold 0.3 Acc 0.9151315789473684, AUC 0.9798489809036255, avg_entr 0.024622969329357147
ep0_t0.3_test_time 0.12132644653320312
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.3_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.95105 (114126/120000), AUC 0.9934381246566772
ep1_train_time 6.573808193206787
Test Epoch1 threshold 0.3 Acc 0.9131578947368421, AUC 0.9797247648239136, avg_entr 0.023984480649232864
ep1_t0.3_test_time 0.12491583824157715
gc 0
Train Epoch2 Acc 0.9525666666666667 (114308/120000), AUC 0.9937132596969604
ep2_train_time 7.039710998535156
Test Epoch2 threshold 0.3 Acc 0.912828947368421, AUC 0.9800547361373901, avg_entr 0.024993140250444412
ep2_t0.3_test_time 0.12281966209411621
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.3_m5//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.95365 (114438/120000), AUC 0.9938794374465942
ep3_train_time 7.004653453826904
Test Epoch3 threshold 0.3 Acc 0.9095394736842105, AUC 0.979156494140625, avg_entr 0.026006214320659637
ep3_t0.3_test_time 0.11675429344177246
gc 0
Train Epoch4 Acc 0.9548333333333333 (114580/120000), AUC 0.9941616058349609
ep4_train_time 6.565317153930664
Test Epoch4 threshold 0.3 Acc 0.9113486842105263, AUC 0.9795511364936829, avg_entr 0.024543242529034615
ep4_t0.3_test_time 0.11656999588012695
gc 0
Train Epoch5 Acc 0.9554916666666666 (114659/120000), AUC 0.9945665001869202
ep5_train_time 6.663877964019775
Test Epoch5 threshold 0.3 Acc 0.9110197368421052, AUC 0.9790984988212585, avg_entr 0.02342640422284603
ep5_t0.3_test_time 0.11322832107543945
gc 0
Train Epoch6 Acc 0.9559416666666667 (114713/120000), AUC 0.9946736097335815
ep6_train_time 6.582583427429199
Test Epoch6 threshold 0.3 Acc 0.9098684210526315, AUC 0.9789307117462158, avg_entr 0.024317756295204163
ep6_t0.3_test_time 0.11470770835876465
gc 0
Train Epoch7 Acc 0.9587333333333333 (115048/120000), AUC 0.9953866004943848
ep7_train_time 6.741842985153198
Test Epoch7 threshold 0.3 Acc 0.9097039473684211, AUC 0.9788798093795776, avg_entr 0.024763671681284904
ep7_t0.3_test_time 0.1158294677734375
gc 0
Train Epoch8 Acc 0.95915 (115098/120000), AUC 0.995395302772522
ep8_train_time 6.700844764709473
Test Epoch8 threshold 0.3 Acc 0.9087171052631579, AUC 0.9785496592521667, avg_entr 0.024157844483852386
ep8_t0.3_test_time 0.11367630958557129
gc 0
Train Epoch9 Acc 0.959525 (115143/120000), AUC 0.9955841302871704
ep9_train_time 6.644899845123291
Test Epoch9 threshold 0.3 Acc 0.9103618421052632, AUC 0.9786854386329651, avg_entr 0.024287141859531403
ep9_t0.3_test_time 0.11624836921691895
Best AUC 0.9800547361373901
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.3_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9217105263157894, AUC 0.9854000806808472, avg_entr 0.02523106336593628
t0.3_test_time 0.03129148483276367
