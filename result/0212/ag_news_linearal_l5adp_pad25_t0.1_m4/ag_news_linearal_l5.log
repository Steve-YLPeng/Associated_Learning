total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.1_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.158425 (19011/120000), AUC 0.34467798471450806
ep0_train_time 5.854587078094482
Test Epoch0 threshold 0.1 Acc 0.9146381578947368, AUC 0.9810681939125061, avg_entr 0.02236083894968033
ep0_t0.1_test_time 0.09499311447143555
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.1_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.14473333333333332 (17368/120000), AUC 0.4115750789642334
ep1_train_time 5.369510889053345
Test Epoch1 threshold 0.1 Acc 0.9121710526315789, AUC 0.9804600477218628, avg_entr 0.019262922927737236
ep1_t0.1_test_time 0.09294748306274414
gc 0
Train Epoch2 Acc 0.2680916666666667 (32171/120000), AUC 0.47030526399612427
ep2_train_time 5.50264835357666
Test Epoch2 threshold 0.1 Acc 0.9103618421052632, AUC 0.9797865748405457, avg_entr 0.017840364947915077
ep2_t0.1_test_time 0.09328389167785645
gc 0
Train Epoch3 Acc 0.284375 (34125/120000), AUC 0.5995113849639893
ep3_train_time 5.403938293457031
Test Epoch3 threshold 0.1 Acc 0.9100328947368421, AUC 0.979884922504425, avg_entr 0.01460392214357853
ep3_t0.1_test_time 0.09373021125793457
gc 0
Train Epoch4 Acc 0.27720833333333333 (33265/120000), AUC 0.6539491415023804
ep4_train_time 5.391341686248779
Test Epoch4 threshold 0.1 Acc 0.9098684210526315, AUC 0.9793304204940796, avg_entr 0.012521566823124886
ep4_t0.1_test_time 0.09323239326477051
gc 0
Train Epoch5 Acc 0.2705166666666667 (32462/120000), AUC 0.6712093949317932
ep5_train_time 5.416337013244629
Test Epoch5 threshold 0.1 Acc 0.9101973684210526, AUC 0.9793063998222351, avg_entr 0.01237885095179081
ep5_t0.1_test_time 0.09733915328979492
gc 0
Train Epoch6 Acc 0.26840833333333336 (32209/120000), AUC 0.6811663508415222
ep6_train_time 5.367689847946167
Test Epoch6 threshold 0.1 Acc 0.9100328947368421, AUC 0.9789465665817261, avg_entr 0.012658091261982918
ep6_t0.1_test_time 0.09284043312072754
gc 0
Train Epoch7 Acc 0.265425 (31851/120000), AUC 0.6917814016342163
ep7_train_time 5.524366855621338
Test Epoch7 threshold 0.1 Acc 0.9111842105263158, AUC 0.9790262579917908, avg_entr 0.01258022803813219
ep7_t0.1_test_time 0.09677624702453613
gc 0
Train Epoch8 Acc 0.263625 (31635/120000), AUC 0.6982031464576721
ep8_train_time 5.816131114959717
Test Epoch8 threshold 0.1 Acc 0.909375, AUC 0.9786911010742188, avg_entr 0.012418736703693867
ep8_t0.1_test_time 0.09538698196411133
gc 0
Train Epoch9 Acc 0.2628 (31536/120000), AUC 0.7034107446670532
ep9_train_time 5.525524377822876
Test Epoch9 threshold 0.1 Acc 0.9090460526315789, AUC 0.9785891175270081, avg_entr 0.012238199822604656
ep9_t0.1_test_time 0.0930635929107666
Best AUC 0.9810681939125061
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.1_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9223684210526316, AUC 0.985850989818573, avg_entr 0.022426243871450424
t0.1_test_time 0.024350881576538086
