total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.7_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.2578083333333333 (30937/120000), AUC 0.5785506963729858
ep0_train_time 5.467633008956909
Test Epoch0 threshold 0.7 Acc 0.9164473684210527, AUC 0.9806337356567383, avg_entr 0.03437463939189911
ep0_t0.7_test_time 0.10344529151916504
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.7_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.28523333333333334 (34228/120000), AUC 0.6329273581504822
ep1_train_time 5.075191259384155
Test Epoch1 threshold 0.7 Acc 0.9179276315789474, AUC 0.9807735681533813, avg_entr 0.03021947667002678
ep1_t0.7_test_time 0.10191583633422852
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.7_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25905833333333333 (31087/120000), AUC 0.6309829950332642
ep2_train_time 5.018548488616943
Test Epoch2 threshold 0.7 Acc 0.9138157894736842, AUC 0.98052978515625, avg_entr 0.029033463448286057
ep2_t0.7_test_time 0.10108113288879395
gc 0
Train Epoch3 Acc 0.25835 (31002/120000), AUC 0.6218311190605164
ep3_train_time 4.990298509597778
Test Epoch3 threshold 0.7 Acc 0.9120065789473685, AUC 0.9800991415977478, avg_entr 0.02800651080906391
ep3_t0.7_test_time 0.10107207298278809
gc 0
Train Epoch4 Acc 0.261025 (31323/120000), AUC 0.6131336688995361
ep4_train_time 5.052863836288452
Test Epoch4 threshold 0.7 Acc 0.9115131578947369, AUC 0.9799363017082214, avg_entr 0.028971342369914055
ep4_t0.7_test_time 0.10046005249023438
gc 0
Train Epoch5 Acc 0.26434166666666664 (31721/120000), AUC 0.6070513129234314
ep5_train_time 5.314691066741943
Test Epoch5 threshold 0.7 Acc 0.9120065789473685, AUC 0.9797841310501099, avg_entr 0.02792958728969097
ep5_t0.7_test_time 0.10459113121032715
gc 0
Train Epoch6 Acc 0.266875 (32025/120000), AUC 0.6037884950637817
ep6_train_time 5.32090163230896
Test Epoch6 threshold 0.7 Acc 0.9148026315789474, AUC 0.9796345829963684, avg_entr 0.026994474232196808
ep6_t0.7_test_time 0.10436058044433594
gc 0
Train Epoch7 Acc 0.269225 (32307/120000), AUC 0.6021849513053894
ep7_train_time 5.339445352554321
Test Epoch7 threshold 0.7 Acc 0.9121710526315789, AUC 0.9792402982711792, avg_entr 0.02744760736823082
ep7_t0.7_test_time 0.10174393653869629
gc 0
Train Epoch8 Acc 0.27020833333333333 (32425/120000), AUC 0.600112795829773
ep8_train_time 5.0496532917022705
Test Epoch8 threshold 0.7 Acc 0.9115131578947369, AUC 0.979191780090332, avg_entr 0.027076130732893944
ep8_t0.7_test_time 0.10108590126037598
gc 0
Train Epoch9 Acc 0.270825 (32499/120000), AUC 0.5981526374816895
ep9_train_time 5.13626766204834
Test Epoch9 threshold 0.7 Acc 0.9098684210526315, AUC 0.9791237115859985, avg_entr 0.027139252051711082
ep9_t0.7_test_time 0.10143518447875977
Best AUC 0.9807735681533813
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.7_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9243421052631579, AUC 0.9859417080879211, avg_entr 0.03104555793106556
t0.7_test_time 0.026601552963256836
