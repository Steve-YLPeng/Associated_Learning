total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad125_t0.1_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9238833333333333 (110866/120000), AUC 0.9845786094665527
ep0_train_time 65.25732207298279
Test Epoch0 threshold 0.1 Acc 0.9129934210526316, AUC 0.9785740375518799, avg_entr 0.006767811719328165
ep0_t0.1_test_time 0.48001861572265625
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad125_t0.1_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9565916666666666 (114791/120000), AUC 0.9920852184295654
ep1_train_time 65.39483571052551
Test Epoch1 threshold 0.1 Acc 0.9111842105263158, AUC 0.9780209064483643, avg_entr 0.008172957226634026
ep1_t0.1_test_time 0.49832701683044434
gc 0
Train Epoch2 Acc 0.959 (115080/120000), AUC 0.9929202198982239
ep2_train_time 65.10948371887207
Test Epoch2 threshold 0.1 Acc 0.9115131578947369, AUC 0.9774907231330872, avg_entr 0.007568569388240576
ep2_t0.1_test_time 0.5040504932403564
gc 0
Train Epoch3 Acc 0.9611333333333333 (115336/120000), AUC 0.993589460849762
ep3_train_time 65.08894085884094
Test Epoch3 threshold 0.1 Acc 0.9120065789473685, AUC 0.9773349761962891, avg_entr 0.007567387539893389
ep3_t0.1_test_time 0.4739534854888916
gc 0
Train Epoch4 Acc 0.9633583333333333 (115603/120000), AUC 0.9940375089645386
ep4_train_time 65.21108841896057
Test Epoch4 threshold 0.1 Acc 0.9108552631578948, AUC 0.9771209955215454, avg_entr 0.007574769202619791
ep4_t0.1_test_time 0.5203762054443359
gc 0
Train Epoch5 Acc 0.9673833333333334 (116086/120000), AUC 0.9949445724487305
ep5_train_time 65.17617654800415
Test Epoch5 threshold 0.1 Acc 0.9106907894736842, AUC 0.9767909049987793, avg_entr 0.006867174059152603
ep5_t0.1_test_time 0.49853038787841797
gc 0
Train Epoch6 Acc 0.9683166666666667 (116198/120000), AUC 0.9951022863388062
ep6_train_time 65.11899876594543
Test Epoch6 threshold 0.1 Acc 0.9106907894736842, AUC 0.9760414958000183, avg_entr 0.00685875304043293
ep6_t0.1_test_time 0.49292445182800293
gc 0
Train Epoch7 Acc 0.969175 (116301/120000), AUC 0.9952141642570496
ep7_train_time 65.0995147228241
Test Epoch7 threshold 0.1 Acc 0.9080592105263158, AUC 0.975571870803833, avg_entr 0.0067116268910467625
ep7_t0.1_test_time 0.4881446361541748
gc 0
Train Epoch8 Acc 0.9704166666666667 (116450/120000), AUC 0.9954962730407715
ep8_train_time 65.08744859695435
Test Epoch8 threshold 0.1 Acc 0.9052631578947369, AUC 0.9753243923187256, avg_entr 0.006482309196144342
ep8_t0.1_test_time 0.48179101943969727
gc 0
Train Epoch9 Acc 0.9722416666666667 (116669/120000), AUC 0.9957944750785828
ep9_train_time 65.14968752861023
Test Epoch9 threshold 0.1 Acc 0.9069078947368421, AUC 0.9752869009971619, avg_entr 0.006888178642839193
ep9_t0.1_test_time 0.4930918216705322
Best AUC 0.9785740375518799
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad125_t0.1_m5//ag_news_lstmal_l5_prefix.pt
Test threshold 0.1 Acc 0.9243421052631579, AUC 0.98357754945755, avg_entr 0.007486838847398758
t0.1_test_time 0.13498139381408691
