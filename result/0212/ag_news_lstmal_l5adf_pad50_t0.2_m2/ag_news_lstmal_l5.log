total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad50_t0.2_m1//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.369575 (44349/120000), AUC 0.4696371257305145
ep0_train_time 19.712321043014526
Test Epoch0 threshold 0.2 Acc 0.9148026315789474, AUC 0.9796233773231506, avg_entr 0.01736924611032009
ep0_t0.2_test_time 0.1488964557647705
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad50_t0.2_m2//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.42475833333333335 (50971/120000), AUC 0.500664472579956
ep1_train_time 19.66753888130188
Test Epoch1 threshold 0.2 Acc 0.9144736842105263, AUC 0.9797652959823608, avg_entr 0.016305871307849884
ep1_t0.2_test_time 0.1463925838470459
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad50_t0.2_m2//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.399575 (47949/120000), AUC 0.5085410475730896
ep2_train_time 19.471354722976685
Test Epoch2 threshold 0.2 Acc 0.9123355263157895, AUC 0.979527473449707, avg_entr 0.01550653949379921
ep2_t0.2_test_time 0.14404034614562988
gc 0
Train Epoch3 Acc 0.3599 (43188/120000), AUC 0.4928899109363556
ep3_train_time 19.714643955230713
Test Epoch3 threshold 0.2 Acc 0.9105263157894737, AUC 0.9786356091499329, avg_entr 0.014101948589086533
ep3_t0.2_test_time 0.14415359497070312
gc 0
Train Epoch4 Acc 0.33105 (39726/120000), AUC 0.46977636218070984
ep4_train_time 19.426973819732666
Test Epoch4 threshold 0.2 Acc 0.9098684210526315, AUC 0.97855144739151, avg_entr 0.014919263310730457
ep4_t0.2_test_time 0.1439805030822754
gc 0
Train Epoch5 Acc 0.2748833333333333 (32986/120000), AUC 0.4400588274002075
ep5_train_time 19.65070605278015
Test Epoch5 threshold 0.2 Acc 0.9098684210526315, AUC 0.978518009185791, avg_entr 0.014362458139657974
ep5_t0.2_test_time 0.1432485580444336
gc 0
Train Epoch6 Acc 0.2571833333333333 (30862/120000), AUC 0.4304809868335724
ep6_train_time 19.792632579803467
Test Epoch6 threshold 0.2 Acc 0.909375, AUC 0.9778434038162231, avg_entr 0.01417588721960783
ep6_t0.2_test_time 0.14326214790344238
gc 0
Train Epoch7 Acc 0.24963333333333335 (29956/120000), AUC 0.4191419184207916
ep7_train_time 19.64643692970276
Test Epoch7 threshold 0.2 Acc 0.9080592105263158, AUC 0.9779075384140015, avg_entr 0.013453075662255287
ep7_t0.2_test_time 0.14348483085632324
gc 0
Train Epoch8 Acc 0.238625 (28635/120000), AUC 0.41115111112594604
ep8_train_time 19.544594049453735
Test Epoch8 threshold 0.2 Acc 0.9085526315789474, AUC 0.9779452085494995, avg_entr 0.013864311389625072
ep8_t0.2_test_time 0.14346647262573242
gc 0
Train Epoch9 Acc 0.23063333333333333 (27676/120000), AUC 0.40644410252571106
ep9_train_time 19.824480533599854
Test Epoch9 threshold 0.2 Acc 0.9078947368421053, AUC 0.977378249168396, avg_entr 0.012983039952814579
ep9_t0.2_test_time 0.14545631408691406
Best AUC 0.9797652959823608
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad50_t0.2_m2//ag_news_lstmal_l5_prefix.pt
Test threshold 0.2 Acc 0.925, AUC 0.9856102466583252, avg_entr 0.0171121284365654
t0.2_test_time 0.03720521926879883
