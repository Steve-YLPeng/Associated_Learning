total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.9_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.021541666666666667 (2585/120000), AUC 0.266702264547348
ep0_train_time 5.971781015396118
Test Epoch0 threshold 0.9 Acc 0.9148026315789474, AUC 0.98044353723526, avg_entr 0.02625814452767372
ep0_t0.9_test_time 0.10290908813476562
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.9_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.03165 (3798/120000), AUC 0.26753249764442444
ep1_train_time 5.528393745422363
Test Epoch1 threshold 0.9 Acc 0.9144736842105263, AUC 0.9802658557891846, avg_entr 0.026638884097337723
ep1_t0.9_test_time 0.10104751586914062
gc 0
Train Epoch2 Acc 0.052075 (6249/120000), AUC 0.28400591015815735
ep2_train_time 5.4994423389434814
Test Epoch2 threshold 0.9 Acc 0.9115131578947369, AUC 0.9798141717910767, avg_entr 0.026979772374033928
ep2_t0.9_test_time 0.10056805610656738
gc 0
Train Epoch3 Acc 0.05084166666666667 (6101/120000), AUC 0.29424312710762024
ep3_train_time 5.575232982635498
Test Epoch3 threshold 0.9 Acc 0.9110197368421052, AUC 0.9796997308731079, avg_entr 0.025952598080039024
ep3_t0.9_test_time 0.10143136978149414
gc 0
Train Epoch4 Acc 0.03739166666666666 (4487/120000), AUC 0.29429370164871216
ep4_train_time 5.59235143661499
Test Epoch4 threshold 0.9 Acc 0.9116776315789473, AUC 0.9792321920394897, avg_entr 0.026275431737303734
ep4_t0.9_test_time 0.1014256477355957
gc 0
Train Epoch5 Acc 0.025233333333333333 (3028/120000), AUC 0.2859671115875244
ep5_train_time 5.851552486419678
Test Epoch5 threshold 0.9 Acc 0.9118421052631579, AUC 0.9792321920394897, avg_entr 0.02630361169576645
ep5_t0.9_test_time 0.1046142578125
gc 0
Train Epoch6 Acc 0.020616666666666665 (2474/120000), AUC 0.2774219214916229
ep6_train_time 5.932653903961182
Test Epoch6 threshold 0.9 Acc 0.9108552631578948, AUC 0.9790635108947754, avg_entr 0.026845375075936317
ep6_t0.9_test_time 0.1086423397064209
gc 0
Train Epoch7 Acc 0.017975 (2157/120000), AUC 0.2675304412841797
ep7_train_time 5.766272068023682
Test Epoch7 threshold 0.9 Acc 0.9113486842105263, AUC 0.9789353609085083, avg_entr 0.026381108909845352
ep7_t0.9_test_time 0.10172319412231445
gc 0
Train Epoch8 Acc 0.016941666666666667 (2033/120000), AUC 0.2555493712425232
ep8_train_time 5.56276273727417
Test Epoch8 threshold 0.9 Acc 0.9105263157894737, AUC 0.9788232445716858, avg_entr 0.026533935219049454
ep8_t0.9_test_time 0.10554265975952148
gc 0
Train Epoch9 Acc 0.016375 (1965/120000), AUC 0.24713800847530365
ep9_train_time 5.5652806758880615
Test Epoch9 threshold 0.9 Acc 0.9097039473684211, AUC 0.9786345958709717, avg_entr 0.026192305609583855
ep9_t0.9_test_time 0.10101699829101562
Best AUC 0.98044353723526
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.9_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9296052631578947, AUC 0.9858590960502625, avg_entr 0.024907372891902924
t0.9_test_time 0.026089191436767578
