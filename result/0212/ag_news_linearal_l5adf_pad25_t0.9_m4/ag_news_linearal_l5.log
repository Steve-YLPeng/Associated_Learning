total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.9_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.23365833333333333 (28039/120000), AUC 0.5465474128723145
ep0_train_time 6.089614629745483
Test Epoch0 threshold 0.9 Acc 0.9126644736842106, AUC 0.9807136058807373, avg_entr 0.024477923288941383
ep0_t0.9_test_time 0.07371664047241211
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.9_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.19831666666666667 (23798/120000), AUC 0.5829194188117981
ep1_train_time 5.579082489013672
Test Epoch1 threshold 0.9 Acc 0.9110197368421052, AUC 0.9804861545562744, avg_entr 0.02537040412425995
ep1_t0.9_test_time 0.07290267944335938
gc 0
Train Epoch2 Acc 0.14475 (17370/120000), AUC 0.5648075342178345
ep2_train_time 5.632906675338745
Test Epoch2 threshold 0.9 Acc 0.9105263157894737, AUC 0.9802088141441345, avg_entr 0.02497623860836029
ep2_t0.9_test_time 0.0716249942779541
gc 0
Train Epoch3 Acc 0.13471666666666668 (16166/120000), AUC 0.5269526839256287
ep3_train_time 5.618282794952393
Test Epoch3 threshold 0.9 Acc 0.9108552631578948, AUC 0.9800703525543213, avg_entr 0.02561286650598049
ep3_t0.9_test_time 0.0715951919555664
gc 0
Train Epoch4 Acc 0.19315 (23178/120000), AUC 0.5079660415649414
ep4_train_time 5.572963714599609
Test Epoch4 threshold 0.9 Acc 0.9098684210526315, AUC 0.9800618290901184, avg_entr 0.02491534873843193
ep4_t0.9_test_time 0.07271981239318848
gc 0
Train Epoch5 Acc 0.20820833333333333 (24985/120000), AUC 0.49595707654953003
ep5_train_time 5.6067118644714355
Test Epoch5 threshold 0.9 Acc 0.9103618421052632, AUC 0.9796018600463867, avg_entr 0.025125786662101746
ep5_t0.9_test_time 0.07295036315917969
gc 0
Train Epoch6 Acc 0.191325 (22959/120000), AUC 0.4892235994338989
ep6_train_time 5.585740327835083
Test Epoch6 threshold 0.9 Acc 0.9111842105263158, AUC 0.9792967438697815, avg_entr 0.024871597066521645
ep6_t0.9_test_time 0.07233643531799316
gc 0
Train Epoch7 Acc 0.15686666666666665 (18824/120000), AUC 0.4841024577617645
ep7_train_time 5.589625120162964
Test Epoch7 threshold 0.9 Acc 0.9100328947368421, AUC 0.9790953993797302, avg_entr 0.02550833858549595
ep7_t0.9_test_time 0.07150745391845703
gc 0
Train Epoch8 Acc 0.12710833333333332 (15253/120000), AUC 0.4815824627876282
ep8_train_time 5.599783658981323
Test Epoch8 threshold 0.9 Acc 0.9101973684210526, AUC 0.978809654712677, avg_entr 0.025550832971930504
ep8_t0.9_test_time 0.07325005531311035
gc 0
Train Epoch9 Acc 0.106825 (12819/120000), AUC 0.48151496052742004
ep9_train_time 5.599355697631836
Test Epoch9 threshold 0.9 Acc 0.9090460526315789, AUC 0.9787914752960205, avg_entr 0.025642987340688705
ep9_t0.9_test_time 0.07251310348510742
Best AUC 0.9807136058807373
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.9_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9230263157894737, AUC 0.9857218265533447, avg_entr 0.025598958134651184
t0.9_test_time 0.018748998641967773
