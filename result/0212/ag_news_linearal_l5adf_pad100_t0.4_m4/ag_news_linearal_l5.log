total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.4_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.087175 (10461/120000), AUC 0.5613522529602051
ep0_train_time 8.196494340896606
Test Epoch0 threshold 0.4 Acc 0.9161184210526315, AUC 0.9805113673210144, avg_entr 0.025126267224550247
ep0_t0.4_test_time 0.17006468772888184
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.4_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2009 (24108/120000), AUC 0.58870530128479
ep1_train_time 7.778042316436768
Test Epoch1 threshold 0.4 Acc 0.9139802631578947, AUC 0.9803012609481812, avg_entr 0.026480719447135925
ep1_t0.4_test_time 0.16780567169189453
gc 0
Train Epoch2 Acc 0.09501666666666667 (11402/120000), AUC 0.4875901937484741
ep2_train_time 7.776122093200684
Test Epoch2 threshold 0.4 Acc 0.9141447368421053, AUC 0.9803558588027954, avg_entr 0.02499217912554741
ep2_t0.4_test_time 0.16796207427978516
gc 0
Train Epoch3 Acc 0.034541666666666665 (4145/120000), AUC 0.40622299909591675
ep3_train_time 7.767683267593384
Test Epoch3 threshold 0.4 Acc 0.9146381578947368, AUC 0.97999507188797, avg_entr 0.025281205773353577
ep3_t0.4_test_time 0.1676042079925537
gc 0
Train Epoch4 Acc 0.0212 (2544/120000), AUC 0.37766459584236145
ep4_train_time 7.881825685501099
Test Epoch4 threshold 0.4 Acc 0.9103618421052632, AUC 0.9798158407211304, avg_entr 0.025498686358332634
ep4_t0.4_test_time 0.16556382179260254
gc 0
Train Epoch5 Acc 0.0194 (2328/120000), AUC 0.35421720147132874
ep5_train_time 7.642165660858154
Test Epoch5 threshold 0.4 Acc 0.9134868421052632, AUC 0.9796594381332397, avg_entr 0.025352168828248978
ep5_t0.4_test_time 0.16585350036621094
gc 0
Train Epoch6 Acc 0.019941666666666667 (2393/120000), AUC 0.3493025004863739
ep6_train_time 7.834149599075317
Test Epoch6 threshold 0.4 Acc 0.9125, AUC 0.9794009923934937, avg_entr 0.02584889344871044
ep6_t0.4_test_time 0.16793155670166016
gc 0
Train Epoch7 Acc 0.021016666666666666 (2522/120000), AUC 0.3455210328102112
ep7_train_time 7.749591112136841
Test Epoch7 threshold 0.4 Acc 0.9115131578947369, AUC 0.979308545589447, avg_entr 0.025023696944117546
ep7_t0.4_test_time 0.17485523223876953
gc 0
Train Epoch8 Acc 0.022275 (2673/120000), AUC 0.3413763642311096
ep8_train_time 7.721859931945801
Test Epoch8 threshold 0.4 Acc 0.9118421052631579, AUC 0.9792838096618652, avg_entr 0.02530626952648163
ep8_t0.4_test_time 0.16719675064086914
gc 0
Train Epoch9 Acc 0.023283333333333333 (2794/120000), AUC 0.3413892686367035
ep9_train_time 7.703946590423584
Test Epoch9 threshold 0.4 Acc 0.9110197368421052, AUC 0.9791692495346069, avg_entr 0.025193043053150177
ep9_t0.4_test_time 0.16676831245422363
Best AUC 0.9805113673210144
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.4_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.925, AUC 0.9859504103660583, avg_entr 0.02573021501302719
t0.4_test_time 0.04452824592590332
