total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.1_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.24070833333333333 (28885/120000), AUC 0.4340496361255646
ep0_train_time 5.490520715713501
Test Epoch0 threshold 0.1 Acc 0.9143092105263158, AUC 0.9809435606002808, avg_entr 0.02419557236135006
ep0_t0.1_test_time 0.08803558349609375
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.1_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.183275 (21993/120000), AUC 0.4566172957420349
ep1_train_time 5.066512107849121
Test Epoch1 threshold 0.1 Acc 0.9133223684210526, AUC 0.9807156920433044, avg_entr 0.023819822818040848
ep1_t0.1_test_time 0.0870065689086914
gc 0
Train Epoch2 Acc 0.13076666666666667 (15692/120000), AUC 0.5156838893890381
ep2_train_time 5.07604455947876
Test Epoch2 threshold 0.1 Acc 0.9115131578947369, AUC 0.980255663394928, avg_entr 0.02301313728094101
ep2_t0.1_test_time 0.08869409561157227
gc 0
Train Epoch3 Acc 0.15639166666666668 (18767/120000), AUC 0.5662133693695068
ep3_train_time 5.084022283554077
Test Epoch3 threshold 0.1 Acc 0.9141447368421053, AUC 0.9800541400909424, avg_entr 0.02144278958439827
ep3_t0.1_test_time 0.08691072463989258
gc 0
Train Epoch4 Acc 0.21025 (25230/120000), AUC 0.5784324407577515
ep4_train_time 5.031447172164917
Test Epoch4 threshold 0.1 Acc 0.9108552631578948, AUC 0.9798919558525085, avg_entr 0.02081340178847313
ep4_t0.1_test_time 0.08670568466186523
gc 0
Train Epoch5 Acc 0.22835 (27402/120000), AUC 0.5922201871871948
ep5_train_time 5.105894565582275
Test Epoch5 threshold 0.1 Acc 0.912828947368421, AUC 0.9796740412712097, avg_entr 0.019550617784261703
ep5_t0.1_test_time 0.08586263656616211
gc 0
Train Epoch6 Acc 0.23335 (28002/120000), AUC 0.606675386428833
ep6_train_time 5.122623443603516
Test Epoch6 threshold 0.1 Acc 0.9134868421052632, AUC 0.9793576598167419, avg_entr 0.01926601491868496
ep6_t0.1_test_time 0.09021496772766113
gc 0
Train Epoch7 Acc 0.24878333333333333 (29854/120000), AUC 0.6224614977836609
ep7_train_time 5.093315601348877
Test Epoch7 threshold 0.1 Acc 0.9118421052631579, AUC 0.9791824817657471, avg_entr 0.01865987665951252
ep7_t0.1_test_time 0.08621335029602051
gc 0
Train Epoch8 Acc 0.28313333333333335 (33976/120000), AUC 0.6386036276817322
ep8_train_time 5.124301195144653
Test Epoch8 threshold 0.1 Acc 0.9110197368421052, AUC 0.9789046049118042, avg_entr 0.017660919576883316
ep8_t0.1_test_time 0.08584952354431152
gc 0
Train Epoch9 Acc 0.3163166666666667 (37958/120000), AUC 0.6486825942993164
ep9_train_time 5.066457748413086
Test Epoch9 threshold 0.1 Acc 0.9113486842105263, AUC 0.978895902633667, avg_entr 0.017802627757191658
ep9_t0.1_test_time 0.08695602416992188
Best AUC 0.9809435606002808
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.1_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9203947368421053, AUC 0.9856980443000793, avg_entr 0.025152942165732384
t0.1_test_time 0.02250957489013672
