total count words 102019
vocab size 30000
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.218225 (26187/120000), AUC 0.47751590609550476
ep0_train_time 28.7683846950531
Test Epoch0 threshold 0.8 Acc 0.9050986842105263, AUC 0.9757627844810486, avg_entr 0.16866563260555267
ep0_t0.8_test_time 0.16480588912963867
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad100_t0.8_m1//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.19595833333333335 (23515/120000), AUC 0.47606000304222107
ep1_train_time 28.430546283721924
Test Epoch1 threshold 0.8 Acc 0.9090460526315789, AUC 0.9789761304855347, avg_entr 0.10511918365955353
ep1_t0.8_test_time 0.16097426414489746
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad100_t0.8_m1//ag_news_lstmal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.197925 (23751/120000), AUC 0.4796699285507202
ep2_train_time 28.467328310012817
Test Epoch2 threshold 0.8 Acc 0.915296052631579, AUC 0.9800924062728882, avg_entr 0.0767115131020546
ep2_t0.8_test_time 0.16191673278808594
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad100_t0.8_m1//ag_news_lstmal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.19943333333333332 (23932/120000), AUC 0.48225104808807373
ep3_train_time 28.476187705993652
Test Epoch3 threshold 0.8 Acc 0.9143092105263158, AUC 0.9802883863449097, avg_entr 0.0665479451417923
ep3_t0.8_test_time 0.16139006614685059
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad100_t0.8_m1//ag_news_lstmal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.202125 (24255/120000), AUC 0.4842733144760132
ep4_train_time 28.420599460601807
Test Epoch4 threshold 0.8 Acc 0.9151315789473684, AUC 0.9805015921592712, avg_entr 0.05798867717385292
ep4_t0.8_test_time 0.16084909439086914
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad100_t0.8_m1//ag_news_lstmal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.20453333333333334 (24544/120000), AUC 0.48604610562324524
ep5_train_time 28.409108638763428
Test Epoch5 threshold 0.8 Acc 0.9148026315789474, AUC 0.980606734752655, avg_entr 0.05437006056308746
ep5_t0.8_test_time 0.16006922721862793
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad100_t0.8_m1//ag_news_lstmal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.20705833333333334 (24847/120000), AUC 0.48753437399864197
ep6_train_time 28.42719054222107
Test Epoch6 threshold 0.8 Acc 0.9151315789473684, AUC 0.980506420135498, avg_entr 0.04838971421122551
ep6_t0.8_test_time 0.1603858470916748
gc 0
Train Epoch7 Acc 0.20901666666666666 (25082/120000), AUC 0.489011287689209
ep7_train_time 28.46779203414917
Test Epoch7 threshold 0.8 Acc 0.9157894736842105, AUC 0.9803943634033203, avg_entr 0.0471816249191761
ep7_t0.8_test_time 0.16034340858459473
gc 0
Train Epoch8 Acc 0.210525 (25263/120000), AUC 0.48977336287498474
ep8_train_time 28.439014196395874
Test Epoch8 threshold 0.8 Acc 0.9131578947368421, AUC 0.9799858331680298, avg_entr 0.04373081773519516
ep8_t0.8_test_time 0.1598188877105713
gc 0
Train Epoch9 Acc 0.21185833333333334 (25423/120000), AUC 0.49054381251335144
ep9_train_time 28.518476724624634
Test Epoch9 threshold 0.8 Acc 0.9136513157894737, AUC 0.9798843264579773, avg_entr 0.041257344186306
ep9_t0.8_test_time 0.1603410243988037
Best AUC 0.980606734752655
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad100_t0.8_m1//ag_news_lstmal_l5_prefix.pt
Test threshold 0.8 Acc 0.9223684210526316, AUC 0.9861593842506409, avg_entr 0.055856846272945404
t0.8_test_time 0.040973663330078125
