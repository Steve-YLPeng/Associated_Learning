total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.1_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.054408333333333336 (6529/120000), AUC 0.2745353579521179
ep0_train_time 6.2202839851379395
Test Epoch0 threshold 0.1 Acc 0.9134868421052632, AUC 0.9803482294082642, avg_entr 0.024634744971990585
ep0_t0.1_test_time 0.11927962303161621
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.1_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.08529166666666667 (10235/120000), AUC 0.2179632931947708
ep1_train_time 5.733428478240967
Test Epoch1 threshold 0.1 Acc 0.9149671052631579, AUC 0.9798966646194458, avg_entr 0.02461039461195469
ep1_t0.1_test_time 0.11715555191040039
gc 0
Train Epoch2 Acc 0.14621666666666666 (17546/120000), AUC 0.23843805491924286
ep2_train_time 5.795651435852051
Test Epoch2 threshold 0.1 Acc 0.915625, AUC 0.9799243211746216, avg_entr 0.023852383717894554
ep2_t0.1_test_time 0.11944222450256348
gc 0
Train Epoch3 Acc 0.17804166666666665 (21365/120000), AUC 0.3084127902984619
ep3_train_time 5.748597860336304
Test Epoch3 threshold 0.1 Acc 0.912828947368421, AUC 0.9796821475028992, avg_entr 0.021972138434648514
ep3_t0.1_test_time 0.11778020858764648
gc 0
Train Epoch4 Acc 0.18420833333333334 (22105/120000), AUC 0.3381716012954712
ep4_train_time 5.737702369689941
Test Epoch4 threshold 0.1 Acc 0.9123355263157895, AUC 0.9794433116912842, avg_entr 0.021324502304196358
ep4_t0.1_test_time 0.11753320693969727
gc 0
Train Epoch5 Acc 0.16820833333333332 (20185/120000), AUC 0.32966795563697815
ep5_train_time 5.729299306869507
Test Epoch5 threshold 0.1 Acc 0.9121710526315789, AUC 0.979324221611023, avg_entr 0.019979316741228104
ep5_t0.1_test_time 0.12194204330444336
gc 0
Train Epoch6 Acc 0.14764166666666667 (17717/120000), AUC 0.31363174319267273
ep6_train_time 5.766451120376587
Test Epoch6 threshold 0.1 Acc 0.9105263157894737, AUC 0.9791580438613892, avg_entr 0.019095735624432564
ep6_t0.1_test_time 0.11781883239746094
gc 0
Train Epoch7 Acc 0.12425 (14910/120000), AUC 0.290179044008255
ep7_train_time 5.766009569168091
Test Epoch7 threshold 0.1 Acc 0.9100328947368421, AUC 0.9790740013122559, avg_entr 0.01918361522257328
ep7_t0.1_test_time 0.11817479133605957
gc 0
Train Epoch8 Acc 0.09841666666666667 (11810/120000), AUC 0.2642804682254791
ep8_train_time 5.757809162139893
Test Epoch8 threshold 0.1 Acc 0.9113486842105263, AUC 0.9790467619895935, avg_entr 0.018549270927906036
ep8_t0.1_test_time 0.1189107894897461
gc 0
Train Epoch9 Acc 0.079275 (9513/120000), AUC 0.24783074855804443
ep9_train_time 5.780551195144653
Test Epoch9 threshold 0.1 Acc 0.9105263157894737, AUC 0.9786807894706726, avg_entr 0.018351469188928604
ep9_t0.1_test_time 0.11824941635131836
Best AUC 0.9803482294082642
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.1_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9263157894736842, AUC 0.9861764907836914, avg_entr 0.023531001061201096
t0.1_test_time 0.030765771865844727
