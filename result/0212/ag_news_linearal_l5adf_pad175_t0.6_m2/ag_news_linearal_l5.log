total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.25103333333333333 (30124/120000), AUC 0.63824462890625
ep0_train_time 9.122897148132324
Test Epoch0 threshold 0.6 Acc 0.9167763157894737, AUC 0.9810073375701904, avg_entr 0.02749735862016678
ep0_t0.6_test_time 0.25156164169311523
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25025 (30030/120000), AUC 0.7243492603302002
ep1_train_time 8.46000599861145
Test Epoch1 threshold 0.6 Acc 0.9159539473684211, AUC 0.9810806512832642, avg_entr 0.026621578261256218
ep1_t0.6_test_time 0.2496488094329834
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25011666666666665 (30014/120000), AUC 0.7262070178985596
ep2_train_time 8.577644348144531
Test Epoch2 threshold 0.6 Acc 0.9161184210526315, AUC 0.9807142615318298, avg_entr 0.026615938171744347
ep2_t0.6_test_time 0.24953889846801758
gc 0
Train Epoch3 Acc 0.25009166666666666 (30011/120000), AUC 0.7270801067352295
ep3_train_time 8.499747276306152
Test Epoch3 threshold 0.6 Acc 0.9149671052631579, AUC 0.980609655380249, avg_entr 0.025736086070537567
ep3_t0.6_test_time 0.2489790916442871
gc 0
Train Epoch4 Acc 0.250075 (30009/120000), AUC 0.7265225648880005
ep4_train_time 8.509724140167236
Test Epoch4 threshold 0.6 Acc 0.9126644736842106, AUC 0.9804822206497192, avg_entr 0.026602761819958687
ep4_t0.6_test_time 0.24857568740844727
gc 0
Train Epoch5 Acc 0.2500583333333333 (30007/120000), AUC 0.7271965742111206
ep5_train_time 8.674317359924316
Test Epoch5 threshold 0.6 Acc 0.9141447368421053, AUC 0.9804325699806213, avg_entr 0.025579482316970825
ep5_t0.6_test_time 0.24971508979797363
gc 0
Train Epoch6 Acc 0.2500583333333333 (30007/120000), AUC 0.726560115814209
ep6_train_time 8.509696006774902
Test Epoch6 threshold 0.6 Acc 0.9139802631578947, AUC 0.9803107976913452, avg_entr 0.026313703507184982
ep6_t0.6_test_time 0.248274564743042
gc 0
Train Epoch7 Acc 0.25004166666666666 (30005/120000), AUC 0.7259764075279236
ep7_train_time 8.75140905380249
Test Epoch7 threshold 0.6 Acc 0.9134868421052632, AUC 0.9801772832870483, avg_entr 0.025891179218888283
ep7_t0.6_test_time 0.24871397018432617
gc 0
Train Epoch8 Acc 0.25004166666666666 (30005/120000), AUC 0.7251609563827515
ep8_train_time 8.479569673538208
Test Epoch8 threshold 0.6 Acc 0.9129934210526316, AUC 0.9800944924354553, avg_entr 0.024973902851343155
ep8_t0.6_test_time 0.24935483932495117
gc 0
Train Epoch9 Acc 0.25004166666666666 (30005/120000), AUC 0.7253491878509521
ep9_train_time 8.536853790283203
Test Epoch9 threshold 0.6 Acc 0.9134868421052632, AUC 0.9800483584403992, avg_entr 0.025636710226535797
ep9_t0.6_test_time 0.24897098541259766
Best AUC 0.9810806512832642
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.925, AUC 0.9862507581710815, avg_entr 0.02551863342523575
t0.6_test_time 0.06306171417236328
