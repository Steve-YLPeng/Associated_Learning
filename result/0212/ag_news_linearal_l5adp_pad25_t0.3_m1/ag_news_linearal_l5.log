total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24050833333333332 (28861/120000), AUC 0.4472479224205017
ep0_train_time 4.305255889892578
Test Epoch0 threshold 0.3 Acc 0.9120065789473685, AUC 0.9795145988464355, avg_entr 0.1523066759109497
ep0_t0.3_test_time 0.07335758209228516
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.23684166666666667 (28421/120000), AUC 0.4374527931213379
ep1_train_time 3.8428728580474854
Test Epoch1 threshold 0.3 Acc 0.9136513157894737, AUC 0.9808660745620728, avg_entr 0.0952153131365776
ep1_t0.3_test_time 0.07174181938171387
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.23664166666666667 (28397/120000), AUC 0.44030269980430603
ep2_train_time 3.864758253097534
Test Epoch2 threshold 0.3 Acc 0.9123355263157895, AUC 0.9805588722229004, avg_entr 0.0760888159275055
ep2_t0.3_test_time 0.07190442085266113
gc 0
Train Epoch3 Acc 0.23655833333333334 (28387/120000), AUC 0.442105770111084
ep3_train_time 3.8395700454711914
Test Epoch3 threshold 0.3 Acc 0.9118421052631579, AUC 0.980701208114624, avg_entr 0.06658128648996353
ep3_t0.3_test_time 0.07134389877319336
gc 0
Train Epoch4 Acc 0.23669166666666666 (28403/120000), AUC 0.44367432594299316
ep4_train_time 3.844542980194092
Test Epoch4 threshold 0.3 Acc 0.9125, AUC 0.9801735281944275, avg_entr 0.05877013877034187
ep4_t0.3_test_time 0.07178020477294922
gc 0
Train Epoch5 Acc 0.236875 (28425/120000), AUC 0.444582462310791
ep5_train_time 3.8435418605804443
Test Epoch5 threshold 0.3 Acc 0.9116776315789473, AUC 0.9799213409423828, avg_entr 0.05376946181058884
ep5_t0.3_test_time 0.07224321365356445
gc 0
Train Epoch6 Acc 0.23690833333333333 (28429/120000), AUC 0.4451143145561218
ep6_train_time 3.858454704284668
Test Epoch6 threshold 0.3 Acc 0.9131578947368421, AUC 0.9799259901046753, avg_entr 0.05145622044801712
ep6_t0.3_test_time 0.07197332382202148
gc 0
Train Epoch7 Acc 0.23704166666666668 (28445/120000), AUC 0.4457302689552307
ep7_train_time 3.8578760623931885
Test Epoch7 threshold 0.3 Acc 0.9123355263157895, AUC 0.9796547293663025, avg_entr 0.04893799498677254
ep7_t0.3_test_time 0.07189702987670898
gc 0
Train Epoch8 Acc 0.23714166666666667 (28457/120000), AUC 0.4463868737220764
ep8_train_time 3.857915163040161
Test Epoch8 threshold 0.3 Acc 0.9125, AUC 0.9794685244560242, avg_entr 0.046347614377737045
ep8_t0.3_test_time 0.07155847549438477
gc 0
Train Epoch9 Acc 0.23718333333333333 (28462/120000), AUC 0.44710665941238403
ep9_train_time 3.8149333000183105
Test Epoch9 threshold 0.3 Acc 0.9103618421052632, AUC 0.9792675971984863, avg_entr 0.0446169339120388
ep9_t0.3_test_time 0.07343935966491699
Best AUC 0.9808660745620728
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.3_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9230263157894737, AUC 0.9860077500343323, avg_entr 0.09959039837121964
t0.3_test_time 0.01875591278076172
