total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad75_t0.9_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9207416666666667 (110489/120000), AUC 0.984816312789917
ep0_train_time 42.69580626487732
Test Epoch0 threshold 0.9 Acc 0.9133223684210526, AUC 0.9801517724990845, avg_entr 0.02549424208700657
ep0_t0.9_test_time 0.1362292766571045
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad75_t0.9_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9555666666666667 (114668/120000), AUC 0.9930983781814575
ep1_train_time 42.55303382873535
Test Epoch1 threshold 0.9 Acc 0.9120065789473685, AUC 0.9797024726867676, avg_entr 0.025579793378710747
ep1_t0.9_test_time 0.13346290588378906
gc 0
Train Epoch2 Acc 0.9584416666666666 (115013/120000), AUC 0.9939276576042175
ep2_train_time 42.66630005836487
Test Epoch2 threshold 0.9 Acc 0.9134868421052632, AUC 0.97970050573349, avg_entr 0.02572827786207199
ep2_t0.9_test_time 0.1346578598022461
gc 0
Train Epoch3 Acc 0.9604666666666667 (115256/120000), AUC 0.9943729043006897
ep3_train_time 42.60291934013367
Test Epoch3 threshold 0.9 Acc 0.9134868421052632, AUC 0.9796854257583618, avg_entr 0.025088481605052948
ep3_t0.9_test_time 0.14013171195983887
gc 0
Train Epoch4 Acc 0.9627583333333334 (115531/120000), AUC 0.9946622252464294
ep4_train_time 42.683342933654785
Test Epoch4 threshold 0.9 Acc 0.9121710526315789, AUC 0.9793517589569092, avg_entr 0.025348098948597908
ep4_t0.9_test_time 0.13326787948608398
gc 0
Train Epoch5 Acc 0.96635 (115962/120000), AUC 0.9954750537872314
ep5_train_time 42.64565324783325
Test Epoch5 threshold 0.9 Acc 0.9108552631578948, AUC 0.9791642427444458, avg_entr 0.026063457131385803
ep5_t0.9_test_time 0.1342461109161377
gc 0
Train Epoch6 Acc 0.9678916666666667 (116147/120000), AUC 0.9956969618797302
ep6_train_time 42.6421902179718
Test Epoch6 threshold 0.9 Acc 0.9111842105263158, AUC 0.9791911840438843, avg_entr 0.026028016582131386
ep6_t0.9_test_time 0.13527584075927734
gc 0
Train Epoch7 Acc 0.9691083333333333 (116293/120000), AUC 0.9957361221313477
ep7_train_time 42.63569521903992
Test Epoch7 threshold 0.9 Acc 0.9108552631578948, AUC 0.9790256023406982, avg_entr 0.026021575555205345
ep7_t0.9_test_time 0.13506746292114258
gc 0
Train Epoch8 Acc 0.9698083333333334 (116377/120000), AUC 0.9958847165107727
ep8_train_time 42.60938882827759
Test Epoch8 threshold 0.9 Acc 0.9090460526315789, AUC 0.9789655208587646, avg_entr 0.024680789560079575
ep8_t0.9_test_time 0.135331392288208
gc 0
Train Epoch9 Acc 0.9721916666666667 (116663/120000), AUC 0.9962776899337769
ep9_train_time 42.54143691062927
Test Epoch9 threshold 0.9 Acc 0.909375, AUC 0.9787878394126892, avg_entr 0.025948118418455124
ep9_t0.9_test_time 0.1349780559539795
Best AUC 0.9801517724990845
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad75_t0.9_m5//ag_news_lstmal_l5_prefix.pt
Test threshold 0.9 Acc 0.9223684210526316, AUC 0.9853065013885498, avg_entr 0.025319524109363556
t0.9_test_time 0.03495669364929199
