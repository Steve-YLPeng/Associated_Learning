total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.5_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.24694166666666667 (29633/120000), AUC 0.40977156162261963
ep0_train_time 9.87401819229126
Test Epoch0 threshold 0.5 Acc 0.9159539473684211, AUC 0.9806292057037354, avg_entr 0.026784148067235947
ep0_t0.5_test_time 0.25549793243408203
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.5_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25000833333333333 (30001/120000), AUC 0.3736433684825897
ep1_train_time 9.485369205474854
Test Epoch1 threshold 0.5 Acc 0.9166118421052631, AUC 0.9805089831352234, avg_entr 0.025440672412514687
ep1_t0.5_test_time 0.25292181968688965
gc 0
Train Epoch2 Acc 0.241575 (28989/120000), AUC 0.35869863629341125
ep2_train_time 9.451117992401123
Test Epoch2 threshold 0.5 Acc 0.9151315789473684, AUC 0.9803462028503418, avg_entr 0.025464512407779694
ep2_t0.5_test_time 0.2511003017425537
gc 0
Train Epoch3 Acc 0.20209166666666667 (24251/120000), AUC 0.35086071491241455
ep3_train_time 9.48807430267334
Test Epoch3 threshold 0.5 Acc 0.9141447368421053, AUC 0.9802157878875732, avg_entr 0.024897007271647453
ep3_t0.5_test_time 0.2529926300048828
gc 0
Train Epoch4 Acc 0.128525 (15423/120000), AUC 0.33164751529693604
ep4_train_time 9.487493991851807
Test Epoch4 threshold 0.5 Acc 0.9143092105263158, AUC 0.9799057245254517, avg_entr 0.02556590549647808
ep4_t0.5_test_time 0.252307653427124
gc 0
Train Epoch5 Acc 0.09303333333333333 (11164/120000), AUC 0.319995254278183
ep5_train_time 9.768885850906372
Test Epoch5 threshold 0.5 Acc 0.9139802631578947, AUC 0.9799771308898926, avg_entr 0.026002170518040657
ep5_t0.5_test_time 0.2519216537475586
gc 0
Train Epoch6 Acc 0.09259166666666667 (11111/120000), AUC 0.32014065980911255
ep6_train_time 9.442036867141724
Test Epoch6 threshold 0.5 Acc 0.9138157894736842, AUC 0.9798628091812134, avg_entr 0.0261592585593462
ep6_t0.5_test_time 0.252394437789917
gc 0
Train Epoch7 Acc 0.094125 (11295/120000), AUC 0.3195890784263611
ep7_train_time 9.43252968788147
Test Epoch7 threshold 0.5 Acc 0.9131578947368421, AUC 0.979719877243042, avg_entr 0.026061786338686943
ep7_t0.5_test_time 0.25247859954833984
gc 0
Train Epoch8 Acc 0.099625 (11955/120000), AUC 0.31806719303131104
ep8_train_time 9.385098934173584
Test Epoch8 threshold 0.5 Acc 0.9126644736842106, AUC 0.9796367883682251, avg_entr 0.02581353485584259
ep8_t0.5_test_time 0.25259995460510254
gc 0
Train Epoch9 Acc 0.10095 (12114/120000), AUC 0.31609809398651123
ep9_train_time 9.614738941192627
Test Epoch9 threshold 0.5 Acc 0.9123355263157895, AUC 0.9795526266098022, avg_entr 0.025782909244298935
ep9_t0.5_test_time 0.2523953914642334
Best AUC 0.9806292057037354
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.5_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.930921052631579, AUC 0.9863048195838928, avg_entr 0.025530049577355385
t0.5_test_time 0.06435942649841309
