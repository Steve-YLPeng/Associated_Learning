total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.5_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.909075 (109089/120000), AUC 0.9844852089881897
ep0_train_time 6.570141077041626
Test Epoch0 threshold 0.5 Acc 0.9136513157894737, AUC 0.980222225189209, avg_entr 0.025085343047976494
ep0_t0.5_test_time 0.07508373260498047
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.5_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9503666666666667 (114044/120000), AUC 0.9930021166801453
ep1_train_time 6.114875555038452
Test Epoch1 threshold 0.5 Acc 0.9120065789473685, AUC 0.9796904921531677, avg_entr 0.02454763650894165
ep1_t0.5_test_time 0.07635211944580078
gc 0
Train Epoch2 Acc 0.9516833333333333 (114202/120000), AUC 0.9931793808937073
ep2_train_time 6.08397102355957
Test Epoch2 threshold 0.5 Acc 0.9100328947368421, AUC 0.9794178009033203, avg_entr 0.025100713595747948
ep2_t0.5_test_time 0.07337212562561035
gc 0
Train Epoch3 Acc 0.9527416666666667 (114329/120000), AUC 0.9933487176895142
ep3_train_time 6.094365358352661
Test Epoch3 threshold 0.5 Acc 0.9103618421052632, AUC 0.9792877435684204, avg_entr 0.025195585563778877
ep3_t0.5_test_time 0.07280969619750977
gc 0
Train Epoch4 Acc 0.9541083333333333 (114493/120000), AUC 0.9937142729759216
ep4_train_time 6.10780668258667
Test Epoch4 threshold 0.5 Acc 0.9111842105263158, AUC 0.9792448282241821, avg_entr 0.024781452491879463
ep4_t0.5_test_time 0.07352304458618164
gc 0
Train Epoch5 Acc 0.9563 (114756/120000), AUC 0.9945083856582642
ep5_train_time 6.107472896575928
Test Epoch5 threshold 0.5 Acc 0.9113486842105263, AUC 0.9792327284812927, avg_entr 0.02554081194102764
ep5_t0.5_test_time 0.07478857040405273
gc 0
Train Epoch6 Acc 0.9574 (114888/120000), AUC 0.9947673082351685
ep6_train_time 6.071571350097656
Test Epoch6 threshold 0.5 Acc 0.9090460526315789, AUC 0.978825032711029, avg_entr 0.025110716000199318
ep6_t0.5_test_time 0.07426714897155762
gc 0
Train Epoch7 Acc 0.9576916666666667 (114923/120000), AUC 0.994881272315979
ep7_train_time 6.159185886383057
Test Epoch7 threshold 0.5 Acc 0.9098684210526315, AUC 0.9787495732307434, avg_entr 0.02514985017478466
ep7_t0.5_test_time 0.07472014427185059
gc 0
Train Epoch8 Acc 0.9579666666666666 (114956/120000), AUC 0.9950124621391296
ep8_train_time 6.119629859924316
Test Epoch8 threshold 0.5 Acc 0.9097039473684211, AUC 0.9784989356994629, avg_entr 0.025227516889572144
ep8_t0.5_test_time 0.0734097957611084
gc 0
Train Epoch9 Acc 0.9595166666666667 (115142/120000), AUC 0.9954328536987305
ep9_train_time 6.171960115432739
Test Epoch9 threshold 0.5 Acc 0.9090460526315789, AUC 0.9783902168273926, avg_entr 0.025386858731508255
ep9_t0.5_test_time 0.07331728935241699
Best AUC 0.980222225189209
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.5_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9190789473684211, AUC 0.9851565361022949, avg_entr 0.02672509104013443
t0.5_test_time 0.019455432891845703
