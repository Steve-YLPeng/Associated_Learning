total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24005833333333335 (28807/120000), AUC 0.43184366822242737
ep0_train_time 5.893913507461548
Test Epoch0 threshold 0.8 Acc 0.9054276315789473, AUC 0.9765677452087402, avg_entr 0.16680538654327393
ep0_t0.8_test_time 0.13509130477905273
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.22239166666666665 (26687/120000), AUC 0.38358333706855774
ep1_train_time 5.428392171859741
Test Epoch1 threshold 0.8 Acc 0.9148026315789474, AUC 0.9794971346855164, avg_entr 0.10043283551931381
ep1_t0.8_test_time 0.13149094581604004
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.21013333333333334 (25216/120000), AUC 0.38148146867752075
ep2_train_time 5.400697231292725
Test Epoch2 threshold 0.8 Acc 0.9157894736842105, AUC 0.9807215929031372, avg_entr 0.08009641617536545
ep2_t0.8_test_time 0.13100981712341309
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.20224166666666665 (24269/120000), AUC 0.3817436695098877
ep3_train_time 5.437664747238159
Test Epoch3 threshold 0.8 Acc 0.9148026315789474, AUC 0.9804124236106873, avg_entr 0.06760762631893158
ep3_t0.8_test_time 0.13178515434265137
gc 0
Train Epoch4 Acc 0.1953 (23436/120000), AUC 0.38189852237701416
ep4_train_time 5.395748853683472
Test Epoch4 threshold 0.8 Acc 0.9171052631578948, AUC 0.9803217053413391, avg_entr 0.06027756258845329
ep4_t0.8_test_time 0.13661837577819824
gc 0
Train Epoch5 Acc 0.18895833333333334 (22675/120000), AUC 0.38214075565338135
ep5_train_time 5.399734735488892
Test Epoch5 threshold 0.8 Acc 0.9144736842105263, AUC 0.980209231376648, avg_entr 0.0551888532936573
ep5_t0.8_test_time 0.13144207000732422
gc 0
Train Epoch6 Acc 0.184075 (22089/120000), AUC 0.38215172290802
ep6_train_time 5.41185736656189
Test Epoch6 threshold 0.8 Acc 0.9141447368421053, AUC 0.9803348779678345, avg_entr 0.05071794241666794
ep6_t0.8_test_time 0.13593626022338867
gc 0
Train Epoch7 Acc 0.1809 (21708/120000), AUC 0.38186460733413696
ep7_train_time 5.439159870147705
Test Epoch7 threshold 0.8 Acc 0.9149671052631579, AUC 0.9801355004310608, avg_entr 0.04823719337582588
ep7_t0.8_test_time 0.13176584243774414
gc 0
Train Epoch8 Acc 0.179225 (21507/120000), AUC 0.3823844790458679
ep8_train_time 5.421602725982666
Test Epoch8 threshold 0.8 Acc 0.9144736842105263, AUC 0.9799394011497498, avg_entr 0.04631169140338898
ep8_t0.8_test_time 0.1316990852355957
gc 0
Train Epoch9 Acc 0.17846666666666666 (21416/120000), AUC 0.38279297947883606
ep9_train_time 5.479249477386475
Test Epoch9 threshold 0.8 Acc 0.9111842105263158, AUC 0.9797066450119019, avg_entr 0.04420338198542595
ep9_t0.8_test_time 0.1315150260925293
Best AUC 0.9807215929031372
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.8_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.925, AUC 0.9867084622383118, avg_entr 0.08354702591896057
t0.8_test_time 0.03380703926086426
