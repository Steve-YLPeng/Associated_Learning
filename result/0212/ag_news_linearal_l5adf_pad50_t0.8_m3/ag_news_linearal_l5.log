total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.8_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.20430833333333334 (24517/120000), AUC 0.4455309510231018
ep0_train_time 6.100828647613525
Test Epoch0 threshold 0.8 Acc 0.9144736842105263, AUC 0.9806010127067566, avg_entr 0.026530422270298004
ep0_t0.8_test_time 0.10483002662658691
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.8_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25483333333333336 (30580/120000), AUC 0.4857528805732727
ep1_train_time 5.681819677352905
Test Epoch1 threshold 0.8 Acc 0.9149671052631579, AUC 0.9805115461349487, avg_entr 0.025526558980345726
ep1_t0.8_test_time 0.10180497169494629
gc 0
Train Epoch2 Acc 0.3322333333333333 (39868/120000), AUC 0.5277045965194702
ep2_train_time 5.685155868530273
Test Epoch2 threshold 0.8 Acc 0.9138157894736842, AUC 0.9799429774284363, avg_entr 0.02561575546860695
ep2_t0.8_test_time 0.10091686248779297
gc 0
Train Epoch3 Acc 0.3995666666666667 (47948/120000), AUC 0.5525882840156555
ep3_train_time 5.731605052947998
Test Epoch3 threshold 0.8 Acc 0.912828947368421, AUC 0.9798651337623596, avg_entr 0.02488592080771923
ep3_t0.8_test_time 0.10225057601928711
gc 0
Train Epoch4 Acc 0.421475 (50577/120000), AUC 0.5782177448272705
ep4_train_time 5.7078166007995605
Test Epoch4 threshold 0.8 Acc 0.9110197368421052, AUC 0.9798098802566528, avg_entr 0.025871874764561653
ep4_t0.8_test_time 0.10210609436035156
gc 0
Train Epoch5 Acc 0.42073333333333335 (50488/120000), AUC 0.59742271900177
ep5_train_time 5.720212459564209
Test Epoch5 threshold 0.8 Acc 0.9115131578947369, AUC 0.9795514345169067, avg_entr 0.025782005861401558
ep5_t0.8_test_time 0.10415005683898926
gc 0
Train Epoch6 Acc 0.405625 (48675/120000), AUC 0.6063427925109863
ep6_train_time 5.676753282546997
Test Epoch6 threshold 0.8 Acc 0.9115131578947369, AUC 0.9793335199356079, avg_entr 0.026178352534770966
ep6_t0.8_test_time 0.10069751739501953
gc 0
Train Epoch7 Acc 0.3794 (45528/120000), AUC 0.6121823191642761
ep7_train_time 5.681150674819946
Test Epoch7 threshold 0.8 Acc 0.9105263157894737, AUC 0.9790650606155396, avg_entr 0.025410588830709457
ep7_t0.8_test_time 0.10141754150390625
gc 0
Train Epoch8 Acc 0.34578333333333333 (41494/120000), AUC 0.614177942276001
ep8_train_time 5.710930585861206
Test Epoch8 threshold 0.8 Acc 0.9108552631578948, AUC 0.9788851141929626, avg_entr 0.026333173736929893
ep8_t0.8_test_time 0.10257124900817871
gc 0
Train Epoch9 Acc 0.31985 (38382/120000), AUC 0.6135255694389343
ep9_train_time 5.679834604263306
Test Epoch9 threshold 0.8 Acc 0.9103618421052632, AUC 0.9788526296615601, avg_entr 0.025669870898127556
ep9_t0.8_test_time 0.1013803482055664
Best AUC 0.9806010127067566
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.8_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9243421052631579, AUC 0.9864877462387085, avg_entr 0.026481954380869865
t0.8_test_time 0.026511430740356445
