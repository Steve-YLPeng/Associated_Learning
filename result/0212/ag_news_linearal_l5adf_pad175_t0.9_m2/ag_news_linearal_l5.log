total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.9_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.16841666666666666 (20210/120000), AUC 0.5319192409515381
ep0_train_time 9.324869632720947
Test Epoch0 threshold 0.9 Acc 0.9180921052631579, AUC 0.9809309244155884, avg_entr 0.028629742562770844
ep0_t0.9_test_time 0.25090885162353516
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.07925833333333333 (9511/120000), AUC 0.4647214412689209
ep1_train_time 8.460641622543335
Test Epoch1 threshold 0.9 Acc 0.9169407894736842, AUC 0.9807196259498596, avg_entr 0.026953501626849174
ep1_t0.9_test_time 0.24863910675048828
gc 0
Train Epoch2 Acc 0.213525 (25623/120000), AUC 0.44496315717697144
ep2_train_time 8.681011199951172
Test Epoch2 threshold 0.9 Acc 0.9154605263157894, AUC 0.9807309508323669, avg_entr 0.027136031538248062
ep2_t0.9_test_time 0.24883723258972168
gc 0
Train Epoch3 Acc 0.245525 (29463/120000), AUC 0.4332900643348694
ep3_train_time 8.510270357131958
Test Epoch3 threshold 0.9 Acc 0.915296052631579, AUC 0.9807032346725464, avg_entr 0.02659018710255623
ep3_t0.9_test_time 0.24826884269714355
gc 0
Train Epoch4 Acc 0.24820833333333334 (29785/120000), AUC 0.4243376553058624
ep4_train_time 8.818728685379028
Test Epoch4 threshold 0.9 Acc 0.9149671052631579, AUC 0.9804235100746155, avg_entr 0.02602444961667061
ep4_t0.9_test_time 0.24831771850585938
gc 0
Train Epoch5 Acc 0.24875 (29850/120000), AUC 0.4176591634750366
ep5_train_time 8.570804357528687
Test Epoch5 threshold 0.9 Acc 0.9141447368421053, AUC 0.9804072380065918, avg_entr 0.02696695365011692
ep5_t0.9_test_time 0.24835515022277832
gc 0
Train Epoch6 Acc 0.24891666666666667 (29870/120000), AUC 0.4142685830593109
ep6_train_time 8.659573078155518
Test Epoch6 threshold 0.9 Acc 0.9151315789473684, AUC 0.980293869972229, avg_entr 0.025966811925172806
ep6_t0.9_test_time 0.2556149959564209
gc 0
Train Epoch7 Acc 0.24905 (29886/120000), AUC 0.4110059142112732
ep7_train_time 8.799776315689087
Test Epoch7 threshold 0.9 Acc 0.9146381578947368, AUC 0.9801758527755737, avg_entr 0.025958698242902756
ep7_t0.9_test_time 0.24824953079223633
gc 0
Train Epoch8 Acc 0.24911666666666665 (29894/120000), AUC 0.40795591473579407
ep8_train_time 8.5275239944458
Test Epoch8 threshold 0.9 Acc 0.9133223684210526, AUC 0.9800205826759338, avg_entr 0.025743359699845314
ep8_t0.9_test_time 0.2482912540435791
gc 0
Train Epoch9 Acc 0.24923333333333333 (29908/120000), AUC 0.40543821454048157
ep9_train_time 8.398921728134155
Test Epoch9 threshold 0.9 Acc 0.9134868421052632, AUC 0.9799773693084717, avg_entr 0.026509784162044525
ep9_t0.9_test_time 0.24830150604248047
Best AUC 0.9809309244155884
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.9_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9256578947368421, AUC 0.9864180088043213, avg_entr 0.02856406942009926
t0.9_test_time 0.06284165382385254
