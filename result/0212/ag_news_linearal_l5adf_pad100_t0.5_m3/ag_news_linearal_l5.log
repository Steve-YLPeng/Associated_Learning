total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.5_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.139825 (16779/120000), AUC 0.38968297839164734
ep0_train_time 7.607079982757568
Test Epoch0 threshold 0.5 Acc 0.9174342105263158, AUC 0.9807445406913757, avg_entr 0.026805290952324867
ep0_t0.5_test_time 0.1652684211730957
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.5_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.109925 (13191/120000), AUC 0.36709433794021606
ep1_train_time 7.2270824909210205
Test Epoch1 threshold 0.5 Acc 0.915625, AUC 0.980469286441803, avg_entr 0.02582935057580471
ep1_t0.5_test_time 0.1630110740661621
gc 0
Train Epoch2 Acc 0.11505 (13806/120000), AUC 0.3930656909942627
ep2_train_time 7.289236783981323
Test Epoch2 threshold 0.5 Acc 0.9144736842105263, AUC 0.9802911877632141, avg_entr 0.025754142552614212
ep2_t0.5_test_time 0.16558122634887695
gc 0
Train Epoch3 Acc 0.125425 (15051/120000), AUC 0.4383200407028198
ep3_train_time 7.333568811416626
Test Epoch3 threshold 0.5 Acc 0.9143092105263158, AUC 0.9801146984100342, avg_entr 0.02582521177828312
ep3_t0.5_test_time 0.16643762588500977
gc 0
Train Epoch4 Acc 0.12993333333333335 (15592/120000), AUC 0.4905630946159363
ep4_train_time 7.267030239105225
Test Epoch4 threshold 0.5 Acc 0.9121710526315789, AUC 0.9800660610198975, avg_entr 0.025963112711906433
ep4_t0.5_test_time 0.16403460502624512
gc 0
Train Epoch5 Acc 0.124 (14880/120000), AUC 0.519546389579773
ep5_train_time 7.25576639175415
Test Epoch5 threshold 0.5 Acc 0.9138157894736842, AUC 0.9799264669418335, avg_entr 0.02553529292345047
ep5_t0.5_test_time 0.16485309600830078
gc 0
Train Epoch6 Acc 0.118525 (14223/120000), AUC 0.5313289165496826
ep6_train_time 7.307466983795166
Test Epoch6 threshold 0.5 Acc 0.912828947368421, AUC 0.9796682596206665, avg_entr 0.025703055784106255
ep6_t0.5_test_time 0.16420722007751465
gc 0
Train Epoch7 Acc 0.108625 (13035/120000), AUC 0.5360842347145081
ep7_train_time 7.299715518951416
Test Epoch7 threshold 0.5 Acc 0.9125, AUC 0.9796220660209656, avg_entr 0.026106152683496475
ep7_t0.5_test_time 0.1732029914855957
gc 0
Train Epoch8 Acc 0.102575 (12309/120000), AUC 0.5362703204154968
ep8_train_time 7.248571395874023
Test Epoch8 threshold 0.5 Acc 0.9125, AUC 0.9794518351554871, avg_entr 0.026371782645583153
ep8_t0.5_test_time 0.16581273078918457
gc 0
Train Epoch9 Acc 0.09685833333333334 (11623/120000), AUC 0.5325437188148499
ep9_train_time 7.282779216766357
Test Epoch9 threshold 0.5 Acc 0.9108552631578948, AUC 0.9794080853462219, avg_entr 0.026626110076904297
ep9_t0.5_test_time 0.16437220573425293
Best AUC 0.9807445406913757
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.5_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9243421052631579, AUC 0.9862160086631775, avg_entr 0.027074242010712624
t0.5_test_time 0.0431513786315918
