total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2496 (29952/120000), AUC 0.5288552045822144
ep0_train_time 4.438252210617065
Test Epoch0 threshold 0.1 Acc 0.9116776315789473, AUC 0.9793556928634644, avg_entr 0.15121716260910034
ep0_t0.1_test_time 0.07585501670837402
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.24921666666666667 (29906/120000), AUC 0.5275459289550781
ep1_train_time 3.958580493927002
Test Epoch1 threshold 0.1 Acc 0.9131578947368421, AUC 0.980593204498291, avg_entr 0.09734798967838287
ep1_t0.1_test_time 0.07374906539916992
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.24928333333333333 (29914/120000), AUC 0.523082435131073
ep2_train_time 3.9724347591400146
Test Epoch2 threshold 0.1 Acc 0.9138157894736842, AUC 0.9806287884712219, avg_entr 0.07704348862171173
ep2_t0.1_test_time 0.07317161560058594
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.249375 (29925/120000), AUC 0.5199751257896423
ep3_train_time 3.9742093086242676
Test Epoch3 threshold 0.1 Acc 0.9121710526315789, AUC 0.9805988073348999, avg_entr 0.0659952163696289
ep3_t0.1_test_time 0.07355546951293945
gc 0
Train Epoch4 Acc 0.24930833333333333 (29917/120000), AUC 0.517316997051239
ep4_train_time 3.9516184329986572
Test Epoch4 threshold 0.1 Acc 0.9133223684210526, AUC 0.9801844954490662, avg_entr 0.05786355584859848
ep4_t0.1_test_time 0.07283711433410645
gc 0
Train Epoch5 Acc 0.24935833333333332 (29923/120000), AUC 0.5148413777351379
ep5_train_time 3.9379148483276367
Test Epoch5 threshold 0.1 Acc 0.9118421052631579, AUC 0.9803090691566467, avg_entr 0.053481392562389374
ep5_t0.1_test_time 0.0737752914428711
gc 0
Train Epoch6 Acc 0.24933333333333332 (29920/120000), AUC 0.5129200220108032
ep6_train_time 3.9943501949310303
Test Epoch6 threshold 0.1 Acc 0.9126644736842106, AUC 0.9800058603286743, avg_entr 0.05073242634534836
ep6_t0.1_test_time 0.07340574264526367
gc 0
Train Epoch7 Acc 0.249275 (29913/120000), AUC 0.5119802951812744
ep7_train_time 3.9889566898345947
Test Epoch7 threshold 0.1 Acc 0.912828947368421, AUC 0.9796460270881653, avg_entr 0.048721183091402054
ep7_t0.1_test_time 0.07262349128723145
gc 0
Train Epoch8 Acc 0.24933333333333332 (29920/120000), AUC 0.5110049247741699
ep8_train_time 3.97061824798584
Test Epoch8 threshold 0.1 Acc 0.912828947368421, AUC 0.9797551035881042, avg_entr 0.04644443094730377
ep8_t0.1_test_time 0.07346415519714355
gc 0
Train Epoch9 Acc 0.24929166666666666 (29915/120000), AUC 0.5097118616104126
ep9_train_time 3.9634768962860107
Test Epoch9 threshold 0.1 Acc 0.9108552631578948, AUC 0.9792577028274536, avg_entr 0.044377297163009644
ep9_t0.1_test_time 0.07372426986694336
Best AUC 0.9806287884712219
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.1_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9217105263157894, AUC 0.9854260683059692, avg_entr 0.08076394349336624
t0.1_test_time 0.019413232803344727
