total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.6_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.12754166666666666 (15305/120000), AUC 0.26234832406044006
ep0_train_time 7.4557647705078125
Test Epoch0 threshold 0.6 Acc 0.9161184210526315, AUC 0.9805240035057068, avg_entr 0.026209309697151184
ep0_t0.6_test_time 0.1706380844116211
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.6_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.13658333333333333 (16390/120000), AUC 0.21725964546203613
ep1_train_time 8.228999137878418
Test Epoch1 threshold 0.6 Acc 0.9172697368421052, AUC 0.9804848432540894, avg_entr 0.02561016008257866
ep1_t0.6_test_time 0.1748213768005371
gc 0
Train Epoch2 Acc 0.17370833333333333 (20845/120000), AUC 0.20741823315620422
ep2_train_time 7.374599933624268
Test Epoch2 threshold 0.6 Acc 0.9129934210526316, AUC 0.980465829372406, avg_entr 0.02514052204787731
ep2_t0.6_test_time 0.16087746620178223
gc 0
Train Epoch3 Acc 0.23690833333333333 (28429/120000), AUC 0.21165117621421814
ep3_train_time 6.864964723587036
Test Epoch3 threshold 0.6 Acc 0.9148026315789474, AUC 0.9802141785621643, avg_entr 0.026239603757858276
ep3_t0.6_test_time 0.161301851272583
gc 0
Train Epoch4 Acc 0.248875 (29865/120000), AUC 0.23100075125694275
ep4_train_time 6.882659196853638
Test Epoch4 threshold 0.6 Acc 0.9138157894736842, AUC 0.9799619913101196, avg_entr 0.026572516188025475
ep4_t0.6_test_time 0.1605069637298584
gc 0
Train Epoch5 Acc 0.249425 (29931/120000), AUC 0.2583027482032776
ep5_train_time 6.9711525440216064
Test Epoch5 threshold 0.6 Acc 0.9136513157894737, AUC 0.9798286557197571, avg_entr 0.025492634624242783
ep5_t0.6_test_time 0.16080474853515625
gc 0
Train Epoch6 Acc 0.24944166666666667 (29933/120000), AUC 0.282512903213501
ep6_train_time 6.927158355712891
Test Epoch6 threshold 0.6 Acc 0.9123355263157895, AUC 0.9796813130378723, avg_entr 0.026106126606464386
ep6_t0.6_test_time 0.16183114051818848
gc 0
Train Epoch7 Acc 0.24936666666666665 (29924/120000), AUC 0.3068475127220154
ep7_train_time 7.001726865768433
Test Epoch7 threshold 0.6 Acc 0.9138157894736842, AUC 0.9795808792114258, avg_entr 0.026306942105293274
ep7_t0.6_test_time 0.1621994972229004
gc 0
Train Epoch8 Acc 0.24935 (29922/120000), AUC 0.33239662647247314
ep8_train_time 6.954468488693237
Test Epoch8 threshold 0.6 Acc 0.912828947368421, AUC 0.9795403480529785, avg_entr 0.02562505006790161
ep8_t0.6_test_time 0.17602324485778809
gc 0
Train Epoch9 Acc 0.24950833333333333 (29941/120000), AUC 0.3505687713623047
ep9_train_time 8.171457052230835
Test Epoch9 threshold 0.6 Acc 0.9116776315789473, AUC 0.9793449640274048, avg_entr 0.02599947899580002
ep9_t0.6_test_time 0.16771745681762695
Best AUC 0.9805240035057068
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.6_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9256578947368421, AUC 0.9863978028297424, avg_entr 0.02492937259376049
t0.6_test_time 0.04647946357727051
