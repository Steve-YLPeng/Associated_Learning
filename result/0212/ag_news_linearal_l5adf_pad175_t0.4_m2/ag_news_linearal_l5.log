total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.5753927826881409
ep0_train_time 9.006951808929443
Test Epoch0 threshold 0.4 Acc 0.9164473684210527, AUC 0.9810923933982849, avg_entr 0.028247958049178123
ep0_t0.4_test_time 0.26375555992126465
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.249975 (29997/120000), AUC 0.5675814151763916
ep1_train_time 8.756686210632324
Test Epoch1 threshold 0.4 Acc 0.9169407894736842, AUC 0.9810271859169006, avg_entr 0.02652791701257229
ep1_t0.4_test_time 0.26192164421081543
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.5681580901145935
ep2_train_time 8.753165483474731
Test Epoch2 threshold 0.4 Acc 0.9167763157894737, AUC 0.9807049036026001, avg_entr 0.026477647945284843
ep2_t0.4_test_time 0.2605130672454834
gc 0
Train Epoch3 Acc 0.25000833333333333 (30001/120000), AUC 0.5662540197372437
ep3_train_time 8.82987117767334
Test Epoch3 threshold 0.4 Acc 0.9138157894736842, AUC 0.980636715888977, avg_entr 0.0258445143699646
ep3_t0.4_test_time 0.2615931034088135
gc 0
Train Epoch4 Acc 0.25001666666666666 (30002/120000), AUC 0.5650006532669067
ep4_train_time 8.557613372802734
Test Epoch4 threshold 0.4 Acc 0.9141447368421053, AUC 0.9804980754852295, avg_entr 0.026276400312781334
ep4_t0.4_test_time 0.26041316986083984
gc 0
Train Epoch5 Acc 0.250025 (30003/120000), AUC 0.5652546882629395
ep5_train_time 8.65508222579956
Test Epoch5 threshold 0.4 Acc 0.915296052631579, AUC 0.9803569316864014, avg_entr 0.02568804658949375
ep5_t0.4_test_time 0.26165127754211426
gc 0
Train Epoch6 Acc 0.25000833333333333 (30001/120000), AUC 0.564841091632843
ep6_train_time 8.565462589263916
Test Epoch6 threshold 0.4 Acc 0.9149671052631579, AUC 0.980320394039154, avg_entr 0.02638225071132183
ep6_t0.4_test_time 0.2613046169281006
gc 0
Train Epoch7 Acc 0.25001666666666666 (30002/120000), AUC 0.5646085739135742
ep7_train_time 8.680583715438843
Test Epoch7 threshold 0.4 Acc 0.9138157894736842, AUC 0.9802134037017822, avg_entr 0.025873055681586266
ep7_t0.4_test_time 0.2611820697784424
gc 0
Train Epoch8 Acc 0.2500583333333333 (30007/120000), AUC 0.5651946067810059
ep8_train_time 8.901029109954834
Test Epoch8 threshold 0.4 Acc 0.9141447368421053, AUC 0.9801664352416992, avg_entr 0.026680702343583107
ep8_t0.4_test_time 0.2607262134552002
gc 0
Train Epoch9 Acc 0.25006666666666666 (30008/120000), AUC 0.5670688152313232
ep9_train_time 8.730664014816284
Test Epoch9 threshold 0.4 Acc 0.9144736842105263, AUC 0.9800720810890198, avg_entr 0.02579386904835701
ep9_t0.4_test_time 0.2604329586029053
Best AUC 0.9810923933982849
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9269736842105263, AUC 0.9870544075965881, avg_entr 0.027793066576123238
t0.4_test_time 0.06650137901306152
