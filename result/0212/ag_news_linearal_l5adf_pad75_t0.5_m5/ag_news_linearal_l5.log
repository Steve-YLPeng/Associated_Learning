total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.5_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9161166666666667 (109934/120000), AUC 0.9848172664642334
ep0_train_time 8.108580350875854
Test Epoch0 threshold 0.5 Acc 0.9144736842105263, AUC 0.9803909063339233, avg_entr 0.025473544374108315
ep0_t0.5_test_time 0.13666987419128418
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.5_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9494 (113928/120000), AUC 0.9930315017700195
ep1_train_time 7.675977945327759
Test Epoch1 threshold 0.5 Acc 0.9143092105263158, AUC 0.9801931381225586, avg_entr 0.02572924643754959
ep1_t0.5_test_time 0.13513612747192383
gc 0
Train Epoch2 Acc 0.9507333333333333 (114088/120000), AUC 0.9934923648834229
ep2_train_time 7.340646982192993
Test Epoch2 threshold 0.5 Acc 0.9143092105263158, AUC 0.979921817779541, avg_entr 0.02525944635272026
ep2_t0.5_test_time 0.12911748886108398
gc 0
Train Epoch3 Acc 0.9522166666666667 (114266/120000), AUC 0.9935687780380249
ep3_train_time 7.318044424057007
Test Epoch3 threshold 0.5 Acc 0.9146381578947368, AUC 0.9797825813293457, avg_entr 0.025706300511956215
ep3_t0.5_test_time 0.13032793998718262
gc 0
Train Epoch4 Acc 0.9536583333333334 (114439/120000), AUC 0.9939044713973999
ep4_train_time 7.284130334854126
Test Epoch4 threshold 0.5 Acc 0.9108552631578948, AUC 0.9796486496925354, avg_entr 0.026220077648758888
ep4_t0.5_test_time 0.1291966438293457
gc 0
Train Epoch5 Acc 0.9556833333333333 (114682/120000), AUC 0.9946093559265137
ep5_train_time 7.309574127197266
Test Epoch5 threshold 0.5 Acc 0.9126644736842106, AUC 0.9793679714202881, avg_entr 0.026038112118840218
ep5_t0.5_test_time 0.12984919548034668
gc 0
Train Epoch6 Acc 0.9558916666666667 (114707/120000), AUC 0.9947556853294373
ep6_train_time 7.245825529098511
Test Epoch6 threshold 0.5 Acc 0.9116776315789473, AUC 0.9793127775192261, avg_entr 0.02635561302304268
ep6_t0.5_test_time 0.130218505859375
gc 0
Train Epoch7 Acc 0.9569583333333334 (114835/120000), AUC 0.994910717010498
ep7_train_time 7.30366849899292
Test Epoch7 threshold 0.5 Acc 0.9120065789473685, AUC 0.97922682762146, avg_entr 0.02670515887439251
ep7_t0.5_test_time 0.1354362964630127
gc 0
Train Epoch8 Acc 0.9572416666666667 (114869/120000), AUC 0.9951033592224121
ep8_train_time 7.710622787475586
Test Epoch8 threshold 0.5 Acc 0.9115131578947369, AUC 0.9791296720504761, avg_entr 0.025816095992922783
ep8_t0.5_test_time 0.13376688957214355
gc 0
Train Epoch9 Acc 0.9586416666666666 (115037/120000), AUC 0.9954529404640198
ep9_train_time 7.6251256465911865
Test Epoch9 threshold 0.5 Acc 0.9103618421052632, AUC 0.9789454340934753, avg_entr 0.02630041539669037
ep9_t0.5_test_time 0.13014817237854004
Best AUC 0.9803909063339233
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.5_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9243421052631579, AUC 0.9858163595199585, avg_entr 0.02469611167907715
t0.5_test_time 0.033976078033447266
