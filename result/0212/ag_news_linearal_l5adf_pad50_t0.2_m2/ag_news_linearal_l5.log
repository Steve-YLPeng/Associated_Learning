total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.2_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.33881666666666665 (40658/120000), AUC 0.6087216138839722
ep0_train_time 5.6529505252838135
Test Epoch0 threshold 0.2 Acc 0.9159539473684211, AUC 0.9804760217666626, avg_entr 0.03001210279762745
ep0_t0.2_test_time 0.11098217964172363
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.2_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3232583333333333 (38791/120000), AUC 0.613003134727478
ep1_train_time 5.20025634765625
Test Epoch1 threshold 0.2 Acc 0.9141447368421053, AUC 0.9800223112106323, avg_entr 0.028259413316845894
ep1_t0.2_test_time 0.10891532897949219
gc 0
Train Epoch2 Acc 0.31769166666666665 (38123/120000), AUC 0.6122580170631409
ep2_train_time 5.177722454071045
Test Epoch2 threshold 0.2 Acc 0.9154605263157894, AUC 0.9801084995269775, avg_entr 0.026999300345778465
ep2_t0.2_test_time 0.11040997505187988
gc 0
Train Epoch3 Acc 0.32000833333333334 (38401/120000), AUC 0.6158901453018188
ep3_train_time 5.139123439788818
Test Epoch3 threshold 0.2 Acc 0.9121710526315789, AUC 0.9798870086669922, avg_entr 0.02664271369576454
ep3_t0.2_test_time 0.10785245895385742
gc 0
Train Epoch4 Acc 0.32556666666666667 (39068/120000), AUC 0.6230396032333374
ep4_train_time 5.0680224895477295
Test Epoch4 threshold 0.2 Acc 0.9098684210526315, AUC 0.9793596267700195, avg_entr 0.026609506458044052
ep4_t0.2_test_time 0.10861563682556152
gc 0
Train Epoch5 Acc 0.32936666666666664 (39524/120000), AUC 0.6293368935585022
ep5_train_time 5.082897901535034
Test Epoch5 threshold 0.2 Acc 0.9116776315789473, AUC 0.9795217514038086, avg_entr 0.02625705488026142
ep5_t0.2_test_time 0.1085050106048584
gc 0
Train Epoch6 Acc 0.33455 (40146/120000), AUC 0.6344802379608154
ep6_train_time 5.179466962814331
Test Epoch6 threshold 0.2 Acc 0.9125, AUC 0.9794657230377197, avg_entr 0.02605215646326542
ep6_t0.2_test_time 0.11222958564758301
gc 0
Train Epoch7 Acc 0.339125 (40695/120000), AUC 0.6394117474555969
ep7_train_time 5.1937713623046875
Test Epoch7 threshold 0.2 Acc 0.9101973684210526, AUC 0.9791507720947266, avg_entr 0.026182129979133606
ep7_t0.2_test_time 0.1098020076751709
gc 0
Train Epoch8 Acc 0.3438333333333333 (41260/120000), AUC 0.6446744799613953
ep8_train_time 5.182307243347168
Test Epoch8 threshold 0.2 Acc 0.909375, AUC 0.9790214896202087, avg_entr 0.025647994130849838
ep8_t0.2_test_time 0.10940313339233398
gc 0
Train Epoch9 Acc 0.3477 (41724/120000), AUC 0.6489005088806152
ep9_train_time 5.2716662883758545
Test Epoch9 threshold 0.2 Acc 0.9087171052631579, AUC 0.9787369966506958, avg_entr 0.02594851888716221
ep9_t0.2_test_time 0.10984277725219727
Best AUC 0.9804760217666626
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.2_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9256578947368421, AUC 0.9859628677368164, avg_entr 0.02984236180782318
t0.2_test_time 0.028409481048583984
