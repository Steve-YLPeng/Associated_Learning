total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.4_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.3467166666666667 (41606/120000), AUC 0.3247738480567932
ep0_train_time 6.388519525527954
Test Epoch0 threshold 0.4 Acc 0.915296052631579, AUC 0.980481743812561, avg_entr 0.025683091953396797
ep0_t0.4_test_time 0.11205649375915527
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.4_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.31711666666666666 (38054/120000), AUC 0.26530417799949646
ep1_train_time 5.814344167709351
Test Epoch1 threshold 0.4 Acc 0.9144736842105263, AUC 0.980162501335144, avg_entr 0.02553556300699711
ep1_t0.4_test_time 0.10614943504333496
gc 0
Train Epoch2 Acc 0.2375 (28500/120000), AUC 0.21773692965507507
ep2_train_time 5.52461576461792
Test Epoch2 threshold 0.4 Acc 0.9131578947368421, AUC 0.9802430868148804, avg_entr 0.02558938041329384
ep2_t0.4_test_time 0.1058509349822998
gc 0
Train Epoch3 Acc 0.143875 (17265/120000), AUC 0.19059520959854126
ep3_train_time 5.567397117614746
Test Epoch3 threshold 0.4 Acc 0.9121710526315789, AUC 0.9797733426094055, avg_entr 0.025638319551944733
ep3_t0.4_test_time 0.10400152206420898
gc 0
Train Epoch4 Acc 0.063475 (7617/120000), AUC 0.18764038383960724
ep4_train_time 5.538116455078125
Test Epoch4 threshold 0.4 Acc 0.9121710526315789, AUC 0.9795854091644287, avg_entr 0.02509162761271
ep4_t0.4_test_time 0.105072021484375
gc 0
Train Epoch5 Acc 0.03415 (4098/120000), AUC 0.1888435184955597
ep5_train_time 5.5605549812316895
Test Epoch5 threshold 0.4 Acc 0.9106907894736842, AUC 0.9794566035270691, avg_entr 0.025560639798641205
ep5_t0.4_test_time 0.10539865493774414
gc 0
Train Epoch6 Acc 0.023158333333333333 (2779/120000), AUC 0.19088077545166016
ep6_train_time 5.556921482086182
Test Epoch6 threshold 0.4 Acc 0.9113486842105263, AUC 0.9793457984924316, avg_entr 0.025285901501774788
ep6_t0.4_test_time 0.10476517677307129
gc 0
Train Epoch7 Acc 0.014816666666666667 (1778/120000), AUC 0.1911856234073639
ep7_train_time 5.651196241378784
Test Epoch7 threshold 0.4 Acc 0.9106907894736842, AUC 0.9792873859405518, avg_entr 0.026016201823949814
ep7_t0.4_test_time 0.10655069351196289
gc 0
Train Epoch8 Acc 0.009975 (1197/120000), AUC 0.18988154828548431
ep8_train_time 5.933803558349609
Test Epoch8 threshold 0.4 Acc 0.9118421052631579, AUC 0.9789222478866577, avg_entr 0.026194032281637192
ep8_t0.4_test_time 0.10830998420715332
gc 0
Train Epoch9 Acc 0.007808333333333333 (937/120000), AUC 0.18887260556221008
ep9_train_time 5.897822141647339
Test Epoch9 threshold 0.4 Acc 0.9111842105263158, AUC 0.9789941310882568, avg_entr 0.02584187313914299
ep9_t0.4_test_time 0.10864543914794922
Best AUC 0.980481743812561
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.4_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9282894736842106, AUC 0.9859263896942139, avg_entr 0.02483988367021084
t0.4_test_time 0.0279998779296875
