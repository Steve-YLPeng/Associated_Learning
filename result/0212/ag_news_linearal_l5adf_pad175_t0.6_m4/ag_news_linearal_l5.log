total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.28631666666666666 (34358/120000), AUC 0.5912961363792419
ep0_train_time 10.04478669166565
Test Epoch0 threshold 0.6 Acc 0.9157894736842105, AUC 0.9803732633590698, avg_entr 0.02537016198039055
ep0_t0.6_test_time 0.2545490264892578
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.336725 (40407/120000), AUC 0.6752004623413086
ep1_train_time 9.659054517745972
Test Epoch1 threshold 0.6 Acc 0.9136513157894737, AUC 0.9803869128227234, avg_entr 0.024977078661322594
ep1_t0.6_test_time 0.25360560417175293
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.35045 (42054/120000), AUC 0.7784309983253479
ep2_train_time 9.480114459991455
Test Epoch2 threshold 0.6 Acc 0.9148026315789474, AUC 0.9803236722946167, avg_entr 0.025708068162202835
ep2_t0.6_test_time 0.25364136695861816
gc 0
Train Epoch3 Acc 0.5199333333333334 (62392/120000), AUC 0.7945170998573303
ep3_train_time 9.459199666976929
Test Epoch3 threshold 0.6 Acc 0.9134868421052632, AUC 0.9800459146499634, avg_entr 0.02531789056956768
ep3_t0.6_test_time 0.254108190536499
gc 0
Train Epoch4 Acc 0.5903083333333333 (70837/120000), AUC 0.7264348864555359
ep4_train_time 9.485899448394775
Test Epoch4 threshold 0.6 Acc 0.9134868421052632, AUC 0.9799987077713013, avg_entr 0.024995729327201843
ep4_t0.6_test_time 0.25373029708862305
gc 0
Train Epoch5 Acc 0.6002666666666666 (72032/120000), AUC 0.6945116519927979
ep5_train_time 9.50027585029602
Test Epoch5 threshold 0.6 Acc 0.9134868421052632, AUC 0.9798925518989563, avg_entr 0.025671111419796944
ep5_t0.6_test_time 0.2532341480255127
gc 0
Train Epoch6 Acc 0.59345 (71214/120000), AUC 0.6822638511657715
ep6_train_time 9.556493759155273
Test Epoch6 threshold 0.6 Acc 0.9134868421052632, AUC 0.9798082709312439, avg_entr 0.026193054392933846
ep6_t0.6_test_time 0.252910852432251
gc 0
Train Epoch7 Acc 0.573325 (68799/120000), AUC 0.6752461194992065
ep7_train_time 9.723883152008057
Test Epoch7 threshold 0.6 Acc 0.912828947368421, AUC 0.9797030687332153, avg_entr 0.02511972188949585
ep7_t0.6_test_time 0.2632126808166504
gc 0
Train Epoch8 Acc 0.5393583333333334 (64723/120000), AUC 0.6712408661842346
ep8_train_time 9.722291231155396
Test Epoch8 threshold 0.6 Acc 0.9123355263157895, AUC 0.9796205163002014, avg_entr 0.025211235508322716
ep8_t0.6_test_time 0.2570531368255615
gc 0
Train Epoch9 Acc 0.5128833333333334 (61546/120000), AUC 0.6690084338188171
ep9_train_time 9.50528597831726
Test Epoch9 threshold 0.6 Acc 0.9118421052631579, AUC 0.9795452356338501, avg_entr 0.02488878183066845
ep9_t0.6_test_time 0.25165796279907227
Best AUC 0.9803869128227234
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9236842105263158, AUC 0.9857550859451294, avg_entr 0.02484477125108242
t0.6_test_time 0.06396174430847168
