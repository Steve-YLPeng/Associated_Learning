total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24996666666666667 (29996/120000), AUC 0.5371403694152832
ep0_train_time 4.96863317489624
Test Epoch0 threshold 0.6 Acc 0.9123355263157895, AUC 0.9778193235397339, avg_entr 0.1608833521604538
ep0_t0.6_test_time 0.10441899299621582
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.5527645945549011
ep1_train_time 4.539937734603882
Test Epoch1 threshold 0.6 Acc 0.9159539473684211, AUC 0.9798362851142883, avg_entr 0.09912687540054321
ep1_t0.6_test_time 0.10157132148742676
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.5524384379386902
ep2_train_time 4.498976945877075
Test Epoch2 threshold 0.6 Acc 0.9159539473684211, AUC 0.9804620742797852, avg_entr 0.0800500363111496
ep2_t0.6_test_time 0.1017763614654541
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5518551468849182
ep3_train_time 4.5229175090789795
Test Epoch3 threshold 0.6 Acc 0.9167763157894737, AUC 0.9803891777992249, avg_entr 0.06694478541612625
ep3_t0.6_test_time 0.10170960426330566
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.5517112016677856
ep4_train_time 4.489239931106567
Test Epoch4 threshold 0.6 Acc 0.915296052631579, AUC 0.9805773496627808, avg_entr 0.06023808941245079
ep4_t0.6_test_time 0.10126495361328125
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.5514116287231445
ep5_train_time 4.656883478164673
Test Epoch5 threshold 0.6 Acc 0.9148026315789474, AUC 0.9802033305168152, avg_entr 0.05456167459487915
ep5_t0.6_test_time 0.10160255432128906
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.5512324571609497
ep6_train_time 4.567751407623291
Test Epoch6 threshold 0.6 Acc 0.9113486842105263, AUC 0.9794954061508179, avg_entr 0.05225009098649025
ep6_t0.6_test_time 0.10187625885009766
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.5509967803955078
ep7_train_time 4.535157918930054
Test Epoch7 threshold 0.6 Acc 0.9121710526315789, AUC 0.979656994342804, avg_entr 0.048101574182510376
ep7_t0.6_test_time 0.10213661193847656
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.5506798028945923
ep8_train_time 4.564827919006348
Test Epoch8 threshold 0.6 Acc 0.9100328947368421, AUC 0.9792565107345581, avg_entr 0.045501839369535446
ep8_t0.6_test_time 0.1051936149597168
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.5504595041275024
ep9_train_time 4.79675030708313
Test Epoch9 threshold 0.6 Acc 0.9118421052631579, AUC 0.979277491569519, avg_entr 0.043126679956912994
ep9_t0.6_test_time 0.10492253303527832
Best AUC 0.9805773496627808
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.6_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9243421052631579, AUC 0.9857352375984192, avg_entr 0.06252036988735199
t0.6_test_time 0.027168989181518555
