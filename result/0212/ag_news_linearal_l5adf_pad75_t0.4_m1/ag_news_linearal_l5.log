total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.28068333333333334 (33682/120000), AUC 0.5038105249404907
ep0_train_time 5.725179195404053
Test Epoch0 threshold 0.4 Acc 0.9088815789473684, AUC 0.9760514497756958, avg_entr 0.16235283017158508
ep0_t0.4_test_time 0.13236427307128906
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2728333333333333 (32740/120000), AUC 0.511121392250061
ep1_train_time 5.171879291534424
Test Epoch1 threshold 0.4 Acc 0.9148026315789474, AUC 0.9793099164962769, avg_entr 0.09910973161458969
ep1_t0.4_test_time 0.1303563117980957
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25904166666666667 (31085/120000), AUC 0.5098429918289185
ep2_train_time 5.271838903427124
Test Epoch2 threshold 0.4 Acc 0.9167763157894737, AUC 0.9800720810890198, avg_entr 0.07594048231840134
ep2_t0.4_test_time 0.13023090362548828
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.252275 (30273/120000), AUC 0.5077837109565735
ep3_train_time 5.186545372009277
Test Epoch3 threshold 0.4 Acc 0.9167763157894737, AUC 0.9804582595825195, avg_entr 0.06574008613824844
ep3_t0.4_test_time 0.13158631324768066
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.24853333333333333 (29824/120000), AUC 0.5059282183647156
ep4_train_time 5.188765048980713
Test Epoch4 threshold 0.4 Acc 0.9167763157894737, AUC 0.980664849281311, avg_entr 0.061259400099515915
ep4_t0.4_test_time 0.1307227611541748
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.24715833333333334 (29659/120000), AUC 0.5039114952087402
ep5_train_time 5.146106958389282
Test Epoch5 threshold 0.4 Acc 0.9146381578947368, AUC 0.9801791906356812, avg_entr 0.05443483218550682
ep5_t0.4_test_time 0.1304490566253662
gc 0
Train Epoch6 Acc 0.24678333333333333 (29614/120000), AUC 0.502169668674469
ep6_train_time 5.1403257846832275
Test Epoch6 threshold 0.4 Acc 0.915296052631579, AUC 0.9801269173622131, avg_entr 0.04901505634188652
ep6_t0.4_test_time 0.131239652633667
gc 0
Train Epoch7 Acc 0.24705833333333332 (29647/120000), AUC 0.500878095626831
ep7_train_time 5.199894905090332
Test Epoch7 threshold 0.4 Acc 0.9149671052631579, AUC 0.9800065159797668, avg_entr 0.046281833201646805
ep7_t0.4_test_time 0.13029956817626953
gc 0
Train Epoch8 Acc 0.24753333333333333 (29704/120000), AUC 0.4998023509979248
ep8_train_time 5.238559007644653
Test Epoch8 threshold 0.4 Acc 0.915625, AUC 0.9796884059906006, avg_entr 0.04352172464132309
ep8_t0.4_test_time 0.13449525833129883
gc 0
Train Epoch9 Acc 0.24775 (29730/120000), AUC 0.4987374544143677
ep9_train_time 5.46447229385376
Test Epoch9 threshold 0.4 Acc 0.9123355263157895, AUC 0.9796410799026489, avg_entr 0.04274863377213478
ep9_t0.4_test_time 0.13562965393066406
Best AUC 0.980664849281311
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.4_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9263157894736842, AUC 0.9861882925033569, avg_entr 0.06379317492246628
t0.4_test_time 0.03474235534667969
