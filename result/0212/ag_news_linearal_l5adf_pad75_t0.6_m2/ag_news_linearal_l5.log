total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.6_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.234975 (28197/120000), AUC 0.5252455472946167
ep0_train_time 6.410688638687134
Test Epoch0 threshold 0.6 Acc 0.9171052631578948, AUC 0.9808689951896667, avg_entr 0.030760563910007477
ep0_t0.6_test_time 0.13462305068969727
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.6_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.21743333333333334 (26092/120000), AUC 0.5618339776992798
ep1_train_time 5.909344673156738
Test Epoch1 threshold 0.6 Acc 0.915625, AUC 0.9808343648910522, avg_entr 0.028044775128364563
ep1_t0.6_test_time 0.13243722915649414
gc 0
Train Epoch2 Acc 0.21545 (25854/120000), AUC 0.5722695589065552
ep2_train_time 5.938255548477173
Test Epoch2 threshold 0.6 Acc 0.9149671052631579, AUC 0.9803696870803833, avg_entr 0.0273188017308712
ep2_t0.6_test_time 0.13671326637268066
gc 0
Train Epoch3 Acc 0.20788333333333334 (24946/120000), AUC 0.5787198543548584
ep3_train_time 5.910648345947266
Test Epoch3 threshold 0.6 Acc 0.9131578947368421, AUC 0.9803469181060791, avg_entr 0.02671598643064499
ep3_t0.6_test_time 0.1334819793701172
gc 0
Train Epoch4 Acc 0.19524166666666667 (23429/120000), AUC 0.5837913751602173
ep4_train_time 5.927678346633911
Test Epoch4 threshold 0.6 Acc 0.9143092105263158, AUC 0.9799044132232666, avg_entr 0.02655421569943428
ep4_t0.6_test_time 0.13352227210998535
gc 0
Train Epoch5 Acc 0.18715 (22458/120000), AUC 0.5869231820106506
ep5_train_time 5.915158033370972
Test Epoch5 threshold 0.6 Acc 0.9139802631578947, AUC 0.9799473881721497, avg_entr 0.026058392599225044
ep5_t0.6_test_time 0.13275599479675293
gc 0
Train Epoch6 Acc 0.18259166666666668 (21911/120000), AUC 0.5892332792282104
ep6_train_time 5.9441187381744385
Test Epoch6 threshold 0.6 Acc 0.9121710526315789, AUC 0.9796786904335022, avg_entr 0.026729539036750793
ep6_t0.6_test_time 0.13257765769958496
gc 0
Train Epoch7 Acc 0.17799166666666666 (21359/120000), AUC 0.5915190577507019
ep7_train_time 5.937544107437134
Test Epoch7 threshold 0.6 Acc 0.9120065789473685, AUC 0.979698896408081, avg_entr 0.026192739605903625
ep7_t0.6_test_time 0.13351917266845703
gc 0
Train Epoch8 Acc 0.172725 (20727/120000), AUC 0.5934574007987976
ep8_train_time 5.957976579666138
Test Epoch8 threshold 0.6 Acc 0.9120065789473685, AUC 0.9796736240386963, avg_entr 0.026141613721847534
ep8_t0.6_test_time 0.13390541076660156
gc 0
Train Epoch9 Acc 0.16943333333333332 (20332/120000), AUC 0.5948563814163208
ep9_train_time 5.944169998168945
Test Epoch9 threshold 0.6 Acc 0.9118421052631579, AUC 0.9794773459434509, avg_entr 0.026741867884993553
ep9_t0.6_test_time 0.13361549377441406
Best AUC 0.9808689951896667
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.6_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9243421052631579, AUC 0.9863348007202148, avg_entr 0.031135229393839836
t0.6_test_time 0.03423762321472168
