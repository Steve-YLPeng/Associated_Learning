total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.8_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.318925 (38271/120000), AUC 0.6191454529762268
ep0_train_time 5.361196756362915
Test Epoch0 threshold 0.8 Acc 0.9143092105263158, AUC 0.9803309440612793, avg_entr 0.025883344933390617
ep0_t0.8_test_time 0.0727083683013916
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.8_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.28831666666666667 (34598/120000), AUC 0.6403607130050659
ep1_train_time 4.895627737045288
Test Epoch1 threshold 0.8 Acc 0.9131578947368421, AUC 0.9802519083023071, avg_entr 0.025959713384509087
ep1_t0.8_test_time 0.07076501846313477
gc 0
Train Epoch2 Acc 0.2549 (30588/120000), AUC 0.6124640703201294
ep2_train_time 4.853561878204346
Test Epoch2 threshold 0.8 Acc 0.912828947368421, AUC 0.9798625707626343, avg_entr 0.026064693927764893
ep2_t0.8_test_time 0.07115674018859863
gc 0
Train Epoch3 Acc 0.25305833333333333 (30367/120000), AUC 0.5471735596656799
ep3_train_time 4.894937515258789
Test Epoch3 threshold 0.8 Acc 0.9126644736842106, AUC 0.9798785448074341, avg_entr 0.025313304737210274
ep3_t0.8_test_time 0.07065343856811523
gc 0
Train Epoch4 Acc 0.25395833333333334 (30475/120000), AUC 0.4974430501461029
ep4_train_time 4.873391628265381
Test Epoch4 threshold 0.8 Acc 0.9106907894736842, AUC 0.9794570207595825, avg_entr 0.02496081218123436
ep4_t0.8_test_time 0.07081818580627441
gc 0
Train Epoch5 Acc 0.25403333333333333 (30484/120000), AUC 0.4859907031059265
ep5_train_time 4.910874366760254
Test Epoch5 threshold 0.8 Acc 0.9097039473684211, AUC 0.9794202446937561, avg_entr 0.02560323476791382
ep5_t0.8_test_time 0.07080674171447754
gc 0
Train Epoch6 Acc 0.25388333333333335 (30466/120000), AUC 0.4859136641025543
ep6_train_time 4.878992319107056
Test Epoch6 threshold 0.8 Acc 0.9111842105263158, AUC 0.9791772365570068, avg_entr 0.02564474381506443
ep6_t0.8_test_time 0.07103347778320312
gc 0
Train Epoch7 Acc 0.25365 (30438/120000), AUC 0.4848393499851227
ep7_train_time 4.8546669483184814
Test Epoch7 threshold 0.8 Acc 0.9083881578947368, AUC 0.978958249092102, avg_entr 0.025191597640514374
ep7_t0.8_test_time 0.07096123695373535
gc 0
Train Epoch8 Acc 0.253475 (30417/120000), AUC 0.48317259550094604
ep8_train_time 4.87364387512207
Test Epoch8 threshold 0.8 Acc 0.9097039473684211, AUC 0.9787406921386719, avg_entr 0.02572738751769066
ep8_t0.8_test_time 0.07071900367736816
gc 0
Train Epoch9 Acc 0.2533 (30396/120000), AUC 0.4821416437625885
ep9_train_time 5.092545509338379
Test Epoch9 threshold 0.8 Acc 0.909375, AUC 0.9786922931671143, avg_entr 0.025695007294416428
ep9_t0.8_test_time 0.07407641410827637
Best AUC 0.9803309440612793
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.8_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9243421052631579, AUC 0.9854395985603333, avg_entr 0.02731904573738575
t0.8_test_time 0.019334793090820312
