total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad25_t0.3_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.030241666666666667 (3629/120000), AUC 0.33379900455474854
ep0_train_time 14.782040357589722
Test Epoch0 threshold 0.3 Acc 0.9144736842105263, AUC 0.9809602499008179, avg_entr 0.022875843569636345
ep0_t0.3_test_time 0.11008358001708984
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad25_t0.3_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.0252 (3024/120000), AUC 0.3486221134662628
ep1_train_time 14.53878927230835
Test Epoch1 threshold 0.3 Acc 0.9157894736842105, AUC 0.9804933667182922, avg_entr 0.02208082005381584
ep1_t0.3_test_time 0.09663176536560059
gc 0
Train Epoch2 Acc 0.0261 (3132/120000), AUC 0.36599698662757874
ep2_train_time 14.5712149143219
Test Epoch2 threshold 0.3 Acc 0.9129934210526316, AUC 0.9802519679069519, avg_entr 0.02265508472919464
ep2_t0.3_test_time 0.09935712814331055
gc 0
Train Epoch3 Acc 0.025891666666666667 (3107/120000), AUC 0.37613892555236816
ep3_train_time 14.074077606201172
Test Epoch3 threshold 0.3 Acc 0.9115131578947369, AUC 0.9798488020896912, avg_entr 0.022515634074807167
ep3_t0.3_test_time 0.09876704216003418
gc 0
Train Epoch4 Acc 0.024975 (2997/120000), AUC 0.38393735885620117
ep4_train_time 14.238619804382324
Test Epoch4 threshold 0.3 Acc 0.9115131578947369, AUC 0.9799251556396484, avg_entr 0.02260594442486763
ep4_t0.3_test_time 0.09471249580383301
gc 0
Train Epoch5 Acc 0.022041666666666668 (2645/120000), AUC 0.38512903451919556
ep5_train_time 14.440951585769653
Test Epoch5 threshold 0.3 Acc 0.9100328947368421, AUC 0.9795464873313904, avg_entr 0.02305222861468792
ep5_t0.3_test_time 0.09448623657226562
gc 0
Train Epoch6 Acc 0.021333333333333333 (2560/120000), AUC 0.3839968740940094
ep6_train_time 15.170071125030518
Test Epoch6 threshold 0.3 Acc 0.9116776315789473, AUC 0.9789535999298096, avg_entr 0.022276900708675385
ep6_t0.3_test_time 0.09729385375976562
gc 0
Train Epoch7 Acc 0.020133333333333333 (2416/120000), AUC 0.3865010738372803
ep7_train_time 14.526216506958008
Test Epoch7 threshold 0.3 Acc 0.9110197368421052, AUC 0.9787151217460632, avg_entr 0.023088345304131508
ep7_t0.3_test_time 0.09555935859680176
gc 0
Train Epoch8 Acc 0.019316666666666666 (2318/120000), AUC 0.39160075783729553
ep8_train_time 14.830780267715454
Test Epoch8 threshold 0.3 Acc 0.9116776315789473, AUC 0.9786980152130127, avg_entr 0.0220622718334198
ep8_t0.3_test_time 0.09819698333740234
gc 0
Train Epoch9 Acc 0.017308333333333332 (2077/120000), AUC 0.39065787196159363
ep9_train_time 14.621020555496216
Test Epoch9 threshold 0.3 Acc 0.9101973684210526, AUC 0.9785568118095398, avg_entr 0.02247774228453636
ep9_t0.3_test_time 0.09324288368225098
Best AUC 0.9809602499008179
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad25_t0.3_m3//ag_news_lstmal_l5_prefix.pt
Test threshold 0.3 Acc 0.9210526315789473, AUC 0.985620379447937, avg_entr 0.023544983938336372
t0.3_test_time 0.029070615768432617
