total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.6_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.04479166666666667 (5375/120000), AUC 0.46471819281578064
ep0_train_time 6.9827845096588135
Test Epoch0 threshold 0.6 Acc 0.912828947368421, AUC 0.9806654453277588, avg_entr 0.02631238102912903
ep0_t0.6_test_time 0.13439583778381348
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.6_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.006908333333333333 (829/120000), AUC 0.4533548355102539
ep1_train_time 6.534430265426636
Test Epoch1 threshold 0.6 Acc 0.9144736842105263, AUC 0.9806256294250488, avg_entr 0.02537108026444912
ep1_t0.6_test_time 0.13237810134887695
gc 0
Train Epoch2 Acc 0.007316666666666667 (878/120000), AUC 0.4386129379272461
ep2_train_time 6.463903188705444
Test Epoch2 threshold 0.6 Acc 0.915296052631579, AUC 0.9804370999336243, avg_entr 0.025884751230478287
ep2_t0.6_test_time 0.13301777839660645
gc 0
Train Epoch3 Acc 0.009066666666666667 (1088/120000), AUC 0.4502483606338501
ep3_train_time 6.462953329086304
Test Epoch3 threshold 0.6 Acc 0.9126644736842106, AUC 0.9801920056343079, avg_entr 0.02592380903661251
ep3_t0.6_test_time 0.13240647315979004
gc 0
Train Epoch4 Acc 0.014325 (1719/120000), AUC 0.4587814211845398
ep4_train_time 6.554351329803467
Test Epoch4 threshold 0.6 Acc 0.9131578947368421, AUC 0.9799942970275879, avg_entr 0.025772804394364357
ep4_t0.6_test_time 0.13234233856201172
gc 0
Train Epoch5 Acc 0.024758333333333334 (2971/120000), AUC 0.46524080634117126
ep5_train_time 6.4876389503479
Test Epoch5 threshold 0.6 Acc 0.9115131578947369, AUC 0.9797637462615967, avg_entr 0.026296064257621765
ep5_t0.6_test_time 0.13263654708862305
gc 0
Train Epoch6 Acc 0.043175 (5181/120000), AUC 0.4681764543056488
ep6_train_time 6.490477800369263
Test Epoch6 threshold 0.6 Acc 0.9121710526315789, AUC 0.9797012209892273, avg_entr 0.026009976863861084
ep6_t0.6_test_time 0.13273978233337402
gc 0
Train Epoch7 Acc 0.07513333333333333 (9016/120000), AUC 0.47085851430892944
ep7_train_time 6.488517999649048
Test Epoch7 threshold 0.6 Acc 0.9110197368421052, AUC 0.9794530272483826, avg_entr 0.025830039754509926
ep7_t0.6_test_time 0.1324477195739746
gc 0
Train Epoch8 Acc 0.10716666666666666 (12860/120000), AUC 0.4729933738708496
ep8_train_time 6.436013221740723
Test Epoch8 threshold 0.6 Acc 0.9115131578947369, AUC 0.9793301820755005, avg_entr 0.025715580210089684
ep8_t0.6_test_time 0.13395929336547852
gc 0
Train Epoch9 Acc 0.12763333333333332 (15316/120000), AUC 0.47505030035972595
ep9_train_time 6.446635961532593
Test Epoch9 threshold 0.6 Acc 0.9118421052631579, AUC 0.979332447052002, avg_entr 0.02601723186671734
ep9_t0.6_test_time 0.13230133056640625
Best AUC 0.9806654453277588
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.6_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.925, AUC 0.9860864877700806, avg_entr 0.025807932019233704
t0.6_test_time 0.03467845916748047
