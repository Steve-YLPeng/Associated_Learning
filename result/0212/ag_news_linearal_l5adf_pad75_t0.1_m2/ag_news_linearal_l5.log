total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.1_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.2552583333333333 (30631/120000), AUC 0.6134307384490967
ep0_train_time 6.48401951789856
Test Epoch0 threshold 0.1 Acc 0.9175986842105263, AUC 0.9805379509925842, avg_entr 0.028944628313183784
ep0_t0.1_test_time 0.14629626274108887
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.1_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.251925 (30231/120000), AUC 0.6458691358566284
ep1_train_time 6.040593862533569
Test Epoch1 threshold 0.1 Acc 0.9154605263157894, AUC 0.9805547595024109, avg_entr 0.027657467871904373
ep1_t0.1_test_time 0.14410614967346191
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.1_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.2504416666666667 (30053/120000), AUC 0.64510577917099
ep2_train_time 6.035025596618652
Test Epoch2 threshold 0.1 Acc 0.9151315789473684, AUC 0.9800556302070618, avg_entr 0.02725711278617382
ep2_t0.1_test_time 0.14085817337036133
gc 0
Train Epoch3 Acc 0.25225 (30270/120000), AUC 0.6452547311782837
ep3_train_time 5.911510467529297
Test Epoch3 threshold 0.1 Acc 0.912828947368421, AUC 0.9799041748046875, avg_entr 0.02605123072862625
ep3_t0.1_test_time 0.14129424095153809
gc 0
Train Epoch4 Acc 0.253825 (30459/120000), AUC 0.6428992748260498
ep4_train_time 5.863542795181274
Test Epoch4 threshold 0.1 Acc 0.9138157894736842, AUC 0.9798318147659302, avg_entr 0.025515515357255936
ep4_t0.1_test_time 0.1414954662322998
gc 0
Train Epoch5 Acc 0.2555 (30660/120000), AUC 0.6414299011230469
ep5_train_time 5.928928375244141
Test Epoch5 threshold 0.1 Acc 0.9138157894736842, AUC 0.979631781578064, avg_entr 0.025898519903421402
ep5_t0.1_test_time 0.14016342163085938
gc 0
Train Epoch6 Acc 0.25601666666666667 (30722/120000), AUC 0.6391721963882446
ep6_train_time 5.932244539260864
Test Epoch6 threshold 0.1 Acc 0.9134868421052632, AUC 0.9793795347213745, avg_entr 0.025772016495466232
ep6_t0.1_test_time 0.14098739624023438
gc 0
Train Epoch7 Acc 0.2561083333333333 (30733/120000), AUC 0.636972188949585
ep7_train_time 5.943477153778076
Test Epoch7 threshold 0.1 Acc 0.9120065789473685, AUC 0.9791896939277649, avg_entr 0.02584909088909626
ep7_t0.1_test_time 0.1418015956878662
gc 0
Train Epoch8 Acc 0.25656666666666667 (30788/120000), AUC 0.6352702379226685
ep8_train_time 5.904836654663086
Test Epoch8 threshold 0.1 Acc 0.9103618421052632, AUC 0.9791511297225952, avg_entr 0.025991713628172874
ep8_t0.1_test_time 0.14106416702270508
gc 0
Train Epoch9 Acc 0.25625 (30750/120000), AUC 0.633747935295105
ep9_train_time 5.813391447067261
Test Epoch9 threshold 0.1 Acc 0.9103618421052632, AUC 0.9791166186332703, avg_entr 0.025551650673151016
ep9_t0.1_test_time 0.13854622840881348
Best AUC 0.9805547595024109
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.1_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9230263157894737, AUC 0.9856441617012024, avg_entr 0.026395579800009727
t0.1_test_time 0.03544950485229492
