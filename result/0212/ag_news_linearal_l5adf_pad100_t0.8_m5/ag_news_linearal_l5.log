total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.8_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.905325 (108639/120000), AUC 0.9837552309036255
ep0_train_time 8.360976696014404
Test Epoch0 threshold 0.8 Acc 0.9151315789473684, AUC 0.9804781079292297, avg_entr 0.025687750428915024
ep0_t0.8_test_time 0.1636202335357666
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.8_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9485916666666667 (113831/120000), AUC 0.9925777316093445
ep1_train_time 7.861950397491455
Test Epoch1 threshold 0.8 Acc 0.9146381578947368, AUC 0.9804338216781616, avg_entr 0.02625013142824173
ep1_t0.8_test_time 0.16262483596801758
gc 0
Train Epoch2 Acc 0.9503 (114036/120000), AUC 0.9929570555686951
ep2_train_time 7.851724863052368
Test Epoch2 threshold 0.8 Acc 0.9136513157894737, AUC 0.9801527261734009, avg_entr 0.025106774643063545
ep2_t0.8_test_time 0.16260337829589844
gc 0
Train Epoch3 Acc 0.9517166666666667 (114206/120000), AUC 0.9931226968765259
ep3_train_time 7.908356666564941
Test Epoch3 threshold 0.8 Acc 0.9136513157894737, AUC 0.9798662662506104, avg_entr 0.025765517726540565
ep3_t0.8_test_time 0.16333556175231934
gc 0
Train Epoch4 Acc 0.9531666666666667 (114380/120000), AUC 0.9935868382453918
ep4_train_time 7.944277286529541
Test Epoch4 threshold 0.8 Acc 0.9146381578947368, AUC 0.9797807335853577, avg_entr 0.026048850268125534
ep4_t0.8_test_time 0.16407561302185059
gc 0
Train Epoch5 Acc 0.95485 (114582/120000), AUC 0.9943692684173584
ep5_train_time 8.143712282180786
Test Epoch5 threshold 0.8 Acc 0.9123355263157895, AUC 0.9796423316001892, avg_entr 0.026104429736733437
ep5_t0.8_test_time 0.1633155345916748
gc 0
Train Epoch6 Acc 0.955925 (114711/120000), AUC 0.9946178793907166
ep6_train_time 8.035758972167969
Test Epoch6 threshold 0.8 Acc 0.9126644736842106, AUC 0.9794799089431763, avg_entr 0.025372086092829704
ep6_t0.8_test_time 0.16293859481811523
gc 0
Train Epoch7 Acc 0.9564333333333334 (114772/120000), AUC 0.9947078824043274
ep7_train_time 7.942169189453125
Test Epoch7 threshold 0.8 Acc 0.9126644736842106, AUC 0.9793373346328735, avg_entr 0.025154829025268555
ep7_t0.8_test_time 0.16277551651000977
gc 0
Train Epoch8 Acc 0.9567583333333334 (114811/120000), AUC 0.9948729276657104
ep8_train_time 8.09060025215149
Test Epoch8 threshold 0.8 Acc 0.9118421052631579, AUC 0.9791571497917175, avg_entr 0.025632765144109726
ep8_t0.8_test_time 0.16295289993286133
gc 0
Train Epoch9 Acc 0.958025 (114963/120000), AUC 0.9952415227890015
ep9_train_time 7.874279022216797
Test Epoch9 threshold 0.8 Acc 0.9123355263157895, AUC 0.9791767001152039, avg_entr 0.02609826624393463
ep9_t0.8_test_time 0.16263723373413086
Best AUC 0.9804781079292297
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.8_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9243421052631579, AUC 0.9857134819030762, avg_entr 0.024733558297157288
t0.8_test_time 0.04132366180419922
