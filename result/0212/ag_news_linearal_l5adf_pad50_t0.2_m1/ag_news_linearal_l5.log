total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.23480833333333334 (28177/120000), AUC 0.49255186319351196
ep0_train_time 4.948007345199585
Test Epoch0 threshold 0.2 Acc 0.9105263157894737, AUC 0.9778114557266235, avg_entr 0.15919610857963562
ep0_t0.2_test_time 0.10198259353637695
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.237 (28440/120000), AUC 0.489005982875824
ep1_train_time 4.488861560821533
Test Epoch1 threshold 0.2 Acc 0.9157894736842105, AUC 0.9797558188438416, avg_entr 0.09773072600364685
ep1_t0.2_test_time 0.1005256175994873
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.23756666666666668 (28508/120000), AUC 0.48981305956840515
ep2_train_time 4.466306924819946
Test Epoch2 threshold 0.2 Acc 0.9151315789473684, AUC 0.9800505042076111, avg_entr 0.077777199447155
ep2_t0.2_test_time 0.10100054740905762
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.237575 (28509/120000), AUC 0.49076277017593384
ep3_train_time 4.4606218338012695
Test Epoch3 threshold 0.2 Acc 0.9161184210526315, AUC 0.9807810187339783, avg_entr 0.06813747435808182
ep3_t0.2_test_time 0.10077142715454102
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.2_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.23683333333333334 (28420/120000), AUC 0.4917474389076233
ep4_train_time 4.493826627731323
Test Epoch4 threshold 0.2 Acc 0.9139802631578947, AUC 0.9801311492919922, avg_entr 0.05962934345006943
ep4_t0.2_test_time 0.1004326343536377
gc 0
Train Epoch5 Acc 0.23638333333333333 (28366/120000), AUC 0.4929882884025574
ep5_train_time 4.457103252410889
Test Epoch5 threshold 0.2 Acc 0.9151315789473684, AUC 0.9802581071853638, avg_entr 0.055403005331754684
ep5_t0.2_test_time 0.10057497024536133
gc 0
Train Epoch6 Acc 0.23626666666666668 (28352/120000), AUC 0.4944860339164734
ep6_train_time 4.483526706695557
Test Epoch6 threshold 0.2 Acc 0.9136513157894737, AUC 0.9797201156616211, avg_entr 0.050435516983270645
ep6_t0.2_test_time 0.10018610954284668
gc 0
Train Epoch7 Acc 0.23629166666666668 (28355/120000), AUC 0.495657354593277
ep7_train_time 4.544977188110352
Test Epoch7 threshold 0.2 Acc 0.9126644736842106, AUC 0.9794427752494812, avg_entr 0.04724416881799698
ep7_t0.2_test_time 0.10035228729248047
gc 0
Train Epoch8 Acc 0.23659166666666667 (28391/120000), AUC 0.4969477653503418
ep8_train_time 4.667187213897705
Test Epoch8 threshold 0.2 Acc 0.9121710526315789, AUC 0.9794204235076904, avg_entr 0.04534617066383362
ep8_t0.2_test_time 0.10434412956237793
gc 0
Train Epoch9 Acc 0.237475 (28497/120000), AUC 0.4975327253341675
ep9_train_time 4.733884334564209
Test Epoch9 threshold 0.2 Acc 0.9110197368421052, AUC 0.9790246486663818, avg_entr 0.04471065476536751
ep9_t0.2_test_time 0.1033167839050293
Best AUC 0.9807810187339783
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.2_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.2 Acc 0.9276315789473685, AUC 0.9863738417625427, avg_entr 0.07021656632423401
t0.2_test_time 0.026625871658325195
