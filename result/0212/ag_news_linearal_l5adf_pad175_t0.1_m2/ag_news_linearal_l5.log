total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.6375147700309753
ep0_train_time 8.988393545150757
Test Epoch0 threshold 0.1 Acc 0.9159539473684211, AUC 0.9808009266853333, avg_entr 0.026222921907901764
ep0_t0.1_test_time 0.2615084648132324
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.6237758994102478
ep1_train_time 8.53009557723999
Test Epoch1 threshold 0.1 Acc 0.915625, AUC 0.9807231426239014, avg_entr 0.026718206703662872
ep1_t0.1_test_time 0.25981950759887695
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.6312891840934753
ep2_train_time 8.47286581993103
Test Epoch2 threshold 0.1 Acc 0.9167763157894737, AUC 0.9807243347167969, avg_entr 0.025337154045701027
ep2_t0.1_test_time 0.26012182235717773
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.6394360065460205
ep3_train_time 8.590394258499146
Test Epoch3 threshold 0.1 Acc 0.9157894736842105, AUC 0.9806016683578491, avg_entr 0.02512894943356514
ep3_t0.1_test_time 0.2596921920776367
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.6493571400642395
ep4_train_time 8.561435461044312
Test Epoch4 threshold 0.1 Acc 0.9144736842105263, AUC 0.980377733707428, avg_entr 0.02554379776120186
ep4_t0.1_test_time 0.2600836753845215
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.6580151915550232
ep5_train_time 8.781845331192017
Test Epoch5 threshold 0.1 Acc 0.9136513157894737, AUC 0.9802435040473938, avg_entr 0.025982819497585297
ep5_t0.1_test_time 0.25937414169311523
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.6610984802246094
ep6_train_time 8.548444509506226
Test Epoch6 threshold 0.1 Acc 0.9134868421052632, AUC 0.9801113605499268, avg_entr 0.025425244122743607
ep6_t0.1_test_time 0.2603940963745117
gc 0
Train Epoch7 Acc 0.25 (30000/120000), AUC 0.6640423536300659
ep7_train_time 8.613468170166016
Test Epoch7 threshold 0.1 Acc 0.9144736842105263, AUC 0.980110764503479, avg_entr 0.02604535222053528
ep7_t0.1_test_time 0.2595977783203125
gc 0
Train Epoch8 Acc 0.25 (30000/120000), AUC 0.6665856838226318
ep8_train_time 8.648061513900757
Test Epoch8 threshold 0.1 Acc 0.9138157894736842, AUC 0.9799313545227051, avg_entr 0.024973513558506966
ep8_t0.1_test_time 0.25952911376953125
gc 0
Train Epoch9 Acc 0.25 (30000/120000), AUC 0.6681355237960815
ep9_train_time 8.588088035583496
Test Epoch9 threshold 0.1 Acc 0.9133223684210526, AUC 0.9799071550369263, avg_entr 0.02557847648859024
ep9_t0.1_test_time 0.25954174995422363
Best AUC 0.9808009266853333
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9236842105263158, AUC 0.9864648580551147, avg_entr 0.026606164872646332
t0.1_test_time 0.06559085845947266
