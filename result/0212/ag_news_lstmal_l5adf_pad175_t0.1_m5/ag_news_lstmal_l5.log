total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9212166666666667 (110546/120000), AUC 0.983643651008606
ep0_train_time 88.37383770942688
Test Epoch0 threshold 0.1 Acc 0.9120065789473685, AUC 0.9787432551383972, avg_entr 0.006838730536401272
ep0_t0.1_test_time 0.6553909778594971
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9550083333333333 (114601/120000), AUC 0.9924125671386719
ep1_train_time 88.07779908180237
Test Epoch1 threshold 0.1 Acc 0.9146381578947368, AUC 0.9785627126693726, avg_entr 0.00714861648157239
ep1_t0.1_test_time 0.6255011558532715
gc 0
Train Epoch2 Acc 0.9578 (114936/120000), AUC 0.9932522773742676
ep2_train_time 88.10631513595581
Test Epoch2 threshold 0.1 Acc 0.9120065789473685, AUC 0.9782564043998718, avg_entr 0.007318899035453796
ep2_t0.1_test_time 0.6854069232940674
gc 0
Train Epoch3 Acc 0.96015 (115218/120000), AUC 0.9937130212783813
ep3_train_time 88.38731741905212
Test Epoch3 threshold 0.1 Acc 0.9103618421052632, AUC 0.977695643901825, avg_entr 0.007533683441579342
ep3_t0.1_test_time 0.6618847846984863
gc 0
Train Epoch4 Acc 0.9623333333333334 (115480/120000), AUC 0.9941532015800476
ep4_train_time 88.09669947624207
Test Epoch4 threshold 0.1 Acc 0.9121710526315789, AUC 0.9774709343910217, avg_entr 0.007214033044874668
ep4_t0.1_test_time 0.6282336711883545
gc 0
Train Epoch5 Acc 0.9660666666666666 (115928/120000), AUC 0.9947919845581055
ep5_train_time 88.25055623054504
Test Epoch5 threshold 0.1 Acc 0.9097039473684211, AUC 0.9765280485153198, avg_entr 0.007154916413128376
ep5_t0.1_test_time 0.6551616191864014
gc 0
Train Epoch6 Acc 0.9672166666666666 (116066/120000), AUC 0.9949106574058533
ep6_train_time 88.0907552242279
Test Epoch6 threshold 0.1 Acc 0.9103618421052632, AUC 0.9768249988555908, avg_entr 0.007127207238227129
ep6_t0.1_test_time 0.6447000503540039
gc 0
Train Epoch7 Acc 0.96825 (116190/120000), AUC 0.9950276017189026
ep7_train_time 88.15172553062439
Test Epoch7 threshold 0.1 Acc 0.9083881578947368, AUC 0.9757906198501587, avg_entr 0.007040548138320446
ep7_t0.1_test_time 0.6104209423065186
gc 0
Train Epoch8 Acc 0.96945 (116334/120000), AUC 0.995215117931366
ep8_train_time 88.05649256706238
Test Epoch8 threshold 0.1 Acc 0.9064144736842106, AUC 0.975387692451477, avg_entr 0.0070483870804309845
ep8_t0.1_test_time 0.644639253616333
gc 0
Train Epoch9 Acc 0.9714333333333334 (116572/120000), AUC 0.9955556988716125
ep9_train_time 88.19187760353088
Test Epoch9 threshold 0.1 Acc 0.9082236842105263, AUC 0.9750552773475647, avg_entr 0.006410831585526466
ep9_t0.1_test_time 0.6277318000793457
Best AUC 0.9787432551383972
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.1_m5//ag_news_lstmal_l5_prefix.pt
Test threshold 0.1 Acc 0.9236842105263158, AUC 0.9842555522918701, avg_entr 0.007574544288218021
t0.1_test_time 0.18188858032226562
