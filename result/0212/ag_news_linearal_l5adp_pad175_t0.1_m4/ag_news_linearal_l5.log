total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.1_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.44571666666666665 (53486/120000), AUC 0.7201400995254517
ep0_train_time 9.765952825546265
Test Epoch0 threshold 0.1 Acc 0.9141447368421053, AUC 0.9804710149765015, avg_entr 0.02392975613474846
ep0_t0.1_test_time 0.2734088897705078
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4572 (54864/120000), AUC 0.7380210757255554
ep1_train_time 9.518888711929321
Test Epoch1 threshold 0.1 Acc 0.9136513157894737, AUC 0.9804935455322266, avg_entr 0.023579517379403114
ep1_t0.1_test_time 0.27198243141174316
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.4290583333333333 (51487/120000), AUC 0.7236687541007996
ep2_train_time 9.454444408416748
Test Epoch2 threshold 0.1 Acc 0.915625, AUC 0.9802435040473938, avg_entr 0.019142422825098038
ep2_t0.1_test_time 0.2719292640686035
gc 0
Train Epoch3 Acc 0.4082 (48984/120000), AUC 0.5872304439544678
ep3_train_time 9.575028419494629
Test Epoch3 threshold 0.1 Acc 0.9131578947368421, AUC 0.9801458716392517, avg_entr 0.015859143808484077
ep3_t0.1_test_time 0.27254486083984375
gc 0
Train Epoch4 Acc 0.39314166666666667 (47177/120000), AUC 0.488068163394928
ep4_train_time 9.32520079612732
Test Epoch4 threshold 0.1 Acc 0.915625, AUC 0.9799177646636963, avg_entr 0.012913125567138195
ep4_t0.1_test_time 0.27159690856933594
gc 0
Train Epoch5 Acc 0.383575 (46029/120000), AUC 0.49497514963150024
ep5_train_time 9.698167085647583
Test Epoch5 threshold 0.1 Acc 0.9131578947368421, AUC 0.9796472191810608, avg_entr 0.012869153171777725
ep5_t0.1_test_time 0.273409366607666
gc 0
Train Epoch6 Acc 0.3787 (45444/120000), AUC 0.5139124393463135
ep6_train_time 9.446099281311035
Test Epoch6 threshold 0.1 Acc 0.9116776315789473, AUC 0.9795806407928467, avg_entr 0.012291978113353252
ep6_t0.1_test_time 0.2723121643066406
gc 0
Train Epoch7 Acc 0.37164166666666665 (44597/120000), AUC 0.5299011468887329
ep7_train_time 9.503914594650269
Test Epoch7 threshold 0.1 Acc 0.9141447368421053, AUC 0.9795375466346741, avg_entr 0.012168407440185547
ep7_t0.1_test_time 0.2727208137512207
gc 0
Train Epoch8 Acc 0.36494166666666666 (43793/120000), AUC 0.5418953895568848
ep8_train_time 9.55057954788208
Test Epoch8 threshold 0.1 Acc 0.9133223684210526, AUC 0.9794111251831055, avg_entr 0.012242498807609081
ep8_t0.1_test_time 0.27195262908935547
gc 0
Train Epoch9 Acc 0.35565833333333335 (42679/120000), AUC 0.5500828623771667
ep9_train_time 9.355324745178223
Test Epoch9 threshold 0.1 Acc 0.912828947368421, AUC 0.9794389009475708, avg_entr 0.012312570586800575
ep9_t0.1_test_time 0.27196574211120605
Best AUC 0.9804935455322266
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.1_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9256578947368421, AUC 0.9860110282897949, avg_entr 0.022307798266410828
t0.1_test_time 0.06895828247070312
