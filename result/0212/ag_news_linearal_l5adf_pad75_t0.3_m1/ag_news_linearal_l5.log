total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.2763833333333333 (33166/120000), AUC 0.40971839427948
ep0_train_time 5.945822477340698
Test Epoch0 threshold 0.3 Acc 0.9067434210526316, AUC 0.9773188233375549, avg_entr 0.16086705029010773
ep0_t0.3_test_time 0.14127588272094727
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25906666666666667 (31088/120000), AUC 0.36245355010032654
ep1_train_time 5.671682596206665
Test Epoch1 threshold 0.3 Acc 0.9141447368421053, AUC 0.9798406958580017, avg_entr 0.09620127081871033
ep1_t0.3_test_time 0.13279509544372559
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.25345833333333334 (30415/120000), AUC 0.36074554920196533
ep2_train_time 5.288617849349976
Test Epoch2 threshold 0.3 Acc 0.915296052631579, AUC 0.9804598093032837, avg_entr 0.07505600154399872
ep2_t0.3_test_time 0.1360015869140625
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25198333333333334 (30238/120000), AUC 0.361351877450943
ep3_train_time 5.283119440078735
Test Epoch3 threshold 0.3 Acc 0.915625, AUC 0.980583906173706, avg_entr 0.06450819969177246
ep3_t0.3_test_time 0.13175010681152344
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.251325 (30159/120000), AUC 0.361425518989563
ep4_train_time 5.447005987167358
Test Epoch4 threshold 0.3 Acc 0.9166118421052631, AUC 0.9806958436965942, avg_entr 0.05712820217013359
ep4_t0.3_test_time 0.13501811027526855
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.3_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.2511083333333333 (30133/120000), AUC 0.3614080548286438
ep5_train_time 5.430897951126099
Test Epoch5 threshold 0.3 Acc 0.912828947368421, AUC 0.9804189205169678, avg_entr 0.05413283780217171
ep5_t0.3_test_time 0.1343381404876709
gc 0
Train Epoch6 Acc 0.2508916666666667 (30107/120000), AUC 0.36126869916915894
ep6_train_time 5.406186103820801
Test Epoch6 threshold 0.3 Acc 0.9141447368421053, AUC 0.9798522591590881, avg_entr 0.049701374024152756
ep6_t0.3_test_time 0.1339259147644043
gc 0
Train Epoch7 Acc 0.2507 (30084/120000), AUC 0.36103349924087524
ep7_train_time 5.330430507659912
Test Epoch7 threshold 0.3 Acc 0.9148026315789474, AUC 0.9801456928253174, avg_entr 0.04624805971980095
ep7_t0.3_test_time 0.13199234008789062
gc 0
Train Epoch8 Acc 0.250575 (30069/120000), AUC 0.36047303676605225
ep8_train_time 5.38919472694397
Test Epoch8 threshold 0.3 Acc 0.9139802631578947, AUC 0.9798040390014648, avg_entr 0.04409255087375641
ep8_t0.3_test_time 0.13220834732055664
gc 0
Train Epoch9 Acc 0.250525 (30063/120000), AUC 0.35998380184173584
ep9_train_time 5.455134391784668
Test Epoch9 threshold 0.3 Acc 0.9106907894736842, AUC 0.9796195030212402, avg_entr 0.04317433759570122
ep9_t0.3_test_time 0.13351821899414062
Best AUC 0.9806958436965942
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.3_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9217105263157894, AUC 0.9858555793762207, avg_entr 0.05884956568479538
t0.3_test_time 0.03420734405517578
