total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.8_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.908975 (109077/120000), AUC 0.984613835811615
ep0_train_time 10.453778266906738
Test Epoch0 threshold 0.8 Acc 0.912828947368421, AUC 0.9804965257644653, avg_entr 0.026080895215272903
ep0_t0.8_test_time 0.25366711616516113
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.94995 (113994/120000), AUC 0.9931719899177551
ep1_train_time 10.021345853805542
Test Epoch1 threshold 0.8 Acc 0.9133223684210526, AUC 0.9802764654159546, avg_entr 0.024708110839128494
ep1_t0.8_test_time 0.2502322196960449
gc 0
Train Epoch2 Acc 0.9518416666666667 (114221/120000), AUC 0.9934496879577637
ep2_train_time 9.962018728256226
Test Epoch2 threshold 0.8 Acc 0.9144736842105263, AUC 0.9801657199859619, avg_entr 0.025460368022322655
ep2_t0.8_test_time 0.250903844833374
gc 0
Train Epoch3 Acc 0.9522166666666667 (114266/120000), AUC 0.9935444593429565
ep3_train_time 10.199495553970337
Test Epoch3 threshold 0.8 Acc 0.9144736842105263, AUC 0.980048656463623, avg_entr 0.02566421404480934
ep3_t0.8_test_time 0.250396728515625
gc 0
Train Epoch4 Acc 0.9536083333333333 (114433/120000), AUC 0.9939446449279785
ep4_train_time 10.202983379364014
Test Epoch4 threshold 0.8 Acc 0.9120065789473685, AUC 0.9798803329467773, avg_entr 0.025629982352256775
ep4_t0.8_test_time 0.2518472671508789
gc 0
Train Epoch5 Acc 0.9552 (114624/120000), AUC 0.9945465326309204
ep5_train_time 9.96506118774414
Test Epoch5 threshold 0.8 Acc 0.9138157894736842, AUC 0.9798426628112793, avg_entr 0.02636963129043579
ep5_t0.8_test_time 0.25079917907714844
gc 0
Train Epoch6 Acc 0.9558583333333334 (114703/120000), AUC 0.9946742653846741
ep6_train_time 10.073718309402466
Test Epoch6 threshold 0.8 Acc 0.9110197368421052, AUC 0.9796361327171326, avg_entr 0.02564110793173313
ep6_t0.8_test_time 0.25066256523132324
gc 0
Train Epoch7 Acc 0.956175 (114741/120000), AUC 0.9947522282600403
ep7_train_time 10.023377418518066
Test Epoch7 threshold 0.8 Acc 0.9115131578947369, AUC 0.9796095490455627, avg_entr 0.026459114626049995
ep7_t0.8_test_time 0.2508399486541748
gc 0
Train Epoch8 Acc 0.95655 (114786/120000), AUC 0.994846522808075
ep8_train_time 10.12745976448059
Test Epoch8 threshold 0.8 Acc 0.9100328947368421, AUC 0.9794844388961792, avg_entr 0.024997610598802567
ep8_t0.8_test_time 0.261167049407959
gc 0
Train Epoch9 Acc 0.9576833333333333 (114922/120000), AUC 0.9952300190925598
ep9_train_time 10.37489366531372
Test Epoch9 threshold 0.8 Acc 0.9106907894736842, AUC 0.9794380068778992, avg_entr 0.02621534839272499
ep9_t0.8_test_time 0.25057315826416016
Best AUC 0.9804965257644653
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.8_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9230263157894737, AUC 0.9860265851020813, avg_entr 0.02469312958419323
t0.8_test_time 0.06343364715576172
