total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.4_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.09725 (11670/120000), AUC 0.43426787853240967
ep0_train_time 5.743657350540161
Test Epoch0 threshold 0.4 Acc 0.9185855263157895, AUC 0.9808319211006165, avg_entr 0.03101845271885395
ep0_t0.4_test_time 0.11030697822570801
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.4_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.14474166666666666 (17369/120000), AUC 0.43632060289382935
ep1_train_time 5.28328275680542
Test Epoch1 threshold 0.4 Acc 0.9157894736842105, AUC 0.9801557660102844, avg_entr 0.02878408692777157
ep1_t0.4_test_time 0.10860013961791992
gc 0
Train Epoch2 Acc 0.15473333333333333 (18568/120000), AUC 0.43195641040802
ep2_train_time 5.20930290222168
Test Epoch2 threshold 0.4 Acc 0.9161184210526315, AUC 0.9803184270858765, avg_entr 0.027679599821567535
ep2_t0.4_test_time 0.1053774356842041
gc 0
Train Epoch3 Acc 0.15916666666666668 (19100/120000), AUC 0.4296867847442627
ep3_train_time 4.988997936248779
Test Epoch3 threshold 0.4 Acc 0.9126644736842106, AUC 0.9802367091178894, avg_entr 0.0273008793592453
ep3_t0.4_test_time 0.10448598861694336
gc 0
Train Epoch4 Acc 0.1603 (19236/120000), AUC 0.42757710814476013
ep4_train_time 5.002202987670898
Test Epoch4 threshold 0.4 Acc 0.9123355263157895, AUC 0.9796041250228882, avg_entr 0.02719799429178238
ep4_t0.4_test_time 0.10436463356018066
gc 0
Train Epoch5 Acc 0.15918333333333334 (19102/120000), AUC 0.4260145425796509
ep5_train_time 5.0062339305877686
Test Epoch5 threshold 0.4 Acc 0.9118421052631579, AUC 0.9796617031097412, avg_entr 0.026218730956315994
ep5_t0.4_test_time 0.1051182746887207
gc 0
Train Epoch6 Acc 0.1572 (18864/120000), AUC 0.4254471957683563
ep6_train_time 5.0469512939453125
Test Epoch6 threshold 0.4 Acc 0.9097039473684211, AUC 0.9793254137039185, avg_entr 0.02736898884177208
ep6_t0.4_test_time 0.10342884063720703
gc 0
Train Epoch7 Acc 0.15415 (18498/120000), AUC 0.42498117685317993
ep7_train_time 5.010493040084839
Test Epoch7 threshold 0.4 Acc 0.9113486842105263, AUC 0.9793300628662109, avg_entr 0.026385445147752762
ep7_t0.4_test_time 0.1032712459564209
gc 0
Train Epoch8 Acc 0.15133333333333332 (18160/120000), AUC 0.42400750517845154
ep8_train_time 5.0004754066467285
Test Epoch8 threshold 0.4 Acc 0.9108552631578948, AUC 0.9791017174720764, avg_entr 0.026766104623675346
ep8_t0.4_test_time 0.10345602035522461
gc 0
Train Epoch9 Acc 0.14829166666666665 (17795/120000), AUC 0.423150897026062
ep9_train_time 5.001933574676514
Test Epoch9 threshold 0.4 Acc 0.9108552631578948, AUC 0.9789913296699524, avg_entr 0.026547368615865707
ep9_t0.4_test_time 0.10282278060913086
Best AUC 0.9808319211006165
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.4_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.925, AUC 0.9860371351242065, avg_entr 0.03142385557293892
t0.4_test_time 0.027440786361694336
