total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.23481666666666667 (28178/120000), AUC 0.5256720185279846
ep0_train_time 7.090360641479492
Test Epoch0 threshold 0.6 Acc 0.9027960526315789, AUC 0.975655198097229, avg_entr 0.17293034493923187
ep0_t0.6_test_time 0.17337870597839355
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.21794166666666667 (26153/120000), AUC 0.5500829219818115
ep1_train_time 6.771739482879639
Test Epoch1 threshold 0.6 Acc 0.9129934210526316, AUC 0.9788945913314819, avg_entr 0.10102974623441696
ep1_t0.6_test_time 0.17175650596618652
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.21558333333333332 (25870/120000), AUC 0.5485541820526123
ep2_train_time 5.979496717453003
Test Epoch2 threshold 0.6 Acc 0.9144736842105263, AUC 0.9801293015480042, avg_entr 0.0774737000465393
ep2_t0.6_test_time 0.16112422943115234
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.21846666666666667 (26216/120000), AUC 0.5463544726371765
ep3_train_time 5.813640356063843
Test Epoch3 threshold 0.6 Acc 0.9166118421052631, AUC 0.9805334806442261, avg_entr 0.0679878517985344
ep3_t0.6_test_time 0.16072773933410645
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.22284166666666666 (26741/120000), AUC 0.5441663265228271
ep4_train_time 5.835932493209839
Test Epoch4 threshold 0.6 Acc 0.9159539473684211, AUC 0.9805790781974792, avg_entr 0.05803978070616722
ep4_t0.6_test_time 0.16111111640930176
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.6_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.22795833333333335 (27355/120000), AUC 0.5421369075775146
ep5_train_time 5.93900728225708
Test Epoch5 threshold 0.6 Acc 0.9151315789473684, AUC 0.9805039167404175, avg_entr 0.05310802906751633
ep5_t0.6_test_time 0.16108369827270508
gc 0
Train Epoch6 Acc 0.23274166666666668 (27929/120000), AUC 0.5414681434631348
ep6_train_time 5.836225748062134
Test Epoch6 threshold 0.6 Acc 0.9159539473684211, AUC 0.9805420637130737, avg_entr 0.0490063801407814
ep6_t0.6_test_time 0.16057467460632324
gc 0
Train Epoch7 Acc 0.239625 (28755/120000), AUC 0.5403112769126892
ep7_train_time 5.869890213012695
Test Epoch7 threshold 0.6 Acc 0.915625, AUC 0.9802075028419495, avg_entr 0.04697900637984276
ep7_t0.6_test_time 0.16096043586730957
gc 0
Train Epoch8 Acc 0.24424166666666666 (29309/120000), AUC 0.5399633646011353
ep8_train_time 5.891615867614746
Test Epoch8 threshold 0.6 Acc 0.9151315789473684, AUC 0.9801575541496277, avg_entr 0.044577885419130325
ep8_t0.6_test_time 0.16049861907958984
gc 0
Train Epoch9 Acc 0.24604166666666666 (29525/120000), AUC 0.5389670133590698
ep9_train_time 6.181859016418457
Test Epoch9 threshold 0.6 Acc 0.915625, AUC 0.9800058007240295, avg_entr 0.04197743162512779
ep9_t0.6_test_time 0.1734027862548828
Best AUC 0.9805790781974792
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.6_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9223684210526316, AUC 0.9865762591362, avg_entr 0.06121521815657616
t0.6_test_time 0.042353153228759766
