total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.4_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.1713 (20556/120000), AUC 0.4649466872215271
ep0_train_time 4.86741828918457
Test Epoch0 threshold 0.4 Acc 0.9116776315789473, AUC 0.9807828664779663, avg_entr 0.03408220410346985
ep0_t0.4_test_time 0.07793641090393066
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.4_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.1522 (18264/120000), AUC 0.4523351192474365
ep1_train_time 4.3397321701049805
Test Epoch1 threshold 0.4 Acc 0.9136513157894737, AUC 0.9809896349906921, avg_entr 0.02997601218521595
ep1_t0.4_test_time 0.07570028305053711
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.4_m2//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.17160833333333333 (20593/120000), AUC 0.4443073570728302
ep2_train_time 4.331117868423462
Test Epoch2 threshold 0.4 Acc 0.9120065789473685, AUC 0.980760931968689, avg_entr 0.02777305617928505
ep2_t0.4_test_time 0.07684898376464844
gc 0
Train Epoch3 Acc 0.19361666666666666 (23234/120000), AUC 0.4460333585739136
ep3_train_time 4.382162570953369
Test Epoch3 threshold 0.4 Acc 0.9113486842105263, AUC 0.9802858829498291, avg_entr 0.02735460177063942
ep3_t0.4_test_time 0.07524442672729492
gc 0
Train Epoch4 Acc 0.21863333333333335 (26236/120000), AUC 0.45415306091308594
ep4_train_time 4.362980604171753
Test Epoch4 threshold 0.4 Acc 0.9125, AUC 0.9796308875083923, avg_entr 0.02654234506189823
ep4_t0.4_test_time 0.07580804824829102
gc 0
Train Epoch5 Acc 0.2428 (29136/120000), AUC 0.4658885598182678
ep5_train_time 4.36643648147583
Test Epoch5 threshold 0.4 Acc 0.9106907894736842, AUC 0.9797447323799133, avg_entr 0.02739119343459606
ep5_t0.4_test_time 0.07602596282958984
gc 0
Train Epoch6 Acc 0.25908333333333333 (31090/120000), AUC 0.4749915301799774
ep6_train_time 4.639132261276245
Test Epoch6 threshold 0.4 Acc 0.9106907894736842, AUC 0.979407012462616, avg_entr 0.026273949071764946
ep6_t0.4_test_time 0.07767534255981445
gc 0
Train Epoch7 Acc 0.2683083333333333 (32197/120000), AUC 0.4815102815628052
ep7_train_time 4.610281944274902
Test Epoch7 threshold 0.4 Acc 0.9108552631578948, AUC 0.9792414307594299, avg_entr 0.025679269805550575
ep7_t0.4_test_time 0.07829594612121582
gc 0
Train Epoch8 Acc 0.27648333333333336 (33178/120000), AUC 0.48794472217559814
ep8_train_time 4.623087406158447
Test Epoch8 threshold 0.4 Acc 0.9095394736842105, AUC 0.9788573980331421, avg_entr 0.025693144649267197
ep8_t0.4_test_time 0.07707691192626953
gc 0
Train Epoch9 Acc 0.28465 (34158/120000), AUC 0.49446821212768555
ep9_train_time 4.368063688278198
Test Epoch9 threshold 0.4 Acc 0.9101973684210526, AUC 0.9789433479309082, avg_entr 0.025439690798521042
ep9_t0.4_test_time 0.07509589195251465
Best AUC 0.9809896349906921
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.4_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9223684210526316, AUC 0.9858607649803162, avg_entr 0.0312242079526186
t0.4_test_time 0.020028114318847656
