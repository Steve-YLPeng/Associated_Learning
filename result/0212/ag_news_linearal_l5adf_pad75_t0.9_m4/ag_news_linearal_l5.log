total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.9_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.17838333333333334 (21406/120000), AUC 0.6559098958969116
ep0_train_time 7.579305648803711
Test Epoch0 threshold 0.9 Acc 0.9144736842105263, AUC 0.9802341461181641, avg_entr 0.026394937187433243
ep0_t0.9_test_time 0.14059090614318848
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.9_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.19185 (23022/120000), AUC 0.6975624561309814
ep1_train_time 7.102916955947876
Test Epoch1 threshold 0.9 Acc 0.9133223684210526, AUC 0.9797369241714478, avg_entr 0.0259132981300354
ep1_t0.9_test_time 0.13244080543518066
gc 0
Train Epoch2 Acc 0.2698333333333333 (32380/120000), AUC 0.6877670884132385
ep2_train_time 7.0767927169799805
Test Epoch2 threshold 0.9 Acc 0.9134868421052632, AUC 0.9798915386199951, avg_entr 0.025567568838596344
ep2_t0.9_test_time 0.13237905502319336
gc 0
Train Epoch3 Acc 0.27236666666666665 (32684/120000), AUC 0.6389589309692383
ep3_train_time 7.069504261016846
Test Epoch3 threshold 0.9 Acc 0.9129934210526316, AUC 0.9795981645584106, avg_entr 0.026645319536328316
ep3_t0.9_test_time 0.13233494758605957
gc 0
Train Epoch4 Acc 0.26305833333333334 (31567/120000), AUC 0.623893678188324
ep4_train_time 7.153451681137085
Test Epoch4 threshold 0.9 Acc 0.9123355263157895, AUC 0.9794230461120605, avg_entr 0.026271076872944832
ep4_t0.9_test_time 0.13203668594360352
gc 0
Train Epoch5 Acc 0.261225 (31347/120000), AUC 0.6172944903373718
ep5_train_time 7.098678350448608
Test Epoch5 threshold 0.9 Acc 0.9125, AUC 0.9791687726974487, avg_entr 0.02655409276485443
ep5_t0.9_test_time 0.13439607620239258
gc 0
Train Epoch6 Acc 0.2591 (31092/120000), AUC 0.6140002012252808
ep6_train_time 7.1183021068573
Test Epoch6 threshold 0.9 Acc 0.9123355263157895, AUC 0.9790912866592407, avg_entr 0.02658037655055523
ep6_t0.9_test_time 0.13270211219787598
gc 0
Train Epoch7 Acc 0.2578166666666667 (30938/120000), AUC 0.6112337112426758
ep7_train_time 7.103126764297485
Test Epoch7 threshold 0.9 Acc 0.9110197368421052, AUC 0.978994607925415, avg_entr 0.026621151715517044
ep7_t0.9_test_time 0.13312888145446777
gc 0
Train Epoch8 Acc 0.25674166666666665 (30809/120000), AUC 0.6097195148468018
ep8_train_time 7.121725082397461
Test Epoch8 threshold 0.9 Acc 0.9100328947368421, AUC 0.9787919521331787, avg_entr 0.026285000145435333
ep8_t0.9_test_time 0.13239240646362305
gc 0
Train Epoch9 Acc 0.25566666666666665 (30680/120000), AUC 0.608610212802887
ep9_train_time 7.0455162525177
Test Epoch9 threshold 0.9 Acc 0.9106907894736842, AUC 0.9787653684616089, avg_entr 0.02627411298453808
ep9_t0.9_test_time 0.1316533088684082
Best AUC 0.9802341461181641
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.9_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9256578947368421, AUC 0.9860348701477051, avg_entr 0.02526390179991722
t0.9_test_time 0.03389453887939453
