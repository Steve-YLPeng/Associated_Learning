total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad75_t0.1_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.33894166666666664 (40673/120000), AUC 0.7990016341209412
ep0_train_time 6.7102320194244385
Test Epoch0 threshold 0.1 Acc 0.9164473684210527, AUC 0.9803901314735413, avg_entr 0.024832816794514656
ep0_t0.1_test_time 0.151015043258667
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.1_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3984666666666667 (47816/120000), AUC 0.8249721527099609
ep1_train_time 6.237321138381958
Test Epoch1 threshold 0.1 Acc 0.9138157894736842, AUC 0.9801723957061768, avg_entr 0.025165202096104622
ep1_t0.1_test_time 0.1475229263305664
gc 0
Train Epoch2 Acc 0.44028333333333336 (52834/120000), AUC 0.8298369646072388
ep2_train_time 6.162558078765869
Test Epoch2 threshold 0.1 Acc 0.9126644736842106, AUC 0.9798243045806885, avg_entr 0.02411639504134655
ep2_t0.1_test_time 0.1479659080505371
gc 0
Train Epoch3 Acc 0.43088333333333334 (51706/120000), AUC 0.8228499293327332
ep3_train_time 6.199349403381348
Test Epoch3 threshold 0.1 Acc 0.9146381578947368, AUC 0.9798734188079834, avg_entr 0.023333504796028137
ep3_t0.1_test_time 0.14744186401367188
gc 0
Train Epoch4 Acc 0.35089166666666666 (42107/120000), AUC 0.8089467287063599
ep4_train_time 6.231969833374023
Test Epoch4 threshold 0.1 Acc 0.9139802631578947, AUC 0.9795893430709839, avg_entr 0.021774087101221085
ep4_t0.1_test_time 0.14844083786010742
gc 0
Train Epoch5 Acc 0.3579583333333333 (42955/120000), AUC 0.8034847974777222
ep5_train_time 6.4479968547821045
Test Epoch5 threshold 0.1 Acc 0.9118421052631579, AUC 0.9794439077377319, avg_entr 0.021059297025203705
ep5_t0.1_test_time 0.1523604393005371
gc 0
Train Epoch6 Acc 0.41754166666666664 (50105/120000), AUC 0.8012001514434814
ep6_train_time 6.75645899772644
Test Epoch6 threshold 0.1 Acc 0.9110197368421052, AUC 0.9792920351028442, avg_entr 0.019743800163269043
ep6_t0.1_test_time 0.15273666381835938
gc 0
Train Epoch7 Acc 0.48994166666666666 (58793/120000), AUC 0.8001093864440918
ep7_train_time 6.546284198760986
Test Epoch7 threshold 0.1 Acc 0.9113486842105263, AUC 0.9791103601455688, avg_entr 0.01940624974668026
ep7_t0.1_test_time 0.14821219444274902
gc 0
Train Epoch8 Acc 0.5339 (64068/120000), AUC 0.8001362085342407
ep8_train_time 6.242551326751709
Test Epoch8 threshold 0.1 Acc 0.9101973684210526, AUC 0.9789295792579651, avg_entr 0.018507717177271843
ep8_t0.1_test_time 0.1480851173400879
gc 0
Train Epoch9 Acc 0.5485 (65820/120000), AUC 0.7997944355010986
ep9_train_time 6.220047950744629
Test Epoch9 threshold 0.1 Acc 0.9106907894736842, AUC 0.9787954092025757, avg_entr 0.01799050346016884
ep9_t0.1_test_time 0.14777064323425293
Best AUC 0.9803901314735413
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.1_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9256578947368421, AUC 0.9855484962463379, avg_entr 0.024476028978824615
t0.1_test_time 0.037481069564819336
