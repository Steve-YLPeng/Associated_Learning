total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.21439166666666667 (25727/120000), AUC 0.4916282892227173
ep0_train_time 4.243079662322998
Test Epoch0 threshold 0.9 Acc 0.9113486842105263, AUC 0.9797463417053223, avg_entr 0.1482478231191635
ep0_t0.9_test_time 0.07337665557861328
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.22106666666666666 (26528/120000), AUC 0.4965289235115051
ep1_train_time 3.8074698448181152
Test Epoch1 threshold 0.9 Acc 0.9133223684210526, AUC 0.9812517762184143, avg_entr 0.09392423182725906
ep1_t0.9_test_time 0.07099366188049316
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.9_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.22525833333333334 (27031/120000), AUC 0.4993731379508972
ep2_train_time 4.062681674957275
Test Epoch2 threshold 0.9 Acc 0.9118421052631579, AUC 0.9811006188392639, avg_entr 0.07419557124376297
ep2_t0.9_test_time 0.07480788230895996
gc 0
Train Epoch3 Acc 0.228125 (27375/120000), AUC 0.5012418627738953
ep3_train_time 4.037614822387695
Test Epoch3 threshold 0.9 Acc 0.9118421052631579, AUC 0.9806463122367859, avg_entr 0.06458588689565659
ep3_t0.9_test_time 0.07063078880310059
gc 0
Train Epoch4 Acc 0.22923333333333334 (27508/120000), AUC 0.5028154850006104
ep4_train_time 3.83339524269104
Test Epoch4 threshold 0.9 Acc 0.9125, AUC 0.9805318117141724, avg_entr 0.05854912847280502
ep4_t0.9_test_time 0.07130169868469238
gc 0
Train Epoch5 Acc 0.23046666666666665 (27656/120000), AUC 0.5043947696685791
ep5_train_time 3.837299346923828
Test Epoch5 threshold 0.9 Acc 0.9139802631578947, AUC 0.9804069995880127, avg_entr 0.052842844277620316
ep5_t0.9_test_time 0.07168436050415039
gc 0
Train Epoch6 Acc 0.23108333333333334 (27730/120000), AUC 0.5052651762962341
ep6_train_time 3.8574230670928955
Test Epoch6 threshold 0.9 Acc 0.9116776315789473, AUC 0.9802496433258057, avg_entr 0.051128096878528595
ep6_t0.9_test_time 0.07060527801513672
gc 0
Train Epoch7 Acc 0.23165833333333333 (27799/120000), AUC 0.5063002705574036
ep7_train_time 3.8151371479034424
Test Epoch7 threshold 0.9 Acc 0.9110197368421052, AUC 0.979905366897583, avg_entr 0.04819687455892563
ep7_t0.9_test_time 0.07147645950317383
gc 0
Train Epoch8 Acc 0.23204166666666667 (27845/120000), AUC 0.5071707367897034
ep8_train_time 3.8275227546691895
Test Epoch8 threshold 0.9 Acc 0.9126644736842106, AUC 0.9798777103424072, avg_entr 0.04545300453901291
ep8_t0.9_test_time 0.07168865203857422
gc 0
Train Epoch9 Acc 0.232525 (27903/120000), AUC 0.5080357193946838
ep9_train_time 3.8244783878326416
Test Epoch9 threshold 0.9 Acc 0.9113486842105263, AUC 0.9795766472816467, avg_entr 0.04402053356170654
ep9_t0.9_test_time 0.07129764556884766
Best AUC 0.9812517762184143
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.9_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9203947368421053, AUC 0.9857819080352783, avg_entr 0.09894897043704987
t0.9_test_time 0.019010543823242188
