total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.4_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.198025 (23763/120000), AUC 0.38555222749710083
ep0_train_time 6.50154447555542
Test Epoch0 threshold 0.4 Acc 0.9129934210526316, AUC 0.98008131980896, avg_entr 0.025557581335306168
ep0_t0.4_test_time 0.10958147048950195
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.4_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.20925833333333332 (25111/120000), AUC 0.39368271827697754
ep1_train_time 6.016701698303223
Test Epoch1 threshold 0.4 Acc 0.9146381578947368, AUC 0.9799581170082092, avg_entr 0.025083770975470543
ep1_t0.4_test_time 0.10638546943664551
gc 0
Train Epoch2 Acc 0.17711666666666667 (21254/120000), AUC 0.4345324635505676
ep2_train_time 6.002047061920166
Test Epoch2 threshold 0.4 Acc 0.9111842105263158, AUC 0.979744553565979, avg_entr 0.025461459532380104
ep2_t0.4_test_time 0.10670328140258789
gc 0
Train Epoch3 Acc 0.024533333333333334 (2944/120000), AUC 0.4324369430541992
ep3_train_time 6.012455701828003
Test Epoch3 threshold 0.4 Acc 0.9103618421052632, AUC 0.9794313907623291, avg_entr 0.026124240830540657
ep3_t0.4_test_time 0.10562467575073242
gc 0
Train Epoch4 Acc 0.011316666666666666 (1358/120000), AUC 0.39985644817352295
ep4_train_time 6.443521738052368
Test Epoch4 threshold 0.4 Acc 0.9125, AUC 0.9795656800270081, avg_entr 0.02508404664695263
ep4_t0.4_test_time 0.11321616172790527
gc 0
Train Epoch5 Acc 0.00995 (1194/120000), AUC 0.38325929641723633
ep5_train_time 6.520735502243042
Test Epoch5 threshold 0.4 Acc 0.9101973684210526, AUC 0.9792800545692444, avg_entr 0.024957064539194107
ep5_t0.4_test_time 0.10877633094787598
gc 0
Train Epoch6 Acc 0.009566666666666666 (1148/120000), AUC 0.3729226589202881
ep6_train_time 6.244733095169067
Test Epoch6 threshold 0.4 Acc 0.9098684210526315, AUC 0.9789773225784302, avg_entr 0.026240134611725807
ep6_t0.4_test_time 0.10750007629394531
gc 0
Train Epoch7 Acc 0.009133333333333334 (1096/120000), AUC 0.36453962326049805
ep7_train_time 6.029150009155273
Test Epoch7 threshold 0.4 Acc 0.9106907894736842, AUC 0.9790366888046265, avg_entr 0.025519704446196556
ep7_t0.4_test_time 0.1054067611694336
gc 0
Train Epoch8 Acc 0.008875 (1065/120000), AUC 0.35959434509277344
ep8_train_time 6.036185026168823
Test Epoch8 threshold 0.4 Acc 0.9105263157894737, AUC 0.9789376854896545, avg_entr 0.025810183957219124
ep8_t0.4_test_time 0.1073293685913086
gc 0
Train Epoch9 Acc 0.008658333333333334 (1039/120000), AUC 0.35758665204048157
ep9_train_time 6.059468507766724
Test Epoch9 threshold 0.4 Acc 0.9097039473684211, AUC 0.9787875413894653, avg_entr 0.025607967749238014
ep9_t0.4_test_time 0.10464811325073242
Best AUC 0.98008131980896
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.4_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9276315789473685, AUC 0.9860306978225708, avg_entr 0.024892108514904976
t0.4_test_time 0.02714395523071289
