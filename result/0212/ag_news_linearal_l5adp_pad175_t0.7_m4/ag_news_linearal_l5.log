total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.7_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.22603333333333334 (27124/120000), AUC 0.3359471559524536
ep0_train_time 9.831939220428467
Test Epoch0 threshold 0.7 Acc 0.9159539473684211, AUC 0.9807115197181702, avg_entr 0.026828579604625702
ep0_t0.7_test_time 0.2547171115875244
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.249825 (29979/120000), AUC 0.383219450712204
ep1_train_time 9.570146322250366
Test Epoch1 threshold 0.7 Acc 0.915625, AUC 0.9806163311004639, avg_entr 0.02550177089869976
ep1_t0.7_test_time 0.2543652057647705
gc 0
Train Epoch2 Acc 0.24974166666666667 (29969/120000), AUC 0.5311872959136963
ep2_train_time 9.528050422668457
Test Epoch2 threshold 0.7 Acc 0.9162828947368421, AUC 0.9804310202598572, avg_entr 0.025333454832434654
ep2_t0.7_test_time 0.2531156539916992
gc 0
Train Epoch3 Acc 0.24946666666666667 (29936/120000), AUC 0.5621557235717773
ep3_train_time 9.983600854873657
Test Epoch3 threshold 0.7 Acc 0.9139802631578947, AUC 0.9802340865135193, avg_entr 0.025212930515408516
ep3_t0.7_test_time 0.2530858516693115
gc 0
Train Epoch4 Acc 0.2743833333333333 (32926/120000), AUC 0.49384039640426636
ep4_train_time 9.544621467590332
Test Epoch4 threshold 0.7 Acc 0.9143092105263158, AUC 0.9799970388412476, avg_entr 0.026839934289455414
ep4_t0.7_test_time 0.253368616104126
gc 0
Train Epoch5 Acc 0.3345 (40140/120000), AUC 0.4692320227622986
ep5_train_time 9.455379724502563
Test Epoch5 threshold 0.7 Acc 0.9146381578947368, AUC 0.9800602197647095, avg_entr 0.0260346420109272
ep5_t0.7_test_time 0.25466370582580566
gc 0
Train Epoch6 Acc 0.36894166666666667 (44273/120000), AUC 0.4660460352897644
ep6_train_time 9.495527505874634
Test Epoch6 threshold 0.7 Acc 0.912828947368421, AUC 0.9799144268035889, avg_entr 0.02638108842074871
ep6_t0.7_test_time 0.25333189964294434
gc 0
Train Epoch7 Acc 0.381125 (45735/120000), AUC 0.4650481343269348
ep7_train_time 9.539411783218384
Test Epoch7 threshold 0.7 Acc 0.9143092105263158, AUC 0.9798011779785156, avg_entr 0.02562139742076397
ep7_t0.7_test_time 0.25377988815307617
gc 0
Train Epoch8 Acc 0.38483333333333336 (46180/120000), AUC 0.4671708941459656
ep8_train_time 9.451706647872925
Test Epoch8 threshold 0.7 Acc 0.9131578947368421, AUC 0.9797155261039734, avg_entr 0.025572219863533974
ep8_t0.7_test_time 0.25327134132385254
gc 0
Train Epoch9 Acc 0.387075 (46449/120000), AUC 0.46930062770843506
ep9_train_time 9.630692958831787
Test Epoch9 threshold 0.7 Acc 0.9134868421052632, AUC 0.979647696018219, avg_entr 0.026289595291018486
ep9_t0.7_test_time 0.2604997158050537
Best AUC 0.9807115197181702
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.7_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9289473684210526, AUC 0.9864435195922852, avg_entr 0.024960286915302277
t0.7_test_time 0.06596946716308594
