total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.3_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9179916666666667 (110159/120000), AUC 0.9853000640869141
ep0_train_time 10.355100393295288
Test Epoch0 threshold 0.3 Acc 0.9138157894736842, AUC 0.9803693294525146, avg_entr 0.024282356724143028
ep0_t0.3_test_time 0.26975178718566895
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.3_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9510166666666666 (114122/120000), AUC 0.9933159351348877
ep1_train_time 10.058323621749878
Test Epoch1 threshold 0.3 Acc 0.9129934210526316, AUC 0.9801912903785706, avg_entr 0.02503577619791031
ep1_t0.3_test_time 0.2687568664550781
gc 0
Train Epoch2 Acc 0.9520916666666667 (114251/120000), AUC 0.9933513402938843
ep2_train_time 9.882426500320435
Test Epoch2 threshold 0.3 Acc 0.9141447368421053, AUC 0.9801006317138672, avg_entr 0.024539398029446602
ep2_t0.3_test_time 0.2693312168121338
gc 0
Train Epoch3 Acc 0.9530833333333333 (114370/120000), AUC 0.9936581254005432
ep3_train_time 10.049890518188477
Test Epoch3 threshold 0.3 Acc 0.9148026315789474, AUC 0.9801396131515503, avg_entr 0.025380345061421394
ep3_t0.3_test_time 0.26952147483825684
gc 0
Train Epoch4 Acc 0.9541833333333334 (114502/120000), AUC 0.9940778613090515
ep4_train_time 10.043116807937622
Test Epoch4 threshold 0.3 Acc 0.9121710526315789, AUC 0.9797911643981934, avg_entr 0.023810023441910744
ep4_t0.3_test_time 0.2644822597503662
gc 0
Train Epoch5 Acc 0.9557416666666667 (114689/120000), AUC 0.9947377443313599
ep5_train_time 10.140068292617798
Test Epoch5 threshold 0.3 Acc 0.9131578947368421, AUC 0.979730486869812, avg_entr 0.02539614401757717
ep5_t0.3_test_time 0.2650277614593506
gc 0
Train Epoch6 Acc 0.9564666666666667 (114776/120000), AUC 0.9948805570602417
ep6_train_time 10.015417098999023
Test Epoch6 threshold 0.3 Acc 0.9125, AUC 0.9795781373977661, avg_entr 0.02516074664890766
ep6_t0.3_test_time 0.26343870162963867
gc 0
Train Epoch7 Acc 0.9568166666666666 (114818/120000), AUC 0.9950224757194519
ep7_train_time 10.043460845947266
Test Epoch7 threshold 0.3 Acc 0.9113486842105263, AUC 0.9794837832450867, avg_entr 0.024256419390439987
ep7_t0.3_test_time 0.2626063823699951
gc 0
Train Epoch8 Acc 0.9571666666666667 (114860/120000), AUC 0.99501633644104
ep8_train_time 10.019698858261108
Test Epoch8 threshold 0.3 Acc 0.9111842105263158, AUC 0.9794455766677856, avg_entr 0.02417701855301857
ep8_t0.3_test_time 0.26476049423217773
gc 0
Train Epoch9 Acc 0.9584333333333334 (115012/120000), AUC 0.9954192638397217
ep9_train_time 10.085813283920288
Test Epoch9 threshold 0.3 Acc 0.9108552631578948, AUC 0.9793441891670227, avg_entr 0.024640431627631187
ep9_t0.3_test_time 0.26219964027404785
Best AUC 0.9803693294525146
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.3_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9217105263157894, AUC 0.9855201840400696, avg_entr 0.023944756016135216
t0.3_test_time 0.06936407089233398
