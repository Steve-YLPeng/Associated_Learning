total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.1_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9014416666666667 (108173/120000), AUC 0.9852410554885864
ep0_train_time 8.357800960540771
Test Epoch0 threshold 0.1 Acc 0.915625, AUC 0.9799875020980835, avg_entr 0.02031043916940689
ep0_t0.1_test_time 0.1926274299621582
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.1_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9499333333333333 (113992/120000), AUC 0.9929279685020447
ep1_train_time 7.948653697967529
Test Epoch1 threshold 0.1 Acc 0.9149671052631579, AUC 0.9799761772155762, avg_entr 0.015305440872907639
ep1_t0.1_test_time 0.19196796417236328
gc 0
Train Epoch2 Acc 0.95105 (114126/120000), AUC 0.9932596683502197
ep2_train_time 7.895580291748047
Test Epoch2 threshold 0.1 Acc 0.9146381578947368, AUC 0.9796675443649292, avg_entr 0.012933826074004173
ep2_t0.1_test_time 0.1923084259033203
gc 0
Train Epoch3 Acc 0.9525833333333333 (114310/120000), AUC 0.9933743476867676
ep3_train_time 7.884159564971924
Test Epoch3 threshold 0.1 Acc 0.9136513157894737, AUC 0.9794673919677734, avg_entr 0.012293186970055103
ep3_t0.1_test_time 0.1903548240661621
gc 0
Train Epoch4 Acc 0.9537583333333334 (114451/120000), AUC 0.993780255317688
ep4_train_time 7.852280378341675
Test Epoch4 threshold 0.1 Acc 0.9105263157894737, AUC 0.9790045022964478, avg_entr 0.011603744700551033
ep4_t0.1_test_time 0.19125771522521973
gc 0
Train Epoch5 Acc 0.955975 (114717/120000), AUC 0.9945759177207947
ep5_train_time 8.6908860206604
Test Epoch5 threshold 0.1 Acc 0.9115131578947369, AUC 0.9790462255477905, avg_entr 0.01151205226778984
ep5_t0.1_test_time 0.20539093017578125
gc 0
Train Epoch6 Acc 0.956 (114720/120000), AUC 0.9946471452713013
ep6_train_time 9.100489377975464
Test Epoch6 threshold 0.1 Acc 0.9118421052631579, AUC 0.979138195514679, avg_entr 0.01155561301857233
ep6_t0.1_test_time 0.20529937744140625
gc 0
Train Epoch7 Acc 0.9564583333333333 (114775/120000), AUC 0.9948359727859497
ep7_train_time 8.308448553085327
Test Epoch7 threshold 0.1 Acc 0.9113486842105263, AUC 0.9786140322685242, avg_entr 0.011079228483140469
ep7_t0.1_test_time 0.19373750686645508
gc 0
Train Epoch8 Acc 0.9569083333333334 (114829/120000), AUC 0.9950472116470337
ep8_train_time 8.327900648117065
Test Epoch8 threshold 0.1 Acc 0.9118421052631579, AUC 0.9787654876708984, avg_entr 0.010891866870224476
ep8_t0.1_test_time 0.19534707069396973
gc 0
Train Epoch9 Acc 0.958125 (114975/120000), AUC 0.9952875375747681
ep9_train_time 8.318867206573486
Test Epoch9 threshold 0.1 Acc 0.9113486842105263, AUC 0.9784393310546875, avg_entr 0.010477464646100998
ep9_t0.1_test_time 0.19158697128295898
Best AUC 0.9799875020980835
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.1_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9236842105263158, AUC 0.9857807159423828, avg_entr 0.020075369626283646
t0.1_test_time 0.04877066612243652
