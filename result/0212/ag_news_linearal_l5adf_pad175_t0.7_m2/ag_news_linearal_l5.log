total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.7_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.2502 (30024/120000), AUC 0.34989339113235474
ep0_train_time 8.994563102722168
Test Epoch0 threshold 0.7 Acc 0.9167763157894737, AUC 0.980967104434967, avg_entr 0.028957055881619453
ep0_t0.7_test_time 0.2525043487548828
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.250125 (30015/120000), AUC 0.35647839307785034
ep1_train_time 8.49379825592041
Test Epoch1 threshold 0.7 Acc 0.9166118421052631, AUC 0.98084956407547, avg_entr 0.026933517307043076
ep1_t0.7_test_time 0.25000739097595215
gc 0
Train Epoch2 Acc 0.25009166666666666 (30011/120000), AUC 0.3572659492492676
ep2_train_time 8.423558235168457
Test Epoch2 threshold 0.7 Acc 0.9167763157894737, AUC 0.9808235168457031, avg_entr 0.026949014514684677
ep2_t0.7_test_time 0.25020813941955566
gc 0
Train Epoch3 Acc 0.2500833333333333 (30010/120000), AUC 0.3590012192726135
ep3_train_time 8.521687030792236
Test Epoch3 threshold 0.7 Acc 0.9162828947368421, AUC 0.9807044863700867, avg_entr 0.026118125766515732
ep3_t0.7_test_time 0.25048017501831055
gc 0
Train Epoch4 Acc 0.250225 (30027/120000), AUC 0.36054715514183044
ep4_train_time 8.816728115081787
Test Epoch4 threshold 0.7 Acc 0.9179276315789474, AUC 0.980716347694397, avg_entr 0.02613060176372528
ep4_t0.7_test_time 0.2503335475921631
gc 0
Train Epoch5 Acc 0.25033333333333335 (30040/120000), AUC 0.36168381571769714
ep5_train_time 8.619767904281616
Test Epoch5 threshold 0.7 Acc 0.9162828947368421, AUC 0.9806031584739685, avg_entr 0.026401951909065247
ep5_t0.7_test_time 0.24976444244384766
gc 0
Train Epoch6 Acc 0.25045833333333334 (30055/120000), AUC 0.36286598443984985
ep6_train_time 8.69527554512024
Test Epoch6 threshold 0.7 Acc 0.915296052631579, AUC 0.9804432988166809, avg_entr 0.02639077790081501
ep6_t0.7_test_time 0.24981117248535156
gc 0
Train Epoch7 Acc 0.25061666666666665 (30074/120000), AUC 0.3639989197254181
ep7_train_time 8.377891302108765
Test Epoch7 threshold 0.7 Acc 0.9154605263157894, AUC 0.9802201986312866, avg_entr 0.02597246877849102
ep7_t0.7_test_time 0.2502882480621338
gc 0
Train Epoch8 Acc 0.25090833333333334 (30109/120000), AUC 0.3646206259727478
ep8_train_time 8.48237657546997
Test Epoch8 threshold 0.7 Acc 0.9144736842105263, AUC 0.9801722764968872, avg_entr 0.025840548798441887
ep8_t0.7_test_time 0.24959158897399902
gc 0
Train Epoch9 Acc 0.251125 (30135/120000), AUC 0.36506789922714233
ep9_train_time 8.50720763206482
Test Epoch9 threshold 0.7 Acc 0.915296052631579, AUC 0.9801537394523621, avg_entr 0.026106322184205055
ep9_t0.7_test_time 0.24962735176086426
Best AUC 0.980967104434967
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.7_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.7 Acc 0.9236842105263158, AUC 0.9867300987243652, avg_entr 0.030294330790638924
t0.7_test_time 0.06410765647888184
