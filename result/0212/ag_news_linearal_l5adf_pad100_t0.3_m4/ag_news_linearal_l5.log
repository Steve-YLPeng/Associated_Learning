total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad100_t0.3_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.33165 (39798/120000), AUC 0.647636353969574
ep0_train_time 8.172616481781006
Test Epoch0 threshold 0.3 Acc 0.9161184210526315, AUC 0.9803591966629028, avg_entr 0.025432325899600983
ep0_t0.3_test_time 0.17683792114257812
Save ckpt to ckpt/ag_news_linearal_l5adf_pad100_t0.3_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.22525 (27030/120000), AUC 0.6833807826042175
ep1_train_time 7.714133024215698
Test Epoch1 threshold 0.3 Acc 0.9148026315789474, AUC 0.9801203012466431, avg_entr 0.02501545660197735
ep1_t0.3_test_time 0.1752164363861084
gc 0
Train Epoch2 Acc 0.20629166666666668 (24755/120000), AUC 0.6715185642242432
ep2_train_time 7.74861478805542
Test Epoch2 threshold 0.3 Acc 0.9136513157894737, AUC 0.9800329804420471, avg_entr 0.025693556293845177
ep2_t0.3_test_time 0.17607402801513672
gc 0
Train Epoch3 Acc 0.12548333333333334 (15058/120000), AUC 0.6307170391082764
ep3_train_time 7.710496187210083
Test Epoch3 threshold 0.3 Acc 0.9148026315789474, AUC 0.9796912670135498, avg_entr 0.02539972960948944
ep3_t0.3_test_time 0.17406368255615234
gc 0
Train Epoch4 Acc 0.07715 (9258/120000), AUC 0.5881711840629578
ep4_train_time 7.774513006210327
Test Epoch4 threshold 0.3 Acc 0.9129934210526316, AUC 0.9797728657722473, avg_entr 0.024863209575414658
ep4_t0.3_test_time 0.1769707202911377
gc 0
Train Epoch5 Acc 0.059008333333333336 (7081/120000), AUC 0.5655596256256104
ep5_train_time 7.779004096984863
Test Epoch5 threshold 0.3 Acc 0.9133223684210526, AUC 0.9795575141906738, avg_entr 0.025636130943894386
ep5_t0.3_test_time 0.1752314567565918
gc 0
Train Epoch6 Acc 0.051616666666666665 (6194/120000), AUC 0.5519078969955444
ep6_train_time 7.710436105728149
Test Epoch6 threshold 0.3 Acc 0.9118421052631579, AUC 0.979442298412323, avg_entr 0.024618661031126976
ep6_t0.3_test_time 0.1722116470336914
gc 0
Train Epoch7 Acc 0.04691666666666667 (5630/120000), AUC 0.5415531992912292
ep7_train_time 7.769917964935303
Test Epoch7 threshold 0.3 Acc 0.9121710526315789, AUC 0.9792732000350952, avg_entr 0.024199282750487328
ep7_t0.3_test_time 0.17490100860595703
gc 0
Train Epoch8 Acc 0.043625 (5235/120000), AUC 0.5349240303039551
ep8_train_time 7.803380012512207
Test Epoch8 threshold 0.3 Acc 0.9105263157894737, AUC 0.9791290163993835, avg_entr 0.024927787482738495
ep8_t0.3_test_time 0.171339750289917
gc 0
Train Epoch9 Acc 0.041966666666666666 (5036/120000), AUC 0.5316950678825378
ep9_train_time 7.669527530670166
Test Epoch9 threshold 0.3 Acc 0.9103618421052632, AUC 0.979056179523468, avg_entr 0.02510104514658451
ep9_t0.3_test_time 0.171539306640625
Best AUC 0.9803591966629028
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad100_t0.3_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9223684210526316, AUC 0.9856705665588379, avg_entr 0.025252819061279297
t0.3_test_time 0.04507184028625488
