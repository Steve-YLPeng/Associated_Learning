total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24998333333333334 (29998/120000), AUC 0.45257407426834106
ep0_train_time 4.918838262557983
Test Epoch0 threshold 0.8 Acc 0.9110197368421052, AUC 0.977903425693512, avg_entr 0.1583571583032608
ep0_t0.8_test_time 0.10639190673828125
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.249975 (29997/120000), AUC 0.4157752990722656
ep1_train_time 4.480006456375122
Test Epoch1 threshold 0.8 Acc 0.9146381578947368, AUC 0.979791522026062, avg_entr 0.0962422788143158
ep1_t0.8_test_time 0.10138392448425293
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.249975 (29997/120000), AUC 0.41200894117355347
ep2_train_time 4.512767553329468
Test Epoch2 threshold 0.8 Acc 0.9126644736842106, AUC 0.9802937507629395, avg_entr 0.07769405096769333
ep2_t0.8_test_time 0.10156631469726562
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.8_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.24995 (29994/120000), AUC 0.4102836549282074
ep3_train_time 4.797296762466431
Test Epoch3 threshold 0.8 Acc 0.9159539473684211, AUC 0.9801083207130432, avg_entr 0.06593464314937592
ep3_t0.8_test_time 0.1048882007598877
gc 0
Train Epoch4 Acc 0.24995833333333334 (29995/120000), AUC 0.4096941351890564
ep4_train_time 4.692330837249756
Test Epoch4 threshold 0.8 Acc 0.9138157894736842, AUC 0.9798833727836609, avg_entr 0.058149371296167374
ep4_t0.8_test_time 0.10123300552368164
gc 0
Train Epoch5 Acc 0.24990833333333334 (29989/120000), AUC 0.4086115062236786
ep5_train_time 4.67732572555542
Test Epoch5 threshold 0.8 Acc 0.9131578947368421, AUC 0.9798068404197693, avg_entr 0.054043177515268326
ep5_t0.8_test_time 0.10312056541442871
gc 0
Train Epoch6 Acc 0.249825 (29979/120000), AUC 0.4078582227230072
ep6_train_time 4.695000171661377
Test Epoch6 threshold 0.8 Acc 0.9131578947368421, AUC 0.9798212051391602, avg_entr 0.049090202897787094
ep6_t0.8_test_time 0.10256457328796387
gc 0
Train Epoch7 Acc 0.24979166666666666 (29975/120000), AUC 0.4069440960884094
ep7_train_time 4.691463470458984
Test Epoch7 threshold 0.8 Acc 0.9121710526315789, AUC 0.9794613718986511, avg_entr 0.04810643568634987
ep7_t0.8_test_time 0.10272836685180664
gc 0
Train Epoch8 Acc 0.24975 (29970/120000), AUC 0.40742027759552
ep8_train_time 4.601622819900513
Test Epoch8 threshold 0.8 Acc 0.9125, AUC 0.9794489145278931, avg_entr 0.04566268250346184
ep8_t0.8_test_time 0.10108351707458496
gc 0
Train Epoch9 Acc 0.24968333333333334 (29962/120000), AUC 0.4075489640235901
ep9_train_time 4.568174839019775
Test Epoch9 threshold 0.8 Acc 0.9126644736842106, AUC 0.9793992638587952, avg_entr 0.043566323816776276
ep9_t0.8_test_time 0.10187411308288574
Best AUC 0.9802937507629395
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.8_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.8 Acc 0.9236842105263158, AUC 0.9864247441291809, avg_entr 0.07915796339511871
t0.8_test_time 0.026422977447509766
