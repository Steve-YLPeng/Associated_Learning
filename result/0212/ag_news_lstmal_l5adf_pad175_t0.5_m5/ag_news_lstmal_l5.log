total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad175_t0.5_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9152416666666666 (109829/120000), AUC 0.983339786529541
ep0_train_time 88.19455599784851
Test Epoch0 threshold 0.5 Acc 0.912828947368421, AUC 0.9805136919021606, avg_entr 0.024492789059877396
ep0_t0.5_test_time 0.2626383304595947
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad175_t0.5_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9559333333333333 (114712/120000), AUC 0.9922988414764404
ep1_train_time 88.07526969909668
Test Epoch1 threshold 0.5 Acc 0.9154605263157894, AUC 0.9804815649986267, avg_entr 0.02587185986340046
ep1_t0.5_test_time 0.2665097713470459
gc 0
Train Epoch2 Acc 0.958525 (115023/120000), AUC 0.9931005239486694
ep2_train_time 88.14540791511536
Test Epoch2 threshold 0.5 Acc 0.9159539473684211, AUC 0.9804514646530151, avg_entr 0.02609582617878914
ep2_t0.5_test_time 0.26262831687927246
gc 0
Train Epoch3 Acc 0.9609166666666666 (115310/120000), AUC 0.9935407638549805
ep3_train_time 88.19387531280518
Test Epoch3 threshold 0.5 Acc 0.9144736842105263, AUC 0.9802438020706177, avg_entr 0.02577333152294159
ep3_t0.5_test_time 0.2574119567871094
gc 0
Train Epoch4 Acc 0.9628666666666666 (115544/120000), AUC 0.9939621686935425
ep4_train_time 88.13210821151733
Test Epoch4 threshold 0.5 Acc 0.9125, AUC 0.980185329914093, avg_entr 0.025982320308685303
ep4_t0.5_test_time 0.25261926651000977
gc 0
Train Epoch5 Acc 0.96635 (115962/120000), AUC 0.9946123361587524
ep5_train_time 88.06222939491272
Test Epoch5 threshold 0.5 Acc 0.9143092105263158, AUC 0.9800727367401123, avg_entr 0.025567229837179184
ep5_t0.5_test_time 0.26217126846313477
gc 0
Train Epoch6 Acc 0.9674583333333333 (116095/120000), AUC 0.9948191046714783
ep6_train_time 88.21277189254761
Test Epoch6 threshold 0.5 Acc 0.9141447368421053, AUC 0.9799491167068481, avg_entr 0.025292953476309776
ep6_t0.5_test_time 0.2554757595062256
gc 0
Train Epoch7 Acc 0.9689333333333333 (116272/120000), AUC 0.9950366020202637
ep7_train_time 88.27566194534302
Test Epoch7 threshold 0.5 Acc 0.9129934210526316, AUC 0.979853630065918, avg_entr 0.025990262627601624
ep7_t0.5_test_time 0.25974583625793457
gc 0
Train Epoch8 Acc 0.9697583333333334 (116371/120000), AUC 0.9951659440994263
ep8_train_time 88.18754720687866
Test Epoch8 threshold 0.5 Acc 0.912828947368421, AUC 0.9797450304031372, avg_entr 0.026033099740743637
ep8_t0.5_test_time 0.25776100158691406
gc 0
Train Epoch9 Acc 0.9720166666666666 (116642/120000), AUC 0.9955724477767944
ep9_train_time 88.20349860191345
Test Epoch9 threshold 0.5 Acc 0.9136513157894737, AUC 0.9797140955924988, avg_entr 0.025788329541683197
ep9_t0.5_test_time 0.2620718479156494
Best AUC 0.9805136919021606
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad175_t0.5_m5//ag_news_lstmal_l5_prefix.pt
Test threshold 0.5 Acc 0.9210526315789473, AUC 0.985766589641571, avg_entr 0.02446085773408413
t0.5_test_time 0.06322455406188965
