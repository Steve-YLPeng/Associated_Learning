total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.24399166666666666 (29279/120000), AUC 0.5277896523475647
ep0_train_time 5.6026530265808105
Test Epoch0 threshold 0.1 Acc 0.9080592105263158, AUC 0.976599931716919, avg_entr 0.1628958284854889
ep0_t0.1_test_time 0.13280558586120605
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2663333333333333 (31960/120000), AUC 0.5440769791603088
ep1_train_time 5.159704208374023
Test Epoch1 threshold 0.1 Acc 0.9113486842105263, AUC 0.9790536761283875, avg_entr 0.09910554438829422
ep1_t0.1_test_time 0.1308121681213379
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.28178333333333333 (33814/120000), AUC 0.5496799945831299
ep2_train_time 5.295915603637695
Test Epoch2 threshold 0.1 Acc 0.9149671052631579, AUC 0.9800524115562439, avg_entr 0.07874468713998795
ep2_t0.1_test_time 0.13942980766296387
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.2909833333333333 (34918/120000), AUC 0.553048312664032
ep3_train_time 5.576336145401001
Test Epoch3 threshold 0.1 Acc 0.9167763157894737, AUC 0.9802902340888977, avg_entr 0.06688274443149567
ep3_t0.1_test_time 0.13109421730041504
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.29936666666666667 (35924/120000), AUC 0.555511474609375
ep4_train_time 5.154391288757324
Test Epoch4 threshold 0.1 Acc 0.915625, AUC 0.9804797172546387, avg_entr 0.05966546759009361
ep4_t0.1_test_time 0.13043832778930664
Save ckpt to ckpt/ag_news_linearal_l5adf_pad75_t0.1_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.30573333333333336 (36688/120000), AUC 0.5577216148376465
ep5_train_time 5.264890909194946
Test Epoch5 threshold 0.1 Acc 0.9129934210526316, AUC 0.9799667000770569, avg_entr 0.05530890077352524
ep5_t0.1_test_time 0.13032746315002441
gc 0
Train Epoch6 Acc 0.31285833333333335 (37543/120000), AUC 0.5596203804016113
ep6_train_time 5.193507194519043
Test Epoch6 threshold 0.1 Acc 0.9139802631578947, AUC 0.9800126552581787, avg_entr 0.05037941038608551
ep6_t0.1_test_time 0.13201522827148438
gc 0
Train Epoch7 Acc 0.3178916666666667 (38147/120000), AUC 0.5612865090370178
ep7_train_time 5.21745753288269
Test Epoch7 threshold 0.1 Acc 0.9131578947368421, AUC 0.9798174500465393, avg_entr 0.045366689562797546
ep7_t0.1_test_time 0.13106989860534668
gc 0
Train Epoch8 Acc 0.322975 (38757/120000), AUC 0.5631657838821411
ep8_train_time 5.1883864402771
Test Epoch8 threshold 0.1 Acc 0.9131578947368421, AUC 0.9800716638565063, avg_entr 0.04434230178594589
ep8_t0.1_test_time 0.13123130798339844
gc 0
Train Epoch9 Acc 0.3264166666666667 (39170/120000), AUC 0.5642462372779846
ep9_train_time 5.228110074996948
Test Epoch9 threshold 0.1 Acc 0.9118421052631579, AUC 0.9796183705329895, avg_entr 0.042613934725522995
ep9_t0.1_test_time 0.13052105903625488
Best AUC 0.9804797172546387
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad75_t0.1_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9269736842105263, AUC 0.9858278036117554, avg_entr 0.061589647084474564
t0.1_test_time 0.03380155563354492
