total count words 102019
vocab size 30000
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0}
gc 0
Train Epoch0 Acc 0.25011666666666665 (30014/120000), AUC 0.41896742582321167
ep0_train_time 8.406668663024902
Test Epoch0 threshold 0.4 Acc 0.899671052631579, AUC 0.9740155935287476, avg_entr 0.18167370557785034
ep0_t0.4_test_time 0.2512226104736328
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.25148333333333334 (30178/120000), AUC 0.34721171855926514
ep1_train_time 8.125075817108154
Test Epoch1 threshold 0.4 Acc 0.9097039473684211, AUC 0.9778096079826355, avg_entr 0.10429425537586212
ep1_t0.4_test_time 0.2497272491455078
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.252675 (30321/120000), AUC 0.3531809449195862
ep2_train_time 8.088676452636719
Test Epoch2 threshold 0.4 Acc 0.9141447368421053, AUC 0.9794778823852539, avg_entr 0.08032325655221939
ep2_t0.4_test_time 0.24943900108337402
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.25376666666666664 (30452/120000), AUC 0.3586604595184326
ep3_train_time 8.023416996002197
Test Epoch3 threshold 0.4 Acc 0.9159539473684211, AUC 0.9801735877990723, avg_entr 0.06610654294490814
ep3_t0.4_test_time 0.24941635131835938
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.25475 (30570/120000), AUC 0.3634990453720093
ep4_train_time 8.076595544815063
Test Epoch4 threshold 0.4 Acc 0.9169407894736842, AUC 0.9806175231933594, avg_entr 0.05828159675002098
ep4_t0.4_test_time 0.24884915351867676
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.2559416666666667 (30713/120000), AUC 0.3680051565170288
ep5_train_time 7.89704966545105
Test Epoch5 threshold 0.4 Acc 0.9159539473684211, AUC 0.9806983470916748, avg_entr 0.05336495116353035
ep5_t0.4_test_time 0.24954915046691895
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.2574166666666667 (30890/120000), AUC 0.372241735458374
ep6_train_time 8.067347049713135
Test Epoch6 threshold 0.4 Acc 0.9161184210526315, AUC 0.9808998703956604, avg_entr 0.04917176067829132
ep6_t0.4_test_time 0.24882817268371582
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.258475 (31017/120000), AUC 0.3765053153038025
ep7_train_time 8.023954391479492
Test Epoch7 threshold 0.4 Acc 0.9164473684210527, AUC 0.980638861656189, avg_entr 0.044684890657663345
ep7_t0.4_test_time 0.2495265007019043
gc 0
Train Epoch8 Acc 0.25983333333333336 (31180/120000), AUC 0.3805996775627136
ep8_train_time 8.09676194190979
Test Epoch8 threshold 0.4 Acc 0.9171052631578948, AUC 0.9806146621704102, avg_entr 0.04232896864414215
ep8_t0.4_test_time 0.24888396263122559
gc 0
Train Epoch9 Acc 0.2608916666666667 (31307/120000), AUC 0.38424795866012573
ep9_train_time 8.003147602081299
Test Epoch9 threshold 0.4 Acc 0.9164473684210527, AUC 0.9805970788002014, avg_entr 0.04063577577471733
ep9_t0.4_test_time 0.25780487060546875
Best AUC 0.9808998703956604
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.4_m1//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9243421052631579, AUC 0.9866669774055481, avg_entr 0.05082598328590393
t0.4_test_time 0.06630825996398926
