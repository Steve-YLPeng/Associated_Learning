total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad50_t0.9_m2//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.2552333333333333 (30628/120000), AUC 0.3567501902580261
ep0_train_time 23.6569402217865
Test Epoch0 threshold 0.9 Acc 0.9159539473684211, AUC 0.980712890625, avg_entr 0.026142364367842674
ep0_t0.9_test_time 0.10387372970581055
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad50_t0.9_m3//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3154 (37848/120000), AUC 0.3166683614253998
ep1_train_time 23.4748854637146
Test Epoch1 threshold 0.9 Acc 0.9144736842105263, AUC 0.9805044531822205, avg_entr 0.026571577414870262
ep1_t0.9_test_time 0.10180878639221191
gc 0
Train Epoch2 Acc 0.340225 (40827/120000), AUC 0.32209575176239014
ep2_train_time 23.47921347618103
Test Epoch2 threshold 0.9 Acc 0.9126644736842106, AUC 0.9802171587944031, avg_entr 0.02664131671190262
ep2_t0.9_test_time 0.10155463218688965
gc 0
Train Epoch3 Acc 0.3236 (38832/120000), AUC 0.334171861410141
ep3_train_time 23.36364483833313
Test Epoch3 threshold 0.9 Acc 0.9143092105263158, AUC 0.9800775051116943, avg_entr 0.026076575741171837
ep3_t0.9_test_time 0.1019892692565918
gc 0
Train Epoch4 Acc 0.31400833333333333 (37681/120000), AUC 0.34265533089637756
ep4_train_time 23.333346366882324
Test Epoch4 threshold 0.9 Acc 0.9138157894736842, AUC 0.9797108769416809, avg_entr 0.025798175483942032
ep4_t0.9_test_time 0.10048127174377441
gc 0
Train Epoch5 Acc 0.29728333333333334 (35674/120000), AUC 0.34136709570884705
ep5_train_time 23.324820280075073
Test Epoch5 threshold 0.9 Acc 0.9136513157894737, AUC 0.9796624183654785, avg_entr 0.02613508142530918
ep5_t0.9_test_time 0.10143852233886719
gc 0
Train Epoch6 Acc 0.33215833333333333 (39859/120000), AUC 0.35667333006858826
ep6_train_time 23.517680883407593
Test Epoch6 threshold 0.9 Acc 0.9136513157894737, AUC 0.9793280363082886, avg_entr 0.026756444945931435
ep6_t0.9_test_time 0.10477137565612793
gc 0
Train Epoch7 Acc 0.35239166666666666 (42287/120000), AUC 0.3661482632160187
ep7_train_time 23.676628828048706
Test Epoch7 threshold 0.9 Acc 0.9111842105263158, AUC 0.9792341589927673, avg_entr 0.02653433382511139
ep7_t0.9_test_time 0.10100603103637695
gc 0
Train Epoch8 Acc 0.3636666666666667 (43640/120000), AUC 0.3702276349067688
ep8_train_time 23.70487356185913
Test Epoch8 threshold 0.9 Acc 0.9110197368421052, AUC 0.9790690541267395, avg_entr 0.02705751173198223
ep8_t0.9_test_time 0.10146546363830566
gc 0
Train Epoch9 Acc 0.3611666666666667 (43340/120000), AUC 0.36555278301239014
ep9_train_time 23.592625617980957
Test Epoch9 threshold 0.9 Acc 0.9111842105263158, AUC 0.9790334105491638, avg_entr 0.026240762323141098
ep9_t0.9_test_time 0.10428953170776367
Best AUC 0.980712890625
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad50_t0.9_m3//ag_news_lstmal_l5_prefix.pt
Test threshold 0.9 Acc 0.9282894736842106, AUC 0.9869379997253418, avg_entr 0.025129999965429306
t0.9_test_time 0.027402877807617188
