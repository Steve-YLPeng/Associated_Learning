total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.6_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9247666666666666 (110972/120000), AUC 0.9858483076095581
ep0_train_time 10.27295446395874
Test Epoch0 threshold 0.6 Acc 0.9138157894736842, AUC 0.980224609375, avg_entr 0.025747226551175117
ep0_t0.6_test_time 0.25397515296936035
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9517666666666666 (114212/120000), AUC 0.993455171585083
ep1_train_time 10.22296929359436
Test Epoch1 threshold 0.6 Acc 0.9141447368421053, AUC 0.9801034927368164, avg_entr 0.025022339075803757
ep1_t0.6_test_time 0.2521333694458008
gc 0
Train Epoch2 Acc 0.952625 (114315/120000), AUC 0.9933921098709106
ep2_train_time 10.047048091888428
Test Epoch2 threshold 0.6 Acc 0.9138157894736842, AUC 0.9799690246582031, avg_entr 0.026039743795990944
ep2_t0.6_test_time 0.2517528533935547
gc 0
Train Epoch3 Acc 0.9533333333333334 (114400/120000), AUC 0.9937307834625244
ep3_train_time 9.895453691482544
Test Epoch3 threshold 0.6 Acc 0.9138157894736842, AUC 0.9797295928001404, avg_entr 0.02581845410168171
ep3_t0.6_test_time 0.25185108184814453
gc 0
Train Epoch4 Acc 0.95485 (114582/120000), AUC 0.9941456317901611
ep4_train_time 10.097035646438599
Test Epoch4 threshold 0.6 Acc 0.9123355263157895, AUC 0.9797598123550415, avg_entr 0.024695849046111107
ep4_t0.6_test_time 0.25238728523254395
gc 0
Train Epoch5 Acc 0.9563 (114756/120000), AUC 0.994758665561676
ep5_train_time 10.001989603042603
Test Epoch5 threshold 0.6 Acc 0.9133223684210526, AUC 0.9796192049980164, avg_entr 0.026161734014749527
ep5_t0.6_test_time 0.25278449058532715
gc 0
Train Epoch6 Acc 0.9568416666666667 (114821/120000), AUC 0.9948920011520386
ep6_train_time 9.92996597290039
Test Epoch6 threshold 0.6 Acc 0.9126644736842106, AUC 0.9794837832450867, avg_entr 0.025510188192129135
ep6_t0.6_test_time 0.25159215927124023
gc 0
Train Epoch7 Acc 0.95725 (114870/120000), AUC 0.9949744343757629
ep7_train_time 10.214645624160767
Test Epoch7 threshold 0.6 Acc 0.9113486842105263, AUC 0.9794114232063293, avg_entr 0.026186782866716385
ep7_t0.6_test_time 0.25175929069519043
gc 0
Train Epoch8 Acc 0.9575083333333333 (114901/120000), AUC 0.995048999786377
ep8_train_time 9.903098583221436
Test Epoch8 threshold 0.6 Acc 0.9123355263157895, AUC 0.9792883992195129, avg_entr 0.02506289817392826
ep8_t0.6_test_time 0.25092315673828125
gc 0
Train Epoch9 Acc 0.9582666666666667 (114992/120000), AUC 0.9953325986862183
ep9_train_time 9.920075416564941
Test Epoch9 threshold 0.6 Acc 0.9111842105263158, AUC 0.9792119264602661, avg_entr 0.02559575065970421
ep9_t0.6_test_time 0.25132107734680176
Best AUC 0.980224609375
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.6_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9230263157894737, AUC 0.9857428669929504, avg_entr 0.025172123685479164
t0.6_test_time 0.06399154663085938
