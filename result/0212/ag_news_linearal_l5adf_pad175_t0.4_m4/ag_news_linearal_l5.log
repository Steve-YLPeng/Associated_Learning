total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad175_t0.4_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.458975 (55077/120000), AUC 0.8027921915054321
ep0_train_time 9.816787481307983
Test Epoch0 threshold 0.4 Acc 0.9159539473684211, AUC 0.9807066917419434, avg_entr 0.025265643373131752
ep0_t0.4_test_time 0.26009368896484375
Save ckpt to ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.460575 (55269/120000), AUC 0.8343350887298584
ep1_train_time 9.48391056060791
Test Epoch1 threshold 0.4 Acc 0.9164473684210527, AUC 0.9805858731269836, avg_entr 0.026092804968357086
ep1_t0.4_test_time 0.2573263645172119
gc 0
Train Epoch2 Acc 0.3118416666666667 (37421/120000), AUC 0.8455649614334106
ep2_train_time 9.561376810073853
Test Epoch2 threshold 0.4 Acc 0.9149671052631579, AUC 0.9804316759109497, avg_entr 0.02553918957710266
ep2_t0.4_test_time 0.25759387016296387
gc 0
Train Epoch3 Acc 0.2896416666666667 (34757/120000), AUC 0.8426550626754761
ep3_train_time 9.448322534561157
Test Epoch3 threshold 0.4 Acc 0.9133223684210526, AUC 0.9802659749984741, avg_entr 0.02600332535803318
ep3_t0.4_test_time 0.2582058906555176
gc 0
Train Epoch4 Acc 0.277225 (33267/120000), AUC 0.8257553577423096
ep4_train_time 9.458831071853638
Test Epoch4 threshold 0.4 Acc 0.9143092105263158, AUC 0.9801527857780457, avg_entr 0.025999033823609352
ep4_t0.4_test_time 0.25650691986083984
gc 0
Train Epoch5 Acc 0.27215 (32658/120000), AUC 0.796221137046814
ep5_train_time 9.427945613861084
Test Epoch5 threshold 0.4 Acc 0.9129934210526316, AUC 0.9800756573677063, avg_entr 0.025414573028683662
ep5_t0.4_test_time 0.25621819496154785
gc 0
Train Epoch6 Acc 0.27158333333333334 (32590/120000), AUC 0.7623916864395142
ep6_train_time 9.442898511886597
Test Epoch6 threshold 0.4 Acc 0.9141447368421053, AUC 0.9799693822860718, avg_entr 0.024885118007659912
ep6_t0.4_test_time 0.255206823348999
gc 0
Train Epoch7 Acc 0.271625 (32595/120000), AUC 0.7226075530052185
ep7_train_time 9.528103590011597
Test Epoch7 threshold 0.4 Acc 0.9133223684210526, AUC 0.9798819422721863, avg_entr 0.02464926615357399
ep7_t0.4_test_time 0.25721311569213867
gc 0
Train Epoch8 Acc 0.271425 (32571/120000), AUC 0.6876097321510315
ep8_train_time 9.681601285934448
Test Epoch8 threshold 0.4 Acc 0.9116776315789473, AUC 0.9797923564910889, avg_entr 0.025860505178570747
ep8_t0.4_test_time 0.25595641136169434
gc 0
Train Epoch9 Acc 0.2705916666666667 (32471/120000), AUC 0.6718141436576843
ep9_train_time 9.478041172027588
Test Epoch9 threshold 0.4 Acc 0.9115131578947369, AUC 0.9797680377960205, avg_entr 0.02543213963508606
ep9_t0.4_test_time 0.2563011646270752
Best AUC 0.9807066917419434
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad175_t0.4_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9256578947368421, AUC 0.9864611029624939, avg_entr 0.024506937712430954
t0.4_test_time 0.06697416305541992
