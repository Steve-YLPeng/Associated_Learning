total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_lstmal_l5adf_pad100_t0.5_m4//ag_news_lstmal_l5_prefix.pt
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9297333333333333 (111568/120000), AUC 0.9851831197738647
ep0_train_time 54.090718030929565
Test Epoch0 threshold 0.5 Acc 0.9144736842105263, AUC 0.9800865650177002, avg_entr 0.025622164830565453
ep0_t0.5_test_time 0.16724014282226562
Save ckpt to ckpt/ag_news_lstmal_l5adf_pad100_t0.5_m5//ag_news_lstmal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.956025 (114723/120000), AUC 0.9932641386985779
ep1_train_time 54.08006310462952
Test Epoch1 threshold 0.5 Acc 0.9146381578947368, AUC 0.9799385666847229, avg_entr 0.025475431233644485
ep1_t0.5_test_time 0.163590669631958
gc 0
Train Epoch2 Acc 0.9591666666666666 (115100/120000), AUC 0.9939382672309875
ep2_train_time 54.04462122917175
Test Epoch2 threshold 0.5 Acc 0.9113486842105263, AUC 0.979604959487915, avg_entr 0.0255866851657629
ep2_t0.5_test_time 0.17493200302124023
gc 0
Train Epoch3 Acc 0.961775 (115413/120000), AUC 0.9942756295204163
ep3_train_time 53.91892099380493
Test Epoch3 threshold 0.5 Acc 0.9118421052631579, AUC 0.9797394871711731, avg_entr 0.025557857006788254
ep3_t0.5_test_time 0.17293882369995117
gc 0
Train Epoch4 Acc 0.963325 (115599/120000), AUC 0.9946846961975098
ep4_train_time 54.49013900756836
Test Epoch4 threshold 0.5 Acc 0.9121710526315789, AUC 0.9794846773147583, avg_entr 0.02613610215485096
ep4_t0.5_test_time 0.16941452026367188
gc 0
Train Epoch5 Acc 0.9671666666666666 (116060/120000), AUC 0.9955588579177856
ep5_train_time 54.24443697929382
Test Epoch5 threshold 0.5 Acc 0.9106907894736842, AUC 0.9793387651443481, avg_entr 0.025958407670259476
ep5_t0.5_test_time 0.16576600074768066
gc 0
Train Epoch6 Acc 0.9685416666666666 (116225/120000), AUC 0.9956396222114563
ep6_train_time 54.215495109558105
Test Epoch6 threshold 0.5 Acc 0.9108552631578948, AUC 0.9792394638061523, avg_entr 0.026413485407829285
ep6_t0.5_test_time 0.1679210662841797
gc 0
Train Epoch7 Acc 0.969475 (116337/120000), AUC 0.9957641363143921
ep7_train_time 54.22975516319275
Test Epoch7 threshold 0.5 Acc 0.9115131578947369, AUC 0.9791408777236938, avg_entr 0.0252703670412302
ep7_t0.5_test_time 0.17943954467773438
gc 0
Train Epoch8 Acc 0.97055 (116466/120000), AUC 0.9958242177963257
ep8_train_time 54.159308433532715
Test Epoch8 threshold 0.5 Acc 0.9100328947368421, AUC 0.9790451526641846, avg_entr 0.025421317666769028
ep8_t0.5_test_time 0.16905856132507324
gc 0
Train Epoch9 Acc 0.97235 (116682/120000), AUC 0.9962140917778015
ep9_train_time 54.22654342651367
Test Epoch9 threshold 0.5 Acc 0.909375, AUC 0.9788526892662048, avg_entr 0.025837082415819168
ep9_t0.5_test_time 0.1759037971496582
Best AUC 0.9800865650177002
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5adf_pad100_t0.5_m5//ag_news_lstmal_l5_prefix.pt
Test threshold 0.5 Acc 0.9236842105263158, AUC 0.9854370951652527, avg_entr 0.025003980845212936
t0.5_test_time 0.04574704170227051
