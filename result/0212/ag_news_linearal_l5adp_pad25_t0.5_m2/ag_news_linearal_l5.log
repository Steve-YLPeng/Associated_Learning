total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.5_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.16003333333333333 (19204/120000), AUC 0.3313627243041992
ep0_train_time 4.7861223220825195
Test Epoch0 threshold 0.5 Acc 0.9121710526315789, AUC 0.9810598492622375, avg_entr 0.033488500863313675
ep0_t0.5_test_time 0.07524752616882324
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.5_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.12521666666666667 (15026/120000), AUC 0.3408339023590088
ep1_train_time 4.3207855224609375
Test Epoch1 threshold 0.5 Acc 0.9131578947368421, AUC 0.9808825254440308, avg_entr 0.030507070943713188
ep1_t0.5_test_time 0.0724797248840332
gc 0
Train Epoch2 Acc 0.07431666666666667 (8918/120000), AUC 0.35021668672561646
ep2_train_time 4.309314250946045
Test Epoch2 threshold 0.5 Acc 0.9110197368421052, AUC 0.9802223443984985, avg_entr 0.028267020359635353
ep2_t0.5_test_time 0.07329416275024414
gc 0
Train Epoch3 Acc 0.04346666666666667 (5216/120000), AUC 0.3561934232711792
ep3_train_time 4.3280189037323
Test Epoch3 threshold 0.5 Acc 0.9131578947368421, AUC 0.9800636768341064, avg_entr 0.027226505801081657
ep3_t0.5_test_time 0.07256364822387695
gc 0
Train Epoch4 Acc 0.02666666666666667 (3200/120000), AUC 0.3599775433540344
ep4_train_time 4.335439682006836
Test Epoch4 threshold 0.5 Acc 0.9125, AUC 0.9796679615974426, avg_entr 0.026940947398543358
ep4_t0.5_test_time 0.07284045219421387
gc 0
Train Epoch5 Acc 0.019983333333333332 (2398/120000), AUC 0.36244940757751465
ep5_train_time 4.347429513931274
Test Epoch5 threshold 0.5 Acc 0.9106907894736842, AUC 0.9794490933418274, avg_entr 0.02636617049574852
ep5_t0.5_test_time 0.07189464569091797
gc 0
Train Epoch6 Acc 0.017108333333333333 (2053/120000), AUC 0.3635360300540924
ep6_train_time 4.3369598388671875
Test Epoch6 threshold 0.5 Acc 0.9106907894736842, AUC 0.9793668389320374, avg_entr 0.02712704800069332
ep6_t0.5_test_time 0.07325887680053711
gc 0
Train Epoch7 Acc 0.014808333333333333 (1777/120000), AUC 0.36469632387161255
ep7_train_time 4.32216477394104
Test Epoch7 threshold 0.5 Acc 0.9103618421052632, AUC 0.9790842533111572, avg_entr 0.02661440521478653
ep7_t0.5_test_time 0.07226681709289551
gc 0
Train Epoch8 Acc 0.013341666666666667 (1601/120000), AUC 0.36592525243759155
ep8_train_time 4.369603395462036
Test Epoch8 threshold 0.5 Acc 0.9097039473684211, AUC 0.9790157079696655, avg_entr 0.026481570675969124
ep8_t0.5_test_time 0.07224655151367188
gc 0
Train Epoch9 Acc 0.012008333333333333 (1441/120000), AUC 0.36690405011177063
ep9_train_time 4.496202707290649
Test Epoch9 threshold 0.5 Acc 0.9100328947368421, AUC 0.9787320494651794, avg_entr 0.02644425630569458
ep9_t0.5_test_time 0.07499146461486816
Best AUC 0.9810598492622375
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.5_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9197368421052632, AUC 0.985775351524353, avg_entr 0.03558168560266495
t0.5_test_time 0.01966404914855957
