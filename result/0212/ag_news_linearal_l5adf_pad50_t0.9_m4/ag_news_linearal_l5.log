total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad50_t0.9_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.21271666666666667 (25526/120000), AUC 0.3479143977165222
ep0_train_time 6.4719202518463135
Test Epoch0 threshold 0.9 Acc 0.9125, AUC 0.9801024198532104, avg_entr 0.026031270623207092
ep0_t0.9_test_time 0.10265970230102539
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.9_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.1579 (18948/120000), AUC 0.3100845217704773
ep1_train_time 6.216127395629883
Test Epoch1 threshold 0.9 Acc 0.9131578947368421, AUC 0.980299711227417, avg_entr 0.025314604863524437
ep1_t0.9_test_time 0.10489225387573242
Save ckpt to ckpt/ag_news_linearal_l5adf_pad50_t0.9_m4//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.118125 (14175/120000), AUC 0.3134118616580963
ep2_train_time 6.414691209793091
Test Epoch2 threshold 0.9 Acc 0.9133223684210526, AUC 0.980089545249939, avg_entr 0.026655299589037895
ep2_t0.9_test_time 0.10445261001586914
gc 0
Train Epoch3 Acc 0.11309166666666666 (13571/120000), AUC 0.36256593465805054
ep3_train_time 6.328998565673828
Test Epoch3 threshold 0.9 Acc 0.9110197368421052, AUC 0.9794067144393921, avg_entr 0.026240350678563118
ep3_t0.9_test_time 0.10097312927246094
gc 0
Train Epoch4 Acc 0.11821666666666666 (14186/120000), AUC 0.3693641126155853
ep4_train_time 5.998579740524292
Test Epoch4 threshold 0.9 Acc 0.9116776315789473, AUC 0.9794501066207886, avg_entr 0.026123695075511932
ep4_t0.9_test_time 0.10305666923522949
gc 0
Train Epoch5 Acc 0.08550833333333334 (10261/120000), AUC 0.37128084897994995
ep5_train_time 6.065665006637573
Test Epoch5 threshold 0.9 Acc 0.9108552631578948, AUC 0.9791980981826782, avg_entr 0.02565198764204979
ep5_t0.9_test_time 0.10074543952941895
gc 0
Train Epoch6 Acc 0.06520833333333333 (7825/120000), AUC 0.3697647154331207
ep6_train_time 5.992178916931152
Test Epoch6 threshold 0.9 Acc 0.9103618421052632, AUC 0.9789405465126038, avg_entr 0.025982074439525604
ep6_t0.9_test_time 0.10088396072387695
gc 0
Train Epoch7 Acc 0.05840833333333333 (7009/120000), AUC 0.3680618107318878
ep7_train_time 6.018762111663818
Test Epoch7 threshold 0.9 Acc 0.9095394736842105, AUC 0.9788854122161865, avg_entr 0.026263713836669922
ep7_t0.9_test_time 0.10053491592407227
gc 0
Train Epoch8 Acc 0.05031666666666667 (6038/120000), AUC 0.36661338806152344
ep8_train_time 6.049274921417236
Test Epoch8 threshold 0.9 Acc 0.9083881578947368, AUC 0.9787586331367493, avg_entr 0.025704193860292435
ep8_t0.9_test_time 0.10034918785095215
gc 0
Train Epoch9 Acc 0.04285833333333333 (5143/120000), AUC 0.36475619673728943
ep9_train_time 6.0087127685546875
Test Epoch9 threshold 0.9 Acc 0.9083881578947368, AUC 0.9785277843475342, avg_entr 0.026652242988348007
ep9_t0.9_test_time 0.10071778297424316
Best AUC 0.980299711227417
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad50_t0.9_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9210526315789473, AUC 0.9861103296279907, avg_entr 0.024743638932704926
t0.9_test_time 0.025934457778930664
