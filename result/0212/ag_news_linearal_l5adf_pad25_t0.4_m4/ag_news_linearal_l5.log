total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.4_m3//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3}
gc 9
Train Epoch0 Acc 0.2828 (33936/120000), AUC 0.5786572098731995
ep0_train_time 5.847570419311523
Test Epoch0 threshold 0.4 Acc 0.9123355263157895, AUC 0.9804500341415405, avg_entr 0.024613697081804276
ep0_t0.4_test_time 0.0801689624786377
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.4_m4//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.3298583333333333 (39583/120000), AUC 0.570705235004425
ep1_train_time 5.597116947174072
Test Epoch1 threshold 0.4 Acc 0.9120065789473685, AUC 0.9800626635551453, avg_entr 0.024043066427111626
ep1_t0.4_test_time 0.07716226577758789
gc 0
Train Epoch2 Acc 0.37971666666666665 (45566/120000), AUC 0.5606340169906616
ep2_train_time 5.701261520385742
Test Epoch2 threshold 0.4 Acc 0.9110197368421052, AUC 0.9799926280975342, avg_entr 0.02499019168317318
ep2_t0.4_test_time 0.07841968536376953
gc 0
Train Epoch3 Acc 0.305 (36600/120000), AUC 0.5132319927215576
ep3_train_time 5.59439754486084
Test Epoch3 threshold 0.4 Acc 0.909375, AUC 0.9798975586891174, avg_entr 0.024603357538580894
ep3_t0.4_test_time 0.0753486156463623
gc 0
Train Epoch4 Acc 0.2737833333333333 (32854/120000), AUC 0.46132028102874756
ep4_train_time 5.436805725097656
Test Epoch4 threshold 0.4 Acc 0.9100328947368421, AUC 0.9795957803726196, avg_entr 0.024747265502810478
ep4_t0.4_test_time 0.07727360725402832
gc 0
Train Epoch5 Acc 0.26153333333333334 (31384/120000), AUC 0.45821571350097656
ep5_train_time 5.412891387939453
Test Epoch5 threshold 0.4 Acc 0.9087171052631579, AUC 0.9790636301040649, avg_entr 0.025146694853901863
ep5_t0.4_test_time 0.07521820068359375
gc 0
Train Epoch6 Acc 0.25765 (30918/120000), AUC 0.47172659635543823
ep6_train_time 5.3963634967803955
Test Epoch6 threshold 0.4 Acc 0.9090460526315789, AUC 0.978979766368866, avg_entr 0.024766698479652405
ep6_t0.4_test_time 0.07504129409790039
gc 0
Train Epoch7 Acc 0.255025 (30603/120000), AUC 0.48721450567245483
ep7_train_time 5.373629331588745
Test Epoch7 threshold 0.4 Acc 0.9083881578947368, AUC 0.9785441756248474, avg_entr 0.024838462471961975
ep7_t0.4_test_time 0.07702255249023438
gc 0
Train Epoch8 Acc 0.25183333333333335 (30220/120000), AUC 0.49903571605682373
ep8_train_time 5.419274091720581
Test Epoch8 threshold 0.4 Acc 0.9090460526315789, AUC 0.978593111038208, avg_entr 0.025150589644908905
ep8_t0.4_test_time 0.07617712020874023
gc 0
Train Epoch9 Acc 0.2508416666666667 (30101/120000), AUC 0.5055322051048279
ep9_train_time 5.411614894866943
Test Epoch9 threshold 0.4 Acc 0.9092105263157895, AUC 0.9784698486328125, avg_entr 0.025193609297275543
ep9_t0.4_test_time 0.07594609260559082
Best AUC 0.9804500341415405
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.4_m4//ag_news_linearal_l5_prefix.pt
Test threshold 0.4 Acc 0.9223684210526316, AUC 0.9851645827293396, avg_entr 0.025244055315852165
t0.4_test_time 0.02128911018371582
