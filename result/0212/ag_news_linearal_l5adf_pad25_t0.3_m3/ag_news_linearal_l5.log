total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adf_pad25_t0.3_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.12238333333333333 (14686/120000), AUC 0.46485841274261475
ep0_train_time 5.676067113876343
Test Epoch0 threshold 0.3 Acc 0.9131578947368421, AUC 0.9805487990379333, avg_entr 0.024686502292752266
ep0_t0.3_test_time 0.08841276168823242
Save ckpt to ckpt/ag_news_linearal_l5adf_pad25_t0.3_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.11303333333333333 (13564/120000), AUC 0.4815558195114136
ep1_train_time 5.1852569580078125
Test Epoch1 threshold 0.3 Acc 0.9120065789473685, AUC 0.9803705215454102, avg_entr 0.025027232244610786
ep1_t0.3_test_time 0.08301663398742676
gc 0
Train Epoch2 Acc 0.07721666666666667 (9266/120000), AUC 0.45819130539894104
ep2_train_time 4.871902227401733
Test Epoch2 threshold 0.3 Acc 0.9138157894736842, AUC 0.9804167151451111, avg_entr 0.024224698543548584
ep2_t0.3_test_time 0.08268213272094727
gc 0
Train Epoch3 Acc 0.050325 (6039/120000), AUC 0.45276594161987305
ep3_train_time 4.889785528182983
Test Epoch3 threshold 0.3 Acc 0.9113486842105263, AUC 0.9798932671546936, avg_entr 0.024519486352801323
ep3_t0.3_test_time 0.08293771743774414
gc 0
Train Epoch4 Acc 0.04643333333333333 (5572/120000), AUC 0.4564741253852844
ep4_train_time 4.933139085769653
Test Epoch4 threshold 0.3 Acc 0.9111842105263158, AUC 0.9793599843978882, avg_entr 0.02472853846848011
ep4_t0.3_test_time 0.08242201805114746
gc 0
Train Epoch5 Acc 0.04666666666666667 (5600/120000), AUC 0.46696656942367554
ep5_train_time 4.940655708312988
Test Epoch5 threshold 0.3 Acc 0.9098684210526315, AUC 0.9793092608451843, avg_entr 0.024670621380209923
ep5_t0.3_test_time 0.08195304870605469
gc 0
Train Epoch6 Acc 0.0493 (5916/120000), AUC 0.47418004274368286
ep6_train_time 4.892551898956299
Test Epoch6 threshold 0.3 Acc 0.9110197368421052, AUC 0.9791797995567322, avg_entr 0.024261821061372757
ep6_t0.3_test_time 0.08102941513061523
gc 0
Train Epoch7 Acc 0.050425 (6051/120000), AUC 0.4776800870895386
ep7_train_time 4.869868278503418
Test Epoch7 threshold 0.3 Acc 0.9108552631578948, AUC 0.9789305925369263, avg_entr 0.024009177461266518
ep7_t0.3_test_time 0.08112001419067383
gc 0
Train Epoch8 Acc 0.05285 (6342/120000), AUC 0.47365429997444153
ep8_train_time 4.907207012176514
Test Epoch8 threshold 0.3 Acc 0.9100328947368421, AUC 0.9789620041847229, avg_entr 0.024185340851545334
ep8_t0.3_test_time 0.0817265510559082
gc 0
Train Epoch9 Acc 0.05478333333333334 (6574/120000), AUC 0.4709169864654541
ep9_train_time 4.994436740875244
Test Epoch9 threshold 0.3 Acc 0.9105263157894737, AUC 0.9787130951881409, avg_entr 0.024289678782224655
ep9_t0.3_test_time 0.08109736442565918
Best AUC 0.9805487990379333
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adf_pad25_t0.3_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9210526315789473, AUC 0.9855011701583862, avg_entr 0.024695100262761116
t0.3_test_time 0.021709918975830078
