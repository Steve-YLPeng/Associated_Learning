total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.47992669
Start Training
gc 0
Train Epoch0 Acc 0.51965 (20786/40000), AUC 0.534640371799469
ep0_train_time 6.7421814
Test Epoch0 layer0 Acc 0.8226, AUC 0.8934268951416016, avg_entr 0.5674357414245605, f1 0.8226000070571899
ep0_l0_test_time 0.5438824219999994
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7908, AUC 0.8778525590896606, avg_entr 0.688248872756958, f1 0.7907999753952026
ep0_l1_test_time 0.5439211559999997
Test Epoch0 layer2 Acc 0.6506, AUC 0.8540892004966736, avg_entr 0.6910580992698669, f1 0.650600016117096
ep0_l2_test_time 0.5455762039999996
Test Epoch0 layer3 Acc 0.708, AUC 0.8276420831680298, avg_entr 0.6912651062011719, f1 0.7080000638961792
ep0_l3_test_time 0.5444581109999973
Test Epoch0 layer4 Acc 0.5772, AUC 0.74749755859375, avg_entr 0.6890726685523987, f1 0.5771999955177307
ep0_l4_test_time 0.5456045439999997
gc 0
Train Epoch1 Acc 0.82555 (33022/40000), AUC 0.9004113078117371
ep1_train_time 6.3720382030000025
Test Epoch1 layer0 Acc 0.8818, AUC 0.9458200335502625, avg_entr 0.2878161072731018, f1 0.8818000555038452
ep1_l0_test_time 0.553120235999998
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8784, AUC 0.9462370276451111, avg_entr 0.33566781878471375, f1 0.8784000277519226
ep1_l1_test_time 0.5601683419999972
Test Epoch1 layer2 Acc 0.8794, AUC 0.9469060897827148, avg_entr 0.24364206194877625, f1 0.8794000148773193
ep1_l2_test_time 0.5586043249999975
Test Epoch1 layer3 Acc 0.8784, AUC 0.94704270362854, avg_entr 0.23990659415721893, f1 0.8784000277519226
ep1_l3_test_time 0.5459172159999994
Test Epoch1 layer4 Acc 0.8786, AUC 0.9468628764152527, avg_entr 0.23465481400489807, f1 0.878600001335144
ep1_l4_test_time 0.547191435000002
gc 0
Train Epoch2 Acc 0.9065 (36260/40000), AUC 0.9650026559829712
ep2_train_time 6.431227692
Test Epoch2 layer0 Acc 0.893, AUC 0.9550912380218506, avg_entr 0.22485381364822388, f1 0.8930000066757202
ep2_l0_test_time 0.5841777539999953
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8946, AUC 0.9557590484619141, avg_entr 0.20945586264133453, f1 0.894599974155426
ep2_l1_test_time 0.5579238960000055
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8954, AUC 0.9562354683876038, avg_entr 0.1948137879371643, f1 0.8953999876976013
ep2_l2_test_time 0.5471422930000003
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8952, AUC 0.9564467072486877, avg_entr 0.18203486502170563, f1 0.8952000141143799
ep2_l3_test_time 0.5564210679999988
Test Epoch2 layer4 Acc 0.895, AUC 0.9563341736793518, avg_entr 0.16527365148067474, f1 0.8949999809265137
ep2_l4_test_time 0.5503772249999983
gc 0
Train Epoch3 Acc 0.92365 (36946/40000), AUC 0.9758206605911255
ep3_train_time 6.398498074999999
Test Epoch3 layer0 Acc 0.8986, AUC 0.958099365234375, avg_entr 0.19221876561641693, f1 0.8985999822616577
ep3_l0_test_time 0.5507890189999998
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.899, AUC 0.9585631489753723, avg_entr 0.170488640666008, f1 0.8989999890327454
ep3_l1_test_time 0.5446916559999977
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8992, AUC 0.9590608477592468, avg_entr 0.16428571939468384, f1 0.8992000222206116
ep3_l2_test_time 0.5577524949999955
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.8962, AUC 0.9592123031616211, avg_entr 0.14804863929748535, f1 0.8962000012397766
ep3_l3_test_time 0.5459140179999977
Test Epoch3 layer4 Acc 0.8976, AUC 0.9593597054481506, avg_entr 0.12438882142305374, f1 0.897599995136261
ep3_l4_test_time 0.5436204299999972
gc 0
Train Epoch4 Acc 0.935275 (37411/40000), AUC 0.9820213317871094
ep4_train_time 6.364854830999995
Test Epoch4 layer0 Acc 0.8996, AUC 0.959149956703186, avg_entr 0.17501121759414673, f1 0.8996000289916992
ep4_l0_test_time 0.5439110009999979
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.901, AUC 0.9596552848815918, avg_entr 0.15046188235282898, f1 0.9010000228881836
ep4_l1_test_time 0.5457854050000037
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8996, AUC 0.9602659344673157, avg_entr 0.14342983067035675, f1 0.8996000289916992
ep4_l2_test_time 0.5453232189999966
Test Epoch4 layer3 Acc 0.8982, AUC 0.9608047008514404, avg_entr 0.1184205710887909, f1 0.8981999754905701
ep4_l3_test_time 0.5472295229999986
Test Epoch4 layer4 Acc 0.8996, AUC 0.9613138437271118, avg_entr 0.08520447462797165, f1 0.8996000289916992
ep4_l4_test_time 0.5509429229999938
gc 0
Train Epoch5 Acc 0.9429 (37716/40000), AUC 0.9852262139320374
ep5_train_time 6.354673093000002
Test Epoch5 layer0 Acc 0.897, AUC 0.9584392309188843, avg_entr 0.1634952872991562, f1 0.8970000147819519
ep5_l0_test_time 0.5427293209999959
Test Epoch5 layer1 Acc 0.8966, AUC 0.9591271281242371, avg_entr 0.1397327184677124, f1 0.8966000080108643
ep5_l1_test_time 0.5437714010000008
Test Epoch5 layer2 Acc 0.896, AUC 0.9598413705825806, avg_entr 0.13272549211978912, f1 0.8960000276565552
ep5_l2_test_time 0.5440327199999899
Test Epoch5 layer3 Acc 0.8954, AUC 0.96046382188797, avg_entr 0.09801380336284637, f1 0.8953999876976013
ep5_l3_test_time 0.5487516470000031
Test Epoch5 layer4 Acc 0.8962, AUC 0.9607291221618652, avg_entr 0.06516344100236893, f1 0.8962000012397766
ep5_l4_test_time 0.5460978859999983
gc 0
Train Epoch6 Acc 0.949875 (37995/40000), AUC 0.9878866672515869
ep6_train_time 6.430413244999997
Test Epoch6 layer0 Acc 0.8968, AUC 0.9573872089385986, avg_entr 0.15213720500469208, f1 0.8967999815940857
ep6_l0_test_time 0.5531986990000064
Test Epoch6 layer1 Acc 0.8976, AUC 0.9581242799758911, avg_entr 0.12788933515548706, f1 0.897599995136261
ep6_l1_test_time 0.5500500920000064
Test Epoch6 layer2 Acc 0.8982, AUC 0.9590083360671997, avg_entr 0.11767319589853287, f1 0.8981999754905701
ep6_l2_test_time 0.5485597130000031
Test Epoch6 layer3 Acc 0.8972, AUC 0.9595658779144287, avg_entr 0.0771692767739296, f1 0.8971999883651733
ep6_l3_test_time 0.5463528339999897
Test Epoch6 layer4 Acc 0.8978, AUC 0.9579474329948425, avg_entr 0.05102436989545822, f1 0.8978000283241272
ep6_l4_test_time 0.5472669820000107
gc 0
Train Epoch7 Acc 0.953925 (38157/40000), AUC 0.9893451929092407
ep7_train_time 6.4551465300000075
Test Epoch7 layer0 Acc 0.8958, AUC 0.9562716484069824, avg_entr 0.14219097793102264, f1 0.895799994468689
ep7_l0_test_time 0.5411826579999968
Test Epoch7 layer1 Acc 0.8964, AUC 0.9569727182388306, avg_entr 0.1187116727232933, f1 0.896399974822998
ep7_l1_test_time 0.543304163000002
Test Epoch7 layer2 Acc 0.8982, AUC 0.9579586982727051, avg_entr 0.10734357684850693, f1 0.8981999754905701
ep7_l2_test_time 0.548548212
Test Epoch7 layer3 Acc 0.8972, AUC 0.9583517909049988, avg_entr 0.06292774528265, f1 0.8971999883651733
ep7_l3_test_time 0.5418710990000051
Test Epoch7 layer4 Acc 0.8978, AUC 0.9558556079864502, avg_entr 0.04056571051478386, f1 0.8978000283241272
ep7_l4_test_time 0.5452619819999995
gc 0
Train Epoch8 Acc 0.9583 (38332/40000), AUC 0.9909005761146545
ep8_train_time 6.422773539999994
Test Epoch8 layer0 Acc 0.8916, AUC 0.9544353485107422, avg_entr 0.13859166204929352, f1 0.8916000127792358
ep8_l0_test_time 0.5421915640000066
Test Epoch8 layer1 Acc 0.8918, AUC 0.9554178714752197, avg_entr 0.11470343917608261, f1 0.8917999863624573
ep8_l1_test_time 0.5418425379999974
Test Epoch8 layer2 Acc 0.891, AUC 0.9564180374145508, avg_entr 0.10268541425466537, f1 0.890999972820282
ep8_l2_test_time 0.5460041070000017
Test Epoch8 layer3 Acc 0.8906, AUC 0.9555989503860474, avg_entr 0.055818114429712296, f1 0.8906000256538391
ep8_l3_test_time 0.5433147650000052
Test Epoch8 layer4 Acc 0.8906, AUC 0.9529823064804077, avg_entr 0.03641022369265556, f1 0.8906000256538391
ep8_l4_test_time 0.5445361480000059
gc 0
Train Epoch9 Acc 0.96375 (38550/40000), AUC 0.9926227331161499
ep9_train_time 6.394680606999998
Test Epoch9 layer0 Acc 0.8936, AUC 0.9534088373184204, avg_entr 0.13243553042411804, f1 0.8935999870300293
ep9_l0_test_time 0.5437585869999992
Test Epoch9 layer1 Acc 0.8938, AUC 0.9543279409408569, avg_entr 0.1094648465514183, f1 0.8938000202178955
ep9_l1_test_time 0.5418578450000098
Test Epoch9 layer2 Acc 0.893, AUC 0.9553515911102295, avg_entr 0.09474872797727585, f1 0.8930000066757202
ep9_l2_test_time 0.5434889810000101
Test Epoch9 layer3 Acc 0.8936, AUC 0.9538956880569458, avg_entr 0.049590498208999634, f1 0.8935999870300293
ep9_l3_test_time 0.5443974989999987
Test Epoch9 layer4 Acc 0.8938, AUC 0.9523016214370728, avg_entr 0.03222576528787613, f1 0.8938000202178955
ep9_l4_test_time 0.5486303440000029
gc 0
Train Epoch10 Acc 0.96525 (38610/40000), AUC 0.9934036731719971
ep10_train_time 6.371427154000003
Test Epoch10 layer0 Acc 0.8908, AUC 0.9523872137069702, avg_entr 0.1302841454744339, f1 0.8907999992370605
ep10_l0_test_time 0.5418907339999919
Test Epoch10 layer1 Acc 0.8896, AUC 0.9534333944320679, avg_entr 0.10808863490819931, f1 0.8895999193191528
ep10_l1_test_time 0.5413001820000005
Test Epoch10 layer2 Acc 0.89, AUC 0.9543478488922119, avg_entr 0.09265013784170151, f1 0.8899999856948853
ep10_l2_test_time 0.5461330600000025
Test Epoch10 layer3 Acc 0.8896, AUC 0.952305018901825, avg_entr 0.04732828587293625, f1 0.8895999193191528
ep10_l3_test_time 0.5447992559999904
Test Epoch10 layer4 Acc 0.8894, AUC 0.9513662457466125, avg_entr 0.03023136965930462, f1 0.8894000053405762
ep10_l4_test_time 0.5456492960000077
gc 0
Train Epoch11 Acc 0.96755 (38702/40000), AUC 0.9938263297080994
ep11_train_time 6.373718440999994
Test Epoch11 layer0 Acc 0.8904, AUC 0.9514411687850952, avg_entr 0.12611790001392365, f1 0.8903999924659729
ep11_l0_test_time 0.5437415380000061
Test Epoch11 layer1 Acc 0.8914, AUC 0.9524576663970947, avg_entr 0.10409898310899734, f1 0.8913999795913696
ep11_l1_test_time 0.5418894190000003
Test Epoch11 layer2 Acc 0.891, AUC 0.9533848166465759, avg_entr 0.08674610406160355, f1 0.890999972820282
ep11_l2_test_time 0.5444652460000157
Test Epoch11 layer3 Acc 0.8908, AUC 0.9508601427078247, avg_entr 0.042943090200424194, f1 0.8907999992370605
ep11_l3_test_time 0.5459862620000138
Test Epoch11 layer4 Acc 0.8904, AUC 0.9511958360671997, avg_entr 0.028467699885368347, f1 0.8903999924659729
ep11_l4_test_time 0.5494392690000041
gc 0
Train Epoch12 Acc 0.968375 (38735/40000), AUC 0.9941578507423401
ep12_train_time 6.338505956999995
Test Epoch12 layer0 Acc 0.8868, AUC 0.950282633304596, avg_entr 0.1267833709716797, f1 0.8867999911308289
ep12_l0_test_time 0.5417890209999996
Test Epoch12 layer1 Acc 0.8882, AUC 0.9514743089675903, avg_entr 0.10448383539915085, f1 0.888200044631958
ep12_l1_test_time 0.5431156509999937
Test Epoch12 layer2 Acc 0.8874, AUC 0.9523463845252991, avg_entr 0.08592814952135086, f1 0.8873999714851379
ep12_l2_test_time 0.5442702469999858
Test Epoch12 layer3 Acc 0.8874, AUC 0.9495487213134766, avg_entr 0.0421578548848629, f1 0.8873999714851379
ep12_l3_test_time 0.5446911060000161
Test Epoch12 layer4 Acc 0.8868, AUC 0.949532151222229, avg_entr 0.027056274935603142, f1 0.8867999911308289
ep12_l4_test_time 0.5460956549999878
gc 0
Train Epoch13 Acc 0.970525 (38821/40000), AUC 0.9947543740272522
ep13_train_time 6.377089909999995
Test Epoch13 layer0 Acc 0.8876, AUC 0.9498528242111206, avg_entr 0.12269692122936249, f1 0.8876000046730042
ep13_l0_test_time 0.5490648449999753
Test Epoch13 layer1 Acc 0.888, AUC 0.951011061668396, avg_entr 0.10089781880378723, f1 0.8880000114440918
ep13_l1_test_time 0.5418900550000103
Test Epoch13 layer2 Acc 0.8878, AUC 0.9519223570823669, avg_entr 0.08223897963762283, f1 0.8877999782562256
ep13_l2_test_time 0.543881429999999
Test Epoch13 layer3 Acc 0.8878, AUC 0.9489814639091492, avg_entr 0.03984038531780243, f1 0.8877999782562256
ep13_l3_test_time 0.54596603600001
Test Epoch13 layer4 Acc 0.8878, AUC 0.9502536058425903, avg_entr 0.02602972462773323, f1 0.8877999782562256
ep13_l4_test_time 0.546309846000014
gc 0
Train Epoch14 Acc 0.970725 (38829/40000), AUC 0.9951746463775635
ep14_train_time 6.370209384999981
Test Epoch14 layer0 Acc 0.8868, AUC 0.9492213726043701, avg_entr 0.12212765216827393, f1 0.8867999911308289
ep14_l0_test_time 0.5440976720000208
Test Epoch14 layer1 Acc 0.8872, AUC 0.9504297971725464, avg_entr 0.10051975399255753, f1 0.8871999979019165
ep14_l1_test_time 0.5472963729999947
Test Epoch14 layer2 Acc 0.8874, AUC 0.9513098001480103, avg_entr 0.08126582205295563, f1 0.8873999714851379
ep14_l2_test_time 0.5440067669999848
Test Epoch14 layer3 Acc 0.8876, AUC 0.9482033848762512, avg_entr 0.03905719146132469, f1 0.8876000046730042
ep14_l3_test_time 0.5449333610000053
Test Epoch14 layer4 Acc 0.887, AUC 0.947568953037262, avg_entr 0.02557799033820629, f1 0.8870000243186951
ep14_l4_test_time 0.5457438169999875
gc 0
Train Epoch15 Acc 0.97165 (38866/40000), AUC 0.9951995015144348
ep15_train_time 6.4423850630000175
Test Epoch15 layer0 Acc 0.886, AUC 0.9485775232315063, avg_entr 0.12191709876060486, f1 0.8859999775886536
ep15_l0_test_time 0.5438963809999962
Test Epoch15 layer1 Acc 0.8854, AUC 0.9498463869094849, avg_entr 0.10018473863601685, f1 0.8853999972343445
ep15_l1_test_time 0.5417843269999878
Test Epoch15 layer2 Acc 0.8856, AUC 0.9507102370262146, avg_entr 0.08026085793972015, f1 0.8855999708175659
ep15_l2_test_time 0.544847400000009
Test Epoch15 layer3 Acc 0.8856, AUC 0.9476486444473267, avg_entr 0.038831163197755814, f1 0.8855999708175659
ep15_l3_test_time 0.5444852239999989
Test Epoch15 layer4 Acc 0.8856, AUC 0.946972131729126, avg_entr 0.025545243173837662, f1 0.8855999708175659
ep15_l4_test_time 0.545060669999998
gc 0
Train Epoch16 Acc 0.9726 (38904/40000), AUC 0.9953126907348633
ep16_train_time 6.3915051589999905
Test Epoch16 layer0 Acc 0.8844, AUC 0.9480584859848022, avg_entr 0.11914528906345367, f1 0.8844000101089478
ep16_l0_test_time 0.5445083880000254
Test Epoch16 layer1 Acc 0.8856, AUC 0.9493734836578369, avg_entr 0.09762649983167648, f1 0.8855999708175659
ep16_l1_test_time 0.5440191699999843
Test Epoch16 layer2 Acc 0.8844, AUC 0.9502079486846924, avg_entr 0.07717184722423553, f1 0.8844000101089478
ep16_l2_test_time 0.5574137799999903
Test Epoch16 layer3 Acc 0.885, AUC 0.9467881917953491, avg_entr 0.036973778158426285, f1 0.8849999904632568
ep16_l3_test_time 0.5525755819999745
Test Epoch16 layer4 Acc 0.8848, AUC 0.9474896192550659, avg_entr 0.024307716637849808, f1 0.8848000168800354
ep16_l4_test_time 0.5550420539999834
gc 0
Train Epoch17 Acc 0.973 (38920/40000), AUC 0.9956715703010559
ep17_train_time 6.388191608
Test Epoch17 layer0 Acc 0.8858, AUC 0.9477099180221558, avg_entr 0.11723630130290985, f1 0.8858000040054321
ep17_l0_test_time 0.5426553209999838
Test Epoch17 layer1 Acc 0.8856, AUC 0.9490272402763367, avg_entr 0.09624512493610382, f1 0.8855999708175659
ep17_l1_test_time 0.5407947310000054
Test Epoch17 layer2 Acc 0.8842, AUC 0.94986891746521, avg_entr 0.07566184550523758, f1 0.8842000365257263
ep17_l2_test_time 0.5468005989999938
Test Epoch17 layer3 Acc 0.8842, AUC 0.9458050727844238, avg_entr 0.03616146743297577, f1 0.8842000365257263
ep17_l3_test_time 0.5437957110000013
Test Epoch17 layer4 Acc 0.8846, AUC 0.9455698728561401, avg_entr 0.02376425825059414, f1 0.8845999836921692
ep17_l4_test_time 0.5441360499999917
gc 0
Train Epoch18 Acc 0.97335 (38934/40000), AUC 0.995844841003418
ep18_train_time 6.425627222999992
Test Epoch18 layer0 Acc 0.8848, AUC 0.9473941922187805, avg_entr 0.11624325066804886, f1 0.8848000168800354
ep18_l0_test_time 0.5452227359999995
Test Epoch18 layer1 Acc 0.8846, AUC 0.9487248659133911, avg_entr 0.09528173506259918, f1 0.8845999836921692
ep18_l1_test_time 0.5476048919999812
Test Epoch18 layer2 Acc 0.8846, AUC 0.9495412707328796, avg_entr 0.07432319968938828, f1 0.8845999836921692
ep18_l2_test_time 0.5431971689999955
Test Epoch18 layer3 Acc 0.8836, AUC 0.945500373840332, avg_entr 0.03532210737466812, f1 0.8835999965667725
ep18_l3_test_time 0.5473280029999898
Test Epoch18 layer4 Acc 0.8844, AUC 0.9454947710037231, avg_entr 0.02308761328458786, f1 0.8844000101089478
ep18_l4_test_time 0.5485335719999966
gc 0
Train Epoch19 Acc 0.973275 (38931/40000), AUC 0.9957911968231201
ep19_train_time 6.354282512999987
Test Epoch19 layer0 Acc 0.8846, AUC 0.9470925331115723, avg_entr 0.11579287052154541, f1 0.8845999836921692
ep19_l0_test_time 0.5425145060000034
Test Epoch19 layer1 Acc 0.8848, AUC 0.9484224319458008, avg_entr 0.09469861537218094, f1 0.8848000168800354
ep19_l1_test_time 0.5432690770000193
Test Epoch19 layer2 Acc 0.8838, AUC 0.9492098093032837, avg_entr 0.07351963967084885, f1 0.8838000297546387
ep19_l2_test_time 0.5438735689999987
Test Epoch19 layer3 Acc 0.8842, AUC 0.9450193643569946, avg_entr 0.03473787382245064, f1 0.8842000365257263
ep19_l3_test_time 0.5451007890000028
Test Epoch19 layer4 Acc 0.8848, AUC 0.9450551271438599, avg_entr 0.022761430591344833, f1 0.8848000168800354
ep19_l4_test_time 0.5449090989999945
gc 0
Train Epoch20 Acc 0.9733 (38932/40000), AUC 0.9960888624191284
ep20_train_time 6.433585063999999
Test Epoch20 layer0 Acc 0.8844, AUC 0.9468103647232056, avg_entr 0.11449137330055237, f1 0.8844000101089478
ep20_l0_test_time 0.5437993559999938
Test Epoch20 layer1 Acc 0.8846, AUC 0.9481673836708069, avg_entr 0.09362150728702545, f1 0.8845999836921692
ep20_l1_test_time 0.5480129890000001
Test Epoch20 layer2 Acc 0.8834, AUC 0.948948860168457, avg_entr 0.07243135571479797, f1 0.8834000825881958
ep20_l2_test_time 0.5437736559999848
Test Epoch20 layer3 Acc 0.8836, AUC 0.9450076818466187, avg_entr 0.03396861255168915, f1 0.8835999965667725
ep20_l3_test_time 0.5582690720000016
Test Epoch20 layer4 Acc 0.8834, AUC 0.9454519748687744, avg_entr 0.022213393822312355, f1 0.8834000825881958
ep20_l4_test_time 0.5473434090000069
gc 0
Train Epoch21 Acc 0.974 (38960/40000), AUC 0.9959409236907959
ep21_train_time 6.399154928999991
Test Epoch21 layer0 Acc 0.8828, AUC 0.946654200553894, avg_entr 0.11349062621593475, f1 0.8827999830245972
ep21_l0_test_time 0.5500300509999931
Test Epoch21 layer1 Acc 0.8844, AUC 0.9480212330818176, avg_entr 0.09282780438661575, f1 0.8844000101089478
ep21_l1_test_time 0.5503784990000042
Test Epoch21 layer2 Acc 0.8852, AUC 0.9488208889961243, avg_entr 0.07136920094490051, f1 0.8852000832557678
ep21_l2_test_time 0.5501680479999891
Test Epoch21 layer3 Acc 0.8838, AUC 0.9445317387580872, avg_entr 0.03362179547548294, f1 0.8838000297546387
ep21_l3_test_time 0.5511386670000036
Test Epoch21 layer4 Acc 0.8842, AUC 0.9457736015319824, avg_entr 0.02214309759438038, f1 0.8842000365257263
ep21_l4_test_time 0.5514386130000162
gc 0
Train Epoch22 Acc 0.97425 (38970/40000), AUC 0.9960593581199646
ep22_train_time 6.35718188300001
Test Epoch22 layer0 Acc 0.884, AUC 0.9464704394340515, avg_entr 0.11352403461933136, f1 0.8840000033378601
ep22_l0_test_time 0.5440953510000099
Test Epoch22 layer1 Acc 0.8838, AUC 0.9478346109390259, avg_entr 0.09284867346286774, f1 0.8838000297546387
ep22_l1_test_time 0.5433341580000217
Test Epoch22 layer2 Acc 0.883, AUC 0.9486091136932373, avg_entr 0.0717281624674797, f1 0.8830000162124634
ep22_l2_test_time 0.5471373219999975
Test Epoch22 layer3 Acc 0.884, AUC 0.9444820880889893, avg_entr 0.03345935791730881, f1 0.8840000033378601
ep22_l3_test_time 0.5511756859999934
Test Epoch22 layer4 Acc 0.8842, AUC 0.946374773979187, avg_entr 0.021778615191578865, f1 0.8842000365257263
ep22_l4_test_time 0.5457909819999998
gc 0
Train Epoch23 Acc 0.974375 (38975/40000), AUC 0.9961926937103271
ep23_train_time 6.3821169119999865
Test Epoch23 layer0 Acc 0.883, AUC 0.9463902711868286, avg_entr 0.11328490078449249, f1 0.8830000162124634
ep23_l0_test_time 0.54996389599998
Test Epoch23 layer1 Acc 0.8834, AUC 0.9478183388710022, avg_entr 0.09264355152845383, f1 0.8834000825881958
ep23_l1_test_time 0.5425630419999834
Test Epoch23 layer2 Acc 0.8832, AUC 0.9485804438591003, avg_entr 0.07099241763353348, f1 0.8831999897956848
ep23_l2_test_time 0.5434642349999876
Test Epoch23 layer3 Acc 0.8826, AUC 0.9447757601737976, avg_entr 0.03351898118853569, f1 0.8826000094413757
ep23_l3_test_time 0.5435321780000208
Test Epoch23 layer4 Acc 0.8834, AUC 0.9472527503967285, avg_entr 0.022147059440612793, f1 0.8834000825881958
ep23_l4_test_time 0.5483485850000136
gc 0
Train Epoch24 Acc 0.974325 (38973/40000), AUC 0.9961719512939453
ep24_train_time 6.460196408000002
Test Epoch24 layer0 Acc 0.8828, AUC 0.9462340474128723, avg_entr 0.11274738609790802, f1 0.8827999830245972
ep24_l0_test_time 0.5456428539999933
Test Epoch24 layer1 Acc 0.8834, AUC 0.9476346969604492, avg_entr 0.09196655452251434, f1 0.8834000825881958
ep24_l1_test_time 0.544494635999996
Test Epoch24 layer2 Acc 0.8834, AUC 0.9484102725982666, avg_entr 0.07063665986061096, f1 0.8834000825881958
ep24_l2_test_time 0.5438294029999895
Test Epoch24 layer3 Acc 0.8832, AUC 0.9444180130958557, avg_entr 0.03312482312321663, f1 0.8831999897956848
ep24_l3_test_time 0.5501810510000098
Test Epoch24 layer4 Acc 0.8834, AUC 0.945935845375061, avg_entr 0.021804198622703552, f1 0.8834000825881958
ep24_l4_test_time 0.5467232050000064
gc 0
Train Epoch25 Acc 0.974425 (38977/40000), AUC 0.9963057637214661
ep25_train_time 6.531281208000024
Test Epoch25 layer0 Acc 0.8824, AUC 0.9461872577667236, avg_entr 0.11265982687473297, f1 0.8823999762535095
ep25_l0_test_time 0.5573795120000113
Test Epoch25 layer1 Acc 0.8824, AUC 0.9476395845413208, avg_entr 0.09199443459510803, f1 0.8823999762535095
ep25_l1_test_time 0.5427654019999864
Test Epoch25 layer2 Acc 0.8824, AUC 0.9483773112297058, avg_entr 0.07046286016702652, f1 0.8823999762535095
ep25_l2_test_time 0.5428626180000151
Test Epoch25 layer3 Acc 0.8822, AUC 0.9444716572761536, avg_entr 0.03336980193853378, f1 0.8822000026702881
ep25_l3_test_time 0.5622551060000092
Test Epoch25 layer4 Acc 0.8816, AUC 0.9460800886154175, avg_entr 0.02226162515580654, f1 0.881600022315979
ep25_l4_test_time 0.5480065360000026
gc 0
Train Epoch26 Acc 0.974475 (38979/40000), AUC 0.9963079690933228
ep26_train_time 6.367356547999975
Test Epoch26 layer0 Acc 0.8836, AUC 0.9461245536804199, avg_entr 0.11145757883787155, f1 0.8835999965667725
ep26_l0_test_time 0.5410722240000041
Test Epoch26 layer1 Acc 0.8832, AUC 0.9475446939468384, avg_entr 0.09093276411294937, f1 0.8831999897956848
ep26_l1_test_time 0.5441435310000315
Test Epoch26 layer2 Acc 0.883, AUC 0.9483262300491333, avg_entr 0.06945660710334778, f1 0.8830000162124634
ep26_l2_test_time 0.5423240929999906
Test Epoch26 layer3 Acc 0.8824, AUC 0.9441150426864624, avg_entr 0.03265305608510971, f1 0.8823999762535095
ep26_l3_test_time 0.5440945029999966
Test Epoch26 layer4 Acc 0.883, AUC 0.945906400680542, avg_entr 0.021643079817295074, f1 0.8830000162124634
ep26_l4_test_time 0.5518816349999724
gc 0
Train Epoch27 Acc 0.974675 (38987/40000), AUC 0.9962317943572998
ep27_train_time 6.406078987000001
Test Epoch27 layer0 Acc 0.881, AUC 0.9460408091545105, avg_entr 0.11069530248641968, f1 0.8809999823570251
ep27_l0_test_time 0.5420437340000035
Test Epoch27 layer1 Acc 0.8832, AUC 0.9474514722824097, avg_entr 0.09023496508598328, f1 0.8831999897956848
ep27_l1_test_time 0.5430690430000027
Test Epoch27 layer2 Acc 0.883, AUC 0.948215126991272, avg_entr 0.06873467564582825, f1 0.8830000162124634
ep27_l2_test_time 0.5458595580000178
Test Epoch27 layer3 Acc 0.8834, AUC 0.9437170028686523, avg_entr 0.032235682010650635, f1 0.8834000825881958
ep27_l3_test_time 0.5452869050000118
Test Epoch27 layer4 Acc 0.8834, AUC 0.9452064037322998, avg_entr 0.02139723114669323, f1 0.8834000825881958
ep27_l4_test_time 0.5508673069999759
gc 0
Train Epoch28 Acc 0.974525 (38981/40000), AUC 0.99638831615448
ep28_train_time 6.435741082999982
Test Epoch28 layer0 Acc 0.882, AUC 0.9460283517837524, avg_entr 0.11144901067018509, f1 0.8820000290870667
ep28_l0_test_time 0.5446754839999812
Test Epoch28 layer1 Acc 0.882, AUC 0.9474501609802246, avg_entr 0.09091414511203766, f1 0.8820000290870667
ep28_l1_test_time 0.5420133780000356
Test Epoch28 layer2 Acc 0.8814, AUC 0.9482114315032959, avg_entr 0.06951473653316498, f1 0.8813999891281128
ep28_l2_test_time 0.5421624140000176
Test Epoch28 layer3 Acc 0.8822, AUC 0.9443092346191406, avg_entr 0.032922521233558655, f1 0.8822000026702881
ep28_l3_test_time 0.5438668110000435
Test Epoch28 layer4 Acc 0.882, AUC 0.9462271928787231, avg_entr 0.02198527753353119, f1 0.8820000290870667
ep28_l4_test_time 0.5473521619999815
gc 0
Train Epoch29 Acc 0.9748 (38992/40000), AUC 0.9963325262069702
ep29_train_time 6.41879553199999
Test Epoch29 layer0 Acc 0.882, AUC 0.9459800720214844, avg_entr 0.11058934032917023, f1 0.8820000290870667
ep29_l0_test_time 0.5423970140000165
Test Epoch29 layer1 Acc 0.8828, AUC 0.9474018216133118, avg_entr 0.09011286497116089, f1 0.8827999830245972
ep29_l1_test_time 0.5450376509999728
Test Epoch29 layer2 Acc 0.883, AUC 0.9481799602508545, avg_entr 0.06860660016536713, f1 0.8830000162124634
ep29_l2_test_time 0.5443964339999638
Test Epoch29 layer3 Acc 0.8824, AUC 0.9441627860069275, avg_entr 0.03227154538035393, f1 0.8823999762535095
ep29_l3_test_time 0.5438512539999465
Test Epoch29 layer4 Acc 0.8828, AUC 0.9462891817092896, avg_entr 0.02151295356452465, f1 0.8827999830245972
ep29_l4_test_time 0.5447107570000185
Best AUC tensor(0.9010) 4 1
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 276.083114699
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8958, AUC 0.9556199908256531, avg_entr 0.1766914576292038, f1 0.895799994468689
l0_test_time 0.5481632460000014
Test layer1 Acc 0.8958, AUC 0.956062912940979, avg_entr 0.15280570089817047, f1 0.895799994468689
l1_test_time 0.54641639700003
Test layer2 Acc 0.8966, AUC 0.9565314054489136, avg_entr 0.14646604657173157, f1 0.8966000080108643
l2_test_time 0.5462373210000351
Test layer3 Acc 0.8956, AUC 0.9570125937461853, avg_entr 0.12236171960830688, f1 0.8956000208854675
l3_test_time 0.5467163639999626
Test layer4 Acc 0.8962, AUC 0.9573271870613098, avg_entr 0.08899302035570145, f1 0.8962000012397766
l4_test_time 0.5502430939999954
