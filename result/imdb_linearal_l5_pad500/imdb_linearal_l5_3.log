total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 21.557606303
Start Training
gc 0
Train Epoch0 Acc 0.518875 (20755/40000), AUC 0.5294972658157349
ep0_train_time 6.748142551000001
Test Epoch0 layer0 Acc 0.7872, AUC 0.8850270509719849, avg_entr 0.5743333101272583, f1 0.7871999740600586
ep0_l0_test_time 0.5415729320000011
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5506, AUC 0.8686643838882446, avg_entr 0.680148720741272, f1 0.550599992275238
ep0_l1_test_time 0.5386328129999995
Test Epoch0 layer2 Acc 0.5074, AUC 0.847025454044342, avg_entr 0.6799808144569397, f1 0.5073999762535095
ep0_l2_test_time 0.5425686519999999
Test Epoch0 layer3 Acc 0.5054, AUC 0.8203328847885132, avg_entr 0.6851162910461426, f1 0.5054000020027161
ep0_l3_test_time 0.5383573660000032
Test Epoch0 layer4 Acc 0.5338, AUC 0.8089056015014648, avg_entr 0.6869367957115173, f1 0.5338000059127808
ep0_l4_test_time 0.543100373999998
gc 0
Train Epoch1 Acc 0.81265 (32506/40000), AUC 0.8959587216377258
ep1_train_time 6.393965971999997
Test Epoch1 layer0 Acc 0.8704, AUC 0.9447512030601501, avg_entr 0.28919246792793274, f1 0.8704000115394592
ep1_l0_test_time 0.5380396819999973
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8676, AUC 0.9453787803649902, avg_entr 0.3369550406932831, f1 0.8675999641418457
ep1_l1_test_time 0.5420945790000005
Test Epoch1 layer2 Acc 0.8676, AUC 0.9455994367599487, avg_entr 0.2376558631658554, f1 0.8675999641418457
ep1_l2_test_time 0.5639583479999999
Test Epoch1 layer3 Acc 0.8572, AUC 0.9458554983139038, avg_entr 0.23875583708286285, f1 0.857200026512146
ep1_l3_test_time 0.5417146289999977
Test Epoch1 layer4 Acc 0.856, AUC 0.9461467862129211, avg_entr 0.22659838199615479, f1 0.8560000061988831
ep1_l4_test_time 0.5392615700000007
gc 0
Train Epoch2 Acc 0.90565 (36226/40000), AUC 0.9646334052085876
ep2_train_time 6.424989537000002
Test Epoch2 layer0 Acc 0.8934, AUC 0.9548909664154053, avg_entr 0.2291020303964615, f1 0.8934000134468079
ep2_l0_test_time 0.5388307210000036
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8944, AUC 0.955276370048523, avg_entr 0.21640171110630035, f1 0.8944000005722046
ep2_l1_test_time 0.5559382519999971
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8942, AUC 0.9554734826087952, avg_entr 0.20014065504074097, f1 0.8942000269889832
ep2_l2_test_time 0.5426499570000018
Test Epoch2 layer3 Acc 0.8936, AUC 0.9557826519012451, avg_entr 0.19415543973445892, f1 0.8935999870300293
ep2_l3_test_time 0.5411139970000036
Test Epoch2 layer4 Acc 0.894, AUC 0.9559768438339233, avg_entr 0.17858068645000458, f1 0.8939999938011169
ep2_l4_test_time 0.5399816979999983
gc 0
Train Epoch3 Acc 0.9221 (36884/40000), AUC 0.9754645228385925
ep3_train_time 6.342583558999998
Test Epoch3 layer0 Acc 0.897, AUC 0.9582546353340149, avg_entr 0.1970534473657608, f1 0.8970000147819519
ep3_l0_test_time 0.5389845589999993
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8986, AUC 0.9587743878364563, avg_entr 0.17914479970932007, f1 0.8985999822616577
ep3_l1_test_time 0.5399689810000012
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8976, AUC 0.9591227173805237, avg_entr 0.16670821607112885, f1 0.897599995136261
ep3_l2_test_time 0.5399533520000048
Test Epoch3 layer3 Acc 0.898, AUC 0.959370493888855, avg_entr 0.15116249024868011, f1 0.8980000019073486
ep3_l3_test_time 0.5376308499999993
Test Epoch3 layer4 Acc 0.8976, AUC 0.9596070647239685, avg_entr 0.12439969182014465, f1 0.897599995136261
ep3_l4_test_time 0.5418080190000012
gc 0
Train Epoch4 Acc 0.93535 (37414/40000), AUC 0.9812122583389282
ep4_train_time 6.500464293999997
Test Epoch4 layer0 Acc 0.898, AUC 0.9592203497886658, avg_entr 0.17974241077899933, f1 0.8980000019073486
ep4_l0_test_time 0.5361530119999998
Test Epoch4 layer1 Acc 0.8982, AUC 0.9596221446990967, avg_entr 0.1615525633096695, f1 0.8981999754905701
ep4_l1_test_time 0.5368997970000038
Test Epoch4 layer2 Acc 0.8984, AUC 0.9600721597671509, avg_entr 0.15247873961925507, f1 0.8984000086784363
ep4_l2_test_time 0.5407655180000006
Test Epoch4 layer3 Acc 0.8978, AUC 0.9604886770248413, avg_entr 0.1296524554491043, f1 0.8978000283241272
ep4_l3_test_time 0.586164691999997
Test Epoch4 layer4 Acc 0.8986, AUC 0.9611310958862305, avg_entr 0.09234050661325455, f1 0.8985999822616577
ep4_l4_test_time 0.6012104090000037
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9424 (37696/40000), AUC 0.9852887392044067
ep5_train_time 6.378165467000002
Test Epoch5 layer0 Acc 0.895, AUC 0.9584705829620361, avg_entr 0.16280359029769897, f1 0.8949999809265137
ep5_l0_test_time 0.5376641839999934
Test Epoch5 layer1 Acc 0.8976, AUC 0.9588093757629395, avg_entr 0.14500583708286285, f1 0.897599995136261
ep5_l1_test_time 0.5359519950000049
Test Epoch5 layer2 Acc 0.8972, AUC 0.9593886137008667, avg_entr 0.13398122787475586, f1 0.8971999883651733
ep5_l2_test_time 0.539431798999999
Test Epoch5 layer3 Acc 0.8972, AUC 0.9598730802536011, avg_entr 0.10139457136392593, f1 0.8971999883651733
ep5_l3_test_time 0.5406908759999993
Test Epoch5 layer4 Acc 0.8972, AUC 0.9602383375167847, avg_entr 0.06286938488483429, f1 0.8971999883651733
ep5_l4_test_time 0.5394973230000062
gc 0
Train Epoch6 Acc 0.949425 (37977/40000), AUC 0.9876974821090698
ep6_train_time 6.335078054000007
Test Epoch6 layer0 Acc 0.8754, AUC 0.957239031791687, avg_entr 0.1532008796930313, f1 0.8754000067710876
ep6_l0_test_time 0.5382675959999972
Test Epoch6 layer1 Acc 0.8838, AUC 0.9577974081039429, avg_entr 0.13556072115898132, f1 0.8838000297546387
ep6_l1_test_time 0.5400510620000034
Test Epoch6 layer2 Acc 0.8836, AUC 0.9586277008056641, avg_entr 0.12517517805099487, f1 0.8835999965667725
ep6_l2_test_time 0.5396220419999906
Test Epoch6 layer3 Acc 0.8832, AUC 0.959098756313324, avg_entr 0.08399226516485214, f1 0.8831999897956848
ep6_l3_test_time 0.5381890310000017
Test Epoch6 layer4 Acc 0.8838, AUC 0.9567927718162537, avg_entr 0.050242021679878235, f1 0.8838000297546387
ep6_l4_test_time 0.5614026719999998
gc 0
Train Epoch7 Acc 0.9551 (38204/40000), AUC 0.9892117381095886
ep7_train_time 6.3472164169999985
Test Epoch7 layer0 Acc 0.8958, AUC 0.9557832479476929, avg_entr 0.14631299674510956, f1 0.895799994468689
ep7_l0_test_time 0.5360651360000048
Test Epoch7 layer1 Acc 0.896, AUC 0.9565914273262024, avg_entr 0.12823818624019623, f1 0.8960000276565552
ep7_l1_test_time 0.535191822999991
Test Epoch7 layer2 Acc 0.8954, AUC 0.9577431678771973, avg_entr 0.11415719985961914, f1 0.8953999876976013
ep7_l2_test_time 0.537276134999999
Test Epoch7 layer3 Acc 0.8934, AUC 0.9582012891769409, avg_entr 0.06914691627025604, f1 0.8934000134468079
ep7_l3_test_time 0.5449996969999944
Test Epoch7 layer4 Acc 0.8942, AUC 0.9542744159698486, avg_entr 0.041379183530807495, f1 0.8942000269889832
ep7_l4_test_time 0.5394511370000004
gc 0
Train Epoch8 Acc 0.959075 (38363/40000), AUC 0.9906152486801147
ep8_train_time 6.346229339000004
Test Epoch8 layer0 Acc 0.8904, AUC 0.9541182518005371, avg_entr 0.14189793169498444, f1 0.8903999924659729
ep8_l0_test_time 0.5390136420000005
Test Epoch8 layer1 Acc 0.8926, AUC 0.9550039768218994, avg_entr 0.1241680160164833, f1 0.8925999999046326
ep8_l1_test_time 0.5386647429999982
Test Epoch8 layer2 Acc 0.8922, AUC 0.9562248587608337, avg_entr 0.10955346375703812, f1 0.8921999931335449
ep8_l2_test_time 0.5378248570000039
Test Epoch8 layer3 Acc 0.8922, AUC 0.9563943147659302, avg_entr 0.05875350162386894, f1 0.8921999931335449
ep8_l3_test_time 0.5377424640000044
Test Epoch8 layer4 Acc 0.8918, AUC 0.9529446959495544, avg_entr 0.036768946796655655, f1 0.8917999863624573
ep8_l4_test_time 0.5409048040000073
gc 0
Train Epoch9 Acc 0.96415 (38566/40000), AUC 0.9929252862930298
ep9_train_time 6.406703277999995
Test Epoch9 layer0 Acc 0.891, AUC 0.952916145324707, avg_entr 0.13582554459571838, f1 0.890999972820282
ep9_l0_test_time 0.5392294549999974
Test Epoch9 layer1 Acc 0.8916, AUC 0.9538202881813049, avg_entr 0.1181790679693222, f1 0.8916000127792358
ep9_l1_test_time 0.5365823629999937
Test Epoch9 layer2 Acc 0.8922, AUC 0.9550638198852539, avg_entr 0.10091029107570648, f1 0.8921999931335449
ep9_l2_test_time 0.5400995399999999
Test Epoch9 layer3 Acc 0.8922, AUC 0.9546066522598267, avg_entr 0.05166122317314148, f1 0.8921999931335449
ep9_l3_test_time 0.5403285200000028
Test Epoch9 layer4 Acc 0.8924, AUC 0.9504801034927368, avg_entr 0.03246486559510231, f1 0.8923999667167664
ep9_l4_test_time 0.5401233730000001
gc 0
Train Epoch10 Acc 0.96465 (38586/40000), AUC 0.99317467212677
ep10_train_time 6.389480555999995
Test Epoch10 layer0 Acc 0.8886, AUC 0.9519132375717163, avg_entr 0.13204771280288696, f1 0.8885999917984009
ep10_l0_test_time 0.5414029080000091
Test Epoch10 layer1 Acc 0.8902, AUC 0.952970027923584, avg_entr 0.11498711258172989, f1 0.8902000188827515
ep10_l1_test_time 0.5374654660000004
Test Epoch10 layer2 Acc 0.8904, AUC 0.9541785717010498, avg_entr 0.09775137901306152, f1 0.8903999924659729
ep10_l2_test_time 0.5402893589999991
Test Epoch10 layer3 Acc 0.8904, AUC 0.95303875207901, avg_entr 0.047120824456214905, f1 0.8903999924659729
ep10_l3_test_time 0.5399397680000106
Test Epoch10 layer4 Acc 0.8906, AUC 0.9497308731079102, avg_entr 0.02973581850528717, f1 0.8906000256538391
ep10_l4_test_time 0.5417309560000092
gc 0
Train Epoch11 Acc 0.966775 (38671/40000), AUC 0.9937209486961365
ep11_train_time 6.351869273999995
Test Epoch11 layer0 Acc 0.889, AUC 0.9507211446762085, avg_entr 0.1303098052740097, f1 0.8889999985694885
ep11_l0_test_time 0.5376289939999879
Test Epoch11 layer1 Acc 0.8884, AUC 0.951791524887085, avg_entr 0.11317045986652374, f1 0.8884000182151794
ep11_l1_test_time 0.5561962330000085
Test Epoch11 layer2 Acc 0.8892, AUC 0.9530083537101746, avg_entr 0.09334500133991241, f1 0.88919997215271
ep11_l2_test_time 0.5588780399999962
Test Epoch11 layer3 Acc 0.8888, AUC 0.9513696432113647, avg_entr 0.044346123933792114, f1 0.8888000249862671
ep11_l3_test_time 0.538768215999994
Test Epoch11 layer4 Acc 0.8892, AUC 0.9492560029029846, avg_entr 0.028319768607616425, f1 0.88919997215271
ep11_l4_test_time 0.5413214870000047
gc 0
Train Epoch12 Acc 0.96805 (38722/40000), AUC 0.9943245649337769
ep12_train_time 6.356443688000013
Test Epoch12 layer0 Acc 0.8866, AUC 0.9497870206832886, avg_entr 0.12697702646255493, f1 0.8866000771522522
ep12_l0_test_time 0.5429997189999938
Test Epoch12 layer1 Acc 0.8874, AUC 0.9509075284004211, avg_entr 0.11035528779029846, f1 0.8873999714851379
ep12_l1_test_time 0.5372285439999871
Test Epoch12 layer2 Acc 0.889, AUC 0.9521035552024841, avg_entr 0.09110891819000244, f1 0.8889999985694885
ep12_l2_test_time 0.539187725000005
Test Epoch12 layer3 Acc 0.888, AUC 0.9493329524993896, avg_entr 0.041884902864694595, f1 0.8880000114440918
ep12_l3_test_time 0.5413600389999829
Test Epoch12 layer4 Acc 0.888, AUC 0.9490686655044556, avg_entr 0.027062149718403816, f1 0.8880000114440918
ep12_l4_test_time 0.5428495150000003
gc 0
Train Epoch13 Acc 0.96995 (38798/40000), AUC 0.9949265718460083
ep13_train_time 6.428826813000001
Test Epoch13 layer0 Acc 0.8864, AUC 0.9490193128585815, avg_entr 0.12660591304302216, f1 0.8863999843597412
ep13_l0_test_time 0.536874006000005
Test Epoch13 layer1 Acc 0.8872, AUC 0.9503270387649536, avg_entr 0.10977339744567871, f1 0.8871999979019165
ep13_l1_test_time 0.5415895499999976
Test Epoch13 layer2 Acc 0.8872, AUC 0.951453685760498, avg_entr 0.08920637518167496, f1 0.8871999979019165
ep13_l2_test_time 0.5431076039999994
Test Epoch13 layer3 Acc 0.8872, AUC 0.9490513801574707, avg_entr 0.04075609892606735, f1 0.8871999979019165
ep13_l3_test_time 0.5392335070000058
Test Epoch13 layer4 Acc 0.8876, AUC 0.9484705328941345, avg_entr 0.025980742648243904, f1 0.8876000046730042
ep13_l4_test_time 0.5406781080000087
gc 0
Train Epoch14 Acc 0.97055 (38822/40000), AUC 0.9951452612876892
ep14_train_time 6.392974076000002
Test Epoch14 layer0 Acc 0.8856, AUC 0.9483805298805237, avg_entr 0.12487456947565079, f1 0.8855999708175659
ep14_l0_test_time 0.5363955159999989
Test Epoch14 layer1 Acc 0.8852, AUC 0.9495407342910767, avg_entr 0.10822060704231262, f1 0.8852000832557678
ep14_l1_test_time 0.5365024049999931
Test Epoch14 layer2 Acc 0.8866, AUC 0.9506570100784302, avg_entr 0.08710874617099762, f1 0.8866000771522522
ep14_l2_test_time 0.5386509040000078
Test Epoch14 layer3 Acc 0.8854, AUC 0.9473929405212402, avg_entr 0.040062908083200455, f1 0.8853999972343445
ep14_l3_test_time 0.5411758300000145
Test Epoch14 layer4 Acc 0.8848, AUC 0.9468022584915161, avg_entr 0.025831403210759163, f1 0.8848000168800354
ep14_l4_test_time 0.5413705820000132
gc 0
Train Epoch15 Acc 0.9708 (38832/40000), AUC 0.9952549934387207
ep15_train_time 6.3848143419999985
Test Epoch15 layer0 Acc 0.8844, AUC 0.9476631879806519, avg_entr 0.1245003268122673, f1 0.8844000101089478
ep15_l0_test_time 0.5373669340000049
Test Epoch15 layer1 Acc 0.8854, AUC 0.9490667581558228, avg_entr 0.10829830169677734, f1 0.8853999972343445
ep15_l1_test_time 0.5383033699999942
Test Epoch15 layer2 Acc 0.8854, AUC 0.9501488208770752, avg_entr 0.08815521001815796, f1 0.8853999972343445
ep15_l2_test_time 0.5374819719999948
Test Epoch15 layer3 Acc 0.8844, AUC 0.9471237659454346, avg_entr 0.03882414475083351, f1 0.8844000101089478
ep15_l3_test_time 0.5450774569999908
Test Epoch15 layer4 Acc 0.8846, AUC 0.9460543394088745, avg_entr 0.025435004383325577, f1 0.8845999836921692
ep15_l4_test_time 0.5423237749999998
gc 0
Train Epoch16 Acc 0.97165 (38866/40000), AUC 0.9952980279922485
ep16_train_time 6.400546054000017
Test Epoch16 layer0 Acc 0.8846, AUC 0.9473096132278442, avg_entr 0.12299773842096329, f1 0.8845999836921692
ep16_l0_test_time 0.5364241159999779
Test Epoch16 layer1 Acc 0.8846, AUC 0.9485933184623718, avg_entr 0.10666291415691376, f1 0.8845999836921692
ep16_l1_test_time 0.5393579580000107
Test Epoch16 layer2 Acc 0.885, AUC 0.9497288465499878, avg_entr 0.0857527032494545, f1 0.8849999904632568
ep16_l2_test_time 0.5377063849999786
Test Epoch16 layer3 Acc 0.8844, AUC 0.9466278553009033, avg_entr 0.03838445246219635, f1 0.8844000101089478
ep16_l3_test_time 0.5401159030000144
Test Epoch16 layer4 Acc 0.8844, AUC 0.9469709396362305, avg_entr 0.025429904460906982, f1 0.8844000101089478
ep16_l4_test_time 0.5529247730000009
gc 0
Train Epoch17 Acc 0.972425 (38897/40000), AUC 0.9956966042518616
ep17_train_time 6.517315216000014
Test Epoch17 layer0 Acc 0.8834, AUC 0.9468640089035034, avg_entr 0.12064196914434433, f1 0.8834000825881958
ep17_l0_test_time 0.5414629900000136
Test Epoch17 layer1 Acc 0.8828, AUC 0.9481217265129089, avg_entr 0.10458779335021973, f1 0.8827999830245972
ep17_l1_test_time 0.5373118619999957
Test Epoch17 layer2 Acc 0.8834, AUC 0.9492220878601074, avg_entr 0.08326455950737, f1 0.8834000825881958
ep17_l2_test_time 0.5379740440000091
Test Epoch17 layer3 Acc 0.8832, AUC 0.9452924728393555, avg_entr 0.037171851843595505, f1 0.8831999897956848
ep17_l3_test_time 0.5392665710000131
Test Epoch17 layer4 Acc 0.8832, AUC 0.9447588920593262, avg_entr 0.024791983887553215, f1 0.8831999897956848
ep17_l4_test_time 0.5416601219999961
gc 0
Train Epoch18 Acc 0.9732 (38928/40000), AUC 0.9956293106079102
ep18_train_time 6.4097137859999975
Test Epoch18 layer0 Acc 0.8818, AUC 0.9465993642807007, avg_entr 0.11940109729766846, f1 0.8818000555038452
ep18_l0_test_time 0.5436342669999874
Test Epoch18 layer1 Acc 0.8832, AUC 0.9479124546051025, avg_entr 0.10343831777572632, f1 0.8831999897956848
ep18_l1_test_time 0.5570165089999932
Test Epoch18 layer2 Acc 0.8826, AUC 0.9489971399307251, avg_entr 0.08194528520107269, f1 0.8826000094413757
ep18_l2_test_time 0.542733386000009
Test Epoch18 layer3 Acc 0.882, AUC 0.9451208114624023, avg_entr 0.035748884081840515, f1 0.8820000290870667
ep18_l3_test_time 0.5463444250000009
Test Epoch18 layer4 Acc 0.882, AUC 0.9463908672332764, avg_entr 0.02349838800728321, f1 0.8820000290870667
ep18_l4_test_time 0.5460925399999894
gc 0
Train Epoch19 Acc 0.973525 (38941/40000), AUC 0.9957460165023804
ep19_train_time 6.369043772000026
Test Epoch19 layer0 Acc 0.8826, AUC 0.9463160634040833, avg_entr 0.11980235576629639, f1 0.8826000094413757
ep19_l0_test_time 0.5421618369999806
Test Epoch19 layer1 Acc 0.8832, AUC 0.9476876258850098, avg_entr 0.10396058112382889, f1 0.8831999897956848
ep19_l1_test_time 0.5375144469999782
Test Epoch19 layer2 Acc 0.8836, AUC 0.9487252235412598, avg_entr 0.08207959681749344, f1 0.8835999965667725
ep19_l2_test_time 0.5388482390000036
Test Epoch19 layer3 Acc 0.8834, AUC 0.9447223544120789, avg_entr 0.03622065857052803, f1 0.8834000825881958
ep19_l3_test_time 0.5433743070000219
Test Epoch19 layer4 Acc 0.8844, AUC 0.9450910091400146, avg_entr 0.02422088384628296, f1 0.8844000101089478
ep19_l4_test_time 0.5516287970000064
gc 0
Train Epoch20 Acc 0.973425 (38937/40000), AUC 0.9958027601242065
ep20_train_time 6.405348533999984
Test Epoch20 layer0 Acc 0.8806, AUC 0.9460592865943909, avg_entr 0.11808410286903381, f1 0.8805999755859375
ep20_l0_test_time 0.5370808360000012
Test Epoch20 layer1 Acc 0.8808, AUC 0.9474146366119385, avg_entr 0.10228034853935242, f1 0.8808000087738037
ep20_l1_test_time 0.5376585309999768
Test Epoch20 layer2 Acc 0.8814, AUC 0.9485175609588623, avg_entr 0.08061452955007553, f1 0.8813999891281128
ep20_l2_test_time 0.53869057
Test Epoch20 layer3 Acc 0.8818, AUC 0.9449055194854736, avg_entr 0.0353020578622818, f1 0.8818000555038452
ep20_l3_test_time 0.541879133000009
Test Epoch20 layer4 Acc 0.8814, AUC 0.9450932145118713, avg_entr 0.023852577432990074, f1 0.8813999891281128
ep20_l4_test_time 0.5418741919999945
gc 0
Train Epoch21 Acc 0.973925 (38957/40000), AUC 0.996060848236084
ep21_train_time 6.311285577999996
Test Epoch21 layer0 Acc 0.8808, AUC 0.9459113478660583, avg_entr 0.11769203841686249, f1 0.8808000087738037
ep21_l0_test_time 0.5437194769999962
Test Epoch21 layer1 Acc 0.881, AUC 0.9472638368606567, avg_entr 0.1017131432890892, f1 0.8809999823570251
ep21_l1_test_time 0.5384485980000022
Test Epoch21 layer2 Acc 0.8808, AUC 0.9483135938644409, avg_entr 0.07948309183120728, f1 0.8808000087738037
ep21_l2_test_time 0.5381965060000198
Test Epoch21 layer3 Acc 0.881, AUC 0.9440872669219971, avg_entr 0.03475601598620415, f1 0.8809999823570251
ep21_l3_test_time 0.5437800180000067
Test Epoch21 layer4 Acc 0.8812, AUC 0.9444830417633057, avg_entr 0.02318732626736164, f1 0.8812000155448914
ep21_l4_test_time 0.5497730869999771
gc 0
Train Epoch22 Acc 0.9744 (38976/40000), AUC 0.9960837364196777
ep22_train_time 6.346011473999994
Test Epoch22 layer0 Acc 0.8806, AUC 0.9457458257675171, avg_entr 0.11812140047550201, f1 0.8805999755859375
ep22_l0_test_time 0.5367778450000174
Test Epoch22 layer1 Acc 0.8812, AUC 0.947149395942688, avg_entr 0.10222440212965012, f1 0.8812000155448914
ep22_l1_test_time 0.5400630890000002
Test Epoch22 layer2 Acc 0.8822, AUC 0.9481596946716309, avg_entr 0.08016885071992874, f1 0.8822000026702881
ep22_l2_test_time 0.5383353940000006
Test Epoch22 layer3 Acc 0.8822, AUC 0.9442811608314514, avg_entr 0.03563566878437996, f1 0.8822000026702881
ep22_l3_test_time 0.5400669850000099
Test Epoch22 layer4 Acc 0.8816, AUC 0.9446940422058105, avg_entr 0.024311058223247528, f1 0.881600022315979
ep22_l4_test_time 0.5404294200000095
gc 0
Train Epoch23 Acc 0.974075 (38963/40000), AUC 0.9961111545562744
ep23_train_time 6.316166316000022
Test Epoch23 layer0 Acc 0.8802, AUC 0.9455839991569519, avg_entr 0.11699848622083664, f1 0.8802000284194946
ep23_l0_test_time 0.5392856290000054
Test Epoch23 layer1 Acc 0.8794, AUC 0.946979820728302, avg_entr 0.10111498087644577, f1 0.8794000148773193
ep23_l1_test_time 0.5384937620000017
Test Epoch23 layer2 Acc 0.881, AUC 0.9480100870132446, avg_entr 0.07911643385887146, f1 0.8809999823570251
ep23_l2_test_time 0.5394803729999751
Test Epoch23 layer3 Acc 0.8812, AUC 0.9436051845550537, avg_entr 0.03485419973731041, f1 0.8812000155448914
ep23_l3_test_time 0.5420323740000015
Test Epoch23 layer4 Acc 0.8818, AUC 0.9441679120063782, avg_entr 0.023730449378490448, f1 0.8818000555038452
ep23_l4_test_time 0.5425905369999953
gc 0
Train Epoch24 Acc 0.97455 (38982/40000), AUC 0.9962788224220276
ep24_train_time 6.333567364000004
Test Epoch24 layer0 Acc 0.8806, AUC 0.9454411864280701, avg_entr 0.11591748148202896, f1 0.8805999755859375
ep24_l0_test_time 0.5391259650000109
Test Epoch24 layer1 Acc 0.879, AUC 0.9468405246734619, avg_entr 0.1001136526465416, f1 0.8790000081062317
ep24_l1_test_time 0.5378972819999888
Test Epoch24 layer2 Acc 0.8802, AUC 0.9478554129600525, avg_entr 0.07764845341444016, f1 0.8802000284194946
ep24_l2_test_time 0.5383918320000021
Test Epoch24 layer3 Acc 0.8804, AUC 0.9436439275741577, avg_entr 0.034078117460012436, f1 0.8804000020027161
ep24_l3_test_time 0.5384835979999991
Test Epoch24 layer4 Acc 0.8804, AUC 0.9444728493690491, avg_entr 0.023002086207270622, f1 0.8804000020027161
ep24_l4_test_time 0.5471269440000128
gc 0
Train Epoch25 Acc 0.974675 (38987/40000), AUC 0.9961644411087036
ep25_train_time 6.330124630999961
Test Epoch25 layer0 Acc 0.88, AUC 0.9453462362289429, avg_entr 0.11533499509096146, f1 0.8799999952316284
ep25_l0_test_time 0.5544441680000318
Test Epoch25 layer1 Acc 0.8798, AUC 0.9467523097991943, avg_entr 0.09964969009160995, f1 0.879800021648407
ep25_l1_test_time 0.5479200749999791
Test Epoch25 layer2 Acc 0.8798, AUC 0.9477789402008057, avg_entr 0.07737232744693756, f1 0.879800021648407
ep25_l2_test_time 0.5489750589999858
Test Epoch25 layer3 Acc 0.8792, AUC 0.9432480335235596, avg_entr 0.0338054783642292, f1 0.8791999816894531
ep25_l3_test_time 0.5433054760000005
Test Epoch25 layer4 Acc 0.8788, AUC 0.9438701868057251, avg_entr 0.02276208996772766, f1 0.8787999749183655
ep25_l4_test_time 0.5394490029999588
gc 0
Train Epoch26 Acc 0.9745 (38980/40000), AUC 0.9963468909263611
ep26_train_time 6.366351122000026
Test Epoch26 layer0 Acc 0.8806, AUC 0.9452868700027466, avg_entr 0.11510289460420609, f1 0.8805999755859375
ep26_l0_test_time 0.5396430460000374
Test Epoch26 layer1 Acc 0.8792, AUC 0.9467052221298218, avg_entr 0.09941329807043076, f1 0.8791999816894531
ep26_l1_test_time 0.5537123790000464
Test Epoch26 layer2 Acc 0.8796, AUC 0.947728157043457, avg_entr 0.07729314267635345, f1 0.8795999884605408
ep26_l2_test_time 0.5397810599999957
Test Epoch26 layer3 Acc 0.8804, AUC 0.9433722496032715, avg_entr 0.03381712734699249, f1 0.8804000020027161
ep26_l3_test_time 0.5392465510000193
Test Epoch26 layer4 Acc 0.8808, AUC 0.9439598321914673, avg_entr 0.02296089567244053, f1 0.8808000087738037
ep26_l4_test_time 0.5414538650000509
gc 0
Train Epoch27 Acc 0.974325 (38973/40000), AUC 0.9962877035140991
ep27_train_time 6.397921757000006
Test Epoch27 layer0 Acc 0.8808, AUC 0.9452204704284668, avg_entr 0.11403051763772964, f1 0.8808000087738037
ep27_l0_test_time 0.5384761079999976
Test Epoch27 layer1 Acc 0.88, AUC 0.9466243982315063, avg_entr 0.09844998270273209, f1 0.8799999952316284
ep27_l1_test_time 0.5356167840000126
Test Epoch27 layer2 Acc 0.8812, AUC 0.9476441740989685, avg_entr 0.07608941942453384, f1 0.8812000155448914
ep27_l2_test_time 0.5395842340000172
Test Epoch27 layer3 Acc 0.8794, AUC 0.9431983828544617, avg_entr 0.03260409086942673, f1 0.8794000148773193
ep27_l3_test_time 0.5395557400000257
Test Epoch27 layer4 Acc 0.8804, AUC 0.9441870450973511, avg_entr 0.02165638469159603, f1 0.8804000020027161
ep27_l4_test_time 0.5401879320000376
gc 0
Train Epoch28 Acc 0.97485 (38994/40000), AUC 0.9963268041610718
ep28_train_time 6.346091812999987
Test Epoch28 layer0 Acc 0.881, AUC 0.9451456665992737, avg_entr 0.11381186544895172, f1 0.8809999823570251
ep28_l0_test_time 0.5402592169999707
Test Epoch28 layer1 Acc 0.8796, AUC 0.9465522170066833, avg_entr 0.09821289032697678, f1 0.8795999884605408
ep28_l1_test_time 0.5362549650000119
Test Epoch28 layer2 Acc 0.88, AUC 0.9475729465484619, avg_entr 0.0760994628071785, f1 0.8799999952316284
ep28_l2_test_time 0.5364944699999796
Test Epoch28 layer3 Acc 0.879, AUC 0.9427849054336548, avg_entr 0.033020876348018646, f1 0.8790000081062317
ep28_l3_test_time 0.54022876800002
Test Epoch28 layer4 Acc 0.8788, AUC 0.9436646699905396, avg_entr 0.022084783762693405, f1 0.8787999749183655
ep28_l4_test_time 0.5437564960000145
gc 0
Train Epoch29 Acc 0.97475 (38990/40000), AUC 0.9963284134864807
ep29_train_time 6.406642792000014
Test Epoch29 layer0 Acc 0.8784, AUC 0.9451408386230469, avg_entr 0.11438830196857452, f1 0.8784000277519226
ep29_l0_test_time 0.5382078879999881
Test Epoch29 layer1 Acc 0.8796, AUC 0.9465709924697876, avg_entr 0.09870918840169907, f1 0.8795999884605408
ep29_l1_test_time 0.5455862720000368
Test Epoch29 layer2 Acc 0.8806, AUC 0.9475722908973694, avg_entr 0.07665969431400299, f1 0.8805999755859375
ep29_l2_test_time 0.5436933230000136
Test Epoch29 layer3 Acc 0.8806, AUC 0.9432439804077148, avg_entr 0.033959344029426575, f1 0.8805999755859375
ep29_l3_test_time 0.5407131739999613
Test Epoch29 layer4 Acc 0.88, AUC 0.9438202381134033, avg_entr 0.023298250511288643, f1 0.8799999952316284
ep29_l4_test_time 0.5420487079999816
Best AUC tensor(0.8986) 4 4
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 274.644934751
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8948, AUC 0.9560834169387817, avg_entr 0.18044015765190125, f1 0.8948000073432922
l0_test_time 0.53982505700003
Test layer1 Acc 0.8948, AUC 0.9565489888191223, avg_entr 0.16302885115146637, f1 0.8948000073432922
l1_test_time 0.5392433459999779
Test layer2 Acc 0.896, AUC 0.956931471824646, avg_entr 0.154828742146492, f1 0.8960000276565552
l2_test_time 0.53962114899997
Test layer3 Acc 0.8952, AUC 0.9573190212249756, avg_entr 0.13313961029052734, f1 0.8952000141143799
l3_test_time 0.5386923650000313
Test layer4 Acc 0.8936, AUC 0.9577862620353699, avg_entr 0.09687158465385437, f1 0.8935999870300293
l4_test_time 0.5457029240000111
