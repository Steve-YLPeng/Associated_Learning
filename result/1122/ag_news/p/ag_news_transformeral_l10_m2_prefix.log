total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask1//ag_news/ag_news_transformeral_l10_m1.pt
Start Training
gc 9
Train Epoch0 Acc 0.09308333333333334 (11170/120000), AUC 0.3413977026939392
Test Epoch0 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch0 layer1 Acc 0.9155263157894736, AUC 0.9800360202789307
Save ckpt to ./ckpt/mask2//ag_news/ag_news_transformeral_l10_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.2506578947368421, AUC 0.943168044090271
Test Epoch0 layer3 Acc 0.25, AUC 0.32200872898101807
Test Epoch0 layer4 Acc 0.24355263157894738, AUC 0.4028032720088959
Test Epoch0 layer5 Acc 0.25, AUC 0.673888623714447
Test Epoch0 layer6 Acc 0.25, AUC 0.30076414346694946
Test Epoch0 layer7 Acc 0.24513157894736842, AUC 0.2361190915107727
Test Epoch0 layer8 Acc 0.25, AUC 0.3226812183856964
Test Epoch0 layer9 Acc 0.026973684210526316, AUC 0.2644103169441223
gc 0
Train Epoch1 Acc 0.05350833333333333 (6421/120000), AUC 0.27303212881088257
Test Epoch1 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch1 layer1 Acc 0.9156578947368421, AUC 0.9808440208435059
Save ckpt to ./ckpt/mask2//ag_news/ag_news_transformeral_l10_m2.pt  ,ep 1
Test Epoch1 layer2 Acc 0.25592105263157894, AUC 0.9443828463554382
Test Epoch1 layer3 Acc 0.25, AUC 0.32966911792755127
Test Epoch1 layer4 Acc 0.2417105263157895, AUC 0.3777238726615906
Test Epoch1 layer5 Acc 0.25, AUC 0.6717973351478577
Test Epoch1 layer6 Acc 0.25, AUC 0.33794909715652466
Test Epoch1 layer7 Acc 0.2488157894736842, AUC 0.24303755164146423
Test Epoch1 layer8 Acc 0.25, AUC 0.3526383638381958
Test Epoch1 layer9 Acc 0.06947368421052631, AUC 0.26571667194366455
gc 0
Train Epoch2 Acc 0.09866666666666667 (11840/120000), AUC 0.2693605422973633
Test Epoch2 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch2 layer1 Acc 0.9160526315789473, AUC 0.9807705283164978
Test Epoch2 layer2 Acc 0.40407894736842104, AUC 0.9510083794593811
Test Epoch2 layer3 Acc 0.25, AUC 0.37255972623825073
Test Epoch2 layer4 Acc 0.19697368421052633, AUC 0.40111202001571655
Test Epoch2 layer5 Acc 0.25, AUC 0.674851655960083
Test Epoch2 layer6 Acc 0.25, AUC 0.35086870193481445
Test Epoch2 layer7 Acc 0.25, AUC 0.26886850595474243
Test Epoch2 layer8 Acc 0.25, AUC 0.3795361816883087
Test Epoch2 layer9 Acc 0.1006578947368421, AUC 0.27180472016334534
gc 0
Train Epoch3 Acc 0.10104166666666667 (12125/120000), AUC 0.27560529112815857
Test Epoch3 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch3 layer1 Acc 0.9147368421052632, AUC 0.9788668155670166
Test Epoch3 layer2 Acc 0.4986842105263158, AUC 0.958694577217102
Test Epoch3 layer3 Acc 0.25, AUC 0.42651453614234924
Test Epoch3 layer4 Acc 0.19105263157894736, AUC 0.44601544737815857
Test Epoch3 layer5 Acc 0.25, AUC 0.6708112359046936
Test Epoch3 layer6 Acc 0.25, AUC 0.35705500841140747
Test Epoch3 layer7 Acc 0.25, AUC 0.3229914605617523
Test Epoch3 layer8 Acc 0.25, AUC 0.4167100787162781
Test Epoch3 layer9 Acc 0.08789473684210526, AUC 0.2843584418296814
gc 0
Train Epoch4 Acc 0.12713333333333332 (15256/120000), AUC 0.29366335272789
Test Epoch4 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch4 layer1 Acc 0.9161842105263158, AUC 0.9792501926422119
Test Epoch4 layer2 Acc 0.4305263157894737, AUC 0.9635688066482544
Test Epoch4 layer3 Acc 0.25, AUC 0.4603756070137024
Test Epoch4 layer4 Acc 0.2088157894736842, AUC 0.44869258999824524
Test Epoch4 layer5 Acc 0.25, AUC 0.642288327217102
Test Epoch4 layer6 Acc 0.25, AUC 0.3784843981266022
Test Epoch4 layer7 Acc 0.25, AUC 0.38153013586997986
Test Epoch4 layer8 Acc 0.25, AUC 0.45624029636383057
Test Epoch4 layer9 Acc 0.1725, AUC 0.30501484870910645
gc 0
Train Epoch5 Acc 0.2536 (30432/120000), AUC 0.34896743297576904
Test Epoch5 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch5 layer1 Acc 0.9156578947368421, AUC 0.9771546125411987
Test Epoch5 layer2 Acc 0.41736842105263156, AUC 0.9647603034973145
Test Epoch5 layer3 Acc 0.25, AUC 0.5050510168075562
Test Epoch5 layer4 Acc 0.20605263157894738, AUC 0.44503405690193176
Test Epoch5 layer5 Acc 0.25, AUC 0.5887821316719055
Test Epoch5 layer6 Acc 0.25, AUC 0.3960406482219696
Test Epoch5 layer7 Acc 0.24986842105263157, AUC 0.493162602186203
Test Epoch5 layer8 Acc 0.25, AUC 0.532467246055603
Test Epoch5 layer9 Acc 0.2906578947368421, AUC 0.381927490234375
gc 0
Train Epoch6 Acc 0.3151833333333333 (37822/120000), AUC 0.3947597146034241
Test Epoch6 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch6 layer1 Acc 0.9172368421052631, AUC 0.9767113327980042
Test Epoch6 layer2 Acc 0.4317105263157895, AUC 0.9648734331130981
Test Epoch6 layer3 Acc 0.25, AUC 0.5127696394920349
Test Epoch6 layer4 Acc 0.19013157894736843, AUC 0.45294255018234253
Test Epoch6 layer5 Acc 0.25, AUC 0.5591995120048523
Test Epoch6 layer6 Acc 0.25, AUC 0.4178030788898468
Test Epoch6 layer7 Acc 0.25, AUC 0.5379223227500916
Test Epoch6 layer8 Acc 0.25, AUC 0.5590765476226807
Test Epoch6 layer9 Acc 0.3057894736842105, AUC 0.41262906789779663
gc 0
Train Epoch7 Acc 0.31704166666666667 (38045/120000), AUC 0.4186994433403015
Test Epoch7 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch7 layer1 Acc 0.9144736842105263, AUC 0.9773418307304382
Test Epoch7 layer2 Acc 0.44026315789473686, AUC 0.9643638134002686
Test Epoch7 layer3 Acc 0.25, AUC 0.5170885920524597
Test Epoch7 layer4 Acc 0.19092105263157894, AUC 0.46777111291885376
Test Epoch7 layer5 Acc 0.25, AUC 0.5406041741371155
Test Epoch7 layer6 Acc 0.25, AUC 0.4364114999771118
Test Epoch7 layer7 Acc 0.24644736842105264, AUC 0.5532748699188232
Test Epoch7 layer8 Acc 0.25, AUC 0.5982264280319214
Test Epoch7 layer9 Acc 0.3082894736842105, AUC 0.4333500564098358
gc 0
Train Epoch8 Acc 0.303175 (36381/120000), AUC 0.4324742555618286
Test Epoch8 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch8 layer1 Acc 0.9152631578947369, AUC 0.9766489863395691
Test Epoch8 layer2 Acc 0.4411842105263158, AUC 0.9612728953361511
Test Epoch8 layer3 Acc 0.25, AUC 0.5266541838645935
Test Epoch8 layer4 Acc 0.19092105263157894, AUC 0.4919752776622772
Test Epoch8 layer5 Acc 0.25, AUC 0.5269367694854736
Test Epoch8 layer6 Acc 0.25, AUC 0.4505043625831604
Test Epoch8 layer7 Acc 0.24526315789473685, AUC 0.5690670013427734
Test Epoch8 layer8 Acc 0.25, AUC 0.6143067479133606
Test Epoch8 layer9 Acc 0.2755263157894737, AUC 0.44181928038597107
gc 0
Train Epoch9 Acc 0.2829583333333333 (33955/120000), AUC 0.44422557950019836
Test Epoch9 layer0 Acc 0.9147368421052632, AUC 0.9814596176147461
Test Epoch9 layer1 Acc 0.9167105263157894, AUC 0.9765428304672241
Test Epoch9 layer2 Acc 0.43934210526315787, AUC 0.9593790769577026
Test Epoch9 layer3 Acc 0.25, AUC 0.5422424674034119
Test Epoch9 layer4 Acc 0.1886842105263158, AUC 0.5106765031814575
Test Epoch9 layer5 Acc 0.25, AUC 0.5189400911331177
Test Epoch9 layer6 Acc 0.25, AUC 0.49204182624816895
Test Epoch9 layer7 Acc 0.22907894736842105, AUC 0.5649815797805786
Test Epoch9 layer8 Acc 0.25, AUC 0.6060681343078613
Test Epoch9 layer9 Acc 0.26644736842105265, AUC 0.44959014654159546
Best AUC 0.9808440208435059
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//ag_news/ag_news_transformeral_l10_m2.pt
[[1712   58   90   40]
 [  16 1862   13    9]
 [  47   10 1701  142]
 [  61   13  149 1677]]
Figure(640x480)
[[1695   63   84   58]
 [   9 1872    7   12]
 [  44   21 1660  175]
 [  40   16  112 1732]]
Figure(640x480)
[[   0    0    0 1900]
 [   0   16    0 1884]
 [   0    0   29 1871]
 [   0    0    0 1900]]
Figure(640x480)
[[   0    0 1900    0]
 [   0    0 1900    0]
 [   0    0 1900    0]
 [   0    0 1900    0]]
Figure(640x480)
[[1837   63    0    0]
 [1900    0    0    0]
 [1900    0    0    0]
 [1899    1    0    0]]
Figure(640x480)
[[   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]]
Figure(640x480)
[[   0    0    0 1900]
 [   0    0    0 1900]
 [   0    0    0 1900]
 [   0    0    0 1900]]
Figure(640x480)
[[   0    0 1900    0]
 [   0    0 1900    0]
 [   9    0 1891    0]
 [   0    0 1900    0]]
Figure(640x480)
[[   0    0    0 1900]
 [   0    0    0 1900]
 [   0    0    0 1900]
 [   0    0    0 1900]]
Figure(640x480)
[[   0   25    4 1871]
 [   0    3    0 1897]
 [   0  260    1 1639]
 [   0 1289   87  524]]
Figure(640x480)
