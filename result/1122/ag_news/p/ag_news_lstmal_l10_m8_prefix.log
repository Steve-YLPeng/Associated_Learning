total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask7//ag_news/ag_news_lstmal_l10_m7.pt
Start Training
gc 9
Train Epoch0 Acc 0.0941 (11292/120000), AUC 0.1617744117975235
Test Epoch0 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch0 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch0 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch0 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch0 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch0 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch0 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch0 layer7 Acc 0.9127631578947368, AUC 0.9809415936470032
Save ckpt to ./ckpt/mask8//ag_news/ag_news_lstmal_l10_m8.pt  ,ep 0
Test Epoch0 layer8 Acc 0.44355263157894737, AUC 0.5433999300003052
Test Epoch0 layer9 Acc 0.031710526315789474, AUC 0.1657477170228958
gc 0
Train Epoch1 Acc 0.017 (2040/120000), AUC 0.1535506397485733
Test Epoch1 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch1 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch1 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch1 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch1 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch1 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch1 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch1 layer7 Acc 0.9131578947368421, AUC 0.9815098643302917
Save ckpt to ./ckpt/mask8//ag_news/ag_news_lstmal_l10_m8.pt  ,ep 1
Test Epoch1 layer8 Acc 0.44276315789473686, AUC 0.5309579968452454
Test Epoch1 layer9 Acc 0.032105263157894734, AUC 0.15450140833854675
gc 0
Train Epoch2 Acc 0.017558333333333332 (2107/120000), AUC 0.15555694699287415
Test Epoch2 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch2 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch2 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch2 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch2 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch2 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch2 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch2 layer7 Acc 0.9134210526315789, AUC 0.981633722782135
Save ckpt to ./ckpt/mask8//ag_news/ag_news_lstmal_l10_m8.pt  ,ep 2
Test Epoch2 layer8 Acc 0.44144736842105264, AUC 0.5346970558166504
Test Epoch2 layer9 Acc 0.034342105263157896, AUC 0.1616886705160141
gc 0
Train Epoch3 Acc 0.018883333333333332 (2266/120000), AUC 0.15755096077919006
Test Epoch3 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch3 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch3 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch3 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch3 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch3 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch3 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch3 layer7 Acc 0.9146052631578947, AUC 0.98180091381073
Save ckpt to ./ckpt/mask8//ag_news/ag_news_lstmal_l10_m8.pt  ,ep 3
Test Epoch3 layer8 Acc 0.4406578947368421, AUC 0.533381462097168
Test Epoch3 layer9 Acc 0.035263157894736843, AUC 0.16194792091846466
gc 0
Train Epoch4 Acc 0.020666666666666667 (2480/120000), AUC 0.1579744964838028
Test Epoch4 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch4 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch4 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch4 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch4 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch4 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch4 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch4 layer7 Acc 0.9147368421052632, AUC 0.9818648099899292
Save ckpt to ./ckpt/mask8//ag_news/ag_news_lstmal_l10_m8.pt  ,ep 4
Test Epoch4 layer8 Acc 0.4394736842105263, AUC 0.5002160668373108
Test Epoch4 layer9 Acc 0.037894736842105266, AUC 0.16409577429294586
gc 0
Train Epoch5 Acc 0.02205 (2646/120000), AUC 0.15843641757965088
Test Epoch5 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch5 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch5 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch5 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch5 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch5 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch5 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch5 layer7 Acc 0.9143421052631578, AUC 0.9810450077056885
Test Epoch5 layer8 Acc 0.4392105263157895, AUC 0.48882418870925903
Test Epoch5 layer9 Acc 0.04052631578947368, AUC 0.1654963195323944
gc 0
Train Epoch6 Acc 0.023416666666666665 (2810/120000), AUC 0.1583135724067688
Test Epoch6 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch6 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch6 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch6 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch6 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch6 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch6 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch6 layer7 Acc 0.9151315789473684, AUC 0.9822145700454712
Save ckpt to ./ckpt/mask8//ag_news/ag_news_lstmal_l10_m8.pt  ,ep 6
Test Epoch6 layer8 Acc 0.4373684210526316, AUC 0.48865723609924316
Test Epoch6 layer9 Acc 0.041578947368421056, AUC 0.16560117900371552
gc 0
Train Epoch7 Acc 0.024825 (2979/120000), AUC 0.1593015044927597
Test Epoch7 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch7 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch7 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch7 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch7 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch7 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch7 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch7 layer7 Acc 0.9142105263157895, AUC 0.9820364713668823
Test Epoch7 layer8 Acc 0.4236842105263158, AUC 0.46545910835266113
Test Epoch7 layer9 Acc 0.042236842105263156, AUC 0.1650846302509308
gc 0
Train Epoch8 Acc 0.025258333333333334 (3031/120000), AUC 0.16030047833919525
Test Epoch8 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch8 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch8 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch8 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch8 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch8 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch8 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch8 layer7 Acc 0.9138157894736842, AUC 0.9824546575546265
Save ckpt to ./ckpt/mask8//ag_news/ag_news_lstmal_l10_m8.pt  ,ep 8
Test Epoch8 layer8 Acc 0.4286842105263158, AUC 0.4696442484855652
Test Epoch8 layer9 Acc 0.043289473684210523, AUC 0.16548240184783936
gc 0
Train Epoch9 Acc 0.026075 (3129/120000), AUC 0.16060972213745117
Test Epoch9 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch9 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch9 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch9 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Test Epoch9 layer4 Acc 0.9147368421052632, AUC 0.9817032217979431
Test Epoch9 layer5 Acc 0.9147368421052632, AUC 0.9832757711410522
Test Epoch9 layer6 Acc 0.9142105263157895, AUC 0.9834202527999878
Test Epoch9 layer7 Acc 0.9148684210526316, AUC 0.9825167059898376
Save ckpt to ./ckpt/mask8//ag_news/ag_news_lstmal_l10_m8.pt  ,ep 9
Test Epoch9 layer8 Acc 0.43342105263157893, AUC 0.4857059419155121
Test Epoch9 layer9 Acc 0.04381578947368421, AUC 0.16684819757938385
Best AUC 0.9825167059898376
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask8//ag_news/ag_news_lstmal_l10_m8.pt
[[1694   64   95   47]
 [  11 1870   10    9]
 [  39   19 1682  160]
 [  43   16  151 1690]]
Figure(640x480)
[[1723   52   70   55]
 [  24 1852   12   12]
 [  53   16 1658  173]
 [  48   17  124 1711]]
Figure(640x480)
[[1722   50   75   53]
 [  22 1851   15   12]
 [  49   15 1676  160]
 [  51   17  138 1694]]
Figure(640x480)
[[1717   50   75   58]
 [  22 1850   15   13]
 [  44   15 1676  165]
 [  43   16  131 1710]]
Figure(640x480)
[[1714   52   74   60]
 [  20 1854   13   13]
 [  43   16 1669  172]
 [  42   16  127 1715]]
Figure(640x480)
[[1718   51   74   57]
 [  22 1853   14   11]
 [  46   15 1672  167]
 [  46   16  129 1709]]
Figure(640x480)
[[1716   51   75   58]
 [  22 1852   15   11]
 [  45   14 1675  166]
 [  45   15  135 1705]]
Figure(640x480)
[[1718   51   73   58]
 [  19 1857   13   11]
 [  46   16 1667  171]
 [  44   16  129 1711]]
Figure(640x480)
[[   0 1706   44  150]
 [   0   26    6 1868]
 [   0  132 1506  262]
 [   0   76   62 1762]]
Figure(640x480)
[[  42    0    0 1858]
 [   5    0    0 1895]
 [ 110    0    0 1790]
 [1609    0    0  291]]
Figure(640x480)
