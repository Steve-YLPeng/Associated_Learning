total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask3//ag_news/ag_news_linearal_l10_m3.pt
Start Training
gc 9
Train Epoch0 Acc 0.035575 (4269/120000), AUC 0.5103675127029419
Test Epoch0 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch0 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch0 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch0 layer3 Acc 0.9131578947368421, AUC 0.9819241166114807
Save ckpt to ./ckpt/mask4//ag_news/ag_news_linearal_l10_m4.pt  ,ep 0
Test Epoch0 layer4 Acc 0.04684210526315789, AUC 0.24786972999572754
Test Epoch0 layer5 Acc 0.26052631578947366, AUC 0.4978545904159546
Test Epoch0 layer6 Acc 0.2419736842105263, AUC 0.4078137278556824
Test Epoch0 layer7 Acc 0.24394736842105263, AUC 0.4357128143310547
Test Epoch0 layer8 Acc 0.43526315789473685, AUC 0.7192709445953369
Test Epoch0 layer9 Acc 0.04631578947368421, AUC 0.48525816202163696
gc 0
Train Epoch1 Acc 0.03333333333333333 (4000/120000), AUC 0.48461467027664185
Test Epoch1 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch1 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch1 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch1 layer3 Acc 0.9135526315789474, AUC 0.9820870757102966
Save ckpt to ./ckpt/mask4//ag_news/ag_news_linearal_l10_m4.pt  ,ep 1
Test Epoch1 layer4 Acc 0.028289473684210528, AUC 0.25512948632240295
Test Epoch1 layer5 Acc 0.2573684210526316, AUC 0.4860948920249939
Test Epoch1 layer6 Acc 0.2388157894736842, AUC 0.3859284520149231
Test Epoch1 layer7 Acc 0.2373684210526316, AUC 0.41393980383872986
Test Epoch1 layer8 Acc 0.41907894736842105, AUC 0.6864563822746277
Test Epoch1 layer9 Acc 0.0425, AUC 0.47333961725234985
gc 0
Train Epoch2 Acc 0.029991666666666666 (3599/120000), AUC 0.45476579666137695
Test Epoch2 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch2 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch2 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch2 layer3 Acc 0.9152631578947369, AUC 0.9824958443641663
Save ckpt to ./ckpt/mask4//ag_news/ag_news_linearal_l10_m4.pt  ,ep 2
Test Epoch2 layer4 Acc 0.028552631578947368, AUC 0.2640339732170105
Test Epoch2 layer5 Acc 0.2569736842105263, AUC 0.48150327801704407
Test Epoch2 layer6 Acc 0.22105263157894736, AUC 0.37633347511291504
Test Epoch2 layer7 Acc 0.20605263157894738, AUC 0.40806061029434204
Test Epoch2 layer8 Acc 0.47710526315789475, AUC 0.6753100156784058
Test Epoch2 layer9 Acc 0.041578947368421056, AUC 0.4407040476799011
gc 0
Train Epoch3 Acc 0.02875 (3450/120000), AUC 0.43254202604293823
Test Epoch3 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch3 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch3 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch3 layer3 Acc 0.9128947368421053, AUC 0.9821791052818298
Test Epoch3 layer4 Acc 0.03315789473684211, AUC 0.2910594940185547
Test Epoch3 layer5 Acc 0.25, AUC 0.4800895154476166
Test Epoch3 layer6 Acc 0.14723684210526317, AUC 0.3806392252445221
Test Epoch3 layer7 Acc 0.14407894736842106, AUC 0.4089440107345581
Test Epoch3 layer8 Acc 0.49723684210526314, AUC 0.673932671546936
Test Epoch3 layer9 Acc 0.04105263157894737, AUC 0.42738768458366394
gc 0
Train Epoch4 Acc 0.030116666666666667 (3614/120000), AUC 0.42487412691116333
Test Epoch4 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch4 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch4 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch4 layer3 Acc 0.9134210526315789, AUC 0.9822055101394653
Test Epoch4 layer4 Acc 0.06144736842105263, AUC 0.3261949419975281
Test Epoch4 layer5 Acc 0.20289473684210527, AUC 0.49228498339653015
Test Epoch4 layer6 Acc 0.07973684210526316, AUC 0.38913142681121826
Test Epoch4 layer7 Acc 0.08013157894736841, AUC 0.40149572491645813
Test Epoch4 layer8 Acc 0.49605263157894736, AUC 0.6732990741729736
Test Epoch4 layer9 Acc 0.0443421052631579, AUC 0.42398226261138916
gc 0
Train Epoch5 Acc 0.034058333333333336 (4087/120000), AUC 0.4231312870979309
Test Epoch5 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch5 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch5 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch5 layer3 Acc 0.9132894736842105, AUC 0.9818707704544067
Test Epoch5 layer4 Acc 0.10802631578947368, AUC 0.35823899507522583
Test Epoch5 layer5 Acc 0.14973684210526317, AUC 0.5114226937294006
Test Epoch5 layer6 Acc 0.07644736842105262, AUC 0.4028228521347046
Test Epoch5 layer7 Acc 0.05605263157894737, AUC 0.3910772204399109
Test Epoch5 layer8 Acc 0.4968421052631579, AUC 0.6764460802078247
Test Epoch5 layer9 Acc 0.04881578947368421, AUC 0.4222175180912018
gc 0
Train Epoch6 Acc 0.040875 (4905/120000), AUC 0.4212293326854706
Test Epoch6 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch6 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch6 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch6 layer3 Acc 0.9130263157894737, AUC 0.9813627600669861
Test Epoch6 layer4 Acc 0.15921052631578947, AUC 0.3887232542037964
Test Epoch6 layer5 Acc 0.15894736842105264, AUC 0.5305225849151611
Test Epoch6 layer6 Acc 0.0861842105263158, AUC 0.42160099744796753
Test Epoch6 layer7 Acc 0.05039473684210526, AUC 0.3841725289821625
Test Epoch6 layer8 Acc 0.49894736842105264, AUC 0.6783485412597656
Test Epoch6 layer9 Acc 0.056578947368421055, AUC 0.42156341671943665
gc 0
Train Epoch7 Acc 0.04600833333333333 (5521/120000), AUC 0.42066338658332825
Test Epoch7 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch7 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch7 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch7 layer3 Acc 0.9135526315789474, AUC 0.9818664789199829
Test Epoch7 layer4 Acc 0.17710526315789474, AUC 0.40498703718185425
Test Epoch7 layer5 Acc 0.14802631578947367, AUC 0.539702296257019
Test Epoch7 layer6 Acc 0.09657894736842106, AUC 0.43091291189193726
Test Epoch7 layer7 Acc 0.05236842105263158, AUC 0.38312047719955444
Test Epoch7 layer8 Acc 0.49907894736842107, AUC 0.6802332401275635
Test Epoch7 layer9 Acc 0.061052631578947365, AUC 0.41935229301452637
gc 0
Train Epoch8 Acc 0.049683333333333336 (5962/120000), AUC 0.4201304018497467
Test Epoch8 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch8 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch8 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch8 layer3 Acc 0.9134210526315789, AUC 0.9815415143966675
Test Epoch8 layer4 Acc 0.18973684210526315, AUC 0.4222620725631714
Test Epoch8 layer5 Acc 0.15157894736842106, AUC 0.5456735491752625
Test Epoch8 layer6 Acc 0.09907894736842106, AUC 0.4392474293708801
Test Epoch8 layer7 Acc 0.05578947368421053, AUC 0.381296843290329
Test Epoch8 layer8 Acc 0.4993421052631579, AUC 0.6804710626602173
Test Epoch8 layer9 Acc 0.06473684210526316, AUC 0.41867488622665405
gc 0
Train Epoch9 Acc 0.053316666666666665 (6398/120000), AUC 0.4193517565727234
Test Epoch9 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch9 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch9 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch9 layer3 Acc 0.9136842105263158, AUC 0.9812626242637634
Test Epoch9 layer4 Acc 0.19960526315789473, AUC 0.43560734391212463
Test Epoch9 layer5 Acc 0.15263157894736842, AUC 0.5494303107261658
Test Epoch9 layer6 Acc 0.10578947368421053, AUC 0.44736576080322266
Test Epoch9 layer7 Acc 0.05828947368421052, AUC 0.38011685013771057
Test Epoch9 layer8 Acc 0.4996052631578947, AUC 0.6826823949813843
Test Epoch9 layer9 Acc 0.06671052631578947, AUC 0.4173617660999298
Best AUC 0.9824958443641663
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//ag_news/ag_news_linearal_l10_m4.pt
[[1706   59   91   44]
 [  16 1860   16    8]
 [  48   15 1701  136]
 [  58   13  153 1676]]
Figure(640x480)
[[1700   59   94   47]
 [  13 1865   12   10]
 [  45   17 1684  154]
 [  53   15  135 1697]]
Figure(640x480)
[[1707   58   88   47]
 [  15 1861   14   10]
 [  56   17 1673  154]
 [  52   13  136 1699]]
Figure(640x480)
[[1702   60   92   46]
 [  12 1864   14   10]
 [  45   14 1706  135]
 [  51   16  149 1684]]
Figure(640x480)
[[  57 1830   12    1]
 [1714  127   53    6]
 [   5 1549   31  315]
 [   3 1081  814    2]]
Figure(640x480)
[[1692    0  196   12]
 [  50    0 1849    1]
 [1554    0  176  170]
 [  84    0 1731   85]]
Figure(640x480)
[[1614    0  286    0]
 [  12    0 1888    0]
 [1834    0   66    0]
 [1348   50  502    0]]
Figure(640x480)
[[   0   26   18 1856]
 [   0    5  932  963]
 [   0 1250    1  649]
 [   0  317   23 1560]]
Figure(640x480)
[[ 278 1457    0  165]
 [   4 1490    0  406]
 [  21   10    0 1869]
 [  25   17    0 1858]]
Figure(640x480)
[[  64    0    9 1827]
 [1515    1  326   58]
 [ 193    3    0 1704]
 [1649    0    0  251]]
Figure(640x480)
