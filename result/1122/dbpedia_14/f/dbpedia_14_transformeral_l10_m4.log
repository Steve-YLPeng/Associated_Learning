total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask3//dbpedia_14/dbpedia_14_transformeral_l10_m3.pt
Start Training
gc 9
Train Epoch0 Acc 0.03901607142857143 (21849/560000), AUC 0.4663982391357422
Test Epoch0 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch0 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch0 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch0 layer3 Acc 0.9770142857142857, AUC 0.9980217814445496
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_transformeral_l10_m4.pt  ,ep 0
Test Epoch0 layer4 Acc 0.07148571428571429, AUC 0.6126333475112915
Test Epoch0 layer5 Acc 0.13514285714285715, AUC 0.554659903049469
Test Epoch0 layer6 Acc 0.05108571428571428, AUC 0.5362745523452759
Test Epoch0 layer7 Acc 0.07108571428571428, AUC 0.5133975148200989
Test Epoch0 layer8 Acc 0.0272, AUC 0.49492955207824707
Test Epoch0 layer9 Acc 0.027342857142857144, AUC 0.4336227476596832
gc 0
Train Epoch1 Acc 0.0199375 (11165/560000), AUC 0.4707813858985901
Test Epoch1 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch1 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch1 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch1 layer3 Acc 0.9772428571428572, AUC 0.9978402256965637
Test Epoch1 layer4 Acc 0.07324285714285714, AUC 0.6202921271324158
Test Epoch1 layer5 Acc 0.13847142857142858, AUC 0.5533617734909058
Test Epoch1 layer6 Acc 0.018971428571428573, AUC 0.49459877610206604
Test Epoch1 layer7 Acc 0.07144285714285714, AUC 0.48960205912590027
Test Epoch1 layer8 Acc 0.07144285714285714, AUC 0.4479138255119324
Test Epoch1 layer9 Acc 0.0473, AUC 0.5080730319023132
gc 0
Train Epoch2 Acc 0.06436071428571428 (36042/560000), AUC 0.5211254954338074
Test Epoch2 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch2 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch2 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch2 layer3 Acc 0.9774428571428572, AUC 0.9977596402168274
Test Epoch2 layer4 Acc 0.11757142857142858, AUC 0.6156288981437683
Test Epoch2 layer5 Acc 0.13914285714285715, AUC 0.5537557601928711
Test Epoch2 layer6 Acc 0.004028571428571428, AUC 0.49803486466407776
Test Epoch2 layer7 Acc 0.07141428571428571, AUC 0.4757891595363617
Test Epoch2 layer8 Acc 0.07141428571428571, AUC 0.42529600858688354
Test Epoch2 layer9 Acc 0.06902857142857143, AUC 0.5366232991218567
gc 0
Train Epoch3 Acc 0.06909821428571429 (38695/560000), AUC 0.5331667065620422
Test Epoch3 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch3 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch3 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch3 layer3 Acc 0.9775, AUC 0.9978445172309875
Test Epoch3 layer4 Acc 0.13604285714285713, AUC 0.6250337958335876
Test Epoch3 layer5 Acc 0.1394, AUC 0.5346651673316956
Test Epoch3 layer6 Acc 0.003142857142857143, AUC 0.4943092167377472
Test Epoch3 layer7 Acc 0.0714, AUC 0.44823306798934937
Test Epoch3 layer8 Acc 0.07134285714285714, AUC 0.41379445791244507
Test Epoch3 layer9 Acc 0.06735714285714285, AUC 0.5316342711448669
gc 0
Train Epoch4 Acc 0.0675125 (37807/560000), AUC 0.532819390296936
Test Epoch4 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch4 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch4 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch4 layer3 Acc 0.9777285714285714, AUC 0.9977472424507141
Test Epoch4 layer4 Acc 0.13924285714285714, AUC 0.6282601356506348
Test Epoch4 layer5 Acc 0.13651428571428573, AUC 0.5303773283958435
Test Epoch4 layer6 Acc 0.001642857142857143, AUC 0.49424153566360474
Test Epoch4 layer7 Acc 0.07134285714285714, AUC 0.43102413415908813
Test Epoch4 layer8 Acc 0.07142857142857142, AUC 0.39838549494743347
Test Epoch4 layer9 Acc 0.06421428571428571, AUC 0.5323668718338013
gc 0
Train Epoch5 Acc 0.06646964285714285 (37223/560000), AUC 0.5369462370872498
Test Epoch5 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch5 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch5 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch5 layer3 Acc 0.9778, AUC 0.9977976679801941
Test Epoch5 layer4 Acc 0.1395142857142857, AUC 0.6206868886947632
Test Epoch5 layer5 Acc 0.13944285714285715, AUC 0.5225473046302795
Test Epoch5 layer6 Acc 0.0015, AUC 0.4925602376461029
Test Epoch5 layer7 Acc 0.07134285714285714, AUC 0.42517051100730896
Test Epoch5 layer8 Acc 0.07141428571428571, AUC 0.3926815986633301
Test Epoch5 layer9 Acc 0.06844285714285714, AUC 0.5277253985404968
gc 0
Train Epoch6 Acc 0.06369285714285715 (35668/560000), AUC 0.5359720587730408
Test Epoch6 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch6 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch6 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch6 layer3 Acc 0.9776571428571429, AUC 0.9978216290473938
Test Epoch6 layer4 Acc 0.13845714285714286, AUC 0.6153484582901001
Test Epoch6 layer5 Acc 0.13651428571428573, AUC 0.5137674808502197
Test Epoch6 layer6 Acc 0.0008857142857142857, AUC 0.4916149079799652
Test Epoch6 layer7 Acc 0.07135714285714286, AUC 0.42699137330055237
Test Epoch6 layer8 Acc 0.07132857142857142, AUC 0.4029494822025299
Test Epoch6 layer9 Acc 0.05858571428571428, AUC 0.5328274965286255
gc 0
Train Epoch7 Acc 0.06411964285714286 (35907/560000), AUC 0.5363218188285828
Test Epoch7 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch7 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch7 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch7 layer3 Acc 0.9776571428571429, AUC 0.9976552724838257
Test Epoch7 layer4 Acc 0.13455714285714285, AUC 0.6007079482078552
Test Epoch7 layer5 Acc 0.13794285714285714, AUC 0.5208523869514465
Test Epoch7 layer6 Acc 0.0006428571428571428, AUC 0.487354040145874
Test Epoch7 layer7 Acc 0.07137142857142857, AUC 0.42794069647789
Test Epoch7 layer8 Acc 0.0711, AUC 0.4064013659954071
Test Epoch7 layer9 Acc 0.0651, AUC 0.536512017250061
gc 0
Train Epoch8 Acc 0.06624642857142857 (37098/560000), AUC 0.5405257344245911
Test Epoch8 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch8 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch8 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch8 layer3 Acc 0.9777857142857143, AUC 0.9977892637252808
Test Epoch8 layer4 Acc 0.14081428571428573, AUC 0.6014038920402527
Test Epoch8 layer5 Acc 0.1357857142857143, AUC 0.5234342813491821
Test Epoch8 layer6 Acc 0.0008142857142857143, AUC 0.4845660626888275
Test Epoch8 layer7 Acc 0.07138571428571429, AUC 0.42429623007774353
Test Epoch8 layer8 Acc 0.0706, AUC 0.41044268012046814
Test Epoch8 layer9 Acc 0.06771428571428571, AUC 0.528028666973114
gc 0
Train Epoch9 Acc 0.06761071428571429 (37862/560000), AUC 0.5431780219078064
Test Epoch9 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch9 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch9 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Test Epoch9 layer3 Acc 0.9778, AUC 0.9975929856300354
Test Epoch9 layer4 Acc 0.13875714285714286, AUC 0.6001926064491272
Test Epoch9 layer5 Acc 0.13772857142857142, AUC 0.5248306393623352
Test Epoch9 layer6 Acc 0.0006857142857142857, AUC 0.4847904145717621
Test Epoch9 layer7 Acc 0.07135714285714286, AUC 0.4183362126350403
Test Epoch9 layer8 Acc 0.07091428571428571, AUC 0.4053790867328644
Test Epoch9 layer9 Acc 0.06825714285714286, AUC 0.5364587903022766
Best AUC 0.9980217814445496
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//dbpedia_14/dbpedia_14_transformeral_l10_m4.pt
[[4690   45   22   14   12   71   40    8    4    6    7   20   19   42]
 [  29 4915    0    1    7    0   28    3    3    2    1    0    3    8]
 [  35   14 4612   19   58    2   11    5    5    0    1   79   20  139]
 [   2    2   26 4953   12    1    1    1    0    0    0    0    0    2]
 [   9   18   70   11 4857    9    6    3    2    1    0    0    3   11]
 [  31    1    3    3    1 4949    5    2    1    1    0    0    1    2]
 [  60   55    4    2   11   17 4792   36    9    5    1    1    4    3]
 [   0    1    0    0    2    0   13 4962   17    3    1    0    0    1]
 [   1    4    2    0    3    0   10   13 4966    1    0    0    0    0]
 [   1    0    1    2    0    0    0    6    0 4956   33    0    0    1]
 [  12    1    0    0    0    0    2    4    0   32 4949    0    0    0]
 [   6    0   40    2    0    0    1    0    0    1    1 4923   14   12]
 [   7    2   21    8    2    3    1    3    0    3    0   20 4883   47]
 [  33    7   81    8   14    3    3    9    2    4    5    6   46 4779]]
Figure(640x480)
[[4659   42   23   11   13   69   45    3    2    7    3   44   22   57]
 [  32 4904    3    2   11    1   25    1    2    1    1    0    9    8]
 [  31   13 4637   15   57    2   12    2    0    2    0   80   39  110]
 [   3    2   27 4955    9    1    1    0    0    0    0    0    0    2]
 [   6   12   69   17 4865    9    6    1    1    1    0    1    5    7]
 [  35    0    2    0    0 4949    6    2    1    1    0    1    3    0]
 [  61   43    3    3   16   15 4809   33    2    5    0    1    7    2]
 [   2    1    0    0    4    2   24 4949   10    4    2    0    1    1]
 [   1    3    4    0    6    0   16   16 4953    0    0    0    0    1]
 [   1    0    2    1    0    1    0    6    0 4963   24    0    0    2]
 [  12    2    0    0    0    1    0    2    0   36 4947    0    0    0]
 [   9    0   30    2    0    0    0    0    0    0    1 4931   16   11]
 [   5    1   15    2    0    1    0    0    0    2    0   18 4929   27]
 [  23    2   52    6   12    3    2    0    0    0    1   13   70 4816]]
Figure(640x480)
[[4718   45   28    7   14   57   43    3    3    5    3   24    9   41]
 [  32 4909    4    1   12    1   27    1    2    1    1    0    2    7]
 [  25   11 4725   10   63    1    9    1    0    2    0   45   19   89]
 [   2    2   28 4947   13    0    2    0    0    2    0    1    1    2]
 [   6   13   65   15 4870    7    7    1    1    2    0    2    1   10]
 [  43    0    3    0    0 4942    6    1    1    1    0    0    3    0]
 [  62   45    7    3   16   15 4803   29    5    5    0    1    7    2]
 [   3    1    0    0    4    0   25 4946   12    5    2    0    1    1]
 [   1    2    4    0    4    0   14   11 4963    0    0    0    0    1]
 [   1    0    2    1    0    1    0    3    0 4964   26    0    0    2]
 [  12    2    2    0    0    1    0    1    1   38 4942    0    0    1]
 [  12    0   44    2    0    0    0    0    0    0    0 4910   16   16]
 [  10    1   23    0    0    2    0    0    0    1    0   19 4908   36]
 [  32    3   70    3    8    1    2    0    0    0    1   10   47 4823]]
Figure(640x480)
[[4739   41   22    7   14   54   41    3    3    5    3   23    7   38]
 [  36 4902    4    1   11    1   31    1    1    1    1    0    2    8]
 [  28   10 4727   10   64    1   11    1    0    2    0   44   17   85]
 [   3    2   27 4948   13    0    0    1    0    2    0    1    1    2]
 [   6   12   65   14 4875    7    6    1    1    3    0    0    0   10]
 [  48    0    3    0    0 4936    7    1    1    1    0    0    3    0]
 [  65   37    9    3   16   14 4807   32    5    5    0    1    4    2]
 [   3    1    0    0    4    0   21 4950   12    5    2    0    1    1]
 [   1    3    4    0    5    0   14   11 4961    0    0    0    0    1]
 [   1    0    2    1    0    1    0    4    0 4965   24    0    0    2]
 [  13    2    2    0    0    0    0    3    1   41 4937    0    0    1]
 [  11    0   41    2    0    0    0    0    0    0    0 4915   15   16]
 [  12    2   28    0    1    1    0    0    0    1    0   20 4894   41]
 [  31    3   69    3    8    1    2    0    0    0    1   10   37 4835]]
Figure(640x480)
[[   0    0    0 4986    0    0   13    0    0    0    0    0    1    0]
 [   0    0    0 4998    0    0    0    0    0    0    0    0    2    0]
 [   0    0    0 4985    0    0    5    0    0    0    0    0   10    0]
 [   0    0    0 4998    0    0    0    0    0    0    0    0    2    0]
 [   0    0    0 2393    0    0    2    0    0    0    0    0 2605    0]
 [   0    0    0  268    0    0 4732    0    0    0    0    0    0    0]
 [   0    0    0 4994    0    0    6    0    0    0    0    0    0    0]
 [   0    0    0 5000    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 5000    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 5000    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 5000    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0  836    0    0 4164    0    0    0    0    0    0    0]
 [   0    0    0 4995    0    0    5    0    0    0    0    0    0    0]
 [   0    0    0 4988    0    0   12    0    0    0    0    0    0    0]]
Figure(640x480)
[[4848   16    0    0    0    0    0    0    0   29   80    0   27    0]
 [4807   82    0    0    0    0    0    0    0   15   67    0   29    0]
 [ 196 4692    0    0    0    0    0    0    0    4   57    0   51    0]
 [  23 1929    0    0    0    0    0    0    0 2829  200    0   19    0]
 [  21   80    0    0    0    0    0    0    0   17   24    0 4858    0]
 [  48    3    0    0    0    0    0    0    0   35 4148    0  766    0]
 [ 262   11    0    0    0    0    0    0    0   28 3358    0 1341    0]
 [4972    0    0    0    0    0    0    0    0   16    5    0    7    0]
 [  11    4    0    0    0    0    0    0    0 4952    0    0   33    0]
 [4982    2    0    0    0    0    0    0    0    0   16    0    0    0]
 [ 463    8    0    0    0    0    0    0    0    0 4529    0    0    0]
 [4964   18    0    0    0    0    0    0    0    1   17    0    0    0]
 [1731   23    0    0    0    0    0    0    0 3191   54    0    1    0]
 [  65  360    0    0    0    0    0    0    0   28 4523    0   24    0]]
Figure(640x480)
[[   0    1    0    1  929    0    0 3856   10    0  192   11    0    0]
 [   0    1    0    0   29    0    0  224 4465    0   41  240    0    0]
 [   0    1    0    0 4654    0    0   61    1    0  281    2    0    0]
 [   0    0    0    0  107    0    0 4860    1    0   30    2    0    0]
 [   0    0    0    0   49    0    0    5    0    0 4927   19    0    0]
 [   0    0    0    0    4    1    0   25    0    0 4969    1    0    0]
 [   0    3    0    0 2671    1    0   36   11    0 2220   58    0    0]
 [   0    0    0    1    1    2    0   42    0    0   19 4935    0    0]
 [   0    0    0    0    4    0    0    1    0    0 4213  782    0    0]
 [   0   86    0  118  122 4591    0   60    0    0   13   10    0    0]
 [   0    6    0    4   76    1    0 1429    0    0 3483    1    0    0]
 [   0    0    0    0   23    0    0   19    0    0 4958    0    0    0]
 [   0    0    0    0   73    0    0 4861    7    0   59    0    0    0]
 [   0    2    0    0   42    0    0 2437    1    0 2518    0    0    0]]
Figure(640x480)
[[4953    0    9    4    0   34    0    0    0    0    0    0    0    0]
 [4979    1    8    2    0   10    0    0    0    0    0    0    0    0]
 [ 434    0   18    6    0 4542    0    0    0    0    0    0    0    0]
 [4951    0   20    3    0   26    0    0    0    0    0    0    0    0]
 [  57    1  496    4    0 4420    0    0    0   15    0    0    7    0]
 [4997    0    1    1    0    1    0    0    0    0    0    0    0    0]
 [4490    0    5    1    0  499    0    5    0    0    0    0    0    0]
 [4961    1   27    0    0   11    0    0    0    0    0    0    0    0]
 [  29    0 4953    1    0   17    0    0    0    0    0    0    0    0]
 [4980    0    0    0    0   20    0    0    0    0    0    0    0    0]
 [ 121    0   14  145    0 4720    0    0    0    0    0    0    0    0]
 [4982    0    0    0    0   18    0    0    0    0    0    0    0    0]
 [4995    0    0    0    0    5    0    0    0    0    0    0    0    0]
 [4966    0    2    3    0   29    0    0    0    0    0    0    0    0]]
Figure(640x480)
[[   0    0    0    0 1024    0   25    0 3807    0    0    0  144    0]
 [   0    0    0    0   27    0    4    0   32    0    0    0 4937    0]
 [   0    0    0    0  102    0 4568    0   41    0    0    0  289    0]
 [   0    0    0    0 1410    0    7    0    3    0    0    0 3580    0]
 [   0    0    0    0    6    0   37    0   21    0    0    0 4936    0]
 [   0    0    0    0   80    0 4652    0   12    0    0    0  256    0]
 [   0    0    0    0   41    0    6    0 4744    0    0    0  209    0]
 [   0    0    0    0    3    0  408    0   15    0    0    0 4574    0]
 [   0    0    0    0    1    0    2    0    6    0    0    0 4991    0]
 [   0    0    0    0  113    0    3    0    7    0    0    0 4877    0]
 [   0    0    0    0    9    0    2    0 4513    0    0    0  476    0]
 [   0    0    0    0   26    0   26    0    0    0    0    0 4948    0]
 [   0    0    0    0    6    0   20    0 3088    0    0    0 1886    0]
 [   0    0    0    0   39    0   44    0    5    0    0    0 4912    0]]
Figure(640x480)
[[1826    0   94    0    0    0    0    0    0 3070   10    0    0    0]
 [4975    0   10    0    0    0    0    0    0   15    0    0    0    0]
 [4885    0   86    0    0    0    0    0    0   21    8    0    0    0]
 [  64    0    3    0    0    0    1    0    0 4932    0    0    0    0]
 [4971    0    9    0    0    0    0    0    0   20    0    0    0    0]
 [  33    0 4587    0    0    0    9    0    0  371    0    0    0    0]
 [4960    0   31    0    0    0    0    0    0    9    0    0    0    0]
 [  92    0 4879    0    0    0    0    0    0   29    0    0    0    0]
 [  47    0 1703    0    0    0    0    0    0 3250    0    0    0    0]
 [  64    0 4934    0    0    0    0    0    0    2    0    0    0    0]
 [4961    0   20    0    0    0    0    0    0   19    0    0    0    0]
 [4941    0   23    0    0    0    0    0    0   20   16    0    0    0]
 [ 233    0  162    0    0    0    1    0    0 4604    0    0    0    0]
 [  97    0 4820    0    0    0    2    0    0   80    1    0    0    0]]
Figure(640x480)
