total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l10_m1.pt
Start Training
gc 9
Train Epoch0 Acc 0.06197678571428571 (34707/560000), AUC 0.45571058988571167
Test Epoch0 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch0 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_transformeral_l10_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.031085714285714286, AUC 0.5929228067398071
Test Epoch0 layer3 Acc 0.0032285714285714287, AUC 0.3490254282951355
Test Epoch0 layer4 Acc 0.09675714285714286, AUC 0.5075528025627136
Test Epoch0 layer5 Acc 0.08474285714285715, AUC 0.5590826869010925
Test Epoch0 layer6 Acc 0.048614285714285714, AUC 0.496662437915802
Test Epoch0 layer7 Acc 0.07142857142857142, AUC 0.45536044239997864
Test Epoch0 layer8 Acc 0.04644285714285714, AUC 0.4420621693134308
Test Epoch0 layer9 Acc 0.016142857142857143, AUC 0.45269760489463806
gc 0
Train Epoch1 Acc 0.07383571428571428 (41348/560000), AUC 0.45417436957359314
Test Epoch1 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch1 layer1 Acc 0.9779285714285715, AUC 0.9980236291885376
Test Epoch1 layer2 Acc 0.005642857142857143, AUC 0.545978307723999
Test Epoch1 layer3 Acc 0.017685714285714287, AUC 0.34403225779533386
Test Epoch1 layer4 Acc 0.12251428571428571, AUC 0.4714105427265167
Test Epoch1 layer5 Acc 0.07188571428571429, AUC 0.5884393453598022
Test Epoch1 layer6 Acc 0.033685714285714284, AUC 0.45264747738838196
Test Epoch1 layer7 Acc 0.05562857142857143, AUC 0.44332295656204224
Test Epoch1 layer8 Acc 0.014328571428571428, AUC 0.4279111325740814
Test Epoch1 layer9 Acc 0.09428571428571429, AUC 0.4547456204891205
gc 0
Train Epoch2 Acc 0.07253214285714285 (40618/560000), AUC 0.4574948251247406
Test Epoch2 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch2 layer1 Acc 0.9786428571428571, AUC 0.9980171322822571
Test Epoch2 layer2 Acc 0.007471428571428572, AUC 0.5388975739479065
Test Epoch2 layer3 Acc 0.06931428571428572, AUC 0.36044374108314514
Test Epoch2 layer4 Acc 0.06568571428571429, AUC 0.44134777784347534
Test Epoch2 layer5 Acc 0.07262857142857143, AUC 0.5671449303627014
Test Epoch2 layer6 Acc 0.020528571428571427, AUC 0.4600009620189667
Test Epoch2 layer7 Acc 0.010828571428571429, AUC 0.45671868324279785
Test Epoch2 layer8 Acc 0.04474285714285714, AUC 0.4228367209434509
Test Epoch2 layer9 Acc 0.06855714285714286, AUC 0.4472024142742157
gc 0
Train Epoch3 Acc 0.06870714285714286 (38476/560000), AUC 0.45609909296035767
Test Epoch3 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch3 layer1 Acc 0.9788571428571429, AUC 0.9979696869850159
Test Epoch3 layer2 Acc 0.03735714285714286, AUC 0.5454666018486023
Test Epoch3 layer3 Acc 0.07424285714285714, AUC 0.3741777837276459
Test Epoch3 layer4 Acc 0.038457142857142856, AUC 0.43413761258125305
Test Epoch3 layer5 Acc 0.09982857142857143, AUC 0.5599371194839478
Test Epoch3 layer6 Acc 0.026842857142857144, AUC 0.4787208139896393
Test Epoch3 layer7 Acc 0.004428571428571428, AUC 0.45110034942626953
Test Epoch3 layer8 Acc 0.06097142857142857, AUC 0.4170691967010498
Test Epoch3 layer9 Acc 0.0634, AUC 0.4511684477329254
gc 0
Train Epoch4 Acc 0.06697857142857143 (37508/560000), AUC 0.45708760619163513
Test Epoch4 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch4 layer1 Acc 0.9789857142857142, AUC 0.997775137424469
Test Epoch4 layer2 Acc 0.07192857142857143, AUC 0.5459058880805969
Test Epoch4 layer3 Acc 0.07688571428571428, AUC 0.3866618573665619
Test Epoch4 layer4 Acc 0.019085714285714286, AUC 0.4524349272251129
Test Epoch4 layer5 Acc 0.09985714285714285, AUC 0.5430940389633179
Test Epoch4 layer6 Acc 0.03754285714285714, AUC 0.4932805597782135
Test Epoch4 layer7 Acc 0.003642857142857143, AUC 0.441776305437088
Test Epoch4 layer8 Acc 0.06828571428571428, AUC 0.41844844818115234
Test Epoch4 layer9 Acc 0.06091428571428571, AUC 0.4418650269508362
gc 0
Train Epoch5 Acc 0.06547142857142857 (36664/560000), AUC 0.4542554020881653
Test Epoch5 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch5 layer1 Acc 0.9786714285714285, AUC 0.9976829886436462
Test Epoch5 layer2 Acc 0.07355714285714286, AUC 0.5397063493728638
Test Epoch5 layer3 Acc 0.07524285714285714, AUC 0.401255339384079
Test Epoch5 layer4 Acc 0.01042857142857143, AUC 0.4560871124267578
Test Epoch5 layer5 Acc 0.10192857142857142, AUC 0.5310220718383789
Test Epoch5 layer6 Acc 0.035885714285714285, AUC 0.4903920292854309
Test Epoch5 layer7 Acc 0.003914285714285714, AUC 0.4287244975566864
Test Epoch5 layer8 Acc 0.0679, AUC 0.4178965091705322
Test Epoch5 layer9 Acc 0.06392857142857143, AUC 0.45095738768577576
gc 0
Train Epoch6 Acc 0.06718392857142857 (37623/560000), AUC 0.4577755630016327
Test Epoch6 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch6 layer1 Acc 0.9786857142857143, AUC 0.9976320266723633
Test Epoch6 layer2 Acc 0.07222857142857143, AUC 0.5366335511207581
Test Epoch6 layer3 Acc 0.07528571428571429, AUC 0.4124376177787781
Test Epoch6 layer4 Acc 0.0064428571428571425, AUC 0.4616473615169525
Test Epoch6 layer5 Acc 0.10601428571428571, AUC 0.5281506180763245
Test Epoch6 layer6 Acc 0.027671428571428573, AUC 0.4853856861591339
Test Epoch6 layer7 Acc 0.003914285714285714, AUC 0.43108507990837097
Test Epoch6 layer8 Acc 0.06967142857142856, AUC 0.4176759719848633
Test Epoch6 layer9 Acc 0.06324285714285714, AUC 0.44696930050849915
gc 0
Train Epoch7 Acc 0.06786964285714285 (38007/560000), AUC 0.46217039227485657
Test Epoch7 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch7 layer1 Acc 0.9789571428571429, AUC 0.997682511806488
Test Epoch7 layer2 Acc 0.07094285714285714, AUC 0.5289265513420105
Test Epoch7 layer3 Acc 0.07492857142857143, AUC 0.4206545948982239
Test Epoch7 layer4 Acc 0.004871428571428572, AUC 0.4662667214870453
Test Epoch7 layer5 Acc 0.1184, AUC 0.5183560848236084
Test Epoch7 layer6 Acc 0.041985714285714286, AUC 0.48635366559028625
Test Epoch7 layer7 Acc 0.004071428571428571, AUC 0.4284225404262543
Test Epoch7 layer8 Acc 0.07025714285714285, AUC 0.42254334688186646
Test Epoch7 layer9 Acc 0.06571428571428571, AUC 0.46390172839164734
gc 0
Train Epoch8 Acc 0.06875357142857143 (38502/560000), AUC 0.4692755341529846
Test Epoch8 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch8 layer1 Acc 0.9790857142857143, AUC 0.9976454973220825
Test Epoch8 layer2 Acc 0.06927142857142857, AUC 0.5297815203666687
Test Epoch8 layer3 Acc 0.0739, AUC 0.42667609453201294
Test Epoch8 layer4 Acc 0.003971428571428571, AUC 0.4716566503047943
Test Epoch8 layer5 Acc 0.12444285714285715, AUC 0.5078451633453369
Test Epoch8 layer6 Acc 0.03312857142857143, AUC 0.48836687207221985
Test Epoch8 layer7 Acc 0.004057142857142857, AUC 0.4249979555606842
Test Epoch8 layer8 Acc 0.07062857142857143, AUC 0.42549294233322144
Test Epoch8 layer9 Acc 0.06812857142857143, AUC 0.47336700558662415
gc 0
Train Epoch9 Acc 0.06918928571428572 (38746/560000), AUC 0.47487375140190125
Test Epoch9 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch9 layer1 Acc 0.9792142857142857, AUC 0.9975175857543945
Test Epoch9 layer2 Acc 0.06607142857142857, AUC 0.52649986743927
Test Epoch9 layer3 Acc 0.07404285714285715, AUC 0.4274224638938904
Test Epoch9 layer4 Acc 0.004242857142857143, AUC 0.4752318859100342
Test Epoch9 layer5 Acc 0.1297, AUC 0.5034422278404236
Test Epoch9 layer6 Acc 0.03692857142857143, AUC 0.48849645256996155
Test Epoch9 layer7 Acc 0.0044, AUC 0.4285905063152313
Test Epoch9 layer8 Acc 0.07037142857142857, AUC 0.42721790075302124
Test Epoch9 layer9 Acc 0.06728571428571428, AUC 0.4785308539867401
Best AUC 0.9983381628990173
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//dbpedia_14/dbpedia_14_transformeral_l10_m2.pt
[[4690   45   22   14   12   71   40    8    4    6    7   20   19   42]
 [  29 4915    0    1    7    0   28    3    3    2    1    0    3    8]
 [  35   14 4612   19   58    2   11    5    5    0    1   79   20  139]
 [   2    2   26 4953   12    1    1    1    0    0    0    0    0    2]
 [   9   18   70   11 4857    9    6    3    2    1    0    0    3   11]
 [  31    1    3    3    1 4949    5    2    1    1    0    0    1    2]
 [  60   55    4    2   11   17 4792   36    9    5    1    1    4    3]
 [   0    1    0    0    2    0   13 4962   17    3    1    0    0    1]
 [   1    4    2    0    3    0   10   13 4966    1    0    0    0    0]
 [   1    0    1    2    0    0    0    6    0 4956   33    0    0    1]
 [  12    1    0    0    0    0    2    4    0   32 4949    0    0    0]
 [   6    0   40    2    0    0    1    0    0    1    1 4923   14   12]
 [   7    2   21    8    2    3    1    3    0    3    0   20 4883   47]
 [  33    7   81    8   14    3    3    9    2    4    5    6   46 4779]]
Figure(640x480)
[[4659   42   23   11   13   69   45    3    2    7    3   44   22   57]
 [  32 4904    3    2   11    1   25    1    2    1    1    0    9    8]
 [  31   13 4637   15   57    2   12    2    0    2    0   80   39  110]
 [   3    2   27 4955    9    1    1    0    0    0    0    0    0    2]
 [   6   12   69   17 4865    9    6    1    1    1    0    1    5    7]
 [  35    0    2    0    0 4949    6    2    1    1    0    1    3    0]
 [  61   43    3    3   16   15 4809   33    2    5    0    1    7    2]
 [   2    1    0    0    4    2   24 4949   10    4    2    0    1    1]
 [   1    3    4    0    6    0   16   16 4953    0    0    0    0    1]
 [   1    0    2    1    0    1    0    6    0 4963   24    0    0    2]
 [  12    2    0    0    0    1    0    2    0   36 4947    0    0    0]
 [   9    0   30    2    0    0    0    0    0    0    1 4931   16   11]
 [   5    1   15    2    0    1    0    0    0    2    0   18 4929   27]
 [  23    2   52    6   12    3    2    0    0    0    1   13   70 4816]]
Figure(640x480)
[[   6   20  896    0    0  246    0 3832    0    0    0    0    0    0]
 [   2    1 4288    0    0    5    0  704    0    0    0    0    0    0]
 [   6  183 2145    0    0  380    0 2286    0    0    0    0    0    0]
 [   5   11   11    0    0    8    0 4965    0    0    0    0    0    0]
 [3928    4  977    0    0   38    0   53    0    0    0    0    0    0]
 [   0    0  722    0    0    0    0 4278    0    0    0    0    0    0]
 [   1    1 4925    0    0   55    0   18    0    0    0    0    0    0]
 [   0    1 4976    0    0    0    0   23    0    0    0    0    0    0]
 [   5    1   80    0    0    0    0 4914    0    0    0    0    0    0]
 [   0 1312   51    0    0    1    0 3635    0    1    0    0    0    0]
 [   0    0    9    0    0    0    0 4991    0    0    0    0    0    0]
 [   1 4872  109    0    0    8    0   10    0    0    0    0    0    0]
 [   0   16 3002    0    0    2    0 1980    0    0    0    0    0    0]
 [  34    6  219    0    0   86    0 4655    0    0    0    0    0    0]]
Figure(640x480)
[[   0    0    1    0    0  234  156    0   29    0  376 4204    0    0]
 [   0    0  883    0    0   15    8    0    0    0 4063   31    0    0]
 [   1    0    0  195    0    3 4268    0   36    0  482   15    0    0]
 [   2    0    0    0    0    2   23    0  896    0 4077    0    0    0]
 [   2    0    0    1    0    5   42    0    2    0 4947    1    0    0]
 [   0    0    0    0    0    2 2453    0   17    0 2516   12    0    0]
 [   0    0    0    0    0 4594   62    0   23    0  308   13    0    0]
 [   0    0    0    0    0    7 4532    0    5    0  456    0    0    0]
 [   0    0    0    2    0   13    5    0    0    0 4980    0    0    0]
 [   3    0    0    0    0    0    4    0    7    0 4973   13    0    0]
 [  44    0    1    0    0    1  544    0    1    0  160 4249    0    0]
 [   0    0    0    0    0    0   10    0 4781    0  207    2    0    0]
 [   0    0    0    2    0    0 2843    0   14    0 2133    8    0    0]
 [   0    0    0  149    0    4   16    0  604    0 1150 3077    0    0]]
Figure(640x480)
[[  12    0 2756  505   29    0    0    1    0    0    1    0 1696    0]
 [ 402    0 3242  712    0    0    0    0    0    0   12    0  632    0]
 [  58    0   17 4276   23    0    0    0    1    0    1    0  624    0]
 [  10    0    9 4977    0    0    2    0    0    0    1    0    1    0]
 [3802    0   63  148    0    0    0    8    0    0    0  967   12    0]
 [   0    0 2043   33    6    0    0    0    0    0 2912    0    4    2]
 [  44    0  165   60    0    0    0   14    0    0    1    0 4716    0]
 [   4    0   24 4962    0    0    0    0    1    0    0    0    9    0]
 [  26   22 3141   22    0    0    0   13 1752    0    0    0   24    0]
 [   1    0    1 4998    0    0    0    0    0    0    0    0    0    0]
 [   0    0    9 4989    0    0    0    0    0    0    0    0    2    0]
 [ 131    0  116   92 4655    0    2    1    0    0    0    0    3    0]
 [   3    0   23 4942   14    0    1    0    0    0    2    0   15    0]
 [   9    0  269  325    1    0    3    0    2    0  604    0 3787    0]]
Figure(640x480)
[[   0    1    4    0    0    0    0    2    0    0  445    0 4548    0]
 [   0    0    0    0    0    0    0    0    0    0   14    2 4984    0]
 [   0 2231  945    0    0    0    0  741    0    0  499    0  584    0]
 [   0    1    1    0    0    0    0   10    0    0 4934    0   54    0]
 [   0   22    1    0    0    0    0    4    0    0   15    0 4958    0]
 [   0    1    0    0    0    0    0    1    0    0  322    0 4676    0]
 [   0    4    3    0    0    0    0    0    0    0    9    0 4984    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    1    0 4999    0]
 [   0    0    0    0    0    0    0    0    0    0    8    0 4992    0]
 [   0    0    0    0    0    0    0    0    0    0    3    0 4997    0]
 [   0   48    6    0    0    0    0    0    0    0    3    0 4943    0]
 [   0    7    3    0    0    0    0    1    0    0    5    0 4984    0]
 [   0   43  146    0    0    0    0    1    0    0   49    0 4761    0]]
Figure(640x480)
[[   2    0    0   42    0 1127   35    5    2    0 3603   11    3  170]
 [   0    0    0    2    0   16    6    1    0    0 4973    1    0    1]
 [  74    0    0   18    0   16 4767    0    8    0   92    1    0   24]
 [  19    0    0 1357    0    2  112    0    0    0   27 3482    0    1]
 [   0    0    0   15    0    6  457    0    1    0 4515    4    0    2]
 [   1    0    0    0    0    5    3    0    0    0 2528    0    0 2463]
 [   0    0    0    5    0   27   43  256    1    0 3627 1038    0    3]
 [   0    0    0    0    0   53    2    0    0    0 4837    0    0  108]
 [   0    0    0    0    0 4967    4    2    0    0   27    0    0    0]
 [  11    0    0  190    0  195   54    0  298 1654  995    0 1600    3]
 [   1    0    0   21    0   14 4612    0    2    1  337    1    1   10]
 [ 691    0    0    1    0    1   37   10 3662    0   12    2    0  584]
 [  24    0    0    3    0  707   22    0    2    0 4184    0    1   57]
 [  30    0    0    2    0    9  243    0    0    0 4713    1    0    2]]
Figure(640x480)
[[5000    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [5000    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [5000    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [4807    0  192    0    0    0    0    0    0    0    0    1    0    0]
 [5000    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [4996    0    4    0    0    0    0    0    0    0    0    0    0    0]
 [5000    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [5000    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [5000    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [5000    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [5000    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [4999    0    1    0    0    0    0    0    0    0    0    0    0    0]
 [5000    0    0    0    0    0    0    0    0    0    0    0    0    0]
 [4999    0    0    0    0    0    0    0    0    0    0    1    0    0]]
Figure(640x480)
[[   0    0    0    0   31   29 4928    0    6    0    0    0    0    6]
 [   0    0    0    0    2 4573  167    0  256    0    0    0    2    0]
 [   0    0    0    0    4    5 4987    0    3    0    0    0    1    0]
 [   0    0    0    0   29    9 4404    0  556    0    0    0    0    2]
 [   0    0    0    0    6    1 4992    0    1    0    0    0    0    0]
 [   0    0    0    0  134    4 1720    0    2    0    0    0    0 3140]
 [   0    0    0    0    0    9 3241    0 1748    0    0    0    2    0]
 [   0    0    0    0    0    0 5000    0    0    0    0    0    0    0]
 [   0    0    0    0    0    0 5000    0    0    0    0    0    0    0]
 [   0    0    0    0 2071    0 2810    0    1    0  112    0    0    6]
 [   0    0    0    0    3    0 4882    0  114    0    0    0    1    0]
 [   0    0    0    0    8    0 2055    0    3    0    0    0 2934    0]
 [   0    0    0    0    2    0 4982    0   16    0    0    0    0    0]
 [   0    0    0    0 3086    1 1858    0   55    0    0    0    0    0]]
Figure(640x480)
[[ 595    2    0    0    0    0    0    0  335    0    0    0 4068    0]
 [4319    0    1    0    0    0    0    0  460    0    0    0  220    0]
 [  40    3    0    0    0    0    0    0 4921    0    1    1   34    0]
 [3521    0    1    0    0    0    0    0 1477    0    0    1    0    0]
 [ 746   24    2    0    0    0    0    1 4216    0    0   10    1    0]
 [  38    3    0    0    0    0    0    0  144    0    0    0 4815    0]
 [4382    0    0    0    0    0    0    0  598    0    0    1   19    0]
 [  11    0    0    1    0    0    0    0 4987    0    0    0    1    0]
 [4451    2    0   36    0    0    0    0  510    0    0    0    1    0]
 [4976    0    0    0    0    0    0    0   24    0    0    0    0    0]
 [ 144    0    0    0    0    0    0    0 4848    0    0    0    8    0]
 [  15    0    0    0    0    0    0    0  571    0    0    0 4413    1]
 [2086    7 1602    0    0    0    0    0 1296    0    0    1    8    0]
 [3174   18   98    0    0    0    0    0 1665    0    0    1   27   17]]
Figure(640x480)
