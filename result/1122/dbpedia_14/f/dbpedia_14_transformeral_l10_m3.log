total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask2//dbpedia_14/dbpedia_14_transformeral_l10_m2.pt
Start Training
gc 9
Train Epoch0 Acc 0.09604464285714286 (53785/560000), AUC 0.4522002339363098
Test Epoch0 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch0 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch0 layer2 Acc 0.9767142857142858, AUC 0.9982427954673767
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_transformeral_l10_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.0024714285714285715, AUC 0.49430009722709656
Test Epoch0 layer4 Acc 0.08207142857142857, AUC 0.579443633556366
Test Epoch0 layer5 Acc 0.11131428571428571, AUC 0.5504993796348572
Test Epoch0 layer6 Acc 0.08498571428571429, AUC 0.518545925617218
Test Epoch0 layer7 Acc 0.12572857142857144, AUC 0.6123992204666138
Test Epoch0 layer8 Acc 0.07121428571428572, AUC 0.4627831280231476
Test Epoch0 layer9 Acc 0.07264285714285715, AUC 0.4425274431705475
gc 0
Train Epoch1 Acc 0.0764625 (42819/560000), AUC 0.4541073441505432
Test Epoch1 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch1 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch1 layer2 Acc 0.9774857142857143, AUC 0.9980038404464722
Test Epoch1 layer3 Acc 0.16772857142857142, AUC 0.5713838934898376
Test Epoch1 layer4 Acc 0.06895714285714286, AUC 0.5207909345626831
Test Epoch1 layer5 Acc 0.0092, AUC 0.5699411630630493
Test Epoch1 layer6 Acc 0.12727142857142856, AUC 0.5549860000610352
Test Epoch1 layer7 Acc 0.11625714285714285, AUC 0.570345938205719
Test Epoch1 layer8 Acc 0.13904285714285713, AUC 0.5358787775039673
Test Epoch1 layer9 Acc 0.0761, AUC 0.4496913254261017
gc 0
Train Epoch2 Acc 0.09282857142857143 (51984/560000), AUC 0.4702471196651459
Test Epoch2 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch2 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch2 layer2 Acc 0.9778142857142857, AUC 0.9979873895645142
Test Epoch2 layer3 Acc 0.14348571428571427, AUC 0.5633738040924072
Test Epoch2 layer4 Acc 0.13781428571428572, AUC 0.4832891821861267
Test Epoch2 layer5 Acc 0.10201428571428571, AUC 0.5860930681228638
Test Epoch2 layer6 Acc 0.1411, AUC 0.5306963920593262
Test Epoch2 layer7 Acc 0.03728571428571428, AUC 0.5429038405418396
Test Epoch2 layer8 Acc 0.08404285714285714, AUC 0.5279328227043152
Test Epoch2 layer9 Acc 0.041242857142857144, AUC 0.45808592438697815
gc 0
Train Epoch3 Acc 0.07053035714285714 (39497/560000), AUC 0.4575193524360657
Test Epoch3 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch3 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch3 layer2 Acc 0.9780142857142857, AUC 0.9978348016738892
Test Epoch3 layer3 Acc 0.13537142857142856, AUC 0.5551398992538452
Test Epoch3 layer4 Acc 0.13882857142857144, AUC 0.4722067415714264
Test Epoch3 layer5 Acc 0.13945714285714286, AUC 0.5710690021514893
Test Epoch3 layer6 Acc 0.1412142857142857, AUC 0.5241619944572449
Test Epoch3 layer7 Acc 0.011128571428571429, AUC 0.5272302627563477
Test Epoch3 layer8 Acc 0.07557142857142857, AUC 0.5319270491600037
Test Epoch3 layer9 Acc 0.06981428571428572, AUC 0.4526981711387634
gc 0
Train Epoch4 Acc 0.06915357142857143 (38726/560000), AUC 0.4582855999469757
Test Epoch4 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch4 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch4 layer2 Acc 0.9779428571428571, AUC 0.9976553916931152
Test Epoch4 layer3 Acc 0.07727142857142857, AUC 0.5662909150123596
Test Epoch4 layer4 Acc 0.1391, AUC 0.46171602606773376
Test Epoch4 layer5 Acc 0.12548571428571428, AUC 0.5551404356956482
Test Epoch4 layer6 Acc 0.1399857142857143, AUC 0.5230854153633118
Test Epoch4 layer7 Acc 0.0091, AUC 0.516166090965271
Test Epoch4 layer8 Acc 0.07377142857142857, AUC 0.5149138569831848
Test Epoch4 layer9 Acc 0.06991428571428572, AUC 0.45900359749794006
gc 0
Train Epoch5 Acc 0.06821428571428571 (38200/560000), AUC 0.464332640171051
Test Epoch5 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch5 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch5 layer2 Acc 0.9782714285714286, AUC 0.9975947737693787
Test Epoch5 layer3 Acc 0.0905, AUC 0.5783651471138
Test Epoch5 layer4 Acc 0.13808571428571428, AUC 0.4596109092235565
Test Epoch5 layer5 Acc 0.10997142857142857, AUC 0.5495412945747375
Test Epoch5 layer6 Acc 0.1402857142857143, AUC 0.5330321788787842
Test Epoch5 layer7 Acc 0.008114285714285715, AUC 0.5160924196243286
Test Epoch5 layer8 Acc 0.07417142857142857, AUC 0.5171944499015808
Test Epoch5 layer9 Acc 0.06752857142857142, AUC 0.46858906745910645
gc 0
Train Epoch6 Acc 0.06780357142857144 (37970/560000), AUC 0.47462376952171326
Test Epoch6 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch6 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch6 layer2 Acc 0.9783571428571428, AUC 0.9976755976676941
Test Epoch6 layer3 Acc 0.08191428571428572, AUC 0.5796894431114197
Test Epoch6 layer4 Acc 0.13772857142857142, AUC 0.4579087793827057
Test Epoch6 layer5 Acc 0.11641428571428572, AUC 0.5546479821205139
Test Epoch6 layer6 Acc 0.13967142857142859, AUC 0.5391859412193298
Test Epoch6 layer7 Acc 0.008542857142857144, AUC 0.5226844549179077
Test Epoch6 layer8 Acc 0.07312857142857143, AUC 0.516772449016571
Test Epoch6 layer9 Acc 0.06874285714285715, AUC 0.4810902774333954
gc 0
Train Epoch7 Acc 0.0677875 (37961/560000), AUC 0.4851219952106476
Test Epoch7 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch7 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch7 layer2 Acc 0.9782, AUC 0.9975629448890686
Test Epoch7 layer3 Acc 0.08942857142857143, AUC 0.5899069905281067
Test Epoch7 layer4 Acc 0.1352142857142857, AUC 0.4550932049751282
Test Epoch7 layer5 Acc 0.09362857142857142, AUC 0.5379718542098999
Test Epoch7 layer6 Acc 0.13428571428571429, AUC 0.5333975553512573
Test Epoch7 layer7 Acc 0.006757142857142857, AUC 0.5233631730079651
Test Epoch7 layer8 Acc 0.07337142857142857, AUC 0.5116642117500305
Test Epoch7 layer9 Acc 0.05998571428571429, AUC 0.48582562804222107
gc 0
Train Epoch8 Acc 0.06643214285714286 (37202/560000), AUC 0.49113839864730835
Test Epoch8 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch8 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch8 layer2 Acc 0.978, AUC 0.9976469278335571
Test Epoch8 layer3 Acc 0.08458571428571429, AUC 0.5925107002258301
Test Epoch8 layer4 Acc 0.13385714285714287, AUC 0.45876726508140564
Test Epoch8 layer5 Acc 0.13305714285714285, AUC 0.5349841117858887
Test Epoch8 layer6 Acc 0.1395, AUC 0.5385168194770813
Test Epoch8 layer7 Acc 0.007485714285714286, AUC 0.5257132053375244
Test Epoch8 layer8 Acc 0.07358571428571428, AUC 0.50127112865448
Test Epoch8 layer9 Acc 0.059742857142857146, AUC 0.49345874786376953
gc 0
Train Epoch9 Acc 0.06434107142857143 (36031/560000), AUC 0.49601295590400696
Test Epoch9 layer0 Acc 0.9740857142857143, AUC 0.9983155131340027
Test Epoch9 layer1 Acc 0.9752285714285714, AUC 0.9983381628990173
Test Epoch9 layer2 Acc 0.9783428571428572, AUC 0.9973855018615723
Test Epoch9 layer3 Acc 0.08487142857142857, AUC 0.6041017174720764
Test Epoch9 layer4 Acc 0.13624285714285714, AUC 0.464467853307724
Test Epoch9 layer5 Acc 0.12677142857142856, AUC 0.5423777103424072
Test Epoch9 layer6 Acc 0.14054285714285714, AUC 0.5402386784553528
Test Epoch9 layer7 Acc 0.006057142857142857, AUC 0.5281163454055786
Test Epoch9 layer8 Acc 0.07542857142857143, AUC 0.49536916613578796
Test Epoch9 layer9 Acc 0.0596, AUC 0.49184316396713257
Best AUC 0.9982427954673767
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//dbpedia_14/dbpedia_14_transformeral_l10_m3.pt
[[4690   45   22   14   12   71   40    8    4    6    7   20   19   42]
 [  29 4915    0    1    7    0   28    3    3    2    1    0    3    8]
 [  35   14 4612   19   58    2   11    5    5    0    1   79   20  139]
 [   2    2   26 4953   12    1    1    1    0    0    0    0    0    2]
 [   9   18   70   11 4857    9    6    3    2    1    0    0    3   11]
 [  31    1    3    3    1 4949    5    2    1    1    0    0    1    2]
 [  60   55    4    2   11   17 4792   36    9    5    1    1    4    3]
 [   0    1    0    0    2    0   13 4962   17    3    1    0    0    1]
 [   1    4    2    0    3    0   10   13 4966    1    0    0    0    0]
 [   1    0    1    2    0    0    0    6    0 4956   33    0    0    1]
 [  12    1    0    0    0    0    2    4    0   32 4949    0    0    0]
 [   6    0   40    2    0    0    1    0    0    1    1 4923   14   12]
 [   7    2   21    8    2    3    1    3    0    3    0   20 4883   47]
 [  33    7   81    8   14    3    3    9    2    4    5    6   46 4779]]
Figure(640x480)
[[4659   42   23   11   13   69   45    3    2    7    3   44   22   57]
 [  32 4904    3    2   11    1   25    1    2    1    1    0    9    8]
 [  31   13 4637   15   57    2   12    2    0    2    0   80   39  110]
 [   3    2   27 4955    9    1    1    0    0    0    0    0    0    2]
 [   6   12   69   17 4865    9    6    1    1    1    0    1    5    7]
 [  35    0    2    0    0 4949    6    2    1    1    0    1    3    0]
 [  61   43    3    3   16   15 4809   33    2    5    0    1    7    2]
 [   2    1    0    0    4    2   24 4949   10    4    2    0    1    1]
 [   1    3    4    0    6    0   16   16 4953    0    0    0    0    1]
 [   1    0    2    1    0    1    0    6    0 4963   24    0    0    2]
 [  12    2    0    0    0    1    0    2    0   36 4947    0    0    0]
 [   9    0   30    2    0    0    0    0    0    0    1 4931   16   11]
 [   5    1   15    2    0    1    0    0    0    2    0   18 4929   27]
 [  23    2   52    6   12    3    2    0    0    0    1   13   70 4816]]
Figure(640x480)
[[4718   45   28    7   14   57   43    3    3    5    3   24    9   41]
 [  32 4909    4    1   12    1   27    1    2    1    1    0    2    7]
 [  25   11 4725   10   63    1    9    1    0    2    0   45   19   89]
 [   2    2   28 4947   13    0    2    0    0    2    0    1    1    2]
 [   6   13   65   15 4870    7    7    1    1    2    0    2    1   10]
 [  43    0    3    0    0 4942    6    1    1    1    0    0    3    0]
 [  62   45    7    3   16   15 4803   29    5    5    0    1    7    2]
 [   3    1    0    0    4    0   25 4946   12    5    2    0    1    1]
 [   1    2    4    0    4    0   14   11 4963    0    0    0    0    1]
 [   1    0    2    1    0    1    0    3    0 4964   26    0    0    2]
 [  12    2    2    0    0    1    0    1    1   38 4942    0    0    1]
 [  12    0   44    2    0    0    0    0    0    0    0 4910   16   16]
 [  10    1   23    0    0    2    0    0    0    1    0   19 4908   36]
 [  32    3   70    3    8    1    2    0    0    0    1   10   47 4823]]
Figure(640x480)
[[   0    0    0   45    0    0   45    0   23 4887    0    0    0    0]
 [   0    0    0    3    0    0    8    0    0 4989    0    0    0    0]
 [   0    0    0    5    0    0 4656    0   61  278    0    0    0    0]
 [   0    0    0    7    0    0   27    0    1 4965    0    0    0    0]
 [   1    0    0    2    0    0   60    0    0 4937    0    0    0    0]
 [   0    0    0    3    0    0    2    0    0 4995    0    0    0    0]
 [   0    0    0    7    0    0  104    0    1 4888    0    0    0    0]
 [   0    0    0    8    0    0   14    0    0 4978    0    0    0    0]
 [   0    0    0  208    0    0    4    0   56 4732    0    0    0    0]
 [   0    0    0 4984    0    0   10    0    0    6    0    0    0    0]
 [   0    0    0  151    0    0 4750    0    0   99    0    0    0    0]
 [   0    0    0    2    0    0   34    0 4915   49    0    0    0    0]
 [   0    0    0    4    0    0   53    0   17 4926    0    0    0    0]
 [   0    0    0    1    0    0   39    0   10 4950    0    0    0    0]]
Figure(640x480)
[[   0    4    0 4960    0    0   25   11    0    0    0    0    0    0]
 [   0    0    0 4995    0    0    5    0    0    0    0    0    0    0]
 [   0    4    0 4971    0    0    5   20    0    0    0    0    0    0]
 [   0    0    0 1435    0    0 3565    0    0    0    0    0    0    0]
 [   0    0    0 4898    0    0    6   96    0    0    0    0    0    0]
 [   0    0    0 4824    0    0  176    0    0    0    0    0    0    0]
 [   0    0    0  688    0    0 4310    2    0    0    0    0    0    0]
 [   0    0    0 4999    0    0    1    0    0    0    0    0    0    0]
 [   0    0    0 4992    0    0    7    1    0    0    0    0    0    0]
 [   0    0    0 5000    0    0    0    0    0    0    0    0    0    0]
 [   0    0    0 5000    0    0    0    0    0    0    0    0    0    0]
 [   0    2    0  267    0    0  154 4577    0    0    0    0    0    0]
 [   0   12    0 4977    0    0    1   10    0    0    0    0    0    0]
 [   0 2164    0 2833    0    0    2    1    0    0    0    0    0    0]]
Figure(640x480)
[[4750   80  158    0    0    0    0    0    0    0    0    0   12    0]
 [  53 2984 1926    0    0    0    0    0    0    0    7    0   30    0]
 [  63 4848   56    0    0    0    0    0    0    0    0    0   33    0]
 [   3  487 4484    0    0    0    0    0    0    0   14    0   12    0]
 [  74   99   29    0    0    0    0    0    0    0    3    0 4795    0]
 [  63    4 4933    0    0    0    0    0    0    0    0    0    0    0]
 [4830   26  136    0    0    0    0    0    0    0    1    0    7    0]
 [  35   20 4939    0    0    0    0    0    0    0    0    0    6    0]
 [  17    4 4950    0    0    0    0    0    0    0    0    0   29    0]
 [   6 4976   18    0    0    0    0    0    0    0    0    0    0    0]
 [4485   90  420    0    0    0    0    0    0    0    0    0    5    0]
 [   9  170 4406    0    0    0    0    0    0    0    0    0  415    0]
 [  65   87 4846    0    0    0    0    0    0    0    0    0    2    0]
 [  24  512 4455    0    0    0    0    0    0    0    0    0    9    0]]
Figure(640x480)
[[   0    0    0    0    0   66    1 4893   38    0    2    0    0    0]
 [   0    0    0    0    0 4772   17  204    6    0    1    0    0    0]
 [   0    0    0    0    0    7    6 4858  126    0    3    0    0    0]
 [   0    0    0    0    0    2    1 4990    7    0    0    0    0    0]
 [   0    0    0    0    0   17   66  312 4506    0   99    0    0    0]
 [   0    0    0    0    0 4902    0   96    2    0    0    0    0    0]
 [   0    0    0    0    0   85    1 4910    3    0    1    0    0    0]
 [   0    0    0    0    0 4962    1   36    1    0    0    0    0    0]
 [   0    0    0    0    0 3969    1   20 1010    0    0    0    0    0]
 [   0    0    0    0    0 4956    5   37    1    0    1    0    0    0]
 [   0    0    0    0    0   58   27 4901   14    0    0    0    0    0]
 [   0    0    0    0    0    0    5  635   13    0 4347    0    0    0]
 [   0    0    0    0    0    3    2 4973   15    0    7    0    0    0]
 [   0    0    0    0    0   14   11  318 4653    0    4    0    0    0]]
Figure(640x480)
[[4914    0   81    0    0    5    0    0    0    0    0    0    0    0]
 [4968    0   31    0    0    1    0    0    0    0    0    0    0    0]
 [1105    0 3887    0    0    8    0    0    0    0    0    0    0    0]
 [  62    0 4935    0    0    3    0    0    0    0    0    0    0    0]
 [  26    0  695    0    0 4279    0    0    0    0    0    0    0    0]
 [ 223    0 4777    0    0    0    0    0    0    0    0    0    0    0]
 [ 353    0 4644    0    0    3    0    0    0    0    0    0    0    0]
 [4962    0   38    0    0    0    0    0    0    0    0    0    0    0]
 [  27    0 4972    0    0    1    0    0    0    0    0    0    0    0]
 [4989    0   11    0    0    0    0    0    0    0    0    0    0    0]
 [ 283    0 4717    0    0    0    0    0    0    0    0    0    0    0]
 [ 282    0 4718    0    0    0    0    0    0    0    0    0    0    0]
 [4973    0   27    0    0    0    0    0    0    0    0    0    0    0]
 [4919    0   81    0    0    0    0    0    0    0    0    0    0    0]]
Figure(640x480)
[[   0    0    0    0   89    0 1826    0    0    0 3072    0   13    0]
 [   0    0    0    0    1    8  355   18   39    0    4    0 4575    0]
 [   0    0    0    0   49    9 4938    0    3    0    1    0    0    0]
 [   0    0    0    0 4883    3  111    0    3    0    0    0    0    0]
 [   0    0    0    0    6    0 4939    0   54    0    0    0    1    0]
 [   0    0    0    0 3895    0 1103    0    0    0    2    0    0    0]
 [   0    0    0    0    4    0 4971    4    1    0    3    0   17    0]
 [   0    0    0    0    1    0 4998    0    0    0    1    0    0    0]
 [   0    0    0    0    0    0 5000    0    0    0    0    0    0    0]
 [   0    0    0    0 4803    0  190    0    6    0    1    0    0    0]
 [   0    0    0    0   34    0 1397    0 3561    0    8    0    0    0]
 [   0    0    0    0 4909    0   90    0    0    0    1    0    0    0]
 [   0    0    0    0   21    1 4746    0    0    0  232    0    0    0]
 [   0    0    0    0   28    0 4965    0    1    0    5    0    1    0]]
Figure(640x480)
[[4861    0   75    0    0    0    0    0   40    0    7    0    0   17]
 [3112    0   11    0    0    0    0    0 1874    0    0    0    0    3]
 [ 204    0  101    0    0    0    0    0 2542    0 2143    0    0   10]
 [ 100    0    8    0    0    0    0    0   22    0    9    0    0 4861]
 [4873    0    8    0    0    0    0    0   87    0    7    0    0   25]
 [4996    0    1    0    0    0    0    0    1    0    0    0    0    2]
 [1606    0   13    0    0    0    0    0 3381    0    0    0    0    0]
 [ 317    0 4667    0    0    0    0    0    8    0    0    0    0    8]
 [  84    0    4    0    0    0    0    0    1    0    1    0    0 4910]
 [ 463    0 4478    0    0    0    0    0   51    2    0    0    0    6]
 [3530    0    6    0    0    0    0    0  426 1037    0    0    0    1]
 [  14    0  242    0    0    0    0    0  144    0   28    0    0 4572]
 [  55    0   35    0    0    0    0    0 4876    0    0    0    0   34]
 [  38    0 4586    0    0    0    0    0  254    0    2    0    0  120]]
Figure(640x480)
