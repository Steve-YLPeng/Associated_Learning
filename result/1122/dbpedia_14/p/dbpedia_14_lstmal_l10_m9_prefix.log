total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask8//dbpedia_14/dbpedia_14_lstmal_l10_m8_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.10604464285714285 (59385/560000), AUC 0.47994503378868103
Test Epoch0 layer0 Acc 0.9738285714285714, AUC 0.9982542395591736
Save ckpt to ./ckpt/mask9//dbpedia_14/dbpedia_14_lstmal_l10_m9_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9857714285714285, AUC 0.9982346296310425
Test Epoch0 layer2 Acc 0.9857428571428571, AUC 0.9980034232139587
Test Epoch0 layer3 Acc 0.9858, AUC 0.9971705079078674
Test Epoch0 layer4 Acc 0.9857428571428571, AUC 0.9974495768547058
Test Epoch0 layer5 Acc 0.9856857142857143, AUC 0.9971070885658264
Test Epoch0 layer6 Acc 0.9857714285714285, AUC 0.996863842010498
Test Epoch0 layer7 Acc 0.9857142857142858, AUC 0.9971280694007874
Test Epoch0 layer8 Acc 0.9854714285714286, AUC 0.9965099096298218
Test Epoch0 layer9 Acc 0.13772857142857142, AUC 0.4862751066684723
gc 0
Train Epoch1 Acc 0.10858035714285715 (60805/560000), AUC 0.49756819009780884
Test Epoch1 layer0 Acc 0.9735428571428572, AUC 0.9982973337173462
Save ckpt to ./ckpt/mask9//dbpedia_14/dbpedia_14_lstmal_l10_m9_prefix.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9860142857142857, AUC 0.9981051087379456
Test Epoch1 layer2 Acc 0.9859857142857142, AUC 0.9979572892189026
Test Epoch1 layer3 Acc 0.9860428571428571, AUC 0.9972385168075562
Test Epoch1 layer4 Acc 0.9860428571428571, AUC 0.9973675012588501
Test Epoch1 layer5 Acc 0.9860285714285715, AUC 0.9969683289527893
Test Epoch1 layer6 Acc 0.9859571428571429, AUC 0.9968535304069519
Test Epoch1 layer7 Acc 0.9859714285714286, AUC 0.9970336556434631
Test Epoch1 layer8 Acc 0.9858285714285714, AUC 0.9964708685874939
Test Epoch1 layer9 Acc 0.07327142857142857, AUC 0.5082083344459534
gc 0
Train Epoch2 Acc 0.07228928571428571 (40482/560000), AUC 0.5086382627487183
Test Epoch2 layer0 Acc 0.9738285714285714, AUC 0.9982830882072449
Test Epoch2 layer1 Acc 0.9858, AUC 0.9980717897415161
Test Epoch2 layer2 Acc 0.9857142857142858, AUC 0.9978687167167664
Test Epoch2 layer3 Acc 0.9857285714285714, AUC 0.9969967603683472
Test Epoch2 layer4 Acc 0.9857428571428571, AUC 0.9969625473022461
Test Epoch2 layer5 Acc 0.9857428571428571, AUC 0.9968438744544983
Test Epoch2 layer6 Acc 0.9856857142857143, AUC 0.996624767780304
Test Epoch2 layer7 Acc 0.9857, AUC 0.9968238472938538
Test Epoch2 layer8 Acc 0.9856857142857143, AUC 0.9966099858283997
Test Epoch2 layer9 Acc 0.07255714285714286, AUC 0.4966486096382141
gc 0
Train Epoch3 Acc 0.07208571428571428 (40368/560000), AUC 0.5037854909896851
Test Epoch3 layer0 Acc 0.9740285714285715, AUC 0.9982843995094299
Test Epoch3 layer1 Acc 0.9855428571428572, AUC 0.9979838132858276
Test Epoch3 layer2 Acc 0.9853571428571428, AUC 0.9975771903991699
Test Epoch3 layer3 Acc 0.9853285714285714, AUC 0.9968656301498413
Test Epoch3 layer4 Acc 0.9852714285714286, AUC 0.9968277215957642
Test Epoch3 layer5 Acc 0.9851857142857143, AUC 0.9965245127677917
Test Epoch3 layer6 Acc 0.9852571428571428, AUC 0.9962716102600098
Test Epoch3 layer7 Acc 0.9852428571428572, AUC 0.9965916872024536
Test Epoch3 layer8 Acc 0.9851857142857143, AUC 0.9961498379707336
Test Epoch3 layer9 Acc 0.07235714285714286, AUC 0.5097193121910095
gc 0
Train Epoch4 Acc 0.07201071428571429 (40326/560000), AUC 0.5036446452140808
Test Epoch4 layer0 Acc 0.9738285714285714, AUC 0.9982729554176331
Test Epoch4 layer1 Acc 0.9852, AUC 0.9978641271591187
Test Epoch4 layer2 Acc 0.9852285714285715, AUC 0.9974946975708008
Test Epoch4 layer3 Acc 0.9852142857142857, AUC 0.9967346787452698
Test Epoch4 layer4 Acc 0.9852428571428572, AUC 0.9967103004455566
Test Epoch4 layer5 Acc 0.9851714285714286, AUC 0.9964208602905273
Test Epoch4 layer6 Acc 0.9852285714285715, AUC 0.9961873888969421
Test Epoch4 layer7 Acc 0.9852, AUC 0.9968000054359436
Test Epoch4 layer8 Acc 0.9851285714285715, AUC 0.9960793256759644
Test Epoch4 layer9 Acc 0.07231428571428572, AUC 0.5010825395584106
gc 0
Train Epoch5 Acc 0.07185535714285714 (40239/560000), AUC 0.4989331066608429
Test Epoch5 layer0 Acc 0.9738, AUC 0.9982884526252747
Test Epoch5 layer1 Acc 0.9853857142857143, AUC 0.9976977109909058
Test Epoch5 layer2 Acc 0.9854285714285714, AUC 0.9974152445793152
Test Epoch5 layer3 Acc 0.9853857142857143, AUC 0.9963744282722473
Test Epoch5 layer4 Acc 0.9854714285714286, AUC 0.9965400695800781
Test Epoch5 layer5 Acc 0.9854285714285714, AUC 0.9962835907936096
Test Epoch5 layer6 Acc 0.9855, AUC 0.9958378076553345
Test Epoch5 layer7 Acc 0.9854714285714286, AUC 0.9964137077331543
Test Epoch5 layer8 Acc 0.9854428571428572, AUC 0.9958838820457458
Test Epoch5 layer9 Acc 0.07228571428571429, AUC 0.49320387840270996
gc 0
Train Epoch6 Acc 0.072075 (40362/560000), AUC 0.5000804662704468
Test Epoch6 layer0 Acc 0.9737285714285714, AUC 0.9982766509056091
Test Epoch6 layer1 Acc 0.9854857142857143, AUC 0.99760502576828
Test Epoch6 layer2 Acc 0.9854714285714286, AUC 0.9972758889198303
Test Epoch6 layer3 Acc 0.9854714285714286, AUC 0.9962671995162964
Test Epoch6 layer4 Acc 0.9854571428571428, AUC 0.9964948296546936
Test Epoch6 layer5 Acc 0.9854285714285714, AUC 0.9960465431213379
Test Epoch6 layer6 Acc 0.9854428571428572, AUC 0.996093213558197
Test Epoch6 layer7 Acc 0.9854285714285714, AUC 0.9962636828422546
Test Epoch6 layer8 Acc 0.9854428571428572, AUC 0.9956036806106567
Test Epoch6 layer9 Acc 0.07284285714285714, AUC 0.5015029311180115
gc 0
Train Epoch7 Acc 0.07203392857142857 (40339/560000), AUC 0.5010771155357361
Test Epoch7 layer0 Acc 0.9737571428571429, AUC 0.9982783198356628
Test Epoch7 layer1 Acc 0.9851571428571428, AUC 0.9973741173744202
Test Epoch7 layer2 Acc 0.9851571428571428, AUC 0.9971129298210144
Test Epoch7 layer3 Acc 0.9852285714285715, AUC 0.9963135719299316
Test Epoch7 layer4 Acc 0.9851714285714286, AUC 0.9963997006416321
Test Epoch7 layer5 Acc 0.9851714285714286, AUC 0.9960083365440369
Test Epoch7 layer6 Acc 0.9851428571428571, AUC 0.9958099126815796
Test Epoch7 layer7 Acc 0.9852142857142857, AUC 0.9963102340698242
Test Epoch7 layer8 Acc 0.9852, AUC 0.9960079193115234
Test Epoch7 layer9 Acc 0.07295714285714286, AUC 0.4969203770160675
gc 0
Train Epoch8 Acc 0.07239107142857143 (40539/560000), AUC 0.5014171600341797
Test Epoch8 layer0 Acc 0.9737, AUC 0.9982870221138
Test Epoch8 layer1 Acc 0.9850714285714286, AUC 0.9973692893981934
Test Epoch8 layer2 Acc 0.985, AUC 0.9971365332603455
Test Epoch8 layer3 Acc 0.9850142857142857, AUC 0.9960891604423523
Test Epoch8 layer4 Acc 0.9849857142857142, AUC 0.9961404204368591
Test Epoch8 layer5 Acc 0.9848857142857143, AUC 0.9960091710090637
Test Epoch8 layer6 Acc 0.9849428571428571, AUC 0.9955940246582031
Test Epoch8 layer7 Acc 0.9848857142857143, AUC 0.9959920644760132
Test Epoch8 layer8 Acc 0.9848714285714286, AUC 0.9955574870109558
Test Epoch8 layer9 Acc 0.07277142857142857, AUC 0.500083327293396
gc 0
Train Epoch9 Acc 0.07196964285714286 (40303/560000), AUC 0.49957558512687683
Test Epoch9 layer0 Acc 0.9737571428571429, AUC 0.9982782602310181
Test Epoch9 layer1 Acc 0.9852571428571428, AUC 0.9972363114356995
Test Epoch9 layer2 Acc 0.9850285714285715, AUC 0.9969381093978882
Test Epoch9 layer3 Acc 0.9851428571428571, AUC 0.9961110353469849
Test Epoch9 layer4 Acc 0.9851571428571428, AUC 0.9960876107215881
Test Epoch9 layer5 Acc 0.9851571428571428, AUC 0.9956327080726624
Test Epoch9 layer6 Acc 0.9851285714285715, AUC 0.9955155253410339
Test Epoch9 layer7 Acc 0.9851142857142857, AUC 0.9957576990127563
Test Epoch9 layer8 Acc 0.9851, AUC 0.9952678084373474
Test Epoch9 layer9 Acc 0.07284285714285714, AUC 0.501080334186554
Best AUC 0.9982973337173462
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask9//dbpedia_14/dbpedia_14_lstmal_l10_m9_prefix.pt
[[4699   44   21   14   11   65   39    7    2    6    5   23   19   45]
 [  39 4900    1    2    8    0   25    6    4    2    1    0    5    7]
 [  39   15 4580   19   54    1   10    3    6    1    1   97   24  150]
 [   2    2   30 4951   11    0    1    0    0    0    0    1    0    2]
 [  11   19   75   11 4851    9    6    2    2    0    0    1    2   11]
 [  41    1    3    4    1 4938    4    3    1    1    0    0    1    2]
 [  67   52    6    3   11   16 4781   41   11    5    1    1    3    2]
 [   0    1    0    0    2    0   10 4966   16    3    0    0    1    1]
 [   1    4    2    0    3    0    9   13 4968    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4954   34    0    0    1]
 [  12    1    0    0    0    0    2    3    0   35 4946    1    0    0]
 [   5    0   30    2    0    0    0    0    0    0    0 4941   14    8]
 [   8    2   21    6    1    2    1    3    0    2    0   25 4884   45]
 [  31    6   71    7   14    3    4   10    1    7    3    7   47 4789]]
Figure(640x480)
[[4823   35   14    4   11   33   37    3    1    1    1    7    5   25]
 [  35 4923    0    0    6    1   27    0    1    1    0    0    2    4]
 [  15    3 4867   10   67    1    2    0    0    0    1    9    7   18]
 [   3    1   12 4970   11    0    1    0    0    0    0    0    2    0]
 [   5    4   63    9 4905    2    5    0    0    2    0    0    2    3]
 [  31    0    0    0    1 4957    4    2    0    2    0    0    1    2]
 [  66   25    3    0    1   13 4863   18    5    2    0    0    2    2]
 [   3    0    0    0    0    1   16 4970    7    1    1    0    0    1]
 [   2    0    1    0    1    0    7    5 4984    0    0    0    0    0]
 [   1    0    0    1    0    0    1    2    0 4975   20    0    0    0]
 [  14    1    1    0    0    0    1    1    0   22 4960    0    0    0]
 [   3    0    8    1    0    0    1    0    0    0    0 4968   14    5]
 [   5    0    2    0    0    0    1    0    0    0    0   17 4950   25]
 [  26    3   23    1    3    3    4    0    0    0    1    7   23 4906]]
Figure(640x480)
[[4822   35   14    4   12   33   38    3    1    1    1    7    5   24]
 [  36 4919    0    0    7    1   29    1    1    1    0    0    2    3]
 [  14    3 4867   11   69    1    2    0    0    0    1    9    6   17]
 [   3    1   12 4970   11    0    1    0    0    0    0    0    2    0]
 [   5    4   60    9 4908    2    4    0    0    2    0    0    3    3]
 [  30    0    0    0    1 4959    3    2    0    2    0    0    1    2]
 [  65   25    3    0    1   13 4864   18    5    2    0    0    3    1]
 [   4    0    0    0    0    1   13 4971    9    1    0    0    0    1]
 [   3    0    1    0    1    0    7    4 4984    0    0    0    0    0]
 [   1    0    0    1    0    0    1    2    0 4976   19    0    0    0]
 [  14    1    1    0    0    1    1    1    0   22 4959    0    0    0]
 [   3    0    7    1    0    0    1    0    0    0    0 4969   15    4]
 [   6    0    2    0    0    0    1    0    0    0    0   19 4947   25]
 [  26    3   22    1    3    3    4    0    0    0    1    8   25 4904]]
Figure(640x480)
[[4820   35   14    4   12   32   39    3    1    1    1    7    4   27]
 [  33 4923    0    0    7    1   28    0    1    1    0    0    2    4]
 [  14    3 4867   11   69    1    2    0    0    0    1    9    6   17]
 [   3    1   12 4970   11    0    0    0    0    0    0    1    2    0]
 [   5    5   58    9 4909    2    3    0    0    3    0    0    4    2]
 [  29    0    0    0    1 4960    3    2    0    2    0    0    1    2]
 [  65   25    3    0    1   14 4863   18    5    2    0    0    3    1]
 [   3    0    0    0    0    1   12 4972    9    2    0    0    0    1]
 [   3    0    1    0    1    0    7    4 4984    0    0    0    0    0]
 [   1    0    0    1    0    0    1    2    0 4976   19    0    0    0]
 [  14    1    0    0    0    1    1    1    0   22 4960    0    0    0]
 [   3    0    8    1    0    0    1    0    0    0    0 4967   16    4]
 [   6    0    2    0    0    0    1    0    0    0    0   18 4948   25]
 [  26    3   22    1    3    3    4    0    0    0    1    8   25 4904]]
Figure(640x480)
[[4819   36   14    4   12   33   39    3    1    1    1    7    4   26]
 [  34 4923    0    0    7    1   28    0    1    1    0    0    2    3]
 [  13    3 4867   11   69    1    3    0    0    0    1    9    6   17]
 [   3    1   12 4970   11    0    0    0    0    0    0    1    2    0]
 [   5    5   59    9 4908    2    3    0    0    3    0    0    4    2]
 [  29    0    0    0    1 4960    3    2    0    2    0    0    1    2]
 [  65   25    3    0    1   13 4864   18    5    2    0    0    3    1]
 [   4    0    0    0    0    1   12 4972    9    1    0    0    0    1]
 [   2    0    1    0    1    0    7    4 4985    0    0    0    0    0]
 [   1    0    0    1    0    0    1    2    0 4976   19    0    0    0]
 [  14    1    1    0    0    1    1    1    0   22 4959    0    0    0]
 [   3    0    8    1    0    0    1    0    0    0    0 4967   16    4]
 [   5    0    2    0    0    0    1    0    0    0    0   18 4949   25]
 [  26    3   22    1    3    3    4    0    0    0    1    8   25 4904]]
Figure(640x480)
[[4820   36   14    4   12   31   39    3    1    1    1    7    4   27]
 [  34 4923    0    0    7    1   28    0    1    1    0    0    2    3]
 [  14    3 4865   11   71    1    2    0    0    0    1    9    6   17]
 [   3    1   12 4970   11    0    0    1    0    0    0    0    2    0]
 [   5    5   58    9 4910    2    3    0    0    3    0    0    3    2]
 [  29    0    0    0    1 4960    3    2    0    2    0    0    1    2]
 [  65   25    3    0    1   13 4864   18    5    2    0    0    3    1]
 [   4    0    0    0    0    1   12 4971   10    1    0    0    0    1]
 [   2    0    1    0    1    0    7    4 4985    0    0    0    0    0]
 [   1    0    0    1    0    0    1    2    0 4976   19    0    0    0]
 [  15    1    1    0    0    0    1    1    0   22 4959    0    0    0]
 [   3    0    8    1    0    0    1    0    0    0    0 4967   16    4]
 [   6    0    2    0    0    0    1    0    0    0    0   18 4948   25]
 [  26    3   22    1    3    3    4    0    0    0    1    8   25 4904]]
Figure(640x480)
[[4820   37   14    4   12   31   38    3    1    1    1    7    4   27]
 [  33 4923    0    0    7    1   28    0    1    1    0    0    2    4]
 [  14    3 4867   11   69    1    2    0    0    0    1    9    6   17]
 [   3    1   13 4969   11    0    0    1    0    0    0    0    2    0]
 [   6    5   60    9 4908    2    3    0    0    2    0    0    3    2]
 [  29    0    0    0    1 4960    3    2    0    2    0    0    1    2]
 [  66   27    3    0    1   13 4861   18    5    2    0    0    3    1]
 [   4    0    0    0    0    1   12 4971   10    1    0    0    0    1]
 [   2    0    1    0    1    0    6    5 4985    0    0    0    0    0]
 [   1    0    0    1    0    0    1    2    0 4976   19    0    0    0]
 [  15    1    1    0    0    0    1    1    0   22 4959    0    0    0]
 [   3    0    8    1    0    0    1    0    0    0    0 4967   16    4]
 [   6    0    2    0    0    0    1    0    0    0    0   18 4948   25]
 [  26    3   23    1    3    3    4    0    0    0    1    8   25 4903]]
Figure(640x480)
[[4824   37   14    4   12   30   37    3    0    1    1    7    4   26]
 [  35 4923    0    0    6    1   27    0    1    1    0    0    2    4]
 [  14    3 4866   11   69    1    2    0    0    0    1    9    6   18]
 [   4    1   12 4969   11    0    1    0    0    0    0    0    2    0]
 [   6    5   59    9 4909    2    3    0    0    2    0    0    3    2]
 [  30    0    0    0    1 4959    3    2    0    2    0    0    1    2]
 [  66   27    3    0    1   13 4861   18    5    2    0    0    3    1]
 [   4    0    0    0    0    1   13 4969   11    1    0    0    0    1]
 [   2    0    1    0    1    0    6    5 4985    0    0    0    0    0]
 [   1    0    0    1    0    0    1    2    0 4975   20    0    0    0]
 [  15    1    1    0    0    0    1    1    0   22 4959    0    0    0]
 [   4    0    7    1    0    0    1    0    0    0    0 4967   16    4]
 [   6    0    2    0    0    0    1    0    0    0    0   18 4948   25]
 [  26    3   22    1    3    3    4    0    0    0    1    8   25 4904]]
Figure(640x480)
[[4823   37   14    4   12   30   36    2    2    1    1    7    5   26]
 [  35 4923    0    0    6    1   27    0    1    1    0    0    2    4]
 [  14    3 4866   11   69    1    2    0    0    0    1   10    6   17]
 [   4    1   12 4969   11    0    1    0    0    0    0    0    2    0]
 [   6    5   60    9 4908    2    3    0    0    2    0    0    3    2]
 [  30    0    0    0    1 4959    3    2    0    2    0    0    1    2]
 [  66   28    3    0    1   14 4858   18    6    2    0    0    3    1]
 [   4    0    0    0    0    1   13 4969   11    1    0    0    0    1]
 [   2    0    1    0    1    0    6    5 4985    0    0    0    0    0]
 [   2    0    0    1    0    0    1    2    0 4973   21    0    0    0]
 [  14    1    1    0    0    1    1    1    0   21 4960    0    0    0]
 [   4    0    7    1    0    0    1    0    0    0    0 4967   16    4]
 [   7    0    2    0    0    0    1    0    0    0    0   19 4946   25]
 [  26    2   23    1    3    4    5    0    0    0    1    8   25 4902]]
Figure(640x480)
[[   0    0    0    0   53    0    0    0 4826    0   72    0    0   49]
 [   0    0    0    0    4    0    0    0   29    0 4927    1    0   39]
 [   0    0    0    0 4773    0    0    0  113    0   35    1    0   78]
 [   0    0    0    0   10    0    0    0   10    0    9    0    0 4971]
 [   0    0    0    0   38    0    0    0   82    0    5    1    0 4874]
 [   0    0    0    0 4947    0    0    0   47    0    3    0    0    3]
 [   0    0    0    0   20    0    0    0   85    0   37    0    0 4858]
 [   0    0    0    0    0    0    0    0   39    0    0    0    0 4961]
 [   0    0    0    0    1    0    0    0 4984    0    6    0    0    9]
 [   0    0    0    0 4993    0    0    0    7    0    0    0    0    0]
 [   0    0    0    0 4965    0    0    0   34    0    1    0    0    0]
 [   0    0    0    0   22    0    0 1523    3    0  175    8    0 3269]
 [   0    0    0    0 4893    0    0   74   10    0    3    6    0   14]
 [   0    0    0    0 4863    0    0    1   32    0    6    0    0   98]]
Figure(640x480)
