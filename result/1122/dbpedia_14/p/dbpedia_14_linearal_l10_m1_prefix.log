total count words 887881
vocab size 30000
found 28354 words in glove
Start Training
gc 0
Train Epoch0 Acc 0.07142678571428572 (39999/560000), AUC 0.45690038800239563
Test Epoch0 layer0 Acc 0.9733714285714286, AUC 0.9980370402336121
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l10_m1_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.07237142857142857, AUC 0.5663627982139587
Test Epoch0 layer2 Acc 0.06938571428571429, AUC 0.4951910376548767
Test Epoch0 layer3 Acc 0.036514285714285714, AUC 0.4485248029232025
Test Epoch0 layer4 Acc 0.07175714285714285, AUC 0.5077154636383057
Test Epoch0 layer5 Acc 0.09617142857142857, AUC 0.5482789874076843
Test Epoch0 layer6 Acc 0.06342857142857143, AUC 0.5384224057197571
Test Epoch0 layer7 Acc 0.07082857142857144, AUC 0.46831849217414856
Test Epoch0 layer8 Acc 0.06822857142857143, AUC 0.48749181628227234
Test Epoch0 layer9 Acc 0.07142857142857142, AUC 0.427946001291275
gc 0
Train Epoch1 Acc 0.07142857142857142 (40000/560000), AUC 0.42953869700431824
Test Epoch1 layer0 Acc 0.9741857142857143, AUC 0.9981738328933716
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l10_m1_prefix.pt  ,ep 1
Test Epoch1 layer1 Acc 0.0721, AUC 0.5675907731056213
Test Epoch1 layer2 Acc 0.0694, AUC 0.4930932819843292
Test Epoch1 layer3 Acc 0.0359, AUC 0.4418870508670807
Test Epoch1 layer4 Acc 0.07144285714285714, AUC 0.511149525642395
Test Epoch1 layer5 Acc 0.09151428571428571, AUC 0.5511572360992432
Test Epoch1 layer6 Acc 0.06217142857142857, AUC 0.5401754975318909
Test Epoch1 layer7 Acc 0.06988571428571429, AUC 0.46341702342033386
Test Epoch1 layer8 Acc 0.06624285714285714, AUC 0.49443578720092773
Test Epoch1 layer9 Acc 0.07142857142857142, AUC 0.4219951629638672
gc 0
Train Epoch2 Acc 0.07142857142857142 (40000/560000), AUC 0.42156702280044556
Test Epoch2 layer0 Acc 0.9736, AUC 0.9982471466064453
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l10_m1_prefix.pt  ,ep 2
Test Epoch2 layer1 Acc 0.07214285714285715, AUC 0.5706149935722351
Test Epoch2 layer2 Acc 0.07214285714285715, AUC 0.4908795654773712
Test Epoch2 layer3 Acc 0.038014285714285716, AUC 0.43608784675598145
Test Epoch2 layer4 Acc 0.07042857142857142, AUC 0.5149198770523071
Test Epoch2 layer5 Acc 0.09638571428571428, AUC 0.5553309321403503
Test Epoch2 layer6 Acc 0.061585714285714285, AUC 0.5420858263969421
Test Epoch2 layer7 Acc 0.06815714285714286, AUC 0.4581167995929718
Test Epoch2 layer8 Acc 0.06271428571428571, AUC 0.5028384327888489
Test Epoch2 layer9 Acc 0.07142857142857142, AUC 0.41809532046318054
gc 0
Train Epoch3 Acc 0.07142678571428572 (39999/560000), AUC 0.4157099425792694
Test Epoch3 layer0 Acc 0.9736428571428571, AUC 0.9982481002807617
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l10_m1_prefix.pt  ,ep 3
Test Epoch3 layer1 Acc 0.07228571428571429, AUC 0.5750333666801453
Test Epoch3 layer2 Acc 0.08664285714285715, AUC 0.4885629713535309
Test Epoch3 layer3 Acc 0.039785714285714285, AUC 0.43156054615974426
Test Epoch3 layer4 Acc 0.06931428571428572, AUC 0.5195249915122986
Test Epoch3 layer5 Acc 0.10934285714285714, AUC 0.5591956973075867
Test Epoch3 layer6 Acc 0.06132857142857143, AUC 0.5438546538352966
Test Epoch3 layer7 Acc 0.06452857142857144, AUC 0.45462697744369507
Test Epoch3 layer8 Acc 0.05738571428571428, AUC 0.5118924379348755
Test Epoch3 layer9 Acc 0.07141428571428571, AUC 0.41271981596946716
gc 0
Train Epoch4 Acc 0.07142321428571428 (39997/560000), AUC 0.41004374623298645
Test Epoch4 layer0 Acc 0.9739857142857142, AUC 0.9983207583427429
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l10_m1_prefix.pt  ,ep 4
Test Epoch4 layer1 Acc 0.07271428571428572, AUC 0.5819646716117859
Test Epoch4 layer2 Acc 0.09107142857142857, AUC 0.48611825704574585
Test Epoch4 layer3 Acc 0.04094285714285714, AUC 0.4271390736103058
Test Epoch4 layer4 Acc 0.06827142857142857, AUC 0.5264315009117126
Test Epoch4 layer5 Acc 0.14387142857142857, AUC 0.5644281506538391
Test Epoch4 layer6 Acc 0.07588571428571429, AUC 0.5472339391708374
Test Epoch4 layer7 Acc 0.05614285714285714, AUC 0.4555126130580902
Test Epoch4 layer8 Acc 0.05098571428571429, AUC 0.5191994309425354
Test Epoch4 layer9 Acc 0.0714, AUC 0.40943118929862976
gc 0
Train Epoch5 Acc 0.07141785714285714 (39994/560000), AUC 0.40603938698768616
Test Epoch5 layer0 Acc 0.974, AUC 0.998317539691925
Test Epoch5 layer1 Acc 0.07308571428571428, AUC 0.5896801352500916
Test Epoch5 layer2 Acc 0.08441428571428572, AUC 0.483397901058197
Test Epoch5 layer3 Acc 0.04075714285714286, AUC 0.4235002398490906
Test Epoch5 layer4 Acc 0.06668571428571429, AUC 0.532031238079071
Test Epoch5 layer5 Acc 0.15141428571428572, AUC 0.567568302154541
Test Epoch5 layer6 Acc 0.08175714285714286, AUC 0.5506014227867126
Test Epoch5 layer7 Acc 0.0407, AUC 0.46539607644081116
Test Epoch5 layer8 Acc 0.04768571428571428, AUC 0.5205332040786743
Test Epoch5 layer9 Acc 0.0714, AUC 0.40535736083984375
gc 0
Train Epoch6 Acc 0.0714125 (39991/560000), AUC 0.40131860971450806
Test Epoch6 layer0 Acc 0.9739, AUC 0.9983099699020386
Test Epoch6 layer1 Acc 0.07415714285714285, AUC 0.5941558480262756
Test Epoch6 layer2 Acc 0.07012857142857143, AUC 0.4816722273826599
Test Epoch6 layer3 Acc 0.04125714285714286, AUC 0.4214605391025543
Test Epoch6 layer4 Acc 0.06684285714285715, AUC 0.5379703640937805
Test Epoch6 layer5 Acc 0.15304285714285715, AUC 0.5702564716339111
Test Epoch6 layer6 Acc 0.08042857142857143, AUC 0.550180971622467
Test Epoch6 layer7 Acc 0.03757142857142857, AUC 0.481447696685791
Test Epoch6 layer8 Acc 0.05354285714285714, AUC 0.5193519592285156
Test Epoch6 layer9 Acc 0.0714, AUC 0.4014011323451996
gc 0
Train Epoch7 Acc 0.07138214285714285 (39974/560000), AUC 0.3981165289878845
Test Epoch7 layer0 Acc 0.9735, AUC 0.9983256459236145
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l10_m1_prefix.pt  ,ep 7
Test Epoch7 layer1 Acc 0.07554285714285715, AUC 0.5965441465377808
Test Epoch7 layer2 Acc 0.05695714285714286, AUC 0.47956356406211853
Test Epoch7 layer3 Acc 0.041614285714285715, AUC 0.4218684732913971
Test Epoch7 layer4 Acc 0.0716, AUC 0.5430999398231506
Test Epoch7 layer5 Acc 0.15612857142857142, AUC 0.5746198892593384
Test Epoch7 layer6 Acc 0.07877142857142858, AUC 0.5453923940658569
Test Epoch7 layer7 Acc 0.03627142857142857, AUC 0.4904199242591858
Test Epoch7 layer8 Acc 0.0661, AUC 0.5181825160980225
Test Epoch7 layer9 Acc 0.07137142857142857, AUC 0.4002295434474945
gc 0
Train Epoch8 Acc 0.0713625 (39963/560000), AUC 0.3967799246311188
Test Epoch8 layer0 Acc 0.9741285714285715, AUC 0.998323380947113
Test Epoch8 layer1 Acc 0.07808571428571429, AUC 0.5984262228012085
Test Epoch8 layer2 Acc 0.04712857142857143, AUC 0.47702938318252563
Test Epoch8 layer3 Acc 0.04102857142857143, AUC 0.4225565791130066
Test Epoch8 layer4 Acc 0.08044285714285715, AUC 0.5461205244064331
Test Epoch8 layer5 Acc 0.1606857142857143, AUC 0.5777366757392883
Test Epoch8 layer6 Acc 0.07857142857142857, AUC 0.5406729578971863
Test Epoch8 layer7 Acc 0.03467142857142857, AUC 0.4938024580478668
Test Epoch8 layer8 Acc 0.0703, AUC 0.5172740817070007
Test Epoch8 layer9 Acc 0.07135714285714286, AUC 0.3996855914592743
gc 0
Train Epoch9 Acc 0.07135178571428571 (39957/560000), AUC 0.39644235372543335
Test Epoch9 layer0 Acc 0.9737714285714286, AUC 0.9983435273170471
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l10_m1_prefix.pt  ,ep 9
Test Epoch9 layer1 Acc 0.07852857142857143, AUC 0.5981492400169373
Test Epoch9 layer2 Acc 0.04794285714285714, AUC 0.477046400308609
Test Epoch9 layer3 Acc 0.04115714285714286, AUC 0.4228217601776123
Test Epoch9 layer4 Acc 0.08381428571428572, AUC 0.5464226603507996
Test Epoch9 layer5 Acc 0.16197142857142857, AUC 0.5787587761878967
Test Epoch9 layer6 Acc 0.07818571428571429, AUC 0.5394120216369629
Test Epoch9 layer7 Acc 0.03402857142857143, AUC 0.4935252070426941
Test Epoch9 layer8 Acc 0.07061428571428571, AUC 0.5167220234870911
Test Epoch9 layer9 Acc 0.07135714285714286, AUC 0.3995743691921234
Best AUC 0.9983435273170471
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l10_m1_prefix.pt
[[4697   39   21   15   11   70   41    8    4    6    5   22   18   43]
 [  36 4893    2    1    7    1   32    9    3    2    1    0    4    9]
 [  40   12 4631   19   51    1   10    4    4    0    1   80   20  127]
 [   2    2   31 4948   12    1    1    0    0    0    0    0    0    3]
 [   9   16   85   13 4843    9    5    1    2    0    0    1    3   13]
 [  34    1    3    3    1 4945    5    3    1    1    0    0    1    2]
 [  63   46    5    3   10   17 4794   40    9    5    1    1    3    3]
 [   0    0    0    0    2    0   11 4964   18    3    1    0    0    1]
 [   2    3    2    0    3    0   10   12 4968    0    0    0    0    0]
 [   1    0    0    2    1    0    0    7    0 4948   39    1    0    1]
 [  12    1    0    0    0    0    2    4    0   31 4949    1    0    0]
 [   5    0   36    2    0    0    0    0    0    1    0 4928   15   13]
 [   8    2   25    7    2    5    1    3    1    2    0   23 4870   51]
 [  32    3   83    9   12    3    3   10    1    6    3    8   41 4786]]
Figure(640x480)
[[   0  693    0   13   86   28 3476  250    0    0  434   18    1    1]
 [   0    3    0    0    0   10 4975    0    0    0    7    5    0    0]
 [   0    7    0   53   84   78 4596   93    0    0   63    8   15    3]
 [   0    2    0  255   18  144 4488   41    7    0   40    1    2    2]
 [   0   68    0   12    3   68 4815    6    0    0    3   23    2    0]
 [   0  710    0   75    4  111 4042    0    1    0    8   15   34    0]
 [   0   22    0   10    1  132 4743    5    0    0   69   10    8    0]
 [   0   31    0   99  234  100 3982   76    0    1  340   24  111    2]
 [   1    0    0  206    0   58 4716    5    0    0    2    0   12    0]
 [   0    0    0   14    0  852 4076    7    0    0   16    4   31    0]
 [   0   21    0   52    1  245 4634    0    0    0   11   31    5    0]
 [   0   89    0  384   76  244 3802   12    0    0   93  251   49    0]
 [   0   61    0  131    3  177 4212    0    0    0  145  237   34    0]
 [   0  694    0 1625    7  412 2137   18    0    0   79   15    3   10]]
Figure(640x480)
[[ 735    0    0   49    6    6   29  389  136 3642    6    1    0    1]
 [ 810    0    0   11    1  231    0   96 1260 2590    0    0    0    1]
 [3283    0    0   88   17    6    1  394  809  396    0    0    0    6]
 [1811    0    0    7   70    4   85  381  168 2459    0    0    0   15]
 [1648    0    0   12    1   25    3 2315  368  542    2    0    0   84]
 [2461    0    0  751  119    1    1  748   31  882    0    0    0    6]
 [3150    0    0   30  236   89   18  668  424   70  265    1    0   49]
 [2419    3    1   11    3    1    0  619 1798  135    1    0    0    9]
 [4098    0    0   28  148    0    7  477  142   96    0    0    0    4]
 [1734    0    0   63  272    0   10 1074  162 1685    0    0    0    0]
 [  68    0    0   70  662    2    0 2436  401 1361    0    0    0    0]
 [4429    0    0    6   21    3   77   43  345   76    0    0    0    0]
 [1851    0    0   77    6   80    0  799 1772  415    0    0    0    0]
 [ 198    1    0   15    6   16    1 4122  151  328   10    4    0  148]]
Figure(640x480)
[[1169    0    0    0    0    0 3499  124    2  201    4    0    0    1]
 [ 146    0    0    0    0    0 2707 2139    0    7    1    0    0    0]
 [ 742    0    0    0    0    0 3462  758    0   35    3    0    0    0]
 [  76    0    0    0    0    0 2152 2764    2    6    0    0    0    0]
 [ 276    0    0    0    0    0 2026 2210    1  487    0    0    0    0]
 [2192    0    0    0    0    0 2540  265    1    1    1    0    0    0]
 [1468    0    0    0    0    0  945 2540    8   38    1    0    0    0]
 [ 396    0    0    0    0    0 3848  755    0    1    0    0    0    0]
 [ 568    0    0  148    0  190 3737  357    0    0    0    0    0    0]
 [4622    0    0    0    0    0  343   34    0    1    0    0    0    0]
 [2039    0    0    0    1    0 2553  396    0    0   11    0    0    0]
 [1321    0    0  104    0    0 3449   75    1   50    0    0    0    0]
 [3150    0    0    0    0    0 1145  292    0  307  106    0    0    0]
 [ 347    0    0    0    0    0 2953 1148   25  527    0    0    0    0]]
Figure(640x480)
[[   0    0    0    0    2    0 3741 1081    0    0  176    0    0    0]
 [   0    0    0    0    0    0 1624 3375    1    0    0    0    0    0]
 [   0    0    0    0    0    0 2295 2704    1    0    0    0    0    0]
 [   0    0    0    0    0    0   49 4950    1    0    0    0    0    0]
 [   0    0    0    0    3    0 1798 3092    1    0  106    0    0    0]
 [   0    0    0    0    0    0  643 4357    0    0    0    0    0    0]
 [   0    0    0    0    0    0 2604 2389    6    0    1    0    0    0]
 [   0    0    0    0    1    0 4166  815   18    0    0    0    0    0]
 [   0    0    0    0    0    0 2459   97 2444    0    0    0    0    0]
 [   0    0    0    0    0    0  521 4477    1    0    0    0    1    0]
 [   0    0    0    0    0    0 3101 1775  123    0    1    0    0    0]
 [   0    0    0    0    0    0  487 4513    0    0    0    0    0    0]
 [   0    0    0    0    0    0  147 4853    0    0    0    0    0    0]
 [   0    0    1    0    0    0 3266 1732    1    0    0    0    0    0]]
Figure(640x480)
[[   7    0    0    0    0 3761    0  967  128  131    0    0    3    3]
 [  35    0    0    0    0 4054    0  360   36  510    0    0    0    5]
 [ 590    0    0    0    0 3619    0  709   56   18    0    0    0    8]
 [  51    0    0    0    0  825  392 2514 1049  160    0    0    0    9]
 [ 289    0    5    1    0 1188    0 2008   22  246    0    0    0 1241]
 [   5    0    0    0    0 4267    0  480  198   49    0    0    1    0]
 [  22    0    0    0    0 2696    4  920  937  370    0    0   21   30]
 [  17    0    0    0    0  603  360 3886   82   24    0    0   20    8]
 [   1    0    0    0    0  302  166 1308 3155   62    0    0    0    6]
 [   1    0    0    0    0 2276    3 2564  127    7    0    0    0   22]
 [  14    0    0    0    0 3227    3 1570   10    4    0    0    0  172]
 [ 174    0    0    0    0  821    0 3139  844   13    0    0    9    0]
 [  22    0    0    0    0  668    0 3046   93 1159    0    0   12    0]
 [   7    0   12    0    0 3416   63  766  685   23    0    0   28    0]]
Figure(640x480)
[[   0    0    0    0    0   15    3    0 4969    0    0    0   13    0]
 [   0    0    0    0    0  168    0    0 4830    0    0    0    2    0]
 [   0    0    0    0    0   40    0    0 4923    0    0    0   37    0]
 [   0    0    0    0    0    8    1    0 4990    0    0    0    1    0]
 [   0    0    0    0    0   43   10    0 4947    0    0    0    0    0]
 [   0    0    0    0    0  269    4    0 4539    0    0    0  188    0]
 [   0    0    0    0    0   44   27    0 4618    1    0    0  310    0]
 [   0    0    0    0    0    5    1    0 4994    0    0    0    0    0]
 [   0    0    0    0    0  159    0    0 4840    0    0    0    1    0]
 [   0    0    0    0    0  167    0    0 4809    0    0    0   24    0]
 [   0    0    0    0    0   60    1    0 4935    0    0    0    4    0]
 [   0    0    0    0    0    8    0    0 4992    0    0    0    0    0]
 [   0    0    0    0    0  869    0    0 3794    0    0    0  337    0]
 [   0    0    0    0    0   46    2    0 4947    0    0    0    5    0]]
Figure(640x480)
[[   0    0    0    0    0  980  220  454 3279    0    0    0   67    0]
 [   2    0    0    0    2 2681  422  599 1200    0    0   10   84    0]
 [   0    0    0    0    0  898 2971  458  673    0    0    0    0    0]
 [   0    0    0    0    1  508 1922 2319  249    0    0    1    0    0]
 [   0    0    0    0    1  561  605  147 3675    0    0    2    9    0]
 [   0    0    0    0    1  287 1981 1206 1520    0    0    3    2    0]
 [   0    0    0    0    0  285  128 1264 3223    0    0    0  100    0]
 [   0    0    0    0    0 1877  182 1925 1007    0    0    0    9    0]
 [   0    0    0    0    1   79 1176 3207   15    0    0    4  518    0]
 [   1    0    0    0    0  179  155 4577   88    0    0    0    0    0]
 [   0    0    0    0    0  983 2269 1476  239    0    0    0   33    0]
 [   0    0    0    0    0 2178 1635  179  981    0    0   26    1    0]
 [   0    0    0    0    0  164 1869 2621  346    0    0    0    0    0]
 [   0    0    0    0    0 2839  197  108 1855    0    0    0    1    0]]
Figure(640x480)
[[2230    0    0   95    0  114    1 1629  931    0    0    0    0    0]
 [1338    0    0  171    0    1    0 2698  792    0    0    0    0    0]
 [ 507    0    0    8    0   27    0 1307 3151    0    0    0    0    0]
 [1633    0    0    6    0   49    0 2007 1305    0    0    0    0    0]
 [ 897    0    0    4    0    4    0 1521 2574    0    0    0    0    0]
 [1012    0    0    2    0   48    0 1312 2626    0    0    0    0    0]
 [ 596    0    0    1    0   22    0 3162 1219    0    0    0    0    0]
 [ 851    0    0    1    0   53    0 1815 2280    0    0    0    0    0]
 [  73    0    0    0    0   11    0 4072  844    0    0    0    0    0]
 [1090    0    0    0    0  132    0 2144 1634    0    0    0    0    0]
 [ 105    0    0   30    0  119    4 1093 3649    0    0    0    0    0]
 [3995    0    0    4    0  126    0  723  152    0    0    0    0    0]
 [ 774    0    0    0    0    2    0 4042  182    0    0    0    0    0]
 [3053    0    0    1    0    0    0 1210  736    0    0    0    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0 4999    1    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]
 [   5    0    0    0    0    0    0 4995    0    0    0    0    0    0]
 [   4    0    0    0    0    0    0 4996    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]
 [   2    0    0    1    0    0    0 4997    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]]
Figure(640x480)
