total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask8//dbpedia_14/dbpedia_14_transformeral_l10_m8_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.10143035714285714 (56801/560000), AUC 0.5368366837501526
Test Epoch0 layer0 Acc 0.9740571428571428, AUC 0.9982640147209167
Save ckpt to ./ckpt/mask9//dbpedia_14/dbpedia_14_transformeral_l10_m9_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9790142857142857, AUC 0.9971577525138855
Test Epoch0 layer2 Acc 0.9786571428571429, AUC 0.995915412902832
Test Epoch0 layer3 Acc 0.9785714285714285, AUC 0.9947739243507385
Test Epoch0 layer4 Acc 0.9785857142857143, AUC 0.9941226840019226
Test Epoch0 layer5 Acc 0.9785714285714285, AUC 0.993768036365509
Test Epoch0 layer6 Acc 0.9785428571428572, AUC 0.993064820766449
Test Epoch0 layer7 Acc 0.9786142857142857, AUC 0.9922618865966797
Test Epoch0 layer8 Acc 0.9785428571428572, AUC 0.9921887516975403
Test Epoch0 layer9 Acc 0.07105714285714286, AUC 0.5484359264373779
gc 0
Train Epoch1 Acc 0.07392321428571429 (41397/560000), AUC 0.5107054710388184
Test Epoch1 layer0 Acc 0.9732142857142857, AUC 0.9983022809028625
Save ckpt to ./ckpt/mask9//dbpedia_14/dbpedia_14_transformeral_l10_m9_prefix.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9787857142857143, AUC 0.99715656042099
Test Epoch1 layer2 Acc 0.9785285714285714, AUC 0.9955294728279114
Test Epoch1 layer3 Acc 0.9783, AUC 0.9944866299629211
Test Epoch1 layer4 Acc 0.9782714285714286, AUC 0.9941312074661255
Test Epoch1 layer5 Acc 0.9782714285714286, AUC 0.993100643157959
Test Epoch1 layer6 Acc 0.9782, AUC 0.9924148321151733
Test Epoch1 layer7 Acc 0.9782285714285714, AUC 0.9914774894714355
Test Epoch1 layer8 Acc 0.9782571428571428, AUC 0.9915356636047363
Test Epoch1 layer9 Acc 0.07142857142857142, AUC 0.4852655231952667
gc 0
Train Epoch2 Acc 0.07142857142857142 (40000/560000), AUC 0.48754069209098816
Test Epoch2 layer0 Acc 0.9734714285714285, AUC 0.9982894659042358
Test Epoch2 layer1 Acc 0.9790571428571428, AUC 0.9972181916236877
Test Epoch2 layer2 Acc 0.9786, AUC 0.9954314231872559
Test Epoch2 layer3 Acc 0.9783714285714286, AUC 0.9945691823959351
Test Epoch2 layer4 Acc 0.9783, AUC 0.9940654039382935
Test Epoch2 layer5 Acc 0.9783142857142857, AUC 0.9938618540763855
Test Epoch2 layer6 Acc 0.9782857142857143, AUC 0.9927183389663696
Test Epoch2 layer7 Acc 0.9783142857142857, AUC 0.9926580786705017
Test Epoch2 layer8 Acc 0.9783571428571428, AUC 0.9920984506607056
Test Epoch2 layer9 Acc 0.07142857142857142, AUC 0.4970913827419281
gc 0
Train Epoch3 Acc 0.07143035714285714 (40001/560000), AUC 0.48888301849365234
Test Epoch3 layer0 Acc 0.9737142857142858, AUC 0.9982852935791016
Test Epoch3 layer1 Acc 0.9791142857142857, AUC 0.9971241354942322
Test Epoch3 layer2 Acc 0.9788285714285714, AUC 0.9954627156257629
Test Epoch3 layer3 Acc 0.9787714285714286, AUC 0.9944915771484375
Test Epoch3 layer4 Acc 0.9787285714285714, AUC 0.9936721920967102
Test Epoch3 layer5 Acc 0.9786142857142857, AUC 0.9929633736610413
Test Epoch3 layer6 Acc 0.9786, AUC 0.9927080273628235
Test Epoch3 layer7 Acc 0.9785714285714285, AUC 0.9920081496238708
Test Epoch3 layer8 Acc 0.9785714285714285, AUC 0.992219865322113
Test Epoch3 layer9 Acc 0.07142857142857142, AUC 0.5234931111335754
gc 0
Train Epoch4 Acc 0.07142857142857142 (40000/560000), AUC 0.4964238107204437
Test Epoch4 layer0 Acc 0.9736857142857143, AUC 0.9982804656028748
Test Epoch4 layer1 Acc 0.9791428571428571, AUC 0.9969610571861267
Test Epoch4 layer2 Acc 0.9789571428571429, AUC 0.9954802393913269
Test Epoch4 layer3 Acc 0.9789, AUC 0.994266927242279
Test Epoch4 layer4 Acc 0.9788, AUC 0.9933875799179077
Test Epoch4 layer5 Acc 0.9787857142857143, AUC 0.9928074479103088
Test Epoch4 layer6 Acc 0.9787142857142858, AUC 0.9921143651008606
Test Epoch4 layer7 Acc 0.9786142857142857, AUC 0.9919801354408264
Test Epoch4 layer8 Acc 0.9785285714285714, AUC 0.9916984438896179
Test Epoch4 layer9 Acc 0.07142857142857142, AUC 0.5271028280258179
gc 0
Train Epoch5 Acc 0.07142857142857142 (40000/560000), AUC 0.5011999011039734
Test Epoch5 layer0 Acc 0.9738142857142857, AUC 0.9982811212539673
Test Epoch5 layer1 Acc 0.9792142857142857, AUC 0.9970372915267944
Test Epoch5 layer2 Acc 0.9786714285714285, AUC 0.9950960278511047
Test Epoch5 layer3 Acc 0.9786, AUC 0.9940610527992249
Test Epoch5 layer4 Acc 0.9786142857142857, AUC 0.9934806227684021
Test Epoch5 layer5 Acc 0.9786, AUC 0.993058979511261
Test Epoch5 layer6 Acc 0.9786142857142857, AUC 0.9925335645675659
Test Epoch5 layer7 Acc 0.9786, AUC 0.9920310974121094
Test Epoch5 layer8 Acc 0.9786571428571429, AUC 0.9920706748962402
Test Epoch5 layer9 Acc 0.07142857142857142, AUC 0.5315526723861694
gc 0
Train Epoch6 Acc 0.07143035714285714 (40001/560000), AUC 0.5042970776557922
Test Epoch6 layer0 Acc 0.9735285714285714, AUC 0.9982897043228149
Test Epoch6 layer1 Acc 0.9791285714285715, AUC 0.9970309138298035
Test Epoch6 layer2 Acc 0.9785285714285714, AUC 0.9949532747268677
Test Epoch6 layer3 Acc 0.9784428571428572, AUC 0.9940881729125977
Test Epoch6 layer4 Acc 0.9785142857142857, AUC 0.9933599233627319
Test Epoch6 layer5 Acc 0.9784285714285714, AUC 0.9928521513938904
Test Epoch6 layer6 Acc 0.9783714285714286, AUC 0.9925217628479004
Test Epoch6 layer7 Acc 0.9784857142857143, AUC 0.9921426773071289
Test Epoch6 layer8 Acc 0.9784428571428572, AUC 0.9918034672737122
Test Epoch6 layer9 Acc 0.07142857142857142, AUC 0.5294246077537537
gc 0
Train Epoch7 Acc 0.07143035714285714 (40001/560000), AUC 0.5069186687469482
Test Epoch7 layer0 Acc 0.9736571428571429, AUC 0.9982832670211792
Test Epoch7 layer1 Acc 0.9793142857142857, AUC 0.9970060586929321
Test Epoch7 layer2 Acc 0.9787285714285714, AUC 0.9949668049812317
Test Epoch7 layer3 Acc 0.9786142857142857, AUC 0.9939226508140564
Test Epoch7 layer4 Acc 0.9785714285714285, AUC 0.9933596253395081
Test Epoch7 layer5 Acc 0.9784857142857143, AUC 0.9929332733154297
Test Epoch7 layer6 Acc 0.9784857142857143, AUC 0.992144763469696
Test Epoch7 layer7 Acc 0.9785285714285714, AUC 0.9919365644454956
Test Epoch7 layer8 Acc 0.9785, AUC 0.991689145565033
Test Epoch7 layer9 Acc 0.07142857142857142, AUC 0.529662549495697
gc 0
Train Epoch8 Acc 0.07142857142857142 (40000/560000), AUC 0.5064537525177002
Test Epoch8 layer0 Acc 0.9735857142857143, AUC 0.998271107673645
Test Epoch8 layer1 Acc 0.9790142857142857, AUC 0.9970167875289917
Test Epoch8 layer2 Acc 0.9783714285714286, AUC 0.9948583245277405
Test Epoch8 layer3 Acc 0.9783, AUC 0.9937576651573181
Test Epoch8 layer4 Acc 0.9782142857142857, AUC 0.9932029843330383
Test Epoch8 layer5 Acc 0.9782285714285714, AUC 0.9926791191101074
Test Epoch8 layer6 Acc 0.9782142857142857, AUC 0.9921894669532776
Test Epoch8 layer7 Acc 0.9781285714285715, AUC 0.9915722608566284
Test Epoch8 layer8 Acc 0.9781, AUC 0.9913945198059082
Test Epoch8 layer9 Acc 0.07142857142857142, AUC 0.5296774506568909
gc 0
Train Epoch9 Acc 0.07143214285714286 (40002/560000), AUC 0.5058363676071167
Test Epoch9 layer0 Acc 0.9737, AUC 0.9982682466506958
Test Epoch9 layer1 Acc 0.9789142857142857, AUC 0.9969391822814941
Test Epoch9 layer2 Acc 0.9780428571428571, AUC 0.9947274923324585
Test Epoch9 layer3 Acc 0.978, AUC 0.9936406016349792
Test Epoch9 layer4 Acc 0.9778571428571429, AUC 0.9931749105453491
Test Epoch9 layer5 Acc 0.9779142857142857, AUC 0.9927002787590027
Test Epoch9 layer6 Acc 0.9779142857142857, AUC 0.9923567771911621
Test Epoch9 layer7 Acc 0.9778571428571429, AUC 0.9919105172157288
Test Epoch9 layer8 Acc 0.9779, AUC 0.9915406107902527
Test Epoch9 layer9 Acc 0.07142857142857142, AUC 0.526739239692688
Best AUC 0.9983022809028625
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask9//dbpedia_14/dbpedia_14_transformeral_l10_m9_prefix.pt
[[4695   42   22   15   11   66   44    8    3    6    4   20   19   45]
 [  35 4894    4    1    7    0   33    7    4    2    1    0    4    8]
 [  40   13 4632   17   46    1   10    2    5    0    1   74   21  138]
 [   4    1   32 4947   11    1    1    0    0    0    0    0    0    3]
 [  12   20   97   14 4822    9   10    2    2    0    0    0    2   10]
 [  39    1    3    5    1 4938    5    2    1    2    0    0    1    2]
 [  64   51    7    3   11   15 4797   31    9    5    1    1    3    2]
 [   0    1    0    0    2    0   13 4961   17    3    0    0    2    1]
 [   1    3    2    0    4    0   14   11 4965    0    0    0    0    0]
 [   1    0    1    2    1    0    0    7    0 4958   29    0    0    1]
 [  12    1    0    0    0    0    2    4    1   35 4944    1    0    0]
 [   8    0   47    3    0    0    0    0    0    1    0 4912   17   12]
 [   8    2   26    5    1    3    1    3    0    2    0   23 4882   44]
 [  34    6   85    8   11    3    4    9    1    4    4    6   47 4778]]
Figure(640x480)
[[4758   43   19    6   12   50   43    2    0    0    2   13   12   40]
 [  35 4921    4    1    6    1   23    0    0    1    1    1    1    5]
 [  36   10 4693   11   73    1    9    0    0    0    2   46   19  100]
 [   4    1   14 4962   12    1    1    0    0    1    0    1    1    2]
 [   9   12   59   10 4884    8    6    0    1    1    0    0    4    6]
 [  39    1    1    0    0 4951    4    1    0    0    0    1    1    1]
 [  62   47    4    0    7   11 4835   17    5    4    0    1    2    5]
 [   4    2    0    0    2    1   34 4938   12    6    0    0    1    0]
 [   3    2    1    0    5    0   14    9 4966    0    0    0    0    0]
 [   1    0    1    1    1    1    0    3    0 4966   25    0    0    1]
 [  13    1    0    0    0    2    1    2    0   23 4958    0    0    0]
 [   6    0   27    2    0    0    0    0    0    0    0 4950   10    5]
 [   9    2   11    1    0    1    0    0    0    0    0   23 4912   41]
 [  39    4   51    3    3    4    5    0    0    0    2    8   60 4821]]
Figure(640x480)
[[4755   49   19    5   11   52   47    2    0    1    0   15    8   36]
 [  33 4926    2    1    7    1   22    0    0    1    1    1    1    4]
 [  39   10 4680   12   70    1    8    1    1    0    3   45   20  110]
 [   4    1   12 4965   12    1    1    0    0    1    0    1    0    2]
 [  11   12   62    9 4880    8    5    0    1    1    0    0    4    7]
 [  39    1    1    0    0 4952    3    2    0    0    0    0    1    1]
 [  60   52    3    1    5   14 4833   16    6    2    0    1    2    5]
 [   7    4    0    0    2    1   35 4934   12    4    0    0    1    0]
 [   3    4    1    0    4    0   13   10 4965    0    0    0    0    0]
 [   1    0    1    1    1    1    0    1    0 4965   28    0    0    1]
 [  14    1    0    0    1    2    1    0    0   23 4958    0    0    0]
 [   4    0   28    1    0    0    0    0    0    0    0 4950   11    6]
 [   9    1   12    2    0    1    0    0    0    0    0   22 4912   41]
 [  48    3   46    3    2    4    5    0    0    1    2    9   55 4822]]
Figure(640x480)
[[4761   49   19    5   12   52   44    2    0    1    0   15    8   32]
 [  34 4926    1    1    7    1   22    0    0    1    1    1    1    4]
 [  40   11 4672   12   71    1    8    1    1    0    3   46   19  115]
 [   4    1   12 4965   12    1    1    0    0    1    0    1    0    2]
 [  11   12   63    9 4879    8    5    0    1    1    0    0    3    8]
 [  40    1    1    0    0 4952    3    1    0    0    0    0    1    1]
 [  61   56    2    1    5   14 4830   15    6    2    0    1    2    5]
 [   7    5    0    0    2    1   37 4931   12    4    0    0    1    0]
 [   3    4    1    0    4    0   13   10 4965    0    0    0    0    0]
 [   1    0    1    1    1    1    0    1    0 4965   28    0    0    1]
 [  14    1    0    0    1    1    1    0    0   23 4959    0    0    0]
 [   4    0   27    1    0    0    0    0    0    0    0 4951   11    6]
 [  10    1   12    2    0    1    0    0    0    0    0   24 4909   41]
 [  52    4   46    3    2    5    5    0    0    1    2    9   55 4816]]
Figure(640x480)
[[4766   50   19    5   12   49   42    1    0    1    0   15    8   32]
 [  34 4926    1    1    7    1   22    0    0    1    1    1    1    4]
 [  41   11 4663   12   71    1    8    1    1    0    2   48   19  122]
 [   4    1   11 4966   12    1    1    0    0    1    0    1    0    2]
 [  11   12   62   10 4879    8    5    0    1    1    0    0    4    7]
 [  41    1    1    0    0 4951    3    1    0    0    0    0    1    1]
 [  62   56    2    2    5   14 4829   14    6    2    0    1    2    5]
 [   7    5    0    0    2    1   37 4931   12    4    0    0    1    0]
 [   3    4    1    0    4    0   13   10 4965    0    0    0    0    0]
 [   1    0    1    1    1    1    0    1    0 4964   29    0    0    1]
 [  14    1    0    0    1    1    1    0    0   24 4958    0    0    0]
 [   4    0   27    1    0    0    0    0    0    0    0 4953    9    6]
 [  10    1   12    2    0    1    0    0    0    0    0   24 4909   41]
 [  52    4   43    3    2    5    5    0    0    1    2    9   55 4819]]
Figure(640x480)
[[4767   50   19    5   12   49   41    1    0    1    0   15    8   32]
 [  34 4926    1    1    7    1   22    0    0    1    1    1    1    4]
 [  41   11 4661   12   71    1    8    1    1    0    2   48   19  124]
 [   4    1   11 4966   12    1    1    0    0    1    0    1    0    2]
 [  11   12   61   10 4880    8    5    0    1    1    0    0    4    7]
 [  41    1    1    0    0 4951    3    1    0    0    0    0    1    1]
 [  63   57    2    2    5   14 4826   15    6    2    0    1    2    5]
 [   7    5    0    0    2    1   37 4931   11    4    0    0    2    0]
 [   3    4    1    0    4    0   13   10 4965    0    0    0    0    0]
 [   1    0    1    1    1    1    0    1    0 4964   29    0    0    1]
 [  14    1    0    0    1    1    1    0    0   23 4959    0    0    0]
 [   4    0   26    1    0    0    0    0    0    0    0 4953   10    6]
 [  10    1   12    2    0    1    0    0    0    0    0   24 4910   40]
 [  52    5   42    3    2    4    5    0    0    1    2    9   55 4820]]
Figure(640x480)
[[4764   50   19    5   12   48   44    1    0    1    0   15    8   33]
 [  34 4926    1    1    7    1   22    0    0    1    1    1    1    4]
 [  41   11 4658   12   71    1    8    1    1    0    2   48   19  127]
 [   4    1   11 4967   11    1    1    0    0    1    0    1    0    2]
 [  11   12   61   11 4879    8    5    0    1    1    0    0    3    8]
 [  42    1    1    0    0 4949    3    1    0    0    0    1    1    1]
 [  62   57    2    2    5   14 4827   15    6    2    0    1    2    5]
 [   7    5    0    0    2    1   37 4931   11    4    0    0    2    0]
 [   3    4    1    0    4    0   13   10 4965    0    0    0    0    0]
 [   1    0    1    1    1    1    0    1    0 4964   29    0    0    1]
 [  14    1    0    0    1    1    1    0    0   23 4959    0    0    0]
 [   4    0   26    1    0    0    0    0    0    0    0 4954    9    6]
 [  10    1   12    2    0    1    0    0    0    0    0   24 4908   42]
 [  52    5   42    3    2    4    5    0    0    1    2    9   52 4823]]
Figure(640x480)
[[4764   51   19    5   12   47   44    1    0    1    0   15    8   33]
 [  33 4928    1    1    7    1   22    0    0    1    1    1    0    4]
 [  41   12 4651   12   76    1    8    1    1    0    2   49   19  127]
 [   4    1   10 4968   11    1    1    0    0    1    0    1    0    2]
 [  10   13   56   11 4886    6    5    0    1    1    0    0    4    7]
 [  42    1    0    1    0 4949    3    1    0    0    0    1    1    1]
 [  61   57    2    2    5   14 4829   14    6    2    0    1    2    5]
 [   7    6    0    1    2    1   37 4930   11    4    0    0    1    0]
 [   3    4    1    0    4    0   13   11 4964    0    0    0    0    0]
 [   1    0    1    1    1    1    0    1    0 4965   28    0    0    1]
 [  14    1    0    0    1    1    1    0    0   24 4958    0    0    0]
 [   4    0   26    1    0    0    0    0    0    0    0 4954    9    6]
 [  10    1   12    2    0    1    0    0    0    0    0   24 4908   42]
 [  52    5   42    3    2    4    5    0    0    1    2    9   53 4822]]
Figure(640x480)
[[4765   51   19    5   12   47   44    1    0    1    0   15    8   32]
 [  34 4927    1    1    7    1   22    0    0    1    1    1    0    4]
 [  41   12 4653   12   74    1    8    1    1    0    1   49   19  128]
 [   4    1   10 4968   11    1    1    0    0    1    0    1    0    2]
 [  11   12   57   11 4884    7    5    0    1    1    0    0    3    8]
 [  42    1    0    1    0 4948    3    1    0    0    0    1    1    2]
 [  61   57    2    2    5   14 4829   14    6    2    0    1    2    5]
 [   7    5    0    1    2    1   37 4931   11    4    0    0    1    0]
 [   3    4    1    0    4    0   13   10 4965    0    0    0    0    0]
 [   1    0    1    1    1    1    0    1    0 4965   28    0    0    1]
 [  14    1    0    0    1    1    1    0    0   24 4958    0    0    0]
 [   4    0   26    1    0    0    0    0    0    0    0 4954    9    6]
 [  10    1   12    2    0    1    0    0    0    0    0   24 4908   42]
 [  52    5   42    3    2    4    5    0    0    1    2    9   52 4823]]
Figure(640x480)
[[   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]]
Figure(640x480)
