total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l10_m3_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.08893035714285714 (49801/560000), AUC 0.41536879539489746
Test Epoch0 layer0 Acc 0.9738571428571429, AUC 0.9983561635017395
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_linearal_l10_m4_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9757142857142858, AUC 0.9985834360122681
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_linearal_l10_m4_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9762428571428572, AUC 0.9985126852989197
Test Epoch0 layer3 Acc 0.9761142857142857, AUC 0.9984312653541565
Test Epoch0 layer4 Acc 0.06917142857142858, AUC 0.5129733085632324
Test Epoch0 layer5 Acc 0.15155714285714286, AUC 0.580167293548584
Test Epoch0 layer6 Acc 0.0382, AUC 0.3904673159122467
Test Epoch0 layer7 Acc 0.062028571428571426, AUC 0.4878796637058258
Test Epoch0 layer8 Acc 0.007485714285714286, AUC 0.5381452441215515
Test Epoch0 layer9 Acc 0.07584285714285714, AUC 0.42124322056770325
gc 0
Train Epoch1 Acc 0.05294107142857143 (29647/560000), AUC 0.40654486417770386
Test Epoch1 layer0 Acc 0.9736714285714285, AUC 0.9983295798301697
Test Epoch1 layer1 Acc 0.9761571428571428, AUC 0.9985284805297852
Test Epoch1 layer2 Acc 0.9765714285714285, AUC 0.9984030723571777
Test Epoch1 layer3 Acc 0.9763142857142857, AUC 0.9982515573501587
Test Epoch1 layer4 Acc 0.0481, AUC 0.5018189549446106
Test Epoch1 layer5 Acc 0.12771428571428572, AUC 0.5655351281166077
Test Epoch1 layer6 Acc 0.06671428571428571, AUC 0.3869340419769287
Test Epoch1 layer7 Acc 0.04511428571428571, AUC 0.497423380613327
Test Epoch1 layer8 Acc 0.0065, AUC 0.5629450082778931
Test Epoch1 layer9 Acc 0.029785714285714287, AUC 0.3944889008998871
gc 0
Train Epoch2 Acc 0.02260892857142857 (12661/560000), AUC 0.3906106650829315
Test Epoch2 layer0 Acc 0.9738, AUC 0.9983248114585876
Test Epoch2 layer1 Acc 0.9761, AUC 0.9984741806983948
Test Epoch2 layer2 Acc 0.9761, AUC 0.9982989430427551
Test Epoch2 layer3 Acc 0.9763, AUC 0.9981775283813477
Test Epoch2 layer4 Acc 0.0252, AUC 0.4987068474292755
Test Epoch2 layer5 Acc 0.12358571428571428, AUC 0.5532712936401367
Test Epoch2 layer6 Acc 0.07008571428571428, AUC 0.3899488151073456
Test Epoch2 layer7 Acc 0.03957142857142857, AUC 0.5094603300094604
Test Epoch2 layer8 Acc 0.006314285714285714, AUC 0.587623119354248
Test Epoch2 layer9 Acc 0.017142857142857144, AUC 0.39108553528785706
gc 0
Train Epoch3 Acc 0.013076785714285714 (7323/560000), AUC 0.3881166875362396
Test Epoch3 layer0 Acc 0.9739428571428571, AUC 0.9983291625976562
Test Epoch3 layer1 Acc 0.9764857142857143, AUC 0.9985049366950989
Test Epoch3 layer2 Acc 0.9765285714285714, AUC 0.9982486963272095
Test Epoch3 layer3 Acc 0.9765142857142857, AUC 0.9981223940849304
Test Epoch3 layer4 Acc 0.024771428571428573, AUC 0.4954637885093689
Test Epoch3 layer5 Acc 0.13014285714285714, AUC 0.5438275933265686
Test Epoch3 layer6 Acc 0.07137142857142857, AUC 0.40319326519966125
Test Epoch3 layer7 Acc 0.0369, AUC 0.5115277171134949
Test Epoch3 layer8 Acc 0.0051, AUC 0.5932998657226562
Test Epoch3 layer9 Acc 0.0139, AUC 0.38890910148620605
gc 0
Train Epoch4 Acc 0.01151607142857143 (6449/560000), AUC 0.38530343770980835
Test Epoch4 layer0 Acc 0.9739428571428571, AUC 0.9983263611793518
Test Epoch4 layer1 Acc 0.9764285714285714, AUC 0.9984444379806519
Test Epoch4 layer2 Acc 0.9767142857142858, AUC 0.9982839226722717
Test Epoch4 layer3 Acc 0.9765142857142857, AUC 0.9981855750083923
Test Epoch4 layer4 Acc 0.03552857142857143, AUC 0.4941670894622803
Test Epoch4 layer5 Acc 0.15407142857142858, AUC 0.5365508794784546
Test Epoch4 layer6 Acc 0.07564285714285714, AUC 0.41564518213272095
Test Epoch4 layer7 Acc 0.01937142857142857, AUC 0.5064246654510498
Test Epoch4 layer8 Acc 0.0037714285714285714, AUC 0.5999087691307068
Test Epoch4 layer9 Acc 0.012585714285714285, AUC 0.38494595885276794
gc 0
Train Epoch5 Acc 0.011975 (6706/560000), AUC 0.3817419409751892
Test Epoch5 layer0 Acc 0.9738, AUC 0.998304545879364
Test Epoch5 layer1 Acc 0.9765428571428572, AUC 0.9984232783317566
Test Epoch5 layer2 Acc 0.9766428571428571, AUC 0.9982033371925354
Test Epoch5 layer3 Acc 0.9765857142857143, AUC 0.99812251329422
Test Epoch5 layer4 Acc 0.0378, AUC 0.49234145879745483
Test Epoch5 layer5 Acc 0.16697142857142858, AUC 0.5317378044128418
Test Epoch5 layer6 Acc 0.07484285714285714, AUC 0.42009004950523376
Test Epoch5 layer7 Acc 0.011714285714285714, AUC 0.5042228102684021
Test Epoch5 layer8 Acc 0.003642857142857143, AUC 0.5990275144577026
Test Epoch5 layer9 Acc 0.0159, AUC 0.38323917984962463
gc 0
Train Epoch6 Acc 0.013966071428571428 (7821/560000), AUC 0.38010114431381226
Test Epoch6 layer0 Acc 0.9738, AUC 0.9983386397361755
Test Epoch6 layer1 Acc 0.9766142857142858, AUC 0.9984367489814758
Test Epoch6 layer2 Acc 0.9767142857142858, AUC 0.9982224702835083
Test Epoch6 layer3 Acc 0.9767571428571429, AUC 0.9980239868164062
Test Epoch6 layer4 Acc 0.03995714285714286, AUC 0.49256569147109985
Test Epoch6 layer5 Acc 0.1705142857142857, AUC 0.5276190042495728
Test Epoch6 layer6 Acc 0.08197142857142857, AUC 0.4253840446472168
Test Epoch6 layer7 Acc 0.010314285714285715, AUC 0.5014975666999817
Test Epoch6 layer8 Acc 0.0034714285714285715, AUC 0.599531352519989
Test Epoch6 layer9 Acc 0.016814285714285716, AUC 0.38029107451438904
gc 0
Train Epoch7 Acc 0.014660714285714286 (8210/560000), AUC 0.37774205207824707
Test Epoch7 layer0 Acc 0.9738285714285714, AUC 0.9983420372009277
Test Epoch7 layer1 Acc 0.9767, AUC 0.9984350204467773
Test Epoch7 layer2 Acc 0.9769428571428571, AUC 0.9981630444526672
Test Epoch7 layer3 Acc 0.9768142857142857, AUC 0.9980174899101257
Test Epoch7 layer4 Acc 0.05154285714285714, AUC 0.4928129315376282
Test Epoch7 layer5 Acc 0.1770857142857143, AUC 0.5277894139289856
Test Epoch7 layer6 Acc 0.08597142857142857, AUC 0.42931514978408813
Test Epoch7 layer7 Acc 0.010071428571428571, AUC 0.4986051023006439
Test Epoch7 layer8 Acc 0.0034285714285714284, AUC 0.5981089472770691
Test Epoch7 layer9 Acc 0.018385714285714286, AUC 0.37802600860595703
gc 0
Train Epoch8 Acc 0.0155 (8680/560000), AUC 0.3756013810634613
Test Epoch8 layer0 Acc 0.9739714285714286, AUC 0.9983350038528442
Test Epoch8 layer1 Acc 0.9767857142857143, AUC 0.9984478950500488
Test Epoch8 layer2 Acc 0.9769857142857142, AUC 0.9982227683067322
Test Epoch8 layer3 Acc 0.9767857142857143, AUC 0.9980974793434143
Test Epoch8 layer4 Acc 0.04282857142857143, AUC 0.4930412471294403
Test Epoch8 layer5 Acc 0.17832857142857142, AUC 0.5254758596420288
Test Epoch8 layer6 Acc 0.08822857142857143, AUC 0.4317552149295807
Test Epoch8 layer7 Acc 0.0085, AUC 0.4954060912132263
Test Epoch8 layer8 Acc 0.0033, AUC 0.5989980101585388
Test Epoch8 layer9 Acc 0.020771428571428573, AUC 0.37734338641166687
gc 0
Train Epoch9 Acc 0.017001785714285716 (9521/560000), AUC 0.3745024800300598
Test Epoch9 layer0 Acc 0.9737714285714286, AUC 0.9983266592025757
Test Epoch9 layer1 Acc 0.9768714285714286, AUC 0.9984448552131653
Test Epoch9 layer2 Acc 0.9770285714285715, AUC 0.9982092976570129
Test Epoch9 layer3 Acc 0.9768428571428571, AUC 0.9981324076652527
Test Epoch9 layer4 Acc 0.04682857142857143, AUC 0.4933444857597351
Test Epoch9 layer5 Acc 0.1831, AUC 0.5217137336730957
Test Epoch9 layer6 Acc 0.09435714285714286, AUC 0.4340551495552063
Test Epoch9 layer7 Acc 0.008828571428571429, AUC 0.49490123987197876
Test Epoch9 layer8 Acc 0.0031142857142857144, AUC 0.5997146964073181
Test Epoch9 layer9 Acc 0.020514285714285714, AUC 0.37752965092658997
Best AUC 0.9985834360122681
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//dbpedia_14/dbpedia_14_linearal_l10_m4_prefix.pt
[[4688   44   23   14   12   70   42    8    4    6    6   18   20   45]
 [  32 4903    2    1    7    0   30    6    3    2    1    0    4    9]
 [  37   14 4631   19   48    1   10    4    3    0    1   70   20  142]
 [   2    2   27 4953   11    1    1    0    0    0    0    0    0    3]
 [  12   18   80   14 4841    9    7    1    2    0    0    0    3   13]
 [  35    1    3    4    1 4944    5    2    1    1    0    0    1    2]
 [  62   46    5    3   11   17 4797   36    9    5    1    1    4    3]
 [   0    1    0    0    2    0   12 4965   15    3    1    0    0    1]
 [   2    4    2    0    3    0   10   14 4965    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4945   43    0    0    1]
 [  12    1    0    0    0    0    2    4    0   30 4951    0    0    0]
 [   5    0   43    3    0    0    0    0    0    1    1 4918   15   14]
 [   7    2   22    8    2    3    1    3    0    2    0   20 4880   50]
 [  31    5   81    8   12    3    3    9    1    5    4    7   42 4789]]
Figure(640x480)
[[4710   40   21   11   12   55   42    6    2    5    4   27   17   48]
 [  30 4911    1    2    7    0   31    1    1    2    1    0    4    9]
 [  30   13 4664   17   52    1   11    1    1    0    2   80   29   99]
 [   2    2   25 4956   11    0    1    1    0    0    0    0    1    1]
 [   6   13   73   16 4862    7    9    3    1    0    0    0    3    7]
 [  42    1    2    2    1 4941    5    2    1    0    0    0    1    2]
 [  55   42    5    4   10   14 4822   29    3    5    1    1    6    3]
 [   2    2    0    0    2    1   17 4958   10    3    3    0    1    1]
 [   2    4    2    0    6    0   16   19 4950    0    0    0    0    1]
 [   1    0    1    3    0    0    0    6    0 4953   35    0    0    1]
 [  12    1    0    0    0    0    2    4    0   32 4949    0    0    0]
 [   7    0   29    2    0    0    1    0    0    0    0 4934   15   12]
 [   9    2   19    3    0    3    0    1    0    0    0   19 4904   40]
 [  29    2   77    5   10    3    3    4    0    3    3    8   67 4786]]
Figure(640x480)
[[4728   40   20   10   11   53   43    5    1    5    4   18   16   46]
 [  32 4903    1    2    6    1   37    1    1    2    1    0    4    9]
 [  29   13 4688   17   55    1   11    3    0    0    2   62   22   97]
 [   2    2   24 4956   12    0    1    1    0    0    0    0    1    1]
 [   6   13   76   16 4858    7   10    1    1    3    0    0    2    7]
 [  42    1    1    1    1 4943    5    2    1    0    0    0    1    2]
 [  55   40    3    3    8   15 4837   26    1    3    0    1    5    3]
 [   3    2    0    0    2    1   17 4957   10    3    3    0    1    1]
 [   2    4    2    0    6    0   21   20 4945    0    0    0    0    0]
 [   1    0    1    3    1    0    0    6    0 4953   34    0    0    1]
 [  12    1    0    0    0    0    2    4    0   33 4948    0    0    0]
 [   7    0   41    2    0    0    1    0    0    0    0 4920   14   15]
 [   9    2   21    4    0    3    0    1    0    0    0   20 4900   40]
 [  30    3   83    5    8    3    3    4    0    0    1    8   51 4801]]
Figure(640x480)
[[4734   38   20   10   12   54   41    5    1    4    4   17   15   45]
 [  33 4901    2    2    6    0   37    1    1    2    1    0    5    9]
 [  31   13 4669   17   57    1   11    2    0    0    2   63   23  111]
 [   2    2   26 4953   12    0    1    0    0    2    0    0    1    1]
 [   6   14   64   15 4867    7   10    1    1    4    0    0    2    9]
 [  42    1    0    2    1 4943    5    2    1    0    0    0    1    2]
 [  58   38    5    3    8   17 4833   25    1    3    0    1    5    3]
 [   4    2    0    0    2    1   20 4952   10    3    4    0    1    1]
 [   2    4    2    0    6    0   20   19 4945    0    0    0    0    2]
 [   1    0    0    3    0    0    0    6    0 4953   35    0    0    2]
 [  12    1    0    0    0    0    2    4    0   31 4950    0    0    0]
 [   8    0   41    2    0    0    1    0    0    0    0 4918   15   15]
 [  10    2   20    3    0    3    0    0    0    0    0   20 4899   43]
 [  30    3   78    5    8    3    3    4    0    0    1    8   46 4811]]
Figure(640x480)
[[  52    2    0    3    0    0    0  374    3    7 1279  175 3087   18]
 [   2    3    0   35    0    0    0  244    0    0  618 3244   26  828]
 [3948  411  120    2    0    0    6   44   63    0   61  115    9  221]
 [   3    1    0    0    0    0    0   53   21    1    0 4916    1    4]
 [  16   14    3    1    0    0    0   31   45    0   26 1264  303 3297]
 [   0    4    0  204    0    0    0   52    0 3886    6  798   28   22]
 [   4    0    0    0    0    0    0   63    2    3    3  461 4274  190]
 [   1    0    3    0  763    0    0   99    6    0    0 4118    2    8]
 [   8    0    1    0   15    0    0  210   77    0    3   23    3 4660]
 [   0    0    2    1    1    0    0   51    9    0    0  109    7 4820]
 [   1    0    0   15    0    0    0   10 3083    0  265 1532   24   70]
 [  14   26    1    0    0    0    0   93    1    1   75 4170   20  599]
 [   4    2    2    0    0    0    0   98    1    0    2 4746   45  100]
 [  29   29  433    0    0    0    1 4393    1    1    2   43   57   11]]
Figure(640x480)
[[   0    0   12    0    0 4786   19   10    0   12    0    0  161    0]
 [   0    4 1373    0    0 3538   71    2    0    2    0    0   10    0]
 [   0    0 2761    0    0  396   25    2    0 1757    0    0   59    0]
 [   0    0 3670    0    0   20    8 1296    0    0    0    0    6    0]
 [   0    0   36    0    0 3806   11   22    0 1115    0    0   10    0]
 [   0    0    5    0    0 2486    0  320    0    0    0    0 2189    0]
 [   0    0   22    0    0 4932    2   19    0   19    0    0    6    0]
 [   0    0   49    0    0   59    0 4883    0    0    0    0    9    0]
 [   0    0   15    0    0   64    2 4915    0    1    0    0    3    0]
 [   0    0  233    0    0 4421    0    0    0  340    0    1    5    0]
 [   0    0   10    0    0 4956    8    0    0    4    0    0   22    0]
 [   0    0 3435    0    0  936    0    4    0  563    0    0   62    0]
 [   0    0   10    0    0 4784    0   72    0    1    0    0  133    0]
 [   0    0  128    0    0   83    0    0    0  124    0    0 4665    0]]
Figure(640x480)
[[   0    0    0  628    0    0    0 2513 1590  263    0    0    0    6]
 [   0    0    0 4841    0    0    0   40   89   28    0    2    0    0]
 [   2    0    0 4133    0   26  445  162    7  179    2    3    1   40]
 [   0    0    0  297  144    0    3   46 3867   19    0    0  624    0]
 [   1    0    0 3952    0    0   17   73   14   19    0  923    1    0]
 [   0    0    0 1189    0    0   69   26 3667   49    0    0    0    0]
 [   1    0    0 4916    0    0    1   17   43   22    0    0    0    0]
 [   1    0    0   74    0    0 3184  217  786  714    4   20    0    0]
 [   1    0    0   66    0    1    0 3476    6   20 1428    2    0    0]
 [   0    0    0   42    0    0    0 4926    2   29    0    0    0    1]
 [  14    0    0 4644    0    0    0   81   14   83    0    0    0  164]
 [   0    0    0 4171    0    0    0    1  773   55    0    0    0    0]
 [   0    0    0 4934    0    0    0    9    3   54    0    0    0    0]
 [   0    0    0 1060    0    0    1  131    5 1679    0    0    0 2124]]
Figure(640x480)
[[  11    0    0    5   62   58    0    1    0   12    0    5 4846    0]
 [1315    0    1  151   10    5    0    0    0  143    0 2107 1268    0]
 [ 116    0    0    1  112    7    0  384    0    1    0    6 4373    0]
 [  27    0 1424    0    4   17    0    0   51   56    0 2585  836    0]
 [   2    0    1    0    1    6    0    0    0    2    0    7 4981    0]
 [   0    0    0    0    3    7    0    0    0    0    0    0 4990    0]
 [   2    0    0    5   40    9    0    0    0 4008    0    4  932    0]
 [   0    0    0    0    1    1    0    0    0    1    0    0 4997    0]
 [2340    0    0    5 2192    1    0    0    0   28    0    0  434    0]
 [   0    0    0  177    1    1    0    1    0   46    0    4 4770    0]
 [   1    0    0   10    1    1    0    1    0    0    0 3428 1558    0]
 [   2    0   13    2  721    3    0    1    0    3    0    1 4254    0]
 [   1    0    0    7   97  618    0    0    0    1    0    0 4276    0]
 [  33    0    0  289 4506    4    0    0    1    1    0    0  166    0]]
Figure(640x480)
[[ 108    0 4156  232    7    0    0    0   55    0    0  439    3    0]
 [4805    0   11   84    1    0    0   82    6    0    0   11    0    0]
 [ 276    0  287   64 1324    1    0 1279 1717    0    0   51    1    0]
 [4746    0   23   37    2    0    3    5    2    0    0    3  179    0]
 [ 566    0 1555 2499    8  181    0   58   79    0    0    2   52    0]
 [4753    0   11  227    0    0    0    0    2    0    0    7    0    0]
 [ 498    0  270   12    0    0    0    0 4202    0    0   18    0    0]
 [4902    0    5    1    0    0    0    0    5    0    0   32   55    0]
 [ 661    0    1  978    0    0    0    0   57    0    0 3302    1    0]
 [4861    0    2    0  133    0    0    0    0    0    0    0    4    0]
 [4949    0   12   25    0    0    0    2   10    0    0    2    0    0]
 [4784    0    2   76    3    0    0    0  108    0    0   27    0    0]
 [4392    0   19    4    2    0    0    8  568    0    0    7    0    0]
 [4877    0    9   51    2    0    0   33   11    0    0   17    0    0]]
Figure(640x480)
[[ 352    4    0 4238    0    0    5    0    0    0    8  376   17    0]
 [ 340  608    0   47    0    0    2    0    0    0   48    0 3955    0]
 [  52    5    0  184    0    0   31    6    0    0    3 2785 1934    0]
 [  13    4    0   31    0    0 4717    0    0    0   30    4  201    0]
 [4724    1    0   44    0    0   42    0    0    0    4  119   66    0]
 [   0 2894    0 1792    0    0    1    0    0    0  311    0    2    0]
 [2410    3    0 1027    0    0    1    0    0    0 1543    4   12    0]
 [   3  704    0   42    0    0   21    0    0    0 4230    0    0    0]
 [  10   81    0  159    0    0    3 4710    0    0   21    0   16    0]
 [   4    3    0 4976    0    0    4    0    0    0    6    6    1    0]
 [   9    6    0  781    0    0    2    0    0    0    0 3569  633    0]
 [   0    6    0  434    0    0    0    0    0    0   54 4284  222    0]
 [   0    1    0  643    0    0    2    0    0    0    0 4321   33    0]
 [   3    2    0 4898    0    0    0    9    0    0    2   45   41    0]]
Figure(640x480)
