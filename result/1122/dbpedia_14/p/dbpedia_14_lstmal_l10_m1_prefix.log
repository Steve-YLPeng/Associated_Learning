total count words 887881
vocab size 30000
found 28354 words in glove
Start Training
gc 0
Train Epoch0 Acc 0.07146964285714286 (40023/560000), AUC 0.47051599621772766
Test Epoch0 layer0 Acc 0.9732714285714286, AUC 0.9979824423789978
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l10_m1_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.06932857142857143, AUC 0.5129062533378601
Test Epoch0 layer2 Acc 0.04367142857142857, AUC 0.48185738921165466
Test Epoch0 layer3 Acc 0.0677, AUC 0.5365205407142639
Test Epoch0 layer4 Acc 0.052385714285714285, AUC 0.460592120885849
Test Epoch0 layer5 Acc 0.07394285714285714, AUC 0.5664482116699219
Test Epoch0 layer6 Acc 0.09131428571428571, AUC 0.5373612642288208
Test Epoch0 layer7 Acc 0.0714, AUC 0.4239758849143982
Test Epoch0 layer8 Acc 0.07142857142857142, AUC 0.4870360493659973
Test Epoch0 layer9 Acc 0.07142857142857142, AUC 0.4692341387271881
gc 0
Train Epoch1 Acc 0.07142857142857142 (40000/560000), AUC 0.4700506627559662
Test Epoch1 layer0 Acc 0.9732, AUC 0.9981366991996765
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l10_m1_prefix.pt  ,ep 1
Test Epoch1 layer1 Acc 0.06771428571428571, AUC 0.5167862176895142
Test Epoch1 layer2 Acc 0.0485, AUC 0.48102936148643494
Test Epoch1 layer3 Acc 0.06607142857142857, AUC 0.5348228216171265
Test Epoch1 layer4 Acc 0.051371428571428575, AUC 0.4628320336341858
Test Epoch1 layer5 Acc 0.07671428571428572, AUC 0.5562247037887573
Test Epoch1 layer6 Acc 0.09104285714285715, AUC 0.5386567711830139
Test Epoch1 layer7 Acc 0.07142857142857142, AUC 0.4321027100086212
Test Epoch1 layer8 Acc 0.07142857142857142, AUC 0.490084171295166
Test Epoch1 layer9 Acc 0.07142857142857142, AUC 0.4746456742286682
gc 0
Train Epoch2 Acc 0.07142857142857142 (40000/560000), AUC 0.4715353846549988
Test Epoch2 layer0 Acc 0.9738285714285714, AUC 0.9981602430343628
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l10_m1_prefix.pt  ,ep 2
Test Epoch2 layer1 Acc 0.06911428571428571, AUC 0.5206570029258728
Test Epoch2 layer2 Acc 0.0507, AUC 0.4797530472278595
Test Epoch2 layer3 Acc 0.06431428571428571, AUC 0.5338302254676819
Test Epoch2 layer4 Acc 0.05158571428571428, AUC 0.46573859453201294
Test Epoch2 layer5 Acc 0.08414285714285714, AUC 0.5454853773117065
Test Epoch2 layer6 Acc 0.09358571428571429, AUC 0.5371941328048706
Test Epoch2 layer7 Acc 0.07142857142857142, AUC 0.4383271634578705
Test Epoch2 layer8 Acc 0.07142857142857142, AUC 0.4935198128223419
Test Epoch2 layer9 Acc 0.07142857142857142, AUC 0.4782518744468689
gc 0
Train Epoch3 Acc 0.07142857142857142 (40000/560000), AUC 0.4733794033527374
Test Epoch3 layer0 Acc 0.9734, AUC 0.9982168078422546
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l10_m1_prefix.pt  ,ep 3
Test Epoch3 layer1 Acc 0.074, AUC 0.5236578583717346
Test Epoch3 layer2 Acc 0.05132857142857143, AUC 0.4791250228881836
Test Epoch3 layer3 Acc 0.06292857142857143, AUC 0.5327585339546204
Test Epoch3 layer4 Acc 0.0522, AUC 0.4680088460445404
Test Epoch3 layer5 Acc 0.09022857142857142, AUC 0.5346001386642456
Test Epoch3 layer6 Acc 0.09778571428571428, AUC 0.5343477725982666
Test Epoch3 layer7 Acc 0.07138571428571429, AUC 0.4437708854675293
Test Epoch3 layer8 Acc 0.07142857142857142, AUC 0.49525853991508484
Test Epoch3 layer9 Acc 0.07142857142857142, AUC 0.47969791293144226
gc 0
Train Epoch4 Acc 0.07142857142857142 (40000/560000), AUC 0.47717514634132385
Test Epoch4 layer0 Acc 0.9736714285714285, AUC 0.9982823729515076
Save ckpt to ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l10_m1_prefix.pt  ,ep 4
Test Epoch4 layer1 Acc 0.07678571428571429, AUC 0.5270560383796692
Test Epoch4 layer2 Acc 0.048228571428571426, AUC 0.47892308235168457
Test Epoch4 layer3 Acc 0.06447142857142857, AUC 0.5326068997383118
Test Epoch4 layer4 Acc 0.05385714285714286, AUC 0.47023531794548035
Test Epoch4 layer5 Acc 0.0884, AUC 0.5265262722969055
Test Epoch4 layer6 Acc 0.10094285714285714, AUC 0.5326237678527832
Test Epoch4 layer7 Acc 0.07142857142857142, AUC 0.4480314254760742
Test Epoch4 layer8 Acc 0.07142857142857142, AUC 0.4974116384983063
Test Epoch4 layer9 Acc 0.07142857142857142, AUC 0.4803319573402405
gc 0
Train Epoch5 Acc 0.07142857142857142 (40000/560000), AUC 0.4786636233329773
Test Epoch5 layer0 Acc 0.9737285714285714, AUC 0.9982503056526184
Test Epoch5 layer1 Acc 0.07277142857142857, AUC 0.5297184586524963
Test Epoch5 layer2 Acc 0.04531428571428572, AUC 0.47893333435058594
Test Epoch5 layer3 Acc 0.06681428571428571, AUC 0.5324409604072571
Test Epoch5 layer4 Acc 0.05695714285714286, AUC 0.4713202118873596
Test Epoch5 layer5 Acc 0.08672857142857143, AUC 0.5218324661254883
Test Epoch5 layer6 Acc 0.10458571428571428, AUC 0.5301922559738159
Test Epoch5 layer7 Acc 0.07142857142857142, AUC 0.45052337646484375
Test Epoch5 layer8 Acc 0.07142857142857142, AUC 0.5000707507133484
Test Epoch5 layer9 Acc 0.07142857142857142, AUC 0.47902578115463257
gc 0
Train Epoch6 Acc 0.07142857142857142 (40000/560000), AUC 0.47778013348579407
Test Epoch6 layer0 Acc 0.9735857142857143, AUC 0.9982700347900391
Test Epoch6 layer1 Acc 0.06928571428571428, AUC 0.5321224331855774
Test Epoch6 layer2 Acc 0.0429, AUC 0.47961607575416565
Test Epoch6 layer3 Acc 0.07084285714285714, AUC 0.5320848822593689
Test Epoch6 layer4 Acc 0.06084285714285714, AUC 0.4732029139995575
Test Epoch6 layer5 Acc 0.08717142857142857, AUC 0.517708957195282
Test Epoch6 layer6 Acc 0.10717142857142857, AUC 0.5281729698181152
Test Epoch6 layer7 Acc 0.07142857142857142, AUC 0.45010703802108765
Test Epoch6 layer8 Acc 0.07142857142857142, AUC 0.5020824074745178
Test Epoch6 layer9 Acc 0.07142857142857142, AUC 0.47895196080207825
gc 0
Train Epoch7 Acc 0.07142857142857142 (40000/560000), AUC 0.47749075293540955
Test Epoch7 layer0 Acc 0.9735714285714285, AUC 0.9982771277427673
Test Epoch7 layer1 Acc 0.06855714285714286, AUC 0.533147394657135
Test Epoch7 layer2 Acc 0.041242857142857144, AUC 0.47974130511283875
Test Epoch7 layer3 Acc 0.07248571428571429, AUC 0.5317690968513489
Test Epoch7 layer4 Acc 0.063, AUC 0.47387197613716125
Test Epoch7 layer5 Acc 0.08751428571428571, AUC 0.5125784277915955
Test Epoch7 layer6 Acc 0.10978571428571429, AUC 0.5275080800056458
Test Epoch7 layer7 Acc 0.07142857142857142, AUC 0.44905441999435425
Test Epoch7 layer8 Acc 0.07142857142857142, AUC 0.5029845833778381
Test Epoch7 layer9 Acc 0.07142857142857142, AUC 0.4781896471977234
gc 0
Train Epoch8 Acc 0.07142857142857142 (40000/560000), AUC 0.477962464094162
Test Epoch8 layer0 Acc 0.9737857142857143, AUC 0.9982709884643555
Test Epoch8 layer1 Acc 0.06811428571428571, AUC 0.5331286787986755
Test Epoch8 layer2 Acc 0.03867142857142857, AUC 0.479890376329422
Test Epoch8 layer3 Acc 0.074, AUC 0.532009482383728
Test Epoch8 layer4 Acc 0.06454285714285714, AUC 0.4747339189052582
Test Epoch8 layer5 Acc 0.08791428571428571, AUC 0.508433997631073
Test Epoch8 layer6 Acc 0.11065714285714286, AUC 0.5273314714431763
Test Epoch8 layer7 Acc 0.07142857142857142, AUC 0.4488399028778076
Test Epoch8 layer8 Acc 0.07142857142857142, AUC 0.503454864025116
Test Epoch8 layer9 Acc 0.07142857142857142, AUC 0.47949573397636414
gc 0
Train Epoch9 Acc 0.07142857142857142 (40000/560000), AUC 0.4787778854370117
Test Epoch9 layer0 Acc 0.9739142857142857, AUC 0.9982793927192688
Test Epoch9 layer1 Acc 0.0679, AUC 0.5329293012619019
Test Epoch9 layer2 Acc 0.03805714285714286, AUC 0.48077085614204407
Test Epoch9 layer3 Acc 0.0742, AUC 0.5321725606918335
Test Epoch9 layer4 Acc 0.06521428571428571, AUC 0.47581788897514343
Test Epoch9 layer5 Acc 0.0885, AUC 0.5082266926765442
Test Epoch9 layer6 Acc 0.1105, AUC 0.5272042751312256
Test Epoch9 layer7 Acc 0.07142857142857142, AUC 0.4490266442298889
Test Epoch9 layer8 Acc 0.07142857142857142, AUC 0.5029265284538269
Test Epoch9 layer9 Acc 0.07142857142857142, AUC 0.47986170649528503
Best AUC 0.9982823729515076
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l10_m1_prefix.pt
[[4687   40   22   15   11   72   39    8    4    7    6   23   19   47]
 [  36 4892    4    1    6    0   31    9    4    2    1    0    5    9]
 [  38   12 4615   18   53    2   10    2    6    0    1   81   21  141]
 [   3    1   26 4953   12    0    1    0    0    1    0    0    0    3]
 [  10   18   84   12 4841    9    7    0    2    1    0    0    2   14]
 [  32    2    3    3    1 4944    4    4    1    3    0    0    1    2]
 [  60   50    5    2    9   17 4796   35   11    5    1    1    4    4]
 [   0    1    0    0    2    0   13 4961   18    3    1    0    0    1]
 [   1    2    2    0    3    0   11   13 4967    1    0    0    0    0]
 [   1    0    1    2    0    0    0    7    0 4949   39    0    0    1]
 [  10    1    0    0    0    2    2    4    0   31 4950    0    0    0]
 [   4    0   37    2    0    0    1    0    0    1    1 4924   17   13]
 [   8    2   24    5    1    3    1    3    1    2    0   21 4884   45]
 [  29    2   76    7   12    3    6    9    2    6    3    7   44 4794]]
Figure(640x480)
[[ 287  215 1911    5  250    1 1426   31    5   21  111    2  701   34]
 [ 173 1206 1574    3  295   11  675   77   10   27   60    4  760  125]
 [ 198  253 2011    7  484    1  695   21   29   18  181    2 1074   26]
 [ 256  241 1936    7  541    1  613   16   16   35  170    1 1136   31]
 [ 369  330 1694    7  490    2  804   30   17   20  188    2  999   48]
 [ 156  137 2760    1   33    6  557   22    8   22  398    0  880   20]
 [ 314  448 1020    7  163    8  687   73    5   17  109    1 2096   52]
 [ 128  129 3516    4   81    0  826   29    4   12   31    2  221   17]
 [ 899  133 3135    0  103    2  340    8    0    3   37    0  337    3]
 [  62   87 4219    0  188    0  363    0    0    2   24    0   50    5]
 [ 661  164 1810    1 1257    1  990   16    1    8   31    4   51    5]
 [ 236  264 1021    2  139    0 2602   31    2   13   17    6  645   22]
 [ 383  402 1146    1  430    3 1854   47   13   37   63    3  571   47]
 [ 284  301  931   18  264    0 2179  154    4   49   38    4  732   42]]
Figure(640x480)
[[ 232    0    5   20   36   18    4 1015   10   39  815   41    0 2765]
 [ 129    0    7    6   31   47   53  264    3   51  136  125    0 4148]
 [1464    0    3   61   57   56   16  944   12   18  963   15    0 1391]
 [1859    2    5   61   55   62   11  844    8   15  880    9    0 1189]
 [1415    1    7   36   48   40    6  925   21   12  659    8    0 1822]
 [1099    0    4   79   70    4    7  270    1   44  267    3    0 3152]
 [1297    1   14   17  212   12   31  772   23   24  745  157    0 1695]
 [ 391    1    1    2   10    5    3   49    3   19  115    7    1 4393]
 [3339    0   16  103   41   28    0   93    2    1 1203    3    1  170]
 [ 695    0    4    1   29  153    4  216    9   23 2215    0    0 1651]
 [ 322    0    6    6  235   42    0  688   11    3  637    0    2 3048]
 [ 262    6  130  160   64   21   16 3294   57   59   97   12    1  821]
 [ 783    5   12  144  272   16    1  690   31   36  678   24    0 2308]
 [ 963    0    7   34  202   88    4  522   41   18  843    4    0 2274]]
Figure(640x480)
[[1883   45    3    0    3    0  586    3    0    0    0  486    0 1991]
 [1805  147    0    0    1    0  597    1    0    0    0  487    0 1962]
 [1048  150    1    0    4    0 1242    3    0    0    0 1350    0 1202]
 [1150   85    0    0    1    0  977    3    0    0    1 1693    0 1090]
 [1381   93    2    0    1    0  686    5    0    0    0 1370    0 1462]
 [3143  229    1    0    1    0  314    0    1    0    0  173    0 1138]
 [ 807  301    0    0    1    0  817    6    0    0    1  233    0 2834]
 [3477  282    0    0    0    3  327   11    0    0   10  220    0  670]
 [4097   48    0    0   37    0  311   30    1    0   23  383    0   70]
 [2104   22  626    0    0    0  256    0    2    9    0 1281    0  700]
 [3183   30    1    0    0    0  322    4    0    0    0  528    0  932]
 [1211  257    2    0    0    0 1324    1    0    0    2  535    0 1668]
 [ 730  280    9    0    4    1  866   14    3    1    1  518    0 2573]
 [1197  251   21    0    6    0  792   14    0    0    0 1611    0 1108]]
Figure(640x480)
[[   0    0    0    0    0    0  122   65    0    0    0 2747    0 2066]
 [   0    0    0    0    0    0  320  188    1    0    0 3755    0  736]
 [   0    0    0    0    0    0   21  295    0    0    0 3178    0 1506]
 [   0    0    0    0    0    0   23   33    0    0    0 2791    0 2153]
 [   0    0    0    0    0    0   83  134    0    0    0 2913    0 1870]
 [   0    0    0    0    0    0  170   49    3    0    0 4399    0  379]
 [   0    0    0    0    0    0   42    9    0    0    0 4590    0  359]
 [   0    0    0    0    0    0  155  107    0    0    0 2647    0 2091]
 [   0    0    0    0    0    0  138   10    0    0    0  218    0 4634]
 [   0    0    0    0    0    0   11 3498    0    0    0  567    0  924]
 [   0    0    0    0    0    0  594 2606    1    0    0 1004    0  795]
 [   0    0    0    0    0    0   18   14    0    0    0 1456    0 3512]
 [   0    0    0    0    0    0   43   81    0    0    0 2242    0 2634]
 [   0    0    0    0    0    0   97   43    0    0    0 2695    0 2165]]
Figure(640x480)
[[   0    9    0    0   12    0    0    6  828    0    0 3759    0  386]
 [   0    0    0    0  723    0    0    0   72    0    0 3633    0  572]
 [   0    0    0    0    1    0    0    1  560    0    0 2330    0 2108]
 [   0    0    0    0    6    0    0   22  483    0    0 2465    0 2024]
 [   0    7    0    0    0    0    0    0  388    0    0 2831    0 1774]
 [   0    0    0    0   37    0    1    4   69    0    0 4060    0  829]
 [   0    8    0    0    6    0    1   16  581    0    0 1749    0 2639]
 [   0    0    0    0    2    0    0    1   17    0    0 2787    0 2193]
 [   0    0    0    0    0    0    0    2  234    0    0 1786    0 2978]
 [   0    0    0    0    0    0    0    1   13    0    0 4302    0  684]
 [   0    0    0    0    4    0    0    1   88    0    0  993    0 3914]
 [   0    1    0    0   24    0    0   30  247    0    0 3759    0  939]
 [   1   36    0    0  387    0    0   23  766    0    0 1228    0 2559]
 [   0    1    0    0   69    0    0    4   64    0    0 2669    0 2193]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0 2653    0 2347]
 [   0    0    0    0    0    0    0    0    0    0    0 2530    0 2470]
 [   0    0    0    0    0    0    0    0    0    0    0  569    0 4431]
 [   0    0    0    0    0    0    0    0    0    0    0  419    0 4581]
 [   0    0    0    0    0    0    0    0    0    0    0 1612    0 3388]
 [   0    0    0    0    0    0    0    0    0    0    0  820    0 4180]
 [   0    0    0    0    0    0    0    0    0    0    0 1206    0 3794]
 [   0    0    0    0    0    0    0    0    0    0    0  460    0 4540]
 [   0    0    0    0    0    0    0    0    0    0    0 2397    0 2603]
 [   0    0    0    0    0    0    0    0    0    0    0  202    0 4798]
 [   0    0    0    0    0    0    1    0    0    0    0 2035    0 2964]
 [   0    0    0    0    0    0    0    0    0    0    0 4470    0  530]
 [   0    0    0    0    0    0    0    0    0    0    0 1849    0 3151]
 [   0    0    0    0    0    0    0    0    0    0    0 2404    0 2596]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0 4991    0    9]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]]
Figure(640x480)
