total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask9//dbpedia_14/dbpedia_14_linearal_l10_m9_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.9572660714285715 (536069/560000), AUC 0.997136116027832
Test Epoch0 layer0 Acc 0.9741, AUC 0.9983134269714355
Save ckpt to ./ckpt/mask10//dbpedia_14/dbpedia_14_linearal_l10_m10_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9769857142857142, AUC 0.9984080195426941
Save ckpt to ./ckpt/mask10//dbpedia_14/dbpedia_14_linearal_l10_m10_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9770571428571428, AUC 0.9981668591499329
Test Epoch0 layer3 Acc 0.9768714285714286, AUC 0.9980875253677368
Test Epoch0 layer4 Acc 0.9769571428571429, AUC 0.9979864358901978
Test Epoch0 layer5 Acc 0.9768714285714286, AUC 0.9979791045188904
Test Epoch0 layer6 Acc 0.9770428571428571, AUC 0.9979852437973022
Test Epoch0 layer7 Acc 0.9770428571428571, AUC 0.998066246509552
Test Epoch0 layer8 Acc 0.9770714285714286, AUC 0.9978912472724915
Test Epoch0 layer9 Acc 0.9770571428571428, AUC 0.9979254007339478
gc 0
Train Epoch1 Acc 0.9831625 (550571/560000), AUC 0.9989570379257202
Test Epoch1 layer0 Acc 0.9736857142857143, AUC 0.9983224868774414
Test Epoch1 layer1 Acc 0.9768714285714286, AUC 0.9983819723129272
Test Epoch1 layer2 Acc 0.9771, AUC 0.9982842206954956
Test Epoch1 layer3 Acc 0.977, AUC 0.9980994462966919
Test Epoch1 layer4 Acc 0.9768142857142857, AUC 0.9978369474411011
Test Epoch1 layer5 Acc 0.9767714285714286, AUC 0.9979352355003357
Test Epoch1 layer6 Acc 0.9768428571428571, AUC 0.9979027509689331
Test Epoch1 layer7 Acc 0.9767714285714286, AUC 0.9980131387710571
Test Epoch1 layer8 Acc 0.9767571428571429, AUC 0.997935950756073
Test Epoch1 layer9 Acc 0.9768142857142857, AUC 0.9979487657546997
gc 0
Train Epoch2 Acc 0.9833267857142857 (550663/560000), AUC 0.9989518523216248
Test Epoch2 layer0 Acc 0.9739428571428571, AUC 0.9983595609664917
Test Epoch2 layer1 Acc 0.9768714285714286, AUC 0.9983918070793152
Test Epoch2 layer2 Acc 0.9769428571428571, AUC 0.9981315732002258
Test Epoch2 layer3 Acc 0.9766285714285714, AUC 0.9980364441871643
Test Epoch2 layer4 Acc 0.9766571428571429, AUC 0.9979609251022339
Test Epoch2 layer5 Acc 0.9766571428571429, AUC 0.9978805780410767
Test Epoch2 layer6 Acc 0.9767857142857143, AUC 0.9979047179222107
Test Epoch2 layer7 Acc 0.9768, AUC 0.9979861378669739
Test Epoch2 layer8 Acc 0.9767428571428571, AUC 0.9979754090309143
Test Epoch2 layer9 Acc 0.9767285714285714, AUC 0.9978753924369812
gc 0
Train Epoch3 Acc 0.9834982142857143 (550759/560000), AUC 0.9990209937095642
Test Epoch3 layer0 Acc 0.9738285714285714, AUC 0.9983134269714355
Test Epoch3 layer1 Acc 0.9768714285714286, AUC 0.9983994364738464
Test Epoch3 layer2 Acc 0.9769142857142857, AUC 0.9982830286026001
Test Epoch3 layer3 Acc 0.9768714285714286, AUC 0.9982636570930481
Test Epoch3 layer4 Acc 0.9768857142857142, AUC 0.9980587959289551
Test Epoch3 layer5 Acc 0.9768714285714286, AUC 0.9980088472366333
Test Epoch3 layer6 Acc 0.9770285714285715, AUC 0.998040497303009
Test Epoch3 layer7 Acc 0.9769571428571429, AUC 0.9979634284973145
Test Epoch3 layer8 Acc 0.9768571428571429, AUC 0.9979658126831055
Test Epoch3 layer9 Acc 0.9769, AUC 0.9978647828102112
gc 0
Train Epoch4 Acc 0.9836017857142857 (550817/560000), AUC 0.998994767665863
Test Epoch4 layer0 Acc 0.9739, AUC 0.9983395338058472
Test Epoch4 layer1 Acc 0.9770142857142857, AUC 0.998379647731781
Test Epoch4 layer2 Acc 0.9769571428571429, AUC 0.9981464743614197
Test Epoch4 layer3 Acc 0.9768, AUC 0.9980435371398926
Test Epoch4 layer4 Acc 0.9769571428571429, AUC 0.9977883696556091
Test Epoch4 layer5 Acc 0.9769714285714286, AUC 0.9977548718452454
Test Epoch4 layer6 Acc 0.9770285714285715, AUC 0.9977308511734009
Test Epoch4 layer7 Acc 0.9770142857142857, AUC 0.9976982474327087
Test Epoch4 layer8 Acc 0.9770428571428571, AUC 0.9976322054862976
Test Epoch4 layer9 Acc 0.9771, AUC 0.9976170659065247
gc 0
Train Epoch5 Acc 0.9839571428571429 (551016/560000), AUC 0.999003529548645
Test Epoch5 layer0 Acc 0.9738285714285714, AUC 0.9983332753181458
Test Epoch5 layer1 Acc 0.9772142857142857, AUC 0.9983831644058228
Test Epoch5 layer2 Acc 0.9771285714285715, AUC 0.9982252717018127
Test Epoch5 layer3 Acc 0.9771571428571428, AUC 0.9980586767196655
Test Epoch5 layer4 Acc 0.9772142857142857, AUC 0.9979339241981506
Test Epoch5 layer5 Acc 0.9771714285714286, AUC 0.9980159997940063
Test Epoch5 layer6 Acc 0.9770857142857143, AUC 0.9979255795478821
Test Epoch5 layer7 Acc 0.9771714285714286, AUC 0.9978412389755249
Test Epoch5 layer8 Acc 0.9770571428571428, AUC 0.997904360294342
Test Epoch5 layer9 Acc 0.9770428571428571, AUC 0.9979926943778992
gc 0
Train Epoch6 Acc 0.9840214285714286 (551052/560000), AUC 0.9990102648735046
Test Epoch6 layer0 Acc 0.9739857142857142, AUC 0.9983539581298828
Test Epoch6 layer1 Acc 0.9771, AUC 0.9983637928962708
Test Epoch6 layer2 Acc 0.9772, AUC 0.9981179237365723
Test Epoch6 layer3 Acc 0.9771571428571428, AUC 0.9980446100234985
Test Epoch6 layer4 Acc 0.9771857142857143, AUC 0.9979243874549866
Test Epoch6 layer5 Acc 0.9771571428571428, AUC 0.9978780150413513
Test Epoch6 layer6 Acc 0.9772857142857143, AUC 0.9977976679801941
Test Epoch6 layer7 Acc 0.9772285714285714, AUC 0.9978176355361938
Test Epoch6 layer8 Acc 0.9772571428571428, AUC 0.9977926015853882
Test Epoch6 layer9 Acc 0.9772714285714286, AUC 0.9978480339050293
gc 0
Train Epoch7 Acc 0.9841017857142857 (551097/560000), AUC 0.9989942908287048
Test Epoch7 layer0 Acc 0.9738571428571429, AUC 0.998348593711853
Test Epoch7 layer1 Acc 0.9770142857142857, AUC 0.9983730316162109
Test Epoch7 layer2 Acc 0.9772142857142857, AUC 0.9981064796447754
Test Epoch7 layer3 Acc 0.9771714285714286, AUC 0.9980220794677734
Test Epoch7 layer4 Acc 0.9771714285714286, AUC 0.9978455901145935
Test Epoch7 layer5 Acc 0.9771857142857143, AUC 0.9978125691413879
Test Epoch7 layer6 Acc 0.9772428571428572, AUC 0.9978052973747253
Test Epoch7 layer7 Acc 0.9771857142857143, AUC 0.9977494478225708
Test Epoch7 layer8 Acc 0.9772142857142857, AUC 0.9977560639381409
Test Epoch7 layer9 Acc 0.9771857142857143, AUC 0.9977828860282898
gc 0
Train Epoch8 Acc 0.9841696428571428 (551135/560000), AUC 0.998978316783905
Test Epoch8 layer0 Acc 0.974, AUC 0.9983283281326294
Test Epoch8 layer1 Acc 0.9769571428571429, AUC 0.998336672782898
Test Epoch8 layer2 Acc 0.9771571428571428, AUC 0.9981160163879395
Test Epoch8 layer3 Acc 0.9771285714285715, AUC 0.9980323910713196
Test Epoch8 layer4 Acc 0.9771428571428571, AUC 0.9978428483009338
Test Epoch8 layer5 Acc 0.9771428571428571, AUC 0.9978019595146179
Test Epoch8 layer6 Acc 0.9771142857142857, AUC 0.9978054165840149
Test Epoch8 layer7 Acc 0.9771714285714286, AUC 0.9978557229042053
Test Epoch8 layer8 Acc 0.9771285714285715, AUC 0.9977722764015198
Test Epoch8 layer9 Acc 0.9770571428571428, AUC 0.9977506399154663
gc 0
Train Epoch9 Acc 0.9843803571428571 (551253/560000), AUC 0.9989904165267944
Test Epoch9 layer0 Acc 0.9739714285714286, AUC 0.9983281493186951
Test Epoch9 layer1 Acc 0.9770857142857143, AUC 0.9983391761779785
Test Epoch9 layer2 Acc 0.9771571428571428, AUC 0.9980374574661255
Test Epoch9 layer3 Acc 0.9771571428571428, AUC 0.9979469180107117
Test Epoch9 layer4 Acc 0.9772714285714286, AUC 0.9978384375572205
Test Epoch9 layer5 Acc 0.9772, AUC 0.9978713989257812
Test Epoch9 layer6 Acc 0.9771, AUC 0.9978190064430237
Test Epoch9 layer7 Acc 0.9771428571428571, AUC 0.9978052973747253
Test Epoch9 layer8 Acc 0.9771571428571428, AUC 0.9978176355361938
Test Epoch9 layer9 Acc 0.9771, AUC 0.9977288842201233
Best AUC 0.9984080195426941
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask10//dbpedia_14/dbpedia_14_linearal_l10_m10_prefix.pt
[[4688   43   21   15   11   71   40    8    4    6    4   23   18   48]
 [  37 4893    2    2    8    0   30    7    5    2    1    0    4    9]
 [  37   13 4598   19   55    2    8    4    4    0    1   84   20  155]
 [   2    2   27 4954   11    0    0    0    0    0    0    0    0    4]
 [   8   15   65   13 4863    8    5    1    2    1    0    1    3   15]
 [  32    2    3    3    1 4947    5    2    1    1    0    0    1    2]
 [  64   43    5    3   11   18 4797   37    9    5    1    1    3    3]
 [   0    1    0    0    2    0   11 4963   18    3    1    0    0    1]
 [   2    2    2    0    4    0   11   12 4967    0    0    0    0    0]
 [   1    0    0    2    1    0    0    7    0 4956   31    1    0    1]
 [  12    1    0    0    0    0    2    4    0   35 4945    1    0    0]
 [   5    0   38    2    0    0    0    0    0    1    0 4926   15   13]
 [   9    2   23    7    2    4    1    3    0    2    0   24 4870   53]
 [  23    3   66    8   12    3    3   10    1    4    2    5   40 4820]]
Figure(640x480)
[[4721   45   22    8   13   54   41    6    2    6    3   21   15   43]
 [  35 4906    4    1    7    0   32    1    1    2    1    0    2    8]
 [  33   12 4677   17   62    1    9    1    1    1    2   62   23   99]
 [   2    2   24 4957   11    0    1    0    0    0    0    0    0    3]
 [   5    8   57   13 4888    7    7    0    2    2    0    0    2    9]
 [  41    1    3    2    1 4941    5    2    1    0    0    0    1    2]
 [  59   41    5    2    9   13 4823   31    5    4    0    1    4    3]
 [   0    2    0    0    2    0   15 4963   12    3    0    0    2    1]
 [   2    2    2    0    6    0   12   16 4960    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4961   26    0    0    2]
 [  13    1    0    0    0    0    1    3    0   36 4946    0    0    0]
 [   7    0   29    2    0    0    0    0    0    0    1 4934   15   12]
 [  10    2   18    3    0    3    1    1    1    0    0   20 4896   45]
 [  28    3   74    4    7    3    3    6    0    1    2    8   45 4816]]
Figure(640x480)
[[4736   42   20    7   12   50   44    6    1    6    3   18   13   42]
 [  38 4902    3    1    7    0   34    1    2    2    0    0    2    8]
 [  32   13 4677   16   63    1    9    0    1    3    2   67   21   95]
 [   3    2   22 4955   13    0    1    0    0    2    0    0    1    1]
 [   6    8   58   13 4886    7    7    0    2    5    0    0    2    6]
 [  42    2    2    2    1 4940    5    2    1    0    0    0    1    2]
 [  57   42    1    1    8   16 4834   26    5    3    0    1    4    2]
 [   1    2    1    0    2    0   19 4953   15    4    0    0    2    1]
 [   2    2    2    0    6    0   13   13 4960    0    0    0    0    2]
 [   1    0    1    2    1    0    0    5    0 4961   26    0    0    3]
 [  12    1    0    0    0    0    1    3    0   35 4948    0    0    0]
 [   8    0   32    2    0    0    0    0    0    0    0 4930   16   12]
 [  13    2   17    2    0    2    1    1    0    0    0   21 4898   43]
 [  30    4   73    2    7    3    4    3    0    2    1    7   50 4814]]
Figure(640x480)
[[4737   42   21    7   12   50   45    6    2    5    3   18   12   40]
 [  40 4898    3    1    8    0   35    1    2    1    0    0    3    8]
 [  35   12 4678   16   66    1   11    0    0    1    2   64   21   93]
 [   3    2   24 4954   12    1    1    0    0    1    0    0    1    1]
 [   6    8   59   12 4886    7    8    1    2    2    0    0    2    7]
 [  42    2    2    2    1 4940    5    2    1    0    0    0    1    2]
 [  62   41    2    1    9   16 4827   26    6    3    0    1    4    2]
 [   3    2    1    0    2    0   18 4951   16    4    0    0    2    1]
 [   3    2    2    0    6    0   13   12 4959    0    0    0    0    3]
 [   1    0    1    2    1    0    0    7    0 4957   28    0    0    3]
 [  12    1    0    0    0    0    1    3    0   36 4947    0    0    0]
 [   9    0   33    2    0    0    0    0    0    0    0 4929   16   11]
 [  14    2   18    2    0    2    1    0    0    1    0   22 4895   43]
 [  32    4   67    1    7    3    3    2    0    1    1    7   49 4823]]
Figure(640x480)
[[4733   43   21    7   12   50   46    6    2    6    3   19   12   40]
 [  40 4900    3    1    9    0   35    0    2    1    0    0    2    7]
 [  34   12 4683   17   64    1   11    0    0    1    2   63   21   91]
 [   3    2   24 4955   12    1    1    0    0    0    0    0    1    1]
 [   5    8   59   13 4887    7    8    0    2    2    0    0    2    7]
 [  43    2    2    2    1 4939    5    2    1    0    0    0    1    2]
 [  62   42    2    2    9   15 4824   28    6    3    0    1    3    3]
 [   3    1    1    0    2    0   20 4950   16    4    0    0    2    1]
 [   3    2    2    0    6    0   12   11 4963    0    0    0    0    1]
 [   1    0    1    2    1    0    0    6    0 4959   27    0    0    3]
 [  12    1    0    0    0    0    1    3    0   36 4947    0    0    0]
 [   9    0   31    2    0    0    0    0    0    0    0 4933   16    9]
 [  13    2   18    2    0    2    1    0    0    1    0   22 4896   43]
 [  32    4   70    1    7    3    4    2    0    2    1    7   49 4818]]
Figure(640x480)
[[4733   43   22    7   12   50   45    6    2    6    3   20   10   41]
 [  40 4897    4    1    9    0   35    1    2    1    0    0    3    7]
 [  34   12 4679   17   64    1   11    0    0    1    2   63   21   95]
 [   3    2   23 4955   13    1    1    0    0    0    0    0    1    1]
 [   5    8   61   13 4887    7    7    0    2    2    0    0    2    6]
 [  44    2    2    2    1 4937    5    2    1    0    0    1    1    2]
 [  61   42    2    2    9   15 4825   28    6    3    0    1    3    3]
 [   3    1    1    0    2    0   19 4951   16    4    0    0    2    1]
 [   3    1    2    0    6    0   13   11 4961    0    0    0    0    3]
 [   1    0    1    2    1    0    0    6    0 4959   27    0    0    3]
 [  12    1    0    0    0    0    1    3    0   35 4948    0    0    0]
 [   9    0   30    2    0    0    0    0    0    0    0 4935   14   10]
 [  14    2   18    2    0    2    1    1    0    1    0   22 4894   43]
 [  32    4   68    1    7    3    3    3    0    2    1    7   49 4820]]
Figure(640x480)
[[4735   43   21    7   12   49   47    6    2    6    3   20    9   40]
 [  39 4899    2    1    9    0   35    1    2    2    0    0    3    7]
 [  35   12 4685   17   64    1   11    0    0    1    2   63   21   88]
 [   3    2   23 4955   13    1    1    0    0    0    0    0    1    1]
 [   5    8   58   14 4888    7    8    0    2    3    0    0    2    5]
 [  45    2    2    2    1 4937    5    1    1    1    0    0    1    2]
 [  59   41    2    2    9   15 4829   27    6    3    0    1    3    3]
 [   3    1    1    0    2    0   20 4950   16    4    0    0    2    1]
 [   4    1    2    0    6    0   13   10 4963    0    0    0    0    1]
 [   1    0    1    2    1    0    0    6    0 4961   25    0    0    3]
 [  12    1    0    0    0    0    1    3    0   38 4945    0    0    0]
 [  10    0   31    2    0    0    0    0    0    0    0 4932   14   11]
 [  14    2   19    2    0    2    1    1    0    1    0   22 4893   43]
 [  32    4   69    1    7    3    3    2    0    2    1    7   48 4821]]
Figure(640x480)
[[4734   42   21    8   12   50   47    6    2    6    3   20    9   40]
 [  39 4898    4    1    9    0   35    1    2    2    0    0    2    7]
 [  36   12 4682   17   63    1   11    0    0    1    2   63   21   91]
 [   3    2   23 4955   12    1    1    0    0    1    0    0    1    1]
 [   6    8   57   14 4889    7    8    0    1    3    0    0    2    5]
 [  45    2    2    2    1 4937    5    1    1    1    0    0    1    2]
 [  58   42    2    2    9   15 4830   26    6    3    0    1    3    3]
 [   3    1    1    0    2    0   20 4949   17    4    0    0    2    1]
 [   4    2    2    0    6    0   13   10 4960    0    0    0    0    3]
 [   1    0    1    2    1    0    0    6    0 4962   24    0    0    3]
 [  12    1    0    0    0    0    2    3    0   38 4944    0    0    0]
 [   8    0   30    2    0    0    0    0    0    0    0 4938   14    8]
 [  14    2   18    2    0    2    1    1    0    1    0   22 4894   43]
 [  33    2   70    1    7    3    3    3    0    1    1    7   48 4821]]
Figure(640x480)
[[4733   42   21    8   12   49   50    6    2    5    3   20    9   40]
 [  40 4899    3    1    9    0   35    1    2    1    0    0    2    7]
 [  36   12 4683   17   64    1   11    1    0    1    2   63   21   88]
 [   3    2   23 4955   13    1    1    0    0    0    0    0    1    1]
 [   5    8   60   14 4886    7    8    1    1    3    0    0    2    5]
 [  42    2    2    1    1 4940    5    2    1    0    0    1    1    2]
 [  60   40    2    2    9   15 4829   27    6    3    0    1    3    3]
 [   3    1    1    0    2    0   19 4951   16    4    0    0    2    1]
 [   3    1    2    0    6    0   13   11 4961    0    0    0    0    3]
 [   1    0    1    2    1    0    0    6    0 4961   25    0    0    3]
 [  12    1    0    0    0    0    1    3    0   37 4946    0    0    0]
 [   8    0   31    2    0    0    0    0    0    0    0 4937   14    8]
 [  14    2   18    2    0    2    1    0    0    1    0   22 4895   43]
 [  32    2   72    1    7    3    4    3    0    1    1    7   48 4819]]
Figure(640x480)
[[4736   42   18    8   12   50   47    6    2    5    3   20    9   42]
 [  38 4899    3    1    9    0   35    1    2    2    0    0    3    7]
 [  35   12 4686   16   66    1   11    0    0    2    2   62   21   86]
 [   3    2   23 4955   12    1    1    0    0    1    0    0    1    1]
 [   5    8   56   13 4889    7    8    0    2    5    0    0    2    5]
 [  45    2    2    2    1 4937    5    1    1    1    0    0    1    2]
 [  58   43    2    2    9   15 4829   26    6    3    0    1    3    3]
 [   3    1    1    0    2    0   20 4948   18    4    0    0    2    1]
 [   4    0    2    0    6    0   14   10 4961    0    0    0    0    3]
 [   1    0    0    2    1    0    0    6    0 4963   24    0    0    3]
 [  12    1    0    0    0    0    1    3    0   39 4944    0    0    0]
 [   9    0   30    2    0    0    0    0    0    0    0 4937   14    8]
 [  15    2   18    4    0    2    1    1    0    1    0   22 4891   43]
 [  32    2   76    1    7    3    3    1    0    2    0    7   47 4819]]
Figure(640x480)
