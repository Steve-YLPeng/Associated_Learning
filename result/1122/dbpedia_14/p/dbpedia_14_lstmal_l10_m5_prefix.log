total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask4//dbpedia_14/dbpedia_14_lstmal_l10_m4_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.07143214285714286 (40002/560000), AUC 0.4823833107948303
Test Epoch0 layer0 Acc 0.9735857142857143, AUC 0.9982932806015015
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l10_m5_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9859714285714286, AUC 0.9985179305076599
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l10_m5_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9857142857142858, AUC 0.9983623623847961
Test Epoch0 layer3 Acc 0.9856142857142857, AUC 0.9974352717399597
Test Epoch0 layer4 Acc 0.9855571428571429, AUC 0.9977630972862244
Test Epoch0 layer5 Acc 0.0712, AUC 0.5851834416389465
Test Epoch0 layer6 Acc 0.07147142857142857, AUC 0.5056231021881104
Test Epoch0 layer7 Acc 0.0020428571428571427, AUC 0.3800200819969177
Test Epoch0 layer8 Acc 0.14222857142857143, AUC 0.46794071793556213
Test Epoch0 layer9 Acc 0.07145714285714286, AUC 0.47149115800857544
gc 0
Train Epoch1 Acc 0.07142142857142857 (39996/560000), AUC 0.4717264175415039
Test Epoch1 layer0 Acc 0.9736, AUC 0.9982675313949585
Test Epoch1 layer1 Acc 0.9857857142857143, AUC 0.9984984397888184
Test Epoch1 layer2 Acc 0.9857285714285714, AUC 0.9983281493186951
Test Epoch1 layer3 Acc 0.9856714285714285, AUC 0.9974952936172485
Test Epoch1 layer4 Acc 0.9856428571428572, AUC 0.9978553652763367
Test Epoch1 layer5 Acc 0.07128571428571429, AUC 0.5833110213279724
Test Epoch1 layer6 Acc 0.0714, AUC 0.5041705369949341
Test Epoch1 layer7 Acc 0.06772857142857143, AUC 0.3684781491756439
Test Epoch1 layer8 Acc 0.14192857142857143, AUC 0.46790605783462524
Test Epoch1 layer9 Acc 0.07141428571428571, AUC 0.4721215069293976
gc 0
Train Epoch2 Acc 0.07142321428571428 (39997/560000), AUC 0.47702983021736145
Test Epoch2 layer0 Acc 0.9737, AUC 0.9982998967170715
Test Epoch2 layer1 Acc 0.9859428571428571, AUC 0.9983822107315063
Test Epoch2 layer2 Acc 0.9859571428571429, AUC 0.9982830286026001
Test Epoch2 layer3 Acc 0.9859428571428571, AUC 0.9975306391716003
Test Epoch2 layer4 Acc 0.9859142857142857, AUC 0.9978018403053284
Test Epoch2 layer5 Acc 0.0714, AUC 0.5906620621681213
Test Epoch2 layer6 Acc 0.07151428571428571, AUC 0.4915878176689148
Test Epoch2 layer7 Acc 0.07018571428571428, AUC 0.36451274156570435
Test Epoch2 layer8 Acc 0.14261428571428572, AUC 0.4611256420612335
Test Epoch2 layer9 Acc 0.0714, AUC 0.4858751893043518
gc 0
Train Epoch3 Acc 0.071425 (39998/560000), AUC 0.48368167877197266
Test Epoch3 layer0 Acc 0.9730428571428571, AUC 0.9982929825782776
Test Epoch3 layer1 Acc 0.9859, AUC 0.9983657598495483
Test Epoch3 layer2 Acc 0.9858428571428571, AUC 0.998237133026123
Test Epoch3 layer3 Acc 0.9858285714285714, AUC 0.9974238276481628
Test Epoch3 layer4 Acc 0.9858714285714286, AUC 0.9976778030395508
Test Epoch3 layer5 Acc 0.07502857142857143, AUC 0.6056870222091675
Test Epoch3 layer6 Acc 0.07132857142857142, AUC 0.4804137647151947
Test Epoch3 layer7 Acc 0.07005714285714286, AUC 0.3392224609851837
Test Epoch3 layer8 Acc 0.1422857142857143, AUC 0.446601003408432
Test Epoch3 layer9 Acc 0.0714, AUC 0.48297807574272156
gc 0
Train Epoch4 Acc 0.071425 (39998/560000), AUC 0.4908280074596405
Test Epoch4 layer0 Acc 0.9737428571428571, AUC 0.9982602000236511
Test Epoch4 layer1 Acc 0.9855857142857143, AUC 0.9983319640159607
Test Epoch4 layer2 Acc 0.9856285714285714, AUC 0.9982472658157349
Test Epoch4 layer3 Acc 0.9856285714285714, AUC 0.9974840879440308
Test Epoch4 layer4 Acc 0.9855857142857143, AUC 0.997532308101654
Test Epoch4 layer5 Acc 0.13884285714285713, AUC 0.613710343837738
Test Epoch4 layer6 Acc 0.07142857142857142, AUC 0.47010841965675354
Test Epoch4 layer7 Acc 0.06954285714285714, AUC 0.33863309025764465
Test Epoch4 layer8 Acc 0.1426, AUC 0.43500587344169617
Test Epoch4 layer9 Acc 0.07141428571428571, AUC 0.4898178279399872
gc 0
Train Epoch5 Acc 0.07141428571428571 (39992/560000), AUC 0.4909575879573822
Test Epoch5 layer0 Acc 0.9739571428571429, AUC 0.9982832074165344
Test Epoch5 layer1 Acc 0.9856, AUC 0.9980326890945435
Test Epoch5 layer2 Acc 0.9855571428571429, AUC 0.9978325963020325
Test Epoch5 layer3 Acc 0.9855857142857143, AUC 0.9968815445899963
Test Epoch5 layer4 Acc 0.9856142857142857, AUC 0.9970865845680237
Test Epoch5 layer5 Acc 0.11348571428571429, AUC 0.6124415397644043
Test Epoch5 layer6 Acc 0.07145714285714286, AUC 0.4673472046852112
Test Epoch5 layer7 Acc 0.0702, AUC 0.3377760946750641
Test Epoch5 layer8 Acc 0.14238571428571428, AUC 0.43638017773628235
Test Epoch5 layer9 Acc 0.0714, AUC 0.4927867352962494
gc 0
Train Epoch6 Acc 0.07141785714285714 (39994/560000), AUC 0.4899493157863617
Test Epoch6 layer0 Acc 0.9737142857142858, AUC 0.9982810616493225
Test Epoch6 layer1 Acc 0.9851714285714286, AUC 0.9980189204216003
Test Epoch6 layer2 Acc 0.9851571428571428, AUC 0.9977688193321228
Test Epoch6 layer3 Acc 0.9852428571428572, AUC 0.9967485666275024
Test Epoch6 layer4 Acc 0.9852714285714286, AUC 0.9969611763954163
Test Epoch6 layer5 Acc 0.13244285714285714, AUC 0.611197292804718
Test Epoch6 layer6 Acc 0.0714, AUC 0.46499398350715637
Test Epoch6 layer7 Acc 0.06992857142857142, AUC 0.3337615430355072
Test Epoch6 layer8 Acc 0.14262857142857144, AUC 0.4363129734992981
Test Epoch6 layer9 Acc 0.0714, AUC 0.4891034960746765
gc 0
Train Epoch7 Acc 0.07141607142857143 (39993/560000), AUC 0.48878416419029236
Test Epoch7 layer0 Acc 0.9738428571428571, AUC 0.9982690215110779
Test Epoch7 layer1 Acc 0.9855285714285714, AUC 0.997867226600647
Test Epoch7 layer2 Acc 0.9855714285714285, AUC 0.9976329803466797
Test Epoch7 layer3 Acc 0.9857285714285714, AUC 0.9966573119163513
Test Epoch7 layer4 Acc 0.9857714285714285, AUC 0.996874213218689
Test Epoch7 layer5 Acc 0.14047142857142858, AUC 0.6088337302207947
Test Epoch7 layer6 Acc 0.07141428571428571, AUC 0.46557703614234924
Test Epoch7 layer7 Acc 0.06997142857142857, AUC 0.33348163962364197
Test Epoch7 layer8 Acc 0.1427142857142857, AUC 0.4356643557548523
Test Epoch7 layer9 Acc 0.07141428571428571, AUC 0.48680442571640015
gc 0
Train Epoch8 Acc 0.07141785714285714 (39994/560000), AUC 0.48749449849128723
Test Epoch8 layer0 Acc 0.9734857142857143, AUC 0.9982674717903137
Test Epoch8 layer1 Acc 0.9851857142857143, AUC 0.9978402256965637
Test Epoch8 layer2 Acc 0.9852571428571428, AUC 0.9974839091300964
Test Epoch8 layer3 Acc 0.9853571428571428, AUC 0.996672511100769
Test Epoch8 layer4 Acc 0.9853, AUC 0.9967673420906067
Test Epoch8 layer5 Acc 0.14057142857142857, AUC 0.6107639670372009
Test Epoch8 layer6 Acc 0.0713, AUC 0.4665842056274414
Test Epoch8 layer7 Acc 0.07041428571428572, AUC 0.3395608365535736
Test Epoch8 layer8 Acc 0.14268571428571428, AUC 0.4407832622528076
Test Epoch8 layer9 Acc 0.0714, AUC 0.4837859272956848
gc 0
Train Epoch9 Acc 0.07141964285714286 (39995/560000), AUC 0.4830651879310608
Test Epoch9 layer0 Acc 0.9736142857142858, AUC 0.9983004331588745
Test Epoch9 layer1 Acc 0.9853571428571428, AUC 0.9976920485496521
Test Epoch9 layer2 Acc 0.9853714285714286, AUC 0.9973275065422058
Test Epoch9 layer3 Acc 0.9853142857142857, AUC 0.9964370727539062
Test Epoch9 layer4 Acc 0.9853285714285714, AUC 0.9965981841087341
Test Epoch9 layer5 Acc 0.13775714285714286, AUC 0.6096769571304321
Test Epoch9 layer6 Acc 0.07135714285714286, AUC 0.4650750160217285
Test Epoch9 layer7 Acc 0.06911428571428571, AUC 0.33816200494766235
Test Epoch9 layer8 Acc 0.14262857142857144, AUC 0.441466361284256
Test Epoch9 layer9 Acc 0.0714, AUC 0.48416978120803833
Best AUC 0.9985179305076599
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l10_m5_prefix.pt
[[4689   42   24   14   11   71   40    8    4    6    7   22   17   45]
 [  38 4891    3    2    8    0   29    9    5    2    1    0    4    8]
 [  36   13 4603   19   50    1   10    4    6    0    1   86   20  151]
 [   3    2   28 4950   12    1    1    0    0    0    0    0    0    3]
 [   9   17   81   12 4849    9    5    2    2    0    0    0    2   12]
 [  34    2    3    3    1 4944    5    3    1    1    0    0    1    2]
 [  64   45    5    3   12   15 4791   40   12    5    1    1    3    3]
 [   0    1    0    0    2    0   11 4964   17    3    1    0    0    1]
 [   1    3    2    0    3    0   10   13 4968    0    0    0    0    0]
 [   1    0    1    2    1    0    0    7    0 4943   44    0    0    1]
 [  12    1    0    0    0    0    2    4    0   24 4957    0    0    0]
 [   4    0   38    2    0    0    0    0    0    0    1 4928   14   13]
 [   8    2   23    7    2    3    1    3    1    2    0   23 4879   46]
 [  29    4   75    7   12    3    3   10    1    6    4    7   44 4795]]
Figure(640x480)
[[4801   31   22    4   12   32   50    3    1    1    1    6    3   33]
 [  33 4918    1    0    8    1   31    1    1    1    0    0    0    5]
 [  12    3 4865   10   73    1    2    0    0    0    1   13    5   15]
 [   1    1   12 4972   12    0    0    0    0    0    0    1    1    0]
 [   4    4   50   10 4920    3    5    0    0    1    0    0    1    2]
 [  24    0    1    0    1 4959    8    2    1    0    0    0    2    2]
 [  50   21    2    0    5   10 4883   16    5    2    1    0    2    3]
 [   0    0    0    0    0    1   15 4974    8    0    1    0    0    1]
 [   3    0    1    0    1    0    5    6 4983    0    0    0    0    1]
 [   1    0    0    1    0    0    0    3    0 4952   43    0    0    0]
 [  13    1    0    0    0    1    1    1    0   10 4972    0    0    1]
 [   3    0    9    1    0    0    0    0    0    0    0 4974    8    5]
 [   5    0    4    0    0    1    0    0    0    0    0   26 4935   29]
 [  24    1   22    1    5    2    3    0    0    0    1   11   20 4910]]
Figure(640x480)
[[4794   32   21    4   13   32   53    3    1    1    0    8    5   33]
 [  35 4914    1    0    8    1   33    1    1    1    0    0    0    5]
 [  12    3 4864   11   72    1    1    0    0    0    1   13    5   17]
 [   1    1   12 4971   13    0    0    0    0    0    0    1    1    0]
 [   4    3   50   10 4922    3    4    0    0    1    0    0    1    2]
 [  23    0    1    0    1 4960    8    2    1    0    0    0    2    2]
 [  50   22    2    0    4   10 4881   18    5    2    1    0    2    3]
 [   0    0    0    0    0    1   15 4974    8    0    1    0    0    1]
 [   2    1    1    0    1    0    5    6 4983    0    0    0    0    1]
 [   1    0    1    1    0    0    0    3    0 4943   51    0    0    0]
 [  13    1    0    0    1    0    1    0    0   10 4973    0    0    1]
 [   3    0    9    1    0    0    0    0    0    0    0 4974    8    5]
 [   5    0    5    0    0    1    0    0    0    0    0   28 4933   28]
 [  22    1   21    1    4    2    3    0    0    0    1   11   20 4914]]
Figure(640x480)
[[4793   32   22    4   13   34   52    3    0    1    0    6    5   35]
 [  33 4916    1    0    8    1   32    1    1    1    0    0    0    6]
 [  11    3 4859   11   78    1    1    0    0    0    1   13    5   17]
 [   1    1   12 4971   13    0    0    0    0    0    0    1    1    0]
 [   4    3   49   10 4923    3    4    0    0    1    0    0    1    2]
 [  23    0    1    0    1 4960    8    2    1    0    0    0    2    2]
 [  49   23    2    0    5   10 4880   18    5    2    1    0    2    3]
 [   0    0    0    0    0    1   15 4973    9    0    1    0    0    1]
 [   2    1    1    0    1    0    5    6 4983    0    0    0    0    1]
 [   1    0    1    1    0    0    0    2    0 4946   49    0    0    0]
 [  13    1    0    0    1    1    1    0    0   10 4972    0    0    1]
 [   3    0    9    1    0    0    0    0    0    0    0 4974    8    5]
 [   4    0    5    0    0    1    0    0    0    0    0   28 4932   30]
 [  22    1   21    1    5    2    3    0    0    0    1   12   21 4911]]
Figure(640x480)
[[4784   33   20    4   14   34   59    3    2    1    0    7    5   34]
 [  30 4922    1    0    7    1   30    1    1    1    0    1    0    5]
 [  11    3 4862   10   76    1    1    0    0    0    1   14    5   16]
 [   0    1   13 4971   12    0    2    0    0    0    0    0    1    0]
 [   4    3   48   10 4920    3    5    0    0    2    0    0    2    3]
 [  23    0    1    0    1 4959    9    2    1    0    0    0    2    2]
 [  44   23    1    0    4   11 4887   17    5    2    1    0    2    3]
 [   0    0    0    0    0    1   16 4971   10    0    1    0    0    1]
 [   2    1    1    0    1    0    6    6 4982    0    0    0    0    1]
 [   1    0    1    1    0    0    0    3    0 4942   52    0    0    0]
 [  13    1    0    0    1    1    1    0    0   10 4972    0    0    1]
 [   3    0    9    1    0    0    0    0    0    0    0 4974    8    5]
 [   4    0    5    0    0    1    0    0    0    0    0   27 4934   29]
 [  22    2   21    1    6    2    3    0    0    0    1   12   21 4909]]
Figure(640x480)
[[   0    0    0   90 4905    0    0    0    0    0    0    5    0    0]
 [   0    0    0 4843  142    0    1    0    0    0    0   14    0    0]
 [   0    0    0   70 4930    0    0    0    0    0    0    0    0    0]
 [   0    0    0    3 4997    0    0    0    0    0    0    0    0    0]
 [   0    0    0   23 4977    0    0    0    0    0    0    0    0    0]
 [   0    0    0 4972   28    0    0    0    0    0    0    0    0    0]
 [   0    0    0   46 4948    0    4    0    0    0    0    2    0    0]
 [   0    0    0 4972   21    0    7    0    0    0    0    0    0    0]
 [   0    0    0   59    8    0 4933    0    0    0    0    0    0    0]
 [   0    0    0 1223   84   28    0 3665    0    0    0    0    0    0]
 [   0    0    0   17  328 4655    0    0    0    0    0    0    0    0]
 [   0    0    0    3 4997    0    0    0    0    0    0    0    0    0]
 [   0    0    0   36 4964    0    0    0    0    0    0    0    0    0]
 [   0    0    0  616 4384    0    0    0    0    0    0    0    0    0]]
Figure(640x480)
[[   0    0    6    0    0    0    0   36    0    0    0   46    0 4912]
 [   0    0 3272    0    0    0    0   23    0    0    0 1634    0   71]
 [   0    0    0    0    0    0    0   43    0    0    0   11    0 4946]
 [   0    0    2    0    0    0    0    0    0    0    0 4691    0  307]
 [   0    0    0    0    0    0    0    2    0    0    0   10    0 4988]
 [   0    0    0    0    0    0    0    7    0    0    0 4714    0  279]
 [   0    0    6    0    0    0    0 4807    0    0    0   35    0  152]
 [   0    0    0    0    0    0    0   13    0    0    0    4    0 4983]
 [   0    0    5    0    0    0    0   24    0    0    0    1    0 4970]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 5000]
 [   0    0    0    0    0    0    0    0    0    0    0    1    0 4999]
 [   0    0   11    0    0    0    0 4779    0    0    0    0    0  210]
 [   0    0    0    0    0    0    0   22    0    0    0    1    0 4977]
 [   0    0    0    0    0    0    0    8    0    0    0    2    0 4990]]
Figure(640x480)
[[   0    4    0    0   17    0    0   31  154    0    0 4794    0    0]
 [   0    0    0    0    2    0    0    4    1    0    0 4993    0    0]
 [   0 4488    0    0   65    0    0   16    1    0    0  430    0    0]
 [   0    4    0    0 4951    0    0   13    0    0    0   32    0    0]
 [   0   24    0    0  135    0    0    1    0    0    0 4840    0    0]
 [   0    0    0    0    2    0    0    2    1    0    0 4995    0    0]
 [   0    5    0    0    5    0    0    2    4    0    0 4984    0    0]
 [   0    0    0    0    9    0    0    1    0    0    0 4990    0    0]
 [   0    1    0    0 4959    0    0    1    0    0    0   39    0    0]
 [   0    0    0    0    3    0    0    9    0    0    0 4988    0    0]
 [   0    0    0    0    0    0    0    0    1    0    0 4999    0    0]
 [   0    8    0    0 4971    0    0    6    8    0    0    7    0    0]
 [   0    2    1    0  523    0    0   46 3561    0    0  867    0    0]
 [   0   25    0    0   28    0    0 4877   21    0    0   49    0    0]]
Figure(640x480)
[[   0   30    0    0    0    0    0 4954    0    0    0   16    0    0]
 [   0    4    0    0    0    0    0 4996    0    0    0    0    0    0]
 [   0  251    0    0    0    0    0 1030    0    0    0 3719    0    0]
 [   0    0    0    0    0    0    0 4996    0    0    0    4    0    0]
 [   0    2    0    0    0    0    0  990    0    0    0 4008    0    0]
 [   0    1    0    0    0    0    0 4997    0    0    0    2    0    0]
 [   0    2    0    0    0    0    0 4996    0    0    0    2    0    0]
 [   0    1    0    0    0    0    0 4998    0    0    0    1    0    0]
 [   0    1    0    0    0    0    0 4972    0    0    0   27    0    0]
 [   0    0    0    0    0    0    0 4817    0    0    0  183    0    0]
 [   0    0    0    0    0    0    0   41    0    0    0 4959    0    0]
 [   0    4    0    0    0    0    0   82    0    0    0 4914    0    0]
 [   0   23    0    0    0    0    0   45    0    0    0 4932    0    0]
 [   0 4739    0    0    0    0    0   84    0    0    0  137    0   40]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 4998    0    2]]
Figure(640x480)
