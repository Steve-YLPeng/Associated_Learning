total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask9//dbpedia_14/dbpedia_14_lstmal_l10_m9_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.9590821428571429 (537086/560000), AUC 0.9949262738227844
Test Epoch0 layer0 Acc 0.9738142857142857, AUC 0.9982937574386597
Save ckpt to ./ckpt/mask10//dbpedia_14/dbpedia_14_lstmal_l10_m10_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9860142857142857, AUC 0.998123288154602
Test Epoch0 layer2 Acc 0.9860714285714286, AUC 0.9978548884391785
Test Epoch0 layer3 Acc 0.9862714285714286, AUC 0.9970607757568359
Test Epoch0 layer4 Acc 0.9862428571428571, AUC 0.9971583485603333
Test Epoch0 layer5 Acc 0.9862142857142857, AUC 0.9969773888587952
Test Epoch0 layer6 Acc 0.9861571428571428, AUC 0.9967355132102966
Test Epoch0 layer7 Acc 0.9861285714285715, AUC 0.9970141053199768
Test Epoch0 layer8 Acc 0.9860857142857142, AUC 0.9965245127677917
Test Epoch0 layer9 Acc 0.9858285714285714, AUC 0.9960671067237854
gc 0
Train Epoch1 Acc 0.9951035714285714 (557258/560000), AUC 0.9988436698913574
Test Epoch1 layer0 Acc 0.9734714285714285, AUC 0.9982857704162598
Test Epoch1 layer1 Acc 0.9854142857142857, AUC 0.9978147149085999
Test Epoch1 layer2 Acc 0.9853285714285714, AUC 0.9975448846817017
Test Epoch1 layer3 Acc 0.9853285714285714, AUC 0.9967939257621765
Test Epoch1 layer4 Acc 0.9854, AUC 0.9966413378715515
Test Epoch1 layer5 Acc 0.9853285714285714, AUC 0.996562659740448
Test Epoch1 layer6 Acc 0.9853714285714286, AUC 0.9963874816894531
Test Epoch1 layer7 Acc 0.9852571428571428, AUC 0.996684193611145
Test Epoch1 layer8 Acc 0.9852857142857143, AUC 0.9964231252670288
Test Epoch1 layer9 Acc 0.9852285714285715, AUC 0.9960430860519409
gc 0
Train Epoch2 Acc 0.9955392857142857 (557502/560000), AUC 0.9989328980445862
Test Epoch2 layer0 Acc 0.9735, AUC 0.9982632398605347
Test Epoch2 layer1 Acc 0.9853571428571428, AUC 0.9976934790611267
Test Epoch2 layer2 Acc 0.9852714285714286, AUC 0.9973120093345642
Test Epoch2 layer3 Acc 0.9852857142857143, AUC 0.9965090155601501
Test Epoch2 layer4 Acc 0.9853, AUC 0.9967438578605652
Test Epoch2 layer5 Acc 0.9852857142857143, AUC 0.9964106678962708
Test Epoch2 layer6 Acc 0.9853142857142857, AUC 0.9961586594581604
Test Epoch2 layer7 Acc 0.9852571428571428, AUC 0.9966220259666443
Test Epoch2 layer8 Acc 0.9852428571428572, AUC 0.9960919618606567
Test Epoch2 layer9 Acc 0.9851571428571428, AUC 0.995890736579895
gc 0
Train Epoch3 Acc 0.9958321428571428 (557666/560000), AUC 0.998926043510437
Test Epoch3 layer0 Acc 0.9739714285714286, AUC 0.9982460737228394
Test Epoch3 layer1 Acc 0.9858571428571429, AUC 0.9978619813919067
Test Epoch3 layer2 Acc 0.9859714285714286, AUC 0.9976096153259277
Test Epoch3 layer3 Acc 0.9859285714285714, AUC 0.9968971014022827
Test Epoch3 layer4 Acc 0.9859714285714286, AUC 0.9969295263290405
Test Epoch3 layer5 Acc 0.9858857142857143, AUC 0.9965664148330688
Test Epoch3 layer6 Acc 0.9858857142857143, AUC 0.9963019490242004
Test Epoch3 layer7 Acc 0.9858142857142858, AUC 0.9967835545539856
Test Epoch3 layer8 Acc 0.9857571428571429, AUC 0.9959163665771484
Test Epoch3 layer9 Acc 0.9857571428571429, AUC 0.9960443377494812
gc 0
Train Epoch4 Acc 0.9961089285714285 (557821/560000), AUC 0.9989693760871887
Test Epoch4 layer0 Acc 0.9737428571428571, AUC 0.9983010292053223
Save ckpt to ./ckpt/mask10//dbpedia_14/dbpedia_14_lstmal_l10_m10_prefix.pt  ,ep 4
Test Epoch4 layer1 Acc 0.9854857142857143, AUC 0.9976575970649719
Test Epoch4 layer2 Acc 0.9855, AUC 0.9972106218338013
Test Epoch4 layer3 Acc 0.9856142857142857, AUC 0.9963221549987793
Test Epoch4 layer4 Acc 0.9856428571428572, AUC 0.9964185953140259
Test Epoch4 layer5 Acc 0.9856571428571429, AUC 0.9961004257202148
Test Epoch4 layer6 Acc 0.9855428571428572, AUC 0.9960322380065918
Test Epoch4 layer7 Acc 0.9855142857142857, AUC 0.9965471625328064
Test Epoch4 layer8 Acc 0.9854857142857143, AUC 0.9959079623222351
Test Epoch4 layer9 Acc 0.9854571428571428, AUC 0.9956437349319458
gc 0
Train Epoch5 Acc 0.9965821428571429 (558086/560000), AUC 0.9989728927612305
Test Epoch5 layer0 Acc 0.9737571428571429, AUC 0.9982947111129761
Test Epoch5 layer1 Acc 0.9856571428571429, AUC 0.9975983500480652
Test Epoch5 layer2 Acc 0.9856428571428572, AUC 0.9971137642860413
Test Epoch5 layer3 Acc 0.9855571428571429, AUC 0.9962976574897766
Test Epoch5 layer4 Acc 0.9855714285714285, AUC 0.9961723685264587
Test Epoch5 layer5 Acc 0.9855714285714285, AUC 0.9960322380065918
Test Epoch5 layer6 Acc 0.9855428571428572, AUC 0.9958521127700806
Test Epoch5 layer7 Acc 0.9855, AUC 0.9963235855102539
Test Epoch5 layer8 Acc 0.9855571428571429, AUC 0.9956746697425842
Test Epoch5 layer9 Acc 0.9855285714285714, AUC 0.9957598447799683
gc 0
Train Epoch6 Acc 0.9968 (558208/560000), AUC 0.9990341067314148
Test Epoch6 layer0 Acc 0.9738571428571429, AUC 0.9982885122299194
Test Epoch6 layer1 Acc 0.9856571428571429, AUC 0.9974455833435059
Test Epoch6 layer2 Acc 0.9856142857142857, AUC 0.9971856474876404
Test Epoch6 layer3 Acc 0.9855857142857143, AUC 0.9963008761405945
Test Epoch6 layer4 Acc 0.9855571428571429, AUC 0.9963284730911255
Test Epoch6 layer5 Acc 0.9855142857142857, AUC 0.9960748553276062
Test Epoch6 layer6 Acc 0.9855428571428572, AUC 0.9958027601242065
Test Epoch6 layer7 Acc 0.9855428571428572, AUC 0.9962620735168457
Test Epoch6 layer8 Acc 0.9855571428571429, AUC 0.9959386587142944
Test Epoch6 layer9 Acc 0.9855571428571429, AUC 0.9955880045890808
gc 0
Train Epoch7 Acc 0.9969571428571429 (558296/560000), AUC 0.9990749955177307
Test Epoch7 layer0 Acc 0.9738142857142857, AUC 0.9982840418815613
Test Epoch7 layer1 Acc 0.9852285714285715, AUC 0.9972953796386719
Test Epoch7 layer2 Acc 0.9850857142857142, AUC 0.9968900680541992
Test Epoch7 layer3 Acc 0.9851285714285715, AUC 0.9958975911140442
Test Epoch7 layer4 Acc 0.9850857142857142, AUC 0.9958887696266174
Test Epoch7 layer5 Acc 0.9850571428571429, AUC 0.9955800771713257
Test Epoch7 layer6 Acc 0.9850714285714286, AUC 0.9952316880226135
Test Epoch7 layer7 Acc 0.9850571428571429, AUC 0.9957587122917175
Test Epoch7 layer8 Acc 0.9850714285714286, AUC 0.9953014254570007
Test Epoch7 layer9 Acc 0.9850428571428571, AUC 0.9954437613487244
gc 0
Train Epoch8 Acc 0.9971214285714286 (558388/560000), AUC 0.9991220235824585
Test Epoch8 layer0 Acc 0.9734428571428572, AUC 0.998292088508606
Test Epoch8 layer1 Acc 0.9849857142857142, AUC 0.9973090291023254
Test Epoch8 layer2 Acc 0.9851142857142857, AUC 0.9970000386238098
Test Epoch8 layer3 Acc 0.9851142857142857, AUC 0.9960160851478577
Test Epoch8 layer4 Acc 0.9851285714285715, AUC 0.995849609375
Test Epoch8 layer5 Acc 0.9851571428571428, AUC 0.9957148432731628
Test Epoch8 layer6 Acc 0.9851428571428571, AUC 0.9954151511192322
Test Epoch8 layer7 Acc 0.9851571428571428, AUC 0.995887279510498
Test Epoch8 layer8 Acc 0.9851285714285715, AUC 0.9954598546028137
Test Epoch8 layer9 Acc 0.9851285714285715, AUC 0.9951667785644531
gc 0
Train Epoch9 Acc 0.9972803571428571 (558477/560000), AUC 0.9991099238395691
Test Epoch9 layer0 Acc 0.9734714285714285, AUC 0.9982937574386597
Test Epoch9 layer1 Acc 0.9852, AUC 0.9972348213195801
Test Epoch9 layer2 Acc 0.9850714285714286, AUC 0.9969756007194519
Test Epoch9 layer3 Acc 0.9850142857142857, AUC 0.9960182905197144
Test Epoch9 layer4 Acc 0.9849428571428571, AUC 0.9959760904312134
Test Epoch9 layer5 Acc 0.9849857142857142, AUC 0.9956780672073364
Test Epoch9 layer6 Acc 0.985, AUC 0.9953576326370239
Test Epoch9 layer7 Acc 0.9849857142857142, AUC 0.9958877563476562
Test Epoch9 layer8 Acc 0.9849428571428571, AUC 0.9954826235771179
Test Epoch9 layer9 Acc 0.9850142857142857, AUC 0.995543360710144
Best AUC 0.9983010292053223
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask10//dbpedia_14/dbpedia_14_lstmal_l10_m10_prefix.pt
[[4680   44   23   15   11   71   43   10    4    7    5   19   19   49]
 [  32 4904    3    1    6    1   28    6    4    2    0    0    5    8]
 [  35   15 4609   19   51    1   11    4    6    0    1   76   21  151]
 [   2    2   26 4955   11    0    1    0    0    0    0    0    0    3]
 [   7   22   85   12 4839    8    6    2    2    1    0    0    3   13]
 [  31    2    3    4    1 4947    5    2    1    1    0    0    1    2]
 [  58   49    4    2   10   16 4800   39    9    5    1    1    3    3]
 [   0    1    0    0    2    0   12 4965   15    3    1    0    0    1]
 [   1    4    2    0    3    0   11   14 4965    0    0    0    0    0]
 [   1    0    1    3    1    0    0    6    0 4954   33    0    0    1]
 [  12    1    0    0    0    0    2    5    0   32 4948    0    0    0]
 [   6    0   40    2    0    0    1    0    0    1    1 4921   15   13]
 [  10    2   25    7    1    3    1    3    0    2    0   19 4876   51]
 [  27    7   75    7   12    3    5    9    1    5    3    5   42 4799]]
Figure(640x480)
[[4811   35   10    4   10   28   53    3    0    2    1    7    2   34]
 [  41 4919    0    0    8    1   24    0    1    1    0    0    0    5]
 [  16    4 4858   10   66    1    4    1    0    1    0   14    4   21]
 [   2    1   11 4971   11    1    1    0    0    0    0    0    2    0]
 [   5    6   64    9 4901    4    3    1    0    2    1    0    1    3]
 [  34    0    0    0    0 4954    5    2    1    1    0    1    0    2]
 [  57   31    1    0    1   15 4854   27    4    2    0    0    3    5]
 [   2    0    0    0    0    2   16 4970    7    2    0    0    0    1]
 [   1    1    1    0    1    0    8    8 4980    0    0    0    0    0]
 [   2    0    0    0    0    0    1    2    0 4976   19    0    0    0]
 [  14    1    0    0    0    0    1    1    0   23 4960    0    0    0]
 [   2    0    6    1    0    0    1    0    0    0    0 4975    9    6]
 [   4    0    3    0    1    2    0    0    0    0    0   23 4931   36]
 [  19    4   17    1    3    3    3    0    0    0    1   11   14 4924]]
Figure(640x480)
[[4812   36    9    4    9   27   53    3    0    1    2    8    2   34]
 [  41 4918    1    0    7    1   24    0    1    1    0    0    1    5]
 [  17    5 4851   10   69    1    4    1    0    1    0   17    4   20]
 [   2    1   11 4971   11    1    0    1    0    0    0    0    2    0]
 [   6    6   61    9 4905    4    3    0    0    1    0    0    2    3]
 [  34    0    0    0    0 4955    4    2    1    1    0    1    0    2]
 [  58   34    1    0    1   15 4851   25    6    2    0    0    2    5]
 [   2    0    0    0    0    0   14 4973    8    2    0    0    0    1]
 [   1    0    1    0    1    0    6   10 4981    0    0    0    0    0]
 [   2    0    0    0    0    0    1    2    0 4976   19    0    0    0]
 [  16    1    0    0    0    0    1    0    0   20 4962    0    0    0]
 [   2    0    6    0    0    1    1    0    0    0    0 4975    9    6]
 [   4    0    3    0    1    2    0    0    0    0    0   24 4931   35]
 [  17    3   18    1    2    4    3    0    0    0    1   13   14 4924]]
Figure(640x480)
[[4813   35    9    4    9   26   53    3    0    1    2    8    2   35]
 [  41 4920    1    0    6    1   23    0    1    1    0    0    1    5]
 [  16    5 4848   10   71    1    3    1    0    1    0   18    4   22]
 [   2    2   10 4972   11    1    0    0    0    0    0    0    2    0]
 [   6    6   58   10 4908    4    3    0    0    1    0    0    1    3]
 [  33    0    0    0    0 4956    4    2    1    1    0    1    0    2]
 [  56   34    1    0    1   15 4853   25    6    2    0    0    2    5]
 [   2    0    0    0    0    0   14 4973    8    2    0    0    0    1]
 [   2    0    1    0    1    0    6    9 4981    0    0    0    0    0]
 [   2    1    0    0    0    0    0    2    0 4976   19    0    0    0]
 [  15    1    0    0    1    0    1    0    0   21 4961    0    0    0]
 [   2    0    5    0    0    1    1    0    0    0    0 4975    9    7]
 [   4    0    3    0    1    1    0    0    0    0    0   23 4931   37]
 [  17    3   17    1    2    3    3    0    0    0    1   13   14 4926]]
Figure(640x480)
[[4813   35    9    4    9   26   53    3    0    1    2    8    2   35]
 [  40 4921    1    0    6    1   23    0    1    1    0    0    1    5]
 [  18    5 4846   10   71    1    3    1    0    1    0   18    4   22]
 [   2    2   10 4972   11    1    0    0    0    0    0    0    2    0]
 [   6    6   58   10 4908    4    3    0    0    1    0    0    1    3]
 [  33    0    0    0    0 4956    4    2    1    1    0    1    0    2]
 [  55   34    1    0    1   15 4854   25    6    2    0    0    2    5]
 [   2    0    0    0    0    0   14 4973    8    2    0    0    0    1]
 [   1    0    1    0    1    0    6   10 4981    0    0    0    0    0]
 [   2    1    0    0    0    0    0    2    0 4976   19    0    0    0]
 [  15    1    0    0    0    0    1    1    0   20 4962    0    0    0]
 [   2    0    5    0    0    1    1    0    0    0    0 4975    9    7]
 [   4    0    3    0    1    1    0    0    0    0    0   23 4932   36]
 [  17    3   17    1    2    3    3    0    0    0    1   13   14 4926]]
Figure(640x480)
[[4814   35    9    4    9   25   53    3    0    1    2    8    2   35]
 [  40 4921    1    0    6    1   23    0    1    1    0    0    1    5]
 [  18    5 4845   10   72    1    3    1    0    1    0   18    4   22]
 [   2    2   10 4972   11    1    0    0    0    0    0    0    2    0]
 [   6    6   55   10 4911    4    3    0    0    1    0    0    1    3]
 [  33    0    0    0    0 4955    5    2    1    1    0    1    0    2]
 [  55   35    1    0    1   15 4853   25    6    2    0    0    2    5]
 [   2    0    0    0    0    0   14 4973    8    2    0    0    0    1]
 [   2    0    1    0    1    0    6    9 4981    0    0    0    0    0]
 [   1    1    0    0    0    0    0    2    0 4977   19    0    0    0]
 [  15    1    0    0    1    0    1    0    0   21 4961    0    0    0]
 [   2    0    5    0    0    1    1    0    0    0    0 4975    9    7]
 [   4    0    3    0    1    1    0    0    0    0    0   23 4932   36]
 [  17    4   17    0    2    3    3    0    0    0    1   13   14 4926]]
Figure(640x480)
[[4814   35    9    4    9   25   53    3    0    1    2    8    2   35]
 [  40 4921    1    0    6    1   23    0    1    1    0    0    1    5]
 [  17    5 4845   10   72    1    3    1    0    1    0   17    4   24]
 [   2    2   10 4972   11    1    0    0    0    0    0    0    2    0]
 [   7    6   58   10 4906    4    3    0    0    1    0    0    2    3]
 [  33    0    0    0    0 4955    5    2    1    1    0    1    0    2]
 [  55   35    1    0    1   15 4852   25    6    2    0    0    3    5]
 [   2    0    0    0    0    0   14 4973    8    2    0    0    0    1]
 [   1    0    1    0    1    0    6   10 4980    0    0    0    0    1]
 [   1    1    0    0    0    0    0    2    0 4977   19    0    0    0]
 [  15    1    0    0    0    0    1    1    0   21 4961    0    0    0]
 [   2    0    5    0    0    1    1    0    0    0    0 4975    9    7]
 [   4    0    3    0    1    1    0    0    0    0    0   23 4931   37]
 [  18    4   17    0    2    2    3    0    0    0    1   13   14 4926]]
Figure(640x480)
[[4814   35    9    4    9   25   53    3    0    1    2    8    2   35]
 [  42 4920    1    0    6    1   22    0    1    1    0    0    1    5]
 [  20    5 4845   10   71    1    3    1    0    1    0   16    4   23]
 [   2    1   10 4972   11    1    0    1    0    0    0    0    2    0]
 [   9    6   57   10 4906    4    2    1    0    0    0    0    2    3]
 [  33    0    0    0    0 4955    5    2    1    1    0    1    0    2]
 [  56   35    1    0    1   15 4851   25    6    2    0    0    3    5]
 [   2    0    0    0    0    0   14 4973    8    2    0    0    0    1]
 [   2    0    1    0    1    0    6    9 4980    0    0    0    0    1]
 [   2    1    0    0    0    0    0    2    0 4976   19    0    0    0]
 [  15    1    0    0    0    0    1    1    0   21 4961    0    0    0]
 [   2    0    5    0    0    1    1    0    0    0    0 4975    9    7]
 [   4    0    3    0    1    1    0    0    0    0    0   23 4931   37]
 [  18    4   17    0    2    2    3    0    0    0    1   12   14 4927]]
Figure(640x480)
[[4814   35    9    4    9   25   53    3    0    1    2    8    2   35]
 [  42 4920    1    0    6    1   22    0    1    1    0    0    1    5]
 [  18    5 4845   10   72    1    3    1    0    1    0   16    4   24]
 [   2    1   10 4972   11    1    0    1    0    0    0    0    2    0]
 [   9    6   56   10 4907    4    2    1    0    0    0    0    2    3]
 [  34    0    0    0    0 4955    4    2    1    1    0    1    0    2]
 [  56   35    1    0    1   15 4849   25    8    2    0    0    3    5]
 [   2    0    0    0    0    0   14 4973    8    2    0    0    0    1]
 [   2    0    1    0    1    0    6    9 4980    0    0    0    0    1]
 [   1    1    0    0    0    0    0    2    0 4977   19    0    0    0]
 [  15    1    0    0    1    0    1    0    0   22 4960    0    0    0]
 [   2    0    5    0    0    1    1    0    0    0    0 4975    9    7]
 [   4    0    3    0    1    1    0    0    0    0    0   23 4931   37]
 [  18    4   17    0    2    3    3    0    0    0    1   12   14 4926]]
Figure(640x480)
[[4814   36    9    4    9   25   53    3    0    1    2    8    2   34]
 [  42 4920    1    0    6    1   22    0    1    1    0    0    1    5]
 [  17    5 4845   10   72    1    3    1    0    1    0   16    4   25]
 [   2    1   11 4971   11    1    0    1    0    0    0    0    2    0]
 [   9    6   57   10 4906    4    2    1    0    0    0    0    2    3]
 [  35    0    0    0    0 4954    4    2    1    1    0    1    0    2]
 [  58   34    1    0    1   15 4849   25    7    2    0    0    3    5]
 [   2    0    0    0    0    0   14 4973    8    2    0    0    0    1]
 [   2    0    1    0    1    0    6    9 4980    0    0    0    0    1]
 [   1    1    0    0    0    0    0    2    0 4977   19    0    0    0]
 [  15    1    0    0    1    0    1    0    0   22 4960    0    0    0]
 [   2    0    5    0    0    1    1    0    0    0    0 4975    9    7]
 [   4    0    3    0    1    1    0    0    0    0    0   23 4931   37]
 [  18    4   17    0    2    3    3    0    0    0    1   11   14 4927]]
Figure(640x480)
