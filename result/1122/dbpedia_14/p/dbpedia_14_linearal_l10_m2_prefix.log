total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask1//dbpedia_14/dbpedia_14_linearal_l10_m1_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.09871785714285715 (55282/560000), AUC 0.41639068722724915
Test Epoch0 layer0 Acc 0.9738714285714286, AUC 0.9983457326889038
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l10_m2_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9738571428571429, AUC 0.9983677268028259
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l10_m2_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.026214285714285714, AUC 0.45347878336906433
Test Epoch0 layer3 Acc 0.05404285714285714, AUC 0.48387986421585083
Test Epoch0 layer4 Acc 0.0696, AUC 0.5130593180656433
Test Epoch0 layer5 Acc 0.1365, AUC 0.5245435833930969
Test Epoch0 layer6 Acc 0.08101428571428572, AUC 0.5728173851966858
Test Epoch0 layer7 Acc 0.036442857142857145, AUC 0.5100021362304688
Test Epoch0 layer8 Acc 0.0967, AUC 0.5359551310539246
Test Epoch0 layer9 Acc 0.08544285714285714, AUC 0.42277994751930237
gc 0
Train Epoch1 Acc 0.07555 (42308/560000), AUC 0.4284522831439972
Test Epoch1 layer0 Acc 0.9741285714285715, AUC 0.9983240365982056
Test Epoch1 layer1 Acc 0.9744, AUC 0.9984766840934753
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l10_m2_prefix.pt  ,ep 1
Test Epoch1 layer2 Acc 0.022885714285714287, AUC 0.4571821987628937
Test Epoch1 layer3 Acc 0.06722857142857143, AUC 0.4692557454109192
Test Epoch1 layer4 Acc 0.05672857142857143, AUC 0.5037387609481812
Test Epoch1 layer5 Acc 0.11788571428571429, AUC 0.5201369524002075
Test Epoch1 layer6 Acc 0.1466, AUC 0.5808872580528259
Test Epoch1 layer7 Acc 0.03414285714285714, AUC 0.5066142082214355
Test Epoch1 layer8 Acc 0.10845714285714286, AUC 0.518947422504425
Test Epoch1 layer9 Acc 0.06974285714285715, AUC 0.4358535408973694
gc 0
Train Epoch2 Acc 0.06870714285714286 (38476/560000), AUC 0.4305076599121094
Test Epoch2 layer0 Acc 0.9738142857142857, AUC 0.9982998967170715
Test Epoch2 layer1 Acc 0.9741714285714286, AUC 0.9985204935073853
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l10_m2_prefix.pt  ,ep 2
Test Epoch2 layer2 Acc 0.01927142857142857, AUC 0.4598575532436371
Test Epoch2 layer3 Acc 0.0744, AUC 0.461418479681015
Test Epoch2 layer4 Acc 0.06052857142857143, AUC 0.5046530365943909
Test Epoch2 layer5 Acc 0.11187142857142857, AUC 0.5179206728935242
Test Epoch2 layer6 Acc 0.16995714285714286, AUC 0.5833635330200195
Test Epoch2 layer7 Acc 0.030714285714285715, AUC 0.49982771277427673
Test Epoch2 layer8 Acc 0.12515714285714286, AUC 0.5235627293586731
Test Epoch2 layer9 Acc 0.06678571428571428, AUC 0.4275423586368561
gc 0
Train Epoch3 Acc 0.06656428571428571 (37276/560000), AUC 0.4176139831542969
Test Epoch3 layer0 Acc 0.9736571428571429, AUC 0.998332679271698
Test Epoch3 layer1 Acc 0.9743571428571428, AUC 0.998565673828125
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l10_m2_prefix.pt  ,ep 3
Test Epoch3 layer2 Acc 0.013114285714285714, AUC 0.4668620526790619
Test Epoch3 layer3 Acc 0.08551428571428571, AUC 0.4551255404949188
Test Epoch3 layer4 Acc 0.06194285714285714, AUC 0.5076984167098999
Test Epoch3 layer5 Acc 0.10335714285714286, AUC 0.5131373405456543
Test Epoch3 layer6 Acc 0.19585714285714287, AUC 0.5782173275947571
Test Epoch3 layer7 Acc 0.027814285714285715, AUC 0.48830917477607727
Test Epoch3 layer8 Acc 0.1281, AUC 0.5255765318870544
Test Epoch3 layer9 Acc 0.06555714285714286, AUC 0.41185498237609863
gc 0
Train Epoch4 Acc 0.06631428571428571 (37136/560000), AUC 0.40442007780075073
Test Epoch4 layer0 Acc 0.9738428571428571, AUC 0.9983288645744324
Test Epoch4 layer1 Acc 0.9752428571428572, AUC 0.998606264591217
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l10_m2_prefix.pt  ,ep 4
Test Epoch4 layer2 Acc 0.009714285714285713, AUC 0.46587640047073364
Test Epoch4 layer3 Acc 0.09015714285714285, AUC 0.4447230398654938
Test Epoch4 layer4 Acc 0.07375714285714285, AUC 0.5126497149467468
Test Epoch4 layer5 Acc 0.09987142857142857, AUC 0.5030367970466614
Test Epoch4 layer6 Acc 0.21825714285714284, AUC 0.5679352879524231
Test Epoch4 layer7 Acc 0.036071428571428574, AUC 0.4721073806285858
Test Epoch4 layer8 Acc 0.1273142857142857, AUC 0.5208712220191956
Test Epoch4 layer9 Acc 0.06615714285714286, AUC 0.4016987681388855
gc 0
Train Epoch5 Acc 0.06857321428571428 (38401/560000), AUC 0.4007277190685272
Test Epoch5 layer0 Acc 0.9740142857142857, AUC 0.9983230233192444
Test Epoch5 layer1 Acc 0.9755571428571429, AUC 0.9985561966896057
Test Epoch5 layer2 Acc 0.008757142857142857, AUC 0.46110567450523376
Test Epoch5 layer3 Acc 0.08827142857142857, AUC 0.4345112144947052
Test Epoch5 layer4 Acc 0.07135714285714286, AUC 0.5146552324295044
Test Epoch5 layer5 Acc 0.09815714285714286, AUC 0.4952865242958069
Test Epoch5 layer6 Acc 0.2219142857142857, AUC 0.5587190389633179
Test Epoch5 layer7 Acc 0.03665714285714286, AUC 0.4563611149787903
Test Epoch5 layer8 Acc 0.12644285714285713, AUC 0.5140333771705627
Test Epoch5 layer9 Acc 0.07101428571428571, AUC 0.4037863314151764
gc 0
Train Epoch6 Acc 0.07099642857142857 (39758/560000), AUC 0.40326520800590515
Test Epoch6 layer0 Acc 0.9737714285714286, AUC 0.9983290433883667
Test Epoch6 layer1 Acc 0.9755714285714285, AUC 0.9985576868057251
Test Epoch6 layer2 Acc 0.008871428571428572, AUC 0.4570804536342621
Test Epoch6 layer3 Acc 0.07971428571428571, AUC 0.430544376373291
Test Epoch6 layer4 Acc 0.06862857142857143, AUC 0.5157312154769897
Test Epoch6 layer5 Acc 0.09855714285714286, AUC 0.49335360527038574
Test Epoch6 layer6 Acc 0.21855714285714287, AUC 0.5525943040847778
Test Epoch6 layer7 Acc 0.03252857142857143, AUC 0.4510217010974884
Test Epoch6 layer8 Acc 0.12517142857142857, AUC 0.5061537027359009
Test Epoch6 layer9 Acc 0.07105714285714286, AUC 0.40709343552589417
gc 0
Train Epoch7 Acc 0.07117857142857142 (39860/560000), AUC 0.40592876076698303
Test Epoch7 layer0 Acc 0.9739714285714286, AUC 0.9983301162719727
Test Epoch7 layer1 Acc 0.9760714285714286, AUC 0.9985246658325195
Test Epoch7 layer2 Acc 0.010257142857142857, AUC 0.45611336827278137
Test Epoch7 layer3 Acc 0.07444285714285714, AUC 0.43100887537002563
Test Epoch7 layer4 Acc 0.06311428571428572, AUC 0.5168145298957825
Test Epoch7 layer5 Acc 0.0923, AUC 0.4927377998828888
Test Epoch7 layer6 Acc 0.21592857142857144, AUC 0.5457107424736023
Test Epoch7 layer7 Acc 0.03002857142857143, AUC 0.453838050365448
Test Epoch7 layer8 Acc 0.12484285714285714, AUC 0.49908608198165894
Test Epoch7 layer9 Acc 0.07122857142857143, AUC 0.40847882628440857
gc 0
Train Epoch8 Acc 0.07127142857142857 (39912/560000), AUC 0.4071870446205139
Test Epoch8 layer0 Acc 0.9737142857142858, AUC 0.9983358383178711
Test Epoch8 layer1 Acc 0.9759285714285715, AUC 0.9985132813453674
Test Epoch8 layer2 Acc 0.011942857142857142, AUC 0.45540541410446167
Test Epoch8 layer3 Acc 0.07355714285714286, AUC 0.4353446960449219
Test Epoch8 layer4 Acc 0.04018571428571428, AUC 0.5145979523658752
Test Epoch8 layer5 Acc 0.08495714285714286, AUC 0.49402615427970886
Test Epoch8 layer6 Acc 0.21321428571428572, AUC 0.538525402545929
Test Epoch8 layer7 Acc 0.028157142857142856, AUC 0.4567505419254303
Test Epoch8 layer8 Acc 0.1237, AUC 0.49439653754234314
Test Epoch8 layer9 Acc 0.07114285714285715, AUC 0.40900200605392456
gc 0
Train Epoch9 Acc 0.07121785714285714 (39882/560000), AUC 0.4070342481136322
Test Epoch9 layer0 Acc 0.9739, AUC 0.9983341097831726
Test Epoch9 layer1 Acc 0.9765428571428572, AUC 0.9984922409057617
Test Epoch9 layer2 Acc 0.013085714285714286, AUC 0.45697468519210815
Test Epoch9 layer3 Acc 0.07311428571428571, AUC 0.43825826048851013
Test Epoch9 layer4 Acc 0.03362857142857143, AUC 0.5135514736175537
Test Epoch9 layer5 Acc 0.07774285714285714, AUC 0.49362730979919434
Test Epoch9 layer6 Acc 0.20985714285714285, AUC 0.5346897840499878
Test Epoch9 layer7 Acc 0.027214285714285715, AUC 0.4574591815471649
Test Epoch9 layer8 Acc 0.1234, AUC 0.49203357100486755
Test Epoch9 layer9 Acc 0.0711, AUC 0.40853339433670044
Best AUC 0.998606264591217
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l10_m2_prefix.pt
[[4710   38   22   14   12   63   40    7    3    6    4   22   16   43]
 [  39 4892    3    1    7    0   34    6    3    2    1    0    3    9]
 [  40   13 4593   19   58    2    9    3    4    0    1   84   18  156]
 [   3    1   28 4951   12    1    1    0    0    0    0    0    0    3]
 [   9   14   69   13 4864    7    5    0    2    0    0    1    2   14]
 [  40    1    3    4    1 4938    5    3    1    1    0    0    1    2]
 [  67   43    5    3   10   15 4796   40    9    5    1    1    2    3]
 [   0    1    0    0    2    0   12 4964   16    3    1    0    0    1]
 [   2    5    2    0    3    0   12   12 4964    0    0    0    0    0]
 [   1    0    0    2    1    0    0    7    0 4951   36    1    0    1]
 [  12    1    0    0    0    0    2    4    0   32 4948    1    0    0]
 [   5    0   35    2    0    0    0    0    0    1    0 4934   13   10]
 [   9    2   25    8    2    2    1    3    0    2    0   28 4864   54]
 [  34    3   71    8   12    3    3   10    1    5    4    7   39 4800]]
Figure(640x480)
[[4714   38   21   12   13   55   38    5    3    5    4   28   16   48]
 [  37 4907    2    2    8    0   29    1    1    1    0    0    4    8]
 [  36   14 4615   18   63    2   10    0    1    0    2   94   31  114]
 [   3    2   23 4957   12    0    1    0    0    0    0    0    0    2]
 [   8   16   67   12 4872    7    6    1    2    0    0    0    1    8]
 [  41    1    3    2    1 4941    5    2    1    0    0    0    1    2]
 [  62   47    5    3   10   14 4812   28    4    5    1    1    5    3]
 [   1    1    0    0    2    0   16 4964   10    3    1    0    1    1]
 [   2    4    2    0    6    0   14   15 4956    0    0    0    0    1]
 [   1    0    1    2    1    0    0    6    0 4955   33    0    0    1]
 [  13    1    0    0    0    0    2    3    0   32 4949    0    0    0]
 [   8    0   26    2    0    0    0    0    0    0    0 4939   16    9]
 [   9    2   18    4    0    3    0    2    0    1    0   20 4903   38]
 [  31    5   66    7   12    3    2    4    0    4    3    8   72 4783]]
Figure(640x480)
[[  90   15    0    0    1    3    0 4872    4    9    0    2    4    0]
 [4831    0    0    0   56   15    0   65   21   11    0    0    1    0]
 [2795  372    0    0    2    0    0 1816    0   14    0    0    1    0]
 [1189    1    0    0    0    0    0 3440  252   25    0    1   92    0]
 [3173    4    0    0    0    0    0 1457  354   11    0    0    1    0]
 [ 187  183  328  600    0    0    0 1245    0   12    0   31 2414    0]
 [  74    0    0    0    0    0    0 3899  960    6    0   42   19    0]
 [4066    0    0    0    0    0    0   40  202   33    0  655    4    0]
 [4927    0    0    0    0    0    0   14    2   35    0    3   19    0]
 [4536   61    0    2    0   47    0  151    0  189    0    1   13    0]
 [  79    1    0    0  230    0    0 3886   91  440    0  267    6    0]
 [4931    0    0    0    0    0    0   57    3    5    0    0    4    0]
 [  40    4    0    0 1035    2    0 3465   62   32    0    1  359    0]
 [  12    1    0    0    0    0    0 4680    2   10    0    0  295    0]]
Figure(640x480)
[[   1    0    0    0    0    0 1088  619    0 1358    2    0 1923    9]
 [   0    0    0    0    0    0   42 4935    1    2    3    0    6   11]
 [   1    0    0    0    0    0  891 4095    0    0    0    0    4    9]
 [  51    0    0    0    0    0   35 4902    0    2    0    0    0   10]
 [  23    0    0    0    0    0   89 4792    0   83    1    0    1   11]
 [   0    0    0    5    0    0  322 4663    0    3    0    0    2    5]
 [   5    0    0    0    0    0   50 2288   25  972 1635    0    5   20]
 [  33    0    0    0    0    0   10 4188  767    0    0    0    0    2]
 [  19    0    0    0    0   10 4055  884    1    0    2    0    1   28]
 [ 753  445    0    0    0    0   97 1472    0 2070    0    0    0  163]
 [   0    0    0    0    0    0 1978 3005    0    4    0    0    3   10]
 [   3    0    0  146    0    0  417 3253  689  491    0    0    0    1]
 [   0    0    0    0    0    0   43 4923    9    2    0    0    1   22]
 [   0    0    0    0    0    0 4009  989    0    1    0    0    1    0]]
Figure(640x480)
[[   1    0    1    0    0    0    0 1400    9    0 3589    0    0    0]
 [   0    0    0    0    0    0    0 3455    3    0 1542    0    0    0]
 [ 279 1625    1    0    5    0   18 2378  650    5   39    0    0    0]
 [   0    0    0    0  107    0    0 4858   21    0   14    0    0    0]
 [   3    5    0    0    0    0    0  901   25    0 4066    0    0    0]
 [   0    0    0    0    0    0    0 4993    0    0    7    0    0    0]
 [   0    0   28    0    0    0    0 4956    0    0   16    0    0    0]
 [   0    0    1    0   21    0  128 4849    0    0    1    0    0    0]
 [   0    1    0    0    0    0   13 4703  282    0    1    0    0    0]
 [   0    0    0    0    0    0    0 4771    3    0    6    0  220    0]
 [   0    0    3    0    0    0    0 4965    1    0   30    0    0    1]
 [   3   21    0    0    0    0    0 3595    1    0 1373    0    0    7]
 [   0    0    0    0    0    0    0 4999    0    0    1    0    0    0]
 [   0    1  285    0    0    0    0 4711    0    0    3    0    0    0]]
Figure(640x480)
[[   0    0   67    0  335   11    1  173    0 4264    0    0  149    0]
 [   7    0    2    1    2  205    1   51    0 4679    0    0    0   52]
 [   0    0 1152    0   23 2040  103   23    0 1659    0    0    0    0]
 [   0    0   53    0    0   15  162   26    0 4708    0    0    0   36]
 [   0    0  206    0    0   32    8   76    0 4676    0    0    0    2]
 [   0    0   18    0    1  620    0  129    0 4231    0    0    0    1]
 [   0    0   74    0    0   82    0  229    0 4614    0    0    1    0]
 [   0    0  661    0    0    0    0 2560    0 1779    0    0    0    0]
 [   0    0 3745    0    0    2    0 1212    0   41    0    0    0    0]
 [ 414    0   14    1    0 1757    0  123    1 2659    0    0    0   31]
 [   0    0 1682    0    0 2897    0   50    0  337    0    0    0   34]
 [   0    0 1249    0    0    3    0  198    0 3550    0    0    0    0]
 [   0    0 1356    0    1   17    0  146    0 3457    0    0    0   23]
 [   0    0   42    0  123   14  162   38    0 4618    0    0    3    0]]
Figure(640x480)
[[ 279    0   11 1050  262  802    0    0 1941    0    0    0    0  655]
 [   0    0    0  178    1 4557    0    0  211   47    0    0    0    6]
 [   1    0 1020   50   27 1951    0    0  792    0    0    0    0 1159]
 [   0    0    0 1633    5    4    0    0 2339    0    0    0    0 1019]
 [   0    0   25  390 3747   37    0    0  532    0    0   37    0  232]
 [   0    0    0  253    2 3591    0    0 1153    0    0    0    0    1]
 [   0    0    0 4247    2   91    0    0  648   10    0    0    2    0]
 [   0    0    0  660    2 1047    0    0 3291    0    0    0    0    0]
 [   0    0    0   27    0   35    0    0 4938    0    0    0    0    0]
 [   0    1    0   32   15   75    0    0 4799    0    0    0    0   78]
 [   0    0    0  825    0  992    0    0 2589    0    0    0    0  594]
 [   0    0    0  956  817  817    0    0 2408    0    0    0    0    2]
 [   0    0    0 2237    1 1742    0    0 1018    0    0    0    0    2]
 [   0    0    0  971  118   35    0    0 3806    0    0    0    0   70]]
Figure(640x480)
[[ 335    0    8    0 3944    9    0   10  323    0  343    1   27    0]
 [4658    0    9    0   11    1    0   12   23    0   27    0  259    0]
 [ 516    0    0    0 4198   99    0   43   12    0   23    0  109    0]
 [  43    0  504    0  352   13    0 3728   13    1   35    0  311    0]
 [ 809    0    3    0  954    4    0  309 1269 1320   92    0  240    0]
 [ 314    0 3399    0  507  445    0   13  254    0   59    0    9    0]
 [ 430    0  247    0   12   37    0   29 4219    0   19    0    7    0]
 [  13    0   38    0    1   10   44   74 4738    0   17    0   65    0]
 [4661    0   24    0   96    6    0    3  150    0    0    0   60    0]
 [  48    0    0    0    8    1    0 4814    2    0    0    0  127    0]
 [3473    0    0    0   12    0    0  169  132    0    0    0 1214    0]
 [ 548    0  239    0   57 3002    0 1139    5    0    3    0    7    0]
 [3583    0  334    0    4  387    0   65   30    0   30    0  567    0]
 [3279    0    1    0  117 1579    0    0   22    0    0    0    2    0]]
Figure(640x480)
[[  97    0    0  808    0    0    0 4013    0    1    0   58   23    0]
 [  10    0    0  334    0    0    0 4640    7    0    0    0    9    0]
 [ 167    0    0  374    0    0    0 4455    2    2    0    0    0    0]
 [  14    0    0  784    0    0    0 4193    0    9    0    0    0    0]
 [  38    0    0   54    0    0    0 4900    8    0    0    0    0    0]
 [ 581    0    0 1585    0    0    0 2834    0    0    0    0    0    0]
 [ 481    0    0   62    0    4    0 4444    1    1    0    0    7    0]
 [  72    0    0 1050    0    0    0 3478    0    0    0    0  400    0]
 [3685    0    0  934    0    0    0  315    0   31    0    0   35    0]
 [ 133    0    0  264    0    0    0  159    5 4439    0    0    0    0]
 [1265    0    0 1112    0    0    0 2510  106    7    0    0    0    0]
 [3347    0    0  313    0    0    0 1338    0    2    0    0    0    0]
 [ 146    0    0   53    0    0    0 4609    5   73    0    0  114    0]
 [4625    0    0  149    0    0    0  226    0    0    0    0    0    0]]
Figure(640x480)
[[   7    0    0    0  122    0    0 4687   41    0    0   99   24   20]
 [   4    0    0    1    1    0    0 4994    0    0    0    0    0    0]
 [   7    0    0    0    0    0    0 4989    0    0    0    0    3    1]
 [   4    0    0    0    0    0    0 4996    0    0    0    0    0    0]
 [   6    0    0    0    0    0    0 4990    0    0    0    0    4    0]
 [   0    0    0    0    0    0    0 4999    0    0    0    0    1    0]
 [   5    0    0    9  134    0    0 4850    2    0    0    0    0    0]
 [   0    0    0    0    6    0    0 4624  352    0    0    0   18    0]
 [   4    0    9    0    0    0    0 4959    0    0    0    0    4   24]
 [   5    0    0    0    0    0    0 4918   19    0    0    0   58    0]
 [   1    0    0    0    0    0    0 4990    0    0    0    0    9    0]
 [   0    0    0    0    0    0    0 4998    0    0    0    0    2    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]]
Figure(640x480)
