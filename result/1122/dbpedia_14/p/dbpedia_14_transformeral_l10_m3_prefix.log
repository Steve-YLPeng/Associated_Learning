total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask2//dbpedia_14/dbpedia_14_transformeral_l10_m2_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.040785714285714286 (22840/560000), AUC 0.48667019605636597
Test Epoch0 layer0 Acc 0.9739, AUC 0.9983052015304565
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_transformeral_l10_m3_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.977, AUC 0.9979737997055054
Test Epoch0 layer2 Acc 0.9766285714285714, AUC 0.9978855848312378
Test Epoch0 layer3 Acc 0.07235714285714286, AUC 0.4676392674446106
Test Epoch0 layer4 Acc 0.07142857142857142, AUC 0.48557692766189575
Test Epoch0 layer5 Acc 0.09652857142857142, AUC 0.40611544251441956
Test Epoch0 layer6 Acc 0.13314285714285715, AUC 0.46132323145866394
Test Epoch0 layer7 Acc 0.07142857142857142, AUC 0.40349242091178894
Test Epoch0 layer8 Acc 0.07142857142857142, AUC 0.5037350654602051
Test Epoch0 layer9 Acc 0.04051428571428571, AUC 0.45865535736083984
gc 0
Train Epoch1 Acc 0.1392732142857143 (77993/560000), AUC 0.46749892830848694
Test Epoch1 layer0 Acc 0.9737142857142858, AUC 0.9982877969741821
Test Epoch1 layer1 Acc 0.9790285714285715, AUC 0.9978252649307251
Test Epoch1 layer2 Acc 0.9791285714285715, AUC 0.9977151155471802
Test Epoch1 layer3 Acc 0.0723, AUC 0.5074769854545593
Test Epoch1 layer4 Acc 0.0010857142857142858, AUC 0.4256044328212738
Test Epoch1 layer5 Acc 0.0021142857142857144, AUC 0.4385886490345001
Test Epoch1 layer6 Acc 0.0014285714285714286, AUC 0.5048922300338745
Test Epoch1 layer7 Acc 0.0038714285714285712, AUC 0.3268451392650604
Test Epoch1 layer8 Acc 0.05228571428571428, AUC 0.48592567443847656
Test Epoch1 layer9 Acc 0.2728, AUC 0.48233041167259216
gc 0
Train Epoch2 Acc 0.15775357142857144 (88342/560000), AUC 0.5255243182182312
Test Epoch2 layer0 Acc 0.9737714285714286, AUC 0.9982745051383972
Test Epoch2 layer1 Acc 0.9793571428571428, AUC 0.9978572726249695
Test Epoch2 layer2 Acc 0.9793428571428572, AUC 0.9975710511207581
Test Epoch2 layer3 Acc 0.007142857142857143, AUC 0.45275527238845825
Test Epoch2 layer4 Acc 0.0673, AUC 0.47199612855911255
Test Epoch2 layer5 Acc 0.0023, AUC 0.4589960277080536
Test Epoch2 layer6 Acc 0.010414285714285714, AUC 0.538790225982666
Test Epoch2 layer7 Acc 0.0713, AUC 0.39143338799476624
Test Epoch2 layer8 Acc 0.1423, AUC 0.48243361711502075
Test Epoch2 layer9 Acc 0.13818571428571427, AUC 0.5548442006111145
gc 0
Train Epoch3 Acc 0.1076 (60256/560000), AUC 0.5503872036933899
Test Epoch3 layer0 Acc 0.9735, AUC 0.9982796907424927
Test Epoch3 layer1 Acc 0.9792285714285714, AUC 0.9977448582649231
Test Epoch3 layer2 Acc 0.9793571428571428, AUC 0.9971565008163452
Test Epoch3 layer3 Acc 0.0017142857142857142, AUC 0.4364783465862274
Test Epoch3 layer4 Acc 0.06197142857142857, AUC 0.4786547124385834
Test Epoch3 layer5 Acc 0.002242857142857143, AUC 0.4628899097442627
Test Epoch3 layer6 Acc 0.03868571428571429, AUC 0.545997142791748
Test Epoch3 layer7 Acc 0.07087142857142857, AUC 0.4012048840522766
Test Epoch3 layer8 Acc 0.14237142857142857, AUC 0.4561251103878021
Test Epoch3 layer9 Acc 0.07532857142857143, AUC 0.5675600171089172
gc 0
Train Epoch4 Acc 0.07684821428571428 (43035/560000), AUC 0.547305703163147
Test Epoch4 layer0 Acc 0.9735428571428572, AUC 0.9982738494873047
Test Epoch4 layer1 Acc 0.9791285714285715, AUC 0.9975231885910034
Test Epoch4 layer2 Acc 0.9793857142857143, AUC 0.9970276951789856
Test Epoch4 layer3 Acc 0.0026857142857142856, AUC 0.42860737442970276
Test Epoch4 layer4 Acc 0.07088571428571429, AUC 0.4662705957889557
Test Epoch4 layer5 Acc 0.0042, AUC 0.49837663769721985
Test Epoch4 layer6 Acc 0.07445714285714286, AUC 0.5445343852043152
Test Epoch4 layer7 Acc 0.07118571428571428, AUC 0.39257192611694336
Test Epoch4 layer8 Acc 0.1422, AUC 0.4410993158817291
Test Epoch4 layer9 Acc 0.0715, AUC 0.5554591417312622
gc 0
Train Epoch5 Acc 0.07208214285714286 (40366/560000), AUC 0.5385720729827881
Test Epoch5 layer0 Acc 0.9736571428571429, AUC 0.998283326625824
Test Epoch5 layer1 Acc 0.9792428571428572, AUC 0.9975300431251526
Test Epoch5 layer2 Acc 0.9794285714285714, AUC 0.9969503283500671
Test Epoch5 layer3 Acc 0.002357142857142857, AUC 0.42028144001960754
Test Epoch5 layer4 Acc 0.07058571428571428, AUC 0.4589497148990631
Test Epoch5 layer5 Acc 0.051242857142857146, AUC 0.5046446919441223
Test Epoch5 layer6 Acc 0.0742, AUC 0.5351614356040955
Test Epoch5 layer7 Acc 0.07084285714285714, AUC 0.3959621489048004
Test Epoch5 layer8 Acc 0.14218571428571428, AUC 0.4414505660533905
Test Epoch5 layer9 Acc 0.07147142857142857, AUC 0.5514318346977234
gc 0
Train Epoch6 Acc 0.07185357142857143 (40238/560000), AUC 0.5373414754867554
Test Epoch6 layer0 Acc 0.9737714285714286, AUC 0.9982748627662659
Test Epoch6 layer1 Acc 0.9794571428571428, AUC 0.9976333975791931
Test Epoch6 layer2 Acc 0.9796142857142857, AUC 0.9967218637466431
Test Epoch6 layer3 Acc 0.002442857142857143, AUC 0.4168386459350586
Test Epoch6 layer4 Acc 0.06847142857142857, AUC 0.4564998745918274
Test Epoch6 layer5 Acc 0.008785714285714286, AUC 0.5047398209571838
Test Epoch6 layer6 Acc 0.07304285714285715, AUC 0.538582980632782
Test Epoch6 layer7 Acc 0.07111428571428571, AUC 0.40055587887763977
Test Epoch6 layer8 Acc 0.14222857142857143, AUC 0.43903374671936035
Test Epoch6 layer9 Acc 0.07147142857142857, AUC 0.5479949712753296
gc 0
Train Epoch7 Acc 0.07177678571428571 (40195/560000), AUC 0.5359161496162415
Test Epoch7 layer0 Acc 0.9737285714285714, AUC 0.9982696175575256
Test Epoch7 layer1 Acc 0.9790857142857143, AUC 0.9975517392158508
Test Epoch7 layer2 Acc 0.9791, AUC 0.9966030120849609
Test Epoch7 layer3 Acc 0.003142857142857143, AUC 0.4188745617866516
Test Epoch7 layer4 Acc 0.06842857142857142, AUC 0.45830076932907104
Test Epoch7 layer5 Acc 0.06877142857142857, AUC 0.5048434138298035
Test Epoch7 layer6 Acc 0.07245714285714286, AUC 0.5312554836273193
Test Epoch7 layer7 Acc 0.07108571428571428, AUC 0.40424808859825134
Test Epoch7 layer8 Acc 0.14192857142857143, AUC 0.4369446933269501
Test Epoch7 layer9 Acc 0.07155714285714286, AUC 0.5464422106742859
gc 0
Train Epoch8 Acc 0.07199285714285714 (40316/560000), AUC 0.5356689691543579
Test Epoch8 layer0 Acc 0.9737428571428571, AUC 0.9982894062995911
Test Epoch8 layer1 Acc 0.9790428571428571, AUC 0.9973432421684265
Test Epoch8 layer2 Acc 0.9791571428571428, AUC 0.9963737726211548
Test Epoch8 layer3 Acc 0.0037, AUC 0.4315424859523773
Test Epoch8 layer4 Acc 0.06978571428571428, AUC 0.45135822892189026
Test Epoch8 layer5 Acc 0.06472857142857143, AUC 0.500113308429718
Test Epoch8 layer6 Acc 0.07335714285714286, AUC 0.5341929197311401
Test Epoch8 layer7 Acc 0.07122857142857143, AUC 0.3952229917049408
Test Epoch8 layer8 Acc 0.14075714285714286, AUC 0.4298679530620575
Test Epoch8 layer9 Acc 0.07162857142857143, AUC 0.5436729788780212
gc 0
Train Epoch9 Acc 0.07207321428571428 (40361/560000), AUC 0.5340410470962524
Test Epoch9 layer0 Acc 0.9736571428571429, AUC 0.9982826113700867
Test Epoch9 layer1 Acc 0.9792714285714286, AUC 0.9974010586738586
Test Epoch9 layer2 Acc 0.979, AUC 0.9963927865028381
Test Epoch9 layer3 Acc 0.0032571428571428573, AUC 0.436527818441391
Test Epoch9 layer4 Acc 0.07088571428571429, AUC 0.45425865054130554
Test Epoch9 layer5 Acc 0.06448571428571429, AUC 0.49931472539901733
Test Epoch9 layer6 Acc 0.07265714285714285, AUC 0.5263700485229492
Test Epoch9 layer7 Acc 0.07117142857142857, AUC 0.39963629841804504
Test Epoch9 layer8 Acc 0.1339142857142857, AUC 0.42766883969306946
Test Epoch9 layer9 Acc 0.07154285714285714, AUC 0.5419344305992126
Best AUC 0.9983052015304565
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//dbpedia_14/dbpedia_14_transformeral_l10_m3_prefix.pt
[[4700   41   24   14   11   66   39    8    3    6    5   19   19   45]
 [  33 4902    1    1    7    0   31    7    3    2    1    1    4    7]
 [  37   13 4623   19   54    1   10    4    5    0    1   85   21  127]
 [   4    1   29 4952   10    0    1    0    0    0    0    2    0    1]
 [  11   18   77   12 4851    9    5    1    2    1    0    4    2    7]
 [  38    1    3    4    1 4940    5    3    1    2    0    0    1    1]
 [  62   50    6    3   10   16 4796   34    9    5    1    1    5    2]
 [   0    0    0    0    3    0   13 4963   16    3    1    0    0    1]
 [   2    4    2    0    3    0   11   13 4965    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4962   26    0    0    1]
 [  13    1    0    0    0    0    2    5    0   36 4942    1    0    0]
 [   7    0   35    2    0    0    1    0    0    1    1 4928   16    9]
 [   8    2   27    6    1    3    1    3    1    4    0   22 4879   43]
 [  30    7   94    9   11    3    4    9    1    5    4    7   46 4770]]
Figure(640x480)
[[4766   33   26   10   13   37   49    2    0    3    2   14   13   32]
 [  54 4863    9    1    7    1   49    0    2    1    0    0    7    6]
 [  23    2 4791   14   57    1   11    1    0    0    1   48   19   32]
 [   6    1   24 4953   11    1    1    0    0    0    0    0    1    2]
 [   6    9   73   15 4873    6    8    1    1    2    0    0    3    3]
 [  51    0    2    0    0 4933    7    1    1    1    0    1    3    0]
 [  58   27    6    2    7   10 4861   19    1    4    0    1    3    1]
 [   4    1    1    0    2    0   22 4947   13    6    2    0    1    1]
 [   2    1    3    0    6    0   14    9 4964    0    0    0    0    1]
 [   1    0    4    0    1    0    1    3    0 4962   27    0    0    1]
 [  12    0    1    0    0    1    1    1    0   30 4954    0    0    0]
 [  10    0   35    2    0    0    1    0    0    0    1 4931   14    6]
 [  10    1   22    1    0    1    0    0    0    0    0   20 4923   22]
 [  39    1  177    4    8    5    4    1    1    0    3   11   77 4669]]
Figure(640x480)
[[4774   32   28    9   13   38   49    2    0    3    2   12   10   28]
 [  57 4849   10    1    9    1   58    0    1    1    0    0    7    6]
 [  21    2 4805   14   54    1   11    1    0    0    0   42   19   30]
 [   6    1   23 4954   11    1    1    0    0    0    0    0    1    2]
 [   5    6   79   15 4872    5    8    1    1    2    0    0    3    3]
 [  51    0    1    0    0 4934    7    2    1    1    0    0    3    0]
 [  57   24    5    2    7    9 4866   20    1    3    0    1    4    1]
 [   3    2    1    0    2    0   23 4947   13    5    2    0    1    1]
 [   1    2    1    0    5    0   16    9 4965    0    0    0    0    1]
 [   1    0    3    0    1    0    0    5    0 4961   28    0    0    1]
 [  12    0    1    0    0    0    1    3    0   30 4953    0    0    0]
 [  13    0   42    2    0    0    1    0    0    0    1 4919   14    8]
 [  14    1   22    0    1    1    0    0    0    0    0   20 4916   25]
 [  39    1  203    3   10    5    4    1    0    0    2   10   73 4649]]
Figure(640x480)
[[   0    0    0   83    2 4892    0    7   16    0    0    0    0    0]
 [   0    0    0 4904    2   90    0    0    4    0    0    0    0    0]
 [   0    0    0 4912    5   75    0    2    6    0    0    0    0    0]
 [   0    0    0   42    2   11    0   14 4931    0    0    0    0    0]
 [   0    0    0 4957    7   17    0    2   14    3    0    0    0    0]
 [   0    0    0   19    0 4957    0    0   24    0    0    0    0    0]
 [   0    0    0 1620    0   90    0  114 3176    0    0    0    0    0]
 [   0    0    0 4914    0   27    0   57    2    0    0    0    0    0]
 [   0    0    0 2466    0 2512    0   20    2    0    0    0    0    0]
 [   0    0    0   27    0 4933    0   40    0    0    0    0    0    0]
 [   0    0    0 4899    0   99    0    2    0    0    0    0    0    0]
 [   0    0    0 4099    1  897    0    1    2    0    0    0    0    0]
 [   0    0    0  236 2791   54    0    0 1919    0    0    0    0    0]
 [   0    0    0  223    2 4766    0    0    9    0    0    0    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]]
Figure(640x480)
[[   0    0    0    0   15    0    0    0 4961    0    0   24    0    0]
 [   0    0    0    0    2    0    0    0 4990    0    0    4    0    4]
 [   0    0    0    0   21    0    0    0 4922    0    0   33    0   24]
 [   0    0    0    0 4623    0    0    0  374    0    0    0    0    3]
 [   0    0    0    0 2092    0    0    0  214    0    0    2    0 2692]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 4998    0    0    1    0    1]
 [   0    0    0    0    1    0    0    0 3667    0    0 1326    0    6]
 [   0    1    0    0    2    0    0    0 4660    0    0    0    8  329]
 [   0    0    0    0    0    0    0    0 4993    0    0    0    0    7]
 [   0    0    0    0    0    0    0    0  239    0    0    0    0 4761]
 [   0    0    0    0 4717    0    0    0  280    0    0    3    0    0]
 [   0    0    0    0   15    0    0    0 4014    0    0  704    0  267]
 [   0    0    0    0   19    0    0    0  312    0    0 4667    0    2]]
Figure(640x480)
[[   0    0    0    0   38    0   35 4899    0   27    1    0    0    0]
 [   0    0    0    0 4519    0    6  449    0   26    0    0    0    0]
 [   0    0    0    0  196    0 4730   53    0   20    1    0    0    0]
 [   0    0    0    0   15    0   66    6    0 4913    0    0    0    0]
 [   0    0    0    0 4403    0   49  525    0   23    0    0    0    0]
 [   0    0    0    0  382    0 4435  183    0    0    0    0    0    0]
 [   0    0    0    0  130    0    8  693    0 4164    5    0    0    0]
 [   0    0    0    0  419    0    0    6    0    8 4567    0    0    0]
 [   0    0    0    0 3710    0    3   17    0   12    4 1254    0    0]
 [   0    0    0    0   24    0    1   69    0 4903    3    0    0    0]
 [   0    0    0    0 4892    0    3   51    0   54    0    0    0    0]
 [   0    0    0    0 4918    0   51   24    1    6    0    0    0    0]
 [   0    0    0    0   31    0 4928   21    0   19    0    1    0    0]
 [   0    0    0    0  153    0  157 1879    0 2811    0    0    0    0]]
Figure(640x480)
[[   0    0 4999    0    0    0    0    1    0    0    0    0    0    0]
 [   0    0 3080    0    0    0    0 1920    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 4999    0    0    0    0    1    0    0    0    0    0    0]
 [  68    0 4932    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]]
Figure(640x480)
[[  71    0    0    0    0    0 4837    0   28    0    0    0   55    9]
 [  61    0    0    0    0    0  470    0    1    2    0    0 4466    0]
 [  78    0    0    0    0    0 4770    0    0    7    0    0  134   11]
 [  29    0    0    0    0    0   18    0    3    3    0    0    8 4939]
 [  49    0    0    0    0    0   57    0    1    3    0    0 4883    7]
 [  10    0    0    0    0    0 4321    0  668    0    0    0    0    1]
 [4882    0    0    0    0    0   83    0   10    0    0    0   25    0]
 [ 366    0    0    0    0    0   14    0 4584    0    0    0   36    0]
 [4985    0    0    0    0    0    3    0    4    0    0    0    8    0]
 [   6    0    0    0    0    0 4993    0    0    0    0    0    1    0]
 [   1    0    0    0    0    0 4999    0    0    0    0    0    0    0]
 [4937    0    0    0    0    0   56    0    0    3    0    0    1    3]
 [ 280    0    0    0    0    0   54    0    2 4647    0    0    8    9]
 [  82    0    0    0    0    0  197    0    1  126    0    0 1924 2670]]
Figure(640x480)
