total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask4//dbpedia_14/dbpedia_14_transformeral_l10_m4_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.016801785714285714 (9409/560000), AUC 0.5740889310836792
Test Epoch0 layer0 Acc 0.9739428571428571, AUC 0.9983107447624207
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_transformeral_l10_m5_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9786571428571429, AUC 0.9978193044662476
Test Epoch0 layer2 Acc 0.9788142857142857, AUC 0.9974373579025269
Test Epoch0 layer3 Acc 0.9790428571428571, AUC 0.9971326589584351
Test Epoch0 layer4 Acc 0.9789857142857142, AUC 0.9969878196716309
Test Epoch0 layer5 Acc 0.07142857142857142, AUC 0.4141919016838074
Test Epoch0 layer6 Acc 0.1419857142857143, AUC 0.5757318735122681
Test Epoch0 layer7 Acc 0.003442857142857143, AUC 0.38181808590888977
Test Epoch0 layer8 Acc 0.0027, AUC 0.46415582299232483
Test Epoch0 layer9 Acc 0.005857142857142857, AUC 0.6156712770462036
gc 0
Train Epoch1 Acc 0.06601071428571428 (36966/560000), AUC 0.6046951413154602
Test Epoch1 layer0 Acc 0.9737428571428571, AUC 0.9982717633247375
Test Epoch1 layer1 Acc 0.9792714285714286, AUC 0.9977092742919922
Test Epoch1 layer2 Acc 0.9794, AUC 0.9972826242446899
Test Epoch1 layer3 Acc 0.9794428571428572, AUC 0.9971196055412292
Test Epoch1 layer4 Acc 0.9793714285714286, AUC 0.99669349193573
Test Epoch1 layer5 Acc 0.0008142857142857143, AUC 0.47866490483283997
Test Epoch1 layer6 Acc 0.06885714285714285, AUC 0.5914790034294128
Test Epoch1 layer7 Acc 0.0726, AUC 0.35967639088630676
Test Epoch1 layer8 Acc 0.1420142857142857, AUC 0.4928617477416992
Test Epoch1 layer9 Acc 0.0717, AUC 0.6296491026878357
gc 0
Train Epoch2 Acc 0.09210714285714286 (51580/560000), AUC 0.5976787805557251
Test Epoch2 layer0 Acc 0.9737, AUC 0.9983029365539551
Test Epoch2 layer1 Acc 0.9794714285714285, AUC 0.99770587682724
Test Epoch2 layer2 Acc 0.9795, AUC 0.9970470666885376
Test Epoch2 layer3 Acc 0.9794285714285714, AUC 0.9965774416923523
Test Epoch2 layer4 Acc 0.9793714285714286, AUC 0.9961714148521423
Test Epoch2 layer5 Acc 0.0012857142857142856, AUC 0.4277923107147217
Test Epoch2 layer6 Acc 0.0005142857142857143, AUC 0.5759097337722778
Test Epoch2 layer7 Acc 0.07222857142857143, AUC 0.3570850193500519
Test Epoch2 layer8 Acc 0.12358571428571428, AUC 0.47655200958251953
Test Epoch2 layer9 Acc 0.14204285714285714, AUC 0.5928072929382324
gc 0
Train Epoch3 Acc 0.1386767857142857 (77659/560000), AUC 0.5708900690078735
Test Epoch3 layer0 Acc 0.9740571428571428, AUC 0.9982768297195435
Test Epoch3 layer1 Acc 0.9797, AUC 0.9976879358291626
Test Epoch3 layer2 Acc 0.9798714285714286, AUC 0.9969823956489563
Test Epoch3 layer3 Acc 0.9798571428571429, AUC 0.9965713620185852
Test Epoch3 layer4 Acc 0.9798857142857142, AUC 0.9961439371109009
Test Epoch3 layer5 Acc 0.00028571428571428574, AUC 0.45541757345199585
Test Epoch3 layer6 Acc 0.00042857142857142855, AUC 0.5788131952285767
Test Epoch3 layer7 Acc 0.07201428571428571, AUC 0.35953620076179504
Test Epoch3 layer8 Acc 0.07142857142857142, AUC 0.476877897977829
Test Epoch3 layer9 Acc 0.14161428571428572, AUC 0.5636847615242004
gc 0
Train Epoch4 Acc 0.1415 (79240/560000), AUC 0.5581403374671936
Test Epoch4 layer0 Acc 0.9737857142857143, AUC 0.9982965588569641
Test Epoch4 layer1 Acc 0.9787857142857143, AUC 0.9974974989891052
Test Epoch4 layer2 Acc 0.9787428571428571, AUC 0.9965702295303345
Test Epoch4 layer3 Acc 0.9786571428571429, AUC 0.9961414337158203
Test Epoch4 layer4 Acc 0.9787571428571429, AUC 0.9955266118049622
Test Epoch4 layer5 Acc 0.0005142857142857143, AUC 0.45115989446640015
Test Epoch4 layer6 Acc 0.0004, AUC 0.583946704864502
Test Epoch4 layer7 Acc 0.07217142857142857, AUC 0.33996984362602234
Test Epoch4 layer8 Acc 0.07142857142857142, AUC 0.521146833896637
Test Epoch4 layer9 Acc 0.141, AUC 0.5584620237350464
gc 0
Train Epoch5 Acc 0.14162142857142856 (79308/560000), AUC 0.5488249063491821
Test Epoch5 layer0 Acc 0.9737857142857143, AUC 0.998302161693573
Test Epoch5 layer1 Acc 0.9795857142857143, AUC 0.997379720211029
Test Epoch5 layer2 Acc 0.9793285714285714, AUC 0.9963741302490234
Test Epoch5 layer3 Acc 0.9792428571428572, AUC 0.9958266019821167
Test Epoch5 layer4 Acc 0.9792714285714286, AUC 0.9952238202095032
Test Epoch5 layer5 Acc 0.0005857142857142858, AUC 0.45822110772132874
Test Epoch5 layer6 Acc 0.0004857142857142857, AUC 0.5905473828315735
Test Epoch5 layer7 Acc 0.07194285714285714, AUC 0.35597139596939087
Test Epoch5 layer8 Acc 0.07142857142857142, AUC 0.5230000019073486
Test Epoch5 layer9 Acc 0.14027142857142857, AUC 0.5452965497970581
gc 0
Train Epoch6 Acc 0.14163392857142856 (79315/560000), AUC 0.5435038805007935
Test Epoch6 layer0 Acc 0.9738714285714286, AUC 0.998306155204773
Test Epoch6 layer1 Acc 0.9792714285714286, AUC 0.9973951578140259
Test Epoch6 layer2 Acc 0.9794857142857143, AUC 0.9962493777275085
Test Epoch6 layer3 Acc 0.9793857142857143, AUC 0.9955137372016907
Test Epoch6 layer4 Acc 0.9793714285714286, AUC 0.9949657320976257
Test Epoch6 layer5 Acc 0.0006428571428571428, AUC 0.4647679030895233
Test Epoch6 layer6 Acc 0.00044285714285714284, AUC 0.5744266510009766
Test Epoch6 layer7 Acc 0.07187142857142857, AUC 0.35542574524879456
Test Epoch6 layer8 Acc 0.07142857142857142, AUC 0.5230132937431335
Test Epoch6 layer9 Acc 0.14034285714285713, AUC 0.555869460105896
gc 0
Train Epoch7 Acc 0.14163035714285716 (79313/560000), AUC 0.5413457155227661
Test Epoch7 layer0 Acc 0.9737285714285714, AUC 0.9982844591140747
Test Epoch7 layer1 Acc 0.9791, AUC 0.9973060488700867
Test Epoch7 layer2 Acc 0.9792714285714286, AUC 0.9960403442382812
Test Epoch7 layer3 Acc 0.9791857142857143, AUC 0.9954325556755066
Test Epoch7 layer4 Acc 0.9792285714285714, AUC 0.9947420954704285
Test Epoch7 layer5 Acc 0.0006285714285714285, AUC 0.4652767777442932
Test Epoch7 layer6 Acc 0.00044285714285714284, AUC 0.5775928497314453
Test Epoch7 layer7 Acc 0.072, AUC 0.3609618842601776
Test Epoch7 layer8 Acc 0.07142857142857142, AUC 0.5207197070121765
Test Epoch7 layer9 Acc 0.14077142857142858, AUC 0.5409311056137085
gc 0
Train Epoch8 Acc 0.14158928571428572 (79290/560000), AUC 0.538913369178772
Test Epoch8 layer0 Acc 0.9738, AUC 0.9982918500900269
Test Epoch8 layer1 Acc 0.9791714285714286, AUC 0.9973669648170471
Test Epoch8 layer2 Acc 0.9790714285714286, AUC 0.9961735010147095
Test Epoch8 layer3 Acc 0.9790285714285715, AUC 0.9955085515975952
Test Epoch8 layer4 Acc 0.9789428571428571, AUC 0.9948984384536743
Test Epoch8 layer5 Acc 0.0005571428571428572, AUC 0.46447914838790894
Test Epoch8 layer6 Acc 0.00042857142857142855, AUC 0.5792332887649536
Test Epoch8 layer7 Acc 0.07185714285714286, AUC 0.36713045835494995
Test Epoch8 layer8 Acc 0.07142857142857142, AUC 0.5193082094192505
Test Epoch8 layer9 Acc 0.14037142857142856, AUC 0.5493496060371399
gc 0
Train Epoch9 Acc 0.1417017857142857 (79353/560000), AUC 0.537451446056366
Test Epoch9 layer0 Acc 0.9739714285714286, AUC 0.9982944130897522
Test Epoch9 layer1 Acc 0.9791714285714286, AUC 0.9972701668739319
Test Epoch9 layer2 Acc 0.9790285714285715, AUC 0.99614018201828
Test Epoch9 layer3 Acc 0.9792, AUC 0.9953489303588867
Test Epoch9 layer4 Acc 0.9791857142857143, AUC 0.994865357875824
Test Epoch9 layer5 Acc 0.0008285714285714286, AUC 0.46714797616004944
Test Epoch9 layer6 Acc 0.0004714285714285714, AUC 0.565890371799469
Test Epoch9 layer7 Acc 0.07182857142857142, AUC 0.37704998254776
Test Epoch9 layer8 Acc 0.07142857142857142, AUC 0.5172990560531616
Test Epoch9 layer9 Acc 0.1402142857142857, AUC 0.5492888689041138
Best AUC 0.9983107447624207
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//dbpedia_14/dbpedia_14_transformeral_l10_m5_prefix.pt
[[4708   38   20   13   11   66   41    8    2    6    5   19   18   45]
 [  38 4894    1    1    7    0   33    7    4    2    1    0    4    8]
 [  43   13 4571   19   57    1   10    4    6    0    2   88   21  165]
 [   4    1   29 4949   13    0    1    0    0    0    0    0    0    3]
 [  12   15   60   11 4869    9    7    1    2    1    0    1    2   10]
 [  40    1    3    4    1 4938    5    2    1    2    0    0    1    2]
 [  63   40    3    3   11   15 4806   37    9    5    1    1    3    3]
 [   1    1    0    0    2    0   12 4963   16    3    1    0    0    1]
 [   2    4    2    0    3    0   12   13 4964    0    0    0    0    0]
 [   1    0    0    2    1    0    0    8    0 4954   32    1    0    1]
 [  12    1    0    0    0    0    2    4    0   34 4946    1    0    0]
 [   8    0   32    2    0    0    0    0    0    1    1 4929   15   12]
 [  10    2   23    4    1    2    1    3    1    3    0   23 4877   50]
 [  32    4   65    7   14    3    3    9    1    4    3    6   41 4808]]
Figure(640x480)
[[4707   37   22   10   13   49   57    4    0    3    2   19   20   57]
 [  44 4894    4    1    9    0   39    0    0    1    1    0    1    6]
 [  25    6 4687   13   74    1   10    1    1    0    3   51   19  109]
 [   5    1   16 4959   14    0    1    0    0    0    0    1    1    2]
 [   5    8   52   10 4898    5    7    1    2    1    0    0    3    8]
 [  41    0    2    0    0 4943    5    4    1    0    0    0    2    2]
 [  49   27    2    2    8    8 4870   24    3    2    0    1    1    3]
 [   1    1    0    0    0    0   22 4960   12    3    0    0    0    1]
 [   3    2    1    0    5    0   12   16 4957    0    0    0    0    4]
 [   1    0    2    1    1    0    0    5    0 4955   32    0    0    3]
 [  12    1    1    0    0    1    1    2    0   29 4953    0    0    0]
 [   5    0   26    2    0    0    0    0    0    0    0 4943   12   12]
 [   4    1   13    0    0    0    1    0    0    0    0   20 4903   58]
 [  24    2   52    3    4    1    3    0    0    0    1    7   26 4877]]
Figure(640x480)
[[4731   36   22   10   11   43   55    4    0    2    2   16   14   54]
 [  46 4891    3    1    9    0   40    0    1    1    1    0    1    6]
 [  27    4 4683   15   77    1    9    1    1    0    3   51   17  111]
 [   5    1   11 4964   13    1    0    1    0    0    0    1    1    2]
 [   7    7   50   12 4894    5    8    1    1    2    0    0    3   10]
 [  46    0    2    0    0 4937    5    4    1    0    0    0    2    3]
 [  52   27    1    2    8    8 4866   25    3    2    0    1    2    3]
 [   1    1    0    0    1    0   20 4962   11    3    0    0    0    1]
 [   3    0    1    0    5    0   11   14 4962    0    0    0    0    4]
 [   1    0    1    1    2    0    0    5    0 4956   30    0    0    4]
 [  12    1    0    0    0    1    1    3    0   28 4954    0    0    0]
 [   5    0   22    2    0    0    0    0    0    0    0 4944   13   14]
 [   5    1   12    0    0    0    1    1    0    0    0   19 4890   71]
 [  25    2   48    3    4    1    2    0    0    1    1    7   23 4883]]
Figure(640x480)
[[4741   35   19   10   11   41   52    4    0    2    2   16   14   53]
 [  47 4892    3    1    9    0   37    0    1    1    1    0    2    6]
 [  27    4 4682   15   77    1    9    1    1    0    3   51   18  111]
 [   5    1   11 4964   13    1    0    1    0    0    0    1    1    2]
 [   7    6   47   12 4900    5    7    1    1    2    0    0    3    9]
 [  46    0    0    0    0 4939    5    4    1    0    0    0    2    3]
 [  52   27    1    2    8    8 4866   25    3    2    0    1    2    3]
 [   1    1    0    0    1    0   20 4962   11    3    0    0    0    1]
 [   3    0    1    0    5    0   11   14 4961    0    0    0    0    5]
 [   1    0    2    1    1    0    0    5    0 4955   31    0    0    4]
 [  12    1    0    0    0    2    1    3    0   27 4954    0    0    0]
 [   5    0   23    2    0    0    0    0    0    0    0 4944   13   13]
 [   6    1   12    0    0    0    1    1    0    0    0   19 4890   70]
 [  26    2   47    3    4    1    2    0    0    1    1    7   23 4883]]
Figure(640x480)
[[4738   36   18   10   11   41   52    4    0    2    2   16   16   54]
 [  46 4893    3    1    9    0   38    0    1    1    1    0    1    6]
 [  26    4 4674   15   79    1    9    1    1    0    3   51   20  116]
 [   5    1    9 4966   14    0    0    1    0    0    0    1    1    2]
 [   7    6   47   12 4901    5    7    1    1    2    0    0    3    8]
 [  46    0    0    0    0 4937    5    5    1    0    0    0    2    4]
 [  52   27    1    2    8    8 4866   25    3    2    0    1    2    3]
 [   1    1    0    0    1    0   20 4962   11    3    0    0    0    1]
 [   3    0    1    0    5    0   11   14 4961    0    0    0    0    5]
 [   1    0    1    1    2    0    0    5    0 4955   31    0    0    4]
 [  12    1    0    0    0    1    1    3    0   27 4955    0    0    0]
 [   5    0   22    2    0    0    0    0    0    0    0 4945   12   14]
 [   5    1   12    0    0    0    1    1    0    0    0   19 4891   70]
 [  25    2   45    3    4    1    2    0    0    1    1    7   24 4885]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]]
Figure(640x480)
[[   0    0   10    6    0    0 4870    0  114    0    0    0    0    0]
 [   0    0    0    7    0    0 4987    0    6    0    0    0    0    0]
 [   0    0    1   14    0    0 4888    0   97    0    0    0    0    0]
 [   0    0    0    3    0    0 4985    0   12    0    0    0    0    0]
 [   0    0    1 4564    0    0  100    0  335    0    0    0    0    0]
 [   0    0 4616    0    0    0   21    0  363    0    0    0    0    0]
 [   0    0    3    2    0    0 4978    0   17    0    0    0    0    0]
 [   0    0    0    0    0    0 4984    0   16    0    0    0    0    0]
 [   0    0    0    2    0    0   35    0 4957    0    6    0    0    0]
 [   0    0    0    0    0    0 4951    0   49    0    0    0    0    0]
 [   0    0    0    0    0    0 4996    0    4    0    0    0    0    0]
 [   0    0    0    0    0    0   50    0 4950    0    0    0    0    0]
 [   0    0    0    0    0    0 4964    0   36    0    0    0    0    0]
 [   0    0    0    1    0    0 4975    0   24    0    0    0    0    0]]
Figure(640x480)
[[ 170    0    0    0    0    0    0    2    0   42    0 4786    0    0]
 [  79    0    0    0    0    0    0 3929    0   15   55  922    0    0]
 [ 133    0    0    0    0    0    0    0    0   98    0 4769    0    0]
 [  24    0    0    0    0    0    0   21    0 4923    0   32    0    0]
 [  12    0    0    0    0    0    0    0    0 4912    0   76    0    0]
 [  11    0    0    0    0    0    0    0    0   37    0 4952    0    0]
 [4903    0    0    0    0    0    0    8    0   34    0   55    0    0]
 [4987    0    0    0    0    0    0    0    0   10    0    3    0    0]
 [4988    0    0    0    0    0    0    0    0    5    0    7    0    0]
 [   4    0    0    0    0    0    0   11    0   29    0 4956    0    0]
 [   2    0    0    0    0    0    0    0    0 4946    0   52    0    0]
 [4946    0    0    0    0    0    0    0    0   12    0   42    0    0]
 [  71    0    0    0    0    0    0    0    0 4909    0   20    0    0]
 [4870    0    0    0    0    0    0    0    0   51    6   73    0    0]]
Figure(640x480)
[[   0   87    0    0    0   44    0    0 4869    0    0    0    0    0]
 [   0   10    0    0    0 1483    0    0 3507    0    0    0    0    0]
 [   0 4776    0    0    0    5    0    0  218    0    1    0    0    0]
 [   0   22    0    0    0    2    0    0 4974    0    2    0    0    0]
 [   0 4943    0    0    0    5    0    0   52    0    0    0    0    0]
 [   0 4961    0    0    0    2    0    0   37    0    0    0    0    0]
 [   0   43    0    0    0 4755    0    0  202    0    0    0    0    0]
 [   0 4977    0    0    0    5    0    0   18    0    0    0    0    0]
 [   0 4817    0    0    0    6    0    0  177    0    0    0    0    0]
 [   0    6    0    0    0    0    0    0 4994    0    0    0    0    0]
 [   0    4    0    0    0    1    0    0 4995    0    0    0    0    0]
 [   0   17    0    0    0    0    0    0 4983    0    0    0    0    0]
 [   0   14    0    0    0    0    0    0 4986    0    0    0    0    0]
 [   0  750    0    0    0    3    0    0 4247    0    0    0    0    0]]
Figure(640x480)
[[   0    0   24    0    0    0  397    0 4579    0    0    0    0    0]
 [   0    0    0    0    0    0 4962    0   38    0    0    0    0    0]
 [   0    0   70    0    0    0 4637    0  293    0    0    0    0    0]
 [   0    0    1    0    0    0   10    0 4989    0    0    0    0    0]
 [   0    0    0    0    0    0   48    0 4952    0    0    0    0    0]
 [   0    0 1732    0    0    0 3243    0   25    0    0    0    0    0]
 [   0    0    1    0    0    0  333    0 4666    0    0    0    0    0]
 [   0    0    0    0    0    0 3144    0 1856    0    0    0    0    0]
 [   0    0    0    0    0    0 4993    0    7    0    0    0    0    0]
 [   0    0    0    0    0    0 4965    0   35    0    0    0    0    0]
 [   0    0    1    0    0    0   37    0 4962    0    0    0    0    0]
 [   0    0 4957    0    0    0   34    0    9    0    0    0    0    0]
 [   0    0 4801    0    0    0  150    0   49    0    0    0    0    0]
 [   0    0   19    0    0    0 4956    0   25    0    0    0    0    0]]
Figure(640x480)
