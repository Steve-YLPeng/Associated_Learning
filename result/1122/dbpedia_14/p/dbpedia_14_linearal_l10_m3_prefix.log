total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask2//dbpedia_14/dbpedia_14_linearal_l10_m2_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.014007142857142857 (7844/560000), AUC 0.3752870261669159
Test Epoch0 layer0 Acc 0.9739714285714286, AUC 0.9983282685279846
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l10_m3_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9752571428571428, AUC 0.9985349774360657
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l10_m3_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9750142857142857, AUC 0.9985542297363281
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l10_m3_prefix.pt  ,ep 0
Test Epoch0 layer3 Acc 0.003142857142857143, AUC 0.45553088188171387
Test Epoch0 layer4 Acc 0.04334285714285714, AUC 0.5640887022018433
Test Epoch0 layer5 Acc 0.10341428571428571, AUC 0.5337644815444946
Test Epoch0 layer6 Acc 0.0625, AUC 0.5563084483146667
Test Epoch0 layer7 Acc 0.06985714285714285, AUC 0.4888310730457306
Test Epoch0 layer8 Acc 0.0051, AUC 0.5138624310493469
Test Epoch0 layer9 Acc 0.0023857142857142857, AUC 0.36172008514404297
gc 0
Train Epoch1 Acc 0.0098 (5488/560000), AUC 0.360781729221344
Test Epoch1 layer0 Acc 0.9739857142857142, AUC 0.9983231425285339
Test Epoch1 layer1 Acc 0.9757285714285714, AUC 0.9985446333885193
Test Epoch1 layer2 Acc 0.9762, AUC 0.9984766840934753
Test Epoch1 layer3 Acc 0.008628571428571428, AUC 0.45222803950309753
Test Epoch1 layer4 Acc 0.020042857142857144, AUC 0.5311115980148315
Test Epoch1 layer5 Acc 0.0891, AUC 0.5588862895965576
Test Epoch1 layer6 Acc 0.04807142857142857, AUC 0.545046865940094
Test Epoch1 layer7 Acc 0.07058571428571428, AUC 0.5289934277534485
Test Epoch1 layer8 Acc 0.006528571428571429, AUC 0.5344563126564026
Test Epoch1 layer9 Acc 0.028342857142857142, AUC 0.3662033975124359
gc 0
Train Epoch2 Acc 0.041757142857142854 (23384/560000), AUC 0.37464842200279236
Test Epoch2 layer0 Acc 0.9738285714285714, AUC 0.998344361782074
Test Epoch2 layer1 Acc 0.9760857142857143, AUC 0.998522937297821
Test Epoch2 layer2 Acc 0.9760142857142857, AUC 0.9983838200569153
Test Epoch2 layer3 Acc 0.01757142857142857, AUC 0.4533360004425049
Test Epoch2 layer4 Acc 0.041685714285714284, AUC 0.5149466395378113
Test Epoch2 layer5 Acc 0.08065714285714286, AUC 0.5576457381248474
Test Epoch2 layer6 Acc 0.04978571428571429, AUC 0.5496470332145691
Test Epoch2 layer7 Acc 0.09621428571428571, AUC 0.5380781292915344
Test Epoch2 layer8 Acc 0.0095, AUC 0.5452896952629089
Test Epoch2 layer9 Acc 0.048357142857142855, AUC 0.3840494453907013
gc 0
Train Epoch3 Acc 0.05375714285714286 (30104/560000), AUC 0.3929090201854706
Test Epoch3 layer0 Acc 0.9738857142857142, AUC 0.9983301162719727
Test Epoch3 layer1 Acc 0.9763285714285714, AUC 0.9984678030014038
Test Epoch3 layer2 Acc 0.9764, AUC 0.9982894659042358
Test Epoch3 layer3 Acc 0.012428571428571428, AUC 0.45793431997299194
Test Epoch3 layer4 Acc 0.02747142857142857, AUC 0.5119956731796265
Test Epoch3 layer5 Acc 0.07867142857142857, AUC 0.5607860088348389
Test Epoch3 layer6 Acc 0.034757142857142855, AUC 0.5562940835952759
Test Epoch3 layer7 Acc 0.1167, AUC 0.532924234867096
Test Epoch3 layer8 Acc 0.008371428571428571, AUC 0.5432458519935608
Test Epoch3 layer9 Acc 0.0558, AUC 0.3998396098613739
gc 0
Train Epoch4 Acc 0.05845892857142857 (32737/560000), AUC 0.40514108538627625
Test Epoch4 layer0 Acc 0.9737714285714286, AUC 0.9983333349227905
Test Epoch4 layer1 Acc 0.9764428571428572, AUC 0.998451292514801
Test Epoch4 layer2 Acc 0.9767285714285714, AUC 0.9982742071151733
Test Epoch4 layer3 Acc 0.009142857142857144, AUC 0.4689960181713104
Test Epoch4 layer4 Acc 0.01694285714285714, AUC 0.5141278505325317
Test Epoch4 layer5 Acc 0.08078571428571428, AUC 0.5655239820480347
Test Epoch4 layer6 Acc 0.04025714285714286, AUC 0.5635509490966797
Test Epoch4 layer7 Acc 0.12405714285714285, AUC 0.5236390829086304
Test Epoch4 layer8 Acc 0.0036142857142857144, AUC 0.5399044156074524
Test Epoch4 layer9 Acc 0.0555, AUC 0.4052530825138092
gc 0
Train Epoch5 Acc 0.05953214285714286 (33338/560000), AUC 0.4077373445034027
Test Epoch5 layer0 Acc 0.9739714285714286, AUC 0.998332142829895
Test Epoch5 layer1 Acc 0.9765571428571429, AUC 0.9984353184700012
Test Epoch5 layer2 Acc 0.9766, AUC 0.9982399940490723
Test Epoch5 layer3 Acc 0.007728571428571428, AUC 0.47329121828079224
Test Epoch5 layer4 Acc 0.021514285714285715, AUC 0.5171366333961487
Test Epoch5 layer5 Acc 0.08152857142857142, AUC 0.5675057768821716
Test Epoch5 layer6 Acc 0.04837142857142857, AUC 0.5664435625076294
Test Epoch5 layer7 Acc 0.12325714285714286, AUC 0.5166407227516174
Test Epoch5 layer8 Acc 0.0036142857142857144, AUC 0.538375198841095
Test Epoch5 layer9 Acc 0.05962857142857143, AUC 0.40558862686157227
gc 0
Train Epoch6 Acc 0.061405357142857143 (34387/560000), AUC 0.40887054800987244
Test Epoch6 layer0 Acc 0.9739, AUC 0.9983347654342651
Test Epoch6 layer1 Acc 0.9766, AUC 0.9984543919563293
Test Epoch6 layer2 Acc 0.9767, AUC 0.9982784986495972
Test Epoch6 layer3 Acc 0.007585714285714286, AUC 0.47624334692955017
Test Epoch6 layer4 Acc 0.014342857142857143, AUC 0.5192261338233948
Test Epoch6 layer5 Acc 0.08505714285714286, AUC 0.5692530870437622
Test Epoch6 layer6 Acc 0.05148571428571429, AUC 0.5667547583580017
Test Epoch6 layer7 Acc 0.12298571428571428, AUC 0.5142187476158142
Test Epoch6 layer8 Acc 0.0037142857142857142, AUC 0.5375359058380127
Test Epoch6 layer9 Acc 0.06162857142857143, AUC 0.40677350759506226
gc 0
Train Epoch7 Acc 0.06280892857142857 (35173/560000), AUC 0.41141796112060547
Test Epoch7 layer0 Acc 0.9739714285714286, AUC 0.9983120560646057
Test Epoch7 layer1 Acc 0.9768142857142857, AUC 0.9984334111213684
Test Epoch7 layer2 Acc 0.9767714285714286, AUC 0.998242199420929
Test Epoch7 layer3 Acc 0.007957142857142857, AUC 0.4785606563091278
Test Epoch7 layer4 Acc 0.011128571428571429, AUC 0.5198827981948853
Test Epoch7 layer5 Acc 0.08525714285714285, AUC 0.5715615153312683
Test Epoch7 layer6 Acc 0.054785714285714285, AUC 0.5676501393318176
Test Epoch7 layer7 Acc 0.12425714285714286, AUC 0.5114350914955139
Test Epoch7 layer8 Acc 0.004285714285714286, AUC 0.5346726775169373
Test Epoch7 layer9 Acc 0.0626, AUC 0.40828457474708557
gc 0
Train Epoch8 Acc 0.06396785714285715 (35822/560000), AUC 0.4125143885612488
Test Epoch8 layer0 Acc 0.9740714285714286, AUC 0.9983267784118652
Test Epoch8 layer1 Acc 0.9767285714285714, AUC 0.9984559416770935
Test Epoch8 layer2 Acc 0.9768285714285714, AUC 0.9982399344444275
Test Epoch8 layer3 Acc 0.007985714285714285, AUC 0.48120465874671936
Test Epoch8 layer4 Acc 0.010071428571428571, AUC 0.5196961164474487
Test Epoch8 layer5 Acc 0.0869, AUC 0.5730803608894348
Test Epoch8 layer6 Acc 0.06012857142857143, AUC 0.5700191259384155
Test Epoch8 layer7 Acc 0.12534285714285714, AUC 0.5125899910926819
Test Epoch8 layer8 Acc 0.0038285714285714286, AUC 0.5345678925514221
Test Epoch8 layer9 Acc 0.06414285714285714, AUC 0.41163650155067444
gc 0
Train Epoch9 Acc 0.0650625 (36435/560000), AUC 0.41386181116104126
Test Epoch9 layer0 Acc 0.9738714285714286, AUC 0.9983019232749939
Test Epoch9 layer1 Acc 0.9766571428571429, AUC 0.9984477758407593
Test Epoch9 layer2 Acc 0.9769142857142857, AUC 0.9981607794761658
Test Epoch9 layer3 Acc 0.0083, AUC 0.482686311006546
Test Epoch9 layer4 Acc 0.008814285714285714, AUC 0.5190810561180115
Test Epoch9 layer5 Acc 0.08741428571428571, AUC 0.5744928121566772
Test Epoch9 layer6 Acc 0.06268571428571429, AUC 0.570737898349762
Test Epoch9 layer7 Acc 0.12554285714285715, AUC 0.5131581425666809
Test Epoch9 layer8 Acc 0.004257142857142857, AUC 0.534286618232727
Test Epoch9 layer9 Acc 0.06462857142857142, AUC 0.41139110922813416
Best AUC 0.9985542297363281
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//dbpedia_14/dbpedia_14_linearal_l10_m3_prefix.pt
[[4707   42   22   14   11   61   40    8    3    6    4   20   19   43]
 [  38 4894    2    1    8    0   32    7    4    2    1    0    3    8]
 [  37   11 4652   19   52    1    9    3    4    0    1   71   20  120]
 [   3    2   33 4946   11    1    1    0    0    0    0    0    0    3]
 [  11   14   80   11 4855    6    5    1    2    0    0    0    2   13]
 [  42    2    3    3    1 4936    5    3    1    1    0    0    1    2]
 [  66   44    6    3   11   15 4795   37   10    5    1    1    4    2]
 [   0    1    0    0    2    0   11 4966   15    3    1    0    0    1]
 [   2    4    2    0    3    0   13   13 4963    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4959   29    0    0    1]
 [  14    1    0    0    0    0    1    3    0   37 4944    0    0    0]
 [   7    0   41    3    0    0    0    0    0    1    0 4921   16   11]
 [   8    2   25    6    2    3    2    3    0    2    0   22 4882   43]
 [  37    6   91    9   13    3    4   11    1    7    3    7   50 4758]]
Figure(640x480)
[[4725   39   22   11   12   49   38    5    2    5    2   28   16   46]
 [  36 4910    2    2    7    0   28    1    1    2    0    0    4    7]
 [  35   13 4659   17   56    1    8    0    1    0    1   86   26   97]
 [   5    2   26 4953   12    0    1    0    0    0    0    0    0    1]
 [   9   16   67   12 4875    7    6    0    1    1    0    0    1    5]
 [  45    1    3    2    1 4937    5    2    1    0    0    0    1    2]
 [  63   46    6    3   10   15 4808   29    4    5    1    1    6    3]
 [   1    1    0    0    2    0   15 4962   10    3    4    0    1    1]
 [   2    3    2    0    5    0   15   19 4953    0    0    0    0    1]
 [   1    0    1    2    1    0    0    6    0 4958   30    0    0    1]
 [  13    1    0    0    0    0    2    3    0   56 4925    0    0    0]
 [   9    0   29    2    0    0    0    0    0    0    1 4932   15   12]
 [   9    2   19    4    0    2    0    1    0    1    0   19 4906   37]
 [  34    4   82    7    9    3    2    4    0    5    2    9   74 4765]]
Figure(640x480)
[[4722   42   19   10   11   50   40    6    0    5    2   25   19   49]
 [  36 4906    1    2    5    0   33    0    2    2    0    0    6    7]
 [  37   12 4664   17   54    1   10    0    2    0    2   77   26   98]
 [   5    2   28 4950   12    0    1    0    0    0    0    0    1    1]
 [  10   15   75   15 4859    7    8    1    1    1    0    0    3    5]
 [  43    2    2    2    1 4939    5    2    1    0    0    0    1    2]
 [  59   48    5    2   10   16 4814   28    2    4    1    1    7    3]
 [   0    2    0    0    2    1   13 4964   11    3    2    0    1    1]
 [   2    3    2    0    6    0   18   20 4949    0    0    0    0    0]
 [   1    0    1    3    1    0    0    6    0 4958   29    0    0    1]
 [  13    1    0    0    0    0    2    3    0   50 4931    0    0    0]
 [   8    0   34    2    0    1    0    0    0    0    0 4924   18   13]
 [   8    2   21    4    0    3    0    1    0    0    0   19 4905   37]
 [  31    6   88    7    9    3    3    4    0    2    1    8   72 4766]]
Figure(640x480)
[[   1    0    0    0    0    1  677    0  309    9 3979    0    0   24]
 [   1    0    0    0    0    0  195    0 4635    4  165    0    0    0]
 [   0    0    0    0    7    0 2809  182 1754    1  245    2    0    0]
 [   2    0   88    0    0    0   71 1056 2543    0   39    0    0 1201]
 [   0    0    0    0    0    0   47    1 4937    1   12    0    0    2]
 [   0    0    0    0   78    0 1677   19 3207    3   16    0    0    0]
 [  45    0    0    0    0    0   23    0  413 3742  776    0    0    1]
 [   1    0    0    0    0    0    6    0 4742    1  249    0    0    1]
 [ 492    0 2632    0    0    0 1530    0  165  172    9    0    0    0]
 [   0    0    0    0    0    0   48    0 4859    0    6    0    0   87]
 [   0    0    0    0    0    0  103    2 4858    5   27    0    0    5]
 [   2    0    0    0    0    1   59    0 4833    0   85    0    0   20]
 [  25    0    0    0    0    0   19    0 4811    0  137    0    0    8]
 [   9    0    1    0    0    0 2308    0   52    0 2626    0    0    4]]
Figure(640x480)
[[   5    0   19    0    0    0    0  556    0    0 2891    0   46 1483]
 [   1    0    0    0    0    0    0 3738    0    0   10    0    5 1246]
 [3520    0   50    0    0    0    0   53    8    0   40    0   17 1312]
 [  24    0    0    0    0    0    0 4909    4    0    0    0    4   59]
 [  36    3    0    1    0    0    0  274   10    0    7    0   29 4640]
 [   0    0    0    3    0    0    0 4711    0    2    5    0    5  274]
 [   1    0    7    0    0    0    0  662    0    0    2    0   56 4272]
 [  45    0 2527    0    2    0    0 2342    0    0    0    0   26   58]
 [  11    0    1    0    0    0    0 4605    0    0    2    0   66  315]
 [   1    0 4260    1    0    0    0  179    0    0    0   22  196  341]
 [   1    0    5    0    0    0   19   28   62    0   41   38   14 4792]
 [   3    0   35   14    0    0    0   39    0    0  232    0   16 4661]
 [   2    0   48    0    0    0    0  268    0    0    6  137   33 4506]
 [  14    0 4275    0    0    0    0  129    0    0    4    0   15  563]]
Figure(640x480)
[[   0    0  499    0    0   38   18   31    0 4326    0    0   86    2]
 [   0    0 3965    0    0   10   12   44    0  961    0    6    2    0]
 [   0    0 4880    0    0    0   91    8    0   14    0    7    0    0]
 [   0    0 4911    0    0    1    7   68    0    1    0   10    0    2]
 [   0    0 4314    0    0    1   11   57    0  611    0    6    0    0]
 [   0    2 4123    0    0    7    0  836    0   29    0    0    3    0]
 [   0    0 3620    0    0 1326   23    7    0   21    0    1    2    0]
 [   0    0 2805    0    0    0    1 2194    0    0    0    0    0    0]
 [   0    0 2132    0    0    2    0 2863    0    2    0    0    1    0]
 [   1    0 4825    0    0    4    1    5    0  130    0   12   22    0]
 [   0    0 4973    0    0    0    1    2    0   10    0   12    2    0]
 [   0    0 4925    0    0    1    1   12    0   25    0    1   35    0]
 [   0    0 4190    0    0    2    1  182    0    3    0    0    1  621]
 [   0    0 2585    0    6    1  767    3    0 1623    0    9    3    3]]
Figure(640x480)
[[   0    0    0 2529    0    0   65 2330   41   17    0    5   13    0]
 [   0    0    0 1926    0    0  843  543    0    4    0   14 1215  455]
 [   0    0    0 2568    0    0 2133  232    1   50    0   13    1    2]
 [   0    0    0 3034    0    0   64   14  269    6    0 1612    1    0]
 [   0    0    0 1650    0    0  107  165    1   10    0 3060    7    0]
 [   0    0    0 2250    0    0   59   42 2642    6    0    0    1    0]
 [   0    0    0  812    0    0   23  175    1    4    0    1 3983    1]
 [   0    0    0   76    0    0 4377  384    0   10    0   77   76    0]
 [   0    0    0    8    0    0    4 4932    1   24    0    4   27    0]
 [   0    0    0   26    0    0 4277    8  624   64    0    0    1    0]
 [   0    0    0 4103    0    0   44   30  796   27    0    0    0    0]
 [   0    0    0  559    0    0 3619  690  118    6    0    0    8    0]
 [   0    0    0 4006    0    0   21   44   13   46    0    1  869    0]
 [   0    0    0  370    0    0 4293   36   90  207    0    4    0    0]]
Figure(640x480)
[[  29    0    0    2   19   12    0    0    0    0    0    0 4938    0]
 [2873    0    0   62   73    4    0    0    0    0    0    0 1988    0]
 [  43    0    0   66   23   35    0    0    0    0    0    0 4833    0]
 [ 213    0    0    2  121   19    0    0    0    0    0    0 4645    0]
 [  15    0    3    4    3   15    0    0    0    0    0    0 4960    0]
 [   8    0    1   25 2295   29    0    0    0    0    0    0 2642    0]
 [  31    0    0  770    4   11    0    0    0   17    0    0 4167    0]
 [   1    0    0    1    0  549    0    0    0    1    0    0 4448    0]
 [ 233    0    0 4238  131   16    0    0    0   59    0    0  323    0]
 [   2    0    0 1204    1   64    0    0    0   81    0    0 3648    0]
 [  19    0    0   21    3   25    0    0    0    0    0    0 4932    0]
 [   0    0    0    0   77   75    0    0    0    1    0    0 4847    0]
 [  84    0    0   68    6   96    0    0    0    0    0    0 4746    0]
 [  27    0    0   26 3415    8    0    0    0    0    0    0 1524    0]]
Figure(640x480)
[[  12 1231    4  777    0    0    0    1 2787    0    0  167   21    0]
 [  13    1    0 3464    0    0    0    6 1515    0    0    1    0    0]
 [   8    1    1  508    0    0    0 1842 2551    0    0   53   36    0]
 [   1    0    0  130    0    0    0    0 4863    0    0    1    5    0]
 [1367    0    0  177    0    0    0   30 3424    0    0    0    2    0]
 [  43    1    0 2019    0    0    0    0 2937    0    0    0    0    0]
 [3975    0    0   49    0    0    0   10  952    0    0    0    7    7]
 [1298    0    0 3360    8    0    0    0  308    0    0    0   26    0]
 [1289    0    0 3399    1    0    0    0  201    0    0    0  110    0]
 [4771    0    0   24    0    0    0    0  170   10    0    0   25    0]
 [ 109    0    0  451    0    0    0    0 4440    0    0    0    0    0]
 [ 711    0    0 1005    0    0    0    2 3280    0    0    2    0    0]
 [ 117    0    0   24    0    0    0    1 4858    0    0    0    0    0]
 [ 104    1    0 4667    0    0    0   40  188    0    0    0    0    0]]
Figure(640x480)
[[  18    2    0  640 1881    0    0 2457    1    0    1    0    0    0]
 [   4   18    0  210    2    0    0 4746    7    0    0    0   13    0]
 [ 243    4    0  323   26    0    0 3664    1    0   35  364  340    0]
 [   6   14    0   10    0    0    0 4844    0    0  124    0    1    1]
 [4713    2    0   65    1    0    0  216    0    0    0    0    3    0]
 [   0  214    0  104    0    0    0 1840 2842    0    0    0    0    0]
 [  73    1    0 4248  557    0    0  118    1    0    2    0    0    0]
 [   0  177    0  772    1    0    0   73    0    0 3977    0    0    0]
 [   8   13  257 4128    0    0    0  585    0    0    6    0    2    1]
 [   0  168    0 3485    0    0    0  190 1155    0    2    0    0    0]
 [   0    8    0  220    3    0    0 4561    0    0    0    0  208    0]
 [ 831   44    0   29  271    0    0 2176 1580    0   25   43    1    0]
 [   4    1    0  830   11    0    0 4144    5    0    1    0    4    0]
 [   8    1    0  273 3689    0    0 1028    0    0    1    0    0    0]]
Figure(640x480)
