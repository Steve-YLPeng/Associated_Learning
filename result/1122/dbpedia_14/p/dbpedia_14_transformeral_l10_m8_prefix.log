total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask7//dbpedia_14/dbpedia_14_transformeral_l10_m7_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.045875 (25690/560000), AUC 0.4772292673587799
Test Epoch0 layer0 Acc 0.9739, AUC 0.9982923269271851
Save ckpt to ./ckpt/mask8//dbpedia_14/dbpedia_14_transformeral_l10_m8_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9795142857142857, AUC 0.997499406337738
Test Epoch0 layer2 Acc 0.9796571428571429, AUC 0.9965729713439941
Test Epoch0 layer3 Acc 0.9796, AUC 0.9961010217666626
Test Epoch0 layer4 Acc 0.9795857142857143, AUC 0.9952794313430786
Test Epoch0 layer5 Acc 0.9795428571428572, AUC 0.9949020743370056
Test Epoch0 layer6 Acc 0.9795, AUC 0.9943541288375854
Test Epoch0 layer7 Acc 0.9795285714285714, AUC 0.9945666193962097
Test Epoch0 layer8 Acc 0.14008571428571429, AUC 0.5647487640380859
Test Epoch0 layer9 Acc 0.0696, AUC 0.4777023494243622
gc 0
Train Epoch1 Acc 0.0232 (12992/560000), AUC 0.48094287514686584
Test Epoch1 layer0 Acc 0.9736571428571429, AUC 0.998282790184021
Test Epoch1 layer1 Acc 0.9788285714285714, AUC 0.9975085854530334
Test Epoch1 layer2 Acc 0.9783571428571428, AUC 0.9964688420295715
Test Epoch1 layer3 Acc 0.9782, AUC 0.995775043964386
Test Epoch1 layer4 Acc 0.9781714285714286, AUC 0.9952934980392456
Test Epoch1 layer5 Acc 0.9782142857142857, AUC 0.9947942495346069
Test Epoch1 layer6 Acc 0.9781857142857143, AUC 0.9944772124290466
Test Epoch1 layer7 Acc 0.9782571428571428, AUC 0.9943272471427917
Test Epoch1 layer8 Acc 0.07142857142857142, AUC 0.5228644609451294
Test Epoch1 layer9 Acc 0.0719, AUC 0.4504660665988922
gc 0
Train Epoch2 Acc 0.01083392857142857 (6067/560000), AUC 0.4652336537837982
Test Epoch2 layer0 Acc 0.9738, AUC 0.9982859492301941
Test Epoch2 layer1 Acc 0.9796571428571429, AUC 0.997370183467865
Test Epoch2 layer2 Acc 0.9796428571428571, AUC 0.9962436556816101
Test Epoch2 layer3 Acc 0.9796714285714285, AUC 0.9954342842102051
Test Epoch2 layer4 Acc 0.9795714285714285, AUC 0.9946712851524353
Test Epoch2 layer5 Acc 0.9795571428571429, AUC 0.9942814707756042
Test Epoch2 layer6 Acc 0.9794857142857143, AUC 0.9939097762107849
Test Epoch2 layer7 Acc 0.9794571428571428, AUC 0.9934900999069214
Test Epoch2 layer8 Acc 0.07142857142857142, AUC 0.5428582429885864
Test Epoch2 layer9 Acc 0.0018142857142857142, AUC 0.45093876123428345
gc 0
Train Epoch3 Acc 0.0027767857142857143 (1555/560000), AUC 0.4565792679786682
Test Epoch3 layer0 Acc 0.9738857142857142, AUC 0.9982712864875793
Test Epoch3 layer1 Acc 0.9789857142857142, AUC 0.9972155690193176
Test Epoch3 layer2 Acc 0.9786714285714285, AUC 0.9963245987892151
Test Epoch3 layer3 Acc 0.9785857142857143, AUC 0.9952420592308044
Test Epoch3 layer4 Acc 0.9785142857142857, AUC 0.9946373105049133
Test Epoch3 layer5 Acc 0.9783285714285714, AUC 0.9940493702888489
Test Epoch3 layer6 Acc 0.9783714285714286, AUC 0.9936808943748474
Test Epoch3 layer7 Acc 0.9783142857142857, AUC 0.9935910105705261
Test Epoch3 layer8 Acc 0.07142857142857142, AUC 0.5386528372764587
Test Epoch3 layer9 Acc 0.002857142857142857, AUC 0.4577319622039795
gc 0
Train Epoch4 Acc 0.005251785714285714 (2941/560000), AUC 0.4521481394767761
Test Epoch4 layer0 Acc 0.9738857142857142, AUC 0.9982632398605347
Test Epoch4 layer1 Acc 0.9796, AUC 0.9973429441452026
Test Epoch4 layer2 Acc 0.9792142857142857, AUC 0.9960343241691589
Test Epoch4 layer3 Acc 0.9791571428571428, AUC 0.9953194856643677
Test Epoch4 layer4 Acc 0.9792285714285714, AUC 0.9949361681938171
Test Epoch4 layer5 Acc 0.9791428571428571, AUC 0.9939242005348206
Test Epoch4 layer6 Acc 0.9792, AUC 0.9938370585441589
Test Epoch4 layer7 Acc 0.9791428571428571, AUC 0.993103563785553
Test Epoch4 layer8 Acc 0.07142857142857142, AUC 0.5285401940345764
Test Epoch4 layer9 Acc 0.0015, AUC 0.4533753991127014
gc 0
Train Epoch5 Acc 0.0074375 (4165/560000), AUC 0.4482950270175934
Test Epoch5 layer0 Acc 0.9739, AUC 0.998278796672821
Test Epoch5 layer1 Acc 0.9793857142857143, AUC 0.9972947239875793
Test Epoch5 layer2 Acc 0.9792714285714286, AUC 0.9960160851478577
Test Epoch5 layer3 Acc 0.9791714285714286, AUC 0.9951880574226379
Test Epoch5 layer4 Acc 0.9791428571428571, AUC 0.99481201171875
Test Epoch5 layer5 Acc 0.9792, AUC 0.9940816760063171
Test Epoch5 layer6 Acc 0.9792, AUC 0.9937673807144165
Test Epoch5 layer7 Acc 0.9792, AUC 0.9933654069900513
Test Epoch5 layer8 Acc 0.07142857142857142, AUC 0.5295946002006531
Test Epoch5 layer9 Acc 0.0019714285714285715, AUC 0.4479054808616638
gc 0
Train Epoch6 Acc 0.007889285714285715 (4418/560000), AUC 0.445308655500412
Test Epoch6 layer0 Acc 0.9736285714285714, AUC 0.9982895851135254
Test Epoch6 layer1 Acc 0.9790571428571428, AUC 0.9972257614135742
Test Epoch6 layer2 Acc 0.9788571428571429, AUC 0.9959284067153931
Test Epoch6 layer3 Acc 0.9787428571428571, AUC 0.99506676197052
Test Epoch6 layer4 Acc 0.9788, AUC 0.9946631193161011
Test Epoch6 layer5 Acc 0.9787428571428571, AUC 0.9940199255943298
Test Epoch6 layer6 Acc 0.9788, AUC 0.9938223958015442
Test Epoch6 layer7 Acc 0.9787428571428571, AUC 0.9930657148361206
Test Epoch6 layer8 Acc 0.07142857142857142, AUC 0.5058569312095642
Test Epoch6 layer9 Acc 0.0019857142857142855, AUC 0.4323071539402008
gc 0
Train Epoch7 Acc 0.008801785714285715 (4929/560000), AUC 0.4470495581626892
Test Epoch7 layer0 Acc 0.9736857142857143, AUC 0.9982704520225525
Test Epoch7 layer1 Acc 0.9791142857142857, AUC 0.9971616864204407
Test Epoch7 layer2 Acc 0.9788285714285714, AUC 0.9956574440002441
Test Epoch7 layer3 Acc 0.9788571428571429, AUC 0.9947828054428101
Test Epoch7 layer4 Acc 0.9787714285714286, AUC 0.9942148327827454
Test Epoch7 layer5 Acc 0.9787285714285714, AUC 0.9936578869819641
Test Epoch7 layer6 Acc 0.9786857142857143, AUC 0.9931821823120117
Test Epoch7 layer7 Acc 0.9786714285714285, AUC 0.9925901293754578
Test Epoch7 layer8 Acc 0.07142857142857142, AUC 0.5153704881668091
Test Epoch7 layer9 Acc 0.0023714285714285716, AUC 0.43796056509017944
gc 0
Train Epoch8 Acc 0.009485714285714287 (5312/560000), AUC 0.4475131034851074
Test Epoch8 layer0 Acc 0.9737285714285714, AUC 0.9982937574386597
Save ckpt to ./ckpt/mask8//dbpedia_14/dbpedia_14_transformeral_l10_m8_prefix.pt  ,ep 8
Test Epoch8 layer1 Acc 0.9786428571428571, AUC 0.9970537424087524
Test Epoch8 layer2 Acc 0.9781857142857143, AUC 0.9956327080726624
Test Epoch8 layer3 Acc 0.9780571428571428, AUC 0.9945933222770691
Test Epoch8 layer4 Acc 0.9780142857142857, AUC 0.9939485192298889
Test Epoch8 layer5 Acc 0.9779428571428571, AUC 0.9933347702026367
Test Epoch8 layer6 Acc 0.9779142857142857, AUC 0.9928394556045532
Test Epoch8 layer7 Acc 0.9778714285714286, AUC 0.9920520186424255
Test Epoch8 layer8 Acc 0.07142857142857142, AUC 0.5089349150657654
Test Epoch8 layer9 Acc 0.0014571428571428572, AUC 0.44741836190223694
gc 0
Train Epoch9 Acc 0.008930357142857143 (5001/560000), AUC 0.44763752818107605
Test Epoch9 layer0 Acc 0.9737285714285714, AUC 0.9983041882514954
Save ckpt to ./ckpt/mask8//dbpedia_14/dbpedia_14_transformeral_l10_m8_prefix.pt  ,ep 9
Test Epoch9 layer1 Acc 0.9789857142857142, AUC 0.9971196055412292
Test Epoch9 layer2 Acc 0.9788142857142857, AUC 0.9956707954406738
Test Epoch9 layer3 Acc 0.9787142857142858, AUC 0.994629979133606
Test Epoch9 layer4 Acc 0.9787142857142858, AUC 0.9941391348838806
Test Epoch9 layer5 Acc 0.9786714285714285, AUC 0.993636965751648
Test Epoch9 layer6 Acc 0.9786571428571429, AUC 0.9930664300918579
Test Epoch9 layer7 Acc 0.9786428571428571, AUC 0.9921140074729919
Test Epoch9 layer8 Acc 0.07142857142857142, AUC 0.515974760055542
Test Epoch9 layer9 Acc 0.0018285714285714285, AUC 0.44806745648384094
Best AUC 0.9983041882514954
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask8//dbpedia_14/dbpedia_14_transformeral_l10_m8_prefix.pt
[[4704   40   20   14   11   68   41    7    4    6    4   20   19   42]
 [  36 4895    2    1    7    0   32    8    4    2    1    0    4    8]
 [  39   12 4614   17   48    1   10    4    5    0    1   85   21  143]
 [   4    1   30 4948   12    1    1    0    0    0    0    0    0    3]
 [  12   15   83   12 4844    9    7    2    2    0    0    0    3   11]
 [  36    1    3    4    1 4942    5    2    1    2    0    0    1    2]
 [  63   49    5    3   11   15 4796   37    9    5    1    1    3    2]
 [   0    1    0    0    2    0   13 4961   18    3    1    0    0    1]
 [   1    4    2    0    3    0   11   12 4967    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4955   33    0    0    1]
 [  12    1    0    0    0    0    2    4    0   32 4948    1    0    0]
 [   6    0   35    3    0    0    1    0    0    1    1 4928   15   10]
 [   7    2   24    5    1    3    2    3    1    2    0   23 4884   43]
 [  33    6   87    8   13    3    3    9    1    5    4    7   46 4775]]
Figure(640x480)
[[4744   38   22    4   13   51   56    3    0    1    1   11   13   43]
 [  46 4895    5    1    9    1   33    0    0    1    1    1    1    6]
 [  30   11 4734    9   71    1    9    0    1    0    2   40   19   73]
 [   4    1   16 4959   12    1    0    0    2    0    0    1    2    2]
 [   8    6   66    9 4885    7    7    1    2    1    0    0    2    6]
 [  39    1    2    0    0 4950    3    1    1    0    0    0    1    2]
 [  54   28    3    0    7   10 4857   21    8    4    0    1    2    5]
 [   3    0    0    0    1    0   28 4953   11    4    0    0    0    0]
 [   2    0    1    0    4    0    9   12 4972    0    0    0    0    0]
 [   1    0    1    1    1    1    0    3    0 4969   22    0    0    1]
 [  14    1    0    0    0    2    1    2    0   25 4955    0    0    0]
 [   8    0   35    2    0    0    0    0    0    0    0 4939   12    4]
 [  10    2   13    1    0    0    0    0    0    0    0   21 4910   43]
 [  39    3   76    3    3    4    6    0    0    1    2    8   48 4807]]
Figure(640x480)
[[4740   39   25    3   11   54   60    3    0    1    0   10   12   42]
 [  48 4889    5    0    9    1   37    0    1    1    1    1    1    6]
 [  31    8 4751   10   67    1    5    1    1    0    2   40   19   64]
 [   4    1   13 4962   12    1    0    0    2    0    0    1    2    2]
 [   9   10   68    8 4881    6    5    0    3    1    0    0    2    7]
 [  38    1    1    0    0 4951    3    1    1    0    0    0    1    3]
 [  59   29    3    1    7   10 4853   21    7    1    0    1    2    6]
 [   3    0    0    0    1    0   31 4950   11    4    0    0    0    0]
 [   2    0    1    0    3    0    7   12 4975    0    0    0    0    0]
 [   1    0    1    1    1    1    0    3    0 4967   24    0    0    1]
 [  14    1    0    0    0    1    1    2    0   24 4957    0    0    0]
 [   9    0   40    1    0    0    0    0    0    0    0 4930   15    5]
 [  11    1   12    0    0    0    0    0    0    0    0   21 4910   45]
 [  46    2   75    2    2    4    6    0    0    1    2    8   51 4801]]
Figure(640x480)
[[4738   39   25    3   11   55   61    2    0    1    0   10   13   42]
 [  48 4888    5    0    9    1   38    0    1    1    1    1    1    6]
 [  30    9 4748   10   70    1    5    1    1    0    2   39   19   65]
 [   4    1   13 4961   13    1    0    0    2    0    0    1    2    2]
 [   8    9   67    7 4884    6    5    1    3    1    0    0    2    7]
 [  37    1    1    0    0 4952    3    1    1    0    0    0    1    3]
 [  59   28    3    1    7   10 4853   21    7    2    0    1    2    6]
 [   3    0    0    0    1    0   32 4948   12    4    0    0    0    0]
 [   3    0    1    0    3    0    7   12 4974    0    0    0    0    0]
 [   1    0    1    1    1    1    0    3    0 4967   24    0    0    1]
 [  14    1    0    0    0    1    1    2    0   23 4958    0    0    0]
 [   9    0   40    1    0    0    0    0    0    0    0 4929   15    6]
 [  11    1   12    0    0    0    0    0    0    0    0   21 4910   45]
 [  47    2   74    2    2    4    6    0    0    1    2    8   52 4800]]
Figure(640x480)
[[4738   39   25    3   11   55   60    2    0    1    0   10   14   42]
 [  48 4888    5    0    9    1   38    0    1    1    1    1    1    6]
 [  30    8 4748   10   70    1    5    1    1    0    2   40   19   65]
 [   4    1   13 4960   13    1    0    0    2    0    0    1    3    2]
 [   8    9   67    8 4884    5    6    0    3    1    0    0    2    7]
 [  38    1    1    0    0 4951    3    1    1    0    0    0    1    3]
 [  59   28    3    1    7   10 4853   21    7    2    0    1    2    6]
 [   3    0    0    0    1    0   32 4948   12    4    0    0    0    0]
 [   3    0    1    0    3    0    7   12 4974    0    0    0    0    0]
 [   2    0    1    1    1    1    0    3    0 4966   24    0    0    1]
 [  14    1    0    0    0    1    1    2    0   23 4958    0    0    0]
 [   9    0   40    1    0    0    0    0    0    0    0 4930   15    5]
 [  11    1   12    0    0    0    0    0    0    0    0   21 4910   45]
 [  47    2   72    2    2    4    6    0    0    1    2    8   52 4802]]
Figure(640x480)
[[4737   40   25    3   11   55   59    2    0    1    0   10   14   43]
 [  48 4889    4    1    9    1   37    0    1    1    1    1    1    6]
 [  30    9 4744   10   71    1    6    1    1    0    2   39   19   67]
 [   4    1   13 4961   13    1    0    0    2    0    0    1    2    2]
 [   8   10   67    8 4884    5    4    1    3    1    0    0    2    7]
 [  37    1    1    0    0 4952    3    1    1    0    0    0    1    3]
 [  59   28    3    1    7   11 4852   21    7    2    0    1    2    6]
 [   4    0    0    0    1    0   30 4949   12    4    0    0    0    0]
 [   3    0    1    0    3    0    7   12 4974    0    0    0    0    0]
 [   2    0    1    1    1    1    0    3    0 4965   25    0    0    1]
 [  14    1    0    0    0    1    1    2    0   22 4959    0    0    0]
 [   9    0   40    1    0    0    0    0    0    0    0 4929   15    6]
 [  11    1   12    0    0    0    0    0    0    0    0   21 4910   45]
 [  47    2   72    2    2    4    6    0    0    1    2    7   53 4802]]
Figure(640x480)
[[4737   39   25    3   12   55   59    2    0    1    0   10   14   43]
 [  48 4888    4    1    9    1   38    0    1    1    1    1    1    6]
 [  30    9 4744   10   71    1    6    1    1    0    2   39   19   67]
 [   4    1   13 4961   13    1    0    0    2    0    0    1    2    2]
 [   9    9   67    8 4882    6    5    1    3    1    0    0    2    7]
 [  37    1    1    0    0 4952    3    1    1    0    0    0    1    3]
 [  59   28    3    1    7   11 4852   21    7    2    0    1    2    6]
 [   4    0    0    0    1    0   29 4950   12    4    0    0    0    0]
 [   3    0    1    0    3    0    7   12 4974    0    0    0    0    0]
 [   2    0    1    1    1    1    0    4    0 4964   25    0    0    1]
 [  14    1    0    0    0    1    1    2    0   22 4959    0    0    0]
 [   9    0   40    1    0    0    0    0    0    0    0 4929   15    6]
 [  11    1   11    0    0    0    0    0    0    0    0   21 4911   45]
 [  46    2   72    2    2    4    6    0    0    1    2    8   52 4803]]
Figure(640x480)
[[4734   39   24    3   13   56   59    2    0    1    0   10   15   44]
 [  48 4888    4    1    9    1   38    0    1    1    1    1    1    6]
 [  30    9 4740   10   74    1    7    1    1    0    2   40   19   66]
 [   4    1   13 4961   13    1    0    0    2    0    0    1    2    2]
 [   8    9   65    8 4886    5    5    1    3    1    0    0    2    7]
 [  37    1    1    0    0 4952    3    1    1    0    0    0    1    3]
 [  59   28    3    1    7   11 4852   21    7    2    0    1    2    6]
 [   3    0    0    0    1    0   29 4951   12    4    0    0    0    0]
 [   3    0    1    0    3    0    7   12 4974    0    0    0    0    0]
 [   2    0    1    1    1    1    0    4    0 4964   25    0    0    1]
 [  14    1    0    0    0    1    1    2    0   22 4959    0    0    0]
 [   9    0   40    1    0    0    0    0    0    0    0 4930   15    5]
 [  11    1   11    1    0    0    0    0    0    0    0   20 4911   45]
 [  46    2   72    2    2    4    6    0    0    1    2    7   53 4803]]
Figure(640x480)
[[   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]
 [   0 5000    0    0    0    0    0    0    0    0    0    0    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0 4892    0    0    0  108]
 [   0    0    0    0    0    0    0    0    0 4987    0    0    0   13]
 [   0    0    0    0    0    0    0    0    0  177    0    0    0 4823]
 [   0    0    0    0    0    0    0    0    0 4983    0    0    0   17]
 [   0    0    0    0    0    0    0    0    0 4907    0    0    0   93]
 [   0    0    0    0    0    0    0    0    0   46    0    0    0 4954]
 [   0    0    0    0    0    0    0    0    0 4964    0    0    0   36]
 [   0    0    0    0    0    0    0    0    0   71    0    0    0 4929]
 [   0    0    0    0    0    0    0    0    0 4992    0    0    0    8]
 [   0    0    0    0    0    0    0    0    0    7    0    0    0 4993]
 [   0    0    0    0    0    0    0    0    0   22    0    0    0 4978]
 [   0    0    0    0    0    0    0    0    0   14    0    0    0 4986]
 [   0    0    0    0    0    0    0    0    0   79    0    0    0 4921]
 [   0    0    0    0    0    0    0    0    0 4879    0    0    0  121]]
Figure(640x480)
