total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask3//dbpedia_14/dbpedia_14_transformeral_l10_m3_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.05393214285714286 (30202/560000), AUC 0.5150013566017151
Test Epoch0 layer0 Acc 0.9735142857142857, AUC 0.9982973337173462
Save ckpt to ./ckpt/mask4//dbpedia_14/dbpedia_14_transformeral_l10_m4_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9791857142857143, AUC 0.9978283643722534
Test Epoch0 layer2 Acc 0.9793714285714286, AUC 0.9976457357406616
Test Epoch0 layer3 Acc 0.9793142857142857, AUC 0.9976342916488647
Test Epoch0 layer4 Acc 0.08432857142857143, AUC 0.5061042308807373
Test Epoch0 layer5 Acc 0.07142857142857142, AUC 0.5228848457336426
Test Epoch0 layer6 Acc 0.014228571428571429, AUC 0.5113683342933655
Test Epoch0 layer7 Acc 0.1384, AUC 0.5032879710197449
Test Epoch0 layer8 Acc 0.07125714285714285, AUC 0.5273343324661255
Test Epoch0 layer9 Acc 0.06037142857142857, AUC 0.5140274167060852
gc 0
Train Epoch1 Acc 0.08041071428571428 (45030/560000), AUC 0.5284669399261475
Test Epoch1 layer0 Acc 0.9736142857142858, AUC 0.9982768893241882
Test Epoch1 layer1 Acc 0.9793, AUC 0.9978570342063904
Test Epoch1 layer2 Acc 0.9791714285714286, AUC 0.9974681735038757
Test Epoch1 layer3 Acc 0.9792571428571428, AUC 0.9972812533378601
Test Epoch1 layer4 Acc 0.07317142857142857, AUC 0.5519131422042847
Test Epoch1 layer5 Acc 0.07167142857142857, AUC 0.5471311211585999
Test Epoch1 layer6 Acc 0.07308571428571428, AUC 0.5054411292076111
Test Epoch1 layer7 Acc 0.1382142857142857, AUC 0.41259828209877014
Test Epoch1 layer8 Acc 0.07171428571428572, AUC 0.4486813545227051
Test Epoch1 layer9 Acc 0.0035571428571428572, AUC 0.5513489842414856
gc 0
Train Epoch2 Acc 0.0029821428571428573 (1670/560000), AUC 0.5659616589546204
Test Epoch2 layer0 Acc 0.9741285714285715, AUC 0.998278021812439
Test Epoch2 layer1 Acc 0.9789571428571429, AUC 0.9977127313613892
Test Epoch2 layer2 Acc 0.9790714285714286, AUC 0.9971417784690857
Test Epoch2 layer3 Acc 0.9788714285714286, AUC 0.9969473481178284
Test Epoch2 layer4 Acc 0.0715, AUC 0.5310674905776978
Test Epoch2 layer5 Acc 0.0716, AUC 0.5095722079277039
Test Epoch2 layer6 Acc 0.07158571428571428, AUC 0.5120851993560791
Test Epoch2 layer7 Acc 0.20485714285714285, AUC 0.44806522130966187
Test Epoch2 layer8 Acc 0.07344285714285714, AUC 0.4369857907295227
Test Epoch2 layer9 Acc 0.0016714285714285713, AUC 0.5930768847465515
gc 0
Train Epoch3 Acc 0.0018589285714285715 (1041/560000), AUC 0.5842474699020386
Test Epoch3 layer0 Acc 0.9737571428571429, AUC 0.9982649683952332
Test Epoch3 layer1 Acc 0.9787714285714286, AUC 0.9976863265037537
Test Epoch3 layer2 Acc 0.9789142857142857, AUC 0.996947705745697
Test Epoch3 layer3 Acc 0.9788857142857142, AUC 0.9967179894447327
Test Epoch3 layer4 Acc 0.07158571428571428, AUC 0.5257659554481506
Test Epoch3 layer5 Acc 0.07157142857142858, AUC 0.4877126216888428
Test Epoch3 layer6 Acc 0.13642857142857143, AUC 0.5156351923942566
Test Epoch3 layer7 Acc 0.18598571428571428, AUC 0.4548344612121582
Test Epoch3 layer8 Acc 0.13317142857142858, AUC 0.4830038547515869
Test Epoch3 layer9 Acc 0.0014857142857142857, AUC 0.5881034731864929
gc 0
Train Epoch4 Acc 0.003 (1680/560000), AUC 0.5900335907936096
Test Epoch4 layer0 Acc 0.9737428571428571, AUC 0.9982765316963196
Test Epoch4 layer1 Acc 0.9789857142857142, AUC 0.9975663423538208
Test Epoch4 layer2 Acc 0.9790857142857143, AUC 0.996711254119873
Test Epoch4 layer3 Acc 0.9789285714285715, AUC 0.996310293674469
Test Epoch4 layer4 Acc 0.0715, AUC 0.541224479675293
Test Epoch4 layer5 Acc 0.07147142857142857, AUC 0.4926413893699646
Test Epoch4 layer6 Acc 0.13804285714285713, AUC 0.5284759402275085
Test Epoch4 layer7 Acc 0.1378, AUC 0.4594790041446686
Test Epoch4 layer8 Acc 0.20897142857142856, AUC 0.5293135643005371
Test Epoch4 layer9 Acc 0.0016, AUC 0.576072633266449
gc 0
Train Epoch5 Acc 0.003417857142857143 (1914/560000), AUC 0.589340090751648
Test Epoch5 layer0 Acc 0.9734285714285714, AUC 0.9982953071594238
Test Epoch5 layer1 Acc 0.979, AUC 0.9975165724754333
Test Epoch5 layer2 Acc 0.9791142857142857, AUC 0.9967350959777832
Test Epoch5 layer3 Acc 0.9790857142857143, AUC 0.9962501525878906
Test Epoch5 layer4 Acc 0.07151428571428571, AUC 0.5314440727233887
Test Epoch5 layer5 Acc 0.07144285714285714, AUC 0.4676716923713684
Test Epoch5 layer6 Acc 0.13702857142857142, AUC 0.5272411704063416
Test Epoch5 layer7 Acc 0.13685714285714284, AUC 0.47219130396842957
Test Epoch5 layer8 Acc 0.16852857142857142, AUC 0.5261313319206238
Test Epoch5 layer9 Acc 0.0014, AUC 0.5740477442741394
gc 0
Train Epoch6 Acc 0.0039 (2184/560000), AUC 0.5889226794242859
Test Epoch6 layer0 Acc 0.9739714285714286, AUC 0.9982843399047852
Test Epoch6 layer1 Acc 0.9793142857142857, AUC 0.997477650642395
Test Epoch6 layer2 Acc 0.9793571428571428, AUC 0.9964920282363892
Test Epoch6 layer3 Acc 0.9792714285714286, AUC 0.996034562587738
Test Epoch6 layer4 Acc 0.07158571428571428, AUC 0.5255110859870911
Test Epoch6 layer5 Acc 0.07142857142857142, AUC 0.4621981680393219
Test Epoch6 layer6 Acc 0.13768571428571427, AUC 0.5419520735740662
Test Epoch6 layer7 Acc 0.13711428571428572, AUC 0.4841346740722656
Test Epoch6 layer8 Acc 0.13894285714285715, AUC 0.5496250987052917
Test Epoch6 layer9 Acc 0.0014, AUC 0.5769732594490051
gc 0
Train Epoch7 Acc 0.0039625 (2219/560000), AUC 0.5887498259544373
Test Epoch7 layer0 Acc 0.9738857142857142, AUC 0.9982873797416687
Test Epoch7 layer1 Acc 0.9792857142857143, AUC 0.9974499940872192
Test Epoch7 layer2 Acc 0.9795, AUC 0.9963527321815491
Test Epoch7 layer3 Acc 0.9794857142857143, AUC 0.9958744645118713
Test Epoch7 layer4 Acc 0.07138571428571429, AUC 0.5180363655090332
Test Epoch7 layer5 Acc 0.07142857142857142, AUC 0.46678614616394043
Test Epoch7 layer6 Acc 0.13812857142857143, AUC 0.5463337302207947
Test Epoch7 layer7 Acc 0.13782857142857144, AUC 0.48655062913894653
Test Epoch7 layer8 Acc 0.13927142857142857, AUC 0.5378707647323608
Test Epoch7 layer9 Acc 0.001257142857142857, AUC 0.5817849040031433
gc 0
Train Epoch8 Acc 0.004289285714285714 (2402/560000), AUC 0.5876081585884094
Test Epoch8 layer0 Acc 0.9738714285714286, AUC 0.9982872605323792
Test Epoch8 layer1 Acc 0.9793714285714286, AUC 0.9974628686904907
Test Epoch8 layer2 Acc 0.9792, AUC 0.9963032603263855
Test Epoch8 layer3 Acc 0.9790857142857143, AUC 0.9959056973457336
Test Epoch8 layer4 Acc 0.07138571428571429, AUC 0.5108513832092285
Test Epoch8 layer5 Acc 0.07142857142857142, AUC 0.46930789947509766
Test Epoch8 layer6 Acc 0.1377142857142857, AUC 0.54799884557724
Test Epoch8 layer7 Acc 0.13787142857142856, AUC 0.4904307425022125
Test Epoch8 layer8 Acc 0.13908571428571428, AUC 0.5434944033622742
Test Epoch8 layer9 Acc 0.0014571428571428572, AUC 0.578230082988739
gc 0
Train Epoch9 Acc 0.004428571428571428 (2480/560000), AUC 0.5850604772567749
Test Epoch9 layer0 Acc 0.9734428571428572, AUC 0.9982872605323792
Test Epoch9 layer1 Acc 0.9793142857142857, AUC 0.9974270462989807
Test Epoch9 layer2 Acc 0.9792, AUC 0.9961767792701721
Test Epoch9 layer3 Acc 0.9792857142857143, AUC 0.9954195618629456
Test Epoch9 layer4 Acc 0.0714, AUC 0.5123037099838257
Test Epoch9 layer5 Acc 0.07142857142857142, AUC 0.47742655873298645
Test Epoch9 layer6 Acc 0.13837142857142856, AUC 0.556991457939148
Test Epoch9 layer7 Acc 0.13822857142857142, AUC 0.4961305260658264
Test Epoch9 layer8 Acc 0.13912857142857143, AUC 0.5439707636833191
Test Epoch9 layer9 Acc 0.0014285714285714286, AUC 0.5734667778015137
Best AUC 0.9982973337173462
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//dbpedia_14/dbpedia_14_transformeral_l10_m4_prefix.pt
[[4705   40   20   15   11   70   39    8    4    5    5   18   19   41]
 [  33 4905    2    1    7    0   28    6    4    2    1    0    3    8]
 [  42   14 4603   19   48    1   10    4    6    0    1   84   20  148]
 [   5    1   28 4952   11    0    1    0    0    0    0    0    0    2]
 [  11   20   82   13 4841    9    6    1    2    1    0    1    2   11]
 [  35    1    3    3    1 4942    5    4    1    2    0    0    1    2]
 [  65   49    5    3   11   17 4789   38    9    5    1    1    5    2]
 [   0    1    0    0    2    0   12 4963   17    3    1    0    0    1]
 [   2    4    2    0    3    0   10   14 4965    0    0    0    0    0]
 [   1    0    1    3    1    0    0    8    0 4946   39    0    0    1]
 [  13    1    0    0    0    0    2    4    0   32 4948    0    0    0]
 [   8    0   38    3    0    0    0    0    0    1    1 4920   17   12]
 [   8    2   22    6    1    3    1    3    1    4    0   25 4874   50]
 [  34    7   76    7   11    3    4    9    1    4    3    7   41 4793]]
Figure(640x480)
[[4762   43   13    8   11   43   40    3    0    3    2   17   17   38]
 [  42 4922    0    0    7    0   21    0    0    1    0    0    0    7]
 [  38   11 4708   11   52    1    8    1    2    0    3   52   24   89]
 [   5    1   18 4959   12    0    1    1    0    0    0    0    1    2]
 [   8   13   66   13 4877    4    5    1    1    2    0    0    3    7]
 [  41    0    3    0    0 4943    4    3    1    0    0    1    3    1]
 [  58   54    3    2    7   10 4829   21    5    4    0    1    4    2]
 [   4    4    0    0    1    0   19 4953   13    3    1    0    1    1]
 [   4    3    1    0    4    0   10    8 4969    0    0    0    0    1]
 [   1    0    1    1    1    0    0    6    0 4959   30    0    0    1]
 [  12    2    0    0    0    0    1    3    0   28 4954    0    0    0]
 [   8    0   28    2    0    0    0    0    0    0    0 4944   10    8]
 [   8    1   12    0    0    1    0    0    0    0    0   22 4919   37]
 [  34    4   52    3    4    2    2    0    0    0    2    9   43 4845]]
Figure(640x480)
[[4773   43   12    6   11   43   41    3    0    3    2   13   15   35]
 [  41 4922    0    0    7    0   22    0    0    1    0    0    1    6]
 [  41    8 4718   11   51    1    8    1    3    0    3   47   23   85]
 [   5    1   19 4959   12    0    0    1    0    0    0    0    1    2]
 [   8   13   68   12 4874    4    6    0    2    2    0    0    3    8]
 [  41    0    3    0    0 4942    5    3    1    0    0    1    3    1]
 [  57   50    2    1    7    9 4838   21    5    3    0    1    4    2]
 [   4    3    0    0    1    0   21 4951   15    3    0    0    1    1]
 [   4    2    1    0    4    0    9    8 4971    0    0    0    0    1]
 [   1    0    1    1    1    0    0    6    0 4956   32    0    0    2]
 [  12    2    0    0    0    1    1    2    0   28 4954    0    0    0]
 [  10    0   32    2    0    0    0    0    0    0    0 4936   11    9]
 [  10    1   11    0    0    1    0    0    0    0    0   21 4919   37]
 [  36    3   54    3    4    2    2    1    0    0    1    8   43 4843]]
Figure(640x480)
[[4772   43   12    7   11   43   41    3    0    3    2   13   15   35]
 [  41 4922    0    0    7    0   22    0    0    1    0    0    1    6]
 [  41    8 4720   10   51    1    8    1    2    0    3   46   23   86]
 [   5    1   22 4956   12    0    0    1    0    0    0    0    1    2]
 [   8   13   68   12 4874    4    6    0    2    2    0    0    3    8]
 [  41    0    2    0    0 4944    4    3    1    0    0    1    3    1]
 [  59   50    2    1    7    9 4836   21    4    4    0    1    4    2]
 [   4    3    0    0    1    0   22 4950   15    3    0    0    1    1]
 [   4    2    1    0    4    0    9    8 4971    0    0    0    0    1]
 [   1    0    1    1    1    0    0    6    0 4956   32    0    0    2]
 [  12    2    0    0    0    1    1    2    0   28 4954    0    0    0]
 [  10    0   34    2    0    0    0    0    0    0    0 4934   11    9]
 [  10    1   11    0    0    1    0    0    0    0    0   21 4919   37]
 [  36    3   54    3    4    2    2    0    0    0    1    8   43 4844]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0   40    0    0    9 4951]
 [   0    0    0    0    0    0    0    0    0 4839    0    0    0  161]
 [   0    0    0    0    0    0    0    0    0    1    0    0   23 4976]
 [   0    0    0    0    0    0    0    0    0    1    0    0    0 4999]
 [   0    0    0    0    0    0    0    0    0    5    0    0    0 4995]
 [   0    0    0    0    0    0    0    0    0 4313    0    0    0  687]
 [   0    0    0    0    0    0    0    0    0   25    0    4    0 4971]
 [   0    0    0    0    0    0    0    0    0   16    0 4649    0  335]
 [   0    0    0    0    0    0    0    0    0    0    0    2    0 4998]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 5000]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 5000]
 [   0    0    0    0    0    0    0    0    0    0    0    0 4876  124]
 [   0    0    0    0    0    0    0    0    0    1    0    0  911 4088]
 [   0    0    0    0    0    0    0    0    0    1    0    0    7 4992]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]]
Figure(640x480)
[[   0    0    0    0    1    0    0   21    0    0    0    0    0 4978]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 5000]
 [   1    0    0    0    0    0    0   24    0    0    0    0    0 4975]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 5000]
 [   0    0    0    0    0    0    0    1    0    0    0    0    0 4999]
 [   0    0    0    0    0    0    0 4693    0    0    0    0    0  307]
 [   1    0    0    0   14    0    0  131    0    0    0    0    0 4854]
 [   2    0    0    0 4927    0    0   17    0    0    0    0    0   54]
 [   0    0    0    0    8    0    0    1    0    0  173    0    0 4818]
 [   0    0    0    0    4    0    0    0    0    0    0    0    0 4996]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0 5000]
 [   0    0    0    0    2    0    0    0    0    0    0    0    0 4998]
 [  19    0    0    0    0    0    0 4103    0    0    0    0    0  878]
 [   0    0    0    0    0    0    0 4021    0    0    0    0    0  979]]
Figure(640x480)
[[4871    0   98    0    0    0    0    0    0    0   31    0    0    0]
 [ 112    0 4879    0    0    0    0    0    0    0    9    0    0    0]
 [ 176    0 4816    0    0    0    0    0    0    0    8    0    0    0]
 [4972    0   27    0    0    0    0    0    0    0    1    0    0    0]
 [4265    0  730    0    0    0    0    0    0    0    5    0    0    0]
 [  67    0    9    0    0    0    0    0    0    0 4924    0    0    0]
 [ 120    0 4864    0    0    0    0    0    0    0   16    0    0    0]
 [4947    0   11    0    0    0    0    0    0    0   42    0    0    0]
 [  22    0    8    0    0    0    0    0    0    0 4970    0    0    0]
 [4999    0    1    0    0    0    0    0    0    0    0    0    0    0]
 [4997    0    2    0    0    0    0    0    0    0    1    0    0    0]
 [1487    0 3470    0    0    0    0    0    0    0   43    0    0    0]
 [4967    0   31    0    0    0    0    0    0    0    2    0    0    0]
 [4914    0   68    0    0    0    0    0    0    0   18    0    0    0]]
Figure(640x480)
[[   0    0    0 4542    0    0    0    0  458    0    0    0    0    0]
 [   0    0    0 1547    0    0    0    0 3453    0    0    0    0    0]
 [   0    0    0   36    0    0    0    0 4964    0    0    0    0    0]
 [   0    0    0 4958    0    0    0    0   42    0    0    0    0    0]
 [   0    0    0   15    0    0    0    0 4985    0    0    0    0    0]
 [   0    0    0   22    0    0    0    0 4978    0    0    0    0    0]
 [   0    0    0  189    0    0    0    0 4811    0    0    0    0    0]
 [   0    0    0   12    0    0    0    0 4988    0    0    0    0    0]
 [   0    0    0 4970    0    0    0    0   30    0    0    0    0    0]
 [   0    0    0    4    0    0    0    0 4996    0    0    0    0    0]
 [   0    0    0    9    0    0    0    0 4991    0    0    0    0    0]
 [   0    0    0    7    0    0    0    0 4993    0    0    0    0    0]
 [   0    0    0 4722    0    0    0    0  278    0    0    0    0    0]
 [   0    0    0   15    0    0    0    0 4985    0    0    0    0    0]]
Figure(640x480)
[[   0    0 3865    0    0    0   82    0 1053    0    0    0    0    0]
 [   0    0    8    0    0    0 4251    0  741    0    0    0    0    0]
 [   0    0    9    0    0    0 4790    0  201    0    0    0    0    0]
 [   0    0    1    0    0    0 4977    0   22    0    0    0    0    0]
 [   0    0    1    0    0    0   75    0 4924    0    0    0    0    0]
 [   0    0    5    0    0    0    4    0 4991    0    0    0    0    0]
 [   0    0   10    0    0    0 4141    0  849    0    0    0    0    0]
 [   0    0    3    0    0    0    2    0 4995    0    0    0    0    0]
 [   0    0 4896    0    0    0   28    0   76    0    0    0    0    0]
 [   0    0    1    0    0    0 4948    0   51    0    0    0    0    0]
 [   0    0    5    0    0    0   89    0 4906    0    0    0    0    0]
 [   0    0    0    0    0    0  353    0 4647    0    0    0    0    0]
 [   0    0 4156    0    0    0  797    0   47    0    0    0    0    0]
 [   0    0    4    0    0    0  135    0 4861    0    0    0    0    0]]
Figure(640x480)
