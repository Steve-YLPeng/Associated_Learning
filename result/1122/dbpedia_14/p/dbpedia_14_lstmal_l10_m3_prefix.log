total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l10_m2_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.07142857142857142 (40000/560000), AUC 0.5602782368659973
Test Epoch0 layer0 Acc 0.9739571428571429, AUC 0.9982745051383972
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l10_m3_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9853857142857143, AUC 0.9985991716384888
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l10_m3_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.985, AUC 0.9985653758049011
Test Epoch0 layer3 Acc 0.07661428571428572, AUC 0.4769020974636078
Test Epoch0 layer4 Acc 0.061385714285714287, AUC 0.4873602092266083
Test Epoch0 layer5 Acc 0.07701428571428572, AUC 0.45371007919311523
Test Epoch0 layer6 Acc 0.13642857142857143, AUC 0.5169611573219299
Test Epoch0 layer7 Acc 0.07132857142857142, AUC 0.4752061665058136
Test Epoch0 layer8 Acc 0.07142857142857142, AUC 0.4785657525062561
Test Epoch0 layer9 Acc 0.07142857142857142, AUC 0.5403333306312561
gc 0
Train Epoch1 Acc 0.07142857142857142 (40000/560000), AUC 0.53793865442276
Test Epoch1 layer0 Acc 0.9739285714285715, AUC 0.9982873201370239
Test Epoch1 layer1 Acc 0.9857857142857143, AUC 0.9986849427223206
Save ckpt to ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l10_m3_prefix.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9857285714285714, AUC 0.9984881281852722
Test Epoch1 layer3 Acc 0.06637142857142857, AUC 0.4892055094242096
Test Epoch1 layer4 Acc 0.05027142857142857, AUC 0.4871314465999603
Test Epoch1 layer5 Acc 0.07837142857142858, AUC 0.4660380482673645
Test Epoch1 layer6 Acc 0.1095, AUC 0.5334588885307312
Test Epoch1 layer7 Acc 0.07141428571428571, AUC 0.4734293520450592
Test Epoch1 layer8 Acc 0.07142857142857142, AUC 0.46661949157714844
Test Epoch1 layer9 Acc 0.07142857142857142, AUC 0.5421594381332397
gc 0
Train Epoch2 Acc 0.07142857142857142 (40000/560000), AUC 0.5376502275466919
Test Epoch2 layer0 Acc 0.9738285714285714, AUC 0.9982529878616333
Test Epoch2 layer1 Acc 0.9859142857142857, AUC 0.9984903931617737
Test Epoch2 layer2 Acc 0.9858142857142858, AUC 0.9984325170516968
Test Epoch2 layer3 Acc 0.06775714285714286, AUC 0.4981049597263336
Test Epoch2 layer4 Acc 0.03812857142857143, AUC 0.4825383722782135
Test Epoch2 layer5 Acc 0.0858, AUC 0.4711446166038513
Test Epoch2 layer6 Acc 0.09195714285714286, AUC 0.5465349555015564
Test Epoch2 layer7 Acc 0.07142857142857142, AUC 0.47726255655288696
Test Epoch2 layer8 Acc 0.07142857142857142, AUC 0.4688173830509186
Test Epoch2 layer9 Acc 0.07142857142857142, AUC 0.5374347567558289
gc 0
Train Epoch3 Acc 0.07142857142857142 (40000/560000), AUC 0.5421338081359863
Test Epoch3 layer0 Acc 0.9736285714285714, AUC 0.9982737302780151
Test Epoch3 layer1 Acc 0.9861285714285715, AUC 0.9986189007759094
Test Epoch3 layer2 Acc 0.9860142857142857, AUC 0.9984421133995056
Test Epoch3 layer3 Acc 0.07007142857142858, AUC 0.4990234076976776
Test Epoch3 layer4 Acc 0.027285714285714285, AUC 0.4868907928466797
Test Epoch3 layer5 Acc 0.05392857142857143, AUC 0.4614172875881195
Test Epoch3 layer6 Acc 0.0772, AUC 0.5478473901748657
Test Epoch3 layer7 Acc 0.07142857142857142, AUC 0.4772406220436096
Test Epoch3 layer8 Acc 0.07142857142857142, AUC 0.45875558257102966
Test Epoch3 layer9 Acc 0.07142857142857142, AUC 0.5446609854698181
gc 0
Train Epoch4 Acc 0.07142857142857142 (40000/560000), AUC 0.5477688908576965
Test Epoch4 layer0 Acc 0.9734857142857143, AUC 0.9982781410217285
Test Epoch4 layer1 Acc 0.9852285714285715, AUC 0.9983725547790527
Test Epoch4 layer2 Acc 0.9851714285714286, AUC 0.9982505440711975
Test Epoch4 layer3 Acc 0.06882857142857143, AUC 0.4977286458015442
Test Epoch4 layer4 Acc 0.03622857142857143, AUC 0.48411399126052856
Test Epoch4 layer5 Acc 0.031857142857142855, AUC 0.4643551707267761
Test Epoch4 layer6 Acc 0.07138571428571429, AUC 0.5501163601875305
Test Epoch4 layer7 Acc 0.07142857142857142, AUC 0.48234230279922485
Test Epoch4 layer8 Acc 0.07142857142857142, AUC 0.46318092942237854
Test Epoch4 layer9 Acc 0.07142857142857142, AUC 0.5417339205741882
gc 0
Train Epoch5 Acc 0.07142857142857142 (40000/560000), AUC 0.5461401343345642
Test Epoch5 layer0 Acc 0.9735571428571429, AUC 0.9982959032058716
Test Epoch5 layer1 Acc 0.9857857142857143, AUC 0.9983795285224915
Test Epoch5 layer2 Acc 0.9858428571428571, AUC 0.9983091950416565
Test Epoch5 layer3 Acc 0.06997142857142857, AUC 0.49142494797706604
Test Epoch5 layer4 Acc 0.025942857142857143, AUC 0.48304763436317444
Test Epoch5 layer5 Acc 0.04137142857142857, AUC 0.4635653495788574
Test Epoch5 layer6 Acc 0.0723, AUC 0.5523428320884705
Test Epoch5 layer7 Acc 0.07142857142857142, AUC 0.48542195558547974
Test Epoch5 layer8 Acc 0.07142857142857142, AUC 0.457798570394516
Test Epoch5 layer9 Acc 0.07142857142857142, AUC 0.5503164529800415
gc 0
Train Epoch6 Acc 0.07142857142857142 (40000/560000), AUC 0.5500431060791016
Test Epoch6 layer0 Acc 0.9738857142857142, AUC 0.9983095526695251
Test Epoch6 layer1 Acc 0.9860285714285715, AUC 0.9982820153236389
Test Epoch6 layer2 Acc 0.9860142857142857, AUC 0.998195230960846
Test Epoch6 layer3 Acc 0.06914285714285714, AUC 0.4924710690975189
Test Epoch6 layer4 Acc 0.026557142857142856, AUC 0.48279187083244324
Test Epoch6 layer5 Acc 0.022014285714285715, AUC 0.4677109122276306
Test Epoch6 layer6 Acc 0.07235714285714286, AUC 0.5531131625175476
Test Epoch6 layer7 Acc 0.07142857142857142, AUC 0.48758286237716675
Test Epoch6 layer8 Acc 0.07142857142857142, AUC 0.4578949511051178
Test Epoch6 layer9 Acc 0.07142857142857142, AUC 0.5482364892959595
gc 0
Train Epoch7 Acc 0.07142857142857142 (40000/560000), AUC 0.552873969078064
Test Epoch7 layer0 Acc 0.9735428571428572, AUC 0.9982814788818359
Test Epoch7 layer1 Acc 0.9857428571428571, AUC 0.9982375502586365
Test Epoch7 layer2 Acc 0.9856428571428572, AUC 0.9980577826499939
Test Epoch7 layer3 Acc 0.06945714285714286, AUC 0.4911564290523529
Test Epoch7 layer4 Acc 0.020657142857142857, AUC 0.4858943521976471
Test Epoch7 layer5 Acc 0.006571428571428572, AUC 0.46524277329444885
Test Epoch7 layer6 Acc 0.0721, AUC 0.5574097037315369
Test Epoch7 layer7 Acc 0.07142857142857142, AUC 0.4904007315635681
Test Epoch7 layer8 Acc 0.07142857142857142, AUC 0.4558727443218231
Test Epoch7 layer9 Acc 0.07142857142857142, AUC 0.5492865443229675
gc 0
Train Epoch8 Acc 0.07142857142857142 (40000/560000), AUC 0.5524996519088745
Test Epoch8 layer0 Acc 0.9737285714285714, AUC 0.9983039498329163
Test Epoch8 layer1 Acc 0.9858857142857143, AUC 0.9981945753097534
Test Epoch8 layer2 Acc 0.9859, AUC 0.9980786442756653
Test Epoch8 layer3 Acc 0.07047142857142857, AUC 0.4917576014995575
Test Epoch8 layer4 Acc 0.019042857142857143, AUC 0.48524314165115356
Test Epoch8 layer5 Acc 0.010628571428571428, AUC 0.4686155617237091
Test Epoch8 layer6 Acc 0.07187142857142857, AUC 0.5608122944831848
Test Epoch8 layer7 Acc 0.07144285714285714, AUC 0.4910476803779602
Test Epoch8 layer8 Acc 0.07142857142857142, AUC 0.45651572942733765
Test Epoch8 layer9 Acc 0.07142857142857142, AUC 0.5511855483055115
gc 0
Train Epoch9 Acc 0.07142857142857142 (40000/560000), AUC 0.5542029142379761
Test Epoch9 layer0 Acc 0.9734571428571429, AUC 0.9982928037643433
Test Epoch9 layer1 Acc 0.9859571428571429, AUC 0.9980921745300293
Test Epoch9 layer2 Acc 0.9858, AUC 0.9979590177536011
Test Epoch9 layer3 Acc 0.06982857142857143, AUC 0.49496108293533325
Test Epoch9 layer4 Acc 0.017028571428571428, AUC 0.483143150806427
Test Epoch9 layer5 Acc 0.0175, AUC 0.4687868654727936
Test Epoch9 layer6 Acc 0.07172857142857143, AUC 0.5581061840057373
Test Epoch9 layer7 Acc 0.07142857142857142, AUC 0.491020530462265
Test Epoch9 layer8 Acc 0.07142857142857142, AUC 0.4552347958087921
Test Epoch9 layer9 Acc 0.07142857142857142, AUC 0.5532658696174622
Best AUC 0.9986849427223206
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//dbpedia_14/dbpedia_14_lstmal_l10_m3_prefix.pt
[[4701   37   21   15   11   71   39    8    4    6    6   19   15   47]
 [  39 4891    3    1    7    0   28   10    5    2    1    0    5    8]
 [  36   11 4604   18   55    1    9    4    5    0    1   75   20  161]
 [   3    2   27 4952   12    0    1    0    0    0    0    0    0    3]
 [  11   16   77   12 4851    7    5    1    2    0    0    0    2   16]
 [  35    1    3    3    1 4944    5    2    1    2    0    0    1    2]
 [  66   49    6    3   10   15 4785   40   12    5    1    1    3    4]
 [   0    0    0    0    2    0   11 4965   17    3    1    0    0    1]
 [   1    3    2    0    3    0    9   13 4969    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4952   36    0    0    1]
 [  12    1    0    0    0    0    2    4    0   29 4952    0    0    0]
 [   5    0   43    2    0    0    0    0    0    0    0 4922   15   13]
 [  11    2   26    7    2    3    1    3    1    2    0   20 4871   51]
 [  29    3   65    7   12    3    3    9    1    4    2    6   40 4816]]
Figure(640x480)
[[4827   28   12    1   12   28   42    2    1    2    1    5    5   34]
 [  48 4910    1    0   11    0   22    1    1    1    0    0    0    5]
 [  16    3 4874    6   53    1    2    0    0    1    0   10    6   28]
 [   2    1   21 4959   15    0    0    0    0    0    0    1    1    0]
 [   6    3   79    6 4890    3    3    0    0    3    0    0    2    5]
 [  27    0    1    0    1 4959    5    1    1    2    0    0    2    1]
 [  55   31    3    0    2   11 4868   17    6    2    1    0    1    3]
 [   0    0    0    0    0    2   13 4974    7    2    1    0    0    1]
 [   2    1    1    0    2    0    4    5 4983    1    0    0    0    1]
 [   1    0    0    1    0    0    0    1    0 4971   26    0    0    0]
 [  14    1    0    0    0    0    1    1    0   19 4964    0    0    0]
 [   3    0   11    1    0    0    1    0    0    0    0 4969    9    6]
 [   5    1    2    0    0    1    0    0    0    0    0   18 4935   38]
 [  26    1   18    1    5    2    2    0    0    0    2    7   14 4922]]
Figure(640x480)
[[4820   29   12    1   13   30   43    2    1    2    1    6    5   35]
 [  49 4907    1    0   11    0   23    1    1    1    0    1    0    5]
 [  16    3 4877    6   50    1    2    0    0    1    0   10    6   28]
 [   3    1   24 4956   15    0    0    0    0    0    0    0    1    0]
 [   6    3   79    6 4889    3    2    1    0    3    0    0    3    5]
 [  26    0    1    0    1 4961    5    1    1    1    0    0    2    1]
 [  55   31    3    0    3   11 4866   18    7    2    0    0    1    3]
 [   0    0    0    0    0    1   12 4975    8    2    1    0    0    1]
 [   2    1    1    0    1    0    4    6 4983    1    0    0    0    1]
 [   1    0    0    1    0    0    0    1    0 4971   26    0    0    0]
 [  14    1    0    0    1    0    1    0    0   20 4963    0    0    0]
 [   3    0    9    1    0    0    1    0    0    0    0 4972    8    6]
 [   5    0    2    0    0    1    0    0    0    0    0   18 4936   38]
 [  26    1   18    1    4    2    1    0    0    0    1    7   14 4925]]
Figure(640x480)
[[  41    0    0    0 4760    0   72    0    0    0   97   10    0   20]
 [   0    0    0    0   48    0   10    1    0    0   78 2701    0 2162]
 [  15    0    0    0   10    0 2204    1    0    0 2759    8    0    3]
 [   1    0    0    0    1    0 4977    0    0    0   19    1    0    1]
 [   3    0    0    0    3    0   34  503    0    0 1132 3323    0    2]
 [  24    0    0    0   25    0 4928    0    0    0    4   16    0    3]
 [  13    0    0    0   77    0   19   24    0    0 4832    5    0   30]
 [   3    0    0    0   15    0    4    1    0    0   27    0    0 4950]
 [   0    0    0    0 4217    0    1    2    0    0  765    7    0    8]
 [3344    0    0    0    1    0  119    0    0    3 1455   78    0    0]
 [   3    0    0    0   12    0 4980    0    0    0    3    1    0    1]
 [   0    0    0    0    1    0   70    0    0    0  353 4576    0    0]
 [   0    0    0    0    4    0 4981    0    0    0    9    6    0    0]
 [   1    0    0    0   20    0 4961    0    0    0   14    4    0    0]]
Figure(640x480)
[[   0  227    0    0    0    0  145  313   30    0    0   24    0 4261]
 [   0  142    0    0    0    0  399    3  848    0    0 3583    0   25]
 [   4  121    0    0    0    0  545    3 4008    0    0  101   80  138]
 [   5   20    0    0    0    0    1    0    7    0    0    1    0 4966]
 [   1 4931    0    0    0    0    2    0   46    0    0    1    0   19]
 [   0   11    0    0    0    0  998    9  100    0    0 3842    0   40]
 [   0 1535    0    0    0    0 3353    9    5    0    0   17    0   81]
 [   0    2    0    0    0    0    7    5    0    0    0    0    0 4986]
 [   0   14    0    0    0    0    0 4925    0    0    0    0    0   61]
 [   0 4938    0    0    0    0    0    0    0    0    0    0    0   62]
 [   0   16    0    0    0    0    2    1    0    0    0    0    0 4981]
 [   0 4576    0    0    0    0    7  363   46    0    0    5    0    3]
 [  56 2777    0    0    0    0    1    0 2157    0    0    0    0    9]
 [   0  720    0    0    0    0   21    1 4243    0    0    1    0   14]]
Figure(640x480)
[[   0    0    0    0  133    0    0    0   67    0   19 4729    0   52]
 [   0    0    0    0 4863    0    0    0    0    0    3  134    0    0]
 [   0    0    0    0  182    0    0    0    5    0 4687   83    0   43]
 [   0    0    0    0   33    0    0    0 4942    0   15    3    0    7]
 [   0    0    0    0  788    0    0    0    3    0   44   18    0 4147]
 [   0    0    0    0 4966    0    0    0    0    0    7   24    0    3]
 [   0    0    0    0   42    0    0    0    2    0    1 4955    0    0]
 [   0    0    0    0  209    0    0    0    5    0    2 4782    0    2]
 [   0    0    0    0    0    0    0    0    0    0 2591 2217    0  192]
 [   0    0    0    0    3    0    0   69    2    0   17 4882    0   27]
 [   0    0    0    0   11    0    0    3    0    0 4677   26    0  283]
 [   0    0    0    0  148    0    0    0    2    0   25    1    0 4824]
 [   0    0    0    0   26    0    0    0    3    0 4957    3    0   11]
 [   0    0    0    0 4760    0    0    0    0    0  196   24    0   20]]
Figure(640x480)
[[   0    0    0    0    0    0    0   24    0    0    0 4928    0   48]
 [   0    0    0    0    0    0    0 4837    0    0    0  154    0    9]
 [   0    0    0    0    0    0    0    4    0    0    0  151    0 4845]
 [   0    0    0    0    0    0    0   10    0    0    0   57    0 4933]
 [   0    0    0    0    0    0    0    4    0    0    0   37    0 4959]
 [   0    0    0    0    0    0    0  181    0    0    0 4814    0    5]
 [   0    0    0    0    0    0    0   18    0    0    0 4976    0    6]
 [   0    0    0    0  140    0    0    0    0    0    0 4858    0    2]
 [   0    0    0    0    0    0    0    0    0    0    0 4997    0    3]
 [   0    0    0    0    0    0    0    0    0    0    0 4999    0    1]
 [   0    0    0    0    0    0    0    5    0    0    0 4995    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 2771    0 2229]
 [   0    0    0    0    0    0    0    0    0    0    0   25    0 4975]
 [   0    0    0    0    0    0    0    1    0    0    0  105    0 4894]]
Figure(640x480)
[[   0    0    0    0    5    0    0    0    0    0    0 4995    0    0]
 [   0    0    0    0    5    0    0    0    0    0    0 4995    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    2    0    0    0    0    0    0 4998    0    0]
 [   0    0    0    0 3292    0    0    0    0    0    0 1708    0    0]
 [   0    0    0    0    5    0    0    0    0    0    0 4995    0    0]
 [   0    0    0    0 4828    0    0    0    0    0    0  172    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    1    0    0    0    0    0    0 4999    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]]
Figure(640x480)
