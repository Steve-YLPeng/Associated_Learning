total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask4//dbpedia_14/dbpedia_14_linearal_l10_m4_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.06416071428571428 (35930/560000), AUC 0.5092242956161499
Test Epoch0 layer0 Acc 0.974, AUC 0.9983096718788147
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_linearal_l10_m5_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9758142857142857, AUC 0.9985180497169495
Save ckpt to ./ckpt/mask5//dbpedia_14/dbpedia_14_linearal_l10_m5_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9761428571428571, AUC 0.9983624219894409
Test Epoch0 layer3 Acc 0.9761285714285715, AUC 0.9982545971870422
Test Epoch0 layer4 Acc 0.9760714285714286, AUC 0.998259425163269
Test Epoch0 layer5 Acc 0.27855714285714284, AUC 0.5741243958473206
Test Epoch0 layer6 Acc 0.09228571428571429, AUC 0.5064811110496521
Test Epoch0 layer7 Acc 0.02977142857142857, AUC 0.47161880135536194
Test Epoch0 layer8 Acc 0.0062, AUC 0.5534316301345825
Test Epoch0 layer9 Acc 0.023942857142857144, AUC 0.480333536863327
gc 0
Train Epoch1 Acc 0.016694642857142856 (9349/560000), AUC 0.46592259407043457
Test Epoch1 layer0 Acc 0.9738857142857142, AUC 0.9983330965042114
Test Epoch1 layer1 Acc 0.9764714285714285, AUC 0.9984429478645325
Test Epoch1 layer2 Acc 0.9764285714285714, AUC 0.9983754754066467
Test Epoch1 layer3 Acc 0.9762857142857143, AUC 0.9982020258903503
Test Epoch1 layer4 Acc 0.9764428571428572, AUC 0.9982649683952332
Test Epoch1 layer5 Acc 0.2776571428571429, AUC 0.6162352561950684
Test Epoch1 layer6 Acc 0.0982, AUC 0.5252885222434998
Test Epoch1 layer7 Acc 0.0189, AUC 0.4746900200843811
Test Epoch1 layer8 Acc 0.0176, AUC 0.5563262104988098
Test Epoch1 layer9 Acc 0.0172, AUC 0.4538891315460205
gc 0
Train Epoch2 Acc 0.0198625 (11123/560000), AUC 0.43896421790122986
Test Epoch2 layer0 Acc 0.9736428571428571, AUC 0.998331606388092
Test Epoch2 layer1 Acc 0.9765571428571429, AUC 0.9984712600708008
Test Epoch2 layer2 Acc 0.9765714285714285, AUC 0.9982220530509949
Test Epoch2 layer3 Acc 0.9766142857142858, AUC 0.9980860948562622
Test Epoch2 layer4 Acc 0.9766, AUC 0.998033344745636
Test Epoch2 layer5 Acc 0.27685714285714286, AUC 0.6349544525146484
Test Epoch2 layer6 Acc 0.11537142857142857, AUC 0.5228108763694763
Test Epoch2 layer7 Acc 0.008828571428571429, AUC 0.4678826630115509
Test Epoch2 layer8 Acc 0.06685714285714285, AUC 0.5569170117378235
Test Epoch2 layer9 Acc 0.027942857142857144, AUC 0.4277636706829071
gc 0
Train Epoch3 Acc 0.03369285714285714 (18868/560000), AUC 0.4207361042499542
Test Epoch3 layer0 Acc 0.9739857142857142, AUC 0.9983416795730591
Test Epoch3 layer1 Acc 0.9768, AUC 0.9984763860702515
Test Epoch3 layer2 Acc 0.9769, AUC 0.9982677698135376
Test Epoch3 layer3 Acc 0.9768, AUC 0.9981021881103516
Test Epoch3 layer4 Acc 0.9768285714285714, AUC 0.9979862570762634
Test Epoch3 layer5 Acc 0.2713714285714286, AUC 0.6401733160018921
Test Epoch3 layer6 Acc 0.12565714285714286, AUC 0.5202302932739258
Test Epoch3 layer7 Acc 0.006171428571428572, AUC 0.45275941491127014
Test Epoch3 layer8 Acc 0.07987142857142857, AUC 0.5634485483169556
Test Epoch3 layer9 Acc 0.05671428571428572, AUC 0.41693904995918274
gc 0
Train Epoch4 Acc 0.06777678571428572 (37955/560000), AUC 0.4164595901966095
Test Epoch4 layer0 Acc 0.9736857142857143, AUC 0.9983483552932739
Test Epoch4 layer1 Acc 0.9766857142857143, AUC 0.9984477162361145
Test Epoch4 layer2 Acc 0.9765428571428572, AUC 0.9982817769050598
Test Epoch4 layer3 Acc 0.9764, AUC 0.9981494545936584
Test Epoch4 layer4 Acc 0.9765285714285714, AUC 0.998075544834137
Test Epoch4 layer5 Acc 0.2600571428571429, AUC 0.6300584673881531
Test Epoch4 layer6 Acc 0.12567142857142857, AUC 0.5237274765968323
Test Epoch4 layer7 Acc 0.0031714285714285716, AUC 0.447230726480484
Test Epoch4 layer8 Acc 0.08788571428571429, AUC 0.5655214190483093
Test Epoch4 layer9 Acc 0.07065714285714286, AUC 0.4190780520439148
gc 0
Train Epoch5 Acc 0.0705625 (39515/560000), AUC 0.41652771830558777
Test Epoch5 layer0 Acc 0.9739, AUC 0.9983416199684143
Test Epoch5 layer1 Acc 0.9766142857142858, AUC 0.9984380006790161
Test Epoch5 layer2 Acc 0.9768857142857142, AUC 0.9982120394706726
Test Epoch5 layer3 Acc 0.9767571428571429, AUC 0.9981069564819336
Test Epoch5 layer4 Acc 0.9769285714285715, AUC 0.9979838728904724
Test Epoch5 layer5 Acc 0.2658, AUC 0.6277334094047546
Test Epoch5 layer6 Acc 0.1214, AUC 0.5274734497070312
Test Epoch5 layer7 Acc 0.0030571428571428572, AUC 0.4486769735813141
Test Epoch5 layer8 Acc 0.0864, AUC 0.5707467794418335
Test Epoch5 layer9 Acc 0.06975714285714285, AUC 0.41837310791015625
gc 0
Train Epoch6 Acc 0.07109821428571429 (39815/560000), AUC 0.41518405079841614
Test Epoch6 layer0 Acc 0.9737714285714286, AUC 0.9983132481575012
Test Epoch6 layer1 Acc 0.9767428571428571, AUC 0.9984434247016907
Test Epoch6 layer2 Acc 0.9768285714285714, AUC 0.9982026815414429
Test Epoch6 layer3 Acc 0.9767571428571429, AUC 0.9980815052986145
Test Epoch6 layer4 Acc 0.9769142857142857, AUC 0.9979479908943176
Test Epoch6 layer5 Acc 0.2536, AUC 0.6231300234794617
Test Epoch6 layer6 Acc 0.12181428571428571, AUC 0.531126856803894
Test Epoch6 layer7 Acc 0.0030571428571428572, AUC 0.4481831192970276
Test Epoch6 layer8 Acc 0.08385714285714285, AUC 0.5707131624221802
Test Epoch6 layer9 Acc 0.07104285714285714, AUC 0.41662269830703735
gc 0
Train Epoch7 Acc 0.07176964285714285 (40191/560000), AUC 0.41330814361572266
Test Epoch7 layer0 Acc 0.9740285714285715, AUC 0.9983617663383484
Test Epoch7 layer1 Acc 0.9768285714285714, AUC 0.9984397888183594
Test Epoch7 layer2 Acc 0.9769285714285715, AUC 0.9981967210769653
Test Epoch7 layer3 Acc 0.9768428571428571, AUC 0.9980350136756897
Test Epoch7 layer4 Acc 0.9770142857142857, AUC 0.9979596138000488
Test Epoch7 layer5 Acc 0.251, AUC 0.6223635077476501
Test Epoch7 layer6 Acc 0.11262857142857143, AUC 0.5343694090843201
Test Epoch7 layer7 Acc 0.0033285714285714286, AUC 0.4473949074745178
Test Epoch7 layer8 Acc 0.07804285714285714, AUC 0.5668131113052368
Test Epoch7 layer9 Acc 0.0719, AUC 0.41384759545326233
gc 0
Train Epoch8 Acc 0.07248392857142857 (40591/560000), AUC 0.40953853726387024
Test Epoch8 layer0 Acc 0.9739428571428571, AUC 0.9983363151550293
Test Epoch8 layer1 Acc 0.9767714285714286, AUC 0.9984394907951355
Test Epoch8 layer2 Acc 0.9769571428571429, AUC 0.9981809258460999
Test Epoch8 layer3 Acc 0.9768428571428571, AUC 0.9980736374855042
Test Epoch8 layer4 Acc 0.9770571428571428, AUC 0.9979057312011719
Test Epoch8 layer5 Acc 0.2489, AUC 0.6218879818916321
Test Epoch8 layer6 Acc 0.11727142857142857, AUC 0.5334765315055847
Test Epoch8 layer7 Acc 0.004, AUC 0.4484414756298065
Test Epoch8 layer8 Acc 0.07582857142857143, AUC 0.5604168176651001
Test Epoch8 layer9 Acc 0.0735, AUC 0.40717941522598267
gc 0
Train Epoch9 Acc 0.07320357142857142 (40994/560000), AUC 0.4064651429653168
Test Epoch9 layer0 Acc 0.9739, AUC 0.9983212351799011
Test Epoch9 layer1 Acc 0.9767571428571429, AUC 0.9984391331672668
Test Epoch9 layer2 Acc 0.9769857142857142, AUC 0.9981684684753418
Test Epoch9 layer3 Acc 0.9768714285714286, AUC 0.998069703578949
Test Epoch9 layer4 Acc 0.9769142857142857, AUC 0.9979260563850403
Test Epoch9 layer5 Acc 0.25002857142857143, AUC 0.6214171648025513
Test Epoch9 layer6 Acc 0.10914285714285714, AUC 0.5342111587524414
Test Epoch9 layer7 Acc 0.0035, AUC 0.44698047637939453
Test Epoch9 layer8 Acc 0.07531428571428571, AUC 0.5589889883995056
Test Epoch9 layer9 Acc 0.07338571428571429, AUC 0.4067936837673187
Best AUC 0.9985180497169495
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//dbpedia_14/dbpedia_14_linearal_l10_m5_prefix.pt
[[4691   44   21   13   12   70   42    8    4    6    5   21   19   44]
 [  30 4908    1    1    7    0   30    6    3    2    1    0    3    8]
 [  34   14 4630   19   55    1   10    4    4    0    1   81   20  127]
 [   2    2   34 4946   11    1    1    0    0    0    0    1    0    2]
 [   8   18   70   13 4857    7    6    1    2    1    0    2    4   11]
 [  38    1    3    4    1 4940    5    3    1    1    0    0    1    2]
 [  62   53    5    3   10   16 4790   38    9    5    1    1    5    2]
 [   0    1    0    0    2    0   10 4964   18    3    0    0    1    1]
 [   2    3    2    0    3    0   12   12 4966    0    0    0    0    0]
 [   1    0    0    2    1    0    0    6    0 4958   30    1    0    1]
 [  13    1    0    0    0    0    1    4    0   35 4945    1    0    0]
 [   5    0   39    2    0    0    0    0    0    1    0 4928   15   10]
 [   7    2   24    6    2    3    1    3    1    2    0   22 4882   45]
 [  29    7   84    8   12    3    5   10    1    7    4    8   47 4775]]
Figure(640x480)
[[4723   43   17    9   12   51   41    6    2    5    3   25   16   47]
 [  31 4908    2    2    8    0   33    1    1    2    0    0    4    8]
 [  33   14 4644   17   63    1   10    1    1    0    2   80   33  101]
 [   2    2   27 4954   11    0    1    0    0    1    0    0    1    1]
 [   5   14   60   12 4879    7    9    0    2    3    0    0    2    7]
 [  46    1    1    2    1 4938    5    2    1    0    0    0    1    2]
 [  59   46    5    3   10   12 4819   28    4    4    0    1    6    3]
 [   2    1    0    0    2    1   14 4961   11    3    2    0    2    1]
 [   2    4    2    0    5    0   16   17 4954    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4957   31    0    0    1]
 [  12    1    0    0    0    0    2    3    0   40 4942    0    0    0]
 [   7    0   29    2    0    0    0    0    0    0    0 4937   15   10]
 [  10    2   18    3    0    2    0    1    0    0    0   19 4905   40]
 [  29    6   76    5    8    3    4    4    0    2    2    9   66 4786]]
Figure(640x480)
[[4734   43   16    9   10   48   44    5    1    5    3   18   16   48]
 [  35 4907    2    2    7    0   34    0    0    2    0    0    3    8]
 [  32   14 4652   17   62    1   11    2    0    1    2   74   27  105]
 [   2    2   27 4953   12    0    1    0    0    1    0    0    1    1]
 [   7   14   57   13 4880    7    9    0    1    3    0    0    2    7]
 [  46    1    1    2    1 4938    5    2    1    0    0    0    1    2]
 [  58   44    1    1    8   13 4839   26    1    3    0    1    3    2]
 [   3    2    0    0    2    1   18 4954   12    4    1    0    2    1]
 [   2    5    2    0    5    0   21   18 4947    0    0    0    0    0]
 [   1    0    1    2    1    0    0    5    0 4963   25    0    0    2]
 [  12    1    0    0    0    0    2    3    0   53 4928    0    1    0]
 [   9    0   29    2    0    0    1    0    0    0    0 4932   14   13]
 [  12    2   21    4    0    3    1    1    0    0    0   20 4895   41]
 [  29    5   78    5    7    3    4    4    0    1    1    8   47 4808]]
Figure(640x480)
[[4738   40   16    8   12   49   44    5    1    5    3   18   14   47]
 [  36 4903    2    1    6    0   36    0    0    2    1    0    4    9]
 [  34   14 4643   17   66    1   12    0    0    3    2   79   27  102]
 [   2    2   27 4952   12    0    1    0    0    3    0    0    1    0]
 [   7   12   53   11 4886    7   11    0    1    4    0    0    2    6]
 [  45    1    0    2    1 4940    5    2    1    0    0    0    1    2]
 [  61   43    1    1    8   14 4839   24    0    3    0    1    3    2]
 [   3    2    0    0    2    1   19 4954   11    4    2    0    1    1]
 [   2    5    2    0    5    0   21   18 4946    0    0    0    0    1]
 [   1    0    0    2    0    0    0    6    0 4961   28    0    0    2]
 [  12    1    0    0    0    0    3    3    0   42 4939    0    0    0]
 [   8    0   29    2    0    0    1    0    0    0    0 4932   15   13]
 [  14    2   21    2    0    3    1    0    0    0    0   20 4895   42]
 [  30    7   82    5    7    3    4    4    0    1    2    8   46 4801]]
Figure(640x480)
[[4739   41   16    8   12   51   43    4    1    5    2   18   15   45]
 [  39 4902    2    1    8    0   34    0    1    2    0    0    3    8]
 [  36   14 4651   15   66    1   12    1    0    3    2   78   27   94]
 [   2    2   28 4949   13    1    1    0    0    3    0    0    1    0]
 [   8   14   53   13 4883    7    9    0    1    5    0    0    2    5]
 [  45    1    0    1    1 4941    5    1    1    1    0    0    1    2]
 [  63   44    2    1    8   14 4835   24    0    3    0    1    3    2]
 [   3    2    0    0    2    1   19 4954   12    4    0    0    2    1]
 [   3    5    2    0    5    0   23   19 4941    1    0    0    0    1]
 [   1    0    0    2    1    0    0    6    0 4959   29    0    0    2]
 [  12    1    0    0    0    0    3    3    0   43 4938    0    0    0]
 [   8    0   29    2    0    0    2    0    0    0    0 4933   14   12]
 [  15    2   21    2    0    2    1    0    0    0    0   20 4895   42]
 [  32    5   82    4    6    3    4    2    0    1    2    8   46 4805]]
Figure(640x480)
[[   0  153    8    3   12 1425 3014   12    0  355    1    0   15    2]
 [   0 4787   50    1    9  130    2    9    0   12    0    0    0    0]
 [   0    3   23 2322  175 2360    1    1    0  107    4    0    0    4]
 [3954   26    1    1    0  519    0  472    0    5    0    0   22    0]
 [   6   56    0   10    1 4761    1    1    0  157    1    0    5    1]
 [   0    1    0    0    0 4828    4  149    0    1    0    0   17    0]
 [   0   24    1    0    2 2429    5   25    0 2512    1    0    1    0]
 [   0    4    1    0    0   35    0 4955    0    4    0    0    1    0]
 [   0   24    6    1    4  151    0 4741    0    7    0    0   66    0]
 [   0    0    0    0    0  246    0    1    0 4753    0    0    0    0]
 [   0    1    0    0    0 4956    5    0    0   19    0    0   10    9]
 [   0    2    5    2    4 4751    0   29    0    7    1    0  198    1]
 [   0    1    0    1   11 3680    2   27    0    6 1153    0  118    1]
 [   0    2   11   12 4312   55    4    5    0  393   27    0  151   28]]
Figure(640x480)
[[  71    0 3573  143    1    0   78  651  113   26  235   12   10   87]
 [   2    0    4 3482    0    0  132   10 1357    0    1    3    5    4]
 [4441    0    3  302    0    0   25   10    9    2    1    6   32  169]
 [  22    0    0   17   83    8 2060  226    8    1    0 2529   45    1]
 [  36    0    1 4869    0    0   39    8    3    4    1   11   25    3]
 [   0    0    4   21    0    0    8   20  338 4604    2    0    2    1]
 [  10    0    7 4856    0    0    7   31   24    7   20   27    4    7]
 [   0    0    0   13    1    0 4136   13    6    0    1  829    0    1]
 [   5    0    0   32    1  471    2 4463    5    0    0   21    0    0]
 [   1    0    0    2    0    0 2656   70   24 1746    0    2  499    0]
 [   1    0    7   20    0    0    5    4 4889   68    1    2    1    2]
 [  51    0    0 1923    0    0 1719    0 1253    2    7    0   42    3]
 [  44    0    1 4788   13    0   94    3    2    3    0    6    3   43]
 [  36    0    4   57    0    0  291    7    3    3    1    1    3 4594]]
Figure(640x480)
[[2037    0    9  118   39   42  642    1   74  340    0  165 1533    0]
 [   8    0    1   34   60    1    0    2   13    4    0 4855   22    0]
 [2098    0   10   26    9    2    0    4    4    2    0 1502 1343    0]
 [   2    0    3    1    0    0    0    0   88    0    0 4894   12    0]
 [   9    0 4165    2   12    1    0    1    3    0    0  313  494    0]
 [   9    0    0    6    2    0    0    0    0    0    0 4642  341    0]
 [   4    0 1951 1080 1360    1    0  148   16   19    0   25  396    0]
 [   1    0    0    7    1    1    0    0 4634    0    0   27  329    0]
 [  71    0    0   98    0    0    0    0    2    0    0    6 4823    0]
 [   0    0    0   62    0    0    0    0    5    0    0  569 4364    0]
 [   3    0    0   22    0    0    0    0    0    2    0 4967    6    0]
 [ 567    0    0 2969   14   23    0 1379    5    0    0    6   37    0]
 [  14    0    0 4348    0    5    0    1  564    0    0   52   16    0]
 [1494    0    1  306   32 2685   44    0  258    0    0  154   26    0]]
Figure(640x480)
[[ 304    0 4650   27    2    0    0   12    5    0    0    0    0    0]
 [4920    0   20   48    0    0    0    2   10    0    0    0    0    0]
 [ 448    0   88    5    5    0    0 3591  862    0    0    0    1    0]
 [4787    0    7    2    0    0    0  111   65    0    0    0   28    0]
 [ 227    0   22 2009    0    0    0   19 2134    0    0    0  589    0]
 [2269    0   28 2703    0    0    0    0    0    0    0    0    0    0]
 [ 367    0 3352    6  140    0    1    0 1128    0    0    6    0    0]
 [4994    0    2    0    0    0    0    0    2    0    0    1    1    0]
 [3531    0   14    1    1    0    0    1   39    0    0 1413    0    0]
 [4758    0    1    0  240    0    0    0    1    0    0    0    0    0]
 [4981    0   12    0    0    0    0    3    4    0    0    0    0    0]
 [4978    0    6    0    0    0    0   13    3    0    0    0    0    0]
 [4968    0    7    0    0    0    0   21    4    0    0    0    0    0]
 [4944    0   22    0    0    0    0   27    7    0    0    0    0    0]]
Figure(640x480)
[[1231    1    0  214 3272    0    0  135    0    0    0    3  144    0]
 [ 127    1    0    3    6    0    0   20    0    0    0    1 4842    0]
 [  86   18    0   33    5    0    0  122    0    0    0   30 4706    0]
 [4947    5    0    2    0    0    0    4    0    0    0    5   37    0]
 [ 519   10    0   13    1    0    0   10    0    0    0 4315  132    0]
 [  36    1    0 4959    3    0    0    1    0    0    0    0    0    0]
 [4482    0    0  358    5    0    0  128    0    0    1    1   25    0]
 [  90    9    0 4852    0    0    0    7    0    0   30    7    5    0]
 [  13    4    0   43    4    0    0 4934    0    0    0    0    2    0]
 [4918   67    0    5    0    0    0    3    0    0    0    0    7    0]
 [  70  153    0    4    6    0    0  446    0    0    6    0 4315    0]
 [4432  291    0   96    0    0    0   17    0    0    0    0  164    0]
 [1629    1    0 2732    2    0    0  208    0    0    0    0  428    0]
 [  18    3    0 3291    7    0    0 1618    0    0    0    1   62    0]]
Figure(640x480)
