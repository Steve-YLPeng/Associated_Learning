total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask1//dbpedia_14/dbpedia_14_lstmal_l10_m1_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.07142857142857142 (40000/560000), AUC 0.5464819669723511
Test Epoch0 layer0 Acc 0.9738142857142857, AUC 0.9982959628105164
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l10_m2_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9824857142857143, AUC 0.9985834360122681
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l10_m2_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.012842857142857144, AUC 0.38474491238594055
Test Epoch0 layer3 Acc 0.06477142857142858, AUC 0.43813464045524597
Test Epoch0 layer4 Acc 0.04717142857142857, AUC 0.43702277541160583
Test Epoch0 layer5 Acc 0.0107, AUC 0.4850366711616516
Test Epoch0 layer6 Acc 0.07087142857142857, AUC 0.5387080907821655
Test Epoch0 layer7 Acc 0.07142857142857142, AUC 0.37916702032089233
Test Epoch0 layer8 Acc 0.07142857142857142, AUC 0.5614829659461975
Test Epoch0 layer9 Acc 0.07142857142857142, AUC 0.5550841093063354
gc 0
Train Epoch1 Acc 0.07142857142857142 (40000/560000), AUC 0.551880955696106
Test Epoch1 layer0 Acc 0.9735, AUC 0.9982748627662659
Test Epoch1 layer1 Acc 0.9830428571428571, AUC 0.9985841512680054
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l10_m2_prefix.pt  ,ep 1
Test Epoch1 layer2 Acc 0.007757142857142857, AUC 0.38837361335754395
Test Epoch1 layer3 Acc 0.060642857142857144, AUC 0.4322803318500519
Test Epoch1 layer4 Acc 0.03627142857142857, AUC 0.4318854808807373
Test Epoch1 layer5 Acc 0.022457142857142856, AUC 0.500587522983551
Test Epoch1 layer6 Acc 0.06848571428571429, AUC 0.5414469838142395
Test Epoch1 layer7 Acc 0.07142857142857142, AUC 0.3984053134918213
Test Epoch1 layer8 Acc 0.07142857142857142, AUC 0.550399899482727
Test Epoch1 layer9 Acc 0.07142857142857142, AUC 0.5431193709373474
gc 0
Train Epoch2 Acc 0.07142857142857142 (40000/560000), AUC 0.545591413974762
Test Epoch2 layer0 Acc 0.9735857142857143, AUC 0.9982773661613464
Test Epoch2 layer1 Acc 0.9840428571428571, AUC 0.9985867738723755
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l10_m2_prefix.pt  ,ep 2
Test Epoch2 layer2 Acc 0.0023, AUC 0.3889397084712982
Test Epoch2 layer3 Acc 0.062142857142857146, AUC 0.43815287947654724
Test Epoch2 layer4 Acc 0.03655714285714286, AUC 0.4348908066749573
Test Epoch2 layer5 Acc 0.06294285714285715, AUC 0.5084419846534729
Test Epoch2 layer6 Acc 0.060571428571428575, AUC 0.5440235733985901
Test Epoch2 layer7 Acc 0.07142857142857142, AUC 0.39908912777900696
Test Epoch2 layer8 Acc 0.07142857142857142, AUC 0.541552722454071
Test Epoch2 layer9 Acc 0.07142857142857142, AUC 0.5414788126945496
gc 0
Train Epoch3 Acc 0.07142857142857142 (40000/560000), AUC 0.5452432632446289
Test Epoch3 layer0 Acc 0.9736428571428571, AUC 0.9982485771179199
Test Epoch3 layer1 Acc 0.9849428571428571, AUC 0.9986890554428101
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l10_m2_prefix.pt  ,ep 3
Test Epoch3 layer2 Acc 0.0027, AUC 0.39796727895736694
Test Epoch3 layer3 Acc 0.054142857142857145, AUC 0.4403994679450989
Test Epoch3 layer4 Acc 0.027585714285714286, AUC 0.44101977348327637
Test Epoch3 layer5 Acc 0.06865714285714286, AUC 0.506560206413269
Test Epoch3 layer6 Acc 0.05337142857142857, AUC 0.5516602396965027
Test Epoch3 layer7 Acc 0.07142857142857142, AUC 0.40366330742836
Test Epoch3 layer8 Acc 0.07142857142857142, AUC 0.5488781332969666
Test Epoch3 layer9 Acc 0.07142857142857142, AUC 0.5426861047744751
gc 0
Train Epoch4 Acc 0.07142857142857142 (40000/560000), AUC 0.5432055592536926
Test Epoch4 layer0 Acc 0.9737857142857143, AUC 0.9982636570930481
Test Epoch4 layer1 Acc 0.9856, AUC 0.9986811280250549
Test Epoch4 layer2 Acc 0.0020285714285714286, AUC 0.3940155506134033
Test Epoch4 layer3 Acc 0.0602, AUC 0.4341287314891815
Test Epoch4 layer4 Acc 0.05217142857142857, AUC 0.4428524971008301
Test Epoch4 layer5 Acc 0.07025714285714285, AUC 0.5124510526657104
Test Epoch4 layer6 Acc 0.041685714285714284, AUC 0.5562955737113953
Test Epoch4 layer7 Acc 0.07142857142857142, AUC 0.3996846675872803
Test Epoch4 layer8 Acc 0.07142857142857142, AUC 0.5464635491371155
Test Epoch4 layer9 Acc 0.07142857142857142, AUC 0.5361281037330627
gc 0
Train Epoch5 Acc 0.07142857142857142 (40000/560000), AUC 0.5437160730361938
Test Epoch5 layer0 Acc 0.9738, AUC 0.998263955116272
Test Epoch5 layer1 Acc 0.9855714285714285, AUC 0.9986720681190491
Test Epoch5 layer2 Acc 0.0022571428571428573, AUC 0.3915077745914459
Test Epoch5 layer3 Acc 0.06054285714285714, AUC 0.4389903247356415
Test Epoch5 layer4 Acc 0.04991428571428572, AUC 0.4398382008075714
Test Epoch5 layer5 Acc 0.07105714285714286, AUC 0.5177386403083801
Test Epoch5 layer6 Acc 0.05177142857142857, AUC 0.5637575387954712
Test Epoch5 layer7 Acc 0.07142857142857142, AUC 0.3995855450630188
Test Epoch5 layer8 Acc 0.07142857142857142, AUC 0.5460873246192932
Test Epoch5 layer9 Acc 0.07142857142857142, AUC 0.540735125541687
gc 0
Train Epoch6 Acc 0.07142857142857142 (40000/560000), AUC 0.541650116443634
Test Epoch6 layer0 Acc 0.9736, AUC 0.9982736706733704
Test Epoch6 layer1 Acc 0.9861714285714286, AUC 0.9985566735267639
Test Epoch6 layer2 Acc 0.0021, AUC 0.39007046818733215
Test Epoch6 layer3 Acc 0.061271428571428574, AUC 0.4361019432544708
Test Epoch6 layer4 Acc 0.06605714285714286, AUC 0.450807124376297
Test Epoch6 layer5 Acc 0.07134285714285714, AUC 0.5155107378959656
Test Epoch6 layer6 Acc 0.04101428571428571, AUC 0.5656052827835083
Test Epoch6 layer7 Acc 0.07142857142857142, AUC 0.4039027988910675
Test Epoch6 layer8 Acc 0.07142857142857142, AUC 0.5413085222244263
Test Epoch6 layer9 Acc 0.07142857142857142, AUC 0.5461515188217163
gc 0
Train Epoch7 Acc 0.07142857142857142 (40000/560000), AUC 0.5472409129142761
Test Epoch7 layer0 Acc 0.9735571428571429, AUC 0.9982916116714478
Test Epoch7 layer1 Acc 0.9858714285714286, AUC 0.9986174702644348
Test Epoch7 layer2 Acc 0.0020285714285714286, AUC 0.38899654150009155
Test Epoch7 layer3 Acc 0.0601, AUC 0.4360267221927643
Test Epoch7 layer4 Acc 0.06528571428571428, AUC 0.45003584027290344
Test Epoch7 layer5 Acc 0.08428571428571428, AUC 0.5177764296531677
Test Epoch7 layer6 Acc 0.038342857142857144, AUC 0.5633135437965393
Test Epoch7 layer7 Acc 0.07142857142857142, AUC 0.4079537093639374
Test Epoch7 layer8 Acc 0.07142857142857142, AUC 0.5475562810897827
Test Epoch7 layer9 Acc 0.07142857142857142, AUC 0.5446339845657349
gc 0
Train Epoch8 Acc 0.07142857142857142 (40000/560000), AUC 0.5472999811172485
Test Epoch8 layer0 Acc 0.9738, AUC 0.9982833862304688
Test Epoch8 layer1 Acc 0.9854714285714286, AUC 0.9983648061752319
Test Epoch8 layer2 Acc 0.002, AUC 0.39216160774230957
Test Epoch8 layer3 Acc 0.06507142857142857, AUC 0.44172731041908264
Test Epoch8 layer4 Acc 0.06462857142857142, AUC 0.4459841549396515
Test Epoch8 layer5 Acc 0.10038571428571429, AUC 0.5205073952674866
Test Epoch8 layer6 Acc 0.04277142857142857, AUC 0.5647981762886047
Test Epoch8 layer7 Acc 0.07142857142857142, AUC 0.40467044711112976
Test Epoch8 layer8 Acc 0.07142857142857142, AUC 0.5450072288513184
Test Epoch8 layer9 Acc 0.07142857142857142, AUC 0.5473325848579407
gc 0
Train Epoch9 Acc 0.07142857142857142 (40000/560000), AUC 0.5507126450538635
Test Epoch9 layer0 Acc 0.9738714285714286, AUC 0.9982869029045105
Test Epoch9 layer1 Acc 0.9857857142857143, AUC 0.9984196424484253
Test Epoch9 layer2 Acc 0.0020285714285714286, AUC 0.39308521151542664
Test Epoch9 layer3 Acc 0.06727142857142857, AUC 0.44281843304634094
Test Epoch9 layer4 Acc 0.06571428571428571, AUC 0.4484913945198059
Test Epoch9 layer5 Acc 0.10808571428571428, AUC 0.5213307738304138
Test Epoch9 layer6 Acc 0.043057142857142856, AUC 0.5622413754463196
Test Epoch9 layer7 Acc 0.07142857142857142, AUC 0.4042806625366211
Test Epoch9 layer8 Acc 0.07142857142857142, AUC 0.5446768403053284
Test Epoch9 layer9 Acc 0.07142857142857142, AUC 0.5457295775413513
Best AUC 0.9986890554428101
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//dbpedia_14/dbpedia_14_lstmal_l10_m2_prefix.pt
[[4690   44   22   15   11   67   41    7    3    5    7   22   19   47]
 [  38 4891    3    3    8    0   31    7    3    2    1    0    5    8]
 [  35   14 4596   18   50    1    9    3    6    0    1   96   20  151]
 [   3    2   28 4951   12    0    1    0    0    0    0    0    0    3]
 [   8   19   76   12 4851    9    5    1    2    1    0    0    3   13]
 [  35    2    3    4    1 4939    5    4    1    2    1    0    1    2]
 [  60   44    5    2   10   15 4800   38   11    5    1    1    4    4]
 [   0    1    1    0    2    0   12 4962   17    3    1    0    0    1]
 [   1    4    2    0    3    0    8   12 4970    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4951   37    0    0    1]
 [  13    1    0    0    0    0    2    3    0   35 4946    0    0    0]
 [   5    0   31    2    0    0    0    0    0    0    0 4941   11   10]
 [  11    2   25    6    2    1    1    3    1    2    0   25 4868   53]
 [  30    5   67    8   12    3    5    9    1    6    5    6   44 4799]]
Figure(640x480)
[[4829   31   10    5   12   31   43    2    2    2    1    6    4   22]
 [  49 4906    1    0    7    0   31    1    1    1    0    1    0    2]
 [  19    3 4871    8   52    1    2    0    0    2    0   16    5   21]
 [   2    1   16 4968   10    0    0    0    0    1    0    0    1    1]
 [   6    3   92   16 4869    4    3    0    0    4    0    0    1    2]
 [  31    0    0    0    1 4959    5    2    1    0    0    0    0    1]
 [  57   25    2    0    2   12 4882   10    4    2    1    0    0    3]
 [   3    0    0    0    0    1   20 4964    9    1    1    0    0    1]
 [   2    0    1    0    2    0    7    4 4982    1    0    0    0    1]
 [   1    0    0    1    0    0    1    2    0 4976   19    0    0    0]
 [  16    1    0    0    0    0    1    0    0   29 4953    0    0    0]
 [   4    0    9    1    0    0    0    0    0    0    0 4974    7    5]
 [   9    1    6    0    0    1    1    0    0    0    0   27 4923   32]
 [  37    0   26    1    6    3    4    1    0    1    3   10   18 4890]]
Figure(640x480)
[[   0    0   11    0    5  390    1  101    9   22    2  317  642 3500]
 [   0    3    0    0    1 3334    7    9    5  755    0    0    1  885]
 [   7    3   49    2    4   24    4 4258    2  589   13    1    8   36]
 [   0    1    0    0 2578  101    0 1780    1    3   84    0  443    9]
 [   0    0    1    1   36 4126    0  262    0    7    1    0   40  526]
 [   0    0    0    0    1    1    0    2    0  381    0    0    4 4611]
 [   1    0    0   62   27   25    0 3907   85    9    0    3    6  875]
 [   2    0    0    0    2    4    0    2    1 4933    0    0    0   56]
 [4685    0    0   11  112  128    0    4    0    1    0    0    0   59]
 [   0    0    0    0   17  117    0    3    0    3    0    0    0 4860]
 [   0    0    0    0    0 4637    0   93    0  101    0    0    1  168]
 [   0    0 4978    0    1    1    0    6    1    1    0    0    8    4]
 [   1    1   36   32    0  154    1  583    2    8 1097    0   12 3073]
 [   1    3   14    0   23    8    0 2759 1885  162    5    0   57   83]]
Figure(640x480)
[[ 126    3   40    0 1344    5   47    0    0    6    1   12    0 3416]
 [   1   54   15    0   69    0  736    0    0    4    1 2408    0 1712]
 [  22    8 3555    0    5    0   45    0    0 1320    0   27    0   18]
 [   4    3    3    0    0    0 4958    0    0    9    0   20    0    3]
 [   3    9   29    0    3    0   24    0    0  135    0 4785    0   12]
 [   2    0    2    0    2    0    7    0    0    0    0    0    0 4987]
 [   4   20 3533    0  438    0    6    3    0    0    0    4    0  992]
 [  18   11 4834    0   53    0   70    5    0    0    0    0    0    9]
 [   4    3   89    0 4832    0    1    0    0    0   19   52    0    0]
 [4973    1    0    0    0    0    4    0    0   11    0    0    0   11]
 [2772    2    0    0    5    0 2063    0    0  129    0    0    0   29]
 [ 182   15   22    0    1    0 4633    0    0   75    0    8    0   64]
 [2010    3   11    0  170    0 2681    0    0    6    1    0    0  118]
 [  67   49  118    0   27   11 2722    0    0 1979    0    5    0   22]]
Figure(640x480)
[[   1   21    0    0    0    0    0 1836   37    0    6 2930    0  169]
 [   0    0    0    0    0    0    0  216  357    0   56 4355    0   16]
 [   3    2    0    0    0    0    0   10  981    0    3 3962    0   39]
 [4309    0    0    0    0    0    0    0    2    0   69   30    0  590]
 [  27    3    0    0    0    0    0    0  111    0    0  107    0 4752]
 [   0    0    0    0    0    0    0   30 1476    0    0 3493    0    1]
 [   0    0    0    0    0    0    0 1055    4    0    0  282    0 3659]
 [   0    0    0    0    0    0    0 1781    1    0    1 3125    0   92]
 [   0    0    0    0    0    0    0 4967    0    0    3    2    0   28]
 [   2    0    0    0    0    0    0  217    0    0    0 4773    0    8]
 [   0    0    0    0    0    0    0 4969    0    0    0   31    0    0]
 [   0 2868    0    0    0    0    0  509 1568    0    2   52    0    1]
 [   8    7    0    0    0    0    0    2 4952    0    9   14    0    8]
 [   0    0    0    0    0    0    0   16 4731    0    1  155    0   97]]
Figure(640x480)
[[   0    0    0    0  118    0    0    4 4684    0    0  194    0    0]
 [   0    0    0    0  234    0    0   23   45    0    0 4698    0    0]
 [   0    0    0    0  137    0    0    1   12    0    0 4850    0    0]
 [   0    0    0    0 4945    0    0   28    1    0    0   26    0    0]
 [   0    0    0    0 4784    0    0    1   11    0    8  196    0    0]
 [   0    0    0    0 4568    0    0   15   20    0    0  397    0    0]
 [   0    0    0    0 4361    0    0    6  145    0    0  488    0    0]
 [   0    0    0    0  382    0    0    1    5    0    0 4612    0    0]
 [   0    0    0    0    4    0    0    7    0    0    0 4989    0    0]
 [   0    0    0    0    2    0    0  218    1    0    0 4779    0    0]
 [   2    0    0    0   29    0    0    1  163    0    0 4805    0    0]
 [   0    0    0    0 4922    0    0   54    3    0    0   21    0    0]
 [   0    0    0    0 3691    0    0 1246    5    0    2   56    0    0]
 [   0    0    0    0  579    0    0   95   16    0    1 4309    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0   97    0    0    0 4903    0    0]
 [   0    0    0    0    0    0    0   13    0    0    0 4987    0    0]
 [   0    0    4    0    0    0    0 4368    0    0    0  628    0    0]
 [   0    0    0    0    0    0    0  324    0    0    0 4676    0    0]
 [   0    0    0    0    0    0    0 4917    0    0    0   83    0    0]
 [   0    0  155    0    0    0    0 4731    0    0    0  114    0    0]
 [   0    0    0    0    0    0    0   10    0    0    0 4990    0    0]
 [   0    0    0    0    0    0    0   10    0    0    0 4990    0    0]
 [   0    0    0    0    0    0    0    3    0    0    0 4997    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0 1278    0    0    0 3722    0    0]
 [   0    0    0    0    0    0    0 4968    0    0    0   32    0    0]
 [   0    0    0    0    0    0    0 4302    0    0    0  698    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]]
Figure(640x480)
