total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask6//dbpedia_14/dbpedia_14_lstmal_l10_m6_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.07122142857142857 (39884/560000), AUC 0.5337896943092346
Test Epoch0 layer0 Acc 0.9736714285714285, AUC 0.9982814192771912
Save ckpt to ./ckpt/mask7//dbpedia_14/dbpedia_14_lstmal_l10_m7_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9855571428571429, AUC 0.9983345866203308
Save ckpt to ./ckpt/mask7//dbpedia_14/dbpedia_14_lstmal_l10_m7_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9855142857142857, AUC 0.9983606934547424
Save ckpt to ./ckpt/mask7//dbpedia_14/dbpedia_14_lstmal_l10_m7_prefix.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9856, AUC 0.9974854588508606
Test Epoch0 layer4 Acc 0.9855571428571429, AUC 0.9977453947067261
Test Epoch0 layer5 Acc 0.9855142857142857, AUC 0.9973784685134888
Test Epoch0 layer6 Acc 0.9852714285714286, AUC 0.9974188208580017
Test Epoch0 layer7 Acc 0.14175714285714286, AUC 0.5988451838493347
Test Epoch0 layer8 Acc 0.07614285714285714, AUC 0.43791845440864563
Test Epoch0 layer9 Acc 0.07178571428571429, AUC 0.5372515320777893
gc 0
Train Epoch1 Acc 0.07195535714285714 (40295/560000), AUC 0.5319450497627258
Test Epoch1 layer0 Acc 0.9738714285714286, AUC 0.9982629418373108
Test Epoch1 layer1 Acc 0.9859714285714286, AUC 0.9983135461807251
Test Epoch1 layer2 Acc 0.9858714285714286, AUC 0.9981945753097534
Test Epoch1 layer3 Acc 0.9858857142857143, AUC 0.9973536729812622
Test Epoch1 layer4 Acc 0.9858428571428571, AUC 0.9975400567054749
Test Epoch1 layer5 Acc 0.9858571428571429, AUC 0.997284471988678
Test Epoch1 layer6 Acc 0.9857, AUC 0.9970753788948059
Test Epoch1 layer7 Acc 0.1399, AUC 0.5904412269592285
Test Epoch1 layer8 Acc 0.07097142857142857, AUC 0.4215112030506134
Test Epoch1 layer9 Acc 0.07171428571428572, AUC 0.5328055024147034
gc 0
Train Epoch2 Acc 0.07175357142857143 (40182/560000), AUC 0.5361745953559875
Test Epoch2 layer0 Acc 0.9736285714285714, AUC 0.9982872605323792
Test Epoch2 layer1 Acc 0.9851285714285715, AUC 0.998173713684082
Test Epoch2 layer2 Acc 0.9850714285714286, AUC 0.9980562329292297
Test Epoch2 layer3 Acc 0.9851571428571428, AUC 0.9971649050712585
Test Epoch2 layer4 Acc 0.9851714285714286, AUC 0.9971352219581604
Test Epoch2 layer5 Acc 0.9851428571428571, AUC 0.9970222115516663
Test Epoch2 layer6 Acc 0.9849857142857142, AUC 0.9969028830528259
Test Epoch2 layer7 Acc 0.13797142857142858, AUC 0.5968607068061829
Test Epoch2 layer8 Acc 0.0091, AUC 0.4157923758029938
Test Epoch2 layer9 Acc 0.07164285714285715, AUC 0.5437184572219849
gc 0
Train Epoch3 Acc 0.07173214285714286 (40170/560000), AUC 0.5463079810142517
Test Epoch3 layer0 Acc 0.9739714285714286, AUC 0.9982698559761047
Test Epoch3 layer1 Acc 0.9858428571428571, AUC 0.9982099533081055
Test Epoch3 layer2 Acc 0.9858285714285714, AUC 0.9980190396308899
Test Epoch3 layer3 Acc 0.9858142857142858, AUC 0.9971539378166199
Test Epoch3 layer4 Acc 0.9858142857142858, AUC 0.9973226189613342
Test Epoch3 layer5 Acc 0.9857714285714285, AUC 0.9971200823783875
Test Epoch3 layer6 Acc 0.9857142857142858, AUC 0.9969201683998108
Test Epoch3 layer7 Acc 0.13662857142857143, AUC 0.5907215476036072
Test Epoch3 layer8 Acc 0.006142857142857143, AUC 0.41160035133361816
Test Epoch3 layer9 Acc 0.07165714285714286, AUC 0.5512867569923401
gc 0
Train Epoch4 Acc 0.07164821428571429 (40123/560000), AUC 0.5497547388076782
Test Epoch4 layer0 Acc 0.9738285714285714, AUC 0.9982528686523438
Test Epoch4 layer1 Acc 0.9856285714285714, AUC 0.9979622960090637
Test Epoch4 layer2 Acc 0.9855428571428572, AUC 0.9977578520774841
Test Epoch4 layer3 Acc 0.9855142857142857, AUC 0.9968338012695312
Test Epoch4 layer4 Acc 0.9854857142857143, AUC 0.9970029592514038
Test Epoch4 layer5 Acc 0.9854714285714286, AUC 0.9969186186790466
Test Epoch4 layer6 Acc 0.9855571428571429, AUC 0.9966911673545837
Test Epoch4 layer7 Acc 0.13315714285714286, AUC 0.5738526582717896
Test Epoch4 layer8 Acc 0.006571428571428572, AUC 0.4108146131038666
Test Epoch4 layer9 Acc 0.0716, AUC 0.5494343042373657
gc 0
Train Epoch5 Acc 0.07168035714285714 (40141/560000), AUC 0.549710750579834
Test Epoch5 layer0 Acc 0.9736, AUC 0.9982888102531433
Test Epoch5 layer1 Acc 0.9855142857142857, AUC 0.9978489875793457
Test Epoch5 layer2 Acc 0.9855285714285714, AUC 0.9975031614303589
Test Epoch5 layer3 Acc 0.9855857142857143, AUC 0.9966415166854858
Test Epoch5 layer4 Acc 0.9855857142857143, AUC 0.996667206287384
Test Epoch5 layer5 Acc 0.9855571428571429, AUC 0.9964032769203186
Test Epoch5 layer6 Acc 0.9855285714285714, AUC 0.9963752031326294
Test Epoch5 layer7 Acc 0.1203, AUC 0.5762223601341248
Test Epoch5 layer8 Acc 0.006271428571428571, AUC 0.40229323506355286
Test Epoch5 layer9 Acc 0.07167142857142857, AUC 0.5467813014984131
gc 0
Train Epoch6 Acc 0.07167321428571428 (40137/560000), AUC 0.5502573251724243
Test Epoch6 layer0 Acc 0.9736714285714285, AUC 0.998279869556427
Test Epoch6 layer1 Acc 0.9857142857142858, AUC 0.9978341460227966
Test Epoch6 layer2 Acc 0.9858285714285714, AUC 0.9975615739822388
Test Epoch6 layer3 Acc 0.9857714285714285, AUC 0.9966139793395996
Test Epoch6 layer4 Acc 0.9857428571428571, AUC 0.9967383146286011
Test Epoch6 layer5 Acc 0.9857428571428571, AUC 0.9966011643409729
Test Epoch6 layer6 Acc 0.9857571428571429, AUC 0.9961840510368347
Test Epoch6 layer7 Acc 0.12288571428571429, AUC 0.5707463026046753
Test Epoch6 layer8 Acc 0.009642857142857142, AUC 0.40558427572250366
Test Epoch6 layer9 Acc 0.07157142857142858, AUC 0.5466644167900085
gc 0
Train Epoch7 Acc 0.0716625 (40131/560000), AUC 0.5506239533424377
Test Epoch7 layer0 Acc 0.9738571428571429, AUC 0.9982752203941345
Test Epoch7 layer1 Acc 0.9854857142857143, AUC 0.9977501630783081
Test Epoch7 layer2 Acc 0.9855857142857143, AUC 0.9973288178443909
Test Epoch7 layer3 Acc 0.9855571428571429, AUC 0.9963821172714233
Test Epoch7 layer4 Acc 0.9855857142857143, AUC 0.9964235424995422
Test Epoch7 layer5 Acc 0.9856142857142857, AUC 0.996362566947937
Test Epoch7 layer6 Acc 0.9856142857142857, AUC 0.9960444569587708
Test Epoch7 layer7 Acc 0.09854285714285714, AUC 0.5713751316070557
Test Epoch7 layer8 Acc 0.0064714285714285716, AUC 0.40760165452957153
Test Epoch7 layer9 Acc 0.07161428571428571, AUC 0.5528455376625061
gc 0
Train Epoch8 Acc 0.07171071428571428 (40158/560000), AUC 0.5519998669624329
Test Epoch8 layer0 Acc 0.9736714285714285, AUC 0.9983051419258118
Test Epoch8 layer1 Acc 0.9854571428571428, AUC 0.9975886344909668
Test Epoch8 layer2 Acc 0.9854285714285714, AUC 0.9974256157875061
Test Epoch8 layer3 Acc 0.9855571428571429, AUC 0.9963620901107788
Test Epoch8 layer4 Acc 0.9855142857142857, AUC 0.9965452551841736
Test Epoch8 layer5 Acc 0.9855285714285714, AUC 0.9963415265083313
Test Epoch8 layer6 Acc 0.9855, AUC 0.9960069060325623
Test Epoch8 layer7 Acc 0.11605714285714286, AUC 0.5704156756401062
Test Epoch8 layer8 Acc 0.009942857142857142, AUC 0.4095657467842102
Test Epoch8 layer9 Acc 0.07161428571428571, AUC 0.5499793291091919
gc 0
Train Epoch9 Acc 0.07170178571428572 (40153/560000), AUC 0.551025927066803
Test Epoch9 layer0 Acc 0.9739571428571429, AUC 0.9982709288597107
Test Epoch9 layer1 Acc 0.9853428571428572, AUC 0.9975329041481018
Test Epoch9 layer2 Acc 0.9853285714285714, AUC 0.9972521066665649
Test Epoch9 layer3 Acc 0.9853285714285714, AUC 0.9962337613105774
Test Epoch9 layer4 Acc 0.9854142857142857, AUC 0.9962931871414185
Test Epoch9 layer5 Acc 0.9853571428571428, AUC 0.996172308921814
Test Epoch9 layer6 Acc 0.9853857142857143, AUC 0.9959474802017212
Test Epoch9 layer7 Acc 0.08692857142857142, AUC 0.5705228447914124
Test Epoch9 layer8 Acc 0.010042857142857143, AUC 0.4117956757545471
Test Epoch9 layer9 Acc 0.07158571428571428, AUC 0.5512688755989075
Best AUC 0.9983606934547424
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask7//dbpedia_14/dbpedia_14_lstmal_l10_m7_prefix.pt
[[4685   40   23   14   12   73   42    8    3    6    5   21   20   48]
 [  36 4892    2    3    7    0   32    6    4    2    1    0    6    9]
 [  37   12 4589   22   51    1   10    3    5    1    1   83   23  162]
 [   2    2   25 4956   11    0    1    0    0    0    0    0    0    3]
 [  10   17   80   12 4847    8    6    2    2    1    0    0    2   13]
 [  36    1    3    4    1 4942    5    2    1    2    0    0    1    2]
 [  60   43    5    2   10   16 4799   41   10    5    1    1    4    3]
 [   0    1    0    0    2    0   12 4964   16    3    1    0    0    1]
 [   1    4    2    0    3    0   12   13 4965    0    0    0    0    0]
 [   1    0    1    3    1    0    0    7    0 4934   52    0    0    1]
 [  12    1    0    0    0    0    2    4    0   26 4955    0    0    0]
 [   5    0   35    2    0    0    0    0    0    0    1 4930   15   12]
 [   6    2   22    7    1    3    1    3    0    2    0   20 4884   49]
 [  27    3   62    7   12    3    3   10    1    4    4    6   43 4815]]
Figure(640x480)
[[4800   33   20    4   12   39   36    2    0    2    0    9    5   38]
 [  42 4916    0    0    7    1   24    1    1    1    0    0    1    6]
 [   8    3 4886   10   57    2    1    0    0    3    0    8    4   18]
 [   2    1   12 4972    9    1    1    0    0    0    0    0    2    0]
 [   4    5   76   14 4886    5    3    0    0    2    0    0    1    4]
 [  24    0    1    0    1 4964    3    2    0    1    0    0    0    4]
 [  67   28    4    0    1   12 4861   14    6    2    0    0    2    3]
 [   1    0    0    0    0    2   18 4968    6    4    0    0    0    1]
 [   3    0    1    0    1    0    4    8 4981    1    0    0    0    1]
 [   1    0    0    1    0    0    1    2    0 4976   19    0    0    0]
 [  13    1    0    0    0    0    1    1    0   25 4959    0    0    0]
 [   2    0   10    1    0    0    0    0    0    0    0 4972    8    7]
 [   3    0    6    0    0    1    1    0    0    0    0   21 4929   39]
 [  21    1   25    1    3    2    4    0    0    0    1    8   15 4919]]
Figure(640x480)
[[4795   32   20    4   12   39   36    2    0    2    1   10    7   40]
 [  42 4915    0    0    7    1   25    1    1    1    0    0    1    6]
 [   8    3 4889   11   53    2    1    0    0    1    1    8    5   18]
 [   1    1   13 4972    8    1    1    0    0    0    0    1    2    0]
 [   4    5   83   14 4878    5    3    0    0    2    0    0    2    4]
 [  23    0    1    0    1 4964    3    2    0    1    0    1    0    4]
 [  66   27    4    0    1   12 4865   14    4    2    0    0    2    3]
 [   1    0    0    0    0    2   17 4969    6    4    0    0    0    1]
 [   3    0    1    0    1    0    4    8 4981    1    0    0    0    1]
 [   1    0    0    1    0    0    1    2    0 4974   21    0    0    0]
 [  13    1    0    0    0    0    1    1    0   23 4961    0    0    0]
 [   2    0   11    1    0    0    0    0    0    0    0 4971    8    7]
 [   2    0    5    0    0    1    1    0    0    0    0   20 4931   40]
 [  21    1   24    1    2    2    4    0    0    0    1    7   16 4921]]
Figure(640x480)
[[4793   31   20    4   12   39   36    2    0    2    1   10    8   42]
 [  40 4917    0    0    7    1   25    1    1    1    0    0    1    6]
 [   7    3 4889   11   54    2    1    0    0    2    0    8    4   19]
 [   1    1   13 4972    8    1    1    0    0    0    0    1    2    0]
 [   4    5   79   14 4881    5    3    0    0    2    0    0    3    4]
 [  23    0    1    0    1 4964    3    2    0    1    0    0    0    5]
 [  65   27    4    0    1   12 4864   14    5    3    0    0    2    3]
 [   1    0    0    0    0    2   18 4968    6    4    0    0    0    1]
 [   2    0    1    0    1    0    4    8 4981    1    0    0    0    2]
 [   1    0    0    1    0    0    1    1    0 4975   21    0    0    0]
 [  13    1    0    0    0    0    1    1    0   23 4961    0    0    0]
 [   2    0   11    1    0    0    0    0    0    0    0 4971    8    7]
 [   2    0    5    0    0    1    1    0    0    0    0   20 4931   40]
 [  18    1   24    1    2    2    3    0    0    0    1    6   17 4925]]
Figure(640x480)
[[4794   31   20    4   12   39   36    2    0    2    1   10    8   41]
 [  40 4916    0    0    7    1   26    1    1    1    0    0    1    6]
 [   7    3 4889   11   53    2    1    0    0    1    1    8    5   19]
 [   1    1   13 4972    8    1    1    0    0    0    0    1    2    0]
 [   4    5   81   14 4878    5    3    0    0    3    0    0    3    4]
 [  23    0    1    0    1 4965    3    2    0    1    0    0    0    4]
 [  62   28    4    0    1   12 4867   14    4    3    0    0    2    3]
 [   1    0    0    0    0    2   18 4968    6    4    0    0    0    1]
 [   3    0    1    0    1    0    4    8 4981    1    0    0    0    1]
 [   1    0    0    1    0    0    1    2    0 4974   21    0    0    0]
 [  13    1    0    0    0    0    1    1    0   25 4959    0    0    0]
 [   2    0   11    1    0    0    0    0    0    0    0 4970    9    7]
 [   2    0    5    0    0    1    1    0    0    0    0   20 4932   39]
 [  18    1   24    1    2    2    4    0    0    0    1    6   17 4924]]
Figure(640x480)
[[4795   31   19    4   12   39   36    2    0    2    1    8    8   43]
 [  44 4913    0    0    7    1   26    0    1    1    0    0    1    6]
 [   7    3 4887   11   56    2    1    0    0    1    1    8    5   18]
 [   1    1   13 4972    9    1    1    0    0    0    0    0    2    0]
 [   4    5   77   14 4882    5    3    0    0    3    0    0    3    4]
 [  23    0    1    0    1 4964    3    2    0    1    0    0    0    5]
 [  63   26    4    0    1   12 4867   14    4    3    0    0    2    4]
 [   1    0    0    0    0    2   20 4964    8    4    0    0    0    1]
 [   3    0    1    0    1    0    4    8 4981    1    0    0    0    1]
 [   1    0    0    1    0    0    1    2    0 4974   21    0    0    0]
 [  13    1    0    0    0    0    1    1    0   25 4959    0    0    0]
 [   2    0   10    1    0    0    0    0    0    1    0 4970    9    7]
 [   2    0    5    0    0    1    1    0    0    0    0   19 4933   39]
 [  18    1   23    1    3    2    3    0    0    0    1    6   17 4925]]
Figure(640x480)
[[4794   32   21    4   11   37   37    2    0    2    1    8    8   43]
 [  46 4914    2    0    5    1   23    0    1    1    0    0    1    6]
 [   8    3 4893   10   50    2    1    0    0    2    1    7    5   18]
 [   1    1   14 4972    7    1    1    0    0    0    0    1    2    0]
 [   4    5   86   14 4872    5    3    0    0    3    0    0    4    4]
 [  26    0    1    0    1 4961    3    2    0    1    0    0    0    5]
 [  66   27    4    0    1   11 4862   16    4    3    0    0    2    4]
 [   1    0    0    0    0    2   20 4963    8    5    0    0    0    1]
 [   3    0    1    0    1    0    5    8 4980    1    0    0    0    1]
 [   1    0    1    0    0    0    1    1    0 4975   21    0    0    0]
 [  13    1    0    0    0    0    1    1    0   24 4960    0    0    0]
 [   2    0   10    1    0    0    0    0    0    1    0 4968   10    8]
 [   3    0    5    0    0    1    1    0    0    0    0   20 4931   39]
 [  18    1   25    1    3    2    2    0    0    0    1    7   16 4924]]
Figure(640x480)
[[   0    8    0    0   37    0    0  145 4772    0    0    3    0   35]
 [   0    0    0    0    4    0    0 4949   47    0    0    0    0    0]
 [   0    7    0    0   16    0    0 4937   34    0    0    4    0    2]
 [   0    0    0    0    0    0    0 4996    1    0    0    1    0    2]
 [   0    0    0    0    1    0    0 4986    4    0    0    1    0    8]
 [   0    4    0    0    3    0    0   20   18    0    0    0    0 4955]
 [   0    0    0    0    2    0    0 2181 2788    0    0   17    0   12]
 [   0    0    0    0    1    0    0 4990    6    0    0    0    0    3]
 [   0    0    0    0    1    0    0   87 4912    0    0    0    0    0]
 [   0    0    0    0    0    0    0 4764  235    0    0    0    0    1]
 [   0    0    0    0    0    0    0 1029 3969    0    0    0    0    2]
 [   0 2243    0    0 2716    0    0   29    2    0    0    9    0    1]
 [   0   12    0    0   37    0    0   34    3    0    0 4905    0    9]
 [   0    0    0    0 4888    0    0   77   12    0    0   12    0   11]]
Figure(640x480)
[[   0    0    0    1    0    0    0 4777    0    0    0  222    0    0]
 [   0    0    0    0    0    0    0   93    0    0    0 4907    0    0]
 [   0    0    0    0    0    0    0   27    0    0    0 4973    0    0]
 [   0    0    0    0    0    0    0 4974    0    0    0   26    0    0]
 [   0    0    0    0    0    0    0   54    0    0    0 4946    0    0]
 [   0    0    0    0    0    0    0   23    0    0    0 4977    0    0]
 [   0    0    0    1    0    0    0 4948    0    0    0   51    0    0]
 [   0    0    0    1    5    0    0 4981    0    0    0   13    0    0]
 [   0    0    0    1    0    0    0   38    1    0    0 4960    0    0]
 [   0    0   10 4764   24    0    0  198    0    0    0    4    0    0]
 [   0    0    1   14 4922    0    0   31    0    0    0   32    0    0]
 [   0    0    0    0    0    0    0 4652    0    0    0  348    0    0]
 [   0    0    0    0    0    0    0  235    0    0    0 4765    0    0]
 [   0    0    0    0    0    0    0   22    0    0    0 4978    0    0]]
Figure(640x480)
[[   0    2    0    0    1    0    0    0    0    0    0 4997    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0 3756   27    0    0    0    0    0    0    0    0 1217    0    0]
 [   0    1    0    0    0    0    0    0    0    0    0 4999    0    0]
 [   0   17    0    0    0    0    0    0    0    0    0 4983    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0 3208    0    0    0    0    0    0 1792    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    1    0    0    0    0    0    0    0    0    0 4999    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    3    0    0    0    0    0    0 4997    0    0]
 [   0    2    0    0    0    0    0    0    0    0    0 4998    0    0]
 [   0    0    0    0    1    0    0    0    0    0    0 4999    0    0]
 [   0    5    1    0    0    0    0    0    0    0    0 4994    0    0]]
Figure(640x480)
