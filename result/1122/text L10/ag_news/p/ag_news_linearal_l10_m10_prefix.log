total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask9//ag_news/ag_news_linearal_l10_m9.pt
Start Training
gc 9
Train Epoch0 Acc 0.8874416666666667 (106493/120000), AUC 0.9793132543563843
Test Epoch0 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch0 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch0 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch0 layer3 Acc 0.9152631578947369, AUC 0.9824958443641663
Test Epoch0 layer4 Acc 0.9155263157894736, AUC 0.9824934005737305
Test Epoch0 layer5 Acc 0.9140789473684211, AUC 0.9824485778808594
Test Epoch0 layer6 Acc 0.9136842105263158, AUC 0.9825964570045471
Test Epoch0 layer7 Acc 0.9132894736842105, AUC 0.9822898507118225
Test Epoch0 layer8 Acc 0.9130263157894737, AUC 0.982147216796875
Test Epoch0 layer9 Acc 0.915, AUC 0.9822258353233337
Save ckpt to ./ckpt/mask10//ag_news/ag_news_linearal_l10_m10.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9448833333333333 (113386/120000), AUC 0.9924658536911011
Test Epoch1 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch1 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch1 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch1 layer3 Acc 0.9152631578947369, AUC 0.9824958443641663
Test Epoch1 layer4 Acc 0.9155263157894736, AUC 0.9824934005737305
Test Epoch1 layer5 Acc 0.9140789473684211, AUC 0.9824485778808594
Test Epoch1 layer6 Acc 0.9136842105263158, AUC 0.9825964570045471
Test Epoch1 layer7 Acc 0.9132894736842105, AUC 0.9822898507118225
Test Epoch1 layer8 Acc 0.9130263157894737, AUC 0.982147216796875
Test Epoch1 layer9 Acc 0.9139473684210526, AUC 0.9822534918785095
Save ckpt to ./ckpt/mask10//ag_news/ag_news_linearal_l10_m10.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.945025 (113403/120000), AUC 0.9923746585845947
Test Epoch2 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch2 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch2 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch2 layer3 Acc 0.9152631578947369, AUC 0.9824958443641663
Test Epoch2 layer4 Acc 0.9155263157894736, AUC 0.9824934005737305
Test Epoch2 layer5 Acc 0.9140789473684211, AUC 0.9824485778808594
Test Epoch2 layer6 Acc 0.9136842105263158, AUC 0.9825964570045471
Test Epoch2 layer7 Acc 0.9132894736842105, AUC 0.9822898507118225
Test Epoch2 layer8 Acc 0.9130263157894737, AUC 0.982147216796875
Test Epoch2 layer9 Acc 0.9143421052631578, AUC 0.9816344380378723
gc 0
Train Epoch3 Acc 0.945025 (113403/120000), AUC 0.9922603368759155
Test Epoch3 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch3 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch3 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch3 layer3 Acc 0.9152631578947369, AUC 0.9824958443641663
Test Epoch3 layer4 Acc 0.9155263157894736, AUC 0.9824934005737305
Test Epoch3 layer5 Acc 0.9140789473684211, AUC 0.9824485778808594
Test Epoch3 layer6 Acc 0.9136842105263158, AUC 0.9825964570045471
Test Epoch3 layer7 Acc 0.9132894736842105, AUC 0.9822898507118225
Test Epoch3 layer8 Acc 0.9130263157894737, AUC 0.982147216796875
Test Epoch3 layer9 Acc 0.9132894736842105, AUC 0.9812259674072266
gc 0
Train Epoch4 Acc 0.945225 (113427/120000), AUC 0.9920681118965149
Test Epoch4 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch4 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch4 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch4 layer3 Acc 0.9152631578947369, AUC 0.9824958443641663
Test Epoch4 layer4 Acc 0.9155263157894736, AUC 0.9824934005737305
Test Epoch4 layer5 Acc 0.9140789473684211, AUC 0.9824485778808594
Test Epoch4 layer6 Acc 0.9136842105263158, AUC 0.9825964570045471
Test Epoch4 layer7 Acc 0.9132894736842105, AUC 0.9822898507118225
Test Epoch4 layer8 Acc 0.9130263157894737, AUC 0.982147216796875
Test Epoch4 layer9 Acc 0.9140789473684211, AUC 0.9808287024497986
gc 0
Train Epoch5 Acc 0.9451833333333334 (113422/120000), AUC 0.9920533299446106
Test Epoch5 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch5 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch5 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch5 layer3 Acc 0.9152631578947369, AUC 0.9824958443641663
Test Epoch5 layer4 Acc 0.9155263157894736, AUC 0.9824934005737305
Test Epoch5 layer5 Acc 0.9140789473684211, AUC 0.9824485778808594
Test Epoch5 layer6 Acc 0.9136842105263158, AUC 0.9825964570045471
Test Epoch5 layer7 Acc 0.9132894736842105, AUC 0.9822898507118225
Test Epoch5 layer8 Acc 0.9130263157894737, AUC 0.982147216796875
Test Epoch5 layer9 Acc 0.9140789473684211, AUC 0.9815772175788879
gc 0
Train Epoch6 Acc 0.9450166666666666 (113402/120000), AUC 0.9920635223388672
Test Epoch6 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch6 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch6 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch6 layer3 Acc 0.9152631578947369, AUC 0.9824958443641663
Test Epoch6 layer4 Acc 0.9155263157894736, AUC 0.9824934005737305
Test Epoch6 layer5 Acc 0.9140789473684211, AUC 0.9824485778808594
Test Epoch6 layer6 Acc 0.9136842105263158, AUC 0.9825964570045471
Test Epoch6 layer7 Acc 0.9132894736842105, AUC 0.9822898507118225
Test Epoch6 layer8 Acc 0.9130263157894737, AUC 0.982147216796875
Test Epoch6 layer9 Acc 0.9142105263157895, AUC 0.9805734157562256
gc 0
Train Epoch7 Acc 0.945275 (113433/120000), AUC 0.9920337200164795
Test Epoch7 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch7 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch7 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch7 layer3 Acc 0.9152631578947369, AUC 0.9824958443641663
Test Epoch7 layer4 Acc 0.9155263157894736, AUC 0.9824934005737305
Test Epoch7 layer5 Acc 0.9140789473684211, AUC 0.9824485778808594
Test Epoch7 layer6 Acc 0.9136842105263158, AUC 0.9825964570045471
Test Epoch7 layer7 Acc 0.9132894736842105, AUC 0.9822898507118225
Test Epoch7 layer8 Acc 0.9130263157894737, AUC 0.982147216796875
Test Epoch7 layer9 Acc 0.9143421052631578, AUC 0.981386661529541
gc 0
Train Epoch8 Acc 0.9450666666666667 (113408/120000), AUC 0.9920176267623901
Test Epoch8 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch8 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch8 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch8 layer3 Acc 0.9152631578947369, AUC 0.9824958443641663
Test Epoch8 layer4 Acc 0.9155263157894736, AUC 0.9824934005737305
Test Epoch8 layer5 Acc 0.9140789473684211, AUC 0.9824485778808594
Test Epoch8 layer6 Acc 0.9136842105263158, AUC 0.9825964570045471
Test Epoch8 layer7 Acc 0.9132894736842105, AUC 0.9822898507118225
Test Epoch8 layer8 Acc 0.9130263157894737, AUC 0.982147216796875
Test Epoch8 layer9 Acc 0.9139473684210526, AUC 0.9810622930526733
gc 0
Train Epoch9 Acc 0.945175 (113421/120000), AUC 0.991973340511322
Test Epoch9 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch9 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch9 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Test Epoch9 layer3 Acc 0.9152631578947369, AUC 0.9824958443641663
Test Epoch9 layer4 Acc 0.9155263157894736, AUC 0.9824934005737305
Test Epoch9 layer5 Acc 0.9140789473684211, AUC 0.9824485778808594
Test Epoch9 layer6 Acc 0.9136842105263158, AUC 0.9825964570045471
Test Epoch9 layer7 Acc 0.9132894736842105, AUC 0.9822898507118225
Test Epoch9 layer8 Acc 0.9130263157894737, AUC 0.982147216796875
Test Epoch9 layer9 Acc 0.9144736842105263, AUC 0.9807625412940979
Best AUC 0.9822534918785095
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask10//ag_news/ag_news_linearal_l10_m10.pt
[[1706   59   91   44]
 [  16 1860   16    8]
 [  48   15 1701  136]
 [  58   13  153 1676]]
Figure(640x480)
[[1700   59   94   47]
 [  13 1865   12   10]
 [  45   17 1684  154]
 [  53   15  135 1697]]
Figure(640x480)
[[1707   58   88   47]
 [  15 1861   14   10]
 [  56   17 1673  154]
 [  52   13  136 1699]]
Figure(640x480)
[[1702   60   92   46]
 [  12 1864   14   10]
 [  45   14 1706  135]
 [  51   16  149 1684]]
Figure(640x480)
[[1704   58   89   49]
 [  15 1862   14    9]
 [  48   15 1702  135]
 [  47   16  147 1690]]
Figure(640x480)
[[1703   58   86   53]
 [  14 1864   12   10]
 [  50   16 1684  150]
 [  50   16  138 1696]]
Figure(640x480)
[[1714   58   82   46]
 [  18 1861   11   10]
 [  58   16 1672  154]
 [  53   15  135 1697]]
Figure(640x480)
[[1705   59   85   51]
 [  14 1861   15   10]
 [  53   15 1675  157]
 [  52   13  135 1700]]
Figure(640x480)
[[1708   54   87   51]
 [  18 1851   17   14]
 [  54   10 1683  153]
 [  50   12  141 1697]]
Figure(640x480)
[[1711   56   81   52]
 [  15 1860   13   12]
 [  57   15 1670  158]
 [  49   13  133 1705]]
Figure(640x480)
