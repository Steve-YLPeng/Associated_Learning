total count words 102019
vocab size 30000
found 26754 words in glove
Start Training
gc 0
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.5158683061599731
Test Epoch0 layer0 Acc 0.910921052631579, AUC 0.9799839854240417
Save ckpt to ./ckpt/mask1//ag_news/ag_news_lstmal_l10_m1.pt  ,ep 0
Test Epoch0 layer1 Acc 0.26276315789473687, AUC 0.5165386199951172
Test Epoch0 layer2 Acc 0.24618421052631578, AUC 0.5130853652954102
Test Epoch0 layer3 Acc 0.2038157894736842, AUC 0.4356910288333893
Test Epoch0 layer4 Acc 0.285, AUC 0.49358201026916504
Test Epoch0 layer5 Acc 0.23092105263157894, AUC 0.49744078516960144
Test Epoch0 layer6 Acc 0.2569736842105263, AUC 0.5103052258491516
Test Epoch0 layer7 Acc 0.25, AUC 0.5208693146705627
Test Epoch0 layer8 Acc 0.2530263157894737, AUC 0.5545693635940552
Test Epoch0 layer9 Acc 0.25, AUC 0.503084123134613
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.5094499588012695
Test Epoch1 layer0 Acc 0.9155263157894736, AUC 0.9814221858978271
Save ckpt to ./ckpt/mask1//ag_news/ag_news_lstmal_l10_m1.pt  ,ep 1
Test Epoch1 layer1 Acc 0.26092105263157894, AUC 0.5159232020378113
Test Epoch1 layer2 Acc 0.24592105263157896, AUC 0.5115213990211487
Test Epoch1 layer3 Acc 0.2073684210526316, AUC 0.43690651655197144
Test Epoch1 layer4 Acc 0.28671052631578947, AUC 0.49214601516723633
Test Epoch1 layer5 Acc 0.23, AUC 0.49945056438446045
Test Epoch1 layer6 Acc 0.2625, AUC 0.5110352635383606
Test Epoch1 layer7 Acc 0.25, AUC 0.52040696144104
Test Epoch1 layer8 Acc 0.2710526315789474, AUC 0.5535074472427368
Test Epoch1 layer9 Acc 0.25, AUC 0.5014208555221558
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.504570484161377
Test Epoch2 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Save ckpt to ./ckpt/mask1//ag_news/ag_news_lstmal_l10_m1.pt  ,ep 2
Test Epoch2 layer1 Acc 0.2615789473684211, AUC 0.5152450799942017
Test Epoch2 layer2 Acc 0.2417105263157895, AUC 0.50972580909729
Test Epoch2 layer3 Acc 0.21210526315789474, AUC 0.4385071396827698
Test Epoch2 layer4 Acc 0.2875, AUC 0.49144989252090454
Test Epoch2 layer5 Acc 0.22960526315789473, AUC 0.4995177388191223
Test Epoch2 layer6 Acc 0.27171052631578946, AUC 0.5110594034194946
Test Epoch2 layer7 Acc 0.25, AUC 0.5199698209762573
Test Epoch2 layer8 Acc 0.2780263157894737, AUC 0.5519874095916748
Test Epoch2 layer9 Acc 0.25, AUC 0.4999949336051941
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5017404556274414
Test Epoch3 layer0 Acc 0.915, AUC 0.9813948273658752
Test Epoch3 layer1 Acc 0.2613157894736842, AUC 0.5149927735328674
Test Epoch3 layer2 Acc 0.24157894736842106, AUC 0.5089238286018372
Test Epoch3 layer3 Acc 0.21394736842105264, AUC 0.4395071864128113
Test Epoch3 layer4 Acc 0.2888157894736842, AUC 0.4910542368888855
Test Epoch3 layer5 Acc 0.22842105263157894, AUC 0.5000985860824585
Test Epoch3 layer6 Acc 0.28157894736842104, AUC 0.5121296644210815
Test Epoch3 layer7 Acc 0.25, AUC 0.5204274654388428
Test Epoch3 layer8 Acc 0.27131578947368423, AUC 0.5511094331741333
Test Epoch3 layer9 Acc 0.25, AUC 0.5001568794250488
gc 0
Train Epoch4 Acc 0.249925 (29991/120000), AUC 0.5011810064315796
Test Epoch4 layer0 Acc 0.9121052631578948, AUC 0.9810736179351807
Test Epoch4 layer1 Acc 0.2606578947368421, AUC 0.5143131017684937
Test Epoch4 layer2 Acc 0.2438157894736842, AUC 0.5074148178100586
Test Epoch4 layer3 Acc 0.21697368421052632, AUC 0.4401845633983612
Test Epoch4 layer4 Acc 0.2892105263157895, AUC 0.4906519055366516
Test Epoch4 layer5 Acc 0.22763157894736843, AUC 0.5001327395439148
Test Epoch4 layer6 Acc 0.2914473684210526, AUC 0.5124097466468811
Test Epoch4 layer7 Acc 0.25, AUC 0.5206341743469238
Test Epoch4 layer8 Acc 0.2618421052631579, AUC 0.5505225658416748
Test Epoch4 layer9 Acc 0.24907894736842107, AUC 0.49966955184936523
gc 0
Train Epoch5 Acc 0.24859166666666666 (29831/120000), AUC 0.5002721548080444
Test Epoch5 layer0 Acc 0.9143421052631578, AUC 0.9805911779403687
Test Epoch5 layer1 Acc 0.26092105263157894, AUC 0.514024019241333
Test Epoch5 layer2 Acc 0.2413157894736842, AUC 0.5065696835517883
Test Epoch5 layer3 Acc 0.21710526315789475, AUC 0.44003239274024963
Test Epoch5 layer4 Acc 0.28828947368421054, AUC 0.489906370639801
Test Epoch5 layer5 Acc 0.22657894736842105, AUC 0.4998193383216858
Test Epoch5 layer6 Acc 0.2939473684210526, AUC 0.5130723714828491
Test Epoch5 layer7 Acc 0.25, AUC 0.5210310816764832
Test Epoch5 layer8 Acc 0.2563157894736842, AUC 0.5501581430435181
Test Epoch5 layer9 Acc 0.24671052631578946, AUC 0.4987275004386902
gc 0
Train Epoch6 Acc 0.235975 (28317/120000), AUC 0.4995858371257782
Test Epoch6 layer0 Acc 0.9127631578947368, AUC 0.9802961349487305
Test Epoch6 layer1 Acc 0.26013157894736844, AUC 0.5136208534240723
Test Epoch6 layer2 Acc 0.24092105263157895, AUC 0.5051897168159485
Test Epoch6 layer3 Acc 0.21855263157894736, AUC 0.44036099314689636
Test Epoch6 layer4 Acc 0.2910526315789474, AUC 0.48890653252601624
Test Epoch6 layer5 Acc 0.22539473684210526, AUC 0.4988418221473694
Test Epoch6 layer6 Acc 0.2914473684210526, AUC 0.5136376619338989
Test Epoch6 layer7 Acc 0.25, AUC 0.5215594172477722
Test Epoch6 layer8 Acc 0.2536842105263158, AUC 0.5498403310775757
Test Epoch6 layer9 Acc 0.22131578947368422, AUC 0.4985674321651459
gc 0
Train Epoch7 Acc 0.21489166666666668 (25787/120000), AUC 0.4986037015914917
Test Epoch7 layer0 Acc 0.9121052631578948, AUC 0.9803916811943054
Test Epoch7 layer1 Acc 0.2598684210526316, AUC 0.5129356980323792
Test Epoch7 layer2 Acc 0.24184210526315789, AUC 0.5052151679992676
Test Epoch7 layer3 Acc 0.2181578947368421, AUC 0.441123366355896
Test Epoch7 layer4 Acc 0.2897368421052632, AUC 0.48880133032798767
Test Epoch7 layer5 Acc 0.22552631578947369, AUC 0.4995066225528717
Test Epoch7 layer6 Acc 0.29078947368421054, AUC 0.513832151889801
Test Epoch7 layer7 Acc 0.25, AUC 0.5213450193405151
Test Epoch7 layer8 Acc 0.25223684210526315, AUC 0.5496145486831665
Test Epoch7 layer9 Acc 0.20789473684210527, AUC 0.49875444173812866
gc 0
Train Epoch8 Acc 0.20300833333333335 (24361/120000), AUC 0.49816566705703735
Test Epoch8 layer0 Acc 0.9111842105263158, AUC 0.9801288843154907
Test Epoch8 layer1 Acc 0.26, AUC 0.5128257274627686
Test Epoch8 layer2 Acc 0.2413157894736842, AUC 0.504770040512085
Test Epoch8 layer3 Acc 0.21828947368421053, AUC 0.4417346119880676
Test Epoch8 layer4 Acc 0.2892105263157895, AUC 0.4881439208984375
Test Epoch8 layer5 Acc 0.22605263157894737, AUC 0.49981918931007385
Test Epoch8 layer6 Acc 0.28828947368421054, AUC 0.51418137550354
Test Epoch8 layer7 Acc 0.25, AUC 0.5213550329208374
Test Epoch8 layer8 Acc 0.25223684210526315, AUC 0.5490318536758423
Test Epoch8 layer9 Acc 0.2011842105263158, AUC 0.4982340335845947
gc 0
Train Epoch9 Acc 0.20844166666666666 (25013/120000), AUC 0.4985249936580658
Test Epoch9 layer0 Acc 0.9125, AUC 0.9798095226287842
Test Epoch9 layer1 Acc 0.2593421052631579, AUC 0.5125015377998352
Test Epoch9 layer2 Acc 0.24052631578947367, AUC 0.5045005679130554
Test Epoch9 layer3 Acc 0.2181578947368421, AUC 0.4422389566898346
Test Epoch9 layer4 Acc 0.2897368421052632, AUC 0.48796984553337097
Test Epoch9 layer5 Acc 0.22710526315789473, AUC 0.5001211166381836
Test Epoch9 layer6 Acc 0.2835526315789474, AUC 0.5144598484039307
Test Epoch9 layer7 Acc 0.25, AUC 0.5217738151550293
Test Epoch9 layer8 Acc 0.25092105263157893, AUC 0.5484864115715027
Test Epoch9 layer9 Acc 0.21802631578947368, AUC 0.49835750460624695
Best AUC 0.9816535115242004
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//ag_news/ag_news_lstmal_l10_m1.pt
[[1694   64   95   47]
 [  11 1870   10    9]
 [  39   19 1682  160]
 [  43   16  151 1690]]
Figure(640x480)
[[1702    1  148   49]
 [1667    7  126  100]
 [1628    2  238   32]
 [1690    0  169   41]]
Figure(640x480)
[[ 220   75 1140  465]
 [ 244  205  945  506]
 [ 381  111  742  666]
 [ 271  135  824  670]]
Figure(640x480)
[[ 132 1506  168   94]
 [ 394 1252  203   51]
 [ 148 1582  108   62]
 [ 152 1362  266  120]]
Figure(640x480)
[[ 676    0    5 1219]
 [ 680    0    1 1219]
 [ 521    0    1 1378]
 [ 392    0    0 1508]]
Figure(640x480)
[[ 789    2    0 1109]
 [ 761    3    0 1136]
 [1064   27    0  809]
 [ 944    2    1  953]]
Figure(640x480)
[[  10 1498  254  138]
 [   9 1676  104  111]
 [  22 1531  228  119]
 [  73 1343  333  151]]
Figure(640x480)
[[   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]]
Figure(640x480)
[[   0  760 1140    0]
 [   0  863 1037    0]
 [   0  650 1250    0]
 [   0  638 1262    0]]
Figure(640x480)
[[   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]]
Figure(640x480)
