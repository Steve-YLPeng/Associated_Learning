total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask3//ag_news/ag_news_lstmal_l10_m3.pt
Start Training
gc 9
Train Epoch0 Acc 0.12841666666666668 (15410/120000), AUC 0.4921131730079651
Test Epoch0 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch0 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch0 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch0 layer3 Acc 0.9110526315789473, AUC 0.9818061590194702
Save ckpt to ./ckpt/mask4//ag_news/ag_news_lstmal_l10_m4.pt  ,ep 0
Test Epoch0 layer4 Acc 0.27789473684210525, AUC 0.5186132192611694
Test Epoch0 layer5 Acc 0.028289473684210528, AUC 0.3317280113697052
Test Epoch0 layer6 Acc 0.05947368421052632, AUC 0.41758179664611816
Test Epoch0 layer7 Acc 0.4388157894736842, AUC 0.6903787851333618
Test Epoch0 layer8 Acc 0.25223684210526315, AUC 0.6686574220657349
Test Epoch0 layer9 Acc 0.1318421052631579, AUC 0.5174335241317749
gc 0
Train Epoch1 Acc 0.123575 (14829/120000), AUC 0.4978500008583069
Test Epoch1 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch1 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch1 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch1 layer3 Acc 0.9123684210526316, AUC 0.9821896553039551
Save ckpt to ./ckpt/mask4//ag_news/ag_news_lstmal_l10_m4.pt  ,ep 1
Test Epoch1 layer4 Acc 0.26802631578947367, AUC 0.4942712187767029
Test Epoch1 layer5 Acc 0.027894736842105264, AUC 0.33253487944602966
Test Epoch1 layer6 Acc 0.04684210526315789, AUC 0.3612836003303528
Test Epoch1 layer7 Acc 0.4180263157894737, AUC 0.676433801651001
Test Epoch1 layer8 Acc 0.25473684210526315, AUC 0.7228485941886902
Test Epoch1 layer9 Acc 0.13131578947368422, AUC 0.5019758939743042
gc 0
Train Epoch2 Acc 0.13830833333333334 (16597/120000), AUC 0.47852247953414917
Test Epoch2 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch2 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch2 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch2 layer3 Acc 0.9134210526315789, AUC 0.9825233817100525
Save ckpt to ./ckpt/mask4//ag_news/ag_news_lstmal_l10_m4.pt  ,ep 2
Test Epoch2 layer4 Acc 0.265, AUC 0.48852473497390747
Test Epoch2 layer5 Acc 0.049868421052631576, AUC 0.3318604826927185
Test Epoch2 layer6 Acc 0.045921052631578946, AUC 0.3378448486328125
Test Epoch2 layer7 Acc 0.3423684210526316, AUC 0.6515944004058838
Test Epoch2 layer8 Acc 0.25513157894736843, AUC 0.7555376291275024
Test Epoch2 layer9 Acc 0.15789473684210525, AUC 0.4736531376838684
gc 0
Train Epoch3 Acc 0.15685 (18822/120000), AUC 0.4582422077655792
Test Epoch3 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch3 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch3 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch3 layer3 Acc 0.9135526315789474, AUC 0.9810805320739746
Test Epoch3 layer4 Acc 0.26026315789473686, AUC 0.48783159255981445
Test Epoch3 layer5 Acc 0.0475, AUC 0.33252212405204773
Test Epoch3 layer6 Acc 0.04421052631578947, AUC 0.32331904768943787
Test Epoch3 layer7 Acc 0.28342105263157896, AUC 0.6156542301177979
Test Epoch3 layer8 Acc 0.255, AUC 0.7730256915092468
Test Epoch3 layer9 Acc 0.16710526315789473, AUC 0.46354418992996216
gc 0
Train Epoch4 Acc 0.17546666666666666 (21056/120000), AUC 0.4453074336051941
Test Epoch4 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch4 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch4 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch4 layer3 Acc 0.9138157894736842, AUC 0.9825156331062317
Test Epoch4 layer4 Acc 0.2588157894736842, AUC 0.48023369908332825
Test Epoch4 layer5 Acc 0.09144736842105264, AUC 0.33097636699676514
Test Epoch4 layer6 Acc 0.041973684210526316, AUC 0.3201920688152313
Test Epoch4 layer7 Acc 0.2636842105263158, AUC 0.523962676525116
Test Epoch4 layer8 Acc 0.25552631578947366, AUC 0.7726117968559265
Test Epoch4 layer9 Acc 0.19039473684210526, AUC 0.4566287696361542
gc 0
Train Epoch5 Acc 0.18705833333333333 (22447/120000), AUC 0.4466222822666168
Test Epoch5 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch5 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch5 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch5 layer3 Acc 0.9144736842105263, AUC 0.9826661944389343
Save ckpt to ./ckpt/mask4//ag_news/ag_news_lstmal_l10_m4.pt  ,ep 5
Test Epoch5 layer4 Acc 0.2565789473684211, AUC 0.48407089710235596
Test Epoch5 layer5 Acc 0.16473684210526315, AUC 0.33268776535987854
Test Epoch5 layer6 Acc 0.04078947368421053, AUC 0.33622217178344727
Test Epoch5 layer7 Acc 0.2530263157894737, AUC 0.46792423725128174
Test Epoch5 layer8 Acc 0.2567105263157895, AUC 0.7761175632476807
Test Epoch5 layer9 Acc 0.19460526315789473, AUC 0.45927008986473083
gc 0
Train Epoch6 Acc 0.19425 (23310/120000), AUC 0.44580239057540894
Test Epoch6 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch6 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch6 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch6 layer3 Acc 0.9147368421052632, AUC 0.9823821783065796
Test Epoch6 layer4 Acc 0.2563157894736842, AUC 0.4887048602104187
Test Epoch6 layer5 Acc 0.21973684210526315, AUC 0.3673831820487976
Test Epoch6 layer6 Acc 0.03894736842105263, AUC 0.3547976315021515
Test Epoch6 layer7 Acc 0.24789473684210525, AUC 0.44434064626693726
Test Epoch6 layer8 Acc 0.25802631578947366, AUC 0.7689962387084961
Test Epoch6 layer9 Acc 0.20842105263157895, AUC 0.46962225437164307
gc 0
Train Epoch7 Acc 0.20035 (24042/120000), AUC 0.45499926805496216
Test Epoch7 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch7 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch7 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch7 layer3 Acc 0.9144736842105263, AUC 0.9820384383201599
Test Epoch7 layer4 Acc 0.2569736842105263, AUC 0.46729469299316406
Test Epoch7 layer5 Acc 0.21644736842105264, AUC 0.37753725051879883
Test Epoch7 layer6 Acc 0.03657894736842105, AUC 0.346981942653656
Test Epoch7 layer7 Acc 0.2398684210526316, AUC 0.430024117231369
Test Epoch7 layer8 Acc 0.2588157894736842, AUC 0.7709446549415588
Test Epoch7 layer9 Acc 0.21171052631578946, AUC 0.4721716046333313
gc 0
Train Epoch8 Acc 0.200425 (24051/120000), AUC 0.46212640404701233
Test Epoch8 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch8 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch8 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch8 layer3 Acc 0.9148684210526316, AUC 0.9827561378479004
Save ckpt to ./ckpt/mask4//ag_news/ag_news_lstmal_l10_m4.pt  ,ep 8
Test Epoch8 layer4 Acc 0.2590789473684211, AUC 0.4550751745700836
Test Epoch8 layer5 Acc 0.2163157894736842, AUC 0.38144731521606445
Test Epoch8 layer6 Acc 0.035789473684210524, AUC 0.3674405813217163
Test Epoch8 layer7 Acc 0.2330263157894737, AUC 0.40807315707206726
Test Epoch8 layer8 Acc 0.2582894736842105, AUC 0.7658987641334534
Test Epoch8 layer9 Acc 0.2186842105263158, AUC 0.48322823643684387
gc 0
Train Epoch9 Acc 0.1981 (23772/120000), AUC 0.46604123711586
Test Epoch9 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch9 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Test Epoch9 layer2 Acc 0.9135526315789474, AUC 0.983453631401062
Test Epoch9 layer3 Acc 0.9152631578947369, AUC 0.9825998544692993
Test Epoch9 layer4 Acc 0.2603947368421053, AUC 0.44183337688446045
Test Epoch9 layer5 Acc 0.23078947368421052, AUC 0.38385263085365295
Test Epoch9 layer6 Acc 0.035789473684210524, AUC 0.3868391513824463
Test Epoch9 layer7 Acc 0.22381578947368422, AUC 0.4013839066028595
Test Epoch9 layer8 Acc 0.25776315789473686, AUC 0.7547681331634521
Test Epoch9 layer9 Acc 0.1863157894736842, AUC 0.4832507371902466
Best AUC 0.9827561378479004
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//ag_news/ag_news_lstmal_l10_m4.pt
[[1694   64   95   47]
 [  11 1870   10    9]
 [  39   19 1682  160]
 [  43   16  151 1690]]
Figure(640x480)
[[1723   52   70   55]
 [  24 1852   12   12]
 [  53   16 1658  173]
 [  48   17  124 1711]]
Figure(640x480)
[[1722   50   75   53]
 [  22 1851   15   12]
 [  49   15 1676  160]
 [  51   17  138 1694]]
Figure(640x480)
[[1717   50   75   58]
 [  22 1850   15   13]
 [  44   15 1676  165]
 [  43   16  131 1710]]
Figure(640x480)
[[  82   46  837  935]
 [  18 1785   37   60]
 [1790    7   98    5]
 [1128   13  755    4]]
Figure(640x480)
[[1609  208   82    1]
 [  33   13 1852    2]
 [ 299 1584   11    6]
 [1793   81   15   11]]
Figure(640x480)
[[   0   47   31 1822]
 [   0    9 1705  186]
 [   1  128   15 1756]
 [   3 1627   22  248]]
Figure(640x480)
[[   0 1896    0    4]
 [   0 1743    0  157]
 [   0 1896    0    4]
 [   0 1872    0   28]]
Figure(640x480)
[[   0 1897    0    3]
 [   0 1899    0    1]
 [   0 1884    0   16]
 [   0 1836    0   64]]
Figure(640x480)
[[   0 1685    0  215]
 [   0  190    0 1710]
 [   0   71    0 1829]
 [   0  428    0 1472]]
Figure(640x480)
