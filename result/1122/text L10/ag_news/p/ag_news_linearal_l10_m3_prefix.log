total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask2//ag_news/ag_news_linearal_l10_m2.pt
Start Training
gc 9
Train Epoch0 Acc 0.272525 (32703/120000), AUC 0.6473955512046814
Test Epoch0 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch0 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch0 layer2 Acc 0.9136842105263158, AUC 0.9816824197769165
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l10_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.26052631578947366, AUC 0.5336867570877075
Test Epoch0 layer4 Acc 0.22407894736842104, AUC 0.19319456815719604
Test Epoch0 layer5 Acc 0.1731578947368421, AUC 0.4733925461769104
Test Epoch0 layer6 Acc 0.20394736842105263, AUC 0.31500595808029175
Test Epoch0 layer7 Acc 0.21605263157894736, AUC 0.5907974243164062
Test Epoch0 layer8 Acc 0.3505263157894737, AUC 0.6296166777610779
Test Epoch0 layer9 Acc 0.26421052631578945, AUC 0.6658963561058044
gc 0
Train Epoch1 Acc 0.252725 (30327/120000), AUC 0.681811511516571
Test Epoch1 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch1 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch1 layer2 Acc 0.9142105263157895, AUC 0.9816081523895264
Test Epoch1 layer3 Acc 0.25605263157894737, AUC 0.5333172678947449
Test Epoch1 layer4 Acc 0.13644736842105262, AUC 0.16805344820022583
Test Epoch1 layer5 Acc 0.18171052631578946, AUC 0.44363492727279663
Test Epoch1 layer6 Acc 0.19921052631578948, AUC 0.32522937655448914
Test Epoch1 layer7 Acc 0.22828947368421051, AUC 0.5747401714324951
Test Epoch1 layer8 Acc 0.4027631578947368, AUC 0.6262010335922241
Test Epoch1 layer9 Acc 0.22789473684210526, AUC 0.6757670640945435
gc 0
Train Epoch2 Acc 0.17708333333333334 (21250/120000), AUC 0.6938327550888062
Test Epoch2 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch2 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch2 layer2 Acc 0.9127631578947368, AUC 0.9816027879714966
Test Epoch2 layer3 Acc 0.25592105263157894, AUC 0.5432977080345154
Test Epoch2 layer4 Acc 0.08118421052631579, AUC 0.15631476044654846
Test Epoch2 layer5 Acc 0.19276315789473683, AUC 0.4172734022140503
Test Epoch2 layer6 Acc 0.1868421052631579, AUC 0.33026930689811707
Test Epoch2 layer7 Acc 0.24263157894736842, AUC 0.5551900863647461
Test Epoch2 layer8 Acc 0.4189473684210526, AUC 0.6304311156272888
Test Epoch2 layer9 Acc 0.13815789473684212, AUC 0.6855398416519165
gc 0
Train Epoch3 Acc 0.09870833333333333 (11845/120000), AUC 0.6989041566848755
Test Epoch3 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch3 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch3 layer2 Acc 0.9134210526315789, AUC 0.9816558361053467
Test Epoch3 layer3 Acc 0.2556578947368421, AUC 0.551588237285614
Test Epoch3 layer4 Acc 0.0575, AUC 0.14387023448944092
Test Epoch3 layer5 Acc 0.22302631578947368, AUC 0.39562666416168213
Test Epoch3 layer6 Acc 0.17171052631578948, AUC 0.33770936727523804
Test Epoch3 layer7 Acc 0.2523684210526316, AUC 0.5390866994857788
Test Epoch3 layer8 Acc 0.4143421052631579, AUC 0.6433712244033813
Test Epoch3 layer9 Acc 0.09644736842105263, AUC 0.6776111125946045
gc 0
Train Epoch4 Acc 0.07035833333333333 (8443/120000), AUC 0.6722972393035889
Test Epoch4 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch4 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch4 layer2 Acc 0.9143421052631578, AUC 0.9817115068435669
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l10_m3.pt  ,ep 4
Test Epoch4 layer3 Acc 0.25513157894736843, AUC 0.5523661375045776
Test Epoch4 layer4 Acc 0.049473684210526316, AUC 0.1290661245584488
Test Epoch4 layer5 Acc 0.24, AUC 0.38614875078201294
Test Epoch4 layer6 Acc 0.12539473684210525, AUC 0.36416077613830566
Test Epoch4 layer7 Acc 0.2706578947368421, AUC 0.5200507640838623
Test Epoch4 layer8 Acc 0.41210526315789475, AUC 0.6659276485443115
Test Epoch4 layer9 Acc 0.07460526315789473, AUC 0.6403579711914062
gc 0
Train Epoch5 Acc 0.058491666666666664 (7019/120000), AUC 0.6475595831871033
Test Epoch5 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch5 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch5 layer2 Acc 0.9134210526315789, AUC 0.9819091558456421
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l10_m3.pt  ,ep 5
Test Epoch5 layer3 Acc 0.2556578947368421, AUC 0.5605530738830566
Test Epoch5 layer4 Acc 0.04026315789473684, AUC 0.11942572891712189
Test Epoch5 layer5 Acc 0.24736842105263157, AUC 0.3793467879295349
Test Epoch5 layer6 Acc 0.10684210526315789, AUC 0.38268446922302246
Test Epoch5 layer7 Acc 0.29736842105263156, AUC 0.5173527002334595
Test Epoch5 layer8 Acc 0.4073684210526316, AUC 0.6776778697967529
Test Epoch5 layer9 Acc 0.06644736842105263, AUC 0.6263976693153381
gc 0
Train Epoch6 Acc 0.0558 (6696/120000), AUC 0.6394312381744385
Test Epoch6 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch6 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch6 layer2 Acc 0.9135526315789474, AUC 0.9820284247398376
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l10_m3.pt  ,ep 6
Test Epoch6 layer3 Acc 0.2563157894736842, AUC 0.5608581304550171
Test Epoch6 layer4 Acc 0.030921052631578946, AUC 0.10806875675916672
Test Epoch6 layer5 Acc 0.2503947368421053, AUC 0.37695813179016113
Test Epoch6 layer6 Acc 0.08644736842105263, AUC 0.4041408896446228
Test Epoch6 layer7 Acc 0.31644736842105264, AUC 0.513433575630188
Test Epoch6 layer8 Acc 0.4048684210526316, AUC 0.6901659369468689
Test Epoch6 layer9 Acc 0.06776315789473684, AUC 0.6211298704147339
gc 0
Train Epoch7 Acc 0.057291666666666664 (6875/120000), AUC 0.636562705039978
Test Epoch7 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch7 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch7 layer2 Acc 0.9147368421052632, AUC 0.9820345640182495
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l10_m3.pt  ,ep 7
Test Epoch7 layer3 Acc 0.25644736842105265, AUC 0.5648286938667297
Test Epoch7 layer4 Acc 0.024473684210526314, AUC 0.09941510856151581
Test Epoch7 layer5 Acc 0.2563157894736842, AUC 0.3725166320800781
Test Epoch7 layer6 Acc 0.07355263157894737, AUC 0.42501699924468994
Test Epoch7 layer7 Acc 0.33144736842105266, AUC 0.5093857049942017
Test Epoch7 layer8 Acc 0.4001315789473684, AUC 0.69774329662323
Test Epoch7 layer9 Acc 0.07592105263157894, AUC 0.6185095310211182
gc 0
Train Epoch8 Acc 0.06290833333333333 (7549/120000), AUC 0.63277268409729
Test Epoch8 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch8 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch8 layer2 Acc 0.9135526315789474, AUC 0.9821195602416992
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l10_m3.pt  ,ep 8
Test Epoch8 layer3 Acc 0.25894736842105265, AUC 0.5712471604347229
Test Epoch8 layer4 Acc 0.019473684210526317, AUC 0.09162301570177078
Test Epoch8 layer5 Acc 0.2594736842105263, AUC 0.36984413862228394
Test Epoch8 layer6 Acc 0.07144736842105263, AUC 0.44676920771598816
Test Epoch8 layer7 Acc 0.3431578947368421, AUC 0.5026090145111084
Test Epoch8 layer8 Acc 0.4006578947368421, AUC 0.7032822370529175
Test Epoch8 layer9 Acc 0.07881578947368421, AUC 0.6144076585769653
gc 0
Train Epoch9 Acc 0.070075 (8409/120000), AUC 0.6254085302352905
Test Epoch9 layer0 Acc 0.9135526315789474, AUC 0.9816792607307434
Test Epoch9 layer1 Acc 0.9139473684210526, AUC 0.9816479682922363
Test Epoch9 layer2 Acc 0.9131578947368421, AUC 0.9822486639022827
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l10_m3.pt  ,ep 9
Test Epoch9 layer3 Acc 0.2615789473684211, AUC 0.5792238712310791
Test Epoch9 layer4 Acc 0.018289473684210526, AUC 0.08594220876693726
Test Epoch9 layer5 Acc 0.2594736842105263, AUC 0.36514055728912354
Test Epoch9 layer6 Acc 0.07263157894736842, AUC 0.46670615673065186
Test Epoch9 layer7 Acc 0.3543421052631579, AUC 0.4940561354160309
Test Epoch9 layer8 Acc 0.39960526315789474, AUC 0.7064849734306335
Test Epoch9 layer9 Acc 0.08486842105263158, AUC 0.6058764457702637
Best AUC 0.9822486639022827
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//ag_news/ag_news_linearal_l10_m3.pt
[[1706   59   91   44]
 [  16 1860   16    8]
 [  48   15 1701  136]
 [  58   13  153 1676]]
Figure(640x480)
[[1700   59   94   47]
 [  13 1865   12   10]
 [  45   17 1684  154]
 [  53   15  135 1697]]
Figure(640x480)
[[1707   58   88   47]
 [  15 1861   14   10]
 [  56   17 1673  154]
 [  52   13  136 1699]]
Figure(640x480)
[[  69 1811    4   16]
 [   1 1899    0    0]
 [ 586 1075   17  222]
 [   9 1888    0    3]]
Figure(640x480)
[[   0 1850   50    0]
 [   7   83 1799   11]
 [  21 1823   56    0]
 [   0 1727  173    0]]
Figure(640x480)
[[1606    0  237   57]
 [1039    0  858    3]
 [ 499    0  246 1155]
 [  38    0 1742  120]]
Figure(640x480)
[[ 325    0 1575    0]
 [   5    0 1895    0]
 [1673    0  227    0]
 [ 707    0 1193    0]]
Figure(640x480)
[[   0   71  117 1712]
 [   0    5 1526  369]
 [   0  232 1580   88]
 [   0  135  657 1108]]
Figure(640x480)
[[1204  522   64  110]
 [ 719    6    0 1175]
 [  89   18   16 1777]
 [  52   35    2 1811]]
Figure(640x480)
[[ 179    8   11 1702]
 [  62   12    0 1826]
 [ 410    7  372 1111]
 [1815    1    2   82]]
Figure(640x480)
