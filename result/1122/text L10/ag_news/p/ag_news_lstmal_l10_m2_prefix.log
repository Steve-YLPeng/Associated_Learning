total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask1//ag_news/ag_news_lstmal_l10_m1.pt
Start Training
gc 9
Train Epoch0 Acc 0.25 (30000/120000), AUC 0.5371258854866028
Test Epoch0 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch0 layer1 Acc 0.9128947368421053, AUC 0.9820916652679443
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l10_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.3082894736842105, AUC 0.6161179542541504
Test Epoch0 layer3 Acc 0.31092105263157893, AUC 0.48261719942092896
Test Epoch0 layer4 Acc 0.3331578947368421, AUC 0.4383538067340851
Test Epoch0 layer5 Acc 0.06631578947368422, AUC 0.40945756435394287
Test Epoch0 layer6 Acc 0.2501315789473684, AUC 0.7179980278015137
Test Epoch0 layer7 Acc 0.25, AUC 0.8293972611427307
Test Epoch0 layer8 Acc 0.25, AUC 0.6574689149856567
Test Epoch0 layer9 Acc 0.25, AUC 0.562275230884552
gc 0
Train Epoch1 Acc 0.25 (30000/120000), AUC 0.5553237199783325
Test Epoch1 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch1 layer1 Acc 0.9118421052631579, AUC 0.983147382736206
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l10_m2.pt  ,ep 1
Test Epoch1 layer2 Acc 0.2943421052631579, AUC 0.6007474064826965
Test Epoch1 layer3 Acc 0.28092105263157896, AUC 0.4454229474067688
Test Epoch1 layer4 Acc 0.3144736842105263, AUC 0.40585002303123474
Test Epoch1 layer5 Acc 0.08789473684210526, AUC 0.42922163009643555
Test Epoch1 layer6 Acc 0.25, AUC 0.6886111497879028
Test Epoch1 layer7 Acc 0.25, AUC 0.8540887832641602
Test Epoch1 layer8 Acc 0.25, AUC 0.6370863318443298
Test Epoch1 layer9 Acc 0.25, AUC 0.5586379170417786
gc 0
Train Epoch2 Acc 0.25 (30000/120000), AUC 0.5485130548477173
Test Epoch2 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch2 layer1 Acc 0.9146052631578947, AUC 0.9832599759101868
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l10_m2.pt  ,ep 2
Test Epoch2 layer2 Acc 0.2873684210526316, AUC 0.5980104207992554
Test Epoch2 layer3 Acc 0.26342105263157894, AUC 0.4328545331954956
Test Epoch2 layer4 Acc 0.2869736842105263, AUC 0.3834249973297119
Test Epoch2 layer5 Acc 0.10144736842105263, AUC 0.43474507331848145
Test Epoch2 layer6 Acc 0.25, AUC 0.6722267270088196
Test Epoch2 layer7 Acc 0.25, AUC 0.8684186935424805
Test Epoch2 layer8 Acc 0.25, AUC 0.5983607769012451
Test Epoch2 layer9 Acc 0.25, AUC 0.5489554405212402
gc 0
Train Epoch3 Acc 0.25 (30000/120000), AUC 0.5377770662307739
Test Epoch3 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch3 layer1 Acc 0.9139473684210526, AUC 0.9832412004470825
Test Epoch3 layer2 Acc 0.28407894736842104, AUC 0.5975602865219116
Test Epoch3 layer3 Acc 0.26026315789473686, AUC 0.4244197905063629
Test Epoch3 layer4 Acc 0.2826315789473684, AUC 0.3776121437549591
Test Epoch3 layer5 Acc 0.11828947368421053, AUC 0.4390493631362915
Test Epoch3 layer6 Acc 0.25, AUC 0.6641696691513062
Test Epoch3 layer7 Acc 0.25, AUC 0.8776923418045044
Test Epoch3 layer8 Acc 0.25, AUC 0.5754082202911377
Test Epoch3 layer9 Acc 0.25, AUC 0.5407480001449585
gc 0
Train Epoch4 Acc 0.25 (30000/120000), AUC 0.5286016464233398
Test Epoch4 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch4 layer1 Acc 0.9136842105263158, AUC 0.983317494392395
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l10_m2.pt  ,ep 4
Test Epoch4 layer2 Acc 0.2794736842105263, AUC 0.5939140915870667
Test Epoch4 layer3 Acc 0.2575, AUC 0.41440248489379883
Test Epoch4 layer4 Acc 0.2748684210526316, AUC 0.3748846650123596
Test Epoch4 layer5 Acc 0.14328947368421052, AUC 0.4312759041786194
Test Epoch4 layer6 Acc 0.25, AUC 0.6646498441696167
Test Epoch4 layer7 Acc 0.25, AUC 0.8774611949920654
Test Epoch4 layer8 Acc 0.25, AUC 0.5729293823242188
Test Epoch4 layer9 Acc 0.25, AUC 0.5334347486495972
gc 0
Train Epoch5 Acc 0.25 (30000/120000), AUC 0.5169792771339417
Test Epoch5 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch5 layer1 Acc 0.9142105263157895, AUC 0.9832281470298767
Test Epoch5 layer2 Acc 0.2893421052631579, AUC 0.5968148112297058
Test Epoch5 layer3 Acc 0.2648684210526316, AUC 0.42007261514663696
Test Epoch5 layer4 Acc 0.27052631578947367, AUC 0.3678280711174011
Test Epoch5 layer5 Acc 0.1731578947368421, AUC 0.43977004289627075
Test Epoch5 layer6 Acc 0.2501315789473684, AUC 0.6528482437133789
Test Epoch5 layer7 Acc 0.25, AUC 0.8826801776885986
Test Epoch5 layer8 Acc 0.25, AUC 0.5639247894287109
Test Epoch5 layer9 Acc 0.25, AUC 0.523483395576477
gc 0
Train Epoch6 Acc 0.25 (30000/120000), AUC 0.5077347755432129
Test Epoch6 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch6 layer1 Acc 0.9122368421052631, AUC 0.9827541708946228
Test Epoch6 layer2 Acc 0.27842105263157896, AUC 0.5967608690261841
Test Epoch6 layer3 Acc 0.2606578947368421, AUC 0.41588884592056274
Test Epoch6 layer4 Acc 0.2777631578947368, AUC 0.3608306050300598
Test Epoch6 layer5 Acc 0.16605263157894737, AUC 0.440798819065094
Test Epoch6 layer6 Acc 0.25, AUC 0.651293158531189
Test Epoch6 layer7 Acc 0.25, AUC 0.8888039588928223
Test Epoch6 layer8 Acc 0.25, AUC 0.5547010898590088
Test Epoch6 layer9 Acc 0.25, AUC 0.5149080157279968
gc 0
Train Epoch7 Acc 0.25001666666666666 (30002/120000), AUC 0.5008785724639893
Test Epoch7 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch7 layer1 Acc 0.9126315789473685, AUC 0.9825690984725952
Test Epoch7 layer2 Acc 0.2780263157894737, AUC 0.5978207588195801
Test Epoch7 layer3 Acc 0.26355263157894737, AUC 0.41499537229537964
Test Epoch7 layer4 Acc 0.2889473684210526, AUC 0.36468812823295593
Test Epoch7 layer5 Acc 0.17473684210526316, AUC 0.4427136182785034
Test Epoch7 layer6 Acc 0.25, AUC 0.6510382890701294
Test Epoch7 layer7 Acc 0.25, AUC 0.8863040208816528
Test Epoch7 layer8 Acc 0.25, AUC 0.5548068881034851
Test Epoch7 layer9 Acc 0.25, AUC 0.5087569952011108
gc 0
Train Epoch8 Acc 0.25001666666666666 (30002/120000), AUC 0.49676674604415894
Test Epoch8 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch8 layer1 Acc 0.9131578947368421, AUC 0.9824830889701843
Test Epoch8 layer2 Acc 0.2756578947368421, AUC 0.5932274460792542
Test Epoch8 layer3 Acc 0.26342105263157894, AUC 0.4115736484527588
Test Epoch8 layer4 Acc 0.2914473684210526, AUC 0.3626523017883301
Test Epoch8 layer5 Acc 0.17657894736842106, AUC 0.4405628442764282
Test Epoch8 layer6 Acc 0.25026315789473685, AUC 0.6557648777961731
Test Epoch8 layer7 Acc 0.25, AUC 0.884247362613678
Test Epoch8 layer8 Acc 0.25, AUC 0.5566810369491577
Test Epoch8 layer9 Acc 0.25, AUC 0.5008668899536133
gc 0
Train Epoch9 Acc 0.2501 (30012/120000), AUC 0.4922836720943451
Test Epoch9 layer0 Acc 0.9126315789473685, AUC 0.9816535115242004
Test Epoch9 layer1 Acc 0.9134210526315789, AUC 0.9822664260864258
Test Epoch9 layer2 Acc 0.27460526315789474, AUC 0.6017442941665649
Test Epoch9 layer3 Acc 0.27, AUC 0.4166519045829773
Test Epoch9 layer4 Acc 0.29578947368421055, AUC 0.3594772219657898
Test Epoch9 layer5 Acc 0.16907894736842105, AUC 0.44185590744018555
Test Epoch9 layer6 Acc 0.2505263157894737, AUC 0.6461324691772461
Test Epoch9 layer7 Acc 0.25, AUC 0.8893013000488281
Test Epoch9 layer8 Acc 0.25, AUC 0.5469138622283936
Test Epoch9 layer9 Acc 0.25, AUC 0.5042164921760559
Best AUC 0.983317494392395
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//ag_news/ag_news_lstmal_l10_m2.pt
[[1694   64   95   47]
 [  11 1870   10    9]
 [  39   19 1682  160]
 [  43   16  151 1690]]
Figure(640x480)
[[1723   52   70   55]
 [  24 1852   12   12]
 [  53   16 1658  173]
 [  48   17  124 1711]]
Figure(640x480)
[[   0    0  615 1285]
 [   0    0 1786  114]
 [   0    0 1862   38]
 [   0    0 1638  262]]
Figure(640x480)
[[   1 1899    0    0]
 [   0 1894    4    2]
 [   3 1897    0    0]
 [  77 1744   17   62]]
Figure(640x480)
[[1889    0    3    8]
 [1840    0   27   33]
 [1879    0   15    6]
 [1570    0  145  185]]
Figure(640x480)
[[1039  611  235   15]
 [1724   26    0  150]
 [ 438 1453    8    1]
 [1734  146    4   16]]
Figure(640x480)
[[   0 1899    0    1]
 [   0 1900    0    0]
 [   0 1880    0   20]
 [   0 1900    0    0]]
Figure(640x480)
[[   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]]
Figure(640x480)
[[   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]]
Figure(640x480)
[[   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]]
Figure(640x480)
