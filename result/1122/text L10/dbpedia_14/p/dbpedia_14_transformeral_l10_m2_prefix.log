total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask1//dbpedia_14/dbpedia_14_transformeral_l10_m1_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.08903928571428571 (49862/560000), AUC 0.5596814751625061
Test Epoch0 layer0 Acc 0.9737, AUC 0.9983097910881042
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_transformeral_l10_m2_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9737714285714286, AUC 0.9983567595481873
Save ckpt to ./ckpt/mask2//dbpedia_14/dbpedia_14_transformeral_l10_m2_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.10882857142857143, AUC 0.5923877954483032
Test Epoch0 layer3 Acc 0.13512857142857143, AUC 0.7247489094734192
Test Epoch0 layer4 Acc 0.0015857142857142858, AUC 0.45113903284072876
Test Epoch0 layer5 Acc 0.08044285714285715, AUC 0.5113950967788696
Test Epoch0 layer6 Acc 0.07312857142857143, AUC 0.6313815712928772
Test Epoch0 layer7 Acc 0.06797142857142857, AUC 0.5831779837608337
Test Epoch0 layer8 Acc 0.07174285714285714, AUC 0.6336835026741028
Test Epoch0 layer9 Acc 0.0482, AUC 0.5261136293411255
gc 0
Train Epoch1 Acc 0.06742142857142858 (37756/560000), AUC 0.5064214468002319
Test Epoch1 layer0 Acc 0.9736857142857143, AUC 0.9983095526695251
Test Epoch1 layer1 Acc 0.9786857142857143, AUC 0.9980878829956055
Test Epoch1 layer2 Acc 0.17332857142857142, AUC 0.5512539148330688
Test Epoch1 layer3 Acc 0.13852857142857142, AUC 0.7016952633857727
Test Epoch1 layer4 Acc 0.0011714285714285715, AUC 0.4218931794166565
Test Epoch1 layer5 Acc 0.007042857142857143, AUC 0.45245152711868286
Test Epoch1 layer6 Acc 0.048785714285714286, AUC 0.6538346409797668
Test Epoch1 layer7 Acc 0.07141428571428571, AUC 0.5975885391235352
Test Epoch1 layer8 Acc 0.07145714285714286, AUC 0.607872486114502
Test Epoch1 layer9 Acc 0.09665714285714286, AUC 0.4880724251270294
gc 0
Train Epoch2 Acc 0.12028928571428571 (67362/560000), AUC 0.4951830208301544
Test Epoch2 layer0 Acc 0.9737285714285714, AUC 0.9982580542564392
Test Epoch2 layer1 Acc 0.9788857142857142, AUC 0.9979297518730164
Test Epoch2 layer2 Acc 0.08602857142857143, AUC 0.5438042283058167
Test Epoch2 layer3 Acc 0.12837142857142858, AUC 0.6903837323188782
Test Epoch2 layer4 Acc 0.0010142857142857143, AUC 0.4400436580181122
Test Epoch2 layer5 Acc 0.0024285714285714284, AUC 0.4571343958377838
Test Epoch2 layer6 Acc 0.07194285714285714, AUC 0.6279506087303162
Test Epoch2 layer7 Acc 0.0714, AUC 0.56720370054245
Test Epoch2 layer8 Acc 0.07144285714285714, AUC 0.5834914445877075
Test Epoch2 layer9 Acc 0.1316857142857143, AUC 0.49770307540893555
gc 0
Train Epoch3 Acc 0.13275714285714285 (74344/560000), AUC 0.506001353263855
Test Epoch3 layer0 Acc 0.9735142857142857, AUC 0.998282790184021
Test Epoch3 layer1 Acc 0.9789, AUC 0.997870147228241
Test Epoch3 layer2 Acc 0.1985, AUC 0.5706925392150879
Test Epoch3 layer3 Acc 0.1248, AUC 0.6875033378601074
Test Epoch3 layer4 Acc 0.0008714285714285714, AUC 0.45486873388290405
Test Epoch3 layer5 Acc 0.0011714285714285715, AUC 0.47505828738212585
Test Epoch3 layer6 Acc 0.07177142857142857, AUC 0.6000840067863464
Test Epoch3 layer7 Acc 0.07138571428571429, AUC 0.5583785772323608
Test Epoch3 layer8 Acc 0.07142857142857142, AUC 0.561614990234375
Test Epoch3 layer9 Acc 0.13674285714285714, AUC 0.5061101317405701
gc 0
Train Epoch4 Acc 0.13265892857142858 (74289/560000), AUC 0.5050679445266724
Test Epoch4 layer0 Acc 0.9736714285714285, AUC 0.998266339302063
Test Epoch4 layer1 Acc 0.9796142857142857, AUC 0.9976901412010193
Test Epoch4 layer2 Acc 0.17254285714285714, AUC 0.5850251913070679
Test Epoch4 layer3 Acc 0.09764285714285714, AUC 0.6772758364677429
Test Epoch4 layer4 Acc 0.0013142857142857142, AUC 0.47550249099731445
Test Epoch4 layer5 Acc 0.0015285714285714286, AUC 0.47731953859329224
Test Epoch4 layer6 Acc 0.07177142857142857, AUC 0.5925331115722656
Test Epoch4 layer7 Acc 0.07134285714285714, AUC 0.5664852857589722
Test Epoch4 layer8 Acc 0.07144285714285714, AUC 0.5454422831535339
Test Epoch4 layer9 Acc 0.15271428571428572, AUC 0.4940324127674103
gc 0
Train Epoch5 Acc 0.13228392857142857 (74079/560000), AUC 0.49732545018196106
Test Epoch5 layer0 Acc 0.9736, AUC 0.998284637928009
Test Epoch5 layer1 Acc 0.9794714285714285, AUC 0.997585654258728
Test Epoch5 layer2 Acc 0.149, AUC 0.5886726379394531
Test Epoch5 layer3 Acc 0.08834285714285714, AUC 0.6644545793533325
Test Epoch5 layer4 Acc 0.0014428571428571429, AUC 0.48587989807128906
Test Epoch5 layer5 Acc 0.0014428571428571429, AUC 0.4838511645793915
Test Epoch5 layer6 Acc 0.07177142857142857, AUC 0.5900464653968811
Test Epoch5 layer7 Acc 0.07144285714285714, AUC 0.5618008971214294
Test Epoch5 layer8 Acc 0.07145714285714286, AUC 0.5392002463340759
Test Epoch5 layer9 Acc 0.13484285714285715, AUC 0.4897558093070984
gc 0
Train Epoch6 Acc 0.13156607142857143 (73677/560000), AUC 0.49191293120384216
Test Epoch6 layer0 Acc 0.9736, AUC 0.9983030557632446
Test Epoch6 layer1 Acc 0.9795857142857143, AUC 0.9977144002914429
Test Epoch6 layer2 Acc 0.1525, AUC 0.5909379720687866
Test Epoch6 layer3 Acc 0.08021428571428571, AUC 0.6600175499916077
Test Epoch6 layer4 Acc 0.0013571428571428571, AUC 0.48554369807243347
Test Epoch6 layer5 Acc 0.0013285714285714285, AUC 0.48600998520851135
Test Epoch6 layer6 Acc 0.07175714285714285, AUC 0.5843877792358398
Test Epoch6 layer7 Acc 0.07125714285714285, AUC 0.5606334805488586
Test Epoch6 layer8 Acc 0.07148571428571429, AUC 0.5386150479316711
Test Epoch6 layer9 Acc 0.14182857142857141, AUC 0.48130300641059875
gc 0
Train Epoch7 Acc 0.13768392857142858 (77103/560000), AUC 0.4867570996284485
Test Epoch7 layer0 Acc 0.9736142857142858, AUC 0.9982540011405945
Test Epoch7 layer1 Acc 0.9788142857142857, AUC 0.9975084066390991
Test Epoch7 layer2 Acc 0.15365714285714285, AUC 0.601043701171875
Test Epoch7 layer3 Acc 0.07935714285714286, AUC 0.6568418741226196
Test Epoch7 layer4 Acc 0.0015, AUC 0.48778730630874634
Test Epoch7 layer5 Acc 0.0012857142857142856, AUC 0.4857431948184967
Test Epoch7 layer6 Acc 0.07171428571428572, AUC 0.5818673372268677
Test Epoch7 layer7 Acc 0.07125714285714285, AUC 0.5582912564277649
Test Epoch7 layer8 Acc 0.07144285714285714, AUC 0.5302159190177917
Test Epoch7 layer9 Acc 0.1512, AUC 0.4817511737346649
gc 0
Train Epoch8 Acc 0.13727678571428573 (76875/560000), AUC 0.4798993468284607
Test Epoch8 layer0 Acc 0.9737857142857143, AUC 0.9982777237892151
Test Epoch8 layer1 Acc 0.9789, AUC 0.997528076171875
Test Epoch8 layer2 Acc 0.15852857142857144, AUC 0.6014513373374939
Test Epoch8 layer3 Acc 0.07508571428571428, AUC 0.6550348997116089
Test Epoch8 layer4 Acc 0.0015857142857142858, AUC 0.48661884665489197
Test Epoch8 layer5 Acc 0.0014, AUC 0.48649781942367554
Test Epoch8 layer6 Acc 0.07175714285714285, AUC 0.5772224068641663
Test Epoch8 layer7 Acc 0.07127142857142857, AUC 0.554868757724762
Test Epoch8 layer8 Acc 0.07145714285714286, AUC 0.5233271718025208
Test Epoch8 layer9 Acc 0.1505142857142857, AUC 0.4775378406047821
gc 0
Train Epoch9 Acc 0.1408875 (78897/560000), AUC 0.47594961524009705
Test Epoch9 layer0 Acc 0.9738857142857142, AUC 0.9982780814170837
Test Epoch9 layer1 Acc 0.9787428571428571, AUC 0.9973911643028259
Test Epoch9 layer2 Acc 0.16174285714285713, AUC 0.602716863155365
Test Epoch9 layer3 Acc 0.0774, AUC 0.6576671600341797
Test Epoch9 layer4 Acc 0.0016857142857142856, AUC 0.4898283779621124
Test Epoch9 layer5 Acc 0.0015, AUC 0.48602962493896484
Test Epoch9 layer6 Acc 0.07162857142857143, AUC 0.5729343295097351
Test Epoch9 layer7 Acc 0.07127142857142857, AUC 0.5583189725875854
Test Epoch9 layer8 Acc 0.07147142857142857, AUC 0.522032618522644
Test Epoch9 layer9 Acc 0.15071428571428572, AUC 0.4691016674041748
Best AUC 0.9983567595481873
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//dbpedia_14/dbpedia_14_transformeral_l10_m2_prefix.pt
[[4698   38   20   14   12   69   43    8    3    6    6   21   19   43]
 [  38 4887    6    1    7    0   33   10    4    2    1    0    4    7]
 [  36   12 4615   19   52    1   11    7    6    0    1   82   21  137]
 [   4    1   32 4948   11    0    1    1    0    0    0    0    0    2]
 [   9   16   87   13 4839    9    7    3    2    1    0    0    3   11]
 [  36    1    3    3    1 4942    5    3    1    2    0    0    1    2]
 [  58   41    5    3   11   15 4807   37    9    5    1    1    5    2]
 [   0    1    0    0    2    0   13 4963   16    3    1    0    0    1]
 [   1    3    2    0    3    0   13   14 4964    0    0    0    0    0]
 [   1    0    1    2    1    0    0    8    0 4952   34    0    0    1]
 [  12    1    0    0    0    0    2    5    0   32 4948    0    0    0]
 [   7    0   38    2    0    0    1    0    0    1    1 4923   17   10]
 [  10    2   23    4    1    2    1    3    1    3    0   20 4888   42]
 [  32    4   83    7   12    3    3    9    1    4    4    6   47 4785]]
Figure(640x480)
[[4611   47   22   12   13   72   53    7    1    4    6   42   25   85]
 [  32 4904    1    2    8    2   30    1    1    1    1    1    8    8]
 [  29   20 4553   19   73    1   21    3    1    0    0   86   47  147]
 [   2    2   20 4961   10    1    2    0    0    0    0    0    1    1]
 [   5   12   55   19 4879    5    8    1    1    3    0    0    4    8]
 [  35    0    2    2    1 4940    8    4    1    2    0    2    3    0]
 [  43   40    5    3   12   17 4835   25    4    4    0    1    6    5]
 [   1    1    0    0    5    0   27 4944   12    3    5    0    1    1]
 [   1    4    3    0    5    0   17   14 4953    1    0    0    0    2]
 [   1    0    2    2    1    1    2    8    0 4953   29    0    0    1]
 [  10    2    1    0    0    1    2    1    0   34 4949    0    0    0]
 [   9    1   30    2    0    0    1    0    0    0    1 4919   23   14]
 [   4    1   10    3    0    2    0    0    0    1    0   19 4924   36]
 [  18    3   37    6   10    3    3    0    0    1    1   10   69 4839]]
Figure(640x480)
[[   0    0    0    0    0    0    7    0    0    0    2    0 4991    0]
 [   0    0    0    0    0    0    1    0    0    0 1050    0 3949    0]
 [   0    0    0    0    0    0 1775    0    0    0   21    0 3204    0]
 [   0    0    0    0    0    0    1    0    0    0    0    0 4999    0]
 [   0    0    0    0    0    0    4    0    0    0    0    0 4996    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0 2599    0    0    0    1    0 2400    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    1    0    0    0    0    0 4999    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    0    0    0    0   19    0 4981    0]
 [   0    0    0    0    0    0    1    0    0    0    0    0 4999    0]
 [   0    0    0    0    0    0    0    0    0    0    0    0 5000    0]
 [   0    0    0    0    0    0    3    0    0    0    0    0 4997    0]]
Figure(640x480)
[[   0    0    0    0  395    0    0 4426    0    0    0    0  179    0]
 [   0    0    0    5   26    0    0 4968    0    0    0    0    1    0]
 [   0    0    0    0  175    0    0 4825    0    0    0    0    0    0]
 [   0    0    0    0 4811    0    0  189    0    0    0    0    0    0]
 [   0    0    0    0 4501    0    0  499    0    0    0    0    0    0]
 [   0    0    0    0    6    0    0 4994    0    0    0    0    0    0]
 [   0    0    0    0 4707    0    0  275   18    0    0    0    0    0]
 [   0    0    0    0   42    0    0 4958    0    0    0    0    0    0]
 [   0    0    0    0 4934    0    0   66    0    0    0    0    0    0]
 [   0    0    0    0  146    0    0 4854    0    0    0    0    0    0]
 [   0    0    0    0   38    0    0 4962    0    0    0    0    0    0]
 [   0    0    0    0   12    0    0 4988    0    0    0    0    0    0]
 [   0    0    0   25 4787    0    0  188    0    0    0    0    0    0]
 [   0    0    0    0   29    0    0 4971    0    0    0    0    0    0]]
Figure(640x480)
[[   0   19   44    0  132    0    0    0    0    0    0 4774   31    0]
 [   0    4   34    0 4881    0    3    0    0    0    0   77    1    0]
 [   0   62    7    0 1431    0    0    0    1    0    0 3472   27    0]
 [   0    2    0    0    4    0    1    0    0    0    0 4992    1    0]
 [   0    1    4    0   46    0    0    0    0    0    0 4890   59    0]
 [   0   52    6    0  118    0    5    0    0    0    0   68 4751    0]
 [   0   17 4415    0   89    0    0    0    1    0    0  117  361    0]
 [   0    0   14    0    3    0    0    0    0    0    0 4971   12    0]
 [   0    0   30    0  434    0    0    0    0    0    0 4529    7    0]
 [   0   12    0    0 2188    0    0    0    0    0    0   86 2714    0]
 [   0    0    1    0 4922    0    0    0    0    0    0   72    5    0]
 [   0 4324  155    0  289    0  114    0    0    0    0   50   68    0]
 [   0   34 1831    0   13    0   95    0 2200    0    0  823    4    0]
 [   0 4519   25    0  205    0   17    0    3    0    0  221   10    0]]
Figure(640x480)
[[   0    0    0    0 2597    0    0    0  519    0    0 1884    0    0]
 [   0    0    0    0  615    0    0    0 4305    0    0   80    0    0]
 [   0    0    0    0   26    0    0    0 3889    0    1 1084    0    0]
 [   0    0    0    0    7    0    0    0 4954    0    0   39    0    0]
 [   0    0    0    0    1    0    0    0   49    0    0 4950    0    0]
 [   0    0    0    0   52    0    0    0 4872    0    0   76    0    0]
 [   0    0    0    0    3    0    0    0 4930    0    0   67    0    0]
 [   0    0    0    0    0    0    0    0  485    0    0 4515    0    0]
 [   0    0    0    0    1    0    0    0 4953    0    0   39    7    0]
 [   0    0    0    0    0    0    0    0 4990    0    0   10    0    0]
 [   0    0    0    0    3    0    0    0 4688    0    0  309    0    0]
 [   0    0    0    0 4210    0    0    0  113    0    0  677    0    0]
 [   0    0    0    0  815    0    0    0 4091    0    0   94    0    0]
 [   0    0    0    0   34    0    0    0   59    0    0 4907    0    0]]
Figure(640x480)
[[  52    0    1    1 4846    0    0    0    0    0   96    0    0    4]
 [   0    0    0   93 4904    0    0    0    0    0    3    0    0    0]
 [   0   44    0    1 1145    0    0    0    0    0 3810    0    0    0]
 [   0    0    0    0 4994    0    0    0    0    0    6    0    0    0]
 [   0    0    0    0 4979    0    0    0    0    0   21    0    0    0]
 [  33    0  516    0   78    1   32    0    0    0 4319    0    0   21]
 [   0    0    0    0 4895    0    0    0    0    0  105    0    0    0]
 [   0    0    0    0 4954    0    0    0    0    0   46    0    0    0]
 [   0    0    0    0 4998    0    0    0    0    0    2    0    0    0]
 [   0    0    0    0 5000    0    0    0    0    0    0    0    0    0]
 [   0    0    0    1 4912    0    0    0    0    0   87    0    0    0]
 [   0    0    0    0   76    0    0    0    0    0 4924    0    0    0]
 [   0    0    0    0 4945    0    0    0    0    0   55    0    0    0]
 [   0    0    0   27 2742    0    0    0    0    0 2231    0    0    0]]
Figure(640x480)
[[   0    0 4999    0    0    0    0    1    0    0    0    0    0    0]
 [   0    0 4998    0    0    0    0    2    0    0    0    0    0    0]
 [   0    0 4758    0    0    0    0  242    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 4999    0    0    0    0    1    0    0    0    0    0    0]
 [   0    0 4875    0    0    0    0  125    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [1723    0 3277    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 4908    0    0    0    0   92    0    0    0    0    0    0]
 [   1    0 4999    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 5000    0    0    0    0    0    0    0    0    0    0    0]
 [   0    0 4862    0    0    0    0  138    0    0    0    0    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    6    0 4994    0    0    0    0    0]
 [   0    0    0    0    0    0    1    0 4999    0    0    0    0    0]
 [   0    0    0    0    0    0   81    0 4919    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0   22    0 4978    0    0    0    0    0]
 [   0    0    0    6    0    0    0    0 4994    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    0    0 5000    0    0    0    0    0]
 [   0    0    0    0    0    0    1    0 4999    0    0    0    0    0]
 [   0    0    0    0    0    0 3604    0 1396    0    0    0    0    0]
 [   0    0    0    0    0    0    3    0 4997    0    0    0    0    0]
 [   0    0    0    0    0    0   44    0 4956    0    0    0    0    0]]
Figure(640x480)
[[   0    0    0    0    6    0 1571    0    7    1    0    0 3415    0]
 [   0    0    0    0    0    0   44    0    2    0    0    0 4954    0]
 [   0    0    0    0    2    0 1629    1   22  748    0    0 2598    0]
 [   0    0    0   33    0    0   69    2 4650    1    0    0  245    0]
 [   0    0    0    0   12    0 1484    0    6    4    0    0 3494    0]
 [   0    0    0    0    2    0  118    0  586    0    0    0 4294    0]
 [   0    0    0    0    0    0  340    0    1   11    0    0 4648    0]
 [   0    0    0    0    0    0  281   44   40    0    0    0 4635    0]
 [   0    0    0    0    0    0 4982    0    1    0    0    0   17    0]
 [   0    0    0    0    0    0 1439    0    1    0    0    0 3560    0]
 [   0    0    0    0    0    0 4988    0    0    0    0    0   12    0]
 [   0    0    0    0    0    0 2715    0    2    0    0    0 2283    0]
 [   0    0    0    0    0    0  475    0 1581    0    0    0 2944    0]
 [   0    0    0    0    0    0  130    0    1    1    0    0 4868    0]]
Figure(640x480)
