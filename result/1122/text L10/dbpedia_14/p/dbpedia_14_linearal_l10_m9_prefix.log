total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask8//dbpedia_14/dbpedia_14_linearal_l10_m8_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.08887142857142857 (49768/560000), AUC 0.5060470700263977
Test Epoch0 layer0 Acc 0.9733714285714286, AUC 0.998323380947113
Save ckpt to ./ckpt/mask9//dbpedia_14/dbpedia_14_linearal_l10_m9_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9769571428571429, AUC 0.9984015822410583
Save ckpt to ./ckpt/mask9//dbpedia_14/dbpedia_14_linearal_l10_m9_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9770714285714286, AUC 0.9982503056526184
Test Epoch0 layer3 Acc 0.9768, AUC 0.9980498552322388
Test Epoch0 layer4 Acc 0.9768428571428571, AUC 0.9979614019393921
Test Epoch0 layer5 Acc 0.9769142857142857, AUC 0.9979912638664246
Test Epoch0 layer6 Acc 0.9768714285714286, AUC 0.9980385899543762
Test Epoch0 layer7 Acc 0.9767285714285714, AUC 0.998114287853241
Test Epoch0 layer8 Acc 0.9768, AUC 0.9980767369270325
Test Epoch0 layer9 Acc 0.07037142857142857, AUC 0.48960158228874207
gc 0
Train Epoch1 Acc 0.06973571428571429 (39052/560000), AUC 0.48041799664497375
Test Epoch1 layer0 Acc 0.9737714285714286, AUC 0.9983340501785278
Test Epoch1 layer1 Acc 0.9766571428571429, AUC 0.9984136819839478
Save ckpt to ./ckpt/mask9//dbpedia_14/dbpedia_14_linearal_l10_m9_prefix.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9768571428571429, AUC 0.9982379078865051
Test Epoch1 layer3 Acc 0.9768, AUC 0.9981173872947693
Test Epoch1 layer4 Acc 0.9767571428571429, AUC 0.9980170130729675
Test Epoch1 layer5 Acc 0.9768571428571429, AUC 0.9980394244194031
Test Epoch1 layer6 Acc 0.9768714285714286, AUC 0.9980993270874023
Test Epoch1 layer7 Acc 0.9767428571428571, AUC 0.9980308413505554
Test Epoch1 layer8 Acc 0.9769714285714286, AUC 0.9980430006980896
Test Epoch1 layer9 Acc 0.06931428571428572, AUC 0.46662116050720215
gc 0
Train Epoch2 Acc 0.06967142857142856 (39016/560000), AUC 0.46178779006004333
Test Epoch2 layer0 Acc 0.9741428571428571, AUC 0.9983274340629578
Test Epoch2 layer1 Acc 0.9769571428571429, AUC 0.9984055757522583
Test Epoch2 layer2 Acc 0.9772571428571428, AUC 0.998217761516571
Test Epoch2 layer3 Acc 0.9770571428571428, AUC 0.9981346130371094
Test Epoch2 layer4 Acc 0.9772285714285714, AUC 0.9980697631835938
Test Epoch2 layer5 Acc 0.9772, AUC 0.9980371594429016
Test Epoch2 layer6 Acc 0.9770714285714286, AUC 0.9979889988899231
Test Epoch2 layer7 Acc 0.9770857142857143, AUC 0.9979809522628784
Test Epoch2 layer8 Acc 0.9771857142857143, AUC 0.9980953931808472
Test Epoch2 layer9 Acc 0.06942857142857142, AUC 0.45700693130493164
gc 0
Train Epoch3 Acc 0.0697125 (39039/560000), AUC 0.4627710282802582
Test Epoch3 layer0 Acc 0.9741142857142857, AUC 0.9983267784118652
Test Epoch3 layer1 Acc 0.9769142857142857, AUC 0.99836266040802
Test Epoch3 layer2 Acc 0.9769714285714286, AUC 0.9981503486633301
Test Epoch3 layer3 Acc 0.9768, AUC 0.9980788826942444
Test Epoch3 layer4 Acc 0.9768285714285714, AUC 0.9979771971702576
Test Epoch3 layer5 Acc 0.9766857142857143, AUC 0.9981101155281067
Test Epoch3 layer6 Acc 0.9769571428571429, AUC 0.9979937672615051
Test Epoch3 layer7 Acc 0.9768571428571429, AUC 0.9979141354560852
Test Epoch3 layer8 Acc 0.9769, AUC 0.9980022311210632
Test Epoch3 layer9 Acc 0.0693, AUC 0.46261146664619446
gc 0
Train Epoch4 Acc 0.069875 (39130/560000), AUC 0.4547880291938782
Test Epoch4 layer0 Acc 0.9738571428571429, AUC 0.9983035326004028
Test Epoch4 layer1 Acc 0.9769857142857142, AUC 0.9983641505241394
Test Epoch4 layer2 Acc 0.9771142857142857, AUC 0.9982132315635681
Test Epoch4 layer3 Acc 0.9769142857142857, AUC 0.9981070756912231
Test Epoch4 layer4 Acc 0.9769285714285715, AUC 0.9979981184005737
Test Epoch4 layer5 Acc 0.9769714285714286, AUC 0.9979363679885864
Test Epoch4 layer6 Acc 0.977, AUC 0.9979013800621033
Test Epoch4 layer7 Acc 0.9769142857142857, AUC 0.9980289340019226
Test Epoch4 layer8 Acc 0.9770571428571428, AUC 0.9979609251022339
Test Epoch4 layer9 Acc 0.06977142857142857, AUC 0.4499635398387909
gc 0
Train Epoch5 Acc 0.07003571428571428 (39220/560000), AUC 0.4465426802635193
Test Epoch5 layer0 Acc 0.9739, AUC 0.9983075261116028
Test Epoch5 layer1 Acc 0.9770857142857143, AUC 0.9983709454536438
Test Epoch5 layer2 Acc 0.9772428571428572, AUC 0.9982043504714966
Test Epoch5 layer3 Acc 0.9770857142857143, AUC 0.9979871511459351
Test Epoch5 layer4 Acc 0.9772285714285714, AUC 0.9978533387184143
Test Epoch5 layer5 Acc 0.9771428571428571, AUC 0.9978933334350586
Test Epoch5 layer6 Acc 0.9772285714285714, AUC 0.9978682398796082
Test Epoch5 layer7 Acc 0.9771428571428571, AUC 0.9978467226028442
Test Epoch5 layer8 Acc 0.9772142857142857, AUC 0.9978442788124084
Test Epoch5 layer9 Acc 0.06972857142857143, AUC 0.4414498805999756
gc 0
Train Epoch6 Acc 0.070025 (39214/560000), AUC 0.43699997663497925
Test Epoch6 layer0 Acc 0.9738285714285714, AUC 0.9983319044113159
Test Epoch6 layer1 Acc 0.9769428571428571, AUC 0.9984042048454285
Test Epoch6 layer2 Acc 0.9771428571428571, AUC 0.9982601404190063
Test Epoch6 layer3 Acc 0.9771142857142857, AUC 0.9981700778007507
Test Epoch6 layer4 Acc 0.9770857142857143, AUC 0.9980170130729675
Test Epoch6 layer5 Acc 0.9770857142857143, AUC 0.9979425072669983
Test Epoch6 layer6 Acc 0.9771428571428571, AUC 0.9980136156082153
Test Epoch6 layer7 Acc 0.9769714285714286, AUC 0.9979720711708069
Test Epoch6 layer8 Acc 0.9770714285714286, AUC 0.9979343414306641
Test Epoch6 layer9 Acc 0.06965714285714286, AUC 0.4304084777832031
gc 0
Train Epoch7 Acc 0.07006071428571428 (39234/560000), AUC 0.4277455508708954
Test Epoch7 layer0 Acc 0.9739571428571429, AUC 0.998330295085907
Test Epoch7 layer1 Acc 0.9770142857142857, AUC 0.9984048008918762
Test Epoch7 layer2 Acc 0.9769428571428571, AUC 0.998252272605896
Test Epoch7 layer3 Acc 0.9770285714285715, AUC 0.9981180429458618
Test Epoch7 layer4 Acc 0.9772, AUC 0.9979606866836548
Test Epoch7 layer5 Acc 0.9771142857142857, AUC 0.9979113936424255
Test Epoch7 layer6 Acc 0.9770714285714286, AUC 0.9979004263877869
Test Epoch7 layer7 Acc 0.9770142857142857, AUC 0.9978852868080139
Test Epoch7 layer8 Acc 0.9771285714285715, AUC 0.9979060292243958
Test Epoch7 layer9 Acc 0.0701, AUC 0.4274093210697174
gc 0
Train Epoch8 Acc 0.07010535714285714 (39259/560000), AUC 0.4293213486671448
Test Epoch8 layer0 Acc 0.9737285714285714, AUC 0.9983482956886292
Test Epoch8 layer1 Acc 0.9769285714285715, AUC 0.9983959794044495
Test Epoch8 layer2 Acc 0.9771285714285715, AUC 0.9982383847236633
Test Epoch8 layer3 Acc 0.9771142857142857, AUC 0.9981167912483215
Test Epoch8 layer4 Acc 0.9770714285714286, AUC 0.9979953169822693
Test Epoch8 layer5 Acc 0.9771571428571428, AUC 0.9979410171508789
Test Epoch8 layer6 Acc 0.9770571428571428, AUC 0.9979893565177917
Test Epoch8 layer7 Acc 0.9770714285714286, AUC 0.997985303401947
Test Epoch8 layer8 Acc 0.9771571428571428, AUC 0.9979828000068665
Test Epoch8 layer9 Acc 0.06987142857142857, AUC 0.4259168207645416
gc 0
Train Epoch9 Acc 0.07007321428571428 (39241/560000), AUC 0.42701295018196106
Test Epoch9 layer0 Acc 0.9739714285714286, AUC 0.9983229041099548
Test Epoch9 layer1 Acc 0.977, AUC 0.998350203037262
Test Epoch9 layer2 Acc 0.9771428571428571, AUC 0.9981675744056702
Test Epoch9 layer3 Acc 0.9770571428571428, AUC 0.9980297684669495
Test Epoch9 layer4 Acc 0.977, AUC 0.9978792071342468
Test Epoch9 layer5 Acc 0.9770571428571428, AUC 0.9978950619697571
Test Epoch9 layer6 Acc 0.9770857142857143, AUC 0.9978426098823547
Test Epoch9 layer7 Acc 0.9771285714285715, AUC 0.9979124069213867
Test Epoch9 layer8 Acc 0.9771285714285715, AUC 0.9978733658790588
Test Epoch9 layer9 Acc 0.06982857142857143, AUC 0.42797985672950745
Best AUC 0.9984136819839478
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask9//dbpedia_14/dbpedia_14_linearal_l10_m9_prefix.pt
[[4696   40   24   15   11   71   41    8    3    6    5   20   18   42]
 [  39 4881    3    3    8    0   37    8    5    2    1    0    5    8]
 [  37   13 4643   19   54    2   10    4    4    0    1   64   20  129]
 [   3    1   30 4950   11    1    1    0    0    0    0    0    0    3]
 [  10   13   76   13 4856    8    6    1    2    0    0    0    3   12]
 [  36    2    3    3    1 4943    5    2    1    1    0    0    1    2]
 [  63   40    5    3   10   17 4801   39    9    5    1    1    5    1]
 [   0    0    0    0    2    0   13 4964   16    3    1    0    0    1]
 [   2    2    2    0    3    0   12   13 4966    0    0    0    0    0]
 [   1    0    1    3    1    0    0    7    0 4955   31    0    0    1]
 [  12    1    0    0    0    0    2    4    0   33 4947    1    0    0]
 [   8    0   48    3    0    1    1    0    0    1    0 4911   15   12]
 [  10    2   25    8    2    4    1    3    1    2    0   21 4877   44]
 [  34    3   84   10   12    3    4   10    1    7    4    7   47 4774]]
Figure(640x480)
[[4727   43   23    9   13   53   42    5    2    6    3   18   15   41]
 [  34 4906    5    1    7    0   32    1    1    2    0    0    3    8]
 [  33   13 4678   14   59    1   11    2    1    0    2   60   24  102]
 [   2    2   24 4956   12    0    1    1    0    0    0    0    0    2]
 [   5   10   61   12 4884    7    8    0    2    2    0    0    2    7]
 [  41    1    3    2    1 4941    5    2    1    0    0    0    1    2]
 [  58   45    6    1    8   15 4817   31    6    3    0    1    6    3]
 [   0    1    0    0    2    0   16 4961   11    3    3    0    2    1]
 [   2    2    2    0    5    0   13   18 4958    0    0    0    0    0]
 [   1    0    1    2    0    0    0    6    0 4959   29    0    0    2]
 [  12    1    0    0    0    0    1    4    0   35 4947    0    0    0]
 [   7    0   37    2    0    0    1    0    0    0    2 4922   16   13]
 [  11    2   19    3    0    2    1    1    1    0    0   20 4897   43]
 [  27    2   81    4    7    3    4    4    0    1    2    7   45 4813]]
Figure(640x480)
[[4736   41   23    9   11   51   43    5    1    6    3   17   12   42]
 [  39 4899    4    1    7    0   35    1    2    2    0    0    2    8]
 [  33   12 4687   15   61    1    9    1    1    3    2   58   21   96]
 [   2    2   24 4955   12    1    1    0    0    2    0    0    0    1]
 [   6    9   58   13 4887    7    7    0    1    3    0    0    2    7]
 [  43    2    3    2    1 4938    5    2    1    0    0    0    1    2]
 [  60   41    3    1    8   16 4831   26    4    3    0    1    4    2]
 [   3    2    1    0    2    0   18 4955   12    3    1    0    2    1]
 [   3    2    2    0    6    0   13   16 4956    1    0    0    0    1]
 [   1    0    1    2    0    0    0    5    0 4961   27    0    0    3]
 [  12    1    0    0    0    0    1    3    0   37 4946    0    0    0]
 [   9    0   39    2    0    0    0    0    0    0    0 4921   16   13]
 [  13    2   19    4    0    2    1    1    0    1    0   21 4893   43]
 [  28    3   82    1    6    3    5    4    0    1    1    6   45 4815]]
Figure(640x480)
[[4738   40   23    8   11   50   43    5    2    6    3   17   12   42]
 [  41 4897    5    1    6    0   35    1    2    1    0    0    3    8]
 [  32   11 4692   15   62    1   11    1    1    0    2   55   21   96]
 [   3    2   24 4954   11    1    1    0    0    1    0    0    1    2]
 [   6   10   61   12 4886    7    7    0    1    2    0    0    2    6]
 [  43    2    3    2    1 4938    5    2    1    0    0    0    1    2]
 [  64   40    5    1    8   15 4825   26    6    3    0    1    4    2]
 [   4    2    2    0    2    0   19 4952   13    3    0    0    2    1]
 [   3    2    2    0    6    0   13   13 4959    0    0    0    0    2]
 [   1    0    1    2    1    0    0    6    0 4957   29    0    0    3]
 [  12    1    1    0    0    0    1    3    0   37 4945    0    0    0]
 [  10    0   40    2    0    0    0    0    0    0    0 4921   15   12]
 [  14    2   22    2    0    3    1    1    0    1    0   21 4890   43]
 [  28    3   81    1    7    3    4    1    0    1    1    7   41 4822]]
Figure(640x480)
[[4733   40   26    8   12   50   44    6    2    6    3   18   11   41]
 [  41 4897    5    1    7    0   35    0    2    1    0    0    3    8]
 [  32   10 4695   16   62    1    9    1    0    1    2   55   21   95]
 [   4    2   23 4953   12    1    1    0    0    1    0    0    1    2]
 [   6    8   62   13 4886    7    7    0    2    1    0    0    2    6]
 [  42    2    3    1    1 4940    5    2    1    0    0    0    1    2]
 [  64   41    5    1    9   15 4824   25    6    3    0    1    3    3]
 [   3    1    1    0    2    0   21 4951   14    4    0    0    2    1]
 [   3    2    2    0    6    0   13   12 4961    0    0    0    0    1]
 [   1    0    1    2    1    0    0    6    0 4956   30    0    0    3]
 [  12    1    1    0    0    0    1    3    0   37 4945    0    0    0]
 [  10    0   40    2    0    0    0    0    0    0    0 4920   15   13]
 [  13    2   22    2    0    2    1    1    0    1    0   22 4890   44]
 [  32    3   80    1    6    2    4    1    0    1    1    8   39 4822]]
Figure(640x480)
[[4736   39   26    7   12   50   44    6    2    6    3   19    9   41]
 [  42 4895    4    1    8    0   37    0    2    1    0    0    2    8]
 [  33   11 4697   16   62    1   10    1    0    0    2   53   21   93]
 [   3    2   24 4955   11    1    1    0    0    1    0    0    0    2]
 [   6    8   61   13 4887    7    7    0    1    2    0    0    2    6]
 [  43    2    2    1    1 4940    5    1    1    1    0    0    1    2]
 [  61   42    5    1    9   15 4827   24    6    3    0    1    3    3]
 [   5    1    2    0    2    0   20 4949   14    4    0    0    2    1]
 [   3    2    2    0    6    0   14   13 4958    0    0    0    0    2]
 [   1    0    1    2    1    0    0    6    0 4958   28    0    0    3]
 [  12    1    1    0    0    0    2    3    0   38 4943    0    0    0]
 [   9    0   41    2    0    0    0    0    0    0    0 4921   14   13]
 [  14    2   24    4    0    2    1    1    0    1    0   22 4885   44]
 [  29    3   76    1    7    2    4    2    0    1    0    7   39 4829]]
Figure(640x480)
[[4734   39   27    7   12   50   45    6    2    6    3   19    9   41]
 [  40 4896    4    1    8    0   36    1    2    2    0    0    2    8]
 [  33   10 4699   15   64    1    9    0    0    1    2   53   20   93]
 [   4    2   23 4952   14    1    1    0    0    1    0    0    1    1]
 [   6    8   60   13 4888    7    7    0    1    2    0    0    2    6]
 [  43    2    3    1    1 4939    5    1    1    1    0    0    1    2]
 [  61   40    5    1    9   15 4829   24    6    3    0    1    3    3]
 [   4    1    1    0    2    0   21 4952   12    4    0    0    2    1]
 [   4    2    2    0    6    0   13   12 4959    0    0    0    0    2]
 [   1    0    1    2    1    0    0    6    0 4959   27    0    0    3]
 [  12    1    1    0    0    0    1    3    0   39 4943    0    0    0]
 [  10    0   40    2    0    0    0    0    0    0    0 4921   14   13]
 [  15    2   24    3    0    2    1    2    0    1    0   22 4885   43]
 [  29    3   79    1    7    2    4    2    0    1    0    7   40 4825]]
Figure(640x480)
[[4730   40   26    8   12   50   46    6    2    6    3   19   10   42]
 [  40 4896    4    1    8    0   36    1    2    2    0    0    2    8]
 [  33   10 4696   15   61    1    9    1    0    1    2   54   21   96]
 [   4    2   24 4953   12    1    1    0    0    1    0    0    0    2]
 [   5    8   60   13 4889    7    7    0    1    2    0    0    2    6]
 [  43    2    2    1    1 4940    5    1    1    1    0    0    1    2]
 [  61   39    4    0    9   15 4831   24    6    4    0    1    3    3]
 [   3    1    2    0    2    0   24 4947   14    4    0    0    2    1]
 [   4    2    2    0    6    0   14   11 4958    0    0    0    0    3]
 [   1    0    1    2    1    0    0    6    0 4958   28    0    0    3]
 [  12    1    1    0    0    0    2    3    0   39 4942    0    0    0]
 [  10    0   41    2    0    0    0    0    0    0    0 4920   14   13]
 [  15    2   23    2    0    2    1    2    0    1    0   22 4887   43]
 [  30    1   77    1    7    3    4    3    0    1    0    7   41 4825]]
Figure(640x480)
[[4731   38   25    8   12   50   47    6    2    6    3   20    9   43]
 [  40 4895    4    1    8    0   37    1    2    1    0    0    3    8]
 [  33   10 4694   16   63    1    9    1    0    1    2   54   21   95]
 [   4    2   24 4953   12    1    1    0    0    1    0    0    1    1]
 [   6    8   60   13 4888    7    7    0    1    2    0    0    2    6]
 [  42    2    1    0    2 4942    5    1    1    1    0    0    1    2]
 [  60   36    5    1    9   15 4835   24    5    3    0    1    3    3]
 [   2    1    1    0    2    0   24 4950   13    4    0    0    2    1]
 [   3    2    2    0    5    0   14   13 4959    0    0    0    0    2]
 [   1    0    1    2    0    0    0    6    0 4959   28    0    0    3]
 [  12    1    1    0    0    0    1    3    0   38 4944    0    0    0]
 [   8    0   41    2    0    0    0    0    0    0    0 4923   14   12]
 [  14    2   21    4    0    2    1    0    0    1    0   22 4889   44]
 [  28    2   80    1    7    2    4    2    0    1    0    7   40 4826]]
Figure(640x480)
[[4748    1   38    0    1    0    0   54    1    2    8   26  120    1]
 [  35    0    8    0    0    0    0    9    0    1    0   16 4931    0]
 [  81    0   31    0    0    0    1    1    0    0   13    2 4871    0]
 [   5    0   11    0    0    0    1    1    0    0    8    0 4973    1]
 [  10    0    4    0    0    0    0    1    0    0 4502   12  471    0]
 [1337    1  219    0    0    0    2    8    2    0    1    1 3429    0]
 [  47   13   18    0    0    0    3  105   45    0    6 4680   83    0]
 [ 258    1    9    0    1    0 3109    2 1571    0    4   40    5    0]
 [   1    0 4925    0    2    0   22   12    7    0    3   25    3    0]
 [4908   47    7    0    0    0    1    0    0    0    0    0   37    0]
 [  29 4859  100    0    1    0    0    1    0    0    1    0    9    0]
 [4616    0  113    0    0    0    0    4    0    0    0    0  267    0]
 [  14    0 4922    0    0    0    0    3    0    0    0    1   60    0]
 [  27    0   61    0    4    0    0    9    1    1    0   27 4870    0]]
Figure(640x480)
