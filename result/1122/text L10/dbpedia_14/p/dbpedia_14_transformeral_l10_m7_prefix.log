total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask6//dbpedia_14/dbpedia_14_transformeral_l10_m6_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.06956607142857144 (38957/560000), AUC 0.5034033060073853
Test Epoch0 layer0 Acc 0.9737428571428571, AUC 0.9982941746711731
Save ckpt to ./ckpt/mask7//dbpedia_14/dbpedia_14_transformeral_l10_m7_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9796857142857143, AUC 0.997653603553772
Test Epoch0 layer2 Acc 0.9799714285714286, AUC 0.9969567060470581
Test Epoch0 layer3 Acc 0.9799571428571429, AUC 0.9964207410812378
Test Epoch0 layer4 Acc 0.9799142857142857, AUC 0.9959120154380798
Test Epoch0 layer5 Acc 0.98, AUC 0.9956842660903931
Test Epoch0 layer6 Acc 0.9801, AUC 0.9949591755867004
Test Epoch0 layer7 Acc 0.0013142857142857142, AUC 0.5023473501205444
Test Epoch0 layer8 Acc 0.071, AUC 0.5454217791557312
Test Epoch0 layer9 Acc 0.0021, AUC 0.45548030734062195
gc 0
Train Epoch1 Acc 0.028716071428571428 (16081/560000), AUC 0.4394562840461731
Test Epoch1 layer0 Acc 0.9736571428571429, AUC 0.998280942440033
Test Epoch1 layer1 Acc 0.9796428571428571, AUC 0.9975019097328186
Test Epoch1 layer2 Acc 0.9794571428571428, AUC 0.9966802000999451
Test Epoch1 layer3 Acc 0.9795285714285714, AUC 0.9959763288497925
Test Epoch1 layer4 Acc 0.9795142857142857, AUC 0.9953089356422424
Test Epoch1 layer5 Acc 0.9793142857142857, AUC 0.9951919317245483
Test Epoch1 layer6 Acc 0.9793714285714286, AUC 0.9944048523902893
Test Epoch1 layer7 Acc 0.0019, AUC 0.4736453592777252
Test Epoch1 layer8 Acc 0.07117142857142857, AUC 0.5360859632492065
Test Epoch1 layer9 Acc 0.0033714285714285712, AUC 0.4074396789073944
gc 0
Train Epoch2 Acc 0.010351785714285714 (5797/560000), AUC 0.4235200583934784
Test Epoch2 layer0 Acc 0.9733571428571428, AUC 0.9982804656028748
Test Epoch2 layer1 Acc 0.9795142857142857, AUC 0.997557520866394
Test Epoch2 layer2 Acc 0.9792571428571428, AUC 0.9966362714767456
Test Epoch2 layer3 Acc 0.9792571428571428, AUC 0.9961118102073669
Test Epoch2 layer4 Acc 0.9792142857142857, AUC 0.9952660202980042
Test Epoch2 layer5 Acc 0.9791857142857143, AUC 0.9946614503860474
Test Epoch2 layer6 Acc 0.9791142857142857, AUC 0.9942783117294312
Test Epoch2 layer7 Acc 0.0016285714285714287, AUC 0.4713536202907562
Test Epoch2 layer8 Acc 0.0712, AUC 0.5253759622573853
Test Epoch2 layer9 Acc 0.002842857142857143, AUC 0.41026633977890015
gc 0
Train Epoch3 Acc 0.006401785714285714 (3585/560000), AUC 0.4334592819213867
Test Epoch3 layer0 Acc 0.9736571428571429, AUC 0.9982684850692749
Test Epoch3 layer1 Acc 0.9792, AUC 0.9974784851074219
Test Epoch3 layer2 Acc 0.9792571428571428, AUC 0.9963473677635193
Test Epoch3 layer3 Acc 0.9792, AUC 0.9956992864608765
Test Epoch3 layer4 Acc 0.9790857142857143, AUC 0.9950484037399292
Test Epoch3 layer5 Acc 0.9791, AUC 0.9945669770240784
Test Epoch3 layer6 Acc 0.9791857142857143, AUC 0.9942969679832458
Test Epoch3 layer7 Acc 0.0023857142857142857, AUC 0.4584808349609375
Test Epoch3 layer8 Acc 0.07142857142857142, AUC 0.5360433459281921
Test Epoch3 layer9 Acc 0.0017857142857142857, AUC 0.42765283584594727
gc 0
Train Epoch4 Acc 0.003007142857142857 (1684/560000), AUC 0.43840622901916504
Test Epoch4 layer0 Acc 0.9739285714285715, AUC 0.9982923269271851
Test Epoch4 layer1 Acc 0.9796142857142857, AUC 0.9974218010902405
Test Epoch4 layer2 Acc 0.9793428571428572, AUC 0.9961289167404175
Test Epoch4 layer3 Acc 0.9792714285714286, AUC 0.9953092336654663
Test Epoch4 layer4 Acc 0.9792857142857143, AUC 0.9947004318237305
Test Epoch4 layer5 Acc 0.9792285714285714, AUC 0.9939332008361816
Test Epoch4 layer6 Acc 0.9792714285714286, AUC 0.9938154816627502
Test Epoch4 layer7 Acc 0.07267142857142857, AUC 0.4606943130493164
Test Epoch4 layer8 Acc 0.07142857142857142, AUC 0.5534066557884216
Test Epoch4 layer9 Acc 0.0013857142857142857, AUC 0.4319703280925751
gc 0
Train Epoch5 Acc 0.0027625 (1547/560000), AUC 0.4425167739391327
Test Epoch5 layer0 Acc 0.9736857142857143, AUC 0.9982777237892151
Test Epoch5 layer1 Acc 0.9790285714285715, AUC 0.9973427653312683
Test Epoch5 layer2 Acc 0.9788714285714286, AUC 0.996260941028595
Test Epoch5 layer3 Acc 0.9788, AUC 0.9954846501350403
Test Epoch5 layer4 Acc 0.9787571428571429, AUC 0.994869589805603
Test Epoch5 layer5 Acc 0.9787714285714286, AUC 0.9943271279335022
Test Epoch5 layer6 Acc 0.9787714285714286, AUC 0.9941343665122986
Test Epoch5 layer7 Acc 0.07271428571428572, AUC 0.4579557776451111
Test Epoch5 layer8 Acc 0.07142857142857142, AUC 0.553948700428009
Test Epoch5 layer9 Acc 0.0014714285714285714, AUC 0.4424571990966797
gc 0
Train Epoch6 Acc 0.0030875 (1729/560000), AUC 0.44534561038017273
Test Epoch6 layer0 Acc 0.9736285714285714, AUC 0.9982839822769165
Test Epoch6 layer1 Acc 0.9790428571428571, AUC 0.9972199201583862
Test Epoch6 layer2 Acc 0.9788142857142857, AUC 0.9958545565605164
Test Epoch6 layer3 Acc 0.9787285714285714, AUC 0.9950067400932312
Test Epoch6 layer4 Acc 0.9787857142857143, AUC 0.9944049119949341
Test Epoch6 layer5 Acc 0.9788571428571429, AUC 0.9938626289367676
Test Epoch6 layer6 Acc 0.9788428571428571, AUC 0.9934864044189453
Test Epoch6 layer7 Acc 0.07284285714285714, AUC 0.4712083637714386
Test Epoch6 layer8 Acc 0.07142857142857142, AUC 0.5470385551452637
Test Epoch6 layer9 Acc 0.0013714285714285714, AUC 0.43689030408859253
gc 0
Train Epoch7 Acc 0.0036785714285714286 (2060/560000), AUC 0.4473872184753418
Test Epoch7 layer0 Acc 0.9738, AUC 0.9982908964157104
Test Epoch7 layer1 Acc 0.9790142857142857, AUC 0.9972200393676758
Test Epoch7 layer2 Acc 0.9785857142857143, AUC 0.9957684278488159
Test Epoch7 layer3 Acc 0.9785428571428572, AUC 0.9949285387992859
Test Epoch7 layer4 Acc 0.9785571428571429, AUC 0.9943658113479614
Test Epoch7 layer5 Acc 0.9784428571428572, AUC 0.993737518787384
Test Epoch7 layer6 Acc 0.9784142857142857, AUC 0.9930872321128845
Test Epoch7 layer7 Acc 0.0728, AUC 0.47166213393211365
Test Epoch7 layer8 Acc 0.07142857142857142, AUC 0.5459674596786499
Test Epoch7 layer9 Acc 0.0013285714285714285, AUC 0.4455853998661041
gc 0
Train Epoch8 Acc 0.003948214285714286 (2211/560000), AUC 0.4513903260231018
Test Epoch8 layer0 Acc 0.9737, AUC 0.998292088508606
Test Epoch8 layer1 Acc 0.9791857142857143, AUC 0.9972516298294067
Test Epoch8 layer2 Acc 0.9787428571428571, AUC 0.9957697987556458
Test Epoch8 layer3 Acc 0.9785571428571429, AUC 0.9949369430541992
Test Epoch8 layer4 Acc 0.9784285714285714, AUC 0.9944596886634827
Test Epoch8 layer5 Acc 0.9783285714285714, AUC 0.9936924576759338
Test Epoch8 layer6 Acc 0.9782857142857143, AUC 0.9932998418807983
Test Epoch8 layer7 Acc 0.07265714285714285, AUC 0.4662753939628601
Test Epoch8 layer8 Acc 0.07142857142857142, AUC 0.5462419986724854
Test Epoch8 layer9 Acc 0.0015, AUC 0.4528319835662842
gc 0
Train Epoch9 Acc 0.004275 (2394/560000), AUC 0.4552024304866791
Test Epoch9 layer0 Acc 0.9735714285714285, AUC 0.9982858896255493
Test Epoch9 layer1 Acc 0.9789, AUC 0.9971817135810852
Test Epoch9 layer2 Acc 0.9784285714285714, AUC 0.9957365989685059
Test Epoch9 layer3 Acc 0.9783, AUC 0.9948068261146545
Test Epoch9 layer4 Acc 0.9783428571428572, AUC 0.9943676590919495
Test Epoch9 layer5 Acc 0.9782714285714286, AUC 0.9937765002250671
Test Epoch9 layer6 Acc 0.9782428571428572, AUC 0.9933818578720093
Test Epoch9 layer7 Acc 0.07282857142857142, AUC 0.46637871861457825
Test Epoch9 layer8 Acc 0.07142857142857142, AUC 0.541176438331604
Test Epoch9 layer9 Acc 0.0013285714285714285, AUC 0.4626564681529999
Best AUC 0.9982941746711731
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask7//dbpedia_14/dbpedia_14_transformeral_l10_m7_prefix.pt
[[4694   41   22   14   11   72   40    8    4    6    5   18   19   46]
 [  34 4901    5    1    7    0   26    8    4    2    1    0    4    7]
 [  39   13 4627   18   45    1   10    4    6    0    1   77   21  138]
 [   4    1   30 4950   11    0    1    1    0    0    0    0    0    2]
 [  13   17   85   12 4839    9    7    2    2    0    0    0    3   11]
 [  32    2    3    4    1 4945    5    2    1    2    0    0    1    2]
 [  63   54    6    3   11   16 4782   38   15    5    1    1    3    2]
 [   0    1    0    0    2    0   13 4962   17    3    1    0    0    1]
 [   1    4    2    0    3    0    9   13 4968    0    0    0    0    0]
 [   1    0    1    2    1    0    0    7    0 4956   31    0    0    1]
 [  12    1    0    0    0    0    2    5    1   30 4949    0    0    0]
 [   8    0   43    3    0    0    1    0    0    1    0 4919   17    8]
 [   9    2   22    5    1    2    1    3    1    2    0   21 4886   45]
 [  31    7   86    7   13    3    3    9    1    4    3    6   43 4784]]
Figure(640x480)
[[4736   40   20    4   12   55   46    4    0    1    1   17   14   50]
 [  41 4905    5    0    7    0   30    0    1    1    1    1    1    7]
 [  32    8 4723    7   62    1    8    0    1    0    2   52   19   85]
 [   5    1   20 4954   14    1    0    0    0    0    0    1    2    2]
 [  10    9   64    6 4890    6    4    1    2    1    0    0    2    5]
 [  31    1    1    0    0 4955    5    1    1    0    0    0    2    3]
 [  49   34    4    2    7    9 4852   25    7    5    0    1    2    3]
 [   2    1    0    0    0    0   19 4957   15    4    1    0    0    1]
 [   2    0    1    0    3    0    6   11 4977    0    0    0    0    0]
 [   1    0    1    1    1    0    0    4    0 4968   23    0    0    1]
 [  11    0    1    0    0    3    1    2    0   22 4959    0    1    0]
 [   6    0   29    2    0    0    0    0    0    0    0 4945   11    7]
 [   5    2    9    0    0    0    0    1    0    0    0   22 4917   44]
 [  25    2   61    3    4    3    4    1    0    1    1    8   47 4840]]
Figure(640x480)
[[4749   40   21    3   12   52   45    4    0    1    1   13   12   47]
 [  41 4902    5    0    7    1   31    0    2    1    1    1    1    7]
 [  30    6 4739    7   58    1    7    1    1    0    2   48   19   81]
 [   5    1   21 4953   14    1    0    0    0    0    0    1    2    2]
 [  10    9   65    6 4890    5    4    1    2    1    0    0    2    5]
 [  32    1    1    0    0 4954    5    1    1    0    0    0    2    3]
 [  50   35    3    2    5    9 4852   26    8    4    0    1    2    3]
 [   2    1    0    0    1    0   20 4953   17    5    0    0    0    1]
 [   2    0    1    0    3    0    6   11 4977    0    0    0    0    0]
 [   1    0    1    1    1    0    0    4    0 4968   23    0    0    1]
 [  11    1    0    0    0    2    1    2    0   21 4960    0    1    1]
 [   6    0   29    2    0    0    0    0    0    0    0 4942   14    7]
 [   4    2   11    0    0    0    0    1    0    0    0   21 4915   46]
 [  25    2   62    2    3    2    3    1    0    1    1    8   46 4844]]
Figure(640x480)
[[4749   40   21    3   12   52   45    4    0    1    1   14   12   46]
 [  41 4902    5    0    7    1   31    0    2    1    1    1    1    7]
 [  30    6 4742    6   60    1    7    1    1    0    2   46   16   82]
 [   5    1   21 4953   14    1    0    0    0    0    0    2    2    1]
 [  10    8   64    6 4891    5    5    1    2    1    0    0    2    5]
 [  34    1    1    0    0 4952    5    1    1    0    0    0    2    3]
 [  50   35    3    2    5    9 4854   25    7    4    0    1    2    3]
 [   2    1    0    0    1    0   21 4952   17    5    0    0    0    1]
 [   2    0    1    0    3    0    6   11 4977    0    0    0    0    0]
 [   1    0    1    1    1    0    0    4    0 4968   23    0    0    1]
 [  12    1    0    0    0    2    1    2    0   22 4958    0    1    1]
 [   5    0   31    2    0    0    0    0    0    0    0 4942   14    6]
 [   5    2   11    0    0    0    0    1    0    0    0   21 4915   45]
 [  26    1   62    2    4    2    4    1    0    1    1    8   46 4842]]
Figure(640x480)
[[4750   40   21    3   12   52   45    4    0    1    1   14   12   45]
 [  41 4902    5    0    7    1   31    0    2    1    1    1    1    7]
 [  30    6 4740    6   61    1    7    1    1    0    2   47   16   82]
 [   5    1   21 4953   14    1    0    0    0    0    0    2    2    1]
 [  10    8   64    6 4891    5    5    1    2    1    0    0    2    5]
 [  34    1    1    0    0 4952    5    1    1    0    0    0    2    3]
 [  50   35    3    2    5    9 4853   26    7    4    0    1    2    3]
 [   2    1    0    0    1    0   20 4953   17    5    0    0    0    1]
 [   3    0    1    0    3    0    6   11 4976    0    0    0    0    0]
 [   1    0    1    1    1    0    0    4    0 4968   23    0    0    1]
 [  12    1    0    0    0    2    1    2    0   24 4956    0    1    1]
 [   5    0   31    2    0    0    0    0    0    0    0 4943   13    6]
 [   5    2   11    0    0    0    0    1    0    0    0   21 4915   45]
 [  26    1   62    2    4    2    4    1    0    1    1    8   46 4842]]
Figure(640x480)
[[4751   40   20    3   12   51   45    4    0    1    1   13   12   47]
 [  41 4903    5    0    7    1   30    0    2    1    1    1    1    7]
 [  30    6 4739    6   62    1    7    1    1    0    2   47   16   82]
 [   5    1   21 4953   14    1    0    0    0    0    0    2    2    1]
 [  10    9   63    6 4892    5    4    1    2    1    0    0    2    5]
 [  34    1    1    0    0 4952    5    1    1    0    0    0    2    3]
 [  50   35    3    2    5    9 4853   26    7    4    0    1    2    3]
 [   2    1    0    0    1    0   20 4954   17    4    0    0    0    1]
 [   2    0    1    0    3    0    6   11 4977    0    0    0    0    0]
 [   1    0    1    1    1    0    0    4    0 4968   23    0    0    1]
 [  12    1    0    0    0    2    1    2    0   22 4958    0    1    1]
 [   5    0   31    2    0    0    0    0    0    0    0 4942   14    6]
 [   6    2   11    0    0    0    0    1    0    0    0   21 4914   45]
 [  25    1   62    2    3    2    4    1    0    1    1    8   46 4844]]
Figure(640x480)
[[4750   41   20    3   12   51   45    4    0    1    1   14   12   46]
 [  41 4907    5    0    6    1   27    0    2    1    1    1    1    7]
 [  29    6 4744    6   60    1    7    1    1    0    2   47   16   80]
 [   5    1   21 4953   14    1    0    0    0    0    0    2    2    1]
 [  10    9   65    6 4890    5    4    1    2    1    0    0    2    5]
 [  35    1    1    0    0 4951    5    1    1    0    0    0    2    3]
 [  51   35    3    2    5    9 4852   26    7    4    0    1    2    3]
 [   2    1    0    0    1    0   20 4954   17    4    0    0    0    1]
 [   2    0    1    0    3    0    6   11 4977    0    0    0    0    0]
 [   1    0    1    1    1    0    0    3    0 4969   23    0    0    1]
 [  12    1    0    0    0    2    1    2    0   21 4959    0    1    1]
 [   6    0   31    2    0    0    0    0    0    0    0 4943   12    6]
 [   5    2   11    0    0    0    0    1    0    0    0   21 4914   46]
 [  25    2   62    2    3    2    3    1    0    1    1    8   46 4844]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0 4817    0  183    0]
 [   0    0    0    0    0    0    0    0    0    0   48    0 4952    0]
 [   0    0    0    0    0    0    0    0    0    0  110    0 4890    0]
 [   0    0    0    0    0    0    0    0    0    0 4968    0   32    0]
 [   0    0    0    0    0    0    0    0    0    0   33    0 4967    0]
 [   0    0    0    0    0    0    0    0    0    0   44    0 4956    0]
 [   0    0    0    0    0    0    0    0    0    0 4761    0  239    0]
 [   0    0    0    0    0    0    0    0    0    0    5    0 4995    0]
 [   0    0    0    0    0    0    0    0    0    0   13    0 4987    0]
 [   0    0    0    0    0    0    0    0    0    0  771    0 4229    0]
 [   0    0    0    0    0    0    0    0    0    0   13    0 4987    0]
 [   0    0    0    0    0    0    0    0    0    0 4958    0   42    0]
 [   0    0    0    0    0    0    0    0    0    0 4921    0   79    0]
 [   0    0    0    0    0    0    0    0    0    0  103    0 4897    0]]
Figure(640x480)
[[   0 4713    4    0   63  220    0    0    0    0    0    0    0    0]
 [   0 4952    0    0    5   43    0    0    0    0    0    0    0    0]
 [   0   75    5    0   65 4855    0    0    0    0    0    0    0    0]
 [   0    6 4949    0    1   44    0    0    0    0    0    0    0    0]
 [   0   92    3    0    4 4901    0    0    0    0    0    0    0    0]
 [   0 4990    0    0    1    9    0    0    0    0    0    0    0    0]
 [   0   89    1    0    3 4907    0    0    0    0    0    0    0    0]
 [   0 4954    0    0    1   45    0    0    0    0    0    0    0    0]
 [   0   12    0    0    0 4988    0    0    0    0    0    0    0    0]
 [   0    4    0    0    1 4995    0    0    0    0    0    0    0    0]
 [   0   16    1    0    0 4983    0    0    0    0    0    0    0    0]
 [   0   12    1    0    8 4979    0    0    0    0    0    0    0    0]
 [   0 4924    0    0   37   39    0    0    0    0    0    0    0    0]
 [   0   86    1    0 4806  107    0    0    0    0    0    0    0    0]]
Figure(640x480)
[[   0    0    0    0    0 4880  108    0   12    0    0    0    0    0]
 [   0    0    0    0    0   61 4918    0   21    0    0    0    0    0]
 [   0    0    0    0    0 4874   77    0   49    0    0    0    0    0]
 [   0    0    0    0    0 4990    1    0    9    0    0    0    0    0]
 [   0    0    0    0    0  139   13    0 4848    0    0    0    0    0]
 [   0    0    0    0    0   89 4911    0    0    0    0    0    0    0]
 [   0    0    0    0    0 4938   55    0    7    0    0    0    0    0]
 [   0    0    0    0    0 4996    1    0    3    0    0    0    0    0]
 [   0    0    0    0    0 4997    0    0    3    0    0    0    0    0]
 [   0    0    0    0    0   10    1    0 4989    0    0    0    0    0]
 [   0    0    0    0    0   17    3    0 4980    0    0    0    0    0]
 [   0    0    0    0    0 4996    4    0    0    0    0    0    0    0]
 [   0    0    0    0    0 4964   36    0    0    0    0    0    0    0]
 [   0    0    0    0    0  179 4814    0    7    0    0    0    0    0]]
Figure(640x480)
