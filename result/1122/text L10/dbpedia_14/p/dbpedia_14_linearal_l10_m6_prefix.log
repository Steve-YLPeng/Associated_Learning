total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask5//dbpedia_14/dbpedia_14_linearal_l10_m5_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.06661964285714286 (37307/560000), AUC 0.4563435912132263
Test Epoch0 layer0 Acc 0.9738714285714286, AUC 0.9983614087104797
Save ckpt to ./ckpt/mask6//dbpedia_14/dbpedia_14_linearal_l10_m6_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9763857142857143, AUC 0.9984904527664185
Save ckpt to ./ckpt/mask6//dbpedia_14/dbpedia_14_linearal_l10_m6_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9764714285714285, AUC 0.9983195066452026
Test Epoch0 layer3 Acc 0.9765714285714285, AUC 0.9981816411018372
Test Epoch0 layer4 Acc 0.9765285714285714, AUC 0.9982520341873169
Test Epoch0 layer5 Acc 0.9764857142857143, AUC 0.9982315897941589
Test Epoch0 layer6 Acc 0.008514285714285714, AUC 0.46788260340690613
Test Epoch0 layer7 Acc 0.008928571428571428, AUC 0.5536457896232605
Test Epoch0 layer8 Acc 0.02602857142857143, AUC 0.5820899605751038
Test Epoch0 layer9 Acc 0.06717142857142858, AUC 0.4361799657344818
gc 0
Train Epoch1 Acc 0.06420714285714285 (35956/560000), AUC 0.42609792947769165
Test Epoch1 layer0 Acc 0.9738285714285714, AUC 0.9983223080635071
Test Epoch1 layer1 Acc 0.9765857142857143, AUC 0.9984037280082703
Test Epoch1 layer2 Acc 0.9768714285714286, AUC 0.9981975555419922
Test Epoch1 layer3 Acc 0.9767, AUC 0.9981423616409302
Test Epoch1 layer4 Acc 0.9767142857142858, AUC 0.9981060028076172
Test Epoch1 layer5 Acc 0.9767714285714286, AUC 0.9981833696365356
Test Epoch1 layer6 Acc 0.003857142857142857, AUC 0.45096153020858765
Test Epoch1 layer7 Acc 0.039971428571428574, AUC 0.5756562352180481
Test Epoch1 layer8 Acc 0.06371428571428571, AUC 0.5779198408126831
Test Epoch1 layer9 Acc 0.06604285714285714, AUC 0.4263911247253418
gc 0
Train Epoch2 Acc 0.06879107142857142 (38523/560000), AUC 0.43403559923171997
Test Epoch2 layer0 Acc 0.9738428571428571, AUC 0.9983206987380981
Test Epoch2 layer1 Acc 0.9765857142857143, AUC 0.9984489679336548
Test Epoch2 layer2 Acc 0.9765857142857143, AUC 0.9982527494430542
Test Epoch2 layer3 Acc 0.9764714285714285, AUC 0.998205840587616
Test Epoch2 layer4 Acc 0.9766285714285714, AUC 0.9981621503829956
Test Epoch2 layer5 Acc 0.9767, AUC 0.9981432557106018
Test Epoch2 layer6 Acc 0.001957142857142857, AUC 0.43874964118003845
Test Epoch2 layer7 Acc 0.07284285714285714, AUC 0.5739469528198242
Test Epoch2 layer8 Acc 0.0945, AUC 0.587493360042572
Test Epoch2 layer9 Acc 0.06947142857142857, AUC 0.43852299451828003
gc 0
Train Epoch3 Acc 0.06990714285714286 (39148/560000), AUC 0.44003885984420776
Test Epoch3 layer0 Acc 0.9740857142857143, AUC 0.9983309507369995
Test Epoch3 layer1 Acc 0.9768571428571429, AUC 0.9984396696090698
Test Epoch3 layer2 Acc 0.9768571428571429, AUC 0.9982508420944214
Test Epoch3 layer3 Acc 0.9766428571428571, AUC 0.9980813264846802
Test Epoch3 layer4 Acc 0.9765428571428572, AUC 0.9980081915855408
Test Epoch3 layer5 Acc 0.9766714285714285, AUC 0.9980602264404297
Test Epoch3 layer6 Acc 0.001257142857142857, AUC 0.4278501868247986
Test Epoch3 layer7 Acc 0.07812857142857142, AUC 0.5680476427078247
Test Epoch3 layer8 Acc 0.13258571428571428, AUC 0.5961390733718872
Test Epoch3 layer9 Acc 0.06975714285714285, AUC 0.4440591633319855
gc 0
Train Epoch4 Acc 0.070225 (39326/560000), AUC 0.4461438059806824
Test Epoch4 layer0 Acc 0.9737, AUC 0.9983245730400085
Test Epoch4 layer1 Acc 0.9769285714285715, AUC 0.9983962178230286
Test Epoch4 layer2 Acc 0.9768714285714286, AUC 0.9982014298439026
Test Epoch4 layer3 Acc 0.9767, AUC 0.9979950785636902
Test Epoch4 layer4 Acc 0.9766428571428571, AUC 0.9979353547096252
Test Epoch4 layer5 Acc 0.9766714285714285, AUC 0.9979287981987
Test Epoch4 layer6 Acc 0.0011285714285714287, AUC 0.4160389006137848
Test Epoch4 layer7 Acc 0.07264285714285715, AUC 0.5631495118141174
Test Epoch4 layer8 Acc 0.13592857142857143, AUC 0.6034857630729675
Test Epoch4 layer9 Acc 0.07005714285714286, AUC 0.4492547810077667
gc 0
Train Epoch5 Acc 0.07038392857142857 (39415/560000), AUC 0.4503193497657776
Test Epoch5 layer0 Acc 0.9737714285714286, AUC 0.9983543753623962
Test Epoch5 layer1 Acc 0.9767571428571429, AUC 0.9984418749809265
Test Epoch5 layer2 Acc 0.9767714285714286, AUC 0.9981722235679626
Test Epoch5 layer3 Acc 0.9766714285714285, AUC 0.9981513023376465
Test Epoch5 layer4 Acc 0.9767714285714286, AUC 0.9979974627494812
Test Epoch5 layer5 Acc 0.9767142857142858, AUC 0.9979325532913208
Test Epoch5 layer6 Acc 0.0012285714285714285, AUC 0.4187805950641632
Test Epoch5 layer7 Acc 0.0733, AUC 0.5639580488204956
Test Epoch5 layer8 Acc 0.1358, AUC 0.6043062806129456
Test Epoch5 layer9 Acc 0.0701, AUC 0.45272955298423767
gc 0
Train Epoch6 Acc 0.07067678571428572 (39579/560000), AUC 0.4529666304588318
Test Epoch6 layer0 Acc 0.9739571428571429, AUC 0.9983327984809875
Test Epoch6 layer1 Acc 0.9769142857142857, AUC 0.9984298944473267
Test Epoch6 layer2 Acc 0.9771857142857143, AUC 0.998184084892273
Test Epoch6 layer3 Acc 0.9769571428571429, AUC 0.9979835152626038
Test Epoch6 layer4 Acc 0.9768571428571429, AUC 0.9979671239852905
Test Epoch6 layer5 Acc 0.9768571428571429, AUC 0.9978285431861877
Test Epoch6 layer6 Acc 0.0010285714285714286, AUC 0.41945821046829224
Test Epoch6 layer7 Acc 0.0711, AUC 0.5612995028495789
Test Epoch6 layer8 Acc 0.1367142857142857, AUC 0.6044296026229858
Test Epoch6 layer9 Acc 0.07085714285714285, AUC 0.454220712184906
gc 0
Train Epoch7 Acc 0.07162678571428571 (40111/560000), AUC 0.4549308121204376
Test Epoch7 layer0 Acc 0.9740142857142857, AUC 0.9983207583427429
Test Epoch7 layer1 Acc 0.9768142857142857, AUC 0.9984220266342163
Test Epoch7 layer2 Acc 0.9769285714285715, AUC 0.9982267022132874
Test Epoch7 layer3 Acc 0.9768, AUC 0.9981390237808228
Test Epoch7 layer4 Acc 0.9767, AUC 0.9979092478752136
Test Epoch7 layer5 Acc 0.9766, AUC 0.9980202913284302
Test Epoch7 layer6 Acc 0.0011142857142857144, AUC 0.4173007607460022
Test Epoch7 layer7 Acc 0.07034285714285714, AUC 0.5642979741096497
Test Epoch7 layer8 Acc 0.13701428571428573, AUC 0.6077723503112793
Test Epoch7 layer9 Acc 0.07194285714285714, AUC 0.45541301369667053
gc 0
Train Epoch8 Acc 0.07235 (40516/560000), AUC 0.4581173360347748
Test Epoch8 layer0 Acc 0.9739857142857142, AUC 0.9983419179916382
Test Epoch8 layer1 Acc 0.9768, AUC 0.9984005689620972
Test Epoch8 layer2 Acc 0.9770142857142857, AUC 0.9982372522354126
Test Epoch8 layer3 Acc 0.9768714285714286, AUC 0.9980317950248718
Test Epoch8 layer4 Acc 0.9769428571428571, AUC 0.9979124069213867
Test Epoch8 layer5 Acc 0.9768428571428571, AUC 0.9979466795921326
Test Epoch8 layer6 Acc 0.0010285714285714286, AUC 0.41642484068870544
Test Epoch8 layer7 Acc 0.0711, AUC 0.5689013600349426
Test Epoch8 layer8 Acc 0.13714285714285715, AUC 0.6021233797073364
Test Epoch8 layer9 Acc 0.0741, AUC 0.46288105845451355
gc 0
Train Epoch9 Acc 0.07423035714285714 (41569/560000), AUC 0.4614812433719635
Test Epoch9 layer0 Acc 0.9738714285714286, AUC 0.99832683801651
Test Epoch9 layer1 Acc 0.9767428571428571, AUC 0.9983911514282227
Test Epoch9 layer2 Acc 0.9768571428571429, AUC 0.9981986880302429
Test Epoch9 layer3 Acc 0.9768285714285714, AUC 0.998071014881134
Test Epoch9 layer4 Acc 0.9769857142857142, AUC 0.9980039596557617
Test Epoch9 layer5 Acc 0.9770714285714286, AUC 0.9979453682899475
Test Epoch9 layer6 Acc 0.0010857142857142858, AUC 0.41886821389198303
Test Epoch9 layer7 Acc 0.07075714285714285, AUC 0.5666441321372986
Test Epoch9 layer8 Acc 0.13722857142857142, AUC 0.6040753722190857
Test Epoch9 layer9 Acc 0.07401428571428571, AUC 0.4614538848400116
Best AUC 0.9984904527664185
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask6//dbpedia_14/dbpedia_14_linearal_l10_m6_prefix.pt
[[4712   41   22   14   11   62   38    7    3    6    5   19   18   42]
 [  38 4900    1    1    7    0   28    5    4    2    1    0    4    9]
 [  39   13 4621   20   48    1    8    4    5    0    1   75   20  145]
 [   2    2   27 4953   11    1    0    0    0    0    0    0    0    4]
 [  12   17   82   13 4843    9    5    1    2    0    0    0    3   13]
 [  40    1    3    3    1 4940    5    2    1    1    0    0    1    2]
 [  64   49    6    3   11   17 4788   40   10    5    1    1    2    3]
 [   0    1    0    0    2    0   12 4962   18    3    0    0    1    1]
 [   2    4    2    0    3    0   10   13 4966    0    0    0    0    0]
 [   1    0    1    2    1    1    0    7    0 4950   36    0    0    1]
 [  12    1    0    0    0    0    2    3    0   33 4948    1    0    0]
 [   8    0   40    3    0    0    0    0    0    1    0 4920   15   13]
 [   9    2   24    7    1    2    1    3    0    2    0   22 4874   53]
 [  32    6   76    8   11    3    3   10    1    5    3    7   41 4794]]
Figure(640x480)
[[4731   43   20    9   12   47   40    5    2    5    3   22   16   45]
 [  34 4914    2    2    7    0   26    1    1    2    0    0    4    7]
 [  36   14 4660   18   57    2    7    1    1    0    1   68   26  109]
 [   3    2   24 4957   11    0    1    0    0    0    0    0    0    2]
 [  10   15   64   14 4870    7    6    1    1    1    0    0    2    9]
 [  46    1    2    2    1 4937    5    2    1    0    0    0    1    2]
 [  59   50    6    4   10   15 4808   32    4    4    0    1    4    3]
 [   2    1    0    0    2    0   14 4962   11    3    2    0    2    1]
 [   2    5    2    0    6    0   12   18 4955    0    0    0    0    0]
 [   1    0    1    2    1    0    0    6    0 4960   28    0    0    1]
 [  13    1    0    0    0    0    2    3    0   37 4944    0    0    0]
 [   8    0   31    2    0    0    0    0    0    0    1 4930   15   13]
 [  10    2   19    3    0    2    0    1    0    0    0   19 4903   41]
 [  27    5   68    5    8    3    2    4    0    1    2    8   51 4816]]
Figure(640x480)
[[4746   39   18    9   11   48   40    4    1    5    3   18   15   43]
 [  39 4911    1    2    7    0   28    0    1    2    0    0    3    6]
 [  38   14 4654   19   60    1    9    2    0    0    2   66   26  109]
 [   3    2   22 4957   13    0    1    0    0    1    0    0    1    0]
 [  10   12   60   15 4875    7    7    1    1    3    0    0    2    7]
 [  46    1    2    2    1 4937    5    2    1    0    0    0    1    2]
 [  64   49    4    3    8   17 4811   31    2    3    0    1    4    3]
 [   2    2    0    0    2    1   15 4960   11    3    1    0    2    1]
 [   3    5    2    0    7    0   14   18 4950    0    0    0    0    1]
 [   1    0    1    2    0    0    0    5    0 4962   27    0    0    2]
 [  13    1    0    0    0    0    1    3    0   35 4947    0    0    0]
 [  10    0   36    2    0    0    0    0    0    0    0 4923   16   13]
 [  14    2   17    4    0    2    1    1    0    0    0   19 4897   43]
 [  31    4   67    5    7    3    3    5    0    1    1    6   44 4823]]
Figure(640x480)
[[4757   37   18    7   11   48   37    5    1    4    3   16   14   42]
 [  39 4909    1    1    8    0   28    0    1    2    0    0    4    7]
 [  38   14 4655   19   64    1    9    1    0    0    2   68   25  104]
 [   2    2   21 4958   12    0    1    0    0    3    0    0    1    0]
 [   9   13   58   11 4881    7    7    1    1    3    0    0    2    7]
 [  44    2    1    2    1 4939    5    2    1    0    0    0    1    2]
 [  69   48    4    3    8   16 4807   30    4    3    0    1    4    3]
 [   2    2    0    0    2    0   15 4961   12    3    0    0    2    1]
 [   3    5    2    0    6    0   14   18 4950    0    0    0    0    2]
 [   1    0    1    2    0    0    0    6    0 4956   31    0    0    3]
 [  13    1    0    0    0    0    1    3    0   31 4951    0    0    0]
 [  10    0   35    2    0    0    0    0    0    0    0 4923   17   13]
 [  15    2   17    2    0    2    1    1    0    0    0   20 4897   43]
 [  33    5   71    5    8    3    2    4    0    1    2    6   44 4816]]
Figure(640x480)
[[4752   38   21    7   12   48   37    5    1    5    2   16   14   42]
 [  40 4912    1    1    7    0   26    0    1    2    0    0    3    7]
 [  37   14 4656   19   65    1   10    1    0    0    2   66   25  104]
 [   2    2   23 4955   12    1    1    0    0    3    0    0    1    0]
 [   9   13   58   11 4882    7    7    1    1    3    0    0    2    6]
 [  45    2    1    2    1 4938    5    2    1    0    0    0    1    2]
 [  71   49    4    4    9   15 4804   30    3    3    0    1    4    3]
 [   2    2    0    0    2    0   15 4961   12    3    0    0    2    1]
 [   3    3    2    0    7    0   14   19 4951    0    0    0    0    1]
 [   1    0    1    2    0    0    0    6    0 4955   32    0    0    3]
 [  13    1    0    0    0    0    1    3    0   33 4949    0    0    0]
 [  10    1   36    2    0    0    0    0    0    0    0 4921   17   13]
 [  14    2   18    1    0    2    1    1    0    0    0   20 4898   43]
 [  32    4   70    4    7    3    3    2    0    1    1    6   44 4823]]
Figure(640x480)
[[4753   38   21    7   12   48   37    5    1    4    2   16   13   43]
 [  39 4907    1    1    8    0   32    0    1    2    0    0    3    6]
 [  35   13 4660   18   67    1   10    1    1    0    2   63   24  105]
 [   2    2   23 4956   13    0    1    0    0    2    0    0    1    0]
 [   9   13   56   11 4884    7    7    1    1    3    0    0    2    6]
 [  45    2    1    2    1 4938    5    2    1    0    0    0    1    2]
 [  68   47    5    3    9   17 4805   33    3    3    0    1    3    3]
 [   4    2    0    0    2    0   14 4961   11    3    0    0    2    1]
 [   4    4    2    0    7    0   14   19 4949    0    0    0    0    1]
 [   1    0    1    2    0    0    0    6    0 4954   33    0    0    3]
 [  13    1    0    0    0    0    1    3    0   31 4951    0    0    0]
 [  11    1   37    2    0    0    0    0    0    0    0 4919   17   13]
 [  15    2   18    2    0    2    1    1    0    1    0   20 4895   43]
 [  30    4   70    4    8    3    3    3    0    1    1    6   45 4822]]
Figure(640x480)
[[  83    0    6   12    0    0  168 1218   68   49 3371    5   20    0]
 [  13    0    0 2823    0    0  422   37 1667    0   12    0   26    0]
 [2441    0    0   13    0    5   78  223    0    4   18    3 2215    0]
 [ 390    0    0    2    0 3717    2   29    0   10    0    0  850    0]
 [ 482    0    0 4235    0    2    4  252    0    5    5    3   12    0]
 [   3    0    0   11    0    0    2   26   22 4929    6    0    1    0]
 [   9    0    0  294    0    0   17  133    6   13 4523    0    5    0]
 [   1    0    0    4    0    0 4901   79    1    0    5    1    8    0]
 [   1    0    0    0    0    1    8 4979    0    0   10    0    1    0]
 [   2    0    0    0    3    1 4486    6    4  398    0    0  100    0]
 [ 400    0    0    1 1503    1  839    8 2215   23    7    0    1    2]
 [   3    0    0    0    0    1 4832   26    0    2    0    0  136    0]
 [   9    0    0    0    0    0   71 4832   14    0    1   63   10    0]
 [   7    0    0    2    0    1 4396  553    0    2    9    0   30    0]]
Figure(640x480)
[[ 514    0    6  112   61    0    0 4207    7    0    0   63   30    0]
 [  12    0    3   32   86    0    0   28  629    0    0 4210    0    0]
 [3187    0   13   22   33    0    0   21    1    0    0 1723    0    0]
 [   8    0   11    2   31    0    0    2   29    0    0 4917    0    0]
 [  87    0 4609    6   92    1    0  162    2    1    0   39    1    0]
 [ 681    0    0    6   19    0    0 4288    0    0    0    6    0    0]
 [  91    0   20 4790   20    0    0   42   28    0    0    9    0    0]
 [4982    0    2    9    0    0    0    1    1    0    0    5    0    0]
 [4961    0    1   29    3    0    0    0    0    0    0    6    0    0]
 [   8    0    0  681    6    0    0 4253    0    2    0   50    0    0]
 [   7    0    0  181    1    0    0    9    0    0    0 4802    0    0]
 [4955    0    0   34    4    0    0    6    0    0    0    1    0    0]
 [ 125    0    0 4857    4    0    0    2    5    0    0    7    0    0]
 [4896    0    1   41   32    0    0    7    1    0    0   22    0    0]]
Figure(640x480)
[[1666    1    0   80 3157    0    4   10    1    1   24   56    0    0]
 [  63    0    0 4731   27    0   91   66    2    0    2   17    1    0]
 [ 276    3    0   12  727    0    6 2128  109 1581  139    5    0   14]
 [  36 4577    0    2   21    0    1  325   37    0    0    1    0    0]
 [  53    6    0   92    7    0 2873  128 1810   15    0    8    1    7]
 [  71    0    0 3953   16    0    0  956    0    0    0    4    0    0]
 [  43    2    0   18   56    0   98   33    0    0    1 4745    4    0]
 [4205    1    0    1    0    0    1   25    0    0    1   19  747    0]
 [  20    0    0    0    3    0    1 4907    1    0    1   63    4    0]
 [4856    0    0    0  134    0    0   10    0    0    0    0    0    0]
 [ 180    0    0    0    8    0    0 4811    0    0    0    1    0    0]
 [4949    1    0    0    5    0    0   19    0    1    5   20    0    0]
 [4923    0    0    0    1    0    0   23    0    0   49    4    0    0]
 [ 343    2    0   17   10    0    2   26    0    2 4583   12    0    3]]
Figure(640x480)
[[4636    0    0  248    0    0    1   79    1    0    0    0   35    0]
 [ 116    0    0    0    0    0    0   15    0    0    0    0 4869    0]
 [ 100   27    0   79    0    0   92  192   17    0    0  187 4306    0]
 [ 153    0    0    0    0    0    1    3    0    0    0    0 4834    9]
 [1399    0    0   17    0    0   79  181    0    0    0    0 3324    0]
 [2211    0    0 2781    0    0    0    7    0    0    0    0    1    0]
 [ 765    0    0    7    0    0    0 4189    4    0    0    0   35    0]
 [1155    0    0   42    0    0    0   29 3757    0    0    0   17    0]
 [  24    0    0    7    0    0    0 4936   25    0    0    0    8    0]
 [4984    0    0    3    0    0    0    3    0    0    0    0    7    3]
 [ 166    0    0    2    0    0    0  877    0    0    0    0 3955    0]
 [4723    4    0    3    0    0    1   34   89    0    0    0  146    0]
 [3978    0    0  752    0    0    0  258    0    0    0    0   12    0]
 [  24    2    0   63    0    0    2 4868    1    2    0    0   38    0]]
Figure(640x480)
