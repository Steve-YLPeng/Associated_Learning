total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask7//dbpedia_14/dbpedia_14_linearal_l10_m7_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.14618392857142856 (81863/560000), AUC 0.5081669092178345
Test Epoch0 layer0 Acc 0.9736428571428571, AUC 0.9983392953872681
Save ckpt to ./ckpt/mask8//dbpedia_14/dbpedia_14_linearal_l10_m8_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9764428571428572, AUC 0.9984639286994934
Save ckpt to ./ckpt/mask8//dbpedia_14/dbpedia_14_linearal_l10_m8_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9763714285714286, AUC 0.998257040977478
Test Epoch0 layer3 Acc 0.9762142857142857, AUC 0.9982092976570129
Test Epoch0 layer4 Acc 0.9762857142857143, AUC 0.9981202483177185
Test Epoch0 layer5 Acc 0.9763, AUC 0.9981034994125366
Test Epoch0 layer6 Acc 0.9763857142857143, AUC 0.9981986284255981
Test Epoch0 layer7 Acc 0.9763571428571428, AUC 0.9982052445411682
Test Epoch0 layer8 Acc 0.07044285714285714, AUC 0.5101872682571411
Test Epoch0 layer9 Acc 0.1404857142857143, AUC 0.5110207200050354
gc 0
Train Epoch1 Acc 0.140875 (78890/560000), AUC 0.5159287452697754
Test Epoch1 layer0 Acc 0.9740571428571428, AUC 0.998302161693573
Test Epoch1 layer1 Acc 0.9766571428571429, AUC 0.9984192848205566
Test Epoch1 layer2 Acc 0.9769857142857142, AUC 0.9981698393821716
Test Epoch1 layer3 Acc 0.9767, AUC 0.998094916343689
Test Epoch1 layer4 Acc 0.9767285714285714, AUC 0.9980044960975647
Test Epoch1 layer5 Acc 0.9767142857142858, AUC 0.9980830550193787
Test Epoch1 layer6 Acc 0.9767, AUC 0.9980140328407288
Test Epoch1 layer7 Acc 0.9766428571428571, AUC 0.9980901479721069
Test Epoch1 layer8 Acc 0.07115714285714286, AUC 0.5101388692855835
Test Epoch1 layer9 Acc 0.14002857142857142, AUC 0.5148181319236755
gc 0
Train Epoch2 Acc 0.14062678571428572 (78751/560000), AUC 0.5134564638137817
Test Epoch2 layer0 Acc 0.9739285714285715, AUC 0.9983248710632324
Test Epoch2 layer1 Acc 0.9768428571428571, AUC 0.998397171497345
Test Epoch2 layer2 Acc 0.9770142857142857, AUC 0.9981922507286072
Test Epoch2 layer3 Acc 0.9768571428571429, AUC 0.9981659054756165
Test Epoch2 layer4 Acc 0.9769571428571429, AUC 0.9980992674827576
Test Epoch2 layer5 Acc 0.9769428571428571, AUC 0.9980864524841309
Test Epoch2 layer6 Acc 0.9768857142857142, AUC 0.9980220794677734
Test Epoch2 layer7 Acc 0.9768714285714286, AUC 0.9980207085609436
Test Epoch2 layer8 Acc 0.07122857142857143, AUC 0.5081497430801392
Test Epoch2 layer9 Acc 0.13981428571428572, AUC 0.5103989839553833
gc 0
Train Epoch3 Acc 0.14037857142857144 (78612/560000), AUC 0.5182756781578064
Test Epoch3 layer0 Acc 0.9737285714285714, AUC 0.9983323812484741
Test Epoch3 layer1 Acc 0.9769142857142857, AUC 0.9984446167945862
Test Epoch3 layer2 Acc 0.9771, AUC 0.9981439709663391
Test Epoch3 layer3 Acc 0.9768857142857142, AUC 0.9980179071426392
Test Epoch3 layer4 Acc 0.9771, AUC 0.9978551268577576
Test Epoch3 layer5 Acc 0.9770142857142857, AUC 0.9980122447013855
Test Epoch3 layer6 Acc 0.9771285714285715, AUC 0.9979329705238342
Test Epoch3 layer7 Acc 0.9771285714285715, AUC 0.9979122281074524
Test Epoch3 layer8 Acc 0.07127142857142857, AUC 0.5012428760528564
Test Epoch3 layer9 Acc 0.13934285714285713, AUC 0.5215520858764648
gc 0
Train Epoch4 Acc 0.1403625 (78603/560000), AUC 0.52629154920578
Test Epoch4 layer0 Acc 0.9735714285714285, AUC 0.9983071684837341
Test Epoch4 layer1 Acc 0.9770428571428571, AUC 0.9983636736869812
Test Epoch4 layer2 Acc 0.9771142857142857, AUC 0.9980950355529785
Test Epoch4 layer3 Acc 0.9769571428571429, AUC 0.9979885220527649
Test Epoch4 layer4 Acc 0.9771142857142857, AUC 0.9978752732276917
Test Epoch4 layer5 Acc 0.9770571428571428, AUC 0.9978493452072144
Test Epoch4 layer6 Acc 0.9769857142857142, AUC 0.9979352951049805
Test Epoch4 layer7 Acc 0.9769285714285715, AUC 0.9979861378669739
Test Epoch4 layer8 Acc 0.07172857142857143, AUC 0.510347843170166
Test Epoch4 layer9 Acc 0.13972857142857142, AUC 0.5294793844223022
gc 0
Train Epoch5 Acc 0.14040892857142856 (78629/560000), AUC 0.5292052030563354
Test Epoch5 layer0 Acc 0.9739428571428571, AUC 0.9983250498771667
Test Epoch5 layer1 Acc 0.9768428571428571, AUC 0.998397171497345
Test Epoch5 layer2 Acc 0.9770714285714286, AUC 0.9981570839881897
Test Epoch5 layer3 Acc 0.9770428571428571, AUC 0.9979836344718933
Test Epoch5 layer4 Acc 0.9770714285714286, AUC 0.9977919459342957
Test Epoch5 layer5 Acc 0.9770571428571428, AUC 0.9978066682815552
Test Epoch5 layer6 Acc 0.9771285714285715, AUC 0.9978503584861755
Test Epoch5 layer7 Acc 0.977, AUC 0.9977107644081116
Test Epoch5 layer8 Acc 0.07167142857142857, AUC 0.512334942817688
Test Epoch5 layer9 Acc 0.13988571428571428, AUC 0.5277462005615234
gc 0
Train Epoch6 Acc 0.14049642857142858 (78678/560000), AUC 0.5299657583236694
Test Epoch6 layer0 Acc 0.9741714285714286, AUC 0.9983044266700745
Test Epoch6 layer1 Acc 0.9770142857142857, AUC 0.9983641505241394
Test Epoch6 layer2 Acc 0.9773142857142857, AUC 0.9981673359870911
Test Epoch6 layer3 Acc 0.9769428571428571, AUC 0.9980660676956177
Test Epoch6 layer4 Acc 0.9771, AUC 0.997970461845398
Test Epoch6 layer5 Acc 0.9771, AUC 0.9979109168052673
Test Epoch6 layer6 Acc 0.9771428571428571, AUC 0.9979109168052673
Test Epoch6 layer7 Acc 0.9769571428571429, AUC 0.9978164434432983
Test Epoch6 layer8 Acc 0.07197142857142858, AUC 0.5163552165031433
Test Epoch6 layer9 Acc 0.13995714285714286, AUC 0.5291914343833923
gc 0
Train Epoch7 Acc 0.14047857142857142 (78668/560000), AUC 0.5296996235847473
Test Epoch7 layer0 Acc 0.9735571428571429, AUC 0.9983133673667908
Test Epoch7 layer1 Acc 0.9768714285714286, AUC 0.998411238193512
Test Epoch7 layer2 Acc 0.9771285714285715, AUC 0.9982247948646545
Test Epoch7 layer3 Acc 0.9769714285714286, AUC 0.9981633424758911
Test Epoch7 layer4 Acc 0.9770142857142857, AUC 0.997980535030365
Test Epoch7 layer5 Acc 0.9770571428571428, AUC 0.9980191588401794
Test Epoch7 layer6 Acc 0.9769714285714286, AUC 0.997959315776825
Test Epoch7 layer7 Acc 0.9771428571428571, AUC 0.9978784918785095
Test Epoch7 layer8 Acc 0.07267142857142857, AUC 0.5158402323722839
Test Epoch7 layer9 Acc 0.13982857142857144, AUC 0.527779757976532
gc 0
Train Epoch8 Acc 0.14049464285714286 (78677/560000), AUC 0.529819130897522
Test Epoch8 layer0 Acc 0.9739571428571429, AUC 0.9983268976211548
Test Epoch8 layer1 Acc 0.977, AUC 0.9983590841293335
Test Epoch8 layer2 Acc 0.9771285714285715, AUC 0.998141884803772
Test Epoch8 layer3 Acc 0.9770142857142857, AUC 0.9979571104049683
Test Epoch8 layer4 Acc 0.9769142857142857, AUC 0.9978507161140442
Test Epoch8 layer5 Acc 0.9770142857142857, AUC 0.9977898001670837
Test Epoch8 layer6 Acc 0.977, AUC 0.9978057146072388
Test Epoch8 layer7 Acc 0.9769857142857142, AUC 0.9976699948310852
Test Epoch8 layer8 Acc 0.0733, AUC 0.5209537744522095
Test Epoch8 layer9 Acc 0.13992857142857143, AUC 0.5288742184638977
gc 0
Train Epoch9 Acc 0.14056428571428572 (78716/560000), AUC 0.529556393623352
Test Epoch9 layer0 Acc 0.9739, AUC 0.9983001351356506
Test Epoch9 layer1 Acc 0.9769857142857142, AUC 0.9983627200126648
Test Epoch9 layer2 Acc 0.9770857142857143, AUC 0.9982098340988159
Test Epoch9 layer3 Acc 0.9769571428571429, AUC 0.9981139898300171
Test Epoch9 layer4 Acc 0.9770714285714286, AUC 0.9980010986328125
Test Epoch9 layer5 Acc 0.9770285714285715, AUC 0.9979954361915588
Test Epoch9 layer6 Acc 0.9770714285714286, AUC 0.9979270696640015
Test Epoch9 layer7 Acc 0.9771285714285715, AUC 0.9978863596916199
Test Epoch9 layer8 Acc 0.07635714285714286, AUC 0.5204549431800842
Test Epoch9 layer9 Acc 0.14015714285714287, AUC 0.529981791973114
Best AUC 0.9984639286994934
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask8//dbpedia_14/dbpedia_14_linearal_l10_m8_prefix.pt
[[4707   41   21   14   12   64   39    8    3    6    4   22   19   40]
 [  33 4900    2    1    5    0   30    7    3    2    1    0    4   12]
 [  40   13 4610   20   49    1    9    4    5    0    1   80   25  143]
 [   2    2   28 4952   11    1    1    0    0    0    0    0    0    3]
 [   9   19   81   13 4842    8    5    1    2    1    0    0    3   16]
 [  38    2    3    4    1 4938    5    4    1    1    0    0    1    2]
 [  70   47    4    3   11   15 4779   42   15    5    1    1    5    2]
 [   0    1    0    0    2    0   11 4965   16    3    0    0    1    1]
 [   2    4    2    0    3    0   12   12 4965    0    0    0    0    0]
 [   1    0    0    3    1    0    0    6    0 4951   36    1    0    1]
 [  12    1    0    0    0    0    2    4    0   35 4945    0    0    1]
 [   6    0   36    3    0    0    0    0    0    1    0 4927   15   12]
 [   8    2   18    6    1    3    1    3    0    2    0   22 4886   48]
 [  36    4   73    8   12    3    3   10    1    7    4    7   44 4788]]
Figure(640x480)
[[4736   41   20    9   13   48   40    4    2    5    3   20   17   42]
 [  35 4907    3    1    6    0   30    1    1    2    0    0    4   10]
 [  34   14 4644   17   59    1    9    2    1    0    2   71   34  112]
 [   2    2   22 4958   12    0    1    0    0    0    0    0    0    3]
 [   6   12   59   12 4879    7    7    1    2    1    0    0    3   11]
 [  45    1    2    2    1 4937    5    3    1    0    0    0    1    2]
 [  65   45    4    3    9   13 4807   35    5    4    0    1    6    3]
 [   2    2    0    0    2    0   14 4962   11    3    1    0    2    1]
 [   2    4    2    0    4    0   13   20 4955    0    0    0    0    0]
 [   1    0    1    2    0    0    0    6    0 4960   28    0    0    2]
 [  12    1    0    0    0    0    2    3    0   38 4943    0    1    0]
 [   8    0   28    2    0    0    1    0    0    0    0 4934   15   12]
 [  12    2   16    3    0    1    0    1    0    0    0   19 4904   42]
 [  31    3   61    4    7    3    2    6    0    1    2    8   47 4825]]
Figure(640x480)
[[4746   40   20    7   13   48   39    5    1    6    3   18   13   41]
 [  38 4900    3    1    7    0   35    1    2    2    0    0    3    8]
 [  36   13 4669   17   62    1    9    2    0    0    2   62   27  100]
 [   2    2   24 4955   12    0    1    0    0    1    0    0    2    1]
 [   8   10   57   11 4884    7    7    1    1    4    0    0    2    8]
 [  46    1    3    2    1 4936    5    2    1    0    0    0    1    2]
 [  69   45    3    1    8   15 4810   33    4    3    0    1    5    3]
 [   3    2    1    0    2    0   13 4962   11    3    0    0    2    1]
 [   3    5    2    0    6    0   13   19 4950    0    0    0    0    2]
 [   1    0    1    2    0    0    0    5    0 4961   27    0    0    3]
 [  12    1    0    0    0    0    1    3    0   39 4944    0    0    0]
 [   8    0   33    2    0    0    0    0    0    0    0 4929   15   13]
 [  14    2   18    4    0    2    1    1    0    0    0   20 4896   42]
 [  36    3   78    2    8    3    4    6    0    1    1    7   47 4804]]
Figure(640x480)
[[4748   40   20    7   12   49   37    5    2    5    3   17   13   42]
 [  39 4899    3    1    8    0   35    1    1    2    0    0    3    8]
 [  35   14 4667   17   66    1    9    2    0    0    2   63   25   99]
 [   3    2   23 4955   12    0    1    0    0    1    0    0    1    2]
 [   8   10   57   12 4885    7    7    1    1    2    0    0    2    8]
 [  46    1    3    2    1 4936    5    2    1    0    0    0    1    2]
 [  72   46    3    1    8   16 4801   33    6    4    0    2    5    3]
 [   5    2    1    0    2    0   13 4959   12    3    0    0    2    1]
 [   3    5    2    0    6    0   13   17 4952    0    0    0    0    2]
 [   1    0    1    2    0    0    0    6    0 4953   34    0    0    3]
 [  12    1    0    0    0    0    1    4    0   33 4949    0    0    0]
 [   8    0   34    2    0    0    0    0    0    0    0 4928   16   12]
 [  13    2   18    2    0    2    1    2    0    0    0   22 4896   42]
 [  36    3   80    2    8    3    3    3    0    1    2    7   45 4807]]
Figure(640x480)
[[4740   40   20    7   12   50   37    6    2    6    2   20   15   43]
 [  38 4901    3    1    8    0   34    0    2    2    0    0    3    8]
 [  35   13 4674   17   65    1    9    2    0    0    2   61   25   96]
 [   2    2   23 4955   12    1    1    0    0    1    0    0    1    2]
 [   7    9   62   12 4884    7    7    1    1    3    0    0    2    5]
 [  43    2    2    2    1 4939    5    2    1    0    0    0    1    2]
 [  72   47    3    1   10   15 4798   33    6    5    0    2    5    3]
 [   5    2    0    0    2    0   13 4961   11    3    0    0    2    1]
 [   3    2    2    0    6    0   13   17 4956    0    0    0    0    1]
 [   1    0    1    2    0    0    0    7    0 4953   33    0    0    3]
 [  12    1    0    0    0    0    1    3    0   35 4948    0    0    0]
 [   8    0   35    2    0    0    0    0    0    0    0 4927   16   12]
 [  13    2   18    2    0    2    1    2    0    0    0   22 4896   42]
 [  35    2   82    1    8    3    3    3    0    2    1    7   45 4808]]
Figure(640x480)
[[4748   40   21    7   12   49   35    6    2    5    3   18   12   42]
 [  39 4896    4    1    8    0   36    1    2    2    0    0    3    8]
 [  34   12 4680   17   63    1    9    1    0    0    2   57   24  100]
 [   2    2   23 4955   13    1    1    0    0    1    0    0    1    1]
 [   7   10   59   12 4885    7    8    1    1    3    0    0    2    5]
 [  43    2    1    2    1 4940    5    2    1    0    0    0    1    2]
 [  75   46    5    1   10   16 4793   33    7    5    0    1    4    4]
 [   5    2    1    0    2    0   13 4959   12    3    1    0    1    1]
 [   4    2    2    0    6    0   13   17 4954    0    0    0    0    2]
 [   1    0    1    2    0    0    0    7    0 4956   30    0    0    3]
 [  12    1    0    0    0    0    1    3    0   34 4949    0    0    0]
 [   8    0   37    2    0    0    0    0    0    0    0 4925   16   12]
 [  13    2   18    2    0    2    1    2    0    1    0   22 4895   42]
 [  35    2   82    2    7    3    4    3    0    2    2    7   45 4806]]
Figure(640x480)
[[4745   40   20    7   12   50   35    5    2    6    3   18   14   43]
 [  39 4900    3    1    7    0   34    1    2    2    0    0    3    8]
 [  36   14 4678   19   65    1    9    0    0    0    2   58   22   96]
 [   3    2   21 4956   14    1    1    0    0    0    0    0    1    1]
 [   5   11   61   12 4885    7    7    1    1    3    0    0    2    5]
 [  43    2    2    2    1 4939    5    2    1    0    0    0    1    2]
 [  74   46    4    1   10   16 4795   33    6    5    0    1    5    4]
 [   5    2    1    0    2    0   13 4959   12    3    0    0    2    1]
 [   4    2    2    0    6    0   13   15 4957    0    0    0    0    1]
 [   1    0    1    2    0    0    0    6    0 4955   32    0    0    3]
 [  12    1    0    0    0    0    1    3    0   34 4949    0    0    0]
 [   9    0   36    2    0    0    0    0    0    0    0 4925   15   13]
 [  13    2   18    2    0    2    1    2    0    1    0   22 4895   42]
 [  34    2   84    1    8    3    3    3    0    2    2    6   43 4809]]
Figure(640x480)
[[4744   41   20    7   12   50   35    6    2    6    3   17   14   43]
 [  39 4899    3    1    8    0   33    1    2    2    0    0    4    8]
 [  35   13 4677   17   64    1    9    1    0    0    2   60   23   98]
 [   2    2   22 4956   12    1    1    0    0    1    0    0    2    1]
 [   8   11   61   12 4882    7    7    1    1    3    0    0    2    5]
 [  43    2    1    2    1 4940    5    2    1    0    0    0    1    2]
 [  71   47    3    1   10   14 4800   33    6    5    0    1    5    4]
 [   5    2    1    0    2    0   13 4959   12    3    0    0    2    1]
 [   4    2    2    0    6    0   13   16 4955    0    0    0    0    2]
 [   1    0    1    2    0    1    0    6    0 4959   27    0    0    3]
 [  12    1    0    0    0    0    1    3    0   39 4944    0    0    0]
 [   8    0   36    2    0    0    0    0    0    0    0 4927   16   11]
 [  13    2   18    2    0    2    1    2    0    1    0   21 4896   42]
 [  34    2   83    2    8    3    3    3    0    2    1    8   44 4807]]
Figure(640x480)
[[  30    1    3   28  110    0    0   62    0   35    0  118 4613    0]
 [   6    0    0    0   28    1    0 4909    0    1    0   37   18    0]
 [  27    0    1    0   72    0    0   33    0 4680    0  135   52    0]
 [   9    1   97    0 4867    0    0    3    0   12    0    2    9    0]
 [  10    0    0    0   38    0    0   13    0  159    0   25 4755    0]
 [   4    0    0 4753   39    0    0    9    1  169    0    7   18    0]
 [  38    7    0    9    5    0    0   52    0   23    1 4810   55    0]
 [4913   30    0    0    0    0    0    3    0   30    1   16    7    0]
 [   9    0    0    0    1    0    0   10    0 4963    0   13    4    0]
 [4982    0    0    0    2   14    0    1    0    0    0    0    1    0]
 [  94    0    0    0    1 4879    1    3    0    0    0    4   18    0]
 [  14    0    0    0    2    0    0   57    0   71    0 4849    7    0]
 [  45    0    0    0    2    4    0 4855    2   21   18   43   10    0]
 [  29    1    0    0    5    7    0   36    1  113    3 4780   25    0]]
Figure(640x480)
[[4789    0   18   14    0    0    0   42    0    0    1    0  129    7]
 [  33    0    5    7    0    1    0    4    0    0    2    0 4946    2]
 [  39    0   18    3    0    0    0    6    0    0    0    0 4934    0]
 [   2    0    1    0    0    0    0    0    0    0    0    0 4993    4]
 [  11    0    1    0    0    0    0    1    0    0    0    0 4987    0]
 [4494    0    3    2    0    0    0   30    0    0    0    0  471    0]
 [ 452    0   10 4309    0    0    0   48    1    0    1    0  179    0]
 [  10    0    3    8    3    0    0 4949    0    0    0    0   27    0]
 [   6    0 4882   13   23    0    0   66    0    0    0    0   10    0]
 [4730    0    0    0    0    0    0    8    0    0    0    0  262    0]
 [  14    0    1    0    0    0    0    2    0    0    0    0 4983    0]
 [ 150    0   14    0    1    0    0   20    0    0    0    0 4815    0]
 [  18    0 4886    0    1    0    0   17    0    0    0    0   78    0]
 [  30    0   45    2    0    0    0  172    0    0    0    0 4751    0]]
Figure(640x480)
