total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask6//dbpedia_14/dbpedia_14_linearal_l10_m6_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.08298571428571429 (46472/560000), AUC 0.49960026144981384
Test Epoch0 layer0 Acc 0.9741428571428571, AUC 0.9983197450637817
Save ckpt to ./ckpt/mask7//dbpedia_14/dbpedia_14_linearal_l10_m7_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9765142857142857, AUC 0.9984489679336548
Save ckpt to ./ckpt/mask7//dbpedia_14/dbpedia_14_linearal_l10_m7_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9764857142857143, AUC 0.9982732534408569
Test Epoch0 layer3 Acc 0.9764142857142857, AUC 0.9981881976127625
Test Epoch0 layer4 Acc 0.9766714285714285, AUC 0.9981603622436523
Test Epoch0 layer5 Acc 0.9765142857142857, AUC 0.9981440901756287
Test Epoch0 layer6 Acc 0.9765428571428572, AUC 0.998148500919342
Test Epoch0 layer7 Acc 0.04978571428571429, AUC 0.519449770450592
Test Epoch0 layer8 Acc 0.20105714285714285, AUC 0.5961399674415588
Test Epoch0 layer9 Acc 0.09574285714285714, AUC 0.4975126385688782
gc 0
Train Epoch1 Acc 0.1191625 (66731/560000), AUC 0.4920473098754883
Test Epoch1 layer0 Acc 0.9738142857142857, AUC 0.9983234405517578
Test Epoch1 layer1 Acc 0.9764571428571429, AUC 0.9984254240989685
Test Epoch1 layer2 Acc 0.9765428571428572, AUC 0.9982298016548157
Test Epoch1 layer3 Acc 0.9765428571428572, AUC 0.9981990456581116
Test Epoch1 layer4 Acc 0.9766142857142858, AUC 0.9980639815330505
Test Epoch1 layer5 Acc 0.9765, AUC 0.9982371926307678
Test Epoch1 layer6 Acc 0.9766428571428571, AUC 0.9981427192687988
Test Epoch1 layer7 Acc 0.08775714285714285, AUC 0.5254722833633423
Test Epoch1 layer8 Acc 0.20537142857142857, AUC 0.5750979781150818
Test Epoch1 layer9 Acc 0.12981428571428572, AUC 0.4902346134185791
gc 0
Train Epoch2 Acc 0.12738214285714286 (71334/560000), AUC 0.49037912487983704
Test Epoch2 layer0 Acc 0.9740142857142857, AUC 0.9983271956443787
Test Epoch2 layer1 Acc 0.9766428571428571, AUC 0.9983989596366882
Test Epoch2 layer2 Acc 0.9766285714285714, AUC 0.9981423020362854
Test Epoch2 layer3 Acc 0.9763571428571428, AUC 0.9980137944221497
Test Epoch2 layer4 Acc 0.9764571428571429, AUC 0.9979090690612793
Test Epoch2 layer5 Acc 0.9765571428571429, AUC 0.9978591203689575
Test Epoch2 layer6 Acc 0.9765142857142857, AUC 0.997914731502533
Test Epoch2 layer7 Acc 0.08614285714285715, AUC 0.5171674489974976
Test Epoch2 layer8 Acc 0.20542857142857143, AUC 0.5797303318977356
Test Epoch2 layer9 Acc 0.12415714285714285, AUC 0.4939255714416504
gc 0
Train Epoch3 Acc 0.12250892857142857 (68605/560000), AUC 0.5026006102561951
Test Epoch3 layer0 Acc 0.9739, AUC 0.9983086585998535
Test Epoch3 layer1 Acc 0.9769, AUC 0.9983992576599121
Test Epoch3 layer2 Acc 0.9768714285714286, AUC 0.9981696009635925
Test Epoch3 layer3 Acc 0.9768714285714286, AUC 0.998106062412262
Test Epoch3 layer4 Acc 0.9768571428571429, AUC 0.9979720115661621
Test Epoch3 layer5 Acc 0.9768428571428571, AUC 0.9980627298355103
Test Epoch3 layer6 Acc 0.9769, AUC 0.9980068206787109
Test Epoch3 layer7 Acc 0.08732857142857142, AUC 0.525057852268219
Test Epoch3 layer8 Acc 0.2048, AUC 0.5853396058082581
Test Epoch3 layer9 Acc 0.1268857142857143, AUC 0.5104488134384155
gc 0
Train Epoch4 Acc 0.13589642857142858 (76102/560000), AUC 0.5188167691230774
Test Epoch4 layer0 Acc 0.9737857142857143, AUC 0.9983488917350769
Test Epoch4 layer1 Acc 0.9766571428571429, AUC 0.9984253644943237
Test Epoch4 layer2 Acc 0.9770428571428571, AUC 0.9982430338859558
Test Epoch4 layer3 Acc 0.9769285714285715, AUC 0.9980400204658508
Test Epoch4 layer4 Acc 0.977, AUC 0.9979658722877502
Test Epoch4 layer5 Acc 0.9769285714285715, AUC 0.9980345964431763
Test Epoch4 layer6 Acc 0.9769857142857142, AUC 0.9979182481765747
Test Epoch4 layer7 Acc 0.0805, AUC 0.5295321345329285
Test Epoch4 layer8 Acc 0.20391428571428571, AUC 0.5856580138206482
Test Epoch4 layer9 Acc 0.12977142857142857, AUC 0.5222446918487549
gc 0
Train Epoch5 Acc 0.14618928571428572 (81866/560000), AUC 0.5269774198532104
Test Epoch5 layer0 Acc 0.9738714285714286, AUC 0.9983157515525818
Test Epoch5 layer1 Acc 0.977, AUC 0.9984134435653687
Test Epoch5 layer2 Acc 0.9769428571428571, AUC 0.998202383518219
Test Epoch5 layer3 Acc 0.9769428571428571, AUC 0.9981406331062317
Test Epoch5 layer4 Acc 0.9769714285714286, AUC 0.9980031251907349
Test Epoch5 layer5 Acc 0.9768714285714286, AUC 0.9980246424674988
Test Epoch5 layer6 Acc 0.9767714285714286, AUC 0.9980339407920837
Test Epoch5 layer7 Acc 0.0929, AUC 0.5330991148948669
Test Epoch5 layer8 Acc 0.20702857142857142, AUC 0.5939530730247498
Test Epoch5 layer9 Acc 0.1576857142857143, AUC 0.5330328941345215
gc 0
Train Epoch6 Acc 0.15208392857142858 (85167/560000), AUC 0.5344613194465637
Test Epoch6 layer0 Acc 0.9739285714285715, AUC 0.9983211159706116
Test Epoch6 layer1 Acc 0.9769285714285715, AUC 0.998430073261261
Test Epoch6 layer2 Acc 0.9771571428571428, AUC 0.9981516599655151
Test Epoch6 layer3 Acc 0.9769571428571429, AUC 0.9979681372642517
Test Epoch6 layer4 Acc 0.977, AUC 0.9978570938110352
Test Epoch6 layer5 Acc 0.9770285714285715, AUC 0.9978389739990234
Test Epoch6 layer6 Acc 0.9771571428571428, AUC 0.9978806376457214
Test Epoch6 layer7 Acc 0.09368571428571429, AUC 0.5371283292770386
Test Epoch6 layer8 Acc 0.2072857142857143, AUC 0.5927733778953552
Test Epoch6 layer9 Acc 0.15505714285714287, AUC 0.5381775498390198
gc 0
Train Epoch7 Acc 0.14920178571428572 (83553/560000), AUC 0.5418577790260315
Test Epoch7 layer0 Acc 0.9739428571428571, AUC 0.9983168840408325
Test Epoch7 layer1 Acc 0.977, AUC 0.9984216690063477
Test Epoch7 layer2 Acc 0.9772714285714286, AUC 0.9981805086135864
Test Epoch7 layer3 Acc 0.9772285714285714, AUC 0.9980641603469849
Test Epoch7 layer4 Acc 0.9772285714285714, AUC 0.9979804754257202
Test Epoch7 layer5 Acc 0.9772142857142857, AUC 0.9978926777839661
Test Epoch7 layer6 Acc 0.9771857142857143, AUC 0.998001754283905
Test Epoch7 layer7 Acc 0.10118571428571428, AUC 0.5404873490333557
Test Epoch7 layer8 Acc 0.20757142857142857, AUC 0.5934867858886719
Test Epoch7 layer9 Acc 0.14691428571428572, AUC 0.548251748085022
gc 0
Train Epoch8 Acc 0.14867678571428572 (83259/560000), AUC 0.5485808849334717
Test Epoch8 layer0 Acc 0.9739142857142857, AUC 0.9983280897140503
Test Epoch8 layer1 Acc 0.9767857142857143, AUC 0.9983826875686646
Test Epoch8 layer2 Acc 0.9770428571428571, AUC 0.9981832504272461
Test Epoch8 layer3 Acc 0.9769285714285715, AUC 0.9979691505432129
Test Epoch8 layer4 Acc 0.9769857142857142, AUC 0.9978427886962891
Test Epoch8 layer5 Acc 0.9769571428571429, AUC 0.9977970719337463
Test Epoch8 layer6 Acc 0.9770285714285715, AUC 0.9977332353591919
Test Epoch8 layer7 Acc 0.10244285714285714, AUC 0.5464160442352295
Test Epoch8 layer8 Acc 0.2078142857142857, AUC 0.5934910178184509
Test Epoch8 layer9 Acc 0.15194285714285713, AUC 0.5497702360153198
gc 0
Train Epoch9 Acc 0.14724107142857143 (82455/560000), AUC 0.5511403679847717
Test Epoch9 layer0 Acc 0.9738714285714286, AUC 0.9983223676681519
Test Epoch9 layer1 Acc 0.9769142857142857, AUC 0.9984264969825745
Test Epoch9 layer2 Acc 0.9772714285714286, AUC 0.99823397397995
Test Epoch9 layer3 Acc 0.9771, AUC 0.9981510043144226
Test Epoch9 layer4 Acc 0.9771714285714286, AUC 0.9978920817375183
Test Epoch9 layer5 Acc 0.9772, AUC 0.9979500770568848
Test Epoch9 layer6 Acc 0.9772142857142857, AUC 0.9979633688926697
Test Epoch9 layer7 Acc 0.10387142857142857, AUC 0.5488948822021484
Test Epoch9 layer8 Acc 0.20765714285714285, AUC 0.591192901134491
Test Epoch9 layer9 Acc 0.15025714285714287, AUC 0.5538595914840698
Best AUC 0.9984489679336548
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask7//dbpedia_14/dbpedia_14_linearal_l10_m7_prefix.pt
[[4696   43   21   14   11   68   43    8    3    6    5   22   18   42]
 [  34 4898    1    1    7    0   31    7    4    2    1    0    5    9]
 [  38   15 4600   19   57    1   11    4    5    0    1   84   22  143]
 [   2    2   30 4949   12    1    1    0    0    0    0    0    0    3]
 [   9   16   64   12 4867    8    6    1    2    0    0    1    3   11]
 [  37    2    3    3    1 4942    5    2    1    1    0    0    1    2]
 [  61   45    4    2   11   15 4800   39    9    5    1    1    4    3]
 [   0    1    0    0    2    0   12 4963   17    3    0    0    1    1]
 [   2    4    2    0    3    0   12   12 4965    0    0    0    0    0]
 [   1    0    0    2    1    0    0    7    0 4956   31    1    0    1]
 [  12    1    0    0    0    0    2    4    0   35 4945    1    0    0]
 [   5    0   34    2    0    0    0    0    0    1    0 4931   15   12]
 [   7    2   21    5    1    3    2    3    0    2    0   22 4887   45]
 [  33    5   70    8   13    3    6   10    1    5    3    7   45 4791]]
Figure(640x480)
[[4719   44   18   10   13   54   44    5    2    5    4   21   15   46]
 [  30 4915    2    2    6    1   29    1    1    2    1    0    3    7]
 [  32   14 4658   16   61    1   11    2    1    0    2   71   23  108]
 [   2    2   22 4958   12    0    1    0    0    0    0    1    0    2]
 [   5   14   58   12 4879    7    9    0    2    2    0    0    2   10]
 [  41    1    2    2    1 4942    5    2    1    0    0    0    1    2]
 [  57   47    4    3    9   12 4820   31    4    3    0    1    6    3]
 [   1    2    0    0    2    0   13 4964   11    3    1    0    2    1]
 [   2    3    2    0    5    0   16   19 4953    0    0    0    0    0]
 [   1    0    1    2    0    0    0    6    0 4961   27    0    0    2]
 [  12    1    0    0    0    0    2    4    0   40 4941    0    0    0]
 [   8    0   31    2    0    1    0    0    0    0    0 4932   15   11]
 [   9    2   18    3    0    3    1    1    0    0    0   20 4903   40]
 [  27    5   71    5    8    3    4    5    0    1    2    8   50 4811]]
Figure(640x480)
[[4730   44   20    9   12   51   42    5    1    6    4   18   14   44]
 [  39 4909    2    1    8    1   29    0    0    2    0    0    2    7]
 [  34   14 4672   16   60    1   10    1    1    3    2   64   21  101]
 [   2    2   24 4955   12    0    1    0    0    3    0    0    1    0]
 [   6   13   58   12 4881    7    8    0    1    5    0    0    2    7]
 [  44    1    3    2    1 4938    5    2    1    0    0    0    1    2]
 [  61   47    3    1    8   16 4821   30    2    3    0    1    4    3]
 [   1    2    1    0    2    0   14 4962   11    3    1    0    2    1]
 [   3    4    2    0    5    0   17   16 4952    0    0    0    0    1]
 [   1    0    1    2    0    0    0    5    0 4960   28    0    0    3]
 [  12    1    0    0    0    0    1    3    0   43 4940    0    0    0]
 [   8    0   33    2    0    0    0    0    0    0    0 4929   15   13]
 [  11    2   19    3    0    3    1    1    0    0    0   22 4895   43]
 [  32    4   75    3    8    3    4    6    0    2    1    6   46 4810]]
Figure(640x480)
[[4736   41   19    7   11   52   43    7    2    6    4   18   12   42]
 [  40 4907    2    0    7    0   31    0    1    4    0    0    2    6]
 [  35   14 4665   16   62    1   10    1    0    4    2   69   21  100]
 [   3    2   25 4952   12    1    1    0    0    3    0    0    1    0]
 [   7   12   55   10 4887    7    8    0    1    5    0    0    2    6]
 [  43    2    3    2    1 4938    5    2    1    0    0    0    1    2]
 [  61   49    3    1    8   16 4818   28    4    4    0    1    4    3]
 [   4    2    1    0    2    0   15 4958   12    3    1    0    1    1]
 [   3    4    2    0    5    0   15   14 4956    0    0    0    0    1]
 [   1    0    1    2    0    0    0    6    0 4957   30    0    0    3]
 [  12    1    0    0    0    0    1    3    0   38 4945    0    0    0]
 [   8    0   33    2    0    0    0    0    0    0    0 4929   16   12]
 [  14    2   20    1    0    3    1    1    0    0    0   21 4895   42]
 [  35    4   79    2    8    3    4    3    0    2    2    6   46 4806]]
Figure(640x480)
[[4734   42   19    7   12   51   44    6    2    6    4   18   12   43]
 [  39 4911    2    0    7    0   28    0    1    4    0    0    2    6]
 [  35   14 4666   16   63    1   10    0    0    4    2   67   20  102]
 [   2    2   25 4953   12    1    1    0    0    3    0    0    1    0]
 [   7   13   57   11 4882    7    9    0    1    5    0    0    2    6]
 [  42    2    3    1    1 4940    5    2    1    0    0    0    1    2]
 [  60   50    3    1    9   15 4819   27    4    4    0    1    4    3]
 [   4    2    0    0    2    0   15 4958   12    4    1    0    1    1]
 [   3    2    2    0    6    0   14   14 4958    0    0    0    0    1]
 [   1    0    0    2    0    0    0    6    0 4959   29    0    0    3]
 [  12    1    0    0    0    0    1    3    0   39 4944    0    0    0]
 [   8    0   33    2    0    0    0    0    0    0    0 4931   16   10]
 [  13    2   20    1    0    3    1    1    0    0    0   21 4896   42]
 [  34    3   72    1    8    3    4    3    0    2    1    7   46 4816]]
Figure(640x480)
[[4732   41   20    7   12   50   45    6    2    6    4   19   11   45]
 [  39 4904    2    0    6    0   35    0    2    4    0    0    2    6]
 [  34   14 4666   16   63    1   10    0    0    3    2   65   21  105]
 [   2    2   25 4952   13    1    1    0    0    3    0    0    1    0]
 [   7   12   55   10 4886    7    8    0    1    5    0    1    2    6]
 [  43    2    2    1    1 4940    5    2    1    0    0    0    1    2]
 [  58   48    4    1    8   15 4825   27    4    3    0    1    3    3]
 [   4    2    2    0    2    1   15 4955   12    4    1    0    1    1]
 [   3    2    2    0    5    0   15   14 4958    0    0    0    0    1]
 [   1    0    0    2    0    0    0    6    0 4958   30    0    0    3]
 [  12    1    0    0    0    0    1    3    0   38 4945    0    0    0]
 [   9    0   36    2    0    0    0    0    0    0    0 4926   16   11]
 [  14    2   20    2    0    3    1    1    0    1    0   21 4893   42]
 [  33    4   72    2    7    3    5    3    0    2    0    7   46 4816]]
Figure(640x480)
[[4740   42   20    7   12   50   43    6    1    6    4   13   12   44]
 [  38 4908    1    1    8    0   32    0    1    2    0    0    2    7]
 [  35   14 4668   17   66    1    9    0    0    2    2   64   20  102]
 [   4    2   24 4951   13    1    1    0    0    3    0    0    1    0]
 [   6   13   56   10 4886    7    8    0    1    5    0    0    2    6]
 [  43    2    2    1    1 4940    5    1    1    1    0    0    1    2]
 [  58   48    4    1    8   16 4822   27    4    5    0    1    3    3]
 [   3    2    1    0    2    0   16 4957   12    4    0    0    2    1]
 [   4    4    2    0    5    0   16   14 4954    0    0    0    0    1]
 [   1    0    1    2    0    0    0    6    0 4957   30    0    0    3]
 [  12    1    0    0    0    0    1    3    0   37 4946    0    0    0]
 [  10    0   36    2    0    0    0    0    0    0    0 4924   16   12]
 [  14    2   21    2    0    3    1    2    0    1    0   21 4891   42]
 [  34    4   77    2    8    3    3    3    0    1    1    6   44 4814]]
Figure(640x480)
[[3261    0   30 1441   42   46    6   87    0    1    0   86    0    0]
 [   8    0    6   12   67    0    1   10    0   11    0 4885    0    0]
 [  93    0   61    5   72   74    1   11    0    1    0 4682    0    0]
 [   1    0   52    1  349    0    0    8    0    1    0 4588    0    0]
 [   4    0 4854    1   34    1    0   15    0   32    0   59    0    0]
 [  23    0    6    8    1    1    0 2078    0    0    0 2882    1    0]
 [ 133    0 4395   37  320    4    0   20    1    2    0   88    0    0]
 [  92    0    4    0   11    1    0    6    0    0    0 4885    1    0]
 [   0    0    7   10 4827    0    0    3    0    1    0  152    0    0]
 [   0    0    0    1    0    1    0 4864    0   81    0   53    0    0]
 [   5    0    0    7    1    0    0   28    0    0    0 4959    0    0]
 [  31    0    0    3   28 4886    8    5    0    0    0   39    0    0]
 [  67    0    0   54   42   52 3983    8    2   15    0  776    1    0]
 [  31    0    9    1    3 2219    3    4    0   16    0 2714    0    0]]
Figure(640x480)
[[3956    0    0   38  898    6    0   12    0    0    2   86    2    0]
 [  62    0    0    0 1229 3635    0   40    0    0    0   34    0    0]
 [  49    0    0    0 4775    0    0    6    0   29   12  122    7    0]
 [  11    1    0    0 4965    0    0    7    3    0    0   10    3    0]
 [  24    1    0    0  310    0    0    8    2    5    0  826 3824    0]
 [  55    0    0 4572   13    0    0  350    5    0    0    5    0    0]
 [  53   11    0    2   54   12    0   47    0    0    3 4818    0    0]
 [ 906 4051    0    1    2    0    0    3    3    0    0   34    0    0]
 [  26    2    0    0   26    0    0  274 4592    4    0   76    0    0]
 [4008    1    0    0  987    0    0    1    0    0    3    0    0    0]
 [4425    0    0    0    7    0    0   31    0    0  536    1    0    0]
 [ 269    0    0    0   48    0    0    6    0    0    0 4677    0    0]
 [4884    0    0    0   29    0    0   56    1    0    2   28    0    0]
 [ 178    1    0    1  128    0    0    2    1    3  604 4082    0    0]]
Figure(640x480)
[[4901    0    0    0    0    0    0   34    0    0    0    0   59    6]
 [  62    0    0    0    0    0    0    9    0    0    0    0 4928    1]
 [ 166    0    0    3    0    0    0   92    0    0    0    0 4731    8]
 [  12    0    0    0    0    0    0    2    0    0    0    0  177 4809]
 [  69    0    0    0    0    0    0   62    0    0    0    0 4857   12]
 [ 930    0    0    0    0    0   11   14    0    0    0    0 4045    0]
 [4050    0    0    1    0    0    0  859    0    0    0    0   89    1]
 [3212    0    0   34    0    0    0 1747    0    0    0    0    5    2]
 [  26    0    4    4    0    0    0 4958    2    0    0    0    6    0]
 [ 246    0    0    0    0    0    0    1    0    0    0    0   14 4739]
 [  36    0    0    0    0    0    0   49    0    0    0    0 4842   73]
 [4958    0    0    0    0    0    0    8    0    0    0    0   32    2]
 [4900    0    0   12    0    0    0   37    0    0    0    0   51    0]
 [ 124    0    0   23    0    0    0 4752    0    0    0    0  100    1]]
Figure(640x480)
