total count words 887881
vocab size 30000
found 28354 words in glove
Load ckpt from ./ckpt/mask5//dbpedia_14/dbpedia_14_lstmal_l10_m5_prefix.pt
Start Training
gc 9
Train Epoch0 Acc 0.0339125 (18991/560000), AUC 0.44002047181129456
Test Epoch0 layer0 Acc 0.9739285714285715, AUC 0.9983068108558655
Save ckpt to ./ckpt/mask6//dbpedia_14/dbpedia_14_lstmal_l10_m6_prefix.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9859285714285714, AUC 0.998475968837738
Save ckpt to ./ckpt/mask6//dbpedia_14/dbpedia_14_lstmal_l10_m6_prefix.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9859857142857142, AUC 0.9984022378921509
Test Epoch0 layer3 Acc 0.9859285714285714, AUC 0.9975028038024902
Test Epoch0 layer4 Acc 0.9858, AUC 0.9979372620582581
Test Epoch0 layer5 Acc 0.9857428571428571, AUC 0.9975494742393494
Test Epoch0 layer6 Acc 0.07245714285714286, AUC 0.5330942273139954
Test Epoch0 layer7 Acc 0.1856, AUC 0.49810248613357544
Test Epoch0 layer8 Acc 0.07147142857142857, AUC 0.4747256636619568
Test Epoch0 layer9 Acc 0.07142857142857142, AUC 0.44941192865371704
gc 0
Train Epoch1 Acc 0.07142857142857142 (40000/560000), AUC 0.4530985653400421
Test Epoch1 layer0 Acc 0.9738857142857142, AUC 0.9982897043228149
Test Epoch1 layer1 Acc 0.9855, AUC 0.9984434843063354
Test Epoch1 layer2 Acc 0.9855285714285714, AUC 0.9981973767280579
Test Epoch1 layer3 Acc 0.9854285714285714, AUC 0.9972073435783386
Test Epoch1 layer4 Acc 0.9854714285714286, AUC 0.9978066086769104
Test Epoch1 layer5 Acc 0.9852714285714286, AUC 0.9972734451293945
Test Epoch1 layer6 Acc 0.07665714285714285, AUC 0.5106655359268188
Test Epoch1 layer7 Acc 0.16372857142857142, AUC 0.5072455406188965
Test Epoch1 layer8 Acc 0.07147142857142857, AUC 0.44969630241394043
Test Epoch1 layer9 Acc 0.07142857142857142, AUC 0.4572344124317169
gc 0
Train Epoch2 Acc 0.07142857142857142 (40000/560000), AUC 0.462566077709198
Test Epoch2 layer0 Acc 0.9736285714285714, AUC 0.9982653260231018
Test Epoch2 layer1 Acc 0.9857, AUC 0.9981879591941833
Test Epoch2 layer2 Acc 0.9857714285714285, AUC 0.9979787468910217
Test Epoch2 layer3 Acc 0.9857428571428571, AUC 0.9971112012863159
Test Epoch2 layer4 Acc 0.9857428571428571, AUC 0.9973921179771423
Test Epoch2 layer5 Acc 0.9857, AUC 0.9971842169761658
Test Epoch2 layer6 Acc 0.13745714285714286, AUC 0.486176997423172
Test Epoch2 layer7 Acc 0.1299142857142857, AUC 0.5061407685279846
Test Epoch2 layer8 Acc 0.07145714285714286, AUC 0.4338003993034363
Test Epoch2 layer9 Acc 0.07142857142857142, AUC 0.4730094373226166
gc 0
Train Epoch3 Acc 0.07142857142857142 (40000/560000), AUC 0.47016340494155884
Test Epoch3 layer0 Acc 0.9736, AUC 0.9982690215110779
Test Epoch3 layer1 Acc 0.9858571428571429, AUC 0.9982002377510071
Test Epoch3 layer2 Acc 0.9858428571428571, AUC 0.9981963038444519
Test Epoch3 layer3 Acc 0.9858428571428571, AUC 0.9973101019859314
Test Epoch3 layer4 Acc 0.9859142857142857, AUC 0.9975221753120422
Test Epoch3 layer5 Acc 0.9858857142857143, AUC 0.9972344636917114
Test Epoch3 layer6 Acc 0.13957142857142857, AUC 0.47031208872795105
Test Epoch3 layer7 Acc 0.13627142857142857, AUC 0.5062224268913269
Test Epoch3 layer8 Acc 0.07144285714285714, AUC 0.4250500798225403
Test Epoch3 layer9 Acc 0.07142857142857142, AUC 0.46622398495674133
gc 0
Train Epoch4 Acc 0.07142857142857142 (40000/560000), AUC 0.4713993966579437
Test Epoch4 layer0 Acc 0.9735714285714285, AUC 0.9982729554176331
Test Epoch4 layer1 Acc 0.9849428571428571, AUC 0.9979761242866516
Test Epoch4 layer2 Acc 0.9849714285714286, AUC 0.9976857304573059
Test Epoch4 layer3 Acc 0.985, AUC 0.9969175457954407
Test Epoch4 layer4 Acc 0.9850142857142857, AUC 0.9968675971031189
Test Epoch4 layer5 Acc 0.9849571428571429, AUC 0.9968534111976624
Test Epoch4 layer6 Acc 0.13992857142857143, AUC 0.45807939767837524
Test Epoch4 layer7 Acc 0.1379857142857143, AUC 0.5096343755722046
Test Epoch4 layer8 Acc 0.07142857142857142, AUC 0.4014790654182434
Test Epoch4 layer9 Acc 0.07142857142857142, AUC 0.4745464622974396
gc 0
Train Epoch5 Acc 0.07142857142857142 (40000/560000), AUC 0.47463181614875793
Test Epoch5 layer0 Acc 0.9736857142857143, AUC 0.9982737302780151
Test Epoch5 layer1 Acc 0.9857, AUC 0.9979339241981506
Test Epoch5 layer2 Acc 0.9855428571428572, AUC 0.9977825284004211
Test Epoch5 layer3 Acc 0.9855857142857143, AUC 0.9971274733543396
Test Epoch5 layer4 Acc 0.9856571428571429, AUC 0.9971492886543274
Test Epoch5 layer5 Acc 0.9856428571428572, AUC 0.9968875050544739
Test Epoch5 layer6 Acc 0.1417857142857143, AUC 0.4554504454135895
Test Epoch5 layer7 Acc 0.13715714285714287, AUC 0.5092923641204834
Test Epoch5 layer8 Acc 0.07144285714285714, AUC 0.4070501923561096
Test Epoch5 layer9 Acc 0.07142857142857142, AUC 0.47287502884864807
gc 0
Train Epoch6 Acc 0.07142857142857142 (40000/560000), AUC 0.47566813230514526
Test Epoch6 layer0 Acc 0.9738, AUC 0.9982887506484985
Test Epoch6 layer1 Acc 0.9856428571428572, AUC 0.9978838562965393
Test Epoch6 layer2 Acc 0.9855, AUC 0.9977437257766724
Test Epoch6 layer3 Acc 0.9855714285714285, AUC 0.9970093369483948
Test Epoch6 layer4 Acc 0.9856571428571429, AUC 0.9970448613166809
Test Epoch6 layer5 Acc 0.9856, AUC 0.9970490336418152
Test Epoch6 layer6 Acc 0.14162857142857144, AUC 0.45214444398880005
Test Epoch6 layer7 Acc 0.10552857142857143, AUC 0.5153363943099976
Test Epoch6 layer8 Acc 0.07144285714285714, AUC 0.4010584354400635
Test Epoch6 layer9 Acc 0.07142857142857142, AUC 0.47641023993492126
gc 0
Train Epoch7 Acc 0.07142857142857142 (40000/560000), AUC 0.475089967250824
Test Epoch7 layer0 Acc 0.9735285714285714, AUC 0.9982677698135376
Test Epoch7 layer1 Acc 0.9855714285714285, AUC 0.9978223443031311
Test Epoch7 layer2 Acc 0.9855714285714285, AUC 0.9974667429924011
Test Epoch7 layer3 Acc 0.9855428571428572, AUC 0.9966967701911926
Test Epoch7 layer4 Acc 0.9855571428571429, AUC 0.9969108700752258
Test Epoch7 layer5 Acc 0.9855285714285714, AUC 0.9966810941696167
Test Epoch7 layer6 Acc 0.1415, AUC 0.449199914932251
Test Epoch7 layer7 Acc 0.1394, AUC 0.5191059708595276
Test Epoch7 layer8 Acc 0.07147142857142857, AUC 0.3991379141807556
Test Epoch7 layer9 Acc 0.07142857142857142, AUC 0.4752921462059021
gc 0
Train Epoch8 Acc 0.07142857142857142 (40000/560000), AUC 0.4750806987285614
Test Epoch8 layer0 Acc 0.9737, AUC 0.9982976913452148
Test Epoch8 layer1 Acc 0.9856428571428572, AUC 0.9977748990058899
Test Epoch8 layer2 Acc 0.9857714285714285, AUC 0.9974254369735718
Test Epoch8 layer3 Acc 0.9857285714285714, AUC 0.9964948892593384
Test Epoch8 layer4 Acc 0.9857714285714285, AUC 0.9967573285102844
Test Epoch8 layer5 Acc 0.9856857142857143, AUC 0.9963352084159851
Test Epoch8 layer6 Acc 0.14155714285714285, AUC 0.4489500820636749
Test Epoch8 layer7 Acc 0.1332, AUC 0.5241218209266663
Test Epoch8 layer8 Acc 0.07144285714285714, AUC 0.39679551124572754
Test Epoch8 layer9 Acc 0.07142857142857142, AUC 0.47320356965065
gc 0
Train Epoch9 Acc 0.07142857142857142 (40000/560000), AUC 0.47451165318489075
Test Epoch9 layer0 Acc 0.9737285714285714, AUC 0.9982945322990417
Test Epoch9 layer1 Acc 0.9852428571428572, AUC 0.9975794553756714
Test Epoch9 layer2 Acc 0.9852714285714286, AUC 0.997162938117981
Test Epoch9 layer3 Acc 0.9853285714285714, AUC 0.9961919188499451
Test Epoch9 layer4 Acc 0.9853285714285714, AUC 0.9962552785873413
Test Epoch9 layer5 Acc 0.9853285714285714, AUC 0.9961498975753784
Test Epoch9 layer6 Acc 0.14161428571428572, AUC 0.44891807436943054
Test Epoch9 layer7 Acc 0.13504285714285713, AUC 0.5235529541969299
Test Epoch9 layer8 Acc 0.07148571428571429, AUC 0.3964552581310272
Test Epoch9 layer9 Acc 0.07142857142857142, AUC 0.47528260946273804
Best AUC 0.998475968837738
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask6//dbpedia_14/dbpedia_14_lstmal_l10_m6_prefix.pt
[[4683   43   23   15   12   74   43    7    4    7    5   21   19   44]
 [  38 4884    3    3    8    0   33    8    5    2    1    0    6    9]
 [  34   13 4606   22   50    1   11    4    6    0    1   84   24  144]
 [   1    2   25 4956   11    0    2    1    0    0    0    0    0    2]
 [  10   15   69   13 4858    8    8    2    2    1    0    0    3   11]
 [  33    1    3    4    1 4945    5    2    1    2    0    0    1    2]
 [  58   44    4    2   10   16 4806   38    9    5    1    1    4    2]
 [   0    1    0    0    2    0   14 4958   19    3    1    0    1    1]
 [   1    3    2    0    3    0   11   13 4967    0    0    0    0    0]
 [   1    0    0    2    1    0    0    6    0 4957   32    0    0    1]
 [  12    1    0    0    0    0    2    4    0   29 4952    0    0    0]
 [   4    0   38    2    0    0    1    0    0    0    0 4929   15   11]
 [   7    2   22    7    2    3    1    3    0    2    0   21 4886   44]
 [  29    5   77    8   12    4    4   10    1    6    3    7   46 4788]]
Figure(640x480)
[[4798   38   11    3   12   29   59    3    2    1    1    6    7   30]
 [  29 4925    0    0    6    1   31    1    1    1    0    0    2    3]
 [  13    3 4878   10   59    1    2    0    0    1    0   11    7   15]
 [   2    1   11 4968   13    0    0    0    0    1    0    1    2    1]
 [   4    4   69    8 4901    3    4    0    0    3    0    0    3    1]
 [  29    0    0    0    1 4957    5    2    1    1    0    0    2    2]
 [  49   25    1    0    1   10 4884   18    5    2    0    0    3    2]
 [   1    0    0    0    0    2   20 4967    6    3    0    0    0    1]
 [   2    0    1    0    1    0    7    7 4982    0    0    0    0    0]
 [   1    0    0    0    0    0    1    1    0 4976   21    0    0    0]
 [  14    1    0    0    0    0    1    1    0   21 4962    0    0    0]
 [   2    0    8    1    0    0    1    0    0    0    0 4970   13    5]
 [   4    0    3    0    0    1    1    0    0    0    0   17 4951   23]
 [  25    1   30    1    6    3    4    0    0    0    1    8   25 4896]]
Figure(640x480)
[[4793   38   11    3   12   29   64    3    2    1    1    6    7   30]
 [  28 4925    0    0    6    1   32    1    1    1    0    0    2    3]
 [  14    3 4882   10   55    1    2    0    0    0    1   11    6   15]
 [   1    1   13 4968   13    0    0    0    0    1    0    1    2    0]
 [   5    4   67    8 4902    4    4    0    0    2    0    0    3    1]
 [  29    0    0    0    1 4958    4    2    1    1    0    0    2    2]
 [  46   25    1    0    1   11 4885   18    6    2    0    0    3    2]
 [   1    0    0    0    0    1   19 4969    6    3    0    0    0    1]
 [   2    0    1    0    1    0    6    7 4983    0    0    0    0    0]
 [   1    0    0    0    0    0    1    1    0 4976   21    0    0    0]
 [  14    1    0    0    0    1    1    1    0   21 4961    0    0    0]
 [   2    0    7    1    0    0    1    0    0    0    0 4971   13    5]
 [   4    0    3    0    0    1    1    0    0    0    0   17 4951   23]
 [  24    2   29    1    6    4    4    0    0    0    1    8   26 4895]]
Figure(640x480)
[[4793   38   11    3   12   29   63    3    2    1    1    6    7   31]
 [  28 4925    0    0    6    1   32    1    1    1    0    0    2    3]
 [  13    3 4880   10   56    1    2    0    0    1    0   11    6   17]
 [   1    1   12 4968   14    0    0    0    0    1    0    1    2    0]
 [   4    4   66    8 4904    3    4    0    0    3    0    0    3    1]
 [  28    0    0    0    1 4960    3    2    1    1    0    0    2    2]
 [  48   25    1    0    1   11 4882   19    6    2    0    0    3    2]
 [   1    0    0    0    0    1   19 4967    8    3    0    0    0    1]
 [   2    0    1    0    1    0    6    7 4983    0    0    0    0    0]
 [   1    0    0    0    0    0    1    1    0 4976   21    0    0    0]
 [  14    1    0    0    0    1    1    1    0   22 4960    0    0    0]
 [   2    0    7    1    0    0    0    0    0    0    0 4972   13    5]
 [   4    0    3    0    0    1    1    0    0    0    0   17 4951   23]
 [  24    2   29    1    6    3    4    0    0    0    1    8   28 4894]]
Figure(640x480)
[[4785   39   11    3   12   30   68    3    2    2    1    6    7   31]
 [  28 4925    0    0    6    1   32    1    1    1    0    0    2    3]
 [  14    3 4882   10   56    1    2    0    0    0    1   11    6   14]
 [   1    1   12 4967   15    0    0    0    0    1    0    1    2    0]
 [   4    4   66    8 4903    5    4    0    0    2    0    0    3    1]
 [  28    0    0    0    1 4960    3    2    1    1    0    0    2    2]
 [  44   27    1    0    1   10 4885   19    6    2    0    0    3    2]
 [   1    0    0    0    0    1   19 4967    8    3    0    0    0    1]
 [   2    0    1    0    1    0    7    7 4982    0    0    0    0    0]
 [   1    0    0    0    0    0    1    1    0 4976   21    0    0    0]
 [  14    1    0    0    0    1    1    1    0   23 4959    0    0    0]
 [   2    0    7    1    0    0    0    0    0    0    0 4971   14    5]
 [   4    0    3    0    0    1    1    0    0    0    0   16 4952   23]
 [  24    3   30    1    6    3    4    0    0    0    1    8   28 4892]]
Figure(640x480)
[[4785   40   11    3   12   30   67    3    2    2    1    6    7   31]
 [  30 4927    0    0    5    1   30    0    1    1    0    0    2    3]
 [  12    3 4881   10   59    1    2    0    0    0    1   11    6   14]
 [   1    1   11 4966   16    1    0    0    0    1    0    1    2    0]
 [   4    4   61    8 4908    5    4    0    0    2    0    0    3    1]
 [  26    0    1    0    1 4959    6    2    1    0    0    0    2    2]
 [  45   28    1    0    1   10 4885   18    5    2    0    0    3    2]
 [   1    0    0    0    0    2   19 4964   10    3    0    0    0    1]
 [   2    0    1    0    1    0    7    7 4981    0    0    0    0    1]
 [   1    0    0    0    0    0    1    1    0 4976   21    0    0    0]
 [  14    1    0    0    0    1    1    1    0   21 4961    0    0    0]
 [   2    0    7    1    0    0    0    0    0    1    0 4969   15    5]
 [   5    0    3    0    0    1    1    0    0    0    0   16 4951   23]
 [  23    3   29    1    9    3    4    0    0    0    1    9   29 4889]]
Figure(640x480)
[[   0    0    0    0    0    0    0   10    0    0   98   42    0 4850]
 [   0    0    0    0    0    0    0    0    0    0   33 4920    0   47]
 [   0    0    0    0    0    0    0 4421    0    0   74  355    0  150]
 [   0    0    0    0    0    0    0    7  197    0 4776    1    0   19]
 [   0    0    0    0    0    0    0   53    0    0   19    6    0 4922]
 [   0    0    1    0    0    0    0    0    0    0   42    0    0 4957]
 [   0    0    4    0    0    0    0    0    2    0 4880   32    0   82]
 [   0    0 4210    0    0    0    0    0    0    0   31    0    0  759]
 [   0    0    1    0    0    0    0   10    0    0  174    0    0 4815]
 [   0    0    1    0    0    0    0    0    0    0 4997    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0 4984    1    0   15]
 [   0    0    0    0    0    0    0 4967    0    0   24    0    0    9]
 [   0    0    0    0    1    0    0   16    0    0 4947    7    0   29]
 [   0    0    0    0    1    0    0   14    0    0 4371  526    0   88]]
Figure(640x480)
[[   0    0    0    0   24    0    0    8 4909    0   19   40    0    0]
 [   0    0    0    0    3    0    0    7 3924    0    0 1066    0    0]
 [   0   13    0    0   30    0    0   22 4933    0    1    1    0    0]
 [   0    0    0    0    8    0    0 4921   70    0    0    1    0    0]
 [   0    0    0    0 4555    0    0   10  430    0    2    3    0    0]
 [   0    0    0    0    0    0    0    3   72    0 4885   40    0    0]
 [   0    8    0    0    3    0    0    6  189    0    7 4787    0    0]
 [   0    0    0    0    0    0    0 3444 1537    0    0   19    0    0]
 [   0    0    0    0    2    0    0    1 4993    0    0    4    0    0]
 [   0    0    0    0 3886    0    0    3 1111    0    0    0    0    0]
 [   0    0    0    0    4    0    0   50 4946    0    0    0    0    0]
 [   0   10    0    0 4929    0    0   11   50    0    0    0    0    0]
 [   0    0    0    0   33    0    0 4893   74    0    0    0    0    0]
 [   0    1    0    0 4522    0    0  393   80    0    2    2    0    0]]
Figure(640x480)
[[   0   22    0    0    0    0    0 4978    0    0    0    0    0    0]
 [   0    2    0    0    0    0    0 4998    0    0    0    0    0    0]
 [   0   34    0    0    0    0    0 4966    0    0    0    0    0    0]
 [   0   13    0    0    0    0    0 4987    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 4968    0    0    0   32    0    0]
 [   0    2    0    0    0    0    0 4998    0    0    0    0    0    0]
 [   0    0    0    0    0    0    0 5000    0    0    0    0    0    0]
 [   0    1    0    0    0    0    0 4999    0    0    0    0    0    0]
 [   0    5    0    0    0    0    0 4995    0    0    0    0    0    0]
 [   0    6    0    0    0    0    0 4966    0    0    0   28    0    0]
 [   0    2    0    0    0    0    0 4997    0    0    0    1    0    0]
 [   0   14    0    0    0    0    0 4986    0    0    0    0    0    0]
 [   0 4419    0    0    0    0    0  581    0    0    0    0    0    0]]
Figure(640x480)
[[   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]
 [   0    0    0    0    0    0    0    0    0    0    0 5000    0    0]]
Figure(640x480)
