total count words 222751
vocab size 30000
found 27937 words in glove
Load ckpt from ./ckpt/mask9//imdb/imdb_lstmal_l10_m9.pt
Start Training
gc 9
Train Epoch0 Acc 0.816475 (32659/40000), AUC 0.914508581161499
Test Epoch0 layer0 Acc 0.8888, AUC 0.9583188891410828
Test Epoch0 layer1 Acc 0.9041, AUC 0.9644607305526733
Test Epoch0 layer2 Acc 0.9041, AUC 0.9645604491233826
Test Epoch0 layer3 Acc 0.9041, AUC 0.9645403623580933
Test Epoch0 layer4 Acc 0.9041, AUC 0.964308500289917
Test Epoch0 layer5 Acc 0.9042, AUC 0.9642749428749084
Test Epoch0 layer6 Acc 0.9037, AUC 0.9641536474227905
Test Epoch0 layer7 Acc 0.9036, AUC 0.9640324711799622
Test Epoch0 layer8 Acc 0.9034, AUC 0.9639068841934204
Test Epoch0 layer9 Acc 0.9017, AUC 0.9637711048126221
Save ckpt to ./ckpt/mask10//imdb/imdb_lstmal_l10_m10.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.90885 (36354/40000), AUC 0.9648330211639404
Test Epoch1 layer0 Acc 0.8888, AUC 0.9583188891410828
Test Epoch1 layer1 Acc 0.9041, AUC 0.9644607305526733
Test Epoch1 layer2 Acc 0.9041, AUC 0.9645604491233826
Test Epoch1 layer3 Acc 0.9041, AUC 0.9645403623580933
Test Epoch1 layer4 Acc 0.9041, AUC 0.964308500289917
Test Epoch1 layer5 Acc 0.9042, AUC 0.9642749428749084
Test Epoch1 layer6 Acc 0.9037, AUC 0.9641536474227905
Test Epoch1 layer7 Acc 0.9036, AUC 0.9640324711799622
Test Epoch1 layer8 Acc 0.9034, AUC 0.9639068841934204
Test Epoch1 layer9 Acc 0.9026, AUC 0.9639259576797485
Save ckpt to ./ckpt/mask10//imdb/imdb_lstmal_l10_m10.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.90905 (36362/40000), AUC 0.9653491973876953
Test Epoch2 layer0 Acc 0.8888, AUC 0.9583188891410828
Test Epoch2 layer1 Acc 0.9041, AUC 0.9644607305526733
Test Epoch2 layer2 Acc 0.9041, AUC 0.9645604491233826
Test Epoch2 layer3 Acc 0.9041, AUC 0.9645403623580933
Test Epoch2 layer4 Acc 0.9041, AUC 0.964308500289917
Test Epoch2 layer5 Acc 0.9042, AUC 0.9642749428749084
Test Epoch2 layer6 Acc 0.9037, AUC 0.9641536474227905
Test Epoch2 layer7 Acc 0.9036, AUC 0.9640324711799622
Test Epoch2 layer8 Acc 0.9034, AUC 0.9639068841934204
Test Epoch2 layer9 Acc 0.9034, AUC 0.9639608263969421
Save ckpt to ./ckpt/mask10//imdb/imdb_lstmal_l10_m10.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.909525 (36381/40000), AUC 0.9651193022727966
Test Epoch3 layer0 Acc 0.8888, AUC 0.9583188891410828
Test Epoch3 layer1 Acc 0.9041, AUC 0.9644607305526733
Test Epoch3 layer2 Acc 0.9041, AUC 0.9645604491233826
Test Epoch3 layer3 Acc 0.9041, AUC 0.9645403623580933
Test Epoch3 layer4 Acc 0.9041, AUC 0.964308500289917
Test Epoch3 layer5 Acc 0.9042, AUC 0.9642749428749084
Test Epoch3 layer6 Acc 0.9037, AUC 0.9641536474227905
Test Epoch3 layer7 Acc 0.9036, AUC 0.9640324711799622
Test Epoch3 layer8 Acc 0.9034, AUC 0.9639068841934204
Test Epoch3 layer9 Acc 0.9029, AUC 0.963956356048584
gc 0
Train Epoch4 Acc 0.90995 (36398/40000), AUC 0.9652315378189087
Test Epoch4 layer0 Acc 0.8888, AUC 0.9583188891410828
Test Epoch4 layer1 Acc 0.9041, AUC 0.9644607305526733
Test Epoch4 layer2 Acc 0.9041, AUC 0.9645604491233826
Test Epoch4 layer3 Acc 0.9041, AUC 0.9645403623580933
Test Epoch4 layer4 Acc 0.9041, AUC 0.964308500289917
Test Epoch4 layer5 Acc 0.9042, AUC 0.9642749428749084
Test Epoch4 layer6 Acc 0.9037, AUC 0.9641536474227905
Test Epoch4 layer7 Acc 0.9036, AUC 0.9640324711799622
Test Epoch4 layer8 Acc 0.9034, AUC 0.9639068841934204
Test Epoch4 layer9 Acc 0.9028, AUC 0.9639469385147095
gc 0
Train Epoch5 Acc 0.910175 (36407/40000), AUC 0.9654519557952881
Test Epoch5 layer0 Acc 0.8888, AUC 0.9583188891410828
Test Epoch5 layer1 Acc 0.9041, AUC 0.9644607305526733
Test Epoch5 layer2 Acc 0.9041, AUC 0.9645604491233826
Test Epoch5 layer3 Acc 0.9041, AUC 0.9645403623580933
Test Epoch5 layer4 Acc 0.9041, AUC 0.964308500289917
Test Epoch5 layer5 Acc 0.9042, AUC 0.9642749428749084
Test Epoch5 layer6 Acc 0.9037, AUC 0.9641536474227905
Test Epoch5 layer7 Acc 0.9036, AUC 0.9640324711799622
Test Epoch5 layer8 Acc 0.9034, AUC 0.9639068841934204
Test Epoch5 layer9 Acc 0.9037, AUC 0.963930606842041
gc 0
Train Epoch6 Acc 0.91035 (36414/40000), AUC 0.9656378030776978
Test Epoch6 layer0 Acc 0.8888, AUC 0.9583188891410828
Test Epoch6 layer1 Acc 0.9041, AUC 0.9644607305526733
Test Epoch6 layer2 Acc 0.9041, AUC 0.9645604491233826
Test Epoch6 layer3 Acc 0.9041, AUC 0.9645403623580933
Test Epoch6 layer4 Acc 0.9041, AUC 0.964308500289917
Test Epoch6 layer5 Acc 0.9042, AUC 0.9642749428749084
Test Epoch6 layer6 Acc 0.9037, AUC 0.9641536474227905
Test Epoch6 layer7 Acc 0.9036, AUC 0.9640324711799622
Test Epoch6 layer8 Acc 0.9034, AUC 0.9639068841934204
Test Epoch6 layer9 Acc 0.9034, AUC 0.9639177322387695
gc 0
Train Epoch7 Acc 0.91045 (36418/40000), AUC 0.9657692909240723
Test Epoch7 layer0 Acc 0.8888, AUC 0.9583188891410828
Test Epoch7 layer1 Acc 0.9041, AUC 0.9644607305526733
Test Epoch7 layer2 Acc 0.9041, AUC 0.9645604491233826
Test Epoch7 layer3 Acc 0.9041, AUC 0.9645403623580933
Test Epoch7 layer4 Acc 0.9041, AUC 0.964308500289917
Test Epoch7 layer5 Acc 0.9042, AUC 0.9642749428749084
Test Epoch7 layer6 Acc 0.9037, AUC 0.9641536474227905
Test Epoch7 layer7 Acc 0.9036, AUC 0.9640324711799622
Test Epoch7 layer8 Acc 0.9034, AUC 0.9639068841934204
Test Epoch7 layer9 Acc 0.903, AUC 0.9639061093330383
gc 0
Train Epoch8 Acc 0.91035 (36414/40000), AUC 0.9657401442527771
Test Epoch8 layer0 Acc 0.8888, AUC 0.9583188891410828
Test Epoch8 layer1 Acc 0.9041, AUC 0.9644607305526733
Test Epoch8 layer2 Acc 0.9041, AUC 0.9645604491233826
Test Epoch8 layer3 Acc 0.9041, AUC 0.9645403623580933
Test Epoch8 layer4 Acc 0.9041, AUC 0.964308500289917
Test Epoch8 layer5 Acc 0.9042, AUC 0.9642749428749084
Test Epoch8 layer6 Acc 0.9037, AUC 0.9641536474227905
Test Epoch8 layer7 Acc 0.9036, AUC 0.9640324711799622
Test Epoch8 layer8 Acc 0.9034, AUC 0.9639068841934204
Test Epoch8 layer9 Acc 0.9038, AUC 0.9638933539390564
gc 0
Train Epoch9 Acc 0.910875 (36435/40000), AUC 0.9658246040344238
Test Epoch9 layer0 Acc 0.8888, AUC 0.9583188891410828
Test Epoch9 layer1 Acc 0.9041, AUC 0.9644607305526733
Test Epoch9 layer2 Acc 0.9041, AUC 0.9645604491233826
Test Epoch9 layer3 Acc 0.9041, AUC 0.9645403623580933
Test Epoch9 layer4 Acc 0.9041, AUC 0.964308500289917
Test Epoch9 layer5 Acc 0.9042, AUC 0.9642749428749084
Test Epoch9 layer6 Acc 0.9037, AUC 0.9641536474227905
Test Epoch9 layer7 Acc 0.9036, AUC 0.9640324711799622
Test Epoch9 layer8 Acc 0.9034, AUC 0.9639068841934204
Test Epoch9 layer9 Acc 0.9034, AUC 0.9638886451721191
Best AUC 0.9639608263969421
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask10//imdb/imdb_lstmal_l10_m10.pt
[[4627  405]
 [ 707 4261]]
Figure(640x480)
[[4544  488]
 [ 471 4497]]
Figure(640x480)
[[4559  473]
 [ 486 4482]]
Figure(640x480)
[[4557  475]
 [ 484 4484]]
Figure(640x480)
[[4510  522]
 [ 437 4531]]
Figure(640x480)
[[4523  509]
 [ 449 4519]]
Figure(640x480)
[[4495  537]
 [ 426 4542]]
Figure(640x480)
[[4549  483]
 [ 481 4487]]
Figure(640x480)
[[4569  463]
 [ 503 4465]]
Figure(640x480)
[[4571  461]
 [ 505 4463]]
Figure(640x480)
