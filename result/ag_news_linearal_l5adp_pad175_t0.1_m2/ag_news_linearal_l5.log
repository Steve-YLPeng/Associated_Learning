total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad175_t0.1_m1//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1}
gc 9
Train Epoch0 Acc 0.25001666666666666 (30002/120000), AUC 0.6407496929168701
ep0_train_time 9.158928155899048
Test Epoch0 threshold 0.1 Acc 0.915296052631579, AUC 0.9808359742164612, avg_entr 0.027863843366503716
ep0_t0.1_test_time 0.2648632526397705
Save ckpt to ckpt/ag_news_linearal_l5adp_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2501833333333333 (30022/120000), AUC 0.7962218523025513
ep1_train_time 8.67454195022583
Test Epoch1 threshold 0.1 Acc 0.9161184210526315, AUC 0.9806344509124756, avg_entr 0.025610120967030525
ep1_t0.1_test_time 0.2636549472808838
gc 0
Train Epoch2 Acc 0.2504 (30048/120000), AUC 0.8058541417121887
ep2_train_time 8.57075023651123
Test Epoch2 threshold 0.1 Acc 0.9151315789473684, AUC 0.9807024598121643, avg_entr 0.025950690731406212
ep2_t0.1_test_time 0.2633049488067627
gc 0
Train Epoch3 Acc 0.25066666666666665 (30080/120000), AUC 0.8061709403991699
ep3_train_time 8.503915548324585
Test Epoch3 threshold 0.1 Acc 0.9125, AUC 0.9805804491043091, avg_entr 0.024994373321533203
ep3_t0.1_test_time 0.26309990882873535
gc 0
Train Epoch4 Acc 0.25095833333333334 (30115/120000), AUC 0.8072789907455444
ep4_train_time 8.615865230560303
Test Epoch4 threshold 0.1 Acc 0.9129934210526316, AUC 0.9805903434753418, avg_entr 0.0253701563924551
ep4_t0.1_test_time 0.26322126388549805
gc 0
Train Epoch5 Acc 0.25121666666666664 (30146/120000), AUC 0.8076236248016357
ep5_train_time 8.636945486068726
Test Epoch5 threshold 0.1 Acc 0.9149671052631579, AUC 0.980311930179596, avg_entr 0.0255102701485157
ep5_t0.1_test_time 0.2622556686401367
gc 0
Train Epoch6 Acc 0.2514166666666667 (30170/120000), AUC 0.8081569671630859
ep6_train_time 8.684679508209229
Test Epoch6 threshold 0.1 Acc 0.9143092105263158, AUC 0.9801751971244812, avg_entr 0.02637142688035965
ep6_t0.1_test_time 0.26334404945373535
gc 0
Train Epoch7 Acc 0.25164166666666665 (30197/120000), AUC 0.808814287185669
ep7_train_time 8.669365167617798
Test Epoch7 threshold 0.1 Acc 0.9144736842105263, AUC 0.9800640344619751, avg_entr 0.025545164942741394
ep7_t0.1_test_time 0.26299309730529785
gc 0
Train Epoch8 Acc 0.25211666666666666 (30254/120000), AUC 0.809288501739502
ep8_train_time 8.598458290100098
Test Epoch8 threshold 0.1 Acc 0.9143092105263158, AUC 0.9800137281417847, avg_entr 0.025773582980036736
ep8_t0.1_test_time 0.26252079010009766
gc 0
Train Epoch9 Acc 0.2523916666666667 (30287/120000), AUC 0.8094344139099121
ep9_train_time 8.617625951766968
Test Epoch9 threshold 0.1 Acc 0.912828947368421, AUC 0.9799501895904541, avg_entr 0.026145631447434425
ep9_t0.1_test_time 0.2632143497467041
Best AUC 0.9808359742164612
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad175_t0.1_m2//ag_news_linearal_l5_prefix.pt
Test threshold 0.1 Acc 0.9236842105263158, AUC 0.9864184260368347, avg_entr 0.028546128422021866
t0.1_test_time 0.0664205551147461
