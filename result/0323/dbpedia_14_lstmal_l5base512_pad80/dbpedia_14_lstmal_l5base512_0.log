total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 57.952181855999996
Start Training
gc 0
Train Epoch0 Acc 0.7093267857142858 (397223/560000), AUC 0.9339898824691772
ep0_train_time 431.570024162
Test Epoch0 layer4 Acc 0.9763142857142857, AUC 0.997087299823761, avg_entr 0.2389758676290512, f1 0.9763143062591553
ep0_l4_test_time 7.3086434570000165
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9811053571428572 (549419/560000), AUC 0.9969663619995117
ep1_train_time 439.93632898799996
Test Epoch1 layer4 Acc 0.9815714285714285, AUC 0.9971970319747925, avg_entr 0.06550537049770355, f1 0.9815714359283447
ep1_l4_test_time 7.253858950999984
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9842517857142857 (551181/560000), AUC 0.9974619746208191
ep2_train_time 430.88297257600004
Test Epoch2 layer4 Acc 0.983, AUC 0.9972526431083679, avg_entr 0.03094836138188839, f1 0.9829999804496765
ep2_l4_test_time 7.417158827999856
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9858571428571429 (552080/560000), AUC 0.9977506995201111
ep3_train_time 439.7712562260001
Test Epoch3 layer4 Acc 0.9839428571428571, AUC 0.9972604513168335, avg_entr 0.01710396446287632, f1 0.9839428663253784
ep3_l4_test_time 7.422627155999862
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9869553571428571 (552695/560000), AUC 0.9979512095451355
ep4_train_time 439.7546544049999
Test Epoch4 layer4 Acc 0.9842, AUC 0.9971186518669128, avg_entr 0.010815315879881382, f1 0.9842000007629395
ep4_l4_test_time 7.421767740999712
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9877946428571428 (553165/560000), AUC 0.998135507106781
ep5_train_time 440.18162088400004
Test Epoch5 layer4 Acc 0.9843428571428572, AUC 0.9973450303077698, avg_entr 0.007309999316930771, f1 0.9843428730964661
ep5_l4_test_time 7.426842220999788
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9885053571428571 (553563/560000), AUC 0.9982522130012512
ep6_train_time 434.4401255309999
Test Epoch6 layer4 Acc 0.9846571428571429, AUC 0.9974653124809265, avg_entr 0.004964632447808981, f1 0.9846571683883667
ep6_l4_test_time 5.11675384199998
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9891410714285714 (553919/560000), AUC 0.9983517527580261
ep7_train_time 436.19563440400043
Test Epoch7 layer4 Acc 0.9849142857142857, AUC 0.99737548828125, avg_entr 0.003973634447902441, f1 0.9849143028259277
ep7_l4_test_time 7.41690223500018
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.989675 (554218/560000), AUC 0.998466432094574
ep8_train_time 441.3123615579998
Test Epoch8 layer4 Acc 0.9854857142857143, AUC 0.9974572062492371, avg_entr 0.003391979029402137, f1 0.9854857325553894
ep8_l4_test_time 7.387637646999792
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9901892857142857 (554506/560000), AUC 0.9985151290893555
ep9_train_time 441.29129436699986
Test Epoch9 layer4 Acc 0.9853714285714286, AUC 0.997495174407959, avg_entr 0.0026516809593886137, f1 0.9853714108467102
ep9_l4_test_time 7.291082544000346
gc 0
Train Epoch10 Acc 0.9907267857142857 (554807/560000), AUC 0.998600423336029
ep10_train_time 441.58652933900066
Test Epoch10 layer4 Acc 0.9852857142857143, AUC 0.9975331425666809, avg_entr 0.0025428207591176033, f1 0.9852856993675232
ep10_l4_test_time 7.5168544560001465
gc 0
Train Epoch11 Acc 0.99115 (555044/560000), AUC 0.9986511468887329
ep11_train_time 439.6584964899994
Test Epoch11 layer4 Acc 0.9851428571428571, AUC 0.9975390434265137, avg_entr 0.0022023762576282024, f1 0.9851428866386414
ep11_l4_test_time 5.049510060999637
gc 0
Train Epoch12 Acc 0.9915482142857143 (555267/560000), AUC 0.9987087845802307
ep12_train_time 436.4247372740001
Test Epoch12 layer4 Acc 0.9853428571428572, AUC 0.9974785447120667, avg_entr 0.0018703456735238433, f1 0.9853428602218628
ep12_l4_test_time 7.410347273000298
gc 0
Train Epoch13 Acc 0.9919982142857143 (555519/560000), AUC 0.9987525343894958
ep13_train_time 441.36158648999935
Test Epoch13 layer4 Acc 0.9851714285714286, AUC 0.9974669218063354, avg_entr 0.0018319442169740796, f1 0.9851714372634888
ep13_l4_test_time 7.418768937000095
gc 0
Train Epoch14 Acc 0.9923910714285714 (555739/560000), AUC 0.9988112449645996
ep14_train_time 441.49023918500006
Test Epoch14 layer4 Acc 0.9851142857142857, AUC 0.9974511861801147, avg_entr 0.0015924161998555064, f1 0.9851142764091492
ep14_l4_test_time 7.376965257999473
gc 0
Train Epoch15 Acc 0.9927071428571429 (555916/560000), AUC 0.9988093972206116
ep15_train_time 441.3690474389996
Test Epoch15 layer4 Acc 0.9857142857142858, AUC 0.9973991513252258, avg_entr 0.00135110504925251, f1 0.9857142567634583
ep15_l4_test_time 7.431733140000688
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.9930571428571429 (556112/560000), AUC 0.9988635182380676
ep16_train_time 438.0222242559994
Test Epoch16 layer4 Acc 0.9856571428571429, AUC 0.9974245429039001, avg_entr 0.001300922012887895, f1 0.9856571555137634
ep16_l4_test_time 5.0085436769995795
gc 0
Train Epoch17 Acc 0.9934714285714286 (556344/560000), AUC 0.9988722801208496
ep17_train_time 438.60343888399984
Test Epoch17 layer4 Acc 0.9854285714285714, AUC 0.997322142124176, avg_entr 0.0012330231256783009, f1 0.9854285717010498
ep17_l4_test_time 7.269252152000263
gc 0
Train Epoch18 Acc 0.9937285714285714 (556488/560000), AUC 0.9988900423049927
ep18_train_time 441.71896346599897
Test Epoch18 layer4 Acc 0.9850857142857142, AUC 0.9972182512283325, avg_entr 0.0012457252014428377, f1 0.9850857257843018
ep18_l4_test_time 7.276648222001313
gc 0
Train Epoch19 Acc 0.9940553571428571 (556671/560000), AUC 0.9989250898361206
ep19_train_time 441.8984842259997
Test Epoch19 layer4 Acc 0.9851714285714286, AUC 0.997188150882721, avg_entr 0.0013215524377301335, f1 0.9851714372634888
ep19_l4_test_time 7.317072820000249
Best AUC tensor(0.9857) 15
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 8919.89833967
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9742571428571428, AUC 0.9982745051383972, avg_entr 0.02692864090204239, f1 0.9742571711540222
l0_test_time 1.4947157770002377
gc 0
Test layer1 Acc 0.9854857142857143, AUC 0.9987477660179138, avg_entr 0.0022264940198510885, f1 0.9854857325553894
l1_test_time 2.454880138999215
gc 0
Test layer2 Acc 0.9859428571428571, AUC 0.9985471367835999, avg_entr 0.001640050089918077, f1 0.9859428405761719
l2_test_time 4.054861886001163
gc 0
Test layer3 Acc 0.9856857142857143, AUC 0.9982089996337891, avg_entr 0.0015509807271882892, f1 0.9856857061386108
l3_test_time 5.737891819000652
gc 0
Test layer4 Acc 0.9857714285714285, AUC 0.9978018999099731, avg_entr 0.0014078235253691673, f1 0.9857714176177979
l4_test_time 7.284284854998987
gc 0
Test threshold 0.1 Acc 0.9788285714285714, AUC 0.9982138872146606, avg_entr 0.004293466452509165, f1 0.9788285493850708
t0.1_test_time 5.081908903001022
gc 0
Test threshold 0.2 Acc 0.9751428571428571, AUC 0.9982483983039856, avg_entr 0.009478192776441574, f1 0.9751428365707397
t0.2_test_time 3.9469866560011724
gc 0
Test threshold 0.3 Acc 0.9742571428571428, AUC 0.9982752203941345, avg_entr 0.010184271261096, f1 0.9742571711540222
t0.3_test_time 3.1387178269997094
gc 0
Test threshold 0.4 Acc 0.9742571428571428, AUC 0.9982745051383972, avg_entr 0.010203885845839977, f1 0.9742571711540222
t0.4_test_time 3.0519270910008345
gc 0
Test threshold 0.5 Acc 0.9742571428571428, AUC 0.9982745051383972, avg_entr 0.010203885845839977, f1 0.9742571711540222
t0.5_test_time 3.1419239040005777
gc 0
Test threshold 0.6 Acc 0.9742571428571428, AUC 0.9982745051383972, avg_entr 0.010203885845839977, f1 0.9742571711540222
t0.6_test_time 3.044427065000491
gc 0
Test threshold 0.7 Acc 0.9742571428571428, AUC 0.9982745051383972, avg_entr 0.010203885845839977, f1 0.9742571711540222
t0.7_test_time 3.0288416860003053
gc 0
Test threshold 0.8 Acc 0.9742571428571428, AUC 0.9982745051383972, avg_entr 0.010203885845839977, f1 0.9742571711540222
t0.8_test_time 3.0189653630004614
gc 0
Test threshold 0.9 Acc 0.9742571428571428, AUC 0.9982745051383972, avg_entr 0.010203885845839977, f1 0.9742571711540222
t0.9_test_time 3.0038512800001627
