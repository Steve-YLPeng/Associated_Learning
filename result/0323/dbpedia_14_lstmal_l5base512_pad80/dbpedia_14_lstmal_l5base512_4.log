total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 57.172392056
Start Training
gc 0
Train Epoch0 Acc 0.7279928571428571 (407676/560000), AUC 0.9351714849472046
ep0_train_time 336.615465563
Test Epoch0 layer4 Acc 0.9762, AUC 0.9976456761360168, avg_entr 0.21677695214748383, f1 0.9761999845504761
ep0_l4_test_time 5.983111898999994
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.98115 (549444/560000), AUC 0.9974313378334045
ep1_train_time 339.83607700199997
Test Epoch1 layer4 Acc 0.9812, AUC 0.9977708458900452, avg_entr 0.06977476179599762, f1 0.9811999797821045
ep1_l4_test_time 5.888499711000009
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9841964285714285 (551150/560000), AUC 0.9978686571121216
ep2_train_time 337.11669440000003
Test Epoch2 layer4 Acc 0.9828571428571429, AUC 0.9977380633354187, avg_entr 0.03236716613173485, f1 0.9828571677207947
ep2_l4_test_time 5.703779145999988
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9857517857142857 (552021/560000), AUC 0.9981042146682739
ep3_train_time 335.264697176
Test Epoch3 layer4 Acc 0.9835142857142857, AUC 0.9977769255638123, avg_entr 0.017829343676567078, f1 0.9835143089294434
ep3_l4_test_time 5.666978311999856
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9869053571428571 (552667/560000), AUC 0.9982905983924866
ep4_train_time 338.429473786
Test Epoch4 layer4 Acc 0.9841714285714286, AUC 0.9976731538772583, avg_entr 0.010769214481115341, f1 0.984171450138092
ep4_l4_test_time 5.926854953999964
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9877017857142857 (553113/560000), AUC 0.9984238743782043
ep5_train_time 337.6413886669998
Test Epoch5 layer4 Acc 0.9846285714285714, AUC 0.9975367784500122, avg_entr 0.006851069629192352, f1 0.9846285581588745
ep5_l4_test_time 5.669691857000089
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9883464285714286 (553474/560000), AUC 0.9984938502311707
ep6_train_time 336.4147247720002
Test Epoch6 layer4 Acc 0.9848, AUC 0.997618556022644, avg_entr 0.005066240672022104, f1 0.9847999811172485
ep6_l4_test_time 5.455632312000034
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9890089285714285 (553845/560000), AUC 0.9985283613204956
ep7_train_time 338.6356691830001
Test Epoch7 layer4 Acc 0.9852, AUC 0.9977626800537109, avg_entr 0.003961213398724794, f1 0.9851999878883362
ep7_l4_test_time 5.8126470600000175
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9896410714285714 (554199/560000), AUC 0.9986313581466675
ep8_train_time 338.12210935899975
Test Epoch8 layer4 Acc 0.9852285714285715, AUC 0.997580349445343, avg_entr 0.0031867350917309523, f1 0.9852285981178284
ep8_l4_test_time 5.68769271300016
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9901339285714286 (554475/560000), AUC 0.9986934065818787
ep9_train_time 332.36956752100014
Test Epoch9 layer4 Acc 0.9850285714285715, AUC 0.9974148869514465, avg_entr 0.002789959777146578, f1 0.9850285649299622
ep9_l4_test_time 5.751075143999969
gc 0
Train Epoch10 Acc 0.9906035714285715 (554738/560000), AUC 0.9986922144889832
ep10_train_time 334.9799262790002
Test Epoch10 layer4 Acc 0.9852, AUC 0.9976896047592163, avg_entr 0.002309095347300172, f1 0.9851999878883362
ep10_l4_test_time 5.565306782999869
gc 0
Train Epoch11 Acc 0.9911464285714285 (555042/560000), AUC 0.9987431764602661
ep11_train_time 339.16444562200013
Test Epoch11 layer4 Acc 0.9854857142857143, AUC 0.9974918365478516, avg_entr 0.0021734959445893764, f1 0.9854857325553894
ep11_l4_test_time 5.952540214000692
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9914839285714285 (555231/560000), AUC 0.9987826347351074
ep12_train_time 337.0086143420003
Test Epoch12 layer4 Acc 0.9854857142857143, AUC 0.9974275827407837, avg_entr 0.0018981791799888015, f1 0.9854857325553894
ep12_l4_test_time 5.727937401999952
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.9919589285714285 (555497/560000), AUC 0.9988387823104858
ep13_train_time 336.2899018240005
Test Epoch13 layer4 Acc 0.9859142857142857, AUC 0.9974790811538696, avg_entr 0.0016398091102018952, f1 0.9859142899513245
ep13_l4_test_time 5.373695338999823
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.9923392857142858 (555710/560000), AUC 0.998851478099823
ep14_train_time 339.3684794360006
Test Epoch14 layer4 Acc 0.9853714285714286, AUC 0.9973096251487732, avg_entr 0.001330282655544579, f1 0.9853714108467102
ep14_l4_test_time 5.844526920000135
gc 0
Train Epoch15 Acc 0.9926767857142857 (555899/560000), AUC 0.9988527894020081
ep15_train_time 337.72548274699966
Test Epoch15 layer4 Acc 0.9857142857142858, AUC 0.9975125193595886, avg_entr 0.001363378600217402, f1 0.9857142567634583
ep15_l4_test_time 5.7458703960001
gc 0
Train Epoch16 Acc 0.99315 (556164/560000), AUC 0.9989005327224731
ep16_train_time 335.92644167900016
Test Epoch16 layer4 Acc 0.9855428571428572, AUC 0.9973607063293457, avg_entr 0.0013866673689335585, f1 0.9855428338050842
ep16_l4_test_time 5.7022483559994726
gc 0
Train Epoch17 Acc 0.9934196428571429 (556315/560000), AUC 0.998934268951416
ep17_train_time 336.2455656989996
Test Epoch17 layer4 Acc 0.9856857142857143, AUC 0.9972705245018005, avg_entr 0.0014053081395104527, f1 0.9856857061386108
ep17_l4_test_time 5.978158646000338
gc 0
Train Epoch18 Acc 0.9937517857142857 (556501/560000), AUC 0.9989487528800964
ep18_train_time 338.4483027749993
Test Epoch18 layer4 Acc 0.9852857142857143, AUC 0.9969582557678223, avg_entr 0.0013429219834506512, f1 0.9852856993675232
ep18_l4_test_time 5.872611390000202
gc 0
Train Epoch19 Acc 0.9941839285714286 (556743/560000), AUC 0.9989531636238098
ep19_train_time 335.53354290100015
Test Epoch19 layer4 Acc 0.9851428571428571, AUC 0.9970906376838684, avg_entr 0.001448949915356934, f1 0.9851428866386414
ep19_l4_test_time 5.776965174999532
Best AUC tensor(0.9859) 13
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 6858.320354836001
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9743142857142857, AUC 0.9983072280883789, avg_entr 0.029254376888275146, f1 0.974314272403717
l0_test_time 1.226044615000319
gc 0
Test layer1 Acc 0.9860857142857142, AUC 0.9988375902175903, avg_entr 0.0027336052153259516, f1 0.9860857129096985
l1_test_time 2.2266021380000893
gc 0
Test layer2 Acc 0.9862857142857143, AUC 0.9986468553543091, avg_entr 0.0019570172298699617, f1 0.9862856268882751
l2_test_time 3.3815733720002754
gc 0
Test layer3 Acc 0.9862285714285715, AUC 0.9981232285499573, avg_entr 0.0018087386852130294, f1 0.9862285852432251
l3_test_time 4.47117595599957
gc 0
Test layer4 Acc 0.9862857142857143, AUC 0.9979678392410278, avg_entr 0.0017914378549903631, f1 0.9862856268882751
l4_test_time 5.724061193000125
gc 0
Test threshold 0.1 Acc 0.9793428571428572, AUC 0.9982867240905762, avg_entr 0.004685875494033098, f1 0.9793428778648376
t0.1_test_time 2.883135379000123
gc 0
Test threshold 0.2 Acc 0.9754285714285714, AUC 0.9982877373695374, avg_entr 0.010287409648299217, f1 0.975428581237793
t0.2_test_time 2.3527542629999516
gc 0
Test threshold 0.3 Acc 0.9743428571428572, AUC 0.9983081817626953, avg_entr 0.01105424202978611, f1 0.9743428826332092
t0.3_test_time 2.1266378230002374
gc 0
Test threshold 0.4 Acc 0.9743142857142857, AUC 0.9983072280883789, avg_entr 0.011085161939263344, f1 0.974314272403717
t0.4_test_time 1.994209408999268
gc 0
Test threshold 0.5 Acc 0.9743142857142857, AUC 0.9983072280883789, avg_entr 0.011085161939263344, f1 0.974314272403717
t0.5_test_time 1.9782330979996914
gc 0
Test threshold 0.6 Acc 0.9743142857142857, AUC 0.9983072280883789, avg_entr 0.011085161939263344, f1 0.974314272403717
t0.6_test_time 1.9490069210005458
gc 0
Test threshold 0.7 Acc 0.9743142857142857, AUC 0.9983072280883789, avg_entr 0.011085161939263344, f1 0.974314272403717
t0.7_test_time 2.056331499999942
gc 0
Test threshold 0.8 Acc 0.9743142857142857, AUC 0.9983072280883789, avg_entr 0.011085161939263344, f1 0.974314272403717
t0.8_test_time 1.9983334309999918
gc 0
Test threshold 0.9 Acc 0.9743142857142857, AUC 0.9983072280883789, avg_entr 0.011085161939263344, f1 0.974314272403717
t0.9_test_time 1.954161016999933
