total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 59.337994084
Start Training
gc 0
Train Epoch0 Acc 0.7068303571428571 (395825/560000), AUC 0.9240816831588745
ep0_train_time 432.53700222599997
Test Epoch0 layer4 Acc 0.9761714285714286, AUC 0.9967139959335327, avg_entr 0.2231011986732483, f1 0.9761714339256287
ep0_l4_test_time 7.379820628999994
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9809821428571428 (549350/560000), AUC 0.9969977736473083
ep1_train_time 442.48055696599994
Test Epoch1 layer4 Acc 0.9812571428571428, AUC 0.9972005486488342, avg_entr 0.0694158747792244, f1 0.9812571406364441
ep1_l4_test_time 7.282196935000002
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9841321428571429 (551114/560000), AUC 0.9974756836891174
ep2_train_time 442.17640234400005
Test Epoch2 layer4 Acc 0.9825714285714285, AUC 0.9972151517868042, avg_entr 0.03194650635123253, f1 0.9825714230537415
ep2_l4_test_time 7.298046209999939
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9857089285714286 (551997/560000), AUC 0.9977383613586426
ep3_train_time 442.14181115299994
Test Epoch3 layer4 Acc 0.9834571428571428, AUC 0.9972273707389832, avg_entr 0.017407212406396866, f1 0.9834571480751038
ep3_l4_test_time 7.4013848399999915
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9867160714285714 (552561/560000), AUC 0.997920572757721
ep4_train_time 442.24115571599987
Test Epoch4 layer4 Acc 0.9838857142857143, AUC 0.9971699714660645, avg_entr 0.010654937475919724, f1 0.9838857054710388
ep4_l4_test_time 7.445642960999976
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9876821428571428 (553102/560000), AUC 0.9980524778366089
ep5_train_time 432.67847396299976
Test Epoch5 layer4 Acc 0.9845714285714285, AUC 0.9972596764564514, avg_entr 0.007060259114950895, f1 0.9845714569091797
ep5_l4_test_time 7.468551653000304
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9883517857142857 (553477/560000), AUC 0.9981399774551392
ep6_train_time 442.3527422000002
Test Epoch6 layer4 Acc 0.9846857142857143, AUC 0.9973710775375366, avg_entr 0.00485105300322175, f1 0.9846857190132141
ep6_l4_test_time 7.351171132000218
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9889857142857142 (553832/560000), AUC 0.9981747269630432
ep7_train_time 427.7927479120003
Test Epoch7 layer4 Acc 0.9849142857142857, AUC 0.9974990487098694, avg_entr 0.004013753030449152, f1 0.9849143028259277
ep7_l4_test_time 7.304854931000136
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9895696428571429 (554159/560000), AUC 0.9982801079750061
ep8_train_time 430.90124484299986
Test Epoch8 layer4 Acc 0.985, AUC 0.9973760843276978, avg_entr 0.0031020366586744785, f1 0.9850000143051147
ep8_l4_test_time 7.312064078999811
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9900696428571428 (554439/560000), AUC 0.9983505606651306
ep9_train_time 420.6632490339998
Test Epoch9 layer4 Acc 0.9853714285714286, AUC 0.9974836707115173, avg_entr 0.0027854954823851585, f1 0.9853714108467102
ep9_l4_test_time 6.999557954000011
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9905321428571429 (554698/560000), AUC 0.9984248280525208
ep10_train_time 431.57046799900036
Test Epoch10 layer4 Acc 0.9851142857142857, AUC 0.9976255297660828, avg_entr 0.0023844207171350718, f1 0.9851142764091492
ep10_l4_test_time 7.163718656999663
gc 0
Train Epoch11 Acc 0.99105 (554988/560000), AUC 0.9984620213508606
ep11_train_time 431.3324445979997
Test Epoch11 layer4 Acc 0.9855142857142857, AUC 0.9975760579109192, avg_entr 0.0022235121577978134, f1 0.9855142831802368
ep11_l4_test_time 7.257554967000033
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9915089285714286 (555245/560000), AUC 0.9985159039497375
ep12_train_time 430.8544771950001
Test Epoch12 layer4 Acc 0.9852571428571428, AUC 0.9973450303077698, avg_entr 0.0019008370582014322, f1 0.9852571487426758
ep12_l4_test_time 7.253177921000315
gc 0
Train Epoch13 Acc 0.9919178571428572 (555474/560000), AUC 0.9985522031784058
ep13_train_time 430.75466939000034
Test Epoch13 layer4 Acc 0.9852571428571428, AUC 0.997350811958313, avg_entr 0.0017400865908712149, f1 0.9852571487426758
ep13_l4_test_time 7.266235684999629
gc 0
Train Epoch14 Acc 0.9922946428571429 (555685/560000), AUC 0.9986075758934021
ep14_train_time 420.035253989
Test Epoch14 layer4 Acc 0.9853428571428572, AUC 0.9972926378250122, avg_entr 0.001526577747426927, f1 0.9853428602218628
ep14_l4_test_time 7.292782324000655
gc 0
Train Epoch15 Acc 0.9926857142857143 (555904/560000), AUC 0.9986391663551331
ep15_train_time 430.7622896720004
Test Epoch15 layer4 Acc 0.9854, AUC 0.9972807168960571, avg_entr 0.001534266397356987, f1 0.9854000210762024
ep15_l4_test_time 7.249510160999307
gc 0
Train Epoch16 Acc 0.9931214285714286 (556148/560000), AUC 0.99864262342453
ep16_train_time 430.7607304000003
Test Epoch16 layer4 Acc 0.9850285714285715, AUC 0.997348964214325, avg_entr 0.001422474510036409, f1 0.9850285649299622
ep16_l4_test_time 7.243546247999802
gc 0
Train Epoch17 Acc 0.9934017857142857 (556305/560000), AUC 0.9987041354179382
ep17_train_time 430.88993472199945
Test Epoch17 layer4 Acc 0.9854285714285714, AUC 0.9970816373825073, avg_entr 0.0013535864418372512, f1 0.9854285717010498
ep17_l4_test_time 7.290671690000636
gc 0
Train Epoch18 Acc 0.9937535714285715 (556502/560000), AUC 0.9987253546714783
ep18_train_time 431.7775230490006
Test Epoch18 layer4 Acc 0.9852857142857143, AUC 0.9971192479133606, avg_entr 0.0013612168841063976, f1 0.9852856993675232
ep18_l4_test_time 7.024435331999484
gc 0
Train Epoch19 Acc 0.9940696428571428 (556679/560000), AUC 0.9987542033195496
ep19_train_time 416.25008239899944
Test Epoch19 layer4 Acc 0.9850285714285715, AUC 0.997261106967926, avg_entr 0.001337120309472084, f1 0.9850285649299622
ep19_l4_test_time 7.204327231998832
Best AUC tensor(0.9855) 11
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 8788.486275889
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt
gc 10
Test layer0 Acc 0.974, AUC 0.9982595443725586, avg_entr 0.03286734223365784, f1 0.9739999771118164
l0_test_time 1.4833156610002334
gc 0
Test layer1 Acc 0.9855142857142857, AUC 0.9988020658493042, avg_entr 0.003175010671839118, f1 0.9855142831802368
l1_test_time 2.5659442659998604
gc 0
Test layer2 Acc 0.9857714285714285, AUC 0.9987079501152039, avg_entr 0.0024392155464738607, f1 0.9857714176177979
l2_test_time 2.776767313000164
gc 0
Test layer3 Acc 0.9857142857142858, AUC 0.998317539691925, avg_entr 0.0023303173948079348, f1 0.9857142567634583
l3_test_time 3.4239344959987648
gc 0
Test layer4 Acc 0.9859142857142857, AUC 0.9980228543281555, avg_entr 0.002267539734020829, f1 0.9859142899513245
l4_test_time 4.63880051399974
gc 0
Test threshold 0.1 Acc 0.9790571428571428, AUC 0.9982227683067322, avg_entr 0.005317130591720343, f1 0.9790571331977844
t0.1_test_time 1.8025527330009936
gc 0
Test threshold 0.2 Acc 0.9754, AUC 0.9982677102088928, avg_entr 0.01155827846378088, f1 0.9753999710083008
t0.2_test_time 1.4952562320013385
gc 0
Test threshold 0.3 Acc 0.974, AUC 0.9982596635818481, avg_entr 0.01244531199336052, f1 0.9739999771118164
t0.3_test_time 2.023261973999979
gc 0
Test threshold 0.4 Acc 0.974, AUC 0.9982595443725586, avg_entr 0.0124541986733675, f1 0.9739999771118164
t0.4_test_time 2.019246892999945
gc 0
Test threshold 0.5 Acc 0.974, AUC 0.9982595443725586, avg_entr 0.0124541986733675, f1 0.9739999771118164
t0.5_test_time 1.9225403700002062
gc 0
Test threshold 0.6 Acc 0.974, AUC 0.9982595443725586, avg_entr 0.0124541986733675, f1 0.9739999771118164
t0.6_test_time 1.8633529469989298
gc 0
Test threshold 0.7 Acc 0.974, AUC 0.9982595443725586, avg_entr 0.0124541986733675, f1 0.9739999771118164
t0.7_test_time 1.8690785679991677
gc 0
Test threshold 0.8 Acc 0.974, AUC 0.9982595443725586, avg_entr 0.0124541986733675, f1 0.9739999771118164
t0.8_test_time 2.0706622340003378
gc 0
Test threshold 0.9 Acc 0.974, AUC 0.9982595443725586, avg_entr 0.0124541986733675, f1 0.9739999771118164
t0.9_test_time 2.0844090780010447
