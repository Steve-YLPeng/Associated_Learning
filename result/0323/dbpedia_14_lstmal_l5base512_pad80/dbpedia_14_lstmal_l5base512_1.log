total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 60.062650585
Start Training
gc 0
Train Epoch0 Acc 0.7113553571428571 (398359/560000), AUC 0.930151104927063
ep0_train_time 441.19412774
Test Epoch0 layer4 Acc 0.9762571428571428, AUC 0.9970157742500305, avg_entr 0.21691347658634186, f1 0.9762571454048157
ep0_l4_test_time 7.453658057999974
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9809678571428572 (549342/560000), AUC 0.9970038533210754
ep1_train_time 440.750905349
Test Epoch1 layer4 Acc 0.9815428571428572, AUC 0.9971319437026978, avg_entr 0.06389681994915009, f1 0.9815428853034973
ep1_l4_test_time 7.366605098000036
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9841625 (551131/560000), AUC 0.9973825812339783
ep2_train_time 440.71800345500003
Test Epoch2 layer4 Acc 0.9829142857142857, AUC 0.9971926808357239, avg_entr 0.03057301975786686, f1 0.9829142689704895
ep2_l4_test_time 7.4160673209999
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9858428571428571 (552072/560000), AUC 0.9976120591163635
ep3_train_time 422.7663305570002
Test Epoch3 layer4 Acc 0.9838857142857143, AUC 0.9972934722900391, avg_entr 0.016453560441732407, f1 0.9838857054710388
ep3_l4_test_time 7.393287812999915
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9867535714285715 (552582/560000), AUC 0.9977999925613403
ep4_train_time 440.408786877
Test Epoch4 layer4 Acc 0.9842857142857143, AUC 0.9972286224365234, avg_entr 0.010119397193193436, f1 0.9842857122421265
ep4_l4_test_time 7.48789363800006
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.987725 (553126/560000), AUC 0.9979631304740906
ep5_train_time 440.7691795830001
Test Epoch5 layer4 Acc 0.9845428571428572, AUC 0.9972470998764038, avg_entr 0.0066633145324885845, f1 0.9845428466796875
ep5_l4_test_time 7.419375289000072
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9884410714285714 (553527/560000), AUC 0.9981017112731934
ep6_train_time 441.18845099400005
Test Epoch6 layer4 Acc 0.9842571428571428, AUC 0.9973863959312439, avg_entr 0.004879082553088665, f1 0.984257161617279
ep6_l4_test_time 7.473692800000208
gc 0
Train Epoch7 Acc 0.9890375 (553861/560000), AUC 0.9982267022132874
ep7_train_time 440.84308267000006
Test Epoch7 layer4 Acc 0.9849714285714286, AUC 0.9974133372306824, avg_entr 0.0037500611506402493, f1 0.9849714040756226
ep7_l4_test_time 7.435151682999731
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9895142857142857 (554128/560000), AUC 0.9983640313148499
ep8_train_time 431.0151898559998
Test Epoch8 layer4 Acc 0.9846285714285714, AUC 0.9975696802139282, avg_entr 0.003031804459169507, f1 0.9846285581588745
ep8_l4_test_time 7.454236345000027
gc 0
Train Epoch9 Acc 0.9900446428571429 (554425/560000), AUC 0.9984441995620728
ep9_train_time 440.87962345000005
Test Epoch9 layer4 Acc 0.9852571428571428, AUC 0.9972656965255737, avg_entr 0.0023374941665679216, f1 0.9852571487426758
ep9_l4_test_time 7.468750406000254
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9905232142857143 (554693/560000), AUC 0.9984890222549438
ep10_train_time 440.74990234599954
Test Epoch10 layer4 Acc 0.9851428571428571, AUC 0.9975194334983826, avg_entr 0.0021520531736314297, f1 0.9851428866386414
ep10_l4_test_time 7.458721580999736
gc 0
Train Epoch11 Acc 0.9908982142857143 (554903/560000), AUC 0.9985650777816772
ep11_train_time 440.8120350930003
Test Epoch11 layer4 Acc 0.9852285714285715, AUC 0.9973982572555542, avg_entr 0.0018061529844999313, f1 0.9852285981178284
ep11_l4_test_time 7.485464192999643
gc 0
Train Epoch12 Acc 0.9914232142857143 (555197/560000), AUC 0.9986105561256409
ep12_train_time 441.0185341329998
Test Epoch12 layer4 Acc 0.9852571428571428, AUC 0.9975941777229309, avg_entr 0.0019221054390072823, f1 0.9852571487426758
ep12_l4_test_time 7.339834866999809
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.9917678571428571 (555390/560000), AUC 0.9986701011657715
ep13_train_time 427.3618835740008
Test Epoch13 layer4 Acc 0.9854857142857143, AUC 0.9974448084831238, avg_entr 0.0016802786849439144, f1 0.9854857325553894
ep13_l4_test_time 7.5024285520003104
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.9922 (555632/560000), AUC 0.9986810684204102
ep14_train_time 442.78281994700046
Test Epoch14 layer4 Acc 0.9854, AUC 0.997346818447113, avg_entr 0.001838994910940528, f1 0.9854000210762024
ep14_l4_test_time 7.488336686999901
gc 0
Train Epoch15 Acc 0.9926107142857142 (555862/560000), AUC 0.998736560344696
ep15_train_time 442.5482724880003
Test Epoch15 layer4 Acc 0.9856285714285714, AUC 0.9972389936447144, avg_entr 0.0014137987745925784, f1 0.9856285452842712
ep15_l4_test_time 7.464976231000037
Save ckpt to ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.9929285714285714 (556040/560000), AUC 0.9987722635269165
ep16_train_time 442.43608831799975
Test Epoch16 layer4 Acc 0.9852571428571428, AUC 0.9974377751350403, avg_entr 0.0015560557367280126, f1 0.9852571487426758
ep16_l4_test_time 7.4385774719994515
gc 0
Train Epoch17 Acc 0.9932892857142858 (556242/560000), AUC 0.9987936019897461
ep17_train_time 442.1021045389998
Test Epoch17 layer4 Acc 0.9847428571428571, AUC 0.997195303440094, avg_entr 0.001268260646611452, f1 0.9847428798675537
ep17_l4_test_time 7.4381316769995465
gc 0
Train Epoch18 Acc 0.9936428571428572 (556440/560000), AUC 0.9988213181495667
ep18_train_time 432.9370055040008
Test Epoch18 layer4 Acc 0.9854285714285714, AUC 0.9972891807556152, avg_entr 0.0011496096849441528, f1 0.9854285717010498
ep18_l4_test_time 7.368816609998248
gc 0
Train Epoch19 Acc 0.9939214285714286 (556596/560000), AUC 0.9988497495651245
ep19_train_time 441.90621804500006
Test Epoch19 layer4 Acc 0.9855142857142857, AUC 0.9972130656242371, avg_entr 0.0012125850189477205, f1 0.9855142831802368
ep19_l4_test_time 7.368151466998825
Best AUC tensor(0.9856) 15
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 8925.855684187001
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base512_pad80//dbpedia_14_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9743714285714286, AUC 0.9982749819755554, avg_entr 0.026820708066225052, f1 0.9743714332580566
l0_test_time 1.4973577190012293
gc 0
Test layer1 Acc 0.9856857142857143, AUC 0.9984990954399109, avg_entr 0.002394062699750066, f1 0.9856857061386108
l1_test_time 2.7390752430001157
gc 0
Test layer2 Acc 0.9856857142857143, AUC 0.9982934594154358, avg_entr 0.0018469314090907574, f1 0.9856857061386108
l2_test_time 4.0633809470000415
gc 0
Test layer3 Acc 0.9857428571428571, AUC 0.9977235794067383, avg_entr 0.0016153838951140642, f1 0.9857428669929504
l3_test_time 5.7338240219996806
gc 0
Test layer4 Acc 0.9857428571428571, AUC 0.9976087808609009, avg_entr 0.0014477885561063886, f1 0.9857428669929504
l4_test_time 7.310827376999441
gc 0
Test threshold 0.1 Acc 0.9788285714285714, AUC 0.9982478022575378, avg_entr 0.004321115557104349, f1 0.9788285493850708
t0.1_test_time 5.159431998999935
gc 0
Test threshold 0.2 Acc 0.9752857142857143, AUC 0.9982457756996155, avg_entr 0.009393693879246712, f1 0.9752857089042664
t0.2_test_time 4.239175692000572
gc 0
Test threshold 0.3 Acc 0.9744, AUC 0.9982756972312927, avg_entr 0.010144910775125027, f1 0.974399983882904
t0.3_test_time 3.1103039640001953
gc 0
Test threshold 0.4 Acc 0.9743714285714286, AUC 0.9982749819755554, avg_entr 0.010162988677620888, f1 0.9743714332580566
t0.4_test_time 2.894878183000401
gc 0
Test threshold 0.5 Acc 0.9743714285714286, AUC 0.9982749819755554, avg_entr 0.010162988677620888, f1 0.9743714332580566
t0.5_test_time 2.8914968499993847
gc 0
Test threshold 0.6 Acc 0.9743714285714286, AUC 0.9982749819755554, avg_entr 0.010162988677620888, f1 0.9743714332580566
t0.6_test_time 3.065866389000803
gc 0
Test threshold 0.7 Acc 0.9743714285714286, AUC 0.9982749819755554, avg_entr 0.010162988677620888, f1 0.9743714332580566
t0.7_test_time 2.959022342998651
gc 0
Test threshold 0.8 Acc 0.9743714285714286, AUC 0.9982749819755554, avg_entr 0.010162988677620888, f1 0.9743714332580566
t0.8_test_time 3.0047280640010285
gc 0
Test threshold 0.9 Acc 0.9743714285714286, AUC 0.9982749819755554, avg_entr 0.010162988677620888, f1 0.9743714332580566
t0.9_test_time 3.0622356599997147
