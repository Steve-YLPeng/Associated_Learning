total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 54.955789617
Start Training
gc 0
Train Epoch0 Acc 0.8224107142857143 (460550/560000), AUC 0.9739699363708496
ep0_train_time 237.754208508
Test Epoch0 layer4 Acc 0.9787714285714286, AUC 0.997139036655426, avg_entr 0.07024651020765305, f1 0.978771448135376
ep0_l4_test_time 3.0915235539999912
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9834017857142857 (550705/560000), AUC 0.9972689747810364
ep1_train_time 237.50306901699997
Test Epoch1 layer4 Acc 0.9829142857142857, AUC 0.9973167777061462, avg_entr 0.018388602882623672, f1 0.9829142689704895
ep1_l4_test_time 3.9937595800000736
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9859660714285714 (552141/560000), AUC 0.9978082776069641
ep2_train_time 242.230340995
Test Epoch2 layer4 Acc 0.9839428571428571, AUC 0.997444748878479, avg_entr 0.007098283153027296, f1 0.9839428663253784
ep2_l4_test_time 4.098543147999976
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9873642857142857 (552924/560000), AUC 0.9980529546737671
ep3_train_time 240.82365560300002
Test Epoch3 layer4 Acc 0.9845428571428572, AUC 0.9975693821907043, avg_entr 0.004090288653969765, f1 0.9845428466796875
ep3_l4_test_time 4.068373307000002
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9884410714285714 (553527/560000), AUC 0.9982176423072815
ep4_train_time 241.36711548799985
Test Epoch4 layer4 Acc 0.9848, AUC 0.9974783658981323, avg_entr 0.002627640264108777, f1 0.9847999811172485
ep4_l4_test_time 4.037764776999893
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9891714285714286 (553936/560000), AUC 0.9984098076820374
ep5_train_time 234.6751147939999
Test Epoch5 layer4 Acc 0.9848857142857143, AUC 0.997739315032959, avg_entr 0.002314267447218299, f1 0.9848856925964355
ep5_l4_test_time 3.304280365000068
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9898089285714285 (554293/560000), AUC 0.9984927773475647
ep6_train_time 238.59880078699985
Test Epoch6 layer4 Acc 0.9854857142857143, AUC 0.9976382255554199, avg_entr 0.0019398239674046636, f1 0.9854857325553894
ep6_l4_test_time 4.055554725000093
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9905160714285715 (554689/560000), AUC 0.9985437393188477
ep7_train_time 240.73767365499998
Test Epoch7 layer4 Acc 0.9856571428571429, AUC 0.9975390434265137, avg_entr 0.0014545347075909376, f1 0.9856571555137634
ep7_l4_test_time 4.0328618860000915
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9911982142857143 (555071/560000), AUC 0.9986128807067871
ep8_train_time 241.68033331900006
Test Epoch8 layer4 Acc 0.9856285714285714, AUC 0.9974881410598755, avg_entr 0.0016240602126345038, f1 0.9856285452842712
ep8_l4_test_time 4.1011702310001965
gc 0
Train Epoch9 Acc 0.9917107142857143 (555358/560000), AUC 0.9986899495124817
ep9_train_time 240.4832354690002
Test Epoch9 layer4 Acc 0.9858, AUC 0.9975132942199707, avg_entr 0.0014980612322688103, f1 0.98580002784729
ep9_l4_test_time 4.036894939999911
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9923160714285715 (555697/560000), AUC 0.9987218976020813
ep10_train_time 234.82235458499963
Test Epoch10 layer4 Acc 0.9849142857142857, AUC 0.9971746802330017, avg_entr 0.0014504558639600873, f1 0.9849143028259277
ep10_l4_test_time 3.908520082999985
gc 0
Train Epoch11 Acc 0.9928107142857143 (555974/560000), AUC 0.9987448453903198
ep11_train_time 238.52923871600024
Test Epoch11 layer4 Acc 0.9858285714285714, AUC 0.9973817467689514, avg_entr 0.001278407289646566, f1 0.9858285784721375
ep11_l4_test_time 4.016243596000095
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9932928571428571 (556244/560000), AUC 0.9987984299659729
ep12_train_time 241.82572909700002
Test Epoch12 layer4 Acc 0.9856857142857143, AUC 0.997287929058075, avg_entr 0.0011869077570736408, f1 0.9856857061386108
ep12_l4_test_time 4.067052302999855
gc 0
Train Epoch13 Acc 0.9937642857142858 (556508/560000), AUC 0.9987878799438477
ep13_train_time 240.5470972180001
Test Epoch13 layer4 Acc 0.9858571428571429, AUC 0.9972500801086426, avg_entr 0.001105473143979907, f1 0.9858571290969849
ep13_l4_test_time 4.012719947000278
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.9940571428571429 (556672/560000), AUC 0.9988210797309875
ep14_train_time 241.37744252200036
Test Epoch14 layer4 Acc 0.9852571428571428, AUC 0.9969329833984375, avg_entr 0.0011355989845469594, f1 0.9852571487426758
ep14_l4_test_time 3.8661930369999027
gc 0
Train Epoch15 Acc 0.9944553571428572 (556895/560000), AUC 0.99885094165802
ep15_train_time 233.86684611700002
Test Epoch15 layer4 Acc 0.9860285714285715, AUC 0.9969058632850647, avg_entr 0.0009211070719175041, f1 0.9860285520553589
ep15_l4_test_time 3.914705617999971
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.9948303571428572 (557105/560000), AUC 0.9988587498664856
ep16_train_time 239.00672130500016
Test Epoch16 layer4 Acc 0.9856857142857143, AUC 0.9966978430747986, avg_entr 0.0009637298644520342, f1 0.9856857061386108
ep16_l4_test_time 4.031883546000245
gc 0
Train Epoch17 Acc 0.9952017857142857 (557313/560000), AUC 0.9988671541213989
ep17_train_time 240.89011547500013
Test Epoch17 layer4 Acc 0.9855428571428572, AUC 0.9966029524803162, avg_entr 0.0010498114861547947, f1 0.9855428338050842
ep17_l4_test_time 4.024666321000041
gc 0
Train Epoch18 Acc 0.9954571428571428 (557456/560000), AUC 0.998870849609375
ep18_train_time 241.63332498199998
Test Epoch18 layer4 Acc 0.9851714285714286, AUC 0.9963175654411316, avg_entr 0.0009613180882297456, f1 0.9851714372634888
ep18_l4_test_time 4.105739851999715
gc 0
Train Epoch19 Acc 0.9957571428571429 (557624/560000), AUC 0.9988846778869629
ep19_train_time 240.57601773399983
Test Epoch19 layer4 Acc 0.9856, AUC 0.9963609576225281, avg_entr 0.0009213567245751619, f1 0.9855999946594238
ep19_l4_test_time 4.061016856999231
Best AUC tensor(0.9860) 15
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 4869.980857116
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9738857142857142, AUC 0.9983542561531067, avg_entr 0.023640761151909828, f1 0.973885715007782
l0_test_time 1.0288282530000288
gc 0
Test layer1 Acc 0.9863142857142857, AUC 0.9984967112541199, avg_entr 0.0017209317302331328, f1 0.9863142967224121
l1_test_time 1.5007604129996253
gc 0
Test layer2 Acc 0.9865714285714285, AUC 0.9982596039772034, avg_entr 0.0012558650923892856, f1 0.9865714311599731
l2_test_time 2.108088963999762
gc 0
Test layer3 Acc 0.9865428571428572, AUC 0.9982942342758179, avg_entr 0.0011544069275259972, f1 0.9865428805351257
l3_test_time 2.792323568000029
gc 0
Test layer4 Acc 0.9865428571428572, AUC 0.9976025223731995, avg_entr 0.001103496178984642, f1 0.9865428805351257
l4_test_time 3.489098230000309
gc 0
Test threshold 0.1 Acc 0.9773142857142857, AUC 0.9982808232307434, avg_entr 0.0038054012693464756, f1 0.977314293384552
t0.1_test_time 1.3004375259997687
gc 0
Test threshold 0.2 Acc 0.9746571428571429, AUC 0.9983569383621216, avg_entr 0.008568167686462402, f1 0.9746571183204651
t0.2_test_time 1.0781868880003458
gc 0
Test threshold 0.3 Acc 0.9738857142857142, AUC 0.9983542561531067, avg_entr 0.008958033286035061, f1 0.973885715007782
t0.3_test_time 1.0350792300005196
gc 0
Test threshold 0.4 Acc 0.9738857142857142, AUC 0.9983542561531067, avg_entr 0.008958033286035061, f1 0.973885715007782
t0.4_test_time 0.9916214459999537
gc 0
Test threshold 0.5 Acc 0.9738857142857142, AUC 0.9983542561531067, avg_entr 0.008958033286035061, f1 0.973885715007782
t0.5_test_time 0.9929270900001939
gc 0
Test threshold 0.6 Acc 0.9738857142857142, AUC 0.9983542561531067, avg_entr 0.008958033286035061, f1 0.973885715007782
t0.6_test_time 1.0347896909997871
gc 0
Test threshold 0.7 Acc 0.9738857142857142, AUC 0.9983542561531067, avg_entr 0.008958033286035061, f1 0.973885715007782
t0.7_test_time 0.9173763859998871
gc 0
Test threshold 0.8 Acc 0.9738857142857142, AUC 0.9983542561531067, avg_entr 0.008958033286035061, f1 0.973885715007782
t0.8_test_time 0.8511037600001146
gc 0
Test threshold 0.9 Acc 0.9738857142857142, AUC 0.9983542561531067, avg_entr 0.008958033286035061, f1 0.973885715007782
t0.9_test_time 0.8610257169993929
