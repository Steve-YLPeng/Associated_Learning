total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 55.641238521
Start Training
gc 0
Train Epoch0 Acc 0.8480517857142857 (474909/560000), AUC 0.9776349663734436
ep0_train_time 237.12158214700003
Test Epoch0 layer4 Acc 0.9799714285714286, AUC 0.9970015287399292, avg_entr 0.08570793271064758, f1 0.9799714088439941
ep0_l4_test_time 3.189565703000028
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9837089285714286 (550877/560000), AUC 0.9973811507225037
ep1_train_time 239.66130132400002
Test Epoch1 layer4 Acc 0.9824285714285714, AUC 0.9970878958702087, avg_entr 0.02192245051264763, f1 0.9824285507202148
ep1_l4_test_time 4.093490805999977
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9860535714285714 (552190/560000), AUC 0.9979067444801331
ep2_train_time 241.530021327
Test Epoch2 layer4 Acc 0.9842285714285715, AUC 0.9975895285606384, avg_entr 0.009086718782782555, f1 0.9842285513877869
ep2_l4_test_time 4.036679338999988
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9873339285714285 (552907/560000), AUC 0.9982661604881287
ep3_train_time 242.19047772500005
Test Epoch3 layer4 Acc 0.9843142857142857, AUC 0.9977310299873352, avg_entr 0.004618629813194275, f1 0.9843142628669739
ep3_l4_test_time 4.082867007999994
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9883410714285714 (553471/560000), AUC 0.9984961152076721
ep4_train_time 241.00042394399998
Test Epoch4 layer4 Acc 0.9848, AUC 0.9980973601341248, avg_entr 0.003489590948447585, f1 0.9847999811172485
ep4_l4_test_time 3.4602428220000547
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9892285714285715 (553968/560000), AUC 0.998644232749939
ep5_train_time 235.86371209900017
Test Epoch5 layer4 Acc 0.9842857142857143, AUC 0.9979594945907593, avg_entr 0.0023493042681366205, f1 0.9842857122421265
ep5_l4_test_time 3.9573003540001537
gc 0
Train Epoch6 Acc 0.9900535714285714 (554430/560000), AUC 0.9987508654594421
ep6_train_time 239.66009212199992
Test Epoch6 layer4 Acc 0.9848857142857143, AUC 0.9981985092163086, avg_entr 0.0022800355218350887, f1 0.9848856925964355
ep6_l4_test_time 4.096801182000036
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9907053571428571 (554795/560000), AUC 0.9988053441047668
ep7_train_time 242.1707093330001
Test Epoch7 layer4 Acc 0.9848857142857143, AUC 0.998068630695343, avg_entr 0.0017101883422583342, f1 0.9848856925964355
ep7_l4_test_time 4.068151684999975
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9913625 (555163/560000), AUC 0.9988893866539001
ep8_train_time 241.0666503729999
Test Epoch8 layer4 Acc 0.9855428571428572, AUC 0.9980904459953308, avg_entr 0.001671994454227388, f1 0.9855428338050842
ep8_l4_test_time 4.11182798200025
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9918946428571429 (555461/560000), AUC 0.9990111589431763
ep9_train_time 240.131720848
Test Epoch9 layer4 Acc 0.9853142857142857, AUC 0.9980863928794861, avg_entr 0.0017238045111298561, f1 0.9853143095970154
ep9_l4_test_time 3.5049921300001188
gc 0
Train Epoch10 Acc 0.9924589285714286 (555777/560000), AUC 0.9990639090538025
ep10_train_time 236.27587208800014
Test Epoch10 layer4 Acc 0.9856285714285714, AUC 0.9980236887931824, avg_entr 0.0013284552842378616, f1 0.9856285452842712
ep10_l4_test_time 3.978605454999979
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9930160714285714 (556089/560000), AUC 0.9991465210914612
ep11_train_time 241.24878050300003
Test Epoch11 layer4 Acc 0.985, AUC 0.9980553984642029, avg_entr 0.0012014862149953842, f1 0.9850000143051147
ep11_l4_test_time 4.07278975600002
gc 0
Train Epoch12 Acc 0.9933803571428571 (556293/560000), AUC 0.9991689324378967
ep12_train_time 241.02111417900005
Test Epoch12 layer4 Acc 0.9854, AUC 0.9980559945106506, avg_entr 0.0013430542312562466, f1 0.9854000210762024
ep12_l4_test_time 4.024945502000264
gc 0
Train Epoch13 Acc 0.9939089285714285 (556589/560000), AUC 0.9992087483406067
ep13_train_time 241.8540934120001
Test Epoch13 layer4 Acc 0.9852857142857143, AUC 0.9979192018508911, avg_entr 0.0012014132225885987, f1 0.9852856993675232
ep13_l4_test_time 4.092665077999754
gc 0
Train Epoch14 Acc 0.994275 (556794/560000), AUC 0.9992294907569885
ep14_train_time 238.02493163000008
Test Epoch14 layer4 Acc 0.9848, AUC 0.998047411441803, avg_entr 0.0010737839620560408, f1 0.9847999811172485
ep14_l4_test_time 3.248167629999898
gc 0
Train Epoch15 Acc 0.9946910714285714 (557027/560000), AUC 0.9992356300354004
ep15_train_time 237.7130198699997
Test Epoch15 layer4 Acc 0.9856, AUC 0.9979875683784485, avg_entr 0.0009762253030203283, f1 0.9855999946594238
ep15_l4_test_time 3.892312985999979
gc 0
Train Epoch16 Acc 0.9949642857142857 (557180/560000), AUC 0.999267041683197
ep16_train_time 241.5415500809995
Test Epoch16 layer4 Acc 0.9848571428571429, AUC 0.9978055953979492, avg_entr 0.0010407844092696905, f1 0.9848571419715881
ep16_l4_test_time 4.0469896109998444
gc 0
Train Epoch17 Acc 0.9953446428571429 (557393/560000), AUC 0.9992834329605103
ep17_train_time 242.21222873599982
Test Epoch17 layer4 Acc 0.9852, AUC 0.9976598024368286, avg_entr 0.0009333177004009485, f1 0.9851999878883362
ep17_l4_test_time 4.02451046600072
gc 0
Train Epoch18 Acc 0.9955910714285714 (557531/560000), AUC 0.9993009567260742
ep18_train_time 241.1560882040003
Test Epoch18 layer4 Acc 0.9847142857142858, AUC 0.9975345730781555, avg_entr 0.0008793728775344789, f1 0.9847142696380615
ep18_l4_test_time 4.127470303999871
gc 0
Train Epoch19 Acc 0.9958928571428571 (557700/560000), AUC 0.999310314655304
ep19_train_time 200.42169771699992
Test Epoch19 layer4 Acc 0.9854571428571428, AUC 0.9974685907363892, avg_entr 0.0007668468169867992, f1 0.9854571223258972
ep19_l4_test_time 3.116848755000319
Best AUC tensor(0.9856) 10
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 4841.270325606
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9742, AUC 0.9983397126197815, avg_entr 0.024951690807938576, f1 0.9742000102996826
l0_test_time 0.8337132790002215
gc 0
Test layer1 Acc 0.9860571428571429, AUC 0.998582661151886, avg_entr 0.0022559610661119223, f1 0.9860571622848511
l1_test_time 1.2966642359997422
gc 0
Test layer2 Acc 0.9861142857142857, AUC 0.9983700513839722, avg_entr 0.0017128787003457546, f1 0.9861142635345459
l2_test_time 1.901559324000118
gc 0
Test layer3 Acc 0.9862285714285715, AUC 0.9980201721191406, avg_entr 0.0016789650544524193, f1 0.9862285852432251
l3_test_time 2.4909020230006718
gc 0
Test layer4 Acc 0.9862571428571428, AUC 0.9980769753456116, avg_entr 0.0015480895526707172, f1 0.9862571358680725
l4_test_time 3.0806445369998983
gc 0
Test threshold 0.1 Acc 0.9781714285714286, AUC 0.9982748031616211, avg_entr 0.004016149323433638, f1 0.9781714081764221
t0.1_test_time 1.088290075000259
gc 0
Test threshold 0.2 Acc 0.9748, AUC 0.9983328580856323, avg_entr 0.009015538729727268, f1 0.9747999906539917
t0.2_test_time 0.9206924990003245
gc 0
Test threshold 0.3 Acc 0.9742, AUC 0.9983401298522949, avg_entr 0.009446102194488049, f1 0.9742000102996826
t0.3_test_time 0.8556376730002739
gc 0
Test threshold 0.4 Acc 0.9742, AUC 0.9983397126197815, avg_entr 0.009454773738980293, f1 0.9742000102996826
t0.4_test_time 0.8622480079993693
gc 0
Test threshold 0.5 Acc 0.9742, AUC 0.9983397126197815, avg_entr 0.009454773738980293, f1 0.9742000102996826
t0.5_test_time 0.8620452209997893
gc 0
Test threshold 0.6 Acc 0.9742, AUC 0.9983397126197815, avg_entr 0.009454773738980293, f1 0.9742000102996826
t0.6_test_time 0.8518454860004567
gc 0
Test threshold 0.7 Acc 0.9742, AUC 0.9983397126197815, avg_entr 0.009454773738980293, f1 0.9742000102996826
t0.7_test_time 0.8557904669996788
gc 0
Test threshold 0.8 Acc 0.9742, AUC 0.9983397126197815, avg_entr 0.009454773738980293, f1 0.9742000102996826
t0.8_test_time 0.8459994799995911
gc 0
Test threshold 0.9 Acc 0.9742, AUC 0.9983397126197815, avg_entr 0.009454773738980293, f1 0.9742000102996826
t0.9_test_time 0.848046938999687
