total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 54.451047407000004
Start Training
gc 0
Train Epoch0 Acc 0.8449696428571428 (473183/560000), AUC 0.9775828719139099
ep0_train_time 191.360685042
Test Epoch0 layer4 Acc 0.9796857142857143, AUC 0.9971722364425659, avg_entr 0.08115846663713455, f1 0.9796857237815857
ep0_l4_test_time 3.0490643350000255
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9832410714285714 (550615/560000), AUC 0.9971407651901245
ep1_train_time 190.38434567399997
Test Epoch1 layer4 Acc 0.9826285714285714, AUC 0.9971945881843567, avg_entr 0.020513568073511124, f1 0.982628583908081
ep1_l4_test_time 3.07375934800001
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9857589285714285 (552025/560000), AUC 0.9976359009742737
ep2_train_time 190.44092221700004
Test Epoch2 layer4 Acc 0.9843714285714286, AUC 0.9973959922790527, avg_entr 0.008280927315354347, f1 0.9843714237213135
ep2_l4_test_time 3.104197456999941
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9871178571428572 (552786/560000), AUC 0.9979448318481445
ep3_train_time 190.35022151400005
Test Epoch3 layer4 Acc 0.9838571428571429, AUC 0.9975391030311584, avg_entr 0.0045628235675394535, f1 0.9838571548461914
ep3_l4_test_time 3.064187655000069
gc 0
Train Epoch4 Acc 0.988175 (553378/560000), AUC 0.9982286095619202
ep4_train_time 190.06432620299995
Test Epoch4 layer4 Acc 0.9849142857142857, AUC 0.9973872900009155, avg_entr 0.002900690073147416, f1 0.9849143028259277
ep4_l4_test_time 3.0624828580000667
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9891875 (553945/560000), AUC 0.998318076133728
ep5_train_time 190.16068351900003
Test Epoch5 layer4 Acc 0.985, AUC 0.9975959658622742, avg_entr 0.00213936367072165, f1 0.9850000143051147
ep5_l4_test_time 3.0609428200000366
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9899107142857143 (554350/560000), AUC 0.9984374046325684
ep6_train_time 190.2500256029998
Test Epoch6 layer4 Acc 0.9855428571428572, AUC 0.9974669218063354, avg_entr 0.0019315643003210425, f1 0.9855428338050842
ep6_l4_test_time 3.057802905000017
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9905714285714285 (554720/560000), AUC 0.9985210299491882
ep7_train_time 190.7529933039998
Test Epoch7 layer4 Acc 0.9857714285714285, AUC 0.9974750280380249, avg_entr 0.001827120315283537, f1 0.9857714176177979
ep7_l4_test_time 3.0600381730000663
Save ckpt to ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9912410714285714 (555095/560000), AUC 0.9985682368278503
ep8_train_time 190.433885681
Test Epoch8 layer4 Acc 0.9850857142857142, AUC 0.997693657875061, avg_entr 0.0017045470885932446, f1 0.9850857257843018
ep8_l4_test_time 3.065598721000015
gc 0
Train Epoch9 Acc 0.9916928571428572 (555348/560000), AUC 0.9986410140991211
ep9_train_time 190.65007783300007
Test Epoch9 layer4 Acc 0.9856571428571429, AUC 0.9972384572029114, avg_entr 0.0015453299274668097, f1 0.9856571555137634
ep9_l4_test_time 3.120668015999854
gc 0
Train Epoch10 Acc 0.9923803571428571 (555733/560000), AUC 0.9987446069717407
ep10_train_time 191.69796631000008
Test Epoch10 layer4 Acc 0.9854857142857143, AUC 0.9976378083229065, avg_entr 0.0015380728291347623, f1 0.9854857325553894
ep10_l4_test_time 3.1000389259997974
gc 0
Train Epoch11 Acc 0.9928107142857143 (555974/560000), AUC 0.9987785220146179
ep11_train_time 232.91063172900022
Test Epoch11 layer4 Acc 0.9854285714285714, AUC 0.9974077939987183, avg_entr 0.001161969848908484, f1 0.9854285717010498
ep11_l4_test_time 3.4621830529999897
gc 0
Train Epoch12 Acc 0.9933428571428572 (556272/560000), AUC 0.9988171458244324
ep12_train_time 207.94062705700026
Test Epoch12 layer4 Acc 0.9853714285714286, AUC 0.9974430799484253, avg_entr 0.0013522462686523795, f1 0.9853714108467102
ep12_l4_test_time 3.1260441670001455
gc 0
Train Epoch13 Acc 0.9936446428571428 (556441/560000), AUC 0.9988396763801575
ep13_train_time 225.6122843950002
Test Epoch13 layer4 Acc 0.9857428571428571, AUC 0.9974543452262878, avg_entr 0.0013251114869490266, f1 0.9857428669929504
ep13_l4_test_time 4.022736536000139
gc 0
Train Epoch14 Acc 0.9941178571428572 (556706/560000), AUC 0.9988799691200256
ep14_train_time 239.5187643080003
Test Epoch14 layer4 Acc 0.9851428571428571, AUC 0.9971286058425903, avg_entr 0.001177845522761345, f1 0.9851428866386414
ep14_l4_test_time 3.4614336079998793
gc 0
Train Epoch15 Acc 0.9944714285714286 (556904/560000), AUC 0.9988722801208496
ep15_train_time 237.4176496780001
Test Epoch15 layer4 Acc 0.9850857142857142, AUC 0.9970358610153198, avg_entr 0.0010776844574138522, f1 0.9850857257843018
ep15_l4_test_time 4.101748031999705
gc 0
Train Epoch16 Acc 0.9949071428571429 (557148/560000), AUC 0.9988991022109985
ep16_train_time 241.6628170279996
Test Epoch16 layer4 Acc 0.9850571428571429, AUC 0.9968795776367188, avg_entr 0.0011967396130785346, f1 0.9850571155548096
ep16_l4_test_time 4.014083191999816
gc 0
Train Epoch17 Acc 0.9952285714285715 (557328/560000), AUC 0.9988979697227478
ep17_train_time 242.68960317400024
Test Epoch17 layer4 Acc 0.9853714285714286, AUC 0.9971290230751038, avg_entr 0.0011186174815520644, f1 0.9853714108467102
ep17_l4_test_time 4.056556162000106
gc 0
Train Epoch18 Acc 0.9955321428571429 (557498/560000), AUC 0.9989443421363831
ep18_train_time 241.4148311429999
Test Epoch18 layer4 Acc 0.9844285714285714, AUC 0.9963980317115784, avg_entr 0.0008748500258661807, f1 0.9844285845756531
ep18_l4_test_time 4.05711185500013
gc 0
Train Epoch19 Acc 0.9957517857142857 (557621/560000), AUC 0.9989251494407654
ep19_train_time 235.4057918970002
Test Epoch19 layer4 Acc 0.9847428571428571, AUC 0.9963733553886414, avg_entr 0.0009743912960402668, f1 0.9847428798675537
ep19_l4_test_time 3.8821035139999367
Best AUC tensor(0.9858) 7
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 4270.73437065
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base256_pad80//dbpedia_14_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9744, AUC 0.9982506036758423, avg_entr 0.02643514983355999, f1 0.974399983882904
l0_test_time 1.3646119400000316
gc 0
Test layer1 Acc 0.9852571428571428, AUC 0.9986009001731873, avg_entr 0.0024707489646971226, f1 0.9852571487426758
l1_test_time 2.2233655509999153
gc 0
Test layer2 Acc 0.9854285714285714, AUC 0.9984416961669922, avg_entr 0.002014372032135725, f1 0.9854285717010498
l2_test_time 2.8193878350002706
gc 0
Test layer3 Acc 0.9854, AUC 0.9982072710990906, avg_entr 0.0018727622227743268, f1 0.9854000210762024
l3_test_time 3.387496638000812
gc 0
Test layer4 Acc 0.9854285714285714, AUC 0.9977400898933411, avg_entr 0.0018727148417383432, f1 0.9854285717010498
l4_test_time 3.9581563550000283
gc 0
Test threshold 0.1 Acc 0.9781142857142857, AUC 0.9983362555503845, avg_entr 0.004380252677947283, f1 0.9781143069267273
t0.1_test_time 2.0059906059996138
gc 0
Test threshold 0.2 Acc 0.9752, AUC 0.998255729675293, avg_entr 0.009331013076007366, f1 0.9751999974250793
t0.2_test_time 1.7460736600005475
gc 0
Test threshold 0.3 Acc 0.9744285714285714, AUC 0.9982512593269348, avg_entr 0.009997854940593243, f1 0.9744285941123962
t0.3_test_time 1.4386809649995485
gc 0
Test threshold 0.4 Acc 0.9744, AUC 0.9982506036758423, avg_entr 0.010016891174018383, f1 0.974399983882904
t0.4_test_time 1.4794316369998342
gc 0
Test threshold 0.5 Acc 0.9744, AUC 0.9982506036758423, avg_entr 0.010016891174018383, f1 0.974399983882904
t0.5_test_time 1.0581549099997574
gc 0
Test threshold 0.6 Acc 0.9744, AUC 0.9982506036758423, avg_entr 0.010016891174018383, f1 0.974399983882904
t0.6_test_time 1.2024482390006597
gc 0
Test threshold 0.7 Acc 0.9744, AUC 0.9982506036758423, avg_entr 0.010016891174018383, f1 0.974399983882904
t0.7_test_time 1.2333946199996717
gc 0
Test threshold 0.8 Acc 0.9744, AUC 0.9982506036758423, avg_entr 0.010016891174018383, f1 0.974399983882904
t0.8_test_time 1.231874761000654
gc 0
Test threshold 0.9 Acc 0.9744, AUC 0.9982506036758423, avg_entr 0.010016891174018383, f1 0.974399983882904
t0.9_test_time 1.2032178899999053
