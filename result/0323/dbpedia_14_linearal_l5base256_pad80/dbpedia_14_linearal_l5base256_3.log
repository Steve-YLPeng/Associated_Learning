total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 54.420708647000005
Start Training
gc 0
Train Epoch0 Acc 0.7874214285714286 (440956/560000), AUC 0.9614343047142029
ep0_train_time 55.802850326000005
Test Epoch0 layer4 Acc 0.9721142857142857, AUC 0.9982488751411438, avg_entr 0.1431577056646347, f1 0.9721142649650574
ep0_l4_test_time 1.0775399839999977
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9763017857142857 (546729/560000), AUC 0.9986949563026428
ep1_train_time 48.69051779899999
Test Epoch1 layer4 Acc 0.9744, AUC 0.9985608458518982, avg_entr 0.054782137274742126, f1 0.974399983882904
ep1_l4_test_time 1.5197386199999983
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9787285714285714 (548088/560000), AUC 0.9989458322525024
ep2_train_time 60.19738669
Test Epoch2 layer4 Acc 0.9754571428571429, AUC 0.998378574848175, avg_entr 0.029139898717403412, f1 0.9754571318626404
ep2_l4_test_time 1.1150882430000024
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9799125 (548751/560000), AUC 0.9988388419151306
ep3_train_time 53.11201251899999
Test Epoch3 layer4 Acc 0.9759428571428571, AUC 0.9979645013809204, avg_entr 0.017555521801114082, f1 0.975942850112915
ep3_l4_test_time 1.094087477999949
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9805821428571428 (549126/560000), AUC 0.9987236261367798
ep4_train_time 53.10154771100002
Test Epoch4 layer4 Acc 0.9762285714285714, AUC 0.9977998733520508, avg_entr 0.012397070415318012, f1 0.9762285947799683
ep4_l4_test_time 1.0521366589999843
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9808964285714286 (549302/560000), AUC 0.9986775517463684
ep5_train_time 50.17464235399996
Test Epoch5 layer4 Acc 0.9758285714285714, AUC 0.9977142214775085, avg_entr 0.00984785333275795, f1 0.9758285880088806
ep5_l4_test_time 0.8866112489999978
gc 0
Train Epoch6 Acc 0.9814267857142858 (549599/560000), AUC 0.9986262917518616
ep6_train_time 59.400976614
Test Epoch6 layer4 Acc 0.9769142857142857, AUC 0.9977537393569946, avg_entr 0.008136577904224396, f1 0.9769142866134644
ep6_l4_test_time 1.066203306000034
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9816589285714286 (549729/560000), AUC 0.9985929131507874
ep7_train_time 52.95939387300001
Test Epoch7 layer4 Acc 0.9770857142857143, AUC 0.997696042060852, avg_entr 0.007121226284652948, f1 0.9770857095718384
ep7_l4_test_time 1.1041903690000368
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9820125 (549927/560000), AUC 0.9986395239830017
ep8_train_time 53.50251427799998
Test Epoch8 layer4 Acc 0.9770285714285715, AUC 0.997718870639801, avg_entr 0.0064487759955227375, f1 0.9770285487174988
ep8_l4_test_time 1.0540350139999646
gc 0
Train Epoch9 Acc 0.982375 (550130/560000), AUC 0.9986754655838013
ep9_train_time 51.918723202000024
Test Epoch9 layer4 Acc 0.9767428571428571, AUC 0.9977636933326721, avg_entr 0.0061170062981545925, f1 0.9767428636550903
ep9_l4_test_time 0.9853133299999399
gc 0
Train Epoch10 Acc 0.9825089285714286 (550205/560000), AUC 0.9986997842788696
ep10_train_time 56.82444699900009
Test Epoch10 layer4 Acc 0.9771714285714286, AUC 0.9977664947509766, avg_entr 0.005696962121874094, f1 0.9771714210510254
ep10_l4_test_time 1.5166504989999794
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9827696428571429 (550351/560000), AUC 0.9986974000930786
ep11_train_time 53.694193532999975
Test Epoch11 layer4 Acc 0.9773714285714286, AUC 0.997693657875061, avg_entr 0.005290188826620579, f1 0.9773714542388916
ep11_l4_test_time 1.101509995000015
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9830089285714285 (550485/560000), AUC 0.9987459778785706
ep12_train_time 53.31158663999997
Test Epoch12 layer4 Acc 0.9772857142857143, AUC 0.9976859092712402, avg_entr 0.005096971057355404, f1 0.9772857427597046
ep12_l4_test_time 1.0745253769999863
gc 0
Train Epoch13 Acc 0.9832267857142857 (550607/560000), AUC 0.9987505674362183
ep13_train_time 53.08512297300001
Test Epoch13 layer4 Acc 0.9772285714285714, AUC 0.9977587461471558, avg_entr 0.004911269061267376, f1 0.977228581905365
ep13_l4_test_time 0.97891683499995
gc 0
Train Epoch14 Acc 0.9834232142857143 (550717/560000), AUC 0.9987607598304749
ep14_train_time 52.75352000600003
Test Epoch14 layer4 Acc 0.9773714285714286, AUC 0.997658908367157, avg_entr 0.004634580109268427, f1 0.9773714542388916
ep14_l4_test_time 1.5234357759999284
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.9835303571428572 (550777/560000), AUC 0.9987767338752747
ep15_train_time 57.07058743999994
Test Epoch15 layer4 Acc 0.9777142857142858, AUC 0.9978155493736267, avg_entr 0.004593966994434595, f1 0.9777143001556396
ep15_l4_test_time 1.0819217299999764
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.9837 (550872/560000), AUC 0.9987878203392029
ep16_train_time 52.93652195100003
Test Epoch16 layer4 Acc 0.9773428571428572, AUC 0.9977278709411621, avg_entr 0.004548767115920782, f1 0.9773428440093994
ep16_l4_test_time 1.0523156829999607
gc 0
Train Epoch17 Acc 0.9838446428571429 (550953/560000), AUC 0.9988060593605042
ep17_train_time 53.24633334700002
Test Epoch17 layer4 Acc 0.9772571428571428, AUC 0.9977186918258667, avg_entr 0.004279084503650665, f1 0.9772571325302124
ep17_l4_test_time 1.090391069000134
gc 0
Train Epoch18 Acc 0.9839321428571428 (551002/560000), AUC 0.998812198638916
ep18_train_time 48.75967351999998
Test Epoch18 layer4 Acc 0.9775142857142857, AUC 0.9976968765258789, avg_entr 0.00421758322045207, f1 0.9775142669677734
ep18_l4_test_time 0.8854208529999141
gc 0
Train Epoch19 Acc 0.9841142857142857 (551104/560000), AUC 0.9988285899162292
ep19_train_time 61.526814349000006
Test Epoch19 layer4 Acc 0.9778, AUC 0.9977658987045288, avg_entr 0.004128645174205303, f1 0.9778000116348267
ep19_l4_test_time 1.0863742419999198
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 19
Best AUC tensor(0.9778) 19
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 1106.647299141
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9744857142857143, AUC 0.9982930421829224, avg_entr 0.023630110546946526, f1 0.9744856953620911
l0_test_time 1.0773090139998658
gc 0
Test layer1 Acc 0.9769714285714286, AUC 0.9984732866287231, avg_entr 0.013741005212068558, f1 0.976971447467804
l1_test_time 1.0744066649999695
gc 0
Test layer2 Acc 0.9777142857142858, AUC 0.9982852935791016, avg_entr 0.007036680355668068, f1 0.9777143001556396
l2_test_time 1.096660280999913
gc 0
Test layer3 Acc 0.9777714285714286, AUC 0.9980851411819458, avg_entr 0.00491939764469862, f1 0.9777714014053345
l3_test_time 1.0799766780000937
gc 0
Test layer4 Acc 0.9773714285714286, AUC 0.9979208111763, avg_entr 0.003986625466495752, f1 0.9773714542388916
l4_test_time 1.103355165000039
gc 0
Test threshold 0.1 Acc 0.9754, AUC 0.998271644115448, avg_entr 0.004704133607447147, f1 0.9753999710083008
t0.1_test_time 1.428188020000107
gc 0
Test threshold 0.2 Acc 0.9746571428571429, AUC 0.998288094997406, avg_entr 0.008775589056313038, f1 0.9746571183204651
t0.2_test_time 1.2401533560000644
gc 0
Test threshold 0.3 Acc 0.9744857142857143, AUC 0.9982930421829224, avg_entr 0.008953996002674103, f1 0.9744856953620911
t0.3_test_time 1.1929698290000488
gc 0
Test threshold 0.4 Acc 0.9744857142857143, AUC 0.9982930421829224, avg_entr 0.008953996002674103, f1 0.9744856953620911
t0.4_test_time 1.208816668000054
gc 0
Test threshold 0.5 Acc 0.9744857142857143, AUC 0.9982930421829224, avg_entr 0.008953996002674103, f1 0.9744856953620911
t0.5_test_time 1.2768898490000993
gc 0
Test threshold 0.6 Acc 0.9744857142857143, AUC 0.9982930421829224, avg_entr 0.008953996002674103, f1 0.9744856953620911
t0.6_test_time 1.199417277000066
gc 0
Test threshold 0.7 Acc 0.9744857142857143, AUC 0.9982930421829224, avg_entr 0.008953996002674103, f1 0.9744856953620911
t0.7_test_time 1.31621880900002
gc 0
Test threshold 0.8 Acc 0.9744857142857143, AUC 0.9982930421829224, avg_entr 0.008953996002674103, f1 0.9744856953620911
t0.8_test_time 1.197759503000043
gc 0
Test threshold 0.9 Acc 0.9744857142857143, AUC 0.9982930421829224, avg_entr 0.008953996002674103, f1 0.9744856953620911
t0.9_test_time 1.1878153320001275
