total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 53.473024800000005
Start Training
gc 0
Train Epoch0 Acc 0.7765285714285715 (434856/560000), AUC 0.9587265253067017
ep0_train_time 45.592031128
Test Epoch0 layer4 Acc 0.9713714285714286, AUC 0.998289942741394, avg_entr 0.14091172814369202, f1 0.9713714122772217
ep0_l4_test_time 0.889105298000004
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9764589285714286 (546817/560000), AUC 0.9987297058105469
ep1_train_time 43.80181955799999
Test Epoch1 layer4 Acc 0.9750857142857143, AUC 0.9986745119094849, avg_entr 0.05629221722483635, f1 0.9750857353210449
ep1_l4_test_time 0.8945926899999961
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9789517857142858 (548213/560000), AUC 0.9990010261535645
ep2_train_time 44.122692795999995
Test Epoch2 layer4 Acc 0.9755428571428572, AUC 0.99864661693573, avg_entr 0.03001837246119976, f1 0.9755428433418274
ep2_l4_test_time 0.8741106150000064
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.98 (548800/560000), AUC 0.9989299178123474
ep3_train_time 43.657676313999985
Test Epoch3 layer4 Acc 0.9757428571428571, AUC 0.9983252882957458, avg_entr 0.017924711108207703, f1 0.9757428765296936
ep3_l4_test_time 0.8651945940000019
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9807785714285714 (549236/560000), AUC 0.9988146424293518
ep4_train_time 43.33543648900002
Test Epoch4 layer4 Acc 0.9763142857142857, AUC 0.9981788396835327, avg_entr 0.012900284491479397, f1 0.9763143062591553
ep4_l4_test_time 0.887861364999992
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9812357142857143 (549492/560000), AUC 0.9987229108810425
ep5_train_time 43.27960215500002
Test Epoch5 layer4 Acc 0.9764857142857143, AUC 0.998034656047821, avg_entr 0.010103564709424973, f1 0.9764857292175293
ep5_l4_test_time 0.8648060379999833
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9815642857142857 (549676/560000), AUC 0.9986732602119446
ep6_train_time 43.089689014999976
Test Epoch6 layer4 Acc 0.9763428571428572, AUC 0.9979166984558105, avg_entr 0.008631649427115917, f1 0.9763428568840027
ep6_l4_test_time 0.8612992740000323
gc 0
Train Epoch7 Acc 0.9819392857142857 (549886/560000), AUC 0.9986604452133179
ep7_train_time 43.325131245999955
Test Epoch7 layer4 Acc 0.9769142857142857, AUC 0.9978224039077759, avg_entr 0.007388297002762556, f1 0.9769142866134644
ep7_l4_test_time 0.8955014729999675
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9822375 (550053/560000), AUC 0.9986544847488403
ep8_train_time 43.04657437000003
Test Epoch8 layer4 Acc 0.9765428571428572, AUC 0.9978155493736267, avg_entr 0.006688003893941641, f1 0.9765428304672241
ep8_l4_test_time 0.8750623939999969
gc 0
Train Epoch9 Acc 0.9824303571428571 (550161/560000), AUC 0.9987102746963501
ep9_train_time 43.20757535500002
Test Epoch9 layer4 Acc 0.9766285714285714, AUC 0.9976605176925659, avg_entr 0.00623518880456686, f1 0.9766285419464111
ep9_l4_test_time 0.8620839579999711
gc 0
Train Epoch10 Acc 0.9827517857142857 (550341/560000), AUC 0.9986584782600403
ep10_train_time 43.23389538400005
Test Epoch10 layer4 Acc 0.9769714285714286, AUC 0.997515082359314, avg_entr 0.005621928256005049, f1 0.976971447467804
ep10_l4_test_time 0.854446380000013
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9829 (550424/560000), AUC 0.9987192749977112
ep11_train_time 43.16899269600003
Test Epoch11 layer4 Acc 0.9767428571428571, AUC 0.9977266192436218, avg_entr 0.00548123475164175, f1 0.9767428636550903
ep11_l4_test_time 0.8675767209999776
gc 0
Train Epoch12 Acc 0.9831875 (550585/560000), AUC 0.9987426996231079
ep12_train_time 43.479408131000014
Test Epoch12 layer4 Acc 0.9773142857142857, AUC 0.9975573420524597, avg_entr 0.00522095151245594, f1 0.977314293384552
ep12_l4_test_time 0.8693387739999707
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.9833089285714286 (550653/560000), AUC 0.9987367987632751
ep13_train_time 43.57268288199998
Test Epoch13 layer4 Acc 0.9774, AUC 0.9976304769515991, avg_entr 0.005109046120196581, f1 0.977400004863739
ep13_l4_test_time 0.8651838079999834
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.9834125 (550711/560000), AUC 0.9987438917160034
ep14_train_time 43.050038174000065
Test Epoch14 layer4 Acc 0.9774571428571428, AUC 0.9976164698600769, avg_entr 0.004689342342317104, f1 0.9774571657180786
ep14_l4_test_time 0.8860480609999968
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.9836160714285714 (550825/560000), AUC 0.9987627863883972
ep15_train_time 43.120176423999965
Test Epoch15 layer4 Acc 0.9775428571428572, AUC 0.9975048303604126, avg_entr 0.004490497522056103, f1 0.9775428771972656
ep15_l4_test_time 0.8679098170000543
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.9837839285714286 (550919/560000), AUC 0.9987755417823792
ep16_train_time 43.27375636800002
Test Epoch16 layer4 Acc 0.9776, AUC 0.9975537061691284, avg_entr 0.00436138641089201, f1 0.9775999784469604
ep16_l4_test_time 0.8884604720000198
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.9839214285714286 (550996/560000), AUC 0.9987794756889343
ep17_train_time 43.190118652000024
Test Epoch17 layer4 Acc 0.9776571428571429, AUC 0.9975717663764954, avg_entr 0.004440521355718374, f1 0.9776571393013
ep17_l4_test_time 0.8828357310000001
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 17
gc 0
Train Epoch18 Acc 0.9840267857142857 (551055/560000), AUC 0.9987761378288269
ep18_train_time 43.223809234999976
Test Epoch18 layer4 Acc 0.9775714285714285, AUC 0.9975528120994568, avg_entr 0.004217883571982384, f1 0.977571427822113
ep18_l4_test_time 0.8630292340000096
gc 0
Train Epoch19 Acc 0.9841089285714286 (551101/560000), AUC 0.9987717866897583
ep19_train_time 43.082755023999994
Test Epoch19 layer4 Acc 0.9775428571428572, AUC 0.9975009560585022, avg_entr 0.004159594886004925, f1 0.9775428771972656
ep19_l4_test_time 0.9165854020000097
Best AUC tensor(0.9777) 17
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 888.002984789
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9746285714285714, AUC 0.9982863664627075, avg_entr 0.023440975695848465, f1 0.9746285676956177
l0_test_time 0.8581599599999663
gc 0
Test layer1 Acc 0.9772571428571428, AUC 0.9984418153762817, avg_entr 0.01437310129404068, f1 0.9772571325302124
l1_test_time 0.8534751649999635
gc 0
Test layer2 Acc 0.9780857142857143, AUC 0.9981338381767273, avg_entr 0.007322108838707209, f1 0.9780856966972351
l2_test_time 0.8608689760000061
gc 0
Test layer3 Acc 0.9780571428571428, AUC 0.9978084564208984, avg_entr 0.0054215602576732635, f1 0.9780571460723877
l3_test_time 0.9109412239999983
gc 0
Test layer4 Acc 0.9781714285714286, AUC 0.9977205991744995, avg_entr 0.004457099828869104, f1 0.9781714081764221
l4_test_time 0.885964567999963
gc 0
Test threshold 0.1 Acc 0.9756571428571429, AUC 0.998297393321991, avg_entr 0.004732456058263779, f1 0.9756571650505066
t0.1_test_time 0.9289012009999169
gc 0
Test threshold 0.2 Acc 0.9747142857142858, AUC 0.9982856512069702, avg_entr 0.008725757710635662, f1 0.9747142791748047
t0.2_test_time 0.8721549740000683
gc 0
Test threshold 0.3 Acc 0.9746285714285714, AUC 0.9982863664627075, avg_entr 0.008882328867912292, f1 0.9746285676956177
t0.3_test_time 0.8649078999999347
gc 0
Test threshold 0.4 Acc 0.9746285714285714, AUC 0.9982863664627075, avg_entr 0.008882328867912292, f1 0.9746285676956177
t0.4_test_time 0.8583334109999896
gc 0
Test threshold 0.5 Acc 0.9746285714285714, AUC 0.9982863664627075, avg_entr 0.008882328867912292, f1 0.9746285676956177
t0.5_test_time 0.8571700070000361
gc 0
Test threshold 0.6 Acc 0.9746285714285714, AUC 0.9982863664627075, avg_entr 0.008882328867912292, f1 0.9746285676956177
t0.6_test_time 0.8531607590000476
gc 0
Test threshold 0.7 Acc 0.9746285714285714, AUC 0.9982863664627075, avg_entr 0.008882328867912292, f1 0.9746285676956177
t0.7_test_time 0.8658329569999523
gc 0
Test threshold 0.8 Acc 0.9746285714285714, AUC 0.9982863664627075, avg_entr 0.008882328867912292, f1 0.9746285676956177
t0.8_test_time 0.8573331520000238
gc 0
Test threshold 0.9 Acc 0.9746285714285714, AUC 0.9982863664627075, avg_entr 0.008882328867912292, f1 0.9746285676956177
t0.9_test_time 0.8861604410000155
