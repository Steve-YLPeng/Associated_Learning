total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 54.917802419000004
Start Training
gc 0
Train Epoch0 Acc 0.7888732142857143 (441769/560000), AUC 0.9620099663734436
ep0_train_time 53.962983148999996
Test Epoch0 layer4 Acc 0.9720857142857143, AUC 0.9982715249061584, avg_entr 0.1422947198152542, f1 0.97208571434021
ep0_l4_test_time 1.1226118809999974
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9763857142857143 (546776/560000), AUC 0.9987004399299622
ep1_train_time 48.341859416000005
Test Epoch1 layer4 Acc 0.9740285714285715, AUC 0.9986477494239807, avg_entr 0.05740952864289284, f1 0.9740285873413086
ep1_l4_test_time 0.9580870949999962
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9788517857142857 (548157/560000), AUC 0.9989649653434753
ep2_train_time 61.169548905
Test Epoch2 layer4 Acc 0.9756, AUC 0.9986032843589783, avg_entr 0.030888177454471588, f1 0.975600004196167
ep2_l4_test_time 1.1015490619999753
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9802446428571429 (548937/560000), AUC 0.9988918900489807
ep3_train_time 53.250026381000026
Test Epoch3 layer4 Acc 0.9758285714285714, AUC 0.9980856776237488, avg_entr 0.018276559188961983, f1 0.9758285880088806
ep3_l4_test_time 1.079112995999992
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9808535714285714 (549278/560000), AUC 0.9987208247184753
ep4_train_time 53.075950096999975
Test Epoch4 layer4 Acc 0.9760857142857143, AUC 0.9978739023208618, avg_entr 0.012687326408922672, f1 0.9760857224464417
ep4_l4_test_time 1.0341680960000303
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9812446428571429 (549497/560000), AUC 0.9986854195594788
ep5_train_time 50.28099262500001
Test Epoch5 layer4 Acc 0.9762857142857143, AUC 0.9977849125862122, avg_entr 0.010051844641566277, f1 0.9762856960296631
ep5_l4_test_time 0.8730552239999838
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9815267857142858 (549655/560000), AUC 0.9986661076545715
ep6_train_time 59.31052324799998
Test Epoch6 layer4 Acc 0.9765714285714285, AUC 0.9976472854614258, avg_entr 0.008520552888512611, f1 0.9765714406967163
ep6_l4_test_time 1.1319797390000303
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9819357142857142 (549884/560000), AUC 0.9986376166343689
ep7_train_time 53.26885891699999
Test Epoch7 layer4 Acc 0.9763714285714286, AUC 0.9976732134819031, avg_entr 0.007443292997777462, f1 0.9763714075088501
ep7_l4_test_time 1.0422423119999848
gc 0
Train Epoch8 Acc 0.9821732142857142 (550017/560000), AUC 0.9987158179283142
ep8_train_time 53.44305968899994
Test Epoch8 layer4 Acc 0.9766, AUC 0.9976719617843628, avg_entr 0.006822831928730011, f1 0.9765999913215637
ep8_l4_test_time 1.091912048999916
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9824642857142857 (550180/560000), AUC 0.998741626739502
ep9_train_time 51.30612809599995
Test Epoch9 layer4 Acc 0.9769428571428571, AUC 0.9976094961166382, avg_entr 0.006070246454328299, f1 0.9769428372383118
ep9_l4_test_time 0.972558274999983
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9826214285714285 (550268/560000), AUC 0.9987711310386658
ep10_train_time 55.80101670800002
Test Epoch10 layer4 Acc 0.9766, AUC 0.9976040720939636, avg_entr 0.005838389508426189, f1 0.9765999913215637
ep10_l4_test_time 1.427282585999933
gc 0
Train Epoch11 Acc 0.9829267857142857 (550439/560000), AUC 0.9987776875495911
ep11_train_time 54.6377843009999
Test Epoch11 layer4 Acc 0.9768857142857142, AUC 0.997606635093689, avg_entr 0.0054927002638578415, f1 0.9768857359886169
ep11_l4_test_time 1.077381733999914
gc 0
Train Epoch12 Acc 0.983 (550480/560000), AUC 0.9988042712211609
ep12_train_time 53.49775741399992
Test Epoch12 layer4 Acc 0.9772857142857143, AUC 0.9975775480270386, avg_entr 0.0053389729000627995, f1 0.9772857427597046
ep12_l4_test_time 1.1118894779999664
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.9832428571428572 (550616/560000), AUC 0.998835563659668
ep13_train_time 53.597716977000005
Test Epoch13 layer4 Acc 0.977, AUC 0.9977309107780457, avg_entr 0.004835729021579027, f1 0.9769999980926514
ep13_l4_test_time 0.9688939650000066
gc 0
Train Epoch14 Acc 0.9834357142857143 (550724/560000), AUC 0.9988101124763489
ep14_train_time 51.41422463099991
Test Epoch14 layer4 Acc 0.9772571428571428, AUC 0.997646689414978, avg_entr 0.004762221127748489, f1 0.9772571325302124
ep14_l4_test_time 1.4202085849999548
gc 0
Train Epoch15 Acc 0.9835553571428571 (550791/560000), AUC 0.9988088607788086
ep15_train_time 57.82636330799994
Test Epoch15 layer4 Acc 0.9772285714285714, AUC 0.9977055788040161, avg_entr 0.004490632098168135, f1 0.977228581905365
ep15_l4_test_time 1.0564635779999207
gc 0
Train Epoch16 Acc 0.9837696428571429 (550911/560000), AUC 0.9988414645195007
ep16_train_time 53.272476993000055
Test Epoch16 layer4 Acc 0.9774571428571428, AUC 0.99762362241745, avg_entr 0.004418445285409689, f1 0.9774571657180786
ep16_l4_test_time 1.0722821179999755
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.9838714285714286 (550968/560000), AUC 0.9988304376602173
ep17_train_time 53.46196595399988
Test Epoch17 layer4 Acc 0.9772, AUC 0.9976353049278259, avg_entr 0.0042477757669985294, f1 0.977199912071228
ep17_l4_test_time 1.0742945739998504
gc 0
Train Epoch18 Acc 0.9839839285714286 (551031/560000), AUC 0.9988171458244324
ep18_train_time 48.43764090799982
Test Epoch18 layer4 Acc 0.9773714285714286, AUC 0.9975194931030273, avg_entr 0.004228855483233929, f1 0.9773714542388916
ep18_l4_test_time 0.8654372819999026
gc 0
Train Epoch19 Acc 0.9841839285714286 (551143/560000), AUC 0.998807430267334
ep19_train_time 61.13383677599995
Test Epoch19 layer4 Acc 0.9771714285714286, AUC 0.9976773262023926, avg_entr 0.004090630915015936, f1 0.9771714210510254
ep19_l4_test_time 1.0835549879998325
Best AUC tensor(0.9775) 16
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 1103.8381728089998
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9741428571428571, AUC 0.9982956647872925, avg_entr 0.023951325565576553, f1 0.974142849445343
l0_test_time 1.109984897000004
gc 0
Test layer1 Acc 0.9760571428571428, AUC 0.9985221028327942, avg_entr 0.015480869449675083, f1 0.9760571718215942
l1_test_time 1.0575575440000193
gc 0
Test layer2 Acc 0.9772571428571428, AUC 0.9981873631477356, avg_entr 0.00814354233443737, f1 0.9772571325302124
l2_test_time 1.0956056029999672
gc 0
Test layer3 Acc 0.9777714285714286, AUC 0.998120903968811, avg_entr 0.005540717393159866, f1 0.9777714014053345
l3_test_time 1.0992391289998977
gc 0
Test layer4 Acc 0.9776, AUC 0.9980067610740662, avg_entr 0.004778801463544369, f1 0.9775999784469604
l4_test_time 1.101286023000057
gc 0
Test threshold 0.1 Acc 0.9751142857142857, AUC 0.9982714056968689, avg_entr 0.004839418921619654, f1 0.9751142859458923
t0.1_test_time 1.3899593900000582
gc 0
Test threshold 0.2 Acc 0.9742571428571428, AUC 0.99828040599823, avg_entr 0.008887751027941704, f1 0.9742571711540222
t0.2_test_time 0.9265739919999305
gc 0
Test threshold 0.3 Acc 0.9741428571428571, AUC 0.9982956647872925, avg_entr 0.009075711481273174, f1 0.974142849445343
t0.3_test_time 0.903716852000116
gc 0
Test threshold 0.4 Acc 0.9741428571428571, AUC 0.9982956647872925, avg_entr 0.009075711481273174, f1 0.974142849445343
t0.4_test_time 0.9980373420000888
gc 0
Test threshold 0.5 Acc 0.9741428571428571, AUC 0.9982956647872925, avg_entr 0.009075711481273174, f1 0.974142849445343
t0.5_test_time 1.2108734759999606
gc 0
Test threshold 0.6 Acc 0.9741428571428571, AUC 0.9982956647872925, avg_entr 0.009075711481273174, f1 0.974142849445343
t0.6_test_time 1.1979740120000315
gc 0
Test threshold 0.7 Acc 0.9741428571428571, AUC 0.9982956647872925, avg_entr 0.009075711481273174, f1 0.974142849445343
t0.7_test_time 1.2104085410001062
gc 0
Test threshold 0.8 Acc 0.9741428571428571, AUC 0.9982956647872925, avg_entr 0.009075711481273174, f1 0.974142849445343
t0.8_test_time 1.2307765929999732
gc 0
Test threshold 0.9 Acc 0.9741428571428571, AUC 0.9982956647872925, avg_entr 0.009075711481273174, f1 0.974142849445343
t0.9_test_time 1.2239999309999803
