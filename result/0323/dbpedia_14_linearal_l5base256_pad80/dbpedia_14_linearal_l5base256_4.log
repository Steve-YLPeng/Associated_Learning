total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 54.551645119
Start Training
gc 0
Train Epoch0 Acc 0.7894517857142858 (442093/560000), AUC 0.9611088633537292
ep0_train_time 45.189230489
Test Epoch0 layer4 Acc 0.9714571428571429, AUC 0.9982709884643555, avg_entr 0.14217957854270935, f1 0.9714571237564087
ep0_l4_test_time 0.8735760050000039
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9761517857142857 (546645/560000), AUC 0.9986621737480164
ep1_train_time 43.070655925
Test Epoch1 layer4 Acc 0.9736285714285714, AUC 0.9986414909362793, avg_entr 0.057804204523563385, f1 0.973628580570221
ep1_l4_test_time 0.8972994809999761
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9784678571428571 (547942/560000), AUC 0.998956561088562
ep2_train_time 43.232195312000016
Test Epoch2 layer4 Acc 0.9750571428571428, AUC 0.9985916018486023, avg_entr 0.030834821984171867, f1 0.9750571250915527
ep2_l4_test_time 0.8533280279999929
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9798321428571428 (548706/560000), AUC 0.9989144206047058
ep3_train_time 43.13522665099998
Test Epoch3 layer4 Acc 0.9758857142857142, AUC 0.9983209371566772, avg_entr 0.019012650474905968, f1 0.9758856892585754
ep3_l4_test_time 0.8564818219999779
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9805196428571429 (549091/560000), AUC 0.9987736940383911
ep4_train_time 43.186907599999984
Test Epoch4 layer4 Acc 0.9763142857142857, AUC 0.9980097413063049, avg_entr 0.013236497528851032, f1 0.9763143062591553
ep4_l4_test_time 0.8653492230000097
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9811303571428571 (549433/560000), AUC 0.9986649751663208
ep5_train_time 43.19113031400002
Test Epoch5 layer4 Acc 0.9763142857142857, AUC 0.9979501962661743, avg_entr 0.010444187559187412, f1 0.9763143062591553
ep5_l4_test_time 0.8645198099999902
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9815785714285714 (549684/560000), AUC 0.9986447691917419
ep6_train_time 43.37043648400004
Test Epoch6 layer4 Acc 0.9767714285714286, AUC 0.997832715511322, avg_entr 0.008723200298845768, f1 0.9767714142799377
ep6_l4_test_time 0.8499053170000366
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9819196428571428 (549875/560000), AUC 0.9986488223075867
ep7_train_time 43.17558571500001
Test Epoch7 layer4 Acc 0.9770285714285715, AUC 0.9977365136146545, avg_entr 0.007674804888665676, f1 0.9770285487174988
ep7_l4_test_time 0.8413662109999791
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9820625 (549955/560000), AUC 0.9986821413040161
ep8_train_time 43.279152515999954
Test Epoch8 layer4 Acc 0.9769428571428571, AUC 0.9978509545326233, avg_entr 0.007062370423227549, f1 0.9769428372383118
ep8_l4_test_time 0.850228044000005
gc 0
Train Epoch9 Acc 0.9824892857142857 (550194/560000), AUC 0.9987239837646484
ep9_train_time 43.13339406099999
Test Epoch9 layer4 Acc 0.9770285714285715, AUC 0.9977114796638489, avg_entr 0.006228331476449966, f1 0.9770285487174988
ep9_l4_test_time 0.882676387999993
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9826464285714286 (550282/560000), AUC 0.9987047910690308
ep10_train_time 43.36476401300001
Test Epoch10 layer4 Acc 0.9773714285714286, AUC 0.9976865649223328, avg_entr 0.00573648139834404, f1 0.9773714542388916
ep10_l4_test_time 0.866800061000049
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9828982142857143 (550423/560000), AUC 0.9987115263938904
ep11_train_time 43.08035439899993
Test Epoch11 layer4 Acc 0.9771428571428571, AUC 0.9976829886436462, avg_entr 0.005428946577012539, f1 0.977142870426178
ep11_l4_test_time 0.8540416559999358
gc 0
Train Epoch12 Acc 0.9830178571428572 (550490/560000), AUC 0.9987371563911438
ep12_train_time 43.18475416799993
Test Epoch12 layer4 Acc 0.9774285714285714, AUC 0.9976119995117188, avg_entr 0.005098691210150719, f1 0.9774284958839417
ep12_l4_test_time 0.8708255070000632
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.9831589285714286 (550569/560000), AUC 0.9987453818321228
ep13_train_time 43.08911281399992
Test Epoch13 layer4 Acc 0.9772857142857143, AUC 0.9976914525032043, avg_entr 0.005020856391638517, f1 0.9772857427597046
ep13_l4_test_time 0.8528325360000508
gc 0
Train Epoch14 Acc 0.9833785714285714 (550692/560000), AUC 0.9987279772758484
ep14_train_time 43.28527073999999
Test Epoch14 layer4 Acc 0.9773142857142857, AUC 0.997684121131897, avg_entr 0.004565193317830563, f1 0.977314293384552
ep14_l4_test_time 0.8944327780000094
gc 0
Train Epoch15 Acc 0.9835375 (550781/560000), AUC 0.998752236366272
ep15_train_time 43.131152671999985
Test Epoch15 layer4 Acc 0.9778571428571429, AUC 0.9976897239685059, avg_entr 0.004331438336521387, f1 0.9778571724891663
ep15_l4_test_time 0.8757750450000685
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.9837017857142857 (550873/560000), AUC 0.9987507462501526
ep16_train_time 43.24388520000002
Test Epoch16 layer4 Acc 0.9777714285714286, AUC 0.9975612759590149, avg_entr 0.004267684184014797, f1 0.9777714014053345
ep16_l4_test_time 0.8498892650000016
gc 0
Train Epoch17 Acc 0.9838660714285714 (550965/560000), AUC 0.9987910389900208
ep17_train_time 43.18957216599995
Test Epoch17 layer4 Acc 0.9776857142857143, AUC 0.9975752234458923, avg_entr 0.0042571499943733215, f1 0.9776856899261475
ep17_l4_test_time 0.8551671259999694
gc 0
Train Epoch18 Acc 0.9840017857142858 (551041/560000), AUC 0.998761773109436
ep18_train_time 43.428405830999964
Test Epoch18 layer4 Acc 0.9776857142857143, AUC 0.9975833892822266, avg_entr 0.0039750575087964535, f1 0.9776856899261475
ep18_l4_test_time 0.8611930929999971
gc 0
Train Epoch19 Acc 0.9840678571428572 (551078/560000), AUC 0.9987919926643372
ep19_train_time 43.08247037000001
Test Epoch19 layer4 Acc 0.9776285714285714, AUC 0.9976220726966858, avg_entr 0.0039982423186302185, f1 0.9776285886764526
ep19_l4_test_time 0.8579472260000784
Best AUC tensor(0.9779) 15
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 884.818246723
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9740571428571428, AUC 0.9983024001121521, avg_entr 0.023778900504112244, f1 0.974057137966156
l0_test_time 0.8530768130000297
gc 0
Test layer1 Acc 0.9761142857142857, AUC 0.9984630346298218, avg_entr 0.015674399212002754, f1 0.9761142730712891
l1_test_time 0.8444875699999557
gc 0
Test layer2 Acc 0.9763142857142857, AUC 0.9980852007865906, avg_entr 0.008432921953499317, f1 0.9763143062591553
l2_test_time 0.8740748489999532
gc 0
Test layer3 Acc 0.9770857142857143, AUC 0.9981717467308044, avg_entr 0.0061689717695117, f1 0.9770857095718384
l3_test_time 0.8795767399999477
gc 0
Test layer4 Acc 0.9772857142857143, AUC 0.9979917407035828, avg_entr 0.005002310499548912, f1 0.9772857427597046
l4_test_time 0.8564012110000476
gc 0
Test threshold 0.1 Acc 0.9752857142857143, AUC 0.9983035922050476, avg_entr 0.004956903867423534, f1 0.9752857089042664
t0.1_test_time 0.9166190180000058
gc 0
Test threshold 0.2 Acc 0.9744, AUC 0.9983040690422058, avg_entr 0.008860528469085693, f1 0.974399983882904
t0.2_test_time 0.8568410530000392
gc 0
Test threshold 0.3 Acc 0.9740571428571428, AUC 0.9983024001121521, avg_entr 0.009010376408696175, f1 0.974057137966156
t0.3_test_time 0.853149167999959
gc 0
Test threshold 0.4 Acc 0.9740571428571428, AUC 0.9983024001121521, avg_entr 0.009010376408696175, f1 0.974057137966156
t0.4_test_time 0.8553093880000233
gc 0
Test threshold 0.5 Acc 0.9740571428571428, AUC 0.9983024001121521, avg_entr 0.009010376408696175, f1 0.974057137966156
t0.5_test_time 0.8513759920000439
gc 0
Test threshold 0.6 Acc 0.9740571428571428, AUC 0.9983024001121521, avg_entr 0.009010376408696175, f1 0.974057137966156
t0.6_test_time 0.888924137999993
gc 0
Test threshold 0.7 Acc 0.9740571428571428, AUC 0.9983024001121521, avg_entr 0.009010376408696175, f1 0.974057137966156
t0.7_test_time 0.855740720999961
gc 0
Test threshold 0.8 Acc 0.9740571428571428, AUC 0.9983024001121521, avg_entr 0.009010376408696175, f1 0.974057137966156
t0.8_test_time 0.8552160319999302
gc 0
Test threshold 0.9 Acc 0.9740571428571428, AUC 0.9983024001121521, avg_entr 0.009010376408696175, f1 0.974057137966156
t0.9_test_time 0.8484312839999575
