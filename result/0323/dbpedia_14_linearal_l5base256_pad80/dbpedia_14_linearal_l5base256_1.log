total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 60.749099818
Start Training
gc 0
Train Epoch0 Acc 0.7810875 (437409/560000), AUC 0.9621321558952332
ep0_train_time 57.33210350900001
Test Epoch0 layer4 Acc 0.9716571428571429, AUC 0.9982495307922363, avg_entr 0.1401684433221817, f1 0.9716571569442749
ep0_l4_test_time 1.1477444380000037
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9763053571428572 (546731/560000), AUC 0.9986984133720398
ep1_train_time 53.455466602
Test Epoch1 layer4 Acc 0.9744571428571429, AUC 0.9985750913619995, avg_entr 0.05464683473110199, f1 0.9744571447372437
ep1_l4_test_time 1.0653096590000075
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9787285714285714 (548088/560000), AUC 0.998957633972168
ep2_train_time 53.415751962
Test Epoch2 layer4 Acc 0.9750857142857143, AUC 0.9984690546989441, avg_entr 0.0291995108127594, f1 0.9750857353210449
ep2_l4_test_time 0.9824959210000088
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9797714285714286 (548672/560000), AUC 0.9988702535629272
ep3_train_time 51.002909859
Test Epoch3 layer4 Acc 0.9753428571428572, AUC 0.9981821775436401, avg_entr 0.017925729975104332, f1 0.975342869758606
ep3_l4_test_time 1.3931629110000472
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9805821428571428 (549126/560000), AUC 0.9987922310829163
ep4_train_time 57.913248494000015
Test Epoch4 layer4 Acc 0.9757428571428571, AUC 0.9979501366615295, avg_entr 0.012720664031803608, f1 0.9757428765296936
ep4_l4_test_time 1.0905852239999945
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9810714285714286 (549400/560000), AUC 0.9987326264381409
ep5_train_time 53.22764316400003
Test Epoch5 layer4 Acc 0.9760857142857143, AUC 0.9979114532470703, avg_entr 0.010171995498239994, f1 0.9760857224464417
ep5_l4_test_time 1.087010140000018
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9813946428571428 (549581/560000), AUC 0.9987355470657349
ep6_train_time 53.457465001
Test Epoch6 layer4 Acc 0.9764571428571429, AUC 0.9978307485580444, avg_entr 0.008639845065772533, f1 0.9764571189880371
ep6_l4_test_time 1.1402341460000116
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9817785714285714 (549796/560000), AUC 0.9987034201622009
ep7_train_time 49.95536366900001
Test Epoch7 layer4 Acc 0.9768857142857142, AUC 0.997775673866272, avg_entr 0.007388539146631956, f1 0.9768857359886169
ep7_l4_test_time 0.8741715639999939
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9820642857142857 (549956/560000), AUC 0.9987625479698181
ep8_train_time 59.74492850799999
Test Epoch8 layer4 Acc 0.9767428571428571, AUC 0.9978061318397522, avg_entr 0.0068314871750772, f1 0.9767428636550903
ep8_l4_test_time 1.062426027000015
gc 0
Train Epoch9 Acc 0.9823125 (550095/560000), AUC 0.9988025426864624
ep9_train_time 53.41788339200002
Test Epoch9 layer4 Acc 0.9769714285714286, AUC 0.9978721737861633, avg_entr 0.006303366739302874, f1 0.976971447467804
ep9_l4_test_time 1.0860696299999972
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9825553571428571 (550231/560000), AUC 0.9988085627555847
ep10_train_time 53.400324689999934
Test Epoch10 layer4 Acc 0.9768285714285714, AUC 0.9978193044662476, avg_entr 0.005764575209468603, f1 0.9768285751342773
ep10_l4_test_time 1.0770932919999723
gc 0
Train Epoch11 Acc 0.9827767857142857 (550355/560000), AUC 0.998829185962677
ep11_train_time 52.058111122000014
Test Epoch11 layer4 Acc 0.9769142857142857, AUC 0.9977747797966003, avg_entr 0.005373562220484018, f1 0.9769142866134644
ep11_l4_test_time 0.9545499430000746
gc 0
Train Epoch12 Acc 0.9830267857142857 (550495/560000), AUC 0.9988419413566589
ep12_train_time 56.570390651000025
Test Epoch12 layer4 Acc 0.9773714285714286, AUC 0.997736394405365, avg_entr 0.005138297565281391, f1 0.9773714542388916
ep12_l4_test_time 1.3833771060000117
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.9831339285714286 (550555/560000), AUC 0.998874306678772
ep13_train_time 54.183687072
Test Epoch13 layer4 Acc 0.9774571428571428, AUC 0.9977098703384399, avg_entr 0.004963589366525412, f1 0.9774571657180786
ep13_l4_test_time 1.0623609159999887
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.9834375 (550725/560000), AUC 0.9988546371459961
ep14_train_time 53.39761470999997
Test Epoch14 layer4 Acc 0.9773142857142857, AUC 0.9976892471313477, avg_entr 0.004550617653876543, f1 0.977314293384552
ep14_l4_test_time 0.9074561989999665
gc 0
Train Epoch15 Acc 0.9835946428571428 (550813/560000), AUC 0.9988530874252319
ep15_train_time 53.22340003900001
Test Epoch15 layer4 Acc 0.9774, AUC 0.9976682662963867, avg_entr 0.00439757015556097, f1 0.977400004863739
ep15_l4_test_time 1.05334858599997
gc 0
Train Epoch16 Acc 0.9837339285714286 (550891/560000), AUC 0.9988530874252319
ep16_train_time 49.89597183500007
Test Epoch16 layer4 Acc 0.9777714285714286, AUC 0.9977250695228577, avg_entr 0.004188227001577616, f1 0.9777714014053345
ep16_l4_test_time 1.4216365859999769
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.9838678571428572 (550966/560000), AUC 0.9988764524459839
ep17_train_time 59.23837373599997
Test Epoch17 layer4 Acc 0.9777714285714286, AUC 0.997710108757019, avg_entr 0.004234271589666605, f1 0.9777714014053345
ep17_l4_test_time 1.082039770999927
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 17
gc 0
Train Epoch18 Acc 0.9840767857142857 (551083/560000), AUC 0.998856246471405
ep18_train_time 53.49371235700005
Test Epoch18 layer4 Acc 0.9784285714285714, AUC 0.997552216053009, avg_entr 0.003985118120908737, f1 0.9784285426139832
ep18_l4_test_time 1.0477228120000746
Save ckpt to ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt  ,ep 18
gc 0
Train Epoch19 Acc 0.9842071428571428 (551156/560000), AUC 0.9988573789596558
ep19_train_time 53.79320824599995
Test Epoch19 layer4 Acc 0.9778285714285714, AUC 0.9975976347923279, avg_entr 0.00392852071672678, f1 0.9778285622596741
ep19_l4_test_time 1.1158598509998683
Best AUC tensor(0.9784) 18
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 1106.313828832
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base256_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9749714285714286, AUC 0.9983034729957581, avg_entr 0.02381444349884987, f1 0.9749714136123657
l0_test_time 1.0766076990000784
gc 0
Test layer1 Acc 0.9767142857142858, AUC 0.9984608888626099, avg_entr 0.013977962546050549, f1 0.9767143130302429
l1_test_time 1.0247554780000883
gc 0
Test layer2 Acc 0.9778285714285714, AUC 0.9982916116714478, avg_entr 0.007297527976334095, f1 0.9778285622596741
l2_test_time 1.0377384989999427
gc 0
Test layer3 Acc 0.9778571428571429, AUC 0.9982475638389587, avg_entr 0.00520214531570673, f1 0.9778571724891663
l3_test_time 1.0633380959998249
gc 0
Test layer4 Acc 0.9778857142857142, AUC 0.9978449940681458, avg_entr 0.004396420903503895, f1 0.9778857231140137
l4_test_time 1.090104397999994
gc 0
Test threshold 0.1 Acc 0.9756857142857143, AUC 0.9982525706291199, avg_entr 0.00467808498069644, f1 0.975685715675354
t0.1_test_time 1.3798520750001444
gc 0
Test threshold 0.2 Acc 0.9749142857142857, AUC 0.9983014464378357, avg_entr 0.008809232152998447, f1 0.9749143123626709
t0.2_test_time 1.2130897890001506
gc 0
Test threshold 0.3 Acc 0.9749714285714286, AUC 0.9983034729957581, avg_entr 0.009023844264447689, f1 0.9749714136123657
t0.3_test_time 1.1932339970001067
gc 0
Test threshold 0.4 Acc 0.9749714285714286, AUC 0.9983034729957581, avg_entr 0.009023844264447689, f1 0.9749714136123657
t0.4_test_time 1.2148343799999566
gc 0
Test threshold 0.5 Acc 0.9749714285714286, AUC 0.9983034729957581, avg_entr 0.009023844264447689, f1 0.9749714136123657
t0.5_test_time 1.0010609330001898
gc 0
Test threshold 0.6 Acc 0.9749714285714286, AUC 0.9983034729957581, avg_entr 0.009023844264447689, f1 0.9749714136123657
t0.6_test_time 1.0044209749999027
gc 0
Test threshold 0.7 Acc 0.9749714285714286, AUC 0.9983034729957581, avg_entr 0.009023844264447689, f1 0.9749714136123657
t0.7_test_time 0.9761733749999166
gc 0
Test threshold 0.8 Acc 0.9749714285714286, AUC 0.9983034729957581, avg_entr 0.009023844264447689, f1 0.9749714136123657
t0.8_test_time 0.9952460649999466
gc 0
Test threshold 0.9 Acc 0.9749714285714286, AUC 0.9983034729957581, avg_entr 0.009023844264447689, f1 0.9749714136123657
t0.9_test_time 1.0139886130000377
