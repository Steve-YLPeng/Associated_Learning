total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 54.271986274999996
Start Training
gc 0
Train Epoch0 Acc 0.8762178571428572 (490682/560000), AUC 0.9855065941810608
ep0_train_time 80.91006748699999
Test Epoch0 layer4 Acc 0.9736857142857143, AUC 0.9985729455947876, avg_entr 0.06432361900806427, f1 0.9736857414245605
ep0_l4_test_time 1.042626049000006
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9776053571428571 (547459/560000), AUC 0.9987427592277527
ep1_train_time 78.66006933499997
Test Epoch1 layer4 Acc 0.9759428571428571, AUC 0.9984580278396606, avg_entr 0.0228651724755764, f1 0.975942850112915
ep1_l4_test_time 1.049647469000007
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9794785714285714 (548508/560000), AUC 0.9986357092857361
ep2_train_time 78.38304102299998
Test Epoch2 layer4 Acc 0.9756857142857143, AUC 0.9979516267776489, avg_entr 0.012367638759315014, f1 0.975685715675354
ep2_l4_test_time 0.9927478889999861
gc 0
Train Epoch3 Acc 0.9804732142857143 (549065/560000), AUC 0.9986043572425842
ep3_train_time 79.83686823
Test Epoch3 layer4 Acc 0.9758285714285714, AUC 0.9979636073112488, avg_entr 0.008291894569993019, f1 0.9758285880088806
ep3_l4_test_time 0.9625177300000018
gc 0
Train Epoch4 Acc 0.9808875 (549297/560000), AUC 0.9985853433609009
ep4_train_time 75.808514436
Test Epoch4 layer4 Acc 0.9766857142857143, AUC 0.9978245496749878, avg_entr 0.006848339922726154, f1 0.9766857028007507
ep4_l4_test_time 0.9746550119999711
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9814803571428572 (549629/560000), AUC 0.998623251914978
ep5_train_time 76.09357785300006
Test Epoch5 layer4 Acc 0.9766571428571429, AUC 0.9979029893875122, avg_entr 0.0059533920139074326, f1 0.9766571521759033
ep5_l4_test_time 0.9756287939999311
gc 0
Train Epoch6 Acc 0.9819946428571429 (549917/560000), AUC 0.9987172484397888
ep6_train_time 76.03061202599997
Test Epoch6 layer4 Acc 0.9768857142857142, AUC 0.9979290962219238, avg_entr 0.005273662973195314, f1 0.9768857359886169
ep6_l4_test_time 0.9861234940000259
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9823232142857143 (550101/560000), AUC 0.9987935423851013
ep7_train_time 75.68024801799993
Test Epoch7 layer4 Acc 0.9772285714285714, AUC 0.9977906346321106, avg_entr 0.004901311360299587, f1 0.977228581905365
ep7_l4_test_time 0.9718476710000914
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.982725 (550326/560000), AUC 0.9988341331481934
ep8_train_time 76.19431266200002
Test Epoch8 layer4 Acc 0.9771428571428571, AUC 0.9978851675987244, avg_entr 0.0045950100757181644, f1 0.977142870426178
ep8_l4_test_time 1.0263134589999936
gc 0
Train Epoch9 Acc 0.9830214285714286 (550492/560000), AUC 0.9988303184509277
ep9_train_time 79.02517861699994
Test Epoch9 layer4 Acc 0.9778, AUC 0.9978899359703064, avg_entr 0.004441787954419851, f1 0.9778000116348267
ep9_l4_test_time 1.059154876999969
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.98315 (550564/560000), AUC 0.998837947845459
ep10_train_time 78.540990588
Test Epoch10 layer4 Acc 0.9778571428571429, AUC 0.9978829026222229, avg_entr 0.004313483368605375, f1 0.9778571724891663
ep10_l4_test_time 0.9896302940001078
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9834696428571429 (550743/560000), AUC 0.9988888502120972
ep11_train_time 81.88470404500003
Test Epoch11 layer4 Acc 0.9778857142857142, AUC 0.9978054761886597, avg_entr 0.0041125742718577385, f1 0.9778857231140137
ep11_l4_test_time 0.9695791350000036
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9837160714285714 (550881/560000), AUC 0.9989137053489685
ep12_train_time 75.864038489
Test Epoch12 layer4 Acc 0.9772, AUC 0.9977635741233826, avg_entr 0.004029859323054552, f1 0.977199912071228
ep12_l4_test_time 0.9838643289999709
gc 0
Train Epoch13 Acc 0.9839 (550984/560000), AUC 0.9989000558853149
ep13_train_time 75.75771933700003
Test Epoch13 layer4 Acc 0.9782, AUC 0.9978295564651489, avg_entr 0.003965453244745731, f1 0.9782000184059143
ep13_l4_test_time 0.9914213730000938
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.9840482142857143 (551067/560000), AUC 0.9989017248153687
ep14_train_time 75.60426335600005
Test Epoch14 layer4 Acc 0.9781142857142857, AUC 0.9978829026222229, avg_entr 0.00366519158706069, f1 0.9781143069267273
ep14_l4_test_time 0.9835551499998019
gc 0
Train Epoch15 Acc 0.9841946428571429 (551149/560000), AUC 0.9989205598831177
ep15_train_time 75.80786223799987
Test Epoch15 layer4 Acc 0.9780857142857143, AUC 0.9979057908058167, avg_entr 0.0037180292420089245, f1 0.9780856966972351
ep15_l4_test_time 0.974903207999887
gc 0
Train Epoch16 Acc 0.9843410714285714 (551231/560000), AUC 0.9989205598831177
ep16_train_time 75.76127871199992
Test Epoch16 layer4 Acc 0.9782, AUC 0.9976634383201599, avg_entr 0.003574306843802333, f1 0.9782000184059143
ep16_l4_test_time 0.9778119610000431
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.9845160714285714 (551329/560000), AUC 0.998928964138031
ep17_train_time 75.65015062099997
Test Epoch17 layer4 Acc 0.9785428571428572, AUC 0.9977831244468689, avg_entr 0.0036522564478218555, f1 0.9785428643226624
ep17_l4_test_time 0.9973862679999002
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 17
gc 0
Train Epoch18 Acc 0.9845696428571429 (551359/560000), AUC 0.9989168047904968
ep18_train_time 75.70214809000004
Test Epoch18 layer4 Acc 0.9779142857142857, AUC 0.9976698756217957, avg_entr 0.0032945771235972643, f1 0.9779142737388611
ep18_l4_test_time 0.9752272329999414
gc 0
Train Epoch19 Acc 0.98475 (551460/560000), AUC 0.9989356398582458
ep19_train_time 75.87955175699994
Test Epoch19 layer4 Acc 0.9780857142857143, AUC 0.9976658821105957, avg_entr 0.0033235675655305386, f1 0.9780856966972351
ep19_l4_test_time 0.9781366810000236
Best AUC tensor(0.9785) 17
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 1564.5443521519999
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9744857142857143, AUC 0.9983636736869812, avg_entr 0.02274680882692337, f1 0.9744856953620911
l0_test_time 0.931527325999923
gc 0
Test layer1 Acc 0.9783142857142857, AUC 0.9983308911323547, avg_entr 0.010519766248762608, f1 0.9783142805099487
l1_test_time 0.9581642379998812
gc 0
Test layer2 Acc 0.9784857142857143, AUC 0.9983099102973938, avg_entr 0.00549984909594059, f1 0.9784857034683228
l2_test_time 0.9650729749998845
gc 0
Test layer3 Acc 0.9786, AUC 0.9982959032058716, avg_entr 0.004130699206143618, f1 0.978600025177002
l3_test_time 0.9686666879999848
gc 0
Test layer4 Acc 0.9786571428571429, AUC 0.9980282187461853, avg_entr 0.0036455304361879826, f1 0.9786571264266968
l4_test_time 0.9694027910002205
gc 0
Test threshold 0.1 Acc 0.9756857142857143, AUC 0.9983009696006775, avg_entr 0.004287349060177803, f1 0.975685715675354
t0.1_test_time 1.0508122059998186
gc 0
Test threshold 0.2 Acc 0.9746285714285714, AUC 0.9983591437339783, avg_entr 0.008460918441414833, f1 0.9746285676956177
t0.2_test_time 0.9740733789999467
gc 0
Test threshold 0.3 Acc 0.9744857142857143, AUC 0.9983636736869812, avg_entr 0.008619293570518494, f1 0.9744856953620911
t0.3_test_time 0.9653724720001264
gc 0
Test threshold 0.4 Acc 0.9744857142857143, AUC 0.9983636736869812, avg_entr 0.008619293570518494, f1 0.9744856953620911
t0.4_test_time 0.9642203370001425
gc 0
Test threshold 0.5 Acc 0.9744857142857143, AUC 0.9983636736869812, avg_entr 0.008619293570518494, f1 0.9744856953620911
t0.5_test_time 0.9668486000000485
gc 0
Test threshold 0.6 Acc 0.9744857142857143, AUC 0.9983636736869812, avg_entr 0.008619293570518494, f1 0.9744856953620911
t0.6_test_time 0.9648593249999067
gc 0
Test threshold 0.7 Acc 0.9744857142857143, AUC 0.9983636736869812, avg_entr 0.008619293570518494, f1 0.9744856953620911
t0.7_test_time 0.9478261599999769
gc 0
Test threshold 0.8 Acc 0.9744857142857143, AUC 0.9983636736869812, avg_entr 0.008619293570518494, f1 0.9744856953620911
t0.8_test_time 0.9590208640001947
gc 0
Test threshold 0.9 Acc 0.9744857142857143, AUC 0.9983636736869812, avg_entr 0.008619293570518494, f1 0.9744856953620911
t0.9_test_time 1.03722745999994
