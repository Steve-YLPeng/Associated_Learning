total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 84.104001208
Start Training
gc 0
Train Epoch0 Acc 0.8766035714285715 (490898/560000), AUC 0.9854559302330017
ep0_train_time 141.694807147
Test Epoch0 layer4 Acc 0.9736, AUC 0.998481273651123, avg_entr 0.06184057518839836, f1 0.9735999703407288
ep0_l4_test_time 2.4042202139999915
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9779339285714286 (547643/560000), AUC 0.9987096786499023
ep1_train_time 155.98157469200004
Test Epoch1 layer4 Acc 0.9762, AUC 0.998554527759552, avg_entr 0.02219865284860134, f1 0.9761999845504761
ep1_l4_test_time 3.1477018649999877
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9796964285714286 (548630/560000), AUC 0.9986395239830017
ep2_train_time 158.15771707199997
Test Epoch2 layer4 Acc 0.9760571428571428, AUC 0.9980707168579102, avg_entr 0.011636611074209213, f1 0.9760571718215942
ep2_l4_test_time 3.0568827570000394
gc 0
Train Epoch3 Acc 0.9804821428571429 (549070/560000), AUC 0.9986044764518738
ep3_train_time 129.00116712099998
Test Epoch3 layer4 Acc 0.9764571428571429, AUC 0.9979841113090515, avg_entr 0.008356655016541481, f1 0.9764571189880371
ep3_l4_test_time 2.284011516000078
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9812696428571429 (549511/560000), AUC 0.9986990690231323
ep4_train_time 134.24240348800004
Test Epoch4 layer4 Acc 0.9770857142857143, AUC 0.9979215264320374, avg_entr 0.0069925435818731785, f1 0.9770857095718384
ep4_l4_test_time 3.1187829970000394
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9816839285714286 (549743/560000), AUC 0.9987355470657349
ep5_train_time 145.06061715299995
Test Epoch5 layer4 Acc 0.9764571428571429, AUC 0.9980184435844421, avg_entr 0.006162930745631456, f1 0.9764571189880371
ep5_l4_test_time 2.297062836000009
gc 0
Train Epoch6 Acc 0.9821910714285714 (550027/560000), AUC 0.9988340139389038
ep6_train_time 112.86192124900003
Test Epoch6 layer4 Acc 0.9770571428571428, AUC 0.9978631734848022, avg_entr 0.005495991092175245, f1 0.977057158946991
ep6_l4_test_time 2.5681000399999903
gc 0
Train Epoch7 Acc 0.982575 (550242/560000), AUC 0.998912513256073
ep7_train_time 132.1223940519999
Test Epoch7 layer4 Acc 0.9772571428571428, AUC 0.9979422688484192, avg_entr 0.0047513628378510475, f1 0.9772571325302124
ep7_l4_test_time 2.5815496749999056
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9828196428571429 (550379/560000), AUC 0.9989506602287292
ep8_train_time 132.28313292899998
Test Epoch8 layer4 Acc 0.9776285714285714, AUC 0.9980170130729675, avg_entr 0.004811668302863836, f1 0.9776285886764526
ep8_l4_test_time 2.636586307000016
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9831178571428572 (550546/560000), AUC 0.998927891254425
ep9_train_time 131.58527844900004
Test Epoch9 layer4 Acc 0.9773428571428572, AUC 0.9980412125587463, avg_entr 0.004253892693668604, f1 0.9773428440093994
ep9_l4_test_time 2.6518081310000525
gc 0
Train Epoch10 Acc 0.9834071428571428 (550708/560000), AUC 0.9989629983901978
ep10_train_time 132.142859026
Test Epoch10 layer4 Acc 0.9772857142857143, AUC 0.9979457259178162, avg_entr 0.004295318387448788, f1 0.9772857427597046
ep10_l4_test_time 2.573593413000026
gc 0
Train Epoch11 Acc 0.9835767857142858 (550803/560000), AUC 0.9989772439002991
ep11_train_time 119.99808817999997
Test Epoch11 layer4 Acc 0.9775714285714285, AUC 0.9979478716850281, avg_entr 0.004039491526782513, f1 0.977571427822113
ep11_l4_test_time 1.7271074530001442
gc 0
Train Epoch12 Acc 0.9838428571428571 (550952/560000), AUC 0.9989907145500183
ep12_train_time 98.63514788299995
Test Epoch12 layer4 Acc 0.9774571428571428, AUC 0.9979819059371948, avg_entr 0.003953856881707907, f1 0.9774571657180786
ep12_l4_test_time 1.843084299000111
gc 0
Train Epoch13 Acc 0.9839285714285714 (551000/560000), AUC 0.9989932775497437
ep13_train_time 97.52529380300007
Test Epoch13 layer4 Acc 0.9774857142857143, AUC 0.9980735182762146, avg_entr 0.00386407901532948, f1 0.977485716342926
ep13_l4_test_time 1.7944358180000108
gc 0
Train Epoch14 Acc 0.9841160714285714 (551105/560000), AUC 0.9989936947822571
ep14_train_time 96.80782439099994
Test Epoch14 layer4 Acc 0.9777428571428571, AUC 0.9979805946350098, avg_entr 0.003791135037317872, f1 0.9777428507804871
ep14_l4_test_time 1.798371522000025
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.9842035714285714 (551154/560000), AUC 0.9990247488021851
ep15_train_time 97.47011689100009
Test Epoch15 layer4 Acc 0.9774571428571428, AUC 0.9981316924095154, avg_entr 0.003751139622181654, f1 0.9774571657180786
ep15_l4_test_time 1.8419194910002261
gc 0
Train Epoch16 Acc 0.9843017857142857 (551209/560000), AUC 0.9990078806877136
ep16_train_time 97.44389435999983
Test Epoch16 layer4 Acc 0.9773142857142857, AUC 0.998070240020752, avg_entr 0.0037108580581843853, f1 0.977314293384552
ep16_l4_test_time 1.7595680730000822
gc 0
Train Epoch17 Acc 0.9845535714285715 (551350/560000), AUC 0.999018669128418
ep17_train_time 102.73883694999995
Test Epoch17 layer4 Acc 0.9775142857142857, AUC 0.9981857538223267, avg_entr 0.003560316050425172, f1 0.9775142669677734
ep17_l4_test_time 2.6419664939999166
gc 0
Train Epoch18 Acc 0.9845767857142858 (551363/560000), AUC 0.9990378022193909
ep18_train_time 134.7174581989998
Test Epoch18 layer4 Acc 0.9775714285714285, AUC 0.9981151819229126, avg_entr 0.003644515760242939, f1 0.977571427822113
ep18_l4_test_time 2.3644184980003047
gc 0
Train Epoch19 Acc 0.9847482142857142 (551459/560000), AUC 0.9990186095237732
ep19_train_time 132.24336276099984
Test Epoch19 layer4 Acc 0.9775428571428572, AUC 0.9979597926139832, avg_entr 0.003733702702447772, f1 0.9775428771972656
ep19_l4_test_time 2.6616372799999226
Best AUC tensor(0.9777) 14
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 2532.693942409
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9744, AUC 0.9983392357826233, avg_entr 0.023210007697343826, f1 0.974399983882904
l0_test_time 2.595003120000001
gc 0
Test layer1 Acc 0.9773142857142857, AUC 0.9985190033912659, avg_entr 0.011782675981521606, f1 0.977314293384552
l1_test_time 2.6810686669996358
gc 0
Test layer2 Acc 0.9774857142857143, AUC 0.9983444213867188, avg_entr 0.006046377122402191, f1 0.977485716342926
l2_test_time 2.5815676439997333
gc 0
Test layer3 Acc 0.9779142857142857, AUC 0.9982122182846069, avg_entr 0.004543990828096867, f1 0.9779142737388611
l3_test_time 2.7023704439998255
gc 0
Test layer4 Acc 0.9781714285714286, AUC 0.9981746077537537, avg_entr 0.003746133530512452, f1 0.9781714081764221
l4_test_time 2.589294850999977
gc 0
Test threshold 0.1 Acc 0.9755142857142857, AUC 0.9983588457107544, avg_entr 0.004427694249898195, f1 0.97551429271698
t0.1_test_time 5.2189657829999305
gc 0
Test threshold 0.2 Acc 0.9745142857142857, AUC 0.9983407258987427, avg_entr 0.00863367598503828, f1 0.9745143055915833
t0.2_test_time 3.527073099000063
gc 0
Test threshold 0.3 Acc 0.9744, AUC 0.9983392357826233, avg_entr 0.008794810622930527, f1 0.974399983882904
t0.3_test_time 1.51167113099973
gc 0
Test threshold 0.4 Acc 0.9744, AUC 0.9983392357826233, avg_entr 0.008794810622930527, f1 0.974399983882904
t0.4_test_time 3.8230602049998197
gc 0
Test threshold 0.5 Acc 0.9744, AUC 0.9983392357826233, avg_entr 0.008794810622930527, f1 0.974399983882904
t0.5_test_time 2.050651001999995
gc 0
Test threshold 0.6 Acc 0.9744, AUC 0.9983392357826233, avg_entr 0.008794810622930527, f1 0.974399983882904
t0.6_test_time 1.76569555199967
gc 0
Test threshold 0.7 Acc 0.9744, AUC 0.9983392357826233, avg_entr 0.008794810622930527, f1 0.974399983882904
t0.7_test_time 1.7557360999999219
gc 0
Test threshold 0.8 Acc 0.9744, AUC 0.9983392357826233, avg_entr 0.008794810622930527, f1 0.974399983882904
t0.8_test_time 1.7449547820001499
gc 0
Test threshold 0.9 Acc 0.9744, AUC 0.9983392357826233, avg_entr 0.008794810622930527, f1 0.974399983882904
t0.9_test_time 1.7150091109997447
