total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 111.267090343
Start Training
gc 0
Train Epoch0 Acc 0.8703196428571428 (487379/560000), AUC 0.9852460622787476
ep0_train_time 134.89681105199998
Test Epoch0 layer4 Acc 0.9732571428571428, AUC 0.9985281229019165, avg_entr 0.06354661285877228, f1 0.9732571244239807
ep0_l4_test_time 2.5390314219999937
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9778321428571428 (547586/560000), AUC 0.9986958503723145
ep1_train_time 125.54875622400002
Test Epoch1 layer4 Acc 0.9749714285714286, AUC 0.9985767006874084, avg_entr 0.022491546347737312, f1 0.9749714136123657
ep1_l4_test_time 2.7231684920000134
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9797142857142858 (548640/560000), AUC 0.9985978007316589
ep2_train_time 122.33715743900001
Test Epoch2 layer4 Acc 0.9756, AUC 0.9982500672340393, avg_entr 0.01203074213117361, f1 0.975600004196167
ep2_l4_test_time 2.3100391240000135
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9806232142857143 (549149/560000), AUC 0.9984888434410095
ep3_train_time 126.07519471600006
Test Epoch3 layer4 Acc 0.9760285714285715, AUC 0.9981259703636169, avg_entr 0.008321810513734818, f1 0.976028561592102
ep3_l4_test_time 2.4572459820000176
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9812428571428572 (549496/560000), AUC 0.998542308807373
ep4_train_time 126.00078789099996
Test Epoch4 layer4 Acc 0.9762285714285714, AUC 0.9980095028877258, avg_entr 0.006892145611345768, f1 0.9762285947799683
ep4_l4_test_time 2.598989695
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9816321428571428 (549714/560000), AUC 0.9986286759376526
ep5_train_time 122.719962195
Test Epoch5 layer4 Acc 0.9766857142857143, AUC 0.9980229735374451, avg_entr 0.005808386020362377, f1 0.9766857028007507
ep5_l4_test_time 2.4454799000000094
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9820535714285714 (549950/560000), AUC 0.9987104535102844
ep6_train_time 126.14883696200002
Test Epoch6 layer4 Acc 0.9766285714285714, AUC 0.9980272054672241, avg_entr 0.005203431937843561, f1 0.9766285419464111
ep6_l4_test_time 2.4334456049999744
gc 0
Train Epoch7 Acc 0.9824017857142857 (550145/560000), AUC 0.9987762570381165
ep7_train_time 126.16811881699994
Test Epoch7 layer4 Acc 0.9766285714285714, AUC 0.9979284405708313, avg_entr 0.004992932081222534, f1 0.9766285419464111
ep7_l4_test_time 2.5542465430000902
gc 0
Train Epoch8 Acc 0.9829267857142857 (550439/560000), AUC 0.9988221526145935
ep8_train_time 122.07901679399993
Test Epoch8 layer4 Acc 0.9770571428571428, AUC 0.9978413581848145, avg_entr 0.004427389241755009, f1 0.977057158946991
ep8_l4_test_time 2.456202849999954
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9831714285714286 (550576/560000), AUC 0.9987773299217224
ep9_train_time 124.84118188000002
Test Epoch9 layer4 Acc 0.9765714285714285, AUC 0.9977371096611023, avg_entr 0.004453758709132671, f1 0.9765714406967163
ep9_l4_test_time 2.5031403670000145
gc 0
Train Epoch10 Acc 0.9833553571428572 (550679/560000), AUC 0.9988024830818176
ep10_train_time 125.89644620700005
Test Epoch10 layer4 Acc 0.9774285714285714, AUC 0.9976695775985718, avg_entr 0.0041216597892344, f1 0.9774284958839417
ep10_l4_test_time 2.6326182279999557
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9836517857142857 (550845/560000), AUC 0.9988082051277161
ep11_train_time 122.72463133499991
Test Epoch11 layer4 Acc 0.9771714285714286, AUC 0.9975967407226562, avg_entr 0.004032750613987446, f1 0.9771714210510254
ep11_l4_test_time 2.2956744650000473
gc 0
Train Epoch12 Acc 0.9838714285714286 (550968/560000), AUC 0.9988253712654114
ep12_train_time 126.20836451500008
Test Epoch12 layer4 Acc 0.9775428571428572, AUC 0.9977133870124817, avg_entr 0.003753417870029807, f1 0.9775428771972656
ep12_l4_test_time 2.566690736000055
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.9840160714285714 (551049/560000), AUC 0.9988004565238953
ep13_train_time 126.67415826699994
Test Epoch13 layer4 Acc 0.9773714285714286, AUC 0.9977613687515259, avg_entr 0.0039055508095771074, f1 0.9773714542388916
ep13_l4_test_time 2.4812364709998747
gc 0
Train Epoch14 Acc 0.9843339285714285 (551227/560000), AUC 0.9988187551498413
ep14_train_time 122.28369925699985
Test Epoch14 layer4 Acc 0.9776857142857143, AUC 0.9976183772087097, avg_entr 0.0036696838214993477, f1 0.9776856899261475
ep14_l4_test_time 2.4218386649999957
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.9843446428571428 (551233/560000), AUC 0.9988526105880737
ep15_train_time 126.27767809600005
Test Epoch15 layer4 Acc 0.9779714285714286, AUC 0.9977384805679321, avg_entr 0.0035859807394444942, f1 0.9779714345932007
ep15_l4_test_time 2.553729337000277
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.9846017857142857 (551377/560000), AUC 0.9988470077514648
ep16_train_time 126.42448091000006
Test Epoch16 layer4 Acc 0.9780285714285715, AUC 0.9976406097412109, avg_entr 0.0036509158089756966, f1 0.9780285954475403
ep16_l4_test_time 2.409087822999936
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.9846821428571428 (551422/560000), AUC 0.9988484978675842
ep17_train_time 122.44055590800008
Test Epoch17 layer4 Acc 0.978, AUC 0.9976348280906677, avg_entr 0.0036152030806988478, f1 0.9779999852180481
ep17_l4_test_time 2.442654883999694
gc 0
Train Epoch18 Acc 0.9849 (551544/560000), AUC 0.9988745450973511
ep18_train_time 125.14653956199982
Test Epoch18 layer4 Acc 0.9777714285714286, AUC 0.9977731704711914, avg_entr 0.003466647118330002, f1 0.9777714014053345
ep18_l4_test_time 2.52080153299994
gc 0
Train Epoch19 Acc 0.9850107142857143 (551606/560000), AUC 0.9988676309585571
ep19_train_time 125.48186260299963
Test Epoch19 layer4 Acc 0.9778, AUC 0.9976055026054382, avg_entr 0.0034630896989256144, f1 0.9778000116348267
ep19_l4_test_time 2.505213835000177
Best AUC tensor(0.9780) 16
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 2559.1581842170003
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9746, AUC 0.9983166456222534, avg_entr 0.023201793432235718, f1 0.9746000170707703
l0_test_time 2.388747343000432
gc 0
Test layer1 Acc 0.9784285714285714, AUC 0.9984055161476135, avg_entr 0.011071538552641869, f1 0.9784285426139832
l1_test_time 2.572939169000165
gc 0
Test layer2 Acc 0.9782285714285714, AUC 0.9983062148094177, avg_entr 0.005828776862472296, f1 0.9782285690307617
l2_test_time 2.5277681190000294
gc 0
Test layer3 Acc 0.9786857142857143, AUC 0.9981621503829956, avg_entr 0.004365236032754183, f1 0.978685736656189
l3_test_time 2.5795882050001637
gc 0
Test layer4 Acc 0.9786571428571429, AUC 0.9979572892189026, avg_entr 0.003787748981267214, f1 0.9786571264266968
l4_test_time 2.535614520999843
gc 0
Test threshold 0.1 Acc 0.9756571428571429, AUC 0.9983246922492981, avg_entr 0.0043598380871117115, f1 0.9756571650505066
t0.1_test_time 3.894063017999997
gc 0
Test threshold 0.2 Acc 0.9748857142857142, AUC 0.9983102083206177, avg_entr 0.008650238625705242, f1 0.9748857021331787
t0.2_test_time 3.7175573710001117
gc 0
Test threshold 0.3 Acc 0.9746, AUC 0.9983166456222534, avg_entr 0.008791697211563587, f1 0.9746000170707703
t0.3_test_time 3.4038564210000004
gc 0
Test threshold 0.4 Acc 0.9746, AUC 0.9983166456222534, avg_entr 0.008791697211563587, f1 0.9746000170707703
t0.4_test_time 3.2032061929999145
gc 0
Test threshold 0.5 Acc 0.9746, AUC 0.9983166456222534, avg_entr 0.008791697211563587, f1 0.9746000170707703
t0.5_test_time 3.467488145000061
gc 0
Test threshold 0.6 Acc 0.9746, AUC 0.9983166456222534, avg_entr 0.008791697211563587, f1 0.9746000170707703
t0.6_test_time 3.3508131069997944
gc 0
Test threshold 0.7 Acc 0.9746, AUC 0.9983166456222534, avg_entr 0.008791697211563587, f1 0.9746000170707703
t0.7_test_time 3.319290338999963
gc 0
Test threshold 0.8 Acc 0.9746, AUC 0.9983166456222534, avg_entr 0.008791697211563587, f1 0.9746000170707703
t0.8_test_time 3.5832575990002624
gc 0
Test threshold 0.9 Acc 0.9746, AUC 0.9983166456222534, avg_entr 0.008791697211563587, f1 0.9746000170707703
t0.9_test_time 3.2991544100000283
