total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 53.860072024000004
Start Training
gc 0
Train Epoch0 Acc 0.8740142857142857 (489448/560000), AUC 0.9852080941200256
ep0_train_time 78.636465326
Test Epoch0 layer4 Acc 0.9739428571428571, AUC 0.9985181093215942, avg_entr 0.06098585203289986, f1 0.9739428758621216
ep0_l4_test_time 0.9972969599999999
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9779267857142857 (547639/560000), AUC 0.9986482262611389
ep1_train_time 74.99868700599998
Test Epoch1 layer4 Acc 0.9757428571428571, AUC 0.998471736907959, avg_entr 0.022370072081685066, f1 0.9757428765296936
ep1_l4_test_time 1.0032635610000114
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9796857142857143 (548624/560000), AUC 0.9985088109970093
ep2_train_time 75.08145870700002
Test Epoch2 layer4 Acc 0.9765428571428572, AUC 0.9981012940406799, avg_entr 0.011296872980892658, f1 0.9765428304672241
ep2_l4_test_time 0.9952190469999778
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9805946428571428 (549133/560000), AUC 0.998561441898346
ep3_train_time 75.67827500499999
Test Epoch3 layer4 Acc 0.9765428571428572, AUC 0.9979432821273804, avg_entr 0.007941121235489845, f1 0.9765428304672241
ep3_l4_test_time 0.9799751770000285
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9812839285714285 (549519/560000), AUC 0.998637318611145
ep4_train_time 75.01847226500001
Test Epoch4 layer4 Acc 0.9763714285714286, AUC 0.9979747533798218, avg_entr 0.006616462953388691, f1 0.9763714075088501
ep4_l4_test_time 0.9688783849999822
gc 0
Train Epoch5 Acc 0.9817678571428572 (549790/560000), AUC 0.9987474679946899
ep5_train_time 75.04217935700001
Test Epoch5 layer4 Acc 0.9772571428571428, AUC 0.9978228211402893, avg_entr 0.0058610099367797375, f1 0.9772571325302124
ep5_l4_test_time 0.9705469820000872
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9820803571428571 (549965/560000), AUC 0.9988500475883484
ep6_train_time 74.84310054299999
Test Epoch6 layer4 Acc 0.9773714285714286, AUC 0.997876763343811, avg_entr 0.005325270351022482, f1 0.9773714542388916
ep6_l4_test_time 0.9807480160000068
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9824071428571428 (550148/560000), AUC 0.9989134073257446
ep7_train_time 75.16241279899998
Test Epoch7 layer4 Acc 0.9775428571428572, AUC 0.9979811906814575, avg_entr 0.004633411765098572, f1 0.9775428771972656
ep7_l4_test_time 1.006297585000084
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9827035714285715 (550314/560000), AUC 0.9989649653434753
ep8_train_time 74.90376924999998
Test Epoch8 layer4 Acc 0.9774, AUC 0.9978991150856018, avg_entr 0.0043928916566073895, f1 0.977400004863739
ep8_l4_test_time 0.9860278559999642
gc 0
Train Epoch9 Acc 0.9831785714285715 (550580/560000), AUC 0.9989610314369202
ep9_train_time 74.91163026600009
Test Epoch9 layer4 Acc 0.9776285714285714, AUC 0.9980633854866028, avg_entr 0.004324687644839287, f1 0.9776285886764526
ep9_l4_test_time 0.9659708550000232
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9833785714285714 (550692/560000), AUC 0.9989571571350098
ep10_train_time 74.94514985
Test Epoch10 layer4 Acc 0.9781142857142857, AUC 0.9979400634765625, avg_entr 0.0039294809103012085, f1 0.9781143069267273
ep10_l4_test_time 0.9885969249999107
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9836339285714286 (550835/560000), AUC 0.9989967346191406
ep11_train_time 75.04928865099998
Test Epoch11 layer4 Acc 0.9780285714285715, AUC 0.9978777170181274, avg_entr 0.003790393006056547, f1 0.9780285954475403
ep11_l4_test_time 0.987055105999957
gc 0
Train Epoch12 Acc 0.9838392857142857 (550950/560000), AUC 0.9989990592002869
ep12_train_time 75.11309161899999
Test Epoch12 layer4 Acc 0.9783142857142857, AUC 0.9977965354919434, avg_entr 0.0038757314905524254, f1 0.9783142805099487
ep12_l4_test_time 0.983604792000051
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.9838946428571429 (550981/560000), AUC 0.9990000128746033
ep13_train_time 75.04743379399997
Test Epoch13 layer4 Acc 0.9780285714285715, AUC 0.9980403780937195, avg_entr 0.0037266199942678213, f1 0.9780285954475403
ep13_l4_test_time 0.9854808449999837
gc 0
Train Epoch14 Acc 0.98415 (551124/560000), AUC 0.9989922642707825
ep14_train_time 74.76057682099986
Test Epoch14 layer4 Acc 0.9775714285714285, AUC 0.9979214072227478, avg_entr 0.003744853427633643, f1 0.977571427822113
ep14_l4_test_time 0.990180361000057
gc 0
Train Epoch15 Acc 0.9843160714285715 (551217/560000), AUC 0.9990232586860657
ep15_train_time 75.0450337530001
Test Epoch15 layer4 Acc 0.978, AUC 0.9978316426277161, avg_entr 0.0034669896122068167, f1 0.9779999852180481
ep15_l4_test_time 0.9899582980001469
gc 0
Train Epoch16 Acc 0.9845214285714285 (551332/560000), AUC 0.9990360140800476
ep16_train_time 75.07292340200001
Test Epoch16 layer4 Acc 0.9779714285714286, AUC 0.9979525208473206, avg_entr 0.003534170100465417, f1 0.9779714345932007
ep16_l4_test_time 0.9688283799998771
gc 0
Train Epoch17 Acc 0.9846035714285715 (551378/560000), AUC 0.9990125298500061
ep17_train_time 75.17420573200002
Test Epoch17 layer4 Acc 0.9781714285714286, AUC 0.9978893399238586, avg_entr 0.0034246172290295362, f1 0.9781714081764221
ep17_l4_test_time 0.9911807660000704
gc 0
Train Epoch18 Acc 0.9847785714285714 (551476/560000), AUC 0.9990201592445374
ep18_train_time 75.09158880100017
Test Epoch18 layer4 Acc 0.9779428571428571, AUC 0.9979785084724426, avg_entr 0.0034219666849821806, f1 0.9779428839683533
ep18_l4_test_time 0.9776488380000501
gc 0
Train Epoch19 Acc 0.9847660714285714 (551469/560000), AUC 0.9990105032920837
ep19_train_time 75.12654930000008
Test Epoch19 layer4 Acc 0.9784285714285714, AUC 0.9978680610656738, avg_entr 0.0035417512990534306, f1 0.9784285426139832
ep19_l4_test_time 0.9721471730001667
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 19
Best AUC tensor(0.9784) 19
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 1525.972151634
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.975, AUC 0.9983852505683899, avg_entr 0.022868404164910316, f1 0.9750000238418579
l0_test_time 0.9195142300000043
gc 0
Test layer1 Acc 0.9788857142857142, AUC 0.9984846711158752, avg_entr 0.010054542683064938, f1 0.9788857698440552
l1_test_time 0.9444097690000035
gc 0
Test layer2 Acc 0.978, AUC 0.9981738328933716, avg_entr 0.0051558190025389194, f1 0.9779999852180481
l2_test_time 0.9542755029999626
gc 0
Test layer3 Acc 0.9785428571428572, AUC 0.9979804158210754, avg_entr 0.004144295118749142, f1 0.9785428643226624
l3_test_time 0.9690457200001674
gc 0
Test layer4 Acc 0.9786571428571429, AUC 0.997926652431488, avg_entr 0.0035487026907503605, f1 0.9786571264266968
l4_test_time 0.9826645050000025
gc 0
Test threshold 0.1 Acc 0.9760285714285715, AUC 0.9983181357383728, avg_entr 0.004229309968650341, f1 0.976028561592102
t0.1_test_time 1.0606819820000055
gc 0
Test threshold 0.2 Acc 0.9751714285714286, AUC 0.9983802437782288, avg_entr 0.008479771204292774, f1 0.9751714468002319
t0.2_test_time 0.9929512399999112
gc 0
Test threshold 0.3 Acc 0.975, AUC 0.9983852505683899, avg_entr 0.00866536796092987, f1 0.9750000238418579
t0.3_test_time 0.9737539829998241
gc 0
Test threshold 0.4 Acc 0.975, AUC 0.9983852505683899, avg_entr 0.00866536796092987, f1 0.9750000238418579
t0.4_test_time 0.9713840389999859
gc 0
Test threshold 0.5 Acc 0.975, AUC 0.9983852505683899, avg_entr 0.00866536796092987, f1 0.9750000238418579
t0.5_test_time 0.9827475499998855
gc 0
Test threshold 0.6 Acc 0.975, AUC 0.9983852505683899, avg_entr 0.00866536796092987, f1 0.9750000238418579
t0.6_test_time 0.9687096259999635
gc 0
Test threshold 0.7 Acc 0.975, AUC 0.9983852505683899, avg_entr 0.00866536796092987, f1 0.9750000238418579
t0.7_test_time 0.9714784660000078
gc 0
Test threshold 0.8 Acc 0.975, AUC 0.9983852505683899, avg_entr 0.00866536796092987, f1 0.9750000238418579
t0.8_test_time 0.9804223790001743
gc 0
Test threshold 0.9 Acc 0.975, AUC 0.9983852505683899, avg_entr 0.00866536796092987, f1 0.9750000238418579
t0.9_test_time 0.9707553889998053
