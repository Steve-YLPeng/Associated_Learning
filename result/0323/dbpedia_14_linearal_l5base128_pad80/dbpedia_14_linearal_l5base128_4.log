total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 52.682743218
Start Training
gc 0
Train Epoch0 Acc 0.8707303571428572 (487609/560000), AUC 0.9853147864341736
ep0_train_time 75.570345325
Test Epoch0 layer4 Acc 0.9732571428571428, AUC 0.9985612034797668, avg_entr 0.06251659989356995, f1 0.9732571244239807
ep0_l4_test_time 0.9464969680000195
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9779089285714285 (547629/560000), AUC 0.9987048506736755
ep1_train_time 71.77713303299998
Test Epoch1 layer4 Acc 0.9750571428571428, AUC 0.9985337853431702, avg_entr 0.022520026192069054, f1 0.9750571250915527
ep1_l4_test_time 0.9423979180000117
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9797107142857143 (548638/560000), AUC 0.9986421465873718
ep2_train_time 72.04952320199999
Test Epoch2 layer4 Acc 0.9758571428571429, AUC 0.9979953765869141, avg_entr 0.011827331967651844, f1 0.975857138633728
ep2_l4_test_time 0.9610146389999841
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9805482142857143 (549107/560000), AUC 0.9985890984535217
ep3_train_time 71.59118672699998
Test Epoch3 layer4 Acc 0.9762, AUC 0.9979398846626282, avg_entr 0.008170326240360737, f1 0.9761999845504761
ep3_l4_test_time 0.9426923299999999
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9811982142857143 (549471/560000), AUC 0.9986422657966614
ep4_train_time 71.89549342700002
Test Epoch4 layer4 Acc 0.9765142857142857, AUC 0.9980277419090271, avg_entr 0.006723043974488974, f1 0.9765142798423767
ep4_l4_test_time 0.9413384279999946
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9816625 (549731/560000), AUC 0.9986981153488159
ep5_train_time 71.86028580799996
Test Epoch5 layer4 Acc 0.9770571428571428, AUC 0.9978489875793457, avg_entr 0.0057987794280052185, f1 0.977057158946991
ep5_l4_test_time 0.9503196150000122
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9820553571428572 (549951/560000), AUC 0.9987568855285645
ep6_train_time 72.569342286
Test Epoch6 layer4 Acc 0.9771714285714286, AUC 0.997907817363739, avg_entr 0.005330881103873253, f1 0.9771714210510254
ep6_l4_test_time 0.9486808619999465
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9823910714285714 (550139/560000), AUC 0.9988641738891602
ep7_train_time 71.82054810700004
Test Epoch7 layer4 Acc 0.9775142857142857, AUC 0.9978699088096619, avg_entr 0.0047988672740757465, f1 0.9775142669677734
ep7_l4_test_time 0.9811863470000617
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9827553571428571 (550343/560000), AUC 0.9988979697227478
ep8_train_time 72.44229432500003
Test Epoch8 layer4 Acc 0.9776285714285714, AUC 0.9978218078613281, avg_entr 0.004515608306974173, f1 0.9776285886764526
ep8_l4_test_time 0.9619422910000139
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9829767857142857 (550467/560000), AUC 0.9988799095153809
ep9_train_time 72.064451297
Test Epoch9 layer4 Acc 0.9778, AUC 0.9978296160697937, avg_entr 0.004325674846768379, f1 0.9778000116348267
ep9_l4_test_time 0.9366057589999173
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9832660714285715 (550629/560000), AUC 0.9988790154457092
ep10_train_time 72.088552617
Test Epoch10 layer4 Acc 0.9778, AUC 0.9978318810462952, avg_entr 0.003944832365959883, f1 0.9778000116348267
ep10_l4_test_time 0.9432476410000845
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9836142857142857 (550824/560000), AUC 0.9989081621170044
ep11_train_time 72.33572075999996
Test Epoch11 layer4 Acc 0.9775714285714285, AUC 0.9978197813034058, avg_entr 0.0038062329404056072, f1 0.977571427822113
ep11_l4_test_time 0.9632491840000057
gc 0
Train Epoch12 Acc 0.9837928571428571 (550924/560000), AUC 0.9989480376243591
ep12_train_time 73.41202041299994
Test Epoch12 layer4 Acc 0.9778857142857142, AUC 0.9976850748062134, avg_entr 0.003922194242477417, f1 0.9778857231140137
ep12_l4_test_time 0.9496507889999748
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.9838428571428571 (550952/560000), AUC 0.9989414811134338
ep13_train_time 72.85413242400011
Test Epoch13 layer4 Acc 0.9776857142857143, AUC 0.9978567361831665, avg_entr 0.0037807333283126354, f1 0.9776856899261475
ep13_l4_test_time 0.948423221999974
gc 0
Train Epoch14 Acc 0.9839732142857143 (551025/560000), AUC 0.9989241361618042
ep14_train_time 71.62026329700006
Test Epoch14 layer4 Acc 0.9780857142857143, AUC 0.9978009462356567, avg_entr 0.0036207777447998524, f1 0.9780856966972351
ep14_l4_test_time 0.9429517319999832
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.9842392857142858 (551174/560000), AUC 0.998941957950592
ep15_train_time 73.63327827800003
Test Epoch15 layer4 Acc 0.9780571428571428, AUC 0.9979495406150818, avg_entr 0.003426913172006607, f1 0.9780571460723877
ep15_l4_test_time 0.93926664300011
gc 0
Train Epoch16 Acc 0.9844214285714286 (551276/560000), AUC 0.998988687992096
ep16_train_time 73.24127417099999
Test Epoch16 layer4 Acc 0.9781714285714286, AUC 0.9977822303771973, avg_entr 0.003490201663225889, f1 0.9781714081764221
ep16_l4_test_time 0.9437297889999172
Save ckpt to ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.9844660714285715 (551301/560000), AUC 0.9989815354347229
ep17_train_time 75.823643833
Test Epoch17 layer4 Acc 0.978, AUC 0.9978993535041809, avg_entr 0.0034340464044362307, f1 0.9779999852180481
ep17_l4_test_time 0.9689355119999163
gc 0
Train Epoch18 Acc 0.9845785714285714 (551364/560000), AUC 0.9990015029907227
ep18_train_time 75.42831997899998
Test Epoch18 layer4 Acc 0.9781428571428571, AUC 0.9978956580162048, avg_entr 0.0034218905493617058, f1 0.9781428575515747
ep18_l4_test_time 0.9903314230000433
gc 0
Train Epoch19 Acc 0.9847303571428572 (551449/560000), AUC 0.9990151524543762
ep19_train_time 75.86730776000013
Test Epoch19 layer4 Acc 0.9778857142857142, AUC 0.9978539347648621, avg_entr 0.0034539061598479748, f1 0.9778857231140137
ep19_l4_test_time 0.9696101639999597
Best AUC tensor(0.9782) 16
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 1480.688775674
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base128_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9746, AUC 0.9983347654342651, avg_entr 0.022370977327227592, f1 0.9746000170707703
l0_test_time 0.9132102390001364
gc 0
Test layer1 Acc 0.9782, AUC 0.9985384941101074, avg_entr 0.010736776515841484, f1 0.9782000184059143
l1_test_time 0.9218867780000437
gc 0
Test layer2 Acc 0.9785142857142857, AUC 0.9981280565261841, avg_entr 0.005743592977523804, f1 0.9785143136978149
l2_test_time 0.9277845479998632
gc 0
Test layer3 Acc 0.9787714285714286, AUC 0.9981546401977539, avg_entr 0.004304323811084032, f1 0.978771448135376
l3_test_time 0.9310455930001353
gc 0
Test layer4 Acc 0.9787142857142858, AUC 0.9979334473609924, avg_entr 0.0037093732971698046, f1 0.9787142872810364
l4_test_time 0.9482711550001568
gc 0
Test threshold 0.1 Acc 0.9758285714285714, AUC 0.9983334541320801, avg_entr 0.004360459744930267, f1 0.9758285880088806
t0.1_test_time 1.0215561279999292
gc 0
Test threshold 0.2 Acc 0.9747142857142858, AUC 0.9983264803886414, avg_entr 0.008290629833936691, f1 0.9747142791748047
t0.2_test_time 0.9526432239999849
gc 0
Test threshold 0.3 Acc 0.9746, AUC 0.9983347654342651, avg_entr 0.008476881310343742, f1 0.9746000170707703
t0.3_test_time 0.9491584749998765
gc 0
Test threshold 0.4 Acc 0.9746, AUC 0.9983347654342651, avg_entr 0.008476881310343742, f1 0.9746000170707703
t0.4_test_time 0.93816015099992
gc 0
Test threshold 0.5 Acc 0.9746, AUC 0.9983347654342651, avg_entr 0.008476881310343742, f1 0.9746000170707703
t0.5_test_time 0.9378204600000117
gc 0
Test threshold 0.6 Acc 0.9746, AUC 0.9983347654342651, avg_entr 0.008476881310343742, f1 0.9746000170707703
t0.6_test_time 0.9425442609999664
gc 0
Test threshold 0.7 Acc 0.9746, AUC 0.9983347654342651, avg_entr 0.008476881310343742, f1 0.9746000170707703
t0.7_test_time 0.9453709290000916
gc 0
Test threshold 0.8 Acc 0.9746, AUC 0.9983347654342651, avg_entr 0.008476881310343742, f1 0.9746000170707703
t0.8_test_time 0.9352455599998848
gc 0
Test threshold 0.9 Acc 0.9746, AUC 0.9983347654342651, avg_entr 0.008476881310343742, f1 0.9746000170707703
t0.9_test_time 0.9479762150001534
