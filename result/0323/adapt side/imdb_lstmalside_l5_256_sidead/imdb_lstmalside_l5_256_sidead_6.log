total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 48937378
init_time 23.012151048
Start Training
gc 0
Train Epoch0 Acc 0.4957 (19828/40000), AUC 0.49621331691741943
ep0_train_time 34.750621269999996
Test Epoch0 layer0 Acc 0.4986, AUC 0.5190993547439575, avg_entr 0.6853843927383423, f1 0.4986000061035156
ep0_l0_test_time 0.9018325369999971
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5002, AUC 0.492688924074173, avg_entr 0.6875919103622437, f1 0.5001999735832214
ep0_l1_test_time 0.9615205309999979
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.5008, AUC 0.49633216857910156, avg_entr 0.6885204315185547, f1 0.5008000135421753
ep0_l2_test_time 1.048126835000005
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer3 Acc 0.5012, AUC 0.5014124512672424, avg_entr 0.6855131387710571, f1 0.5012000203132629
ep0_l3_test_time 1.1813413980000078
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer4 Acc 0.502, AUC 0.5096361637115479, avg_entr 0.6897256374359131, f1 0.5019999742507935
ep0_l4_test_time 1.3979708029999927
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.4986 (19944/40000), AUC 0.4957928955554962
ep1_train_time 39.988842886
Test Epoch1 layer0 Acc 0.5004, AUC 0.5232270956039429, avg_entr 0.6909999847412109, f1 0.5004000067710876
ep1_l0_test_time 0.667921390999993
Test Epoch1 layer1 Acc 0.4996, AUC 0.49164795875549316, avg_entr 0.6918396949768066, f1 0.49959999322891235
ep1_l1_test_time 0.796352945999999
Test Epoch1 layer2 Acc 0.5026, AUC 0.504045844078064, avg_entr 0.692771315574646, f1 0.5026000142097473
ep1_l2_test_time 0.9677308209999893
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer3 Acc 0.501, AUC 0.4930321276187897, avg_entr 0.691758394241333, f1 0.5009999871253967
ep1_l3_test_time 1.223176015000007
Test Epoch1 layer4 Acc 0.502, AUC 0.5047187805175781, avg_entr 0.6912004947662354, f1 0.5019999742507935
ep1_l4_test_time 1.3964912060000074
gc 0
Train Epoch2 Acc 0.4999 (19996/40000), AUC 0.5008974671363831
ep2_train_time 40.08193435300001
Test Epoch2 layer0 Acc 0.5036, AUC 0.5284548997879028, avg_entr 0.6920754909515381, f1 0.503600001335144
ep2_l0_test_time 0.6608563009999955
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.4996, AUC 0.49950936436653137, avg_entr 0.6923161149024963, f1 0.49959999322891235
ep2_l1_test_time 0.7787410239999986
Test Epoch2 layer2 Acc 0.5038, AUC 0.5006502270698547, avg_entr 0.6918872594833374, f1 0.5037999749183655
ep2_l2_test_time 0.9563078189999885
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer3 Acc 0.502, AUC 0.49257951974868774, avg_entr 0.6928272247314453, f1 0.5019999742507935
ep2_l3_test_time 1.0913269209999896
Test Epoch2 layer4 Acc 0.5038, AUC 0.5068177580833435, avg_entr 0.6930745840072632, f1 0.5037999749183655
ep2_l4_test_time 1.3962558339999873
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.50205 (20082/40000), AUC 0.5037987232208252
ep3_train_time 34.37161532499999
Test Epoch3 layer0 Acc 0.5152, AUC 0.5315710306167603, avg_entr 0.692366361618042, f1 0.5152000188827515
ep3_l0_test_time 0.8165312769999957
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.5002, AUC 0.5016285181045532, avg_entr 0.6926213502883911, f1 0.5001999735832214
ep3_l1_test_time 0.9292310280000038
Test Epoch3 layer2 Acc 0.5092, AUC 0.5088474750518799, avg_entr 0.6933461427688599, f1 0.5091999769210815
ep3_l2_test_time 1.1485832770000002
Test Epoch3 layer3 Acc 0.502, AUC 0.4964386522769928, avg_entr 0.6927161812782288, f1 0.5019999742507935
ep3_l3_test_time 1.2983316499999944
Test Epoch3 layer4 Acc 0.5072, AUC 0.5038801431655884, avg_entr 0.6933143734931946, f1 0.5072000026702881
ep3_l4_test_time 1.5814411629999938
gc 0
Train Epoch4 Acc 0.503275 (20131/40000), AUC 0.5074623823165894
ep4_train_time 38.58728910399998
Test Epoch4 layer0 Acc 0.5172, AUC 0.5329221487045288, avg_entr 0.6925806403160095, f1 0.5171999931335449
ep4_l0_test_time 0.6657171810000193
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.5058, AUC 0.5072708129882812, avg_entr 0.6924310326576233, f1 0.5058000087738037
ep4_l1_test_time 0.8015665989999832
Test Epoch4 layer2 Acc 0.5096, AUC 0.5046085119247437, avg_entr 0.6926562786102295, f1 0.5095999836921692
ep4_l2_test_time 0.9610125410000023
Test Epoch4 layer3 Acc 0.5058, AUC 0.5037621855735779, avg_entr 0.6929670572280884, f1 0.5058000087738037
ep4_l3_test_time 1.2028033779999987
Test Epoch4 layer4 Acc 0.5078, AUC 0.5058907270431519, avg_entr 0.6932449340820312, f1 0.5077999830245972
ep4_l4_test_time 1.4278011959999901
gc 0
Train Epoch5 Acc 0.507775 (20311/40000), AUC 0.5128865242004395
ep5_train_time 39.890783895
Test Epoch5 layer0 Acc 0.5188, AUC 0.5335697531700134, avg_entr 0.6919660568237305, f1 0.5188000202178955
ep5_l0_test_time 0.6791687510000202
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.5044, AUC 0.5061442852020264, avg_entr 0.6915587186813354, f1 0.5044000148773193
ep5_l1_test_time 0.79652437499999
Test Epoch5 layer2 Acc 0.5054, AUC 0.5144224166870117, avg_entr 0.6935890913009644, f1 0.5054000020027161
ep5_l2_test_time 0.9780611190000172
Test Epoch5 layer3 Acc 0.5024, AUC 0.5013832449913025, avg_entr 0.6927124261856079, f1 0.5023999810218811
ep5_l3_test_time 1.2429395359999944
Test Epoch5 layer4 Acc 0.5072, AUC 0.509087085723877, avg_entr 0.6928760409355164, f1 0.5072000026702881
ep5_l4_test_time 1.4204574849999858
gc 0
Train Epoch6 Acc 0.507225 (20289/40000), AUC 0.512158989906311
ep6_train_time 39.93785576100004
Test Epoch6 layer0 Acc 0.5212, AUC 0.5337187647819519, avg_entr 0.6924296617507935, f1 0.5212000012397766
ep6_l0_test_time 0.6392850870000188
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.5106, AUC 0.5123884677886963, avg_entr 0.6938285231590271, f1 0.5105999708175659
ep6_l1_test_time 0.7492883919999827
Test Epoch6 layer2 Acc 0.5108, AUC 0.5189965963363647, avg_entr 0.6922188997268677, f1 0.5108000040054321
ep6_l2_test_time 0.9007394220000151
Test Epoch6 layer3 Acc 0.51, AUC 0.5071079730987549, avg_entr 0.6928097605705261, f1 0.5099999904632568
ep6_l3_test_time 1.062091138000028
Test Epoch6 layer4 Acc 0.5098, AUC 0.5105589032173157, avg_entr 0.692568302154541, f1 0.5098000168800354
ep6_l4_test_time 1.300322958000038
gc 0
Train Epoch7 Acc 0.50455 (20182/40000), AUC 0.5092403888702393
ep7_train_time 34.27812301099999
Test Epoch7 layer0 Acc 0.5152, AUC 0.5335580110549927, avg_entr 0.6915614604949951, f1 0.5152000188827515
ep7_l0_test_time 0.8926615589999756
Test Epoch7 layer1 Acc 0.509, AUC 0.5130608677864075, avg_entr 0.6932434439659119, f1 0.5090000033378601
ep7_l1_test_time 0.8724383619999685
Test Epoch7 layer2 Acc 0.506, AUC 0.5235210657119751, avg_entr 0.6913590431213379, f1 0.5059999823570251
ep7_l2_test_time 1.180164356999967
Test Epoch7 layer3 Acc 0.5082, AUC 0.5061396360397339, avg_entr 0.692488968372345, f1 0.5081999897956848
ep7_l3_test_time 1.2369616409999935
Test Epoch7 layer4 Acc 0.51, AUC 0.5061485767364502, avg_entr 0.6926025152206421, f1 0.5099999904632568
ep7_l4_test_time 1.6490417950000165
gc 0
Train Epoch8 Acc 0.508 (20320/40000), AUC 0.5127345323562622
ep8_train_time 38.38187509400001
Test Epoch8 layer0 Acc 0.5212, AUC 0.5333387851715088, avg_entr 0.6914635896682739, f1 0.5212000012397766
ep8_l0_test_time 0.6623690380000085
Save ckpt to ckpt/imdb_lstmalside_l5_256_sidead//imdb_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer1 Acc 0.5106, AUC 0.5144037008285522, avg_entr 0.6924145221710205, f1 0.5105999708175659
ep8_l1_test_time 0.7915828089999764
Test Epoch8 layer2 Acc 0.5096, AUC 0.5129372477531433, avg_entr 0.6934375762939453, f1 0.5095999836921692
ep8_l2_test_time 0.9721860459999903
Test Epoch8 layer3 Acc 0.5104, AUC 0.5062324404716492, avg_entr 0.6929974555969238, f1 0.5103999972343445
ep8_l3_test_time 1.203189569000017
Test Epoch8 layer4 Acc 0.4988, AUC 0.504378616809845, avg_entr 0.692634642124176, f1 0.49880000948905945
ep8_l4_test_time 1.4115406939999957
gc 0
Train Epoch9 Acc 0.506625 (20265/40000), AUC 0.5120557546615601
ep9_train_time 39.67511363400001
Test Epoch9 layer0 Acc 0.5168, AUC 0.533598780632019, avg_entr 0.6897867321968079, f1 0.5167999863624573
ep9_l0_test_time 0.6620338729999844
Test Epoch9 layer1 Acc 0.5068, AUC 0.51985764503479, avg_entr 0.6918480396270752, f1 0.5067999958992004
ep9_l1_test_time 0.7864585570000031
Test Epoch9 layer2 Acc 0.508, AUC 0.509736180305481, avg_entr 0.6921409964561462, f1 0.5080000162124634
ep9_l2_test_time 0.949507704000041
Test Epoch9 layer3 Acc 0.507, AUC 0.5082391500473022, avg_entr 0.6924258470535278, f1 0.5070000290870667
ep9_l3_test_time 1.2037770740000155
Test Epoch9 layer4 Acc 0.51, AUC 0.5092706680297852, avg_entr 0.6924142241477966, f1 0.5099999904632568
ep9_l4_test_time 1.4084651109999982
gc 0
Train Epoch10 Acc 0.509875 (20395/40000), AUC 0.5146548748016357
ep10_train_time 39.69748756199999
Test Epoch10 layer0 Acc 0.518, AUC 0.5342497825622559, avg_entr 0.6885846853256226, f1 0.5180000066757202
ep10_l0_test_time 0.6877847610000458
Test Epoch10 layer1 Acc 0.5088, AUC 0.5224547386169434, avg_entr 0.692182719707489, f1 0.5088000297546387
ep10_l1_test_time 0.7767659579999986
