total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 56.739786544000005
Start Training
gc 0
Train Epoch0 Acc 0.6370053571428571 (356723/560000), AUC 0.8901922106742859
ep0_train_time 65.110655466
Test Epoch0 layer4 Acc 0.9692285714285714, AUC 0.9977235198020935, avg_entr 0.3142235577106476, f1 0.9692285656929016
ep0_l4_test_time 1.5556654309999942
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9742107142857143 (545558/560000), AUC 0.9983376860618591
ep1_train_time 62.92405120199999
Test Epoch1 layer4 Acc 0.9727142857142858, AUC 0.9983658790588379, avg_entr 0.1262921541929245, f1 0.9727143049240112
ep1_l4_test_time 1.5316347440000015
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9768839285714286 (547055/560000), AUC 0.9988330602645874
ep2_train_time 62.87603489200001
Test Epoch2 layer4 Acc 0.9740857142857143, AUC 0.9985089898109436, avg_entr 0.07164782285690308, f1 0.9740856885910034
ep2_l4_test_time 1.5262055439999926
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9785428571428572 (547984/560000), AUC 0.9989802241325378
ep3_train_time 62.792463072000004
Test Epoch3 layer4 Acc 0.9744285714285714, AUC 0.9984909892082214, avg_entr 0.04821084812283516, f1 0.9744285941123962
ep3_l4_test_time 1.5330105159999903
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9795625 (548555/560000), AUC 0.9990124106407166
ep4_train_time 62.727979758000004
Test Epoch4 layer4 Acc 0.9751428571428571, AUC 0.9983978271484375, avg_entr 0.03364686667919159, f1 0.9751428365707397
ep4_l4_test_time 1.5302811950000432
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9801857142857143 (548904/560000), AUC 0.9989637732505798
ep5_train_time 62.36456306600002
Test Epoch5 layer4 Acc 0.9756571428571429, AUC 0.9981756806373596, avg_entr 0.024409618228673935, f1 0.9756571650505066
ep5_l4_test_time 1.5534567349999975
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9807196428571429 (549203/560000), AUC 0.9988829493522644
ep6_train_time 63.62433449700001
Test Epoch6 layer4 Acc 0.9756285714285714, AUC 0.9980019927024841, avg_entr 0.018779003992676735, f1 0.9756285548210144
ep6_l4_test_time 1.5514977729999941
gc 0
Train Epoch7 Acc 0.9810267857142857 (549375/560000), AUC 0.9987862706184387
ep7_train_time 62.785794618999944
Test Epoch7 layer4 Acc 0.9758857142857142, AUC 0.997868537902832, avg_entr 0.015219070948660374, f1 0.9758856892585754
ep7_l4_test_time 1.539213499000084
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9813589285714286 (549561/560000), AUC 0.9987208247184753
ep8_train_time 62.69899217699992
Test Epoch8 layer4 Acc 0.9759428571428571, AUC 0.9975911378860474, avg_entr 0.012838965281844139, f1 0.975942850112915
ep8_l4_test_time 1.559445123000046
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9815017857142857 (549641/560000), AUC 0.998662531375885
ep9_train_time 62.945086932000095
Test Epoch9 layer4 Acc 0.9762571428571428, AUC 0.9975813627243042, avg_entr 0.01121688075363636, f1 0.9762571454048157
ep9_l4_test_time 1.4983744859999888
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.98165 (549724/560000), AUC 0.9986556172370911
ep10_train_time 62.26750946599998
Test Epoch10 layer4 Acc 0.9760285714285715, AUC 0.9975165128707886, avg_entr 0.010133598931133747, f1 0.976028561592102
ep10_l4_test_time 1.4899977569999692
gc 0
Train Epoch11 Acc 0.9819517857142858 (549893/560000), AUC 0.9986360669136047
ep11_train_time 60.953383453000015
Test Epoch11 layer4 Acc 0.9764571428571429, AUC 0.9974044561386108, avg_entr 0.008978389203548431, f1 0.9764571189880371
ep11_l4_test_time 1.2098531959999264
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9820589285714286 (549953/560000), AUC 0.9986220598220825
ep12_train_time 56.30912509799998
Test Epoch12 layer4 Acc 0.9762571428571428, AUC 0.9973952174186707, avg_entr 0.00836552307009697, f1 0.9762571454048157
ep12_l4_test_time 1.5714819169999146
gc 0
Train Epoch13 Acc 0.9821803571428571 (550021/560000), AUC 0.9986170530319214
ep13_train_time 62.88230460400007
Test Epoch13 layer4 Acc 0.9761714285714286, AUC 0.9973321557044983, avg_entr 0.0076333340257406235, f1 0.9761714339256287
ep13_l4_test_time 1.5538777379999829
gc 0
Train Epoch14 Acc 0.982325 (550102/560000), AUC 0.9986239671707153
ep14_train_time 62.745544329999916
Test Epoch14 layer4 Acc 0.9762, AUC 0.9972761273384094, avg_entr 0.0070793177001178265, f1 0.9761999845504761
ep14_l4_test_time 1.532787624999969
gc 0
Train Epoch15 Acc 0.982425 (550158/560000), AUC 0.9985968470573425
ep15_train_time 62.45727953099993
Test Epoch15 layer4 Acc 0.9764571428571429, AUC 0.9973198771476746, avg_entr 0.006619659252464771, f1 0.9764571189880371
ep15_l4_test_time 1.5351434699998663
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 15
gc 0
Train Epoch16 Acc 0.9826446428571428 (550281/560000), AUC 0.9985828399658203
ep16_train_time 62.449635644999944
Test Epoch16 layer4 Acc 0.9765142857142857, AUC 0.9972949624061584, avg_entr 0.006309380289167166, f1 0.9765142798423767
ep16_l4_test_time 1.533598505999862
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.9827410714285715 (550335/560000), AUC 0.9985882043838501
ep17_train_time 63.10465934900003
Test Epoch17 layer4 Acc 0.9765428571428572, AUC 0.9971749186515808, avg_entr 0.006055655423551798, f1 0.9765428304672241
ep17_l4_test_time 1.5352870560000156
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 17
gc 0
Train Epoch18 Acc 0.9829053571428571 (550427/560000), AUC 0.9985910058021545
ep18_train_time 62.89279539600011
Test Epoch18 layer4 Acc 0.9766, AUC 0.9972467422485352, avg_entr 0.0057631912641227245, f1 0.9765999913215637
ep18_l4_test_time 1.5506094140000641
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 18
gc 0
Train Epoch19 Acc 0.9830660714285714 (550517/560000), AUC 0.9985639452934265
ep19_train_time 62.670602938
Test Epoch19 layer4 Acc 0.9766571428571429, AUC 0.9972779154777527, avg_entr 0.0056359777227044106, f1 0.9766571521759033
ep19_l4_test_time 1.5571594259999983
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 19
Best AUC tensor(0.9767) 19
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 1281.816103094
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9740285714285715, AUC 0.998252809047699, avg_entr 0.02490280754864216, f1 0.9740285873413086
l0_test_time 1.5430373090000558
gc 0
Test layer1 Acc 0.9751714285714286, AUC 0.9984535574913025, avg_entr 0.019193010404706, f1 0.9751714468002319
l1_test_time 1.5281511890000274
gc 0
Test layer2 Acc 0.9765428571428572, AUC 0.998197615146637, avg_entr 0.011204303242266178, f1 0.9765428304672241
l2_test_time 1.5337120350000077
gc 0
Test layer3 Acc 0.9766, AUC 0.9979315996170044, avg_entr 0.007676579989492893, f1 0.9765999913215637
l3_test_time 1.5084905999999592
gc 0
Test layer4 Acc 0.9768285714285714, AUC 0.9975102543830872, avg_entr 0.006383967120200396, f1 0.9768285751342773
l4_test_time 1.5375111320001906
gc 0
Test threshold 0.1 Acc 0.9747428571428571, AUC 0.9982835054397583, avg_entr 0.0055269235745072365, f1 0.9747428297996521
t0.1_test_time 5.532270192999931
gc 0
Test threshold 0.2 Acc 0.9739428571428571, AUC 0.9982528686523438, avg_entr 0.009213583543896675, f1 0.9739428758621216
t0.2_test_time 3.8300714900001367
gc 0
Test threshold 0.3 Acc 0.9740285714285715, AUC 0.998252809047699, avg_entr 0.00943625159561634, f1 0.9740285873413086
t0.3_test_time 2.9377878830000554
gc 0
Test threshold 0.4 Acc 0.9740285714285715, AUC 0.998252809047699, avg_entr 0.00943625159561634, f1 0.9740285873413086
t0.4_test_time 2.9685655650000626
gc 0
Test threshold 0.5 Acc 0.9740285714285715, AUC 0.998252809047699, avg_entr 0.00943625159561634, f1 0.9740285873413086
t0.5_test_time 2.8550932689997808
gc 0
Test threshold 0.6 Acc 0.9740285714285715, AUC 0.998252809047699, avg_entr 0.00943625159561634, f1 0.9740285873413086
t0.6_test_time 3.0283335940000597
gc 0
Test threshold 0.7 Acc 0.9740285714285715, AUC 0.998252809047699, avg_entr 0.00943625159561634, f1 0.9740285873413086
t0.7_test_time 2.9512492010001097
gc 0
Test threshold 0.8 Acc 0.9740285714285715, AUC 0.998252809047699, avg_entr 0.00943625159561634, f1 0.9740285873413086
t0.8_test_time 2.914772482999979
gc 0
Test threshold 0.9 Acc 0.9740285714285715, AUC 0.998252809047699, avg_entr 0.00943625159561634, f1 0.9740285873413086
t0.9_test_time 3.000197493999849
