total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 55.275756376
Start Training
gc 0
Train Epoch0 Acc 0.6005857142857143 (336328/560000), AUC 0.8757723569869995
ep0_train_time 53.337183108
Test Epoch0 layer4 Acc 0.9695714285714285, AUC 0.9976494908332825, avg_entr 0.3201861083507538, f1 0.9695714116096497
ep0_l4_test_time 1.354328119999991
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9743607142857142 (545642/560000), AUC 0.9982903599739075
ep1_train_time 49.52752701599999
Test Epoch1 layer4 Acc 0.9735142857142857, AUC 0.9983300566673279, avg_entr 0.12629081308841705, f1 0.9735142588615417
ep1_l4_test_time 1.2162956180000037
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9771071428571428 (547180/560000), AUC 0.9988274574279785
ep2_train_time 47.627417557
Test Epoch2 layer4 Acc 0.9744571428571429, AUC 0.9985419511795044, avg_entr 0.07596929371356964, f1 0.9744571447372437
ep2_l4_test_time 1.2699565450000136
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.97855 (547988/560000), AUC 0.9989861249923706
ep3_train_time 48.257998414000014
Test Epoch3 layer4 Acc 0.9750857142857143, AUC 0.9985317587852478, avg_entr 0.04867182672023773, f1 0.9750857353210449
ep3_l4_test_time 1.2128511370000297
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.979625 (548590/560000), AUC 0.9990465044975281
ep4_train_time 46.729251164999994
Test Epoch4 layer4 Acc 0.9761142857142857, AUC 0.9984363913536072, avg_entr 0.0345822274684906, f1 0.9761142730712891
ep4_l4_test_time 1.2541222689999927
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9801303571428571 (548873/560000), AUC 0.9989752173423767
ep5_train_time 50.96313380099997
Test Epoch5 layer4 Acc 0.9756, AUC 0.9982433319091797, avg_entr 0.0261391568928957, f1 0.975600004196167
ep5_l4_test_time 1.3656611179999913
gc 0
Train Epoch6 Acc 0.9806482142857142 (549163/560000), AUC 0.9988642334938049
ep6_train_time 49.60835340599999
Test Epoch6 layer4 Acc 0.9755142857142857, AUC 0.9982022047042847, avg_entr 0.020233726128935814, f1 0.97551429271698
ep6_l4_test_time 1.2704261060000022
gc 0
Train Epoch7 Acc 0.9810803571428571 (549405/560000), AUC 0.9988110661506653
ep7_train_time 46.85646638700001
Test Epoch7 layer4 Acc 0.9756285714285714, AUC 0.997986912727356, avg_entr 0.01621105521917343, f1 0.9756285548210144
ep7_l4_test_time 1.2533200760000227
gc 0
Train Epoch8 Acc 0.9813178571428571 (549538/560000), AUC 0.9987272024154663
ep8_train_time 47.09149217700002
Test Epoch8 layer4 Acc 0.9764, AUC 0.9979209303855896, avg_entr 0.013229500502347946, f1 0.9764000177383423
ep8_l4_test_time 1.254157604999989
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9816446428571428 (549721/560000), AUC 0.9987195730209351
ep9_train_time 47.429134119000025
Test Epoch9 layer4 Acc 0.9762, AUC 0.9978747367858887, avg_entr 0.01164196990430355, f1 0.9761999845504761
ep9_l4_test_time 1.2987277899999299
gc 0
Train Epoch10 Acc 0.9818464285714286 (549834/560000), AUC 0.998711109161377
ep10_train_time 49.546923936999974
Test Epoch10 layer4 Acc 0.9766857142857143, AUC 0.9978105425834656, avg_entr 0.010276328772306442, f1 0.9766857028007507
ep10_l4_test_time 1.29114108400006
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9820482142857143 (549947/560000), AUC 0.9986676573753357
ep11_train_time 49.86054832000002
Test Epoch11 layer4 Acc 0.9764857142857143, AUC 0.9977531433105469, avg_entr 0.009239163249731064, f1 0.9764857292175293
ep11_l4_test_time 1.2436883670000043
gc 0
Train Epoch12 Acc 0.9822607142857143 (550066/560000), AUC 0.9986497163772583
ep12_train_time 47.76589446899993
Test Epoch12 layer4 Acc 0.9766285714285714, AUC 0.9976617097854614, avg_entr 0.008368974551558495, f1 0.9766285419464111
ep12_l4_test_time 1.2117507610000757
gc 0
Train Epoch13 Acc 0.9823410714285714 (550111/560000), AUC 0.9986332654953003
ep13_train_time 46.52575059399999
Test Epoch13 layer4 Acc 0.9770857142857143, AUC 0.9977144598960876, avg_entr 0.007642365526407957, f1 0.9770857095718384
ep13_l4_test_time 1.3037643300000354
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.9825035714285715 (550202/560000), AUC 0.9986239075660706
ep14_train_time 50.083934408999994
Test Epoch14 layer4 Acc 0.9765142857142857, AUC 0.9977219700813293, avg_entr 0.007075204513967037, f1 0.9765142798423767
ep14_l4_test_time 1.3575305049999997
gc 0
Train Epoch15 Acc 0.9826482142857142 (550283/560000), AUC 0.9985999464988708
ep15_train_time 49.842012250999915
Test Epoch15 layer4 Acc 0.9769142857142857, AUC 0.997710645198822, avg_entr 0.006527264602482319, f1 0.9769142866134644
ep15_l4_test_time 1.1833046989999048
gc 0
Train Epoch16 Acc 0.9828178571428572 (550378/560000), AUC 0.9985891580581665
ep16_train_time 48.131563914000026
Test Epoch16 layer4 Acc 0.9768571428571429, AUC 0.9976845383644104, avg_entr 0.0063782366923987865, f1 0.9768571257591248
ep16_l4_test_time 1.2877519310000025
gc 0
Train Epoch17 Acc 0.98295 (550452/560000), AUC 0.9985928535461426
ep17_train_time 48.61654872899999
Test Epoch17 layer4 Acc 0.9769428571428571, AUC 0.9976462721824646, avg_entr 0.006093308795243502, f1 0.9769428372383118
ep17_l4_test_time 1.1391932100000304
gc 0
Train Epoch18 Acc 0.9830303571428571 (550497/560000), AUC 0.9985836744308472
ep18_train_time 46.358660665
Test Epoch18 layer4 Acc 0.9771714285714286, AUC 0.9976888298988342, avg_entr 0.005909408908337355, f1 0.9771714210510254
ep18_l4_test_time 1.1372259869999652
Save ckpt to ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt  ,ep 18
gc 0
Train Epoch19 Acc 0.9831910714285714 (550587/560000), AUC 0.998585045337677
ep19_train_time 42.550186489
Test Epoch19 layer4 Acc 0.9768571428571429, AUC 0.9977344870567322, avg_entr 0.005630742758512497, f1 0.9768571257591248
ep19_l4_test_time 1.0116664730001048
Best AUC tensor(0.9772) 18
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 993.252606315
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5base512_pad80//dbpedia_14_linearal_l5.pt
gc 10
Test layer0 Acc 0.9742285714285714, AUC 0.998282790184021, avg_entr 0.02555887959897518, f1 0.97422856092453
l0_test_time 1.0087177620000602
gc 0
Test layer1 Acc 0.9747428571428571, AUC 0.9984578490257263, avg_entr 0.019813107326626778, f1 0.9747428297996521
l1_test_time 1.0477795179999703
gc 0
Test layer2 Acc 0.9765142857142857, AUC 0.9983386993408203, avg_entr 0.011405379511415958, f1 0.9765142798423767
l2_test_time 1.303563979000046
gc 0
Test layer3 Acc 0.9769142857142857, AUC 0.998016357421875, avg_entr 0.0078717190772295, f1 0.9769142866134644
l3_test_time 1.335637234999922
gc 0
Test layer4 Acc 0.9772, AUC 0.9976885914802551, avg_entr 0.0063342624343931675, f1 0.977199912071228
l4_test_time 1.3497888659999262
gc 0
Test threshold 0.1 Acc 0.9746571428571429, AUC 0.9982777833938599, avg_entr 0.00577733526006341, f1 0.9746571183204651
t0.1_test_time 2.690267995000113
gc 0
Test threshold 0.2 Acc 0.9743142857142857, AUC 0.9982843995094299, avg_entr 0.00944855809211731, f1 0.974314272403717
t0.2_test_time 2.390789831999882
gc 0
Test threshold 0.3 Acc 0.9742, AUC 0.998282790184021, avg_entr 0.009679674170911312, f1 0.9742000102996826
t0.3_test_time 1.9442571919998954
gc 0
Test threshold 0.4 Acc 0.9742285714285714, AUC 0.998282790184021, avg_entr 0.009684852324426174, f1 0.97422856092453
t0.4_test_time 1.9284832069999993
gc 0
Test threshold 0.5 Acc 0.9742285714285714, AUC 0.998282790184021, avg_entr 0.009684852324426174, f1 0.97422856092453
t0.5_test_time 1.9752560759998232
gc 0
Test threshold 0.6 Acc 0.9742285714285714, AUC 0.998282790184021, avg_entr 0.009684852324426174, f1 0.97422856092453
t0.6_test_time 1.9520885360000193
gc 0
Test threshold 0.7 Acc 0.9742285714285714, AUC 0.998282790184021, avg_entr 0.009684852324426174, f1 0.97422856092453
t0.7_test_time 1.8587348769999608
gc 0
Test threshold 0.8 Acc 0.9742285714285714, AUC 0.998282790184021, avg_entr 0.009684852324426174, f1 0.97422856092453
t0.8_test_time 1.7620926120000604
gc 0
Test threshold 0.9 Acc 0.9742285714285714, AUC 0.998282790184021, avg_entr 0.009684852324426174, f1 0.97422856092453
t0.9_test_time 1.7962912349998987
