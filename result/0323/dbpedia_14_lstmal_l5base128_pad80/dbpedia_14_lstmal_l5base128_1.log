total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 88.92133295000001
Start Training
gc 0
Train Epoch0 Acc 0.9044178571428572 (506474/560000), AUC 0.9898069500923157
ep0_train_time 367.387600138
Test Epoch0 layer4 Acc 0.9813714285714286, AUC 0.9972577095031738, avg_entr 0.022032003849744797, f1 0.9813714027404785
ep0_l4_test_time 6.436177532999977
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9849 (551544/560000), AUC 0.9972869157791138
ep1_train_time 343.89811467000004
Test Epoch1 layer4 Acc 0.9838285714285714, AUC 0.9971314072608948, avg_entr 0.004691631067544222, f1 0.9838285446166992
ep1_l4_test_time 6.059655439000039
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9870053571428572 (552723/560000), AUC 0.9978159666061401
ep2_train_time 381.567985559
Test Epoch2 layer4 Acc 0.9844857142857143, AUC 0.9975748062133789, avg_entr 0.002765031298622489, f1 0.9844856858253479
ep2_l4_test_time 6.579038446999903
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9882946428571429 (553445/560000), AUC 0.9981566667556763
ep3_train_time 344.6850787340002
Test Epoch3 layer4 Acc 0.985, AUC 0.9978445768356323, avg_entr 0.0018204335356131196, f1 0.9850000143051147
ep3_l4_test_time 6.654845684999827
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9894482142857143 (554091/560000), AUC 0.998440682888031
ep4_train_time 366.1631936440001
Test Epoch4 layer4 Acc 0.9857714285714285, AUC 0.9977916479110718, avg_entr 0.0016080992063507438, f1 0.9857714176177979
ep4_l4_test_time 6.060642984999959
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9904732142857143 (554665/560000), AUC 0.9986934661865234
ep5_train_time 382.07317116800004
Test Epoch5 layer4 Acc 0.9857428571428571, AUC 0.9979513883590698, avg_entr 0.0014981906861066818, f1 0.9857428669929504
ep5_l4_test_time 6.376446251999823
gc 0
Train Epoch6 Acc 0.9912321428571429 (555090/560000), AUC 0.9988517761230469
ep6_train_time 356.95430026199983
Test Epoch6 layer4 Acc 0.9860571428571429, AUC 0.9976766705513, avg_entr 0.001248056534677744, f1 0.9860571622848511
ep6_l4_test_time 6.792997801999718
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9919892857142857 (555514/560000), AUC 0.9989286661148071
ep7_train_time 394.8245116359999
Test Epoch7 layer4 Acc 0.9856, AUC 0.9977186322212219, avg_entr 0.0013822950422763824, f1 0.9855999946594238
ep7_l4_test_time 6.450434491000124
gc 0
Train Epoch8 Acc 0.9926 (555856/560000), AUC 0.9990085959434509
ep8_train_time 379.08707194399994
Test Epoch8 layer4 Acc 0.9858571428571429, AUC 0.9979357719421387, avg_entr 0.0011859301012009382, f1 0.9858571290969849
ep8_l4_test_time 6.611027375000049
gc 0
Train Epoch9 Acc 0.9932071428571428 (556196/560000), AUC 0.9990109801292419
ep9_train_time 394.66463745600004
Test Epoch9 layer4 Acc 0.9858571428571429, AUC 0.9976663589477539, avg_entr 0.0010444658109918237, f1 0.9858571290969849
ep9_l4_test_time 6.820696028999919
gc 0
Train Epoch10 Acc 0.9937410714285714 (556495/560000), AUC 0.9990168213844299
ep10_train_time 382.13501364900003
Test Epoch10 layer4 Acc 0.9859714285714286, AUC 0.997581958770752, avg_entr 0.0011950242333114147, f1 0.9859714508056641
ep10_l4_test_time 6.394660555000883
gc 0
Train Epoch11 Acc 0.9942214285714286 (556764/560000), AUC 0.9990382194519043
ep11_train_time 394.28936019999946
Test Epoch11 layer4 Acc 0.9858571428571429, AUC 0.9974766373634338, avg_entr 0.0010216155787929893, f1 0.9858571290969849
ep11_l4_test_time 6.605425507999826
gc 0
Train Epoch12 Acc 0.9946839285714286 (557023/560000), AUC 0.9990658760070801
ep12_train_time 379.8022377469997
Test Epoch12 layer4 Acc 0.9842, AUC 0.9970134496688843, avg_entr 0.0011659669689834118, f1 0.9842000007629395
ep12_l4_test_time 6.742314863000502
gc 0
Train Epoch13 Acc 0.9951696428571428 (557295/560000), AUC 0.9990329742431641
ep13_train_time 395.05010795199996
Test Epoch13 layer4 Acc 0.9852571428571428, AUC 0.9969657063484192, avg_entr 0.0008582722512073815, f1 0.9852571487426758
ep13_l4_test_time 6.373023275999913
gc 0
Train Epoch14 Acc 0.9955214285714286 (557492/560000), AUC 0.9990218281745911
ep14_train_time 382.2508879809993
Test Epoch14 layer4 Acc 0.9853714285714286, AUC 0.9968643188476562, avg_entr 0.000924656807910651, f1 0.9853714108467102
ep14_l4_test_time 6.547018948000186
gc 0
Train Epoch15 Acc 0.9958303571428572 (557665/560000), AUC 0.9990280270576477
ep15_train_time 394.26419568800065
Test Epoch15 layer4 Acc 0.9849428571428571, AUC 0.9966121315956116, avg_entr 0.0007829874521121383, f1 0.9849428534507751
ep15_l4_test_time 6.763757065000391
gc 0
Train Epoch16 Acc 0.9960803571428571 (557805/560000), AUC 0.9990274310112
ep16_train_time 380.62342492399966
Test Epoch16 layer4 Acc 0.9855428571428572, AUC 0.9965394735336304, avg_entr 0.0008158690179698169, f1 0.9855428338050842
ep16_l4_test_time 6.370664981000118
gc 0
Train Epoch17 Acc 0.9964214285714286 (557996/560000), AUC 0.9990281462669373
ep17_train_time 395.24415632599994
Test Epoch17 layer4 Acc 0.9854285714285714, AUC 0.9962830543518066, avg_entr 0.0006900118314661086, f1 0.9854285717010498
ep17_l4_test_time 6.5724285639998925
gc 0
Train Epoch18 Acc 0.9966607142857142 (558130/560000), AUC 0.9990116357803345
ep18_train_time 381.9851714409997
Test Epoch18 layer4 Acc 0.985, AUC 0.996009886264801, avg_entr 0.0007981772650964558, f1 0.9850000143051147
ep18_l4_test_time 6.666917882000234
gc 0
Train Epoch19 Acc 0.9967982142857142 (558207/560000), AUC 0.9990464448928833
ep19_train_time 396.3550776310003
Test Epoch19 layer4 Acc 0.9852285714285715, AUC 0.9956015944480896, avg_entr 0.0007483088411390781, f1 0.9852285981178284
ep19_l4_test_time 5.498199024999849
Best AUC tensor(0.9861) 6
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 7725.167620179001
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9741142857142857, AUC 0.9982894659042358, avg_entr 0.023644575849175453, f1 0.9741142988204956
l0_test_time 1.5836807400000907
gc 0
Test layer1 Acc 0.9858285714285714, AUC 0.9987208247184753, avg_entr 0.002235478488728404, f1 0.9858285784721375
l1_test_time 2.3425522460001957
gc 0
Test layer2 Acc 0.9858571428571429, AUC 0.9986622929573059, avg_entr 0.0017371458234265447, f1 0.9858571290969849
l2_test_time 2.9615059460002158
gc 0
Test layer3 Acc 0.986, AUC 0.9982092976570129, avg_entr 0.0015168661484494805, f1 0.9860000014305115
l3_test_time 3.599284365999665
gc 0
Test layer4 Acc 0.9858571428571429, AUC 0.9977585673332214, avg_entr 0.0014691523974761367, f1 0.9858571290969849
l4_test_time 4.369797063999613
gc 0
Test threshold 0.1 Acc 0.9776857142857143, AUC 0.9982541799545288, avg_entr 0.0038498251233249903, f1 0.9776856899261475
t0.1_test_time 2.5555129949998445
gc 0
Test threshold 0.2 Acc 0.9746571428571429, AUC 0.9982872605323792, avg_entr 0.008626377210021019, f1 0.9746571183204651
t0.2_test_time 1.7975425559998257
gc 0
Test threshold 0.3 Acc 0.9741142857142857, AUC 0.9982894659042358, avg_entr 0.00895947776734829, f1 0.9741142988204956
t0.3_test_time 3.6502248920005513
gc 0
Test threshold 0.4 Acc 0.9741142857142857, AUC 0.9982894659042358, avg_entr 0.00895947776734829, f1 0.9741142988204956
t0.4_test_time 3.6442381429997113
gc 0
Test threshold 0.5 Acc 0.9741142857142857, AUC 0.9982894659042358, avg_entr 0.00895947776734829, f1 0.9741142988204956
t0.5_test_time 3.4892436319996705
gc 0
Test threshold 0.6 Acc 0.9741142857142857, AUC 0.9982894659042358, avg_entr 0.00895947776734829, f1 0.9741142988204956
t0.6_test_time 3.3268386829995507
gc 0
Test threshold 0.7 Acc 0.9741142857142857, AUC 0.9982894659042358, avg_entr 0.00895947776734829, f1 0.9741142988204956
t0.7_test_time 3.2126517060005426
gc 0
Test threshold 0.8 Acc 0.9741142857142857, AUC 0.9982894659042358, avg_entr 0.00895947776734829, f1 0.9741142988204956
t0.8_test_time 3.2386645249998764
gc 0
Test threshold 0.9 Acc 0.9741142857142857, AUC 0.9982894659042358, avg_entr 0.00895947776734829, f1 0.9741142988204956
t0.9_test_time 2.8557719870004803
