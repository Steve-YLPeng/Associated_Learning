total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 54.51431147700001
Start Training
gc 0
Train Epoch0 Acc 0.9046267857142857 (506591/560000), AUC 0.9901633262634277
ep0_train_time 248.32833459900002
Test Epoch0 layer4 Acc 0.9813714285714286, AUC 0.9975990056991577, avg_entr 0.02240191586315632, f1 0.9813714027404785
ep0_l4_test_time 3.7145524890000274
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9849089285714285 (551549/560000), AUC 0.9974650144577026
ep1_train_time 246.71342218299998
Test Epoch1 layer4 Acc 0.9840285714285715, AUC 0.9977149963378906, avg_entr 0.004958760924637318, f1 0.9840285778045654
ep1_l4_test_time 3.7542257390000486
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9871464285714285 (552802/560000), AUC 0.9979773163795471
ep2_train_time 276.261745709
Test Epoch2 layer4 Acc 0.9843142857142857, AUC 0.9975959062576294, avg_entr 0.00223371060565114, f1 0.9843142628669739
ep2_l4_test_time 4.91953512300006
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9885214285714286 (553572/560000), AUC 0.9982472062110901
ep3_train_time 303.32485847099997
Test Epoch3 layer4 Acc 0.9852857142857143, AUC 0.9978218078613281, avg_entr 0.0016534441383555532, f1 0.9852856993675232
ep3_l4_test_time 4.751136450999866
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9895714285714285 (554160/560000), AUC 0.9984637498855591
ep4_train_time 308.20023770600005
Test Epoch4 layer4 Acc 0.9853428571428572, AUC 0.9979719519615173, avg_entr 0.00150119059253484, f1 0.9853428602218628
ep4_l4_test_time 4.837800363999804
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9905392857142857 (554702/560000), AUC 0.9986871480941772
ep5_train_time 303.1324228589999
Test Epoch5 layer4 Acc 0.9859142857142857, AUC 0.997862696647644, avg_entr 0.001581814605742693, f1 0.9859142899513245
ep5_l4_test_time 4.8410309240000515
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9913375 (555149/560000), AUC 0.9988203644752502
ep6_train_time 308.7683712860003
Test Epoch6 layer4 Acc 0.9862, AUC 0.9977155923843384, avg_entr 0.0012584154028445482, f1 0.9861999750137329
ep6_l4_test_time 4.834543622000183
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9919035714285714 (555466/560000), AUC 0.9988936185836792
ep7_train_time 297.98554978799984
Test Epoch7 layer4 Acc 0.9857428571428571, AUC 0.9978944659233093, avg_entr 0.0013392824912443757, f1 0.9857428669929504
ep7_l4_test_time 3.637500359999649
gc 0
Train Epoch8 Acc 0.992625 (555870/560000), AUC 0.9989283680915833
ep8_train_time 245.57058442300013
Test Epoch8 layer4 Acc 0.9859142857142857, AUC 0.9978933334350586, avg_entr 0.0013123201206326485, f1 0.9859142899513245
ep8_l4_test_time 3.6161241419999897
gc 0
Train Epoch9 Acc 0.9931660714285714 (556173/560000), AUC 0.9989224672317505
ep9_train_time 245.55021182200016
Test Epoch9 layer4 Acc 0.9862285714285715, AUC 0.9976410269737244, avg_entr 0.00123547890689224, f1 0.9862285852432251
ep9_l4_test_time 3.6441368460000376
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.9936714285714285 (556456/560000), AUC 0.9989537596702576
ep10_train_time 245.9239533050004
Test Epoch10 layer4 Acc 0.9863142857142857, AUC 0.9975816011428833, avg_entr 0.0010447453241795301, f1 0.9863142967224121
ep10_l4_test_time 3.6601393709997865
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9942678571428571 (556790/560000), AUC 0.998985230922699
ep11_train_time 245.8880524919996
Test Epoch11 layer4 Acc 0.9858571428571429, AUC 0.9975413084030151, avg_entr 0.001050252583809197, f1 0.9858571290969849
ep11_l4_test_time 3.6861350539998057
gc 0
Train Epoch12 Acc 0.9942160714285714 (556761/560000), AUC 0.9986978769302368
ep12_train_time 245.83962386799976
Test Epoch12 layer4 Acc 0.9854857142857143, AUC 0.9973468780517578, avg_entr 0.0010663935681805015, f1 0.9854857325553894
ep12_l4_test_time 3.5878566769997633
gc 0
Train Epoch13 Acc 0.99515 (557284/560000), AUC 0.999055027961731
ep13_train_time 245.82954337599995
Test Epoch13 layer4 Acc 0.9863714285714286, AUC 0.997316837310791, avg_entr 0.0009631271241232753, f1 0.9863714575767517
ep13_l4_test_time 3.6537775870001497
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.9955803571428572 (557525/560000), AUC 0.9990686774253845
ep14_train_time 246.37240139700043
Test Epoch14 layer4 Acc 0.9854857142857143, AUC 0.9971681833267212, avg_entr 0.00085578637663275, f1 0.9854857325553894
ep14_l4_test_time 3.6371843870001612
gc 0
Train Epoch15 Acc 0.9958946428571429 (557701/560000), AUC 0.9990840554237366
ep15_train_time 246.1006097339996
Test Epoch15 layer4 Acc 0.9852571428571428, AUC 0.9970012307167053, avg_entr 0.0008703841012902558, f1 0.9852571487426758
ep15_l4_test_time 3.6015841580001506
gc 0
Train Epoch16 Acc 0.9962303571428571 (557889/560000), AUC 0.9991270899772644
ep16_train_time 246.41551282199998
Test Epoch16 layer4 Acc 0.9856, AUC 0.9968395829200745, avg_entr 0.0007905138772912323, f1 0.9855999946594238
ep16_l4_test_time 3.6956873780000024
gc 0
Train Epoch17 Acc 0.9964803571428571 (558029/560000), AUC 0.9991267323493958
ep17_train_time 246.68677397600004
Test Epoch17 layer4 Acc 0.9850857142857142, AUC 0.9966887831687927, avg_entr 0.0007628300227224827, f1 0.9850857257843018
ep17_l4_test_time 3.6319897699995636
gc 0
Train Epoch18 Acc 0.9967053571428571 (558155/560000), AUC 0.999170184135437
ep18_train_time 267.29100112300057
Test Epoch18 layer4 Acc 0.9856285714285714, AUC 0.9966482520103455, avg_entr 0.0006720329402014613, f1 0.9856285452842712
ep18_l4_test_time 6.439388239000436
gc 0
Train Epoch19 Acc 0.9968767857142857 (558251/560000), AUC 0.9992098212242126
ep19_train_time 335.6524970390001
Test Epoch19 layer4 Acc 0.9854, AUC 0.9967138171195984, avg_entr 0.0007624282734468579, f1 0.9854000210762024
ep19_l4_test_time 3.737906817000294
Best AUC tensor(0.9864) 13
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 5439.956988504
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9744285714285714, AUC 0.9983119964599609, avg_entr 0.023320289328694344, f1 0.9744285941123962
l0_test_time 1.1098279320003712
gc 0
Test layer1 Acc 0.9857142857142858, AUC 0.9980128407478333, avg_entr 0.0017374282469972968, f1 0.9857142567634583
l1_test_time 1.6683855339997535
gc 0
Test layer2 Acc 0.9854571428571428, AUC 0.9978756308555603, avg_entr 0.0012186230160295963, f1 0.9854571223258972
l2_test_time 2.45579634600017
gc 0
Test layer3 Acc 0.9854571428571428, AUC 0.9979915022850037, avg_entr 0.0011184600880369544, f1 0.9854571223258972
l3_test_time 4.591660201000195
gc 0
Test layer4 Acc 0.9854571428571428, AUC 0.9974018931388855, avg_entr 0.0010005147196352482, f1 0.9854571223258972
l4_test_time 6.789367057000163
gc 0
Test threshold 0.1 Acc 0.9779428571428571, AUC 0.9981714487075806, avg_entr 0.003718265099450946, f1 0.9779428839683533
t0.1_test_time 4.2908386429999155
gc 0
Test threshold 0.2 Acc 0.9749142857142857, AUC 0.998308539390564, avg_entr 0.008530380204319954, f1 0.9749143123626709
t0.2_test_time 2.846346815000288
gc 0
Test threshold 0.3 Acc 0.9744285714285714, AUC 0.9983119964599609, avg_entr 0.008836598135530949, f1 0.9744285941123962
t0.3_test_time 2.552677630999824
gc 0
Test threshold 0.4 Acc 0.9744285714285714, AUC 0.9983119964599609, avg_entr 0.008836598135530949, f1 0.9744285941123962
t0.4_test_time 2.380447417999676
gc 0
Test threshold 0.5 Acc 0.9744285714285714, AUC 0.9983119964599609, avg_entr 0.008836598135530949, f1 0.9744285941123962
t0.5_test_time 3.2935338560000673
gc 0
Test threshold 0.6 Acc 0.9744285714285714, AUC 0.9983119964599609, avg_entr 0.008836598135530949, f1 0.9744285941123962
t0.6_test_time 3.320567321999988
gc 0
Test threshold 0.7 Acc 0.9744285714285714, AUC 0.9983119964599609, avg_entr 0.008836598135530949, f1 0.9744285941123962
t0.7_test_time 2.9955308689995945
gc 0
Test threshold 0.8 Acc 0.9744285714285714, AUC 0.9983119964599609, avg_entr 0.008836598135530949, f1 0.9744285941123962
t0.8_test_time 2.7786636009996073
gc 0
Test threshold 0.9 Acc 0.9744285714285714, AUC 0.9983119964599609, avg_entr 0.008836598135530949, f1 0.9744285941123962
t0.9_test_time 2.6004316290000133
