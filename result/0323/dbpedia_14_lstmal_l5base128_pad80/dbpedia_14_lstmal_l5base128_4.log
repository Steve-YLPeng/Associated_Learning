total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 53.662933584
Start Training
gc 0
Train Epoch0 Acc 0.9080767857142857 (508523/560000), AUC 0.9906574487686157
ep0_train_time 244.20818602599996
Test Epoch0 layer4 Acc 0.9820571428571429, AUC 0.9977964758872986, avg_entr 0.0221997182816267, f1 0.9820571541786194
ep0_l4_test_time 3.568494753999971
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9850410714285714 (551623/560000), AUC 0.9975730776786804
ep1_train_time 241.90036786099995
Test Epoch1 layer4 Acc 0.9842285714285715, AUC 0.9980171322822571, avg_entr 0.004532730672508478, f1 0.9842285513877869
ep1_l4_test_time 3.5297461140000905
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9871821428571429 (552822/560000), AUC 0.9980159997940063
ep2_train_time 242.13757996599998
Test Epoch2 layer4 Acc 0.9843428571428572, AUC 0.9978858232498169, avg_entr 0.0026005851104855537, f1 0.9843428730964661
ep2_l4_test_time 3.550445917999923
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9883625 (553483/560000), AUC 0.9981805682182312
ep3_train_time 242.08222471200008
Test Epoch3 layer4 Acc 0.9852285714285715, AUC 0.9983072280883789, avg_entr 0.0016272453358396888, f1 0.9852285981178284
ep3_l4_test_time 3.5716039209999053
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9895357142857143 (554140/560000), AUC 0.9985376000404358
ep4_train_time 242.19184558899997
Test Epoch4 layer4 Acc 0.9855428571428572, AUC 0.9982355833053589, avg_entr 0.0014726488152518868, f1 0.9855428338050842
ep4_l4_test_time 3.5537127810000584
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9904928571428572 (554676/560000), AUC 0.9987961649894714
ep5_train_time 242.28312195599983
Test Epoch5 layer4 Acc 0.9856285714285714, AUC 0.998121440410614, avg_entr 0.0013363900361582637, f1 0.9856285452842712
ep5_l4_test_time 3.5803458830000636
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9913214285714286 (555140/560000), AUC 0.9989429712295532
ep6_train_time 242.44880861599995
Test Epoch6 layer4 Acc 0.9858857142857143, AUC 0.9979787468910217, avg_entr 0.00130214833188802, f1 0.985885739326477
ep6_l4_test_time 3.548803560000124
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9921214285714286 (555588/560000), AUC 0.9989649653434753
ep7_train_time 242.32737022799984
Test Epoch7 layer4 Acc 0.9856857142857143, AUC 0.9982190132141113, avg_entr 0.0011682057520374656, f1 0.9856857061386108
ep7_l4_test_time 3.575521424000044
gc 0
Train Epoch8 Acc 0.9926357142857143 (555876/560000), AUC 0.9990138411521912
ep8_train_time 242.35515966899993
Test Epoch8 layer4 Acc 0.9857428571428571, AUC 0.9979000091552734, avg_entr 0.0012265171390026808, f1 0.9857428669929504
ep8_l4_test_time 3.5548236599997836
gc 0
Train Epoch9 Acc 0.9933214285714286 (556260/560000), AUC 0.9989981651306152
ep9_train_time 242.70249688700005
Test Epoch9 layer4 Acc 0.9854285714285714, AUC 0.9977618455886841, avg_entr 0.0010816104477271438, f1 0.9854285717010498
ep9_l4_test_time 3.5700329830001465
gc 0
Train Epoch10 Acc 0.9937946428571428 (556525/560000), AUC 0.9990386962890625
ep10_train_time 242.45781878300022
Test Epoch10 layer4 Acc 0.9857714285714285, AUC 0.9975920915603638, avg_entr 0.0009546204819343984, f1 0.9857714176177979
ep10_l4_test_time 3.57179459200006
gc 0
Train Epoch11 Acc 0.9942803571428571 (556797/560000), AUC 0.9990389943122864
ep11_train_time 242.193939021
Test Epoch11 layer4 Acc 0.9856571428571429, AUC 0.997421145439148, avg_entr 0.0009797741658985615, f1 0.9856571555137634
ep11_l4_test_time 3.549972162999893
gc 0
Train Epoch12 Acc 0.99475 (557060/560000), AUC 0.9990342259407043
ep12_train_time 242.7694584320002
Test Epoch12 layer4 Acc 0.9857142857142858, AUC 0.9971498250961304, avg_entr 0.0009460530709475279, f1 0.9857142567634583
ep12_l4_test_time 3.54898848799985
gc 0
Train Epoch13 Acc 0.9951428571428571 (557280/560000), AUC 0.9990850687026978
ep13_train_time 242.6283034600001
Test Epoch13 layer4 Acc 0.9855714285714285, AUC 0.9971414804458618, avg_entr 0.000726048368960619, f1 0.9855714440345764
ep13_l4_test_time 3.6134879510000246
gc 0
Train Epoch14 Acc 0.9955357142857143 (557500/560000), AUC 0.9991135597229004
ep14_train_time 242.5450080769997
Test Epoch14 layer4 Acc 0.9855714285714285, AUC 0.9969877600669861, avg_entr 0.0008212897810153663, f1 0.9855714440345764
ep14_l4_test_time 3.5546857069998623
gc 0
Train Epoch15 Acc 0.9958678571428572 (557686/560000), AUC 0.9991223216056824
ep15_train_time 242.58167957899968
Test Epoch15 layer4 Acc 0.9853428571428572, AUC 0.9969539046287537, avg_entr 0.000907882465980947, f1 0.9853428602218628
ep15_l4_test_time 3.522214368999812
gc 0
Train Epoch16 Acc 0.9961946428571429 (557869/560000), AUC 0.9991434812545776
ep16_train_time 243.05842285400013
Test Epoch16 layer4 Acc 0.9854, AUC 0.9968855977058411, avg_entr 0.0008967015892267227, f1 0.9854000210762024
ep16_l4_test_time 3.5691356269999233
gc 0
Train Epoch17 Acc 0.9964625 (558019/560000), AUC 0.9991518259048462
ep17_train_time 242.5025071230002
Test Epoch17 layer4 Acc 0.9854285714285714, AUC 0.9965627789497375, avg_entr 0.0006833208608441055, f1 0.9854285717010498
ep17_l4_test_time 3.518165618000239
gc 0
Train Epoch18 Acc 0.9966875 (558145/560000), AUC 0.9991591572761536
ep18_train_time 242.51855171999978
Test Epoch18 layer4 Acc 0.9848857142857143, AUC 0.996379554271698, avg_entr 0.0008032256155274808, f1 0.9848856925964355
ep18_l4_test_time 3.6128922190000594
gc 0
Train Epoch19 Acc 0.9968982142857142 (558263/560000), AUC 0.9991920590400696
ep19_train_time 243.19595053300054
Test Epoch19 layer4 Acc 0.9854571428571428, AUC 0.9964314699172974, avg_entr 0.0007454698788933456, f1 0.9854571223258972
ep19_l4_test_time 3.5382151700005124
Best AUC tensor(0.9859) 6
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 4923.797090415001
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9739714285714286, AUC 0.9983081221580505, avg_entr 0.023894531652331352, f1 0.973971426486969
l0_test_time 0.8966835410001295
gc 0
Test layer1 Acc 0.9862285714285715, AUC 0.998758852481842, avg_entr 0.0021156982984393835, f1 0.9862285852432251
l1_test_time 1.5079977080004028
gc 0
Test layer2 Acc 0.9861142857142857, AUC 0.9986651539802551, avg_entr 0.0017348347464576364, f1 0.9861142635345459
l2_test_time 2.133049980000578
gc 0
Test layer3 Acc 0.9862857142857143, AUC 0.9983087778091431, avg_entr 0.0015728215221315622, f1 0.9862856268882751
l3_test_time 2.8578555160001997
gc 0
Test layer4 Acc 0.9863142857142857, AUC 0.9982801675796509, avg_entr 0.001487454166635871, f1 0.9863142967224121
l4_test_time 3.5330112080000617
gc 0
Test threshold 0.1 Acc 0.9779714285714286, AUC 0.9982590675354004, avg_entr 0.003944081254303455, f1 0.9779714345932007
t0.1_test_time 1.3807065580003837
gc 0
Test threshold 0.2 Acc 0.9746285714285714, AUC 0.9983070492744446, avg_entr 0.00870457012206316, f1 0.9746285676956177
t0.2_test_time 0.994022257999859
gc 0
Test threshold 0.3 Acc 0.9739714285714286, AUC 0.9983081221580505, avg_entr 0.009054192341864109, f1 0.973971426486969
t0.3_test_time 0.9365341249995254
gc 0
Test threshold 0.4 Acc 0.9739714285714286, AUC 0.9983081221580505, avg_entr 0.009054192341864109, f1 0.973971426486969
t0.4_test_time 0.9357853970004726
gc 0
Test threshold 0.5 Acc 0.9739714285714286, AUC 0.9983081221580505, avg_entr 0.009054192341864109, f1 0.973971426486969
t0.5_test_time 0.9330261770001016
gc 0
Test threshold 0.6 Acc 0.9739714285714286, AUC 0.9983081221580505, avg_entr 0.009054192341864109, f1 0.973971426486969
t0.6_test_time 0.9352483949996895
gc 0
Test threshold 0.7 Acc 0.9739714285714286, AUC 0.9983081221580505, avg_entr 0.009054192341864109, f1 0.973971426486969
t0.7_test_time 0.921409519000008
gc 0
Test threshold 0.8 Acc 0.9739714285714286, AUC 0.9983081221580505, avg_entr 0.009054192341864109, f1 0.973971426486969
t0.8_test_time 0.9336566430001767
gc 0
Test threshold 0.9 Acc 0.9739714285714286, AUC 0.9983081221580505, avg_entr 0.009054192341864109, f1 0.973971426486969
t0.9_test_time 0.9258558640003685
