total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17267662
init_time 55.175623658999996
Start Training
gc 0
Train Epoch0 Acc 0.9051410714285715 (506879/560000), AUC 0.9901123046875
ep0_train_time 248.80569047299997
Test Epoch0 layer4 Acc 0.9818, AUC 0.9972935914993286, avg_entr 0.02163218893110752, f1 0.9818000197410583
ep0_l4_test_time 3.625735105999979
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9849589285714285 (551577/560000), AUC 0.9973823428153992
ep1_train_time 245.59825328199997
Test Epoch1 layer4 Acc 0.9834857142857143, AUC 0.997665286064148, avg_entr 0.004668429959565401, f1 0.9834856986999512
ep1_l4_test_time 3.6426060929999267
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9870517857142858 (552749/560000), AUC 0.9978875517845154
ep2_train_time 245.51871849199995
Test Epoch2 layer4 Acc 0.9847142857142858, AUC 0.997845470905304, avg_entr 0.0024602534249424934, f1 0.9847142696380615
ep2_l4_test_time 3.6408381009999857
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9884660714285715 (553541/560000), AUC 0.9981247782707214
ep3_train_time 245.75306350199992
Test Epoch3 layer4 Acc 0.9858857142857143, AUC 0.997763991355896, avg_entr 0.0018897057743743062, f1 0.985885739326477
ep3_l4_test_time 3.6180193959999087
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9896089285714286 (554181/560000), AUC 0.9983991384506226
ep4_train_time 245.66787363699996
Test Epoch4 layer4 Acc 0.9858285714285714, AUC 0.9977608919143677, avg_entr 0.0014732463750988245, f1 0.9858285784721375
ep4_l4_test_time 3.6517820480000864
gc 0
Train Epoch5 Acc 0.9904 (554624/560000), AUC 0.9985686540603638
ep5_train_time 245.52731215599988
Test Epoch5 layer4 Acc 0.9857142857142858, AUC 0.9979257583618164, avg_entr 0.0015684781828895211, f1 0.9857142567634583
ep5_l4_test_time 3.6363108549999197
gc 0
Train Epoch6 Acc 0.9912357142857143 (555092/560000), AUC 0.998682975769043
ep6_train_time 245.58729623099998
Test Epoch6 layer4 Acc 0.9859142857142857, AUC 0.9980836510658264, avg_entr 0.001533646252937615, f1 0.9859142899513245
ep6_l4_test_time 3.604436263000025
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9919375 (555485/560000), AUC 0.998801589012146
ep7_train_time 245.7007166830001
Test Epoch7 layer4 Acc 0.9862571428571428, AUC 0.99793940782547, avg_entr 0.001377852982841432, f1 0.9862571358680725
ep7_l4_test_time 3.6008279839998067
Save ckpt to ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9924910714285714 (555795/560000), AUC 0.9988095164299011
ep8_train_time 245.71856888499997
Test Epoch8 layer4 Acc 0.9855714285714285, AUC 0.9976839423179626, avg_entr 0.0013383900513872504, f1 0.9855714440345764
ep8_l4_test_time 3.6395727160002025
gc 0
Train Epoch9 Acc 0.9931178571428572 (556146/560000), AUC 0.9988662600517273
ep9_train_time 245.831954236
Test Epoch9 layer4 Acc 0.9859428571428571, AUC 0.9974806904792786, avg_entr 0.0011343229562044144, f1 0.9859428405761719
ep9_l4_test_time 3.6216042600003675
gc 0
Train Epoch10 Acc 0.9936892857142857 (556466/560000), AUC 0.9988468885421753
ep10_train_time 245.77475623300006
Test Epoch10 layer4 Acc 0.9861428571428571, AUC 0.9972776174545288, avg_entr 0.0011687041260302067, f1 0.9861428737640381
ep10_l4_test_time 3.622190473000046
gc 0
Train Epoch11 Acc 0.9941839285714286 (556743/560000), AUC 0.9988168478012085
ep11_train_time 245.75190048600007
Test Epoch11 layer4 Acc 0.9861714285714286, AUC 0.9972447752952576, avg_entr 0.0009932596003636718, f1 0.9861714243888855
ep11_l4_test_time 3.610674637000102
gc 0
Train Epoch12 Acc 0.9946071428571429 (556980/560000), AUC 0.998853862285614
ep12_train_time 245.75970800100004
Test Epoch12 layer4 Acc 0.9854, AUC 0.9969865083694458, avg_entr 0.0010183359263464808, f1 0.9854000210762024
ep12_l4_test_time 3.599880670999937
gc 0
Train Epoch13 Acc 0.9938607142857143 (556562/560000), AUC 0.9979183077812195
ep13_train_time 245.8197079409997
Test Epoch13 layer4 Acc 0.9854, AUC 0.9967837333679199, avg_entr 0.0010755050461739302, f1 0.9854000210762024
ep13_l4_test_time 3.621620544000052
gc 0
Train Epoch14 Acc 0.9953839285714285 (557415/560000), AUC 0.998875081539154
ep14_train_time 245.95153129200025
Test Epoch14 layer4 Acc 0.9852571428571428, AUC 0.9966786503791809, avg_entr 0.0009045445476658642, f1 0.9852571487426758
ep14_l4_test_time 3.6118560019999677
gc 0
Train Epoch15 Acc 0.9958 (557648/560000), AUC 0.998898983001709
ep15_train_time 246.1041198329999
Test Epoch15 layer4 Acc 0.9853142857142857, AUC 0.9961796402931213, avg_entr 0.0009224539389833808, f1 0.9853143095970154
ep15_l4_test_time 3.6043941259999883
gc 0
Train Epoch16 Acc 0.9961321428571429 (557834/560000), AUC 0.9989482164382935
ep16_train_time 245.96518707700034
Test Epoch16 layer4 Acc 0.9852285714285715, AUC 0.9961588978767395, avg_entr 0.0007458952604793012, f1 0.9852285981178284
ep16_l4_test_time 3.651061481999932
gc 0
Train Epoch17 Acc 0.9964285714285714 (558000/560000), AUC 0.9989717602729797
ep17_train_time 246.1816761780001
Test Epoch17 layer4 Acc 0.9846285714285714, AUC 0.9961060881614685, avg_entr 0.0009465142502449453, f1 0.9846285581588745
ep17_l4_test_time 3.6017284680001467
gc 0
Train Epoch18 Acc 0.9966392857142857 (558118/560000), AUC 0.9990411400794983
ep18_train_time 246.04749472799995
Test Epoch18 layer4 Acc 0.9847714285714285, AUC 0.9956169128417969, avg_entr 0.0006681676604785025, f1 0.9847714304924011
ep18_l4_test_time 3.610317552000197
gc 0
Train Epoch19 Acc 0.9968767857142857 (558251/560000), AUC 0.9990288019180298
ep19_train_time 245.93150478299958
Test Epoch19 layer4 Acc 0.9848, AUC 0.9955935478210449, avg_entr 0.000839754065964371, f1 0.9847999811172485
ep19_l4_test_time 3.622580081999331
Best AUC tensor(0.9863) 7
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 4992.942404454
Start Testing
Load ckpt at ckpt/dbpedia_14_lstmal_l5base128_pad80//dbpedia_14_lstmal_l5.pt
gc 10
Test layer0 Acc 0.9740285714285715, AUC 0.998316764831543, avg_entr 0.023760473355650902, f1 0.9740285873413086
l0_test_time 0.9221843959994658
gc 0
Test layer1 Acc 0.9865142857142857, AUC 0.9985739588737488, avg_entr 0.002103951992467046, f1 0.9865142703056335
l1_test_time 1.5358512780003366
gc 0
Test layer2 Acc 0.9867714285714285, AUC 0.9985137581825256, avg_entr 0.0016369614750146866, f1 0.9867714047431946
l2_test_time 2.2269297030006783
gc 0
Test layer3 Acc 0.9867142857142858, AUC 0.9981083273887634, avg_entr 0.0013822948094457388, f1 0.9867143034934998
l3_test_time 2.9379055119998156
gc 0
Test layer4 Acc 0.9867428571428571, AUC 0.9979996085166931, avg_entr 0.001321773394010961, f1 0.9867428541183472
l4_test_time 3.622309155000039
gc 0
Test threshold 0.1 Acc 0.9777428571428571, AUC 0.9983080625534058, avg_entr 0.0038817347958683968, f1 0.9777428507804871
t0.1_test_time 1.3837585060000492
gc 0
Test threshold 0.2 Acc 0.9746857142857143, AUC 0.9983164072036743, avg_entr 0.008621381595730782, f1 0.9746857285499573
t0.2_test_time 1.0446678790003716
gc 0
Test threshold 0.3 Acc 0.9740285714285715, AUC 0.998316764831543, avg_entr 0.009003395214676857, f1 0.9740285873413086
t0.3_test_time 0.9635953599999993
gc 0
Test threshold 0.4 Acc 0.9740285714285715, AUC 0.998316764831543, avg_entr 0.009003395214676857, f1 0.9740285873413086
t0.4_test_time 0.9538299119994917
gc 0
Test threshold 0.5 Acc 0.9740285714285715, AUC 0.998316764831543, avg_entr 0.009003395214676857, f1 0.9740285873413086
t0.5_test_time 0.9633916659995521
gc 0
Test threshold 0.6 Acc 0.9740285714285715, AUC 0.998316764831543, avg_entr 0.009003395214676857, f1 0.9740285873413086
t0.6_test_time 0.9749889300001087
gc 0
Test threshold 0.7 Acc 0.9740285714285715, AUC 0.998316764831543, avg_entr 0.009003395214676857, f1 0.9740285873413086
t0.7_test_time 0.9746807969995643
gc 0
Test threshold 0.8 Acc 0.9740285714285715, AUC 0.998316764831543, avg_entr 0.009003395214676857, f1 0.9740285873413086
t0.8_test_time 0.9621603440000399
gc 0
Test threshold 0.9 Acc 0.9740285714285715, AUC 0.998316764831543, avg_entr 0.009003395214676857, f1 0.9740285873413086
t0.9_test_time 0.965909749000275
