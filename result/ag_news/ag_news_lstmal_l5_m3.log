total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2.pt
Start Training
gc 9
[[3.20071702e+02 9.90898173e+00]
 [9.37908156e-13 5.97685084e+00]
 [1.48035041e+01 8.28266761e+00]
 [2.29144805e+02 1.33102713e+02]
 [1.89318557e+02 1.01225016e+02]]
Train Epoch0 Acc 0.12696666666666667 (15236/120000), AUC 0.45918020606040955
Test Epoch0 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch0 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch0 layer2 Acc 0.9132894736842105, AUC 0.9831748008728027
Save ckpt to ./ckpt/mask3//ag_news/ag_news_lstmal_l5_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.2501315789473684, AUC 0.39063572883605957
Test Epoch0 layer4 Acc 0.09276315789473684, AUC 0.4488851726055145
gc 0
[[3.20071699e+02 9.91156414e+00]
 [9.37910972e-13 5.97485810e+00]
 [5.62471200e-10 5.97167468e+00]
 [2.42196040e+02 1.37745660e+02]
 [1.96086019e+02 1.05584254e+02]]
Train Epoch1 Acc 0.08654166666666667 (10385/120000), AUC 0.45725566148757935
Test Epoch1 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch1 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch1 layer2 Acc 0.9136842105263158, AUC 0.982959508895874
Test Epoch1 layer3 Acc 0.25, AUC 0.3477620482444763
Test Epoch1 layer4 Acc 0.10552631578947369, AUC 0.4570481777191162
gc 0
[[3.20071701e+02 9.91048126e+00]
 [9.37906056e-13 5.97661824e+00]
 [4.91801230e-12 5.83314042e+00]
 [2.42192449e+02 1.36845015e+02]
 [1.96079900e+02 1.06491582e+02]]
Train Epoch2 Acc 0.09756666666666666 (11708/120000), AUC 0.4654523432254791
Test Epoch2 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch2 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch2 layer2 Acc 0.9134210526315789, AUC 0.9833068251609802
Save ckpt to ./ckpt/mask3//ag_news/ag_news_lstmal_l5_m3.pt  ,ep 2
Test Epoch2 layer3 Acc 0.25, AUC 0.32105308771133423
Test Epoch2 layer4 Acc 0.10986842105263157, AUC 0.46775442361831665
gc 0
[[3.20071703e+02 9.91132223e+00]
 [9.37896889e-13 5.97740952e+00]
 [1.13728160e-12 5.75938108e+00]
 [2.42195518e+02 1.36147744e+02]
 [1.96081272e+02 1.07233425e+02]]
Train Epoch3 Acc 0.1067 (12804/120000), AUC 0.47946134209632874
Test Epoch3 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch3 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch3 layer2 Acc 0.9123684210526316, AUC 0.9832803606987
Test Epoch3 layer3 Acc 0.2501315789473684, AUC 0.2951187491416931
Test Epoch3 layer4 Acc 0.13157894736842105, AUC 0.4777335226535797
gc 0
[[3.20071701e+02 9.90724227e+00]
 [9.37903238e-13 5.97647048e+00]
 [7.57198343e-13 5.71075999e+00]
 [2.42193044e+02 1.35408973e+02]
 [1.96082343e+02 1.07732273e+02]]
Train Epoch4 Acc 0.12246666666666667 (14696/120000), AUC 0.4895910918712616
Test Epoch4 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch4 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch4 layer2 Acc 0.9134210526315789, AUC 0.9832828640937805
Test Epoch4 layer3 Acc 0.24973684210526315, AUC 0.27350741624832153
Test Epoch4 layer4 Acc 0.13592105263157894, AUC 0.48928263783454895
gc 0
[[3.20071699e+02 9.91284880e+00]
 [9.37917306e-13 5.97698707e+00]
 [8.90088101e-13 5.67439629e+00]
 [2.42191364e+02 1.34844065e+02]
 [1.96080015e+02 1.08233254e+02]]
Train Epoch5 Acc 0.13841666666666666 (16610/120000), AUC 0.4999455511569977
Test Epoch5 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch5 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch5 layer2 Acc 0.9132894736842105, AUC 0.9835348129272461
Save ckpt to ./ckpt/mask3//ag_news/ag_news_lstmal_l5_m3.pt  ,ep 5
Test Epoch5 layer3 Acc 0.24763157894736842, AUC 0.26738858222961426
Test Epoch5 layer4 Acc 0.1618421052631579, AUC 0.4969024956226349
gc 0
[[3.20071697e+02 9.91489013e+00]
 [9.37926249e-13 5.97501306e+00]
 [1.13713715e-12 5.63837681e+00]
 [2.42191688e+02 1.34250900e+02]
 [1.96085423e+02 1.08287621e+02]]
Train Epoch6 Acc 0.16326666666666667 (19592/120000), AUC 0.5066870450973511
Test Epoch6 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch6 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch6 layer2 Acc 0.9134210526315789, AUC 0.9831672310829163
Test Epoch6 layer3 Acc 0.2481578947368421, AUC 0.26484060287475586
Test Epoch6 layer4 Acc 0.16473684210526315, AUC 0.4989981949329376
gc 0
[[3.20071698e+02 9.91177855e+00]
 [9.37919450e-13 5.97609606e+00]
 [1.77112451e-12 5.61851891e+00]
 [2.42190247e+02 1.33819151e+02]
 [1.96083345e+02 1.08520911e+02]]
Train Epoch7 Acc 0.17381666666666667 (20858/120000), AUC 0.5083876848220825
Test Epoch7 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch7 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch7 layer2 Acc 0.9144736842105263, AUC 0.9828165769577026
Test Epoch7 layer3 Acc 0.24671052631578946, AUC 0.2588210999965668
Test Epoch7 layer4 Acc 0.1863157894736842, AUC 0.5067166686058044
gc 0
[[3.20071701e+02 9.90861991e+00]
 [9.37896083e-13 5.97498380e+00]
 [8.42613272e-08 5.59171957e+00]
 [2.42194878e+02 1.33751481e+02]
 [1.96080869e+02 1.08607433e+02]]
Train Epoch8 Acc 0.19066666666666668 (22880/120000), AUC 0.513541042804718
Test Epoch8 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch8 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch8 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Save ckpt to ./ckpt/mask3//ag_news/ag_news_lstmal_l5_m3.pt  ,ep 8
Test Epoch8 layer3 Acc 0.24, AUC 0.2634342908859253
Test Epoch8 layer4 Acc 0.20921052631578949, AUC 0.5104812383651733
gc 0
[[3.20071702e+02 9.90615600e+00]
 [9.37899413e-13 5.97593451e+00]
 [2.07376499e-06 5.57051288e+00]
 [2.42194215e+02 1.33793972e+02]
 [1.96080615e+02 1.08795813e+02]]
Train Epoch9 Acc 0.21738333333333335 (26086/120000), AUC 0.5228789448738098
Test Epoch9 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch9 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch9 layer2 Acc 0.9140789473684211, AUC 0.9834285974502563
Test Epoch9 layer3 Acc 0.24144736842105263, AUC 0.2696545124053955
Test Epoch9 layer4 Acc 0.22078947368421054, AUC 0.5187557339668274
Best AUC 0.9837609529495239
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//ag_news/ag_news_lstmal_l5_m3.pt
[[1710   59   84   47]
 [  12 1874    5    9]
 [  56   17 1646  181]
 [  55   12  105 1728]]
Figure(640x480)
[[1724   48   71   57]
 [  23 1850   14   13]
 [  58   10 1652  180]
 [  50   13  116 1721]]
Figure(640x480)
[[1724   48   72   56]
 [  19 1853   15   13]
 [  58   10 1661  171]
 [  52   17  128 1703]]
Figure(640x480)
[[   0    9    0 1891]
 [   0   16    0 1884]
 [   0  210    0 1690]
 [   0   89    3 1808]]
Figure(640x480)
[[ 122    0  634 1144]
 [   7    0    6 1887]
 [ 139    0  800  961]
 [1204    0   28  668]]
Figure(640x480)
