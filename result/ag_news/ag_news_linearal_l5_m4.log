total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3.pt
Start Training
gc 9
[[3.20103658e+02 1.00926241e+01]
 [3.88622197e-12 1.00189832e+01]
 [2.79374948e-07 8.72734920e+00]
 [1.50325683e+01 1.46433371e+01]
 [2.09045090e+02 1.82562302e+02]]
Train Epoch0 Acc 0.25033333333333335 (30040/120000), AUC 0.5495770573616028
Test Epoch0 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch0 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch0 layer2 Acc 0.9160526315789473, AUC 0.9823267459869385
Test Epoch0 layer3 Acc 0.915, AUC 0.9817956686019897
Save ckpt to ./ckpt/mask4//ag_news/ag_news_linearal_l5_m4.pt  ,ep 0
Test Epoch0 layer4 Acc 0.2588157894736842, AUC 0.5840368270874023
gc 0
[[3.20103660e+02 1.00958411e+01]
 [3.88619708e-12 1.00226076e+01]
 [2.79374994e-07 8.72979508e+00]
 [6.57945087e-10 1.00354228e+01]
 [2.17347244e+02 1.95290560e+02]]
Train Epoch1 Acc 0.25719166666666665 (30863/120000), AUC 0.5742439031600952
Test Epoch1 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch1 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch1 layer2 Acc 0.9160526315789473, AUC 0.9823267459869385
Test Epoch1 layer3 Acc 0.9153947368421053, AUC 0.9821349382400513
Save ckpt to ./ckpt/mask4//ag_news/ag_news_linearal_l5_m4.pt  ,ep 1
Test Epoch1 layer4 Acc 0.26052631578947366, AUC 0.5626887679100037
gc 0
[[3.20103656e+02 1.00931965e+01]
 [3.88613820e-12 1.00204151e+01]
 [2.79387521e-07 8.72778792e+00]
 [4.67989233e-12 9.32742816e+00]
 [2.17350080e+02 2.07960798e+02]]
Train Epoch2 Acc 0.2577583333333333 (30931/120000), AUC 0.5483660697937012
Test Epoch2 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch2 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch2 layer2 Acc 0.9160526315789473, AUC 0.9823267459869385
Test Epoch2 layer3 Acc 0.9155263157894736, AUC 0.9818791747093201
Test Epoch2 layer4 Acc 0.2603947368421053, AUC 0.5367841720581055
gc 0
[[3.20103657e+02 1.00923973e+01]
 [3.88611051e-12 1.00190900e+01]
 [2.79385890e-07 8.72728532e+00]
 [9.96659216e-13 8.70923100e+00]
 [2.17348501e+02 2.26780459e+02]]
Train Epoch3 Acc 0.25658333333333333 (30790/120000), AUC 0.5182166695594788
Test Epoch3 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch3 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch3 layer2 Acc 0.9160526315789473, AUC 0.9823267459869385
Test Epoch3 layer3 Acc 0.9152631578947369, AUC 0.982151448726654
Save ckpt to ./ckpt/mask4//ag_news/ag_news_linearal_l5_m4.pt  ,ep 3
Test Epoch3 layer4 Acc 0.2594736842105263, AUC 0.5131666660308838
gc 0
[[3.20103655e+02 1.00898795e+01]
 [3.88635892e-12 1.00158864e+01]
 [2.79382534e-07 8.72534052e+00]
 [7.46093005e-13 8.25800544e+00]
 [2.17354746e+02 2.46874052e+02]]
Train Epoch4 Acc 0.25669166666666665 (30803/120000), AUC 0.4972623586654663
Test Epoch4 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch4 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch4 layer2 Acc 0.9160526315789473, AUC 0.9823267459869385
Test Epoch4 layer3 Acc 0.9151315789473684, AUC 0.9817454218864441
Test Epoch4 layer4 Acc 0.25842105263157894, AUC 0.49911361932754517
gc 0
[[3.20103660e+02 1.00985411e+01]
 [3.88617337e-12 1.00237662e+01]
 [2.79377190e-07 8.73046296e+00]
 [9.02774417e-13 7.97966881e+00]
 [2.17348272e+02 2.62281933e+02]]
Train Epoch5 Acc 0.255975 (30717/120000), AUC 0.495505154132843
Test Epoch5 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch5 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch5 layer2 Acc 0.9160526315789473, AUC 0.9823267459869385
Test Epoch5 layer3 Acc 0.9171052631578948, AUC 0.9812843203544617
Test Epoch5 layer4 Acc 0.25842105263157894, AUC 0.508857250213623
gc 0
[[3.20103661e+02 1.00924760e+01]
 [3.88609226e-12 1.00204796e+01]
 [2.79374209e-07 8.72874483e+00]
 [8.40389940e-13 7.78504844e+00]
 [2.17344828e+02 2.71386182e+02]]
Train Epoch6 Acc 0.25443333333333334 (30532/120000), AUC 0.4986236095428467
Test Epoch6 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch6 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch6 layer2 Acc 0.9160526315789473, AUC 0.9823267459869385
Test Epoch6 layer3 Acc 0.915921052631579, AUC 0.981356143951416
Test Epoch6 layer4 Acc 0.2557894736842105, AUC 0.5078163146972656
gc 0
[[3.20103660e+02 1.00934212e+01]
 [3.88610208e-12 1.00191693e+01]
 [2.79376891e-07 8.72768001e+00]
 [1.09074483e-12 7.71634335e+00]
 [2.17345469e+02 2.76415882e+02]]
Train Epoch7 Acc 0.251975 (30237/120000), AUC 0.49903473258018494
Test Epoch7 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch7 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch7 layer2 Acc 0.9160526315789473, AUC 0.9823267459869385
Test Epoch7 layer3 Acc 0.9160526315789473, AUC 0.9814748167991638
Test Epoch7 layer4 Acc 0.2532894736842105, AUC 0.5095282196998596
gc 0
[[3.20103658e+02 1.00921897e+01]
 [3.88618786e-12 1.00192301e+01]
 [2.79380542e-07 8.72839314e+00]
 [1.53322187e-12 7.66060242e+00]
 [2.17350304e+02 2.80704830e+02]]
Train Epoch8 Acc 0.24935833333333332 (29923/120000), AUC 0.5012232661247253
Test Epoch8 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch8 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch8 layer2 Acc 0.9160526315789473, AUC 0.9823267459869385
Test Epoch8 layer3 Acc 0.9157894736842105, AUC 0.9811280965805054
Test Epoch8 layer4 Acc 0.2505263157894737, AUC 0.5128897428512573
gc 0
[[3.20103657e+02 1.00922144e+01]
 [3.88626765e-12 1.00193310e+01]
 [2.79378449e-07 8.72880165e+00]
 [2.57486694e-12 7.62097114e+00]
 [2.17351258e+02 2.84288433e+02]]
Train Epoch9 Acc 0.24594166666666667 (29513/120000), AUC 0.5039494037628174
Test Epoch9 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch9 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch9 layer2 Acc 0.9160526315789473, AUC 0.9823267459869385
Test Epoch9 layer3 Acc 0.9155263157894736, AUC 0.9805212020874023
Test Epoch9 layer4 Acc 0.24552631578947368, AUC 0.510911226272583
Best AUC 0.982151448726654
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//ag_news/ag_news_linearal_l5_m4.pt
[[1711   59   89   41]
 [  15 1865   10   10]
 [  50   15 1688  147]
 [  59   16  145 1680]]
Figure(640x480)
[[1706   60   90   44]
 [  14 1865   12    9]
 [  43   16 1698  143]
 [  56   14  145 1685]]
Figure(640x480)
[[1710   59   83   48]
 [  13 1869    9    9]
 [  45   17 1677  161]
 [  51   15  128 1706]]
Figure(640x480)
[[1707   59   86   48]
 [  16 1866    9    9]
 [  47   13 1687  153]
 [  54   14  136 1696]]
Figure(640x480)
[[   0 1833   67    0]
 [  30 1867    3    0]
 [   0 1795  105    0]
 [   0  296 1604    0]]
Figure(640x480)
