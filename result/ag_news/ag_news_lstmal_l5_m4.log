total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask3//ag_news/ag_news_lstmal_l5_m3.pt
Start Training
gc 9
[[3.20071700e+02 9.91071943e+00]
 [9.37901718e-13 5.97606858e+00]
 [5.35991215e-12 5.56664419e+00]
 [1.52489162e+01 7.81884322e+00]
 [2.20585756e+02 1.45362614e+02]]
Train Epoch0 Acc 0.04186666666666667 (5024/120000), AUC 0.16313093900680542
Test Epoch0 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch0 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch0 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch0 layer3 Acc 0.9125, AUC 0.9821929335594177
Save ckpt to ./ckpt/mask4//ag_news/ag_news_lstmal_l5_m4.pt  ,ep 0
Test Epoch0 layer4 Acc 0.04473684210526316, AUC 0.16206464171409607
gc 0
[[3.20071700e+02 9.90820403e+00]
 [9.37901158e-13 5.97624852e+00]
 [5.35996025e-12 5.56766419e+00]
 [1.42862463e-08 5.88479612e+00]
 [2.29977640e+02 1.49226469e+02]]
Train Epoch1 Acc 0.026733333333333335 (3208/120000), AUC 0.14516474306583405
Test Epoch1 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch1 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch1 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch1 layer3 Acc 0.9132894736842105, AUC 0.9820677042007446
Test Epoch1 layer4 Acc 0.041578947368421056, AUC 0.1632738560438156
gc 0
[[3.20071700e+02 9.91396746e+00]
 [9.37896888e-13 5.97747844e+00]
 [5.35993545e-12 5.56805568e+00]
 [8.59561749e-12 5.79609058e+00]
 [2.29975692e+02 1.47218483e+02]]
Train Epoch2 Acc 0.027425 (3291/120000), AUC 0.15082824230194092
Test Epoch2 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch2 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch2 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch2 layer3 Acc 0.9139473684210526, AUC 0.9824838042259216
Save ckpt to ./ckpt/mask4//ag_news/ag_news_lstmal_l5_m4.pt  ,ep 2
Test Epoch2 layer4 Acc 0.04289473684210526, AUC 0.175786554813385
gc 0
[[3.20071697e+02 9.91552486e+00]
 [9.37917526e-13 5.97764630e+00]
 [5.35984103e-12 5.56818291e+00]
 [1.46915278e-12 5.75485729e+00]
 [2.29973493e+02 1.45470131e+02]]
Train Epoch3 Acc 0.0314 (3768/120000), AUC 0.16367588937282562
Test Epoch3 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch3 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch3 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch3 layer3 Acc 0.9136842105263158, AUC 0.9826337099075317
Save ckpt to ./ckpt/mask4//ag_news/ag_news_lstmal_l5_m4.pt  ,ep 3
Test Epoch3 layer4 Acc 0.045, AUC 0.18059486150741577
gc 0
[[3.20071699e+02 9.91091516e+00]
 [9.37908893e-13 5.97439713e+00]
 [5.35992369e-12 5.56504715e+00]
 [7.94302890e-13 5.72414281e+00]
 [2.29977373e+02 1.43419253e+02]]
Train Epoch4 Acc 0.034758333333333336 (4171/120000), AUC 0.16924181580543518
Test Epoch4 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch4 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch4 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch4 layer3 Acc 0.9138157894736842, AUC 0.9823305606842041
Test Epoch4 layer4 Acc 0.04868421052631579, AUC 0.18593983352184296
gc 0
[[3.20071701e+02 9.91144300e+00]
 [9.37899550e-13 5.97672278e+00]
 [5.35994231e-12 5.56683153e+00]
 [8.99869199e-13 5.69767682e+00]
 [2.29976794e+02 1.41757289e+02]]
Train Epoch5 Acc 0.03944166666666667 (4733/120000), AUC 0.17217117547988892
Test Epoch5 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch5 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch5 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch5 layer3 Acc 0.9142105263157895, AUC 0.982509434223175
Test Epoch5 layer4 Acc 0.05526315789473684, AUC 0.18496377766132355
gc 0
[[3.20071701e+02 9.90680270e+00]
 [9.37896508e-13 5.97676008e+00]
 [5.35995057e-12 5.56723079e+00]
 [1.24100697e-12 5.68130685e+00]
 [2.29974917e+02 1.40504793e+02]]
Train Epoch6 Acc 0.049916666666666665 (5990/120000), AUC 0.17371594905853271
Test Epoch6 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch6 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch6 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch6 layer3 Acc 0.9134210526315789, AUC 0.9826720356941223
Save ckpt to ./ckpt/mask4//ag_news/ag_news_lstmal_l5_m4.pt  ,ep 6
Test Epoch6 layer4 Acc 0.06276315789473684, AUC 0.18613673746585846
gc 0
[[3.20071698e+02 9.90986715e+00]
 [9.37919000e-13 5.97646844e+00]
 [5.35993118e-12 5.56729966e+00]
 [1.83662348e-12 5.66576703e+00]
 [2.29977338e+02 1.39272791e+02]]
Train Epoch7 Acc 0.07125 (8550/120000), AUC 0.17335668206214905
Test Epoch7 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch7 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch7 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch7 layer3 Acc 0.9138157894736842, AUC 0.982445478439331
Test Epoch7 layer4 Acc 0.10421052631578948, AUC 0.18507535755634308
gc 0
[[3.20071699e+02 9.91561703e+00]
 [9.37912136e-13 5.97589845e+00]
 [5.35991246e-12 5.56700746e+00]
 [1.55188076e-12 5.63568466e+00]
 [2.29977830e+02 1.38667608e+02]]
Train Epoch8 Acc 0.11074166666666667 (13289/120000), AUC 0.1737394630908966
Test Epoch8 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch8 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch8 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch8 layer3 Acc 0.9136842105263158, AUC 0.9826187491416931
Test Epoch8 layer4 Acc 0.14355263157894738, AUC 0.18744443356990814
gc 0
[[3.20071700e+02 9.90921037e+00]
 [9.37915986e-13 5.97602830e+00]
 [5.35989229e-12 5.56724472e+00]
 [2.76850805e-12 5.63133593e+00]
 [2.29974007e+02 1.38384292e+02]]
Train Epoch9 Acc 0.13299166666666667 (15959/120000), AUC 0.1753506362438202
Test Epoch9 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch9 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Test Epoch9 layer2 Acc 0.9132894736842105, AUC 0.9837609529495239
Test Epoch9 layer3 Acc 0.9138157894736842, AUC 0.982347846031189
Test Epoch9 layer4 Acc 0.145, AUC 0.18601298332214355
Best AUC 0.9826720356941223
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//ag_news/ag_news_lstmal_l5_m4.pt
[[1710   59   84   47]
 [  12 1874    5    9]
 [  56   17 1646  181]
 [  55   12  105 1728]]
Figure(640x480)
[[1724   48   71   57]
 [  23 1850   14   13]
 [  58   10 1652  180]
 [  50   13  116 1721]]
Figure(640x480)
[[1724   48   72   56]
 [  19 1853   15   13]
 [  58   10 1661  171]
 [  52   17  128 1703]]
Figure(640x480)
[[1725   48   71   56]
 [  19 1855   13   13]
 [  60   11 1656  173]
 [  54   17  123 1706]]
Figure(640x480)
[[  96    0 1775   29]
 [1878    0   17    5]
 [ 246    0  361 1293]
 [ 858    0 1022   20]]
Figure(640x480)
