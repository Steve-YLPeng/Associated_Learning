total count words 102019
vocab size 30000
found 26754 words in glove
Start Training
gc 0
[[701.55868509  25.81542261]
 [  8.67613115  28.61366682]
 [  6.3272466   18.78734182]
 [  5.80978887  17.04838108]
 [  6.03205168  16.58012109]]
Train Epoch0 Acc 0.79385 (95262/120000), AUC 0.9467979669570923
Test Epoch0 layer0 Acc 0.9096052631578947, AUC 0.9797829985618591
Save ckpt to ./ckpt//ag_news/ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9110526315789473, AUC 0.9812268018722534
Save ckpt to ./ckpt//ag_news/ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.91, AUC 0.9818546772003174
Save ckpt to ./ckpt//ag_news/ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9092105263157895, AUC 0.9799611568450928
Test Epoch0 layer4 Acc 0.9082894736842105, AUC 0.9815695881843567
gc 0
[[6.39354701e+02 2.57239737e+01]
 [8.84937889e-06 1.85171275e+01]
 [4.15803319e-06 1.57713894e+01]
 [1.93326379e-06 1.54105989e+01]
 [1.25167296e-06 1.55427013e+01]]
Train Epoch1 Acc 0.9291166666666667 (111494/120000), AUC 0.9854479432106018
Test Epoch1 layer0 Acc 0.9157894736842105, AUC 0.9807078242301941
Test Epoch1 layer1 Acc 0.9136842105263158, AUC 0.9833040833473206
Save ckpt to ./ckpt//ag_news/ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9153947368421053, AUC 0.9837456345558167
Save ckpt to ./ckpt//ag_news/ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9156578947368421, AUC 0.9824140071868896
Test Epoch1 layer4 Acc 0.9147368421052632, AUC 0.98337721824646
gc 0
[[6.39015956e+02 2.73714397e+01]
 [4.12278186e-07 1.79736163e+01]
 [2.05787060e-07 1.57241811e+01]
 [1.18128664e-07 1.52498119e+01]
 [1.23110704e-07 1.52337551e+01]]
Train Epoch2 Acc 0.9376833333333333 (112522/120000), AUC 0.9885169863700867
Test Epoch2 layer0 Acc 0.9152631578947369, AUC 0.9814945459365845
Test Epoch2 layer1 Acc 0.9163157894736842, AUC 0.9841641783714294
Save ckpt to ./ckpt//ag_news/ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.9156578947368421, AUC 0.9843928813934326
Save ckpt to ./ckpt//ag_news/ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.9151315789473684, AUC 0.9826940298080444
Test Epoch2 layer4 Acc 0.9143421052631578, AUC 0.9833748936653137
gc 0
[[6.38944255e+02 2.89715809e+01]
 [4.10553645e-08 1.78432920e+01]
 [3.49015381e-08 1.57160489e+01]
 [5.43659749e-08 1.51361984e+01]
 [1.69385042e-07 1.50044728e+01]]
Train Epoch3 Acc 0.9429416666666667 (113153/120000), AUC 0.9900562763214111
Test Epoch3 layer0 Acc 0.9138157894736842, AUC 0.9812375903129578
Test Epoch3 layer1 Acc 0.9173684210526316, AUC 0.983898937702179
Test Epoch3 layer2 Acc 0.9169736842105263, AUC 0.9839246273040771
Test Epoch3 layer3 Acc 0.915921052631579, AUC 0.9833230376243591
Test Epoch3 layer4 Acc 0.9155263157894736, AUC 0.9833799600601196
gc 0
[[6.38922911e+02 3.05586546e+01]
 [2.05658450e-05 1.77636568e+01]
 [1.15901045e-04 1.56430648e+01]
 [3.90125870e-04 1.49700267e+01]
 [9.44598719e-04 1.47435323e+01]]
Train Epoch4 Acc 0.9476166666666667 (113714/120000), AUC 0.990983784198761
Test Epoch4 layer0 Acc 0.9163157894736842, AUC 0.9810491800308228
Test Epoch4 layer1 Acc 0.9144736842105263, AUC 0.9836753606796265
Test Epoch4 layer2 Acc 0.9139473684210526, AUC 0.9835856556892395
Test Epoch4 layer3 Acc 0.9130263157894737, AUC 0.9818562269210815
Test Epoch4 layer4 Acc 0.9142105263157895, AUC 0.9820574522018433
gc 0
[[6.38915768e+02 3.21622995e+01]
 [1.56182200e-04 1.78424397e+01]
 [4.54915002e-04 1.56665518e+01]
 [9.48681420e-04 1.49027270e+01]
 [1.65295650e-03 1.46188003e+01]]
Train Epoch5 Acc 0.9510333333333333 (114124/120000), AUC 0.9916099905967712
Test Epoch5 layer0 Acc 0.9117105263157895, AUC 0.9806951284408569
Test Epoch5 layer1 Acc 0.9122368421052631, AUC 0.9834356904029846
Test Epoch5 layer2 Acc 0.9118421052631579, AUC 0.9836242198944092
Test Epoch5 layer3 Acc 0.9130263157894737, AUC 0.9825842976570129
Test Epoch5 layer4 Acc 0.9132894736842105, AUC 0.981228232383728
gc 0
[[6.38913184e+02 3.37054804e+01]
 [1.49739197e-04 1.78505025e+01]
 [3.42921904e-04 1.56125772e+01]
 [6.32159286e-04 1.47765044e+01]
 [9.96815167e-04 1.44493277e+01]]
Train Epoch6 Acc 0.953 (114360/120000), AUC 0.9924310445785522
Test Epoch6 layer0 Acc 0.9128947368421053, AUC 0.9803779125213623
Test Epoch6 layer1 Acc 0.9126315789473685, AUC 0.9828846454620361
Test Epoch6 layer2 Acc 0.9125, AUC 0.9829787015914917
Test Epoch6 layer3 Acc 0.9128947368421053, AUC 0.9817707538604736
Test Epoch6 layer4 Acc 0.9125, AUC 0.98164963722229
gc 0
[[6.38912438e+02 3.51820841e+01]
 [1.75615721e-04 1.77529281e+01]
 [3.95470417e-04 1.54302367e+01]
 [7.93564893e-04 1.45269262e+01]
 [1.38941147e-03 1.41564129e+01]]
Train Epoch7 Acc 0.956125 (114735/120000), AUC 0.9927303791046143
Test Epoch7 layer0 Acc 0.9132894736842105, AUC 0.9803454875946045
Test Epoch7 layer1 Acc 0.9118421052631579, AUC 0.9816598296165466
Test Epoch7 layer2 Acc 0.9114473684210527, AUC 0.9821620583534241
Test Epoch7 layer3 Acc 0.9113157894736842, AUC 0.9786911010742188
Test Epoch7 layer4 Acc 0.9102631578947369, AUC 0.9788932204246521
gc 0
[[6.38911959e+02 3.65817674e+01]
 [2.61342574e-04 1.77013602e+01]
 [5.86742179e-04 1.52883986e+01]
 [1.10398925e-03 1.43315560e+01]
 [1.73958216e-03 1.39302682e+01]]
Train Epoch8 Acc 0.9583333333333334 (115000/120000), AUC 0.993091881275177
Test Epoch8 layer0 Acc 0.9128947368421053, AUC 0.9802811741828918
Test Epoch8 layer1 Acc 0.9105263157894737, AUC 0.9812042713165283
Test Epoch8 layer2 Acc 0.9106578947368421, AUC 0.981500506401062
Test Epoch8 layer3 Acc 0.9114473684210527, AUC 0.9782067537307739
Test Epoch8 layer4 Acc 0.9111842105263158, AUC 0.9792633056640625
gc 0
[[6.38911743e+02 3.79624077e+01]
 [2.19785018e-04 1.76564142e+01]
 [4.68680241e-04 1.51756614e+01]
 [8.39035606e-04 1.41805577e+01]
 [1.37281818e-03 1.37616985e+01]]
Train Epoch9 Acc 0.9600583333333333 (115207/120000), AUC 0.993461012840271
Test Epoch9 layer0 Acc 0.9114473684210527, AUC 0.979796290397644
Test Epoch9 layer1 Acc 0.9092105263157895, AUC 0.9805070161819458
Test Epoch9 layer2 Acc 0.91, AUC 0.9796208143234253
Test Epoch9 layer3 Acc 0.9105263157894737, AUC 0.976641058921814
Test Epoch9 layer4 Acc 0.9110526315789473, AUC 0.9753689765930176
gc 0
[[6.38911743e+02 3.85786850e+01]
 [1.88131914e-04 1.70771874e+01]
 [4.42950024e-04 1.45616708e+01]
 [8.58849122e-04 1.35431373e+01]
 [1.45415655e-03 1.31136247e+01]]
Train Epoch10 Acc 0.962425 (115491/120000), AUC 0.993541955947876
Test Epoch10 layer0 Acc 0.9122368421052631, AUC 0.9802745580673218
Test Epoch10 layer1 Acc 0.9061842105263158, AUC 0.9787715673446655
Test Epoch10 layer2 Acc 0.9086842105263158, AUC 0.9774017930030823
Test Epoch10 layer3 Acc 0.9080263157894737, AUC 0.9754879474639893
Test Epoch10 layer4 Acc 0.9084210526315789, AUC 0.9754587411880493
gc 0
[[6.38911743e+02 3.83874875e+01]
 [1.96351988e-04 1.63461379e+01]
 [4.52086923e-04 1.39155133e+01]
 [8.43951547e-04 1.29399205e+01]
 [1.40239913e-03 1.25380878e+01]]
Train Epoch11 Acc 0.9641833333333333 (115702/120000), AUC 0.9939581155776978
Test Epoch11 layer0 Acc 0.9101315789473684, AUC 0.9798523187637329
Test Epoch11 layer1 Acc 0.9034210526315789, AUC 0.978462278842926
Test Epoch11 layer2 Acc 0.905, AUC 0.9778668284416199
Test Epoch11 layer3 Acc 0.906578947368421, AUC 0.9761559963226318
Test Epoch11 layer4 Acc 0.9068421052631579, AUC 0.9765807390213013
gc 0
[[6.38911743e+02 3.81464938e+01]
 [2.40287050e-04 1.55754346e+01]
 [5.05915262e-04 1.32363837e+01]
 [9.07912124e-04 1.23072662e+01]
 [1.36604104e-03 1.19330843e+01]]
Train Epoch12 Acc 0.966425 (115971/120000), AUC 0.9940095543861389
Test Epoch12 layer0 Acc 0.9101315789473684, AUC 0.9798513650894165
Test Epoch12 layer1 Acc 0.9076315789473685, AUC 0.9778744578361511
Test Epoch12 layer2 Acc 0.9071052631578947, AUC 0.976567804813385
Test Epoch12 layer3 Acc 0.9073684210526316, AUC 0.9742016196250916
Test Epoch12 layer4 Acc 0.9072368421052631, AUC 0.9754865169525146
gc 0
[[6.38911743e+02 3.79697088e+01]
 [2.08373028e-04 1.48413196e+01]
 [4.62168490e-04 1.25873707e+01]
 [8.35927485e-04 1.17044278e+01]
 [1.35742051e-03 1.13553524e+01]]
Train Epoch13 Acc 0.968325 (116199/120000), AUC 0.9943950176239014
Test Epoch13 layer0 Acc 0.9111842105263158, AUC 0.9797846674919128
Test Epoch13 layer1 Acc 0.9028947368421053, AUC 0.9761790037155151
Test Epoch13 layer2 Acc 0.9044736842105263, AUC 0.9745911359786987
Test Epoch13 layer3 Acc 0.9042105263157895, AUC 0.9736983180046082
Test Epoch13 layer4 Acc 0.9038157894736842, AUC 0.9744120240211487
gc 0
[[6.38911743e+02 3.77694914e+01]
 [1.90160387e-04 1.41058923e+01]
 [4.12280149e-04 1.19397172e+01]
 [7.54787633e-04 1.11019733e+01]
 [1.22829824e-03 1.07731662e+01]]
Train Epoch14 Acc 0.9703416666666667 (116441/120000), AUC 0.994648814201355
Test Epoch14 layer0 Acc 0.910921052631579, AUC 0.9797047972679138
Test Epoch14 layer1 Acc 0.9028947368421053, AUC 0.9765574336051941
Test Epoch14 layer2 Acc 0.9028947368421053, AUC 0.9754973649978638
Test Epoch14 layer3 Acc 0.9036842105263158, AUC 0.9738114476203918
Test Epoch14 layer4 Acc 0.9036842105263158, AUC 0.974155604839325
gc 0
[[6.38911743e+02 3.76161179e+01]
 [1.75246937e-04 1.33265354e+01]
 [3.87366357e-04 1.12401560e+01]
 [6.87146510e-04 1.04465872e+01]
 [1.06040772e-03 1.01441970e+01]]
Train Epoch15 Acc 0.9725166666666667 (116702/120000), AUC 0.9948115348815918
Test Epoch15 layer0 Acc 0.9089473684210526, AUC 0.9792139530181885
Test Epoch15 layer1 Acc 0.9038157894736842, AUC 0.9737812280654907
Test Epoch15 layer2 Acc 0.9040789473684211, AUC 0.9726471900939941
Test Epoch15 layer3 Acc 0.9046052631578947, AUC 0.9706935286521912
Test Epoch15 layer4 Acc 0.9047368421052632, AUC 0.9698460102081299
gc 0
[[6.38911743e+02 3.74813361e+01]
 [2.06135065e-04 1.25988173e+01]
 [4.29248386e-04 1.06215618e+01]
 [7.60792456e-04 9.87593566e+00]
 [1.17540867e-03 9.60254817e+00]]
Train Epoch16 Acc 0.97435 (116922/120000), AUC 0.9949678778648376
Test Epoch16 layer0 Acc 0.9094736842105263, AUC 0.9793574213981628
Test Epoch16 layer1 Acc 0.9063157894736842, AUC 0.9747203588485718
Test Epoch16 layer2 Acc 0.9073684210526316, AUC 0.9744943976402283
Test Epoch16 layer3 Acc 0.906578947368421, AUC 0.9723737239837646
Test Epoch16 layer4 Acc 0.906578947368421, AUC 0.972527027130127
gc 0
[[6.38911743e+02 3.73426002e+01]
 [2.85135503e-04 1.17701691e+01]
 [6.88219665e-04 9.86960042e+00]
 [1.26214588e-03 9.17541884e+00]
 [2.06746725e-03 8.92633749e+00]]
Train Epoch17 Acc 0.9765 (117180/120000), AUC 0.9951151609420776
Test Epoch17 layer0 Acc 0.91, AUC 0.9791589379310608
Test Epoch17 layer1 Acc 0.9027631578947368, AUC 0.9728370904922485
Test Epoch17 layer2 Acc 0.9053947368421053, AUC 0.9725882411003113
Test Epoch17 layer3 Acc 0.9056578947368421, AUC 0.9697766900062561
Test Epoch17 layer4 Acc 0.9055263157894737, AUC 0.9693328142166138
gc 0
[[6.38911743e+02 3.72370082e+01]
 [1.74865523e-04 1.11859494e+01]
 [3.60301665e-04 9.35985045e+00]
 [6.36231895e-04 8.70502369e+00]
 [9.95328441e-04 8.47773341e+00]]
Train Epoch18 Acc 0.9779833333333333 (117358/120000), AUC 0.9953339099884033
Test Epoch18 layer0 Acc 0.9111842105263158, AUC 0.9788691401481628
Test Epoch18 layer1 Acc 0.9001315789473684, AUC 0.9702869057655334
Test Epoch18 layer2 Acc 0.9001315789473684, AUC 0.9685055017471313
Test Epoch18 layer3 Acc 0.9014473684210527, AUC 0.9658312797546387
Test Epoch18 layer4 Acc 0.901578947368421, AUC 0.9664744138717651
gc 0
[[6.38911743e+02 3.71431749e+01]
 [2.08569112e-04 1.04343725e+01]
 [4.59877684e-04 8.69768556e+00]
 [8.12395808e-04 8.08393749e+00]
 [1.23113573e-03 7.86700395e+00]]
Train Epoch19 Acc 0.9798333333333333 (117580/120000), AUC 0.995422899723053
Test Epoch19 layer0 Acc 0.9103947368421053, AUC 0.9789578914642334
Test Epoch19 layer1 Acc 0.9006578947368421, AUC 0.9698169827461243
Test Epoch19 layer2 Acc 0.9002631578947369, AUC 0.9693223834037781
Test Epoch19 layer3 Acc 0.9011842105263158, AUC 0.9685797095298767
Test Epoch19 layer4 Acc 0.9013157894736842, AUC 0.969265341758728
gc 0
[[6.38911743e+02 3.70195466e+01]
 [1.69291982e-04 9.80910152e+00]
 [3.61773731e-04 8.14964324e+00]
 [7.04845368e-04 7.57907651e+00]
 [1.20290708e-03 7.38192138e+00]]
Train Epoch20 Acc 0.9810833333333333 (117730/120000), AUC 0.9957130551338196
Test Epoch20 layer0 Acc 0.9107894736842105, AUC 0.9793063402175903
Test Epoch20 layer1 Acc 0.8989473684210526, AUC 0.9693307876586914
Test Epoch20 layer2 Acc 0.8998684210526315, AUC 0.9676910042762756
Test Epoch20 layer3 Acc 0.8997368421052632, AUC 0.9648931622505188
Test Epoch20 layer4 Acc 0.9, AUC 0.9655320644378662
gc 0
[[6.38911743e+02 3.69131478e+01]
 [2.07028284e-04 9.35304905e+00]
 [4.60029551e-04 7.74109446e+00]
 [8.75737322e-04 7.19919304e+00]
 [1.37810845e-03 7.01497895e+00]]
Train Epoch21 Acc 0.9822916666666667 (117875/120000), AUC 0.9958651065826416
Test Epoch21 layer0 Acc 0.9090789473684211, AUC 0.9792443513870239
Test Epoch21 layer1 Acc 0.8989473684210526, AUC 0.9683786630630493
Test Epoch21 layer2 Acc 0.8994736842105263, AUC 0.9668319225311279
Test Epoch21 layer3 Acc 0.9003947368421052, AUC 0.9672945737838745
Test Epoch21 layer4 Acc 0.9007894736842105, AUC 0.9674710035324097
gc 0
[[6.38911743e+02 3.68182937e+01]
 [2.66542086e-04 8.77302893e+00]
 [5.98709315e-04 7.26101883e+00]
 [1.00580970e-03 6.76420200e+00]
 [1.54728471e-03 6.60152624e+00]]
Train Epoch22 Acc 0.9835333333333334 (118024/120000), AUC 0.9958730340003967
Test Epoch22 layer0 Acc 0.9084210526315789, AUC 0.9791646003723145
Test Epoch22 layer1 Acc 0.8998684210526315, AUC 0.9684119820594788
Test Epoch22 layer2 Acc 0.9010526315789473, AUC 0.9680388569831848
Test Epoch22 layer3 Acc 0.9006578947368421, AUC 0.9675121307373047
Test Epoch22 layer4 Acc 0.9002631578947369, AUC 0.9662063121795654
gc 0
[[6.38911743e+02 3.67310777e+01]
 [1.76873234e-04 8.35507230e+00]
 [3.98735229e-04 6.87727137e+00]
 [7.77691429e-04 6.38894762e+00]
 [1.27750010e-03 6.23512186e+00]]
Train Epoch23 Acc 0.9844916666666667 (118139/120000), AUC 0.996027946472168
Test Epoch23 layer0 Acc 0.9105263157894737, AUC 0.9790284633636475
Test Epoch23 layer1 Acc 0.8990789473684211, AUC 0.9672396779060364
Test Epoch23 layer2 Acc 0.8996052631578947, AUC 0.964553713798523
Test Epoch23 layer3 Acc 0.9005263157894737, AUC 0.962023913860321
Test Epoch23 layer4 Acc 0.9003947368421052, AUC 0.9608737230300903
gc 0
[[6.38911743e+02 3.66659364e+01]
 [2.00342583e-04 7.85390944e+00]
 [4.93858099e-04 6.46389100e+00]
 [8.92051354e-04 6.01238399e+00]
 [1.39277652e-03 5.88395190e+00]]
Train Epoch24 Acc 0.985575 (118269/120000), AUC 0.9960145950317383
Test Epoch24 layer0 Acc 0.9097368421052632, AUC 0.9792913198471069
Test Epoch24 layer1 Acc 0.8977631578947368, AUC 0.9660674929618835
Test Epoch24 layer2 Acc 0.8980263157894737, AUC 0.9639333486557007
Test Epoch24 layer3 Acc 0.8986842105263158, AUC 0.9623104929924011
Test Epoch24 layer4 Acc 0.8984210526315789, AUC 0.961760938167572
gc 0
[[6.38911743e+02 3.66086652e+01]
 [2.08474996e-04 7.50575018e+00]
 [4.38243704e-04 6.13604762e+00]
 [7.54160593e-04 5.69165352e+00]
 [1.13746094e-03 5.56335528e+00]]
Train Epoch25 Acc 0.9864166666666667 (118370/120000), AUC 0.996068000793457
Test Epoch25 layer0 Acc 0.9088157894736842, AUC 0.978971004486084
Test Epoch25 layer1 Acc 0.8967105263157895, AUC 0.9674503207206726
Test Epoch25 layer2 Acc 0.8977631578947368, AUC 0.9672414064407349
Test Epoch25 layer3 Acc 0.8984210526315789, AUC 0.9656376838684082
Test Epoch25 layer4 Acc 0.8992105263157895, AUC 0.9654891490936279
gc 0
[[6.38911743e+02 3.65380459e+01]
 [2.10522579e-04 7.21678145e+00]
 [4.62061544e-04 5.94047108e+00]
 [8.38882437e-04 5.51420866e+00]
 [1.29101918e-03 5.39682967e+00]]
Train Epoch26 Acc 0.987 (118440/120000), AUC 0.9962491989135742
Test Epoch26 layer0 Acc 0.9085526315789474, AUC 0.978905439376831
Test Epoch26 layer1 Acc 0.8984210526315789, AUC 0.964963436126709
Test Epoch26 layer2 Acc 0.8984210526315789, AUC 0.9625942707061768
Test Epoch26 layer3 Acc 0.8989473684210526, AUC 0.9592007398605347
Test Epoch26 layer4 Acc 0.8994736842105263, AUC 0.9582076072692871
gc 0
[[6.38911743e+02 3.64761101e+01]
 [1.80898169e-04 6.83421631e+00]
 [4.00151438e-04 5.60252302e+00]
 [7.04883409e-04 5.18885473e+00]
 [1.09558975e-03 5.06915859e+00]]
Train Epoch27 Acc 0.9878666666666667 (118544/120000), AUC 0.9965474009513855
Test Epoch27 layer0 Acc 0.9089473684210526, AUC 0.9787815809249878
Test Epoch27 layer1 Acc 0.895921052631579, AUC 0.9650405645370483
Test Epoch27 layer2 Acc 0.8975, AUC 0.9628389477729797
Test Epoch27 layer3 Acc 0.8977631578947368, AUC 0.9613510966300964
Test Epoch27 layer4 Acc 0.8976315789473684, AUC 0.96037757396698
gc 0
[[6.38911743e+02 3.64152036e+01]
 [1.98625978e-04 6.55361919e+00]
 [4.30466910e-04 5.32241223e+00]
 [7.60344724e-04 4.93377067e+00]
 [1.17847815e-03 4.82182674e+00]]
Train Epoch28 Acc 0.98835 (118602/120000), AUC 0.9966364502906799
Test Epoch28 layer0 Acc 0.9089473684210526, AUC 0.9793126583099365
Test Epoch28 layer1 Acc 0.8972368421052631, AUC 0.9674060344696045
Test Epoch28 layer2 Acc 0.8975, AUC 0.9661161303520203
Test Epoch28 layer3 Acc 0.8975, AUC 0.9619232416152954
Test Epoch28 layer4 Acc 0.8976315789473684, AUC 0.9607065320014954
gc 0
[[6.38911743e+02 3.63285305e+01]
 [1.70863915e-04 6.32227948e+00]
 [3.76714861e-04 5.13221402e+00]
 [6.60891745e-04 4.74957784e+00]
 [9.84124455e-04 4.63811670e+00]]
Train Epoch29 Acc 0.9889 (118668/120000), AUC 0.9967195987701416
Test Epoch29 layer0 Acc 0.9075, AUC 0.978554368019104
Test Epoch29 layer1 Acc 0.8926315789473684, AUC 0.9620913863182068
Test Epoch29 layer2 Acc 0.8934210526315789, AUC 0.9587459564208984
Test Epoch29 layer3 Acc 0.8935526315789474, AUC 0.9539221525192261
Test Epoch29 layer4 Acc 0.8932894736842105, AUC 0.9519201517105103
gc 0
[[6.38911743e+02 3.62721424e+01]
 [2.06249196e-04 6.12302935e+00]
 [4.48039941e-04 4.98301968e+00]
 [7.99651729e-04 4.60592946e+00]
 [1.27623944e-03 4.49832806e+00]]
Train Epoch30 Acc 0.98935 (118722/120000), AUC 0.9969240427017212
Test Epoch30 layer0 Acc 0.9092105263157895, AUC 0.9782313704490662
Test Epoch30 layer1 Acc 0.896578947368421, AUC 0.9635147452354431
Test Epoch30 layer2 Acc 0.8981578947368422, AUC 0.9607970118522644
Test Epoch30 layer3 Acc 0.8980263157894737, AUC 0.9562462568283081
Test Epoch30 layer4 Acc 0.8980263157894737, AUC 0.9543561935424805
gc 0
[[6.38911743e+02 3.62436532e+01]
 [1.54658864e-04 5.84597511e+00]
 [3.23243909e-04 4.73003548e+00]
 [5.64217116e-04 4.37562483e+00]
 [8.51965074e-04 4.27577020e+00]]
Train Epoch31 Acc 0.9896166666666667 (118754/120000), AUC 0.9968716502189636
Test Epoch31 layer0 Acc 0.9077631578947368, AUC 0.9788011312484741
Test Epoch31 layer1 Acc 0.8975, AUC 0.9637845158576965
Test Epoch31 layer2 Acc 0.8976315789473684, AUC 0.9604678153991699
Test Epoch31 layer3 Acc 0.8981578947368422, AUC 0.9548683762550354
Test Epoch31 layer4 Acc 0.8981578947368422, AUC 0.9552823305130005
gc 0
[[6.38911743e+02 3.61664555e+01]
 [2.35663687e-04 5.57455340e+00]
 [5.54619057e-04 4.51436920e+00]
 [1.06989070e-03 4.17365513e+00]
 [1.70564319e-03 4.07630442e+00]]
Train Epoch32 Acc 0.99045 (118854/120000), AUC 0.9970324635505676
Test Epoch32 layer0 Acc 0.9076315789473685, AUC 0.9788538217544556
Test Epoch32 layer1 Acc 0.8960526315789473, AUC 0.9640103578567505
Test Epoch32 layer2 Acc 0.8973684210526316, AUC 0.9639919996261597
Test Epoch32 layer3 Acc 0.8976315789473684, AUC 0.9568397998809814
Test Epoch32 layer4 Acc 0.8976315789473684, AUC 0.9566560983657837
gc 0
[[6.38911743e+02 3.61433449e+01]
 [1.90764058e-04 5.35479134e+00]
 [4.28274150e-04 4.32993077e+00]
 [7.14013539e-04 4.00274067e+00]
 [1.07904721e-03 3.90734819e+00]]
Train Epoch33 Acc 0.9906833333333334 (118882/120000), AUC 0.9972003102302551
Test Epoch33 layer0 Acc 0.906578947368421, AUC 0.9788763523101807
Test Epoch33 layer1 Acc 0.8938157894736842, AUC 0.9622085690498352
Test Epoch33 layer2 Acc 0.8944736842105263, AUC 0.9593176245689392
Test Epoch33 layer3 Acc 0.8940789473684211, AUC 0.9535280466079712
Test Epoch33 layer4 Acc 0.8939473684210526, AUC 0.9532486200332642
gc 0
[[6.38911743e+02 3.60892947e+01]
 [2.31849699e-04 5.22941247e+00]
 [5.20861311e-04 4.22281075e+00]
 [9.02619999e-04 3.90292400e+00]
 [1.30294411e-03 3.80903133e+00]]
Train Epoch34 Acc 0.9910083333333334 (118921/120000), AUC 0.9973515868186951
Test Epoch34 layer0 Acc 0.9075, AUC 0.9786356687545776
Test Epoch34 layer1 Acc 0.8946052631578948, AUC 0.962333619594574
Test Epoch34 layer2 Acc 0.8952631578947369, AUC 0.9592750072479248
Test Epoch34 layer3 Acc 0.895921052631579, AUC 0.9528875350952148
Test Epoch34 layer4 Acc 0.8963157894736842, AUC 0.9520537853240967
gc 0
[[6.38911743e+02 3.60528754e+01]
 [1.86560823e-04 5.05548632e+00]
 [3.91404804e-04 4.09076477e+00]
 [6.57077751e-04 3.77669412e+00]
 [9.90748407e-04 3.68686912e+00]]
Train Epoch35 Acc 0.9912916666666667 (118955/120000), AUC 0.9974214434623718
Test Epoch35 layer0 Acc 0.9084210526315789, AUC 0.9787532091140747
Test Epoch35 layer1 Acc 0.8938157894736842, AUC 0.9632800221443176
Test Epoch35 layer2 Acc 0.8946052631578948, AUC 0.9595504999160767
Test Epoch35 layer3 Acc 0.8952631578947369, AUC 0.9542129039764404
Test Epoch35 layer4 Acc 0.8947368421052632, AUC 0.9530991315841675
gc 0
[[6.38911743e+02 3.60123383e+01]
 [1.91814361e-04 4.80097875e+00]
 [4.02816165e-04 3.85791670e+00]
 [6.95211589e-04 3.55211993e+00]
 [1.06588896e-03 3.45911252e+00]]
Train Epoch36 Acc 0.9917833333333334 (119014/120000), AUC 0.9974958896636963
Test Epoch36 layer0 Acc 0.9085526315789474, AUC 0.9786988496780396
Test Epoch36 layer1 Acc 0.8913157894736842, AUC 0.9620228409767151
Test Epoch36 layer2 Acc 0.8927631578947368, AUC 0.9611859321594238
Test Epoch36 layer3 Acc 0.8927631578947368, AUC 0.9534683227539062
Test Epoch36 layer4 Acc 0.8928947368421053, AUC 0.9563920497894287
gc 0
[[6.38911743e+02 3.59820082e+01]
 [1.96788098e-04 4.72032470e+00]
 [4.41276096e-04 3.81286386e+00]
 [7.69654521e-04 3.51464946e+00]
 [1.16970483e-03 3.42592837e+00]]
Train Epoch37 Acc 0.9919583333333334 (119035/120000), AUC 0.9976356029510498
Test Epoch37 layer0 Acc 0.9077631578947368, AUC 0.9787036180496216
Test Epoch37 layer1 Acc 0.895, AUC 0.9601917862892151
Test Epoch37 layer2 Acc 0.8961842105263158, AUC 0.958527684211731
Test Epoch37 layer3 Acc 0.896578947368421, AUC 0.9518136382102966
Test Epoch37 layer4 Acc 0.8969736842105264, AUC 0.9516924023628235
gc 0
[[6.38911743e+02 3.59471184e+01]
 [1.68537378e-04 4.59868283e+00]
 [3.83975018e-04 3.70527467e+00]
 [6.93627358e-04 3.41599370e+00]
 [1.02198697e-03 3.33007809e+00]]
Train Epoch38 Acc 0.9921166666666666 (119054/120000), AUC 0.9978289604187012
Test Epoch38 layer0 Acc 0.9093421052631578, AUC 0.9785779714584351
Test Epoch38 layer1 Acc 0.8952631578947369, AUC 0.9603626132011414
Test Epoch38 layer2 Acc 0.8956578947368421, AUC 0.9586958885192871
Test Epoch38 layer3 Acc 0.8964473684210527, AUC 0.952332615852356
Test Epoch38 layer4 Acc 0.8963157894736842, AUC 0.9531875848770142
gc 0
[[6.38911743e+02 3.58903231e+01]
 [2.05988992e-04 4.35481169e+00]
 [4.60197593e-04 3.47967717e+00]
 [8.26587368e-04 3.19896334e+00]
 [1.23600539e-03 3.11181693e+00]]
Train Epoch39 Acc 0.9927083333333333 (119125/120000), AUC 0.9979463815689087
Test Epoch39 layer0 Acc 0.9075, AUC 0.9784272313117981
Test Epoch39 layer1 Acc 0.8973684210526316, AUC 0.9607453346252441
Test Epoch39 layer2 Acc 0.8973684210526316, AUC 0.9567514657974243
Test Epoch39 layer3 Acc 0.8976315789473684, AUC 0.9498189687728882
Test Epoch39 layer4 Acc 0.8975, AUC 0.9519993662834167
gc 0
[[6.38911743e+02 3.58716573e+01]
 [2.08592562e-04 4.26886699e+00]
 [4.45034381e-04 3.39409933e+00]
 [7.46564740e-04 3.12602207e+00]
 [1.08340636e-03 3.04266650e+00]]
Train Epoch40 Acc 0.9928 (119136/120000), AUC 0.9979317784309387
Test Epoch40 layer0 Acc 0.906578947368421, AUC 0.9786736369132996
Test Epoch40 layer1 Acc 0.895921052631579, AUC 0.9594756364822388
Test Epoch40 layer2 Acc 0.895, AUC 0.9575335383415222
Test Epoch40 layer3 Acc 0.8952631578947369, AUC 0.9499350786209106
Test Epoch40 layer4 Acc 0.8957894736842106, AUC 0.9505835771560669
gc 0
[[6.38911743e+02 3.58351933e+01]
 [1.83100162e-04 4.16719723e+00]
 [3.75048958e-04 3.32480153e+00]
 [6.53527766e-04 3.06396517e+00]
 [9.58701394e-04 2.98383852e+00]]
Train Epoch41 Acc 0.9929166666666667 (119150/120000), AUC 0.9980896711349487
Test Epoch41 layer0 Acc 0.9078947368421053, AUC 0.9784592390060425
Test Epoch41 layer1 Acc 0.8934210526315789, AUC 0.9595069885253906
Test Epoch41 layer2 Acc 0.8938157894736842, AUC 0.9575254917144775
Test Epoch41 layer3 Acc 0.8934210526315789, AUC 0.9493680596351624
Test Epoch41 layer4 Acc 0.8935526315789474, AUC 0.9509358406066895
gc 0
[[6.38911743e+02 3.58062261e+01]
 [1.86389384e-04 4.09524968e+00]
 [3.96442832e-04 3.25533922e+00]
 [6.77425432e-04 2.99010975e+00]
 [1.01075670e-03 2.90289066e+00]]
Train Epoch42 Acc 0.993175 (119181/120000), AUC 0.9981222748756409
Test Epoch42 layer0 Acc 0.9071052631578947, AUC 0.9785715341567993
Test Epoch42 layer1 Acc 0.8972368421052631, AUC 0.9615706205368042
Test Epoch42 layer2 Acc 0.8984210526315789, AUC 0.959384024143219
Test Epoch42 layer3 Acc 0.8982894736842105, AUC 0.9523895978927612
Test Epoch42 layer4 Acc 0.8988157894736842, AUC 0.9514918327331543
gc 0
[[6.38911743e+02 3.57480110e+01]
 [2.31210126e-04 3.97868313e+00]
 [4.87700343e-04 3.15900331e+00]
 [8.09319728e-04 2.90573991e+00]
 [1.17662334e-03 2.82492857e+00]]
Train Epoch43 Acc 0.9933416666666667 (119201/120000), AUC 0.9982333183288574
Test Epoch43 layer0 Acc 0.9086842105263158, AUC 0.9783861041069031
Test Epoch43 layer1 Acc 0.8963157894736842, AUC 0.9590729475021362
Test Epoch43 layer2 Acc 0.8964473684210527, AUC 0.95707106590271
Test Epoch43 layer3 Acc 0.8972368421052631, AUC 0.9482883214950562
Test Epoch43 layer4 Acc 0.8972368421052631, AUC 0.9498836994171143
gc 0
[[6.38911743e+02 3.57358636e+01]
 [2.05261662e-04 3.79059529e+00]
 [4.45408838e-04 3.00278886e+00]
 [7.95239049e-04 2.75877107e+00]
 [1.23766288e-03 2.67947861e+00]]
Train Epoch44 Acc 0.9935833333333334 (119230/120000), AUC 0.9983460903167725
Test Epoch44 layer0 Acc 0.9064473684210527, AUC 0.9782357215881348
Test Epoch44 layer1 Acc 0.8943421052631579, AUC 0.958612322807312
Test Epoch44 layer2 Acc 0.8931578947368422, AUC 0.9562458395957947
Test Epoch44 layer3 Acc 0.8935526315789474, AUC 0.9508309364318848
Test Epoch44 layer4 Acc 0.8930263157894737, AUC 0.9534368515014648
gc 0
[[6.38911743e+02 3.57088529e+01]
 [1.71879418e-04 3.75913401e+00]
 [3.82707939e-04 2.97265149e+00]
 [6.62943956e-04 2.72707650e+00]
 [9.98281809e-04 2.64506686e+00]]
Train Epoch45 Acc 0.9936666666666667 (119240/120000), AUC 0.9983567595481873
Test Epoch45 layer0 Acc 0.9069736842105263, AUC 0.9780681729316711
Test Epoch45 layer1 Acc 0.8967105263157895, AUC 0.9578767418861389
Test Epoch45 layer2 Acc 0.8969736842105264, AUC 0.9559423923492432
Test Epoch45 layer3 Acc 0.8972368421052631, AUC 0.9471151828765869
Test Epoch45 layer4 Acc 0.8975, AUC 0.9491060972213745
gc 0
[[6.38911743e+02 3.56855732e+01]
 [1.78899078e-04 3.76899316e+00]
 [3.84514318e-04 2.96699741e+00]
 [6.54914640e-04 2.72175774e+00]
 [9.55704426e-04 2.64197949e+00]]
Train Epoch46 Acc 0.993775 (119253/120000), AUC 0.9984169006347656
Test Epoch46 layer0 Acc 0.9072368421052631, AUC 0.9785762429237366
Test Epoch46 layer1 Acc 0.8946052631578948, AUC 0.9597558975219727
Test Epoch46 layer2 Acc 0.8957894736842106, AUC 0.9581252932548523
Test Epoch46 layer3 Acc 0.8956578947368421, AUC 0.9513216018676758
Test Epoch46 layer4 Acc 0.8956578947368421, AUC 0.954264760017395
gc 0
[[6.38911743e+02 3.56605808e+01]
 [2.37518884e-04 3.57804785e+00]
 [5.21582420e-04 2.80683399e+00]
 [9.15914322e-04 2.56833241e+00]
 [1.36165844e-03 2.48470441e+00]]
Train Epoch47 Acc 0.994 (119280/120000), AUC 0.9984784126281738
Test Epoch47 layer0 Acc 0.9072368421052631, AUC 0.9782352447509766
Test Epoch47 layer1 Acc 0.8931578947368422, AUC 0.9592013955116272
Test Epoch47 layer2 Acc 0.8955263157894737, AUC 0.9536685943603516
Test Epoch47 layer3 Acc 0.8952631578947369, AUC 0.9476640820503235
Test Epoch47 layer4 Acc 0.8947368421052632, AUC 0.949507474899292
gc 0
[[6.38911743e+02 3.56128908e+01]
 [1.62231214e-04 3.52482000e+00]
 [3.51212160e-04 2.74379999e+00]
 [6.05817441e-04 2.50807549e+00]
 [9.02419644e-04 2.42373754e+00]]
Train Epoch48 Acc 0.994175 (119301/120000), AUC 0.9985775947570801
Test Epoch48 layer0 Acc 0.9076315789473685, AUC 0.9784597754478455
Test Epoch48 layer1 Acc 0.895921052631579, AUC 0.9608331918716431
Test Epoch48 layer2 Acc 0.8961842105263158, AUC 0.9581527709960938
Test Epoch48 layer3 Acc 0.8968421052631579, AUC 0.9513671398162842
Test Epoch48 layer4 Acc 0.8964473684210527, AUC 0.954264223575592
gc 0
[[6.38911743e+02 3.56042888e+01]
 [2.65632792e-04 3.35463227e+00]
 [5.66967625e-04 2.60098078e+00]
 [1.00600151e-03 2.37792356e+00]
 [1.53485055e-03 2.30263374e+00]]
Train Epoch49 Acc 0.99445 (119334/120000), AUC 0.9986609220504761
Test Epoch49 layer0 Acc 0.9073684210526316, AUC 0.9785155653953552
Test Epoch49 layer1 Acc 0.8957894736842106, AUC 0.9572418332099915
Test Epoch49 layer2 Acc 0.8957894736842106, AUC 0.9563192129135132
Test Epoch49 layer3 Acc 0.8961842105263158, AUC 0.9481208324432373
Test Epoch49 layer4 Acc 0.8956578947368421, AUC 0.9512650966644287
Best AUC 0.9843928813934326
train_loss (2, 5, 50)
valid_acc (5, 50)
valid_AUC (5, 50)
train_acc (50,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt//ag_news/ag_news_lstmal_l5.pt
[[1708   60   85   47]
 [  15 1867    9    9]
 [  45   18 1683  154]
 [  49   18  135 1698]]
Figure(640x480)
[[1727   52   66   55]
 [  22 1857   10   11]
 [  60   15 1673  152]
 [  51   13  129 1707]]
Figure(640x480)
[[1724   53   65   58]
 [  20 1857   10   13]
 [  59   15 1672  154]
 [  49   13  132 1706]]
Figure(640x480)
[[1724   53   64   59]
 [  20 1855   10   15]
 [  61   14 1665  160]
 [  48   13  128 1711]]
Figure(640x480)
[[1726   53   64   57]
 [  22 1855    9   14]
 [  66   15 1664  155]
 [  51   14  131 1704]]
Figure(640x480)
