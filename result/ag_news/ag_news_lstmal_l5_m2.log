total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask1//ag_news/ag_news_lstmal_l5_m1.pt
Start Training
gc 9
[[320.07169986   9.91548276]
 [ 11.94511147  18.81121296]
 [223.90515581 127.33873723]
 [178.97625831  96.68847506]
 [153.21874987  81.53918747]]
Train Epoch0 Acc 0.25635833333333335 (30763/120000), AUC 0.4154842495918274
Test Epoch0 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch0 layer1 Acc 0.9127631578947368, AUC 0.9809959530830383
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.41368421052631577, AUC 0.48221948742866516
Test Epoch0 layer3 Acc 0.07263157894736842, AUC 0.1350751668214798
Test Epoch0 layer4 Acc 0.2644736842105263, AUC 0.390926718711853
gc 0
[[3.20071700e+02 9.90440848e+00]
 [8.76539598e-11 8.07600071e+00]
 [2.36047699e+02 1.33130319e+02]
 [1.87553291e+02 1.01216831e+02]
 [1.59432594e+02 8.51534860e+01]]
Train Epoch1 Acc 0.2512666666666667 (30152/120000), AUC 0.3980618119239807
Test Epoch1 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch1 layer1 Acc 0.9146052631578947, AUC 0.9821224212646484
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2.pt  ,ep 1
Test Epoch1 layer2 Acc 0.45644736842105266, AUC 0.5532416701316833
Test Epoch1 layer3 Acc 0.09657894736842106, AUC 0.11783218383789062
Test Epoch1 layer4 Acc 0.24776315789473685, AUC 0.4040476083755493
gc 0
[[3.20071700e+02 9.91132924e+00]
 [2.82697981e-12 7.20340043e+00]
 [2.36045219e+02 1.34228885e+02]
 [1.87552481e+02 1.01568933e+02]
 [1.59433607e+02 8.54295693e+01]]
Train Epoch2 Acc 0.23891666666666667 (28670/120000), AUC 0.4107625484466553
Test Epoch2 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch2 layer1 Acc 0.9139473684210526, AUC 0.9827616214752197
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2.pt  ,ep 2
Test Epoch2 layer2 Acc 0.4625, AUC 0.5865529179573059
Test Epoch2 layer3 Acc 0.09013157894736842, AUC 0.10845386981964111
Test Epoch2 layer4 Acc 0.23644736842105263, AUC 0.4164307117462158
gc 0
[[3.20071700e+02 9.91179815e+00]
 [8.74073966e-13 6.74647629e+00]
 [2.36049952e+02 1.34593439e+02]
 [1.87552766e+02 1.01863142e+02]
 [1.59431119e+02 8.57384132e+01]]
Train Epoch3 Acc 0.23681666666666668 (28418/120000), AUC 0.41542109847068787
Test Epoch3 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch3 layer1 Acc 0.9125, AUC 0.9828870296478271
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2.pt  ,ep 3
Test Epoch3 layer2 Acc 0.46960526315789475, AUC 0.6039025187492371
Test Epoch3 layer3 Acc 0.10171052631578947, AUC 0.10755936801433563
Test Epoch3 layer4 Acc 0.2355263157894737, AUC 0.41743987798690796
gc 0
[[3.20071701e+02 9.91707497e+00]
 [7.63183622e-13 6.46328638e+00]
 [2.36047213e+02 1.35166752e+02]
 [1.87552379e+02 1.02093569e+02]
 [1.59432108e+02 8.58399724e+01]]
Train Epoch4 Acc 0.233025 (27963/120000), AUC 0.4176698923110962
Test Epoch4 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch4 layer1 Acc 0.9122368421052631, AUC 0.982988178730011
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2.pt  ,ep 4
Test Epoch4 layer2 Acc 0.4673684210526316, AUC 0.6096019148826599
Test Epoch4 layer3 Acc 0.10868421052631579, AUC 0.10975642502307892
Test Epoch4 layer4 Acc 0.23828947368421052, AUC 0.4134192168712616
gc 0
[[3.20071700e+02 9.90866842e+00]
 [9.22311916e-13 6.22787160e+00]
 [2.36045930e+02 1.35574368e+02]
 [1.87551261e+02 1.02238012e+02]
 [1.59431744e+02 8.59423523e+01]]
Train Epoch5 Acc 0.23719166666666666 (28463/120000), AUC 0.41548481583595276
Test Epoch5 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch5 layer1 Acc 0.9140789473684211, AUC 0.9833219647407532
Save ckpt to ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2.pt  ,ep 5
Test Epoch5 layer2 Acc 0.47171052631578947, AUC 0.6167181730270386
Test Epoch5 layer3 Acc 0.10868421052631579, AUC 0.10227765142917633
Test Epoch5 layer4 Acc 0.23460526315789473, AUC 0.40920138359069824
gc 0
[[3.20071699e+02 9.91312767e+00]
 [1.25142057e-12 6.03269782e+00]
 [2.36044358e+02 1.35467126e+02]
 [1.87550323e+02 1.02185001e+02]
 [1.59431452e+02 8.59179117e+01]]
Train Epoch6 Acc 0.23771666666666666 (28526/120000), AUC 0.4106043875217438
Test Epoch6 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch6 layer1 Acc 0.9128947368421053, AUC 0.9829214811325073
Test Epoch6 layer2 Acc 0.47592105263157897, AUC 0.6157364845275879
Test Epoch6 layer3 Acc 0.10447368421052632, AUC 0.09828975796699524
Test Epoch6 layer4 Acc 0.2475, AUC 0.4114338457584381
gc 0
[[3.20071700e+02 9.91046680e+00]
 [1.88823523e-12 5.86092009e+00]
 [2.36045196e+02 1.35642664e+02]
 [1.87552163e+02 1.02153689e+02]
 [1.59432881e+02 8.60132887e+01]]
Train Epoch7 Acc 0.24854166666666666 (29825/120000), AUC 0.4091290831565857
Test Epoch7 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch7 layer1 Acc 0.9134210526315789, AUC 0.9829791784286499
Test Epoch7 layer2 Acc 0.4744736842105263, AUC 0.6149033308029175
Test Epoch7 layer3 Acc 0.09526315789473684, AUC 0.10580417513847351
Test Epoch7 layer4 Acc 0.2567105263157895, AUC 0.4109908938407898
gc 0
[[3.20071702e+02 9.90971990e+00]
 [3.69293963e-12 5.71296097e+00]
 [2.36047261e+02 1.35901786e+02]
 [1.87552171e+02 1.02135642e+02]
 [1.59432387e+02 8.59413428e+01]]
Train Epoch8 Acc 0.251175 (30141/120000), AUC 0.40789517760276794
Test Epoch8 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch8 layer1 Acc 0.9125, AUC 0.9827135801315308
Test Epoch8 layer2 Acc 0.475, AUC 0.6149674654006958
Test Epoch8 layer3 Acc 0.0838157894736842, AUC 0.0994248241186142
Test Epoch8 layer4 Acc 0.25592105263157894, AUC 0.4066188335418701
gc 0
[[3.20071700e+02 9.90975906e+00]
 [3.45074039e-06 5.56211495e+00]
 [2.36047813e+02 1.36026930e+02]
 [1.87552812e+02 1.02315892e+02]
 [1.59431470e+02 8.60484526e+01]]
Train Epoch9 Acc 0.2539 (30468/120000), AUC 0.4076317548751831
Test Epoch9 layer0 Acc 0.9155263157894736, AUC 0.9815508127212524
Test Epoch9 layer1 Acc 0.9114473684210527, AUC 0.9824548363685608
Test Epoch9 layer2 Acc 0.47578947368421054, AUC 0.6215165257453918
Test Epoch9 layer3 Acc 0.08697368421052631, AUC 0.0999942272901535
Test Epoch9 layer4 Acc 0.25092105263157893, AUC 0.4045589566230774
Best AUC 0.9833219647407532
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//ag_news/ag_news_lstmal_l5_m2.pt
[[1710   59   84   47]
 [  12 1874    5    9]
 [  56   17 1646  181]
 [  55   12  105 1728]]
Figure(640x480)
[[1724   48   71   57]
 [  23 1850   14   13]
 [  58   10 1652  180]
 [  50   13  116 1721]]
Figure(640x480)
[[   0 1798    0  102]
 [   0 1866    0   34]
 [   0   96    0 1804]
 [   0  180    1 1719]]
Figure(640x480)
[[  17 1010  858   15]
 [   3    1 1895    1]
 [ 883   43  800  174]
 [  19    9 1864    8]]
Figure(640x480)
[[   0    0 1252  648]
 [   3    0   11 1886]
 [   0    0 1360  540]
 [   0    0 1477  423]]
Figure(640x480)
