total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask2//ag_news/ag_news_linearal_l5_m2.pt
Start Training
gc 9
[[3.20103656e+02 1.00898519e+01]
 [3.88618212e-12 1.00177173e+01]
 [1.22019880e+01 1.53117119e+01]
 [2.19114421e+02 1.41628070e+02]
 [2.03135068e+02 1.10739246e+02]]
Train Epoch0 Acc 0.07635833333333333 (9163/120000), AUC 0.39038389921188354
Test Epoch0 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch0 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch0 layer2 Acc 0.9151315789473684, AUC 0.981465756893158
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.2706578947368421, AUC 0.5537492036819458
Test Epoch0 layer4 Acc 0.09157894736842105, AUC 0.3973698318004608
gc 0
[[3.20103658e+02 1.00938597e+01]
 [3.88621191e-12 1.00204859e+01]
 [1.30203323e-10 1.05717051e+01]
 [2.29791122e+02 1.50772627e+02]
 [2.10593230e+02 1.16140732e+02]]
Train Epoch1 Acc 0.10540833333333334 (12649/120000), AUC 0.39568889141082764
Test Epoch1 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch1 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch1 layer2 Acc 0.9152631578947369, AUC 0.981417179107666
Test Epoch1 layer3 Acc 0.2623684210526316, AUC 0.5662190914154053
Test Epoch1 layer4 Acc 0.14078947368421052, AUC 0.4011192321777344
gc 0
[[3.20103658e+02 1.00910739e+01]
 [3.88628554e-12 1.00181627e+01]
 [3.18460203e-12 1.01972568e+01]
 [2.29787951e+02 1.53814527e+02]
 [2.10593054e+02 1.18147135e+02]]
Train Epoch2 Acc 0.175275 (21033/120000), AUC 0.3918303847312927
Test Epoch2 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch2 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch2 layer2 Acc 0.9161842105263158, AUC 0.9814426302909851
Test Epoch2 layer3 Acc 0.25763157894736843, AUC 0.5568552017211914
Test Epoch2 layer4 Acc 0.20921052631578949, AUC 0.3924097418785095
gc 0
[[3.20103659e+02 1.00899604e+01]
 [3.88609764e-12 1.00157080e+01]
 [8.90222722e-13 9.97292165e+00]
 [2.29790304e+02 1.56572906e+02]
 [2.10590737e+02 1.20626772e+02]]
Train Epoch3 Acc 0.2297 (27564/120000), AUC 0.3838167190551758
Test Epoch3 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch3 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch3 layer2 Acc 0.9157894736842105, AUC 0.9815512895584106
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3.pt  ,ep 3
Test Epoch3 layer3 Acc 0.25, AUC 0.5382372140884399
Test Epoch3 layer4 Acc 0.24236842105263157, AUC 0.386111855506897
gc 0
[[3.20103656e+02 1.00912425e+01]
 [3.88641031e-12 1.00189160e+01]
 [7.54097751e-13 9.80604082e+00]
 [2.29790521e+02 1.60002396e+02]
 [2.10597207e+02 1.23553178e+02]]
Train Epoch4 Acc 0.245125 (29415/120000), AUC 0.3729597330093384
Test Epoch4 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch4 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch4 layer2 Acc 0.9153947368421053, AUC 0.9816282391548157
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3.pt  ,ep 4
Test Epoch4 layer3 Acc 0.23092105263157894, AUC 0.5195892453193665
Test Epoch4 layer4 Acc 0.24828947368421053, AUC 0.3752986788749695
gc 0
[[3.20103660e+02 1.00909443e+01]
 [3.88601421e-12 1.00189420e+01]
 [9.44975439e-13 9.64269016e+00]
 [2.29792729e+02 1.63694551e+02]
 [2.10589461e+02 1.26584183e+02]]
Train Epoch5 Acc 0.250125 (30015/120000), AUC 0.3623605966567993
Test Epoch5 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch5 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch5 layer2 Acc 0.9164473684210527, AUC 0.981752872467041
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3.pt  ,ep 5
Test Epoch5 layer3 Acc 0.20671052631578948, AUC 0.5031719207763672
Test Epoch5 layer4 Acc 0.2532894736842105, AUC 0.37075483798980713
gc 0
[[3.20103658e+02 1.00923364e+01]
 [3.88634032e-12 1.00193195e+01]
 [1.25217297e-12 9.47132938e+00]
 [2.29789690e+02 1.68328812e+02]
 [2.10595245e+02 1.30176840e+02]]
Train Epoch6 Acc 0.2552 (30624/120000), AUC 0.3613938093185425
Test Epoch6 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch6 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch6 layer2 Acc 0.915921052631579, AUC 0.9817288517951965
Test Epoch6 layer3 Acc 0.18078947368421053, AUC 0.48501622676849365
Test Epoch6 layer4 Acc 0.25960526315789473, AUC 0.3759714961051941
gc 0
[[3.20103664e+02 1.00961750e+01]
 [3.88597436e-12 1.00221303e+01]
 [2.06890990e-12 9.28379601e+00]
 [2.29794233e+02 1.74475833e+02]
 [2.10588542e+02 1.34489955e+02]]
Train Epoch7 Acc 0.26690833333333336 (32029/120000), AUC 0.37458840012550354
Test Epoch7 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch7 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch7 layer2 Acc 0.9157894736842105, AUC 0.9820224046707153
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3.pt  ,ep 7
Test Epoch7 layer3 Acc 0.1705263157894737, AUC 0.47141316533088684
Test Epoch7 layer4 Acc 0.2819736842105263, AUC 0.39661452174186707
gc 0
[[3.20103663e+02 1.00943142e+01]
 [3.88602531e-12 1.00203965e+01]
 [6.37668550e-08 9.08086277e+00]
 [2.29789817e+02 1.82569247e+02]
 [2.10586123e+02 1.39995928e+02]]
Train Epoch8 Acc 0.30230833333333335 (36277/120000), AUC 0.39451897144317627
Test Epoch8 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch8 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch8 layer2 Acc 0.9161842105263158, AUC 0.9822046160697937
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3.pt  ,ep 8
Test Epoch8 layer3 Acc 0.17289473684210527, AUC 0.4603627324104309
Test Epoch8 layer4 Acc 0.3318421052631579, AUC 0.41067785024642944
gc 0
[[3.20103658e+02 1.00907621e+01]
 [3.88608082e-12 1.00183725e+01]
 [5.19790782e-06 8.85883908e+00]
 [2.29791354e+02 1.92039626e+02]
 [2.10589936e+02 1.46538574e+02]]
Train Epoch9 Acc 0.360375 (43245/120000), AUC 0.40793105959892273
Test Epoch9 layer0 Acc 0.9136842105263158, AUC 0.981399416923523
Test Epoch9 layer1 Acc 0.915, AUC 0.9814504384994507
Test Epoch9 layer2 Acc 0.9160526315789473, AUC 0.9823267459869385
Save ckpt to ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3.pt  ,ep 9
Test Epoch9 layer3 Acc 0.16381578947368422, AUC 0.4497636556625366
Test Epoch9 layer4 Acc 0.39473684210526316, AUC 0.42160385847091675
Best AUC 0.9823267459869385
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//ag_news/ag_news_linearal_l5_m3.pt
[[1711   59   89   41]
 [  15 1865   10   10]
 [  50   15 1688  147]
 [  59   16  145 1680]]
Figure(640x480)
[[1706   60   90   44]
 [  14 1865   12    9]
 [  43   16 1698  143]
 [  56   14  145 1685]]
Figure(640x480)
[[1710   59   83   48]
 [  13 1869    9    9]
 [  45   17 1677  161]
 [  51   15  128 1706]]
Figure(640x480)
[[ 244 1651    0    5]
 [ 503 1001    0  396]
 [1859   37    0    4]
 [1864   36    0    0]]
Figure(640x480)
[[   0  372 1527    1]
 [   0 1838    8   54]
 [   0  654 1161   85]
 [   0  271 1628    1]]
Figure(640x480)
