total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask4//ag_news/ag_news_transformeral_l5_m4.pt
Start Training
gc 9
[[3.19790936e+02 1.05024847e+01]
 [2.16031493e-12 7.42183385e+00]
 [3.31903113e-06 5.62520130e+00]
 [6.86159818e-13 5.65040903e+00]
 [2.13018909e+00 1.60407034e+01]]
Train Epoch0 Acc 0.9178833333333334 (110146/120000), AUC 0.9821765422821045
Test Epoch0 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch0 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch0 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch0 layer3 Acc 0.9130263157894737, AUC 0.981311559677124
Test Epoch0 layer4 Acc 0.9130263157894737, AUC 0.9807994365692139
Save ckpt to ./ckpt/mask5//ag_news/ag_news_transformeral_l5_m5.pt  ,ep 0
gc 0
[[3.19790935e+02 1.04993230e+01]
 [2.16033011e-12 7.42096787e+00]
 [3.31900353e-06 5.62423529e+00]
 [6.86169596e-13 5.64972810e+00]
 [7.84752192e-13 6.06229406e+00]]
Train Epoch1 Acc 0.9502 (114024/120000), AUC 0.9928141832351685
Test Epoch1 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch1 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch1 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch1 layer3 Acc 0.9130263157894737, AUC 0.981311559677124
Test Epoch1 layer4 Acc 0.9128947368421053, AUC 0.9810798168182373
Save ckpt to ./ckpt/mask5//ag_news/ag_news_transformeral_l5_m5.pt  ,ep 1
gc 0
[[3.19790936e+02 1.04983160e+01]
 [2.16032320e-12 7.42242229e+00]
 [3.31893821e-06 5.62589966e+00]
 [6.86165961e-13 5.65133003e+00]
 [1.28211930e-12 5.38454142e+00]]
Train Epoch2 Acc 0.950575 (114069/120000), AUC 0.9930062294006348
Test Epoch2 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch2 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch2 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch2 layer3 Acc 0.9130263157894737, AUC 0.981311559677124
Test Epoch2 layer4 Acc 0.9114473684210527, AUC 0.9800939559936523
gc 0
[[3.19790935e+02 1.04991900e+01]
 [2.16031868e-12 7.42179941e+00]
 [3.31895777e-06 5.62496866e+00]
 [6.86164676e-13 5.65038078e+00]
 [2.30165215e-12 5.02644251e+00]]
Train Epoch3 Acc 0.950625 (114075/120000), AUC 0.9931490421295166
Test Epoch3 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch3 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch3 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch3 layer3 Acc 0.9130263157894737, AUC 0.981311559677124
Test Epoch3 layer4 Acc 0.9135526315789474, AUC 0.9807547330856323
gc 0
[[3.19790934e+02 1.04953853e+01]
 [2.16032470e-12 7.42182874e+00]
 [3.31885869e-06 5.62495180e+00]
 [6.86174471e-13 5.65027260e+00]
 [6.28850983e-06 4.85537757e+00]]
Train Epoch4 Acc 0.9504833333333333 (114058/120000), AUC 0.9931618571281433
Test Epoch4 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch4 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch4 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch4 layer3 Acc 0.9130263157894737, AUC 0.981311559677124
Test Epoch4 layer4 Acc 0.9119736842105263, AUC 0.9799885749816895
gc 0
[[3.19790934e+02 1.05005901e+01]
 [2.16030885e-12 7.42257393e+00]
 [3.31894311e-06 5.62624980e+00]
 [6.86165679e-13 5.65162983e+00]
 [3.06977573e-04 4.76636565e+00]]
Train Epoch5 Acc 0.9507833333333333 (114094/120000), AUC 0.9933151602745056
Test Epoch5 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch5 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch5 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch5 layer3 Acc 0.9130263157894737, AUC 0.981311559677124
Test Epoch5 layer4 Acc 0.9127631578947368, AUC 0.9802293181419373
gc 0
[[3.19790937e+02 1.05046488e+01]
 [2.16032438e-12 7.42326386e+00]
 [3.31899659e-06 5.62699458e+00]
 [6.86162843e-13 5.65227762e+00]
 [1.21351061e-05 4.64486949e+00]]
Train Epoch6 Acc 0.95045 (114054/120000), AUC 0.9933289289474487
Test Epoch6 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch6 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch6 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch6 layer3 Acc 0.9130263157894737, AUC 0.981311559677124
Test Epoch6 layer4 Acc 0.911578947368421, AUC 0.9803181886672974
gc 0
[[3.19790935e+02 1.04981087e+01]
 [2.16032385e-12 7.42177455e+00]
 [3.31902907e-06 5.62539901e+00]
 [6.86165162e-13 5.65058725e+00]
 [5.85689192e-05 4.61315437e+00]]
Train Epoch7 Acc 0.9505583333333333 (114067/120000), AUC 0.9933484792709351
Test Epoch7 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch7 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch7 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch7 layer3 Acc 0.9130263157894737, AUC 0.981311559677124
Test Epoch7 layer4 Acc 0.9119736842105263, AUC 0.9803696274757385
gc 0
[[3.19790934e+02 1.04989811e+01]
 [2.16032686e-12 7.42152233e+00]
 [3.31896680e-06 5.62494960e+00]
 [6.86165956e-13 5.65008693e+00]
 [1.86124214e-04 4.58958295e+00]]
Train Epoch8 Acc 0.9504916666666666 (114059/120000), AUC 0.993370771408081
Test Epoch8 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch8 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch8 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch8 layer3 Acc 0.9130263157894737, AUC 0.981311559677124
Test Epoch8 layer4 Acc 0.9121052631578948, AUC 0.9807696342468262
gc 0
[[3.19790935e+02 1.05002619e+01]
 [2.16031484e-12 7.42107413e+00]
 [3.31901086e-06 5.62417333e+00]
 [6.86162971e-13 5.64945661e+00]
 [2.09803915e-04 4.54901347e+00]]
Train Epoch9 Acc 0.950575 (114069/120000), AUC 0.9934232234954834
Test Epoch9 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch9 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch9 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch9 layer3 Acc 0.9130263157894737, AUC 0.981311559677124
Test Epoch9 layer4 Acc 0.9128947368421053, AUC 0.981195867061615
Save ckpt to ./ckpt/mask5//ag_news/ag_news_transformeral_l5_m5.pt  ,ep 9
Best AUC 0.981195867061615
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//ag_news/ag_news_transformeral_l5_m5.pt
[[1716   52   87   45]
 [  18 1855   10   17]
 [  44   10 1684  162]
 [  57   12  135 1696]]
Figure(640x480)
[[1705   62   79   54]
 [  12 1866   13    9]
 [  44   19 1688  149]
 [  55   17  147 1681]]
Figure(640x480)
[[1700   60   77   63]
 [  18 1852   16   14]
 [  44   15 1687  154]
 [  42   14  142 1702]]
Figure(640x480)
[[1710   58   71   61]
 [  20 1854   12   14]
 [  49   15 1675  161]
 [  48   14  138 1700]]
Figure(640x480)
[[1715   57   69   59]
 [  21 1850   13   16]
 [  55   15 1671  159]
 [  49   14  135 1702]]
Figure(640x480)
