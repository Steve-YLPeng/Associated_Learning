total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask3//ag_news/ag_news_transformeral_l5_m3.pt
Start Training
gc 9
[[3.19790935e+02 1.04966214e+01]
 [2.16031887e-12 7.42207931e+00]
 [3.31896644e-06 5.62489008e+00]
 [2.48895704e+00 1.84989931e+01]
 [1.65630708e+02 5.01708563e+02]]
Train Epoch0 Acc 0.24375833333333333 (29251/120000), AUC 0.4341435432434082
Test Epoch0 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch0 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch0 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch0 layer3 Acc 0.9130263157894737, AUC 0.981311559677124
Save ckpt to ./ckpt/mask4//ag_news/ag_news_transformeral_l5_m4.pt  ,ep 0
Test Epoch0 layer4 Acc 0.24855263157894736, AUC 0.474256694316864
gc 0
[[3.19790934e+02 1.04971555e+01]
 [2.16032234e-12 7.42289143e+00]
 [3.31886415e-06 5.62661826e+00]
 [8.01824964e-13 7.25850393e+00]
 [1.66866820e+02 5.00200971e+02]]
Train Epoch1 Acc 0.222225 (26667/120000), AUC 0.3915402591228485
Test Epoch1 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch1 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch1 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch1 layer3 Acc 0.9138157894736842, AUC 0.9805124998092651
Test Epoch1 layer4 Acc 0.2188157894736842, AUC 0.34912967681884766
gc 0
[[3.19790935e+02 1.04934738e+01]
 [2.16030996e-12 7.42250876e+00]
 [3.31896850e-06 5.62593919e+00]
 [1.22901925e-12 6.68435198e+00]
 [1.66864368e+02 4.88947681e+02]]
Train Epoch2 Acc 0.09023333333333333 (10828/120000), AUC 0.31453847885131836
Test Epoch2 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch2 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch2 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch2 layer3 Acc 0.9127631578947368, AUC 0.9801273941993713
Test Epoch2 layer4 Acc 0.031842105263157894, AUC 0.28985947370529175
gc 0
[[3.19790935e+02 1.04943244e+01]
 [2.16033830e-12 7.42169896e+00]
 [3.31913477e-06 5.62528146e+00]
 [2.30571092e-12 6.27319077e+00]
 [1.66865948e+02 4.74111629e+02]]
Train Epoch3 Acc 0.019325 (2319/120000), AUC 0.24210982024669647
Test Epoch3 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch3 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch3 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch3 layer3 Acc 0.9127631578947368, AUC 0.9802976846694946
Test Epoch3 layer4 Acc 0.05828947368421052, AUC 0.21143153309822083
gc 0
[[3.19790935e+02 1.04942051e+01]
 [2.16033872e-12 7.42241210e+00]
 [3.31888220e-06 5.62518139e+00]
 [1.35525417e-05 5.91227835e+00]
 [1.66864182e+02 4.67099797e+02]]
Train Epoch4 Acc 0.12850833333333334 (15421/120000), AUC 0.2255171537399292
Test Epoch4 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch4 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch4 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch4 layer3 Acc 0.9130263157894737, AUC 0.979633629322052
Test Epoch4 layer4 Acc 0.2398684210526316, AUC 0.22804223001003265
gc 0
[[3.19790935e+02 1.05000948e+01]
 [2.16033476e-12 7.42434312e+00]
 [3.31895963e-06 5.62797285e+00]
 [5.07189096e-11 5.61371305e+00]
 [1.66857663e+02 4.65458222e+02]]
Train Epoch5 Acc 0.2493 (29916/120000), AUC 0.2501709759235382
Test Epoch5 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch5 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch5 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch5 layer3 Acc 0.9122368421052631, AUC 0.9807285666465759
Test Epoch5 layer4 Acc 0.25, AUC 0.26606637239456177
gc 0
[[3.19790935e+02 1.04990853e+01]
 [2.16032323e-12 7.42112033e+00]
 [3.31902855e-06 5.62405424e+00]
 [2.17351026e-05 5.49275860e+00]
 [1.66854370e+02 4.66070554e+02]]
Train Epoch6 Acc 0.25001666666666666 (30002/120000), AUC 0.3044675588607788
Test Epoch6 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch6 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch6 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch6 layer3 Acc 0.9122368421052631, AUC 0.9806444644927979
Test Epoch6 layer4 Acc 0.25, AUC 0.3270529806613922
gc 0
[[3.19790935e+02 1.05013877e+01]
 [2.16031737e-12 7.42140428e+00]
 [3.31892372e-06 5.62467251e+00]
 [1.18968336e-04 5.40483985e+00]
 [1.66760375e+02 4.67298615e+02]]
Train Epoch7 Acc 0.250025 (30003/120000), AUC 0.3840417265892029
Test Epoch7 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch7 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch7 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch7 layer3 Acc 0.9122368421052631, AUC 0.9803877472877502
Test Epoch7 layer4 Acc 0.25, AUC 0.425063818693161
gc 0
[[3.19790934e+02 1.05033450e+01]
 [2.16032653e-12 7.42201982e+00]
 [3.31899521e-06 5.62559196e+00]
 [1.43625345e-04 5.33404369e+00]
 [1.66531190e+02 4.69363295e+02]]
Train Epoch8 Acc 0.25003333333333333 (30004/120000), AUC 0.4461304545402527
Test Epoch8 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch8 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch8 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch8 layer3 Acc 0.9113157894736842, AUC 0.9808651804924011
Test Epoch8 layer4 Acc 0.25, AUC 0.44980388879776
gc 0
[[3.19790935e+02 1.04945535e+01]
 [2.16032417e-12 7.42247338e+00]
 [3.31900066e-06 5.62605312e+00]
 [9.97551692e-07 5.25389587e+00]
 [1.66381707e+02 4.70486391e+02]]
Train Epoch9 Acc 0.25025833333333336 (30031/120000), AUC 0.4743325114250183
Test Epoch9 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch9 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch9 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Test Epoch9 layer3 Acc 0.9117105263157895, AUC 0.9809452891349792
Test Epoch9 layer4 Acc 0.25, AUC 0.4932607412338257
Best AUC 0.981311559677124
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//ag_news/ag_news_transformeral_l5_m4.pt
[[1716   52   87   45]
 [  18 1855   10   17]
 [  44   10 1684  162]
 [  57   12  135 1696]]
Figure(640x480)
[[1705   62   79   54]
 [  12 1866   13    9]
 [  44   19 1688  149]
 [  55   17  147 1681]]
Figure(640x480)
[[1700   60   77   63]
 [  18 1852   16   14]
 [  44   15 1687  154]
 [  42   14  142 1702]]
Figure(640x480)
[[1710   58   71   61]
 [  20 1854   12   14]
 [  49   15 1675  161]
 [  48   14  138 1700]]
Figure(640x480)
[[   0 1900    0    0]
 [  11 1889    0    0]
 [   0 1900    0    0]
 [   0 1889   11    0]]
Figure(640x480)
