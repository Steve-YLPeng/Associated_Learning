total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ./ckpt/mask2//ag_news/ag_news_transformeral_l5_m2.pt
Start Training
gc 9
[[3.19790936e+02 1.04956403e+01]
 [2.16033162e-12 7.42323433e+00]
 [2.08002654e+00 1.84618834e+01]
 [1.85886788e+02 4.98390096e+02]
 [1.55458759e+02 4.83312221e+02]]
Train Epoch0 Acc 0.222575 (26709/120000), AUC 0.39714252948760986
Test Epoch0 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch0 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch0 layer2 Acc 0.9122368421052631, AUC 0.9806280136108398
Save ckpt to ./ckpt/mask3//ag_news/ag_news_transformeral_l5_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.3611842105263158, AUC 0.5014514923095703
Test Epoch0 layer4 Acc 0.24421052631578946, AUC 0.36343249678611755
gc 0
[[3.19790932e+02 1.04945064e+01]
 [2.16030918e-12 7.42086220e+00]
 [9.50723803e-13 8.24987347e+00]
 [1.86884466e+02 5.09066332e+02]
 [1.55923093e+02 4.85320614e+02]]
Train Epoch1 Acc 0.24560833333333335 (29473/120000), AUC 0.3245537579059601
Test Epoch1 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch1 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch1 layer2 Acc 0.9138157894736842, AUC 0.9800822138786316
Test Epoch1 layer3 Acc 0.2506578947368421, AUC 0.4833926856517792
Test Epoch1 layer4 Acc 0.2456578947368421, AUC 0.3240186870098114
gc 0
[[3.19790935e+02 1.04964628e+01]
 [2.16032148e-12 7.42256198e+00]
 [1.46863869e-12 7.34554672e+00]
 [1.86883925e+02 5.22117080e+02]
 [1.55924322e+02 4.84942930e+02]]
Train Epoch2 Acc 0.24516666666666667 (29420/120000), AUC 0.3228488862514496
Test Epoch2 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch2 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch2 layer2 Acc 0.9123684210526316, AUC 0.9806951284408569
Save ckpt to ./ckpt/mask3//ag_news/ag_news_transformeral_l5_m3.pt  ,ep 2
Test Epoch2 layer3 Acc 0.25, AUC 0.5480328798294067
Test Epoch2 layer4 Acc 0.24513157894736842, AUC 0.35035738348960876
gc 0
[[3.19790936e+02 1.05014701e+01]
 [2.16032067e-12 7.42137135e+00]
 [2.91676522e-12 6.86124665e+00]
 [1.86885924e+02 5.28317887e+02]
 [1.55924485e+02 4.83835885e+02]]
Train Epoch3 Acc 0.24509166666666668 (29411/120000), AUC 0.3423604965209961
Test Epoch3 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch3 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch3 layer2 Acc 0.9134210526315789, AUC 0.9801416397094727
Test Epoch3 layer3 Acc 0.25, AUC 0.5668334364891052
Test Epoch3 layer4 Acc 0.24421052631578946, AUC 0.36655300855636597
gc 0
[[3.19790934e+02 1.05039172e+01]
 [2.16033570e-12 7.42045797e+00]
 [3.74855071e-05 6.57886360e+00]
 [1.86872922e+02 5.29944810e+02]
 [1.55916126e+02 4.81810895e+02]]
Train Epoch4 Acc 0.24501666666666666 (29402/120000), AUC 0.3471532464027405
Test Epoch4 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch4 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch4 layer2 Acc 0.9131578947368421, AUC 0.9807161092758179
Save ckpt to ./ckpt/mask3//ag_news/ag_news_transformeral_l5_m3.pt  ,ep 4
Test Epoch4 layer3 Acc 0.25, AUC 0.5805749893188477
Test Epoch4 layer4 Acc 0.24447368421052632, AUC 0.3657567799091339
gc 0
[[3.19790934e+02 1.04997145e+01]
 [2.16032793e-12 7.42284230e+00]
 [6.93047175e-07 6.30388725e+00]
 [1.86841949e+02 5.30037654e+02]
 [1.55886879e+02 4.80036685e+02]]
Train Epoch5 Acc 0.244975 (29397/120000), AUC 0.34622102975845337
Test Epoch5 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch5 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch5 layer2 Acc 0.9118421052631579, AUC 0.9806720018386841
Test Epoch5 layer3 Acc 0.25, AUC 0.5771088004112244
Test Epoch5 layer4 Acc 0.24513157894736842, AUC 0.3639262020587921
gc 0
[[3.19790935e+02 1.04966407e+01]
 [2.16031362e-12 7.42145962e+00]
 [5.91282555e-05 6.19500296e+00]
 [1.86826062e+02 5.30672400e+02]
 [1.55879517e+02 4.78247218e+02]]
Train Epoch6 Acc 0.2453 (29436/120000), AUC 0.34545713663101196
Test Epoch6 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch6 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch6 layer2 Acc 0.9132894736842105, AUC 0.9807339906692505
Save ckpt to ./ckpt/mask3//ag_news/ag_news_transformeral_l5_m3.pt  ,ep 6
Test Epoch6 layer3 Acc 0.25, AUC 0.5717474222183228
Test Epoch6 layer4 Acc 0.24368421052631578, AUC 0.3631715178489685
gc 0
[[3.19790933e+02 1.04999102e+01]
 [2.16032852e-12 7.42269236e+00]
 [1.27422247e-04 6.09241364e+00]
 [1.86687022e+02 5.30462192e+02]
 [1.55798237e+02 4.77406737e+02]]
Train Epoch7 Acc 0.24504166666666666 (29405/120000), AUC 0.34621700644493103
Test Epoch7 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch7 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch7 layer2 Acc 0.9121052631578948, AUC 0.9797272682189941
Test Epoch7 layer3 Acc 0.25, AUC 0.5587415099143982
Test Epoch7 layer4 Acc 0.24394736842105263, AUC 0.3629447817802429
gc 0
[[3.19790935e+02 1.04969693e+01]
 [2.16033920e-12 7.42206319e+00]
 [2.49659507e-04 6.00115316e+00]
 [1.86336977e+02 5.29512233e+02]
 [1.55573976e+02 4.76937198e+02]]
Train Epoch8 Acc 0.24518333333333334 (29422/120000), AUC 0.34707486629486084
Test Epoch8 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch8 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch8 layer2 Acc 0.9111842105263158, AUC 0.9796457886695862
Test Epoch8 layer3 Acc 0.25, AUC 0.5671025514602661
Test Epoch8 layer4 Acc 0.24460526315789474, AUC 0.3652532994747162
gc 0
[[3.19790933e+02 1.04954040e+01]
 [2.16032308e-12 7.42455432e+00]
 [2.32370293e-04 5.91623199e+00]
 [1.85824326e+02 5.29177329e+02]
 [1.55253530e+02 4.77267437e+02]]
Train Epoch9 Acc 0.24523333333333333 (29428/120000), AUC 0.3482266366481781
Test Epoch9 layer0 Acc 0.9146052631578947, AUC 0.9815687537193298
Test Epoch9 layer1 Acc 0.9131578947368421, AUC 0.9808547496795654
Test Epoch9 layer2 Acc 0.9113157894736842, AUC 0.9804549813270569
Test Epoch9 layer3 Acc 0.25, AUC 0.5445361137390137
Test Epoch9 layer4 Acc 0.24486842105263157, AUC 0.3702951967716217
Best AUC 0.9807339906692505
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//ag_news/ag_news_transformeral_l5_m3.pt
[[1716   52   87   45]
 [  18 1855   10   17]
 [  44   10 1684  162]
 [  57   12  135 1696]]
Figure(640x480)
[[1705   62   79   54]
 [  12 1866   13    9]
 [  44   19 1688  149]
 [  55   17  147 1681]]
Figure(640x480)
[[1700   60   77   63]
 [  18 1852   16   14]
 [  44   15 1687  154]
 [  42   14  142 1702]]
Figure(640x480)
[[   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]
 [   0 1900    0    0]]
Figure(640x480)
[[1834   66    0    0]
 [1882   18    0    0]
 [1712  188    0    0]
 [ 168 1732    0    0]]
Figure(640x480)
