total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 48937892
init_time 44.043975943999996
Start Training
gc 0
Train Epoch0 Acc 0.25454166666666667 (30545/120000), AUC 0.501495361328125
ep0_train_time 17.462699519999994
Test Epoch0 layer0 Acc 0.6957894736842105, AUC 0.8998589515686035, avg_entr 0.882667064666748, f1 0.6957894563674927
ep0_l0_test_time 0.11720845700000382
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6444736842105263, AUC 0.8611131906509399, avg_entr 0.9427945613861084, f1 0.644473671913147
ep0_l1_test_time 0.11924252400000057
Test Epoch0 layer2 Acc 0.44263157894736843, AUC 0.8039852380752563, avg_entr 1.0270767211914062, f1 0.4426315724849701
ep0_l2_test_time 0.13128958100000432
Test Epoch0 layer3 Acc 0.2615789473684211, AUC 0.6518893241882324, avg_entr 1.240898847579956, f1 0.2615789473056793
ep0_l3_test_time 0.15148441499999876
Test Epoch0 layer4 Acc 0.2581578947368421, AUC 0.4517097771167755, avg_entr 1.2420082092285156, f1 0.2581579089164734
ep0_l4_test_time 0.1672290380000021
gc 0
Train Epoch1 Acc 0.616425 (73971/120000), AUC 0.8560603260993958
ep1_train_time 16.58531731299999
Test Epoch1 layer0 Acc 0.8121052631578948, AUC 0.9525578618049622, avg_entr 0.3810625970363617, f1 0.8121052384376526
ep1_l0_test_time 0.1135910960000075
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8247368421052632, AUC 0.9549791812896729, avg_entr 0.3245757818222046, f1 0.8247368335723877
ep1_l1_test_time 0.12098949299999617
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8186842105263158, AUC 0.9517237544059753, avg_entr 0.2893339693546295, f1 0.8186842203140259
ep1_l2_test_time 0.13293607500000348
Test Epoch1 layer3 Acc 0.8202631578947368, AUC 0.9492480158805847, avg_entr 0.2782454192638397, f1 0.820263147354126
ep1_l3_test_time 0.14894325800000274
Test Epoch1 layer4 Acc 0.8197368421052632, AUC 0.9450289011001587, avg_entr 0.266853392124176, f1 0.8197368383407593
ep1_l4_test_time 0.17181642600000657
gc 0
Train Epoch2 Acc 0.8608583333333333 (103303/120000), AUC 0.9569859504699707
ep2_train_time 16.399101024999993
Test Epoch2 layer0 Acc 0.84, AUC 0.9614756107330322, avg_entr 0.22935615479946136, f1 0.8399999737739563
ep2_l0_test_time 0.11273267599999315
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8489473684210527, AUC 0.9652419686317444, avg_entr 0.19109846651554108, f1 0.8489473462104797
ep2_l1_test_time 0.12592877800000224
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8544736842105263, AUC 0.9637532234191895, avg_entr 0.17572516202926636, f1 0.8544737100601196
ep2_l2_test_time 0.13260973699999568
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8515789473684211, AUC 0.9632887840270996, avg_entr 0.17690928280353546, f1 0.851578950881958
ep2_l3_test_time 0.15221275399999
Test Epoch2 layer4 Acc 0.8521052631578947, AUC 0.962864100933075, avg_entr 0.17351144552230835, f1 0.8521052598953247
ep2_l4_test_time 0.17242041000000086
gc 0
Train Epoch3 Acc 0.8912833333333333 (106954/120000), AUC 0.9699342846870422
ep3_train_time 16.332670408
Test Epoch3 layer0 Acc 0.8463157894736842, AUC 0.9635233283042908, avg_entr 0.16030174493789673, f1 0.8463158011436462
ep3_l0_test_time 0.11557173799999987
Test Epoch3 layer1 Acc 0.8605263157894737, AUC 0.9693496227264404, avg_entr 0.13261394202709198, f1 0.8605263233184814
ep3_l1_test_time 0.1217562799999996
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8647368421052631, AUC 0.968189001083374, avg_entr 0.12814851105213165, f1 0.8647368550300598
ep3_l2_test_time 0.13807112300000313
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer3 Acc 0.8639473684210527, AUC 0.9687893390655518, avg_entr 0.13026951253414154, f1 0.8639474511146545
ep3_l3_test_time 0.1494268570000088
Test Epoch3 layer4 Acc 0.8647368421052631, AUC 0.9664345383644104, avg_entr 0.13108642399311066, f1 0.8647368550300598
ep3_l4_test_time 0.1716372960000001
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.909825 (109179/120000), AUC 0.9766664505004883
ep4_train_time 16.357163179999986
Test Epoch4 layer0 Acc 0.8528947368421053, AUC 0.964290201663971, avg_entr 0.11587943136692047, f1 0.8528947234153748
ep4_l0_test_time 0.11291478399999733
Test Epoch4 layer1 Acc 0.8652631578947368, AUC 0.9700782895088196, avg_entr 0.09708885103464127, f1 0.8652631640434265
ep4_l1_test_time 0.09132621900002391
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8678947368421053, AUC 0.9685571193695068, avg_entr 0.09312201291322708, f1 0.86789470911026
ep4_l2_test_time 0.1333849549999968
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer3 Acc 0.8623684210526316, AUC 0.9665447473526001, avg_entr 0.09566132724285126, f1 0.8623684048652649
ep4_l3_test_time 0.15054432699997733
Test Epoch4 layer4 Acc 0.8626315789473684, AUC 0.9645698070526123, avg_entr 0.09527355432510376, f1 0.862631618976593
ep4_l4_test_time 0.16952127300001507
gc 0
Train Epoch5 Acc 0.9248083333333333 (110977/120000), AUC 0.9815956950187683
ep5_train_time 16.708164832000023
Test Epoch5 layer0 Acc 0.8544736842105263, AUC 0.9666672945022583, avg_entr 0.09613337367773056, f1 0.8544737100601196
ep5_l0_test_time 0.11266998199999989
Test Epoch5 layer1 Acc 0.875, AUC 0.9720589518547058, avg_entr 0.07660049945116043, f1 0.875
ep5_l1_test_time 0.12109997399997496
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.873421052631579, AUC 0.9714846014976501, avg_entr 0.07098174840211868, f1 0.8734210729598999
ep5_l2_test_time 0.13394210299998122
Test Epoch5 layer3 Acc 0.8739473684210526, AUC 0.9708676338195801, avg_entr 0.07191457599401474, f1 0.8739473819732666
ep5_l3_test_time 0.1483929400000079
Test Epoch5 layer4 Acc 0.8736842105263158, AUC 0.9692274332046509, avg_entr 0.06941373646259308, f1 0.8736842274665833
ep5_l4_test_time 0.16965326199999708
gc 0
Train Epoch6 Acc 0.9349833333333334 (112198/120000), AUC 0.983757495880127
ep6_train_time 16.693025769000002
Test Epoch6 layer0 Acc 0.8578947368421053, AUC 0.9655978679656982, avg_entr 0.08042079955339432, f1 0.8578947186470032
ep6_l0_test_time 0.12170193800000106
Test Epoch6 layer1 Acc 0.8736842105263158, AUC 0.9729130268096924, avg_entr 0.06613049656152725, f1 0.8736842274665833
ep6_l1_test_time 0.12696613299999626
Test Epoch6 layer2 Acc 0.8757894736842106, AUC 0.9713140726089478, avg_entr 0.06503070145845413, f1 0.87578946352005
ep6_l2_test_time 0.13929822100001843
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer3 Acc 0.8752631578947369, AUC 0.9706716537475586, avg_entr 0.06559288501739502, f1 0.8752631545066833
ep6_l3_test_time 0.15204622999999629
Test Epoch6 layer4 Acc 0.8755263157894737, AUC 0.9702403545379639, avg_entr 0.06229909509420395, f1 0.8755263090133667
ep6_l4_test_time 0.16846863300000336
gc 0
Train Epoch7 Acc 0.9433166666666667 (113198/120000), AUC 0.9861130714416504
ep7_train_time 16.601594164999995
Test Epoch7 layer0 Acc 0.8586842105263158, AUC 0.964689314365387, avg_entr 0.06783644109964371, f1 0.8586841821670532
ep7_l0_test_time 0.11604228600000965
Test Epoch7 layer1 Acc 0.8771052631578947, AUC 0.9721280336380005, avg_entr 0.05461188778281212, f1 0.8771052360534668
ep7_l1_test_time 0.12240670399998521
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer2 Acc 0.8810526315789474, AUC 0.9708309769630432, avg_entr 0.04980505630373955, f1 0.8810526132583618
ep7_l2_test_time 0.12716695899999308
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 7
Test Epoch7 layer3 Acc 0.8789473684210526, AUC 0.9694730639457703, avg_entr 0.04931000992655754, f1 0.878947377204895
ep7_l3_test_time 0.15105264900000748
Test Epoch7 layer4 Acc 0.8794736842105263, AUC 0.9677150249481201, avg_entr 0.047209568321704865, f1 0.8794736862182617
ep7_l4_test_time 0.16939327800000115
gc 0
Train Epoch8 Acc 0.9523333333333334 (114280/120000), AUC 0.9879286885261536
ep8_train_time 16.836997760000003
Test Epoch8 layer0 Acc 0.8497368421052631, AUC 0.9611328840255737, avg_entr 0.05893328785896301, f1 0.8497368693351746
ep8_l0_test_time 0.1138075229999913
Test Epoch8 layer1 Acc 0.8671052631578947, AUC 0.968816876411438, avg_entr 0.042637575417757034, f1 0.86710524559021
ep8_l1_test_time 0.12142866600001412
Test Epoch8 layer2 Acc 0.8697368421052631, AUC 0.9649758338928223, avg_entr 0.04064598307013512, f1 0.8697368502616882
ep8_l2_test_time 0.13262413399999673
Test Epoch8 layer3 Acc 0.8694736842105263, AUC 0.9653801918029785, avg_entr 0.04081946983933449, f1 0.8694736957550049
ep8_l3_test_time 0.15048644800000943
Test Epoch8 layer4 Acc 0.868421052631579, AUC 0.9638403654098511, avg_entr 0.03858058154582977, f1 0.8684210777282715
ep8_l4_test_time 0.17067442600000504
gc 0
Train Epoch9 Acc 0.9569166666666666 (114830/120000), AUC 0.9891929030418396
ep9_train_time 16.661517093000015
Test Epoch9 layer0 Acc 0.8557894736842105, AUC 0.9614026546478271, avg_entr 0.048899631947278976, f1 0.8557894825935364
ep9_l0_test_time 0.11940205400000536
Test Epoch9 layer1 Acc 0.875, AUC 0.9706950783729553, avg_entr 0.044816967099905014, f1 0.875
ep9_l1_test_time 0.12204188100000124
Test Epoch9 layer2 Acc 0.8731578947368421, AUC 0.9691085815429688, avg_entr 0.04440286010503769, f1 0.8731579184532166
ep9_l2_test_time 0.1330950669999993
Test Epoch9 layer3 Acc 0.8713157894736843, AUC 0.9690170288085938, avg_entr 0.046862099319696426, f1 0.8713157176971436
ep9_l3_test_time 0.14933292199998505
Test Epoch9 layer4 Acc 0.8728947368421053, AUC 0.9671124219894409, avg_entr 0.046585146337747574, f1 0.8728947639465332
ep9_l4_test_time 0.16844817500000886
gc 0
Train Epoch10 Acc 0.9663583333333333 (115963/120000), AUC 0.9916876554489136
ep10_train_time 16.763901642999997
Test Epoch10 layer0 Acc 0.8565789473684211, AUC 0.9590030908584595, avg_entr 0.04345954954624176, f1 0.8565789461135864
ep10_l0_test_time 0.11586198699998818
Test Epoch10 layer1 Acc 0.866578947368421, AUC 0.9685937166213989, avg_entr 0.030931029468774796, f1 0.8665789365768433
ep10_l1_test_time 0.12006636700002105
Test Epoch10 layer2 Acc 0.8686842105263158, AUC 0.9677437543869019, avg_entr 0.03277713805437088, f1 0.8686841726303101
ep10_l2_test_time 0.13509876800000598
Test Epoch10 layer3 Acc 0.8697368421052631, AUC 0.9673485159873962, avg_entr 0.032959625124931335, f1 0.8697368502616882
ep10_l3_test_time 0.14956953799998018
Test Epoch10 layer4 Acc 0.87, AUC 0.9652611613273621, avg_entr 0.03404639661312103, f1 0.8700000047683716
ep10_l4_test_time 0.16958131800001297
gc 0
Train Epoch11 Acc 0.9715666666666667 (116588/120000), AUC 0.9931895732879639
ep11_train_time 16.508155278000004
Test Epoch11 layer0 Acc 0.8542105263157894, AUC 0.9566382169723511, avg_entr 0.04034842550754547, f1 0.8542105555534363
ep11_l0_test_time 0.1128483210000013
Test Epoch11 layer1 Acc 0.8731578947368421, AUC 0.9654972553253174, avg_entr 0.028697345405817032, f1 0.8731579184532166
ep11_l1_test_time 0.1274706829999559
Test Epoch11 layer2 Acc 0.8707894736842106, AUC 0.9626666903495789, avg_entr 0.027141226455569267, f1 0.8707894682884216
ep11_l2_test_time 0.13213627199996836
Test Epoch11 layer3 Acc 0.8702631578947368, AUC 0.9641605019569397, avg_entr 0.027705801650881767, f1 0.8702631592750549
ep11_l3_test_time 0.1474743999999646
Test Epoch11 layer4 Acc 0.8702631578947368, AUC 0.9630967974662781, avg_entr 0.02647433616220951, f1 0.8702631592750549
ep11_l4_test_time 0.16929142399999364
gc 0
Train Epoch12 Acc 0.9741333333333333 (116896/120000), AUC 0.993948221206665
ep12_train_time 16.442630742000006
Test Epoch12 layer0 Acc 0.8526315789473684, AUC 0.9546488523483276, avg_entr 0.03839096054434776, f1 0.8526315689086914
ep12_l0_test_time 0.11560065999998415
Test Epoch12 layer1 Acc 0.865, AUC 0.9647154808044434, avg_entr 0.029520636424422264, f1 0.8650000095367432
ep12_l1_test_time 0.12005508400000053
Test Epoch12 layer2 Acc 0.866578947368421, AUC 0.962644636631012, avg_entr 0.026582829654216766, f1 0.8665789365768433
ep12_l2_test_time 0.13638486700000385
Test Epoch12 layer3 Acc 0.8660526315789474, AUC 0.9615261554718018, avg_entr 0.025490228086709976, f1 0.8660526275634766
ep12_l3_test_time 0.14991497800002662
Test Epoch12 layer4 Acc 0.8660526315789474, AUC 0.9594919681549072, avg_entr 0.023625565692782402, f1 0.8660526275634766
ep12_l4_test_time 0.1696549119999986
gc 0
Train Epoch13 Acc 0.9759916666666667 (117119/120000), AUC 0.9940179586410522
ep13_train_time 16.466854337999962
Test Epoch13 layer0 Acc 0.8565789473684211, AUC 0.9550747871398926, avg_entr 0.033446889370679855, f1 0.8565789461135864
ep13_l0_test_time 0.11606709800003046
Test Epoch13 layer1 Acc 0.8721052631578947, AUC 0.962030827999115, avg_entr 0.022114520892500877, f1 0.8721052408218384
ep13_l1_test_time 0.11928439799999069
Test Epoch13 layer2 Acc 0.8731578947368421, AUC 0.9606227874755859, avg_entr 0.021519212052226067, f1 0.8731579184532166
ep13_l2_test_time 0.13395450600000913
Test Epoch13 layer3 Acc 0.8718421052631579, AUC 0.9606805443763733, avg_entr 0.02178773656487465, f1 0.8718421459197998
ep13_l3_test_time 0.14848233700001856
Test Epoch13 layer4 Acc 0.8726315789473684, AUC 0.9586042761802673, avg_entr 0.021402588114142418, f1 0.8726315498352051
ep13_l4_test_time 0.1726415539999948
gc 0
Train Epoch14 Acc 0.9791666666666666 (117500/120000), AUC 0.9945772886276245
ep14_train_time 16.51591629799998
Test Epoch14 layer0 Acc 0.8571052631578947, AUC 0.9535255432128906, avg_entr 0.030722061172127724, f1 0.8571051955223083
ep14_l0_test_time 0.1149093899999798
Test Epoch14 layer1 Acc 0.8686842105263158, AUC 0.9611074328422546, avg_entr 0.022596778348088264, f1 0.8686841726303101
ep14_l1_test_time 0.12196670600002335
Test Epoch14 layer2 Acc 0.8686842105263158, AUC 0.9593656063079834, avg_entr 0.019253045320510864, f1 0.8686841726303101
ep14_l2_test_time 0.13144864399998824
Test Epoch14 layer3 Acc 0.8694736842105263, AUC 0.9606602191925049, avg_entr 0.019521355628967285, f1 0.8694736957550049
ep14_l3_test_time 0.15195437800002765
Test Epoch14 layer4 Acc 0.8692105263157894, AUC 0.9571235179901123, avg_entr 0.01705990917980671, f1 0.8692105412483215
ep14_l4_test_time 0.17046466400000782
gc 0
Train Epoch15 Acc 0.9815916666666666 (117791/120000), AUC 0.9953629970550537
ep15_train_time 16.753862579999975
Test Epoch15 layer0 Acc 0.8515789473684211, AUC 0.9501314163208008, avg_entr 0.02887396328151226, f1 0.851578950881958
ep15_l0_test_time 0.1151260880000109
Test Epoch15 layer1 Acc 0.8642105263157894, AUC 0.9584845304489136, avg_entr 0.02133864164352417, f1 0.8642105460166931
ep15_l1_test_time 0.12013429500001394
Test Epoch15 layer2 Acc 0.8647368421052631, AUC 0.9559944272041321, avg_entr 0.01949513889849186, f1 0.8647368550300598
ep15_l2_test_time 0.13208041000001458
Test Epoch15 layer3 Acc 0.8660526315789474, AUC 0.9565241932868958, avg_entr 0.018656402826309204, f1 0.8660526275634766
ep15_l3_test_time 0.15032221500001697
Test Epoch15 layer4 Acc 0.866578947368421, AUC 0.9565509557723999, avg_entr 0.017651190981268883, f1 0.8665789365768433
ep15_l4_test_time 0.16812977800003637
gc 0
Train Epoch16 Acc 0.9829166666666667 (117950/120000), AUC 0.9953330755233765
ep16_train_time 16.463551720999988
Test Epoch16 layer0 Acc 0.8518421052631578, AUC 0.9496439695358276, avg_entr 0.029610395431518555, f1 0.8518421053886414
ep16_l0_test_time 0.12156076999997367
Test Epoch16 layer1 Acc 0.866578947368421, AUC 0.9574065208435059, avg_entr 0.018249686807394028, f1 0.8665789365768433
ep16_l1_test_time 0.1280549129999713
Test Epoch16 layer2 Acc 0.8652631578947368, AUC 0.9570100903511047, avg_entr 0.015303038991987705, f1 0.8652631640434265
ep16_l2_test_time 0.1390029920000302
Test Epoch16 layer3 Acc 0.8660526315789474, AUC 0.9585855603218079, avg_entr 0.014103051275014877, f1 0.8660526275634766
ep16_l3_test_time 0.15552328300003637
Test Epoch16 layer4 Acc 0.8657894736842106, AUC 0.9578754305839539, avg_entr 0.01368369534611702, f1 0.8657894730567932
ep16_l4_test_time 0.1767024929999934
gc 0
Train Epoch17 Acc 0.98365 (118038/120000), AUC 0.9954375624656677
ep17_train_time 16.914115487999993
Test Epoch17 layer0 Acc 0.8502631578947368, AUC 0.9470252394676208, avg_entr 0.026548590511083603, f1 0.8502631783485413
ep17_l0_test_time 0.11358096300000398
Test Epoch17 layer1 Acc 0.8652631578947368, AUC 0.951496422290802, avg_entr 0.016186291351914406, f1 0.8652631640434265
ep17_l1_test_time 0.11955331799998703
Test Epoch17 layer2 Acc 0.865, AUC 0.9524344205856323, avg_entr 0.01305747963488102, f1 0.8650000095367432
ep17_l2_test_time 0.13487886100000424
Test Epoch17 layer3 Acc 0.8652631578947368, AUC 0.9548348188400269, avg_entr 0.01264325249940157, f1 0.8652631640434265
ep17_l3_test_time 0.14758669700000837
Test Epoch17 layer4 Acc 0.8652631578947368, AUC 0.9527639150619507, avg_entr 0.012518301606178284, f1 0.8652631640434265
ep17_l4_test_time 0.17126345299999457
gc 0
Train Epoch18 Acc 0.9847083333333333 (118165/120000), AUC 0.9957894086837769
ep18_train_time 16.63984810300002
Test Epoch18 layer0 Acc 0.8510526315789474, AUC 0.9472599625587463, avg_entr 0.027745304629206657, f1 0.8510526418685913
ep18_l0_test_time 0.11645068499996114
Test Epoch18 layer1 Acc 0.8652631578947368, AUC 0.956696093082428, avg_entr 0.02209831029176712, f1 0.8652631640434265
ep18_l1_test_time 0.1197212659999991
Test Epoch18 layer2 Acc 0.8626315789473684, AUC 0.9567647576332092, avg_entr 0.018508033826947212, f1 0.862631618976593
ep18_l2_test_time 0.13249557200003892
Test Epoch18 layer3 Acc 0.8631578947368421, AUC 0.958146870136261, avg_entr 0.018255552276968956, f1 0.8631578683853149
ep18_l3_test_time 0.14451412599999003
Test Epoch18 layer4 Acc 0.863421052631579, AUC 0.957805871963501, avg_entr 0.01817074790596962, f1 0.8634210228919983
ep18_l4_test_time 0.172267182999974
gc 0
Train Epoch19 Acc 0.9857083333333333 (118285/120000), AUC 0.9961150884628296
ep19_train_time 16.44040656499999
Test Epoch19 layer0 Acc 0.8521052631578947, AUC 0.9459560513496399, avg_entr 0.024646544829010963, f1 0.8521052598953247
ep19_l0_test_time 0.11499715299999025
Test Epoch19 layer1 Acc 0.8655263157894737, AUC 0.9518665671348572, avg_entr 0.015908638015389442, f1 0.8655263185501099
ep19_l1_test_time 0.1227689659999669
Test Epoch19 layer2 Acc 0.8626315789473684, AUC 0.9521276950836182, avg_entr 0.013000058010220528, f1 0.862631618976593
ep19_l2_test_time 0.1425046150000071
Test Epoch19 layer3 Acc 0.8631578947368421, AUC 0.9539475440979004, avg_entr 0.012370685115456581, f1 0.8631578683853149
ep19_l3_test_time 0.14726213000000143
Test Epoch19 layer4 Acc 0.8636842105263158, AUC 0.952968955039978, avg_entr 0.011684056371450424, f1 0.8636842370033264
ep19_l4_test_time 0.1691934180000203
Best AUC tensor(0.8811) 7 2
train_as_loss [[4.60191348e+02 3.56842892e+02 3.51137078e+02 3.49870840e+02
  3.49389089e+02 3.49156336e+02 3.49027508e+02 3.48949715e+02
  3.48899841e+02 3.48866466e+02 3.48848001e+02 3.48837469e+02
  3.48827928e+02 3.48819515e+02 3.48813855e+02 3.48810158e+02
  3.48806478e+02 3.48802917e+02 3.48800339e+02 3.48798557e+02]
 [1.84124418e+00 1.56785602e-05 1.21108615e-06 2.57473086e-07
  8.07680387e-08 3.11857619e-08 1.41768830e-06 6.04432913e-06
  3.18780168e-05 1.78698602e-04 1.12196252e-04 4.37478074e-06
  8.64760826e-10 1.30710935e-06 1.00066322e-04 8.73419628e-07
  3.79023100e-10 7.67083495e-10 2.36923936e-05 3.69221967e-08]
 [2.15704590e+00 1.93177577e-05 1.44790417e-06 3.11467713e-07
  1.01381872e-07 4.12834249e-08 5.05468144e-07 7.89341225e-06
  5.81106168e-05 4.50177615e-04 6.64642286e-05 1.12420301e-05
  1.99494075e-09 1.69507186e-06 5.38403079e-05 4.00162263e-06
  1.22839232e-09 5.12309423e-06 1.41546166e-05 1.82102055e-07]
 [2.22300542e+00 1.96723545e-05 1.51976363e-06 3.64412665e-07
  1.41931046e-07 6.94391217e-08 6.06083225e-07 1.02615900e-05
  9.32822976e-05 7.95076223e-04 1.04547343e-04 1.89185459e-05
  7.77694961e-09 1.64807469e-06 4.77054038e-05 9.07740408e-06
  7.00674436e-09 8.44603323e-06 1.72479836e-05 8.41952294e-07]
 [2.15384883e+00 1.53911926e-05 1.40498281e-06 4.63421568e-07
  2.55555954e-07 1.58561559e-07 7.97736165e-07 1.48086349e-05
  1.64776918e-04 1.24828655e-03 5.73586399e-04 2.80520289e-05
  2.95975067e-08 1.45729744e-06 1.00242144e-04 1.34723278e-05
  2.78516967e-08 8.94008135e-06 7.63925873e-05 1.18525321e-06]]
train_ae_loss [[11.2485589  11.81427274 10.73413416  9.95051443  9.26062697  8.60061273
   8.05553741  7.55028141  6.93497908  6.60675165  5.2611457   4.85844824
   4.6212765   4.442442    3.91245983  3.71186639  3.61475495  3.55878613
   3.3501746   3.26844898]
 [11.69655219 10.52316438  9.0478504   8.18843768  7.44325331  6.79811735
   6.29896318  5.79258568  5.20583521  4.94885248  3.8629802   3.38883478
   3.15200029  2.982107    2.57207482  2.29484021  2.18712797  2.11373452
   1.96516587  1.82772479]
 [11.71768443 10.358258    8.26599466  7.36706873  6.65844855  6.00071021
   5.54468608  5.04398964  4.50179373  4.27496182  3.27122085  2.8630014
   2.64936829  2.50084582  2.1252045   1.89977294  1.80160865  1.74458195
   1.60392355  1.48576628]
 [10.5446251  10.64936404  7.4434725   6.50423361  5.78629865  5.15666843
   4.71956783  4.2720871   3.79107979  3.59251171  2.71049706  2.35550558
   2.17543069  2.04628245  1.72793015  1.53402628  1.45087267  1.40068189
   1.28460938  1.1846342 ]
 [10.28085175 12.61743226  7.24147622  6.2352156   5.50198615  4.87543241
   4.44365175  4.00405692  3.54143838  3.3537118   2.52414017  2.17187761
   1.99822084  1.87905029  1.58554588  1.39757018  1.31839087  1.27154341
   1.16812088  1.06832298]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 353.38538187399996
Start Testing
Load ckpt at ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt
gc 10
Test layer0 Acc 0.8510526315789474, AUC 0.9587172269821167, avg_entr 0.06869962066411972, f1 0.8510526418685913
l0_test_time 0.11696068200001264
gc 0
Test layer1 Acc 0.8678947368421053, AUC 0.9686538577079773, avg_entr 0.05231921374797821, f1 0.86789470911026
l1_test_time 0.11672716799995442
gc 0
Test layer2 Acc 0.87, AUC 0.9679489135742188, avg_entr 0.04883243143558502, f1 0.8700000047683716
l2_test_time 0.12789001300001246
gc 0
Test layer3 Acc 0.8723684210526316, AUC 0.9671360850334167, avg_entr 0.04914560541510582, f1 0.8723683953285217
l3_test_time 0.14763309399995705
gc 0
Test layer4 Acc 0.8728947368421053, AUC 0.9637660384178162, avg_entr 0.04761284217238426, f1 0.8728947639465332
l4_test_time 0.1709449169999857
gc 0
Test threshold 0.1 Acc 0.866578947368421, AUC 0.9608289003372192, avg_entr 0.030344126746058464, f1 0.8665789365768433
t0.1_test_time 0.21159514600003604
gc 0
Test threshold 0.2 Acc 0.8639473684210527, AUC 0.9606826901435852, avg_entr 0.03143850341439247, f1 0.8639474511146545
t0.2_test_time 0.20589388800004826
gc 0
Test threshold 0.3 Acc 0.8592105263157894, AUC 0.9600169062614441, avg_entr 0.03499124199151993, f1 0.8592105507850647
t0.3_test_time 0.1988077269999735
gc 0
Test threshold 0.4 Acc 0.8555263157894737, AUC 0.9592350721359253, avg_entr 0.04086273908615112, f1 0.855526328086853
t0.4_test_time 0.17873082400001294
gc 0
Test threshold 0.5 Acc 0.8528947368421053, AUC 0.9588267207145691, avg_entr 0.04705430939793587, f1 0.8528947234153748
t0.5_test_time 0.15752017900001647
gc 0
Test threshold 0.6 Acc 0.8510526315789474, AUC 0.9587172269821167, avg_entr 0.04955630004405975, f1 0.8510526418685913
t0.6_test_time 0.13971139099999164
gc 0
Test threshold 0.7 Acc 0.8510526315789474, AUC 0.9587172269821167, avg_entr 0.04955630004405975, f1 0.8510526418685913
t0.7_test_time 0.1394267050000053
gc 0
Test threshold 0.8 Acc 0.8510526315789474, AUC 0.9587172269821167, avg_entr 0.04955630004405975, f1 0.8510526418685913
t0.8_test_time 0.14225490499995885
gc 0
Test threshold 0.9 Acc 0.8510526315789474, AUC 0.9587172269821167, avg_entr 0.04955630004405975, f1 0.8510526418685913
t0.9_test_time 0.13931574800000135
