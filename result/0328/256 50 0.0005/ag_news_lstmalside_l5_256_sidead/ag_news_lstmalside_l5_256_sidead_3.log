total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 48937892
init_time 41.785478182999995
Start Training
gc 0
Train Epoch0 Acc 0.2569166666666667 (30830/120000), AUC 0.5019955635070801
ep0_train_time 16.80658838
Test Epoch0 layer0 Acc 0.7197368421052631, AUC 0.9082423448562622, avg_entr 0.8243062496185303, f1 0.7197368741035461
ep0_l0_test_time 0.11978918100000158
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.72, AUC 0.9122252464294434, avg_entr 0.7664703726768494, f1 0.7199999690055847
ep0_l1_test_time 0.11979794100000163
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.5705263157894737, AUC 0.8261914849281311, avg_entr 1.013102412223816, f1 0.5705263018608093
ep0_l2_test_time 0.13355112500000388
Test Epoch0 layer3 Acc 0.4110526315789474, AUC 0.704101026058197, avg_entr 1.1240265369415283, f1 0.4110526442527771
ep0_l3_test_time 0.15019714000000306
Test Epoch0 layer4 Acc 0.24947368421052632, AUC 0.5721596479415894, avg_entr 1.2250312566757202, f1 0.2494736909866333
ep0_l4_test_time 0.1676451659999998
gc 0
Train Epoch1 Acc 0.728625 (87435/120000), AUC 0.90251624584198
ep1_train_time 16.674431356
Test Epoch1 layer0 Acc 0.8192105263157895, AUC 0.9528846740722656, avg_entr 0.36956095695495605, f1 0.8192104697227478
ep1_l0_test_time 0.1091179640000064
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8381578947368421, AUC 0.9591711759567261, avg_entr 0.2923966646194458, f1 0.8381578922271729
ep1_l1_test_time 0.11970866599999397
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8371052631578947, AUC 0.957118809223175, avg_entr 0.28466248512268066, f1 0.8371052742004395
ep1_l2_test_time 0.13442023200001074
Test Epoch1 layer3 Acc 0.8328947368421052, AUC 0.9525042772293091, avg_entr 0.2851738929748535, f1 0.8328947424888611
ep1_l3_test_time 0.14550850599999876
Test Epoch1 layer4 Acc 0.8323684210526315, AUC 0.9517041444778442, avg_entr 0.2784801423549652, f1 0.8323684930801392
ep1_l4_test_time 0.168621193000007
gc 0
Train Epoch2 Acc 0.8698083333333333 (104377/120000), AUC 0.9600638151168823
ep2_train_time 16.723371685999993
Test Epoch2 layer0 Acc 0.8313157894736842, AUC 0.9597510099411011, avg_entr 0.2162340134382248, f1 0.831315815448761
ep2_l0_test_time 0.14030415099999516
Test Epoch2 layer1 Acc 0.8476315789473684, AUC 0.965003252029419, avg_entr 0.17524519562721252, f1 0.847631573677063
ep2_l1_test_time 0.1526776710000064
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8452631578947368, AUC 0.9628973007202148, avg_entr 0.1652219444513321, f1 0.8452631831169128
ep2_l2_test_time 0.13261376699999516
Test Epoch2 layer3 Acc 0.8392105263157895, AUC 0.9586496353149414, avg_entr 0.16689740121364594, f1 0.8392105102539062
ep2_l3_test_time 0.1500662059999911
Test Epoch2 layer4 Acc 0.8352631578947368, AUC 0.9580950736999512, avg_entr 0.1685689240694046, f1 0.8352631330490112
ep2_l4_test_time 0.17175599099999772
gc 0
Train Epoch3 Acc 0.8979333333333334 (107752/120000), AUC 0.971526026725769
ep3_train_time 17.35685740000001
Test Epoch3 layer0 Acc 0.8542105263157894, AUC 0.9646274447441101, avg_entr 0.15311482548713684, f1 0.8542105555534363
ep3_l0_test_time 0.11383570499999962
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8718421052631579, AUC 0.9700934290885925, avg_entr 0.11108502000570297, f1 0.8718421459197998
ep3_l1_test_time 0.12264108599998735
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8686842105263158, AUC 0.969605565071106, avg_entr 0.10677111893892288, f1 0.8686841726303101
ep3_l2_test_time 0.12901336899999194
Test Epoch3 layer3 Acc 0.8707894736842106, AUC 0.9677375555038452, avg_entr 0.11005385220050812, f1 0.8707894682884216
ep3_l3_test_time 0.14912249099999997
Test Epoch3 layer4 Acc 0.8713157894736843, AUC 0.9665749073028564, avg_entr 0.10640780627727509, f1 0.8713157176971436
ep3_l4_test_time 0.16967684600000155
gc 0
Train Epoch4 Acc 0.9143666666666667 (109724/120000), AUC 0.9771585464477539
ep4_train_time 16.793423904999997
Test Epoch4 layer0 Acc 0.855, AUC 0.9658923149108887, avg_entr 0.12046436965465546, f1 0.8550000190734863
ep4_l0_test_time 0.1132633290000058
Test Epoch4 layer1 Acc 0.8773684210526316, AUC 0.9721289873123169, avg_entr 0.09286849945783615, f1 0.8773684501647949
ep4_l1_test_time 0.11914494500001638
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8781578947368421, AUC 0.9711561799049377, avg_entr 0.0916370376944542, f1 0.878157913684845
ep4_l2_test_time 0.13575001600000292
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer3 Acc 0.8760526315789474, AUC 0.9706088304519653, avg_entr 0.09464482963085175, f1 0.8760526180267334
ep4_l3_test_time 0.15067202700001303
Test Epoch4 layer4 Acc 0.875, AUC 0.9697322249412537, avg_entr 0.09700874984264374, f1 0.875
ep4_l4_test_time 0.16846981700001606
gc 0
Train Epoch5 Acc 0.928575 (111429/120000), AUC 0.9816084504127502
ep5_train_time 16.38355348099998
Test Epoch5 layer0 Acc 0.8586842105263158, AUC 0.9642632007598877, avg_entr 0.0936150997877121, f1 0.8586841821670532
ep5_l0_test_time 0.11365576299999702
Test Epoch5 layer1 Acc 0.8789473684210526, AUC 0.9717650413513184, avg_entr 0.07231670618057251, f1 0.878947377204895
ep5_l1_test_time 0.12000955800002089
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.8789473684210526, AUC 0.9718981981277466, avg_entr 0.07028032094240189, f1 0.878947377204895
ep5_l2_test_time 0.13131006399999023
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer3 Acc 0.88, AUC 0.9713778495788574, avg_entr 0.0709763914346695, f1 0.8799999952316284
ep5_l3_test_time 0.14917276900001752
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer4 Acc 0.88, AUC 0.9706522226333618, avg_entr 0.07214543223381042, f1 0.8799999952316284
ep5_l4_test_time 0.17239948299999241
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9402 (112824/120000), AUC 0.9846838712692261
ep6_train_time 16.878837395999994
Test Epoch6 layer0 Acc 0.8528947368421053, AUC 0.9632879495620728, avg_entr 0.08019547909498215, f1 0.8528947234153748
ep6_l0_test_time 0.11706660400000146
Test Epoch6 layer1 Acc 0.8728947368421053, AUC 0.9706075191497803, avg_entr 0.05630975589156151, f1 0.8728947639465332
ep6_l1_test_time 0.12129154900000572
Test Epoch6 layer2 Acc 0.8752631578947369, AUC 0.9683538675308228, avg_entr 0.054706767201423645, f1 0.8752631545066833
ep6_l2_test_time 0.1320448080000176
Test Epoch6 layer3 Acc 0.8752631578947369, AUC 0.9667132496833801, avg_entr 0.05327891558408737, f1 0.8752631545066833
ep6_l3_test_time 0.14805884500000843
Test Epoch6 layer4 Acc 0.8731578947368421, AUC 0.9661602973937988, avg_entr 0.051871441304683685, f1 0.8731579184532166
ep6_l4_test_time 0.16289323600000216
gc 0
Train Epoch7 Acc 0.948 (113760/120000), AUC 0.9866943359375
ep7_train_time 16.79874710300001
Test Epoch7 layer0 Acc 0.8523684210526316, AUC 0.9632151126861572, avg_entr 0.06517533212900162, f1 0.8523684144020081
ep7_l0_test_time 0.11803209199999287
Test Epoch7 layer1 Acc 0.8660526315789474, AUC 0.9705013036727905, avg_entr 0.05591782182455063, f1 0.8660526275634766
ep7_l1_test_time 0.11859500200000639
Test Epoch7 layer2 Acc 0.8657894736842106, AUC 0.9711117744445801, avg_entr 0.05531119927763939, f1 0.8657894730567932
ep7_l2_test_time 0.1341177259999995
Test Epoch7 layer3 Acc 0.8660526315789474, AUC 0.9703079462051392, avg_entr 0.055509038269519806, f1 0.8660526275634766
ep7_l3_test_time 0.14947831899999642
Test Epoch7 layer4 Acc 0.8655263157894737, AUC 0.9686580300331116, avg_entr 0.05594497546553612, f1 0.8655263185501099
ep7_l4_test_time 0.17045805300000438
gc 0
Train Epoch8 Acc 0.9558833333333333 (114706/120000), AUC 0.9883322715759277
ep8_train_time 16.5842509
Test Epoch8 layer0 Acc 0.8557894736842105, AUC 0.9634456634521484, avg_entr 0.05626385286450386, f1 0.8557894825935364
ep8_l0_test_time 0.11683197499999665
Test Epoch8 layer1 Acc 0.8781578947368421, AUC 0.9706770777702332, avg_entr 0.04204314947128296, f1 0.878157913684845
ep8_l1_test_time 0.11767719400000942
Test Epoch8 layer2 Acc 0.8781578947368421, AUC 0.9701926708221436, avg_entr 0.03999808803200722, f1 0.878157913684845
ep8_l2_test_time 0.12915962100001366
Test Epoch8 layer3 Acc 0.8768421052631579, AUC 0.9681416153907776, avg_entr 0.03908829018473625, f1 0.8768420815467834
ep8_l3_test_time 0.1526965779999898
Test Epoch8 layer4 Acc 0.8768421052631579, AUC 0.9678485989570618, avg_entr 0.0363147109746933, f1 0.8768420815467834
ep8_l4_test_time 0.17035186500001487
gc 0
Train Epoch9 Acc 0.965975 (115917/120000), AUC 0.9906952977180481
ep9_train_time 16.54860779699999
Test Epoch9 layer0 Acc 0.8597368421052631, AUC 0.9621401429176331, avg_entr 0.04973718523979187, f1 0.8597368597984314
ep9_l0_test_time 0.14018424300002152
Test Epoch9 layer1 Acc 0.8781578947368421, AUC 0.9670408964157104, avg_entr 0.029585570096969604, f1 0.878157913684845
ep9_l1_test_time 0.14757081900000912
Test Epoch9 layer2 Acc 0.8810526315789474, AUC 0.9677470326423645, avg_entr 0.027475368231534958, f1 0.8810526132583618
ep9_l2_test_time 0.1599407450000001
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer3 Acc 0.8810526315789474, AUC 0.9654511213302612, avg_entr 0.027139438316226006, f1 0.8810526132583618
ep9_l3_test_time 0.14878412500002014
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer4 Acc 0.8826315789473684, AUC 0.9658396244049072, avg_entr 0.024785811081528664, f1 0.8826315999031067
ep9_l4_test_time 0.1698810630000196
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.97085 (116502/120000), AUC 0.992266058921814
ep10_train_time 16.914709869000006
Test Epoch10 layer0 Acc 0.8555263157894737, AUC 0.9586988687515259, avg_entr 0.0469934418797493, f1 0.855526328086853
ep10_l0_test_time 0.11099843200000237
Test Epoch10 layer1 Acc 0.8763157894736842, AUC 0.9651768207550049, avg_entr 0.029319757595658302, f1 0.8763157725334167
ep10_l1_test_time 0.11953309599999784
Test Epoch10 layer2 Acc 0.8794736842105263, AUC 0.9671298265457153, avg_entr 0.028749490156769753, f1 0.8794736862182617
ep10_l2_test_time 0.13314391900001965
Test Epoch10 layer3 Acc 0.8786842105263157, AUC 0.9670016765594482, avg_entr 0.029006872326135635, f1 0.8786842226982117
ep10_l3_test_time 0.15035872900000413
Test Epoch10 layer4 Acc 0.8786842105263157, AUC 0.9672237038612366, avg_entr 0.027685200795531273, f1 0.8786842226982117
ep10_l4_test_time 0.16750930199998493
gc 0
Train Epoch11 Acc 0.97405 (116886/120000), AUC 0.9928112030029297
ep11_train_time 16.955343165000016
Test Epoch11 layer0 Acc 0.8560526315789474, AUC 0.9596526622772217, avg_entr 0.03971941024065018, f1 0.8560526371002197
ep11_l0_test_time 0.11688168299997415
Test Epoch11 layer1 Acc 0.8736842105263158, AUC 0.9637484550476074, avg_entr 0.025852570310235023, f1 0.8736842274665833
ep11_l1_test_time 0.12002565900002082
Test Epoch11 layer2 Acc 0.8752631578947369, AUC 0.9638245105743408, avg_entr 0.024884305894374847, f1 0.8752631545066833
ep11_l2_test_time 0.13061263800000233
Test Epoch11 layer3 Acc 0.8739473684210526, AUC 0.9625452756881714, avg_entr 0.023343246430158615, f1 0.8739473819732666
ep11_l3_test_time 0.15320465899998226
Test Epoch11 layer4 Acc 0.8747368421052631, AUC 0.9577658772468567, avg_entr 0.02182106301188469, f1 0.8747368454933167
ep11_l4_test_time 0.1690639799999758
gc 0
Train Epoch12 Acc 0.9766583333333333 (117199/120000), AUC 0.9932506680488586
ep12_train_time 16.432444546
Test Epoch12 layer0 Acc 0.8557894736842105, AUC 0.9573467969894409, avg_entr 0.03894785791635513, f1 0.8557894825935364
ep12_l0_test_time 0.09211957600001597
Test Epoch12 layer1 Acc 0.8692105263157894, AUC 0.9605623483657837, avg_entr 0.025026606395840645, f1 0.8692105412483215
ep12_l1_test_time 0.1214781379999863
Test Epoch12 layer2 Acc 0.8694736842105263, AUC 0.9600719213485718, avg_entr 0.02261369489133358, f1 0.8694736957550049
ep12_l2_test_time 0.13218324500002154
Test Epoch12 layer3 Acc 0.8702631578947368, AUC 0.9569931030273438, avg_entr 0.02120402082800865, f1 0.8702631592750549
ep12_l3_test_time 0.1489483180000093
Test Epoch12 layer4 Acc 0.8713157894736843, AUC 0.9523123502731323, avg_entr 0.01907753013074398, f1 0.8713157176971436
ep12_l4_test_time 0.1700385449999544
gc 0
Train Epoch13 Acc 0.9799583333333334 (117595/120000), AUC 0.9937958121299744
ep13_train_time 16.86726298100001
Test Epoch13 layer0 Acc 0.8555263157894737, AUC 0.955718994140625, avg_entr 0.03328549116849899, f1 0.855526328086853
ep13_l0_test_time 0.11181452299996408
Test Epoch13 layer1 Acc 0.871578947368421, AUC 0.9585449695587158, avg_entr 0.023350585252046585, f1 0.8715789318084717
ep13_l1_test_time 0.12371886299996504
Test Epoch13 layer2 Acc 0.8736842105263158, AUC 0.9567188024520874, avg_entr 0.018570207059383392, f1 0.8736842274665833
ep13_l2_test_time 0.1331194510000273
Test Epoch13 layer3 Acc 0.8736842105263158, AUC 0.9546095132827759, avg_entr 0.01673634722828865, f1 0.8736842274665833
ep13_l3_test_time 0.14949998600002345
Test Epoch13 layer4 Acc 0.8739473684210526, AUC 0.9504343271255493, avg_entr 0.014591217041015625, f1 0.8739473819732666
ep13_l4_test_time 0.16770526199996993
gc 0
Train Epoch14 Acc 0.9818 (117816/120000), AUC 0.9945579171180725
ep14_train_time 16.769033733000015
Test Epoch14 layer0 Acc 0.8536842105263158, AUC 0.9546639323234558, avg_entr 0.033380959182977676, f1 0.8536841869354248
ep14_l0_test_time 0.11306704500003661
Test Epoch14 layer1 Acc 0.8707894736842106, AUC 0.9567621946334839, avg_entr 0.018522093072533607, f1 0.8707894682884216
ep14_l1_test_time 0.12249423999998044
Test Epoch14 layer2 Acc 0.8721052631578947, AUC 0.9576994180679321, avg_entr 0.01683783531188965, f1 0.8721052408218384
ep14_l2_test_time 0.13335903900002677
Test Epoch14 layer3 Acc 0.8721052631578947, AUC 0.9556452631950378, avg_entr 0.016560304909944534, f1 0.8721052408218384
ep14_l3_test_time 0.1462109450000071
Test Epoch14 layer4 Acc 0.8728947368421053, AUC 0.9560192227363586, avg_entr 0.014641767367720604, f1 0.8728947639465332
ep14_l4_test_time 0.16843675199999097
gc 0
Train Epoch15 Acc 0.9827416666666666 (117929/120000), AUC 0.9947763681411743
ep15_train_time 16.86736371400002
Test Epoch15 layer0 Acc 0.853421052631579, AUC 0.9522606134414673, avg_entr 0.030131759122014046, f1 0.8534210324287415
ep15_l0_test_time 0.11732280399996853
Test Epoch15 layer1 Acc 0.8678947368421053, AUC 0.9556366205215454, avg_entr 0.017827413976192474, f1 0.86789470911026
ep15_l1_test_time 0.11767114899998887
Test Epoch15 layer2 Acc 0.8689473684210526, AUC 0.9561008214950562, avg_entr 0.01474849320948124, f1 0.8689473867416382
ep15_l2_test_time 0.13396125700000994
Test Epoch15 layer3 Acc 0.8694736842105263, AUC 0.959396243095398, avg_entr 0.013450502417981625, f1 0.8694736957550049
ep15_l3_test_time 0.14610970200004658
Test Epoch15 layer4 Acc 0.8705263157894737, AUC 0.9596930742263794, avg_entr 0.012815519236028194, f1 0.8705263137817383
ep15_l4_test_time 0.16964088299999958
gc 0
Train Epoch16 Acc 0.9830166666666666 (117962/120000), AUC 0.9945842027664185
ep16_train_time 16.975498938000044
Test Epoch16 layer0 Acc 0.8523684210526316, AUC 0.9531139135360718, avg_entr 0.02979883924126625, f1 0.8523684144020081
ep16_l0_test_time 0.11493049299997438
Test Epoch16 layer1 Acc 0.8657894736842106, AUC 0.955904483795166, avg_entr 0.016718382015824318, f1 0.8657894730567932
ep16_l1_test_time 0.12078042000001687
Test Epoch16 layer2 Acc 0.8652631578947368, AUC 0.9566957950592041, avg_entr 0.014330346137285233, f1 0.8652631640434265
ep16_l2_test_time 0.13454060499998377
Test Epoch16 layer3 Acc 0.865, AUC 0.9590016603469849, avg_entr 0.01421736367046833, f1 0.8650000095367432
ep16_l3_test_time 0.15056720199999063
Test Epoch16 layer4 Acc 0.8644736842105263, AUC 0.9578509330749512, avg_entr 0.01315227523446083, f1 0.8644736409187317
ep16_l4_test_time 0.17082722300000341
gc 0
Train Epoch17 Acc 0.9843583333333333 (118123/120000), AUC 0.9951585531234741
ep17_train_time 16.574572382000042
Test Epoch17 layer0 Acc 0.85, AUC 0.9508097171783447, avg_entr 0.028484508395195007, f1 0.8500000238418579
ep17_l0_test_time 0.11486534300001949
Test Epoch17 layer1 Acc 0.8652631578947368, AUC 0.9529405236244202, avg_entr 0.015990404412150383, f1 0.8652631640434265
ep17_l1_test_time 0.11797911799999383
Test Epoch17 layer2 Acc 0.8671052631578947, AUC 0.9539860486984253, avg_entr 0.013171382248401642, f1 0.86710524559021
ep17_l2_test_time 0.13311419199999364
Test Epoch17 layer3 Acc 0.868421052631579, AUC 0.9556702971458435, avg_entr 0.012583715841174126, f1 0.8684210777282715
ep17_l3_test_time 0.15016945700000406
Test Epoch17 layer4 Acc 0.8676315789473684, AUC 0.9536706209182739, avg_entr 0.011948201805353165, f1 0.8676315546035767
ep17_l4_test_time 0.1670803740000224
gc 0
Train Epoch18 Acc 0.9849166666666667 (118190/120000), AUC 0.9954119920730591
ep18_train_time 16.65082526499998
Test Epoch18 layer0 Acc 0.8492105263157895, AUC 0.9499280452728271, avg_entr 0.02904207445681095, f1 0.8492104411125183
ep18_l0_test_time 0.115962871000022
Test Epoch18 layer1 Acc 0.8621052631578947, AUC 0.9526086449623108, avg_entr 0.01585478149354458, f1 0.8621052503585815
ep18_l1_test_time 0.11682321900002535
Test Epoch18 layer2 Acc 0.8673684210526316, AUC 0.951618492603302, avg_entr 0.012746612541377544, f1 0.8673684000968933
ep18_l2_test_time 0.13124253699999144
Test Epoch18 layer3 Acc 0.866578947368421, AUC 0.9521936774253845, avg_entr 0.011500275693833828, f1 0.8665789365768433
ep18_l3_test_time 0.15006851700002244
Test Epoch18 layer4 Acc 0.866578947368421, AUC 0.9514033794403076, avg_entr 0.0105481818318367, f1 0.8665789365768433
ep18_l4_test_time 0.17297525399999358
gc 0
Train Epoch19 Acc 0.9852083333333334 (118225/120000), AUC 0.9954779148101807
ep19_train_time 16.709904386000005
Test Epoch19 layer0 Acc 0.8471052631578947, AUC 0.9485111236572266, avg_entr 0.02595783770084381, f1 0.8471052646636963
ep19_l0_test_time 0.14004015800003344
Test Epoch19 layer1 Acc 0.863421052631579, AUC 0.9509331583976746, avg_entr 0.013713140971958637, f1 0.8634210228919983
ep19_l1_test_time 0.146641542999987
Test Epoch19 layer2 Acc 0.8644736842105263, AUC 0.95067298412323, avg_entr 0.011639995500445366, f1 0.8644736409187317
ep19_l2_test_time 0.16261762400000634
Test Epoch19 layer3 Acc 0.8647368421052631, AUC 0.9514949321746826, avg_entr 0.011820458807051182, f1 0.8647368550300598
ep19_l3_test_time 0.16963074599999572
Test Epoch19 layer4 Acc 0.8644736842105263, AUC 0.9504973888397217, avg_entr 0.011498147621750832, f1 0.8644736409187317
ep19_l4_test_time 0.1915167760000145
Best AUC tensor(0.8826) 9 4
train_as_loss [[4.60021753e+02 3.56467041e+02 3.50959772e+02 3.49771824e+02
  3.49327495e+02 3.49115447e+02 3.48999209e+02 3.48929549e+02
  3.48885186e+02 3.48861445e+02 3.48848188e+02 3.48836362e+02
  3.48826081e+02 3.48819252e+02 3.48814822e+02 3.48810441e+02
  3.48806233e+02 3.48803221e+02 3.48801131e+02 3.48798976e+02]
 [1.57563116e+00 1.78110960e-05 1.20085496e-06 2.32406369e-07
  6.75862322e-08 2.68077846e-06 2.14717250e-05 3.72126252e-05
  2.01376842e-04 4.18991320e-08 1.19291763e-09 1.03495979e-09
  6.44456744e-05 1.39245977e-06 3.81046644e-10 2.32253434e-09
  3.06375948e-05 5.74996523e-09 2.22466883e-10 3.00884093e-10]
 [1.60866382e+00 1.96847130e-05 1.36930219e-06 2.75431185e-07
  8.83114506e-08 2.46904339e-06 2.49321240e-05 7.44762588e-05
  4.23031637e-04 8.10414395e-07 2.56247658e-09 3.05633752e-09
  1.24872496e-04 1.19590865e-05 9.95584547e-10 3.69641530e-09
  6.91529403e-05 6.55461906e-08 6.53925959e-10 9.78511798e-10]
 [1.73015712e+00 1.63412843e-05 1.39647501e-06 3.50366856e-07
  1.44873810e-07 1.91016986e-06 2.58141821e-05 1.10506879e-04
  6.21803620e-04 3.94809931e-06 8.34225517e-09 1.05675344e-08
  1.83275810e-04 9.68846269e-05 3.11068821e-09 7.47638699e-09
  9.81426480e-05 6.50325109e-07 2.25038561e-09 3.76034966e-09]
 [1.69366399e+00 1.51209333e-05 1.71135715e-06 5.97211018e-07
  3.43359269e-07 2.12836368e-06 3.52679330e-05 1.81242535e-04
  1.05117378e-03 1.99907881e-05 3.14824965e-08 4.30604759e-08
  2.84814223e-04 3.63070035e-04 9.53326091e-09 2.05130287e-08
  1.26765952e-04 1.86248998e-06 8.60136494e-09 1.42900075e-08]]
train_ae_loss [[10.85594004 11.72200555 10.90890609 10.16630449  9.63982762  8.9041549
   8.32646812  7.82221821  7.28780316  5.91946883  5.43499829  5.15827488
   4.95229205  4.33556713  4.11651742  4.0043637   3.94099154  3.70178256
   3.61762606  3.57161999]
 [10.75719855  9.8516619   8.84042418  8.08745891  7.51876594  6.80033261
   6.18781412  5.69190805  5.15745371  3.95161376  3.53651389  3.29155413
   3.0664015   2.53920904  2.37216287  2.26644515  2.20050604  1.99546996
   1.9335808   1.88099553]
 [11.45117541  9.65702061  8.14314751  7.29255366  6.67542588  5.95839584
   5.37209729  4.90153001  4.4035922   3.36708478  2.96835204  2.74326614
   2.54370656  2.09403032  1.93737947  1.84353058  1.78104139  1.60088849
   1.53511677  1.48708878]
 [11.05892683 10.25068663  7.89730951  6.98193512  6.33716096  5.618259
   5.04010599  4.57830497  4.08455796  3.0998059   2.71143515  2.49384387
   2.29686293  1.88008408  1.72627837  1.63663639  1.57787456  1.40268803
   1.34003755  1.29659295]
 [10.58217547 10.95811777  7.45546025  6.5216944   5.87802561  5.17614682
   4.61603681  4.17901163  3.70928464  2.79187219  2.43521365  2.23419578
   2.05697048  1.67889432  1.53492652  1.45028521  1.39826786  1.23840026
   1.1772293   1.13959218]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 356.63669797399996
Start Testing
Load ckpt at ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt
gc 10
Test layer0 Acc 0.8573684210526316, AUC 0.9558818340301514, avg_entr 0.049793414771556854, f1 0.8573684096336365
l0_test_time 0.14340828999996802
gc 0
Test layer1 Acc 0.8723684210526316, AUC 0.9660657048225403, avg_entr 0.034626711159944534, f1 0.8723683953285217
l1_test_time 0.1453783279999925
gc 0
Test layer2 Acc 0.8739473684210526, AUC 0.9628307223320007, avg_entr 0.032781876623630524, f1 0.8739473819732666
l2_test_time 0.16022767700002305
gc 0
Test layer3 Acc 0.8789473684210526, AUC 0.9613484144210815, avg_entr 0.03262526914477348, f1 0.878947377204895
l3_test_time 0.1759754990000033
gc 0
Test layer4 Acc 0.8792105263157894, AUC 0.9638414978981018, avg_entr 0.030148955062031746, f1 0.8792105317115784
l4_test_time 0.193865618000018
gc 0
Test threshold 0.1 Acc 0.8692105263157894, AUC 0.9577449560165405, avg_entr 0.018138069659471512, f1 0.8692105412483215
t0.1_test_time 0.29504646200001616
gc 0
Test threshold 0.2 Acc 0.8678947368421053, AUC 0.9570788145065308, avg_entr 0.019465604797005653, f1 0.86789470911026
t0.2_test_time 0.28540259400000423
gc 0
Test threshold 0.3 Acc 0.8647368421052631, AUC 0.9563656449317932, avg_entr 0.023813188076019287, f1 0.8647368550300598
t0.3_test_time 0.2789857060000145
gc 0
Test threshold 0.4 Acc 0.8605263157894737, AUC 0.9560408592224121, avg_entr 0.02996409311890602, f1 0.8605263233184814
t0.4_test_time 0.2406805059999897
gc 0
Test threshold 0.5 Acc 0.8578947368421053, AUC 0.9559133052825928, avg_entr 0.03469780832529068, f1 0.8578947186470032
t0.5_test_time 0.2073759950000067
gc 0
Test threshold 0.6 Acc 0.8573684210526316, AUC 0.9558818340301514, avg_entr 0.03591835871338844, f1 0.8573684096336365
t0.6_test_time 0.18909117600003356
gc 0
Test threshold 0.7 Acc 0.8573684210526316, AUC 0.9558818340301514, avg_entr 0.03591835871338844, f1 0.8573684096336365
t0.7_test_time 0.18812318699997377
gc 0
Test threshold 0.8 Acc 0.8573684210526316, AUC 0.9558818340301514, avg_entr 0.03591835871338844, f1 0.8573684096336365
t0.8_test_time 0.19273516999999174
gc 0
Test threshold 0.9 Acc 0.8573684210526316, AUC 0.9558818340301514, avg_entr 0.03591835871338844, f1 0.8573684096336365
t0.9_test_time 0.18670069900002773
