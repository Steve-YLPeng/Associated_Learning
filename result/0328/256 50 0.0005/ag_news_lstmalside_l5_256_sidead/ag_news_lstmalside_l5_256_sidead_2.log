total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 48937892
init_time 41.605664038
Start Training
gc 0
Train Epoch0 Acc 0.25411666666666666 (30494/120000), AUC 0.5016467571258545
ep0_train_time 17.355452122000003
Test Epoch0 layer0 Acc 0.7160526315789474, AUC 0.900446891784668, avg_entr 0.862002968788147, f1 0.7160525918006897
ep0_l0_test_time 0.11898750200000308
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7247368421052631, AUC 0.9091060161590576, avg_entr 0.7896624207496643, f1 0.7247368693351746
ep0_l1_test_time 0.12429404100000596
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.6502631578947369, AUC 0.8528239727020264, avg_entr 0.890519380569458, f1 0.6502631306648254
ep0_l2_test_time 0.13168305199999963
Test Epoch0 layer3 Acc 0.4357894736842105, AUC 0.7051262855529785, avg_entr 1.2281757593154907, f1 0.43578946590423584
ep0_l3_test_time 0.15169893800000267
Test Epoch0 layer4 Acc 0.25894736842105265, AUC 0.62041175365448, avg_entr 1.254496455192566, f1 0.25894737243652344
ep0_l4_test_time 0.1683313150000032
gc 0
Train Epoch1 Acc 0.7084166666666667 (85010/120000), AUC 0.8965454697608948
ep1_train_time 16.472959207999992
Test Epoch1 layer0 Acc 0.8168421052631579, AUC 0.9520848989486694, avg_entr 0.3879868686199188, f1 0.8168420791625977
ep1_l0_test_time 0.10975932399999522
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8386842105263158, AUC 0.9582778811454773, avg_entr 0.3041941821575165, f1 0.8386842012405396
ep1_l1_test_time 0.12313696500000049
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8392105263157895, AUC 0.9554567933082581, avg_entr 0.28591349720954895, f1 0.8392105102539062
ep1_l2_test_time 0.13487896300000557
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer3 Acc 0.8368421052631579, AUC 0.9511384963989258, avg_entr 0.288250207901001, f1 0.8368421196937561
ep1_l3_test_time 0.1537334939999937
Test Epoch1 layer4 Acc 0.8347368421052631, AUC 0.9469150900840759, avg_entr 0.2876969873905182, f1 0.8347368240356445
ep1_l4_test_time 0.1713667030000039
gc 0
Train Epoch2 Acc 0.8672916666666667 (104075/120000), AUC 0.9591382741928101
ep2_train_time 16.516394454000007
Test Epoch2 layer0 Acc 0.843421052631579, AUC 0.9614083766937256, avg_entr 0.22875410318374634, f1 0.8434211015701294
ep2_l0_test_time 0.11952351399999372
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8597368421052631, AUC 0.9682501554489136, avg_entr 0.1830471158027649, f1 0.8597368597984314
ep2_l1_test_time 0.13082870400000957
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8581578947368421, AUC 0.9640200138092041, avg_entr 0.1648818552494049, f1 0.8581578731536865
ep2_l2_test_time 0.1442487380000017
Test Epoch2 layer3 Acc 0.8547368421052631, AUC 0.9635670185089111, avg_entr 0.16597095131874084, f1 0.854736864566803
ep2_l3_test_time 0.15575019999999995
Test Epoch2 layer4 Acc 0.8528947368421053, AUC 0.9614057540893555, avg_entr 0.16032926738262177, f1 0.8528947234153748
ep2_l4_test_time 0.1694457899999975
gc 0
Train Epoch3 Acc 0.8962916666666667 (107555/120000), AUC 0.9712121486663818
ep3_train_time 16.477900513999998
Test Epoch3 layer0 Acc 0.8439473684210527, AUC 0.9633249044418335, avg_entr 0.1702994406223297, f1 0.8439473509788513
ep3_l0_test_time 0.11585233499999958
Test Epoch3 layer1 Acc 0.8621052631578947, AUC 0.969948410987854, avg_entr 0.13150039315223694, f1 0.8621052503585815
ep3_l1_test_time 0.12348210099999335
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8642105263157894, AUC 0.9691380858421326, avg_entr 0.12672050297260284, f1 0.8642105460166931
ep3_l2_test_time 0.13545368399999802
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer3 Acc 0.8631578947368421, AUC 0.9672947525978088, avg_entr 0.12940795719623566, f1 0.8631578683853149
ep3_l3_test_time 0.1498354239999884
Test Epoch3 layer4 Acc 0.8628947368421053, AUC 0.963442862033844, avg_entr 0.13087955117225647, f1 0.8628947138786316
ep3_l4_test_time 0.16957471300000293
gc 0
Train Epoch4 Acc 0.9141166666666667 (109694/120000), AUC 0.9773999452590942
ep4_train_time 16.641328059000003
Test Epoch4 layer0 Acc 0.8510526315789474, AUC 0.9648306965827942, avg_entr 0.12195935845375061, f1 0.8510526418685913
ep4_l0_test_time 0.11538210100002289
Test Epoch4 layer1 Acc 0.8705263157894737, AUC 0.9716273546218872, avg_entr 0.09638959169387817, f1 0.8705263137817383
ep4_l1_test_time 0.12804966300001297
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8721052631578947, AUC 0.9709964990615845, avg_entr 0.09140804409980774, f1 0.8721052408218384
ep4_l2_test_time 0.13532442500002162
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer3 Acc 0.8731578947368421, AUC 0.9709218740463257, avg_entr 0.09230600297451019, f1 0.8731579184532166
ep4_l3_test_time 0.15033671999998433
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer4 Acc 0.8731578947368421, AUC 0.9691574573516846, avg_entr 0.08761683106422424, f1 0.8731579184532166
ep4_l4_test_time 0.17534435900000744
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9279333333333334 (111352/120000), AUC 0.9813839197158813
ep5_train_time 16.456095628999975
Test Epoch5 layer0 Acc 0.8565789473684211, AUC 0.9657038450241089, avg_entr 0.10248494148254395, f1 0.8565789461135864
ep5_l0_test_time 0.11552143299999784
Test Epoch5 layer1 Acc 0.8713157894736843, AUC 0.9718092679977417, avg_entr 0.0843275785446167, f1 0.8713157176971436
ep5_l1_test_time 0.12085403499997938
Test Epoch5 layer2 Acc 0.8742105263157894, AUC 0.9705487489700317, avg_entr 0.0744829997420311, f1 0.87421053647995
ep5_l2_test_time 0.13597277799999574
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer3 Acc 0.8726315789473684, AUC 0.9687873125076294, avg_entr 0.07158886641263962, f1 0.8726315498352051
ep5_l3_test_time 0.15067731999999978
Test Epoch5 layer4 Acc 0.873421052631579, AUC 0.9665753841400146, avg_entr 0.06876540929079056, f1 0.8734210729598999
ep5_l4_test_time 0.16847825600001443
gc 0
Train Epoch6 Acc 0.9380083333333333 (112561/120000), AUC 0.9840834140777588
ep6_train_time 16.879974670999985
Test Epoch6 layer0 Acc 0.8502631578947368, AUC 0.9650747776031494, avg_entr 0.08145666867494583, f1 0.8502631783485413
ep6_l0_test_time 0.11387382099999854
Test Epoch6 layer1 Acc 0.8707894736842106, AUC 0.9725605249404907, avg_entr 0.05457925423979759, f1 0.8707894682884216
ep6_l1_test_time 0.12192775999997707
Test Epoch6 layer2 Acc 0.8718421052631579, AUC 0.9705983400344849, avg_entr 0.052530426532030106, f1 0.8718421459197998
ep6_l2_test_time 0.13504954100000077
Test Epoch6 layer3 Acc 0.8731578947368421, AUC 0.9680979251861572, avg_entr 0.05014606937766075, f1 0.8731579184532166
ep6_l3_test_time 0.15117275599999402
Test Epoch6 layer4 Acc 0.8728947368421053, AUC 0.9649503231048584, avg_entr 0.04995553940534592, f1 0.8728947639465332
ep6_l4_test_time 0.1709345790000043
gc 0
Train Epoch7 Acc 0.947175 (113661/120000), AUC 0.9868753552436829
ep7_train_time 16.872857597999996
Test Epoch7 layer0 Acc 0.8513157894736842, AUC 0.9639690518379211, avg_entr 0.06775292754173279, f1 0.8513157963752747
ep7_l0_test_time 0.11309041600000569
Test Epoch7 layer1 Acc 0.8678947368421053, AUC 0.971124529838562, avg_entr 0.053496282547712326, f1 0.86789470911026
ep7_l1_test_time 0.12232716500000151
Test Epoch7 layer2 Acc 0.8694736842105263, AUC 0.9703105092048645, avg_entr 0.051197294145822525, f1 0.8694736957550049
ep7_l2_test_time 0.13268689400001676
Test Epoch7 layer3 Acc 0.8702631578947368, AUC 0.9671127200126648, avg_entr 0.04950571432709694, f1 0.8702631592750549
ep7_l3_test_time 0.15336731600001485
Test Epoch7 layer4 Acc 0.868421052631579, AUC 0.9669324159622192, avg_entr 0.048686861991882324, f1 0.8684210777282715
ep7_l4_test_time 0.16961254399998893
gc 0
Train Epoch8 Acc 0.954225 (114507/120000), AUC 0.9888249039649963
ep8_train_time 16.780498789000006
Test Epoch8 layer0 Acc 0.8481578947368421, AUC 0.9627785682678223, avg_entr 0.05910973623394966, f1 0.8481578826904297
ep8_l0_test_time 0.1082606229999783
Test Epoch8 layer1 Acc 0.8689473684210526, AUC 0.9701464772224426, avg_entr 0.043912794440984726, f1 0.8689473867416382
ep8_l1_test_time 0.12380291400000942
Test Epoch8 layer2 Acc 0.8702631578947368, AUC 0.9704084992408752, avg_entr 0.04150097444653511, f1 0.8702631592750549
ep8_l2_test_time 0.13427531400000703
Test Epoch8 layer3 Acc 0.8697368421052631, AUC 0.9681483507156372, avg_entr 0.04152856022119522, f1 0.8697368502616882
ep8_l3_test_time 0.1477969730000268
Test Epoch8 layer4 Acc 0.8710526315789474, AUC 0.966368556022644, avg_entr 0.04026653617620468, f1 0.871052622795105
ep8_l4_test_time 0.17102509700001178
gc 0
Train Epoch9 Acc 0.9612416666666667 (115349/120000), AUC 0.9905257225036621
ep9_train_time 16.704583163999985
Test Epoch9 layer0 Acc 0.8518421052631578, AUC 0.9602124094963074, avg_entr 0.05043807253241539, f1 0.8518421053886414
ep9_l0_test_time 0.11362911700001632
Test Epoch9 layer1 Acc 0.8697368421052631, AUC 0.9680216312408447, avg_entr 0.03688042610883713, f1 0.8697368502616882
ep9_l1_test_time 0.12628390000000422
Test Epoch9 layer2 Acc 0.8723684210526316, AUC 0.9686428308486938, avg_entr 0.03438263759016991, f1 0.8723683953285217
ep9_l2_test_time 0.13247090100000491
Test Epoch9 layer3 Acc 0.8752631578947369, AUC 0.9659007787704468, avg_entr 0.03330007568001747, f1 0.8752631545066833
ep9_l3_test_time 0.14737728500000458
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer4 Acc 0.8747368421052631, AUC 0.9652929902076721, avg_entr 0.03183434158563614, f1 0.8747368454933167
ep9_l4_test_time 0.1734935129999826
gc 0
Train Epoch10 Acc 0.9686083333333333 (116233/120000), AUC 0.9920797944068909
ep10_train_time 16.527943808000003
Test Epoch10 layer0 Acc 0.8597368421052631, AUC 0.9599300026893616, avg_entr 0.043030284345149994, f1 0.8597368597984314
ep10_l0_test_time 0.11889530900000977
Test Epoch10 layer1 Acc 0.8726315789473684, AUC 0.9669549465179443, avg_entr 0.031249994412064552, f1 0.8726315498352051
ep10_l1_test_time 0.1223230360000116
Test Epoch10 layer2 Acc 0.8752631578947369, AUC 0.9674473404884338, avg_entr 0.029078558087348938, f1 0.8752631545066833
ep10_l2_test_time 0.13286585299999842
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer3 Acc 0.8747368421052631, AUC 0.9667806625366211, avg_entr 0.028244346380233765, f1 0.8747368454933167
ep10_l3_test_time 0.14868859999998563
Test Epoch10 layer4 Acc 0.8747368421052631, AUC 0.9668267965316772, avg_entr 0.027172842994332314, f1 0.8747368454933167
ep10_l4_test_time 0.17324868299999707
gc 0
Train Epoch11 Acc 0.9737083333333333 (116845/120000), AUC 0.9928514957427979
ep11_train_time 16.45431206899997
Test Epoch11 layer0 Acc 0.8547368421052631, AUC 0.9569069147109985, avg_entr 0.04144158586859703, f1 0.854736864566803
ep11_l0_test_time 0.10998587099999213
Test Epoch11 layer1 Acc 0.8707894736842106, AUC 0.9635859131813049, avg_entr 0.026290174573659897, f1 0.8707894682884216
ep11_l1_test_time 0.1220637480000164
Test Epoch11 layer2 Acc 0.8757894736842106, AUC 0.9632265567779541, avg_entr 0.021912457421422005, f1 0.87578946352005
ep11_l2_test_time 0.10914805499999147
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 11
Test Epoch11 layer3 Acc 0.875, AUC 0.9617800712585449, avg_entr 0.021070949733257294, f1 0.875
ep11_l3_test_time 0.15825813700001845
Test Epoch11 layer4 Acc 0.875, AUC 0.9616389274597168, avg_entr 0.02071709930896759, f1 0.875
ep11_l4_test_time 0.1924988019999887
gc 0
Train Epoch12 Acc 0.9766833333333333 (117202/120000), AUC 0.9935872554779053
ep12_train_time 16.856938069000023
Test Epoch12 layer0 Acc 0.8547368421052631, AUC 0.9549189209938049, avg_entr 0.037871044129133224, f1 0.854736864566803
ep12_l0_test_time 0.12761078500000167
Test Epoch12 layer1 Acc 0.8723684210526316, AUC 0.9629775285720825, avg_entr 0.024048926308751106, f1 0.8723683953285217
ep12_l1_test_time 0.12255060900002945
Test Epoch12 layer2 Acc 0.8728947368421053, AUC 0.9627244472503662, avg_entr 0.02193632163107395, f1 0.8728947639465332
ep12_l2_test_time 0.13408433299997569
Test Epoch12 layer3 Acc 0.8726315789473684, AUC 0.962465763092041, avg_entr 0.021874522790312767, f1 0.8726315498352051
ep12_l3_test_time 0.15085730399999875
Test Epoch12 layer4 Acc 0.8728947368421053, AUC 0.961627185344696, avg_entr 0.02164478972554207, f1 0.8728947639465332
ep12_l4_test_time 0.16824961499997926
gc 0
Train Epoch13 Acc 0.9786083333333333 (117433/120000), AUC 0.9941350221633911
ep13_train_time 16.46987870600003
Test Epoch13 layer0 Acc 0.8513157894736842, AUC 0.9542298316955566, avg_entr 0.032670699059963226, f1 0.8513157963752747
ep13_l0_test_time 0.11634586200000285
Test Epoch13 layer1 Acc 0.8621052631578947, AUC 0.9606819152832031, avg_entr 0.022831067442893982, f1 0.8621052503585815
ep13_l1_test_time 0.12001579799999718
Test Epoch13 layer2 Acc 0.8639473684210527, AUC 0.960787296295166, avg_entr 0.020713411271572113, f1 0.8639474511146545
ep13_l2_test_time 0.13554474399995797
Test Epoch13 layer3 Acc 0.8642105263157894, AUC 0.9605874419212341, avg_entr 0.020231030881404877, f1 0.8642105460166931
ep13_l3_test_time 0.15027735800003938
Test Epoch13 layer4 Acc 0.8647368421052631, AUC 0.9600474238395691, avg_entr 0.01983160711824894, f1 0.8647368550300598
ep13_l4_test_time 0.17033756199998606
gc 0
Train Epoch14 Acc 0.9811083333333334 (117733/120000), AUC 0.9944043159484863
ep14_train_time 16.762479959000018
Test Epoch14 layer0 Acc 0.8510526315789474, AUC 0.9532533884048462, avg_entr 0.03245294466614723, f1 0.8510526418685913
ep14_l0_test_time 0.11545443300002489
Test Epoch14 layer1 Acc 0.8660526315789474, AUC 0.9585416316986084, avg_entr 0.019851189106702805, f1 0.8660526275634766
ep14_l1_test_time 0.121789716999956
Test Epoch14 layer2 Acc 0.8676315789473684, AUC 0.9589270353317261, avg_entr 0.017339348793029785, f1 0.8676315546035767
ep14_l2_test_time 0.1331186529999968
Test Epoch14 layer3 Acc 0.8663157894736843, AUC 0.9562504887580872, avg_entr 0.01599821448326111, f1 0.8663158416748047
ep14_l3_test_time 0.15183388299999478
Test Epoch14 layer4 Acc 0.8668421052631579, AUC 0.9555069208145142, avg_entr 0.014871031977236271, f1 0.8668420910835266
ep14_l4_test_time 0.17064569499996196
gc 0
Train Epoch15 Acc 0.9828166666666667 (117938/120000), AUC 0.9946385622024536
ep15_train_time 16.42608589300005
Test Epoch15 layer0 Acc 0.8521052631578947, AUC 0.9502686262130737, avg_entr 0.029560351744294167, f1 0.8521052598953247
ep15_l0_test_time 0.1166848589999745
Test Epoch15 layer1 Acc 0.863421052631579, AUC 0.9542233943939209, avg_entr 0.019451014697551727, f1 0.8634210228919983
ep15_l1_test_time 0.1200627489999988
Test Epoch15 layer2 Acc 0.8628947368421053, AUC 0.9557883739471436, avg_entr 0.015336202457547188, f1 0.8628947138786316
ep15_l2_test_time 0.1322139419999644
Test Epoch15 layer3 Acc 0.8636842105263158, AUC 0.9520806074142456, avg_entr 0.01504520233720541, f1 0.8636842370033264
ep15_l3_test_time 0.1490151630000014
Test Epoch15 layer4 Acc 0.863421052631579, AUC 0.9520543217658997, avg_entr 0.01418259460479021, f1 0.8634210228919983
ep15_l4_test_time 0.17064093000004732
gc 0
Train Epoch16 Acc 0.9834416666666667 (118013/120000), AUC 0.9946342706680298
ep16_train_time 16.593064879999986
Test Epoch16 layer0 Acc 0.853421052631579, AUC 0.9500468373298645, avg_entr 0.028813408687710762, f1 0.8534210324287415
ep16_l0_test_time 0.1438538239999616
Test Epoch16 layer1 Acc 0.8631578947368421, AUC 0.9547374248504639, avg_entr 0.014584789983928204, f1 0.8631578683853149
ep16_l1_test_time 0.14771056399996496
Test Epoch16 layer2 Acc 0.8647368421052631, AUC 0.9569967985153198, avg_entr 0.013209112919867039, f1 0.8647368550300598
ep16_l2_test_time 0.16120857200002092
Test Epoch16 layer3 Acc 0.865, AUC 0.9569908976554871, avg_entr 0.012351694516837597, f1 0.8650000095367432
ep16_l3_test_time 0.17433593900000233
Test Epoch16 layer4 Acc 0.8644736842105263, AUC 0.9559181928634644, avg_entr 0.012195125222206116, f1 0.8644736409187317
ep16_l4_test_time 0.19318171399999073
gc 0
Train Epoch17 Acc 0.9844666666666667 (118136/120000), AUC 0.994844913482666
ep17_train_time 17.104039118000003
Test Epoch17 layer0 Acc 0.8528947368421053, AUC 0.9514830708503723, avg_entr 0.02823612093925476, f1 0.8528947234153748
ep17_l0_test_time 0.11463770699998577
Test Epoch17 layer1 Acc 0.865, AUC 0.9524084329605103, avg_entr 0.015556497499346733, f1 0.8650000095367432
ep17_l1_test_time 0.12101780700004383
Test Epoch17 layer2 Acc 0.865, AUC 0.9555818438529968, avg_entr 0.013382034376263618, f1 0.8650000095367432
ep17_l2_test_time 0.13340776900002993
Test Epoch17 layer3 Acc 0.865, AUC 0.9529527425765991, avg_entr 0.012186034582555294, f1 0.8650000095367432
ep17_l3_test_time 0.1539248930000099
Test Epoch17 layer4 Acc 0.865, AUC 0.9539721012115479, avg_entr 0.011029550805687904, f1 0.8650000095367432
ep17_l4_test_time 0.17023440500003062
gc 0
Train Epoch18 Acc 0.985525 (118263/120000), AUC 0.9950961470603943
ep18_train_time 16.469011667000018
Test Epoch18 layer0 Acc 0.8513157894736842, AUC 0.949667751789093, avg_entr 0.02732953242957592, f1 0.8513157963752747
ep18_l0_test_time 0.1184854580000092
Test Epoch18 layer1 Acc 0.8610526315789474, AUC 0.9512805342674255, avg_entr 0.012910351157188416, f1 0.8610526323318481
ep18_l1_test_time 0.12110028899996905
Test Epoch18 layer2 Acc 0.8626315789473684, AUC 0.9542264938354492, avg_entr 0.012246472761034966, f1 0.862631618976593
ep18_l2_test_time 0.13080908500000987
Test Epoch18 layer3 Acc 0.8631578947368421, AUC 0.9534237384796143, avg_entr 0.011546904221177101, f1 0.8631578683853149
ep18_l3_test_time 0.14880322999999862
Test Epoch18 layer4 Acc 0.8631578947368421, AUC 0.9535409212112427, avg_entr 0.01124847587198019, f1 0.8631578683853149
ep18_l4_test_time 0.17187176499999168
gc 0
Train Epoch19 Acc 0.9856833333333334 (118282/120000), AUC 0.9948281645774841
ep19_train_time 16.623943749999967
Test Epoch19 layer0 Acc 0.8502631578947368, AUC 0.9475630521774292, avg_entr 0.027337711304426193, f1 0.8502631783485413
ep19_l0_test_time 0.11767151899999817
Test Epoch19 layer1 Acc 0.8623684210526316, AUC 0.9469261169433594, avg_entr 0.012180611491203308, f1 0.8623684048652649
ep19_l1_test_time 0.12358367000001635
Test Epoch19 layer2 Acc 0.8655263157894737, AUC 0.9484342336654663, avg_entr 0.01018791738897562, f1 0.8655263185501099
ep19_l2_test_time 0.13046572600001127
Test Epoch19 layer3 Acc 0.8647368421052631, AUC 0.947557806968689, avg_entr 0.009997314773499966, f1 0.8647368550300598
ep19_l3_test_time 0.1495359639999947
Test Epoch19 layer4 Acc 0.8644736842105263, AUC 0.947610080242157, avg_entr 0.009551366791129112, f1 0.8644736409187317
ep19_l4_test_time 0.17103292500002
Best AUC tensor(0.8758) 11 2
train_as_loss [[4.61255313e+02 3.57137699e+02 3.51215831e+02 3.49902252e+02
  3.49404481e+02 3.49164834e+02 3.49032596e+02 3.48952935e+02
  3.48901963e+02 3.48867911e+02 3.48849097e+02 3.48838369e+02
  3.48828664e+02 3.48820103e+02 3.48814352e+02 3.48810593e+02
  3.48806853e+02 3.48803235e+02 3.48800621e+02 3.48798812e+02]
 [2.19242107e+00 2.42191963e-05 1.80111544e-06 3.62189460e-07
  1.08102341e-07 3.99232351e-08 1.46561964e-06 9.79708368e-06
  5.89128027e-05 1.52928745e-04 2.48440477e-04 9.37194793e-07
  1.03426385e-09 9.60273014e-10 9.56521722e-05 1.57227609e-07
  4.39985970e-10 4.67499726e-10 2.22140420e-05 5.66260828e-08]
 [1.84639823e+00 1.50219543e-05 1.20437193e-06 2.66681150e-07
  9.03983363e-08 3.80564437e-08 1.51712651e-06 1.49091932e-05
  1.27720263e-04 8.64932990e-05 1.56109906e-04 5.80120021e-06
  2.64580461e-09 2.40341750e-09 6.49211716e-05 9.89822258e-07
  1.48324025e-09 1.17350516e-09 1.60058643e-05 2.32688586e-07]
 [2.15070135e+00 1.61353909e-05 1.43961490e-06 3.95587858e-07
  1.59479151e-07 8.10088104e-08 1.47833935e-06 1.66214963e-05
  2.08654987e-04 8.15307650e-05 1.48238023e-04 2.25615546e-05
  1.34866390e-08 7.50862895e-09 6.78240438e-05 4.64644605e-06
  1.04882673e-08 3.89371547e-09 1.70022447e-05 9.97111505e-07]
 [1.93947272e+00 1.68023249e-05 1.76935702e-06 6.61035519e-07
  3.48106918e-07 2.25917537e-07 2.08657255e-06 2.54920871e-05
  3.98970806e-04 8.13910830e-05 1.42292723e-04 7.14119793e-05
  7.50063657e-08 2.90868692e-08 7.63423569e-05 1.52104970e-05
  6.85437388e-08 1.69967952e-08 1.92296154e-05 2.78031804e-06]]
train_ae_loss [[10.88304741 11.38919025 10.43431338  9.65396393  9.08005155  8.37967925
   7.87887855  7.29245983  6.85239296  6.41326623  5.19066293  4.77946869
   4.54003691  4.36655152  3.81967922  3.63396694  3.5518874   3.45074608
   3.25426994  3.17681921]
 [11.37936795 10.58074543  9.41712784  8.53345275  7.90287922  7.16044861
   6.61383074  5.98300042  5.46270942  4.97383675  3.97424737  3.35830065
   3.09248315  2.91154406  2.49793893  2.22819039  2.13267094  2.0551568
   1.89308793  1.77296611]
 [12.50313528 10.57961583  8.99400756  8.01484823  7.33534924  6.58340418
   6.04023329  5.42157327  4.92284855  4.39411105  3.51532892  2.98179748
   2.7340236   2.54777943  2.17895717  1.93950795  1.85982611  1.76312629
   1.62725012  1.52180335]
 [12.12226229 11.36931075  8.46439349  7.42674415  6.71859965  5.96513806
   5.42371868  4.82887987  4.3559488   3.8384807   3.05157886  2.56633569
   2.33985239  2.15928576  1.82926451  1.6191568   1.54512745  1.45507464
   1.34128101  1.24988514]
 [11.5759531  11.95855465  7.92593201  6.84120571  6.11323385  5.37850797
   4.86588166  4.30038971  3.86424578  3.37364479  2.67475422  2.24005568
   2.03381687  1.86969023  1.5756133   1.39246379  1.32572878  1.24650083
   1.14676438  1.06637646]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 355.178458609
Start Testing
Load ckpt at ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt
gc 10
Test layer0 Acc 0.8539473684210527, AUC 0.953879177570343, avg_entr 0.042582008987665176, f1 0.8539473414421082
l0_test_time 0.10276631799996494
gc 0
Test layer1 Acc 0.868421052631579, AUC 0.9648644328117371, avg_entr 0.028444739058613777, f1 0.8684210777282715
l1_test_time 0.12145359600003758
gc 0
Test layer2 Acc 0.8707894736842106, AUC 0.9618226885795593, avg_entr 0.024021349847316742, f1 0.8707894682884216
l2_test_time 0.13720049099998732
gc 0
Test layer3 Acc 0.8744736842105263, AUC 0.9622634649276733, avg_entr 0.02249443717300892, f1 0.8744736909866333
l3_test_time 0.14896012600001995
gc 0
Test layer4 Acc 0.8744736842105263, AUC 0.9615758061408997, avg_entr 0.021438566967844963, f1 0.8744736909866333
l4_test_time 0.17398768499998596
gc 0
Test threshold 0.1 Acc 0.8657894736842106, AUC 0.9560648202896118, avg_entr 0.012785578146576881, f1 0.8657894730567932
t0.1_test_time 0.20141659500001197
gc 0
Test threshold 0.2 Acc 0.8639473684210527, AUC 0.9546337127685547, avg_entr 0.01512944046407938, f1 0.8639474511146545
t0.2_test_time 0.19708841400000665
gc 0
Test threshold 0.3 Acc 0.8610526315789474, AUC 0.9545564651489258, avg_entr 0.019258493557572365, f1 0.8610526323318481
t0.3_test_time 0.18718703700000106
gc 0
Test threshold 0.4 Acc 0.8557894736842105, AUC 0.9540878534317017, avg_entr 0.025613870471715927, f1 0.8557894825935364
t0.4_test_time 0.15344793599996365
gc 0
Test threshold 0.5 Acc 0.8544736842105263, AUC 0.9538576602935791, avg_entr 0.02952173352241516, f1 0.8544737100601196
t0.5_test_time 0.15419797699996707
gc 0
Test threshold 0.6 Acc 0.8539473684210527, AUC 0.953879177570343, avg_entr 0.03071642480790615, f1 0.8539473414421082
t0.6_test_time 0.13439211799999384
gc 0
Test threshold 0.7 Acc 0.8539473684210527, AUC 0.953879177570343, avg_entr 0.03071642480790615, f1 0.8539473414421082
t0.7_test_time 0.13728346799996416
gc 0
Test threshold 0.8 Acc 0.8539473684210527, AUC 0.953879177570343, avg_entr 0.03071642480790615, f1 0.8539473414421082
t0.8_test_time 0.14030932499997562
gc 0
Test threshold 0.9 Acc 0.8539473684210527, AUC 0.953879177570343, avg_entr 0.03071642480790615, f1 0.8539473414421082
t0.9_test_time 0.13944206799999392
