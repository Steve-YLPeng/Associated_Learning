total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 48937892
init_time 38.622774553999996
Start Training
gc 0
Train Epoch0 Acc 0.2533916666666667 (30407/120000), AUC 0.5019124150276184
ep0_train_time 17.253217041999996
Test Epoch0 layer0 Acc 0.7147368421052631, AUC 0.9034310579299927, avg_entr 0.8261463046073914, f1 0.714736819267273
ep0_l0_test_time 0.11837954199999956
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7452631578947368, AUC 0.9191874861717224, avg_entr 0.741472601890564, f1 0.7452631592750549
ep0_l1_test_time 0.12466944100000177
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.6439473684210526, AUC 0.8632528185844421, avg_entr 0.8871691226959229, f1 0.6439473628997803
ep0_l2_test_time 0.13404553599999502
Test Epoch0 layer3 Acc 0.2481578947368421, AUC 0.7276415228843689, avg_entr 1.232320785522461, f1 0.24815788865089417
ep0_l3_test_time 0.149892408999996
Test Epoch0 layer4 Acc 0.24789473684210525, AUC 0.5037528872489929, avg_entr 1.230458378791809, f1 0.24789473414421082
ep0_l4_test_time 0.16606214299999777
gc 0
Train Epoch1 Acc 0.6078166666666667 (72938/120000), AUC 0.849449634552002
ep1_train_time 16.605451058999996
Test Epoch1 layer0 Acc 0.8226315789473684, AUC 0.9516174793243408, avg_entr 0.3737887144088745, f1 0.8226315975189209
ep1_l0_test_time 0.11632011500000772
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8378947368421052, AUC 0.9588012099266052, avg_entr 0.30525216460227966, f1 0.8378947377204895
ep1_l1_test_time 0.14600772800000072
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8378947368421052, AUC 0.9564177989959717, avg_entr 0.2945857048034668, f1 0.8378947377204895
ep1_l2_test_time 0.1411073090000059
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer3 Acc 0.8376315789473684, AUC 0.955117404460907, avg_entr 0.294959157705307, f1 0.8376315832138062
ep1_l3_test_time 0.15080429200000367
Test Epoch1 layer4 Acc 0.8368421052631579, AUC 0.9509239792823792, avg_entr 0.2818640470504761, f1 0.8368421196937561
ep1_l4_test_time 0.17732344499999897
gc 0
Train Epoch2 Acc 0.872325 (104679/120000), AUC 0.9606134295463562
ep2_train_time 16.95510550200001
Test Epoch2 layer0 Acc 0.8405263157894737, AUC 0.959646999835968, avg_entr 0.2219027727842331, f1 0.8405263423919678
ep2_l0_test_time 0.11581630199999893
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.855, AUC 0.9661588668823242, avg_entr 0.17402957379817963, f1 0.8550000190734863
ep2_l1_test_time 0.12401222399999767
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8581578947368421, AUC 0.9648858308792114, avg_entr 0.1647908091545105, f1 0.8581578731536865
ep2_l2_test_time 0.1600894910000079
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8568421052631578, AUC 0.9625289440155029, avg_entr 0.16317711770534515, f1 0.8568421006202698
ep2_l3_test_time 0.17677551199999186
Test Epoch2 layer4 Acc 0.8571052631578947, AUC 0.9580481648445129, avg_entr 0.1564636081457138, f1 0.8571051955223083
ep2_l4_test_time 0.1743578100000036
gc 0
Train Epoch3 Acc 0.8976666666666666 (107720/120000), AUC 0.971813440322876
ep3_train_time 16.429934962000004
Test Epoch3 layer0 Acc 0.8576315789473684, AUC 0.9630539417266846, avg_entr 0.16024179756641388, f1 0.8576316237449646
ep3_l0_test_time 0.10955375999999717
Test Epoch3 layer1 Acc 0.8726315789473684, AUC 0.9679403305053711, avg_entr 0.11818462610244751, f1 0.8726315498352051
ep3_l1_test_time 0.11999681700000053
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8710526315789474, AUC 0.9671357274055481, avg_entr 0.10951489955186844, f1 0.871052622795105
ep3_l2_test_time 0.13027219599999285
Test Epoch3 layer3 Acc 0.8689473684210526, AUC 0.9671074748039246, avg_entr 0.11004691570997238, f1 0.8689473867416382
ep3_l3_test_time 0.14828342799999916
Test Epoch3 layer4 Acc 0.8697368421052631, AUC 0.9647168517112732, avg_entr 0.10722208023071289, f1 0.8697368502616882
ep3_l4_test_time 0.17308952299998737
gc 0
Train Epoch4 Acc 0.9157333333333333 (109888/120000), AUC 0.977756142616272
ep4_train_time 17.23327266999999
Test Epoch4 layer0 Acc 0.8507894736842105, AUC 0.9633437991142273, avg_entr 0.12427174299955368, f1 0.850789487361908
ep4_l0_test_time 0.11883892899999182
Test Epoch4 layer1 Acc 0.8692105263157894, AUC 0.969951331615448, avg_entr 0.09100370854139328, f1 0.8692105412483215
ep4_l1_test_time 0.11970039700000257
Test Epoch4 layer2 Acc 0.8739473684210526, AUC 0.9684549570083618, avg_entr 0.07822394371032715, f1 0.8739473819732666
ep4_l2_test_time 0.13206206000000975
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 4
Test Epoch4 layer3 Acc 0.8731578947368421, AUC 0.967007040977478, avg_entr 0.07749750465154648, f1 0.8731579184532166
ep4_l3_test_time 0.14815670000001546
Test Epoch4 layer4 Acc 0.8728947368421053, AUC 0.9635791182518005, avg_entr 0.07281993329524994, f1 0.8728947639465332
ep4_l4_test_time 0.16917527800001153
gc 0
Train Epoch5 Acc 0.9278416666666667 (111341/120000), AUC 0.982122004032135
ep5_train_time 16.33945282800002
Test Epoch5 layer0 Acc 0.8507894736842105, AUC 0.9625754356384277, avg_entr 0.09520421177148819, f1 0.850789487361908
ep5_l0_test_time 0.11398026199998412
Test Epoch5 layer1 Acc 0.868421052631579, AUC 0.9714077115058899, avg_entr 0.07842955738306046, f1 0.8684210777282715
ep5_l1_test_time 0.12689909700000612
Test Epoch5 layer2 Acc 0.868421052631579, AUC 0.9701933860778809, avg_entr 0.07370177656412125, f1 0.8684210777282715
ep5_l2_test_time 0.13413003599998774
Test Epoch5 layer3 Acc 0.8681578947368421, AUC 0.968267560005188, avg_entr 0.06939134746789932, f1 0.8681579232215881
ep5_l3_test_time 0.14625006599999324
Test Epoch5 layer4 Acc 0.8692105263157894, AUC 0.9658382534980774, avg_entr 0.06624232977628708, f1 0.8692105412483215
ep5_l4_test_time 0.16915133899999546
gc 0
Train Epoch6 Acc 0.9379916666666667 (112559/120000), AUC 0.9846965670585632
ep6_train_time 16.719090250999983
Test Epoch6 layer0 Acc 0.8539473684210527, AUC 0.962594747543335, avg_entr 0.07860288769006729, f1 0.8539473414421082
ep6_l0_test_time 0.11233697099999063
Test Epoch6 layer1 Acc 0.8723684210526316, AUC 0.9714255928993225, avg_entr 0.05665586143732071, f1 0.8723683953285217
ep6_l1_test_time 0.1212843140000075
Test Epoch6 layer2 Acc 0.8726315789473684, AUC 0.9698811769485474, avg_entr 0.04991481453180313, f1 0.8726315498352051
ep6_l2_test_time 0.13632039300000542
Test Epoch6 layer3 Acc 0.8731578947368421, AUC 0.968645453453064, avg_entr 0.04788336530327797, f1 0.8731579184532166
ep6_l3_test_time 0.1439657080000245
Test Epoch6 layer4 Acc 0.8736842105263158, AUC 0.9672203063964844, avg_entr 0.045620374381542206, f1 0.8736842274665833
ep6_l4_test_time 0.16930593300000396
gc 0
Train Epoch7 Acc 0.9476583333333334 (113719/120000), AUC 0.9873174428939819
ep7_train_time 16.824722237999993
Test Epoch7 layer0 Acc 0.8505263157894737, AUC 0.9603989124298096, avg_entr 0.06541090458631516, f1 0.8505263328552246
ep7_l0_test_time 0.11595172999997772
Test Epoch7 layer1 Acc 0.8718421052631579, AUC 0.9684699773788452, avg_entr 0.05169856920838356, f1 0.8718421459197998
ep7_l1_test_time 0.12040796799999498
Test Epoch7 layer2 Acc 0.8723684210526316, AUC 0.9673124551773071, avg_entr 0.048656415194272995, f1 0.8723683953285217
ep7_l2_test_time 0.1287750549999771
Test Epoch7 layer3 Acc 0.8713157894736843, AUC 0.965752124786377, avg_entr 0.04756663367152214, f1 0.8713157176971436
ep7_l3_test_time 0.1511692690000075
Test Epoch7 layer4 Acc 0.8718421052631579, AUC 0.9650963544845581, avg_entr 0.04696797952055931, f1 0.8718421459197998
ep7_l4_test_time 0.16911582400001635
gc 0
Train Epoch8 Acc 0.9548416666666667 (114581/120000), AUC 0.988835871219635
ep8_train_time 16.937089559000015
Test Epoch8 layer0 Acc 0.8523684210526316, AUC 0.9600266218185425, avg_entr 0.05923722684383392, f1 0.8523684144020081
ep8_l0_test_time 0.12149241499997743
Test Epoch8 layer1 Acc 0.8673684210526316, AUC 0.9683152437210083, avg_entr 0.04449359327554703, f1 0.8673684000968933
ep8_l1_test_time 0.1217881090000219
Test Epoch8 layer2 Acc 0.87, AUC 0.9674448370933533, avg_entr 0.04067292809486389, f1 0.8700000047683716
ep8_l2_test_time 0.13241994899999554
Test Epoch8 layer3 Acc 0.8694736842105263, AUC 0.9641038179397583, avg_entr 0.040232207626104355, f1 0.8694736957550049
ep8_l3_test_time 0.15050901199998634
Test Epoch8 layer4 Acc 0.8702631578947368, AUC 0.9631569385528564, avg_entr 0.040878668427467346, f1 0.8702631592750549
ep8_l4_test_time 0.16872657999999774
gc 0
Train Epoch9 Acc 0.9628083333333334 (115537/120000), AUC 0.9901841878890991
ep9_train_time 16.556551861999992
Test Epoch9 layer0 Acc 0.8578947368421053, AUC 0.9611088037490845, avg_entr 0.0475744791328907, f1 0.8578947186470032
ep9_l0_test_time 0.11186933099997987
Test Epoch9 layer1 Acc 0.8744736842105263, AUC 0.9648104906082153, avg_entr 0.03187042102217674, f1 0.8744736909866333
ep9_l1_test_time 0.12623688299999003
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer2 Acc 0.8744736842105263, AUC 0.9645688533782959, avg_entr 0.031112533062696457, f1 0.8744736909866333
ep9_l2_test_time 0.1318037289999836
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer3 Acc 0.8747368421052631, AUC 0.9627729654312134, avg_entr 0.029776401817798615, f1 0.8747368454933167
ep9_l3_test_time 0.14739139499999965
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 9
Test Epoch9 layer4 Acc 0.8752631578947369, AUC 0.9617902040481567, avg_entr 0.027450168505311012, f1 0.8752631545066833
ep9_l4_test_time 0.1731190859999856
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.96935 (116322/120000), AUC 0.9926115870475769
ep10_train_time 17.00672900699999
Test Epoch10 layer0 Acc 0.8568421052631578, AUC 0.9585386514663696, avg_entr 0.046191874891519547, f1 0.8568421006202698
ep10_l0_test_time 0.14147110599998314
Test Epoch10 layer1 Acc 0.8763157894736842, AUC 0.966694176197052, avg_entr 0.03140299394726753, f1 0.8763157725334167
ep10_l1_test_time 0.1477990420000026
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer2 Acc 0.8773684210526316, AUC 0.9665663242340088, avg_entr 0.03006329946219921, f1 0.8773684501647949
ep10_l2_test_time 0.1584049870000115
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 10
Test Epoch10 layer3 Acc 0.8768421052631579, AUC 0.9639306664466858, avg_entr 0.028084905818104744, f1 0.8768420815467834
ep10_l3_test_time 0.1735031549999917
Test Epoch10 layer4 Acc 0.8771052631578947, AUC 0.9642886519432068, avg_entr 0.026369009166955948, f1 0.8771052360534668
ep10_l4_test_time 0.1939203320000047
gc 0
Train Epoch11 Acc 0.9729833333333333 (116758/120000), AUC 0.9935204982757568
ep11_train_time 17.11478452199998
Test Epoch11 layer0 Acc 0.8528947368421053, AUC 0.954810619354248, avg_entr 0.0432114452123642, f1 0.8528947234153748
ep11_l0_test_time 0.11514830299995538
Test Epoch11 layer1 Acc 0.8707894736842106, AUC 0.960396409034729, avg_entr 0.031217001378536224, f1 0.8707894682884216
ep11_l1_test_time 0.11893366600003219
Test Epoch11 layer2 Acc 0.8697368421052631, AUC 0.9619269371032715, avg_entr 0.026616215705871582, f1 0.8697368502616882
ep11_l2_test_time 0.12856611799998063
Test Epoch11 layer3 Acc 0.8694736842105263, AUC 0.9607747793197632, avg_entr 0.026714572682976723, f1 0.8694736957550049
ep11_l3_test_time 0.14970548399998052
Test Epoch11 layer4 Acc 0.8694736842105263, AUC 0.9600212574005127, avg_entr 0.025550201535224915, f1 0.8694736957550049
ep11_l4_test_time 0.1677064449999648
gc 0
Train Epoch12 Acc 0.9747166666666667 (116966/120000), AUC 0.9939144253730774
ep12_train_time 16.48231121699996
Test Epoch12 layer0 Acc 0.8539473684210527, AUC 0.9537973999977112, avg_entr 0.04131602868437767, f1 0.8539473414421082
ep12_l0_test_time 0.1152180050000311
Test Epoch12 layer1 Acc 0.868421052631579, AUC 0.9612424373626709, avg_entr 0.029128290712833405, f1 0.8684210777282715
ep12_l1_test_time 0.12517500500001688
Test Epoch12 layer2 Acc 0.8713157894736843, AUC 0.9628470540046692, avg_entr 0.024714075028896332, f1 0.8713157176971436
ep12_l2_test_time 0.13341024900000775
Test Epoch12 layer3 Acc 0.8721052631578947, AUC 0.9621756672859192, avg_entr 0.023880572989583015, f1 0.8721052408218384
ep12_l3_test_time 0.1469384229999946
Test Epoch12 layer4 Acc 0.8713157894736843, AUC 0.9621639251708984, avg_entr 0.023893563076853752, f1 0.8713157176971436
ep12_l4_test_time 0.16944983899998078
gc 0
Train Epoch13 Acc 0.9783 (117396/120000), AUC 0.994478702545166
ep13_train_time 16.62409761600003
Test Epoch13 layer0 Acc 0.8513157894736842, AUC 0.9533289670944214, avg_entr 0.03818168491125107, f1 0.8513157963752747
ep13_l0_test_time 0.11544565799999873
Test Epoch13 layer1 Acc 0.8668421052631579, AUC 0.9589800238609314, avg_entr 0.02071142941713333, f1 0.8668420910835266
ep13_l1_test_time 0.11445501999997987
Test Epoch13 layer2 Acc 0.8668421052631579, AUC 0.9602733254432678, avg_entr 0.017509102821350098, f1 0.8668420910835266
ep13_l2_test_time 0.13447446899999704
Test Epoch13 layer3 Acc 0.8671052631578947, AUC 0.9575865864753723, avg_entr 0.01703093945980072, f1 0.86710524559021
ep13_l3_test_time 0.1489443069999652
Test Epoch13 layer4 Acc 0.8676315789473684, AUC 0.9563790559768677, avg_entr 0.01585257798433304, f1 0.8676315546035767
ep13_l4_test_time 0.17229078599996228
gc 0
Train Epoch14 Acc 0.98055 (117666/120000), AUC 0.9951159358024597
ep14_train_time 16.613813247999985
Test Epoch14 layer0 Acc 0.8518421052631578, AUC 0.9505748748779297, avg_entr 0.03380950167775154, f1 0.8518421053886414
ep14_l0_test_time 0.11035324499999888
Test Epoch14 layer1 Acc 0.8694736842105263, AUC 0.9573252201080322, avg_entr 0.020275965332984924, f1 0.8694736957550049
ep14_l1_test_time 0.12453909499998872
Test Epoch14 layer2 Acc 0.8718421052631579, AUC 0.9599912166595459, avg_entr 0.015119057148694992, f1 0.8718421459197998
ep14_l2_test_time 0.13257465999998885
Test Epoch14 layer3 Acc 0.8718421052631579, AUC 0.9584479331970215, avg_entr 0.015628986060619354, f1 0.8718421459197998
ep14_l3_test_time 0.15020171500003698
Test Epoch14 layer4 Acc 0.8721052631578947, AUC 0.9565416574478149, avg_entr 0.014768438413739204, f1 0.8721052408218384
ep14_l4_test_time 0.168679185999963
gc 0
Train Epoch15 Acc 0.9819916666666667 (117839/120000), AUC 0.9952453374862671
ep15_train_time 16.46040782299997
Test Epoch15 layer0 Acc 0.8523684210526316, AUC 0.9500021934509277, avg_entr 0.0319179892539978, f1 0.8523684144020081
ep15_l0_test_time 0.11507221699997672
Test Epoch15 layer1 Acc 0.8694736842105263, AUC 0.9567313194274902, avg_entr 0.018919523805379868, f1 0.8694736957550049
ep15_l1_test_time 0.12002475200000617
Test Epoch15 layer2 Acc 0.8689473684210526, AUC 0.9595764875411987, avg_entr 0.014937249012291431, f1 0.8689473867416382
ep15_l2_test_time 0.13352573999998185
Test Epoch15 layer3 Acc 0.87, AUC 0.9582725167274475, avg_entr 0.014904187992215157, f1 0.8700000047683716
ep15_l3_test_time 0.14797212899998158
Test Epoch15 layer4 Acc 0.8705263157894737, AUC 0.9590557813644409, avg_entr 0.0150346290320158, f1 0.8705263137817383
ep15_l4_test_time 0.17190326600001526
gc 0
Train Epoch16 Acc 0.9833666666666666 (118004/120000), AUC 0.9955095648765564
ep16_train_time 16.509131845000013
Test Epoch16 layer0 Acc 0.8468421052631578, AUC 0.9471819400787354, avg_entr 0.02984003908932209, f1 0.8468421101570129
ep16_l0_test_time 0.11354409000000487
Test Epoch16 layer1 Acc 0.8642105263157894, AUC 0.9536929726600647, avg_entr 0.0185796357691288, f1 0.8642105460166931
ep16_l1_test_time 0.12101285199997847
Test Epoch16 layer2 Acc 0.8647368421052631, AUC 0.9554639458656311, avg_entr 0.014797244220972061, f1 0.8647368550300598
ep16_l2_test_time 0.13104914999996709
Test Epoch16 layer3 Acc 0.8644736842105263, AUC 0.954490602016449, avg_entr 0.013676673173904419, f1 0.8644736409187317
ep16_l3_test_time 0.14954240700001264
Test Epoch16 layer4 Acc 0.8639473684210527, AUC 0.9561324715614319, avg_entr 0.013721760362386703, f1 0.8639474511146545
ep16_l4_test_time 0.17095106300001817
gc 0
Train Epoch17 Acc 0.9841333333333333 (118096/120000), AUC 0.9959337711334229
ep17_train_time 16.481267787000036
Test Epoch17 layer0 Acc 0.8502631578947368, AUC 0.9480833411216736, avg_entr 0.029004206880927086, f1 0.8502631783485413
ep17_l0_test_time 0.11261901100004934
Test Epoch17 layer1 Acc 0.8652631578947368, AUC 0.9551990628242493, avg_entr 0.01875298283994198, f1 0.8652631640434265
ep17_l1_test_time 0.12301283099998273
Test Epoch17 layer2 Acc 0.8689473684210526, AUC 0.9562391042709351, avg_entr 0.01354221161454916, f1 0.8689473867416382
ep17_l2_test_time 0.13375187900004448
Test Epoch17 layer3 Acc 0.8692105263157894, AUC 0.9548135995864868, avg_entr 0.013168532401323318, f1 0.8692105412483215
ep17_l3_test_time 0.1539903989999516
Test Epoch17 layer4 Acc 0.8689473684210526, AUC 0.9555521011352539, avg_entr 0.013112790882587433, f1 0.8689473867416382
ep17_l4_test_time 0.18624410299997862
gc 0
Train Epoch18 Acc 0.9851083333333334 (118213/120000), AUC 0.9960571527481079
ep18_train_time 17.255749046999995
Test Epoch18 layer0 Acc 0.848421052631579, AUC 0.9455103278160095, avg_entr 0.027352789416909218, f1 0.848421037197113
ep18_l0_test_time 0.12008554999999888
Test Epoch18 layer1 Acc 0.8657894736842106, AUC 0.9499810934066772, avg_entr 0.015381315723061562, f1 0.8657894730567932
ep18_l1_test_time 0.12683280100003458
Test Epoch18 layer2 Acc 0.8668421052631579, AUC 0.9515530467033386, avg_entr 0.012164657935500145, f1 0.8668420910835266
ep18_l2_test_time 0.13877021100000775
Test Epoch18 layer3 Acc 0.866578947368421, AUC 0.9515804052352905, avg_entr 0.011066561564803123, f1 0.8665789365768433
ep18_l3_test_time 0.15437864599999784
Test Epoch18 layer4 Acc 0.8671052631578947, AUC 0.9530357718467712, avg_entr 0.011233595199882984, f1 0.86710524559021
ep18_l4_test_time 0.1760211819999995
gc 0
Train Epoch19 Acc 0.9855166666666667 (118262/120000), AUC 0.9961320161819458
ep19_train_time 16.406298429000003
Test Epoch19 layer0 Acc 0.8478947368421053, AUC 0.945577085018158, avg_entr 0.025928646326065063, f1 0.8478947281837463
ep19_l0_test_time 0.11667097100001911
Test Epoch19 layer1 Acc 0.8631578947368421, AUC 0.95298832654953, avg_entr 0.016436219215393066, f1 0.8631578683853149
ep19_l1_test_time 0.12075569399996766
Test Epoch19 layer2 Acc 0.8642105263157894, AUC 0.9523981809616089, avg_entr 0.010867307893931866, f1 0.8642105460166931
ep19_l2_test_time 0.12686774899998454
Test Epoch19 layer3 Acc 0.8647368421052631, AUC 0.9529802203178406, avg_entr 0.010089465416967869, f1 0.8647368550300598
ep19_l3_test_time 0.15223156099995094
Test Epoch19 layer4 Acc 0.8644736842105263, AUC 0.9534645676612854, avg_entr 0.010216174647212029, f1 0.8644736409187317
ep19_l4_test_time 0.16972151599998142
Best AUC tensor(0.8774) 10 2
train_as_loss [[4.51143604e+02 3.56449483e+02 3.51069836e+02 3.49845787e+02
  3.49376467e+02 3.49148932e+02 3.49022765e+02 3.48946502e+02
  3.48897581e+02 3.48871272e+02 3.48856528e+02 3.48843343e+02
  3.48831847e+02 3.48824196e+02 3.48819222e+02 3.48814303e+02
  3.48809571e+02 3.48806166e+02 3.48803816e+02 3.48801386e+02]
 [2.39097165e+00 2.25512719e-05 1.73776271e-06 3.57547945e-07
  1.09099234e-07 4.18095198e-08 1.84170148e-08 3.98287401e-06
  7.44179570e-05 9.65977234e-05 8.90100380e-07 1.57107243e-09
  1.25940103e-09 4.06648228e-05 4.39617346e-07 5.79578130e-10
  6.02876818e-09 1.83942507e-05 4.69586042e-08 3.15294603e-10]
 [2.02957036e+00 1.66647338e-05 1.23728531e-06 2.61747229e-07
  8.52131903e-08 3.77036032e-08 1.95572973e-08 3.52542690e-06
  1.28040397e-04 2.10007224e-04 7.29373408e-06 2.57067494e-09
  2.93351189e-09 9.48622642e-05 1.38690178e-06 1.20924193e-09
  1.04331107e-08 4.83909693e-05 7.42298509e-08 8.05698262e-10]
 [2.05165635e+00 2.27391674e-05 1.88719822e-06 4.40327843e-07
  1.65838855e-07 8.62338242e-08 5.76167835e-08 3.88597348e-06
  2.08077753e-04 3.83751107e-04 6.99552970e-05 1.02856995e-08
  1.46457133e-08 1.64465707e-04 1.61735132e-05 4.86924351e-09
  1.61284261e-08 7.76441625e-05 6.52403903e-07 3.02997618e-09]
 [1.91938746e+00 1.58271006e-05 1.52746513e-06 5.40098023e-07
  3.03293014e-07 2.22138015e-07 2.10485042e-07 4.09747024e-06
  3.87262460e-04 6.53927506e-04 5.05479119e-04 4.01194603e-08
  6.12460077e-08 2.17314363e-04 1.26726607e-04 1.94329079e-08
  4.04417151e-08 9.95690647e-05 4.50200307e-06 1.26571346e-08]]
train_ae_loss [[11.53158164 11.61459596 10.55639077  9.85888806  9.2145628   8.60116889
   8.1071765   7.52397106  7.12962051  5.81384782  5.37179712  5.09487815
   4.84961619  4.26701363  4.04307229  3.93996122  3.85233131  3.60192158
   3.51598801  3.48256229]
 [11.72467064 10.04839083  8.68950312  7.91409957  7.25666106  6.65186131
   6.15098935  5.52566303  5.11003079  4.16499838  3.52672311  3.22284894
   3.0042045   2.59508697  2.28327484  2.17447474  2.07940309  1.91852336
   1.77269554  1.74030892]
 [12.05662015  9.89550043  8.11446866  7.28196967  6.60457793  6.02013316
   5.52340293  4.92403131  4.5281499   3.68666566  3.06936079  2.79768601
   2.58822142  2.22636212  1.93234425  1.83037428  1.73788083  1.5875763
   1.45267405  1.41661558]
 [12.55428532 11.77798715  7.88522272  6.96615463  6.24410265  5.63586336
   5.13087822  4.54328923  4.15847238  3.36205727  2.78859858  2.49695489
   2.29996497  1.96976018  1.70397213  1.59998484  1.51244802  1.37656637
   1.2533712   1.21477169]
 [11.2544889  13.67324097  7.12830165  6.19548187  5.50334944  4.94000348
   4.47839587  3.9454088   3.6016092   2.90395091  2.39459369  2.13460508
   1.96421395  1.67874192  1.44913669  1.35583359  1.27917096  1.16151676
   1.05861473  1.02346517]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 356.402552755
Start Testing
Load ckpt at ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt
gc 10
Test layer0 Acc 0.8507894736842105, AUC 0.955413281917572, avg_entr 0.04561354219913483, f1 0.850789487361908
l0_test_time 0.11279539499997782
gc 0
Test layer1 Acc 0.871578947368421, AUC 0.96440589427948, avg_entr 0.03231387585401535, f1 0.8715789318084717
l1_test_time 0.12144001399997251
gc 0
Test layer2 Acc 0.871578947368421, AUC 0.9653292298316956, avg_entr 0.030495092272758484, f1 0.8715789318084717
l2_test_time 0.1292043059999628
gc 0
Test layer3 Acc 0.8755263157894737, AUC 0.9630740880966187, avg_entr 0.028610005974769592, f1 0.8755263090133667
l3_test_time 0.14690705600003184
gc 0
Test layer4 Acc 0.8757894736842106, AUC 0.9634316563606262, avg_entr 0.026052040979266167, f1 0.87578946352005
l4_test_time 0.1742127059999916
gc 0
Test threshold 0.1 Acc 0.8639473684210527, AUC 0.9559136033058167, avg_entr 0.015274196863174438, f1 0.8639474511146545
t0.1_test_time 0.2007361089999904
gc 0
Test threshold 0.2 Acc 0.8623684210526316, AUC 0.9558521509170532, avg_entr 0.01695374771952629, f1 0.8623684048652649
t0.2_test_time 0.19449092799999335
gc 0
Test threshold 0.3 Acc 0.8573684210526316, AUC 0.9557344913482666, avg_entr 0.02053479291498661, f1 0.8573684096336365
t0.3_test_time 0.19548000399998955
gc 0
Test threshold 0.4 Acc 0.8544736842105263, AUC 0.9556478261947632, avg_entr 0.027155345305800438, f1 0.8544737100601196
t0.4_test_time 0.15820120199998655
gc 0
Test threshold 0.5 Acc 0.8510526315789474, AUC 0.9554963111877441, avg_entr 0.031924448907375336, f1 0.8510526418685913
t0.5_test_time 0.15245351599998003
gc 0
Test threshold 0.6 Acc 0.8507894736842105, AUC 0.955413281917572, avg_entr 0.032903216779232025, f1 0.850789487361908
t0.6_test_time 0.1293756990000361
gc 0
Test threshold 0.7 Acc 0.8507894736842105, AUC 0.955413281917572, avg_entr 0.032903216779232025, f1 0.850789487361908
t0.7_test_time 0.1307011080000393
gc 0
Test threshold 0.8 Acc 0.8507894736842105, AUC 0.955413281917572, avg_entr 0.032903216779232025, f1 0.850789487361908
t0.8_test_time 0.1340954849999889
gc 0
Test threshold 0.9 Acc 0.8507894736842105, AUC 0.955413281917572, avg_entr 0.032903216779232025, f1 0.850789487361908
t0.9_test_time 0.13504767800003492
