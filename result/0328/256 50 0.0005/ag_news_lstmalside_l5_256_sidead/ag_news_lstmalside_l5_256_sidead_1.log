total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMALsideText(
  (layers): ModuleList(
    (0): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight_ih_l0 360000
layers.0.enc.f.weight_hh_l0 360000
layers.0.enc.f.bias_ih_l0 1200
layers.0.enc.f.bias_hh_l0 1200
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 360000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 360000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 360000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 48937892
init_time 41.668074012000005
Start Training
gc 0
Train Epoch0 Acc 0.25476666666666664 (30572/120000), AUC 0.5013415217399597
ep0_train_time 16.740712422
Test Epoch0 layer0 Acc 0.7347368421052631, AUC 0.9109933376312256, avg_entr 0.839920699596405, f1 0.7347368597984314
ep0_l0_test_time 0.11679903699999983
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7539473684210526, AUC 0.9223830103874207, avg_entr 0.7659729719161987, f1 0.7539473176002502
ep0_l1_test_time 0.11933957600000156
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.7436842105263158, AUC 0.9118074178695679, avg_entr 0.7816272974014282, f1 0.7436842322349548
ep0_l2_test_time 0.1337258809999966
Test Epoch0 layer3 Acc 0.4218421052631579, AUC 0.8089506030082703, avg_entr 1.0869300365447998, f1 0.421842098236084
ep0_l3_test_time 0.1513723650000003
Test Epoch0 layer4 Acc 0.25, AUC 0.3940717577934265, avg_entr 1.2425256967544556, f1 0.25
ep0_l4_test_time 0.17118640700000043
gc 0
Train Epoch1 Acc 0.6665083333333334 (79981/120000), AUC 0.8800439834594727
ep1_train_time 17.273610042999998
Test Epoch1 layer0 Acc 0.8223684210526315, AUC 0.9529109597206116, avg_entr 0.3790893852710724, f1 0.8223684430122375
ep1_l0_test_time 0.116799596000007
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.84, AUC 0.9601622223854065, avg_entr 0.3048281669616699, f1 0.8399999737739563
ep1_l1_test_time 0.12321613200001025
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.84, AUC 0.957553505897522, avg_entr 0.286652147769928, f1 0.8399999737739563
ep1_l2_test_time 0.1378334639999963
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 1
Test Epoch1 layer3 Acc 0.8365789473684211, AUC 0.954596221446991, avg_entr 0.28871503472328186, f1 0.8365789651870728
ep1_l3_test_time 0.15166545000001008
Test Epoch1 layer4 Acc 0.8344736842105264, AUC 0.9522151947021484, avg_entr 0.28745362162590027, f1 0.8344736695289612
ep1_l4_test_time 0.17818758800000012
gc 0
Train Epoch2 Acc 0.8741 (104892/120000), AUC 0.9621726274490356
ep2_train_time 16.615489347999997
Test Epoch2 layer0 Acc 0.838421052631579, AUC 0.9618412256240845, avg_entr 0.21718741953372955, f1 0.8384209871292114
ep2_l0_test_time 0.11355741299999522
Test Epoch2 layer1 Acc 0.8607894736842105, AUC 0.967875599861145, avg_entr 0.16413818299770355, f1 0.8607894778251648
ep2_l1_test_time 0.12133862700000009
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8576315789473684, AUC 0.9634552001953125, avg_entr 0.14899590611457825, f1 0.8576316237449646
ep2_l2_test_time 0.13328116499999965
Test Epoch2 layer3 Acc 0.8568421052631578, AUC 0.9582620859146118, avg_entr 0.1445757895708084, f1 0.8568421006202698
ep2_l3_test_time 0.15067261900000517
Test Epoch2 layer4 Acc 0.8513157894736842, AUC 0.9565557837486267, avg_entr 0.14340318739414215, f1 0.8513157963752747
ep2_l4_test_time 0.1753307339999992
gc 0
Train Epoch3 Acc 0.9011083333333333 (108133/120000), AUC 0.9725886583328247
ep3_train_time 16.566285465000007
Test Epoch3 layer0 Acc 0.8557894736842105, AUC 0.9632858037948608, avg_entr 0.1518918126821518, f1 0.8557894825935364
ep3_l0_test_time 0.12013975099999641
Test Epoch3 layer1 Acc 0.8726315789473684, AUC 0.9713279604911804, avg_entr 0.11663535237312317, f1 0.8726315498352051
ep3_l1_test_time 0.12041029999998898
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8723684210526316, AUC 0.9690777063369751, avg_entr 0.10418178141117096, f1 0.8723683953285217
ep3_l2_test_time 0.13821551099999851
Test Epoch3 layer3 Acc 0.87, AUC 0.966813862323761, avg_entr 0.09956883639097214, f1 0.8700000047683716
ep3_l3_test_time 0.14966867299999365
Test Epoch3 layer4 Acc 0.8705263157894737, AUC 0.9649320840835571, avg_entr 0.09663413465023041, f1 0.8705263137817383
ep3_l4_test_time 0.17062013999999692
gc 0
Train Epoch4 Acc 0.91735 (110082/120000), AUC 0.9783715009689331
ep4_train_time 16.657313437000013
Test Epoch4 layer0 Acc 0.8531578947368421, AUC 0.9644529819488525, avg_entr 0.11859995871782303, f1 0.8531579375267029
ep4_l0_test_time 0.12156073799999945
Test Epoch4 layer1 Acc 0.8705263157894737, AUC 0.9708013534545898, avg_entr 0.09501804411411285, f1 0.8705263137817383
ep4_l1_test_time 0.1319567199999767
Test Epoch4 layer2 Acc 0.8707894736842106, AUC 0.9694327712059021, avg_entr 0.09385039657354355, f1 0.8707894682884216
ep4_l2_test_time 0.14212291000001187
Test Epoch4 layer3 Acc 0.8663157894736843, AUC 0.9674151539802551, avg_entr 0.09790515154600143, f1 0.8663158416748047
ep4_l3_test_time 0.1569468019999931
Test Epoch4 layer4 Acc 0.866578947368421, AUC 0.9658786058425903, avg_entr 0.094459667801857, f1 0.8665789365768433
ep4_l4_test_time 0.1776221869999972
gc 0
Train Epoch5 Acc 0.9303583333333333 (111643/120000), AUC 0.9821210503578186
ep5_train_time 16.526168796999997
Test Epoch5 layer0 Acc 0.8563157894736843, AUC 0.9643696546554565, avg_entr 0.0972551479935646, f1 0.8563157916069031
ep5_l0_test_time 0.11148854399999664
Test Epoch5 layer1 Acc 0.8802631578947369, AUC 0.970404326915741, avg_entr 0.07521367073059082, f1 0.880263090133667
ep5_l1_test_time 0.1270010940000077
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.8776315789473684, AUC 0.9698272347450256, avg_entr 0.07197743654251099, f1 0.8776316046714783
ep5_l2_test_time 0.1356924829999855
Test Epoch5 layer3 Acc 0.8786842105263157, AUC 0.9686475992202759, avg_entr 0.07104632258415222, f1 0.8786842226982117
ep5_l3_test_time 0.15075382599999898
Test Epoch5 layer4 Acc 0.876578947368421, AUC 0.9683796167373657, avg_entr 0.0678102970123291, f1 0.8765789270401001
ep5_l4_test_time 0.1730668689999959
gc 0
Train Epoch6 Acc 0.9406416666666667 (112877/120000), AUC 0.9851885437965393
ep6_train_time 16.41680450199999
Test Epoch6 layer0 Acc 0.8642105263157894, AUC 0.9643055200576782, avg_entr 0.07456846535205841, f1 0.8642105460166931
ep6_l0_test_time 0.11455964800001084
Test Epoch6 layer1 Acc 0.8821052631578947, AUC 0.9711020588874817, avg_entr 0.056525569409132004, f1 0.88210529088974
ep6_l1_test_time 0.12667621499997495
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 6
Test Epoch6 layer2 Acc 0.8794736842105263, AUC 0.969581127166748, avg_entr 0.05478619784116745, f1 0.8794736862182617
ep6_l2_test_time 0.13698538700000995
Test Epoch6 layer3 Acc 0.88, AUC 0.9698717594146729, avg_entr 0.053371574729681015, f1 0.8799999952316284
ep6_l3_test_time 0.15295788299999913
Test Epoch6 layer4 Acc 0.88, AUC 0.9691652655601501, avg_entr 0.050145357847213745, f1 0.8799999952316284
ep6_l4_test_time 0.1721129090000204
gc 0
Train Epoch7 Acc 0.9499333333333333 (113992/120000), AUC 0.9872353076934814
ep7_train_time 17.384806822
Test Epoch7 layer0 Acc 0.8618421052631579, AUC 0.9629256725311279, avg_entr 0.06249089911580086, f1 0.8618420958518982
ep7_l0_test_time 0.1242616099999907
Test Epoch7 layer1 Acc 0.8768421052631579, AUC 0.970652163028717, avg_entr 0.047635890543460846, f1 0.8768420815467834
ep7_l1_test_time 0.12759207199999878
Test Epoch7 layer2 Acc 0.88, AUC 0.9697142243385315, avg_entr 0.042475223541259766, f1 0.8799999952316284
ep7_l2_test_time 0.14178133799998704
Test Epoch7 layer3 Acc 0.8797368421052632, AUC 0.9668976068496704, avg_entr 0.041922677308321, f1 0.8797368407249451
ep7_l3_test_time 0.15490833300000872
Test Epoch7 layer4 Acc 0.8794736842105263, AUC 0.9650986790657043, avg_entr 0.03998934477567673, f1 0.8794736862182617
ep7_l4_test_time 0.1781661169999893
gc 0
Train Epoch8 Acc 0.9580666666666666 (114968/120000), AUC 0.9890563488006592
ep8_train_time 16.48482287599998
Test Epoch8 layer0 Acc 0.8597368421052631, AUC 0.9616313576698303, avg_entr 0.05455636605620384, f1 0.8597368597984314
ep8_l0_test_time 0.11643512700001679
Test Epoch8 layer1 Acc 0.8810526315789474, AUC 0.9697584509849548, avg_entr 0.04279503971338272, f1 0.8810526132583618
ep8_l1_test_time 0.12457704499999522
Test Epoch8 layer2 Acc 0.8821052631578947, AUC 0.9672451019287109, avg_entr 0.03630834072828293, f1 0.88210529088974
ep8_l2_test_time 0.13446842100000822
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer3 Acc 0.883421052631579, AUC 0.9682963490486145, avg_entr 0.035482458770275116, f1 0.8834210634231567
ep8_l3_test_time 0.15156472699999313
Save ckpt to ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt  ,ep 8
Test Epoch8 layer4 Acc 0.8831578947368421, AUC 0.9678618311882019, avg_entr 0.03349355608224869, f1 0.8831579089164734
ep8_l4_test_time 0.17241978299998095
gc 0
Train Epoch9 Acc 0.96555 (115866/120000), AUC 0.9902335405349731
ep9_train_time 16.80521546999998
Test Epoch9 layer0 Acc 0.8610526315789474, AUC 0.9621124267578125, avg_entr 0.04890936613082886, f1 0.8610526323318481
ep9_l0_test_time 0.11634770100002356
Test Epoch9 layer1 Acc 0.8789473684210526, AUC 0.9685737490653992, avg_entr 0.03352294862270355, f1 0.878947377204895
ep9_l1_test_time 0.12251936599997748
Test Epoch9 layer2 Acc 0.8818421052631579, AUC 0.9690163731575012, avg_entr 0.028241096064448357, f1 0.8818420767784119
ep9_l2_test_time 0.1292581900000016
Test Epoch9 layer3 Acc 0.8807894736842106, AUC 0.9648328423500061, avg_entr 0.0269282516092062, f1 0.8807894587516785
ep9_l3_test_time 0.1498665619999997
Test Epoch9 layer4 Acc 0.8807894736842106, AUC 0.9627824425697327, avg_entr 0.02438454143702984, f1 0.8807894587516785
ep9_l4_test_time 0.1719449080000004
gc 0
Train Epoch10 Acc 0.9701083333333334 (116413/120000), AUC 0.9911289215087891
ep10_train_time 16.62108867699999
Test Epoch10 layer0 Acc 0.8623684210526316, AUC 0.9592645764350891, avg_entr 0.042441725730895996, f1 0.8623684048652649
ep10_l0_test_time 0.11679766099999256
Test Epoch10 layer1 Acc 0.8771052631578947, AUC 0.9654276371002197, avg_entr 0.02897205390036106, f1 0.8771052360534668
ep10_l1_test_time 0.12189664500002095
Test Epoch10 layer2 Acc 0.878421052631579, AUC 0.9649534225463867, avg_entr 0.025364620611071587, f1 0.8784210681915283
ep10_l2_test_time 0.1338910639999824
Test Epoch10 layer3 Acc 0.8773684210526316, AUC 0.9591116309165955, avg_entr 0.023534733802080154, f1 0.8773684501647949
ep10_l3_test_time 0.15130176700000675
Test Epoch10 layer4 Acc 0.8757894736842106, AUC 0.9577186703681946, avg_entr 0.022509369999170303, f1 0.87578946352005
ep10_l4_test_time 0.17135839400000918
gc 0
Train Epoch11 Acc 0.9733166666666667 (116798/120000), AUC 0.9921029806137085
ep11_train_time 17.308678895000014
Test Epoch11 layer0 Acc 0.8621052631578947, AUC 0.9569546580314636, avg_entr 0.039033740758895874, f1 0.8621052503585815
ep11_l0_test_time 0.11722995099995615
Test Epoch11 layer1 Acc 0.868421052631579, AUC 0.9654771685600281, avg_entr 0.02829682268202305, f1 0.8684210777282715
ep11_l1_test_time 0.122921276999989
Test Epoch11 layer2 Acc 0.87, AUC 0.9645626544952393, avg_entr 0.023624584078788757, f1 0.8700000047683716
ep11_l2_test_time 0.13717328699999598
Test Epoch11 layer3 Acc 0.8692105263157894, AUC 0.9637143611907959, avg_entr 0.023421935737133026, f1 0.8692105412483215
ep11_l3_test_time 0.15107176800000843
Test Epoch11 layer4 Acc 0.8681578947368421, AUC 0.9621028900146484, avg_entr 0.022961830720305443, f1 0.8681579232215881
ep11_l4_test_time 0.16884461399996553
gc 0
Train Epoch12 Acc 0.975225 (117027/120000), AUC 0.9927076101303101
ep12_train_time 16.60712774000001
Test Epoch12 layer0 Acc 0.858421052631579, AUC 0.9554831981658936, avg_entr 0.03640300780534744, f1 0.8584210276603699
ep12_l0_test_time 0.1163668199999961
Test Epoch12 layer1 Acc 0.8702631578947368, AUC 0.959769606590271, avg_entr 0.023737190291285515, f1 0.8702631592750549
ep12_l1_test_time 0.1223307690000297
Test Epoch12 layer2 Acc 0.8697368421052631, AUC 0.9593048691749573, avg_entr 0.020018260926008224, f1 0.8697368502616882
ep12_l2_test_time 0.13321445799999765
Test Epoch12 layer3 Acc 0.8707894736842106, AUC 0.9580832719802856, avg_entr 0.020042985677719116, f1 0.8707894682884216
ep12_l3_test_time 0.15103200900000502
Test Epoch12 layer4 Acc 0.8707894736842106, AUC 0.9574960470199585, avg_entr 0.0190870501101017, f1 0.8707894682884216
ep12_l4_test_time 0.17081391599998597
gc 0
Train Epoch13 Acc 0.9779083333333334 (117349/120000), AUC 0.9931579828262329
ep13_train_time 16.78635986400002
Test Epoch13 layer0 Acc 0.8547368421052631, AUC 0.954645037651062, avg_entr 0.033365700393915176, f1 0.854736864566803
ep13_l0_test_time 0.11896189399999457
Test Epoch13 layer1 Acc 0.8707894736842106, AUC 0.9605274200439453, avg_entr 0.021087050437927246, f1 0.8707894682884216
ep13_l1_test_time 0.12116704099997833
Test Epoch13 layer2 Acc 0.8726315789473684, AUC 0.9626623392105103, avg_entr 0.016899220645427704, f1 0.8726315498352051
ep13_l2_test_time 0.1347700569999688
Test Epoch13 layer3 Acc 0.8731578947368421, AUC 0.9609286785125732, avg_entr 0.016066789627075195, f1 0.8731579184532166
ep13_l3_test_time 0.14998613699998486
Test Epoch13 layer4 Acc 0.8731578947368421, AUC 0.9574770927429199, avg_entr 0.014753930270671844, f1 0.8731579184532166
ep13_l4_test_time 0.16610672999996723
gc 0
Train Epoch14 Acc 0.979125 (117495/120000), AUC 0.9934608340263367
ep14_train_time 17.433043241999997
Test Epoch14 layer0 Acc 0.858421052631579, AUC 0.9529056549072266, avg_entr 0.030250247567892075, f1 0.8584210276603699
ep14_l0_test_time 0.11505341800000224
Test Epoch14 layer1 Acc 0.8660526315789474, AUC 0.9558220505714417, avg_entr 0.015713827684521675, f1 0.8660526275634766
ep14_l1_test_time 0.12088501900001347
Test Epoch14 layer2 Acc 0.8705263157894737, AUC 0.956394612789154, avg_entr 0.014842505566775799, f1 0.8705263137817383
ep14_l2_test_time 0.13484829799995168
Test Epoch14 layer3 Acc 0.8702631578947368, AUC 0.9574655294418335, avg_entr 0.014483189210295677, f1 0.8702631592750549
ep14_l3_test_time 0.17662672700004123
Test Epoch14 layer4 Acc 0.8702631578947368, AUC 0.9532138109207153, avg_entr 0.013583523221313953, f1 0.8702631592750549
ep14_l4_test_time 0.1921697510000513
gc 0
Train Epoch15 Acc 0.9794333333333334 (117532/120000), AUC 0.993959903717041
ep15_train_time 17.23533458000003
Test Epoch15 layer0 Acc 0.8560526315789474, AUC 0.9513612985610962, avg_entr 0.030323296785354614, f1 0.8560526371002197
ep15_l0_test_time 0.1422915150000108
Test Epoch15 layer1 Acc 0.8697368421052631, AUC 0.9552803039550781, avg_entr 0.01738698221743107, f1 0.8697368502616882
ep15_l1_test_time 0.14932488300001978
Test Epoch15 layer2 Acc 0.8726315789473684, AUC 0.9551042318344116, avg_entr 0.013715538196265697, f1 0.8726315498352051
ep15_l2_test_time 0.16348970600000712
Test Epoch15 layer3 Acc 0.871578947368421, AUC 0.9563084244728088, avg_entr 0.01243895385414362, f1 0.8715789318084717
ep15_l3_test_time 0.1711648890000106
Test Epoch15 layer4 Acc 0.871578947368421, AUC 0.9565446972846985, avg_entr 0.011428998783230782, f1 0.8715789318084717
ep15_l4_test_time 0.19572411899997633
gc 0
Train Epoch16 Acc 0.979975 (117597/120000), AUC 0.9942080974578857
ep16_train_time 16.700613482999984
Test Epoch16 layer0 Acc 0.8552631578947368, AUC 0.949558675289154, avg_entr 0.028133736923336983, f1 0.8552631735801697
ep16_l0_test_time 0.09349349600000778
Test Epoch16 layer1 Acc 0.866578947368421, AUC 0.9520648121833801, avg_entr 0.01342830155044794, f1 0.8665789365768433
ep16_l1_test_time 0.12475901199996997
Test Epoch16 layer2 Acc 0.868421052631579, AUC 0.9522318840026855, avg_entr 0.01138070784509182, f1 0.8684210777282715
ep16_l2_test_time 0.1358709560000193
Test Epoch16 layer3 Acc 0.8671052631578947, AUC 0.9522262811660767, avg_entr 0.010490138083696365, f1 0.86710524559021
ep16_l3_test_time 0.15176377500000626
Test Epoch16 layer4 Acc 0.8673684210526316, AUC 0.9514374732971191, avg_entr 0.009655500762164593, f1 0.8673684000968933
ep16_l4_test_time 0.17603851699999495
gc 0
Train Epoch17 Acc 0.9802666666666666 (117632/120000), AUC 0.9944102168083191
ep17_train_time 16.698959899999977
Test Epoch17 layer0 Acc 0.8544736842105263, AUC 0.949619710445404, avg_entr 0.027010759338736534, f1 0.8544737100601196
ep17_l0_test_time 0.11776317300001438
Test Epoch17 layer1 Acc 0.8631578947368421, AUC 0.9511116743087769, avg_entr 0.01457617711275816, f1 0.8631578683853149
ep17_l1_test_time 0.12261041599998634
Test Epoch17 layer2 Acc 0.8636842105263158, AUC 0.9493175745010376, avg_entr 0.011155152693390846, f1 0.8636842370033264
ep17_l2_test_time 0.13558331399997314
Test Epoch17 layer3 Acc 0.8636842105263158, AUC 0.9509915709495544, avg_entr 0.011040101759135723, f1 0.8636842370033264
ep17_l3_test_time 0.15150855600001023
Test Epoch17 layer4 Acc 0.8639473684210527, AUC 0.9491971731185913, avg_entr 0.009875043295323849, f1 0.8639474511146545
ep17_l4_test_time 0.17247674599997254
gc 0
Train Epoch18 Acc 0.9806166666666667 (117674/120000), AUC 0.9945273399353027
ep18_train_time 16.607621902000005
Test Epoch18 layer0 Acc 0.8513157894736842, AUC 0.9476314783096313, avg_entr 0.02555437944829464, f1 0.8513157963752747
ep18_l0_test_time 0.1146219590000328
Test Epoch18 layer1 Acc 0.8626315789473684, AUC 0.949917733669281, avg_entr 0.013879941776394844, f1 0.862631618976593
ep18_l1_test_time 0.12492641700004015
Test Epoch18 layer2 Acc 0.8618421052631579, AUC 0.9511418342590332, avg_entr 0.009876062162220478, f1 0.8618420958518982
ep18_l2_test_time 0.13624839300001668
Test Epoch18 layer3 Acc 0.8626315789473684, AUC 0.9512693881988525, avg_entr 0.009060786105692387, f1 0.862631618976593
ep18_l3_test_time 0.15111196399999471
Test Epoch18 layer4 Acc 0.8626315789473684, AUC 0.948036789894104, avg_entr 0.009023316204547882, f1 0.862631618976593
ep18_l4_test_time 0.16852838799997016
gc 0
Train Epoch19 Acc 0.9803333333333333 (117640/120000), AUC 0.9948292970657349
ep19_train_time 16.552143134000005
Test Epoch19 layer0 Acc 0.8515789473684211, AUC 0.9450592994689941, avg_entr 0.02345646359026432, f1 0.851578950881958
ep19_l0_test_time 0.11621886599999698
Test Epoch19 layer1 Acc 0.8610526315789474, AUC 0.9463278651237488, avg_entr 0.011128567159175873, f1 0.8610526323318481
ep19_l1_test_time 0.12375316200001407
Test Epoch19 layer2 Acc 0.861578947368421, AUC 0.9451364278793335, avg_entr 0.008964642882347107, f1 0.8615789413452148
ep19_l2_test_time 0.13588592500002505
Test Epoch19 layer3 Acc 0.8610526315789474, AUC 0.9490700364112854, avg_entr 0.008708049543201923, f1 0.8610526323318481
ep19_l3_test_time 0.1536896310000202
Test Epoch19 layer4 Acc 0.8613157894736843, AUC 0.9496862292289734, avg_entr 0.008184101432561874, f1 0.8613157868385315
ep19_l4_test_time 0.17111478300000726
Best AUC tensor(0.8834) 8 3
train_as_loss [[4.51476831e+02 3.56256524e+02 3.50991668e+02 3.49803596e+02
  3.49350583e+02 3.49131880e+02 3.49011027e+02 3.48938167e+02
  3.48891541e+02 3.48866512e+02 3.48852497e+02 3.48839982e+02
  3.48829080e+02 3.48821822e+02 3.48817122e+02 3.48812460e+02
  3.48807978e+02 3.48804757e+02 3.48802535e+02 3.48800246e+02]
 [1.46248649e+00 9.04016295e-06 6.24660742e-07 1.22831654e-07
  3.68891141e-08 1.39627701e-08 5.01506763e-07 3.14084193e-05
  3.60180213e-07 1.42114044e-09 9.31465718e-06 2.96088682e-05
  2.14642281e-08 4.47510005e-10 1.03460137e-09 1.89166844e-05
  2.01837299e-07 2.45724729e-10 2.11970593e-10 6.78530766e-06]
 [1.45647269e+00 9.64438930e-06 7.12422917e-07 1.53287885e-07
  5.07885064e-08 2.16881788e-08 3.26130890e-07 5.16941722e-05
  3.01714887e-06 9.97258031e-05 1.12067524e-05 4.36259049e-05
  2.14747479e-07 3.77179262e-05 1.08855551e-07 2.41865730e-05
  3.00142445e-06 9.02451493e-06 6.27999344e-07 9.91861784e-06]
 [1.38886210e+00 1.02485780e-05 8.82495669e-07 2.31826591e-07
  9.76441399e-08 5.23284020e-08 4.10744920e-07 7.78452458e-05
  2.76951685e-05 2.38493299e-04 9.28439040e-05 7.69572661e-05
  1.16650671e-06 6.72778698e-05 1.82793799e-06 3.04645483e-05
  2.35710806e-05 1.60576024e-05 8.69873600e-06 1.16778505e-05]
 [1.59970247e+00 1.57147069e-05 1.59340491e-06 4.99771122e-07
  2.34443717e-07 1.54185474e-07 5.79266748e-07 1.05142886e-04
  8.21104902e-05 4.22922198e-04 2.24077437e-04 1.54346926e-04
  2.40215395e-06 8.43148959e-05 8.83989707e-06 3.37658221e-05
  6.80078789e-05 1.84934121e-05 5.60552064e-05 1.00633749e-05]]
train_ae_loss [[11.1815307  11.61773013 10.64346509  9.82784501  9.16857638  8.5749861
   7.98910912  7.45830799  6.9505215   5.65371602  5.20532025  4.93340268
   4.77723068  4.14966261  3.95652294  3.84472047  3.75447278  3.53616477
   3.44296649  3.4009885 ]
 [10.4784885   9.17118115  8.21750997  7.48812111  6.88725482  6.31998705
   5.80008734  5.23085018  4.59329428  3.73516044  3.32714233  3.08886694
   2.83515237  2.43225093  2.29701123  2.1656154   2.03521887  1.89622095
   1.83129818  1.77634765]
 [10.29173156  8.11478165  7.08098718  6.35859123  5.78209559  5.26717908
   4.78695406  4.29742235  3.76666251  3.04901917  2.663904    2.47428319
   2.25887654  1.92422226  1.79245366  1.68224907  1.57606278  1.46490347
   1.39360747  1.34587393]
 [10.24160436  8.4637937   6.80756329  6.05013392  5.47395341  4.96519032
   4.48638537  4.00768724  3.50087955  2.81422264  2.46583852  2.24846885
   2.04334406  1.72121     1.61105451  1.4927816   1.39652358  1.29333134
   1.23020704  1.18219663]
 [ 9.1131981  10.08820882  6.07292295  5.33667206  4.80748237  4.33763935
   3.89632252  3.46483207  3.01645078  2.42295054  2.11025241  1.9155794
   1.73681714  1.45659773  1.36352144  1.25932386  1.17448003  1.08361457
   1.02964568  0.98885584]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 355.740807766
Start Testing
Load ckpt at ckpt/ag_news_lstmalside_l5_256_sidead//ag_news_lstmalside_l5_side.pt
gc 10
Test layer0 Acc 0.8444736842105263, AUC 0.9545455574989319, avg_entr 0.060340091586112976, f1 0.844473659992218
l0_test_time 0.11477454799995712
gc 0
Test layer1 Acc 0.866578947368421, AUC 0.965979814529419, avg_entr 0.0469093844294548, f1 0.8665789365768433
l1_test_time 0.12611125799998035
gc 0
Test layer2 Acc 0.8697368421052631, AUC 0.9631152153015137, avg_entr 0.041652873158454895, f1 0.8697368502616882
l2_test_time 0.1318502710000189
gc 0
Test layer3 Acc 0.8710526315789474, AUC 0.9633219242095947, avg_entr 0.04200075566768646, f1 0.871052622795105
l3_test_time 0.1500476730000173
gc 0
Test layer4 Acc 0.8731578947368421, AUC 0.9643411636352539, avg_entr 0.03988910838961601, f1 0.8731579184532166
l4_test_time 0.17651880099998607
gc 0
Test threshold 0.1 Acc 0.8642105263157894, AUC 0.9564670920372009, avg_entr 0.024477653205394745, f1 0.8642105460166931
t0.1_test_time 0.2133764170000063
gc 0
Test threshold 0.2 Acc 0.8586842105263158, AUC 0.9556673765182495, avg_entr 0.025672107934951782, f1 0.8586841821670532
t0.2_test_time 0.20545693799999754
gc 0
Test threshold 0.3 Acc 0.8531578947368421, AUC 0.9551923871040344, avg_entr 0.029098138213157654, f1 0.8531579375267029
t0.3_test_time 0.19165921900003013
gc 0
Test threshold 0.4 Acc 0.8476315789473684, AUC 0.9548376202583313, avg_entr 0.03595801070332527, f1 0.847631573677063
t0.4_test_time 0.17002757199998086
gc 0
Test threshold 0.5 Acc 0.845, AUC 0.9546759128570557, avg_entr 0.04137187451124191, f1 0.8449999690055847
t0.5_test_time 0.1536302869999986
gc 0
Test threshold 0.6 Acc 0.8444736842105263, AUC 0.9545455574989319, avg_entr 0.043526168912649155, f1 0.844473659992218
t0.6_test_time 0.145395877999988
gc 0
Test threshold 0.7 Acc 0.8444736842105263, AUC 0.9545455574989319, avg_entr 0.043526168912649155, f1 0.844473659992218
t0.7_test_time 0.14340626199998496
gc 0
Test threshold 0.8 Acc 0.8444736842105263, AUC 0.9545455574989319, avg_entr 0.043526168912649155, f1 0.844473659992218
t0.8_test_time 0.1347107880000067
gc 0
Test threshold 0.9 Acc 0.8444736842105263, AUC 0.9545455574989319, avg_entr 0.043526168912649155, f1 0.844473659992218
t0.9_test_time 0.14327275200002987
