total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearALsideText(
  (layers): ModuleList(
    (0): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.0.weight 90000
layers.0.enc.f.0.bias 300
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 45777392
init_time 25.292976660999997
Start Training
gc 0
Train Epoch0 Acc 0.27581666666666665 (33098/120000), AUC 0.5137288570404053
ep0_train_time 9.280542739999998
Test Epoch0 layer0 Acc 0.4094736842105263, AUC 0.6848225593566895, avg_entr 1.2051260471343994, f1 0.4094736874103546
ep0_l0_test_time 0.1116894749999986
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.39710526315789474, AUC 0.6549578309059143, avg_entr 1.2075759172439575, f1 0.39710527658462524
ep0_l1_test_time 0.1136526650000036
Test Epoch0 layer2 Acc 0.3439473684210526, AUC 0.6162723302841187, avg_entr 1.2026716470718384, f1 0.3439473807811737
ep0_l2_test_time 0.11456075899999973
Test Epoch0 layer3 Acc 0.31842105263157894, AUC 0.5808345079421997, avg_entr 1.2170629501342773, f1 0.31842106580734253
ep0_l3_test_time 0.11648846500000332
Test Epoch0 layer4 Acc 0.31842105263157894, AUC 0.5810455083847046, avg_entr 1.2171862125396729, f1 0.31842106580734253
ep0_l4_test_time 0.11504329800000335
gc 0
Train Epoch1 Acc 0.3353 (40236/120000), AUC 0.5868935585021973
ep1_train_time 8.468321615
Test Epoch1 layer0 Acc 0.48236842105263156, AUC 0.7363073825836182, avg_entr 0.8690517544746399, f1 0.4823684096336365
ep1_l0_test_time 0.10880772899999869
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.4573684210526316, AUC 0.7228719592094421, avg_entr 0.8744276762008667, f1 0.4573684334754944
ep1_l1_test_time 0.11798217300000147
Test Epoch1 layer2 Acc 0.41289473684210526, AUC 0.6814332008361816, avg_entr 0.8752179741859436, f1 0.41289472579956055
ep1_l2_test_time 0.11533700400000413
Test Epoch1 layer3 Acc 0.39342105263157895, AUC 0.6501762866973877, avg_entr 0.8957995176315308, f1 0.3934210240840912
ep1_l3_test_time 0.11614626600000122
Test Epoch1 layer4 Acc 0.38184210526315787, AUC 0.6392138004302979, avg_entr 0.8933677077293396, f1 0.38184210658073425
ep1_l4_test_time 0.1108362679999999
gc 0
Train Epoch2 Acc 0.39736666666666665 (47684/120000), AUC 0.6534041166305542
ep2_train_time 8.429936380999997
Test Epoch2 layer0 Acc 0.48789473684210527, AUC 0.7466447353363037, avg_entr 0.7056291699409485, f1 0.487894743680954
ep2_l0_test_time 0.10934857100000528
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.48368421052631577, AUC 0.7388124465942383, avg_entr 0.7157709002494812, f1 0.4836842119693756
ep2_l1_test_time 0.11420488099999915
Test Epoch2 layer2 Acc 0.45105263157894737, AUC 0.7088381052017212, avg_entr 0.7229931354522705, f1 0.45105263590812683
ep2_l2_test_time 0.1125556270000061
Test Epoch2 layer3 Acc 0.42394736842105263, AUC 0.6853777170181274, avg_entr 0.719413161277771, f1 0.42394736409187317
ep2_l3_test_time 0.11897351900000075
Test Epoch2 layer4 Acc 0.4060526315789474, AUC 0.6813784837722778, avg_entr 0.7226194739341736, f1 0.4060526192188263
ep2_l4_test_time 0.1200388729999986
gc 0
Train Epoch3 Acc 0.4276333333333333 (51316/120000), AUC 0.683103621006012
ep3_train_time 10.128090953999994
Test Epoch3 layer0 Acc 0.483421052631579, AUC 0.7491788864135742, avg_entr 0.6043003797531128, f1 0.48342105746269226
ep3_l0_test_time 0.11492900499999337
Test Epoch3 layer1 Acc 0.47368421052631576, AUC 0.7434483170509338, avg_entr 0.6228748559951782, f1 0.4736842215061188
ep3_l1_test_time 0.11561998900000958
Test Epoch3 layer2 Acc 0.4523684210526316, AUC 0.7182266712188721, avg_entr 0.6200046539306641, f1 0.4523683786392212
ep3_l2_test_time 0.12387666600000102
Test Epoch3 layer3 Acc 0.4355263157894737, AUC 0.6996386051177979, avg_entr 0.6202111840248108, f1 0.4355263113975525
ep3_l3_test_time 0.12034695399999862
Test Epoch3 layer4 Acc 0.41947368421052633, AUC 0.695955216884613, avg_entr 0.6213445663452148, f1 0.41947367787361145
ep3_l4_test_time 0.1305834789999949
gc 0
Train Epoch4 Acc 0.4434 (53208/120000), AUC 0.6974136829376221
ep4_train_time 8.339026348000004
Test Epoch4 layer0 Acc 0.5007894736842106, AUC 0.7508888840675354, avg_entr 0.5651534199714661, f1 0.50078946352005
ep4_l0_test_time 0.10781205600000021
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.4986842105263158, AUC 0.7464382648468018, avg_entr 0.5816221237182617, f1 0.49868419766426086
ep4_l1_test_time 0.11444332099999599
Test Epoch4 layer2 Acc 0.4792105263157895, AUC 0.7261995077133179, avg_entr 0.5783820152282715, f1 0.4792105257511139
ep4_l2_test_time 0.11290252199999884
Test Epoch4 layer3 Acc 0.4523684210526316, AUC 0.7084766626358032, avg_entr 0.5806176662445068, f1 0.4523683786392212
ep4_l3_test_time 0.11540648600001191
Test Epoch4 layer4 Acc 0.4478947368421053, AUC 0.7065891027450562, avg_entr 0.5548061728477478, f1 0.44789472222328186
ep4_l4_test_time 0.11736038399999416
gc 0
Train Epoch5 Acc 0.45166666666666666 (54200/120000), AUC 0.7036759853363037
ep5_train_time 8.219796701999996
Test Epoch5 layer0 Acc 0.4905263157894737, AUC 0.7518537640571594, avg_entr 0.5092371702194214, f1 0.49052631855010986
ep5_l0_test_time 0.1154734289999908
Test Epoch5 layer1 Acc 0.49605263157894736, AUC 0.748092532157898, avg_entr 0.523494303226471, f1 0.496052622795105
ep5_l1_test_time 0.11938715700000557
Test Epoch5 layer2 Acc 0.485, AUC 0.7291963696479797, avg_entr 0.5291546583175659, f1 0.48500001430511475
ep5_l2_test_time 0.12164353800000072
Test Epoch5 layer3 Acc 0.45710526315789474, AUC 0.7084605693817139, avg_entr 0.525625467300415, f1 0.45710524916648865
ep5_l3_test_time 0.12362552300000118
Test Epoch5 layer4 Acc 0.46289473684210525, AUC 0.7105305194854736, avg_entr 0.5185459852218628, f1 0.4628947675228119
ep5_l4_test_time 0.1254032849999902
gc 0
Train Epoch6 Acc 0.4565166666666667 (54782/120000), AUC 0.7080422639846802
ep6_train_time 8.962566209000002
Test Epoch6 layer0 Acc 0.508421052631579, AUC 0.7530341148376465, avg_entr 0.47334980964660645, f1 0.5084210634231567
ep6_l0_test_time 0.10986199200000613
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.49105263157894735, AUC 0.7495040893554688, avg_entr 0.4881162643432617, f1 0.49105262756347656
ep6_l1_test_time 0.11634885499999825
Test Epoch6 layer2 Acc 0.4792105263157895, AUC 0.730636715888977, avg_entr 0.49234721064567566, f1 0.4792105257511139
ep6_l2_test_time 0.11067243100001178
Test Epoch6 layer3 Acc 0.4573684210526316, AUC 0.7109915018081665, avg_entr 0.4885794222354889, f1 0.4573684334754944
ep6_l3_test_time 0.12071125599999277
Test Epoch6 layer4 Acc 0.45263157894736844, AUC 0.7098301649093628, avg_entr 0.4845408499240875, f1 0.4526315927505493
ep6_l4_test_time 0.11858610499999145
gc 0
Train Epoch7 Acc 0.46115833333333334 (55339/120000), AUC 0.7121968269348145
ep7_train_time 8.693570453000007
Test Epoch7 layer0 Acc 0.4971052631578947, AUC 0.7544640302658081, avg_entr 0.4495183229446411, f1 0.49710527062416077
ep7_l0_test_time 0.10697910300000046
Test Epoch7 layer1 Acc 0.5044736842105263, AUC 0.7504644393920898, avg_entr 0.46118780970573425, f1 0.5044736862182617
ep7_l1_test_time 0.11474372099999641
Test Epoch7 layer2 Acc 0.48236842105263156, AUC 0.7318082451820374, avg_entr 0.4623190462589264, f1 0.4823684096336365
ep7_l2_test_time 0.11475537800001234
Test Epoch7 layer3 Acc 0.46131578947368423, AUC 0.7087777256965637, avg_entr 0.4604496657848358, f1 0.461315780878067
ep7_l3_test_time 0.11932797499999026
Test Epoch7 layer4 Acc 0.4610526315789474, AUC 0.7134149074554443, avg_entr 0.44529932737350464, f1 0.46105262637138367
ep7_l4_test_time 0.12082273100000407
gc 0
Train Epoch8 Acc 0.4633 (55596/120000), AUC 0.7152990102767944
ep8_train_time 9.53049782699999
Test Epoch8 layer0 Acc 0.508421052631579, AUC 0.7552249431610107, avg_entr 0.42443081736564636, f1 0.5084210634231567
ep8_l0_test_time 0.11250497599999676
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 8
Test Epoch8 layer1 Acc 0.5036842105263157, AUC 0.7507743239402771, avg_entr 0.4359176456928253, f1 0.5036842226982117
ep8_l1_test_time 0.10993999499999063
Test Epoch8 layer2 Acc 0.48526315789473684, AUC 0.7329522967338562, avg_entr 0.4432878792285919, f1 0.4852631688117981
ep8_l2_test_time 0.11579586599999914
Test Epoch8 layer3 Acc 0.4594736842105263, AUC 0.7103339433670044, avg_entr 0.4371647238731384, f1 0.4594736397266388
ep8_l3_test_time 0.11768388400000163
Test Epoch8 layer4 Acc 0.4586842105263158, AUC 0.7090513110160828, avg_entr 0.41690224409103394, f1 0.45868417620658875
ep8_l4_test_time 0.11639031999999361
gc 0
Train Epoch9 Acc 0.46135 (55362/120000), AUC 0.7147545218467712
ep9_train_time 9.939872746999995
Test Epoch9 layer0 Acc 0.4994736842105263, AUC 0.756320595741272, avg_entr 0.3964393436908722, f1 0.4994736909866333
ep9_l0_test_time 0.1369068050000095
Test Epoch9 layer1 Acc 0.49736842105263157, AUC 0.7501157522201538, avg_entr 0.42235514521598816, f1 0.4973684251308441
ep9_l1_test_time 0.14073602400000595
Test Epoch9 layer2 Acc 0.4789473684210526, AUC 0.7299280762672424, avg_entr 0.41823631525039673, f1 0.47894737124443054
ep9_l2_test_time 0.14418247999999778
Test Epoch9 layer3 Acc 0.4610526315789474, AUC 0.7091280817985535, avg_entr 0.40357691049575806, f1 0.46105262637138367
ep9_l3_test_time 0.14718810400000848
Test Epoch9 layer4 Acc 0.4589473684210526, AUC 0.7115613222122192, avg_entr 0.3890407383441925, f1 0.4589473605155945
ep9_l4_test_time 0.15096078300000215
gc 0
Train Epoch10 Acc 0.459725 (55167/120000), AUC 0.7138354778289795
ep10_train_time 8.454975442999995
Test Epoch10 layer0 Acc 0.5026315789473684, AUC 0.7574864029884338, avg_entr 0.4027942419052124, f1 0.5026316046714783
ep10_l0_test_time 0.10906475499999146
Test Epoch10 layer1 Acc 0.49105263157894735, AUC 0.7490197420120239, avg_entr 0.4098682701587677, f1 0.49105262756347656
ep10_l1_test_time 0.1114272589999814
Test Epoch10 layer2 Acc 0.45763157894736844, AUC 0.7281100749969482, avg_entr 0.4176848530769348, f1 0.45763158798217773
ep10_l2_test_time 0.11280093799999236
Test Epoch10 layer3 Acc 0.4486842105263158, AUC 0.7103590965270996, avg_entr 0.39711669087409973, f1 0.4486842155456543
ep10_l3_test_time 0.11829525299998522
Test Epoch10 layer4 Acc 0.4423684210526316, AUC 0.710512101650238, avg_entr 0.37021854519844055, f1 0.44236841797828674
ep10_l4_test_time 0.11815391999999747
gc 0
Train Epoch11 Acc 0.46253333333333335 (55504/120000), AUC 0.7155585885047913
ep11_train_time 8.550989049999998
Test Epoch11 layer0 Acc 0.5123684210526316, AUC 0.7585920095443726, avg_entr 0.37122413516044617, f1 0.5123684406280518
ep11_l0_test_time 0.1137871380000206
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 11
Test Epoch11 layer1 Acc 0.5002631578947369, AUC 0.7502343654632568, avg_entr 0.38076332211494446, f1 0.5002631545066833
ep11_l1_test_time 0.11315292699998736
Test Epoch11 layer2 Acc 0.48605263157894735, AUC 0.7267913818359375, avg_entr 0.38210931420326233, f1 0.48605263233184814
ep11_l2_test_time 0.11899692800000139
Test Epoch11 layer3 Acc 0.4586842105263158, AUC 0.7099978923797607, avg_entr 0.36710721254348755, f1 0.45868417620658875
ep11_l3_test_time 0.11754819300000463
Test Epoch11 layer4 Acc 0.4610526315789474, AUC 0.7121261954307556, avg_entr 0.35182076692581177, f1 0.46105262637138367
ep11_l4_test_time 0.11963797600000703
gc 0
Train Epoch12 Acc 0.46324166666666666 (55589/120000), AUC 0.7175935506820679
ep12_train_time 9.490842826000005
Test Epoch12 layer0 Acc 0.5105263157894737, AUC 0.7591915130615234, avg_entr 0.34435907006263733, f1 0.5105262994766235
ep12_l0_test_time 0.11127621699998258
Test Epoch12 layer1 Acc 0.49973684210526315, AUC 0.7507593631744385, avg_entr 0.3581743538379669, f1 0.49973684549331665
ep12_l1_test_time 0.11481678000001239
Test Epoch12 layer2 Acc 0.4781578947368421, AUC 0.7292290925979614, avg_entr 0.37033066153526306, f1 0.4781579077243805
ep12_l2_test_time 0.1433976729999813
Test Epoch12 layer3 Acc 0.45026315789473687, AUC 0.707154393196106, avg_entr 0.35917139053344727, f1 0.4502631723880768
ep12_l3_test_time 0.1491591200000073
Test Epoch12 layer4 Acc 0.44894736842105265, AUC 0.7101292610168457, avg_entr 0.33706754446029663, f1 0.44894737005233765
ep12_l4_test_time 0.15003314099999443
gc 0
Train Epoch13 Acc 0.4643083333333333 (55717/120000), AUC 0.7179278135299683
ep13_train_time 8.762576303000003
Test Epoch13 layer0 Acc 0.5047368421052632, AUC 0.7605302333831787, avg_entr 0.3299998342990875, f1 0.5047368407249451
ep13_l0_test_time 0.10768565699999044
Test Epoch13 layer1 Acc 0.5013157894736842, AUC 0.7530303001403809, avg_entr 0.34280312061309814, f1 0.5013157725334167
ep13_l1_test_time 0.11398380800000041
Test Epoch13 layer2 Acc 0.48710526315789476, AUC 0.7307881116867065, avg_entr 0.35069239139556885, f1 0.48710522055625916
ep13_l2_test_time 0.11095517300000779
Test Epoch13 layer3 Acc 0.4586842105263158, AUC 0.7121814489364624, avg_entr 0.339585542678833, f1 0.45868417620658875
ep13_l3_test_time 0.11982272600002375
Test Epoch13 layer4 Acc 0.4626315789473684, AUC 0.7135751247406006, avg_entr 0.3135985732078552, f1 0.46263158321380615
ep13_l4_test_time 0.11655051999997568
gc 0
Train Epoch14 Acc 0.465825 (55899/120000), AUC 0.7192691564559937
ep14_train_time 9.347138546999986
Test Epoch14 layer0 Acc 0.5184210526315789, AUC 0.7621613144874573, avg_entr 0.32456862926483154, f1 0.5184210538864136
ep14_l0_test_time 0.11223047199999314
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 14
Test Epoch14 layer1 Acc 0.5068421052631579, AUC 0.752862274646759, avg_entr 0.3336198031902313, f1 0.5068420767784119
ep14_l1_test_time 0.11745438799999874
Test Epoch14 layer2 Acc 0.4892105263157895, AUC 0.7301638722419739, avg_entr 0.3403540253639221, f1 0.4892105162143707
ep14_l2_test_time 0.11502154299998324
Test Epoch14 layer3 Acc 0.46157894736842103, AUC 0.7075411677360535, avg_entr 0.32570457458496094, f1 0.46157893538475037
ep14_l3_test_time 0.12031755900000007
Test Epoch14 layer4 Acc 0.4557894736842105, AUC 0.7110418081283569, avg_entr 0.30218246579170227, f1 0.4557894766330719
ep14_l4_test_time 0.11858378200000175
gc 0
Train Epoch15 Acc 0.4650416666666667 (55805/120000), AUC 0.7193807363510132
ep15_train_time 8.494581763000014
Test Epoch15 layer0 Acc 0.5181578947368422, AUC 0.763764500617981, avg_entr 0.31449076533317566, f1 0.5181578993797302
ep15_l0_test_time 0.1109527770000227
Test Epoch15 layer1 Acc 0.4994736842105263, AUC 0.7530055046081543, avg_entr 0.3210376799106598, f1 0.4994736909866333
ep15_l1_test_time 0.11390039099998717
Test Epoch15 layer2 Acc 0.48, AUC 0.7312198877334595, avg_entr 0.32830241322517395, f1 0.47999998927116394
ep15_l2_test_time 0.11326275799999053
Test Epoch15 layer3 Acc 0.46157894736842103, AUC 0.7117559313774109, avg_entr 0.3167050778865814, f1 0.46157893538475037
ep15_l3_test_time 0.11492683500000567
Test Epoch15 layer4 Acc 0.4536842105263158, AUC 0.713485598564148, avg_entr 0.2995242774486542, f1 0.4536842107772827
ep15_l4_test_time 0.11923071999999024
gc 0
Train Epoch16 Acc 0.464725 (55767/120000), AUC 0.7198758125305176
ep16_train_time 9.502118467000003
Test Epoch16 layer0 Acc 0.5018421052631579, AUC 0.7649409174919128, avg_entr 0.29538893699645996, f1 0.5018420815467834
ep16_l0_test_time 0.13959513800000423
Test Epoch16 layer1 Acc 0.5068421052631579, AUC 0.7542521357536316, avg_entr 0.30504679679870605, f1 0.5068420767784119
ep16_l1_test_time 0.1381366390000096
Test Epoch16 layer2 Acc 0.48236842105263156, AUC 0.7320908904075623, avg_entr 0.318310022354126, f1 0.4823684096336365
ep16_l2_test_time 0.14159605899999406
Test Epoch16 layer3 Acc 0.45842105263157895, AUC 0.7129071950912476, avg_entr 0.3109782934188843, f1 0.4584210515022278
ep16_l3_test_time 0.14734519199998886
Test Epoch16 layer4 Acc 0.4560526315789474, AUC 0.7141073346138, avg_entr 0.2975851595401764, f1 0.45605263113975525
ep16_l4_test_time 0.15153259799998864
gc 0
Train Epoch17 Acc 0.46608333333333335 (55930/120000), AUC 0.7205569744110107
ep17_train_time 9.103512636999994
Test Epoch17 layer0 Acc 0.5202631578947369, AUC 0.766412615776062, avg_entr 0.28268858790397644, f1 0.520263135433197
ep17_l0_test_time 0.11158199799999124
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 17
Test Epoch17 layer1 Acc 0.49894736842105264, AUC 0.7529399991035461, avg_entr 0.28962212800979614, f1 0.4989473819732666
ep17_l1_test_time 0.11409586299998864
Test Epoch17 layer2 Acc 0.48, AUC 0.7310101985931396, avg_entr 0.3007342517375946, f1 0.47999998927116394
ep17_l2_test_time 0.11698118800001112
Test Epoch17 layer3 Acc 0.45657894736842103, AUC 0.7126884460449219, avg_entr 0.2867509424686432, f1 0.45657894015312195
ep17_l3_test_time 0.11491072300000837
Test Epoch17 layer4 Acc 0.45342105263157895, AUC 0.714940071105957, avg_entr 0.27558156847953796, f1 0.45342105627059937
ep17_l4_test_time 0.11666559799999732
gc 0
Train Epoch18 Acc 0.464725 (55767/120000), AUC 0.7197867631912231
ep18_train_time 9.241852730000005
Test Epoch18 layer0 Acc 0.5068421052631579, AUC 0.7676913738250732, avg_entr 0.27646303176879883, f1 0.5068420767784119
ep18_l0_test_time 0.1110835449999854
Test Epoch18 layer1 Acc 0.5042105263157894, AUC 0.754819393157959, avg_entr 0.28753378987312317, f1 0.5042105317115784
ep18_l1_test_time 0.11304576999998517
Test Epoch18 layer2 Acc 0.48447368421052633, AUC 0.7318999767303467, avg_entr 0.2945244312286377, f1 0.48447367548942566
ep18_l2_test_time 0.11325341899998875
Test Epoch18 layer3 Acc 0.4602631578947368, AUC 0.7136237025260925, avg_entr 0.2781449854373932, f1 0.4602631628513336
ep18_l3_test_time 0.11623851499999205
Test Epoch18 layer4 Acc 0.455, AUC 0.7149268388748169, avg_entr 0.2534462511539459, f1 0.45500001311302185
ep18_l4_test_time 0.11645051400000739
gc 0
Train Epoch19 Acc 0.46650833333333336 (55981/120000), AUC 0.7218451499938965
ep19_train_time 8.265739945999997
Test Epoch19 layer0 Acc 0.5086842105263157, AUC 0.7693948745727539, avg_entr 0.2747288644313812, f1 0.5086842179298401
ep19_l0_test_time 0.1095286880000117
Test Epoch19 layer1 Acc 0.49526315789473685, AUC 0.7535225749015808, avg_entr 0.28690391778945923, f1 0.49526315927505493
ep19_l1_test_time 0.11269813499998804
Test Epoch19 layer2 Acc 0.4826315789473684, AUC 0.7302334904670715, avg_entr 0.284016489982605, f1 0.4826315641403198
ep19_l2_test_time 0.11195483699998476
Test Epoch19 layer3 Acc 0.4644736842105263, AUC 0.710773229598999, avg_entr 0.26866212487220764, f1 0.464473694562912
ep19_l3_test_time 0.11196234599998434
Test Epoch19 layer4 Acc 0.4573684210526316, AUC 0.7150920033454895, avg_entr 0.25167131423950195, f1 0.4573684334754944
ep19_l4_test_time 0.11961589099999514
Best AUC tensor(0.5203) 17 0
train_as_loss [[4.56554248e+02 3.56599536e+02 3.51065147e+02 3.49836755e+02
  3.49369896e+02 3.49144502e+02 3.49019793e+02 3.48944490e+02
  3.48896210e+02 3.48863884e+02 3.48841542e+02 3.48825720e+02
  3.48814312e+02 3.48805965e+02 3.48799787e+02 3.48795175e+02
  3.48791706e+02 3.48789077e+02 3.48787084e+02 3.48785580e+02]
 [1.70242813e+00 2.16264373e-05 1.48806129e-06 2.79649877e-07
  8.10305848e-08 2.96841446e-08 1.08588975e-06 1.09036232e-05
  6.43675755e-05 1.40801665e-04 2.86445190e-04 3.63287672e-04
  3.45037872e-04 2.71597214e-05 1.17385321e-09 1.89383147e-05
  1.64436966e-04 1.42184195e-04 1.40859820e-04 2.49893924e-04]
 [2.41793584e+00 2.87133248e-05 2.32180192e-06 4.72833180e-07
  1.44573350e-07 5.67616328e-08 3.77227023e-07 9.41847332e-06
  7.09438818e-05 2.30208689e-04 5.56285411e-04 6.69468064e-04
  8.16466398e-04 2.26556625e-05 3.23021392e-09 1.82345135e-05
  3.45218169e-04 5.96592572e-05 7.29659297e-05 1.56567536e-04]
 [2.41305015e+00 1.63788915e-05 1.50395032e-06 3.65011506e-07
  1.37747411e-07 7.36869306e-08 3.83937805e-07 1.24865736e-05
  1.28852950e-04 4.51414517e-04 1.02640246e-03 4.03609139e-04
  5.15765368e-04 4.63742534e-05 1.64465843e-08 3.27057171e-05
  7.56695481e-04 1.13569042e-04 2.70973628e-04 5.59834218e-04]
 [2.57290748e+00 1.53993891e-05 1.79779682e-06 5.40190689e-07
  2.49089275e-07 1.78686484e-07 4.95407274e-07 1.70315464e-05
  2.12462245e-04 7.92468743e-04 1.65176681e-03 7.28224661e-04
  4.52935618e-04 6.22234196e-05 8.08407323e-08 4.19181861e-05
  1.20696058e-03 1.35128695e-04 5.27948033e-04 9.97673798e-04]]
train_ae_loss [[17.43645817 24.18085004 28.4399577  31.39273829 33.81252419 35.86167063
  37.57022416 39.12032473 40.51984128 41.88561261 43.18324137 44.34826808
  45.41198986 46.37092755 47.41941306 48.44960795 49.35264522 50.34746493
  51.25474279 52.20456322]
 [17.24679487 23.41280328 26.88454141 29.23414379 31.05079467 32.64138176
  33.91389024 35.08090881 36.08185437 37.17683773 38.15082718 39.00067031
  39.75786439 40.13514274 40.85748044 41.5604213  42.27926742 42.94204588
  43.57880325 44.15596002]
 [17.49525688 23.20037973 26.17195987 27.90884398 29.23319096 30.46005176
  31.41400494 32.29261827 33.00967085 33.88323122 34.73927817 35.46791576
  36.06893577 36.33533526 36.84244859 37.36933608 37.9242078  38.14783223
  38.72737331 39.11636737]
 [14.39233572 22.53056394 25.44943006 27.02450367 28.15227942 29.16528908
  29.9782153  30.68430122 31.32392759 32.0084482  32.6947158  33.09518152
  33.6887168  34.1114987  34.50749367 34.9107134  35.30399898 35.63394558
  36.03213676 36.30242696]
 [12.46573641 21.86103922 24.62585134 25.91062905 26.80229265 27.59730915
  28.21348644 28.74616183 29.23862603 29.79066984 30.34692567 30.77034375
  31.11430874 31.46240064 31.76142637 32.10429615 32.42287636 32.69397407
  32.99358606 33.17513815]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 195.833830921
Start Testing
Load ckpt at ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt
gc 10
Test layer0 Acc 0.5136842105263157, AUC 0.7564229965209961, avg_entr 0.282401978969574, f1 0.5136842131614685
l0_test_time 0.11099306900001693
gc 0
Test layer1 Acc 0.4921052631578947, AUC 0.7399015426635742, avg_entr 0.28977757692337036, f1 0.49210527539253235
l1_test_time 0.11616675599998416
gc 0
Test layer2 Acc 0.4689473684210526, AUC 0.7249011397361755, avg_entr 0.2983861565589905, f1 0.4689473807811737
l2_test_time 0.11650912899997934
gc 0
Test layer3 Acc 0.4473684210526316, AUC 0.7122270464897156, avg_entr 0.29059192538261414, f1 0.44736841320991516
l3_test_time 0.11489779300001146
gc 0
Test layer4 Acc 0.4473684210526316, AUC 0.7119588851928711, avg_entr 0.2773660123348236, f1 0.44736841320991516
l4_test_time 0.11943943200000717
gc 0
Test threshold 0.1 Acc 0.5047368421052632, AUC 0.7578755021095276, avg_entr 0.14578457176685333, f1 0.5047368407249451
t0.1_test_time 0.2213990969999884
gc 0
Test threshold 0.2 Acc 0.5, AUC 0.7487305402755737, avg_entr 0.13164883852005005, f1 0.5
t0.2_test_time 0.19366175999999768
gc 0
Test threshold 0.3 Acc 0.5118421052631579, AUC 0.7535731792449951, avg_entr 0.16769370436668396, f1 0.5118421316146851
t0.3_test_time 0.16912544699999899
gc 0
Test threshold 0.4 Acc 0.5139473684210526, AUC 0.7559208273887634, avg_entr 0.19150137901306152, f1 0.5139473676681519
t0.4_test_time 0.14840933400000722
gc 0
Test threshold 0.5 Acc 0.515, AUC 0.7564257383346558, avg_entr 0.20161795616149902, f1 0.5149999856948853
t0.5_test_time 0.14665993299999514
gc 0
Test threshold 0.6 Acc 0.5139473684210526, AUC 0.7565147876739502, avg_entr 0.20360104739665985, f1 0.5139473676681519
t0.6_test_time 0.1327336920000164
gc 0
Test threshold 0.7 Acc 0.5136842105263157, AUC 0.7564229965209961, avg_entr 0.20370997488498688, f1 0.5136842131614685
t0.7_test_time 0.13283404800000653
gc 0
Test threshold 0.8 Acc 0.5136842105263157, AUC 0.7564229965209961, avg_entr 0.20370997488498688, f1 0.5136842131614685
t0.8_test_time 0.13490464299999871
gc 0
Test threshold 0.9 Acc 0.5136842105263157, AUC 0.7564229965209961, avg_entr 0.20370997488498688, f1 0.5136842131614685
t0.9_test_time 0.1380227219999881
