total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearALsideText(
  (layers): ModuleList(
    (0): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.0.weight 90000
layers.0.enc.f.0.bias 300
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 45777392
init_time 32.13800178
Start Training
gc 0
Train Epoch0 Acc 0.2898833333333333 (34786/120000), AUC 0.5192533731460571
ep0_train_time 11.263020302999998
Test Epoch0 layer0 Acc 0.3634210526315789, AUC 0.6847403049468994, avg_entr 1.2022297382354736, f1 0.3634210526943207
ep0_l0_test_time 0.11514808700000145
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.3402631578947368, AUC 0.6536381244659424, avg_entr 1.2013356685638428, f1 0.34026315808296204
ep0_l1_test_time 0.11541160499999847
Test Epoch0 layer2 Acc 0.3376315789473684, AUC 0.6130601763725281, avg_entr 1.203553318977356, f1 0.33763158321380615
ep0_l2_test_time 0.11572766700000159
Test Epoch0 layer3 Acc 0.34421052631578947, AUC 0.6035594940185547, avg_entr 1.2130999565124512, f1 0.34421053528785706
ep0_l3_test_time 0.11845644100000641
Test Epoch0 layer4 Acc 0.33973684210526317, AUC 0.5943953990936279, avg_entr 1.2173810005187988, f1 0.33973684906959534
ep0_l4_test_time 0.11884906699999931
gc 0
Train Epoch1 Acc 0.3584333333333333 (43012/120000), AUC 0.6114967465400696
ep1_train_time 8.553776438
Test Epoch1 layer0 Acc 0.43394736842105264, AUC 0.7364143133163452, avg_entr 0.8370351791381836, f1 0.43394735455513
ep1_l0_test_time 0.1159038790000011
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.4394736842105263, AUC 0.7299476265907288, avg_entr 0.8488038182258606, f1 0.4394736886024475
ep1_l1_test_time 0.11367414400000087
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer2 Acc 0.38789473684210524, AUC 0.6813977956771851, avg_entr 0.8781744241714478, f1 0.38789471983909607
ep1_l2_test_time 0.10859235799999567
Test Epoch1 layer3 Acc 0.3973684210526316, AUC 0.6687689423561096, avg_entr 0.8736326098442078, f1 0.3973684310913086
ep1_l3_test_time 0.11720524500000096
Test Epoch1 layer4 Acc 0.38342105263157894, AUC 0.6603370904922485, avg_entr 0.8877277970314026, f1 0.38342106342315674
ep1_l4_test_time 0.11675291600000293
gc 0
Train Epoch2 Acc 0.4160333333333333 (49924/120000), AUC 0.6703587770462036
ep2_train_time 8.462950317
Test Epoch2 layer0 Acc 0.48947368421052634, AUC 0.7459923624992371, avg_entr 0.7028422951698303, f1 0.4894736707210541
ep2_l0_test_time 0.11085986100000866
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.49473684210526314, AUC 0.7471373081207275, avg_entr 0.7094689011573792, f1 0.49473685026168823
ep2_l1_test_time 0.11501147900000319
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer2 Acc 0.44894736842105265, AUC 0.7014102339744568, avg_entr 0.7338497042655945, f1 0.44894737005233765
ep2_l2_test_time 0.12229212700000858
Test Epoch2 layer3 Acc 0.43526315789473685, AUC 0.6923425793647766, avg_entr 0.7226312160491943, f1 0.43526315689086914
ep2_l3_test_time 0.11926695100000018
Test Epoch2 layer4 Acc 0.4307894736842105, AUC 0.6902384757995605, avg_entr 0.7284441590309143, f1 0.4307894706726074
ep2_l4_test_time 0.11734911099999579
gc 0
Train Epoch3 Acc 0.4391583333333333 (52699/120000), AUC 0.6901562213897705
ep3_train_time 8.451103136
Test Epoch3 layer0 Acc 0.5018421052631579, AUC 0.7490644454956055, avg_entr 0.6170862317085266, f1 0.5018420815467834
ep3_l0_test_time 0.11205511199999307
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.49394736842105263, AUC 0.7511862516403198, avg_entr 0.6243982315063477, f1 0.4939473271369934
ep3_l1_test_time 0.11588977499999942
Test Epoch3 layer2 Acc 0.45552631578947367, AUC 0.7129961252212524, avg_entr 0.6366254687309265, f1 0.45552632212638855
ep3_l2_test_time 0.11946212200000161
Test Epoch3 layer3 Acc 0.4494736842105263, AUC 0.6977756023406982, avg_entr 0.6309953331947327, f1 0.44947367906570435
ep3_l3_test_time 0.11735783499999286
Test Epoch3 layer4 Acc 0.45394736842105265, AUC 0.6986560225486755, avg_entr 0.6241320371627808, f1 0.45394739508628845
ep3_l4_test_time 0.12443385499999238
gc 0
Train Epoch4 Acc 0.45 (54000/120000), AUC 0.700987696647644
ep4_train_time 8.447970330999993
Test Epoch4 layer0 Acc 0.5, AUC 0.7506582736968994, avg_entr 0.5539041757583618, f1 0.5
ep4_l0_test_time 0.1137171230000007
Test Epoch4 layer1 Acc 0.5018421052631579, AUC 0.7508521676063538, avg_entr 0.5622106194496155, f1 0.5018420815467834
ep4_l1_test_time 0.11232821100000479
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 4
Test Epoch4 layer2 Acc 0.46657894736842104, AUC 0.7201729416847229, avg_entr 0.5739037990570068, f1 0.46657896041870117
ep4_l2_test_time 0.11822685999999294
Test Epoch4 layer3 Acc 0.45973684210526317, AUC 0.709851861000061, avg_entr 0.5651593208312988, f1 0.4597368538379669
ep4_l3_test_time 0.10944263400000409
Test Epoch4 layer4 Acc 0.45394736842105265, AUC 0.7091494202613831, avg_entr 0.552638828754425, f1 0.45394739508628845
ep4_l4_test_time 0.1257588999999939
gc 0
Train Epoch5 Acc 0.45613333333333334 (54736/120000), AUC 0.7073567509651184
ep5_train_time 8.349323231
Test Epoch5 layer0 Acc 0.5055263157894737, AUC 0.7520710229873657, avg_entr 0.5163550972938538, f1 0.5055263042449951
ep5_l0_test_time 0.11324973199999988
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.5060526315789474, AUC 0.7505212426185608, avg_entr 0.5325984358787537, f1 0.5060526132583618
ep5_l1_test_time 0.1152390879999956
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.45552631578947367, AUC 0.7195035219192505, avg_entr 0.5278014540672302, f1 0.45552632212638855
ep5_l2_test_time 0.12006003499999451
Test Epoch5 layer3 Acc 0.45263157894736844, AUC 0.7085200548171997, avg_entr 0.5293323993682861, f1 0.4526315927505493
ep5_l3_test_time 0.11467213699999945
Test Epoch5 layer4 Acc 0.4523684210526316, AUC 0.7087985277175903, avg_entr 0.507871687412262, f1 0.4523683786392212
ep5_l4_test_time 0.12114323500000523
gc 0
Train Epoch6 Acc 0.45900833333333335 (55081/120000), AUC 0.7108086943626404
ep6_train_time 8.202314510000008
Test Epoch6 layer0 Acc 0.5076315789473684, AUC 0.753032386302948, avg_entr 0.4797362983226776, f1 0.5076315999031067
ep6_l0_test_time 0.11258498800000893
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 6
Test Epoch6 layer1 Acc 0.5063157894736842, AUC 0.7499209642410278, avg_entr 0.48020368814468384, f1 0.5063157677650452
ep6_l1_test_time 0.11850912799999946
Test Epoch6 layer2 Acc 0.46421052631578946, AUC 0.7171139717102051, avg_entr 0.4894130229949951, f1 0.46421054005622864
ep6_l2_test_time 0.12718896100000165
Test Epoch6 layer3 Acc 0.45263157894736844, AUC 0.7077673673629761, avg_entr 0.4800047278404236, f1 0.4526315927505493
ep6_l3_test_time 0.1480539629999953
Test Epoch6 layer4 Acc 0.45657894736842103, AUC 0.7096224427223206, avg_entr 0.4575725793838501, f1 0.45657894015312195
ep6_l4_test_time 0.15272781399998792
gc 0
Train Epoch7 Acc 0.460575 (55269/120000), AUC 0.7134190797805786
ep7_train_time 9.359793668000009
Test Epoch7 layer0 Acc 0.506578947368421, AUC 0.7539729475975037, avg_entr 0.455189973115921, f1 0.5065789222717285
ep7_l0_test_time 0.11270216900000207
Test Epoch7 layer1 Acc 0.5026315789473684, AUC 0.7498272061347961, avg_entr 0.4618699550628662, f1 0.5026316046714783
ep7_l1_test_time 0.11202022800000577
Test Epoch7 layer2 Acc 0.475, AUC 0.7219625115394592, avg_entr 0.4747447371482849, f1 0.4749999940395355
ep7_l2_test_time 0.11599252399999216
Test Epoch7 layer3 Acc 0.45473684210526316, AUC 0.7122650742530823, avg_entr 0.4746719300746918, f1 0.4547368288040161
ep7_l3_test_time 0.11205188200000293
Test Epoch7 layer4 Acc 0.45394736842105265, AUC 0.7140703797340393, avg_entr 0.4620097875595093, f1 0.45394739508628845
ep7_l4_test_time 0.11943043700000544
gc 0
Train Epoch8 Acc 0.462725 (55527/120000), AUC 0.7163105607032776
ep8_train_time 8.433771737
Test Epoch8 layer0 Acc 0.506578947368421, AUC 0.7549580931663513, avg_entr 0.43637731671333313, f1 0.5065789222717285
ep8_l0_test_time 0.11164713899999867
Test Epoch8 layer1 Acc 0.4863157894736842, AUC 0.748900830745697, avg_entr 0.42984485626220703, f1 0.4863157868385315
ep8_l1_test_time 0.11620081200000243
Test Epoch8 layer2 Acc 0.47368421052631576, AUC 0.7261485457420349, avg_entr 0.43811434507369995, f1 0.4736842215061188
ep8_l2_test_time 0.10985982399999727
Test Epoch8 layer3 Acc 0.45921052631578946, AUC 0.7152106761932373, avg_entr 0.4283439517021179, f1 0.4592105448246002
ep8_l3_test_time 0.12032263300000068
Test Epoch8 layer4 Acc 0.45657894736842103, AUC 0.7156068086624146, avg_entr 0.4055851697921753, f1 0.45657894015312195
ep8_l4_test_time 0.11739365799999746
gc 0
Train Epoch9 Acc 0.4664583333333333 (55975/120000), AUC 0.7187747359275818
ep9_train_time 8.330168696000001
Test Epoch9 layer0 Acc 0.49894736842105264, AUC 0.7560909986495972, avg_entr 0.39820897579193115, f1 0.4989473819732666
ep9_l0_test_time 0.11362555099998417
Test Epoch9 layer1 Acc 0.505, AUC 0.7491389513015747, avg_entr 0.41550344228744507, f1 0.5049999952316284
ep9_l1_test_time 0.11473374199999853
Test Epoch9 layer2 Acc 0.46710526315789475, AUC 0.7261241674423218, avg_entr 0.4216098487377167, f1 0.46710526943206787
ep9_l2_test_time 0.11633338799998683
Test Epoch9 layer3 Acc 0.4636842105263158, AUC 0.7147294878959656, avg_entr 0.39722585678100586, f1 0.46368420124053955
ep9_l3_test_time 0.11909821799997644
Test Epoch9 layer4 Acc 0.46710526315789475, AUC 0.7178510427474976, avg_entr 0.38078588247299194, f1 0.46710526943206787
ep9_l4_test_time 0.12132153400000334
gc 0
Train Epoch10 Acc 0.467775 (56133/120000), AUC 0.7203162908554077
ep10_train_time 8.996541857000011
Test Epoch10 layer0 Acc 0.5102631578947369, AUC 0.7570168375968933, avg_entr 0.380659818649292, f1 0.5102631449699402
ep10_l0_test_time 0.11608207800000514
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 10
Test Epoch10 layer1 Acc 0.5118421052631579, AUC 0.7488731741905212, avg_entr 0.3940633237361908, f1 0.5118421316146851
ep10_l1_test_time 0.11440439699998706
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 10
Test Epoch10 layer2 Acc 0.48078947368421054, AUC 0.7260873913764954, avg_entr 0.3946598172187805, f1 0.4807894825935364
ep10_l2_test_time 0.111610866999996
Test Epoch10 layer3 Acc 0.46657894736842104, AUC 0.717465341091156, avg_entr 0.3876180946826935, f1 0.46657896041870117
ep10_l3_test_time 0.1192541750000089
Test Epoch10 layer4 Acc 0.46473684210526317, AUC 0.7186581492424011, avg_entr 0.35802462697029114, f1 0.46473684906959534
ep10_l4_test_time 0.12033314800001449
gc 0
Train Epoch11 Acc 0.46868333333333334 (56242/120000), AUC 0.7209622859954834
ep11_train_time 8.569569519000027
Test Epoch11 layer0 Acc 0.5071052631578947, AUC 0.7581009864807129, avg_entr 0.3713856339454651, f1 0.50710529088974
ep11_l0_test_time 0.10805181199998515
Test Epoch11 layer1 Acc 0.4957894736842105, AUC 0.7489466667175293, avg_entr 0.369274765253067, f1 0.49578946828842163
ep11_l1_test_time 0.11541350299998498
Test Epoch11 layer2 Acc 0.48578947368421055, AUC 0.7297518253326416, avg_entr 0.36905255913734436, f1 0.4857894778251648
ep11_l2_test_time 0.11507850000000985
Test Epoch11 layer3 Acc 0.46421052631578946, AUC 0.7186018228530884, avg_entr 0.34975412487983704, f1 0.46421054005622864
ep11_l3_test_time 0.11574906399999918
Test Epoch11 layer4 Acc 0.4623684210526316, AUC 0.7204832434654236, avg_entr 0.33864539861679077, f1 0.4623684287071228
ep11_l4_test_time 0.12134962700000074
gc 0
Train Epoch12 Acc 0.47018333333333334 (56422/120000), AUC 0.7234994769096375
ep12_train_time 9.983233547999987
Test Epoch12 layer0 Acc 0.51, AUC 0.7586188912391663, avg_entr 0.34764885902404785, f1 0.5099999904632568
ep12_l0_test_time 0.1119355950000056
Test Epoch12 layer1 Acc 0.5042105263157894, AUC 0.7491254806518555, avg_entr 0.36226460337638855, f1 0.5042105317115784
ep12_l1_test_time 0.11211380599999643
Test Epoch12 layer2 Acc 0.4723684210526316, AUC 0.7312446236610413, avg_entr 0.36542418599128723, f1 0.47236841917037964
ep12_l2_test_time 0.11589187299998116
Test Epoch12 layer3 Acc 0.4689473684210526, AUC 0.7202259302139282, avg_entr 0.35719096660614014, f1 0.4689473807811737
ep12_l3_test_time 0.11934739099999092
Test Epoch12 layer4 Acc 0.46578947368421053, AUC 0.7207587361335754, avg_entr 0.33902978897094727, f1 0.46578946709632874
ep12_l4_test_time 0.1217200709999986
gc 0
Train Epoch13 Acc 0.4709083333333333 (56509/120000), AUC 0.7242797613143921
ep13_train_time 9.005783142000013
Test Epoch13 layer0 Acc 0.5042105263157894, AUC 0.7597975730895996, avg_entr 0.33069711923599243, f1 0.5042105317115784
ep13_l0_test_time 0.11445664600000782
Test Epoch13 layer1 Acc 0.49973684210526315, AUC 0.7488993406295776, avg_entr 0.34300339221954346, f1 0.49973684549331665
ep13_l1_test_time 0.10656992799999898
Test Epoch13 layer2 Acc 0.47157894736842104, AUC 0.7302091121673584, avg_entr 0.3381105959415436, f1 0.4715789556503296
ep13_l2_test_time 0.11909030600000392
Test Epoch13 layer3 Acc 0.4631578947368421, AUC 0.7227324843406677, avg_entr 0.33072715997695923, f1 0.46315789222717285
ep13_l3_test_time 0.11203913400001397
Test Epoch13 layer4 Acc 0.45473684210526316, AUC 0.7230640649795532, avg_entr 0.3089471161365509, f1 0.4547368288040161
ep13_l4_test_time 0.12216910099999723
gc 0
Train Epoch14 Acc 0.47203333333333336 (56644/120000), AUC 0.7257574796676636
ep14_train_time 10.152043967999987
Test Epoch14 layer0 Acc 0.5076315789473684, AUC 0.7612951993942261, avg_entr 0.3344571590423584, f1 0.5076315999031067
ep14_l0_test_time 0.11043864900000244
Test Epoch14 layer1 Acc 0.5076315789473684, AUC 0.7490729689598083, avg_entr 0.33467355370521545, f1 0.5076315999031067
ep14_l1_test_time 0.11380709200000183
Test Epoch14 layer2 Acc 0.48, AUC 0.7314209938049316, avg_entr 0.34353309869766235, f1 0.47999998927116394
ep14_l2_test_time 0.114990578000004
Test Epoch14 layer3 Acc 0.4668421052631579, AUC 0.7157623171806335, avg_entr 0.3232525885105133, f1 0.4668421447277069
ep14_l3_test_time 0.12300426799998831
Test Epoch14 layer4 Acc 0.4639473684210526, AUC 0.7213706970214844, avg_entr 0.3015902042388916, f1 0.4639473557472229
ep14_l4_test_time 0.12258811899999955
gc 0
Train Epoch15 Acc 0.4719 (56628/120000), AUC 0.7268573045730591
ep15_train_time 8.374117757000022
Test Epoch15 layer0 Acc 0.515, AUC 0.7623901963233948, avg_entr 0.30665323138237, f1 0.5149999856948853
ep15_l0_test_time 0.11018451900000059
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 15
Test Epoch15 layer1 Acc 0.5073684210526316, AUC 0.7488915324211121, avg_entr 0.32219335436820984, f1 0.5073684453964233
ep15_l1_test_time 0.11265653699999234
Test Epoch15 layer2 Acc 0.4776315789473684, AUC 0.7319175004959106, avg_entr 0.32993507385253906, f1 0.4776315689086914
ep15_l2_test_time 0.10590537599998129
Test Epoch15 layer3 Acc 0.4618421052631579, AUC 0.7195054888725281, avg_entr 0.3107345998287201, f1 0.4618421196937561
ep15_l3_test_time 0.12528733999999986
Test Epoch15 layer4 Acc 0.45973684210526317, AUC 0.7222652435302734, avg_entr 0.272421658039093, f1 0.4597368538379669
ep15_l4_test_time 0.11764172499999859
gc 0
Train Epoch16 Acc 0.4735333333333333 (56824/120000), AUC 0.7279992699623108
ep16_train_time 8.370142716999993
Test Epoch16 layer0 Acc 0.5192105263157895, AUC 0.7628209590911865, avg_entr 0.2938738763332367, f1 0.5192105174064636
ep16_l0_test_time 0.1153286820000119
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 16
Test Epoch16 layer1 Acc 0.5021052631578947, AUC 0.7491299510002136, avg_entr 0.31193822622299194, f1 0.5021052360534668
ep16_l1_test_time 0.11518711400000825
Test Epoch16 layer2 Acc 0.48605263157894735, AUC 0.7325866222381592, avg_entr 0.3121073544025421, f1 0.48605263233184814
ep16_l2_test_time 0.11584274000000505
Test Epoch16 layer3 Acc 0.4660526315789474, AUC 0.7212898135185242, avg_entr 0.2982974350452423, f1 0.4660526216030121
ep16_l3_test_time 0.1208566330000167
Test Epoch16 layer4 Acc 0.4660526315789474, AUC 0.7223589420318604, avg_entr 0.26760247349739075, f1 0.4660526216030121
ep16_l4_test_time 0.11918227700002149
gc 0
Train Epoch17 Acc 0.47378333333333333 (56854/120000), AUC 0.7284425497055054
ep17_train_time 8.553617771000006
Test Epoch17 layer0 Acc 0.5128947368421053, AUC 0.7646486759185791, avg_entr 0.280087947845459, f1 0.5128947496414185
ep17_l0_test_time 0.11173854800000527
Test Epoch17 layer1 Acc 0.5028947368421053, AUC 0.7489923238754272, avg_entr 0.29835548996925354, f1 0.5028947591781616
ep17_l1_test_time 0.11595139700000345
Test Epoch17 layer2 Acc 0.4797368421052632, AUC 0.7348737120628357, avg_entr 0.29814282059669495, f1 0.4797368347644806
ep17_l2_test_time 0.11623056399997722
Test Epoch17 layer3 Acc 0.4594736842105263, AUC 0.7241051197052002, avg_entr 0.27460408210754395, f1 0.4594736397266388
ep17_l3_test_time 0.11808747799997832
Test Epoch17 layer4 Acc 0.46210526315789474, AUC 0.724244236946106, avg_entr 0.24826805293560028, f1 0.46210527420043945
ep17_l4_test_time 0.09847171600000593
gc 0
Train Epoch18 Acc 0.4757 (57084/120000), AUC 0.7297979593276978
ep18_train_time 9.46003000600001
Test Epoch18 layer0 Acc 0.5094736842105263, AUC 0.7664316296577454, avg_entr 0.2741485834121704, f1 0.5094736814498901
ep18_l0_test_time 0.11007861899997806
Test Epoch18 layer1 Acc 0.49973684210526315, AUC 0.7487024664878845, avg_entr 0.29431241750717163, f1 0.49973684549331665
ep18_l1_test_time 0.1131375440000113
Test Epoch18 layer2 Acc 0.4713157894736842, AUC 0.7317958474159241, avg_entr 0.2836082875728607, f1 0.47131580114364624
ep18_l2_test_time 0.11709046400000034
Test Epoch18 layer3 Acc 0.4573684210526316, AUC 0.7221291065216064, avg_entr 0.26718869805336, f1 0.4573684334754944
ep18_l3_test_time 0.11086700899997481
Test Epoch18 layer4 Acc 0.45342105263157895, AUC 0.7228931188583374, avg_entr 0.2505234181880951, f1 0.45342105627059937
ep18_l4_test_time 0.12794276500000024
gc 0
Train Epoch19 Acc 0.47570833333333334 (57085/120000), AUC 0.7305557131767273
ep19_train_time 9.621244705999999
Test Epoch19 layer0 Acc 0.516578947368421, AUC 0.7679901123046875, avg_entr 0.2642373740673065, f1 0.5165789723396301
ep19_l0_test_time 0.10748654799999713
Test Epoch19 layer1 Acc 0.5007894736842106, AUC 0.7488425970077515, avg_entr 0.2793779671192169, f1 0.50078946352005
ep19_l1_test_time 0.11584756400000629
Test Epoch19 layer2 Acc 0.4747368421052632, AUC 0.7352749109268188, avg_entr 0.27442118525505066, f1 0.4747368395328522
ep19_l2_test_time 0.1174607829999843
Test Epoch19 layer3 Acc 0.4652631578947368, AUC 0.7226635217666626, avg_entr 0.26427942514419556, f1 0.46526315808296204
ep19_l3_test_time 0.11828135999999745
Test Epoch19 layer4 Acc 0.4689473684210526, AUC 0.7229694724082947, avg_entr 0.24890658259391785, f1 0.4689473807811737
ep19_l4_test_time 0.11993282199998134
Best AUC tensor(0.5192) 16 0
train_as_loss [[4.47934099e+02 3.56308231e+02 3.51023675e+02 3.49818720e+02
  3.49358499e+02 3.49136340e+02 3.49013665e+02 3.48939788e+02
  3.48892557e+02 3.48861031e+02 3.48839301e+02 3.48823962e+02
  3.48812927e+02 3.48804877e+02 3.48798933e+02 3.48794496e+02
  3.48791177e+02 3.48788666e+02 3.48786761e+02 3.48785291e+02]
 [1.74587495e+00 1.56404564e-05 1.15859972e-06 2.36732598e-07
  7.06190543e-08 2.63603049e-08 1.01850537e-06 9.51641661e-06
  3.45320151e-07 5.19305590e-09 5.26319066e-09 1.52742614e-05
  4.71577848e-08 2.05187614e-09 2.27235729e-06 1.05546285e-05
  4.32200975e-08 1.14286535e-09 2.51457346e-09 5.65836722e-06]
 [1.64117903e+00 1.08169078e-05 8.80797366e-07 1.94968670e-07
  6.29462533e-08 2.65866917e-08 9.63996122e-07 2.09195646e-05
  4.45158618e-05 1.19565164e-04 1.94574352e-04 3.68011142e-04
  3.03823931e-04 6.10800179e-04 3.47198141e-04 6.12095677e-04
  4.06691519e-04 4.61881194e-04 5.06863974e-04 5.60703710e-04]
 [1.83679806e+00 1.46723013e-05 1.28673502e-06 3.28635751e-07
  1.20212725e-07 6.10288580e-08 1.39433841e-06 2.94649085e-05
  7.41876173e-05 2.17583754e-04 4.16022359e-04 7.99861084e-04
  5.92867836e-04 1.25633178e-03 6.47597792e-04 1.18890726e-03
  7.80050913e-04 8.02068472e-04 9.33278617e-04 9.79028847e-04]
 [1.75083625e+00 1.65647857e-05 1.81358466e-06 6.23317658e-07
  2.83453999e-07 1.82676504e-07 2.14251528e-06 4.85192040e-05
  2.02973780e-04 4.53442497e-04 8.48494806e-04 1.35398618e-03
  1.01071882e-03 2.21530587e-03 8.25341458e-04 1.73931476e-03
  1.23721351e-03 1.07435623e-03 1.35061325e-03 1.30974500e-03]]
train_ae_loss [[17.18993821 23.95346396 28.12339368 31.21908533 33.55811737 35.56975617
  37.34081456 38.86601231 40.36109939 41.50531346 42.79789957 44.01482327
  45.08153989 46.04530638 47.12929597 48.1329812  49.11897682 49.95201257
  50.91140047 51.62389633]
 [17.30718626 23.11830789 26.24883345 28.57859879 30.30275648 31.85343064
  33.24947395 34.32189883 35.16312143 36.15528991 37.15006552 38.00695489
  38.66704545 39.48009165 40.27617048 41.01591414 41.64548247 42.35559873
  43.04595676 43.7121929 ]
 [17.07279591 23.08066445 26.11890244 28.05254732 29.41181435 30.68643821
  31.75084144 32.67492649 33.46515311 34.21326227 34.90920013 35.63387766
  36.13507035 36.64924632 37.17441618 37.67453659 38.13157114 38.54804926
  38.87548474 39.24506899]
 [14.02942475 21.11052587 23.74752929 25.30844173 26.40511467 27.32921305
  28.1148534  28.81157405 29.39605904 29.964869   30.48495212 31.00984615
  31.39696754 31.78445505 32.07812981 32.36612163 32.6211718  32.85727251
  33.05767906 33.19086945]
 [12.41551394 20.54911395 22.9439701  24.23692686 25.12401459 25.83955448
  26.45938274 26.99630123 27.43654818 27.85180018 28.24727646 28.62306852
  28.85317339 29.10384932 29.24513748 29.37685346 29.45544052 29.55552302
  29.56813452 29.51600792]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 197.094788862
Start Testing
Load ckpt at ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt
gc 10
Test layer0 Acc 0.5031578947368421, AUC 0.7549872398376465, avg_entr 0.29174602031707764, f1 0.503157913684845
l0_test_time 0.0995671649999963
gc 0
Test layer1 Acc 0.49105263157894735, AUC 0.7309107780456543, avg_entr 0.30940505862236023, f1 0.49105262756347656
l1_test_time 0.1159959400000048
gc 0
Test layer2 Acc 0.4792105263157895, AUC 0.7305985689163208, avg_entr 0.312961608171463, f1 0.4792105257511139
l2_test_time 0.11797601200001395
gc 0
Test layer3 Acc 0.45289473684210524, AUC 0.7169562578201294, avg_entr 0.3018472194671631, f1 0.45289474725723267
l3_test_time 0.11761757799999373
gc 0
Test layer4 Acc 0.45473684210526316, AUC 0.7191329598426819, avg_entr 0.2706204652786255, f1 0.4547368288040161
l4_test_time 0.12370177100001456
gc 0
Test threshold 0.1 Acc 0.5157894736842106, AUC 0.7621728777885437, avg_entr 0.15096521377563477, f1 0.5157894492149353
t0.1_test_time 0.2219825470000103
gc 0
Test threshold 0.2 Acc 0.5060526315789474, AUC 0.7535086870193481, avg_entr 0.13731543719768524, f1 0.5060526132583618
t0.2_test_time 0.19883632699998088
gc 0
Test threshold 0.3 Acc 0.5173684210526316, AUC 0.7535102367401123, avg_entr 0.1715286672115326, f1 0.5173684358596802
t0.3_test_time 0.17117020900002444
gc 0
Test threshold 0.4 Acc 0.508421052631579, AUC 0.753273606300354, avg_entr 0.1968155801296234, f1 0.5084210634231567
t0.4_test_time 0.1546618270000124
gc 0
Test threshold 0.5 Acc 0.5047368421052632, AUC 0.7548214197158813, avg_entr 0.20757664740085602, f1 0.5047368407249451
t0.5_test_time 0.14462506899999994
gc 0
Test threshold 0.6 Acc 0.5031578947368421, AUC 0.7549872398376465, avg_entr 0.21045027673244476, f1 0.503157913684845
t0.6_test_time 0.1338685030000022
gc 0
Test threshold 0.7 Acc 0.5031578947368421, AUC 0.7549872398376465, avg_entr 0.21045027673244476, f1 0.503157913684845
t0.7_test_time 0.13634663299998806
gc 0
Test threshold 0.8 Acc 0.5031578947368421, AUC 0.7549872398376465, avg_entr 0.21045027673244476, f1 0.503157913684845
t0.8_test_time 0.13066875199999117
gc 0
Test threshold 0.9 Acc 0.5031578947368421, AUC 0.7549872398376465, avg_entr 0.21045027673244476, f1 0.503157913684845
t0.9_test_time 0.13498909800000547
