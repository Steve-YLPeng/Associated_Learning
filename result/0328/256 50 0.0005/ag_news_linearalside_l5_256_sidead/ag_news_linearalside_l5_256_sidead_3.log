total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearALsideText(
  (layers): ModuleList(
    (0): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.0.weight 90000
layers.0.enc.f.0.bias 300
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 45777392
init_time 25.915927453000002
Start Training
gc 0
Train Epoch0 Acc 0.2824583333333333 (33895/120000), AUC 0.5163167715072632
ep0_train_time 10.669656843999999
Test Epoch0 layer0 Acc 0.3831578947368421, AUC 0.6748151779174805, avg_entr 1.2163256406784058, f1 0.3831579089164734
ep0_l0_test_time 0.11222797300000309
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.3671052631578947, AUC 0.6535488963127136, avg_entr 1.2172627449035645, f1 0.36710527539253235
ep0_l1_test_time 0.1095862359999984
Test Epoch0 layer2 Acc 0.3394736842105263, AUC 0.6138420104980469, avg_entr 1.2125279903411865, f1 0.339473694562912
ep0_l2_test_time 0.11526984799999695
Test Epoch0 layer3 Acc 0.32894736842105265, AUC 0.5875680446624756, avg_entr 1.2155375480651855, f1 0.32894736528396606
ep0_l3_test_time 0.11589734100000015
Test Epoch0 layer4 Acc 0.3218421052631579, AUC 0.5880361199378967, avg_entr 1.2171616554260254, f1 0.32184210419654846
ep0_l4_test_time 0.12007907000000273
gc 0
Train Epoch1 Acc 0.34173333333333333 (41008/120000), AUC 0.5991262197494507
ep1_train_time 10.330078260999997
Test Epoch1 layer0 Acc 0.4652631578947368, AUC 0.7273236513137817, avg_entr 0.8503223657608032, f1 0.46526315808296204
ep1_l0_test_time 0.13719787500000535
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.44526315789473686, AUC 0.7086231112480164, avg_entr 0.8759838938713074, f1 0.445263147354126
ep1_l1_test_time 0.11484260499999976
Test Epoch1 layer2 Acc 0.38263157894736843, AUC 0.6684209704399109, avg_entr 0.875325083732605, f1 0.3826315701007843
ep1_l2_test_time 0.11563470999999481
Test Epoch1 layer3 Acc 0.3684210526315789, AUC 0.6409085392951965, avg_entr 0.8813093900680542, f1 0.3684210479259491
ep1_l3_test_time 0.12423515699999399
Test Epoch1 layer4 Acc 0.36078947368421055, AUC 0.6382731199264526, avg_entr 0.8821638822555542, f1 0.3607894778251648
ep1_l4_test_time 0.12062733100000145
gc 0
Train Epoch2 Acc 0.40145 (48174/120000), AUC 0.6605244278907776
ep2_train_time 8.67108802
Test Epoch2 layer0 Acc 0.48578947368421055, AUC 0.7383509874343872, avg_entr 0.7069783210754395, f1 0.4857894778251648
ep2_l0_test_time 0.11063550300000458
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.4813157894736842, AUC 0.7327508926391602, avg_entr 0.7176900506019592, f1 0.4813157916069031
ep2_l1_test_time 0.11640242
Test Epoch2 layer2 Acc 0.4378947368421053, AUC 0.7030819058418274, avg_entr 0.717689037322998, f1 0.437894731760025
ep2_l2_test_time 0.1368170569999947
Test Epoch2 layer3 Acc 0.42105263157894735, AUC 0.6731826663017273, avg_entr 0.7195672988891602, f1 0.4210526645183563
ep2_l3_test_time 0.1347646979999979
Test Epoch2 layer4 Acc 0.4163157894736842, AUC 0.6716171503067017, avg_entr 0.7172255516052246, f1 0.4163157641887665
ep2_l4_test_time 0.15148757600000096
gc 0
Train Epoch3 Acc 0.43628333333333336 (52354/120000), AUC 0.690453052520752
ep3_train_time 8.647406590000003
Test Epoch3 layer0 Acc 0.4884210526315789, AUC 0.7423518300056458, avg_entr 0.608527421951294, f1 0.4884210526943207
ep3_l0_test_time 0.10812120500000333
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 3
Test Epoch3 layer1 Acc 0.4797368421052632, AUC 0.7418761849403381, avg_entr 0.6076878309249878, f1 0.4797368347644806
ep3_l1_test_time 0.11048870900000907
Test Epoch3 layer2 Acc 0.44026315789473686, AUC 0.7207093238830566, avg_entr 0.6176043152809143, f1 0.44026315212249756
ep3_l2_test_time 0.1127114489999883
Test Epoch3 layer3 Acc 0.42394736842105263, AUC 0.6965910196304321, avg_entr 0.611266016960144, f1 0.42394736409187317
ep3_l3_test_time 0.12085715199999925
Test Epoch3 layer4 Acc 0.41289473684210526, AUC 0.695624589920044, avg_entr 0.6025296449661255, f1 0.41289472579956055
ep3_l4_test_time 0.11690582200000676
gc 0
Train Epoch4 Acc 0.45216666666666666 (54260/120000), AUC 0.7048079371452332
ep4_train_time 9.335881255999993
Test Epoch4 layer0 Acc 0.49842105263157893, AUC 0.7444459199905396, avg_entr 0.5664386749267578, f1 0.4984210431575775
ep4_l0_test_time 0.11217863099999192
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.47, AUC 0.7468916773796082, avg_entr 0.5640476942062378, f1 0.4699999988079071
ep4_l1_test_time 0.11742965500000935
Test Epoch4 layer2 Acc 0.43342105263157893, AUC 0.7294886112213135, avg_entr 0.5696964263916016, f1 0.4334210455417633
ep4_l2_test_time 0.12025420599999848
Test Epoch4 layer3 Acc 0.4321052631578947, AUC 0.7051951289176941, avg_entr 0.5733855962753296, f1 0.43210527300834656
ep4_l3_test_time 0.1220127309999981
Test Epoch4 layer4 Acc 0.41578947368421054, AUC 0.7036758661270142, avg_entr 0.5655556917190552, f1 0.41578951478004456
ep4_l4_test_time 0.1249574259999946
gc 0
Train Epoch5 Acc 0.4619666666666667 (55436/120000), AUC 0.7130024433135986
ep5_train_time 8.467545406000013
Test Epoch5 layer0 Acc 0.5047368421052632, AUC 0.7461901307106018, avg_entr 0.5217432379722595, f1 0.5047368407249451
ep5_l0_test_time 0.11242743600000438
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.5071052631578947, AUC 0.749183714389801, avg_entr 0.5200238823890686, f1 0.50710529088974
ep5_l1_test_time 0.11740119099999902
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.48210526315789476, AUC 0.7367292642593384, avg_entr 0.5177242159843445, f1 0.4821052551269531
ep5_l2_test_time 0.12724429700000428
Test Epoch5 layer3 Acc 0.45289473684210524, AUC 0.7112476229667664, avg_entr 0.5211247801780701, f1 0.45289474725723267
ep5_l3_test_time 0.11608304499999633
Test Epoch5 layer4 Acc 0.4536842105263158, AUC 0.7118403911590576, avg_entr 0.511763334274292, f1 0.4536842107772827
ep5_l4_test_time 0.11779368900000975
gc 0
Train Epoch6 Acc 0.4685 (56220/120000), AUC 0.7189708948135376
ep6_train_time 8.411230308
Test Epoch6 layer0 Acc 0.48368421052631577, AUC 0.7471733689308167, avg_entr 0.4933379888534546, f1 0.4836842119693756
ep6_l0_test_time 0.11348777199999915
Test Epoch6 layer1 Acc 0.5010526315789474, AUC 0.7507423162460327, avg_entr 0.4950825572013855, f1 0.5010526180267334
ep6_l1_test_time 0.11349485299999174
Test Epoch6 layer2 Acc 0.4918421052631579, AUC 0.7396512031555176, avg_entr 0.5014780163764954, f1 0.4918420910835266
ep6_l2_test_time 0.12180634599999962
Test Epoch6 layer3 Acc 0.45105263157894737, AUC 0.716381847858429, avg_entr 0.48992085456848145, f1 0.45105263590812683
ep6_l3_test_time 0.11602379299999654
Test Epoch6 layer4 Acc 0.435, AUC 0.7143080234527588, avg_entr 0.4646041989326477, f1 0.4350000023841858
ep6_l4_test_time 0.11053420500000755
gc 0
Train Epoch7 Acc 0.47203333333333336 (56644/120000), AUC 0.7218353748321533
ep7_train_time 8.351887790999996
Test Epoch7 layer0 Acc 0.5057894736842106, AUC 0.7483325004577637, avg_entr 0.4556386172771454, f1 0.5057894587516785
ep7_l0_test_time 0.10826793300000759
Test Epoch7 layer1 Acc 0.4971052631578947, AUC 0.7513648867607117, avg_entr 0.46232813596725464, f1 0.49710527062416077
ep7_l1_test_time 0.11347763599999894
Test Epoch7 layer2 Acc 0.4921052631578947, AUC 0.7420262098312378, avg_entr 0.4615494906902313, f1 0.49210527539253235
ep7_l2_test_time 0.11696649300000672
Test Epoch7 layer3 Acc 0.46789473684210525, AUC 0.7165583968162537, avg_entr 0.44802963733673096, f1 0.4678947329521179
ep7_l3_test_time 0.11591772500000275
Test Epoch7 layer4 Acc 0.4686842105263158, AUC 0.717162549495697, avg_entr 0.4299415647983551, f1 0.46868419647216797
ep7_l4_test_time 0.1204234380000031
gc 0
Train Epoch8 Acc 0.4737 (56844/120000), AUC 0.7236800193786621
ep8_train_time 8.661085589999999
Test Epoch8 layer0 Acc 0.5063157894736842, AUC 0.7494202852249146, avg_entr 0.433291494846344, f1 0.5063157677650452
ep8_l0_test_time 0.10985201699999436
Test Epoch8 layer1 Acc 0.49394736842105263, AUC 0.7519864439964294, avg_entr 0.43771252036094666, f1 0.4939473271369934
ep8_l1_test_time 0.11291665800000317
Test Epoch8 layer2 Acc 0.4813157894736842, AUC 0.7443395853042603, avg_entr 0.43908730149269104, f1 0.4813157916069031
ep8_l2_test_time 0.11872084200000188
Test Epoch8 layer3 Acc 0.45421052631578945, AUC 0.7202891111373901, avg_entr 0.41755810379981995, f1 0.4542105197906494
ep8_l3_test_time 0.11564680499999724
Test Epoch8 layer4 Acc 0.4655263157894737, AUC 0.7196210026741028, avg_entr 0.40107545256614685, f1 0.4655263423919678
ep8_l4_test_time 0.12282548700000007
gc 0
Train Epoch9 Acc 0.4754333333333333 (57052/120000), AUC 0.7255487442016602
ep9_train_time 8.402360740000006
Test Epoch9 layer0 Acc 0.49526315789473685, AUC 0.7506011724472046, avg_entr 0.4204876720905304, f1 0.49526315927505493
ep9_l0_test_time 0.10973637400000769
Test Epoch9 layer1 Acc 0.4913157894736842, AUC 0.7526379823684692, avg_entr 0.41539981961250305, f1 0.4913157820701599
ep9_l1_test_time 0.11729046700000367
Test Epoch9 layer2 Acc 0.4839473684210526, AUC 0.7459971308708191, avg_entr 0.4266291558742523, f1 0.48394736647605896
ep9_l2_test_time 0.11439411399999244
Test Epoch9 layer3 Acc 0.4376315789473684, AUC 0.7107927203178406, avg_entr 0.4056050777435303, f1 0.4376315772533417
ep9_l3_test_time 0.11684221499999126
Test Epoch9 layer4 Acc 0.445, AUC 0.712465763092041, avg_entr 0.3885607123374939, f1 0.4449999928474426
ep9_l4_test_time 0.12056694100000698
gc 0
Train Epoch10 Acc 0.475675 (57081/120000), AUC 0.7270615100860596
ep10_train_time 9.171976630000003
Test Epoch10 layer0 Acc 0.4957894736842105, AUC 0.7515761256217957, avg_entr 0.3885739743709564, f1 0.49578946828842163
ep10_l0_test_time 0.10869431599999757
Test Epoch10 layer1 Acc 0.4971052631578947, AUC 0.7532605528831482, avg_entr 0.39902040362358093, f1 0.49710527062416077
ep10_l1_test_time 0.11224065999999766
Test Epoch10 layer2 Acc 0.48736842105263156, AUC 0.7457991242408752, avg_entr 0.4007844924926758, f1 0.4873684346675873
ep10_l2_test_time 0.11175941299998726
Test Epoch10 layer3 Acc 0.4668421052631579, AUC 0.7197952270507812, avg_entr 0.3873342275619507, f1 0.4668421447277069
ep10_l3_test_time 0.11464291400000093
Test Epoch10 layer4 Acc 0.4686842105263158, AUC 0.7175316214561462, avg_entr 0.3637326955795288, f1 0.46868419647216797
ep10_l4_test_time 0.11865883000001531
gc 0
Train Epoch11 Acc 0.479325 (57519/120000), AUC 0.728760838508606
ep11_train_time 8.918116056000002
Test Epoch11 layer0 Acc 0.5086842105263157, AUC 0.7529115080833435, avg_entr 0.3741084039211273, f1 0.5086842179298401
ep11_l0_test_time 0.1094507930000077
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 11
Test Epoch11 layer1 Acc 0.5123684210526316, AUC 0.752540647983551, avg_entr 0.38057732582092285, f1 0.5123684406280518
ep11_l1_test_time 0.11450729800000659
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 11
Test Epoch11 layer2 Acc 0.49973684210526315, AUC 0.747351348400116, avg_entr 0.38515353202819824, f1 0.49973684549331665
ep11_l2_test_time 0.11513295199998197
Test Epoch11 layer3 Acc 0.46710526315789475, AUC 0.7186485528945923, avg_entr 0.3741156756877899, f1 0.46710526943206787
ep11_l3_test_time 0.11685165299999767
Test Epoch11 layer4 Acc 0.46473684210526317, AUC 0.7191696763038635, avg_entr 0.358589768409729, f1 0.46473684906959534
ep11_l4_test_time 0.11559729499998639
gc 0
Train Epoch12 Acc 0.4784833333333333 (57418/120000), AUC 0.728491485118866
ep12_train_time 8.589847738999993
Test Epoch12 layer0 Acc 0.5121052631578947, AUC 0.7542209625244141, avg_entr 0.3519187569618225, f1 0.5121052861213684
ep12_l0_test_time 0.10806878399998254
Test Epoch12 layer1 Acc 0.511578947368421, AUC 0.7524799704551697, avg_entr 0.35973256826400757, f1 0.5115789771080017
ep12_l1_test_time 0.10788167499998735
Test Epoch12 layer2 Acc 0.4963157894736842, AUC 0.7478342056274414, avg_entr 0.3634425103664398, f1 0.49631577730178833
ep12_l2_test_time 0.118979582999998
Test Epoch12 layer3 Acc 0.4676315789473684, AUC 0.70992511510849, avg_entr 0.34998250007629395, f1 0.46763157844543457
ep12_l3_test_time 0.11863914500000305
Test Epoch12 layer4 Acc 0.4652631578947368, AUC 0.7172544002532959, avg_entr 0.3121475577354431, f1 0.46526315808296204
ep12_l4_test_time 0.12270924800000671
gc 0
Train Epoch13 Acc 0.478875 (57465/120000), AUC 0.730359673500061
ep13_train_time 8.640132960000017
Test Epoch13 layer0 Acc 0.5081578947368421, AUC 0.7560378313064575, avg_entr 0.354073166847229, f1 0.5081579089164734
ep13_l0_test_time 0.13187356699998531
Test Epoch13 layer1 Acc 0.5007894736842106, AUC 0.7516425251960754, avg_entr 0.3460386395454407, f1 0.50078946352005
ep13_l1_test_time 0.14388303100000144
Test Epoch13 layer2 Acc 0.4839473684210526, AUC 0.7426439523696899, avg_entr 0.35369014739990234, f1 0.48394736647605896
ep13_l2_test_time 0.13962463600000774
Test Epoch13 layer3 Acc 0.4631578947368421, AUC 0.7157715559005737, avg_entr 0.3289108872413635, f1 0.46315789222717285
ep13_l3_test_time 0.1469169060000013
Test Epoch13 layer4 Acc 0.46578947368421053, AUC 0.7154852747917175, avg_entr 0.3177642524242401, f1 0.46578946709632874
ep13_l4_test_time 0.15043256399999905
gc 0
Train Epoch14 Acc 0.47525833333333334 (57031/120000), AUC 0.7286936640739441
ep14_train_time 8.995631172000003
Test Epoch14 layer0 Acc 0.5139473684210526, AUC 0.7571250200271606, avg_entr 0.3366485834121704, f1 0.5139473676681519
ep14_l0_test_time 0.10910059699997987
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 14
Test Epoch14 layer1 Acc 0.5094736842105263, AUC 0.7511110901832581, avg_entr 0.3370961844921112, f1 0.5094736814498901
ep14_l1_test_time 0.11490346900001214
Test Epoch14 layer2 Acc 0.48605263157894735, AUC 0.7448512315750122, avg_entr 0.3476788103580475, f1 0.48605263233184814
ep14_l2_test_time 0.11388437900001236
Test Epoch14 layer3 Acc 0.45763157894736844, AUC 0.7169567942619324, avg_entr 0.32374414801597595, f1 0.45763158798217773
ep14_l3_test_time 0.1176939329999982
Test Epoch14 layer4 Acc 0.4523684210526316, AUC 0.7165316939353943, avg_entr 0.30721160769462585, f1 0.4523683786392212
ep14_l4_test_time 0.11570187300000612
gc 0
Train Epoch15 Acc 0.4773 (57276/120000), AUC 0.730360746383667
ep15_train_time 8.699136960000004
Test Epoch15 layer0 Acc 0.5107894736842106, AUC 0.7584486603736877, avg_entr 0.3111552894115448, f1 0.5107894539833069
ep15_l0_test_time 0.10653226099998392
Test Epoch15 layer1 Acc 0.5097368421052632, AUC 0.7505306005477905, avg_entr 0.31871524453163147, f1 0.5097368359565735
ep15_l1_test_time 0.11288047599998663
Test Epoch15 layer2 Acc 0.48447368421052633, AUC 0.7439240217208862, avg_entr 0.319242000579834, f1 0.48447367548942566
ep15_l2_test_time 0.11559293199999843
Test Epoch15 layer3 Acc 0.4713157894736842, AUC 0.7178466320037842, avg_entr 0.2973233759403229, f1 0.47131580114364624
ep15_l3_test_time 0.11803156199999876
Test Epoch15 layer4 Acc 0.46657894736842104, AUC 0.7191435098648071, avg_entr 0.2946842908859253, f1 0.46657896041870117
ep15_l4_test_time 0.11520410400001424
gc 0
Train Epoch16 Acc 0.4764333333333333 (57172/120000), AUC 0.7289199829101562
ep16_train_time 8.345530757999995
Test Epoch16 layer0 Acc 0.5094736842105263, AUC 0.760356068611145, avg_entr 0.2958492636680603, f1 0.5094736814498901
ep16_l0_test_time 0.11111787999999478
Test Epoch16 layer1 Acc 0.5044736842105263, AUC 0.7508639097213745, avg_entr 0.30965638160705566, f1 0.5044736862182617
ep16_l1_test_time 0.11340479699998696
Test Epoch16 layer2 Acc 0.4831578947368421, AUC 0.7444974184036255, avg_entr 0.31115469336509705, f1 0.4831579029560089
ep16_l2_test_time 0.10924025799999981
Test Epoch16 layer3 Acc 0.4639473684210526, AUC 0.7153380513191223, avg_entr 0.29082533717155457, f1 0.4639473557472229
ep16_l3_test_time 0.11802313499998718
Test Epoch16 layer4 Acc 0.4636842105263158, AUC 0.7178115844726562, avg_entr 0.2772352695465088, f1 0.46368420124053955
ep16_l4_test_time 0.1187874700000009
gc 0
Train Epoch17 Acc 0.4776666666666667 (57320/120000), AUC 0.7305867075920105
ep17_train_time 8.805536302000007
Test Epoch17 layer0 Acc 0.5189473684210526, AUC 0.7625590562820435, avg_entr 0.28406503796577454, f1 0.5189473628997803
ep17_l0_test_time 0.11286440599999992
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 17
Test Epoch17 layer1 Acc 0.51, AUC 0.7502760887145996, avg_entr 0.2919352948665619, f1 0.5099999904632568
ep17_l1_test_time 0.1132649720000245
Test Epoch17 layer2 Acc 0.49657894736842106, AUC 0.7457329630851746, avg_entr 0.300711065530777, f1 0.49657896161079407
ep17_l2_test_time 0.1162709399999926
Test Epoch17 layer3 Acc 0.4673684210526316, AUC 0.7168325781822205, avg_entr 0.27799704670906067, f1 0.4673684239387512
ep17_l3_test_time 0.11040970899998115
Test Epoch17 layer4 Acc 0.46657894736842104, AUC 0.7192815542221069, avg_entr 0.26058146357536316, f1 0.46657896041870117
ep17_l4_test_time 0.11935247200000276
gc 0
Train Epoch18 Acc 0.4770666666666667 (57248/120000), AUC 0.7299602031707764
ep18_train_time 8.589200015000017
Test Epoch18 layer0 Acc 0.5194736842105263, AUC 0.7642584443092346, avg_entr 0.28619661927223206, f1 0.519473671913147
ep18_l0_test_time 0.11360920199999214
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 18
Test Epoch18 layer1 Acc 0.51, AUC 0.7500619888305664, avg_entr 0.2890819013118744, f1 0.5099999904632568
ep18_l1_test_time 0.11633655999997927
Test Epoch18 layer2 Acc 0.4934210526315789, AUC 0.7454061508178711, avg_entr 0.29413411021232605, f1 0.4934210479259491
ep18_l2_test_time 0.11953890800000977
Test Epoch18 layer3 Acc 0.46657894736842104, AUC 0.7156779170036316, avg_entr 0.2658193111419678, f1 0.46657896041870117
ep18_l3_test_time 0.11332705700002066
Test Epoch18 layer4 Acc 0.4663157894736842, AUC 0.7180788516998291, avg_entr 0.2554611265659332, f1 0.4663158059120178
ep18_l4_test_time 0.12055972699999984
gc 0
Train Epoch19 Acc 0.4761 (57132/120000), AUC 0.729496955871582
ep19_train_time 8.544101877999992
Test Epoch19 layer0 Acc 0.5076315789473684, AUC 0.7660739421844482, avg_entr 0.2834646701812744, f1 0.5076315999031067
ep19_l0_test_time 0.11144744300000298
Test Epoch19 layer1 Acc 0.5068421052631579, AUC 0.7487276792526245, avg_entr 0.28010430932044983, f1 0.5068420767784119
ep19_l1_test_time 0.11641445400002226
Test Epoch19 layer2 Acc 0.4934210526315789, AUC 0.7448043823242188, avg_entr 0.28630393743515015, f1 0.4934210479259491
ep19_l2_test_time 0.11622672600000783
Test Epoch19 layer3 Acc 0.46342105263157896, AUC 0.7140505909919739, avg_entr 0.25296080112457275, f1 0.4634210467338562
ep19_l3_test_time 0.11633040899999969
Test Epoch19 layer4 Acc 0.4623684210526316, AUC 0.7162910103797913, avg_entr 0.24171295762062073, f1 0.4623684287071228
ep19_l4_test_time 0.1214422289999959
Best AUC tensor(0.5195) 18 0
train_as_loss [[4.49608653e+02 3.56189486e+02 3.50982571e+02 3.49802232e+02
  3.49350964e+02 3.49132662e+02 3.49011828e+02 3.48938877e+02
  3.48892137e+02 3.48860870e+02 3.48839278e+02 3.48824007e+02
  3.48813005e+02 3.48804959e+02 3.48799015e+02 3.48794572e+02
  3.48791242e+02 3.48788729e+02 3.48786810e+02 3.48785343e+02]
 [1.71820050e+00 1.43059034e-05 9.91335753e-07 1.95719937e-07
  5.81969832e-08 2.18189007e-08 1.95334461e-06 2.23376207e-05
  8.67415899e-05 1.19286419e-04 2.56575465e-04 2.95522787e-04
  6.11585130e-04 4.30920550e-04 5.67130521e-04 1.74527697e-08
  7.80581935e-10 4.94193240e-09 1.98280510e-04 3.25244002e-06]
 [2.12948355e+00 1.41832811e-05 1.02729701e-06 2.18961338e-07
  7.01863497e-08 2.25504372e-07 3.90545404e-06 5.57571353e-05
  2.56637693e-04 2.87561710e-04 6.48107783e-04 8.51833266e-04
  1.59778450e-03 6.79980771e-04 1.38169744e-03 1.50011615e-07
  2.47368808e-04 5.45383766e-07 2.56387808e-04 3.14037678e-05]
 [1.82972229e+00 9.55525324e-06 8.23694463e-07 2.21370029e-07
  9.02199463e-08 5.91188980e-08 2.86226254e-06 1.04626353e-04
  5.46920606e-04 6.05287911e-04 1.15521606e-03 1.56682186e-03
  2.53449667e-03 3.62500417e-04 7.72649399e-04 1.84505402e-07
  1.40060084e-04 3.01450946e-07 1.61032297e-04 6.12588542e-05]
 [1.74310152e+00 8.45779108e-06 9.16209013e-07 3.79540776e-07
  2.10501997e-07 1.77069413e-07 3.54611832e-06 1.58595942e-04
  9.28273500e-04 9.99923949e-04 1.61637798e-03 2.33831535e-03
  3.44496314e-03 3.03318115e-04 7.10707455e-04 2.42403102e-07
  1.54494523e-04 3.48564456e-07 1.45742357e-04 1.27286097e-04]]
train_ae_loss [[17.8367818  24.88825049 29.06365182 32.18056954 34.63810062 36.60090808
  38.38887015 39.97147512 41.3865873  42.69928278 43.84588133 45.04107574
  46.14103125 47.25686116 48.30959404 49.15881032 50.14000673 51.0309632
  51.90969753 52.8343952 ]
 [18.6173082  24.91758263 28.2223898  30.33793774 32.04243305 33.35465223
  34.58321702 35.67822544 36.72357117 37.63076478 38.47577269 39.25736446
  40.11868161 41.012738   41.7273619  42.023962   42.7964683  43.55820096
  44.19985563 44.7217604 ]
 [16.81186182 21.56536531 23.93245571 25.34810507 26.40075159 27.24860189
  27.97059122 28.63188372 29.35137593 29.8909613  30.52280227 31.00982544
  31.66782679 32.30407176 32.88930884 33.16334748 33.71378511 33.79169193
  34.22319871 34.69601456]
 [13.98185917 20.29083853 22.55252547 23.79090823 24.68508603 25.40707935
  26.02952784 26.61656864 27.21659952 27.74718848 28.28121551 28.77943549
  29.35701563 29.70689535 30.22710953 30.53933325 30.93161736 31.15355482
  31.49694296 31.81015125]
 [11.90113292 19.28052501 21.40173522 22.42091436 23.13899548 23.74676766
  24.24842525 24.74782392 25.21873793 25.65451328 26.06474085 26.46995411
  26.86374078 27.08699293 27.5769948  27.85720167 28.21753133 28.37991541
  28.68623276 28.95610033]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 194.829073219
Start Testing
Load ckpt at ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt
gc 10
Test layer0 Acc 0.5097368421052632, AUC 0.7592806816101074, avg_entr 0.2829500436782837, f1 0.5097368359565735
l0_test_time 0.10521933800001193
gc 0
Test layer1 Acc 0.4978947368421053, AUC 0.7391590476036072, avg_entr 0.2874525487422943, f1 0.4978947341442108
l1_test_time 0.11172287200000142
gc 0
Test layer2 Acc 0.48710526315789476, AUC 0.7350656986236572, avg_entr 0.292199969291687, f1 0.48710522055625916
l2_test_time 0.11614393700000392
gc 0
Test layer3 Acc 0.46342105263157896, AUC 0.7126448154449463, avg_entr 0.269601047039032, f1 0.4634210467338562
l3_test_time 0.12221628200001078
gc 0
Test layer4 Acc 0.45289473684210524, AUC 0.7128720283508301, avg_entr 0.26129814982414246, f1 0.45289474725723267
l4_test_time 0.11899679100000071
gc 0
Test threshold 0.1 Acc 0.5128947368421053, AUC 0.7571942806243896, avg_entr 0.13504917919635773, f1 0.5128947496414185
t0.1_test_time 0.22115936000000147
gc 0
Test threshold 0.2 Acc 0.5239473684210526, AUC 0.7627842426300049, avg_entr 0.12714022397994995, f1 0.5239473581314087
t0.2_test_time 0.19041575800000032
gc 0
Test threshold 0.3 Acc 0.5207894736842106, AUC 0.7608858346939087, avg_entr 0.16415096819400787, f1 0.5207894444465637
t0.3_test_time 0.16305904499998292
gc 0
Test threshold 0.4 Acc 0.5147368421052632, AUC 0.7591488361358643, avg_entr 0.18917128443717957, f1 0.5147368311882019
t0.4_test_time 0.15534081299998093
gc 0
Test threshold 0.5 Acc 0.5110526315789473, AUC 0.7594817876815796, avg_entr 0.20082129538059235, f1 0.5110526084899902
t0.5_test_time 0.14596749500000783
gc 0
Test threshold 0.6 Acc 0.51, AUC 0.7593387365341187, avg_entr 0.20400813221931458, f1 0.5099999904632568
t0.6_test_time 0.13657750500001953
gc 0
Test threshold 0.7 Acc 0.5097368421052632, AUC 0.7592806816101074, avg_entr 0.20410530269145966, f1 0.5097368359565735
t0.7_test_time 0.13847758200000726
gc 0
Test threshold 0.8 Acc 0.5097368421052632, AUC 0.7592806816101074, avg_entr 0.20410530269145966, f1 0.5097368359565735
t0.8_test_time 0.13577761700000224
gc 0
Test threshold 0.9 Acc 0.5097368421052632, AUC 0.7592806816101074, avg_entr 0.20410530269145966, f1 0.5097368359565735
t0.9_test_time 0.13406625800001848
