total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearALsideText(
  (layers): ModuleList(
    (0): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.0.weight 90000
layers.0.enc.f.0.bias 300
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 45777392
init_time 25.10375717
Start Training
gc 0
Train Epoch0 Acc 0.282425 (33891/120000), AUC 0.5170855522155762
ep0_train_time 9.798650093
Test Epoch0 layer0 Acc 0.3923684210526316, AUC 0.6858421564102173, avg_entr 1.1965404748916626, f1 0.3923684358596802
ep0_l0_test_time 0.11387661199999854
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.36157894736842106, AUC 0.6526973247528076, avg_entr 1.1997407674789429, f1 0.36157894134521484
ep0_l1_test_time 0.11680273400000374
Test Epoch0 layer2 Acc 0.34921052631578947, AUC 0.6162446737289429, avg_entr 1.2012392282485962, f1 0.3492105305194855
ep0_l2_test_time 0.11365739600000069
Test Epoch0 layer3 Acc 0.33210526315789474, AUC 0.592076301574707, avg_entr 1.2107133865356445, f1 0.33210524916648865
ep0_l3_test_time 0.12067034700000079
Test Epoch0 layer4 Acc 0.30473684210526314, AUC 0.5784395337104797, avg_entr 1.210220217704773, f1 0.304736852645874
ep0_l4_test_time 0.11908663499999506
gc 0
Train Epoch1 Acc 0.3371166666666667 (40454/120000), AUC 0.5937317609786987
ep1_train_time 9.943835141999998
Test Epoch1 layer0 Acc 0.4918421052631579, AUC 0.7322889566421509, avg_entr 0.8611525297164917, f1 0.4918420910835266
ep1_l0_test_time 0.10581380200000012
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.4610526315789474, AUC 0.7157358527183533, avg_entr 0.872255265712738, f1 0.46105262637138367
ep1_l1_test_time 0.11518493700000221
Test Epoch1 layer2 Acc 0.4168421052631579, AUC 0.6781734228134155, avg_entr 0.8963515162467957, f1 0.41684210300445557
ep1_l2_test_time 0.11151254500000363
Test Epoch1 layer3 Acc 0.3773684210526316, AUC 0.6403263807296753, avg_entr 0.8908714056015015, f1 0.37736842036247253
ep1_l3_test_time 0.11737736799999965
Test Epoch1 layer4 Acc 0.3663157894736842, AUC 0.6352685689926147, avg_entr 0.8891752362251282, f1 0.3663157820701599
ep1_l4_test_time 0.11802869000000271
gc 0
Train Epoch2 Acc 0.4038 (48456/120000), AUC 0.6603200435638428
ep2_train_time 8.531671009
Test Epoch2 layer0 Acc 0.49842105263157893, AUC 0.7420920133590698, avg_entr 0.7060160636901855, f1 0.4984210431575775
ep2_l0_test_time 0.1140160320000021
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.4918421052631579, AUC 0.7330948114395142, avg_entr 0.7181124091148376, f1 0.4918420910835266
ep2_l1_test_time 0.11329668200000498
Test Epoch2 layer2 Acc 0.4523684210526316, AUC 0.7077702879905701, avg_entr 0.7317768335342407, f1 0.4523683786392212
ep2_l2_test_time 0.11637647999999956
Test Epoch2 layer3 Acc 0.43105263157894735, AUC 0.682409405708313, avg_entr 0.7213841676712036, f1 0.43105262517929077
ep2_l3_test_time 0.12176489299999815
Test Epoch2 layer4 Acc 0.41736842105263156, AUC 0.6765475869178772, avg_entr 0.7221797704696655, f1 0.41736841201782227
ep2_l4_test_time 0.11934101399999975
gc 0
Train Epoch3 Acc 0.44300833333333334 (53161/120000), AUC 0.6937735080718994
ep3_train_time 8.336553390000006
Test Epoch3 layer0 Acc 0.4839473684210526, AUC 0.7457029819488525, avg_entr 0.6037663221359253, f1 0.48394736647605896
ep3_l0_test_time 0.10901573499999984
Test Epoch3 layer1 Acc 0.4557894736842105, AUC 0.7374204397201538, avg_entr 0.6100382208824158, f1 0.4557894766330719
ep3_l1_test_time 0.11633719200000314
Test Epoch3 layer2 Acc 0.4618421052631579, AUC 0.720718264579773, avg_entr 0.6252049207687378, f1 0.4618421196937561
ep3_l2_test_time 0.11838244499999462
Test Epoch3 layer3 Acc 0.4313157894736842, AUC 0.6985412836074829, avg_entr 0.6237828731536865, f1 0.4313158094882965
ep3_l3_test_time 0.11004223300000149
Test Epoch3 layer4 Acc 0.42789473684210527, AUC 0.6978005766868591, avg_entr 0.6179087162017822, f1 0.4278947412967682
ep3_l4_test_time 0.12085541000000433
gc 0
Train Epoch4 Acc 0.4577833333333333 (54934/120000), AUC 0.7080959677696228
ep4_train_time 8.370442530000005
Test Epoch4 layer0 Acc 0.5002631578947369, AUC 0.7473312616348267, avg_entr 0.570357084274292, f1 0.5002631545066833
ep4_l0_test_time 0.10932086500000082
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 4
Test Epoch4 layer1 Acc 0.4994736842105263, AUC 0.7410672903060913, avg_entr 0.5822227001190186, f1 0.4994736909866333
ep4_l1_test_time 0.113403224999999
Test Epoch4 layer2 Acc 0.4689473684210526, AUC 0.7223986983299255, avg_entr 0.5958243012428284, f1 0.4689473807811737
ep4_l2_test_time 0.11588148500000273
Test Epoch4 layer3 Acc 0.455, AUC 0.7024387717247009, avg_entr 0.5808472037315369, f1 0.45500001311302185
ep4_l3_test_time 0.11536510900000962
Test Epoch4 layer4 Acc 0.4481578947368421, AUC 0.7026882767677307, avg_entr 0.5799120664596558, f1 0.4481579065322876
ep4_l4_test_time 0.1241274979999929
gc 0
Train Epoch5 Acc 0.46605 (55926/120000), AUC 0.7156938910484314
ep5_train_time 8.513065943
Test Epoch5 layer0 Acc 0.51, AUC 0.748428225517273, avg_entr 0.5185503363609314, f1 0.5099999904632568
ep5_l0_test_time 0.11242605500000025
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.5010526315789474, AUC 0.7437542676925659, avg_entr 0.5340527892112732, f1 0.5010526180267334
ep5_l1_test_time 0.11259780999999691
Test Epoch5 layer2 Acc 0.48157894736842105, AUC 0.7289571762084961, avg_entr 0.5360720157623291, f1 0.4815789461135864
ep5_l2_test_time 0.11933332099999916
Test Epoch5 layer3 Acc 0.4573684210526316, AUC 0.7060471773147583, avg_entr 0.5256756544113159, f1 0.4573684334754944
ep5_l3_test_time 0.11372360599999354
Test Epoch5 layer4 Acc 0.4478947368421053, AUC 0.7059498429298401, avg_entr 0.5085092186927795, f1 0.44789472222328186
ep5_l4_test_time 0.1212546729999957
gc 0
Train Epoch6 Acc 0.4668583333333333 (56023/120000), AUC 0.7187492847442627
ep6_train_time 8.483677994999994
Test Epoch6 layer0 Acc 0.4968421052631579, AUC 0.7500717639923096, avg_entr 0.4903219938278198, f1 0.4968421161174774
ep6_l0_test_time 0.11002248399999814
Test Epoch6 layer1 Acc 0.4876315789473684, AUC 0.7454056739807129, avg_entr 0.4879347085952759, f1 0.48763158917427063
ep6_l1_test_time 0.11687976100000697
Test Epoch6 layer2 Acc 0.47210526315789475, AUC 0.7336920499801636, avg_entr 0.48204338550567627, f1 0.4721052348613739
ep6_l2_test_time 0.10578560600001197
Test Epoch6 layer3 Acc 0.4531578947368421, AUC 0.7110737562179565, avg_entr 0.47298088669776917, f1 0.453157901763916
ep6_l3_test_time 0.11756358699999225
Test Epoch6 layer4 Acc 0.4531578947368421, AUC 0.7124106884002686, avg_entr 0.45548203587532043, f1 0.453157901763916
ep6_l4_test_time 0.11597171100000025
gc 0
Train Epoch7 Acc 0.46941666666666665 (56330/120000), AUC 0.7213413119316101
ep7_train_time 8.340635922000004
Test Epoch7 layer0 Acc 0.5068421052631579, AUC 0.7509035468101501, avg_entr 0.45618370175361633, f1 0.5068420767784119
ep7_l0_test_time 0.13246824899999865
Test Epoch7 layer1 Acc 0.4994736842105263, AUC 0.7448973655700684, avg_entr 0.47097527980804443, f1 0.4994736909866333
ep7_l1_test_time 0.13989519300000097
Test Epoch7 layer2 Acc 0.49026315789473685, AUC 0.7314119338989258, avg_entr 0.47456786036491394, f1 0.4902631640434265
ep7_l2_test_time 0.14235957899998652
Test Epoch7 layer3 Acc 0.45, AUC 0.7064879536628723, avg_entr 0.45746293663978577, f1 0.44999998807907104
ep7_l3_test_time 0.14790668099999493
Test Epoch7 layer4 Acc 0.45, AUC 0.7115570902824402, avg_entr 0.4391253590583801, f1 0.44999998807907104
ep7_l4_test_time 0.15092359199999805
gc 0
Train Epoch8 Acc 0.46908333333333335 (56290/120000), AUC 0.7212767601013184
ep8_train_time 8.802123608000002
Test Epoch8 layer0 Acc 0.5089473684210526, AUC 0.7520161867141724, avg_entr 0.434619277715683, f1 0.5089473724365234
ep8_l0_test_time 0.1100157809999871
Test Epoch8 layer1 Acc 0.48789473684210527, AUC 0.7451639175415039, avg_entr 0.44397440552711487, f1 0.487894743680954
ep8_l1_test_time 0.11301772299999868
Test Epoch8 layer2 Acc 0.46289473684210525, AUC 0.7275298237800598, avg_entr 0.4411364793777466, f1 0.4628947675228119
ep8_l2_test_time 0.11646192999999982
Test Epoch8 layer3 Acc 0.45105263157894737, AUC 0.6995381116867065, avg_entr 0.4361238181591034, f1 0.45105263590812683
ep8_l3_test_time 0.11711609700000736
Test Epoch8 layer4 Acc 0.45105263157894737, AUC 0.7090315818786621, avg_entr 0.4104684293270111, f1 0.45105263590812683
ep8_l4_test_time 0.12281443299998784
gc 0
Train Epoch9 Acc 0.47010833333333335 (56413/120000), AUC 0.7228419780731201
ep9_train_time 8.731120540999996
Test Epoch9 layer0 Acc 0.5086842105263157, AUC 0.7534372806549072, avg_entr 0.4070788323879242, f1 0.5086842179298401
ep9_l0_test_time 0.13200335000000507
Test Epoch9 layer1 Acc 0.5018421052631579, AUC 0.7463248372077942, avg_entr 0.41534334421157837, f1 0.5018420815467834
ep9_l1_test_time 0.14345058899999685
Test Epoch9 layer2 Acc 0.4868421052631579, AUC 0.7325172424316406, avg_entr 0.4192599058151245, f1 0.4868420958518982
ep9_l2_test_time 0.14510680000000775
Test Epoch9 layer3 Acc 0.45289473684210524, AUC 0.7074191570281982, avg_entr 0.4010106027126312, f1 0.45289474725723267
ep9_l3_test_time 0.14512084400000447
Test Epoch9 layer4 Acc 0.44921052631578945, AUC 0.7131844162940979, avg_entr 0.38975000381469727, f1 0.449210524559021
ep9_l4_test_time 0.15256963699999915
gc 0
Train Epoch10 Acc 0.4690166666666667 (56282/120000), AUC 0.7221470475196838
ep10_train_time 8.629825372000013
Test Epoch10 layer0 Acc 0.4957894736842105, AUC 0.7540450096130371, avg_entr 0.38401147723197937, f1 0.49578946828842163
ep10_l0_test_time 0.11043825300001231
Test Epoch10 layer1 Acc 0.4884210526315789, AUC 0.7460129857063293, avg_entr 0.4100608229637146, f1 0.4884210526943207
ep10_l1_test_time 0.11325221200002034
Test Epoch10 layer2 Acc 0.465, AUC 0.7313441038131714, avg_entr 0.40067070722579956, f1 0.4650000035762787
ep10_l2_test_time 0.11114420900000255
Test Epoch10 layer3 Acc 0.45657894736842103, AUC 0.7090296149253845, avg_entr 0.3841065466403961, f1 0.45657894015312195
ep10_l3_test_time 0.11530581700000653
Test Epoch10 layer4 Acc 0.45789473684210524, AUC 0.710248589515686, avg_entr 0.3497377634048462, f1 0.4578947424888611
ep10_l4_test_time 0.11666498600001773
gc 0
Train Epoch11 Acc 0.47175833333333334 (56611/120000), AUC 0.7242586016654968
ep11_train_time 8.465128442999998
Test Epoch11 layer0 Acc 0.5184210526315789, AUC 0.7556362748146057, avg_entr 0.3706512749195099, f1 0.5184210538864136
ep11_l0_test_time 0.10995821099999148
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 11
Test Epoch11 layer1 Acc 0.5031578947368421, AUC 0.7467742562294006, avg_entr 0.39136582612991333, f1 0.503157913684845
ep11_l1_test_time 0.11446624900000302
Test Epoch11 layer2 Acc 0.48105263157894734, AUC 0.7269753217697144, avg_entr 0.38523516058921814, f1 0.4810526371002197
ep11_l2_test_time 0.11580693300001599
Test Epoch11 layer3 Acc 0.4610526315789474, AUC 0.7047348022460938, avg_entr 0.36569324135780334, f1 0.46105262637138367
ep11_l3_test_time 0.11943006300001002
Test Epoch11 layer4 Acc 0.45763157894736844, AUC 0.7067699432373047, avg_entr 0.34989404678344727, f1 0.45763158798217773
ep11_l4_test_time 0.1187311589999922
gc 0
Train Epoch12 Acc 0.47158333333333335 (56590/120000), AUC 0.7243520021438599
ep12_train_time 9.460495361
Test Epoch12 layer0 Acc 0.5005263157894737, AUC 0.7564027905464172, avg_entr 0.3475096821784973, f1 0.5005263090133667
ep12_l0_test_time 0.10973056399998882
Test Epoch12 layer1 Acc 0.4926315789473684, AUC 0.7478514909744263, avg_entr 0.37040168046951294, f1 0.49263158440589905
ep12_l1_test_time 0.11417698600001813
Test Epoch12 layer2 Acc 0.48736842105263156, AUC 0.7319358587265015, avg_entr 0.3609091639518738, f1 0.4873684346675873
ep12_l2_test_time 0.11769146000000319
Test Epoch12 layer3 Acc 0.4568421052631579, AUC 0.7082382440567017, avg_entr 0.3478758931159973, f1 0.4568420946598053
ep12_l3_test_time 0.11662066799999593
Test Epoch12 layer4 Acc 0.4507894736842105, AUC 0.7127619385719299, avg_entr 0.2815244197845459, f1 0.4507894814014435
ep12_l4_test_time 0.11974597900001527
gc 0
Train Epoch13 Acc 0.4690416666666667 (56285/120000), AUC 0.7228853702545166
ep13_train_time 9.021063757999997
Test Epoch13 layer0 Acc 0.508421052631579, AUC 0.7578254342079163, avg_entr 0.32907724380493164, f1 0.5084210634231567
ep13_l0_test_time 0.11085315200000423
Test Epoch13 layer1 Acc 0.5086842105263157, AUC 0.7487976551055908, avg_entr 0.352289080619812, f1 0.5086842179298401
ep13_l1_test_time 0.11511417299999493
Test Epoch13 layer2 Acc 0.48657894736842106, AUC 0.7304223775863647, avg_entr 0.3504876494407654, f1 0.48657894134521484
ep13_l2_test_time 0.11338194600000406
Test Epoch13 layer3 Acc 0.45763157894736844, AUC 0.7045103311538696, avg_entr 0.3325723111629486, f1 0.45763158798217773
ep13_l3_test_time 0.11915776099999675
Test Epoch13 layer4 Acc 0.45526315789473687, AUC 0.7098438739776611, avg_entr 0.2978617250919342, f1 0.4552631676197052
ep13_l4_test_time 0.12011251900000275
gc 0
Train Epoch14 Acc 0.47163333333333335 (56596/120000), AUC 0.7258431315422058
ep14_train_time 8.411464488000007
Test Epoch14 layer0 Acc 0.5184210526315789, AUC 0.7594345211982727, avg_entr 0.3186316192150116, f1 0.5184210538864136
ep14_l0_test_time 0.11673465399999827
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 14
Test Epoch14 layer1 Acc 0.501578947368421, AUC 0.7485531568527222, avg_entr 0.3309241235256195, f1 0.5015789270401001
ep14_l1_test_time 0.11947229800000514
Test Epoch14 layer2 Acc 0.4855263157894737, AUC 0.729332685470581, avg_entr 0.3412785828113556, f1 0.48552632331848145
ep14_l2_test_time 0.12119823199998336
Test Epoch14 layer3 Acc 0.4573684210526316, AUC 0.7061234712600708, avg_entr 0.32852843403816223, f1 0.4573684334754944
ep14_l3_test_time 0.12335322900000278
Test Epoch14 layer4 Acc 0.4518421052631579, AUC 0.7101163268089294, avg_entr 0.3043147623538971, f1 0.4518420994281769
ep14_l4_test_time 0.12292767700000695
gc 0
Train Epoch15 Acc 0.4706 (56472/120000), AUC 0.7252453565597534
ep15_train_time 10.188877896999998
Test Epoch15 layer0 Acc 0.44552631578947366, AUC 0.7605147361755371, avg_entr 0.3268604278564453, f1 0.4455263018608093
ep15_l0_test_time 0.11381467299997894
Test Epoch15 layer1 Acc 0.4639473684210526, AUC 0.7505189776420593, avg_entr 0.3314291536808014, f1 0.4639473557472229
ep15_l1_test_time 0.11475596900001506
Test Epoch15 layer2 Acc 0.48026315789473684, AUC 0.7315928936004639, avg_entr 0.3223037123680115, f1 0.4802631437778473
ep15_l2_test_time 0.10980199200000129
Test Epoch15 layer3 Acc 0.45394736842105265, AUC 0.707200288772583, avg_entr 0.30282333493232727, f1 0.45394739508628845
ep15_l3_test_time 0.11695844199999783
Test Epoch15 layer4 Acc 0.4494736842105263, AUC 0.7107167840003967, avg_entr 0.2848850190639496, f1 0.44947367906570435
ep15_l4_test_time 0.1188051400000063
gc 0
Train Epoch16 Acc 0.469675 (56361/120000), AUC 0.7241439819335938
ep16_train_time 8.422980496000008
Test Epoch16 layer0 Acc 0.5152631578947369, AUC 0.7618452906608582, avg_entr 0.29244130849838257, f1 0.5152631402015686
ep16_l0_test_time 0.11052382500000135
Test Epoch16 layer1 Acc 0.4957894736842105, AUC 0.7505204677581787, avg_entr 0.30025985836982727, f1 0.49578946828842163
ep16_l1_test_time 0.1152749230000154
Test Epoch16 layer2 Acc 0.47710526315789475, AUC 0.7281473875045776, avg_entr 0.31956207752227783, f1 0.4771052598953247
ep16_l2_test_time 0.11405550100002415
Test Epoch16 layer3 Acc 0.45631578947368423, AUC 0.7056984901428223, avg_entr 0.2950042486190796, f1 0.4563157856464386
ep16_l3_test_time 0.12172844299999497
Test Epoch16 layer4 Acc 0.44394736842105265, AUC 0.7087507843971252, avg_entr 0.2846360504627228, f1 0.44394737482070923
ep16_l4_test_time 0.11757363300000634
gc 0
Train Epoch17 Acc 0.4681916666666667 (56183/120000), AUC 0.7229276895523071
ep17_train_time 8.605106132000003
Test Epoch17 layer0 Acc 0.5036842105263157, AUC 0.7633320689201355, avg_entr 0.2816191613674164, f1 0.5036842226982117
ep17_l0_test_time 0.11143262499999196
Test Epoch17 layer1 Acc 0.5, AUC 0.7511013150215149, avg_entr 0.30378952622413635, f1 0.5
ep17_l1_test_time 0.11627562600000374
Test Epoch17 layer2 Acc 0.4781578947368421, AUC 0.7266045212745667, avg_entr 0.30376917123794556, f1 0.4781579077243805
ep17_l2_test_time 0.11649298300000055
Test Epoch17 layer3 Acc 0.45, AUC 0.7039669752120972, avg_entr 0.285378634929657, f1 0.44999998807907104
ep17_l3_test_time 0.11949735799998962
Test Epoch17 layer4 Acc 0.45421052631578945, AUC 0.707904577255249, avg_entr 0.264413058757782, f1 0.4542105197906494
ep17_l4_test_time 0.11951012700001229
gc 0
Train Epoch18 Acc 0.4677 (56124/120000), AUC 0.7241629958152771
ep18_train_time 8.558656420999995
Test Epoch18 layer0 Acc 0.5242105263157895, AUC 0.7648577690124512, avg_entr 0.2708333730697632, f1 0.524210512638092
ep18_l0_test_time 0.110126858000001
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 18
Test Epoch18 layer1 Acc 0.5128947368421053, AUC 0.7529095411300659, avg_entr 0.28566092252731323, f1 0.5128947496414185
ep18_l1_test_time 0.11316819000001033
Test Epoch18 layer2 Acc 0.4789473684210526, AUC 0.7242859601974487, avg_entr 0.295116662979126, f1 0.47894737124443054
ep18_l2_test_time 0.11487231099999917
Test Epoch18 layer3 Acc 0.4568421052631579, AUC 0.7019495964050293, avg_entr 0.27042245864868164, f1 0.4568420946598053
ep18_l3_test_time 0.11825831500001982
Test Epoch18 layer4 Acc 0.45263157894736844, AUC 0.7053807377815247, avg_entr 0.24603940546512604, f1 0.4526315927505493
ep18_l4_test_time 0.11724793900000918
gc 0
Train Epoch19 Acc 0.47005 (56406/120000), AUC 0.7243421077728271
ep19_train_time 8.475207914999999
Test Epoch19 layer0 Acc 0.5292105263157895, AUC 0.7662991285324097, avg_entr 0.2646673619747162, f1 0.5292105078697205
ep19_l0_test_time 0.11233935799998562
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 19
Test Epoch19 layer1 Acc 0.5057894736842106, AUC 0.7534623146057129, avg_entr 0.2782156467437744, f1 0.5057894587516785
ep19_l1_test_time 0.11569947200001707
Test Epoch19 layer2 Acc 0.48078947368421054, AUC 0.7253642082214355, avg_entr 0.2888549268245697, f1 0.4807894825935364
ep19_l2_test_time 0.11575793399998702
Test Epoch19 layer3 Acc 0.4586842105263158, AUC 0.7019200921058655, avg_entr 0.26466742157936096, f1 0.45868417620658875
ep19_l3_test_time 0.11641303999999764
Test Epoch19 layer4 Acc 0.45473684210526316, AUC 0.7052452564239502, avg_entr 0.24029628932476044, f1 0.4547368288040161
ep19_l4_test_time 0.1195740719999776
Best AUC tensor(0.5292) 19 0
train_as_loss [[4.47509299e+02 3.56171129e+02 3.50998140e+02 3.49813100e+02
  3.49357976e+02 3.49137264e+02 3.49014916e+02 3.48940997e+02
  3.48893612e+02 3.48861908e+02 3.48840012e+02 3.48824529e+02
  3.48813372e+02 3.48805224e+02 3.48799200e+02 3.48794707e+02
  3.48791337e+02 3.48788806e+02 3.48786853e+02 3.48785378e+02]
 [1.59477915e+00 1.45544678e-05 9.88934334e-07 1.93635062e-07
  5.90148702e-08 2.23145960e-08 4.79485186e-06 4.71163159e-05
  1.32799667e-04 1.76642728e-04 3.14446326e-04 3.71771349e-04
  3.90371494e-04 4.76045167e-04 6.64668744e-04 4.10848618e-04
  6.11766218e-04 7.40695902e-04 5.93312208e-04 6.42604138e-04]
 [1.59636935e+00 1.79340536e-05 1.30825919e-06 2.72740557e-07
  9.21517818e-08 3.87482131e-08 7.75624298e-06 9.56859413e-05
  2.95450110e-04 4.29813834e-04 5.75653555e-04 1.85092355e-04
  2.08623724e-04 2.97228020e-04 4.38969224e-04 1.52740184e-04
  2.29584970e-04 2.88676352e-04 2.48370361e-04 1.95320638e-04]
 [1.91571515e+00 1.74132906e-05 1.46354674e-06 3.69355616e-07
  1.62704849e-07 8.75002133e-08 8.50671145e-06 1.43871697e-04
  4.46032067e-04 7.14753933e-04 8.72681575e-04 1.73380138e-04
  1.85805024e-04 3.01469584e-04 4.67821842e-04 1.31065525e-04
  1.89645530e-04 2.57349068e-04 2.34297107e-04 1.64144820e-04]
 [1.85628058e+00 1.96588541e-05 2.07831387e-06 7.46575239e-07
  4.93811141e-07 3.31205159e-07 9.86661233e-06 2.75149730e-04
  8.07049140e-04 1.26454769e-03 1.43702644e-03 4.91479048e-04
  4.01584137e-04 9.11139713e-04 4.48402773e-04 1.53349477e-04
  2.46944941e-04 4.02403651e-04 2.13709264e-04 1.69662327e-04]]
train_ae_loss [[18.17597613 24.77613077 28.91301189 31.97595437 34.36748235 36.30001833
  38.15773598 39.7282581  41.16239244 42.31264488 43.69391083 44.85621444
  45.98696961 47.05068447 48.00255853 49.05580223 50.07760557 51.03703519
  51.9219302  52.64914372]
 [17.54461161 23.05281672 26.14398795 28.25872961 30.05651464 31.39910605
  32.77688487 33.92598236 34.94637405 35.72944716 36.66530762 37.56798369
  38.27861832 39.01519671 39.57658447 40.19792133 40.91036858 41.43497317
  41.96179252 42.24872197]
 [16.48880946 22.08336561 24.57941869 26.10248425 27.35975898 28.3364405
  29.31766121 30.1872112  30.98652088 31.63732813 32.33321384 32.71381046
  33.37705555 34.01477525 34.53227851 34.94565617 35.52161083 36.04705917
  36.47851889 36.84166315]
 [14.22552076 21.43952225 23.82007673 25.0882143  26.11481078 26.97026982
  27.78542152 28.50188885 29.18008016 29.76591143 30.39051114 30.71329692
  31.2322254  31.76783589 32.17924806 32.50739369 32.96674686 33.3729592
  33.72584647 34.00004245]
 [12.37018573 20.32680837 22.48848081 23.45518731 24.15700731 24.75810596
  25.38008567 25.90426061 26.46144873 26.91058584 27.39362404 27.6919197
  28.0812216  28.47737823 28.61416562 28.91241799 29.2850311  29.60517186
  29.78467762 30.02657345]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 192.648170556
Start Testing
Load ckpt at ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt
gc 10
Test layer0 Acc 0.5263157894736842, AUC 0.759192705154419, avg_entr 0.2631891071796417, f1 0.5263158082962036
l0_test_time 0.11409971999998447
gc 0
Test layer1 Acc 0.4942105263157895, AUC 0.7387021780014038, avg_entr 0.27955546975135803, f1 0.49421051144599915
l1_test_time 0.1076479010000071
gc 0
Test layer2 Acc 0.4813157894736842, AUC 0.7291154265403748, avg_entr 0.2920251786708832, f1 0.4813157916069031
l2_test_time 0.12081160700000737
gc 0
Test layer3 Acc 0.45710526315789474, AUC 0.7099828720092773, avg_entr 0.2694048583507538, f1 0.45710524916648865
l3_test_time 0.11943115299999363
gc 0
Test layer4 Acc 0.4515789473684211, AUC 0.7092720866203308, avg_entr 0.2432747334241867, f1 0.45157894492149353
l4_test_time 0.11325824499999726
gc 0
Test threshold 0.1 Acc 0.5094736842105263, AUC 0.7603869438171387, avg_entr 0.12449340522289276, f1 0.5094736814498901
t0.1_test_time 0.22060204799998928
gc 0
Test threshold 0.2 Acc 0.5278947368421053, AUC 0.7644649147987366, avg_entr 0.12354923784732819, f1 0.5278947353363037
t0.2_test_time 0.1891160790000015
gc 0
Test threshold 0.3 Acc 0.5292105263157895, AUC 0.7591946125030518, avg_entr 0.15946684777736664, f1 0.5292105078697205
t0.3_test_time 0.17002486199999112
gc 0
Test threshold 0.4 Acc 0.5276315789473685, AUC 0.7591909766197205, avg_entr 0.18020014464855194, f1 0.5276315808296204
t0.4_test_time 0.15791387199999463
gc 0
Test threshold 0.5 Acc 0.5271052631578947, AUC 0.7595415115356445, avg_entr 0.18776935338974, f1 0.5271052718162537
t0.5_test_time 0.13262802699998133
gc 0
Test threshold 0.6 Acc 0.5260526315789473, AUC 0.759162962436676, avg_entr 0.18972449004650116, f1 0.5260526537895203
t0.6_test_time 0.13923651800001835
gc 0
Test threshold 0.7 Acc 0.5263157894736842, AUC 0.759192705154419, avg_entr 0.1898508220911026, f1 0.5263158082962036
t0.7_test_time 0.13630349799998953
gc 0
Test threshold 0.8 Acc 0.5263157894736842, AUC 0.759192705154419, avg_entr 0.1898508220911026, f1 0.5263158082962036
t0.8_test_time 0.12935874499999045
gc 0
Test threshold 0.9 Acc 0.5263157894736842, AUC 0.759192705154419, avg_entr 0.1898508220911026, f1 0.5263158082962036
t0.9_test_time 0.137161328000019
