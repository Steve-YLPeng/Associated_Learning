total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearALsideText(
  (layers): ModuleList(
    (0): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
  (emb_layers): ModuleList(
    (0): Embedding(30000, 300)
    (1): Embedding(30000, 300)
    (2): Embedding(30000, 300)
    (3): Embedding(30000, 300)
    (4): Embedding(30000, 300)
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.0.weight 90000
layers.0.enc.f.0.bias 300
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
emb_layers.0.weight 9000000
emb_layers.1.weight 9000000
emb_layers.2.weight 9000000
emb_layers.3.weight 9000000
emb_layers.4.weight 9000000
Total Trainable Params: 45777392
init_time 25.72606906
Start Training
gc 0
Train Epoch0 Acc 0.28595 (34314/120000), AUC 0.5180923938751221
ep0_train_time 12.653704414
Test Epoch0 layer0 Acc 0.36947368421052634, AUC 0.6740245223045349, avg_entr 1.223880648612976, f1 0.36947372555732727
ep0_l0_test_time 0.11093933099999731
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer1 Acc 0.38, AUC 0.6595854759216309, avg_entr 1.2240748405456543, f1 0.3799999952316284
ep0_l1_test_time 0.11451178899999803
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 0
Test Epoch0 layer2 Acc 0.3426315789473684, AUC 0.6193215847015381, avg_entr 1.2277562618255615, f1 0.34263157844543457
ep0_l2_test_time 0.11403732400000166
Test Epoch0 layer3 Acc 0.3244736842105263, AUC 0.5910838842391968, avg_entr 1.229835033416748, f1 0.32447367906570435
ep0_l3_test_time 0.11896470800000003
Test Epoch0 layer4 Acc 0.3118421052631579, AUC 0.588279128074646, avg_entr 1.236355185508728, f1 0.3118421137332916
ep0_l4_test_time 0.11660335600000593
gc 0
Train Epoch1 Acc 0.33570833333333333 (40285/120000), AUC 0.59446120262146
ep1_train_time 8.638429111
Test Epoch1 layer0 Acc 0.4681578947368421, AUC 0.7300938367843628, avg_entr 0.8646942973136902, f1 0.46815788745880127
ep1_l0_test_time 0.11604203199999574
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 1
Test Epoch1 layer1 Acc 0.4442105263157895, AUC 0.7139670848846436, avg_entr 0.871586799621582, f1 0.4442105293273926
ep1_l1_test_time 0.1161479639999996
Test Epoch1 layer2 Acc 0.39131578947368423, AUC 0.6733648777008057, avg_entr 0.8923812508583069, f1 0.3913157880306244
ep1_l2_test_time 0.11547255199999995
Test Epoch1 layer3 Acc 0.34789473684210526, AUC 0.6454254388809204, avg_entr 0.8882899880409241, f1 0.34789472818374634
ep1_l3_test_time 0.11577414900000349
Test Epoch1 layer4 Acc 0.33210526315789474, AUC 0.636353075504303, avg_entr 0.9080439209938049, f1 0.33210524916648865
ep1_l4_test_time 0.12343070600000061
gc 0
Train Epoch2 Acc 0.3899416666666667 (46793/120000), AUC 0.6528415679931641
ep2_train_time 8.552173905000004
Test Epoch2 layer0 Acc 0.49394736842105263, AUC 0.7428508400917053, avg_entr 0.7158980369567871, f1 0.4939473271369934
ep2_l0_test_time 0.10956717599999877
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 2
Test Epoch2 layer1 Acc 0.46657894736842104, AUC 0.7331687211990356, avg_entr 0.7165157794952393, f1 0.46657896041870117
ep2_l1_test_time 0.11387073099999867
Test Epoch2 layer2 Acc 0.43842105263157893, AUC 0.6999655365943909, avg_entr 0.7320948839187622, f1 0.4384210407733917
ep2_l2_test_time 0.11165696400000513
Test Epoch2 layer3 Acc 0.4189473684210526, AUC 0.6719701290130615, avg_entr 0.7445439696311951, f1 0.41894736886024475
ep2_l3_test_time 0.12074625000000339
Test Epoch2 layer4 Acc 0.4060526315789474, AUC 0.6695759296417236, avg_entr 0.7396716475486755, f1 0.4060526192188263
ep2_l4_test_time 0.117889004999995
gc 0
Train Epoch3 Acc 0.42056666666666664 (50468/120000), AUC 0.6780205965042114
ep3_train_time 8.645889087
Test Epoch3 layer0 Acc 0.48657894736842106, AUC 0.7471798658370972, avg_entr 0.6287867426872253, f1 0.48657894134521484
ep3_l0_test_time 0.11279384299999151
Test Epoch3 layer1 Acc 0.4963157894736842, AUC 0.7393046021461487, avg_entr 0.6392163038253784, f1 0.49631577730178833
ep3_l1_test_time 0.10994724700000802
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 3
Test Epoch3 layer2 Acc 0.45105263157894737, AUC 0.7068313360214233, avg_entr 0.6381334066390991, f1 0.45105263590812683
ep3_l2_test_time 0.11824720399999933
Test Epoch3 layer3 Acc 0.4313157894736842, AUC 0.6838010549545288, avg_entr 0.6440792083740234, f1 0.4313158094882965
ep3_l3_test_time 0.11488035499999683
Test Epoch3 layer4 Acc 0.42526315789473684, AUC 0.6825779676437378, avg_entr 0.6401771903038025, f1 0.4252631664276123
ep3_l4_test_time 0.12245418799999186
gc 0
Train Epoch4 Acc 0.433425 (52011/120000), AUC 0.6879287958145142
ep4_train_time 8.546477541000002
Test Epoch4 layer0 Acc 0.4876315789473684, AUC 0.749584436416626, avg_entr 0.5594318509101868, f1 0.48763158917427063
ep4_l0_test_time 0.11088810299999352
Test Epoch4 layer1 Acc 0.4813157894736842, AUC 0.7424057126045227, avg_entr 0.5671629309654236, f1 0.4813157916069031
ep4_l1_test_time 0.11306184800000096
Test Epoch4 layer2 Acc 0.4394736842105263, AUC 0.7058699131011963, avg_entr 0.5760366320610046, f1 0.4394736886024475
ep4_l2_test_time 0.10960254500000133
Test Epoch4 layer3 Acc 0.4097368421052632, AUC 0.6840918660163879, avg_entr 0.5787686109542847, f1 0.40973684191703796
ep4_l3_test_time 0.11555874199999039
Test Epoch4 layer4 Acc 0.40842105263157896, AUC 0.6838138103485107, avg_entr 0.5763513445854187, f1 0.40842103958129883
ep4_l4_test_time 0.11655446600001085
gc 0
Train Epoch5 Acc 0.4383416666666667 (52601/120000), AUC 0.6932837963104248
ep5_train_time 11.401614765999994
Test Epoch5 layer0 Acc 0.5042105263157894, AUC 0.7514826059341431, avg_entr 0.5179259181022644, f1 0.5042105317115784
ep5_l0_test_time 0.13565573500000028
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 5
Test Epoch5 layer1 Acc 0.505, AUC 0.7433800101280212, avg_entr 0.5226612687110901, f1 0.5049999952316284
ep5_l1_test_time 0.14099402300000463
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 5
Test Epoch5 layer2 Acc 0.4515789473684211, AUC 0.7123039960861206, avg_entr 0.528814435005188, f1 0.45157894492149353
ep5_l2_test_time 0.14588475700000458
Test Epoch5 layer3 Acc 0.4292105263157895, AUC 0.6900606155395508, avg_entr 0.5207760334014893, f1 0.42921051383018494
ep5_l3_test_time 0.15082018900000094
Test Epoch5 layer4 Acc 0.4286842105263158, AUC 0.6916437149047852, avg_entr 0.49983710050582886, f1 0.42868420481681824
ep5_l4_test_time 0.15359263599999906
gc 0
Train Epoch6 Acc 0.4449666666666667 (53396/120000), AUC 0.6981286406517029
ep6_train_time 8.712296054999996
Test Epoch6 layer0 Acc 0.48736842105263156, AUC 0.752372145652771, avg_entr 0.4711441099643707, f1 0.4873684346675873
ep6_l0_test_time 0.10825130000000627
Test Epoch6 layer1 Acc 0.48105263157894734, AUC 0.7436380982398987, avg_entr 0.4812866747379303, f1 0.4810526371002197
ep6_l1_test_time 0.11367484100000524
Test Epoch6 layer2 Acc 0.45026315789473687, AUC 0.7137283086776733, avg_entr 0.4765373468399048, f1 0.4502631723880768
ep6_l2_test_time 0.11857173500000329
Test Epoch6 layer3 Acc 0.4255263157894737, AUC 0.6930505633354187, avg_entr 0.47570598125457764, f1 0.42552632093429565
ep6_l3_test_time 0.11349479199999735
Test Epoch6 layer4 Acc 0.4189473684210526, AUC 0.6913800239562988, avg_entr 0.45395657420158386, f1 0.41894736886024475
ep6_l4_test_time 0.11742397800000504
gc 0
Train Epoch7 Acc 0.4442833333333333 (53314/120000), AUC 0.6990147829055786
ep7_train_time 8.913553651
Test Epoch7 layer0 Acc 0.48973684210526314, AUC 0.7537242770195007, avg_entr 0.4491838216781616, f1 0.4897368550300598
ep7_l0_test_time 0.1341973659999951
Test Epoch7 layer1 Acc 0.47657894736842105, AUC 0.7430864572525024, avg_entr 0.4607304632663727, f1 0.476578950881958
ep7_l1_test_time 0.14368220900000495
Test Epoch7 layer2 Acc 0.4373684210526316, AUC 0.713314414024353, avg_entr 0.45715680718421936, f1 0.4373684227466583
ep7_l2_test_time 0.11368480700001271
Test Epoch7 layer3 Acc 0.41, AUC 0.6890630722045898, avg_entr 0.44935137033462524, f1 0.4099999964237213
ep7_l3_test_time 0.1163290350000068
Test Epoch7 layer4 Acc 0.42236842105263156, AUC 0.6897968053817749, avg_entr 0.4403775930404663, f1 0.4223684072494507
ep7_l4_test_time 0.12021926299999564
gc 0
Train Epoch8 Acc 0.4469416666666667 (53633/120000), AUC 0.7007908821105957
ep8_train_time 9.58792391099999
Test Epoch8 layer0 Acc 0.4892105263157895, AUC 0.7549270391464233, avg_entr 0.43065211176872253, f1 0.4892105162143707
ep8_l0_test_time 0.13218165399999293
Test Epoch8 layer1 Acc 0.4881578947368421, AUC 0.7445734739303589, avg_entr 0.4263669550418854, f1 0.48815789818763733
ep8_l1_test_time 0.13979144500000018
Test Epoch8 layer2 Acc 0.45210526315789473, AUC 0.7146543264389038, avg_entr 0.4225970208644867, f1 0.45210522413253784
ep8_l2_test_time 0.14140420399999698
Test Epoch8 layer3 Acc 0.44026315789473686, AUC 0.6919068694114685, avg_entr 0.4128722548484802, f1 0.44026315212249756
ep8_l3_test_time 0.14585590699999784
Test Epoch8 layer4 Acc 0.4328947368421053, AUC 0.6948358416557312, avg_entr 0.38879355788230896, f1 0.4328947365283966
ep8_l4_test_time 0.1519896589999945
gc 0
Train Epoch9 Acc 0.44769166666666665 (53723/120000), AUC 0.7021462321281433
ep9_train_time 9.146925138
Test Epoch9 layer0 Acc 0.5021052631578947, AUC 0.7559700012207031, avg_entr 0.4072553813457489, f1 0.5021052360534668
ep9_l0_test_time 0.11163616900000761
Test Epoch9 layer1 Acc 0.49736842105263157, AUC 0.7438362836837769, avg_entr 0.4126039147377014, f1 0.4973684251308441
ep9_l1_test_time 0.11295416400000136
Test Epoch9 layer2 Acc 0.4618421052631579, AUC 0.7151981592178345, avg_entr 0.4207124412059784, f1 0.4618421196937561
ep9_l2_test_time 0.11599848800000245
Test Epoch9 layer3 Acc 0.43526315789473685, AUC 0.6917533278465271, avg_entr 0.41011250019073486, f1 0.43526315689086914
ep9_l3_test_time 0.12171883900001035
Test Epoch9 layer4 Acc 0.44026315789473686, AUC 0.6940706372261047, avg_entr 0.3849215805530548, f1 0.44026315212249756
ep9_l4_test_time 0.11814074599999458
gc 0
Train Epoch10 Acc 0.44858333333333333 (53830/120000), AUC 0.7035829424858093
ep10_train_time 8.624018895999995
Test Epoch10 layer0 Acc 0.5052631578947369, AUC 0.7571976780891418, avg_entr 0.38283371925354004, f1 0.5052631497383118
ep10_l0_test_time 0.11211633699997492
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 10
Test Epoch10 layer1 Acc 0.4826315789473684, AUC 0.7437524795532227, avg_entr 0.4016161859035492, f1 0.4826315641403198
ep10_l1_test_time 0.10926566900002399
Test Epoch10 layer2 Acc 0.4594736842105263, AUC 0.7167054414749146, avg_entr 0.3964080214500427, f1 0.4594736397266388
ep10_l2_test_time 0.12158419500002537
Test Epoch10 layer3 Acc 0.44, AUC 0.6888561844825745, avg_entr 0.389631450176239, f1 0.4399999976158142
ep10_l3_test_time 0.118450265000007
Test Epoch10 layer4 Acc 0.44105263157894736, AUC 0.6929903030395508, avg_entr 0.37310758233070374, f1 0.44105264544487
ep10_l4_test_time 0.1150906539999994
gc 0
Train Epoch11 Acc 0.4503 (54036/120000), AUC 0.7039400339126587
ep11_train_time 8.650873937
Test Epoch11 layer0 Acc 0.5081578947368421, AUC 0.7581678628921509, avg_entr 0.35884779691696167, f1 0.5081579089164734
ep11_l0_test_time 0.11109405899998137
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 11
Test Epoch11 layer1 Acc 0.4942105263157895, AUC 0.7445277571678162, avg_entr 0.3725387752056122, f1 0.49421051144599915
ep11_l1_test_time 0.1127743730000077
Test Epoch11 layer2 Acc 0.4531578947368421, AUC 0.717868447303772, avg_entr 0.37321382761001587, f1 0.453157901763916
ep11_l2_test_time 0.11306011499999613
Test Epoch11 layer3 Acc 0.44552631578947366, AUC 0.6947740912437439, avg_entr 0.35552704334259033, f1 0.4455263018608093
ep11_l3_test_time 0.11576519700000176
Test Epoch11 layer4 Acc 0.44842105263157894, AUC 0.6962870359420776, avg_entr 0.3453982472419739, f1 0.44842109084129333
ep11_l4_test_time 0.11750015300000882
gc 0
Train Epoch12 Acc 0.4518083333333333 (54217/120000), AUC 0.7057873010635376
ep12_train_time 8.945489005000013
Test Epoch12 layer0 Acc 0.5118421052631579, AUC 0.7600851655006409, avg_entr 0.3448147475719452, f1 0.5118421316146851
ep12_l0_test_time 0.13801098100000786
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 12
Test Epoch12 layer1 Acc 0.4978947368421053, AUC 0.7449881434440613, avg_entr 0.3601367771625519, f1 0.4978947341442108
ep12_l1_test_time 0.14043042299999797
Test Epoch12 layer2 Acc 0.46578947368421053, AUC 0.7184778451919556, avg_entr 0.3615339994430542, f1 0.46578946709632874
ep12_l2_test_time 0.1485714220000034
Test Epoch12 layer3 Acc 0.4407894736842105, AUC 0.6950149536132812, avg_entr 0.3437056839466095, f1 0.44078946113586426
ep12_l3_test_time 0.1477113910000014
Test Epoch12 layer4 Acc 0.4392105263157895, AUC 0.6963105201721191, avg_entr 0.34295183420181274, f1 0.43921053409576416
ep12_l4_test_time 0.1491933060000008
gc 0
Train Epoch13 Acc 0.45069166666666666 (54083/120000), AUC 0.7047932147979736
ep13_train_time 9.485966706
Test Epoch13 layer0 Acc 0.5052631578947369, AUC 0.7615899443626404, avg_entr 0.3350883722305298, f1 0.5052631497383118
ep13_l0_test_time 0.11270888600000717
Test Epoch13 layer1 Acc 0.48947368421052634, AUC 0.7459124326705933, avg_entr 0.3376161456108093, f1 0.4894736707210541
ep13_l1_test_time 0.1080747469999892
Test Epoch13 layer2 Acc 0.46289473684210525, AUC 0.7201800346374512, avg_entr 0.34060168266296387, f1 0.4628947675228119
ep13_l2_test_time 0.12179405599999882
Test Epoch13 layer3 Acc 0.4428947368421053, AUC 0.6906171441078186, avg_entr 0.3299826979637146, f1 0.44289472699165344
ep13_l3_test_time 0.11602702899998008
Test Epoch13 layer4 Acc 0.4363157894736842, AUC 0.6971312761306763, avg_entr 0.32716941833496094, f1 0.43631577491760254
ep13_l4_test_time 0.11851041299999565
gc 0
Train Epoch14 Acc 0.45061666666666667 (54074/120000), AUC 0.7039123773574829
ep14_train_time 9.483199663999983
Test Epoch14 layer0 Acc 0.5121052631578947, AUC 0.7629053592681885, avg_entr 0.31665632128715515, f1 0.5121052861213684
ep14_l0_test_time 0.10492199600000163
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 14
Test Epoch14 layer1 Acc 0.49815789473684213, AUC 0.7461008429527283, avg_entr 0.3306867480278015, f1 0.49815788865089417
ep14_l1_test_time 0.11243186900000524
Test Epoch14 layer2 Acc 0.46157894736842103, AUC 0.7175261974334717, avg_entr 0.3277987837791443, f1 0.46157893538475037
ep14_l2_test_time 0.11201415700000439
Test Epoch14 layer3 Acc 0.43342105263157893, AUC 0.6873483657836914, avg_entr 0.31949979066848755, f1 0.4334210455417633
ep14_l3_test_time 0.11894229300000347
Test Epoch14 layer4 Acc 0.4276315789473684, AUC 0.6903210878372192, avg_entr 0.3049286901950836, f1 0.42763158679008484
ep14_l4_test_time 0.11787724300000946
gc 0
Train Epoch15 Acc 0.44963333333333333 (53956/120000), AUC 0.7041116952896118
ep15_train_time 8.381987132000006
Test Epoch15 layer0 Acc 0.516578947368421, AUC 0.7645093202590942, avg_entr 0.302274614572525, f1 0.5165789723396301
ep15_l0_test_time 0.11274419100001865
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 15
Test Epoch15 layer1 Acc 0.5010526315789474, AUC 0.7478619813919067, avg_entr 0.30984118580818176, f1 0.5010526180267334
ep15_l1_test_time 0.11327772600000685
Test Epoch15 layer2 Acc 0.4636842105263158, AUC 0.7191175222396851, avg_entr 0.3080787658691406, f1 0.46368420124053955
ep15_l2_test_time 0.1166771310000172
Test Epoch15 layer3 Acc 0.4431578947368421, AUC 0.6941032409667969, avg_entr 0.29264017939567566, f1 0.4431579113006592
ep15_l3_test_time 0.13303954599999201
Test Epoch15 layer4 Acc 0.44026315789473686, AUC 0.6965591907501221, avg_entr 0.2701440453529358, f1 0.44026315212249756
ep15_l4_test_time 0.14976624499999502
gc 0
Train Epoch16 Acc 0.44724166666666665 (53669/120000), AUC 0.70297771692276
ep16_train_time 9.099012776999984
Test Epoch16 layer0 Acc 0.5171052631578947, AUC 0.7660075426101685, avg_entr 0.2927570641040802, f1 0.5171052813529968
ep16_l0_test_time 0.10882949700001632
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 16
Test Epoch16 layer1 Acc 0.5057894736842106, AUC 0.7489921450614929, avg_entr 0.29474446177482605, f1 0.5057894587516785
ep16_l1_test_time 0.11147705800001972
Test Epoch16 layer2 Acc 0.4494736842105263, AUC 0.7161786556243896, avg_entr 0.2980290353298187, f1 0.44947367906570435
ep16_l2_test_time 0.11671018399999866
Test Epoch16 layer3 Acc 0.4342105263157895, AUC 0.6859140396118164, avg_entr 0.2954724133014679, f1 0.43421053886413574
ep16_l3_test_time 0.11597039800000175
Test Epoch16 layer4 Acc 0.43315789473684213, AUC 0.6883321404457092, avg_entr 0.2815943658351898, f1 0.43315792083740234
ep16_l4_test_time 0.11975496400000907
gc 0
Train Epoch17 Acc 0.44835833333333336 (53803/120000), AUC 0.7034232020378113
ep17_train_time 8.298781511000016
Test Epoch17 layer0 Acc 0.5292105263157895, AUC 0.7681103944778442, avg_entr 0.28780218958854675, f1 0.5292105078697205
ep17_l0_test_time 0.10909194800001387
Save ckpt to ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt  ,ep 17
Test Epoch17 layer1 Acc 0.5089473684210526, AUC 0.7500835061073303, avg_entr 0.290534645318985, f1 0.5089473724365234
ep17_l1_test_time 0.1048940309999864
Test Epoch17 layer2 Acc 0.45921052631578946, AUC 0.7184715270996094, avg_entr 0.2929936349391937, f1 0.4592105448246002
ep17_l2_test_time 0.11393292899998642
Test Epoch17 layer3 Acc 0.4378947368421053, AUC 0.6913388967514038, avg_entr 0.27887246012687683, f1 0.437894731760025
ep17_l3_test_time 0.10753767799999991
Test Epoch17 layer4 Acc 0.43842105263157893, AUC 0.6940858960151672, avg_entr 0.2652527093887329, f1 0.4384210407733917
ep17_l4_test_time 0.12305525200000034
gc 0
Train Epoch18 Acc 0.4495416666666667 (53945/120000), AUC 0.7049413323402405
ep18_train_time 8.257750740000006
Test Epoch18 layer0 Acc 0.5171052631578947, AUC 0.7702039480209351, avg_entr 0.2671853303909302, f1 0.5171052813529968
ep18_l0_test_time 0.11225593899999353
Test Epoch18 layer1 Acc 0.5057894736842106, AUC 0.7513242363929749, avg_entr 0.275997132062912, f1 0.5057894587516785
ep18_l1_test_time 0.11505968899999175
Test Epoch18 layer2 Acc 0.4655263157894737, AUC 0.7195690870285034, avg_entr 0.2790415287017822, f1 0.4655263423919678
ep18_l2_test_time 0.11624186800000302
Test Epoch18 layer3 Acc 0.4336842105263158, AUC 0.6911759376525879, avg_entr 0.2633001208305359, f1 0.43368420004844666
ep18_l3_test_time 0.11356595699999161
Test Epoch18 layer4 Acc 0.4376315789473684, AUC 0.6956929564476013, avg_entr 0.2504312992095947, f1 0.4376315772533417
ep18_l4_test_time 0.11813867999998706
gc 0
Train Epoch19 Acc 0.4503 (54036/120000), AUC 0.7048385739326477
ep19_train_time 10.293252010999993
Test Epoch19 layer0 Acc 0.5173684210526316, AUC 0.771559476852417, avg_entr 0.2899986803531647, f1 0.5173684358596802
ep19_l0_test_time 0.10770588299999417
Test Epoch19 layer1 Acc 0.4868421052631579, AUC 0.7526929974555969, avg_entr 0.29285046458244324, f1 0.4868420958518982
ep19_l1_test_time 0.11277722100001597
Test Epoch19 layer2 Acc 0.4652631578947368, AUC 0.7177004218101501, avg_entr 0.2654230296611786, f1 0.46526315808296204
ep19_l2_test_time 0.11362192100000357
Test Epoch19 layer3 Acc 0.43973684210526315, AUC 0.6912320852279663, avg_entr 0.2495253086090088, f1 0.43973684310913086
ep19_l3_test_time 0.11922779500000047
Test Epoch19 layer4 Acc 0.4392105263157895, AUC 0.6943541765213013, avg_entr 0.2340688854455948, f1 0.43921053409576416
ep19_l4_test_time 0.11942249300000185
Best AUC tensor(0.5292) 17 0
train_as_loss [[4.55097514e+02 3.56665952e+02 3.51094520e+02 3.49846934e+02
  3.49373023e+02 3.49144853e+02 3.49019046e+02 3.48943354e+02
  3.48895005e+02 3.48862749e+02 3.48840526e+02 3.48824851e+02
  3.48813580e+02 3.48805355e+02 3.48799288e+02 3.48794765e+02
  3.48791368e+02 3.48788823e+02 3.48786867e+02 3.48785387e+02]
 [1.86842741e+00 1.71258619e-05 1.23574501e-06 2.46557544e-07
  7.55146797e-08 2.90810540e-08 2.27870713e-06 1.03253367e-05
  5.51527998e-05 1.13852557e-04 3.11541405e-04 4.18205979e-04
  2.49565182e-04 5.66587808e-04 5.82715234e-04 5.42193149e-04
  6.12489654e-04 6.16114168e-04 7.17033472e-04 4.94119859e-04]
 [1.56135867e+00 1.39615510e-05 1.17713459e-06 2.53126985e-07
  8.82577858e-08 3.98087355e-08 3.86057625e-06 2.15905440e-05
  1.16112393e-04 2.89585150e-04 7.32863000e-04 8.62949351e-04
  5.22624564e-04 1.01705193e-03 1.28587053e-03 8.87920028e-04
  9.91498015e-04 1.42184216e-03 3.02190715e-04 2.34949177e-04]
 [1.52652196e+00 1.24766816e-05 1.07810664e-06 2.65603588e-07
  1.26665897e-07 8.14732787e-08 4.99342977e-06 3.61003148e-05
  2.19779232e-04 6.66678055e-04 1.10636584e-03 4.86489895e-04
  3.09393026e-04 6.43944903e-04 8.90659229e-04 6.17778741e-04
  6.66699759e-04 6.67846669e-04 2.25937329e-04 1.64041874e-04]
 [1.43951369e+00 1.68555619e-05 1.65436165e-06 5.18233391e-07
  3.36546223e-07 2.96269498e-07 6.98175805e-06 9.33646770e-05
  4.91228679e-04 1.40083018e-03 1.58969860e-03 9.48411852e-04
  6.81374762e-04 1.31340729e-03 2.07118852e-03 1.24706988e-03
  1.36290089e-03 1.59137537e-03 2.08220164e-04 1.68990313e-04]]
train_ae_loss [[17.19608088 24.76305095 28.95203112 31.94225932 34.44256239 36.44073232
  38.21552856 39.85798115 41.22894191 42.62401254 43.91218564 44.97869586
  46.14223407 47.23997857 48.35938323 49.23336983 50.22856608 51.23504583
  52.05649627 52.88808745]
 [17.88708987 25.01894607 28.7694813  31.25957047 33.16168228 34.74695305
  36.10723507 37.36120245 38.39094231 39.43494029 40.33567739 41.22896715
  41.94036364 42.68462572 43.35533011 43.88049737 44.48006935 45.03574799
  45.47611004 45.85019719]
 [18.1220644  25.58397221 28.83987935 30.91272398 32.4772746  33.71748725
  34.70592402 35.67319754 36.42952184 37.11840441 37.82417255 38.37038227
  38.83356887 39.34327865 39.70444036 40.00352954 40.45977509 40.7638772
  40.64716213 41.03290191]
 [15.11212018 23.26427676 26.16621713 27.75719051 28.94636416 29.92861502
  30.6712129  31.39851867 32.00868808 32.47875017 32.8747277  33.127679
  33.50343783 33.9353235  34.25828191 34.51091661 34.85777881 34.98550943
  35.20505705 35.49872158]
 [13.5907943  22.61746354 25.16516467 26.40941959 27.32455859 28.04488239
  28.5857892  29.13306382 29.53731793 29.72616617 29.86833715 30.07175867
  30.24903799 30.53659812 30.58771161 30.63765177 30.77972714 30.73363784
  30.67118608 30.90479423]]
valid_acc (5, 20)
valid_AUC (5, 20)
train_acc (20,)
total_train+valid_time 202.910026232
Start Testing
Load ckpt at ckpt/ag_news_linearalside_l5_256_sidead//ag_news_linearalside_l5_side.pt
gc 10
Test layer0 Acc 0.5126315789473684, AUC 0.7588779926300049, avg_entr 0.285963773727417, f1 0.5126315951347351
l0_test_time 0.10932757799997717
gc 0
Test layer1 Acc 0.4957894736842105, AUC 0.7367633581161499, avg_entr 0.28966447710990906, f1 0.49578946828842163
l1_test_time 0.11377237499999637
gc 0
Test layer2 Acc 0.46289473684210525, AUC 0.7187838554382324, avg_entr 0.2924557626247406, f1 0.4628947675228119
l2_test_time 0.1143166760000156
gc 0
Test layer3 Acc 0.43973684210526315, AUC 0.6937033534049988, avg_entr 0.2826194763183594, f1 0.43973684310913086
l3_test_time 0.1169910720000189
gc 0
Test layer4 Acc 0.4355263157894737, AUC 0.6913913488388062, avg_entr 0.2679818570613861, f1 0.4355263113975525
l4_test_time 0.12339455099998986
gc 0
Test threshold 0.1 Acc 0.5102631578947369, AUC 0.7549644112586975, avg_entr 0.1364821195602417, f1 0.5102631449699402
t0.1_test_time 0.22110251899999867
gc 0
Test threshold 0.2 Acc 0.5113157894736842, AUC 0.752973735332489, avg_entr 0.12840111553668976, f1 0.5113157629966736
t0.2_test_time 0.2894041659999971
gc 0
Test threshold 0.3 Acc 0.5197368421052632, AUC 0.759903073310852, avg_entr 0.1676476150751114, f1 0.5197368264198303
t0.3_test_time 0.24448056099998894
gc 0
Test threshold 0.4 Acc 0.5155263157894737, AUC 0.7572447061538696, avg_entr 0.19240066409111023, f1 0.515526294708252
t0.4_test_time 0.21053722499999594
gc 0
Test threshold 0.5 Acc 0.515, AUC 0.7587007284164429, avg_entr 0.20337636768817902, f1 0.5149999856948853
t0.5_test_time 0.19960761100000468
gc 0
Test threshold 0.6 Acc 0.5126315789473684, AUC 0.7588779926300049, avg_entr 0.20627926290035248, f1 0.5126315951347351
t0.6_test_time 0.1829292399999929
gc 0
Test threshold 0.7 Acc 0.5126315789473684, AUC 0.7588779926300049, avg_entr 0.20627926290035248, f1 0.5126315951347351
t0.7_test_time 0.18008401599999502
gc 0
Test threshold 0.8 Acc 0.5126315789473684, AUC 0.7588779926300049, avg_entr 0.20627926290035248, f1 0.5126315951347351
t0.8_test_time 0.17975047499999164
gc 0
Test threshold 0.9 Acc 0.5126315789473684, AUC 0.7588779926300049, avg_entr 0.20627926290035248, f1 0.5126315951347351
t0.9_test_time 0.18375744700000496
