Load ckpt from ./ckpt/mask2//kdd99/kdd99_linearalside_l5_m2.pt
layer_mask {0, 1, 2}
Start Training
gc 9
[[4.76600535e+03 3.64603412e+02]
 [1.88656783e-02 2.46453898e+02]
 [2.88581320e+01 4.36102867e+01]
 [1.31055012e+03 1.04879711e+03]
 [1.12362814e+03 8.11242773e+02]]
Train Epoch0 Acc 0.011203077935555724 (4426/395070), AUC 0.5338608622550964
Test Epoch0 layer0 Acc 0.6801927671809824, AUC 0.7966768741607666
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearalside_l5_m3.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7265318106345928, AUC 0.8594834804534912
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearalside_l5_m3.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9779998380107723, AUC 0.9784122705459595
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearalside_l5_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.569564248977443, AUC 0.2896023094654083
Test Epoch0 layer4 Acc 0.001194670554408132, AUC 0.47653520107269287
gc 0
[[4.76600530e+03 3.63772571e+02]
 [2.11234450e-03 2.47749122e+02]
 [1.13903290e-01 1.68256481e+01]
 [1.31952142e+03 1.06574167e+03]
 [1.12098909e+03 8.14406806e+02]]
Train Epoch1 Acc 0.0009593236641607816 (379/395070), AUC 0.4771910607814789
Test Epoch1 layer0 Acc 0.6868039525371563, AUC 0.7954067587852478
Test Epoch1 layer1 Acc 0.7266533025553801, AUC 0.7865099310874939
Test Epoch1 layer2 Acc 0.9780099623375046, AUC 0.940834105014801
Test Epoch1 layer3 Acc 0.5696047462843721, AUC 0.2814183533191681
Test Epoch1 layer4 Acc 0.0005365893168104321, AUC 0.494266152381897
gc 0
[[4.76600527e+03 3.62416401e+02]
 [5.96271019e-04 2.48154423e+02]
 [2.19374492e-02 1.55901035e+01]
 [1.33052130e+03 1.07231627e+03]
 [1.12894428e+03 8.20719355e+02]]
Train Epoch2 Acc 0.0005011770066064242 (198/395070), AUC 0.46483322978019714
Test Epoch2 layer0 Acc 0.6909751751508525, AUC 0.7957732677459717
Test Epoch2 layer1 Acc 0.7267342971692382, AUC 0.7862940430641174
Test Epoch2 layer2 Acc 0.9886911270400518, AUC 0.9026458263397217
Test Epoch2 layer3 Acc 0.6106285182035395, AUC 0.27868613600730896
Test Epoch2 layer4 Acc 0.00037460008909407527, AUC 0.4339085519313812
gc 0
[[4.76600525e+03 3.61070308e+02]
 [4.70721752e-04 2.48225484e+02]
 [4.64920973e-03 1.45252290e+01]
 [1.34324178e+03 1.08141189e+03]
 [1.13197606e+03 8.41145494e+02]]
Train Epoch3 Acc 0.0003670235654440985 (145/395070), AUC 0.41459932923316956
Test Epoch3 layer0 Acc 0.706981735714575, AUC 0.7985946536064148
Test Epoch3 layer1 Acc 0.7266937998623092, AUC 0.7861618399620056
Test Epoch3 layer2 Acc 0.9885898837727292, AUC 0.900482714176178
Test Epoch3 layer3 Acc 0.04331186976066092, AUC 0.26251113414764404
Test Epoch3 layer4 Acc 0.00037460008909407527, AUC 0.41210901737213135
gc 0
[[4.76600523e+03 3.59890436e+02]
 [4.15037713e-04 2.48066621e+02]
 [1.31705497e-03 1.36624985e+01]
 [1.34477143e+03 1.08025351e+03]
 [1.12802620e+03 8.51249693e+02]]
Train Epoch4 Acc 0.00033158680740122 (131/395070), AUC 0.408931702375412
Test Epoch4 layer0 Acc 0.7138460292390556, AUC 0.7967744469642639
Test Epoch4 layer1 Acc 0.7268152917830965, AUC 0.787757933139801
Test Epoch4 layer2 Acc 0.9887012513667841, AUC 0.8997717499732971
Test Epoch4 layer3 Acc 0.043008139958692744, AUC 0.25614187121391296
Test Epoch4 layer4 Acc 0.00035435143562953064, AUC 0.4110163748264313
gc 0
[[4.76601233e+03 3.58697800e+02]
 [6.83841548e-05 2.47355742e+02]
 [1.94598148e-04 1.29940171e+01]
 [1.34586925e+03 1.08167614e+03]
 [1.12691085e+03 8.53496796e+02]]
Train Epoch5 Acc 0.0003138684283797808 (124/395070), AUC 0.4052412807941437
Test Epoch5 layer0 Acc 0.715273559308306, AUC 0.7968213558197021
Test Epoch5 layer1 Acc 0.726835540436561, AUC 0.7882862687110901
Test Epoch5 layer2 Acc 0.9886810027133196, AUC 0.8983489871025085
Test Epoch5 layer3 Acc 0.04296764265176366, AUC 0.261121928691864
Test Epoch5 layer4 Acc 0.0003239784554327137, AUC 0.40590181946754456
gc 0
[[4.76600522e+03 3.57564166e+02]
 [1.16312849e-04 2.46621091e+02]
 [2.10439882e-04 1.25893348e+01]
 [1.34721199e+03 1.08618319e+03]
 [1.12748242e+03 8.55929530e+02]]
Train Epoch6 Acc 0.0003012124433644671 (119/395070), AUC 0.4050782024860382
Test Epoch6 layer0 Acc 0.7159620135261006, AUC 0.7990356683731079
Test Epoch6 layer1 Acc 0.7268760377434901, AUC 0.7877161502838135
Test Epoch6 layer2 Acc 0.9887417486737132, AUC 0.8993667364120483
Test Epoch6 layer3 Acc 0.042957518325031384, AUC 0.2622549831867218
Test Epoch6 layer4 Acc 0.0002834811485036245, AUC 0.40602245926856995
gc 0
[[4.76600522e+03 3.56658803e+02]
 [1.25581989e-04 2.45802166e+02]
 [2.34571131e-04 1.21802108e+01]
 [1.34819891e+03 1.09277483e+03]
 [1.12815017e+03 8.59045538e+02]]
Train Epoch7 Acc 0.0002809628673399651 (111/395070), AUC 0.40250635147094727
Test Epoch7 layer0 Acc 0.7178350139715709, AUC 0.7072831392288208
Test Epoch7 layer1 Acc 0.7269671566840805, AUC 0.7147966027259827
Test Epoch7 layer2 Acc 0.9887923703073745, AUC 0.8996621966362
Test Epoch7 layer3 Acc 0.04289677236463775, AUC 0.2607294023036957
Test Epoch7 layer4 Acc 0.0002531081683068076, AUC 0.4033545255661011
gc 0
[[4.76600522e+03 3.55746288e+02]
 [1.13416107e-04 2.44570522e+02]
 [2.02109914e-04 1.17446291e+01]
 [1.34899368e+03 1.10027433e+03]
 [1.12868952e+03 8.62817830e+02]]
Train Epoch8 Acc 0.0002733692763307768 (108/395070), AUC 0.39941397309303284
Test Epoch8 layer0 Acc 0.7181488681002713, AUC 0.7100943326950073
Test Epoch8 layer1 Acc 0.7271190215850646, AUC 0.7150487303733826
Test Epoch8 layer2 Acc 0.9888632405945005, AUC 0.9008632898330688
Test Epoch8 layer3 Acc 0.04288664803790548, AUC 0.25953418016433716
Test Epoch8 layer4 Acc 0.0002531081683068076, AUC 0.39615771174430847
gc 0
[[4.76600522e+03 3.54937498e+02]
 [1.39637567e-05 2.43261139e+02]
 [2.69479626e-05 1.13608712e+01]
 [1.34965714e+03 1.10617334e+03]
 [1.12911252e+03 8.65310909e+02]]
Train Epoch9 Acc 0.0002708380793277141 (107/395070), AUC 0.3950467109680176
Test Epoch9 layer0 Acc 0.7183108573279877, AUC 0.7100659608840942
Test Epoch9 layer1 Acc 0.727058275624671, AUC 0.7164611220359802
Test Epoch9 layer2 Acc 0.9889239865548941, AUC 0.8984149694442749
Test Epoch9 layer3 Acc 0.0429170210181023, AUC 0.26033690571784973
Test Epoch9 layer4 Acc 0.0002531081683068076, AUC 0.3945779800415039
Best AUC 0.9784122705459595
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//kdd99/kdd99_linearalside_l5_m3.pt
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 9054     0 10327    67     0     0     0     8     0     0     0]
 [    1     0    12   428     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  194     0    13     0     0     0     1     0     0     0     0]
 [  125     0     3     2     0     0     0    74     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    2     0     0     0     0     0     0     0    51     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 4507     0 14905    33     0     0     0    11     0     0     0]
 [    0     0     2   439     0     0     0     0     0     0     0]
 [  317     0     1     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  194     0    13     0     0     0     1     0     0     0     0]
 [    0     0   142     0     0     0     0    62     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    2     0     0     0     0     0     0     0    51     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56111     0    47     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   17  1051 18360    22     0     0     0     6     0     0     0]
 [    0     2     2   437     0     0     0     0     0     0     0]
 [    0   279    39     0     0     0     0     0     0     0     0]
 [    0    24   226     0     0     0     0     0     0     0     0]
 [    0   205     3     0     0     0     0     0     0     0     0]
 [    0     0   136    11     0     0     0    57     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    0     0    53     0     0     0     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56154     0     0     4     0     0     0     0     0     0     0]
 [ 4167    41     0 17232     0     0     0     0     1     0     0]
 [15843   191     0  2486     0     0     0    64   872     0     0]
 [  441     0     0     0     0     0     0     0     0     0     0]
 [   38   280     0     0     0     0     0     0     0     0     0]
 [   57     0     0   193     0     0     0     0     0     0     0]
 [  172    34     0     1     0     0     0     0     1     0     0]
 [   72     2     0    68     0     0     0    62     0     0     0]
 [  180     0     0    16     0     0     0     0     0     0     0]
 [   25     0     0    28     0     0     0     0     0     0     0]
 [   25     0     0    22     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0     0    39 56087     0     0     0    32     0     0]
 [    3     0     0  4077    10     0 17351     0     0     0     0]
 [  933    68    55  2919 13428   453  1548    16    36     0     0]
 [    4     0    36    60   341     0     0     0     0     0     0]
 [   35     0     0    10     0   264     1     0     8     0     0]
 [  236     0     0     7     2     0     5     0     0     0     0]
 [    0     0    13    11     2   177     3     0     2     0     0]
 [   53    63     0    10    72     0     6     0     0     0     0]
 [   49     0     0     7   135     5     0     0     0     0     0]
 [   22     0     1    15     9     4     0     0     2     0     0]
 [   19     0     0     3     1     0    21     0     3     0     0]]
Figure(640x480)
