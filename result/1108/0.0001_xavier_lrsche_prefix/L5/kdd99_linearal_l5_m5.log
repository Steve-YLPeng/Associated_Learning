Load ckpt from ./ckpt/mask4//kdd99/kdd99_linearal_l5_m4.pt
layer_mask {0, 1, 2, 3, 4}
Start Training
gc 9
[[4.76600569e+03 4.29115856e+00]
 [8.32825370e-04 2.83922510e+00]
 [3.07074059e-03 2.23223800e+00]
 [3.79384920e-02 2.21856752e+00]
 [2.65901790e+01 2.20979843e+01]]
Train Epoch0 Acc 0.970757081023616 (383517/395070), AUC 0.8816755414009094
Test Epoch0 layer0 Acc 0.9961426315150043, AUC 0.9396246075630188
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9967804640991375, AUC 0.9131187796592712
Test Epoch0 layer2 Acc 0.9969930749605151, AUC 0.9145588278770447
Test Epoch0 layer3 Acc 0.9969829506337828, AUC 0.9268985986709595
Test Epoch0 layer4 Acc 0.9959300206536266, AUC 0.9001013040542603
gc 0
[[4.76600535e+03 4.03657646e+00]
 [4.73052501e-04 2.54434617e+00]
 [9.04743561e-04 1.88724815e+00]
 [3.96199225e-03 1.62163534e+00]
 [1.62844766e-01 1.89349182e+00]]
Train Epoch1 Acc 0.9969625635963247 (393870/395070), AUC 0.8981155753135681
Test Epoch1 layer0 Acc 0.996466609970437, AUC 0.9027921557426453
Test Epoch1 layer1 Acc 0.9964969829506338, AUC 0.914164125919342
Test Epoch1 layer2 Acc 0.9965982262179565, AUC 0.9118236899375916
Test Epoch1 layer3 Acc 0.9965577289110275, AUC 0.9197114706039429
Test Epoch1 layer4 Acc 0.9965476045842951, AUC 0.896350085735321
gc 0
[[4.76600530e+03 3.79087130e+00]
 [4.65074613e-04 2.32167078e+00]
 [7.91963155e-04 1.67411610e+00]
 [1.62250837e-03 1.39611860e+00]
 [2.04773634e-02 1.42455006e+00]]
Train Epoch2 Acc 0.997420710253879 (394051/395070), AUC 0.8932498693466187
Test Epoch2 layer0 Acc 0.996729842465476, AUC 0.8969934582710266
Test Epoch2 layer1 Acc 0.9972259344753573, AUC 0.915431559085846
Test Epoch2 layer2 Acc 0.9973069290892156, AUC 0.9148721098899841
Test Epoch2 layer3 Acc 0.9973271777426801, AUC 0.9287814497947693
Test Epoch2 layer4 Acc 0.997246183128822, AUC 0.8974189162254333
gc 0
[[4.76600527e+03 3.58157467e+00]
 [4.55372559e-04 2.14976436e+00]
 [7.92416882e-04 1.53091277e+00]
 [1.36456709e-03 1.26082072e+00]
 [6.16421342e-03 1.23877365e+00]]
Train Epoch3 Acc 0.9975852380590782 (394116/395070), AUC 0.9070999026298523
Test Epoch3 layer0 Acc 0.9970639452476411, AUC 0.8980392217636108
Test Epoch3 layer1 Acc 0.9973676750496092, AUC 0.9213750958442688
Test Epoch3 layer2 Acc 0.9974891669703965, AUC 0.9211885333061218
Test Epoch3 layer3 Acc 0.9974790426436642, AUC 0.9461101293563843
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.997509415623861, AUC 0.9175035357475281
gc 0
[[4.76600525e+03 3.40637259e+00]
 [4.86937722e-04 2.01034646e+00]
 [8.20744869e-04 1.42105352e+00]
 [1.36811543e-03 1.16331750e+00]
 [3.45405222e-03 1.12113395e+00]]
Train Epoch4 Acc 0.9977092667122283 (394165/395070), AUC 0.9122293591499329
Test Epoch4 layer0 Acc 0.9970943182278379, AUC 0.8944473266601562
Test Epoch4 layer1 Acc 0.9974587939901997, AUC 0.9209814071655273
Test Epoch4 layer2 Acc 0.9975499129307901, AUC 0.9170522093772888
Test Epoch4 layer3 Acc 0.997509415623861, AUC 0.9435550570487976
Test Epoch4 layer4 Acc 0.9974587939901997, AUC 0.9165776968002319
gc 0
[[4.76600523e+03 3.25107637e+00]
 [4.65639147e-04 1.88816823e+00]
 [8.16350690e-04 1.32779834e+00]
 [1.34712474e-03 1.08240209e+00]
 [2.43101305e-03 1.03178917e+00]]
Train Epoch5 Acc 0.9978003898043385 (394201/395070), AUC 0.9137406945228577
Test Epoch5 layer0 Acc 0.9971550641882315, AUC 0.8938947319984436
Test Epoch5 layer1 Acc 0.997620783217916, AUC 0.9203307628631592
Test Epoch5 layer2 Acc 0.9977119021585065, AUC 0.9121800065040588
Test Epoch5 layer3 Acc 0.997691653505042, AUC 0.9237709045410156
Test Epoch5 layer4 Acc 0.9978030210990969, AUC 0.9177792072296143
gc 0
[[4.76600523e+03 3.18174505e+00]
 [4.61377504e-04 1.80550458e+00]
 [8.05068914e-04 1.26417900e+00]
 [1.31385633e-03 1.02968234e+00]
 [2.09986433e-03 9.72944330e-01]]
Train Epoch6 Acc 0.9979067000784672 (394243/395070), AUC 0.9129629135131836
Test Epoch6 layer0 Acc 0.9971955614951605, AUC 0.8931922912597656
Test Epoch6 layer1 Acc 0.9977017778317742, AUC 0.918282151222229
Test Epoch6 layer2 Acc 0.9978232697525614, AUC 0.9141753911972046
Test Epoch6 layer3 Acc 0.997843518406026, AUC 0.9268636703491211
Test Epoch6 layer4 Acc 0.9978030210990969, AUC 0.9181898236274719
gc 0
[[4.76600522e+03 3.10626547e+00]
 [4.70993719e-04 1.73558620e+00]
 [8.17023225e-04 1.21249359e+00]
 [1.35189914e-03 9.87364296e-01]
 [2.11531667e-03 9.30156485e-01]]
Train Epoch7 Acc 0.9979876983825651 (394275/395070), AUC 0.9123024344444275
Test Epoch7 layer0 Acc 0.9972158101486251, AUC 0.8925004601478577
Test Epoch7 layer1 Acc 0.9976410318713805, AUC 0.91900235414505
Test Epoch7 layer2 Acc 0.9978232697525614, AUC 0.9108517169952393
Test Epoch7 layer3 Acc 0.9978333940792937, AUC 0.9195234775543213
Test Epoch7 layer4 Acc 0.9978131454258292, AUC 0.9133913516998291
gc 0
[[4.76600522e+03 3.03119316e+00]
 [6.03932547e-05 1.65117731e+00]
 [1.04110122e-04 1.14337913e+00]
 [1.76811157e-04 9.22691336e-01]
 [9.14333929e-04 8.77793357e-01]]
Train Epoch8 Acc 0.9980433847166325 (394297/395070), AUC 0.9102663397789001
Test Epoch8 layer0 Acc 0.9972563074555542, AUC 0.8930516839027405
Test Epoch8 layer1 Acc 0.9978333940792937, AUC 0.917549192905426
Test Epoch8 layer2 Acc 0.9978738913862228, AUC 0.9125362038612366
Test Epoch8 layer3 Acc 0.9978941400396873, AUC 0.9201446771621704
Test Epoch8 layer4 Acc 0.997884015712955, AUC 0.9120969772338867
gc 0
[[4.76600522e+03 2.96212981e+00]
 [1.17628939e-04 1.61250029e+00]
 [2.05385263e-04 1.11705149e+00]
 [3.27282903e-04 9.00709495e-01]
 [1.24763767e-03 8.50656153e-01]]
Train Epoch9 Acc 0.9980509783076417 (394300/395070), AUC 0.9078981280326843
Test Epoch9 layer0 Acc 0.9972563074555542, AUC 0.8928266763687134
Test Epoch9 layer1 Acc 0.9977119021585065, AUC 0.9171159863471985
Test Epoch9 layer2 Acc 0.997884015712955, AUC 0.9106878042221069
Test Epoch9 layer3 Acc 0.9978941400396873, AUC 0.9176755547523499
Test Epoch9 layer4 Acc 0.997884015712955, AUC 0.9116149544715881
Best AUC 0.9461101293563843
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt
[[56146     0    12     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     1 19427    10     0     5     0     7     0     0     0]
 [    0     0     7   434     0     0     0     0     0     0     0]
 [    5     0    33     0   280     0     0     0     0     0     0]
 [    0     0    22     0     0   223     0     5     0     0     0]
 [    0    14     9     0     0     0   185     0     0     0     0]
 [    0     0    51     0     0     0     0   153     0     0     0]
 [    0     0     1     0     0     0     0     0   195     0     0]
 [    3     2    16     0     0    16     0     7     9     0     0]
 [    0    18     8     0     0    21     0     0     0     0     0]]
Figure(640x480)
[[56150     0     8     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19416    10     0     4     0     9     0     0     0]
 [    0     0     7   434     0     0     0     0     0     0     0]
 [    5     0    22     0   291     0     0     0     0     0     0]
 [    0     0    20     0     0   228     1     1     0     0     0]
 [    0    11     8     0     0     0   189     0     0     0     0]
 [    0     0    34     0     0     0     0   170     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    3     0    10     0     0    15     0     7    18     0     0]
 [    0     1    10     0     0    21    15     0     0     0     0]]
Figure(640x480)
[[56152     0     6     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19419     8     0     4     0     8     0     0     0]
 [    0     0     9   432     0     0     0     0     0     0     0]
 [    5     0    21     0   292     0     0     0     0     0     0]
 [    0     0    13     0     0   232     5     0     0     0     0]
 [    0     7     8     0     0     0   193     0     0     0     0]
 [    0     0    33     0     0     0     0   171     0     0     0]
 [    0     0     1     0     1     0     0     0   194     0     0]
 [    0     2    10     0     0    18     0     7    16     0     0]
 [    0     2    15     0     0    14    16     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     0 19420     8     0     4     0     8     0     0     0]
 [    0     0    10   431     0     0     0     0     0     0     0]
 [    5     0    21     0   292     0     0     0     0     0     0]
 [    0     0    16     0     0   229     5     0     0     0     0]
 [    0     7     8     0     0     0   193     0     0     0     0]
 [    0     0    33     0     0     0     0   171     0     0     0]
 [    0     0     1     0     0     0     0     0   195     0     0]
 [    0     3     8     0     0    18     3     4    17     0     0]
 [    0     2    22     0     0     7    16     0     0     0     0]]
Figure(640x480)
[[56152     0     6     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     1 19429     8     0     4     0     8     0     0     0]
 [    0     0    11   430     0     0     0     0     0     0     0]
 [    5     0    20     0   293     0     0     0     0     0     0]
 [    0     0    18     0     0   227     5     0     0     0     0]
 [    0     9     8     0     0     0   191     0     0     0     0]
 [    0     0    33     0     0     0     0   171     0     0     0]
 [    0     0     1     0     1     0     0     0   194     0     0]
 [    0     8     7     0     0    20     0     2    16     0     0]
 [    0     3    23     0     0     6    15     0     0     0     0]]
Figure(640x480)
