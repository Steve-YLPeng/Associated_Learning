Load ckpt from ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt
layer_mask {0, 1, 2, 3, 4, 5, 6, 7, 8, 9}
Start Training
gc 9
[[4.76600521e+03 1.93250858e+00]
 [6.94788889e-04 1.19248197e+00]
 [1.31122574e-03 9.20652412e-01]
 [2.01737981e-03 8.13125937e-01]
 [3.36967717e-03 7.09752380e-01]
 [5.15767494e-03 6.18918773e-01]
 [6.88773065e-03 6.02126768e-01]
 [1.01968181e-02 6.46601007e-01]
 [1.56698009e-02 6.47042293e-01]
 [1.83884161e+01 1.31879492e+01]]
Train Epoch0 Acc 0.9824790543447997 (388148/395070), AUC 0.9496312737464905
Test Epoch0 layer0 Acc 0.9978941400396873, AUC 0.9688982367515564
Save ckpt to ./ckpt/mask10//kdd99/kdd99_linearal_l10_m10.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9980561292674037, AUC 0.9668020606040955
Test Epoch0 layer2 Acc 0.9980561292674037, AUC 0.9696176648139954
Save ckpt to ./ckpt/mask10//kdd99/kdd99_linearal_l10_m10.pt  ,ep 0
Test Epoch0 layer3 Acc 0.998066253594136, AUC 0.9711275100708008
Save ckpt to ./ckpt/mask10//kdd99/kdd99_linearal_l10_m10.pt  ,ep 0
Test Epoch0 layer4 Acc 0.998066253594136, AUC 0.9714473485946655
Save ckpt to ./ckpt/mask10//kdd99/kdd99_linearal_l10_m10.pt  ,ep 0
Test Epoch0 layer5 Acc 0.9980865022476005, AUC 0.9731548428535461
Save ckpt to ./ckpt/mask10//kdd99/kdd99_linearal_l10_m10.pt  ,ep 0
Test Epoch0 layer6 Acc 0.9980763779208682, AUC 0.9825416207313538
Save ckpt to ./ckpt/mask10//kdd99/kdd99_linearal_l10_m10.pt  ,ep 0
Test Epoch0 layer7 Acc 0.9980865022476005, AUC 0.9882708191871643
Save ckpt to ./ckpt/mask10//kdd99/kdd99_linearal_l10_m10.pt  ,ep 0
Test Epoch0 layer8 Acc 0.9980763779208682, AUC 0.9643058776855469
Test Epoch0 layer9 Acc 0.9980561292674037, AUC 0.9921244978904724
Save ckpt to ./ckpt/mask10//kdd99/kdd99_linearal_l10_m10.pt  ,ep 0
gc 0
[[4.76600521e+03 1.91102026e+00]
 [4.28699966e-04 1.18256770e+00]
 [7.29249031e-04 9.13902819e-01]
 [1.16816940e-03 8.09912489e-01]
 [1.92021374e-03 7.06160558e-01]
 [2.83754198e-03 6.14663181e-01]
 [3.82207627e-03 5.96081502e-01]
 [5.32778913e-03 6.39521418e-01]
 [8.00822219e-03 6.37249396e-01]
 [8.32454754e-02 7.08506148e-01]]
Train Epoch1 Acc 0.9982433492798745 (394376/395070), AUC 0.9478530883789062
Test Epoch1 layer0 Acc 0.9979042643664197, AUC 0.9614107012748718
Test Epoch1 layer1 Acc 0.9980561292674037, AUC 0.9660272002220154
Test Epoch1 layer2 Acc 0.9980460049406714, AUC 0.9698700308799744
Test Epoch1 layer3 Acc 0.9980763779208682, AUC 0.9661945700645447
Test Epoch1 layer4 Acc 0.9980763779208682, AUC 0.9683628082275391
Test Epoch1 layer5 Acc 0.9980865022476005, AUC 0.9704437255859375
Test Epoch1 layer6 Acc 0.998066253594136, AUC 0.9645734429359436
Test Epoch1 layer7 Acc 0.9980763779208682, AUC 0.9546251893043518
Test Epoch1 layer8 Acc 0.998066253594136, AUC 0.954423189163208
Test Epoch1 layer9 Acc 0.9980763779208682, AUC 0.8906936645507812
gc 0
[[4.76601232e+03 1.88957525e+00]
 [4.22655328e-04 1.17122719e+00]
 [7.49222656e-04 9.03304656e-01]
 [1.24450966e-03 7.96956957e-01]
 [1.99426651e-03 6.93513329e-01]
 [2.78546107e-03 6.02810854e-01]
 [3.75642319e-03 5.83645460e-01]
 [5.15925792e-03 6.24433547e-01]
 [7.42680204e-03 6.21023443e-01]
 [1.89221257e-02 6.67504192e-01]]
Train Epoch2 Acc 0.9982560052648898 (394381/395070), AUC 0.9182413220405579
Test Epoch2 layer0 Acc 0.9979042643664197, AUC 0.969810426235199
Test Epoch2 layer1 Acc 0.9980561292674037, AUC 0.9697021245956421
Test Epoch2 layer2 Acc 0.9980561292674037, AUC 0.9741451144218445
Test Epoch2 layer3 Acc 0.998066253594136, AUC 0.97232586145401
Test Epoch2 layer4 Acc 0.9980763779208682, AUC 0.970890462398529
Test Epoch2 layer5 Acc 0.998066253594136, AUC 0.9697445034980774
Test Epoch2 layer6 Acc 0.9980865022476005, AUC 0.9720348119735718
Test Epoch2 layer7 Acc 0.998066253594136, AUC 0.9746208190917969
Test Epoch2 layer8 Acc 0.9980865022476005, AUC 0.9605776071548462
Test Epoch2 layer9 Acc 0.9980865022476005, AUC 0.92715984582901
gc 0
[[4.76600521e+03 1.87053550e+00]
 [4.38636219e-04 1.15942088e+00]
 [7.83059409e-04 8.94417316e-01]
 [1.26530212e-03 7.90632471e-01]
 [2.05524195e-03 6.88916396e-01]
 [2.91643971e-03 5.99090630e-01]
 [3.75297887e-03 5.78841683e-01]
 [5.10758591e-03 6.19250131e-01]
 [7.09017420e-03 6.15364630e-01]
 [1.29876506e-02 6.55103216e-01]]
Train Epoch3 Acc 0.9982458804768776 (394377/395070), AUC 0.9405996203422546
Test Epoch3 layer0 Acc 0.9979346373466165, AUC 0.967763364315033
Test Epoch3 layer1 Acc 0.9980966265743328, AUC 0.9773311614990234
Test Epoch3 layer2 Acc 0.9980763779208682, AUC 0.9763756394386292
Test Epoch3 layer3 Acc 0.9980763779208682, AUC 0.9726347327232361
Test Epoch3 layer4 Acc 0.9980865022476005, AUC 0.974744975566864
Test Epoch3 layer5 Acc 0.998106750901065, AUC 0.9721710681915283
Test Epoch3 layer6 Acc 0.9980966265743328, AUC 0.9689275622367859
Test Epoch3 layer7 Acc 0.998106750901065, AUC 0.96625155210495
Test Epoch3 layer8 Acc 0.9980966265743328, AUC 0.9614967107772827
Test Epoch3 layer9 Acc 0.998106750901065, AUC 0.9417245984077454
gc 0
[[4.76600521e+03 1.84401899e+00]
 [4.30405686e-04 1.14228920e+00]
 [7.40781938e-04 8.79418484e-01]
 [1.18638415e-03 7.74996919e-01]
 [1.84055948e-03 6.74169159e-01]
 [2.63131693e-03 5.86450714e-01]
 [3.49723613e-03 5.65080600e-01]
 [4.71542805e-03 6.02624954e-01]
 [6.27276809e-03 5.98411894e-01]
 [1.06370175e-02 6.32135111e-01]]
Train Epoch4 Acc 0.9982787860379173 (394390/395070), AUC 0.9606330990791321
Test Epoch4 layer0 Acc 0.9979346373466165, AUC 0.9633796215057373
Test Epoch4 layer1 Acc 0.9980763779208682, AUC 0.9644396305084229
Test Epoch4 layer2 Acc 0.998066253594136, AUC 0.9710813760757446
Test Epoch4 layer3 Acc 0.9980763779208682, AUC 0.9682632684707642
Test Epoch4 layer4 Acc 0.9980865022476005, AUC 0.9678598642349243
Test Epoch4 layer5 Acc 0.9980865022476005, AUC 0.966213047504425
Test Epoch4 layer6 Acc 0.9980865022476005, AUC 0.9617010354995728
Test Epoch4 layer7 Acc 0.9980763779208682, AUC 0.9585068225860596
Test Epoch4 layer8 Acc 0.998066253594136, AUC 0.9596899151802063
Test Epoch4 layer9 Acc 0.998106750901065, AUC 0.9325379729270935
gc 0
[[4.76600521e+03 1.83416586e+00]
 [4.39143174e-04 1.14042522e+00]
 [7.65972489e-04 8.80464317e-01]
 [1.22029647e-03 7.79615375e-01]
 [1.94035944e-03 6.79322689e-01]
 [1.17058088e-03 5.74136921e-01]
 [1.10459594e-03 5.46330485e-01]
 [1.11769949e-03 5.78011995e-01]
 [1.31723192e-03 5.66251653e-01]
 [3.25877466e-03 5.82252457e-01]]
Train Epoch5 Acc 0.9982610676588959 (394383/395070), AUC 0.9657806754112244
Test Epoch5 layer0 Acc 0.9979143886931519, AUC 0.9719537496566772
Test Epoch5 layer1 Acc 0.9980561292674037, AUC 0.9688339233398438
Test Epoch5 layer2 Acc 0.9980763779208682, AUC 0.9722530245780945
Test Epoch5 layer3 Acc 0.998066253594136, AUC 0.9707987308502197
Test Epoch5 layer4 Acc 0.9980763779208682, AUC 0.9717506170272827
Test Epoch5 layer5 Acc 0.9980865022476005, AUC 0.9715157151222229
Test Epoch5 layer6 Acc 0.9980865022476005, AUC 0.9754627346992493
Test Epoch5 layer7 Acc 0.9980966265743328, AUC 0.971753716468811
Test Epoch5 layer8 Acc 0.9980763779208682, AUC 0.9614883065223694
Test Epoch5 layer9 Acc 0.998066253594136, AUC 0.9783599376678467
gc 0
[[4.76600521e+03 1.81327903e+00]
 [4.48335184e-04 1.12919882e+00]
 [7.88610610e-04 8.69543934e-01]
 [1.32735406e-03 7.67834854e-01]
 [2.14227389e-03 6.67711225e-01]
 [1.48791836e-03 5.65236004e-01]
 [1.54871587e-03 5.37945018e-01]
 [1.73907094e-03 5.69087373e-01]
 [2.14070352e-03 5.58593483e-01]
 [3.84529842e-03 5.75250034e-01]]
Train Epoch6 Acc 0.9982838484319234 (394392/395070), AUC 0.9664558172225952
Test Epoch6 layer0 Acc 0.9979953833070101, AUC 0.9651241898536682
Test Epoch6 layer1 Acc 0.9980966265743328, AUC 0.9697820544242859
Test Epoch6 layer2 Acc 0.9980865022476005, AUC 0.9719533920288086
Test Epoch6 layer3 Acc 0.9981371238812619, AUC 0.9707987308502197
Test Epoch6 layer4 Acc 0.9981168752277974, AUC 0.9717428684234619
Test Epoch6 layer5 Acc 0.9981269995545297, AUC 0.971068799495697
Test Epoch6 layer6 Acc 0.9981472482079942, AUC 0.9672931432723999
Test Epoch6 layer7 Acc 0.9981472482079942, AUC 0.97304368019104
Test Epoch6 layer8 Acc 0.9981472482079942, AUC 0.9652503728866577
Test Epoch6 layer9 Acc 0.9981674968614587, AUC 0.9752225279808044
gc 0
[[4.76601232e+03 1.80005426e+00]
 [4.41098968e-04 1.12195462e+00]
 [7.84918432e-04 8.64558591e-01]
 [1.28426709e-03 7.66155687e-01]
 [2.05710058e-03 6.66702783e-01]
 [1.41285195e-03 5.65387356e-01]
 [1.46123981e-03 5.38232060e-01]
 [1.64946831e-03 5.69285143e-01]
 [1.98685465e-03 5.58480786e-01]
 [3.24995829e-03 5.75146320e-01]]
Train Epoch7 Acc 0.9982863796289265 (394393/395070), AUC 0.9692739248275757
Test Epoch7 layer0 Acc 0.9979447616733487, AUC 0.9665243625640869
Test Epoch7 layer1 Acc 0.9980358806139392, AUC 0.9675306677818298
Test Epoch7 layer2 Acc 0.9980561292674037, AUC 0.9728687405586243
Test Epoch7 layer3 Acc 0.9980865022476005, AUC 0.9699563384056091
Test Epoch7 layer4 Acc 0.9980865022476005, AUC 0.9719079732894897
Test Epoch7 layer5 Acc 0.9981269995545297, AUC 0.9693853855133057
Test Epoch7 layer6 Acc 0.9981269995545297, AUC 0.9637861251831055
Test Epoch7 layer7 Acc 0.9981371238812619, AUC 0.9679660797119141
Test Epoch7 layer8 Acc 0.9981269995545297, AUC 0.9653560519218445
Test Epoch7 layer9 Acc 0.9981371238812619, AUC 0.9608806371688843
gc 0
[[4.76600521e+03 1.78504561e+00]
 [5.91266936e-05 1.08796767e+00]
 [9.53730783e-05 8.29691450e-01]
 [1.38630623e-04 7.30634496e-01]
 [2.08864501e-04 6.31334881e-01]
 [3.79415561e-04 5.47465406e-01]
 [5.67133380e-04 5.22831807e-01]
 [8.29334037e-04 5.54397252e-01]
 [1.19406304e-03 5.45153255e-01]
 [2.04009064e-03 5.63207047e-01]]
Train Epoch8 Acc 0.9983066292049511 (394401/395070), AUC 0.9635009169578552
Test Epoch8 layer0 Acc 0.9979852589802778, AUC 0.9665744304656982
Test Epoch8 layer1 Acc 0.9980763779208682, AUC 0.9712131023406982
Test Epoch8 layer2 Acc 0.9980763779208682, AUC 0.9729983806610107
Test Epoch8 layer3 Acc 0.9980966265743328, AUC 0.969857394695282
Test Epoch8 layer4 Acc 0.9981168752277974, AUC 0.9700418710708618
Test Epoch8 layer5 Acc 0.9981573725347265, AUC 0.9657302498817444
Test Epoch8 layer6 Acc 0.9981472482079942, AUC 0.9636568427085876
Test Epoch8 layer7 Acc 0.998177621188191, AUC 0.9666444659233093
Test Epoch8 layer8 Acc 0.9981674968614587, AUC 0.9628944993019104
Test Epoch8 layer9 Acc 0.9981674968614587, AUC 0.9682674407958984
gc 0
[[4.76600521e+03 1.76352660e+00]
 [1.04316837e-04 1.07753160e+00]
 [1.86772314e-04 8.22279383e-01]
 [3.11078495e-04 7.24696636e-01]
 [5.04802626e-04 6.26896698e-01]
 [3.11146468e-04 5.35159492e-01]
 [2.92154557e-04 5.07902720e-01]
 [2.92453600e-04 5.36131609e-01]
 [7.71671697e-04 5.31372664e-01]
 [8.58515494e-04 5.38134928e-01]]
Train Epoch9 Acc 0.9983294099779786 (394410/395070), AUC 0.9680147171020508
Test Epoch9 layer0 Acc 0.9979852589802778, AUC 0.9673932790756226
Test Epoch9 layer1 Acc 0.998066253594136, AUC 0.9680874347686768
Test Epoch9 layer2 Acc 0.9980865022476005, AUC 0.9715444445610046
Test Epoch9 layer3 Acc 0.9980966265743328, AUC 0.9690698385238647
Test Epoch9 layer4 Acc 0.998106750901065, AUC 0.9679806232452393
Test Epoch9 layer5 Acc 0.9981472482079942, AUC 0.9667672514915466
Test Epoch9 layer6 Acc 0.9981472482079942, AUC 0.9637731313705444
Test Epoch9 layer7 Acc 0.9981573725347265, AUC 0.9665201306343079
Test Epoch9 layer8 Acc 0.9981573725347265, AUC 0.9601303339004517
Test Epoch9 layer9 Acc 0.9981573725347265, AUC 0.9536753296852112
Best AUC 0.9921244978904724
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask10//kdd99/kdd99_linearal_l10_m10.pt
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   18     1 19412     7     0     2     0    16     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    5     0    20     0   293     0     0     0     0     0     0]
 [    0     0     5     0     0   245     0     0     0     0     0]
 [    0     4     4     0     0     0   200     0     0     0     0]
 [    0     0    13     0     0     0     0   191     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    0     2     8     3     0    21     1     5    13     0     0]
 [    0     3     8     0     0    22    14     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   18     1 19415     6     0     2     0    14     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     6     0     0   244     0     0     0     0     0]
 [    0     1     3     0     1     0   203     0     0     0     0]
 [    0     0    11     0     0     0     0   193     0     0     0]
 [    0     0     1     0     0     2     0     0   193     0     0]
 [    1     8    10     0     0    23     1     1     9     0     0]
 [   14     3     8     0     0    22     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19416     6     0     2     0    14     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     3     0     1     0   203     0     0     0     0]
 [    0     0    11     0     0     0     0   193     0     0     0]
 [    0     0     2     0     0     1     0     0   193     0     0]
 [    1    12    20     0     0    16     1     1     2     0     0]
 [   14     2    21     0     0     9     1     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19415     6     1     2     0    14     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    12     0   304     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     0     2     0     2     0   204     0     0     0     0]
 [    0     0    11     0     0     0     0   193     0     0     0]
 [    0     0     2     0     0     1     0     0   193     0     0]
 [    8     3    13     2     0    18     0     1     8     0     0]
 [    0     3    10     0     0    19    15     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19414     6     1     2     1    14     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    12     0   304     0     0     0     0     0     0]
 [    0     0     6     0     0   244     0     0     0     0     0]
 [    0     0     2     0     2     0   204     0     0     0     0]
 [    0     0    11     0     0     0     0   193     0     0     0]
 [    0     0     1     0     0     2     0     0   193     0     0]
 [    8     5    11     3     0    19     0     0     7     0     0]
 [    0     3     7     0     0    22    15     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19415     6     1     2     0    14     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    12     0   304     0     0     0     0     0     0]
 [    0     0     5     0     0   245     0     0     0     0     0]
 [    0     0     2     0     2     0   204     0     0     0     0]
 [    0     0    11     0     0     0     0   193     0     0     0]
 [    0     0     1     0     1     1     0     0   193     0     0]
 [    4     0    17    24     5     3     0     0     0     0     0]
 [    0     4     7     0     0    22    14     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19415     6     1     2     0    14     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    12     0   304     0     0     0     0     0     0]
 [    0     0     6     0     0   244     0     0     0     0     0]
 [    0     0     2     0     2     0   204     0     0     0     0]
 [    0     0    11     0     0     0     0   193     0     0     0]
 [    0     0     0     0     2     1     0     0   193     0     0]
 [    1     8     6    15    17     5     0     1     0     0     0]
 [    0     3     9     0     0    20    15     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19415     6     1     2     0    14     0     0     0]
 [    0     0     4   437     0     0     0     0     0     0     0]
 [    2     0    12     0   304     0     0     0     0     0     0]
 [    0     0     6     0     0   244     0     0     0     0     0]
 [    0     0     2     0     2     0   204     0     0     0     0]
 [    0     0    11     0     0     0     0   193     0     0     0]
 [    0     0     0     0     2     1     0     0   193     0     0]
 [    0     0     5    26    10     3     1     1     7     0     0]
 [    0    18     8     0     0    21     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19414     6     1     2     1    14     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    12     0   304     0     0     0     0     0     0]
 [    0     0     5     0     0   245     0     0     0     0     0]
 [    0     0     2     0     2     0   204     0     0     0     0]
 [    0     0    11     0     0     0     0   193     0     0     0]
 [    0     0     0     0     2     1     0     0   193     0     0]
 [    0     0     5    37    11     0     0     0     0     0     0]
 [    0    18     7     0     0    22     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19416     6     1     2     0    13     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    12     0   304     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     2     0     2     0   203     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     1     2     0     0     0     0   193     0     0]
 [    0     1    12    39     0     0     0     1     0     0     0]
 [    0    18    14     0     0    15     0     0     0     0     0]]
Figure(640x480)
