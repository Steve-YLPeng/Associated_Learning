Load ckpt from ./ckpt/mask8//kdd99/kdd99_linearal_l10_m8.pt
layer_mask {0, 1, 2, 3, 4, 5, 6, 7, 8}
Start Training
gc 9
[[4.76601232e+03 2.08308557e+00]
 [6.89510783e-04 1.27418869e+00]
 [1.15357044e-03 9.85260222e-01]
 [1.70371158e-03 8.72606218e-01]
 [2.77083500e-03 7.64031715e-01]
 [4.12879574e-03 6.68151453e-01]
 [5.77043021e-03 6.59889113e-01]
 [1.29213886e-02 7.29836895e-01]
 [1.85212418e+01 1.56290392e+01]
 [9.30279131e+02 7.00941032e+02]]
Train Epoch0 Acc 0.20518895385627864 (81064/395070), AUC 0.48385077714920044
Test Epoch0 layer0 Acc 0.9978131454258292, AUC 0.9617450833320618
Save ckpt to ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9980156319604746, AUC 0.9703802466392517
Save ckpt to ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9979751346535456, AUC 0.9735608696937561
Save ckpt to ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9980156319604746, AUC 0.9729158878326416
Test Epoch0 layer4 Acc 0.9980358806139392, AUC 0.9767813086509705
Save ckpt to ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt  ,ep 0
Test Epoch0 layer5 Acc 0.9980257562872069, AUC 0.9764280319213867
Test Epoch0 layer6 Acc 0.9980460049406714, AUC 0.9851087331771851
Save ckpt to ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt  ,ep 0
Test Epoch0 layer7 Acc 0.9980257562872069, AUC 0.9688325524330139
Test Epoch0 layer8 Acc 0.9979245130198842, AUC 0.8492593765258789
Test Epoch0 layer9 Acc 0.20267889685335924, AUC 0.5044042468070984
gc 0
[[4.76600521e+03 2.04596090e+00]
 [4.76910011e-04 1.25233610e+00]
 [8.60222289e-04 9.65424430e-01]
 [1.46780499e-03 8.53542848e-01]
 [2.43414831e-03 7.45728923e-01]
 [3.75251758e-03 6.51494099e-01]
 [5.42181939e-03 6.39780464e-01]
 [1.02597901e-02 6.97993487e-01]
 [8.27986223e-02 7.40201964e-01]
 [9.39596001e+02 6.98886592e+02]]
Train Epoch1 Acc 0.2041233199179892 (80643/395070), AUC 0.5020692348480225
Test Epoch1 layer0 Acc 0.9977220264852388, AUC 0.9639669060707092
Test Epoch1 layer1 Acc 0.9980460049406714, AUC 0.9760892391204834
Test Epoch1 layer2 Acc 0.9979953833070101, AUC 0.9773955941200256
Test Epoch1 layer3 Acc 0.9980460049406714, AUC 0.9714096188545227
Test Epoch1 layer4 Acc 0.9980460049406714, AUC 0.9707277417182922
Test Epoch1 layer5 Acc 0.9980358806139392, AUC 0.9728101491928101
Test Epoch1 layer6 Acc 0.9980460049406714, AUC 0.9723308682441711
Test Epoch1 layer7 Acc 0.9980460049406714, AUC 0.9713724255561829
Test Epoch1 layer8 Acc 0.9980257562872069, AUC 0.846309244632721
Test Epoch1 layer9 Acc 0.20519985420969505, AUC 0.5037183165550232
gc 0
[[4.76600521e+03 2.02053833e+00]
 [4.44730047e-04 1.24090342e+00]
 [8.02813701e-04 9.59781568e-01]
 [1.31321725e-03 8.49507987e-01]
 [2.02752168e-03 7.41778464e-01]
 [2.89806176e-03 6.48059871e-01]
 [3.90505025e-03 6.35264653e-01]
 [6.67067500e-03 6.89124781e-01]
 [1.91569249e-02 7.02955454e-01]
 [9.33087067e+02 6.80925493e+02]]
Train Epoch2 Acc 0.20545219834459716 (81168/395070), AUC 0.5047034621238708
Test Epoch2 layer0 Acc 0.9977827724456324, AUC 0.9730174541473389
Test Epoch2 layer1 Acc 0.998106750901065, AUC 0.9801549315452576
Test Epoch2 layer2 Acc 0.9980865022476005, AUC 0.9800426959991455
Test Epoch2 layer3 Acc 0.998106750901065, AUC 0.9762540459632874
Test Epoch2 layer4 Acc 0.9980966265743328, AUC 0.9766246676445007
Test Epoch2 layer5 Acc 0.998106750901065, AUC 0.9795083403587341
Test Epoch2 layer6 Acc 0.998106750901065, AUC 0.983223021030426
Test Epoch2 layer7 Acc 0.9981978698416555, AUC 0.9848423600196838
Test Epoch2 layer8 Acc 0.9980966265743328, AUC 0.8760721683502197
Test Epoch2 layer9 Acc 0.20539221641760824, AUC 0.5036638379096985
gc 0
[[4.76600521e+03 1.98946963e+00]
 [4.25768719e-04 1.22117114e+00]
 [6.99837684e-04 9.42787006e-01]
 [1.13629897e-03 8.33472975e-01]
 [1.80081879e-03 7.27206682e-01]
 [2.50058419e-03 6.33994382e-01]
 [3.38189550e-03 6.18735864e-01]
 [5.37917480e-03 6.67199602e-01]
 [1.05321178e-02 6.74857311e-01]
 [9.20923657e+02 6.58874546e+02]]
Train Epoch3 Acc 0.2056800060748728 (81258/395070), AUC 0.5054465532302856
Test Epoch3 layer0 Acc 0.9977827724456324, AUC 0.9660395979881287
Test Epoch3 layer1 Acc 0.998066253594136, AUC 0.9720854163169861
Test Epoch3 layer2 Acc 0.9980257562872069, AUC 0.9762067794799805
Test Epoch3 layer3 Acc 0.9980561292674037, AUC 0.9697160720825195
Test Epoch3 layer4 Acc 0.998066253594136, AUC 0.9691518545150757
Test Epoch3 layer5 Acc 0.9980561292674037, AUC 0.9695520401000977
Test Epoch3 layer6 Acc 0.998066253594136, AUC 0.9742504358291626
Test Epoch3 layer7 Acc 0.9980763779208682, AUC 0.9750264883041382
Test Epoch3 layer8 Acc 0.9980561292674037, AUC 0.8942079544067383
Test Epoch3 layer9 Acc 0.2055845786255214, AUC 0.5036823749542236
gc 0
[[4.76600521e+03 1.96416744e+00]
 [4.37726051e-04 1.20945055e+00]
 [7.75226337e-04 9.33957275e-01]
 [1.25801794e-03 8.24732745e-01]
 [2.02367043e-03 7.19958085e-01]
 [2.89517690e-03 6.28132287e-01]
 [3.84878971e-03 6.11091607e-01]
 [5.62623361e-03 6.58065787e-01]
 [9.42725105e-03 6.59956102e-01]
 [9.06986117e+02 6.38191328e+02]]
Train Epoch4 Acc 0.20579390994001062 (81303/395070), AUC 0.5059495568275452
Test Epoch4 layer0 Acc 0.997884015712955, AUC 0.9658588767051697
Test Epoch4 layer1 Acc 0.9980763779208682, AUC 0.9665641188621521
Test Epoch4 layer2 Acc 0.9980561292674037, AUC 0.9705215096473694
Test Epoch4 layer3 Acc 0.998066253594136, AUC 0.9714513421058655
Test Epoch4 layer4 Acc 0.9980561292674037, AUC 0.9749034643173218
Test Epoch4 layer5 Acc 0.998066253594136, AUC 0.974111795425415
Test Epoch4 layer6 Acc 0.9980966265743328, AUC 0.9767049551010132
Test Epoch4 layer7 Acc 0.9980865022476005, AUC 0.986278772354126
Save ckpt to ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt  ,ep 4
Test Epoch4 layer8 Acc 0.9980865022476005, AUC 0.947996199131012
Test Epoch4 layer9 Acc 0.20570607054630868, AUC 0.5044903755187988
gc 0
[[4.76600521e+03 1.93669753e+00]
 [4.11061156e-04 1.19459986e+00]
 [7.17643533e-04 9.22192189e-01]
 [1.13840137e-03 8.15154563e-01]
 [7.52605642e-04 6.92634904e-01]
 [1.85215900e-03 6.12287073e-01]
 [1.29649601e-03 5.76170815e-01]
 [3.55030324e-03 6.31080761e-01]
 [7.47105769e-03 6.30056586e-01]
 [8.92714154e+02 6.19524573e+02]]
Train Epoch5 Acc 0.2058015035310198 (81306/395070), AUC 0.5067164301872253
Test Epoch5 layer0 Acc 0.997843518406026, AUC 0.9439033269882202
Test Epoch5 layer1 Acc 0.9980460049406714, AUC 0.9463147521018982
Test Epoch5 layer2 Acc 0.998066253594136, AUC 0.9703277945518494
Test Epoch5 layer3 Acc 0.9980460049406714, AUC 0.9668576717376709
Test Epoch5 layer4 Acc 0.9980561292674037, AUC 0.9688258767127991
Test Epoch5 layer5 Acc 0.9980561292674037, AUC 0.9651796221733093
Test Epoch5 layer6 Acc 0.9980561292674037, AUC 0.959227979183197
Test Epoch5 layer7 Acc 0.9980763779208682, AUC 0.9489223957061768
Test Epoch5 layer8 Acc 0.9980460049406714, AUC 0.9514457583427429
Test Epoch5 layer9 Acc 0.20578706516016684, AUC 0.5057406425476074
gc 0
[[4.76601232e+03 1.92091132e+00]
 [4.48782131e-04 1.19093793e+00]
 [7.79475304e-04 9.19297108e-01]
 [1.24833462e-03 8.12344496e-01]
 [9.39124930e-04 6.92694155e-01]
 [2.21162035e-03 6.11229101e-01]
 [1.65776405e-03 5.76399244e-01]
 [3.88656519e-03 6.30133462e-01]
 [6.80698569e-03 6.28119701e-01]
 [8.80529714e+02 6.03308471e+02]]
Train Epoch6 Acc 0.20584200268306882 (81322/395070), AUC 0.5088123679161072
Test Epoch6 layer0 Acc 0.9978738913862228, AUC 0.9685709476470947
Test Epoch6 layer1 Acc 0.9980561292674037, AUC 0.9638264179229736
Test Epoch6 layer2 Acc 0.9980156319604746, AUC 0.9711465239524841
Test Epoch6 layer3 Acc 0.9980460049406714, AUC 0.9691686630249023
Test Epoch6 layer4 Acc 0.9980561292674037, AUC 0.9699222445487976
Test Epoch6 layer5 Acc 0.998066253594136, AUC 0.9688677191734314
Test Epoch6 layer6 Acc 0.9980561292674037, AUC 0.962877631187439
Test Epoch6 layer7 Acc 0.998066253594136, AUC 0.9619733691215515
Test Epoch6 layer8 Acc 0.9980561292674037, AUC 0.9593822360038757
Test Epoch6 layer9 Acc 0.2057364435265055, AUC 0.5070708990097046
gc 0
[[4.76600521e+03 1.85935354e+00]
 [6.10412533e-05 1.13684426e+00]
 [1.14917680e-04 8.71543555e-01]
 [1.96045164e-04 7.66922244e-01]
 [3.72977647e-04 6.66277973e-01]
 [4.85719653e-04 5.74700965e-01]
 [7.41198662e-04 5.53922680e-01]
 [2.53092301e-03 6.07376905e-01]
 [4.82784112e-03 6.09717847e-01]
 [8.69413864e+02 5.87508691e+02]]
Train Epoch7 Acc 0.20587490824410865 (81335/395070), AUC 0.5340064167976379
Test Epoch7 layer0 Acc 0.997884015712955, AUC 0.9672725200653076
Test Epoch7 layer1 Acc 0.998066253594136, AUC 0.9723709225654602
Test Epoch7 layer2 Acc 0.998066253594136, AUC 0.9768475890159607
Test Epoch7 layer3 Acc 0.9980865022476005, AUC 0.9707130789756775
Test Epoch7 layer4 Acc 0.9980763779208682, AUC 0.9711793661117554
Test Epoch7 layer5 Acc 0.998066253594136, AUC 0.9702778458595276
Test Epoch7 layer6 Acc 0.9980763779208682, AUC 0.9720696806907654
Test Epoch7 layer7 Acc 0.9980865022476005, AUC 0.9691770076751709
Test Epoch7 layer8 Acc 0.9980763779208682, AUC 0.9636896252632141
Test Epoch7 layer9 Acc 0.2057364435265055, AUC 0.5502914786338806
gc 0
[[4.76600521e+03 1.84718409e+00]
 [1.03027415e-04 1.13123100e+00]
 [1.78947358e-04 8.67123029e-01]
 [2.91035442e-04 7.64230977e-01]
 [4.75466107e-04 6.63868717e-01]
 [6.70919210e-04 5.73434682e-01]
 [9.00112392e-04 5.50993034e-01]
 [2.83900814e-03 6.01528819e-01]
 [4.85891358e-03 6.01657117e-01]
 [8.57428993e+02 5.71744455e+02]]
Train Epoch8 Acc 0.20589009542612702 (81341/395070), AUC 0.5556833744049072
Test Epoch8 layer0 Acc 0.9979245130198842, AUC 0.9680839776992798
Test Epoch8 layer1 Acc 0.998066253594136, AUC 0.9693519473075867
Test Epoch8 layer2 Acc 0.998066253594136, AUC 0.9749980568885803
Test Epoch8 layer3 Acc 0.9980966265743328, AUC 0.9736490249633789
Test Epoch8 layer4 Acc 0.9980865022476005, AUC 0.9722160696983337
Test Epoch8 layer5 Acc 0.9980966265743328, AUC 0.9719892740249634
Test Epoch8 layer6 Acc 0.9980966265743328, AUC 0.9740486741065979
Test Epoch8 layer7 Acc 0.998106750901065, AUC 0.9745439887046814
Test Epoch8 layer8 Acc 0.998106750901065, AUC 0.9665836095809937
Test Epoch8 layer9 Acc 0.20568582189284412, AUC 0.5596932768821716
gc 0
[[4.76600521e+03 1.83231941e+00]
 [1.11966558e-04 1.12182061e+00]
 [1.89224313e-04 8.59274298e-01]
 [3.04655578e-04 7.57161450e-01]
 [1.96277642e-04 6.49395134e-01]
 [4.63352088e-04 5.64583480e-01]
 [3.17260678e-04 5.34849907e-01]
 [6.23401745e-04 5.68548616e-01]
 [2.52116035e-03 5.73876546e-01]
 [8.48985250e+02 5.61139669e+02]]
Train Epoch9 Acc 0.20589262662313007 (81342/395070), AUC 0.5571911334991455
Test Epoch9 layer0 Acc 0.9979143886931519, AUC 0.9692151546478271
Test Epoch9 layer1 Acc 0.9980561292674037, AUC 0.9711768627166748
Test Epoch9 layer2 Acc 0.9980763779208682, AUC 0.9720001816749573
Test Epoch9 layer3 Acc 0.9980865022476005, AUC 0.9715397357940674
Test Epoch9 layer4 Acc 0.9980865022476005, AUC 0.9718568325042725
Test Epoch9 layer5 Acc 0.998106750901065, AUC 0.9715753793716431
Test Epoch9 layer6 Acc 0.998106750901065, AUC 0.9739500284194946
Test Epoch9 layer7 Acc 0.998106750901065, AUC 0.9764066338539124
Test Epoch9 layer8 Acc 0.998106750901065, AUC 0.964890718460083
Test Epoch9 layer9 Acc 0.20571619487304094, AUC 0.557181179523468
Best AUC 0.986278772354126
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   18     1 19412     7     0     2     0    16     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    5     0    20     0   293     0     0     0     0     0     0]
 [    0     0     5     0     0   245     0     0     0     0     0]
 [    0     4     4     0     0     0   200     0     0     0     0]
 [    0     0    14     0     0     0     0   190     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    0     0    20     0     0     8     1     5    19     0     0]
 [    0     1     9     0     0    22    15     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19417     6     0     2     0    13     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     4     0     1     0   202     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    4     4    22     0     0    11     0     1    11     0     0]
 [    0     1    13     0     0    18    15     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19418     6     0     2     0    12     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     8     0     0   242     0     0     0     0     0]
 [    0     1     3     0     1     0   203     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     2     0     0     0     0     0   194     0     0]
 [    0     4    40     0     0     3     1     1     4     0     0]
 [    0     2    26     0     0     4    15     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19416     6     1     2     0    13     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     2     0     2     0   203     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     0     1     0     0   195     0     0]
 [    2     0    25     0     0     3     7     1    15     0     0]
 [    0     2    20     0     0     9    16     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19416     6     1     2     0    13     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     2     0     2     0   203     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     1     0     0     1     0     0   194     0     0]
 [   13     1    21     4     0     3     1     0    10     0     0]
 [    0     2    15     0     0    14    16     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19416     6     1     2     0    13     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    12     0   304     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     2     0     2     0   203     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     1     0     0     1     0     0   194     0     0]
 [    3     0    32     5     0     0     1     0    12     0     0]
 [    0     2    13     0     0    16    16     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19417     6     1     2     0    12     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     0     2     0     2     0   204     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    0     5    22     9     0     0     1     1    15     0     0]
 [    0     2    20     0     0     9    16     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19417     6     1     2     0    12     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    12     0   304     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     2     0     2     0   203     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     1     0     0     0     0     0   195     0     0]
 [    0     0    28     9     0     0     2     1    13     0     0]
 [   14     4    17     0     0    12     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19417     6     1     2     0    12     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     2     0     2     0   203     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    0     0     7    31     0     0     0     0    15     0     0]
 [   14     4    12     0     0    17     0     0     0     0     0]]
Figure(640x480)
[[    0     0     4     0 56154     0     0     0     0     0     0]
 [    0     0     1     0    59     0     0     0 21381     0     0]
 [    0    28 19374     6    48     0     0     0     0     0     0]
 [    0     0     2   436     3     0     0     0     0     0     0]
 [    0     0     3     0   315     0     0     0     0     0     0]
 [    0     0     3     0   247     0     0     0     0     0     0]
 [    0   192     2     0    14     0     0     0     0     0     0]
 [    0   193    11     0     0     0     0     0     0     0     0]
 [    0     0     0     0     3     0     0     0   193     0     0]
 [    0     0     2     0    51     0     0     0     0     0     0]
 [    0     0     7     0    40     0     0     0     0     0     0]]
Figure(640x480)
