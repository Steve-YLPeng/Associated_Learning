Load ckpt from ./ckpt/mask5//kdd99/kdd99_linearal_l10_m5.pt
layer_mask {0, 1, 2, 3, 4, 5}
Start Training
gc 9
[[4.76600525e+03 2.96439964e+00]
 [6.76701643e-04 2.03971422e+00]
 [1.32530625e-03 1.69586040e+00]
 [5.61888398e-03 1.60397472e+00]
 [4.81576322e-02 1.65536352e+00]
 [2.56238019e+01 2.05924297e+01]
 [1.09332731e+03 8.01310040e+02]
 [7.43628641e+02 6.91978591e+02]
 [6.43964403e+02 6.39552909e+02]
 [5.17395453e+02 5.12636015e+02]]
Train Epoch0 Acc 0.0094312400334118 (3726/395070), AUC 0.5561976432800293
Test Epoch0 layer0 Acc 0.9970436965941765, AUC 0.975097119808197
Save ckpt to ./ckpt/mask6//kdd99/kdd99_linearal_l10_m6.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9974284210100028, AUC 0.9523394107818604
Test Epoch0 layer2 Acc 0.9973474263961447, AUC 0.9656395316123962
Test Epoch0 layer3 Acc 0.9973373020694124, AUC 0.927276611328125
Test Epoch0 layer4 Acc 0.9972968047624833, AUC 0.9703712463378906
Test Epoch0 layer5 Acc 0.996577977564492, AUC 0.9286994338035583
Test Epoch0 layer6 Acc 0.008109585712550115, AUC 0.3333137333393097
Test Epoch0 layer7 Acc 0.00259182764346171, AUC 0.579343855381012
Test Epoch0 layer8 Acc 0.0024399627424776253, AUC 0.4801596403121948
Test Epoch0 layer9 Acc 0.003462519742437128, AUC 0.5482151508331299
gc 0
[[4.76601234e+03 2.86185627e+00]
 [4.51137247e-04 1.92441034e+00]
 [7.85471491e-04 1.55510231e+00]
 [2.00456279e-03 1.43334620e+00]
 [7.08338780e-03 1.31711772e+00]
 [1.36280491e-01 1.40313500e+00]
 [1.09250787e+03 7.97361483e+02]
 [7.44685700e+02 6.82188214e+02]
 [6.36964153e+02 6.35534599e+02]
 [5.16810143e+02 5.04669214e+02]]
Train Epoch1 Acc 0.003348773635052016 (1323/395070), AUC 0.538913905620575
Test Epoch1 layer0 Acc 0.9971246912080347, AUC 0.9717653393745422
Test Epoch1 layer1 Acc 0.997509415623861, AUC 0.9488819241523743
Test Epoch1 layer2 Acc 0.9974182966832705, AUC 0.9600671529769897
Test Epoch1 layer3 Acc 0.997398048029806, AUC 0.925772488117218
Test Epoch1 layer4 Acc 0.9973676750496092, AUC 0.9554845690727234
Test Epoch1 layer5 Acc 0.9973271777426801, AUC 0.9077236652374268
Test Epoch1 layer6 Acc 0.0020856113068480945, AUC 0.3202819228172302
Test Epoch1 layer7 Acc 0.0026525736038553434, AUC 0.5606289505958557
Test Epoch1 layer8 Acc 0.0026120762969262545, AUC 0.46115562319755554
Test Epoch1 layer9 Acc 0.0034118981087757666, AUC 0.5230697393417358
gc 0
[[4.76600522e+03 2.76010680e+00]
 [4.64320855e-04 1.82438650e+00]
 [8.19816014e-04 1.44795854e+00]
 [1.34712467e-03 1.31645597e+00]
 [3.47156942e-03 1.18518167e+00]
 [2.03768068e-02 1.12144485e+00]
 [1.07873277e+03 7.78275071e+02]
 [7.40119470e+02 6.65224131e+02]
 [6.34635304e+02 6.21609307e+02]
 [5.15163532e+02 4.97317324e+02]]
Train Epoch2 Acc 0.0033361176500367024 (1318/395070), AUC 0.5088903307914734
Test Epoch2 layer0 Acc 0.9971651885149637, AUC 0.9750565886497498
Test Epoch2 layer1 Acc 0.9977119021585065, AUC 0.964289665222168
Test Epoch2 layer2 Acc 0.9975701615842546, AUC 0.9658971428871155
Test Epoch2 layer3 Acc 0.9975397886040578, AUC 0.9441205859184265
Test Epoch2 layer4 Acc 0.9975195399505933, AUC 0.9629592299461365
Test Epoch2 layer5 Acc 0.997509415623861, AUC 0.8959562182426453
Test Epoch2 layer6 Acc 0.0015085246831085732, AUC 0.3204009234905243
Test Epoch2 layer7 Acc 0.0024399627424776253, AUC 0.5414806604385376
Test Epoch2 layer8 Acc 0.0025817033167294377, AUC 0.5037773251533508
Test Epoch2 layer9 Acc 0.0033815251285789494, AUC 0.4837956428527832
gc 0
[[4.76601233e+03 2.66622719e+00]
 [4.80581818e-04 1.74440390e+00]
 [8.67413800e-04 1.36961975e+00]
 [1.48483434e-03 1.23534857e+00]
 [2.83995271e-03 1.09881813e+00]
 [9.02087330e-03 1.01567927e+00]
 [1.07130121e+03 7.61213180e+02]
 [7.36709531e+02 6.52723661e+02]
 [6.31521196e+02 6.11043237e+02]
 [5.15689481e+02 4.90378299e+02]]
Train Epoch3 Acc 0.003381679196091832 (1336/395070), AUC 0.48739078640937805
Test Epoch3 layer0 Acc 0.9972664317822865, AUC 0.9691897034645081
Test Epoch3 layer1 Acc 0.9976106588911837, AUC 0.9617769122123718
Test Epoch3 layer2 Acc 0.9975701615842546, AUC 0.9631319642066956
Test Epoch3 layer3 Acc 0.997509415623861, AUC 0.9416339993476868
Test Epoch3 layer4 Acc 0.9975296642773256, AUC 0.9391647577285767
Test Epoch3 layer5 Acc 0.997509415623861, AUC 0.8783512711524963
Test Epoch3 layer6 Acc 0.0006783298910622444, AUC 0.3202331066131592
Test Epoch3 layer7 Acc 0.002126108613777184, AUC 0.5386056303977966
Test Epoch3 layer8 Acc 0.002531081683068076, AUC 0.5032203197479248
Test Epoch3 layer9 Acc 0.0033714008018466773, AUC 0.49136802554130554
gc 0
[[4.76600522e+03 2.59445456e+00]
 [4.52504683e-04 1.68059437e+00]
 [8.16244127e-04 1.30973031e+00]
 [1.37503529e-03 1.17527631e+00]
 [2.30663742e-03 1.03660592e+00]
 [5.34140392e-03 9.41607888e-01]
 [1.06505528e+03 7.47884321e+02]
 [7.32131657e+02 6.43141023e+02]
 [6.27046016e+02 6.03142173e+02]
 [5.14249544e+02 4.82516688e+02]]
Train Epoch4 Acc 0.0034044599691193966 (1345/395070), AUC 0.4801209568977356
Test Epoch4 layer0 Acc 0.9973271777426801, AUC 0.9642471075057983
Test Epoch4 layer1 Acc 0.9977726481189001, AUC 0.9577970504760742
Test Epoch4 layer2 Acc 0.9976714048515773, AUC 0.962978720664978
Test Epoch4 layer3 Acc 0.9977017778317742, AUC 0.9499112963676453
Test Epoch4 layer4 Acc 0.997691653505042, AUC 0.9553515911102295
Test Epoch4 layer5 Acc 0.9976714048515773, AUC 0.89065021276474
Test Epoch4 layer6 Acc 0.0006783298910622444, AUC 0.3192729949951172
Test Epoch4 layer7 Acc 0.003098043980075325, AUC 0.5396595597267151
Test Epoch4 layer8 Acc 0.0025513303365326204, AUC 0.48170214891433716
Test Epoch4 layer9 Acc 0.0034827683959016724, AUC 0.4613546133041382
gc 0
[[4.76600522e+03 2.50552684e+00]
 [4.63265271e-04 1.61181840e+00]
 [8.16332760e-04 1.24814708e+00]
 [1.32549702e-03 1.11508882e+00]
 [8.88217783e-04 9.55861247e-01]
 [1.70278921e-03 8.47908687e-01]
 [1.06084396e+03 7.42743361e+02]
 [7.29246958e+02 6.38866484e+02]
 [6.24299728e+02 5.99577615e+02]
 [5.13086864e+02 4.79959198e+02]]
Train Epoch5 Acc 0.0034145847571316478 (1349/395070), AUC 0.47339925169944763
Test Epoch5 layer0 Acc 0.9974284210100028, AUC 0.9659286141395569
Test Epoch5 layer1 Acc 0.9978131454258292, AUC 0.9646191000938416
Test Epoch5 layer2 Acc 0.9978030210990969, AUC 0.9695366024971008
Test Epoch5 layer3 Acc 0.9978232697525614, AUC 0.9531612992286682
Test Epoch5 layer4 Acc 0.9978232697525614, AUC 0.96392422914505
Test Epoch5 layer5 Acc 0.9977928967723646, AUC 0.9068216681480408
Test Epoch5 layer6 Acc 0.0007289515247236059, AUC 0.3121207356452942
Test Epoch5 layer7 Acc 0.0033815251285789494, AUC 0.5338671207427979
Test Epoch5 layer8 Acc 0.0025513303365326204, AUC 0.4873438775539398
Test Epoch5 layer9 Acc 0.0034726440691694002, AUC 0.45396435260772705
gc 0
[[4.76600522e+03 2.46697995e+00]
 [4.35322441e-04 1.56400356e+00]
 [7.73158051e-04 1.20652369e+00]
 [1.37763114e-03 1.07426987e+00]
 [1.06982089e-03 9.24073930e-01]
 [1.52128566e-03 8.15920682e-01]
 [1.05921831e+03 7.42506728e+02]
 [7.27951275e+02 6.37920713e+02]
 [6.23177089e+02 5.98888255e+02]
 [5.12624740e+02 4.79909970e+02]]
Train Epoch6 Acc 0.003409522363125522 (1347/395070), AUC 0.4654194712638855
Test Epoch6 layer0 Acc 0.9974385453367351, AUC 0.9692434668540955
Test Epoch6 layer1 Acc 0.9977625237921678, AUC 0.9732839465141296
Test Epoch6 layer2 Acc 0.9977625237921678, AUC 0.9750462174415588
Test Epoch6 layer3 Acc 0.9978030210990969, AUC 0.9640198349952698
Test Epoch6 layer4 Acc 0.9977726481189001, AUC 0.9655184149742126
Test Epoch6 layer5 Acc 0.9977422751387033, AUC 0.9332387447357178
Test Epoch6 layer6 Acc 0.0007694488316526951, AUC 0.31173941493034363
Test Epoch6 layer7 Acc 0.0032802818612562264, AUC 0.5340996980667114
Test Epoch6 layer8 Acc 0.0026525736038553434, AUC 0.4848099648952484
Test Epoch6 layer9 Acc 0.0034118981087757666, AUC 0.47173288464546204
gc 0
[[4.76600522e+03 2.43843283e+00]
 [4.71271086e-04 1.52666350e+00]
 [8.06814710e-04 1.17537852e+00]
 [1.26401370e-03 1.04407133e+00]
 [9.63738831e-04 8.98243675e-01]
 [1.22847847e-03 7.89400941e-01]
 [1.05776949e+03 7.41145491e+02]
 [7.26953135e+02 6.36857670e+02]
 [6.22311698e+02 5.97262978e+02]
 [5.12290294e+02 4.79008000e+02]]
Train Epoch7 Acc 0.0033563672260612043 (1326/395070), AUC 0.4621668756008148
Test Epoch7 layer0 Acc 0.9974385453367351, AUC 0.955525815486908
Test Epoch7 layer1 Acc 0.9978738913862228, AUC 0.9660990238189697
Test Epoch7 layer2 Acc 0.997843518406026, AUC 0.972032904624939
Test Epoch7 layer3 Acc 0.9978738913862228, AUC 0.9686699509620667
Test Epoch7 layer4 Acc 0.9978536427327582, AUC 0.9680421352386475
Test Epoch7 layer5 Acc 0.9978637670594905, AUC 0.9463043212890625
Test Epoch7 layer6 Acc 0.009607986068926416, AUC 0.3105406165122986
Test Epoch7 layer7 Acc 0.003128416960272142, AUC 0.5522289276123047
Test Epoch7 layer8 Acc 0.0024804600494067143, AUC 0.5017451643943787
Test Epoch7 layer9 Acc 0.003330903494917588, AUC 0.4705554246902466
gc 0
[[4.76600522e+03 2.40694762e+00]
 [4.50626434e-04 1.49322127e+00]
 [7.60120345e-04 1.15043949e+00]
 [1.21574891e-03 1.02456625e+00]
 [9.40832796e-04 8.81385648e-01]
 [1.11153660e-03 7.72796719e-01]
 [1.05656499e+03 7.41523560e+02]
 [7.26151616e+02 6.36777640e+02]
 [6.21641483e+02 5.97439045e+02]
 [5.11955527e+02 4.78996033e+02]]
Train Epoch8 Acc 0.0031969018148682513 (1263/395070), AUC 0.4563259184360504
Test Epoch8 layer0 Acc 0.997468918316932, AUC 0.9576457738876343
Test Epoch8 layer1 Acc 0.997843518406026, AUC 0.9691135883331299
Test Epoch8 layer2 Acc 0.9978333940792937, AUC 0.9735082387924194
Test Epoch8 layer3 Acc 0.9977625237921678, AUC 0.9651491641998291
Test Epoch8 layer4 Acc 0.9978030210990969, AUC 0.9676104187965393
Test Epoch8 layer5 Acc 0.9978333940792937, AUC 0.9549742341041565
Test Epoch8 layer6 Acc 0.020926983355606853, AUC 0.3094053864479065
Test Epoch8 layer7 Acc 0.003492892722633945, AUC 0.5727528929710388
Test Epoch8 layer8 Acc 0.0025412060098003483, AUC 0.5011674165725708
Test Epoch8 layer9 Acc 0.0031891629206657755, AUC 0.4584156274795532
gc 0
[[4.76600522e+03 2.36321777e+00]
 [4.80666388e-04 1.44467995e+00]
 [8.89345346e-04 1.11015108e+00]
 [1.46834370e-03 9.84086494e-01]
 [6.49010843e-04 8.40046827e-01]
 [9.66133473e-04 7.38898264e-01]
 [1.05523539e+03 7.42194895e+02]
 [7.25342301e+02 6.36545491e+02]
 [6.21025754e+02 5.97055549e+02]
 [5.11728234e+02 4.78823951e+02]]
Train Epoch9 Acc 0.0028931581745007214 (1143/395070), AUC 0.4535366892814636
Test Epoch9 layer0 Acc 0.9974992912971288, AUC 0.9599733948707581
Test Epoch9 layer1 Acc 0.9979042643664197, AUC 0.9683560729026794
Test Epoch9 layer2 Acc 0.9978941400396873, AUC 0.9780426621437073
Save ckpt to ./ckpt/mask6//kdd99/kdd99_linearal_l10_m6.pt  ,ep 9
Test Epoch9 layer3 Acc 0.9979346373466165, AUC 0.9687826633453369
Test Epoch9 layer4 Acc 0.9979447616733487, AUC 0.9702048897743225
Test Epoch9 layer5 Acc 0.9979042643664197, AUC 0.9594523906707764
Test Epoch9 layer6 Acc 0.1604098327461224, AUC 0.31389111280441284
Test Epoch9 layer7 Acc 0.003594135989956668, AUC 0.5753065347671509
Test Epoch9 layer8 Acc 0.0026120762969262545, AUC 0.5062118172645569
Test Epoch9 layer9 Acc 0.0013060381484631272, AUC 0.44913041591644287
Best AUC 0.9780426621437073
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask6//kdd99/kdd99_linearal_l10_m6.pt
[[56150     0     8     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   18     1 19412     9     0     3     0    13     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    5     0    23     0   290     0     0     0     0     0     0]
 [    0     0     6     0     0   236     5     3     0     0     0]
 [    0     8     6     0     0     0   194     0     0     0     0]
 [    0     0    30     0     0     0     0   174     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    3     1     9     2     0    18     2     2    16     0     0]
 [    0     1    11     0     0    21    14     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   18     0 19413     8     0     3     0    14     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    5     0    18     0   295     0     0     0     0     0     0]
 [    0     0     6     0     0   244     0     0     0     0     0]
 [    0     3     6     0     0     0   199     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    7     3    18     0     0     6     0     4    15     0     0]
 [   14     0    10     0     0    22     1     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     0 19416     7     0     3     0    13     0     0     0]
 [    0     0    14   427     0     0     0     0     0     0     0]
 [    2     0    16     0   300     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     3     6     0     0     0   199     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    0     2    28     3     0     4     0     1    15     0     0]
 [   15     0    25     0     0     7     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     0 19415     7     1     3     0    13     0     0     0]
 [    0     0    10   431     0     0     0     0     0     0     0]
 [    2     0    15     0   301     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     3     6     0     0     0   199     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    2     0    27     5     0     3     0     1    15     0     0]
 [    0     0    40     0     0     7     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     0 19417     7     0     2     0    13     0     0     0]
 [    0     0    11   430     0     0     0     0     0     0     0]
 [    2     0    15     0   301     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     3     5     0     0     0   200     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     1     0     0     1     0     0     0   194     0     0]
 [    7    16     8     4     0     3     0     1    14     0     0]
 [    0     1    23     0     0     9    14     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     0 19416     7     0     3     0    13     0     0     0]
 [    0     0    14   427     0     0     0     0     0     0     0]
 [    2     0    14     0   302     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     4     5     0     0     0   199     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     1     1     0     0   194     0     0]
 [    2     0    25     7     0     4     0     1    14     0     0]
 [    0     1    35     0     0    11     0     0     0     0     0]]
Figure(640x480)
[[    0     5     0     0     0     3     0     0 56150     0     0]
 [    0     0 21441     0     0     0     0     0     0     0     0]
 [    0  3583 15844     1     0     1     0     3    24     0     0]
 [    0     0     9     0     0     0     0     0   432     0     0]
 [    0    11     5     0     0   302     0     0     0     0     0]
 [    0     2     4     0     0     0     0   244     0     0     0]
 [    0     7    12     0     0     0     0   189     0     0     0]
 [    0   129     5    25     0     0     0     0    45     0     0]
 [    0     0     0     0     0     3     0   193     0     0     0]
 [    0     0     4     0     0    49     0     0     0     0     0]
 [    0     1    25     0     0     0     0    21     0     0     0]]
Figure(640x480)
[[    0     0     0     0 56153     0     5     0     0     0     0]
 [    0     0     0     0 21440     0     1     0     0     0     0]
 [    0     0     0     0    41     0 19413     2     0     0     0]
 [    0     0     0     0   435     0     6     0     0     0     0]
 [    0     0     0     1     2     0   315     0     0     0     0]
 [    0     0     0     0    26     0     5   219     0     0     0]
 [    0     0     0     0     7     0   201     0     0     0     0]
 [    0     0     0     0    40     0    12   152     0     0     0]
 [    0     0     0     0     3     0   193     0     0     0     0]
 [    0     0     0     0    51     0     2     0     0     0     0]
 [    0     0     0     0    40     0     7     0     0     0     0]]
Figure(640x480)
[[    2     0     0     0     0 56151     5     0     0     0     0]
 [    0     0     0 21345     0    70    26     0     0     0     0]
 [    5     0     0     0    15    50 19386     0     0     0     0]
 [  423     0     0     0     1    15     2     0     0     0     0]
 [  298     0     0     0    10     2     8     0     0     0     0]
 [    0     1     0     0     0   244     5     0     0     0     0]
 [    5     0     0   186     2     4     2     9     0     0     0]
 [  107     0     0     0     3    83    11     0     0     0     0]
 [  194     0     0     0     1     1     0     0     0     0     0]
 [    1     0     0     0    15    35     2     0     0     0     0]
 [    0     0     0     0     0    40     7     0     0     0     0]]
Figure(640x480)
[[    0     0     0     0 56158     0     0     0     0     0     0]
 [    0     5     1 21434     1     0     0     0     0     0     0]
 [    0     7    15     0 19434     0     0     0     0     0     0]
 [    0   427     1     0    13     0     0     0     0     0     0]
 [    0     0     0   209   109     0     0     0     0     0     0]
 [    0     0     0     0   250     0     0     0     0     0     0]
 [    0     0     0   169    39     0     0     0     0     0     0]
 [    0     0   192     0    12     0     0     0     0     0     0]
 [    0     0     0     0   196     0     0     0     0     0     0]
 [    0     0    19     0    34     0     0     0     0     0     0]
 [    0     0     0     0    47     0     0     0     0     0     0]]
Figure(640x480)
