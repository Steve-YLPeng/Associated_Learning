Load ckpt from ./ckpt/mask6//kdd99/kdd99_linearal_l10_m6.pt
layer_mask {0, 1, 2, 3, 4, 5, 6}
Start Training
gc 9
[[4.76600522e+03 2.38259880e+00]
 [7.18228176e-04 1.43624486e+00]
 [1.30347135e-03 1.10464506e+00]
 [2.12541169e-03 9.80574672e-01]
 [3.35170892e-03 8.70191665e-01]
 [4.97069436e-03 7.69567918e-01]
 [2.28899422e+01 1.44446156e+01]
 [8.66497769e+02 8.48079680e+02]
 [8.33899164e+02 6.61392532e+02]
 [6.87623162e+02 4.85727722e+02]]
Train Epoch0 Acc 0.2087250360695573 (82461/395070), AUC 0.47910022735595703
Test Epoch0 layer0 Acc 0.997509415623861, AUC 0.9591985940933228
Save ckpt to ./ckpt/mask7//kdd99/kdd99_linearal_l10_m7.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9978333940792937, AUC 0.9746484160423279
Save ckpt to ./ckpt/mask7//kdd99/kdd99_linearal_l10_m7.pt  ,ep 0
Test Epoch0 layer2 Acc 0.997843518406026, AUC 0.9790937304496765
Save ckpt to ./ckpt/mask7//kdd99/kdd99_linearal_l10_m7.pt  ,ep 0
Test Epoch0 layer3 Acc 0.997884015712955, AUC 0.9724636673927307
Test Epoch0 layer4 Acc 0.9978738913862228, AUC 0.9709681868553162
Test Epoch0 layer5 Acc 0.9978536427327582, AUC 0.9754737615585327
Test Epoch0 layer6 Acc 0.9975904102377192, AUC 0.8959242105484009
Test Epoch0 layer7 Acc 0.0002227351881099907, AUC 0.5893805623054504
Test Epoch0 layer8 Acc 0.5683594540963026, AUC 0.49156320095062256
Test Epoch0 layer9 Acc 0.22021423075365487, AUC 0.4955100119113922
gc 0
[[4.76600522e+03 2.32864639e+00]
 [4.65207236e-04 1.40579151e+00]
 [8.40746691e-04 1.08290667e+00]
 [1.36215831e-03 9.59276569e-01]
 [2.27613785e-03 8.46849135e-01]
 [3.44205069e-03 7.46563443e-01]
 [1.00049446e-01 8.58556059e-01]
 [8.86386578e+02 8.60816085e+02]
 [8.45300661e+02 6.63848038e+02]
 [7.00479554e+02 4.89413707e+02]]
Train Epoch1 Acc 0.2202622320095173 (87019/395070), AUC 0.5175864100456238
Test Epoch1 layer0 Acc 0.9975600372575224, AUC 0.9530724883079529
Test Epoch1 layer1 Acc 0.9979143886931519, AUC 0.9657087922096252
Test Epoch1 layer2 Acc 0.997884015712955, AUC 0.9722499847412109
Test Epoch1 layer3 Acc 0.997954886000081, AUC 0.965691328048706
Test Epoch1 layer4 Acc 0.9979143886931519, AUC 0.966844379901886
Test Epoch1 layer5 Acc 0.9978941400396873, AUC 0.9677101373672485
Test Epoch1 layer6 Acc 0.9978738913862228, AUC 0.8728933930397034
Test Epoch1 layer7 Acc 0.00020248653464544606, AUC 0.5880463123321533
Test Epoch1 layer8 Acc 0.5684202000566962, AUC 0.49758628010749817
Test Epoch1 layer9 Acc 0.22023447940711943, AUC 0.5344091057777405
gc 0
[[4.76601232e+03 2.28011149e+00]
 [4.13647424e-04 1.37568422e+00]
 [7.07292680e-04 1.05870615e+00]
 [1.17881851e-03 9.37510139e-01]
 [1.98696075e-03 8.25209758e-01]
 [3.01105646e-03 7.26811215e-01]
 [2.01450196e-02 7.65707146e-01]
 [8.85044208e+02 8.49509775e+02]
 [8.43778488e+02 6.55134556e+02]
 [7.01666619e+02 4.81815783e+02]]
Train Epoch2 Acc 0.2202622320095173 (87019/395070), AUC 0.5291780233383179
Test Epoch2 layer0 Acc 0.9976005345644514, AUC 0.9698000550270081
Test Epoch2 layer1 Acc 0.9979953833070101, AUC 0.9745650887489319
Test Epoch2 layer2 Acc 0.9979143886931519, AUC 0.9779284000396729
Test Epoch2 layer3 Acc 0.9979751346535456, AUC 0.9762371182441711
Test Epoch2 layer4 Acc 0.9979447616733487, AUC 0.9707244634628296
Test Epoch2 layer5 Acc 0.9979447616733487, AUC 0.9779629111289978
Test Epoch2 layer6 Acc 0.997954886000081, AUC 0.9023027420043945
Test Epoch2 layer7 Acc 0.00020248653464544606, AUC 0.6067772507667542
Test Epoch2 layer8 Acc 0.5684606973636254, AUC 0.5038301944732666
Test Epoch2 layer9 Acc 0.22025472806058397, AUC 0.525253415107727
gc 0
[[4.76600521e+03 2.23421296e+00]
 [4.72759475e-04 1.35288978e+00]
 [8.39541704e-04 1.04080761e+00]
 [1.39876308e-03 9.20598716e-01]
 [2.24685594e-03 8.09316199e-01]
 [3.28810162e-03 7.11787548e-01]
 [8.08445710e-03 7.33346627e-01]
 [8.80736394e+02 8.33079767e+02]
 [8.41432543e+02 6.43538241e+02]
 [7.00035933e+02 4.72742836e+02]]
Train Epoch3 Acc 0.22025463841850812 (87016/395070), AUC 0.5288890600204468
Test Epoch3 layer0 Acc 0.9975904102377192, AUC 0.9583261013031006
Test Epoch3 layer1 Acc 0.997954886000081, AUC 0.971330463886261
Test Epoch3 layer2 Acc 0.9979245130198842, AUC 0.9806011319160461
Save ckpt to ./ckpt/mask7//kdd99/kdd99_linearal_l10_m7.pt  ,ep 3
Test Epoch3 layer3 Acc 0.9979852589802778, AUC 0.9793717861175537
Test Epoch3 layer4 Acc 0.9979852589802778, AUC 0.9786885976791382
Test Epoch3 layer5 Acc 0.9979751346535456, AUC 0.9870569705963135
Save ckpt to ./ckpt/mask7//kdd99/kdd99_linearal_l10_m7.pt  ,ep 3
Test Epoch3 layer6 Acc 0.997954886000081, AUC 0.9434852004051208
Test Epoch3 layer7 Acc 0.00019236220791317378, AUC 0.5988755822181702
Test Epoch3 layer8 Acc 0.5684708216903576, AUC 0.5009509325027466
Test Epoch3 layer9 Acc 0.22026485238731625, AUC 0.5261304378509521
gc 0
[[4.76600521e+03 2.18742412e+00]
 [4.02537470e-04 1.32888270e+00]
 [6.92176906e-04 1.02356229e+00]
 [1.11531169e-03 9.05972311e-01]
 [1.81668291e-03 7.94580910e-01]
 [2.69728896e-03 6.97580720e-01]
 [5.19459524e-03 7.05419114e-01]
 [8.75079300e+02 8.15245273e+02]
 [8.38139701e+02 6.32023260e+02]
 [6.96368491e+02 4.64276938e+02]]
Train Epoch4 Acc 0.22025716961551117 (87017/395070), AUC 0.530931830406189
Test Epoch4 layer0 Acc 0.9975904102377192, AUC 0.9638661742210388
Test Epoch4 layer1 Acc 0.9979650103268133, AUC 0.9705671072006226
Test Epoch4 layer2 Acc 0.9979143886931519, AUC 0.9751667380332947
Test Epoch4 layer3 Acc 0.9979953833070101, AUC 0.9719932079315186
Test Epoch4 layer4 Acc 0.9979650103268133, AUC 0.976661741733551
Test Epoch4 layer5 Acc 0.9979650103268133, AUC 0.9837647080421448
Test Epoch4 layer6 Acc 0.9980055076337424, AUC 0.9702771902084351
Test Epoch4 layer7 Acc 0.00023285951484226298, AUC 0.5808833241462708
Test Epoch4 layer8 Acc 0.5684606973636254, AUC 0.5009205937385559
Test Epoch4 layer9 Acc 0.22025472806058397, AUC 0.5296375155448914
gc 0
[[4.76600521e+03 2.15175177e+00]
 [6.40470507e-05 1.28330414e+00]
 [4.47398609e-04 9.96009738e-01]
 [8.28957241e-04 8.82527672e-01]
 [1.48382831e-03 7.76421573e-01]
 [2.27493293e-03 6.84594064e-01]
 [3.79049424e-03 6.87725781e-01]
 [8.69362696e+02 7.95437416e+02]
 [8.34472465e+02 6.19965918e+02]
 [6.92823624e+02 4.55208305e+02]]
Train Epoch5 Acc 0.22025716961551117 (87017/395070), AUC 0.532833456993103
Test Epoch5 layer0 Acc 0.9976714048515773, AUC 0.9721598029136658
Test Epoch5 layer1 Acc 0.9980055076337424, AUC 0.9830568432807922
Test Epoch5 layer2 Acc 0.9979953833070101, AUC 0.9803007245063782
Test Epoch5 layer3 Acc 0.9980358806139392, AUC 0.9793039560317993
Test Epoch5 layer4 Acc 0.9980358806139392, AUC 0.971365213394165
Test Epoch5 layer5 Acc 0.9980257562872069, AUC 0.976820707321167
Test Epoch5 layer6 Acc 0.9980257562872069, AUC 0.9755033254623413
Test Epoch5 layer7 Acc 0.0002429838415745353, AUC 0.5868801474571228
Test Epoch5 layer8 Acc 0.5684202000566962, AUC 0.5006963610649109
Test Epoch5 layer9 Acc 0.22025472806058397, AUC 0.5291511416435242
gc 0
[[4.76600521e+03 2.11128615e+00]
 [1.04578293e-04 1.26873537e+00]
 [4.87769393e-04 9.85144664e-01]
 [9.23939744e-04 8.72737920e-01]
 [1.62367620e-03 7.66528898e-01]
 [2.47409225e-03 6.72626786e-01]
 [3.69253168e-03 6.68094487e-01]
 [8.62595547e+02 7.75437081e+02]
 [8.30014765e+02 6.08673263e+02]
 [6.88837489e+02 4.47147350e+02]]
Train Epoch6 Acc 0.22025970081251423 (87018/395070), AUC 0.5353630185127258
Test Epoch6 layer0 Acc 0.9976815291783097, AUC 0.9539148211479187
Test Epoch6 layer1 Acc 0.9980257562872069, AUC 0.9648063778877258
Test Epoch6 layer2 Acc 0.9979953833070101, AUC 0.9727073311805725
Test Epoch6 layer3 Acc 0.9980460049406714, AUC 0.9683321118354797
Test Epoch6 layer4 Acc 0.9980460049406714, AUC 0.9698131680488586
Test Epoch6 layer5 Acc 0.9980358806139392, AUC 0.9709339737892151
Test Epoch6 layer6 Acc 0.998066253594136, AUC 0.9730386137962341
Test Epoch6 layer7 Acc 0.0004859676831490706, AUC 0.5862435698509216
Test Epoch6 layer8 Acc 0.5684910703438222, AUC 0.4926701486110687
Test Epoch6 layer9 Acc 0.22026485238731625, AUC 0.531934380531311
gc 0
[[4.76600521e+03 2.07873903e+00]
 [1.14212002e-04 1.25779941e+00]
 [5.39041513e-04 9.73687783e-01]
 [1.02672604e-03 8.64209947e-01]
 [1.84431492e-03 7.57085246e-01]
 [2.77074735e-03 6.63365286e-01]
 [4.04879455e-03 6.55949142e-01]
 [8.55982440e+02 7.57289500e+02]
 [8.25622121e+02 5.96856769e+02]
 [6.85027162e+02 4.40376369e+02]]
Train Epoch7 Acc 0.22025970081251423 (87018/395070), AUC 0.5387259125709534
Test Epoch7 layer0 Acc 0.9977119021585065, AUC 0.960466206073761
Test Epoch7 layer1 Acc 0.9980156319604746, AUC 0.9677908420562744
Test Epoch7 layer2 Acc 0.9979852589802778, AUC 0.9737269878387451
Test Epoch7 layer3 Acc 0.998066253594136, AUC 0.9754137396812439
Test Epoch7 layer4 Acc 0.9980561292674037, AUC 0.9711379408836365
Test Epoch7 layer5 Acc 0.9980358806139392, AUC 0.9720978140830994
Test Epoch7 layer6 Acc 0.9980460049406714, AUC 0.9803405404090881
Test Epoch7 layer7 Acc 0.0009213137326367797, AUC 0.5544993877410889
Test Epoch7 layer8 Acc 0.5684708216903576, AUC 0.49588826298713684
Test Epoch7 layer9 Acc 0.22026485238731625, AUC 0.5316075682640076
gc 0
[[4.76600521e+03 2.05153111e+00]
 [1.08330411e-04 1.24816757e+00]
 [1.48506957e-04 9.47453240e-01]
 [2.16907453e-04 8.32683661e-01]
 [3.30357803e-04 7.22639367e-01]
 [4.82256662e-04 6.26382250e-01]
 [1.85880500e-03 6.30887263e-01]
 [8.50946631e+02 7.42958720e+02]
 [8.22490349e+02 5.87194090e+02]
 [6.82279964e+02 4.35046688e+02]]
Train Epoch8 Acc 0.22025970081251423 (87018/395070), AUC 0.5393752455711365
Test Epoch8 layer0 Acc 0.9977119021585065, AUC 0.9590299725532532
Test Epoch8 layer1 Acc 0.9979953833070101, AUC 0.9664051532745361
Test Epoch8 layer2 Acc 0.9979953833070101, AUC 0.9696336388587952
Test Epoch8 layer3 Acc 0.9980358806139392, AUC 0.9669138193130493
Test Epoch8 layer4 Acc 0.9980156319604746, AUC 0.9690592288970947
Test Epoch8 layer5 Acc 0.9980055076337424, AUC 0.9679896831512451
Test Epoch8 layer6 Acc 0.9980257562872069, AUC 0.9610164761543274
Test Epoch8 layer7 Acc 0.001964119386060827, AUC 0.5497959852218628
Test Epoch8 layer8 Acc 0.5684809460170899, AUC 0.4599493741989136
Test Epoch8 layer9 Acc 0.22026485238731625, AUC 0.5403861403465271
gc 0
[[4.76600521e+03 2.01564114e+00]
 [1.07928925e-04 1.23380663e+00]
 [1.89124737e-04 9.36398177e-01]
 [3.13230563e-04 8.23130768e-01]
 [5.06611034e-04 7.13987824e-01]
 [7.27544920e-04 6.19797363e-01]
 [2.29875945e-03 6.22142729e-01]
 [8.45757438e+02 7.30934430e+02]
 [8.19603538e+02 5.78342348e+02]
 [6.79432837e+02 4.30102469e+02]]
Train Epoch9 Acc 0.22025970081251423 (87018/395070), AUC 0.5399975180625916
Test Epoch9 layer0 Acc 0.9978536427327582, AUC 0.9677093029022217
Test Epoch9 layer1 Acc 0.998066253594136, AUC 0.9696694016456604
Test Epoch9 layer2 Acc 0.9980763779208682, AUC 0.9731680154800415
Test Epoch9 layer3 Acc 0.998066253594136, AUC 0.9729211330413818
Test Epoch9 layer4 Acc 0.998066253594136, AUC 0.9741684198379517
Test Epoch9 layer5 Acc 0.998066253594136, AUC 0.9724085330963135
Test Epoch9 layer6 Acc 0.9980763779208682, AUC 0.9799346923828125
Test Epoch9 layer7 Acc 0.001994492366257644, AUC 0.5452432036399841
Test Epoch9 layer8 Acc 0.5684606973636254, AUC 0.48768720030784607
Test Epoch9 layer9 Acc 0.22026485238731625, AUC 0.536491334438324
Best AUC 0.9870569705963135
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask7//kdd99/kdd99_linearal_l10_m7.pt
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   18     1 19413     8     0     1     0    15     0     0     0]
 [    0     0     8   433     0     0     0     0     0     0     0]
 [    5     0    20     0   293     0     0     0     0     0     0]
 [    0     0     5     0     0   237     5     3     0     0     0]
 [    0     7     6     0     0     0   195     0     0     0     0]
 [    0     0    28     0     0     0     0   176     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    0     1     9     2     0    18     2     5    16     0     0]
 [    0     1    10     0     0    22    14     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19414     7     1     2     0    14     0     0     0]
 [    0     0     9   432     0     0     0     0     0     0     0]
 [    3     0    14     0   301     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     3     4     0     1     0   200     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    5     3    14     0     0    11     0     5    15     0     0]
 [    0     0    27     0     0    20     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19414     6     1     3     0    14     0     0     0]
 [    0     0    14   427     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     2     4     0     1     0   201     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     1     0     1     0     0     0   194     0     0]
 [    0    16    24     0     0     3     0     1     9     0     0]
 [    0     0    39     0     0     8     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19414     6     1     2     0    15     0     0     0]
 [    0     0    10   431     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     3     0     2     0   202     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    9     8    14     4     2     0     0     1    15     0     0]
 [    0     2    35     0     0    10     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19413     6     1     2     0    16     0     0     0]
 [    0     0    10   431     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     2     0     2     0   203     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [   19     4     9     2     0     3     0     1    15     0     0]
 [    0     1    18     0     0    13    15     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19413     6     1     2     0    16     0     0     0]
 [    0     0    10   431     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     2     2     0     2     0   202     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    1     0    12    20     0     2     0     1    17     0     0]
 [    0     4    13     0     0    16     0     0    14     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19415     6     1     2     0    14     0     0     0]
 [    0     0    14   427     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     4     0     1     0   202     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [   16     0    10     0     0     0     0     2    25     0     0]
 [    0     1    37     0     0     9     0     0     0     0     0]]
Figure(640x480)
[[    0     0     0     0 56158     0     0     0     0     0     0]
 [    0     0     0     0 21441     0     0     0     0     0     0]
 [    0     0     0     0 19449     0     6     1     0     0     0]
 [    0     0     0     0    75     0   366     0     0     0     0]
 [    0     0     0     0    14     0   304     0     0     0     0]
 [    0     0     0     0    30     0     0   220     0     0     0]
 [    0     0     0     0   203     0     5     0     0     0     0]
 [    0     0     0     0   204     0     0     0     0     0     0]
 [    0     0     0     0     3     0   193     0     0     0     0]
 [    0     0     0     0    53     0     0     0     0     0     0]
 [    0     0     0     0    47     0     0     0     0     0     0]]
Figure(640x480)
[[56142     0     0     0     0     0    16     0     0     0     0]
 [    0     0     0 21437     0     0     4     0     0     0     0]
 [   19     2     0     0    22     0 19413     0     0     0     0]
 [  425     0     0     0     1     0    15     0     0     0     0]
 [  296     0     0     0     0     0    22     0     0     0     0]
 [    2   226     0     0     0     0    22     0     0     0     0]
 [   30     0   169     2     0     0     7     0     0     0     0]
 [  176     0     0     0    17     0    11     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   49     0     0     0     0     0     4     0     0     0     0]
 [   25     0     0     0     0     0    22     0     0     0     0]]
Figure(640x480)
[[    0     4     0     0 56154     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [    0 19432     0     0    22     0     0     2     0     0     0]
 [    0   429     0     0    12     0     0     0     0     0     0]
 [    0     3     0     0   315     0     0     0     0     0     0]
 [    0     8     0     0     0     0     0   242     0     0     0]
 [    0    10     0     0    14     0     0   184     0     0     0]
 [    0   201     3     0     0     0     0     0     0     0     0]
 [    0   195     0     0     1     0     0     0     0     0     0]
 [    0    48     0     0     5     0     0     0     0     0     0]
 [    0    25     0    15     0     0     0     7     0     0     0]]
Figure(640x480)
