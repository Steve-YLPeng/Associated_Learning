Load ckpt from ./ckpt/mask4//kdd99/kdd99_linearalside_l5_m4.pt
layer_mask {0, 1, 2, 3, 4}
Start Training
gc 9
[[4.76600528e+03 3.62385679e+02]
 [9.28442416e-04 2.47852119e+02]
 [4.31322082e-03 1.52097610e+01]
 [4.43935522e-02 6.55608878e+00]
 [3.07823132e+01 2.85151418e+01]]
Train Epoch0 Acc 0.9648163616574278 (381170/395070), AUC 0.956281304359436
Test Epoch0 layer0 Acc 0.6908131859231361, AUC 0.7963689565658569
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearalside_l5_m5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7267039241890414, AUC 0.7858629822731018
Test Epoch0 layer2 Acc 0.9886708783865873, AUC 0.9519342184066772
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearalside_l5_m5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.992821852346819, AUC 0.9683690667152405
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearalside_l5_m5.pt  ,ep 0
Test Epoch0 layer4 Acc 0.9941683878022112, AUC 0.987220048904419
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearalside_l5_m5.pt  ,ep 0
gc 0
[[4.76600525e+03 3.61034263e+02]
 [4.50608459e-04 2.47876977e+02]
 [1.12014170e-03 1.41566773e+01]
 [4.70019289e-03 5.09137589e+00]
 [1.40838723e-01 4.05056882e+00]]
Train Epoch1 Acc 0.9953577846963829 (393236/395070), AUC 0.9804952144622803
Test Epoch1 layer0 Acc 0.6985987931802535, AUC 0.7972991466522217
Test Epoch1 layer1 Acc 0.7267950431296318, AUC 0.7885177731513977
Test Epoch1 layer2 Acc 0.9886810027133196, AUC 0.9002668261528015
Test Epoch1 layer3 Acc 0.9938342850200461, AUC 0.9510851502418518
Test Epoch1 layer4 Acc 0.9955452962378002, AUC 0.9757552742958069
gc 0
[[4.76600523e+03 3.59892294e+02]
 [4.64678069e-04 2.47711920e+02]
 [8.86834239e-04 1.33279763e+01]
 [2.25188787e-03 4.44509360e+00]
 [2.13109353e-02 3.10560194e+00]]
Train Epoch2 Acc 0.9957349330498393 (393385/395070), AUC 0.976126492023468
Test Epoch2 layer0 Acc 0.7124994937836634, AUC 0.7996517419815063
Test Epoch2 layer1 Acc 0.7268254161098286, AUC 0.7871407866477966
Test Epoch2 layer2 Acc 0.9887113756935164, AUC 0.899935781955719
Test Epoch2 layer3 Acc 0.9948467176932734, AUC 0.9493991732597351
Test Epoch2 layer4 Acc 0.9957680314259102, AUC 0.9725876450538635
gc 0
[[4.76600522e+03 3.58648850e+02]
 [4.50981762e-04 2.46877916e+02]
 [8.12320789e-04 1.25875030e+01]
 [1.54016022e-03 4.04926721e+00]
 [7.81324256e-03 2.67402483e+00]]
Train Epoch3 Acc 0.9959652719771179 (393476/395070), AUC 0.9753469824790955
Test Epoch3 layer0 Acc 0.7148483375855506, AUC 0.7513481378555298
Test Epoch3 layer1 Acc 0.726835540436561, AUC 0.7873480319976807
Test Epoch3 layer2 Acc 0.988660754059855, AUC 0.8996503353118896
Test Epoch3 layer3 Acc 0.9949175879803993, AUC 0.9390771389007568
Test Epoch3 layer4 Acc 0.9959198963268943, AUC 0.9658586978912354
gc 0
[[4.76600522e+03 3.57506282e+02]
 [4.76616892e-04 2.45525833e+02]
 [8.73175168e-04 1.17864222e+01]
 [1.54903436e-03 3.77477020e+00]
 [4.49962350e-03 2.40797939e+00]]
Train Epoch4 Acc 0.996124737388311 (393539/395070), AUC 0.9674842357635498
Test Epoch4 layer0 Acc 0.7174604138824768, AUC 0.7099838256835938
Test Epoch4 layer1 Acc 0.7270279026444741, AUC 0.7152119278907776
Test Epoch4 layer2 Acc 0.9888632405945005, AUC 0.8966276049613953
Test Epoch4 layer3 Acc 0.9950390799011866, AUC 0.9336884021759033
Test Epoch4 layer4 Acc 0.9962236261288624, AUC 0.9632307291030884
gc 0
[[4.76600522e+03 3.56618562e+02]
 [4.87193324e-04 2.43512758e+02]
 [3.20332242e-04 1.11383014e+01]
 [3.77248028e-04 3.58803981e+00]
 [1.23402867e-03 2.21764594e+00]]
Train Epoch5 Acc 0.9963525451185866 (393629/395070), AUC 0.9635871648788452
Test Epoch5 layer0 Acc 0.717986878872555, AUC 0.7091348171234131
Test Epoch5 layer1 Acc 0.7272303891791196, AUC 0.7190722227096558
Test Epoch5 layer2 Acc 0.9888531162677682, AUC 0.8943881392478943
Test Epoch5 layer3 Acc 0.9950492042279189, AUC 0.9285287857055664
Test Epoch5 layer4 Acc 0.9963856153565788, AUC 0.9628495573997498
gc 0
[[4.76600522e+03 3.55697760e+02]
 [5.21193094e-05 2.40784940e+02]
 [1.27563281e-04 1.06753714e+01]
 [2.66235501e-04 3.46955062e+00]
 [7.09871891e-04 2.09895051e+00]]
Train Epoch6 Acc 0.9965449160908193 (393705/395070), AUC 0.960175096988678
Test Epoch6 layer0 Acc 0.7181083707933422, AUC 0.7097302079200745
Test Epoch6 layer1 Acc 0.7273012594662455, AUC 0.7182861566543579
Test Epoch6 layer2 Acc 0.9889746081885554, AUC 0.8878908753395081
Test Epoch6 layer3 Acc 0.9950694528813834, AUC 0.9274811148643494
Test Epoch6 layer4 Acc 0.996466609970437, AUC 0.9589186310768127
gc 0
[[4.76600522e+03 3.54946874e+02]
 [1.23098820e-04 2.38199611e+02]
 [2.36720733e-04 1.02750914e+01]
 [4.23996985e-04 3.37994474e+00]
 [7.49701146e-04 2.00193605e+00]]
Train Epoch7 Acc 0.9967423494570582 (393783/395070), AUC 0.9575641751289368
Test Epoch7 layer0 Acc 0.7182703600210586, AUC 0.7093194723129272
Test Epoch7 layer1 Acc 0.7279795893573078, AUC 0.7201436758041382
Test Epoch7 layer2 Acc 0.9899262949013891, AUC 0.8892557621002197
Test Epoch7 layer3 Acc 0.9950492042279189, AUC 0.9258769750595093
Test Epoch7 layer4 Acc 0.996729842465476, AUC 0.9546671509742737
gc 0
[[4.76600522e+03 3.54469053e+02]
 [1.12501273e-04 2.34926941e+02]
 [1.97389632e-04 9.91750825e+00]
 [3.25631462e-04 3.29476861e+00]
 [5.34969613e-04 1.91069508e+00]]
Train Epoch8 Acc 0.9969271268382818 (393856/395070), AUC 0.9522544741630554
Test Epoch8 layer0 Acc 0.7183209816547199, AUC 0.7093107104301453
Test Epoch8 layer1 Acc 0.7404628842181995, AUC 0.7193556427955627
Test Epoch8 layer2 Acc 0.9910804681488681, AUC 0.8890325427055359
Test Epoch8 layer3 Acc 0.9950998258615802, AUC 0.9266237020492554
Test Epoch8 layer4 Acc 0.9968209614060665, AUC 0.9524210095405579
gc 0
[[4.76600522e+03 3.53988007e+02]
 [1.16006765e-04 2.30770212e+02]
 [7.68367662e-05 9.66271041e+00]
 [9.16890584e-05 3.21649078e+00]
 [1.32083704e-04 1.82091545e+00]]
Train Epoch9 Acc 0.997015718733389 (393891/395070), AUC 0.9530776739120483
Test Epoch9 layer0 Acc 0.7184019762685782, AUC 0.6760420203208923
Test Epoch9 layer1 Acc 0.743044587534929, AUC 0.7177233099937439
Test Epoch9 layer2 Acc 0.9914044466043008, AUC 0.8888698816299438
Test Epoch9 layer3 Acc 0.9950694528813834, AUC 0.9277839660644531
Test Epoch9 layer4 Acc 0.996952577653586, AUC 0.9514452219009399
Best AUC 0.987220048904419
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//kdd99/kdd99_linearalside_l5_m5.pt
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 8010     0 11379    67     0     0     0     0     0     0     0]
 [    1     0    12   428     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  194     0    13     0     0     0     1     0     0     0     0]
 [  126     0     3     4     0     0     0    71     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    2     0     0     0     0     0     0     0    51     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 4503     0 14915    33     0     0     0     5     0     0     0]
 [    0     0     2   439     0     0     0     0     0     0     0]
 [  317     0     1     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  194     0    13     0     0     0     1     0     0     0     0]
 [    0     0   135     0     0     0     0    69     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    2     0     0     0     0     0     0     0    51     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56112     0    46     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   17    11 19392    31     0     0     0     5     0     0     0]
 [    0     0     2   439     0     0     0     0     0     0     0]
 [    0   278    40     0     0     0     0     0     0     0     0]
 [    0     0   250     0     0     0     0     0     0     0     0]
 [    0    24   180     0     0     0     4     0     0     0     0]
 [    0     0   135     0     0     0     0    69     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    0     0     2     0     0     0     0     0    51     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56112     0    46     0     0     0     0     0     0     0     0]
 [    0 21437     4     0     0     0     0     0     0     0     0]
 [   18     3 19399    31     0     0     0     5     0     0     0]
 [    0     0     2   439     0     0     0     0     0     0     0]
 [    0     0    41     0   277     0     0     0     0     0     0]
 [    0     0   226     0     0     0    24     0     0     0     0]
 [    0    29    16     0    25     0   138     0     0     0     0]
 [    0     0   138     0     0     0     0    66     0     0     0]
 [    0     0     1     0     0     0     0     0   195     0     0]
 [    0     0    17     0     0     0     0     0    36     0     0]
 [    0    16    31     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56118     0    40     0     0     0     0     0     0     0     0]
 [    0 21432     9     0     0     0     0     0     0     0     0]
 [   12     4 19405    24     0    11     0     0     0     0     0]
 [    0     0     2   439     0     0     0     0     0     0     0]
 [    0     0    40     0   278     0     0     0     0     0     0]
 [    0     0    34     0     0   216     0     0     0     0     0]
 [    0    35    26     0    28     0   119     0     0     0     0]
 [    0     0   191    12     0     0     0     1     0     0     0]
 [    0     5     3     0     0     0     0     0   188     0     0]
 [    0     0    27     3     0    23     0     0     0     0     0]
 [    0    16    31     0     0     0     0     0     0     0     0]]
Figure(640x480)
