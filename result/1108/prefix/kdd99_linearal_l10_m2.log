Load ckpt from ./ckpt/mask1//kdd99/kdd99_linearal_l10_m1.pt
layer_mask {0, 1}
Start Training
gc 9
[[4.76602456e+03 3.47748844e+00]
 [2.69612912e+01 3.25106516e+01]
 [1.18549435e+03 9.85781815e+02]
 [1.01033369e+03 7.09537317e+02]
 [9.33057223e+02 7.55200419e+02]
 [6.65278661e+02 6.46009019e+02]
 [6.19943046e+02 5.38257548e+02]
 [6.48906003e+02 5.89326095e+02]
 [6.11885997e+02 4.69019042e+02]
 [5.93074775e+02 4.22800581e+02]]
Train Epoch0 Acc 0.5774293163236894 (228125/395070), AUC 0.5566446185112
Test Epoch0 layer0 Acc 0.9959806422872879, AUC 0.9926633834838867
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearal_l10_m2.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9950897015348479, AUC 0.9901199340820312
Test Epoch0 layer2 Acc 0.0002834811485036245, AUC 0.5114546418190002
Test Epoch0 layer3 Acc 0.006682055643299721, AUC 0.38775351643562317
Test Epoch0 layer4 Acc 0.2171364354270441, AUC 0.3905562460422516
Test Epoch0 layer5 Acc 0.043139756206212285, AUC 0.3557315170764923
Test Epoch0 layer6 Acc 0.7609342728708541, AUC 0.3967076539993286
Test Epoch0 layer7 Acc 0.04188433969141052, AUC 0.8063199520111084
Test Epoch0 layer8 Acc 0.15857732960758109, AUC 0.7518954873085022
Test Epoch0 layer9 Acc 0.5726420443040537, AUC 0.505418598651886
gc 0
[[4.76600691e+03 3.62355143e+00]
 [1.32305736e-01 4.35963315e+00]
 [1.31725156e+03 1.06434115e+03]
 [1.08811199e+03 7.60443888e+02]
 [1.00835676e+03 8.13019958e+02]
 [7.01797013e+02 6.82237942e+02]
 [6.44558316e+02 5.64889908e+02]
 [6.72517682e+02 6.14598941e+02]
 [6.29473623e+02 4.85588565e+02]
 [6.06375450e+02 4.26435659e+02]]
Train Epoch1 Acc 0.5704609309742578 (225372/395070), AUC 0.5373386740684509
Test Epoch1 layer0 Acc 0.9961527558417366, AUC 0.9926195740699768
Test Epoch1 layer1 Acc 0.9960110152674847, AUC 0.9801448583602905
Test Epoch1 layer2 Acc 0.001569270643502207, AUC 0.48975399136543274
Test Epoch1 layer3 Acc 0.01261491110841129, AUC 0.36765164136886597
Test Epoch1 layer4 Acc 0.21717693273397318, AUC 0.36310115456581116
Test Epoch1 layer5 Acc 0.04304863726562184, AUC 0.39637067914009094
Test Epoch1 layer6 Acc 0.7621289434252623, AUC 0.4201405346393585
Test Epoch1 layer7 Acc 0.043321994087393186, AUC 0.8003957271575928
Test Epoch1 layer8 Acc 0.042188069493378694, AUC 0.7116989493370056
Test Epoch1 layer9 Acc 0.5696249949378366, AUC 0.5672836303710938
gc 0
[[4.76600556e+03 3.54807481e+00]
 [2.51723745e-02 3.16854026e+00]
 [1.35084433e+03 1.10439649e+03]
 [1.11093355e+03 7.83941473e+02]
 [1.03399858e+03 8.42550099e+02]
 [7.11135365e+02 6.97844456e+02]
 [6.54188783e+02 5.78462003e+02]
 [6.79616325e+02 6.21863407e+02]
 [6.34847916e+02 4.91765645e+02]
 [6.09635497e+02 4.31267973e+02]]
Train Epoch2 Acc 0.5700863138178044 (225224/395070), AUC 0.5714370608329773
Test Epoch2 layer0 Acc 0.9963957396833111, AUC 0.9930896759033203
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearal_l10_m2.pt  ,ep 2
Test Epoch2 layer1 Acc 0.9967500911189406, AUC 0.9654996395111084
Test Epoch2 layer2 Acc 0.001235167861337221, AUC 0.4645099639892578
Test Epoch2 layer3 Acc 0.02817600129591382, AUC 0.3525811433792114
Test Epoch2 layer4 Acc 0.21724780302109908, AUC 0.33636489510536194
Test Epoch2 layer5 Acc 0.04283602640424412, AUC 0.34023019671440125
Test Epoch2 layer6 Acc 0.7628578949499858, AUC 0.42581379413604736
Test Epoch2 layer7 Acc 0.043402988701251366, AUC 0.7765559554100037
Test Epoch2 layer8 Acc 0.017434090632972906, AUC 0.6493382453918457
Test Epoch2 layer9 Acc 0.570009719353663, AUC 0.5791507363319397
gc 0
[[4.76600536e+03 3.40334722e+00]
 [3.31289465e-03 2.68550211e+00]
 [1.36660755e+03 1.12886291e+03]
 [1.11603886e+03 8.01495571e+02]
 [1.04423139e+03 8.60732203e+02]
 [7.15001415e+02 7.09868502e+02]
 [6.59730027e+02 5.88514132e+02]
 [6.82116666e+02 6.24937957e+02]
 [6.36633299e+02 4.93851675e+02]
 [6.09724057e+02 4.33825069e+02]]
Train Epoch3 Acc 0.5704862429442884 (225382/395070), AUC 0.5812769532203674
Test Epoch3 layer0 Acc 0.9964463613169724, AUC 0.9835005402565002
Test Epoch3 layer1 Acc 0.9968918316931924, AUC 0.9370336532592773
Test Epoch3 layer2 Acc 0.0007694488316526951, AUC 0.4804353713989258
Test Epoch3 layer3 Acc 0.05581541327501721, AUC 0.34871986508369446
Test Epoch3 layer4 Acc 0.21726805167456364, AUC 0.32461047172546387
Test Epoch3 layer5 Acc 0.04284615073097639, AUC 0.33806154131889343
Test Epoch3 layer6 Acc 0.7633944842667962, AUC 0.41090166568756104
Test Epoch3 layer7 Acc 0.04341311302798364, AUC 0.7582067847251892
Test Epoch3 layer8 Acc 0.013910824930142146, AUC 0.6318039894104004
Test Epoch3 layer9 Acc 0.5703336978090957, AUC 0.5885137915611267
gc 0
[[4.76600530e+03 3.24394314e+00]
 [6.04255629e-04 2.39704125e+00]
 [1.37546793e+03 1.14417163e+03]
 [1.11976548e+03 8.11995388e+02]
 [1.04761502e+03 8.69226818e+02]
 [7.16528444e+02 7.17168828e+02]
 [6.61474179e+02 5.91149268e+02]
 [6.83788251e+02 6.26038704e+02]
 [6.37461634e+02 4.93408016e+02]
 [6.09745469e+02 4.34485887e+02]]
Train Epoch4 Acc 0.5702179360619637 (225276/395070), AUC 0.5882771015167236
Test Epoch4 layer0 Acc 0.9967500911189406, AUC 0.9813873767852783
Test Epoch4 layer1 Acc 0.9971145668813024, AUC 0.9333198070526123
Test Epoch4 layer2 Acc 0.0009111894059045073, AUC 0.49032723903656006
Test Epoch4 layer3 Acc 0.08647187462033774, AUC 0.34478357434272766
Test Epoch4 layer4 Acc 0.21736929494188637, AUC 0.328769326210022
Test Epoch4 layer5 Acc 0.04281577775077957, AUC 0.31441351771354675
Test Epoch4 layer6 Acc 0.762938889563844, AUC 0.41700631380081177
Test Epoch4 layer7 Acc 0.043402988701251366, AUC 0.754163384437561
Test Epoch4 layer8 Acc 0.013890576276677601, AUC 0.6110421419143677
Test Epoch4 layer9 Acc 0.5703033248288989, AUC 0.5948336124420166
gc 0
[[4.76600528e+03 3.10111961e+00]
 [6.66040476e-05 2.19562869e+00]
 [1.38263870e+03 1.15637772e+03]
 [1.12413305e+03 8.19542463e+02]
 [1.05096822e+03 8.74210687e+02]
 [7.18335893e+02 7.23404883e+02]
 [6.63012416e+02 5.92703157e+02]
 [6.85325311e+02 6.26918277e+02]
 [6.38739182e+02 4.93730898e+02]
 [6.10432482e+02 4.35504346e+02]]
Train Epoch5 Acc 0.5702229984559698 (225278/395070), AUC 0.5902615189552307
Test Epoch5 layer0 Acc 0.9970436965941765, AUC 0.9760363101959229
Test Epoch5 layer1 Acc 0.9974182966832705, AUC 0.9393718242645264
Test Epoch5 layer2 Acc 0.0008605677722431459, AUC 0.48749446868896484
Test Epoch5 layer3 Acc 0.10368323006520067, AUC 0.3439377546310425
Test Epoch5 layer4 Acc 0.21739966792208318, AUC 0.3333585560321808
Test Epoch5 layer5 Acc 0.04281577775077957, AUC 0.3250652849674225
Test Epoch5 layer6 Acc 0.7622909326529785, AUC 0.42246487736701965
Test Epoch5 layer7 Acc 0.04338274004778682, AUC 0.7490140795707703
Test Epoch5 layer8 Acc 0.013890576276677601, AUC 0.615466833114624
Test Epoch5 layer9 Acc 0.5704146924229538, AUC 0.5925719738006592
gc 0
[[4.76600525e+03 2.97590892e+00]
 [1.18139328e-04 2.09478632e+00]
 [1.38786410e+03 1.16585509e+03]
 [1.12746900e+03 8.24225807e+02]
 [1.05359532e+03 8.75876332e+02]
 [7.19852313e+02 7.28055890e+02]
 [6.64218486e+02 5.92559389e+02]
 [6.86523296e+02 6.26923176e+02]
 [6.39796288e+02 4.94031950e+02]
 [6.11060386e+02 4.35830298e+02]]
Train Epoch6 Acc 0.5702634976080189 (225294/395070), AUC 0.5905715227127075
Test Epoch6 layer0 Acc 0.9970538209209088, AUC 0.9693931937217712
Test Epoch6 layer1 Acc 0.9974385453367351, AUC 0.9359950423240662
Test Epoch6 layer2 Acc 0.0006378325841331551, AUC 0.4936085045337677
Test Epoch6 layer3 Acc 0.1125521402826712, AUC 0.3403395414352417
Test Epoch6 layer4 Acc 0.21739966792208318, AUC 0.3335472345352173
Test Epoch6 layer5 Acc 0.04281577775077957, AUC 0.32965943217277527
Test Epoch6 layer6 Acc 0.7624023002470336, AUC 0.42373383045196533
Test Epoch6 layer7 Acc 0.043433361681448186, AUC 0.7447165846824646
Test Epoch6 layer8 Acc 0.014214554732110314, AUC 0.6074916124343872
Test Epoch6 layer9 Acc 0.5704450654031507, AUC 0.5911611914634705
gc 0
[[4.76600523e+03 2.84780241e+00]
 [1.12655800e-04 1.99659994e+00]
 [1.39088237e+03 1.17217221e+03]
 [1.12926388e+03 8.27684026e+02]
 [1.05501405e+03 8.76686577e+02]
 [7.20684908e+02 7.31342975e+02]
 [6.64935971e+02 5.91898774e+02]
 [6.87298883e+02 6.26253981e+02]
 [6.40529764e+02 4.94408099e+02]
 [6.11418707e+02 4.35736859e+02]]
Train Epoch7 Acc 0.5702837471840433 (225302/395070), AUC 0.5903260111808777
Test Epoch7 layer0 Acc 0.9971044425545701, AUC 0.97208172082901
Test Epoch7 layer1 Acc 0.9974891669703965, AUC 0.9453701376914978
Test Epoch7 layer2 Acc 0.0004454703762199814, AUC 0.4960459768772125
Test Epoch7 layer3 Acc 0.1137974324707407, AUC 0.32331016659736633
Test Epoch7 layer4 Acc 0.21716680840724092, AUC 0.33340105414390564
Test Epoch7 layer5 Acc 0.0428056534240473, AUC 0.32462525367736816
Test Epoch7 layer6 Acc 0.7615316081480582, AUC 0.43003132939338684
Test Epoch7 layer7 Acc 0.04347385898837727, AUC 0.7417796850204468
Test Epoch7 layer8 Acc 0.014204430405378042, AUC 0.6032782196998596
Test Epoch7 layer9 Acc 0.5703033248288989, AUC 0.5941123366355896
gc 0
[[4.76600523e+03 2.79653087e+00]
 [1.12208222e-04 1.92759496e+00]
 [1.39244173e+03 1.17590180e+03]
 [1.12997398e+03 8.29851483e+02]
 [1.05548133e+03 8.76841950e+02]
 [7.21109667e+02 7.33414763e+02]
 [6.65243689e+02 5.90688172e+02]
 [6.87738437e+02 6.24706886e+02]
 [6.40926988e+02 4.94282842e+02]
 [6.11585842e+02 4.34688494e+02]]
Train Epoch8 Acc 0.5702002176829423 (225269/395070), AUC 0.5900586843490601
Test Epoch8 layer0 Acc 0.997175312841696, AUC 0.9759573340415955
Test Epoch8 layer1 Acc 0.9975397886040578, AUC 0.9516966342926025
Test Epoch8 layer2 Acc 0.0004454703762199814, AUC 0.4684165120124817
Test Epoch8 layer3 Acc 0.11907220669825457, AUC 0.31568193435668945
Test Epoch8 layer4 Acc 0.21022152026890212, AUC 0.33185601234436035
Test Epoch8 layer5 Acc 0.04279552909731503, AUC 0.3131614029407501
Test Epoch8 layer6 Acc 0.7598914672174301, AUC 0.4416908025741577
Test Epoch8 layer7 Acc 0.043483983315109546, AUC 0.7371480464935303
Test Epoch8 layer8 Acc 0.014295549345968493, AUC 0.5969917178153992
Test Epoch8 layer9 Acc 0.5702425788685053, AUC 0.5940355062484741
gc 0
[[4.76601234e+03 2.74838549e+00]
 [1.63079519e-05 1.86204285e+00]
 [1.39392564e+03 1.17984146e+03]
 [1.13077414e+03 8.32181074e+02]
 [1.05605446e+03 8.77378057e+02]
 [7.21521990e+02 7.34972011e+02]
 [6.65588861e+02 5.90213138e+02]
 [6.88137311e+02 6.24362055e+02]
 [6.41297158e+02 4.94486088e+02]
 [6.11788112e+02 4.34453421e+02]]
Train Epoch9 Acc 0.5701647809248994 (225255/395070), AUC 0.5892447233200073
Test Epoch9 layer0 Acc 0.9971348155347669, AUC 0.9634484648704529
Test Epoch9 layer1 Acc 0.9974992912971288, AUC 0.9373560547828674
Test Epoch9 layer2 Acc 0.00034422710889725835, AUC 0.46762916445732117
Test Epoch9 layer3 Acc 0.12277771028226622, AUC 0.32486242055892944
Test Epoch9 layer4 Acc 0.2083991414570931, AUC 0.3371928930282593
Test Epoch9 layer5 Acc 0.04279552909731503, AUC 0.32226383686065674
Test Epoch9 layer6 Acc 0.7592738832867614, AUC 0.4418153464794159
Test Epoch9 layer7 Acc 0.043463734661645, AUC 0.736191987991333
Test Epoch9 layer8 Acc 0.014336046652897583, AUC 0.5878025889396667
Test Epoch9 layer9 Acc 0.5701818329081116, AUC 0.5931263566017151
Best AUC 0.9930896759033203
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//kdd99/kdd99_linearal_l10_m2.pt
[[56145     0    13     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     2 19409    12     0     7     0     9     0     0     0]
 [    0     0    11   430     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    24     0     0   221     4     1     0     0     0]
 [    0    14     9     0     0     0   185     0     0     0     0]
 [    0     0    88     0     0     0     0   116     0     0     0]
 [    0     0     2     0     0     0     0     0   194     0     0]
 [    4     2    16     0     0    21     0     1     9     0     0]
 [    0    18    11     0     0    18     0     0     0     0     0]]
Figure(640x480)
[[56146     0    12     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     2 19410    11     0     6     0    10     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    5     0    35     0   278     0     0     0     0     0     0]
 [    0     0    19     0     0   221     5     5     0     0     0]
 [    0    14     8     0     0     0   186     0     0     0     0]
 [    0     0    61     1     0     0     0   142     0     0     0]
 [    0     0     1     0     1     0     0     0   194     0     0]
 [    3     0     6     0     0    22     0     0    22     0     0]
 [    0    18     9     0     0    20     0     0     0     0     0]]
Figure(640x480)
[[   10    13 56131     0     4     0     0     0     0     0     0]
 [    5     0     0     9     0 21427     0     0     0     0     0]
 [  933 18390     6    90    11    17     0     6     3     0     0]
 [    2   439     0     0     0     0     0     0     0     0     0]
 [  240    18     5     0     0    20     0     0    35     0     0]
 [    5    40     0   173     0     0     0    32     0     0     0]
 [    1     7     0   175     0    25     0     0     0     0     0]
 [    0   127     0    71     0     2     0     0     4     0     0]
 [    1     0     0    89     0     0     0     0   106     0     0]
 [   11    25     0    17     0     0     0     0     0     0     0]
 [    0     8     0    21     0    18     0     0     0     0     0]]
Figure(640x480)
[[    9     0 56131    13     5     0     0     0     0     0     0]
 [    0     9     0 21432     0     0     0     0     0     0     0]
 [15076   116  2323  1880     0    51     3     0     7     0     0]
 [    2     0   432     7     0     0     0     0     0     0     0]
 [   13    14     1     9   241     0    34     0     6     0     0]
 [  232    13     0     5     0     0     0     0     0     0     0]
 [   33     0    14    31     8   121     1     0     0     0     0]
 [  201     0     0     2     0     0     0     0     1     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [   37     0    16     0     0     0     0     0     0     0     0]
 [   28     0     0     1    18     0     0     0     0     0     0]]
Figure(640x480)
[[    0 56157     0     0     0     0     1     0     0     0     0]
 [    0 21435     0     0     0     0     3     0     3     0     0]
 [   20  3148     0     0     4   498 15715     0    71     0     0]
 [    0   173     0     0   200     0    52     0    16     0     0]
 [    1   313     0     0     0     1     3     0     0     0     0]
 [    0     3     0     0     0     4   243     0     0     0     0]
 [   13   176     0     0     0     0    19     0     0     0     0]
 [    0     1     0     0     0     0   203     0     0     0     0]
 [    0   196     0     0     0     0     0     0     0     0     0]
 [    0    28     0     0     0     0    25     0     0     0     0]
 [    0    21     0     0     0     0    26     0     0     0     0]]
Figure(640x480)
[[    5     0     0     0     0     0 53513     0  2640     0     0]
 [  106  4077     0     0     0 17258     0     0     0     0     0]
 [16205    40     0     0     1     3     1     0  3206     0     0]
 [    3     0     0     0     0     0     0     0   438     0     0]
 [  315     0     0     0     0     0     0     0     3     0     0]
 [   46     0     2     0     0     0     0     0   202     0     0]
 [   56    35   117     0     0     0     0     0     0     0     0]
 [  138     0     0     0     0     3     0     0    63     0     0]
 [   47     0     0     0     0     0     0     0   149     0     0]
 [   24     0     0     0     0     0     0     0    29     0     0]
 [   24     0     0     0     0     0     0     0    23     0     0]]
Figure(640x480)
[[56117     0    41     0     0     0     0     0     0     0     0]
 [ 4071     0 17370     0     0     0     0     0     0     0     0]
 [  227     0 19225     0     3     0     0     0     1     0     0]
 [  137     0   291     0     0    13     0     0     0     0     0]
 [    0     0   318     0     0     0     0     0     0     0     0]
 [  238     0    12     0     0     0     0     0     0     0     0]
 [    0     0   201     0     0     0     7     0     0     0     0]
 [  164     0    40     0     0     0     0     0     0     0     0]
 [  194     0     2     0     0     0     0     0     0     0     0]
 [   36     0    17     0     0     0     0     0     0     0     0]
 [   21     0    26     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0     0     0     0     0 56158     0     0     0     0]
 [    0  4075     0     0     0     0 17366     0     0     0     0]
 [    0     8     6     6     0     0 19436     0     0     0     0]
 [    0     0   429     0     0     0    12     0     0     0     0]
 [    0     0     0     0     0    34   284     0     0     0     0]
 [    0     0     0     0     0     0   250     0     0     0     0]
 [    0     0     0     0     0     2   206     0     0     0     0]
 [    0     0     2     0     0     0   202     0     0     0     0]
 [    0     0     0     0     0     0   196     0     0     0     0]
 [    0     0     0     0     0     0    53     0     0     0     0]
 [    0     0     0     0     0     0    47     0     0     0     0]]
Figure(640x480)
[[    0     0 56152     0     0     0     6     0     0     0     0]
 [    0     0 21364     0     0     0    77     0     0     0     0]
 [  594     0  1535     0 13649     3  3675     0     0     0     0]
 [    0     0    93     0     0     0   348     0     0     0     0]
 [   38     0     6     0     3     0   271     0     0     0     0]
 [  241     0     2     0     0     0     7     0     0     0     0]
 [   23     0     1     0     0     0   184     0     0     0     0]
 [  101     0    88     0    13     0     2     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   51     0     2     0     0     0     0     0     0     0     0]
 [   38     0     3     0     4     0     2     0     0     0     0]]
Figure(640x480)
[[56157     0     0     0     0     1     0     0     0     0     0]
 [21405     0     0     0     0     0    36     0     0     0     0]
 [17068     0    96     3     0   255  2034     0     0     0     0]
 [    2     0     0     0     0     0   439     0     0     0     0]
 [   30     0   276     0     0     0    12     0     0     0     0]
 [    0     0     0     0     0     2   248     0     0     0     0]
 [    5     0    82     0     0    75    46     0     0     0     0]
 [   18     0     0     0     0     0   186     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   36     0     8     0     0     2     7     0     0     0     0]
 [    6     0     0     0     0     1    40     0     0     0     0]]
Figure(640x480)
