Load ckpt from ./ckpt/mask7//kdd99/kdd99_linearal_l10_m7.pt
layer_mask {0, 1, 2, 3, 4, 5, 6, 7}
Start Training
gc 9
[[4.76600521e+03 2.19363059e+00]
 [6.83039776e-04 1.33232523e+00]
 [1.27202742e-03 1.02583323e+00]
 [2.10452637e-03 9.07902856e-01]
 [3.40425984e-03 7.96457496e-01]
 [5.20195511e-03 6.99823218e-01]
 [8.85333303e-03 7.09078864e-01]
 [1.81676460e+01 1.71736550e+01]
 [8.83436820e+02 8.09209627e+02]
 [7.27055637e+02 5.35695632e+02]]
Train Epoch0 Acc 0.39499582352494494 (156051/395070), AUC 0.5682810544967651
Test Epoch0 layer0 Acc 0.997620783217916, AUC 0.9586321115493774
Save ckpt to ./ckpt/mask8//kdd99/kdd99_linearal_l10_m8.pt  ,ep 0
Test Epoch0 layer1 Acc 0.997954886000081, AUC 0.9768651723861694
Save ckpt to ./ckpt/mask8//kdd99/kdd99_linearal_l10_m8.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9979143886931519, AUC 0.9790993332862854
Save ckpt to ./ckpt/mask8//kdd99/kdd99_linearal_l10_m8.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9979751346535456, AUC 0.9744987487792969
Test Epoch0 layer4 Acc 0.9979852589802778, AUC 0.971592128276825
Test Epoch0 layer5 Acc 0.9979650103268133, AUC 0.9804528951644897
Save ckpt to ./ckpt/mask8//kdd99/kdd99_linearal_l10_m8.pt  ,ep 0
Test Epoch0 layer6 Acc 0.9979953833070101, AUC 0.9578046798706055
Test Epoch0 layer7 Acc 0.9978030210990969, AUC 0.947002649307251
Test Epoch0 layer8 Acc 0.00013161624751953995, AUC 0.5258405208587646
Test Epoch0 layer9 Acc 0.41858016441906615, AUC 0.5356914401054382
gc 0
[[4.76600521e+03 2.15057479e+00]
 [4.35802447e-04 1.31195272e+00]
 [7.81094927e-04 1.01139135e+00]
 [1.30357707e-03 8.98146909e-01]
 [2.11616861e-03 7.88173435e-01]
 [3.12466400e-03 6.91516466e-01]
 [4.89646264e-03 6.90450618e-01]
 [8.85297008e-02 8.10133430e-01]
 [8.77183169e+02 8.13665776e+02]
 [7.34884877e+02 5.41979141e+02]]
Train Epoch1 Acc 0.4188751360518389 (165485/395070), AUC 0.5213488340377808
Test Epoch1 layer0 Acc 0.9976309075446482, AUC 0.9677510857582092
Test Epoch1 layer1 Acc 0.9979751346535456, AUC 0.9717215895652771
Test Epoch1 layer2 Acc 0.9979751346535456, AUC 0.9702562093734741
Test Epoch1 layer3 Acc 0.9980055076337424, AUC 0.9702091217041016
Test Epoch1 layer4 Acc 0.9979852589802778, AUC 0.9694008231163025
Test Epoch1 layer5 Acc 0.9979650103268133, AUC 0.9701810479164124
Test Epoch1 layer6 Acc 0.9979953833070101, AUC 0.9671973586082458
Test Epoch1 layer7 Acc 0.9979953833070101, AUC 0.9097824096679688
Test Epoch1 layer8 Acc 0.0002632324950390799, AUC 0.45942923426628113
Test Epoch1 layer9 Acc 0.4189142672012311, AUC 0.515396773815155
gc 0
[[4.76601232e+03 2.11552475e+00]
 [4.44503412e-04 1.29065773e+00]
 [8.00209438e-04 9.95538613e-01]
 [1.36612688e-03 8.79485773e-01]
 [2.23109880e-03 7.69901405e-01]
 [3.33933466e-03 6.73130777e-01]
 [4.94927356e-03 6.68102630e-01]
 [2.10056865e-02 7.42916191e-01]
 [8.68801581e+02 7.93616559e+02]
 [7.30242586e+02 5.32177221e+02]]
Train Epoch2 Acc 0.42066722353000735 (166193/395070), AUC 0.5193457007408142
Test Epoch2 layer0 Acc 0.997691653505042, AUC 0.9726229310035706
Test Epoch2 layer1 Acc 0.9980055076337424, AUC 0.9844308495521545
Save ckpt to ./ckpt/mask8//kdd99/kdd99_linearal_l10_m8.pt  ,ep 2
Test Epoch2 layer2 Acc 0.9979751346535456, AUC 0.9793916940689087
Test Epoch2 layer3 Acc 0.9980055076337424, AUC 0.9758575558662415
Test Epoch2 layer4 Acc 0.9980257562872069, AUC 0.9725825786590576
Test Epoch2 layer5 Acc 0.9980358806139392, AUC 0.9755555987358093
Test Epoch2 layer6 Acc 0.9980257562872069, AUC 0.9811171889305115
Test Epoch2 layer7 Acc 0.9980257562872069, AUC 0.9582811594009399
Test Epoch2 layer8 Acc 0.0005872109504717936, AUC 0.4669743776321411
Test Epoch2 layer9 Acc 0.42284250597335277, AUC 0.5155757069587708
gc 0
[[4.76600521e+03 2.07767673e+00]
 [4.60410373e-04 1.26849984e+00]
 [7.90888517e-04 9.79712607e-01]
 [1.30223435e-03 8.68078528e-01]
 [2.24068889e-03 7.60374869e-01]
 [3.32192890e-03 6.65308091e-01]
 [4.58606297e-03 6.57108878e-01]
 [1.07268658e-02 7.26145684e-01]
 [8.59700973e+02 7.69584205e+02]
 [7.24832392e+02 5.20789308e+02]]
Train Epoch3 Acc 0.4227630546485433 (167021/395070), AUC 0.5207532644271851
Test Epoch3 layer0 Acc 0.9977017778317742, AUC 0.9644598364830017
Test Epoch3 layer1 Acc 0.9979650103268133, AUC 0.9610734581947327
Test Epoch3 layer2 Acc 0.9979245130198842, AUC 0.9705531597137451
Test Epoch3 layer3 Acc 0.997954886000081, AUC 0.9694175720214844
Test Epoch3 layer4 Acc 0.9979953833070101, AUC 0.9717998504638672
Test Epoch3 layer5 Acc 0.9979852589802778, AUC 0.9799332022666931
Test Epoch3 layer6 Acc 0.9979751346535456, AUC 0.9702673554420471
Test Epoch3 layer7 Acc 0.9979953833070101, AUC 0.9603576064109802
Test Epoch3 layer8 Acc 0.00013161624751953995, AUC 0.4661991000175476
Test Epoch3 layer9 Acc 0.42295387356740777, AUC 0.520850419998169
gc 0
[[4.76600521e+03 2.04871795e+00]
 [4.87856701e-04 1.25506558e+00]
 [9.36569579e-04 9.70392123e-01]
 [1.67290960e-03 8.58585764e-01]
 [2.80958284e-03 7.50429363e-01]
 [4.10523872e-03 6.55451045e-01]
 [5.65679614e-03 6.45178592e-01]
 [1.02999440e-02 7.04622863e-01]
 [8.49784856e+02 7.45439132e+02]
 [7.17604697e+02 5.09198689e+02]]
Train Epoch4 Acc 0.42299086237881894 (167111/395070), AUC 0.5226607918739319
Test Epoch4 layer0 Acc 0.9977422751387033, AUC 0.9712134003639221
Test Epoch4 layer1 Acc 0.9980460049406714, AUC 0.9841334819793701
Test Epoch4 layer2 Acc 0.9980055076337424, AUC 0.9793129563331604
Test Epoch4 layer3 Acc 0.998066253594136, AUC 0.9779743552207947
Test Epoch4 layer4 Acc 0.9980460049406714, AUC 0.9740745425224304
Test Epoch4 layer5 Acc 0.9980460049406714, AUC 0.9784271717071533
Test Epoch4 layer6 Acc 0.9980460049406714, AUC 0.9804847240447998
Test Epoch4 layer7 Acc 0.9980460049406714, AUC 0.9826081991195679
Test Epoch4 layer8 Acc 0.00016198922771635686, AUC 0.44273507595062256
Test Epoch4 layer9 Acc 0.42295387356740777, AUC 0.5229522585868835
gc 0
[[4.76600521e+03 2.01692625e+00]
 [4.25905755e-04 1.23632919e+00]
 [7.23077520e-04 9.56839665e-01]
 [1.14476815e-03 8.46855204e-01]
 [1.78195956e-03 7.40002624e-01]
 [1.08059824e-03 6.26066862e-01]
 [2.36262160e-03 6.22951380e-01]
 [4.87708902e-03 6.75421920e-01]
 [8.41376454e+02 7.26101209e+02]
 [7.11292282e+02 4.99702496e+02]]
Train Epoch5 Acc 0.42305920469790165 (167138/395070), AUC 0.5226630568504333
Test Epoch5 layer0 Acc 0.9978131454258292, AUC 0.9670843482017517
Test Epoch5 layer1 Acc 0.9980763779208682, AUC 0.9685558676719666
Test Epoch5 layer2 Acc 0.9980358806139392, AUC 0.9716004729270935
Test Epoch5 layer3 Acc 0.9980763779208682, AUC 0.96913743019104
Test Epoch5 layer4 Acc 0.9980561292674037, AUC 0.9711911678314209
Test Epoch5 layer5 Acc 0.9980561292674037, AUC 0.9710386395454407
Test Epoch5 layer6 Acc 0.9980460049406714, AUC 0.9747896790504456
Test Epoch5 layer7 Acc 0.998066253594136, AUC 0.9719417691230774
Test Epoch5 layer8 Acc 0.0002227351881099907, AUC 0.44459277391433716
Test Epoch5 layer9 Acc 0.42297412222087233, AUC 0.5175867080688477
gc 0
[[4.76600521e+03 1.99161089e+00]
 [4.23917415e-04 1.22681622e+00]
 [7.29480884e-04 9.47494941e-01]
 [1.16962960e-03 8.37608650e-01]
 [1.88917424e-03 7.31176855e-01]
 [1.32695833e-03 6.20877372e-01]
 [2.86132329e-03 6.15894992e-01]
 [5.15901267e-03 6.66392650e-01]
 [8.34115209e+02 7.08983012e+02]
 [7.05899074e+02 4.90620077e+02]]
Train Epoch6 Acc 0.4230667982889108 (167141/395070), AUC 0.5242285132408142
Test Epoch6 layer0 Acc 0.9977827724456324, AUC 0.9623960256576538
Test Epoch6 layer1 Acc 0.9980055076337424, AUC 0.9680454134941101
Test Epoch6 layer2 Acc 0.9980055076337424, AUC 0.9703980088233948
Test Epoch6 layer3 Acc 0.9980460049406714, AUC 0.9678784012794495
Test Epoch6 layer4 Acc 0.9980358806139392, AUC 0.969204843044281
Test Epoch6 layer5 Acc 0.9980358806139392, AUC 0.9697056412696838
Test Epoch6 layer6 Acc 0.9980257562872069, AUC 0.9719468951225281
Test Epoch6 layer7 Acc 0.9980460049406714, AUC 0.9708084464073181
Test Epoch6 layer8 Acc 0.00010124326732272303, AUC 0.4439781904220581
Test Epoch6 layer9 Acc 0.4229842465476046, AUC 0.5219554305076599
gc 0
[[4.76600521e+03 1.93283109e+00]
 [6.59058643e-05 1.17500547e+00]
 [1.18574110e-04 9.00151386e-01]
 [6.44052789e-04 8.05082869e-01]
 [1.35736548e-03 7.05295284e-01]
 [1.01907409e-03 6.01460672e-01]
 [1.01932355e-03 5.75852459e-01]
 [2.91425050e-03 6.34120687e-01]
 [8.28134810e+02 6.94485448e+02]
 [7.01453299e+02 4.83205699e+02]]
Train Epoch7 Acc 0.4230971726529476 (167153/395070), AUC 0.5243237614631653
Test Epoch7 layer0 Acc 0.9978738913862228, AUC 0.9656962752342224
Test Epoch7 layer1 Acc 0.9980460049406714, AUC 0.9693030714988708
Test Epoch7 layer2 Acc 0.9980156319604746, AUC 0.9786489009857178
Test Epoch7 layer3 Acc 0.9980460049406714, AUC 0.9726473093032837
Test Epoch7 layer4 Acc 0.998066253594136, AUC 0.9720852375030518
Test Epoch7 layer5 Acc 0.998066253594136, AUC 0.9711000323295593
Test Epoch7 layer6 Acc 0.9980763779208682, AUC 0.9765810370445251
Test Epoch7 layer7 Acc 0.9980865022476005, AUC 0.9715575575828552
Test Epoch7 layer8 Acc 0.00012149192078726765, AUC 0.4389129877090454
Test Epoch7 layer9 Acc 0.42300449520106914, AUC 0.5224718451499939
gc 0
[[4.76600521e+03 1.91836592e+00]
 [1.11099020e-04 1.16613432e+00]
 [1.92876010e-04 8.93517051e-01]
 [7.82511025e-04 7.98404008e-01]
 [1.43198718e-03 6.99339421e-01]
 [1.04100523e-03 5.96936627e-01]
 [1.14708763e-03 5.72271638e-01]
 [3.08884250e-03 6.27924486e-01]
 [8.21870931e+02 6.81484252e+02]
 [6.96687933e+02 4.76539579e+02]]
Train Epoch8 Acc 0.42309970384995066 (167154/395070), AUC 0.5255853533744812
Test Epoch8 layer0 Acc 0.997884015712955, AUC 0.9631994366645813
Test Epoch8 layer1 Acc 0.9980561292674037, AUC 0.9670000076293945
Test Epoch8 layer2 Acc 0.9980460049406714, AUC 0.9728670120239258
Test Epoch8 layer3 Acc 0.998066253594136, AUC 0.9679853916168213
Test Epoch8 layer4 Acc 0.998066253594136, AUC 0.9703760743141174
Test Epoch8 layer5 Acc 0.9980561292674037, AUC 0.9704815149307251
Test Epoch8 layer6 Acc 0.9980561292674037, AUC 0.9693787097930908
Test Epoch8 layer7 Acc 0.9980763779208682, AUC 0.9715160727500916
Test Epoch8 layer8 Acc 0.00011136759405499535, AUC 0.43805161118507385
Test Epoch8 layer9 Acc 0.4230551168347305, AUC 0.5247647166252136
gc 0
[[4.76600521e+03 1.90323667e+00]
 [1.06684907e-04 1.15754813e+00]
 [1.92242569e-04 8.86653688e-01]
 [2.46629658e-04 7.75668951e-01]
 [3.62005724e-04 6.70888454e-01]
 [2.53193514e-04 5.76558421e-01]
 [6.37411408e-04 5.57969044e-01]
 [9.42313965e-04 5.90815105e-01]
 [8.18524751e+02 6.73375851e+02]
 [6.94131598e+02 4.72620028e+02]]
Train Epoch9 Acc 0.42312501581998124 (167164/395070), AUC 0.5271071791648865
Test Epoch9 layer0 Acc 0.9979143886931519, AUC 0.9643884301185608
Test Epoch9 layer1 Acc 0.9980865022476005, AUC 0.9698530435562134
Test Epoch9 layer2 Acc 0.9980763779208682, AUC 0.9770317673683167
Test Epoch9 layer3 Acc 0.998066253594136, AUC 0.9748857617378235
Test Epoch9 layer4 Acc 0.9980763779208682, AUC 0.9732955694198608
Test Epoch9 layer5 Acc 0.9980763779208682, AUC 0.9717853665351868
Test Epoch9 layer6 Acc 0.9980865022476005, AUC 0.9743247628211975
Test Epoch9 layer7 Acc 0.9980865022476005, AUC 0.9768853783607483
Test Epoch9 layer8 Acc 9.111894059045073e-05, AUC 0.4384537935256958
Test Epoch9 layer9 Acc 0.42302474385453365, AUC 0.5247698426246643
Best AUC 0.9844308495521545
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask8//kdd99/kdd99_linearal_l10_m8.pt
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   18     1 19412     8     0     4     0    13     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    5     0    20     0   293     0     0     0     0     0     0]
 [    0     0     5     0     0   244     1     0     0     0     0]
 [    0     6     6     0     0     0   196     0     0     0     0]
 [    0     0    28     0     0     0     0   176     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    0     1     7     3     0    20     0     5    17     0     0]
 [    0    16     9     0     0    22     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   18     1 19413     7     0     3     0    14     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    3     0    14     0   301     0     0     0     0     0     0]
 [    0     0     6     0     0   244     0     0     0     0     0]
 [    0     1     6     0     0     0   201     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    7     8     6     0     0    15     0     2    15     0     0]
 [    0     2    23     0     0    22     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   18     1 19414     6     0     3     0    14     0     0     0]
 [    0     0    10   431     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     4     0     1     0   202     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     1     0     1     0     0     0   194     0     0]
 [   15     7    11     0     0     8     1     1    10     0     0]
 [   14     3    20     0     0    10     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   18     1 19412     7     1     3     0    14     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     3     0     2     0   202     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     0     1     0     0   195     0     0]
 [   20     0     5     9     0     3     0     1    15     0     0]
 [    0    18    13     0     0    16     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19414     6     1     3     0    14     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     4     0     1     0   202     0     0     0     0]
 [    0     0    11     0     0     0     0   193     0     0     0]
 [    0     1     0     0     0     1     0     0   194     0     0]
 [   27     1     5     2     3     3     0     1    11     0     0]
 [    0    18    11     0     0    18     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19413     7     1     3     0    14     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     6     0     0   244     0     0     0     0     0]
 [    0     1     2     0     2     0   203     0     0     0     0]
 [    0     0    11     0     0     0     0   193     0     0     0]
 [    0     0     0     0     2     0     0     0   194     0     0]
 [    5     0     5    23     7     3     0     2     8     0     0]
 [    0    18     9     0     0    20     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19414     6     1     3     0    14     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     1     4     0     1     0   202     0     0     0     0]
 [    0     0    11     0     0     0     0   193     0     0     0]
 [    0     0     0     0     2     0     0     0   194     0     0]
 [   20     0     6     5     8     3     0     2     9     0     0]
 [    0     4    13     0     0    16     0     0    14     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19414     6     1     3     0    14     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    0     0     7     0     0   243     0     0     0     0     0]
 [    0     2     4     0     1     0   201     0     0     0     0]
 [    0     0    12     0     0     0     0   192     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    0     0     4     0     0     0     0     3    46     0     0]
 [    0     4    10     0     0    19     0     0    14     0     0]]
Figure(640x480)
[[    0     0 56070     0     1    83     4     0     0     0     0]
 [    0    11     0     0     0     0 21430     0     0     0     0]
 [    0     2     3     0    62    19 19370     0     0     0     0]
 [    0     0     0     0    13   425     3     0     0     0     0]
 [    0     0     0     0     5     5   308     0     0     0     0]
 [    0   234     0     0    13     0     3     0     0     0     0]
 [    0     0     0     0     8     0     2   198     0     0     0]
 [    0     0   102     0    54     0    11    37     0     0     0]
 [    0     0     0     0   196     0     0     0     0     0     0]
 [    0     0     1     0    50     0     2     0     0     0     0]
 [    0     0     0     0    40     0     7     0     0     0     0]]
Figure(640x480)
[[    0     0     5     0 56153     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    0    12 19403     3    38     0     0     0     0     0     0]
 [    0     0     4   421    16     0     0     0     0     0     0]
 [    0     0     9     0   309     0     0     0     0     0     0]
 [    0     1     6     0   243     0     0     0     0     0     0]
 [    0     0     2     0   206     0     0     0     0     0     0]
 [    0     2    11     0   191     0     0     0     0     0     0]
 [    0     0     0     0     3     0     0     0   193     0     0]
 [    0     0     2     0    51     0     0     0     0     0     0]
 [    0     0     8     0    39     0     0     0     0     0     0]]
Figure(640x480)
