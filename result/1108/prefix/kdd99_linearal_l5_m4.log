Load ckpt from ./ckpt/mask3//kdd99/kdd99_linearal_l5_m3.pt
layer_mask {0, 1, 2, 3}
Start Training
gc 9
[[4.76601257e+03 4.42984055e+00]
 [2.11753703e-03 3.17810665e+00]
 [4.43394087e-02 2.92383555e+00]
 [2.32455769e+01 2.46040396e+01]
 [1.22088893e+03 9.40960558e+02]]
Train Epoch0 Acc 0.029979497304275193 (11844/395070), AUC 0.45928964018821716
Test Epoch0 layer0 Acc 0.9958996476734298, AUC 0.9659683704376221
Save ckpt to ./ckpt/mask4//kdd99/kdd99_linearal_l5_m4.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9962539991090592, AUC 0.960365355014801
Test Epoch0 layer2 Acc 0.9963349937229175, AUC 0.9312019944190979
Test Epoch0 layer3 Acc 0.9955452962378002, AUC 0.9787879586219788
Save ckpt to ./ckpt/mask4//kdd99/kdd99_linearal_l5_m4.pt  ,ep 0
Test Epoch0 layer4 Acc 0.0004960920098813429, AUC 0.42720839381217957
gc 0
[[4.76600595e+03 4.27260852e+00]
 [4.99427653e-04 2.83632694e+00]
 [2.20543210e-03 2.22959321e+00]
 [9.99690641e-02 2.39538592e+00]
 [1.27031903e+03 1.01593397e+03]]
Train Epoch1 Acc 0.000453084263548232 (179/395070), AUC 0.46009790897369385
Test Epoch1 layer0 Acc 0.9960920098813429, AUC 0.9340083599090576
Test Epoch1 layer1 Acc 0.9966488478516179, AUC 0.9114351868629456
Test Epoch1 layer2 Acc 0.9968310857327988, AUC 0.9069423079490662
Test Epoch1 layer3 Acc 0.9968513343862633, AUC 0.9285464882850647
Test Epoch1 layer4 Acc 0.0007694488316526951, AUC 0.47686776518821716
gc 0
[[4.76600540e+03 4.03087171e+00]
 [4.60074356e-04 2.54480618e+00]
 [8.38370456e-04 1.89020976e+00]
 [1.49216839e-02 1.69933468e+00]
 [1.28803208e+03 1.04116475e+03]]
Train Epoch2 Acc 0.0008125142379831423 (321/395070), AUC 0.5069947838783264
Test Epoch2 layer0 Acc 0.9964261126635079, AUC 0.9194166660308838
Test Epoch2 layer1 Acc 0.9971348155347669, AUC 0.9130961894989014
Test Epoch2 layer2 Acc 0.9972360588020897, AUC 0.912773072719574
Test Epoch2 layer3 Acc 0.9971550641882315, AUC 0.9193243384361267
Test Epoch2 layer4 Acc 0.0008706920989754181, AUC 0.4890196919441223
gc 0
[[4.76601244e+03 3.80330532e+00]
 [4.79888470e-04 2.33074293e+00]
 [8.50846441e-04 1.68342136e+00]
 [4.29978465e-03 1.44349941e+00]
 [1.29065533e+03 1.04386141e+03]]
Train Epoch3 Acc 0.0008125142379831423 (321/395070), AUC 0.5166230797767639
Test Epoch3 layer0 Acc 0.9966893451585469, AUC 0.8962362408638
Test Epoch3 layer1 Acc 0.9971449398614992, AUC 0.9150288105010986
Test Epoch3 layer2 Acc 0.9972664317822865, AUC 0.9130614995956421
Test Epoch3 layer3 Acc 0.9972765561090188, AUC 0.9312711954116821
Test Epoch3 layer4 Acc 0.0006580812375976998, AUC 0.49268853664398193
gc 0
[[4.76600529e+03 3.59221209e+00]
 [4.97814972e-04 2.14905437e+00]
 [8.86858468e-04 1.53192668e+00]
 [2.08616179e-03 1.28419081e+00]
 [1.28611456e+03 1.04213717e+03]]
Train Epoch4 Acc 0.0007011415698483813 (277/395070), AUC 0.5151939988136292
Test Epoch4 layer0 Acc 0.9969829506337828, AUC 0.8960103392601013
Test Epoch4 layer1 Acc 0.9973575507228769, AUC 0.9199107885360718
Test Epoch4 layer2 Acc 0.9974486696634673, AUC 0.9137937426567078
Test Epoch4 layer3 Acc 0.9974284210100028, AUC 0.9405969381332397
Test Epoch4 layer4 Acc 0.0005770866237395213, AUC 0.4913528561592102
gc 0
[[4.76600528e+03 3.42317137e+00]
 [6.91746290e-05 1.99416007e+00]
 [1.21850083e-04 1.40335354e+00]
 [2.77561742e-04 1.15628061e+00]
 [1.28466391e+03 1.04282509e+03]]
Train Epoch5 Acc 0.0006150808717442478 (243/395070), AUC 0.506955087184906
Test Epoch5 layer0 Acc 0.9970335722674443, AUC 0.9109647274017334
Test Epoch5 layer1 Acc 0.9974486696634673, AUC 0.9207809567451477
Test Epoch5 layer2 Acc 0.9975499129307901, AUC 0.9143025875091553
Test Epoch5 layer3 Acc 0.9974891669703965, AUC 0.9376739859580994
Test Epoch5 layer4 Acc 0.0005568379702749767, AUC 0.48385611176490784
gc 0
[[4.76600526e+03 3.33789560e+00]
 [1.11960966e-04 1.92732555e+00]
 [1.91791620e-04 1.34907569e+00]
 [3.28748879e-04 1.10659220e+00]
 [1.28466018e+03 1.04568377e+03]]
Train Epoch6 Acc 0.0005796441137013694 (229/395070), AUC 0.49449971318244934
Test Epoch6 layer0 Acc 0.9971145668813024, AUC 0.8945505619049072
Test Epoch6 layer1 Acc 0.9974790426436642, AUC 0.9210334420204163
Test Epoch6 layer2 Acc 0.9975802859109869, AUC 0.9110746383666992
Test Epoch6 layer3 Acc 0.9975600372575224, AUC 0.9253803491592407
Test Epoch6 layer4 Acc 0.0004960920098813429, AUC 0.49409931898117065
gc 0
[[4.76600525e+03 3.26302417e+00]
 [1.22767934e-04 1.87103056e+00]
 [2.14923666e-04 1.30610996e+00]
 [3.61577895e-04 1.06869659e+00]
 [1.28495316e+03 1.04728748e+03]]
Train Epoch7 Acc 0.0005543321436707419 (219/395070), AUC 0.4912271797657013
Test Epoch7 layer0 Acc 0.9971854371684283, AUC 0.8939059972763062
Test Epoch7 layer1 Acc 0.9976410318713805, AUC 0.9198294281959534
Test Epoch7 layer2 Acc 0.9976815291783097, AUC 0.9113237261772156
Test Epoch7 layer3 Acc 0.9977625237921678, AUC 0.9244496822357178
Test Epoch7 layer4 Acc 0.00043534604948770904, AUC 0.48127633333206177
gc 0
[[4.76600524e+03 3.18851065e+00]
 [1.18264604e-04 1.81899186e+00]
 [2.02394122e-04 1.26548300e+00]
 [3.39268652e-04 1.03281626e+00]
 [1.28503412e+03 1.04700766e+03]]
Train Epoch8 Acc 0.0005290201736401144 (209/395070), AUC 0.48875734210014343
Test Epoch8 layer0 Acc 0.9971854371684283, AUC 0.8943775296211243
Test Epoch8 layer1 Acc 0.997620783217916, AUC 0.922259509563446
Test Epoch8 layer2 Acc 0.9978030210990969, AUC 0.9160715341567993
Test Epoch8 layer3 Acc 0.9977827724456324, AUC 0.9244354367256165
Test Epoch8 layer4 Acc 0.00041509739602316447, AUC 0.47920048236846924
gc 0
[[4.76600524e+03 3.11893061e+00]
 [1.87395883e-05 1.76242721e+00]
 [3.32503490e-05 1.21611777e+00]
 [5.50383741e-05 9.85498720e-01]
 [1.28534601e+03 1.04930359e+03]]
Train Epoch9 Acc 0.0005264889766370517 (208/395070), AUC 0.4885239899158478
Test Epoch9 layer0 Acc 0.9972056858218928, AUC 0.8938099145889282
Test Epoch9 layer1 Acc 0.9976309075446482, AUC 0.919463574886322
Test Epoch9 layer2 Acc 0.9976714048515773, AUC 0.9149848818778992
Test Epoch9 layer3 Acc 0.9976714048515773, AUC 0.9221484661102295
Test Epoch9 layer4 Acc 0.00041509739602316447, AUC 0.48464277386665344
Best AUC 0.9787879586219788
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//kdd99/kdd99_linearal_l5_m4.pt
[[56136     0    22     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     1 19421    12     0     9     0     7     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    1     0    40     0   277     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0    24    13     0     0     0   171     0     0     0     0]
 [    0     0   116     2     0     0     0    86     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    0     2    24     0     0    22     0     1     4     0     0]
 [    0    18    25     0     0     4     0     0     0     0     0]]
Figure(640x480)
[[56139     0    19     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     1 19426    10     0     6     0     7     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    28     0     0   221     0     1     0     0     0]
 [    0    24    12     0     0     0   172     0     0     0     0]
 [    0     0    95     0     0     0     0   109     0     0     0]
 [    0     0     2     0     0     0     0     0   194     0     0]
 [    4     0    21     0     0    12     0     7     9     0     0]
 [    0    16    23     0     0     8     0     0     0     0     0]]
Figure(640x480)
[[56140     0    18     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     0 19422    10     0    10     0     8     0     0     0]
 [    0     0    13   428     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    28     0     0   222     0     0     0     0     0]
 [    0    17    11     0     0     0   180     0     0     0     0]
 [    0     0    94     1     0     0     0   109     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    4     0    21     0     0    18     0     1     9     0     0]
 [    0    16    25     0     0     6     0     0     0     0     0]]
Figure(640x480)
[[56137     0    21     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     2 19432     9     0     6     0     1     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    40     0     0   210     0     0     0     0     0]
 [    0    24    19     0     3     0   162     0     0     0     0]
 [    0     0   131    11     0     5     0    57     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    1     2    23     0     0     2     0    25     0     0     0]
 [    0     0    47     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[   43    47 56068     0     0     0     0     0     0     0     0]
 [  942     0     0     0     0     0     0     0 20499     0     0]
 [16550  2898     6     0     0     1     0     0     1     0     0]
 [   34   406     1     0     0     0     0     0     0     0     0]
 [  315     3     0     0     0     0     0     0     0     0     0]
 [  248     2     0     0     0     0     0     0     0     0     0]
 [   49   142     0     0     0     0     0     0    17     0     0]
 [  175    19    10     0     0     0     0     0     0     0     0]
 [  176     0     0    20     0     0     0     0     0     0     0]
 [   51     2     0     0     0     0     0     0     0     0     0]
 [   41     6     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
