Load ckpt from ./ckpt/mask3//kdd99/kdd99_linearalside_l5_m3.pt
layer_mask {0, 1, 2, 3}
Start Training
gc 9
[[4.76600530e+03 3.63758164e+02]
 [2.51809237e-03 2.47536062e+02]
 [3.83905085e-02 1.65194245e+01]
 [2.72370132e+01 3.54288130e+01]
 [1.44424196e+03 1.02469353e+03]]
Train Epoch0 Acc 0.002354013212848356 (930/395070), AUC 0.35486695170402527
Test Epoch0 layer0 Acc 0.6838476491313328, AUC 0.7965052127838135
Save ckpt to ./ckpt/mask4//kdd99/kdd99_linearalside_l5_m4.pt  ,ep 0
Test Epoch0 layer1 Acc 0.726612805248451, AUC 0.7861276268959045
Test Epoch0 layer2 Acc 0.9779998380107723, AUC 0.9469943642616272
Save ckpt to ./ckpt/mask4//kdd99/kdd99_linearalside_l5_m4.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9913133276637104, AUC 0.9819545745849609
Save ckpt to ./ckpt/mask4//kdd99/kdd99_linearalside_l5_m4.pt  ,ep 0
Test Epoch0 layer4 Acc 0.0020856113068480945, AUC 0.32662785053253174
gc 0
[[4.76600528e+03 3.62415898e+02]
 [5.85520862e-04 2.47939920e+02]
 [3.39010848e-03 1.52120825e+01]
 [1.14174468e-01 6.81462736e+00]
 [1.42752311e+03 1.02739006e+03]]
Train Epoch1 Acc 0.10292100134153441 (40661/395070), AUC 0.3390505015850067
Test Epoch1 layer0 Acc 0.6886972016360912, AUC 0.7960472702980042
Test Epoch1 layer1 Acc 0.7267444214959705, AUC 0.7857929468154907
Test Epoch1 layer2 Acc 0.9886810027133196, AUC 0.9045232534408569
Test Epoch1 layer3 Acc 0.9928825983072126, AUC 0.970675528049469
Test Epoch1 layer4 Acc 0.17877536143846434, AUC 0.36859598755836487
gc 0
[[4.76600525e+03 3.61031221e+02]
 [4.84123524e-04 2.47972642e+02]
 [1.14136143e-03 1.41708256e+01]
 [2.04988609e-02 5.28844953e+00]
 [1.42205596e+03 1.06485402e+03]]
Train Epoch2 Acc 0.17536385956919026 (69281/395070), AUC 0.35162675380706787
Test Epoch2 layer0 Acc 0.7087737415461872, AUC 0.7964296340942383
Test Epoch2 layer1 Acc 0.7267545458227028, AUC 0.7861501574516296
Test Epoch2 layer2 Acc 0.9886101324261937, AUC 0.8987470269203186
Test Epoch2 layer3 Acc 0.9936317984854007, AUC 0.9502529501914978
Test Epoch2 layer4 Acc 0.12291945085651804, AUC 0.35483938455581665
gc 0
[[4.76600523e+03 3.59866547e+02]
 [4.67370771e-04 2.47766240e+02]
 [8.67732880e-04 1.33243804e+01]
 [5.53596929e-03 4.53483640e+00]
 [1.41736106e+03 1.09375288e+03]]
Train Epoch3 Acc 0.06366972941504037 (25154/395070), AUC 0.34844112396240234
Test Epoch3 layer0 Acc 0.7127728506054347, AUC 0.7990217208862305
Test Epoch3 layer1 Acc 0.7268152917830965, AUC 0.7878389954566956
Test Epoch3 layer2 Acc 0.9887518730004454, AUC 0.9010921716690063
Test Epoch3 layer3 Acc 0.9949378366338638, AUC 0.9477930068969727
Test Epoch3 layer4 Acc 0.011096262098570444, AUC 0.3585840165615082
gc 0
[[4.76600522e+03 3.58624007e+02]
 [4.34520141e-04 2.46978863e+02]
 [7.57974222e-04 1.25723351e+01]
 [2.17654437e-03 4.08555244e+00]
 [1.41393164e+03 1.11214493e+03]]
Train Epoch4 Acc 0.015733920571038045 (6216/395070), AUC 0.349802166223526
Test Epoch4 layer0 Acc 0.7155671647835419, AUC 0.7987854480743408
Test Epoch4 layer1 Acc 0.7268760377434901, AUC 0.7887977957725525
Test Epoch4 layer2 Acc 0.9887417486737132, AUC 0.9014509320259094
Test Epoch4 layer3 Acc 0.9949479609605961, AUC 0.942848801612854
Test Epoch4 layer4 Acc 0.023690924553517193, AUC 0.3526916801929474
gc 0
[[4.76600522e+03 3.57493144e+02]
 [4.56740694e-04 2.45632356e+02]
 [2.91655258e-04 1.19443780e+01]
 [5.73076195e-04 3.81445219e+00]
 [1.41286459e+03 1.12640710e+03]]
Train Epoch5 Acc 0.03881084364796112 (15333/395070), AUC 0.343530535697937
Test Epoch5 layer0 Acc 0.7172883003280281, AUC 0.7077593207359314
Test Epoch5 layer1 Acc 0.7270279026444741, AUC 0.7152702212333679
Test Epoch5 layer2 Acc 0.9888227432875714, AUC 0.9011558294296265
Test Epoch5 layer3 Acc 0.9949884582675252, AUC 0.9294471740722656
Test Epoch5 layer4 Acc 0.06619284817559633, AUC 0.3494988679885864
gc 0
[[4.76600522e+03 3.56566344e+02]
 [4.44905103e-04 2.43569920e+02]
 [3.59900555e-04 1.15157597e+01]
 [5.60876601e-04 3.68638179e+00]
 [1.41319201e+03 1.13525730e+03]]
Train Epoch6 Acc 0.09357835320322981 (36970/395070), AUC 0.34233880043029785
Test Epoch6 layer0 Acc 0.7178856356052322, AUC 0.7090182900428772
Test Epoch6 layer1 Acc 0.727210140525655, AUC 0.7172014117240906
Test Epoch6 layer2 Acc 0.9889239865548941, AUC 0.8961641788482666
Test Epoch6 layer3 Acc 0.9950390799011866, AUC 0.9294119477272034
Test Epoch6 layer4 Acc 0.12762726278702466, AUC 0.3503715395927429
gc 0
[[4.76600522e+03 3.55671794e+02]
 [4.72588938e-04 2.40362375e+02]
 [3.79737547e-04 1.10923964e+01]
 [5.33462248e-04 3.57759344e+00]
 [1.41345697e+03 1.14214310e+03]]
Train Epoch7 Acc 0.1633482673956514 (64534/395070), AUC 0.34323346614837646
Test Epoch7 layer0 Acc 0.7180678734864131, AUC 0.7105847001075745
Test Epoch7 layer1 Acc 0.7274632486939618, AUC 0.7179298400878906
Test Epoch7 layer2 Acc 0.9888936135746973, AUC 0.8942617177963257
Test Epoch7 layer3 Acc 0.9950188312477221, AUC 0.9333339929580688
Test Epoch7 layer4 Acc 0.1814988053294456, AUC 0.34723857045173645
gc 0
[[4.76600522e+03 3.54955990e+02]
 [4.35363148e-04 2.35394583e+02]
 [3.40451068e-04 1.06818166e+01]
 [4.59762010e-04 3.48073374e+00]
 [1.41359871e+03 1.14743525e+03]]
Train Epoch8 Acc 0.18151213708962968 (71710/395070), AUC 0.341140478849411
Test Epoch8 layer0 Acc 0.7182501113675941, AUC 0.7098375558853149
Test Epoch8 layer1 Acc 0.7413943222775685, AUC 0.7183642983436584
Test Epoch8 layer2 Acc 0.9890961001093427, AUC 0.8882930278778076
Test Epoch8 layer3 Acc 0.9950795772081157, AUC 0.9287950396537781
Test Epoch8 layer4 Acc 0.1813874377353906, AUC 0.34843868017196655
gc 0
[[4.76600522e+03 3.54478856e+02]
 [5.92111172e-05 2.29728950e+02]
 [4.65735567e-05 1.03306851e+01]
 [6.34169825e-05 3.37200394e+00]
 [1.41382559e+03 1.15264389e+03]]
Train Epoch9 Acc 0.18217784190143518 (71973/395070), AUC 0.3424237370491028
Test Epoch9 layer0 Acc 0.7183311059814522, AUC 0.7096099257469177
Test Epoch9 layer1 Acc 0.7430243388814644, AUC 0.7193090319633484
Test Epoch9 layer2 Acc 0.9894707001984369, AUC 0.888680636882782
Test Epoch9 layer3 Acc 0.9950998258615802, AUC 0.9287949204444885
Test Epoch9 layer4 Acc 0.18190377839873648, AUC 0.35316145420074463
Best AUC 0.9819545745849609
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//kdd99/kdd99_linearalside_l5_m4.pt
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 8693     0 10691    67     0     0     0     5     0     0     0]
 [    1     0    12   428     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  194     0    13     0     0     0     1     0     0     0     0]
 [  128     0     3     2     0     0     0    71     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    2     0     0     0     0     0     0     0    51     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 4511     0 14904    33     0     0     0     8     0     0     0]
 [    0     0     2   439     0     0     0     0     0     0     0]
 [  317     0     1     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  194     0    13     0     0     0     1     0     0     0     0]
 [    0     0   133     0     0     0     0    71     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    2     0     0     0     0     0     0     0    51     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56109     0    49     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   15  1045 18354    31     0     0     0    11     0     0     0]
 [    0     0     2   439     0     0     0     0     0     0     0]
 [    0   279    39     0     0     0     0     0     0     0     0]
 [    0    24   226     0     0     0     0     0     0     0     0]
 [    0   191    16     0     0     0     1     0     0     0     0]
 [    0     0   133    12     0     0     0    59     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    0     0     2     0     0     0     0     0    51     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56106     0    52     0     0     0     0     0     0     0     0]
 [    0 21436     5     0     0     0     0     0     0     0     0]
 [   15     5 19410    21     0     0     0     5     0     0     0]
 [    0     0     2   439     0     0     0     0     0     0     0]
 [    0     2    42     0   274     0     0     0     0     0     0]
 [    0     0   250     0     0     0     0     0     0     0     0]
 [    0    26   160     0    22     0     0     0     0     0     0]
 [    0     0   136    12     0     0     0    56     0     0     0]
 [    0     1     2     0     0     0     0     0   193     0     0]
 [    0     9    44     0     0     0     0     0     0     0     0]
 [    0    16    31     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0    35     0     0     0     0    55     0 56068     0     0]
 [    0     0  4077     0     0     0 17364     0     0     0     0]
 [  778  5676   201   127    71     8 12587     2     6     0     0]
 [    2   356    69     0     0     0    14     0     0     0     0]
 [    8    17   270     4     0     0    18     0     1     0     0]
 [  228     0     5     0    10     0     7     0     0     0     0]
 [    0     2   201     0     0     0     5     0     0     0     0]
 [   11    64     0     0     7     0   122     0     0     0     0]
 [    0   159    19     2    14     0     2     0     0     0     0]
 [   23     2     0     0     0     0    28     0     0     0     0]
 [    0    18     0     0     1     0    28     0     0     0     0]]
Figure(640x480)
