layer_mask {0}
Start Training
gc 0
[[5384.01127422   27.50429438]
 [ 422.92938898  501.1648635 ]
 [ 329.3852495   447.54817011]
 [ 416.48452858  345.15966256]
 [ 341.26619577  394.13336148]
 [ 302.2359985   355.46661392]
 [ 288.8470039   265.16192538]
 [ 295.7065259   295.59840833]
 [ 343.55055665  297.54459454]
 [ 360.14517993  255.35908312]]
Train Epoch0 Acc 0.1541676158655428 (60907/395070), AUC 0.6542648673057556
Test Epoch0 layer0 Acc 0.9818268335155712, AUC 0.9820466637611389
Save ckpt to ./ckpt/mask1//kdd99/kdd99_linearal_l10_m1.pt  ,ep 0
Test Epoch0 layer1 Acc 0.055076337423561335, AUC 0.6416388154029846
Test Epoch0 layer2 Acc 0.0007593245049204228, AUC 0.5324597358703613
Test Epoch0 layer3 Acc 0.17532296602275949, AUC 0.44111430644989014
Test Epoch0 layer4 Acc 0.21759203012999637, AUC 0.38426530361175537
Test Epoch0 layer5 Acc 0.013445105900457619, AUC 0.20555704832077026
Test Epoch0 layer6 Acc 0.7299639573968331, AUC 0.5487836599349976
Test Epoch0 layer7 Acc 0.3834791236382781, AUC 0.5410839319229126
Test Epoch0 layer8 Acc 0.19255457012108695, AUC 0.40404844284057617
Test Epoch0 layer9 Acc 0.1920989754181347, AUC 0.6829648017883301
gc 0
[[4.80650027e+03 3.97443637e+00]
 [6.99385685e+02 6.36365688e+02]
 [4.90021874e+02 5.58185183e+02]
 [6.04572228e+02 4.21962618e+02]
 [4.69067233e+02 4.65036097e+02]
 [4.07505060e+02 4.15106033e+02]
 [3.82648099e+02 3.14203767e+02]
 [3.68158061e+02 3.40679673e+02]
 [3.93986758e+02 3.27366288e+02]
 [4.21447621e+02 2.85940912e+02]]
Train Epoch1 Acc 0.19224441238261575 (75950/395070), AUC 0.7311038970947266
Test Epoch1 layer0 Acc 0.9944417446239825, AUC 0.994379460811615
Save ckpt to ./ckpt/mask1//kdd99/kdd99_linearal_l10_m1.pt  ,ep 1
Test Epoch1 layer1 Acc 0.07082978981897704, AUC 0.6552671790122986
Test Epoch1 layer2 Acc 0.00036447576236180293, AUC 0.5346105098724365
Test Epoch1 layer3 Acc 0.18612562264609403, AUC 0.46205270290374756
Test Epoch1 layer4 Acc 0.17617340946827037, AUC 0.38790836930274963
Test Epoch1 layer5 Acc 0.007249017940306969, AUC 0.244345560669899
Test Epoch1 layer6 Acc 0.724679058842587, AUC 0.5631371140480042
Test Epoch1 layer7 Acc 0.387083383954967, AUC 0.5674046874046326
Test Epoch1 layer8 Acc 0.19368849471510144, AUC 0.3797198235988617
Test Epoch1 layer9 Acc 0.19062082371522293, AUC 0.769003689289093
gc 0
[[4.77213906e+03 3.28274227e+00]
 [8.77991608e+02 7.20284271e+02]
 [5.88235436e+02 6.34614677e+02]
 [7.02776639e+02 4.69847763e+02]
 [5.31603506e+02 5.02823723e+02]
 [4.57438272e+02 4.49594954e+02]
 [4.27535778e+02 3.38360963e+02]
 [4.01144364e+02 3.64018561e+02]
 [4.16656066e+02 3.40019623e+02]
 [4.46367298e+02 3.01251677e+02]]
Train Epoch2 Acc 0.18956640595337534 (74892/395070), AUC 0.7720129489898682
Test Epoch2 layer0 Acc 0.9951200745150447, AUC 0.9948782324790955
Save ckpt to ./ckpt/mask1//kdd99/kdd99_linearal_l10_m1.pt  ,ep 2
Test Epoch2 layer1 Acc 0.09828696391689952, AUC 0.6086768507957458
Test Epoch2 layer2 Acc 0.00038472441582634756, AUC 0.5226852893829346
Test Epoch2 layer3 Acc 0.15908354594419472, AUC 0.4626340866088867
Test Epoch2 layer4 Acc 0.17686186368606488, AUC 0.3647335171699524
Test Epoch2 layer5 Acc 0.005649374316607946, AUC 0.2542818784713745
Test Epoch2 layer6 Acc 0.6885858340420362, AUC 0.5401237607002258
Test Epoch2 layer7 Acc 0.38132264204430405, AUC 0.5755357146263123
Test Epoch2 layer8 Acc 0.19382011096262097, AUC 0.4014473855495453
Test Epoch2 layer9 Acc 0.18882881788361075, AUC 0.7722463011741638
gc 0
[[4.76716409e+03 3.14098431e+00]
 [1.03240990e+03 7.90891124e+02]
 [6.66536037e+02 6.95177324e+02]
 [7.77127416e+02 5.06215970e+02]
 [5.78183682e+02 5.33243024e+02]
 [4.93910786e+02 4.74709144e+02]
 [4.61453070e+02 3.54929549e+02]
 [4.24184784e+02 3.80901779e+02]
 [4.32756245e+02 3.49863964e+02]
 [4.62706151e+02 3.11313311e+02]]
Train Epoch3 Acc 0.1880805933125775 (74305/395070), AUC 0.7757020592689514
Test Epoch3 layer0 Acc 0.9955047989308711, AUC 0.9953076839447021
Save ckpt to ./ckpt/mask1//kdd99/kdd99_linearal_l10_m1.pt  ,ep 3
Test Epoch3 layer1 Acc 0.1201960069655368, AUC 0.5838592648506165
Test Epoch3 layer2 Acc 0.0002531081683068076, AUC 0.5142425894737244
Test Epoch3 layer3 Acc 0.15721054549872435, AUC 0.4690723419189453
Test Epoch3 layer4 Acc 0.1775098205969303, AUC 0.35657379031181335
Test Epoch3 layer5 Acc 0.005527882395820678, AUC 0.2423696368932724
Test Epoch3 layer6 Acc 0.6867229579232981, AUC 0.5439249277114868
Test Epoch3 layer7 Acc 0.3512938889563844, AUC 0.5743463039398193
Test Epoch3 layer8 Acc 0.19394160288340825, AUC 0.40682876110076904
Test Epoch3 layer9 Acc 0.18751265540841533, AUC 0.7811338901519775
gc 0
[[4.76623429e+03 3.11340017e+00]
 [1.16789929e+03 8.51941838e+02]
 [7.30880847e+02 7.44074632e+02]
 [8.35808149e+02 5.35709049e+02]
 [6.15400697e+02 5.57178963e+02]
 [5.21316261e+02 4.93364514e+02]
 [4.86808909e+02 3.65866927e+02]
 [4.40051087e+02 3.93069060e+02]
 [4.43636999e+02 3.56906896e+02]
 [4.73242910e+02 3.16954114e+02]]
Train Epoch4 Acc 0.18647581441263575 (73671/395070), AUC 0.7794139385223389
Test Epoch4 layer0 Acc 0.9957579070991779, AUC 0.9956146478652954
Save ckpt to ./ckpt/mask1//kdd99/kdd99_linearal_l10_m1.pt  ,ep 4
Test Epoch4 layer1 Acc 0.12868019276718098, AUC 0.5583485960960388
Test Epoch4 layer2 Acc 0.0002733568217713522, AUC 0.5108813047409058
Test Epoch4 layer3 Acc 0.1605212003401774, AUC 0.467001348733902
Test Epoch4 layer4 Acc 0.17808690722066983, AUC 0.35678520798683167
Test Epoch4 layer5 Acc 0.004566071356254809, AUC 0.24158591032028198
Test Epoch4 layer6 Acc 0.6849815737253473, AUC 0.5326234102249146
Test Epoch4 layer7 Acc 0.3127708257400883, AUC 0.5658538937568665
Test Epoch4 layer8 Acc 0.19404284615073097, AUC 0.38417279720306396
Test Epoch4 layer9 Acc 0.18600413072530678, AUC 0.780779242515564
gc 0
[[4.76605090e+03 3.14159903e+00]
 [1.29158072e+03 9.09596393e+02]
 [7.86490501e+02 7.87006432e+02]
 [8.84869383e+02 5.63268633e+02]
 [6.46992773e+02 5.78125794e+02]
 [5.43066408e+02 5.09906343e+02]
 [5.07006543e+02 3.73709767e+02]
 [4.52189863e+02 4.03463237e+02]
 [4.51981322e+02 3.62550928e+02]
 [4.81044925e+02 3.21284168e+02]]
Train Epoch5 Acc 0.1850710000759359 (73116/395070), AUC 0.7794902920722961
Test Epoch5 layer0 Acc 0.9958692746932329, AUC 0.9954995512962341
Test Epoch5 layer1 Acc 0.1324059450046572, AUC 0.5450415015220642
Test Epoch5 layer2 Acc 0.00035435143562953064, AUC 0.4792783856391907
Test Epoch5 layer3 Acc 0.16487466083505448, AUC 0.4815479516983032
Test Epoch5 layer4 Acc 0.17803628558700846, AUC 0.3648936450481415
Test Epoch5 layer5 Acc 0.00514315797999433, AUC 0.243130624294281
Test Epoch5 layer6 Acc 0.6832199408739319, AUC 0.5320354104042053
Test Epoch5 layer7 Acc 0.2766472279593407, AUC 0.5671291947364807
Test Epoch5 layer8 Acc 0.1940630948041955, AUC 0.4045462906360626
Test Epoch5 layer9 Acc 0.18444498440853682, AUC 0.7842268347740173
gc 0
[[4.76601351e+03 3.19557125e+00]
 [1.40655308e+03 9.61812496e+02]
 [8.35871263e+02 8.24624579e+02]
 [9.26755616e+02 5.89044946e+02]
 [6.74399577e+02 5.96665978e+02]
 [5.60831813e+02 5.24177394e+02]
 [5.23540297e+02 3.79405410e+02]
 [4.62056597e+02 4.12622907e+02]
 [4.58916713e+02 3.67110466e+02]
 [4.87392393e+02 3.24438188e+02]]
Train Epoch6 Acc 0.18412433239679044 (72742/395070), AUC 0.7757890224456787
Test Epoch6 layer0 Acc 0.9961021342080751, AUC 0.9932435750961304
Test Epoch6 layer1 Acc 0.13300328028186126, AUC 0.5225483179092407
Test Epoch6 layer2 Acc 0.0005163406633458874, AUC 0.46810340881347656
Test Epoch6 layer3 Acc 0.16586684485481715, AUC 0.485624760389328
Test Epoch6 layer4 Acc 0.17862349653748025, AUC 0.3762321472167969
Test Epoch6 layer5 Acc 0.0052342769205847815, AUC 0.24318113923072815
Test Epoch6 layer6 Acc 0.6754242092900822, AUC 0.5321352481842041
Test Epoch6 layer7 Acc 0.17654800955736444, AUC 0.5666896104812622
Test Epoch6 layer8 Acc 0.19409346778439235, AUC 0.4317874610424042
Test Epoch6 layer9 Acc 0.18381727615113594, AUC 0.7789188027381897
gc 0
[[4.76600710e+03 3.22410689e+00]
 [1.51255456e+03 1.01021326e+03]
 [8.79693053e+02 8.58335392e+02]
 [9.62541740e+02 6.12769020e+02]
 [6.98025114e+02 6.13466988e+02]
 [5.75557639e+02 5.36914102e+02]
 [5.37412367e+02 3.84633281e+02]
 [4.70636884e+02 4.20989830e+02]
 [4.65147581e+02 3.71122905e+02]
 [4.93053774e+02 3.27504159e+02]]
Train Epoch7 Acc 0.18321563267269092 (72383/395070), AUC 0.7523571252822876
Test Epoch7 layer0 Acc 0.9963147450694528, AUC 0.9888973236083984
Test Epoch7 layer1 Acc 0.13369173449965577, AUC 0.5078076720237732
Test Epoch7 layer2 Acc 0.0007289515247236059, AUC 0.45146048069000244
Test Epoch7 layer3 Acc 0.16764872635969708, AUC 0.4809562861919403
Test Epoch7 layer4 Acc 0.17844125865629937, AUC 0.3828035593032837
Test Epoch7 layer5 Acc 0.0055380067225529505, AUC 0.24148882925510406
Test Epoch7 layer6 Acc 0.6681448183695784, AUC 0.526498556137085
Test Epoch7 layer7 Acc 0.13824768152917832, AUC 0.564121425151825
Test Epoch7 layer8 Acc 0.1941440894180537, AUC 0.4480992257595062
Test Epoch7 layer9 Acc 0.18301745433928643, AUC 0.7404623627662659
gc 0
[[4.76600560e+03 3.19382846e+00]
 [1.59544874e+03 1.04893606e+03]
 [9.13414748e+02 8.88380832e+02]
 [9.88135167e+02 6.32273958e+02]
 [7.14716205e+02 6.28648124e+02]
 [5.87075298e+02 5.48031837e+02]
 [5.49017153e+02 3.88985039e+02]
 [4.79103546e+02 4.28550259e+02]
 [4.71456944e+02 3.74633459e+02]
 [4.98668580e+02 3.30728478e+02]]
Train Epoch8 Acc 0.18262839496798036 (72151/395070), AUC 0.7375905513763428
Test Epoch8 layer0 Acc 0.9965476045842951, AUC 0.9770136475563049
Test Epoch8 layer1 Acc 0.13249706394524763, AUC 0.5167490839958191
Test Epoch8 layer2 Acc 0.0010428056534240472, AUC 0.4487880766391754
Test Epoch8 layer3 Acc 0.1685902887457984, AUC 0.46686869859695435
Test Epoch8 layer4 Acc 0.17825902077511846, AUC 0.3878733813762665
Test Epoch8 layer5 Acc 0.005659498643340218, AUC 0.23996783792972565
Test Epoch8 layer6 Acc 0.6594480217065565, AUC 0.5155490040779114
Test Epoch8 layer7 Acc 0.06815696756165715, AUC 0.5611115097999573
Test Epoch8 layer8 Acc 0.1942858299923055, AUC 0.4737960696220398
Test Epoch8 layer9 Acc 0.18257198396306645, AUC 0.7403267025947571
gc 0
[[4.76600537e+03 3.08431184e+00]
 [1.64104320e+03 1.07198418e+03]
 [9.32167365e+02 9.07429934e+02]
 [1.00163418e+03 6.43825441e+02]
 [7.23419965e+02 6.38114918e+02]
 [5.93446091e+02 5.54965505e+02]
 [5.55796825e+02 3.91523308e+02]
 [4.84893892e+02 4.33496077e+02]
 [4.75919595e+02 3.76844426e+02]
 [5.02764534e+02 3.32888523e+02]]
Train Epoch9 Acc 0.18239046244969245 (72057/395070), AUC 0.7376642823219299
Test Epoch9 layer0 Acc 0.9965678532377596, AUC 0.9782165884971619
Test Epoch9 layer1 Acc 0.1317782367472563, AUC 0.5262529850006104
Test Epoch9 layer2 Acc 0.0013060381484631272, AUC 0.44762516021728516
Test Epoch9 layer3 Acc 0.16864091037945977, AUC 0.4804043769836426
Test Epoch9 layer4 Acc 0.17807678289393755, AUC 0.3972083330154419
Test Epoch9 layer5 Acc 0.005730368930466124, AUC 0.24153409898281097
Test Epoch9 layer6 Acc 0.6454966994694853, AUC 0.5114885568618774
Test Epoch9 layer7 Acc 0.056929089215567164, AUC 0.5599205493927002
Test Epoch9 layer8 Acc 0.19437694893289595, AUC 0.4813607931137085
Test Epoch9 layer9 Acc 0.18259223261653101, AUC 0.7394685745239258
Best AUC 0.9956146478652954
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask1//kdd99/kdd99_linearal_l10_m1.pt
[[56138     0    20     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     5 19417    14     0     8     0     6     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    2     0    39     0   277     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0    24    16     0     0     0   168     0     0     0     0]
 [    0     0   122     3     0     2     0    77     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    1     0    26     0     0    23     0     0     3     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0    35     0     0 56074    49     0     0     0     0]
 [  223     0  4100     0     0     0     0 17118     0     0     0]
 [  196  1448 12680     0     0   180    20     5  4904    14     9]
 [    0    56    79     0     0     0     0     0     1   305     0]
 [   41     3   273     0     0     0     0     0     1     0     0]
 [    0     1   249     0     0     0     0     0     0     0     0]
 [    2    22    67     0    87     0    30     0     0     0     0]
 [    0    81   122     0     0     0     0     0     1     0     0]
 [    0     0     2     0    52   142     0     0     0     0     0]
 [    0     0    32     0     9     6     0     6     0     0     0]
 [   18     0    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0     4 56056    80     2     0     0    16     0     0     0]
 [21259     1    12     0     0   154     0     0     0     0    15]
 [   16 17998    24   130     4  1251     0    32     0     1     0]
 [    0   441     0     0     0     0     0     0     0     0     0]
 [  235    12     0     9     0    62     0     0     0     0     0]
 [    4    33     0   211     0     2     0     0     0     0     0]
 [    2   122     0     0     0    84     0     0     0     0     0]
 [    0   129     0     8     0    67     0     0     0     0     0]
 [    2     0     0     0     0     0     0   194     0     0     0]
 [   15    29     0     1     2     3     0     3     0     0     0]
 [    0    26     0     3     0    18     0     0     0     0     0]]
Figure(640x480)
[[    0     0    17    15 56047    78     0     0     0     1     0]
 [    9     0 17354     0     0     0     0     0  4077     1     0]
 [ 2092   223 15630     0   102  1019     0     0   324    66     0]
 [    0     0   441     0     0     0     0     0     0     0     0]
 [    2     4    67     0     0     2     0     0   243     0     0]
 [    0    19     1     0     0   224     0     0     5     1     0]
 [    4   125     2     0     1     3     0     0    73     0     0]
 [   10     0    99     0     0    95     0     0     0     0     0]
 [    0    26     1     0   155     0     0     0     0    14     0]
 [    0     7    13     0     2    30     0     0     0     1     0]
 [    0     0    19     0     0    28     0     0     0     0     0]]
Figure(640x480)
[[    0 56136     0     0     0     0     2     0    20     0     0]
 [    0 17358     0     0     2     0  4077     0     4     0     0]
 [  422   415   121    20    14     2  3541     0 14921     0     0]
 [    0     0     0     0     0     0   117     0   324     0     0]
 [   37     1     2     0     0     2   275     0     1     0     0]
 [    7     0     0     0     0     0   240     0     3     0     0]
 [   79    17     0     0     0     0   111     0     1     0     0]
 [    6   132     0     0     0     0    66     0     0     0     0]
 [    2     0     0     0     0     0   194     0     0     0     0]
 [   12     2     0     0     0     2    35     0     2     0     0]
 [   18     0     0     0     0     0    22     0     7     0     0]]
Figure(640x480)
[[    0     0    17     0     0     0     0     0 56141     0     0]
 [    2     0 17362  4077     0     0     0     0     0     0     0]
 [18425    66   218   129     4   295    45     0   274     0     0]
 [  441     0     0     0     0     0     0     0     0     0     0]
 [  241     0    72     0     0     0     0     0     5     0     0]
 [  155     0     5     0     0    90     0     0     0     0     0]
 [   44     0   163     0     0     1     0     0     0     0     0]
 [  136     0     0     0     0    11     0     0    57     0     0]
 [    3     0     0     0     0    50     0     0   143     0     0]
 [   50     0     0     0     0     3     0     0     0     0     0]
 [   21     0    19     0     0     5     0     0     2     0     0]]
Figure(640x480)
[[56138     0     0     0     0    20     0     0     0     0     0]
 [17321     0    43  4072     0     0     5     0     0     0     0]
 [ 1823    11 11489    94     0  5236   802     0     1     0     0]
 [    2     0    95     0     0   343     1     0     0     0     0]
 [    5     0   312     0     0     1     0     0     0     0     0]
 [  203     0    26     0     0    19     0     0     2     0     0]
 [    0     0   189     7     0     1    11     0     0     0     0]
 [   77     0    28     0     0    99     0     0     0     0     0]
 [    2     0     0   194     0     0     0     0     0     0     0]
 [    9     0     3    39     0     2     0     0     0     0     0]
 [   21     0    18     0     0     8     0     0     0     0     0]]
Figure(640x480)
[[    0 56054    22     0     0    74     8     0     0     0     0]
 [    0 21412     0     0     0     7    22     0     0     0     0]
 [    0   279  9292     4     0   155  9722     0     4     0     0]
 [    0     0   429     0     0     0    12     0     0     0     0]
 [    0   280    30     0     0     2     6     0     0     0     0]
 [    0     3     5     0     0   185    57     0     0     0     0]
 [    0    99     3     0     0   102     4     0     0     0     0]
 [    0     1   127     0     0     0    76     0     0     0     0]
 [    0   196     0     0     0     0     0     0     0     0     0]
 [    0    22     2     0     0    29     0     0     0     0     0]
 [    0     0     7     0     0     0    40     0     0     0     0]]
Figure(640x480)
[[    0     0 56158     0     0     0     0     0     0     0     0]
 [    0     0 21441     0     0     0     0     0     0     0     0]
 [  290     0 19166     0     0     0     0     0     0     0     0]
 [   62     0   379     0     0     0     0     0     0     0     0]
 [    0     0   318     0     0     0     0     0     0     0     0]
 [  201     0    49     0     0     0     0     0     0     0     0]
 [    8     0   200     0     0     0     0     0     0     0     0]
 [   86     0   118     0     0     0     0     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   50     0     3     0     0     0     0     0     0     0     0]
 [   21     0    26     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[   30     0 56124     0     0     4     0     0     0     0     0]
 [    0    26 21413     0     0     1     1     0     0     0     0]
 [   43     2 18224   177     1   922    79     0     8     0     0]
 [    0     0   381     0     0    60     0     0     0     0     0]
 [    0     0   315     0     0     2     1     0     0     0     0]
 [    0     0     1     0     0    92     7     0   150     0     0]
 [    0     1   199     0     0     8     0     0     0     0     0]
 [    0     0    17    64     0   123     0     0     0     0     0]
 [    0     0   196     0     0     0     0     0     0     0     0]
 [    0     0    29     0     0     3     0     0    21     0     0]
 [    0     4    20     0     0    23     0     0     0     0     0]]
Figure(640x480)
