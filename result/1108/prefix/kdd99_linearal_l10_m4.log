Load ckpt from ./ckpt/mask3//kdd99/kdd99_linearal_l10_m3.pt
layer_mask {0, 1, 2, 3}
Start Training
gc 9
[[4.76600529e+03 3.24164432e+00]
 [7.21578374e-04 2.38919727e+00]
 [4.09047231e-02 2.60278934e+00]
 [3.07859777e+01 2.37963025e+01]
 [1.26638096e+03 1.16061404e+03]
 [8.79236452e+02 8.44725924e+02]
 [8.11263292e+02 6.51654376e+02]
 [6.61555202e+02 6.30276918e+02]
 [6.78307513e+02 5.85683378e+02]
 [6.02354889e+02 5.10662523e+02]]
Train Epoch0 Acc 0.0012909104715620016 (510/395070), AUC 0.24886712431907654
Test Epoch0 layer0 Acc 0.996952577653586, AUC 0.9872117638587952
Save ckpt to ./ckpt/mask4//kdd99/kdd99_linearal_l10_m4.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9972765561090188, AUC 0.947570264339447
Test Epoch0 layer2 Acc 0.997175312841696, AUC 0.9758733510971069
Test Epoch0 layer3 Acc 0.9964463613169724, AUC 0.9807977676391602
Test Epoch0 layer4 Acc 0.002227351881099907, AUC 0.38679930567741394
Test Epoch0 layer5 Acc 0.5725610496901956, AUC 0.589313268661499
Test Epoch0 layer6 Acc 0.0006884542177945167, AUC 0.2941782772541046
Test Epoch0 layer7 Acc 0.002126108613777184, AUC 0.8319302201271057
Test Epoch0 layer8 Acc 0.001599643623699024, AUC 0.76718670129776
Test Epoch0 layer9 Acc 0.0017211355444862917, AUC 0.21969066560268402
gc 0
[[4.76600527e+03 3.09146447e+00]
 [4.55673291e-04 2.19483204e+00]
 [2.41641009e-03 1.93315511e+00]
 [1.47161984e-01 2.25492228e+00]
 [1.26884167e+03 1.17896583e+03]
 [8.88981549e+02 8.49906174e+02]
 [8.15629140e+02 6.61014222e+02]
 [6.64199450e+02 6.39081183e+02]
 [6.82517408e+02 5.86020778e+02]
 [6.04386023e+02 5.10547954e+02]]
Train Epoch1 Acc 0.0021894854076492773 (865/395070), AUC 0.25433218479156494
Test Epoch1 layer0 Acc 0.9970133236139797, AUC 0.9804486632347107
Test Epoch1 layer1 Acc 0.9973879237030737, AUC 0.9419789910316467
Test Epoch1 layer2 Acc 0.9972765561090188, AUC 0.9619989991188049
Test Epoch1 layer3 Acc 0.9972563074555542, AUC 0.9337053894996643
Test Epoch1 layer4 Acc 0.002237476207832179, AUC 0.4227554202079773
Test Epoch1 layer5 Acc 0.007026282752196979, AUC 0.5843552947044373
Test Epoch1 layer6 Acc 0.00021261086137771838, AUC 0.2338566780090332
Test Epoch1 layer7 Acc 0.002662697930587616, AUC 0.8254002928733826
Test Epoch1 layer8 Acc 0.0031486656137366866, AUC 0.7548511028289795
Test Epoch1 layer9 Acc 0.0023488438018871745, AUC 0.2630873918533325
gc 0
[[4.76600525e+03 2.96873657e+00]
 [4.44257393e-04 2.04478053e+00]
 [8.40982582e-04 1.69959387e+00]
 [2.14243063e-02 1.67055270e+00]
 [1.26470482e+03 1.17415772e+03]
 [8.88691452e+02 8.53474917e+02]
 [8.14750442e+02 6.59172245e+02]
 [6.67372768e+02 6.37610718e+02]
 [6.84801835e+02 5.84592330e+02]
 [6.07296191e+02 5.08365969e+02]]
Train Epoch2 Acc 0.002159111043612524 (853/395070), AUC 0.25542688369750977
Test Epoch2 layer0 Acc 0.9969930749605151, AUC 0.9732601642608643
Test Epoch2 layer1 Acc 0.9973373020694124, AUC 0.9423788189888
Test Epoch2 layer2 Acc 0.9972664317822865, AUC 0.9494588971138
Test Epoch2 layer3 Acc 0.9972664317822865, AUC 0.8973208069801331
Test Epoch2 layer4 Acc 0.0024095897622808085, AUC 0.43662500381469727
Test Epoch2 layer5 Acc 0.005153282306726603, AUC 0.6099143624305725
Test Epoch2 layer6 Acc 0.00019236220791317378, AUC 0.22688747942447662
Test Epoch2 layer7 Acc 0.003766249544405297, AUC 0.8195496201515198
Test Epoch2 layer8 Acc 0.0029158060988944234, AUC 0.7485774755477905
Test Epoch2 layer9 Acc 0.0019742437127930994, AUC 0.25287139415740967
gc 0
[[4.76600523e+03 2.86642627e+00]
 [4.81025579e-04 1.92910981e+00]
 [8.64062732e-04 1.55922777e+00]
 [5.57471118e-03 1.46969454e+00]
 [1.25447721e+03 1.15192503e+03]
 [8.80960576e+02 8.48034673e+02]
 [8.09940249e+02 6.52026398e+02]
 [6.68169353e+02 6.28871197e+02]
 [6.80609031e+02 5.75649577e+02]
 [6.04371860e+02 5.00863663e+02]]
Train Epoch3 Acc 0.0021464550585972107 (848/395070), AUC 0.25300419330596924
Test Epoch3 layer0 Acc 0.9971854371684283, AUC 0.9782679080963135
Test Epoch3 layer1 Acc 0.9976309075446482, AUC 0.9639481902122498
Test Epoch3 layer2 Acc 0.9976106588911837, AUC 0.9647085666656494
Test Epoch3 layer3 Acc 0.9975701615842546, AUC 0.9199596643447876
Test Epoch3 layer4 Acc 0.002267849188028996, AUC 0.4461921453475952
Test Epoch3 layer5 Acc 0.004758433564167983, AUC 0.6527941823005676
Test Epoch3 layer6 Acc 0.00017211355444862918, AUC 0.22371982038021088
Test Epoch3 layer7 Acc 0.003128416960272142, AUC 0.7960957884788513
Test Epoch3 layer8 Acc 0.0028854331186976066, AUC 0.752870500087738
Test Epoch3 layer9 Acc 0.002105859960312639, AUC 0.25104913115501404
gc 0
[[4.76600522e+03 2.76183532e+00]
 [4.46246627e-04 1.82853865e+00]
 [7.84369522e-04 1.45245591e+00]
 [2.15892705e-03 1.34306652e+00]
 [1.24877807e+03 1.13078047e+03]
 [8.77211659e+02 8.41184222e+02]
 [8.06190364e+02 6.46865039e+02]
 [6.68103658e+02 6.19655063e+02]
 [6.76938501e+02 5.68164312e+02]
 [6.02389508e+02 4.96181145e+02]]
Train Epoch4 Acc 0.002012301617434885 (795/395070), AUC 0.250341534614563
Test Epoch4 layer0 Acc 0.9972563074555542, AUC 0.9704685807228088
Test Epoch4 layer1 Acc 0.9976410318713805, AUC 0.9599006175994873
Test Epoch4 layer2 Acc 0.9974790426436642, AUC 0.9593290686607361
Test Epoch4 layer3 Acc 0.997468918316932, AUC 0.9217929244041443
Test Epoch4 layer4 Acc 0.0024804600494067143, AUC 0.45278385281562805
Test Epoch4 layer5 Acc 0.004728060583971166, AUC 0.6765376329421997
Test Epoch4 layer6 Acc 0.00013161624751953995, AUC 0.2308153659105301
Test Epoch4 layer7 Acc 0.003310654841453043, AUC 0.8085911273956299
Test Epoch4 layer8 Acc 0.0028955574454298787, AUC 0.7609401941299438
Test Epoch4 layer9 Acc 0.00206536265338355, AUC 0.24827350676059723
gc 0
[[4.76600522e+03 2.65595898e+00]
 [4.64827881e-04 1.74303604e+00]
 [3.00292977e-04 1.35319986e+00]
 [5.09507921e-04 1.22778303e+00]
 [1.24717247e+03 1.11815946e+03]
 [8.76369435e+02 8.37899300e+02]
 [8.05133033e+02 6.45891463e+02]
 [6.68237902e+02 6.14371913e+02]
 [6.75691343e+02 5.64841584e+02]
 [6.01732471e+02 4.94167203e+02]]
Train Epoch5 Acc 0.002103424709545144 (831/395070), AUC 0.24436073005199432
Test Epoch5 layer0 Acc 0.997286680435751, AUC 0.970837414264679
Test Epoch5 layer1 Acc 0.9977625237921678, AUC 0.9654772281646729
Test Epoch5 layer2 Acc 0.9977017778317742, AUC 0.9634400010108948
Test Epoch5 layer3 Acc 0.9977017778317742, AUC 0.940773069858551
Test Epoch5 layer4 Acc 0.002500708702871259, AUC 0.45696133375167847
Test Epoch5 layer5 Acc 0.004717936257238893, AUC 0.6792721152305603
Test Epoch5 layer6 Acc 0.00013161624751953995, AUC 0.2306099832057953
Test Epoch5 layer7 Acc 0.0034220224355080387, AUC 0.8075670003890991
Test Epoch5 layer8 Acc 0.0031486656137366866, AUC 0.7625183463096619
Test Epoch5 layer9 Acc 0.0020552383266512777, AUC 0.2381177544593811
gc 0
[[4.76600522e+03 2.61185283e+00]
 [4.15398363e-04 1.67670351e+00]
 [3.02918633e-04 1.30476715e+00]
 [4.18193067e-04 1.17637589e+00]
 [1.24693353e+03 1.11021884e+03]
 [8.76268332e+02 8.37183854e+02]
 [8.05009945e+02 6.46580384e+02]
 [6.68479869e+02 6.12730621e+02]
 [6.75303106e+02 5.64084264e+02]
 [6.01523159e+02 4.94709750e+02]]
Train Epoch6 Acc 0.002123674285569646 (839/395070), AUC 0.23945903778076172
Test Epoch6 layer0 Acc 0.9972765561090188, AUC 0.969696581363678
Test Epoch6 layer1 Acc 0.9976511561981128, AUC 0.9686721563339233
Test Epoch6 layer2 Acc 0.9977119021585065, AUC 0.9666251540184021
Test Epoch6 layer3 Acc 0.997691653505042, AUC 0.9433858394622803
Test Epoch6 layer4 Acc 0.0025513303365326204, AUC 0.481245219707489
Test Epoch6 layer5 Acc 0.00452557404932572, AUC 0.6826689839363098
Test Epoch6 layer6 Acc 0.00013161624751953995, AUC 0.23632502555847168
Test Epoch6 layer7 Acc 0.0033815251285789494, AUC 0.8026146292686462
Test Epoch6 layer8 Acc 0.0028854331186976066, AUC 0.7594301700592041
Test Epoch6 layer9 Acc 0.0020754869801158224, AUC 0.23840142786502838
gc 0
[[4.76600522e+03 2.57161105e+00]
 [4.48022872e-04 1.62368083e+00]
 [3.24356024e-04 1.26394948e+00]
 [4.34949124e-04 1.13451434e+00]
 [1.24684625e+03 1.10377168e+03]
 [8.76213677e+02 8.36392583e+02]
 [8.05060949e+02 6.46719859e+02]
 [6.68719781e+02 6.11197805e+02]
 [6.75070560e+02 5.63181923e+02]
 [6.01377730e+02 4.95118939e+02]]
Train Epoch7 Acc 0.0020755815425114537 (820/395070), AUC 0.2366158366203308
Test Epoch7 layer0 Acc 0.9972259344753573, AUC 0.95571368932724
Test Epoch7 layer1 Acc 0.9975397886040578, AUC 0.9552381038665771
Test Epoch7 layer2 Acc 0.997509415623861, AUC 0.9622192978858948
Test Epoch7 layer3 Acc 0.997509415623861, AUC 0.9426552057266235
Test Epoch7 layer4 Acc 0.002561454663264893, AUC 0.558212399482727
Test Epoch7 layer5 Acc 0.004717936257238893, AUC 0.6809173226356506
Test Epoch7 layer6 Acc 0.00011136759405499535, AUC 0.24731308221817017
Test Epoch7 layer7 Acc 0.004211719920625278, AUC 0.8017932772636414
Test Epoch7 layer8 Acc 0.0028854331186976066, AUC 0.7593322396278381
Test Epoch7 layer9 Acc 0.00036447576236180293, AUC 0.23348741233348846
gc 0
[[4.76600522e+03 2.53127292e+00]
 [4.86711715e-04 1.57475666e+00]
 [3.72268306e-04 1.22970480e+00]
 [5.05678207e-04 1.09903847e+00]
 [1.24682953e+03 1.09972035e+03]
 [8.76224356e+02 8.38016971e+02]
 [8.05184650e+02 6.49220371e+02]
 [6.68942219e+02 6.11323057e+02]
 [6.74912890e+02 5.62908231e+02]
 [6.01219369e+02 4.96510996e+02]]
Train Epoch8 Acc 0.0021084871035512696 (833/395070), AUC 0.23485983908176422
Test Epoch8 layer0 Acc 0.997398048029806, AUC 0.9700923562049866
Test Epoch8 layer1 Acc 0.9978030210990969, AUC 0.973427414894104
Test Epoch8 layer2 Acc 0.9978131454258292, AUC 0.9728565812110901
Test Epoch8 layer3 Acc 0.9978333940792937, AUC 0.9562748074531555
Test Epoch8 layer4 Acc 0.0025108330296035315, AUC 0.5591394901275635
Test Epoch8 layer5 Acc 0.004474952415664358, AUC 0.6803402900695801
Test Epoch8 layer6 Acc 0.00012149192078726765, AUC 0.24121226370334625
Test Epoch8 layer7 Acc 0.004728060583971166, AUC 0.8022671341896057
Test Epoch8 layer8 Acc 0.002865184465233062, AUC 0.7574613690376282
Test Epoch8 layer9 Acc 0.002004616692989916, AUC 0.23407573997974396
gc 0
[[4.76600522e+03 2.48637756e+00]
 [4.21747587e-04 1.52217341e+00]
 [1.49087443e-04 1.18276160e+00]
 [1.19330088e-04 1.04999822e+00]
 [1.24684445e+03 1.09644866e+03]
 [8.76224759e+02 8.39866727e+02]
 [8.05275752e+02 6.51499658e+02]
 [6.69092140e+02 6.11841722e+02]
 [6.74758758e+02 5.62154677e+02]
 [6.01071829e+02 4.98188700e+02]]
Train Epoch9 Acc 0.0021565798466094614 (852/395070), AUC 0.23370036482810974
Test Epoch9 layer0 Acc 0.997398048029806, AUC 0.9618194103240967
Test Epoch9 layer1 Acc 0.9978131454258292, AUC 0.9624451994895935
Test Epoch9 layer2 Acc 0.9978030210990969, AUC 0.9641153216362
Test Epoch9 layer3 Acc 0.9978131454258292, AUC 0.9465299844741821
Test Epoch9 layer4 Acc 0.002571578989997165, AUC 0.575890302658081
Test Epoch9 layer5 Acc 0.0033714008018466773, AUC 0.6835295557975769
Test Epoch9 layer6 Acc 0.00012149192078726765, AUC 0.24253392219543457
Test Epoch9 layer7 Acc 0.004991293079010246, AUC 0.8025392889976501
Test Epoch9 layer8 Acc 0.002865184465233062, AUC 0.7546235918998718
Test Epoch9 layer9 Acc 0.0022779735147612683, AUC 0.23354077339172363
Best AUC 0.9872117638587952
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask4//kdd99/kdd99_linearal_l10_m4.pt
[[56145     0    13     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     1 19413    11     0     5     0     9     0     0     0]
 [    0     0     9   432     0     0     0     0     0     0     0]
 [    5     0    34     0   279     0     0     0     0     0     0]
 [    0     0    17     0     0   222     5     6     0     0     0]
 [    0    12     8     0     0     0   188     0     0     0     0]
 [    0     0    45     0     0     0     0   159     0     0     0]
 [    0     0     1     0     1     0     0     0   194     0     0]
 [    4     1     5     0     0    20     0     2    21     0     0]
 [    0    18     8     0     0    21     0     0     0     0     0]]
Figure(640x480)
[[56148     0    10     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     1 19410    10     0     5     0    13     0     0     0]
 [    0     0     9   432     0     0     0     0     0     0     0]
 [    5     0    25     0   288     0     0     0     0     0     0]
 [    0     0    14     0     0   225     5     6     0     0     0]
 [    0    10     7     0     0     0   191     0     0     0     0]
 [    0     0    29     0     0     0     0   175     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    3     0    10     0     0    19     0     2    19     0     0]
 [    0    16    12     0     0    19     0     0     0     0     0]]
Figure(640x480)
[[56150     0     8     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19412     9     0     5     0    13     0     0     0]
 [    0     0    15   426     0     0     0     0     0     0     0]
 [    5     0    27     0   286     0     0     0     0     0     0]
 [    0     0    17     0     0   221     5     7     0     0     0]
 [    0    10     8     0     0     0   190     0     0     0     0]
 [    0     0    31     0     0     0     0   173     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    0     0     4     0     0    21     0     2    26     0     0]
 [    0    16    21     0     0    10     0     0     0     0     0]]
Figure(640x480)
[[56151     0     7     0     0     0     0     0     0     0     0]
 [    0 21437     4     0     0     0     0     0     0     0     0]
 [   16     1 19423     8     0     5     0     3     0     0     0]
 [    0     0    15   426     0     0     0     0     0     0     0]
 [    7     0    33     0   278     0     0     0     0     0     0]
 [    0     0    24     0     0   226     0     0     0     0     0]
 [    0    14    15     0     0     0   179     0     0     0     0]
 [    0     0    89     7     0     0     0   108     0     0     0]
 [    0     0     1     1     1     0     0     0   193     0     0]
 [    0     2    13    16     0    21     0     0     1     0     0]
 [    0    16    28     0     0     3     0     0     0     0     0]]
Figure(640x480)
[[   23     0     0     0     0     0 56135     0     0     0     0]
 [  317     0     0 21124     0     0     0     0     0     0     0]
 [19044     0     0     0    30     5   375     0     2     0     0]
 [    2     0     0     0   439     0     0     0     0     0     0]
 [  295     0     0     0     0     0    23     0     0     0     0]
 [    5     0     0     0     0    19   180     0    46     0     0]
 [   20     0     0     0    10     0   178     0     0     0     0]
 [   11     0     0     0     0     3   190     0     0     0     0]
 [    0     0     0     0     0     0   196     0     0     0     0]
 [    2     0     0     0     0     2    49     0     0     0     0]
 [   25     0     0     0     0     0    22     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [    0     0     0     0  4038   172     0     0 17231     0     0]
 [ 1906  1830     0     0     1 15718     0     0     1     0     0]
 [    0   427     0     0     0    14     0     0     0     0     0]
 [   37   280     0     0     0     1     0     0     0     0     0]
 [    3    45     0     0     0   202     0     0     0     0     0]
 [    1   194     0     0     2     4     0     0     7     0     0]
 [   91    48     2     0     0    10     0     0    53     0     0]
 [    0     3     0     0     0     0     0     0   193     0     0]
 [    2    23     0     0     0    20     0     0     8     0     0]
 [   24     1     0     0     0    22     0     0     0     0     0]]
Figure(640x480)
[[    0 56158     0     0     0     0     0     0     0     0     0]
 [    0     2 20304     0     0     0  1135     0     0     0     0]
 [   46 19270    54     0     3     0    83     0     0     0     0]
 [    0   416     0     0     1     0     0     0    24     0     0]
 [    0   274    43     0     0     0     1     0     0     0     0]
 [    0   250     0     0     0     0     0     0     0     0     0]
 [    0   195     1     0     0     0    12     0     0     0     0]
 [  121    81     1     0     1     0     0     0     0     0     0]
 [  186     1     9     0     0     0     0     0     0     0     0]
 [   30    11    12     0     0     0     0     0     0     0     0]
 [    0    47     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0     0     0     0     0 56158     0     0     0     0]
 [    0     0     0     0     0     0 21441     0     0     0     0]
 [    0     5     2     0   176     1 19272     0     0     0     0]
 [    0   423     0     0     0     0    18     0     0     0     0]
 [    0     0     0     0     0     0   318     0     0     0     0]
 [    0     0     0     0     0     0   206    44     0     0     0]
 [    0     0     0     0     0     0   208     0     0     0     0]
 [    0     0     0     0     0     0   204     0     0     0     0]
 [    0     0     0     0     0     0   196     0     0     0     0]
 [    0     0     0     0     0     0    53     0     0     0     0]
 [    0     0     0     0     0     0    47     0     0     0     0]]
Figure(640x480)
[[    0 56109     0     0    49     0     0     0     0     0     0]
 [21428     0     0     0    13     0     0     0     0     0     0]
 [   12    10     0     0 19424     0    10     0     0     0     0]
 [    0   422     0     0     2     0    17     0     0     0     0]
 [  166     0     0     0   149     0     0     3     0     0     0]
 [    0     0     0     0   250     0     0     0     0     0     0]
 [   21     0     0     0    12     0     9   166     0     0     0]
 [    0     0     0     0   200     0     4     0     0     0     0]
 [    0     0     0     0     0     0     3   193     0     0     0]
 [    0     0     0     0    26     0     0    27     0     0     0]
 [    0     0     0     0    47     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0     5     0     2     0 56151     0     0     0     0]
 [    0     0 21434     0     0     0     7     0     0     0     0]
 [    0    34     5     0     0     5 19412     0     0     0     0]
 [    0   425     0     0     0     0    16     0     0     0     0]
 [    0     0   292     0     0     0    26     0     0     0     0]
 [    0     6     0     0     0   157    87     0     0     0     0]
 [    0     0    61     0     0   139     8     0     0     0     0]
 [    0   154     0     0     0     0    50     0     0     0     0]
 [    0     0   154     0    42     0     0     0     0     0     0]
 [    0     1    16     0     1     0    35     0     0     0     0]
 [    0     0    15     0     0     0    32     0     0     0     0]]
Figure(640x480)
