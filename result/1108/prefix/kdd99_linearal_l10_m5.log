Load ckpt from ./ckpt/mask4//kdd99/kdd99_linearal_l10_m4.pt
layer_mask {0, 1, 2, 3, 4}
Start Training
gc 9
[[4.76600527e+03 3.08918339e+00]
 [7.72202909e-04 2.18948225e+00]
 [3.27555392e-03 1.92918341e+00]
 [4.98681023e-02 2.09690218e+00]
 [2.75660241e+01 2.39797569e+01]
 [1.21386062e+03 9.79046482e+02]
 [8.00931787e+02 7.65694719e+02]
 [5.92286739e+02 6.48121053e+02]
 [5.52867586e+02 5.40622637e+02]
 [4.91811405e+02 5.69883242e+02]]
Train Epoch0 Acc 0.12656238135014047 (50001/395070), AUC 0.2675153613090515
Test Epoch0 layer0 Acc 0.9969627019803183, AUC 0.978680431842804
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l10_m5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9973575507228769, AUC 0.9472091197967529
Test Epoch0 layer2 Acc 0.9972765561090188, AUC 0.9650707840919495
Test Epoch0 layer3 Acc 0.9973069290892156, AUC 0.9324802160263062
Test Epoch0 layer4 Acc 0.9966083505446888, AUC 0.9713567495346069
Test Epoch0 layer5 Acc 0.5701109626209857, AUC 0.6050204634666443
Test Epoch0 layer6 Acc 0.0045053253958611756, AUC 0.42919883131980896
Test Epoch0 layer7 Acc 0.04380796177054226, AUC 0.749612033367157
Test Epoch0 layer8 Acc 0.00040497306929089213, AUC 0.38486775755882263
Test Epoch0 layer9 Acc 0.049599076661402015, AUC 0.3019590377807617
gc 0
[[4.76600525e+03 2.96822693e+00]
 [4.50256194e-04 2.04409721e+00]
 [8.28760490e-04 1.70062074e+00]
 [4.18212450e-03 1.60752682e+00]
 [1.14030557e-01 1.77662257e+00]
 [1.21733125e+03 9.80293710e+02]
 [7.94825512e+02 7.65379128e+02]
 [5.96095786e+02 6.47100133e+02]
 [5.41916694e+02 5.39169318e+02]
 [4.91572812e+02 5.70030064e+02]]
Train Epoch1 Acc 0.015738982965044168 (6218/395070), AUC 0.3200768232345581
Test Epoch1 layer0 Acc 0.9969930749605151, AUC 0.9760790467262268
Test Epoch1 layer1 Acc 0.9974284210100028, AUC 0.9525022506713867
Test Epoch1 layer2 Acc 0.9972968047624833, AUC 0.9668982028961182
Test Epoch1 layer3 Acc 0.9972765561090188, AUC 0.9429653286933899
Test Epoch1 layer4 Acc 0.997246183128822, AUC 0.9773473739624023
Test Epoch1 layer5 Acc 0.0048090551978293445, AUC 0.5930144786834717
Test Epoch1 layer6 Acc 0.00045559470295225367, AUC 0.4313589930534363
Test Epoch1 layer7 Acc 0.044405297047746324, AUC 0.6958942413330078
Test Epoch1 layer8 Acc 0.0010731786336208643, AUC 0.3623828887939453
Test Epoch1 layer9 Acc 0.004272465881018912, AUC 0.34994247555732727
gc 0
[[4.76600523e+03 2.86385648e+00]
 [4.34933131e-04 1.92270778e+00]
 [7.73818796e-04 1.55523972e+00]
 [1.74822094e-03 1.43290895e+00]
 [2.20526726e-02 1.36143597e+00]
 [1.22085474e+03 9.64225964e+02]
 [7.87220890e+02 7.54950881e+02]
 [5.95919869e+02 6.39984240e+02]
 [5.40965928e+02 5.32659543e+02]
 [4.90750352e+02 5.63985056e+02]]
Train Epoch2 Acc 0.0038575442326676287 (1524/395070), AUC 0.3573189079761505
Test Epoch2 layer0 Acc 0.9971348155347669, AUC 0.9743495583534241
Test Epoch2 layer1 Acc 0.9975802859109869, AUC 0.9563884139060974
Test Epoch2 layer2 Acc 0.9975195399505933, AUC 0.9625055193901062
Test Epoch2 layer3 Acc 0.9974790426436642, AUC 0.9343977570533752
Test Epoch2 layer4 Acc 0.9974486696634673, AUC 0.9637100696563721
Test Epoch2 layer5 Acc 0.004201595593893006, AUC 0.5829944014549255
Test Epoch2 layer6 Acc 0.0002834811485036245, AUC 0.4613216519355774
Test Epoch2 layer7 Acc 0.21744016522901227, AUC 0.6585140824317932
Test Epoch2 layer8 Acc 0.0012554165148017658, AUC 0.3695945739746094
Test Epoch2 layer9 Acc 0.003594135989956668, AUC 0.35182976722717285
gc 0
[[4.76600522e+03 2.76189637e+00]
 [4.43767280e-04 1.82605579e+00]
 [7.58860492e-04 1.45140359e+00]
 [1.28333712e-03 1.31952700e+00]
 [7.17318441e-03 1.21570091e+00]
 [1.21863451e+03 9.39327476e+02]
 [7.77831950e+02 7.42483379e+02]
 [5.94313775e+02 6.29510065e+02]
 [5.38196162e+02 5.23327335e+02]
 [4.87278470e+02 5.53070347e+02]]
Train Epoch3 Acc 0.0034778646822082163 (1374/395070), AUC 0.3485483229160309
Test Epoch3 layer0 Acc 0.9971955614951605, AUC 0.9662485718727112
Test Epoch3 layer1 Acc 0.9977017778317742, AUC 0.9493098855018616
Test Epoch3 layer2 Acc 0.9975499129307901, AUC 0.9629468321800232
Test Epoch3 layer3 Acc 0.9976005345644514, AUC 0.9361024498939514
Test Epoch3 layer4 Acc 0.9975397886040578, AUC 0.9532676339149475
Test Epoch3 layer5 Acc 0.0038776171384602926, AUC 0.605285108089447
Test Epoch3 layer6 Acc 0.00017211355444862918, AUC 0.4475269019603729
Test Epoch3 layer7 Acc 0.2193334143279472, AUC 0.7043216228485107
Test Epoch3 layer8 Acc 0.0008808164257076904, AUC 0.3665158450603485
Test Epoch3 layer9 Acc 0.003219535900862593, AUC 0.3453763723373413
gc 0
[[4.76600522e+03 2.67043577e+00]
 [4.34288493e-04 1.74672249e+00]
 [7.87369212e-04 1.37001572e+00]
 [1.33655776e-03 1.23405355e+00]
 [3.64193445e-03 1.12076681e+00]
 [1.21169211e+03 9.16209471e+02]
 [7.72304411e+02 7.30142796e+02]
 [5.91842348e+02 6.19479146e+02]
 [5.35110820e+02 5.15521612e+02]
 [4.83805175e+02 5.43440039e+02]]
Train Epoch4 Acc 0.0033842103930948947 (1337/395070), AUC 0.34754106402397156
Test Epoch4 layer0 Acc 0.9972360588020897, AUC 0.956399142742157
Test Epoch4 layer1 Acc 0.9976106588911837, AUC 0.9399576187133789
Test Epoch4 layer2 Acc 0.9975397886040578, AUC 0.9481214880943298
Test Epoch4 layer3 Acc 0.9975499129307901, AUC 0.9253221154212952
Test Epoch4 layer4 Acc 0.997620783217916, AUC 0.9278613924980164
Test Epoch4 layer5 Acc 0.0028854331186976066, AUC 0.6037542819976807
Test Epoch4 layer6 Acc 0.00015186490098408455, AUC 0.4357880651950836
Test Epoch4 layer7 Acc 0.21934353865467945, AUC 0.6955530643463135
Test Epoch4 layer8 Acc 0.02620175758312072, AUC 0.4006049931049347
Test Epoch4 layer9 Acc 0.003219535900862593, AUC 0.3454881012439728
gc 0
[[4.76600522e+03 2.57479280e+00]
 [4.64122685e-04 1.66749331e+00]
 [8.12252338e-04 1.29825139e+00]
 [1.37569277e-03 1.16314064e+00]
 [2.64254327e-03 1.04564529e+00]
 [1.20479274e+03 8.97391036e+02]
 [7.68729108e+02 7.19513690e+02]
 [5.89981574e+02 6.11392508e+02]
 [5.32606713e+02 5.09507246e+02]
 [4.81487363e+02 5.35620341e+02]]
Train Epoch5 Acc 0.0033361176500367024 (1318/395070), AUC 0.34724491834640503
Test Epoch5 layer0 Acc 0.9973271777426801, AUC 0.9672921895980835
Test Epoch5 layer1 Acc 0.9976511561981128, AUC 0.9622036218643188
Test Epoch5 layer2 Acc 0.997620783217916, AUC 0.9631018042564392
Test Epoch5 layer3 Acc 0.997620783217916, AUC 0.9449647665023804
Test Epoch5 layer4 Acc 0.9975802859109869, AUC 0.9423347115516663
Test Epoch5 layer5 Acc 0.0024298384157453528, AUC 0.6064277291297913
Test Epoch5 layer6 Acc 0.00012149192078726765, AUC 0.42490577697753906
Test Epoch5 layer7 Acc 0.21921192240715992, AUC 0.6919499039649963
Test Epoch5 layer8 Acc 0.046217551532823066, AUC 0.40992143750190735
Test Epoch5 layer9 Acc 0.003330903494917588, AUC 0.3450459837913513
gc 0
[[4.76600522e+03 2.53664303e+00]
 [4.30911865e-04 1.61684722e+00]
 [2.56589099e-04 1.23390277e+00]
 [7.91431850e-04 1.10512106e+00]
 [6.38720497e-04 9.66636474e-01]
 [1.20025660e+03 8.87925440e+02]
 [7.66738161e+02 7.15300053e+02]
 [5.88943004e+02 6.08167272e+02]
 [5.31169714e+02 5.07431487e+02]
 [4.80269656e+02 5.31926897e+02]]
Train Epoch6 Acc 0.0033133368770091377 (1309/395070), AUC 0.34691059589385986
Test Epoch6 layer0 Acc 0.9974284210100028, AUC 0.9716073870658875
Test Epoch6 layer1 Acc 0.9977928967723646, AUC 0.9735524654388428
Test Epoch6 layer2 Acc 0.9977928967723646, AUC 0.9738785028457642
Test Epoch6 layer3 Acc 0.9978333940792937, AUC 0.9604142904281616
Test Epoch6 layer4 Acc 0.9977726481189001, AUC 0.9633653163909912
Test Epoch6 layer5 Acc 0.0019539950593285547, AUC 0.613490641117096
Test Epoch6 layer6 Acc 8.099461385817843e-05, AUC 0.41882190108299255
Test Epoch6 layer7 Acc 0.21942453326853764, AUC 0.6893342733383179
Test Epoch6 layer8 Acc 0.09868181265945815, AUC 0.4082503616809845
Test Epoch6 layer9 Acc 0.0033410278216498604, AUC 0.3442244231700897
gc 0
[[4.76600522e+03 2.50192072e+00]
 [4.62251462e-04 1.57182995e+00]
 [3.60720436e-04 1.20277661e+00]
 [1.13140932e-03 1.07090236e+00]
 [9.94380094e-04 9.38323271e-01]
 [1.19742606e+03 8.83861795e+02]
 [7.65942848e+02 7.12071882e+02]
 [5.88643875e+02 6.07781439e+02]
 [5.30484713e+02 5.07248456e+02]
 [4.79741273e+02 5.31075627e+02]]
Train Epoch7 Acc 0.003338648847039765 (1319/395070), AUC 0.34612828493118286
Test Epoch7 layer0 Acc 0.9974081723565383, AUC 0.9644218683242798
Test Epoch7 layer1 Acc 0.9978030210990969, AUC 0.9688432216644287
Test Epoch7 layer2 Acc 0.9977928967723646, AUC 0.9679657220840454
Test Epoch7 layer3 Acc 0.9978030210990969, AUC 0.9605591297149658
Test Epoch7 layer4 Acc 0.9978232697525614, AUC 0.9616957306861877
Test Epoch7 layer5 Acc 0.0019033734256671932, AUC 0.6148371696472168
Test Epoch7 layer6 Acc 4.0497306929089216e-05, AUC 0.4180581867694855
Test Epoch7 layer7 Acc 0.21944478192200217, AUC 0.6893197298049927
Test Epoch7 layer8 Acc 0.15687644271655934, AUC 0.40862801671028137
Test Epoch7 layer9 Acc 0.0033207791681853158, AUC 0.34322118759155273
gc 0
[[4.76600522e+03 2.46871406e+00]
 [4.63849011e-04 1.53111532e+00]
 [3.45414543e-04 1.17599803e+00]
 [1.07820455e-03 1.04266257e+00]
 [9.17015082e-04 9.14339538e-01]
 [1.19500177e+03 8.79675108e+02]
 [7.65322248e+02 7.10512067e+02]
 [5.88497861e+02 6.07854073e+02]
 [5.29955896e+02 5.07279323e+02]
 [4.79389596e+02 5.30979303e+02]]
Train Epoch8 Acc 0.0033715544080795807 (1332/395070), AUC 0.34392717480659485
Test Epoch8 layer0 Acc 0.997468918316932, AUC 0.9661710262298584
Test Epoch8 layer1 Acc 0.9978738913862228, AUC 0.9718590378761292
Test Epoch8 layer2 Acc 0.997843518406026, AUC 0.9687343835830688
Test Epoch8 layer3 Acc 0.9978536427327582, AUC 0.9709531664848328
Test Epoch8 layer4 Acc 0.997884015712955, AUC 0.9661121368408203
Test Epoch8 layer5 Acc 0.001032681326691775, AUC 0.6119579076766968
Test Epoch8 layer6 Acc 6.0745960393633824e-05, AUC 0.39007073640823364
Test Epoch8 layer7 Acc 0.21942453326853764, AUC 0.6894387006759644
Test Epoch8 layer8 Acc 0.17211355444862916, AUC 0.41038018465042114
Test Epoch8 layer9 Acc 0.003330903494917588, AUC 0.34151095151901245
gc 0
[[4.76600522e+03 2.42640994e+00]
 [4.48937784e-04 1.48648769e+00]
 [3.47661665e-04 1.14745761e+00]
 [1.09969995e-03 1.01186734e+00]
 [9.45668400e-04 8.86835125e-01]
 [1.19274879e+03 8.76192780e+02]
 [7.64757728e+02 7.09306135e+02]
 [5.88406797e+02 6.08764881e+02]
 [5.29469406e+02 5.07327827e+02]
 [4.79067617e+02 5.30669135e+02]]
Train Epoch9 Acc 0.003331055256030577 (1316/395070), AUC 0.32737886905670166
Test Epoch9 layer0 Acc 0.9974587939901997, AUC 0.9597887396812439
Test Epoch9 layer1 Acc 0.997843518406026, AUC 0.9649068713188171
Test Epoch9 layer2 Acc 0.9978131454258292, AUC 0.9697462320327759
Test Epoch9 layer3 Acc 0.9978232697525614, AUC 0.9649155139923096
Test Epoch9 layer4 Acc 0.9978637670594905, AUC 0.9663829803466797
Test Epoch9 layer5 Acc 0.002166605920706273, AUC 0.6157872080802917
Test Epoch9 layer6 Acc 0.00017211355444862918, AUC 0.35900944471359253
Test Epoch9 layer7 Acc 0.21937391163487627, AUC 0.6844467520713806
Test Epoch9 layer8 Acc 0.17760093953752076, AUC 0.41397371888160706
Test Epoch9 layer9 Acc 0.0033207791681853158, AUC 0.30753228068351746
Best AUC 0.978680431842804
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//kdd99/kdd99_linearal_l10_m5.pt
[[56143     0    15     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   18     1 19413    11     0     5     0     8     0     0     0]
 [    0     0     8   433     0     0     0     0     0     0     0]
 [    5     0    34     0   279     0     0     0     0     0     0]
 [    0     0    17     0     0   223     5     5     0     0     0]
 [    0    12     8     0     0     0   188     0     0     0     0]
 [    0     0    44     0     0     0     0   160     0     0     0]
 [    0     0     1     0     1     0     0     0   194     0     0]
 [    5     1     7     0     0    20     0     2    18     0     0]
 [    0    16    10     0     0    21     0     0     0     0     0]]
Figure(640x480)
[[56147     0    11     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   18     1 19411     9     0     4     0    13     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    5     0    26     0   287     0     0     0     0     0     0]
 [    0     0    11     0     0   228     5     6     0     0     0]
 [    0     7     8     0     0     0   193     0     0     0     0]
 [    0     0    29     0     0     0     0   175     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    3     0     8     0     2    19     0     2    19     0     0]
 [    0     1    10     0     0    21    15     0     0     0     0]]
Figure(640x480)
[[56150     0     8     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     0 19411     9     0     6     0    13     0     0     0]
 [    0     0    11   430     0     0     0     0     0     0     0]
 [    5     0    25     0   288     0     0     0     0     0     0]
 [    0     0    17     0     0   222     5     6     0     0     0]
 [    0     7     8     0     0     0   193     0     0     0     0]
 [    0     0    29     0     0     0     0   175     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    3     1     4     0     0    19     0     2    24     0     0]
 [    0     0    13     0     0    18    16     0     0     0     0]]
Figure(640x480)
[[56151     0     7     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     0 19412     8     0     6     0    13     0     0     0]
 [    0     0    11   430     0     0     0     0     0     0     0]
 [    5     0    23     0   290     0     0     0     0     0     0]
 [    0     0    17     0     0   222     5     6     0     0     0]
 [    0     7     9     0     0     0   192     0     0     0     0]
 [    0     0    29     0     0     0     0   175     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    0     0     5     0     0    20     0     2    26     0     0]
 [    0     0    16     0     0    15    16     0     0     0     0]]
Figure(640x480)
[[56148     0    10     0     0     0     0     0     0     0     0]
 [    0 21438     3     0     0     0     0     0     0     0     0]
 [   17     0 19422     8     0     5     0     4     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    7     0    31     0   280     0     0     0     0     0     0]
 [    0     0    25     0     0   224     1     0     0     0     0]
 [    0    11    14     0     0     0   183     0     0     0     0]
 [    0     0    79     1     0     0     0   124     0     0     0]
 [    0     0     2     0     1     0     0     0   193     0     0]
 [    1     2    29     0     0    21     0     0     0     0     0]
 [    0    15    31     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56145     0     0     0     0    13     0     0     0     0     0]
 [    0     0     0     0 21249    11     0     0   181     0     0]
 [   28     1     0     0     0 19426     0     0     1     0     0]
 [  423     0     0     0     0    18     0     0     0     0     0]
 [    5     0     0     0    15    39     0   259     0     0     0]
 [  172     0     0     0     0    78     0     0     0     0     0]
 [    0     0     0     0   186    22     0     0     0     0     0]
 [  131    23     0     0     0    50     0     0     0     0     0]
 [   56     0     0     0     0    67     0     0    73     0     0]
 [   11     0     0     0     0    42     0     0     0     0     0]
 [    0     0     0     0     0    47     0     0     0     0     0]]
Figure(640x480)
[[    0     9     0     0     0 56062    11     0    76     0     0]
 [    0     2   314     0     0     0 21125     0     0     0     0]
 [    2 19005   421     0    10     2    12     0     4     0     0]
 [    0    16     0     0   425     0     0     0     0     0     0]
 [    0    21   279     0     0     0    16     0     2     0     0]
 [    0    18   232     0     0     0     0     0     0     0     0]
 [    0   182     4     0     0     0    22     0     0     0     0]
 [   12   167     4     0     5     0    16     0     0     0     0]
 [  117     0    79     0     0     0     0     0     0     0     0]
 [    1     2    50     0     0     0     0     0     0     0     0]
 [    0     7    40     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0 56095     0     0     0     0    63     0     0     0     0]
 [    0  4070     0     0 16975     0   396     0     0     0     0]
 [    0    11     0     0     5     0 19431     9     0     0     0]
 [    0   425     0     0     0     0    16     0     0     0     0]
 [    0   229     0     0     0     0    89     0     0     0     0]
 [    0     0     0     0     0     0   201    49     0     0     0]
 [    0    57     0     0     0     0   151     0     0     0     0]
 [    0     0     0     0     0     0    98   106     0     0     0]
 [    0     0     0     0     0     0   196     0     0     0     0]
 [    0     1     0     0     0     0    52     0     0     0     0]
 [    0     0     0     0     0     0    47     0     0     0     0]]
Figure(640x480)
[[    0 56138     0     0    18     2     0     0     0     0     0]
 [    0     1     0 21421    19     0     0     0     0     0     0]
 [    0    21     0     0 19435     0     0     0     0     0     0]
 [    0   426     0     0    15     0     0     0     0     0     0]
 [  273     6     0     0    39     0     0     0     0     0     0]
 [    0     5     0     0   245     0     0     0     0     0     0]
 [    0   118     0    16    13    11     0    50     0     0     0]
 [    0     0     2     0   202     0     0     0     0     0     0]
 [    0     0     0     0   196     0     0     0     0     0     0]
 [    0     1     0     0    52     0     0     0     0     0     0]
 [    0     0     0     0    47     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0     5     0 56153     0     0     0     0     0     0]
 [    0     0     5 21436     0     0     0     0     0     0     0]
 [    0   146  4581     2   377     6 14344     0     0     0     0]
 [    0   432     1     0     6     0     2     0     0     0     0]
 [    0     0     1     0   315     0     2     0     0     0     0]
 [    0     0    48     0   199     0     3     0     0     0     0]
 [    0     0     0    26   179     0     3     0     0     0     0]
 [    0   184     0     0    13     0     7     0     0     0     0]
 [    0     0     0     0   196     0     0     0     0     0     0]
 [    0     0     0     0    51     0     2     0     0     0     0]
 [    0     0    24    15     3     0     5     0     0     0     0]]
Figure(640x480)
