Load ckpt from ./ckpt/mask2//kdd99/kdd99_linearal_l10_m2.pt
layer_mask {0, 1, 2}
Start Training
gc 9
[[4.76600535e+03 3.41084240e+00]
 [3.24776309e-03 2.68854969e+00]
 [3.05682629e+01 3.24345649e+01]
 [1.42639872e+03 1.00841019e+03]
 [1.14192672e+03 9.00470740e+02]
 [7.10122883e+02 6.40139476e+02]
 [7.10951305e+02 5.79496721e+02]
 [6.77708119e+02 6.09815174e+02]
 [6.96990579e+02 5.33549866e+02]
 [6.75626652e+02 4.83399582e+02]]
Train Epoch0 Acc 0.02044447819373782 (8077/395070), AUC 0.4719924032688141
Test Epoch0 layer0 Acc 0.9965881018912243, AUC 0.9898404479026794
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l10_m3.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9970943182278379, AUC 0.9450104236602783
Test Epoch0 layer2 Acc 0.9960515125744138, AUC 0.9932777285575867
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l10_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.5731077633337383, AUC 0.382304847240448
Test Epoch0 layer4 Acc 0.0019134977523994653, AUC 0.3285669684410095
Test Epoch0 layer5 Acc 0.004373709148341635, AUC 0.5835983157157898
Test Epoch0 layer6 Acc 0.002936054752358968, AUC 0.37430623173713684
Test Epoch0 layer7 Acc 0.004029482039444377, AUC 0.7114635109901428
Test Epoch0 layer8 Acc 0.0010731786336208643, AUC 0.7935060858726501
Test Epoch0 layer9 Acc 0.0014579030494472117, AUC 0.42771634459495544
gc 0
[[4.76600529e+03 3.24403148e+00]
 [4.78056500e-04 2.39284484e+00]
 [1.13405722e-01 2.90839508e+00]
 [1.45503881e+03 1.02757011e+03]
 [1.16630498e+03 9.26180022e+02]
 [7.23475352e+02 6.58319266e+02]
 [7.24337044e+02 6.00989010e+02]
 [6.88401161e+02 6.17840233e+02]
 [7.15500863e+02 5.49658770e+02]
 [6.89285490e+02 4.95231583e+02]]
Train Epoch1 Acc 0.0013946895486875743 (551/395070), AUC 0.395536333322525
Test Epoch1 layer0 Acc 0.996952577653586, AUC 0.9835657477378845
Test Epoch1 layer1 Acc 0.9973271777426801, AUC 0.9422752857208252
Test Epoch1 layer2 Acc 0.9972056858218928, AUC 0.9870582222938538
Test Epoch1 layer3 Acc 0.5710019033734257, AUC 0.2981530725955963
Test Epoch1 layer4 Acc 0.0018426274652735594, AUC 0.316967248916626
Test Epoch1 layer5 Acc 0.004312963187948001, AUC 0.6281721591949463
Test Epoch1 layer6 Acc 0.0022577248612967236, AUC 0.3721209764480591
Test Epoch1 layer7 Acc 0.0802049163730612, AUC 0.7526531219482422
Test Epoch1 layer8 Acc 0.0010731786336208643, AUC 0.8085323572158813
Test Epoch1 layer9 Acc 0.0013262868019276717, AUC 0.39896640181541443
gc 0
[[4.76600527e+03 3.09365514e+00]
 [4.42324334e-04 2.19656799e+00]
 [2.43088223e-02 2.05811978e+00]
 [1.46803739e+03 1.03894555e+03]
 [1.17939770e+03 9.45099013e+02]
 [7.30512261e+02 6.65781547e+02]
 [7.29301649e+02 6.08636794e+02]
 [6.89609701e+02 6.13558066e+02]
 [7.21852541e+02 5.48795412e+02]
 [6.89027768e+02 4.96874396e+02]]
Train Epoch2 Acc 0.0013491280026324448 (533/395070), AUC 0.401561439037323
Test Epoch2 layer0 Acc 0.9969120803466569, AUC 0.9765565395355225
Test Epoch2 layer1 Acc 0.9972968047624833, AUC 0.9398044943809509
Test Epoch2 layer2 Acc 0.9972563074555542, AUC 0.9649932384490967
Test Epoch2 layer3 Acc 0.5696249949378366, AUC 0.2783835530281067
Test Epoch2 layer4 Acc 0.0018932490989349209, AUC 0.31948456168174744
Test Epoch2 layer5 Acc 0.005021666059207063, AUC 0.6353062391281128
Test Epoch2 layer6 Acc 0.002267849188028996, AUC 0.37543344497680664
Test Epoch2 layer7 Acc 0.17300449520106914, AUC 0.6837707757949829
Test Epoch2 layer8 Acc 0.002166605920706273, AUC 0.803148627281189
Test Epoch2 layer9 Acc 0.0011744219009435872, AUC 0.40066173672676086
gc 0
[[4.76600525e+03 2.96948729e+00]
 [4.40755718e-04 2.04502483e+00]
 [4.38555582e-03 1.76615223e+00]
 [1.46819263e+03 1.04662505e+03]
 [1.18181046e+03 9.52044333e+02]
 [7.30785338e+02 6.69043825e+02]
 [7.32629042e+02 6.06901381e+02]
 [6.88460989e+02 6.07528857e+02]
 [7.24577781e+02 5.43514290e+02]
 [6.87411587e+02 4.93293100e+02]]
Train Epoch3 Acc 0.0012807856835497507 (506/395070), AUC 0.40190935134887695
Test Epoch3 layer0 Acc 0.9970943182278379, AUC 0.976786196231842
Test Epoch3 layer1 Acc 0.9974284210100028, AUC 0.9555341601371765
Test Epoch3 layer2 Acc 0.9973474263961447, AUC 0.9634416103363037
Test Epoch3 layer3 Acc 0.5697768598388208, AUC 0.23825281858444214
Test Epoch3 layer4 Acc 0.0019539950593285547, AUC 0.32369381189346313
Test Epoch3 layer5 Acc 0.0058923581581824805, AUC 0.6332268118858337
Test Epoch3 layer6 Acc 0.002308346494958085, AUC 0.3803391456604004
Test Epoch3 layer7 Acc 0.17093913254768558, AUC 0.6967338919639587
Test Epoch3 layer8 Acc 0.0034726440691694002, AUC 0.8059663772583008
Test Epoch3 layer9 Acc 0.0011744219009435872, AUC 0.39770013093948364
gc 0
[[4.76600523e+03 2.86305931e+00]
 [4.47350561e-04 1.92507521e+00]
 [1.07424279e-03 1.60186575e+00]
 [1.46852332e+03 1.05227293e+03]
 [1.18372950e+03 9.54349175e+02]
 [7.30354729e+02 6.72646193e+02]
 [7.33229175e+02 6.03851762e+02]
 [6.88925449e+02 6.04334341e+02]
 [7.25083945e+02 5.38192170e+02]
 [6.87142539e+02 4.90492474e+02]]
Train Epoch4 Acc 0.0011036018933353582 (436/395070), AUC 0.39782965183258057
Test Epoch4 layer0 Acc 0.9970639452476411, AUC 0.963879406452179
Test Epoch4 layer1 Acc 0.997468918316932, AUC 0.9386651515960693
Test Epoch4 layer2 Acc 0.9973575507228769, AUC 0.9411874413490295
Test Epoch4 layer3 Acc 0.5697566111853561, AUC 0.202412948012352
Test Epoch4 layer4 Acc 0.0020147410197221883, AUC 0.32645222544670105
Test Epoch4 layer5 Acc 0.006054347385898838, AUC 0.6421170830726624
Test Epoch4 layer6 Acc 0.00219697890090309, AUC 0.382114440202713
Test Epoch4 layer7 Acc 0.16111853561738143, AUC 0.7090293169021606
Test Epoch4 layer8 Acc 0.0034827683959016724, AUC 0.8595002889633179
Test Epoch4 layer9 Acc 0.00045559470295225367, AUC 0.3937353789806366
gc 0
[[4.76600522e+03 2.74732535e+00]
 [4.54542933e-04 1.81902147e+00]
 [2.91950267e-04 1.46875196e+00]
 [1.46961404e+03 1.05754889e+03]
 [1.18466633e+03 9.56506756e+02]
 [7.30387765e+02 6.75632527e+02]
 [7.33346424e+02 6.01857413e+02]
 [6.89258680e+02 6.01990537e+02]
 [7.25402269e+02 5.35999468e+02]
 [6.87215399e+02 4.89033938e+02]]
Train Epoch5 Acc 0.0004935834155972359 (195/395070), AUC 0.3968255817890167
Test Epoch5 layer0 Acc 0.997175312841696, AUC 0.968746542930603
Test Epoch5 layer1 Acc 0.9976005345644514, AUC 0.9533876776695251
Test Epoch5 layer2 Acc 0.9974385453367351, AUC 0.9595499038696289
Test Epoch5 layer3 Acc 0.5698781031061434, AUC 0.1904456615447998
Test Epoch5 layer4 Acc 0.0020147410197221883, AUC 0.32740429043769836
Test Epoch5 layer5 Acc 0.005973352772040659, AUC 0.6401146054267883
Test Epoch5 layer6 Acc 0.0022172275543676347, AUC 0.38408365845680237
Test Epoch5 layer7 Acc 0.15177378204349412, AUC 0.712744414806366
Test Epoch5 layer8 Acc 0.003503017049366217, AUC 0.8562080264091492
Test Epoch5 layer9 Acc 0.00040497306929089213, AUC 0.3944395184516907
gc 0
[[4.76600522e+03 2.69295077e+00]
 [4.13295196e-04 1.74266788e+00]
 [3.09597663e-04 1.40235683e+00]
 [1.47089154e+03 1.06205780e+03]
 [1.18548580e+03 9.59337600e+02]
 [7.30471779e+02 6.78228078e+02]
 [7.33481700e+02 5.99579183e+02]
 [6.89456022e+02 6.00498819e+02]
 [7.25511408e+02 5.35148277e+02]
 [6.87262355e+02 4.87589791e+02]]
Train Epoch6 Acc 0.000453084263548232 (179/395070), AUC 0.3966207802295685
Test Epoch6 layer0 Acc 0.9972158101486251, AUC 0.9679461121559143
Test Epoch6 layer1 Acc 0.9976005345644514, AUC 0.950665295124054
Test Epoch6 layer2 Acc 0.997620783217916, AUC 0.9596372842788696
Test Epoch6 layer3 Acc 0.5699186004130725, AUC 0.17998260259628296
Test Epoch6 layer4 Acc 0.0020754869801158224, AUC 0.32723191380500793
Test Epoch6 layer5 Acc 0.006054347385898838, AUC 0.6415099501609802
Test Epoch6 layer6 Acc 0.0021767302474385453, AUC 0.3890231251716614
Test Epoch6 layer7 Acc 0.0751933746405864, AUC 0.712958574295044
Test Epoch6 layer8 Acc 0.003492892722633945, AUC 0.8648577332496643
Test Epoch6 layer9 Acc 0.0002936054752358968, AUC 0.39086607098579407
gc 0
[[4.76600522e+03 2.64225180e+00]
 [4.60645959e-04 1.67878359e+00]
 [3.44702232e-04 1.34812857e+00]
 [1.47197527e+03 1.06670965e+03]
 [1.18609958e+03 9.61513600e+02]
 [7.30531473e+02 6.81452402e+02]
 [7.33581104e+02 5.98962450e+02]
 [6.89618915e+02 6.00423001e+02]
 [7.25522550e+02 5.35507484e+02]
 [6.87286768e+02 4.87377708e+02]]
Train Epoch7 Acc 0.000392335535474726 (155/395070), AUC 0.3918652832508087
Test Epoch7 layer0 Acc 0.997286680435751, AUC 0.9680125713348389
Test Epoch7 layer1 Acc 0.9978131454258292, AUC 0.9612188339233398
Test Epoch7 layer2 Acc 0.9977523994654356, AUC 0.9591214656829834
Test Epoch7 layer3 Acc 0.5700907139675212, AUC 0.18038977682590485
Test Epoch7 layer4 Acc 0.00206536265338355, AUC 0.3326006233692169
Test Epoch7 layer5 Acc 0.006023974405702021, AUC 0.6435774564743042
Test Epoch7 layer6 Acc 0.00219697890090309, AUC 0.38874340057373047
Test Epoch7 layer7 Acc 0.05202891507714737, AUC 0.7113035917282104
Test Epoch7 layer8 Acc 0.0035232657028307617, AUC 0.8717767596244812
Test Epoch7 layer9 Acc 0.0003037298019681691, AUC 0.38689708709716797
gc 0
[[4.76600522e+03 2.60342101e+00]
 [4.37028024e-04 1.62559561e+00]
 [3.31311653e-04 1.30034661e+00]
 [1.47283963e+03 1.07447022e+03]
 [1.18650688e+03 9.63937006e+02]
 [7.30544610e+02 6.85740907e+02]
 [7.33648174e+02 5.97714949e+02]
 [6.89747395e+02 5.99969276e+02]
 [7.25471670e+02 5.35498819e+02]
 [6.87287721e+02 4.86419595e+02]]
Train Epoch8 Acc 0.0003594299744349103 (142/395070), AUC 0.38698673248291016
Test Epoch8 layer0 Acc 0.9973069290892156, AUC 0.9686823487281799
Test Epoch8 layer1 Acc 0.9976410318713805, AUC 0.9734209179878235
Test Epoch8 layer2 Acc 0.997620783217916, AUC 0.965143620967865
Test Epoch8 layer3 Acc 0.5701413356011825, AUC 0.18077421188354492
Test Epoch8 layer4 Acc 0.0020552383266512777, AUC 0.33725643157958984
Test Epoch8 layer5 Acc 0.006145466326489288, AUC 0.6424018144607544
Test Epoch8 layer6 Acc 0.0021868545741708175, AUC 0.3961259126663208
Test Epoch8 layer7 Acc 0.04845502774065524, AUC 0.7099273800849915
Test Epoch8 layer8 Acc 0.003492892722633945, AUC 0.8750906586647034
Test Epoch8 layer9 Acc 0.0002733568217713522, AUC 0.37986886501312256
gc 0
[[4.76600522e+03 2.55768766e+00]
 [4.34377025e-04 1.57768159e+00]
 [1.58197131e-04 1.25537923e+00]
 [1.47341289e+03 1.07961537e+03]
 [1.18670244e+03 9.66408677e+02]
 [7.30483467e+02 6.89064147e+02]
 [7.33658689e+02 5.97504564e+02]
 [6.89822881e+02 6.00337771e+02]
 [7.25377016e+02 5.35899387e+02]
 [6.87243911e+02 4.86445983e+02]]
Train Epoch9 Acc 0.0003366492014073455 (133/395070), AUC 0.3820105493068695
Test Epoch9 layer0 Acc 0.9973271777426801, AUC 0.9656686186790466
Test Epoch9 layer1 Acc 0.9976612805248452, AUC 0.9666613936424255
Test Epoch9 layer2 Acc 0.9976410318713805, AUC 0.9632507562637329
Test Epoch9 layer3 Acc 0.570121086947718, AUC 0.181446373462677
Test Epoch9 layer4 Acc 0.002095735633580367, AUC 0.3390878140926361
Test Epoch9 layer5 Acc 0.006125217673024744, AUC 0.6420115828514099
Test Epoch9 layer6 Acc 0.0021868545741708175, AUC 0.4280010461807251
Test Epoch9 layer7 Acc 0.0436459725428259, AUC 0.7100691199302673
Test Epoch9 layer8 Acc 0.003391649455311222, AUC 0.8748683333396912
Test Epoch9 layer9 Acc 0.0002531081683068076, AUC 0.37754762172698975
Best AUC 0.9932777285575867
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//kdd99/kdd99_linearal_l10_m3.pt
[[56145     0    13     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     1 19413    11     0     6     0     8     0     0     0]
 [    0     0    10   431     0     0     0     0     0     0     0]
 [    5     0    35     0   278     0     0     0     0     0     0]
 [    0     0    20     0     0   221     5     4     0     0     0]
 [    0    14     9     0     0     0   185     0     0     0     0]
 [    0     0    74     0     0     0     0   130     0     0     0]
 [    0     0     2     0     1     0     0     0   193     0     0]
 [    4     2    10     0     0    21     0     1    15     0     0]
 [    0    18    10     0     0    19     0     0     0     0     0]]
Figure(640x480)
[[56146     0    12     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   18     1 19412    10     0     5     0    10     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    5     0    29     0   284     0     0     0     0     0     0]
 [    0     0    18     0     0   221     5     6     0     0     0]
 [    0    10     9     0     0     0   189     0     0     0     0]
 [    0     0    40     0     0     0     0   164     0     0     0]
 [    0     0     0     0     1     0     0     0   195     0     0]
 [    3     0     4     0     0    20     0     1    25     0     0]
 [    0    17    12     0     0    18     0     0     0     0     0]]
Figure(640x480)
[[56148     0    10     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     3 19430     9     0     6     0     2     0     0     0]
 [    0     0    15   426     0     0     0     0     0     0     0]
 [    5     0    34     0   279     0     0     0     0     0     0]
 [    0     0    30     0     0   220     0     0     0     0     0]
 [    0    21    19     0     0     0   168     0     0     0     0]
 [    0     0   121     4     0     3     0    76     0     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    1     0     5     0     0    23     0     0    24     0     0]
 [    0    16    31     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56157     0     0     1     0     0     0     0     0     0     0]
 [    1     5 21389    46     0     0     0     0     0     0     0]
 [19278   128     4    26     0    20     0     0     0     0     0]
 [    2     3     0   436     0     0     0     0     0     0     0]
 [   35     3   279     0     0     0     1     0     0     0     0]
 [   22   223     0     0     0     5     0     0     0     0     0]
 [    7     0    36    23     0   142     0     0     0     0     0]
 [  192     9     2     1     0     0     0     0     0     0     0]
 [    0   157     0     0     0    39     0     0     0     0     0]
 [    2    49     0     0     0     2     0     0     0     0     0]
 [    8    39     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0 54500     0     0     0     0     0     0  1658     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 2442     1     0   496     5   635  5188     0 10689     0     0]
 [    0     0     0     0   290     0     0     0   151     0     0]
 [   31     0     0     0     0     0   273     0    14     0     0]
 [    0     0     0     0     0     0   247     0     3     0     0]
 [    1     3     0     0     0     0   189     0    15     0     0]
 [    0     0     0     0     0     2   182     0    20     0     0]
 [    0     0     0     0     0     0   196     0     0     0     0]
 [    0     0     0     0     0     0    51     0     2     0     0]
 [    1    15     0     1     0     0    24     0     6     0     0]]
Figure(640x480)
[[   22     0 56125     0     0     0    11     0     0     0     0]
 [    2     7     0     0     0     1     0     0 21431     0     0]
 [18488   853     5     0     4    19     0     0    87     0     0]
 [    3   100     0     0     0     9     0     0   329     0     0]
 [  316     0     2     0     0     0     0     0     0     0     0]
 [   32    16     0     0     0   202     0     0     0     0     0]
 [  109     4    64     0     0    10     0     0    21     0     0]
 [  127     0     1     0     0    13     0     0    63     0     0]
 [    0     0     0     0     0     0     0     0   196     0     0]
 [    9     1     0     0     0    18     0     0    25     0     0]
 [   42     0     0     0     0     5     0     0     0     0     0]]
Figure(640x480)
[[    0   106     0     0     0     0     3     0 56049     0     0]
 [ 3694     0 17353     0     0     0   394     0     0     0     0]
 [ 1896   774   176     0     0     0 16608     0     2     0     0]
 [    0   439     0     0     0     0     2     0     0     0     0]
 [    0    11    35     0     0     0   272     0     0     0     0]
 [  240     9     0     0     0     0     1     0     0     0     0]
 [    0    90     4     0     0     0   114     0     0     0     0]
 [  193     2     0     0     0     0     9     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   51     2     0     0     0     0     0     0     0     0     0]
 [   22     6    18     0     0     0     1     0     0     0     0]]
Figure(640x480)
[[    0     0     0     0     0     0 56158     0     0     0     0]
 [    0     0     0     0     0     0 21441     0     0     0     0]
 [    0     0   190     0     1     0 19265     0     0     0     0]
 [    0     0     0     0     0     0   441     0     0     0     0]
 [    0     0     0     0     0     0   318     0     0     0     0]
 [    0     0     0     0     0     0   250     0     0     0     0]
 [    0     0     0     0     0     0   208     0     0     0     0]
 [    0     0     0     0     0     0   204     0     0     0     0]
 [    0     0     0     0     0     0   196     0     0     0     0]
 [    0     0     0     0     0     0    53     0     0     0     0]
 [    0     0     0     0     0     0    47     0     0     0     0]]
Figure(640x480)
[[    0     0 56115     0    43     0     0     0     0     0     0]
 [ 2098     0     0     0 19303     0    40     0     0     0     0]
 [   11     2     7     0 19432     0     4     0     0     0     0]
 [   43   376     3     0    15     0     4     0     0     0     0]
 [  223     0     0     0    95     0     0     0     0     0     0]
 [   11     0    33     0   206     0     0     0     0     0     0]
 [   12     0     0     0   196     0     0     0     0     0     0]
 [    0     0     7     0   191     0     2     4     0     0     0]
 [    0     0     0     0     0     0     0   196     0     0     0]
 [    0     0     0     0    25     0     0    28     0     0     0]
 [    0     0     0     0    47     0     0     0     0     0     0]]
Figure(640x480)
[[   17     0    54     0 56087     0     0     0     0     0     0]
 [    0     0 21197     0     3     0   241     0     0     0     0]
 [18454     9   105     0    12     2   874     0     0     0     0]
 [  411     0    28     0     2     0     0     0     0     0     0]
 [   56     0   262     0     0     0     0     0     0     0     0]
 [   26     0   182     0    23    19     0     0     0     0     0]
 [    5     0   200     0     0     0     3     0     0     0     0]
 [  125    34     0     0    22     0    23     0     0     0     0]
 [    3     0   193     0     0     0     0     0     0     0     0]
 [   27     0    26     0     0     0     0     0     0     0     0]
 [   29     0     0     0    16     0     2     0     0     0     0]]
Figure(640x480)
