Load ckpt from ./ckpt/mask1//kdd99/kdd99_linearalside_l5_m1.pt
layer_mask {1}
Start Training
gc 9
[[4766.00539148  331.81078932]
 [  38.96598287  249.49819095]
 [1449.45341995  842.48180225]
 [ 941.95975465  649.47968389]
 [ 663.0386546   642.82301913]]
Train Epoch0 Acc 0.05020376135874655 (19834/395070), AUC 0.7254027724266052
Test Epoch0 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch0 layer1 Acc 0.7258838537237273, AUC 0.7505201101303101
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearalside_l5_m2.pt  ,ep 0
Test Epoch0 layer2 Acc 0.04266391284979549, AUC 0.6772201061248779
Test Epoch0 layer3 Acc 0.0056898716235370345, AUC 0.2984600365161896
Test Epoch0 layer4 Acc 0.028621471672133802, AUC 0.7213088274002075
gc 0
[[4.76600539e+03 3.31826843e+02]
 [1.86739937e-01 2.38481998e+02]
 [1.48001596e+03 8.51015896e+02]
 [9.43782899e+02 6.49432881e+02]
 [6.67275748e+02 6.48726338e+02]]
Train Epoch1 Acc 0.023955248436985852 (9464/395070), AUC 0.7230281829833984
Test Epoch1 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch1 layer1 Acc 0.7264710646741992, AUC 0.7279786467552185
Test Epoch1 layer2 Acc 0.042785404770582756, AUC 0.6729209423065186
Test Epoch1 layer3 Acc 0.00580123921759203, AUC 0.3031992018222809
Test Epoch1 layer4 Acc 0.023093589276313126, AUC 0.7049071788787842
gc 0
[[4.76600539e+03 3.31822537e+02]
 [2.98881074e-02 2.36254765e+02]
 [1.49182795e+03 8.46130598e+02]
 [9.44453762e+02 6.46893752e+02]
 [6.72223215e+02 6.46928052e+02]]
Train Epoch2 Acc 0.021960665198572406 (8676/395070), AUC 0.6939602494239807
Test Epoch2 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch2 layer1 Acc 0.7264406916940024, AUC 0.7882713675498962
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearalside_l5_m2.pt  ,ep 2
Test Epoch2 layer2 Acc 0.04279552909731503, AUC 0.6738326549530029
Test Epoch2 layer3 Acc 0.00580123921759203, AUC 0.30801665782928467
Test Epoch2 layer4 Acc 0.021058599603126393, AUC 0.6682170629501343
gc 0
[[4.76600539e+03 3.31820772e+02]
 [4.92542653e-03 2.34972993e+02]
 [1.50048345e+03 8.38354740e+02]
 [9.42491954e+02 6.42548518e+02]
 [6.74222947e+02 6.42312890e+02]]
Train Epoch3 Acc 0.020434353405725567 (8073/395070), AUC 0.678688108921051
Test Epoch3 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch3 layer1 Acc 0.7268152917830965, AUC 0.7875137329101562
Test Epoch3 layer2 Acc 0.042785404770582756, AUC 0.7192442417144775
Test Epoch3 layer3 Acc 0.005699995950269307, AUC 0.3102002441883087
Test Epoch3 layer4 Acc 0.020552383266512778, AUC 0.6737884879112244
gc 0
[[4.76600539e+03 3.31815661e+02]
 [7.64187811e-04 2.34545082e+02]
 [1.49996878e+03 8.30524588e+02]
 [9.38909531e+02 6.36164352e+02]
 [6.73365441e+02 6.36872545e+02]]
Train Epoch4 Acc 0.0207583466221176 (8201/395070), AUC 0.6915419101715088
Test Epoch4 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch4 layer1 Acc 0.7267140485157737, AUC 0.7890546321868896
Save ckpt to ./ckpt/mask2//kdd99/kdd99_linearalside_l5_m2.pt  ,ep 4
Test Epoch4 layer2 Acc 0.04279552909731503, AUC 0.7256888747215271
Test Epoch4 layer3 Acc 0.0032094115741303202, AUC 0.30650389194488525
Test Epoch4 layer4 Acc 0.021210464504110477, AUC 0.6904259920120239
gc 0
[[4.76600539e+03 3.31811831e+02]
 [4.08730579e-04 2.34294327e+02]
 [1.49887123e+03 8.25089621e+02]
 [9.38007836e+02 6.31264210e+02]
 [6.72967133e+02 6.32797027e+02]]
Train Epoch5 Acc 0.022312501581998125 (8815/395070), AUC 0.6993327736854553
Test Epoch5 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch5 layer1 Acc 0.7267849188028996, AUC 0.7816709280014038
Test Epoch5 layer2 Acc 0.04277528044385048, AUC 0.7319580316543579
Test Epoch5 layer3 Acc 0.0028145628315717004, AUC 0.30417415499687195
Test Epoch5 layer4 Acc 0.02368080022678492, AUC 0.6939160227775574
gc 0
[[4.76600539e+03 3.31820846e+02]
 [4.12839700e-04 2.34058048e+02]
 [1.49790429e+03 8.21254341e+02]
 [9.37800954e+02 6.27820108e+02]
 [6.72764097e+02 6.28920148e+02]]
Train Epoch6 Acc 0.02476523147796593 (9784/395070), AUC 0.7031255960464478
Test Epoch6 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch6 layer1 Acc 0.7262685781395537, AUC 0.7829533219337463
Test Epoch6 layer2 Acc 0.04277528044385048, AUC 0.7367969751358032
Test Epoch6 layer3 Acc 0.0026222006236585266, AUC 0.30562758445739746
Test Epoch6 layer4 Acc 0.026120762969262544, AUC 0.6965557336807251
gc 0
[[4.76600539e+03 3.31833945e+02]
 [3.95658015e-04 2.33686026e+02]
 [1.49691264e+03 8.19581531e+02]
 [9.37642675e+02 6.26554475e+02]
 [6.72565042e+02 6.26486862e+02]]
Train Epoch7 Acc 0.027919102943782116 (11030/395070), AUC 0.6896202564239502
Test Epoch7 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch7 layer1 Acc 0.7268659134167578, AUC 0.7802543640136719
Test Epoch7 layer2 Acc 0.04277528044385048, AUC 0.7284181118011475
Test Epoch7 layer3 Acc 0.002571578989997165, AUC 0.30218660831451416
Test Epoch7 layer4 Acc 0.02958328271169967, AUC 0.6778526306152344
gc 0
[[4.76600539e+03 3.31821692e+02]
 [4.05939879e-04 2.33179230e+02]
 [1.49586160e+03 8.18906554e+02]
 [9.37432912e+02 6.27530326e+02]
 [6.72333697e+02 6.25615009e+02]]
Train Epoch8 Acc 0.031298250942870885 (12365/395070), AUC 0.6880007982254028
Test Epoch8 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch8 layer1 Acc 0.7268760377434901, AUC 0.7320220470428467
Test Epoch8 layer2 Acc 0.04277528044385048, AUC 0.7351768016815186
Test Epoch8 layer3 Acc 0.002561454663264893, AUC 0.30319446325302124
Test Epoch8 layer4 Acc 0.03299518082047544, AUC 0.6800113320350647
gc 0
[[4.76600539e+03 3.31821579e+02]
 [6.64624253e-05 2.32539406e+02]
 [1.49538531e+03 8.19301741e+02]
 [9.37347940e+02 6.29805072e+02]
 [6.72245108e+02 6.26016816e+02]]
Train Epoch9 Acc 0.033852228718961194 (13374/395070), AUC 0.6914874315261841
Test Epoch9 layer0 Acc 0.6767099987850808, AUC 0.7423868775367737
Test Epoch9 layer1 Acc 0.7269367837038837, AUC 0.7310182452201843
Test Epoch9 layer2 Acc 0.04277528044385048, AUC 0.7771310210227966
Test Epoch9 layer3 Acc 0.002561454663264893, AUC 0.3043079078197479
Test Epoch9 layer4 Acc 0.034726440691694005, AUC 0.6830338835716248
Best AUC 0.7890546321868896
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask2//kdd99/kdd99_linearalside_l5_m2.pt
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 9398     0  9988    65     0     0     0     5     0     0     0]
 [    1     0    12   428     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  194     0    13     0     0     0     1     0     0     0     0]
 [  125     0     5     2     0     0     0    72     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [ 4498     0 14917    33     0     0     0     8     0     0     0]
 [    0     0     4   437     0     0     0     0     0     0     0]
 [  317     0     1     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  194     0    14     0     0     0     0     0     0     0     0]
 [    0     0   130     0     0     0     0    74     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0     0     0     0     0    22 56136     0     0     0]
 [    0  4077     0     0     0     0 17363     1     0     0     0]
 [   14  1104     2     0     0    26  3264 15033    13     0     0]
 [    0     0     0     0     0   438     0     3     0     0     0]
 [    0   235     0     0     0     1    80     2     0     0     0]
 [    0    24     0     0     0     0   226     0     0     0     0]
 [    0   187     0     0     0    14     7     0     0     0     0]
 [    0    63     0     0     0     0     0   141     0     0     0]
 [    0     0     0     0    58     0     0   138     0     0     0]
 [    0     0     0     0     0     0     2    51     0     0     0]
 [    0     0     0     0     0     0    47     0     0     0     0]]
Figure(640x480)
[[    5     0     0     0 56123     0    30     0     0     0     0]
 [    0     0  4098 17316    18     0     0     9     0     0     0]
 [  207     1   147   164 15101    80  2008  1743     5     0     0]
 [    0     0     0    43   379     0    19     0     0     0     0]
 [    4     0     2     0     3     0     5   304     0     0     0]
 [    0     0     0     0   198     0     0    52     0     0     0]
 [   10     0     6     0    14     0     0   176     2     0     0]
 [    6     0     0    61   133     3     1     0     0     0     0]
 [    0     0     0     0     0     0    23    54   119     0     0]
 [    0     0     0     0     8     0     9    10    26     0     0]
 [    0     0     0     0    25     0     1    21     0     0     0]]
Figure(640x480)
[[    0     0    60     0 56098     0     0     0     0     0     0]
 [ 4077     0     1     0  2165     0 15198     0     0     0     0]
 [ 1089    78  1783     1  4652    42  1074 10626   111     0     0]
 [    0     0     0     0   340     0     3    48    50     0     0]
 [  237     0     0     0    78     0     1     0     2     0     0]
 [    0     0     3    18     7   103   103    16     0     0     0]
 [  192     0     1     0    14     0     1     0     0     0     0]
 [    1    61     7     0     2     1     2   130     0     0     0]
 [    0   195     0     0     1     0     0     0     0     0     0]
 [    0    16     2     0     6    23     0     6     0     0     0]
 [    0     0     6     0    19     0    21     1     0     0     0]]
Figure(640x480)
