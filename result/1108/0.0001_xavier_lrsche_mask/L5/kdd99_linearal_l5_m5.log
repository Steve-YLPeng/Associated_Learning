Load ckpt from ./ckpt/mask4//kdd99/kdd99_linearal_l5_m4.pt
layer_mask {4}
Start Training
gc 9
[[4.76841550e+03 3.15022076e+00]
 [5.30532737e-04 1.85337336e+00]
 [2.92071014e-03 1.64720643e+00]
 [8.34430833e-09 1.13827643e+00]
 [1.80622570e+01 1.69848796e+01]]
Train Epoch0 Acc 0.962566127521705 (380281/395070), AUC 0.9348587393760681
Test Epoch0 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch0 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch0 layer2 Acc 0.9959705179605556, AUC 0.9954877495765686
Test Epoch0 layer3 Acc 0.9963754910298465, AUC 0.9955809116363525
Test Epoch0 layer4 Acc 0.9947353500992184, AUC 0.9848379492759705
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt  ,ep 0
gc 0
[[4.76841566e+03 3.15038203e+00]
 [5.30531939e-04 1.85347686e+00]
 [2.92071123e-03 1.64729318e+00]
 [8.34430573e-09 1.13833144e+00]
 [1.06785993e-01 1.56775369e+00]]
Train Epoch1 Acc 0.9959931151441517 (393487/395070), AUC 0.99271559715271
Test Epoch1 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch1 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch1 layer2 Acc 0.9959705179605556, AUC 0.9954877495765686
Test Epoch1 layer3 Acc 0.9963754910298465, AUC 0.9955809116363525
Test Epoch1 layer4 Acc 0.9961223828615398, AUC 0.9943792223930359
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt  ,ep 1
gc 0
[[4.76841614e+03 3.15042882e+00]
 [5.30533129e-04 1.85344188e+00]
 [2.92071864e-03 1.64724542e+00]
 [8.34430788e-09 1.13830613e+00]
 [1.30992575e-02 1.24293794e+00]]
Train Epoch2 Acc 0.996410762649657 (393652/395070), AUC 0.9957643151283264
Test Epoch2 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch2 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch2 layer2 Acc 0.9959705179605556, AUC 0.9954877495765686
Test Epoch2 layer3 Acc 0.9963754910298465, AUC 0.9955809116363525
Test Epoch2 layer4 Acc 0.996355242376382, AUC 0.9957284331321716
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt  ,ep 2
gc 0
[[4.76841578e+03 3.15030080e+00]
 [5.30530957e-04 1.85339319e+00]
 [2.92072411e-03 1.64722723e+00]
 [8.34430567e-09 1.13828204e+00]
 [7.21934412e-04 1.14610922e+00]]
Train Epoch3 Acc 0.9965347913028071 (393701/395070), AUC 0.9959733486175537
Test Epoch3 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch3 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch3 layer2 Acc 0.9959705179605556, AUC 0.9954877495765686
Test Epoch3 layer3 Acc 0.9963754910298465, AUC 0.9955809116363525
Test Epoch3 layer4 Acc 0.9963957396833111, AUC 0.9957097768783569
gc 0
[[4.76841569e+03 3.15024192e+00]
 [5.30533963e-04 1.85336680e+00]
 [2.92071195e-03 1.64721072e+00]
 [8.34432384e-09 1.13827411e+00]
 [2.53414424e-04 1.08740541e+00]]
Train Epoch4 Acc 0.9966537575619511 (393748/395070), AUC 0.995967447757721
Test Epoch4 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch4 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch4 layer2 Acc 0.9959705179605556, AUC 0.9954877495765686
Test Epoch4 layer3 Acc 0.9963754910298465, AUC 0.9955809116363525
Test Epoch4 layer4 Acc 0.9964261126635079, AUC 0.9955606460571289
gc 0
[[4.76841562e+03 3.15027717e+00]
 [5.30543373e-04 1.85338830e+00]
 [2.92071245e-03 1.64722985e+00]
 [8.34438329e-09 1.13829281e+00]
 [2.39852969e-04 1.04516677e+00]]
Train Epoch5 Acc 0.9966967879110031 (393765/395070), AUC 0.9960338473320007
Test Epoch5 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch5 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch5 layer2 Acc 0.9959705179605556, AUC 0.9954877495765686
Test Epoch5 layer3 Acc 0.9963754910298465, AUC 0.9955809116363525
Test Epoch5 layer4 Acc 0.9964261126635079, AUC 0.9954318404197693
gc 0
[[4.76841564e+03 3.15134443e+00]
 [5.30533632e-04 1.85396578e+00]
 [2.92071149e-03 1.64777006e+00]
 [8.34430752e-09 1.13866989e+00]
 [2.54949698e-04 1.01630855e+00]]
Train Epoch6 Acc 0.9967398182600552 (393782/395070), AUC 0.9958757758140564
Test Epoch6 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch6 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch6 layer2 Acc 0.9959705179605556, AUC 0.9954877495765686
Test Epoch6 layer3 Acc 0.9963754910298465, AUC 0.9955809116363525
Test Epoch6 layer4 Acc 0.9964969829506338, AUC 0.9957422614097595
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt  ,ep 6
gc 0
[[4.76841551e+03 3.15056259e+00]
 [5.30528435e-04 1.85345585e+00]
 [2.92070969e-03 1.64728295e+00]
 [8.34427964e-09 1.13832413e+00]
 [3.82305344e-05 9.84119454e-01]]
Train Epoch7 Acc 0.9967676614270888 (393793/395070), AUC 0.9960169196128845
Test Epoch7 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch7 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch7 layer2 Acc 0.9959705179605556, AUC 0.9954877495765686
Test Epoch7 layer3 Acc 0.9963754910298465, AUC 0.9955809116363525
Test Epoch7 layer4 Acc 0.9965273559308306, AUC 0.9958629012107849
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt  ,ep 7
gc 0
[[4.76841550e+03 3.15511179e+00]
 [5.30536246e-04 1.85554280e+00]
 [2.92071049e-03 1.64868567e+00]
 [8.34433443e-09 1.13860860e+00]
 [6.28923401e-05 9.71896143e-01]]
Train Epoch8 Acc 0.9968106917761409 (393810/395070), AUC 0.9959176778793335
Test Epoch8 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch8 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch8 layer2 Acc 0.9959705179605556, AUC 0.9954877495765686
Test Epoch8 layer3 Acc 0.9963754910298465, AUC 0.9955809116363525
Test Epoch8 layer4 Acc 0.9965374802575628, AUC 0.9952753186225891
gc 0
[[4.76841581e+03 3.15131956e+00]
 [5.30529424e-04 1.85425674e+00]
 [2.92071694e-03 1.64801573e+00]
 [8.34431441e-09 1.13901669e+00]
 [6.45153263e-05 9.60014077e-01]]
Train Epoch9 Acc 0.9968208165641532 (393814/395070), AUC 0.9959909319877625
Test Epoch9 layer0 Acc 0.9951504474952416, AUC 0.9945953488349915
Test Epoch9 layer1 Acc 0.9958389017130361, AUC 0.9951388835906982
Test Epoch9 layer2 Acc 0.9959705179605556, AUC 0.9954877495765686
Test Epoch9 layer3 Acc 0.9963754910298465, AUC 0.9955809116363525
Test Epoch9 layer4 Acc 0.9966285991981533, AUC 0.995543897151947
Best AUC 0.9958629012107849
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt
[[56134     0    24     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     5 19417    12     0     9     0     7     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    0     0    43     0   275     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0    30    23     0    25     0   130     0     0     0     0]
 [    0     0   132    10     0     1     0    61     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    1     0    32     0     0    20     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56148     0    10     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     0 19430    10     0     5     0     5     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    33     0     0   217     0     0     0     0     0]
 [    0    24    19     0     0     0   165     0     0     0     0]
 [    0     0   132     4     0     1     0    67     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [   20     3    28     0     0     2     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56150     0     8     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [    6     1 19428    10     0     5     0     6     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0    24    15     0     0     0   169     0     0     0     0]
 [    0     0   128     2     0     0     0    74     0     0     0]
 [    0     0     2     0     1     0     0     0   193     0     0]
 [   18     8    19     0     0     8     0     0     0     0     0]
 [    0    18    28     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     0 19422     8     0     4     0     5     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    35     0   277     0     1     0     0     0     0]
 [    0     0    27     0     0   218     0     5     0     0     0]
 [    0    14    15     0     0     0   179     0     0     0     0]
 [    0     0    96     0     0     0     0   108     0     0     0]
 [    2     0     1     0     0     0     0     0   193     0     0]
 [   27     9    17     0     0     0     0     0     0     0     0]
 [    0    18    26     0     0     3     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     0 19423     8     0     4     0     4     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    35     0   278     0     0     0     0     0     0]
 [    0     0    26     0     0   219     0     5     0     0     0]
 [    0    13    14     0     0     0   181     0     0     0     0]
 [    0     0    86     0     0     0     0   118     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   41     0    12     0     0     0     0     0     0     0     0]
 [    0    18    28     0     0     1     0     0     0     0     0]]
Figure(640x480)
