Load ckpt from ./ckpt/mask4//kdd99/kdd99_linearal_l5_m4.pt
layer_mask {4}
Start Training
gc 9
[[4.76678204e+03 3.06291119e+00]
 [4.52005085e-02 1.31424246e+00]
 [1.80396256e-02 7.03273229e-01]
 [2.10715021e-04 6.29035910e-01]
 [1.03123147e+00 1.51448915e+00]]
Train Epoch0 Acc 0.9957475890348546 (393390/395070), AUC 0.9857985973358154
Test Epoch0 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch0 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch0 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch0 layer3 Acc 0.9974992912971288, AUC 0.992022693157196
Test Epoch0 layer4 Acc 0.9974284210100028, AUC 0.9915624260902405
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt  ,ep 0
gc 0
[[4.76678216e+03 3.06297657e+00]
 [4.52001896e-02 1.31426369e+00]
 [1.80406602e-02 7.03291889e-01]
 [2.10728302e-04 6.29061108e-01]
 [4.25941449e-03 5.73305682e-01]]
Train Epoch1 Acc 0.9977978586073354 (394200/395070), AUC 0.9921974539756775
Test Epoch1 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch1 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch1 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch1 layer3 Acc 0.9974992912971288, AUC 0.992022693157196
Test Epoch1 layer4 Acc 0.9975499129307901, AUC 0.991645872592926
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt  ,ep 1
gc 0
[[4.76678208e+03 3.06305662e+00]
 [4.51996930e-02 1.31430323e+00]
 [1.80397631e-02 7.03304901e-01]
 [2.10721550e-04 6.29065893e-01]
 [7.89875830e-03 5.22348353e-01]]
Train Epoch2 Acc 0.997861138532412 (394225/395070), AUC 0.9920701384544373
Test Epoch2 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch2 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch2 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch2 layer3 Acc 0.9974992912971288, AUC 0.992022693157196
Test Epoch2 layer4 Acc 0.9975600372575224, AUC 0.9902926087379456
gc 0
[[4.76678208e+03 3.06306872e+00]
 [4.52003405e-02 1.31428594e+00]
 [1.80405632e-02 7.03286315e-01]
 [2.10715866e-04 6.29054927e-01]
 [8.90988760e-03 4.46538297e-01]]
Train Epoch3 Acc 0.9979117624724733 (394245/395070), AUC 0.9918441772460938
Test Epoch3 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch3 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch3 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch3 layer3 Acc 0.9974992912971288, AUC 0.992022693157196
Test Epoch3 layer4 Acc 0.9974284210100028, AUC 0.9911059737205505
gc 0
[[4.76678204e+03 3.06299399e+00]
 [4.52007554e-02 1.31426540e+00]
 [1.80396091e-02 7.03280842e-01]
 [2.10714974e-04 6.29040411e-01]
 [8.66524397e-03 4.00433638e-01]]
Train Epoch4 Acc 0.9978662009264181 (394227/395070), AUC 0.9916658401489258
Test Epoch4 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch4 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch4 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch4 layer3 Acc 0.9974992912971288, AUC 0.992022693157196
Test Epoch4 layer4 Acc 0.9976106588911837, AUC 0.991446852684021
gc 0
[[4.76678211e+03 3.06322347e+00]
 [4.52000456e-02 1.31443426e+00]
 [1.80415972e-02 7.03345504e-01]
 [2.10716362e-04 6.29114685e-01]
 [6.32171609e-04 3.65561658e-01]]
Train Epoch5 Acc 0.9978737945174273 (394230/395070), AUC 0.9924525618553162
Test Epoch5 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch5 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch5 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch5 layer3 Acc 0.9974992912971288, AUC 0.992022693157196
Test Epoch5 layer4 Acc 0.9975701615842546, AUC 0.992098867893219
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt  ,ep 5
gc 0
[[4.76678208e+03 3.06303628e+00]
 [4.52006316e-02 1.31427506e+00]
 [1.80397319e-02 7.03285755e-01]
 [2.10721504e-04 6.29044941e-01]
 [2.91119437e-03 3.58984377e-01]]
Train Epoch6 Acc 0.9978940440934518 (394238/395070), AUC 0.9925752282142639
Test Epoch6 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch6 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch6 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch6 layer3 Acc 0.9974992912971288, AUC 0.992022693157196
Test Epoch6 layer4 Acc 0.9975802859109869, AUC 0.979283332824707
gc 0
[[4.76678208e+03 3.06324791e+00]
 [4.51999958e-02 1.31427498e+00]
 [1.80406493e-02 7.03290043e-01]
 [2.10716201e-04 6.29065567e-01]
 [2.11636372e-03 3.50886672e-01]]
Train Epoch7 Acc 0.997904168881464 (394242/395070), AUC 0.991441011428833
Test Epoch7 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch7 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch7 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch7 layer3 Acc 0.9974992912971288, AUC 0.992022693157196
Test Epoch7 layer4 Acc 0.9976612805248452, AUC 0.9861003756523132
gc 0
[[4.76678204e+03 3.06294965e+00]
 [4.52007554e-02 1.31429646e+00]
 [1.80396091e-02 7.03315689e-01]
 [2.10714974e-04 6.29062982e-01]
 [2.01960526e-03 3.43113656e-01]]
Train Epoch8 Acc 0.9978940440934518 (394238/395070), AUC 0.9919984936714172
Test Epoch8 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch8 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch8 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch8 layer3 Acc 0.9974992912971288, AUC 0.992022693157196
Test Epoch8 layer4 Acc 0.9976511561981128, AUC 0.9917280673980713
gc 0
[[4.76678209e+03 3.06343653e+00]
 [4.51997256e-02 1.31483561e+00]
 [1.80397398e-02 7.03531361e-01]
 [2.10721454e-04 6.29241743e-01]
 [1.62209770e-03 3.38568417e-01]]
Train Epoch9 Acc 0.9979016376844609 (394241/395070), AUC 0.9923620223999023
Test Epoch9 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch9 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch9 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Test Epoch9 layer3 Acc 0.9974992912971288, AUC 0.992022693157196
Test Epoch9 layer4 Acc 0.997620783217916, AUC 0.9907141327857971
Best AUC 0.992098867893219
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//kdd99/kdd99_linearal_l5_m5.pt
[[56149     0     9     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19419    15     0     3     0     2     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    38     0   275     0     0     0     0     0     0]
 [    0     0    48     0     0   201     1     0     0     0     0]
 [    0    24    18     0     0     0   166     0     0     0     0]
 [    0     0   133     2     0     0     0    69     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    1    23    29     0     0     0     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56152     0     6     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   18     1 19415     8     0     1     0    13     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    6     0    27     0   285     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0    11     8     0     0     0   189     0     0     0     0]
 [    0     0    33     0     0     0     0   171     0     0     0]
 [    1     0     2     0     0     0     0     0   193     0     0]
 [   26     9    17     0     0     0     0     1     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56152     0     6     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     1 19424     7     0     1     0     6     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    19     0   294     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0     6     6     0     0     0   196     0     0     0     0]
 [    0     0    36     0     0     0     0   168     0     0     0]
 [    2     0     0     0     1     0     0     0   193     0     0]
 [   17     0    36     0     0     0     0     0     0     0     0]
 [    0     0    47     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56152     0     6     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19419     7     0     1     0    11     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    19     0   294     0     0     0     0     0     0]
 [    0     0    30     0     0   220     0     0     0     0     0]
 [    0     5     6     0     0     0   197     0     0     0     0]
 [    0     0    19     0     0     0     0   185     0     0     0]
 [    1     1     0     0     1     0     0     0   193     0     0]
 [   10     7    36     0     0     0     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56152     0     6     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   18     1 19417     7     0     1     0    12     0     0     0]
 [    0     0    15   426     0     0     0     0     0     0     0]
 [    2     0    18     0   298     0     0     0     0     0     0]
 [    0     0    28     0     0   222     0     0     0     0     0]
 [    0     4     6     0     0     0   198     0     0     0     0]
 [    0     0    18     0     0     0     0   186     0     0     0]
 [    1     1     0     0     1     0     0     0   193     0     0]
 [   39     6     8     0     0     0     0     0     0     0     0]
 [   16     2    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
