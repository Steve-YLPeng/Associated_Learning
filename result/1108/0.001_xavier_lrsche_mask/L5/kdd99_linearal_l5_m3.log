Load ckpt from ./ckpt/mask2//kdd99/kdd99_linearal_l5_m2.pt
layer_mask {2}
Start Training
gc 9
[[4.76678212e+03 3.06298099e+00]
 [4.52001107e-02 1.31429687e+00]
 [1.87744412e+00 3.31084927e+00]
 [5.45890272e+02 4.81323072e+02]
 [5.16486480e+02 3.95992185e+02]]
Train Epoch0 Acc 0.5696585415242869 (225055/395070), AUC 0.309613972902298
Test Epoch0 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch0 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch0 layer2 Acc 0.9972360588020897, AUC 0.9789400696754456
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l5_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.00038472441582634756, AUC 0.17079375684261322
Test Epoch0 layer4 Acc 0.568561940630948, AUC 0.2791994512081146
gc 0
[[4.76678220e+03 3.06517809e+00]
 [4.51998082e-02 1.31610681e+00]
 [8.00432061e-03 9.93773740e-01]
 [5.29253525e+02 4.59360748e+02]
 [5.05126908e+02 3.91319401e+02]]
Train Epoch1 Acc 0.5686207507530311 (224645/395070), AUC 0.2856748402118683
Test Epoch1 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch1 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch1 layer2 Acc 0.9974587939901997, AUC 0.9920850992202759
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l5_m3.pt  ,ep 1
Test Epoch1 layer3 Acc 0.0005163406633458874, AUC 0.2579650580883026
Test Epoch1 layer4 Acc 0.5685821892844126, AUC 0.2910166382789612
gc 0
[[4.76678204e+03 3.06297447e+00]
 [4.52004107e-02 1.31425553e+00]
 [1.06580339e-02 8.97931229e-01]
 [4.63233713e+02 4.00102087e+02]
 [4.57370522e+02 3.55476220e+02]]
Train Epoch2 Acc 0.5686030323740097 (224638/395070), AUC 0.29903945326805115
Test Epoch2 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch2 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch2 layer2 Acc 0.9972563074555542, AUC 0.9828903675079346
Test Epoch2 layer3 Acc 0.5686125622646094, AUC 0.341727614402771
Test Epoch2 layer4 Acc 0.5685416919774835, AUC 0.30398494005203247
gc 0
[[4.76678205e+03 3.06297196e+00]
 [4.51999658e-02 1.31425685e+00]
 [1.00650684e-02 8.11756350e-01]
 [3.98201476e+02 3.55155378e+02]
 [4.07100774e+02 3.21378233e+02]]
Train Epoch3 Acc 0.5685144404789024 (224603/395070), AUC 0.2950100600719452
Test Epoch3 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch3 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch3 layer2 Acc 0.9973069290892156, AUC 0.9912172555923462
Test Epoch3 layer3 Acc 0.5686226865913416, AUC 0.3672778308391571
Test Epoch3 layer4 Acc 0.5684708216903576, AUC 0.27251487970352173
gc 0
[[4.76678214e+03 3.06359536e+00]
 [4.52005787e-02 1.31447160e+00]
 [9.83033524e-03 7.49459923e-01]
 [3.61893462e+02 3.39269736e+02]
 [3.78168934e+02 3.04413637e+02]]
Train Epoch4 Acc 0.1555344622471967 (61447/395070), AUC 0.29382777214050293
Test Epoch4 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch4 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch4 layer2 Acc 0.9973474263961447, AUC 0.9940919876098633
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l5_m3.pt  ,ep 4
Test Epoch4 layer3 Acc 0.5686429352448062, AUC 0.4606972634792328
Test Epoch4 layer4 Acc 0.00042522172275543676, AUC 0.31578531861305237
gc 0
[[4.76678208e+03 3.06342208e+00]
 [4.52007132e-02 1.31438042e+00]
 [1.04330861e-02 6.85863893e-01]
 [3.44508642e+02 3.29109915e+02]
 [3.65412024e+02 2.93519582e+02]]
Train Epoch5 Acc 0.0006226744627534361 (246/395070), AUC 0.3161783516407013
Test Epoch5 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch5 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch5 layer2 Acc 0.9973575507228769, AUC 0.9911273717880249
Test Epoch5 layer3 Acc 0.5686226865913416, AUC 0.4563242197036743
Test Epoch5 layer4 Acc 0.00045559470295225367, AUC 0.274533212184906
gc 0
[[4.76678204e+03 3.06337279e+00]
 [4.51999332e-02 1.31471768e+00]
 [8.82899461e-03 6.45063067e-01]
 [3.35542363e+02 3.26749076e+02]
 [3.60247932e+02 2.92251044e+02]]
Train Epoch6 Acc 0.0004556154605512947 (180/395070), AUC 0.26394394040107727
Test Epoch6 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch6 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch6 layer2 Acc 0.9973271777426801, AUC 0.9911193251609802
Test Epoch6 layer3 Acc 0.5688656704329162, AUC 0.48419368267059326
Test Epoch6 layer4 Acc 0.00035435143562953064, AUC 0.2501305043697357
gc 0
[[4.76678217e+03 3.06398752e+00]
 [4.51997130e-02 1.31438340e+00]
 [1.12237651e-02 6.17470097e-01]
 [3.26278319e+02 3.23880935e+02]
 [3.56627238e+02 2.93808143e+02]]
Train Epoch7 Acc 0.0004910522185941732 (194/395070), AUC 0.26107949018478394
Test Epoch7 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch7 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch7 layer2 Acc 0.9976106588911837, AUC 0.9916059374809265
Test Epoch7 layer3 Acc 0.5692605191754748, AUC 0.49758198857307434
Test Epoch7 layer4 Acc 0.0003239784554327137, AUC 0.3329398036003113
gc 0
[[4.76678208e+03 3.06356403e+00]
 [4.52005816e-02 1.31477311e+00]
 [7.63913260e-03 5.99455785e-01]
 [3.24065520e+02 3.21155878e+02]
 [3.55545095e+02 2.93231511e+02]]
Train Epoch8 Acc 0.00046320905156048295 (183/395070), AUC 0.3507084250450134
Test Epoch8 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch8 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch8 layer2 Acc 0.9974587939901997, AUC 0.9919379949569702
Test Epoch8 layer3 Acc 0.5692605191754748, AUC 0.5544385313987732
Test Epoch8 layer4 Acc 0.00035435143562953064, AUC 0.38934800028800964
gc 0
[[4.76678215e+03 3.06300398e+00]
 [4.52004642e-02 1.31427733e+00]
 [1.08521346e-03 5.38380539e-01]
 [3.24424609e+02 3.20223671e+02]
 [3.56059123e+02 2.95447578e+02]]
Train Epoch9 Acc 0.0005897689017136204 (233/395070), AUC 0.40312185883522034
Test Epoch9 layer0 Acc 0.9955857935447293, AUC 0.9693354964256287
Test Epoch9 layer1 Acc 0.9971246912080347, AUC 0.9939635992050171
Test Epoch9 layer2 Acc 0.997620783217916, AUC 0.9915437698364258
Test Epoch9 layer3 Acc 0.5691997732150812, AUC 0.565158486366272
Test Epoch9 layer4 Acc 0.0005467136435427044, AUC 0.38501760363578796
Best AUC 0.9940919876098633
train_loss (2, 5, 10)
valid_acc (5, 10)
valid_AUC (5, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//kdd99/kdd99_linearal_l5_m3.pt
[[56149     0     9     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19419    15     0     3     0     2     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    38     0   275     0     0     0     0     0     0]
 [    0     0    48     0     0   201     1     0     0     0     0]
 [    0    24    18     0     0     0   166     0     0     0     0]
 [    0     0   133     2     0     0     0    69     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    1    23    29     0     0     0     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56152     0     6     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   18     1 19415     8     0     1     0    13     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    6     0    27     0   285     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0    11     8     0     0     0   189     0     0     0     0]
 [    0     0    33     0     0     0     0   171     0     0     0]
 [    1     0     2     0     0     0     0     0   193     0     0]
 [   26     9    17     0     0     0     0     1     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56152     0     6     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   17     1 19424     7     0     1     0     6     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    19     0   294     0     0     0     0     0     0]
 [    0     0    31     0     0   219     0     0     0     0     0]
 [    0     6     6     0     0     0   196     0     0     0     0]
 [    0     0    36     0     0     0     0   168     0     0     0]
 [    2     0     0     0     1     0     0     0   193     0     0]
 [   17     0    36     0     0     0     0     0     0     0     0]
 [    0     0    47     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [19435     0     6     0    14     0     0     1     0     0     0]
 [  417    24     0     0     0     0     0     0     0     0     0]
 [  309     0     7     0     0     2     0     0     0     0     0]
 [   10     0   240     0     0     0     0     0     0     0     0]
 [   10     0   197     0     0     0     0     1     0     0     0]
 [   16     0     0     0   186     0     0     2     0     0     0]
 [  194     0     2     0     0     0     0     0     0     0     0]
 [   31     0    22     0     0     0     0     0     0     0     0]
 [    7     0    40     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[   42     8     0     0     0     0     2 56106     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [19448     3     0     0     0     1     0     4     0     0     0]
 [  200   239     0     0     1     0     0     1     0     0     0]
 [   36     0     0     0     0     0     0   282     0     0     0]
 [  230     0     0     0    20     0     0     0     0     0     0]
 [  208     0     0     0     0     0     0     0     0     0     0]
 [  204     0     0     0     0     0     0     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
