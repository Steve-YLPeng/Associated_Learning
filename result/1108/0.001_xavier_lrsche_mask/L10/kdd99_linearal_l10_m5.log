Load ckpt from ./ckpt/mask4//kdd99/kdd99_linearal_l10_m4.pt
layer_mask {4}
Start Training
gc 9
[[4.76674396e+03 2.90888493e+00]
 [2.42030142e-02 1.23379337e+00]
 [1.38260308e-02 7.74744650e-01]
 [2.44377926e-04 3.63805479e-01]
 [6.03165398e-01 9.83689125e-01]
 [1.95451718e+02 1.89671234e+02]
 [2.67448486e+02 1.91594225e+02]
 [2.24783534e+02 1.79690641e+02]
 [2.92060198e+02 2.08991977e+02]
 [2.60498617e+02 1.66174785e+02]]
Train Epoch0 Acc 0.21824233680107322 (86221/395070), AUC 0.46253859996795654
Test Epoch0 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch0 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch0 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch0 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch0 layer4 Acc 0.9978536427327582, AUC 0.9941044449806213
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l10_m5.pt  ,ep 0
Test Epoch0 layer5 Acc 0.08058964078888754, AUC 0.36298203468322754
Test Epoch0 layer6 Acc 0.568561940630948, AUC 0.6336022019386292
Test Epoch0 layer7 Acc 0.19599684121005953, AUC 0.6105384230613708
Test Epoch0 layer8 Acc 0.7874802575628721, AUC 0.45293959975242615
Test Epoch0 layer9 Acc 0.21712631110031183, AUC 0.4859403371810913
gc 0
[[4.76674396e+03 2.90896220e+00]
 [2.42028515e-02 1.23380170e+00]
 [1.38260532e-02 7.74748310e-01]
 [2.44373345e-04 3.63805268e-01]
 [5.77410688e-03 3.62826534e-01]
 [1.89335829e+02 1.77637486e+02]
 [2.59932160e+02 1.81132120e+02]
 [2.18782170e+02 1.73496552e+02]
 [2.86036699e+02 2.02110432e+02]
 [2.54365264e+02 1.62468896e+02]]
Train Epoch1 Acc 0.5293213860834789 (209119/395070), AUC 0.4752289950847626
Test Epoch1 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch1 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch1 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch1 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch1 layer4 Acc 0.9978738913862228, AUC 0.994148313999176
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l10_m5.pt  ,ep 1
Test Epoch1 layer5 Acc 0.03453407848378083, AUC 0.35778674483299255
Test Epoch1 layer6 Acc 0.568561940630948, AUC 0.6467962861061096
Test Epoch1 layer7 Acc 0.195976592556595, AUC 0.5960857272148132
Test Epoch1 layer8 Acc 0.21766290041712227, AUC 0.471675306558609
Test Epoch1 layer9 Acc 0.7742173895435953, AUC 0.48703524470329285
gc 0
[[4.76674397e+03 2.90905690e+00]
 [2.42031347e-02 1.23387374e+00]
 [1.38259821e-02 7.74782716e-01]
 [2.44376205e-04 3.63828953e-01]
 [9.49828587e-03 3.11690921e-01]
 [1.63047972e+02 1.50591733e+02]
 [2.27963100e+02 1.57793200e+02]
 [1.92838052e+02 1.58419880e+02]
 [2.60515101e+02 1.83726012e+02]
 [2.27422544e+02 1.47848772e+02]]
Train Epoch2 Acc 0.8013516591996355 (316590/395070), AUC 0.454842746257782
Test Epoch2 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch2 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch2 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch2 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch2 layer4 Acc 0.997954886000081, AUC 0.9930528998374939
Test Epoch2 layer5 Acc 2.0248653464544608e-05, AUC 0.35270053148269653
Test Epoch2 layer6 Acc 0.5686733082250031, AUC 0.6122667193412781
Test Epoch2 layer7 Acc 0.1950249058437614, AUC 0.4928431808948517
Test Epoch2 layer8 Acc 0.21799700319928725, AUC 0.4599640667438507
Test Epoch2 layer9 Acc 0.9793160004859677, AUC 0.5532989501953125
gc 0
[[4.76675112e+03 2.90925737e+00]
 [2.42027117e-02 1.23476505e+00]
 [1.38266671e-02 7.75584767e-01]
 [2.44384760e-04 3.64475909e-01]
 [6.25456862e-03 2.48797969e-01]
 [1.35784422e+02 1.27051284e+02]
 [1.94644642e+02 1.39247964e+02]
 [1.65677742e+02 1.43454505e+02]
 [2.33432387e+02 1.66429483e+02]
 [1.97810923e+02 1.33572324e+02]]
Train Epoch3 Acc 0.8473030095932367 (334744/395070), AUC 0.531793475151062
Test Epoch3 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch3 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch3 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch3 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch3 layer4 Acc 0.9979751346535456, AUC 0.9946308732032776
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l10_m5.pt  ,ep 3
Test Epoch3 layer5 Acc 8.099461385817843e-05, AUC 0.3464585542678833
Test Epoch3 layer6 Acc 0.5686024379378771, AUC 0.6009001731872559
Test Epoch3 layer7 Acc 0.00016198922771635686, AUC 0.4411650598049164
Test Epoch3 layer8 Acc 0.21767302474385453, AUC 0.4197394549846649
Test Epoch3 layer9 Acc 0.7854250192362208, AUC 0.5262935161590576
gc 0
[[4.76674397e+03 2.90951485e+00]
 [2.42033771e-02 1.23394984e+00]
 [1.38259165e-02 7.74823562e-01]
 [2.44377921e-04 3.63823021e-01]
 [5.77971897e-03 2.37390732e-01]
 [1.19860278e+02 1.12735282e+02]
 [1.72355269e+02 1.27844975e+02]
 [1.48119115e+02 1.34559182e+02]
 [2.14965455e+02 1.54668286e+02]
 [1.78465993e+02 1.24767117e+02]]
Train Epoch4 Acc 0.7855873642645607 (310362/395070), AUC 0.5212549567222595
Test Epoch4 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch4 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch4 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch4 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch4 layer4 Acc 0.9979953833070101, AUC 0.9948111176490784
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l10_m5.pt  ,ep 4
Test Epoch4 layer5 Acc 5.0621633661361516e-05, AUC 0.3361812233924866
Test Epoch4 layer6 Acc 0.5686125622646094, AUC 0.596920907497406
Test Epoch4 layer7 Acc 0.00010124326732272303, AUC 0.4221471846103668
Test Epoch4 layer8 Acc 0.21782488964483862, AUC 0.29241201281547546
Test Epoch4 layer9 Acc 0.7853642732758271, AUC 0.5368378758430481
gc 0
[[4.76674407e+03 2.91069885e+00]
 [2.42026953e-02 1.23392013e+00]
 [1.38263729e-02 7.74790903e-01]
 [2.44381094e-04 3.63819413e-01]
 [5.17047060e-03 2.34005956e-01]
 [1.14444492e+02 1.07067567e+02]
 [1.63953599e+02 1.21397432e+02]
 [1.40524370e+02 1.31660509e+02]
 [2.05308606e+02 1.48606903e+02]
 [1.67921312e+02 1.19668141e+02]]
Train Epoch5 Acc 0.7855139595514719 (310333/395070), AUC 0.5490545034408569
Test Epoch5 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch5 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch5 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch5 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch5 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Save ckpt to ./ckpt/mask5//kdd99/kdd99_linearal_l10_m5.pt  ,ep 5
Test Epoch5 layer5 Acc 0.00023285951484226298, AUC 0.3765118718147278
Test Epoch5 layer6 Acc 0.568521443324019, AUC 0.6523935794830322
Test Epoch5 layer7 Acc 0.21705544081318592, AUC 0.4604024589061737
Test Epoch5 layer8 Acc 0.21804762483294862, AUC 0.26494404673576355
Test Epoch5 layer9 Acc 0.7854250192362208, AUC 0.5708775520324707
gc 0
[[4.76674410e+03 2.91023360e+00]
 [2.42024046e-02 1.23411536e+00]
 [1.38262624e-02 7.74898144e-01]
 [2.44381305e-04 3.63860678e-01]
 [5.61718126e-03 2.33230364e-01]
 [1.17448893e+02 1.08963218e+02]
 [1.67807759e+02 1.22102293e+02]
 [1.43360771e+02 1.34345979e+02]
 [2.08801386e+02 1.50429092e+02]
 [1.65702234e+02 1.19383401e+02]]
Train Epoch6 Acc 0.7855493963095148 (310347/395070), AUC 0.5722100734710693
Test Epoch6 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch6 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch6 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch6 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch6 layer4 Acc 0.9980156319604746, AUC 0.9941408634185791
Test Epoch6 layer5 Acc 0.00020248653464544606, AUC 0.4184125065803528
Test Epoch6 layer6 Acc 0.568521443324019, AUC 0.46517497301101685
Test Epoch6 layer7 Acc 0.7444417446239825, AUC 0.49760255217552185
Test Epoch6 layer8 Acc 0.2177236463775159, AUC 0.29372450709342957
Test Epoch6 layer9 Acc 0.7854958895233467, AUC 0.5482068657875061
gc 0
[[4.76674395e+03 2.90884916e+00]
 [2.42026496e-02 1.23379160e+00]
 [1.38261132e-02 7.74736973e-01]
 [2.44372775e-04 3.63803062e-01]
 [6.73907076e-03 2.33147188e-01]
 [1.17970396e+02 1.08441298e+02]
 [1.66668805e+02 1.23146905e+02]
 [1.43193805e+02 1.35402836e+02]
 [2.08338386e+02 1.48777829e+02]
 [1.64778881e+02 1.20484481e+02]]
Train Epoch7 Acc 0.7856329258106158 (310380/395070), AUC 0.5587286353111267
Test Epoch7 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch7 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch7 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch7 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch7 layer4 Acc 0.9979953833070101, AUC 0.99383944272995
Test Epoch7 layer5 Acc 0.11501235167861337, AUC 0.4048078656196594
Test Epoch7 layer6 Acc 0.5685315676507512, AUC 0.4149956703186035
Test Epoch7 layer7 Acc 0.7847770623253554, AUC 0.41150161623954773
Test Epoch7 layer8 Acc 0.21756165714979953, AUC 0.2389841079711914
Test Epoch7 layer9 Acc 0.7855667598104726, AUC 0.5457181334495544
gc 0
[[4.76674411e+03 2.90908240e+00]
 [2.42025843e-02 1.23386989e+00]
 [1.38280507e-02 7.74795818e-01]
 [2.44387087e-04 3.63827657e-01]
 [3.88165500e-03 2.38078402e-01]
 [1.16272031e+02 1.07783724e+02]
 [1.61621831e+02 1.23085783e+02]
 [1.40141966e+02 1.37983254e+02]
 [2.01063677e+02 1.46221591e+02]
 [1.60888296e+02 1.21046308e+02]]
Train Epoch8 Acc 0.7855848330675577 (310361/395070), AUC 0.552062451839447
Test Epoch8 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch8 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch8 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch8 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch8 layer4 Acc 0.9979953833070101, AUC 0.9878591299057007
Test Epoch8 layer5 Acc 0.2168833272587373, AUC 0.457926869392395
Test Epoch8 layer6 Acc 0.5685416919774835, AUC 0.3909037709236145
Test Epoch8 layer7 Acc 0.6765480095573644, AUC 0.46669912338256836
Test Epoch8 layer8 Acc 0.0031587899404689587, AUC 0.291045606136322
Test Epoch8 layer9 Acc 0.7854148949094886, AUC 0.5667548775672913
gc 0
[[4.76675109e+03 2.90905540e+00]
 [2.42025285e-02 1.23381806e+00]
 [1.38264154e-02 7.74758098e-01]
 [2.44375541e-04 3.63809673e-01]
 [3.73442731e-03 2.37849087e-01]
 [1.14682682e+02 1.07203295e+02]
 [1.59714588e+02 1.22585134e+02]
 [1.39180791e+02 1.38482468e+02]
 [1.99496344e+02 1.45072910e+02]
 [1.58360201e+02 1.21233539e+02]]
Train Epoch9 Acc 0.7855949578555699 (310365/395070), AUC 0.580807089805603
Test Epoch9 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch9 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch9 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch9 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch9 layer4 Acc 0.9980156319604746, AUC 0.9948604702949524
Test Epoch9 layer5 Acc 0.00015186490098408455, AUC 0.4171513617038727
Test Epoch9 layer6 Acc 0.5685720649576803, AUC 0.3550551235675812
Test Epoch9 layer7 Acc 0.7852529056817722, AUC 0.3943709135055542
Test Epoch9 layer8 Acc 0.5694225084031912, AUC 0.3407154381275177
Test Epoch9 layer9 Acc 0.7855566354837403, AUC 0.5467023849487305
Best AUC 0.9951698184013367
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask5//kdd99/kdd99_linearal_l10_m5.pt
[[56147     0    11     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19416    15     0     4     0     4     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    30     0     0   219     1     0     0     0     0]
 [    0    24    14     0     0     0   170     0     0     0     0]
 [    0     0   130     0     0     0     0    74     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    6     3    26     0     0    18     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19423     7     0     2     0     6     0     0     0]
 [    0     0    12   429     0     0     0     0     0     0     0]
 [    5     0    23     0   290     0     0     0     0     0     0]
 [    0     0    19     0     0   231     0     0     0     0     0]
 [    0     7     6     0     0     0   195     0     0     0     0]
 [    0     0    89     0     0     0     0   115     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [   21    20    11     0     0     0     0     1     0     0     0]
 [   15     1    28     0     0     3     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19420     6     0     2     0     9     0     0     0]
 [    0     0     7   434     0     0     0     0     0     0     0]
 [    5     0    19     0   294     0     0     0     0     0     0]
 [    0     0    12     0     0   238     0     0     0     0     0]
 [    0     5     4     0     0     0   199     0     0     0     0]
 [    0     0    19     0     0     0     0   185     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   49     0     4     0     0     0     0     0     0     0     0]
 [   15     3    28     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19420     5     0     2     0    10     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    2     0    16     0   300     0     0     0     0     0     0]
 [    0     0     9     0     0   241     0     0     0     0     0]
 [    0     2     4     0     0     0   202     0     0     0     0]
 [    0     0    17     0     0     0     0   187     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [    7    16    29     0     0     0     0     1     0     0     0]
 [    0     3    43     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19421     5     0     2     0     9     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    14     0   302     0     0     0     0     0     0]
 [    2     0     7     0     0   241     0     0     0     0     0]
 [    0     1     4     0     0     0   203     0     0     0     0]
 [    0     0    18     0     0     0     0   186     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   30    12    11     0     0     0     0     0     0     0     0]
 [   29     3    14     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[    0 56158     0     0     0     0     0     0     0     0     0]
 [21418    23     0     0     0     0     0     0     0     0     0]
 [    7 19448     0     0     0     1     0     0     0     0     0]
 [  431    10     0     0     0     0     0     0     0     0     0]
 [    8   310     0     0     0     0     0     0     0     0     0]
 [    4   246     0     0     0     0     0     0     0     0     0]
 [  200     8     0     0     0     0     0     0     0     0     0]
 [    0   202     2     0     0     0     0     0     0     0     0]
 [  195     1     0     0     0     0     0     0     0     0     0]
 [   39    14     0     0     0     0     0     0     0     0     0]
 [   39     8     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56154     4     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [19432    23     0     0     1     0     0     0     0     0     0]
 [  441     0     0     0     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  202     0     6     0     0     0     0     0     0     0     0]
 [   12   187     5     0     0     0     0     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0 56158     0     0     0     0     0     0     0     0     0]
 [    2 21439     0     0     0     0     0     0     0     0     0]
 [  253 19203     0     0     0     0     0     0     0     0     0]
 [  439     2     0     0     0     0     0     0     0     0     0]
 [  269    49     0     0     0     0     0     0     0     0     0]
 [   66   184     0     0     0     0     0     0     0     0     0]
 [    0   208     0     0     0     0     0     0     0     0     0]
 [    0   204     0     0     0     0     0     0     0     0     0]
 [    3   193     0     0     0     0     0     0     0     0     0]
 [   51     2     0     0     0     0     0     0     0     0     0]
 [   40     7     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    5     7 56146     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [19337    27    91     1     0     0     0     0     0     0     0]
 [   14   427     0     0     0     0     0     0     0     0     0]
 [   42     0     3   273     0     0     0     0     0     0     0]
 [  176    74     0     0     0     0     0     0     0     0     0]
 [  206     2     0     0     0     0     0     0     0     0     0]
 [   12     4   188     0     0     0     0     0     0     0     0]
 [  193     3     0     0     0     0     0     0     0     0     0]
 [    2    51     0     0     0     0     0     0     0     0     0]
 [    7    40     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56136    22     0     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [19427    28     1     0     0     0     0     0     0     0     0]
 [    3   438     0     0     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [  246     4     0     0     0     0     0     0     0     0     0]
 [  208     0     0     0     0     0     0     0     0     0     0]
 [   12   192     0     0     0     0     0     0     0     0     0]
 [  147    49     0     0     0     0     0     0     0     0     0]
 [    2    50     0     1     0     0     0     0     0     0     0]
 [    8    21    18     0     0     0     0     0     0     0     0]]
Figure(640x480)
