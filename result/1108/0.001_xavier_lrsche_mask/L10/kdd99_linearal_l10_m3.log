Load ckpt from ./ckpt/mask2//kdd99/kdd99_linearal_l10_m2.pt
layer_mask {2}
Start Training
gc 9
[[4.76674396e+03 2.90887796e+00]
 [2.42024337e-02 1.23381013e+00]
 [1.91283864e+00 3.65096826e+00]
 [5.33708958e+02 5.21770555e+02]
 [4.77027398e+02 4.27775606e+02]
 [3.67670012e+02 4.05078363e+02]
 [4.71743189e+02 3.33775295e+02]
 [4.06559713e+02 3.67979794e+02]
 [4.00364168e+02 3.36855970e+02]
 [3.71119813e+02 2.94629750e+02]]
Train Epoch0 Acc 0.001741463538107171 (688/395070), AUC 0.5739638805389404
Test Epoch0 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch0 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch0 layer2 Acc 0.997398048029806, AUC 0.9882482886314392
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l10_m3.pt  ,ep 0
Test Epoch0 layer3 Acc 0.0025209573563358036, AUC 0.4510144889354706
Test Epoch0 layer4 Acc 0.5687036812051999, AUC 0.585320770740509
Test Epoch0 layer5 Acc 0.0002429838415745353, AUC 0.4474104642868042
Test Epoch0 layer6 Acc 0.21707568946665046, AUC 0.5733040571212769
Test Epoch0 layer7 Acc 0.21711618677357955, AUC 0.36479607224464417
Test Epoch0 layer8 Acc 0.17829951808204755, AUC 0.4001690149307251
Test Epoch0 layer9 Acc 0.003098043980075325, AUC 0.6235486268997192
gc 0
[[4.76674403e+03 2.90890255e+00]
 [2.42031688e-02 1.23381488e+00]
 [5.99183404e-03 9.84333237e-01]
 [5.22220446e+02 4.90807094e+02]
 [4.68278221e+02 3.98777332e+02]
 [3.61853606e+02 3.83147328e+02]
 [4.64806447e+02 3.20793131e+02]
 [4.01825690e+02 3.48188727e+02]
 [3.97778490e+02 3.22166966e+02]
 [3.66907130e+02 2.81475999e+02]]
Train Epoch1 Acc 0.0023793251828789835 (940/395070), AUC 0.6349768042564392
Test Epoch1 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch1 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch1 layer2 Acc 0.9976612805248452, AUC 0.9950225353240967
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l10_m3.pt  ,ep 1
Test Epoch1 layer3 Acc 0.0025209573563358036, AUC 0.4375874400138855
Test Epoch1 layer4 Acc 0.5686935568784676, AUC 0.6227068901062012
Test Epoch1 layer5 Acc 0.0010428056534240472, AUC 0.4530535042285919
Test Epoch1 layer6 Acc 0.21711618677357955, AUC 0.5337571501731873
Test Epoch1 layer7 Acc 0.2171060624468473, AUC 0.4581436812877655
Test Epoch1 layer8 Acc 0.18046612400275383, AUC 0.4024120271205902
Test Epoch1 layer9 Acc 0.0026120762969262545, AUC 0.6430793404579163
gc 0
[[4.76674403e+03 2.90893967e+00]
 [2.42028143e-02 1.23383479e+00]
 [1.25287367e-02 8.86492722e-01]
 [4.59366220e+02 4.08445220e+02]
 [4.20301958e+02 3.31991179e+02]
 [3.28675728e+02 3.30362682e+02]
 [4.27458749e+02 2.84458049e+02]
 [3.68787784e+02 3.02536402e+02]
 [3.76671344e+02 2.88855475e+02]
 [3.41959865e+02 2.58287397e+02]]
Train Epoch2 Acc 0.004130913508998405 (1632/395070), AUC 0.6470129489898682
Test Epoch2 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch2 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch2 layer2 Acc 0.9976815291783097, AUC 0.9943723678588867
Test Epoch2 layer3 Acc 0.0025412060098003483, AUC 0.42292624711990356
Test Epoch2 layer4 Acc 0.5686328109180739, AUC 0.5972789525985718
Test Epoch2 layer5 Acc 0.00021261086137771838, AUC 0.4362981617450714
Test Epoch2 layer6 Acc 0.21708581379338274, AUC 0.5724481344223022
Test Epoch2 layer7 Acc 0.21707568946665046, AUC 0.4572194218635559
Test Epoch2 layer8 Acc 0.18021301583444702, AUC 0.40504398941993713
Test Epoch2 layer9 Acc 0.0031689142672012313, AUC 0.6548416018486023
gc 0
[[4.76674398e+03 2.90920143e+00]
 [2.42023600e-02 1.23401864e+00]
 [1.21347872e-02 7.99861149e-01]
 [3.89405533e+02 3.39098706e+02]
 [3.66157288e+02 2.75110659e+02]
 [2.90303193e+02 2.84199068e+02]
 [3.83608883e+02 2.56802253e+02]
 [3.31578515e+02 2.67138347e+02]
 [3.49575191e+02 2.61813550e+02]
 [3.10213533e+02 2.37623871e+02]]
Train Epoch3 Acc 0.036431518465082136 (14393/395070), AUC 0.6617007851600647
Test Epoch3 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch3 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch3 layer2 Acc 0.9974587939901997, AUC 0.9944639801979065
Test Epoch3 layer3 Acc 0.0032094115741303202, AUC 0.49829617142677307
Test Epoch3 layer4 Acc 0.5685821892844126, AUC 0.5844563841819763
Test Epoch3 layer5 Acc 0.00020248653464544606, AUC 0.4199662506580353
Test Epoch3 layer6 Acc 0.21712631110031183, AUC 0.6931447386741638
Test Epoch3 layer7 Acc 0.21707568946665046, AUC 0.3807532489299774
Test Epoch3 layer8 Acc 0.17928157777507794, AUC 0.3863847851753235
Test Epoch3 layer9 Acc 0.05658486210666991, AUC 0.6533545851707458
gc 0
[[4.76674395e+03 2.90907152e+00]
 [2.42026621e-02 1.23388020e+00]
 [1.02743098e-02 7.16907106e-01]
 [3.40915366e+02 3.02767741e+02]
 [3.27718100e+02 2.42742739e+02]
 [2.62489839e+02 2.57328850e+02]
 [3.50423510e+02 2.40528030e+02]
 [3.05129760e+02 2.43759313e+02]
 [3.29293005e+02 2.49843481e+02]
 [2.86374360e+02 2.26995850e+02]]
Train Epoch4 Acc 0.05786316349001443 (22860/395070), AUC 0.6782928109169006
Test Epoch4 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch4 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch4 layer2 Acc 0.9977422751387033, AUC 0.9951528310775757
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l10_m3.pt  ,ep 4
Test Epoch4 layer3 Acc 0.0402846960677115, AUC 0.6386898756027222
Test Epoch4 layer4 Acc 0.5686226865913416, AUC 0.5691055655479431
Test Epoch4 layer5 Acc 0.0002632324950390799, AUC 0.5272685885429382
Test Epoch4 layer6 Acc 0.2171060624468473, AUC 0.6885403990745544
Test Epoch4 layer7 Acc 0.21697444619932774, AUC 0.36454465985298157
Test Epoch4 layer8 Acc 0.18034463208196655, AUC 0.36598318815231323
Test Epoch4 layer9 Acc 0.053891791195885476, AUC 0.7267152667045593
gc 0
[[4.76674411e+03 2.91097630e+00]
 [2.42020715e-02 1.23418678e+00]
 [1.01521369e-02 6.76890905e-01]
 [3.18743474e+02 2.85541844e+02]
 [3.10874798e+02 2.27139034e+02]
 [2.49560257e+02 2.44935917e+02]
 [3.35727251e+02 2.35284241e+02]
 [2.95379520e+02 2.32745492e+02]
 [3.21376589e+02 2.43482185e+02]
 [2.75337947e+02 2.22038157e+02]]
Train Epoch5 Acc 0.18340800364492368 (72459/395070), AUC 0.7273773550987244
Test Epoch5 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch5 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch5 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Save ckpt to ./ckpt/mask3//kdd99/kdd99_linearal_l10_m3.pt  ,ep 5
Test Epoch5 layer3 Acc 0.5712043899080711, AUC 0.561305046081543
Test Epoch5 layer4 Acc 0.5686226865913416, AUC 0.565473198890686
Test Epoch5 layer5 Acc 0.00017211355444862918, AUC 0.47930046916007996
Test Epoch5 layer6 Acc 0.21723767869436683, AUC 0.6834350228309631
Test Epoch5 layer7 Acc 0.21650872716964323, AUC 0.35995376110076904
Test Epoch5 layer8 Acc 0.18039525371562792, AUC 0.4149593114852905
Test Epoch5 layer9 Acc 0.22219859879318024, AUC 0.7649809122085571
gc 0
[[4.76674397e+03 2.90902280e+00]
 [2.42030533e-02 1.23383225e+00]
 [9.52534673e-03 6.46330782e-01]
 [3.15499803e+02 2.76475044e+02]
 [3.06053042e+02 2.18526787e+02]
 [2.47848985e+02 2.40042931e+02]
 [3.29796977e+02 2.37476605e+02]
 [2.91203833e+02 2.24081296e+02]
 [3.16745383e+02 2.42807433e+02]
 [2.68832575e+02 2.24759139e+02]]
Train Epoch6 Acc 0.21690333358645303 (85692/395070), AUC 0.7915278077125549
Test Epoch6 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch6 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch6 layer2 Acc 0.9978131454258292, AUC 0.9950838685035706
Test Epoch6 layer3 Acc 0.5862288907787632, AUC 0.5882636904716492
Test Epoch6 layer4 Acc 0.5686125622646094, AUC 0.49174755811691284
Test Epoch6 layer5 Acc 0.00037460008909407527, AUC 0.4620397388935089
Test Epoch6 layer6 Acc 0.2170351921597214, AUC 0.6883544325828552
Test Epoch6 layer7 Acc 0.20246628599198152, AUC 0.42627477645874023
Test Epoch6 layer8 Acc 0.17106062446847284, AUC 0.389622300863266
Test Epoch6 layer9 Acc 0.24279147936662213, AUC 0.8052152991294861
gc 0
[[4.76674396e+03 2.90887736e+00]
 [2.42030267e-02 1.23379539e+00]
 [1.12496014e-02 6.11265253e-01]
 [3.22922992e+02 2.83218718e+02]
 [3.08175920e+02 2.19315259e+02]
 [2.52776405e+02 2.42409665e+02]
 [3.33080116e+02 2.44173585e+02]
 [2.94689859e+02 2.22655781e+02]
 [3.20149348e+02 2.44686945e+02]
 [2.71425490e+02 2.28319027e+02]]
Train Epoch7 Acc 0.17504492874680436 (69155/395070), AUC 0.7928605675697327
Test Epoch7 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch7 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch7 layer2 Acc 0.9977119021585065, AUC 0.9940400719642639
Test Epoch7 layer3 Acc 0.6106892641639331, AUC 0.576554000377655
Test Epoch7 layer4 Acc 0.5685821892844126, AUC 0.47056081891059875
Test Epoch7 layer5 Acc 0.00038472441582634756, AUC 0.47249048948287964
Test Epoch7 layer6 Acc 0.2181893654072004, AUC 0.6566645503044128
Test Epoch7 layer7 Acc 0.21707568946665046, AUC 0.35800281167030334
Test Epoch7 layer8 Acc 0.1843842384481432, AUC 0.43639281392097473
Test Epoch7 layer9 Acc 0.04892074677033977, AUC 0.786429226398468
gc 0
[[4.76674396e+03 2.90915359e+00]
 [2.42026356e-02 1.23384356e+00]
 [8.95027174e-03 5.95298040e-01]
 [3.24528027e+02 2.83876189e+02]
 [3.10698693e+02 2.21487895e+02]
 [2.55440278e+02 2.40891070e+02]
 [3.30039995e+02 2.44289436e+02]
 [2.93029062e+02 2.21101323e+02]
 [3.19173983e+02 2.45178940e+02]
 [2.71565392e+02 2.30218428e+02]]
Train Epoch8 Acc 0.10685195028729086 (42214/395070), AUC 0.686738133430481
Test Epoch8 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch8 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch8 layer2 Acc 0.9977422751387033, AUC 0.9939088225364685
Test Epoch8 layer3 Acc 0.7520248653464544, AUC 0.5984352827072144
Test Epoch8 layer4 Acc 0.5686125622646094, AUC 0.5628234148025513
Test Epoch8 layer5 Acc 0.0002733568217713522, AUC 0.4322289526462555
Test Epoch8 layer6 Acc 0.3429919410359211, AUC 0.5547277331352234
Test Epoch8 layer7 Acc 0.21707568946665046, AUC 0.4283779263496399
Test Epoch8 layer8 Acc 0.08296885757097153, AUC 0.614799439907074
Test Epoch8 layer9 Acc 0.21572915401125825, AUC 0.6740010976791382
gc 0
[[4.76674401e+03 2.90883449e+00]
 [2.42030495e-02 1.23379651e+00]
 [8.40857369e-03 6.02275038e-01]
 [3.23125984e+02 2.82353713e+02]
 [3.09829769e+02 2.22766264e+02]
 [2.55529693e+02 2.37958724e+02]
 [3.25026085e+02 2.43414188e+02]
 [2.86983913e+02 2.20283980e+02]
 [3.14822119e+02 2.44053101e+02]
 [2.67117922e+02 2.27388727e+02]]
Train Epoch9 Acc 0.17982382868858685 (71043/395070), AUC 0.686503529548645
Test Epoch9 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch9 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch9 layer2 Acc 0.9977726481189001, AUC 0.9945814609527588
Test Epoch9 layer3 Acc 0.7302980601789981, AUC 0.5888041853904724
Test Epoch9 layer4 Acc 0.568561940630948, AUC 0.5709671378135681
Test Epoch9 layer5 Acc 0.0002429838415745353, AUC 0.4636722505092621
Test Epoch9 layer6 Acc 0.3698416555299073, AUC 0.6010802984237671
Test Epoch9 layer7 Acc 0.2171060624468473, AUC 0.4756367802619934
Test Epoch9 layer8 Acc 0.007947596484833758, AUC 0.46373245120048523
Test Epoch9 layer9 Acc 0.15205726319199772, AUC 0.6921490430831909
Best AUC 0.9954952597618103
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask3//kdd99/kdd99_linearal_l10_m3.pt
[[56147     0    11     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19416    15     0     4     0     4     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    30     0     0   219     1     0     0     0     0]
 [    0    24    14     0     0     0   170     0     0     0     0]
 [    0     0   130     0     0     0     0    74     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    6     3    26     0     0    18     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19423     7     0     2     0     6     0     0     0]
 [    0     0    12   429     0     0     0     0     0     0     0]
 [    5     0    23     0   290     0     0     0     0     0     0]
 [    0     0    19     0     0   231     0     0     0     0     0]
 [    0     7     6     0     0     0   195     0     0     0     0]
 [    0     0    89     0     0     0     0   115     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [   21    20    11     0     0     0     0     1     0     0     0]
 [   15     1    28     0     0     3     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19420     6     0     2     0     9     0     0     0]
 [    0     0     7   434     0     0     0     0     0     0     0]
 [    5     0    19     0   294     0     0     0     0     0     0]
 [    0     0    12     0     0   238     0     0     0     0     0]
 [    0     5     4     0     0     0   199     0     0     0     0]
 [    0     0    19     0     0     0     0   185     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   49     0     4     0     0     0     0     0     0     0     0]
 [   15     3    28     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[52291     0     4     0     0  3863     0     0     0     0     0]
 [    0     0 21441     0     0     0     0     0     0     0     0]
 [    1     0  3999     1     2 15420     1    28     4     0     0]
 [    0   418     1     0     0    20     0     0     2     0     0]
 [    0     0     0     0     0   318     0     0     0     0     0]
 [    1   117     3     0     0   129     0     0     0     0     0]
 [   81     0     1     0   121     5     0     0     0     0     0]
 [    0     0     5     0     1   198     0     0     0     0     0]
 [  193     0     0     0     0     3     0     0     0     0     0]
 [    0     0     2     0     0    51     0     0     0     0     0]
 [    0     0     6     0     0    41     0     0     0     0     0]]
Figure(640x480)
[[56153     0     0     0     0     0     0     5     0     0     0]
 [21440     0     0     0     0     1     0     0     0     0     0]
 [  117   227     0     0     9  3430     0 15672     1     0     0]
 [  438     0     0     0     0     1     0     2     0     0     0]
 [  308     0     0     0     0     4     0     6     0     0     0]
 [  247     0     0     0     0     0     0     3     0     0     0]
 [    9     0     0   194     1     3     0     1     0     0     0]
 [  160     5     0     0     0    28     0    11     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   51     0     0     0     0     0     0     2     0     0     0]
 [   40     0     0     0     0     0     0     7     0     0     0]]
Figure(640x480)
[[    0 56152     0     6     0     0     0     0     0     0     0]
 [    0     1     0 21440     0     0     0     0     0     0     0]
 [    0    66     0 19389     0     0     0     0     1     0     0]
 [    0     0    93    16     0     0     0     0   332     0     0]
 [    0   303     0    15     0     0     0     0     0     0     0]
 [    0   237     0    13     0     0     0     0     0     0     0]
 [    0     0   132    36    40     0     0     0     0     0     0]
 [    0     0     2   202     0     0     0     0     0     0     0]
 [    0     0     0   196     0     0     0     0     0     0     0]
 [    0     0     0    31    22     0     0     0     0     0     0]
 [    0    40     0     7     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0 56158     0     0     0     0     0     0     0     0     0]
 [    0 21439     0     0     0     0     0     0     2     0     0]
 [    0  8547    13  5248     0     0     0     0  5648     0     0]
 [    0   441     0     0     0     0     0     0     0     0     0]
 [    0    10   273    29     0     6     0     0     0     0     0]
 [    0    11     0   234     0     5     0     0     0     0     0]
 [    1    17     0     3     0   186     0     0     1     0     0]
 [    0    10     0     3     0     0     0     0   191     0     0]
 [    0     3     0   193     0     0     0     0     0     0     0]
 [    0    48     0     2     0     3     0     0     0     0     0]
 [    0    24     0     5     0    18     0     0     0     0     0]]
Figure(640x480)
[[    0 56158     0     0     0     0     0     0     0     0     0]
 [    0 21385     0     0     0    56     0     0     0     0     0]
 [    0 19456     0     0     0     0     0     0     0     0     0]
 [    0   441     0     0     0     0     0     0     0     0     0]
 [    0   318     0     0     0     0     0     0     0     0     0]
 [    0   250     0     0     0     0     0     0     0     0     0]
 [   11   197     0     0     0     0     0     0     0     0     0]
 [    0   204     0     0     0     0     0     0     0     0     0]
 [  193     3     0     0     0     0     0     0     0     0     0]
 [    0    49     0     4     0     0     0     0     0     0     0]
 [    0    47     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0 56158     0     0     0     0     0     0     0     0     0]
 [    0 17296     0  4145     0     0     0     0     0     0     0]
 [    0 19140     0   313     0     3     0     0     0     0     0]
 [    0   429     0    11     0     1     0     0     0     0     0]
 [    0    36     0     0   282     0     0     0     0     0     0]
 [    0    21     0     0     0   229     0     0     0     0     0]
 [    0   208     0     0     0     0     0     0     0     0     0]
 [    0    95     0   109     0     0     0     0     0     0     0]
 [    0   193     0     0     0     3     0     0     0     0     0]
 [    0     2     0    23     0    28     0     0     0     0     0]
 [    0    47     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0 56158     0     0     0     0     0     0     0     0     0]
 [    0 21391    50     0     0     0     0     0     0     0     0]
 [  243 18298   218   666     0     1     0     0    30     0     0]
 [    0   423    18     0     0     0     0     0     0     0     0]
 [    0   318     0     0     0     0     0     0     0     0     0]
 [    0     5     2    70     0   173     0     0     0     0     0]
 [    0   208     0     0     0     0     0     0     0     0     0]
 [    0   200     2     0     0     0     0     0     2     0     0]
 [    0     1    19    11     0     0     0     0   165     0     0]
 [    0    44     3     6     0     0     0     0     0     0     0]
 [    0     7    23     2     0     0     0     0    15     0     0]]
Figure(640x480)
