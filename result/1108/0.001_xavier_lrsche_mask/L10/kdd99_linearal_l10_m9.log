Load ckpt from ./ckpt/mask8//kdd99/kdd99_linearal_l10_m8.pt
layer_mask {8}
Start Training
gc 9
[[4.76674395e+03 2.90884311e+00]
 [2.42029187e-02 1.23378865e+00]
 [1.38260332e-02 7.74743989e-01]
 [2.44373535e-04 3.63802669e-01]
 [2.09785449e-03 2.30923436e-01]
 [6.56156542e-04 1.44509770e-01]
 [4.98942567e-04 8.94614991e-02]
 [5.07528131e-05 5.92417051e-02]
 [1.21929125e-01 2.51148636e-01]
 [4.89923300e+01 5.73745936e+01]]
Train Epoch0 Acc 0.754253676563647 (297983/395070), AUC 0.5275956392288208
Test Epoch0 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch0 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch0 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch0 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch0 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch0 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch0 layer6 Acc 0.9980460049406714, AUC 0.9953470826148987
Test Epoch0 layer7 Acc 0.9980966265743328, AUC 0.9954860806465149
Test Epoch0 layer8 Acc 0.9980763779208682, AUC 0.9950958490371704
Save ckpt to ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt  ,ep 0
Test Epoch0 layer9 Acc 0.7603166889401854, AUC 0.5143304467201233
gc 0
[[4.76674398e+03 2.90891424e+00]
 [2.42029986e-02 1.23380558e+00]
 [1.38259901e-02 7.74763185e-01]
 [2.44370669e-04 3.63806635e-01]
 [2.09788285e-03 2.30924616e-01]
 [6.56158661e-04 1.44510438e-01]
 [4.98944058e-04 8.94618578e-02]
 [5.07529043e-05 5.92418799e-02]
 [1.12628076e-03 6.23222928e-02]
 [4.75872954e+01 5.50072865e+01]]
Train Epoch1 Acc 0.6485306401397221 (256215/395070), AUC 0.5025482773780823
Test Epoch1 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch1 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch1 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch1 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch1 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch1 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch1 layer6 Acc 0.9980460049406714, AUC 0.9953470826148987
Test Epoch1 layer7 Acc 0.9980966265743328, AUC 0.9954860806465149
Test Epoch1 layer8 Acc 0.9980865022476005, AUC 0.9950045943260193
Test Epoch1 layer9 Acc 0.5686328109180739, AUC 0.48176097869873047
gc 0
[[4.76674400e+03 2.90956471e+00]
 [2.42029137e-02 1.23398257e+00]
 [1.38275699e-02 7.74816952e-01]
 [2.44374733e-04 3.63824150e-01]
 [2.09810645e-03 2.30933072e-01]
 [6.56463371e-04 1.44512363e-01]
 [4.98944744e-04 8.94634975e-02]
 [5.07568987e-05 5.92423514e-02]
 [1.74892002e-03 5.59295346e-02]
 [4.15911638e+01 4.83634784e+01]]
Train Epoch2 Acc 0.5686511251170678 (224657/395070), AUC 0.4070902168750763
Test Epoch2 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch2 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch2 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch2 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch2 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch2 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch2 layer6 Acc 0.9980460049406714, AUC 0.9953470826148987
Test Epoch2 layer7 Acc 0.9980966265743328, AUC 0.9954860806465149
Test Epoch2 layer8 Acc 0.9980966265743328, AUC 0.9955177307128906
Save ckpt to ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt  ,ep 2
Test Epoch2 layer9 Acc 0.5685720649576803, AUC 0.38590767979621887
gc 0
[[4.76674404e+03 2.90888912e+00]
 [2.42026651e-02 1.23381977e+00]
 [1.38279240e-02 7.74753648e-01]
 [2.44378611e-04 3.63805228e-01]
 [2.09826315e-03 2.30926297e-01]
 [6.56469043e-04 1.44510913e-01]
 [4.98955610e-04 8.94624404e-02]
 [5.07571432e-05 5.92422786e-02]
 [1.53489912e-03 5.11388804e-02]
 [3.60904251e+01 4.39482716e+01]]
Train Epoch3 Acc 0.5686055635710128 (224639/395070), AUC 0.4007267951965332
Test Epoch3 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch3 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch3 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch3 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch3 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch3 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch3 layer6 Acc 0.9980460049406714, AUC 0.9953470826148987
Test Epoch3 layer7 Acc 0.9980966265743328, AUC 0.9954860806465149
Test Epoch3 layer8 Acc 0.998106750901065, AUC 0.9950286746025085
Test Epoch3 layer9 Acc 0.5685720649576803, AUC 0.435865193605423
gc 0
[[4.76674395e+03 2.90886091e+00]
 [2.42022585e-02 1.23378391e+00]
 [1.38262100e-02 7.74732653e-01]
 [2.44368579e-04 3.63803381e-01]
 [2.09782645e-03 2.30923487e-01]
 [6.56149215e-04 1.44509818e-01]
 [4.98939531e-04 8.94615400e-02]
 [5.07527819e-05 5.92417273e-02]
 [1.58700473e-03 4.91079219e-02]
 [3.30303743e+01 4.12185797e+01]]
Train Epoch4 Acc 0.5686080947680158 (224640/395070), AUC 0.3927164077758789
Test Epoch4 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch4 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch4 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch4 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch4 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch4 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch4 layer6 Acc 0.9980460049406714, AUC 0.9953470826148987
Test Epoch4 layer7 Acc 0.9980966265743328, AUC 0.9954860806465149
Test Epoch4 layer8 Acc 0.9980966265743328, AUC 0.9952064752578735
Test Epoch4 layer9 Acc 0.5685720649576803, AUC 0.38425353169441223
gc 0
[[4.76675111e+03 2.90940079e+00]
 [2.42036130e-02 1.23385633e+00]
 [1.38261651e-02 7.74808054e-01]
 [2.44388076e-04 3.63824404e-01]
 [2.10080436e-03 2.30931986e-01]
 [6.56188173e-04 1.44512597e-01]
 [4.98993760e-04 8.94641394e-02]
 [5.07530268e-05 5.92440237e-02]
 [1.17981522e-03 4.92488336e-02]
 [3.29354426e+01 4.04757529e+01]]
Train Epoch5 Acc 0.5685954387830005 (224635/395070), AUC 0.39097434282302856
Test Epoch5 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch5 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch5 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch5 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch5 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch5 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch5 layer6 Acc 0.9980460049406714, AUC 0.9953470826148987
Test Epoch5 layer7 Acc 0.9980966265743328, AUC 0.9954860806465149
Test Epoch5 layer8 Acc 0.9970335722674443, AUC 0.9950299859046936
Test Epoch5 layer9 Acc 0.568561940630948, AUC 0.3900696039199829
gc 0
[[4.76674401e+03 2.90885688e+00]
 [2.42031168e-02 1.23379813e+00]
 [1.38260731e-02 7.74750026e-01]
 [2.44441332e-04 3.63804055e-01]
 [2.09823468e-03 2.30924563e-01]
 [6.56164085e-04 1.44511554e-01]
 [4.98969727e-04 8.94616938e-02]
 [5.07540002e-05 5.92416972e-02]
 [1.56773182e-03 4.98782711e-02]
 [3.16864832e+01 3.97405311e+01]]
Train Epoch6 Acc 0.5686030323740097 (224638/395070), AUC 0.41416028141975403
Test Epoch6 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch6 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch6 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch6 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch6 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch6 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch6 layer6 Acc 0.9980460049406714, AUC 0.9953470826148987
Test Epoch6 layer7 Acc 0.9980966265743328, AUC 0.9954860806465149
Test Epoch6 layer8 Acc 0.9980966265743328, AUC 0.9955629706382751
Save ckpt to ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt  ,ep 6
Test Epoch6 layer9 Acc 0.568561940630948, AUC 0.40955737233161926
gc 0
[[4.76674415e+03 2.90991603e+00]
 [2.42032445e-02 1.23389784e+00]
 [1.38261011e-02 7.74809994e-01]
 [2.44508418e-04 3.63826541e-01]
 [2.09865125e-03 2.30944654e-01]
 [6.56181372e-04 1.44532765e-01]
 [4.99453977e-04 8.94633009e-02]
 [5.07554510e-05 5.92427315e-02]
 [7.58493512e-05 4.64781472e-02]
 [3.06741962e+01 3.92510412e+01]]
Train Epoch7 Acc 0.5685954387830005 (224635/395070), AUC 0.43290475010871887
Test Epoch7 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch7 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch7 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch7 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch7 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch7 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch7 layer6 Acc 0.9980460049406714, AUC 0.9953470826148987
Test Epoch7 layer7 Acc 0.9980966265743328, AUC 0.9954860806465149
Test Epoch7 layer8 Acc 0.9981269995545297, AUC 0.995161235332489
Test Epoch7 layer9 Acc 0.568561940630948, AUC 0.40037479996681213
gc 0
[[4.76674415e+03 2.90942329e+00]
 [2.42025342e-02 1.23385720e+00]
 [1.38277591e-02 7.74768107e-01]
 [2.44382883e-04 3.63812645e-01]
 [2.09813411e-03 2.30936238e-01]
 [6.56516995e-04 1.44533786e-01]
 [4.99407365e-04 8.94639510e-02]
 [5.08039153e-05 5.92432216e-02]
 [3.76492555e-04 4.68679610e-02]
 [3.07120525e+01 3.92985356e+01]]
Train Epoch8 Acc 0.5685979699800036 (224636/395070), AUC 0.3965587615966797
Test Epoch8 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch8 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch8 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch8 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch8 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch8 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch8 layer6 Acc 0.9980460049406714, AUC 0.9953470826148987
Test Epoch8 layer7 Acc 0.9980966265743328, AUC 0.9954860806465149
Test Epoch8 layer8 Acc 0.9980966265743328, AUC 0.9956861138343811
Save ckpt to ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt  ,ep 8
Test Epoch8 layer9 Acc 0.5685720649576803, AUC 0.3548037111759186
gc 0
[[4.76674396e+03 2.90887397e+00]
 [2.42022320e-02 1.23379384e+00]
 [1.38262243e-02 7.74731436e-01]
 [2.44369535e-04 3.63803001e-01]
 [2.09781700e-03 2.30923617e-01]
 [6.56148511e-04 1.44509892e-01]
 [4.98939034e-04 8.94616616e-02]
 [5.07527516e-05 5.92417393e-02]
 [2.10711730e-04 4.70376519e-02]
 [3.07667890e+01 3.95113256e+01]]
Train Epoch9 Acc 0.5686207507530311 (224645/395070), AUC 0.38591817021369934
Test Epoch9 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch9 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch9 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch9 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch9 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch9 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch9 layer6 Acc 0.9980460049406714, AUC 0.9953470826148987
Test Epoch9 layer7 Acc 0.9980966265743328, AUC 0.9954860806465149
Test Epoch9 layer8 Acc 0.9981168752277974, AUC 0.9958052039146423
Save ckpt to ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt  ,ep 9
Test Epoch9 layer9 Acc 0.5685720649576803, AUC 0.3250885009765625
Best AUC 0.9958052039146423
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask9//kdd99/kdd99_linearal_l10_m9.pt
[[56147     0    11     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19416    15     0     4     0     4     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    30     0     0   219     1     0     0     0     0]
 [    0    24    14     0     0     0   170     0     0     0     0]
 [    0     0   130     0     0     0     0    74     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    6     3    26     0     0    18     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19423     7     0     2     0     6     0     0     0]
 [    0     0    12   429     0     0     0     0     0     0     0]
 [    5     0    23     0   290     0     0     0     0     0     0]
 [    0     0    19     0     0   231     0     0     0     0     0]
 [    0     7     6     0     0     0   195     0     0     0     0]
 [    0     0    89     0     0     0     0   115     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [   21    20    11     0     0     0     0     1     0     0     0]
 [   15     1    28     0     0     3     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19420     6     0     2     0     9     0     0     0]
 [    0     0     7   434     0     0     0     0     0     0     0]
 [    5     0    19     0   294     0     0     0     0     0     0]
 [    0     0    12     0     0   238     0     0     0     0     0]
 [    0     5     4     0     0     0   199     0     0     0     0]
 [    0     0    19     0     0     0     0   185     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   49     0     4     0     0     0     0     0     0     0     0]
 [   15     3    28     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19420     5     0     2     0    10     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    2     0    16     0   300     0     0     0     0     0     0]
 [    0     0     9     0     0   241     0     0     0     0     0]
 [    0     2     4     0     0     0   202     0     0     0     0]
 [    0     0    17     0     0     0     0   187     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [    7    16    29     0     0     0     0     1     0     0     0]
 [    0     3    43     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19421     5     0     2     0     9     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    14     0   302     0     0     0     0     0     0]
 [    2     0     7     0     0   241     0     0     0     0     0]
 [    0     1     4     0     0     0   203     0     0     0     0]
 [    0     0    18     0     0     0     0   186     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   30    12    11     0     0     0     0     0     0     0     0]
 [   29     3    14     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19422     4     0     2     0     9     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    2     1     6     0     0   241     0     0     0     0     0]
 [    0     1     4     0     0     0   203     0     0     0     0]
 [    0     0    21     0     0     0     0   183     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [    1    16    36     0     0     0     0     0     0     0     0]
 [   26    11     9     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19419     4     1     2     0    11     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    11     0   305     0     0     0     0     0     0]
 [    3     0     6     0     0   241     0     0     0     0     0]
 [    0     0     4     0     0     0   204     0     0     0     0]
 [    0     0    17     0     0     0     0   187     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [   14     7    32     0     0     0     0     0     0     0     0]
 [   34     3     9     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19421     3     1     2     0    10     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    1     0     9     0   308     0     0     0     0     0     0]
 [    4     0     5     0     0   241     0     0     0     0     0]
 [    0     0     4     0     0     0   204     0     0     0     0]
 [    0     0    17     0     0     0     0   187     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [    4    16    33     0     0     0     0     0     0     0     0]
 [   37     2     7     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   17     1 19422     3     1     2     0    10     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    0     0     9     0   309     0     0     0     0     0     0]
 [    3     0     6     0     0   241     0     0     0     0     0]
 [    0     0     4     0     0     0   204     0     0     0     0]
 [    0     0    17     0     0     0     0   187     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [   16    16    20     1     0     0     0     0     0     0     0]
 [   34     3     9     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [19455     0     1     0     0     0     0     0     0     0     0]
 [  441     0     0     0     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [   12     0   238     0     0     0     0     0     0     0     0]
 [    4     0   204     0     0     0     0     0     0     0     0]
 [  204     0     0     0     0     0     0     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [    9     0    38     0     0     0     0     0     0     0     0]]
Figure(640x480)
