Load ckpt from ./ckpt/mask5//kdd99/kdd99_linearal_l10_m5.pt
layer_mask {5}
Start Training
gc 9
[[4.76674400e+03 2.90892091e+00]
 [2.42024819e-02 1.23380324e+00]
 [1.38276723e-02 7.74740794e-01]
 [2.44369392e-04 3.63803854e-01]
 [2.09810324e-03 2.30925892e-01]
 [3.19261367e-01 5.82071551e-01]
 [1.38018370e+02 1.02630851e+02]
 [1.29344331e+02 1.33474984e+02]
 [1.81567704e+02 1.48994288e+02]
 [1.65416045e+02 1.24200747e+02]]
Train Epoch0 Acc 0.8861821955602804 (350104/395070), AUC 0.7889711260795593
Test Epoch0 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch0 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch0 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch0 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch0 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch0 layer5 Acc 0.9980156319604746, AUC 0.9946427941322327
Save ckpt to ./ckpt/mask6//kdd99/kdd99_linearal_l10_m6.pt  ,ep 0
Test Epoch0 layer6 Acc 0.6028327866196898, AUC 0.4954976737499237
Test Epoch0 layer7 Acc 0.21733892196168955, AUC 0.48006847500801086
Test Epoch0 layer8 Acc 0.9819685740898231, AUC 0.6014418005943298
Test Epoch0 layer9 Acc 0.9520410642692261, AUC 0.7922113537788391
gc 0
[[4.76674402e+03 2.91040324e+00]
 [2.42027812e-02 1.23516552e+00]
 [1.38260413e-02 7.75841957e-01]
 [2.44372634e-04 3.64585541e-01]
 [2.09788576e-03 2.31474917e-01]
 [4.95970491e-03 2.03202550e-01]
 [1.33460723e+02 9.76766464e+01]
 [1.25484461e+02 1.27506677e+02]
 [1.77172715e+02 1.44322591e+02]
 [1.61078769e+02 1.19850766e+02]]
Train Epoch1 Acc 0.8013390032146201 (316585/395070), AUC 0.799220860004425
Test Epoch1 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch1 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch1 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch1 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch1 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch1 layer5 Acc 0.9980055076337424, AUC 0.9950326681137085
Save ckpt to ./ckpt/mask6//kdd99/kdd99_linearal_l10_m6.pt  ,ep 1
Test Epoch1 layer6 Acc 0.5686530595715384, AUC 0.4643915891647339
Test Epoch1 layer7 Acc 0.21712631110031183, AUC 0.5678427815437317
Test Epoch1 layer8 Acc 0.9819179524561616, AUC 0.6670591235160828
Test Epoch1 layer9 Acc 0.7648321386627789, AUC 0.8152687549591064
gc 0
[[4.76674407e+03 2.90938120e+00]
 [2.42030118e-02 1.23405644e+00]
 [1.38279327e-02 7.74924924e-01]
 [2.44448889e-04 3.63876679e-01]
 [2.09863981e-03 2.30966415e-01]
 [4.77187069e-03 1.81663308e-01]
 [1.15847774e+02 8.54795463e+01]
 [1.10562047e+02 1.13400249e+02]
 [1.59934983e+02 1.30343922e+02]
 [1.46830873e+02 1.11280730e+02]]
Train Epoch2 Acc 0.7648163616574278 (302156/395070), AUC 0.7826114892959595
Test Epoch2 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch2 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch2 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch2 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch2 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch2 layer5 Acc 0.9980460049406714, AUC 0.994994580745697
Test Epoch2 layer6 Acc 0.5688049244725226, AUC 0.5437605381011963
Test Epoch2 layer7 Acc 0.7850200461669299, AUC 0.5889256000518799
Test Epoch2 layer8 Acc 0.5690377839873648, AUC 0.6188344955444336
Test Epoch2 layer9 Acc 0.7645284088608107, AUC 0.7918298244476318
gc 0
[[4.76675109e+03 2.90952578e+00]
 [2.42036537e-02 1.23411707e+00]
 [1.38261595e-02 7.74914538e-01]
 [2.44389221e-04 3.63896504e-01]
 [2.10080004e-03 2.30965112e-01]
 [4.00917079e-03 1.57653781e-01]
 [9.97853046e+01 7.69321059e+01]
 [9.77243723e+01 1.02016293e+02]
 [1.45074903e+02 1.18907048e+02]
 [1.34957447e+02 1.05139929e+02]]
Train Epoch3 Acc 0.7640342217834815 (301847/395070), AUC 0.757707953453064
Test Epoch3 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch3 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch3 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch3 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch3 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch3 layer5 Acc 0.9980156319604746, AUC 0.9951003789901733
Save ckpt to ./ckpt/mask6//kdd99/kdd99_linearal_l10_m6.pt  ,ep 3
Test Epoch3 layer6 Acc 0.6059207062730328, AUC 0.5506556034088135
Test Epoch3 layer7 Acc 0.21708581379338274, AUC 0.5911247730255127
Test Epoch3 layer8 Acc 0.5686631838982708, AUC 0.5543702840805054
Test Epoch3 layer9 Acc 0.7637488357024258, AUC 0.7313511371612549
gc 0
[[4.76674400e+03 2.90913300e+00]
 [2.42031426e-02 1.23395860e+00]
 [1.38262793e-02 7.74847564e-01]
 [2.44383899e-04 3.63844201e-01]
 [2.09801007e-03 2.30943491e-01]
 [4.28049231e-03 1.53241275e-01]
 [9.20151376e+01 7.03982756e+01]
 [9.01031684e+01 9.58370974e+01]
 [1.34787488e+02 1.10607190e+02]
 [1.27901578e+02 1.01294245e+02]]
Train Epoch4 Acc 0.7645075556230542 (302034/395070), AUC 0.6562190651893616
Test Epoch4 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch4 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch4 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch4 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch4 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch4 layer5 Acc 0.998066253594136, AUC 0.9949188828468323
Test Epoch4 layer6 Acc 0.784949175879804, AUC 0.50761878490448
Test Epoch4 layer7 Acc 0.7851415380877171, AUC 0.5461333394050598
Test Epoch4 layer8 Acc 0.568561940630948, AUC 0.5135157704353333
Test Epoch4 layer9 Acc 0.763870327623213, AUC 0.6391797661781311
gc 0
[[4.76674404e+03 2.90925298e+00]
 [2.42034836e-02 1.23461567e+00]
 [1.38258909e-02 7.74960389e-01]
 [2.44383892e-04 3.63853811e-01]
 [2.09787248e-03 2.30960386e-01]
 [5.38752736e-03 1.56476892e-01]
 [9.73428842e+01 7.39630626e+01]
 [9.54454879e+01 9.91605767e+01]
 [1.38695652e+02 1.14144775e+02]
 [1.32360841e+02 1.04109177e+02]]
Train Epoch5 Acc 0.7363429265699749 (290907/395070), AUC 0.621555745601654
Test Epoch5 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch5 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch5 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch5 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch5 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch5 layer5 Acc 0.9980156319604746, AUC 0.9949682354927063
Test Epoch5 layer6 Acc 0.5685821892844126, AUC 0.4742960035800934
Test Epoch5 layer7 Acc 0.7853035273154335, AUC 0.5950497984886169
Test Epoch5 layer8 Acc 0.5685720649576803, AUC 0.5457605123519897
Test Epoch5 layer9 Acc 0.7537763738711376, AUC 0.629285991191864
gc 0
[[4.76674400e+03 2.90891788e+00]
 [2.42033585e-02 1.23380165e+00]
 [1.38262281e-02 7.74753073e-01]
 [2.44386570e-04 3.63804209e-01]
 [2.09801168e-03 2.30924235e-01]
 [4.20617522e-04 1.42838474e-01]
 [1.00019586e+02 7.51976586e+01]
 [9.83716139e+01 1.00250134e+02]
 [1.41406741e+02 1.14507788e+02]
 [1.35571299e+02 1.07398984e+02]]
Train Epoch6 Acc 0.708755410433594 (280008/395070), AUC 0.6282668113708496
Test Epoch6 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch6 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch6 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch6 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch6 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch6 layer5 Acc 0.9980358806139392, AUC 0.994964063167572
Test Epoch6 layer6 Acc 0.5686125622646094, AUC 0.46232274174690247
Test Epoch6 layer7 Acc 0.7853339002956303, AUC 0.5332835912704468
Test Epoch6 layer8 Acc 0.5685923136111448, AUC 0.5730429887771606
Test Epoch6 layer9 Acc 0.5762868019276718, AUC 0.6307780146598816
gc 0
[[4.76674412e+03 2.90901452e+00]
 [2.42025295e-02 1.23383441e+00]
 [1.38326842e-02 7.74792321e-01]
 [2.44381634e-04 3.63827512e-01]
 [2.09825976e-03 2.30936125e-01]
 [1.04349997e-03 1.43284241e-01]
 [9.74829276e+01 7.43578828e+01]
 [9.62008329e+01 9.86857700e+01]
 [1.38630188e+02 1.13702838e+02]
 [1.33960105e+02 1.07686408e+02]]
Train Epoch7 Acc 0.5794517427291366 (228924/395070), AUC 0.6286377310752869
Test Epoch7 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch7 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch7 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch7 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch7 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch7 layer5 Acc 0.9980561292674037, AUC 0.9951778054237366
Save ckpt to ./ckpt/mask6//kdd99/kdd99_linearal_l10_m6.pt  ,ep 7
Test Epoch7 layer6 Acc 0.5686328109180739, AUC 0.5182192325592041
Test Epoch7 layer7 Acc 0.7853339002956303, AUC 0.6195489168167114
Test Epoch7 layer8 Acc 0.568561940630948, AUC 0.570503830909729
Test Epoch7 layer9 Acc 0.5712448872150002, AUC 0.6457964777946472
gc 0
[[4.76674399e+03 2.90890779e+00]
 [2.42024417e-02 1.23379272e+00]
 [1.38264616e-02 7.74737180e-01]
 [2.44377798e-04 3.63803640e-01]
 [2.09798635e-03 2.30924276e-01]
 [1.09192767e-03 1.41144869e-01]
 [9.64347791e+01 7.45189111e+01]
 [9.54837807e+01 9.77209243e+01]
 [1.38270292e+02 1.13250580e+02]
 [1.33870226e+02 1.08413303e+02]]
Train Epoch8 Acc 0.749254562482598 (296008/395070), AUC 0.5958663821220398
Test Epoch8 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch8 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch8 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch8 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch8 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch8 layer5 Acc 0.9980358806139392, AUC 0.9947588443756104
Test Epoch8 layer6 Acc 0.5686631838982708, AUC 0.4726583659648895
Test Epoch8 layer7 Acc 0.785283278661969, AUC 0.6054697036743164
Test Epoch8 layer8 Acc 0.568561940630948, AUC 0.6002876162528992
Test Epoch8 layer9 Acc 0.7644474142469526, AUC 0.5696958303451538
gc 0
[[4.76674404e+03 2.90892183e+00]
 [2.42032962e-02 1.23382100e+00]
 [1.38306798e-02 7.74751564e-01]
 [2.44384189e-04 3.63806655e-01]
 [2.09784567e-03 2.30926692e-01]
 [1.28933825e-03 1.39361290e-01]
 [9.50407982e+01 7.41010890e+01]
 [9.45385020e+01 9.68604126e+01]
 [1.37206317e+02 1.13333775e+02]
 [1.33337876e+02 1.08727418e+02]]
Train Epoch9 Acc 0.7636216366719821 (301684/395070), AUC 0.5843889713287354
Test Epoch9 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch9 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch9 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch9 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch9 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch9 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Save ckpt to ./ckpt/mask6//kdd99/kdd99_linearal_l10_m6.pt  ,ep 9
Test Epoch9 layer6 Acc 0.5685720649576803, AUC 0.5113536715507507
Test Epoch9 layer7 Acc 0.7852731543352367, AUC 0.5645148754119873
Test Epoch9 layer8 Acc 0.568561940630948, AUC 0.5886564254760742
Test Epoch9 layer9 Acc 0.7633742356133317, AUC 0.6140350699424744
Best AUC 0.9954582452774048
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask6//kdd99/kdd99_linearal_l10_m6.pt
[[56147     0    11     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19416    15     0     4     0     4     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    30     0     0   219     1     0     0     0     0]
 [    0    24    14     0     0     0   170     0     0     0     0]
 [    0     0   130     0     0     0     0    74     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    6     3    26     0     0    18     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19423     7     0     2     0     6     0     0     0]
 [    0     0    12   429     0     0     0     0     0     0     0]
 [    5     0    23     0   290     0     0     0     0     0     0]
 [    0     0    19     0     0   231     0     0     0     0     0]
 [    0     7     6     0     0     0   195     0     0     0     0]
 [    0     0    89     0     0     0     0   115     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [   21    20    11     0     0     0     0     1     0     0     0]
 [   15     1    28     0     0     3     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19420     6     0     2     0     9     0     0     0]
 [    0     0     7   434     0     0     0     0     0     0     0]
 [    5     0    19     0   294     0     0     0     0     0     0]
 [    0     0    12     0     0   238     0     0     0     0     0]
 [    0     5     4     0     0     0   199     0     0     0     0]
 [    0     0    19     0     0     0     0   185     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   49     0     4     0     0     0     0     0     0     0     0]
 [   15     3    28     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19420     5     0     2     0    10     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    2     0    16     0   300     0     0     0     0     0     0]
 [    0     0     9     0     0   241     0     0     0     0     0]
 [    0     2     4     0     0     0   202     0     0     0     0]
 [    0     0    17     0     0     0     0   187     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [    7    16    29     0     0     0     0     1     0     0     0]
 [    0     3    43     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19421     5     0     2     0     9     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    14     0   302     0     0     0     0     0     0]
 [    2     0     7     0     0   241     0     0     0     0     0]
 [    0     1     4     0     0     0   203     0     0     0     0]
 [    0     0    18     0     0     0     0   186     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   30    12    11     0     0     0     0     0     0     0     0]
 [   29     3    14     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19422     4     0     2     0     9     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    2     1     6     0     0   241     0     0     0     0     0]
 [    0     1     4     0     0     0   203     0     0     0     0]
 [    0     0    21     0     0     0     0   183     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [    1    16    36     0     0     0     0     0     0     0     0]
 [   26    11     9     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56157     1     0     0     0     0     0     0     0     0     0]
 [21439     2     0     0     0     0     0     0     0     0     0]
 [19442    14     0     0     0     0     0     0     0     0     0]
 [  441     0     0     0     0     0     0     0     0     0     0]
 [  296     0    22     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  208     0     0     0     0     0     0     0     0     0     0]
 [   17   186     1     0     0     0     0     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [   31    16     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56121    37     0     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [ 6982 12473     1     0     0     0     0     0     0     0     0]
 [  440     1     0     0     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [    2   248     0     0     0     0     0     0     0     0     0]
 [  208     0     0     0     0     0     0     0     0     0     0]
 [  183    21     0     0     0     0     0     0     0     0     0]
 [    3   193     0     0     0     0     0     0     0     0     0]
 [   41     0    12     0     0     0     0     0     0     0     0]
 [    4    43     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [19431    25     0     0     0     0     0     0     0     0     0]
 [  441     0     0     0     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  207     1     0     0     0     0     0     0     0     0     0]
 [  204     0     0     0     0     0     0     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   51     2     0     0     0     0     0     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56155     0     3     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [  208     2 19245     1     0     0     0     0     0     0     0]
 [  440     0     1     0     0     0     0     0     0     0     0]
 [  315     0     3     0     0     0     0     0     0     0     0]
 [  247     0     3     0     0     0     0     0     0     0     0]
 [  206     1     1     0     0     0     0     0     0     0     0]
 [  193     0    11     0     0     0     0     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   51     0     2     0     0     0     0     0     0     0     0]
 [   23    18     6     0     0     0     0     0     0     0     0]]
Figure(640x480)
