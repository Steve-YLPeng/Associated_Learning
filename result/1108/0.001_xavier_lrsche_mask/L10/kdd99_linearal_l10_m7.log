Load ckpt from ./ckpt/mask6//kdd99/kdd99_linearal_l10_m6.pt
layer_mask {6}
Start Training
gc 9
[[4.76674397e+03 2.90884702e+00]
 [2.42023383e-02 1.23378457e+00]
 [1.38261668e-02 7.74743853e-01]
 [2.44365713e-04 3.63803075e-01]
 [2.09785480e-03 2.30923604e-01]
 [6.56151333e-04 1.44509797e-01]
 [2.72360084e-01 4.08546461e-01]
 [8.29190367e+01 8.38410912e+01]
 [1.15079929e+02 1.00901009e+02]
 [1.22131238e+02 9.73595659e+01]]
Train Epoch0 Acc 0.0137595869086491 (5436/395070), AUC 0.4677833318710327
Test Epoch0 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch0 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch0 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch0 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch0 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch0 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch0 layer6 Acc 0.9980358806139392, AUC 0.9946975708007812
Save ckpt to ./ckpt/mask7//kdd99/kdd99_linearal_l10_m7.pt  ,ep 0
Test Epoch0 layer7 Acc 0.0010529299801563196, AUC 0.42378702759742737
Test Epoch0 layer8 Acc 0.5685720649576803, AUC 0.3403836488723755
Test Epoch0 layer9 Acc 0.00812983436601466, AUC 0.47569921612739563
gc 0
[[4.76674404e+03 2.90965890e+00]
 [2.42027424e-02 1.23399449e+00]
 [1.38307991e-02 7.74806312e-01]
 [2.44375412e-04 3.63827888e-01]
 [2.09785543e-03 2.30936001e-01]
 [6.56155711e-04 1.44513601e-01]
 [4.13989301e-03 1.42459531e-01]
 [8.09416666e+01 7.99412874e+01]
 [1.13021528e+02 9.70628632e+01]
 [1.20413130e+02 9.45796102e+01]]
Train Epoch1 Acc 0.012734452122408688 (5031/395070), AUC 0.42180290818214417
Test Epoch1 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch1 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch1 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch1 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch1 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch1 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch1 layer6 Acc 0.998066253594136, AUC 0.994681179523468
Test Epoch1 layer7 Acc 0.21709593812011502, AUC 0.3365304172039032
Test Epoch1 layer8 Acc 0.5860264042441178, AUC 0.37503108382225037
Test Epoch1 layer9 Acc 0.0011440489207467704, AUC 0.4135255813598633
gc 0
[[4.76675114e+03 2.90917375e+00]
 [2.42028790e-02 1.23387182e+00]
 [1.38278666e-02 7.74787612e-01]
 [2.44378972e-04 3.63834061e-01]
 [2.10106015e-03 2.30938828e-01]
 [6.56488625e-04 1.44518123e-01]
 [3.07225521e-03 1.21804588e-01]
 [7.15269122e+01 6.98867416e+01]
 [1.02978162e+02 8.60391933e+01]
 [1.12600209e+02 8.62695916e+01]]
Train Epoch2 Acc 0.08456476067532336 (33409/395070), AUC 0.4209722578525543
Test Epoch2 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch2 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch2 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch2 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch2 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch2 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch2 layer6 Acc 0.9980865022476005, AUC 0.9953033328056335
Save ckpt to ./ckpt/mask7//kdd99/kdd99_linearal_l10_m7.pt  ,ep 2
Test Epoch2 layer7 Acc 0.21712631110031183, AUC 0.4938575029373169
Test Epoch2 layer8 Acc 0.5691187786012231, AUC 0.3986172378063202
Test Epoch2 layer9 Acc 0.19688778196249948, AUC 0.3719995319843292
gc 0
[[4.76674395e+03 2.90888370e+00]
 [2.42028249e-02 1.23380402e+00]
 [1.38260676e-02 7.74749963e-01]
 [2.44374300e-04 3.63806021e-01]
 [2.09783992e-03 2.30923571e-01]
 [6.56154978e-04 1.44509848e-01]
 [3.19482909e-03 1.06404760e-01]
 [6.33591079e+01 6.24222470e+01]
 [9.39665323e+01 7.88690147e+01]
 [1.07357499e+02 8.20729738e+01]]
Train Epoch3 Acc 0.19687903409522364 (77781/395070), AUC 0.37166687846183777
Test Epoch3 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch3 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch3 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch3 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch3 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch3 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch3 layer6 Acc 0.9980561292674037, AUC 0.9948972463607788
Test Epoch3 layer7 Acc 0.21725792734783136, AUC 0.46100902557373047
Test Epoch3 layer8 Acc 0.5685821892844126, AUC 0.2666531801223755
Test Epoch3 layer9 Acc 0.19693840359616085, AUC 0.395093709230423
gc 0
[[4.76674399e+03 2.90910185e+00]
 [2.42027029e-02 1.23379438e+00]
 [1.38260844e-02 7.74768725e-01]
 [2.44370865e-04 3.63817389e-01]
 [2.09785289e-03 2.30927871e-01]
 [6.56154519e-04 1.44511488e-01]
 [3.35583555e-03 1.02596594e-01]
 [6.03376396e+01 6.05656837e+01]
 [8.97156216e+01 7.53740458e+01]
 [1.03674902e+02 7.95002495e+01]]
Train Epoch4 Acc 0.19687650289822056 (77780/395070), AUC 0.2780349552631378
Test Epoch4 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch4 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch4 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch4 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch4 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch4 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch4 layer6 Acc 0.9980865022476005, AUC 0.9949539303779602
Test Epoch4 layer7 Acc 0.21732879763495727, AUC 0.46953848004341125
Test Epoch4 layer8 Acc 0.5686631838982708, AUC 0.2884542644023895
Test Epoch4 layer9 Acc 0.19697890090308995, AUC 0.27396997809410095
gc 0
[[4.76674394e+03 2.90893140e+00]
 [2.42026903e-02 1.23380633e+00]
 [1.38261076e-02 7.74752611e-01]
 [2.44373920e-04 3.63807308e-01]
 [2.09782966e-03 2.30924140e-01]
 [6.56153261e-04 1.44510302e-01]
 [3.60018527e-03 9.96733051e-02]
 [6.00713419e+01 5.92834895e+01]
 [8.98235375e+01 7.64129412e+01]
 [1.07080666e+02 8.22983502e+01]]
Train Epoch5 Acc 0.19697268838433696 (77818/395070), AUC 0.359538197517395
Test Epoch5 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch5 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch5 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch5 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch5 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch5 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch5 layer6 Acc 0.9980460049406714, AUC 0.9953470826148987
Save ckpt to ./ckpt/mask7//kdd99/kdd99_linearal_l10_m7.pt  ,ep 5
Test Epoch5 layer7 Acc 0.2294577410602195, AUC 0.4958997070789337
Test Epoch5 layer8 Acc 0.5686024379378771, AUC 0.18391436338424683
Test Epoch5 layer9 Acc 0.19697890090308995, AUC 0.4575938880443573
gc 0
[[4.76674404e+03 2.90889995e+00]
 [2.42029036e-02 1.23379578e+00]
 [1.38307447e-02 7.74757803e-01]
 [2.44374837e-04 3.63804052e-01]
 [2.09787514e-03 2.30924086e-01]
 [6.56158136e-04 1.44510154e-01]
 [2.09249014e-03 9.87753511e-02]
 [5.99009362e+01 6.02572315e+01]
 [8.99626406e+01 7.68451717e+01]
 [1.08370240e+02 8.31802267e+01]]
Train Epoch6 Acc 0.19697268838433696 (77818/395070), AUC 0.40194985270500183
Test Epoch6 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch6 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch6 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch6 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch6 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch6 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch6 layer6 Acc 0.9980561292674037, AUC 0.9948432445526123
Test Epoch6 layer7 Acc 0.21760215445672862, AUC 0.5761180520057678
Test Epoch6 layer8 Acc 0.5685923136111448, AUC 0.24071849882602692
Test Epoch6 layer9 Acc 0.19696877657635767, AUC 0.4237327575683594
gc 0
[[4.76674408e+03 2.90893959e+00]
 [2.42030654e-02 1.23385911e+00]
 [1.38266877e-02 7.74788294e-01]
 [2.44456530e-04 3.63814340e-01]
 [2.09853749e-03 2.30930564e-01]
 [6.56178921e-04 1.44514257e-01]
 [3.38470771e-04 9.19138822e-02]
 [5.84468494e+01 5.96672444e+01]
 [8.86743166e+01 7.69985464e+01]
 [1.08406462e+02 8.31830732e+01]]
Train Epoch7 Acc 0.19697268838433696 (77818/395070), AUC 0.42877310514450073
Test Epoch7 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch7 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch7 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch7 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch7 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch7 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch7 layer6 Acc 0.9980460049406714, AUC 0.9951608180999756
Test Epoch7 layer7 Acc 0.7851415380877171, AUC 0.5777223110198975
Test Epoch7 layer8 Acc 0.5685821892844126, AUC 0.2579202353954315
Test Epoch7 layer9 Acc 0.19696877657635767, AUC 0.44758427143096924
gc 0
[[4.76674412e+03 2.90899078e+00]
 [2.42030245e-02 1.23381450e+00]
 [1.38354481e-02 7.74754381e-01]
 [2.44381675e-04 3.63807834e-01]
 [2.09786904e-03 2.30927152e-01]
 [6.56159633e-04 1.44510482e-01]
 [6.32333333e-04 9.29982881e-02]
 [5.95219301e+01 6.05167646e+01]
 [9.01418145e+01 7.78935477e+01]
 [1.10136187e+02 8.41494257e+01]]
Train Epoch8 Acc 0.19696762599033082 (77816/395070), AUC 0.42117878794670105
Test Epoch8 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch8 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch8 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch8 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch8 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch8 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch8 layer6 Acc 0.998066253594136, AUC 0.9951637387275696
Test Epoch8 layer7 Acc 0.7851820353946463, AUC 0.5888801217079163
Test Epoch8 layer8 Acc 0.5685821892844126, AUC 0.2552843987941742
Test Epoch8 layer9 Acc 0.19697890090308995, AUC 0.4288269281387329
gc 0
[[4.76674394e+03 2.90907781e+00]
 [2.42025276e-02 1.23381758e+00]
 [1.38261300e-02 7.74747523e-01]
 [2.44369339e-04 3.63810700e-01]
 [2.09784695e-03 2.30926618e-01]
 [6.56152650e-04 1.44511213e-01]
 [6.16835583e-04 9.29984223e-02]
 [5.89871661e+01 6.04023366e+01]
 [8.98927146e+01 7.74255518e+01]
 [1.10457689e+02 8.38433547e+01]]
Train Epoch9 Acc 0.19697015718733388 (77817/395070), AUC 0.43411099910736084
Test Epoch9 layer0 Acc 0.9958287773863038, AUC 0.9860839247703552
Test Epoch9 layer1 Acc 0.9969323290001215, AUC 0.9955844879150391
Test Epoch9 layer2 Acc 0.9978232697525614, AUC 0.9954952597618103
Test Epoch9 layer3 Acc 0.9979751346535456, AUC 0.9949607253074646
Test Epoch9 layer4 Acc 0.9980156319604746, AUC 0.9951698184013367
Test Epoch9 layer5 Acc 0.9980055076337424, AUC 0.9954582452774048
Test Epoch9 layer6 Acc 0.9980460049406714, AUC 0.9946126937866211
Test Epoch9 layer7 Acc 0.5877475397886041, AUC 0.5808287262916565
Test Epoch9 layer8 Acc 0.5685923136111448, AUC 0.29101213812828064
Test Epoch9 layer9 Acc 0.19697890090308995, AUC 0.4487685263156891
Best AUC 0.9953470826148987
train_loss (2, 10, 10)
valid_acc (10, 10)
valid_AUC (10, 10)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ./ckpt/mask7//kdd99/kdd99_linearal_l10_m7.pt
[[56147     0    11     0     0     0     0     0     0     0     0]
 [    0 21439     2     0     0     0     0     0     0     0     0]
 [   16     1 19416    15     0     4     0     4     0     0     0]
 [    0     0    16   425     0     0     0     0     0     0     0]
 [    5     0    36     0   277     0     0     0     0     0     0]
 [    0     0    30     0     0   219     1     0     0     0     0]
 [    0    24    14     0     0     0   170     0     0     0     0]
 [    0     0   130     0     0     0     0    74     0     0     0]
 [    0     0     3     0     0     0     0     0   193     0     0]
 [    6     3    26     0     0    18     0     0     0     0     0]
 [    0    18    29     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21440     1     0     0     0     0     0     0     0     0]
 [   17     1 19423     7     0     2     0     6     0     0     0]
 [    0     0    12   429     0     0     0     0     0     0     0]
 [    5     0    23     0   290     0     0     0     0     0     0]
 [    0     0    19     0     0   231     0     0     0     0     0]
 [    0     7     6     0     0     0   195     0     0     0     0]
 [    0     0    89     0     0     0     0   115     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [   21    20    11     0     0     0     0     1     0     0     0]
 [   15     1    28     0     0     3     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19420     6     0     2     0     9     0     0     0]
 [    0     0     7   434     0     0     0     0     0     0     0]
 [    5     0    19     0   294     0     0     0     0     0     0]
 [    0     0    12     0     0   238     0     0     0     0     0]
 [    0     5     4     0     0     0   199     0     0     0     0]
 [    0     0    19     0     0     0     0   185     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   49     0     4     0     0     0     0     0     0     0     0]
 [   15     3    28     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19420     5     0     2     0    10     0     0     0]
 [    0     0     6   435     0     0     0     0     0     0     0]
 [    2     0    16     0   300     0     0     0     0     0     0]
 [    0     0     9     0     0   241     0     0     0     0     0]
 [    0     2     4     0     0     0   202     0     0     0     0]
 [    0     0    17     0     0     0     0   187     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [    7    16    29     0     0     0     0     1     0     0     0]
 [    0     3    43     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19421     5     0     2     0     9     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    14     0   302     0     0     0     0     0     0]
 [    2     0     7     0     0   241     0     0     0     0     0]
 [    0     1     4     0     0     0   203     0     0     0     0]
 [    0     0    18     0     0     0     0   186     0     0     0]
 [    3     0     0     0     0     0     0     0   193     0     0]
 [   30    12    11     0     0     0     0     0     0     0     0]
 [   29     3    14     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19422     4     0     2     0     9     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    13     0   303     0     0     0     0     0     0]
 [    2     1     6     0     0   241     0     0     0     0     0]
 [    0     1     4     0     0     0   203     0     0     0     0]
 [    0     0    21     0     0     0     0   183     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [    1    16    36     0     0     0     0     0     0     0     0]
 [   26    11     9     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[56153     0     5     0     0     0     0     0     0     0     0]
 [    0 21441     0     0     0     0     0     0     0     0     0]
 [   18     1 19419     4     1     2     0    11     0     0     0]
 [    0     0     5   436     0     0     0     0     0     0     0]
 [    2     0    11     0   305     0     0     0     0     0     0]
 [    3     0     6     0     0   241     0     0     0     0     0]
 [    0     0     4     0     0     0   204     0     0     0     0]
 [    0     0    17     0     0     0     0   187     0     0     0]
 [    0     2     1     0     0     0     0     0   193     0     0]
 [   14     7    32     0     0     0     0     0     0     0     0]
 [   34     3     9     0     0     1     0     0     0     0     0]]
Figure(640x480)
[[ 2102 54056     0     0     0     0     0     0     0     0     0]
 [  884 20557     0     0     0     0     0     0     0     0     0]
 [19441    10     5     0     0     0     0     0     0     0     0]
 [    3   438     0     0     0     0     0     0     0     0     0]
 [  318     0     0     0     0     0     0     0     0     0     0]
 [    3   245     2     0     0     0     0     0     0     0     0]
 [  208     0     0     0     0     0     0     0     0     0     0]
 [  198     0     6     0     0     0     0     0     0     0     0]
 [    2   194     0     0     0     0     0     0     0     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [    7    40     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[56158     0     0     0     0     0     0     0     0     0     0]
 [21441     0     0     0     0     0     0     0     0     0     0]
 [19452     0     4     0     0     0     0     0     0     0     0]
 [  441     0     0     0     0     0     0     0     0     0     0]
 [   11     0   307     0     0     0     0     0     0     0     0]
 [  250     0     0     0     0     0     0     0     0     0     0]
 [  206     0     2     0     0     0     0     0     0     0     0]
 [  204     0     0     0     0     0     0     0     0     0     0]
 [  196     0     0     0     0     0     0     0     0     0     0]
 [   53     0     0     0     0     0     0     0     0     0     0]
 [   47     0     0     0     0     0     0     0     0     0     0]]
Figure(640x480)
[[    0     0 56158     0     0     0     0     0     0     0     0]
 [    0     0 21441     0     0     0     0     0     0     0     0]
 [    0     0 19456     0     0     0     0     0     0     0     0]
 [    0     0   441     0     0     0     0     0     0     0     0]
 [    0     0   318     0     0     0     0     0     0     0     0]
 [    1     0   249     0     0     0     0     0     0     0     0]
 [    7     0   201     0     0     0     0     0     0     0     0]
 [   39     0   165     0     0     0     0     0     0     0     0]
 [    0     0   196     0     0     0     0     0     0     0     0]
 [    0     0    53     0     0     0     0     0     0     0     0]
 [    0     0    47     0     0     0     0     0     0     0     0]]
Figure(640x480)
