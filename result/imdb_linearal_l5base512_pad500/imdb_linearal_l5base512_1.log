total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 24.484886682000003
Start Training
gc 0
Train Epoch0 Acc 0.502225 (20089/40000), AUC 0.5010241270065308
ep0_train_time 9.208238309000002
Test Epoch0 layer4 Acc 0.5, AUC 0.5136419534683228, avg_entr 0.6581180691719055, f1 0.5
ep0_l4_test_time 0.6895566110000004
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.50005 (20002/40000), AUC 0.5131312012672424
ep1_train_time 7.755589708999999
Test Epoch1 layer4 Acc 0.5124, AUC 0.5929020643234253, avg_entr 0.6828711032867432, f1 0.5123999714851379
ep1_l4_test_time 0.6790592899999979
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.549225 (21969/40000), AUC 0.651746928691864
ep2_train_time 7.692961328999999
Test Epoch2 layer4 Acc 0.6682, AUC 0.7941577434539795, avg_entr 0.6907895803451538, f1 0.6682000160217285
ep2_l4_test_time 0.6849799040000022
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.758775 (30351/40000), AUC 0.8523575067520142
ep3_train_time 7.661240692
Test Epoch3 layer4 Acc 0.7992, AUC 0.9160797595977783, avg_entr 0.6756768822669983, f1 0.7991999983787537
ep3_l4_test_time 0.6739890730000013
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.84565 (33826/40000), AUC 0.9185066223144531
ep4_train_time 7.608984382000003
Test Epoch4 layer4 Acc 0.861, AUC 0.9373939633369446, avg_entr 0.28565630316734314, f1 0.8610000014305115
ep4_l4_test_time 0.6792341919999956
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.8888 (35552/40000), AUC 0.9534152746200562
ep5_train_time 7.608282119000009
Test Epoch5 layer4 Acc 0.8782, AUC 0.9464312195777893, avg_entr 0.24860307574272156, f1 0.8781999945640564
ep5_l4_test_time 0.6674049410000009
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.90185 (36074/40000), AUC 0.9629796743392944
ep6_train_time 7.5322328289999945
Test Epoch6 layer4 Acc 0.8898, AUC 0.951702356338501, avg_entr 0.22739799320697784, f1 0.8898000121116638
ep6_l4_test_time 0.669055911000001
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9138 (36552/40000), AUC 0.9702895879745483
ep7_train_time 7.537932766999987
Test Epoch7 layer4 Acc 0.8876, AUC 0.9549635648727417, avg_entr 0.1998506784439087, f1 0.8876000046730042
ep7_l4_test_time 0.673733912000003
gc 0
Train Epoch8 Acc 0.92375 (36950/40000), AUC 0.975803792476654
ep8_train_time 7.550036585000001
Test Epoch8 layer4 Acc 0.8954, AUC 0.9570463299751282, avg_entr 0.18279188871383667, f1 0.8953999876976013
ep8_l4_test_time 0.668339747999994
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.928725 (37149/40000), AUC 0.9787632822990417
ep9_train_time 7.5476228899999995
Test Epoch9 layer4 Acc 0.896, AUC 0.9585173726081848, avg_entr 0.17051641643047333, f1 0.8960000276565552
ep9_l4_test_time 0.6665576660000028
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.931825 (37273/40000), AUC 0.981037974357605
ep10_train_time 7.425944797
Test Epoch10 layer4 Acc 0.8948, AUC 0.9589869976043701, avg_entr 0.15221285820007324, f1 0.8948000073432922
ep10_l4_test_time 0.6714658199999946
gc 0
Train Epoch11 Acc 0.938425 (37537/40000), AUC 0.98357093334198
ep11_train_time 7.47759017700001
Test Epoch11 layer4 Acc 0.9, AUC 0.9595911502838135, avg_entr 0.13631315529346466, f1 0.8999999761581421
ep11_l4_test_time 0.6744106440000053
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.940925 (37637/40000), AUC 0.9849662184715271
ep12_train_time 7.406302271000001
Test Epoch12 layer4 Acc 0.8958, AUC 0.9598084688186646, avg_entr 0.12716001272201538, f1 0.895799994468689
ep12_l4_test_time 0.6799201169999947
gc 0
Train Epoch13 Acc 0.945075 (37803/40000), AUC 0.9864763021469116
ep13_train_time 7.684099289000017
Test Epoch13 layer4 Acc 0.8974, AUC 0.9596160650253296, avg_entr 0.11173330247402191, f1 0.8974000215530396
ep13_l4_test_time 0.6864263839999865
gc 0
Train Epoch14 Acc 0.948775 (37951/40000), AUC 0.9880322217941284
ep14_train_time 7.7279952039999955
Test Epoch14 layer4 Acc 0.8972, AUC 0.9594821929931641, avg_entr 0.09845583140850067, f1 0.8971999883651733
ep14_l4_test_time 0.6756796930000064
gc 0
Train Epoch15 Acc 0.950425 (38017/40000), AUC 0.9887293577194214
ep15_train_time 7.610906091000004
Test Epoch15 layer4 Acc 0.8966, AUC 0.9592053890228271, avg_entr 0.08783885836601257, f1 0.8966000080108643
ep15_l4_test_time 0.6791865900000005
gc 0
Train Epoch16 Acc 0.95395 (38158/40000), AUC 0.9898703694343567
ep16_train_time 7.642657498999995
Test Epoch16 layer4 Acc 0.8964, AUC 0.9589148759841919, avg_entr 0.07863397896289825, f1 0.896399974822998
ep16_l4_test_time 0.6889908299999945
gc 0
Train Epoch17 Acc 0.95535 (38214/40000), AUC 0.990752637386322
ep17_train_time 7.739503982999992
Test Epoch17 layer4 Acc 0.893, AUC 0.9582903385162354, avg_entr 0.0740622952580452, f1 0.8930000066757202
ep17_l4_test_time 0.6790401209999857
gc 0
Train Epoch18 Acc 0.957725 (38309/40000), AUC 0.991215169429779
ep18_train_time 7.6709560440000075
Test Epoch18 layer4 Acc 0.8952, AUC 0.9574507474899292, avg_entr 0.06749578565359116, f1 0.8952000141143799
ep18_l4_test_time 0.6717507269999885
gc 0
Train Epoch19 Acc 0.95985 (38394/40000), AUC 0.991980791091919
ep19_train_time 7.650562461999982
Test Epoch19 layer4 Acc 0.8882, AUC 0.9565207362174988, avg_entr 0.06498531252145767, f1 0.888200044631958
ep19_l4_test_time 0.6637033899999949
Best AUC tensor(0.9000) 11
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 168.82194841
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8958, AUC 0.95573890209198, avg_entr 0.20700088143348694, f1 0.895799994468689
l0_test_time 0.6602585800000043
gc 0
Test layer1 Acc 0.8966, AUC 0.9559986591339111, avg_entr 0.1870831549167633, f1 0.8966000080108643
l1_test_time 0.6658073289999891
gc 0
Test layer2 Acc 0.8968, AUC 0.9562097787857056, avg_entr 0.17070981860160828, f1 0.8967999815940857
l2_test_time 0.6751182510000149
gc 0
Test layer3 Acc 0.8966, AUC 0.9564616680145264, avg_entr 0.1624421924352646, f1 0.8966000080108643
l3_test_time 0.675281262999988
gc 0
Test layer4 Acc 0.8978, AUC 0.9565869569778442, avg_entr 0.13882717490196228, f1 0.8978000283241272
l4_test_time 0.6760537090000014
gc 0
Test threshold 0.1 Acc 0.8978, AUC 0.9563272595405579, avg_entr 0.21240486204624176, f1 0.8978000283241272
t0.1_test_time 1.004644701999979
gc 0
Test threshold 0.2 Acc 0.8978, AUC 0.9552621245384216, avg_entr 0.22645381093025208, f1 0.8978000283241272
t0.2_test_time 0.9749572730000011
gc 0
Test threshold 0.3 Acc 0.8978, AUC 0.9551833271980286, avg_entr 0.23903173208236694, f1 0.8978000283241272
t0.3_test_time 1.050784981999982
gc 0
Test threshold 0.4 Acc 0.8978, AUC 0.9555874466896057, avg_entr 0.2510279715061188, f1 0.8978000283241272
t0.4_test_time 0.9769162080000058
gc 0
Test threshold 0.5 Acc 0.8978, AUC 0.9553894996643066, avg_entr 0.26275473833084106, f1 0.8978000283241272
t0.5_test_time 0.9518853579999984
gc 0
Test threshold 0.6 Acc 0.8978, AUC 0.9552216529846191, avg_entr 0.27279606461524963, f1 0.8978000283241272
t0.6_test_time 0.9524622540000109
gc 0
Test threshold 0.7 Acc 0.8978, AUC 0.9554437398910522, avg_entr 0.28177300095558167, f1 0.8978000283241272
t0.7_test_time 0.9819411990000049
gc 0
Test threshold 0.8 Acc 0.8978, AUC 0.9554624557495117, avg_entr 0.2893980145454407, f1 0.8978000283241272
t0.8_test_time 1.0486562909999861
gc 0
Test threshold 0.9 Acc 0.8978, AUC 0.9557358026504517, avg_entr 0.2948140501976013, f1 0.8978000283241272
t0.9_test_time 0.9527981640000007
