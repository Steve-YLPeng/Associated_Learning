total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 24.460908087
Start Training
gc 0
Train Epoch0 Acc 0.49875 (19950/40000), AUC 0.49924927949905396
ep0_train_time 8.832887434
Test Epoch0 layer4 Acc 0.5, AUC 0.48809298872947693, avg_entr 0.6815215349197388, f1 0.5
ep0_l4_test_time 0.6682224380000008
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.49895 (19958/40000), AUC 0.5011321306228638
ep1_train_time 7.394944787
Test Epoch1 layer4 Acc 0.4972, AUC 0.5301886796951294, avg_entr 0.6822512745857239, f1 0.49720001220703125
ep1_l4_test_time 0.6828768339999982
gc 0
Train Epoch2 Acc 0.5243 (20972/40000), AUC 0.5860919952392578
ep2_train_time 7.4106971160000015
Test Epoch2 layer4 Acc 0.5682, AUC 0.710745096206665, avg_entr 0.6881669163703918, f1 0.5681999921798706
ep2_l4_test_time 0.6697063040000018
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.7152 (28608/40000), AUC 0.815936267375946
ep3_train_time 7.4529694840000005
Test Epoch3 layer4 Acc 0.7066, AUC 0.9036895036697388, avg_entr 0.673395574092865, f1 0.70660001039505
ep3_l4_test_time 0.6763550980000019
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.845675 (33827/40000), AUC 0.9144447445869446
ep4_train_time 6.8473667180000035
Test Epoch4 layer4 Acc 0.8682, AUC 0.9361793994903564, avg_entr 0.28553926944732666, f1 0.8682000041007996
ep4_l4_test_time 0.6480704330000009
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.886825 (35473/40000), AUC 0.9520958065986633
ep5_train_time 6.8235568169999965
Test Epoch5 layer4 Acc 0.8824, AUC 0.9461058378219604, avg_entr 0.26386454701423645, f1 0.8823999762535095
ep5_l4_test_time 0.6461351240000113
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9047 (36188/40000), AUC 0.9649559259414673
ep6_train_time 7.165801970000004
Test Epoch6 layer4 Acc 0.8846, AUC 0.9516007900238037, avg_entr 0.22335119545459747, f1 0.8845999836921692
ep6_l4_test_time 0.6939814489999918
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.91315 (36526/40000), AUC 0.970267653465271
ep7_train_time 7.859846437999991
Test Epoch7 layer4 Acc 0.8906, AUC 0.9548090696334839, avg_entr 0.20611833035945892, f1 0.8906000256538391
ep7_l4_test_time 0.6807731609999905
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.923075 (36923/40000), AUC 0.9758156538009644
ep8_train_time 7.742432268000002
Test Epoch8 layer4 Acc 0.8926, AUC 0.9567849040031433, avg_entr 0.1834208369255066, f1 0.8925999999046326
ep8_l4_test_time 0.6799049410000038
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.928875 (37155/40000), AUC 0.9789435863494873
ep9_train_time 7.7175869960000085
Test Epoch9 layer4 Acc 0.8976, AUC 0.9581193327903748, avg_entr 0.17009778320789337, f1 0.897599995136261
ep9_l4_test_time 0.6841979799999933
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.933075 (37323/40000), AUC 0.9814379215240479
ep10_train_time 7.676696906000004
Test Epoch10 layer4 Acc 0.8978, AUC 0.9587777853012085, avg_entr 0.15065093338489532, f1 0.8978000283241272
ep10_l4_test_time 0.6689583830000032
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.93895 (37558/40000), AUC 0.9838019609451294
ep11_train_time 7.668814675999997
Test Epoch11 layer4 Acc 0.897, AUC 0.9590808749198914, avg_entr 0.13603568077087402, f1 0.8970000147819519
ep11_l4_test_time 0.6759410899999949
gc 0
Train Epoch12 Acc 0.94245 (37698/40000), AUC 0.9852293729782104
ep12_train_time 7.581876568000013
Test Epoch12 layer4 Acc 0.8954, AUC 0.959013819694519, avg_entr 0.12504594027996063, f1 0.8953999876976013
ep12_l4_test_time 0.6629758330000186
gc 0
Train Epoch13 Acc 0.945325 (37813/40000), AUC 0.9867717623710632
ep13_train_time 7.5196287569999924
Test Epoch13 layer4 Acc 0.8972, AUC 0.9590353965759277, avg_entr 0.11194629967212677, f1 0.8971999883651733
ep13_l4_test_time 0.6750478999999814
gc 0
Train Epoch14 Acc 0.9487 (37948/40000), AUC 0.9879890084266663
ep14_train_time 7.500887938999995
Test Epoch14 layer4 Acc 0.8978, AUC 0.9589143395423889, avg_entr 0.09749317169189453, f1 0.8978000283241272
ep14_l4_test_time 0.6675994299999957
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.950025 (38001/40000), AUC 0.9888144135475159
ep15_train_time 7.4713653590000035
Test Epoch15 layer4 Acc 0.8938, AUC 0.9586193561553955, avg_entr 0.08492853492498398, f1 0.8938000202178955
ep15_l4_test_time 0.6627990549999936
gc 0
Train Epoch16 Acc 0.9533 (38132/40000), AUC 0.9899094104766846
ep16_train_time 7.457808814999993
Test Epoch16 layer4 Acc 0.8982, AUC 0.9582511186599731, avg_entr 0.07846419513225555, f1 0.8981999754905701
ep16_l4_test_time 0.6715839200000175
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 16
gc 0
Train Epoch17 Acc 0.9551 (38204/40000), AUC 0.9907498955726624
ep17_train_time 7.363940915000001
Test Epoch17 layer4 Acc 0.894, AUC 0.9573220014572144, avg_entr 0.0700913667678833, f1 0.8939999938011169
ep17_l4_test_time 0.6609183719999976
gc 0
Train Epoch18 Acc 0.958075 (38323/40000), AUC 0.9913926124572754
ep18_train_time 7.513169801999993
Test Epoch18 layer4 Acc 0.896, AUC 0.9566848278045654, avg_entr 0.0670049712061882, f1 0.8960000276565552
ep18_l4_test_time 0.6671760220000067
gc 0
Train Epoch19 Acc 0.96005 (38402/40000), AUC 0.9921069145202637
ep19_train_time 7.44463216699998
Test Epoch19 layer4 Acc 0.8906, AUC 0.9550793766975403, avg_entr 0.05900324881076813, f1 0.8906000256538391
ep19_l4_test_time 0.6764858370000013
Best AUC tensor(0.8982) 16
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 165.523252037
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.89, AUC 0.9530351758003235, avg_entr 0.1772409826517105, f1 0.8899999856948853
l0_test_time 0.6597125560000165
gc 0
Test layer1 Acc 0.8906, AUC 0.9535529613494873, avg_entr 0.1537829041481018, f1 0.8906000256538391
l1_test_time 0.6828376249999906
gc 0
Test layer2 Acc 0.8902, AUC 0.9539046287536621, avg_entr 0.14490322768688202, f1 0.8902000188827515
l2_test_time 0.6841461990000255
gc 0
Test layer3 Acc 0.8904, AUC 0.954291582107544, avg_entr 0.11682730913162231, f1 0.8903999924659729
l3_test_time 0.6822260099999937
gc 0
Test layer4 Acc 0.8902, AUC 0.9544258713722229, avg_entr 0.08270639926195145, f1 0.8902000188827515
l4_test_time 0.6759471980000171
gc 0
Test threshold 0.1 Acc 0.8902, AUC 0.9506970643997192, avg_entr 0.136795774102211, f1 0.8902000188827515
t0.1_test_time 0.8511031099999968
gc 0
Test threshold 0.2 Acc 0.8902, AUC 0.9500487446784973, avg_entr 0.1554930955171585, f1 0.8902000188827515
t0.2_test_time 0.891029967999998
gc 0
Test threshold 0.3 Acc 0.8902, AUC 0.9508237242698669, avg_entr 0.17425741255283356, f1 0.8902000188827515
t0.3_test_time 0.9157194869999898
gc 0
Test threshold 0.4 Acc 0.8902, AUC 0.9515253901481628, avg_entr 0.1906803399324417, f1 0.8902000188827515
t0.4_test_time 0.9461546999999939
gc 0
Test threshold 0.5 Acc 0.8902, AUC 0.9508607983589172, avg_entr 0.2060951441526413, f1 0.8902000188827515
t0.5_test_time 0.9166928059999861
gc 0
Test threshold 0.6 Acc 0.8902, AUC 0.9515472650527954, avg_entr 0.21981267631053925, f1 0.8902000188827515
t0.6_test_time 0.9019184649999943
gc 0
Test threshold 0.7 Acc 0.8902, AUC 0.9526442885398865, avg_entr 0.23191459476947784, f1 0.8902000188827515
t0.7_test_time 0.9048902490000046
gc 0
Test threshold 0.8 Acc 0.8902, AUC 0.952684760093689, avg_entr 0.24188613891601562, f1 0.8902000188827515
t0.8_test_time 0.986224223000022
gc 0
Test threshold 0.9 Acc 0.8902, AUC 0.952924370765686, avg_entr 0.2502380907535553, f1 0.8902000188827515
t0.9_test_time 0.9672998590000077
