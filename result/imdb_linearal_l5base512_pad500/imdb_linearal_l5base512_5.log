total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 25.260425139000002
Start Training
gc 0
Train Epoch0 Acc 0.50395 (20158/40000), AUC 0.49760007858276367
ep0_train_time 11.216884505000003
Test Epoch0 layer4 Acc 0.5, AUC 0.4665980935096741, avg_entr 0.6924323439598083, f1 0.5
ep0_l4_test_time 0.717923712000001
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.498775 (19951/40000), AUC 0.49458661675453186
ep1_train_time 8.665438285
Test Epoch1 layer4 Acc 0.496, AUC 0.46709951758384705, avg_entr 0.6893255114555359, f1 0.4959999918937683
ep1_l4_test_time 0.6983828040000049
gc 0
Train Epoch2 Acc 0.466075 (18643/40000), AUC 0.4551521837711334
ep2_train_time 8.659567806000005
Test Epoch2 layer4 Acc 0.4896, AUC 0.45237183570861816, avg_entr 0.6930096745491028, f1 0.48959997296333313
ep2_l4_test_time 0.7041304570000051
gc 0
Train Epoch3 Acc 0.56525 (22610/40000), AUC 0.629660964012146
ep3_train_time 8.682502309
Test Epoch3 layer4 Acc 0.7466, AUC 0.9031888842582703, avg_entr 0.6900962591171265, f1 0.7465999126434326
ep3_l4_test_time 0.7182169100000095
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.82845 (33138/40000), AUC 0.9189071655273438
ep4_train_time 8.705485218000007
Test Epoch4 layer4 Acc 0.8576, AUC 0.9353218078613281, avg_entr 0.46434998512268066, f1 0.8575999140739441
ep4_l4_test_time 0.7049163629999953
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.888425 (35537/40000), AUC 0.9516428709030151
ep5_train_time 8.705471009999997
Test Epoch5 layer4 Acc 0.861, AUC 0.9453403949737549, avg_entr 0.2569328844547272, f1 0.8610000014305115
ep5_l4_test_time 0.7126719820000034
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.902425 (36097/40000), AUC 0.9629500508308411
ep6_train_time 8.623463348000001
Test Epoch6 layer4 Acc 0.8776, AUC 0.9511204361915588, avg_entr 0.24407382309436798, f1 0.8776000142097473
ep6_l4_test_time 0.714181283000002
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9125 (36500/40000), AUC 0.9689818620681763
ep7_train_time 8.610008391999997
Test Epoch7 layer4 Acc 0.8924, AUC 0.9546655416488647, avg_entr 0.2138396054506302, f1 0.8923999667167664
ep7_l4_test_time 0.7139541019999882
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.920525 (36821/40000), AUC 0.9746516942977905
ep8_train_time 8.628602772000008
Test Epoch8 layer4 Acc 0.8964, AUC 0.9566568732261658, avg_entr 0.19999158382415771, f1 0.896399974822998
ep8_l4_test_time 0.7131447830000042
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.928525 (37141/40000), AUC 0.9785298109054565
ep9_train_time 8.593504922000008
Test Epoch9 layer4 Acc 0.8884, AUC 0.9577776193618774, avg_entr 0.1782608926296234, f1 0.8884000182151794
ep9_l4_test_time 0.7060702290000052
gc 0
Train Epoch10 Acc 0.932975 (37319/40000), AUC 0.9805275797843933
ep10_train_time 8.583148732000012
Test Epoch10 layer4 Acc 0.9006, AUC 0.9589626789093018, avg_entr 0.16450071334838867, f1 0.900600016117096
ep10_l4_test_time 0.711110122000008
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9381 (37524/40000), AUC 0.9833433628082275
ep11_train_time 8.490027391000012
Test Epoch11 layer4 Acc 0.8998, AUC 0.9593511819839478, avg_entr 0.15097953379154205, f1 0.8998000025749207
ep11_l4_test_time 0.709038669000023
gc 0
Train Epoch12 Acc 0.941825 (37673/40000), AUC 0.9849992990493774
ep12_train_time 8.476142969999984
Test Epoch12 layer4 Acc 0.8984, AUC 0.9596161842346191, avg_entr 0.14058668911457062, f1 0.8984000086784363
ep12_l4_test_time 0.7153708300000119
gc 0
Train Epoch13 Acc 0.9451 (37804/40000), AUC 0.9864220023155212
ep13_train_time 8.51288632699999
Test Epoch13 layer4 Acc 0.891, AUC 0.9597374200820923, avg_entr 0.12953844666481018, f1 0.890999972820282
ep13_l4_test_time 0.7002416719999758
gc 0
Train Epoch14 Acc 0.94645 (37858/40000), AUC 0.9870778322219849
ep14_train_time 8.510945200999998
Test Epoch14 layer4 Acc 0.8986, AUC 0.9594531059265137, avg_entr 0.11230826377868652, f1 0.8985999822616577
ep14_l4_test_time 0.7028456310000024
gc 0
Train Epoch15 Acc 0.951325 (38053/40000), AUC 0.9888626337051392
ep15_train_time 8.412249476999989
Test Epoch15 layer4 Acc 0.8988, AUC 0.9589939117431641, avg_entr 0.10090756416320801, f1 0.8988000154495239
ep15_l4_test_time 0.7224236309999981
gc 0
Train Epoch16 Acc 0.952825 (38113/40000), AUC 0.9898275136947632
ep16_train_time 8.456689866999994
Test Epoch16 layer4 Acc 0.8974, AUC 0.9589359760284424, avg_entr 0.09061174094676971, f1 0.8974000215530396
ep16_l4_test_time 0.7148618029999909
gc 0
Train Epoch17 Acc 0.95475 (38190/40000), AUC 0.9902067184448242
ep17_train_time 8.467342235000018
Test Epoch17 layer4 Acc 0.898, AUC 0.9586624503135681, avg_entr 0.08145604282617569, f1 0.8980000019073486
ep17_l4_test_time 0.7148499900000047
gc 0
Train Epoch18 Acc 0.957675 (38307/40000), AUC 0.9913300275802612
ep18_train_time 8.482471533000023
Test Epoch18 layer4 Acc 0.8964, AUC 0.9577107429504395, avg_entr 0.07411810010671616, f1 0.896399974822998
ep18_l4_test_time 0.7217301359999908
gc 0
Train Epoch19 Acc 0.959675 (38387/40000), AUC 0.9919701814651489
ep19_train_time 8.485102868000013
Test Epoch19 layer4 Acc 0.8942, AUC 0.9574373364448547, avg_entr 0.06893781572580338, f1 0.8942000269889832
ep19_l4_test_time 0.704337191999997
gc 0
Train Epoch20 Acc 0.96085 (38434/40000), AUC 0.9923201203346252
ep20_train_time 8.515046460000008
Test Epoch20 layer4 Acc 0.8936, AUC 0.9558185338973999, avg_entr 0.06509331613779068, f1 0.8935999870300293
ep20_l4_test_time 0.7055900860000008
gc 0
Train Epoch21 Acc 0.962725 (38509/40000), AUC 0.9930281043052673
ep21_train_time 8.386409851999986
Test Epoch21 layer4 Acc 0.8856, AUC 0.954580545425415, avg_entr 0.0633903220295906, f1 0.8855999708175659
ep21_l4_test_time 0.6918402640000068
gc 0
Train Epoch22 Acc 0.9639 (38556/40000), AUC 0.993249773979187
ep22_train_time 8.433890109000004
Test Epoch22 layer4 Acc 0.8896, AUC 0.9531846046447754, avg_entr 0.05781320855021477, f1 0.8895999193191528
ep22_l4_test_time 0.7040933799999891
gc 0
Train Epoch23 Acc 0.9656 (38624/40000), AUC 0.9937676191329956
ep23_train_time 8.39894787900002
Test Epoch23 layer4 Acc 0.8892, AUC 0.9514100551605225, avg_entr 0.05473712086677551, f1 0.88919997215271
ep23_l4_test_time 0.7183335349999993
gc 0
Train Epoch24 Acc 0.96665 (38666/40000), AUC 0.9941378235816956
ep24_train_time 8.396555477000021
Test Epoch24 layer4 Acc 0.887, AUC 0.9494264125823975, avg_entr 0.052251532673835754, f1 0.8870000243186951
ep24_l4_test_time 0.7080416630000173
gc 0
Train Epoch25 Acc 0.967675 (38707/40000), AUC 0.9942032098770142
ep25_train_time 8.399916546999975
Test Epoch25 layer4 Acc 0.8846, AUC 0.9474236369132996, avg_entr 0.049478352069854736, f1 0.8845999836921692
ep25_l4_test_time 0.6966663949999656
gc 0
Train Epoch26 Acc 0.96895 (38758/40000), AUC 0.9947347640991211
ep26_train_time 8.409180590999995
Test Epoch26 layer4 Acc 0.8818, AUC 0.9455376267433167, avg_entr 0.04801230505108833, f1 0.8818000555038452
ep26_l4_test_time 0.7088875779999739
gc 0
Train Epoch27 Acc 0.97025 (38810/40000), AUC 0.9948877096176147
ep27_train_time 8.403001490999998
Test Epoch27 layer4 Acc 0.8844, AUC 0.9429192543029785, avg_entr 0.04642929136753082, f1 0.8844000101089478
ep27_l4_test_time 0.6981902989999753
gc 0
Train Epoch28 Acc 0.970925 (38837/40000), AUC 0.995024561882019
ep28_train_time 8.682520512999986
Test Epoch28 layer4 Acc 0.8816, AUC 0.9408177137374878, avg_entr 0.044844627380371094, f1 0.881600022315979
ep28_l4_test_time 0.7234067459999665
gc 0
Train Epoch29 Acc 0.971825 (38873/40000), AUC 0.9953151941299438
ep29_train_time 8.591869362000011
Test Epoch29 layer4 Acc 0.8782, AUC 0.9393765330314636, avg_entr 0.04503662884235382, f1 0.8781999945640564
ep29_l4_test_time 0.7174723960000051
Best AUC tensor(0.9006) 10
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 281.80940990299996
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8924, AUC 0.9554417133331299, avg_entr 0.22016572952270508, f1 0.8923999667167664
l0_test_time 0.7128941299999951
gc 0
Test layer1 Acc 0.8928, AUC 0.9560421109199524, avg_entr 0.20868328213691711, f1 0.892799973487854
l1_test_time 0.7032625070000336
gc 0
Test layer2 Acc 0.892, AUC 0.9564674496650696, avg_entr 0.18412448465824127, f1 0.8920000195503235
l2_test_time 0.7036451330000091
gc 0
Test layer3 Acc 0.895, AUC 0.9565860033035278, avg_entr 0.18414306640625, f1 0.8949999809265137
l3_test_time 0.724761075999993
gc 0
Test layer4 Acc 0.8942, AUC 0.956456184387207, avg_entr 0.16661086678504944, f1 0.8942000269889832
l4_test_time 0.7005553589999636
gc 0
Test threshold 0.1 Acc 0.8942, AUC 0.9562036991119385, avg_entr 0.24973644316196442, f1 0.8942000269889832
t0.1_test_time 1.5241649129999928
gc 0
Test threshold 0.2 Acc 0.8942, AUC 0.9560481905937195, avg_entr 0.26128676533699036, f1 0.8942000269889832
t0.2_test_time 1.459796400000016
gc 0
Test threshold 0.3 Acc 0.8942, AUC 0.9559425115585327, avg_entr 0.27177223563194275, f1 0.8942000269889832
t0.3_test_time 1.5259078960000352
gc 0
Test threshold 0.4 Acc 0.8942, AUC 0.9556937217712402, avg_entr 0.2803482115268707, f1 0.8942000269889832
t0.4_test_time 1.501246607999974
gc 0
Test threshold 0.5 Acc 0.8942, AUC 0.9557352662086487, avg_entr 0.2892214357852936, f1 0.8942000269889832
t0.5_test_time 1.4709959520000098
gc 0
Test threshold 0.6 Acc 0.8942, AUC 0.9555355906486511, avg_entr 0.29729193449020386, f1 0.8942000269889832
t0.6_test_time 1.48205301400003
gc 0
Test threshold 0.7 Acc 0.8942, AUC 0.9553130865097046, avg_entr 0.30480992794036865, f1 0.8942000269889832
t0.7_test_time 1.560447914000008
gc 0
Test threshold 0.8 Acc 0.8942, AUC 0.9556190967559814, avg_entr 0.310548335313797, f1 0.8942000269889832
t0.8_test_time 1.4649140310000348
gc 0
Test threshold 0.9 Acc 0.8942, AUC 0.9554455280303955, avg_entr 0.3147161900997162, f1 0.8942000269889832
t0.9_test_time 1.5075644869999678
