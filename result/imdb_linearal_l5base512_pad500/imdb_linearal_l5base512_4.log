total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 24.448615879
Start Training
gc 0
Train Epoch0 Acc 0.501 (20040/40000), AUC 0.5021394491195679
ep0_train_time 8.842660936000001
Test Epoch0 layer4 Acc 0.4988, AUC 0.5101353526115417, avg_entr 0.6840483546257019, f1 0.49880000948905945
ep0_l4_test_time 0.6772858579999976
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.499225 (19969/40000), AUC 0.5075892210006714
ep1_train_time 7.449655239000002
Test Epoch1 layer4 Acc 0.4982, AUC 0.5400922298431396, avg_entr 0.6906359195709229, f1 0.498199999332428
ep1_l4_test_time 0.6681948349999942
gc 0
Train Epoch2 Acc 0.523925 (20957/40000), AUC 0.5649243593215942
ep2_train_time 7.607489847000004
Test Epoch2 layer4 Acc 0.6114, AUC 0.6972659826278687, avg_entr 0.6923985481262207, f1 0.6114000082015991
ep2_l4_test_time 0.6841438000000011
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.6807 (27228/40000), AUC 0.7577072381973267
ep3_train_time 7.752307768000001
Test Epoch3 layer4 Acc 0.726, AUC 0.8972670435905457, avg_entr 0.6861814856529236, f1 0.7260000109672546
ep3_l4_test_time 0.6857124809999959
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.829525 (33181/40000), AUC 0.9110128283500671
ep4_train_time 7.685313643999997
Test Epoch4 layer4 Acc 0.8596, AUC 0.9339358806610107, avg_entr 0.38623902201652527, f1 0.8596000075340271
ep4_l4_test_time 0.669417167000006
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.884275 (35371/40000), AUC 0.950187087059021
ep5_train_time 7.697929199000001
Test Epoch5 layer4 Acc 0.8564, AUC 0.944817304611206, avg_entr 0.2557052671909332, f1 0.8564000129699707
ep5_l4_test_time 0.6792116959999959
gc 0
Train Epoch6 Acc 0.8985 (35940/40000), AUC 0.9601759314537048
ep6_train_time 7.628160207999997
Test Epoch6 layer4 Acc 0.8846, AUC 0.9506791830062866, avg_entr 0.22888828814029694, f1 0.8845999836921692
ep6_l4_test_time 0.6628221080000003
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9124 (36496/40000), AUC 0.9694254398345947
ep7_train_time 7.545946301000001
Test Epoch7 layer4 Acc 0.8896, AUC 0.9540584087371826, avg_entr 0.20585724711418152, f1 0.8895999193191528
ep7_l4_test_time 0.690535072000003
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9201 (36804/40000), AUC 0.9739857912063599
ep8_train_time 7.510687636
Test Epoch8 layer4 Acc 0.8926, AUC 0.956185519695282, avg_entr 0.18948481976985931, f1 0.8925999999046326
ep8_l4_test_time 0.6510316699999947
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.92725 (37090/40000), AUC 0.9778091907501221
ep9_train_time 7.375794415999991
Test Epoch9 layer4 Acc 0.8958, AUC 0.9576898813247681, avg_entr 0.17122718691825867, f1 0.895799994468689
ep9_l4_test_time 0.6683447030000025
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.932625 (37305/40000), AUC 0.9806336164474487
ep10_train_time 7.533900775000006
Test Epoch10 layer4 Acc 0.8944, AUC 0.958781361579895, avg_entr 0.1580381989479065, f1 0.8944000005722046
ep10_l4_test_time 0.6825866080000083
gc 0
Train Epoch11 Acc 0.935075 (37403/40000), AUC 0.9820063710212708
ep11_train_time 7.561907661000006
Test Epoch11 layer4 Acc 0.8962, AUC 0.9592964053153992, avg_entr 0.14735989272594452, f1 0.8962000012397766
ep11_l4_test_time 0.6753776630000061
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.940825 (37633/40000), AUC 0.9844648838043213
ep12_train_time 7.498266460000011
Test Epoch12 layer4 Acc 0.8964, AUC 0.9593974947929382, avg_entr 0.1294395923614502, f1 0.896399974822998
ep12_l4_test_time 0.677560638000017
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.942775 (37711/40000), AUC 0.9854453802108765
ep13_train_time 7.544733652000019
Test Epoch13 layer4 Acc 0.8986, AUC 0.9597665071487427, avg_entr 0.1188477873802185, f1 0.8985999822616577
ep13_l4_test_time 0.67685677099999
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.946125 (37845/40000), AUC 0.9870433211326599
ep14_train_time 7.459013409000022
Test Epoch14 layer4 Acc 0.8916, AUC 0.9591066837310791, avg_entr 0.10912895202636719, f1 0.8916000127792358
ep14_l4_test_time 0.6741546160000098
gc 0
Train Epoch15 Acc 0.949675 (37987/40000), AUC 0.98835289478302
ep15_train_time 7.486213101000004
Test Epoch15 layer4 Acc 0.8972, AUC 0.9596966505050659, avg_entr 0.10120325535535812, f1 0.8971999883651733
ep15_l4_test_time 0.671979092999976
gc 0
Train Epoch16 Acc 0.952075 (38083/40000), AUC 0.989326000213623
ep16_train_time 7.45833158100001
Test Epoch16 layer4 Acc 0.8972, AUC 0.9591626524925232, avg_entr 0.08946593850851059, f1 0.8971999883651733
ep16_l4_test_time 0.6660526889999971
gc 0
Train Epoch17 Acc 0.95425 (38170/40000), AUC 0.9900518655776978
ep17_train_time 7.3639107330000115
Test Epoch17 layer4 Acc 0.8988, AUC 0.9590471982955933, avg_entr 0.08175671100616455, f1 0.8988000154495239
ep17_l4_test_time 0.6547558709999919
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 17
gc 0
Train Epoch18 Acc 0.956775 (38271/40000), AUC 0.9909133911132812
ep18_train_time 7.7962247570000045
Test Epoch18 layer4 Acc 0.8954, AUC 0.9580415487289429, avg_entr 0.07274337112903595, f1 0.8953999876976013
ep18_l4_test_time 0.679887328999996
gc 0
Train Epoch19 Acc 0.95825 (38330/40000), AUC 0.9916056990623474
ep19_train_time 7.727488302000012
Test Epoch19 layer4 Acc 0.8962, AUC 0.9577500820159912, avg_entr 0.06791768223047256, f1 0.8962000012397766
ep19_l4_test_time 0.6925994309999908
Best AUC tensor(0.8988) 17
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 167.675007326
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8918, AUC 0.9530532956123352, avg_entr 0.174851194024086, f1 0.8917999863624573
l0_test_time 0.6879536389999998
gc 0
Test layer1 Acc 0.892, AUC 0.9535418748855591, avg_entr 0.15513937175273895, f1 0.8920000195503235
l1_test_time 0.673431211999997
gc 0
Test layer2 Acc 0.8906, AUC 0.9538465738296509, avg_entr 0.1452063024044037, f1 0.8906000256538391
l2_test_time 0.681543511000001
gc 0
Test layer3 Acc 0.8902, AUC 0.9543131589889526, avg_entr 0.12261130660772324, f1 0.8902000188827515
l3_test_time 0.6687186919999988
gc 0
Test layer4 Acc 0.8908, AUC 0.9546038508415222, avg_entr 0.08547326922416687, f1 0.8907999992370605
l4_test_time 0.6847802560000105
gc 0
Test threshold 0.1 Acc 0.8908, AUC 0.9517300724983215, avg_entr 0.13971000909805298, f1 0.8907999992370605
t0.1_test_time 0.9824399590000041
gc 0
Test threshold 0.2 Acc 0.8908, AUC 0.9505255222320557, avg_entr 0.15747418999671936, f1 0.8907999992370605
t0.2_test_time 1.0926300120000008
gc 0
Test threshold 0.3 Acc 0.8908, AUC 0.9507321119308472, avg_entr 0.17511847615242004, f1 0.8907999992370605
t0.3_test_time 1.077234529000009
gc 0
Test threshold 0.4 Acc 0.8908, AUC 0.9511885643005371, avg_entr 0.1909209042787552, f1 0.8907999992370605
t0.4_test_time 0.9657012540000096
gc 0
Test threshold 0.5 Acc 0.8908, AUC 0.9510154128074646, avg_entr 0.20466606318950653, f1 0.8907999992370605
t0.5_test_time 0.9419470349999983
gc 0
Test threshold 0.6 Acc 0.8908, AUC 0.9513672590255737, avg_entr 0.21771737933158875, f1 0.8907999992370605
t0.6_test_time 1.0390676739999947
gc 0
Test threshold 0.7 Acc 0.8908, AUC 0.9521257877349854, avg_entr 0.22949931025505066, f1 0.8907999992370605
t0.7_test_time 0.9643809359999977
gc 0
Test threshold 0.8 Acc 0.8908, AUC 0.9526837468147278, avg_entr 0.2391296625137329, f1 0.8907999992370605
t0.8_test_time 1.0188076999999964
gc 0
Test threshold 0.9 Acc 0.8908, AUC 0.9528480768203735, avg_entr 0.24702754616737366, f1 0.8907999992370605
t0.9_test_time 1.0535461659999896
