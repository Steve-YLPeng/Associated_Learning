total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 24.678620506999998
Start Training
gc 0
Train Epoch0 Acc 0.49875 (19950/40000), AUC 0.5069817304611206
ep0_train_time 9.038465500000001
Test Epoch0 layer4 Acc 0.5, AUC 0.5059861540794373, avg_entr 0.6868200302124023, f1 0.5
ep0_l4_test_time 0.6744834300000022
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.49875 (19950/40000), AUC 0.499305784702301
ep1_train_time 7.447477483999997
Test Epoch1 layer4 Acc 0.5, AUC 0.5027587413787842, avg_entr 0.6984491944313049, f1 0.5
ep1_l4_test_time 0.662659038000001
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.503625 (20145/40000), AUC 0.5136072635650635
ep2_train_time 7.465438401
Test Epoch2 layer4 Acc 0.5188, AUC 0.6296210289001465, avg_entr 0.6925990581512451, f1 0.5188000202178955
ep2_l4_test_time 0.6770838670000003
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.598625 (23945/40000), AUC 0.7500383257865906
ep3_train_time 7.426863851
Test Epoch3 layer4 Acc 0.8022, AUC 0.890164852142334, avg_entr 0.6858884692192078, f1 0.8022000193595886
ep3_l4_test_time 0.6538854260000022
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.830775 (33231/40000), AUC 0.9111933708190918
ep4_train_time 7.421617585999996
Test Epoch4 layer4 Acc 0.8742, AUC 0.9380380511283875, avg_entr 0.384638249874115, f1 0.8741999864578247
ep4_l4_test_time 0.6698501160000063
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.8879 (35516/40000), AUC 0.9520029425621033
ep5_train_time 7.352999119999993
Test Epoch5 layer4 Acc 0.8776, AUC 0.9473543763160706, avg_entr 0.2583469748497009, f1 0.8776000142097473
ep5_l4_test_time 0.6637391339999965
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.905725 (36229/40000), AUC 0.9649112224578857
ep6_train_time 7.322347703999995
Test Epoch6 layer4 Acc 0.8904, AUC 0.9525133967399597, avg_entr 0.23115122318267822, f1 0.8903999924659729
ep6_l4_test_time 0.6599023799999912
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9157 (36628/40000), AUC 0.9716609716415405
ep7_train_time 7.183245747000001
Test Epoch7 layer4 Acc 0.8922, AUC 0.9549501538276672, avg_entr 0.20719176530838013, f1 0.8921999931335449
ep7_l4_test_time 0.6768035440000091
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.924475 (36979/40000), AUC 0.9765894412994385
ep8_train_time 7.755834721999989
Test Epoch8 layer4 Acc 0.895, AUC 0.9572857022285461, avg_entr 0.18672655522823334, f1 0.8949999809265137
ep8_l4_test_time 0.6762503079999931
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.93065 (37226/40000), AUC 0.979792594909668
ep9_train_time 7.783729520999998
Test Epoch9 layer4 Acc 0.8972, AUC 0.9583597183227539, avg_entr 0.17408600449562073, f1 0.8971999883651733
ep9_l4_test_time 0.6781253699999894
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.935275 (37411/40000), AUC 0.9820587635040283
ep10_train_time 7.776310056
Test Epoch10 layer4 Acc 0.8968, AUC 0.9590703845024109, avg_entr 0.15794192254543304, f1 0.8967999815940857
ep10_l4_test_time 0.6811580179999908
gc 0
Train Epoch11 Acc 0.93935 (37574/40000), AUC 0.9841890335083008
ep11_train_time 7.698593371000001
Test Epoch11 layer4 Acc 0.8974, AUC 0.9592124819755554, avg_entr 0.14644157886505127, f1 0.8974000215530396
ep11_l4_test_time 0.6710942820000128
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.943675 (37747/40000), AUC 0.9858274459838867
ep12_train_time 7.661104168999998
Test Epoch12 layer4 Acc 0.9006, AUC 0.9591931104660034, avg_entr 0.1356046199798584, f1 0.900600016117096
ep12_l4_test_time 0.6660692320000123
Save ckpt to ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.947525 (37901/40000), AUC 0.9872891902923584
ep13_train_time 7.624127889000022
Test Epoch13 layer4 Acc 0.9004, AUC 0.9592010974884033, avg_entr 0.1261293888092041, f1 0.9003999829292297
ep13_l4_test_time 0.6728453810000019
gc 0
Train Epoch14 Acc 0.9496 (37984/40000), AUC 0.988251805305481
ep14_train_time 7.595346712000008
Test Epoch14 layer4 Acc 0.8994, AUC 0.9586967825889587, avg_entr 0.11284362524747849, f1 0.8993999361991882
ep14_l4_test_time 0.6623757929999954
gc 0
Train Epoch15 Acc 0.950825 (38033/40000), AUC 0.9890341758728027
ep15_train_time 7.547979369999979
Test Epoch15 layer4 Acc 0.897, AUC 0.9585375785827637, avg_entr 0.10320964455604553, f1 0.8970000147819519
ep15_l4_test_time 0.6515706130000183
gc 0
Train Epoch16 Acc 0.95505 (38202/40000), AUC 0.9902901649475098
ep16_train_time 7.492726575000006
Test Epoch16 layer4 Acc 0.8972, AUC 0.9581600427627563, avg_entr 0.0950913354754448, f1 0.8971999883651733
ep16_l4_test_time 0.6725291439999808
gc 0
Train Epoch17 Acc 0.95665 (38266/40000), AUC 0.9910116791725159
ep17_train_time 7.481909087999981
Test Epoch17 layer4 Acc 0.8918, AUC 0.9571326971054077, avg_entr 0.08515119552612305, f1 0.8917999863624573
ep17_l4_test_time 0.6500394580000091
gc 0
Train Epoch18 Acc 0.959225 (38369/40000), AUC 0.9917837977409363
ep18_train_time 7.434647512000026
Test Epoch18 layer4 Acc 0.895, AUC 0.9570344686508179, avg_entr 0.07943519949913025, f1 0.8949999809265137
ep18_l4_test_time 0.6698737659999949
gc 0
Train Epoch19 Acc 0.9604 (38416/40000), AUC 0.9923368096351624
ep19_train_time 7.418339223000004
Test Epoch19 layer4 Acc 0.8924, AUC 0.9564118981361389, avg_entr 0.07373563200235367, f1 0.8923999667167664
ep19_l4_test_time 0.6545256249999909
Best AUC tensor(0.9006) 12
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 166.94407845
Start Testing
Load ckpt at ckpt/imdb_linearal_l5base512_pad500//imdb_linearal_l5.pt
gc 10
Test layer0 Acc 0.8946, AUC 0.9552354216575623, avg_entr 0.20204851031303406, f1 0.894599974155426
l0_test_time 0.6682016679999947
gc 0
Test layer1 Acc 0.8958, AUC 0.955539345741272, avg_entr 0.18658073246479034, f1 0.895799994468689
l1_test_time 0.656964414000015
gc 0
Test layer2 Acc 0.8964, AUC 0.9557528495788574, avg_entr 0.16849154233932495, f1 0.896399974822998
l2_test_time 0.6681444959999965
gc 0
Test layer3 Acc 0.8954, AUC 0.955856204032898, avg_entr 0.15538328886032104, f1 0.8953999876976013
l3_test_time 0.6752590039999973
gc 0
Test layer4 Acc 0.8946, AUC 0.9560573101043701, avg_entr 0.13908877968788147, f1 0.894599974155426
l4_test_time 0.6752140400000144
gc 0
Test threshold 0.1 Acc 0.8946, AUC 0.9557256698608398, avg_entr 0.2126425802707672, f1 0.894599974155426
t0.1_test_time 0.8568490899999972
gc 0
Test threshold 0.2 Acc 0.8946, AUC 0.9552012085914612, avg_entr 0.22584813833236694, f1 0.894599974155426
t0.2_test_time 0.877854401999997
gc 0
Test threshold 0.3 Acc 0.8946, AUC 0.9549570083618164, avg_entr 0.2376398742198944, f1 0.894599974155426
t0.3_test_time 0.8573295850000022
gc 0
Test threshold 0.4 Acc 0.8946, AUC 0.9550541639328003, avg_entr 0.249182790517807, f1 0.894599974155426
t0.4_test_time 0.8738882970000077
gc 0
Test threshold 0.5 Acc 0.8946, AUC 0.954532265663147, avg_entr 0.26029953360557556, f1 0.894599974155426
t0.5_test_time 0.9476554780000015
gc 0
Test threshold 0.6 Acc 0.8946, AUC 0.9551961421966553, avg_entr 0.2701873183250427, f1 0.894599974155426
t0.6_test_time 0.9493941559999826
gc 0
Test threshold 0.7 Acc 0.8946, AUC 0.9550043940544128, avg_entr 0.27770277857780457, f1 0.894599974155426
t0.7_test_time 0.8645478539999942
gc 0
Test threshold 0.8 Acc 0.8946, AUC 0.9550191164016724, avg_entr 0.28368499875068665, f1 0.894599974155426
t0.8_test_time 0.9595042159999991
gc 0
Test threshold 0.9 Acc 0.8946, AUC 0.9551177620887756, avg_entr 0.2883940041065216, f1 0.894599974155426
t0.9_test_time 0.8966756559999851
