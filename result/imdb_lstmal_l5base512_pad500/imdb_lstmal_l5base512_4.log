total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17264578
init_time 27.063065718
Start Training
gc 0
Train Epoch0 Acc 0.501175 (20047/40000), AUC 0.5014169216156006
ep0_train_time 153.73944828700002
Test Epoch0 layer4 Acc 0.5, AUC 0.4971317648887634, avg_entr 0.6964141726493835, f1 0.5
ep0_l4_test_time 5.27628138
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.498025 (19921/40000), AUC 0.5019204616546631
ep1_train_time 152.786699805
Test Epoch1 layer4 Acc 0.484, AUC 0.485549658536911, avg_entr 0.6922245025634766, f1 0.48399999737739563
ep1_l4_test_time 5.325327300000026
gc 0
Train Epoch2 Acc 0.50165 (20066/40000), AUC 0.5146816968917847
ep2_train_time 152.383790541
Test Epoch2 layer4 Acc 0.5, AUC 0.5794650316238403, avg_entr 0.692923903465271, f1 0.5
ep2_l4_test_time 5.461777471999994
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.61235 (24494/40000), AUC 0.7238656282424927
ep3_train_time 152.91317231
Test Epoch3 layer4 Acc 0.7526, AUC 0.8452469706535339, avg_entr 0.35017263889312744, f1 0.7526000142097473
ep3_l4_test_time 5.4228475970001
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.8196 (32784/40000), AUC 0.8685386180877686
ep4_train_time 153.60276821000002
Test Epoch4 layer4 Acc 0.8284, AUC 0.9001893997192383, avg_entr 0.19545532763004303, f1 0.8284000158309937
ep4_l4_test_time 5.0378583159999835
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.8571 (34284/40000), AUC 0.902839183807373
ep5_train_time 153.77561678900008
Test Epoch5 layer4 Acc 0.8456, AUC 0.9135938286781311, avg_entr 0.11787248402833939, f1 0.8456000089645386
ep5_l4_test_time 5.1914020789999995
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.871825 (34873/40000), AUC 0.914485514163971
ep6_train_time 154.22396964299992
Test Epoch6 layer4 Acc 0.8666, AUC 0.9275572299957275, avg_entr 0.09282389283180237, f1 0.866599977016449
ep6_l4_test_time 5.024099092000142
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.898075 (35923/40000), AUC 0.9440468549728394
ep7_train_time 153.74086213200007
Test Epoch7 layer4 Acc 0.8758, AUC 0.9340570569038391, avg_entr 0.08735071867704391, f1 0.8758000135421753
ep7_l4_test_time 5.1244036139999025
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.89255 (35702/40000), AUC 0.9448329210281372
ep8_train_time 153.474088423
Test Epoch8 layer4 Acc 0.8704, AUC 0.9328391551971436, avg_entr 0.06298431754112244, f1 0.8704000115394592
ep8_l4_test_time 5.164864680000164
gc 0
Train Epoch9 Acc 0.917 (36680/40000), AUC 0.9605326652526855
ep9_train_time 153.159569638
Test Epoch9 layer4 Acc 0.8898, AUC 0.9440940022468567, avg_entr 0.06897415965795517, f1 0.8898000121116638
ep9_l4_test_time 5.288365743999975
Save ckpt to ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt  ,ep 9
gc 0
Train Epoch10 Acc 0.922775 (36911/40000), AUC 0.9688156247138977
ep10_train_time 153.86387808500012
Test Epoch10 layer4 Acc 0.8324, AUC 0.9380943775177002, avg_entr 0.0754786804318428, f1 0.8324000239372253
ep10_l4_test_time 5.268875018000017
gc 0
Train Epoch11 Acc 0.9278 (37112/40000), AUC 0.9695065021514893
ep11_train_time 152.80766641599985
Test Epoch11 layer4 Acc 0.883, AUC 0.9405583143234253, avg_entr 0.04788120836019516, f1 0.8830000162124634
ep11_l4_test_time 5.2907812579999245
gc 0
Train Epoch12 Acc 0.913275 (36531/40000), AUC 0.9537254571914673
ep12_train_time 151.8166860220001
Test Epoch12 layer4 Acc 0.8794, AUC 0.9432955980300903, avg_entr 0.0833512544631958, f1 0.8794000148773193
ep12_l4_test_time 5.42467674999989
gc 0
Train Epoch13 Acc 0.9363 (37452/40000), AUC 0.9760522842407227
ep13_train_time 151.62602777100028
Test Epoch13 layer4 Acc 0.8894, AUC 0.9453089237213135, avg_entr 0.04623163864016533, f1 0.8894000053405762
ep13_l4_test_time 5.402899325999897
gc 0
Train Epoch14 Acc 0.9443 (37772/40000), AUC 0.9820528626441956
ep14_train_time 153.80066982399967
Test Epoch14 layer4 Acc 0.8846, AUC 0.9402713775634766, avg_entr 0.03792080655694008, f1 0.8845999836921692
ep14_l4_test_time 5.037841212999865
gc 0
Train Epoch15 Acc 0.946875 (37875/40000), AUC 0.9841610193252563
ep15_train_time 153.84885817799977
Test Epoch15 layer4 Acc 0.8882, AUC 0.9443641901016235, avg_entr 0.04657352343201637, f1 0.888200044631958
ep15_l4_test_time 5.174763562999942
gc 0
Train Epoch16 Acc 0.948525 (37941/40000), AUC 0.9850813150405884
ep16_train_time 153.8010611159998
Test Epoch16 layer4 Acc 0.886, AUC 0.9435028433799744, avg_entr 0.04208871349692345, f1 0.8859999775886536
ep16_l4_test_time 5.12264153399974
gc 0
Train Epoch17 Acc 0.95215 (38086/40000), AUC 0.9867323637008667
ep17_train_time 154.10784303399987
Test Epoch17 layer4 Acc 0.8794, AUC 0.9409400820732117, avg_entr 0.041004303842782974, f1 0.8794000148773193
ep17_l4_test_time 5.117234481000196
gc 0
Train Epoch18 Acc 0.9541 (38164/40000), AUC 0.9880027174949646
ep18_train_time 154.27923777999968
Test Epoch18 layer4 Acc 0.883, AUC 0.9404439926147461, avg_entr 0.0392749160528183, f1 0.8830000162124634
ep18_l4_test_time 5.190535300000192
gc 0
Train Epoch19 Acc 0.9563 (38252/40000), AUC 0.9890192747116089
ep19_train_time 153.344792159
Test Epoch19 layer4 Acc 0.8834, AUC 0.9410344362258911, avg_entr 0.03709036856889725, f1 0.8834000825881958
ep19_l4_test_time 5.2514626120000685
Best AUC tensor(0.8898) 9
train_loss (2, 5, 20)
valid_acc (1, 20)
valid_AUC (1, 20)
train_acc (20,)
total_train+valid_time 3173.369673352
Start Testing
Load ckpt at ckpt/imdb_lstmal_l5base512_pad500//imdb_lstmal_l5.pt
gc 10
Test layer0 Acc 0.894, AUC 0.9547456502914429, avg_entr 0.23227006196975708, f1 0.8939999938011169
l0_test_time 0.694962612999916
gc 0
Test layer1 Acc 0.8798, AUC 0.9382649064064026, avg_entr 0.09332243353128433, f1 0.879800021648407
l1_test_time 1.604531051000322
gc 0
Test layer2 Acc 0.8838, AUC 0.9399980306625366, avg_entr 0.07817217707633972, f1 0.8838000297546387
l2_test_time 2.8109708380002303
gc 0
Test layer3 Acc 0.8846, AUC 0.9396500587463379, avg_entr 0.07792648673057556, f1 0.8845999836921692
l3_test_time 3.9824613480000153
gc 0
Test layer4 Acc 0.8836, AUC 0.9399665594100952, avg_entr 0.0723877102136612, f1 0.8835999965667725
l4_test_time 5.198299845999827
gc 0
Test threshold 0.1 Acc 0.8848, AUC 0.9375817775726318, avg_entr 0.10355952382087708, f1 0.8848000168800354
t0.1_test_time 2.8900327559999823
gc 0
Test threshold 0.2 Acc 0.8854, AUC 0.9323433637619019, avg_entr 0.11659091711044312, f1 0.8853999972343445
t0.2_test_time 2.53808061799964
gc 0
Test threshold 0.3 Acc 0.8864, AUC 0.9303878545761108, avg_entr 0.13294638693332672, f1 0.8863999843597412
t0.3_test_time 2.389657355000054
gc 0
Test threshold 0.4 Acc 0.8884, AUC 0.928877592086792, avg_entr 0.14755913615226746, f1 0.8884000182151794
t0.4_test_time 2.2689360500003204
gc 0
Test threshold 0.5 Acc 0.8894, AUC 0.9282443523406982, avg_entr 0.16835322976112366, f1 0.8894000053405762
t0.5_test_time 2.1461027069999545
gc 0
Test threshold 0.6 Acc 0.891, AUC 0.9285073280334473, avg_entr 0.19135494530200958, f1 0.890999972820282
t0.6_test_time 2.0850804060000883
gc 0
Test threshold 0.7 Acc 0.8906, AUC 0.9301204681396484, avg_entr 0.21639877557754517, f1 0.8906000256538391
t0.7_test_time 2.0573092170002383
gc 0
Test threshold 0.8 Acc 0.8888, AUC 0.9332773685455322, avg_entr 0.24264265596866608, f1 0.8888000249862671
t0.8_test_time 2.000910225000098
gc 0
Test threshold 0.9 Acc 0.893, AUC 0.9388415813446045, avg_entr 0.27478623390197754, f1 0.8930000066757202
t0.9_test_time 1.8241843870000594
