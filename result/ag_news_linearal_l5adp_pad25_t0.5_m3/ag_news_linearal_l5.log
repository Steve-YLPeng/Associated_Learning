total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.5_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.016383333333333333 (1966/120000), AUC 0.39266252517700195
ep0_train_time 5.374954462051392
Test Epoch0 threshold 0.5 Acc 0.9136513157894737, AUC 0.9808043837547302, avg_entr 0.02560306154191494
ep0_t0.5_test_time 0.07489418983459473
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.5_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.024016666666666665 (2882/120000), AUC 0.39712899923324585
ep1_train_time 4.866929292678833
Test Epoch1 threshold 0.5 Acc 0.9131578947368421, AUC 0.9806802272796631, avg_entr 0.025579728186130524
ep1_t0.5_test_time 0.07287883758544922
gc 0
Train Epoch2 Acc 0.039266666666666665 (4712/120000), AUC 0.4114075303077698
ep2_train_time 4.881406545639038
Test Epoch2 threshold 0.5 Acc 0.9120065789473685, AUC 0.9801493883132935, avg_entr 0.024604549631476402
ep2_t0.5_test_time 0.07249999046325684
gc 0
Train Epoch3 Acc 0.05415 (6498/120000), AUC 0.4260070323944092
ep3_train_time 4.924983978271484
Test Epoch3 threshold 0.5 Acc 0.9116776315789473, AUC 0.9799851775169373, avg_entr 0.025174645707011223
ep3_t0.5_test_time 0.07366013526916504
gc 0
Train Epoch4 Acc 0.07975 (9570/120000), AUC 0.43437331914901733
ep4_train_time 4.846830368041992
Test Epoch4 threshold 0.5 Acc 0.9106907894736842, AUC 0.9797738790512085, avg_entr 0.02491827681660652
ep4_t0.5_test_time 0.07280993461608887
gc 0
Train Epoch5 Acc 0.121775 (14613/120000), AUC 0.43930739164352417
ep5_train_time 4.887071132659912
Test Epoch5 threshold 0.5 Acc 0.9115131578947369, AUC 0.9795308709144592, avg_entr 0.024910947307944298
ep5_t0.5_test_time 0.07344508171081543
gc 0
Train Epoch6 Acc 0.143325 (17199/120000), AUC 0.44882532954216003
ep6_train_time 4.881966590881348
Test Epoch6 threshold 0.5 Acc 0.9103618421052632, AUC 0.9791864156723022, avg_entr 0.0253199003636837
ep6_t0.5_test_time 0.07343220710754395
gc 0
Train Epoch7 Acc 0.14833333333333334 (17800/120000), AUC 0.46634864807128906
ep7_train_time 5.122070550918579
Test Epoch7 threshold 0.5 Acc 0.9100328947368421, AUC 0.97895348072052, avg_entr 0.025356421247124672
ep7_t0.5_test_time 0.07539558410644531
gc 0
Train Epoch8 Acc 0.145075 (17409/120000), AUC 0.49263131618499756
ep8_train_time 5.23239278793335
Test Epoch8 threshold 0.5 Acc 0.9108552631578948, AUC 0.978721022605896, avg_entr 0.025199541822075844
ep8_t0.5_test_time 0.07560300827026367
gc 0
Train Epoch9 Acc 0.14308333333333334 (17170/120000), AUC 0.5120106339454651
ep9_train_time 5.120150804519653
Test Epoch9 threshold 0.5 Acc 0.9101973684210526, AUC 0.978604257106781, avg_entr 0.02519899606704712
ep9_t0.5_test_time 0.07334446907043457
Best AUC 0.9808043837547302
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.5_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.5 Acc 0.9217105263157894, AUC 0.9852066040039062, avg_entr 0.02733410708606243
t0.5_test_time 0.01965785026550293
