total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 56.46377396583557
Start Training
gc 0
Train Epoch0 Acc 0.8682910714285714 (486243/560000), AUC 0.9839985966682434
ep0_train_time 109.04357933998108
Test Epoch0 layer0 Acc 0.9725142857142857, AUC 0.9981282353401184, avg_entr 0.084972083568573, f1 0.972514271736145
ep0_l0_test_time 2.3254241943359375
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9724285714285714, AUC 0.9980188012123108, avg_entr 0.08381034433841705, f1 0.972428560256958
ep0_l1_test_time 2.2948131561279297
Test Epoch0 layer2 Acc 0.9729428571428571, AUC 0.9982170462608337, avg_entr 0.07501869648694992, f1 0.9729428291320801
ep0_l2_test_time 2.34694242477417
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9732, AUC 0.9983851313591003, avg_entr 0.06872417777776718, f1 0.9732000231742859
ep0_l3_test_time 2.3488056659698486
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
Test Epoch0 layer4 Acc 0.9730285714285715, AUC 0.9984596967697144, avg_entr 0.062406014651060104, f1 0.9730286002159119
ep0_l4_test_time 2.341525077819824
gc 0
Train Epoch1 Acc 0.9776410714285714 (547479/560000), AUC 0.9986700415611267
ep1_train_time 105.75861644744873
Test Epoch1 layer0 Acc 0.9733714285714286, AUC 0.9983230233192444, avg_entr 0.04658513143658638, f1 0.9733714461326599
ep1_l0_test_time 2.0069801807403564
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9738, AUC 0.9983052611351013, avg_entr 0.04400593042373657, f1 0.973800003528595
ep1_l1_test_time 2.2326953411102295
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9742285714285714, AUC 0.9985050559043884, avg_entr 0.03521730378270149, f1 0.97422856092453
ep1_l2_test_time 2.297492265701294
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9742857142857143, AUC 0.9985979199409485, avg_entr 0.029031474143266678, f1 0.9742856621742249
ep1_l3_test_time 2.3414719104766846
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.9751714285714286, AUC 0.9983686804771423, avg_entr 0.022938473150134087, f1 0.9751714468002319
ep1_l4_test_time 2.3261563777923584
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9795857142857143 (548568/560000), AUC 0.9985543489456177
ep2_train_time 105.86395692825317
Test Epoch2 layer0 Acc 0.9736857142857143, AUC 0.9983521699905396, avg_entr 0.03354918211698532, f1 0.9736857414245605
ep2_l0_test_time 2.3211352825164795
Test Epoch2 layer1 Acc 0.9738571428571429, AUC 0.9983946681022644, avg_entr 0.030886223539710045, f1 0.9738571643829346
ep2_l1_test_time 2.3046677112579346
Test Epoch2 layer2 Acc 0.9745142857142857, AUC 0.9986251592636108, avg_entr 0.022461608052253723, f1 0.9745143055915833
ep2_l2_test_time 2.3092594146728516
Test Epoch2 layer3 Acc 0.9755142857142857, AUC 0.9985542893409729, avg_entr 0.016680551692843437, f1 0.97551429271698
ep2_l3_test_time 2.3368399143218994
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.976, AUC 0.997969925403595, avg_entr 0.012051394209265709, f1 0.9760000109672546
ep2_l4_test_time 2.0296528339385986
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9805196428571429 (549091/560000), AUC 0.9984996914863586
ep3_train_time 105.66678214073181
Test Epoch3 layer0 Acc 0.9743714285714286, AUC 0.9983352422714233, avg_entr 0.027107831090688705, f1 0.9743714332580566
ep3_l0_test_time 2.3193423748016357
Test Epoch3 layer1 Acc 0.9748857142857142, AUC 0.9984156489372253, avg_entr 0.024172468110919, f1 0.9748857021331787
ep3_l1_test_time 2.2813382148742676
Test Epoch3 layer2 Acc 0.9750285714285715, AUC 0.9985628128051758, avg_entr 0.016551584005355835, f1 0.9750285744667053
ep3_l2_test_time 2.330360174179077
Test Epoch3 layer3 Acc 0.9756571428571429, AUC 0.9983062744140625, avg_entr 0.011386155150830746, f1 0.9756571650505066
ep3_l3_test_time 2.3044509887695312
Test Epoch3 layer4 Acc 0.976, AUC 0.9977402091026306, avg_entr 0.008449588902294636, f1 0.9760000109672546
ep3_l4_test_time 2.338076114654541
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9810339285714286 (549379/560000), AUC 0.9985197186470032
ep4_train_time 105.32294940948486
Test Epoch4 layer0 Acc 0.9744857142857143, AUC 0.9983843564987183, avg_entr 0.026164185255765915, f1 0.9744856953620911
ep4_l0_test_time 2.2489099502563477
Test Epoch4 layer1 Acc 0.975, AUC 0.9985036253929138, avg_entr 0.02169702760875225, f1 0.9750000238418579
ep4_l1_test_time 2.310811758041382
Test Epoch4 layer2 Acc 0.9761714285714286, AUC 0.9985652565956116, avg_entr 0.014066261239349842, f1 0.9761714339256287
ep4_l2_test_time 2.3013460636138916
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
Test Epoch4 layer3 Acc 0.9764571428571429, AUC 0.9981349110603333, avg_entr 0.009153441525995731, f1 0.9764571189880371
ep4_l3_test_time 2.3028998374938965
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
Test Epoch4 layer4 Acc 0.9765428571428572, AUC 0.9976338148117065, avg_entr 0.006957928650081158, f1 0.9765428304672241
ep4_l4_test_time 2.345383882522583
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9815357142857143 (549660/560000), AUC 0.9985941052436829
ep5_train_time 105.42488718032837
Test Epoch5 layer0 Acc 0.9743714285714286, AUC 0.9984016418457031, avg_entr 0.0245759729295969, f1 0.9743714332580566
ep5_l0_test_time 2.29586124420166
Test Epoch5 layer1 Acc 0.9748571428571429, AUC 0.998565137386322, avg_entr 0.019327852874994278, f1 0.9748571515083313
ep5_l1_test_time 2.3253767490386963
Test Epoch5 layer2 Acc 0.9768285714285714, AUC 0.9984704852104187, avg_entr 0.012014942243695259, f1 0.9768285751342773
ep5_l2_test_time 2.3224079608917236
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
Test Epoch5 layer3 Acc 0.977, AUC 0.9979079365730286, avg_entr 0.00791086908429861, f1 0.9769999980926514
ep5_l3_test_time 2.3426029682159424
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
Test Epoch5 layer4 Acc 0.9769714285714286, AUC 0.9975065588951111, avg_entr 0.0061258794739842415, f1 0.976971447467804
ep5_l4_test_time 2.3155877590179443
gc 0
Train Epoch6 Acc 0.9823071428571428 (550092/560000), AUC 0.9986777305603027
ep6_train_time 105.39714980125427
Test Epoch6 layer0 Acc 0.9745142857142857, AUC 0.9983967542648315, avg_entr 0.024760954082012177, f1 0.9745143055915833
ep6_l0_test_time 2.296144962310791
Test Epoch6 layer1 Acc 0.9754571428571429, AUC 0.9986153244972229, avg_entr 0.018087903037667274, f1 0.9754571318626404
ep6_l1_test_time 2.3063600063323975
Test Epoch6 layer2 Acc 0.9769714285714286, AUC 0.9983764886856079, avg_entr 0.010502566583454609, f1 0.976971447467804
ep6_l2_test_time 2.299210548400879
Test Epoch6 layer3 Acc 0.9767714285714286, AUC 0.9978020787239075, avg_entr 0.0070420303381979465, f1 0.9767714142799377
ep6_l3_test_time 2.3602488040924072
Test Epoch6 layer4 Acc 0.9770285714285715, AUC 0.9974020719528198, avg_entr 0.005677316803485155, f1 0.9770285487174988
ep6_l4_test_time 2.3554022312164307
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9825589285714286 (550233/560000), AUC 0.9987155199050903
ep7_train_time 105.96090197563171
Test Epoch7 layer0 Acc 0.9744285714285714, AUC 0.998400092124939, avg_entr 0.024477237835526466, f1 0.9744285941123962
ep7_l0_test_time 2.321518898010254
Test Epoch7 layer1 Acc 0.9754285714285714, AUC 0.9986346960067749, avg_entr 0.016769535839557648, f1 0.975428581237793
ep7_l1_test_time 2.3011021614074707
Test Epoch7 layer2 Acc 0.9768285714285714, AUC 0.9982661008834839, avg_entr 0.009738931432366371, f1 0.9768285751342773
ep7_l2_test_time 2.274775743484497
Test Epoch7 layer3 Acc 0.9766285714285714, AUC 0.9978528022766113, avg_entr 0.006546971388161182, f1 0.9766285419464111
ep7_l3_test_time 2.0419790744781494
Test Epoch7 layer4 Acc 0.977, AUC 0.997397243976593, avg_entr 0.005301218014210463, f1 0.9769999980926514
ep7_l4_test_time 2.0542216300964355
gc 0
Train Epoch8 Acc 0.9827464285714286 (550338/560000), AUC 0.9987626075744629
ep8_train_time 106.11650228500366
Test Epoch8 layer0 Acc 0.9744, AUC 0.9984070658683777, avg_entr 0.02446085587143898, f1 0.974399983882904
ep8_l0_test_time 2.296097755432129
Test Epoch8 layer1 Acc 0.9756571428571429, AUC 0.9986740946769714, avg_entr 0.01583145372569561, f1 0.9756571650505066
ep8_l1_test_time 2.3209686279296875
Test Epoch8 layer2 Acc 0.9768285714285714, AUC 0.9982367157936096, avg_entr 0.00917794182896614, f1 0.9768285751342773
ep8_l2_test_time 2.311600923538208
Test Epoch8 layer3 Acc 0.9768857142857142, AUC 0.9978933334350586, avg_entr 0.006233041174709797, f1 0.9768857359886169
ep8_l3_test_time 2.3134398460388184
Test Epoch8 layer4 Acc 0.9770857142857143, AUC 0.9975131154060364, avg_entr 0.004992233589291573, f1 0.9770857095718384
ep8_l4_test_time 2.3559563159942627
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9829410714285715 (550447/560000), AUC 0.9987117052078247
ep9_train_time 105.3894591331482
Test Epoch9 layer0 Acc 0.9747428571428571, AUC 0.9984166026115417, avg_entr 0.024205928668379784, f1 0.9747428297996521
ep9_l0_test_time 2.3238449096679688
Test Epoch9 layer1 Acc 0.9762571428571428, AUC 0.9986709356307983, avg_entr 0.014948300085961819, f1 0.9762571454048157
ep9_l1_test_time 2.3182969093322754
Test Epoch9 layer2 Acc 0.9766571428571429, AUC 0.9982412457466125, avg_entr 0.008748135529458523, f1 0.9766571521759033
ep9_l2_test_time 2.2821898460388184
Test Epoch9 layer3 Acc 0.9768857142857142, AUC 0.9979256391525269, avg_entr 0.006186612416058779, f1 0.9768857359886169
ep9_l3_test_time 2.3366878032684326
Test Epoch9 layer4 Acc 0.9768, AUC 0.997529923915863, avg_entr 0.004855401813983917, f1 0.9768000245094299
ep9_l4_test_time 2.3195931911468506
gc 0
Train Epoch10 Acc 0.9833803571428571 (550693/560000), AUC 0.9987818002700806
ep10_train_time 105.41910910606384
Test Epoch10 layer0 Acc 0.9743714285714286, AUC 0.9983972907066345, avg_entr 0.024033432826399803, f1 0.9743714332580566
ep10_l0_test_time 2.3090014457702637
Test Epoch10 layer1 Acc 0.9765142857142857, AUC 0.9986154437065125, avg_entr 0.014048425480723381, f1 0.9765142798423767
ep10_l1_test_time 2.302610158920288
Test Epoch10 layer2 Acc 0.9770285714285715, AUC 0.9981394410133362, avg_entr 0.00827811099588871, f1 0.9770285487174988
ep10_l2_test_time 2.335977077484131
Test Epoch10 layer3 Acc 0.9772285714285714, AUC 0.997748851776123, avg_entr 0.005728834308683872, f1 0.977228581905365
ep10_l3_test_time 2.294330596923828
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 10
Test Epoch10 layer4 Acc 0.9773714285714286, AUC 0.9973500967025757, avg_entr 0.0045044939033687115, f1 0.9773714542388916
ep10_l4_test_time 2.3284106254577637
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9834839285714285 (550751/560000), AUC 0.9987748861312866
ep11_train_time 105.34424567222595
Test Epoch11 layer0 Acc 0.9745428571428572, AUC 0.9984062314033508, avg_entr 0.024018894881010056, f1 0.9745428562164307
ep11_l0_test_time 2.293287515640259
Test Epoch11 layer1 Acc 0.977, AUC 0.9985714554786682, avg_entr 0.013515572063624859, f1 0.9769999980926514
ep11_l1_test_time 2.301279067993164
Test Epoch11 layer2 Acc 0.9771142857142857, AUC 0.9981549382209778, avg_entr 0.008171035908162594, f1 0.9771142601966858
ep11_l2_test_time 2.326765298843384
Test Epoch11 layer3 Acc 0.9771142857142857, AUC 0.9978858232498169, avg_entr 0.005794145632535219, f1 0.9771142601966858
ep11_l3_test_time 2.3400092124938965
Test Epoch11 layer4 Acc 0.977, AUC 0.9975590705871582, avg_entr 0.004477063659578562, f1 0.9769999980926514
ep11_l4_test_time 2.28617787361145
gc 0
Train Epoch12 Acc 0.9835321428571429 (550778/560000), AUC 0.9988042712211609
ep12_train_time 75.96852254867554
Test Epoch12 layer0 Acc 0.9744, AUC 0.9984117150306702, avg_entr 0.024009699001908302, f1 0.974399983882904
ep12_l0_test_time 2.309818744659424
Test Epoch12 layer1 Acc 0.9769428571428571, AUC 0.9985799789428711, avg_entr 0.013082362711429596, f1 0.9769428372383118
ep12_l1_test_time 2.289900541305542
Test Epoch12 layer2 Acc 0.9772571428571428, AUC 0.9981522560119629, avg_entr 0.008057759143412113, f1 0.9772571325302124
ep12_l2_test_time 2.2969939708709717
Test Epoch12 layer3 Acc 0.977, AUC 0.9978267550468445, avg_entr 0.005638254340738058, f1 0.9769999980926514
ep12_l3_test_time 2.3451054096221924
Test Epoch12 layer4 Acc 0.9769714285714286, AUC 0.9975112676620483, avg_entr 0.004506085067987442, f1 0.976971447467804
ep12_l4_test_time 2.3105177879333496
gc 0
Train Epoch13 Acc 0.9836321428571428 (550834/560000), AUC 0.9987782835960388
ep13_train_time 106.20954084396362
Test Epoch13 layer0 Acc 0.9747428571428571, AUC 0.9984137415885925, avg_entr 0.024010546505451202, f1 0.9747428297996521
ep13_l0_test_time 2.3222010135650635
Test Epoch13 layer1 Acc 0.9770285714285715, AUC 0.9985860586166382, avg_entr 0.01275547593832016, f1 0.9770285487174988
ep13_l1_test_time 1.9891269207000732
Test Epoch13 layer2 Acc 0.9773142857142857, AUC 0.998207151889801, avg_entr 0.00782109797000885, f1 0.977314293384552
ep13_l2_test_time 2.0483689308166504
Test Epoch13 layer3 Acc 0.9771428571428571, AUC 0.9978498220443726, avg_entr 0.005511646158993244, f1 0.977142870426178
ep13_l3_test_time 2.3430399894714355
Test Epoch13 layer4 Acc 0.9770571428571428, AUC 0.9975379109382629, avg_entr 0.004398991819471121, f1 0.977057158946991
ep13_l4_test_time 2.305298328399658
gc 0
Train Epoch14 Acc 0.9838339285714286 (550947/560000), AUC 0.998792290687561
ep14_train_time 106.17304944992065
Test Epoch14 layer0 Acc 0.9746571428571429, AUC 0.9984105229377747, avg_entr 0.023968655616044998, f1 0.9746571183204651
ep14_l0_test_time 2.2803561687469482
Test Epoch14 layer1 Acc 0.9768571428571429, AUC 0.9985499382019043, avg_entr 0.01265344675630331, f1 0.9768571257591248
ep14_l1_test_time 2.340672254562378
Test Epoch14 layer2 Acc 0.9772, AUC 0.9981600046157837, avg_entr 0.00770464725792408, f1 0.977199912071228
ep14_l2_test_time 2.3016443252563477
Test Epoch14 layer3 Acc 0.9770285714285715, AUC 0.9979243278503418, avg_entr 0.0054645901545882225, f1 0.9770285487174988
ep14_l3_test_time 2.331101894378662
Test Epoch14 layer4 Acc 0.977, AUC 0.9975438117980957, avg_entr 0.004319333471357822, f1 0.9769999980926514
ep14_l4_test_time 2.3657405376434326
gc 0
Train Epoch15 Acc 0.9839125 (550991/560000), AUC 0.998784601688385
ep15_train_time 105.5040032863617
Test Epoch15 layer0 Acc 0.9745714285714285, AUC 0.998408317565918, avg_entr 0.024001862853765488, f1 0.9745714068412781
ep15_l0_test_time 2.3548805713653564
Test Epoch15 layer1 Acc 0.9771428571428571, AUC 0.9985186457633972, avg_entr 0.012264418415725231, f1 0.977142870426178
ep15_l1_test_time 2.28363299369812
Test Epoch15 layer2 Acc 0.9773428571428572, AUC 0.998138964176178, avg_entr 0.00749333156272769, f1 0.9773428440093994
ep15_l2_test_time 2.3313820362091064
Test Epoch15 layer3 Acc 0.9771428571428571, AUC 0.9977918863296509, avg_entr 0.0053198207169771194, f1 0.977142870426178
ep15_l3_test_time 2.3432445526123047
Test Epoch15 layer4 Acc 0.977, AUC 0.9974306225776672, avg_entr 0.00418119179084897, f1 0.9769999980926514
ep15_l4_test_time 2.3176066875457764
gc 0
Train Epoch16 Acc 0.9839321428571428 (551002/560000), AUC 0.9988146424293518
ep16_train_time 105.54254221916199
Test Epoch16 layer0 Acc 0.9747142857142858, AUC 0.9984082579612732, avg_entr 0.024029703810811043, f1 0.9747142791748047
ep16_l0_test_time 2.267157554626465
Test Epoch16 layer1 Acc 0.9772, AUC 0.9985321164131165, avg_entr 0.01212603971362114, f1 0.977199912071228
ep16_l1_test_time 2.3461480140686035
Test Epoch16 layer2 Acc 0.9772571428571428, AUC 0.9981333613395691, avg_entr 0.007419603411108255, f1 0.9772571325302124
ep16_l2_test_time 2.2974164485931396
Test Epoch16 layer3 Acc 0.9770571428571428, AUC 0.9977877736091614, avg_entr 0.005311275832355022, f1 0.977057158946991
ep16_l3_test_time 2.321570634841919
Test Epoch16 layer4 Acc 0.977, AUC 0.9974292516708374, avg_entr 0.004278868902474642, f1 0.9769999980926514
ep16_l4_test_time 2.3492591381073
gc 0
Train Epoch17 Acc 0.9840035714285714 (551042/560000), AUC 0.9987871050834656
ep17_train_time 105.57919311523438
Test Epoch17 layer0 Acc 0.9744285714285714, AUC 0.9984042048454285, avg_entr 0.023859458044171333, f1 0.9744285941123962
ep17_l0_test_time 2.3340444564819336
Test Epoch17 layer1 Acc 0.9772285714285714, AUC 0.9985120892524719, avg_entr 0.011987918056547642, f1 0.977228581905365
ep17_l1_test_time 2.29119873046875
Test Epoch17 layer2 Acc 0.9773142857142857, AUC 0.9981385469436646, avg_entr 0.007396729197353125, f1 0.977314293384552
ep17_l2_test_time 2.312664031982422
Test Epoch17 layer3 Acc 0.9768857142857142, AUC 0.9977830052375793, avg_entr 0.005311963614076376, f1 0.9768857359886169
ep17_l3_test_time 2.3146533966064453
Test Epoch17 layer4 Acc 0.9771142857142857, AUC 0.997408390045166, avg_entr 0.004297703504562378, f1 0.9771142601966858
ep17_l4_test_time 2.332667589187622
gc 0
Train Epoch18 Acc 0.9841392857142857 (551118/560000), AUC 0.9987789392471313
ep18_train_time 105.82572484016418
Test Epoch18 layer0 Acc 0.9746857142857143, AUC 0.9984068274497986, avg_entr 0.023883149027824402, f1 0.9746857285499573
ep18_l0_test_time 1.985729694366455
Test Epoch18 layer1 Acc 0.9773142857142857, AUC 0.9985215067863464, avg_entr 0.011878659948706627, f1 0.977314293384552
ep18_l1_test_time 2.1872081756591797
Test Epoch18 layer2 Acc 0.9772285714285714, AUC 0.9981513619422913, avg_entr 0.007308734580874443, f1 0.977228581905365
ep18_l2_test_time 2.336956262588501
Test Epoch18 layer3 Acc 0.977, AUC 0.9978305101394653, avg_entr 0.005254495423287153, f1 0.9769999980926514
ep18_l3_test_time 2.3070638179779053
Test Epoch18 layer4 Acc 0.9770571428571428, AUC 0.9974644780158997, avg_entr 0.00421808660030365, f1 0.977057158946991
ep18_l4_test_time 2.321237087249756
gc 0
Train Epoch19 Acc 0.9841125 (551103/560000), AUC 0.9987884759902954
ep19_train_time 106.04543447494507
Test Epoch19 layer0 Acc 0.9746, AUC 0.9984080195426941, avg_entr 0.02382882870733738, f1 0.9746000170707703
ep19_l0_test_time 2.2820651531219482
Test Epoch19 layer1 Acc 0.9771714285714286, AUC 0.998507022857666, avg_entr 0.01176249235868454, f1 0.9771714210510254
ep19_l1_test_time 2.3150947093963623
Test Epoch19 layer2 Acc 0.9774571428571428, AUC 0.9981467127799988, avg_entr 0.0072571951895952225, f1 0.9774571657180786
ep19_l2_test_time 2.293351650238037
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 19
Test Epoch19 layer3 Acc 0.9770857142857143, AUC 0.9978570342063904, avg_entr 0.005228377878665924, f1 0.9770857095718384
ep19_l3_test_time 2.3200294971466064
Test Epoch19 layer4 Acc 0.9771142857142857, AUC 0.9974892735481262, avg_entr 0.004242917522788048, f1 0.9771142601966858
ep19_l4_test_time 2.1289424896240234
gc 0
Train Epoch20 Acc 0.9841232142857143 (551109/560000), AUC 0.9987966418266296
ep20_train_time 105.84177732467651
Test Epoch20 layer0 Acc 0.9744857142857143, AUC 0.998405396938324, avg_entr 0.023937691003084183, f1 0.9744856953620911
ep20_l0_test_time 2.293785572052002
Test Epoch20 layer1 Acc 0.9772571428571428, AUC 0.9984866380691528, avg_entr 0.011720019392669201, f1 0.9772571325302124
ep20_l1_test_time 2.322805643081665
Test Epoch20 layer2 Acc 0.9774, AUC 0.9981128573417664, avg_entr 0.007226353045552969, f1 0.977400004863739
ep20_l2_test_time 2.2975618839263916
Test Epoch20 layer3 Acc 0.9771142857142857, AUC 0.9977824091911316, avg_entr 0.005205783061683178, f1 0.9771142601966858
ep20_l3_test_time 2.3238799571990967
Test Epoch20 layer4 Acc 0.9772, AUC 0.9973796606063843, avg_entr 0.004265070892870426, f1 0.977199912071228
ep20_l4_test_time 2.2931127548217773
gc 0
Train Epoch21 Acc 0.9841375 (551117/560000), AUC 0.9987984895706177
ep21_train_time 105.44674134254456
Test Epoch21 layer0 Acc 0.9745428571428572, AUC 0.9984064698219299, avg_entr 0.023865649476647377, f1 0.9745428562164307
ep21_l0_test_time 2.3098952770233154
Test Epoch21 layer1 Acc 0.9774, AUC 0.998487114906311, avg_entr 0.011710665188729763, f1 0.977400004863739
ep21_l1_test_time 2.3093833923339844
Test Epoch21 layer2 Acc 0.9774571428571428, AUC 0.9981085658073425, avg_entr 0.007145068142563105, f1 0.9774571657180786
ep21_l2_test_time 2.2918860912323
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 21
Test Epoch21 layer3 Acc 0.9772571428571428, AUC 0.9977902770042419, avg_entr 0.005169583484530449, f1 0.9772571325302124
ep21_l3_test_time 2.318631887435913
Test Epoch21 layer4 Acc 0.9772857142857143, AUC 0.9974237680435181, avg_entr 0.0041649662889540195, f1 0.9772857427597046
ep21_l4_test_time 2.3556649684906006
gc 0
Train Epoch22 Acc 0.9842410714285714 (551175/560000), AUC 0.9987929463386536
ep22_train_time 105.45137691497803
Test Epoch22 layer0 Acc 0.9745714285714285, AUC 0.9984050989151001, avg_entr 0.0237849410623312, f1 0.9745714068412781
ep22_l0_test_time 2.266867160797119
Test Epoch22 layer1 Acc 0.9774285714285714, AUC 0.9984908103942871, avg_entr 0.011647776700556278, f1 0.9774284958839417
ep22_l1_test_time 2.315747022628784
Test Epoch22 layer2 Acc 0.9773714285714286, AUC 0.9981234669685364, avg_entr 0.007097129710018635, f1 0.9773714542388916
ep22_l2_test_time 2.296468734741211
Test Epoch22 layer3 Acc 0.9771428571428571, AUC 0.997789740562439, avg_entr 0.0051450240425765514, f1 0.977142870426178
ep22_l3_test_time 2.337280035018921
Test Epoch22 layer4 Acc 0.9771714285714286, AUC 0.9974731802940369, avg_entr 0.004113928880542517, f1 0.9771714210510254
ep22_l4_test_time 2.3435308933258057
gc 0
Train Epoch23 Acc 0.9842642857142857 (551188/560000), AUC 0.9987969398498535
ep23_train_time 105.58059811592102
Test Epoch23 layer0 Acc 0.9745714285714285, AUC 0.9984040260314941, avg_entr 0.023884141817688942, f1 0.9745714068412781
ep23_l0_test_time 2.282475709915161
Test Epoch23 layer1 Acc 0.9774571428571428, AUC 0.9984902143478394, avg_entr 0.01166698057204485, f1 0.9774571657180786
ep23_l1_test_time 2.311290740966797
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 23
Test Epoch23 layer2 Acc 0.9772, AUC 0.9981307983398438, avg_entr 0.007123897783458233, f1 0.977199912071228
ep23_l2_test_time 2.330502510070801
Test Epoch23 layer3 Acc 0.9772285714285714, AUC 0.9978243708610535, avg_entr 0.00516242953017354, f1 0.977228581905365
ep23_l3_test_time 2.303924322128296
Test Epoch23 layer4 Acc 0.9772571428571428, AUC 0.9975098371505737, avg_entr 0.004145284648984671, f1 0.9772571325302124
ep23_l4_test_time 2.3291447162628174
gc 0
Train Epoch24 Acc 0.9842178571428571 (551162/560000), AUC 0.998794674873352
ep24_train_time 105.97894096374512
Test Epoch24 layer0 Acc 0.9745142857142857, AUC 0.9984043836593628, avg_entr 0.023903250694274902, f1 0.9745143055915833
ep24_l0_test_time 2.2948920726776123
Test Epoch24 layer1 Acc 0.9774571428571428, AUC 0.9984822273254395, avg_entr 0.011574135161936283, f1 0.9774571657180786
ep24_l1_test_time 2.333235740661621
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 24
Test Epoch24 layer2 Acc 0.9774, AUC 0.9981149435043335, avg_entr 0.007084639277309179, f1 0.977400004863739
ep24_l2_test_time 2.2573695182800293
Test Epoch24 layer3 Acc 0.9771428571428571, AUC 0.9977858662605286, avg_entr 0.0051312437281012535, f1 0.977142870426178
ep24_l3_test_time 2.044419288635254
Test Epoch24 layer4 Acc 0.9773142857142857, AUC 0.9974383115768433, avg_entr 0.0041396841406822205, f1 0.977314293384552
ep24_l4_test_time 2.157539129257202
gc 0
Train Epoch25 Acc 0.9842732142857142 (551193/560000), AUC 0.9987933039665222
ep25_train_time 106.016033411026
Test Epoch25 layer0 Acc 0.9745428571428572, AUC 0.998404324054718, avg_entr 0.023817962035536766, f1 0.9745428562164307
ep25_l0_test_time 2.2788949012756348
Test Epoch25 layer1 Acc 0.9774285714285714, AUC 0.9984857439994812, avg_entr 0.011562490835785866, f1 0.9774284958839417
ep25_l1_test_time 2.3284547328948975
Test Epoch25 layer2 Acc 0.9772857142857143, AUC 0.9981183409690857, avg_entr 0.007087805308401585, f1 0.9772857427597046
ep25_l2_test_time 2.3281707763671875
Test Epoch25 layer3 Acc 0.9769428571428571, AUC 0.9978107810020447, avg_entr 0.005121411755681038, f1 0.9769428372383118
ep25_l3_test_time 2.2919983863830566
Test Epoch25 layer4 Acc 0.9772, AUC 0.9974890947341919, avg_entr 0.0041181063279509544, f1 0.977199912071228
ep25_l4_test_time 2.3425445556640625
gc 0
Train Epoch26 Acc 0.9843 (551208/560000), AUC 0.9987925291061401
ep26_train_time 105.54499292373657
Test Epoch26 layer0 Acc 0.9745428571428572, AUC 0.9984064102172852, avg_entr 0.023872338235378265, f1 0.9745428562164307
ep26_l0_test_time 2.3273141384124756
Test Epoch26 layer1 Acc 0.9775428571428572, AUC 0.9984841346740723, avg_entr 0.011569330468773842, f1 0.9775428771972656
ep26_l1_test_time 2.3060250282287598
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 26
Test Epoch26 layer2 Acc 0.9772857142857143, AUC 0.9981268644332886, avg_entr 0.007094800006598234, f1 0.9772857427597046
ep26_l2_test_time 2.3140382766723633
Test Epoch26 layer3 Acc 0.9771428571428571, AUC 0.9977989196777344, avg_entr 0.0051525007002055645, f1 0.977142870426178
ep26_l3_test_time 2.3243815898895264
Test Epoch26 layer4 Acc 0.9772571428571428, AUC 0.9974715113639832, avg_entr 0.004138294141739607, f1 0.9772571325302124
ep26_l4_test_time 2.340507984161377
gc 0
Train Epoch27 Acc 0.9842875 (551201/560000), AUC 0.9987936019897461
ep27_train_time 105.59140276908875
Test Epoch27 layer0 Acc 0.9745428571428572, AUC 0.9984021782875061, avg_entr 0.023873263970017433, f1 0.9745428562164307
ep27_l0_test_time 2.329437017440796
Test Epoch27 layer1 Acc 0.9774571428571428, AUC 0.9984733462333679, avg_entr 0.011524698697030544, f1 0.9774571657180786
ep27_l1_test_time 2.2724692821502686
Test Epoch27 layer2 Acc 0.9773428571428572, AUC 0.9981186985969543, avg_entr 0.007075494155287743, f1 0.9773428440093994
ep27_l2_test_time 2.3391053676605225
Test Epoch27 layer3 Acc 0.9772285714285714, AUC 0.9977846145629883, avg_entr 0.005158803891390562, f1 0.977228581905365
ep27_l3_test_time 2.3325304985046387
Test Epoch27 layer4 Acc 0.9772571428571428, AUC 0.9974338412284851, avg_entr 0.0041748411022126675, f1 0.9772571325302124
ep27_l4_test_time 2.3217833042144775
gc 0
Train Epoch28 Acc 0.9842946428571429 (551205/560000), AUC 0.9987945556640625
ep28_train_time 105.49901390075684
Test Epoch28 layer0 Acc 0.9745428571428572, AUC 0.9984053373336792, avg_entr 0.023808931931853294, f1 0.9745428562164307
ep28_l0_test_time 2.3359012603759766
Test Epoch28 layer1 Acc 0.9774571428571428, AUC 0.9984850883483887, avg_entr 0.01148055400699377, f1 0.9774571657180786
ep28_l1_test_time 2.277461051940918
Test Epoch28 layer2 Acc 0.9774, AUC 0.99811851978302, avg_entr 0.007041322533041239, f1 0.977400004863739
ep28_l2_test_time 2.323702096939087
Test Epoch28 layer3 Acc 0.9770857142857143, AUC 0.9977864623069763, avg_entr 0.005112210288643837, f1 0.9770857095718384
ep28_l3_test_time 2.3241193294525146
Test Epoch28 layer4 Acc 0.9773428571428572, AUC 0.9974451065063477, avg_entr 0.0041559734381735325, f1 0.9773428440093994
ep28_l4_test_time 2.3200013637542725
gc 0
Train Epoch29 Acc 0.9843160714285715 (551217/560000), AUC 0.9987926483154297
ep29_train_time 105.98994565010071
Test Epoch29 layer0 Acc 0.9746, AUC 0.9984036087989807, avg_entr 0.023812197148799896, f1 0.9746000170707703
ep29_l0_test_time 2.284904718399048
Test Epoch29 layer1 Acc 0.9774857142857143, AUC 0.9984791874885559, avg_entr 0.011497502215206623, f1 0.977485716342926
ep29_l1_test_time 2.0781705379486084
Test Epoch29 layer2 Acc 0.9773428571428572, AUC 0.998110830783844, avg_entr 0.007049864623695612, f1 0.9773428440093994
ep29_l2_test_time 2.0033226013183594
Test Epoch29 layer3 Acc 0.9770857142857143, AUC 0.9977781176567078, avg_entr 0.0051178946159780025, f1 0.9770857095718384
ep29_l3_test_time 2.221764087677002
Test Epoch29 layer4 Acc 0.9773142857142857, AUC 0.9974265694618225, avg_entr 0.004150897730141878, f1 0.977314293384552
ep29_l4_test_time 2.2866950035095215
Best AUC tensor(0.9775) 26 1
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 3491.3265187740326
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt
Test layer0 Acc 0.9742, AUC 0.9983159303665161, avg_entr 0.02359500527381897, f1 0.9742000102996826
l0_test_time 2.2819178104400635
Test layer1 Acc 0.9772571428571428, AUC 0.9984423518180847, avg_entr 0.012277140282094479, f1 0.9772571325302124
l1_test_time 2.3176841735839844
Test layer2 Acc 0.9778285714285714, AUC 0.9983264803886414, avg_entr 0.007227903697639704, f1 0.9778285622596741
l2_test_time 2.3104395866394043
Test layer3 Acc 0.9780285714285715, AUC 0.9980443120002747, avg_entr 0.005293902475386858, f1 0.9780285954475403
l3_test_time 2.310844898223877
Test layer4 Acc 0.9778857142857142, AUC 0.9978262186050415, avg_entr 0.004301672335714102, f1 0.9778857231140137
l4_test_time 2.344423770904541
