total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 57.045589208602905
Start Training
gc 0
Train Epoch0 Acc 0.8775589285714286 (491433/560000), AUC 0.9855642318725586
ep0_train_time 105.40158700942993
Test Epoch0 layer0 Acc 0.9720571428571428, AUC 0.9982194900512695, avg_entr 0.08624090254306793, f1 0.9720571637153625
ep0_l0_test_time 2.103879928588867
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9722, AUC 0.9980600476264954, avg_entr 0.08508317917585373, f1 0.9721999764442444
ep0_l1_test_time 2.125182628631592
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9728, AUC 0.9983068108558655, avg_entr 0.07561492174863815, f1 0.9728000164031982
ep0_l2_test_time 2.1797924041748047
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9734571428571429, AUC 0.9984464645385742, avg_entr 0.06763282418251038, f1 0.9734571576118469
ep0_l3_test_time 2.1589012145996094
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
Test Epoch0 layer4 Acc 0.9734285714285714, AUC 0.9984827041625977, avg_entr 0.0605342760682106, f1 0.9734285473823547
ep0_l4_test_time 2.1676299571990967
gc 0
Train Epoch1 Acc 0.9777303571428572 (547529/560000), AUC 0.9986668825149536
ep1_train_time 102.19972443580627
Test Epoch1 layer0 Acc 0.9739142857142857, AUC 0.998388409614563, avg_entr 0.0464508980512619, f1 0.9739142656326294
ep1_l0_test_time 2.122804641723633
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9742, AUC 0.9983215928077698, avg_entr 0.04434356093406677, f1 0.9742000102996826
ep1_l1_test_time 2.134878158569336
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9750857142857143, AUC 0.9985842108726501, avg_entr 0.03510989993810654, f1 0.9750857353210449
ep1_l2_test_time 2.1406173706054688
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9754285714285714, AUC 0.9986568093299866, avg_entr 0.028823357075452805, f1 0.975428581237793
ep1_l3_test_time 2.13787579536438
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.9755428571428572, AUC 0.9984965920448303, avg_entr 0.022597717121243477, f1 0.9755428433418274
ep1_l4_test_time 2.2088911533355713
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9795446428571428 (548545/560000), AUC 0.9985821843147278
ep2_train_time 103.48802423477173
Test Epoch2 layer0 Acc 0.9734857142857143, AUC 0.9984257817268372, avg_entr 0.033339399844408035, f1 0.9734857678413391
ep2_l0_test_time 2.1474106311798096
Test Epoch2 layer1 Acc 0.9742285714285714, AUC 0.998428225517273, avg_entr 0.030897093936800957, f1 0.97422856092453
ep2_l1_test_time 2.1645336151123047
Test Epoch2 layer2 Acc 0.9752, AUC 0.9986911416053772, avg_entr 0.022457676008343697, f1 0.9751999974250793
ep2_l2_test_time 2.1563029289245605
Test Epoch2 layer3 Acc 0.9752285714285714, AUC 0.9985572695732117, avg_entr 0.016917776316404343, f1 0.9752285480499268
ep2_l3_test_time 2.1667072772979736
Test Epoch2 layer4 Acc 0.9756285714285714, AUC 0.9980977773666382, avg_entr 0.011910778470337391, f1 0.9756285548210144
ep2_l4_test_time 2.1604602336883545
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9806125 (549143/560000), AUC 0.9984664916992188
ep3_train_time 102.1017415523529
Test Epoch3 layer0 Acc 0.9740571428571428, AUC 0.9984323382377625, avg_entr 0.02689344249665737, f1 0.974057137966156
ep3_l0_test_time 2.1617085933685303
Test Epoch3 layer1 Acc 0.9750285714285715, AUC 0.9984544515609741, avg_entr 0.024033237248659134, f1 0.9750285744667053
ep3_l1_test_time 2.132922649383545
Test Epoch3 layer2 Acc 0.9762571428571428, AUC 0.9987112283706665, avg_entr 0.016716744750738144, f1 0.9762571454048157
ep3_l2_test_time 2.1191930770874023
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.9764, AUC 0.9983792304992676, avg_entr 0.01114541757851839, f1 0.9764000177383423
ep3_l3_test_time 2.1256988048553467
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.9760857142857143, AUC 0.9979235529899597, avg_entr 0.008174775168299675, f1 0.9760857224464417
ep3_l4_test_time 2.1704230308532715
gc 0
Train Epoch4 Acc 0.9812107142857143 (549478/560000), AUC 0.9985990524291992
ep4_train_time 102.15249919891357
Test Epoch4 layer0 Acc 0.9738571428571429, AUC 0.9984690546989441, avg_entr 0.025344040244817734, f1 0.9738571643829346
ep4_l0_test_time 2.2952609062194824
Test Epoch4 layer1 Acc 0.9743428571428572, AUC 0.9985352754592896, avg_entr 0.021350005641579628, f1 0.9743428826332092
ep4_l1_test_time 2.184908628463745
Test Epoch4 layer2 Acc 0.9761142857142857, AUC 0.9986587762832642, avg_entr 0.014513039961457253, f1 0.9761142730712891
ep4_l2_test_time 2.1676623821258545
Test Epoch4 layer3 Acc 0.9762285714285714, AUC 0.9981196522712708, avg_entr 0.008701547048985958, f1 0.9762285947799683
ep4_l3_test_time 2.1615424156188965
Test Epoch4 layer4 Acc 0.9763428571428572, AUC 0.9979289770126343, avg_entr 0.006612209603190422, f1 0.9763428568840027
ep4_l4_test_time 2.271381378173828
gc 0
Train Epoch5 Acc 0.9816232142857143 (549709/560000), AUC 0.9986690282821655
ep5_train_time 102.04018998146057
Test Epoch5 layer0 Acc 0.9742285714285714, AUC 0.9984921216964722, avg_entr 0.024441227316856384, f1 0.97422856092453
ep5_l0_test_time 2.161573886871338
Test Epoch5 layer1 Acc 0.9750285714285715, AUC 0.9985910654067993, avg_entr 0.01935381256043911, f1 0.9750285744667053
ep5_l1_test_time 2.135732889175415
Test Epoch5 layer2 Acc 0.9768857142857142, AUC 0.9986380338668823, avg_entr 0.01220854464918375, f1 0.9768857359886169
ep5_l2_test_time 2.1463680267333984
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
Test Epoch5 layer3 Acc 0.9768, AUC 0.9979955554008484, avg_entr 0.007534474600106478, f1 0.9768000245094299
ep5_l3_test_time 2.144141912460327
Test Epoch5 layer4 Acc 0.9767428571428571, AUC 0.997861921787262, avg_entr 0.005897622089833021, f1 0.9767428636550903
ep5_l4_test_time 2.1436402797698975
gc 0
Train Epoch6 Acc 0.9820107142857143 (549926/560000), AUC 0.9987722635269165
ep6_train_time 103.25768566131592
Test Epoch6 layer0 Acc 0.9740571428571428, AUC 0.9984598159790039, avg_entr 0.023995308205485344, f1 0.974057137966156
ep6_l0_test_time 2.1319522857666016
Test Epoch6 layer1 Acc 0.9743714285714286, AUC 0.9985493421554565, avg_entr 0.017736205831170082, f1 0.9743714332580566
ep6_l1_test_time 2.1572132110595703
Test Epoch6 layer2 Acc 0.9763428571428572, AUC 0.9985164999961853, avg_entr 0.010802505537867546, f1 0.9763428568840027
ep6_l2_test_time 2.1733901500701904
Test Epoch6 layer3 Acc 0.9768285714285714, AUC 0.9980141520500183, avg_entr 0.006973095703870058, f1 0.9768285751342773
ep6_l3_test_time 2.2228503227233887
Test Epoch6 layer4 Acc 0.9768, AUC 0.9979604482650757, avg_entr 0.005487502086907625, f1 0.9768000245094299
ep6_l4_test_time 2.182620048522949
gc 0
Train Epoch7 Acc 0.9824357142857143 (550164/560000), AUC 0.998814582824707
ep7_train_time 101.98603582382202
Test Epoch7 layer0 Acc 0.9748, AUC 0.9984563589096069, avg_entr 0.024045320227742195, f1 0.9747999906539917
ep7_l0_test_time 2.1294591426849365
Test Epoch7 layer1 Acc 0.9754285714285714, AUC 0.9985094666481018, avg_entr 0.016389111056923866, f1 0.975428581237793
ep7_l1_test_time 2.1496613025665283
Test Epoch7 layer2 Acc 0.9768, AUC 0.9984196424484253, avg_entr 0.0096978098154068, f1 0.9768000245094299
ep7_l2_test_time 2.203409194946289
Test Epoch7 layer3 Acc 0.9770571428571428, AUC 0.9979050755500793, avg_entr 0.006455238442867994, f1 0.977057158946991
ep7_l3_test_time 2.167154312133789
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
Test Epoch7 layer4 Acc 0.9772571428571428, AUC 0.9978163838386536, avg_entr 0.005037415307015181, f1 0.9772571325302124
ep7_l4_test_time 2.1587677001953125
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9827446428571428 (550337/560000), AUC 0.9988556504249573
ep8_train_time 102.52548217773438
Test Epoch8 layer0 Acc 0.9742571428571428, AUC 0.9985083341598511, avg_entr 0.023503342643380165, f1 0.9742571711540222
ep8_l0_test_time 2.1426165103912354
Test Epoch8 layer1 Acc 0.9754857142857143, AUC 0.9985545873641968, avg_entr 0.015413396060466766, f1 0.9754857420921326
ep8_l1_test_time 2.1397669315338135
Test Epoch8 layer2 Acc 0.9768285714285714, AUC 0.9983667731285095, avg_entr 0.008956783451139927, f1 0.9768285751342773
ep8_l2_test_time 2.1516339778900146
Test Epoch8 layer3 Acc 0.9769428571428571, AUC 0.9979230165481567, avg_entr 0.005998043809086084, f1 0.9769428372383118
ep8_l3_test_time 2.2347240447998047
Test Epoch8 layer4 Acc 0.9768285714285714, AUC 0.9979139566421509, avg_entr 0.004687576089054346, f1 0.9768285751342773
ep8_l4_test_time 2.211522102355957
gc 0
Train Epoch9 Acc 0.9828767857142857 (550411/560000), AUC 0.9988577961921692
ep9_train_time 102.11682176589966
Test Epoch9 layer0 Acc 0.9739714285714286, AUC 0.9984778165817261, avg_entr 0.023284131661057472, f1 0.973971426486969
ep9_l0_test_time 2.1517229080200195
Test Epoch9 layer1 Acc 0.9758571428571429, AUC 0.9985103011131287, avg_entr 0.014746624045073986, f1 0.975857138633728
ep9_l1_test_time 2.1813809871673584
Test Epoch9 layer2 Acc 0.9767142857142858, AUC 0.9982901811599731, avg_entr 0.008578731678426266, f1 0.9767143130302429
ep9_l2_test_time 2.1593029499053955
Test Epoch9 layer3 Acc 0.9772, AUC 0.9979891180992126, avg_entr 0.006064787972718477, f1 0.977199912071228
ep9_l3_test_time 2.131425380706787
Test Epoch9 layer4 Acc 0.9772285714285714, AUC 0.9979131817817688, avg_entr 0.004590797703713179, f1 0.977228581905365
ep9_l4_test_time 2.1570053100585938
gc 0
Train Epoch10 Acc 0.9835232142857143 (550773/560000), AUC 0.9989060759544373
ep10_train_time 103.22485518455505
Test Epoch10 layer0 Acc 0.9742285714285714, AUC 0.998476505279541, avg_entr 0.023167842999100685, f1 0.97422856092453
ep10_l0_test_time 2.1225426197052
Test Epoch10 layer1 Acc 0.9760857142857143, AUC 0.9985073208808899, avg_entr 0.014363610185682774, f1 0.9760857224464417
ep10_l1_test_time 2.1365463733673096
Test Epoch10 layer2 Acc 0.9768285714285714, AUC 0.9982463717460632, avg_entr 0.008418314158916473, f1 0.9768285751342773
ep10_l2_test_time 2.167247772216797
Test Epoch10 layer3 Acc 0.9772, AUC 0.9979433417320251, avg_entr 0.005969721358269453, f1 0.977199912071228
ep10_l3_test_time 2.222254991531372
Test Epoch10 layer4 Acc 0.9774285714285714, AUC 0.9978346228599548, avg_entr 0.004321848973631859, f1 0.9774284958839417
ep10_l4_test_time 2.1197049617767334
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9836142857142857 (550824/560000), AUC 0.9989266395568848
ep11_train_time 102.041921377182
Test Epoch11 layer0 Acc 0.9743428571428572, AUC 0.9984825253486633, avg_entr 0.02321612276136875, f1 0.9743428826332092
ep11_l0_test_time 2.099337100982666
Test Epoch11 layer1 Acc 0.9764285714285714, AUC 0.9984971880912781, avg_entr 0.014046602882444859, f1 0.9764285683631897
ep11_l1_test_time 2.202270984649658
Test Epoch11 layer2 Acc 0.9773714285714286, AUC 0.9982283711433411, avg_entr 0.008245454169809818, f1 0.9773714542388916
ep11_l2_test_time 2.1234562397003174
Test Epoch11 layer3 Acc 0.9772571428571428, AUC 0.9979620575904846, avg_entr 0.00578733067959547, f1 0.9772571325302124
ep11_l3_test_time 2.20639705657959
Test Epoch11 layer4 Acc 0.9774, AUC 0.9979130625724792, avg_entr 0.004235241562128067, f1 0.977400004863739
ep11_l4_test_time 2.1544015407562256
gc 0
Train Epoch12 Acc 0.9837107142857143 (550878/560000), AUC 0.9989355206489563
ep12_train_time 102.0128722190857
Test Epoch12 layer0 Acc 0.9743714285714286, AUC 0.9984667897224426, avg_entr 0.022862011566758156, f1 0.9743714332580566
ep12_l0_test_time 2.0951004028320312
Test Epoch12 layer1 Acc 0.9762857142857143, AUC 0.9984954595565796, avg_entr 0.013582744635641575, f1 0.9762856960296631
ep12_l1_test_time 2.137263298034668
Test Epoch12 layer2 Acc 0.9772, AUC 0.9982109069824219, avg_entr 0.008222594857215881, f1 0.977199912071228
ep12_l2_test_time 2.124203681945801
Test Epoch12 layer3 Acc 0.9772571428571428, AUC 0.9979549050331116, avg_entr 0.005538623780012131, f1 0.9772571325302124
ep12_l3_test_time 2.1975765228271484
Test Epoch12 layer4 Acc 0.9771428571428571, AUC 0.997772753238678, avg_entr 0.004074226599186659, f1 0.977142870426178
ep12_l4_test_time 2.180940628051758
gc 0
Train Epoch13 Acc 0.983775 (550914/560000), AUC 0.9989226460456848
ep13_train_time 102.61401867866516
Test Epoch13 layer0 Acc 0.9744857142857143, AUC 0.9984760880470276, avg_entr 0.023123150691390038, f1 0.9744856953620911
ep13_l0_test_time 2.1542913913726807
Test Epoch13 layer1 Acc 0.9767428571428571, AUC 0.9984908699989319, avg_entr 0.013507022522389889, f1 0.9767428636550903
ep13_l1_test_time 2.1316111087799072
Test Epoch13 layer2 Acc 0.9773142857142857, AUC 0.9981979727745056, avg_entr 0.007951504550874233, f1 0.977314293384552
ep13_l2_test_time 2.1055591106414795
Test Epoch13 layer3 Acc 0.9774285714285714, AUC 0.9979246258735657, avg_entr 0.005509498994797468, f1 0.9774284958839417
ep13_l3_test_time 2.144012451171875
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 13
Test Epoch13 layer4 Acc 0.9775142857142857, AUC 0.9978105425834656, avg_entr 0.004026379436254501, f1 0.9775142669677734
ep13_l4_test_time 2.24560546875
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 13
gc 0
Train Epoch14 Acc 0.9841696428571428 (551135/560000), AUC 0.9989498257637024
ep14_train_time 103.03891158103943
Test Epoch14 layer0 Acc 0.9742571428571428, AUC 0.9984649419784546, avg_entr 0.023023517802357674, f1 0.9742571711540222
ep14_l0_test_time 2.0917530059814453
Test Epoch14 layer1 Acc 0.9770857142857143, AUC 0.9984818696975708, avg_entr 0.013340671546757221, f1 0.9770857095718384
ep14_l1_test_time 2.1710431575775146
Test Epoch14 layer2 Acc 0.9774285714285714, AUC 0.9982122182846069, avg_entr 0.00793591607362032, f1 0.9774284958839417
ep14_l2_test_time 2.116056442260742
Test Epoch14 layer3 Acc 0.9776, AUC 0.9979073405265808, avg_entr 0.005475984420627356, f1 0.9775999784469604
ep14_l3_test_time 2.1340391635894775
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 14
Test Epoch14 layer4 Acc 0.9774857142857143, AUC 0.9977987408638, avg_entr 0.0039640143513679504, f1 0.977485716342926
ep14_l4_test_time 2.249408483505249
gc 0
Train Epoch15 Acc 0.9841553571428572 (551127/560000), AUC 0.9989615678787231
ep15_train_time 101.74187469482422
Test Epoch15 layer0 Acc 0.9743428571428572, AUC 0.9984728097915649, avg_entr 0.02300330251455307, f1 0.9743428826332092
ep15_l0_test_time 2.108168363571167
Test Epoch15 layer1 Acc 0.9767714285714286, AUC 0.9984843134880066, avg_entr 0.013193811289966106, f1 0.9767714142799377
ep15_l1_test_time 2.153639316558838
Test Epoch15 layer2 Acc 0.9772285714285714, AUC 0.9981862306594849, avg_entr 0.007909495383501053, f1 0.977228581905365
ep15_l2_test_time 2.202530860900879
Test Epoch15 layer3 Acc 0.9773428571428572, AUC 0.9978628158569336, avg_entr 0.005377766210585833, f1 0.9773428440093994
ep15_l3_test_time 2.1783406734466553
Test Epoch15 layer4 Acc 0.9774571428571428, AUC 0.9977923631668091, avg_entr 0.003926941193640232, f1 0.9774571657180786
ep15_l4_test_time 2.1643640995025635
gc 0
Train Epoch16 Acc 0.9841767857142857 (551139/560000), AUC 0.9989696145057678
ep16_train_time 102.40213322639465
Test Epoch16 layer0 Acc 0.9744, AUC 0.9984589219093323, avg_entr 0.022866660729050636, f1 0.974399983882904
ep16_l0_test_time 2.232797622680664
Test Epoch16 layer1 Acc 0.9768, AUC 0.9984793663024902, avg_entr 0.012995387427508831, f1 0.9768000245094299
ep16_l1_test_time 2.1372485160827637
Test Epoch16 layer2 Acc 0.9772857142857143, AUC 0.9982122778892517, avg_entr 0.00785757601261139, f1 0.9772857427597046
ep16_l2_test_time 2.214096784591675
Test Epoch16 layer3 Acc 0.9772285714285714, AUC 0.9978653192520142, avg_entr 0.005296646151691675, f1 0.977228581905365
ep16_l3_test_time 2.1729514598846436
Test Epoch16 layer4 Acc 0.9774285714285714, AUC 0.9977816939353943, avg_entr 0.0039027216844260693, f1 0.9774284958839417
ep16_l4_test_time 2.1959164142608643
gc 0
Train Epoch17 Acc 0.9842464285714285 (551178/560000), AUC 0.9989582300186157
ep17_train_time 103.11677956581116
Test Epoch17 layer0 Acc 0.9743142857142857, AUC 0.9984636306762695, avg_entr 0.022863874211907387, f1 0.974314272403717
ep17_l0_test_time 1.8013973236083984
Test Epoch17 layer1 Acc 0.9768, AUC 0.9984797835350037, avg_entr 0.012835369445383549, f1 0.9768000245094299
ep17_l1_test_time 1.9732539653778076
Test Epoch17 layer2 Acc 0.9772, AUC 0.9981921911239624, avg_entr 0.0077392649836838245, f1 0.977199912071228
ep17_l2_test_time 2.0587635040283203
Test Epoch17 layer3 Acc 0.9774285714285714, AUC 0.9978918433189392, avg_entr 0.00533306784927845, f1 0.9774284958839417
ep17_l3_test_time 2.2368710041046143
Test Epoch17 layer4 Acc 0.9775142857142857, AUC 0.9978152513504028, avg_entr 0.00393877224996686, f1 0.9775142669677734
ep17_l4_test_time 2.1394026279449463
gc 0
Train Epoch18 Acc 0.9844339285714285 (551283/560000), AUC 0.9989709258079529
ep18_train_time 103.31044507026672
Test Epoch18 layer0 Acc 0.9743142857142857, AUC 0.9984645247459412, avg_entr 0.023011425510048866, f1 0.974314272403717
ep18_l0_test_time 2.163843870162964
Test Epoch18 layer1 Acc 0.9771714285714286, AUC 0.9984861016273499, avg_entr 0.012864142656326294, f1 0.9771714210510254
ep18_l1_test_time 2.1433823108673096
Test Epoch18 layer2 Acc 0.9774, AUC 0.9981958270072937, avg_entr 0.007702830247581005, f1 0.977400004863739
ep18_l2_test_time 2.1229097843170166
Test Epoch18 layer3 Acc 0.9775714285714285, AUC 0.9978915452957153, avg_entr 0.005245476495474577, f1 0.977571427822113
ep18_l3_test_time 2.139817953109741
Test Epoch18 layer4 Acc 0.9776857142857143, AUC 0.9978022575378418, avg_entr 0.0038646624889224768, f1 0.9776856899261475
ep18_l4_test_time 2.138477325439453
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 18
gc 0
Train Epoch19 Acc 0.98445 (551292/560000), AUC 0.9989875555038452
ep19_train_time 102.44689702987671
Test Epoch19 layer0 Acc 0.9741714285714286, AUC 0.9984548687934875, avg_entr 0.022915108129382133, f1 0.9741714000701904
ep19_l0_test_time 2.1463685035705566
Test Epoch19 layer1 Acc 0.9769428571428571, AUC 0.9984818696975708, avg_entr 0.012637561187148094, f1 0.9769428372383118
ep19_l1_test_time 2.1829206943511963
Test Epoch19 layer2 Acc 0.9771142857142857, AUC 0.9981948137283325, avg_entr 0.00759313628077507, f1 0.9771142601966858
ep19_l2_test_time 2.2538092136383057
Test Epoch19 layer3 Acc 0.9774571428571428, AUC 0.9978904128074646, avg_entr 0.0052197761833667755, f1 0.9774571657180786
ep19_l3_test_time 2.1556992530822754
Test Epoch19 layer4 Acc 0.9776285714285714, AUC 0.9978018403053284, avg_entr 0.00390740018337965, f1 0.9776285886764526
ep19_l4_test_time 2.1475629806518555
gc 0
Train Epoch20 Acc 0.9844910714285714 (551315/560000), AUC 0.9989818930625916
ep20_train_time 102.07050371170044
Test Epoch20 layer0 Acc 0.9743714285714286, AUC 0.9984591603279114, avg_entr 0.0228744987398386, f1 0.9743714332580566
ep20_l0_test_time 2.127224922180176
Test Epoch20 layer1 Acc 0.9772285714285714, AUC 0.9984679818153381, avg_entr 0.012703627347946167, f1 0.977228581905365
ep20_l1_test_time 2.136171340942383
Test Epoch20 layer2 Acc 0.9775428571428572, AUC 0.9981799721717834, avg_entr 0.007625165861099958, f1 0.9775428771972656
ep20_l2_test_time 2.1283884048461914
Test Epoch20 layer3 Acc 0.9777714285714286, AUC 0.9978912472724915, avg_entr 0.00514465244486928, f1 0.9777714014053345
ep20_l3_test_time 2.1565496921539307
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 20
Test Epoch20 layer4 Acc 0.9777142857142858, AUC 0.997830331325531, avg_entr 0.0038921020459383726, f1 0.9777143001556396
ep20_l4_test_time 2.152165174484253
gc 0
Train Epoch21 Acc 0.9845035714285715 (551322/560000), AUC 0.998975932598114
ep21_train_time 103.22822570800781
Test Epoch21 layer0 Acc 0.9743142857142857, AUC 0.9984545111656189, avg_entr 0.022859472781419754, f1 0.974314272403717
ep21_l0_test_time 2.235583782196045
Test Epoch21 layer1 Acc 0.9769428571428571, AUC 0.998475968837738, avg_entr 0.012613643892109394, f1 0.9769428372383118
ep21_l1_test_time 2.055820941925049
Test Epoch21 layer2 Acc 0.9772285714285714, AUC 0.9981976747512817, avg_entr 0.007633703760802746, f1 0.977228581905365
ep21_l2_test_time 1.799098014831543
Test Epoch21 layer3 Acc 0.9774857142857143, AUC 0.9978933334350586, avg_entr 0.005244160071015358, f1 0.977485716342926
ep21_l3_test_time 2.0118629932403564
Test Epoch21 layer4 Acc 0.9776571428571429, AUC 0.9978036284446716, avg_entr 0.0038374231662601233, f1 0.9776571393013
ep21_l4_test_time 2.0776028633117676
gc 0
Train Epoch22 Acc 0.9845910714285714 (551371/560000), AUC 0.9989921450614929
ep22_train_time 103.3011121749878
Test Epoch22 layer0 Acc 0.9743142857142857, AUC 0.9984564185142517, avg_entr 0.022726133465766907, f1 0.974314272403717
ep22_l0_test_time 2.0996434688568115
Test Epoch22 layer1 Acc 0.9770857142857143, AUC 0.9984771013259888, avg_entr 0.012605102732777596, f1 0.9770857095718384
ep22_l1_test_time 2.0958213806152344
Test Epoch22 layer2 Acc 0.9774285714285714, AUC 0.9982037544250488, avg_entr 0.007580270059406757, f1 0.9774284958839417
ep22_l2_test_time 2.1284077167510986
Test Epoch22 layer3 Acc 0.9775714285714285, AUC 0.9979175329208374, avg_entr 0.005122892092913389, f1 0.977571427822113
ep22_l3_test_time 2.1260592937469482
Test Epoch22 layer4 Acc 0.9778, AUC 0.9978273510932922, avg_entr 0.003835162380710244, f1 0.9778000116348267
ep22_l4_test_time 2.196624279022217
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 22
gc 0
Train Epoch23 Acc 0.9845803571428572 (551365/560000), AUC 0.9989858865737915
ep23_train_time 102.49421405792236
Test Epoch23 layer0 Acc 0.9744285714285714, AUC 0.9984636902809143, avg_entr 0.02286050096154213, f1 0.9744285941123962
ep23_l0_test_time 2.184581995010376
Test Epoch23 layer1 Acc 0.9770857142857143, AUC 0.9984756708145142, avg_entr 0.012554867193102837, f1 0.9770857095718384
ep23_l1_test_time 2.15468692779541
Test Epoch23 layer2 Acc 0.9774285714285714, AUC 0.9981978535652161, avg_entr 0.007549277972429991, f1 0.9774284958839417
ep23_l2_test_time 2.1630499362945557
Test Epoch23 layer3 Acc 0.9774285714285714, AUC 0.9978893995285034, avg_entr 0.005136437714099884, f1 0.9774284958839417
ep23_l3_test_time 2.164241313934326
Test Epoch23 layer4 Acc 0.9777714285714286, AUC 0.997773289680481, avg_entr 0.0038065360859036446, f1 0.9777714014053345
ep23_l4_test_time 2.1167125701904297
gc 0
Train Epoch24 Acc 0.9846053571428571 (551379/560000), AUC 0.9989857077598572
ep24_train_time 102.27770853042603
Test Epoch24 layer0 Acc 0.9744571428571429, AUC 0.9984591603279114, avg_entr 0.022787783294916153, f1 0.9744571447372437
ep24_l0_test_time 2.1662919521331787
Test Epoch24 layer1 Acc 0.9770571428571428, AUC 0.9984741806983948, avg_entr 0.012498763389885426, f1 0.977057158946991
ep24_l1_test_time 2.1493959426879883
Test Epoch24 layer2 Acc 0.9773428571428572, AUC 0.9981916546821594, avg_entr 0.007548728492110968, f1 0.9773428440093994
ep24_l2_test_time 2.1876320838928223
Test Epoch24 layer3 Acc 0.9776857142857143, AUC 0.9978808164596558, avg_entr 0.005101954098790884, f1 0.9776856899261475
ep24_l3_test_time 2.154675006866455
Test Epoch24 layer4 Acc 0.9776571428571429, AUC 0.997799277305603, avg_entr 0.003834132570773363, f1 0.9776571393013
ep24_l4_test_time 2.1500229835510254
gc 0
Train Epoch25 Acc 0.9846089285714286 (551381/560000), AUC 0.9989849328994751
ep25_train_time 103.3011634349823
Test Epoch25 layer0 Acc 0.9743428571428572, AUC 0.9984577298164368, avg_entr 0.022823547944426537, f1 0.9743428826332092
ep25_l0_test_time 2.241016387939453
Test Epoch25 layer1 Acc 0.9770571428571428, AUC 0.9984760880470276, avg_entr 0.012529264204204082, f1 0.977057158946991
ep25_l1_test_time 2.083739757537842
Test Epoch25 layer2 Acc 0.9774, AUC 0.9981948137283325, avg_entr 0.0075375791639089584, f1 0.977400004863739
ep25_l2_test_time 2.1464645862579346
Test Epoch25 layer3 Acc 0.9775714285714285, AUC 0.9978896379470825, avg_entr 0.005105185322463512, f1 0.977571427822113
ep25_l3_test_time 2.0161001682281494
Test Epoch25 layer4 Acc 0.9776857142857143, AUC 0.9977869987487793, avg_entr 0.0038165762089192867, f1 0.9776856899261475
ep25_l4_test_time 1.8746154308319092
gc 0
Train Epoch26 Acc 0.9846410714285714 (551399/560000), AUC 0.9989879727363586
ep26_train_time 102.9476912021637
Test Epoch26 layer0 Acc 0.9742857142857143, AUC 0.9984564185142517, avg_entr 0.022838270291686058, f1 0.9742856621742249
ep26_l0_test_time 2.143611431121826
Test Epoch26 layer1 Acc 0.9770285714285715, AUC 0.9984727501869202, avg_entr 0.012500214390456676, f1 0.9770285487174988
ep26_l1_test_time 2.150543212890625
Test Epoch26 layer2 Acc 0.9773428571428572, AUC 0.998200535774231, avg_entr 0.007526131812483072, f1 0.9773428440093994
ep26_l2_test_time 2.1282753944396973
Test Epoch26 layer3 Acc 0.9776857142857143, AUC 0.9978712797164917, avg_entr 0.005126454401761293, f1 0.9776856899261475
ep26_l3_test_time 2.1506683826446533
Test Epoch26 layer4 Acc 0.9777428571428571, AUC 0.9977871775627136, avg_entr 0.003825464751571417, f1 0.9777428507804871
ep26_l4_test_time 2.1564040184020996
gc 0
Train Epoch27 Acc 0.9846785714285714 (551420/560000), AUC 0.998986542224884
ep27_train_time 102.38747024536133
Test Epoch27 layer0 Acc 0.9743142857142857, AUC 0.9984560608863831, avg_entr 0.022826220840215683, f1 0.974314272403717
ep27_l0_test_time 2.1906614303588867
Test Epoch27 layer1 Acc 0.9770857142857143, AUC 0.9984715580940247, avg_entr 0.012491066008806229, f1 0.9770857095718384
ep27_l1_test_time 2.18503999710083
Test Epoch27 layer2 Acc 0.9772571428571428, AUC 0.9981902837753296, avg_entr 0.0074905832298099995, f1 0.9772571325302124
ep27_l2_test_time 2.196890354156494
Test Epoch27 layer3 Acc 0.9775428571428572, AUC 0.9978698492050171, avg_entr 0.005110152997076511, f1 0.9775428771972656
ep27_l3_test_time 2.141165256500244
Test Epoch27 layer4 Acc 0.9777142857142858, AUC 0.9977806806564331, avg_entr 0.0038271353114396334, f1 0.9777143001556396
ep27_l4_test_time 2.1557884216308594
gc 0
Train Epoch28 Acc 0.9846875 (551425/560000), AUC 0.9989887475967407
ep28_train_time 102.11723756790161
Test Epoch28 layer0 Acc 0.9743142857142857, AUC 0.998456597328186, avg_entr 0.02284368686378002, f1 0.974314272403717
ep28_l0_test_time 2.1258583068847656
Test Epoch28 layer1 Acc 0.9771714285714286, AUC 0.9984726905822754, avg_entr 0.012505179271101952, f1 0.9771714210510254
ep28_l1_test_time 2.2331223487854004
Test Epoch28 layer2 Acc 0.9773142857142857, AUC 0.9981956481933594, avg_entr 0.007495277561247349, f1 0.977314293384552
ep28_l2_test_time 2.135974168777466
Test Epoch28 layer3 Acc 0.9776, AUC 0.9978851675987244, avg_entr 0.005081098526716232, f1 0.9775999784469604
ep28_l3_test_time 2.1668684482574463
Test Epoch28 layer4 Acc 0.9777714285714286, AUC 0.9978066682815552, avg_entr 0.0038260584697127342, f1 0.9777714014053345
ep28_l4_test_time 2.2003908157348633
gc 0
Train Epoch29 Acc 0.9846767857142857 (551419/560000), AUC 0.9989940524101257
ep29_train_time 103.17290949821472
Test Epoch29 layer0 Acc 0.9743428571428572, AUC 0.9984560608863831, avg_entr 0.02279420755803585, f1 0.9743428826332092
ep29_l0_test_time 2.1831772327423096
Test Epoch29 layer1 Acc 0.9771142857142857, AUC 0.9984732866287231, avg_entr 0.012471639551222324, f1 0.9771142601966858
ep29_l1_test_time 2.1101269721984863
Test Epoch29 layer2 Acc 0.9774, AUC 0.9981933832168579, avg_entr 0.007475406397134066, f1 0.977400004863739
ep29_l2_test_time 2.1045899391174316
Test Epoch29 layer3 Acc 0.9777142857142858, AUC 0.9978566765785217, avg_entr 0.005045597907155752, f1 0.9777143001556396
ep29_l3_test_time 2.1807291507720947
Test Epoch29 layer4 Acc 0.9777142857142858, AUC 0.9977814555168152, avg_entr 0.0038159925024956465, f1 0.9777143001556396
ep29_l4_test_time 2.162855625152588
Best AUC tensor(0.9778) 22 4
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 3405.590797662735
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt
Test layer0 Acc 0.9745428571428572, AUC 0.9983550906181335, avg_entr 0.022497855126857758, f1 0.9745428562164307
l0_test_time 2.0937225818634033
Test layer1 Acc 0.9770571428571428, AUC 0.9984251260757446, avg_entr 0.013159503228962421, f1 0.977057158946991
l1_test_time 1.8402338027954102
Test layer2 Acc 0.9773714285714286, AUC 0.9982976317405701, avg_entr 0.0075292340479791164, f1 0.9773714542388916
l2_test_time 2.0056586265563965
Test layer3 Acc 0.9777428571428571, AUC 0.9979815483093262, avg_entr 0.005221683997660875, f1 0.9777428507804871
l3_test_time 2.073450803756714
Test layer4 Acc 0.9780571428571428, AUC 0.9979155659675598, avg_entr 0.00410610344260931, f1 0.9780571460723877
l4_test_time 2.1102044582366943
