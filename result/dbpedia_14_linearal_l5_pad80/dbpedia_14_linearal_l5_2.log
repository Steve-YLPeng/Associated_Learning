total count words 887881
vocab size 30000
train size 560000, valid size 35000, test size 35000
found 28354 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=14, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=14, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 1792
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 1792
layers.0.ae.h.0.bias 14
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9689662
init_time 55.42620134353638
Start Training
gc 0
Train Epoch0 Acc 0.8682767857142857 (486235/560000), AUC 0.9847000241279602
ep0_train_time 43.95067358016968
Test Epoch0 layer0 Acc 0.973, AUC 0.9982351660728455, avg_entr 0.08454856276512146, f1 0.9729999899864197
ep0_l0_test_time 0.9151046276092529
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9733142857142857, AUC 0.9980993866920471, avg_entr 0.08375932276248932, f1 0.9733142852783203
ep0_l1_test_time 0.894963264465332
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9734857142857143, AUC 0.9983180165290833, avg_entr 0.07524187862873077, f1 0.9734857678413391
ep0_l2_test_time 0.9048748016357422
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9729714285714286, AUC 0.9984875917434692, avg_entr 0.06837351620197296, f1 0.9729714393615723
ep0_l3_test_time 0.96109938621521
Test Epoch0 layer4 Acc 0.9731714285714286, AUC 0.9985870122909546, avg_entr 0.06249641627073288, f1 0.9731714129447937
ep0_l4_test_time 0.9830896854400635
gc 0
Train Epoch1 Acc 0.9775071428571429 (547404/560000), AUC 0.9987093806266785
ep1_train_time 46.18215799331665
Test Epoch1 layer0 Acc 0.9741142857142857, AUC 0.9983993768692017, avg_entr 0.046323876827955246, f1 0.9741142988204956
ep1_l0_test_time 0.861530065536499
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9738857142857142, AUC 0.9983519911766052, avg_entr 0.043655816465616226, f1 0.973885715007782
ep1_l1_test_time 0.8953030109405518
Test Epoch1 layer2 Acc 0.9746571428571429, AUC 0.9985719919204712, avg_entr 0.034649863839149475, f1 0.9746571183204651
ep1_l2_test_time 0.9128885269165039
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9753142857142857, AUC 0.9986951947212219, avg_entr 0.028886768966913223, f1 0.9753142595291138
ep1_l3_test_time 0.9296212196350098
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.9759428571428571, AUC 0.9985294938087463, avg_entr 0.02315489761531353, f1 0.975942850112915
ep1_l4_test_time 0.9360849857330322
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.979575 (548562/560000), AUC 0.9986771941184998
ep2_train_time 45.52576303482056
Test Epoch2 layer0 Acc 0.9743142857142857, AUC 0.9984186291694641, avg_entr 0.033641498535871506, f1 0.974314272403717
ep2_l0_test_time 0.9250774383544922
Test Epoch2 layer1 Acc 0.9749142857142857, AUC 0.9984204173088074, avg_entr 0.030566344037652016, f1 0.9749143123626709
ep2_l1_test_time 0.9590976238250732
Test Epoch2 layer2 Acc 0.9751428571428571, AUC 0.9986779093742371, avg_entr 0.02245781198143959, f1 0.9751428365707397
ep2_l2_test_time 0.9735147953033447
Test Epoch2 layer3 Acc 0.9758285714285714, AUC 0.9985681176185608, avg_entr 0.01644688844680786, f1 0.9758285880088806
ep2_l3_test_time 0.9471521377563477
Test Epoch2 layer4 Acc 0.9759428571428571, AUC 0.9981985688209534, avg_entr 0.011904583312571049, f1 0.975942850112915
ep2_l4_test_time 0.9513144493103027
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9805142857142857 (549088/560000), AUC 0.9985988736152649
ep3_train_time 45.85453462600708
Test Epoch3 layer0 Acc 0.9747714285714286, AUC 0.9984673261642456, avg_entr 0.026887474581599236, f1 0.9747714400291443
ep3_l0_test_time 0.8637397289276123
Test Epoch3 layer1 Acc 0.9750571428571428, AUC 0.9985055923461914, avg_entr 0.02385701797902584, f1 0.9750571250915527
ep3_l1_test_time 0.8634982109069824
Test Epoch3 layer2 Acc 0.9760857142857143, AUC 0.9987300038337708, avg_entr 0.016655482351779938, f1 0.9760857224464417
ep3_l2_test_time 0.8723483085632324
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.9766, AUC 0.998382568359375, avg_entr 0.010954351164400578, f1 0.9765999913215637
ep3_l3_test_time 0.913764476776123
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.977, AUC 0.9980312585830688, avg_entr 0.008207425475120544, f1 0.9769999980926514
ep3_l4_test_time 0.879148006439209
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9812107142857143 (549478/560000), AUC 0.9986200928688049
ep4_train_time 42.228564977645874
Test Epoch4 layer0 Acc 0.9744, AUC 0.9984599351882935, avg_entr 0.025587359443306923, f1 0.974399983882904
ep4_l0_test_time 0.864180326461792
Test Epoch4 layer1 Acc 0.9748, AUC 0.9985328912734985, avg_entr 0.021380482241511345, f1 0.9747999906539917
ep4_l1_test_time 0.8699140548706055
Test Epoch4 layer2 Acc 0.9762, AUC 0.9986394047737122, avg_entr 0.014260683208703995, f1 0.9761999845504761
ep4_l2_test_time 0.871727705001831
Test Epoch4 layer3 Acc 0.9762285714285714, AUC 0.9981527328491211, avg_entr 0.008996332064270973, f1 0.9762285947799683
ep4_l3_test_time 0.8747313022613525
Test Epoch4 layer4 Acc 0.9765428571428572, AUC 0.9978405833244324, avg_entr 0.006709482055157423, f1 0.9765428304672241
ep4_l4_test_time 0.9128444194793701
gc 0
Train Epoch5 Acc 0.9816107142857143 (549702/560000), AUC 0.9986861944198608
ep5_train_time 42.09540104866028
Test Epoch5 layer0 Acc 0.9747428571428571, AUC 0.9984651207923889, avg_entr 0.024650199338793755, f1 0.9747428297996521
ep5_l0_test_time 0.8576712608337402
Test Epoch5 layer1 Acc 0.975, AUC 0.9985361099243164, avg_entr 0.019302023574709892, f1 0.9750000238418579
ep5_l1_test_time 0.8624937534332275
Test Epoch5 layer2 Acc 0.9767142857142858, AUC 0.998564600944519, avg_entr 0.011852250434458256, f1 0.9767143130302429
ep5_l2_test_time 0.8757309913635254
Test Epoch5 layer3 Acc 0.9769714285714286, AUC 0.9979990124702454, avg_entr 0.007337039802223444, f1 0.976971447467804
ep5_l3_test_time 0.8767814636230469
Test Epoch5 layer4 Acc 0.9774, AUC 0.9978576898574829, avg_entr 0.005739323329180479, f1 0.977400004863739
ep5_l4_test_time 0.8772680759429932
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9825214285714285 (550212/560000), AUC 0.9988141655921936
ep6_train_time 42.66402339935303
Test Epoch6 layer0 Acc 0.9747714285714286, AUC 0.998475193977356, avg_entr 0.02399294823408127, f1 0.9747714400291443
ep6_l0_test_time 0.8577365875244141
Test Epoch6 layer1 Acc 0.9752285714285714, AUC 0.9985753893852234, avg_entr 0.017359895631670952, f1 0.9752285480499268
ep6_l1_test_time 0.8604233264923096
Test Epoch6 layer2 Acc 0.9767428571428571, AUC 0.9984722137451172, avg_entr 0.010375411249697208, f1 0.9767428636550903
ep6_l2_test_time 0.8660123348236084
Test Epoch6 layer3 Acc 0.9770571428571428, AUC 0.9980207681655884, avg_entr 0.006944356951862574, f1 0.977057158946991
ep6_l3_test_time 0.874439001083374
Test Epoch6 layer4 Acc 0.9775142857142857, AUC 0.9980002045631409, avg_entr 0.005501945503056049, f1 0.9775142669677734
ep6_l4_test_time 0.8994507789611816
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9827071428571429 (550316/560000), AUC 0.9988589882850647
ep7_train_time 42.149572134017944
Test Epoch7 layer0 Acc 0.9746285714285714, AUC 0.9984565377235413, avg_entr 0.023924285545945168, f1 0.9746285676956177
ep7_l0_test_time 0.8636627197265625
Test Epoch7 layer1 Acc 0.9760857142857143, AUC 0.9985613822937012, avg_entr 0.016536690294742584, f1 0.9760857224464417
ep7_l1_test_time 0.8850107192993164
Test Epoch7 layer2 Acc 0.9769428571428571, AUC 0.9983634352684021, avg_entr 0.009845196269452572, f1 0.9769428372383118
ep7_l2_test_time 0.854773998260498
Test Epoch7 layer3 Acc 0.977, AUC 0.9978733062744141, avg_entr 0.006578671745955944, f1 0.9769999980926514
ep7_l3_test_time 0.8938384056091309
Test Epoch7 layer4 Acc 0.9776285714285714, AUC 0.9977452158927917, avg_entr 0.005160896107554436, f1 0.9776285886764526
ep7_l4_test_time 0.8830342292785645
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.9829357142857142 (550444/560000), AUC 0.9988913536071777
ep8_train_time 42.28670024871826
Test Epoch8 layer0 Acc 0.9745714285714285, AUC 0.9984748959541321, avg_entr 0.02412921003997326, f1 0.9745714068412781
ep8_l0_test_time 0.8555963039398193
Test Epoch8 layer1 Acc 0.9762571428571428, AUC 0.9985821843147278, avg_entr 0.016094055026769638, f1 0.9762571454048157
ep8_l1_test_time 0.8707692623138428
Test Epoch8 layer2 Acc 0.9773142857142857, AUC 0.9983487725257874, avg_entr 0.009372556582093239, f1 0.977314293384552
ep8_l2_test_time 0.8581254482269287
Test Epoch8 layer3 Acc 0.9775428571428572, AUC 0.9979766011238098, avg_entr 0.006170646287500858, f1 0.9775428771972656
ep8_l3_test_time 0.9036951065063477
Test Epoch8 layer4 Acc 0.9777714285714286, AUC 0.9979268908500671, avg_entr 0.004924695938825607, f1 0.9777714014053345
ep8_l4_test_time 0.9090373516082764
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9832482142857143 (550619/560000), AUC 0.9988822340965271
ep9_train_time 42.62260961532593
Test Epoch9 layer0 Acc 0.9744571428571429, AUC 0.9984521269798279, avg_entr 0.02360786311328411, f1 0.9744571447372437
ep9_l0_test_time 0.859062671661377
Test Epoch9 layer1 Acc 0.9762285714285714, AUC 0.9985671639442444, avg_entr 0.015380419790744781, f1 0.9762285947799683
ep9_l1_test_time 0.8656308650970459
Test Epoch9 layer2 Acc 0.9772285714285714, AUC 0.9982439875602722, avg_entr 0.0087870629504323, f1 0.977228581905365
ep9_l2_test_time 0.8920538425445557
Test Epoch9 layer3 Acc 0.9771714285714286, AUC 0.9978904128074646, avg_entr 0.005813217256218195, f1 0.9771714210510254
ep9_l3_test_time 0.919694185256958
Test Epoch9 layer4 Acc 0.9774, AUC 0.9977743029594421, avg_entr 0.004665093030780554, f1 0.977400004863739
ep9_l4_test_time 0.9195973873138428
gc 0
Train Epoch10 Acc 0.9836446428571428 (550841/560000), AUC 0.9988994598388672
ep10_train_time 45.33826208114624
Test Epoch10 layer0 Acc 0.9746, AUC 0.9984565377235413, avg_entr 0.023843824863433838, f1 0.9746000170707703
ep10_l0_test_time 0.9413542747497559
Test Epoch10 layer1 Acc 0.9763142857142857, AUC 0.998555600643158, avg_entr 0.015015684068202972, f1 0.9763143062591553
ep10_l1_test_time 0.9322638511657715
Test Epoch10 layer2 Acc 0.9772285714285714, AUC 0.9982410669326782, avg_entr 0.008703280240297318, f1 0.977228581905365
ep10_l2_test_time 0.9154567718505859
Test Epoch10 layer3 Acc 0.9773142857142857, AUC 0.997949481010437, avg_entr 0.005756672006100416, f1 0.977314293384552
ep10_l3_test_time 0.8956995010375977
Test Epoch10 layer4 Acc 0.9774857142857143, AUC 0.9978802800178528, avg_entr 0.0047091832384467125, f1 0.977485716342926
ep10_l4_test_time 0.9384980201721191
gc 0
Train Epoch11 Acc 0.9837 (550872/560000), AUC 0.9989067912101746
ep11_train_time 45.87161207199097
Test Epoch11 layer0 Acc 0.9745142857142857, AUC 0.9984651803970337, avg_entr 0.023723429068922997, f1 0.9745143055915833
ep11_l0_test_time 0.9407122135162354
Test Epoch11 layer1 Acc 0.9766571428571429, AUC 0.9985602498054504, avg_entr 0.014637639746069908, f1 0.9766571521759033
ep11_l1_test_time 0.9053022861480713
Test Epoch11 layer2 Acc 0.9773428571428572, AUC 0.998242199420929, avg_entr 0.008418631739914417, f1 0.9773428440093994
ep11_l2_test_time 0.9067747592926025
Test Epoch11 layer3 Acc 0.9774, AUC 0.9980341792106628, avg_entr 0.005634805653244257, f1 0.977400004863739
ep11_l3_test_time 0.9230382442474365
Test Epoch11 layer4 Acc 0.9778857142857142, AUC 0.9978647828102112, avg_entr 0.004596380516886711, f1 0.9778857231140137
ep11_l4_test_time 0.9637057781219482
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 11
gc 0
Train Epoch12 Acc 0.9838589285714285 (550961/560000), AUC 0.9989404678344727
ep12_train_time 44.88313007354736
Test Epoch12 layer0 Acc 0.9745428571428572, AUC 0.9984530806541443, avg_entr 0.02378988265991211, f1 0.9745428562164307
ep12_l0_test_time 0.8675062656402588
Test Epoch12 layer1 Acc 0.9766285714285714, AUC 0.9985374808311462, avg_entr 0.014507006853818893, f1 0.9766285419464111
ep12_l1_test_time 0.8671767711639404
Test Epoch12 layer2 Acc 0.9773428571428572, AUC 0.9981927871704102, avg_entr 0.008208495564758778, f1 0.9773428440093994
ep12_l2_test_time 0.8678381443023682
Test Epoch12 layer3 Acc 0.9773714285714286, AUC 0.9980359077453613, avg_entr 0.005483322776854038, f1 0.9773714542388916
ep12_l3_test_time 0.8889932632446289
Test Epoch12 layer4 Acc 0.9775142857142857, AUC 0.9978482127189636, avg_entr 0.004432776011526585, f1 0.9775142669677734
ep12_l4_test_time 0.8943524360656738
gc 0
Train Epoch13 Acc 0.9838464285714286 (550954/560000), AUC 0.998900294303894
ep13_train_time 51.099268436431885
Test Epoch13 layer0 Acc 0.9745714285714285, AUC 0.9984644055366516, avg_entr 0.02353883907198906, f1 0.9745714068412781
ep13_l0_test_time 0.8553130626678467
Test Epoch13 layer1 Acc 0.9768857142857142, AUC 0.9985508918762207, avg_entr 0.01423836499452591, f1 0.9768857359886169
ep13_l1_test_time 0.8499112129211426
Test Epoch13 layer2 Acc 0.9773428571428572, AUC 0.9982015490531921, avg_entr 0.00817662663757801, f1 0.9773428440093994
ep13_l2_test_time 0.8759634494781494
Test Epoch13 layer3 Acc 0.9776571428571429, AUC 0.9979892373085022, avg_entr 0.005507159046828747, f1 0.9776571393013
ep13_l3_test_time 0.8874866962432861
Test Epoch13 layer4 Acc 0.9777142857142858, AUC 0.9978242516517639, avg_entr 0.004440821707248688, f1 0.9777143001556396
ep13_l4_test_time 0.8913819789886475
gc 0
Train Epoch14 Acc 0.9841392857142857 (551118/560000), AUC 0.9989100098609924
ep14_train_time 42.74367666244507
Test Epoch14 layer0 Acc 0.9746, AUC 0.998449444770813, avg_entr 0.023462312296032906, f1 0.9746000170707703
ep14_l0_test_time 0.8515689373016357
Test Epoch14 layer1 Acc 0.9768571428571429, AUC 0.9985279440879822, avg_entr 0.014035332016646862, f1 0.9768571257591248
ep14_l1_test_time 0.8656947612762451
Test Epoch14 layer2 Acc 0.9774285714285714, AUC 0.9981985092163086, avg_entr 0.007994442246854305, f1 0.9774284958839417
ep14_l2_test_time 0.8832921981811523
Test Epoch14 layer3 Acc 0.9776285714285714, AUC 0.9979844689369202, avg_entr 0.005402455572038889, f1 0.9776285886764526
ep14_l3_test_time 0.8846299648284912
Test Epoch14 layer4 Acc 0.9779142857142857, AUC 0.9978064894676208, avg_entr 0.0043652476742863655, f1 0.9779142737388611
ep14_l4_test_time 0.8871111869812012
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 14
gc 0
Train Epoch15 Acc 0.9841178571428572 (551106/560000), AUC 0.9989144206047058
ep15_train_time 42.34113073348999
Test Epoch15 layer0 Acc 0.9745142857142857, AUC 0.9984565377235413, avg_entr 0.023507261648774147, f1 0.9745143055915833
ep15_l0_test_time 0.8594479560852051
Test Epoch15 layer1 Acc 0.9768, AUC 0.9985398650169373, avg_entr 0.013903913088142872, f1 0.9768000245094299
ep15_l1_test_time 0.8648922443389893
Test Epoch15 layer2 Acc 0.9771428571428571, AUC 0.9982029795646667, avg_entr 0.007915196008980274, f1 0.977142870426178
ep15_l2_test_time 0.8724589347839355
Test Epoch15 layer3 Acc 0.9771428571428571, AUC 0.9979867935180664, avg_entr 0.005447452887892723, f1 0.977142870426178
ep15_l3_test_time 0.8747472763061523
Test Epoch15 layer4 Acc 0.9776, AUC 0.9977741837501526, avg_entr 0.004382631275802851, f1 0.9775999784469604
ep15_l4_test_time 0.895561933517456
gc 0
Train Epoch16 Acc 0.9841892857142858 (551146/560000), AUC 0.9989148378372192
ep16_train_time 42.3614547252655
Test Epoch16 layer0 Acc 0.9745714285714285, AUC 0.9984532594680786, avg_entr 0.023459425196051598, f1 0.9745714068412781
ep16_l0_test_time 0.8509495258331299
Test Epoch16 layer1 Acc 0.9769714285714286, AUC 0.9985366463661194, avg_entr 0.01385524682700634, f1 0.976971447467804
ep16_l1_test_time 0.861809253692627
Test Epoch16 layer2 Acc 0.9775428571428572, AUC 0.9982064366340637, avg_entr 0.007923729717731476, f1 0.9775428771972656
ep16_l2_test_time 0.9760591983795166
Test Epoch16 layer3 Acc 0.9775428571428572, AUC 0.9980420470237732, avg_entr 0.005352487787604332, f1 0.9775428771972656
ep16_l3_test_time 0.8819394111633301
Test Epoch16 layer4 Acc 0.9778, AUC 0.9979015588760376, avg_entr 0.004319491796195507, f1 0.9778000116348267
ep16_l4_test_time 0.8893437385559082
gc 0
Train Epoch17 Acc 0.9842375 (551173/560000), AUC 0.9989147782325745
ep17_train_time 42.51116108894348
Test Epoch17 layer0 Acc 0.9745428571428572, AUC 0.9984534978866577, avg_entr 0.02360401675105095, f1 0.9745428562164307
ep17_l0_test_time 0.9158775806427002
Test Epoch17 layer1 Acc 0.9768285714285714, AUC 0.9985325932502747, avg_entr 0.013767071068286896, f1 0.9768285751342773
ep17_l1_test_time 0.879986047744751
Test Epoch17 layer2 Acc 0.9775714285714285, AUC 0.9981975555419922, avg_entr 0.00779979070648551, f1 0.977571427822113
ep17_l2_test_time 0.8550958633422852
Test Epoch17 layer3 Acc 0.9775428571428572, AUC 0.9980224370956421, avg_entr 0.005325544159859419, f1 0.9775428771972656
ep17_l3_test_time 0.8737425804138184
Test Epoch17 layer4 Acc 0.9778571428571429, AUC 0.9978316426277161, avg_entr 0.0042980732396245, f1 0.9778571724891663
ep17_l4_test_time 0.8745429515838623
gc 0
Train Epoch18 Acc 0.9843482142857143 (551235/560000), AUC 0.9989374876022339
ep18_train_time 42.75009489059448
Test Epoch18 layer0 Acc 0.9745428571428572, AUC 0.9984488487243652, avg_entr 0.023426493629813194, f1 0.9745428562164307
ep18_l0_test_time 0.8603873252868652
Test Epoch18 layer1 Acc 0.9769142857142857, AUC 0.9985243082046509, avg_entr 0.013582490384578705, f1 0.9769142866134644
ep18_l1_test_time 0.8601374626159668
Test Epoch18 layer2 Acc 0.9775428571428572, AUC 0.9981861710548401, avg_entr 0.0077543421648442745, f1 0.9775428771972656
ep18_l2_test_time 0.8579196929931641
Test Epoch18 layer3 Acc 0.9777142857142858, AUC 0.9979952573776245, avg_entr 0.005287582986056805, f1 0.9777143001556396
ep18_l3_test_time 0.8650627136230469
Test Epoch18 layer4 Acc 0.9777428571428571, AUC 0.9977699518203735, avg_entr 0.004222141113132238, f1 0.9777428507804871
ep18_l4_test_time 0.8836138248443604
gc 0
Train Epoch19 Acc 0.9843714285714286 (551248/560000), AUC 0.9989264607429504
ep19_train_time 42.63203430175781
Test Epoch19 layer0 Acc 0.9746, AUC 0.9984499216079712, avg_entr 0.023457076400518417, f1 0.9746000170707703
ep19_l0_test_time 0.852104902267456
Test Epoch19 layer1 Acc 0.9769142857142857, AUC 0.9985277056694031, avg_entr 0.013499180786311626, f1 0.9769142866134644
ep19_l1_test_time 0.8607010841369629
Test Epoch19 layer2 Acc 0.9775714285714285, AUC 0.9982032179832458, avg_entr 0.007728729397058487, f1 0.977571427822113
ep19_l2_test_time 0.8650965690612793
Test Epoch19 layer3 Acc 0.9775428571428572, AUC 0.9980424642562866, avg_entr 0.0052698696963489056, f1 0.9775428771972656
ep19_l3_test_time 0.8834736347198486
Test Epoch19 layer4 Acc 0.9778, AUC 0.9978367686271667, avg_entr 0.004211413208395243, f1 0.9778000116348267
ep19_l4_test_time 0.9254391193389893
gc 0
Train Epoch20 Acc 0.9843732142857143 (551249/560000), AUC 0.9989239573478699
ep20_train_time 42.17643189430237
Test Epoch20 layer0 Acc 0.9745142857142857, AUC 0.9984530210494995, avg_entr 0.0235421285033226, f1 0.9745143055915833
ep20_l0_test_time 0.8655047416687012
Test Epoch20 layer1 Acc 0.9769428571428571, AUC 0.9985257387161255, avg_entr 0.013504290021955967, f1 0.9769428372383118
ep20_l1_test_time 0.8594622611999512
Test Epoch20 layer2 Acc 0.9776, AUC 0.998194694519043, avg_entr 0.00767155596986413, f1 0.9775999784469604
ep20_l2_test_time 0.8692052364349365
Test Epoch20 layer3 Acc 0.9774285714285714, AUC 0.9980341196060181, avg_entr 0.005228448659181595, f1 0.9774284958839417
ep20_l3_test_time 0.9063143730163574
Test Epoch20 layer4 Acc 0.9778571428571429, AUC 0.9978278875350952, avg_entr 0.004203773569315672, f1 0.9778571724891663
ep20_l4_test_time 0.9091906547546387
gc 0
Train Epoch21 Acc 0.9844142857142857 (551272/560000), AUC 0.9989252686500549
ep21_train_time 42.229103326797485
Test Epoch21 layer0 Acc 0.9745428571428572, AUC 0.9984524846076965, avg_entr 0.02345472015440464, f1 0.9745428562164307
ep21_l0_test_time 0.844780445098877
Test Epoch21 layer1 Acc 0.9768857142857142, AUC 0.9985255002975464, avg_entr 0.013461380265653133, f1 0.9768857359886169
ep21_l1_test_time 0.859250545501709
Test Epoch21 layer2 Acc 0.9775142857142857, AUC 0.9982026219367981, avg_entr 0.007650029845535755, f1 0.9775142669677734
ep21_l2_test_time 0.8912107944488525
Test Epoch21 layer3 Acc 0.9776571428571429, AUC 0.9980349540710449, avg_entr 0.005238393787294626, f1 0.9776571393013
ep21_l3_test_time 0.8823885917663574
Test Epoch21 layer4 Acc 0.9778285714285714, AUC 0.9978336095809937, avg_entr 0.004191932734102011, f1 0.9778285622596741
ep21_l4_test_time 0.8993465900421143
gc 0
Train Epoch22 Acc 0.9844642857142857 (551300/560000), AUC 0.9989223480224609
ep22_train_time 42.982653856277466
Test Epoch22 layer0 Acc 0.9745428571428572, AUC 0.99844890832901, avg_entr 0.02341555990278721, f1 0.9745428562164307
ep22_l0_test_time 0.8834824562072754
Test Epoch22 layer1 Acc 0.9769428571428571, AUC 0.998517632484436, avg_entr 0.013443101197481155, f1 0.9769428372383118
ep22_l1_test_time 0.9070899486541748
Test Epoch22 layer2 Acc 0.9774857142857143, AUC 0.998181939125061, avg_entr 0.007605188060551882, f1 0.977485716342926
ep22_l2_test_time 0.911168098449707
Test Epoch22 layer3 Acc 0.9776, AUC 0.9980376958847046, avg_entr 0.005214331205934286, f1 0.9775999784469604
ep22_l3_test_time 0.9030277729034424
Test Epoch22 layer4 Acc 0.9778571428571429, AUC 0.9978352189064026, avg_entr 0.004173426888883114, f1 0.9778571724891663
ep22_l4_test_time 0.905280351638794
gc 0
Train Epoch23 Acc 0.984475 (551306/560000), AUC 0.9989215731620789
ep23_train_time 46.15323758125305
Test Epoch23 layer0 Acc 0.9745142857142857, AUC 0.9984487295150757, avg_entr 0.02342057041823864, f1 0.9745143055915833
ep23_l0_test_time 0.9460313320159912
Test Epoch23 layer1 Acc 0.9768857142857142, AUC 0.9985207319259644, avg_entr 0.013399300165474415, f1 0.9768857359886169
ep23_l1_test_time 0.894890308380127
Test Epoch23 layer2 Acc 0.9774857142857143, AUC 0.998193621635437, avg_entr 0.007588183507323265, f1 0.977485716342926
ep23_l2_test_time 0.970320463180542
Test Epoch23 layer3 Acc 0.9774285714285714, AUC 0.9980250597000122, avg_entr 0.0051760803908109665, f1 0.9774284958839417
ep23_l3_test_time 0.9427907466888428
Test Epoch23 layer4 Acc 0.9778285714285714, AUC 0.9978235960006714, avg_entr 0.004145106766372919, f1 0.9778285622596741
ep23_l4_test_time 0.9478309154510498
gc 0
Train Epoch24 Acc 0.9844892857142857 (551314/560000), AUC 0.9989181756973267
ep24_train_time 46.078856229782104
Test Epoch24 layer0 Acc 0.9744857142857143, AUC 0.9984503388404846, avg_entr 0.023462992161512375, f1 0.9744856953620911
ep24_l0_test_time 0.9005992412567139
Test Epoch24 layer1 Acc 0.9768571428571429, AUC 0.9985236525535583, avg_entr 0.013382806442677975, f1 0.9768571257591248
ep24_l1_test_time 0.9206962585449219
Test Epoch24 layer2 Acc 0.9776285714285714, AUC 0.9981845617294312, avg_entr 0.007593537215143442, f1 0.9776285886764526
ep24_l2_test_time 0.8898296356201172
Test Epoch24 layer3 Acc 0.9774571428571428, AUC 0.9980092644691467, avg_entr 0.0051893992349505424, f1 0.9774571657180786
ep24_l3_test_time 0.9149715900421143
Test Epoch24 layer4 Acc 0.9779428571428571, AUC 0.9978187680244446, avg_entr 0.004154307302087545, f1 0.9779428839683533
ep24_l4_test_time 0.9266746044158936
Save ckpt to ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt  ,ep 24
gc 0
Train Epoch25 Acc 0.9844714285714286 (551304/560000), AUC 0.9989147186279297
ep25_train_time 48.97520136833191
Test Epoch25 layer0 Acc 0.9745714285714285, AUC 0.9984530806541443, avg_entr 0.023368295282125473, f1 0.9745714068412781
ep25_l0_test_time 1.171205997467041
Test Epoch25 layer1 Acc 0.9768571428571429, AUC 0.9985231757164001, avg_entr 0.013368871994316578, f1 0.9768571257591248
ep25_l1_test_time 1.2711565494537354
Test Epoch25 layer2 Acc 0.9774285714285714, AUC 0.9981924891471863, avg_entr 0.007594486698508263, f1 0.9774284958839417
ep25_l2_test_time 1.1098182201385498
Test Epoch25 layer3 Acc 0.9773428571428572, AUC 0.9980513453483582, avg_entr 0.005194029770791531, f1 0.9773428440093994
ep25_l3_test_time 1.101691484451294
Test Epoch25 layer4 Acc 0.9778285714285714, AUC 0.9978529214859009, avg_entr 0.004158689174801111, f1 0.9778285622596741
ep25_l4_test_time 1.128387689590454
gc 0
Train Epoch26 Acc 0.9845267857142858 (551335/560000), AUC 0.9989258050918579
ep26_train_time 45.77034592628479
Test Epoch26 layer0 Acc 0.9745428571428572, AUC 0.9984520673751831, avg_entr 0.023434754461050034, f1 0.9745428562164307
ep26_l0_test_time 0.8555748462677002
Test Epoch26 layer1 Acc 0.9768571428571429, AUC 0.9985198378562927, avg_entr 0.013332455419003963, f1 0.9768571257591248
ep26_l1_test_time 0.8668832778930664
Test Epoch26 layer2 Acc 0.9774857142857143, AUC 0.9982072710990906, avg_entr 0.007564999163150787, f1 0.977485716342926
ep26_l2_test_time 0.9084584712982178
Test Epoch26 layer3 Acc 0.9773428571428572, AUC 0.9980391263961792, avg_entr 0.005180582869797945, f1 0.9773428440093994
ep26_l3_test_time 0.8740191459655762
Test Epoch26 layer4 Acc 0.9778571428571429, AUC 0.9978466629981995, avg_entr 0.004131019115447998, f1 0.9778571724891663
ep26_l4_test_time 0.8907718658447266
gc 0
Train Epoch27 Acc 0.9845303571428572 (551337/560000), AUC 0.9989188313484192
ep27_train_time 42.519585609436035
Test Epoch27 layer0 Acc 0.9744857142857143, AUC 0.9984502196311951, avg_entr 0.023410022258758545, f1 0.9744856953620911
ep27_l0_test_time 0.8558309078216553
Test Epoch27 layer1 Acc 0.977, AUC 0.9985207319259644, avg_entr 0.01331663690507412, f1 0.9769999980926514
ep27_l1_test_time 0.8648653030395508
Test Epoch27 layer2 Acc 0.9774285714285714, AUC 0.9981881976127625, avg_entr 0.007557007018476725, f1 0.9774284958839417
ep27_l2_test_time 0.8833122253417969
Test Epoch27 layer3 Acc 0.9773142857142857, AUC 0.9980209469795227, avg_entr 0.005168785806745291, f1 0.977314293384552
ep27_l3_test_time 0.8800210952758789
Test Epoch27 layer4 Acc 0.9777142857142858, AUC 0.9978123903274536, avg_entr 0.004129146691411734, f1 0.9777143001556396
ep27_l4_test_time 0.8890726566314697
gc 0
Train Epoch28 Acc 0.9845553571428571 (551351/560000), AUC 0.9989209771156311
ep28_train_time 42.264148473739624
Test Epoch28 layer0 Acc 0.9745142857142857, AUC 0.9984517097473145, avg_entr 0.023407772183418274, f1 0.9745143055915833
ep28_l0_test_time 0.8766953945159912
Test Epoch28 layer1 Acc 0.9769714285714286, AUC 0.9985162615776062, avg_entr 0.013312229886651039, f1 0.976971447467804
ep28_l1_test_time 0.8512547016143799
Test Epoch28 layer2 Acc 0.9775428571428572, AUC 0.998184084892273, avg_entr 0.007564257830381393, f1 0.9775428771972656
ep28_l2_test_time 0.8894333839416504
Test Epoch28 layer3 Acc 0.9775142857142857, AUC 0.9980255365371704, avg_entr 0.005148880649358034, f1 0.9775142669677734
ep28_l3_test_time 0.8952910900115967
Test Epoch28 layer4 Acc 0.9778571428571429, AUC 0.99782794713974, avg_entr 0.004115647170692682, f1 0.9778571724891663
ep28_l4_test_time 0.8775765895843506
gc 0
Train Epoch29 Acc 0.9845178571428571 (551330/560000), AUC 0.9989184141159058
ep29_train_time 42.30671501159668
Test Epoch29 layer0 Acc 0.9745714285714285, AUC 0.9984503388404846, avg_entr 0.02343800663948059, f1 0.9745714068412781
ep29_l0_test_time 0.8601272106170654
Test Epoch29 layer1 Acc 0.9769714285714286, AUC 0.9985159039497375, avg_entr 0.013293091207742691, f1 0.976971447467804
ep29_l1_test_time 0.8822555541992188
Test Epoch29 layer2 Acc 0.9776, AUC 0.9981912970542908, avg_entr 0.00754909124225378, f1 0.9775999784469604
ep29_l2_test_time 0.874946117401123
Test Epoch29 layer3 Acc 0.9776285714285714, AUC 0.9980378150939941, avg_entr 0.005156141240149736, f1 0.9776285886764526
ep29_l3_test_time 0.8802523612976074
Test Epoch29 layer4 Acc 0.9778, AUC 0.9978485107421875, avg_entr 0.004131885711103678, f1 0.9778000116348267
ep29_l4_test_time 0.8969080448150635
Best AUC tensor(0.9779) 24 4
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 1457.369712114334
Start Testing
Load ckpt at ckpt/dbpedia_14_linearal_l5_pad80//dbpedia_14_linearal_l5.pt
Test layer0 Acc 0.9742857142857143, AUC 0.9982956051826477, avg_entr 0.022976728156208992, f1 0.9742856621742249
l0_test_time 0.8585817813873291
Test layer1 Acc 0.9770571428571428, AUC 0.9984464049339294, avg_entr 0.013797422870993614, f1 0.977057158946991
l1_test_time 0.8826847076416016
Test layer2 Acc 0.9774571428571428, AUC 0.9982684850692749, avg_entr 0.007779504172503948, f1 0.9774571657180786
l2_test_time 0.8716766834259033
Test layer3 Acc 0.9778857142857142, AUC 0.9980669021606445, avg_entr 0.0054593393579125404, f1 0.9778857231140137
l3_test_time 0.8987236022949219
Test layer4 Acc 0.9779142857142857, AUC 0.9979609847068787, avg_entr 0.004405047278851271, f1 0.9779142737388611
l4_test_time 0.8979024887084961
