total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.3_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.92075 (110490/120000), AUC 0.9855202436447144
ep0_train_time 6.338582277297974
Test Epoch0 threshold 0.3 Acc 0.9115131578947369, AUC 0.9804266095161438, avg_entr 0.023838534951210022
ep0_t0.3_test_time 0.09104037284851074
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.3_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9487833333333333 (113854/120000), AUC 0.9928443431854248
ep1_train_time 5.900463104248047
Test Epoch1 threshold 0.3 Acc 0.9115131578947369, AUC 0.9801267385482788, avg_entr 0.0242631733417511
ep1_t0.3_test_time 0.09133386611938477
gc 0
Train Epoch2 Acc 0.9506833333333333 (114082/120000), AUC 0.993196964263916
ep2_train_time 6.275369644165039
Test Epoch2 threshold 0.3 Acc 0.9121710526315789, AUC 0.9798726439476013, avg_entr 0.02381407842040062
ep2_t0.3_test_time 0.09093141555786133
gc 0
Train Epoch3 Acc 0.95175 (114210/120000), AUC 0.9933645725250244
ep3_train_time 6.144994497299194
Test Epoch3 threshold 0.3 Acc 0.9111842105263158, AUC 0.9794985055923462, avg_entr 0.024474937468767166
ep3_t0.3_test_time 0.08542561531066895
gc 0
Train Epoch4 Acc 0.95355 (114426/120000), AUC 0.9937572479248047
ep4_train_time 5.865206718444824
Test Epoch4 threshold 0.3 Acc 0.9121710526315789, AUC 0.9792252779006958, avg_entr 0.023907367140054703
ep4_t0.3_test_time 0.08363556861877441
gc 0
Train Epoch5 Acc 0.9558416666666667 (114701/120000), AUC 0.9945921897888184
ep5_train_time 5.8694541454315186
Test Epoch5 threshold 0.3 Acc 0.9110197368421052, AUC 0.9791321754455566, avg_entr 0.023859437555074692
ep5_t0.3_test_time 0.08455562591552734
gc 0
Train Epoch6 Acc 0.9563583333333333 (114763/120000), AUC 0.9946926832199097
ep6_train_time 5.841637134552002
Test Epoch6 threshold 0.3 Acc 0.9110197368421052, AUC 0.9788804054260254, avg_entr 0.023028137162327766
ep6_t0.3_test_time 0.08527326583862305
gc 0
Train Epoch7 Acc 0.957 (114840/120000), AUC 0.9948142766952515
ep7_train_time 5.8902764320373535
Test Epoch7 threshold 0.3 Acc 0.9092105263157895, AUC 0.9786587357521057, avg_entr 0.02403475157916546
ep7_t0.3_test_time 0.08618879318237305
gc 0
Train Epoch8 Acc 0.95745 (114894/120000), AUC 0.9948664903640747
ep8_train_time 5.908623456954956
Test Epoch8 threshold 0.3 Acc 0.9092105263157895, AUC 0.9786325097084045, avg_entr 0.024098137393593788
ep8_t0.3_test_time 0.08779263496398926
gc 0
Train Epoch9 Acc 0.9591666666666666 (115100/120000), AUC 0.9954074621200562
ep9_train_time 5.944891691207886
Test Epoch9 threshold 0.3 Acc 0.9097039473684211, AUC 0.9783080220222473, avg_entr 0.023653527721762657
ep9_t0.3_test_time 0.0856630802154541
Best AUC 0.9804266095161438
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.3_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.3 Acc 0.9197368421052632, AUC 0.9849148988723755, avg_entr 0.02480369806289673
t0.3_test_time 0.02331233024597168
