total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.6_m4//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2, 3, 4}
gc 9
Train Epoch0 Acc 0.9198333333333333 (110380/120000), AUC 0.9842326641082764
ep0_train_time 6.534125566482544
Test Epoch0 threshold 0.6 Acc 0.9133223684210526, AUC 0.980721652507782, avg_entr 0.025653963908553123
ep0_t0.6_test_time 0.07541418075561523
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.6_m5//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9474333333333333 (113692/120000), AUC 0.9925361275672913
ep1_train_time 6.13025426864624
Test Epoch1 threshold 0.6 Acc 0.9129934210526316, AUC 0.9807220697402954, avg_entr 0.024507205933332443
ep1_t0.6_test_time 0.07362604141235352
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.6_m5//ag_news_linearal_l5_prefix.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9497583333333334 (113971/120000), AUC 0.9926524758338928
ep2_train_time 6.067080736160278
Test Epoch2 threshold 0.6 Acc 0.9116776315789473, AUC 0.9800918102264404, avg_entr 0.02442077174782753
ep2_t0.6_test_time 0.07589364051818848
gc 0
Train Epoch3 Acc 0.951425 (114171/120000), AUC 0.9930322170257568
ep3_train_time 6.107337474822998
Test Epoch3 threshold 0.6 Acc 0.9090460526315789, AUC 0.979934573173523, avg_entr 0.024514196440577507
ep3_t0.6_test_time 0.07316207885742188
gc 0
Train Epoch4 Acc 0.9524333333333334 (114292/120000), AUC 0.9934330582618713
ep4_train_time 6.061428785324097
Test Epoch4 threshold 0.6 Acc 0.9098684210526315, AUC 0.9797662496566772, avg_entr 0.023994626477360725
ep4_t0.6_test_time 0.07330942153930664
gc 0
Train Epoch5 Acc 0.9551666666666667 (114620/120000), AUC 0.9944043159484863
ep5_train_time 6.150059223175049
Test Epoch5 threshold 0.6 Acc 0.9106907894736842, AUC 0.9793225526809692, avg_entr 0.024775715544819832
ep5_t0.6_test_time 0.07275080680847168
gc 0
Train Epoch6 Acc 0.956025 (114723/120000), AUC 0.9945747256278992
ep6_train_time 6.11468243598938
Test Epoch6 threshold 0.6 Acc 0.9113486842105263, AUC 0.9791489839553833, avg_entr 0.024621428921818733
ep6_t0.6_test_time 0.07320451736450195
gc 0
Train Epoch7 Acc 0.9565083333333333 (114781/120000), AUC 0.9947230815887451
ep7_train_time 6.102842092514038
Test Epoch7 threshold 0.6 Acc 0.9087171052631579, AUC 0.9788762927055359, avg_entr 0.025336749851703644
ep7_t0.6_test_time 0.07274293899536133
gc 0
Train Epoch8 Acc 0.9572333333333334 (114868/120000), AUC 0.9948049783706665
ep8_train_time 6.101966619491577
Test Epoch8 threshold 0.6 Acc 0.9085526315789474, AUC 0.9785983562469482, avg_entr 0.025187624618411064
ep8_t0.6_test_time 0.07244229316711426
gc 0
Train Epoch9 Acc 0.9585916666666666 (115031/120000), AUC 0.99527508020401
ep9_train_time 6.06179666519165
Test Epoch9 threshold 0.6 Acc 0.9095394736842105, AUC 0.9785349369049072, avg_entr 0.025593379512429237
ep9_t0.6_test_time 0.07265973091125488
Best AUC 0.9807220697402954
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.6_m5//ag_news_linearal_l5_prefix.pt
Test threshold 0.6 Acc 0.9217105263157894, AUC 0.985084056854248, avg_entr 0.025594428181648254
t0.6_test_time 0.019070863723754883
