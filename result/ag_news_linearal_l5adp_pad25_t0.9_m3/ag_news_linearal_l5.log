total count words 102019
vocab size 30000
found 26754 words in glove
Load ckpt from ckpt/ag_news_linearal_l5adp_pad25_t0.9_m2//ag_news_linearal_l5_prefix.pt
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
Start Training
train_mask {0, 1, 2}
gc 9
Train Epoch0 Acc 0.3041583333333333 (36499/120000), AUC 0.7250604629516602
ep0_train_time 5.6357738971710205
Test Epoch0 threshold 0.9 Acc 0.9131578947368421, AUC 0.9808440208435059, avg_entr 0.025329595431685448
ep0_t0.9_test_time 0.07605481147766113
Save ckpt to ckpt/ag_news_linearal_l5adp_pad25_t0.9_m3//ag_news_linearal_l5_prefix.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.2926 (35112/120000), AUC 0.7069355845451355
ep1_train_time 5.179928302764893
Test Epoch1 threshold 0.9 Acc 0.9118421052631579, AUC 0.979934573173523, avg_entr 0.024889323860406876
ep1_t0.9_test_time 0.07297682762145996
gc 0
Train Epoch2 Acc 0.27398333333333336 (32878/120000), AUC 0.6873311400413513
ep2_train_time 5.072119235992432
Test Epoch2 threshold 0.9 Acc 0.9111842105263158, AUC 0.9799106121063232, avg_entr 0.0245510321110487
ep2_t0.9_test_time 0.07097673416137695
gc 0
Train Epoch3 Acc 0.25964166666666666 (31157/120000), AUC 0.6538851261138916
ep3_train_time 4.906559228897095
Test Epoch3 threshold 0.9 Acc 0.9100328947368421, AUC 0.9796737432479858, avg_entr 0.025744561105966568
ep3_t0.9_test_time 0.07055878639221191
gc 0
Train Epoch4 Acc 0.2541083333333333 (30493/120000), AUC 0.6122153997421265
ep4_train_time 4.873459577560425
Test Epoch4 threshold 0.9 Acc 0.9098684210526315, AUC 0.9792921543121338, avg_entr 0.02527608908712864
ep4_t0.9_test_time 0.07056975364685059
gc 0
Train Epoch5 Acc 0.256225 (30747/120000), AUC 0.5953946113586426
ep5_train_time 4.8573644161224365
Test Epoch5 threshold 0.9 Acc 0.9113486842105263, AUC 0.9792819619178772, avg_entr 0.024874990805983543
ep5_t0.9_test_time 0.07120776176452637
gc 0
Train Epoch6 Acc 0.257675 (30921/120000), AUC 0.5890225768089294
ep6_train_time 4.863998651504517
Test Epoch6 threshold 0.9 Acc 0.9095394736842105, AUC 0.9790140390396118, avg_entr 0.025781646370887756
ep6_t0.9_test_time 0.07099294662475586
gc 0
Train Epoch7 Acc 0.25898333333333334 (31078/120000), AUC 0.5840023756027222
ep7_train_time 4.87207555770874
Test Epoch7 threshold 0.9 Acc 0.9101973684210526, AUC 0.9788490533828735, avg_entr 0.02543027512729168
ep7_t0.9_test_time 0.07134079933166504
gc 0
Train Epoch8 Acc 0.26025 (31230/120000), AUC 0.5799588561058044
ep8_train_time 4.883652210235596
Test Epoch8 threshold 0.9 Acc 0.909375, AUC 0.9786258935928345, avg_entr 0.02574281394481659
ep8_t0.9_test_time 0.07090425491333008
gc 0
Train Epoch9 Acc 0.2608083333333333 (31297/120000), AUC 0.5765669345855713
ep9_train_time 4.858269214630127
Test Epoch9 threshold 0.9 Acc 0.9100328947368421, AUC 0.9786636829376221, avg_entr 0.02527076005935669
ep9_t0.9_test_time 0.0712277889251709
Best AUC 0.9808440208435059
train_loss (2, 5, 10)
valid_acc (10, 1)
valid_AUC (10, 1)
train_acc (10,)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Figure(640x480)
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5adp_pad25_t0.9_m3//ag_news_linearal_l5_prefix.pt
Test threshold 0.9 Acc 0.9184210526315789, AUC 0.9851507544517517, avg_entr 0.025793666020035744
t0.9_test_time 0.018644332885742188
