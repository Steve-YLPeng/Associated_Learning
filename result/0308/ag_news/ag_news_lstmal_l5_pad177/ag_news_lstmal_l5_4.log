total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 20.70339584350586
Start Training
gc 0
Train Epoch0 Acc 0.7323833333333334 (87886/120000), AUC 0.9155911803245544
ep0_train_time 183.9699993133545
Test Epoch0 layer0 Acc 0.906578947368421, AUC 0.9774123430252075, avg_entr 0.2512347400188446, f1 0.9065789580345154
ep0_l0_test_time 0.3343825340270996
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9068421052631579, AUC 0.9810075163841248, avg_entr 0.1092887744307518, f1 0.9068421125411987
ep0_l1_test_time 0.5956113338470459
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9042105263157895, AUC 0.9819177389144897, avg_entr 0.10541177541017532, f1 0.9042104482650757
ep0_l2_test_time 0.8934268951416016
Test Epoch0 layer3 Acc 0.9047368421052632, AUC 0.9808156490325928, avg_entr 0.11536254733800888, f1 0.9047367572784424
ep0_l3_test_time 1.259676218032837
Test Epoch0 layer4 Acc 0.9036842105263158, AUC 0.9803484678268433, avg_entr 0.10669638961553574, f1 0.9036841988563538
ep0_l4_test_time 1.6243915557861328
gc 0
Train Epoch1 Acc 0.9196166666666666 (110354/120000), AUC 0.9812384843826294
ep1_train_time 183.59216594696045
Test Epoch1 layer0 Acc 0.9171052631578948, AUC 0.9806896448135376, avg_entr 0.14381816983222961, f1 0.9171052575111389
ep1_l0_test_time 0.32587504386901855
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9173684210526316, AUC 0.9840439558029175, avg_entr 0.052814874798059464, f1 0.9173683524131775
ep1_l1_test_time 0.5897414684295654
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9173684210526316, AUC 0.9847558736801147, avg_entr 0.049261730164289474, f1 0.9173683524131775
ep1_l2_test_time 0.8931536674499512
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9181578947368421, AUC 0.9835428595542908, avg_entr 0.05311908945441246, f1 0.9181578755378723
ep1_l3_test_time 1.2621290683746338
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.9184210526315789, AUC 0.982736349105835, avg_entr 0.04972543194890022, f1 0.9184210896492004
ep1_l4_test_time 1.6222519874572754
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9316083333333334 (111793/120000), AUC 0.9856662750244141
ep2_train_time 183.76304984092712
Test Epoch2 layer0 Acc 0.9186842105263158, AUC 0.9819595217704773, avg_entr 0.11280633509159088, f1 0.918684184551239
ep2_l0_test_time 0.3167843818664551
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.9213157894736842, AUC 0.9845538139343262, avg_entr 0.0374438650906086, f1 0.9213157892227173
ep2_l1_test_time 0.5959353446960449
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.921578947368421, AUC 0.9849516749382019, avg_entr 0.03405765816569328, f1 0.9215789437294006
ep2_l2_test_time 0.891582727432251
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.9218421052631579, AUC 0.9837833046913147, avg_entr 0.035036541521549225, f1 0.921842098236084
ep2_l3_test_time 1.2586185932159424
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.9218421052631579, AUC 0.9832835793495178, avg_entr 0.034996502101421356, f1 0.921842098236084
ep2_l4_test_time 1.6211135387420654
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.939025 (112683/120000), AUC 0.988543689250946
ep3_train_time 183.63720107078552
Test Epoch3 layer0 Acc 0.9210526315789473, AUC 0.9824265241622925, avg_entr 0.09197341650724411, f1 0.9210526347160339
ep3_l0_test_time 0.3244452476501465
Test Epoch3 layer1 Acc 0.9205263157894736, AUC 0.9848483800888062, avg_entr 0.03150080889463425, f1 0.9205263257026672
ep3_l1_test_time 0.5937933921813965
Test Epoch3 layer2 Acc 0.9221052631578948, AUC 0.9851760864257812, avg_entr 0.027436038479208946, f1 0.9221052527427673
ep3_l2_test_time 0.8934371471405029
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.921578947368421, AUC 0.983691930770874, avg_entr 0.027823569253087044, f1 0.9215789437294006
ep3_l3_test_time 1.2547650337219238
Test Epoch3 layer4 Acc 0.9223684210526316, AUC 0.983868420124054, avg_entr 0.028376871719956398, f1 0.9223684072494507
ep3_l4_test_time 1.6236226558685303
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9440916666666667 (113291/120000), AUC 0.9901566505432129
ep4_train_time 183.74060201644897
Test Epoch4 layer0 Acc 0.9223684210526316, AUC 0.9827193021774292, avg_entr 0.08051586151123047, f1 0.9223684072494507
ep4_l0_test_time 0.3272387981414795
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.9226315789473685, AUC 0.9848478436470032, avg_entr 0.025229675695300102, f1 0.922631561756134
ep4_l1_test_time 0.5946211814880371
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.9213157894736842, AUC 0.9849072098731995, avg_entr 0.021371735259890556, f1 0.9213157892227173
ep4_l2_test_time 0.8945121765136719
Test Epoch4 layer3 Acc 0.921578947368421, AUC 0.9833606481552124, avg_entr 0.0210791677236557, f1 0.9215789437294006
ep4_l3_test_time 1.2561848163604736
Test Epoch4 layer4 Acc 0.9205263157894736, AUC 0.9834147691726685, avg_entr 0.021078642457723618, f1 0.9205263257026672
ep4_l4_test_time 1.6153864860534668
gc 0
Train Epoch5 Acc 0.9478666666666666 (113744/120000), AUC 0.9916015863418579
ep5_train_time 183.94898748397827
Test Epoch5 layer0 Acc 0.9221052631578948, AUC 0.9828087687492371, avg_entr 0.07090532034635544, f1 0.9221052527427673
ep5_l0_test_time 0.3181772232055664
Test Epoch5 layer1 Acc 0.9228947368421052, AUC 0.9846373200416565, avg_entr 0.02412980981171131, f1 0.9228947162628174
ep5_l1_test_time 0.5980997085571289
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 5
Test Epoch5 layer2 Acc 0.9226315789473685, AUC 0.9848530292510986, avg_entr 0.02089693956077099, f1 0.922631561756134
ep5_l2_test_time 0.8950958251953125
Test Epoch5 layer3 Acc 0.9218421052631579, AUC 0.9831452369689941, avg_entr 0.0207795649766922, f1 0.921842098236084
ep5_l3_test_time 1.2597787380218506
Test Epoch5 layer4 Acc 0.9202631578947369, AUC 0.9834387302398682, avg_entr 0.021133776754140854, f1 0.9202631711959839
ep5_l4_test_time 1.621344804763794
gc 0
Train Epoch6 Acc 0.9505916666666666 (114071/120000), AUC 0.9924798607826233
ep6_train_time 183.80358934402466
Test Epoch6 layer0 Acc 0.9213157894736842, AUC 0.982801079750061, avg_entr 0.06506191939115524, f1 0.9213157892227173
ep6_l0_test_time 0.33173179626464844
Test Epoch6 layer1 Acc 0.9221052631578948, AUC 0.9839040040969849, avg_entr 0.021396633237600327, f1 0.9221052527427673
ep6_l1_test_time 0.5976746082305908
Test Epoch6 layer2 Acc 0.9231578947368421, AUC 0.9839348196983337, avg_entr 0.018584107980132103, f1 0.9231578707695007
ep6_l2_test_time 0.8901233673095703
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 6
Test Epoch6 layer3 Acc 0.9221052631578948, AUC 0.9820148944854736, avg_entr 0.018521418794989586, f1 0.9221052527427673
ep6_l3_test_time 1.2632226943969727
Test Epoch6 layer4 Acc 0.9197368421052632, AUC 0.9811505079269409, avg_entr 0.019161755219101906, f1 0.9197368621826172
ep6_l4_test_time 1.6206324100494385
gc 0
Train Epoch7 Acc 0.95365 (114438/120000), AUC 0.993125319480896
ep7_train_time 183.64714074134827
Test Epoch7 layer0 Acc 0.9221052631578948, AUC 0.9827958345413208, avg_entr 0.06242834031581879, f1 0.9221052527427673
ep7_l0_test_time 0.31793856620788574
Test Epoch7 layer1 Acc 0.9186842105263158, AUC 0.9840407371520996, avg_entr 0.020639531314373016, f1 0.918684184551239
ep7_l1_test_time 0.5883405208587646
Test Epoch7 layer2 Acc 0.92, AUC 0.9840334057807922, avg_entr 0.017973536625504494, f1 0.9200000166893005
ep7_l2_test_time 0.8970801830291748
Test Epoch7 layer3 Acc 0.9184210526315789, AUC 0.9818894863128662, avg_entr 0.01807232014834881, f1 0.9184210896492004
ep7_l3_test_time 1.2531623840332031
Test Epoch7 layer4 Acc 0.916578947368421, AUC 0.9827983379364014, avg_entr 0.017814744263887405, f1 0.9165789484977722
ep7_l4_test_time 1.6221635341644287
gc 0
Train Epoch8 Acc 0.95615 (114738/120000), AUC 0.993949294090271
ep8_train_time 183.86288690567017
Test Epoch8 layer0 Acc 0.921578947368421, AUC 0.9825849533081055, avg_entr 0.054954662919044495, f1 0.9215789437294006
ep8_l0_test_time 0.32785677909851074
Test Epoch8 layer1 Acc 0.9186842105263158, AUC 0.9839428663253784, avg_entr 0.020252499729394913, f1 0.918684184551239
ep8_l1_test_time 0.585425853729248
Test Epoch8 layer2 Acc 0.9178947368421052, AUC 0.9836443662643433, avg_entr 0.01853223703801632, f1 0.917894721031189
ep8_l2_test_time 0.8947494029998779
Test Epoch8 layer3 Acc 0.9168421052631579, AUC 0.9813592433929443, avg_entr 0.01868392527103424, f1 0.9168421030044556
ep8_l3_test_time 1.259826421737671
Test Epoch8 layer4 Acc 0.9186842105263158, AUC 0.9816750288009644, avg_entr 0.018337301909923553, f1 0.918684184551239
ep8_l4_test_time 1.6289422512054443
gc 0
Train Epoch9 Acc 0.9590166666666666 (115082/120000), AUC 0.9947199821472168
ep9_train_time 183.77727842330933
Test Epoch9 layer0 Acc 0.9218421052631579, AUC 0.9825869798660278, avg_entr 0.05337817966938019, f1 0.921842098236084
ep9_l0_test_time 0.31205201148986816
Test Epoch9 layer1 Acc 0.9176315789473685, AUC 0.9836577773094177, avg_entr 0.02004241943359375, f1 0.9176315665245056
ep9_l1_test_time 0.5854029655456543
Test Epoch9 layer2 Acc 0.9186842105263158, AUC 0.9837158918380737, avg_entr 0.017299804836511612, f1 0.918684184551239
ep9_l2_test_time 0.8913726806640625
Test Epoch9 layer3 Acc 0.9189473684210526, AUC 0.9812101721763611, avg_entr 0.017138682305812836, f1 0.9189472794532776
ep9_l3_test_time 1.2620692253112793
Test Epoch9 layer4 Acc 0.9184210526315789, AUC 0.9814127087593079, avg_entr 0.017044099047780037, f1 0.9184210896492004
ep9_l4_test_time 1.6233031749725342
gc 0
Train Epoch10 Acc 0.95995 (115194/120000), AUC 0.9948872923851013
ep10_train_time 183.53391098976135
Test Epoch10 layer0 Acc 0.9218421052631579, AUC 0.982454240322113, avg_entr 0.05129760876297951, f1 0.921842098236084
ep10_l0_test_time 0.3312571048736572
Test Epoch10 layer1 Acc 0.916578947368421, AUC 0.9833621978759766, avg_entr 0.01871972531080246, f1 0.9165789484977722
ep10_l1_test_time 0.5963916778564453
Test Epoch10 layer2 Acc 0.9176315789473685, AUC 0.9831453561782837, avg_entr 0.015561537817120552, f1 0.9176315665245056
ep10_l2_test_time 0.8970301151275635
Test Epoch10 layer3 Acc 0.9168421052631579, AUC 0.9814270734786987, avg_entr 0.015246792696416378, f1 0.9168421030044556
ep10_l3_test_time 1.2680230140686035
Test Epoch10 layer4 Acc 0.9168421052631579, AUC 0.9806792140007019, avg_entr 0.014826687052845955, f1 0.9168421030044556
ep10_l4_test_time 1.6284873485565186
gc 0
Train Epoch11 Acc 0.961525 (115383/120000), AUC 0.9949895143508911
ep11_train_time 183.65126991271973
Test Epoch11 layer0 Acc 0.92, AUC 0.9825471043586731, avg_entr 0.05040730535984039, f1 0.9200000166893005
ep11_l0_test_time 0.3287653923034668
Test Epoch11 layer1 Acc 0.9181578947368421, AUC 0.9836602210998535, avg_entr 0.018161319196224213, f1 0.9181578755378723
ep11_l1_test_time 0.5948677062988281
Test Epoch11 layer2 Acc 0.9189473684210526, AUC 0.9831312894821167, avg_entr 0.015169292688369751, f1 0.9189472794532776
ep11_l2_test_time 0.8915483951568604
Test Epoch11 layer3 Acc 0.9176315789473685, AUC 0.9811012744903564, avg_entr 0.01524778176099062, f1 0.9176315665245056
ep11_l3_test_time 1.2533652782440186
Test Epoch11 layer4 Acc 0.9171052631578948, AUC 0.9820895791053772, avg_entr 0.015412978827953339, f1 0.9171052575111389
ep11_l4_test_time 1.624098539352417
gc 0
Train Epoch12 Acc 0.9627416666666667 (115529/120000), AUC 0.9953277707099915
ep12_train_time 183.59774231910706
Test Epoch12 layer0 Acc 0.9213157894736842, AUC 0.9824160933494568, avg_entr 0.04758928716182709, f1 0.9213157892227173
ep12_l0_test_time 0.32248878479003906
Test Epoch12 layer1 Acc 0.9152631578947369, AUC 0.9831615090370178, avg_entr 0.01751682721078396, f1 0.9152631759643555
ep12_l1_test_time 0.5932872295379639
Test Epoch12 layer2 Acc 0.9168421052631579, AUC 0.9822950959205627, avg_entr 0.014903180301189423, f1 0.9168421030044556
ep12_l2_test_time 0.8930537700653076
Test Epoch12 layer3 Acc 0.9152631578947369, AUC 0.9794533252716064, avg_entr 0.014323543757200241, f1 0.9152631759643555
ep12_l3_test_time 1.260183572769165
Test Epoch12 layer4 Acc 0.9160526315789473, AUC 0.97979336977005, avg_entr 0.013629015535116196, f1 0.9160526394844055
ep12_l4_test_time 1.62015962600708
gc 0
Train Epoch13 Acc 0.964375 (115725/120000), AUC 0.99556964635849
ep13_train_time 183.67930459976196
Test Epoch13 layer0 Acc 0.9213157894736842, AUC 0.9823591709136963, avg_entr 0.046228837221860886, f1 0.9213157892227173
ep13_l0_test_time 0.31682443618774414
Test Epoch13 layer1 Acc 0.9144736842105263, AUC 0.9829586744308472, avg_entr 0.01491494383662939, f1 0.9144737124443054
ep13_l1_test_time 0.5888347625732422
Test Epoch13 layer2 Acc 0.9142105263157895, AUC 0.982050895690918, avg_entr 0.012758835218846798, f1 0.9142104983329773
ep13_l2_test_time 0.9042203426361084
Test Epoch13 layer3 Acc 0.9152631578947369, AUC 0.9792600274085999, avg_entr 0.01198620069772005, f1 0.9152631759643555
ep13_l3_test_time 1.2589030265808105
Test Epoch13 layer4 Acc 0.9168421052631579, AUC 0.9800517559051514, avg_entr 0.012068354524672031, f1 0.9168421030044556
ep13_l4_test_time 1.6175975799560547
gc 0
Train Epoch14 Acc 0.96485 (115782/120000), AUC 0.9956516623497009
ep14_train_time 183.67151308059692
Test Epoch14 layer0 Acc 0.9223684210526316, AUC 0.9823306202888489, avg_entr 0.04436063766479492, f1 0.9223684072494507
ep14_l0_test_time 0.3282942771911621
Test Epoch14 layer1 Acc 0.9147368421052632, AUC 0.9830355644226074, avg_entr 0.017453329637646675, f1 0.9147368669509888
ep14_l1_test_time 0.5934855937957764
Test Epoch14 layer2 Acc 0.9155263157894736, AUC 0.9819004535675049, avg_entr 0.014317472465336323, f1 0.9155263304710388
ep14_l2_test_time 0.8888874053955078
Test Epoch14 layer3 Acc 0.9155263157894736, AUC 0.9786391854286194, avg_entr 0.013626476749777794, f1 0.9155263304710388
ep14_l3_test_time 1.2493624687194824
Test Epoch14 layer4 Acc 0.9142105263157895, AUC 0.9790458679199219, avg_entr 0.01314910501241684, f1 0.9142104983329773
ep14_l4_test_time 1.6253364086151123
gc 0
Train Epoch15 Acc 0.965825 (115899/120000), AUC 0.9956803321838379
ep15_train_time 183.70122694969177
Test Epoch15 layer0 Acc 0.9205263157894736, AUC 0.9823046922683716, avg_entr 0.04414348676800728, f1 0.9205263257026672
ep15_l0_test_time 0.32794713973999023
Test Epoch15 layer1 Acc 0.9160526315789473, AUC 0.9829834699630737, avg_entr 0.015309319831430912, f1 0.9160526394844055
ep15_l1_test_time 0.5905144214630127
Test Epoch15 layer2 Acc 0.9163157894736842, AUC 0.9821611642837524, avg_entr 0.012919380329549313, f1 0.9163157939910889
ep15_l2_test_time 0.8923845291137695
Test Epoch15 layer3 Acc 0.9155263157894736, AUC 0.9796143174171448, avg_entr 0.012655448168516159, f1 0.9155263304710388
ep15_l3_test_time 1.2690963745117188
Test Epoch15 layer4 Acc 0.9157894736842105, AUC 0.9805828332901001, avg_entr 0.01257528830319643, f1 0.9157894849777222
ep15_l4_test_time 1.6277704238891602
gc 0
Train Epoch16 Acc 0.9663416666666667 (115961/120000), AUC 0.9957595467567444
ep16_train_time 183.7136778831482
Test Epoch16 layer0 Acc 0.9202631578947369, AUC 0.9822735786437988, avg_entr 0.04307609423995018, f1 0.9202631711959839
ep16_l0_test_time 0.32667064666748047
Test Epoch16 layer1 Acc 0.915, AUC 0.9827138185501099, avg_entr 0.014602000825107098, f1 0.9150000214576721
ep16_l1_test_time 0.5946040153503418
Test Epoch16 layer2 Acc 0.9160526315789473, AUC 0.981886625289917, avg_entr 0.011899586766958237, f1 0.9160526394844055
ep16_l2_test_time 0.8845903873443604
Test Epoch16 layer3 Acc 0.9152631578947369, AUC 0.9785699844360352, avg_entr 0.011581708677113056, f1 0.9152631759643555
ep16_l3_test_time 1.2561755180358887
Test Epoch16 layer4 Acc 0.9155263157894736, AUC 0.979036271572113, avg_entr 0.01141226477921009, f1 0.9155263304710388
ep16_l4_test_time 1.6127543449401855
gc 0
Train Epoch17 Acc 0.9674333333333334 (116092/120000), AUC 0.9958532452583313
ep17_train_time 183.6510796546936
Test Epoch17 layer0 Acc 0.9192105263157895, AUC 0.9822412133216858, avg_entr 0.041315484791994095, f1 0.9192105531692505
ep17_l0_test_time 0.3289632797241211
Test Epoch17 layer1 Acc 0.9131578947368421, AUC 0.9825960397720337, avg_entr 0.014858911745250225, f1 0.9131578803062439
ep17_l1_test_time 0.5892269611358643
Test Epoch17 layer2 Acc 0.9142105263157895, AUC 0.9818310737609863, avg_entr 0.012471865862607956, f1 0.9142104983329773
ep17_l2_test_time 0.8934633731842041
Test Epoch17 layer3 Acc 0.9142105263157895, AUC 0.9789040088653564, avg_entr 0.012345155701041222, f1 0.9142104983329773
ep17_l3_test_time 1.2495698928833008
Test Epoch17 layer4 Acc 0.9142105263157895, AUC 0.9792497158050537, avg_entr 0.012290401384234428, f1 0.9142104983329773
ep17_l4_test_time 1.6226434707641602
gc 0
Train Epoch18 Acc 0.9676333333333333 (116116/120000), AUC 0.9958504438400269
ep18_train_time 183.44632863998413
Test Epoch18 layer0 Acc 0.9205263157894736, AUC 0.9822309017181396, avg_entr 0.04055674374103546, f1 0.9205263257026672
ep18_l0_test_time 0.331557035446167
Test Epoch18 layer1 Acc 0.9139473684210526, AUC 0.9825387597084045, avg_entr 0.014293345622718334, f1 0.913947343826294
ep18_l1_test_time 0.5930962562561035
Test Epoch18 layer2 Acc 0.9142105263157895, AUC 0.981550395488739, avg_entr 0.012165652588009834, f1 0.9142104983329773
ep18_l2_test_time 0.888700008392334
Test Epoch18 layer3 Acc 0.9144736842105263, AUC 0.9784426093101501, avg_entr 0.011541510000824928, f1 0.9144737124443054
ep18_l3_test_time 1.260120153427124
Test Epoch18 layer4 Acc 0.9147368421052632, AUC 0.9789351224899292, avg_entr 0.011279414407908916, f1 0.9147368669509888
ep18_l4_test_time 1.631547212600708
gc 0
Train Epoch19 Acc 0.9678416666666667 (116141/120000), AUC 0.995884120464325
ep19_train_time 183.73248195648193
Test Epoch19 layer0 Acc 0.9205263157894736, AUC 0.9822267889976501, avg_entr 0.0394638292491436, f1 0.9205263257026672
ep19_l0_test_time 0.3263688087463379
Test Epoch19 layer1 Acc 0.9113157894736842, AUC 0.982248842716217, avg_entr 0.012918972410261631, f1 0.9113157987594604
ep19_l1_test_time 0.597048282623291
Test Epoch19 layer2 Acc 0.9131578947368421, AUC 0.9812910556793213, avg_entr 0.010539622977375984, f1 0.9131578803062439
ep19_l2_test_time 0.8895809650421143
Test Epoch19 layer3 Acc 0.9131578947368421, AUC 0.9783966541290283, avg_entr 0.01017793919891119, f1 0.9131578803062439
ep19_l3_test_time 1.2559494972229004
Test Epoch19 layer4 Acc 0.9123684210526316, AUC 0.9786790609359741, avg_entr 0.010795796290040016, f1 0.9123684167861938
ep19_l4_test_time 1.6199424266815186
gc 0
Train Epoch20 Acc 0.96835 (116202/120000), AUC 0.9958137273788452
ep20_train_time 183.51556587219238
Test Epoch20 layer0 Acc 0.9207894736842105, AUC 0.9822227358818054, avg_entr 0.03797243535518646, f1 0.9207894802093506
ep20_l0_test_time 0.3150656223297119
Test Epoch20 layer1 Acc 0.9121052631578948, AUC 0.982358455657959, avg_entr 0.013978131115436554, f1 0.9121052622795105
ep20_l1_test_time 0.5862452983856201
Test Epoch20 layer2 Acc 0.9134210526315789, AUC 0.9812687039375305, avg_entr 0.011155336163938046, f1 0.9134210348129272
ep20_l2_test_time 0.8878128528594971
Test Epoch20 layer3 Acc 0.9123684210526316, AUC 0.9784089922904968, avg_entr 0.010722042061388493, f1 0.9123684167861938
ep20_l3_test_time 1.252072811126709
Test Epoch20 layer4 Acc 0.9134210526315789, AUC 0.9789127111434937, avg_entr 0.010854775086045265, f1 0.9134210348129272
ep20_l4_test_time 1.628103256225586
gc 0
Train Epoch21 Acc 0.9687083333333333 (116245/120000), AUC 0.9959266185760498
ep21_train_time 183.42025089263916
Test Epoch21 layer0 Acc 0.9218421052631579, AUC 0.982248067855835, avg_entr 0.03773179650306702, f1 0.921842098236084
ep21_l0_test_time 0.3293321132659912
Test Epoch21 layer1 Acc 0.9121052631578948, AUC 0.9822555780410767, avg_entr 0.013280616141855717, f1 0.9121052622795105
ep21_l1_test_time 0.5938920974731445
Test Epoch21 layer2 Acc 0.9121052631578948, AUC 0.980977475643158, avg_entr 0.010772224515676498, f1 0.9121052622795105
ep21_l2_test_time 0.8903236389160156
Test Epoch21 layer3 Acc 0.9128947368421053, AUC 0.9778908491134644, avg_entr 0.010384972207248211, f1 0.9128947257995605
ep21_l3_test_time 1.2551720142364502
Test Epoch21 layer4 Acc 0.9128947368421053, AUC 0.9781646728515625, avg_entr 0.010757340118288994, f1 0.9128947257995605
ep21_l4_test_time 1.6068446636199951
gc 0
Train Epoch22 Acc 0.9689833333333333 (116278/120000), AUC 0.9959151744842529
ep22_train_time 183.71258926391602
Test Epoch22 layer0 Acc 0.9223684210526316, AUC 0.9822119474411011, avg_entr 0.03682522848248482, f1 0.9223684072494507
ep22_l0_test_time 0.32351255416870117
Test Epoch22 layer1 Acc 0.9126315789473685, AUC 0.9820888042449951, avg_entr 0.012680050916969776, f1 0.9126315712928772
ep22_l1_test_time 0.5889968872070312
Test Epoch22 layer2 Acc 0.9142105263157895, AUC 0.9810813665390015, avg_entr 0.010274873115122318, f1 0.9142104983329773
ep22_l2_test_time 0.9003901481628418
Test Epoch22 layer3 Acc 0.9136842105263158, AUC 0.9777816534042358, avg_entr 0.010243050754070282, f1 0.9136841893196106
ep22_l3_test_time 1.254194736480713
Test Epoch22 layer4 Acc 0.9134210526315789, AUC 0.9781944751739502, avg_entr 0.01013422105461359, f1 0.9134210348129272
ep22_l4_test_time 1.624276876449585
gc 0
Train Epoch23 Acc 0.9691583333333333 (116299/120000), AUC 0.995908260345459
ep23_train_time 183.6174750328064
Test Epoch23 layer0 Acc 0.9205263157894736, AUC 0.9821805953979492, avg_entr 0.0366341695189476, f1 0.9205263257026672
ep23_l0_test_time 0.32589006423950195
Test Epoch23 layer1 Acc 0.9139473684210526, AUC 0.9821826815605164, avg_entr 0.013297665864229202, f1 0.913947343826294
ep23_l1_test_time 0.5951650142669678
Test Epoch23 layer2 Acc 0.9134210526315789, AUC 0.9807829260826111, avg_entr 0.010378940030932426, f1 0.9134210348129272
ep23_l2_test_time 0.8972852230072021
Test Epoch23 layer3 Acc 0.9126315789473685, AUC 0.9774613976478577, avg_entr 0.010086379013955593, f1 0.9126315712928772
ep23_l3_test_time 1.25929856300354
Test Epoch23 layer4 Acc 0.9136842105263158, AUC 0.9779517650604248, avg_entr 0.010003766976296902, f1 0.9136841893196106
ep23_l4_test_time 1.6221661567687988
gc 0
Train Epoch24 Acc 0.9692583333333333 (116311/120000), AUC 0.9958808422088623
ep24_train_time 183.74063348770142
Test Epoch24 layer0 Acc 0.9218421052631579, AUC 0.9822103381156921, avg_entr 0.036294884979724884, f1 0.921842098236084
ep24_l0_test_time 0.3256688117980957
Test Epoch24 layer1 Acc 0.9126315789473685, AUC 0.9822002649307251, avg_entr 0.01263675931841135, f1 0.9126315712928772
ep24_l1_test_time 0.5873613357543945
Test Epoch24 layer2 Acc 0.9134210526315789, AUC 0.9810707569122314, avg_entr 0.010128846392035484, f1 0.9134210348129272
ep24_l2_test_time 0.8950951099395752
Test Epoch24 layer3 Acc 0.9128947368421053, AUC 0.9775391221046448, avg_entr 0.009975728578865528, f1 0.9128947257995605
ep24_l3_test_time 1.258763074874878
Test Epoch24 layer4 Acc 0.9134210526315789, AUC 0.9780311584472656, avg_entr 0.009745394811034203, f1 0.9134210348129272
ep24_l4_test_time 1.6192123889923096
gc 0
Train Epoch25 Acc 0.9693916666666667 (116327/120000), AUC 0.9959548711776733
ep25_train_time 183.72191286087036
Test Epoch25 layer0 Acc 0.9210526315789473, AUC 0.9821962118148804, avg_entr 0.03627513721585274, f1 0.9210526347160339
ep25_l0_test_time 0.3325073719024658
Test Epoch25 layer1 Acc 0.9134210526315789, AUC 0.9820712208747864, avg_entr 0.0124895591288805, f1 0.9134210348129272
ep25_l1_test_time 0.5897085666656494
Test Epoch25 layer2 Acc 0.9134210526315789, AUC 0.9808529615402222, avg_entr 0.009785526432096958, f1 0.9134210348129272
ep25_l2_test_time 0.8903214931488037
Test Epoch25 layer3 Acc 0.9131578947368421, AUC 0.9772889614105225, avg_entr 0.009777202270925045, f1 0.9131578803062439
ep25_l3_test_time 1.2509901523590088
Test Epoch25 layer4 Acc 0.9134210526315789, AUC 0.9777907729148865, avg_entr 0.009514642879366875, f1 0.9134210348129272
ep25_l4_test_time 1.6346569061279297
gc 0
Train Epoch26 Acc 0.9695166666666667 (116342/120000), AUC 0.9959045648574829
ep26_train_time 183.81750082969666
Test Epoch26 layer0 Acc 0.921578947368421, AUC 0.9822040796279907, avg_entr 0.03604229539632797, f1 0.9215789437294006
ep26_l0_test_time 0.3339517116546631
Test Epoch26 layer1 Acc 0.9128947368421053, AUC 0.98197340965271, avg_entr 0.012148653157055378, f1 0.9128947257995605
ep26_l1_test_time 0.5919511318206787
Test Epoch26 layer2 Acc 0.9139473684210526, AUC 0.9808217287063599, avg_entr 0.00989221315830946, f1 0.913947343826294
ep26_l2_test_time 0.8921816349029541
Test Epoch26 layer3 Acc 0.9134210526315789, AUC 0.9772793054580688, avg_entr 0.009645631536841393, f1 0.9134210348129272
ep26_l3_test_time 1.252795934677124
Test Epoch26 layer4 Acc 0.9134210526315789, AUC 0.9779964089393616, avg_entr 0.009670345112681389, f1 0.9134210348129272
ep26_l4_test_time 1.616628646850586
gc 0
Train Epoch27 Acc 0.9696333333333333 (116356/120000), AUC 0.995913028717041
ep27_train_time 183.69562578201294
Test Epoch27 layer0 Acc 0.9210526315789473, AUC 0.9821838140487671, avg_entr 0.03573017939925194, f1 0.9210526347160339
ep27_l0_test_time 0.3193657398223877
Test Epoch27 layer1 Acc 0.9136842105263158, AUC 0.9819301962852478, avg_entr 0.012555590830743313, f1 0.9136841893196106
ep27_l1_test_time 0.59442138671875
Test Epoch27 layer2 Acc 0.9139473684210526, AUC 0.9807898998260498, avg_entr 0.009764485992491245, f1 0.913947343826294
ep27_l2_test_time 0.8953392505645752
Test Epoch27 layer3 Acc 0.9131578947368421, AUC 0.9772007465362549, avg_entr 0.00980115681886673, f1 0.9131578803062439
ep27_l3_test_time 1.2540075778961182
Test Epoch27 layer4 Acc 0.9136842105263158, AUC 0.977664053440094, avg_entr 0.009227139875292778, f1 0.9136841893196106
ep27_l4_test_time 1.6235747337341309
gc 0
Train Epoch28 Acc 0.9697416666666666 (116369/120000), AUC 0.9959299564361572
ep28_train_time 183.69906497001648
Test Epoch28 layer0 Acc 0.9213157894736842, AUC 0.9821590185165405, avg_entr 0.03546009957790375, f1 0.9213157892227173
ep28_l0_test_time 0.322756290435791
Test Epoch28 layer1 Acc 0.9128947368421053, AUC 0.9819104671478271, avg_entr 0.012141992338001728, f1 0.9128947257995605
ep28_l1_test_time 0.5945630073547363
Test Epoch28 layer2 Acc 0.9131578947368421, AUC 0.980674147605896, avg_entr 0.009395771659910679, f1 0.9131578803062439
ep28_l2_test_time 0.8951733112335205
Test Epoch28 layer3 Acc 0.9126315789473685, AUC 0.9769135117530823, avg_entr 0.009512119926512241, f1 0.9126315712928772
ep28_l3_test_time 1.259026050567627
Test Epoch28 layer4 Acc 0.9131578947368421, AUC 0.9774900674819946, avg_entr 0.009247910231351852, f1 0.9131578803062439
ep28_l4_test_time 1.6269516944885254
gc 0
Train Epoch29 Acc 0.9698 (116376/120000), AUC 0.9959728121757507
ep29_train_time 123.4733636379242
Test Epoch29 layer0 Acc 0.9210526315789473, AUC 0.9821813106536865, avg_entr 0.03564415127038956, f1 0.9210526347160339
ep29_l0_test_time 0.15678882598876953
Test Epoch29 layer1 Acc 0.9121052631578948, AUC 0.9818745255470276, avg_entr 0.012058348394930363, f1 0.9121052622795105
ep29_l1_test_time 0.28466224670410156
Test Epoch29 layer2 Acc 0.9123684210526316, AUC 0.9806038737297058, avg_entr 0.009335590526461601, f1 0.9123684167861938
ep29_l2_test_time 0.4434347152709961
Test Epoch29 layer3 Acc 0.9123684210526316, AUC 0.9767900705337524, avg_entr 0.009312814101576805, f1 0.9123684167861938
ep29_l3_test_time 0.603872537612915
Test Epoch29 layer4 Acc 0.9131578947368421, AUC 0.9770898222923279, avg_entr 0.009070022962987423, f1 0.9131578803062439
ep29_l4_test_time 0.7652919292449951
Best AUC tensor(0.9232) 6 2
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 5592.249509572983
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt
Test layer0 Acc 0.9131578947368421, AUC 0.9809680581092834, avg_entr 0.07092037796974182, f1 0.9131578803062439
l0_test_time 0.15532803535461426
Test layer1 Acc 0.9076315789473685, AUC 0.9816129207611084, avg_entr 0.024490298703312874, f1 0.9076315760612488
l1_test_time 0.2840118408203125
Test layer2 Acc 0.9084210526315789, AUC 0.9829801321029663, avg_entr 0.021069364622235298, f1 0.9084210395812988
l2_test_time 0.4436020851135254
Test layer3 Acc 0.9084210526315789, AUC 0.9806375503540039, avg_entr 0.02078522928059101, f1 0.9084210395812988
l3_test_time 0.6042907238006592
Test layer4 Acc 0.9076315789473685, AUC 0.9801229238510132, avg_entr 0.020871153101325035, f1 0.9076315760612488
l4_test_time 0.7672045230865479
