total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 49.8552725315094
Start Training
gc 0
Train Epoch0 Acc 0.7136833333333333 (85642/120000), AUC 0.911638617515564
ep0_train_time 88.93568968772888
Test Epoch0 layer0 Acc 0.9047368421052632, AUC 0.9772562384605408, avg_entr 0.2561262845993042, f1 0.9047367572784424
ep0_l0_test_time 0.15967082977294922
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9047368421052632, AUC 0.9819258451461792, avg_entr 0.11163285374641418, f1 0.9047367572784424
ep0_l1_test_time 0.28992676734924316
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9047368421052632, AUC 0.9823645949363708, avg_entr 0.10719812661409378, f1 0.9047367572784424
ep0_l2_test_time 0.453902006149292
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.905, AUC 0.9785958528518677, avg_entr 0.1241515651345253, f1 0.9049999117851257
ep0_l3_test_time 0.6172091960906982
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer4 Acc 0.9042105263157895, AUC 0.9812102317810059, avg_entr 0.14475898444652557, f1 0.9042104482650757
ep0_l4_test_time 0.7803282737731934
gc 0
Train Epoch1 Acc 0.9200333333333334 (110404/120000), AUC 0.9815888404846191
ep1_train_time 89.08394241333008
Test Epoch1 layer0 Acc 0.9157894736842105, AUC 0.9805845618247986, avg_entr 0.14635565876960754, f1 0.9157894849777222
ep1_l0_test_time 0.15671086311340332
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9207894736842105, AUC 0.9845975637435913, avg_entr 0.05463998764753342, f1 0.9207894802093506
ep1_l1_test_time 0.28851962089538574
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9213157894736842, AUC 0.9854264259338379, avg_entr 0.05107269808650017, f1 0.9213157892227173
ep1_l2_test_time 0.44739818572998047
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9213157894736842, AUC 0.9820411205291748, avg_entr 0.056415390223264694, f1 0.9213157892227173
ep1_l3_test_time 0.6109323501586914
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.92, AUC 0.9841001629829407, avg_entr 0.06546204537153244, f1 0.9200000166893005
ep1_l4_test_time 0.7697386741638184
gc 0
Train Epoch2 Acc 0.9313916666666666 (111767/120000), AUC 0.9862724542617798
ep2_train_time 89.00772476196289
Test Epoch2 layer0 Acc 0.9194736842105263, AUC 0.9818515777587891, avg_entr 0.10980267822742462, f1 0.9194737076759338
ep2_l0_test_time 0.15689635276794434
Test Epoch2 layer1 Acc 0.9239473684210526, AUC 0.9850659370422363, avg_entr 0.038558103144168854, f1 0.9239473938941956
ep2_l1_test_time 0.2867164611816406
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.9231578947368421, AUC 0.9862846732139587, avg_entr 0.03560241311788559, f1 0.9231578707695007
ep2_l2_test_time 0.45037841796875
Test Epoch2 layer3 Acc 0.9223684210526316, AUC 0.9843935370445251, avg_entr 0.03814074769616127, f1 0.9223684072494507
ep2_l3_test_time 0.6123723983764648
Test Epoch2 layer4 Acc 0.9228947368421052, AUC 0.9841979742050171, avg_entr 0.04305156692862511, f1 0.9228947162628174
ep2_l4_test_time 0.775393009185791
gc 0
Train Epoch3 Acc 0.938575 (112629/120000), AUC 0.988659679889679
ep3_train_time 88.9395432472229
Test Epoch3 layer0 Acc 0.9228947368421052, AUC 0.9823970794677734, avg_entr 0.09330165386199951, f1 0.9228947162628174
ep3_l0_test_time 0.15609955787658691
Test Epoch3 layer1 Acc 0.9223684210526316, AUC 0.9848209023475647, avg_entr 0.03270762786269188, f1 0.9223684072494507
ep3_l1_test_time 0.28754663467407227
Test Epoch3 layer2 Acc 0.9231578947368421, AUC 0.9856911301612854, avg_entr 0.02916072867810726, f1 0.9231578707695007
ep3_l2_test_time 0.44887495040893555
Test Epoch3 layer3 Acc 0.9221052631578948, AUC 0.9837138652801514, avg_entr 0.02939741499722004, f1 0.9221052527427673
ep3_l3_test_time 0.6146328449249268
Test Epoch3 layer4 Acc 0.9207894736842105, AUC 0.9847014546394348, avg_entr 0.03096161037683487, f1 0.9207894802093506
ep3_l4_test_time 0.7773528099060059
gc 0
Train Epoch4 Acc 0.943825 (113259/120000), AUC 0.9904090166091919
ep4_train_time 89.10316824913025
Test Epoch4 layer0 Acc 0.9213157894736842, AUC 0.9826278686523438, avg_entr 0.0787004679441452, f1 0.9213157892227173
ep4_l0_test_time 0.156447172164917
Test Epoch4 layer1 Acc 0.9213157894736842, AUC 0.9843725562095642, avg_entr 0.02572033181786537, f1 0.9213157892227173
ep4_l1_test_time 0.28331875801086426
Test Epoch4 layer2 Acc 0.9197368421052632, AUC 0.9853599071502686, avg_entr 0.022834813222289085, f1 0.9197368621826172
ep4_l2_test_time 0.44373512268066406
Test Epoch4 layer3 Acc 0.9202631578947369, AUC 0.982795000076294, avg_entr 0.022570064291357994, f1 0.9202631711959839
ep4_l3_test_time 0.6049017906188965
Test Epoch4 layer4 Acc 0.9186842105263158, AUC 0.982970118522644, avg_entr 0.024761317297816277, f1 0.918684184551239
ep4_l4_test_time 0.7658202648162842
gc 0
Train Epoch5 Acc 0.9473416666666666 (113681/120000), AUC 0.9913278818130493
ep5_train_time 89.04197239875793
Test Epoch5 layer0 Acc 0.9226315789473685, AUC 0.9825489521026611, avg_entr 0.07067269086837769, f1 0.922631561756134
ep5_l0_test_time 0.15625286102294922
Test Epoch5 layer1 Acc 0.9192105263157895, AUC 0.9833236336708069, avg_entr 0.02528027631342411, f1 0.9192105531692505
ep5_l1_test_time 0.28424763679504395
Test Epoch5 layer2 Acc 0.9197368421052632, AUC 0.9842098355293274, avg_entr 0.022015733644366264, f1 0.9197368621826172
ep5_l2_test_time 0.4426286220550537
Test Epoch5 layer3 Acc 0.9207894736842105, AUC 0.9821436405181885, avg_entr 0.02205386385321617, f1 0.9207894802093506
ep5_l3_test_time 0.6042866706848145
Test Epoch5 layer4 Acc 0.9197368421052632, AUC 0.9828904271125793, avg_entr 0.023202447220683098, f1 0.9197368621826172
ep5_l4_test_time 0.7643172740936279
gc 0
Train Epoch6 Acc 0.9508666666666666 (114104/120000), AUC 0.9922345280647278
ep6_train_time 88.99207758903503
Test Epoch6 layer0 Acc 0.9223684210526316, AUC 0.9827656745910645, avg_entr 0.06736411154270172, f1 0.9223684072494507
ep6_l0_test_time 0.15735816955566406
Test Epoch6 layer1 Acc 0.9213157894736842, AUC 0.9842720031738281, avg_entr 0.02425413392484188, f1 0.9213157892227173
ep6_l1_test_time 0.2875649929046631
Test Epoch6 layer2 Acc 0.9213157894736842, AUC 0.9853043556213379, avg_entr 0.021016301587224007, f1 0.9213157892227173
ep6_l2_test_time 0.4485325813293457
Test Epoch6 layer3 Acc 0.9207894736842105, AUC 0.9833092093467712, avg_entr 0.020960340276360512, f1 0.9207894802093506
ep6_l3_test_time 0.614224910736084
Test Epoch6 layer4 Acc 0.9197368421052632, AUC 0.9827587008476257, avg_entr 0.021759556606411934, f1 0.9197368621826172
ep6_l4_test_time 0.7760307788848877
gc 0
Train Epoch7 Acc 0.9538916666666667 (114467/120000), AUC 0.9929684400558472
ep7_train_time 89.04578804969788
Test Epoch7 layer0 Acc 0.9226315789473685, AUC 0.9825199246406555, avg_entr 0.061680808663368225, f1 0.922631561756134
ep7_l0_test_time 0.15738606452941895
Test Epoch7 layer1 Acc 0.9178947368421052, AUC 0.9833187460899353, avg_entr 0.02192290499806404, f1 0.917894721031189
ep7_l1_test_time 0.2865779399871826
Test Epoch7 layer2 Acc 0.9178947368421052, AUC 0.9845260381698608, avg_entr 0.01872897893190384, f1 0.917894721031189
ep7_l2_test_time 0.44765543937683105
Test Epoch7 layer3 Acc 0.9171052631578948, AUC 0.9822485446929932, avg_entr 0.018814880400896072, f1 0.9171052575111389
ep7_l3_test_time 0.6134953498840332
Test Epoch7 layer4 Acc 0.9176315789473685, AUC 0.9817376136779785, avg_entr 0.020156672224402428, f1 0.9176315665245056
ep7_l4_test_time 0.7746579647064209
gc 0
Train Epoch8 Acc 0.956125 (114735/120000), AUC 0.9934263229370117
ep8_train_time 88.95384812355042
Test Epoch8 layer0 Acc 0.9197368421052632, AUC 0.9825247526168823, avg_entr 0.057535361498594284, f1 0.9197368621826172
ep8_l0_test_time 0.1573328971862793
Test Epoch8 layer1 Acc 0.9184210526315789, AUC 0.9829007983207703, avg_entr 0.01999753527343273, f1 0.9184210896492004
ep8_l1_test_time 0.28697729110717773
Test Epoch8 layer2 Acc 0.9192105263157895, AUC 0.9839898347854614, avg_entr 0.017677610740065575, f1 0.9192105531692505
ep8_l2_test_time 0.4495728015899658
Test Epoch8 layer3 Acc 0.9176315789473685, AUC 0.9816749691963196, avg_entr 0.017638402059674263, f1 0.9176315665245056
ep8_l3_test_time 0.6146755218505859
Test Epoch8 layer4 Acc 0.916578947368421, AUC 0.9805759191513062, avg_entr 0.018301261588931084, f1 0.9165789484977722
ep8_l4_test_time 0.7771947383880615
gc 0
Train Epoch9 Acc 0.9578833333333333 (114946/120000), AUC 0.9938322305679321
ep9_train_time 88.95178747177124
Test Epoch9 layer0 Acc 0.9194736842105263, AUC 0.9824576377868652, avg_entr 0.052528537809848785, f1 0.9194737076759338
ep9_l0_test_time 0.15723109245300293
Test Epoch9 layer1 Acc 0.9178947368421052, AUC 0.9828209280967712, avg_entr 0.018000027164816856, f1 0.917894721031189
ep9_l1_test_time 0.28403210639953613
Test Epoch9 layer2 Acc 0.9202631578947369, AUC 0.9836683869361877, avg_entr 0.015814486891031265, f1 0.9202631711959839
ep9_l2_test_time 0.4441959857940674
Test Epoch9 layer3 Acc 0.9213157894736842, AUC 0.9817359447479248, avg_entr 0.015701964497566223, f1 0.9213157892227173
ep9_l3_test_time 0.6044683456420898
Test Epoch9 layer4 Acc 0.9205263157894736, AUC 0.9813013076782227, avg_entr 0.016593504697084427, f1 0.9205263257026672
ep9_l4_test_time 0.7669007778167725
gc 0
Train Epoch10 Acc 0.9593 (115116/120000), AUC 0.9940841197967529
ep10_train_time 89.12386775016785
Test Epoch10 layer0 Acc 0.9207894736842105, AUC 0.9822338819503784, avg_entr 0.049996886402368546, f1 0.9207894802093506
ep10_l0_test_time 0.1567220687866211
Test Epoch10 layer1 Acc 0.9176315789473685, AUC 0.9827650785446167, avg_entr 0.01839517615735531, f1 0.9176315665245056
ep10_l1_test_time 0.28616762161254883
Test Epoch10 layer2 Acc 0.9173684210526316, AUC 0.9836438894271851, avg_entr 0.015129635110497475, f1 0.9173683524131775
ep10_l2_test_time 0.44652581214904785
Test Epoch10 layer3 Acc 0.9176315789473685, AUC 0.9810777902603149, avg_entr 0.014804653823375702, f1 0.9176315665245056
ep10_l3_test_time 0.6094636917114258
Test Epoch10 layer4 Acc 0.9157894736842105, AUC 0.9794121980667114, avg_entr 0.014933213591575623, f1 0.9157894849777222
ep10_l4_test_time 0.7691800594329834
gc 0
Train Epoch11 Acc 0.9621 (115452/120000), AUC 0.9946780204772949
ep11_train_time 89.06949853897095
Test Epoch11 layer0 Acc 0.9223684210526316, AUC 0.9822678565979004, avg_entr 0.04903946816921234, f1 0.9223684072494507
ep11_l0_test_time 0.15645051002502441
Test Epoch11 layer1 Acc 0.9152631578947369, AUC 0.9823021292686462, avg_entr 0.017743581905961037, f1 0.9152631759643555
ep11_l1_test_time 0.2881293296813965
Test Epoch11 layer2 Acc 0.9176315789473685, AUC 0.9831310510635376, avg_entr 0.015196915715932846, f1 0.9176315665245056
ep11_l2_test_time 0.4548959732055664
Test Epoch11 layer3 Acc 0.9160526315789473, AUC 0.9808262586593628, avg_entr 0.014303901232779026, f1 0.9160526394844055
ep11_l3_test_time 0.6139054298400879
Test Epoch11 layer4 Acc 0.915, AUC 0.9791111946105957, avg_entr 0.014402063563466072, f1 0.9150000214576721
ep11_l4_test_time 0.7748458385467529
gc 0
Train Epoch12 Acc 0.9632583333333333 (115591/120000), AUC 0.9947936534881592
ep12_train_time 89.13465595245361
Test Epoch12 layer0 Acc 0.9202631578947369, AUC 0.9821392297744751, avg_entr 0.04889003932476044, f1 0.9202631711959839
ep12_l0_test_time 0.1567697525024414
Test Epoch12 layer1 Acc 0.9147368421052632, AUC 0.9824255108833313, avg_entr 0.01651160605251789, f1 0.9147368669509888
ep12_l1_test_time 0.28830742835998535
Test Epoch12 layer2 Acc 0.9155263157894736, AUC 0.9833985567092896, avg_entr 0.013957111164927483, f1 0.9155263304710388
ep12_l2_test_time 0.44957661628723145
Test Epoch12 layer3 Acc 0.9163157894736842, AUC 0.981014609336853, avg_entr 0.013680984266102314, f1 0.9163157939910889
ep12_l3_test_time 0.6120033264160156
Test Epoch12 layer4 Acc 0.9144736842105263, AUC 0.9796650409698486, avg_entr 0.013528512790799141, f1 0.9144737124443054
ep12_l4_test_time 0.7736513614654541
gc 0
Train Epoch13 Acc 0.9636666666666667 (115640/120000), AUC 0.9948937296867371
ep13_train_time 89.12089204788208
Test Epoch13 layer0 Acc 0.92, AUC 0.9820952415466309, avg_entr 0.04605018347501755, f1 0.9200000166893005
ep13_l0_test_time 0.15679287910461426
Test Epoch13 layer1 Acc 0.9163157894736842, AUC 0.9822003841400146, avg_entr 0.016408028081059456, f1 0.9163157939910889
ep13_l1_test_time 0.28670310974121094
Test Epoch13 layer2 Acc 0.9178947368421052, AUC 0.983071506023407, avg_entr 0.014014148153364658, f1 0.917894721031189
ep13_l2_test_time 0.44702744483947754
Test Epoch13 layer3 Acc 0.9168421052631579, AUC 0.9807753562927246, avg_entr 0.014007552526891232, f1 0.9168421030044556
ep13_l3_test_time 0.6092913150787354
Test Epoch13 layer4 Acc 0.9163157894736842, AUC 0.9789345264434814, avg_entr 0.013838867656886578, f1 0.9163157939910889
ep13_l4_test_time 0.7671194076538086
gc 0
Train Epoch14 Acc 0.9642666666666667 (115712/120000), AUC 0.9950315952301025
ep14_train_time 89.07589340209961
Test Epoch14 layer0 Acc 0.9207894736842105, AUC 0.982040524482727, avg_entr 0.0429365374147892, f1 0.9207894802093506
ep14_l0_test_time 0.15749239921569824
Test Epoch14 layer1 Acc 0.9152631578947369, AUC 0.9821531772613525, avg_entr 0.01568491756916046, f1 0.9152631759643555
ep14_l1_test_time 0.2870140075683594
Test Epoch14 layer2 Acc 0.9163157894736842, AUC 0.983021080493927, avg_entr 0.013002288527786732, f1 0.9163157939910889
ep14_l2_test_time 0.4504663944244385
Test Epoch14 layer3 Acc 0.9160526315789473, AUC 0.9805750250816345, avg_entr 0.013164058327674866, f1 0.9160526394844055
ep14_l3_test_time 0.6156504154205322
Test Epoch14 layer4 Acc 0.9147368421052632, AUC 0.978698194026947, avg_entr 0.0125651890411973, f1 0.9147368669509888
ep14_l4_test_time 0.7787823677062988
gc 0
Train Epoch15 Acc 0.9660333333333333 (115924/120000), AUC 0.9952429533004761
ep15_train_time 88.97269892692566
Test Epoch15 layer0 Acc 0.9197368421052632, AUC 0.982011079788208, avg_entr 0.04328211024403572, f1 0.9197368621826172
ep15_l0_test_time 0.1567840576171875
Test Epoch15 layer1 Acc 0.9134210526315789, AUC 0.9820387363433838, avg_entr 0.014528955332934856, f1 0.9134210348129272
ep15_l1_test_time 0.2868764400482178
Test Epoch15 layer2 Acc 0.9152631578947369, AUC 0.9825564622879028, avg_entr 0.01224884856492281, f1 0.9152631759643555
ep15_l2_test_time 0.44852590560913086
Test Epoch15 layer3 Acc 0.9144736842105263, AUC 0.9802385568618774, avg_entr 0.011530397459864616, f1 0.9144737124443054
ep15_l3_test_time 0.6083381175994873
Test Epoch15 layer4 Acc 0.9123684210526316, AUC 0.9776999950408936, avg_entr 0.010586174204945564, f1 0.9123684167861938
ep15_l4_test_time 0.7685575485229492
gc 0
Train Epoch16 Acc 0.96645 (115974/120000), AUC 0.9953060150146484
ep16_train_time 89.04477453231812
Test Epoch16 layer0 Acc 0.9192105263157895, AUC 0.9819515943527222, avg_entr 0.04163959249854088, f1 0.9192105531692505
ep16_l0_test_time 0.15636229515075684
Test Epoch16 layer1 Acc 0.9155263157894736, AUC 0.9818625450134277, avg_entr 0.01517818495631218, f1 0.9155263304710388
ep16_l1_test_time 0.28806352615356445
Test Epoch16 layer2 Acc 0.9160526315789473, AUC 0.9827321171760559, avg_entr 0.012211441062390804, f1 0.9160526394844055
ep16_l2_test_time 0.4501204490661621
Test Epoch16 layer3 Acc 0.9157894736842105, AUC 0.9802132844924927, avg_entr 0.011966670863330364, f1 0.9157894849777222
ep16_l3_test_time 0.6116807460784912
Test Epoch16 layer4 Acc 0.9147368421052632, AUC 0.978093147277832, avg_entr 0.01148943416774273, f1 0.9147368669509888
ep16_l4_test_time 0.775170087814331
gc 0
Train Epoch17 Acc 0.96695 (116034/120000), AUC 0.9953078031539917
ep17_train_time 89.06189107894897
Test Epoch17 layer0 Acc 0.9197368421052632, AUC 0.981930673122406, avg_entr 0.04105059430003166, f1 0.9197368621826172
ep17_l0_test_time 0.1570601463317871
Test Epoch17 layer1 Acc 0.9147368421052632, AUC 0.9819170832633972, avg_entr 0.014336738735437393, f1 0.9147368669509888
ep17_l1_test_time 0.28734278678894043
Test Epoch17 layer2 Acc 0.9157894736842105, AUC 0.9823405146598816, avg_entr 0.011161776259541512, f1 0.9157894849777222
ep17_l2_test_time 0.4506652355194092
Test Epoch17 layer3 Acc 0.9147368421052632, AUC 0.9801911115646362, avg_entr 0.01110310759395361, f1 0.9147368669509888
ep17_l3_test_time 0.6110155582427979
Test Epoch17 layer4 Acc 0.9139473684210526, AUC 0.9778388738632202, avg_entr 0.01044012326747179, f1 0.913947343826294
ep17_l4_test_time 0.7743203639984131
gc 0
Train Epoch18 Acc 0.9671833333333333 (116062/120000), AUC 0.9953188896179199
ep18_train_time 89.13683533668518
Test Epoch18 layer0 Acc 0.9210526315789473, AUC 0.9818953275680542, avg_entr 0.03829061985015869, f1 0.9210526347160339
ep18_l0_test_time 0.1572878360748291
Test Epoch18 layer1 Acc 0.9142105263157895, AUC 0.981732189655304, avg_entr 0.01385499443858862, f1 0.9142104983329773
ep18_l1_test_time 0.28380346298217773
Test Epoch18 layer2 Acc 0.9155263157894736, AUC 0.9820657968521118, avg_entr 0.010924967005848885, f1 0.9155263304710388
ep18_l2_test_time 0.4444558620452881
Test Epoch18 layer3 Acc 0.9144736842105263, AUC 0.9798756241798401, avg_entr 0.010491752997040749, f1 0.9144737124443054
ep18_l3_test_time 0.6050059795379639
Test Epoch18 layer4 Acc 0.9131578947368421, AUC 0.9778690338134766, avg_entr 0.009706887416541576, f1 0.9131578803062439
ep18_l4_test_time 0.7653312683105469
gc 0
Train Epoch19 Acc 0.968025 (116163/120000), AUC 0.9954126477241516
ep19_train_time 89.07814884185791
Test Epoch19 layer0 Acc 0.9192105263157895, AUC 0.9819030165672302, avg_entr 0.037617363035678864, f1 0.9192105531692505
ep19_l0_test_time 0.1567091941833496
Test Epoch19 layer1 Acc 0.9139473684210526, AUC 0.9817835688591003, avg_entr 0.014069143682718277, f1 0.913947343826294
ep19_l1_test_time 0.2844417095184326
Test Epoch19 layer2 Acc 0.915, AUC 0.9822456240653992, avg_entr 0.010800439864397049, f1 0.9150000214576721
ep19_l2_test_time 0.4433588981628418
Test Epoch19 layer3 Acc 0.9134210526315789, AUC 0.9799661636352539, avg_entr 0.010554918088018894, f1 0.9134210348129272
ep19_l3_test_time 0.6036839485168457
Test Epoch19 layer4 Acc 0.9134210526315789, AUC 0.9770359992980957, avg_entr 0.009660083800554276, f1 0.9134210348129272
ep19_l4_test_time 0.7656021118164062
gc 0
Train Epoch20 Acc 0.9682833333333334 (116194/120000), AUC 0.9954051375389099
ep20_train_time 89.01979637145996
Test Epoch20 layer0 Acc 0.9207894736842105, AUC 0.9818903207778931, avg_entr 0.03701484203338623, f1 0.9207894802093506
ep20_l0_test_time 0.15690064430236816
Test Epoch20 layer1 Acc 0.9136842105263158, AUC 0.9817229509353638, avg_entr 0.013929593376815319, f1 0.9136841893196106
ep20_l1_test_time 0.28738975524902344
Test Epoch20 layer2 Acc 0.915, AUC 0.9820409417152405, avg_entr 0.010271234437823296, f1 0.9150000214576721
ep20_l2_test_time 0.44896650314331055
Test Epoch20 layer3 Acc 0.9134210526315789, AUC 0.9798213243484497, avg_entr 0.010377448052167892, f1 0.9134210348129272
ep20_l3_test_time 0.6121759414672852
Test Epoch20 layer4 Acc 0.9134210526315789, AUC 0.9774482250213623, avg_entr 0.009574721567332745, f1 0.9134210348129272
ep20_l4_test_time 0.7760014533996582
gc 0
Train Epoch21 Acc 0.9682916666666667 (116195/120000), AUC 0.9954442977905273
ep21_train_time 89.05909132957458
Test Epoch21 layer0 Acc 0.9189473684210526, AUC 0.9818828105926514, avg_entr 0.03672420606017113, f1 0.9189472794532776
ep21_l0_test_time 0.1568613052368164
Test Epoch21 layer1 Acc 0.9128947368421053, AUC 0.9816965460777283, avg_entr 0.012720275670289993, f1 0.9128947257995605
ep21_l1_test_time 0.28722262382507324
Test Epoch21 layer2 Acc 0.9128947368421053, AUC 0.9816672801971436, avg_entr 0.010025862604379654, f1 0.9128947257995605
ep21_l2_test_time 0.4489762783050537
Test Epoch21 layer3 Acc 0.911578947368421, AUC 0.9792506694793701, avg_entr 0.010151802562177181, f1 0.9115789532661438
ep21_l3_test_time 0.6123371124267578
Test Epoch21 layer4 Acc 0.9118421052631579, AUC 0.9765952825546265, avg_entr 0.009498030878603458, f1 0.9118421077728271
ep21_l4_test_time 0.7752904891967773
gc 0
Train Epoch22 Acc 0.9686083333333333 (116233/120000), AUC 0.9954599738121033
ep22_train_time 89.05769443511963
Test Epoch22 layer0 Acc 0.9189473684210526, AUC 0.9818530678749084, avg_entr 0.0359560064971447, f1 0.9189472794532776
ep22_l0_test_time 0.15687131881713867
Test Epoch22 layer1 Acc 0.9131578947368421, AUC 0.9816333055496216, avg_entr 0.013041127473115921, f1 0.9131578803062439
ep22_l1_test_time 0.2876250743865967
Test Epoch22 layer2 Acc 0.915, AUC 0.981666088104248, avg_entr 0.00980773102492094, f1 0.9150000214576721
ep22_l2_test_time 0.44738268852233887
Test Epoch22 layer3 Acc 0.9131578947368421, AUC 0.9796371459960938, avg_entr 0.009455224499106407, f1 0.9131578803062439
ep22_l3_test_time 0.6110808849334717
Test Epoch22 layer4 Acc 0.9126315789473685, AUC 0.977308988571167, avg_entr 0.008856241591274738, f1 0.9126315712928772
ep22_l4_test_time 0.7738065719604492
gc 0
Train Epoch23 Acc 0.969025 (116283/120000), AUC 0.9955021142959595
ep23_train_time 89.13818669319153
Test Epoch23 layer0 Acc 0.9202631578947369, AUC 0.9818484783172607, avg_entr 0.03572462871670723, f1 0.9202631711959839
ep23_l0_test_time 0.15708327293395996
Test Epoch23 layer1 Acc 0.9134210526315789, AUC 0.9816186428070068, avg_entr 0.012671955861151218, f1 0.9134210348129272
ep23_l1_test_time 0.2855205535888672
Test Epoch23 layer2 Acc 0.9142105263157895, AUC 0.9818373918533325, avg_entr 0.009443522430956364, f1 0.9142104983329773
ep23_l2_test_time 0.4435126781463623
Test Epoch23 layer3 Acc 0.9128947368421053, AUC 0.9794276356697083, avg_entr 0.009824017062783241, f1 0.9128947257995605
ep23_l3_test_time 0.604210376739502
Test Epoch23 layer4 Acc 0.9128947368421053, AUC 0.976834774017334, avg_entr 0.008691834285855293, f1 0.9128947257995605
ep23_l4_test_time 0.7665736675262451
gc 0
Train Epoch24 Acc 0.9691166666666666 (116294/120000), AUC 0.9955087304115295
ep24_train_time 89.20954155921936
Test Epoch24 layer0 Acc 0.9192105263157895, AUC 0.9818573594093323, avg_entr 0.0358610637485981, f1 0.9192105531692505
ep24_l0_test_time 0.15716338157653809
Test Epoch24 layer1 Acc 0.9139473684210526, AUC 0.98164302110672, avg_entr 0.012262937612831593, f1 0.913947343826294
ep24_l1_test_time 0.283278226852417
Test Epoch24 layer2 Acc 0.9142105263157895, AUC 0.9817671775817871, avg_entr 0.009095710702240467, f1 0.9142104983329773
ep24_l2_test_time 0.4429147243499756
Test Epoch24 layer3 Acc 0.9128947368421053, AUC 0.9796748757362366, avg_entr 0.009470416232943535, f1 0.9128947257995605
ep24_l3_test_time 0.6043479442596436
Test Epoch24 layer4 Acc 0.9126315789473685, AUC 0.9771493673324585, avg_entr 0.008525289595127106, f1 0.9126315712928772
ep24_l4_test_time 0.7673413753509521
gc 0
Train Epoch25 Acc 0.969125 (116295/120000), AUC 0.9955414533615112
ep25_train_time 89.04527568817139
Test Epoch25 layer0 Acc 0.9186842105263158, AUC 0.9818476438522339, avg_entr 0.035616543143987656, f1 0.918684184551239
ep25_l0_test_time 0.15717124938964844
Test Epoch25 layer1 Acc 0.9128947368421053, AUC 0.9814215898513794, avg_entr 0.01266595907509327, f1 0.9128947257995605
ep25_l1_test_time 0.28711652755737305
Test Epoch25 layer2 Acc 0.9126315789473685, AUC 0.9814198017120361, avg_entr 0.009027495048940182, f1 0.9126315712928772
ep25_l2_test_time 0.4480876922607422
Test Epoch25 layer3 Acc 0.9121052631578948, AUC 0.9791314601898193, avg_entr 0.009625374339520931, f1 0.9121052622795105
ep25_l3_test_time 0.6121037006378174
Test Epoch25 layer4 Acc 0.9126315789473685, AUC 0.9765200018882751, avg_entr 0.008581277914345264, f1 0.9126315712928772
ep25_l4_test_time 0.7759487628936768
gc 0
Train Epoch26 Acc 0.9692666666666667 (116312/120000), AUC 0.9955344200134277
ep26_train_time 89.07249593734741
Test Epoch26 layer0 Acc 0.9197368421052632, AUC 0.9818171262741089, avg_entr 0.035123247653245926, f1 0.9197368621826172
ep26_l0_test_time 0.15687203407287598
Test Epoch26 layer1 Acc 0.9131578947368421, AUC 0.9815079569816589, avg_entr 0.012374126352369785, f1 0.9131578803062439
ep26_l1_test_time 0.28693318367004395
Test Epoch26 layer2 Acc 0.9134210526315789, AUC 0.9813716411590576, avg_entr 0.00883249007165432, f1 0.9134210348129272
ep26_l2_test_time 0.4483683109283447
Test Epoch26 layer3 Acc 0.9123684210526316, AUC 0.9793679714202881, avg_entr 0.009312675334513187, f1 0.9123684167861938
ep26_l3_test_time 0.6122598648071289
Test Epoch26 layer4 Acc 0.9126315789473685, AUC 0.9764609932899475, avg_entr 0.008352859877049923, f1 0.9126315712928772
ep26_l4_test_time 0.7764027118682861
gc 0
Train Epoch27 Acc 0.9694333333333334 (116332/120000), AUC 0.9955637454986572
ep27_train_time 89.14133644104004
Test Epoch27 layer0 Acc 0.9189473684210526, AUC 0.9818163514137268, avg_entr 0.03519060090184212, f1 0.9189472794532776
ep27_l0_test_time 0.15585827827453613
Test Epoch27 layer1 Acc 0.9131578947368421, AUC 0.9814555644989014, avg_entr 0.012378498911857605, f1 0.9131578803062439
ep27_l1_test_time 0.2861778736114502
Test Epoch27 layer2 Acc 0.9134210526315789, AUC 0.9814451336860657, avg_entr 0.008839580230414867, f1 0.9134210348129272
ep27_l2_test_time 0.4475126266479492
Test Epoch27 layer3 Acc 0.9123684210526316, AUC 0.9794025421142578, avg_entr 0.009229863062500954, f1 0.9123684167861938
ep27_l3_test_time 0.610466480255127
Test Epoch27 layer4 Acc 0.9123684210526316, AUC 0.9765798449516296, avg_entr 0.008564505726099014, f1 0.9123684167861938
ep27_l4_test_time 0.774662971496582
gc 0
Train Epoch28 Acc 0.9694916666666666 (116339/120000), AUC 0.9955650568008423
ep28_train_time 89.1019926071167
Test Epoch28 layer0 Acc 0.9189473684210526, AUC 0.9818224906921387, avg_entr 0.034870244562625885, f1 0.9189472794532776
ep28_l0_test_time 0.15705251693725586
Test Epoch28 layer1 Acc 0.9134210526315789, AUC 0.9815057516098022, avg_entr 0.012060378678143024, f1 0.9134210348129272
ep28_l1_test_time 0.2841215133666992
Test Epoch28 layer2 Acc 0.9142105263157895, AUC 0.9815751314163208, avg_entr 0.008884056471288204, f1 0.9142104983329773
ep28_l2_test_time 0.44244980812072754
Test Epoch28 layer3 Acc 0.9121052631578948, AUC 0.9793968200683594, avg_entr 0.00895429402589798, f1 0.9121052622795105
ep28_l3_test_time 0.6041820049285889
Test Epoch28 layer4 Acc 0.9121052631578948, AUC 0.9767807126045227, avg_entr 0.008202540688216686, f1 0.9121052622795105
ep28_l4_test_time 0.7652950286865234
gc 0
Train Epoch29 Acc 0.96945 (116334/120000), AUC 0.9955737590789795
ep29_train_time 89.00039720535278
Test Epoch29 layer0 Acc 0.9192105263157895, AUC 0.9818118810653687, avg_entr 0.034760065376758575, f1 0.9192105531692505
ep29_l0_test_time 0.1562037467956543
Test Epoch29 layer1 Acc 0.9131578947368421, AUC 0.9814672470092773, avg_entr 0.011956525035202503, f1 0.9131578803062439
ep29_l1_test_time 0.28289294242858887
Test Epoch29 layer2 Acc 0.9136842105263158, AUC 0.9815114736557007, avg_entr 0.008771205320954323, f1 0.9136841893196106
ep29_l2_test_time 0.4426441192626953
Test Epoch29 layer3 Acc 0.9113157894736842, AUC 0.9794450998306274, avg_entr 0.009236662648618221, f1 0.9113157987594604
ep29_l3_test_time 0.6030399799346924
Test Epoch29 layer4 Acc 0.9118421052631579, AUC 0.976668119430542, avg_entr 0.008404042571783066, f1 0.9118421077728271
ep29_l4_test_time 0.765981912612915
Best AUC tensor(0.9239) 2 1
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 2742.084741830826
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt
Test layer0 Acc 0.9121052631578948, AUC 0.9795664548873901, avg_entr 0.11536195129156113, f1 0.9121052622795105
l0_test_time 0.15498638153076172
Test layer1 Acc 0.9147368421052632, AUC 0.9829394221305847, avg_entr 0.04385954514145851, f1 0.9147368669509888
l1_test_time 0.2839217185974121
Test layer2 Acc 0.9123684210526316, AUC 0.9834445714950562, avg_entr 0.03994205966591835, f1 0.9123684167861938
l2_test_time 0.44392824172973633
Test layer3 Acc 0.9118421052631579, AUC 0.9821380376815796, avg_entr 0.04236718267202377, f1 0.9118421077728271
l3_test_time 0.6040747165679932
Test layer4 Acc 0.9107894736842105, AUC 0.9821631908416748, avg_entr 0.04659738391637802, f1 0.9107894897460938
l4_test_time 0.7665424346923828
