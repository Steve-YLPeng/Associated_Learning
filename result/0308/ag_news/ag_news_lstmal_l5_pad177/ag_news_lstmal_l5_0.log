total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 21.896804094314575
Start Training
gc 0
Train Epoch0 Acc 0.7313916666666667 (87767/120000), AUC 0.9163442850112915
ep0_train_time 184.05571699142456
Test Epoch0 layer0 Acc 0.9026315789473685, AUC 0.976868748664856, avg_entr 0.25307121872901917, f1 0.9026315808296204
ep0_l0_test_time 0.3274500370025635
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9055263157894737, AUC 0.9808254241943359, avg_entr 0.11752808094024658, f1 0.905526340007782
ep0_l1_test_time 0.6011784076690674
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9044736842105263, AUC 0.9815585017204285, avg_entr 0.11312998086214066, f1 0.9044736623764038
ep0_l2_test_time 0.9026782512664795
Test Epoch0 layer3 Acc 0.9042105263157895, AUC 0.9785895943641663, avg_entr 0.11666541546583176, f1 0.9042104482650757
ep0_l3_test_time 1.268763780593872
Test Epoch0 layer4 Acc 0.9034210526315789, AUC 0.9806640148162842, avg_entr 0.1155310794711113, f1 0.9034210443496704
ep0_l4_test_time 1.6388916969299316
gc 0
Train Epoch1 Acc 0.9198416666666667 (110381/120000), AUC 0.9816378355026245
ep1_train_time 184.0764582157135
Test Epoch1 layer0 Acc 0.9144736842105263, AUC 0.9803036451339722, avg_entr 0.14798800647258759, f1 0.9144737124443054
ep1_l0_test_time 0.327850341796875
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9186842105263158, AUC 0.9837150573730469, avg_entr 0.05479872599244118, f1 0.918684184551239
ep1_l1_test_time 0.6010947227478027
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9178947368421052, AUC 0.9846862554550171, avg_entr 0.051829103380441666, f1 0.917894721031189
ep1_l2_test_time 0.9018979072570801
Test Epoch1 layer3 Acc 0.9181578947368421, AUC 0.9830670952796936, avg_entr 0.05375012755393982, f1 0.9181578755378723
ep1_l3_test_time 1.2575740814208984
Test Epoch1 layer4 Acc 0.9178947368421052, AUC 0.9840471744537354, avg_entr 0.05248776823282242, f1 0.917894721031189
ep1_l4_test_time 1.6308448314666748
gc 0
Train Epoch2 Acc 0.9319333333333333 (111832/120000), AUC 0.9865542650222778
ep2_train_time 176.50459933280945
Test Epoch2 layer0 Acc 0.9205263157894736, AUC 0.981395959854126, avg_entr 0.11012454330921173, f1 0.9205263257026672
ep2_l0_test_time 0.1607189178466797
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.9221052631578948, AUC 0.9839962124824524, avg_entr 0.036359235644340515, f1 0.9221052527427673
ep2_l1_test_time 0.29485130310058594
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.9205263157894736, AUC 0.9844334125518799, avg_entr 0.03265048936009407, f1 0.9205263257026672
ep2_l2_test_time 0.4567532539367676
Test Epoch2 layer3 Acc 0.9223684210526316, AUC 0.9819245934486389, avg_entr 0.03251944109797478, f1 0.9223684072494507
ep2_l3_test_time 0.6168253421783447
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.9226315789473685, AUC 0.984408438205719, avg_entr 0.03130382299423218, f1 0.922631561756134
ep2_l4_test_time 0.7824299335479736
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.93905 (112686/120000), AUC 0.98902827501297
ep3_train_time 89.02524161338806
Test Epoch3 layer0 Acc 0.9236842105263158, AUC 0.9822342395782471, avg_entr 0.08948487788438797, f1 0.9236842393875122
ep3_l0_test_time 0.15926051139831543
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.9218421052631579, AUC 0.9842832684516907, avg_entr 0.03167619928717613, f1 0.921842098236084
ep3_l1_test_time 0.29295992851257324
Test Epoch3 layer2 Acc 0.921578947368421, AUC 0.9851128458976746, avg_entr 0.02842320129275322, f1 0.9215789437294006
ep3_l2_test_time 0.45331525802612305
Test Epoch3 layer3 Acc 0.9236842105263158, AUC 0.9829426407814026, avg_entr 0.0299687497317791, f1 0.9236842393875122
ep3_l3_test_time 0.6176261901855469
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.9228947368421052, AUC 0.9845002889633179, avg_entr 0.02986176684498787, f1 0.9228947162628174
ep3_l4_test_time 0.7836048603057861
gc 0
Train Epoch4 Acc 0.9435666666666667 (113228/120000), AUC 0.9906090497970581
ep4_train_time 89.21803498268127
Test Epoch4 layer0 Acc 0.9221052631578948, AUC 0.9824362397193909, avg_entr 0.07866300642490387, f1 0.9221052527427673
ep4_l0_test_time 0.1592857837677002
Test Epoch4 layer1 Acc 0.9207894736842105, AUC 0.9844123721122742, avg_entr 0.027778223156929016, f1 0.9207894802093506
ep4_l1_test_time 0.2932889461517334
Test Epoch4 layer2 Acc 0.9210526315789473, AUC 0.984858512878418, avg_entr 0.023766783997416496, f1 0.9210526347160339
ep4_l2_test_time 0.45081543922424316
Test Epoch4 layer3 Acc 0.9213157894736842, AUC 0.9826724529266357, avg_entr 0.023553527891635895, f1 0.9213157892227173
ep4_l3_test_time 0.609400749206543
Test Epoch4 layer4 Acc 0.9205263157894736, AUC 0.9836289882659912, avg_entr 0.022925598546862602, f1 0.9205263257026672
ep4_l4_test_time 0.774519681930542
gc 0
Train Epoch5 Acc 0.9475833333333333 (113710/120000), AUC 0.9916814565658569
ep5_train_time 89.1198616027832
Test Epoch5 layer0 Acc 0.9213157894736842, AUC 0.9826211929321289, avg_entr 0.07151471823453903, f1 0.9213157892227173
ep5_l0_test_time 0.16086506843566895
Test Epoch5 layer1 Acc 0.9194736842105263, AUC 0.9837687015533447, avg_entr 0.02328157238662243, f1 0.9194737076759338
ep5_l1_test_time 0.29167747497558594
Test Epoch5 layer2 Acc 0.9194736842105263, AUC 0.9839205741882324, avg_entr 0.019598931074142456, f1 0.9194737076759338
ep5_l2_test_time 0.45630788803100586
Test Epoch5 layer3 Acc 0.9197368421052632, AUC 0.9815914630889893, avg_entr 0.019103839993476868, f1 0.9197368621826172
ep5_l3_test_time 0.6186821460723877
Test Epoch5 layer4 Acc 0.9197368421052632, AUC 0.982563853263855, avg_entr 0.01831705868244171, f1 0.9197368621826172
ep5_l4_test_time 0.7857086658477783
gc 0
Train Epoch6 Acc 0.9508 (114096/120000), AUC 0.992363691329956
ep6_train_time 89.00771808624268
Test Epoch6 layer0 Acc 0.9236842105263158, AUC 0.9824708700180054, avg_entr 0.06400154531002045, f1 0.9236842393875122
ep6_l0_test_time 0.16011524200439453
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 6
Test Epoch6 layer1 Acc 0.9205263157894736, AUC 0.983020007610321, avg_entr 0.021931201219558716, f1 0.9205263257026672
ep6_l1_test_time 0.2930729389190674
Test Epoch6 layer2 Acc 0.92, AUC 0.9840834736824036, avg_entr 0.019089549779891968, f1 0.9200000166893005
ep6_l2_test_time 0.45006775856018066
Test Epoch6 layer3 Acc 0.92, AUC 0.9803869724273682, avg_entr 0.018653633072972298, f1 0.9200000166893005
ep6_l3_test_time 0.6101922988891602
Test Epoch6 layer4 Acc 0.9197368421052632, AUC 0.9828806519508362, avg_entr 0.018483970314264297, f1 0.9197368621826172
ep6_l4_test_time 0.7741904258728027
gc 0
Train Epoch7 Acc 0.9537666666666667 (114452/120000), AUC 0.9930474758148193
ep7_train_time 89.07507395744324
Test Epoch7 layer0 Acc 0.9194736842105263, AUC 0.9825800061225891, avg_entr 0.063130222260952, f1 0.9194737076759338
ep7_l0_test_time 0.16114401817321777
Test Epoch7 layer1 Acc 0.9186842105263158, AUC 0.9829951524734497, avg_entr 0.020496994256973267, f1 0.918684184551239
ep7_l1_test_time 0.29261326789855957
Test Epoch7 layer2 Acc 0.9197368421052632, AUC 0.9838468432426453, avg_entr 0.01871487870812416, f1 0.9197368621826172
ep7_l2_test_time 0.45554471015930176
Test Epoch7 layer3 Acc 0.9197368421052632, AUC 0.9812707901000977, avg_entr 0.01856978051364422, f1 0.9197368621826172
ep7_l3_test_time 0.6181361675262451
Test Epoch7 layer4 Acc 0.9186842105263158, AUC 0.9820518493652344, avg_entr 0.018240688368678093, f1 0.918684184551239
ep7_l4_test_time 0.784991979598999
gc 0
Train Epoch8 Acc 0.9559333333333333 (114712/120000), AUC 0.9934459328651428
ep8_train_time 89.35324144363403
Test Epoch8 layer0 Acc 0.9213157894736842, AUC 0.9822632074356079, avg_entr 0.05744472146034241, f1 0.9213157892227173
ep8_l0_test_time 0.1626582145690918
Test Epoch8 layer1 Acc 0.9197368421052632, AUC 0.9834222793579102, avg_entr 0.01826651208102703, f1 0.9197368621826172
ep8_l1_test_time 0.29639554023742676
Test Epoch8 layer2 Acc 0.9189473684210526, AUC 0.9842504262924194, avg_entr 0.015811828896403313, f1 0.9189472794532776
ep8_l2_test_time 0.47696805000305176
Test Epoch8 layer3 Acc 0.9189473684210526, AUC 0.9805940985679626, avg_entr 0.01601477526128292, f1 0.9189472794532776
ep8_l3_test_time 0.6811368465423584
Test Epoch8 layer4 Acc 0.9186842105263158, AUC 0.9812262058258057, avg_entr 0.01574154570698738, f1 0.918684184551239
ep8_l4_test_time 0.8535192012786865
gc 0
Train Epoch9 Acc 0.9583 (114996/120000), AUC 0.9939026236534119
ep9_train_time 182.99456453323364
Test Epoch9 layer0 Acc 0.9218421052631579, AUC 0.9823408722877502, avg_entr 0.053357504308223724, f1 0.921842098236084
ep9_l0_test_time 0.3363513946533203
Test Epoch9 layer1 Acc 0.9173684210526316, AUC 0.9827736616134644, avg_entr 0.017528481781482697, f1 0.9173683524131775
ep9_l1_test_time 0.5987381935119629
Test Epoch9 layer2 Acc 0.9192105263157895, AUC 0.9836913347244263, avg_entr 0.015066796913743019, f1 0.9192105531692505
ep9_l2_test_time 0.8973057270050049
Test Epoch9 layer3 Acc 0.9202631578947369, AUC 0.9792959690093994, avg_entr 0.015189574100077152, f1 0.9202631711959839
ep9_l3_test_time 1.2687175273895264
Test Epoch9 layer4 Acc 0.92, AUC 0.9811307787895203, avg_entr 0.015125874429941177, f1 0.9200000166893005
ep9_l4_test_time 1.6150834560394287
gc 0
Train Epoch10 Acc 0.9613166666666667 (115358/120000), AUC 0.9944929480552673
ep10_train_time 184.67189621925354
Test Epoch10 layer0 Acc 0.9221052631578948, AUC 0.9822449088096619, avg_entr 0.05099555477499962, f1 0.9221052527427673
ep10_l0_test_time 0.3363823890686035
Test Epoch10 layer1 Acc 0.916578947368421, AUC 0.9826257824897766, avg_entr 0.017606426030397415, f1 0.9165789484977722
ep10_l1_test_time 0.5897221565246582
Test Epoch10 layer2 Acc 0.9176315789473685, AUC 0.9829105138778687, avg_entr 0.014642794616520405, f1 0.9176315665245056
ep10_l2_test_time 0.9040799140930176
Test Epoch10 layer3 Acc 0.9178947368421052, AUC 0.9787794947624207, avg_entr 0.014930506236851215, f1 0.917894721031189
ep10_l3_test_time 1.2517216205596924
Test Epoch10 layer4 Acc 0.9176315789473685, AUC 0.9801524877548218, avg_entr 0.014254429377615452, f1 0.9176315665245056
ep10_l4_test_time 1.6101694107055664
gc 0
Train Epoch11 Acc 0.9625416666666666 (115505/120000), AUC 0.9947201013565063
ep11_train_time 184.65247511863708
Test Epoch11 layer0 Acc 0.9205263157894736, AUC 0.9822192192077637, avg_entr 0.050550706684589386, f1 0.9205263257026672
ep11_l0_test_time 0.3292574882507324
Test Epoch11 layer1 Acc 0.9139473684210526, AUC 0.9811130166053772, avg_entr 0.015523898415267467, f1 0.913947343826294
ep11_l1_test_time 0.5979428291320801
Test Epoch11 layer2 Acc 0.916578947368421, AUC 0.9818955063819885, avg_entr 0.013430864550173283, f1 0.9165789484977722
ep11_l2_test_time 0.9003887176513672
Test Epoch11 layer3 Acc 0.916578947368421, AUC 0.9770795106887817, avg_entr 0.013824325986206532, f1 0.9165789484977722
ep11_l3_test_time 1.2755749225616455
Test Epoch11 layer4 Acc 0.9157894736842105, AUC 0.9793530702590942, avg_entr 0.013036251068115234, f1 0.9157894849777222
ep11_l4_test_time 1.641897439956665
gc 0
Train Epoch12 Acc 0.9634666666666667 (115616/120000), AUC 0.9948094487190247
ep12_train_time 183.95584845542908
Test Epoch12 layer0 Acc 0.9218421052631579, AUC 0.9819936156272888, avg_entr 0.04714424908161163, f1 0.921842098236084
ep12_l0_test_time 0.3322288990020752
Test Epoch12 layer1 Acc 0.916578947368421, AUC 0.982189416885376, avg_entr 0.01487263385206461, f1 0.9165789484977722
ep12_l1_test_time 0.607684850692749
Test Epoch12 layer2 Acc 0.9181578947368421, AUC 0.9832308888435364, avg_entr 0.013465791940689087, f1 0.9181578755378723
ep12_l2_test_time 0.9045274257659912
Test Epoch12 layer3 Acc 0.9181578947368421, AUC 0.9779896140098572, avg_entr 0.014041147194802761, f1 0.9181578755378723
ep12_l3_test_time 1.2816276550292969
Test Epoch12 layer4 Acc 0.9181578947368421, AUC 0.979606568813324, avg_entr 0.013432220555841923, f1 0.9181578755378723
ep12_l4_test_time 1.6441590785980225
gc 0
Train Epoch13 Acc 0.9651166666666666 (115814/120000), AUC 0.9948820471763611
ep13_train_time 184.69431352615356
Test Epoch13 layer0 Acc 0.9221052631578948, AUC 0.9819770455360413, avg_entr 0.045470912009477615, f1 0.9221052527427673
ep13_l0_test_time 0.3367438316345215
Test Epoch13 layer1 Acc 0.9155263157894736, AUC 0.981623113155365, avg_entr 0.014990272931754589, f1 0.9155263304710388
ep13_l1_test_time 0.6043012142181396
Test Epoch13 layer2 Acc 0.9184210526315789, AUC 0.9825984239578247, avg_entr 0.01284739002585411, f1 0.9184210896492004
ep13_l2_test_time 0.9083549976348877
Test Epoch13 layer3 Acc 0.9186842105263158, AUC 0.9777800440788269, avg_entr 0.0125391511246562, f1 0.918684184551239
ep13_l3_test_time 1.2712843418121338
Test Epoch13 layer4 Acc 0.916578947368421, AUC 0.9790378212928772, avg_entr 0.01172510627657175, f1 0.9165789484977722
ep13_l4_test_time 1.6516387462615967
gc 0
Train Epoch14 Acc 0.9665 (115980/120000), AUC 0.9951395988464355
ep14_train_time 163.65453791618347
Test Epoch14 layer0 Acc 0.921578947368421, AUC 0.9819450378417969, avg_entr 0.044403232634067535, f1 0.9215789437294006
ep14_l0_test_time 0.1631321907043457
Test Epoch14 layer1 Acc 0.916578947368421, AUC 0.9816336631774902, avg_entr 0.014538235031068325, f1 0.9165789484977722
ep14_l1_test_time 0.2930741310119629
Test Epoch14 layer2 Acc 0.9163157894736842, AUC 0.9825736284255981, avg_entr 0.01200452446937561, f1 0.9163157939910889
ep14_l2_test_time 0.4536275863647461
Test Epoch14 layer3 Acc 0.9168421052631579, AUC 0.9777121543884277, avg_entr 0.011609679087996483, f1 0.9168421030044556
ep14_l3_test_time 0.6107854843139648
Test Epoch14 layer4 Acc 0.9163157894736842, AUC 0.9792638421058655, avg_entr 0.011084946803748608, f1 0.9163157939910889
ep14_l4_test_time 0.7721207141876221
gc 0
Train Epoch15 Acc 0.9674083333333333 (116089/120000), AUC 0.995220422744751
ep15_train_time 177.52502369880676
Test Epoch15 layer0 Acc 0.9213157894736842, AUC 0.981858491897583, avg_entr 0.04279598593711853, f1 0.9213157892227173
ep15_l0_test_time 0.31686878204345703
Test Epoch15 layer1 Acc 0.9155263157894736, AUC 0.9813598394393921, avg_entr 0.013664178550243378, f1 0.9155263304710388
ep15_l1_test_time 0.588134765625
Test Epoch15 layer2 Acc 0.9168421052631579, AUC 0.9819339513778687, avg_entr 0.011042077094316483, f1 0.9168421030044556
ep15_l2_test_time 0.880502462387085
Test Epoch15 layer3 Acc 0.9168421052631579, AUC 0.9769251346588135, avg_entr 0.011385425925254822, f1 0.9168421030044556
ep15_l3_test_time 1.2531323432922363
Test Epoch15 layer4 Acc 0.9157894736842105, AUC 0.9788762927055359, avg_entr 0.010635783895850182, f1 0.9157894849777222
ep15_l4_test_time 1.5962717533111572
gc 0
Train Epoch16 Acc 0.9678 (116136/120000), AUC 0.9952273964881897
ep16_train_time 183.07942032814026
Test Epoch16 layer0 Acc 0.9207894736842105, AUC 0.9818891286849976, avg_entr 0.04157360643148422, f1 0.9207894802093506
ep16_l0_test_time 0.32027578353881836
Test Epoch16 layer1 Acc 0.9155263157894736, AUC 0.9813036918640137, avg_entr 0.013432295992970467, f1 0.9155263304710388
ep16_l1_test_time 0.5930299758911133
Test Epoch16 layer2 Acc 0.9168421052631579, AUC 0.9821216464042664, avg_entr 0.012132068164646626, f1 0.9168421030044556
ep16_l2_test_time 0.8971357345581055
Test Epoch16 layer3 Acc 0.9171052631578948, AUC 0.976415753364563, avg_entr 0.011951571330428123, f1 0.9171052575111389
ep16_l3_test_time 1.2600769996643066
Test Epoch16 layer4 Acc 0.9173684210526316, AUC 0.9779489040374756, avg_entr 0.010823508724570274, f1 0.9173683524131775
ep16_l4_test_time 1.638159990310669
gc 0
Train Epoch17 Acc 0.968275 (116193/120000), AUC 0.9952483773231506
ep17_train_time 183.03382921218872
Test Epoch17 layer0 Acc 0.9205263157894736, AUC 0.9818224310874939, avg_entr 0.040088556706905365, f1 0.9205263257026672
ep17_l0_test_time 0.3294844627380371
Test Epoch17 layer1 Acc 0.9152631578947369, AUC 0.9813327193260193, avg_entr 0.013319069519639015, f1 0.9152631759643555
ep17_l1_test_time 0.5966188907623291
Test Epoch17 layer2 Acc 0.9157894736842105, AUC 0.982257604598999, avg_entr 0.011187839321792126, f1 0.9157894849777222
ep17_l2_test_time 0.8911378383636475
Test Epoch17 layer3 Acc 0.9155263157894736, AUC 0.9769182801246643, avg_entr 0.011432213708758354, f1 0.9155263304710388
ep17_l3_test_time 1.2537126541137695
Test Epoch17 layer4 Acc 0.915, AUC 0.9781746864318848, avg_entr 0.010608913376927376, f1 0.9150000214576721
ep17_l4_test_time 1.626451015472412
gc 0
Train Epoch18 Acc 0.9691 (116292/120000), AUC 0.995458722114563
ep18_train_time 182.98881793022156
Test Epoch18 layer0 Acc 0.9205263157894736, AUC 0.9818272590637207, avg_entr 0.03984953463077545, f1 0.9205263257026672
ep18_l0_test_time 0.32556819915771484
Test Epoch18 layer1 Acc 0.9139473684210526, AUC 0.9810589551925659, avg_entr 0.012308147735893726, f1 0.913947343826294
ep18_l1_test_time 0.5818872451782227
Test Epoch18 layer2 Acc 0.9136842105263158, AUC 0.9814685583114624, avg_entr 0.010630268603563309, f1 0.9136841893196106
ep18_l2_test_time 0.892228364944458
Test Epoch18 layer3 Acc 0.9136842105263158, AUC 0.9762952923774719, avg_entr 0.010560519993305206, f1 0.9136841893196106
ep18_l3_test_time 1.258150339126587
Test Epoch18 layer4 Acc 0.9134210526315789, AUC 0.9778061509132385, avg_entr 0.010103719308972359, f1 0.9134210348129272
ep18_l4_test_time 1.6276886463165283
gc 0
Train Epoch19 Acc 0.969325 (116319/120000), AUC 0.9953812956809998
ep19_train_time 183.0218276977539
Test Epoch19 layer0 Acc 0.921578947368421, AUC 0.9818235635757446, avg_entr 0.03844425082206726, f1 0.9215789437294006
ep19_l0_test_time 0.33014369010925293
Test Epoch19 layer1 Acc 0.9131578947368421, AUC 0.9813520312309265, avg_entr 0.012448803521692753, f1 0.9131578803062439
ep19_l1_test_time 0.5869400501251221
Test Epoch19 layer2 Acc 0.915, AUC 0.9820795059204102, avg_entr 0.010982904583215714, f1 0.9150000214576721
ep19_l2_test_time 0.8945903778076172
Test Epoch19 layer3 Acc 0.9147368421052632, AUC 0.9768867492675781, avg_entr 0.010913356207311153, f1 0.9147368669509888
ep19_l3_test_time 1.245497226715088
Test Epoch19 layer4 Acc 0.9139473684210526, AUC 0.9781561493873596, avg_entr 0.009897064417600632, f1 0.913947343826294
ep19_l4_test_time 1.61026930809021
gc 0
Train Epoch20 Acc 0.9698916666666667 (116387/120000), AUC 0.9953607320785522
ep20_train_time 182.8657524585724
Test Epoch20 layer0 Acc 0.9207894736842105, AUC 0.9818325042724609, avg_entr 0.03791900724172592, f1 0.9207894802093506
ep20_l0_test_time 0.31470274925231934
Test Epoch20 layer1 Acc 0.9126315789473685, AUC 0.9811683893203735, avg_entr 0.011407594196498394, f1 0.9126315712928772
ep20_l1_test_time 0.5889413356781006
Test Epoch20 layer2 Acc 0.9134210526315789, AUC 0.9817517399787903, avg_entr 0.009206977672874928, f1 0.9134210348129272
ep20_l2_test_time 0.8850605487823486
Test Epoch20 layer3 Acc 0.9142105263157895, AUC 0.9762492179870605, avg_entr 0.00957957748323679, f1 0.9142104983329773
ep20_l3_test_time 1.2629575729370117
Test Epoch20 layer4 Acc 0.9121052631578948, AUC 0.9774475693702698, avg_entr 0.008462511003017426, f1 0.9121052622795105
ep20_l4_test_time 1.6111605167388916
gc 0
Train Epoch21 Acc 0.9701 (116412/120000), AUC 0.9954087734222412
ep21_train_time 182.95563077926636
Test Epoch21 layer0 Acc 0.9210526315789473, AUC 0.9817911386489868, avg_entr 0.03697377070784569, f1 0.9210526347160339
ep21_l0_test_time 0.33341455459594727
Test Epoch21 layer1 Acc 0.9134210526315789, AUC 0.9808346033096313, avg_entr 0.011552751064300537, f1 0.9134210348129272
ep21_l1_test_time 0.5854032039642334
Test Epoch21 layer2 Acc 0.9139473684210526, AUC 0.9813483953475952, avg_entr 0.009415209293365479, f1 0.913947343826294
ep21_l2_test_time 0.8974363803863525
Test Epoch21 layer3 Acc 0.9136842105263158, AUC 0.9759514331817627, avg_entr 0.010325164534151554, f1 0.9136841893196106
ep21_l3_test_time 1.259521722793579
Test Epoch21 layer4 Acc 0.9139473684210526, AUC 0.9772192239761353, avg_entr 0.009151600301265717, f1 0.913947343826294
ep21_l4_test_time 1.6319124698638916
gc 0
Train Epoch22 Acc 0.9704666666666667 (116456/120000), AUC 0.9954677820205688
ep22_train_time 182.8426923751831
Test Epoch22 layer0 Acc 0.921578947368421, AUC 0.981814980506897, avg_entr 0.03660018369555473, f1 0.9215789437294006
ep22_l0_test_time 0.32721734046936035
Test Epoch22 layer1 Acc 0.9136842105263158, AUC 0.9809421896934509, avg_entr 0.011484530754387379, f1 0.9136841893196106
ep22_l1_test_time 0.5936641693115234
Test Epoch22 layer2 Acc 0.915, AUC 0.9813852310180664, avg_entr 0.010159504599869251, f1 0.9150000214576721
ep22_l2_test_time 0.8920316696166992
Test Epoch22 layer3 Acc 0.9139473684210526, AUC 0.975689172744751, avg_entr 0.010611153207719326, f1 0.913947343826294
ep22_l3_test_time 1.2628800868988037
Test Epoch22 layer4 Acc 0.9144736842105263, AUC 0.9766221046447754, avg_entr 0.008974785916507244, f1 0.9144737124443054
ep22_l4_test_time 1.6335780620574951
gc 0
Train Epoch23 Acc 0.9708166666666667 (116498/120000), AUC 0.9954566359519958
ep23_train_time 183.09512305259705
Test Epoch23 layer0 Acc 0.921578947368421, AUC 0.981778621673584, avg_entr 0.03610039874911308, f1 0.9215789437294006
ep23_l0_test_time 0.32979249954223633
Test Epoch23 layer1 Acc 0.9136842105263158, AUC 0.9811974763870239, avg_entr 0.010959670878946781, f1 0.9136841893196106
ep23_l1_test_time 0.5912153720855713
Test Epoch23 layer2 Acc 0.9139473684210526, AUC 0.9816563129425049, avg_entr 0.009114974178373814, f1 0.913947343826294
ep23_l2_test_time 0.9016904830932617
Test Epoch23 layer3 Acc 0.9134210526315789, AUC 0.976220428943634, avg_entr 0.009685001336038113, f1 0.9134210348129272
ep23_l3_test_time 1.2633538246154785
Test Epoch23 layer4 Acc 0.9142105263157895, AUC 0.9771786332130432, avg_entr 0.008598516695201397, f1 0.9142104983329773
ep23_l4_test_time 1.6219449043273926
gc 0
Train Epoch24 Acc 0.97095 (116514/120000), AUC 0.9955004453659058
ep24_train_time 182.86068081855774
Test Epoch24 layer0 Acc 0.9207894736842105, AUC 0.9818198680877686, avg_entr 0.03618168830871582, f1 0.9207894802093506
ep24_l0_test_time 0.3285844326019287
Test Epoch24 layer1 Acc 0.9123684210526316, AUC 0.9809764623641968, avg_entr 0.010688815265893936, f1 0.9123684167861938
ep24_l1_test_time 0.5858726501464844
Test Epoch24 layer2 Acc 0.9134210526315789, AUC 0.9815053343772888, avg_entr 0.008907042443752289, f1 0.9134210348129272
ep24_l2_test_time 0.8901946544647217
Test Epoch24 layer3 Acc 0.9128947368421053, AUC 0.9760985374450684, avg_entr 0.009408563375473022, f1 0.9128947257995605
ep24_l3_test_time 1.2489981651306152
Test Epoch24 layer4 Acc 0.9131578947368421, AUC 0.9770355224609375, avg_entr 0.007971109822392464, f1 0.9131578803062439
ep24_l4_test_time 1.5915334224700928
gc 0
Train Epoch25 Acc 0.9712 (116544/120000), AUC 0.9955288171768188
ep25_train_time 183.07514190673828
Test Epoch25 layer0 Acc 0.9210526315789473, AUC 0.9818130731582642, avg_entr 0.035758767277002335, f1 0.9210526347160339
ep25_l0_test_time 0.32105565071105957
Test Epoch25 layer1 Acc 0.9128947368421053, AUC 0.9810484647750854, avg_entr 0.010660084895789623, f1 0.9128947257995605
ep25_l1_test_time 0.5909073352813721
Test Epoch25 layer2 Acc 0.9142105263157895, AUC 0.9815071225166321, avg_entr 0.00928855687379837, f1 0.9142104983329773
ep25_l2_test_time 0.8860695362091064
Test Epoch25 layer3 Acc 0.9136842105263158, AUC 0.9760090708732605, avg_entr 0.009877203032374382, f1 0.9136841893196106
ep25_l3_test_time 1.2449753284454346
Test Epoch25 layer4 Acc 0.9123684210526316, AUC 0.9770733118057251, avg_entr 0.008619553409516811, f1 0.9123684167861938
ep25_l4_test_time 1.5914461612701416
gc 0
Train Epoch26 Acc 0.971275 (116553/120000), AUC 0.9955579042434692
ep26_train_time 182.89811372756958
Test Epoch26 layer0 Acc 0.9207894736842105, AUC 0.9818143844604492, avg_entr 0.03549419343471527, f1 0.9207894802093506
ep26_l0_test_time 0.32001781463623047
Test Epoch26 layer1 Acc 0.9131578947368421, AUC 0.9809911251068115, avg_entr 0.010294755920767784, f1 0.9131578803062439
ep26_l1_test_time 0.6013777256011963
Test Epoch26 layer2 Acc 0.9131578947368421, AUC 0.9813902974128723, avg_entr 0.00860457681119442, f1 0.9131578803062439
ep26_l2_test_time 0.8881781101226807
Test Epoch26 layer3 Acc 0.9134210526315789, AUC 0.9758648872375488, avg_entr 0.00905402097851038, f1 0.9134210348129272
ep26_l3_test_time 1.2580769062042236
Test Epoch26 layer4 Acc 0.9126315789473685, AUC 0.9769304990768433, avg_entr 0.00806507095694542, f1 0.9126315712928772
ep26_l4_test_time 1.6318869590759277
gc 0
Train Epoch27 Acc 0.9715083333333333 (116581/120000), AUC 0.9955665469169617
ep27_train_time 182.9619345664978
Test Epoch27 layer0 Acc 0.9213157894736842, AUC 0.9818090200424194, avg_entr 0.035262346267700195, f1 0.9213157892227173
ep27_l0_test_time 0.3201134204864502
Test Epoch27 layer1 Acc 0.9121052631578948, AUC 0.9807519912719727, avg_entr 0.010527489706873894, f1 0.9121052622795105
ep27_l1_test_time 0.5808801651000977
Test Epoch27 layer2 Acc 0.9139473684210526, AUC 0.9809887409210205, avg_entr 0.009655614383518696, f1 0.913947343826294
ep27_l2_test_time 0.889052152633667
Test Epoch27 layer3 Acc 0.9142105263157895, AUC 0.9753041863441467, avg_entr 0.009654787369072437, f1 0.9142104983329773
ep27_l3_test_time 1.2491817474365234
Test Epoch27 layer4 Acc 0.9123684210526316, AUC 0.9764111042022705, avg_entr 0.008217167109251022, f1 0.9123684167861938
ep27_l4_test_time 1.6159148216247559
gc 0
Train Epoch28 Acc 0.97155 (116586/120000), AUC 0.9955636262893677
ep28_train_time 183.01317024230957
Test Epoch28 layer0 Acc 0.9213157894736842, AUC 0.9818071126937866, avg_entr 0.035458508878946304, f1 0.9213157892227173
ep28_l0_test_time 0.3258357048034668
Test Epoch28 layer1 Acc 0.9123684210526316, AUC 0.9809001684188843, avg_entr 0.010380112566053867, f1 0.9123684167861938
ep28_l1_test_time 0.5891015529632568
Test Epoch28 layer2 Acc 0.9136842105263158, AUC 0.9812451601028442, avg_entr 0.00901008304208517, f1 0.9136841893196106
ep28_l2_test_time 0.8901617527008057
Test Epoch28 layer3 Acc 0.9134210526315789, AUC 0.9756539463996887, avg_entr 0.009430741891264915, f1 0.9134210348129272
ep28_l3_test_time 1.2595469951629639
Test Epoch28 layer4 Acc 0.911578947368421, AUC 0.9766766428947449, avg_entr 0.008073375560343266, f1 0.9115789532661438
ep28_l4_test_time 1.6269199848175049
gc 0
Train Epoch29 Acc 0.9715916666666666 (116591/120000), AUC 0.9955650568008423
ep29_train_time 182.92125272750854
Test Epoch29 layer0 Acc 0.9207894736842105, AUC 0.9818031787872314, avg_entr 0.03509785979986191, f1 0.9207894802093506
ep29_l0_test_time 0.32503628730773926
Test Epoch29 layer1 Acc 0.9123684210526316, AUC 0.980911135673523, avg_entr 0.010215889662504196, f1 0.9123684167861938
ep29_l1_test_time 0.5850491523742676
Test Epoch29 layer2 Acc 0.9136842105263158, AUC 0.9813772439956665, avg_entr 0.009146029129624367, f1 0.9136841893196106
ep29_l2_test_time 0.8880305290222168
Test Epoch29 layer3 Acc 0.9131578947368421, AUC 0.9756333231925964, avg_entr 0.009360658936202526, f1 0.9131578803062439
ep29_l3_test_time 1.2458527088165283
Test Epoch29 layer4 Acc 0.9123684210526316, AUC 0.9767188429832458, avg_entr 0.008062065578997135, f1 0.9123684167861938
ep29_l4_test_time 1.5955047607421875
Best AUC tensor(0.9237) 6 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 5027.6281616687775
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt
Test layer0 Acc 0.9107894736842105, AUC 0.9808638095855713, avg_entr 0.07108286023139954, f1 0.9107894897460938
l0_test_time 0.3193850517272949
Test layer1 Acc 0.9121052631578948, AUC 0.9811170101165771, avg_entr 0.027634458616375923, f1 0.9121052622795105
l1_test_time 0.591310977935791
Test layer2 Acc 0.9123684210526316, AUC 0.9829894304275513, avg_entr 0.023418616503477097, f1 0.9123684167861938
l2_test_time 0.8800301551818848
Test layer3 Acc 0.9134210526315789, AUC 0.9792530536651611, avg_entr 0.022700102999806404, f1 0.9134210348129272
l3_test_time 1.2467188835144043
Test layer4 Acc 0.9142105263157895, AUC 0.9815959930419922, avg_entr 0.022412333637475967, f1 0.9142104983329773
l4_test_time 1.6039295196533203
