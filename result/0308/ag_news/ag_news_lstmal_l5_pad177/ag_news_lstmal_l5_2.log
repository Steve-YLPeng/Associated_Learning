total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 21.558868169784546
Start Training
gc 0
Train Epoch0 Acc 0.714575 (85749/120000), AUC 0.9041410088539124
ep0_train_time 183.01179361343384
Test Epoch0 layer0 Acc 0.9047368421052632, AUC 0.9774110317230225, avg_entr 0.25330519676208496, f1 0.9047367572784424
ep0_l0_test_time 0.3251194953918457
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9068421052631579, AUC 0.9816504716873169, avg_entr 0.11613650619983673, f1 0.9068421125411987
ep0_l1_test_time 0.5890650749206543
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.905, AUC 0.9820219874382019, avg_entr 0.11459853500127792, f1 0.9049999117851257
ep0_l2_test_time 0.892664909362793
Test Epoch0 layer3 Acc 0.9044736842105263, AUC 0.9816306829452515, avg_entr 0.12498042732477188, f1 0.9044736623764038
ep0_l3_test_time 1.2604773044586182
Test Epoch0 layer4 Acc 0.905, AUC 0.9797918796539307, avg_entr 0.1394670307636261, f1 0.9049999117851257
ep0_l4_test_time 1.6259284019470215
gc 0
Train Epoch1 Acc 0.9206916666666667 (110483/120000), AUC 0.9805858731269836
ep1_train_time 182.81933856010437
Test Epoch1 layer0 Acc 0.9176315789473685, AUC 0.9806630611419678, avg_entr 0.1472710818052292, f1 0.9176315665245056
ep1_l0_test_time 0.32584190368652344
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9231578947368421, AUC 0.984420120716095, avg_entr 0.0525503046810627, f1 0.9231578707695007
ep1_l1_test_time 0.6008942127227783
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9223684210526316, AUC 0.9848940372467041, avg_entr 0.04871952161192894, f1 0.9223684072494507
ep1_l2_test_time 0.89825439453125
Test Epoch1 layer3 Acc 0.9207894736842105, AUC 0.9823756217956543, avg_entr 0.05103185027837753, f1 0.9207894802093506
ep1_l3_test_time 1.2523009777069092
Test Epoch1 layer4 Acc 0.9207894736842105, AUC 0.9829673767089844, avg_entr 0.05896203964948654, f1 0.9207894802093506
ep1_l4_test_time 1.6233935356140137
gc 0
Train Epoch2 Acc 0.9324666666666667 (111896/120000), AUC 0.9854919910430908
ep2_train_time 182.8551573753357
Test Epoch2 layer0 Acc 0.9218421052631579, AUC 0.9818752408027649, avg_entr 0.11227322369813919, f1 0.921842098236084
ep2_l0_test_time 0.3233451843261719
Test Epoch2 layer1 Acc 0.9226315789473685, AUC 0.9848990440368652, avg_entr 0.03782159835100174, f1 0.922631561756134
ep2_l1_test_time 0.5920178890228271
Test Epoch2 layer2 Acc 0.9231578947368421, AUC 0.9850714206695557, avg_entr 0.03575799986720085, f1 0.9231578707695007
ep2_l2_test_time 0.8896276950836182
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.9228947368421052, AUC 0.9844325184822083, avg_entr 0.037936560809612274, f1 0.9228947162628174
ep2_l3_test_time 1.2531259059906006
Test Epoch2 layer4 Acc 0.9223684210526316, AUC 0.9837058782577515, avg_entr 0.042463768273591995, f1 0.9223684072494507
ep2_l4_test_time 1.6190779209136963
gc 0
Train Epoch3 Acc 0.938975 (112677/120000), AUC 0.9880707263946533
ep3_train_time 182.81652164459229
Test Epoch3 layer0 Acc 0.9236842105263158, AUC 0.9823486804962158, avg_entr 0.09239020943641663, f1 0.9236842393875122
ep3_l0_test_time 0.3218507766723633
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.921578947368421, AUC 0.9848818778991699, avg_entr 0.030273037031292915, f1 0.9215789437294006
ep3_l1_test_time 0.5874152183532715
Test Epoch3 layer2 Acc 0.921578947368421, AUC 0.9849269986152649, avg_entr 0.029185574501752853, f1 0.9215789437294006
ep3_l2_test_time 0.895843505859375
Test Epoch3 layer3 Acc 0.921578947368421, AUC 0.9842642545700073, avg_entr 0.030197173357009888, f1 0.9215789437294006
ep3_l3_test_time 1.263592004776001
Test Epoch3 layer4 Acc 0.9205263157894736, AUC 0.9835542440414429, avg_entr 0.03307514637708664, f1 0.9205263257026672
ep3_l4_test_time 1.615893840789795
gc 0
Train Epoch4 Acc 0.9442916666666666 (113315/120000), AUC 0.989797830581665
ep4_train_time 182.900780916214
Test Epoch4 layer0 Acc 0.9223684210526316, AUC 0.9825928211212158, avg_entr 0.07911334186792374, f1 0.9223684072494507
ep4_l0_test_time 0.32941102981567383
Test Epoch4 layer1 Acc 0.9218421052631579, AUC 0.9841684103012085, avg_entr 0.0250743068754673, f1 0.921842098236084
ep4_l1_test_time 0.5890178680419922
Test Epoch4 layer2 Acc 0.9223684210526316, AUC 0.984710693359375, avg_entr 0.022799329832196236, f1 0.9223684072494507
ep4_l2_test_time 0.8916881084442139
Test Epoch4 layer3 Acc 0.9226315789473685, AUC 0.9828146696090698, avg_entr 0.022781111299991608, f1 0.922631561756134
ep4_l3_test_time 1.256974220275879
Test Epoch4 layer4 Acc 0.9213157894736842, AUC 0.9829110503196716, avg_entr 0.024760589003562927, f1 0.9213157892227173
ep4_l4_test_time 1.600999355316162
gc 0
Train Epoch5 Acc 0.9482916666666666 (113795/120000), AUC 0.9908638596534729
ep5_train_time 182.72947764396667
Test Epoch5 layer0 Acc 0.9239473684210526, AUC 0.9826589822769165, avg_entr 0.07220769673585892, f1 0.9239473938941956
ep5_l0_test_time 0.3228747844696045
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 5
Test Epoch5 layer1 Acc 0.92, AUC 0.9843645095825195, avg_entr 0.02188810706138611, f1 0.9200000166893005
ep5_l1_test_time 0.597064733505249
Test Epoch5 layer2 Acc 0.9205263157894736, AUC 0.9845281839370728, avg_entr 0.019930247217416763, f1 0.9205263257026672
ep5_l2_test_time 0.8947415351867676
Test Epoch5 layer3 Acc 0.921578947368421, AUC 0.9833143353462219, avg_entr 0.019626129418611526, f1 0.9215789437294006
ep5_l3_test_time 1.273397445678711
Test Epoch5 layer4 Acc 0.9207894736842105, AUC 0.9825413823127747, avg_entr 0.02067818120121956, f1 0.9207894802093506
ep5_l4_test_time 1.6370902061462402
gc 0
Train Epoch6 Acc 0.9513333333333334 (114160/120000), AUC 0.9917953014373779
ep6_train_time 182.76570510864258
Test Epoch6 layer0 Acc 0.9213157894736842, AUC 0.9826761484146118, avg_entr 0.06622520089149475, f1 0.9213157892227173
ep6_l0_test_time 0.3164641857147217
Test Epoch6 layer1 Acc 0.9205263157894736, AUC 0.98412024974823, avg_entr 0.020153027027845383, f1 0.9205263257026672
ep6_l1_test_time 0.5936408042907715
Test Epoch6 layer2 Acc 0.9213157894736842, AUC 0.9839085340499878, avg_entr 0.018247194588184357, f1 0.9213157892227173
ep6_l2_test_time 0.897322416305542
Test Epoch6 layer3 Acc 0.921578947368421, AUC 0.9821694493293762, avg_entr 0.017996467649936676, f1 0.9215789437294006
ep6_l3_test_time 1.2485604286193848
Test Epoch6 layer4 Acc 0.9210526315789473, AUC 0.9828743934631348, avg_entr 0.01869475282728672, f1 0.9210526347160339
ep6_l4_test_time 1.6069753170013428
gc 0
Train Epoch7 Acc 0.9546 (114552/120000), AUC 0.9925209283828735
ep7_train_time 182.79731798171997
Test Epoch7 layer0 Acc 0.9231578947368421, AUC 0.9825019836425781, avg_entr 0.058938056230545044, f1 0.9231578707695007
ep7_l0_test_time 0.31385231018066406
Test Epoch7 layer1 Acc 0.9202631578947369, AUC 0.9839122891426086, avg_entr 0.019502723589539528, f1 0.9202631711959839
ep7_l1_test_time 0.5904197692871094
Test Epoch7 layer2 Acc 0.921578947368421, AUC 0.9835579991340637, avg_entr 0.016968484967947006, f1 0.9215789437294006
ep7_l2_test_time 0.8886418342590332
Test Epoch7 layer3 Acc 0.9205263157894736, AUC 0.9816790819168091, avg_entr 0.01662571169435978, f1 0.9205263257026672
ep7_l3_test_time 1.2482764720916748
Test Epoch7 layer4 Acc 0.92, AUC 0.9811342358589172, avg_entr 0.01694898121058941, f1 0.9200000166893005
ep7_l4_test_time 1.6217246055603027
gc 0
Train Epoch8 Acc 0.9561 (114732/120000), AUC 0.9932079315185547
ep8_train_time 182.84484910964966
Test Epoch8 layer0 Acc 0.9231578947368421, AUC 0.9822415113449097, avg_entr 0.05607055127620697, f1 0.9231578707695007
ep8_l0_test_time 0.332838773727417
Test Epoch8 layer1 Acc 0.9181578947368421, AUC 0.9834434390068054, avg_entr 0.018583746626973152, f1 0.9181578755378723
ep8_l1_test_time 0.5960009098052979
Test Epoch8 layer2 Acc 0.9184210526315789, AUC 0.9835165739059448, avg_entr 0.01702452264726162, f1 0.9184210896492004
ep8_l2_test_time 0.8905508518218994
Test Epoch8 layer3 Acc 0.9176315789473685, AUC 0.9809587597846985, avg_entr 0.016645722091197968, f1 0.9176315665245056
ep8_l3_test_time 1.2621703147888184
Test Epoch8 layer4 Acc 0.9194736842105263, AUC 0.9816781282424927, avg_entr 0.016860852017998695, f1 0.9194737076759338
ep8_l4_test_time 1.6187424659729004
gc 0
Train Epoch9 Acc 0.9592083333333333 (115105/120000), AUC 0.9938483238220215
ep9_train_time 182.7372167110443
Test Epoch9 layer0 Acc 0.921578947368421, AUC 0.9823965430259705, avg_entr 0.05641665682196617, f1 0.9215789437294006
ep9_l0_test_time 0.3301074504852295
Test Epoch9 layer1 Acc 0.9181578947368421, AUC 0.9830294251441956, avg_entr 0.01799636520445347, f1 0.9181578755378723
ep9_l1_test_time 0.5902130603790283
Test Epoch9 layer2 Acc 0.916578947368421, AUC 0.9823790788650513, avg_entr 0.015514526516199112, f1 0.9165789484977722
ep9_l2_test_time 0.8963179588317871
Test Epoch9 layer3 Acc 0.9157894736842105, AUC 0.980029821395874, avg_entr 0.015069925226271152, f1 0.9157894849777222
ep9_l3_test_time 1.2516539096832275
Test Epoch9 layer4 Acc 0.9152631578947369, AUC 0.9791845083236694, avg_entr 0.015361450612545013, f1 0.9152631759643555
ep9_l4_test_time 1.6015257835388184
gc 0
Train Epoch10 Acc 0.9606916666666667 (115283/120000), AUC 0.9940932989120483
ep10_train_time 182.86193680763245
Test Epoch10 layer0 Acc 0.9218421052631579, AUC 0.9822601675987244, avg_entr 0.05367826297879219, f1 0.921842098236084
ep10_l0_test_time 0.3282597064971924
Test Epoch10 layer1 Acc 0.9173684210526316, AUC 0.9831724166870117, avg_entr 0.01742054522037506, f1 0.9173683524131775
ep10_l1_test_time 0.5878076553344727
Test Epoch10 layer2 Acc 0.916578947368421, AUC 0.9826674461364746, avg_entr 0.014836620539426804, f1 0.9165789484977722
ep10_l2_test_time 0.8947148323059082
Test Epoch10 layer3 Acc 0.9168421052631579, AUC 0.9808995723724365, avg_entr 0.01470908522605896, f1 0.9168421030044556
ep10_l3_test_time 1.2675817012786865
Test Epoch10 layer4 Acc 0.9163157894736842, AUC 0.9800524711608887, avg_entr 0.015983358025550842, f1 0.9163157939910889
ep10_l4_test_time 1.6303703784942627
gc 0
Train Epoch11 Acc 0.9622916666666667 (115475/120000), AUC 0.9942690134048462
ep11_train_time 182.72276306152344
Test Epoch11 layer0 Acc 0.9213157894736842, AUC 0.982184112071991, avg_entr 0.04994823783636093, f1 0.9213157892227173
ep11_l0_test_time 0.3324882984161377
Test Epoch11 layer1 Acc 0.916578947368421, AUC 0.9829813838005066, avg_entr 0.01626344956457615, f1 0.9165789484977722
ep11_l1_test_time 0.5844149589538574
Test Epoch11 layer2 Acc 0.9160526315789473, AUC 0.9823391437530518, avg_entr 0.013435903936624527, f1 0.9160526394844055
ep11_l2_test_time 0.8930296897888184
Test Epoch11 layer3 Acc 0.9155263157894736, AUC 0.9806810617446899, avg_entr 0.0133241331204772, f1 0.9155263304710388
ep11_l3_test_time 1.249171257019043
Test Epoch11 layer4 Acc 0.9171052631578948, AUC 0.9801339507102966, avg_entr 0.014533274807035923, f1 0.9171052575111389
ep11_l4_test_time 1.6137464046478271
gc 0
Train Epoch12 Acc 0.962725 (115527/120000), AUC 0.9944076538085938
ep12_train_time 182.9369969367981
Test Epoch12 layer0 Acc 0.921578947368421, AUC 0.9822043776512146, avg_entr 0.048245929181575775, f1 0.9215789437294006
ep12_l0_test_time 0.3288853168487549
Test Epoch12 layer1 Acc 0.9189473684210526, AUC 0.9828648567199707, avg_entr 0.015379240736365318, f1 0.9189472794532776
ep12_l1_test_time 0.5933239459991455
Test Epoch12 layer2 Acc 0.9168421052631579, AUC 0.9823306798934937, avg_entr 0.013972800225019455, f1 0.9168421030044556
ep12_l2_test_time 0.8832292556762695
Test Epoch12 layer3 Acc 0.9155263157894736, AUC 0.9796546697616577, avg_entr 0.013617642223834991, f1 0.9155263304710388
ep12_l3_test_time 1.257624864578247
Test Epoch12 layer4 Acc 0.9155263157894736, AUC 0.9797451496124268, avg_entr 0.013978025875985622, f1 0.9155263304710388
ep12_l4_test_time 1.6064374446868896
gc 0
Train Epoch13 Acc 0.9643833333333334 (115726/120000), AUC 0.9947590827941895
ep13_train_time 182.77986240386963
Test Epoch13 layer0 Acc 0.9202631578947369, AUC 0.9821848273277283, avg_entr 0.04762110486626625, f1 0.9202631711959839
ep13_l0_test_time 0.3306543827056885
Test Epoch13 layer1 Acc 0.9147368421052632, AUC 0.9825942516326904, avg_entr 0.014936435967683792, f1 0.9147368669509888
ep13_l1_test_time 0.5927677154541016
Test Epoch13 layer2 Acc 0.9152631578947369, AUC 0.9819763898849487, avg_entr 0.013079187832772732, f1 0.9152631759643555
ep13_l2_test_time 0.900052547454834
Test Epoch13 layer3 Acc 0.9155263157894736, AUC 0.9793241620063782, avg_entr 0.012770883738994598, f1 0.9155263304710388
ep13_l3_test_time 1.2660894393920898
Test Epoch13 layer4 Acc 0.915, AUC 0.9789177179336548, avg_entr 0.013371552340686321, f1 0.9150000214576721
ep13_l4_test_time 1.6224873065948486
gc 0
Train Epoch14 Acc 0.9648 (115776/120000), AUC 0.9948649406433105
ep14_train_time 182.72913765907288
Test Epoch14 layer0 Acc 0.9205263157894736, AUC 0.9821368455886841, avg_entr 0.04636364430189133, f1 0.9205263257026672
ep14_l0_test_time 0.323976993560791
Test Epoch14 layer1 Acc 0.9176315789473685, AUC 0.9828966856002808, avg_entr 0.015179377049207687, f1 0.9176315665245056
ep14_l1_test_time 0.5826871395111084
Test Epoch14 layer2 Acc 0.9178947368421052, AUC 0.9821811318397522, avg_entr 0.013990979641675949, f1 0.917894721031189
ep14_l2_test_time 0.8882384300231934
Test Epoch14 layer3 Acc 0.9171052631578948, AUC 0.9794982671737671, avg_entr 0.013819844461977482, f1 0.9171052575111389
ep14_l3_test_time 1.256568431854248
Test Epoch14 layer4 Acc 0.9168421052631579, AUC 0.9795198440551758, avg_entr 0.014310847967863083, f1 0.9168421030044556
ep14_l4_test_time 1.6161580085754395
gc 0
Train Epoch15 Acc 0.9653833333333334 (115846/120000), AUC 0.9948947429656982
ep15_train_time 182.69753098487854
Test Epoch15 layer0 Acc 0.9192105263157895, AUC 0.9821007251739502, avg_entr 0.04436158016324043, f1 0.9192105531692505
ep15_l0_test_time 0.32158780097961426
Test Epoch15 layer1 Acc 0.9155263157894736, AUC 0.9827183485031128, avg_entr 0.01462912280112505, f1 0.9155263304710388
ep15_l1_test_time 0.5945100784301758
Test Epoch15 layer2 Acc 0.9163157894736842, AUC 0.9819287061691284, avg_entr 0.012940860353410244, f1 0.9163157939910889
ep15_l2_test_time 0.8936119079589844
Test Epoch15 layer3 Acc 0.9155263157894736, AUC 0.9799726605415344, avg_entr 0.012820356525480747, f1 0.9155263304710388
ep15_l3_test_time 1.262404441833496
Test Epoch15 layer4 Acc 0.9160526315789473, AUC 0.9794493913650513, avg_entr 0.01389878336340189, f1 0.9160526394844055
ep15_l4_test_time 1.6220948696136475
gc 0
Train Epoch16 Acc 0.9662166666666666 (115946/120000), AUC 0.9949831366539001
ep16_train_time 182.73417448997498
Test Epoch16 layer0 Acc 0.9207894736842105, AUC 0.9820556640625, avg_entr 0.04318169504404068, f1 0.9207894802093506
ep16_l0_test_time 0.3279142379760742
Test Epoch16 layer1 Acc 0.9152631578947369, AUC 0.9821748733520508, avg_entr 0.013671080581843853, f1 0.9152631759643555
ep16_l1_test_time 0.5930166244506836
Test Epoch16 layer2 Acc 0.9142105263157895, AUC 0.9812462329864502, avg_entr 0.012088687159121037, f1 0.9142104983329773
ep16_l2_test_time 0.8880186080932617
Test Epoch16 layer3 Acc 0.9144736842105263, AUC 0.9786497354507446, avg_entr 0.01158096268773079, f1 0.9144737124443054
ep16_l3_test_time 1.2619624137878418
Test Epoch16 layer4 Acc 0.9144736842105263, AUC 0.9790526628494263, avg_entr 0.012162917293608189, f1 0.9144737124443054
ep16_l4_test_time 1.6126580238342285
gc 0
Train Epoch17 Acc 0.9667333333333333 (116008/120000), AUC 0.9951364994049072
ep17_train_time 182.78829526901245
Test Epoch17 layer0 Acc 0.9213157894736842, AUC 0.9820536971092224, avg_entr 0.0418153814971447, f1 0.9213157892227173
ep17_l0_test_time 0.3334815502166748
Test Epoch17 layer1 Acc 0.9157894736842105, AUC 0.9826596975326538, avg_entr 0.013716927729547024, f1 0.9157894849777222
ep17_l1_test_time 0.5904877185821533
Test Epoch17 layer2 Acc 0.9152631578947369, AUC 0.9818717837333679, avg_entr 0.01252612192183733, f1 0.9152631759643555
ep17_l2_test_time 0.8982856273651123
Test Epoch17 layer3 Acc 0.9142105263157895, AUC 0.97910076379776, avg_entr 0.011912567541003227, f1 0.9142104983329773
ep17_l3_test_time 1.2555158138275146
Test Epoch17 layer4 Acc 0.9134210526315789, AUC 0.9790290594100952, avg_entr 0.012467985041439533, f1 0.9134210348129272
ep17_l4_test_time 1.6228606700897217
gc 0
Train Epoch18 Acc 0.9669083333333334 (116029/120000), AUC 0.9951465725898743
ep18_train_time 182.6937997341156
Test Epoch18 layer0 Acc 0.9210526315789473, AUC 0.9820246696472168, avg_entr 0.04123593121767044, f1 0.9210526347160339
ep18_l0_test_time 0.3328437805175781
Test Epoch18 layer1 Acc 0.9152631578947369, AUC 0.982513427734375, avg_entr 0.013029571622610092, f1 0.9152631759643555
ep18_l1_test_time 0.5920271873474121
Test Epoch18 layer2 Acc 0.9147368421052632, AUC 0.9815096855163574, avg_entr 0.011758890002965927, f1 0.9147368669509888
ep18_l2_test_time 0.8822586536407471
Test Epoch18 layer3 Acc 0.9142105263157895, AUC 0.9787472486495972, avg_entr 0.01145661436021328, f1 0.9142104983329773
ep18_l3_test_time 1.256953477859497
Test Epoch18 layer4 Acc 0.9131578947368421, AUC 0.9787711501121521, avg_entr 0.012312142178416252, f1 0.9131578803062439
ep18_l4_test_time 1.6142380237579346
gc 0
Train Epoch19 Acc 0.9675083333333333 (116101/120000), AUC 0.9951977729797363
ep19_train_time 182.7526524066925
Test Epoch19 layer0 Acc 0.9213157894736842, AUC 0.9820469617843628, avg_entr 0.040344953536987305, f1 0.9213157892227173
ep19_l0_test_time 0.31946682929992676
Test Epoch19 layer1 Acc 0.9152631578947369, AUC 0.9822736978530884, avg_entr 0.01231255941092968, f1 0.9152631759643555
ep19_l1_test_time 0.593559741973877
Test Epoch19 layer2 Acc 0.9136842105263158, AUC 0.9813573360443115, avg_entr 0.010884604416787624, f1 0.9136841893196106
ep19_l2_test_time 0.8924570083618164
Test Epoch19 layer3 Acc 0.9128947368421053, AUC 0.9790235757827759, avg_entr 0.010261050425469875, f1 0.9128947257995605
ep19_l3_test_time 1.2579739093780518
Test Epoch19 layer4 Acc 0.9126315789473685, AUC 0.9784972667694092, avg_entr 0.010892697609961033, f1 0.9126315712928772
ep19_l4_test_time 1.6137590408325195
gc 0
Train Epoch20 Acc 0.9675666666666667 (116108/120000), AUC 0.9951479434967041
ep20_train_time 182.74989986419678
Test Epoch20 layer0 Acc 0.9213157894736842, AUC 0.9820353984832764, avg_entr 0.03867931663990021, f1 0.9213157892227173
ep20_l0_test_time 0.33608317375183105
Test Epoch20 layer1 Acc 0.9155263157894736, AUC 0.9823530912399292, avg_entr 0.012374537996947765, f1 0.9155263304710388
ep20_l1_test_time 0.5857415199279785
Test Epoch20 layer2 Acc 0.9147368421052632, AUC 0.98128342628479, avg_entr 0.011241375468671322, f1 0.9147368669509888
ep20_l2_test_time 0.8879179954528809
Test Epoch20 layer3 Acc 0.9134210526315789, AUC 0.9787603616714478, avg_entr 0.010552630759775639, f1 0.9134210348129272
ep20_l3_test_time 1.2629261016845703
Test Epoch20 layer4 Acc 0.9128947368421053, AUC 0.978342592716217, avg_entr 0.011329470202326775, f1 0.9128947257995605
ep20_l4_test_time 1.635911464691162
gc 0
Train Epoch21 Acc 0.9680666666666666 (116168/120000), AUC 0.9952899813652039
ep21_train_time 182.86551451683044
Test Epoch21 layer0 Acc 0.9205263157894736, AUC 0.982052206993103, avg_entr 0.038262516260147095, f1 0.9205263257026672
ep21_l0_test_time 0.3365612030029297
Test Epoch21 layer1 Acc 0.9157894736842105, AUC 0.9824451208114624, avg_entr 0.012745332904160023, f1 0.9157894849777222
ep21_l1_test_time 0.5861935615539551
Test Epoch21 layer2 Acc 0.9160526315789473, AUC 0.9811695218086243, avg_entr 0.011366762220859528, f1 0.9160526394844055
ep21_l2_test_time 0.8873767852783203
Test Epoch21 layer3 Acc 0.9134210526315789, AUC 0.9784917831420898, avg_entr 0.010959346778690815, f1 0.9134210348129272
ep21_l3_test_time 1.24989652633667
Test Epoch21 layer4 Acc 0.9136842105263158, AUC 0.9783636331558228, avg_entr 0.011337583884596825, f1 0.9136841893196106
ep21_l4_test_time 1.6073734760284424
gc 0
Train Epoch22 Acc 0.9682333333333333 (116188/120000), AUC 0.9952849745750427
ep22_train_time 182.62564659118652
Test Epoch22 layer0 Acc 0.9210526315789473, AUC 0.9820334911346436, avg_entr 0.03740174323320389, f1 0.9210526347160339
ep22_l0_test_time 0.3255624771118164
Test Epoch22 layer1 Acc 0.9155263157894736, AUC 0.982316255569458, avg_entr 0.01200609840452671, f1 0.9155263304710388
ep22_l1_test_time 0.5939517021179199
Test Epoch22 layer2 Acc 0.915, AUC 0.9811115264892578, avg_entr 0.010682890191674232, f1 0.9150000214576721
ep22_l2_test_time 0.8855686187744141
Test Epoch22 layer3 Acc 0.9136842105263158, AUC 0.9786679744720459, avg_entr 0.010396922007203102, f1 0.9136841893196106
ep22_l3_test_time 1.2567095756530762
Test Epoch22 layer4 Acc 0.9131578947368421, AUC 0.9785033464431763, avg_entr 0.010973244905471802, f1 0.9131578803062439
ep22_l4_test_time 1.613584041595459
gc 0
Train Epoch23 Acc 0.968475 (116217/120000), AUC 0.9953217506408691
ep23_train_time 182.75196981430054
Test Epoch23 layer0 Acc 0.9213157894736842, AUC 0.9820349216461182, avg_entr 0.0367763414978981, f1 0.9213157892227173
ep23_l0_test_time 0.3297097682952881
Test Epoch23 layer1 Acc 0.915, AUC 0.9822641611099243, avg_entr 0.011669648811221123, f1 0.9150000214576721
ep23_l1_test_time 0.593698263168335
Test Epoch23 layer2 Acc 0.9155263157894736, AUC 0.9810783863067627, avg_entr 0.010113111697137356, f1 0.9155263304710388
ep23_l2_test_time 0.8864686489105225
Test Epoch23 layer3 Acc 0.9136842105263158, AUC 0.9784523844718933, avg_entr 0.010086488910019398, f1 0.9136841893196106
ep23_l3_test_time 1.258272409439087
Test Epoch23 layer4 Acc 0.9139473684210526, AUC 0.978356122970581, avg_entr 0.010786151513457298, f1 0.913947343826294
ep23_l4_test_time 1.6196410655975342
gc 0
Train Epoch24 Acc 0.9685 (116220/120000), AUC 0.9953282475471497
ep24_train_time 182.68699288368225
Test Epoch24 layer0 Acc 0.9210526315789473, AUC 0.9820165038108826, avg_entr 0.03646723926067352, f1 0.9210526347160339
ep24_l0_test_time 0.3266129493713379
Test Epoch24 layer1 Acc 0.915, AUC 0.9821951389312744, avg_entr 0.01129752118140459, f1 0.9150000214576721
ep24_l1_test_time 0.5935661792755127
Test Epoch24 layer2 Acc 0.9139473684210526, AUC 0.981046736240387, avg_entr 0.009827402420341969, f1 0.913947343826294
ep24_l2_test_time 0.8905429840087891
Test Epoch24 layer3 Acc 0.9134210526315789, AUC 0.9784080386161804, avg_entr 0.009832820855081081, f1 0.9134210348129272
ep24_l3_test_time 1.2599551677703857
Test Epoch24 layer4 Acc 0.9128947368421053, AUC 0.9782559871673584, avg_entr 0.01047267485409975, f1 0.9128947257995605
ep24_l4_test_time 1.604457139968872
gc 0
Train Epoch25 Acc 0.9688666666666667 (116264/120000), AUC 0.9953490495681763
ep25_train_time 182.72485899925232
Test Epoch25 layer0 Acc 0.9205263157894736, AUC 0.9820213317871094, avg_entr 0.036465853452682495, f1 0.9205263257026672
ep25_l0_test_time 0.30503320693969727
Test Epoch25 layer1 Acc 0.9144736842105263, AUC 0.9820412397384644, avg_entr 0.010933381505310535, f1 0.9144737124443054
ep25_l1_test_time 0.5798757076263428
Test Epoch25 layer2 Acc 0.9142105263157895, AUC 0.9806903600692749, avg_entr 0.009298192337155342, f1 0.9142104983329773
ep25_l2_test_time 0.8919057846069336
Test Epoch25 layer3 Acc 0.9136842105263158, AUC 0.977996826171875, avg_entr 0.009634250774979591, f1 0.9136841893196106
ep25_l3_test_time 1.2604947090148926
Test Epoch25 layer4 Acc 0.9134210526315789, AUC 0.9778457880020142, avg_entr 0.009877343662083149, f1 0.9134210348129272
ep25_l4_test_time 1.6272244453430176
gc 0
Train Epoch26 Acc 0.9689 (116268/120000), AUC 0.9953828454017639
ep26_train_time 182.63858771324158
Test Epoch26 layer0 Acc 0.9207894736842105, AUC 0.9820162057876587, avg_entr 0.03630060330033302, f1 0.9207894802093506
ep26_l0_test_time 0.3296935558319092
Test Epoch26 layer1 Acc 0.9147368421052632, AUC 0.9821768403053284, avg_entr 0.010791371576488018, f1 0.9147368669509888
ep26_l1_test_time 0.590388298034668
Test Epoch26 layer2 Acc 0.9136842105263158, AUC 0.9808564782142639, avg_entr 0.009316565468907356, f1 0.9136841893196106
ep26_l2_test_time 0.890697717666626
Test Epoch26 layer3 Acc 0.9126315789473685, AUC 0.9781922698020935, avg_entr 0.009741400368511677, f1 0.9126315712928772
ep26_l3_test_time 1.243973970413208
Test Epoch26 layer4 Acc 0.9131578947368421, AUC 0.9778160452842712, avg_entr 0.009977636858820915, f1 0.9131578803062439
ep26_l4_test_time 1.61411452293396
gc 0
Train Epoch27 Acc 0.9691 (116292/120000), AUC 0.9953868389129639
ep27_train_time 182.71983289718628
Test Epoch27 layer0 Acc 0.9202631578947369, AUC 0.9820148348808289, avg_entr 0.03593011200428009, f1 0.9202631711959839
ep27_l0_test_time 0.324601411819458
Test Epoch27 layer1 Acc 0.9152631578947369, AUC 0.9822218418121338, avg_entr 0.01109493151307106, f1 0.9152631759643555
ep27_l1_test_time 0.5940592288970947
Test Epoch27 layer2 Acc 0.9147368421052632, AUC 0.981013298034668, avg_entr 0.009634444490075111, f1 0.9147368669509888
ep27_l2_test_time 0.893972635269165
Test Epoch27 layer3 Acc 0.9131578947368421, AUC 0.978243350982666, avg_entr 0.009964480064809322, f1 0.9131578803062439
ep27_l3_test_time 1.261533260345459
Test Epoch27 layer4 Acc 0.9128947368421053, AUC 0.9780641794204712, avg_entr 0.010443149134516716, f1 0.9128947257995605
ep27_l4_test_time 1.6047322750091553
gc 0
Train Epoch28 Acc 0.9690583333333334 (116287/120000), AUC 0.995413601398468
ep28_train_time 182.8761179447174
Test Epoch28 layer0 Acc 0.9207894736842105, AUC 0.9820200204849243, avg_entr 0.03567878156900406, f1 0.9207894802093506
ep28_l0_test_time 0.3184340000152588
Test Epoch28 layer1 Acc 0.9147368421052632, AUC 0.9822205305099487, avg_entr 0.010732374154031277, f1 0.9147368669509888
ep28_l1_test_time 0.5897037982940674
Test Epoch28 layer2 Acc 0.9142105263157895, AUC 0.9808619022369385, avg_entr 0.009214401245117188, f1 0.9142104983329773
ep28_l2_test_time 0.8872115612030029
Test Epoch28 layer3 Acc 0.9144736842105263, AUC 0.9780990481376648, avg_entr 0.009586808271706104, f1 0.9144737124443054
ep28_l3_test_time 1.2587151527404785
Test Epoch28 layer4 Acc 0.9142105263157895, AUC 0.9778455495834351, avg_entr 0.009820218198001385, f1 0.9142104983329773
ep28_l4_test_time 1.6217730045318604
gc 0
Train Epoch29 Acc 0.9691916666666667 (116303/120000), AUC 0.9954279661178589
ep29_train_time 182.63558840751648
Test Epoch29 layer0 Acc 0.921578947368421, AUC 0.9820151925086975, avg_entr 0.035658180713653564, f1 0.9215789437294006
ep29_l0_test_time 0.32555603981018066
Test Epoch29 layer1 Acc 0.9152631578947369, AUC 0.9822193384170532, avg_entr 0.0110737644135952, f1 0.9152631759643555
ep29_l1_test_time 0.5963921546936035
Test Epoch29 layer2 Acc 0.915, AUC 0.9808144569396973, avg_entr 0.009617271833121777, f1 0.9150000214576721
ep29_l2_test_time 0.896240234375
Test Epoch29 layer3 Acc 0.9126315789473685, AUC 0.978039026260376, avg_entr 0.009858675301074982, f1 0.9126315712928772
ep29_l3_test_time 1.2545359134674072
Test Epoch29 layer4 Acc 0.9126315789473685, AUC 0.9779679775238037, avg_entr 0.010349655523896217, f1 0.9126315712928772
ep29_l4_test_time 1.614044189453125
Best AUC tensor(0.9239) 5 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 5626.055166482925
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt
Test layer0 Acc 0.9128947368421053, AUC 0.981026291847229, avg_entr 0.07869170606136322, f1 0.9128947257995605
l0_test_time 0.32206034660339355
Test layer1 Acc 0.9105263157894737, AUC 0.9816226959228516, avg_entr 0.028229307383298874, f1 0.9105263352394104
l1_test_time 0.6022055149078369
Test layer2 Acc 0.9107894736842105, AUC 0.9825339317321777, avg_entr 0.026009920984506607, f1 0.9107894897460938
l2_test_time 0.8911290168762207
Test layer3 Acc 0.9102631578947369, AUC 0.9825509786605835, avg_entr 0.025249972939491272, f1 0.910263180732727
l3_test_time 1.2577450275421143
Test layer4 Acc 0.9113157894736842, AUC 0.9807393550872803, avg_entr 0.025533318519592285, f1 0.9113157987594604
l4_test_time 1.6200966835021973
