total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 21.668538093566895
Start Training
gc 0
Train Epoch0 Acc 0.7183 (86196/120000), AUC 0.9091526865959167
ep0_train_time 270.4533841609955
Test Epoch0 layer0 Acc 0.9010526315789473, AUC 0.976940393447876, avg_entr 0.25370362401008606, f1 0.9010526537895203
ep0_l0_test_time 0.520681619644165
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9055263157894737, AUC 0.9818550944328308, avg_entr 0.11071576923131943, f1 0.905526340007782
ep0_l1_test_time 0.9113385677337646
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9044736842105263, AUC 0.982151448726654, avg_entr 0.1021694540977478, f1 0.9044736623764038
ep0_l2_test_time 1.3401927947998047
Test Epoch0 layer3 Acc 0.9039473684210526, AUC 0.9777393937110901, avg_entr 0.10410454869270325, f1 0.9039472937583923
ep0_l3_test_time 1.9020040035247803
Test Epoch0 layer4 Acc 0.9026315789473685, AUC 0.9800176024436951, avg_entr 0.11286210268735886, f1 0.9026315808296204
ep0_l4_test_time 2.450679302215576
gc 0
Train Epoch1 Acc 0.9197833333333333 (110374/120000), AUC 0.9816093444824219
ep1_train_time 277.0522744655609
Test Epoch1 layer0 Acc 0.9136842105263158, AUC 0.980456531047821, avg_entr 0.14654460549354553, f1 0.9136841893196106
ep1_l0_test_time 0.5189685821533203
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9192105263157895, AUC 0.984689474105835, avg_entr 0.05323726311326027, f1 0.9192105531692505
ep1_l1_test_time 0.903512716293335
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9189473684210526, AUC 0.9850296974182129, avg_entr 0.04927118495106697, f1 0.9189472794532776
ep1_l2_test_time 1.3473625183105469
Test Epoch1 layer3 Acc 0.9192105263157895, AUC 0.9804733395576477, avg_entr 0.052040643990039825, f1 0.9192105531692505
ep1_l3_test_time 1.8948066234588623
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.9205263157894736, AUC 0.983895480632782, avg_entr 0.05555002763867378, f1 0.9205263257026672
ep1_l4_test_time 2.454040288925171
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.931225 (111747/120000), AUC 0.9862501621246338
ep2_train_time 277.21897530555725
Test Epoch2 layer0 Acc 0.921578947368421, AUC 0.9817491769790649, avg_entr 0.10963385552167892, f1 0.9215789437294006
ep2_l0_test_time 0.5257306098937988
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.9223684210526316, AUC 0.9851534962654114, avg_entr 0.037293992936611176, f1 0.9223684072494507
ep2_l1_test_time 0.9084246158599854
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.9231578947368421, AUC 0.9855839610099792, avg_entr 0.03435974940657616, f1 0.9231578707695007
ep2_l2_test_time 1.3452458381652832
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.921578947368421, AUC 0.9822983741760254, avg_entr 0.03493726998567581, f1 0.9215789437294006
ep2_l3_test_time 1.9041187763214111
Test Epoch2 layer4 Acc 0.9207894736842105, AUC 0.9837197065353394, avg_entr 0.03771165385842323, f1 0.9207894802093506
ep2_l4_test_time 2.451464891433716
gc 0
Train Epoch3 Acc 0.9389083333333333 (112669/120000), AUC 0.9887519478797913
ep3_train_time 277.5823209285736
Test Epoch3 layer0 Acc 0.9226315789473685, AUC 0.9824917316436768, avg_entr 0.0930912047624588, f1 0.922631561756134
ep3_l0_test_time 0.520249605178833
Test Epoch3 layer1 Acc 0.9226315789473685, AUC 0.9850424528121948, avg_entr 0.03129052743315697, f1 0.922631561756134
ep3_l1_test_time 0.9147078990936279
Test Epoch3 layer2 Acc 0.9228947368421052, AUC 0.9853852391242981, avg_entr 0.028575608506798744, f1 0.9228947162628174
ep3_l2_test_time 1.342986822128296
Test Epoch3 layer3 Acc 0.9218421052631579, AUC 0.9830119609832764, avg_entr 0.02852601371705532, f1 0.921842098236084
ep3_l3_test_time 1.9024853706359863
Test Epoch3 layer4 Acc 0.9221052631578948, AUC 0.9834626913070679, avg_entr 0.031397417187690735, f1 0.9221052527427673
ep3_l4_test_time 2.4418253898620605
gc 0
Train Epoch4 Acc 0.9438916666666667 (113267/120000), AUC 0.9904608130455017
ep4_train_time 277.42868161201477
Test Epoch4 layer0 Acc 0.9228947368421052, AUC 0.982688307762146, avg_entr 0.07936576753854752, f1 0.9228947162628174
ep4_l0_test_time 0.5167326927185059
Test Epoch4 layer1 Acc 0.9221052631578948, AUC 0.984953761100769, avg_entr 0.02733021043241024, f1 0.9221052527427673
ep4_l1_test_time 0.9176590442657471
Test Epoch4 layer2 Acc 0.9223684210526316, AUC 0.9854703545570374, avg_entr 0.02428232692182064, f1 0.9223684072494507
ep4_l2_test_time 1.3481402397155762
Test Epoch4 layer3 Acc 0.9213157894736842, AUC 0.9829080104827881, avg_entr 0.024945642799139023, f1 0.9213157892227173
ep4_l3_test_time 1.905824899673462
Test Epoch4 layer4 Acc 0.921578947368421, AUC 0.9835124015808105, avg_entr 0.026226220652461052, f1 0.9215789437294006
ep4_l4_test_time 2.4670157432556152
gc 0
Train Epoch5 Acc 0.9474583333333333 (113695/120000), AUC 0.9914857149124146
ep5_train_time 277.27048659324646
Test Epoch5 layer0 Acc 0.9210526315789473, AUC 0.9826937913894653, avg_entr 0.07170580327510834, f1 0.9210526347160339
ep5_l0_test_time 0.5187044143676758
Test Epoch5 layer1 Acc 0.9213157894736842, AUC 0.9842074513435364, avg_entr 0.026163451373577118, f1 0.9213157892227173
ep5_l1_test_time 0.9039013385772705
Test Epoch5 layer2 Acc 0.9213157894736842, AUC 0.9848854541778564, avg_entr 0.022875750437378883, f1 0.9213157892227173
ep5_l2_test_time 1.3520405292510986
Test Epoch5 layer3 Acc 0.9213157894736842, AUC 0.9829120635986328, avg_entr 0.023751873522996902, f1 0.9213157892227173
ep5_l3_test_time 1.903871774673462
Test Epoch5 layer4 Acc 0.9205263157894736, AUC 0.9832706451416016, avg_entr 0.02488553896546364, f1 0.9205263257026672
ep5_l4_test_time 2.4509382247924805
gc 0
Train Epoch6 Acc 0.9505666666666667 (114068/120000), AUC 0.9924799203872681
ep6_train_time 276.5176908969879
Test Epoch6 layer0 Acc 0.9228947368421052, AUC 0.9827190041542053, avg_entr 0.06737220287322998, f1 0.9228947162628174
ep6_l0_test_time 0.5169706344604492
Test Epoch6 layer1 Acc 0.9221052631578948, AUC 0.9842898845672607, avg_entr 0.022180741652846336, f1 0.9221052527427673
ep6_l1_test_time 0.9154009819030762
Test Epoch6 layer2 Acc 0.921578947368421, AUC 0.9847493171691895, avg_entr 0.018816206604242325, f1 0.9215789437294006
ep6_l2_test_time 1.343257188796997
Test Epoch6 layer3 Acc 0.9231578947368421, AUC 0.9817348122596741, avg_entr 0.019495710730552673, f1 0.9231578707695007
ep6_l3_test_time 1.9036900997161865
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 6
Test Epoch6 layer4 Acc 0.9231578947368421, AUC 0.9824120402336121, avg_entr 0.019600480794906616, f1 0.9231578707695007
ep6_l4_test_time 2.4202184677124023
Save ckpt to ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9541333333333334 (114496/120000), AUC 0.9930424690246582
ep7_train_time 276.12832856178284
Test Epoch7 layer0 Acc 0.9226315789473685, AUC 0.9826341867446899, avg_entr 0.06003998592495918, f1 0.922631561756134
ep7_l0_test_time 0.5233883857727051
Test Epoch7 layer1 Acc 0.9207894736842105, AUC 0.9834984540939331, avg_entr 0.019989142194390297, f1 0.9207894802093506
ep7_l1_test_time 0.9146733283996582
Test Epoch7 layer2 Acc 0.9218421052631579, AUC 0.9846004843711853, avg_entr 0.017551731318235397, f1 0.921842098236084
ep7_l2_test_time 1.3350670337677002
Test Epoch7 layer3 Acc 0.9221052631578948, AUC 0.9809753894805908, avg_entr 0.0178691316395998, f1 0.9221052527427673
ep7_l3_test_time 1.8932099342346191
Test Epoch7 layer4 Acc 0.9223684210526316, AUC 0.982391893863678, avg_entr 0.01831389218568802, f1 0.9223684072494507
ep7_l4_test_time 2.4153764247894287
gc 0
Train Epoch8 Acc 0.95595 (114714/120000), AUC 0.9935411214828491
ep8_train_time 278.24036741256714
Test Epoch8 layer0 Acc 0.921578947368421, AUC 0.9826253652572632, avg_entr 0.05728643387556076, f1 0.9215789437294006
ep8_l0_test_time 0.5187795162200928
Test Epoch8 layer1 Acc 0.9189473684210526, AUC 0.9828984141349792, avg_entr 0.018560213968157768, f1 0.9189472794532776
ep8_l1_test_time 0.9139163494110107
Test Epoch8 layer2 Acc 0.9176315789473685, AUC 0.9839786291122437, avg_entr 0.0160524882376194, f1 0.9176315665245056
ep8_l2_test_time 1.3480088710784912
Test Epoch8 layer3 Acc 0.9178947368421052, AUC 0.9814820885658264, avg_entr 0.01599125936627388, f1 0.917894721031189
ep8_l3_test_time 1.9034063816070557
Test Epoch8 layer4 Acc 0.9171052631578948, AUC 0.982012927532196, avg_entr 0.016367841511964798, f1 0.9171052575111389
ep8_l4_test_time 2.4620540142059326
gc 0
Train Epoch9 Acc 0.9593416666666666 (115121/120000), AUC 0.9941790103912354
ep9_train_time 277.1890127658844
Test Epoch9 layer0 Acc 0.9228947368421052, AUC 0.9825615882873535, avg_entr 0.05561206489801407, f1 0.9228947162628174
ep9_l0_test_time 0.5146684646606445
Test Epoch9 layer1 Acc 0.9184210526315789, AUC 0.9824811816215515, avg_entr 0.0170229934155941, f1 0.9184210896492004
ep9_l1_test_time 0.9195060729980469
Test Epoch9 layer2 Acc 0.9192105263157895, AUC 0.9833102822303772, avg_entr 0.015320460312068462, f1 0.9192105531692505
ep9_l2_test_time 1.3531928062438965
Test Epoch9 layer3 Acc 0.9176315789473685, AUC 0.9801496267318726, avg_entr 0.01553336251527071, f1 0.9176315665245056
ep9_l3_test_time 1.9015238285064697
Test Epoch9 layer4 Acc 0.9178947368421052, AUC 0.981619656085968, avg_entr 0.015929801389575005, f1 0.917894721031189
ep9_l4_test_time 2.4526419639587402
gc 0
Train Epoch10 Acc 0.9603 (115236/120000), AUC 0.9944801330566406
ep10_train_time 277.9459750652313
Test Epoch10 layer0 Acc 0.9194736842105263, AUC 0.9824559688568115, avg_entr 0.0524245984852314, f1 0.9194737076759338
ep10_l0_test_time 0.5191254615783691
Test Epoch10 layer1 Acc 0.92, AUC 0.9820528030395508, avg_entr 0.017221903428435326, f1 0.9200000166893005
ep10_l1_test_time 0.9115967750549316
Test Epoch10 layer2 Acc 0.9213157894736842, AUC 0.982974112033844, avg_entr 0.015024918131530285, f1 0.9213157892227173
ep10_l2_test_time 1.3480486869812012
Test Epoch10 layer3 Acc 0.9197368421052632, AUC 0.9801288843154907, avg_entr 0.015303296968340874, f1 0.9197368621826172
ep10_l3_test_time 1.8958547115325928
Test Epoch10 layer4 Acc 0.9197368421052632, AUC 0.981576681137085, avg_entr 0.015239880420267582, f1 0.9197368621826172
ep10_l4_test_time 2.455561876296997
gc 0
Train Epoch11 Acc 0.961725 (115407/120000), AUC 0.9946313500404358
ep11_train_time 278.0816967487335
Test Epoch11 layer0 Acc 0.9223684210526316, AUC 0.982437252998352, avg_entr 0.05042307451367378, f1 0.9223684072494507
ep11_l0_test_time 0.5273141860961914
Test Epoch11 layer1 Acc 0.9173684210526316, AUC 0.9823044538497925, avg_entr 0.01657673716545105, f1 0.9173683524131775
ep11_l1_test_time 0.902728796005249
Test Epoch11 layer2 Acc 0.9181578947368421, AUC 0.9830083250999451, avg_entr 0.015203827992081642, f1 0.9181578755378723
ep11_l2_test_time 1.3356807231903076
Test Epoch11 layer3 Acc 0.9163157894736842, AUC 0.9800071120262146, avg_entr 0.015279497019946575, f1 0.9163157939910889
ep11_l3_test_time 1.9015119075775146
Test Epoch11 layer4 Acc 0.9155263157894736, AUC 0.9811572432518005, avg_entr 0.015188337303698063, f1 0.9155263304710388
ep11_l4_test_time 2.4581658840179443
gc 0
Train Epoch12 Acc 0.9628583333333334 (115543/120000), AUC 0.9947485327720642
ep12_train_time 277.34532928466797
Test Epoch12 layer0 Acc 0.9210526315789473, AUC 0.982357382774353, avg_entr 0.048594120889902115, f1 0.9210526347160339
ep12_l0_test_time 0.5230612754821777
Test Epoch12 layer1 Acc 0.9189473684210526, AUC 0.9819055199623108, avg_entr 0.015544489957392216, f1 0.9189472794532776
ep12_l1_test_time 0.9181673526763916
Test Epoch12 layer2 Acc 0.9184210526315789, AUC 0.982744038105011, avg_entr 0.014058900065720081, f1 0.9184210896492004
ep12_l2_test_time 1.3343181610107422
Test Epoch12 layer3 Acc 0.9157894736842105, AUC 0.9800703525543213, avg_entr 0.01468788180500269, f1 0.9157894849777222
ep12_l3_test_time 1.8999075889587402
Test Epoch12 layer4 Acc 0.9163157894736842, AUC 0.9808737635612488, avg_entr 0.01394458394497633, f1 0.9163157939910889
ep12_l4_test_time 2.460043430328369
gc 0
Train Epoch13 Acc 0.9642833333333334 (115714/120000), AUC 0.9950571060180664
ep13_train_time 277.36497259140015
Test Epoch13 layer0 Acc 0.9207894736842105, AUC 0.9822882413864136, avg_entr 0.04683994501829147, f1 0.9207894802093506
ep13_l0_test_time 0.5218591690063477
Test Epoch13 layer1 Acc 0.9184210526315789, AUC 0.9818893074989319, avg_entr 0.015330061316490173, f1 0.9184210896492004
ep13_l1_test_time 0.9110565185546875
Test Epoch13 layer2 Acc 0.9186842105263158, AUC 0.982780396938324, avg_entr 0.013606328517198563, f1 0.918684184551239
ep13_l2_test_time 1.342677354812622
Test Epoch13 layer3 Acc 0.9168421052631579, AUC 0.9801924824714661, avg_entr 0.013505525887012482, f1 0.9168421030044556
ep13_l3_test_time 1.8951945304870605
Test Epoch13 layer4 Acc 0.9163157894736842, AUC 0.9804061651229858, avg_entr 0.01318145077675581, f1 0.9163157939910889
ep13_l4_test_time 2.4569361209869385
gc 0
Train Epoch14 Acc 0.9651 (115812/120000), AUC 0.9951425790786743
ep14_train_time 257.14911246299744
Test Epoch14 layer0 Acc 0.92, AUC 0.9822239875793457, avg_entr 0.04628228396177292, f1 0.9200000166893005
ep14_l0_test_time 0.33335089683532715
Test Epoch14 layer1 Acc 0.9171052631578948, AUC 0.9815617203712463, avg_entr 0.014946416951715946, f1 0.9171052575111389
ep14_l1_test_time 0.5902791023254395
Test Epoch14 layer2 Acc 0.9163157894736842, AUC 0.9823012351989746, avg_entr 0.01315050758421421, f1 0.9163157939910889
ep14_l2_test_time 0.883697509765625
Test Epoch14 layer3 Acc 0.9155263157894736, AUC 0.9795064926147461, avg_entr 0.012834976427257061, f1 0.9155263304710388
ep14_l3_test_time 1.2502734661102295
Test Epoch14 layer4 Acc 0.9163157894736842, AUC 0.9807630777359009, avg_entr 0.012846373952925205, f1 0.9163157939910889
ep14_l4_test_time 1.603959083557129
gc 0
Train Epoch15 Acc 0.9657083333333333 (115885/120000), AUC 0.9952083826065063
ep15_train_time 183.06520652770996
Test Epoch15 layer0 Acc 0.9210526315789473, AUC 0.9822006225585938, avg_entr 0.04426165670156479, f1 0.9210526347160339
ep15_l0_test_time 0.3284471035003662
Test Epoch15 layer1 Acc 0.9168421052631579, AUC 0.9813037514686584, avg_entr 0.01438027061522007, f1 0.9168421030044556
ep15_l1_test_time 0.5942220687866211
Test Epoch15 layer2 Acc 0.9171052631578948, AUC 0.9821305274963379, avg_entr 0.012563028372824192, f1 0.9171052575111389
ep15_l2_test_time 0.8906080722808838
Test Epoch15 layer3 Acc 0.9163157894736842, AUC 0.97917240858078, avg_entr 0.012717152945697308, f1 0.9163157939910889
ep15_l3_test_time 1.2511072158813477
Test Epoch15 layer4 Acc 0.9152631578947369, AUC 0.9804150462150574, avg_entr 0.012190084904432297, f1 0.9152631759643555
ep15_l4_test_time 1.5893442630767822
gc 0
Train Epoch16 Acc 0.9660583333333334 (115927/120000), AUC 0.9952690005302429
ep16_train_time 183.04528832435608
Test Epoch16 layer0 Acc 0.9210526315789473, AUC 0.982181191444397, avg_entr 0.042536113411188126, f1 0.9210526347160339
ep16_l0_test_time 0.330596923828125
Test Epoch16 layer1 Acc 0.9163157894736842, AUC 0.9811956882476807, avg_entr 0.01427538599818945, f1 0.9163157939910889
ep16_l1_test_time 0.5933923721313477
Test Epoch16 layer2 Acc 0.9160526315789473, AUC 0.9821827411651611, avg_entr 0.011859000660479069, f1 0.9160526394844055
ep16_l2_test_time 0.8867907524108887
Test Epoch16 layer3 Acc 0.9155263157894736, AUC 0.9792410135269165, avg_entr 0.01155733410269022, f1 0.9155263304710388
ep16_l3_test_time 1.2616078853607178
Test Epoch16 layer4 Acc 0.915, AUC 0.9804351329803467, avg_entr 0.011486383154988289, f1 0.9150000214576721
ep16_l4_test_time 1.6279304027557373
gc 0
Train Epoch17 Acc 0.967175 (116061/120000), AUC 0.9954631328582764
ep17_train_time 183.0596809387207
Test Epoch17 layer0 Acc 0.9207894736842105, AUC 0.982174277305603, avg_entr 0.04218905419111252, f1 0.9207894802093506
ep17_l0_test_time 0.3169569969177246
Test Epoch17 layer1 Acc 0.9160526315789473, AUC 0.9810621738433838, avg_entr 0.013437527231872082, f1 0.9160526394844055
ep17_l1_test_time 0.5836958885192871
Test Epoch17 layer2 Acc 0.9157894736842105, AUC 0.9819877743721008, avg_entr 0.011233072727918625, f1 0.9157894849777222
ep17_l2_test_time 0.8850002288818359
Test Epoch17 layer3 Acc 0.9155263157894736, AUC 0.9790359735488892, avg_entr 0.010872291401028633, f1 0.9155263304710388
ep17_l3_test_time 1.2470617294311523
Test Epoch17 layer4 Acc 0.9157894736842105, AUC 0.9804301857948303, avg_entr 0.010734531097114086, f1 0.9157894849777222
ep17_l4_test_time 1.617903709411621
gc 0
Train Epoch18 Acc 0.9671083333333333 (116053/120000), AUC 0.9954991340637207
ep18_train_time 183.02005696296692
Test Epoch18 layer0 Acc 0.9205263157894736, AUC 0.9821650981903076, avg_entr 0.040824614465236664, f1 0.9205263257026672
ep18_l0_test_time 0.3257482051849365
Test Epoch18 layer1 Acc 0.9160526315789473, AUC 0.9806948900222778, avg_entr 0.013290359638631344, f1 0.9160526394844055
ep18_l1_test_time 0.5909337997436523
Test Epoch18 layer2 Acc 0.916578947368421, AUC 0.9818857908248901, avg_entr 0.010846138931810856, f1 0.9165789484977722
ep18_l2_test_time 0.8881337642669678
Test Epoch18 layer3 Acc 0.9144736842105263, AUC 0.9787531495094299, avg_entr 0.01069949846714735, f1 0.9144737124443054
ep18_l3_test_time 1.2647974491119385
Test Epoch18 layer4 Acc 0.9142105263157895, AUC 0.9802728891372681, avg_entr 0.010597062297165394, f1 0.9142104983329773
ep18_l4_test_time 1.6194159984588623
gc 0
Train Epoch19 Acc 0.9678083333333334 (116137/120000), AUC 0.9955029487609863
ep19_train_time 183.14535760879517
Test Epoch19 layer0 Acc 0.9207894736842105, AUC 0.9821506142616272, avg_entr 0.039623409509658813, f1 0.9207894802093506
ep19_l0_test_time 0.32975149154663086
Test Epoch19 layer1 Acc 0.915, AUC 0.980588972568512, avg_entr 0.012928600423038006, f1 0.9150000214576721
ep19_l1_test_time 0.5935590267181396
Test Epoch19 layer2 Acc 0.9157894736842105, AUC 0.9814939498901367, avg_entr 0.010654865764081478, f1 0.9157894849777222
ep19_l2_test_time 0.8895328044891357
Test Epoch19 layer3 Acc 0.9147368421052632, AUC 0.9788174629211426, avg_entr 0.010166622698307037, f1 0.9147368669509888
ep19_l3_test_time 1.2572035789489746
Test Epoch19 layer4 Acc 0.9147368421052632, AUC 0.9799685478210449, avg_entr 0.010166591964662075, f1 0.9147368669509888
ep19_l4_test_time 1.6067886352539062
gc 0
Train Epoch20 Acc 0.9678583333333334 (116143/120000), AUC 0.9954637885093689
ep20_train_time 183.19952082633972
Test Epoch20 layer0 Acc 0.9205263157894736, AUC 0.9821275472640991, avg_entr 0.03844021260738373, f1 0.9205263257026672
ep20_l0_test_time 0.3198513984680176
Test Epoch20 layer1 Acc 0.9157894736842105, AUC 0.9805290102958679, avg_entr 0.01248813048005104, f1 0.9157894849777222
ep20_l1_test_time 0.5877530574798584
Test Epoch20 layer2 Acc 0.916578947368421, AUC 0.9813673496246338, avg_entr 0.009778158739209175, f1 0.9165789484977722
ep20_l2_test_time 0.8900039196014404
Test Epoch20 layer3 Acc 0.9144736842105263, AUC 0.9785494804382324, avg_entr 0.009688073769211769, f1 0.9144737124443054
ep20_l3_test_time 1.2528479099273682
Test Epoch20 layer4 Acc 0.9144736842105263, AUC 0.9797154068946838, avg_entr 0.00942089781165123, f1 0.9144737124443054
ep20_l4_test_time 1.6001996994018555
gc 0
Train Epoch21 Acc 0.9682333333333333 (116188/120000), AUC 0.9955093860626221
ep21_train_time 183.1273775100708
Test Epoch21 layer0 Acc 0.9218421052631579, AUC 0.9821503758430481, avg_entr 0.03764479234814644, f1 0.921842098236084
ep21_l0_test_time 0.32831454277038574
Test Epoch21 layer1 Acc 0.9155263157894736, AUC 0.9803164005279541, avg_entr 0.012169713154435158, f1 0.9155263304710388
ep21_l1_test_time 0.5853779315948486
Test Epoch21 layer2 Acc 0.916578947368421, AUC 0.9812077283859253, avg_entr 0.009305574931204319, f1 0.9165789484977722
ep21_l2_test_time 0.9035124778747559
Test Epoch21 layer3 Acc 0.915, AUC 0.9785095453262329, avg_entr 0.00928054004907608, f1 0.9150000214576721
ep21_l3_test_time 1.2681457996368408
Test Epoch21 layer4 Acc 0.915, AUC 0.9798914194107056, avg_entr 0.009479844011366367, f1 0.9150000214576721
ep21_l4_test_time 1.6248629093170166
gc 0
Train Epoch22 Acc 0.9684416666666666 (116213/120000), AUC 0.995562732219696
ep22_train_time 183.2130126953125
Test Epoch22 layer0 Acc 0.9210526315789473, AUC 0.9821404218673706, avg_entr 0.037327446043491364, f1 0.9210526347160339
ep22_l0_test_time 0.32178711891174316
Test Epoch22 layer1 Acc 0.9147368421052632, AUC 0.9805145859718323, avg_entr 0.012140479870140553, f1 0.9147368669509888
ep22_l1_test_time 0.5949583053588867
Test Epoch22 layer2 Acc 0.9147368421052632, AUC 0.9814496040344238, avg_entr 0.009613621979951859, f1 0.9147368669509888
ep22_l2_test_time 0.8805079460144043
Test Epoch22 layer3 Acc 0.9147368421052632, AUC 0.9787136912345886, avg_entr 0.008670225739479065, f1 0.9147368669509888
ep22_l3_test_time 1.2354896068572998
Test Epoch22 layer4 Acc 0.9152631578947369, AUC 0.9800127744674683, avg_entr 0.008572729304432869, f1 0.9152631759643555
ep22_l4_test_time 1.6182947158813477
gc 0
Train Epoch23 Acc 0.9685916666666666 (116231/120000), AUC 0.9955840110778809
ep23_train_time 183.19826221466064
Test Epoch23 layer0 Acc 0.92, AUC 0.9821205139160156, avg_entr 0.03651087358593941, f1 0.9200000166893005
ep23_l0_test_time 0.32591700553894043
Test Epoch23 layer1 Acc 0.915, AUC 0.9802464246749878, avg_entr 0.01173675712198019, f1 0.9150000214576721
ep23_l1_test_time 0.5917987823486328
Test Epoch23 layer2 Acc 0.9160526315789473, AUC 0.9810726642608643, avg_entr 0.008834348991513252, f1 0.9160526394844055
ep23_l2_test_time 0.8965029716491699
Test Epoch23 layer3 Acc 0.9147368421052632, AUC 0.9780821800231934, avg_entr 0.008928432129323483, f1 0.9147368669509888
ep23_l3_test_time 1.2676475048065186
Test Epoch23 layer4 Acc 0.9147368421052632, AUC 0.9797296524047852, avg_entr 0.008990596979856491, f1 0.9147368669509888
ep23_l4_test_time 1.620208501815796
gc 0
Train Epoch24 Acc 0.9686833333333333 (116242/120000), AUC 0.9955875873565674
ep24_train_time 183.14281511306763
Test Epoch24 layer0 Acc 0.9210526315789473, AUC 0.9821217656135559, avg_entr 0.03624940663576126, f1 0.9210526347160339
ep24_l0_test_time 0.32870936393737793
Test Epoch24 layer1 Acc 0.9152631578947369, AUC 0.9802457094192505, avg_entr 0.011600670404732227, f1 0.9152631759643555
ep24_l1_test_time 0.592658519744873
Test Epoch24 layer2 Acc 0.9157894736842105, AUC 0.9810821413993835, avg_entr 0.00868423655629158, f1 0.9157894849777222
ep24_l2_test_time 0.8882229328155518
Test Epoch24 layer3 Acc 0.9152631578947369, AUC 0.9783372282981873, avg_entr 0.008504720404744148, f1 0.9152631759643555
ep24_l3_test_time 1.257213830947876
Test Epoch24 layer4 Acc 0.9155263157894736, AUC 0.9797866344451904, avg_entr 0.008613202720880508, f1 0.9155263304710388
ep24_l4_test_time 1.612663745880127
gc 0
Train Epoch25 Acc 0.9689833333333333 (116278/120000), AUC 0.9956315755844116
ep25_train_time 183.2576460838318
Test Epoch25 layer0 Acc 0.9218421052631579, AUC 0.9821195006370544, avg_entr 0.035683516412973404, f1 0.921842098236084
ep25_l0_test_time 0.33209967613220215
Test Epoch25 layer1 Acc 0.915, AUC 0.980341911315918, avg_entr 0.011608155444264412, f1 0.9150000214576721
ep25_l1_test_time 0.5939137935638428
Test Epoch25 layer2 Acc 0.9152631578947369, AUC 0.9812297821044922, avg_entr 0.008466580882668495, f1 0.9152631759643555
ep25_l2_test_time 0.8921260833740234
Test Epoch25 layer3 Acc 0.9152631578947369, AUC 0.9784150123596191, avg_entr 0.008069317787885666, f1 0.9152631759643555
ep25_l3_test_time 1.2582266330718994
Test Epoch25 layer4 Acc 0.915, AUC 0.9798987507820129, avg_entr 0.007948442362248898, f1 0.9150000214576721
ep25_l4_test_time 1.598766803741455
gc 0
Train Epoch26 Acc 0.9690083333333334 (116281/120000), AUC 0.9956563711166382
ep26_train_time 183.2287518978119
Test Epoch26 layer0 Acc 0.9210526315789473, AUC 0.9821094870567322, avg_entr 0.03595615550875664, f1 0.9210526347160339
ep26_l0_test_time 0.32354307174682617
Test Epoch26 layer1 Acc 0.9147368421052632, AUC 0.9803497791290283, avg_entr 0.011615609750151634, f1 0.9147368669509888
ep26_l1_test_time 0.5907845497131348
Test Epoch26 layer2 Acc 0.915, AUC 0.9812299013137817, avg_entr 0.008870932273566723, f1 0.9150000214576721
ep26_l2_test_time 0.896796703338623
Test Epoch26 layer3 Acc 0.9155263157894736, AUC 0.9785656929016113, avg_entr 0.008067933842539787, f1 0.9155263304710388
ep26_l3_test_time 1.2601470947265625
Test Epoch26 layer4 Acc 0.9147368421052632, AUC 0.9799590110778809, avg_entr 0.008156689815223217, f1 0.9147368669509888
ep26_l4_test_time 1.6298906803131104
gc 0
Train Epoch27 Acc 0.9692 (116304/120000), AUC 0.9956696629524231
ep27_train_time 183.29293847084045
Test Epoch27 layer0 Acc 0.921578947368421, AUC 0.9821072816848755, avg_entr 0.035597898066043854, f1 0.9215789437294006
ep27_l0_test_time 0.32044100761413574
Test Epoch27 layer1 Acc 0.9144736842105263, AUC 0.9802215099334717, avg_entr 0.011491192504763603, f1 0.9144737124443054
ep27_l1_test_time 0.594933271408081
Test Epoch27 layer2 Acc 0.9155263157894736, AUC 0.9810749292373657, avg_entr 0.008429057896137238, f1 0.9155263304710388
ep27_l2_test_time 0.8922805786132812
Test Epoch27 layer3 Acc 0.9152631578947369, AUC 0.978220522403717, avg_entr 0.007955239154398441, f1 0.9152631759643555
ep27_l3_test_time 1.2509949207305908
Test Epoch27 layer4 Acc 0.915, AUC 0.979682207107544, avg_entr 0.00791558064520359, f1 0.9150000214576721
ep27_l4_test_time 1.61342453956604
gc 0
Train Epoch28 Acc 0.9692083333333333 (116305/120000), AUC 0.995673656463623
ep28_train_time 183.39862251281738
Test Epoch28 layer0 Acc 0.9207894736842105, AUC 0.9820927977561951, avg_entr 0.035239096730947495, f1 0.9207894802093506
ep28_l0_test_time 0.32398200035095215
Test Epoch28 layer1 Acc 0.9147368421052632, AUC 0.9802671670913696, avg_entr 0.011483808048069477, f1 0.9147368669509888
ep28_l1_test_time 0.5941743850708008
Test Epoch28 layer2 Acc 0.9155263157894736, AUC 0.9811002612113953, avg_entr 0.008401850238442421, f1 0.9155263304710388
ep28_l2_test_time 0.895967960357666
Test Epoch28 layer3 Acc 0.9155263157894736, AUC 0.9782903790473938, avg_entr 0.00769461365416646, f1 0.9155263304710388
ep28_l3_test_time 1.261206865310669
Test Epoch28 layer4 Acc 0.9152631578947369, AUC 0.9796047210693359, avg_entr 0.007742960937321186, f1 0.9152631759643555
ep28_l4_test_time 1.6256635189056396
gc 0
Train Epoch29 Acc 0.9694416666666666 (116333/120000), AUC 0.9956929683685303
ep29_train_time 183.18212938308716
Test Epoch29 layer0 Acc 0.9207894736842105, AUC 0.9821029901504517, avg_entr 0.035245466977357864, f1 0.9207894802093506
ep29_l0_test_time 0.32448625564575195
Test Epoch29 layer1 Acc 0.9147368421052632, AUC 0.9802011251449585, avg_entr 0.011318076401948929, f1 0.9147368669509888
ep29_l1_test_time 0.5940258502960205
Test Epoch29 layer2 Acc 0.915, AUC 0.981026828289032, avg_entr 0.008197138085961342, f1 0.9150000214576721
ep29_l2_test_time 0.8936665058135986
Test Epoch29 layer3 Acc 0.9152631578947369, AUC 0.9780063629150391, avg_entr 0.007922961376607418, f1 0.9152631759643555
ep29_l3_test_time 1.247218370437622
Test Epoch29 layer4 Acc 0.9147368421052632, AUC 0.979804515838623, avg_entr 0.007570055779069662, f1 0.9147368669509888
ep29_l4_test_time 1.5987060070037842
Best AUC tensor(0.9232) 6 4
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 7057.868070363998
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5_pad177//ag_news_lstmal_l5.pt
Test layer0 Acc 0.9126315789473685, AUC 0.9809325933456421, avg_entr 0.07388696074485779, f1 0.9126315712928772
l0_test_time 0.31888604164123535
Test layer1 Acc 0.9092105263157895, AUC 0.9825944304466248, avg_entr 0.026108674705028534, f1 0.9092105031013489
l1_test_time 0.5857419967651367
Test layer2 Acc 0.9123684210526316, AUC 0.9834166765213013, avg_entr 0.022628210484981537, f1 0.9123684167861938
l2_test_time 0.8871958255767822
Test layer3 Acc 0.9118421052631579, AUC 0.9815661907196045, avg_entr 0.022519158199429512, f1 0.9118421077728271
l3_test_time 1.2536826133728027
Test layer4 Acc 0.9118421052631579, AUC 0.9825539588928223, avg_entr 0.023519741371273994, f1 0.9118421077728271
l4_test_time 1.5962843894958496
