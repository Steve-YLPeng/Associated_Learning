total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.210644006729126
Start Training
gc 0
Train Epoch0 Acc 0.634625 (76155/120000), AUC 0.8573150634765625
ep0_train_time 10.53854489326477
Test Epoch0 layer4 Acc 0.8978947368421053, AUC 0.9767888188362122, avg_entr 0.2323891520500183, f1 0.8978947401046753
ep0_l4_test_time 0.16585087776184082
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9165333333333333 (109984/120000), AUC 0.9814552068710327
ep1_train_time 10.119440078735352
Test Epoch1 layer4 Acc 0.9163157894736842, AUC 0.9800450801849365, avg_entr 0.12297185510396957, f1 0.9163157939910889
ep1_l4_test_time 0.16352105140686035
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9274333333333333 (111292/120000), AUC 0.9856626391410828
ep2_train_time 10.002228498458862
Test Epoch2 layer4 Acc 0.9210526315789473, AUC 0.981764554977417, avg_entr 0.08139519393444061, f1 0.9210526347160339
ep2_l4_test_time 0.1635286808013916
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9326083333333334 (111913/120000), AUC 0.9879884719848633
ep3_train_time 9.98594880104065
Test Epoch3 layer4 Acc 0.9213157894736842, AUC 0.9832090735435486, avg_entr 0.05444418638944626, f1 0.9213157892227173
ep3_l4_test_time 0.16339755058288574
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9373333333333334 (112480/120000), AUC 0.9892796277999878
ep4_train_time 10.049054145812988
Test Epoch4 layer4 Acc 0.9205263157894736, AUC 0.9825372099876404, avg_entr 0.03937771916389465, f1 0.9205263257026672
ep4_l4_test_time 0.1633141040802002
gc 0
Train Epoch5 Acc 0.9404166666666667 (112850/120000), AUC 0.9900655746459961
ep5_train_time 10.016589879989624
Test Epoch5 layer4 Acc 0.9226315789473685, AUC 0.9821826815605164, avg_entr 0.03043484129011631, f1 0.922631561756134
ep5_l4_test_time 0.16411280632019043
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9431 (113172/120000), AUC 0.9910407066345215
ep6_train_time 10.04537057876587
Test Epoch6 layer4 Acc 0.9234210526315789, AUC 0.9811328053474426, avg_entr 0.02590714767575264, f1 0.9234210252761841
ep6_l4_test_time 0.1632833480834961
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9452083333333333 (113425/120000), AUC 0.9918361902236938
ep7_train_time 10.132329225540161
Test Epoch7 layer4 Acc 0.9218421052631579, AUC 0.981278657913208, avg_entr 0.02280312031507492, f1 0.921842098236084
ep7_l4_test_time 0.16347122192382812
gc 0
Train Epoch8 Acc 0.9469 (113628/120000), AUC 0.9925855994224548
ep8_train_time 10.028182983398438
Test Epoch8 layer4 Acc 0.9231578947368421, AUC 0.9830304384231567, avg_entr 0.02008061110973358, f1 0.9231578707695007
ep8_l4_test_time 0.16365480422973633
gc 0
Train Epoch9 Acc 0.9481666666666667 (113780/120000), AUC 0.9930003881454468
ep9_train_time 10.066586971282959
Test Epoch9 layer4 Acc 0.9228947368421052, AUC 0.9815411567687988, avg_entr 0.019327284768223763, f1 0.9228947162628174
ep9_l4_test_time 0.16443657875061035
gc 0
Train Epoch10 Acc 0.9496416666666667 (113957/120000), AUC 0.9932776093482971
ep10_train_time 10.083507061004639
Test Epoch10 layer4 Acc 0.921578947368421, AUC 0.982785701751709, avg_entr 0.018402690067887306, f1 0.9215789437294006
ep10_l4_test_time 0.16402125358581543
gc 0
Train Epoch11 Acc 0.9506166666666667 (114074/120000), AUC 0.9934868812561035
ep11_train_time 10.10702896118164
Test Epoch11 layer4 Acc 0.9213157894736842, AUC 0.9827392101287842, avg_entr 0.016668027266860008, f1 0.9213157892227173
ep11_l4_test_time 0.1631636619567871
gc 0
Train Epoch12 Acc 0.9519416666666667 (114233/120000), AUC 0.9938271045684814
ep12_train_time 10.075427293777466
Test Epoch12 layer4 Acc 0.9210526315789473, AUC 0.9824252128601074, avg_entr 0.016817834228277206, f1 0.9210526347160339
ep12_l4_test_time 0.16350650787353516
gc 0
Train Epoch13 Acc 0.9526333333333333 (114316/120000), AUC 0.99406898021698
ep13_train_time 10.147675514221191
Test Epoch13 layer4 Acc 0.9178947368421052, AUC 0.9811899662017822, avg_entr 0.016160164028406143, f1 0.917894721031189
ep13_l4_test_time 0.16333413124084473
gc 0
Train Epoch14 Acc 0.9535666666666667 (114428/120000), AUC 0.9942787885665894
ep14_train_time 9.998125553131104
Test Epoch14 layer4 Acc 0.9202631578947369, AUC 0.98157799243927, avg_entr 0.015808751806616783, f1 0.9202631711959839
ep14_l4_test_time 0.16344237327575684
gc 0
Train Epoch15 Acc 0.954 (114480/120000), AUC 0.9943878650665283
ep15_train_time 10.108602046966553
Test Epoch15 layer4 Acc 0.9202631578947369, AUC 0.9815326929092407, avg_entr 0.01584126055240631, f1 0.9202631711959839
ep15_l4_test_time 0.16390466690063477
gc 0
Train Epoch16 Acc 0.9546833333333333 (114562/120000), AUC 0.9946248531341553
ep16_train_time 10.112483978271484
Test Epoch16 layer4 Acc 0.9173684210526316, AUC 0.9810948371887207, avg_entr 0.014811786822974682, f1 0.9173683524131775
ep16_l4_test_time 0.16467714309692383
gc 0
Train Epoch17 Acc 0.9549583333333334 (114595/120000), AUC 0.9945724606513977
ep17_train_time 10.17130160331726
Test Epoch17 layer4 Acc 0.9205263157894736, AUC 0.9811802506446838, avg_entr 0.01432532537728548, f1 0.9205263257026672
ep17_l4_test_time 0.16374421119689941
gc 0
Train Epoch18 Acc 0.9554916666666666 (114659/120000), AUC 0.9948249459266663
ep18_train_time 10.032909154891968
Test Epoch18 layer4 Acc 0.9163157894736842, AUC 0.9801730513572693, avg_entr 0.015232449397444725, f1 0.9163157939910889
ep18_l4_test_time 0.16347241401672363
gc 0
Train Epoch19 Acc 0.9563 (114756/120000), AUC 0.9948910474777222
ep19_train_time 10.122873783111572
Test Epoch19 layer4 Acc 0.9184210526315789, AUC 0.9807077646255493, avg_entr 0.014441474340856075, f1 0.9184210896492004
ep19_l4_test_time 0.16363239288330078
gc 0
Train Epoch20 Acc 0.9570666666666666 (114848/120000), AUC 0.995035707950592
ep20_train_time 10.107337474822998
Test Epoch20 layer4 Acc 0.9194736842105263, AUC 0.9807388186454773, avg_entr 0.013544734567403793, f1 0.9194737076759338
ep20_l4_test_time 0.16450238227844238
gc 0
Train Epoch21 Acc 0.9573416666666666 (114881/120000), AUC 0.995039701461792
ep21_train_time 10.156187295913696
Test Epoch21 layer4 Acc 0.9189473684210526, AUC 0.9805079698562622, avg_entr 0.013219744898378849, f1 0.9189472794532776
ep21_l4_test_time 0.1634824275970459
gc 0
Train Epoch22 Acc 0.9578 (114936/120000), AUC 0.995137631893158
ep22_train_time 10.09617829322815
Test Epoch22 layer4 Acc 0.9163157894736842, AUC 0.9807846546173096, avg_entr 0.01216018758714199, f1 0.9163157939910889
ep22_l4_test_time 0.16315793991088867
gc 0
Train Epoch23 Acc 0.958225 (114987/120000), AUC 0.9951979517936707
ep23_train_time 10.064333438873291
Test Epoch23 layer4 Acc 0.9152631578947369, AUC 0.980492353439331, avg_entr 0.012229040265083313, f1 0.9152631759643555
ep23_l4_test_time 0.1628861427307129
gc 0
Train Epoch24 Acc 0.958475 (115017/120000), AUC 0.9952906966209412
ep24_train_time 10.054328918457031
Test Epoch24 layer4 Acc 0.9155263157894736, AUC 0.9802881479263306, avg_entr 0.012770461849868298, f1 0.9155263304710388
ep24_l4_test_time 0.16294121742248535
gc 0
Train Epoch25 Acc 0.9589916666666667 (115079/120000), AUC 0.9953312277793884
ep25_train_time 10.06543254852295
Test Epoch25 layer4 Acc 0.9178947368421052, AUC 0.9807023406028748, avg_entr 0.013131181709468365, f1 0.917894721031189
ep25_l4_test_time 0.16318178176879883
gc 0
Train Epoch26 Acc 0.95925 (115110/120000), AUC 0.9954231381416321
ep26_train_time 10.13811182975769
Test Epoch26 layer4 Acc 0.9168421052631579, AUC 0.9798469543457031, avg_entr 0.012314978986978531, f1 0.9168421030044556
ep26_l4_test_time 0.16344475746154785
gc 0
Train Epoch27 Acc 0.95955 (115146/120000), AUC 0.9954153299331665
ep27_train_time 10.132580518722534
Test Epoch27 layer4 Acc 0.9173684210526316, AUC 0.9799435138702393, avg_entr 0.013050956651568413, f1 0.9173683524131775
ep27_l4_test_time 0.1632835865020752
gc 0
Train Epoch28 Acc 0.9599416666666667 (115193/120000), AUC 0.9955199360847473
ep28_train_time 10.089853763580322
Test Epoch28 layer4 Acc 0.9160526315789473, AUC 0.9795902371406555, avg_entr 0.012326647527515888, f1 0.9160526394844055
ep28_l4_test_time 0.16338443756103516
gc 0
Train Epoch29 Acc 0.9603833333333334 (115246/120000), AUC 0.9955502152442932
ep29_train_time 10.104007005691528
Test Epoch29 layer4 Acc 0.9152631578947369, AUC 0.9801953434944153, avg_entr 0.011775171384215355, f1 0.9152631759643555
ep29_l4_test_time 0.16372466087341309
Best AUC tensor(0.9234) 6
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 309.5951807498932
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt
Test layer0 Acc 0.9128947368421053, AUC 0.9809520244598389, avg_entr 0.07331158220767975, f1 0.9128947257995605
l0_test_time 0.15586590766906738
Test layer1 Acc 0.9139473684210526, AUC 0.98058021068573, avg_entr 0.070380300283432, f1 0.913947343826294
l1_test_time 0.1571638584136963
Test layer2 Acc 0.9131578947368421, AUC 0.9810973405838013, avg_entr 0.059826355427503586, f1 0.9131578803062439
l2_test_time 0.1584787368774414
Test layer3 Acc 0.9131578947368421, AUC 0.9809370040893555, avg_entr 0.03586121276021004, f1 0.9131578803062439
l3_test_time 0.15891575813293457
Test layer4 Acc 0.9128947368421053, AUC 0.9785709381103516, avg_entr 0.02826351299881935, f1 0.9128947257995605
l4_test_time 0.16100406646728516
