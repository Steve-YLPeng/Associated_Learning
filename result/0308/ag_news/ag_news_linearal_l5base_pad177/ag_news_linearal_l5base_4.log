total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.229867935180664
Start Training
gc 0
Train Epoch0 Acc 0.6342166666666667 (76106/120000), AUC 0.8527817726135254
ep0_train_time 10.495651483535767
Test Epoch0 layer4 Acc 0.9021052631578947, AUC 0.9773277640342712, avg_entr 0.2271885722875595, f1 0.9021052718162537
ep0_l4_test_time 0.1630713939666748
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9171166666666667 (110054/120000), AUC 0.9815879464149475
ep1_train_time 10.15705156326294
Test Epoch1 layer4 Acc 0.915, AUC 0.9809201955795288, avg_entr 0.1253202259540558, f1 0.9150000214576721
ep1_l4_test_time 0.16270685195922852
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9269916666666667 (111239/120000), AUC 0.9857979416847229
ep2_train_time 10.00873327255249
Test Epoch2 layer4 Acc 0.9181578947368421, AUC 0.9826434850692749, avg_entr 0.08393299579620361, f1 0.9181578755378723
ep2_l4_test_time 0.16065096855163574
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9327333333333333 (111928/120000), AUC 0.9882107377052307
ep3_train_time 10.100754022598267
Test Epoch3 layer4 Acc 0.9228947368421052, AUC 0.9827982187271118, avg_entr 0.054109252989292145, f1 0.9228947162628174
ep3_l4_test_time 0.16124176979064941
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9368416666666667 (112421/120000), AUC 0.9894342422485352
ep4_train_time 10.023136615753174
Test Epoch4 layer4 Acc 0.9226315789473685, AUC 0.9823912978172302, avg_entr 0.03856907784938812, f1 0.922631561756134
ep4_l4_test_time 0.16061878204345703
gc 0
Train Epoch5 Acc 0.9397333333333333 (112768/120000), AUC 0.9900348782539368
ep5_train_time 9.994950294494629
Test Epoch5 layer4 Acc 0.9234210526315789, AUC 0.9812216758728027, avg_entr 0.02984260581433773, f1 0.9234210252761841
ep5_l4_test_time 0.16126489639282227
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9430166666666666 (113162/120000), AUC 0.9909936189651489
ep6_train_time 10.029256582260132
Test Epoch6 layer4 Acc 0.9239473684210526, AUC 0.9817019701004028, avg_entr 0.02710413932800293, f1 0.9239473938941956
ep6_l4_test_time 0.16185545921325684
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.945225 (113427/120000), AUC 0.9919441342353821
ep7_train_time 10.115676879882812
Test Epoch7 layer4 Acc 0.9226315789473685, AUC 0.9826483726501465, avg_entr 0.023300806060433388, f1 0.922631561756134
ep7_l4_test_time 0.16118812561035156
gc 0
Train Epoch8 Acc 0.9470166666666666 (113642/120000), AUC 0.9925779104232788
ep8_train_time 10.213256120681763
Test Epoch8 layer4 Acc 0.9234210526315789, AUC 0.9817481637001038, avg_entr 0.021167980507016182, f1 0.9234210252761841
ep8_l4_test_time 0.16434311866760254
gc 0
Train Epoch9 Acc 0.9483166666666667 (113798/120000), AUC 0.9929373264312744
ep9_train_time 10.593739986419678
Test Epoch9 layer4 Acc 0.9223684210526316, AUC 0.9821076393127441, avg_entr 0.01904929429292679, f1 0.9223684072494507
ep9_l4_test_time 0.1651763916015625
gc 0
Train Epoch10 Acc 0.9494833333333333 (113938/120000), AUC 0.9933752417564392
ep10_train_time 10.380233764648438
Test Epoch10 layer4 Acc 0.9213157894736842, AUC 0.9811887145042419, avg_entr 0.018763437867164612, f1 0.9213157892227173
ep10_l4_test_time 0.1783428192138672
gc 0
Train Epoch11 Acc 0.950825 (114099/120000), AUC 0.9937596917152405
ep11_train_time 22.80223035812378
Test Epoch11 layer4 Acc 0.9207894736842105, AUC 0.9820761680603027, avg_entr 0.01613733544945717, f1 0.9207894802093506
ep11_l4_test_time 0.32926368713378906
gc 0
Train Epoch12 Acc 0.951925 (114231/120000), AUC 0.9939321875572205
ep12_train_time 25.347642183303833
Test Epoch12 layer4 Acc 0.921578947368421, AUC 0.9811294674873352, avg_entr 0.015950987115502357, f1 0.9215789437294006
ep12_l4_test_time 0.3278975486755371
gc 0
Train Epoch13 Acc 0.952825 (114339/120000), AUC 0.9941953420639038
ep13_train_time 25.409751653671265
Test Epoch13 layer4 Acc 0.9210526315789473, AUC 0.9814959168434143, avg_entr 0.014462752267718315, f1 0.9210526347160339
ep13_l4_test_time 0.3338019847869873
gc 0
Train Epoch14 Acc 0.9536916666666667 (114443/120000), AUC 0.9943293929100037
ep14_train_time 25.34131145477295
Test Epoch14 layer4 Acc 0.9194736842105263, AUC 0.9815606474876404, avg_entr 0.014376716688275337, f1 0.9194737076759338
ep14_l4_test_time 0.33180737495422363
gc 0
Train Epoch15 Acc 0.9541916666666667 (114503/120000), AUC 0.9944210052490234
ep15_train_time 25.377638578414917
Test Epoch15 layer4 Acc 0.92, AUC 0.98121178150177, avg_entr 0.01309596374630928, f1 0.9200000166893005
ep15_l4_test_time 0.32720041275024414
gc 0
Train Epoch16 Acc 0.9549333333333333 (114592/120000), AUC 0.9946245551109314
ep16_train_time 25.365134716033936
Test Epoch16 layer4 Acc 0.9189473684210526, AUC 0.981121838092804, avg_entr 0.013984354212880135, f1 0.9189472794532776
ep16_l4_test_time 0.32602405548095703
gc 0
Train Epoch17 Acc 0.955625 (114675/120000), AUC 0.994702935218811
ep17_train_time 24.997233867645264
Test Epoch17 layer4 Acc 0.9176315789473685, AUC 0.9803715348243713, avg_entr 0.012691701762378216, f1 0.9176315665245056
ep17_l4_test_time 0.31603288650512695
gc 0
Train Epoch18 Acc 0.9561166666666666 (114734/120000), AUC 0.9948641061782837
ep18_train_time 25.386037349700928
Test Epoch18 layer4 Acc 0.9184210526315789, AUC 0.980338454246521, avg_entr 0.011949273757636547, f1 0.9184210896492004
ep18_l4_test_time 0.3256111145019531
gc 0
Train Epoch19 Acc 0.9569416666666667 (114833/120000), AUC 0.9950028657913208
ep19_train_time 25.425329208374023
Test Epoch19 layer4 Acc 0.9178947368421052, AUC 0.9812735319137573, avg_entr 0.011679016053676605, f1 0.917894721031189
ep19_l4_test_time 0.3351938724517822
gc 0
Train Epoch20 Acc 0.95705 (114846/120000), AUC 0.9951213598251343
ep20_train_time 25.4181649684906
Test Epoch20 layer4 Acc 0.9155263157894736, AUC 0.9806302785873413, avg_entr 0.01164134033024311, f1 0.9155263304710388
ep20_l4_test_time 0.33002209663391113
gc 0
Train Epoch21 Acc 0.957525 (114903/120000), AUC 0.9951620697975159
ep21_train_time 25.401329517364502
Test Epoch21 layer4 Acc 0.9173684210526316, AUC 0.9806424379348755, avg_entr 0.011167001910507679, f1 0.9173683524131775
ep21_l4_test_time 0.3238332271575928
gc 0
Train Epoch22 Acc 0.9579333333333333 (114952/120000), AUC 0.9952749013900757
ep22_train_time 25.44433903694153
Test Epoch22 layer4 Acc 0.9178947368421052, AUC 0.980220377445221, avg_entr 0.010552484542131424, f1 0.917894721031189
ep22_l4_test_time 0.3376338481903076
gc 0
Train Epoch23 Acc 0.95825 (114990/120000), AUC 0.99532550573349
ep23_train_time 25.39456605911255
Test Epoch23 layer4 Acc 0.9168421052631579, AUC 0.9810549020767212, avg_entr 0.01166023500263691, f1 0.9168421030044556
ep23_l4_test_time 0.32260584831237793
gc 0
Train Epoch24 Acc 0.9589166666666666 (115070/120000), AUC 0.995428204536438
ep24_train_time 24.921550273895264
Test Epoch24 layer4 Acc 0.916578947368421, AUC 0.9806816577911377, avg_entr 0.011781640350818634, f1 0.9165789484977722
ep24_l4_test_time 0.3285648822784424
gc 0
Train Epoch25 Acc 0.9592583333333333 (115111/120000), AUC 0.9955177903175354
ep25_train_time 25.41395902633667
Test Epoch25 layer4 Acc 0.916578947368421, AUC 0.9800580143928528, avg_entr 0.01153178233653307, f1 0.9165789484977722
ep25_l4_test_time 0.3314797878265381
gc 0
Train Epoch26 Acc 0.959025 (115083/120000), AUC 0.9956037998199463
ep26_train_time 25.370314359664917
Test Epoch26 layer4 Acc 0.9152631578947369, AUC 0.9804812669754028, avg_entr 0.013652900233864784, f1 0.9152631759643555
ep26_l4_test_time 0.32953333854675293
gc 0
Train Epoch27 Acc 0.9599583333333334 (115195/120000), AUC 0.9955966472625732
ep27_train_time 25.391375064849854
Test Epoch27 layer4 Acc 0.9184210526315789, AUC 0.9807196259498596, avg_entr 0.011999261565506458, f1 0.9184210896492004
ep27_l4_test_time 0.3277547359466553
gc 0
Train Epoch28 Acc 0.9598166666666667 (115178/120000), AUC 0.9957090616226196
ep28_train_time 25.374539136886597
Test Epoch28 layer4 Acc 0.9147368421052632, AUC 0.9801222681999207, avg_entr 0.01068553514778614, f1 0.9147368669509888
ep28_l4_test_time 0.32610630989074707
gc 0
Train Epoch29 Acc 0.9604166666666667 (115250/120000), AUC 0.9957451820373535
ep29_train_time 25.37250804901123
Test Epoch29 layer4 Acc 0.9176315789473685, AUC 0.9799709320068359, avg_entr 0.01119593158364296, f1 0.9176315665245056
ep29_l4_test_time 0.322509765625
Best AUC tensor(0.9239) 6
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 600.9781680107117
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt
Test layer0 Acc 0.9123684210526316, AUC 0.9812389612197876, avg_entr 0.07217803597450256, f1 0.9123684167861938
l0_test_time 0.32343006134033203
Test layer1 Acc 0.9128947368421053, AUC 0.9811689257621765, avg_entr 0.06943106651306152, f1 0.9128947257995605
l1_test_time 0.3228771686553955
Test layer2 Acc 0.9118421052631579, AUC 0.9815425872802734, avg_entr 0.06022028625011444, f1 0.9118421077728271
l2_test_time 0.3271982669830322
Test layer3 Acc 0.9126315789473685, AUC 0.9818174242973328, avg_entr 0.03711533173918724, f1 0.9126315712928772
l3_test_time 0.3232736587524414
Test layer4 Acc 0.9134210526315789, AUC 0.9793182015419006, avg_entr 0.028204752132296562, f1 0.9134210348129272
l4_test_time 0.33034753799438477
