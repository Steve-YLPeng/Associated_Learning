total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.81757640838623
Start Training
gc 0
Train Epoch0 Acc 0.6356333333333334 (76276/120000), AUC 0.8533115983009338
ep0_train_time 12.736111164093018
Test Epoch0 layer4 Acc 0.8997368421052632, AUC 0.9770262837409973, avg_entr 0.22154547274112701, f1 0.8997368216514587
ep0_l4_test_time 0.1651003360748291
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9171416666666666 (110057/120000), AUC 0.9812994599342346
ep1_train_time 13.483277082443237
Test Epoch1 layer4 Acc 0.916578947368421, AUC 0.9807088375091553, avg_entr 0.12347123771905899, f1 0.9165789484977722
ep1_l4_test_time 0.2000422477722168
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9273833333333333 (111286/120000), AUC 0.985680341720581
ep2_train_time 17.783793210983276
Test Epoch2 layer4 Acc 0.9205263157894736, AUC 0.9823103547096252, avg_entr 0.08212104439735413, f1 0.9205263257026672
ep2_l4_test_time 0.1701517105102539
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9334666666666667 (112016/120000), AUC 0.9879735708236694
ep3_train_time 13.801393032073975
Test Epoch3 layer4 Acc 0.9234210526315789, AUC 0.9829586744308472, avg_entr 0.05597938597202301, f1 0.9234210252761841
ep3_l4_test_time 0.20594525337219238
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9374666666666667 (112496/120000), AUC 0.989387035369873
ep4_train_time 15.359256744384766
Test Epoch4 layer4 Acc 0.9223684210526316, AUC 0.982721209526062, avg_entr 0.035393375903367996, f1 0.9223684072494507
ep4_l4_test_time 0.20125293731689453
gc 0
Train Epoch5 Acc 0.9402083333333333 (112825/120000), AUC 0.9898655414581299
ep5_train_time 15.389482498168945
Test Epoch5 layer4 Acc 0.9213157894736842, AUC 0.9811329245567322, avg_entr 0.028771478682756424, f1 0.9213157892227173
ep5_l4_test_time 0.19027066230773926
gc 0
Train Epoch6 Acc 0.942925 (113151/120000), AUC 0.9904904961585999
ep6_train_time 15.345596313476562
Test Epoch6 layer4 Acc 0.9234210526315789, AUC 0.9788092970848083, avg_entr 0.02522575855255127, f1 0.9234210252761841
ep6_l4_test_time 0.1942281723022461
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9455083333333333 (113461/120000), AUC 0.9913644790649414
ep7_train_time 15.610192060470581
Test Epoch7 layer4 Acc 0.9221052631578948, AUC 0.982072651386261, avg_entr 0.02431870438158512, f1 0.9221052527427673
ep7_l4_test_time 0.19390439987182617
gc 0
Train Epoch8 Acc 0.9470583333333333 (113647/120000), AUC 0.992266833782196
ep8_train_time 14.027995586395264
Test Epoch8 layer4 Acc 0.9213157894736842, AUC 0.9810717105865479, avg_entr 0.020276010036468506, f1 0.9213157892227173
ep8_l4_test_time 0.18106341361999512
gc 0
Train Epoch9 Acc 0.948475 (113817/120000), AUC 0.9927934408187866
ep9_train_time 10.958943128585815
Test Epoch9 layer4 Acc 0.9223684210526316, AUC 0.9793801307678223, avg_entr 0.019040321931242943, f1 0.9223684072494507
ep9_l4_test_time 0.16238641738891602
gc 0
Train Epoch10 Acc 0.9494666666666667 (113936/120000), AUC 0.9931015372276306
ep10_train_time 16.433499336242676
Test Epoch10 layer4 Acc 0.9205263157894736, AUC 0.9809610247612, avg_entr 0.01792672649025917, f1 0.9205263257026672
ep10_l4_test_time 0.24846982955932617
gc 0
Train Epoch11 Acc 0.95065 (114078/120000), AUC 0.9933477640151978
ep11_train_time 16.484410047531128
Test Epoch11 layer4 Acc 0.9202631578947369, AUC 0.9800037145614624, avg_entr 0.01745246909558773, f1 0.9202631711959839
ep11_l4_test_time 0.20061063766479492
gc 0
Train Epoch12 Acc 0.95185 (114222/120000), AUC 0.9937721490859985
ep12_train_time 15.49982500076294
Test Epoch12 layer4 Acc 0.9236842105263158, AUC 0.979954719543457, avg_entr 0.016974380239844322, f1 0.9236842393875122
ep12_l4_test_time 0.18521523475646973
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 12
gc 0
Train Epoch13 Acc 0.9527916666666667 (114335/120000), AUC 0.9938578009605408
ep13_train_time 15.184943675994873
Test Epoch13 layer4 Acc 0.9207894736842105, AUC 0.9809145331382751, avg_entr 0.015400008298456669, f1 0.9207894802093506
ep13_l4_test_time 0.2072005271911621
gc 0
Train Epoch14 Acc 0.9534416666666666 (114413/120000), AUC 0.9941112399101257
ep14_train_time 15.35242247581482
Test Epoch14 layer4 Acc 0.9184210526315789, AUC 0.9799057245254517, avg_entr 0.01513359509408474, f1 0.9184210896492004
ep14_l4_test_time 0.1841580867767334
gc 0
Train Epoch15 Acc 0.954225 (114507/120000), AUC 0.9941986799240112
ep15_train_time 15.383192777633667
Test Epoch15 layer4 Acc 0.9186842105263158, AUC 0.9799191951751709, avg_entr 0.01303198840469122, f1 0.918684184551239
ep15_l4_test_time 0.21050000190734863
gc 0
Train Epoch16 Acc 0.954425 (114531/120000), AUC 0.9944067001342773
ep16_train_time 15.110976696014404
Test Epoch16 layer4 Acc 0.916578947368421, AUC 0.9805633425712585, avg_entr 0.01488451473414898, f1 0.9165789484977722
ep16_l4_test_time 0.1837928295135498
gc 0
Train Epoch17 Acc 0.9551666666666667 (114620/120000), AUC 0.9944776892662048
ep17_train_time 12.33474612236023
Test Epoch17 layer4 Acc 0.9186842105263158, AUC 0.9789178371429443, avg_entr 0.01302496436983347, f1 0.918684184551239
ep17_l4_test_time 0.16241693496704102
gc 0
Train Epoch18 Acc 0.9558333333333333 (114700/120000), AUC 0.9946951866149902
ep18_train_time 12.613518238067627
Test Epoch18 layer4 Acc 0.92, AUC 0.9793952107429504, avg_entr 0.013614227063953876, f1 0.9200000166893005
ep18_l4_test_time 0.2257523536682129
gc 0
Train Epoch19 Acc 0.9566666666666667 (114800/120000), AUC 0.9948056936264038
ep19_train_time 17.36008048057556
Test Epoch19 layer4 Acc 0.9173684210526316, AUC 0.9792761206626892, avg_entr 0.012370854616165161, f1 0.9173683524131775
ep19_l4_test_time 0.19844889640808105
gc 0
Train Epoch20 Acc 0.9572583333333333 (114871/120000), AUC 0.9949024319648743
ep20_train_time 13.89445447921753
Test Epoch20 layer4 Acc 0.9178947368421052, AUC 0.9789603352546692, avg_entr 0.01398207526654005, f1 0.917894721031189
ep20_l4_test_time 0.2123708724975586
gc 0
Train Epoch21 Acc 0.9574666666666667 (114896/120000), AUC 0.9949530363082886
ep21_train_time 15.276010990142822
Test Epoch21 layer4 Acc 0.9189473684210526, AUC 0.9792553186416626, avg_entr 0.012949643656611443, f1 0.9189472794532776
ep21_l4_test_time 0.19749808311462402
gc 0
Train Epoch22 Acc 0.9577333333333333 (114928/120000), AUC 0.9950807094573975
ep22_train_time 15.368860244750977
Test Epoch22 layer4 Acc 0.9173684210526316, AUC 0.9793357849121094, avg_entr 0.012448464520275593, f1 0.9173683524131775
ep22_l4_test_time 0.20265722274780273
gc 0
Train Epoch23 Acc 0.958325 (114999/120000), AUC 0.9951132535934448
ep23_train_time 15.237624883651733
Test Epoch23 layer4 Acc 0.9178947368421052, AUC 0.9796055555343628, avg_entr 0.013639932498335838, f1 0.917894721031189
ep23_l4_test_time 0.1952965259552002
gc 0
Train Epoch24 Acc 0.9587416666666667 (115049/120000), AUC 0.9952195882797241
ep24_train_time 15.543551683425903
Test Epoch24 layer4 Acc 0.9168421052631579, AUC 0.9790080189704895, avg_entr 0.012459896504878998, f1 0.9168421030044556
ep24_l4_test_time 0.20624637603759766
gc 0
Train Epoch25 Acc 0.958975 (115077/120000), AUC 0.9952890872955322
ep25_train_time 14.853185892105103
Test Epoch25 layer4 Acc 0.9144736842105263, AUC 0.9794820547103882, avg_entr 0.012487013824284077, f1 0.9144737124443054
ep25_l4_test_time 0.18259811401367188
gc 0
Train Epoch26 Acc 0.9590083333333334 (115081/120000), AUC 0.995341420173645
ep26_train_time 11.95271348953247
Test Epoch26 layer4 Acc 0.9168421052631579, AUC 0.9791960716247559, avg_entr 0.012182093225419521, f1 0.9168421030044556
ep26_l4_test_time 0.16200923919677734
gc 0
Train Epoch27 Acc 0.95985 (115182/120000), AUC 0.9954228401184082
ep27_train_time 14.19140362739563
Test Epoch27 layer4 Acc 0.9144736842105263, AUC 0.9784007668495178, avg_entr 0.012430308386683464, f1 0.9144737124443054
ep27_l4_test_time 0.22896265983581543
gc 0
Train Epoch28 Acc 0.9595916666666666 (115151/120000), AUC 0.9955130815505981
ep28_train_time 17.089487314224243
Test Epoch28 layer4 Acc 0.9144736842105263, AUC 0.9786999821662903, avg_entr 0.011667926795780659, f1 0.9144737124443054
ep28_l4_test_time 0.215684175491333
gc 0
Train Epoch29 Acc 0.96005 (115206/120000), AUC 0.9954935908317566
ep29_train_time 15.338857889175415
Test Epoch29 layer4 Acc 0.9173684210526316, AUC 0.9787735939025879, avg_entr 0.013201801106333733, f1 0.9173683524131775
ep29_l4_test_time 0.2036428451538086
Best AUC tensor(0.9237) 12
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 453.399596452713
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt
Test layer0 Acc 0.9102631578947369, AUC 0.9800358414649963, avg_entr 0.052452605217695236, f1 0.910263180732727
l0_test_time 0.20669054985046387
Test layer1 Acc 0.9105263157894737, AUC 0.9798266887664795, avg_entr 0.05005333200097084, f1 0.9105263352394104
l1_test_time 0.18412208557128906
Test layer2 Acc 0.9113157894736842, AUC 0.9802265167236328, avg_entr 0.032145727425813675, f1 0.9113157987594604
l2_test_time 0.21564960479736328
Test layer3 Acc 0.9123684210526316, AUC 0.9783844947814941, avg_entr 0.022784151136875153, f1 0.9123684167861938
l3_test_time 0.2011408805847168
Test layer4 Acc 0.911578947368421, AUC 0.9782206416130066, avg_entr 0.020052529871463776, f1 0.9115789532661438
l4_test_time 0.2008373737335205
