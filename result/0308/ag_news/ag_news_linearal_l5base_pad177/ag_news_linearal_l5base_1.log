total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.64938187599182
Start Training
gc 0
Train Epoch0 Acc 0.6445333333333333 (77344/120000), AUC 0.8550784587860107
ep0_train_time 11.929507493972778
Test Epoch0 layer4 Acc 0.9007894736842105, AUC 0.9769112467765808, avg_entr 0.2262793630361557, f1 0.9007894396781921
ep0_l4_test_time 0.16409564018249512
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.915475 (109857/120000), AUC 0.9812039136886597
ep1_train_time 14.940972566604614
Test Epoch1 layer4 Acc 0.9171052631578948, AUC 0.9804664850234985, avg_entr 0.12343832105398178, f1 0.9171052575111389
ep1_l4_test_time 0.2193896770477295
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9266 (111192/120000), AUC 0.9857221841812134
ep2_train_time 17.081863164901733
Test Epoch2 layer4 Acc 0.9213157894736842, AUC 0.9823675155639648, avg_entr 0.08242672681808472, f1 0.9213157892227173
ep2_l4_test_time 0.19693446159362793
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.93255 (111906/120000), AUC 0.9880635142326355
ep3_train_time 15.377644062042236
Test Epoch3 layer4 Acc 0.9202631578947369, AUC 0.9832412004470825, avg_entr 0.05583367869257927, f1 0.9202631711959839
ep3_l4_test_time 0.19745516777038574
gc 0
Train Epoch4 Acc 0.9373333333333334 (112480/120000), AUC 0.9894942045211792
ep4_train_time 15.402127265930176
Test Epoch4 layer4 Acc 0.9228947368421052, AUC 0.9833386540412903, avg_entr 0.039127420634031296, f1 0.9228947162628174
ep4_l4_test_time 0.20616793632507324
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.940175 (112821/120000), AUC 0.9901351928710938
ep5_train_time 15.53888750076294
Test Epoch5 layer4 Acc 0.9213157894736842, AUC 0.982502818107605, avg_entr 0.029103586450219154, f1 0.9213157892227173
ep5_l4_test_time 0.1853351593017578
gc 0
Train Epoch6 Acc 0.94255 (113106/120000), AUC 0.9907838106155396
ep6_train_time 15.028657913208008
Test Epoch6 layer4 Acc 0.9226315789473685, AUC 0.9820614457130432, avg_entr 0.025923890992999077, f1 0.922631561756134
ep6_l4_test_time 0.17961764335632324
gc 0
Train Epoch7 Acc 0.9444916666666666 (113339/120000), AUC 0.9915666580200195
ep7_train_time 12.283380031585693
Test Epoch7 layer4 Acc 0.9234210526315789, AUC 0.9827637672424316, avg_entr 0.022750718519091606, f1 0.9234210252761841
ep7_l4_test_time 0.1618638038635254
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 7
gc 0
Train Epoch8 Acc 0.946725 (113607/120000), AUC 0.9922539591789246
ep8_train_time 13.464992046356201
Test Epoch8 layer4 Acc 0.9247368421052632, AUC 0.982201337814331, avg_entr 0.020839141681790352, f1 0.9247368574142456
ep8_l4_test_time 0.20534801483154297
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9478833333333333 (113746/120000), AUC 0.9927561283111572
ep9_train_time 17.78151512145996
Test Epoch9 layer4 Acc 0.9223684210526316, AUC 0.9816737771034241, avg_entr 0.01876053772866726, f1 0.9223684072494507
ep9_l4_test_time 0.21446967124938965
gc 0
Train Epoch10 Acc 0.94935 (113922/120000), AUC 0.9931051731109619
ep10_train_time 15.54617977142334
Test Epoch10 layer4 Acc 0.9236842105263158, AUC 0.982275664806366, avg_entr 0.01968972384929657, f1 0.9236842393875122
ep10_l4_test_time 0.21642160415649414
gc 0
Train Epoch11 Acc 0.9501916666666667 (114023/120000), AUC 0.9934885501861572
ep11_train_time 15.540205001831055
Test Epoch11 layer4 Acc 0.9234210526315789, AUC 0.9816904664039612, avg_entr 0.017088495194911957, f1 0.9234210252761841
ep11_l4_test_time 0.1938328742980957
gc 0
Train Epoch12 Acc 0.951725 (114207/120000), AUC 0.993681788444519
ep12_train_time 15.359622478485107
Test Epoch12 layer4 Acc 0.9226315789473685, AUC 0.9810091257095337, avg_entr 0.017644891515374184, f1 0.922631561756134
ep12_l4_test_time 0.21252202987670898
gc 0
Train Epoch13 Acc 0.95245 (114294/120000), AUC 0.993923544883728
ep13_train_time 15.580773115158081
Test Epoch13 layer4 Acc 0.9205263157894736, AUC 0.9813207983970642, avg_entr 0.015044735744595528, f1 0.9205263257026672
ep13_l4_test_time 0.20466876029968262
gc 0
Train Epoch14 Acc 0.9534416666666666 (114413/120000), AUC 0.9940057992935181
ep14_train_time 15.227320432662964
Test Epoch14 layer4 Acc 0.9213157894736842, AUC 0.9814130067825317, avg_entr 0.0164779182523489, f1 0.9213157892227173
ep14_l4_test_time 0.1814568042755127
gc 0
Train Epoch15 Acc 0.9539333333333333 (114472/120000), AUC 0.9942283630371094
ep15_train_time 12.652433395385742
Test Epoch15 layer4 Acc 0.9192105263157895, AUC 0.9800412654876709, avg_entr 0.01573825627565384, f1 0.9192105531692505
ep15_l4_test_time 0.1617734432220459
gc 0
Train Epoch16 Acc 0.95495 (114594/120000), AUC 0.9943095445632935
ep16_train_time 12.54897665977478
Test Epoch16 layer4 Acc 0.9178947368421052, AUC 0.9793576002120972, avg_entr 0.01341293752193451, f1 0.917894721031189
ep16_l4_test_time 0.2452831268310547
gc 0
Train Epoch17 Acc 0.9553083333333333 (114637/120000), AUC 0.9944393634796143
ep17_train_time 17.593432903289795
Test Epoch17 layer4 Acc 0.9176315789473685, AUC 0.9797171950340271, avg_entr 0.014355114661157131, f1 0.9176315665245056
ep17_l4_test_time 0.25018787384033203
gc 0
Train Epoch18 Acc 0.95605 (114726/120000), AUC 0.9945788383483887
ep18_train_time 14.075747728347778
Test Epoch18 layer4 Acc 0.9205263157894736, AUC 0.9792985916137695, avg_entr 0.014119267463684082, f1 0.9205263257026672
ep18_l4_test_time 0.19411349296569824
gc 0
Train Epoch19 Acc 0.9563833333333334 (114766/120000), AUC 0.9947577714920044
ep19_train_time 15.609581232070923
Test Epoch19 layer4 Acc 0.9173684210526316, AUC 0.9795214533805847, avg_entr 0.013275912031531334, f1 0.9173683524131775
ep19_l4_test_time 0.19350862503051758
gc 0
Train Epoch20 Acc 0.9566833333333333 (114802/120000), AUC 0.9948769807815552
ep20_train_time 15.434046506881714
Test Epoch20 layer4 Acc 0.9189473684210526, AUC 0.9792357683181763, avg_entr 0.012482435442507267, f1 0.9189472794532776
ep20_l4_test_time 0.198441743850708
gc 0
Train Epoch21 Acc 0.9572916666666667 (114875/120000), AUC 0.9949307441711426
ep21_train_time 15.469987154006958
Test Epoch21 layer4 Acc 0.915, AUC 0.9783782958984375, avg_entr 0.012625153176486492, f1 0.9150000214576721
ep21_l4_test_time 0.18665862083435059
gc 0
Train Epoch22 Acc 0.957775 (114933/120000), AUC 0.9950340390205383
ep22_train_time 15.59994888305664
Test Epoch22 layer4 Acc 0.9205263157894736, AUC 0.9789364337921143, avg_entr 0.012613234110176563, f1 0.9205263257026672
ep22_l4_test_time 0.20143866539001465
gc 0
Train Epoch23 Acc 0.95815 (114978/120000), AUC 0.9950693249702454
ep23_train_time 14.361266136169434
Test Epoch23 layer4 Acc 0.9178947368421052, AUC 0.9787089824676514, avg_entr 0.011750195175409317, f1 0.917894721031189
ep23_l4_test_time 0.17790818214416504
gc 0
Train Epoch24 Acc 0.958425 (115011/120000), AUC 0.9951419234275818
ep24_train_time 10.664049863815308
Test Epoch24 layer4 Acc 0.915, AUC 0.9788182973861694, avg_entr 0.012561547569930553, f1 0.9150000214576721
ep24_l4_test_time 0.1621570587158203
gc 0
Train Epoch25 Acc 0.9587083333333334 (115045/120000), AUC 0.9953012466430664
ep25_train_time 16.61319851875305
Test Epoch25 layer4 Acc 0.9197368421052632, AUC 0.9792507290840149, avg_entr 0.013073766604065895, f1 0.9197368621826172
ep25_l4_test_time 0.2659902572631836
gc 0
Train Epoch26 Acc 0.9593 (115116/120000), AUC 0.9952576160430908
ep26_train_time 16.856432676315308
Test Epoch26 layer4 Acc 0.9184210526315789, AUC 0.978398859500885, avg_entr 0.011903873644769192, f1 0.9184210896492004
ep26_l4_test_time 0.21856474876403809
gc 0
Train Epoch27 Acc 0.9600166666666666 (115202/120000), AUC 0.9953691959381104
ep27_train_time 15.43485689163208
Test Epoch27 layer4 Acc 0.9155263157894736, AUC 0.979029655456543, avg_entr 0.012376423925161362, f1 0.9155263304710388
ep27_l4_test_time 0.19539284706115723
gc 0
Train Epoch28 Acc 0.9596416666666666 (115157/120000), AUC 0.9954262971878052
ep28_train_time 15.414113521575928
Test Epoch28 layer4 Acc 0.9144736842105263, AUC 0.9787331819534302, avg_entr 0.01201462373137474, f1 0.9144737124443054
ep28_l4_test_time 0.18763089179992676
gc 0
Train Epoch29 Acc 0.9599416666666667 (115193/120000), AUC 0.9955424070358276
ep29_train_time 15.584006309509277
Test Epoch29 layer4 Acc 0.9192105263157895, AUC 0.9781298637390137, avg_entr 0.012342296540737152, f1 0.9192105531692505
ep29_l4_test_time 0.20185446739196777
Best AUC tensor(0.9247) 8
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 458.2252905368805
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt
Test layer0 Acc 0.9136842105263158, AUC 0.9807817935943604, avg_entr 0.06210346519947052, f1 0.9136841893196106
l0_test_time 0.18816590309143066
Test layer1 Acc 0.9118421052631579, AUC 0.9802935123443604, avg_entr 0.06111820414662361, f1 0.9118421077728271
l1_test_time 0.1948397159576416
Test layer2 Acc 0.9128947368421053, AUC 0.9815574884414673, avg_entr 0.04580429196357727, f1 0.9128947257995605
l2_test_time 0.20531845092773438
Test layer3 Acc 0.9131578947368421, AUC 0.9804878830909729, avg_entr 0.02841581404209137, f1 0.9131578803062439
l3_test_time 0.1980903148651123
Test layer4 Acc 0.9134210526315789, AUC 0.9800432324409485, avg_entr 0.024314792826771736, f1 0.9134210348129272
l4_test_time 0.19927525520324707
