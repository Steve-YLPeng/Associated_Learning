total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 18.048259735107422
Start Training
gc 0
Train Epoch0 Acc 0.64535 (77442/120000), AUC 0.8615050315856934
ep0_train_time 10.510455846786499
Test Epoch0 layer4 Acc 0.9031578947368422, AUC 0.9771914482116699, avg_entr 0.21951206028461456, f1 0.9031578898429871
ep0_l4_test_time 0.1641397476196289
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.916725 (110007/120000), AUC 0.9816675186157227
ep1_train_time 10.062025308609009
Test Epoch1 layer4 Acc 0.9142105263157895, AUC 0.9809201955795288, avg_entr 0.12086906284093857, f1 0.9142104983329773
ep1_l4_test_time 0.1627647876739502
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9270083333333333 (111241/120000), AUC 0.985873818397522
ep2_train_time 10.115139722824097
Test Epoch2 layer4 Acc 0.9184210526315789, AUC 0.9825239181518555, avg_entr 0.08208319544792175, f1 0.9184210896492004
ep2_l4_test_time 0.1627964973449707
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9331666666666667 (111980/120000), AUC 0.9881738424301147
ep3_train_time 10.0678551197052
Test Epoch3 layer4 Acc 0.9194736842105263, AUC 0.9834108352661133, avg_entr 0.05694277212023735, f1 0.9194737076759338
ep3_l4_test_time 0.16312837600708008
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9375 (112500/120000), AUC 0.9895360469818115
ep4_train_time 10.050942420959473
Test Epoch4 layer4 Acc 0.9218421052631579, AUC 0.982698380947113, avg_entr 0.03776947781443596, f1 0.921842098236084
ep4_l4_test_time 0.16318225860595703
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9405666666666667 (112868/120000), AUC 0.9900828003883362
ep5_train_time 10.06271505355835
Test Epoch5 layer4 Acc 0.9226315789473685, AUC 0.9822723865509033, avg_entr 0.02864379622042179, f1 0.922631561756134
ep5_l4_test_time 0.16278815269470215
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9428083333333334 (113137/120000), AUC 0.9908268451690674
ep6_train_time 10.20039176940918
Test Epoch6 layer4 Acc 0.9244736842105263, AUC 0.981287956237793, avg_entr 0.02598809450864792, f1 0.9244737029075623
ep6_l4_test_time 0.16336441040039062
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 6
gc 0
Train Epoch7 Acc 0.9449666666666666 (113396/120000), AUC 0.9916503429412842
ep7_train_time 10.081107139587402
Test Epoch7 layer4 Acc 0.9221052631578948, AUC 0.9822071194648743, avg_entr 0.022517668083310127, f1 0.9221052527427673
ep7_l4_test_time 0.16232943534851074
gc 0
Train Epoch8 Acc 0.947075 (113649/120000), AUC 0.9924260377883911
ep8_train_time 10.0938081741333
Test Epoch8 layer4 Acc 0.925, AUC 0.9822670221328735, avg_entr 0.020858142524957657, f1 0.925000011920929
ep8_l4_test_time 0.1629478931427002
Save ckpt to ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt  ,ep 8
gc 0
Train Epoch9 Acc 0.9484666666666667 (113816/120000), AUC 0.9928650259971619
ep9_train_time 10.132230758666992
Test Epoch9 layer4 Acc 0.9226315789473685, AUC 0.9815837740898132, avg_entr 0.01829671300947666, f1 0.922631561756134
ep9_l4_test_time 0.1627194881439209
gc 0
Train Epoch10 Acc 0.9495583333333333 (113947/120000), AUC 0.9932270646095276
ep10_train_time 10.072726011276245
Test Epoch10 layer4 Acc 0.9228947368421052, AUC 0.9821792244911194, avg_entr 0.01723266765475273, f1 0.9228947162628174
ep10_l4_test_time 0.16251134872436523
gc 0
Train Epoch11 Acc 0.9507 (114084/120000), AUC 0.9933491349220276
ep11_train_time 10.214380502700806
Test Epoch11 layer4 Acc 0.9231578947368421, AUC 0.9814572930335999, avg_entr 0.017227208241820335, f1 0.9231578707695007
ep11_l4_test_time 0.16223502159118652
gc 0
Train Epoch12 Acc 0.951725 (114207/120000), AUC 0.9936948418617249
ep12_train_time 10.10898208618164
Test Epoch12 layer4 Acc 0.9228947368421052, AUC 0.9818556904792786, avg_entr 0.016199128702282906, f1 0.9228947162628174
ep12_l4_test_time 0.1641998291015625
gc 0
Train Epoch13 Acc 0.952425 (114291/120000), AUC 0.9938514232635498
ep13_train_time 10.118545532226562
Test Epoch13 layer4 Acc 0.9223684210526316, AUC 0.9810929894447327, avg_entr 0.015478473156690598, f1 0.9223684072494507
ep13_l4_test_time 0.16244244575500488
gc 0
Train Epoch14 Acc 0.9536083333333333 (114433/120000), AUC 0.9940032958984375
ep14_train_time 10.075337648391724
Test Epoch14 layer4 Acc 0.9218421052631579, AUC 0.9813647270202637, avg_entr 0.015144750475883484, f1 0.921842098236084
ep14_l4_test_time 0.16295361518859863
gc 0
Train Epoch15 Acc 0.9539583333333334 (114475/120000), AUC 0.9940371513366699
ep15_train_time 10.06864881515503
Test Epoch15 layer4 Acc 0.92, AUC 0.9803816080093384, avg_entr 0.013247372582554817, f1 0.9200000166893005
ep15_l4_test_time 0.16359162330627441
gc 0
Train Epoch16 Acc 0.9547 (114564/120000), AUC 0.9942322969436646
ep16_train_time 10.136162519454956
Test Epoch16 layer4 Acc 0.9207894736842105, AUC 0.9797012209892273, avg_entr 0.013850443065166473, f1 0.9207894802093506
ep16_l4_test_time 0.1628437042236328
gc 0
Train Epoch17 Acc 0.9553916666666666 (114647/120000), AUC 0.9944119453430176
ep17_train_time 10.115429162979126
Test Epoch17 layer4 Acc 0.9173684210526316, AUC 0.9790424108505249, avg_entr 0.013410196639597416, f1 0.9173683524131775
ep17_l4_test_time 0.16326260566711426
gc 0
Train Epoch18 Acc 0.9558083333333334 (114697/120000), AUC 0.9944334626197815
ep18_train_time 10.144018173217773
Test Epoch18 layer4 Acc 0.9192105263157895, AUC 0.9794713258743286, avg_entr 0.013853137381374836, f1 0.9192105531692505
ep18_l4_test_time 0.16346359252929688
gc 0
Train Epoch19 Acc 0.956325 (114759/120000), AUC 0.994651198387146
ep19_train_time 10.199039220809937
Test Epoch19 layer4 Acc 0.9176315789473685, AUC 0.9791577458381653, avg_entr 0.01225725281983614, f1 0.9176315665245056
ep19_l4_test_time 0.16242647171020508
gc 0
Train Epoch20 Acc 0.9567833333333333 (114814/120000), AUC 0.99470454454422
ep20_train_time 10.133627653121948
Test Epoch20 layer4 Acc 0.9157894736842105, AUC 0.978218138217926, avg_entr 0.011867125518620014, f1 0.9157894849777222
ep20_l4_test_time 0.16199684143066406
gc 0
Train Epoch21 Acc 0.9571833333333334 (114862/120000), AUC 0.9947569370269775
ep21_train_time 10.256749391555786
Test Epoch21 layer4 Acc 0.9176315789473685, AUC 0.979101300239563, avg_entr 0.013254419900476933, f1 0.9176315665245056
ep21_l4_test_time 0.16160082817077637
gc 0
Train Epoch22 Acc 0.9572 (114864/120000), AUC 0.9948450326919556
ep22_train_time 10.04073977470398
Test Epoch22 layer4 Acc 0.9178947368421052, AUC 0.9778995513916016, avg_entr 0.012850464321672916, f1 0.917894721031189
ep22_l4_test_time 0.16297626495361328
gc 0
Train Epoch23 Acc 0.957975 (114957/120000), AUC 0.994925856590271
ep23_train_time 10.203582286834717
Test Epoch23 layer4 Acc 0.9178947368421052, AUC 0.9779751300811768, avg_entr 0.013090284541249275, f1 0.917894721031189
ep23_l4_test_time 0.1627507209777832
gc 0
Train Epoch24 Acc 0.9583916666666666 (115007/120000), AUC 0.9950423240661621
ep24_train_time 10.138479471206665
Test Epoch24 layer4 Acc 0.9157894736842105, AUC 0.9782384037971497, avg_entr 0.012187670916318893, f1 0.9157894849777222
ep24_l4_test_time 0.16280293464660645
gc 0
Train Epoch25 Acc 0.9588 (115056/120000), AUC 0.995060920715332
ep25_train_time 10.11662220954895
Test Epoch25 layer4 Acc 0.9168421052631579, AUC 0.9777238368988037, avg_entr 0.012071749195456505, f1 0.9168421030044556
ep25_l4_test_time 0.16156697273254395
gc 0
Train Epoch26 Acc 0.9588416666666667 (115061/120000), AUC 0.9951574802398682
ep26_train_time 10.174531936645508
Test Epoch26 layer4 Acc 0.9168421052631579, AUC 0.9779144525527954, avg_entr 0.011578724719583988, f1 0.9168421030044556
ep26_l4_test_time 0.16306686401367188
gc 0
Train Epoch27 Acc 0.9590416666666667 (115085/120000), AUC 0.9951772689819336
ep27_train_time 10.066228866577148
Test Epoch27 layer4 Acc 0.9173684210526316, AUC 0.9779301881790161, avg_entr 0.011965428479015827, f1 0.9173683524131775
ep27_l4_test_time 0.16309261322021484
gc 0
Train Epoch28 Acc 0.9594333333333334 (115132/120000), AUC 0.9952831268310547
ep28_train_time 10.140496253967285
Test Epoch28 layer4 Acc 0.9144736842105263, AUC 0.9775629043579102, avg_entr 0.012902121059596539, f1 0.9144737124443054
ep28_l4_test_time 0.1625828742980957
gc 0
Train Epoch29 Acc 0.9599083333333334 (115189/120000), AUC 0.9952526092529297
ep29_train_time 10.115697622299194
Test Epoch29 layer4 Acc 0.9163157894736842, AUC 0.977209210395813, avg_entr 0.011684071272611618, f1 0.9163157939910889
ep29_l4_test_time 0.16331243515014648
Best AUC tensor(0.9250) 8
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 310.7884294986725
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5base_pad177//ag_news_linearal_l5.pt
Test layer0 Acc 0.9139473684210526, AUC 0.9808030128479004, avg_entr 0.0622498095035553, f1 0.913947343826294
l0_test_time 0.15756964683532715
Test layer1 Acc 0.9147368421052632, AUC 0.9804966449737549, avg_entr 0.060962434858083725, f1 0.9147368669509888
l1_test_time 0.1576244831085205
Test layer2 Acc 0.9131578947368421, AUC 0.9814732670783997, avg_entr 0.04632262885570526, f1 0.9131578803062439
l2_test_time 0.1585984230041504
Test layer3 Acc 0.9131578947368421, AUC 0.9804248213768005, avg_entr 0.028035921975970268, f1 0.9131578803062439
l3_test_time 0.16060924530029297
Test layer4 Acc 0.9126315789473685, AUC 0.9794994592666626, avg_entr 0.022780083119869232, f1 0.9126315712928772
l4_test_time 0.16082048416137695
