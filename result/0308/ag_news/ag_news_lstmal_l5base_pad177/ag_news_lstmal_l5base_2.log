total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 19.645698070526123
Start Training
gc 0
Train Epoch0 Acc 0.71885 (86262/120000), AUC 0.9089764356613159
ep0_train_time 113.33967137336731
Test Epoch0 layer4 Acc 0.9023684210526316, AUC 0.9794058799743652, avg_entr 0.11612061411142349, f1 0.902368426322937
ep0_l4_test_time 1.0456593036651611
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.919875 (110385/120000), AUC 0.9810997247695923
ep1_train_time 119.0434627532959
Test Epoch1 layer4 Acc 0.9173684210526316, AUC 0.9840145111083984, avg_entr 0.05071720853447914, f1 0.9173683524131775
ep1_l4_test_time 0.9255986213684082
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9318 (111816/120000), AUC 0.9864431023597717
ep2_train_time 115.41160202026367
Test Epoch2 layer4 Acc 0.9197368421052632, AUC 0.9841917753219604, avg_entr 0.03602158650755882, f1 0.9197368621826172
ep2_l4_test_time 1.044198989868164
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9387333333333333 (112648/120000), AUC 0.989047646522522
ep3_train_time 95.05559229850769
Test Epoch3 layer4 Acc 0.92, AUC 0.9840273261070251, avg_entr 0.028609827160835266, f1 0.9200000166893005
ep3_l4_test_time 0.7826492786407471
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9436666666666667 (113240/120000), AUC 0.9907927513122559
ep4_train_time 89.19882202148438
Test Epoch4 layer4 Acc 0.92, AUC 0.9837355613708496, avg_entr 0.02199183776974678, f1 0.9200000166893005
ep4_l4_test_time 0.779395341873169
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9475 (113700/120000), AUC 0.9916248321533203
ep5_train_time 98.15493893623352
Test Epoch5 layer4 Acc 0.9181578947368421, AUC 0.9831486940383911, avg_entr 0.02047548070549965, f1 0.9181578755378723
ep5_l4_test_time 0.8730883598327637
gc 0
Train Epoch6 Acc 0.9510416666666667 (114125/120000), AUC 0.9922738075256348
ep6_train_time 118.45015621185303
Test Epoch6 layer4 Acc 0.9155263157894736, AUC 0.9827598929405212, avg_entr 0.02220545895397663, f1 0.9155263304710388
ep6_l4_test_time 0.9036946296691895
gc 0
Train Epoch7 Acc 0.953425 (114411/120000), AUC 0.993057131767273
ep7_train_time 114.39623975753784
Test Epoch7 layer4 Acc 0.9173684210526316, AUC 0.9824357628822327, avg_entr 0.018937475979328156, f1 0.9173683524131775
ep7_l4_test_time 1.0733239650726318
gc 0
Train Epoch8 Acc 0.9560166666666666 (114722/120000), AUC 0.993320882320404
ep8_train_time 113.43669414520264
Test Epoch8 layer4 Acc 0.9178947368421052, AUC 0.981859028339386, avg_entr 0.017718441784381866, f1 0.917894721031189
ep8_l4_test_time 1.0744524002075195
gc 0
Train Epoch9 Acc 0.9583416666666666 (115001/120000), AUC 0.9935203790664673
ep9_train_time 116.55565667152405
Test Epoch9 layer4 Acc 0.916578947368421, AUC 0.9805750846862793, avg_entr 0.015138010494410992, f1 0.9165789484977722
ep9_l4_test_time 0.8782742023468018
gc 0
Train Epoch10 Acc 0.9603333333333334 (115240/120000), AUC 0.9938944578170776
ep10_train_time 120.22271275520325
Test Epoch10 layer4 Acc 0.9186842105263158, AUC 0.9794986248016357, avg_entr 0.012633121572434902, f1 0.918684184551239
ep10_l4_test_time 1.0540797710418701
gc 0
Train Epoch11 Acc 0.9624083333333333 (115489/120000), AUC 0.9942017793655396
ep11_train_time 111.80080056190491
Test Epoch11 layer4 Acc 0.9160526315789473, AUC 0.9807640314102173, avg_entr 0.01326200645416975, f1 0.9160526394844055
ep11_l4_test_time 1.0933399200439453
gc 0
Train Epoch12 Acc 0.9641416666666667 (115697/120000), AUC 0.9946286082267761
ep12_train_time 113.49036407470703
Test Epoch12 layer4 Acc 0.9184210526315789, AUC 0.9790271520614624, avg_entr 0.011915482580661774, f1 0.9184210896492004
ep12_l4_test_time 0.8447415828704834
gc 0
Train Epoch13 Acc 0.9661166666666666 (115934/120000), AUC 0.9947842359542847
ep13_train_time 122.2072434425354
Test Epoch13 layer4 Acc 0.9155263157894736, AUC 0.9780868291854858, avg_entr 0.01199890673160553, f1 0.9155263304710388
ep13_l4_test_time 0.9247763156890869
gc 0
Train Epoch14 Acc 0.967975 (116157/120000), AUC 0.9951266646385193
ep14_train_time 114.62978744506836
Test Epoch14 layer4 Acc 0.9136842105263158, AUC 0.9778805375099182, avg_entr 0.010317896492779255, f1 0.9136841893196106
ep14_l4_test_time 1.0504379272460938
gc 0
Train Epoch15 Acc 0.9696583333333333 (116359/120000), AUC 0.9951624870300293
ep15_train_time 113.32896161079407
Test Epoch15 layer4 Acc 0.9136842105263158, AUC 0.9774318337440491, avg_entr 0.008366324007511139, f1 0.9136841893196106
ep15_l4_test_time 1.0270500183105469
gc 0
Train Epoch16 Acc 0.9715 (116580/120000), AUC 0.9952362775802612
ep16_train_time 89.25645780563354
Test Epoch16 layer4 Acc 0.9118421052631579, AUC 0.9747496843338013, avg_entr 0.007894575595855713, f1 0.9118421077728271
ep16_l4_test_time 0.784386157989502
gc 0
Train Epoch17 Acc 0.9730833333333333 (116770/120000), AUC 0.9954332113265991
ep17_train_time 89.27728605270386
Test Epoch17 layer4 Acc 0.9110526315789473, AUC 0.9737191796302795, avg_entr 0.00823232252150774, f1 0.9110526442527771
ep17_l4_test_time 0.7743847370147705
gc 0
Train Epoch18 Acc 0.97485 (116982/120000), AUC 0.9954510927200317
ep18_train_time 89.30257368087769
Test Epoch18 layer4 Acc 0.9110526315789473, AUC 0.9710487127304077, avg_entr 0.007643912918865681, f1 0.9110526442527771
ep18_l4_test_time 0.7756772041320801
gc 0
Train Epoch19 Acc 0.9765 (117180/120000), AUC 0.9956285357475281
ep19_train_time 89.35285329818726
Test Epoch19 layer4 Acc 0.908157894736842, AUC 0.9719149470329285, avg_entr 0.00722524942830205, f1 0.9081578850746155
ep19_l4_test_time 0.7815747261047363
gc 0
Train Epoch20 Acc 0.9779 (117348/120000), AUC 0.995776891708374
ep20_train_time 89.25898122787476
Test Epoch20 layer4 Acc 0.905, AUC 0.9734220504760742, avg_entr 0.006954014301300049, f1 0.9049999117851257
ep20_l4_test_time 0.7822394371032715
gc 0
Train Epoch21 Acc 0.9794833333333334 (117538/120000), AUC 0.9960211515426636
ep21_train_time 89.33653140068054
Test Epoch21 layer4 Acc 0.9055263157894737, AUC 0.9712526202201843, avg_entr 0.0062360805459320545, f1 0.905526340007782
ep21_l4_test_time 0.7826056480407715
gc 0
Train Epoch22 Acc 0.9808416666666666 (117701/120000), AUC 0.9959967136383057
ep22_train_time 97.78511142730713
Test Epoch22 layer4 Acc 0.9044736842105263, AUC 0.9705542922019958, avg_entr 0.00764557346701622, f1 0.9044736623764038
ep22_l4_test_time 1.0912423133850098
gc 0
Train Epoch23 Acc 0.9820166666666666 (117842/120000), AUC 0.9961174726486206
ep23_train_time 113.76969075202942
Test Epoch23 layer4 Acc 0.9078947368421053, AUC 0.9697550535202026, avg_entr 0.005507091525942087, f1 0.9078947901725769
ep23_l4_test_time 1.077613115310669
gc 0
Train Epoch24 Acc 0.98295 (117954/120000), AUC 0.9962199330329895
ep24_train_time 112.46252870559692
Test Epoch24 layer4 Acc 0.9086842105263158, AUC 0.9690342545509338, avg_entr 0.004824644420295954, f1 0.9086841940879822
ep24_l4_test_time 1.0775954723358154
gc 0
Train Epoch25 Acc 0.9837833333333333 (118054/120000), AUC 0.996260404586792
ep25_train_time 115.57654333114624
Test Epoch25 layer4 Acc 0.9084210526315789, AUC 0.9691349267959595, avg_entr 0.006433507893234491, f1 0.9084210395812988
ep25_l4_test_time 0.8613739013671875
gc 0
Train Epoch26 Acc 0.98485 (118182/120000), AUC 0.9963552951812744
ep26_train_time 122.12118339538574
Test Epoch26 layer4 Acc 0.9068421052631579, AUC 0.9678947925567627, avg_entr 0.005224056076258421, f1 0.9068421125411987
ep26_l4_test_time 0.7934379577636719
gc 0
Train Epoch27 Acc 0.986025 (118323/120000), AUC 0.99643474817276
ep27_train_time 113.46687602996826
Test Epoch27 layer4 Acc 0.9055263157894737, AUC 0.9631524085998535, avg_entr 0.0038520318921655416, f1 0.905526340007782
ep27_l4_test_time 1.1043481826782227
gc 0
Train Epoch28 Acc 0.98645 (118374/120000), AUC 0.9965372085571289
ep28_train_time 113.44193959236145
Test Epoch28 layer4 Acc 0.908157894736842, AUC 0.9676751494407654, avg_entr 0.004313613288104534, f1 0.9081578850746155
ep28_l4_test_time 1.0745511054992676
gc 0
Train Epoch29 Acc 0.9870166666666667 (118442/120000), AUC 0.9966561198234558
ep29_train_time 117.05968117713928
Test Epoch29 layer4 Acc 0.9044736842105263, AUC 0.9639194011688232, avg_entr 0.004864248912781477, f1 0.9044736623764038
ep29_l4_test_time 0.8115882873535156
Best AUC tensor(0.9200) 4
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 3260.398191690445
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt
Test layer0 Acc 0.9144736842105263, AUC 0.9805635213851929, avg_entr 0.08576453477144241, f1 0.9144737124443054
l0_test_time 0.20260286331176758
Test layer1 Acc 0.9097368421052632, AUC 0.982545018196106, avg_entr 0.029575547203421593, f1 0.9097368717193604
l1_test_time 0.367218017578125
Test layer2 Acc 0.9105263157894737, AUC 0.9828900098800659, avg_entr 0.02707527205348015, f1 0.9105263352394104
l2_test_time 0.5367739200592041
Test layer3 Acc 0.9089473684210526, AUC 0.9820007085800171, avg_entr 0.026520762592554092, f1 0.9089473485946655
l3_test_time 0.7205839157104492
Test layer4 Acc 0.9094736842105263, AUC 0.9820231199264526, avg_entr 0.028029125183820724, f1 0.9094736576080322
l4_test_time 0.9070718288421631
