total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 18.62523078918457
Start Training
gc 0
Train Epoch0 Acc 0.7242333333333333 (86908/120000), AUC 0.9089447259902954
ep0_train_time 89.1374158859253
Test Epoch0 layer4 Acc 0.9034210526315789, AUC 0.9812645316123962, avg_entr 0.10788232088088989, f1 0.9034210443496704
ep0_l4_test_time 0.7860531806945801
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9202916666666666 (110435/120000), AUC 0.9820865392684937
ep1_train_time 89.1078085899353
Test Epoch1 layer4 Acc 0.9178947368421052, AUC 0.9823828935623169, avg_entr 0.05060566961765289, f1 0.917894721031189
ep1_l4_test_time 0.7816510200500488
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9321916666666666 (111863/120000), AUC 0.9871171116828918
ep2_train_time 89.81997919082642
Test Epoch2 layer4 Acc 0.9247368421052632, AUC 0.9848086833953857, avg_entr 0.03690541163086891, f1 0.9247368574142456
ep2_l4_test_time 0.7894408702850342
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9394833333333333 (112738/120000), AUC 0.9892524480819702
ep3_train_time 89.6672911643982
Test Epoch3 layer4 Acc 0.9213157894736842, AUC 0.9845775365829468, avg_entr 0.026849549263715744, f1 0.9213157892227173
ep3_l4_test_time 0.7872722148895264
gc 0
Train Epoch4 Acc 0.9446583333333334 (113359/120000), AUC 0.9908174276351929
ep4_train_time 89.65043187141418
Test Epoch4 layer4 Acc 0.9197368421052632, AUC 0.9842806458473206, avg_entr 0.022555449977517128, f1 0.9197368621826172
ep4_l4_test_time 0.7823576927185059
gc 0
Train Epoch5 Acc 0.9483083333333333 (113797/120000), AUC 0.9920482039451599
ep5_train_time 89.55537223815918
Test Epoch5 layer4 Acc 0.9205263157894736, AUC 0.9837345480918884, avg_entr 0.019753746688365936, f1 0.9205263257026672
ep5_l4_test_time 0.7948498725891113
gc 0
Train Epoch6 Acc 0.9517083333333334 (114205/120000), AUC 0.9928302764892578
ep6_train_time 89.53312349319458
Test Epoch6 layer4 Acc 0.9189473684210526, AUC 0.9840117692947388, avg_entr 0.017992768436670303, f1 0.9189472794532776
ep6_l4_test_time 0.7816832065582275
gc 0
Train Epoch7 Acc 0.9543833333333334 (114526/120000), AUC 0.9936176538467407
ep7_train_time 89.60824513435364
Test Epoch7 layer4 Acc 0.9157894736842105, AUC 0.9836362600326538, avg_entr 0.01597432605922222, f1 0.9157894849777222
ep7_l4_test_time 0.7868664264678955
gc 0
Train Epoch8 Acc 0.9571333333333333 (114856/120000), AUC 0.994085431098938
ep8_train_time 89.48122358322144
Test Epoch8 layer4 Acc 0.9186842105263158, AUC 0.9835292100906372, avg_entr 0.016514884307980537, f1 0.918684184551239
ep8_l4_test_time 0.7880592346191406
gc 0
Train Epoch9 Acc 0.9588083333333334 (115057/120000), AUC 0.9944226741790771
ep9_train_time 89.52164912223816
Test Epoch9 layer4 Acc 0.9202631578947369, AUC 0.9827085137367249, avg_entr 0.015413603745400906, f1 0.9202631711959839
ep9_l4_test_time 0.7816052436828613
gc 0
Train Epoch10 Acc 0.9611 (115332/120000), AUC 0.9947419166564941
ep10_train_time 89.52238917350769
Test Epoch10 layer4 Acc 0.915, AUC 0.9808923602104187, avg_entr 0.01322253979742527, f1 0.9150000214576721
ep10_l4_test_time 0.7902793884277344
gc 0
Train Epoch11 Acc 0.9627916666666667 (115535/120000), AUC 0.9949936270713806
ep11_train_time 89.62548804283142
Test Epoch11 layer4 Acc 0.9144736842105263, AUC 0.9816291332244873, avg_entr 0.013918714597821236, f1 0.9144737124443054
ep11_l4_test_time 0.7798831462860107
gc 0
Train Epoch12 Acc 0.9644583333333333 (115735/120000), AUC 0.9952356219291687
ep12_train_time 89.54091167449951
Test Epoch12 layer4 Acc 0.9147368421052632, AUC 0.9821158051490784, avg_entr 0.012160489335656166, f1 0.9147368669509888
ep12_l4_test_time 0.788597583770752
gc 0
Train Epoch13 Acc 0.9666333333333333 (115996/120000), AUC 0.9954978227615356
ep13_train_time 89.5128128528595
Test Epoch13 layer4 Acc 0.9142105263157895, AUC 0.980502188205719, avg_entr 0.011692341417074203, f1 0.9142104983329773
ep13_l4_test_time 0.7869312763214111
gc 0
Train Epoch14 Acc 0.9681166666666666 (116174/120000), AUC 0.9955589771270752
ep14_train_time 89.6754801273346
Test Epoch14 layer4 Acc 0.9134210526315789, AUC 0.981131911277771, avg_entr 0.010353904217481613, f1 0.9134210348129272
ep14_l4_test_time 0.78499436378479
gc 0
Train Epoch15 Acc 0.969775 (116373/120000), AUC 0.995769202709198
ep15_train_time 89.73602938652039
Test Epoch15 layer4 Acc 0.9128947368421053, AUC 0.9805970191955566, avg_entr 0.01003282144665718, f1 0.9128947257995605
ep15_l4_test_time 0.7892434597015381
gc 0
Train Epoch16 Acc 0.97175 (116610/120000), AUC 0.995776355266571
ep16_train_time 89.63465094566345
Test Epoch16 layer4 Acc 0.9139473684210526, AUC 0.9794564247131348, avg_entr 0.008149925619363785, f1 0.913947343826294
ep16_l4_test_time 0.7801685333251953
gc 0
Train Epoch17 Acc 0.9731583333333333 (116779/120000), AUC 0.995949387550354
ep17_train_time 89.87596487998962
Test Epoch17 layer4 Acc 0.9147368421052632, AUC 0.9794452786445618, avg_entr 0.0082812225446105, f1 0.9147368669509888
ep17_l4_test_time 0.7878735065460205
gc 0
Train Epoch18 Acc 0.9749416666666667 (116993/120000), AUC 0.9960488080978394
ep18_train_time 89.62202310562134
Test Epoch18 layer4 Acc 0.9134210526315789, AUC 0.9795072078704834, avg_entr 0.007559013087302446, f1 0.9134210348129272
ep18_l4_test_time 0.7875521183013916
gc 0
Train Epoch19 Acc 0.9761333333333333 (117136/120000), AUC 0.9961841106414795
ep19_train_time 89.80641484260559
Test Epoch19 layer4 Acc 0.908157894736842, AUC 0.9782148003578186, avg_entr 0.00793641060590744, f1 0.9081578850746155
ep19_l4_test_time 0.7901721000671387
gc 0
Train Epoch20 Acc 0.977825 (117339/120000), AUC 0.9963009357452393
ep20_train_time 163.0032594203949
Test Epoch20 layer4 Acc 0.9094736842105263, AUC 0.9777916669845581, avg_entr 0.007359809707850218, f1 0.9094736576080322
ep20_l4_test_time 1.580570936203003
gc 0
Train Epoch21 Acc 0.9793083333333333 (117517/120000), AUC 0.9964106678962708
ep21_train_time 185.5237307548523
Test Epoch21 layer4 Acc 0.9055263157894737, AUC 0.9764715433120728, avg_entr 0.007681246381253004, f1 0.905526340007782
ep21_l4_test_time 1.6195802688598633
gc 0
Train Epoch22 Acc 0.9805333333333334 (117664/120000), AUC 0.996528148651123
ep22_train_time 186.62760710716248
Test Epoch22 layer4 Acc 0.908157894736842, AUC 0.9767289161682129, avg_entr 0.005124315153807402, f1 0.9081578850746155
ep22_l4_test_time 1.6359455585479736
gc 0
Train Epoch23 Acc 0.981625 (117795/120000), AUC 0.996545135974884
ep23_train_time 185.8810863494873
Test Epoch23 layer4 Acc 0.9071052631578947, AUC 0.9758749008178711, avg_entr 0.005862340796738863, f1 0.9071052670478821
ep23_l4_test_time 1.6315028667449951
gc 0
Train Epoch24 Acc 0.9832416666666667 (117989/120000), AUC 0.9967514276504517
ep24_train_time 157.27417516708374
Test Epoch24 layer4 Acc 0.9086842105263158, AUC 0.9755315780639648, avg_entr 0.0066959792748093605, f1 0.9086841940879822
ep24_l4_test_time 1.635066032409668
gc 0
Train Epoch25 Acc 0.9838 (118056/120000), AUC 0.9967751502990723
ep25_train_time 186.17741179466248
Test Epoch25 layer4 Acc 0.9042105263157895, AUC 0.9748477339744568, avg_entr 0.007568934466689825, f1 0.9042104482650757
ep25_l4_test_time 1.6174228191375732
gc 0
Train Epoch26 Acc 0.9846666666666667 (118160/120000), AUC 0.9968739748001099
ep26_train_time 185.8831593990326
Test Epoch26 layer4 Acc 0.9055263157894737, AUC 0.9744566679000854, avg_entr 0.00618721591308713, f1 0.905526340007782
ep26_l4_test_time 1.6147677898406982
gc 0
Train Epoch27 Acc 0.9857083333333333 (118285/120000), AUC 0.9968974590301514
ep27_train_time 185.99150681495667
Test Epoch27 layer4 Acc 0.9023684210526316, AUC 0.9730885624885559, avg_entr 0.0051643578335642815, f1 0.902368426322937
ep27_l4_test_time 1.6317024230957031
gc 0
Train Epoch28 Acc 0.9862083333333334 (118345/120000), AUC 0.9970759153366089
ep28_train_time 186.36275482177734
Test Epoch28 layer4 Acc 0.9036842105263158, AUC 0.9730318188667297, avg_entr 0.006220484618097544, f1 0.9036841988563538
ep28_l4_test_time 1.5995206832885742
gc 0
Train Epoch29 Acc 0.986975 (118437/120000), AUC 0.9971152544021606
ep29_train_time 186.35705995559692
Test Epoch29 layer4 Acc 0.9055263157894737, AUC 0.9730252623558044, avg_entr 0.0055571747943758965, f1 0.905526340007782
ep29_l4_test_time 1.6308567523956299
Best AUC tensor(0.9247) 2
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 3634.319589138031
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt
Test layer0 Acc 0.9102631578947369, AUC 0.9794083833694458, avg_entr 0.1135433092713356, f1 0.910263180732727
l0_test_time 0.32718753814697266
Test layer1 Acc 0.9128947368421053, AUC 0.9822152853012085, avg_entr 0.045424316078424454, f1 0.9128947257995605
l1_test_time 0.5940127372741699
Test layer2 Acc 0.9128947368421053, AUC 0.9827085733413696, avg_entr 0.04266096279025078, f1 0.9128947257995605
l2_test_time 0.905001163482666
Test layer3 Acc 0.9126315789473685, AUC 0.9818764328956604, avg_entr 0.04295141249895096, f1 0.9126315712928772
l3_test_time 1.2627580165863037
Test layer4 Acc 0.911578947368421, AUC 0.9826701283454895, avg_entr 0.04379836097359657, f1 0.9115789532661438
l4_test_time 1.6371421813964844
