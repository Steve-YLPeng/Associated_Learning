total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 19.296077966690063
Start Training
gc 0
Train Epoch0 Acc 0.7291083333333334 (87493/120000), AUC 0.9190258979797363
ep0_train_time 113.60835313796997
Test Epoch0 layer4 Acc 0.9092105263157895, AUC 0.9811237454414368, avg_entr 0.11602837592363358, f1 0.9092105031013489
ep0_l4_test_time 1.0524914264678955
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9200083333333333 (110401/120000), AUC 0.9816087484359741
ep1_train_time 114.43693828582764
Test Epoch1 layer4 Acc 0.92, AUC 0.9832611083984375, avg_entr 0.055180467665195465, f1 0.9200000166893005
ep1_l4_test_time 1.1026685237884521
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9319083333333333 (111829/120000), AUC 0.9863662719726562
ep2_train_time 117.48243308067322
Test Epoch2 layer4 Acc 0.9207894736842105, AUC 0.9837567210197449, avg_entr 0.03251247853040695, f1 0.9207894802093506
ep2_l4_test_time 0.8668737411499023
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9395 (112740/120000), AUC 0.9890009760856628
ep3_train_time 119.78628277778625
Test Epoch3 layer4 Acc 0.921578947368421, AUC 0.9842944741249084, avg_entr 0.029463620856404305, f1 0.9215789437294006
ep3_l4_test_time 1.0372583866119385
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9437416666666667 (113249/120000), AUC 0.9904381036758423
ep4_train_time 114.49140310287476
Test Epoch4 layer4 Acc 0.92, AUC 0.9838227033615112, avg_entr 0.024830901995301247, f1 0.9200000166893005
ep4_l4_test_time 1.0767128467559814
gc 0
Train Epoch5 Acc 0.9478583333333334 (113743/120000), AUC 0.9916046857833862
ep5_train_time 114.63461208343506
Test Epoch5 layer4 Acc 0.9189473684210526, AUC 0.9831938147544861, avg_entr 0.022609898820519447, f1 0.9189472794532776
ep5_l4_test_time 1.0759024620056152
gc 0
Train Epoch6 Acc 0.9512 (114144/120000), AUC 0.9924840927124023
ep6_train_time 119.83940386772156
Test Epoch6 layer4 Acc 0.9207894736842105, AUC 0.9837106466293335, avg_entr 0.021269995719194412, f1 0.9207894802093506
ep6_l4_test_time 0.7814209461212158
gc 0
Train Epoch7 Acc 0.954025 (114483/120000), AUC 0.993057906627655
ep7_train_time 107.18427157402039
Test Epoch7 layer4 Acc 0.9178947368421052, AUC 0.9825593829154968, avg_entr 0.017929354682564735, f1 0.917894721031189
ep7_l4_test_time 1.046393632888794
gc 0
Train Epoch8 Acc 0.9562166666666667 (114746/120000), AUC 0.9935212135314941
ep8_train_time 114.35269618034363
Test Epoch8 layer4 Acc 0.9163157894736842, AUC 0.9818154573440552, avg_entr 0.016976656392216682, f1 0.9163157939910889
ep8_l4_test_time 0.891413688659668
gc 0
Train Epoch9 Acc 0.9582 (114984/120000), AUC 0.9939334392547607
ep9_train_time 120.16419267654419
Test Epoch9 layer4 Acc 0.9171052631578948, AUC 0.981037437915802, avg_entr 0.015678400173783302, f1 0.9171052575111389
ep9_l4_test_time 1.0916008949279785
gc 0
Train Epoch10 Acc 0.9601916666666667 (115223/120000), AUC 0.9941399693489075
ep10_train_time 111.93274259567261
Test Epoch10 layer4 Acc 0.915, AUC 0.980847179889679, avg_entr 0.014462818391621113, f1 0.9150000214576721
ep10_l4_test_time 1.038010835647583
gc 0
Train Epoch11 Acc 0.9620416666666667 (115445/120000), AUC 0.9943316578865051
ep11_train_time 113.90790629386902
Test Epoch11 layer4 Acc 0.916578947368421, AUC 0.9789023399353027, avg_entr 0.012427469715476036, f1 0.9165789484977722
ep11_l4_test_time 0.8829121589660645
gc 0
Train Epoch12 Acc 0.9639 (115668/120000), AUC 0.9946335554122925
ep12_train_time 121.0486147403717
Test Epoch12 layer4 Acc 0.915, AUC 0.9800127148628235, avg_entr 0.01367899402976036, f1 0.9150000214576721
ep12_l4_test_time 1.0553333759307861
gc 0
Train Epoch13 Acc 0.9656833333333333 (115882/120000), AUC 0.9948192834854126
ep13_train_time 111.59204888343811
Test Epoch13 layer4 Acc 0.9134210526315789, AUC 0.9782408475875854, avg_entr 0.0115621667355299, f1 0.9134210348129272
ep13_l4_test_time 1.0421411991119385
gc 0
Train Epoch14 Acc 0.96755 (116106/120000), AUC 0.9948303699493408
ep14_train_time 112.70584225654602
Test Epoch14 layer4 Acc 0.9128947368421053, AUC 0.9780815243721008, avg_entr 0.011122724041342735, f1 0.9128947257995605
ep14_l4_test_time 0.8584322929382324
gc 0
Train Epoch15 Acc 0.9691916666666667 (116303/120000), AUC 0.9950887560844421
ep15_train_time 121.92252469062805
Test Epoch15 layer4 Acc 0.9144736842105263, AUC 0.9762622117996216, avg_entr 0.009034821763634682, f1 0.9144737124443054
ep15_l4_test_time 0.922407865524292
gc 0
Train Epoch16 Acc 0.9710916666666667 (116531/120000), AUC 0.9951294660568237
ep16_train_time 115.00519251823425
Test Epoch16 layer4 Acc 0.9121052631578948, AUC 0.9769200086593628, avg_entr 0.008586767129600048, f1 0.9121052622795105
ep16_l4_test_time 1.0782392024993896
gc 0
Train Epoch17 Acc 0.9724916666666666 (116699/120000), AUC 0.9952214956283569
ep17_train_time 112.54831409454346
Test Epoch17 layer4 Acc 0.9123684210526316, AUC 0.9756203889846802, avg_entr 0.009182611480355263, f1 0.9123684167861938
ep17_l4_test_time 1.0925860404968262
gc 0
Train Epoch18 Acc 0.9739583333333334 (116875/120000), AUC 0.9954700469970703
ep18_train_time 108.07988858222961
Test Epoch18 layer4 Acc 0.9097368421052632, AUC 0.9742981195449829, avg_entr 0.006356663070619106, f1 0.9097368717193604
ep18_l4_test_time 1.093545913696289
gc 0
Train Epoch19 Acc 0.9753083333333333 (117037/120000), AUC 0.9955723285675049
ep19_train_time 113.78471612930298
Test Epoch19 layer4 Acc 0.908157894736842, AUC 0.9732073545455933, avg_entr 0.0081586092710495, f1 0.9081578850746155
ep19_l4_test_time 1.0706539154052734
gc 0
Train Epoch20 Acc 0.97685 (117222/120000), AUC 0.9957504272460938
ep20_train_time 113.8242666721344
Test Epoch20 layer4 Acc 0.9071052631578947, AUC 0.9723708629608154, avg_entr 0.007485169917345047, f1 0.9071052670478821
ep20_l4_test_time 1.0693690776824951
gc 0
Train Epoch21 Acc 0.9787333333333333 (117448/120000), AUC 0.9957543611526489
ep21_train_time 114.47559690475464
Test Epoch21 layer4 Acc 0.9073684210526316, AUC 0.9722779393196106, avg_entr 0.009414732456207275, f1 0.9073684215545654
ep21_l4_test_time 0.8623611927032471
gc 0
Train Epoch22 Acc 0.979775 (117573/120000), AUC 0.995873212814331
ep22_train_time 122.24160742759705
Test Epoch22 layer4 Acc 0.9013157894736842, AUC 0.9704906940460205, avg_entr 0.007848255336284637, f1 0.9013158082962036
ep22_l4_test_time 0.9292311668395996
gc 0
Train Epoch23 Acc 0.9811833333333333 (117742/120000), AUC 0.995987057685852
ep23_train_time 112.73718118667603
Test Epoch23 layer4 Acc 0.9063157894736842, AUC 0.9703823328018188, avg_entr 0.006499674171209335, f1 0.906315803527832
ep23_l4_test_time 1.0745434761047363
gc 0
Train Epoch24 Acc 0.982125 (117855/120000), AUC 0.9959887266159058
ep24_train_time 113.72390937805176
Test Epoch24 layer4 Acc 0.9078947368421053, AUC 0.9718465209007263, avg_entr 0.006702641490846872, f1 0.9078947901725769
ep24_l4_test_time 1.0814669132232666
gc 0
Train Epoch25 Acc 0.98315 (117978/120000), AUC 0.996290922164917
ep25_train_time 118.30382013320923
Test Epoch25 layer4 Acc 0.9039473684210526, AUC 0.9683019518852234, avg_entr 0.006156146991997957, f1 0.9039472937583923
ep25_l4_test_time 0.8676221370697021
gc 0
Train Epoch26 Acc 0.9844666666666667 (118136/120000), AUC 0.9962402582168579
ep26_train_time 118.58630704879761
Test Epoch26 layer4 Acc 0.9039473684210526, AUC 0.9679847359657288, avg_entr 0.006097552832216024, f1 0.9039472937583923
ep26_l4_test_time 1.065669298171997
gc 0
Train Epoch27 Acc 0.9850333333333333 (118204/120000), AUC 0.9964013695716858
ep27_train_time 112.67486619949341
Test Epoch27 layer4 Acc 0.9028947368421053, AUC 0.9653781652450562, avg_entr 0.006802540272474289, f1 0.9028947353363037
ep27_l4_test_time 1.06241774559021
gc 0
Train Epoch28 Acc 0.985875 (118305/120000), AUC 0.9964596033096313
ep28_train_time 114.05609226226807
Test Epoch28 layer4 Acc 0.9021052631578947, AUC 0.9620063304901123, avg_entr 0.004529482685029507, f1 0.9021052718162537
ep28_l4_test_time 0.8712444305419922
gc 0
Train Epoch29 Acc 0.9867416666666666 (118409/120000), AUC 0.9965195655822754
ep29_train_time 110.75229954719543
Test Epoch29 layer4 Acc 0.9031578947368422, AUC 0.9642994403839111, avg_entr 0.005208417773246765, f1 0.9031578898429871
ep29_l4_test_time 0.8595104217529297
Best AUC tensor(0.9216) 3
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 3482.4443068504333
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt
Test layer0 Acc 0.9118421052631579, AUC 0.9807493686676025, avg_entr 0.0974292904138565, f1 0.9118421077728271
l0_test_time 0.25426387786865234
Test layer1 Acc 0.9139473684210526, AUC 0.9827389717102051, avg_entr 0.03690722584724426, f1 0.913947343826294
l1_test_time 0.2962014675140381
Test layer2 Acc 0.9134210526315789, AUC 0.9831981658935547, avg_entr 0.03260587155818939, f1 0.9134210348129272
l2_test_time 0.5181019306182861
Test layer3 Acc 0.9134210526315789, AUC 0.9816263914108276, avg_entr 0.03446064889431, f1 0.9134210348129272
l3_test_time 0.7016959190368652
Test layer4 Acc 0.9144736842105263, AUC 0.981845498085022, avg_entr 0.03259291127324104, f1 0.9144737124443054
l4_test_time 0.8382608890533447
