total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 19.152695178985596
Start Training
gc 0
Train Epoch0 Acc 0.7367083333333333 (88405/120000), AUC 0.9184117913246155
ep0_train_time 89.3258318901062
Test Epoch0 layer4 Acc 0.9039473684210526, AUC 0.9792301654815674, avg_entr 0.10368756204843521, f1 0.9039472937583923
ep0_l4_test_time 0.797264575958252
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9200416666666666 (110405/120000), AUC 0.9816509485244751
ep1_train_time 89.49147701263428
Test Epoch1 layer4 Acc 0.9184210526315789, AUC 0.9834641814231873, avg_entr 0.0537814125418663, f1 0.9184210896492004
ep1_l4_test_time 0.7850954532623291
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9322416666666666 (111869/120000), AUC 0.9865458607673645
ep2_train_time 89.56182813644409
Test Epoch2 layer4 Acc 0.9247368421052632, AUC 0.9841294288635254, avg_entr 0.03687290474772453, f1 0.9247368574142456
ep2_l4_test_time 0.790844202041626
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9393083333333333 (112717/120000), AUC 0.9891365766525269
ep3_train_time 89.54112601280212
Test Epoch3 layer4 Acc 0.9207894736842105, AUC 0.9836940765380859, avg_entr 0.026352306827902794, f1 0.9207894802093506
ep3_l4_test_time 0.7917144298553467
gc 0
Train Epoch4 Acc 0.9439 (113268/120000), AUC 0.9906089305877686
ep4_train_time 89.5407121181488
Test Epoch4 layer4 Acc 0.92, AUC 0.9832968711853027, avg_entr 0.025456828996539116, f1 0.9200000166893005
ep4_l4_test_time 0.787865400314331
gc 0
Train Epoch5 Acc 0.9478583333333334 (113743/120000), AUC 0.9918365478515625
ep5_train_time 89.75590968132019
Test Epoch5 layer4 Acc 0.9213157894736842, AUC 0.9836477041244507, avg_entr 0.021562708541750908, f1 0.9213157892227173
ep5_l4_test_time 0.7954120635986328
gc 0
Train Epoch6 Acc 0.9513083333333333 (114157/120000), AUC 0.9924634695053101
ep6_train_time 89.47927975654602
Test Epoch6 layer4 Acc 0.92, AUC 0.9834309816360474, avg_entr 0.019381824880838394, f1 0.9200000166893005
ep6_l4_test_time 0.785797119140625
gc 0
Train Epoch7 Acc 0.9536166666666667 (114434/120000), AUC 0.9933582544326782
ep7_train_time 89.6033582687378
Test Epoch7 layer4 Acc 0.9205263157894736, AUC 0.9829446077346802, avg_entr 0.01682315394282341, f1 0.9205263257026672
ep7_l4_test_time 0.7919952869415283
gc 0
Train Epoch8 Acc 0.9561 (114732/120000), AUC 0.9938110709190369
ep8_train_time 89.6679036617279
Test Epoch8 layer4 Acc 0.9173684210526316, AUC 0.9826912879943848, avg_entr 0.015602660365402699, f1 0.9173683524131775
ep8_l4_test_time 0.7925043106079102
gc 0
Train Epoch9 Acc 0.958625 (115035/120000), AUC 0.9941960573196411
ep9_train_time 89.66940569877625
Test Epoch9 layer4 Acc 0.9176315789473685, AUC 0.9829115867614746, avg_entr 0.015248630195856094, f1 0.9176315665245056
ep9_l4_test_time 0.7892897129058838
gc 0
Train Epoch10 Acc 0.9604166666666667 (115250/120000), AUC 0.9945996403694153
ep10_train_time 89.52559399604797
Test Epoch10 layer4 Acc 0.9178947368421052, AUC 0.9831238389015198, avg_entr 0.014981936663389206, f1 0.917894721031189
ep10_l4_test_time 0.7950024604797363
gc 0
Train Epoch11 Acc 0.9625666666666667 (115508/120000), AUC 0.9949518442153931
ep11_train_time 89.78512167930603
Test Epoch11 layer4 Acc 0.9160526315789473, AUC 0.9824941158294678, avg_entr 0.012549128383398056, f1 0.9160526394844055
ep11_l4_test_time 0.7855408191680908
gc 0
Train Epoch12 Acc 0.9643666666666667 (115724/120000), AUC 0.9951878190040588
ep12_train_time 89.56803870201111
Test Epoch12 layer4 Acc 0.915, AUC 0.9826226234436035, avg_entr 0.012128854170441628, f1 0.9150000214576721
ep12_l4_test_time 0.7910847663879395
gc 0
Train Epoch13 Acc 0.9661583333333333 (115939/120000), AUC 0.9954085946083069
ep13_train_time 89.64838027954102
Test Epoch13 layer4 Acc 0.915, AUC 0.9814733266830444, avg_entr 0.009144576266407967, f1 0.9150000214576721
ep13_l4_test_time 0.7930455207824707
gc 0
Train Epoch14 Acc 0.9682083333333333 (116185/120000), AUC 0.9956156015396118
ep14_train_time 89.75936341285706
Test Epoch14 layer4 Acc 0.915, AUC 0.9795713424682617, avg_entr 0.00910914596170187, f1 0.9150000214576721
ep14_l4_test_time 0.7907185554504395
gc 0
Train Epoch15 Acc 0.96975 (116370/120000), AUC 0.9958114624023438
ep15_train_time 89.74789595603943
Test Epoch15 layer4 Acc 0.9131578947368421, AUC 0.9803626537322998, avg_entr 0.010039165616035461, f1 0.9131578803062439
ep15_l4_test_time 0.79866623878479
gc 0
Train Epoch16 Acc 0.9714166666666667 (116570/120000), AUC 0.9959198236465454
ep16_train_time 89.82423782348633
Test Epoch16 layer4 Acc 0.9113157894736842, AUC 0.9796808958053589, avg_entr 0.008531413041055202, f1 0.9113157987594604
ep16_l4_test_time 0.7900605201721191
gc 0
Train Epoch17 Acc 0.973375 (116805/120000), AUC 0.9960664510726929
ep17_train_time 89.8554060459137
Test Epoch17 layer4 Acc 0.9131578947368421, AUC 0.9792314767837524, avg_entr 0.008458968251943588, f1 0.9131578803062439
ep17_l4_test_time 0.79158616065979
gc 0
Train Epoch18 Acc 0.974975 (116997/120000), AUC 0.9961193799972534
ep18_train_time 89.57828712463379
Test Epoch18 layer4 Acc 0.9134210526315789, AUC 0.9789227247238159, avg_entr 0.005758482962846756, f1 0.9134210348129272
ep18_l4_test_time 0.7901206016540527
gc 0
Train Epoch19 Acc 0.9764666666666667 (117176/120000), AUC 0.9962634444236755
ep19_train_time 90.00033617019653
Test Epoch19 layer4 Acc 0.9121052631578948, AUC 0.9779776930809021, avg_entr 0.007041037082672119, f1 0.9121052622795105
ep19_l4_test_time 0.8032088279724121
gc 0
Train Epoch20 Acc 0.9783083333333333 (117397/120000), AUC 0.9965183734893799
ep20_train_time 90.40454244613647
Test Epoch20 layer4 Acc 0.9107894736842105, AUC 0.9785295724868774, avg_entr 0.006878450512886047, f1 0.9107894897460938
ep20_l4_test_time 0.7985038757324219
gc 0
Train Epoch21 Acc 0.9792166666666666 (117506/120000), AUC 0.9966181516647339
ep21_train_time 89.71802616119385
Test Epoch21 layer4 Acc 0.9089473684210526, AUC 0.9772570729255676, avg_entr 0.0074572134763002396, f1 0.9089473485946655
ep21_l4_test_time 0.7902441024780273
gc 0
Train Epoch22 Acc 0.9805583333333333 (117667/120000), AUC 0.9967693090438843
ep22_train_time 89.60546517372131
Test Epoch22 layer4 Acc 0.9121052631578948, AUC 0.9775265455245972, avg_entr 0.007450109347701073, f1 0.9121052622795105
ep22_l4_test_time 0.7892723083496094
gc 0
Train Epoch23 Acc 0.981675 (117801/120000), AUC 0.9968867301940918
ep23_train_time 89.62131118774414
Test Epoch23 layer4 Acc 0.9086842105263158, AUC 0.9768906831741333, avg_entr 0.006516176741570234, f1 0.9086841940879822
ep23_l4_test_time 0.7814178466796875
gc 0
Train Epoch24 Acc 0.982725 (117927/120000), AUC 0.9969813823699951
ep24_train_time 89.67050290107727
Test Epoch24 layer4 Acc 0.9097368421052632, AUC 0.9779412746429443, avg_entr 0.004846816882491112, f1 0.9097368717193604
ep24_l4_test_time 0.7815585136413574
gc 0
Train Epoch25 Acc 0.98365 (118038/120000), AUC 0.9971078634262085
ep25_train_time 89.63031840324402
Test Epoch25 layer4 Acc 0.9086842105263158, AUC 0.9753616452217102, avg_entr 0.005572185385972261, f1 0.9086841940879822
ep25_l4_test_time 0.7919816970825195
gc 0
Train Epoch26 Acc 0.9848333333333333 (118180/120000), AUC 0.99720299243927
ep26_train_time 89.62769794464111
Test Epoch26 layer4 Acc 0.908157894736842, AUC 0.9756597280502319, avg_entr 0.00510643795132637, f1 0.9081578850746155
ep26_l4_test_time 0.7960493564605713
gc 0
Train Epoch27 Acc 0.9854833333333334 (118258/120000), AUC 0.9972360134124756
ep27_train_time 89.70502352714539
Test Epoch27 layer4 Acc 0.905, AUC 0.9758490920066833, avg_entr 0.00710863946005702, f1 0.9049999117851257
ep27_l4_test_time 0.7895658016204834
gc 0
Train Epoch28 Acc 0.9860333333333333 (118324/120000), AUC 0.9972800612449646
ep28_train_time 89.71596622467041
Test Epoch28 layer4 Acc 0.9063157894736842, AUC 0.975339949131012, avg_entr 0.005413632839918137, f1 0.906315803527832
ep28_l4_test_time 0.7839884757995605
gc 0
Train Epoch29 Acc 0.9865833333333334 (118390/120000), AUC 0.997324526309967
ep29_train_time 89.67702794075012
Test Epoch29 layer4 Acc 0.9028947368421053, AUC 0.9749179482460022, avg_entr 0.005224646534770727, f1 0.9028947353363037
ep29_l4_test_time 0.7844924926757812
Best AUC tensor(0.9247) 2
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 2715.6524279117584
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt
Test layer0 Acc 0.911578947368421, AUC 0.9792449474334717, avg_entr 0.11800984293222427, f1 0.9115789532661438
l0_test_time 0.16238617897033691
Test layer1 Acc 0.9128947368421053, AUC 0.9826333522796631, avg_entr 0.0440690852701664, f1 0.9128947257995605
l1_test_time 0.29596519470214844
Test layer2 Acc 0.915, AUC 0.9835909008979797, avg_entr 0.04034661129117012, f1 0.9150000214576721
l2_test_time 0.45595550537109375
Test layer3 Acc 0.9155263157894736, AUC 0.9829541444778442, avg_entr 0.04129614308476448, f1 0.9155263304710388
l3_test_time 0.6196615695953369
Test layer4 Acc 0.9160526315789473, AUC 0.9835116863250732, avg_entr 0.039921171963214874, f1 0.9160526394844055
l4_test_time 0.7830812931060791
