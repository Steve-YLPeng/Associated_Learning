total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LSTMModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(300, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LSTMLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): LSTM(600, 300, batch_first=True, bidirectional=True)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.weight_ih_l0 360000
layers.1.enc.f.weight_hh_l0 360000
layers.1.enc.f.bias_ih_l0 1200
layers.1.enc.f.bias_hh_l0 1200
layers.1.enc.f.weight_ih_l0_reverse 360000
layers.1.enc.f.weight_hh_l0_reverse 360000
layers.1.enc.f.bias_ih_l0_reverse 1200
layers.1.enc.f.bias_hh_l0_reverse 1200
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.weight_ih_l0 720000
layers.2.enc.f.weight_hh_l0 360000
layers.2.enc.f.bias_ih_l0 1200
layers.2.enc.f.bias_hh_l0 1200
layers.2.enc.f.weight_ih_l0_reverse 720000
layers.2.enc.f.weight_hh_l0_reverse 360000
layers.2.enc.f.bias_ih_l0_reverse 1200
layers.2.enc.f.bias_hh_l0_reverse 1200
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.weight_ih_l0 720000
layers.3.enc.f.weight_hh_l0 360000
layers.3.enc.f.bias_ih_l0 1200
layers.3.enc.f.bias_hh_l0 1200
layers.3.enc.f.weight_ih_l0_reverse 720000
layers.3.enc.f.weight_hh_l0_reverse 360000
layers.3.enc.f.bias_ih_l0_reverse 1200
layers.3.enc.f.bias_hh_l0_reverse 1200
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.weight_ih_l0 720000
layers.4.enc.f.weight_hh_l0 360000
layers.4.enc.f.bias_ih_l0 1200
layers.4.enc.f.bias_hh_l0 1200
layers.4.enc.f.weight_ih_l0_reverse 720000
layers.4.enc.f.weight_hh_l0_reverse 360000
layers.4.enc.f.bias_ih_l0_reverse 1200
layers.4.enc.f.bias_hh_l0_reverse 1200
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 17265092
init_time 21.016019821166992
Start Training
gc 0
Train Epoch0 Acc 0.7294333333333334 (87532/120000), AUC 0.913485050201416
ep0_train_time 185.80331993103027
Test Epoch0 layer4 Acc 0.9023684210526316, AUC 0.9812730550765991, avg_entr 0.11890387535095215, f1 0.902368426322937
ep0_l4_test_time 1.630796194076538
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.920125 (110415/120000), AUC 0.9817827343940735
ep1_train_time 184.98945260047913
Test Epoch1 layer4 Acc 0.9168421052631579, AUC 0.9836375117301941, avg_entr 0.06007365882396698, f1 0.9168421030044556
ep1_l4_test_time 1.6249539852142334
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9316583333333334 (111799/120000), AUC 0.986574649810791
ep2_train_time 98.13424730300903
Test Epoch2 layer4 Acc 0.9213157894736842, AUC 0.9837346076965332, avg_entr 0.037340156733989716, f1 0.9213157892227173
ep2_l4_test_time 0.7793939113616943
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.9385416666666667 (112625/120000), AUC 0.9890615344047546
ep3_train_time 89.82628512382507
Test Epoch3 layer4 Acc 0.921578947368421, AUC 0.9834976196289062, avg_entr 0.0293169766664505, f1 0.9215789437294006
ep3_l4_test_time 0.7860803604125977
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.94385 (113262/120000), AUC 0.9905524253845215
ep4_train_time 89.38462495803833
Test Epoch4 layer4 Acc 0.921578947368421, AUC 0.9837550520896912, avg_entr 0.026361417025327682, f1 0.9215789437294006
ep4_l4_test_time 0.7785556316375732
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9476083333333334 (113713/120000), AUC 0.991765558719635
ep5_train_time 89.39349460601807
Test Epoch5 layer4 Acc 0.921578947368421, AUC 0.9827627539634705, avg_entr 0.019985459744930267, f1 0.9215789437294006
ep5_l4_test_time 0.7912566661834717
Save ckpt to ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9504583333333333 (114055/120000), AUC 0.9924194812774658
ep6_train_time 89.50371766090393
Test Epoch6 layer4 Acc 0.9173684210526316, AUC 0.9823184013366699, avg_entr 0.02150496281683445, f1 0.9173683524131775
ep6_l4_test_time 0.7764463424682617
gc 0
Train Epoch7 Acc 0.9533583333333333 (114403/120000), AUC 0.9930534958839417
ep7_train_time 89.46550726890564
Test Epoch7 layer4 Acc 0.9184210526315789, AUC 0.9811679124832153, avg_entr 0.018982645124197006, f1 0.9184210896492004
ep7_l4_test_time 0.7792375087738037
gc 0
Train Epoch8 Acc 0.9565166666666667 (114782/120000), AUC 0.9934388995170593
ep8_train_time 89.46001625061035
Test Epoch8 layer4 Acc 0.9152631578947369, AUC 0.9817904233932495, avg_entr 0.016961704939603806, f1 0.9152631759643555
ep8_l4_test_time 0.7835705280303955
gc 0
Train Epoch9 Acc 0.9582166666666667 (114986/120000), AUC 0.9940697550773621
ep9_train_time 89.45262885093689
Test Epoch9 layer4 Acc 0.9160526315789473, AUC 0.9809886813163757, avg_entr 0.01620515249669552, f1 0.9160526394844055
ep9_l4_test_time 0.7790460586547852
gc 0
Train Epoch10 Acc 0.9601416666666667 (115217/120000), AUC 0.9943499565124512
ep10_train_time 89.36152577400208
Test Epoch10 layer4 Acc 0.9131578947368421, AUC 0.9808453917503357, avg_entr 0.017866002395749092, f1 0.9131578803062439
ep10_l4_test_time 0.7894637584686279
gc 0
Train Epoch11 Acc 0.9623416666666667 (115481/120000), AUC 0.9945443272590637
ep11_train_time 89.40763330459595
Test Epoch11 layer4 Acc 0.9139473684210526, AUC 0.9769850969314575, avg_entr 0.015446390025317669, f1 0.913947343826294
ep11_l4_test_time 0.7774264812469482
gc 0
Train Epoch12 Acc 0.9636583333333333 (115639/120000), AUC 0.9946943521499634
ep12_train_time 89.4585473537445
Test Epoch12 layer4 Acc 0.9160526315789473, AUC 0.9771592617034912, avg_entr 0.011305845342576504, f1 0.9160526394844055
ep12_l4_test_time 0.7801976203918457
gc 0
Train Epoch13 Acc 0.9655 (115860/120000), AUC 0.9948664903640747
ep13_train_time 89.34967827796936
Test Epoch13 layer4 Acc 0.9102631578947369, AUC 0.9784529805183411, avg_entr 0.01260545663535595, f1 0.910263180732727
ep13_l4_test_time 0.783027172088623
gc 0
Train Epoch14 Acc 0.9672916666666667 (116075/120000), AUC 0.9950491786003113
ep14_train_time 89.45946741104126
Test Epoch14 layer4 Acc 0.9102631578947369, AUC 0.9762588739395142, avg_entr 0.01153017207980156, f1 0.910263180732727
ep14_l4_test_time 0.7786531448364258
gc 0
Train Epoch15 Acc 0.9693583333333333 (116323/120000), AUC 0.995109498500824
ep15_train_time 89.47985291481018
Test Epoch15 layer4 Acc 0.9097368421052632, AUC 0.9747084379196167, avg_entr 0.01009376160800457, f1 0.9097368717193604
ep15_l4_test_time 0.7887308597564697
gc 0
Train Epoch16 Acc 0.9709666666666666 (116516/120000), AUC 0.9951241612434387
ep16_train_time 89.3785285949707
Test Epoch16 layer4 Acc 0.908157894736842, AUC 0.9757003784179688, avg_entr 0.00859434250742197, f1 0.9081578850746155
ep16_l4_test_time 0.7778728008270264
gc 0
Train Epoch17 Acc 0.9724833333333334 (116698/120000), AUC 0.9952915906906128
ep17_train_time 89.38886904716492
Test Epoch17 layer4 Acc 0.9089473684210526, AUC 0.9735246300697327, avg_entr 0.00739433104172349, f1 0.9089473485946655
ep17_l4_test_time 0.7817542552947998
gc 0
Train Epoch18 Acc 0.9743916666666667 (116927/120000), AUC 0.9952641725540161
ep18_train_time 89.49904203414917
Test Epoch18 layer4 Acc 0.9071052631578947, AUC 0.9722118973731995, avg_entr 0.008356419391930103, f1 0.9071052670478821
ep18_l4_test_time 0.7835772037506104
gc 0
Train Epoch19 Acc 0.9756 (117072/120000), AUC 0.9953712224960327
ep19_train_time 89.4716546535492
Test Epoch19 layer4 Acc 0.9073684210526316, AUC 0.9741015434265137, avg_entr 0.00801151804625988, f1 0.9073684215545654
ep19_l4_test_time 0.776892900466919
gc 0
Train Epoch20 Acc 0.977225 (117267/120000), AUC 0.9954441785812378
ep20_train_time 89.48614501953125
Test Epoch20 layer4 Acc 0.9052631578947369, AUC 0.9695302248001099, avg_entr 0.0070776077918708324, f1 0.9052631855010986
ep20_l4_test_time 0.7892313003540039
gc 0
Train Epoch21 Acc 0.97855 (117426/120000), AUC 0.9954159259796143
ep21_train_time 89.36236619949341
Test Epoch21 layer4 Acc 0.9052631578947369, AUC 0.9715468883514404, avg_entr 0.007187471259385347, f1 0.9052631855010986
ep21_l4_test_time 0.7781140804290771
gc 0
Train Epoch22 Acc 0.979875 (117585/120000), AUC 0.9954112768173218
ep22_train_time 89.55749130249023
Test Epoch22 layer4 Acc 0.8986842105263158, AUC 0.9693256616592407, avg_entr 0.007648543920367956, f1 0.8986842036247253
ep22_l4_test_time 0.7827270030975342
gc 0
Train Epoch23 Acc 0.9805333333333334 (117664/120000), AUC 0.9955701231956482
ep23_train_time 89.54876613616943
Test Epoch23 layer4 Acc 0.9047368421052632, AUC 0.9689332842826843, avg_entr 0.007414424326270819, f1 0.9047367572784424
ep23_l4_test_time 0.7845249176025391
gc 0
Train Epoch24 Acc 0.981925 (117831/120000), AUC 0.9955369830131531
ep24_train_time 89.67345094680786
Test Epoch24 layer4 Acc 0.9036842105263158, AUC 0.9676163196563721, avg_entr 0.006207243073731661, f1 0.9036841988563538
ep24_l4_test_time 0.7825696468353271
gc 0
Train Epoch25 Acc 0.9829916666666667 (117959/120000), AUC 0.9956283569335938
ep25_train_time 89.92623281478882
Test Epoch25 layer4 Acc 0.9007894736842105, AUC 0.9658797979354858, avg_entr 0.006862567272037268, f1 0.9007894396781921
ep25_l4_test_time 0.7917830944061279
gc 0
Train Epoch26 Acc 0.9840166666666667 (118082/120000), AUC 0.9956562519073486
ep26_train_time 89.8766098022461
Test Epoch26 layer4 Acc 0.9028947368421053, AUC 0.9638897180557251, avg_entr 0.005009090062230825, f1 0.9028947353363037
ep26_l4_test_time 0.7807257175445557
gc 0
Train Epoch27 Acc 0.985 (118200/120000), AUC 0.9955825209617615
ep27_train_time 89.83831477165222
Test Epoch27 layer4 Acc 0.9021052631578947, AUC 0.9629954099655151, avg_entr 0.006607390008866787, f1 0.9021052718162537
ep27_l4_test_time 0.788701057434082
gc 0
Train Epoch28 Acc 0.985775 (118293/120000), AUC 0.9957267642021179
ep28_train_time 89.87603831291199
Test Epoch28 layer4 Acc 0.9005263157894737, AUC 0.9630899429321289, avg_entr 0.00475890189409256, f1 0.9005263447761536
ep28_l4_test_time 0.7863585948944092
gc 0
Train Epoch29 Acc 0.9865333333333334 (118384/120000), AUC 0.9958453178405762
ep29_train_time 90.12193894386292
Test Epoch29 layer4 Acc 0.9007894736842105, AUC 0.9614085555076599, avg_entr 0.0051438817754387856, f1 0.9007894396781921
ep29_l4_test_time 0.7815861701965332
Best AUC tensor(0.9216) 5
train_loss (2, 5, 30)
valid_acc (1, 30)
valid_AUC (1, 30)
train_acc (30,)
total_train+valid_time 2914.1106979846954
Start Testing
Load ckpt at ckpt/ag_news_lstmal_l5base_pad177//ag_news_lstmal_l5.pt
Test layer0 Acc 0.9134210526315789, AUC 0.9808459281921387, avg_entr 0.07689691334962845, f1 0.9134210348129272
l0_test_time 0.16075992584228516
Test layer1 Acc 0.911578947368421, AUC 0.9825252890586853, avg_entr 0.027134915813803673, f1 0.9115789532661438
l1_test_time 0.2949256896972656
Test layer2 Acc 0.9131578947368421, AUC 0.9828002452850342, avg_entr 0.024046462029218674, f1 0.9131578803062439
l2_test_time 0.4528932571411133
Test layer3 Acc 0.9113157894736842, AUC 0.981074333190918, avg_entr 0.022890644147992134, f1 0.9113157987594604
l3_test_time 0.6155304908752441
Test layer4 Acc 0.9123684210526316, AUC 0.9822025299072266, avg_entr 0.023927152156829834, f1 0.9123684167861938
l4_test_time 0.7753934860229492
