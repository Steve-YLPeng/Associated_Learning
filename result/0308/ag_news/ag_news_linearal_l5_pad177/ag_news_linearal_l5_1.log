total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.862207412719727
Start Training
gc 0
Train Epoch0 Acc 0.6290583333333334 (75487/120000), AUC 0.850567102432251
ep0_train_time 10.429136514663696
Test Epoch0 layer0 Acc 0.9026315789473685, AUC 0.9773675203323364, avg_entr 0.2540445327758789, f1 0.9026315808296204
ep0_l0_test_time 0.16011929512023926
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9018421052631579, AUC 0.977595329284668, avg_entr 0.26645177602767944, f1 0.9018421173095703
ep0_l1_test_time 0.1583702564239502
Test Epoch0 layer2 Acc 0.9028947368421053, AUC 0.9773745536804199, avg_entr 0.23164069652557373, f1 0.9028947353363037
ep0_l2_test_time 0.15935277938842773
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer3 Acc 0.9031578947368422, AUC 0.9774434566497803, avg_entr 0.22923563420772552, f1 0.9031578898429871
ep0_l3_test_time 0.16160035133361816
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer4 Acc 0.9039473684210526, AUC 0.977411687374115, avg_entr 0.22475078701972961, f1 0.9039472937583923
ep0_l4_test_time 0.1615910530090332
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9166 (109992/120000), AUC 0.9815481901168823
ep1_train_time 10.001527309417725
Test Epoch1 layer0 Acc 0.9173684210526316, AUC 0.9807369709014893, avg_entr 0.14623308181762695, f1 0.9173683524131775
ep1_l0_test_time 0.15798473358154297
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9171052631578948, AUC 0.9807828068733215, avg_entr 0.14006386697292328, f1 0.9171052575111389
ep1_l1_test_time 0.15817594528198242
Test Epoch1 layer2 Acc 0.9176315789473685, AUC 0.9808989763259888, avg_entr 0.13627152144908905, f1 0.9176315665245056
ep1_l2_test_time 0.1589961051940918
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9189473684210526, AUC 0.9809973239898682, avg_entr 0.13166573643684387, f1 0.9189472794532776
ep1_l3_test_time 0.16074013710021973
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.9176315789473685, AUC 0.9811593890190125, avg_entr 0.12442195415496826, f1 0.9176315665245056
ep1_l4_test_time 0.16212081909179688
gc 0
Train Epoch2 Acc 0.92685 (111222/120000), AUC 0.9858425855636597
ep2_train_time 10.01152491569519
Test Epoch2 layer0 Acc 0.9221052631578948, AUC 0.9819191098213196, avg_entr 0.11077766865491867, f1 0.9221052527427673
ep2_l0_test_time 0.15816307067871094
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.921578947368421, AUC 0.9818993806838989, avg_entr 0.10445263981819153, f1 0.9215789437294006
ep2_l1_test_time 0.1581277847290039
Test Epoch2 layer2 Acc 0.9218421052631579, AUC 0.9820569753646851, avg_entr 0.10244802385568619, f1 0.921842098236084
ep2_l2_test_time 0.15828323364257812
Test Epoch2 layer3 Acc 0.9213157894736842, AUC 0.9821970462799072, avg_entr 0.09432027488946915, f1 0.9213157892227173
ep2_l3_test_time 0.15903091430664062
Test Epoch2 layer4 Acc 0.9228947368421052, AUC 0.9826840162277222, avg_entr 0.08379187434911728, f1 0.9228947162628174
ep2_l4_test_time 0.15961623191833496
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 2
gc 0
Train Epoch3 Acc 0.933 (111960/120000), AUC 0.9882431030273438
ep3_train_time 10.088087320327759
Test Epoch3 layer0 Acc 0.9218421052631579, AUC 0.9824758768081665, avg_entr 0.0914081260561943, f1 0.921842098236084
ep3_l0_test_time 0.15866613388061523
Test Epoch3 layer1 Acc 0.9218421052631579, AUC 0.9823470115661621, avg_entr 0.08513294160366058, f1 0.921842098236084
ep3_l1_test_time 0.15722012519836426
Test Epoch3 layer2 Acc 0.9221052631578948, AUC 0.9823857545852661, avg_entr 0.0833270251750946, f1 0.9221052527427673
ep3_l2_test_time 0.15918970108032227
Test Epoch3 layer3 Acc 0.921578947368421, AUC 0.9825571775436401, avg_entr 0.0724356472492218, f1 0.9215789437294006
ep3_l3_test_time 0.1597576141357422
Test Epoch3 layer4 Acc 0.9218421052631579, AUC 0.9828813672065735, avg_entr 0.05452613905072212, f1 0.921842098236084
ep3_l4_test_time 0.160660982131958
gc 0
Train Epoch4 Acc 0.93725 (112470/120000), AUC 0.9895415902137756
ep4_train_time 9.984884023666382
Test Epoch4 layer0 Acc 0.9239473684210526, AUC 0.9826518297195435, avg_entr 0.08239313960075378, f1 0.9239473938941956
ep4_l0_test_time 0.15937352180480957
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.9231578947368421, AUC 0.9824665188789368, avg_entr 0.07592188566923141, f1 0.9231578707695007
ep4_l1_test_time 0.1587233543395996
Test Epoch4 layer2 Acc 0.9228947368421052, AUC 0.982525110244751, avg_entr 0.07343263179063797, f1 0.9228947162628174
ep4_l2_test_time 0.15829086303710938
Test Epoch4 layer3 Acc 0.9239473684210526, AUC 0.9825317859649658, avg_entr 0.054832153022289276, f1 0.9239473938941956
ep4_l3_test_time 0.15894150733947754
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 4
Test Epoch4 layer4 Acc 0.9218421052631579, AUC 0.982325553894043, avg_entr 0.03798989951610565, f1 0.921842098236084
ep4_l4_test_time 0.16218876838684082
gc 0
Train Epoch5 Acc 0.940375 (112845/120000), AUC 0.9902616739273071
ep5_train_time 10.009697914123535
Test Epoch5 layer0 Acc 0.9231578947368421, AUC 0.9826587438583374, avg_entr 0.0720338299870491, f1 0.9231578707695007
ep5_l0_test_time 0.16042661666870117
Test Epoch5 layer1 Acc 0.921578947368421, AUC 0.9824942350387573, avg_entr 0.06787281483411789, f1 0.9215789437294006
ep5_l1_test_time 0.1580970287322998
Test Epoch5 layer2 Acc 0.9231578947368421, AUC 0.9827743768692017, avg_entr 0.06230791658163071, f1 0.9231578707695007
ep5_l2_test_time 0.15866923332214355
Test Epoch5 layer3 Acc 0.9231578947368421, AUC 0.9834004044532776, avg_entr 0.04184983670711517, f1 0.9231578707695007
ep5_l3_test_time 0.16137051582336426
Test Epoch5 layer4 Acc 0.9236842105263158, AUC 0.9830320477485657, avg_entr 0.030871594324707985, f1 0.9236842393875122
ep5_l4_test_time 0.1604928970336914
gc 0
Train Epoch6 Acc 0.9430916666666667 (113171/120000), AUC 0.991038978099823
ep6_train_time 9.995460033416748
Test Epoch6 layer0 Acc 0.9205263157894736, AUC 0.9826176762580872, avg_entr 0.07076377421617508, f1 0.9205263257026672
ep6_l0_test_time 0.15848875045776367
Test Epoch6 layer1 Acc 0.9210526315789473, AUC 0.9824441075325012, avg_entr 0.06595886498689651, f1 0.9210526347160339
ep6_l1_test_time 0.15827417373657227
Test Epoch6 layer2 Acc 0.9213157894736842, AUC 0.9827983975410461, avg_entr 0.0567622147500515, f1 0.9213157892227173
ep6_l2_test_time 0.16008210182189941
Test Epoch6 layer3 Acc 0.9192105263157895, AUC 0.9827696084976196, avg_entr 0.03649814799427986, f1 0.9192105531692505
ep6_l3_test_time 0.1605522632598877
Test Epoch6 layer4 Acc 0.9189473684210526, AUC 0.9801626205444336, avg_entr 0.029057476669549942, f1 0.9189472794532776
ep6_l4_test_time 0.16162705421447754
gc 0
Train Epoch7 Acc 0.945175 (113421/120000), AUC 0.9918563365936279
ep7_train_time 10.031243562698364
Test Epoch7 layer0 Acc 0.9239473684210526, AUC 0.9826865196228027, avg_entr 0.06310077756643295, f1 0.9239473938941956
ep7_l0_test_time 0.15938138961791992
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 7
Test Epoch7 layer1 Acc 0.9234210526315789, AUC 0.9824168682098389, avg_entr 0.05908866599202156, f1 0.9234210252761841
ep7_l1_test_time 0.1580677032470703
Test Epoch7 layer2 Acc 0.9239473684210526, AUC 0.9832133054733276, avg_entr 0.04811553284525871, f1 0.9239473938941956
ep7_l2_test_time 0.15851187705993652
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 7
Test Epoch7 layer3 Acc 0.9257894736842105, AUC 0.9822859764099121, avg_entr 0.029420647770166397, f1 0.9257895350456238
ep7_l3_test_time 0.1616497039794922
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 7
Test Epoch7 layer4 Acc 0.9239473684210526, AUC 0.983092188835144, avg_entr 0.025109369307756424, f1 0.9239473938941956
ep7_l4_test_time 0.16144299507141113
gc 0
Train Epoch8 Acc 0.9470083333333333 (113641/120000), AUC 0.9925422668457031
ep8_train_time 10.075669527053833
Test Epoch8 layer0 Acc 0.9207894736842105, AUC 0.9825399518013, avg_entr 0.05826139077544212, f1 0.9207894802093506
ep8_l0_test_time 0.15822339057922363
Test Epoch8 layer1 Acc 0.9205263157894736, AUC 0.9823030829429626, avg_entr 0.05479593202471733, f1 0.9205263257026672
ep8_l1_test_time 0.15717434883117676
Test Epoch8 layer2 Acc 0.9218421052631579, AUC 0.9831615686416626, avg_entr 0.04076826572418213, f1 0.921842098236084
ep8_l2_test_time 0.15818119049072266
Test Epoch8 layer3 Acc 0.9207894736842105, AUC 0.9824435710906982, avg_entr 0.027154624462127686, f1 0.9207894802093506
ep8_l3_test_time 0.15826416015625
Test Epoch8 layer4 Acc 0.921578947368421, AUC 0.9829334020614624, avg_entr 0.02300061471760273, f1 0.9215789437294006
ep8_l4_test_time 0.15906381607055664
gc 0
Train Epoch9 Acc 0.949225 (113907/120000), AUC 0.9934056401252747
ep9_train_time 10.037521362304688
Test Epoch9 layer0 Acc 0.9234210526315789, AUC 0.9824649095535278, avg_entr 0.05574919283390045, f1 0.9234210252761841
ep9_l0_test_time 0.15822553634643555
Test Epoch9 layer1 Acc 0.9223684210526316, AUC 0.9821021556854248, avg_entr 0.05245479568839073, f1 0.9223684072494507
ep9_l1_test_time 0.15671038627624512
Test Epoch9 layer2 Acc 0.9239473684210526, AUC 0.9831426739692688, avg_entr 0.03696873039007187, f1 0.9239473938941956
ep9_l2_test_time 0.15825819969177246
Test Epoch9 layer3 Acc 0.9244736842105263, AUC 0.9828734397888184, avg_entr 0.024708623066544533, f1 0.9244737029075623
ep9_l3_test_time 0.1603560447692871
Test Epoch9 layer4 Acc 0.9234210526315789, AUC 0.982573390007019, avg_entr 0.02183343842625618, f1 0.9234210252761841
ep9_l4_test_time 0.16074681282043457
gc 0
Train Epoch10 Acc 0.950025 (114003/120000), AUC 0.9935696721076965
ep10_train_time 9.985446691513062
Test Epoch10 layer0 Acc 0.9210526315789473, AUC 0.982313871383667, avg_entr 0.05324912443757057, f1 0.9210526347160339
ep10_l0_test_time 0.15891003608703613
Test Epoch10 layer1 Acc 0.9221052631578948, AUC 0.9820033311843872, avg_entr 0.05043064430356026, f1 0.9221052527427673
ep10_l1_test_time 0.1572098731994629
Test Epoch10 layer2 Acc 0.9213157894736842, AUC 0.982977032661438, avg_entr 0.032742761075496674, f1 0.9213157892227173
ep10_l2_test_time 0.1587233543395996
Test Epoch10 layer3 Acc 0.9221052631578948, AUC 0.983080267906189, avg_entr 0.021324824541807175, f1 0.9221052527427673
ep10_l3_test_time 0.16033673286437988
Test Epoch10 layer4 Acc 0.9218421052631579, AUC 0.9826715588569641, avg_entr 0.018830718472599983, f1 0.921842098236084
ep10_l4_test_time 0.16131019592285156
gc 0
Train Epoch11 Acc 0.9508083333333334 (114097/120000), AUC 0.9938092231750488
ep11_train_time 10.002616167068481
Test Epoch11 layer0 Acc 0.9242105263157895, AUC 0.9822327494621277, avg_entr 0.05017562955617905, f1 0.9242105484008789
ep11_l0_test_time 0.1593935489654541
Test Epoch11 layer1 Acc 0.9231578947368421, AUC 0.9818745851516724, avg_entr 0.04746284335851669, f1 0.9231578707695007
ep11_l1_test_time 0.15815496444702148
Test Epoch11 layer2 Acc 0.9228947368421052, AUC 0.9826806783676147, avg_entr 0.029113246127963066, f1 0.9228947162628174
ep11_l2_test_time 0.15813541412353516
Test Epoch11 layer3 Acc 0.9231578947368421, AUC 0.9827385544776917, avg_entr 0.019220327958464622, f1 0.9231578707695007
ep11_l3_test_time 0.1585085391998291
Test Epoch11 layer4 Acc 0.9231578947368421, AUC 0.9825409650802612, avg_entr 0.017244413495063782, f1 0.9231578707695007
ep11_l4_test_time 0.1597433090209961
gc 0
Train Epoch12 Acc 0.9511583333333333 (114139/120000), AUC 0.9938825964927673
ep12_train_time 10.11923861503601
Test Epoch12 layer0 Acc 0.9228947368421052, AUC 0.9822987914085388, avg_entr 0.048763323575258255, f1 0.9228947162628174
ep12_l0_test_time 0.15787386894226074
Test Epoch12 layer1 Acc 0.9213157894736842, AUC 0.9819204807281494, avg_entr 0.045934926718473434, f1 0.9213157892227173
ep12_l1_test_time 0.1564619541168213
Test Epoch12 layer2 Acc 0.9221052631578948, AUC 0.9827273488044739, avg_entr 0.027790935710072517, f1 0.9221052527427673
ep12_l2_test_time 0.15757966041564941
Test Epoch12 layer3 Acc 0.921578947368421, AUC 0.9830031991004944, avg_entr 0.018714237958192825, f1 0.9215789437294006
ep12_l3_test_time 0.15798091888427734
Test Epoch12 layer4 Acc 0.9218421052631579, AUC 0.9828522801399231, avg_entr 0.017026592046022415, f1 0.921842098236084
ep12_l4_test_time 0.15892553329467773
gc 0
Train Epoch13 Acc 0.9524666666666667 (114296/120000), AUC 0.9941756725311279
ep13_train_time 10.083113670349121
Test Epoch13 layer0 Acc 0.9221052631578948, AUC 0.982181966304779, avg_entr 0.047523342072963715, f1 0.9221052527427673
ep13_l0_test_time 0.15880942344665527
Test Epoch13 layer1 Acc 0.9218421052631579, AUC 0.9818159937858582, avg_entr 0.0449843555688858, f1 0.921842098236084
ep13_l1_test_time 0.1567683219909668
Test Epoch13 layer2 Acc 0.9213157894736842, AUC 0.98279869556427, avg_entr 0.02680025063455105, f1 0.9213157892227173
ep13_l2_test_time 0.15818381309509277
Test Epoch13 layer3 Acc 0.9210526315789473, AUC 0.9826549291610718, avg_entr 0.018423201516270638, f1 0.9210526347160339
ep13_l3_test_time 0.160003662109375
Test Epoch13 layer4 Acc 0.9223684210526316, AUC 0.9821624755859375, avg_entr 0.017010902985930443, f1 0.9223684072494507
ep13_l4_test_time 0.15951752662658691
gc 0
Train Epoch14 Acc 0.9527416666666667 (114329/120000), AUC 0.9943631887435913
ep14_train_time 10.15502405166626
Test Epoch14 layer0 Acc 0.9234210526315789, AUC 0.9821925163269043, avg_entr 0.04583045467734337, f1 0.9234210252761841
ep14_l0_test_time 0.15834712982177734
Test Epoch14 layer1 Acc 0.921578947368421, AUC 0.9817680716514587, avg_entr 0.04330629110336304, f1 0.9215789437294006
ep14_l1_test_time 0.15675854682922363
Test Epoch14 layer2 Acc 0.921578947368421, AUC 0.9823133945465088, avg_entr 0.025470415130257607, f1 0.9215789437294006
ep14_l2_test_time 0.15786123275756836
Test Epoch14 layer3 Acc 0.9221052631578948, AUC 0.9827465415000916, avg_entr 0.017374655231833458, f1 0.9221052527427673
ep14_l3_test_time 0.15954089164733887
Test Epoch14 layer4 Acc 0.9221052631578948, AUC 0.9825704097747803, avg_entr 0.015972338616847992, f1 0.9221052527427673
ep14_l4_test_time 0.16043877601623535
gc 0
Train Epoch15 Acc 0.9531333333333334 (114376/120000), AUC 0.9944603443145752
ep15_train_time 10.03952956199646
Test Epoch15 layer0 Acc 0.9218421052631579, AUC 0.982142448425293, avg_entr 0.04489068314433098, f1 0.921842098236084
ep15_l0_test_time 0.15874648094177246
Test Epoch15 layer1 Acc 0.9218421052631579, AUC 0.9817348718643188, avg_entr 0.04220013692975044, f1 0.921842098236084
ep15_l1_test_time 0.1571788787841797
Test Epoch15 layer2 Acc 0.9210526315789473, AUC 0.9822143316268921, avg_entr 0.024274738505482674, f1 0.9210526347160339
ep15_l2_test_time 0.15864324569702148
Test Epoch15 layer3 Acc 0.9207894736842105, AUC 0.9819576740264893, avg_entr 0.016482548788189888, f1 0.9207894802093506
ep15_l3_test_time 0.15902209281921387
Test Epoch15 layer4 Acc 0.9223684210526316, AUC 0.981127142906189, avg_entr 0.015125078149139881, f1 0.9223684072494507
ep15_l4_test_time 0.1594071388244629
gc 0
Train Epoch16 Acc 0.953275 (114393/120000), AUC 0.9944746494293213
ep16_train_time 10.003920793533325
Test Epoch16 layer0 Acc 0.9192105263157895, AUC 0.9821020364761353, avg_entr 0.043536003679037094, f1 0.9192105531692505
ep16_l0_test_time 0.15973854064941406
Test Epoch16 layer1 Acc 0.9192105263157895, AUC 0.9816731214523315, avg_entr 0.040897469967603683, f1 0.9192105531692505
ep16_l1_test_time 0.15848231315612793
Test Epoch16 layer2 Acc 0.9202631578947369, AUC 0.9823750257492065, avg_entr 0.02416304312646389, f1 0.9202631711959839
ep16_l2_test_time 0.16041088104248047
Test Epoch16 layer3 Acc 0.9189473684210526, AUC 0.9826083183288574, avg_entr 0.017465315759181976, f1 0.9189472794532776
ep16_l3_test_time 0.15877246856689453
Test Epoch16 layer4 Acc 0.9189473684210526, AUC 0.982031524181366, avg_entr 0.016105331480503082, f1 0.9189472794532776
ep16_l4_test_time 0.1600480079650879
gc 0
Train Epoch17 Acc 0.954 (114480/120000), AUC 0.9946436882019043
ep17_train_time 10.058875799179077
Test Epoch17 layer0 Acc 0.9228947368421052, AUC 0.9820998907089233, avg_entr 0.04176050052046776, f1 0.9228947162628174
ep17_l0_test_time 0.15839695930480957
Test Epoch17 layer1 Acc 0.9218421052631579, AUC 0.9816440939903259, avg_entr 0.03941413760185242, f1 0.921842098236084
ep17_l1_test_time 0.15666484832763672
Test Epoch17 layer2 Acc 0.9213157894736842, AUC 0.982059895992279, avg_entr 0.022626765072345734, f1 0.9213157892227173
ep17_l2_test_time 0.1579124927520752
Test Epoch17 layer3 Acc 0.9213157894736842, AUC 0.981920599937439, avg_entr 0.015458846464753151, f1 0.9213157892227173
ep17_l3_test_time 0.15892291069030762
Test Epoch17 layer4 Acc 0.9221052631578948, AUC 0.9817411303520203, avg_entr 0.014268484897911549, f1 0.9221052527427673
ep17_l4_test_time 0.15926575660705566
gc 0
Train Epoch18 Acc 0.9541833333333334 (114502/120000), AUC 0.9947336912155151
ep18_train_time 10.026887655258179
Test Epoch18 layer0 Acc 0.9223684210526316, AUC 0.9821244478225708, avg_entr 0.04080384597182274, f1 0.9223684072494507
ep18_l0_test_time 0.15833735466003418
Test Epoch18 layer1 Acc 0.9218421052631579, AUC 0.9816572070121765, avg_entr 0.038561344146728516, f1 0.921842098236084
ep18_l1_test_time 0.15692782402038574
Test Epoch18 layer2 Acc 0.9218421052631579, AUC 0.9824090003967285, avg_entr 0.021635817363858223, f1 0.921842098236084
ep18_l2_test_time 0.15795016288757324
Test Epoch18 layer3 Acc 0.9205263157894736, AUC 0.9828449487686157, avg_entr 0.014727824367582798, f1 0.9205263257026672
ep18_l3_test_time 0.15932536125183105
Test Epoch18 layer4 Acc 0.9207894736842105, AUC 0.981778621673584, avg_entr 0.01358591578900814, f1 0.9207894802093506
ep18_l4_test_time 0.15965509414672852
gc 0
Train Epoch19 Acc 0.954125 (114495/120000), AUC 0.9947229623794556
ep19_train_time 10.084989070892334
Test Epoch19 layer0 Acc 0.9223684210526316, AUC 0.9820916652679443, avg_entr 0.03967423364520073, f1 0.9223684072494507
ep19_l0_test_time 0.15976691246032715
Test Epoch19 layer1 Acc 0.9221052631578948, AUC 0.98161780834198, avg_entr 0.03732343018054962, f1 0.9221052527427673
ep19_l1_test_time 0.1569528579711914
Test Epoch19 layer2 Acc 0.9202631578947369, AUC 0.982111930847168, avg_entr 0.021357839927077293, f1 0.9202631711959839
ep19_l2_test_time 0.15767502784729004
Test Epoch19 layer3 Acc 0.9210526315789473, AUC 0.9829399585723877, avg_entr 0.015683725476264954, f1 0.9210526347160339
ep19_l3_test_time 0.15909647941589355
Test Epoch19 layer4 Acc 0.9213157894736842, AUC 0.9823777675628662, avg_entr 0.0143458042293787, f1 0.9213157892227173
ep19_l4_test_time 0.16015005111694336
gc 0
Train Epoch20 Acc 0.9541916666666667 (114503/120000), AUC 0.9947713613510132
ep20_train_time 10.006149768829346
Test Epoch20 layer0 Acc 0.9218421052631579, AUC 0.9821333289146423, avg_entr 0.03877174109220505, f1 0.921842098236084
ep20_l0_test_time 0.15764117240905762
Test Epoch20 layer1 Acc 0.9218421052631579, AUC 0.9816427230834961, avg_entr 0.036525074392557144, f1 0.921842098236084
ep20_l1_test_time 0.15686392784118652
Test Epoch20 layer2 Acc 0.9210526315789473, AUC 0.9820557236671448, avg_entr 0.02036478742957115, f1 0.9210526347160339
ep20_l2_test_time 0.15906000137329102
Test Epoch20 layer3 Acc 0.9218421052631579, AUC 0.982527494430542, avg_entr 0.01440772321075201, f1 0.921842098236084
ep20_l3_test_time 0.15913105010986328
Test Epoch20 layer4 Acc 0.9213157894736842, AUC 0.9814599752426147, avg_entr 0.013310428708791733, f1 0.9213157892227173
ep20_l4_test_time 0.15932130813598633
gc 0
Train Epoch21 Acc 0.9545916666666666 (114551/120000), AUC 0.9948367476463318
ep21_train_time 10.099359273910522
Test Epoch21 layer0 Acc 0.9228947368421052, AUC 0.9821118712425232, avg_entr 0.0385560505092144, f1 0.9228947162628174
ep21_l0_test_time 0.15995001792907715
Test Epoch21 layer1 Acc 0.9210526315789473, AUC 0.9815939664840698, avg_entr 0.036120813339948654, f1 0.9210526347160339
ep21_l1_test_time 0.1589674949645996
Test Epoch21 layer2 Acc 0.9210526315789473, AUC 0.9820036292076111, avg_entr 0.0198731180280447, f1 0.9210526347160339
ep21_l2_test_time 0.15949320793151855
Test Epoch21 layer3 Acc 0.9213157894736842, AUC 0.9820493459701538, avg_entr 0.014980590902268887, f1 0.9213157892227173
ep21_l3_test_time 0.16055822372436523
Test Epoch21 layer4 Acc 0.9221052631578948, AUC 0.9809508323669434, avg_entr 0.013731897808611393, f1 0.9221052527427673
ep21_l4_test_time 0.161149263381958
gc 0
Train Epoch22 Acc 0.9548916666666667 (114587/120000), AUC 0.9948025345802307
ep22_train_time 10.132760524749756
Test Epoch22 layer0 Acc 0.9236842105263158, AUC 0.9821106195449829, avg_entr 0.03784274309873581, f1 0.9236842393875122
ep22_l0_test_time 0.1577310562133789
Test Epoch22 layer1 Acc 0.9223684210526316, AUC 0.9816029071807861, avg_entr 0.035535696893930435, f1 0.9223684072494507
ep22_l1_test_time 0.15666580200195312
Test Epoch22 layer2 Acc 0.9207894736842105, AUC 0.9821547269821167, avg_entr 0.019447041675448418, f1 0.9207894802093506
ep22_l2_test_time 0.15817689895629883
Test Epoch22 layer3 Acc 0.92, AUC 0.982891857624054, avg_entr 0.013864734210073948, f1 0.9200000166893005
ep22_l3_test_time 0.15856146812438965
Test Epoch22 layer4 Acc 0.9205263157894736, AUC 0.9818044900894165, avg_entr 0.01273133885115385, f1 0.9205263257026672
ep22_l4_test_time 0.15968012809753418
gc 0
Train Epoch23 Acc 0.9548166666666666 (114578/120000), AUC 0.9948367476463318
ep23_train_time 10.099219560623169
Test Epoch23 layer0 Acc 0.9221052631578948, AUC 0.9821183681488037, avg_entr 0.036838676780462265, f1 0.9221052527427673
ep23_l0_test_time 0.1578822135925293
Test Epoch23 layer1 Acc 0.9213157894736842, AUC 0.9815813899040222, avg_entr 0.03448694199323654, f1 0.9213157892227173
ep23_l1_test_time 0.15687108039855957
Test Epoch23 layer2 Acc 0.9210526315789473, AUC 0.9821341633796692, avg_entr 0.01924966275691986, f1 0.9210526347160339
ep23_l2_test_time 0.1576366424560547
Test Epoch23 layer3 Acc 0.921578947368421, AUC 0.9828211665153503, avg_entr 0.014068422839045525, f1 0.9215789437294006
ep23_l3_test_time 0.15894365310668945
Test Epoch23 layer4 Acc 0.921578947368421, AUC 0.9819033145904541, avg_entr 0.012820799835026264, f1 0.9215789437294006
ep23_l4_test_time 0.16000747680664062
gc 0
Train Epoch24 Acc 0.954975 (114597/120000), AUC 0.9948662519454956
ep24_train_time 10.025965213775635
Test Epoch24 layer0 Acc 0.9231578947368421, AUC 0.9820963144302368, avg_entr 0.036426007747650146, f1 0.9231578707695007
ep24_l0_test_time 0.1585676670074463
Test Epoch24 layer1 Acc 0.9218421052631579, AUC 0.9815762042999268, avg_entr 0.03416458144783974, f1 0.921842098236084
ep24_l1_test_time 0.15723490715026855
Test Epoch24 layer2 Acc 0.9207894736842105, AUC 0.9821603298187256, avg_entr 0.018589602783322334, f1 0.9207894802093506
ep24_l2_test_time 0.1594691276550293
Test Epoch24 layer3 Acc 0.9205263157894736, AUC 0.982756495475769, avg_entr 0.013460159301757812, f1 0.9205263257026672
ep24_l3_test_time 0.15913867950439453
Test Epoch24 layer4 Acc 0.9205263157894736, AUC 0.9815995693206787, avg_entr 0.012187064625322819, f1 0.9205263257026672
ep24_l4_test_time 0.15948700904846191
gc 0
Train Epoch25 Acc 0.9551166666666666 (114614/120000), AUC 0.9949225187301636
ep25_train_time 10.09307312965393
Test Epoch25 layer0 Acc 0.9236842105263158, AUC 0.9821124076843262, avg_entr 0.03642621636390686, f1 0.9236842393875122
ep25_l0_test_time 0.15940403938293457
Test Epoch25 layer1 Acc 0.9218421052631579, AUC 0.9815757274627686, avg_entr 0.03412151709198952, f1 0.921842098236084
ep25_l1_test_time 0.15684890747070312
Test Epoch25 layer2 Acc 0.9207894736842105, AUC 0.9819455146789551, avg_entr 0.018427161499857903, f1 0.9207894802093506
ep25_l2_test_time 0.1580972671508789
Test Epoch25 layer3 Acc 0.9205263157894736, AUC 0.9826297760009766, avg_entr 0.013322480954229832, f1 0.9205263257026672
ep25_l3_test_time 0.15911149978637695
Test Epoch25 layer4 Acc 0.9210526315789473, AUC 0.9813190698623657, avg_entr 0.011945569887757301, f1 0.9210526347160339
ep25_l4_test_time 0.16009235382080078
gc 0
Train Epoch26 Acc 0.95515 (114618/120000), AUC 0.9949374794960022
ep26_train_time 10.087623119354248
Test Epoch26 layer0 Acc 0.9226315789473685, AUC 0.9821105003356934, avg_entr 0.03634038195014, f1 0.922631561756134
ep26_l0_test_time 0.15893936157226562
Test Epoch26 layer1 Acc 0.9210526315789473, AUC 0.9815710783004761, avg_entr 0.03394328057765961, f1 0.9210526347160339
ep26_l1_test_time 0.15642309188842773
Test Epoch26 layer2 Acc 0.9213157894736842, AUC 0.9821947813034058, avg_entr 0.01827564463019371, f1 0.9213157892227173
ep26_l2_test_time 0.1578502655029297
Test Epoch26 layer3 Acc 0.9207894736842105, AUC 0.9830230474472046, avg_entr 0.013612976297736168, f1 0.9207894802093506
ep26_l3_test_time 0.15967583656311035
Test Epoch26 layer4 Acc 0.9207894736842105, AUC 0.9818477630615234, avg_entr 0.012083268724381924, f1 0.9207894802093506
ep26_l4_test_time 0.15992140769958496
gc 0
Train Epoch27 Acc 0.9551166666666666 (114614/120000), AUC 0.994949460029602
ep27_train_time 10.086455345153809
Test Epoch27 layer0 Acc 0.9234210526315789, AUC 0.9821165204048157, avg_entr 0.03601011261343956, f1 0.9234210252761841
ep27_l0_test_time 0.15923523902893066
Test Epoch27 layer1 Acc 0.9213157894736842, AUC 0.9815689325332642, avg_entr 0.0336003340780735, f1 0.9213157892227173
ep27_l1_test_time 0.15793085098266602
Test Epoch27 layer2 Acc 0.9202631578947369, AUC 0.9819577932357788, avg_entr 0.01828860305249691, f1 0.9202631711959839
ep27_l2_test_time 0.15861272811889648
Test Epoch27 layer3 Acc 0.9213157894736842, AUC 0.9826058149337769, avg_entr 0.013521109707653522, f1 0.9213157892227173
ep27_l3_test_time 0.15853047370910645
Test Epoch27 layer4 Acc 0.9221052631578948, AUC 0.9815942049026489, avg_entr 0.012021662667393684, f1 0.9221052527427673
ep27_l4_test_time 0.15969300270080566
gc 0
Train Epoch28 Acc 0.9551833333333334 (114622/120000), AUC 0.9949561953544617
ep28_train_time 10.01964783668518
Test Epoch28 layer0 Acc 0.9231578947368421, AUC 0.9821076393127441, avg_entr 0.0355210080742836, f1 0.9231578707695007
ep28_l0_test_time 0.15796256065368652
Test Epoch28 layer1 Acc 0.9218421052631579, AUC 0.9815599918365479, avg_entr 0.03326212614774704, f1 0.921842098236084
ep28_l1_test_time 0.15617012977600098
Test Epoch28 layer2 Acc 0.9205263157894736, AUC 0.9820907115936279, avg_entr 0.017961543053388596, f1 0.9205263257026672
ep28_l2_test_time 0.15798664093017578
Test Epoch28 layer3 Acc 0.92, AUC 0.9829098582267761, avg_entr 0.013066200539469719, f1 0.9200000166893005
ep28_l3_test_time 0.1587386131286621
Test Epoch28 layer4 Acc 0.9205263157894736, AUC 0.9817646741867065, avg_entr 0.01153745036572218, f1 0.9205263257026672
ep28_l4_test_time 0.16013145446777344
gc 0
Train Epoch29 Acc 0.9552 (114624/120000), AUC 0.9949568510055542
ep29_train_time 10.042102336883545
Test Epoch29 layer0 Acc 0.9231578947368421, AUC 0.9821126461029053, avg_entr 0.03570559620857239, f1 0.9231578707695007
ep29_l0_test_time 0.15807104110717773
Test Epoch29 layer1 Acc 0.921578947368421, AUC 0.9815637469291687, avg_entr 0.033393118530511856, f1 0.9215789437294006
ep29_l1_test_time 0.15688228607177734
Test Epoch29 layer2 Acc 0.9207894736842105, AUC 0.9821072220802307, avg_entr 0.01790538802742958, f1 0.9207894802093506
ep29_l2_test_time 0.15822148323059082
Test Epoch29 layer3 Acc 0.92, AUC 0.9828256964683533, avg_entr 0.013182060793042183, f1 0.9200000166893005
ep29_l3_test_time 0.1597278118133545
Test Epoch29 layer4 Acc 0.9210526315789473, AUC 0.9816364645957947, avg_entr 0.011582654900848866, f1 0.9210526347160339
ep29_l4_test_time 0.1606600284576416
Best AUC tensor(0.9258) 7 3
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 327.9971477985382
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt
Test layer0 Acc 0.9142105263157895, AUC 0.981015145778656, avg_entr 0.06864460557699203, f1 0.9142104983329773
l0_test_time 0.15607213973999023
Test layer1 Acc 0.9142105263157895, AUC 0.98076993227005, avg_entr 0.06448180228471756, f1 0.9142104983329773
l1_test_time 0.15712380409240723
Test layer2 Acc 0.9144736842105263, AUC 0.9818621873855591, avg_entr 0.0530642494559288, f1 0.9144737124443054
l2_test_time 0.15852808952331543
Test layer3 Acc 0.9147368421052632, AUC 0.9797303676605225, avg_entr 0.032711684703826904, f1 0.9147368669509888
l3_test_time 0.15871047973632812
Test layer4 Acc 0.9144736842105263, AUC 0.9810093641281128, avg_entr 0.02798307314515114, f1 0.9144737124443054
l4_test_time 0.16010785102844238
