total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.398810625076294
Start Training
gc 0
Train Epoch0 Acc 0.6515083333333334 (78181/120000), AUC 0.8569974899291992
ep0_train_time 26.6744863986969
Test Epoch0 layer0 Acc 0.9023684210526316, AUC 0.9771484136581421, avg_entr 0.2527789771556854, f1 0.902368426322937
ep0_l0_test_time 0.32728052139282227
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9005263157894737, AUC 0.9773776531219482, avg_entr 0.2666213810443878, f1 0.9005263447761536
ep0_l1_test_time 0.326141357421875
Test Epoch0 layer2 Acc 0.9007894736842105, AUC 0.9772095680236816, avg_entr 0.23405537009239197, f1 0.9007894396781921
ep0_l2_test_time 0.3220179080963135
Test Epoch0 layer3 Acc 0.9039473684210526, AUC 0.9770511388778687, avg_entr 0.23045827448368073, f1 0.9039472937583923
ep0_l3_test_time 0.33520078659057617
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer4 Acc 0.9023684210526316, AUC 0.9771067500114441, avg_entr 0.22702562808990479, f1 0.902368426322937
ep0_l4_test_time 0.33040881156921387
gc 0
Train Epoch1 Acc 0.9168416666666667 (110021/120000), AUC 0.9814437627792358
ep1_train_time 25.352632761001587
Test Epoch1 layer0 Acc 0.9157894736842105, AUC 0.9807466268539429, avg_entr 0.14559921622276306, f1 0.9157894849777222
ep1_l0_test_time 0.32059717178344727
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9168421052631579, AUC 0.9809783697128296, avg_entr 0.14006571471691132, f1 0.9168421030044556
ep1_l1_test_time 0.32938551902770996
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9152631578947369, AUC 0.9809958934783936, avg_entr 0.13747355341911316, f1 0.9152631759643555
ep1_l2_test_time 0.3302600383758545
Test Epoch1 layer3 Acc 0.9163157894736842, AUC 0.9809482097625732, avg_entr 0.13163317739963531, f1 0.9163157939910889
ep1_l3_test_time 0.33242273330688477
Test Epoch1 layer4 Acc 0.9152631578947369, AUC 0.981181263923645, avg_entr 0.12509490549564362, f1 0.9152631759643555
ep1_l4_test_time 0.32732558250427246
gc 0
Train Epoch2 Acc 0.9266083333333334 (111193/120000), AUC 0.9856445789337158
ep2_train_time 25.353668928146362
Test Epoch2 layer0 Acc 0.9210526315789473, AUC 0.9819389581680298, avg_entr 0.11340717226266861, f1 0.9210526347160339
ep2_l0_test_time 0.327955961227417
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.9218421052631579, AUC 0.9821037650108337, avg_entr 0.10655005276203156, f1 0.921842098236084
ep2_l1_test_time 0.32830023765563965
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.921578947368421, AUC 0.9822807312011719, avg_entr 0.10530275851488113, f1 0.9215789437294006
ep2_l2_test_time 0.33370542526245117
Test Epoch2 layer3 Acc 0.9226315789473685, AUC 0.982251763343811, avg_entr 0.09752030670642853, f1 0.922631561756134
ep2_l3_test_time 0.32779431343078613
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.9218421052631579, AUC 0.9826056957244873, avg_entr 0.08766097575426102, f1 0.921842098236084
ep2_l4_test_time 0.3305943012237549
gc 0
Train Epoch3 Acc 0.9329916666666667 (111959/120000), AUC 0.9879857301712036
ep3_train_time 25.405643939971924
Test Epoch3 layer0 Acc 0.9228947368421052, AUC 0.9824966788291931, avg_entr 0.09216310828924179, f1 0.9228947162628174
ep3_l0_test_time 0.3254256248474121
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.9226315789473685, AUC 0.982553243637085, avg_entr 0.08679337799549103, f1 0.922631561756134
ep3_l1_test_time 0.32593870162963867
Test Epoch3 layer2 Acc 0.9226315789473685, AUC 0.9825735092163086, avg_entr 0.08483584970235825, f1 0.922631561756134
ep3_l2_test_time 0.333263635635376
Test Epoch3 layer3 Acc 0.9244736842105263, AUC 0.9826135635375977, avg_entr 0.07307721674442291, f1 0.9244737029075623
ep3_l3_test_time 0.32240986824035645
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.9234210526315789, AUC 0.9829634428024292, avg_entr 0.05664575845003128, f1 0.9234210252761841
ep3_l4_test_time 0.3290858268737793
gc 0
Train Epoch4 Acc 0.9372666666666667 (112472/120000), AUC 0.9894553422927856
ep4_train_time 25.332069158554077
Test Epoch4 layer0 Acc 0.9221052631578948, AUC 0.9826099276542664, avg_entr 0.07961694896221161, f1 0.9221052527427673
ep4_l0_test_time 0.3250596523284912
Test Epoch4 layer1 Acc 0.9207894736842105, AUC 0.9825696349143982, avg_entr 0.07526502758264542, f1 0.9207894802093506
ep4_l1_test_time 0.32465529441833496
Test Epoch4 layer2 Acc 0.9210526315789473, AUC 0.982703447341919, avg_entr 0.07281232625246048, f1 0.9210526347160339
ep4_l2_test_time 0.3253054618835449
Test Epoch4 layer3 Acc 0.9231578947368421, AUC 0.9829561710357666, avg_entr 0.05475592613220215, f1 0.9231578707695007
ep4_l3_test_time 0.33028292655944824
Test Epoch4 layer4 Acc 0.9210526315789473, AUC 0.9825356006622314, avg_entr 0.03751087561249733, f1 0.9210526347160339
ep4_l4_test_time 0.32793641090393066
gc 0
Train Epoch5 Acc 0.940625 (112875/120000), AUC 0.9899272918701172
ep5_train_time 25.345885753631592
Test Epoch5 layer0 Acc 0.9223684210526316, AUC 0.9827893376350403, avg_entr 0.0723978653550148, f1 0.9223684072494507
ep5_l0_test_time 0.330660343170166
Test Epoch5 layer1 Acc 0.9207894736842105, AUC 0.9827427268028259, avg_entr 0.0686575248837471, f1 0.9207894802093506
ep5_l1_test_time 0.32134079933166504
Test Epoch5 layer2 Acc 0.9218421052631579, AUC 0.982994019985199, avg_entr 0.06450594961643219, f1 0.921842098236084
ep5_l2_test_time 0.33361387252807617
Test Epoch5 layer3 Acc 0.9236842105263158, AUC 0.9828611016273499, avg_entr 0.0415167436003685, f1 0.9236842393875122
ep5_l3_test_time 0.32445597648620605
Test Epoch5 layer4 Acc 0.9244736842105263, AUC 0.9815646409988403, avg_entr 0.029921988025307655, f1 0.9244737029075623
ep5_l4_test_time 0.3276238441467285
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 5
gc 0
Train Epoch6 Acc 0.9428583333333334 (113143/120000), AUC 0.9907225966453552
ep6_train_time 25.331035614013672
Test Epoch6 layer0 Acc 0.9218421052631579, AUC 0.9826231002807617, avg_entr 0.06731170415878296, f1 0.921842098236084
ep6_l0_test_time 0.3296346664428711
Test Epoch6 layer1 Acc 0.92, AUC 0.9825775027275085, avg_entr 0.06404952704906464, f1 0.9200000166893005
ep6_l1_test_time 0.318511962890625
Test Epoch6 layer2 Acc 0.9226315789473685, AUC 0.9829124212265015, avg_entr 0.05903506278991699, f1 0.922631561756134
ep6_l2_test_time 0.3273024559020996
Test Epoch6 layer3 Acc 0.9228947368421052, AUC 0.9836689233779907, avg_entr 0.035248011350631714, f1 0.9228947162628174
ep6_l3_test_time 0.3322458267211914
Test Epoch6 layer4 Acc 0.9226315789473685, AUC 0.9827786087989807, avg_entr 0.028469771146774292, f1 0.922631561756134
ep6_l4_test_time 0.32551026344299316
gc 0
Train Epoch7 Acc 0.9448666666666666 (113384/120000), AUC 0.9916927814483643
ep7_train_time 25.293468475341797
Test Epoch7 layer0 Acc 0.9228947368421052, AUC 0.982654333114624, avg_entr 0.061879146844148636, f1 0.9228947162628174
ep7_l0_test_time 0.3320281505584717
Test Epoch7 layer1 Acc 0.9205263157894736, AUC 0.9825780987739563, avg_entr 0.05831841379404068, f1 0.9205263257026672
ep7_l1_test_time 0.32277774810791016
Test Epoch7 layer2 Acc 0.9234210526315789, AUC 0.9831257462501526, avg_entr 0.05023748055100441, f1 0.9234210252761841
ep7_l2_test_time 0.32520055770874023
Test Epoch7 layer3 Acc 0.9234210526315789, AUC 0.9834240674972534, avg_entr 0.027991510927677155, f1 0.9234210252761841
ep7_l3_test_time 0.3271641731262207
Test Epoch7 layer4 Acc 0.9236842105263158, AUC 0.9821825623512268, avg_entr 0.023930294439196587, f1 0.9236842393875122
ep7_l4_test_time 0.3326592445373535
gc 0
Train Epoch8 Acc 0.9466166666666667 (113594/120000), AUC 0.9924778342247009
ep8_train_time 25.35020685195923
Test Epoch8 layer0 Acc 0.9186842105263158, AUC 0.9824076890945435, avg_entr 0.0618499256670475, f1 0.918684184551239
ep8_l0_test_time 0.32491064071655273
Test Epoch8 layer1 Acc 0.9178947368421052, AUC 0.9821106195449829, avg_entr 0.05817524716258049, f1 0.917894721031189
ep8_l1_test_time 0.3269684314727783
Test Epoch8 layer2 Acc 0.9186842105263158, AUC 0.9824682474136353, avg_entr 0.046613432466983795, f1 0.918684184551239
ep8_l2_test_time 0.326204776763916
Test Epoch8 layer3 Acc 0.9186842105263158, AUC 0.9815890192985535, avg_entr 0.026866478845477104, f1 0.918684184551239
ep8_l3_test_time 0.32413816452026367
Test Epoch8 layer4 Acc 0.9194736842105263, AUC 0.9804538488388062, avg_entr 0.022421015426516533, f1 0.9194737076759338
ep8_l4_test_time 0.321613073348999
gc 0
Train Epoch9 Acc 0.9480916666666667 (113771/120000), AUC 0.992914617061615
ep9_train_time 25.37067937850952
Test Epoch9 layer0 Acc 0.921578947368421, AUC 0.9823240041732788, avg_entr 0.052977558225393295, f1 0.9215789437294006
ep9_l0_test_time 0.33468031883239746
Test Epoch9 layer1 Acc 0.9213157894736842, AUC 0.9821532368659973, avg_entr 0.05090426281094551, f1 0.9213157892227173
ep9_l1_test_time 0.3161492347717285
Test Epoch9 layer2 Acc 0.9205263157894736, AUC 0.9827778339385986, avg_entr 0.03708762302994728, f1 0.9205263257026672
ep9_l2_test_time 0.32512927055358887
Test Epoch9 layer3 Acc 0.9207894736842105, AUC 0.9810481667518616, avg_entr 0.021419791504740715, f1 0.9207894802093506
ep9_l3_test_time 0.32649827003479004
Test Epoch9 layer4 Acc 0.921578947368421, AUC 0.9807630777359009, avg_entr 0.018411681056022644, f1 0.9215789437294006
ep9_l4_test_time 0.3337898254394531
gc 0
Train Epoch10 Acc 0.9503083333333333 (114037/120000), AUC 0.9937108755111694
ep10_train_time 25.2924861907959
Test Epoch10 layer0 Acc 0.9231578947368421, AUC 0.982326090335846, avg_entr 0.05178018659353256, f1 0.9231578707695007
ep10_l0_test_time 0.3305668830871582
Test Epoch10 layer1 Acc 0.9223684210526316, AUC 0.9821220636367798, avg_entr 0.04949489235877991, f1 0.9223684072494507
ep10_l1_test_time 0.31780219078063965
Test Epoch10 layer2 Acc 0.9231578947368421, AUC 0.9824151396751404, avg_entr 0.033240512013435364, f1 0.9231578707695007
ep10_l2_test_time 0.3351902961730957
Test Epoch10 layer3 Acc 0.9236842105263158, AUC 0.9825071096420288, avg_entr 0.021212004125118256, f1 0.9236842393875122
ep10_l3_test_time 0.324171781539917
Test Epoch10 layer4 Acc 0.9247368421052632, AUC 0.9818336367607117, avg_entr 0.018766677007079124, f1 0.9247368574142456
ep10_l4_test_time 0.32936549186706543
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 10
gc 0
Train Epoch11 Acc 0.9506083333333334 (114073/120000), AUC 0.9937766790390015
ep11_train_time 25.320254802703857
Test Epoch11 layer0 Acc 0.921578947368421, AUC 0.9822090864181519, avg_entr 0.05041007697582245, f1 0.9215789437294006
ep11_l0_test_time 0.32888078689575195
Test Epoch11 layer1 Acc 0.9213157894736842, AUC 0.9819729924201965, avg_entr 0.048266440629959106, f1 0.9213157892227173
ep11_l1_test_time 0.3277018070220947
Test Epoch11 layer2 Acc 0.9205263157894736, AUC 0.982878565788269, avg_entr 0.031234417110681534, f1 0.9205263257026672
ep11_l2_test_time 0.33022618293762207
Test Epoch11 layer3 Acc 0.9218421052631579, AUC 0.9822319746017456, avg_entr 0.020305341109633446, f1 0.921842098236084
ep11_l3_test_time 0.3300013542175293
Test Epoch11 layer4 Acc 0.9213157894736842, AUC 0.9820130467414856, avg_entr 0.018355507403612137, f1 0.9213157892227173
ep11_l4_test_time 0.32685303688049316
gc 0
Train Epoch12 Acc 0.9519416666666667 (114233/120000), AUC 0.9940251111984253
ep12_train_time 25.351179599761963
Test Epoch12 layer0 Acc 0.921578947368421, AUC 0.9821776747703552, avg_entr 0.047680582851171494, f1 0.9215789437294006
ep12_l0_test_time 0.3312556743621826
Test Epoch12 layer1 Acc 0.921578947368421, AUC 0.9819936156272888, avg_entr 0.0459628663957119, f1 0.9215789437294006
ep12_l1_test_time 0.33146190643310547
Test Epoch12 layer2 Acc 0.9221052631578948, AUC 0.9825893044471741, avg_entr 0.02839759737253189, f1 0.9221052527427673
ep12_l2_test_time 0.33121562004089355
Test Epoch12 layer3 Acc 0.9236842105263158, AUC 0.9821585416793823, avg_entr 0.018806003034114838, f1 0.9236842393875122
ep12_l3_test_time 0.32979536056518555
Test Epoch12 layer4 Acc 0.9231578947368421, AUC 0.9815512895584106, avg_entr 0.016891729086637497, f1 0.9231578707695007
ep12_l4_test_time 0.32598161697387695
gc 0
Train Epoch13 Acc 0.9522083333333333 (114265/120000), AUC 0.9941365122795105
ep13_train_time 25.263792037963867
Test Epoch13 layer0 Acc 0.9213157894736842, AUC 0.9821051359176636, avg_entr 0.04692269116640091, f1 0.9213157892227173
ep13_l0_test_time 0.32474470138549805
Test Epoch13 layer1 Acc 0.9202631578947369, AUC 0.9819139242172241, avg_entr 0.04519928619265556, f1 0.9202631711959839
ep13_l1_test_time 0.32083678245544434
Test Epoch13 layer2 Acc 0.9205263157894736, AUC 0.9825782179832458, avg_entr 0.027766667306423187, f1 0.9205263257026672
ep13_l2_test_time 0.3330197334289551
Test Epoch13 layer3 Acc 0.9213157894736842, AUC 0.9819819927215576, avg_entr 0.02024020627140999, f1 0.9213157892227173
ep13_l3_test_time 0.32878994941711426
Test Epoch13 layer4 Acc 0.921578947368421, AUC 0.9813512563705444, avg_entr 0.0181275624781847, f1 0.9215789437294006
ep13_l4_test_time 0.3260507583618164
gc 0
Train Epoch14 Acc 0.9532583333333333 (114391/120000), AUC 0.9943745136260986
ep14_train_time 25.287086486816406
Test Epoch14 layer0 Acc 0.9213157894736842, AUC 0.9820786714553833, avg_entr 0.04468333348631859, f1 0.9213157892227173
ep14_l0_test_time 0.32422518730163574
Test Epoch14 layer1 Acc 0.9205263157894736, AUC 0.9818165302276611, avg_entr 0.0430150181055069, f1 0.9205263257026672
ep14_l1_test_time 0.3360915184020996
Test Epoch14 layer2 Acc 0.9205263157894736, AUC 0.9822458028793335, avg_entr 0.026224497705698013, f1 0.9205263257026672
ep14_l2_test_time 0.3258552551269531
Test Epoch14 layer3 Acc 0.9223684210526316, AUC 0.982278048992157, avg_entr 0.018608903512358665, f1 0.9223684072494507
ep14_l3_test_time 0.3280661106109619
Test Epoch14 layer4 Acc 0.9226315789473685, AUC 0.9810326099395752, avg_entr 0.016740484163165092, f1 0.922631561756134
ep14_l4_test_time 0.3209819793701172
gc 0
Train Epoch15 Acc 0.9536833333333333 (114442/120000), AUC 0.9944751262664795
ep15_train_time 25.301889419555664
Test Epoch15 layer0 Acc 0.9207894736842105, AUC 0.9819933176040649, avg_entr 0.04406873881816864, f1 0.9207894802093506
ep15_l0_test_time 0.3239912986755371
Test Epoch15 layer1 Acc 0.9192105263157895, AUC 0.9816553592681885, avg_entr 0.041994452476501465, f1 0.9192105531692505
ep15_l1_test_time 0.32750988006591797
Test Epoch15 layer2 Acc 0.9207894736842105, AUC 0.9819430708885193, avg_entr 0.02494298852980137, f1 0.9207894802093506
ep15_l2_test_time 0.31800413131713867
Test Epoch15 layer3 Acc 0.9197368421052632, AUC 0.9822430610656738, avg_entr 0.01654536835849285, f1 0.9197368621826172
ep15_l3_test_time 0.32922792434692383
Test Epoch15 layer4 Acc 0.9205263157894736, AUC 0.9807717204093933, avg_entr 0.015095631591975689, f1 0.9205263257026672
ep15_l4_test_time 0.3304102420806885
gc 0
Train Epoch16 Acc 0.953675 (114441/120000), AUC 0.9945544004440308
ep16_train_time 25.340471744537354
Test Epoch16 layer0 Acc 0.9197368421052632, AUC 0.9819772839546204, avg_entr 0.04350629448890686, f1 0.9197368621826172
ep16_l0_test_time 0.3171992301940918
Test Epoch16 layer1 Acc 0.9192105263157895, AUC 0.9816164970397949, avg_entr 0.04161577299237251, f1 0.9192105531692505
ep16_l1_test_time 0.3224644660949707
Test Epoch16 layer2 Acc 0.9189473684210526, AUC 0.9822492003440857, avg_entr 0.02399442158639431, f1 0.9189472794532776
ep16_l2_test_time 0.3283374309539795
Test Epoch16 layer3 Acc 0.9192105263157895, AUC 0.9822116494178772, avg_entr 0.01645096205174923, f1 0.9192105531692505
ep16_l3_test_time 0.3261563777923584
Test Epoch16 layer4 Acc 0.92, AUC 0.9810999631881714, avg_entr 0.015258817002177238, f1 0.9200000166893005
ep16_l4_test_time 0.32977867126464844
gc 0
Train Epoch17 Acc 0.954175 (114501/120000), AUC 0.9945721626281738
ep17_train_time 25.331599235534668
Test Epoch17 layer0 Acc 0.9207894736842105, AUC 0.9819045066833496, avg_entr 0.04018879309296608, f1 0.9207894802093506
ep17_l0_test_time 0.3298666477203369
Test Epoch17 layer1 Acc 0.9205263157894736, AUC 0.9816038012504578, avg_entr 0.038828689604997635, f1 0.9205263257026672
ep17_l1_test_time 0.324373722076416
Test Epoch17 layer2 Acc 0.9210526315789473, AUC 0.9816383123397827, avg_entr 0.02286703884601593, f1 0.9210526347160339
ep17_l2_test_time 0.3255460262298584
Test Epoch17 layer3 Acc 0.9221052631578948, AUC 0.9818152785301208, avg_entr 0.016045674681663513, f1 0.9221052527427673
ep17_l3_test_time 0.32440638542175293
Test Epoch17 layer4 Acc 0.9221052631578948, AUC 0.980452835559845, avg_entr 0.014560038223862648, f1 0.9221052527427673
ep17_l4_test_time 0.32973384857177734
gc 0
Train Epoch18 Acc 0.9544833333333334 (114538/120000), AUC 0.9947405457496643
ep18_train_time 25.254754543304443
Test Epoch18 layer0 Acc 0.9213157894736842, AUC 0.981891393661499, avg_entr 0.040432143956422806, f1 0.9213157892227173
ep18_l0_test_time 0.325122594833374
Test Epoch18 layer1 Acc 0.9194736842105263, AUC 0.9815545082092285, avg_entr 0.0388680063188076, f1 0.9194737076759338
ep18_l1_test_time 0.3267507553100586
Test Epoch18 layer2 Acc 0.9197368421052632, AUC 0.98170006275177, avg_entr 0.022257167845964432, f1 0.9197368621826172
ep18_l2_test_time 0.3302748203277588
Test Epoch18 layer3 Acc 0.9197368421052632, AUC 0.9823116064071655, avg_entr 0.01612688973546028, f1 0.9197368621826172
ep18_l3_test_time 0.3311467170715332
Test Epoch18 layer4 Acc 0.9202631578947369, AUC 0.9810749292373657, avg_entr 0.01498777512460947, f1 0.9202631711959839
ep18_l4_test_time 0.3313267230987549
gc 0
Train Epoch19 Acc 0.9548333333333333 (114580/120000), AUC 0.9947217702865601
ep19_train_time 25.395491361618042
Test Epoch19 layer0 Acc 0.9205263157894736, AUC 0.9819126129150391, avg_entr 0.039360057562589645, f1 0.9205263257026672
ep19_l0_test_time 0.3303382396697998
Test Epoch19 layer1 Acc 0.9197368421052632, AUC 0.9815222024917603, avg_entr 0.03787928447127342, f1 0.9197368621826172
ep19_l1_test_time 0.3193964958190918
Test Epoch19 layer2 Acc 0.9189473684210526, AUC 0.9814984798431396, avg_entr 0.02155228704214096, f1 0.9189472794532776
ep19_l2_test_time 0.32607507705688477
Test Epoch19 layer3 Acc 0.9205263157894736, AUC 0.9817342758178711, avg_entr 0.01567596010863781, f1 0.9205263257026672
ep19_l3_test_time 0.3238711357116699
Test Epoch19 layer4 Acc 0.9207894736842105, AUC 0.9808051586151123, avg_entr 0.014483906328678131, f1 0.9207894802093506
ep19_l4_test_time 0.3242061138153076
gc 0
Train Epoch20 Acc 0.9551166666666666 (114614/120000), AUC 0.9947989583015442
ep20_train_time 25.3071129322052
Test Epoch20 layer0 Acc 0.9218421052631579, AUC 0.9819306135177612, avg_entr 0.0379006527364254, f1 0.921842098236084
ep20_l0_test_time 0.32653284072875977
Test Epoch20 layer1 Acc 0.9210526315789473, AUC 0.9815810322761536, avg_entr 0.03651845455169678, f1 0.9210526347160339
ep20_l1_test_time 0.32369041442871094
Test Epoch20 layer2 Acc 0.9197368421052632, AUC 0.981914758682251, avg_entr 0.02096569910645485, f1 0.9197368621826172
ep20_l2_test_time 0.33021020889282227
Test Epoch20 layer3 Acc 0.9197368421052632, AUC 0.9821291565895081, avg_entr 0.015126810409128666, f1 0.9197368621826172
ep20_l3_test_time 0.3201885223388672
Test Epoch20 layer4 Acc 0.9202631578947369, AUC 0.9806538224220276, avg_entr 0.014078938402235508, f1 0.9202631711959839
ep20_l4_test_time 0.33556199073791504
gc 0
Train Epoch21 Acc 0.9549 (114588/120000), AUC 0.9947764873504639
ep21_train_time 25.288386583328247
Test Epoch21 layer0 Acc 0.9207894736842105, AUC 0.9818786382675171, avg_entr 0.03752373903989792, f1 0.9207894802093506
ep21_l0_test_time 0.3115396499633789
Test Epoch21 layer1 Acc 0.92, AUC 0.9815075397491455, avg_entr 0.036112625151872635, f1 0.9200000166893005
ep21_l1_test_time 0.31694889068603516
Test Epoch21 layer2 Acc 0.9189473684210526, AUC 0.9815794229507446, avg_entr 0.020456459373235703, f1 0.9189472794532776
ep21_l2_test_time 0.31749486923217773
Test Epoch21 layer3 Acc 0.9205263157894736, AUC 0.9818949699401855, avg_entr 0.014936101622879505, f1 0.9205263257026672
ep21_l3_test_time 0.3164551258087158
Test Epoch21 layer4 Acc 0.9202631578947369, AUC 0.9806410670280457, avg_entr 0.013903343118727207, f1 0.9202631711959839
ep21_l4_test_time 0.3299694061279297
gc 0
Train Epoch22 Acc 0.9553 (114636/120000), AUC 0.9948732852935791
ep22_train_time 25.358484745025635
Test Epoch22 layer0 Acc 0.9210526315789473, AUC 0.9818841218948364, avg_entr 0.037324223667383194, f1 0.9210526347160339
ep22_l0_test_time 0.3274857997894287
Test Epoch22 layer1 Acc 0.9192105263157895, AUC 0.9814937114715576, avg_entr 0.03590533137321472, f1 0.9192105531692505
ep22_l1_test_time 0.3273658752441406
Test Epoch22 layer2 Acc 0.9192105263157895, AUC 0.9814496040344238, avg_entr 0.02010870911180973, f1 0.9192105531692505
ep22_l2_test_time 0.33101987838745117
Test Epoch22 layer3 Acc 0.9202631578947369, AUC 0.9818861484527588, avg_entr 0.014815689995884895, f1 0.9202631711959839
ep22_l3_test_time 0.33076906204223633
Test Epoch22 layer4 Acc 0.9202631578947369, AUC 0.9804275631904602, avg_entr 0.013834184035658836, f1 0.9202631711959839
ep22_l4_test_time 0.3333861827850342
gc 0
Train Epoch23 Acc 0.955325 (114639/120000), AUC 0.994858980178833
ep23_train_time 25.33704376220703
Test Epoch23 layer0 Acc 0.9218421052631579, AUC 0.9818891882896423, avg_entr 0.03679031506180763, f1 0.921842098236084
ep23_l0_test_time 0.3315091133117676
Test Epoch23 layer1 Acc 0.9207894736842105, AUC 0.9814935326576233, avg_entr 0.035385508090257645, f1 0.9207894802093506
ep23_l1_test_time 0.3241877555847168
Test Epoch23 layer2 Acc 0.9178947368421052, AUC 0.9817471504211426, avg_entr 0.01989496313035488, f1 0.917894721031189
ep23_l2_test_time 0.3290574550628662
Test Epoch23 layer3 Acc 0.9207894736842105, AUC 0.9820396900177002, avg_entr 0.014802915044128895, f1 0.9207894802093506
ep23_l3_test_time 0.3225362300872803
Test Epoch23 layer4 Acc 0.9197368421052632, AUC 0.9811697602272034, avg_entr 0.013779330998659134, f1 0.9197368621826172
ep23_l4_test_time 0.3310122489929199
gc 0
Train Epoch24 Acc 0.9552583333333333 (114631/120000), AUC 0.9948247075080872
ep24_train_time 25.3462553024292
Test Epoch24 layer0 Acc 0.9213157894736842, AUC 0.9818752408027649, avg_entr 0.03613340109586716, f1 0.9213157892227173
ep24_l0_test_time 0.3305530548095703
Test Epoch24 layer1 Acc 0.9205263157894736, AUC 0.9814568758010864, avg_entr 0.03468086197972298, f1 0.9205263257026672
ep24_l1_test_time 0.32488512992858887
Test Epoch24 layer2 Acc 0.9192105263157895, AUC 0.9815020561218262, avg_entr 0.019611187279224396, f1 0.9192105531692505
ep24_l2_test_time 0.33449888229370117
Test Epoch24 layer3 Acc 0.9202631578947369, AUC 0.9818622469902039, avg_entr 0.014179968275129795, f1 0.9202631711959839
ep24_l3_test_time 0.3240625858306885
Test Epoch24 layer4 Acc 0.9205263157894736, AUC 0.9804205894470215, avg_entr 0.01317072194069624, f1 0.9205263257026672
ep24_l4_test_time 0.3288583755493164
gc 0
Train Epoch25 Acc 0.9554583333333333 (114655/120000), AUC 0.9948652982711792
ep25_train_time 25.36027216911316
Test Epoch25 layer0 Acc 0.9207894736842105, AUC 0.9818731546401978, avg_entr 0.036395926028490067, f1 0.9207894802093506
ep25_l0_test_time 0.3246328830718994
Test Epoch25 layer1 Acc 0.9189473684210526, AUC 0.9814714193344116, avg_entr 0.03490220382809639, f1 0.9189472794532776
ep25_l1_test_time 0.3212625980377197
Test Epoch25 layer2 Acc 0.9192105263157895, AUC 0.9815160036087036, avg_entr 0.019330250099301338, f1 0.9192105531692505
ep25_l2_test_time 0.3283255100250244
Test Epoch25 layer3 Acc 0.9189473684210526, AUC 0.9816902279853821, avg_entr 0.014178326353430748, f1 0.9189472794532776
ep25_l3_test_time 0.3332481384277344
Test Epoch25 layer4 Acc 0.9192105263157895, AUC 0.9801222681999207, avg_entr 0.013350339606404305, f1 0.9192105531692505
ep25_l4_test_time 0.3288452625274658
gc 0
Train Epoch26 Acc 0.9556583333333334 (114679/120000), AUC 0.9949315190315247
ep26_train_time 25.38099956512451
Test Epoch26 layer0 Acc 0.9205263157894736, AUC 0.9818640947341919, avg_entr 0.036064885556697845, f1 0.9205263257026672
ep26_l0_test_time 0.331174373626709
Test Epoch26 layer1 Acc 0.9189473684210526, AUC 0.9814661741256714, avg_entr 0.03457506373524666, f1 0.9189472794532776
ep26_l1_test_time 0.32386326789855957
Test Epoch26 layer2 Acc 0.9189473684210526, AUC 0.9815840125083923, avg_entr 0.019204676151275635, f1 0.9189472794532776
ep26_l2_test_time 0.3341858386993408
Test Epoch26 layer3 Acc 0.9189473684210526, AUC 0.9819858074188232, avg_entr 0.014109895564615726, f1 0.9189472794532776
ep26_l3_test_time 0.32292771339416504
Test Epoch26 layer4 Acc 0.9192105263157895, AUC 0.9805439710617065, avg_entr 0.013270605355501175, f1 0.9192105531692505
ep26_l4_test_time 0.3289346694946289
gc 0
Train Epoch27 Acc 0.9555583333333333 (114667/120000), AUC 0.9949520826339722
ep27_train_time 25.347400426864624
Test Epoch27 layer0 Acc 0.9207894736842105, AUC 0.9818665981292725, avg_entr 0.03580618277192116, f1 0.9207894802093506
ep27_l0_test_time 0.33143138885498047
Test Epoch27 layer1 Acc 0.9192105263157895, AUC 0.9814526438713074, avg_entr 0.03431163728237152, f1 0.9192105531692505
ep27_l1_test_time 0.323411226272583
Test Epoch27 layer2 Acc 0.9184210526315789, AUC 0.9816012382507324, avg_entr 0.01902010478079319, f1 0.9184210896492004
ep27_l2_test_time 0.3329660892486572
Test Epoch27 layer3 Acc 0.9197368421052632, AUC 0.9820840358734131, avg_entr 0.01393819972872734, f1 0.9197368621826172
ep27_l3_test_time 0.32976579666137695
Test Epoch27 layer4 Acc 0.9194736842105263, AUC 0.980708122253418, avg_entr 0.01304006576538086, f1 0.9194737076759338
ep27_l4_test_time 0.33261799812316895
gc 0
Train Epoch28 Acc 0.9555166666666667 (114662/120000), AUC 0.9949309825897217
ep28_train_time 25.366302013397217
Test Epoch28 layer0 Acc 0.921578947368421, AUC 0.981865644454956, avg_entr 0.035348307341337204, f1 0.9215789437294006
ep28_l0_test_time 0.3164174556732178
Test Epoch28 layer1 Acc 0.9205263157894736, AUC 0.9814610481262207, avg_entr 0.03383157402276993, f1 0.9205263257026672
ep28_l1_test_time 0.3275146484375
Test Epoch28 layer2 Acc 0.92, AUC 0.9815315008163452, avg_entr 0.019004113972187042, f1 0.9200000166893005
ep28_l2_test_time 0.3345487117767334
Test Epoch28 layer3 Acc 0.9202631578947369, AUC 0.9817997217178345, avg_entr 0.013593077659606934, f1 0.9202631711959839
ep28_l3_test_time 0.3266627788543701
Test Epoch28 layer4 Acc 0.9202631578947369, AUC 0.9803981781005859, avg_entr 0.012611650861799717, f1 0.9202631711959839
ep28_l4_test_time 0.32867980003356934
gc 0
Train Epoch29 Acc 0.9556583333333334 (114679/120000), AUC 0.9949404001235962
ep29_train_time 25.282920122146606
Test Epoch29 layer0 Acc 0.9207894736842105, AUC 0.9818560481071472, avg_entr 0.03551216050982475, f1 0.9207894802093506
ep29_l0_test_time 0.33125877380371094
Test Epoch29 layer1 Acc 0.9194736842105263, AUC 0.9814328551292419, avg_entr 0.03398619219660759, f1 0.9194737076759338
ep29_l1_test_time 0.32502102851867676
Test Epoch29 layer2 Acc 0.9186842105263158, AUC 0.9814345240592957, avg_entr 0.018829625099897385, f1 0.918684184551239
ep29_l2_test_time 0.32698893547058105
Test Epoch29 layer3 Acc 0.9194736842105263, AUC 0.9816235303878784, avg_entr 0.013692636974155903, f1 0.9194737076759338
ep29_l3_test_time 0.3301072120666504
Test Epoch29 layer4 Acc 0.9194736842105263, AUC 0.9800832271575928, avg_entr 0.012828996405005455, f1 0.9194737076759338
ep29_l4_test_time 0.3304409980773926
Best AUC tensor(0.9247) 10 4
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 812.7100625038147
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt
Test layer0 Acc 0.9126315789473685, AUC 0.9808627963066101, avg_entr 0.057599831372499466, f1 0.9126315712928772
l0_test_time 0.32700443267822266
Test layer1 Acc 0.9131578947368421, AUC 0.9805058836936951, avg_entr 0.05457918345928192, f1 0.9131578803062439
l1_test_time 0.3332703113555908
Test layer2 Acc 0.9107894736842105, AUC 0.9815471768379211, avg_entr 0.03826139494776726, f1 0.9107894897460938
l2_test_time 0.33323073387145996
Test layer3 Acc 0.9107894736842105, AUC 0.980326235294342, avg_entr 0.025011025369167328, f1 0.9107894897460938
l3_test_time 0.3306286334991455
Test layer4 Acc 0.911578947368421, AUC 0.980421781539917, avg_entr 0.022343609482049942, f1 0.9115789532661438
l4_test_time 0.3324737548828125
