total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 20.66438937187195
Start Training
gc 0
Train Epoch0 Acc 0.6640583333333333 (79687/120000), AUC 0.8656729459762573
ep0_train_time 26.855069875717163
Test Epoch0 layer0 Acc 0.9026315789473685, AUC 0.9768902063369751, avg_entr 0.2542359530925751, f1 0.9026315808296204
ep0_l0_test_time 0.3242378234863281
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9021052631578947, AUC 0.9769608378410339, avg_entr 0.2690489888191223, f1 0.9021052718162537
ep0_l1_test_time 0.32718896865844727
Test Epoch0 layer2 Acc 0.9021052631578947, AUC 0.9768272638320923, avg_entr 0.22959032654762268, f1 0.9021052718162537
ep0_l2_test_time 0.3235042095184326
Test Epoch0 layer3 Acc 0.9031578947368422, AUC 0.9769590497016907, avg_entr 0.22675153613090515, f1 0.9031578898429871
ep0_l3_test_time 0.32949233055114746
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer4 Acc 0.9047368421052632, AUC 0.9773765802383423, avg_entr 0.21969234943389893, f1 0.9047367572784424
ep0_l4_test_time 0.3287539482116699
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.9170666666666667 (110048/120000), AUC 0.9816341400146484
ep1_train_time 25.567359685897827
Test Epoch1 layer0 Acc 0.9197368421052632, AUC 0.9803365468978882, avg_entr 0.14643707871437073, f1 0.9197368621826172
ep1_l0_test_time 0.3341031074523926
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9194736842105263, AUC 0.980415403842926, avg_entr 0.1392563283443451, f1 0.9194737076759338
ep1_l1_test_time 0.32367873191833496
Test Epoch1 layer2 Acc 0.9197368421052632, AUC 0.9802784323692322, avg_entr 0.13445107638835907, f1 0.9197368621826172
ep1_l2_test_time 0.3345222473144531
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.9178947368421052, AUC 0.9805004596710205, avg_entr 0.12921956181526184, f1 0.917894721031189
ep1_l3_test_time 0.32700037956237793
Test Epoch1 layer4 Acc 0.9186842105263158, AUC 0.9811848402023315, avg_entr 0.12129469960927963, f1 0.918684184551239
ep1_l4_test_time 0.3355123996734619
gc 0
Train Epoch2 Acc 0.9272166666666667 (111266/120000), AUC 0.9858677387237549
ep2_train_time 25.57864809036255
Test Epoch2 layer0 Acc 0.916578947368421, AUC 0.9815057516098022, avg_entr 0.11288128048181534, f1 0.9165789484977722
ep2_l0_test_time 0.33051156997680664
Test Epoch2 layer1 Acc 0.9181578947368421, AUC 0.9815483093261719, avg_entr 0.10500945895910263, f1 0.9181578755378723
ep2_l1_test_time 0.33043837547302246
Test Epoch2 layer2 Acc 0.9181578947368421, AUC 0.981627345085144, avg_entr 0.10428348183631897, f1 0.9181578755378723
ep2_l2_test_time 0.3247799873352051
Test Epoch2 layer3 Acc 0.9189473684210526, AUC 0.9816616773605347, avg_entr 0.09605050086975098, f1 0.9189472794532776
ep2_l3_test_time 0.32767462730407715
Test Epoch2 layer4 Acc 0.9176315789473685, AUC 0.9823459982872009, avg_entr 0.08214934170246124, f1 0.9176315665245056
ep2_l4_test_time 0.33071208000183105
gc 0
Train Epoch3 Acc 0.9332166666666667 (111986/120000), AUC 0.9882000684738159
ep3_train_time 25.52034640312195
Test Epoch3 layer0 Acc 0.9202631578947369, AUC 0.9822870492935181, avg_entr 0.0922115296125412, f1 0.9202631711959839
ep3_l0_test_time 0.33633947372436523
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.9218421052631579, AUC 0.982347309589386, avg_entr 0.08582498133182526, f1 0.921842098236084
ep3_l1_test_time 0.33058905601501465
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.9213157894736842, AUC 0.9826483726501465, avg_entr 0.084151990711689, f1 0.9213157892227173
ep3_l2_test_time 0.33084940910339355
Test Epoch3 layer3 Acc 0.9228947368421052, AUC 0.982894241809845, avg_entr 0.07168758660554886, f1 0.9228947162628174
ep3_l3_test_time 0.33681535720825195
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.9223684210526316, AUC 0.982994794845581, avg_entr 0.0527351051568985, f1 0.9223684072494507
ep3_l4_test_time 0.3320291042327881
gc 0
Train Epoch4 Acc 0.93755 (112506/120000), AUC 0.9895726442337036
ep4_train_time 25.51274561882019
Test Epoch4 layer0 Acc 0.9207894736842105, AUC 0.9825132489204407, avg_entr 0.07937227934598923, f1 0.9207894802093506
ep4_l0_test_time 0.33218932151794434
Test Epoch4 layer1 Acc 0.921578947368421, AUC 0.9824770092964172, avg_entr 0.07385899126529694, f1 0.9215789437294006
ep4_l1_test_time 0.32773542404174805
Test Epoch4 layer2 Acc 0.9223684210526316, AUC 0.9826855659484863, avg_entr 0.0713736042380333, f1 0.9223684072494507
ep4_l2_test_time 0.3307764530181885
Test Epoch4 layer3 Acc 0.9242105263157895, AUC 0.9834738373756409, avg_entr 0.054630015045404434, f1 0.9242105484008789
ep4_l3_test_time 0.3238410949707031
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 4
Test Epoch4 layer4 Acc 0.925, AUC 0.9836540222167969, avg_entr 0.036842089146375656, f1 0.925000011920929
ep4_l4_test_time 0.33066606521606445
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 4
gc 0
Train Epoch5 Acc 0.9412 (112944/120000), AUC 0.9903480410575867
ep5_train_time 25.541296005249023
Test Epoch5 layer0 Acc 0.9210526315789473, AUC 0.9825471639633179, avg_entr 0.07091612368822098, f1 0.9210526347160339
ep5_l0_test_time 0.3237795829772949
Test Epoch5 layer1 Acc 0.9210526315789473, AUC 0.9824877381324768, avg_entr 0.06683790683746338, f1 0.9210526347160339
ep5_l1_test_time 0.3294847011566162
Test Epoch5 layer2 Acc 0.9231578947368421, AUC 0.982685387134552, avg_entr 0.0628197193145752, f1 0.9231578707695007
ep5_l2_test_time 0.3221101760864258
Test Epoch5 layer3 Acc 0.9234210526315789, AUC 0.9825431108474731, avg_entr 0.04075527563691139, f1 0.9234210252761841
ep5_l3_test_time 0.33082151412963867
Test Epoch5 layer4 Acc 0.9234210526315789, AUC 0.9815709590911865, avg_entr 0.028887586668133736, f1 0.9234210252761841
ep5_l4_test_time 0.3332328796386719
gc 0
Train Epoch6 Acc 0.9430333333333333 (113164/120000), AUC 0.9910929799079895
ep6_train_time 25.575294256210327
Test Epoch6 layer0 Acc 0.9210526315789473, AUC 0.9826319217681885, avg_entr 0.06662853807210922, f1 0.9210526347160339
ep6_l0_test_time 0.32414698600769043
Test Epoch6 layer1 Acc 0.9228947368421052, AUC 0.9825626611709595, avg_entr 0.06207895651459694, f1 0.9228947162628174
ep6_l1_test_time 0.324354887008667
Test Epoch6 layer2 Acc 0.9236842105263158, AUC 0.9830036759376526, avg_entr 0.056658580899238586, f1 0.9236842393875122
ep6_l2_test_time 0.33188962936401367
Test Epoch6 layer3 Acc 0.9226315789473685, AUC 0.9818994402885437, avg_entr 0.03475721552968025, f1 0.922631561756134
ep6_l3_test_time 0.3293783664703369
Test Epoch6 layer4 Acc 0.9226315789473685, AUC 0.9788957238197327, avg_entr 0.02755725011229515, f1 0.922631561756134
ep6_l4_test_time 0.32682037353515625
gc 0
Train Epoch7 Acc 0.9451 (113412/120000), AUC 0.9918370842933655
ep7_train_time 25.49103593826294
Test Epoch7 layer0 Acc 0.921578947368421, AUC 0.9824000000953674, avg_entr 0.06200452148914337, f1 0.9215789437294006
ep7_l0_test_time 0.32758450508117676
Test Epoch7 layer1 Acc 0.9218421052631579, AUC 0.9822747707366943, avg_entr 0.057587288320064545, f1 0.921842098236084
ep7_l1_test_time 0.3337252140045166
Test Epoch7 layer2 Acc 0.9231578947368421, AUC 0.983082115650177, avg_entr 0.04750016704201698, f1 0.9231578707695007
ep7_l2_test_time 0.333756685256958
Test Epoch7 layer3 Acc 0.9213157894736842, AUC 0.9828058481216431, avg_entr 0.02786979265511036, f1 0.9213157892227173
ep7_l3_test_time 0.3338949680328369
Test Epoch7 layer4 Acc 0.9223684210526316, AUC 0.9819768667221069, avg_entr 0.022935763001441956, f1 0.9223684072494507
ep7_l4_test_time 0.32987451553344727
gc 0
Train Epoch8 Acc 0.9471666666666667 (113660/120000), AUC 0.9924493432044983
ep8_train_time 25.545948028564453
Test Epoch8 layer0 Acc 0.9205263157894736, AUC 0.9823555946350098, avg_entr 0.05717726796865463, f1 0.9205263257026672
ep8_l0_test_time 0.3279259204864502
Test Epoch8 layer1 Acc 0.9210526315789473, AUC 0.9822666645050049, avg_entr 0.05318712815642357, f1 0.9210526347160339
ep8_l1_test_time 0.324873685836792
Test Epoch8 layer2 Acc 0.9226315789473685, AUC 0.983119547367096, avg_entr 0.04052725061774254, f1 0.922631561756134
ep8_l2_test_time 0.3327038288116455
Test Epoch8 layer3 Acc 0.9221052631578948, AUC 0.9824264049530029, avg_entr 0.024860622361302376, f1 0.9221052527427673
ep8_l3_test_time 0.32927751541137695
Test Epoch8 layer4 Acc 0.9228947368421052, AUC 0.981025218963623, avg_entr 0.02136719785630703, f1 0.9228947162628174
ep8_l4_test_time 0.3235950469970703
gc 0
Train Epoch9 Acc 0.9486083333333334 (113833/120000), AUC 0.9930362701416016
ep9_train_time 25.506712675094604
Test Epoch9 layer0 Acc 0.9207894736842105, AUC 0.9822607040405273, avg_entr 0.05361483618617058, f1 0.9207894802093506
ep9_l0_test_time 0.33043718338012695
Test Epoch9 layer1 Acc 0.9213157894736842, AUC 0.9821291565895081, avg_entr 0.05075624957680702, f1 0.9213157892227173
ep9_l1_test_time 0.33292698860168457
Test Epoch9 layer2 Acc 0.9213157894736842, AUC 0.9832947254180908, avg_entr 0.0353531613945961, f1 0.9213157892227173
ep9_l2_test_time 0.32482242584228516
Test Epoch9 layer3 Acc 0.9205263157894736, AUC 0.9818747639656067, avg_entr 0.02272544987499714, f1 0.9205263257026672
ep9_l3_test_time 0.33326220512390137
Test Epoch9 layer4 Acc 0.9210526315789473, AUC 0.9810298085212708, avg_entr 0.019780807197093964, f1 0.9210526347160339
ep9_l4_test_time 0.3268747329711914
gc 0
Train Epoch10 Acc 0.9497333333333333 (113968/120000), AUC 0.9932329654693604
ep10_train_time 25.57692551612854
Test Epoch10 layer0 Acc 0.9202631578947369, AUC 0.982061505317688, avg_entr 0.05041780695319176, f1 0.9202631711959839
ep10_l0_test_time 0.32682108879089355
Test Epoch10 layer1 Acc 0.9202631578947369, AUC 0.9819008111953735, avg_entr 0.04736378416419029, f1 0.9202631711959839
ep10_l1_test_time 0.3224153518676758
Test Epoch10 layer2 Acc 0.9213157894736842, AUC 0.9825010895729065, avg_entr 0.03121442161500454, f1 0.9213157892227173
ep10_l2_test_time 0.3351876735687256
Test Epoch10 layer3 Acc 0.9228947368421052, AUC 0.9808956384658813, avg_entr 0.020563092082738876, f1 0.9228947162628174
ep10_l3_test_time 0.3176908493041992
Test Epoch10 layer4 Acc 0.9221052631578948, AUC 0.9806199073791504, avg_entr 0.018075788393616676, f1 0.9221052527427673
ep10_l4_test_time 0.329282283782959
gc 0
Train Epoch11 Acc 0.9513416666666666 (114161/120000), AUC 0.9937671422958374
ep11_train_time 25.535887002944946
Test Epoch11 layer0 Acc 0.921578947368421, AUC 0.9820916056632996, avg_entr 0.049422893673181534, f1 0.9215789437294006
ep11_l0_test_time 0.32599306106567383
Test Epoch11 layer1 Acc 0.9213157894736842, AUC 0.9819047451019287, avg_entr 0.046264637261629105, f1 0.9213157892227173
ep11_l1_test_time 0.32761454582214355
Test Epoch11 layer2 Acc 0.9210526315789473, AUC 0.983180820941925, avg_entr 0.02900746837258339, f1 0.9210526347160339
ep11_l2_test_time 0.33133721351623535
Test Epoch11 layer3 Acc 0.9226315789473685, AUC 0.9815733432769775, avg_entr 0.02013855054974556, f1 0.922631561756134
ep11_l3_test_time 0.3276939392089844
Test Epoch11 layer4 Acc 0.9226315789473685, AUC 0.9808977842330933, avg_entr 0.01834702119231224, f1 0.922631561756134
ep11_l4_test_time 0.3284125328063965
gc 0
Train Epoch12 Acc 0.952275 (114273/120000), AUC 0.993904709815979
ep12_train_time 25.567830324172974
Test Epoch12 layer0 Acc 0.921578947368421, AUC 0.982009768486023, avg_entr 0.04804529994726181, f1 0.9215789437294006
ep12_l0_test_time 0.3320493698120117
Test Epoch12 layer1 Acc 0.9213157894736842, AUC 0.981820285320282, avg_entr 0.0449509434401989, f1 0.9213157892227173
ep12_l1_test_time 0.3318748474121094
Test Epoch12 layer2 Acc 0.9205263157894736, AUC 0.9827679991722107, avg_entr 0.026784608140587807, f1 0.9205263257026672
ep12_l2_test_time 0.32387351989746094
Test Epoch12 layer3 Acc 0.921578947368421, AUC 0.9821207523345947, avg_entr 0.019449947401881218, f1 0.9215789437294006
ep12_l3_test_time 0.33281731605529785
Test Epoch12 layer4 Acc 0.9207894736842105, AUC 0.9802161455154419, avg_entr 0.017699573189020157, f1 0.9207894802093506
ep12_l4_test_time 0.32755565643310547
gc 0
Train Epoch13 Acc 0.95255 (114306/120000), AUC 0.9941189289093018
ep13_train_time 25.507696866989136
Test Epoch13 layer0 Acc 0.9184210526315789, AUC 0.9819019436836243, avg_entr 0.04706700146198273, f1 0.9184210896492004
ep13_l0_test_time 0.3294191360473633
Test Epoch13 layer1 Acc 0.9184210526315789, AUC 0.9816690683364868, avg_entr 0.043698377907276154, f1 0.9184210896492004
ep13_l1_test_time 0.3288404941558838
Test Epoch13 layer2 Acc 0.9176315789473685, AUC 0.9826810956001282, avg_entr 0.025180859491229057, f1 0.9176315665245056
ep13_l2_test_time 0.32361364364624023
Test Epoch13 layer3 Acc 0.9192105263157895, AUC 0.9820836782455444, avg_entr 0.018829451873898506, f1 0.9192105531692505
ep13_l3_test_time 0.33280205726623535
Test Epoch13 layer4 Acc 0.9194736842105263, AUC 0.9808242321014404, avg_entr 0.01767151430249214, f1 0.9194737076759338
ep13_l4_test_time 0.331646203994751
gc 0
Train Epoch14 Acc 0.95325 (114390/120000), AUC 0.9942405819892883
ep14_train_time 25.534688472747803
Test Epoch14 layer0 Acc 0.9205263157894736, AUC 0.9818319082260132, avg_entr 0.0440620593726635, f1 0.9205263257026672
ep14_l0_test_time 0.32553553581237793
Test Epoch14 layer1 Acc 0.9205263157894736, AUC 0.9816227555274963, avg_entr 0.041195180267095566, f1 0.9205263257026672
ep14_l1_test_time 0.32793354988098145
Test Epoch14 layer2 Acc 0.92, AUC 0.9823293685913086, avg_entr 0.024417491629719734, f1 0.9200000166893005
ep14_l2_test_time 0.3243534564971924
Test Epoch14 layer3 Acc 0.9210526315789473, AUC 0.9813054800033569, avg_entr 0.018096880987286568, f1 0.9210526347160339
ep14_l3_test_time 0.33207154273986816
Test Epoch14 layer4 Acc 0.921578947368421, AUC 0.979745626449585, avg_entr 0.01696021668612957, f1 0.9215789437294006
ep14_l4_test_time 0.33226847648620605
gc 0
Train Epoch15 Acc 0.9541833333333334 (114502/120000), AUC 0.9944998025894165
ep15_train_time 25.5254225730896
Test Epoch15 layer0 Acc 0.9205263157894736, AUC 0.9818411469459534, avg_entr 0.04307381808757782, f1 0.9205263257026672
ep15_l0_test_time 0.31757378578186035
Test Epoch15 layer1 Acc 0.9202631578947369, AUC 0.9816150069236755, avg_entr 0.040378786623477936, f1 0.9202631711959839
ep15_l1_test_time 0.33400726318359375
Test Epoch15 layer2 Acc 0.9205263157894736, AUC 0.9822818636894226, avg_entr 0.022745538502931595, f1 0.9205263257026672
ep15_l2_test_time 0.3318819999694824
Test Epoch15 layer3 Acc 0.9205263157894736, AUC 0.9818640947341919, avg_entr 0.017078343778848648, f1 0.9205263257026672
ep15_l3_test_time 0.3266031742095947
Test Epoch15 layer4 Acc 0.9194736842105263, AUC 0.9796856045722961, avg_entr 0.015698734670877457, f1 0.9194737076759338
ep15_l4_test_time 0.3164856433868408
gc 0
Train Epoch16 Acc 0.9545166666666667 (114542/120000), AUC 0.9945619106292725
ep16_train_time 25.509222269058228
Test Epoch16 layer0 Acc 0.92, AUC 0.9817925691604614, avg_entr 0.04168649762868881, f1 0.9200000166893005
ep16_l0_test_time 0.3227407932281494
Test Epoch16 layer1 Acc 0.9197368421052632, AUC 0.9815278053283691, avg_entr 0.03905331715941429, f1 0.9197368621826172
ep16_l1_test_time 0.32215118408203125
Test Epoch16 layer2 Acc 0.92, AUC 0.9820119142532349, avg_entr 0.02179441973567009, f1 0.9200000166893005
ep16_l2_test_time 0.3344452381134033
Test Epoch16 layer3 Acc 0.9197368421052632, AUC 0.9816086292266846, avg_entr 0.016429955139756203, f1 0.9197368621826172
ep16_l3_test_time 0.3206045627593994
Test Epoch16 layer4 Acc 0.9192105263157895, AUC 0.9801768064498901, avg_entr 0.015115178190171719, f1 0.9192105531692505
ep16_l4_test_time 0.33246850967407227
gc 0
Train Epoch17 Acc 0.954525 (114543/120000), AUC 0.9946621656417847
ep17_train_time 25.49646306037903
Test Epoch17 layer0 Acc 0.9202631578947369, AUC 0.9817857146263123, avg_entr 0.0411360003054142, f1 0.9202631711959839
ep17_l0_test_time 0.3297388553619385
Test Epoch17 layer1 Acc 0.9202631578947369, AUC 0.9815285205841064, avg_entr 0.03822440654039383, f1 0.9202631711959839
ep17_l1_test_time 0.3191041946411133
Test Epoch17 layer2 Acc 0.9197368421052632, AUC 0.9820644855499268, avg_entr 0.021406296640634537, f1 0.9197368621826172
ep17_l2_test_time 0.3367335796356201
Test Epoch17 layer3 Acc 0.9202631578947369, AUC 0.9816699028015137, avg_entr 0.016873091459274292, f1 0.9202631711959839
ep17_l3_test_time 0.3201901912689209
Test Epoch17 layer4 Acc 0.9197368421052632, AUC 0.9804424047470093, avg_entr 0.015772026032209396, f1 0.9197368621826172
ep17_l4_test_time 0.3279104232788086
gc 0
Train Epoch18 Acc 0.9549583333333334 (114595/120000), AUC 0.9947229027748108
ep18_train_time 25.55347442626953
Test Epoch18 layer0 Acc 0.9194736842105263, AUC 0.9817597270011902, avg_entr 0.04025346413254738, f1 0.9194737076759338
ep18_l0_test_time 0.33425426483154297
Test Epoch18 layer1 Acc 0.9189473684210526, AUC 0.9814794063568115, avg_entr 0.037637852132320404, f1 0.9189472794532776
ep18_l1_test_time 0.33432984352111816
Test Epoch18 layer2 Acc 0.9197368421052632, AUC 0.981967031955719, avg_entr 0.020420709624886513, f1 0.9197368621826172
ep18_l2_test_time 0.32891225814819336
Test Epoch18 layer3 Acc 0.9194736842105263, AUC 0.9815167188644409, avg_entr 0.015371900983154774, f1 0.9194737076759338
ep18_l3_test_time 0.32373714447021484
Test Epoch18 layer4 Acc 0.9192105263157895, AUC 0.9801751375198364, avg_entr 0.01397816464304924, f1 0.9192105531692505
ep18_l4_test_time 0.3346893787384033
gc 0
Train Epoch19 Acc 0.9553 (114636/120000), AUC 0.9948049783706665
ep19_train_time 25.50585961341858
Test Epoch19 layer0 Acc 0.92, AUC 0.981766939163208, avg_entr 0.03831911459565163, f1 0.9200000166893005
ep19_l0_test_time 0.32716894149780273
Test Epoch19 layer1 Acc 0.92, AUC 0.9815012812614441, avg_entr 0.035890236496925354, f1 0.9200000166893005
ep19_l1_test_time 0.32373666763305664
Test Epoch19 layer2 Acc 0.9197368421052632, AUC 0.9820238351821899, avg_entr 0.020352385938167572, f1 0.9197368621826172
ep19_l2_test_time 0.3262317180633545
Test Epoch19 layer3 Acc 0.92, AUC 0.9819456934928894, avg_entr 0.01564597710967064, f1 0.9200000166893005
ep19_l3_test_time 0.3298616409301758
Test Epoch19 layer4 Acc 0.9194736842105263, AUC 0.9803739786148071, avg_entr 0.01467648334801197, f1 0.9194737076759338
ep19_l4_test_time 0.32449913024902344
gc 0
Train Epoch20 Acc 0.9553166666666667 (114638/120000), AUC 0.9947768449783325
ep20_train_time 25.54807949066162
Test Epoch20 layer0 Acc 0.9210526315789473, AUC 0.9817453026771545, avg_entr 0.03821577876806259, f1 0.9210526347160339
ep20_l0_test_time 0.32795095443725586
Test Epoch20 layer1 Acc 0.9194736842105263, AUC 0.9814555644989014, avg_entr 0.03566376119852066, f1 0.9194737076759338
ep20_l1_test_time 0.33539891242980957
Test Epoch20 layer2 Acc 0.9176315789473685, AUC 0.981938362121582, avg_entr 0.019268503412604332, f1 0.9176315665245056
ep20_l2_test_time 0.3280165195465088
Test Epoch20 layer3 Acc 0.9176315789473685, AUC 0.9817326664924622, avg_entr 0.01558904629200697, f1 0.9176315665245056
ep20_l3_test_time 0.3252394199371338
Test Epoch20 layer4 Acc 0.9176315789473685, AUC 0.9804688096046448, avg_entr 0.014431585557758808, f1 0.9176315665245056
ep20_l4_test_time 0.3338499069213867
gc 0
Train Epoch21 Acc 0.9555583333333333 (114667/120000), AUC 0.9948819279670715
ep21_train_time 25.475661277770996
Test Epoch21 layer0 Acc 0.9181578947368421, AUC 0.981675386428833, avg_entr 0.03764752671122551, f1 0.9181578755378723
ep21_l0_test_time 0.33153223991394043
Test Epoch21 layer1 Acc 0.9181578947368421, AUC 0.981400728225708, avg_entr 0.03517594560980797, f1 0.9181578755378723
ep21_l1_test_time 0.3317992687225342
Test Epoch21 layer2 Acc 0.9181578947368421, AUC 0.9818657040596008, avg_entr 0.018465569242835045, f1 0.9181578755378723
ep21_l2_test_time 0.33495378494262695
Test Epoch21 layer3 Acc 0.9186842105263158, AUC 0.981843113899231, avg_entr 0.014764327555894852, f1 0.918684184551239
ep21_l3_test_time 0.3383445739746094
Test Epoch21 layer4 Acc 0.9184210526315789, AUC 0.9802258014678955, avg_entr 0.013718374073505402, f1 0.9184210896492004
ep21_l4_test_time 0.3363931179046631
gc 0
Train Epoch22 Acc 0.9557333333333333 (114688/120000), AUC 0.9949153065681458
ep22_train_time 25.551214694976807
Test Epoch22 layer0 Acc 0.92, AUC 0.9817169904708862, avg_entr 0.03739366680383682, f1 0.9200000166893005
ep22_l0_test_time 0.3338932991027832
Test Epoch22 layer1 Acc 0.9194736842105263, AUC 0.9814294576644897, avg_entr 0.0346180759370327, f1 0.9194737076759338
ep22_l1_test_time 0.324932336807251
Test Epoch22 layer2 Acc 0.9176315789473685, AUC 0.9815230369567871, avg_entr 0.018549583852291107, f1 0.9176315665245056
ep22_l2_test_time 0.32479166984558105
Test Epoch22 layer3 Acc 0.9186842105263158, AUC 0.9814625978469849, avg_entr 0.0149667514488101, f1 0.918684184551239
ep22_l3_test_time 0.32687807083129883
Test Epoch22 layer4 Acc 0.9189473684210526, AUC 0.9798141717910767, avg_entr 0.013582308776676655, f1 0.9189472794532776
ep22_l4_test_time 0.32983899116516113
gc 0
Train Epoch23 Acc 0.955975 (114717/120000), AUC 0.9949464797973633
ep23_train_time 25.507112741470337
Test Epoch23 layer0 Acc 0.9189473684210526, AUC 0.9816540479660034, avg_entr 0.036678850650787354, f1 0.9189472794532776
ep23_l0_test_time 0.3259913921356201
Test Epoch23 layer1 Acc 0.9184210526315789, AUC 0.9813618659973145, avg_entr 0.03411389887332916, f1 0.9184210896492004
ep23_l1_test_time 0.3231189250946045
Test Epoch23 layer2 Acc 0.9181578947368421, AUC 0.9817466735839844, avg_entr 0.01794723980128765, f1 0.9181578755378723
ep23_l2_test_time 0.325197696685791
Test Epoch23 layer3 Acc 0.9178947368421052, AUC 0.9817349910736084, avg_entr 0.014445854350924492, f1 0.917894721031189
ep23_l3_test_time 0.32175302505493164
Test Epoch23 layer4 Acc 0.9171052631578948, AUC 0.980544924736023, avg_entr 0.01341371238231659, f1 0.9171052575111389
ep23_l4_test_time 0.3251368999481201
gc 0
Train Epoch24 Acc 0.956125 (114735/120000), AUC 0.9949769973754883
ep24_train_time 25.546650648117065
Test Epoch24 layer0 Acc 0.9186842105263158, AUC 0.9816523790359497, avg_entr 0.03643590956926346, f1 0.918684184551239
ep24_l0_test_time 0.3244955539703369
Test Epoch24 layer1 Acc 0.9184210526315789, AUC 0.9813589453697205, avg_entr 0.0339050218462944, f1 0.9184210896492004
ep24_l1_test_time 0.3320481777191162
Test Epoch24 layer2 Acc 0.9178947368421052, AUC 0.9816868305206299, avg_entr 0.01773073524236679, f1 0.917894721031189
ep24_l2_test_time 0.32602882385253906
Test Epoch24 layer3 Acc 0.9176315789473685, AUC 0.9815422892570496, avg_entr 0.014322400093078613, f1 0.9176315665245056
ep24_l3_test_time 0.3217599391937256
Test Epoch24 layer4 Acc 0.9176315789473685, AUC 0.9799574613571167, avg_entr 0.013073327019810677, f1 0.9176315665245056
ep24_l4_test_time 0.3317861557006836
gc 0
Train Epoch25 Acc 0.9560916666666667 (114731/120000), AUC 0.9949873089790344
ep25_train_time 25.5278537273407
Test Epoch25 layer0 Acc 0.92, AUC 0.9816460609436035, avg_entr 0.03593883290886879, f1 0.9200000166893005
ep25_l0_test_time 0.3322408199310303
Test Epoch25 layer1 Acc 0.9192105263157895, AUC 0.9813493490219116, avg_entr 0.0332493782043457, f1 0.9192105531692505
ep25_l1_test_time 0.3299429416656494
Test Epoch25 layer2 Acc 0.9189473684210526, AUC 0.9816038012504578, avg_entr 0.017841113731265068, f1 0.9189472794532776
ep25_l2_test_time 0.3307924270629883
Test Epoch25 layer3 Acc 0.9181578947368421, AUC 0.9814168214797974, avg_entr 0.014186038635671139, f1 0.9181578755378723
ep25_l3_test_time 0.333935022354126
Test Epoch25 layer4 Acc 0.9186842105263158, AUC 0.9796741604804993, avg_entr 0.012759438715875149, f1 0.918684184551239
ep25_l4_test_time 0.33120083808898926
gc 0
Train Epoch26 Acc 0.9563583333333333 (114763/120000), AUC 0.9950376152992249
ep26_train_time 25.536060571670532
Test Epoch26 layer0 Acc 0.9192105263157895, AUC 0.9816592931747437, avg_entr 0.03615326061844826, f1 0.9192105531692505
ep26_l0_test_time 0.3283696174621582
Test Epoch26 layer1 Acc 0.9186842105263158, AUC 0.9813498258590698, avg_entr 0.03344181552529335, f1 0.918684184551239
ep26_l1_test_time 0.334169864654541
Test Epoch26 layer2 Acc 0.9168421052631579, AUC 0.9815093278884888, avg_entr 0.017397306859493256, f1 0.9168421030044556
ep26_l2_test_time 0.33554530143737793
Test Epoch26 layer3 Acc 0.9171052631578948, AUC 0.9813374280929565, avg_entr 0.01406117994338274, f1 0.9171052575111389
ep26_l3_test_time 0.3322145938873291
Test Epoch26 layer4 Acc 0.9176315789473685, AUC 0.9798954725265503, avg_entr 0.01257780846208334, f1 0.9176315665245056
ep26_l4_test_time 0.33248353004455566
gc 0
Train Epoch27 Acc 0.9562583333333333 (114751/120000), AUC 0.9950535297393799
ep27_train_time 25.520822048187256
Test Epoch27 layer0 Acc 0.92, AUC 0.9816397428512573, avg_entr 0.03566109761595726, f1 0.9200000166893005
ep27_l0_test_time 0.3293721675872803
Test Epoch27 layer1 Acc 0.9194736842105263, AUC 0.9813461303710938, avg_entr 0.032967984676361084, f1 0.9194737076759338
ep27_l1_test_time 0.33498501777648926
Test Epoch27 layer2 Acc 0.9186842105263158, AUC 0.981481671333313, avg_entr 0.017464211210608482, f1 0.918684184551239
ep27_l2_test_time 0.32767367362976074
Test Epoch27 layer3 Acc 0.9189473684210526, AUC 0.9812541007995605, avg_entr 0.013871327042579651, f1 0.9189472794532776
ep27_l3_test_time 0.32581233978271484
Test Epoch27 layer4 Acc 0.9186842105263158, AUC 0.9796935319900513, avg_entr 0.012266677804291248, f1 0.918684184551239
ep27_l4_test_time 0.3344578742980957
gc 0
Train Epoch28 Acc 0.9564083333333333 (114769/120000), AUC 0.9950605034828186
ep28_train_time 25.490894317626953
Test Epoch28 layer0 Acc 0.92, AUC 0.9816530346870422, avg_entr 0.03572898730635643, f1 0.9200000166893005
ep28_l0_test_time 0.33461976051330566
Test Epoch28 layer1 Acc 0.9184210526315789, AUC 0.9813417196273804, avg_entr 0.032960038632154465, f1 0.9184210896492004
ep28_l1_test_time 0.32721447944641113
Test Epoch28 layer2 Acc 0.9176315789473685, AUC 0.9815678596496582, avg_entr 0.0173050407320261, f1 0.9176315665245056
ep28_l2_test_time 0.32932209968566895
Test Epoch28 layer3 Acc 0.9184210526315789, AUC 0.9813092350959778, avg_entr 0.013858071528375149, f1 0.9184210896492004
ep28_l3_test_time 0.32558608055114746
Test Epoch28 layer4 Acc 0.9181578947368421, AUC 0.979459285736084, avg_entr 0.012228243052959442, f1 0.9181578755378723
ep28_l4_test_time 0.3290386199951172
gc 0
Train Epoch29 Acc 0.9563916666666666 (114767/120000), AUC 0.9950857162475586
ep29_train_time 25.559908390045166
Test Epoch29 layer0 Acc 0.9186842105263158, AUC 0.9816226363182068, avg_entr 0.03555949404835701, f1 0.918684184551239
ep29_l0_test_time 0.3260171413421631
Test Epoch29 layer1 Acc 0.9178947368421052, AUC 0.9813148379325867, avg_entr 0.032999783754348755, f1 0.917894721031189
ep29_l1_test_time 0.3340880870819092
Test Epoch29 layer2 Acc 0.9186842105263158, AUC 0.9816133975982666, avg_entr 0.016822872683405876, f1 0.918684184551239
ep29_l2_test_time 0.3329274654388428
Test Epoch29 layer3 Acc 0.9184210526315789, AUC 0.9815195202827454, avg_entr 0.013439200818538666, f1 0.9184210896492004
ep29_l3_test_time 0.325946569442749
Test Epoch29 layer4 Acc 0.9181578947368421, AUC 0.9801795482635498, avg_entr 0.01196946669369936, f1 0.9181578755378723
ep29_l4_test_time 0.328352689743042
Best AUC tensor(0.9250) 4 4
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 818.829095363617
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt
Test layer0 Acc 0.9152631578947369, AUC 0.9807733297348022, avg_entr 0.08544396609067917, f1 0.9152631759643555
l0_test_time 0.3336217403411865
Test layer1 Acc 0.9131578947368421, AUC 0.9806089401245117, avg_entr 0.0791488066315651, f1 0.9131578803062439
l1_test_time 0.3341519832611084
Test layer2 Acc 0.9131578947368421, AUC 0.9807250499725342, avg_entr 0.07623789459466934, f1 0.9131578803062439
l2_test_time 0.3289039134979248
Test layer3 Acc 0.9128947368421053, AUC 0.9817845821380615, avg_entr 0.05785050615668297, f1 0.9128947257995605
l3_test_time 0.326275110244751
Test layer4 Acc 0.9134210526315789, AUC 0.9814401268959045, avg_entr 0.03905293345451355, f1 0.9134210348129272
l4_test_time 0.3322482109069824
