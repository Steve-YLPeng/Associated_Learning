total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 20.11015272140503
Start Training
gc 0
Train Epoch0 Acc 0.6577583333333333 (78931/120000), AUC 0.863620400428772
ep0_train_time 26.493400812149048
Test Epoch0 layer0 Acc 0.9028947368421053, AUC 0.976800262928009, avg_entr 0.25466102361679077, f1 0.9028947353363037
ep0_l0_test_time 0.32718634605407715
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9042105263157895, AUC 0.9771380424499512, avg_entr 0.2594285309314728, f1 0.9042104482650757
ep0_l1_test_time 0.3285694122314453
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer2 Acc 0.9036842105263158, AUC 0.9767563939094543, avg_entr 0.2303604632616043, f1 0.9036841988563538
ep0_l2_test_time 0.32616376876831055
Test Epoch0 layer3 Acc 0.9028947368421053, AUC 0.9770177006721497, avg_entr 0.22369693219661713, f1 0.9028947353363037
ep0_l3_test_time 0.33054566383361816
Test Epoch0 layer4 Acc 0.9039473684210526, AUC 0.977005660533905, avg_entr 0.22216282784938812, f1 0.9039472937583923
ep0_l4_test_time 0.3316981792449951
gc 0
Train Epoch1 Acc 0.9169166666666667 (110030/120000), AUC 0.9814343452453613
ep1_train_time 25.31216311454773
Test Epoch1 layer0 Acc 0.916578947368421, AUC 0.9805100560188293, avg_entr 0.14630216360092163, f1 0.9165789484977722
ep1_l0_test_time 0.32515478134155273
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9173684210526316, AUC 0.9807215929031372, avg_entr 0.13941322267055511, f1 0.9173683524131775
ep1_l1_test_time 0.32593774795532227
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9163157894736842, AUC 0.9806551933288574, avg_entr 0.13629889488220215, f1 0.9163157939910889
ep1_l2_test_time 0.33312034606933594
Test Epoch1 layer3 Acc 0.9163157894736842, AUC 0.9808180928230286, avg_entr 0.12896248698234558, f1 0.9163157939910889
ep1_l3_test_time 0.33026719093322754
Test Epoch1 layer4 Acc 0.9155263157894736, AUC 0.9809097051620483, avg_entr 0.12266243994235992, f1 0.9155263304710388
ep1_l4_test_time 0.32727766036987305
gc 0
Train Epoch2 Acc 0.9269416666666667 (111233/120000), AUC 0.9858802556991577
ep2_train_time 25.30257821083069
Test Epoch2 layer0 Acc 0.9194736842105263, AUC 0.9817143082618713, avg_entr 0.1085619181394577, f1 0.9194737076759338
ep2_l0_test_time 0.32361626625061035
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.9197368421052632, AUC 0.9818296432495117, avg_entr 0.10331925004720688, f1 0.9197368621826172
ep2_l1_test_time 0.3234860897064209
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.9194736842105263, AUC 0.9817402958869934, avg_entr 0.10122199356555939, f1 0.9194737076759338
ep2_l2_test_time 0.32792186737060547
Test Epoch2 layer3 Acc 0.9221052631578948, AUC 0.9818433523178101, avg_entr 0.0918223038315773, f1 0.9221052527427673
ep2_l3_test_time 0.32802844047546387
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.9207894736842105, AUC 0.982079267501831, avg_entr 0.07922028750181198, f1 0.9207894802093506
ep2_l4_test_time 0.3235666751861572
gc 0
Train Epoch3 Acc 0.9330416666666667 (111965/120000), AUC 0.9881446957588196
ep3_train_time 25.320439100265503
Test Epoch3 layer0 Acc 0.9210526315789473, AUC 0.9825277328491211, avg_entr 0.09002187103033066, f1 0.9210526347160339
ep3_l0_test_time 0.3282768726348877
Test Epoch3 layer1 Acc 0.9218421052631579, AUC 0.9825642704963684, avg_entr 0.08546596765518188, f1 0.921842098236084
ep3_l1_test_time 0.32523512840270996
Test Epoch3 layer2 Acc 0.9210526315789473, AUC 0.9825218915939331, avg_entr 0.08245696127414703, f1 0.9210526347160339
ep3_l2_test_time 0.32168102264404297
Test Epoch3 layer3 Acc 0.9223684210526316, AUC 0.9830796718597412, avg_entr 0.06942453235387802, f1 0.9223684072494507
ep3_l3_test_time 0.3269684314727783
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.9221052631578948, AUC 0.9833610653877258, avg_entr 0.05272417888045311, f1 0.9221052527427673
ep3_l4_test_time 0.32360243797302246
gc 0
Train Epoch4 Acc 0.9371166666666667 (112454/120000), AUC 0.989444375038147
ep4_train_time 25.322497844696045
Test Epoch4 layer0 Acc 0.92, AUC 0.9827258586883545, avg_entr 0.07908561825752258, f1 0.9200000166893005
ep4_l0_test_time 0.3292067050933838
Test Epoch4 layer1 Acc 0.9210526315789473, AUC 0.9827662110328674, avg_entr 0.07507041096687317, f1 0.9210526347160339
ep4_l1_test_time 0.31673622131347656
Test Epoch4 layer2 Acc 0.9213157894736842, AUC 0.9828634858131409, avg_entr 0.0718822032213211, f1 0.9213157892227173
ep4_l2_test_time 0.32834744453430176
Test Epoch4 layer3 Acc 0.9210526315789473, AUC 0.983372688293457, avg_entr 0.05262010544538498, f1 0.9210526347160339
ep4_l3_test_time 0.33362603187561035
Test Epoch4 layer4 Acc 0.9218421052631579, AUC 0.983961820602417, avg_entr 0.03689207509160042, f1 0.921842098236084
ep4_l4_test_time 0.32678723335266113
gc 0
Train Epoch5 Acc 0.9404666666666667 (112856/120000), AUC 0.9901309013366699
ep5_train_time 25.306227922439575
Test Epoch5 layer0 Acc 0.9223684210526316, AUC 0.9826868176460266, avg_entr 0.07315484434366226, f1 0.9223684072494507
ep5_l0_test_time 0.32245826721191406
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 5
Test Epoch5 layer1 Acc 0.9226315789473685, AUC 0.9826198816299438, avg_entr 0.0693681463599205, f1 0.922631561756134
ep5_l1_test_time 0.3233168125152588
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 5
Test Epoch5 layer2 Acc 0.925, AUC 0.9828342199325562, avg_entr 0.06398193538188934, f1 0.925000011920929
ep5_l2_test_time 0.33035826683044434
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 5
Test Epoch5 layer3 Acc 0.9252631578947368, AUC 0.9827322959899902, avg_entr 0.04170263931155205, f1 0.9252631664276123
ep5_l3_test_time 0.3287017345428467
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 5
Test Epoch5 layer4 Acc 0.9247368421052632, AUC 0.9803582429885864, avg_entr 0.030553951859474182, f1 0.9247368574142456
ep5_l4_test_time 0.3258812427520752
gc 0
Train Epoch6 Acc 0.942725 (113127/120000), AUC 0.9907447099685669
ep6_train_time 25.33237886428833
Test Epoch6 layer0 Acc 0.9202631578947369, AUC 0.9825297594070435, avg_entr 0.06509210914373398, f1 0.9202631711959839
ep6_l0_test_time 0.32561683654785156
Test Epoch6 layer1 Acc 0.92, AUC 0.9824075698852539, avg_entr 0.061984725296497345, f1 0.9200000166893005
ep6_l1_test_time 0.322098970413208
Test Epoch6 layer2 Acc 0.9213157894736842, AUC 0.9828048944473267, avg_entr 0.05471593514084816, f1 0.9213157892227173
ep6_l2_test_time 0.33073902130126953
Test Epoch6 layer3 Acc 0.9218421052631579, AUC 0.9833742380142212, avg_entr 0.03292635828256607, f1 0.921842098236084
ep6_l3_test_time 0.33072352409362793
Test Epoch6 layer4 Acc 0.9210526315789473, AUC 0.980498194694519, avg_entr 0.026161756366491318, f1 0.9210526347160339
ep6_l4_test_time 0.32881832122802734
gc 0
Train Epoch7 Acc 0.9453916666666666 (113447/120000), AUC 0.9916220307350159
ep7_train_time 25.32176661491394
Test Epoch7 layer0 Acc 0.9226315789473685, AUC 0.9825592041015625, avg_entr 0.05971972271800041, f1 0.922631561756134
ep7_l0_test_time 0.327420711517334
Test Epoch7 layer1 Acc 0.9221052631578948, AUC 0.9825087785720825, avg_entr 0.0569131001830101, f1 0.9221052527427673
ep7_l1_test_time 0.3251502513885498
Test Epoch7 layer2 Acc 0.9244736842105263, AUC 0.9831300377845764, avg_entr 0.046643488109111786, f1 0.9244737029075623
ep7_l2_test_time 0.32949137687683105
Test Epoch7 layer3 Acc 0.9231578947368421, AUC 0.9833600521087646, avg_entr 0.027675190940499306, f1 0.9231578707695007
ep7_l3_test_time 0.3261113166809082
Test Epoch7 layer4 Acc 0.9226315789473685, AUC 0.9822395443916321, avg_entr 0.023227261379361153, f1 0.922631561756134
ep7_l4_test_time 0.330859899520874
gc 0
Train Epoch8 Acc 0.9467166666666667 (113606/120000), AUC 0.9923791885375977
ep8_train_time 25.235945224761963
Test Epoch8 layer0 Acc 0.9228947368421052, AUC 0.9825060367584229, avg_entr 0.05712779983878136, f1 0.9228947162628174
ep8_l0_test_time 0.32584381103515625
Test Epoch8 layer1 Acc 0.9223684210526316, AUC 0.9824150800704956, avg_entr 0.05423079803586006, f1 0.9223684072494507
ep8_l1_test_time 0.3270907402038574
Test Epoch8 layer2 Acc 0.9247368421052632, AUC 0.9833868145942688, avg_entr 0.04107004776597023, f1 0.9247368574142456
ep8_l2_test_time 0.32560086250305176
Test Epoch8 layer3 Acc 0.9231578947368421, AUC 0.9822567701339722, avg_entr 0.024657050147652626, f1 0.9231578707695007
ep8_l3_test_time 0.32744884490966797
Test Epoch8 layer4 Acc 0.9231578947368421, AUC 0.9812256097793579, avg_entr 0.021524127572774887, f1 0.9231578707695007
ep8_l4_test_time 0.3295931816101074
gc 0
Train Epoch9 Acc 0.9492 (113904/120000), AUC 0.9934053421020508
ep9_train_time 25.247791051864624
Test Epoch9 layer0 Acc 0.9223684210526316, AUC 0.9823499917984009, avg_entr 0.05423922836780548, f1 0.9223684072494507
ep9_l0_test_time 0.3213200569152832
Test Epoch9 layer1 Acc 0.9221052631578948, AUC 0.9821743369102478, avg_entr 0.05153830349445343, f1 0.9221052527427673
ep9_l1_test_time 0.3273134231567383
Test Epoch9 layer2 Acc 0.9234210526315789, AUC 0.9830386638641357, avg_entr 0.03600999712944031, f1 0.9234210252761841
ep9_l2_test_time 0.3185126781463623
Test Epoch9 layer3 Acc 0.9242105263157895, AUC 0.982176661491394, avg_entr 0.021792054176330566, f1 0.9242105484008789
ep9_l3_test_time 0.32634806632995605
Test Epoch9 layer4 Acc 0.9231578947368421, AUC 0.9819518327713013, avg_entr 0.01949286460876465, f1 0.9231578707695007
ep9_l4_test_time 0.32958102226257324
gc 0
Train Epoch10 Acc 0.9498833333333333 (113986/120000), AUC 0.9934729337692261
ep10_train_time 25.262490272521973
Test Epoch10 layer0 Acc 0.9223684210526316, AUC 0.9822745323181152, avg_entr 0.05195654556155205, f1 0.9223684072494507
ep10_l0_test_time 0.3262143135070801
Test Epoch10 layer1 Acc 0.9223684210526316, AUC 0.9821016788482666, avg_entr 0.04932558909058571, f1 0.9223684072494507
ep10_l1_test_time 0.32906293869018555
Test Epoch10 layer2 Acc 0.9242105263157895, AUC 0.9829200506210327, avg_entr 0.033168643712997437, f1 0.9242105484008789
ep10_l2_test_time 0.3204629421234131
Test Epoch10 layer3 Acc 0.9239473684210526, AUC 0.982022762298584, avg_entr 0.021242287009954453, f1 0.9239473938941956
ep10_l3_test_time 0.3283498287200928
Test Epoch10 layer4 Acc 0.9244736842105263, AUC 0.9823235273361206, avg_entr 0.019182048738002777, f1 0.9244737029075623
ep10_l4_test_time 0.32685136795043945
gc 0
Train Epoch11 Acc 0.95075 (114090/120000), AUC 0.9936533570289612
ep11_train_time 25.32248282432556
Test Epoch11 layer0 Acc 0.9207894736842105, AUC 0.9823106527328491, avg_entr 0.05104842409491539, f1 0.9207894802093506
ep11_l0_test_time 0.3252580165863037
Test Epoch11 layer1 Acc 0.9213157894736842, AUC 0.9820562601089478, avg_entr 0.048407118767499924, f1 0.9213157892227173
ep11_l1_test_time 0.32747483253479004
Test Epoch11 layer2 Acc 0.9223684210526316, AUC 0.9829300045967102, avg_entr 0.03025360032916069, f1 0.9223684072494507
ep11_l2_test_time 0.32717204093933105
Test Epoch11 layer3 Acc 0.9221052631578948, AUC 0.9821629524230957, avg_entr 0.019542215391993523, f1 0.9221052527427673
ep11_l3_test_time 0.3245275020599365
Test Epoch11 layer4 Acc 0.9213157894736842, AUC 0.9822688698768616, avg_entr 0.018125763162970543, f1 0.9213157892227173
ep11_l4_test_time 0.32187628746032715
gc 0
Train Epoch12 Acc 0.9510666666666666 (114128/120000), AUC 0.9938533306121826
ep12_train_time 25.261785984039307
Test Epoch12 layer0 Acc 0.9223684210526316, AUC 0.9822224378585815, avg_entr 0.04757534712553024, f1 0.9223684072494507
ep12_l0_test_time 0.32419395446777344
Test Epoch12 layer1 Acc 0.9221052631578948, AUC 0.9819905757904053, avg_entr 0.04506133869290352, f1 0.9221052527427673
ep12_l1_test_time 0.3275935649871826
Test Epoch12 layer2 Acc 0.9226315789473685, AUC 0.9826334714889526, avg_entr 0.027285128831863403, f1 0.922631561756134
ep12_l2_test_time 0.32634687423706055
Test Epoch12 layer3 Acc 0.9205263157894736, AUC 0.9822686314582825, avg_entr 0.018837982788681984, f1 0.9205263257026672
ep12_l3_test_time 0.3291764259338379
Test Epoch12 layer4 Acc 0.921578947368421, AUC 0.982092022895813, avg_entr 0.017066873610019684, f1 0.9215789437294006
ep12_l4_test_time 0.32273221015930176
gc 0
Train Epoch13 Acc 0.9524166666666667 (114290/120000), AUC 0.9942431449890137
ep13_train_time 25.288619995117188
Test Epoch13 layer0 Acc 0.9218421052631579, AUC 0.9822107553482056, avg_entr 0.04725616052746773, f1 0.921842098236084
ep13_l0_test_time 0.33219456672668457
Test Epoch13 layer1 Acc 0.9207894736842105, AUC 0.981975793838501, avg_entr 0.04464152455329895, f1 0.9207894802093506
ep13_l1_test_time 0.3247532844543457
Test Epoch13 layer2 Acc 0.921578947368421, AUC 0.982703685760498, avg_entr 0.02613724395632744, f1 0.9215789437294006
ep13_l2_test_time 0.32305335998535156
Test Epoch13 layer3 Acc 0.9207894736842105, AUC 0.981942355632782, avg_entr 0.017968682572245598, f1 0.9207894802093506
ep13_l3_test_time 0.3295857906341553
Test Epoch13 layer4 Acc 0.9218421052631579, AUC 0.9811662435531616, avg_entr 0.016782360151410103, f1 0.921842098236084
ep13_l4_test_time 0.32902956008911133
gc 0
Train Epoch14 Acc 0.9528 (114336/120000), AUC 0.9942368268966675
ep14_train_time 25.274189472198486
Test Epoch14 layer0 Acc 0.921578947368421, AUC 0.9821404218673706, avg_entr 0.04541853070259094, f1 0.9215789437294006
ep14_l0_test_time 0.3186531066894531
Test Epoch14 layer1 Acc 0.9213157894736842, AUC 0.981927752494812, avg_entr 0.04299059882760048, f1 0.9213157892227173
ep14_l1_test_time 0.32239198684692383
Test Epoch14 layer2 Acc 0.9218421052631579, AUC 0.9823147654533386, avg_entr 0.025206852704286575, f1 0.921842098236084
ep14_l2_test_time 0.3311600685119629
Test Epoch14 layer3 Acc 0.9205263157894736, AUC 0.9820549488067627, avg_entr 0.018233615905046463, f1 0.9205263257026672
ep14_l3_test_time 0.32773566246032715
Test Epoch14 layer4 Acc 0.9213157894736842, AUC 0.9818465709686279, avg_entr 0.017235832288861275, f1 0.9213157892227173
ep14_l4_test_time 0.3287959098815918
gc 0
Train Epoch15 Acc 0.9530083333333333 (114361/120000), AUC 0.9943768978118896
ep15_train_time 25.301031589508057
Test Epoch15 layer0 Acc 0.9213157894736842, AUC 0.9821090698242188, avg_entr 0.043917927891016006, f1 0.9213157892227173
ep15_l0_test_time 0.3301219940185547
Test Epoch15 layer1 Acc 0.9213157894736842, AUC 0.9818503260612488, avg_entr 0.04153600335121155, f1 0.9213157892227173
ep15_l1_test_time 0.3264882564544678
Test Epoch15 layer2 Acc 0.921578947368421, AUC 0.982701301574707, avg_entr 0.0237983837723732, f1 0.9215789437294006
ep15_l2_test_time 0.3152799606323242
Test Epoch15 layer3 Acc 0.9210526315789473, AUC 0.98201984167099, avg_entr 0.017287299036979675, f1 0.9210526347160339
ep15_l3_test_time 0.3226320743560791
Test Epoch15 layer4 Acc 0.9213157894736842, AUC 0.9799715280532837, avg_entr 0.01622980274260044, f1 0.9213157892227173
ep15_l4_test_time 0.32005834579467773
gc 0
Train Epoch16 Acc 0.95355 (114426/120000), AUC 0.9944912791252136
ep16_train_time 25.244842290878296
Test Epoch16 layer0 Acc 0.9210526315789473, AUC 0.9820628762245178, avg_entr 0.04235358163714409, f1 0.9210526347160339
ep16_l0_test_time 0.32709503173828125
Test Epoch16 layer1 Acc 0.9205263157894736, AUC 0.981786847114563, avg_entr 0.040301792323589325, f1 0.9205263257026672
ep16_l1_test_time 0.32350587844848633
Test Epoch16 layer2 Acc 0.9223684210526316, AUC 0.9822383522987366, avg_entr 0.022785266861319542, f1 0.9223684072494507
ep16_l2_test_time 0.3277628421783447
Test Epoch16 layer3 Acc 0.9221052631578948, AUC 0.9815093278884888, avg_entr 0.01585414819419384, f1 0.9221052527427673
ep16_l3_test_time 0.3285079002380371
Test Epoch16 layer4 Acc 0.9226315789473685, AUC 0.9799033403396606, avg_entr 0.014799718745052814, f1 0.922631561756134
ep16_l4_test_time 0.3313405513763428
gc 0
Train Epoch17 Acc 0.9537666666666667 (114452/120000), AUC 0.994647741317749
ep17_train_time 25.29737663269043
Test Epoch17 layer0 Acc 0.921578947368421, AUC 0.9820413589477539, avg_entr 0.041283924132585526, f1 0.9215789437294006
ep17_l0_test_time 0.32747530937194824
Test Epoch17 layer1 Acc 0.9210526315789473, AUC 0.9817764759063721, avg_entr 0.039061542600393295, f1 0.9210526347160339
ep17_l1_test_time 0.32398128509521484
Test Epoch17 layer2 Acc 0.9226315789473685, AUC 0.9821793437004089, avg_entr 0.02229398302733898, f1 0.922631561756134
ep17_l2_test_time 0.3329596519470215
Test Epoch17 layer3 Acc 0.9213157894736842, AUC 0.9815664291381836, avg_entr 0.016153685748577118, f1 0.9213157892227173
ep17_l3_test_time 0.3318173885345459
Test Epoch17 layer4 Acc 0.9218421052631579, AUC 0.9802055954933167, avg_entr 0.015463125891983509, f1 0.921842098236084
ep17_l4_test_time 0.32953619956970215
gc 0
Train Epoch18 Acc 0.9539333333333333 (114472/120000), AUC 0.9947109222412109
ep18_train_time 25.341748476028442
Test Epoch18 layer0 Acc 0.9210526315789473, AUC 0.9820233583450317, avg_entr 0.04084515571594238, f1 0.9210526347160339
ep18_l0_test_time 0.32599663734436035
Test Epoch18 layer1 Acc 0.9210526315789473, AUC 0.9817126393318176, avg_entr 0.03870559111237526, f1 0.9210526347160339
ep18_l1_test_time 0.3334505558013916
Test Epoch18 layer2 Acc 0.9223684210526316, AUC 0.9825268983840942, avg_entr 0.02172795496881008, f1 0.9223684072494507
ep18_l2_test_time 0.32317686080932617
Test Epoch18 layer3 Acc 0.9207894736842105, AUC 0.9820448160171509, avg_entr 0.015511301346123219, f1 0.9207894802093506
ep18_l3_test_time 0.32466673851013184
Test Epoch18 layer4 Acc 0.9218421052631579, AUC 0.9813953638076782, avg_entr 0.014668596908450127, f1 0.921842098236084
ep18_l4_test_time 0.327467679977417
gc 0
Train Epoch19 Acc 0.9540833333333333 (114490/120000), AUC 0.9946978688240051
ep19_train_time 25.284043312072754
Test Epoch19 layer0 Acc 0.9218421052631579, AUC 0.9820365309715271, avg_entr 0.039349719882011414, f1 0.921842098236084
ep19_l0_test_time 0.3263075351715088
Test Epoch19 layer1 Acc 0.9213157894736842, AUC 0.9817076921463013, avg_entr 0.037251971662044525, f1 0.9213157892227173
ep19_l1_test_time 0.3261892795562744
Test Epoch19 layer2 Acc 0.9218421052631579, AUC 0.9823907613754272, avg_entr 0.02088286355137825, f1 0.921842098236084
ep19_l2_test_time 0.33272242546081543
Test Epoch19 layer3 Acc 0.9213157894736842, AUC 0.9817817211151123, avg_entr 0.015499632805585861, f1 0.9213157892227173
ep19_l3_test_time 0.3202359676361084
Test Epoch19 layer4 Acc 0.921578947368421, AUC 0.9805753827095032, avg_entr 0.014870459213852882, f1 0.9215789437294006
ep19_l4_test_time 0.32198166847229004
gc 0
Train Epoch20 Acc 0.9542333333333334 (114508/120000), AUC 0.9946537017822266
ep20_train_time 25.292982816696167
Test Epoch20 layer0 Acc 0.9202631578947369, AUC 0.9820416569709778, avg_entr 0.03859386593103409, f1 0.9202631711959839
ep20_l0_test_time 0.3264448642730713
Test Epoch20 layer1 Acc 0.9202631578947369, AUC 0.9817127585411072, avg_entr 0.036532510071992874, f1 0.9202631711959839
ep20_l1_test_time 0.3185908794403076
Test Epoch20 layer2 Acc 0.9210526315789473, AUC 0.9823183417320251, avg_entr 0.019896123558282852, f1 0.9210526347160339
ep20_l2_test_time 0.3309645652770996
Test Epoch20 layer3 Acc 0.9205263157894736, AUC 0.9818170666694641, avg_entr 0.014654100872576237, f1 0.9205263257026672
ep20_l3_test_time 0.3180859088897705
Test Epoch20 layer4 Acc 0.9210526315789473, AUC 0.9802447557449341, avg_entr 0.013912046328186989, f1 0.9210526347160339
ep20_l4_test_time 0.3311476707458496
gc 0
Train Epoch21 Acc 0.9546083333333333 (114553/120000), AUC 0.9948564767837524
ep21_train_time 25.33915114402771
Test Epoch21 layer0 Acc 0.9221052631578948, AUC 0.9820191860198975, avg_entr 0.03760088235139847, f1 0.9221052527427673
ep21_l0_test_time 0.3261127471923828
Test Epoch21 layer1 Acc 0.9213157894736842, AUC 0.9817039966583252, avg_entr 0.035526178777217865, f1 0.9213157892227173
ep21_l1_test_time 0.3266310691833496
Test Epoch21 layer2 Acc 0.9226315789473685, AUC 0.9822638034820557, avg_entr 0.019726695492863655, f1 0.922631561756134
ep21_l2_test_time 0.32855749130249023
Test Epoch21 layer3 Acc 0.921578947368421, AUC 0.9816151261329651, avg_entr 0.014662317931652069, f1 0.9215789437294006
ep21_l3_test_time 0.3182675838470459
Test Epoch21 layer4 Acc 0.9221052631578948, AUC 0.9801548719406128, avg_entr 0.014146802946925163, f1 0.9221052527427673
ep21_l4_test_time 0.33051133155822754
gc 0
Train Epoch22 Acc 0.954575 (114549/120000), AUC 0.9948176741600037
ep22_train_time 25.297226667404175
Test Epoch22 layer0 Acc 0.9207894736842105, AUC 0.9820078015327454, avg_entr 0.03745425119996071, f1 0.9207894802093506
ep22_l0_test_time 0.3246467113494873
Test Epoch22 layer1 Acc 0.9213157894736842, AUC 0.9816681146621704, avg_entr 0.03520769625902176, f1 0.9213157892227173
ep22_l1_test_time 0.3187747001647949
Test Epoch22 layer2 Acc 0.9202631578947369, AUC 0.982347309589386, avg_entr 0.019356412813067436, f1 0.9202631711959839
ep22_l2_test_time 0.32656407356262207
Test Epoch22 layer3 Acc 0.9197368421052632, AUC 0.9819360971450806, avg_entr 0.014827080070972443, f1 0.9197368621826172
ep22_l3_test_time 0.3255622386932373
Test Epoch22 layer4 Acc 0.9210526315789473, AUC 0.9804633259773254, avg_entr 0.014333524741232395, f1 0.9210526347160339
ep22_l4_test_time 0.33179521560668945
gc 0
Train Epoch23 Acc 0.9546583333333334 (114559/120000), AUC 0.9948766231536865
ep23_train_time 25.23063635826111
Test Epoch23 layer0 Acc 0.9213157894736842, AUC 0.9820083379745483, avg_entr 0.03681918606162071, f1 0.9213157892227173
ep23_l0_test_time 0.3273940086364746
Test Epoch23 layer1 Acc 0.9205263157894736, AUC 0.9816571474075317, avg_entr 0.0347629114985466, f1 0.9205263257026672
ep23_l1_test_time 0.32709479331970215
Test Epoch23 layer2 Acc 0.921578947368421, AUC 0.9824260473251343, avg_entr 0.018899107351899147, f1 0.9215789437294006
ep23_l2_test_time 0.325197696685791
Test Epoch23 layer3 Acc 0.9207894736842105, AUC 0.9820871949195862, avg_entr 0.013940410688519478, f1 0.9207894802093506
ep23_l3_test_time 0.33177638053894043
Test Epoch23 layer4 Acc 0.9210526315789473, AUC 0.9812963008880615, avg_entr 0.013253625482320786, f1 0.9210526347160339
ep23_l4_test_time 0.3296074867248535
gc 0
Train Epoch24 Acc 0.9547416666666667 (114569/120000), AUC 0.9948502779006958
ep24_train_time 25.283450841903687
Test Epoch24 layer0 Acc 0.9210526315789473, AUC 0.982010543346405, avg_entr 0.03636990115046501, f1 0.9210526347160339
ep24_l0_test_time 0.3246896266937256
Test Epoch24 layer1 Acc 0.9202631578947369, AUC 0.9816629886627197, avg_entr 0.03426356986165047, f1 0.9202631711959839
ep24_l1_test_time 0.33063507080078125
Test Epoch24 layer2 Acc 0.9221052631578948, AUC 0.9824092984199524, avg_entr 0.018560858443379402, f1 0.9221052527427673
ep24_l2_test_time 0.3278515338897705
Test Epoch24 layer3 Acc 0.9210526315789473, AUC 0.9819961786270142, avg_entr 0.013746114447712898, f1 0.9210526347160339
ep24_l3_test_time 0.32849812507629395
Test Epoch24 layer4 Acc 0.9210526315789473, AUC 0.9812040328979492, avg_entr 0.013047432526946068, f1 0.9210526347160339
ep24_l4_test_time 0.3319120407104492
gc 0
Train Epoch25 Acc 0.9548916666666667 (114587/120000), AUC 0.9949425458908081
ep25_train_time 25.26872181892395
Test Epoch25 layer0 Acc 0.9213157894736842, AUC 0.9820140600204468, avg_entr 0.03617718070745468, f1 0.9213157892227173
ep25_l0_test_time 0.321519136428833
Test Epoch25 layer1 Acc 0.921578947368421, AUC 0.9816694259643555, avg_entr 0.03397603705525398, f1 0.9215789437294006
ep25_l1_test_time 0.3270444869995117
Test Epoch25 layer2 Acc 0.9221052631578948, AUC 0.9822428822517395, avg_entr 0.01850254274904728, f1 0.9221052527427673
ep25_l2_test_time 0.33018994331359863
Test Epoch25 layer3 Acc 0.9213157894736842, AUC 0.9819422960281372, avg_entr 0.013742136768996716, f1 0.9213157892227173
ep25_l3_test_time 0.3285543918609619
Test Epoch25 layer4 Acc 0.9213157894736842, AUC 0.9803745150566101, avg_entr 0.013211732730269432, f1 0.9213157892227173
ep25_l4_test_time 0.3238682746887207
gc 0
Train Epoch26 Acc 0.9549 (114588/120000), AUC 0.9949588179588318
ep26_train_time 25.33138394355774
Test Epoch26 layer0 Acc 0.9210526315789473, AUC 0.9820122718811035, avg_entr 0.03629370406270027, f1 0.9210526347160339
ep26_l0_test_time 0.3202376365661621
Test Epoch26 layer1 Acc 0.9210526315789473, AUC 0.9816581010818481, avg_entr 0.0340445451438427, f1 0.9210526347160339
ep26_l1_test_time 0.33145642280578613
Test Epoch26 layer2 Acc 0.9207894736842105, AUC 0.9821522235870361, avg_entr 0.018204867839813232, f1 0.9207894802093506
ep26_l2_test_time 0.3243749141693115
Test Epoch26 layer3 Acc 0.9197368421052632, AUC 0.9817357063293457, avg_entr 0.013840969651937485, f1 0.9197368621826172
ep26_l3_test_time 0.3260173797607422
Test Epoch26 layer4 Acc 0.9197368421052632, AUC 0.9803133010864258, avg_entr 0.013400804251432419, f1 0.9197368621826172
ep26_l4_test_time 0.32576894760131836
gc 0
Train Epoch27 Acc 0.9549666666666666 (114596/120000), AUC 0.9949665665626526
ep27_train_time 25.27058982849121
Test Epoch27 layer0 Acc 0.9210526315789473, AUC 0.9820314049720764, avg_entr 0.03603403642773628, f1 0.9210526347160339
ep27_l0_test_time 0.31928324699401855
Test Epoch27 layer1 Acc 0.9210526315789473, AUC 0.9816522002220154, avg_entr 0.03384140133857727, f1 0.9210526347160339
ep27_l1_test_time 0.323620080947876
Test Epoch27 layer2 Acc 0.9202631578947369, AUC 0.9822149872779846, avg_entr 0.018103284761309624, f1 0.9202631711959839
ep27_l2_test_time 0.3323690891265869
Test Epoch27 layer3 Acc 0.9205263157894736, AUC 0.9820038676261902, avg_entr 0.013656624592840672, f1 0.9205263257026672
ep27_l3_test_time 0.3308370113372803
Test Epoch27 layer4 Acc 0.92, AUC 0.9807291626930237, avg_entr 0.013146720826625824, f1 0.9200000166893005
ep27_l4_test_time 0.31995129585266113
gc 0
Train Epoch28 Acc 0.9549916666666667 (114599/120000), AUC 0.9949510097503662
ep28_train_time 25.359383821487427
Test Epoch28 layer0 Acc 0.9218421052631579, AUC 0.9820014238357544, avg_entr 0.03551719710230827, f1 0.921842098236084
ep28_l0_test_time 0.32952070236206055
Test Epoch28 layer1 Acc 0.9202631578947369, AUC 0.9816440343856812, avg_entr 0.03339291363954544, f1 0.9202631711959839
ep28_l1_test_time 0.31828784942626953
Test Epoch28 layer2 Acc 0.9223684210526316, AUC 0.9822179079055786, avg_entr 0.018056295812129974, f1 0.9223684072494507
ep28_l2_test_time 0.32761049270629883
Test Epoch28 layer3 Acc 0.921578947368421, AUC 0.9817724823951721, avg_entr 0.01338962372392416, f1 0.9215789437294006
ep28_l3_test_time 0.328981876373291
Test Epoch28 layer4 Acc 0.9218421052631579, AUC 0.9804819226264954, avg_entr 0.012690107338130474, f1 0.921842098236084
ep28_l4_test_time 0.3247408866882324
gc 0
Train Epoch29 Acc 0.955125 (114615/120000), AUC 0.9950119256973267
ep29_train_time 25.28835916519165
Test Epoch29 layer0 Acc 0.9213157894736842, AUC 0.9820079207420349, avg_entr 0.035594355314970016, f1 0.9213157892227173
ep29_l0_test_time 0.321397066116333
Test Epoch29 layer1 Acc 0.9205263157894736, AUC 0.9816468358039856, avg_entr 0.033422138541936874, f1 0.9205263257026672
ep29_l1_test_time 0.3260366916656494
Test Epoch29 layer2 Acc 0.9207894736842105, AUC 0.9822763204574585, avg_entr 0.017880940809845924, f1 0.9207894802093506
ep29_l2_test_time 0.318467378616333
Test Epoch29 layer3 Acc 0.9207894736842105, AUC 0.9820917248725891, avg_entr 0.013444648124277592, f1 0.9207894802093506
ep29_l3_test_time 0.3270089626312256
Test Epoch29 layer4 Acc 0.9205263157894736, AUC 0.9809970259666443, avg_entr 0.01290647592395544, f1 0.9205263257026672
ep29_l4_test_time 0.32964491844177246
Best AUC tensor(0.9253) 5 3
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 811.3530461788177
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt
Test layer0 Acc 0.9131578947368421, AUC 0.9809428453445435, avg_entr 0.0801675096154213, f1 0.9131578803062439
l0_test_time 0.32683849334716797
Test layer1 Acc 0.9134210526315789, AUC 0.9806446433067322, avg_entr 0.07518208771944046, f1 0.9134210348129272
l1_test_time 0.32596755027770996
Test layer2 Acc 0.9136842105263158, AUC 0.9812391996383667, avg_entr 0.0691903680562973, f1 0.9136841893196106
l2_test_time 0.3324463367462158
Test layer3 Acc 0.9134210526315789, AUC 0.9812812209129333, avg_entr 0.04467790573835373, f1 0.9134210348129272
l3_test_time 0.33382582664489746
Test layer4 Acc 0.9134210526315789, AUC 0.9779191017150879, avg_entr 0.032553091645240784, f1 0.9134210348129272
l4_test_time 0.32822084426879883
