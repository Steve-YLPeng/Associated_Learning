total count words 102019
vocab size 30000
train size 120000, valid size 3800, test size 3800
found 26754 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=4, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=4, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 512
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 512
layers.0.ae.h.0.bias 4
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9687092
init_time 19.632484912872314
Start Training
gc 0
Train Epoch0 Acc 0.6390833333333333 (76690/120000), AUC 0.8547717332839966
ep0_train_time 26.65944218635559
Test Epoch0 layer0 Acc 0.9021052631578947, AUC 0.9772595167160034, avg_entr 0.25155019760131836, f1 0.9021052718162537
ep0_l0_test_time 0.3305184841156006
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.9002631578947369, AUC 0.9774360060691833, avg_entr 0.2598249316215515, f1 0.9002631306648254
ep0_l1_test_time 0.32123565673828125
Test Epoch0 layer2 Acc 0.901578947368421, AUC 0.9771649837493896, avg_entr 0.22893661260604858, f1 0.901578962802887
ep0_l2_test_time 0.32822608947753906
Test Epoch0 layer3 Acc 0.9036842105263158, AUC 0.9773217439651489, avg_entr 0.2287273406982422, f1 0.9036841988563538
ep0_l3_test_time 0.32730650901794434
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
Test Epoch0 layer4 Acc 0.9042105263157895, AUC 0.9773538112640381, avg_entr 0.22540098428726196, f1 0.9042104482650757
ep0_l4_test_time 0.32117319107055664
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 0
gc 0
Train Epoch1 Acc 0.917325 (110079/120000), AUC 0.9816217422485352
ep1_train_time 25.407939195632935
Test Epoch1 layer0 Acc 0.915, AUC 0.9804795980453491, avg_entr 0.14552921056747437, f1 0.9150000214576721
ep1_l0_test_time 0.3347961902618408
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.9160526315789473, AUC 0.9806724786758423, avg_entr 0.13992701470851898, f1 0.9160526394844055
ep1_l1_test_time 0.3228638172149658
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.9155263157894736, AUC 0.9805321097373962, avg_entr 0.13329148292541504, f1 0.9155263304710388
ep1_l2_test_time 0.31967687606811523
Test Epoch1 layer3 Acc 0.9155263157894736, AUC 0.9806644320487976, avg_entr 0.1290854662656784, f1 0.9155263304710388
ep1_l3_test_time 0.3207533359527588
Test Epoch1 layer4 Acc 0.9160526315789473, AUC 0.9809237122535706, avg_entr 0.12206383794546127, f1 0.9160526394844055
ep1_l4_test_time 0.3225126266479492
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.92755 (111306/120000), AUC 0.985852837562561
ep2_train_time 25.41199493408203
Test Epoch2 layer0 Acc 0.9176315789473685, AUC 0.9817704558372498, avg_entr 0.11084359139204025, f1 0.9176315665245056
ep2_l0_test_time 0.3262319564819336
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.9205263157894736, AUC 0.9818922281265259, avg_entr 0.10537989437580109, f1 0.9205263257026672
ep2_l1_test_time 0.3305020332336426
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.92, AUC 0.9817935228347778, avg_entr 0.09993868321180344, f1 0.9200000166893005
ep2_l2_test_time 0.31699466705322266
Test Epoch2 layer3 Acc 0.92, AUC 0.9818541407585144, avg_entr 0.09474524110555649, f1 0.9200000166893005
ep2_l3_test_time 0.3085198402404785
Test Epoch2 layer4 Acc 0.9192105263157895, AUC 0.982434093952179, avg_entr 0.08299626410007477, f1 0.9192105531692505
ep2_l4_test_time 0.3288717269897461
gc 0
Train Epoch3 Acc 0.933475 (112017/120000), AUC 0.9881973266601562
ep3_train_time 25.394320964813232
Test Epoch3 layer0 Acc 0.9223684210526316, AUC 0.9823004007339478, avg_entr 0.09129732102155685, f1 0.9223684072494507
ep3_l0_test_time 0.32886624336242676
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.9213157894736842, AUC 0.9824070930480957, avg_entr 0.08690755814313889, f1 0.9213157892227173
ep3_l1_test_time 0.3296945095062256
Test Epoch3 layer2 Acc 0.9213157894736842, AUC 0.9824514389038086, avg_entr 0.08120141923427582, f1 0.9213157892227173
ep3_l2_test_time 0.3292055130004883
Test Epoch3 layer3 Acc 0.9228947368421052, AUC 0.9827313423156738, avg_entr 0.07209938019514084, f1 0.9228947162628174
ep3_l3_test_time 0.33394360542297363
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.9218421052631579, AUC 0.9833705425262451, avg_entr 0.05537872016429901, f1 0.921842098236084
ep3_l4_test_time 0.3261301517486572
gc 0
Train Epoch4 Acc 0.9376 (112512/120000), AUC 0.9896355867385864
ep4_train_time 25.304845333099365
Test Epoch4 layer0 Acc 0.9210526315789473, AUC 0.9825419187545776, avg_entr 0.08094472438097, f1 0.9210526347160339
ep4_l0_test_time 0.3221457004547119
Test Epoch4 layer1 Acc 0.9205263157894736, AUC 0.982578694820404, avg_entr 0.07704068720340729, f1 0.9205263257026672
ep4_l1_test_time 0.3295938968658447
Test Epoch4 layer2 Acc 0.9218421052631579, AUC 0.9827237129211426, avg_entr 0.07075079530477524, f1 0.921842098236084
ep4_l2_test_time 0.3227651119232178
Test Epoch4 layer3 Acc 0.9213157894736842, AUC 0.9830317497253418, avg_entr 0.0560896061360836, f1 0.9213157892227173
ep4_l3_test_time 0.3222017288208008
Test Epoch4 layer4 Acc 0.9205263157894736, AUC 0.9835917949676514, avg_entr 0.037514109164476395, f1 0.9205263257026672
ep4_l4_test_time 0.32782721519470215
gc 0
Train Epoch5 Acc 0.9403833333333333 (112846/120000), AUC 0.9902494549751282
ep5_train_time 25.381288290023804
Test Epoch5 layer0 Acc 0.9228947368421052, AUC 0.982674777507782, avg_entr 0.07252714782953262, f1 0.9228947162628174
ep5_l0_test_time 0.3335433006286621
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 5
Test Epoch5 layer1 Acc 0.9223684210526316, AUC 0.9827097058296204, avg_entr 0.069390207529068, f1 0.9223684072494507
ep5_l1_test_time 0.33070802688598633
Test Epoch5 layer2 Acc 0.9223684210526316, AUC 0.982839822769165, avg_entr 0.062271598726511, f1 0.9223684072494507
ep5_l2_test_time 0.3221611976623535
Test Epoch5 layer3 Acc 0.921578947368421, AUC 0.9831176996231079, avg_entr 0.0452454648911953, f1 0.9215789437294006
ep5_l3_test_time 0.32255125045776367
Test Epoch5 layer4 Acc 0.9210526315789473, AUC 0.9826624393463135, avg_entr 0.032032713294029236, f1 0.9210526347160339
ep5_l4_test_time 0.32799267768859863
gc 0
Train Epoch6 Acc 0.943225 (113187/120000), AUC 0.9909305572509766
ep6_train_time 25.40795111656189
Test Epoch6 layer0 Acc 0.9218421052631579, AUC 0.9826555252075195, avg_entr 0.06451766937971115, f1 0.921842098236084
ep6_l0_test_time 0.31870508193969727
Test Epoch6 layer1 Acc 0.921578947368421, AUC 0.9826103448867798, avg_entr 0.062161192297935486, f1 0.9215789437294006
ep6_l1_test_time 0.3146228790283203
Test Epoch6 layer2 Acc 0.9239473684210526, AUC 0.9829157590866089, avg_entr 0.05296437442302704, f1 0.9239473938941956
ep6_l2_test_time 0.33214664459228516
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 6
Test Epoch6 layer3 Acc 0.9234210526315789, AUC 0.9829584360122681, avg_entr 0.0327492319047451, f1 0.9234210252761841
ep6_l3_test_time 0.3266716003417969
Test Epoch6 layer4 Acc 0.9234210526315789, AUC 0.9807594418525696, avg_entr 0.02521907165646553, f1 0.9234210252761841
ep6_l4_test_time 0.33130383491516113
gc 0
Train Epoch7 Acc 0.94515 (113418/120000), AUC 0.9918272495269775
ep7_train_time 25.33259391784668
Test Epoch7 layer0 Acc 0.92, AUC 0.9825406074523926, avg_entr 0.06016935780644417, f1 0.9200000166893005
ep7_l0_test_time 0.32449913024902344
Test Epoch7 layer1 Acc 0.9202631578947369, AUC 0.9823896288871765, avg_entr 0.05811487138271332, f1 0.9202631711959839
ep7_l1_test_time 0.32388997077941895
Test Epoch7 layer2 Acc 0.9218421052631579, AUC 0.9831564426422119, avg_entr 0.046793725341558456, f1 0.921842098236084
ep7_l2_test_time 0.3332071304321289
Test Epoch7 layer3 Acc 0.9218421052631579, AUC 0.9826831817626953, avg_entr 0.026810459792613983, f1 0.921842098236084
ep7_l3_test_time 0.3263876438140869
Test Epoch7 layer4 Acc 0.9213157894736842, AUC 0.9822839498519897, avg_entr 0.02201097458600998, f1 0.9213157892227173
ep7_l4_test_time 0.31658339500427246
gc 0
Train Epoch8 Acc 0.9469916666666667 (113639/120000), AUC 0.9923746585845947
ep8_train_time 25.440454721450806
Test Epoch8 layer0 Acc 0.9218421052631579, AUC 0.9823559522628784, avg_entr 0.05673763528466225, f1 0.921842098236084
ep8_l0_test_time 0.32691192626953125
Test Epoch8 layer1 Acc 0.9221052631578948, AUC 0.9822964668273926, avg_entr 0.05509031191468239, f1 0.9221052527427673
ep8_l1_test_time 0.32592320442199707
Test Epoch8 layer2 Acc 0.9239473684210526, AUC 0.9832128882408142, avg_entr 0.040389534085989, f1 0.9239473938941956
ep8_l2_test_time 0.319195032119751
Save ckpt to ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt  ,ep 8
Test Epoch8 layer3 Acc 0.9218421052631579, AUC 0.9824379682540894, avg_entr 0.024011807516217232, f1 0.921842098236084
ep8_l3_test_time 0.3283565044403076
Test Epoch8 layer4 Acc 0.9223684210526316, AUC 0.9818459749221802, avg_entr 0.021389028057456017, f1 0.9223684072494507
ep8_l4_test_time 0.3214445114135742
gc 0
Train Epoch9 Acc 0.9486333333333333 (113836/120000), AUC 0.9929974675178528
ep9_train_time 25.40107822418213
Test Epoch9 layer0 Acc 0.9194736842105263, AUC 0.9822998642921448, avg_entr 0.05492253229022026, f1 0.9194737076759338
ep9_l0_test_time 0.32929277420043945
Test Epoch9 layer1 Acc 0.9197368421052632, AUC 0.9821460247039795, avg_entr 0.05311773344874382, f1 0.9197368621826172
ep9_l1_test_time 0.3264143466949463
Test Epoch9 layer2 Acc 0.9207894736842105, AUC 0.9830365777015686, avg_entr 0.03597868233919144, f1 0.9207894802093506
ep9_l2_test_time 0.3286564350128174
Test Epoch9 layer3 Acc 0.9218421052631579, AUC 0.9822845458984375, avg_entr 0.022684335708618164, f1 0.921842098236084
ep9_l3_test_time 0.32698512077331543
Test Epoch9 layer4 Acc 0.9218421052631579, AUC 0.9828181266784668, avg_entr 0.020732514560222626, f1 0.921842098236084
ep9_l4_test_time 0.33431124687194824
gc 0
Train Epoch10 Acc 0.9506 (114072/120000), AUC 0.9936257004737854
ep10_train_time 25.385735750198364
Test Epoch10 layer0 Acc 0.9213157894736842, AUC 0.9823641777038574, avg_entr 0.05154865235090256, f1 0.9213157892227173
ep10_l0_test_time 0.3281214237213135
Test Epoch10 layer1 Acc 0.9210526315789473, AUC 0.9822349548339844, avg_entr 0.05017852410674095, f1 0.9210526347160339
ep10_l1_test_time 0.3184092044830322
Test Epoch10 layer2 Acc 0.9223684210526316, AUC 0.9828914999961853, avg_entr 0.03197294846177101, f1 0.9223684072494507
ep10_l2_test_time 0.32999730110168457
Test Epoch10 layer3 Acc 0.921578947368421, AUC 0.9822653532028198, avg_entr 0.021327795460820198, f1 0.9215789437294006
ep10_l3_test_time 0.3330245018005371
Test Epoch10 layer4 Acc 0.9205263157894736, AUC 0.9827735424041748, avg_entr 0.018945256248116493, f1 0.9205263257026672
ep10_l4_test_time 0.32367539405822754
gc 0
Train Epoch11 Acc 0.951325 (114159/120000), AUC 0.9937961101531982
ep11_train_time 25.410033226013184
Test Epoch11 layer0 Acc 0.921578947368421, AUC 0.9822252988815308, avg_entr 0.04911956563591957, f1 0.9215789437294006
ep11_l0_test_time 0.3191392421722412
Test Epoch11 layer1 Acc 0.9218421052631579, AUC 0.9820312261581421, avg_entr 0.04815627261996269, f1 0.921842098236084
ep11_l1_test_time 0.33024168014526367
Test Epoch11 layer2 Acc 0.9221052631578948, AUC 0.9830182790756226, avg_entr 0.029522588476538658, f1 0.9221052527427673
ep11_l2_test_time 0.3298959732055664
Test Epoch11 layer3 Acc 0.9218421052631579, AUC 0.9823310375213623, avg_entr 0.02019619569182396, f1 0.921842098236084
ep11_l3_test_time 0.3227560520172119
Test Epoch11 layer4 Acc 0.9221052631578948, AUC 0.982883632183075, avg_entr 0.01836513727903366, f1 0.9221052527427673
ep11_l4_test_time 0.32319211959838867
gc 0
Train Epoch12 Acc 0.951875 (114225/120000), AUC 0.9939184188842773
ep12_train_time 25.247594118118286
Test Epoch12 layer0 Acc 0.9210526315789473, AUC 0.9821065664291382, avg_entr 0.046760350465774536, f1 0.9210526347160339
ep12_l0_test_time 0.3291935920715332
Test Epoch12 layer1 Acc 0.9207894736842105, AUC 0.9819175004959106, avg_entr 0.04588357359170914, f1 0.9207894802093506
ep12_l1_test_time 0.3322427272796631
Test Epoch12 layer2 Acc 0.9221052631578948, AUC 0.9831379055976868, avg_entr 0.028062870725989342, f1 0.9221052527427673
ep12_l2_test_time 0.3168606758117676
Test Epoch12 layer3 Acc 0.9228947368421052, AUC 0.9813650250434875, avg_entr 0.019672056660056114, f1 0.9228947162628174
ep12_l3_test_time 0.33048319816589355
Test Epoch12 layer4 Acc 0.9223684210526316, AUC 0.9815114736557007, avg_entr 0.017676793038845062, f1 0.9223684072494507
ep12_l4_test_time 0.33241915702819824
gc 0
Train Epoch13 Acc 0.9525916666666666 (114311/120000), AUC 0.9940890073776245
ep13_train_time 25.387038707733154
Test Epoch13 layer0 Acc 0.9210526315789473, AUC 0.9820759296417236, avg_entr 0.04511391744017601, f1 0.9210526347160339
ep13_l0_test_time 0.3204488754272461
Test Epoch13 layer1 Acc 0.9213157894736842, AUC 0.9818915724754333, avg_entr 0.044151972979307175, f1 0.9213157892227173
ep13_l1_test_time 0.3246471881866455
Test Epoch13 layer2 Acc 0.9210526315789473, AUC 0.9828999042510986, avg_entr 0.025791170075535774, f1 0.9210526347160339
ep13_l2_test_time 0.3245704174041748
Test Epoch13 layer3 Acc 0.9210526315789473, AUC 0.9820286631584167, avg_entr 0.01843199133872986, f1 0.9210526347160339
ep13_l3_test_time 0.3303709030151367
Test Epoch13 layer4 Acc 0.9213157894736842, AUC 0.9824999570846558, avg_entr 0.016703812405467033, f1 0.9213157892227173
ep13_l4_test_time 0.32718491554260254
gc 0
Train Epoch14 Acc 0.9536333333333333 (114436/120000), AUC 0.9943928122520447
ep14_train_time 25.4212908744812
Test Epoch14 layer0 Acc 0.9189473684210526, AUC 0.9820043444633484, avg_entr 0.04473140463232994, f1 0.9189472794532776
ep14_l0_test_time 0.32655858993530273
Test Epoch14 layer1 Acc 0.9202631578947369, AUC 0.9817987084388733, avg_entr 0.04382681846618652, f1 0.9202631711959839
ep14_l1_test_time 0.3147132396697998
Test Epoch14 layer2 Acc 0.9202631578947369, AUC 0.9825893044471741, avg_entr 0.02474987879395485, f1 0.9202631711959839
ep14_l2_test_time 0.326979398727417
Test Epoch14 layer3 Acc 0.9192105263157895, AUC 0.9814807772636414, avg_entr 0.017995722591876984, f1 0.9192105531692505
ep14_l3_test_time 0.32859086990356445
Test Epoch14 layer4 Acc 0.9197368421052632, AUC 0.9817922711372375, avg_entr 0.016578618437051773, f1 0.9197368621826172
ep14_l4_test_time 0.3339114189147949
gc 0
Train Epoch15 Acc 0.9538583333333334 (114463/120000), AUC 0.9944581985473633
ep15_train_time 25.387261629104614
Test Epoch15 layer0 Acc 0.9205263157894736, AUC 0.9819338917732239, avg_entr 0.04288213327527046, f1 0.9205263257026672
ep15_l0_test_time 0.3310673236846924
Test Epoch15 layer1 Acc 0.9197368421052632, AUC 0.9817111492156982, avg_entr 0.04187362641096115, f1 0.9197368621826172
ep15_l1_test_time 0.3237440586090088
Test Epoch15 layer2 Acc 0.9207894736842105, AUC 0.9827249050140381, avg_entr 0.024654751643538475, f1 0.9207894802093506
ep15_l2_test_time 0.3268575668334961
Test Epoch15 layer3 Acc 0.92, AUC 0.9816434383392334, avg_entr 0.0181396696716547, f1 0.9200000166893005
ep15_l3_test_time 0.33046579360961914
Test Epoch15 layer4 Acc 0.9205263157894736, AUC 0.9805912375450134, avg_entr 0.016773320734500885, f1 0.9205263257026672
ep15_l4_test_time 0.31857967376708984
gc 0
Train Epoch16 Acc 0.9540416666666667 (114485/120000), AUC 0.9943848252296448
ep16_train_time 25.39002251625061
Test Epoch16 layer0 Acc 0.9202631578947369, AUC 0.9818794131278992, avg_entr 0.041820090264081955, f1 0.9202631711959839
ep16_l0_test_time 0.32911205291748047
Test Epoch16 layer1 Acc 0.9210526315789473, AUC 0.9816263914108276, avg_entr 0.04094504192471504, f1 0.9210526347160339
ep16_l1_test_time 0.3281393051147461
Test Epoch16 layer2 Acc 0.9205263157894736, AUC 0.9826268553733826, avg_entr 0.022770995274186134, f1 0.9205263257026672
ep16_l2_test_time 0.32755422592163086
Test Epoch16 layer3 Acc 0.9202631578947369, AUC 0.9818937182426453, avg_entr 0.017206942662596703, f1 0.9202631711959839
ep16_l3_test_time 0.32999157905578613
Test Epoch16 layer4 Acc 0.9205263157894736, AUC 0.9819908738136292, avg_entr 0.015996957197785378, f1 0.9205263257026672
ep16_l4_test_time 0.32996082305908203
gc 0
Train Epoch17 Acc 0.9544583333333333 (114535/120000), AUC 0.9945641756057739
ep17_train_time 25.39415740966797
Test Epoch17 layer0 Acc 0.9207894736842105, AUC 0.9818836450576782, avg_entr 0.040428198873996735, f1 0.9207894802093506
ep17_l0_test_time 0.3155710697174072
Test Epoch17 layer1 Acc 0.9213157894736842, AUC 0.9816360473632812, avg_entr 0.03964295610785484, f1 0.9213157892227173
ep17_l1_test_time 0.3206343650817871
Test Epoch17 layer2 Acc 0.9210526315789473, AUC 0.9825006723403931, avg_entr 0.02206415683031082, f1 0.9210526347160339
ep17_l2_test_time 0.3275754451751709
Test Epoch17 layer3 Acc 0.9202631578947369, AUC 0.9815106391906738, avg_entr 0.016320712864398956, f1 0.9202631711959839
ep17_l3_test_time 0.3265557289123535
Test Epoch17 layer4 Acc 0.9202631578947369, AUC 0.9811714887619019, avg_entr 0.014933445490896702, f1 0.9202631711959839
ep17_l4_test_time 0.3383457660675049
gc 0
Train Epoch18 Acc 0.9549833333333333 (114598/120000), AUC 0.994754433631897
ep18_train_time 25.42707371711731
Test Epoch18 layer0 Acc 0.9205263157894736, AUC 0.9818626642227173, avg_entr 0.03958833962678909, f1 0.9205263257026672
ep18_l0_test_time 0.3183603286743164
Test Epoch18 layer1 Acc 0.9213157894736842, AUC 0.9815726280212402, avg_entr 0.0388784222304821, f1 0.9213157892227173
ep18_l1_test_time 0.32123303413391113
Test Epoch18 layer2 Acc 0.9205263157894736, AUC 0.9821586608886719, avg_entr 0.021641965955495834, f1 0.9205263257026672
ep18_l2_test_time 0.3224925994873047
Test Epoch18 layer3 Acc 0.92, AUC 0.9815170764923096, avg_entr 0.01612219028174877, f1 0.9200000166893005
ep18_l3_test_time 0.32941317558288574
Test Epoch18 layer4 Acc 0.92, AUC 0.980709433555603, avg_entr 0.014742794446647167, f1 0.9200000166893005
ep18_l4_test_time 0.3241417407989502
gc 0
Train Epoch19 Acc 0.9551083333333333 (114613/120000), AUC 0.9947669506072998
ep19_train_time 25.458683490753174
Test Epoch19 layer0 Acc 0.9202631578947369, AUC 0.9818829894065857, avg_entr 0.038828909397125244, f1 0.9202631711959839
ep19_l0_test_time 0.32518815994262695
Test Epoch19 layer1 Acc 0.9205263157894736, AUC 0.9815322160720825, avg_entr 0.03806280344724655, f1 0.9205263257026672
ep19_l1_test_time 0.31479620933532715
Test Epoch19 layer2 Acc 0.9186842105263158, AUC 0.9821992516517639, avg_entr 0.02099468559026718, f1 0.918684184551239
ep19_l2_test_time 0.3239889144897461
Test Epoch19 layer3 Acc 0.92, AUC 0.9813710451126099, avg_entr 0.016681473702192307, f1 0.9200000166893005
ep19_l3_test_time 0.3292412757873535
Test Epoch19 layer4 Acc 0.9194736842105263, AUC 0.9807157516479492, avg_entr 0.015492349863052368, f1 0.9194737076759338
ep19_l4_test_time 0.3297288417816162
gc 0
Train Epoch20 Acc 0.955025 (114603/120000), AUC 0.9946578741073608
ep20_train_time 25.33620047569275
Test Epoch20 layer0 Acc 0.9205263157894736, AUC 0.9818894863128662, avg_entr 0.03774141147732735, f1 0.9205263257026672
ep20_l0_test_time 0.32361459732055664
Test Epoch20 layer1 Acc 0.92, AUC 0.9815790057182312, avg_entr 0.03701968491077423, f1 0.9200000166893005
ep20_l1_test_time 0.3228874206542969
Test Epoch20 layer2 Acc 0.9207894736842105, AUC 0.9821897149085999, avg_entr 0.020787861198186874, f1 0.9207894802093506
ep20_l2_test_time 0.327258825302124
Test Epoch20 layer3 Acc 0.92, AUC 0.9811593890190125, avg_entr 0.01599743962287903, f1 0.9200000166893005
ep20_l3_test_time 0.330214262008667
Test Epoch20 layer4 Acc 0.9202631578947369, AUC 0.9807828664779663, avg_entr 0.014293113723397255, f1 0.9202631711959839
ep20_l4_test_time 0.33757591247558594
gc 0
Train Epoch21 Acc 0.9552416666666667 (114629/120000), AUC 0.994712233543396
ep21_train_time 25.443257093429565
Test Epoch21 layer0 Acc 0.92, AUC 0.9818814992904663, avg_entr 0.037519391626119614, f1 0.9200000166893005
ep21_l0_test_time 0.3253040313720703
Test Epoch21 layer1 Acc 0.9202631578947369, AUC 0.981621265411377, avg_entr 0.03680836781859398, f1 0.9202631711959839
ep21_l1_test_time 0.3353877067565918
Test Epoch21 layer2 Acc 0.9194736842105263, AUC 0.9822189807891846, avg_entr 0.01957748457789421, f1 0.9194737076759338
ep21_l2_test_time 0.3219919204711914
Test Epoch21 layer3 Acc 0.9194736842105263, AUC 0.9815564751625061, avg_entr 0.015638751909136772, f1 0.9194737076759338
ep21_l3_test_time 0.3226351737976074
Test Epoch21 layer4 Acc 0.9178947368421052, AUC 0.9805485010147095, avg_entr 0.014265230856835842, f1 0.917894721031189
ep21_l4_test_time 0.3147401809692383
gc 0
Train Epoch22 Acc 0.9555666666666667 (114668/120000), AUC 0.9948426485061646
ep22_train_time 25.38956379890442
Test Epoch22 layer0 Acc 0.9197368421052632, AUC 0.9818345308303833, avg_entr 0.03687910735607147, f1 0.9197368621826172
ep22_l0_test_time 0.3315408229827881
Test Epoch22 layer1 Acc 0.9205263157894736, AUC 0.9814513325691223, avg_entr 0.03614388033747673, f1 0.9205263257026672
ep22_l1_test_time 0.32895874977111816
Test Epoch22 layer2 Acc 0.9192105263157895, AUC 0.9822564125061035, avg_entr 0.019134413450956345, f1 0.9192105531692505
ep22_l2_test_time 0.3236093521118164
Test Epoch22 layer3 Acc 0.92, AUC 0.9813603162765503, avg_entr 0.01537859532982111, f1 0.9200000166893005
ep22_l3_test_time 0.33553576469421387
Test Epoch22 layer4 Acc 0.9194736842105263, AUC 0.9812489151954651, avg_entr 0.014262448064982891, f1 0.9194737076759338
ep22_l4_test_time 0.33289194107055664
gc 0
Train Epoch23 Acc 0.9556083333333333 (114673/120000), AUC 0.9948873519897461
ep23_train_time 25.41496467590332
Test Epoch23 layer0 Acc 0.9213157894736842, AUC 0.9818338751792908, avg_entr 0.036351077258586884, f1 0.9213157892227173
ep23_l0_test_time 0.33093857765197754
Test Epoch23 layer1 Acc 0.9205263157894736, AUC 0.981505274772644, avg_entr 0.03555247560143471, f1 0.9205263257026672
ep23_l1_test_time 0.31863903999328613
Test Epoch23 layer2 Acc 0.92, AUC 0.982211172580719, avg_entr 0.0192726980894804, f1 0.9200000166893005
ep23_l2_test_time 0.31943655014038086
Test Epoch23 layer3 Acc 0.9194736842105263, AUC 0.98140549659729, avg_entr 0.014950159937143326, f1 0.9194737076759338
ep23_l3_test_time 0.3331432342529297
Test Epoch23 layer4 Acc 0.9197368421052632, AUC 0.9807909727096558, avg_entr 0.013487803749740124, f1 0.9197368621826172
ep23_l4_test_time 0.32575201988220215
gc 0
Train Epoch24 Acc 0.9557583333333334 (114691/120000), AUC 0.994888424873352
ep24_train_time 25.35429334640503
Test Epoch24 layer0 Acc 0.9205263157894736, AUC 0.9818398952484131, avg_entr 0.03582023084163666, f1 0.9205263257026672
ep24_l0_test_time 0.3321707248687744
Test Epoch24 layer1 Acc 0.9205263157894736, AUC 0.9815537929534912, avg_entr 0.03500339016318321, f1 0.9205263257026672
ep24_l1_test_time 0.3262441158294678
Test Epoch24 layer2 Acc 0.9202631578947369, AUC 0.9820398092269897, avg_entr 0.019256873056292534, f1 0.9202631711959839
ep24_l2_test_time 0.33020663261413574
Test Epoch24 layer3 Acc 0.92, AUC 0.9813859462738037, avg_entr 0.014933789148926735, f1 0.9200000166893005
ep24_l3_test_time 0.3319535255432129
Test Epoch24 layer4 Acc 0.9197368421052632, AUC 0.9806523323059082, avg_entr 0.013294832780957222, f1 0.9197368621826172
ep24_l4_test_time 0.327007532119751
gc 0
Train Epoch25 Acc 0.9558416666666667 (114701/120000), AUC 0.9948795437812805
ep25_train_time 25.444812774658203
Test Epoch25 layer0 Acc 0.9197368421052632, AUC 0.9818320274353027, avg_entr 0.03591269254684448, f1 0.9197368621826172
ep25_l0_test_time 0.3169214725494385
Test Epoch25 layer1 Acc 0.9197368421052632, AUC 0.9814758896827698, avg_entr 0.035151708871126175, f1 0.9197368621826172
ep25_l1_test_time 0.325164794921875
Test Epoch25 layer2 Acc 0.9194736842105263, AUC 0.9822615385055542, avg_entr 0.0181413684040308, f1 0.9194737076759338
ep25_l2_test_time 0.33601951599121094
Test Epoch25 layer3 Acc 0.9171052631578948, AUC 0.9815160036087036, avg_entr 0.014322048053145409, f1 0.9171052575111389
ep25_l3_test_time 0.3315165042877197
Test Epoch25 layer4 Acc 0.9176315789473685, AUC 0.9812583327293396, avg_entr 0.013145266100764275, f1 0.9176315665245056
ep25_l4_test_time 0.32419538497924805
gc 0
Train Epoch26 Acc 0.9559 (114708/120000), AUC 0.9949720501899719
ep26_train_time 25.41734480857849
Test Epoch26 layer0 Acc 0.9197368421052632, AUC 0.9818224906921387, avg_entr 0.035779401659965515, f1 0.9197368621826172
ep26_l0_test_time 0.3235146999359131
Test Epoch26 layer1 Acc 0.92, AUC 0.981483519077301, avg_entr 0.03495590388774872, f1 0.9200000166893005
ep26_l1_test_time 0.32872962951660156
Test Epoch26 layer2 Acc 0.9192105263157895, AUC 0.9821645021438599, avg_entr 0.01811882294714451, f1 0.9192105531692505
ep26_l2_test_time 0.3339571952819824
Test Epoch26 layer3 Acc 0.9181578947368421, AUC 0.9817079305648804, avg_entr 0.014282429590821266, f1 0.9181578755378723
ep26_l3_test_time 0.333404541015625
Test Epoch26 layer4 Acc 0.9184210526315789, AUC 0.9813624620437622, avg_entr 0.012973681092262268, f1 0.9184210896492004
ep26_l4_test_time 0.33376383781433105
gc 0
Train Epoch27 Acc 0.9559333333333333 (114712/120000), AUC 0.9949331283569336
ep27_train_time 25.42492413520813
Test Epoch27 layer0 Acc 0.9197368421052632, AUC 0.9818259477615356, avg_entr 0.03575380891561508, f1 0.9197368621826172
ep27_l0_test_time 0.31751155853271484
Test Epoch27 layer1 Acc 0.9207894736842105, AUC 0.9814705848693848, avg_entr 0.03479311987757683, f1 0.9207894802093506
ep27_l1_test_time 0.3327462673187256
Test Epoch27 layer2 Acc 0.9194736842105263, AUC 0.9820631742477417, avg_entr 0.01821400783956051, f1 0.9194737076759338
ep27_l2_test_time 0.33026623725891113
Test Epoch27 layer3 Acc 0.9186842105263158, AUC 0.9813942909240723, avg_entr 0.014463838189840317, f1 0.918684184551239
ep27_l3_test_time 0.3189826011657715
Test Epoch27 layer4 Acc 0.9192105263157895, AUC 0.9808592796325684, avg_entr 0.013030258007347584, f1 0.9192105531692505
ep27_l4_test_time 0.3335568904876709
gc 0
Train Epoch28 Acc 0.9560583333333333 (114727/120000), AUC 0.9949802160263062
ep28_train_time 25.35874652862549
Test Epoch28 layer0 Acc 0.9202631578947369, AUC 0.9818242788314819, avg_entr 0.035291824489831924, f1 0.9202631711959839
ep28_l0_test_time 0.32168054580688477
Test Epoch28 layer1 Acc 0.9197368421052632, AUC 0.9814838767051697, avg_entr 0.03443057835102081, f1 0.9197368621826172
ep28_l1_test_time 0.32337093353271484
Test Epoch28 layer2 Acc 0.9194736842105263, AUC 0.982048511505127, avg_entr 0.018035510554909706, f1 0.9194737076759338
ep28_l2_test_time 0.32759952545166016
Test Epoch28 layer3 Acc 0.9194736842105263, AUC 0.9814074635505676, avg_entr 0.014138221740722656, f1 0.9194737076759338
ep28_l3_test_time 0.32402515411376953
Test Epoch28 layer4 Acc 0.9197368421052632, AUC 0.9804531335830688, avg_entr 0.012783107347786427, f1 0.9197368621826172
ep28_l4_test_time 0.33097410202026367
gc 0
Train Epoch29 Acc 0.9559666666666666 (114716/120000), AUC 0.9949958324432373
ep29_train_time 25.37032413482666
Test Epoch29 layer0 Acc 0.9205263157894736, AUC 0.9818172454833984, avg_entr 0.03526410833001137, f1 0.9205263257026672
ep29_l0_test_time 0.33335256576538086
Test Epoch29 layer1 Acc 0.9197368421052632, AUC 0.9814658761024475, avg_entr 0.03431019186973572, f1 0.9197368621826172
ep29_l1_test_time 0.3174917697906494
Test Epoch29 layer2 Acc 0.9194736842105263, AUC 0.9821089506149292, avg_entr 0.01787257194519043, f1 0.9194737076759338
ep29_l2_test_time 0.32122802734375
Test Epoch29 layer3 Acc 0.9194736842105263, AUC 0.9815493822097778, avg_entr 0.014002993702888489, f1 0.9194737076759338
ep29_l3_test_time 0.3235807418823242
Test Epoch29 layer4 Acc 0.9194736842105263, AUC 0.9809858202934265, avg_entr 0.012666257098317146, f1 0.9194737076759338
ep29_l4_test_time 0.3264153003692627
Best AUC tensor(0.9239) 8 2
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 814.3933930397034
Start Testing
Load ckpt at ckpt/ag_news_linearal_l5_pad177//ag_news_linearal_l5.pt
Test layer0 Acc 0.9126315789473685, AUC 0.9806351661682129, avg_entr 0.062171876430511475, f1 0.9126315712928772
l0_test_time 0.3144419193267822
Test layer1 Acc 0.9147368421052632, AUC 0.9804828763008118, avg_entr 0.0604335255920887, f1 0.9147368669509888
l1_test_time 0.32555389404296875
Test layer2 Acc 0.9134210526315789, AUC 0.9821853637695312, avg_entr 0.04593086242675781, f1 0.9134210348129272
l2_test_time 0.32594799995422363
Test layer3 Acc 0.9123684210526316, AUC 0.9802716970443726, avg_entr 0.02769194357097149, f1 0.9123684167861938
l3_test_time 0.33528780937194824
Test layer4 Acc 0.9123684210526316, AUC 0.9790316820144653, avg_entr 0.02364465594291687, f1 0.9123684167861938
l4_test_time 0.3301091194152832
