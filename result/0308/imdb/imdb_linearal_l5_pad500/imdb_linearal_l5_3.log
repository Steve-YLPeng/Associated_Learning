total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 23.6672625541687
Start Training
gc 0
Train Epoch0 Acc 0.496875 (19875/40000), AUC 0.48951148986816406
ep0_train_time 12.30041766166687
Test Epoch0 layer0 Acc 0.815, AUC 0.8872888684272766, avg_entr 0.5670477747917175, f1 0.8149999976158142
ep0_l0_test_time 0.7517483234405518
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7312, AUC 0.8683128356933594, avg_entr 0.6851518154144287, f1 0.7311999797821045
ep0_l1_test_time 0.7685472965240479
Test Epoch0 layer2 Acc 0.6152, AUC 0.8469866514205933, avg_entr 0.6866231560707092, f1 0.6151999831199646
ep0_l2_test_time 0.7661335468292236
Test Epoch0 layer3 Acc 0.521, AUC 0.8264598846435547, avg_entr 0.6866816878318787, f1 0.5210000276565552
ep0_l3_test_time 0.7674045562744141
Test Epoch0 layer4 Acc 0.5, AUC 0.6050218343734741, avg_entr 0.6894770264625549, f1 0.5
ep0_l4_test_time 0.7572975158691406
gc 0
Train Epoch1 Acc 0.799125 (31965/40000), AUC 0.8856278657913208
ep1_train_time 11.24016284942627
Test Epoch1 layer0 Acc 0.8784, AUC 0.945544421672821, avg_entr 0.2884966731071472, f1 0.8784000277519226
ep1_l0_test_time 0.7772533893585205
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.881, AUC 0.9459583759307861, avg_entr 0.3578009307384491, f1 0.8809999823570251
ep1_l1_test_time 0.7657811641693115
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8822, AUC 0.9461300373077393, avg_entr 0.2361626774072647, f1 0.8822000026702881
ep1_l2_test_time 0.7645528316497803
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.8798, AUC 0.9458920359611511, avg_entr 0.246339812874794, f1 0.879800021648407
ep1_l3_test_time 0.7587311267852783
Test Epoch1 layer4 Acc 0.8812, AUC 0.9460315108299255, avg_entr 0.23730546236038208, f1 0.8812000155448914
ep1_l4_test_time 0.7658541202545166
gc 0
Train Epoch2 Acc 0.906075 (36243/40000), AUC 0.9648354649543762
ep2_train_time 11.261877298355103
Test Epoch2 layer0 Acc 0.8926, AUC 0.955322265625, avg_entr 0.2247919738292694, f1 0.8925999999046326
ep2_l0_test_time 0.7743337154388428
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8928, AUC 0.9557609558105469, avg_entr 0.2136455625295639, f1 0.892799973487854
ep2_l1_test_time 0.7600607872009277
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8916, AUC 0.9560157656669617, avg_entr 0.18620295822620392, f1 0.8916000127792358
ep2_l2_test_time 0.7774753570556641
Test Epoch2 layer3 Acc 0.8898, AUC 0.9560480117797852, avg_entr 0.18275205790996552, f1 0.8898000121116638
ep2_l3_test_time 0.7572755813598633
Test Epoch2 layer4 Acc 0.8912, AUC 0.9561463594436646, avg_entr 0.1644047498703003, f1 0.8912000060081482
ep2_l4_test_time 0.7596762180328369
gc 0
Train Epoch3 Acc 0.9228 (36912/40000), AUC 0.9753769040107727
ep3_train_time 11.21241569519043
Test Epoch3 layer0 Acc 0.8976, AUC 0.9585356712341309, avg_entr 0.19319641590118408, f1 0.897599995136261
ep3_l0_test_time 0.7579586505889893
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.898, AUC 0.9588344693183899, avg_entr 0.17458029091358185, f1 0.8980000019073486
ep3_l1_test_time 0.7612113952636719
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8978, AUC 0.9591578245162964, avg_entr 0.1592070758342743, f1 0.8978000283241272
ep3_l2_test_time 0.7696795463562012
Test Epoch3 layer3 Acc 0.897, AUC 0.9592957496643066, avg_entr 0.14916400611400604, f1 0.8970000147819519
ep3_l3_test_time 0.7681496143341064
Test Epoch3 layer4 Acc 0.8972, AUC 0.9593279361724854, avg_entr 0.12280841916799545, f1 0.8971999883651733
ep3_l4_test_time 0.7661724090576172
gc 0
Train Epoch4 Acc 0.9325 (37300/40000), AUC 0.9811618328094482
ep4_train_time 11.193865299224854
Test Epoch4 layer0 Acc 0.898, AUC 0.9590171575546265, avg_entr 0.1774487942457199, f1 0.8980000019073486
ep4_l0_test_time 0.7629554271697998
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8986, AUC 0.9595815539360046, avg_entr 0.15626664459705353, f1 0.8985999822616577
ep4_l1_test_time 0.7635369300842285
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8998, AUC 0.9601106643676758, avg_entr 0.14213953912258148, f1 0.8998000025749207
ep4_l2_test_time 0.7582895755767822
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer3 Acc 0.8976, AUC 0.9605058431625366, avg_entr 0.1168447732925415, f1 0.897599995136261
ep4_l3_test_time 0.7701423168182373
Test Epoch4 layer4 Acc 0.8978, AUC 0.9607057571411133, avg_entr 0.08895739912986755, f1 0.8978000283241272
ep4_l4_test_time 0.7592177391052246
gc 0
Train Epoch5 Acc 0.9424 (37696/40000), AUC 0.9849919080734253
ep5_train_time 11.205902338027954
Test Epoch5 layer0 Acc 0.898, AUC 0.958785891532898, avg_entr 0.16239845752716064, f1 0.8980000019073486
ep5_l0_test_time 0.7599809169769287
Test Epoch5 layer1 Acc 0.8986, AUC 0.9592735767364502, avg_entr 0.1415998488664627, f1 0.8985999822616577
ep5_l1_test_time 0.7564029693603516
Test Epoch5 layer2 Acc 0.896, AUC 0.9598803520202637, avg_entr 0.12676668167114258, f1 0.8960000276565552
ep5_l2_test_time 0.7559099197387695
Test Epoch5 layer3 Acc 0.8956, AUC 0.9605790376663208, avg_entr 0.0929589793086052, f1 0.8956000208854675
ep5_l3_test_time 0.7757477760314941
Test Epoch5 layer4 Acc 0.8948, AUC 0.960757851600647, avg_entr 0.06660211831331253, f1 0.8948000073432922
ep5_l4_test_time 0.7668440341949463
gc 0
Train Epoch6 Acc 0.94855 (37942/40000), AUC 0.9875171184539795
ep6_train_time 11.218254804611206
Test Epoch6 layer0 Acc 0.891, AUC 0.9575040340423584, avg_entr 0.14974534511566162, f1 0.890999972820282
ep6_l0_test_time 0.755906343460083
Test Epoch6 layer1 Acc 0.8944, AUC 0.9581077098846436, avg_entr 0.12857726216316223, f1 0.8944000005722046
ep6_l1_test_time 0.7746315002441406
Test Epoch6 layer2 Acc 0.8962, AUC 0.9588128328323364, avg_entr 0.10968635231256485, f1 0.8962000012397766
ep6_l2_test_time 0.7619233131408691
Test Epoch6 layer3 Acc 0.895, AUC 0.9594785571098328, avg_entr 0.07296758145093918, f1 0.8949999809265137
ep6_l3_test_time 0.7788066864013672
Test Epoch6 layer4 Acc 0.8958, AUC 0.9582004547119141, avg_entr 0.049005117267370224, f1 0.895799994468689
ep6_l4_test_time 0.7597942352294922
gc 0
Train Epoch7 Acc 0.95325 (38130/40000), AUC 0.9890669584274292
ep7_train_time 11.250210046768188
Test Epoch7 layer0 Acc 0.8932, AUC 0.9556626081466675, avg_entr 0.1446821540594101, f1 0.8931999802589417
ep7_l0_test_time 0.765444278717041
Test Epoch7 layer1 Acc 0.8936, AUC 0.9566125869750977, avg_entr 0.12422072887420654, f1 0.8935999870300293
ep7_l1_test_time 0.7691643238067627
Test Epoch7 layer2 Acc 0.8962, AUC 0.9577605724334717, avg_entr 0.10530610382556915, f1 0.8962000012397766
ep7_l2_test_time 0.770042896270752
Test Epoch7 layer3 Acc 0.895, AUC 0.9580363631248474, avg_entr 0.06448709219694138, f1 0.8949999809265137
ep7_l3_test_time 0.7805657386779785
Test Epoch7 layer4 Acc 0.8956, AUC 0.9552649259567261, avg_entr 0.04248415678739548, f1 0.8956000208854675
ep7_l4_test_time 0.7576174736022949
gc 0
Train Epoch8 Acc 0.95805 (38322/40000), AUC 0.9906610250473022
ep8_train_time 11.168408393859863
Test Epoch8 layer0 Acc 0.8874, AUC 0.9541420936584473, avg_entr 0.14138273894786835, f1 0.8873999714851379
ep8_l0_test_time 0.7709639072418213
Test Epoch8 layer1 Acc 0.8888, AUC 0.9551374912261963, avg_entr 0.12148118764162064, f1 0.8888000249862671
ep8_l1_test_time 0.7633862495422363
Test Epoch8 layer2 Acc 0.8854, AUC 0.9563783407211304, avg_entr 0.1001904308795929, f1 0.8853999972343445
ep8_l2_test_time 0.7611832618713379
Test Epoch8 layer3 Acc 0.8862, AUC 0.9561331272125244, avg_entr 0.0608101487159729, f1 0.8862000107765198
ep8_l3_test_time 0.7753207683563232
Test Epoch8 layer4 Acc 0.8872, AUC 0.9536173343658447, avg_entr 0.04173024371266365, f1 0.8871999979019165
ep8_l4_test_time 0.7587664127349854
gc 0
Train Epoch9 Acc 0.962925 (38517/40000), AUC 0.9925740957260132
ep9_train_time 11.130929231643677
Test Epoch9 layer0 Acc 0.8908, AUC 0.9532092809677124, avg_entr 0.13267044723033905, f1 0.8907999992370605
ep9_l0_test_time 0.748976469039917
Test Epoch9 layer1 Acc 0.8916, AUC 0.9541038870811462, avg_entr 0.1125154197216034, f1 0.8916000127792358
ep9_l1_test_time 0.7588663101196289
Test Epoch9 layer2 Acc 0.895, AUC 0.9548001885414124, avg_entr 0.09016552567481995, f1 0.8949999809265137
ep9_l2_test_time 0.7792961597442627
Test Epoch9 layer3 Acc 0.8932, AUC 0.9539971351623535, avg_entr 0.05044456943869591, f1 0.8931999802589417
ep9_l3_test_time 0.7576003074645996
Test Epoch9 layer4 Acc 0.894, AUC 0.9509660005569458, avg_entr 0.03371946141123772, f1 0.8939999938011169
ep9_l4_test_time 0.7614824771881104
gc 0
Train Epoch10 Acc 0.964675 (38587/40000), AUC 0.9931000471115112
ep10_train_time 11.228071689605713
Test Epoch10 layer0 Acc 0.888, AUC 0.9523742198944092, avg_entr 0.12924771010875702, f1 0.8880000114440918
ep10_l0_test_time 0.7687466144561768
Test Epoch10 layer1 Acc 0.8914, AUC 0.9533628821372986, avg_entr 0.10973472893238068, f1 0.8913999795913696
ep10_l1_test_time 0.7621443271636963
Test Epoch10 layer2 Acc 0.8924, AUC 0.9541214108467102, avg_entr 0.08714616298675537, f1 0.8923999667167664
ep10_l2_test_time 0.7588968276977539
Test Epoch10 layer3 Acc 0.8916, AUC 0.9526759386062622, avg_entr 0.046846624463796616, f1 0.8916000127792358
ep10_l3_test_time 0.7720930576324463
Test Epoch10 layer4 Acc 0.8918, AUC 0.9503909349441528, avg_entr 0.030961941927671432, f1 0.8917999863624573
ep10_l4_test_time 0.7695145606994629
gc 0
Train Epoch11 Acc 0.96615 (38646/40000), AUC 0.9937088489532471
ep11_train_time 11.208420991897583
Test Epoch11 layer0 Acc 0.8864, AUC 0.9511053562164307, avg_entr 0.13029861450195312, f1 0.8863999843597412
ep11_l0_test_time 0.7632486820220947
Test Epoch11 layer1 Acc 0.8894, AUC 0.9523212909698486, avg_entr 0.10980107635259628, f1 0.8894000053405762
ep11_l1_test_time 0.7736978530883789
Test Epoch11 layer2 Acc 0.887, AUC 0.9533452391624451, avg_entr 0.08607248216867447, f1 0.8870000243186951
ep11_l2_test_time 0.7501957416534424
Test Epoch11 layer3 Acc 0.8876, AUC 0.9513814449310303, avg_entr 0.04505308344960213, f1 0.8876000046730042
ep11_l3_test_time 0.7710716724395752
Test Epoch11 layer4 Acc 0.8884, AUC 0.9491451978683472, avg_entr 0.02993381954729557, f1 0.8884000182151794
ep11_l4_test_time 0.7609395980834961
gc 0
Train Epoch12 Acc 0.967925 (38717/40000), AUC 0.9941272735595703
ep12_train_time 10.717877864837646
Test Epoch12 layer0 Acc 0.8886, AUC 0.950004518032074, avg_entr 0.1251625269651413, f1 0.8885999917984009
ep12_l0_test_time 0.603919506072998
Test Epoch12 layer1 Acc 0.8888, AUC 0.9511784315109253, avg_entr 0.10601423680782318, f1 0.8888000249862671
ep12_l1_test_time 0.5865073204040527
Test Epoch12 layer2 Acc 0.8876, AUC 0.9518842697143555, avg_entr 0.08152779191732407, f1 0.8876000046730042
ep12_l2_test_time 0.593106746673584
Test Epoch12 layer3 Acc 0.8872, AUC 0.9492073059082031, avg_entr 0.04155711829662323, f1 0.8871999979019165
ep12_l3_test_time 0.5608310699462891
Test Epoch12 layer4 Acc 0.888, AUC 0.9469637870788574, avg_entr 0.02796027436852455, f1 0.8880000114440918
ep12_l4_test_time 0.5700650215148926
gc 0
Train Epoch13 Acc 0.969475 (38779/40000), AUC 0.9948101043701172
ep13_train_time 6.611299514770508
Test Epoch13 layer0 Acc 0.8866, AUC 0.9493070840835571, avg_entr 0.12491751462221146, f1 0.8866000771522522
ep13_l0_test_time 0.5544369220733643
Test Epoch13 layer1 Acc 0.8864, AUC 0.9505188465118408, avg_entr 0.10561193525791168, f1 0.8863999843597412
ep13_l1_test_time 0.5604000091552734
Test Epoch13 layer2 Acc 0.8858, AUC 0.9511991739273071, avg_entr 0.08088915795087814, f1 0.8858000040054321
ep13_l2_test_time 0.5528042316436768
Test Epoch13 layer3 Acc 0.8854, AUC 0.9485898017883301, avg_entr 0.040208589285612106, f1 0.8853999972343445
ep13_l3_test_time 0.5661494731903076
Test Epoch13 layer4 Acc 0.8864, AUC 0.9461881518363953, avg_entr 0.02737891860306263, f1 0.8863999843597412
ep13_l4_test_time 0.5841059684753418
gc 0
Train Epoch14 Acc 0.97 (38800/40000), AUC 0.9949055314064026
ep14_train_time 6.69118070602417
Test Epoch14 layer0 Acc 0.8866, AUC 0.9489307999610901, avg_entr 0.12253829091787338, f1 0.8866000771522522
ep14_l0_test_time 0.5543582439422607
Test Epoch14 layer1 Acc 0.8856, AUC 0.9501924514770508, avg_entr 0.10344149172306061, f1 0.8855999708175659
ep14_l1_test_time 0.5587210655212402
Test Epoch14 layer2 Acc 0.8858, AUC 0.9510439038276672, avg_entr 0.07813803851604462, f1 0.8858000040054321
ep14_l2_test_time 0.5934107303619385
Test Epoch14 layer3 Acc 0.8862, AUC 0.947442889213562, avg_entr 0.03930649161338806, f1 0.8862000107765198
ep14_l3_test_time 0.5926876068115234
Test Epoch14 layer4 Acc 0.886, AUC 0.9441176652908325, avg_entr 0.02702813409268856, f1 0.8859999775886536
ep14_l4_test_time 0.7180674076080322
gc 0
Train Epoch15 Acc 0.9708 (38832/40000), AUC 0.9950413703918457
ep15_train_time 11.150168657302856
Test Epoch15 layer0 Acc 0.8838, AUC 0.9481874704360962, avg_entr 0.12088632583618164, f1 0.8838000297546387
ep15_l0_test_time 0.7380595207214355
Test Epoch15 layer1 Acc 0.8848, AUC 0.9494336247444153, avg_entr 0.10193738341331482, f1 0.8848000168800354
ep15_l1_test_time 0.7347209453582764
Test Epoch15 layer2 Acc 0.8842, AUC 0.950016438961029, avg_entr 0.0764886811375618, f1 0.8842000365257263
ep15_l2_test_time 0.7656040191650391
Test Epoch15 layer3 Acc 0.885, AUC 0.9467087984085083, avg_entr 0.03794467821717262, f1 0.8849999904632568
ep15_l3_test_time 0.7528557777404785
Test Epoch15 layer4 Acc 0.8852, AUC 0.9459816217422485, avg_entr 0.02618935890495777, f1 0.8852000832557678
ep15_l4_test_time 0.7497808933258057
gc 0
Train Epoch16 Acc 0.971525 (38861/40000), AUC 0.9954332113265991
ep16_train_time 11.175103664398193
Test Epoch16 layer0 Acc 0.883, AUC 0.9476157426834106, avg_entr 0.11887072771787643, f1 0.8830000162124634
ep16_l0_test_time 0.7490003108978271
Test Epoch16 layer1 Acc 0.8848, AUC 0.9489059448242188, avg_entr 0.1002931147813797, f1 0.8848000168800354
ep16_l1_test_time 0.7698557376861572
Test Epoch16 layer2 Acc 0.8852, AUC 0.9494447708129883, avg_entr 0.0750465914607048, f1 0.8852000832557678
ep16_l2_test_time 0.7507789134979248
Test Epoch16 layer3 Acc 0.8838, AUC 0.9453840255737305, avg_entr 0.03660087287425995, f1 0.8838000297546387
ep16_l3_test_time 0.754812479019165
Test Epoch16 layer4 Acc 0.8844, AUC 0.9444102048873901, avg_entr 0.02522224560379982, f1 0.8844000101089478
ep16_l4_test_time 0.748699426651001
gc 0
Train Epoch17 Acc 0.972425 (38897/40000), AUC 0.9955167770385742
ep17_train_time 11.211053609848022
Test Epoch17 layer0 Acc 0.8826, AUC 0.947453498840332, avg_entr 0.12002430111169815, f1 0.8826000094413757
ep17_l0_test_time 0.7431628704071045
Test Epoch17 layer1 Acc 0.8832, AUC 0.9488186240196228, avg_entr 0.10102268308401108, f1 0.8831999897956848
ep17_l1_test_time 0.7470877170562744
Test Epoch17 layer2 Acc 0.8826, AUC 0.94954514503479, avg_entr 0.07539345324039459, f1 0.8826000094413757
ep17_l2_test_time 0.723595142364502
Test Epoch17 layer3 Acc 0.8824, AUC 0.9460427761077881, avg_entr 0.03655078262090683, f1 0.8823999762535095
ep17_l3_test_time 0.7396588325500488
Test Epoch17 layer4 Acc 0.883, AUC 0.9456138014793396, avg_entr 0.025442445650696754, f1 0.8830000162124634
ep17_l4_test_time 0.7571830749511719
gc 0
Train Epoch18 Acc 0.9721 (38884/40000), AUC 0.9956735372543335
ep18_train_time 11.051828384399414
Test Epoch18 layer0 Acc 0.8816, AUC 0.9471161365509033, avg_entr 0.11908463388681412, f1 0.881600022315979
ep18_l0_test_time 0.7444884777069092
Test Epoch18 layer1 Acc 0.8824, AUC 0.9485181570053101, avg_entr 0.1003183126449585, f1 0.8823999762535095
ep18_l1_test_time 0.7523057460784912
Test Epoch18 layer2 Acc 0.882, AUC 0.949207067489624, avg_entr 0.0745277926325798, f1 0.8820000290870667
ep18_l2_test_time 0.7573249340057373
Test Epoch18 layer3 Acc 0.8822, AUC 0.9453511238098145, avg_entr 0.036040518432855606, f1 0.8822000026702881
ep18_l3_test_time 0.7569754123687744
Test Epoch18 layer4 Acc 0.8822, AUC 0.9444196224212646, avg_entr 0.025105800479650497, f1 0.8822000026702881
ep18_l4_test_time 0.7437670230865479
gc 0
Train Epoch19 Acc 0.97305 (38922/40000), AUC 0.9957110285758972
ep19_train_time 11.253023386001587
Test Epoch19 layer0 Acc 0.8814, AUC 0.9468053579330444, avg_entr 0.11701274663209915, f1 0.8813999891281128
ep19_l0_test_time 0.7538881301879883
Test Epoch19 layer1 Acc 0.8836, AUC 0.9481490850448608, avg_entr 0.09829237312078476, f1 0.8835999965667725
ep19_l1_test_time 0.7563285827636719
Test Epoch19 layer2 Acc 0.8814, AUC 0.9487924575805664, avg_entr 0.0724853053689003, f1 0.8813999891281128
ep19_l2_test_time 0.7526857852935791
Test Epoch19 layer3 Acc 0.882, AUC 0.9442614912986755, avg_entr 0.03492113947868347, f1 0.8820000290870667
ep19_l3_test_time 0.7638635635375977
Test Epoch19 layer4 Acc 0.883, AUC 0.9440484046936035, avg_entr 0.024287372827529907, f1 0.8830000162124634
ep19_l4_test_time 0.7475738525390625
gc 0
Train Epoch20 Acc 0.97305 (38922/40000), AUC 0.995840311050415
ep20_train_time 11.138982057571411
Test Epoch20 layer0 Acc 0.8808, AUC 0.9465749859809875, avg_entr 0.11732727289199829, f1 0.8808000087738037
ep20_l0_test_time 0.7617542743682861
Test Epoch20 layer1 Acc 0.8818, AUC 0.9479314088821411, avg_entr 0.09866731613874435, f1 0.8818000555038452
ep20_l1_test_time 0.7353367805480957
Test Epoch20 layer2 Acc 0.881, AUC 0.948600172996521, avg_entr 0.07262430340051651, f1 0.8809999823570251
ep20_l2_test_time 0.7502529621124268
Test Epoch20 layer3 Acc 0.8812, AUC 0.9444331526756287, avg_entr 0.0347745344042778, f1 0.8812000155448914
ep20_l3_test_time 0.7496850490570068
Test Epoch20 layer4 Acc 0.8812, AUC 0.9438070058822632, avg_entr 0.024062616750597954, f1 0.8812000155448914
ep20_l4_test_time 0.7502403259277344
gc 0
Train Epoch21 Acc 0.97365 (38946/40000), AUC 0.9958860874176025
ep21_train_time 11.12856125831604
Test Epoch21 layer0 Acc 0.8806, AUC 0.9464330673217773, avg_entr 0.11608126014471054, f1 0.8805999755859375
ep21_l0_test_time 0.7197854518890381
Test Epoch21 layer1 Acc 0.8826, AUC 0.9477895498275757, avg_entr 0.09738768637180328, f1 0.8826000094413757
ep21_l1_test_time 0.7356078624725342
Test Epoch21 layer2 Acc 0.8812, AUC 0.948462963104248, avg_entr 0.07157209515571594, f1 0.8812000155448914
ep21_l2_test_time 0.7523016929626465
Test Epoch21 layer3 Acc 0.8802, AUC 0.9440515041351318, avg_entr 0.034136466681957245, f1 0.8802000284194946
ep21_l3_test_time 0.749746561050415
Test Epoch21 layer4 Acc 0.8804, AUC 0.9439061880111694, avg_entr 0.023996403440833092, f1 0.8804000020027161
ep21_l4_test_time 0.7515473365783691
gc 0
Train Epoch22 Acc 0.97375 (38950/40000), AUC 0.995957612991333
ep22_train_time 11.182666063308716
Test Epoch22 layer0 Acc 0.8812, AUC 0.9462803602218628, avg_entr 0.11522717028856277, f1 0.8812000155448914
ep22_l0_test_time 0.7470669746398926
Test Epoch22 layer1 Acc 0.8832, AUC 0.9476481676101685, avg_entr 0.09672686457633972, f1 0.8831999897956848
ep22_l1_test_time 0.7572603225708008
Test Epoch22 layer2 Acc 0.8808, AUC 0.9482911825180054, avg_entr 0.0708291232585907, f1 0.8808000087738037
ep22_l2_test_time 0.7533154487609863
Test Epoch22 layer3 Acc 0.8808, AUC 0.9438270330429077, avg_entr 0.03371385484933853, f1 0.8808000087738037
ep22_l3_test_time 0.7633452415466309
Test Epoch22 layer4 Acc 0.8812, AUC 0.9435300827026367, avg_entr 0.023732397705316544, f1 0.8812000155448914
ep22_l4_test_time 0.7690038681030273
gc 0
Train Epoch23 Acc 0.973775 (38951/40000), AUC 0.9959801435470581
ep23_train_time 11.17268991470337
Test Epoch23 layer0 Acc 0.8816, AUC 0.9460748434066772, avg_entr 0.11437453329563141, f1 0.881600022315979
ep23_l0_test_time 0.7392690181732178
Test Epoch23 layer1 Acc 0.8816, AUC 0.9474507570266724, avg_entr 0.09601858258247375, f1 0.881600022315979
ep23_l1_test_time 0.7518999576568604
Test Epoch23 layer2 Acc 0.88, AUC 0.9479843378067017, avg_entr 0.07002829760313034, f1 0.8799999952316284
ep23_l2_test_time 0.7619519233703613
Test Epoch23 layer3 Acc 0.8812, AUC 0.9436266422271729, avg_entr 0.03292425721883774, f1 0.8812000155448914
ep23_l3_test_time 0.7727127075195312
Test Epoch23 layer4 Acc 0.8816, AUC 0.944320797920227, avg_entr 0.022751562297344208, f1 0.881600022315979
ep23_l4_test_time 0.7491352558135986
gc 0
Train Epoch24 Acc 0.973675 (38947/40000), AUC 0.99599289894104
ep24_train_time 11.173596620559692
Test Epoch24 layer0 Acc 0.8806, AUC 0.9459694623947144, avg_entr 0.11385296285152435, f1 0.8805999755859375
ep24_l0_test_time 0.743497371673584
Test Epoch24 layer1 Acc 0.8822, AUC 0.9473678469657898, avg_entr 0.09552230685949326, f1 0.8822000026702881
ep24_l1_test_time 0.7488782405853271
Test Epoch24 layer2 Acc 0.8806, AUC 0.9479742050170898, avg_entr 0.06958486884832382, f1 0.8805999755859375
ep24_l2_test_time 0.7488439083099365
Test Epoch24 layer3 Acc 0.8804, AUC 0.9433416128158569, avg_entr 0.032932814210653305, f1 0.8804000020027161
ep24_l3_test_time 0.7489051818847656
Test Epoch24 layer4 Acc 0.881, AUC 0.9437551498413086, avg_entr 0.023145409300923347, f1 0.8809999823570251
ep24_l4_test_time 0.755033016204834
gc 0
Train Epoch25 Acc 0.97415 (38966/40000), AUC 0.996139645576477
ep25_train_time 11.105817794799805
Test Epoch25 layer0 Acc 0.8806, AUC 0.9458974003791809, avg_entr 0.11377110332250595, f1 0.8805999755859375
ep25_l0_test_time 0.781019926071167
Test Epoch25 layer1 Acc 0.882, AUC 0.9472992420196533, avg_entr 0.09538254886865616, f1 0.8820000290870667
ep25_l1_test_time 0.7525298595428467
Test Epoch25 layer2 Acc 0.8798, AUC 0.9478887319564819, avg_entr 0.06952404975891113, f1 0.879800021648407
ep25_l2_test_time 0.7405431270599365
Test Epoch25 layer3 Acc 0.8798, AUC 0.9431840181350708, avg_entr 0.03293582797050476, f1 0.879800021648407
ep25_l3_test_time 0.7547917366027832
Test Epoch25 layer4 Acc 0.8794, AUC 0.9431256651878357, avg_entr 0.023121779784560204, f1 0.8794000148773193
ep25_l4_test_time 0.7431201934814453
gc 0
Train Epoch26 Acc 0.9744 (38976/40000), AUC 0.9961779117584229
ep26_train_time 11.267575979232788
Test Epoch26 layer0 Acc 0.8796, AUC 0.9458664655685425, avg_entr 0.11378604918718338, f1 0.8795999884605408
ep26_l0_test_time 0.7425887584686279
Test Epoch26 layer1 Acc 0.8796, AUC 0.9472841620445251, avg_entr 0.09541668742895126, f1 0.8795999884605408
ep26_l1_test_time 0.7635836601257324
Test Epoch26 layer2 Acc 0.879, AUC 0.9479296207427979, avg_entr 0.069546177983284, f1 0.8790000081062317
ep26_l2_test_time 0.750478982925415
Test Epoch26 layer3 Acc 0.8804, AUC 0.9434559345245361, avg_entr 0.03307309001684189, f1 0.8804000020027161
ep26_l3_test_time 0.7646052837371826
Test Epoch26 layer4 Acc 0.8806, AUC 0.9434207081794739, avg_entr 0.023277753964066505, f1 0.8805999755859375
ep26_l4_test_time 0.7380290031433105
gc 0
Train Epoch27 Acc 0.97445 (38978/40000), AUC 0.9961212873458862
ep27_train_time 11.244218826293945
Test Epoch27 layer0 Acc 0.8786, AUC 0.9458025097846985, avg_entr 0.11352719366550446, f1 0.878600001335144
ep27_l0_test_time 0.7588460445404053
Test Epoch27 layer1 Acc 0.8806, AUC 0.9472259283065796, avg_entr 0.09514089673757553, f1 0.8805999755859375
ep27_l1_test_time 0.7491240501403809
Test Epoch27 layer2 Acc 0.8794, AUC 0.947878360748291, avg_entr 0.06928930431604385, f1 0.8794000148773193
ep27_l2_test_time 0.7562236785888672
Test Epoch27 layer3 Acc 0.8804, AUC 0.943416953086853, avg_entr 0.03290114924311638, f1 0.8804000020027161
ep27_l3_test_time 0.7509112358093262
Test Epoch27 layer4 Acc 0.8804, AUC 0.9437563419342041, avg_entr 0.023004254326224327, f1 0.8804000020027161
ep27_l4_test_time 0.7350771427154541
gc 0
Train Epoch28 Acc 0.974275 (38971/40000), AUC 0.9961955547332764
ep28_train_time 11.107221841812134
Test Epoch28 layer0 Acc 0.8794, AUC 0.9457241892814636, avg_entr 0.11268681287765503, f1 0.8794000148773193
ep28_l0_test_time 0.7674639225006104
Test Epoch28 layer1 Acc 0.8806, AUC 0.947129487991333, avg_entr 0.09426901489496231, f1 0.8805999755859375
ep28_l1_test_time 0.7541213035583496
Test Epoch28 layer2 Acc 0.879, AUC 0.9477449655532837, avg_entr 0.06845347583293915, f1 0.8790000081062317
ep28_l2_test_time 0.730283260345459
Test Epoch28 layer3 Acc 0.8798, AUC 0.9428656101226807, avg_entr 0.03240621089935303, f1 0.879800021648407
ep28_l3_test_time 0.7464089393615723
Test Epoch28 layer4 Acc 0.8792, AUC 0.9426044821739197, avg_entr 0.022884394973516464, f1 0.8791999816894531
ep28_l4_test_time 0.753058910369873
gc 0
Train Epoch29 Acc 0.97465 (38986/40000), AUC 0.9961493015289307
ep29_train_time 11.147425889968872
Test Epoch29 layer0 Acc 0.8806, AUC 0.9456855058670044, avg_entr 0.1119341179728508, f1 0.8805999755859375
ep29_l0_test_time 0.7510354518890381
Test Epoch29 layer1 Acc 0.8814, AUC 0.9470788240432739, avg_entr 0.09366454929113388, f1 0.8813999891281128
ep29_l1_test_time 0.7635312080383301
Test Epoch29 layer2 Acc 0.8808, AUC 0.9476814866065979, avg_entr 0.06785156577825546, f1 0.8808000087738037
ep29_l2_test_time 0.7566490173339844
Test Epoch29 layer3 Acc 0.8804, AUC 0.9427653551101685, avg_entr 0.031968824565410614, f1 0.8804000020027161
ep29_l3_test_time 0.7454092502593994
Test Epoch29 layer4 Acc 0.8806, AUC 0.9432799220085144, avg_entr 0.02254292368888855, f1 0.8805999755859375
ep29_l4_test_time 0.7393512725830078
Best AUC tensor(0.8998) 4 2
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 440.2480003833771
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8954, AUC 0.9557526111602783, avg_entr 0.1788913756608963, f1 0.8953999876976013
l0_test_time 0.7456097602844238
Test layer1 Acc 0.897, AUC 0.9562844038009644, avg_entr 0.15822838246822357, f1 0.8970000147819519
l1_test_time 0.7504675388336182
Test layer2 Acc 0.8972, AUC 0.9567537307739258, avg_entr 0.14475946128368378, f1 0.8971999883651733
l2_test_time 0.7437677383422852
Test layer3 Acc 0.897, AUC 0.957229733467102, avg_entr 0.12034934014081955, f1 0.8970000147819519
l3_test_time 0.7510271072387695
Test layer4 Acc 0.896, AUC 0.9572260975837708, avg_entr 0.0926155373454094, f1 0.8960000276565552
l4_test_time 0.7546749114990234
