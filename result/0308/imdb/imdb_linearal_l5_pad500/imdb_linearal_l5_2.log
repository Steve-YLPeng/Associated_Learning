total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 23.0063533782959
Start Training
gc 0
Train Epoch0 Acc 0.5244 (20976/40000), AUC 0.5313824415206909
ep0_train_time 12.588181734085083
Test Epoch0 layer0 Acc 0.8172, AUC 0.8899548649787903, avg_entr 0.5617077946662903, f1 0.8172000050544739
ep0_l0_test_time 0.7606401443481445
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.7936, AUC 0.8665416240692139, avg_entr 0.6821051836013794, f1 0.7936000227928162
ep0_l1_test_time 0.7677509784698486
Test Epoch0 layer2 Acc 0.7134, AUC 0.8000580072402954, avg_entr 0.6873672604560852, f1 0.7134000062942505
ep0_l2_test_time 0.7759912014007568
Test Epoch0 layer3 Acc 0.6718, AUC 0.8025116920471191, avg_entr 0.690028190612793, f1 0.6718000173568726
ep0_l3_test_time 0.7727804183959961
Test Epoch0 layer4 Acc 0.6776, AUC 0.7722049951553345, avg_entr 0.6895958185195923, f1 0.6776000261306763
ep0_l4_test_time 0.7809066772460938
gc 0
Train Epoch1 Acc 0.824775 (32991/40000), AUC 0.9034377336502075
ep1_train_time 11.38229250907898
Test Epoch1 layer0 Acc 0.8748, AUC 0.9463723301887512, avg_entr 0.2840366065502167, f1 0.8748000264167786
ep1_l0_test_time 0.7644760608673096
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8722, AUC 0.9464403390884399, avg_entr 0.3244483768939972, f1 0.872200071811676
ep1_l1_test_time 0.7752528190612793
Test Epoch1 layer2 Acc 0.8728, AUC 0.9467212557792664, avg_entr 0.23215226829051971, f1 0.8727999925613403
ep1_l2_test_time 0.7765994071960449
Test Epoch1 layer3 Acc 0.8732, AUC 0.9468201398849487, avg_entr 0.225373774766922, f1 0.873199999332428
ep1_l3_test_time 0.7775001525878906
Test Epoch1 layer4 Acc 0.8758, AUC 0.946858823299408, avg_entr 0.21828822791576385, f1 0.8758000135421753
ep1_l4_test_time 0.7777323722839355
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
gc 0
Train Epoch2 Acc 0.9057 (36228/40000), AUC 0.9652989506721497
ep2_train_time 11.436511754989624
Test Epoch2 layer0 Acc 0.8894, AUC 0.9553490877151489, avg_entr 0.22451989352703094, f1 0.8894000053405762
ep2_l0_test_time 0.7727975845336914
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8904, AUC 0.9555761218070984, avg_entr 0.20871300995349884, f1 0.8903999924659729
ep2_l1_test_time 0.7588269710540771
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.891, AUC 0.9558054208755493, avg_entr 0.18721741437911987, f1 0.890999972820282
ep2_l2_test_time 0.7709760665893555
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8924, AUC 0.9560140371322632, avg_entr 0.1748100221157074, f1 0.8923999667167664
ep2_l3_test_time 0.7703812122344971
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.892, AUC 0.9559727311134338, avg_entr 0.16048014163970947, f1 0.8920000195503235
ep2_l4_test_time 0.7861521244049072
gc 0
Train Epoch3 Acc 0.925075 (37003/40000), AUC 0.976142406463623
ep3_train_time 11.368245363235474
Test Epoch3 layer0 Acc 0.8946, AUC 0.9582555890083313, avg_entr 0.19346030056476593, f1 0.894599974155426
ep3_l0_test_time 0.7701919078826904
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8956, AUC 0.9584556818008423, avg_entr 0.1712663769721985, f1 0.8956000208854675
ep3_l1_test_time 0.7778806686401367
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8952, AUC 0.9587936401367188, avg_entr 0.16051682829856873, f1 0.8952000141143799
ep3_l2_test_time 0.7827446460723877
Test Epoch3 layer3 Acc 0.8954, AUC 0.9590416550636292, avg_entr 0.14241543412208557, f1 0.8953999876976013
ep3_l3_test_time 0.7772448062896729
Test Epoch3 layer4 Acc 0.8954, AUC 0.9591714143753052, avg_entr 0.11769136786460876, f1 0.8953999876976013
ep3_l4_test_time 0.7819850444793701
gc 0
Train Epoch4 Acc 0.93565 (37426/40000), AUC 0.9816915392875671
ep4_train_time 11.407092094421387
Test Epoch4 layer0 Acc 0.8924, AUC 0.9587917327880859, avg_entr 0.17450588941574097, f1 0.8923999667167664
ep4_l0_test_time 0.7679462432861328
Test Epoch4 layer1 Acc 0.8968, AUC 0.9590804576873779, avg_entr 0.15079505741596222, f1 0.8967999815940857
ep4_l1_test_time 0.7671315670013428
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8972, AUC 0.9594131708145142, avg_entr 0.1415013074874878, f1 0.8971999883651733
ep4_l2_test_time 0.7586331367492676
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer3 Acc 0.8992, AUC 0.9597345590591431, avg_entr 0.11524877697229385, f1 0.8992000222206116
ep4_l3_test_time 0.7639930248260498
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer4 Acc 0.896, AUC 0.9601175785064697, avg_entr 0.08523400872945786, f1 0.8960000276565552
ep4_l4_test_time 0.7646033763885498
gc 0
Train Epoch5 Acc 0.942 (37680/40000), AUC 0.9853807687759399
ep5_train_time 11.419159650802612
Test Epoch5 layer0 Acc 0.8962, AUC 0.9586488008499146, avg_entr 0.16024823486804962, f1 0.8962000012397766
ep5_l0_test_time 0.7822577953338623
Test Epoch5 layer1 Acc 0.8948, AUC 0.9588176012039185, avg_entr 0.13546882569789886, f1 0.8948000073432922
ep5_l1_test_time 0.7716214656829834
Test Epoch5 layer2 Acc 0.8974, AUC 0.9594070911407471, avg_entr 0.12618108093738556, f1 0.8974000215530396
ep5_l2_test_time 0.7805109024047852
Test Epoch5 layer3 Acc 0.8972, AUC 0.9600799083709717, avg_entr 0.09213879704475403, f1 0.8971999883651733
ep5_l3_test_time 0.7655899524688721
Test Epoch5 layer4 Acc 0.8958, AUC 0.9603878259658813, avg_entr 0.0593884214758873, f1 0.895799994468689
ep5_l4_test_time 0.777940034866333
gc 0
Train Epoch6 Acc 0.949725 (37989/40000), AUC 0.9877593517303467
ep6_train_time 11.457439661026001
Test Epoch6 layer0 Acc 0.8972, AUC 0.9570141434669495, avg_entr 0.15174880623817444, f1 0.8971999883651733
ep6_l0_test_time 0.7909071445465088
Test Epoch6 layer1 Acc 0.898, AUC 0.9576390981674194, avg_entr 0.12634064257144928, f1 0.8980000019073486
ep6_l1_test_time 0.7684340476989746
Test Epoch6 layer2 Acc 0.8976, AUC 0.9587420225143433, avg_entr 0.11398336291313171, f1 0.897599995136261
ep6_l2_test_time 0.7572329044342041
Test Epoch6 layer3 Acc 0.897, AUC 0.9594156742095947, avg_entr 0.07396896928548813, f1 0.8970000147819519
ep6_l3_test_time 0.7722179889678955
Test Epoch6 layer4 Acc 0.8974, AUC 0.9584223031997681, avg_entr 0.047513313591480255, f1 0.8974000215530396
ep6_l4_test_time 0.7791624069213867
gc 0
Train Epoch7 Acc 0.955225 (38209/40000), AUC 0.9895084500312805
ep7_train_time 11.417384147644043
Test Epoch7 layer0 Acc 0.895, AUC 0.9559357762336731, avg_entr 0.14240510761737823, f1 0.8949999809265137
ep7_l0_test_time 0.7656569480895996
Test Epoch7 layer1 Acc 0.8954, AUC 0.956511378288269, avg_entr 0.11728648841381073, f1 0.8953999876976013
ep7_l1_test_time 0.7703704833984375
Test Epoch7 layer2 Acc 0.8952, AUC 0.9576265811920166, avg_entr 0.10382523387670517, f1 0.8952000141143799
ep7_l2_test_time 0.7674181461334229
Test Epoch7 layer3 Acc 0.8958, AUC 0.9581711292266846, avg_entr 0.06049545854330063, f1 0.895799994468689
ep7_l3_test_time 0.7707185745239258
Test Epoch7 layer4 Acc 0.8954, AUC 0.9556487202644348, avg_entr 0.038050051778554916, f1 0.8953999876976013
ep7_l4_test_time 0.7750170230865479
gc 0
Train Epoch8 Acc 0.959775 (38391/40000), AUC 0.9913409948348999
ep8_train_time 11.337632894515991
Test Epoch8 layer0 Acc 0.889, AUC 0.9541728496551514, avg_entr 0.1385711133480072, f1 0.8889999985694885
ep8_l0_test_time 0.7724792957305908
Test Epoch8 layer1 Acc 0.89, AUC 0.9550076723098755, avg_entr 0.11371360719203949, f1 0.8899999856948853
ep8_l1_test_time 0.7731947898864746
Test Epoch8 layer2 Acc 0.8904, AUC 0.9563863277435303, avg_entr 0.09959559142589569, f1 0.8903999924659729
ep8_l2_test_time 0.7660415172576904
Test Epoch8 layer3 Acc 0.8898, AUC 0.9559944272041321, avg_entr 0.053927093744277954, f1 0.8898000121116638
ep8_l3_test_time 0.7868244647979736
Test Epoch8 layer4 Acc 0.8894, AUC 0.9521163702011108, avg_entr 0.0357145257294178, f1 0.8894000053405762
ep8_l4_test_time 0.7798459529876709
gc 0
Train Epoch9 Acc 0.964 (38560/40000), AUC 0.9924124479293823
ep9_train_time 11.444190979003906
Test Epoch9 layer0 Acc 0.8866, AUC 0.9530863761901855, avg_entr 0.13167068362236023, f1 0.8866000771522522
ep9_l0_test_time 0.7641618251800537
Test Epoch9 layer1 Acc 0.889, AUC 0.9539368152618408, avg_entr 0.10733114182949066, f1 0.8889999985694885
ep9_l1_test_time 0.7802529335021973
Test Epoch9 layer2 Acc 0.8898, AUC 0.9549649953842163, avg_entr 0.09150690585374832, f1 0.8898000121116638
ep9_l2_test_time 0.769993782043457
Test Epoch9 layer3 Acc 0.8864, AUC 0.9540069699287415, avg_entr 0.04479304328560829, f1 0.8863999843597412
ep9_l3_test_time 0.7726728916168213
Test Epoch9 layer4 Acc 0.8898, AUC 0.953476071357727, avg_entr 0.029868222773075104, f1 0.8898000121116638
ep9_l4_test_time 0.7756307125091553
gc 0
Train Epoch10 Acc 0.965475 (38619/40000), AUC 0.9934313297271729
ep10_train_time 11.365836381912231
Test Epoch10 layer0 Acc 0.8888, AUC 0.9518955945968628, avg_entr 0.12882152199745178, f1 0.8888000249862671
ep10_l0_test_time 0.760871171951294
Test Epoch10 layer1 Acc 0.888, AUC 0.9529080390930176, avg_entr 0.10442443937063217, f1 0.8880000114440918
ep10_l1_test_time 0.7628343105316162
Test Epoch10 layer2 Acc 0.8908, AUC 0.9540180563926697, avg_entr 0.08785205334424973, f1 0.8907999992370605
ep10_l2_test_time 0.7588555812835693
Test Epoch10 layer3 Acc 0.8892, AUC 0.9525377750396729, avg_entr 0.040510568767786026, f1 0.88919997215271
ep10_l3_test_time 0.7791175842285156
Test Epoch10 layer4 Acc 0.8902, AUC 0.9515596032142639, avg_entr 0.026968322694301605, f1 0.8902000188827515
ep10_l4_test_time 0.771934986114502
gc 0
Train Epoch11 Acc 0.967 (38680/40000), AUC 0.9937270283699036
ep11_train_time 11.490679740905762
Test Epoch11 layer0 Acc 0.8862, AUC 0.9506564140319824, avg_entr 0.13034385442733765, f1 0.8862000107765198
ep11_l0_test_time 0.7715661525726318
Test Epoch11 layer1 Acc 0.8864, AUC 0.9518136978149414, avg_entr 0.10650113224983215, f1 0.8863999843597412
ep11_l1_test_time 0.7804265022277832
Test Epoch11 layer2 Acc 0.8856, AUC 0.9530688524246216, avg_entr 0.08858872950077057, f1 0.8855999708175659
ep11_l2_test_time 0.7718768119812012
Test Epoch11 layer3 Acc 0.885, AUC 0.9513570070266724, avg_entr 0.04141093045473099, f1 0.8849999904632568
ep11_l3_test_time 0.7866711616516113
Test Epoch11 layer4 Acc 0.8846, AUC 0.9516401290893555, avg_entr 0.027241991832852364, f1 0.8845999836921692
ep11_l4_test_time 0.7769966125488281
gc 0
Train Epoch12 Acc 0.9686 (38744/40000), AUC 0.994343638420105
ep12_train_time 11.372732162475586
Test Epoch12 layer0 Acc 0.8854, AUC 0.9497150182723999, avg_entr 0.12797074019908905, f1 0.8853999972343445
ep12_l0_test_time 0.7675611972808838
Test Epoch12 layer1 Acc 0.8846, AUC 0.9509116411209106, avg_entr 0.10413997620344162, f1 0.8845999836921692
ep12_l1_test_time 0.77445387840271
Test Epoch12 layer2 Acc 0.886, AUC 0.9520490765571594, avg_entr 0.08562218397855759, f1 0.8859999775886536
ep12_l2_test_time 0.7833936214447021
Test Epoch12 layer3 Acc 0.886, AUC 0.9491047859191895, avg_entr 0.039227504283189774, f1 0.8859999775886536
ep12_l3_test_time 0.7695374488830566
Test Epoch12 layer4 Acc 0.8862, AUC 0.9496973752975464, avg_entr 0.02704097330570221, f1 0.8862000107765198
ep12_l4_test_time 0.7772252559661865
gc 0
Train Epoch13 Acc 0.9703 (38812/40000), AUC 0.9948288202285767
ep13_train_time 11.40558910369873
Test Epoch13 layer0 Acc 0.8874, AUC 0.9492514133453369, avg_entr 0.12284401804208755, f1 0.8873999714851379
ep13_l0_test_time 0.7750675678253174
Test Epoch13 layer1 Acc 0.8866, AUC 0.9504541158676147, avg_entr 0.09921364486217499, f1 0.8866000771522522
ep13_l1_test_time 0.7705202102661133
Test Epoch13 layer2 Acc 0.8864, AUC 0.9515671730041504, avg_entr 0.07978156954050064, f1 0.8863999843597412
ep13_l2_test_time 0.7727527618408203
Test Epoch13 layer3 Acc 0.886, AUC 0.9487020969390869, avg_entr 0.03468532860279083, f1 0.8859999775886536
ep13_l3_test_time 0.7699053287506104
Test Epoch13 layer4 Acc 0.8858, AUC 0.9491875767707825, avg_entr 0.02394287660717964, f1 0.8858000040054321
ep13_l4_test_time 0.7740671634674072
gc 0
Train Epoch14 Acc 0.971075 (38843/40000), AUC 0.9950724840164185
ep14_train_time 11.466838836669922
Test Epoch14 layer0 Acc 0.8852, AUC 0.9484715461730957, avg_entr 0.12248700857162476, f1 0.8852000832557678
ep14_l0_test_time 0.7774224281311035
Test Epoch14 layer1 Acc 0.885, AUC 0.9497696161270142, avg_entr 0.09932822734117508, f1 0.8849999904632568
ep14_l1_test_time 0.7615833282470703
Test Epoch14 layer2 Acc 0.8866, AUC 0.9508464932441711, avg_entr 0.0801740512251854, f1 0.8866000771522522
ep14_l2_test_time 0.7876541614532471
Test Epoch14 layer3 Acc 0.887, AUC 0.9473837018013, avg_entr 0.035838838666677475, f1 0.8870000243186951
ep14_l3_test_time 0.7844600677490234
Test Epoch14 layer4 Acc 0.8868, AUC 0.9474403858184814, avg_entr 0.025239184498786926, f1 0.8867999911308289
ep14_l4_test_time 0.781843900680542
gc 0
Train Epoch15 Acc 0.9713 (38852/40000), AUC 0.9954140186309814
ep15_train_time 11.435893535614014
Test Epoch15 layer0 Acc 0.8864, AUC 0.9480854272842407, avg_entr 0.11970815062522888, f1 0.8863999843597412
ep15_l0_test_time 0.7533373832702637
Test Epoch15 layer1 Acc 0.8858, AUC 0.9493818283081055, avg_entr 0.09639614075422287, f1 0.8858000040054321
ep15_l1_test_time 0.7697978019714355
Test Epoch15 layer2 Acc 0.8858, AUC 0.9504672884941101, avg_entr 0.0763893723487854, f1 0.8858000040054321
ep15_l2_test_time 0.768444299697876
Test Epoch15 layer3 Acc 0.8856, AUC 0.947617769241333, avg_entr 0.032930564135313034, f1 0.8855999708175659
ep15_l3_test_time 0.7670772075653076
Test Epoch15 layer4 Acc 0.8854, AUC 0.9486706256866455, avg_entr 0.022922080010175705, f1 0.8853999972343445
ep15_l4_test_time 0.7643272876739502
gc 0
Train Epoch16 Acc 0.97205 (38882/40000), AUC 0.9955761432647705
ep16_train_time 11.432416439056396
Test Epoch16 layer0 Acc 0.8834, AUC 0.9475210309028625, avg_entr 0.12095385789871216, f1 0.8834000825881958
ep16_l0_test_time 0.7618932723999023
Test Epoch16 layer1 Acc 0.8838, AUC 0.9488943815231323, avg_entr 0.09815619885921478, f1 0.8838000297546387
ep16_l1_test_time 0.7727875709533691
Test Epoch16 layer2 Acc 0.8838, AUC 0.949982225894928, avg_entr 0.07766562700271606, f1 0.8838000297546387
ep16_l2_test_time 0.7683601379394531
Test Epoch16 layer3 Acc 0.8836, AUC 0.9467113018035889, avg_entr 0.03510349616408348, f1 0.8835999965667725
ep16_l3_test_time 0.7778158187866211
Test Epoch16 layer4 Acc 0.8834, AUC 0.9474717974662781, avg_entr 0.02495267055928707, f1 0.8834000825881958
ep16_l4_test_time 0.7659711837768555
gc 0
Train Epoch17 Acc 0.97285 (38914/40000), AUC 0.9956507682800293
ep17_train_time 11.388786554336548
Test Epoch17 layer0 Acc 0.8834, AUC 0.9471360445022583, avg_entr 0.11903603374958038, f1 0.8834000825881958
ep17_l0_test_time 0.775475025177002
Test Epoch17 layer1 Acc 0.8846, AUC 0.9485152363777161, avg_entr 0.09562409669160843, f1 0.8845999836921692
ep17_l1_test_time 0.7709758281707764
Test Epoch17 layer2 Acc 0.884, AUC 0.9495159387588501, avg_entr 0.07497856765985489, f1 0.8840000033378601
ep17_l2_test_time 0.7788417339324951
Test Epoch17 layer3 Acc 0.8842, AUC 0.9464302659034729, avg_entr 0.0327945351600647, f1 0.8842000365257263
ep17_l3_test_time 0.7738828659057617
Test Epoch17 layer4 Acc 0.8838, AUC 0.9480816125869751, avg_entr 0.023298244923353195, f1 0.8838000297546387
ep17_l4_test_time 0.7795243263244629
gc 0
Train Epoch18 Acc 0.972925 (38917/40000), AUC 0.9958935976028442
ep18_train_time 11.371291637420654
Test Epoch18 layer0 Acc 0.8838, AUC 0.9468556642532349, avg_entr 0.11719240993261337, f1 0.8838000297546387
ep18_l0_test_time 0.7643969058990479
Test Epoch18 layer1 Acc 0.8844, AUC 0.9482569694519043, avg_entr 0.09421331435441971, f1 0.8844000101089478
ep18_l1_test_time 0.770923376083374
Test Epoch18 layer2 Acc 0.8834, AUC 0.9492897987365723, avg_entr 0.07300245016813278, f1 0.8834000825881958
ep18_l2_test_time 0.7740404605865479
Test Epoch18 layer3 Acc 0.8832, AUC 0.9457545280456543, avg_entr 0.031570639461278915, f1 0.8831999897956848
ep18_l3_test_time 0.7700645923614502
Test Epoch18 layer4 Acc 0.8838, AUC 0.9465777277946472, avg_entr 0.022429263219237328, f1 0.8838000297546387
ep18_l4_test_time 0.7701873779296875
gc 0
Train Epoch19 Acc 0.973775 (38951/40000), AUC 0.9959139823913574
ep19_train_time 11.373270511627197
Test Epoch19 layer0 Acc 0.8814, AUC 0.9465757012367249, avg_entr 0.11839749664068222, f1 0.8813999891281128
ep19_l0_test_time 0.77396559715271
Test Epoch19 layer1 Acc 0.8822, AUC 0.9480220079421997, avg_entr 0.09559289366006851, f1 0.8822000026702881
ep19_l1_test_time 0.7653179168701172
Test Epoch19 layer2 Acc 0.8818, AUC 0.9490464925765991, avg_entr 0.07459073513746262, f1 0.8818000555038452
ep19_l2_test_time 0.7680213451385498
Test Epoch19 layer3 Acc 0.8824, AUC 0.9453842043876648, avg_entr 0.03315277397632599, f1 0.8823999762535095
ep19_l3_test_time 0.7690212726593018
Test Epoch19 layer4 Acc 0.8826, AUC 0.9458878040313721, avg_entr 0.02384035289287567, f1 0.8826000094413757
ep19_l4_test_time 0.7726831436157227
gc 0
Train Epoch20 Acc 0.9731 (38924/40000), AUC 0.9958748817443848
ep20_train_time 11.372841358184814
Test Epoch20 layer0 Acc 0.8826, AUC 0.9462244510650635, avg_entr 0.11630450189113617, f1 0.8826000094413757
ep20_l0_test_time 0.7702751159667969
Test Epoch20 layer1 Acc 0.8822, AUC 0.9476759433746338, avg_entr 0.09364992380142212, f1 0.8822000026702881
ep20_l1_test_time 0.7642052173614502
Test Epoch20 layer2 Acc 0.8808, AUC 0.9486570954322815, avg_entr 0.0723191425204277, f1 0.8808000087738037
ep20_l2_test_time 0.7524254322052002
Test Epoch20 layer3 Acc 0.8822, AUC 0.9445855617523193, avg_entr 0.032052166759967804, f1 0.8822000026702881
ep20_l3_test_time 0.7695391178131104
Test Epoch20 layer4 Acc 0.8818, AUC 0.9466888904571533, avg_entr 0.023176223039627075, f1 0.8818000555038452
ep20_l4_test_time 0.7624721527099609
gc 0
Train Epoch21 Acc 0.97385 (38954/40000), AUC 0.9962003827095032
ep21_train_time 11.404705286026001
Test Epoch21 layer0 Acc 0.8836, AUC 0.9460671544075012, avg_entr 0.11445089429616928, f1 0.8835999965667725
ep21_l0_test_time 0.7656698226928711
Test Epoch21 layer1 Acc 0.8834, AUC 0.9475269317626953, avg_entr 0.0917423740029335, f1 0.8834000825881958
ep21_l1_test_time 0.774956226348877
Test Epoch21 layer2 Acc 0.883, AUC 0.9485134482383728, avg_entr 0.07077944278717041, f1 0.8830000162124634
ep21_l2_test_time 0.7737367153167725
Test Epoch21 layer3 Acc 0.8828, AUC 0.9449933767318726, avg_entr 0.02982703596353531, f1 0.8827999830245972
ep21_l3_test_time 0.775871753692627
Test Epoch21 layer4 Acc 0.8826, AUC 0.9468905925750732, avg_entr 0.021168088540434837, f1 0.8826000094413757
ep21_l4_test_time 0.7757134437561035
gc 0
Train Epoch22 Acc 0.97425 (38970/40000), AUC 0.9962155222892761
ep22_train_time 11.394580602645874
Test Epoch22 layer0 Acc 0.8828, AUC 0.9459328055381775, avg_entr 0.11438248306512833, f1 0.8827999830245972
ep22_l0_test_time 0.7631528377532959
Test Epoch22 layer1 Acc 0.8832, AUC 0.9473962783813477, avg_entr 0.09169060736894608, f1 0.8831999897956848
ep22_l1_test_time 0.7687187194824219
Test Epoch22 layer2 Acc 0.8828, AUC 0.9483556747436523, avg_entr 0.07031968981027603, f1 0.8827999830245972
ep22_l2_test_time 0.7739133834838867
Test Epoch22 layer3 Acc 0.8828, AUC 0.9446979761123657, avg_entr 0.030096640810370445, f1 0.8827999830245972
ep22_l3_test_time 0.778616189956665
Test Epoch22 layer4 Acc 0.8824, AUC 0.9464656114578247, avg_entr 0.02136440947651863, f1 0.8823999762535095
ep22_l4_test_time 0.774951696395874
gc 0
Train Epoch23 Acc 0.974225 (38969/40000), AUC 0.9962860941886902
ep23_train_time 11.433210611343384
Test Epoch23 layer0 Acc 0.8824, AUC 0.9458274841308594, avg_entr 0.11383331567049026, f1 0.8823999762535095
ep23_l0_test_time 0.764930248260498
Test Epoch23 layer1 Acc 0.8826, AUC 0.9472780227661133, avg_entr 0.09135531634092331, f1 0.8826000094413757
ep23_l1_test_time 0.7769877910614014
Test Epoch23 layer2 Acc 0.8826, AUC 0.9482545852661133, avg_entr 0.07005757093429565, f1 0.8826000094413757
ep23_l2_test_time 0.7717435359954834
Test Epoch23 layer3 Acc 0.8824, AUC 0.9449621438980103, avg_entr 0.030052922666072845, f1 0.8823999762535095
ep23_l3_test_time 0.7751452922821045
Test Epoch23 layer4 Acc 0.8828, AUC 0.9467266798019409, avg_entr 0.021390577778220177, f1 0.8827999830245972
ep23_l4_test_time 0.7759826183319092
gc 0
Train Epoch24 Acc 0.9746 (38984/40000), AUC 0.9962536692619324
ep24_train_time 11.44186019897461
Test Epoch24 layer0 Acc 0.8804, AUC 0.9456936120986938, avg_entr 0.11438194662332535, f1 0.8804000020027161
ep24_l0_test_time 0.7676773071289062
Test Epoch24 layer1 Acc 0.8818, AUC 0.9471967816352844, avg_entr 0.09179747849702835, f1 0.8818000555038452
ep24_l1_test_time 0.7733006477355957
Test Epoch24 layer2 Acc 0.8794, AUC 0.9481508731842041, avg_entr 0.07058964669704437, f1 0.8794000148773193
ep24_l2_test_time 0.7692098617553711
Test Epoch24 layer3 Acc 0.88, AUC 0.9443212747573853, avg_entr 0.03125739470124245, f1 0.8799999952316284
ep24_l3_test_time 0.7686376571655273
Test Epoch24 layer4 Acc 0.8802, AUC 0.9460819959640503, avg_entr 0.022828558459877968, f1 0.8802000284194946
ep24_l4_test_time 0.7715730667114258
gc 0
Train Epoch25 Acc 0.9748 (38992/40000), AUC 0.9963246583938599
ep25_train_time 11.3583664894104
Test Epoch25 layer0 Acc 0.8814, AUC 0.9456278681755066, avg_entr 0.1132969856262207, f1 0.8813999891281128
ep25_l0_test_time 0.7622065544128418
Test Epoch25 layer1 Acc 0.8814, AUC 0.9471307992935181, avg_entr 0.09079249203205109, f1 0.8813999891281128
ep25_l1_test_time 0.7662553787231445
Test Epoch25 layer2 Acc 0.881, AUC 0.948081910610199, avg_entr 0.06970884650945663, f1 0.8809999823570251
ep25_l2_test_time 0.7681512832641602
Test Epoch25 layer3 Acc 0.8816, AUC 0.9445945024490356, avg_entr 0.03023378551006317, f1 0.881600022315979
ep25_l3_test_time 0.776508092880249
Test Epoch25 layer4 Acc 0.8818, AUC 0.9465054273605347, avg_entr 0.02183956280350685, f1 0.8818000555038452
ep25_l4_test_time 0.7768616676330566
gc 0
Train Epoch26 Acc 0.97455 (38982/40000), AUC 0.9963648319244385
ep26_train_time 11.402844667434692
Test Epoch26 layer0 Acc 0.881, AUC 0.945554256439209, avg_entr 0.11333083361387253, f1 0.8809999823570251
ep26_l0_test_time 0.7663135528564453
Test Epoch26 layer1 Acc 0.8814, AUC 0.9470815658569336, avg_entr 0.090804822742939, f1 0.8813999891281128
ep26_l1_test_time 0.7933495044708252
Test Epoch26 layer2 Acc 0.8804, AUC 0.9480372071266174, avg_entr 0.06951849907636642, f1 0.8804000020027161
ep26_l2_test_time 0.7743782997131348
Test Epoch26 layer3 Acc 0.8806, AUC 0.9445222616195679, avg_entr 0.030475305393338203, f1 0.8805999755859375
ep26_l3_test_time 0.7573204040527344
Test Epoch26 layer4 Acc 0.8804, AUC 0.9461666345596313, avg_entr 0.022263657301664352, f1 0.8804000020027161
ep26_l4_test_time 0.7728071212768555
gc 0
Train Epoch27 Acc 0.97485 (38994/40000), AUC 0.9964202642440796
ep27_train_time 11.437703371047974
Test Epoch27 layer0 Acc 0.8816, AUC 0.9454764127731323, avg_entr 0.1119106337428093, f1 0.881600022315979
ep27_l0_test_time 0.759894847869873
Test Epoch27 layer1 Acc 0.8822, AUC 0.946976900100708, avg_entr 0.08947023004293442, f1 0.8822000026702881
ep27_l1_test_time 0.7775485515594482
Test Epoch27 layer2 Acc 0.8826, AUC 0.9479279518127441, avg_entr 0.06820274144411087, f1 0.8826000094413757
ep27_l2_test_time 0.7758781909942627
Test Epoch27 layer3 Acc 0.8818, AUC 0.9443650245666504, avg_entr 0.028924698010087013, f1 0.8818000555038452
ep27_l3_test_time 0.7673525810241699
Test Epoch27 layer4 Acc 0.8822, AUC 0.9463290572166443, avg_entr 0.020732883363962173, f1 0.8822000026702881
ep27_l4_test_time 0.7805366516113281
gc 0
Train Epoch28 Acc 0.97485 (38994/40000), AUC 0.996371865272522
ep28_train_time 11.417487382888794
Test Epoch28 layer0 Acc 0.881, AUC 0.9454240202903748, avg_entr 0.11255401372909546, f1 0.8809999823570251
ep28_l0_test_time 0.7701447010040283
Test Epoch28 layer1 Acc 0.8802, AUC 0.9469614028930664, avg_entr 0.09012460708618164, f1 0.8802000284194946
ep28_l1_test_time 0.7725691795349121
Test Epoch28 layer2 Acc 0.8794, AUC 0.9478996992111206, avg_entr 0.06896161288022995, f1 0.8794000148773193
ep28_l2_test_time 0.7762479782104492
Test Epoch28 layer3 Acc 0.8806, AUC 0.9444588422775269, avg_entr 0.03042786195874214, f1 0.8805999755859375
ep28_l3_test_time 0.7588024139404297
Test Epoch28 layer4 Acc 0.8806, AUC 0.9458831548690796, avg_entr 0.022269591689109802, f1 0.8805999755859375
ep28_l4_test_time 0.778090238571167
gc 0
Train Epoch29 Acc 0.97485 (38994/40000), AUC 0.9963968396186829
ep29_train_time 11.412596464157104
Test Epoch29 layer0 Acc 0.8812, AUC 0.9453843832015991, avg_entr 0.11170987784862518, f1 0.8812000155448914
ep29_l0_test_time 0.7719171047210693
Test Epoch29 layer1 Acc 0.8812, AUC 0.9469105005264282, avg_entr 0.08929989486932755, f1 0.8812000155448914
ep29_l1_test_time 0.7754385471343994
Test Epoch29 layer2 Acc 0.8804, AUC 0.9478456377983093, avg_entr 0.06814361363649368, f1 0.8804000020027161
ep29_l2_test_time 0.7693748474121094
Test Epoch29 layer3 Acc 0.881, AUC 0.9440625309944153, avg_entr 0.02933650277554989, f1 0.8809999823570251
ep29_l3_test_time 0.7638499736785889
Test Epoch29 layer4 Acc 0.8816, AUC 0.9457155466079712, avg_entr 0.02128995582461357, f1 0.881600022315979
ep29_l4_test_time 0.7778692245483398
Best AUC tensor(0.8992) 4 3
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 461.43912649154663
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8886, AUC 0.9558759927749634, avg_entr 0.172991082072258, f1 0.8885999917984009
l0_test_time 0.7900283336639404
Test layer1 Acc 0.892, AUC 0.9563479423522949, avg_entr 0.15019358694553375, f1 0.8920000195503235
l1_test_time 0.7702741622924805
Test layer2 Acc 0.8918, AUC 0.9567078351974487, avg_entr 0.1413041204214096, f1 0.8917999863624573
l2_test_time 0.7842957973480225
Test layer3 Acc 0.8916, AUC 0.9569403529167175, avg_entr 0.11560223251581192, f1 0.8916000127792358
l3_test_time 0.7768633365631104
Test layer4 Acc 0.8906, AUC 0.9573574662208557, avg_entr 0.08538775891065598, f1 0.8906000256538391
l4_test_time 0.7790930271148682
