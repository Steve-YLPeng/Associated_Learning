total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.985182285308838
Start Training
gc 0
Train Epoch0 Acc 0.502575 (20103/40000), AUC 0.5064647793769836
ep0_train_time 12.418757677078247
Test Epoch0 layer0 Acc 0.8176, AUC 0.8882222175598145, avg_entr 0.5607394576072693, f1 0.8176000118255615
ep0_l0_test_time 0.7760457992553711
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.8146, AUC 0.8865384459495544, avg_entr 0.6873834133148193, f1 0.8145999908447266
ep0_l1_test_time 0.7701032161712646
Test Epoch0 layer2 Acc 0.7458, AUC 0.8707919716835022, avg_entr 0.6883907914161682, f1 0.7458000183105469
ep0_l2_test_time 0.7401916980743408
Test Epoch0 layer3 Acc 0.7174, AUC 0.8530939221382141, avg_entr 0.692068338394165, f1 0.717400074005127
ep0_l3_test_time 0.7704064846038818
Test Epoch0 layer4 Acc 0.6946, AUC 0.8487989902496338, avg_entr 0.6921152472496033, f1 0.694599986076355
ep0_l4_test_time 0.7450714111328125
gc 0
Train Epoch1 Acc 0.82105 (32842/40000), AUC 0.9039629697799683
ep1_train_time 11.22104001045227
Test Epoch1 layer0 Acc 0.879, AUC 0.9447305202484131, avg_entr 0.2900027930736542, f1 0.8790000081062317
ep1_l0_test_time 0.7763307094573975
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8794, AUC 0.945651113986969, avg_entr 0.3157586455345154, f1 0.8794000148773193
ep1_l1_test_time 0.7796411514282227
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8786, AUC 0.9452954530715942, avg_entr 0.23651058971881866, f1 0.878600001335144
ep1_l2_test_time 0.7754735946655273
Test Epoch1 layer3 Acc 0.8802, AUC 0.9455217719078064, avg_entr 0.23746982216835022, f1 0.8802000284194946
ep1_l3_test_time 0.7639949321746826
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer4 Acc 0.8774, AUC 0.9454238414764404, avg_entr 0.2212318331003189, f1 0.8773999810218811
ep1_l4_test_time 0.77644944190979
gc 0
Train Epoch2 Acc 0.906375 (36255/40000), AUC 0.9650884866714478
ep2_train_time 11.244669914245605
Test Epoch2 layer0 Acc 0.8926, AUC 0.9546091556549072, avg_entr 0.22843225300312042, f1 0.8925999999046326
ep2_l0_test_time 0.7689788341522217
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8916, AUC 0.9552764892578125, avg_entr 0.21302993595600128, f1 0.8916000127792358
ep2_l1_test_time 0.7585628032684326
Test Epoch2 layer2 Acc 0.8898, AUC 0.9555392265319824, avg_entr 0.19242051243782043, f1 0.8898000121116638
ep2_l2_test_time 0.7767934799194336
Test Epoch2 layer3 Acc 0.8886, AUC 0.9557280540466309, avg_entr 0.1856716275215149, f1 0.8885999917984009
ep2_l3_test_time 0.7719757556915283
Test Epoch2 layer4 Acc 0.8894, AUC 0.9556970000267029, avg_entr 0.1675327867269516, f1 0.8894000053405762
ep2_l4_test_time 0.7828848361968994
gc 0
Train Epoch3 Acc 0.9232 (36928/40000), AUC 0.976036787033081
ep3_train_time 11.010339260101318
Test Epoch3 layer0 Acc 0.8956, AUC 0.9578442573547363, avg_entr 0.19680972397327423, f1 0.8956000208854675
ep3_l0_test_time 0.7742223739624023
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8978, AUC 0.9584132432937622, avg_entr 0.17875288426876068, f1 0.8978000283241272
ep3_l1_test_time 0.7922699451446533
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8972, AUC 0.958534836769104, avg_entr 0.16235604882240295, f1 0.8971999883651733
ep3_l2_test_time 0.7771909236907959
Test Epoch3 layer3 Acc 0.8974, AUC 0.9588757753372192, avg_entr 0.14833204448223114, f1 0.8974000215530396
ep3_l3_test_time 0.7865796089172363
Test Epoch3 layer4 Acc 0.8978, AUC 0.9589338302612305, avg_entr 0.1224822849035263, f1 0.8978000283241272
ep3_l4_test_time 0.7640044689178467
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.9345 (37380/40000), AUC 0.9817172288894653
ep4_train_time 11.202754020690918
Test Epoch4 layer0 Acc 0.8976, AUC 0.958519697189331, avg_entr 0.17989639937877655, f1 0.897599995136261
ep4_l0_test_time 0.7682251930236816
Test Epoch4 layer1 Acc 0.8986, AUC 0.9590474367141724, avg_entr 0.16082707047462463, f1 0.8985999822616577
ep4_l1_test_time 0.7669181823730469
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8928, AUC 0.9594668745994568, avg_entr 0.14563532173633575, f1 0.892799973487854
ep4_l2_test_time 0.7655677795410156
Test Epoch4 layer3 Acc 0.8918, AUC 0.9599851369857788, avg_entr 0.12620534002780914, f1 0.8917999863624573
ep4_l3_test_time 0.7646210193634033
Test Epoch4 layer4 Acc 0.8926, AUC 0.9602329730987549, avg_entr 0.0952342078089714, f1 0.8925999999046326
ep4_l4_test_time 0.7707648277282715
gc 0
Train Epoch5 Acc 0.943725 (37749/40000), AUC 0.9856513142585754
ep5_train_time 11.222079992294312
Test Epoch5 layer0 Acc 0.8964, AUC 0.9582152366638184, avg_entr 0.16343213617801666, f1 0.896399974822998
ep5_l0_test_time 0.765207052230835
Test Epoch5 layer1 Acc 0.8966, AUC 0.9587545990943909, avg_entr 0.14507241547107697, f1 0.8966000080108643
ep5_l1_test_time 0.7545673847198486
Test Epoch5 layer2 Acc 0.897, AUC 0.9592143297195435, avg_entr 0.13066719472408295, f1 0.8970000147819519
ep5_l2_test_time 0.7309410572052002
Test Epoch5 layer3 Acc 0.8962, AUC 0.9599320888519287, avg_entr 0.09771648049354553, f1 0.8962000012397766
ep5_l3_test_time 0.7218399047851562
Test Epoch5 layer4 Acc 0.897, AUC 0.9603421688079834, avg_entr 0.06318913400173187, f1 0.8970000147819519
ep5_l4_test_time 0.7491629123687744
gc 0
Train Epoch6 Acc 0.948575 (37943/40000), AUC 0.9876115322113037
ep6_train_time 11.232954740524292
Test Epoch6 layer0 Acc 0.8968, AUC 0.9570763111114502, avg_entr 0.15382204949855804, f1 0.8967999815940857
ep6_l0_test_time 0.7715332508087158
Test Epoch6 layer1 Acc 0.8978, AUC 0.9577369093894958, avg_entr 0.13560505211353302, f1 0.8978000283241272
ep6_l1_test_time 0.761725902557373
Test Epoch6 layer2 Acc 0.8978, AUC 0.9584016799926758, avg_entr 0.12044186145067215, f1 0.8978000283241272
ep6_l2_test_time 0.7653777599334717
Test Epoch6 layer3 Acc 0.8968, AUC 0.959182620048523, avg_entr 0.08254995197057724, f1 0.8967999815940857
ep6_l3_test_time 0.7809436321258545
Test Epoch6 layer4 Acc 0.896, AUC 0.9581985473632812, avg_entr 0.050402238965034485, f1 0.8960000276565552
ep6_l4_test_time 0.7754671573638916
gc 0
Train Epoch7 Acc 0.9539 (38156/40000), AUC 0.9894263744354248
ep7_train_time 11.277111291885376
Test Epoch7 layer0 Acc 0.8942, AUC 0.955062985420227, avg_entr 0.14561857283115387, f1 0.8942000269889832
ep7_l0_test_time 0.7601845264434814
Test Epoch7 layer1 Acc 0.8934, AUC 0.9559608101844788, avg_entr 0.12766724824905396, f1 0.8934000134468079
ep7_l1_test_time 0.7616128921508789
Test Epoch7 layer2 Acc 0.894, AUC 0.9569979906082153, avg_entr 0.11151159554719925, f1 0.8939999938011169
ep7_l2_test_time 0.7629876136779785
Test Epoch7 layer3 Acc 0.8936, AUC 0.9574978351593018, avg_entr 0.0682072639465332, f1 0.8935999870300293
ep7_l3_test_time 0.7633340358734131
Test Epoch7 layer4 Acc 0.8942, AUC 0.9548619389533997, avg_entr 0.04025457799434662, f1 0.8942000269889832
ep7_l4_test_time 0.7664651870727539
gc 0
Train Epoch8 Acc 0.957575 (38303/40000), AUC 0.9907423257827759
ep8_train_time 11.054069757461548
Test Epoch8 layer0 Acc 0.8886, AUC 0.9535013437271118, avg_entr 0.14238528907299042, f1 0.8885999917984009
ep8_l0_test_time 0.8119602203369141
Test Epoch8 layer1 Acc 0.8902, AUC 0.9544671773910522, avg_entr 0.12423171103000641, f1 0.8902000188827515
ep8_l1_test_time 0.7581984996795654
Test Epoch8 layer2 Acc 0.8884, AUC 0.9555127620697021, avg_entr 0.10680219531059265, f1 0.8884000182151794
ep8_l2_test_time 0.7626237869262695
Test Epoch8 layer3 Acc 0.8886, AUC 0.9557222127914429, avg_entr 0.060582127422094345, f1 0.8885999917984009
ep8_l3_test_time 0.7850406169891357
Test Epoch8 layer4 Acc 0.889, AUC 0.9526411294937134, avg_entr 0.03724656254053116, f1 0.8889999985694885
ep8_l4_test_time 0.7765622138977051
gc 0
Train Epoch9 Acc 0.963675 (38547/40000), AUC 0.9926499128341675
ep9_train_time 11.245159149169922
Test Epoch9 layer0 Acc 0.892, AUC 0.9527076482772827, avg_entr 0.13611510396003723, f1 0.8920000195503235
ep9_l0_test_time 0.7820882797241211
Test Epoch9 layer1 Acc 0.8916, AUC 0.953577995300293, avg_entr 0.11826535314321518, f1 0.8916000127792358
ep9_l1_test_time 0.762535572052002
Test Epoch9 layer2 Acc 0.8924, AUC 0.9545420408248901, avg_entr 0.09978179633617401, f1 0.8923999667167664
ep9_l2_test_time 0.7691242694854736
Test Epoch9 layer3 Acc 0.8924, AUC 0.9542614221572876, avg_entr 0.05306027829647064, f1 0.8923999667167664
ep9_l3_test_time 0.7721688747406006
Test Epoch9 layer4 Acc 0.8924, AUC 0.9522590637207031, avg_entr 0.03275433927774429, f1 0.8923999667167664
ep9_l4_test_time 0.7731056213378906
gc 0
Train Epoch10 Acc 0.96475 (38590/40000), AUC 0.993365466594696
ep10_train_time 11.181421041488647
Test Epoch10 layer0 Acc 0.89, AUC 0.9514317512512207, avg_entr 0.13382671773433685, f1 0.8899999856948853
ep10_l0_test_time 0.7917234897613525
Test Epoch10 layer1 Acc 0.8898, AUC 0.9524859189987183, avg_entr 0.11650961637496948, f1 0.8898000121116638
ep10_l1_test_time 0.7665293216705322
Test Epoch10 layer2 Acc 0.8878, AUC 0.9534507989883423, avg_entr 0.09777890145778656, f1 0.8877999782562256
ep10_l2_test_time 0.7382967472076416
Test Epoch10 layer3 Acc 0.8882, AUC 0.9524122476577759, avg_entr 0.049879200756549835, f1 0.888200044631958
ep10_l3_test_time 0.7288815975189209
Test Epoch10 layer4 Acc 0.8886, AUC 0.9506429433822632, avg_entr 0.030648067593574524, f1 0.8885999917984009
ep10_l4_test_time 0.7300131320953369
gc 0
Train Epoch11 Acc 0.966725 (38669/40000), AUC 0.9937280416488647
ep11_train_time 11.211658477783203
Test Epoch11 layer0 Acc 0.8864, AUC 0.9503790140151978, avg_entr 0.12912996113300323, f1 0.8863999843597412
ep11_l0_test_time 0.7636458873748779
Test Epoch11 layer1 Acc 0.8888, AUC 0.951424241065979, avg_entr 0.11234237998723984, f1 0.8888000249862671
ep11_l1_test_time 0.7737421989440918
Test Epoch11 layer2 Acc 0.8882, AUC 0.9523310661315918, avg_entr 0.09196723997592926, f1 0.888200044631958
ep11_l2_test_time 0.7677090167999268
Test Epoch11 layer3 Acc 0.8892, AUC 0.949969470500946, avg_entr 0.04551141709089279, f1 0.88919997215271
ep11_l3_test_time 0.765988826751709
Test Epoch11 layer4 Acc 0.8888, AUC 0.9459432363510132, avg_entr 0.028492208570241928, f1 0.8888000249862671
ep11_l4_test_time 0.773766279220581
gc 0
Train Epoch12 Acc 0.96835 (38734/40000), AUC 0.9941622018814087
ep12_train_time 11.307496547698975
Test Epoch12 layer0 Acc 0.8846, AUC 0.9491011500358582, avg_entr 0.12670721113681793, f1 0.8845999836921692
ep12_l0_test_time 0.7689828872680664
Test Epoch12 layer1 Acc 0.886, AUC 0.9501955509185791, avg_entr 0.10995286703109741, f1 0.8859999775886536
ep12_l1_test_time 0.779400110244751
Test Epoch12 layer2 Acc 0.8874, AUC 0.9510154724121094, avg_entr 0.08893010020256042, f1 0.8873999714851379
ep12_l2_test_time 0.7654826641082764
Test Epoch12 layer3 Acc 0.8866, AUC 0.9482088088989258, avg_entr 0.04265189915895462, f1 0.8866000771522522
ep12_l3_test_time 0.7688887119293213
Test Epoch12 layer4 Acc 0.887, AUC 0.9476965665817261, avg_entr 0.026591001078486443, f1 0.8870000243186951
ep12_l4_test_time 0.7662408351898193
gc 0
Train Epoch13 Acc 0.970225 (38809/40000), AUC 0.9947011470794678
ep13_train_time 11.035942316055298
Test Epoch13 layer0 Acc 0.8864, AUC 0.9488043785095215, avg_entr 0.12550874054431915, f1 0.8863999843597412
ep13_l0_test_time 0.7654104232788086
Test Epoch13 layer1 Acc 0.8872, AUC 0.9499541521072388, avg_entr 0.10866722464561462, f1 0.8871999979019165
ep13_l1_test_time 0.7616007328033447
Test Epoch13 layer2 Acc 0.8862, AUC 0.9508267641067505, avg_entr 0.08750501275062561, f1 0.8862000107765198
ep13_l2_test_time 0.7886230945587158
Test Epoch13 layer3 Acc 0.887, AUC 0.947708249092102, avg_entr 0.04115404188632965, f1 0.8870000243186951
ep13_l3_test_time 0.771658182144165
Test Epoch13 layer4 Acc 0.8872, AUC 0.9465733766555786, avg_entr 0.025149576365947723, f1 0.8871999979019165
ep13_l4_test_time 0.757777214050293
gc 0
Train Epoch14 Acc 0.97025 (38810/40000), AUC 0.9948922395706177
ep14_train_time 11.254270553588867
Test Epoch14 layer0 Acc 0.8856, AUC 0.9481813311576843, avg_entr 0.12417585402727127, f1 0.8855999708175659
ep14_l0_test_time 0.7698569297790527
Test Epoch14 layer1 Acc 0.8864, AUC 0.949324369430542, avg_entr 0.10745029151439667, f1 0.8863999843597412
ep14_l1_test_time 0.75350022315979
Test Epoch14 layer2 Acc 0.886, AUC 0.9501960277557373, avg_entr 0.08563865721225739, f1 0.8859999775886536
ep14_l2_test_time 0.7845358848571777
Test Epoch14 layer3 Acc 0.8854, AUC 0.9465100765228271, avg_entr 0.04037436842918396, f1 0.8853999972343445
ep14_l3_test_time 0.7699391841888428
Test Epoch14 layer4 Acc 0.8852, AUC 0.9455811977386475, avg_entr 0.02483721636235714, f1 0.8852000832557678
ep14_l4_test_time 0.7766180038452148
gc 0
Train Epoch15 Acc 0.970925 (38837/40000), AUC 0.9951435327529907
ep15_train_time 11.21077847480774
Test Epoch15 layer0 Acc 0.8832, AUC 0.9475976228713989, avg_entr 0.12379665672779083, f1 0.8831999897956848
ep15_l0_test_time 0.7726964950561523
Test Epoch15 layer1 Acc 0.8842, AUC 0.948779821395874, avg_entr 0.10743983089923859, f1 0.8842000365257263
ep15_l1_test_time 0.7626745700836182
Test Epoch15 layer2 Acc 0.8838, AUC 0.9496237635612488, avg_entr 0.08607858419418335, f1 0.8838000297546387
ep15_l2_test_time 0.7727937698364258
Test Epoch15 layer3 Acc 0.884, AUC 0.946448028087616, avg_entr 0.039643269032239914, f1 0.8840000033378601
ep15_l3_test_time 0.7482895851135254
Test Epoch15 layer4 Acc 0.884, AUC 0.9476046562194824, avg_entr 0.025091776624321938, f1 0.8840000033378601
ep15_l4_test_time 0.7424707412719727
gc 0
Train Epoch16 Acc 0.9716 (38864/40000), AUC 0.9951430559158325
ep16_train_time 11.113525629043579
Test Epoch16 layer0 Acc 0.8816, AUC 0.9468585252761841, avg_entr 0.12250182032585144, f1 0.881600022315979
ep16_l0_test_time 0.7596385478973389
Test Epoch16 layer1 Acc 0.8812, AUC 0.947998046875, avg_entr 0.10603642463684082, f1 0.8812000155448914
ep16_l1_test_time 0.7705984115600586
Test Epoch16 layer2 Acc 0.8812, AUC 0.9487504959106445, avg_entr 0.08381819725036621, f1 0.8812000155448914
ep16_l2_test_time 0.7730169296264648
Test Epoch16 layer3 Acc 0.8814, AUC 0.9446512460708618, avg_entr 0.03905968368053436, f1 0.8813999891281128
ep16_l3_test_time 0.7719707489013672
Test Epoch16 layer4 Acc 0.881, AUC 0.9468203783035278, avg_entr 0.02447429671883583, f1 0.8809999823570251
ep16_l4_test_time 0.7653031349182129
gc 0
Train Epoch17 Acc 0.972725 (38909/40000), AUC 0.9954808950424194
ep17_train_time 11.226155042648315
Test Epoch17 layer0 Acc 0.8836, AUC 0.9465978145599365, avg_entr 0.12030834704637527, f1 0.8835999965667725
ep17_l0_test_time 0.7626314163208008
Test Epoch17 layer1 Acc 0.8842, AUC 0.947787880897522, avg_entr 0.10419441014528275, f1 0.8842000365257263
ep17_l1_test_time 0.7863080501556396
Test Epoch17 layer2 Acc 0.8846, AUC 0.9485852718353271, avg_entr 0.08169753104448318, f1 0.8845999836921692
ep17_l2_test_time 0.7624862194061279
Test Epoch17 layer3 Acc 0.884, AUC 0.9446160197257996, avg_entr 0.037358880043029785, f1 0.8840000033378601
ep17_l3_test_time 0.7792930603027344
Test Epoch17 layer4 Acc 0.8836, AUC 0.9463788270950317, avg_entr 0.02320210263133049, f1 0.8835999965667725
ep17_l4_test_time 0.7719917297363281
gc 0
Train Epoch18 Acc 0.972725 (38909/40000), AUC 0.9956841468811035
ep18_train_time 11.026937007904053
Test Epoch18 layer0 Acc 0.8832, AUC 0.9463045597076416, avg_entr 0.11940336972475052, f1 0.8831999897956848
ep18_l0_test_time 0.769716739654541
Test Epoch18 layer1 Acc 0.8838, AUC 0.9475120306015015, avg_entr 0.10343847423791885, f1 0.8838000297546387
ep18_l1_test_time 0.7776284217834473
Test Epoch18 layer2 Acc 0.8824, AUC 0.9482768774032593, avg_entr 0.08114343881607056, f1 0.8823999762535095
ep18_l2_test_time 0.7897138595581055
Test Epoch18 layer3 Acc 0.8822, AUC 0.9443531036376953, avg_entr 0.036888036876916885, f1 0.8822000026702881
ep18_l3_test_time 0.7744271755218506
Test Epoch18 layer4 Acc 0.8824, AUC 0.9457040429115295, avg_entr 0.022805817425251007, f1 0.8823999762535095
ep18_l4_test_time 0.7750329971313477
gc 0
Train Epoch19 Acc 0.972675 (38907/40000), AUC 0.9956862926483154
ep19_train_time 11.232303380966187
Test Epoch19 layer0 Acc 0.8788, AUC 0.9460431337356567, avg_entr 0.120292529463768, f1 0.8787999749183655
ep19_l0_test_time 0.7751142978668213
Test Epoch19 layer1 Acc 0.8802, AUC 0.9472981691360474, avg_entr 0.10392657667398453, f1 0.8802000284194946
ep19_l1_test_time 0.7663476467132568
Test Epoch19 layer2 Acc 0.8804, AUC 0.9480255842208862, avg_entr 0.08165761828422546, f1 0.8804000020027161
ep19_l2_test_time 0.7729458808898926
Test Epoch19 layer3 Acc 0.88, AUC 0.9443104267120361, avg_entr 0.037162501364946365, f1 0.8799999952316284
ep19_l3_test_time 0.7637939453125
Test Epoch19 layer4 Acc 0.8802, AUC 0.9455701112747192, avg_entr 0.02352062426507473, f1 0.8802000284194946
ep19_l4_test_time 0.7621893882751465
gc 0
Train Epoch20 Acc 0.97365 (38946/40000), AUC 0.9958472847938538
ep20_train_time 11.238476037979126
Test Epoch20 layer0 Acc 0.8802, AUC 0.9457570314407349, avg_entr 0.11901907622814178, f1 0.8802000284194946
ep20_l0_test_time 0.7617237567901611
Test Epoch20 layer1 Acc 0.881, AUC 0.9470402002334595, avg_entr 0.10259474068880081, f1 0.8809999823570251
ep20_l1_test_time 0.7602376937866211
Test Epoch20 layer2 Acc 0.8812, AUC 0.9477598667144775, avg_entr 0.07981269061565399, f1 0.8812000155448914
ep20_l2_test_time 0.7697830200195312
Test Epoch20 layer3 Acc 0.881, AUC 0.9435672760009766, avg_entr 0.036454908549785614, f1 0.8809999823570251
ep20_l3_test_time 0.769733190536499
Test Epoch20 layer4 Acc 0.8808, AUC 0.94476318359375, avg_entr 0.02306763082742691, f1 0.8808000087738037
ep20_l4_test_time 0.7310938835144043
gc 0
Train Epoch21 Acc 0.973525 (38941/40000), AUC 0.9958652257919312
ep21_train_time 11.057762622833252
Test Epoch21 layer0 Acc 0.8822, AUC 0.9456590414047241, avg_entr 0.11746659874916077, f1 0.8822000026702881
ep21_l0_test_time 0.7618184089660645
Test Epoch21 layer1 Acc 0.8804, AUC 0.9469023942947388, avg_entr 0.10142716020345688, f1 0.8804000020027161
ep21_l1_test_time 0.7728583812713623
Test Epoch21 layer2 Acc 0.881, AUC 0.9476367235183716, avg_entr 0.07860594242811203, f1 0.8809999823570251
ep21_l2_test_time 0.7613949775695801
Test Epoch21 layer3 Acc 0.8804, AUC 0.943581223487854, avg_entr 0.035391971468925476, f1 0.8804000020027161
ep21_l3_test_time 0.7666959762573242
Test Epoch21 layer4 Acc 0.8804, AUC 0.9450478553771973, avg_entr 0.022205229848623276, f1 0.8804000020027161
ep21_l4_test_time 0.7775919437408447
gc 0
Train Epoch22 Acc 0.973575 (38943/40000), AUC 0.9959028959274292
ep22_train_time 11.271731853485107
Test Epoch22 layer0 Acc 0.8822, AUC 0.9455033540725708, avg_entr 0.1167120635509491, f1 0.8822000026702881
ep22_l0_test_time 0.7655811309814453
Test Epoch22 layer1 Acc 0.8816, AUC 0.9467471837997437, avg_entr 0.10078520327806473, f1 0.881600022315979
ep22_l1_test_time 0.7760529518127441
Test Epoch22 layer2 Acc 0.8798, AUC 0.9474717974662781, avg_entr 0.07788969576358795, f1 0.879800021648407
ep22_l2_test_time 0.7645153999328613
Test Epoch22 layer3 Acc 0.8804, AUC 0.9434148073196411, avg_entr 0.03490864485502243, f1 0.8804000020027161
ep22_l3_test_time 0.7629261016845703
Test Epoch22 layer4 Acc 0.8802, AUC 0.944713830947876, avg_entr 0.02187509834766388, f1 0.8802000284194946
ep22_l4_test_time 0.7942624092102051
gc 0
Train Epoch23 Acc 0.974 (38960/40000), AUC 0.9960439205169678
ep23_train_time 11.053741455078125
Test Epoch23 layer0 Acc 0.8814, AUC 0.94535231590271, avg_entr 0.11627508699893951, f1 0.8813999891281128
ep23_l0_test_time 0.7625277042388916
Test Epoch23 layer1 Acc 0.8806, AUC 0.9465811252593994, avg_entr 0.10032353550195694, f1 0.8805999755859375
ep23_l1_test_time 0.7602307796478271
Test Epoch23 layer2 Acc 0.8796, AUC 0.9472783803939819, avg_entr 0.07752769440412521, f1 0.8795999884605408
ep23_l2_test_time 0.7631227970123291
Test Epoch23 layer3 Acc 0.8806, AUC 0.942853569984436, avg_entr 0.034978125244379044, f1 0.8805999755859375
ep23_l3_test_time 0.7728352546691895
Test Epoch23 layer4 Acc 0.88, AUC 0.944815993309021, avg_entr 0.021888315677642822, f1 0.8799999952316284
ep23_l4_test_time 0.7640607357025146
gc 0
Train Epoch24 Acc 0.973875 (38955/40000), AUC 0.9959697723388672
ep24_train_time 11.290507555007935
Test Epoch24 layer0 Acc 0.8806, AUC 0.9452328085899353, avg_entr 0.11576692014932632, f1 0.8805999755859375
ep24_l0_test_time 0.7612123489379883
Test Epoch24 layer1 Acc 0.8794, AUC 0.9464747309684753, avg_entr 0.09985343366861343, f1 0.8794000148773193
ep24_l1_test_time 0.7678811550140381
Test Epoch24 layer2 Acc 0.8798, AUC 0.9471904039382935, avg_entr 0.0769324004650116, f1 0.879800021648407
ep24_l2_test_time 0.7686018943786621
Test Epoch24 layer3 Acc 0.8792, AUC 0.9434025883674622, avg_entr 0.034387875348329544, f1 0.8791999816894531
ep24_l3_test_time 0.7693309783935547
Test Epoch24 layer4 Acc 0.8802, AUC 0.9458543658256531, avg_entr 0.021597586572170258, f1 0.8802000284194946
ep24_l4_test_time 0.7712321281433105
gc 0
Train Epoch25 Acc 0.97425 (38970/40000), AUC 0.996040403842926
ep25_train_time 11.239872694015503
Test Epoch25 layer0 Acc 0.8808, AUC 0.9451558589935303, avg_entr 0.11516169458627701, f1 0.8808000087738037
ep25_l0_test_time 0.7667214870452881
Test Epoch25 layer1 Acc 0.8804, AUC 0.9463964700698853, avg_entr 0.09934524446725845, f1 0.8804000020027161
ep25_l1_test_time 0.76153564453125
Test Epoch25 layer2 Acc 0.88, AUC 0.9470933675765991, avg_entr 0.07647477835416794, f1 0.8799999952316284
ep25_l2_test_time 0.7743549346923828
Test Epoch25 layer3 Acc 0.8794, AUC 0.9430762529373169, avg_entr 0.034100405871868134, f1 0.8794000148773193
ep25_l3_test_time 0.7660787105560303
Test Epoch25 layer4 Acc 0.8802, AUC 0.9452204704284668, avg_entr 0.021362315863370895, f1 0.8802000284194946
ep25_l4_test_time 0.7697198390960693
gc 0
Train Epoch26 Acc 0.9741 (38964/40000), AUC 0.9961095452308655
ep26_train_time 10.982417821884155
Test Epoch26 layer0 Acc 0.88, AUC 0.9450992345809937, avg_entr 0.11515897512435913, f1 0.8799999952316284
ep26_l0_test_time 0.7669312953948975
Test Epoch26 layer1 Acc 0.8792, AUC 0.9463672041893005, avg_entr 0.09929901361465454, f1 0.8791999816894531
ep26_l1_test_time 0.770195484161377
Test Epoch26 layer2 Acc 0.88, AUC 0.9470618963241577, avg_entr 0.07654262334108353, f1 0.8799999952316284
ep26_l2_test_time 0.768500566482544
Test Epoch26 layer3 Acc 0.8792, AUC 0.9432477951049805, avg_entr 0.033999595791101456, f1 0.8791999816894531
ep26_l3_test_time 0.7903010845184326
Test Epoch26 layer4 Acc 0.8796, AUC 0.9451780319213867, avg_entr 0.02151242457330227, f1 0.8795999884605408
ep26_l4_test_time 0.769737958908081
gc 0
Train Epoch27 Acc 0.97445 (38978/40000), AUC 0.9961549043655396
ep27_train_time 11.223175525665283
Test Epoch27 layer0 Acc 0.8784, AUC 0.9450249075889587, avg_entr 0.11487632989883423, f1 0.8784000277519226
ep27_l0_test_time 0.7701187133789062
Test Epoch27 layer1 Acc 0.8792, AUC 0.9462911486625671, avg_entr 0.09893408417701721, f1 0.8791999816894531
ep27_l1_test_time 0.7690675258636475
Test Epoch27 layer2 Acc 0.8804, AUC 0.9469785690307617, avg_entr 0.0761496052145958, f1 0.8804000020027161
ep27_l2_test_time 0.7593584060668945
Test Epoch27 layer3 Acc 0.8794, AUC 0.9431377649307251, avg_entr 0.03387098386883736, f1 0.8794000148773193
ep27_l3_test_time 0.7555110454559326
Test Epoch27 layer4 Acc 0.88, AUC 0.9451369643211365, avg_entr 0.021462472155690193, f1 0.8799999952316284
ep27_l4_test_time 0.7758796215057373
gc 0
Train Epoch28 Acc 0.974275 (38971/40000), AUC 0.9961596727371216
ep28_train_time 11.052386999130249
Test Epoch28 layer0 Acc 0.8804, AUC 0.9449505805969238, avg_entr 0.11363113671541214, f1 0.8804000020027161
ep28_l0_test_time 0.7719752788543701
Test Epoch28 layer1 Acc 0.8806, AUC 0.946181058883667, avg_entr 0.09783607721328735, f1 0.8805999755859375
ep28_l1_test_time 0.7706305980682373
Test Epoch28 layer2 Acc 0.8804, AUC 0.9468555450439453, avg_entr 0.07495537400245667, f1 0.8804000020027161
ep28_l2_test_time 0.7640388011932373
Test Epoch28 layer3 Acc 0.879, AUC 0.9424976110458374, avg_entr 0.0333227775990963, f1 0.8790000081062317
ep28_l3_test_time 0.7634055614471436
Test Epoch28 layer4 Acc 0.8796, AUC 0.9439456462860107, avg_entr 0.020904289558529854, f1 0.8795999884605408
ep28_l4_test_time 0.7828950881958008
gc 0
Train Epoch29 Acc 0.97455 (38982/40000), AUC 0.9961920380592346
ep29_train_time 11.214999914169312
Test Epoch29 layer0 Acc 0.878, AUC 0.9449483156204224, avg_entr 0.11413326114416122, f1 0.878000020980835
ep29_l0_test_time 0.7802562713623047
Test Epoch29 layer1 Acc 0.879, AUC 0.9462150931358337, avg_entr 0.09827331453561783, f1 0.8790000081062317
ep29_l1_test_time 0.765052080154419
Test Epoch29 layer2 Acc 0.8794, AUC 0.9468902349472046, avg_entr 0.07547786086797714, f1 0.8794000148773193
ep29_l2_test_time 0.7747979164123535
Test Epoch29 layer3 Acc 0.8794, AUC 0.9429246783256531, avg_entr 0.033685024827718735, f1 0.8794000148773193
ep29_l3_test_time 0.7740786075592041
Test Epoch29 layer4 Acc 0.8796, AUC 0.945235013961792, avg_entr 0.02135508507490158, f1 0.8795999884605408
ep29_l4_test_time 0.771155595779419
Best AUC tensor(0.8986) 4 1
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 453.6786880493164
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.895, AUC 0.9556273221969604, avg_entr 0.181456059217453, f1 0.8949999809265137
l0_test_time 0.7727830410003662
Test layer1 Acc 0.8958, AUC 0.9560068249702454, avg_entr 0.16338993608951569, f1 0.895799994468689
l1_test_time 0.7665765285491943
Test layer2 Acc 0.89, AUC 0.9562979936599731, avg_entr 0.14854225516319275, f1 0.8899999856948853
l2_test_time 0.7698326110839844
Test layer3 Acc 0.8896, AUC 0.9568578004837036, avg_entr 0.12962372601032257, f1 0.8895999193191528
l3_test_time 0.7973568439483643
Test layer4 Acc 0.89, AUC 0.9570960998535156, avg_entr 0.09919601678848267, f1 0.8899999856948853
l4_test_time 0.7685933113098145
