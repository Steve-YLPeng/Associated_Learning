total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 23.5255765914917
Start Training
gc 0
Train Epoch0 Acc 0.515225 (20609/40000), AUC 0.5226210951805115
ep0_train_time 14.926469087600708
Test Epoch0 layer0 Acc 0.818, AUC 0.8926026821136475, avg_entr 0.5520250201225281, f1 0.8180000185966492
ep0_l0_test_time 0.8583154678344727
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6956, AUC 0.8866461515426636, avg_entr 0.6846045255661011, f1 0.6955999732017517
ep0_l1_test_time 0.8730223178863525
Test Epoch0 layer2 Acc 0.6766, AUC 0.8884134292602539, avg_entr 0.687225341796875, f1 0.6765999794006348
ep0_l2_test_time 0.8498687744140625
Test Epoch0 layer3 Acc 0.7108, AUC 0.8576562404632568, avg_entr 0.6882676482200623, f1 0.7107999920845032
ep0_l3_test_time 0.8551054000854492
Test Epoch0 layer4 Acc 0.6392, AUC 0.8597530126571655, avg_entr 0.6904577016830444, f1 0.63919997215271
ep0_l4_test_time 0.8492350578308105
gc 0
Train Epoch1 Acc 0.819875 (32795/40000), AUC 0.8940815925598145
ep1_train_time 12.444451332092285
Test Epoch1 layer0 Acc 0.882, AUC 0.9465817213058472, avg_entr 0.28780102729797363, f1 0.8820000290870667
ep1_l0_test_time 0.8368847370147705
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8802, AUC 0.9467310905456543, avg_entr 0.3323587477207184, f1 0.8802000284194946
ep1_l1_test_time 0.8325374126434326
Test Epoch1 layer2 Acc 0.881, AUC 0.9470385313034058, avg_entr 0.24409572780132294, f1 0.8809999823570251
ep1_l2_test_time 0.8410532474517822
Test Epoch1 layer3 Acc 0.8804, AUC 0.946898341178894, avg_entr 0.23538564145565033, f1 0.8804000020027161
ep1_l3_test_time 0.8473691940307617
Test Epoch1 layer4 Acc 0.8812, AUC 0.9471516609191895, avg_entr 0.23326042294502258, f1 0.8812000155448914
ep1_l4_test_time 0.8123142719268799
gc 0
Train Epoch2 Acc 0.90475 (36190/40000), AUC 0.9647040367126465
ep2_train_time 12.318435907363892
Test Epoch2 layer0 Acc 0.8876, AUC 0.95577073097229, avg_entr 0.2236013114452362, f1 0.8876000046730042
ep2_l0_test_time 0.9715275764465332
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.888, AUC 0.9561222791671753, avg_entr 0.20702211558818817, f1 0.8880000114440918
ep2_l1_test_time 0.9699630737304688
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8882, AUC 0.9561362266540527, avg_entr 0.1931076943874359, f1 0.888200044631958
ep2_l2_test_time 1.0545306205749512
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8888, AUC 0.9560844898223877, avg_entr 0.18061037361621857, f1 0.8888000249862671
ep2_l3_test_time 1.0246522426605225
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer4 Acc 0.8876, AUC 0.9564458131790161, avg_entr 0.1696554273366928, f1 0.8876000046730042
ep2_l4_test_time 0.9793837070465088
gc 0
Train Epoch3 Acc 0.9222 (36888/40000), AUC 0.9754309058189392
ep3_train_time 13.889743328094482
Test Epoch3 layer0 Acc 0.898, AUC 0.9589004516601562, avg_entr 0.1995743215084076, f1 0.8980000019073486
ep3_l0_test_time 0.8697478771209717
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.897, AUC 0.9591909646987915, avg_entr 0.1742018610239029, f1 0.8970000147819519
ep3_l1_test_time 0.8582079410552979
Test Epoch3 layer2 Acc 0.899, AUC 0.9595296382904053, avg_entr 0.1728307455778122, f1 0.8989999890327454
ep3_l2_test_time 0.8718788623809814
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.8978, AUC 0.9595829248428345, avg_entr 0.15409274399280548, f1 0.8978000283241272
ep3_l3_test_time 0.8832335472106934
Test Epoch3 layer4 Acc 0.8988, AUC 0.959985613822937, avg_entr 0.13101892173290253, f1 0.8988000154495239
ep3_l4_test_time 0.8746378421783447
gc 0
Train Epoch4 Acc 0.933025 (37321/40000), AUC 0.9814535975456238
ep4_train_time 13.171033143997192
Test Epoch4 layer0 Acc 0.9012, AUC 0.9594401121139526, avg_entr 0.17936117947101593, f1 0.901199996471405
ep4_l0_test_time 0.8398878574371338
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.8996, AUC 0.9597251415252686, avg_entr 0.1516055464744568, f1 0.8996000289916992
ep4_l1_test_time 0.8388383388519287
Test Epoch4 layer2 Acc 0.8988, AUC 0.9602904319763184, avg_entr 0.15122291445732117, f1 0.8988000154495239
ep4_l2_test_time 0.8594977855682373
Test Epoch4 layer3 Acc 0.8992, AUC 0.9605084657669067, avg_entr 0.125503271818161, f1 0.8992000222206116
ep4_l3_test_time 0.6766998767852783
Test Epoch4 layer4 Acc 0.9, AUC 0.9611606597900391, avg_entr 0.09172333776950836, f1 0.8999999761581421
ep4_l4_test_time 0.6637744903564453
gc 0
Train Epoch5 Acc 0.942775 (37711/40000), AUC 0.9854398965835571
ep5_train_time 8.0312020778656
Test Epoch5 layer0 Acc 0.8788, AUC 0.9586887359619141, avg_entr 0.16313263773918152, f1 0.8787999749183655
ep5_l0_test_time 0.6323056221008301
Test Epoch5 layer1 Acc 0.8864, AUC 0.959235429763794, avg_entr 0.13534480333328247, f1 0.8863999843597412
ep5_l1_test_time 0.6292660236358643
Test Epoch5 layer2 Acc 0.8872, AUC 0.9594744443893433, avg_entr 0.13360483944416046, f1 0.8871999979019165
ep5_l2_test_time 0.624199628829956
Test Epoch5 layer3 Acc 0.8866, AUC 0.9600127339363098, avg_entr 0.10394170880317688, f1 0.8866000771522522
ep5_l3_test_time 0.6241555213928223
Test Epoch5 layer4 Acc 0.8848, AUC 0.9604744911193848, avg_entr 0.06904201954603195, f1 0.8848000168800354
ep5_l4_test_time 0.6285378932952881
gc 0
Train Epoch6 Acc 0.948 (37920/40000), AUC 0.9872814416885376
ep6_train_time 9.179734706878662
Test Epoch6 layer0 Acc 0.8954, AUC 0.9577947854995728, avg_entr 0.15314455330371857, f1 0.8953999876976013
ep6_l0_test_time 0.7364404201507568
Test Epoch6 layer1 Acc 0.8948, AUC 0.9583233594894409, avg_entr 0.12448415160179138, f1 0.8948000073432922
ep6_l1_test_time 0.751331090927124
Test Epoch6 layer2 Acc 0.8966, AUC 0.95904541015625, avg_entr 0.12090376019477844, f1 0.8966000080108643
ep6_l2_test_time 0.7756681442260742
Test Epoch6 layer3 Acc 0.8968, AUC 0.9596610069274902, avg_entr 0.08431258797645569, f1 0.8967999815940857
ep6_l3_test_time 0.7873435020446777
Test Epoch6 layer4 Acc 0.896, AUC 0.9586079120635986, avg_entr 0.052154138684272766, f1 0.8960000276565552
ep6_l4_test_time 0.7734341621398926
gc 0
Train Epoch7 Acc 0.954475 (38179/40000), AUC 0.9894859194755554
ep7_train_time 11.35367751121521
Test Epoch7 layer0 Acc 0.8844, AUC 0.9560689330101013, avg_entr 0.15187305212020874, f1 0.8844000101089478
ep7_l0_test_time 0.7613534927368164
Test Epoch7 layer1 Acc 0.8898, AUC 0.9568030834197998, avg_entr 0.12302582710981369, f1 0.8898000121116638
ep7_l1_test_time 0.7789242267608643
Test Epoch7 layer2 Acc 0.8838, AUC 0.9580137729644775, avg_entr 0.12133712321519852, f1 0.8838000297546387
ep7_l2_test_time 0.7967121601104736
Test Epoch7 layer3 Acc 0.886, AUC 0.9584147334098816, avg_entr 0.08006594330072403, f1 0.8859999775886536
ep7_l3_test_time 0.750220537185669
Test Epoch7 layer4 Acc 0.886, AUC 0.9544632434844971, avg_entr 0.05078999325633049, f1 0.8859999775886536
ep7_l4_test_time 0.8155570030212402
gc 0
Train Epoch8 Acc 0.95925 (38370/40000), AUC 0.9908581972122192
ep8_train_time 11.295933961868286
Test Epoch8 layer0 Acc 0.8906, AUC 0.9541767239570618, avg_entr 0.14129433035850525, f1 0.8906000256538391
ep8_l0_test_time 0.7743093967437744
Test Epoch8 layer1 Acc 0.8916, AUC 0.9550384283065796, avg_entr 0.1133420392870903, f1 0.8916000127792358
ep8_l1_test_time 0.7979614734649658
Test Epoch8 layer2 Acc 0.8866, AUC 0.9559440016746521, avg_entr 0.11013197898864746, f1 0.8866000771522522
ep8_l2_test_time 0.8200376033782959
Test Epoch8 layer3 Acc 0.8898, AUC 0.9561481475830078, avg_entr 0.0647728443145752, f1 0.8898000121116638
ep8_l3_test_time 0.7363743782043457
Test Epoch8 layer4 Acc 0.89, AUC 0.952023983001709, avg_entr 0.040779851377010345, f1 0.8899999856948853
ep8_l4_test_time 0.7640781402587891
gc 0
Train Epoch9 Acc 0.963375 (38535/40000), AUC 0.9926614761352539
ep9_train_time 11.164426565170288
Test Epoch9 layer0 Acc 0.8918, AUC 0.9531477689743042, avg_entr 0.13554032146930695, f1 0.8917999863624573
ep9_l0_test_time 0.7772352695465088
Test Epoch9 layer1 Acc 0.8912, AUC 0.9541182518005371, avg_entr 0.1069837287068367, f1 0.8912000060081482
ep9_l1_test_time 0.7699844837188721
Test Epoch9 layer2 Acc 0.8922, AUC 0.9550647139549255, avg_entr 0.09916379302740097, f1 0.8921999931335449
ep9_l2_test_time 0.7765865325927734
Test Epoch9 layer3 Acc 0.892, AUC 0.9548130631446838, avg_entr 0.054391682147979736, f1 0.8920000195503235
ep9_l3_test_time 0.7727096080780029
Test Epoch9 layer4 Acc 0.8932, AUC 0.9503574371337891, avg_entr 0.033880166709423065, f1 0.8931999802589417
ep9_l4_test_time 0.7635362148284912
gc 0
Train Epoch10 Acc 0.96565 (38626/40000), AUC 0.9931855797767639
ep10_train_time 10.693313121795654
Test Epoch10 layer0 Acc 0.8922, AUC 0.9520437121391296, avg_entr 0.13302510976791382, f1 0.8921999931335449
ep10_l0_test_time 0.7339589595794678
Test Epoch10 layer1 Acc 0.8906, AUC 0.9530747532844543, avg_entr 0.1050165519118309, f1 0.8906000256538391
ep10_l1_test_time 0.7582778930664062
Test Epoch10 layer2 Acc 0.8896, AUC 0.9536793828010559, avg_entr 0.09923984110355377, f1 0.8895999193191528
ep10_l2_test_time 0.6208796501159668
Test Epoch10 layer3 Acc 0.8906, AUC 0.9528616666793823, avg_entr 0.05115393549203873, f1 0.8906000256538391
ep10_l3_test_time 0.611546516418457
Test Epoch10 layer4 Acc 0.8906, AUC 0.9480848908424377, avg_entr 0.03148379549384117, f1 0.8906000256538391
ep10_l4_test_time 0.6298856735229492
gc 0
Train Epoch11 Acc 0.9673 (38692/40000), AUC 0.9936290383338928
ep11_train_time 7.251946210861206
Test Epoch11 layer0 Acc 0.8894, AUC 0.9509004354476929, avg_entr 0.13056226074695587, f1 0.8894000053405762
ep11_l0_test_time 0.5580675601959229
Test Epoch11 layer1 Acc 0.8898, AUC 0.9520262479782104, avg_entr 0.1035517081618309, f1 0.8898000121116638
ep11_l1_test_time 0.5576896667480469
Test Epoch11 layer2 Acc 0.8882, AUC 0.953018307685852, avg_entr 0.09735073149204254, f1 0.888200044631958
ep11_l2_test_time 0.5594706535339355
Test Epoch11 layer3 Acc 0.8884, AUC 0.9514745473861694, avg_entr 0.04872414097189903, f1 0.8884000182151794
ep11_l3_test_time 0.5593743324279785
Test Epoch11 layer4 Acc 0.8874, AUC 0.9491331577301025, avg_entr 0.030679995194077492, f1 0.8873999714851379
ep11_l4_test_time 0.5586450099945068
gc 0
Train Epoch12 Acc 0.968175 (38727/40000), AUC 0.9941806793212891
ep12_train_time 9.146694421768188
Test Epoch12 layer0 Acc 0.8872, AUC 0.9494199752807617, avg_entr 0.13013772666454315, f1 0.8871999979019165
ep12_l0_test_time 0.8289294242858887
Test Epoch12 layer1 Acc 0.886, AUC 0.950667142868042, avg_entr 0.10273350775241852, f1 0.8859999775886536
ep12_l1_test_time 0.756800651550293
Test Epoch12 layer2 Acc 0.8848, AUC 0.951684832572937, avg_entr 0.09602262079715729, f1 0.8848000168800354
ep12_l2_test_time 0.8067653179168701
Test Epoch12 layer3 Acc 0.8844, AUC 0.9494651556015015, avg_entr 0.04745678976178169, f1 0.8844000101089478
ep12_l3_test_time 0.8668010234832764
Test Epoch12 layer4 Acc 0.8844, AUC 0.9477360844612122, avg_entr 0.029403747990727425, f1 0.8844000101089478
ep12_l4_test_time 0.8055343627929688
gc 0
Train Epoch13 Acc 0.96965 (38786/40000), AUC 0.9947541952133179
ep13_train_time 8.393032312393188
Test Epoch13 layer0 Acc 0.8858, AUC 0.9489464163780212, avg_entr 0.12711027264595032, f1 0.8858000040054321
ep13_l0_test_time 0.6522865295410156
Test Epoch13 layer1 Acc 0.8852, AUC 0.9502326250076294, avg_entr 0.09972647577524185, f1 0.8852000832557678
ep13_l1_test_time 0.6166074275970459
Test Epoch13 layer2 Acc 0.8838, AUC 0.9511699676513672, avg_entr 0.09136755764484406, f1 0.8838000297546387
ep13_l2_test_time 0.6310665607452393
Test Epoch13 layer3 Acc 0.8856, AUC 0.948825478553772, avg_entr 0.044028110802173615, f1 0.8855999708175659
ep13_l3_test_time 0.6384174823760986
Test Epoch13 layer4 Acc 0.8846, AUC 0.9471257925033569, avg_entr 0.028091201558709145, f1 0.8845999836921692
ep13_l4_test_time 0.6367917060852051
gc 0
Train Epoch14 Acc 0.9703 (38812/40000), AUC 0.9948655366897583
ep14_train_time 8.032510042190552
Test Epoch14 layer0 Acc 0.8848, AUC 0.9482008814811707, avg_entr 0.12695324420928955, f1 0.8848000168800354
ep14_l0_test_time 0.6193933486938477
Test Epoch14 layer1 Acc 0.884, AUC 0.9495490193367004, avg_entr 0.0996144562959671, f1 0.8840000033378601
ep14_l1_test_time 0.6393866539001465
Test Epoch14 layer2 Acc 0.883, AUC 0.9505288600921631, avg_entr 0.09084007889032364, f1 0.8830000162124634
ep14_l2_test_time 0.661144495010376
Test Epoch14 layer3 Acc 0.885, AUC 0.9478105306625366, avg_entr 0.04426534101366997, f1 0.8849999904632568
ep14_l3_test_time 0.6249165534973145
Test Epoch14 layer4 Acc 0.8844, AUC 0.9474893808364868, avg_entr 0.027524657547473907, f1 0.8844000101089478
ep14_l4_test_time 0.6286053657531738
gc 0
Train Epoch15 Acc 0.97105 (38842/40000), AUC 0.9949063062667847
ep15_train_time 8.046209573745728
Test Epoch15 layer0 Acc 0.8832, AUC 0.9475809335708618, avg_entr 0.12404309958219528, f1 0.8831999897956848
ep15_l0_test_time 0.6401882171630859
Test Epoch15 layer1 Acc 0.883, AUC 0.9489725232124329, avg_entr 0.09744777530431747, f1 0.8830000162124634
ep15_l1_test_time 0.636249303817749
Test Epoch15 layer2 Acc 0.8816, AUC 0.9496425986289978, avg_entr 0.08838988095521927, f1 0.881600022315979
ep15_l2_test_time 0.6404578685760498
Test Epoch15 layer3 Acc 0.8826, AUC 0.9470150470733643, avg_entr 0.04193218797445297, f1 0.8826000094413757
ep15_l3_test_time 0.6258172988891602
Test Epoch15 layer4 Acc 0.8822, AUC 0.9467262029647827, avg_entr 0.026544179767370224, f1 0.8822000026702881
ep15_l4_test_time 0.6436405181884766
gc 0
Train Epoch16 Acc 0.97125 (38850/40000), AUC 0.9951808452606201
ep16_train_time 9.65122938156128
Test Epoch16 layer0 Acc 0.8822, AUC 0.9469304084777832, avg_entr 0.12187209725379944, f1 0.8822000026702881
ep16_l0_test_time 0.8258848190307617
Test Epoch16 layer1 Acc 0.8834, AUC 0.9483702778816223, avg_entr 0.09522434324026108, f1 0.8834000825881958
ep16_l1_test_time 0.8305568695068359
Test Epoch16 layer2 Acc 0.8826, AUC 0.9491561651229858, avg_entr 0.08490211516618729, f1 0.8826000094413757
ep16_l2_test_time 0.8169107437133789
Test Epoch16 layer3 Acc 0.8842, AUC 0.9460126161575317, avg_entr 0.039656177163124084, f1 0.8842000365257263
ep16_l3_test_time 0.8220481872558594
Test Epoch16 layer4 Acc 0.8842, AUC 0.9451290965080261, avg_entr 0.025035468861460686, f1 0.8842000365257263
ep16_l4_test_time 0.8304665088653564
gc 0
Train Epoch17 Acc 0.972375 (38895/40000), AUC 0.9954995512962341
ep17_train_time 12.636056184768677
Test Epoch17 layer0 Acc 0.8822, AUC 0.9466973543167114, avg_entr 0.12185150384902954, f1 0.8822000026702881
ep17_l0_test_time 0.8333749771118164
Test Epoch17 layer1 Acc 0.8828, AUC 0.9481334686279297, avg_entr 0.09514831006526947, f1 0.8827999830245972
ep17_l1_test_time 0.8387911319732666
Test Epoch17 layer2 Acc 0.8802, AUC 0.9489049911499023, avg_entr 0.08452171087265015, f1 0.8802000284194946
ep17_l2_test_time 0.8731279373168945
Test Epoch17 layer3 Acc 0.8806, AUC 0.9459772109985352, avg_entr 0.03973608836531639, f1 0.8805999755859375
ep17_l3_test_time 0.8162555694580078
Test Epoch17 layer4 Acc 0.88, AUC 0.945436954498291, avg_entr 0.02503892220556736, f1 0.8799999952316284
ep17_l4_test_time 0.8286502361297607
gc 0
Train Epoch18 Acc 0.972725 (38909/40000), AUC 0.9954895377159119
ep18_train_time 12.668118715286255
Test Epoch18 layer0 Acc 0.8824, AUC 0.9463421106338501, avg_entr 0.12065992504358292, f1 0.8823999762535095
ep18_l0_test_time 0.8335092067718506
Test Epoch18 layer1 Acc 0.883, AUC 0.9478366374969482, avg_entr 0.09420716762542725, f1 0.8830000162124634
ep18_l1_test_time 0.8231580257415771
Test Epoch18 layer2 Acc 0.8802, AUC 0.9485193490982056, avg_entr 0.08401176333427429, f1 0.8802000284194946
ep18_l2_test_time 0.8086550235748291
Test Epoch18 layer3 Acc 0.882, AUC 0.9455620646476746, avg_entr 0.038555603474378586, f1 0.8820000290870667
ep18_l3_test_time 0.8261351585388184
Test Epoch18 layer4 Acc 0.8822, AUC 0.9443564414978027, avg_entr 0.024215981364250183, f1 0.8822000026702881
ep18_l4_test_time 0.838956356048584
gc 0
Train Epoch19 Acc 0.973225 (38929/40000), AUC 0.9956494569778442
ep19_train_time 12.732219696044922
Test Epoch19 layer0 Acc 0.8826, AUC 0.9461036920547485, avg_entr 0.11972170323133469, f1 0.8826000094413757
ep19_l0_test_time 0.8100278377532959
Test Epoch19 layer1 Acc 0.8816, AUC 0.9476224184036255, avg_entr 0.09353598952293396, f1 0.881600022315979
ep19_l1_test_time 0.8067858219146729
Test Epoch19 layer2 Acc 0.8796, AUC 0.9483214616775513, avg_entr 0.08282266557216644, f1 0.8795999884605408
ep19_l2_test_time 0.8420045375823975
Test Epoch19 layer3 Acc 0.8802, AUC 0.9455990195274353, avg_entr 0.038332339376211166, f1 0.8802000284194946
ep19_l3_test_time 0.838266134262085
Test Epoch19 layer4 Acc 0.8802, AUC 0.9465373754501343, avg_entr 0.023994537070393562, f1 0.8802000284194946
ep19_l4_test_time 0.8434250354766846
gc 0
Train Epoch20 Acc 0.97315 (38926/40000), AUC 0.99571692943573
ep20_train_time 11.904774904251099
Test Epoch20 layer0 Acc 0.8798, AUC 0.9458464980125427, avg_entr 0.11925572156906128, f1 0.879800021648407
ep20_l0_test_time 0.7905633449554443
Test Epoch20 layer1 Acc 0.88, AUC 0.9473845362663269, avg_entr 0.09306931495666504, f1 0.8799999952316284
ep20_l1_test_time 0.7397305965423584
Test Epoch20 layer2 Acc 0.8796, AUC 0.9480890035629272, avg_entr 0.08198875933885574, f1 0.8795999884605408
ep20_l2_test_time 0.7690043449401855
Test Epoch20 layer3 Acc 0.8796, AUC 0.9453449249267578, avg_entr 0.03837113827466965, f1 0.8795999884605408
ep20_l3_test_time 0.7579007148742676
Test Epoch20 layer4 Acc 0.8796, AUC 0.9467551708221436, avg_entr 0.024206291884183884, f1 0.8795999884605408
ep20_l4_test_time 0.7613599300384521
gc 0
Train Epoch21 Acc 0.9739 (38956/40000), AUC 0.9959038496017456
ep21_train_time 11.533574104309082
Test Epoch21 layer0 Acc 0.8802, AUC 0.9456963539123535, avg_entr 0.11861968040466309, f1 0.8802000284194946
ep21_l0_test_time 0.7542088031768799
Test Epoch21 layer1 Acc 0.8818, AUC 0.9472352266311646, avg_entr 0.09234444051980972, f1 0.8818000555038452
ep21_l1_test_time 0.9506344795227051
Test Epoch21 layer2 Acc 0.879, AUC 0.9479389190673828, avg_entr 0.08132500946521759, f1 0.8790000081062317
ep21_l2_test_time 1.021737813949585
Test Epoch21 layer3 Acc 0.8798, AUC 0.9449785351753235, avg_entr 0.03774623945355415, f1 0.879800021648407
ep21_l3_test_time 1.0031814575195312
Test Epoch21 layer4 Acc 0.8794, AUC 0.9440456628799438, avg_entr 0.023958366364240646, f1 0.8794000148773193
ep21_l4_test_time 0.9760220050811768
gc 0
Train Epoch22 Acc 0.974175 (38967/40000), AUC 0.9958631992340088
ep22_train_time 13.440414428710938
Test Epoch22 layer0 Acc 0.881, AUC 0.9455339908599854, avg_entr 0.11779692023992538, f1 0.8809999823570251
ep22_l0_test_time 0.8148913383483887
Test Epoch22 layer1 Acc 0.882, AUC 0.947081446647644, avg_entr 0.0916764959692955, f1 0.8820000290870667
ep22_l1_test_time 0.8284201622009277
Test Epoch22 layer2 Acc 0.879, AUC 0.9478015899658203, avg_entr 0.08060315251350403, f1 0.8790000081062317
ep22_l2_test_time 0.8175952434539795
Test Epoch22 layer3 Acc 0.8798, AUC 0.9447852373123169, avg_entr 0.03716731071472168, f1 0.879800021648407
ep22_l3_test_time 0.8444678783416748
Test Epoch22 layer4 Acc 0.8792, AUC 0.9435645937919617, avg_entr 0.023801222443580627, f1 0.8791999816894531
ep22_l4_test_time 0.8295724391937256
gc 0
Train Epoch23 Acc 0.974125 (38965/40000), AUC 0.9958336353302002
ep23_train_time 12.728702068328857
Test Epoch23 layer0 Acc 0.8794, AUC 0.9453980922698975, avg_entr 0.11755069345235825, f1 0.8794000148773193
ep23_l0_test_time 0.824866533279419
Test Epoch23 layer1 Acc 0.8806, AUC 0.9469600915908813, avg_entr 0.09137796610593796, f1 0.8805999755859375
ep23_l1_test_time 0.8556466102600098
Test Epoch23 layer2 Acc 0.8792, AUC 0.9476478099822998, avg_entr 0.07996591180562973, f1 0.8791999816894531
ep23_l2_test_time 0.8422591686248779
Test Epoch23 layer3 Acc 0.879, AUC 0.9449219703674316, avg_entr 0.03710338845849037, f1 0.8790000081062317
ep23_l3_test_time 0.8141884803771973
Test Epoch23 layer4 Acc 0.879, AUC 0.9453896284103394, avg_entr 0.02361147850751877, f1 0.8790000081062317
ep23_l4_test_time 0.8254332542419434
gc 0
Train Epoch24 Acc 0.9745 (38980/40000), AUC 0.9960626363754272
ep24_train_time 12.700488090515137
Test Epoch24 layer0 Acc 0.8792, AUC 0.9452508687973022, avg_entr 0.11683574318885803, f1 0.8791999816894531
ep24_l0_test_time 0.8032081127166748
Test Epoch24 layer1 Acc 0.879, AUC 0.9468196630477905, avg_entr 0.09082887321710587, f1 0.8790000081062317
ep24_l1_test_time 0.8636393547058105
Test Epoch24 layer2 Acc 0.8798, AUC 0.9475086331367493, avg_entr 0.07956376671791077, f1 0.879800021648407
ep24_l2_test_time 0.8028676509857178
Test Epoch24 layer3 Acc 0.879, AUC 0.9444169402122498, avg_entr 0.037096235901117325, f1 0.8790000081062317
ep24_l3_test_time 0.8210861682891846
Test Epoch24 layer4 Acc 0.8788, AUC 0.9443237781524658, avg_entr 0.023686286062002182, f1 0.8787999749183655
ep24_l4_test_time 0.8321218490600586
gc 0
Train Epoch25 Acc 0.974675 (38987/40000), AUC 0.9960643649101257
ep25_train_time 12.73061227798462
Test Epoch25 layer0 Acc 0.8808, AUC 0.9451639652252197, avg_entr 0.11602453887462616, f1 0.8808000087738037
ep25_l0_test_time 0.7898674011230469
Test Epoch25 layer1 Acc 0.8808, AUC 0.9467484354972839, avg_entr 0.08995398879051208, f1 0.8808000087738037
ep25_l1_test_time 0.8261821269989014
Test Epoch25 layer2 Acc 0.879, AUC 0.9474252462387085, avg_entr 0.07857885211706161, f1 0.8790000081062317
ep25_l2_test_time 0.858635663986206
Test Epoch25 layer3 Acc 0.879, AUC 0.9443551301956177, avg_entr 0.03584515303373337, f1 0.8790000081062317
ep25_l3_test_time 0.8503389358520508
Test Epoch25 layer4 Acc 0.8788, AUC 0.9439263343811035, avg_entr 0.022904902696609497, f1 0.8787999749183655
ep25_l4_test_time 0.8246042728424072
gc 0
Train Epoch26 Acc 0.974425 (38977/40000), AUC 0.9960482120513916
ep26_train_time 12.78015661239624
Test Epoch26 layer0 Acc 0.8794, AUC 0.9451193809509277, avg_entr 0.11591485887765884, f1 0.8794000148773193
ep26_l0_test_time 0.8645954132080078
Test Epoch26 layer1 Acc 0.8808, AUC 0.9466978311538696, avg_entr 0.08988577127456665, f1 0.8808000087738037
ep26_l1_test_time 0.8426156044006348
Test Epoch26 layer2 Acc 0.8786, AUC 0.9473581314086914, avg_entr 0.07850436121225357, f1 0.878600001335144
ep26_l2_test_time 0.8041625022888184
Test Epoch26 layer3 Acc 0.8784, AUC 0.9443628787994385, avg_entr 0.036022353917360306, f1 0.8784000277519226
ep26_l3_test_time 0.830977201461792
Test Epoch26 layer4 Acc 0.8792, AUC 0.9432951211929321, avg_entr 0.02304038777947426, f1 0.8791999816894531
ep26_l4_test_time 0.8355147838592529
gc 0
Train Epoch27 Acc 0.97475 (38990/40000), AUC 0.9960243701934814
ep27_train_time 12.697179317474365
Test Epoch27 layer0 Acc 0.8786, AUC 0.9450647234916687, avg_entr 0.11550635099411011, f1 0.878600001335144
ep27_l0_test_time 0.8116321563720703
Test Epoch27 layer1 Acc 0.8794, AUC 0.9466497898101807, avg_entr 0.08961373567581177, f1 0.8794000148773193
ep27_l1_test_time 0.819256067276001
Test Epoch27 layer2 Acc 0.8788, AUC 0.9473084807395935, avg_entr 0.07812586426734924, f1 0.8787999749183655
ep27_l2_test_time 0.8199295997619629
Test Epoch27 layer3 Acc 0.879, AUC 0.944382905960083, avg_entr 0.036074962466955185, f1 0.8790000081062317
ep27_l3_test_time 0.8571252822875977
Test Epoch27 layer4 Acc 0.8786, AUC 0.9442400932312012, avg_entr 0.02308906614780426, f1 0.878600001335144
ep27_l4_test_time 0.8213324546813965
gc 0
Train Epoch28 Acc 0.9745 (38980/40000), AUC 0.9960335493087769
ep28_train_time 12.665488719940186
Test Epoch28 layer0 Acc 0.8792, AUC 0.9449983835220337, avg_entr 0.1147785633802414, f1 0.8791999816894531
ep28_l0_test_time 0.7968454360961914
Test Epoch28 layer1 Acc 0.8802, AUC 0.9465823173522949, avg_entr 0.08887307345867157, f1 0.8802000284194946
ep28_l1_test_time 0.8676378726959229
Test Epoch28 layer2 Acc 0.8782, AUC 0.9472399353981018, avg_entr 0.07730790227651596, f1 0.8781999945640564
ep28_l2_test_time 0.816957950592041
Test Epoch28 layer3 Acc 0.8782, AUC 0.9441503286361694, avg_entr 0.03538709878921509, f1 0.8781999945640564
ep28_l3_test_time 0.8092632293701172
Test Epoch28 layer4 Acc 0.8788, AUC 0.9436097145080566, avg_entr 0.02269546501338482, f1 0.8787999749183655
ep28_l4_test_time 0.8342876434326172
gc 0
Train Epoch29 Acc 0.97455 (38982/40000), AUC 0.9960907697677612
ep29_train_time 11.942384481430054
Test Epoch29 layer0 Acc 0.878, AUC 0.9449554085731506, avg_entr 0.1150478795170784, f1 0.878000020980835
ep29_l0_test_time 0.7867510318756104
Test Epoch29 layer1 Acc 0.8778, AUC 0.9465553760528564, avg_entr 0.08913296461105347, f1 0.8778000473976135
ep29_l1_test_time 0.7563855648040771
Test Epoch29 layer2 Acc 0.8794, AUC 0.9472229480743408, avg_entr 0.07759843021631241, f1 0.8794000148773193
ep29_l2_test_time 0.78633713722229
Test Epoch29 layer3 Acc 0.8782, AUC 0.9444151520729065, avg_entr 0.03585042804479599, f1 0.8781999945640564
ep29_l3_test_time 0.7951974868774414
Test Epoch29 layer4 Acc 0.8786, AUC 0.9446609020233154, avg_entr 0.02292325347661972, f1 0.878600001335144
ep29_l4_test_time 0.7815742492675781
Best AUC tensor(0.9012) 4 0
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 462.40875720977783
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8952, AUC 0.9560027122497559, avg_entr 0.18065080046653748, f1 0.8952000141143799
l0_test_time 0.8099548816680908
Test layer1 Acc 0.8934, AUC 0.9562088251113892, avg_entr 0.1540413647890091, f1 0.8934000134468079
l1_test_time 0.790294885635376
Test layer2 Acc 0.8934, AUC 0.9567022323608398, avg_entr 0.15351536870002747, f1 0.8934000134468079
l2_test_time 0.7947812080383301
Test layer3 Acc 0.893, AUC 0.956976592540741, avg_entr 0.1286773979663849, f1 0.8930000066757202
l3_test_time 0.7834208011627197
Test layer4 Acc 0.8938, AUC 0.9575552940368652, avg_entr 0.09577889740467072, f1 0.8938000202178955
l4_test_time 0.7999985218048096
