total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.364976167678833
Start Training
gc 0
Train Epoch0 Acc 0.520825 (20833/40000), AUC 0.5370020866394043
ep0_train_time 11.307228565216064
Test Epoch0 layer0 Acc 0.794, AUC 0.8801674842834473, avg_entr 0.5964786410331726, f1 0.7940000295639038
ep0_l0_test_time 0.7820649147033691
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6446, AUC 0.7960792779922485, avg_entr 0.6918864846229553, f1 0.644599974155426
ep0_l1_test_time 0.7705402374267578
Test Epoch0 layer2 Acc 0.5848, AUC 0.7925766110420227, avg_entr 0.6954203844070435, f1 0.5848000049591064
ep0_l2_test_time 0.775223970413208
Test Epoch0 layer3 Acc 0.5566, AUC 0.7730397582054138, avg_entr 0.6932973861694336, f1 0.5565999746322632
ep0_l3_test_time 0.7684268951416016
Test Epoch0 layer4 Acc 0.5434, AUC 0.8030039668083191, avg_entr 0.6950865387916565, f1 0.54339998960495
ep0_l4_test_time 0.7620036602020264
gc 0
Train Epoch1 Acc 0.786525 (31461/40000), AUC 0.8762422800064087
ep1_train_time 10.358068704605103
Test Epoch1 layer0 Acc 0.8776, AUC 0.9451967477798462, avg_entr 0.29658201336860657, f1 0.8776000142097473
ep1_l0_test_time 0.7792892456054688
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8822, AUC 0.9455574750900269, avg_entr 0.40711021423339844, f1 0.8822000026702881
ep1_l1_test_time 0.7697501182556152
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8748, AUC 0.9453625679016113, avg_entr 0.26045721769332886, f1 0.8748000264167786
ep1_l2_test_time 0.7652852535247803
Test Epoch1 layer3 Acc 0.874, AUC 0.9458282589912415, avg_entr 0.24614819884300232, f1 0.8740000128746033
ep1_l3_test_time 0.7771878242492676
Test Epoch1 layer4 Acc 0.875, AUC 0.945990800857544, avg_entr 0.24750149250030518, f1 0.875
ep1_l4_test_time 0.7661237716674805
gc 0
Train Epoch2 Acc 0.902225 (36089/40000), AUC 0.9626955986022949
ep2_train_time 10.320827960968018
Test Epoch2 layer0 Acc 0.8742, AUC 0.9552311897277832, avg_entr 0.22366496920585632, f1 0.8741999864578247
ep2_l0_test_time 0.7617878913879395
Test Epoch2 layer1 Acc 0.8774, AUC 0.9557380080223083, avg_entr 0.22081372141838074, f1 0.8773999810218811
ep2_l1_test_time 0.771453857421875
Test Epoch2 layer2 Acc 0.8682, AUC 0.9558686017990112, avg_entr 0.19559535384178162, f1 0.8682000041007996
ep2_l2_test_time 0.7699887752532959
Test Epoch2 layer3 Acc 0.871, AUC 0.9559488296508789, avg_entr 0.1862334907054901, f1 0.8709999918937683
ep2_l3_test_time 0.7788352966308594
Test Epoch2 layer4 Acc 0.8678, AUC 0.9559597969055176, avg_entr 0.1699022650718689, f1 0.8677999973297119
ep2_l4_test_time 0.7666633129119873
gc 0
Train Epoch3 Acc 0.921075 (36843/40000), AUC 0.9747275710105896
ep3_train_time 10.375829696655273
Test Epoch3 layer0 Acc 0.8908, AUC 0.9574729800224304, avg_entr 0.2013418823480606, f1 0.8907999992370605
ep3_l0_test_time 0.7609117031097412
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8954, AUC 0.9581382870674133, avg_entr 0.18509680032730103, f1 0.8953999876976013
ep3_l1_test_time 0.7747089862823486
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.8932, AUC 0.9584246873855591, avg_entr 0.17553448677062988, f1 0.8931999802589417
ep3_l2_test_time 0.7639038562774658
Test Epoch3 layer3 Acc 0.8872, AUC 0.9591042399406433, avg_entr 0.1597118079662323, f1 0.8871999979019165
ep3_l3_test_time 0.7781815528869629
Test Epoch3 layer4 Acc 0.8884, AUC 0.9592700600624084, avg_entr 0.13558225333690643, f1 0.8884000182151794
ep3_l4_test_time 0.7739038467407227
gc 0
Train Epoch4 Acc 0.93215 (37286/40000), AUC 0.9808866381645203
ep4_train_time 10.447285890579224
Test Epoch4 layer0 Acc 0.8988, AUC 0.9588160514831543, avg_entr 0.1773802638053894, f1 0.8988000154495239
ep4_l0_test_time 0.7610540390014648
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.9008, AUC 0.9594520330429077, avg_entr 0.15819263458251953, f1 0.9007999897003174
ep4_l1_test_time 0.7618000507354736
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.8988, AUC 0.9597901105880737, avg_entr 0.14968056976795197, f1 0.8988000154495239
ep4_l2_test_time 0.7621026039123535
Test Epoch4 layer3 Acc 0.899, AUC 0.9601131081581116, avg_entr 0.12393014132976532, f1 0.8989999890327454
ep4_l3_test_time 0.7545163631439209
Test Epoch4 layer4 Acc 0.9002, AUC 0.9604751467704773, avg_entr 0.08835024386644363, f1 0.9002000093460083
ep4_l4_test_time 0.756899356842041
gc 0
Train Epoch5 Acc 0.94175 (37670/40000), AUC 0.9848397374153137
ep5_train_time 10.434126138687134
Test Epoch5 layer0 Acc 0.8988, AUC 0.9585055112838745, avg_entr 0.16349971294403076, f1 0.8988000154495239
ep5_l0_test_time 0.760237455368042
Test Epoch5 layer1 Acc 0.9, AUC 0.9590539336204529, avg_entr 0.14271430671215057, f1 0.8999999761581421
ep5_l1_test_time 0.7760906219482422
Test Epoch5 layer2 Acc 0.9004, AUC 0.9596875309944153, avg_entr 0.13476727902889252, f1 0.9003999829292297
ep5_l2_test_time 0.7710006237030029
Test Epoch5 layer3 Acc 0.8996, AUC 0.9602022767066956, avg_entr 0.10029038041830063, f1 0.8996000289916992
ep5_l3_test_time 0.7442784309387207
Test Epoch5 layer4 Acc 0.9004, AUC 0.96067214012146, avg_entr 0.06452710181474686, f1 0.9003999829292297
ep5_l4_test_time 0.7758369445800781
gc 0
Train Epoch6 Acc 0.946875 (37875/40000), AUC 0.9868531823158264
ep6_train_time 10.402684688568115
Test Epoch6 layer0 Acc 0.8994, AUC 0.9574980139732361, avg_entr 0.15251104533672333, f1 0.8993999361991882
ep6_l0_test_time 0.770641565322876
Test Epoch6 layer1 Acc 0.8986, AUC 0.9583624601364136, avg_entr 0.1314212679862976, f1 0.8985999822616577
ep6_l1_test_time 0.7786083221435547
Test Epoch6 layer2 Acc 0.8998, AUC 0.9586730003356934, avg_entr 0.12379222363233566, f1 0.8998000025749207
ep6_l2_test_time 0.7712662220001221
Test Epoch6 layer3 Acc 0.9006, AUC 0.9594421982765198, avg_entr 0.08376787602901459, f1 0.900600016117096
ep6_l3_test_time 0.7634849548339844
Test Epoch6 layer4 Acc 0.8998, AUC 0.9588887691497803, avg_entr 0.052508898079395294, f1 0.8998000025749207
ep6_l4_test_time 0.7775981426239014
gc 0
Train Epoch7 Acc 0.9537 (38148/40000), AUC 0.989237368106842
ep7_train_time 7.314908742904663
Test Epoch7 layer0 Acc 0.8874, AUC 0.9560621976852417, avg_entr 0.14139553904533386, f1 0.8873999714851379
ep7_l0_test_time 0.5565018653869629
Test Epoch7 layer1 Acc 0.89, AUC 0.9569869637489319, avg_entr 0.1203736662864685, f1 0.8899999856948853
ep7_l1_test_time 0.554969310760498
Test Epoch7 layer2 Acc 0.8914, AUC 0.9574731588363647, avg_entr 0.10954391956329346, f1 0.8913999795913696
ep7_l2_test_time 0.5600090026855469
Test Epoch7 layer3 Acc 0.89, AUC 0.9583109021186829, avg_entr 0.06720566004514694, f1 0.8899999856948853
ep7_l3_test_time 0.5711002349853516
Test Epoch7 layer4 Acc 0.8906, AUC 0.9551548957824707, avg_entr 0.04340018332004547, f1 0.8906000256538391
ep7_l4_test_time 0.586597204208374
gc 0
Train Epoch8 Acc 0.958825 (38353/40000), AUC 0.990968644618988
ep8_train_time 6.946925640106201
Test Epoch8 layer0 Acc 0.8908, AUC 0.9543143510818481, avg_entr 0.1356351673603058, f1 0.8907999992370605
ep8_l0_test_time 0.5681884288787842
Test Epoch8 layer1 Acc 0.89, AUC 0.9553512334823608, avg_entr 0.11391328275203705, f1 0.8899999856948853
ep8_l1_test_time 0.5635967254638672
Test Epoch8 layer2 Acc 0.8928, AUC 0.9562305212020874, avg_entr 0.09936411678791046, f1 0.892799973487854
ep8_l2_test_time 0.5646204948425293
Test Epoch8 layer3 Acc 0.8904, AUC 0.9567936062812805, avg_entr 0.05454672873020172, f1 0.8903999924659729
ep8_l3_test_time 0.5674645900726318
Test Epoch8 layer4 Acc 0.891, AUC 0.9534071683883667, avg_entr 0.03478403761982918, f1 0.890999972820282
ep8_l4_test_time 0.5695993900299072
gc 0
Train Epoch9 Acc 0.963275 (38531/40000), AUC 0.992430567741394
ep9_train_time 6.953203201293945
Test Epoch9 layer0 Acc 0.8922, AUC 0.953504204750061, avg_entr 0.13448774814605713, f1 0.8921999931335449
ep9_l0_test_time 0.5940940380096436
Test Epoch9 layer1 Acc 0.8948, AUC 0.9545464515686035, avg_entr 0.11242232471704483, f1 0.8948000073432922
ep9_l1_test_time 0.591188907623291
Test Epoch9 layer2 Acc 0.8926, AUC 0.9555954933166504, avg_entr 0.09780723601579666, f1 0.8925999999046326
ep9_l2_test_time 0.5843420028686523
Test Epoch9 layer3 Acc 0.8938, AUC 0.9558545351028442, avg_entr 0.05166420340538025, f1 0.8938000202178955
ep9_l3_test_time 0.5569067001342773
Test Epoch9 layer4 Acc 0.8932, AUC 0.952931821346283, avg_entr 0.03362136706709862, f1 0.8931999802589417
ep9_l4_test_time 0.5525906085968018
gc 0
Train Epoch10 Acc 0.964725 (38589/40000), AUC 0.9930199384689331
ep10_train_time 6.556328058242798
Test Epoch10 layer0 Acc 0.8908, AUC 0.9526021480560303, avg_entr 0.1309843212366104, f1 0.8907999992370605
ep10_l0_test_time 0.552664041519165
Test Epoch10 layer1 Acc 0.8916, AUC 0.9536473155021667, avg_entr 0.10915657877922058, f1 0.8916000127792358
ep10_l1_test_time 0.554379940032959
Test Epoch10 layer2 Acc 0.8938, AUC 0.9547551870346069, avg_entr 0.09351091086864471, f1 0.8938000202178955
ep10_l2_test_time 0.5543298721313477
Test Epoch10 layer3 Acc 0.8934, AUC 0.9543264508247375, avg_entr 0.047847360372543335, f1 0.8934000134468079
ep10_l3_test_time 0.5550434589385986
Test Epoch10 layer4 Acc 0.8924, AUC 0.9517914056777954, avg_entr 0.03066960535943508, f1 0.8923999667167664
ep10_l4_test_time 0.5535774230957031
gc 0
Train Epoch11 Acc 0.965875 (38635/40000), AUC 0.9934118986129761
ep11_train_time 6.591820955276489
Test Epoch11 layer0 Acc 0.8816, AUC 0.9511078000068665, avg_entr 0.12707430124282837, f1 0.881600022315979
ep11_l0_test_time 0.556265115737915
Test Epoch11 layer1 Acc 0.8818, AUC 0.9524331092834473, avg_entr 0.10607923567295074, f1 0.8818000555038452
ep11_l1_test_time 0.556520938873291
Test Epoch11 layer2 Acc 0.8874, AUC 0.9527404308319092, avg_entr 0.08894696831703186, f1 0.8873999714851379
ep11_l2_test_time 0.5648117065429688
Test Epoch11 layer3 Acc 0.884, AUC 0.9515361785888672, avg_entr 0.044733691960573196, f1 0.8840000033378601
ep11_l3_test_time 0.5575814247131348
Test Epoch11 layer4 Acc 0.8852, AUC 0.9477971196174622, avg_entr 0.03010408580303192, f1 0.8852000832557678
ep11_l4_test_time 0.5545494556427002
gc 0
Train Epoch12 Acc 0.9671 (38684/40000), AUC 0.9938327074050903
ep12_train_time 6.6154913902282715
Test Epoch12 layer0 Acc 0.8872, AUC 0.9504239559173584, avg_entr 0.12632538378238678, f1 0.8871999979019165
ep12_l0_test_time 0.5537073612213135
Test Epoch12 layer1 Acc 0.8884, AUC 0.9517379999160767, avg_entr 0.10472669452428818, f1 0.8884000182151794
ep12_l1_test_time 0.5542185306549072
Test Epoch12 layer2 Acc 0.89, AUC 0.9526880979537964, avg_entr 0.08732327818870544, f1 0.8899999856948853
ep12_l2_test_time 0.561959981918335
Test Epoch12 layer3 Acc 0.8888, AUC 0.9508301019668579, avg_entr 0.041814371943473816, f1 0.8888000249862671
ep12_l3_test_time 0.5564606189727783
Test Epoch12 layer4 Acc 0.889, AUC 0.9488301277160645, avg_entr 0.027501726523041725, f1 0.8889999985694885
ep12_l4_test_time 0.560173511505127
gc 0
Train Epoch13 Acc 0.9695 (38780/40000), AUC 0.9945908784866333
ep13_train_time 6.527407169342041
Test Epoch13 layer0 Acc 0.8862, AUC 0.9497997760772705, avg_entr 0.12518051266670227, f1 0.8862000107765198
ep13_l0_test_time 0.5543873310089111
Test Epoch13 layer1 Acc 0.8872, AUC 0.9511741399765015, avg_entr 0.10353130847215652, f1 0.8871999979019165
ep13_l1_test_time 0.5515439510345459
Test Epoch13 layer2 Acc 0.8886, AUC 0.9521167874336243, avg_entr 0.08505392074584961, f1 0.8885999917984009
ep13_l2_test_time 0.5552828311920166
Test Epoch13 layer3 Acc 0.888, AUC 0.9502545595169067, avg_entr 0.04012611508369446, f1 0.8880000114440918
ep13_l3_test_time 0.5574228763580322
Test Epoch13 layer4 Acc 0.8874, AUC 0.9488883018493652, avg_entr 0.026603927835822105, f1 0.8873999714851379
ep13_l4_test_time 0.558314323425293
gc 0
Train Epoch14 Acc 0.969925 (38797/40000), AUC 0.9946537613868713
ep14_train_time 6.629182815551758
Test Epoch14 layer0 Acc 0.8868, AUC 0.9492702484130859, avg_entr 0.12360810488462448, f1 0.8867999911308289
ep14_l0_test_time 0.5534999370574951
Test Epoch14 layer1 Acc 0.8868, AUC 0.9507094621658325, avg_entr 0.10208471119403839, f1 0.8867999911308289
ep14_l1_test_time 0.5520756244659424
Test Epoch14 layer2 Acc 0.8882, AUC 0.9515025615692139, avg_entr 0.08377321809530258, f1 0.888200044631958
ep14_l2_test_time 0.5538384914398193
Test Epoch14 layer3 Acc 0.8876, AUC 0.9495570659637451, avg_entr 0.038761477917432785, f1 0.8876000046730042
ep14_l3_test_time 0.563265323638916
Test Epoch14 layer4 Acc 0.8876, AUC 0.9498429298400879, avg_entr 0.02578285150229931, f1 0.8876000046730042
ep14_l4_test_time 0.5577695369720459
gc 0
Train Epoch15 Acc 0.971225 (38849/40000), AUC 0.9946727752685547
ep15_train_time 6.860498428344727
Test Epoch15 layer0 Acc 0.8836, AUC 0.9486910104751587, avg_entr 0.12427191436290741, f1 0.8835999965667725
ep15_l0_test_time 0.5670080184936523
Test Epoch15 layer1 Acc 0.8826, AUC 0.9500974416732788, avg_entr 0.1025565043091774, f1 0.8826000094413757
ep15_l1_test_time 0.5649991035461426
Test Epoch15 layer2 Acc 0.8852, AUC 0.951134979724884, avg_entr 0.08359699696302414, f1 0.8852000832557678
ep15_l2_test_time 0.5652256011962891
Test Epoch15 layer3 Acc 0.8846, AUC 0.9481867551803589, avg_entr 0.03898904472589493, f1 0.8845999836921692
ep15_l3_test_time 0.570610523223877
Test Epoch15 layer4 Acc 0.8846, AUC 0.9470081329345703, avg_entr 0.025513889268040657, f1 0.8845999836921692
ep15_l4_test_time 0.5681884288787842
gc 0
Train Epoch16 Acc 0.971 (38840/40000), AUC 0.9949556589126587
ep16_train_time 7.50033164024353
Test Epoch16 layer0 Acc 0.8846, AUC 0.9481641054153442, avg_entr 0.11987990885972977, f1 0.8845999836921692
ep16_l0_test_time 0.7144169807434082
Test Epoch16 layer1 Acc 0.8868, AUC 0.9496179819107056, avg_entr 0.09886213392019272, f1 0.8867999911308289
ep16_l1_test_time 0.7766575813293457
Test Epoch16 layer2 Acc 0.8848, AUC 0.9504961967468262, avg_entr 0.07930422574281693, f1 0.8848000168800354
ep16_l2_test_time 0.7594845294952393
Test Epoch16 layer3 Acc 0.8866, AUC 0.9475585222244263, avg_entr 0.037117283791303635, f1 0.8866000771522522
ep16_l3_test_time 0.7678568363189697
Test Epoch16 layer4 Acc 0.8864, AUC 0.9480345249176025, avg_entr 0.024954257532954216, f1 0.8863999843597412
ep16_l4_test_time 0.6892554759979248
gc 0
Train Epoch17 Acc 0.97215 (38886/40000), AUC 0.9953095316886902
ep17_train_time 10.71059799194336
Test Epoch17 layer0 Acc 0.8842, AUC 0.9478666186332703, avg_entr 0.11911220848560333, f1 0.8842000365257263
ep17_l0_test_time 0.5779564380645752
Test Epoch17 layer1 Acc 0.8864, AUC 0.9493801593780518, avg_entr 0.09801606088876724, f1 0.8863999843597412
ep17_l1_test_time 0.5819363594055176
Test Epoch17 layer2 Acc 0.8854, AUC 0.9501820802688599, avg_entr 0.07847610116004944, f1 0.8853999972343445
ep17_l2_test_time 0.5895745754241943
Test Epoch17 layer3 Acc 0.8856, AUC 0.9475409984588623, avg_entr 0.035992950201034546, f1 0.8855999708175659
ep17_l3_test_time 0.5579700469970703
Test Epoch17 layer4 Acc 0.885, AUC 0.9477176666259766, avg_entr 0.024073578417301178, f1 0.8849999904632568
ep17_l4_test_time 0.5506837368011475
gc 0
Train Epoch18 Acc 0.97285 (38914/40000), AUC 0.995288610458374
ep18_train_time 6.561263799667358
Test Epoch18 layer0 Acc 0.882, AUC 0.9473466873168945, avg_entr 0.1174968034029007, f1 0.8820000290870667
ep18_l0_test_time 0.5553493499755859
Test Epoch18 layer1 Acc 0.883, AUC 0.9489556550979614, avg_entr 0.09668457508087158, f1 0.8830000162124634
ep18_l1_test_time 0.5555388927459717
Test Epoch18 layer2 Acc 0.885, AUC 0.9495543241500854, avg_entr 0.07694277167320251, f1 0.8849999904632568
ep18_l2_test_time 0.556732177734375
Test Epoch18 layer3 Acc 0.8848, AUC 0.9462817907333374, avg_entr 0.03530779108405113, f1 0.8848000168800354
ep18_l3_test_time 0.5566134452819824
Test Epoch18 layer4 Acc 0.8838, AUC 0.9467695951461792, avg_entr 0.02342010848224163, f1 0.8838000297546387
ep18_l4_test_time 0.5858089923858643
gc 0
Train Epoch19 Acc 0.972775 (38911/40000), AUC 0.9956305027008057
ep19_train_time 6.7952821254730225
Test Epoch19 layer0 Acc 0.8828, AUC 0.9472135305404663, avg_entr 0.1179666742682457, f1 0.8827999830245972
ep19_l0_test_time 0.5563995838165283
Test Epoch19 layer1 Acc 0.8836, AUC 0.9487922191619873, avg_entr 0.09668825566768646, f1 0.8835999965667725
ep19_l1_test_time 0.5570597648620605
Test Epoch19 layer2 Acc 0.8838, AUC 0.9495404958724976, avg_entr 0.07680214196443558, f1 0.8838000297546387
ep19_l2_test_time 0.5780720710754395
Test Epoch19 layer3 Acc 0.8846, AUC 0.9466429948806763, avg_entr 0.03455016016960144, f1 0.8845999836921692
ep19_l3_test_time 0.6036336421966553
Test Epoch19 layer4 Acc 0.8836, AUC 0.9474880695343018, avg_entr 0.023546872660517693, f1 0.8835999965667725
ep19_l4_test_time 0.5873847007751465
gc 0
Train Epoch20 Acc 0.9727 (38908/40000), AUC 0.9956607818603516
ep20_train_time 10.911300420761108
Test Epoch20 layer0 Acc 0.8828, AUC 0.9469180703163147, avg_entr 0.11565622687339783, f1 0.8827999830245972
ep20_l0_test_time 0.7622947692871094
Test Epoch20 layer1 Acc 0.8844, AUC 0.9485431909561157, avg_entr 0.09498128294944763, f1 0.8844000101089478
ep20_l1_test_time 0.7673909664154053
Test Epoch20 layer2 Acc 0.8844, AUC 0.9491992592811584, avg_entr 0.07499737292528152, f1 0.8844000101089478
ep20_l2_test_time 0.7515444755554199
Test Epoch20 layer3 Acc 0.884, AUC 0.9460442066192627, avg_entr 0.033532850444316864, f1 0.8840000033378601
ep20_l3_test_time 0.7626967430114746
Test Epoch20 layer4 Acc 0.8838, AUC 0.9474457502365112, avg_entr 0.021954109892249107, f1 0.8838000297546387
ep20_l4_test_time 0.7600507736206055
gc 0
Train Epoch21 Acc 0.973525 (38941/40000), AUC 0.995699405670166
ep21_train_time 11.396536827087402
Test Epoch21 layer0 Acc 0.882, AUC 0.9468246698379517, avg_entr 0.11634737253189087, f1 0.8820000290870667
ep21_l0_test_time 0.7513532638549805
Test Epoch21 layer1 Acc 0.8822, AUC 0.9483955502510071, avg_entr 0.09533920139074326, f1 0.8822000026702881
ep21_l1_test_time 0.7624328136444092
Test Epoch21 layer2 Acc 0.8838, AUC 0.949266254901886, avg_entr 0.07537093013525009, f1 0.8838000297546387
ep21_l2_test_time 0.7623653411865234
Test Epoch21 layer3 Acc 0.883, AUC 0.9461739659309387, avg_entr 0.03415446728467941, f1 0.8830000162124634
ep21_l3_test_time 0.7536008358001709
Test Epoch21 layer4 Acc 0.8834, AUC 0.947494626045227, avg_entr 0.023324202746152878, f1 0.8834000825881958
ep21_l4_test_time 0.7795073986053467
gc 0
Train Epoch22 Acc 0.973425 (38937/40000), AUC 0.9956254959106445
ep22_train_time 11.340028762817383
Test Epoch22 layer0 Acc 0.883, AUC 0.9465965032577515, avg_entr 0.11469712108373642, f1 0.8830000162124634
ep22_l0_test_time 0.7478959560394287
Test Epoch22 layer1 Acc 0.883, AUC 0.9482346773147583, avg_entr 0.09391459822654724, f1 0.8830000162124634
ep22_l1_test_time 0.7598247528076172
Test Epoch22 layer2 Acc 0.8828, AUC 0.9489091634750366, avg_entr 0.0739014744758606, f1 0.8827999830245972
ep22_l2_test_time 0.7557201385498047
Test Epoch22 layer3 Acc 0.8848, AUC 0.9451442360877991, avg_entr 0.03306672349572182, f1 0.8848000168800354
ep22_l3_test_time 0.7434911727905273
Test Epoch22 layer4 Acc 0.884, AUC 0.9444533586502075, avg_entr 0.02184298448264599, f1 0.8840000033378601
ep22_l4_test_time 0.760141134262085
gc 0
Train Epoch23 Acc 0.973525 (38941/40000), AUC 0.9958795309066772
ep23_train_time 11.271969556808472
Test Epoch23 layer0 Acc 0.8824, AUC 0.9465258121490479, avg_entr 0.11544328927993774, f1 0.8823999762535095
ep23_l0_test_time 0.7591855525970459
Test Epoch23 layer1 Acc 0.882, AUC 0.9481291174888611, avg_entr 0.09430117160081863, f1 0.8820000290870667
ep23_l1_test_time 0.7530245780944824
Test Epoch23 layer2 Acc 0.8834, AUC 0.9489347338676453, avg_entr 0.07406358420848846, f1 0.8834000825881958
ep23_l2_test_time 0.7537233829498291
Test Epoch23 layer3 Acc 0.8816, AUC 0.945902407169342, avg_entr 0.03296060115098953, f1 0.881600022315979
ep23_l3_test_time 0.7595198154449463
Test Epoch23 layer4 Acc 0.8812, AUC 0.9470779895782471, avg_entr 0.022572530433535576, f1 0.8812000155448914
ep23_l4_test_time 0.7571902275085449
gc 0
Train Epoch24 Acc 0.973925 (38957/40000), AUC 0.9959030151367188
ep24_train_time 11.403920650482178
Test Epoch24 layer0 Acc 0.8806, AUC 0.946426510810852, avg_entr 0.11458948999643326, f1 0.8805999755859375
ep24_l0_test_time 0.7653241157531738
Test Epoch24 layer1 Acc 0.8818, AUC 0.9480005502700806, avg_entr 0.0936252772808075, f1 0.8818000555038452
ep24_l1_test_time 0.766650915145874
Test Epoch24 layer2 Acc 0.8824, AUC 0.9488548040390015, avg_entr 0.0737084448337555, f1 0.8823999762535095
ep24_l2_test_time 0.7536022663116455
Test Epoch24 layer3 Acc 0.881, AUC 0.9451953172683716, avg_entr 0.0331624411046505, f1 0.8809999823570251
ep24_l3_test_time 0.7683026790618896
Test Epoch24 layer4 Acc 0.8806, AUC 0.9453781843185425, avg_entr 0.022841406986117363, f1 0.8805999755859375
ep24_l4_test_time 0.7664358615875244
gc 0
Train Epoch25 Acc 0.9741 (38964/40000), AUC 0.9959745407104492
ep25_train_time 11.352638959884644
Test Epoch25 layer0 Acc 0.8808, AUC 0.9463040828704834, avg_entr 0.11365459859371185, f1 0.8808000087738037
ep25_l0_test_time 0.7390193939208984
Test Epoch25 layer1 Acc 0.8832, AUC 0.9479361772537231, avg_entr 0.09277863055467606, f1 0.8831999897956848
ep25_l1_test_time 0.767409086227417
Test Epoch25 layer2 Acc 0.8834, AUC 0.9486894607543945, avg_entr 0.07257264852523804, f1 0.8834000825881958
ep25_l2_test_time 0.7865324020385742
Test Epoch25 layer3 Acc 0.8814, AUC 0.9453496932983398, avg_entr 0.032092366367578506, f1 0.8813999891281128
ep25_l3_test_time 0.7603023052215576
Test Epoch25 layer4 Acc 0.882, AUC 0.9468340873718262, avg_entr 0.02154051885008812, f1 0.8820000290870667
ep25_l4_test_time 0.7648963928222656
gc 0
Train Epoch26 Acc 0.97425 (38970/40000), AUC 0.9959321618080139
ep26_train_time 11.4439537525177
Test Epoch26 layer0 Acc 0.883, AUC 0.9462133049964905, avg_entr 0.11275218427181244, f1 0.8830000162124634
ep26_l0_test_time 0.7436673641204834
Test Epoch26 layer1 Acc 0.884, AUC 0.9478466510772705, avg_entr 0.0920579805970192, f1 0.8840000033378601
ep26_l1_test_time 0.7709317207336426
Test Epoch26 layer2 Acc 0.8824, AUC 0.9485610723495483, avg_entr 0.07203007489442825, f1 0.8823999762535095
ep26_l2_test_time 0.7673959732055664
Test Epoch26 layer3 Acc 0.8826, AUC 0.9445927143096924, avg_entr 0.03177107498049736, f1 0.8826000094413757
ep26_l3_test_time 0.746192216873169
Test Epoch26 layer4 Acc 0.8828, AUC 0.944580078125, avg_entr 0.020955892279744148, f1 0.8827999830245972
ep26_l4_test_time 0.7545528411865234
gc 0
Train Epoch27 Acc 0.974025 (38961/40000), AUC 0.996017336845398
ep27_train_time 11.368032693862915
Test Epoch27 layer0 Acc 0.8812, AUC 0.9461879730224609, avg_entr 0.11290358752012253, f1 0.8812000155448914
ep27_l0_test_time 0.759638786315918
Test Epoch27 layer1 Acc 0.8828, AUC 0.9478260278701782, avg_entr 0.09197963774204254, f1 0.8827999830245972
ep27_l1_test_time 0.7535238265991211
Test Epoch27 layer2 Acc 0.8834, AUC 0.9485766887664795, avg_entr 0.07179535180330276, f1 0.8834000825881958
ep27_l2_test_time 0.760857105255127
Test Epoch27 layer3 Acc 0.881, AUC 0.9451127052307129, avg_entr 0.03184795752167702, f1 0.8809999823570251
ep27_l3_test_time 0.757587194442749
Test Epoch27 layer4 Acc 0.8818, AUC 0.9459797739982605, avg_entr 0.021575795486569405, f1 0.8818000555038452
ep27_l4_test_time 0.7525970935821533
gc 0
Train Epoch28 Acc 0.974175 (38967/40000), AUC 0.9960001707077026
ep28_train_time 11.361654996871948
Test Epoch28 layer0 Acc 0.8814, AUC 0.9461169242858887, avg_entr 0.11246639490127563, f1 0.8813999891281128
ep28_l0_test_time 0.7618863582611084
Test Epoch28 layer1 Acc 0.8828, AUC 0.9477604627609253, avg_entr 0.09163055568933487, f1 0.8827999830245972
ep28_l1_test_time 0.7573733329772949
Test Epoch28 layer2 Acc 0.8832, AUC 0.9485086798667908, avg_entr 0.07156328856945038, f1 0.8831999897956848
ep28_l2_test_time 0.7629103660583496
Test Epoch28 layer3 Acc 0.8822, AUC 0.944976806640625, avg_entr 0.03163627162575722, f1 0.8822000026702881
ep28_l3_test_time 0.7558648586273193
Test Epoch28 layer4 Acc 0.8816, AUC 0.9459241628646851, avg_entr 0.021515673026442528, f1 0.881600022315979
ep28_l4_test_time 0.7570054531097412
gc 0
Train Epoch29 Acc 0.97405 (38962/40000), AUC 0.9960664510726929
ep29_train_time 11.324392318725586
Test Epoch29 layer0 Acc 0.8812, AUC 0.9460968971252441, avg_entr 0.11209280788898468, f1 0.8812000155448914
ep29_l0_test_time 0.7551398277282715
Test Epoch29 layer1 Acc 0.8828, AUC 0.9477289915084839, avg_entr 0.09127648919820786, f1 0.8827999830245972
ep29_l1_test_time 0.7592990398406982
Test Epoch29 layer2 Acc 0.8824, AUC 0.9484906792640686, avg_entr 0.07109059393405914, f1 0.8823999762535095
ep29_l2_test_time 0.7733242511749268
Test Epoch29 layer3 Acc 0.8816, AUC 0.9449276924133301, avg_entr 0.03156883269548416, f1 0.881600022315979
ep29_l3_test_time 0.7584221363067627
Test Epoch29 layer4 Acc 0.8814, AUC 0.9461362361907959, avg_entr 0.02136538177728653, f1 0.8813999891281128
ep29_l4_test_time 0.7644791603088379
Best AUC tensor(0.9008) 4 1
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 383.5652985572815
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8966, AUC 0.9560078382492065, avg_entr 0.17860543727874756, f1 0.8966000080108643
l0_test_time 0.767204761505127
Test layer1 Acc 0.8958, AUC 0.9564945697784424, avg_entr 0.16038085520267487, f1 0.895799994468689
l1_test_time 0.764296293258667
Test layer2 Acc 0.8974, AUC 0.9568966627120972, avg_entr 0.15280087292194366, f1 0.8974000215530396
l2_test_time 0.7618904113769531
Test layer3 Acc 0.8954, AUC 0.9570435881614685, avg_entr 0.12833940982818604, f1 0.8953999876976013
l3_test_time 0.7656340599060059
Test layer4 Acc 0.897, AUC 0.9573797583580017, avg_entr 0.09355098009109497, f1 0.8970000147819519
l4_test_time 0.7783734798431396
