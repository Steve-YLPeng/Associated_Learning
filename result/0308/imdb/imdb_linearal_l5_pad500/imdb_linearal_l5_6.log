total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 23.418323278427124
Start Training
gc 0
Train Epoch0 Acc 0.50205 (20082/40000), AUC 0.5074377059936523
ep0_train_time 17.725716590881348
Test Epoch0 layer0 Acc 0.7756, AUC 0.8913559913635254, avg_entr 0.5628126859664917, f1 0.775600016117096
ep0_l0_test_time 0.9961206912994385
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.6678, AUC 0.8787810206413269, avg_entr 0.6845924258232117, f1 0.6678000092506409
ep0_l1_test_time 0.9692821502685547
Test Epoch0 layer2 Acc 0.5178, AUC 0.8813365697860718, avg_entr 0.6823665499687195, f1 0.517799973487854
ep0_l2_test_time 0.9729256629943848
Test Epoch0 layer3 Acc 0.5006, AUC 0.8038069009780884, avg_entr 0.6838890314102173, f1 0.5005999803543091
ep0_l3_test_time 1.0025410652160645
Test Epoch0 layer4 Acc 0.5004, AUC 0.6648443937301636, avg_entr 0.6851463913917542, f1 0.5004000067710876
ep0_l4_test_time 1.003779411315918
gc 0
Train Epoch1 Acc 0.794 (31760/40000), AUC 0.8866703510284424
ep1_train_time 15.849003553390503
Test Epoch1 layer0 Acc 0.8794, AUC 0.9456862211227417, avg_entr 0.2906394898891449, f1 0.8794000148773193
ep1_l0_test_time 0.9606029987335205
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8808, AUC 0.9459784030914307, avg_entr 0.35223251581192017, f1 0.8808000087738037
ep1_l1_test_time 0.9965400695800781
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8808, AUC 0.946532130241394, avg_entr 0.24827146530151367, f1 0.8808000087738037
ep1_l2_test_time 0.9565815925598145
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer3 Acc 0.8798, AUC 0.9463855028152466, avg_entr 0.2302999049425125, f1 0.879800021648407
ep1_l3_test_time 0.9787189960479736
Test Epoch1 layer4 Acc 0.8806, AUC 0.9464301466941833, avg_entr 0.23441649973392487, f1 0.8805999755859375
ep1_l4_test_time 0.9688987731933594
gc 0
Train Epoch2 Acc 0.9063 (36252/40000), AUC 0.9649746417999268
ep2_train_time 15.504369497299194
Test Epoch2 layer0 Acc 0.8932, AUC 0.9552890062332153, avg_entr 0.2282976508140564, f1 0.8931999802589417
ep2_l0_test_time 0.9119076728820801
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8952, AUC 0.9556668996810913, avg_entr 0.21636171638965607, f1 0.8952000141143799
ep2_l1_test_time 0.8288414478302002
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8946, AUC 0.956236720085144, avg_entr 0.2008846551179886, f1 0.894599974155426
ep2_l2_test_time 0.8059859275817871
Test Epoch2 layer3 Acc 0.8944, AUC 0.9562433958053589, avg_entr 0.18312878906726837, f1 0.8944000005722046
ep2_l3_test_time 0.7579641342163086
Test Epoch2 layer4 Acc 0.895, AUC 0.9563028812408447, avg_entr 0.1728229820728302, f1 0.8949999809265137
ep2_l4_test_time 0.8094823360443115
gc 0
Train Epoch3 Acc 0.9234 (36936/40000), AUC 0.9757391810417175
ep3_train_time 13.943334341049194
Test Epoch3 layer0 Acc 0.8984, AUC 0.9583732485771179, avg_entr 0.19859342277050018, f1 0.8984000086784363
ep3_l0_test_time 1.012308120727539
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8984, AUC 0.9587715864181519, avg_entr 0.17587344348430634, f1 0.8984000086784363
ep3_l1_test_time 1.0080525875091553
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.9, AUC 0.95937180519104, avg_entr 0.17115803062915802, f1 0.8999999761581421
ep3_l2_test_time 1.0095202922821045
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.8994, AUC 0.9594831466674805, avg_entr 0.15063385665416718, f1 0.8993999361991882
ep3_l3_test_time 1.0066678524017334
Test Epoch3 layer4 Acc 0.8996, AUC 0.9595481753349304, avg_entr 0.12855900824069977, f1 0.8996000289916992
ep3_l4_test_time 1.0010559558868408
gc 0
Train Epoch4 Acc 0.93495 (37398/40000), AUC 0.9814398288726807
ep4_train_time 16.255157470703125
Test Epoch4 layer0 Acc 0.899, AUC 0.9588409662246704, avg_entr 0.17758998274803162, f1 0.8989999890327454
ep4_l0_test_time 1.0247726440429688
Test Epoch4 layer1 Acc 0.9002, AUC 0.9591830968856812, avg_entr 0.15305311977863312, f1 0.9002000093460083
ep4_l1_test_time 0.9405114650726318
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer2 Acc 0.9012, AUC 0.9599142074584961, avg_entr 0.14811263978481293, f1 0.901199996471405
ep4_l2_test_time 0.8048238754272461
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer3 Acc 0.9006, AUC 0.9601997137069702, avg_entr 0.12151949107646942, f1 0.900600016117096
ep4_l3_test_time 0.7913556098937988
Test Epoch4 layer4 Acc 0.9004, AUC 0.9604398012161255, avg_entr 0.09032467752695084, f1 0.9003999829292297
ep4_l4_test_time 0.777106523513794
gc 0
Train Epoch5 Acc 0.943275 (37731/40000), AUC 0.985447883605957
ep5_train_time 11.164352655410767
Test Epoch5 layer0 Acc 0.8928, AUC 0.9583091735839844, avg_entr 0.16309130191802979, f1 0.892799973487854
ep5_l0_test_time 0.7706329822540283
Test Epoch5 layer1 Acc 0.8944, AUC 0.9587728977203369, avg_entr 0.13820143043994904, f1 0.8944000005722046
ep5_l1_test_time 0.777519702911377
Test Epoch5 layer2 Acc 0.8974, AUC 0.9596538543701172, avg_entr 0.13410699367523193, f1 0.8974000215530396
ep5_l2_test_time 0.7438902854919434
Test Epoch5 layer3 Acc 0.897, AUC 0.9601032733917236, avg_entr 0.09964987635612488, f1 0.8970000147819519
ep5_l3_test_time 0.780123233795166
Test Epoch5 layer4 Acc 0.8956, AUC 0.9603806734085083, avg_entr 0.06418105214834213, f1 0.8956000208854675
ep5_l4_test_time 0.7553400993347168
gc 0
Train Epoch6 Acc 0.94855 (37942/40000), AUC 0.9871047735214233
ep6_train_time 11.153489828109741
Test Epoch6 layer0 Acc 0.8986, AUC 0.9573807716369629, avg_entr 0.1547950953245163, f1 0.8985999822616577
ep6_l0_test_time 0.7599136829376221
Test Epoch6 layer1 Acc 0.8968, AUC 0.9579133987426758, avg_entr 0.12900404632091522, f1 0.8967999815940857
ep6_l1_test_time 0.7734606266021729
Test Epoch6 layer2 Acc 0.8968, AUC 0.9588579535484314, avg_entr 0.12223542481660843, f1 0.8967999815940857
ep6_l2_test_time 0.7811715602874756
Test Epoch6 layer3 Acc 0.8956, AUC 0.9594674110412598, avg_entr 0.08258140832185745, f1 0.8956000208854675
ep6_l3_test_time 0.7774815559387207
Test Epoch6 layer4 Acc 0.8952, AUC 0.9584352970123291, avg_entr 0.05147337540984154, f1 0.8952000141143799
ep6_l4_test_time 0.7719712257385254
gc 0
Train Epoch7 Acc 0.9542 (38168/40000), AUC 0.9893202781677246
ep7_train_time 11.203340530395508
Test Epoch7 layer0 Acc 0.8898, AUC 0.9556597471237183, avg_entr 0.14458611607551575, f1 0.8898000121116638
ep7_l0_test_time 0.7511529922485352
Test Epoch7 layer1 Acc 0.8922, AUC 0.9563316106796265, avg_entr 0.1193697527050972, f1 0.8921999931335449
ep7_l1_test_time 0.7631664276123047
Test Epoch7 layer2 Acc 0.8938, AUC 0.9576131105422974, avg_entr 0.10743054002523422, f1 0.8938000202178955
ep7_l2_test_time 0.7702679634094238
Test Epoch7 layer3 Acc 0.8934, AUC 0.9581928253173828, avg_entr 0.0655752569437027, f1 0.8934000134468079
ep7_l3_test_time 0.7701730728149414
Test Epoch7 layer4 Acc 0.893, AUC 0.9550601243972778, avg_entr 0.04050469398498535, f1 0.8930000066757202
ep7_l4_test_time 0.7981576919555664
gc 0
Train Epoch8 Acc 0.960075 (38403/40000), AUC 0.9909509420394897
ep8_train_time 11.162785768508911
Test Epoch8 layer0 Acc 0.8906, AUC 0.9537883996963501, avg_entr 0.14110185205936432, f1 0.8906000256538391
ep8_l0_test_time 0.7686693668365479
Test Epoch8 layer1 Acc 0.8926, AUC 0.9547504782676697, avg_entr 0.11534063518047333, f1 0.8925999999046326
ep8_l1_test_time 0.7576766014099121
Test Epoch8 layer2 Acc 0.8926, AUC 0.956130862236023, avg_entr 0.1023821011185646, f1 0.8925999999046326
ep8_l2_test_time 0.7691354751586914
Test Epoch8 layer3 Acc 0.893, AUC 0.9563459157943726, avg_entr 0.05734548345208168, f1 0.8930000066757202
ep8_l3_test_time 0.7651727199554443
Test Epoch8 layer4 Acc 0.8924, AUC 0.9528120160102844, avg_entr 0.036462195217609406, f1 0.8923999667167664
ep8_l4_test_time 0.7744364738464355
gc 0
Train Epoch9 Acc 0.964025 (38561/40000), AUC 0.9926970601081848
ep9_train_time 11.1544189453125
Test Epoch9 layer0 Acc 0.8922, AUC 0.9527826309204102, avg_entr 0.13498257100582123, f1 0.8921999931335449
ep9_l0_test_time 0.7820601463317871
Test Epoch9 layer1 Acc 0.891, AUC 0.953742265701294, avg_entr 0.11008576303720474, f1 0.890999972820282
ep9_l1_test_time 0.765505313873291
Test Epoch9 layer2 Acc 0.8914, AUC 0.9548377990722656, avg_entr 0.09484047442674637, f1 0.8913999795913696
ep9_l2_test_time 0.7614665031433105
Test Epoch9 layer3 Acc 0.8908, AUC 0.9546834230422974, avg_entr 0.05131874978542328, f1 0.8907999992370605
ep9_l3_test_time 0.7670254707336426
Test Epoch9 layer4 Acc 0.8896, AUC 0.9510743618011475, avg_entr 0.032488882541656494, f1 0.8895999193191528
ep9_l4_test_time 0.74794602394104
gc 0
Train Epoch10 Acc 0.9654 (38616/40000), AUC 0.9934015274047852
ep10_train_time 11.208112239837646
Test Epoch10 layer0 Acc 0.8878, AUC 0.9515255689620972, avg_entr 0.1340775489807129, f1 0.8877999782562256
ep10_l0_test_time 0.7765190601348877
Test Epoch10 layer1 Acc 0.888, AUC 0.9526404738426208, avg_entr 0.10902487486600876, f1 0.8880000114440918
ep10_l1_test_time 0.7648341655731201
Test Epoch10 layer2 Acc 0.889, AUC 0.9539206027984619, avg_entr 0.09267862886190414, f1 0.8889999985694885
ep10_l2_test_time 0.7600932121276855
Test Epoch10 layer3 Acc 0.8896, AUC 0.9529263377189636, avg_entr 0.049397602677345276, f1 0.8895999193191528
ep10_l3_test_time 0.7628095149993896
Test Epoch10 layer4 Acc 0.8896, AUC 0.9491904973983765, avg_entr 0.03074069134891033, f1 0.8895999193191528
ep10_l4_test_time 0.7592806816101074
gc 0
Train Epoch11 Acc 0.96675 (38670/40000), AUC 0.9938411712646484
ep11_train_time 11.203492164611816
Test Epoch11 layer0 Acc 0.8902, AUC 0.9507384300231934, avg_entr 0.13017478585243225, f1 0.8902000188827515
ep11_l0_test_time 0.7667956352233887
Test Epoch11 layer1 Acc 0.8894, AUC 0.9518800377845764, avg_entr 0.10559279471635818, f1 0.8894000053405762
ep11_l1_test_time 0.7519242763519287
Test Epoch11 layer2 Acc 0.8884, AUC 0.953032374382019, avg_entr 0.08772364258766174, f1 0.8884000182151794
ep11_l2_test_time 0.7774457931518555
Test Epoch11 layer3 Acc 0.8872, AUC 0.9515988826751709, avg_entr 0.04546123743057251, f1 0.8871999979019165
ep11_l3_test_time 0.7497367858886719
Test Epoch11 layer4 Acc 0.888, AUC 0.9490125179290771, avg_entr 0.028563058003783226, f1 0.8880000114440918
ep11_l4_test_time 0.7774868011474609
gc 0
Train Epoch12 Acc 0.968725 (38749/40000), AUC 0.9944599866867065
ep12_train_time 11.214815378189087
Test Epoch12 layer0 Acc 0.8862, AUC 0.9494214057922363, avg_entr 0.12751899659633636, f1 0.8862000107765198
ep12_l0_test_time 0.7649524211883545
Test Epoch12 layer1 Acc 0.8874, AUC 0.9506419897079468, avg_entr 0.10321445018053055, f1 0.8873999714851379
ep12_l1_test_time 0.7576730251312256
Test Epoch12 layer2 Acc 0.886, AUC 0.9517663717269897, avg_entr 0.08447733521461487, f1 0.8859999775886536
ep12_l2_test_time 0.7662198543548584
Test Epoch12 layer3 Acc 0.887, AUC 0.9499799013137817, avg_entr 0.0428742840886116, f1 0.8870000243186951
ep12_l3_test_time 0.772852897644043
Test Epoch12 layer4 Acc 0.8866, AUC 0.9479068517684937, avg_entr 0.027147939428687096, f1 0.8866000771522522
ep12_l4_test_time 0.7627413272857666
gc 0
Train Epoch13 Acc 0.9703 (38812/40000), AUC 0.9950226545333862
ep13_train_time 11.25718879699707
Test Epoch13 layer0 Acc 0.8858, AUC 0.9488540291786194, avg_entr 0.12446083873510361, f1 0.8858000040054321
ep13_l0_test_time 0.7548208236694336
Test Epoch13 layer1 Acc 0.8858, AUC 0.9501175880432129, avg_entr 0.10039974004030228, f1 0.8858000040054321
ep13_l1_test_time 0.7809901237487793
Test Epoch13 layer2 Acc 0.8882, AUC 0.9512012004852295, avg_entr 0.08031582832336426, f1 0.888200044631958
ep13_l2_test_time 0.7664377689361572
Test Epoch13 layer3 Acc 0.8878, AUC 0.9484026432037354, avg_entr 0.0404428206384182, f1 0.8877999782562256
ep13_l3_test_time 0.7679073810577393
Test Epoch13 layer4 Acc 0.8878, AUC 0.946321964263916, avg_entr 0.0256352536380291, f1 0.8877999782562256
ep13_l4_test_time 0.7701399326324463
gc 0
Train Epoch14 Acc 0.970975 (38839/40000), AUC 0.9951819181442261
ep14_train_time 11.134351015090942
Test Epoch14 layer0 Acc 0.885, AUC 0.9480653405189514, avg_entr 0.12529002130031586, f1 0.8849999904632568
ep14_l0_test_time 0.7692592144012451
Test Epoch14 layer1 Acc 0.8864, AUC 0.9494231939315796, avg_entr 0.10115693509578705, f1 0.8863999843597412
ep14_l1_test_time 0.782468318939209
Test Epoch14 layer2 Acc 0.8842, AUC 0.9504754543304443, avg_entr 0.08078812062740326, f1 0.8842000365257263
ep14_l2_test_time 0.8010299205780029
Test Epoch14 layer3 Acc 0.886, AUC 0.9477949142456055, avg_entr 0.040209345519542694, f1 0.8859999775886536
ep14_l3_test_time 0.7819705009460449
Test Epoch14 layer4 Acc 0.8864, AUC 0.9455475211143494, avg_entr 0.025465819984674454, f1 0.8863999843597412
ep14_l4_test_time 0.7737114429473877
gc 0
Train Epoch15 Acc 0.971725 (38869/40000), AUC 0.9953927993774414
ep15_train_time 11.19828462600708
Test Epoch15 layer0 Acc 0.8818, AUC 0.9474743604660034, avg_entr 0.12438634037971497, f1 0.8818000555038452
ep15_l0_test_time 0.7666926383972168
Test Epoch15 layer1 Acc 0.8836, AUC 0.9488542079925537, avg_entr 0.10039118677377701, f1 0.8835999965667725
ep15_l1_test_time 0.7472782135009766
Test Epoch15 layer2 Acc 0.8818, AUC 0.949836015701294, avg_entr 0.07948857545852661, f1 0.8818000555038452
ep15_l2_test_time 0.7627053260803223
Test Epoch15 layer3 Acc 0.882, AUC 0.9471566677093506, avg_entr 0.03968149796128273, f1 0.8820000290870667
ep15_l3_test_time 0.7915246486663818
Test Epoch15 layer4 Acc 0.8824, AUC 0.9462317228317261, avg_entr 0.02502581849694252, f1 0.8823999762535095
ep15_l4_test_time 0.7759106159210205
gc 0
Train Epoch16 Acc 0.972375 (38895/40000), AUC 0.995602011680603
ep16_train_time 11.274288654327393
Test Epoch16 layer0 Acc 0.8824, AUC 0.9469606280326843, avg_entr 0.12046053260564804, f1 0.8823999762535095
ep16_l0_test_time 0.7747926712036133
Test Epoch16 layer1 Acc 0.8824, AUC 0.9483572840690613, avg_entr 0.0968640148639679, f1 0.8823999762535095
ep16_l1_test_time 0.7649223804473877
Test Epoch16 layer2 Acc 0.884, AUC 0.9491900205612183, avg_entr 0.07564777135848999, f1 0.8840000033378601
ep16_l2_test_time 0.7880654335021973
Test Epoch16 layer3 Acc 0.8846, AUC 0.945639967918396, avg_entr 0.03744173049926758, f1 0.8845999836921692
ep16_l3_test_time 0.7580618858337402
Test Epoch16 layer4 Acc 0.8848, AUC 0.9460029602050781, avg_entr 0.024274494498968124, f1 0.8848000168800354
ep16_l4_test_time 0.7660143375396729
gc 0
Train Epoch17 Acc 0.97285 (38914/40000), AUC 0.9958306550979614
ep17_train_time 11.276570081710815
Test Epoch17 layer0 Acc 0.8842, AUC 0.9465973377227783, avg_entr 0.12071438878774643, f1 0.8842000365257263
ep17_l0_test_time 0.7589945793151855
Test Epoch17 layer1 Acc 0.8848, AUC 0.9480153322219849, avg_entr 0.09700435400009155, f1 0.8848000168800354
ep17_l1_test_time 0.7494845390319824
Test Epoch17 layer2 Acc 0.883, AUC 0.9489399194717407, avg_entr 0.07578487694263458, f1 0.8830000162124634
ep17_l2_test_time 0.7815978527069092
Test Epoch17 layer3 Acc 0.8832, AUC 0.9454092979431152, avg_entr 0.03744785115122795, f1 0.8831999897956848
ep17_l3_test_time 0.7509844303131104
Test Epoch17 layer4 Acc 0.8838, AUC 0.9457989931106567, avg_entr 0.024062318727374077, f1 0.8838000297546387
ep17_l4_test_time 0.7737548351287842
gc 0
Train Epoch18 Acc 0.973025 (38921/40000), AUC 0.9959588050842285
ep18_train_time 11.14002513885498
Test Epoch18 layer0 Acc 0.8826, AUC 0.9463119506835938, avg_entr 0.11928929388523102, f1 0.8826000094413757
ep18_l0_test_time 0.7622411251068115
Test Epoch18 layer1 Acc 0.8836, AUC 0.9477640390396118, avg_entr 0.09569788724184036, f1 0.8835999965667725
ep18_l1_test_time 0.7734096050262451
Test Epoch18 layer2 Acc 0.8838, AUC 0.9486386775970459, avg_entr 0.07412019371986389, f1 0.8838000297546387
ep18_l2_test_time 0.7677905559539795
Test Epoch18 layer3 Acc 0.8844, AUC 0.9451380968093872, avg_entr 0.03633221238851547, f1 0.8844000101089478
ep18_l3_test_time 0.7764177322387695
Test Epoch18 layer4 Acc 0.8848, AUC 0.9452716112136841, avg_entr 0.02353651449084282, f1 0.8848000168800354
ep18_l4_test_time 0.8178458213806152
gc 0
Train Epoch19 Acc 0.97315 (38926/40000), AUC 0.9959191083908081
ep19_train_time 11.144908905029297
Test Epoch19 layer0 Acc 0.8832, AUC 0.9460414052009583, avg_entr 0.11909809708595276, f1 0.8831999897956848
ep19_l0_test_time 0.7597124576568604
Test Epoch19 layer1 Acc 0.883, AUC 0.9474966526031494, avg_entr 0.09565427154302597, f1 0.8830000162124634
ep19_l1_test_time 0.7765250205993652
Test Epoch19 layer2 Acc 0.8812, AUC 0.9483561515808105, avg_entr 0.07411825656890869, f1 0.8812000155448914
ep19_l2_test_time 0.7863063812255859
Test Epoch19 layer3 Acc 0.8826, AUC 0.9447716474533081, avg_entr 0.03623368591070175, f1 0.8826000094413757
ep19_l3_test_time 0.7689864635467529
Test Epoch19 layer4 Acc 0.882, AUC 0.9455795288085938, avg_entr 0.023609865456819534, f1 0.8820000290870667
ep19_l4_test_time 0.7865731716156006
gc 0
Train Epoch20 Acc 0.973525 (38941/40000), AUC 0.9960217475891113
ep20_train_time 11.180273056030273
Test Epoch20 layer0 Acc 0.8794, AUC 0.9456546306610107, avg_entr 0.11684145778417587, f1 0.8794000148773193
ep20_l0_test_time 0.7489838600158691
Test Epoch20 layer1 Acc 0.8802, AUC 0.9471442699432373, avg_entr 0.09370002895593643, f1 0.8802000284194946
ep20_l1_test_time 0.7759809494018555
Test Epoch20 layer2 Acc 0.8808, AUC 0.9479371309280396, avg_entr 0.07138262689113617, f1 0.8808000087738037
ep20_l2_test_time 0.779120922088623
Test Epoch20 layer3 Acc 0.8814, AUC 0.9436360597610474, avg_entr 0.035112414509058, f1 0.8813999891281128
ep20_l3_test_time 0.774385929107666
Test Epoch20 layer4 Acc 0.8814, AUC 0.9435743689537048, avg_entr 0.02290407568216324, f1 0.8813999891281128
ep20_l4_test_time 0.7629721164703369
gc 0
Train Epoch21 Acc 0.9745 (38980/40000), AUC 0.9962201118469238
ep21_train_time 11.106183767318726
Test Epoch21 layer0 Acc 0.8804, AUC 0.945529580116272, avg_entr 0.11661425977945328, f1 0.8804000020027161
ep21_l0_test_time 0.75411057472229
Test Epoch21 layer1 Acc 0.8818, AUC 0.9470148086547852, avg_entr 0.0933755487203598, f1 0.8818000555038452
ep21_l1_test_time 0.7719414234161377
Test Epoch21 layer2 Acc 0.8824, AUC 0.9478178024291992, avg_entr 0.0712967962026596, f1 0.8823999762535095
ep21_l2_test_time 0.7675726413726807
Test Epoch21 layer3 Acc 0.8824, AUC 0.9435195922851562, avg_entr 0.0349431112408638, f1 0.8823999762535095
ep21_l3_test_time 0.7624530792236328
Test Epoch21 layer4 Acc 0.8824, AUC 0.9439213275909424, avg_entr 0.02279866859316826, f1 0.8823999762535095
ep21_l4_test_time 0.7676851749420166
gc 0
Train Epoch22 Acc 0.974475 (38979/40000), AUC 0.9962509274482727
ep22_train_time 11.16370940208435
Test Epoch22 layer0 Acc 0.8814, AUC 0.9453754425048828, avg_entr 0.1169900968670845, f1 0.8813999891281128
ep22_l0_test_time 0.7886333465576172
Test Epoch22 layer1 Acc 0.882, AUC 0.9468836784362793, avg_entr 0.09364856034517288, f1 0.8820000290870667
ep22_l1_test_time 0.758195161819458
Test Epoch22 layer2 Acc 0.8802, AUC 0.9477372169494629, avg_entr 0.07173243165016174, f1 0.8802000284194946
ep22_l2_test_time 0.7779042720794678
Test Epoch22 layer3 Acc 0.8798, AUC 0.943993866443634, avg_entr 0.03492883965373039, f1 0.879800021648407
ep22_l3_test_time 0.7828948497772217
Test Epoch22 layer4 Acc 0.8802, AUC 0.9451757669448853, avg_entr 0.022948987782001495, f1 0.8802000284194946
ep22_l4_test_time 0.759404182434082
gc 0
Train Epoch23 Acc 0.97445 (38978/40000), AUC 0.9962301254272461
ep23_train_time 11.173357963562012
Test Epoch23 layer0 Acc 0.88, AUC 0.9452314376831055, avg_entr 0.11517700552940369, f1 0.8799999952316284
ep23_l0_test_time 0.7704319953918457
Test Epoch23 layer1 Acc 0.88, AUC 0.9467600584030151, avg_entr 0.09214943647384644, f1 0.8799999952316284
ep23_l1_test_time 0.7591924667358398
Test Epoch23 layer2 Acc 0.8798, AUC 0.9475257396697998, avg_entr 0.07001866400241852, f1 0.879800021648407
ep23_l2_test_time 0.7676432132720947
Test Epoch23 layer3 Acc 0.8802, AUC 0.9432587623596191, avg_entr 0.03400810435414314, f1 0.8802000284194946
ep23_l3_test_time 0.7784607410430908
Test Epoch23 layer4 Acc 0.8806, AUC 0.9440903663635254, avg_entr 0.0222006905823946, f1 0.8805999755859375
ep23_l4_test_time 0.7607896327972412
gc 0
Train Epoch24 Acc 0.97455 (38982/40000), AUC 0.9963306188583374
ep24_train_time 11.166610479354858
Test Epoch24 layer0 Acc 0.8804, AUC 0.9450582265853882, avg_entr 0.11486774682998657, f1 0.8804000020027161
ep24_l0_test_time 0.7676770687103271
Test Epoch24 layer1 Acc 0.8806, AUC 0.946613609790802, avg_entr 0.09170658886432648, f1 0.8805999755859375
ep24_l1_test_time 0.7706263065338135
Test Epoch24 layer2 Acc 0.881, AUC 0.9473711252212524, avg_entr 0.06928111612796783, f1 0.8809999823570251
ep24_l2_test_time 0.7526648044586182
Test Epoch24 layer3 Acc 0.881, AUC 0.9432412385940552, avg_entr 0.0336977019906044, f1 0.8809999823570251
ep24_l3_test_time 0.8234124183654785
Test Epoch24 layer4 Acc 0.8814, AUC 0.9441154599189758, avg_entr 0.022116022184491158, f1 0.8813999891281128
ep24_l4_test_time 0.7879645824432373
gc 0
Train Epoch25 Acc 0.974675 (38987/40000), AUC 0.9963145852088928
ep25_train_time 11.172313451766968
Test Epoch25 layer0 Acc 0.88, AUC 0.9449968934059143, avg_entr 0.11457525938749313, f1 0.8799999952316284
ep25_l0_test_time 0.7692511081695557
Test Epoch25 layer1 Acc 0.8808, AUC 0.9465505480766296, avg_entr 0.09145756810903549, f1 0.8808000087738037
ep25_l1_test_time 0.760200023651123
Test Epoch25 layer2 Acc 0.8822, AUC 0.9472988843917847, avg_entr 0.06921050697565079, f1 0.8822000026702881
ep25_l2_test_time 0.8022937774658203
Test Epoch25 layer3 Acc 0.8816, AUC 0.9429123997688293, avg_entr 0.03373641148209572, f1 0.881600022315979
ep25_l3_test_time 0.8056871891021729
Test Epoch25 layer4 Acc 0.8818, AUC 0.9442346096038818, avg_entr 0.022157808765769005, f1 0.8818000555038452
ep25_l4_test_time 0.774878978729248
gc 0
Train Epoch26 Acc 0.975025 (39001/40000), AUC 0.9964059591293335
ep26_train_time 11.19950795173645
Test Epoch26 layer0 Acc 0.8802, AUC 0.9449265003204346, avg_entr 0.11424434930086136, f1 0.8802000284194946
ep26_l0_test_time 0.7699038982391357
Test Epoch26 layer1 Acc 0.881, AUC 0.9464818239212036, avg_entr 0.09107809513807297, f1 0.8809999823570251
ep26_l1_test_time 0.7678539752960205
Test Epoch26 layer2 Acc 0.8812, AUC 0.9472191333770752, avg_entr 0.06884932518005371, f1 0.8812000155448914
ep26_l2_test_time 0.7641046047210693
Test Epoch26 layer3 Acc 0.8822, AUC 0.9429159164428711, avg_entr 0.03347751498222351, f1 0.8822000026702881
ep26_l3_test_time 0.7890224456787109
Test Epoch26 layer4 Acc 0.8818, AUC 0.9443673491477966, avg_entr 0.021962499246001244, f1 0.8818000555038452
ep26_l4_test_time 0.7770829200744629
gc 0
Train Epoch27 Acc 0.974825 (38993/40000), AUC 0.9963874220848083
ep27_train_time 11.126044511795044
Test Epoch27 layer0 Acc 0.88, AUC 0.9448539018630981, avg_entr 0.11359311640262604, f1 0.8799999952316284
ep27_l0_test_time 0.7580640316009521
Test Epoch27 layer1 Acc 0.881, AUC 0.9464184045791626, avg_entr 0.09061926603317261, f1 0.8809999823570251
ep27_l1_test_time 0.7686905860900879
Test Epoch27 layer2 Acc 0.8818, AUC 0.9471604824066162, avg_entr 0.06833916157484055, f1 0.8818000555038452
ep27_l2_test_time 0.778376579284668
Test Epoch27 layer3 Acc 0.8814, AUC 0.9427794218063354, avg_entr 0.03322518244385719, f1 0.8813999891281128
ep27_l3_test_time 0.7706031799316406
Test Epoch27 layer4 Acc 0.8816, AUC 0.9442464113235474, avg_entr 0.021815026178956032, f1 0.881600022315979
ep27_l4_test_time 0.7636058330535889
gc 0
Train Epoch28 Acc 0.9752 (39008/40000), AUC 0.9963754415512085
ep28_train_time 11.202178955078125
Test Epoch28 layer0 Acc 0.8808, AUC 0.9448004961013794, avg_entr 0.11358460783958435, f1 0.8808000087738037
ep28_l0_test_time 0.77290940284729
Test Epoch28 layer1 Acc 0.8804, AUC 0.9463599920272827, avg_entr 0.09039931744337082, f1 0.8804000020027161
ep28_l1_test_time 0.7708325386047363
Test Epoch28 layer2 Acc 0.88, AUC 0.9470924139022827, avg_entr 0.06811188906431198, f1 0.8799999952316284
ep28_l2_test_time 0.7585430145263672
Test Epoch28 layer3 Acc 0.8812, AUC 0.9428846836090088, avg_entr 0.03316148370504379, f1 0.8812000155448914
ep28_l3_test_time 0.7796187400817871
Test Epoch28 layer4 Acc 0.8818, AUC 0.9444442987442017, avg_entr 0.022027915343642235, f1 0.8818000555038452
ep28_l4_test_time 0.7678492069244385
gc 0
Train Epoch29 Acc 0.974975 (38999/40000), AUC 0.9963945746421814
ep29_train_time 11.201972484588623
Test Epoch29 layer0 Acc 0.8808, AUC 0.9447648525238037, avg_entr 0.11320517212152481, f1 0.8808000087738037
ep29_l0_test_time 0.7911908626556396
Test Epoch29 layer1 Acc 0.8806, AUC 0.946325421333313, avg_entr 0.09016437083482742, f1 0.8805999755859375
ep29_l1_test_time 0.7613918781280518
Test Epoch29 layer2 Acc 0.88, AUC 0.9470551013946533, avg_entr 0.06795216351747513, f1 0.8799999952316284
ep29_l2_test_time 0.7617025375366211
Test Epoch29 layer3 Acc 0.881, AUC 0.9428637027740479, avg_entr 0.033053770661354065, f1 0.8809999823570251
ep29_l3_test_time 0.7689776420593262
Test Epoch29 layer4 Acc 0.8816, AUC 0.9444257020950317, avg_entr 0.02197582833468914, f1 0.881600022315979
ep29_l4_test_time 0.7664470672607422
Best AUC tensor(0.9012) 4 2
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 480.49344515800476
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8966, AUC 0.9556676149368286, avg_entr 0.17849716544151306, f1 0.8966000080108643
l0_test_time 0.7584104537963867
Test layer1 Acc 0.8942, AUC 0.956151008605957, avg_entr 0.15493746101856232, f1 0.8942000269889832
l1_test_time 0.7680482864379883
Test layer2 Acc 0.8942, AUC 0.9567800760269165, avg_entr 0.1504041850566864, f1 0.8942000269889832
l2_test_time 0.752760648727417
Test layer3 Acc 0.8948, AUC 0.9570677280426025, avg_entr 0.12491967529058456, f1 0.8948000073432922
l3_test_time 0.7599287033081055
Test layer4 Acc 0.8938, AUC 0.9570749998092651, avg_entr 0.09435436874628067, f1 0.8938000202178955
l4_test_time 0.7760038375854492
