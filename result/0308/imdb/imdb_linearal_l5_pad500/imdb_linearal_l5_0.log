total count words 222751
vocab size 30000
train size 40000, valid size 5000, test size 5000
found 27937 words in glove
model: LinearModelML(
  (layers): ModuleList(
    (0): EMBLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Embedding(30000, 300)
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=2, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=2, bias=True)
          (1): Sigmoid()
        )
        (cri): CrossEntropyLoss()
      )
    )
    (1): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (2): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (3): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
    (4): LinearLayer(
      (enc): ENC(
        (b): Sequential(
          (0): Linear(in_features=300, out_features=128, bias=True)
          (1): Tanh()
        )
        (f): Sequential(
          (0): Linear(in_features=300, out_features=300, bias=True)
          (1): ELU(alpha=1.0)
        )
        (cri): MSELoss()
      )
      (ae): AE(
        (g): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): Tanh()
        )
        (h): Sequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
        )
        (cri): MSELoss()
      )
    )
  )
)
layers.0.enc.b.0.weight 38400
layers.0.enc.b.0.bias 128
layers.0.enc.f.weight 9000000
layers.0.ae.g.0.weight 256
layers.0.ae.g.0.bias 128
layers.0.ae.h.0.weight 256
layers.0.ae.h.0.bias 2
layers.1.enc.b.0.weight 38400
layers.1.enc.b.0.bias 128
layers.1.enc.f.0.weight 90000
layers.1.enc.f.0.bias 300
layers.1.ae.g.0.weight 16384
layers.1.ae.g.0.bias 128
layers.1.ae.h.0.weight 16384
layers.1.ae.h.0.bias 128
layers.2.enc.b.0.weight 38400
layers.2.enc.b.0.bias 128
layers.2.enc.f.0.weight 90000
layers.2.enc.f.0.bias 300
layers.2.ae.g.0.weight 16384
layers.2.ae.g.0.bias 128
layers.2.ae.h.0.weight 16384
layers.2.ae.h.0.bias 128
layers.3.enc.b.0.weight 38400
layers.3.enc.b.0.bias 128
layers.3.enc.f.0.weight 90000
layers.3.enc.f.0.bias 300
layers.3.ae.g.0.weight 16384
layers.3.ae.g.0.bias 128
layers.3.ae.h.0.weight 16384
layers.3.ae.h.0.bias 128
layers.4.enc.b.0.weight 38400
layers.4.enc.b.0.bias 128
layers.4.enc.f.0.weight 90000
layers.4.enc.f.0.bias 300
layers.4.ae.g.0.weight 16384
layers.4.ae.g.0.bias 128
layers.4.ae.h.0.weight 16384
layers.4.ae.h.0.bias 128
Total Trainable Params: 9686578
init_time 22.096579551696777
Start Training
gc 0
Train Epoch0 Acc 0.516925 (20677/40000), AUC 0.5261566638946533
ep0_train_time 7.051390171051025
Test Epoch0 layer0 Acc 0.8002, AUC 0.8878317475318909, avg_entr 0.5714443325996399, f1 0.8001999855041504
ep0_l0_test_time 0.5853736400604248
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 0
Test Epoch0 layer1 Acc 0.5966, AUC 0.8718452453613281, avg_entr 0.6767282485961914, f1 0.5965999960899353
ep0_l1_test_time 0.5690772533416748
Test Epoch0 layer2 Acc 0.5278, AUC 0.8269039988517761, avg_entr 0.6729397177696228, f1 0.5278000235557556
ep0_l2_test_time 0.5723786354064941
Test Epoch0 layer3 Acc 0.5, AUC 0.7898706197738647, avg_entr 0.6791612505912781, f1 0.5
ep0_l3_test_time 0.5695536136627197
Test Epoch0 layer4 Acc 0.5008, AUC 0.8201534748077393, avg_entr 0.6772710084915161, f1 0.5008000135421753
ep0_l4_test_time 0.5708198547363281
gc 0
Train Epoch1 Acc 0.81285 (32514/40000), AUC 0.8967426419258118
ep1_train_time 6.5419676303863525
Test Epoch1 layer0 Acc 0.878, AUC 0.9454085826873779, avg_entr 0.29239290952682495, f1 0.878000020980835
ep1_l0_test_time 0.5714852809906006
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer1 Acc 0.8796, AUC 0.9457424283027649, avg_entr 0.34678372740745544, f1 0.8795999884605408
ep1_l1_test_time 0.5757153034210205
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 1
Test Epoch1 layer2 Acc 0.8756, AUC 0.9459973573684692, avg_entr 0.24192596971988678, f1 0.8756000399589539
ep1_l2_test_time 0.5785191059112549
Test Epoch1 layer3 Acc 0.8756, AUC 0.9459711909294128, avg_entr 0.23582588136196136, f1 0.8756000399589539
ep1_l3_test_time 0.5669450759887695
Test Epoch1 layer4 Acc 0.8736, AUC 0.9462604522705078, avg_entr 0.23077280819416046, f1 0.8736000061035156
ep1_l4_test_time 0.5773868560791016
gc 0
Train Epoch2 Acc 0.903625 (36145/40000), AUC 0.9641746282577515
ep2_train_time 6.529175519943237
Test Epoch2 layer0 Acc 0.8918, AUC 0.9543641805648804, avg_entr 0.23059234023094177, f1 0.8917999863624573
ep2_l0_test_time 0.5710217952728271
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer1 Acc 0.8922, AUC 0.9550270438194275, avg_entr 0.220784991979599, f1 0.8921999931335449
ep2_l1_test_time 0.5849306583404541
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer2 Acc 0.8924, AUC 0.9552167654037476, avg_entr 0.19572937488555908, f1 0.8923999667167664
ep2_l2_test_time 0.5740492343902588
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 2
Test Epoch2 layer3 Acc 0.8906, AUC 0.9550806283950806, avg_entr 0.18441127240657806, f1 0.8906000256538391
ep2_l3_test_time 0.5793533325195312
Test Epoch2 layer4 Acc 0.89, AUC 0.9553226232528687, avg_entr 0.16445189714431763, f1 0.8899999856948853
ep2_l4_test_time 0.5716202259063721
gc 0
Train Epoch3 Acc 0.922175 (36887/40000), AUC 0.9756635427474976
ep3_train_time 6.558651685714722
Test Epoch3 layer0 Acc 0.8944, AUC 0.9577192068099976, avg_entr 0.20060814917087555, f1 0.8944000005722046
ep3_l0_test_time 0.5715382099151611
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer1 Acc 0.8958, AUC 0.9583220481872559, avg_entr 0.18512390553951263, f1 0.895799994468689
ep3_l1_test_time 0.5716228485107422
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer2 Acc 0.896, AUC 0.9586792588233948, avg_entr 0.1677519828081131, f1 0.8960000276565552
ep3_l2_test_time 0.5764055252075195
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer3 Acc 0.8976, AUC 0.9590232372283936, avg_entr 0.15117247402668, f1 0.897599995136261
ep3_l3_test_time 0.5719468593597412
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
Test Epoch3 layer4 Acc 0.8978, AUC 0.9592171907424927, avg_entr 0.122405506670475, f1 0.8978000283241272
ep3_l4_test_time 0.5724260807037354
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 3
gc 0
Train Epoch4 Acc 0.934125 (37365/40000), AUC 0.9811925888061523
ep4_train_time 6.87322211265564
Test Epoch4 layer0 Acc 0.8988, AUC 0.9587993621826172, avg_entr 0.18018187582492828, f1 0.8988000154495239
ep4_l0_test_time 0.5876190662384033
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer1 Acc 0.898, AUC 0.9592745304107666, avg_entr 0.16328726708889008, f1 0.8980000019073486
ep4_l1_test_time 0.5863792896270752
Test Epoch4 layer2 Acc 0.8984, AUC 0.9598050117492676, avg_entr 0.1475820094347, f1 0.8984000086784363
ep4_l2_test_time 0.5866773128509521
Test Epoch4 layer3 Acc 0.8988, AUC 0.9602271914482117, avg_entr 0.12703213095664978, f1 0.8988000154495239
ep4_l3_test_time 0.5856859683990479
Save ckpt to ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt  ,ep 4
Test Epoch4 layer4 Acc 0.8978, AUC 0.9605878591537476, avg_entr 0.09197340905666351, f1 0.8978000283241272
ep4_l4_test_time 0.5898032188415527
gc 0
Train Epoch5 Acc 0.9407 (37628/40000), AUC 0.9847888946533203
ep5_train_time 7.082458972930908
Test Epoch5 layer0 Acc 0.889, AUC 0.9581195712089539, avg_entr 0.16601428389549255, f1 0.8889999985694885
ep5_l0_test_time 0.5902576446533203
Test Epoch5 layer1 Acc 0.8934, AUC 0.9586669206619263, avg_entr 0.14880341291427612, f1 0.8934000134468079
ep5_l1_test_time 0.5923619270324707
Test Epoch5 layer2 Acc 0.8938, AUC 0.9591193199157715, avg_entr 0.12901926040649414, f1 0.8938000202178955
ep5_l2_test_time 0.6000738143920898
Test Epoch5 layer3 Acc 0.8934, AUC 0.959598183631897, avg_entr 0.10077330470085144, f1 0.8934000134468079
ep5_l3_test_time 0.5994508266448975
Test Epoch5 layer4 Acc 0.894, AUC 0.9598488211631775, avg_entr 0.064994677901268, f1 0.8939999938011169
ep5_l4_test_time 0.6366665363311768
gc 0
Train Epoch6 Acc 0.94885 (37954/40000), AUC 0.9870937466621399
ep6_train_time 7.0777692794799805
Test Epoch6 layer0 Acc 0.8928, AUC 0.9571868181228638, avg_entr 0.15338043868541718, f1 0.892799973487854
ep6_l0_test_time 0.6229217052459717
Test Epoch6 layer1 Acc 0.8958, AUC 0.9578425884246826, avg_entr 0.13591410219669342, f1 0.895799994468689
ep6_l1_test_time 0.6178209781646729
Test Epoch6 layer2 Acc 0.8962, AUC 0.9586858749389648, avg_entr 0.11609990149736404, f1 0.8962000012397766
ep6_l2_test_time 0.6181862354278564
Test Epoch6 layer3 Acc 0.8968, AUC 0.9591601490974426, avg_entr 0.08218073099851608, f1 0.8967999815940857
ep6_l3_test_time 0.6212503910064697
Test Epoch6 layer4 Acc 0.896, AUC 0.9572978019714355, avg_entr 0.04745594039559364, f1 0.8960000276565552
ep6_l4_test_time 0.6166377067565918
gc 0
Train Epoch7 Acc 0.954 (38160/40000), AUC 0.9887951016426086
ep7_train_time 6.964056491851807
Test Epoch7 layer0 Acc 0.8922, AUC 0.9552502036094666, avg_entr 0.1486508846282959, f1 0.8921999931335449
ep7_l0_test_time 0.5934789180755615
Test Epoch7 layer1 Acc 0.8922, AUC 0.9561660289764404, avg_entr 0.13135699927806854, f1 0.8921999931335449
ep7_l1_test_time 0.5913524627685547
Test Epoch7 layer2 Acc 0.8948, AUC 0.9573057889938354, avg_entr 0.11233151704072952, f1 0.8948000073432922
ep7_l2_test_time 0.5977871417999268
Test Epoch7 layer3 Acc 0.895, AUC 0.9576119184494019, avg_entr 0.07127188891172409, f1 0.8949999809265137
ep7_l3_test_time 0.6058628559112549
Test Epoch7 layer4 Acc 0.895, AUC 0.9541904926300049, avg_entr 0.041507527232170105, f1 0.8949999809265137
ep7_l4_test_time 0.5995566844940186
gc 0
Train Epoch8 Acc 0.9583 (38332/40000), AUC 0.990688145160675
ep8_train_time 7.029746770858765
Test Epoch8 layer0 Acc 0.8902, AUC 0.9537405967712402, avg_entr 0.14009037613868713, f1 0.8902000188827515
ep8_l0_test_time 0.5790364742279053
Test Epoch8 layer1 Acc 0.8934, AUC 0.9547945857048035, avg_entr 0.1233973354101181, f1 0.8934000134468079
ep8_l1_test_time 0.5882182121276855
Test Epoch8 layer2 Acc 0.8932, AUC 0.9558700323104858, avg_entr 0.10385774075984955, f1 0.8931999802589417
ep8_l2_test_time 0.5866386890411377
Test Epoch8 layer3 Acc 0.8934, AUC 0.956101655960083, avg_entr 0.05965350195765495, f1 0.8934000134468079
ep8_l3_test_time 0.587446928024292
Test Epoch8 layer4 Acc 0.8936, AUC 0.9524472951889038, avg_entr 0.034698158502578735, f1 0.8935999870300293
ep8_l4_test_time 0.7609422206878662
gc 0
Train Epoch9 Acc 0.963025 (38521/40000), AUC 0.9923406839370728
ep9_train_time 6.700115203857422
Test Epoch9 layer0 Acc 0.8914, AUC 0.9527412056922913, avg_entr 0.13702180981636047, f1 0.8913999795913696
ep9_l0_test_time 0.5546224117279053
Test Epoch9 layer1 Acc 0.8914, AUC 0.9538669586181641, avg_entr 0.11969504505395889, f1 0.8913999795913696
ep9_l1_test_time 0.556084394454956
Test Epoch9 layer2 Acc 0.8916, AUC 0.9551547765731812, avg_entr 0.09928560256958008, f1 0.8916000127792358
ep9_l2_test_time 0.555821418762207
Test Epoch9 layer3 Acc 0.892, AUC 0.9552319049835205, avg_entr 0.05461376905441284, f1 0.8920000195503235
ep9_l3_test_time 0.5570864677429199
Test Epoch9 layer4 Acc 0.8916, AUC 0.9509239196777344, avg_entr 0.03208308666944504, f1 0.8916000127792358
ep9_l4_test_time 0.5574867725372314
gc 0
Train Epoch10 Acc 0.965125 (38605/40000), AUC 0.9930363893508911
ep10_train_time 6.398108959197998
Test Epoch10 layer0 Acc 0.8884, AUC 0.9514669179916382, avg_entr 0.13417430222034454, f1 0.8884000182151794
ep10_l0_test_time 0.5543901920318604
Test Epoch10 layer1 Acc 0.8896, AUC 0.9526941776275635, avg_entr 0.11728547513484955, f1 0.8895999193191528
ep10_l1_test_time 0.5545358657836914
Test Epoch10 layer2 Acc 0.8906, AUC 0.9539320468902588, avg_entr 0.09646821022033691, f1 0.8906000256538391
ep10_l2_test_time 0.5549430847167969
Test Epoch10 layer3 Acc 0.8894, AUC 0.9538028836250305, avg_entr 0.050860609859228134, f1 0.8894000053405762
ep10_l3_test_time 0.558781623840332
Test Epoch10 layer4 Acc 0.8904, AUC 0.9507625699043274, avg_entr 0.0304728876799345, f1 0.8903999924659729
ep10_l4_test_time 0.5573723316192627
gc 0
Train Epoch11 Acc 0.9659 (38636/40000), AUC 0.9934495091438293
ep11_train_time 6.524062633514404
Test Epoch11 layer0 Acc 0.8866, AUC 0.9502360820770264, avg_entr 0.13156677782535553, f1 0.8866000771522522
ep11_l0_test_time 0.5583114624023438
Test Epoch11 layer1 Acc 0.8866, AUC 0.9516105055809021, avg_entr 0.11462205648422241, f1 0.8866000771522522
ep11_l1_test_time 0.5489053726196289
Test Epoch11 layer2 Acc 0.888, AUC 0.9526712894439697, avg_entr 0.09253950417041779, f1 0.8880000114440918
ep11_l2_test_time 0.5547919273376465
Test Epoch11 layer3 Acc 0.8884, AUC 0.9521584510803223, avg_entr 0.04784437268972397, f1 0.8884000182151794
ep11_l3_test_time 0.5598533153533936
Test Epoch11 layer4 Acc 0.8884, AUC 0.9488599300384521, avg_entr 0.02924247458577156, f1 0.8884000182151794
ep11_l4_test_time 0.5700521469116211
gc 0
Train Epoch12 Acc 0.967875 (38715/40000), AUC 0.9939522743225098
ep12_train_time 6.4451775550842285
Test Epoch12 layer0 Acc 0.8862, AUC 0.9492860436439514, avg_entr 0.12896980345249176, f1 0.8862000107765198
ep12_l0_test_time 0.5653591156005859
Test Epoch12 layer1 Acc 0.8872, AUC 0.9507238268852234, avg_entr 0.11214973032474518, f1 0.8871999979019165
ep12_l1_test_time 0.5697240829467773
Test Epoch12 layer2 Acc 0.8852, AUC 0.9519706964492798, avg_entr 0.08947771042585373, f1 0.8852000832557678
ep12_l2_test_time 0.5640318393707275
Test Epoch12 layer3 Acc 0.8858, AUC 0.9509445428848267, avg_entr 0.04472768306732178, f1 0.8858000040054321
ep12_l3_test_time 0.5623469352722168
Test Epoch12 layer4 Acc 0.886, AUC 0.9492653608322144, avg_entr 0.027837084606289864, f1 0.8859999775886536
ep12_l4_test_time 0.5579118728637695
gc 0
Train Epoch13 Acc 0.9695 (38780/40000), AUC 0.9946310520172119
ep13_train_time 6.4811201095581055
Test Epoch13 layer0 Acc 0.8838, AUC 0.9485204815864563, avg_entr 0.13039538264274597, f1 0.8838000297546387
ep13_l0_test_time 0.5559239387512207
Test Epoch13 layer1 Acc 0.8842, AUC 0.9500401020050049, avg_entr 0.11325767636299133, f1 0.8842000365257263
ep13_l1_test_time 0.5587475299835205
Test Epoch13 layer2 Acc 0.8828, AUC 0.9514137506484985, avg_entr 0.09112787246704102, f1 0.8827999830245972
ep13_l2_test_time 0.5596792697906494
Test Epoch13 layer3 Acc 0.8822, AUC 0.9498448967933655, avg_entr 0.04523524269461632, f1 0.8822000026702881
ep13_l3_test_time 0.5650160312652588
Test Epoch13 layer4 Acc 0.8826, AUC 0.9475417733192444, avg_entr 0.028085418045520782, f1 0.8826000094413757
ep13_l4_test_time 0.5547492504119873
gc 0
Train Epoch14 Acc 0.9702 (38808/40000), AUC 0.9950568675994873
ep14_train_time 6.450583457946777
Test Epoch14 layer0 Acc 0.8852, AUC 0.9479548931121826, avg_entr 0.12618958950042725, f1 0.8852000832557678
ep14_l0_test_time 0.5545721054077148
Test Epoch14 layer1 Acc 0.8848, AUC 0.9494894742965698, avg_entr 0.10946130007505417, f1 0.8848000168800354
ep14_l1_test_time 0.559441328048706
Test Epoch14 layer2 Acc 0.884, AUC 0.9507097601890564, avg_entr 0.08695165067911148, f1 0.8840000033378601
ep14_l2_test_time 0.559964656829834
Test Epoch14 layer3 Acc 0.8836, AUC 0.948971688747406, avg_entr 0.042075015604496, f1 0.8835999965667725
ep14_l3_test_time 0.5624897480010986
Test Epoch14 layer4 Acc 0.8846, AUC 0.9469156265258789, avg_entr 0.02667069621384144, f1 0.8845999836921692
ep14_l4_test_time 0.5608747005462646
gc 0
Train Epoch15 Acc 0.97075 (38830/40000), AUC 0.9951234459877014
ep15_train_time 6.518090486526489
Test Epoch15 layer0 Acc 0.883, AUC 0.9472863674163818, avg_entr 0.1238517314195633, f1 0.8830000162124634
ep15_l0_test_time 0.5797724723815918
Test Epoch15 layer1 Acc 0.8838, AUC 0.9488682746887207, avg_entr 0.1073610857129097, f1 0.8838000297546387
ep15_l1_test_time 0.5805151462554932
Test Epoch15 layer2 Acc 0.8824, AUC 0.9500530958175659, avg_entr 0.08453820645809174, f1 0.8823999762535095
ep15_l2_test_time 0.579052209854126
Test Epoch15 layer3 Acc 0.8836, AUC 0.9476795792579651, avg_entr 0.040245309472084045, f1 0.8835999965667725
ep15_l3_test_time 0.5843977928161621
Test Epoch15 layer4 Acc 0.8832, AUC 0.9463260173797607, avg_entr 0.025589371100068092, f1 0.8831999897956848
ep15_l4_test_time 0.5841374397277832
gc 0
Train Epoch16 Acc 0.971525 (38861/40000), AUC 0.9951556921005249
ep16_train_time 6.816090106964111
Test Epoch16 layer0 Acc 0.8808, AUC 0.9462887048721313, avg_entr 0.12248547375202179, f1 0.8808000087738037
ep16_l0_test_time 0.579735517501831
Test Epoch16 layer1 Acc 0.8806, AUC 0.9479641318321228, avg_entr 0.10612092167139053, f1 0.8805999755859375
ep16_l1_test_time 0.5800411701202393
Test Epoch16 layer2 Acc 0.8814, AUC 0.9490310549736023, avg_entr 0.0831129401922226, f1 0.8813999891281128
ep16_l2_test_time 0.593034029006958
Test Epoch16 layer3 Acc 0.883, AUC 0.9459044337272644, avg_entr 0.039152756333351135, f1 0.8830000162124634
ep16_l3_test_time 0.601642370223999
Test Epoch16 layer4 Acc 0.882, AUC 0.945755124092102, avg_entr 0.024925805628299713, f1 0.8820000290870667
ep16_l4_test_time 0.621647834777832
gc 0
Train Epoch17 Acc 0.9725 (38900/40000), AUC 0.9953892230987549
ep17_train_time 6.622305393218994
Test Epoch17 layer0 Acc 0.8818, AUC 0.9461791515350342, avg_entr 0.12215966731309891, f1 0.8818000555038452
ep17_l0_test_time 0.5476927757263184
Test Epoch17 layer1 Acc 0.8832, AUC 0.9478821754455566, avg_entr 0.10580398142337799, f1 0.8831999897956848
ep17_l1_test_time 0.5500187873840332
Test Epoch17 layer2 Acc 0.882, AUC 0.9490014314651489, avg_entr 0.08265833556652069, f1 0.8820000290870667
ep17_l2_test_time 0.5499026775360107
Test Epoch17 layer3 Acc 0.8812, AUC 0.9466130137443542, avg_entr 0.03842934966087341, f1 0.8812000155448914
ep17_l3_test_time 0.551837682723999
Test Epoch17 layer4 Acc 0.8814, AUC 0.9474064111709595, avg_entr 0.024175314232707024, f1 0.8813999891281128
ep17_l4_test_time 0.5523173809051514
gc 0
Train Epoch18 Acc 0.97235 (38894/40000), AUC 0.9956047534942627
ep18_train_time 6.444354295730591
Test Epoch18 layer0 Acc 0.8806, AUC 0.9459977149963379, avg_entr 0.1219228059053421, f1 0.8805999755859375
ep18_l0_test_time 0.5512471199035645
Test Epoch18 layer1 Acc 0.8806, AUC 0.9476915597915649, avg_entr 0.10532606393098831, f1 0.8805999755859375
ep18_l1_test_time 0.5547633171081543
Test Epoch18 layer2 Acc 0.8812, AUC 0.9488879442214966, avg_entr 0.08212163299322128, f1 0.8812000155448914
ep18_l2_test_time 0.5522518157958984
Test Epoch18 layer3 Acc 0.881, AUC 0.9461479187011719, avg_entr 0.038073062896728516, f1 0.8809999823570251
ep18_l3_test_time 0.551764965057373
Test Epoch18 layer4 Acc 0.8814, AUC 0.9463412761688232, avg_entr 0.02413254603743553, f1 0.8813999891281128
ep18_l4_test_time 0.5527913570404053
gc 0
Train Epoch19 Acc 0.972625 (38905/40000), AUC 0.9956664443016052
ep19_train_time 6.3621039390563965
Test Epoch19 layer0 Acc 0.881, AUC 0.9456559419631958, avg_entr 0.12154615670442581, f1 0.8809999823570251
ep19_l0_test_time 0.5532841682434082
Test Epoch19 layer1 Acc 0.88, AUC 0.9473414421081543, avg_entr 0.1052781492471695, f1 0.8799999952316284
ep19_l1_test_time 0.5531871318817139
Test Epoch19 layer2 Acc 0.881, AUC 0.9485881924629211, avg_entr 0.08224435895681381, f1 0.8809999823570251
ep19_l2_test_time 0.5510504245758057
Test Epoch19 layer3 Acc 0.8802, AUC 0.9456113576889038, avg_entr 0.038204126060009, f1 0.8802000284194946
ep19_l3_test_time 0.558678388595581
Test Epoch19 layer4 Acc 0.8806, AUC 0.9456401467323303, avg_entr 0.023846862837672234, f1 0.8805999755859375
ep19_l4_test_time 0.5542454719543457
gc 0
Train Epoch20 Acc 0.972975 (38919/40000), AUC 0.9957388639450073
ep20_train_time 6.512777090072632
Test Epoch20 layer0 Acc 0.8808, AUC 0.9452638030052185, avg_entr 0.11941877752542496, f1 0.8808000087738037
ep20_l0_test_time 0.5629069805145264
Test Epoch20 layer1 Acc 0.881, AUC 0.9470000267028809, avg_entr 0.10320410132408142, f1 0.8809999823570251
ep20_l1_test_time 0.5795636177062988
Test Epoch20 layer2 Acc 0.8804, AUC 0.948145866394043, avg_entr 0.08001557737588882, f1 0.8804000020027161
ep20_l2_test_time 0.5581676959991455
Test Epoch20 layer3 Acc 0.88, AUC 0.9447439908981323, avg_entr 0.03627511113882065, f1 0.8799999952316284
ep20_l3_test_time 0.5665323734283447
Test Epoch20 layer4 Acc 0.8794, AUC 0.9454188346862793, avg_entr 0.022885309532284737, f1 0.8794000148773193
ep20_l4_test_time 0.5595240592956543
gc 0
Train Epoch21 Acc 0.9737 (38948/40000), AUC 0.9958176612854004
ep21_train_time 6.466083526611328
Test Epoch21 layer0 Acc 0.88, AUC 0.9451124668121338, avg_entr 0.11938604712486267, f1 0.8799999952316284
ep21_l0_test_time 0.5499377250671387
Test Epoch21 layer1 Acc 0.8792, AUC 0.9468623399734497, avg_entr 0.10297906398773193, f1 0.8791999816894531
ep21_l1_test_time 0.5536148548126221
Test Epoch21 layer2 Acc 0.8802, AUC 0.9480036497116089, avg_entr 0.07951849699020386, f1 0.8802000284194946
ep21_l2_test_time 0.5513648986816406
Test Epoch21 layer3 Acc 0.8798, AUC 0.9446033239364624, avg_entr 0.036379992961883545, f1 0.879800021648407
ep21_l3_test_time 0.5532910823822021
Test Epoch21 layer4 Acc 0.8804, AUC 0.9448488354682922, avg_entr 0.02272038906812668, f1 0.8804000020027161
ep21_l4_test_time 0.5545578002929688
gc 0
Train Epoch22 Acc 0.9732 (38928/40000), AUC 0.9959999918937683
ep22_train_time 6.371162176132202
Test Epoch22 layer0 Acc 0.8798, AUC 0.9450078010559082, avg_entr 0.11856431514024734, f1 0.879800021648407
ep22_l0_test_time 0.5811927318572998
Test Epoch22 layer1 Acc 0.8792, AUC 0.9467605352401733, avg_entr 0.10228752344846725, f1 0.8791999816894531
ep22_l1_test_time 0.5483310222625732
Test Epoch22 layer2 Acc 0.8794, AUC 0.9479472637176514, avg_entr 0.07869330793619156, f1 0.8794000148773193
ep22_l2_test_time 0.554652214050293
Test Epoch22 layer3 Acc 0.88, AUC 0.9446956515312195, avg_entr 0.035479240119457245, f1 0.8799999952316284
ep22_l3_test_time 0.5506410598754883
Test Epoch22 layer4 Acc 0.8804, AUC 0.9460082650184631, avg_entr 0.022354476153850555, f1 0.8804000020027161
ep22_l4_test_time 0.5554523468017578
gc 0
Train Epoch23 Acc 0.973575 (38943/40000), AUC 0.9959641695022583
ep23_train_time 6.4757983684539795
Test Epoch23 layer0 Acc 0.879, AUC 0.9448583722114563, avg_entr 0.11810784041881561, f1 0.8790000081062317
ep23_l0_test_time 0.5517570972442627
Test Epoch23 layer1 Acc 0.879, AUC 0.9466215372085571, avg_entr 0.10171850025653839, f1 0.8790000081062317
ep23_l1_test_time 0.5520784854888916
Test Epoch23 layer2 Acc 0.8792, AUC 0.947759747505188, avg_entr 0.07815636694431305, f1 0.8791999816894531
ep23_l2_test_time 0.5511312484741211
Test Epoch23 layer3 Acc 0.8792, AUC 0.9442946314811707, avg_entr 0.03537094220519066, f1 0.8791999816894531
ep23_l3_test_time 0.5588769912719727
Test Epoch23 layer4 Acc 0.8802, AUC 0.9450421333312988, avg_entr 0.02215041220188141, f1 0.8802000284194946
ep23_l4_test_time 0.5513827800750732
gc 0
Train Epoch24 Acc 0.97365 (38946/40000), AUC 0.995951771736145
ep24_train_time 6.507429361343384
Test Epoch24 layer0 Acc 0.8792, AUC 0.9446993470191956, avg_entr 0.11749204993247986, f1 0.8791999816894531
ep24_l0_test_time 0.5529470443725586
Test Epoch24 layer1 Acc 0.8794, AUC 0.9464880228042603, avg_entr 0.10127764940261841, f1 0.8794000148773193
ep24_l1_test_time 0.5487067699432373
Test Epoch24 layer2 Acc 0.8796, AUC 0.9476531744003296, avg_entr 0.07766374200582504, f1 0.8795999884605408
ep24_l2_test_time 0.5502171516418457
Test Epoch24 layer3 Acc 0.88, AUC 0.9441075325012207, avg_entr 0.03517337143421173, f1 0.8799999952316284
ep24_l3_test_time 0.5577175617218018
Test Epoch24 layer4 Acc 0.8794, AUC 0.9451431632041931, avg_entr 0.02204420603811741, f1 0.8794000148773193
ep24_l4_test_time 0.5527117252349854
gc 0
Train Epoch25 Acc 0.973975 (38959/40000), AUC 0.9960545301437378
ep25_train_time 6.5536229610443115
Test Epoch25 layer0 Acc 0.8792, AUC 0.9445925951004028, avg_entr 0.11666461080312729, f1 0.8791999816894531
ep25_l0_test_time 0.5518555641174316
Test Epoch25 layer1 Acc 0.8792, AUC 0.9463849067687988, avg_entr 0.10045350342988968, f1 0.8791999816894531
ep25_l1_test_time 0.5627107620239258
Test Epoch25 layer2 Acc 0.879, AUC 0.9474940896034241, avg_entr 0.07688084989786148, f1 0.8790000081062317
ep25_l2_test_time 0.5512270927429199
Test Epoch25 layer3 Acc 0.8782, AUC 0.9437375664710999, avg_entr 0.03457475081086159, f1 0.8781999945640564
ep25_l3_test_time 0.5654313564300537
Test Epoch25 layer4 Acc 0.8786, AUC 0.9453079104423523, avg_entr 0.02166379615664482, f1 0.878600001335144
ep25_l4_test_time 0.5534508228302002
gc 0
Train Epoch26 Acc 0.974125 (38965/40000), AUC 0.996079683303833
ep26_train_time 6.425663709640503
Test Epoch26 layer0 Acc 0.8796, AUC 0.9445198774337769, avg_entr 0.11613701283931732, f1 0.8795999884605408
ep26_l0_test_time 0.592033863067627
Test Epoch26 layer1 Acc 0.8794, AUC 0.9463194608688354, avg_entr 0.0999583899974823, f1 0.8794000148773193
ep26_l1_test_time 0.5517318248748779
Test Epoch26 layer2 Acc 0.879, AUC 0.947422981262207, avg_entr 0.07648470252752304, f1 0.8790000081062317
ep26_l2_test_time 0.5490460395812988
Test Epoch26 layer3 Acc 0.8782, AUC 0.9435747861862183, avg_entr 0.034238506108522415, f1 0.8781999945640564
ep26_l3_test_time 0.56490159034729
Test Epoch26 layer4 Acc 0.8782, AUC 0.9451065063476562, avg_entr 0.02152245119214058, f1 0.8781999945640564
ep26_l4_test_time 0.5545101165771484
gc 0
Train Epoch27 Acc 0.973925 (38957/40000), AUC 0.9960876703262329
ep27_train_time 6.410935163497925
Test Epoch27 layer0 Acc 0.879, AUC 0.9444712400436401, avg_entr 0.11622331291437149, f1 0.8790000081062317
ep27_l0_test_time 0.5530717372894287
Test Epoch27 layer1 Acc 0.8784, AUC 0.9462652206420898, avg_entr 0.10003780573606491, f1 0.8784000277519226
ep27_l1_test_time 0.5488979816436768
Test Epoch27 layer2 Acc 0.8794, AUC 0.9474213719367981, avg_entr 0.07666820287704468, f1 0.8794000148773193
ep27_l2_test_time 0.5509486198425293
Test Epoch27 layer3 Acc 0.8796, AUC 0.9437260031700134, avg_entr 0.0345059372484684, f1 0.8795999884605408
ep27_l3_test_time 0.5561783313751221
Test Epoch27 layer4 Acc 0.88, AUC 0.9451506733894348, avg_entr 0.021602598950266838, f1 0.8799999952316284
ep27_l4_test_time 0.5583484172821045
gc 0
Train Epoch28 Acc 0.974375 (38975/40000), AUC 0.9961296319961548
ep28_train_time 6.417834520339966
Test Epoch28 layer0 Acc 0.878, AUC 0.9443953037261963, avg_entr 0.11546562612056732, f1 0.878000020980835
ep28_l0_test_time 0.5502438545227051
Test Epoch28 layer1 Acc 0.8792, AUC 0.9461990594863892, avg_entr 0.09920293837785721, f1 0.8791999816894531
ep28_l1_test_time 0.5502493381500244
Test Epoch28 layer2 Acc 0.8786, AUC 0.9473224878311157, avg_entr 0.07569167762994766, f1 0.878600001335144
ep28_l2_test_time 0.5518229007720947
Test Epoch28 layer3 Acc 0.879, AUC 0.9433485269546509, avg_entr 0.033708564937114716, f1 0.8790000081062317
ep28_l3_test_time 0.5669248104095459
Test Epoch28 layer4 Acc 0.8782, AUC 0.9447717666625977, avg_entr 0.021080641075968742, f1 0.8781999945640564
ep28_l4_test_time 0.5647664070129395
gc 0
Train Epoch29 Acc 0.9744 (38976/40000), AUC 0.9961494207382202
ep29_train_time 6.405677795410156
Test Epoch29 layer0 Acc 0.8788, AUC 0.9443597197532654, avg_entr 0.11499588936567307, f1 0.8787999749183655
ep29_l0_test_time 0.5496766567230225
Test Epoch29 layer1 Acc 0.8794, AUC 0.9461641311645508, avg_entr 0.09880320727825165, f1 0.8794000148773193
ep29_l1_test_time 0.546302318572998
Test Epoch29 layer2 Acc 0.8792, AUC 0.9472610950469971, avg_entr 0.07528563588857651, f1 0.8791999816894531
ep29_l2_test_time 0.5512666702270508
Test Epoch29 layer3 Acc 0.8784, AUC 0.9433164596557617, avg_entr 0.033453214913606644, f1 0.8784000277519226
ep29_l3_test_time 0.5494720935821533
Test Epoch29 layer4 Acc 0.8778, AUC 0.9449167251586914, avg_entr 0.020955808460712433, f1 0.8778000473976135
ep29_l4_test_time 0.5821921825408936
Best AUC tensor(0.8988) 4 2
train_loss (2, 5, 30)
valid_acc (5, 30)
valid_AUC (5, 30)
train_acc (30,)
total_train+valid_time 286.2022376060486
Start Testing
Load ckpt at ckpt/imdb_linearal_l5_pad500//imdb_linearal_l5.pt
Test layer0 Acc 0.8954, AUC 0.9553130865097046, avg_entr 0.18228505551815033, f1 0.8953999876976013
l0_test_time 0.5566625595092773
Test layer1 Acc 0.8952, AUC 0.955912709236145, avg_entr 0.16648948192596436, f1 0.8952000141143799
l1_test_time 0.5514051914215088
Test layer2 Acc 0.8952, AUC 0.9563331604003906, avg_entr 0.15178221464157104, f1 0.8952000141143799
l2_test_time 0.5529999732971191
Test layer3 Acc 0.8962, AUC 0.9568159580230713, avg_entr 0.1323179006576538, f1 0.8962000012397766
l3_test_time 0.5496053695678711
Test layer4 Acc 0.8962, AUC 0.9570006132125854, avg_entr 0.0979556143283844, f1 0.8962000012397766
l4_test_time 0.5466866493225098
